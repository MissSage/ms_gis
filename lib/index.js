var __defProp = Object.defineProperty;
var __defProps = Object.defineProperties;
var __getOwnPropDescs = Object.getOwnPropertyDescriptors;
var __getOwnPropSymbols = Object.getOwnPropertySymbols;
var __hasOwnProp = Object.prototype.hasOwnProperty;
var __propIsEnum = Object.prototype.propertyIsEnumerable;
var __defNormalProp = (obj, key, value) => key in obj ? __defProp(obj, key, { enumerable: true, configurable: true, writable: true, value }) : obj[key] = value;
var __spreadValues = (a2, b2) => {
  for (var prop in b2 || (b2 = {}))
    if (__hasOwnProp.call(b2, prop))
      __defNormalProp(a2, prop, b2[prop]);
  if (__getOwnPropSymbols)
    for (var prop of __getOwnPropSymbols(b2)) {
      if (__propIsEnum.call(b2, prop))
        __defNormalProp(a2, prop, b2[prop]);
    }
  return a2;
};
var __spreadProps = (a2, b2) => __defProps(a2, __getOwnPropDescs(b2));
var __objRest = (source, exclude) => {
  var target = {};
  for (var prop in source)
    if (__hasOwnProp.call(source, prop) && exclude.indexOf(prop) < 0)
      target[prop] = source[prop];
  if (source != null && __getOwnPropSymbols)
    for (var prop of __getOwnPropSymbols(source)) {
      if (exclude.indexOf(prop) < 0 && __propIsEnum.call(source, prop))
        target[prop] = source[prop];
    }
  return target;
};
var _a, _b, _c, _d, _e2, _f, _g, _h, _i;
import { defineComponent, openBlock, createElementBlock, renderSlot, ref } from "vue";
var index_vue_vue_type_style_index_0_scoped_true_lang$1 = "";
var _export_sfc = (sfc, props) => {
  const target = sfc.__vccOpts || sfc;
  for (const [key, val] of props) {
    target[key] = val;
  }
  return target;
};
const _sfc_main$1 = /* @__PURE__ */ defineComponent({
  emits: ["click"],
  setup(__props) {
    return (_ctx, _cache) => {
      return openBlock(), createElementBlock("button", {
        class: "ms-button",
        onClick: _cache[0] || (_cache[0] = ($event) => _ctx.$emit("click", $event))
      }, [
        renderSlot(_ctx.$slots, "default", {}, void 0, true)
      ]);
    };
  }
});
var Button = /* @__PURE__ */ _export_sfc(_sfc_main$1, [["__scopeId", "data-v-4d4ba8b7"]]);
const ButtonPlugin = {
  install(app) {
    app.component("ms-button", Button);
  }
};
function e$2g(e2, t2, r2, o2) {
  var c2, f2 = arguments.length, n2 = f2 < 3 ? t2 : o2 === null ? o2 = Object.getOwnPropertyDescriptor(t2, r2) : o2;
  if (typeof Reflect == "object" && typeof Reflect.decorate == "function")
    n2 = Reflect.decorate(e2, t2, r2, o2);
  else
    for (var l2 = e2.length - 1; l2 >= 0; l2--)
      (c2 = e2[l2]) && (n2 = (f2 < 3 ? c2(n2) : f2 > 3 ? c2(t2, r2, n2) : c2(t2, r2)) || n2);
  return f2 > 3 && n2 && Object.defineProperty(t2, r2, n2), n2;
}
let e$2f;
function has(a2) {
  return typeof e$2f[a2] == "function" ? e$2f[a2] = e$2f[a2](globalThis) : e$2f[a2];
}
e$2f = ((_a = globalThis.dojoConfig) == null ? void 0 : _a.has) || ((_b = globalThis.esriConfig) == null ? void 0 : _b.has) ? __spreadValues(__spreadValues({}, (_c = globalThis.dojoConfig) == null ? void 0 : _c.has), (_d = globalThis.esriConfig) == null ? void 0 : _d.has) : {}, has.add = (a2, d2, o2, r2) => ((r2 || e$2f[a2] === void 0) && (e$2f[a2] = d2), o2 && has(a2)), has.cache = e$2f, has.add("esri-deprecation-warnings", true), (() => {
  var _a2;
  has.add("host-webworker", globalThis.WorkerGlobalScope !== void 0 && self instanceof globalThis.WorkerGlobalScope);
  const e2 = typeof window != "undefined" && typeof location != "undefined" && typeof document != "undefined" && window.location === location && window.document === document;
  if (has.add("host-browser", e2), has.add("host-node", typeof globalThis.process == "object" && ((_a2 = globalThis.process.versions) == null ? void 0 : _a2.node) && globalThis.process.versions.v8), has.add("dom", e2), has("host-browser")) {
    const e3 = navigator, a2 = e3.userAgent, d2 = e3.appVersion, o2 = parseFloat(d2);
    if (has.add("wp", parseFloat(a2.split("Windows Phone")[1]) || void 0), has.add("msapp", parseFloat(a2.split("MSAppHost/")[1]) || void 0), has.add("khtml", d2.includes("Konqueror") ? o2 : void 0), has.add("edge", parseFloat(a2.split("Edge/")[1]) || void 0), has.add("opr", parseFloat(a2.split("OPR/")[1]) || void 0), has.add("webkit", !has("wp") && !has("edge") && parseFloat(a2.split("WebKit/")[1]) || void 0), has.add("chrome", !has("edge") && !has("opr") && parseFloat(a2.split("Chrome/")[1]) || void 0), has.add("android", !has("wp") && parseFloat(a2.split("Android ")[1]) || void 0), has.add("safari", !d2.includes("Safari") || has("wp") || has("chrome") || has("android") || has("edge") || has("opr") ? void 0 : parseFloat(d2.split("Version/")[1])), has.add("mac", d2.includes("Macintosh")), !has("wp") && a2.match(/(iPhone|iPod|iPad)/)) {
      const e4 = RegExp.$1.replace(/P/, "p"), d3 = a2.match(/OS ([\d_]+)/) ? RegExp.$1 : "1", o3 = parseFloat(d3.replace(/_/, ".").replace(/_/g, ""));
      has.add(e4, o3), has.add("ios", o3);
    }
    has.add("trident", parseFloat(d2.split("Trident/")[1]) || void 0), has("webkit") || (!a2.includes("Gecko") || has("wp") || has("khtml") || has("trident") || has("edge") || has.add("mozilla", o2), has("mozilla") && has.add("ff", parseFloat(a2.split("Firefox/")[1] || a2.split("Minefield/")[1]) || void 0));
  }
})(), (() => {
  if (globalThis.navigator) {
    const e2 = navigator.userAgent, a2 = /Android|webOS|iPhone|iPad|iPod|BlackBerry|Opera Mini|IEMobile/i.test(e2), d2 = /iPhone/i.test(e2);
    a2 && has.add("esri-mobile", a2), d2 && has.add("esri-iPhone", d2), has.add("esri-geolocation", !!navigator.geolocation);
  }
  has.add("esri-canvas-svg-support", !has("trident")), has.add("esri-wasm", "WebAssembly" in globalThis), has.add("esri-shared-array-buffer", () => {
    const e2 = "SharedArrayBuffer" in globalThis, a2 = globalThis.crossOriginIsolated === false;
    return e2 && !a2;
  }), has.add("wasm-simd", () => {
    const e2 = [0, 97, 115, 109, 1, 0, 0, 0, 1, 5, 1, 96, 0, 1, 123, 3, 2, 1, 0, 10, 10, 1, 8, 0, 65, 0, 253, 15, 253, 98, 11];
    return WebAssembly.validate(new Uint8Array(e2));
  }), has.add("esri-atomics", "Atomics" in globalThis), has.add("esri-workers", "Worker" in globalThis), has.add("web-feat:cache", "caches" in globalThis), has.add("esri-workers-arraybuffer-transfer", !has("safari") || Number(has("safari")) >= 12), has.add("featurelayer-simplify-thresholds", [0.5, 0.5, 0.5, 0.5]), has.add("featurelayer-simplify-payload-size-factors", [1, 1, 4]), has.add("featurelayer-snapshot-enabled", true), has.add("featurelayer-snapshot-point-min-threshold", 8e4), has.add("featurelayer-snapshot-point-max-threshold", 4e5), has.add("featurelayer-snapshot-point-coverage", 0.1), has.add("featurelayer-advanced-symbols", false), has.add("featurelayer-pbf", true), has.add("featurelayer-pbf-statistics", false), has.add("feature-layers-workers", true), has.add("feature-polyline-generalization-factor", 1), has.add("mapview-transitions-duration", 200), has.add("mapview-srswitch-adjust-rotation-scale-threshold", 24e6), has.add("mapserver-pbf-enabled", false), has.add("mapimagelayer-popup-identify-max-tolerance", 20), has.add("heatmap-allow-raster-fallback", true), has.add("heatmap-force-raster", false), has("host-webworker") || has("host-browser") && (has.add("esri-csp-restrictions", () => {
    try {
      new Function();
    } catch {
      return true;
    }
    return false;
  }), has.add("esri-image-decode", () => {
    if ("decode" in new Image()) {
      const e2 = new Image();
      return e2.src = 'data:image/svg+xml;charset=UTF-8,<svg version="1.1" xmlns="http://www.w3.org/2000/svg"></svg>', void e2.decode().then(() => {
        has.add("esri-image-decode", true, true, true);
      }).catch(() => {
        has.add("esri-image-decode", false, true, true);
      });
    }
    return false;
  }), has.add("esri-url-encodes-apostrophe", () => {
    const e2 = window.document.createElement("a");
    return e2.href = "?'", e2.href.includes("?%27");
  }));
})();
const n$2Z = null;
function r$1$(n2) {
  return n2 != null;
}
function t$2r(n2) {
  return n2 == null;
}
function o$2s(t2, u2) {
  return r$1$(t2) ? u2(t2) : n$2Z;
}
function e$2e(n2) {
  return n2;
}
function f$21(n2, r2) {
  return c$3u(n2, r2), n2;
}
function c$3u(n2, r2) {
  if (t$2r(n2))
    throw new Error(r2 != null ? r2 : "value is None");
}
function i$3f(n2, t2) {
  return r$1$(n2) ? n2 : typeof t2 == "function" ? t2() : t2;
}
function l$2N(n2, t2) {
  return r$1$(n2) ? n2 : t2;
}
function s$2D(n2) {
  return r$1$(n2) && n2.destroy(), null;
}
function a$31(n2) {
  return r$1$(n2) && n2.dispose(), null;
}
function h$1W(n2) {
  return r$1$(n2) && n2.remove(), null;
}
function p$3M(n2) {
  return r$1$(n2) && n2.abort(), null;
}
function w$15(n2) {
  return r$1$(n2) && n2.release(), null;
}
function y$1O(n2, t2, u2) {
  return r$1$(n2) && r$1$(t2) ? r$1$(u2) ? u2(n2, t2) : n2.equals(t2) : n2 === t2;
}
function d$23(n2) {
  return null;
}
function A$G(n2, r2) {
  const t2 = new Array();
  for (const u2 of n2)
    t2.push(b$1d(u2, null, r2));
  return t2;
}
function E$S(n2, r2) {
  for (const t2 of n2)
    o$2s(t2, r2);
}
function b$1d(n2, t2, u2) {
  return r$1$(n2) ? u2(n2) : t2;
}
function m$2z(n2) {
  return n2.filter((n3) => r$1$(n3));
}
function q$u(n2, ...r2) {
  let t2 = n2;
  for (let u2 = 0; u2 < r2.length && t2; ++u2)
    t2 = t2[r2[u2]];
  return t2;
}
function x$16(n2) {
  return n2;
}
class t$2q {
  constructor(t2 = 1) {
    this._seed = t2;
  }
  set seed(e2) {
    this._seed = e2 != null ? e2 : Math.random() * t$2q._m;
  }
  getInt() {
    return this._seed = (t$2q._a * this._seed + t$2q._c) % t$2q._m, this._seed;
  }
  getFloat() {
    return this.getInt() / (t$2q._m - 1);
  }
  getIntRange(t2, e2) {
    return Math.round(this.getFloatRange(t2, e2));
  }
  getFloatRange(e2, s2) {
    const n2 = s2 - e2;
    return e2 + this.getInt() / t$2q._m * n2;
  }
}
t$2q._m = 2147483647, t$2q._a = 48271, t$2q._c = 0;
function u$2o(t2, n2) {
  return n2 ? t2.filter((t3, e2, r2) => r2.findIndex(n2.bind(null, t3)) === e2) : t2.filter((t3, n3, e2) => e2.indexOf(t3) === n3);
}
function i$3e(n2, e2, r2) {
  if (t$2r(n2) && t$2r(e2))
    return true;
  if (t$2r(n2) || t$2r(e2) || n2.length !== e2.length)
    return false;
  if (r2) {
    for (let t2 = 0; t2 < n2.length; t2++)
      if (!r2(n2[t2], e2[t2]))
        return false;
  } else
    for (let t2 = 0; t2 < n2.length; t2++)
      if (n2[t2] !== e2[t2])
        return false;
  return true;
}
function c$3t(t2, n2) {
  let e2 = t2.length !== n2.length;
  e2 && (t2.length = n2.length);
  for (let r2 = 0; r2 < n2.length; ++r2)
    t2[r2] !== n2[r2] && (t2[r2] = n2[r2], e2 = true);
  return e2;
}
function s$2C(t2, n2, e2) {
  let r2, o2;
  return e2 ? (r2 = n2.filter((n3) => !t2.some((t3) => e2(t3, n3))), o2 = t2.filter((t3) => !n2.some((n3) => e2(n3, t3)))) : (r2 = n2.filter((n3) => !t2.includes(n3)), o2 = t2.filter((t3) => !n2.includes(t3))), { added: r2, removed: o2 };
}
function a$30(t2) {
  return t2 && typeof t2.length == "number";
}
const d$22 = !!Array.prototype.fill;
function m$2y(t2, n2) {
  if (d$22)
    return new Array(t2).fill(n2);
  const e2 = new Array(t2);
  for (let r2 = 0; r2 < t2; r2++)
    e2[r2] = n2;
  return e2;
}
function p$3L(t2, n2) {
  n2 === void 0 && (n2 = t2, t2 = 0);
  const e2 = new Array(n2 - t2);
  for (let r2 = t2; r2 < n2; r2++)
    e2[r2 - t2] = r2;
  return e2;
}
class x$15 {
  constructor() {
    this.last = 0;
  }
}
const y$1N = new x$15();
function b$1c(t2, n2, e2, r2) {
  r2 = r2 || y$1N;
  const o2 = Math.max(0, r2.last - 10);
  for (let l2 = o2; l2 < e2; ++l2)
    if (t2[l2] === n2)
      return r2.last = l2, l2;
  const f2 = Math.min(o2, e2);
  for (let l2 = 0; l2 < f2; ++l2)
    if (t2[l2] === n2)
      return r2.last = l2, l2;
  return -1;
}
function v$1d(t2, n2, e2, r2) {
  const o2 = e2 != null ? e2 : t2.length, f2 = b$1c(t2, n2, o2, r2);
  if (f2 !== -1)
    return t2[f2] = t2[o2 - 1], e2 == null && t2.pop(), n2;
}
const A$F = new Set();
function j$14(t2, n2, e2 = t2.length, r2 = n2.length, o2, f2) {
  if (r2 === 0 || e2 === 0)
    return e2;
  A$F.clear();
  for (let u2 = 0; u2 < r2; ++u2)
    A$F.add(n2[u2]);
  o2 = o2 || y$1N;
  const l2 = Math.max(0, o2.last - 10);
  for (let u2 = l2; u2 < e2; ++u2)
    if (A$F.has(t2[u2]) && (f2 && f2.push(t2[u2]), A$F.delete(t2[u2]), t2[u2] = t2[e2 - 1], --e2, --u2, A$F.size === 0 || e2 === 0))
      return A$F.clear(), e2;
  for (let u2 = 0; u2 < l2; ++u2)
    if (A$F.has(t2[u2]) && (f2 && f2.push(t2[u2]), A$F.delete(t2[u2]), t2[u2] = t2[e2 - 1], --e2, --u2, A$F.size === 0 || e2 === 0))
      return A$F.clear(), e2;
  return A$F.clear(), e2;
}
new t$2q();
function C$G(t2, n2) {
  const e2 = t2.indexOf(n2);
  return e2 !== -1 ? (t2.splice(e2, 1), n2) : null;
}
function n$2Y(r2, n2) {
  if (r2.forEach)
    r2.forEach(n2);
  else
    for (let t2 = 0; t2 < r2.length; t2++)
      n2(r2[t2], t2, r2);
}
function t$2p(r2, n2, t2) {
  if (r2.slice)
    return r2.slice(n2, t2);
  n2 === void 0 ? n2 = 0 : (n2 < 0 && (n2 += r2.length), n2 = Math.min(r2.length, Math.max(0, n2))), t2 === void 0 ? t2 = r2.length : (t2 < 0 && (t2 += r2.length), t2 = Math.min(r2.length, Math.max(0, t2)));
  const o2 = Math.max(0, t2 - n2), c2 = new r2.constructor(o2);
  for (let e2 = 0; e2 < o2; e2++)
    c2[e2] = r2[n2 + e2];
  return c2;
}
function o$2r(r2) {
  return r2 instanceof ArrayBuffer || r2 && r2.constructor && r2.constructor.name === "ArrayBuffer";
}
function c$3s(r2) {
  return r2 instanceof Int8Array || r2 && r2.constructor && r2.constructor.name === "Int8Array";
}
function e$2d(r2) {
  return r2 instanceof Uint8Array || r2 && r2.constructor && r2.constructor.name === "Uint8Array";
}
function a$2$(r2) {
  return r2 instanceof Uint8ClampedArray || r2 && r2.constructor && r2.constructor.name === "Uint8ClampedArray";
}
function u$2n(r2) {
  return r2 instanceof Int16Array || r2 && r2.constructor && r2.constructor.name === "Int16Array";
}
function i$3d(r2) {
  return r2 instanceof Uint16Array || r2 && r2.constructor && r2.constructor.name === "Uint16Array";
}
function f$20(r2) {
  return r2 instanceof Int32Array || r2 && r2.constructor && r2.constructor.name === "Int32Array";
}
function s$2B(r2) {
  return r2 instanceof Uint32Array || r2 && r2.constructor && r2.constructor.name === "Uint32Array";
}
function y$1M(r2) {
  return r2 instanceof Float32Array || r2 && r2.constructor && r2.constructor.name === "Float32Array";
}
function A$E(r2) {
  return r2 instanceof Float64Array || r2 && r2.constructor && r2.constructor.name === "Float64Array";
}
function l$2M(r2) {
  const n2 = new Array(r2.length);
  for (let t2 = 0; t2 < r2.length; t2++)
    n2[t2] = r2[t2];
  return n2;
}
function p$3K(t2, n2) {
  let e2;
  if (n2)
    for (e2 in t2)
      t2.hasOwnProperty(e2) && (t2[e2] === void 0 ? delete t2[e2] : t2[e2] instanceof Object && p$3K(t2[e2], true));
  else
    for (e2 in t2)
      t2.hasOwnProperty(e2) && t2[e2] === void 0 && delete t2[e2];
  return t2;
}
function y$1L(t2) {
  if (!t2 || typeof t2 != "object" || typeof t2 == "function")
    return t2;
  const e2 = h$1V(t2);
  if (r$1$(e2))
    return e2;
  if (b$1b(t2))
    return t2.clone();
  if (g$1r(t2))
    return t2.map(y$1L);
  if (O$F(t2))
    return t2.clone();
  const r2 = {};
  for (const n2 of Object.getOwnPropertyNames(t2))
    r2[n2] = y$1L(t2[n2]);
  return r2;
}
function m$2x(t2) {
  if (!t2 || typeof t2 != "object" || typeof t2 == "function" || "HTMLElement" in globalThis && t2 instanceof HTMLElement)
    return t2;
  const e2 = h$1V(t2);
  if (r$1$(e2))
    return e2;
  if (g$1r(t2)) {
    let n2 = true;
    const e3 = t2.map((t3) => {
      const e4 = m$2x(t3);
      return t3 != null && e4 == null && (n2 = false), e4;
    });
    return n2 ? e3 : null;
  }
  if (b$1b(t2))
    return t2.clone();
  if (!O$F(t2)) {
    const n2 = new (Object.getPrototypeOf(t2)).constructor();
    for (const e3 of Object.getOwnPropertyNames(t2)) {
      const r2 = t2[e3], o2 = m$2x(r2);
      if (r2 != null && o2 == null)
        return null;
      n2[e3] = o2;
    }
    return n2;
  }
  return null;
}
function b$1b(t2) {
  return typeof t2.clone == "function";
}
function g$1r(t2) {
  return typeof t2.map == "function" && typeof t2.forEach == "function";
}
function O$F(t2) {
  return typeof t2.notifyChange == "function" && typeof t2.watch == "function";
}
function j$13(t2) {
  if (Object.prototype.toString.call(t2) !== "[object Object]")
    return false;
  const n2 = Object.getPrototypeOf(t2);
  return n2 === null || n2 === Object.prototype;
}
function h$1V(t2) {
  if (c$3s(t2) || e$2d(t2) || a$2$(t2) || u$2n(t2) || i$3d(t2) || f$20(t2) || s$2B(t2) || y$1M(t2) || A$E(t2))
    return t$2p(t2);
  if (t2 instanceof Date)
    return new Date(t2.getTime());
  if (t2 instanceof ArrayBuffer) {
    return t2.slice(0, t2.byteLength);
  }
  if (t2 instanceof Map) {
    const n2 = new Map();
    for (const [e2, r2] of t2)
      n2.set(e2, y$1L(r2));
    return n2;
  }
  if (t2 instanceof Set) {
    const n2 = new Set();
    for (const e2 of t2)
      n2.add(y$1L(e2));
    return n2;
  }
  return null;
}
function w$14(t2, n2) {
  return t2 === n2 || typeof t2 == "number" && isNaN(t2) && typeof n2 == "number" && isNaN(n2) || typeof (t2 || {}).getTime == "function" && typeof (n2 || {}).getTime == "function" && t2.getTime() === n2.getTime() || false;
}
function N$w(n2, e2) {
  return n2 === e2 || (n2 == null || typeof n2 == "string" ? n2 === e2 : typeof n2 == "number" ? n2 === e2 || typeof e2 == "number" && isNaN(n2) && isNaN(e2) : n2 instanceof Date ? e2 instanceof Date && n2.getTime() === e2.getTime() : Array.isArray(n2) ? Array.isArray(e2) && i$3e(n2, e2) : n2 instanceof Set ? e2 instanceof Set && d$21(n2, e2) : n2 instanceof Map ? e2 instanceof Map && P$F(n2, e2) : !!j$13(n2) && (j$13(e2) && T$H(n2, e2)));
}
function T$H(t2, n2) {
  if (t2 === null || n2 === null)
    return false;
  const e2 = Object.keys(t2);
  if (n2 === null || Object.keys(n2).length !== e2.length)
    return false;
  for (const r2 of e2)
    if (t2[r2] !== n2[r2] || !Object.prototype.hasOwnProperty.call(n2, r2))
      return false;
  return true;
}
function d$21(t2, n2) {
  if (t2.size !== n2.size)
    return false;
  for (const e2 of t2)
    if (!n2.has(e2))
      return false;
  return true;
}
function P$F(t2, n2) {
  if (t2.size !== n2.size)
    return false;
  for (const [e2, r2] of t2) {
    const t3 = n2.get(e2);
    if (t3 !== r2 || t3 === void 0 && !n2.has(e2))
      return false;
  }
  return true;
}
function n$2X(r2, n2, t2 = false) {
  return i$3c(r2, n2, t2);
}
function t$2o(r2, n2) {
  if (n2 != null)
    return n2[r2] || e$2c(r2.split("."), false, n2);
}
function o$2q(r2, n2, t2) {
  const o2 = r2.split("."), i2 = o2.pop(), u2 = e$2c(o2, true, t2);
  u2 && i2 && (u2[i2] = n2);
}
function e$2c(r2, n2, t2) {
  let o2 = t2;
  for (const e2 of r2) {
    if (o2 == null)
      return;
    if (!(e2 in o2)) {
      if (!n2)
        return;
      o2[e2] = {};
    }
    o2 = o2[e2];
  }
  return o2;
}
function i$3c(n2, t2, o2) {
  return t2 ? Object.keys(t2).reduce((n3, e2) => {
    let u2 = n3[e2], c2 = t2[e2];
    return u2 === c2 ? n3 : u2 === void 0 ? (n3[e2] = y$1L(c2), n3) : (Array.isArray(c2) || Array.isArray(n3) ? (u2 = u2 ? Array.isArray(u2) ? n3[e2] = u2.concat() : n3[e2] = [u2] : n3[e2] = [], c2 && (Array.isArray(c2) || (c2 = [c2]), o2 ? c2.forEach((r2) => {
      u2.includes(r2) || u2.push(r2);
    }) : n3[e2] = c2.concat())) : c2 && typeof c2 == "object" ? n3[e2] = i$3c(u2, c2, o2) : n3.hasOwnProperty(e2) && !t2.hasOwnProperty(e2) || (n3[e2] = c2), n3);
  }, n2 || {}) : n2;
}
const s$2A = { analysisTheme: { accentColor: [255, 128, 0], textColor: "white" }, apiKey: void 0, applicationUrl: (_e2 = globalThis.location) == null ? void 0 : _e2.href, assetsPath: "", fontsUrl: "https://static.arcgis.com/fonts", geometryServiceUrl: "https://utility.arcgisonline.com/arcgis/rest/services/Geometry/GeometryServer", geoRSSServiceUrl: "https://utility.arcgis.com/sharing/rss", kmlServiceUrl: "https://utility.arcgis.com/sharing/kml", portalUrl: "https://www.arcgis.com", routeServiceUrl: "https://route-api.arcgis.com/arcgis/rest/services/World/Route/NAServer/Route_World", workers: { loaderConfig: { has: {}, paths: {}, map: {}, packages: [] } }, request: { crossOriginNoCorsDomains: null, httpsDomains: ["arcgis.com", "arcgisonline.com", "esrikr.com", "premiumservices.blackbridge.com", "esripremium.accuweather.com", "gbm.digitalglobe.com", "firstlook.digitalglobe.com", "msi.digitalglobe.com"], interceptors: [], maxUrlLength: 2e3, priority: "high", proxyRules: [], proxyUrl: null, timeout: 6e4, trustedServers: [], useIdentity: true }, log: { interceptors: [], level: null } };
if (globalThis.esriConfig && (n$2X(s$2A, globalThis.esriConfig, true), delete s$2A.has), !s$2A.assetsPath) {
  {
    const e2 = "4.25.5";
    s$2A.assetsPath = `https://js.arcgis.com/${e2.slice(0, -2)}/@arcgis/core/assets`;
  }
  s$2A.defaultAssetsPath = s$2A.assetsPath;
}
const e$2b = /\{([^\}]+)\}/g;
function r$1_(t2) {
  return t2 != null ? t2 : "";
}
function n$2W(n2, o2) {
  return n2.replace(e$2b, typeof o2 == "object" ? (e2, n3) => r$1_(t$2o(n3, o2)) : (t2, e2) => r$1_(o2(e2)));
}
function o$2p(t2, e2) {
  return t2.replace(/([\.$?*|{}\(\)\[\]\\\/\+\-^])/g, (t3) => e2 && e2.includes(t3) ? t3 : `\\${t3}`);
}
function c$3r(t2) {
  let e2 = 0;
  for (let r2 = 0; r2 < t2.length; r2++)
    e2 = (e2 << 5) - e2 + t2.charCodeAt(r2), e2 |= 0;
  return e2;
}
function u$2m(t2) {
  return new DOMParser().parseFromString(t2 || "", "text/html").body.innerText || "";
}
const o$2o = { info: 0, warn: 1, error: 2, none: 3 };
class s$2z {
  constructor(e2) {
    this.level = null, this._module = "", this._parent = null, this.writer = null, this._loggedMessages = { error: new Map(), warn: new Map(), info: new Map() }, e2.level != null && (this.level = e2.level), e2.writer != null && (this.writer = e2.writer), this._module = e2.module, s$2z._loggers[this.module] = this;
    const t2 = this.module.lastIndexOf(".");
    t2 !== -1 && (this._parent = s$2z.getLogger(this.module.slice(0, t2)));
  }
  get module() {
    return this._module;
  }
  get parent() {
    return this._parent;
  }
  error(...e2) {
    this._log("error", "always", ...e2);
  }
  warn(...e2) {
    this._log("warn", "always", ...e2);
  }
  info(...e2) {
    this._log("info", "always", ...e2);
  }
  errorOnce(...e2) {
    this._log("error", "once", ...e2);
  }
  warnOnce(...e2) {
    this._log("warn", "once", ...e2);
  }
  infoOnce(...e2) {
    this._log("info", "once", ...e2);
  }
  errorOncePerTick(...e2) {
    this._log("error", "oncePerTick", ...e2);
  }
  warnOncePerTick(...e2) {
    this._log("warn", "oncePerTick", ...e2);
  }
  infoOncePerTick(...e2) {
    this._log("info", "oncePerTick", ...e2);
  }
  get test() {
    const e2 = this;
    return { loggedMessages: e2._loggedMessages, clearLoggedWarnings: () => e2._loggedMessages.warn.clear() };
  }
  static get testSingleton() {
    return { resetLoggers(e2 = {}) {
      const t2 = s$2z._loggers;
      return s$2z._loggers = e2, t2;
    }, set throttlingDisabled(e2) {
      s$2z._throttlingDisabled = e2;
    } };
  }
  static getLogger(e2) {
    let t2 = s$2z._loggers[e2];
    return t2 || (t2 = new s$2z({ module: e2 })), t2;
  }
  _log(t2, r2, ...o2) {
    if (!this._matchLevel(t2))
      return;
    if (r2 !== "always" && !s$2z._throttlingDisabled) {
      const e2 = this._argsToKey(o2), n2 = this._loggedMessages[t2].get(e2);
      if (r2 === "once" && n2 != null || r2 === "oncePerTick" && n2 && n2 >= s$2z._tickCounter)
        return;
      this._loggedMessages[t2].set(e2, s$2z._tickCounter), s$2z._scheduleTickCounterIncrement();
    }
    for (const s2 of s$2A.log.interceptors)
      if (s2(t2, this.module, ...o2))
        return;
    this._inheritedWriter()(t2, this.module, ...o2);
  }
  _parentWithMember(e2, r2) {
    let o2 = this;
    for (; r$1$(o2); ) {
      const r3 = o2[e2];
      if (r$1$(r3))
        return r3;
      o2 = o2.parent;
    }
    return r2;
  }
  _inheritedWriter() {
    return this._parentWithMember("writer", this._consoleWriter);
  }
  _consoleWriter(e2, t2, ...r2) {
    console[e2](`[${t2}]`, ...r2);
  }
  _matchLevel(t2) {
    const r2 = s$2A.log.level ? s$2A.log.level : "warn";
    return o$2o[this._parentWithMember("level", r2)] <= o$2o[t2];
  }
  _argsToKey(...e2) {
    const t2 = (e3, t3) => typeof t3 != "object" || Array.isArray(t3) ? t3 : "[Object]";
    return c$3r(JSON.stringify(e2, t2));
  }
  static _scheduleTickCounterIncrement() {
    s$2z._tickCounterScheduled || (s$2z._tickCounterScheduled = true, Promise.resolve().then(() => {
      s$2z._tickCounter++, s$2z._tickCounterScheduled = false;
    }));
  }
}
s$2z._loggers = {}, s$2z._tickCounter = 0, s$2z._tickCounterScheduled = false, s$2z._throttlingDisabled = false;
function n$2V(n2, t2) {
  for (const [r2, o2] of n2)
    if (t2(o2, r2))
      return true;
  return false;
}
function t$2n(n2, t2) {
  for (const [r2, o2] of n2)
    if (t2(o2, r2))
      return o2;
  return null;
}
function r$1Z(n2, t2, r2) {
  const o2 = n2.get(t2);
  if (o2 !== void 0)
    return o2;
  const u2 = r2();
  return n2.set(t2, u2), u2;
}
const r$1Y = s$2z.getLogger("esri.core.accessorSupport.ensureTypes");
function t$2m(e2) {
  return e2 == null ? e2 : new Date(e2);
}
function o$2n(e2) {
  return e2 == null ? e2 : !!e2;
}
function u$2l(e2) {
  return e2 == null ? e2 : e2.toString();
}
function a$2_(e2) {
  return e2 == null ? e2 : (e2 = parseFloat(e2), isNaN(e2) ? 0 : e2);
}
function s$2y(e2) {
  return e2 == null ? e2 : Math.round(parseFloat(e2));
}
function i$3b(e2) {
  return e2 && e2.constructor && e2.constructor.__accessorMetadata__ !== void 0;
}
function l$2L(e2, n2) {
  return n2 != null && e2 && !(n2 instanceof e2);
}
function c$3q(e2) {
  return e2 && "isCollection" in e2;
}
function f$1$(e2) {
  return e2 && e2.Type ? typeof e2.Type == "function" ? e2.Type : e2.Type.base : null;
}
function p$3J(e2, n2) {
  if (!n2 || !n2.constructor || !c$3q(n2.constructor))
    return y$1K(e2, n2) ? n2 : new e2(n2);
  const r2 = f$1$(e2.prototype.itemType), t2 = f$1$(n2.constructor.prototype.itemType);
  return r2 ? t2 ? r2 === t2 ? n2 : r2.prototype.isPrototypeOf(t2.prototype) ? new e2(n2) : (y$1K(e2, n2), n2) : new e2(n2) : n2;
}
function y$1K(e2, n2) {
  return !!i$3b(n2) && (r$1Y.error("Accessor#set", "Assigning an instance of '" + (n2.declaredClass || "unknown") + "' which is not a subclass of '" + g$1q(e2) + "'"), true);
}
function v$1c(e2, n2) {
  return n2 == null ? n2 : c$3q(e2) ? p$3J(e2, n2) : l$2L(e2, n2) ? y$1K(e2, n2) ? n2 : new e2(n2) : n2;
}
function g$1q(e2) {
  return e2 && e2.prototype && e2.prototype.declaredClass || "unknown";
}
const d$20 = new WeakMap();
function h$1U(e2) {
  switch (e2) {
    case Number:
      return a$2_;
    case T$G:
      return s$2y;
    case Boolean:
      return o$2n;
    case String:
      return u$2l;
    case Date:
      return t$2m;
    default:
      return r$1Z(d$20, e2, () => v$1c.bind(null, e2));
  }
}
function b$1a(e2, n2) {
  const r2 = h$1U(e2);
  return arguments.length === 1 ? r2 : r2(n2);
}
function m$2w(e2, n2, r2) {
  return arguments.length === 1 ? m$2w.bind(null, e2) : n2 ? Array.isArray(n2) ? n2.map((n3) => e2(n3, r2)) : [e2(n2, r2)] : n2;
}
function w$13(e2, n2) {
  return arguments.length === 1 ? m$2w(b$1a.bind(null, e2)) : m$2w(b$1a.bind(null, e2), n2);
}
function A$D(e2, n2, r2) {
  return n2 !== 0 && Array.isArray(r2) ? r2.map((r3) => A$D(e2, n2 - 1, r3)) : e2(r2);
}
function $$m(e2, n2, r2) {
  if (arguments.length === 2)
    return $$m.bind(null, e2, n2);
  if (!r2)
    return r2;
  let t2 = n2, o2 = r2 = A$D(e2, n2, r2);
  for (; t2 > 0 && Array.isArray(o2); )
    t2--, o2 = o2[0];
  if (o2 !== void 0)
    for (let u2 = 0; u2 < t2; u2++)
      r2 = [r2];
  return r2;
}
function j$12(e2, n2, r2) {
  return arguments.length === 2 ? $$m(b$1a.bind(null, e2), n2) : $$m(b$1a.bind(null, e2), n2, r2);
}
function k$H(e2) {
  return !!Array.isArray(e2) && !e2.some((n2) => {
    const r2 = typeof n2;
    return !(r2 === "string" || r2 === "number" || r2 === "function" && e2.length > 1);
  });
}
function M$N(e2, n2) {
  if (arguments.length === 2)
    return M$N(e2).call(null, n2);
  const t2 = new Set(), o2 = e2.filter((e3) => typeof e3 != "function"), u2 = e2.filter((e3) => typeof e3 == "function");
  for (const r2 of e2)
    typeof r2 != "string" && typeof r2 != "number" || t2.add(r2);
  let a2 = null, s2 = null;
  return (e3, n3) => {
    if (e3 == null)
      return e3;
    const i2 = typeof e3, c2 = i2 === "string" || i2 === "number";
    return c2 && (t2.has(e3) || u2.some((e4) => i2 === "string" && e4 === String || i2 === "number" && e4 === Number)) || i2 === "object" && u2.some((n4) => !l$2L(e3, n4)) ? e3 : (c2 && o2.length ? (a2 || (a2 = o2.map((e4) => typeof e4 == "string" ? `'${e4}'` : `${e4}`).join(", ")), r$1Y.error("Accessor#set", `'${e3}' is not a valid value for this property, only the following values are valid: ${a2}`)) : typeof e3 == "object" && u2.length ? (s2 || (s2 = u2.map((e4) => g$1q(e4)).join(", ")), r$1Y.error("Accessor#set", `'${e3}' is not a valid value for this property, value must be one of ${s2}`)) : r$1Y.error("Accessor#set", `'${e3}' is not a valid value for this property`), n3 && (n3.valid = false), null);
  };
}
function S$V(e2, n2) {
  if (arguments.length === 2)
    return S$V(e2).call(null, n2);
  const t2 = {}, o2 = [], u2 = [];
  for (const r2 in e2.typeMap) {
    const n3 = e2.typeMap[r2];
    t2[r2] = b$1a(n3), o2.push(g$1q(n3)), u2.push(r2);
  }
  const a2 = () => `'${o2.join("', '")}'`, s2 = () => `'${u2.join("', '")}'`, c2 = typeof e2.key == "string" ? (n3) => n3[e2.key] : e2.key;
  return (n3) => {
    if (e2.base && !l$2L(e2.base, n3))
      return n3;
    if (n3 == null)
      return n3;
    const o3 = c2(n3) || e2.defaultKeyValue, u3 = t2[o3];
    if (!u3)
      return r$1Y.error("Accessor#set", `Invalid property value, value needs to be one of ${a2()}, or a plain object that can autocast (having .type = ${s2()})`), null;
    if (!l$2L(e2.typeMap[o3], n3))
      return n3;
    if (typeof e2.key == "string" && !i$3b(n3)) {
      const r2 = {};
      for (const t3 in n3)
        t3 !== e2.key && (r2[t3] = n3[t3]);
      return u3(r2);
    }
    return u3(n3);
  };
}
class T$G {
}
const N$v = { native: (e2) => ({ type: "native", value: e2 }), array: (e2) => ({ type: "array", value: e2 }), oneOf: (e2) => ({ type: "one-of", values: e2 }) };
function _$R(e2) {
  if (!e2 || !("type" in e2))
    return false;
  switch (e2.type) {
    case "native":
    case "array":
    case "one-of":
      return true;
  }
  return false;
}
function B$y(e2) {
  switch (e2.type) {
    case "native":
      return b$1a(e2.value);
    case "array":
      return m$2w(B$y(e2.value));
    case "one-of":
      return C$F(e2);
    default:
      return null;
  }
}
function C$F(e2) {
  let n2 = null;
  return (t2, o2) => F$C(t2, e2) ? t2 : (n2 == null && (n2 = D$E(e2)), r$1Y.error("Accessor#set", `Invalid property value, value needs to be of type ${n2}`), o2 && (o2.valid = false), null);
}
function D$E(e2) {
  switch (e2.type) {
    case "native":
      switch (e2.value) {
        case Number:
          return "number";
        case String:
          return "string";
        case Boolean:
          return "boolean";
        case T$G:
          return "integer";
        case Date:
          return "date";
        default:
          return g$1q(e2.value);
      }
    case "array":
      return `array of ${D$E(e2.value)}`;
    case "one-of": {
      const n2 = e2.values.map((e3) => D$E(e3));
      return `one of ${n2.slice(0, n2.length - 1)} or ${n2[n2.length - 1]}`;
    }
  }
  return "unknown";
}
function F$C(e2, n2) {
  if (e2 == null)
    return true;
  switch (n2.type) {
    case "native":
      switch (n2.value) {
        case Number:
        case T$G:
          return typeof e2 == "number";
        case Boolean:
          return typeof e2 == "boolean";
        case String:
          return typeof e2 == "string";
      }
      return e2 instanceof n2.value;
    case "array":
      return !!Array.isArray(e2) && !e2.some((e3) => !F$C(e3, n2.value));
    case "one-of":
      return n2.values.some((n3) => F$C(e2, n3));
  }
}
function r$1X(r2) {
  return n$2U(() => r2.forEach((r3) => r$1$(r3) && r3.remove()));
}
function n$2U(e2) {
  return { remove: () => {
    e2 && (e2(), e2 = void 0);
  } };
}
function o$2m(r2) {
  return n$2U(() => {
    const n2 = r2();
    r$1$(n2) && n2.remove();
  });
}
function t$2l(r2) {
  return n$2U(r$1$(r2) ? () => r2.destroy() : void 0);
}
function e$2a(r2) {
  return r2 ? r2.__accessor__ ? r2.__accessor__ : r2.propertyInvalidated ? r2 : null : null;
}
function i$3a(r2, n2) {
  return r2 != null && r2.metadatas && r2.metadatas[n2] != null;
}
function o$2l(r2, n2, t2) {
  if (t2) {
    return l$2K(r2, n2, { policy: t2, path: "" });
  }
  return l$2K(r2, n2, null);
}
function l$2K(r2, e2, i2) {
  return e2 ? Object.keys(e2).reduce((r3, u2) => {
    let o2 = null, a2 = "merge";
    if (i2 && (o2 = i2.path ? `${i2.path}.${u2}` : u2, a2 = i2.policy(o2)), a2 === "replace")
      return r3[u2] = e2[u2], r3;
    if (r3[u2] === void 0)
      return r3[u2] = y$1L(e2[u2]), r3;
    let s2 = r3[u2], c2 = e2[u2];
    if (s2 === c2)
      return r3;
    if (Array.isArray(c2) || Array.isArray(r3))
      s2 = s2 ? Array.isArray(s2) ? r3[u2] = s2.concat() : r3[u2] = [s2] : r3[u2] = [], c2 && (Array.isArray(c2) || (c2 = [c2]), c2.forEach((r4) => {
        s2.includes(r4) || s2.push(r4);
      }));
    else if (c2 && typeof c2 == "object")
      if (i2) {
        const n2 = i2.path;
        i2.path = x$16(o2), r3[u2] = l$2K(s2, c2, i2), i2.path = n2;
      } else
        r3[u2] = l$2K(s2, c2, null);
    else
      r3.hasOwnProperty(u2) && !e2.hasOwnProperty(u2) || (r3[u2] = c2);
    return r3;
  }, r2 || {}) : r2;
}
function s$2x(r2) {
  return Array.isArray(r2) ? r2 : r2.split(".");
}
function c$3p(r2) {
  return r2.includes(",") ? r2.split(",").map((r3) => r3.trim()) : [r2.trim()];
}
function f$1_(r2) {
  if (Array.isArray(r2)) {
    const n2 = [];
    for (const t2 of r2)
      n2.push(...c$3p(t2));
    return n2;
  }
  return c$3p(r2);
}
function y$1J(n2, t2, e2, i2) {
  const u2 = f$1_(t2);
  if (u2.length !== 1) {
    const t3 = u2.map((r2) => i2(n2, r2, e2));
    return r$1X(t3);
  }
  return i2(n2, u2[0], e2);
}
function h$1T(r2) {
  let n2 = false;
  return () => {
    n2 || (n2 = true, r2());
  };
}
function e$29(t2, e2) {
  const i2 = t2[t2.length - 1] === "?" ? t2.slice(0, -1) : t2;
  if (e2.getItemAt != null || Array.isArray(e2)) {
    const t3 = parseInt(i2, 10);
    if (!isNaN(t3))
      return Array.isArray(e2) ? e2[t3] : e2.getItemAt(t3);
  }
  const u2 = e$2a(e2);
  return i$3a(u2, i2) ? u2.get(i2) : e2[i2];
}
function i$39(t2, n2, r2) {
  if (t2 == null)
    return t2;
  const u2 = e$29(n2[r2], t2);
  return !u2 && r2 < n2.length - 1 ? void 0 : r2 === n2.length - 1 ? u2 : i$39(u2, n2, r2 + 1);
}
function u$2k(n2, r2, u2 = 0) {
  return typeof r2 != "string" || r2.includes(".") ? i$39(n2, s$2x(r2), u2) : e$29(r2, n2);
}
function o$2k(t2, n2) {
  return u$2k(t2, n2);
}
function s$2w(t2, n2) {
  return u$2k(n2, t2) !== void 0;
}
class o$2j {
  constructor(t2) {
    this.autoDestroy = false, this.properties = t2;
  }
}
function n$2T(r2) {
  let n2 = r2.constructor.__accessorMetadata__;
  const c2 = Object.prototype.hasOwnProperty.call(r2.constructor, "__accessorMetadata__");
  if (n2) {
    if (!c2) {
      const e2 = Object.create(n2.properties), c3 = n2.autoDestroy;
      for (const r3 in e2)
        e2[r3] = y$1L(e2[r3]);
      n2 = new o$2j(e2), n2.autoDestroy = c3, Object.defineProperty(r2.constructor, "__accessorMetadata__", { value: n2, enumerable: false, configurable: true, writable: true });
    }
  } else
    n2 = new o$2j({}), Object.defineProperty(r2.constructor, "__accessorMetadata__", { value: n2, enumerable: false, configurable: true, writable: true });
  return x$16(r2.constructor.__accessorMetadata__);
}
function c$3o(t2) {
  return n$2T(t2).properties;
}
function s$2v(t2, e2) {
  const r2 = c$3o(t2);
  let o2 = r2[e2];
  return o2 || (o2 = r2[e2] = {}), o2;
}
function i$38(t2, e2) {
  return o$2l(t2, e2, _$Q);
}
const p$3I = /^(?:[^.]+\.)?(?:value|type|(?:json\.type|json\.origins\.[^.]\.type))$/;
function _$Q(t2) {
  return p$3I.test(t2) ? "replace" : "merge";
}
function e$28(e2, r2) {
  return e2.replace(/\$\{([^\s\:\}]*)(?:\:([^\s\:\}]+))?\}/g, (e3, s2) => {
    if (s2 === "")
      return "$";
    const n2 = t$2o(s2, r2), i2 = n2 != null ? n2 : "";
    if (i2 === void 0)
      throw new Error(`could not find key "${s2}" in template`);
    return i2.toString();
  });
}
class r$1W {
  constructor(t2, s2, n2) {
    var _a2;
    this.name = t2, this.details = n2, this instanceof r$1W && (this.message = (_a2 = s2 && e$28(s2, n2)) != null ? _a2 : "");
  }
  toString() {
    return "[" + this.name + "]: " + this.message;
  }
}
class s$2u extends r$1W {
  constructor(e2, t2, r2) {
    if (super(e2, t2, r2), !(this instanceof s$2u))
      return new s$2u(e2, t2, r2);
  }
  toJSON() {
    if (this.details != null)
      try {
        return { name: this.name, message: this.message, details: JSON.parse(JSON.stringify(this.details, (t2, r2) => {
          if (r2 && typeof r2 == "object" && typeof r2.toJSON == "function")
            return r2;
          try {
            return y$1L(r2);
          } catch (s2) {
            return "[object]";
          }
        })) };
      } catch (r2) {
        throw s$2z.getLogger("esri.core.Error").error(r2), r2;
      }
    return { name: this.name, message: this.message, details: this.details };
  }
  static fromJSON(e2) {
    return new s$2u(e2.name, e2.message, e2.details);
  }
}
s$2u.prototype.type = "error";
function t$2k(o2, e2, s2) {
  if (o2 && e2)
    if (typeof e2 == "object")
      for (const r2 of Object.getOwnPropertyNames(e2))
        t$2k(o2, r2, e2[r2]);
    else {
      if (e2.includes(".")) {
        const n2 = e2.split("."), i3 = n2.splice(n2.length - 1, 1)[0];
        return void t$2k(o$2k(o2, n2), i3, s2);
      }
      const i2 = o2.__accessor__;
      i2 != null && n$2S(e2, i2), o2[e2] = s2;
    }
}
function n$2S(r2, t2) {
  if (has("esri-unknown-property-errors") && !e$27(r2, t2))
    throw new s$2u("set:unknown-property", s$2t(r2, t2));
}
function e$27(o2, r2) {
  return r2.metadatas[o2] != null;
}
function s$2t(o2, r2) {
  return "setting unknown property '" + o2 + "' on instance of " + r2.host.declaredClass;
}
function y$1I(n2 = {}) {
  return (o2, s2) => {
    if (o2 === Function.prototype)
      throw new Error(`Inappropriate use of @property() on a static field: ${o2.name}.${s2}. Accessor does not support static properties.`);
    const i2 = Object.getOwnPropertyDescriptor(o2, s2), a2 = s$2v(o2, s2);
    i2 && (i2.get || i2.set ? (a2.get = i2.get || a2.get, a2.set = i2.set || a2.set) : "value" in i2 && ("value" in n2 && s$2z.getLogger("esri.core.accessorSupport.decorators.property").warn(`@property() will redefine the value of "${s2}" on "${o2.constructor.name}" already defined in the metadata`, n2), a2.value = n2.value = i2.value)), n2.readOnly != null && (a2.readOnly = n2.readOnly);
    const p2 = n2.aliasOf;
    if (p2) {
      const t2 = typeof p2 == "string" ? p2 : p2.source, e2 = typeof p2 == "string" ? null : p2.overridable === true;
      let r2;
      a2.dependsOn = [t2], a2.get = function() {
        let e3 = o$2k(this, t2);
        if (typeof e3 == "function") {
          r2 || (r2 = t2.split(".").slice(0, -1).join("."));
          const n3 = o$2k(this, r2);
          n3 && (e3 = e3.bind(n3));
        }
        return e3;
      }, a2.readOnly || (a2.set = e2 ? function(t3) {
        this._override(s2, t3);
      } : function(e3) {
        t$2k(this, t2, e3);
      });
    }
    const u2 = n2.type, c2 = n2.types;
    a2.cast || (u2 ? a2.cast = h$1S(u2) : c2 && (Array.isArray(c2) ? a2.cast = m$2w(S$V(c2[0])) : a2.cast = S$V(c2))), i$38(a2, n2), n2.range && (a2.cast = j$11(a2.cast, n2.range));
  };
}
function d$1$(t2, e2, r2) {
  const n2 = s$2v(t2, r2);
  n2.json || (n2.json = {});
  let o2 = n2.json;
  return e2 !== void 0 && (o2.origins || (o2.origins = {}), o2.origins[e2] || (o2.origins[e2] = {}), o2 = o2.origins[e2]), o2;
}
function h$1S(t2) {
  let e2 = 0, r2 = t2;
  if (_$R(t2))
    return B$y(t2);
  for (; Array.isArray(r2) && r2.length === 1 && typeof r2[0] != "string" && typeof r2[0] != "number"; )
    r2 = r2[0], e2++;
  const f2 = r2;
  if (k$H(f2))
    return e2 === 0 ? M$N(f2) : $$m(M$N(f2), e2);
  if (e2 === 1)
    return w$13(f2);
  if (e2 > 1)
    return j$12(f2, e2);
  const l2 = t2;
  return l2.from ? l2.from : b$1a(l2);
}
function j$11(t2, e2) {
  return (r2) => {
    let n2 = +t2(r2);
    return e2.step != null && (n2 = Math.round(n2 / e2.step) * e2.step), e2.min != null && (n2 = Math.max(e2.min, n2)), e2.max != null && (n2 = Math.min(e2.max, n2)), n2;
  };
}
var I$M;
!function(I2) {
  I2[I2.INITIALIZING = 0] = "INITIALIZING", I2[I2.CONSTRUCTING = 1] = "CONSTRUCTING", I2[I2.CONSTRUCTED = 2] = "CONSTRUCTED";
}(I$M || (I$M = {}));
var i$37;
!function(i2) {
  i2[i2.Dirty = 1] = "Dirty", i2[i2.Overriden = 2] = "Overriden", i2[i2.Computing = 4] = "Computing", i2[i2.NonNullable = 8] = "NonNullable", i2[i2.HasDefaultValue = 16] = "HasDefaultValue", i2[i2.DepTrackingInitialized = 32] = "DepTrackingInitialized", i2[i2.AutoTracked = 64] = "AutoTracked", i2[i2.ExplicitlyTracking = 128] = "ExplicitlyTracking";
}(i$37 || (i$37 = {}));
const o$2i = { onObservableAccessed: () => {
}, onTrackingEnd: () => {
} }, c$3n = [];
let i$36 = o$2i;
function s$2s(t2) {
  i$36.onObservableAccessed(t2);
}
let l$2J = false, a$2Z = false;
function f$1Z(t2, n2, e2) {
  if (l$2J)
    return u$2j(t2, n2, e2);
  p$3H(t2);
  const r2 = n2.call(e2);
  return d$1_(), r2;
}
function g$1p(t2, n2) {
  return f$1Z(o$2i, t2, n2);
}
function u$2j(n2, e2, r2) {
  const o2 = l$2J;
  l$2J = true, p$3H(n2);
  let c2 = null;
  try {
    c2 = e2.call(r2);
  } catch (i2) {
    a$2Z && s$2z.getLogger("esri.core.accessorSupport.tracking").error(i2);
  }
  return d$1_(), l$2J = o2, c2;
}
function p$3H(t2) {
  i$36 = t2, c$3n.push(t2);
}
function d$1_() {
  const t2 = c$3n.length;
  if (t2 > 1) {
    const n2 = c$3n.pop();
    i$36 = c$3n[t2 - 2], n2.onTrackingEnd();
  } else if (t2 === 1) {
    const t3 = c$3n.pop();
    i$36 = o$2i, t3.onTrackingEnd();
  } else
    i$36 = o$2i;
}
function m$2v(t2, n2) {
  if (n2.flags & i$37.DepTrackingInitialized)
    return;
  const e2 = a$2Z;
  a$2Z = false, n2.flags & i$37.AutoTracked ? u$2j(n2, n2.metadata.get, t2) : y$1H(t2, n2), a$2Z = e2;
}
const k$G = [];
function y$1H(t2, e2) {
  e2.flags & i$37.ExplicitlyTracking || (e2.flags |= i$37.ExplicitlyTracking, u$2j(e2, () => {
    const r2 = e2.metadata.dependsOn || k$G;
    for (const e3 of r2)
      if (typeof e3 != "string" || e3.includes(".")) {
        const r3 = s$2x(e3);
        for (let n2 = 0, e4 = t2; n2 < r3.length && e4 != null && typeof e4 == "object"; ++n2)
          e4 = A$C(e4, r3[n2], n2 !== r3.length - 1);
      } else
        A$C(t2, e3, false);
  }), e2.flags &= ~i$37.ExplicitlyTracking);
}
function A$C(t2, n2, r2) {
  var _a2;
  const o2 = n2[n2.length - 1] === "?" ? n2.slice(0, -1) : n2;
  if (t2.getItemAt != null || Array.isArray(t2)) {
    const n3 = parseInt(o2, 10);
    if (!isNaN(n3))
      return Array.isArray(t2) ? t2[n3] : t2.getItemAt(n3);
  }
  const c2 = (_a2 = e$2a(t2)) == null ? void 0 : _a2.properties.get(o2);
  return c2 && (s$2s(c2), m$2v(t2, c2)), r2 ? t2[o2] : void 0;
}
function n$2R(n2) {
  if (n2.json && n2.json.origins) {
    const o2 = n2.json.origins, e2 = { "web-document": ["web-scene", "web-map"] };
    for (const n3 in e2)
      if (o2[n3]) {
        const s2 = o2[n3];
        e2[n3].forEach((n4) => {
          o2[n4] = s2;
        }), delete o2[n3];
      }
  }
}
class t$2j extends r$1W {
  constructor(e2, s2, r2) {
    if (super(e2, s2, r2), !(this instanceof t$2j))
      return new t$2j(e2, s2, r2);
  }
}
t$2j.prototype.type = "warning";
function e$26(e2) {
  return !!e2 && e2.prototype && e2.prototype.declaredClass && e2.prototype.declaredClass.indexOf("esri.core.Collection") === 0;
}
const i$35 = s$2z.getLogger("esri.core.accessorSupport.extensions.serializableProperty.reader");
function p$3G(t2, r2, n2) {
  var _a2, _b2;
  t2 && (!n2 && !r2.read || ((_a2 = r2.read) == null ? void 0 : _a2.reader) || ((_b2 = r2.read) == null ? void 0 : _b2.enabled) === false || l$2I(t2) && o$2q("read.reader", s$2r(t2), r2));
}
function s$2r(t2) {
  var _a2, _b2, _c2;
  const e2 = (_a2 = t2.ndimArray) != null ? _a2 : 0;
  if (e2 > 1)
    return c$3m(t2);
  if (e2 === 1)
    return a$2Y(t2);
  if ("type" in t2 && d$1Z(t2.type)) {
    const e3 = (_c2 = (_b2 = t2.type.prototype) == null ? void 0 : _b2.itemType) == null ? void 0 : _c2.Type, r2 = a$2Y(typeof e3 == "function" ? { type: e3 } : { types: e3 });
    return (e4, n2, o2) => {
      const i2 = r2(e4, n2, o2);
      return i2 ? new t2.type(i2) : i2;
    };
  }
  return u$2i(t2);
}
function u$2i(t2) {
  return "type" in t2 ? y$1G(t2.type) : g$1o(t2.types);
}
function y$1G(t2) {
  return t2.prototype.read ? (e2, r2, n2) => {
    if (e2 == null)
      return e2;
    const o2 = typeof e2;
    if (o2 !== "object")
      return void i$35.error(`Expected JSON value of type 'object' to deserialize type '${t2.prototype.declaredClass}', but got '${o2}'`);
    const p2 = new t2();
    return p2.read(e2, n2), p2;
  } : t2.fromJSON;
}
function f$1Y(t2, e2, r2, n2) {
  return n2 !== 0 && Array.isArray(e2) ? e2.map((e3) => f$1Y(t2, e3, r2, n2 - 1)) : t2(e2, void 0, r2);
}
function c$3m(t2) {
  var _a2;
  const e2 = u$2i(t2), r2 = f$1Y.bind(null, e2), n2 = (_a2 = t2.ndimArray) != null ? _a2 : 0;
  return (t3, e3, o2) => {
    if (t3 == null)
      return t3;
    t3 = r2(t3, o2, n2);
    let i2 = n2, p2 = t3;
    for (; i2 > 0 && Array.isArray(p2); )
      i2--, p2 = p2[0];
    if (p2 !== void 0)
      for (let r3 = 0; r3 < i2; r3++)
        t3 = [t3];
    return t3;
  };
}
function a$2Y(t2) {
  const e2 = u$2i(t2);
  return (t3, r2, n2) => {
    if (t3 == null)
      return t3;
    if (Array.isArray(t3)) {
      const r3 = [];
      for (const o3 of t3) {
        const t4 = e2(o3, void 0, n2);
        t4 !== void 0 && r3.push(t4);
      }
      return r3;
    }
    const o2 = e2(t3, void 0, n2);
    return o2 !== void 0 ? [o2] : void 0;
  };
}
function d$1Z(t2) {
  if (!e$26(t2))
    return false;
  const e2 = t2.prototype.itemType;
  return !(!e2 || !e2.Type) && (typeof e2.Type == "function" ? m$2u(e2.Type) : j$10(e2.Type));
}
function l$2I(t2) {
  return "types" in t2 ? j$10(t2.types) : m$2u(t2.type);
}
function m$2u(t2) {
  return !Array.isArray(t2) && (!!t2 && t2.prototype && ("read" in t2.prototype || "fromJSON" in t2 || d$1Z(t2)));
}
function j$10(t2) {
  for (const e2 in t2.typeMap) {
    if (!m$2u(t2.typeMap[e2]))
      return false;
  }
  return true;
}
function g$1o(t2) {
  var _a2;
  let e2 = null;
  const n2 = (_a2 = t2.errorContext) != null ? _a2 : "type";
  return (o2, p2, s2) => {
    if (o2 == null)
      return o2;
    const u2 = typeof o2;
    if (u2 !== "object")
      return void i$35.error(`Expected JSON value of type 'object' to deserialize, but got '${u2}'`);
    e2 || (e2 = v$1b(t2));
    const y2 = t2.key;
    if (typeof y2 != "string")
      return;
    const f2 = o2[y2], c2 = f2 ? e2[f2] : t2.defaultKeyValue ? t2.typeMap[t2.defaultKeyValue] : void 0;
    if (!c2) {
      const t3 = `Type '${f2 || "unknown"}' is not supported`;
      return s2 && s2.messages && o2 && s2.messages.push(new t$2j(`${n2}:unsupported`, t3, { definition: o2, context: s2 })), void i$35.error(t3);
    }
    const a2 = new c2();
    return a2.read(o2, s2), a2;
  };
}
function v$1b(t2) {
  var _a2, _b2;
  const e2 = {};
  for (const r2 in t2.typeMap) {
    const o2 = t2.typeMap[r2], i2 = n$2T(o2.prototype);
    if (typeof t2.key == "function")
      continue;
    const p2 = i2.properties[t2.key];
    if (!p2)
      continue;
    ((_a2 = p2.json) == null ? void 0 : _a2.type) && Array.isArray(p2.json.type) && p2.json.type.length === 1 && typeof p2.json.type[0] == "string" && (e2[p2.json.type[0]] = o2);
    const s2 = (_b2 = p2.json) == null ? void 0 : _b2.write;
    if (!s2 || !s2.writer) {
      e2[r2] = o2;
      continue;
    }
    const u2 = s2.target, y2 = typeof u2 == "string" ? u2 : t2.key, f2 = {};
    s2.writer(r2, f2, y2), f2[y2] && (e2[f2[y2]] = o2);
  }
  return e2;
}
function e$25(e2) {
  if (e2.json || (e2.json = {}), o$2h(e2.json), n$2Q(e2.json), r$1V(e2.json), e2.json.origins)
    for (const t2 in e2.json.origins)
      o$2h(e2.json.origins[t2]), n$2Q(e2.json.origins[t2]), r$1V(e2.json.origins[t2]);
  return true;
}
function r$1V(e2) {
  e2.name && (e2.read && typeof e2.read == "object" ? e2.read.source === void 0 && (e2.read.source = e2.name) : e2.read = { source: e2.name }, e2.write && typeof e2.write == "object" ? e2.write.target === void 0 && (e2.write.target = e2.name) : e2.write = { target: e2.name });
}
function o$2h(e2) {
  typeof e2.read == "boolean" ? e2.read = { enabled: e2.read } : typeof e2.read == "function" ? e2.read = { enabled: true, reader: e2.read } : e2.read && typeof e2.read == "object" && e2.read.enabled === void 0 && (e2.read.enabled = true);
}
function n$2Q(e2) {
  typeof e2.write == "boolean" ? e2.write = { enabled: e2.write } : typeof e2.write == "function" ? e2.write = { enabled: true, writer: e2.write } : e2.write && typeof e2.write == "object" && e2.write.enabled === void 0 && (e2.write.enabled = true);
}
function i$34(r2, e2) {
  var _a2;
  if (!e2.write || e2.write.writer || e2.write.enabled === false && !e2.write.overridePolicy)
    return;
  const t2 = (_a2 = r2 == null ? void 0 : r2.ndimArray) != null ? _a2 : 0;
  r2 && (t2 === 1 || "type" in r2 && e$26(r2.type)) ? e2.write.writer = a$2X : t2 > 1 ? e2.write.writer = l$2H(t2) : e2.types ? Array.isArray(e2.types) ? e2.write.writer = f$1X(e2.types[0]) : e2.write.writer = o$2g(e2.types) : e2.write.writer = s$2q;
}
function o$2g(r2) {
  return (e2, t2, n2, i2) => e2 ? u$2h(e2, r2, i2) ? s$2q(e2, t2, n2, i2) : void 0 : s$2q(e2, t2, n2, i2);
}
function u$2h(t2, n2, i2) {
  var _a2, _b2;
  for (const r2 in n2.typeMap)
    if (t2 instanceof n2.typeMap[r2])
      return true;
  if (i2 == null ? void 0 : i2.messages) {
    const o2 = (_a2 = n2.errorContext) != null ? _a2 : "type", u2 = `Values of type '${(_b2 = typeof n2.key != "function" ? t2[n2.key] : t2.declaredClass) != null ? _b2 : "Unknown"}' cannot be written`;
    i2 && i2.messages && t2 && i2.messages.push(new s$2u(`${o2}:unsupported`, u2, { definition: t2, context: i2 })), s$2z.getLogger("esri.core.accessorSupport.extensions.serializableProperty.writer").error(u2);
  }
  return false;
}
function f$1X(r2) {
  return (e2, t2, n2, i2) => {
    if (!e2 || !Array.isArray(e2))
      return s$2q(e2, t2, n2, i2);
    return s$2q(e2.filter((e3) => u$2h(e3, r2, i2)), t2, n2, i2);
  };
}
function s$2q(r2, e2, n2, i2) {
  o$2q(n2, p$3F(r2, i2), e2);
}
function p$3F(r2, e2) {
  return r2 && typeof r2.write == "function" ? r2.write({}, e2) : r2 && typeof r2.toJSON == "function" ? r2.toJSON() : typeof r2 == "number" ? y$1F(r2) : r2;
}
function y$1F(r2) {
  return r2 === -1 / 0 ? -Number.MAX_VALUE : r2 === 1 / 0 ? Number.MAX_VALUE : isNaN(r2) ? null : r2;
}
function a$2X(r2, e2, n2, i2) {
  let o2;
  r2 === null ? o2 = null : r2 && typeof r2.map == "function" ? (o2 = r2.map((r3) => p$3F(r3, i2)), typeof o2.toArray == "function" && (o2 = o2.toArray())) : o2 = [p$3F(r2, i2)], o$2q(n2, o2, e2);
}
function c$3l(r2, e2, t2) {
  return t2 !== 0 && Array.isArray(r2) ? r2.map((r3) => c$3l(r3, e2, t2 - 1)) : p$3F(r2, e2);
}
function l$2H(r2) {
  return (e2, n2, i2, o2) => {
    let u2;
    if (e2 === null)
      u2 = null;
    else {
      u2 = c$3l(e2, o2, r2);
      let t2 = r2, n3 = u2;
      for (; t2 > 0 && Array.isArray(n3); )
        t2--, n3 = n3[0];
      if (n3 !== void 0)
        for (let r3 = 0; r3 < t2; r3++)
          u2 = [u2];
    }
    o$2q(i2, u2, n2);
  };
}
function t$2i(r2, n2) {
  return a$2W(r2, "read", n2);
}
function s$2p(r2, n2) {
  return a$2W(r2, "write", n2);
}
function a$2W(r2, n2, i2) {
  let e2 = r2 && r2.json;
  if (r2 && r2.json && r2.json.origins && i2) {
    const o2 = i2.origin && r2.json.origins[i2.origin];
    o2 && (n2 === "any" || n2 in o2) && (e2 = o2);
  }
  return e2;
}
function p$3E(r2) {
  const n2 = y$1E(r2);
  if (r2.json.origins)
    for (const e2 in r2.json.origins) {
      const t2 = r2.json.origins[e2], s2 = t2.types ? f$1W(t2) : n2;
      p$3G(s2, t2, false), t2.types && !t2.write && r2.json.write && r2.json.write.enabled && (t2.write = __spreadValues({}, r2.json.write)), i$34(s2, t2);
    }
  p$3G(n2, r2.json, true), i$34(n2, r2.json);
}
function y$1E(r2) {
  return r2.json.types ? u$2g(r2.json) : r2.type ? j$$(r2) : u$2g(r2);
}
function f$1W(r2) {
  return r2.type ? j$$(r2) : u$2g(r2);
}
function j$$(n2) {
  if (!n2.type)
    return;
  let i2 = 0, e2 = n2.type;
  for (; Array.isArray(e2) && !k$H(e2); )
    e2 = e2[0], i2++;
  return { type: e2, ndimArray: i2 };
}
function u$2g(r2) {
  if (!r2.types)
    return;
  let n2 = 0, i2 = r2.types;
  for (; Array.isArray(i2); )
    i2 = i2[0], n2++;
  return { types: i2, ndimArray: n2 };
}
function c$3k(r2) {
  e$25(r2) && (n$2R(r2), p$3E(r2));
}
const s$2o = new Set(), i$33 = new Set();
function n$2P(e2) {
  return (r2) => {
    r2.prototype.declaredClass = e2, c$3j(r2);
    const o2 = [], n2 = [];
    let a2 = r2.prototype;
    for (; a2; )
      a2.hasOwnProperty("initialize") && !s$2o.has(a2.initialize) && (s$2o.add(a2.initialize), o2.push(a2.initialize)), a2.hasOwnProperty("destroy") && !i$33.has(a2.destroy) && (i$33.add(a2.destroy), n2.push(a2.destroy)), a2 = Object.getPrototypeOf(a2);
    s$2o.clear(), i$33.clear();
    class l2 extends r2 {
      constructor(...e3) {
        if (super(...e3), this.constructor === l2 && typeof this.postscript == "function") {
          if (o2.length && Object.defineProperty(this, "initialize", { enumerable: false, configurable: true, value() {
            for (let e4 = o2.length - 1; e4 >= 0; e4--)
              o2[e4].call(this);
          } }), n2.length) {
            let e4 = false;
            Object.defineProperty(this, "destroy", { enumerable: false, configurable: true, value() {
              if (!e4) {
                e4 = true;
                for (let e5 = 0; e5 < n2.length; e5++)
                  n2[e5].call(this);
              }
            } });
          }
          this.postscript(...e3);
        }
      }
    }
    return l2.__accessorMetadata__ = n$2T(r2.prototype), l2.prototype.declaredClass = e2, l2;
  };
}
function a$2V(e2, t2) {
  return t2.get == null ? function() {
    const t3 = this.__accessor__.properties.get(e2);
    if (t3 === void 0)
      return;
    s$2s(t3);
    const o2 = this.__accessor__.store;
    return o2.has(e2) ? o2.get(e2) : t3.metadata.value;
  } : function() {
    const t3 = this.__accessor__.properties.get(e2);
    if (t3 !== void 0)
      return t3.getComputed();
  };
}
function c$3j(r2) {
  const s2 = r2.prototype, i2 = n$2T(s2).properties, n2 = {};
  for (const t2 of Object.getOwnPropertyNames(i2)) {
    const r3 = i2[t2];
    c$3k(r3), n2[t2] = { enumerable: true, configurable: true, get: a$2V(t2, r3), set(o2) {
      const s3 = this.__accessor__;
      if (s3 !== void 0) {
        if (!Object.isFrozen(this)) {
          if (s3.initialized && r3.readOnly)
            throw new TypeError(`[accessor] cannot assign to read-only property '${t2}' of ${this.declaredClass}`);
          if (s3.lifecycle === I$M.CONSTRUCTED && r3.constructOnly)
            throw new TypeError(`[accessor] cannot assign to construct-only property '${t2}' of ${this.declaredClass}`);
          s3.set(t2, o2);
        }
      } else
        Object.defineProperty(this, t2, { enumerable: true, configurable: true, writable: true, value: o2 });
    } };
  }
  Object.defineProperties(r2.prototype, n2);
}
function n$2O(n2) {
  const o2 = [];
  return function* () {
    yield* o2;
    for (const t2 of n2)
      o2.push(t2), yield t2;
  };
}
function o$2f(n2, o2) {
  for (const t2 of n2)
    if (t2 != null && o2(t2))
      return t2;
}
function t$2h(n2) {
  return n2 != null && typeof n2[Symbol.iterator] == "function";
}
class t$2g {
  constructor() {
    this._groups = new Map();
  }
  destroy() {
    this.removeAll();
  }
  get size() {
    let r2 = 0;
    return this._groups.forEach((e2) => {
      r2 += e2.length;
    }), r2;
  }
  add(e2, t2) {
    if (t$2h(e2)) {
      const r2 = this._getOrCreateGroup(t2);
      for (const t3 of e2)
        this._isHandle(t3) && r2.push(t3);
    } else if (this._isHandle(e2)) {
      this._getOrCreateGroup(t2).push(e2);
    }
    return this;
  }
  forEach(r2, e2) {
    if (typeof r2 == "function")
      this._groups.forEach((e3) => e3.forEach(r2));
    else {
      const t2 = this._getGroup(r2);
      t2 && e2 && t2.forEach(e2);
    }
  }
  has(r2) {
    return this._groups.has(this._ensureGroupKey(r2));
  }
  remove(e2) {
    if (typeof e2 != "string" && t$2h(e2)) {
      for (const r2 of e2)
        this.remove(r2);
      return this;
    }
    return this.has(e2) ? (this._removeAllFromGroup(this._getGroup(e2)), this._groups.delete(this._ensureGroupKey(e2)), this) : this;
  }
  removeAll() {
    return this._groups.forEach((r2) => this._removeAllFromGroup(r2)), this._groups.clear(), this;
  }
  _isHandle(r2) {
    return r2 && !!r2.remove;
  }
  _getOrCreateGroup(r2) {
    if (this.has(r2))
      return this._getGroup(r2);
    const e2 = [];
    return this._groups.set(this._ensureGroupKey(r2), e2), e2;
  }
  _getGroup(r2) {
    return x$16(this._groups.get(this._ensureGroupKey(r2)));
  }
  _ensureGroupKey(r2) {
    return r2 || "_default_";
  }
  _removeAllFromGroup(r2) {
    r2.forEach((r3) => r3.remove());
  }
}
function t$2f(t2) {
  return t2 && t2.release && typeof t2.release == "function";
}
function i$32(t2) {
  return t2 && t2.acquire && typeof t2.acquire == "function";
}
class e$24 {
  constructor(t2, i2, e2, o2 = 1, s2 = 0) {
    if (this._ctor = t2, this._acquireFunction = i2, this._releaseFunction = e2, this.allocationSize = o2, this._pool = new Array(s2), this._initialSize = s2, this._ctor)
      for (let n2 = 0; n2 < s2; n2++)
        this._pool[n2] = new this._ctor();
    this.allocationSize = Math.max(o2, 1);
  }
  destroy() {
    this.prune(0);
  }
  acquire(...t2) {
    let o2;
    if (e$24.test.disabled)
      o2 = new this._ctor();
    else {
      if (this._pool.length === 0) {
        const t3 = this.allocationSize;
        for (let i2 = 0; i2 < t3; i2++)
          this._pool[i2] = new this._ctor();
      }
      o2 = this._pool.pop();
    }
    return this._acquireFunction ? this._acquireFunction(o2, ...t2) : i$32(o2) && o2.acquire(...t2), o2;
  }
  release(i2) {
    i2 && !e$24.test.disabled && (this._releaseFunction ? this._releaseFunction(i2) : t$2f(i2) && i2.release(), this._pool.push(i2));
  }
  prune(t2 = this._initialSize) {
    if (!(t2 >= this._pool.length)) {
      for (let i2 = t2; i2 < this._pool.length; ++i2) {
        const t3 = this._pool[i2];
        this._dispose(t3);
      }
      this._pool.length = t2;
    }
  }
  _dispose(t2) {
    t2.dispose && typeof t2.dispose == "function" && t2.dispose();
  }
}
e$24.test = { disabled: false };
var r$1U;
!function(e2) {
  e2[e2.DEFAULTS = 0] = "DEFAULTS", e2[e2.COMPUTED = 1] = "COMPUTED", e2[e2.SERVICE = 2] = "SERVICE", e2[e2.PORTAL_ITEM = 3] = "PORTAL_ITEM", e2[e2.WEB_SCENE = 4] = "WEB_SCENE", e2[e2.WEB_MAP = 5] = "WEB_MAP", e2[e2.USER = 6] = "USER";
}(r$1U || (r$1U = {}));
const E$R = r$1U.USER + 1;
function t$2e(e2) {
  switch (e2) {
    case "defaults":
      return r$1U.DEFAULTS;
    case "service":
      return r$1U.SERVICE;
    case "portal-item":
      return r$1U.PORTAL_ITEM;
    case "web-scene":
      return r$1U.WEB_SCENE;
    case "web-map":
      return r$1U.WEB_MAP;
    case "user":
      return r$1U.USER;
    default:
      return null;
  }
}
function n$2N(E2) {
  switch (E2) {
    case r$1U.DEFAULTS:
      return "defaults";
    case r$1U.SERVICE:
      return "service";
    case r$1U.PORTAL_ITEM:
      return "portal-item";
    case r$1U.WEB_SCENE:
      return "web-scene";
    case r$1U.WEB_MAP:
      return "web-map";
    case r$1U.USER:
      return "user";
  }
  return x$16(void 0);
}
function c$3i(e2) {
  return n$2N(e2);
}
class s$2n {
  constructor(r2, s2) {
    this._observers = r2, this._observer = s2;
  }
  remove() {
    C$G(this._observers, this._observer);
  }
}
class l$2G {
  constructor(s2, t2, e2) {
    this.properties = s2, this.propertyName = t2, this.metadata = e2, this._observers = null, this._accessed = null, this._handles = null, this.flags = i$37.Dirty | (e2.nonNullable ? i$37.NonNullable : 0) | (e2.hasOwnProperty("value") ? i$37.HasDefaultValue : 0) | (e2.get === void 0 ? i$37.DepTrackingInitialized : 0) | (e2.dependsOn === void 0 ? i$37.AutoTracked : 0);
  }
  destroy() {
    if (this.flags & i$37.Dirty && this._observers) {
      const s2 = this._observers.slice();
      for (const t2 of s2)
        t2.onCommitted();
    }
    this._accessed = null, this._observers = null, this._clearObservationHandles();
  }
  getComputed() {
    s$2s(this);
    const o2 = this.properties.store, l2 = this.propertyName, a2 = this.flags, h2 = o2.get(l2);
    if (a2 & i$37.Computing)
      return h2;
    if (~a2 & i$37.Dirty && o2.has(l2))
      return h2;
    this.flags |= i$37.Computing;
    const d2 = this.properties.host;
    let c2;
    a2 & i$37.AutoTracked ? c2 = f$1Z(this, this.metadata.get, d2) : (y$1H(d2, this), c2 = this.metadata.get.call(d2)), o2.set(l2, c2, r$1U.COMPUTED);
    const u2 = o2.get(l2);
    return u2 === h2 ? this.flags &= ~i$37.Dirty : g$1p(this.commit, this), this.flags &= ~i$37.Computing, u2;
  }
  onObservableAccessed(s2) {
    s2 !== this && (this._accessed === null && (this._accessed = []), this._accessed.includes(s2) || this._accessed.push(s2));
  }
  onTrackingEnd() {
    this._clearObservationHandles(), this.flags |= i$37.DepTrackingInitialized;
    const s2 = this._accessed;
    if (s2 === null)
      return;
    let t2 = this._handles;
    t2 === null && (t2 = this._handles = []);
    for (let e2 = 0; e2 < s2.length; ++e2)
      t2.push(s2[e2].observe(this));
    s2.length = 0;
  }
  observe(s2) {
    return this._observers === null && (this._observers = []), this._observers.includes(s2) || this._observers.push(s2), new s$2n(this._observers, s2);
  }
  notifyChange() {
    this.onInvalidated(), this.onCommitted();
  }
  invalidate() {
    this.onInvalidated();
  }
  onInvalidated() {
    ~this.flags & i$37.Overriden && (this.flags |= i$37.Dirty);
    const s2 = this._observers;
    if (s2 !== null)
      for (let t2 = 0; t2 < s2.length; ++t2)
        s2[t2].onInvalidated();
  }
  commit() {
    this.flags &= ~i$37.Dirty, this.onCommitted();
  }
  onCommitted() {
    if (this._observers === null)
      return;
    const s2 = this._observers.slice();
    for (let t2 = 0; t2 < s2.length; ++t2)
      s2[t2].onCommitted();
  }
  _clearObservationHandles() {
    const s2 = this._handles;
    if (s2 !== null) {
      for (let t2 = 0; t2 < s2.length; ++t2)
        s2[t2].remove();
      s2.length = 0;
    }
  }
}
class t$2d {
  constructor() {
    this._values = new Map(), this.multipleOriginsSupported = false;
  }
  clone(s2) {
    const r2 = new t$2d();
    return this._values.forEach((t2, i2) => {
      s2 && s2.has(i2) || r2.set(i2, y$1L(t2));
    }), r2;
  }
  get(e2) {
    return this._values.get(e2);
  }
  originOf() {
    return r$1U.USER;
  }
  keys() {
    return [...this._values.keys()];
  }
  set(e2, s2) {
    this._values.set(e2, s2);
  }
  delete(e2) {
    this._values.delete(e2);
  }
  has(e2) {
    return this._values.has(e2);
  }
  forEach(e2) {
    this._values.forEach(e2);
  }
}
function g$1n(t2, e2, s2) {
  return t2 !== void 0;
}
function d$1Y(t2, e2, s2, r2) {
  return t2 !== void 0 && (!(s2 == null && t2.flags & i$37.NonNullable) || (r2.lifecycle, I$M.INITIALIZING, false));
}
function m$2t(t2) {
  return t2 && typeof t2.destroy == "function";
}
s$2z.getLogger("esri.core.accessorSupport.Properties");
class v$1a {
  constructor(t2) {
    this.host = t2, this.properties = new Map(), this.ctorArgs = null, this.destroyed = false, this.lifecycle = I$M.INITIALIZING, this.store = new t$2d(), this._origin = r$1U.USER;
    const e2 = this.host.constructor.__accessorMetadata__, s2 = e2.properties;
    for (const i2 in s2) {
      const t3 = new l$2G(this, i2, s2[i2]);
      this.properties.set(i2, t3);
    }
    this.metadatas = s2, this._autoDestroy = e2.autoDestroy;
  }
  initialize() {
    this.lifecycle = I$M.CONSTRUCTING;
  }
  constructed() {
    this.lifecycle = I$M.CONSTRUCTED;
  }
  destroy() {
    if (this.destroyed = true, this._autoDestroy)
      for (const [t2, e2] of this.properties) {
        const s2 = this.internalGet(t2);
        s2 && m$2t(s2) && (s2.destroy(), ~e2.flags & i$37.NonNullable && this._internalSet(e2, null)), e2.destroy();
      }
    else
      for (const [t2, e2] of this.properties)
        e2.destroy();
  }
  get initialized() {
    return this.lifecycle !== I$M.INITIALIZING;
  }
  get(t2) {
    const e2 = this.properties.get(t2);
    if (e2.metadata.get)
      return e2.getComputed();
    s$2s(e2);
    const s2 = this.store;
    return s2.has(t2) ? s2.get(t2) : e2.metadata.value;
  }
  originOf(t2) {
    const e2 = this.store.originOf(t2);
    if (e2 === void 0) {
      const e3 = this.properties.get(t2);
      if (e3 !== void 0 && e3.flags & i$37.HasDefaultValue)
        return "defaults";
    }
    return n$2N(e2);
  }
  has(t2) {
    return !!this.properties.has(t2) && this.store.has(t2);
  }
  keys() {
    return [...this.properties.keys()];
  }
  internalGet(t2) {
    const e2 = this.properties.get(t2);
    if (g$1n(e2))
      return this.store.has(t2) ? this.store.get(t2) : e2.metadata.value;
  }
  internalSet(t2, e2) {
    const s2 = this.properties.get(t2);
    g$1n(s2) && this._internalSet(s2, e2);
  }
  getDependsInfo(t2, e2, s2) {
    const i2 = this.properties.get(e2);
    if (!g$1n(i2))
      return "";
    const o2 = new Set(), n2 = f$1Z({ onObservableAccessed: (t3) => o2.add(t3), onTrackingEnd: () => {
    } }, () => {
      var _a2;
      return (_a2 = i2.metadata.get) == null ? void 0 : _a2.call(t2);
    });
    let a2 = `${s2}${t2.declaredClass.split(".").pop()}.${e2}: ${n2}
`;
    if (o2.size === 0)
      return a2;
    s2 += "  ";
    for (const l2 of o2) {
      if (!(l2 instanceof l$2G))
        continue;
      const t3 = l2.properties.host, e3 = l2.propertyName, i3 = e$2a(t3);
      a2 += i3 ? i3.getDependsInfo(t3, e3, s2) : `${s2}${e3}: undefined
`;
    }
    return a2;
  }
  setAtOrigin(t2, e2, s2) {
    const i2 = this.properties.get(t2);
    if (g$1n(i2))
      return this._setAtOrigin(i2, e2, s2);
  }
  isOverridden(t2) {
    const e2 = this.properties.get(t2);
    return e2 !== void 0 && !!(e2.flags & i$37.Overriden);
  }
  clearOverride(t2) {
    const e2 = this.properties.get(t2);
    e2 !== void 0 && e2.flags & i$37.Overriden && (e2.flags &= ~i$37.Overriden, e2.notifyChange());
  }
  override(t2, e2) {
    const s2 = this.properties.get(t2);
    if (!d$1Y(s2, t2, e2, this))
      return;
    const i2 = s2.metadata.cast;
    if (i2) {
      const t3 = this._cast(i2, e2), { valid: s3, value: r2 } = t3;
      if (I$L.release(t3), !s3)
        return;
      e2 = r2;
    }
    s2.flags |= i$37.Overriden, this._internalSet(s2, e2);
  }
  set(t2, e2) {
    const s2 = this.properties.get(t2);
    if (!d$1Y(s2, t2, e2, this))
      return;
    const i2 = s2.metadata.cast;
    if (i2) {
      const t3 = this._cast(i2, e2), { valid: s3, value: r3 } = t3;
      if (I$L.release(t3), !s3)
        return;
      e2 = r3;
    }
    const r2 = s2.metadata.set;
    r2 ? r2.call(this.host, e2) : this._internalSet(s2, e2);
  }
  setDefaultOrigin(t2) {
    this._origin = t$2e(t2);
  }
  getDefaultOrigin() {
    return n$2N(this._origin);
  }
  notifyChange(t2) {
    const e2 = this.properties.get(t2);
    e2 !== void 0 && e2.notifyChange();
  }
  invalidate(t2) {
    const e2 = this.properties.get(t2);
    e2 !== void 0 && e2.invalidate();
  }
  commit(t2) {
    const e2 = this.properties.get(t2);
    e2 !== void 0 && e2.commit();
  }
  _internalSet(t2, e2) {
    const s2 = this.lifecycle !== I$M.INITIALIZING ? this._origin : r$1U.DEFAULTS;
    this._setAtOrigin(t2, e2, s2);
  }
  _setAtOrigin(e2, s2, i2) {
    const r2 = this.store, o2 = e2.propertyName;
    r2.has(o2, i2) && w$14(s2, r2.get(o2)) && ~e2.flags & i$37.Overriden && i2 === r2.originOf(o2) || (e2.invalidate(), r2.set(o2, s2, i2), e2.commit(), m$2v(this.host, e2));
  }
  _cast(t2, e2) {
    const s2 = I$L.acquire();
    return s2.valid = true, s2.value = e2, t2 && (s2.value = t2.call(this.host, e2, s2)), s2;
  }
}
class y$1D {
  constructor() {
    this.value = null, this.valid = true;
  }
  acquire() {
    this.valid = true;
  }
  release() {
    this.value = null;
  }
}
const I$L = new e$24(y$1D);
function r$1T(e2) {
  e2.length = 0;
}
class t$2c {
  constructor(t2 = 50, o2 = 50) {
    this._pool = new e$24(Array, void 0, r$1T, o2, t2);
  }
  acquire() {
    return this._pool.acquire();
  }
  release(e2) {
    this._pool.release(e2);
  }
  prune() {
    this._pool.prune(0);
  }
  static acquire() {
    return o$2e.acquire();
  }
  static release(e2) {
    return o$2e.release(e2);
  }
  static prune() {
    o$2e.prune();
  }
}
const o$2e = new t$2c(100);
class t$2b extends e$24 {
  constructor() {
    super(...arguments), this._set = new Set();
  }
  destroy() {
    super.destroy(), this._set = d$23(this._set);
  }
  acquire(...e2) {
    const s2 = super.acquire(...e2);
    return this._set.delete(s2), s2;
  }
  release(e2) {
    e2 && !this._set.has(e2) && (super.release(e2), this._set.add(e2));
  }
  _dispose(e2) {
    this._set.delete(e2), super._dispose(e2);
  }
}
const o$2d = [];
function t$2a(t2) {
  o$2d.push(t2), o$2d.length === 1 && queueMicrotask(() => {
    const t3 = o$2d.slice();
    o$2d.length = 0;
    for (const o2 of t3)
      o2();
  });
}
class e$23 {
  constructor(s2, e2 = 30) {
    this.name = s2, this._counter = 0, this._samples = new Array(e2);
  }
  record(e2) {
    r$1$(e2) && (this._samples[++this._counter % this._samples.length] = e2);
  }
  get median() {
    return this._samples.slice().sort((s2, e2) => s2 - e2)[Math.floor(this._samples.length / 2)];
  }
  get average() {
    return this._samples.reduce((s2, e2) => s2 + e2, 0) / this._samples.length;
  }
  get last() {
    return this._samples[this._counter % this._samples.length];
  }
}
var o$2c;
!function(o2) {
  const t2 = (o3, t3, n3, e3) => {
    let i3 = t3, c2 = t3;
    const l2 = n3 >>> 1, r2 = o3[i3 - 1];
    for (; c2 <= l2; ) {
      c2 = i3 << 1, c2 < n3 && e3(o3[c2 - 1], o3[c2]) < 0 && ++c2;
      const t4 = o3[c2 - 1];
      if (e3(t4, r2) <= 0)
        break;
      o3[i3 - 1] = t4, i3 = c2;
    }
    o3[i3 - 1] = r2;
  }, n2 = (o3, t3) => o3 < t3 ? -1 : o3 > t3 ? 1 : 0;
  function e2(o3, e3, i3, c2) {
    e3 === void 0 && (e3 = 0), i3 === void 0 && (i3 = o3.length), c2 === void 0 && (c2 = n2);
    for (let n3 = i3 >>> 1; n3 > e3; n3--)
      t2(o3, n3, i3, c2);
    const l2 = e3 + 1;
    for (let n3 = i3 - 1; n3 > e3; n3--) {
      const i4 = o3[e3];
      o3[e3] = o3[n3], o3[n3] = i4, t2(o3, l2, n3, c2);
    }
  }
  function* i2(o3, e3, i3, c2) {
    e3 === void 0 && (e3 = 0), i3 === void 0 && (i3 = o3.length), c2 === void 0 && (c2 = n2);
    for (let n3 = i3 >>> 1; n3 > e3; n3--)
      t2(o3, n3, i3, c2), yield;
    const l2 = e3 + 1;
    for (let n3 = i3 - 1; n3 > e3; n3--) {
      const i4 = o3[e3];
      o3[e3] = o3[n3], o3[n3] = i4, t2(o3, l2, n3, c2), yield;
    }
  }
  o2.sort = e2, o2.iterableSort = i2;
}(o$2c || (o$2c = {}));
const t$29 = o$2c;
const a$2U = 1.5, e$22 = 1.1;
class l$2F {
  constructor(h2) {
    this.data = [], this._length = 0, this._allocator = void 0, this._deallocator = () => null, this._shrink = () => {
    }, this._hint = new x$15(), h2 && (h2.initialSize && (this.data = new Array(h2.initialSize)), h2.allocator && (this._allocator = h2.allocator), h2.deallocator !== void 0 && (this._deallocator = h2.deallocator), h2.shrink && (this._shrink = () => n$2M(this)));
  }
  toArray() {
    return this.data.slice(0, this.length);
  }
  filter(t2) {
    const h2 = new Array();
    for (let i2 = 0; i2 < this._length; i2++) {
      const s2 = this.data[i2];
      t2(s2) && h2.push(s2);
    }
    return h2;
  }
  getItemAt(t2) {
    if (!(t2 < 0 || t2 >= this._length))
      return this.data[t2];
  }
  includes(t2, h2) {
    const i2 = this.data.indexOf(t2, h2);
    return i2 !== -1 && i2 < this.length;
  }
  get length() {
    return this._length;
  }
  set length(t2) {
    if (t2 > this._length) {
      if (this._allocator) {
        for (; this._length < t2; )
          this.data[this._length++] = this._allocator(this.data[this._length]);
        return;
      }
      this._length = t2;
    } else {
      if (this._deallocator)
        for (let h2 = t2; h2 < this._length; ++h2)
          this.data[h2] = this._deallocator(this.data[h2]);
      this._length = t2, this._shrink();
    }
  }
  clear() {
    this.length = 0;
  }
  prune() {
    this.clear(), this.data = [];
  }
  push(t2) {
    this.data[this._length++] = t2;
  }
  pushArray(t2, h2 = t2.length) {
    for (let i2 = 0; i2 < h2; i2++)
      this.data[this._length++] = t2[i2];
  }
  fill(t2, h2) {
    for (let i2 = 0; i2 < h2; i2++)
      this.data[this._length++] = t2;
  }
  pushNew() {
    this._allocator && (this.data[this.length] = this._allocator(this.data[this.length]));
    const t2 = this.data[this._length];
    return ++this._length, t2;
  }
  unshift(t2) {
    this.data.unshift(t2), this._length++, n$2M(this);
  }
  pop() {
    if (this.length === 0)
      return;
    const t2 = this.data[this.length - 1];
    return this.length = this.length - 1, this._shrink(), t2;
  }
  remove(t2) {
    const i2 = b$1c(this.data, t2, this.length, this._hint);
    if (i2 !== -1)
      return this.data.splice(i2, 1), this.length = this.length - 1, t2;
  }
  removeUnordered(t2) {
    return this.removeUnorderedIndex(b$1c(this.data, t2, this.length, this._hint));
  }
  removeUnorderedIndex(t2) {
    if (!(t2 >= this.length || t2 < 0))
      return this.swapElements(t2, this.length - 1), this.pop();
  }
  removeUnorderedMany(t2, h2 = t2.length, s2) {
    this.length = j$14(this.data, t2, this.length, h2, this._hint, s2), this._shrink();
  }
  front() {
    if (this.length !== 0)
      return this.data[0];
  }
  back() {
    if (this.length !== 0)
      return this.data[this.length - 1];
  }
  swapElements(t2, h2) {
    if (t2 >= this.length || h2 >= this.length || t2 === h2)
      return;
    const i2 = this.data[t2];
    this.data[t2] = this.data[h2], this.data[h2] = i2;
  }
  sort(t2) {
    t$29.sort(this.data, 0, this.length, t2);
  }
  iterableSort(t2) {
    return t$29.iterableSort(this.data, 0, this.length, t2);
  }
  some(t2, h2) {
    for (let i2 = 0; i2 < this.length; ++i2)
      if (t2.call(h2, this.data[i2], i2, this.data))
        return true;
    return false;
  }
  filterInPlace(t2, h2) {
    let i2 = 0;
    for (let s2 = 0; s2 < this._length; ++s2) {
      const a2 = this.data[s2];
      t2.call(h2, a2, s2, this.data) && (this.data[s2] = this.data[i2], this.data[i2] = a2, i2++);
    }
    if (this._deallocator)
      for (let s2 = i2; s2 < this._length; s2++)
        this.data[s2] = this._deallocator(this.data[s2]);
    return this._length = i2, this._shrink(), this;
  }
  forAll(t2, h2) {
    const i2 = this.length, s2 = this.data;
    for (let a2 = 0; a2 < i2; ++a2)
      t2.call(h2, s2[a2], a2, s2);
  }
  forEach(t2, h2) {
    for (let i2 = 0; i2 < this.length; ++i2)
      t2.call(h2, this.data[i2], i2, this.data);
  }
  map(t2, h2) {
    const i2 = new Array(this.length);
    for (let s2 = 0; s2 < this.length; ++s2)
      i2[s2] = t2.call(h2, this.data[s2], s2, this.data);
    return i2;
  }
  reduce(t2, h2) {
    let i2 = h2;
    for (let s2 = 0; s2 < this.length; ++s2)
      i2 = t2(i2, this.data[s2], s2, this.data);
    return i2;
  }
  has(t2) {
    const h2 = this.length, i2 = this.data;
    for (let s2 = 0; s2 < h2; ++s2)
      if (i2[s2] === t2)
        return true;
    return false;
  }
}
function n$2M(t2) {
  t2.data.length > a$2U * t2.length && (t2.data.length = Math.floor(t2.length * e$22));
}
function e$21(e2) {
  return { setTimeout: (t2, o2) => {
    const r2 = e2.setTimeout(t2, o2);
    return { remove: () => e2.clearTimeout(r2) };
  } };
}
const t$28 = e$21(globalThis);
const n$2L = new Set();
function e$20(e2, i2, o2 = false) {
  o2 && n$2L.has(i2) || (o2 && n$2L.add(i2), e2.warn(`\u{1F6D1} DEPRECATED - ${i2}`));
}
function t$27(n2, e2, i2 = {}) {
  if (has("esri-deprecation-warnings")) {
    const { moduleName: o2 } = i2;
    r$1S(n2, `Property: ${(o2 ? o2 + "::" : "") + e2}`, i2);
  }
}
function r$1S(n2, i2, o2 = {}) {
  if (has("esri-deprecation-warnings")) {
    const { replacement: t2, version: r2, see: s2, warnOnce: a2 } = o2;
    let c2 = i2;
    t2 && (c2 += `
	\u{1F6E0}\uFE0F Replacement: ${t2}`), r2 && (c2 += `
	\u2699\uFE0F Version: ${r2}`), s2 && (c2 += `
	\u{1F517} See ${s2} for more details.`), e$20(n2, c2, a2);
  }
}
function e$1$(e2) {
  return e2 && (typeof e2.on == "function" || typeof e2.addEventListener == "function");
}
function r$1R(r2, t2, n2) {
  if (!e$1$(r2))
    throw new TypeError("target is not a Evented or EventTarget object");
  if ("on" in r2)
    return r2.on(t2, n2);
  if (Array.isArray(t2)) {
    const e2 = t2.slice();
    for (const t3 of e2)
      r2.addEventListener(t3, n2);
    return { remove() {
      for (const t3 of e2)
        r2.removeEventListener(t3, n2);
    } };
  }
  return r2.addEventListener(t2, n2), { remove() {
    r2.removeEventListener(t2, n2);
  } };
}
function t$26(t2, n2, o2) {
  if (!e$1$(t2))
    throw new TypeError("target is not a Evented or EventTarget object");
  if ("once" in t2)
    return t2.once(n2, o2);
  const i2 = r$1R(t2, n2, (e2) => {
    i2.remove(), o2.call(t2, e2);
  });
  return { remove() {
    i2.remove();
  } };
}
const o$2b = { Win: "Meta", Scroll: "ScrollLock", Spacebar: " ", Down: "ArrowDown", Left: "ArrowLeft", Right: "ArrowRight", Up: "ArrowUp", Del: "Delete", Apps: "ContextMenu", Esc: "Escape", Multiply: "*", Add: "+", Subtract: "-", Decimal: ".", Divide: "/" };
function i$31({ key: e2 }) {
  return o$2b[e2] || e2;
}
function a$2T(t2 = "Aborted") {
  return new s$2u("AbortError", t2);
}
function f$1V(t2, e2 = "Aborted") {
  if (p$3D(t2))
    throw a$2T(e2);
}
function h$1R(t2) {
  return r$1$(t2) ? "aborted" in t2 ? t2 : t2.signal : t2;
}
function p$3D(t2) {
  const e2 = h$1R(t2);
  return r$1$(e2) && e2.aborted;
}
function w$12(t2) {
  if (j$_(t2))
    throw t2;
}
function b$19(t2) {
  if (!j$_(t2))
    throw t2;
}
function v$19(t2, e2) {
  const r2 = h$1R(t2);
  if (!t$2r(r2)) {
    if (!r2.aborted)
      return t$26(r2, "abort", () => e2());
    e2();
  }
}
function d$1X(t2, e2) {
  const r2 = h$1R(t2);
  if (!t$2r(r2))
    return f$1V(r2), t$26(r2, "abort", () => e2(a$2T()));
}
function y$1C(t2, e2) {
  const r2 = h$1R(e2);
  return t$2r(r2) ? t2 : new Promise((r3, n2) => {
    let o2 = v$19(e2, () => n2(a$2T()));
    const i2 = () => o2 = h$1W(o2);
    t2.then(i2, i2), t2.then(r3, n2);
  });
}
function j$_(t2) {
  return (t2 == null ? void 0 : t2.name) === "AbortError";
}
async function g$1m(t2) {
  try {
    return await t2;
  } catch (e2) {
    if (!j$_(e2))
      throw e2;
    return;
  }
}
function A$B() {
  let t2 = null;
  const e2 = new Promise((e3, r2) => {
    t2 = { promise: void 0, resolve: e3, reject: r2 };
  });
  return t2.promise = e2, t2;
}
async function E$Q(t2) {
  if (!t2)
    return;
  if (typeof t2.forEach != "function") {
    const e3 = Object.keys(t2), r2 = e3.map((e4) => t2[e4]), n2 = await E$Q(r2), o2 = {};
    return e3.map((t3, e4) => o2[t3] = n2[e4]), o2;
  }
  const e2 = t2;
  return new Promise((t3) => {
    const r2 = [];
    let n2 = e2.length;
    n2 === 0 && t3(r2), e2.forEach((e3) => {
      const o2 = { promise: e3 || Promise.resolve(e3) };
      r2.push(o2), o2.promise.then((t4) => {
        o2.value = t4;
      }).catch((t4) => {
        o2.error = t4;
      }).then(() => {
        --n2, n2 === 0 && t3(r2);
      });
    });
  });
}
async function L$z(t2) {
  return (await E$Q(t2)).filter((t3) => !!t3.value).map((t3) => t3.value);
}
function U$z(t2, e2, r2) {
  const n2 = new AbortController();
  return v$19(r2, () => n2.abort()), new Promise((r3, o2) => {
    let i2 = setTimeout(() => {
      i2 = 0, r3(e2);
    }, t2);
    v$19(n2, () => {
      i2 && (clearTimeout(i2), o2(a$2T()));
    });
  });
}
function C$E(t2) {
  return t2 && typeof t2.then == "function";
}
function $$l(t2) {
  return C$E(t2) ? t2 : Promise.resolve(t2);
}
function x$14(t2, e2 = -1) {
  let r2, n2, o2, i2, s2 = null;
  const c2 = (...l2) => {
    if (r2) {
      n2 = l2, i2 && i2.reject(a$2T()), i2 = A$B();
      const t3 = x$16(i2.promise);
      if (s2) {
        const t4 = s2;
        s2 = null, t4.abort();
      }
      return t3;
    }
    if (o2 = i2 || A$B(), i2 = null, e2 > 0) {
      const n3 = new AbortController();
      r2 = $$l(t2(...l2, n3.signal));
      const o3 = r2;
      U$z(e2).then(() => {
        r2 === o3 && (i2 ? n3.abort() : s2 = n3);
      });
    } else
      r2 = 1, r2 = $$l(t2(...l2));
    const m2 = () => {
      const t3 = n2;
      n2 = o2 = r2 = s2 = null, t3 != null && c2(...t3);
    }, f2 = r2, h2 = o2;
    return f2.then(m2, m2), f2.then(h2.resolve, h2.reject), x$16(h2.promise);
  };
  return c2;
}
function D$D() {
  let e2, r2;
  const n2 = new Promise((t2, n3) => {
    e2 = t2, r2 = n3;
  }), o2 = (t2) => {
    e2(t2);
  };
  return o2.resolve = (t2) => e2(t2), o2.reject = (t2) => r2(t2), o2.timeout = (e3, r3) => t$28.setTimeout(() => o2.reject(r3), e3), o2.promise = n2, o2;
}
async function O$E(t2) {
  await Promise.resolve(), f$1V(t2);
}
function n$2K(n2) {
  return n2;
}
function t$25(n2) {
  return n2;
}
function u$2f(n2) {
  return t$25(1e-3 * n2);
}
class c$3h {
  constructor(e2) {
    this.phases = e2, this.paused = false, this.ticks = -1, this.removed = false;
  }
}
class m$2s {
  constructor(e2) {
    this.callback = e2, this.isActive = true;
  }
  remove() {
    this.isActive = false;
  }
}
let l$2E = 0;
const u$2e = { time: n$2K(0), deltaTime: n$2K(0), elapsedFrameTime: n$2K(0), frameDuration: n$2K(0) }, f$1U = ["prepare", "preRender", "render", "postRender", "update", "finish"], h$1Q = [], d$1W = new l$2F();
class w$11 {
  constructor(e2) {
    this._task = e2;
  }
  remove() {
    this._task.removed = true;
  }
  pause() {
    this._task.paused = true;
  }
  resume() {
    this._task.paused = false;
  }
}
const k$F = { frameTasks: d$1W, willDispatch: false, clearFrameTasks: j$Z, dispatch: b$18, executeFrameTasks: D$C };
function v$18(e2) {
  const r2 = new m$2s(e2);
  return h$1Q.push(r2), k$F.willDispatch || (k$F.willDispatch = true, t$2a(b$18)), r2;
}
function A$A(e2) {
  const t2 = new c$3h(e2);
  return d$1W.push(t2), T$F == null && (l$2E = performance.now(), T$F = requestAnimationFrame(x$13)), new w$11(t2);
}
let T$F = null;
function j$Z(e2 = false) {
  d$1W.forAll((e3) => {
    e3.removed = true;
  }), e2 && _$P();
}
function x$13() {
  const e2 = performance.now();
  T$F = null, T$F = d$1W.length > 0 ? requestAnimationFrame(x$13) : null, k$F.executeFrameTasks(e2);
}
function D$C(e2) {
  const t2 = n$2K(e2 - l$2E);
  l$2E = e2;
  const r2 = 1e3 / 60, s2 = Math.max(0, t2 - r2);
  for (let o2 = 0; o2 < f$1U.length; o2++) {
    const n2 = performance.now(), a2 = f$1U[o2];
    d$1W.forAll((n3) => {
      var _a2;
      if (n3.paused || n3.removed)
        return;
      o2 === 0 && n3.ticks++;
      n3.phases[a2] && (u$2e.time = e2, u$2e.deltaTime = n3.ticks === 0 ? n$2K(0) : t2, u$2e.elapsedFrameTime = n$2K(performance.now() - e2), u$2e.frameDuration = n$2K(r2 - s2), (_a2 = n3.phases[a2]) == null ? void 0 : _a2.call(n3, u$2e));
    }), R$C[o2].record(performance.now() - n2);
  }
  _$P(), q$t.record(performance.now() - e2);
}
const g$1l = new l$2F();
function _$P() {
  d$1W.forAll((e2) => {
    e2.removed && g$1l.push(e2);
  }), d$1W.removeUnorderedMany(g$1l.data, g$1l.length), g$1l.clear();
}
function b$18() {
  for (; h$1Q.length; ) {
    const t2 = x$16(h$1Q.shift());
    t2.isActive && t2.callback();
  }
  k$F.willDispatch = false;
}
function y$1B(e2 = 1, r2) {
  const s2 = D$D(), i2 = () => {
    p$3D(r2) ? s2.reject(a$2T()) : e2 === 0 ? s2() : (--e2, t$2a(() => i2()));
  };
  return i2(), s2.promise;
}
const R$C = f$1U.map((e2) => new e$23(e2)), q$t = new e$23("total");
function n$2J(r2, n2) {
  for (const o2 of r2.entries())
    if (n2(o2[0]))
      return true;
  return false;
}
let t$24 = 0;
function e$1_() {
  return ++t$24;
}
class s$2m {
  constructor(s2) {
    this._notify = s2, this._accessed = [], this._handles = [], this._invalidCount = 0;
  }
  destroy() {
    this._accessed.length = 0, this.clear();
  }
  onInvalidated() {
    this._invalidCount++;
  }
  onCommitted() {
    const s2 = this._invalidCount;
    if (s2 === 1)
      return this._invalidCount = 0, void this._notify();
    this._invalidCount = s2 > 0 ? s2 - 1 : 0;
  }
  onObservableAccessed(s2) {
    this._accessed.includes(s2) || this._accessed.push(s2);
  }
  onTrackingEnd() {
    const s2 = this._handles, t2 = this._accessed;
    for (let e2 = 0; e2 < t2.length; ++e2)
      s2.push(t2[e2].observe(this));
    t2.length = 0;
  }
  clear() {
    const s2 = this._handles;
    for (let t2 = 0; t2 < s2.length; ++t2)
      s2[t2].remove();
    s2.length = 0;
  }
}
let r$1Q = false;
const e$1Z = [];
function o$2a(e2, o2) {
  let u2 = new s$2m(s2), l2 = null, f2 = false;
  function s2() {
    if (!u2 || f2)
      return;
    if (r$1Q)
      return void i$30(s2);
    const t2 = l2;
    u2.clear(), r$1Q = true, f2 = true, l2 = f$1Z(u2, e2), f2 = false, r$1Q = false, o2(l2, t2), c$3g();
  }
  function m2() {
    u2 && (u2.destroy(), u2 = null, l2 = null);
  }
  return f2 = true, l2 = f$1Z(u2, e2), f2 = false, { remove: m2 };
}
function u$2d(r2, e2) {
  let o2 = new s$2m(l2), u2 = null;
  function l2() {
    e2(u2, c2);
  }
  function i2() {
    o2 && (o2.destroy(), o2 = null), u2 = null;
  }
  function c2() {
    return o2 ? (o2.clear(), u2 = f$1Z(o2, r2), u2) : null;
  }
  return c2(), { remove: i2 };
}
function l$2D(e2) {
  let o2 = new s$2m(l2), u2 = false;
  function l2() {
    o2 && !u2 && (r$1Q ? i$30(l2) : (o2.clear(), r$1Q = true, u2 = true, f$1Z(o2, e2), u2 = false, r$1Q = false, c$3g()));
  }
  function f2() {
    o2 && (o2.destroy(), o2 = null);
  }
  return u2 = true, f$1Z(o2, e2), u2 = false, { remove: f2 };
}
function i$30(n2) {
  e$1Z.includes(n2) || e$1Z.unshift(n2);
}
function c$3g() {
  for (; e$1Z.length; )
    e$1Z.pop()();
}
var h$1P;
!function(e2) {
  e2[e2.Untracked = 0] = "Untracked", e2[e2.Tracked = 1] = "Tracked";
}(h$1P || (h$1P = {}));
class f$1T {
  constructor() {
    this.uid = e$1_(), this.removed = false, this.type = null, this.oldValue = null, this.callback = null, this.getValue = null, this.target = null, this.path = null, this.equals = null;
  }
  static acquireUntracked(e2, r2, o2, l2, n2) {
    return this.pool.acquire(h$1P.Untracked, e2, r2, o2, l2, n2, w$14);
  }
  static acquireTracked(e2, t2, r2, o2) {
    return this.pool.acquire(h$1P.Tracked, e2, t2, r2, null, null, o2);
  }
  notify(e2, t2) {
    this.type === h$1P.Untracked ? this.callback.call(this.target, e2, t2, this.path, this.target) : this.callback.call(null, e2, t2);
  }
  acquire(e2, t2, r2, o2, l2, n2, s2) {
    this.uid = e$1_(), this.removed = false, this.type = e2, this.oldValue = t2, this.callback = r2, this.getValue = o2, this.target = l2, this.path = n2, this.equals = s2;
  }
  release() {
    this.target = this.path = this.oldValue = this.callback = this.getValue = null, this.uid = e$1_(), this.removed = true;
  }
}
f$1T.pool = new t$2b(f$1T);
const m$2r = new t$2c(), p$3C = new Set();
let v$17;
function k$E(e2) {
  p$3C.delete(e2), p$3C.add(e2), v$17 || (v$17 = v$18(q$s));
}
function _$O(e2) {
  if (e2.removed)
    return;
  const t2 = e2.oldValue, r2 = e2.getValue();
  e2.equals(t2, r2) || (e2.oldValue = r2, e2.notify(r2, t2));
}
function g$1k(e2) {
  for (const t2 of p$3C.values())
    t2.target === e2 && (t2.removed = true);
}
function q$s() {
  let e2 = 10;
  for (; v$17 && e2--; ) {
    v$17 = null;
    const e3 = j$Y(), t2 = m$2r.acquire();
    for (const r2 of e3) {
      const e4 = r2.uid;
      _$O(r2), e4 === r2.uid && r2.removed && t2.push(r2);
    }
    for (const r2 of p$3C)
      r2.removed && (t2.push(r2), p$3C.delete(r2));
    for (const r2 of t2)
      f$1T.pool.release(r2);
    m$2r.release(t2), m$2r.release(e3), V$p.forEach((e4) => e4());
  }
}
function j$Y() {
  const e2 = m$2r.acquire();
  e2.length = p$3C.size;
  let t2 = 0;
  for (const r2 of p$3C)
    e2[t2] = r2, ++t2;
  return p$3C.clear(), e2;
}
const V$p = new Set();
function y$1A(e2) {
  return V$p.add(e2), { remove() {
    V$p.delete(e2);
  } };
}
function U$y(e2, t2, r2) {
  let o2 = y$1J(e2, t2, r2, (e3, t3, r3) => {
    let l2, n2, i2 = u$2d(() => u$2k(e3, t3), (i3, s2) => {
      e3.__accessor__.destroyed || l2 && l2.uid !== n2 ? o2.remove() : (l2 || (l2 = f$1T.acquireUntracked(i3, r3, s2, e3, t3), n2 = l2.uid), k$E(l2));
    });
    return { remove: h$1T(() => {
      i2.remove(), l2 && (l2.uid !== n2 || l2.removed || (l2.removed = true, k$E(l2)), l2 = null), o2 = i2 = null;
    }) };
  });
  return o2;
}
function b$17(e2, r2, o2) {
  const l2 = y$1J(e2, r2, o2, (e3, r3, o3) => {
    let n2 = false;
    return o$2a(() => u$2k(e3, r3), (i2, s2) => {
      e3.__accessor__.destroyed ? l2.remove() : n2 || (n2 = true, w$14(s2, i2) || o3.call(e3, i2, s2, r3, e3), n2 = false);
    });
  });
  return l2;
}
function T$E(e2, t2, r2, o2 = false) {
  return !e2.__accessor__ || e2.__accessor__.destroyed ? { remove() {
  } } : o2 ? b$17(e2, t2, r2) : U$y(e2, t2, r2);
}
function w$10(e2, t2, r2) {
  let o2, l2, n2 = u$2d(e2, (e3, i2) => {
    o2 && o2.uid !== l2 ? n2.remove() : (o2 || (o2 = f$1T.acquireTracked(e3, t2, i2, r2), l2 = o2.uid), k$E(o2));
  });
  return { remove: h$1T(() => {
    n2.remove(), o2 && (o2.uid !== l2 || o2.removed || (o2.removed = true, k$E(o2)), o2 = null), n2 = null;
  }) };
}
function S$U(e2, t2, r2) {
  let o2 = false;
  return o$2a(e2, (e3, l2) => {
    o2 || (o2 = true, r2(l2, e3) || t2(e3, l2), o2 = false);
  });
}
function P$E(e2, t2, o2 = false, l2 = N$w) {
  return o2 ? S$U(e2, t2, l2) : w$10(e2, t2, l2);
}
function x$12(e2) {
  return n$2J(p$3C, (t2) => t2.oldValue === e2);
}
var l$2C, p$3B;
function d$1V(t2) {
  var _a2;
  if (t2 == null)
    return { value: t2 };
  if (Array.isArray(t2))
    return { type: [t2[0]], value: null };
  switch (typeof t2) {
    case "object":
      return ((_a2 = t2.constructor) == null ? void 0 : _a2.__accessorMetadata__) || t2 instanceof Date ? { type: t2.constructor, value: t2 } : t2;
    case "boolean":
      return { type: Boolean, value: t2 };
    case "string":
      return { type: String, value: t2 };
    case "number":
      return { type: Number, value: t2 };
    case "function":
      return { type: t2, value: null };
    default:
      return;
  }
}
const y$1z = Symbol("Accessor-Handles"), f$1S = Symbol("Accessor-Initialized");
class m$2q {
  constructor(...t2) {
    if (this[l$2C] = null, this[p$3B] = false, this.constructor === m$2q)
      throw new Error("[accessor] cannot instantiate Accessor. This can be fixed by creating a subclass of Accessor");
    Object.defineProperty(this, "__accessor__", { enumerable: false, value: new v$1a(this) }), t2.length > 0 && this.normalizeCtorArgs && (this.__accessor__.ctorArgs = this.normalizeCtorArgs.apply(this, t2));
  }
  static createSubclass(t2 = {}) {
    if (Array.isArray(t2))
      throw new Error("Multi-inheritance unsupported since 4.16");
    const { properties: r2, declaredClass: e2, constructor: s2 } = t2;
    delete t2.declaredClass, delete t2.properties, delete t2.constructor;
    const o2 = this;
    class c2 extends o2 {
      constructor(...t3) {
        super(...t3), this.inherited = null, s2 && s2.apply(this, t3);
      }
    }
    n$2T(c2.prototype);
    for (const i2 in t2) {
      const r3 = t2[i2];
      c2.prototype[i2] = typeof r3 == "function" ? function(...t3) {
        const e3 = this.inherited;
        let s3;
        this.inherited = function(...t4) {
          if (o2.prototype[i2])
            return o2.prototype[i2].apply(this, t4);
        };
        try {
          s3 = r3.apply(this, t3);
        } catch (c3) {
          throw this.inherited = e3, c3;
        }
        return this.inherited = e3, s3;
      } : t2[i2];
    }
    for (const i2 in r2) {
      const t3 = d$1V(r2[i2]);
      y$1I(t3)(c2.prototype, i2);
    }
    return n$2P(e2)(c2);
  }
  postscript(t2) {
    const r2 = this.__accessor__, e2 = r2.ctorArgs || t2;
    r2.initialize(), e2 && (this.set(e2), r2.ctorArgs = null), r2.constructed(), this.initialize(), this[f$1S] = true;
  }
  initialize() {
  }
  destroy() {
    this.destroyed || (this[y$1z] = s$2D(this[y$1z]), g$1k(this), this.__accessor__.destroy());
  }
  get constructed() {
    return this.__accessor__ && this.__accessor__.initialized || false;
  }
  get initialized() {
    return this[f$1S];
  }
  get destroyed() {
    return this.__accessor__ && this.__accessor__.destroyed || false;
  }
  commitProperty(t2) {
    this.get(t2);
  }
  get(t2) {
    return o$2k(this, t2);
  }
  hasOwnProperty(t2) {
    return this.__accessor__ ? this.__accessor__.has(t2) : Object.prototype.hasOwnProperty.call(this, t2);
  }
  keys() {
    return this.__accessor__ ? this.__accessor__.keys() : [];
  }
  set(t2, r2) {
    return t$2k(this, t2, r2), this;
  }
  watch(t2, r2, e2) {
    return T$E(this, t2, r2, e2);
  }
  own(t2) {
    this.addHandles(t2);
  }
  addHandles(r2, s2) {
    let o2 = this[y$1z];
    t$2r(o2) && (o2 = this[y$1z] = new t$2g()), o2.add(r2, s2);
  }
  removeHandles(t2) {
    const r2 = this[y$1z];
    t$2r(r2) || r2.remove(t2);
  }
  hasHandles(t2) {
    const r2 = this[y$1z];
    return !!r$1$(r2) && r2.has(t2);
  }
  _override(t2, r2) {
    r2 === void 0 ? this.__accessor__.clearOverride(t2) : this.__accessor__.override(t2, r2);
  }
  _clearOverride(t2) {
    return this.__accessor__.clearOverride(t2);
  }
  _overrideIfSome(t2, r2) {
    r2 == null ? this.__accessor__.clearOverride(t2) : this.__accessor__.override(t2, r2);
  }
  _isOverridden(t2) {
    return this.__accessor__.isOverridden(t2);
  }
  notifyChange(t2) {
    this.__accessor__.notifyChange(t2);
  }
  _get(t2) {
    return this.__accessor__.internalGet(t2);
  }
  _set(t2, r2) {
    return this.__accessor__.internalSet(t2, r2), this;
  }
}
l$2C = y$1z, p$3B = f$1S;
class s$2l {
  constructor() {
    this._values = new Map(), this.multipleOriginsSupported = false;
  }
  clone(e2) {
    const t2 = new s$2l();
    return this._values.forEach((s2, r2) => {
      e2 && e2.has(r2) || t2.set(r2, y$1L(s2.value), s2.origin);
    }), t2;
  }
  get(i2, e2) {
    e2 = this._normalizeOrigin(e2);
    const s2 = this._values.get(i2);
    return e2 == null || (s2 == null ? void 0 : s2.origin) === e2 ? s2 == null ? void 0 : s2.value : void 0;
  }
  originOf(i2) {
    var _a2, _b2;
    return (_b2 = (_a2 = this._values.get(i2)) == null ? void 0 : _a2.origin) != null ? _b2 : r$1U.USER;
  }
  keys(i2) {
    i2 = this._normalizeOrigin(i2);
    const e2 = [...this._values.keys()];
    return i2 == null ? e2 : e2.filter((e3) => {
      var _a2;
      return ((_a2 = this._values.get(e3)) == null ? void 0 : _a2.origin) === i2;
    });
  }
  set(i2, s2, r2) {
    if ((r2 = this._normalizeOrigin(r2)) === r$1U.DEFAULTS) {
      const e2 = this._values.get(i2);
      if (e2 && e2.origin != null && e2.origin > r2)
        return;
    }
    this._values.set(i2, new t$23(s2, r2));
  }
  delete(i2, e2) {
    var _a2;
    (e2 = this._normalizeOrigin(e2)) != null && ((_a2 = this._values.get(i2)) == null ? void 0 : _a2.origin) !== e2 || this._values.delete(i2);
  }
  has(i2, e2) {
    var _a2;
    return (e2 = this._normalizeOrigin(e2)) != null ? ((_a2 = this._values.get(i2)) == null ? void 0 : _a2.origin) === e2 : this._values.has(i2);
  }
  forEach(i2) {
    this._values.forEach(({ value: e2 }, s2) => i2(e2, s2));
  }
  _normalizeOrigin(i2) {
    if (i2 != null)
      return i2 === r$1U.DEFAULTS ? i2 : r$1U.USER;
  }
}
class t$23 {
  constructor(i2, e2) {
    this.value = i2, this.origin = e2;
  }
}
function e$1Y(e2, r2, n2) {
  r2.keys().forEach((e3) => {
    n2.set(e3, r2.get(e3), r$1U.DEFAULTS);
  });
  const o2 = e2.metadatas;
  Object.keys(o2).forEach((r3) => {
    e2.internalGet(r3) && n2.set(r3, e2.internalGet(r3), r$1U.DEFAULTS);
  });
}
function s$2k(e2, r2, n2) {
  if (!e2 || !e2.read || e2.read.enabled === false || !e2.read.source)
    return false;
  const o2 = e2.read.source;
  if (typeof o2 == "string") {
    if (o2 === r2)
      return true;
    if (o2.includes(".") && o2.indexOf(r2) === 0 && s$2w(o2, n2))
      return true;
  } else
    for (const s2 of o2) {
      if (s2 === r2)
        return true;
      if (s2.includes(".") && s2.indexOf(r2) === 0 && s$2w(s2, n2))
        return true;
    }
  return false;
}
function i$2$(e2) {
  return e2 && (!e2.read || e2.read.enabled !== false && !e2.read.source);
}
function a$2S(e2, t2, r2, o2, a2) {
  let f2 = t$2i(t2[r2], a2);
  i$2$(f2) && (e2[r2] = true);
  for (const i2 of Object.getOwnPropertyNames(t2))
    f2 = t$2i(t2[i2], a2), s$2k(f2, r2, o2) && (e2[i2] = true);
}
function f$1R(e2, t2, r2, n2) {
  const s2 = r2.metadatas, i2 = a$2W(s2[t2], "any", n2), a2 = i2 && i2.default;
  if (a2 === void 0)
    return;
  const f2 = typeof a2 == "function" ? a2.call(e2, t2, n2) : a2;
  f2 !== void 0 && r2.set(t2, f2);
}
const c$3f = { origin: "service" };
function u$2c(t2, o2, s2 = c$3f) {
  if (!o2 || typeof o2 != "object")
    return;
  const i2 = e$2a(t2), u2 = i2.metadatas, d2 = {};
  for (const e2 of Object.getOwnPropertyNames(o2))
    a$2S(d2, u2, e2, o2, s2);
  i2.setDefaultOrigin(s2.origin);
  for (const r2 of Object.getOwnPropertyNames(d2)) {
    const a2 = t$2i(u2[r2], s2).read, f2 = a2 && a2.source;
    let c2;
    c2 = f2 && typeof f2 == "string" ? u$2k(o2, f2) : o2[r2], a2 && a2.reader && (c2 = a2.reader.call(t2, c2, o2, s2)), c2 !== void 0 && i2.set(r2, c2);
  }
  if (!s2 || !s2.ignoreDefaults) {
    i2.setDefaultOrigin("defaults");
    for (const e2 of Object.getOwnPropertyNames(u2))
      d2[e2] || f$1R(t2, e2, i2, s2);
  }
  i2.setDefaultOrigin("user");
}
function d$1U(e2, t2, r2, n2 = c$3f) {
  var _a2;
  const o2 = __spreadProps(__spreadValues({}, n2), { messages: [] });
  r2(o2), (_a2 = o2.messages) == null ? void 0 : _a2.forEach((t3) => {
    t3.type !== "warning" || e2.loaded ? n2 && n2.messages && n2.messages.push(t3) : e2.loadWarnings.push(t3);
  });
}
function a$2R(r2, e2, t2, i2, o2) {
  var _a2, _b2;
  const n2 = {};
  return (_b2 = (_a2 = e2.write) == null ? void 0 : _a2.writer) == null ? void 0 : _b2.call(r2, i2, n2, t2, o2), n2;
}
function f$1Q(r2, i2, s2, u2, l2, a2) {
  if (!u2 || !u2.write)
    return false;
  const f2 = r2.get(s2);
  if (!l2 && u2.write.overridePolicy) {
    const e2 = u2.write.overridePolicy.call(r2, f2, s2, a2);
    e2 !== void 0 && (l2 = e2);
  }
  if (l2 || (l2 = u2.write), !l2 || l2.enabled === false)
    return false;
  if ((f2 === null && !l2.allowNull && !l2.writerEnsuresNonNull || f2 === void 0) && l2.isRequired) {
    const i3 = new s$2u("web-document-write:property-required", `Missing value for required property '${s2}' on '${r2.declaredClass}'`, { propertyName: s2, target: r2 });
    return i3 && a2 && a2.messages ? a2.messages.push(i3) : i3 && !a2 && s$2z.getLogger("esri.core.accessorSupport.write").error(i3.name, i3.message), false;
  }
  if (f2 === void 0)
    return false;
  if (f2 === null && !l2.allowNull && !l2.writerEnsuresNonNull)
    return false;
  if ((!i2.store.multipleOriginsSupported || i2.store.originOf(s2) === r$1U.DEFAULTS) && p$3A(r2, s2, a2, u2, f2))
    return false;
  if (!l2.ignoreOrigin && a2 && a2.origin && i2.store.multipleOriginsSupported) {
    if (i2.store.originOf(s2) < t$2e(a2.origin))
      return false;
  }
  return true;
}
function p$3A(e2, t2, i2, o2, n2) {
  const s2 = o2.default;
  if (s2 === void 0)
    return false;
  if (o2.defaultEquals != null)
    return o2.defaultEquals(n2);
  if (typeof s2 == "function") {
    if (Array.isArray(n2)) {
      const o3 = s2.call(e2, t2, i2);
      return i$3e(o3, n2);
    }
    return false;
  }
  return s2 === n2;
}
function g$1j(r2, e2, t2, i2) {
  const o2 = e$2a(r2), n2 = o2.metadatas, u2 = s$2p(n2[e2], i2);
  return !!u2 && f$1Q(r2, o2, e2, u2, t2, i2);
}
function c$3e(r2, e2, t2) {
  var _a2, _b2;
  if (r2 && typeof r2.toJSON == "function" && (!r2.toJSON.isDefaultToJSON || !r2.write))
    return o$2l(e2, r2.toJSON(t2));
  const o2 = e$2a(r2), n2 = o2.metadatas;
  for (const s2 in n2) {
    const p2 = s$2p(n2[s2], t2);
    if (!f$1Q(r2, o2, s2, p2, void 0, t2))
      continue;
    const g2 = r2.get(s2), c2 = a$2R(r2, p2, p2.write && typeof p2.write.target == "string" ? p2.write.target : s2, g2, t2);
    Object.keys(c2).length > 0 && (e2 = o$2l(e2, c2), ((_b2 = (_a2 = t2 == null ? void 0 : t2.resources) == null ? void 0 : _a2.pendingOperations) == null ? void 0 : _b2.length) && Promise.all(t2.resources.pendingOperations).then(() => o$2l(e2, c2)), t2 && t2.writtenProperties && t2.writtenProperties.push({ target: r2, propName: s2, oldOrigin: c$3i(o2.store.originOf(s2)), newOrigin: t2.origin }));
  }
  return e2;
}
const u$2b = (t2) => {
  let u2 = class extends t2 {
    constructor(...r2) {
      super(...r2);
      const t3 = x$16(e$2a(this)), i2 = t3.store, p2 = new s$2l();
      t3.store = p2, e$1Y(t3, i2, p2);
    }
    read(r2, t3) {
      u$2c(this, r2, t3);
    }
    write(r2 = {}, t3) {
      return c$3e(this, r2, t3);
    }
    toJSON(r2) {
      return this.write({}, r2);
    }
    static fromJSON(r2, t3) {
      return n$2I.call(this, r2, t3);
    }
  };
  return u2 = e$2g([n$2P("esri.core.JSONSupport")], u2), u2.prototype.toJSON.isDefaultToJSON = true, u2;
};
function n$2I(r2, t2) {
  if (!r2)
    return null;
  if (r2.declaredClass)
    throw new Error("JSON object is already hydrated");
  const s2 = new this();
  return s2.read(r2, t2), s2;
}
let l$2B = class extends u$2b(m$2q) {
};
l$2B = e$2g([n$2P("esri.core.JSONSupport")], l$2B);
function o$29(o2, e2, t2) {
  let a2, c2;
  return e2 === void 0 || Array.isArray(e2) ? (c2 = o2, t2 = e2, a2 = [void 0]) : (c2 = e2, a2 = Array.isArray(o2) ? o2 : [o2]), (o3, e3) => {
    const d2 = o3.constructor.prototype;
    a2.forEach((a3) => {
      const s2 = d$1$(o3, a3, c2);
      s2.read && typeof s2.read == "object" || (s2.read = {}), s2.read.reader = d2[e3], t2 && (s2.read.source = (s2.read.source || []).concat(t2));
    });
  };
}
function r$1P(r2, o2, e2) {
  let i2, n2;
  return o2 === void 0 ? (n2 = r2, i2 = [void 0]) : typeof o2 != "string" ? (n2 = r2, i2 = [void 0], e2 = o2) : (n2 = o2, i2 = Array.isArray(r2) ? r2 : [r2]), (r3, o3) => {
    const p2 = r3.constructor.prototype;
    for (const c2 of i2) {
      const i3 = d$1$(r3, c2, n2);
      i3.write && typeof i3.write == "object" || (i3.write = {}), e2 && (i3.write.target = e2), i3.write.writer = p2[o3];
    }
  };
}
var S$T;
!function(S2) {
  S2[S2.CGCS2000 = 4490] = "CGCS2000", S2[S2.GCSMARS2000 = 104971] = "GCSMARS2000", S2[S2.GCSMARS2000_SPHERE = 104905] = "GCSMARS2000_SPHERE", S2[S2.GCSMOON2000 = 104903] = "GCSMOON2000";
}(S$T || (S$T = {}));
let o$28;
const r$1O = { values: [1, 0.3048, 0.3048006096012192, 0.3047972654, 0.9143917962, 0.201166195164, 0.9143984146160287, 0.3047994715386762, 20.11676512155263, 20.11678249437587, 0.9143985307444408, 0.91439523, 0.3047997101815088, 20.1168, 20.116756, 5e4, 15e4], units: ["Meter", "Foot", "Foot_US", "Foot_Clarke", "Yard_Clarke", "Link_Clarke", "Yard_Sears", "Foot_Sears", "Chain_Sears", "Chain_Benoit_1895_B", "Yard_Indian", "Yard_Indian_1937", "Foot_Gold_Coast", "Chain", "Chain_Sears_1922_Truncated", "50_Kilometers", "150_Kilometers"], 2066: 5, 2136: 12, 2155: 2, 2157: 0, 2158: 0, 2159: 12, 2160: 12, 2204: 2, 2219: 0, 2220: 0, 2254: 2, 2255: 2, 2256: 1, 2265: 1, 2266: 1, 2267: 2, 2268: 2, 2269: 1, 2270: 1, 2271: 2, 2272: 2, 2273: 1, 2294: 0, 2295: 0, 2314: 3, 2899: 2, 2900: 2, 2901: 1, 2909: 1, 2910: 1, 2911: 2, 2912: 2, 2913: 1, 2914: 1, 2992: 1, 2993: 0, 2994: 1, 3080: 1, 3089: 2, 3090: 0, 3091: 2, 3102: 2, 3141: 0, 3142: 0, 3167: 14, 3359: 2, 3360: 0, 3361: 1, 3362: 0, 3363: 2, 3364: 0, 3365: 2, 3366: 3, 3404: 2, 3405: 0, 3406: 0, 3407: 3, 3439: 0, 3440: 0, 3479: 1, 3480: 0, 3481: 1, 3482: 0, 3483: 1, 3484: 0, 3485: 2, 3486: 0, 3487: 2, 3488: 0, 3489: 0, 3490: 2, 3491: 0, 3492: 2, 3493: 0, 3494: 2, 3495: 0, 3496: 2, 3497: 0, 3498: 2, 3499: 0, 3500: 2, 3501: 0, 3502: 2, 3503: 0, 3504: 2, 3505: 0, 3506: 2, 3507: 0, 3508: 2, 3509: 0, 3510: 2, 3511: 0, 3512: 2, 3513: 0, 3514: 0, 3515: 2, 3516: 0, 3517: 2, 3518: 0, 3519: 2, 3520: 0, 3521: 2, 3522: 0, 3523: 2, 3524: 0, 3525: 2, 3526: 0, 3527: 2, 3528: 0, 3529: 2, 3530: 0, 3531: 2, 3532: 0, 3533: 2, 3534: 0, 3535: 2, 3536: 0, 3537: 2, 3538: 0, 3539: 2, 3540: 0, 3541: 2, 3542: 0, 3543: 2, 3544: 0, 3545: 2, 3546: 0, 3547: 2, 3548: 0, 3549: 2, 3550: 0, 3551: 2, 3552: 0, 3553: 2, 3582: 2, 3583: 0, 3584: 2, 3585: 0, 3586: 2, 3587: 0, 3588: 1, 3589: 0, 3590: 1, 3591: 0, 3592: 0, 3593: 1, 3598: 2, 3599: 0, 3600: 2, 3605: 1, 3606: 0, 3607: 0, 3608: 2, 3609: 0, 3610: 2, 3611: 0, 3612: 2, 3613: 0, 3614: 2, 3615: 0, 3616: 2, 3617: 0, 3618: 2, 3619: 0, 3620: 2, 3621: 0, 3622: 2, 3623: 0, 3624: 2, 3625: 0, 3626: 2, 3627: 0, 3628: 2, 3629: 0, 3630: 2, 3631: 0, 3632: 2, 3633: 0, 3634: 1, 3635: 0, 3636: 1, 3640: 2, 3641: 0, 3642: 2, 3643: 0, 3644: 1, 3645: 0, 3646: 1, 3647: 0, 3648: 1, 3649: 0, 3650: 2, 3651: 0, 3652: 2, 3653: 0, 3654: 2, 3655: 0, 3656: 1, 3657: 0, 3658: 2, 3659: 0, 3660: 2, 3661: 0, 3662: 2, 3663: 0, 3664: 2, 3668: 2, 3669: 0, 3670: 2, 3671: 0, 3672: 2, 3673: 0, 3674: 2, 3675: 0, 3676: 1, 3677: 2, 3678: 0, 3679: 1, 3680: 2, 3681: 0, 3682: 1, 3683: 2, 3684: 0, 3685: 0, 3686: 2, 3687: 0, 3688: 2, 3689: 0, 3690: 2, 3691: 0, 3692: 2, 3696: 2, 3697: 0, 3698: 2, 3699: 0, 3700: 2, 3793: 0, 3794: 0, 3812: 0, 3854: 0, 3857: 0, 3920: 0, 3978: 0, 3979: 0, 3991: 2, 3992: 2, 4026: 0, 4037: 0, 4038: 0, 4071: 0, 4082: 0, 4083: 0, 4087: 0, 4088: 0, 4217: 2, 4414: 0, 4415: 0, 4417: 0, 4434: 0, 4437: 0, 4438: 2, 4439: 2, 4462: 0, 4467: 0, 4471: 0, 4474: 0, 4559: 0, 4647: 0, 4822: 0, 4826: 0, 4839: 0, 5018: 0, 5048: 0, 5167: 0, 5168: 0, 5221: 0, 5223: 0, 5234: 0, 5235: 0, 5243: 0, 5247: 0, 5266: 0, 5316: 0, 5320: 0, 5321: 0, 5325: 0, 5337: 0, 5361: 0, 5362: 0, 5367: 0, 5382: 0, 5383: 0, 5396: 0, 5456: 0, 5457: 0, 5469: 0, 5472: 4, 5490: 0, 5513: 0, 5514: 0, 5523: 0, 5559: 0, 5588: 1, 5589: 3, 5596: 0, 5627: 0, 5629: 0, 5641: 0, 5643: 0, 5644: 0, 5646: 2, 5654: 2, 5655: 2, 5659: 0, 5700: 0, 5825: 0, 5836: 0, 5837: 0, 5839: 0, 5842: 0, 5844: 0, 5858: 0, 5879: 0, 5880: 0, 5887: 0, 5890: 0, 6128: 1, 6129: 1, 6141: 1, 6204: 0, 6210: 0, 6211: 0, 6307: 0, 6312: 0, 6316: 0, 6362: 0, 6391: 1, 6405: 1, 6406: 0, 6407: 1, 6408: 0, 6409: 1, 6410: 0, 6411: 2, 6412: 0, 6413: 2, 6414: 0, 6415: 0, 6416: 2, 6417: 0, 6418: 2, 6419: 0, 6420: 2, 6421: 0, 6422: 2, 6423: 0, 6424: 2, 6425: 0, 6426: 2, 6427: 0, 6428: 2, 6429: 0, 6430: 2, 6431: 0, 6432: 2, 6433: 0, 6434: 2, 6435: 0, 6436: 2, 6437: 0, 6438: 2, 6439: 0, 6440: 0, 6441: 2, 6442: 0, 6443: 2, 6444: 0, 6445: 2, 6446: 0, 6447: 2, 6448: 0, 6449: 2, 6450: 0, 6451: 2, 6452: 0, 6453: 2, 6454: 0, 6455: 2, 6456: 0, 6457: 2, 6458: 0, 6459: 2, 6460: 0, 6461: 2, 6462: 0, 6463: 2, 6464: 0, 6465: 2, 6466: 0, 6467: 2, 6468: 0, 6469: 2, 6470: 0, 6471: 2, 6472: 0, 6473: 2, 6474: 0, 6475: 2, 6476: 0, 6477: 2, 6478: 0, 6479: 2, 6484: 2, 6485: 0, 6486: 2, 6487: 0, 6488: 2, 6489: 0, 6490: 2, 6491: 0, 6492: 2, 6493: 0, 6494: 1, 6495: 0, 6496: 1, 6497: 0, 6498: 0, 6499: 1, 6500: 0, 6501: 2, 6502: 0, 6503: 2, 6504: 0, 6505: 2, 6506: 0, 6507: 2, 6508: 0, 6509: 0, 6510: 2, 6515: 1, 6516: 0, 6518: 0, 6519: 2, 6520: 0, 6521: 2, 6522: 0, 6523: 2, 6524: 0, 6525: 2, 6526: 0, 6527: 2, 6528: 0, 6529: 2, 6530: 0, 6531: 2, 6532: 0, 6533: 2, 6534: 0, 6535: 2, 6536: 0, 6537: 2, 6538: 0, 6539: 2, 6540: 0, 6541: 2, 6542: 0, 6543: 2, 6544: 0, 6545: 1, 6546: 0, 6547: 1, 6548: 0, 6549: 2, 6550: 0, 6551: 2, 6552: 0, 6553: 2, 6554: 0, 6555: 2, 6556: 0, 6557: 1, 6558: 0, 6559: 1, 6560: 0, 6561: 1, 6562: 0, 6563: 2, 6564: 0, 6565: 2, 6566: 0, 6567: 0, 6568: 2, 6569: 0, 6570: 1, 6571: 0, 6572: 2, 6573: 0, 6574: 2, 6575: 0, 6576: 2, 6577: 0, 6578: 2, 6582: 2, 6583: 0, 6584: 2, 6585: 0, 6586: 2, 6587: 0, 6588: 2, 6589: 0, 6590: 2, 6591: 0, 6592: 0, 6593: 2, 6594: 0, 6595: 2, 6596: 0, 6597: 2, 6598: 0, 6599: 2, 6600: 0, 6601: 2, 6602: 0, 6603: 2, 6605: 2, 6606: 0, 6607: 2, 6608: 0, 6609: 2, 6610: 0, 6611: 0, 6612: 2, 6613: 0, 6614: 2, 6615: 0, 6616: 2, 6617: 0, 6618: 2, 6633: 2, 6646: 0, 6703: 0, 6784: 0, 6785: 1, 6786: 0, 6787: 1, 6788: 0, 6789: 1, 6790: 0, 6791: 1, 6792: 0, 6793: 1, 6794: 0, 6795: 1, 6796: 0, 6797: 1, 6798: 0, 6799: 1, 6800: 0, 6801: 1, 6802: 0, 6803: 1, 6804: 0, 6805: 1, 6806: 0, 6807: 1, 6808: 0, 6809: 1, 6810: 0, 6811: 1, 6812: 0, 6813: 1, 6814: 0, 6815: 1, 6816: 0, 6817: 1, 6818: 0, 6819: 1, 6820: 0, 6821: 1, 6822: 0, 6823: 1, 6824: 0, 6825: 1, 6826: 0, 6827: 1, 6828: 0, 6829: 1, 6830: 0, 6831: 1, 6832: 0, 6833: 1, 6834: 0, 6835: 1, 6836: 0, 6837: 1, 6838: 0, 6839: 1, 6840: 0, 6841: 1, 6842: 0, 6843: 1, 6844: 0, 6845: 1, 6846: 0, 6847: 1, 6848: 0, 6849: 1, 6850: 0, 6851: 1, 6852: 0, 6853: 1, 6854: 0, 6855: 1, 6856: 0, 6857: 1, 6858: 0, 6859: 1, 6860: 0, 6861: 1, 6862: 0, 6863: 1, 6867: 0, 6868: 1, 6870: 0, 6875: 0, 6876: 0, 6879: 0, 6880: 2, 6884: 0, 6885: 1, 6886: 0, 6887: 1, 6915: 0, 6922: 0, 6923: 2, 6924: 0, 6925: 2, 6962: 0, 6984: 0, 6991: 0, 7128: 2, 7131: 0, 7132: 2, 7142: 0, 7257: 0, 7258: 2, 7259: 0, 7260: 2, 7261: 0, 7262: 2, 7263: 0, 7264: 2, 7265: 0, 7266: 2, 7267: 0, 7268: 2, 7269: 0, 7270: 2, 7271: 0, 7272: 2, 7273: 0, 7274: 2, 7275: 0, 7276: 2, 7277: 0, 7278: 2, 7279: 0, 7280: 2, 7281: 0, 7282: 2, 7283: 0, 7284: 2, 7285: 0, 7286: 2, 7287: 0, 7288: 2, 7289: 0, 7290: 2, 7291: 0, 7292: 2, 7293: 0, 7294: 2, 7295: 0, 7296: 2, 7297: 0, 7298: 2, 7299: 0, 7300: 2, 7301: 0, 7302: 2, 7303: 0, 7304: 2, 7305: 0, 7306: 2, 7307: 0, 7308: 2, 7309: 0, 7310: 2, 7311: 0, 7312: 2, 7313: 0, 7314: 2, 7315: 0, 7316: 2, 7317: 0, 7318: 2, 7319: 0, 7320: 2, 7321: 0, 7322: 2, 7323: 0, 7324: 2, 7325: 0, 7326: 2, 7327: 0, 7328: 2, 7329: 0, 7330: 2, 7331: 0, 7332: 2, 7333: 0, 7334: 2, 7335: 0, 7336: 2, 7337: 0, 7338: 2, 7339: 0, 7340: 2, 7341: 0, 7342: 2, 7343: 0, 7344: 2, 7345: 0, 7346: 2, 7347: 0, 7348: 2, 7349: 0, 7350: 2, 7351: 0, 7352: 2, 7353: 0, 7354: 2, 7355: 0, 7356: 2, 7357: 0, 7358: 2, 7359: 0, 7360: 2, 7361: 0, 7362: 2, 7363: 0, 7364: 2, 7365: 0, 7366: 2, 7367: 0, 7368: 2, 7369: 0, 7370: 2, 7877: 0, 7878: 0, 7882: 0, 7883: 0, 7887: 0, 7899: 0, 7991: 0, 7992: 0, 8035: 2, 8036: 2, 8058: 0, 8059: 0, 8082: 0, 8083: 0, 8088: 0, 8090: 0, 8091: 2, 8092: 0, 8093: 2, 8095: 0, 8096: 2, 8097: 0, 8098: 2, 8099: 0, 8100: 2, 8101: 0, 8102: 2, 8103: 0, 8104: 2, 8105: 0, 8106: 2, 8107: 0, 8108: 2, 8109: 0, 8110: 2, 8111: 0, 8112: 2, 8113: 0, 8114: 2, 8115: 0, 8116: 2, 8117: 0, 8118: 2, 8119: 0, 8120: 2, 8121: 0, 8122: 2, 8123: 0, 8124: 2, 8125: 0, 8126: 2, 8127: 0, 8128: 2, 8129: 0, 8130: 2, 8131: 0, 8132: 2, 8133: 0, 8134: 2, 8135: 0, 8136: 2, 8137: 0, 8138: 2, 8139: 0, 8140: 2, 8141: 0, 8142: 2, 8143: 0, 8144: 2, 8145: 0, 8146: 2, 8147: 0, 8148: 2, 8149: 0, 8150: 2, 8151: 0, 8152: 2, 8153: 0, 8154: 2, 8155: 0, 8156: 2, 8157: 0, 8158: 2, 8159: 0, 8160: 2, 8161: 0, 8162: 2, 8163: 0, 8164: 2, 8165: 0, 8166: 2, 8167: 0, 8168: 2, 8169: 0, 8170: 2, 8171: 0, 8172: 2, 8173: 0, 8177: 2, 8179: 0, 8180: 2, 8181: 0, 8182: 2, 8184: 0, 8185: 2, 8187: 0, 8189: 2, 8191: 0, 8193: 2, 8196: 0, 8197: 2, 8198: 0, 8200: 2, 8201: 0, 8202: 2, 8203: 0, 8204: 2, 8205: 0, 8206: 2, 8207: 0, 8208: 2, 8209: 0, 8210: 2, 8212: 0, 8213: 2, 8214: 0, 8216: 2, 8218: 0, 8220: 2, 8222: 0, 8224: 2, 8225: 0, 8226: 2, 8311: 0, 8312: 1, 8313: 0, 8314: 1, 8315: 0, 8316: 1, 8317: 0, 8318: 1, 8319: 0, 8320: 1, 8321: 0, 8322: 1, 8323: 0, 8324: 1, 8325: 0, 8326: 1, 8327: 0, 8328: 1, 8329: 0, 8330: 1, 8331: 0, 8332: 1, 8333: 0, 8334: 1, 8335: 0, 8336: 1, 8337: 0, 8338: 1, 8339: 0, 8340: 1, 8341: 0, 8342: 1, 8343: 0, 8344: 1, 8345: 0, 8346: 1, 8347: 0, 8348: 1, 8352: 0, 8353: 0, 8379: 0, 8380: 2, 8381: 0, 8382: 2, 8383: 0, 8384: 2, 8385: 0, 8387: 2, 8391: 0, 8395: 0, 8433: 0, 8441: 0, 8455: 0, 8456: 0, 8531: 2, 8682: 0, 8686: 0, 8687: 0, 8692: 0, 8693: 0, 8826: 0, 8903: 0, 8950: 0, 8951: 0, 9039: 0, 9040: 0, 9141: 0, 9149: 0, 9150: 0, 9191: 0, 9221: 0, 9222: 0, 9249: 0, 9250: 0, 9252: 0, 9254: 0, 9265: 0, 9284: 0, 9285: 0, 9300: 0, 9354: 0, 9367: 0, 9373: 0, 9377: 0, 9387: 0, 9391: 0, 9456: 0, 9473: 0, 9498: 0, 9674: 0, 9678: 0, 9680: 0, 9709: 0, 9712: 0, 9713: 0, 9716: 0, 9741: 0, 9748: 2, 9749: 2, 9761: 0, 9766: 0, 20499: 0, 20538: 0, 20539: 0, 20790: 0, 20791: 0, 21291: 0, 21292: 0, 21500: 0, 21817: 0, 21818: 0, 22032: 0, 22033: 0, 22091: 0, 22092: 0, 22332: 0, 22391: 0, 22392: 0, 22700: 0, 22770: 0, 22780: 0, 22832: 0, 23090: 0, 23095: 0, 23239: 0, 23240: 0, 23433: 0, 23700: 0, 24047: 0, 24048: 0, 24100: 3, 24200: 0, 24305: 0, 24306: 0, 24382: 10, 24383: 0, 24500: 0, 24547: 0, 24548: 0, 24571: 9, 24600: 0, 25e3: 0, 25231: 0, 25884: 0, 25932: 0, 26237: 0, 26331: 0, 26332: 0, 26432: 0, 26591: 0, 26592: 0, 26632: 0, 26692: 0, 27120: 0, 27200: 0, 27291: 6, 27292: 6, 27429: 0, 27492: 0, 27493: 0, 27500: 0, 27700: 0, 28232: 0, 28600: 0, 28991: 0, 28992: 0, 29100: 0, 29101: 0, 29220: 0, 29221: 0, 29333: 0, 29635: 0, 29636: 0, 29701: 0, 29738: 0, 29739: 0, 29849: 0, 29850: 0, 29871: 8, 29872: 7, 29873: 0, 29874: 0, 30200: 5, 30339: 0, 30340: 0, 30591: 0, 30592: 0, 30791: 0, 30792: 0, 30800: 0, 31028: 0, 31121: 0, 31154: 0, 31170: 0, 31171: 0, 31370: 0, 31528: 0, 31529: 0, 31600: 0, 31700: 0, 31838: 0, 31839: 0, 31900: 0, 31901: 0, 32061: 0, 32062: 0, 32098: 0, 32099: 2, 32100: 0, 32104: 0, 32161: 0, 32766: 0, 53048: 0, 53049: 0, 54090: 0, 54091: 0, 65061: 2, 65062: 2, 65161: 0, 65163: 0, 102041: 2, 102064: 11, 102068: 15, 102069: 16, 102118: 2, 102119: 1, 102120: 2, 102121: 2, 102217: 2, 102218: 0, 102219: 2, 102220: 2, 102378: 1, 102379: 1, 102380: 0, 102381: 1, 102589: 2, 102599: 2, 102600: 2, 102604: 2, 102647: 0, 102704: 2, 102705: 2, 102706: 0, 102759: 1, 102760: 1, 102761: 2, 102762: 0, 102763: 2, 102764: 0, 102765: 0, 102766: 2, 102970: 1, 102974: 2, 102993: 0, 102994: 0, 102995: 2, 102996: 2, 103015: 0, 103016: 2, 103017: 0, 103018: 2, 103025: 0, 103026: 0, 103027: 2, 103028: 2, 103035: 0, 103036: 0, 103037: 2, 103038: 2, 103039: 0, 103040: 0, 103041: 2, 103042: 2, 103043: 0, 103044: 0, 103045: 2, 103046: 2, 103047: 0, 103048: 0, 103049: 2, 103050: 2, 103051: 0, 103052: 2, 103053: 0, 103054: 2, 103055: 0, 103056: 2, 103057: 0, 103058: 0, 103059: 2, 103060: 2, 103061: 0, 103062: 0, 103063: 2, 103064: 2, 103069: 2, 103070: 0, 103071: 0, 103072: 2, 103073: 2, 103086: 0, 103087: 0, 103088: 2, 103089: 2, 103094: 1, 103095: 0, 103096: 2, 103103: 0, 103104: 2, 103105: 0, 103106: 2, 103121: 0, 103122: 2, 103123: 0, 103124: 0, 103125: 1, 103126: 1, 103127: 0, 103128: 0, 103129: 2, 103130: 2, 103131: 0, 103132: 0, 103133: 2, 103134: 2, 103135: 0, 103136: 0, 103137: 1, 103138: 1, 103139: 0, 103140: 2, 103141: 0, 103142: 2, 103143: 0, 103144: 2, 103145: 0, 103146: 1, 103147: 0, 103148: 0, 103149: 2, 103150: 2, 103151: 0, 103152: 2, 103172: 0, 103173: 2, 103174: 0, 103175: 0, 103176: 2, 103177: 2, 103178: 0, 103179: 0, 103180: 2, 103181: 2, 103182: 0, 103183: 0, 103184: 2, 103185: 2, 103228: 0, 103229: 0, 103230: 2, 103231: 2, 103250: 0, 103251: 2, 103252: 0, 103253: 2, 103260: 0, 103261: 0, 103262: 2, 103263: 2, 103270: 0, 103271: 0, 103272: 2, 103273: 2, 103274: 0, 103275: 0, 103276: 2, 103277: 2, 103278: 0, 103279: 0, 103280: 2, 103281: 2, 103282: 0, 103283: 0, 103284: 2, 103285: 2, 103286: 0, 103287: 2, 103288: 0, 103289: 2, 103290: 0, 103291: 2, 103292: 0, 103293: 0, 103294: 2, 103295: 2, 103296: 0, 103297: 0, 103298: 2, 103299: 2, 103376: 2, 103377: 0, 103378: 0, 103379: 2, 103380: 2, 103393: 0, 103394: 0, 103395: 2, 103396: 2, 103472: 0, 103473: 1, 103474: 0, 103475: 2, 103482: 0, 103483: 2, 103484: 0, 103485: 2, 103500: 0, 103501: 2, 103502: 0, 103503: 0, 103504: 1, 103505: 1, 103506: 0, 103507: 0, 103508: 2, 103509: 2, 103510: 0, 103511: 0, 103512: 2, 103513: 2, 103514: 0, 103515: 2, 103516: 0, 103517: 2, 103518: 0, 103519: 2, 103520: 0, 103521: 1, 103522: 0, 103523: 0, 103524: 2, 103525: 2, 103526: 0, 103527: 2, 103561: 2, 103562: 2, 103563: 0, 103564: 0, 103565: 2, 103566: 2, 103567: 0, 103568: 0, 103569: 2, 103570: 2, 103584: 0, 103585: 2, 103586: 0, 103587: 2, 103588: 1, 103589: 0, 103590: 2, 103591: 1, 103592: 0, 103593: 2, 103594: 1, 103695: 2 };
for (o$28 = 2e3; o$28 <= 2045; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 2056; o$28 <= 2065; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 2067; o$28 <= 2135; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 2137; o$28 <= 2154; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 2161; o$28 <= 2170; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 2172; o$28 <= 2193; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 2195; o$28 <= 2198; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 2200; o$28 <= 2203; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 2205; o$28 <= 2217; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 2222; o$28 <= 2224; o$28++)
  r$1O[o$28] = 1;
for (o$28 = 2225; o$28 <= 2250; o$28++)
  r$1O[o$28] = 2;
for (o$28 = 2251; o$28 <= 2253; o$28++)
  r$1O[o$28] = 1;
for (o$28 = 2257; o$28 <= 2264; o$28++)
  r$1O[o$28] = 2;
for (o$28 = 2274; o$28 <= 2279; o$28++)
  r$1O[o$28] = 2;
for (o$28 = 2280; o$28 <= 2282; o$28++)
  r$1O[o$28] = 1;
for (o$28 = 2283; o$28 <= 2289; o$28++)
  r$1O[o$28] = 2;
for (o$28 = 2290; o$28 <= 2292; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 2308; o$28 <= 2313; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 2315; o$28 <= 2491; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 2494; o$28 <= 2866; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 2867; o$28 <= 2869; o$28++)
  r$1O[o$28] = 1;
for (o$28 = 2870; o$28 <= 2888; o$28++)
  r$1O[o$28] = 2;
for (o$28 = 2891; o$28 <= 2895; o$28++)
  r$1O[o$28] = 2;
for (o$28 = 2896; o$28 <= 2898; o$28++)
  r$1O[o$28] = 1;
for (o$28 = 2902; o$28 <= 2908; o$28++)
  r$1O[o$28] = 2;
for (o$28 = 2915; o$28 <= 2920; o$28++)
  r$1O[o$28] = 2;
for (o$28 = 2921; o$28 <= 2923; o$28++)
  r$1O[o$28] = 1;
for (o$28 = 2924; o$28 <= 2930; o$28++)
  r$1O[o$28] = 2;
for (o$28 = 2931; o$28 <= 2962; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 2964; o$28 <= 2968; o$28++)
  r$1O[o$28] = 2;
for (o$28 = 2969; o$28 <= 2973; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 2975; o$28 <= 2991; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 2995; o$28 <= 3051; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 3054; o$28 <= 3079; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 3081; o$28 <= 3088; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 3092; o$28 <= 3101; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 3106; o$28 <= 3138; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 3146; o$28 <= 3151; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 3153; o$28 <= 3166; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 3168; o$28 <= 3172; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 3174; o$28 <= 3203; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 3294; o$28 <= 3358; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 3367; o$28 <= 3403; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 3408; o$28 <= 3416; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 3417; o$28 <= 3438; o$28++)
  r$1O[o$28] = 2;
for (o$28 = 3441; o$28 <= 3446; o$28++)
  r$1O[o$28] = 2;
for (o$28 = 3447; o$28 <= 3450; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 3451; o$28 <= 3459; o$28++)
  r$1O[o$28] = 2;
for (o$28 = 3460; o$28 <= 3478; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 3554; o$28 <= 3559; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 3560; o$28 <= 3570; o$28++)
  r$1O[o$28] = 2;
for (o$28 = 3571; o$28 <= 3581; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 3594; o$28 <= 3597; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 3601; o$28 <= 3604; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 3637; o$28 <= 3639; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 3665; o$28 <= 3667; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 3693; o$28 <= 3695; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 3701; o$28 <= 3727; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 3728; o$28 <= 3739; o$28++)
  r$1O[o$28] = 2;
for (o$28 = 3740; o$28 <= 3751; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 3753; o$28 <= 3760; o$28++)
  r$1O[o$28] = 2;
for (o$28 = 3761; o$28 <= 3773; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 3775; o$28 <= 3777; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 3779; o$28 <= 3781; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 3783; o$28 <= 3785; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 3788; o$28 <= 3791; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 3797; o$28 <= 3802; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 3814; o$28 <= 3816; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 3825; o$28 <= 3829; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 3832; o$28 <= 3841; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 3844; o$28 <= 3852; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 3873; o$28 <= 3885; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 3890; o$28 <= 3893; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 3907; o$28 <= 3912; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 3942; o$28 <= 3950; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 3968; o$28 <= 3970; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 3973; o$28 <= 3976; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 3986; o$28 <= 3989; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 3994; o$28 <= 3997; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 4048; o$28 <= 4051; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 4056; o$28 <= 4063; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 4093; o$28 <= 4096; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 4390; o$28 <= 4398; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 4399; o$28 <= 4413; o$28++)
  r$1O[o$28] = 2;
for (o$28 = 4418; o$28 <= 4433; o$28++)
  r$1O[o$28] = 2;
for (o$28 = 4455; o$28 <= 4457; o$28++)
  r$1O[o$28] = 2;
for (o$28 = 4484; o$28 <= 4489; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 4491; o$28 <= 4554; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 4568; o$28 <= 4589; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 4652; o$28 <= 4656; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 4766; o$28 <= 4800; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 5014; o$28 <= 5016; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 5069; o$28 <= 5072; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 5105; o$28 <= 5130; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 5173; o$28 <= 5188; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 5253; o$28 <= 5259; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 5269; o$28 <= 5275; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 5292; o$28 <= 5311; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 5329; o$28 <= 5331; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 5343; o$28 <= 5349; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 5355; o$28 <= 5357; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 5387; o$28 <= 5389; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 5459; o$28 <= 5463; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 5479; o$28 <= 5482; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 5518; o$28 <= 5520; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 5530; o$28 <= 5539; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 5550; o$28 <= 5552; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 5562; o$28 <= 5583; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 5623; o$28 <= 5625; o$28++)
  r$1O[o$28] = 2;
for (o$28 = 5631; o$28 <= 5639; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 5649; o$28 <= 5653; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 5663; o$28 <= 5680; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 5682; o$28 <= 5685; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 5875; o$28 <= 5877; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 5896; o$28 <= 5899; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 5921; o$28 <= 5940; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 6050; o$28 <= 6125; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 6244; o$28 <= 6275; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 6328; o$28 <= 6348; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 6350; o$28 <= 6356; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 6366; o$28 <= 6372; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 6381; o$28 <= 6387; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 6393; o$28 <= 6404; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 6480; o$28 <= 6483; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 6511; o$28 <= 6514; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 6579; o$28 <= 6581; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 6619; o$28 <= 6624; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 6625; o$28 <= 6627; o$28++)
  r$1O[o$28] = 2;
for (o$28 = 6628; o$28 <= 6632; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 6634; o$28 <= 6637; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 6669; o$28 <= 6692; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 6707; o$28 <= 6709; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 6720; o$28 <= 6723; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 6732; o$28 <= 6738; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 6931; o$28 <= 6933; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 6956; o$28 <= 6959; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 7005; o$28 <= 7007; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 7057; o$28 <= 7070; o$28++)
  r$1O[o$28] = 2;
for (o$28 = 7074; o$28 <= 7082; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 7109; o$28 <= 7118; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 7119; o$28 <= 7127; o$28++)
  r$1O[o$28] = 1;
for (o$28 = 7374; o$28 <= 7376; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 7528; o$28 <= 7586; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 7587; o$28 <= 7645; o$28++)
  r$1O[o$28] = 2;
for (o$28 = 7692; o$28 <= 7696; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 7755; o$28 <= 7787; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 7791; o$28 <= 7795; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 7799; o$28 <= 7801; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 7803; o$28 <= 7805; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 7825; o$28 <= 7831; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 7845; o$28 <= 7859; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 8013; o$28 <= 8032; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 8065; o$28 <= 8068; o$28++)
  r$1O[o$28] = 1;
for (o$28 = 8518; o$28 <= 8529; o$28++)
  r$1O[o$28] = 2;
for (o$28 = 8533; o$28 <= 8536; o$28++)
  r$1O[o$28] = 2;
for (o$28 = 8538; o$28 <= 8540; o$28++)
  r$1O[o$28] = 2;
for (o$28 = 8677; o$28 <= 8679; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 8836; o$28 <= 8840; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 8857; o$28 <= 8859; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 8908; o$28 <= 8910; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 9154; o$28 <= 9159; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 9205; o$28 <= 9218; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 9271; o$28 <= 9273; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 9295; o$28 <= 9297; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 9356; o$28 <= 9360; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 9404; o$28 <= 9407; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 9476; o$28 <= 9482; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 9487; o$28 <= 9494; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 9697; o$28 <= 9699; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 20002; o$28 <= 20032; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 20062; o$28 <= 20092; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 20135; o$28 <= 20138; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 20248; o$28 <= 20258; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 20348; o$28 <= 20358; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 20436; o$28 <= 20440; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 20822; o$28 <= 20824; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 20904; o$28 <= 20932; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 20934; o$28 <= 20936; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 21004; o$28 <= 21032; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 21035; o$28 <= 21037; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 21095; o$28 <= 21097; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 21148; o$28 <= 21150; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 21207; o$28 <= 21264; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 21307; o$28 <= 21364; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 21413; o$28 <= 21423; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 21453; o$28 <= 21463; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 21473; o$28 <= 21483; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 21780; o$28 <= 21782; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 21891; o$28 <= 21894; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 21896; o$28 <= 21899; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 22171; o$28 <= 22177; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 22181; o$28 <= 22187; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 22191; o$28 <= 22197; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 22234; o$28 <= 22236; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 22521; o$28 <= 22525; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 22991; o$28 <= 22994; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 23028; o$28 <= 23038; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 23830; o$28 <= 23853; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 23866; o$28 <= 23872; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 23877; o$28 <= 23884; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 23886; o$28 <= 23894; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 23946; o$28 <= 23948; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 24311; o$28 <= 24313; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 24342; o$28 <= 24347; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 24370; o$28 <= 24374; o$28++)
  r$1O[o$28] = 10;
for (o$28 = 24375; o$28 <= 24381; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 24718; o$28 <= 24721; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 24817; o$28 <= 24821; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 24877; o$28 <= 24882; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 24891; o$28 <= 24893; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 25391; o$28 <= 25395; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 25828; o$28 <= 25838; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 26191; o$28 <= 26195; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 26391; o$28 <= 26393; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 26701; o$28 <= 26722; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 26729; o$28 <= 26799; o$28++)
  r$1O[o$28] = 2;
for (o$28 = 26801; o$28 <= 26803; o$28++)
  r$1O[o$28] = 2;
for (o$28 = 26811; o$28 <= 26813; o$28++)
  r$1O[o$28] = 2;
for (o$28 = 26847; o$28 <= 26870; o$28++)
  r$1O[o$28] = 2;
for (o$28 = 26891; o$28 <= 26899; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 26901; o$28 <= 26923; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 26929; o$28 <= 26946; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 26948; o$28 <= 26998; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 27037; o$28 <= 27040; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 27205; o$28 <= 27232; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 27258; o$28 <= 27260; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 27391; o$28 <= 27398; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 27561; o$28 <= 27564; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 27571; o$28 <= 27574; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 27581; o$28 <= 27584; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 27591; o$28 <= 27594; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 28191; o$28 <= 28193; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 28348; o$28 <= 28358; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 28402; o$28 <= 28432; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 28462; o$28 <= 28492; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 29118; o$28 <= 29122; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 29168; o$28 <= 29172; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 29177; o$28 <= 29185; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 29187; o$28 <= 29195; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 29900; o$28 <= 29903; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 30161; o$28 <= 30179; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 30491; o$28 <= 30494; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 30729; o$28 <= 30732; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 31251; o$28 <= 31259; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 31265; o$28 <= 31268; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 31275; o$28 <= 31279; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 31281; o$28 <= 31297; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 31461; o$28 <= 31469; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 31491; o$28 <= 31495; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 31917; o$28 <= 31922; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 31965; o$28 <= 32e3; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 32001; o$28 <= 32003; o$28++)
  r$1O[o$28] = 2;
for (o$28 = 32005; o$28 <= 32031; o$28++)
  r$1O[o$28] = 2;
for (o$28 = 32033; o$28 <= 32060; o$28++)
  r$1O[o$28] = 2;
for (o$28 = 32064; o$28 <= 32067; o$28++)
  r$1O[o$28] = 2;
for (o$28 = 32074; o$28 <= 32077; o$28++)
  r$1O[o$28] = 2;
for (o$28 = 32081; o$28 <= 32086; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 32107; o$28 <= 32130; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 32133; o$28 <= 32158; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 32164; o$28 <= 32167; o$28++)
  r$1O[o$28] = 2;
for (o$28 = 32180; o$28 <= 32199; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 32201; o$28 <= 32260; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 32301; o$28 <= 32360; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 32601; o$28 <= 32662; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 32664; o$28 <= 32667; o$28++)
  r$1O[o$28] = 2;
for (o$28 = 32701; o$28 <= 32761; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 53001; o$28 <= 53004; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 53008; o$28 <= 53019; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 53021; o$28 <= 53032; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 53034; o$28 <= 53037; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 53042; o$28 <= 53046; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 53074; o$28 <= 53080; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 54001; o$28 <= 54004; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 54008; o$28 <= 54019; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 54021; o$28 <= 54032; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 54034; o$28 <= 54037; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 54042; o$28 <= 54046; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 54048; o$28 <= 54053; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 54074; o$28 <= 54080; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 54098; o$28 <= 54101; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 102001; o$28 <= 102040; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 102042; o$28 <= 102063; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 102065; o$28 <= 102067; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 102070; o$28 <= 102117; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 102122; o$28 <= 102216; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 102221; o$28 <= 102377; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 102382; o$28 <= 102388; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 102389; o$28 <= 102398; o$28++)
  r$1O[o$28] = 2;
for (o$28 = 102399; o$28 <= 102444; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 102445; o$28 <= 102447; o$28++)
  r$1O[o$28] = 2;
for (o$28 = 102448; o$28 <= 102458; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 102459; o$28 <= 102468; o$28++)
  r$1O[o$28] = 2;
for (o$28 = 102469; o$28 <= 102499; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 102500; o$28 <= 102519; o$28++)
  r$1O[o$28] = 1;
for (o$28 = 102520; o$28 <= 102524; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 102525; o$28 <= 102529; o$28++)
  r$1O[o$28] = 2;
for (o$28 = 102530; o$28 <= 102588; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 102590; o$28 <= 102598; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 102601; o$28 <= 102603; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 102605; o$28 <= 102628; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 102629; o$28 <= 102646; o$28++)
  r$1O[o$28] = 2;
for (o$28 = 102648; o$28 <= 102700; o$28++)
  r$1O[o$28] = 2;
for (o$28 = 102701; o$28 <= 102703; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 102707; o$28 <= 102730; o$28++)
  r$1O[o$28] = 2;
for (o$28 = 102733; o$28 <= 102758; o$28++)
  r$1O[o$28] = 2;
for (o$28 = 102767; o$28 <= 102900; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 102901; o$28 <= 102933; o$28++)
  r$1O[o$28] = 2;
for (o$28 = 102934; o$28 <= 102950; o$28++)
  r$1O[o$28] = 13;
for (o$28 = 102951; o$28 <= 102955; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 102961; o$28 <= 102963; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 102965; o$28 <= 102969; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 102971; o$28 <= 102973; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 102975; o$28 <= 102989; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 102990; o$28 <= 102992; o$28++)
  r$1O[o$28] = 1;
for (o$28 = 102997; o$28 <= 103002; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 103003; o$28 <= 103008; o$28++)
  r$1O[o$28] = 2;
for (o$28 = 103009; o$28 <= 103011; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 103012; o$28 <= 103014; o$28++)
  r$1O[o$28] = 2;
for (o$28 = 103019; o$28 <= 103021; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 103022; o$28 <= 103024; o$28++)
  r$1O[o$28] = 2;
for (o$28 = 103029; o$28 <= 103031; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 103032; o$28 <= 103034; o$28++)
  r$1O[o$28] = 2;
for (o$28 = 103065; o$28 <= 103068; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 103074; o$28 <= 103076; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 103077; o$28 <= 103079; o$28++)
  r$1O[o$28] = 1;
for (o$28 = 103080; o$28 <= 103082; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 103083; o$28 <= 103085; o$28++)
  r$1O[o$28] = 2;
for (o$28 = 103090; o$28 <= 103093; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 103097; o$28 <= 103099; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 103100; o$28 <= 103102; o$28++)
  r$1O[o$28] = 2;
for (o$28 = 103107; o$28 <= 103109; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 103110; o$28 <= 103112; o$28++)
  r$1O[o$28] = 2;
for (o$28 = 103113; o$28 <= 103116; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 103117; o$28 <= 103120; o$28++)
  r$1O[o$28] = 2;
for (o$28 = 103153; o$28 <= 103157; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 103158; o$28 <= 103162; o$28++)
  r$1O[o$28] = 2;
for (o$28 = 103163; o$28 <= 103165; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 103166; o$28 <= 103168; o$28++)
  r$1O[o$28] = 1;
for (o$28 = 103169; o$28 <= 103171; o$28++)
  r$1O[o$28] = 2;
for (o$28 = 103186; o$28 <= 103188; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 103189; o$28 <= 103191; o$28++)
  r$1O[o$28] = 2;
for (o$28 = 103192; o$28 <= 103195; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 103196; o$28 <= 103199; o$28++)
  r$1O[o$28] = 2;
for (o$28 = 103200; o$28 <= 103224; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 103225; o$28 <= 103227; o$28++)
  r$1O[o$28] = 1;
for (o$28 = 103232; o$28 <= 103237; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 103238; o$28 <= 103243; o$28++)
  r$1O[o$28] = 2;
for (o$28 = 103244; o$28 <= 103246; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 103247; o$28 <= 103249; o$28++)
  r$1O[o$28] = 2;
for (o$28 = 103254; o$28 <= 103256; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 103257; o$28 <= 103259; o$28++)
  r$1O[o$28] = 2;
for (o$28 = 103264; o$28 <= 103266; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 103267; o$28 <= 103269; o$28++)
  r$1O[o$28] = 2;
for (o$28 = 103300; o$28 <= 103375; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 103381; o$28 <= 103383; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 103384; o$28 <= 103386; o$28++)
  r$1O[o$28] = 1;
for (o$28 = 103387; o$28 <= 103389; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 103390; o$28 <= 103392; o$28++)
  r$1O[o$28] = 2;
for (o$28 = 103397; o$28 <= 103399; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 103400; o$28 <= 103471; o$28++)
  r$1O[o$28] = 2;
for (o$28 = 103476; o$28 <= 103478; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 103479; o$28 <= 103481; o$28++)
  r$1O[o$28] = 2;
for (o$28 = 103486; o$28 <= 103488; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 103489; o$28 <= 103491; o$28++)
  r$1O[o$28] = 2;
for (o$28 = 103492; o$28 <= 103495; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 103496; o$28 <= 103499; o$28++)
  r$1O[o$28] = 2;
for (o$28 = 103528; o$28 <= 103543; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 103544; o$28 <= 103548; o$28++)
  r$1O[o$28] = 2;
for (o$28 = 103549; o$28 <= 103551; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 103552; o$28 <= 103554; o$28++)
  r$1O[o$28] = 1;
for (o$28 = 103555; o$28 <= 103557; o$28++)
  r$1O[o$28] = 2;
for (o$28 = 103558; o$28 <= 103560; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 103571; o$28 <= 103573; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 103574; o$28 <= 103576; o$28++)
  r$1O[o$28] = 2;
for (o$28 = 103577; o$28 <= 103580; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 103581; o$28 <= 103583; o$28++)
  r$1O[o$28] = 2;
for (o$28 = 103595; o$28 <= 103694; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 103696; o$28 <= 103699; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 103700; o$28 <= 103793; o$28++)
  r$1O[o$28] = 2;
for (o$28 = 103794; o$28 <= 103887; o$28++)
  r$1O[o$28] = 0;
for (o$28 = 103900; o$28 <= 103971; o$28++)
  r$1O[o$28] = 2;
const t$22 = { 102113: true, 102100: true, 3857: true, 3785: true }, _$N = { 4326: true, 3785: true, 3857: true, 102113: true, 102100: true, 104905: true, 104971: true }, l$2A = 'PROJCS["WGS_1984_Web_Mercator_Auxiliary_Sphere",GEOGCS["GCS_WGS_1984",DATUM["D_WGS_1984",SPHEROID["WGS_1984",6378137.0,298.257223563]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]],PROJECTION["Mercator_Auxiliary_Sphere"],PARAMETER["False_Easting",0.0],PARAMETER["False_Northing",0.0],PARAMETER["Central_Meridian",{Central_Meridian}],PARAMETER["Standard_Parallel_1",0.0],PARAMETER["Auxiliary_Sphere_Type",0.0],UNIT["Meter",1.0]]', M$M = [-20037508342788905e-9, 20037508342788905e-9], S$S = [-20037508342787e-6, 20037508342787e-6], d$1T = { 102113: { wkTemplate: 'PROJCS["WGS_1984_Web_Mercator",GEOGCS["GCS_WGS_1984_Major_Auxiliary_Sphere",DATUM["D_WGS_1984_Major_Auxiliary_Sphere",SPHEROID["WGS_1984_Major_Auxiliary_Sphere",6378137.0,0.0]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]],PROJECTION["Mercator"],PARAMETER["False_Easting",0.0],PARAMETER["False_Northing",0.0],PARAMETER["Central_Meridian",{Central_Meridian}],PARAMETER["Standard_Parallel_1",0.0],UNIT["Meter",1.0]]', valid: M$M, origin: S$S, dx: 1e-5 }, 102100: { wkTemplate: l$2A, valid: M$M, origin: S$S, dx: 1e-5 }, 3785: { wkTemplate: 'PROJCS["WGS_1984_Web_Mercator",GEOGCS["GCS_WGS_1984_Major_Auxiliary_Sphere",DATUM["D_WGS_1984_Major_Auxiliary_Sphere",SPHEROID["WGS_1984_Major_Auxiliary_Sphere",6378137.0,0.0]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]],PROJECTION["Mercator"],PARAMETER["False_Easting",0.0],PARAMETER["False_Northing",0.0],PARAMETER["Central_Meridian",{Central_Meridian}],PARAMETER["Standard_Parallel_1",0.0],UNIT["Meter",1.0]]', valid: M$M, origin: S$S, dx: 1e-5 }, 3857: { wkTemplate: l$2A, valid: M$M, origin: S$S, dx: 1e-5 }, 4326: { wkTemplate: 'GEOGCS["GCS_WGS_1984",DATUM["D_WGS_1984",SPHEROID["WGS_1984",6378137.0,298.257223563]],PRIMEM["Greenwich",{Central_Meridian}],UNIT["Degree",0.0174532925199433]]', altTemplate: 'PROJCS["WGS_1984_Plate_Carree",GEOGCS["GCS_WGS_1984",DATUM["D_WGS_1984",SPHEROID["WGS_1984",6378137.0,298.257223563]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]],PROJECTION["Plate_Carree"],PARAMETER["False_Easting",0.0],PARAMETER["False_Northing",0.0],PARAMETER["Central_Meridian",{Central_Meridian}],UNIT["Degrees",111319.491]]', valid: [-180, 180], origin: [-180, 90], dx: 1e-5 }, 104971: { wkTemplate: 'GEOGCS["Mars_2000_(Sphere)",DATUM["Mars_2000_(Sphere)",SPHEROID["Mars_2000_(Sphere)",3396190.0,0.0]],PRIMEM["Reference_Meridian",0.0],UNIT["Degree",0.0174532925199433]]', valid: [-180, 180], origin: [-180, 90], dx: 1e-5 }, 104905: { wkTemplate: 'GEOGCS["GCS_Mars_2000",DATUM["D_Mars_2000",SPHEROID["Mars_2000_IAU_IAG",3396190.0,169.8944472236118]],PRIMEM["Reference_Meridian",0.0],UNIT["Degree",0.0174532925199433]]', valid: [-180, 180], origin: [-180, 90], dx: 1e-5 } };
function E$P(r2, i2) {
  return r2 === i2 || !t$2r(r2) && !t$2r(i2) && (r2.wkid != null || i2.wkid != null ? r2.wkid === i2.wkid || k$D(r2) && k$D(i2) || i2.latestWkid != null && r2.wkid === i2.latestWkid || r2.latestWkid != null && i2.wkid === r2.latestWkid : !(!r2.wkt || !i2.wkt) && r2.wkt.toUpperCase() === i2.wkt.toUpperCase());
}
function R$B(e2) {
  return I$K(e2) && e2.wkid && d$1T[e2.wkid] || null;
}
function o$27(e2) {
  return !!I$K(e2) && (e2.wkid ? r$1O[e2.wkid] == null : !!e2.wkt && !!/^\s*GEOGCS/i.test(e2.wkt));
}
function A$z(e2) {
  return !(P$D(e2) || s$2j(e2));
}
function G$w(e2) {
  return I$K(e2) && e2.wkid === 4326;
}
function u$2a(e2) {
  return I$K(e2) && e2.wkid === S$T.CGCS2000;
}
function k$D(e2) {
  return I$K(e2) && e2.wkid != null && t$22[e2.wkid] === true;
}
function T$D(e2) {
  return I$K(e2) && e2.wkid === 32662;
}
function w$$(e2) {
  return e2 === S$T.GCSMARS2000 || e2 === S$T.GCSMARS2000_SPHERE;
}
function P$D(e2) {
  return I$K(e2) && e2.wkid != null && w$$(e2.wkid);
}
function C$D(e2) {
  return e2 === S$T.GCSMOON2000;
}
function s$2j(e2) {
  return I$K(e2) && e2.wkid != null && C$D(e2.wkid);
}
function p$3z(e2) {
  return I$K(e2) && e2.wkid != null && _$N[e2.wkid] === true;
}
function I$K(e2) {
  return r$1$(e2) && (e2.wkid != null && e2.wkid >= 2e3 || e2.wkt != null);
}
const c$3d = { wkid: 4326, wkt: n$2W(d$1T[4326].wkTemplate, { Central_Meridian: "0.0" }) }, D$B = { wkid: 102100, latestWkid: 3857 }, O$D = { wkid: 32662 };
var y$1y;
let S$R = y$1y = class extends l$2B {
  constructor(e2) {
    super(e2), this.latestWkid = null, this.wkid = null, this.wkt = null, this.vcsWkid = null, this.latestVcsWkid = null, this.imageCoordinateSystem = null;
  }
  static fromJSON(e2) {
    if (!e2)
      return null;
    if (e2.wkid) {
      if (e2.wkid === 102100)
        return y$1y.WebMercator;
      if (e2.wkid === 4326)
        return y$1y.WGS84;
    }
    const t2 = new y$1y();
    return t2.read(e2), t2;
  }
  normalizeCtorArgs(e2) {
    if (e2 && typeof e2 == "object")
      return e2;
    return { [typeof e2 == "string" ? "wkt" : "wkid"]: e2 };
  }
  get isWGS84() {
    return G$w(this);
  }
  get isWebMercator() {
    return k$D(this);
  }
  get isGeographic() {
    return o$27(this);
  }
  get isWrappable() {
    return p$3z(this);
  }
  writeWkt(e2, t2) {
    this.wkid || (t2.wkt = e2);
  }
  clone() {
    if (this === y$1y.WGS84)
      return y$1y.WGS84;
    if (this === y$1y.WebMercator)
      return y$1y.WebMercator;
    const e2 = new y$1y();
    return this.wkid != null ? (e2.wkid = this.wkid, this.latestWkid != null && (e2.latestWkid = this.latestWkid), this.vcsWkid != null && (e2.vcsWkid = this.vcsWkid), this.latestVcsWkid != null && (e2.latestVcsWkid = this.latestVcsWkid)) : this.wkt != null && (e2.wkt = this.wkt), this.imageCoordinateSystem && (e2.imageCoordinateSystem = y$1L(this.imageCoordinateSystem)), e2;
  }
  equals(e2) {
    if (e2 == null)
      return false;
    if (this.imageCoordinateSystem || e2.imageCoordinateSystem) {
      if (this.imageCoordinateSystem == null || e2.imageCoordinateSystem == null)
        return false;
      const { id: t2, referenceServiceName: r2 } = e2.imageCoordinateSystem, { geodataXform: i2 } = e2.imageCoordinateSystem, o2 = this.imageCoordinateSystem;
      return t2 == null || i2 ? JSON.stringify(o2) === JSON.stringify(e2.imageCoordinateSystem) : r2 ? o2.id === t2 && o2.referenceServiceName === r2 : o2.id === t2;
    }
    return E$P(this, e2);
  }
  toJSON(e2) {
    return this.write(void 0, e2);
  }
};
S$R.GCS_NAD_1927 = null, S$R.WGS84 = null, S$R.WebMercator = null, S$R.PlateCarree = null, e$2g([y$1I({ readOnly: true })], S$R.prototype, "isWGS84", null), e$2g([y$1I({ readOnly: true })], S$R.prototype, "isWebMercator", null), e$2g([y$1I({ readOnly: true })], S$R.prototype, "isGeographic", null), e$2g([y$1I({ readOnly: true })], S$R.prototype, "isWrappable", null), e$2g([y$1I({ type: T$G, json: { write: true } })], S$R.prototype, "latestWkid", void 0), e$2g([y$1I({ type: T$G, json: { write: true, origins: { "web-scene": { write: { overridePolicy() {
  return { isRequired: this.wkt === null };
} } } } } })], S$R.prototype, "wkid", void 0), e$2g([y$1I({ type: String, json: { origins: { "web-scene": { write: { overridePolicy() {
  return { isRequired: this.wkid === null };
} } } } } })], S$R.prototype, "wkt", void 0), e$2g([r$1P("wkt"), r$1P("web-scene", "wkt")], S$R.prototype, "writeWkt", null), e$2g([y$1I({ type: T$G, json: { write: true } })], S$R.prototype, "vcsWkid", void 0), e$2g([y$1I({ type: T$G, json: { write: true } })], S$R.prototype, "latestVcsWkid", void 0), e$2g([y$1I()], S$R.prototype, "imageCoordinateSystem", void 0), S$R = y$1y = e$2g([n$2P("esri.geometry.SpatialReference")], S$R), S$R.prototype.toJSON.isDefaultToJSON = true, S$R.GCS_NAD_1927 = new S$R({ wkid: 4267, wkt: 'GEOGCS["GCS_North_American_1927",DATUM["D_North_American_1927",SPHEROID["Clarke_1866",6378206.4,294.9786982]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]]' }), S$R.WGS84 = new S$R(c$3d), S$R.WebMercator = new S$R(D$B), S$R.PlateCarree = new S$R(O$D), Object.freeze && (Object.freeze(S$R.GCS_NAD_1927), Object.freeze(S$R.WGS84), Object.freeze(S$R.WebMercator));
const k$C = S$R;
let c$3c = class extends l$2B {
  constructor(...e2) {
    super(...e2), this.type = null, this.hasM = false, this.hasZ = false, this.spatialReference = k$C.WGS84;
  }
  get cache() {
    return this.commitProperty("spatialReference"), {};
  }
  get extent() {
    return null;
  }
  readSpatialReference(e2, r2) {
    if (e2 instanceof k$C)
      return e2;
    if (e2 != null) {
      const t2 = new k$C();
      return t2.read(e2, r2), t2;
    }
    return e2;
  }
  clone() {
    return console.warn(".clone() is not implemented for " + this.declaredClass), null;
  }
  clearCache() {
    this.notifyChange("cache");
  }
  getCacheValue(e2) {
    return this.cache[e2];
  }
  setCacheValue(e2, r2) {
    this.cache[e2] = r2;
  }
};
e$2g([y$1I()], c$3c.prototype, "type", void 0), e$2g([y$1I({ readOnly: true })], c$3c.prototype, "cache", null), e$2g([y$1I({ readOnly: true })], c$3c.prototype, "extent", null), e$2g([y$1I({ type: Boolean, json: { write: { overridePolicy: (e2) => ({ enabled: e2 }) } } })], c$3c.prototype, "hasM", void 0), e$2g([y$1I({ type: Boolean, json: { write: { overridePolicy: (e2) => ({ enabled: e2 }) } } })], c$3c.prototype, "hasZ", void 0), e$2g([y$1I({ type: k$C, json: { write: true } })], c$3c.prototype, "spatialReference", void 0), e$2g([o$29("spatialReference")], c$3c.prototype, "readSpatialReference", null), c$3c = e$2g([n$2P("esri.geometry.Geometry")], c$3c);
const p$3y = c$3c;
const r$1N = Object.prototype.toString;
function o$26(n2) {
  const r2 = "__accessorMetadata__" in n2 ? b$1a(n2) : n2;
  return function(...t2) {
    if (t2.push(r2), typeof t2[2] == "number")
      throw new Error("Using @cast has parameter decorator is not supported since 4.16");
    return e$1X.apply(this, t2);
  };
}
function e$1X(t2, r2, o2, e2) {
  s$2v(t2, r2).cast = e2;
}
function i$2_(t2) {
  return (r2, o2) => {
    s$2v(r2, t2).cast = r2[o2];
  };
}
function s$2i(...t2) {
  if (t2.length !== 3 || typeof t2[1] != "string")
    return t2.length === 1 && r$1N.call(t2[0]) === "[object Function]" ? o$26(t2[0]) : t2.length === 1 && typeof t2[0] == "string" ? i$2_(t2[0]) : void 0;
}
function t$21(t2, n2) {
  const s2 = t2.x - n2.x, r2 = t2.y - n2.y, a2 = t2.hasZ && n2.hasZ ? t2.z - n2.z : 0;
  return Math.sqrt(s2 * s2 + r2 * r2 + a2 * a2);
}
class i$2Z {
  constructor(i2, s2, t2, e2) {
    this.semiMajorAxis = i2, this.flattening = s2, this.outerAtmosphereRimWidth = t2;
    const h2 = 1 - this.flattening;
    this.semiMinorAxis = this.semiMajorAxis * h2, this.halfSemiMajorAxis = this.semiMajorAxis / 2, this.halfCircumference = Math.PI * this.semiMajorAxis, this.metersPerDegree = this.halfCircumference / 180, this.inverseFlattening = 1 / (1 - this.flattening) - 1, this.eccentricitySquared = e2 || 2 * this.flattening - this.flattening * this.flattening, this.meanRadiusSemiAxes = (2 * this.semiMajorAxis + this.semiMinorAxis) / 3;
  }
  get radius() {
    return this.semiMajorAxis;
  }
}
const s$2h = new i$2Z(6378137, 1 / 298.257223563, 3e5, 0.006694379990137799), t$20 = new i$2Z(3396190, 1 / 169.8944472236118, 23e4), e$1W = new i$2Z(1737400, 0, 0);
const o$25 = 57.29577951308232, u$29 = 0.017453292519943;
function l$2z(n2) {
  return n2 * o$25;
}
function p$3x(n2) {
  return n2 * u$29;
}
function c$3b(n2) {
  return Math.PI / 2 - 2 * Math.atan(Math.exp(-n2 / s$2h.radius));
}
function h$1O(n2) {
  return n2.wkid != null || n2.wkt != null;
}
const m$2p = [0, 0];
function x$11(n2, t2, e2, i2, r2) {
  const s2 = n2, a2 = r2;
  if (a2.spatialReference = e2, "x" in s2 && "x" in a2)
    [a2.x, a2.y] = t2(s2.x, s2.y, m$2p, i2);
  else if ("xmin" in s2 && "xmin" in a2)
    [a2.xmin, a2.ymin] = t2(s2.xmin, s2.ymin, m$2p, i2), [a2.xmax, a2.ymax] = t2(s2.xmax, s2.ymax, m$2p, i2);
  else if ("paths" in s2 && "paths" in a2 || "rings" in s2 && "rings" in a2) {
    const n3 = "paths" in s2 ? s2.paths : s2.rings, e3 = [];
    let r3;
    for (let s3 = 0; s3 < n3.length; s3++) {
      const a3 = n3[s3];
      r3 = [], e3.push(r3);
      for (let n4 = 0; n4 < a3.length; n4++)
        r3.push(t2(a3[n4][0], a3[n4][1], [0, 0], i2)), a3[n4].length > 2 && r3[n4].push(a3[n4][2]), a3[n4].length > 3 && r3[n4].push(a3[n4][3]);
    }
    "paths" in a2 ? a2.paths = e3 : a2.rings = e3;
  } else if ("points" in s2 && "points" in a2) {
    const n3 = s2.points, e3 = [];
    for (let r3 = 0; r3 < n3.length; r3++)
      e3[r3] = t2(n3[r3][0], n3[r3][1], [0, 0], i2), n3[r3].length > 2 && e3[r3].push(n3[r3][2]), n3[r3].length > 3 && e3[r3].push(n3[r3][3]);
    a2.points = e3;
  }
  return r2;
}
function g$1i(n2, t2) {
  const e2 = n2 && (h$1O(n2) ? n2 : n2.spatialReference), i2 = t2 && (h$1O(t2) ? t2 : t2.spatialReference);
  return !(n2 && "type" in n2 && n2.type === "mesh" || t2 && "type" in t2 && t2.type === "mesh" || !e2 || !i2) && (!!E$P(i2, e2) || (k$D(i2) && G$w(e2) || k$D(e2) && G$w(i2)));
}
function M$L(i2, o2) {
  if (t$2r(i2))
    return null;
  const u2 = i2.spatialReference, l2 = o2 && (h$1O(o2) ? o2 : o2.spatialReference);
  return g$1i(u2, l2) ? E$P(u2, l2) ? y$1L(i2) : k$D(l2) ? x$11(i2, y$1x, k$C.WebMercator, false, y$1L(i2)) : G$w(l2) ? x$11(i2, d$1S, k$C.WGS84, false, y$1L(i2)) : null : null;
}
function y$1x(n2, t2, e2 = [0, 0]) {
  t2 > 89.99999 ? t2 = 89.99999 : t2 < -89.99999 && (t2 = -89.99999);
  const r2 = p$3x(t2);
  return e2[0] = p$3x(n2) * s$2h.radius, e2[1] = s$2h.halfSemiMajorAxis * Math.log((1 + Math.sin(r2)) / (1 - Math.sin(r2))), e2;
}
function d$1S(n2, t2, e2 = [0, 0], r2 = false) {
  const s2 = l$2z(n2 / s$2h.radius);
  return e2[0] = r2 ? s2 : s2 - 360 * Math.floor((s2 + 180) / 360), e2[1] = l$2z(Math.PI / 2 - 2 * Math.atan(Math.exp(-t2 / s$2h.radius))), e2;
}
function R$A(t2, i2 = false, r2 = y$1L(t2)) {
  return x$11(t2, y$1x, k$C.WebMercator, i2, r2);
}
function j$X(t2, i2 = false, r2 = y$1L(t2)) {
  return x$11(t2, d$1S, k$C.WGS84, i2, r2);
}
var m$2o;
const f$1P = [0, 0];
function g$1h(e2) {
  return e2 && (e2.declaredClass === "esri.geometry.SpatialReference" || e2.wkid != null);
}
let x$10 = m$2o = class extends p$3y {
  constructor(...e2) {
    super(...e2), this.x = 0, this.y = 0, this.z = void 0, this.m = void 0, this.type = "point";
  }
  static copy(e2, t2) {
    t2._set("x", e2._get("x")), t2._set("y", e2._get("y")), t2._set("z", e2._get("z")), t2._set("m", e2._get("m"));
    const r2 = e2._get("spatialReference");
    t2._set("spatialReference", Object.isFrozen(r2) ? r2 : r2.clone());
  }
  normalizeCtorArgs(e2, r2, s2, i2, o2) {
    let a2;
    if (Array.isArray(e2))
      a2 = e2, o2 = r2, e2 = a2[0], r2 = a2[1], s2 = a2[2], i2 = a2[3];
    else if (e2 && typeof e2 == "object") {
      if (a2 = e2, e2 = a2.x != null ? a2.x : a2.longitude, r2 = a2.y != null ? a2.y : a2.latitude, s2 = a2.z, i2 = a2.m, (o2 = a2.spatialReference) && o2.declaredClass !== "esri.geometry.SpatialReference" && (o2 = new k$C(o2)), a2.longitude != null || a2.latitude != null) {
        if (a2.longitude == null)
          s$2z.getLogger(this.declaredClass).warn(".longitude=", "Latitude was defined without longitude");
        else if (a2.latitude == null)
          s$2z.getLogger(this.declaredClass).warn(".latitude=", "Longitude was defined without latitude");
        else if (!a2.declaredClass && o2 && o2.isWebMercator) {
          const t2 = y$1x(a2.longitude, a2.latitude, f$1P);
          e2 = t2[0], r2 = t2[1];
        }
      }
    } else
      g$1h(s2) ? (o2 = s2, s2 = null) : g$1h(i2) && (o2 = i2, i2 = null);
    const l2 = { x: e2, y: r2 };
    return l2.x == null && l2.y != null ? s$2z.getLogger(this.declaredClass).warn(".y=", "Y coordinate was defined without an X coordinate") : l2.y == null && l2.x != null && s$2z.getLogger(this.declaredClass).warn(".x=", "X coordinate was defined without a Y coordinate"), o2 != null && (l2.spatialReference = o2), s2 != null && (l2.z = s2), i2 != null && (l2.m = i2), l2;
  }
  get cache() {
    return this.commitProperty("x"), this.commitProperty("y"), this.commitProperty("z"), this.commitProperty("m"), this.commitProperty("spatialReference"), {};
  }
  get hasM() {
    return this.m !== void 0;
  }
  set hasM(e2) {
    e2 !== (this._get("m") !== void 0) && (this._set("m", e2 ? 0 : void 0), this._set("hasM", e2));
  }
  get hasZ() {
    return this.z !== void 0;
  }
  set hasZ(e2) {
    e2 !== (this._get("z") !== void 0) && (this._set("z", e2 ? 0 : void 0), this._set("hasZ", e2));
  }
  get latitude() {
    const { spatialReference: e2, x: t2, y: r2 } = this;
    if (e2) {
      if (e2.isWebMercator)
        return d$1S(t2, r2, f$1P)[1];
      if (e2.isGeographic)
        return r2;
    }
    return null;
  }
  set latitude(e2) {
    const { spatialReference: t2, x: r2 } = this;
    e2 != null && t2 && (t2.isWebMercator ? this._set("y", y$1x(r2, e2, f$1P)[1]) : t2.isGeographic && this._set("y", e2), this._set("latitude", e2));
  }
  get longitude() {
    const { x: e2, y: t2, spatialReference: r2 } = this;
    if (r2) {
      if (r2.isWebMercator)
        return d$1S(e2, t2, f$1P)[0];
      if (r2.isGeographic)
        return e2;
    }
    return null;
  }
  set longitude(e2) {
    const { y: t2, spatialReference: r2 } = this;
    e2 != null && r2 && (r2.isWebMercator ? this._set("x", y$1x(e2, t2, f$1P)[0]) : r2.isGeographic && this._set("x", e2), this._set("longitude", e2));
  }
  writeX(e2, t2, r2) {
    t2[r2] = isNaN(e2) ? "NaN" : e2;
  }
  readX(e2) {
    return typeof e2 == "string" ? NaN : e2;
  }
  clone() {
    const e2 = new m$2o();
    return e2.x = this.x, e2.y = this.y, e2.z = this.z, e2.m = this.m, e2.spatialReference = this.spatialReference, e2;
  }
  copy(e2) {
    return m$2o.copy(e2, this), this;
  }
  equals(e2) {
    if (t$2r(e2))
      return false;
    const { x: t2, y: s2, z: i2, m: o2, spatialReference: a2 } = this, { z: l2, m: n2 } = e2;
    let { x: c2, y: u2, spatialReference: p2 } = e2;
    if (!a2.equals(p2))
      if (a2.isWebMercator && p2.isWGS84)
        [c2, u2] = y$1x(c2, u2), p2 = a2;
      else {
        if (!a2.isWGS84 || !p2.isWebMercator)
          return false;
        [c2, u2] = d$1S(c2, u2), p2 = a2;
      }
    return t2 === c2 && s2 === u2 && i2 === l2 && o2 === n2 && a2.wkid === p2.wkid;
  }
  offset(e2, t2, r2) {
    var _a2;
    return this.x += e2, this.y += t2, r2 != null && (this.z = ((_a2 = this.z) != null ? _a2 : 0) + r2), this;
  }
  normalize() {
    if (!this.spatialReference)
      return this;
    const e2 = R$B(this.spatialReference);
    if (!e2)
      return this;
    let t2 = this.x;
    const [r2, s2] = e2.valid, i2 = 2 * s2;
    let o2;
    return t2 > s2 ? (o2 = Math.ceil(Math.abs(t2 - s2) / i2), t2 -= o2 * i2) : t2 < r2 && (o2 = Math.ceil(Math.abs(t2 - r2) / i2), t2 += o2 * i2), this._set("x", t2), this;
  }
  distance(e2) {
    return t$21(this, e2);
  }
  toArray() {
    const e2 = this.hasZ, t2 = this.hasM;
    return e2 && t2 ? [this.x, this.y, this.z, this.m] : e2 ? [this.x, this.y, this.z] : t2 ? [this.x, this.y, this.m] : [this.x, this.y];
  }
  toJSON(e2) {
    return this.write({}, e2);
  }
};
e$2g([y$1I({ readOnly: true })], x$10.prototype, "cache", null), e$2g([y$1I({ type: Boolean, json: { read: false, write: { enabled: false, overridePolicy: null } } })], x$10.prototype, "hasM", null), e$2g([y$1I({ type: Boolean, json: { read: false, write: { enabled: false, overridePolicy: null } } })], x$10.prototype, "hasZ", null), e$2g([y$1I({ type: Number })], x$10.prototype, "latitude", null), e$2g([y$1I({ type: Number })], x$10.prototype, "longitude", null), e$2g([y$1I({ type: Number, json: { type: [Number, String], write: { isRequired: true, allowNull: true } } }), s$2i((e2) => isNaN(e2) ? e2 : a$2_(e2))], x$10.prototype, "x", void 0), e$2g([r$1P("x")], x$10.prototype, "writeX", null), e$2g([o$29("x")], x$10.prototype, "readX", null), e$2g([y$1I({ type: Number, json: { write: true } })], x$10.prototype, "y", void 0), e$2g([y$1I({ type: Number, json: { write: { overridePolicy() {
  return { enabled: this.hasZ };
} } } })], x$10.prototype, "z", void 0), e$2g([y$1I({ type: Number, json: { write: { overridePolicy() {
  return { enabled: this.hasM };
} } } })], x$10.prototype, "m", void 0), x$10 = m$2o = e$2g([n$2P("esri.geometry.Point")], x$10), x$10.prototype.toJSON.isDefaultToJSON = true;
const w$_ = x$10;
const t$1$ = [0, 0];
function r$1M(t2, r2) {
  return !!r$1$(r2) && f$1O(t2, r2.x, r2.y, r2.z);
}
function i$2Y(n2, t2) {
  if (!t2.points || t2.points.length)
    return false;
  for (const r2 of t2.points)
    if (!u$28(n2, r2))
      return false;
  return true;
}
function o$24(n2, t2) {
  const { xmin: r2, ymin: i2, zmin: o2, xmax: u2, ymax: e2, zmax: c2 } = t2;
  return n2.hasZ && t2.hasZ ? f$1O(n2, r2, i2, o2) && f$1O(n2, r2, e2, o2) && f$1O(n2, u2, e2, o2) && f$1O(n2, u2, i2, o2) && f$1O(n2, r2, i2, c2) && f$1O(n2, r2, e2, c2) && f$1O(n2, u2, e2, c2) && f$1O(n2, u2, i2, c2) : f$1O(n2, r2, i2) && f$1O(n2, r2, e2) && f$1O(n2, u2, e2) && f$1O(n2, u2, i2);
}
function u$28(n2, t2) {
  return f$1O(n2, t2[0], t2[1]);
}
function e$1V(n2, t2) {
  return f$1O(n2, t2[0], t2[1], t2[2]);
}
function f$1O(n2, t2, r2, i2) {
  return t2 >= n2.xmin && t2 <= n2.xmax && r2 >= n2.ymin && r2 <= n2.ymax && (i2 == null || !n2.hasZ || i2 >= n2.zmin && i2 <= n2.zmax);
}
function c$3a(n2, r2) {
  return t$1$[1] = r2.y, t$1$[0] = r2.x, m$2n(n2, t$1$);
}
function m$2n(n2, t2) {
  return s$2g(n2.rings, t2);
}
function s$2g(n2, t2) {
  if (!n2)
    return false;
  if (x$$(n2))
    return a$2Q(false, n2, t2);
  let r2 = false;
  for (let i2 = 0, o2 = n2.length; i2 < o2; i2++)
    r2 = a$2Q(r2, n2[i2], t2);
  return r2;
}
function x$$(n2) {
  return !Array.isArray(n2[0][0]);
}
function a$2Q(n2, t2, r2) {
  const [i2, o2] = r2;
  let u2 = n2, e2 = 0;
  for (let f2 = 0, c2 = t2.length; f2 < c2; f2++) {
    e2++, e2 === c2 && (e2 = 0);
    const [n3, r3] = t2[f2], [m2, s2] = t2[e2];
    (r3 < o2 && s2 >= o2 || s2 < o2 && r3 >= o2) && n3 + (o2 - r3) / (s2 - r3) * (m2 - n3) < i2 && (u2 = !u2);
  }
  return u2;
}
function i$2X(t2, e2) {
  return r$1M(t2, e2);
}
function o$23(n2, t2) {
  const e2 = n2.hasZ && t2.hasZ;
  let r2, i2, o2;
  if (n2.xmin <= t2.xmin) {
    if (r2 = t2.xmin, n2.xmax < r2)
      return false;
  } else if (r2 = n2.xmin, t2.xmax < r2)
    return false;
  if (n2.ymin <= t2.ymin) {
    if (i2 = t2.ymin, n2.ymax < i2)
      return false;
  } else if (i2 = n2.ymin, t2.ymax < i2)
    return false;
  if (e2 && t2.hasZ) {
    if (n2.zmin <= t2.zmin) {
      if (o2 = t2.zmin, n2.zmax < o2)
        return false;
    } else if (o2 = n2.zmin, t2.zmax < o2)
      return false;
  }
  return true;
}
function f$1N(n2, t2) {
  const { points: i2, hasZ: o2 } = t2, f2 = o2 ? e$1V : u$28;
  for (const e2 of i2)
    if (f2(n2, e2))
      return true;
  return false;
}
const s$2f = [0, 0], u$27 = [0, 0], c$39 = [0, 0], m$2m = [0, 0], l$2y = [s$2f, u$27, c$39, m$2m], a$2P = [[c$39, s$2f], [s$2f, u$27], [u$27, m$2m], [m$2m, c$39]];
function x$_(n2, t2) {
  return y$1w(n2, t2.rings);
}
function y$1w(n2, r2) {
  s$2f[0] = n2.xmin, s$2f[1] = n2.ymax, u$27[0] = n2.xmax, u$27[1] = n2.ymax, c$39[0] = n2.xmin, c$39[1] = n2.ymin, m$2m[0] = n2.xmax, m$2m[1] = n2.ymin;
  for (const e2 of l$2y)
    if (s$2g(r2, e2))
      return true;
  for (const t2 of r2) {
    if (!t2.length)
      continue;
    let r3 = t2[0];
    if (u$28(n2, r3))
      return true;
    for (let i2 = 1; i2 < t2.length; i2++) {
      const o2 = t2[i2];
      if (u$28(n2, o2) || z$J(r3, o2, a$2P))
        return true;
      r3 = o2;
    }
  }
  return false;
}
function h$1N(n2, t2) {
  s$2f[0] = n2.xmin, s$2f[1] = n2.ymax, u$27[0] = n2.xmax, u$27[1] = n2.ymax, c$39[0] = n2.xmin, c$39[1] = n2.ymin, m$2m[0] = n2.xmax, m$2m[1] = n2.ymin;
  const r2 = t2.paths;
  for (const i2 of r2) {
    if (!r2.length)
      continue;
    let t3 = i2[0];
    if (u$28(n2, t3))
      return true;
    for (let r3 = 1; r3 < i2.length; r3++) {
      const o2 = i2[r3];
      if (u$28(n2, o2) || z$J(t3, o2, a$2P))
        return true;
      t3 = o2;
    }
  }
  return false;
}
const g$1g = [0, 0];
function p$3w(n2) {
  for (let t2 = 0; t2 < n2.length; t2++) {
    const e2 = n2[t2];
    for (let i2 = 0; i2 < e2.length - 1; i2++) {
      const r3 = e2[i2], o2 = e2[i2 + 1];
      for (let e3 = t2 + 1; e3 < n2.length; e3++)
        for (let t3 = 0; t3 < n2[e3].length - 1; t3++) {
          const i3 = n2[e3][t3], f2 = n2[e3][t3 + 1];
          if (G$v(r3, o2, i3, f2, g$1g) && !(g$1g[0] === r3[0] && g$1g[1] === r3[1] || g$1g[0] === i3[0] && g$1g[1] === i3[1] || g$1g[0] === o2[0] && g$1g[1] === o2[1] || g$1g[0] === f2[0] && g$1g[1] === f2[1]))
            return true;
        }
    }
    const r2 = e2.length;
    if (!(r2 <= 4))
      for (let n3 = 0; n3 < r2 - 3; n3++) {
        let t3 = r2 - 1;
        n3 === 0 && (t3 = r2 - 2);
        const i2 = e2[n3], o2 = e2[n3 + 1];
        for (let r3 = n3 + 2; r3 < t3; r3++) {
          const n4 = e2[r3], t4 = e2[r3 + 1];
          if (G$v(i2, o2, n4, t4, g$1g) && !(g$1g[0] === i2[0] && g$1g[1] === i2[1] || g$1g[0] === n4[0] && g$1g[1] === n4[1] || g$1g[0] === o2[0] && g$1g[1] === o2[1] || g$1g[0] === t4[0] && g$1g[1] === t4[1]))
            return true;
        }
      }
  }
  return false;
}
function z$J(n2, t2, e2) {
  for (let r2 = 0; r2 < e2.length; r2++)
    if (G$v(n2, t2, e2[r2][0], e2[r2][1]))
      return true;
  return false;
}
function G$v(n2, t2, e2, r2, i2) {
  const [o2, f2] = n2, [s2, u2] = t2, [c2, m2] = e2, [l2, a2] = r2, x2 = l2 - c2, y2 = o2 - c2, h2 = s2 - o2, g2 = a2 - m2, p2 = f2 - m2, z2 = u2 - f2, G2 = g2 * h2 - x2 * z2;
  if (G2 === 0)
    return false;
  const Z2 = (x2 * p2 - g2 * y2) / G2, P2 = (h2 * p2 - z2 * y2) / G2;
  return Z2 >= 0 && Z2 <= 1 && P2 >= 0 && P2 <= 1 && (i2 && (i2[0] = o2 + Z2 * (s2 - o2), i2[1] = f2 + Z2 * (u2 - f2)), true);
}
function Z$j(n2) {
  switch (n2) {
    case "esriGeometryEnvelope":
    case "extent":
      return o$23;
    case "esriGeometryMultipoint":
    case "multipoint":
      return f$1N;
    case "esriGeometryPoint":
    case "point":
      return i$2X;
    case "esriGeometryPolygon":
    case "polygon":
      return x$_;
    case "esriGeometryPolyline":
    case "polyline":
      return h$1N;
  }
}
var f$1M;
function d$1R(t2) {
  return t2 && (t2.declaredClass === "esri.geometry.SpatialReference" || t2.wkid != null);
}
function z$I(t2, i2, e2) {
  return i2 == null ? e2 : e2 == null ? i2 : t2(i2, e2);
}
let M$K = f$1M = class extends p$3y {
  constructor(...t2) {
    super(...t2), this.type = "extent", this.xmin = 0, this.ymin = 0, this.mmin = void 0, this.zmin = void 0, this.xmax = 0, this.ymax = 0, this.mmax = void 0, this.zmax = void 0;
  }
  normalizeCtorArgs(t2, i2, e2, s2, n2) {
    return d$1R(t2) ? { spatialReference: t2, xmin: 0, ymin: 0, xmax: 0, ymax: 0 } : typeof t2 == "object" ? (t2.spatialReference = t2.spatialReference == null ? k$C.WGS84 : t2.spatialReference, t2) : { xmin: t2, ymin: i2, xmax: e2, ymax: s2, spatialReference: n2 != null ? n2 : k$C.WGS84 };
  }
  static fromBounds(t2, i2) {
    return new f$1M({ xmin: t2[0], ymin: t2[1], xmax: t2[2], ymax: t2[3], spatialReference: i2 });
  }
  static fromPoint(t2) {
    return new f$1M({ xmin: t2.x, ymin: t2.y, zmin: t2.z, xmax: t2.x, ymax: t2.y, zmax: t2.z, spatialReference: t2.spatialReference });
  }
  get cache() {
    return this.commitProperty("xmin"), this.commitProperty("ymin"), this.commitProperty("zmin"), this.commitProperty("mmin"), this.commitProperty("xmax"), this.commitProperty("ymax"), this.commitProperty("zmax"), this.commitProperty("mmax"), this.commitProperty("spatialReference"), {};
  }
  get center() {
    const t2 = new w$_({ x: 0.5 * (this.xmin + this.xmax), y: 0.5 * (this.ymin + this.ymax), spatialReference: this.spatialReference });
    return this.hasZ && (t2.z = 0.5 * (this.zmin + this.zmax)), this.hasM && (t2.m = 0.5 * (this.mmin + this.mmax)), t2;
  }
  get extent() {
    return this.clone();
  }
  get hasM() {
    return this.mmin != null && this.mmax != null;
  }
  get hasZ() {
    return this.zmin != null && this.zmax != null;
  }
  get height() {
    return Math.abs(this.ymax - this.ymin);
  }
  get width() {
    return Math.abs(this.xmax - this.xmin);
  }
  centerAt(t2) {
    const i2 = this.center;
    return t2.z != null && this.hasZ ? this.offset(t2.x - i2.x, t2.y - i2.y, t2.z - i2.z) : this.offset(t2.x - i2.x, t2.y - i2.y);
  }
  clone() {
    const t2 = new f$1M();
    return t2.xmin = this.xmin, t2.ymin = this.ymin, t2.xmax = this.xmax, t2.ymax = this.ymax, t2.spatialReference = this.spatialReference, this.zmin != null && (t2.zmin = this.zmin, t2.zmax = this.zmax), this.mmin != null && (t2.mmin = this.mmin, t2.mmax = this.mmax), t2;
  }
  contains(t2) {
    if (!t2)
      return false;
    const i2 = this.spatialReference, e2 = t2.spatialReference;
    return i2 && e2 && !i2.equals(e2) && g$1i(i2, e2) && (t2 = i2.isWebMercator ? R$A(t2) : j$X(t2, true)), t2.type === "point" ? r$1M(this, t2) : t2.type === "extent" && o$24(this, t2);
  }
  equals(t2) {
    if (this === t2)
      return true;
    if (t$2r(t2))
      return false;
    const e2 = this.spatialReference, s2 = t2.spatialReference;
    return e2 && s2 && !e2.equals(s2) && g$1i(e2, s2) && (t2 = e2.isWebMercator ? R$A(t2) : j$X(t2, true)), this.xmin === t2.xmin && this.ymin === t2.ymin && this.zmin === t2.zmin && this.mmin === t2.mmin && this.xmax === t2.xmax && this.ymax === t2.ymax && this.zmax === t2.zmax && this.mmax === t2.mmax;
  }
  expand(t2) {
    const i2 = 0.5 * (1 - t2), e2 = this.width * i2, s2 = this.height * i2;
    if (this.xmin += e2, this.ymin += s2, this.xmax -= e2, this.ymax -= s2, this.hasZ) {
      const t3 = (this.zmax - this.zmin) * i2;
      this.zmin += t3, this.zmax -= t3;
    }
    if (this.hasM) {
      const t3 = (this.mmax - this.mmin) * i2;
      this.mmin += t3, this.mmax -= t3;
    }
    return this;
  }
  intersects(t2) {
    if (t$2r(t2))
      return false;
    t2.type === "mesh" && (t2 = t2.extent);
    const e2 = this.spatialReference, s2 = t2.spatialReference;
    e2 && s2 && !E$P(e2, s2) && g$1i(e2, s2) && (t2 = e2.isWebMercator ? R$A(t2) : j$X(t2, true));
    return Z$j(t2.type)(this, t2);
  }
  normalize() {
    const t2 = this._normalize(false, true);
    return Array.isArray(t2) ? t2 : [t2];
  }
  offset(t2, i2, e2) {
    return this.xmin += t2, this.ymin += i2, this.xmax += t2, this.ymax += i2, e2 != null && (this.zmin += e2, this.zmax += e2), this;
  }
  shiftCentralMeridian() {
    return this._normalize(true);
  }
  union(t2) {
    return this === t2 || (this.xmin = Math.min(this.xmin, t2.xmin), this.ymin = Math.min(this.ymin, t2.ymin), this.xmax = Math.max(this.xmax, t2.xmax), this.ymax = Math.max(this.ymax, t2.ymax), (this.hasZ || t2.hasZ) && (this.zmin = z$I(Math.min, this.zmin, t2.zmin), this.zmax = z$I(Math.max, this.zmax, t2.zmax)), (this.hasM || t2.hasM) && (this.mmin = z$I(Math.min, this.mmin, t2.mmin), this.mmax = z$I(Math.max, this.mmax, t2.mmax))), this;
  }
  intersection(t2) {
    return this === t2 ? this : t$2r(t2) || !this.intersects(t2) ? null : (this.xmin = Math.max(this.xmin, t2.xmin), this.ymin = Math.max(this.ymin, t2.ymin), this.xmax = Math.min(this.xmax, t2.xmax), this.ymax = Math.min(this.ymax, t2.ymax), (this.hasZ || t2.hasZ) && (this.zmin = z$I(Math.max, this.zmin, t2.zmin), this.zmax = z$I(Math.min, this.zmax, t2.zmax)), (this.hasM || t2.hasM) && (this.mmin = z$I(Math.max, this.mmin, t2.mmin), this.mmax = z$I(Math.min, this.mmax, t2.mmax)), this);
  }
  toJSON(t2) {
    return this.write({}, t2);
  }
  _shiftCM(t2 = R$B(this.spatialReference)) {
    var _a2;
    if (!t2 || !this.spatialReference)
      return this;
    const i2 = this.spatialReference, s2 = this._getCM(t2);
    if (s2) {
      const n2 = i2.isWebMercator ? j$X(s2) : s2;
      this.xmin -= s2.x, this.xmax -= s2.x, i2.isWebMercator || (n2.x = this._normalizeX(n2.x, t2).x), this.spatialReference = new k$C(n$2W((_a2 = i2.isWGS84 ? t2.altTemplate : null) != null ? _a2 : t2.wkTemplate, { Central_Meridian: n2.x }));
    }
    return this;
  }
  _getCM(t2) {
    let i2 = null;
    const [e2, s2] = t2.valid, n2 = this.xmin, m2 = this.xmax;
    return n2 >= e2 && n2 <= s2 && (m2 >= e2 && m2 <= s2) || (i2 = this.center), i2;
  }
  _normalize(t2, i2, e2) {
    const s2 = this.spatialReference;
    if (!s2)
      return this;
    const n2 = e2 != null ? e2 : R$B(s2);
    if (n2 == null)
      return this;
    const m2 = this._getParts(n2).map((t3) => t3.extent);
    if (m2.length < 2)
      return m2[0] || this;
    if (m2.length > 2)
      return t2 ? this._shiftCM(n2) : this.set({ xmin: n2.valid[0], xmax: n2.valid[1] });
    if (t2)
      return this._shiftCM(n2);
    if (i2)
      return m2;
    let r2 = true, a2 = true;
    return m2.forEach((t3) => {
      t3.hasZ || (r2 = false), t3.hasM || (a2 = false);
    }), { rings: m2.map((t3) => {
      const i3 = [[t3.xmin, t3.ymin], [t3.xmin, t3.ymax], [t3.xmax, t3.ymax], [t3.xmax, t3.ymin], [t3.xmin, t3.ymin]];
      if (r2) {
        const e3 = (t3.zmax - t3.zmin) / 2;
        for (let t4 = 0; t4 < i3.length; t4++)
          i3[t4].push(e3);
      }
      if (a2) {
        const e3 = (t3.mmax - t3.mmin) / 2;
        for (let t4 = 0; t4 < i3.length; t4++)
          i3[t4].push(e3);
      }
      return i3;
    }), hasZ: r2, hasM: a2, spatialReference: s2 };
  }
  _getParts(t2) {
    let i2 = this.cache._parts;
    if (!i2) {
      i2 = [];
      const { ymin: e3, ymax: s3, spatialReference: n2 } = this, m2 = this.width, r2 = this.xmin, a2 = this.xmax;
      let h2;
      t2 = t2 || R$B(n2);
      const [o2, x2] = t2.valid;
      h2 = this._normalizeX(this.xmin, t2);
      const l2 = h2.x, c2 = h2.frameId;
      h2 = this._normalizeX(this.xmax, t2);
      const y2 = h2.x, u2 = h2.frameId, d2 = l2 === y2 && m2 > 0;
      if (m2 > 2 * x2) {
        const t3 = new f$1M(r2 < a2 ? l2 : y2, e3, x2, s3, n2), m3 = new f$1M(o2, e3, r2 < a2 ? y2 : l2, s3, n2), h3 = new f$1M(0, e3, x2, s3, n2), p2 = new f$1M(o2, e3, 0, s3, n2), d3 = [], z2 = [];
        t3.contains(h3) && d3.push(c2), t3.contains(p2) && z2.push(c2), m3.contains(h3) && d3.push(u2), m3.contains(p2) && z2.push(u2);
        for (let i3 = c2 + 1; i3 < u2; i3++)
          d3.push(i3), z2.push(i3);
        i2.push({ extent: t3, frameIds: [c2] }, { extent: m3, frameIds: [u2] }, { extent: h3, frameIds: d3 }, { extent: p2, frameIds: z2 });
      } else
        l2 > y2 || d2 ? i2.push({ extent: new f$1M(l2, e3, x2, s3, n2), frameIds: [c2] }, { extent: new f$1M(o2, e3, y2, s3, n2), frameIds: [u2] }) : i2.push({ extent: new f$1M(l2, e3, y2, s3, n2), frameIds: [c2] });
      this.cache._parts = i2;
    }
    const e2 = this.hasZ, s2 = this.hasM;
    if (e2 || s2) {
      const t3 = {};
      e2 && (t3.zmin = this.zmin, t3.zmax = this.zmax), s2 && (t3.mmin = this.mmin, t3.mmax = this.mmax);
      for (let e3 = 0; e3 < i2.length; e3++)
        i2[e3].extent.set(t3);
    }
    return i2;
  }
  _normalizeX(t2, i2) {
    const [e2, s2] = i2.valid, n2 = 2 * s2;
    let m2, r2 = 0;
    return t2 > s2 ? (m2 = Math.ceil(Math.abs(t2 - s2) / n2), t2 -= m2 * n2, r2 = m2) : t2 < e2 && (m2 = Math.ceil(Math.abs(t2 - e2) / n2), t2 += m2 * n2, r2 = -m2), { x: t2, frameId: r2 };
  }
};
e$2g([y$1I({ readOnly: true })], M$K.prototype, "cache", null), e$2g([y$1I({ readOnly: true })], M$K.prototype, "center", null), e$2g([y$1I({ readOnly: true })], M$K.prototype, "extent", null), e$2g([y$1I({ readOnly: true, json: { write: { enabled: false, overridePolicy: null } } })], M$K.prototype, "hasM", null), e$2g([y$1I({ readOnly: true, json: { write: { enabled: false, overridePolicy: null } } })], M$K.prototype, "hasZ", null), e$2g([y$1I({ readOnly: true })], M$K.prototype, "height", null), e$2g([y$1I({ readOnly: true })], M$K.prototype, "width", null), e$2g([y$1I({ type: Number, json: { type: [Number, String], write: { enabled: true, allowNull: true } } })], M$K.prototype, "xmin", void 0), e$2g([y$1I({ type: Number, json: { write: true } })], M$K.prototype, "ymin", void 0), e$2g([y$1I({ type: Number, json: { origins: { "web-scene": { write: false } }, write: { overridePolicy() {
  return { enabled: this.hasM };
} } } })], M$K.prototype, "mmin", void 0), e$2g([y$1I({ type: Number, json: { origins: { "web-scene": { write: false } }, write: { overridePolicy() {
  return { enabled: this.hasZ };
} } } })], M$K.prototype, "zmin", void 0), e$2g([y$1I({ type: Number, json: { write: true } })], M$K.prototype, "xmax", void 0), e$2g([y$1I({ type: Number, json: { write: true } })], M$K.prototype, "ymax", void 0), e$2g([y$1I({ type: Number, json: { origins: { "web-scene": { write: false } }, write: { overridePolicy() {
  return { enabled: this.hasM };
} } } })], M$K.prototype, "mmax", void 0), e$2g([y$1I({ type: Number, json: { origins: { "web-scene": { write: false } }, write: { overridePolicy() {
  return { enabled: this.hasZ };
} } } })], M$K.prototype, "zmax", void 0), M$K = f$1M = e$2g([n$2P("esri.geometry.Extent")], M$K), M$K.prototype.toJSON.isDefaultToJSON = true;
const w$Z = M$K;
function h$1M(h2, a2, s2 = false) {
  let { hasM: t2, hasZ: e2 } = h2;
  Array.isArray(a2) ? a2.length !== 4 || t2 || e2 ? a2.length === 3 && s2 && !t2 ? (e2 = true, t2 = false) : a2.length === 3 && t2 && e2 && (t2 = false, e2 = false) : (t2 = true, e2 = true) : (e2 = !e2 && a2.hasZ && (!t2 || a2.hasM), t2 = !t2 && a2.hasM && (!e2 || a2.hasZ)), h2.hasZ = e2, h2.hasM = t2;
}
var h$1L;
function l$2x(t2) {
  return (s2, e2) => s2 == null ? e2 : e2 == null ? s2 : t2(s2, e2);
}
function c$38(t2) {
  return t2 && (t2.declaredClass === "esri.geometry.SpatialReference" || t2.wkid != null);
}
let m$2l = h$1L = class extends p$3y {
  constructor(...t2) {
    super(...t2), this.points = [], this.type = "multipoint";
  }
  normalizeCtorArgs(t2, s2) {
    if (!t2 && !s2)
      return {};
    const e2 = {};
    Array.isArray(t2) ? (e2.points = t2, e2.spatialReference = s2) : c$38(t2) ? e2.spatialReference = t2 : (t2.points && (e2.points = t2.points), t2.spatialReference && (e2.spatialReference = t2.spatialReference), t2.hasZ && (e2.hasZ = t2.hasZ), t2.hasM && (e2.hasM = t2.hasM));
    const i2 = e2.points && e2.points[0];
    return i2 && (e2.hasZ === void 0 && e2.hasM === void 0 ? (e2.hasZ = i2.length > 2, e2.hasM = false) : e2.hasZ === void 0 ? e2.hasZ = i2.length > 3 : e2.hasM === void 0 && (e2.hasM = i2.length > 3)), e2;
  }
  get cache() {
    return this.commitProperty("points"), this.commitProperty("hasZ"), this.commitProperty("hasM"), this.commitProperty("spatialReference"), {};
  }
  get extent() {
    const t2 = this.points;
    if (!t2.length)
      return null;
    const s2 = new w$Z(), e2 = this.hasZ, i2 = this.hasM, r2 = e2 ? 3 : 2, n2 = t2[0], a2 = l$2x(Math.min), p2 = l$2x(Math.max);
    let h2, c2, m2, u2, [f2, y2] = n2, [d2, g2] = n2;
    for (let o2 = 0, l2 = t2.length; o2 < l2; o2++) {
      const s3 = t2[o2], [n3, l3] = s3;
      if (f2 = a2(f2, n3), y2 = a2(y2, l3), d2 = p2(d2, n3), g2 = p2(g2, l3), e2 && s3.length > 2) {
        const t3 = s3[2];
        h2 = a2(h2, t3), m2 = p2(m2, t3);
      }
      if (i2 && s3.length > r2) {
        const t3 = s3[r2];
        c2 = a2(c2, t3), u2 = p2(u2, t3);
      }
    }
    return s2.xmin = f2, s2.ymin = y2, s2.xmax = d2, s2.ymax = g2, s2.spatialReference = this.spatialReference, e2 ? (s2.zmin = h2, s2.zmax = m2) : (s2.zmin = void 0, s2.zmax = void 0), i2 ? (s2.mmin = c2, s2.mmax = u2) : (s2.mmin = void 0, s2.mmax = void 0), s2;
  }
  writePoints(t2, e2) {
    e2.points = y$1L(this.points);
  }
  addPoint(t2) {
    return h$1M(this, t2), Array.isArray(t2) ? this.points.push(t2) : this.points.push(t2.toArray()), this.notifyChange("points"), this;
  }
  clone() {
    const t2 = { points: y$1L(this.points), spatialReference: this.spatialReference };
    return this.hasZ && (t2.hasZ = true), this.hasM && (t2.hasM = true), new h$1L(t2);
  }
  getPoint(t2) {
    if (!this._validateInputs(t2))
      return null;
    const s2 = this.points[t2], e2 = { x: s2[0], y: s2[1], spatialReference: this.spatialReference };
    let i2 = 2;
    return this.hasZ && (e2.z = s2[2], i2 = 3), this.hasM && (e2.m = s2[i2]), new w$_(e2);
  }
  removePoint(t2) {
    if (!this._validateInputs(t2))
      return null;
    const s2 = new w$_(this.points.splice(t2, 1)[0], this.spatialReference);
    return this.notifyChange("points"), s2;
  }
  setPoint(t2, s2) {
    return this._validateInputs(t2) ? (h$1M(this, s2), Array.isArray(s2) || (s2 = s2.toArray()), this.points[t2] = s2, this.notifyChange("points"), this) : this;
  }
  toJSON(t2) {
    return this.write({}, t2);
  }
  _validateInputs(t2) {
    return t2 != null && t2 >= 0 && t2 < this.points.length;
  }
};
e$2g([y$1I({ readOnly: true })], m$2l.prototype, "cache", null), e$2g([y$1I()], m$2l.prototype, "extent", null), e$2g([y$1I({ type: [[Number]], json: { write: { isRequired: true } } })], m$2l.prototype, "points", void 0), e$2g([r$1P("points")], m$2l.prototype, "writePoints", null), m$2l = h$1L = e$2g([n$2P("esri.geometry.Multipoint")], m$2l), m$2l.prototype.toJSON.isDefaultToJSON = true;
const u$26 = m$2l;
function r$1L(n2) {
  if (!n2)
    return null;
  if (Array.isArray(n2))
    return n2;
  const t2 = n2.hasZ, r2 = n2.hasM;
  if (n2.type === "point")
    return r2 && t2 ? [n2.x, n2.y, n2.z, n2.m] : t2 ? [n2.x, n2.y, n2.z] : r2 ? [n2.x, n2.y, n2.m] : [n2.x, n2.y];
  if (n2.type === "polygon")
    return n2.rings.slice(0);
  if (n2.type === "polyline")
    return n2.paths.slice(0);
  if (n2.type === "multipoint")
    return n2.points.slice(0);
  if (n2.type === "extent") {
    const t3 = n2.clone().normalize();
    if (!t3)
      return null;
    let r3 = false, e2 = false;
    return t3.forEach((n3) => {
      n3.hasZ && (r3 = true), n3.hasM && (e2 = true);
    }), t3.map((n3) => {
      const t4 = [[n3.xmin, n3.ymin], [n3.xmin, n3.ymax], [n3.xmax, n3.ymax], [n3.xmax, n3.ymin], [n3.xmin, n3.ymin]];
      if (r3 && n3.hasZ) {
        const r4 = 0.5 * (n3.zmax - n3.zmin);
        for (let n4 = 0; n4 < t4.length; n4++)
          t4[n4].push(r4);
      }
      if (e2 && n3.hasM) {
        const r4 = 0.5 * (n3.mmax - n3.mmin);
        for (let n4 = 0; n4 < t4.length; n4++)
          t4[n4].push(r4);
      }
      return t4;
    });
  }
  return null;
}
function e$1U(n2, t2) {
  const r2 = t2[0] - n2[0], e2 = t2[1] - n2[1];
  if (n2.length > 2 && t2.length > 2) {
    const o2 = n2[2] - t2[2];
    return Math.sqrt(r2 * r2 + e2 * e2 + o2 * o2);
  }
  return Math.sqrt(r2 * r2 + e2 * e2);
}
function o$22(n2, t2, r2) {
  const e2 = n2[0] + r2 * (t2[0] - n2[0]), o2 = n2[1] + r2 * (t2[1] - n2[1]);
  return n2.length > 2 && t2.length > 2 ? [e2, o2, n2[2] + r2 * (t2[2] - n2[2])] : [e2, o2];
}
function i$2W(n2, t2, r2, e2) {
  const [o2, i2] = t2, [s2, l2] = r2[e2], [f2, c2] = r2[e2 + 1], u2 = f2 - s2, h2 = c2 - l2, a2 = u2 * u2 + h2 * h2, g2 = (o2 - s2) * u2 + (i2 - l2) * h2, m2 = Math.min(1, Math.max(0, g2 / a2));
  return n2[0] = s2 + u2 * m2, n2[1] = l2 + h2 * m2, n2;
}
function s$2e(n2, t2, r2) {
  const e2 = r2.rings;
  let o2, i2, s2 = false, f2 = 1 / 0;
  for (let c2 = 0; c2 < e2.length; c2++) {
    const r3 = e2[c2];
    for (let e3 = 0, c3 = r3.length - 1; e3 < r3.length; c3 = e3++)
      o2 = r3[e3], i2 = r3[c3], o2[1] > t2 != i2[1] > t2 && n2 < (i2[0] - o2[0]) * (t2 - o2[1]) / (i2[1] - o2[1]) + o2[0] && (s2 = !s2), f2 = Math.min(f2, l$2w(n2, t2, o2, i2));
  }
  return f2 === 0 ? 0 : (s2 ? 1 : -1) * Math.sqrt(f2);
}
function l$2w(n2, t2, r2, e2) {
  let o2 = r2[0], i2 = r2[1], s2 = e2[0] - o2, l2 = e2[1] - i2;
  if (s2 !== 0 || l2 !== 0) {
    const r3 = ((n2 - o2) * s2 + (t2 - i2) * l2) / (s2 * s2 + l2 * l2);
    r3 > 1 ? (o2 = e2[0], i2 = e2[1]) : r3 > 0 && (o2 += s2 * r3, i2 += l2 * r3);
  }
  return s2 = n2 - o2, l2 = t2 - i2, s2 * s2 + l2 * l2;
}
function f$1L(n2, t2) {
  return o$22(n2, t2, 0.5);
}
function c$37(n2) {
  const t2 = n2.length;
  let r2 = 0;
  for (let o2 = 0; o2 < t2 - 1; ++o2)
    r2 += e$1U(n2[o2], n2[o2 + 1]);
  return r2;
}
function u$25(n2, t2) {
  if (t2 <= 0)
    return n2[0];
  const r2 = n2.length;
  let i2 = 0;
  for (let s2 = 0; s2 < r2 - 1; ++s2) {
    const r3 = e$1U(n2[s2], n2[s2 + 1]);
    if (t2 - i2 < r3) {
      const e2 = (t2 - i2) / r3;
      return o$22(n2[s2], n2[s2 + 1], e2);
    }
    i2 += r3;
  }
  return n2[r2 - 1];
}
function h$1K(n2, t2, r2) {
  const e2 = n2.length;
  let o2 = 0, i2 = 0, s2 = 0;
  for (let l2 = 0; l2 < e2; l2++) {
    const f2 = n2[l2], c2 = n2[(l2 + 1) % e2];
    let u2 = 2;
    o2 += f2[0] * c2[1] - c2[0] * f2[1], f2.length > 2 && c2.length > 2 && r2 && (i2 += f2[0] * c2[2] - c2[0] * f2[2], u2 = 3), f2.length > u2 && c2.length > u2 && t2 && (s2 += f2[0] * c2[u2] - c2[0] * f2[u2]);
  }
  return o2 <= 0 && i2 <= 0 && s2 <= 0;
}
function a$2O(t2) {
  const r2 = t2.length;
  return r2 > 2 && i$3e(t2[0], t2[r2 - 1]);
}
function g$1f(n2) {
  var _a2, _b2;
  if ("rings" in n2 && (m$2k(n2), n2.rings.length > 0 && !h$1K(n2.rings[0], (_a2 = n2.hasM) != null ? _a2 : false, (_b2 = n2.hasZ) != null ? _b2 : false)))
    for (const t2 of n2.rings)
      t2.reverse();
}
function m$2k(n2) {
  if ("rings" in n2)
    for (const t2 of n2.rings)
      a$2O(t2) || t2.push(t2[0].slice());
}
function p$3v(n2) {
  if (n2.type !== "polygon" && n2.type !== "polyline")
    return n2;
  return y$1v(n2.type === "polygon" ? n2.rings : n2.paths, n2.spatialReference), n2;
}
function y$1v(n2, r2) {
  const e2 = R$B(r2);
  if (!e2)
    return;
  const o2 = e2.valid[0], i2 = e2.valid[1], s2 = i2 - o2;
  for (const t2 of n2) {
    let n3 = 1 / 0, r3 = -1 / 0;
    for (const s3 of t2) {
      const t3 = x$Z(s3[0], o2, i2);
      n3 = Math.min(n3, t3), r3 = Math.max(r3, t3), s3[0] = t3;
    }
    const e3 = r3 - n3;
    s2 - e3 < e3 && t2.forEach((n4) => {
      n4[0] < 0 && (n4[0] += s2);
    });
  }
}
function x$Z(n2, t2, r2) {
  const e2 = r2 - t2;
  return n2 < t2 ? r2 - (t2 - n2) % e2 : n2 > r2 ? t2 + (n2 - t2) % e2 : n2;
}
function M$J(n2) {
  if (!n2 || n2.length < 3)
    return 0;
  let t2 = 0;
  const r2 = n2.length - 1;
  for (let e2 = 0; e2 < r2; e2++)
    t2 += (n2[e2][0] - n2[e2 + 1][0]) * (n2[e2][1] + n2[e2 + 1][1]);
  return t2 += (n2[r2][0] - n2[0][0]) * (n2[r2][1] + n2[0][1]), -0.5 * t2;
}
function e$1T(n2) {
  return n2 ? n2.hasZ ? [n2.xmax - n2.xmin / 2, n2.ymax - n2.ymin / 2, n2.zmax - n2.zmin / 2] : [n2.xmax - n2.xmin / 2, n2.ymax - n2.ymin / 2] : null;
}
function r$1K(n2) {
  var _a2;
  return n2 ? o$21(n2.rings, (_a2 = n2.hasZ) != null ? _a2 : false) : null;
}
function o$21(n2, t2) {
  if (!n2 || !n2.length)
    return null;
  const l2 = [], e2 = [], r2 = t2 ? [1 / 0, -1 / 0, 1 / 0, -1 / 0, 1 / 0, -1 / 0] : [1 / 0, -1 / 0, 1 / 0, -1 / 0];
  for (let o2 = 0, i2 = n2.length; o2 < i2; o2++) {
    const l3 = u$24(n2[o2], t2, r2);
    l3 && e2.push(l3);
  }
  if (e2.sort((n3, l3) => {
    let e3 = n3[2] - l3[2];
    return e3 === 0 && t2 && (e3 = n3[4] - l3[4]), e3;
  }), e2.length && (l2[0] = e2[0][0], l2[1] = e2[0][1], t2 && (l2[2] = e2[0][3]), (l2[0] < r2[0] || l2[0] > r2[1] || l2[1] < r2[2] || l2[1] > r2[3] || t2 && (l2[2] < r2[4] || l2[2] > r2[5])) && (l2.length = 0)), !l2.length) {
    const e3 = n2[0] && n2[0].length ? i$2V(n2[0], t2) : null;
    if (!e3)
      return null;
    l2[0] = e3[0], l2[1] = e3[1], t2 && e3.length > 2 && (l2[2] = e3[2]);
  }
  return l2;
}
function u$24(n2, t2, l2) {
  let e2 = 0, r2 = 0, o2 = 0, u2 = 0, i2 = 0;
  const s2 = n2.length ? n2[0][0] : 0, g2 = n2.length ? n2[0][1] : 0, h2 = n2.length && t2 ? n2[0][2] : 0;
  for (let f2 = 0; f2 < n2.length; f2++) {
    const c3 = n2[f2], m2 = n2[(f2 + 1) % n2.length], [x2, a2, y2] = c3, p2 = x2 - s2, z2 = a2 - g2, [Z2, d2, j2] = m2, U2 = Z2 - s2, b2 = d2 - g2, k2 = p2 * b2 - U2 * z2;
    if (u2 += k2, e2 += (p2 + U2) * k2, r2 += (z2 + b2) * k2, t2 && c3.length > 2 && m2.length > 2) {
      const n3 = y2 - h2, t3 = j2 - h2, l3 = p2 * t3 - U2 * n3;
      o2 += (n3 + t3) * l3, i2 += l3;
    }
    x2 < l2[0] && (l2[0] = x2), x2 > l2[1] && (l2[1] = x2), a2 < l2[2] && (l2[2] = a2), a2 > l2[3] && (l2[3] = a2), t2 && (y2 < l2[4] && (l2[4] = y2), y2 > l2[5] && (l2[5] = y2));
  }
  if (u2 > 0 && (u2 *= -1), i2 > 0 && (i2 *= -1), !u2)
    return null;
  u2 *= 0.5, i2 *= 0.5;
  const c2 = [e2 / (6 * u2) + s2, r2 / (6 * u2) + g2, u2];
  return t2 && (l2[4] === l2[5] || i2 === 0 ? (c2[3] = (l2[4] + l2[5]) / 2, c2[4] = 0) : (c2[3] = o2 / (6 * i2) + h2, c2[4] = i2)), c2;
}
function i$2V(l2, e2) {
  const r2 = e2 ? [0, 0, 0] : [0, 0], o2 = e2 ? [0, 0, 0] : [0, 0];
  let u2 = 0, i2 = 0, s2 = 0, g2 = 0;
  for (let h2 = 0, c2 = l2.length; h2 < c2 - 1; h2++) {
    const c3 = l2[h2], f2 = l2[h2 + 1];
    if (c3 && f2) {
      r2[0] = c3[0], r2[1] = c3[1], o2[0] = f2[0], o2[1] = f2[1], e2 && c3.length > 2 && f2.length > 2 && (r2[2] = c3[2], o2[2] = f2[2]);
      const l3 = e$1U(r2, o2);
      if (l3) {
        u2 += l3;
        const n2 = f$1L(c3, f2);
        i2 += l3 * n2[0], s2 += l3 * n2[1], e2 && n2.length > 2 && (g2 += l3 * n2[2]);
      }
    }
  }
  return u2 > 0 ? e2 ? [i2 / u2, s2 / u2, g2 / u2] : [i2 / u2, s2 / u2] : l2.length ? l2[0] : null;
}
const s$2d = 1e-6;
function g$1e(n2) {
  if (!n2 || !n2.rings)
    return null;
  const { rings: t2 } = n2;
  let e2 = 0;
  for (let o2 = 0; o2 < t2.length; o2++)
    e2 += M$J(t2[o2]);
  if (e2 < s$2d)
    return o$21(t2, false);
  const r2 = [0, 0], u2 = t2[0][0];
  for (let l2 = 0; l2 < t2.length; l2++)
    c$36(r2, u2, t2[l2]);
  return r2[0] *= 1 / e2, r2[1] *= 1 / e2, r2[0] += u2[0], r2[1] += u2[1], r2;
}
const h$1J = 1 / 3;
function c$36(n2, t2, e2) {
  if (!n2 || !e2 || e2.length < 3)
    return null;
  const r2 = e2[0], o2 = [0, 0], u2 = [e2[1][0] - r2[0], e2[1][1] - r2[1]];
  let i2;
  for (let l2 = 2; l2 < e2.length; l2++)
    o2[0] = e2[l2][0] - r2[0], o2[1] = e2[l2][1] - r2[1], i2 = 0.5 * h$1J * (o2[0] * u2[1] - o2[1] * u2[0]), n2[0] += i2 * (u2[0] + o2[0]), n2[1] += i2 * (u2[1] + o2[1]), u2[0] = o2[0], u2[1] = o2[1];
  const s2 = M$J(e2), g2 = [r2[0], r2[1]];
  return g2[0] -= t2[0], g2[1] -= t2[1], g2[0] *= s2, g2[1] *= s2, n2[0] += g2[0], n2[1] += g2[1], n2;
}
function n$2H(n2) {
  return n2.xmin !== void 0 && n2.ymin !== void 0 && n2.xmax !== void 0 && n2.ymax !== void 0;
}
function t$1_(n2) {
  return n2.points !== void 0;
}
function e$1S(n2) {
  return n2.x !== void 0 && n2.y !== void 0;
}
function o$20(n2) {
  return n2.paths !== void 0;
}
function r$1J(n2) {
  return n2.rings !== void 0;
}
function i$2U(n2) {
  function t2(t3, e2) {
    return t3 == null ? e2 : e2 == null ? t3 : n2(t3, e2);
  }
  return t2;
}
const l$2v = i$2U(Math.min), u$23 = i$2U(Math.max);
function c$35(i2, l2) {
  return o$20(l2) ? h$1I(i2, l2.paths, false, false) : r$1J(l2) ? h$1I(i2, l2.rings, false, false) : t$1_(l2) ? s$2c(i2, l2.points, false, false, false, false) : n$2H(l2) ? g$1d(i2, l2) : (e$1S(l2) && (i2[0] = l2.x, i2[1] = l2.y, i2[2] = l2.x, i2[3] = l2.y), i2);
}
function f$1K(i2, l2) {
  return o$20(l2) ? h$1I(i2, l2.paths, true, false) : r$1J(l2) ? h$1I(i2, l2.rings, true, false) : t$1_(l2) ? s$2c(i2, l2.points, true, false, true, false) : n$2H(l2) ? g$1d(i2, l2, true, false, true, false) : (e$1S(l2) && (i2[0] = l2.x, i2[1] = l2.y, i2[2] = l2.z, i2[3] = l2.x, i2[4] = l2.y, i2[5] = l2.z), i2);
}
function h$1I(n2, t2, e2, o2) {
  const r2 = e2 ? 3 : 2;
  if (!t2.length || !t2[0].length)
    return null;
  let i2, c2, f2, h2, [g2, s2] = t2[0][0], [x2, m2] = t2[0][0];
  for (let a2 = 0; a2 < t2.length; a2++) {
    const n3 = t2[a2];
    for (let t3 = 0; t3 < n3.length; t3++) {
      const a3 = n3[t3], [d2, v2] = a3;
      if (g2 = l$2v(g2, d2), s2 = l$2v(s2, v2), x2 = u$23(x2, d2), m2 = u$23(m2, v2), e2 && a3.length > 2) {
        const n4 = a3[2];
        i2 = l$2v(i2, n4), c2 = u$23(c2, n4);
      }
      if (o2 && a3.length > r2) {
        const n4 = a3[r2];
        f2 = l$2v(i2, n4), h2 = u$23(c2, n4);
      }
    }
  }
  return e2 ? o2 ? (n2[0] = g2, n2[1] = s2, n2[2] = i2, n2[3] = f2, n2[4] = x2, n2[5] = m2, n2[6] = c2, n2[7] = h2, n2.length = 8, n2) : (n2[0] = g2, n2[1] = s2, n2[2] = i2, n2[3] = x2, n2[4] = m2, n2[5] = c2, n2.length = 6, n2) : o2 ? (n2[0] = g2, n2[1] = s2, n2[2] = f2, n2[3] = x2, n2[4] = m2, n2[5] = h2, n2.length = 6, n2) : (n2[0] = g2, n2[1] = s2, n2[2] = x2, n2[3] = m2, n2.length = 4, n2);
}
function g$1d(n2, t2, e2, o2, r2, i2) {
  const l2 = t2.xmin, u2 = t2.xmax, c2 = t2.ymin, f2 = t2.ymax;
  let h2 = t2.zmin, g2 = t2.zmax, s2 = t2.mmin, x2 = t2.mmax;
  return r2 ? (h2 = h2 || 0, g2 = g2 || 0, i2 ? (s2 = s2 || 0, x2 = x2 || 0, n2[0] = l2, n2[1] = c2, n2[2] = h2, n2[3] = s2, n2[4] = u2, n2[5] = f2, n2[6] = g2, n2[7] = x2, n2) : (n2[0] = l2, n2[1] = c2, n2[2] = h2, n2[3] = u2, n2[4] = f2, n2[5] = g2, n2)) : i2 ? (s2 = s2 || 0, x2 = x2 || 0, n2[0] = l2, n2[1] = c2, n2[2] = s2, n2[3] = u2, n2[4] = f2, n2[5] = x2, n2) : (n2[0] = l2, n2[1] = c2, n2[2] = u2, n2[3] = f2, n2);
}
function s$2c(n2, t2, e2, o2, r2, i2) {
  const c2 = e2 ? 3 : 2, f2 = o2 && i2, h2 = e2 && r2;
  if (!t2.length || !t2[0].length)
    return null;
  let g2, s2, x2, m2, [a2, d2] = t2[0], [v2, y2] = t2[0];
  for (let p2 = 0; p2 < t2.length; p2++) {
    const n3 = t2[p2], [e3, o3] = n3;
    if (a2 = l$2v(a2, e3), d2 = l$2v(d2, o3), v2 = u$23(v2, e3), y2 = u$23(y2, o3), h2 && n3.length > 2) {
      const t3 = n3[2];
      g2 = l$2v(g2, t3), s2 = u$23(s2, t3);
    }
    if (f2 && n3.length > c2) {
      const t3 = n3[c2];
      x2 = l$2v(g2, t3), m2 = u$23(s2, t3);
    }
  }
  return r2 ? (g2 = g2 || 0, s2 = s2 || 0, i2 ? (x2 = x2 || 0, m2 = m2 || 0, n2[0] = a2, n2[1] = d2, n2[2] = g2, n2[3] = x2, n2[4] = v2, n2[5] = y2, n2[6] = s2, n2[7] = m2, n2) : (n2[0] = a2, n2[1] = d2, n2[2] = g2, n2[3] = v2, n2[4] = y2, n2[5] = s2, n2)) : i2 ? (x2 = x2 || 0, m2 = m2 || 0, n2[0] = a2, n2[1] = d2, n2[2] = x2, n2[3] = v2, n2[4] = y2, n2[5] = m2, n2) : (n2[0] = a2, n2[1] = d2, n2[2] = v2, n2[3] = y2, n2);
}
function t$1Z(n2) {
  return n2.xmin !== void 0 && n2.ymin !== void 0 && n2.xmax !== void 0 && n2.ymax !== void 0;
}
function u$22(n2) {
  return n2.points !== void 0;
}
function m$2j(n2) {
  return n2.x !== void 0 && n2.y !== void 0;
}
function o$1$(n2) {
  return n2.paths !== void 0;
}
function r$1I(n2) {
  return n2.rings !== void 0;
}
const x$Y = [];
function a$2N(n2, i2, t2, u2) {
  return { xmin: n2, ymin: i2, xmax: t2, ymax: u2 };
}
function c$34(n2, i2, t2, u2, m2, o2) {
  return { xmin: n2, ymin: i2, zmin: t2, xmax: u2, ymax: m2, zmax: o2 };
}
function s$2b(n2, i2, t2, u2, m2, o2) {
  return { xmin: n2, ymin: i2, mmin: t2, xmax: u2, ymax: m2, mmax: o2 };
}
function e$1R(n2, i2, t2, u2, m2, o2, r2, x2) {
  return { xmin: n2, ymin: i2, zmin: t2, mmin: u2, xmax: m2, ymax: o2, zmax: r2, mmax: x2 };
}
function f$1J(n2, i2 = false, t2 = false) {
  return i2 ? t2 ? e$1R(n2[0], n2[1], n2[2], n2[3], n2[4], n2[5], n2[6], n2[7]) : c$34(n2[0], n2[1], n2[2], n2[3], n2[4], n2[5]) : t2 ? s$2b(n2[0], n2[1], n2[2], n2[3], n2[4], n2[5]) : a$2N(n2[0], n2[1], n2[2], n2[3]);
}
function l$2u(n2) {
  return n2 ? t$1Z(n2) ? n2 : m$2j(n2) ? d$1Q(n2) : r$1I(n2) ? v$16(n2) : o$1$(n2) ? h$1H(n2) : u$22(n2) ? y$1u(n2) : null : null;
}
function y$1u(i2) {
  const { hasZ: t2, hasM: u2, points: m2 } = i2;
  return f$1J(s$2c(x$Y, m2, t2 != null ? t2 : false, u2 != null ? u2 : false), t2, u2);
}
function d$1Q(n2) {
  const { x: i2, y: t2, z: u2, m: m2 } = n2, o2 = m2 != null;
  return u2 != null ? o2 ? e$1R(i2, t2, u2, m2, i2, t2, u2, m2) : c$34(i2, t2, u2, i2, t2, u2) : o2 ? s$2b(i2, t2, m2, i2, t2, m2) : a$2N(i2, t2, i2, t2);
}
function v$16(n2) {
  const { hasZ: t2, hasM: u2, rings: m2 } = n2, o2 = h$1I(x$Y, m2, t2 != null ? t2 : false, u2 != null ? u2 : false);
  return o2 ? f$1J(o2, t2, u2) : null;
}
function h$1H(n2) {
  const { hasZ: t2, hasM: u2, paths: m2 } = n2, o2 = h$1I(x$Y, m2, t2 != null ? t2 : false, u2 != null ? u2 : false);
  return o2 ? f$1J(o2, t2, u2) : null;
}
var x$X;
function j$W(t2) {
  return !Array.isArray(t2[0]);
}
let w$Y = x$X = class extends p$3y {
  constructor(...t2) {
    super(...t2), this.rings = [], this.type = "polygon";
  }
  static fromExtent(t2) {
    const r2 = t2.clone().normalize(), e2 = t2.spatialReference;
    let s2 = false, i2 = false;
    for (const o2 of r2)
      o2.hasZ && (s2 = true), o2.hasM && (i2 = true);
    const n2 = { rings: r2.map((t3) => {
      const r3 = [[t3.xmin, t3.ymin], [t3.xmin, t3.ymax], [t3.xmax, t3.ymax], [t3.xmax, t3.ymin], [t3.xmin, t3.ymin]];
      if (s2 && t3.hasZ) {
        const e3 = t3.zmin + 0.5 * (t3.zmax - t3.zmin);
        for (let t4 = 0; t4 < r3.length; t4++)
          r3[t4].push(e3);
      }
      if (i2 && t3.hasM) {
        const e3 = t3.mmin + 0.5 * (t3.mmax - t3.mmin);
        for (let t4 = 0; t4 < r3.length; t4++)
          r3[t4].push(e3);
      }
      return r3;
    }), spatialReference: e2 };
    return s2 && (n2.hasZ = true), i2 && (n2.hasM = true), new x$X(n2);
  }
  normalizeCtorArgs(t2, r2) {
    let e2, s2, i2 = null, n2 = null;
    return t2 && !Array.isArray(t2) ? (i2 = t2.rings ? t2.rings : null, r2 || (t2.spatialReference ? r2 = t2.spatialReference : t2.rings || (r2 = t2)), e2 = t2.hasZ, s2 = t2.hasM) : i2 = t2, i2 = i2 || [], r2 = r2 || k$C.WGS84, i2.length && i2[0] && i2[0][0] != null && typeof i2[0][0] == "number" && (i2 = [i2]), n2 = i2[0] && i2[0][0], n2 && (e2 === void 0 && s2 === void 0 ? (e2 = n2.length > 2, s2 = n2.length > 3) : e2 === void 0 ? e2 = s2 ? n2.length > 3 : n2.length > 2 : s2 === void 0 && (s2 = e2 ? n2.length > 3 : n2.length > 2)), { rings: i2, spatialReference: r2, hasZ: e2, hasM: s2 };
  }
  get cache() {
    return this.commitProperty("rings"), this.commitProperty("hasZ"), this.commitProperty("hasM"), this.commitProperty("spatialReference"), {};
  }
  get centroid() {
    const t2 = r$1K(this);
    if (!t2 || isNaN(t2[0]) || isNaN(t2[1]) || this.hasZ && isNaN(t2[2]))
      return null;
    const r2 = new w$_();
    return r2.x = t2[0], r2.y = t2[1], r2.spatialReference = this.spatialReference, this.hasZ && (r2.z = t2[2]), r2;
  }
  get extent() {
    const { spatialReference: t2 } = this, r2 = v$16(this);
    if (!r2)
      return null;
    const e2 = new w$Z(r2);
    return e2.spatialReference = t2, e2;
  }
  get isSelfIntersecting() {
    return p$3w(this.rings);
  }
  writeRings(t2, r2) {
    r2.rings = y$1L(this.rings);
  }
  addRing(t2) {
    if (!t2)
      return;
    const r2 = this.rings, e2 = r2.length;
    if (j$W(t2)) {
      const s2 = [];
      for (let r3 = 0, e3 = t2.length; r3 < e3; r3++)
        s2[r3] = t2[r3].toArray();
      r2[e2] = s2;
    } else
      r2[e2] = t2.concat();
    return this.notifyChange("rings"), this;
  }
  clone() {
    const t2 = new x$X();
    return t2.spatialReference = this.spatialReference, t2.rings = y$1L(this.rings), t2.hasZ = this.hasZ, t2.hasM = this.hasM, t2;
  }
  equals(t2) {
    if (this === t2)
      return true;
    if (t$2r(t2))
      return false;
    const e2 = this.spatialReference, n2 = t2.spatialReference;
    if (r$1$(e2) !== r$1$(n2))
      return false;
    if (r$1$(e2) && r$1$(n2) && !e2.equals(n2))
      return false;
    if (this.rings.length !== t2.rings.length)
      return false;
    const o2 = ([t3, r2, e3, s2], [i2, n3, o3, a2]) => t3 === i2 && r2 === n3 && (e3 == null && o3 == null || e3 === o3) && (s2 == null && a2 == null || s2 === a2);
    for (let s2 = 0; s2 < this.rings.length; s2++) {
      const e3 = this.rings[s2], i2 = t2.rings[s2];
      if (!i$3e(e3, i2, o2))
        return false;
    }
    return true;
  }
  contains(t2) {
    if (!t2)
      return false;
    const r2 = M$L(t2, this.spatialReference);
    return c$3a(this, r$1$(r2) ? r2 : t2);
  }
  isClockwise(t2) {
    let r2;
    return r2 = j$W(t2) ? t2.map((t3) => this.hasZ ? this.hasM ? [t3.x, t3.y, t3.z, t3.m] : [t3.x, t3.y, t3.z] : [t3.x, t3.y]) : t2, h$1K(r2, this.hasM, this.hasZ);
  }
  getPoint(t2, r2) {
    if (!this._validateInputs(t2, r2))
      return null;
    const e2 = this.rings[t2][r2], s2 = this.hasZ, i2 = this.hasM;
    return s2 && !i2 ? new w$_(e2[0], e2[1], e2[2], void 0, this.spatialReference) : i2 && !s2 ? new w$_(e2[0], e2[1], void 0, e2[2], this.spatialReference) : s2 && i2 ? new w$_(e2[0], e2[1], e2[2], e2[3], this.spatialReference) : new w$_(e2[0], e2[1], this.spatialReference);
  }
  insertPoint(t2, r2, e2) {
    return this._validateInputs(t2, r2, true) ? (h$1M(this, e2), Array.isArray(e2) || (e2 = e2.toArray()), this.rings[t2].splice(r2, 0, e2), this.notifyChange("rings"), this) : this;
  }
  removePoint(t2, r2) {
    if (!this._validateInputs(t2, r2))
      return null;
    const e2 = new w$_(this.rings[t2].splice(r2, 1)[0], this.spatialReference);
    return this.notifyChange("rings"), e2;
  }
  removeRing(t2) {
    if (!this._validateInputs(t2, null))
      return null;
    const r2 = this.rings.splice(t2, 1)[0], e2 = this.spatialReference, s2 = r2.map((t3) => new w$_(t3, e2));
    return this.notifyChange("rings"), s2;
  }
  setPoint(t2, r2, e2) {
    return this._validateInputs(t2, r2) ? (h$1M(this, e2), Array.isArray(e2) || (e2 = e2.toArray()), this.rings[t2][r2] = e2, this.notifyChange("rings"), this) : this;
  }
  _validateInputs(t2, r2, e2 = false) {
    if (t2 == null || t2 < 0 || t2 >= this.rings.length)
      return false;
    if (r2 != null) {
      const s2 = this.rings[t2];
      if (e2 && (r2 < 0 || r2 > s2.length))
        return false;
      if (!e2 && (r2 < 0 || r2 >= s2.length))
        return false;
    }
    return true;
  }
  toJSON(t2) {
    return this.write({}, t2);
  }
};
e$2g([y$1I({ readOnly: true })], w$Y.prototype, "cache", null), e$2g([y$1I({ readOnly: true })], w$Y.prototype, "centroid", null), e$2g([y$1I({ readOnly: true })], w$Y.prototype, "extent", null), e$2g([y$1I({ readOnly: true })], w$Y.prototype, "isSelfIntersecting", null), e$2g([y$1I({ type: [[[Number]]], json: { write: { isRequired: true } } })], w$Y.prototype, "rings", void 0), e$2g([r$1P("rings")], w$Y.prototype, "writeRings", null), w$Y = x$X = e$2g([n$2P("esri.geometry.Polygon")], w$Y), w$Y.prototype.toJSON.isDefaultToJSON = true;
const v$15 = w$Y;
var c$33;
function u$21(t2) {
  return !Array.isArray(t2[0]);
}
let f$1I = c$33 = class extends p$3y {
  constructor(...t2) {
    super(...t2), this.paths = [], this.type = "polyline";
  }
  normalizeCtorArgs(t2, e2) {
    let s2, r2, i2 = null, a2 = null;
    return t2 && !Array.isArray(t2) ? (i2 = t2.paths ? t2.paths : null, e2 || (t2.spatialReference ? e2 = t2.spatialReference : t2.paths || (e2 = t2)), s2 = t2.hasZ, r2 = t2.hasM) : i2 = t2, i2 = i2 || [], e2 = e2 || k$C.WGS84, i2.length && i2[0] && i2[0][0] != null && typeof i2[0][0] == "number" && (i2 = [i2]), a2 = i2[0] && i2[0][0], a2 && (s2 === void 0 && r2 === void 0 ? (s2 = a2.length > 2, r2 = false) : s2 === void 0 ? s2 = !r2 && a2.length > 3 : r2 === void 0 && (r2 = !s2 && a2.length > 3)), { paths: i2, spatialReference: e2, hasZ: s2, hasM: r2 };
  }
  get cache() {
    return this.commitProperty("paths"), this.commitProperty("hasZ"), this.commitProperty("hasM"), this.commitProperty("spatialReference"), {};
  }
  get extent() {
    const { spatialReference: t2 } = this, e2 = h$1H(this);
    if (!e2)
      return null;
    const s2 = new w$Z(e2);
    return s2.spatialReference = t2, s2;
  }
  writePaths(t2, s2) {
    s2.paths = y$1L(this.paths);
  }
  addPath(t2) {
    if (!t2)
      return;
    const e2 = this.paths, s2 = e2.length;
    if (u$21(t2)) {
      const r2 = [];
      for (let e3 = 0, s3 = t2.length; e3 < s3; e3++)
        r2[e3] = t2[e3].toArray();
      e2[s2] = r2;
    } else
      e2[s2] = t2.concat();
    return this.notifyChange("paths"), this;
  }
  clone() {
    const t2 = new c$33();
    return t2.spatialReference = this.spatialReference, t2.paths = y$1L(this.paths), t2.hasZ = this.hasZ, t2.hasM = this.hasM, t2;
  }
  getPoint(t2, e2) {
    if (!this._validateInputs(t2, e2))
      return null;
    const s2 = this.paths[t2][e2], r2 = this.hasZ, i2 = this.hasM;
    return r2 && !i2 ? new w$_(s2[0], s2[1], s2[2], void 0, this.spatialReference) : i2 && !r2 ? new w$_(s2[0], s2[1], void 0, s2[2], this.spatialReference) : r2 && i2 ? new w$_(s2[0], s2[1], s2[2], s2[3], this.spatialReference) : new w$_(s2[0], s2[1], this.spatialReference);
  }
  insertPoint(t2, e2, s2) {
    return this._validateInputs(t2, e2, true) ? (h$1M(this, s2), Array.isArray(s2) || (s2 = s2.toArray()), this.paths[t2].splice(e2, 0, s2), this.notifyChange("paths"), this) : this;
  }
  removePath(t2) {
    if (!this._validateInputs(t2, null))
      return null;
    const e2 = this.paths.splice(t2, 1)[0], s2 = this.spatialReference, r2 = e2.map((t3) => new w$_(t3, s2));
    return this.notifyChange("paths"), r2;
  }
  removePoint(t2, e2) {
    if (!this._validateInputs(t2, e2))
      return null;
    const s2 = new w$_(this.paths[t2].splice(e2, 1)[0], this.spatialReference);
    return this.notifyChange("paths"), s2;
  }
  setPoint(t2, e2, s2) {
    return this._validateInputs(t2, e2) ? (h$1M(this, s2), Array.isArray(s2) || (s2 = s2.toArray()), this.paths[t2][e2] = s2, this.notifyChange("paths"), this) : this;
  }
  _validateInputs(t2, e2, s2 = false) {
    if (t2 == null || t2 < 0 || t2 >= this.paths.length)
      return false;
    if (e2 != null) {
      const r2 = this.paths[t2];
      if (s2 && (e2 < 0 || e2 > r2.length))
        return false;
      if (!s2 && (e2 < 0 || e2 >= r2.length))
        return false;
    }
    return true;
  }
  toJSON(t2) {
    return this.write({}, t2);
  }
};
e$2g([y$1I({ readOnly: true })], f$1I.prototype, "cache", null), e$2g([y$1I({ readOnly: true })], f$1I.prototype, "extent", null), e$2g([y$1I({ type: [[[Number]]], json: { write: { isRequired: true } } })], f$1I.prototype, "paths", void 0), e$2g([r$1P("paths")], f$1I.prototype, "writePaths", null), f$1I = c$33 = e$2g([n$2P("esri.geometry.Polyline")], f$1I), f$1I.prototype.toJSON.isDefaultToJSON = true;
const m$2i = f$1I;
class s$2a {
  constructor(s2, o2 = { ignoreUnknown: false, useNumericKeys: false }) {
    this._jsonToAPI = s2, this._options = o2, this.apiValues = [], this.jsonValues = [], this._apiToJSON = this._invertMap(s2), this.apiValues = this._getKeysSorted(this._apiToJSON), this.jsonValues = this._getKeysSorted(this._jsonToAPI), this.read = (t2) => this.fromJSON(t2), this.write = (s3, o3, i2) => {
      const n2 = this.toJSON(s3);
      n2 !== void 0 && o$2q(i2, n2, o3);
    }, this.write.isJSONMapWriter = true;
  }
  toJSON(t2) {
    if (this._apiToJSON.hasOwnProperty(t2)) {
      const s2 = this._apiToJSON[t2];
      return this._options.useNumericKeys ? +s2 : s2;
    }
    return this._options.ignoreUnknown ? void 0 : t2;
  }
  fromJSON(t2) {
    return this._jsonToAPI.hasOwnProperty(t2) ? this._jsonToAPI[t2] : this._options.ignoreUnknown ? void 0 : t2;
  }
  _invertMap(t2) {
    const s2 = {};
    for (const o2 in t2)
      s2[t2[o2]] = o2;
    return s2;
  }
  _getKeysSorted(t2) {
    const s2 = [];
    for (const o2 in t2)
      s2.push(o2);
    return s2.sort(), s2;
  }
}
function o$1_() {
  return function(t2, o2) {
    return new s$2a(t2, __spreadValues({ ignoreUnknown: true }, o2));
  };
}
const i$2T = o$1_()({ esriGeometryPoint: "point", esriGeometryMultipoint: "multipoint", esriGeometryPolyline: "polyline", esriGeometryPolygon: "polygon" }), t$1Y = o$1_()({ esriGeometryPoint: "point", esriGeometryMultipoint: "multipoint", esriGeometryPolyline: "polyline", esriGeometryPolygon: "polygon", esriGeometryEnvelope: "extent", mesh: "mesh" });
function u$20(o2) {
  return o2.xmin !== void 0 && o2.ymin !== void 0 && o2.xmax !== void 0 && o2.ymax !== void 0;
}
function l$2t(o2) {
  return o2.points !== void 0;
}
function s$29(o2) {
  return o2.x !== void 0 && o2.y !== void 0;
}
function f$1H(o2) {
  return o2.paths !== void 0;
}
function y$1t(o2) {
  return o2.rings !== void 0;
}
function v$14(p2) {
  return t$2r(p2) ? null : p2 instanceof p$3y ? p2 : s$29(p2) ? w$_.fromJSON(p2) : f$1H(p2) ? m$2i.fromJSON(p2) : y$1t(p2) ? v$15.fromJSON(p2) : l$2t(p2) ? u$26.fromJSON(p2) : u$20(p2) ? w$Z.fromJSON(p2) : null;
}
function c$32(o2) {
  return o2 ? s$29(o2) ? "esriGeometryPoint" : f$1H(o2) ? "esriGeometryPolyline" : y$1t(o2) ? "esriGeometryPolygon" : u$20(o2) ? "esriGeometryEnvelope" : l$2t(o2) ? "esriGeometryMultipoint" : null : null;
}
const G$u = { esriGeometryPoint: w$_, esriGeometryPolyline: m$2i, esriGeometryPolygon: v$15, esriGeometryEnvelope: w$Z, esriGeometryMultipoint: u$26 };
function d$1P(o2) {
  return o2 && G$u[o2] || null;
}
const i$2S = { base: p$3y, key: "type", typeMap: { extent: w$Z, multipoint: u$26, point: w$_, polyline: m$2i, polygon: v$15 } };
S$V(i$2S);
const i$2R = (s2) => {
  let i2 = class extends s2 {
    clone() {
      var _a2;
      const o2 = f$21(e$2a(this), "unable to clone instance of non-accessor class"), s3 = o2.metadatas, c2 = o2.store, i3 = {}, l2 = new Map();
      for (const r2 in s3) {
        const o3 = s3[r2], n2 = c2 == null ? void 0 : c2.originOf(r2), a3 = o3.clonable;
        if (o3.readOnly || a3 === false || n2 !== r$1U.USER && n2 !== r$1U.DEFAULTS && n2 !== r$1U.WEB_MAP && n2 !== r$1U.WEB_SCENE)
          continue;
        const p2 = this[r2];
        let f2 = null;
        f2 = typeof a3 == "function" ? a3(p2) : a3 === "reference" ? p2 : m$2x(p2), p2 != null && f2 == null || (n2 === r$1U.DEFAULTS ? l2.set(r2, f2) : i3[r2] = f2);
      }
      const a2 = new (Object.getPrototypeOf(this)).constructor(i3);
      if (l2.size) {
        const o3 = (_a2 = e$2a(a2)) == null ? void 0 : _a2.store;
        if (o3)
          for (const [s4, t2] of l2)
            o3.set(s4, t2, r$1U.DEFAULTS);
      }
      return a2;
    }
  };
  return i2 = e$2g([n$2P("esri.core.Clonable")], i2), i2;
};
let l$2s = class extends i$2R(m$2q) {
};
l$2s = e$2g([n$2P("esri.core.Clonable")], l$2s);
class i$2Q {
  constructor() {
    this._emitter = new i$2Q.EventEmitter(this);
  }
  emit(t2, e2) {
    return this._emitter.emit(t2, e2);
  }
  on(t2, e2) {
    return this._emitter.on(t2, e2);
  }
  once(t2, e2) {
    return this._emitter.once(t2, e2);
  }
  hasEventListener(t2) {
    return this._emitter.hasEventListener(t2);
  }
}
!function(n2) {
  class o2 {
    constructor(t2 = null) {
      this._target = t2, this._listenersMap = null;
    }
    clear() {
      this._listenersMap && this._listenersMap.clear(), this._listenersMap = null;
    }
    emit(t2, e2) {
      const s2 = this._listenersMap && this._listenersMap.get(t2);
      if (!s2)
        return false;
      const r2 = this._target || this;
      return [...s2].forEach((t3) => {
        t3.call(r2, e2);
      }), s2.length > 0;
    }
    on(t2, e2) {
      if (Array.isArray(t2)) {
        const r3 = t2.map((t3) => this.on(t3, e2));
        return r$1X(r3);
      }
      if (t2.includes(","))
        throw new TypeError("Evented.on() with a comma delimited string of event types is not supported");
      this._listenersMap || (this._listenersMap = new Map());
      const r2 = this._listenersMap.get(t2) || [];
      return r2.push(e2), this._listenersMap.set(t2, r2), { remove: () => {
        const s2 = this._listenersMap && this._listenersMap.get(t2) || [], r3 = s2.indexOf(e2);
        r3 >= 0 && s2.splice(r3, 1);
      } };
    }
    once(t2, e2) {
      const s2 = this.on(t2, (t3) => {
        s2.remove(), e2.call(null, t3);
      });
      return s2;
    }
    hasEventListener(t2) {
      const e2 = this._listenersMap && this._listenersMap.get(t2);
      return e2 != null && e2.length > 0;
    }
  }
  n2.EventEmitter = o2, n2.EventedMixin = (e2) => {
    let s2 = class extends e2 {
      constructor() {
        super(...arguments), this._emitter = new o2();
      }
      destroy() {
        this._emitter.clear();
      }
      emit(t2, e3) {
        return this._emitter.emit(t2, e3);
      }
      on(t2, e3) {
        return this._emitter.on(t2, e3);
      }
      once(t2, e3) {
        return this._emitter.once(t2, e3);
      }
      hasEventListener(t2) {
        return this._emitter.hasEventListener(t2);
      }
    };
    return s2 = e$2g([n$2P("esri.core.Evented")], s2), s2;
  };
  let h2 = class extends m$2q {
    constructor() {
      super(...arguments), this._emitter = new i$2Q.EventEmitter(this);
    }
    destroy() {
      this._emitter.clear();
    }
    emit(t2, e2) {
      return this._emitter.emit(t2, e2);
    }
    on(t2, e2) {
      return this._emitter.on(t2, e2);
    }
    once(t2, e2) {
      return this._emitter.once(t2, e2);
    }
    hasEventListener(t2) {
      return this._emitter.hasEventListener(t2);
    }
  };
  h2 = e$2g([n$2P("esri.core.Evented")], h2), n2.EventedAccessor = h2;
}(i$2Q || (i$2Q = {}));
const n$2G = i$2Q;
var E$O;
!function(E2) {
  E2[E2.ADD = 1] = "ADD", E2[E2.REMOVE = 2] = "REMOVE", E2[E2.MOVE = 4] = "MOVE";
}(E$O || (E$O = {}));
function n$2F(n2) {
  return (r2, t2) => {
    r2[t2] = n2;
  };
}
class e$1Q {
  constructor() {
    this._observers = [];
  }
  observe(e2) {
    return this._observers.includes(e2) || this._observers.push(e2), new s$2n(this._observers, e2);
  }
  notify() {
    const s2 = this._observers.slice();
    for (let e2 = 0; e2 < s2.length; ++e2) {
      const r2 = s2[e2];
      r2.onInvalidated(), r2.onCommitted();
    }
  }
}
var g$1c;
class p$3u {
  constructor() {
    this.target = null, this.cancellable = false, this.defaultPrevented = false, this.item = void 0, this.type = void 0;
  }
  preventDefault() {
    this.cancellable && (this.defaultPrevented = true);
  }
  reset(e2) {
    this.defaultPrevented = false, this.item = e2;
  }
}
const b$16 = new e$24(p$3u, void 0, (e2) => {
  e2.item = null, e2.target = null, e2.defaultPrevented = false, e2.cancellable = false;
}), d$1O = () => {
};
function v$13(e2) {
  return e2 ? e2 instanceof V$o ? e2.toArray() : e2.length ? Array.prototype.slice.apply(e2) : [] : [];
}
function E$N(e2) {
  if (e2 && e2.length)
    return e2[0];
}
function y$1s(e2, t2, s2, i2) {
  const r2 = Math.min(e2.length - s2, t2.length - i2);
  let n2 = 0;
  for (; n2 < r2 && e2[s2 + n2] === t2[i2 + n2]; )
    n2++;
  return n2;
}
function C$C(e2, t2, s2, i2) {
  t2 && t2.forEach((t3, r2, n2) => {
    e2.push(t3), C$C(e2, s2.call(i2, t3, r2, n2), s2, i2);
  });
}
const A$y = new Set(), O$C = new Set(), M$I = new Set(), D$A = new Map();
let x$W = 0, V$o = g$1c = class extends n$2G.EventedAccessor {
  constructor(e2) {
    super(e2), this._chgListeners = [], this._notifications = null, this._timer = null, this._observable = new e$1Q(), this.length = 0, this._items = [], Object.defineProperty(this, "uid", { value: x$W++ });
  }
  static isCollection(e2) {
    return e2 != null && e2 instanceof g$1c;
  }
  normalizeCtorArgs(e2) {
    return e2 ? Array.isArray(e2) || e2 instanceof g$1c ? { items: e2 } : e2 : {};
  }
  destroy() {
    this.removeAll();
  }
  *[Symbol.iterator]() {
    yield* this.items;
  }
  get items() {
    return s$2s(this._observable), this._items;
  }
  set items(e2) {
    this._emitBeforeChanges(E$O.ADD) || (this._splice(0, this.length, v$13(e2)), this._emitAfterChanges(E$O.ADD));
  }
  hasEventListener(e2) {
    return e2 === "change" ? this._chgListeners.length > 0 : this._emitter.hasEventListener(e2);
  }
  on(e2, t2) {
    if (e2 === "change") {
      const e3 = this._chgListeners, s2 = { removed: false, callback: t2 };
      return e3.push(s2), this._notifications && this._notifications.push({ listeners: e3.slice(), items: this._items.slice(), changes: [] }), { remove() {
        this.remove = d$1O, s2.removed = true, e3.splice(e3.indexOf(s2), 1);
      } };
    }
    return this._emitter.on(e2, t2);
  }
  once(e2, t2) {
    const s2 = this.on(e2, t2);
    return { remove() {
      s2.remove();
    } };
  }
  add(e2, t2) {
    if (s$2s(this._observable), this._emitBeforeChanges(E$O.ADD))
      return this;
    const s2 = this.getNextIndex(t2 != null ? t2 : null);
    return this._splice(s2, 0, [e2]), this._emitAfterChanges(E$O.ADD), this;
  }
  addMany(e2, t2 = this._items.length) {
    if (s$2s(this._observable), !e2 || !e2.length)
      return this;
    if (this._emitBeforeChanges(E$O.ADD))
      return this;
    const s2 = this.getNextIndex(t2);
    return this._splice(s2, 0, v$13(e2)), this._emitAfterChanges(E$O.ADD), this;
  }
  at(e2) {
    if (s$2s(this._observable), (e2 = Math.trunc(e2) || 0) < 0 && (e2 += this.length), !(e2 < 0 || e2 >= this.length))
      return this._items[e2];
  }
  removeAll() {
    if (s$2s(this._observable), !this.length || this._emitBeforeChanges(E$O.REMOVE))
      return [];
    const e2 = this._splice(0, this.length) || [];
    return this._emitAfterChanges(E$O.REMOVE), e2;
  }
  clone() {
    return s$2s(this._observable), this._createNewInstance({ items: this._items.map(y$1L) });
  }
  concat(...e2) {
    s$2s(this._observable);
    const t2 = e2.map(v$13);
    return this._createNewInstance({ items: this._items.concat(...t2) });
  }
  drain(e2, t2) {
    if (s$2s(this._observable), !this.length || this._emitBeforeChanges(E$O.REMOVE))
      return;
    const s2 = x$16(this._splice(0, this.length)), i2 = s2.length;
    for (let r2 = 0; r2 < i2; r2++)
      e2.call(t2, s2[r2], r2, s2);
    this._emitAfterChanges(E$O.REMOVE);
  }
  every(e2, t2) {
    return s$2s(this._observable), this._items.every(e2, t2);
  }
  filter(e2, t2) {
    let s2;
    return s$2s(this._observable), s2 = arguments.length === 2 ? this._items.filter(e2, t2) : this._items.filter(e2), this._createNewInstance({ items: s2 });
  }
  find(e2, t2) {
    return s$2s(this._observable), this._items.find(e2, t2);
  }
  findIndex(e2, t2) {
    return s$2s(this._observable), this._items.findIndex(e2, t2);
  }
  flatten(e2, t2) {
    s$2s(this._observable);
    const s2 = [];
    return C$C(s2, this, e2, t2), new g$1c(s2);
  }
  forEach(e2, t2) {
    return s$2s(this._observable), this._items.forEach(e2, t2);
  }
  getItemAt(e2) {
    return s$2s(this._observable), this._items[e2];
  }
  getNextIndex(e2) {
    s$2s(this._observable);
    const t2 = this.length;
    return (e2 = e2 != null ? e2 : t2) < 0 ? e2 = 0 : e2 > t2 && (e2 = t2), e2;
  }
  includes(e2, t2 = 0) {
    return s$2s(this._observable), this._items.includes(e2, t2);
  }
  indexOf(e2, t2 = 0) {
    return s$2s(this._observable), this._items.indexOf(e2, t2);
  }
  join(e2 = ",") {
    return s$2s(this._observable), this._items.join(e2);
  }
  lastIndexOf(e2, t2 = this.length - 1) {
    return s$2s(this._observable), this._items.lastIndexOf(e2, t2);
  }
  map(e2, t2) {
    s$2s(this._observable);
    const s2 = this._items.map(e2, t2);
    return new g$1c({ items: s2 });
  }
  reorder(e2, t2 = this.length - 1) {
    s$2s(this._observable);
    const s2 = this.indexOf(e2);
    if (s2 !== -1) {
      if (t2 < 0 ? t2 = 0 : t2 >= this.length && (t2 = this.length - 1), s2 !== t2) {
        if (this._emitBeforeChanges(E$O.MOVE))
          return e2;
        this._splice(s2, 1), this._splice(t2, 0, [e2]), this._emitAfterChanges(E$O.MOVE);
      }
      return e2;
    }
  }
  pop() {
    if (s$2s(this._observable), !this.length || this._emitBeforeChanges(E$O.REMOVE))
      return;
    const e2 = E$N(this._splice(this.length - 1, 1));
    return this._emitAfterChanges(E$O.REMOVE), e2;
  }
  push(...e2) {
    return s$2s(this._observable), this._emitBeforeChanges(E$O.ADD) || (this._splice(this.length, 0, e2), this._emitAfterChanges(E$O.ADD)), this.length;
  }
  reduce(e2, t2) {
    s$2s(this._observable);
    const s2 = this._items;
    return arguments.length === 2 ? s2.reduce(e2, t2) : s2.reduce(e2);
  }
  reduceRight(e2, t2) {
    s$2s(this._observable);
    const s2 = this._items;
    return arguments.length === 2 ? s2.reduceRight(e2, t2) : s2.reduceRight(e2);
  }
  remove(e2) {
    return s$2s(this._observable), this.removeAt(this.indexOf(e2));
  }
  removeAt(e2) {
    if (s$2s(this._observable), e2 < 0 || e2 >= this.length || this._emitBeforeChanges(E$O.REMOVE))
      return;
    const t2 = E$N(this._splice(e2, 1));
    return this._emitAfterChanges(E$O.REMOVE), t2;
  }
  removeMany(e2) {
    if (s$2s(this._observable), !e2 || !e2.length || this._emitBeforeChanges(E$O.REMOVE))
      return [];
    const t2 = e2 instanceof g$1c ? e2.toArray() : e2, s2 = this._items, i2 = [], r2 = t2.length;
    for (let n2 = 0; n2 < r2; n2++) {
      const e3 = t2[n2], r3 = s2.indexOf(e3);
      if (r3 > -1) {
        const e4 = 1 + y$1s(t2, s2, n2 + 1, r3 + 1), h2 = this._splice(r3, e4);
        h2 && h2.length > 0 && i2.push.apply(i2, h2), n2 += e4 - 1;
      }
    }
    return this._emitAfterChanges(E$O.REMOVE), i2;
  }
  reverse() {
    if (s$2s(this._observable), this._emitBeforeChanges(E$O.MOVE))
      return this;
    const e2 = this._splice(0, this.length);
    return e2 && (e2.reverse(), this._splice(0, 0, e2)), this._emitAfterChanges(E$O.MOVE), this;
  }
  shift() {
    if (s$2s(this._observable), !this.length || this._emitBeforeChanges(E$O.REMOVE))
      return;
    const e2 = E$N(this._splice(0, 1));
    return this._emitAfterChanges(E$O.REMOVE), e2;
  }
  slice(e2 = 0, t2 = this.length) {
    return s$2s(this._observable), this._createNewInstance({ items: this._items.slice(e2, t2) });
  }
  some(e2, t2) {
    return s$2s(this._observable), this._items.some(e2, t2);
  }
  sort(e2) {
    if (s$2s(this._observable), !this.length || this._emitBeforeChanges(E$O.MOVE))
      return this;
    const t2 = x$16(this._splice(0, this.length));
    return arguments.length ? t2.sort(e2) : t2.sort(), this._splice(0, 0, t2), this._emitAfterChanges(E$O.MOVE), this;
  }
  splice(e2, t2, ...s2) {
    s$2s(this._observable);
    const i2 = (t2 ? E$O.REMOVE : 0) | (s2.length ? E$O.ADD : 0);
    if (this._emitBeforeChanges(i2))
      return [];
    const r2 = this._splice(e2, t2, s2) || [];
    return this._emitAfterChanges(i2), r2;
  }
  toArray() {
    return s$2s(this._observable), this._items.slice();
  }
  toJSON() {
    return s$2s(this._observable), this.toArray();
  }
  toLocaleString() {
    return s$2s(this._observable), this._items.toLocaleString();
  }
  toString() {
    return s$2s(this._observable), this._items.toString();
  }
  unshift(...e2) {
    return s$2s(this._observable), !e2.length || this._emitBeforeChanges(E$O.ADD) || (this._splice(0, 0, e2), this._emitAfterChanges(E$O.ADD)), this.length;
  }
  _createNewInstance(e2) {
    return new this.constructor(e2);
  }
  _splice(e2, t2, s2) {
    const i2 = this._items, r2 = this.itemType;
    let n2, h2;
    if (!this._notifications && this.hasEventListener("change") && (this._notifications = [{ listeners: this._chgListeners.slice(), items: this._items.slice(), changes: [] }], this._timer && this._timer.remove(), this._timer = v$18(() => this._dispatchChange())), t2) {
      if (h2 = i2.splice(e2, t2), this.hasEventListener("before-remove")) {
        const t3 = b$16.acquire();
        t3.target = this, t3.cancellable = true;
        for (let s3 = 0, r3 = h2.length; s3 < r3; s3++)
          n2 = h2[s3], t3.reset(n2), this.emit("before-remove", t3), t3.defaultPrevented && (h2.splice(s3, 1), i2.splice(e2, 0, n2), e2 += 1, s3 -= 1, r3 -= 1);
        b$16.release(t3);
      }
      if (this.length = this._items.length, this.hasEventListener("after-remove")) {
        const e3 = b$16.acquire();
        e3.target = this, e3.cancellable = false;
        const t3 = h2.length;
        for (let s3 = 0; s3 < t3; s3++)
          e3.reset(h2[s3]), this.emit("after-remove", e3);
        b$16.release(e3);
      }
    }
    if (s2 && s2.length) {
      if (r2) {
        const e3 = [];
        for (const t4 of s2) {
          const s3 = r2.ensureType(t4);
          s3 == null && t4 != null || e3.push(s3);
        }
        s2 = e3;
      }
      const t3 = this.hasEventListener("before-add"), n3 = this.hasEventListener("after-add"), h3 = e2 === this.length;
      if (t3 || n3) {
        const r3 = b$16.acquire();
        r3.target = this, r3.cancellable = true;
        const o2 = b$16.acquire();
        o2.target = this, o2.cancellable = false;
        for (const l2 of s2)
          t3 ? (r3.reset(l2), this.emit("before-add", r3), r3.defaultPrevented || (h3 ? i2.push(l2) : i2.splice(e2++, 0, l2), this._set("length", i2.length), n3 && (o2.reset(l2), this.emit("after-add", o2)))) : (h3 ? i2.push(l2) : i2.splice(e2++, 0, l2), this._set("length", i2.length), o2.reset(l2), this.emit("after-add", o2));
        b$16.release(o2), b$16.release(r3);
      } else {
        if (h3)
          for (const e3 of s2)
            i2.push(e3);
        else
          i2.splice(e2, 0, ...s2);
        this._set("length", i2.length);
      }
    }
    return (s2 && s2.length || h2 && h2.length) && this._notifyChangeEvent(s2, h2), h2;
  }
  _emitBeforeChanges(e2) {
    let t2 = false;
    if (this.hasEventListener("before-changes")) {
      const s2 = b$16.acquire();
      s2.target = this, s2.cancellable = true, s2.type = e2, this.emit("before-changes", s2), t2 = s2.defaultPrevented, b$16.release(s2);
    }
    return t2;
  }
  _emitAfterChanges(e2) {
    if (this.hasEventListener("after-changes")) {
      const t2 = b$16.acquire();
      t2.target = this, t2.cancellable = false, t2.type = e2, this.emit("after-changes", t2), b$16.release(t2);
    }
    this._observable.notify();
  }
  _notifyChangeEvent(e2, t2) {
    this.hasEventListener("change") && this._notifications && this._notifications[this._notifications.length - 1].changes.push({ added: e2, removed: t2 });
  }
  _dispatchChange() {
    if (this._timer && (this._timer.remove(), this._timer = null), !this._notifications)
      return;
    const e2 = this._notifications;
    this._notifications = null;
    for (const s2 of e2) {
      const e3 = s2.changes;
      A$y.clear(), O$C.clear(), M$I.clear();
      for (const { added: t2, removed: s3 } of e3) {
        if (t2)
          if (M$I.size === 0 && O$C.size === 0)
            for (const e4 of t2)
              A$y.add(e4);
          else
            for (const e4 of t2)
              O$C.has(e4) ? (M$I.add(e4), O$C.delete(e4)) : M$I.has(e4) || A$y.add(e4);
        if (s3)
          if (M$I.size === 0 && A$y.size === 0)
            for (const e4 of s3)
              O$C.add(e4);
          else
            for (const e4 of s3)
              A$y.has(e4) ? A$y.delete(e4) : (M$I.delete(e4), O$C.add(e4));
      }
      const i2 = t$2c.acquire();
      A$y.forEach((e4) => {
        i2.push(e4);
      });
      const r2 = t$2c.acquire();
      O$C.forEach((e4) => {
        r2.push(e4);
      });
      const n2 = this._items, h2 = s2.items, o2 = t$2c.acquire();
      if (M$I.forEach((e4) => {
        h2.indexOf(e4) !== n2.indexOf(e4) && o2.push(e4);
      }), s2.listeners && (i2.length || r2.length || o2.length)) {
        const e4 = { target: this, added: i2, removed: r2, moved: o2 }, t2 = s2.listeners.length;
        for (let i3 = 0; i3 < t2; i3++) {
          const t3 = s2.listeners[i3];
          t3.removed || t3.callback.call(this, e4);
        }
      }
      t$2c.release(i2), t$2c.release(r2), t$2c.release(o2);
    }
    A$y.clear(), O$C.clear(), M$I.clear();
  }
};
V$o.ofType = (t2) => {
  if (!t2)
    return g$1c;
  if (D$A.has(t2))
    return D$A.get(t2);
  let s2 = null;
  if (typeof t2 == "function")
    s2 = t2.prototype.declaredClass;
  else if (t2.base)
    s2 = t2.base.prototype.declaredClass;
  else
    for (const e2 in t2.typeMap) {
      const i3 = t2.typeMap[e2].prototype.declaredClass;
      s2 ? s2 += ` | ${i3}` : s2 = i3;
    }
  let i2 = class extends g$1c {
  };
  return e$2g([n$2F({ Type: t2, ensureType: typeof t2 == "function" ? b$1a(t2) : S$V(t2) })], i2.prototype, "itemType", void 0), i2 = e$2g([n$2P(`esri.core.Collection<${s2}>`)], i2), D$A.set(t2, i2), i2;
}, e$2g([y$1I()], V$o.prototype, "length", void 0), e$2g([y$1I()], V$o.prototype, "items", null), V$o = g$1c = e$2g([n$2P("esri.core.Collection")], V$o);
const j$V = V$o;
var e$1P;
function n$2E(n2, a2) {
  switch (n2.type) {
    case "range": {
      const r2 = "range" in n2 ? n2.range[0] : n2.minValue, u2 = "range" in n2 ? n2.range[1] : n2.maxValue;
      if (r2 != null && +a2 < r2 || u2 != null && +a2 > u2)
        return e$1P.VALUE_OUT_OF_RANGE;
      break;
    }
    case "coded-value":
    case "codedValue":
      if (n2.codedValues == null || n2.codedValues.every((e2) => e2 == null || e2.code !== a2))
        return e$1P.INVALID_CODED_VALUE;
  }
  return null;
}
!function(e2) {
  e2.VALUE_OUT_OF_RANGE = "domain-validation-error::value-out-of-range", e2.INVALID_CODED_VALUE = "domain-validation-error::invalid-coded-value";
}(e$1P || (e$1P = {}));
const s$28 = s$2z.getLogger("esri.support.arcadeOnDemand");
let c$31;
function i$2P() {
  return c$31 || (c$31 = (async () => {
    const e2 = await import("./arcadeUtils.js").then(function(n2) {
      return n2.ay;
    });
    return { arcade: e2.arcade, arcadeUtils: e2, Dictionary: e2.Dictionary, Feature: e2.arcadeFeature };
  })()), c$31;
}
const n$2D = (e2, r2, t2) => p$3t.create(e2, r2, t2, null, ["$feature"]), o$1Z = (e2, r2, t2) => p$3t.create(e2, r2, t2, null, ["$feature", "$view"]), u$1$ = (e2, r2, t2, a2) => p$3t.create(e2, r2, t2, a2, ["$feature", "$view"]);
class p$3t {
  constructor(e2, r2, t2, a2, s2, c2, i2, n2) {
    this.script = e2, this.evaluate = s2;
    const o2 = Array.isArray(i2) ? i2 : i2.fields;
    this.fields = o2, this._syntaxTree = a2, this._arcade = r2, this._arcadeDictionary = t2, this._arcadeFeature = c2, this._spatialReference = n2, this._referencesGeometry = r2.scriptTouchesGeometry(this._syntaxTree), this._referencesScale = this._arcade.referencesMember(this._syntaxTree, "scale");
  }
  static async create(r2, c2, n2, o2, l2, u2) {
    const { arcade: d2, Feature: m2, Dictionary: f2 } = await i$2P(), y2 = k$C.fromJSON(c2);
    let h2 = null;
    try {
      h2 = d2.parseScript(r2, u2);
    } catch (R2) {
      return s$28.error(new s$2u("arcade-bad-expression", "Failed to parse arcade script", { script: r2, error: R2 })), null;
    }
    const _2 = l2.reduce((e2, r3) => __spreadProps(__spreadValues({}, e2), { [r3]: null }), {});
    let w2 = null;
    r$1$(o2) && (w2 = new f2(o2), w2.immutable = true, _2.$config = null);
    const F2 = d2.scriptUsesGeometryEngine(h2), g2 = F2 && d2.enableGeometrySupport(), S2 = d2.scriptUsesFeatureSet(h2) && d2.enableFeatureSetSupport(), b2 = d2.scriptIsAsync(h2), x2 = b2 && d2.enableAsyncSupport(), $2 = { vars: _2, spatialReference: y2, useAsync: !!x2 };
    await Promise.all([g2, S2, x2]);
    const v2 = new Set();
    await d2.loadDependentModules(v2, h2, null, b2, F2);
    const D2 = new f2();
    D2.immutable = false, D2.setField("scale", 0);
    const j2 = d2.compileScript(h2, $2), G2 = (e2) => ("$view" in e2 && e2.$view && (D2.setField("scale", e2.$view.scale), e2.$view = D2), w2 && (e2.$config = w2), j2({ vars: e2, spatialReference: y2 }));
    return new p$3t(r2, d2, f2, h2, G2, new m2(), n2, y2);
  }
  repurposeFeature(e2) {
    return e2.geometry && !e2.geometry.spatialReference && (e2.geometry.spatialReference = this._spatialReference), this._arcadeFeature.repurposeFromGraphicLikeObject(e2.geometry, e2.attributes, { fields: this.fields }), this._arcadeFeature;
  }
  createDictionary() {
    return new this._arcadeDictionary();
  }
  referencesMember(e2) {
    return this._arcade.referencesMember(this._syntaxTree, e2);
  }
  referencesFunction(e2) {
    return this._arcade.referencesFunction(this._syntaxTree, e2);
  }
  referencesGeometry() {
    return this._referencesGeometry;
  }
  referencesScale() {
    return this._referencesScale;
  }
  extractFieldLiterals() {
    return this._arcade.extractExpectedFieldLiterals(this._syntaxTree);
  }
}
const f$1G = /^([0-9])/, u$1_ = /[^A-Za-z0-9_\u0080-\uffff]/g, c$30 = /_{2,}/g, d$1N = /^_/, m$2h = /_$/;
function p$3s(e2) {
  return e2 ? e2.trim().replace(u$1_, "_").replace(c$30, "_").replace(d$1N, "").replace(m$2h, "").replace(f$1G, "F$1") : null;
}
const y$1r = ["field", "field2", "field3", "normalizationField", "rotationInfo.field", "proportionalSymbolInfo.field", "proportionalSymbolInfo.normalizationField", "colorInfo.field", "colorInfo.normalizationField"], g$1b = ["field", "normalizationField"];
function F$B(e2, n2) {
  if (e2 != null && n2 != null) {
    for (const i2 of Array.isArray(e2) ? e2 : [e2])
      if (I$J(y$1r, i2, n2), "visualVariables" in i2 && i2.visualVariables)
        for (const e3 of i2.visualVariables)
          I$J(g$1b, e3, n2);
  }
}
function I$J(e2, n2, i2) {
  if (e2)
    for (const l2 of e2) {
      const e3 = t$2o(l2, n2), o2 = e3 && typeof e3 != "function" && i2.get(e3);
      o2 && o$2q(l2, o2.name, n2);
    }
}
function x$V(e2, n2) {
  var _a2, _b2, _c2, _d2, _e3;
  if (e2 != null && ((_a2 = n2 == null ? void 0 : n2.fields) == null ? void 0 : _a2.length))
    if ("startField" in e2) {
      const i2 = n2.get(e2.startField), t2 = n2.get(e2.endField);
      e2.startField = (_b2 = i2 == null ? void 0 : i2.name) != null ? _b2 : null, e2.endField = (_c2 = t2 == null ? void 0 : t2.name) != null ? _c2 : null;
    } else {
      const i2 = n2.get(e2.startTimeField), t2 = n2.get(e2.endTimeField);
      e2.startTimeField = (_d2 = i2 == null ? void 0 : i2.name) != null ? _d2 : null, e2.endTimeField = (_e3 = t2 == null ? void 0 : t2.name) != null ? _e3 : null;
    }
}
const b$15 = new Set();
function T$C(e2, n2) {
  return e2 && n2 ? (b$15.clear(), h$1G(b$15, e2, n2), Array.from(b$15).sort()) : [];
}
function h$1G(e2, n2, i2) {
  var _a2;
  if (i2)
    if ((_a2 = n2 == null ? void 0 : n2.fields) == null ? void 0 : _a2.length)
      if (i2.includes("*"))
        for (const { name: t2 } of n2.fields)
          e2.add(t2);
      else
        for (const t2 of i2)
          w$X(e2, n2, t2);
    else {
      if (i2.includes("*"))
        return e2.clear(), void e2.add("*");
      for (const n3 of i2)
        n3 != null && e2.add(n3);
    }
}
function w$X(e2, n2, i2) {
  if (typeof i2 == "string")
    if (n2) {
      const t2 = n2.get(i2);
      t2 && e2.add(t2.name);
    } else
      e2.add(i2);
}
function v$12(e2, i2) {
  var _a2;
  return t$2r(i2) || t$2r(e2) ? [] : i2.includes("*") ? ((_a2 = e2.fields) != null ? _a2 : []).map((e3) => e3.name) : i2;
}
async function S$Q(e2, n2, i2) {
  var _a2;
  if (!i2)
    return;
  const { arcadeUtils: t2 } = await i$2P(), r2 = t2.extractFieldNames(i2, (_a2 = n2 == null ? void 0 : n2.fields) == null ? void 0 : _a2.map((e3) => e3.name));
  for (const l2 of r2)
    w$X(e2, n2, l2);
}
async function _$M(n2, i2, t2) {
  if (t2 && t2 !== "1=1") {
    const r2 = (await Promise.resolve().then(function() {
      return WhereClause;
    })).WhereClause.create(t2, i2);
    if (!r2.isStandardized)
      throw new s$2u("fieldUtils:collectFilterFields", "Where clause is not standardized", { where: t2 });
    h$1G(n2, i2, r2.fieldNames);
  }
}
function E$M({ displayField: e2, fields: n2 }) {
  return e2 || (n2 && n2.length ? $$k(n2, "name-or-title") || $$k(n2, "unique-identifier") || $$k(n2, "type-or-category") || N$u(n2) : null);
}
function N$u(e2) {
  for (const n2 of e2) {
    if (!n2 || !n2.name)
      continue;
    const e3 = n2.name.toLowerCase();
    if (e3.includes("name") || e3.includes("title"))
      return n2.name;
  }
  return null;
}
function $$k(e2, n2) {
  for (const i2 of e2)
    if (i2 && i2.valueType && i2.valueType === n2)
      return i2.name;
  return null;
}
async function D$z(e2, n2) {
  if (!n2)
    return;
  const i2 = t$2o("elevationInfo.featureExpressionInfo", n2);
  return i2 ? i2.collectRequiredFields(e2, n2.fieldsIndex) : void 0;
}
function L$y(e2, n2, i2) {
  i2.onStatisticExpression ? S$Q(e2, n2, i2.onStatisticExpression.expression) : e2.add(i2.onStatisticField);
}
async function O$B(e2, n2, i2) {
  if (!n2 || !i2 || !("fields" in i2))
    return;
  const t2 = [], r2 = i2.popupTemplate;
  t2.push(U$x(e2, n2, r2)), i2.fields && t2.push(...i2.fields.map(async (i3) => L$y(e2, n2.fieldsIndex, i3))), await Promise.all(t2);
}
async function U$x(e2, n2, i2) {
  const t2 = [];
  (i2 == null ? void 0 : i2.expressionInfos) && t2.push(...i2.expressionInfos.map((i3) => S$Q(e2, n2.fieldsIndex, i3.expression)));
  const r2 = i2 == null ? void 0 : i2.content;
  if (Array.isArray(r2))
    for (const l2 of r2)
      l2.type === "expression" && l2.expressionInfo && t2.push(S$Q(e2, n2.fieldsIndex, l2.expressionInfo.expression));
  await Promise.all(t2);
}
async function j$U(e2, n2, t2) {
  n2 && (n2.timeInfo && r$1$(t2) && t2.timeExtent && h$1G(e2, n2.fieldsIndex, [n2.timeInfo.startField, n2.timeInfo.endField]), n2.floorInfo && h$1G(e2, n2.fieldsIndex, [n2.floorInfo.floorField]), r$1$(t2) && r$1$(t2.where) && await _$M(e2, n2.fieldsIndex, t2.where));
}
async function z$H(e2, n2, i2) {
  n2 && i2 && await Promise.all(i2.map((i3) => P$C(e2, n2, i3)));
}
async function P$C(e2, n2, i2) {
  n2 && i2 && (i2.valueExpression ? await S$Q(e2, n2.fieldsIndex, i2.valueExpression) : i2.field && w$X(e2, n2.fieldsIndex, i2.field));
}
function C$B(e2) {
  if (!e2)
    return [];
  const n2 = "editFieldsInfo" in e2 && e2.editFieldsInfo;
  return n2 ? T$C(e2.fieldsIndex, [n2 && n2.creatorField, n2 && n2.creationDateField, n2 && n2.editorField, n2 && n2.editDateField]) : [];
}
async function W$h(e2, n2) {
  const { labelingInfo: i2, fieldsIndex: t2 } = n2;
  i2 && i2.length && await Promise.all(i2.map((n3) => q$r(e2, t2, n3)));
}
async function q$r(e2, n2, i2) {
  if (!i2)
    return;
  const t2 = i2.getLabelExpression(), r2 = i2.where;
  if (t2.type === "arcade")
    await S$Q(e2, n2, t2.expression);
  else {
    const i3 = t2.expression.match(/{[^}]*}/g);
    i3 && i3.forEach((i4) => {
      w$X(e2, n2, i4.slice(1, -1));
    });
  }
  await _$M(e2, n2, r2);
}
function M$H(e2) {
  const n2 = e2.defaultValue;
  return n2 !== void 0 && Q$j(e2, n2) ? n2 : e2.nullable ? null : void 0;
}
function Y$h(e2) {
  return typeof e2 == "number" && !isNaN(e2) && isFinite(e2);
}
function J$r(e2) {
  return e2 === null || Y$h(e2);
}
const X$g = "isInteger" in Number ? Number.isInteger : (e2) => typeof e2 == "number" && isFinite(e2) && Math.floor(e2) === e2;
function Z$i(e2) {
  return e2 === null || X$g(e2);
}
function B$x(e2) {
  return e2 != null && typeof e2 == "string";
}
function H$l(e2) {
  return e2 === null || B$x(e2);
}
function K$j() {
  return true;
}
function Q$j(e2, n2) {
  let i2;
  switch (e2.type) {
    case "date":
    case "integer":
    case "long":
    case "small-integer":
    case "esriFieldTypeDate":
    case "esriFieldTypeInteger":
    case "esriFieldTypeLong":
    case "esriFieldTypeSmallInteger":
      i2 = e2.nullable ? Z$i : X$g;
      break;
    case "double":
    case "single":
    case "esriFieldTypeSingle":
    case "esriFieldTypeDouble":
      i2 = e2.nullable ? J$r : Y$h;
      break;
    case "string":
    case "esriFieldTypeString":
      i2 = e2.nullable ? H$l : B$x;
      break;
    default:
      i2 = K$j;
  }
  return arguments.length === 1 ? i2 : i2(n2);
}
const ee$6 = ["integer", "small-integer", "single", "double"], ne$5 = new Set([...ee$6, "esriFieldTypeInteger", "esriFieldTypeSmallInteger", "esriFieldTypeSingle", "esriFieldTypeDouble"]);
function ie$6(e2) {
  return e2 != null && ne$5.has(e2.type);
}
function te$6(e2) {
  return e2 != null && (e2.type === "string" || e2.type === "esriFieldTypeString");
}
var oe$6, se$4;
function ae$5(e2) {
  return e2 == null || typeof e2 == "number" && isNaN(e2) ? null : e2;
}
function fe$2(e2, n2) {
  return e2.nullable && n2 === null ? null : ie$6(e2) && !ue$5(e2.type, Number(n2)) ? oe$6.OUT_OF_RANGE : Q$j(e2, n2) ? e2.domain ? n$2E(e2.domain, n2) : null : se$4.INVALID_TYPE;
}
function ue$5(e2, n2) {
  const i2 = typeof e2 == "string" ? de$3(e2) : e2;
  if (!i2)
    return false;
  const t2 = i2.min, r2 = i2.max;
  return i2.isInteger ? X$g(n2) && n2 >= t2 && n2 <= r2 : n2 >= t2 && n2 <= r2;
}
function de$3(e2) {
  switch (e2) {
    case "esriFieldTypeSmallInteger":
    case "small-integer":
      return pe$3;
    case "esriFieldTypeInteger":
    case "integer":
      return ye$4;
    case "esriFieldTypeSingle":
    case "single":
      return ge$3;
    case "esriFieldTypeDouble":
    case "double":
      return Fe$1;
  }
}
!function(e2) {
  e2.OUT_OF_RANGE = "numeric-range-validation-error::out-of-range";
}(oe$6 || (oe$6 = {})), function(e2) {
  e2.INVALID_TYPE = "type-validation-error::invalid-type";
}(se$4 || (se$4 = {}));
const pe$3 = { min: -32768, max: 32767, isInteger: true }, ye$4 = { min: -2147483648, max: 2147483647, isInteger: true }, ge$3 = { min: -34e37, max: 12e37, isInteger: false }, Fe$1 = { min: -Number.MAX_VALUE, max: Number.MAX_VALUE, isInteger: false };
function Ie$1(e2, n2, i2) {
  switch (e2) {
    case e$1P.INVALID_CODED_VALUE:
      return `Value ${i2} is not in the coded domain - field: ${n2.name}, domain: ${JSON.stringify(n2.domain)}`;
    case e$1P.VALUE_OUT_OF_RANGE:
      return `Value ${i2} is out of the range of valid values - field: ${n2.name}, domain: ${JSON.stringify(n2.domain)}`;
    case se$4.INVALID_TYPE:
      return `Value ${i2} is not a valid value for the field type - field: ${n2.name}, type: ${n2.type}, nullable: ${n2.nullable}`;
    case oe$6.OUT_OF_RANGE: {
      const { min: e3, max: t2 } = de$3(n2.type);
      return `Value ${i2} is out of range for the number type - field: ${n2.name}, type: ${n2.type}, value range is ${e3} to ${t2}`;
    }
  }
}
function xe$1(e2, n2) {
  return !be$1(e2, n2, null);
}
function be$1(e2, n2, t2) {
  if (!n2 || !n2.attributes || !e2) {
    if (r$1$(t2))
      for (const n3 of e2 != null ? e2 : [])
        t2.add(n3);
    return true;
  }
  const r2 = n2.attributes;
  let l2 = false;
  for (const o2 of e2)
    if (!(o2 in r2)) {
      if (l2 = true, !r$1$(t2))
        break;
      t2.add(o2);
    }
  return l2;
}
function he$2(e2) {
  return ["raster.itempixelvalue", "raster.servicepixelvalue"].some((n2) => e2.toLowerCase().startsWith(n2));
}
let e$1O = class extends l$2B {
  constructor(r2) {
    super(r2), this.type = null;
  }
};
e$2g([y$1I({ type: ["attachments", "custom", "fields", "media", "text", "expression", "relationship"], readOnly: true, json: { read: false, write: true } })], e$1O.prototype, "type", void 0), e$1O = e$2g([n$2P("esri.popup.content.Content")], e$1O);
const p$3r = e$1O;
var s$27;
let p$3q = s$27 = class extends p$3r {
  constructor(t2) {
    super(t2), this.description = null, this.displayType = "auto", this.title = null, this.type = "attachments";
  }
  clone() {
    return new s$27({ description: this.description, displayType: this.displayType, title: this.title });
  }
};
e$2g([y$1I({ type: String, json: { write: true } })], p$3q.prototype, "description", void 0), e$2g([y$1I({ type: ["auto", "preview", "list"], json: { write: true } })], p$3q.prototype, "displayType", void 0), e$2g([y$1I({ type: String, json: { write: true } })], p$3q.prototype, "title", void 0), e$2g([y$1I({ type: ["attachments"], readOnly: true, json: { read: false, write: true } })], p$3q.prototype, "type", void 0), p$3q = s$27 = e$2g([n$2P("esri.popup.content.AttachmentsContent")], p$3q);
const i$2O = p$3q;
var p$3p;
let c$2$ = p$3p = class extends p$3r {
  constructor(o2) {
    super(o2), this.creator = null, this.destroyer = null, this.outFields = null, this.type = "custom";
  }
  clone() {
    return new p$3p({ creator: this.creator, destroyer: this.destroyer, outFields: Array.isArray(this.outFields) ? y$1L(this.outFields) : null });
  }
};
e$2g([y$1I()], c$2$.prototype, "creator", void 0), e$2g([y$1I()], c$2$.prototype, "destroyer", void 0), e$2g([y$1I()], c$2$.prototype, "outFields", void 0), e$2g([y$1I({ type: ["custom"], readOnly: true })], c$2$.prototype, "type", void 0), c$2$ = p$3p = e$2g([n$2P("esri.popup.content.CustomContent")], c$2$);
const i$2N = c$2$;
var s$26;
let p$3o = s$26 = class extends l$2B {
  constructor(r2) {
    super(r2), this.title = null, this.expression = null, this.returnType = "dictionary";
  }
  clone() {
    return new s$26({ title: this.title, expression: this.expression });
  }
};
e$2g([y$1I({ type: String, json: { write: true } })], p$3o.prototype, "title", void 0), e$2g([y$1I({ type: String, json: { write: true } })], p$3o.prototype, "expression", void 0), e$2g([y$1I({ type: ["dictionary"], readOnly: true, json: { read: false, write: true } })], p$3o.prototype, "returnType", void 0), p$3o = s$26 = e$2g([n$2P("esri.popup.ElementExpressionInfo")], p$3o);
const i$2M = p$3o;
var p$3n;
let n$2C = p$3n = class extends p$3r {
  constructor(o2) {
    super(o2), this.expressionInfo = null, this.type = "expression";
  }
  clone() {
    var _a2;
    return new p$3n({ expressionInfo: (_a2 = this.expressionInfo) == null ? void 0 : _a2.clone() });
  }
};
e$2g([y$1I({ type: i$2M, json: { write: true } })], n$2C.prototype, "expressionInfo", void 0), e$2g([y$1I({ type: ["expression"], readOnly: true, json: { read: false, write: true } })], n$2C.prototype, "type", void 0), n$2C = p$3n = e$2g([n$2P("esri.popup.content.ExpressionContent")], n$2C);
const i$2L = n$2C;
function r$1H(r2, o2 = {}) {
  var _a2;
  const a2 = r2 instanceof s$2a ? r2 : new s$2a(r2, o2), t2 = { type: ((_a2 = o2 == null ? void 0 : o2.ignoreUnknown) != null ? _a2 : 1) ? a2.apiValues : String, json: { type: a2.jsonValues, read: !(o2 == null ? void 0 : o2.readOnly) && { reader: a2.read }, write: { writer: a2.write } } };
  return (o2 == null ? void 0 : o2.readOnly) !== void 0 && (t2.readOnly = !!o2.readOnly), (o2 == null ? void 0 : o2.default) !== void 0 && (t2.json.default = o2.default), (o2 == null ? void 0 : o2.name) !== void 0 && (t2.json.name = o2.name), y$1I(t2);
}
const a$2M = o$1_()({ shortDate: "short-date", shortDateShortTime: "short-date-short-time", shortDateShortTime24: "short-date-short-time-24", shortDateLongTime: "short-date-long-time", shortDateLongTime24: "short-date-long-time-24", shortDateLE: "short-date-le", shortDateLEShortTime: "short-date-le-short-time", shortDateLEShortTime24: "short-date-le-short-time-24", shortDateLELongTime: "short-date-le-long-time", shortDateLELongTime24: "short-date-le-long-time-24", longMonthDayYear: "long-month-day-year", longMonthDayYearShortTime: "long-month-day-year-short-time", longMonthDayYearShortTime24: "long-month-day-year-short-time-24", longMonthDayYearLongTime: "long-month-day-year-long-time", longMonthDayYearLongTime24: "long-month-day-year-long-time-24", dayShortMonthYear: "day-short-month-year", dayShortMonthYearShortTime: "day-short-month-year-short-time", dayShortMonthYearShortTime24: "day-short-month-year-short-time-24", dayShortMonthYearLongTime: "day-short-month-year-long-time", dayShortMonthYearLongTime24: "day-short-month-year-long-time-24", longDate: "long-date", longDateShortTime: "long-date-short-time", longDateShortTime24: "long-date-short-time-24", longDateLongTime: "long-date-long-time", longDateLongTime24: "long-date-long-time-24", longMonthYear: "long-month-year", shortMonthYear: "short-month-year", year: "year" });
a$2M.toJSON.bind(a$2M);
a$2M.fromJSON.bind(a$2M);
let o$1Y;
const e$1N = (_h = (_f = globalThis.esriConfig) == null ? void 0 : _f.locale) != null ? _h : (_g = globalThis.dojoConfig) == null ? void 0 : _g.locale;
function t$1X() {
  var _a2, _b2;
  return (_b2 = e$1N != null ? e$1N : (_a2 = globalThis.navigator) == null ? void 0 : _a2.language) != null ? _b2 : "en";
}
function l$2r() {
  return o$1Y === void 0 && (o$1Y = t$1X()), o$1Y;
}
const u$1Z = [];
function s$25(n2) {
  return u$1Z.push(n2), { remove() {
    u$1Z.splice(u$1Z.indexOf(n2), 1);
  } };
}
const f$1F = [];
function g$1a(n2) {
  return f$1F.push(n2), { remove() {
    u$1Z.splice(f$1F.indexOf(n2), 1);
  } };
}
function h$1F() {
  const e2 = t$1X();
  o$1Y !== e2 && (o$1Y = e2, [...f$1F].forEach((n2) => {
    n2.call(null, e2);
  }), [...u$1Z].forEach((n2) => {
    n2.call(null, e2);
  }));
}
(_i = globalThis.addEventListener) == null ? void 0 : _i.call(globalThis, "languagechange", h$1F);
const r$1G = { year: "numeric", month: "numeric", day: "numeric" }, n$2B = { year: "numeric", month: "long", day: "numeric" }, a$2L = { year: "numeric", month: "short", day: "numeric" }, h$1E = { year: "numeric", month: "long", weekday: "long", day: "numeric" }, m$2g = { hour: "numeric", minute: "numeric" }, i$2K = __spreadProps(__spreadValues({}, m$2g), { second: "numeric" }), s$24 = { "short-date": r$1G, "short-date-short-time": __spreadValues(__spreadValues({}, r$1G), m$2g), "short-date-short-time-24": __spreadProps(__spreadValues(__spreadValues({}, r$1G), m$2g), { hour12: false }), "short-date-long-time": __spreadValues(__spreadValues({}, r$1G), i$2K), "short-date-long-time-24": __spreadProps(__spreadValues(__spreadValues({}, r$1G), i$2K), { hour12: false }), "short-date-le": r$1G, "short-date-le-short-time": __spreadValues(__spreadValues({}, r$1G), m$2g), "short-date-le-short-time-24": __spreadProps(__spreadValues(__spreadValues({}, r$1G), m$2g), { hour12: false }), "short-date-le-long-time": __spreadValues(__spreadValues({}, r$1G), i$2K), "short-date-le-long-time-24": __spreadProps(__spreadValues(__spreadValues({}, r$1G), i$2K), { hour12: false }), "long-month-day-year": n$2B, "long-month-day-year-short-time": __spreadValues(__spreadValues({}, n$2B), m$2g), "long-month-day-year-short-time-24": __spreadProps(__spreadValues(__spreadValues({}, n$2B), m$2g), { hour12: false }), "long-month-day-year-long-time": __spreadValues(__spreadValues({}, n$2B), i$2K), "long-month-day-year-long-time-24": __spreadProps(__spreadValues(__spreadValues({}, n$2B), i$2K), { hour12: false }), "day-short-month-year": a$2L, "day-short-month-year-short-time": __spreadValues(__spreadValues({}, a$2L), m$2g), "day-short-month-year-short-time-24": __spreadProps(__spreadValues(__spreadValues({}, a$2L), m$2g), { hour12: false }), "day-short-month-year-long-time": __spreadValues(__spreadValues({}, a$2L), i$2K), "day-short-month-year-long-time-24": __spreadProps(__spreadValues(__spreadValues({}, a$2L), i$2K), { hour12: false }), "long-date": h$1E, "long-date-short-time": __spreadValues(__spreadValues({}, h$1E), m$2g), "long-date-short-time-24": __spreadProps(__spreadValues(__spreadValues({}, h$1E), m$2g), { hour12: false }), "long-date-long-time": __spreadValues(__spreadValues({}, h$1E), i$2K), "long-date-long-time-24": __spreadProps(__spreadValues(__spreadValues({}, h$1E), i$2K), { hour12: false }), "long-month-year": { month: "long", year: "numeric" }, "short-month-year": { month: "short", year: "numeric" }, year: { year: "numeric" }, "short-time": m$2g, "long-time": i$2K }, l$2q = o$1_()({ shortDate: "short-date", shortDateShortTime: "short-date-short-time", shortDateShortTime24: "short-date-short-time-24", shortDateLongTime: "short-date-long-time", shortDateLongTime24: "short-date-long-time-24", shortDateLE: "short-date-le", shortDateLEShortTime: "short-date-le-short-time", shortDateLEShortTime24: "short-date-le-short-time-24", shortDateLELongTime: "short-date-le-long-time", shortDateLELongTime24: "short-date-le-long-time-24", longMonthDayYear: "long-month-day-year", longMonthDayYearShortTime: "long-month-day-year-short-time", longMonthDayYearShortTime24: "long-month-day-year-short-time-24", longMonthDayYearLongTime: "long-month-day-year-long-time", longMonthDayYearLongTime24: "long-month-day-year-long-time-24", dayShortMonthYear: "day-short-month-year", dayShortMonthYearShortTime: "day-short-month-year-short-time", dayShortMonthYearShortTime24: "day-short-month-year-short-time-24", dayShortMonthYearLongTime: "day-short-month-year-long-time", dayShortMonthYearLongTime24: "day-short-month-year-long-time-24", longDate: "long-date", longDateShortTime: "long-date-short-time", longDateShortTime24: "long-date-short-time-24", longDateLongTime: "long-date-long-time", longDateLongTime24: "long-date-long-time-24", longMonthYear: "long-month-year", shortMonthYear: "short-month-year", year: "year" });
l$2q.apiValues;
l$2q.toJSON.bind(l$2q);
l$2q.fromJSON.bind(l$2q);
const u$1Y = { ar: "ar-u-nu-latn-ca-gregory" };
let c$2_ = new WeakMap(), D$y = s$24["short-date-short-time"];
function T$B(t2) {
  const o2 = t2 || D$y;
  let r2 = c$2_.get(o2);
  if (!r2) {
    const t3 = l$2r(), n2 = u$1Y[l$2r()] || t3;
    r2 = new Intl.DateTimeFormat(n2, o2), c$2_.set(o2, r2);
  }
  return r2;
}
function S$P(t2) {
  return t2 ? s$24[t2] : null;
}
function L$x(t2, o2) {
  return T$B(o2).format(t2);
}
g$1a(() => {
  c$2_ = new WeakMap(), D$y = s$24["short-date-short-time"];
});
const a$2K = { ar: "ar-u-nu-latn" };
let e$1M = new WeakMap(), o$1X = {};
function i$2J(n2) {
  const i2 = n2 || o$1X;
  if (!e$1M.has(i2)) {
    const t2 = l$2r(), o2 = a$2K[l$2r()] || t2;
    e$1M.set(i2, new Intl.NumberFormat(o2, n2));
  }
  return x$16(e$1M.get(i2));
}
function u$1X(t2 = {}) {
  const n2 = {};
  return t2.digitSeparator != null && (n2.useGrouping = t2.digitSeparator), t2.places != null && (n2.minimumFractionDigits = n2.maximumFractionDigits = t2.places), n2;
}
function m$2f(t2, n2) {
  return t2 === -0 && (t2 = 0), i$2J(n2).format(t2);
}
g$1a(() => {
  e$1M = new WeakMap(), o$1X = {};
});
var d$1M;
let l$2p = d$1M = class extends l$2B {
  constructor(t2) {
    super(t2), this.dateFormat = null, this.dateTimeFormatOptions = null, this.digitSeparator = false, this.places = null;
  }
  clone() {
    return new d$1M({ dateFormat: this.dateFormat, digitSeparator: this.digitSeparator, places: this.places });
  }
  format(t2) {
    return this.dateFormat ? L$x(t2, __spreadValues(__spreadValues({}, S$P(this.dateFormat)), this.dateTimeFormatOptions)) : m$2f(t2, u$1X(this));
  }
  formatRasterPixelValue(t2) {
    if (t2.includes("-"))
      return t2;
    let r2, o2;
    return t2.trim().includes(",") ? (r2 = ",", o2 = r2 + " ", this._formatDelimitedString(t2, r2, o2, this)) : t2.trim().includes(";") ? (r2 = ";", o2 = r2 + " ", this._formatDelimitedString(t2, r2, o2, this)) : t2.trim().includes(" ") ? (r2 = o2 = " ", this._formatDelimitedString(t2, r2, o2, this)) : this.format(Number(t2));
  }
  _formatDelimitedString(t2, r2, o2, e2) {
    return t2 && r2 && o2 && e2 ? t2.trim().split(r2).map((t3) => this.format(Number(t3))).join(o2) : t2;
  }
};
e$2g([r$1H(a$2M)], l$2p.prototype, "dateFormat", void 0), e$2g([y$1I({ type: Object, json: { read: false } })], l$2p.prototype, "dateTimeFormatOptions", void 0), e$2g([y$1I({ type: Boolean, json: { write: true } })], l$2p.prototype, "digitSeparator", void 0), e$2g([y$1I({ type: T$G, json: { write: true } })], l$2p.prototype, "places", void 0), l$2p = d$1M = e$2g([n$2P("esri.popup.support.FieldInfoFormat")], l$2p);
const u$1W = l$2p;
var a$2J;
let n$2A = a$2J = class extends l$2B {
  constructor(t2) {
    super(t2), this.fieldName = null, this.format = null, this.isEditable = false, this.label = null, this.stringFieldOption = "text-box", this.statisticType = null, this.tooltip = null, this.visible = true;
  }
  clone() {
    return new a$2J({ fieldName: this.fieldName, format: this.format ? y$1L(this.format) : null, isEditable: this.isEditable, label: this.label, stringFieldOption: this.stringFieldOption, statisticType: this.statisticType, tooltip: this.tooltip, visible: this.visible });
  }
};
e$2g([y$1I({ type: String, json: { write: true } })], n$2A.prototype, "fieldName", void 0), e$2g([y$1I({ type: u$1W, json: { write: true } })], n$2A.prototype, "format", void 0), e$2g([y$1I({ type: Boolean, json: { write: true, default: false } })], n$2A.prototype, "isEditable", void 0), e$2g([y$1I({ type: String, json: { write: true } })], n$2A.prototype, "label", void 0), e$2g([r$1H(new s$2a({ richtext: "rich-text", textarea: "text-area", textbox: "text-box" }), { default: "text-box" })], n$2A.prototype, "stringFieldOption", void 0), e$2g([y$1I({ type: ["count", "sum", "min", "max", "avg", "stddev", "var"], json: { write: true } })], n$2A.prototype, "statisticType", void 0), e$2g([y$1I({ type: String, json: { write: true } })], n$2A.prototype, "tooltip", void 0), e$2g([y$1I({ type: Boolean, json: { write: true } })], n$2A.prototype, "visible", void 0), n$2A = a$2J = e$2g([n$2P("esri.popup.FieldInfo")], n$2A);
const c$2Z = n$2A;
var n$2z;
let l$2o = n$2z = class extends p$3r {
  constructor(t2) {
    super(t2), this.attributes = null, this.description = null, this.fieldInfos = null, this.title = null, this.type = "fields";
  }
  writeFieldInfos(t2, o2) {
    o2.fieldInfos = t2 && t2.map((t3) => t3.toJSON());
  }
  clone() {
    return new n$2z(y$1L({ attributes: this.attributes, description: this.description, fieldInfos: this.fieldInfos, title: this.title }));
  }
};
e$2g([y$1I({ type: Object, json: { write: true } })], l$2o.prototype, "attributes", void 0), e$2g([y$1I({ type: String, json: { write: true } })], l$2o.prototype, "description", void 0), e$2g([y$1I({ type: [c$2Z] })], l$2o.prototype, "fieldInfos", void 0), e$2g([r$1P("fieldInfos")], l$2o.prototype, "writeFieldInfos", null), e$2g([y$1I({ type: String, json: { write: true } })], l$2o.prototype, "title", void 0), e$2g([y$1I({ type: ["fields"], readOnly: true, json: { read: false, write: true } })], l$2o.prototype, "type", void 0), l$2o = n$2z = e$2g([n$2P("esri.popup.content.FieldsContent")], l$2o);
const c$2Y = l$2o;
let s$23 = class extends l$2B {
  constructor(t2) {
    super(t2), this.altText = null, this.caption = "", this.title = "", this.type = null;
  }
};
e$2g([y$1I({ type: String, json: { write: true } })], s$23.prototype, "altText", void 0), e$2g([y$1I({ type: String, json: { write: true } })], s$23.prototype, "caption", void 0), e$2g([y$1I({ type: String, json: { write: true } })], s$23.prototype, "title", void 0), e$2g([y$1I({ type: ["image", "bar-chart", "column-chart", "line-chart", "pie-chart"], readOnly: true, json: { read: false, write: true } })], s$23.prototype, "type", void 0), s$23 = e$2g([n$2P("esri.popup.content.mixins.MediaInfo")], s$23);
const p$3m = s$23;
var s$22;
let p$3l = s$22 = class extends m$2q {
  constructor(o2) {
    super(o2), this.fieldName = null, this.tooltip = null, this.value = null;
  }
  clone() {
    return new s$22({ fieldName: this.fieldName, tooltip: this.tooltip, value: this.value });
  }
};
e$2g([y$1I()], p$3l.prototype, "fieldName", void 0), e$2g([y$1I()], p$3l.prototype, "tooltip", void 0), e$2g([y$1I()], p$3l.prototype, "value", void 0), p$3l = s$22 = e$2g([n$2P("esri.popup.content.support.ChartMediaInfoValueSeries")], p$3l);
const i$2I = p$3l;
var p$3k;
let l$2n = p$3k = class extends l$2B {
  constructor(o2) {
    super(o2), this.fields = [], this.normalizeField = null, this.series = [], this.tooltipField = null;
  }
  clone() {
    return new p$3k({ fields: y$1L(this.fields), normalizeField: this.normalizeField, tooltipField: this.tooltipField });
  }
};
e$2g([y$1I({ type: [String], json: { write: true } })], l$2n.prototype, "fields", void 0), e$2g([y$1I({ type: String, json: { write: true } })], l$2n.prototype, "normalizeField", void 0), e$2g([y$1I({ type: [i$2I], json: { read: false } })], l$2n.prototype, "series", void 0), e$2g([y$1I({ type: String, json: { write: true } })], l$2n.prototype, "tooltipField", void 0), l$2n = p$3k = e$2g([n$2P("esri.popup.content.support.ChartMediaInfoValue")], l$2n);
const n$2y = l$2n;
let p$3j = class extends p$3m {
  constructor(r2) {
    super(r2), this.type = null, this.value = null;
  }
};
e$2g([y$1I({ type: ["bar-chart", "column-chart", "line-chart", "pie-chart"], readOnly: true, json: { read: false, write: true } })], p$3j.prototype, "type", void 0), e$2g([y$1I({ type: n$2y, json: { write: true } })], p$3j.prototype, "value", void 0), p$3j = e$2g([n$2P("esri.popup.content.mixins.ChartMediaInfo")], p$3j);
const a$2I = p$3j;
const c$2X = o$1_()({ barchart: "bar-chart", columnchart: "column-chart", linechart: "line-chart", piechart: "pie-chart" });
var a$2H;
let p$3i = a$2H = class extends a$2I {
  constructor(t2) {
    super(t2), this.type = "bar-chart";
  }
  clone() {
    return new a$2H({ altText: this.altText, title: this.title, caption: this.caption, value: this.value ? this.value.clone() : null });
  }
};
e$2g([y$1I({ type: ["bar-chart"], readOnly: true, json: { type: ["barchart"], read: false, write: c$2X.write } })], p$3i.prototype, "type", void 0), p$3i = a$2H = e$2g([n$2P("esri.popup.content.BarChartMediaInfo")], p$3i);
const i$2H = p$3i;
var a$2G;
let p$3h = a$2G = class extends a$2I {
  constructor(t2) {
    super(t2), this.type = "column-chart";
  }
  clone() {
    return new a$2G({ altText: this.altText, title: this.title, caption: this.caption, value: this.value ? this.value.clone() : null });
  }
};
e$2g([y$1I({ type: ["column-chart"], readOnly: true, json: { type: ["columnchart"], read: false, write: c$2X.write } })], p$3h.prototype, "type", void 0), p$3h = a$2G = e$2g([n$2P("esri.popup.content.ColumnChartMediaInfo")], p$3h);
const c$2W = p$3h;
var e$1L;
let p$3g = e$1L = class extends l$2B {
  constructor(r2) {
    super(r2), this.linkURL = null, this.sourceURL = null;
  }
  clone() {
    return new e$1L({ linkURL: this.linkURL, sourceURL: this.sourceURL });
  }
};
e$2g([y$1I({ type: String, json: { write: true } })], p$3g.prototype, "linkURL", void 0), e$2g([y$1I({ type: String, json: { write: true } })], p$3g.prototype, "sourceURL", void 0), p$3g = e$1L = e$2g([n$2P("esri.popup.content.support.ImageMediaInfoValue")], p$3g);
const c$2V = p$3g;
var a$2F;
let i$2G = a$2F = class extends p$3m {
  constructor(e2) {
    super(e2), this.refreshInterval = null, this.type = "image", this.value = null;
  }
  clone() {
    return new a$2F({ altText: this.altText, title: this.title, caption: this.caption, refreshInterval: this.refreshInterval, value: this.value ? this.value.clone() : null });
  }
};
e$2g([y$1I({ type: Number, json: { write: true } })], i$2G.prototype, "refreshInterval", void 0), e$2g([y$1I({ type: ["image"], readOnly: true, json: { read: false, write: true } })], i$2G.prototype, "type", void 0), e$2g([y$1I({ type: c$2V, json: { write: true } })], i$2G.prototype, "value", void 0), i$2G = a$2F = e$2g([n$2P("esri.popup.content.ImageMediaInfo")], i$2G);
const p$3f = i$2G;
var i$2F;
let a$2E = i$2F = class extends a$2I {
  constructor(t2) {
    super(t2), this.type = "line-chart";
  }
  clone() {
    return new i$2F({ altText: this.altText, title: this.title, caption: this.caption, value: this.value ? this.value.clone() : null });
  }
};
e$2g([y$1I({ type: ["line-chart"], readOnly: true, json: { type: ["linechart"], read: false, write: c$2X.write } })], a$2E.prototype, "type", void 0), a$2E = i$2F = e$2g([n$2P("esri.popup.content.LineChartMediaInfo")], a$2E);
const p$3e = a$2E;
var p$3d;
let i$2E = p$3d = class extends a$2I {
  constructor(t2) {
    super(t2), this.type = "pie-chart";
  }
  clone() {
    return new p$3d({ altText: this.altText, title: this.title, caption: this.caption, value: this.value ? this.value.clone() : null });
  }
};
e$2g([y$1I({ type: ["pie-chart"], readOnly: true, json: { type: ["piechart"], read: false, write: c$2X.write } })], i$2E.prototype, "type", void 0), i$2E = p$3d = e$2g([n$2P("esri.popup.content.PieChartMediaInfo")], i$2E);
const a$2D = i$2E;
const m$2e = { base: p$3m, key: "type", defaultKeyValue: "image", typeMap: { "bar-chart": i$2H, "column-chart": c$2W, "line-chart": p$3e, "pie-chart": a$2D, image: p$3f } };
var l$2m;
let u$1V = l$2m = class extends p$3r {
  constructor(t2) {
    super(t2), this.activeMediaInfoIndex = null, this.attributes = null, this.description = null, this.mediaInfos = null, this.title = null, this.type = "media";
  }
  readMediaInfos(t2) {
    return t2 && t2.map((t3) => t3.type === "image" ? p$3f.fromJSON(t3) : t3.type === "barchart" ? i$2H.fromJSON(t3) : t3.type === "columnchart" ? c$2W.fromJSON(t3) : t3.type === "linechart" ? p$3e.fromJSON(t3) : t3.type === "piechart" ? a$2D.fromJSON(t3) : void 0).filter(Boolean);
  }
  writeMediaInfos(t2, o2) {
    o2.mediaInfos = t2 && t2.map((t3) => t3.toJSON());
  }
  clone() {
    return new l$2m(y$1L({ activeMediaInfoIndex: this.activeMediaInfoIndex, attributes: this.attributes, description: this.description, mediaInfos: this.mediaInfos, title: this.title }));
  }
};
e$2g([y$1I()], u$1V.prototype, "activeMediaInfoIndex", void 0), e$2g([y$1I({ type: Object, json: { write: true } })], u$1V.prototype, "attributes", void 0), e$2g([y$1I({ type: String, json: { write: true } })], u$1V.prototype, "description", void 0), e$2g([y$1I({ types: [m$2e] })], u$1V.prototype, "mediaInfos", void 0), e$2g([o$29("mediaInfos")], u$1V.prototype, "readMediaInfos", null), e$2g([r$1P("mediaInfos")], u$1V.prototype, "writeMediaInfos", null), e$2g([y$1I({ type: String, json: { write: true } })], u$1V.prototype, "title", void 0), e$2g([y$1I({ type: ["media"], readOnly: true, json: { read: false, write: true } })], u$1V.prototype, "type", void 0), u$1V = l$2m = e$2g([n$2P("esri.popup.content.MediaContent")], u$1V);
const I$I = u$1V;
var t$1W;
let p$3c = t$1W = class extends l$2B {
  constructor(r2) {
    super(r2), this.field = null, this.order = null;
  }
  clone() {
    return new t$1W({ field: this.field, order: this.order });
  }
};
e$2g([y$1I({ type: String, json: { write: true } })], p$3c.prototype, "field", void 0), e$2g([y$1I({ type: ["asc", "desc"], json: { write: true } })], p$3c.prototype, "order", void 0), p$3c = t$1W = e$2g([n$2P("esri.popup.support.RelatedRecordsInfoFieldOrder")], p$3c);
const c$2U = p$3c;
let n$2x = class extends i$2R(p$3r) {
  constructor(t2) {
    super(t2), this.description = null, this.displayCount = null, this.displayType = "list", this.orderByFields = null, this.relationshipId = null, this.title = null, this.type = "relationship";
  }
};
e$2g([y$1I({ type: String, json: { write: true } })], n$2x.prototype, "description", void 0), e$2g([y$1I({ type: Number, json: { type: T$G, write: true } })], n$2x.prototype, "displayCount", void 0), e$2g([y$1I({ type: ["list"], json: { write: true } })], n$2x.prototype, "displayType", void 0), e$2g([y$1I({ type: [c$2U], json: { write: true } })], n$2x.prototype, "orderByFields", void 0), e$2g([y$1I({ type: Number, json: { type: T$G, write: true } })], n$2x.prototype, "relationshipId", void 0), e$2g([y$1I({ type: String, json: { write: true } })], n$2x.prototype, "title", void 0), e$2g([y$1I({ type: ["relationship"], readOnly: true, json: { read: false, write: true } })], n$2x.prototype, "type", void 0), n$2x = e$2g([n$2P("esri.popup.content.RelationshipContent")], n$2x);
const l$2l = n$2x;
var s$21;
let p$3b = s$21 = class extends p$3r {
  constructor(t2) {
    super(t2), this.text = null, this.type = "text";
  }
  clone() {
    return new s$21({ text: this.text });
  }
};
e$2g([y$1I({ type: String, json: { write: true } })], p$3b.prototype, "text", void 0), e$2g([y$1I({ type: ["text"], readOnly: true, json: { read: false, write: true } })], p$3b.prototype, "type", void 0), p$3b = s$21 = e$2g([n$2P("esri.popup.content.TextContent")], p$3b);
const c$2T = p$3b;
const m$2d = { base: null, key: "type", typeMap: { attachment: i$2O, media: I$I, text: c$2T, expression: i$2L, field: c$2Y, relationship: l$2l } };
var s$20;
let p$3a = s$20 = class extends l$2B {
  constructor(r2) {
    super(r2), this.name = null, this.title = null, this.expression = null, this.returnType = null;
  }
  clone() {
    return new s$20({ name: this.name, title: this.title, expression: this.expression, returnType: this.returnType });
  }
};
e$2g([y$1I({ type: String, json: { write: true } })], p$3a.prototype, "name", void 0), e$2g([y$1I({ type: String, json: { write: true } })], p$3a.prototype, "title", void 0), e$2g([y$1I({ type: String, json: { write: true } })], p$3a.prototype, "expression", void 0), e$2g([y$1I({ type: ["string", "number"], json: { write: true } })], p$3a.prototype, "returnType", void 0), p$3a = s$20 = e$2g([n$2P("esri.popup.ExpressionInfo")], p$3a);
const i$2D = p$3a;
var e$1K;
let p$39 = e$1K = class extends l$2B {
  constructor(o2) {
    super(o2), this.returnTopmostRaster = null, this.showNoDataRecords = null;
  }
  clone() {
    return new e$1K({ showNoDataRecords: this.showNoDataRecords, returnTopmostRaster: this.returnTopmostRaster });
  }
};
e$2g([y$1I({ type: Boolean, json: { write: true } })], p$39.prototype, "returnTopmostRaster", void 0), e$2g([y$1I({ type: Boolean, json: { write: true } })], p$39.prototype, "showNoDataRecords", void 0), p$39 = e$1K = e$2g([n$2P("esri.popup.LayerOptions")], p$39);
const a$2C = p$39;
var d$1L;
let c$2S = d$1L = class extends l$2B {
  constructor(o2) {
    super(o2), this.showRelatedRecords = null, this.orderByFields = null;
  }
  clone() {
    return new d$1L({ showRelatedRecords: this.showRelatedRecords, orderByFields: this.orderByFields ? y$1L(this.orderByFields) : null });
  }
};
e$2g([y$1I({ type: Boolean, json: { write: true } })], c$2S.prototype, "showRelatedRecords", void 0), e$2g([y$1I({ type: [c$2U], json: { write: true } })], c$2S.prototype, "orderByFields", void 0), c$2S = d$1L = e$2g([n$2P("esri.popup.RelatedRecordsInfo")], c$2S);
const l$2k = c$2S;
let t$1V = 0;
const s$1$ = (s2) => {
  let i2 = class extends s2 {
    constructor(...e2) {
      super(...e2), Object.defineProperty(this, "uid", { writable: false, configurable: false, value: Date.now().toString(16) + "-object-" + t$1V++ });
    }
  };
  return i2 = e$2g([n$2P("esri.core.Identifiable")], i2), i2;
}, i$2C = (s2) => {
  let i2 = class extends s2 {
    constructor(...e2) {
      super(...e2), Object.defineProperty(this, "uid", { writable: false, configurable: false, value: t$1V++ });
    }
  };
  return i2 = e$2g([n$2P("esri.core.NumericIdentifiable")], i2), i2;
};
let o$1W = class extends s$1$(class {
}) {
};
o$1W = e$2g([n$2P("esri.core.Identifiable")], o$1W);
var r$1F;
let p$38 = r$1F = class extends s$1$(m$2q) {
  constructor(t2) {
    super(t2), this.active = false, this.className = null, this.disabled = false, this.id = null, this.indicator = false, this.title = null, this.type = null, this.visible = true;
  }
  clone() {
    return new r$1F({ active: this.active, className: this.className, disabled: this.disabled, id: this.id, indicator: this.indicator, title: this.title, visible: this.visible });
  }
};
e$2g([y$1I()], p$38.prototype, "active", void 0), e$2g([y$1I()], p$38.prototype, "className", void 0), e$2g([y$1I()], p$38.prototype, "disabled", void 0), e$2g([y$1I()], p$38.prototype, "id", void 0), e$2g([y$1I()], p$38.prototype, "indicator", void 0), e$2g([y$1I()], p$38.prototype, "title", void 0), e$2g([y$1I()], p$38.prototype, "type", void 0), e$2g([y$1I()], p$38.prototype, "visible", void 0), p$38 = r$1F = e$2g([n$2P("esri.support.actions.ActionBase")], p$38);
const c$2R = p$38;
var o$1V;
let r$1E = o$1V = class extends c$2R {
  constructor(s2) {
    super(s2), this.image = null, this.type = "button";
  }
  clone() {
    return new o$1V({ active: this.active, className: this.className, disabled: this.disabled, id: this.id, indicator: this.indicator, title: this.title, visible: this.visible, image: this.image });
  }
};
e$2g([y$1I()], r$1E.prototype, "image", void 0), r$1E = o$1V = e$2g([n$2P("esri.support.Action.ActionButton")], r$1E);
const a$2B = r$1E;
var o$1U;
let r$1D = o$1U = class extends c$2R {
  constructor(s2) {
    super(s2), this.image = null, this.type = "toggle", this.value = false;
  }
  clone() {
    return new o$1U({ active: this.active, className: this.className, disabled: this.disabled, id: this.id, indicator: this.indicator, title: this.title, visible: this.visible, image: this.image, value: this.value });
  }
};
e$2g([y$1I()], r$1D.prototype, "image", void 0), e$2g([y$1I()], r$1D.prototype, "value", void 0), r$1D = o$1U = e$2g([n$2P("esri.support.Action.ActionToggle")], r$1D);
const a$2A = r$1D;
const T$A = "esri.PopupTemplate", b$14 = s$2z.getLogger(T$A), J$q = "relationships/", L$w = "expression/", B$w = j$V.ofType({ key: "type", defaultKeyValue: "button", base: c$2R, typeMap: { button: a$2B, toggle: a$2A } }), M$G = { base: p$3r, key: "type", typeMap: { media: I$I, custom: i$2N, text: c$2T, attachments: i$2O, fields: c$2Y, expression: i$2L, relationship: l$2l } }, P$B = ["attachments", "fields", "media", "text", "expression", "relationship"];
let $$j = class extends i$2R(l$2B) {
  constructor() {
    super(...arguments), this.actions = null, this.content = "", this.expressionInfos = null, this.fieldInfos = null, this.layerOptions = null, this.lastEditInfoEnabled = true, this.outFields = null, this.overwriteActions = false, this.returnGeometry = false, this.title = "";
  }
  castContent(t2) {
    return Array.isArray(t2) ? t2.map((t3) => S$V(M$G, t3)) : typeof t2 == "string" || typeof t2 == "function" || t2 instanceof HTMLElement || C$E(t2) ? t2 : (b$14.error("content error", "unsupported content value", { value: t2 }), null);
  }
  readContent(t2, e2) {
    const { popupElements: o2 } = e2;
    return Array.isArray(o2) && o2.length > 0 ? this._readPopupInfoElements(e2.description, e2.mediaInfos, o2) : this._readPopupInfo(e2);
  }
  writeContent(t2, e2, o2, s2) {
    typeof t2 != "string" ? Array.isArray(t2) && (e2.popupElements = t2.filter((t3) => P$B.includes(t3.type)).map((t3) => t3 && t3.toJSON(s2)), e2.popupElements.forEach((t3) => {
      t3.type === "attachments" ? this._writeAttachmentContent(e2) : t3.type === "media" ? this._writeMediaContent(t3, e2) : t3.type === "text" ? this._writeTextContent(t3, e2) : t3.type === "relationship" && this._writeRelationshipContent(t3, e2);
    })) : e2.description = t2;
  }
  writeFieldInfos(t2, e2, o2, s2) {
    const { content: r2 } = this, i2 = Array.isArray(r2) ? r2 : null;
    if (t2) {
      const o3 = i2 ? i2.filter((t3) => t3.type === "fields") : [], r3 = o3.length && o3.every((t3) => {
        var _a2;
        return (_a2 = t3.fieldInfos) == null ? void 0 : _a2.length;
      });
      e2.fieldInfos = t2.filter(Boolean).map((t3) => {
        const e3 = t3.toJSON(s2);
        return r3 && (e3.visible = false), e3;
      });
    }
    if (i2)
      for (const n2 of i2)
        n2.type === "fields" && this._writeFieldsContent(n2, e2);
  }
  writeLayerOptions(t2, e2, o2, s2) {
    e2[o2] = !t2 || t2.showNoDataRecords === null && t2.returnTopmostRaster === null ? null : t2.toJSON(s2);
  }
  writeTitle(t2, e2) {
    e2.title = t2 || "";
  }
  async collectRequiredFields(t2, e2) {
    const o2 = this.expressionInfos || [];
    await this._collectExpressionInfoFields(t2, e2, [...o2, ...this._getContentExpressionInfos(this.content, o2)]), h$1G(t2, e2, [...this.outFields || [], ...this._getActionsFields(this.actions), ...this._getTitleFields(this.title), ...this._getContentFields(this.content)]);
  }
  async getRequiredFields(t2) {
    const e2 = new Set();
    return await this.collectRequiredFields(e2, t2), [...e2].sort();
  }
  _writeFieldsContent(t2, e2) {
    if (!Array.isArray(t2.fieldInfos) || !t2.fieldInfos.length)
      return;
    const o2 = y$1L(t2.fieldInfos);
    Array.isArray(e2.fieldInfos) ? o2.forEach((t3) => {
      const o3 = e2.fieldInfos.find((e3) => e3.fieldName.toLowerCase() === t3.fieldName.toLowerCase());
      o3 ? o3.visible = true : e2.fieldInfos.push(t3);
    }) : e2.fieldInfos = o2;
  }
  _writeAttachmentContent(t2) {
    t2.showAttachments || (t2.showAttachments = true);
  }
  _writeRelationshipContent(t2, e2) {
    var _a2, _b2;
    const o2 = ((_a2 = t2.orderByFields) == null ? void 0 : _a2.map((e3) => this._toFieldOrderJSON(e3, t2.relationshipId))) || [], s2 = [...((_b2 = e2.relatedRecordsInfo) == null ? void 0 : _b2.orderByFields) || [], ...o2];
    e2.relatedRecordsInfo = __spreadValues({ showRelatedRecords: true }, (s2 == null ? void 0 : s2.length) && { orderByFields: s2 });
  }
  _writeTextContent(t2, e2) {
    !e2.description && t2.text && (e2.description = t2.text);
  }
  _writeMediaContent(t2, e2) {
    if (!Array.isArray(t2.mediaInfos) || !t2.mediaInfos.length)
      return;
    const o2 = y$1L(t2.mediaInfos);
    Array.isArray(e2.mediaInfos) ? e2.mediaInfos = [...e2.mediaInfos, ...o2] : e2.mediaInfos = o2;
  }
  _readPopupInfoElements(t2, e2, o2) {
    const s2 = { description: false, mediaInfos: false };
    return o2.map((o3) => o3.type === "media" ? (o3.mediaInfos || !e2 || s2.mediaInfos || (o3.mediaInfos = e2, s2.mediaInfos = true), I$I.fromJSON(o3)) : o3.type === "text" ? (o3.text || !t2 || s2.description || (o3.text = t2, s2.description = true), c$2T.fromJSON(o3)) : o3.type === "attachments" ? i$2O.fromJSON(o3) : o3.type === "fields" ? c$2Y.fromJSON(o3) : o3.type === "expression" ? i$2L.fromJSON(o3) : o3.type === "relationship" ? l$2l.fromJSON(o3) : void 0).filter(Boolean);
  }
  _toRelationshipContent(t2) {
    const { field: e2, order: o2 } = t2;
    if (!(e2 == null ? void 0 : e2.startsWith(J$q)))
      return null;
    const s2 = e2.replace(J$q, "").split("/");
    if (s2.length !== 2)
      return null;
    const r2 = parseInt(s2[0], 10), i2 = s2[1];
    return typeof r2 == "number" && i2 ? l$2l.fromJSON({ relationshipId: r2, orderByFields: [{ field: i2, order: o2 }] }) : null;
  }
  _toFieldOrderJSON(t2, e2) {
    const { order: o2, field: s2 } = t2;
    return { field: `${J$q}${e2}/${s2}`, order: o2 };
  }
  _readPopupInfo({ description: t2, mediaInfos: e2, showAttachments: o2, relatedRecordsInfo: s2 = { showRelatedRecords: false } }) {
    const r2 = [];
    t2 ? r2.push(new c$2T({ text: t2 })) : r2.push(new c$2Y()), Array.isArray(e2) && e2.length && r2.push(I$I.fromJSON({ mediaInfos: e2 })), o2 && r2.push(i$2O.fromJSON({ displayType: "auto" }));
    const { showRelatedRecords: i2, orderByFields: n2 } = s2;
    return i2 && (n2 == null ? void 0 : n2.length) && n2.forEach((t3) => {
      const e3 = this._toRelationshipContent(t3);
      e3 && r2.push(e3);
    }), r2.length ? r2 : t2;
  }
  _getContentElementFields(t2) {
    var _a2;
    const e2 = t2 == null ? void 0 : t2.type;
    if (e2 === "attachments")
      return [...this._extractFieldNames(t2.title), ...this._extractFieldNames(t2.description)];
    if (e2 === "custom")
      return t2.outFields || [];
    if (e2 === "fields")
      return [...this._extractFieldNames(t2.title), ...this._extractFieldNames(t2.description), ...this._getFieldInfoFields((_a2 = t2.fieldInfos) != null ? _a2 : this.fieldInfos)];
    if (e2 === "media") {
      const e3 = t2.mediaInfos || [];
      return [...this._extractFieldNames(t2.title), ...this._extractFieldNames(t2.description), ...e3.reduce((t3, e4) => [...t3, ...this._getMediaInfoFields(e4)], [])];
    }
    return e2 === "text" ? this._extractFieldNames(t2.text) : [];
  }
  _getMediaInfoFields(t2) {
    const { caption: e2, title: o2, value: s2 } = t2, r2 = s2 || {}, { fields: i2, normalizeField: n2, tooltipField: p2, sourceURL: l2, linkURL: a2 } = r2, d2 = [...this._extractFieldNames(o2), ...this._extractFieldNames(e2), ...this._extractFieldNames(l2), ...this._extractFieldNames(a2), ...i2 != null ? i2 : []];
    return n2 && d2.push(n2), p2 && d2.push(p2), d2;
  }
  _getContentExpressionInfos(t2, e2) {
    return Array.isArray(t2) ? t2.reduce((t3, e3) => [...t3, ...e3.type === "expression" && e3.expressionInfo ? [e3.expressionInfo] : []], e2) : [];
  }
  _getContentFields(t2) {
    return typeof t2 == "string" ? this._extractFieldNames(t2) : Array.isArray(t2) ? t2.reduce((t3, e2) => [...t3, ...this._getContentElementFields(e2)], []) : [];
  }
  async _collectExpressionInfoFields(t2, e2, o2) {
    o2 && await Promise.all(o2.map((o3) => S$Q(t2, e2, o3.expression)));
  }
  _getFieldInfoFields(t2) {
    return t2 ? t2.filter((t3) => t3.visible === void 0 || !!t3.visible).map((t3) => t3.fieldName).filter((t3) => !t3.startsWith(J$q) && !t3.startsWith(L$w)) : [];
  }
  _getActionsFields(t2) {
    return t2 ? t2.toArray().reduce((t3, e2) => [...t3, ...this._getActionFields(e2)], []) : [];
  }
  _getActionFields(t2) {
    const { className: e2, title: o2, type: s2 } = t2, r2 = s2 === "button" || s2 === "toggle" ? t2.image : "";
    return [...this._extractFieldNames(o2), ...this._extractFieldNames(e2), ...this._extractFieldNames(r2)];
  }
  _getTitleFields(t2) {
    return typeof t2 == "string" ? this._extractFieldNames(t2) : [];
  }
  _extractFieldNames(t2) {
    if (!t2 || typeof t2 != "string")
      return [];
    const e2 = /{[^}]*}/g, o2 = t2.match(e2);
    if (!o2)
      return [];
    const s2 = /\{(\w+):.+\}/, r2 = o2.filter((t3) => !(t3.indexOf(`{${J$q}`) === 0 || t3.indexOf(`{${L$w}`) === 0)).map((t3) => t3.replace(s2, "{$1}"));
    return r2 ? r2.map((t3) => t3.slice(1, -1)) : [];
  }
};
e$2g([y$1I({ type: B$w })], $$j.prototype, "actions", void 0), e$2g([y$1I()], $$j.prototype, "content", void 0), e$2g([s$2i("content")], $$j.prototype, "castContent", null), e$2g([o$29("content", ["description", "fieldInfos", "popupElements", "mediaInfos", "showAttachments", "relatedRecordsInfo"])], $$j.prototype, "readContent", null), e$2g([r$1P("content", { popupElements: { type: j$V.ofType(m$2d) }, showAttachments: { type: Boolean }, mediaInfos: { type: j$V.ofType(m$2e) }, description: { type: String }, relatedRecordsInfo: { type: l$2k } })], $$j.prototype, "writeContent", null), e$2g([y$1I({ type: [i$2D], json: { write: true } })], $$j.prototype, "expressionInfos", void 0), e$2g([y$1I({ type: [c$2Z] })], $$j.prototype, "fieldInfos", void 0), e$2g([r$1P("fieldInfos")], $$j.prototype, "writeFieldInfos", null), e$2g([y$1I({ type: a$2C })], $$j.prototype, "layerOptions", void 0), e$2g([r$1P("layerOptions")], $$j.prototype, "writeLayerOptions", null), e$2g([y$1I({ type: Boolean, json: { read: { source: "showLastEditInfo" }, write: { target: "showLastEditInfo" }, default: true } })], $$j.prototype, "lastEditInfoEnabled", void 0), e$2g([y$1I()], $$j.prototype, "outFields", void 0), e$2g([y$1I()], $$j.prototype, "overwriteActions", void 0), e$2g([y$1I()], $$j.prototype, "returnGeometry", void 0), e$2g([y$1I({ json: { type: String } })], $$j.prototype, "title", void 0), e$2g([r$1P("title")], $$j.prototype, "writeTitle", null), $$j = e$2g([n$2P("esri.PopupTemplate")], $$j);
const k$B = $$j;
const e$1J = { transparent: [0, 0, 0, 0], black: [0, 0, 0, 1], silver: [192, 192, 192, 1], gray: [128, 128, 128, 1], white: [255, 255, 255, 1], maroon: [128, 0, 0, 1], red: [255, 0, 0, 1], purple: [128, 0, 128, 1], fuchsia: [255, 0, 255, 1], green: [0, 128, 0, 1], lime: [0, 255, 0, 1], olive: [128, 128, 0, 1], yellow: [255, 255, 0, 1], navy: [0, 0, 128, 1], blue: [0, 0, 255, 1], teal: [0, 128, 128, 1], aqua: [0, 255, 255, 1], aliceblue: [240, 248, 255, 1], antiquewhite: [250, 235, 215, 1], aquamarine: [127, 255, 212, 1], azure: [240, 255, 255, 1], beige: [245, 245, 220, 1], bisque: [255, 228, 196, 1], blanchedalmond: [255, 235, 205, 1], blueviolet: [138, 43, 226, 1], brown: [165, 42, 42, 1], burlywood: [222, 184, 135, 1], cadetblue: [95, 158, 160, 1], chartreuse: [127, 255, 0, 1], chocolate: [210, 105, 30, 1], coral: [255, 127, 80, 1], cornflowerblue: [100, 149, 237, 1], cornsilk: [255, 248, 220, 1], crimson: [220, 20, 60, 1], cyan: [0, 255, 255, 1], darkblue: [0, 0, 139, 1], darkcyan: [0, 139, 139, 1], darkgoldenrod: [184, 134, 11, 1], darkgray: [169, 169, 169, 1], darkgreen: [0, 100, 0, 1], darkgrey: [169, 169, 169, 1], darkkhaki: [189, 183, 107, 1], darkmagenta: [139, 0, 139, 1], darkolivegreen: [85, 107, 47, 1], darkorange: [255, 140, 0, 1], darkorchid: [153, 50, 204, 1], darkred: [139, 0, 0, 1], darksalmon: [233, 150, 122, 1], darkseagreen: [143, 188, 143, 1], darkslateblue: [72, 61, 139, 1], darkslategray: [47, 79, 79, 1], darkslategrey: [47, 79, 79, 1], darkturquoise: [0, 206, 209, 1], darkviolet: [148, 0, 211, 1], deeppink: [255, 20, 147, 1], deepskyblue: [0, 191, 255, 1], dimgray: [105, 105, 105, 1], dimgrey: [105, 105, 105, 1], dodgerblue: [30, 144, 255, 1], firebrick: [178, 34, 34, 1], floralwhite: [255, 250, 240, 1], forestgreen: [34, 139, 34, 1], gainsboro: [220, 220, 220, 1], ghostwhite: [248, 248, 255, 1], gold: [255, 215, 0, 1], goldenrod: [218, 165, 32, 1], greenyellow: [173, 255, 47, 1], grey: [128, 128, 128, 1], honeydew: [240, 255, 240, 1], hotpink: [255, 105, 180, 1], indianred: [205, 92, 92, 1], indigo: [75, 0, 130, 1], ivory: [255, 255, 240, 1], khaki: [240, 230, 140, 1], lavender: [230, 230, 250, 1], lavenderblush: [255, 240, 245, 1], lawngreen: [124, 252, 0, 1], lemonchiffon: [255, 250, 205, 1], lightblue: [173, 216, 230, 1], lightcoral: [240, 128, 128, 1], lightcyan: [224, 255, 255, 1], lightgoldenrodyellow: [250, 250, 210, 1], lightgray: [211, 211, 211, 1], lightgreen: [144, 238, 144, 1], lightgrey: [211, 211, 211, 1], lightpink: [255, 182, 193, 1], lightsalmon: [255, 160, 122, 1], lightseagreen: [32, 178, 170, 1], lightskyblue: [135, 206, 250, 1], lightslategray: [119, 136, 153, 1], lightslategrey: [119, 136, 153, 1], lightsteelblue: [176, 196, 222, 1], lightyellow: [255, 255, 224, 1], limegreen: [50, 205, 50, 1], linen: [250, 240, 230, 1], magenta: [255, 0, 255, 1], mediumaquamarine: [102, 205, 170, 1], mediumblue: [0, 0, 205, 1], mediumorchid: [186, 85, 211, 1], mediumpurple: [147, 112, 219, 1], mediumseagreen: [60, 179, 113, 1], mediumslateblue: [123, 104, 238, 1], mediumspringgreen: [0, 250, 154, 1], mediumturquoise: [72, 209, 204, 1], mediumvioletred: [199, 21, 133, 1], midnightblue: [25, 25, 112, 1], mintcream: [245, 255, 250, 1], mistyrose: [255, 228, 225, 1], moccasin: [255, 228, 181, 1], navajowhite: [255, 222, 173, 1], oldlace: [253, 245, 230, 1], olivedrab: [107, 142, 35, 1], orange: [255, 165, 0, 1], orangered: [255, 69, 0, 1], orchid: [218, 112, 214, 1], palegoldenrod: [238, 232, 170, 1], palegreen: [152, 251, 152, 1], paleturquoise: [175, 238, 238, 1], palevioletred: [219, 112, 147, 1], papayawhip: [255, 239, 213, 1], peachpuff: [255, 218, 185, 1], peru: [205, 133, 63, 1], pink: [255, 192, 203, 1], plum: [221, 160, 221, 1], powderblue: [176, 224, 230, 1], rebeccapurple: [102, 51, 153, 1], rosybrown: [188, 143, 143, 1], royalblue: [65, 105, 225, 1], saddlebrown: [139, 69, 19, 1], salmon: [250, 128, 114, 1], sandybrown: [244, 164, 96, 1], seagreen: [46, 139, 87, 1], seashell: [255, 245, 238, 1], sienna: [160, 82, 45, 1], skyblue: [135, 206, 235, 1], slateblue: [106, 90, 205, 1], slategray: [112, 128, 144, 1], slategrey: [112, 128, 144, 1], snow: [255, 250, 250, 1], springgreen: [0, 255, 127, 1], steelblue: [70, 130, 180, 1], tan: [210, 180, 140, 1], thistle: [216, 191, 216, 1], tomato: [255, 99, 71, 1], turquoise: [64, 224, 208, 1], violet: [238, 130, 238, 1], wheat: [245, 222, 179, 1], whitesmoke: [245, 245, 245, 1], yellowgreen: [154, 205, 50, 1] };
function r$1C(r2) {
  return e$1J[r2] || e$1J[r2.toLowerCase()];
}
function l$2j(r2) {
  var _a2;
  return (_a2 = e$1J[r2]) != null ? _a2 : e$1J[r2.toLowerCase()];
}
function a$2z(e2) {
  return [...l$2j(e2)];
}
function n$2w(e2, r2, l2) {
  l2 < 0 && ++l2, l2 > 1 && --l2;
  const a2 = 6 * l2;
  return a2 < 1 ? e2 + (r2 - e2) * a2 : 2 * l2 < 1 ? r2 : 3 * l2 < 2 ? e2 + (r2 - e2) * (2 / 3 - l2) * 6 : e2;
}
function o$1T(e2, r2, l2, a2 = 1) {
  const o2 = (e2 % 360 + 360) % 360 / 360, i2 = l2 <= 0.5 ? l2 * (r2 + 1) : l2 + r2 - l2 * r2, t2 = 2 * l2 - i2;
  return [Math.round(255 * n$2w(t2, i2, o2 + 1 / 3)), Math.round(255 * n$2w(t2, i2, o2)), Math.round(255 * n$2w(t2, i2, o2 - 1 / 3)), a2];
}
function i$2B(e2) {
  const r2 = e2.length > 5, l2 = r2 ? 8 : 4, a2 = (1 << l2) - 1, n2 = r2 ? 1 : 17, o2 = r2 ? e2.length === 9 : e2.length === 5;
  let i2 = Number("0x" + e2.substr(1));
  if (isNaN(i2))
    return null;
  const t2 = [0, 0, 0, 1];
  let u2;
  return o2 && (u2 = i2 & a2, i2 >>= l2, t2[3] = n2 * u2 / 255), u2 = i2 & a2, i2 >>= l2, t2[2] = n2 * u2, u2 = i2 & a2, i2 >>= l2, t2[1] = n2 * u2, u2 = i2 & a2, i2 >>= l2, t2[0] = n2 * u2, t2;
}
function n$2v() {
  return [0, 0, 0];
}
function t$1U(n2) {
  return [n2[0], n2[1], n2[2]];
}
function r$1B(n2, t2, r2) {
  return [n2, t2, r2];
}
function e$1I(t2) {
  const r2 = n$2v(), e2 = Math.min(3, t2.length);
  for (let n2 = 0; n2 < e2; ++n2)
    r2[n2] = t2[n2];
  return r2;
}
function u$1U(n2, t2) {
  return new Float64Array(n2, t2, 3);
}
function o$1S() {
  return n$2v();
}
function a$2y() {
  return r$1B(1, 1, 1);
}
function s$1_() {
  return r$1B(1, 0, 0);
}
function c$2Q() {
  return r$1B(0, 1, 0);
}
function i$2A() {
  return r$1B(0, 0, 1);
}
const f$1E = o$1S(), l$2i = a$2y(), _$L = s$1_(), O$A = c$2Q(), b$13 = i$2A();
Object.freeze(Object.defineProperty({ __proto__: null, create: n$2v, clone: t$1U, fromValues: r$1B, fromArray: e$1I, createView: u$1U, zeros: o$1S, ones: a$2y, unitX: s$1_, unitY: c$2Q, unitZ: i$2A, ZEROS: f$1E, ONES: l$2i, UNIT_X: _$L, UNIT_Y: O$A, UNIT_Z: b$13 }, Symbol.toStringTag, { value: "Module" }));
let t$1T = 1e-6;
function a$2x() {
  return t$1T;
}
function e$1H(a2) {
  t$1T = a2;
}
const n$2u = Math.random, o$1R = Math.PI / 180, s$1Z = 180 / Math.PI;
function r$1A(t2) {
  return t2 * o$1R;
}
function u$1T(t2) {
  return t2 * s$1Z;
}
function c$2P(a2, e2) {
  return Math.abs(a2 - e2) <= t$1T * Math.max(1, Math.abs(a2), Math.abs(e2));
}
Object.freeze(Object.defineProperty({ __proto__: null, getEpsilon: a$2x, setEpsilon: e$1H, RANDOM: n$2u, toRadian: r$1A, toDegree: u$1T, equals: c$2P }, Symbol.toStringTag, { value: "Module" }));
function s$1Y(t2) {
  const n2 = t2[0], a2 = t2[1], s2 = t2[2];
  return Math.sqrt(n2 * n2 + a2 * a2 + s2 * s2);
}
function r$1z(t2, n2) {
  return t2[0] = n2[0], t2[1] = n2[1], t2[2] = n2[2], t2;
}
function o$1Q(t2, n2, a2, s2) {
  return t2[0] = n2, t2[1] = a2, t2[2] = s2, t2;
}
function u$1S(t2, n2, a2) {
  return t2[0] = n2[0] + a2[0], t2[1] = n2[1] + a2[1], t2[2] = n2[2] + a2[2], t2;
}
function e$1G(t2, n2, a2) {
  return t2[0] = n2[0] - a2[0], t2[1] = n2[1] - a2[1], t2[2] = n2[2] - a2[2], t2;
}
function c$2O(t2, n2, a2) {
  return t2[0] = n2[0] * a2[0], t2[1] = n2[1] * a2[1], t2[2] = n2[2] * a2[2], t2;
}
function i$2z(t2, n2, a2) {
  return t2[0] = n2[0] / a2[0], t2[1] = n2[1] / a2[1], t2[2] = n2[2] / a2[2], t2;
}
function h$1D(t2, n2) {
  return t2[0] = Math.ceil(n2[0]), t2[1] = Math.ceil(n2[1]), t2[2] = Math.ceil(n2[2]), t2;
}
function M$F(t2, n2) {
  return t2[0] = Math.floor(n2[0]), t2[1] = Math.floor(n2[1]), t2[2] = Math.floor(n2[2]), t2;
}
function f$1D(t2, n2) {
  return t2[0] = Math.abs(n2[0]), t2[1] = Math.abs(n2[1]), t2[2] = Math.abs(n2[2]), t2;
}
function l$2h(t2, n2) {
  return t2[0] = Math.sign(n2[0]), t2[1] = Math.sign(n2[1]), t2[2] = Math.sign(n2[2]), t2;
}
function m$2c(t2, n2, a2) {
  return t2[0] = Math.min(n2[0], a2[0]), t2[1] = Math.min(n2[1], a2[1]), t2[2] = Math.min(n2[2], a2[2]), t2;
}
function d$1K(t2, n2, a2) {
  return t2[0] = Math.max(n2[0], a2[0]), t2[1] = Math.max(n2[1], a2[1]), t2[2] = Math.max(n2[2], a2[2]), t2;
}
function b$12(t2, n2) {
  return t2[0] = Math.round(n2[0]), t2[1] = Math.round(n2[1]), t2[2] = Math.round(n2[2]), t2;
}
function g$19(t2, n2, a2) {
  return t2[0] = n2[0] * a2, t2[1] = n2[1] * a2, t2[2] = n2[2] * a2, t2;
}
function q$q(t2, n2, a2, s2) {
  return t2[0] = n2[0] + a2[0] * s2, t2[1] = n2[1] + a2[1] * s2, t2[2] = n2[2] + a2[2] * s2, t2;
}
function x$U(t2, n2) {
  const a2 = n2[0] - t2[0], s2 = n2[1] - t2[1], r2 = n2[2] - t2[2];
  return Math.sqrt(a2 * a2 + s2 * s2 + r2 * r2);
}
function p$37(t2, n2) {
  const a2 = n2[0] - t2[0], s2 = n2[1] - t2[1], r2 = n2[2] - t2[2];
  return a2 * a2 + s2 * s2 + r2 * r2;
}
function v$11(t2) {
  const n2 = t2[0], a2 = t2[1], s2 = t2[2];
  return n2 * n2 + a2 * a2 + s2 * s2;
}
function j$T(t2, n2) {
  return t2[0] = -n2[0], t2[1] = -n2[1], t2[2] = -n2[2], t2;
}
function y$1q(t2, n2) {
  return t2[0] = 1 / n2[0], t2[1] = 1 / n2[1], t2[2] = 1 / n2[2], t2;
}
function z$G(t2, n2) {
  const a2 = n2[0], s2 = n2[1], r2 = n2[2];
  let o2 = a2 * a2 + s2 * s2 + r2 * r2;
  return o2 > 0 && (o2 = 1 / Math.sqrt(o2), t2[0] = n2[0] * o2, t2[1] = n2[1] * o2, t2[2] = n2[2] * o2), t2;
}
function P$A(t2, n2) {
  return t2[0] * n2[0] + t2[1] * n2[1] + t2[2] * n2[2];
}
function _$K(t2, n2, a2) {
  const s2 = n2[0], r2 = n2[1], o2 = n2[2], u2 = a2[0], e2 = a2[1], c2 = a2[2];
  return t2[0] = r2 * c2 - o2 * e2, t2[1] = o2 * u2 - s2 * c2, t2[2] = s2 * e2 - r2 * u2, t2;
}
function A$x(t2, n2, a2, s2) {
  const r2 = n2[0], o2 = n2[1], u2 = n2[2];
  return t2[0] = r2 + s2 * (a2[0] - r2), t2[1] = o2 + s2 * (a2[1] - o2), t2[2] = u2 + s2 * (a2[2] - u2), t2;
}
function D$x(t2, n2, a2, s2, r2, o2) {
  const u2 = o2 * o2, e2 = u2 * (2 * o2 - 3) + 1, c2 = u2 * (o2 - 2) + o2, i2 = u2 * (o2 - 1), h2 = u2 * (3 - 2 * o2);
  return t2[0] = n2[0] * e2 + a2[0] * c2 + s2[0] * i2 + r2[0] * h2, t2[1] = n2[1] * e2 + a2[1] * c2 + s2[1] * i2 + r2[1] * h2, t2[2] = n2[2] * e2 + a2[2] * c2 + s2[2] * i2 + r2[2] * h2, t2;
}
function I$H(t2, n2, a2, s2, r2, o2) {
  const u2 = 1 - o2, e2 = u2 * u2, c2 = o2 * o2, i2 = e2 * u2, h2 = 3 * o2 * e2, M2 = 3 * c2 * u2, f2 = c2 * o2;
  return t2[0] = n2[0] * i2 + a2[0] * h2 + s2[0] * M2 + r2[0] * f2, t2[1] = n2[1] * i2 + a2[1] * h2 + s2[1] * M2 + r2[1] * f2, t2[2] = n2[2] * i2 + a2[2] * h2 + s2[2] * M2 + r2[2] * f2, t2;
}
function L$v(t2, n2) {
  n2 = n2 || 1;
  const s2 = n$2u, r2 = 2 * s2() * Math.PI, o2 = 2 * s2() - 1, u2 = Math.sqrt(1 - o2 * o2) * n2;
  return t2[0] = Math.cos(r2) * u2, t2[1] = Math.sin(r2) * u2, t2[2] = o2 * n2, t2;
}
function O$z(t2, n2, a2) {
  const s2 = n2[0], r2 = n2[1], o2 = n2[2];
  return t2[0] = a2[0] * s2 + a2[4] * r2 + a2[8] * o2 + a2[12], t2[1] = a2[1] * s2 + a2[5] * r2 + a2[9] * o2 + a2[13], t2[2] = a2[2] * s2 + a2[6] * r2 + a2[10] * o2 + a2[14], t2;
}
function S$O(t2, n2, a2) {
  const s2 = n2[0], r2 = n2[1], o2 = n2[2];
  return t2[0] = s2 * a2[0] + r2 * a2[3] + o2 * a2[6], t2[1] = s2 * a2[1] + r2 * a2[4] + o2 * a2[7], t2[2] = s2 * a2[2] + r2 * a2[5] + o2 * a2[8], t2;
}
function E$L(t2, n2, a2) {
  const s2 = a2[0], r2 = a2[1], o2 = a2[2], u2 = a2[3], e2 = n2[0], c2 = n2[1], i2 = n2[2];
  let h2 = r2 * i2 - o2 * c2, M2 = o2 * e2 - s2 * i2, f2 = s2 * c2 - r2 * e2, l2 = r2 * f2 - o2 * M2, m2 = o2 * h2 - s2 * f2, d2 = s2 * M2 - r2 * h2;
  const b2 = 2 * u2;
  return h2 *= b2, M2 *= b2, f2 *= b2, l2 *= 2, m2 *= 2, d2 *= 2, t2[0] = e2 + h2 + l2, t2[1] = c2 + M2 + m2, t2[2] = i2 + f2 + d2, t2;
}
function Q$i(t2, n2, a2, s2) {
  const r2 = [], o2 = [];
  return r2[0] = n2[0] - a2[0], r2[1] = n2[1] - a2[1], r2[2] = n2[2] - a2[2], o2[0] = r2[0], o2[1] = r2[1] * Math.cos(s2) - r2[2] * Math.sin(s2), o2[2] = r2[1] * Math.sin(s2) + r2[2] * Math.cos(s2), t2[0] = o2[0] + a2[0], t2[1] = o2[1] + a2[1], t2[2] = o2[2] + a2[2], t2;
}
function R$z(t2, n2, a2, s2) {
  const r2 = [], o2 = [];
  return r2[0] = n2[0] - a2[0], r2[1] = n2[1] - a2[1], r2[2] = n2[2] - a2[2], o2[0] = r2[2] * Math.sin(s2) + r2[0] * Math.cos(s2), o2[1] = r2[1], o2[2] = r2[2] * Math.cos(s2) - r2[0] * Math.sin(s2), t2[0] = o2[0] + a2[0], t2[1] = o2[1] + a2[1], t2[2] = o2[2] + a2[2], t2;
}
function T$z(t2, n2, a2, s2) {
  const r2 = [], o2 = [];
  return r2[0] = n2[0] - a2[0], r2[1] = n2[1] - a2[1], r2[2] = n2[2] - a2[2], o2[0] = r2[0] * Math.cos(s2) - r2[1] * Math.sin(s2), o2[1] = r2[0] * Math.sin(s2) + r2[1] * Math.cos(s2), o2[2] = r2[2], t2[0] = o2[0] + a2[0], t2[1] = o2[1] + a2[1], t2[2] = o2[2] + a2[2], t2;
}
function k$A(t2, n2) {
  r$1z(w$W, t2), r$1z(B$v, n2), z$G(w$W, w$W), z$G(B$v, B$v);
  const a2 = P$A(w$W, B$v);
  return a2 > 1 ? 0 : a2 < -1 ? Math.PI : Math.acos(a2);
}
const w$W = n$2v(), B$v = n$2v();
function C$A(t2) {
  return "vec3(" + t2[0] + ", " + t2[1] + ", " + t2[2] + ")";
}
function F$A(t2, n2) {
  return t2[0] === n2[0] && t2[1] === n2[1] && t2[2] === n2[2];
}
function G$t(t2, a2) {
  if (t2 === a2)
    return true;
  const s2 = t2[0], r2 = t2[1], o2 = t2[2], u2 = a2[0], e2 = a2[1], c2 = a2[2], i2 = a$2x();
  return Math.abs(s2 - u2) <= i2 * Math.max(1, Math.abs(s2), Math.abs(u2)) && Math.abs(r2 - e2) <= i2 * Math.max(1, Math.abs(r2), Math.abs(e2)) && Math.abs(o2 - c2) <= i2 * Math.max(1, Math.abs(o2), Math.abs(c2));
}
function H$k(t2, n2, a2) {
  const s2 = a2[0] - n2[0], r2 = a2[1] - n2[1], o2 = a2[2] - n2[2];
  let u2 = s2 * s2 + r2 * r2 + o2 * o2;
  return u2 > 0 ? (u2 = 1 / Math.sqrt(u2), t2[0] = s2 * u2, t2[1] = r2 * u2, t2[2] = o2 * u2, t2) : (t2[0] = 0, t2[1] = 0, t2[2] = 0, t2);
}
const J$p = e$1G, K$i = c$2O, N$t = i$2z, U$w = x$U, X$f = p$37, Y$g = s$1Y, Z$h = v$11;
Object.freeze(Object.defineProperty({ __proto__: null, length: s$1Y, copy: r$1z, set: o$1Q, add: u$1S, subtract: e$1G, multiply: c$2O, divide: i$2z, ceil: h$1D, floor: M$F, abs: f$1D, sign: l$2h, min: m$2c, max: d$1K, round: b$12, scale: g$19, scaleAndAdd: q$q, distance: x$U, squaredDistance: p$37, squaredLength: v$11, negate: j$T, inverse: y$1q, normalize: z$G, dot: P$A, cross: _$K, lerp: A$x, hermite: D$x, bezier: I$H, random: L$v, transformMat4: O$z, transformMat3: S$O, transformQuat: E$L, rotateX: Q$i, rotateY: R$z, rotateZ: T$z, angle: k$A, str: C$A, exactEquals: F$A, equals: G$t, direction: H$k, sub: J$p, mul: K$i, div: N$t, dist: U$w, sqrDist: X$f, len: Y$g, sqrLen: Z$h }, Symbol.toStringTag, { value: "Module" }));
function a$2w(t2, n2) {
  return t2[0] = n2[0], t2[1] = n2[1], t2[2] = n2[2], t2[3] = n2[3], t2;
}
function r$1y(t2, n2, a2, r2, s2) {
  return t2[0] = n2, t2[1] = a2, t2[2] = r2, t2[3] = s2, t2;
}
function s$1X(t2, n2, a2) {
  return t2[0] = n2[0] + a2[0], t2[1] = n2[1] + a2[1], t2[2] = n2[2] + a2[2], t2[3] = n2[3] + a2[3], t2;
}
function o$1P(t2, n2, a2) {
  return t2[0] = n2[0] - a2[0], t2[1] = n2[1] - a2[1], t2[2] = n2[2] - a2[2], t2[3] = n2[3] - a2[3], t2;
}
function u$1R(t2, n2, a2) {
  return t2[0] = n2[0] * a2[0], t2[1] = n2[1] * a2[1], t2[2] = n2[2] * a2[2], t2[3] = n2[3] * a2[3], t2;
}
function e$1F(t2, n2, a2) {
  return t2[0] = n2[0] / a2[0], t2[1] = n2[1] / a2[1], t2[2] = n2[2] / a2[2], t2[3] = n2[3] / a2[3], t2;
}
function c$2N(t2, n2) {
  return t2[0] = Math.ceil(n2[0]), t2[1] = Math.ceil(n2[1]), t2[2] = Math.ceil(n2[2]), t2[3] = Math.ceil(n2[3]), t2;
}
function i$2y(t2, n2) {
  return t2[0] = Math.floor(n2[0]), t2[1] = Math.floor(n2[1]), t2[2] = Math.floor(n2[2]), t2[3] = Math.floor(n2[3]), t2;
}
function h$1C(t2, n2, a2) {
  return t2[0] = Math.min(n2[0], a2[0]), t2[1] = Math.min(n2[1], a2[1]), t2[2] = Math.min(n2[2], a2[2]), t2[3] = Math.min(n2[3], a2[3]), t2;
}
function M$E(t2, n2, a2) {
  return t2[0] = Math.max(n2[0], a2[0]), t2[1] = Math.max(n2[1], a2[1]), t2[2] = Math.max(n2[2], a2[2]), t2[3] = Math.max(n2[3], a2[3]), t2;
}
function f$1C(t2, n2) {
  return t2[0] = Math.round(n2[0]), t2[1] = Math.round(n2[1]), t2[2] = Math.round(n2[2]), t2[3] = Math.round(n2[3]), t2;
}
function l$2g(t2, n2, a2) {
  return t2[0] = n2[0] * a2, t2[1] = n2[1] * a2, t2[2] = n2[2] * a2, t2[3] = n2[3] * a2, t2;
}
function m$2b(t2, n2, a2, r2) {
  return t2[0] = n2[0] + a2[0] * r2, t2[1] = n2[1] + a2[1] * r2, t2[2] = n2[2] + a2[2] * r2, t2[3] = n2[3] + a2[3] * r2, t2;
}
function d$1J(t2, n2) {
  const a2 = n2[0] - t2[0], r2 = n2[1] - t2[1], s2 = n2[2] - t2[2], o2 = n2[3] - t2[3];
  return Math.sqrt(a2 * a2 + r2 * r2 + s2 * s2 + o2 * o2);
}
function b$11(t2, n2) {
  const a2 = n2[0] - t2[0], r2 = n2[1] - t2[1], s2 = n2[2] - t2[2], o2 = n2[3] - t2[3];
  return a2 * a2 + r2 * r2 + s2 * s2 + o2 * o2;
}
function x$T(t2) {
  const n2 = t2[0], a2 = t2[1], r2 = t2[2], s2 = t2[3];
  return Math.sqrt(n2 * n2 + a2 * a2 + r2 * r2 + s2 * s2);
}
function q$p(t2) {
  const n2 = t2[0], a2 = t2[1], r2 = t2[2], s2 = t2[3];
  return n2 * n2 + a2 * a2 + r2 * r2 + s2 * s2;
}
function p$36(t2, n2) {
  return t2[0] = -n2[0], t2[1] = -n2[1], t2[2] = -n2[2], t2[3] = -n2[3], t2;
}
function g$18(t2, n2) {
  return t2[0] = 1 / n2[0], t2[1] = 1 / n2[1], t2[2] = 1 / n2[2], t2[3] = 1 / n2[3], t2;
}
function v$10(t2, n2) {
  const a2 = n2[0], r2 = n2[1], s2 = n2[2], o2 = n2[3];
  let u2 = a2 * a2 + r2 * r2 + s2 * s2 + o2 * o2;
  return u2 > 0 && (u2 = 1 / Math.sqrt(u2), t2[0] = a2 * u2, t2[1] = r2 * u2, t2[2] = s2 * u2, t2[3] = o2 * u2), t2;
}
function y$1p(t2, n2) {
  return t2[0] * n2[0] + t2[1] * n2[1] + t2[2] * n2[2] + t2[3] * n2[3];
}
function j$S(t2, n2, a2, r2) {
  const s2 = n2[0], o2 = n2[1], u2 = n2[2], e2 = n2[3];
  return t2[0] = s2 + r2 * (a2[0] - s2), t2[1] = o2 + r2 * (a2[1] - o2), t2[2] = u2 + r2 * (a2[2] - u2), t2[3] = e2 + r2 * (a2[3] - e2), t2;
}
function _$J(t2, a2) {
  const r2 = n$2u;
  let s2, o2, u2, e2, c2, i2;
  a2 = a2 || 1;
  do {
    s2 = 2 * r2() - 1, o2 = 2 * r2() - 1, c2 = s2 * s2 + o2 * o2;
  } while (c2 >= 1);
  do {
    u2 = 2 * r2() - 1, e2 = 2 * r2() - 1, i2 = u2 * u2 + e2 * e2;
  } while (i2 >= 1);
  const h2 = Math.sqrt((1 - c2) / i2);
  return t2[0] = a2 * s2, t2[1] = a2 * o2, t2[2] = a2 * u2 * h2, t2[3] = a2 * e2 * h2, t2;
}
function w$V(t2, n2, a2) {
  const r2 = n2[0], s2 = n2[1], o2 = n2[2], u2 = n2[3];
  return t2[0] = a2[0] * r2 + a2[4] * s2 + a2[8] * o2 + a2[12] * u2, t2[1] = a2[1] * r2 + a2[5] * s2 + a2[9] * o2 + a2[13] * u2, t2[2] = a2[2] * r2 + a2[6] * s2 + a2[10] * o2 + a2[14] * u2, t2[3] = a2[3] * r2 + a2[7] * s2 + a2[11] * o2 + a2[15] * u2, t2;
}
function z$F(t2, n2, a2) {
  const r2 = n2[0], s2 = n2[1], o2 = n2[2], u2 = a2[0], e2 = a2[1], c2 = a2[2], i2 = a2[3], h2 = i2 * r2 + e2 * o2 - c2 * s2, M2 = i2 * s2 + c2 * r2 - u2 * o2, f2 = i2 * o2 + u2 * s2 - e2 * r2, l2 = -u2 * r2 - e2 * s2 - c2 * o2;
  return t2[0] = h2 * i2 + l2 * -u2 + M2 * -c2 - f2 * -e2, t2[1] = M2 * i2 + l2 * -e2 + f2 * -u2 - h2 * -c2, t2[2] = f2 * i2 + l2 * -c2 + h2 * -e2 - M2 * -u2, t2[3] = n2[3], t2;
}
function A$w(t2) {
  return "vec4(" + t2[0] + ", " + t2[1] + ", " + t2[2] + ", " + t2[3] + ")";
}
function D$w(t2, n2) {
  return t2[0] === n2[0] && t2[1] === n2[1] && t2[2] === n2[2] && t2[3] === n2[3];
}
function E$K(n2, a2) {
  const r2 = n2[0], s2 = n2[1], o2 = n2[2], u2 = n2[3], e2 = a2[0], c2 = a2[1], i2 = a2[2], h2 = a2[3], M2 = a$2x();
  return Math.abs(r2 - e2) <= M2 * Math.max(1, Math.abs(r2), Math.abs(e2)) && Math.abs(s2 - c2) <= M2 * Math.max(1, Math.abs(s2), Math.abs(c2)) && Math.abs(o2 - i2) <= M2 * Math.max(1, Math.abs(o2), Math.abs(i2)) && Math.abs(u2 - h2) <= M2 * Math.max(1, Math.abs(u2), Math.abs(h2));
}
const L$u = o$1P, O$y = u$1R, S$N = e$1F, k$z = d$1J, B$u = b$11, C$z = x$T, F$z = q$p;
Object.freeze(Object.defineProperty({ __proto__: null, copy: a$2w, set: r$1y, add: s$1X, subtract: o$1P, multiply: u$1R, divide: e$1F, ceil: c$2N, floor: i$2y, min: h$1C, max: M$E, round: f$1C, scale: l$2g, scaleAndAdd: m$2b, distance: d$1J, squaredDistance: b$11, length: x$T, squaredLength: q$p, negate: p$36, inverse: g$18, normalize: v$10, dot: y$1p, lerp: j$S, random: _$J, transformMat4: w$V, transformQuat: z$F, str: A$w, exactEquals: D$w, equals: E$K, sub: L$u, mul: O$y, div: S$N, dist: k$z, sqrDist: B$u, len: C$z, sqrLen: F$z }, Symbol.toStringTag, { value: "Module" }));
const e$1E = new Float32Array(1);
function i$2x(t2) {
  --t2;
  for (let n2 = 1; n2 < 32; n2 <<= 1)
    t2 |= t2 >> n2;
  return t2 + 1;
}
function a$2v(t2, n2, r2) {
  return Math.min(Math.max(t2, n2), r2);
}
function c$2M(t2) {
  return (t2 & t2 - 1) == 0;
}
function f$1B(t2) {
  return t2--, t2 |= t2 >> 1, t2 |= t2 >> 2, t2 |= t2 >> 4, t2 |= t2 >> 8, t2 |= t2 >> 16, ++t2;
}
function h$1B(t2, n2, r2) {
  return t2 + (n2 - t2) * r2;
}
function m$2a(t2) {
  return t2 * Math.PI / 180;
}
function b$10(t2) {
  return 180 * t2 / Math.PI;
}
function F$y(t2, n2 = 1e-6) {
  return (t2 < 0 ? -1 : 1) / Math.max(Math.abs(t2), n2);
}
function l$2f(t2) {
  return Math.acos(a$2v(t2, -1, 1));
}
function N$s(t2) {
  return Math.asin(a$2v(t2, -1, 1));
}
function g$17(t2, n2, r2 = 1e-6) {
  if (t2 === n2)
    return true;
  if (!Number.isFinite(t2) || !Number.isFinite(n2))
    return false;
  return (t2 > n2 ? t2 - n2 : n2 - t2) <= r2;
}
const E$J = new DataView(new ArrayBuffer(Float64Array.BYTES_PER_ELEMENT));
function B$t(t2) {
  return E$J.setFloat64(0, t2), E$J.getBigInt64(0);
}
function I$G(t2) {
  return E$J.setBigInt64(0, t2), E$J.getFloat64(0);
}
const p$35 = BigInt("1000000");
x$S(1);
function x$S(t2) {
  const n2 = B$t(t2 = Math.abs(t2)), r2 = I$G(n2 <= p$35 ? p$35 : n2 - p$35);
  return Math.abs(t2 - r2);
}
function A$v(t2) {
  return P$z(Math.max(-D$v, Math.min(t2, D$v)));
}
function P$z(t2) {
  return e$1E[0] = t2, e$1E[0];
}
function L$t(t2, u2) {
  const e2 = s$1Y(t2), i2 = N$s(t2[2] / e2), a2 = Math.atan2(t2[1] / e2, t2[0] / e2);
  return o$1Q(u2, e2, i2, a2), u2;
}
function d$1I(t2) {
  const n2 = t2[0] * t2[0] + t2[1] * t2[1] + t2[2] * t2[2], r2 = t2[3] * t2[3] + t2[4] * t2[4] + t2[5] * t2[5], u2 = t2[6] * t2[6] + t2[7] * t2[7] + t2[8] * t2[8];
  return !(g$17(n2, 1) && g$17(r2, 1) && g$17(u2, 1));
}
const D$v = P$z(34028234663852886e22);
function n$2t(t2) {
  return a$2v(s$2y(t2), 0, 255);
}
function o$1O(t2, r2, s2) {
  return t2 = Number(t2), isNaN(t2) ? s2 : t2 < r2 ? r2 : t2 > s2 ? s2 : t2;
}
class h$1A {
  constructor(t2) {
    this.r = 255, this.g = 255, this.b = 255, this.a = 1, t2 && this.setColor(t2);
  }
  static blendColors(t2, r2, s2, i2 = new h$1A()) {
    return i2.r = Math.round(t2.r + (r2.r - t2.r) * s2), i2.g = Math.round(t2.g + (r2.g - t2.g) * s2), i2.b = Math.round(t2.b + (r2.b - t2.b) * s2), i2.a = t2.a + (r2.a - t2.a) * s2, i2._sanitize();
  }
  static fromRgb(r2, s2) {
    const i2 = r2.toLowerCase().match(/^(rgba?|hsla?)\(([\s\.\-,%0-9]+)\)/);
    if (i2) {
      const r3 = i2[2].split(/\s*,\s*/), e2 = i2[1];
      if (e2 === "rgb" && r3.length === 3 || e2 === "rgba" && r3.length === 4) {
        const t2 = r3[0];
        if (t2.charAt(t2.length - 1) === "%") {
          const t3 = r3.map((t4) => 2.56 * parseFloat(t4));
          return r3.length === 4 && (t3[3] = parseFloat(r3[3])), h$1A.fromArray(t3, s2);
        }
        return h$1A.fromArray(r3.map((t3) => parseFloat(t3)), s2);
      }
      if (e2 === "hsl" && r3.length === 3 || e2 === "hsla" && r3.length === 4)
        return h$1A.fromArray(o$1T(parseFloat(r3[0]), parseFloat(r3[1]) / 100, parseFloat(r3[2]) / 100, parseFloat(r3[3])), s2);
    }
    return null;
  }
  static fromHex(t2, r2 = new h$1A()) {
    if (t2.length !== 4 && t2.length !== 7 || t2[0] !== "#")
      return null;
    const s2 = t2.length === 4 ? 4 : 8, i2 = (1 << s2) - 1;
    let e2 = Number("0x" + t2.substr(1));
    return isNaN(e2) ? null : (["b", "g", "r"].forEach((t3) => {
      const a2 = e2 & i2;
      e2 >>= s2, r2[t3] = s2 === 4 ? 17 * a2 : a2;
    }), r2.a = 1, r2);
  }
  static fromArray(t2, r2 = new h$1A()) {
    return r2._set(Number(t2[0]), Number(t2[1]), Number(t2[2]), Number(t2[3])), isNaN(r2.a) && (r2.a = 1), r2._sanitize();
  }
  static fromString(t2, i2) {
    const e2 = r$1C(t2) ? l$2j(t2) : null;
    return e2 && h$1A.fromArray(e2, i2) || h$1A.fromRgb(t2, i2) || h$1A.fromHex(t2, i2);
  }
  static fromJSON(t2) {
    return t2 && new h$1A([t2[0], t2[1], t2[2], t2[3] / 255]);
  }
  static toUnitRGB(t2) {
    return r$1$(t2) ? [t2.r / 255, t2.g / 255, t2.b / 255] : null;
  }
  static toUnitRGBA(t2) {
    return r$1$(t2) ? [t2.r / 255, t2.g / 255, t2.b / 255, t2.a != null ? t2.a : 1] : null;
  }
  get isBright() {
    return 0.299 * this.r + 0.587 * this.g + 0.114 * this.b >= 127;
  }
  setColor(t2) {
    var _a2, _b2, _c2, _d2;
    return typeof t2 == "string" ? h$1A.fromString(t2, this) : Array.isArray(t2) ? h$1A.fromArray(t2, this) : (this._set((_a2 = t2.r) != null ? _a2 : 0, (_b2 = t2.g) != null ? _b2 : 0, (_c2 = t2.b) != null ? _c2 : 0, (_d2 = t2.a) != null ? _d2 : 1), t2 instanceof h$1A || this._sanitize()), this;
  }
  toRgb() {
    return [this.r, this.g, this.b];
  }
  toRgba() {
    return [this.r, this.g, this.b, this.a];
  }
  toHex() {
    const t2 = this.r.toString(16), r2 = this.g.toString(16), s2 = this.b.toString(16);
    return `#${t2.length < 2 ? "0" + t2 : t2}${r2.length < 2 ? "0" + r2 : r2}${s2.length < 2 ? "0" + s2 : s2}`;
  }
  toCss(t2 = false) {
    const r2 = this.r + ", " + this.g + ", " + this.b;
    return t2 ? `rgba(${r2}, ${this.a})` : `rgb(${r2})`;
  }
  toString() {
    return this.toCss(true);
  }
  toJSON() {
    return this.toArray();
  }
  toArray(t2 = h$1A.AlphaMode.ALWAYS) {
    const r2 = n$2t(this.r), s2 = n$2t(this.g), i2 = n$2t(this.b);
    return t2 === h$1A.AlphaMode.ALWAYS || this.a !== 1 ? [r2, s2, i2, n$2t(255 * this.a)] : [r2, s2, i2];
  }
  clone() {
    return new h$1A(this.toRgba());
  }
  hash() {
    return this.r << 24 | this.g << 16 | this.b << 8 | 255 * this.a;
  }
  equals(t2) {
    return r$1$(t2) && t2.r === this.r && t2.g === this.g && t2.b === this.b && t2.a === this.a;
  }
  _sanitize() {
    return this.r = Math.round(o$1O(this.r, 0, 255)), this.g = Math.round(o$1O(this.g, 0, 255)), this.b = Math.round(o$1O(this.b, 0, 255)), this.a = o$1O(this.a, 0, 1), this;
  }
  _set(t2, r2, s2, i2) {
    this.r = t2, this.g = r2, this.b = s2, this.a = i2;
  }
}
h$1A.prototype.declaredClass = "esri.Color", function(t2) {
  var r2;
  (r2 = t2.AlphaMode || (t2.AlphaMode = {}))[r2.ALWAYS = 0] = "ALWAYS", r2[r2.UNLESS_OPAQUE = 1] = "UNLESS_OPAQUE";
}(h$1A || (h$1A = {}));
const l$2e = h$1A;
const p$34 = new s$2a({ esriSMS: "simple-marker", esriPMS: "picture-marker", esriSLS: "simple-line", esriSFS: "simple-fill", esriPFS: "picture-fill", esriTS: "text", esriSHD: "shield-label-symbol", PointSymbol3D: "point-3d", LineSymbol3D: "line-3d", PolygonSymbol3D: "polygon-3d", WebStyleSymbol: "web-style", MeshSymbol3D: "mesh-3d", LabelSymbol3D: "label-3d", CIMSymbolReference: "cim" });
let c$2L = 0, m$29 = class extends l$2B {
  constructor(r2) {
    super(r2), this.id = "sym" + c$2L++, this.type = null, this.color = new l$2e([0, 0, 0, 1]);
  }
  readColor(r2) {
    return r2 && r2[0] != null ? [r2[0], r2[1], r2[2], r2[3] / 255] : r2;
  }
  async collectRequiredFields(r2, o2) {
  }
  hash() {
    return JSON.stringify(this.toJSON());
  }
  clone() {
  }
};
e$2g([y$1I({ type: p$34.apiValues, readOnly: true, json: { read: false, write: { ignoreOrigin: true, writer: p$34.write } } })], m$29.prototype, "type", void 0), e$2g([y$1I({ type: l$2e, json: { write: { allowNull: true } } })], m$29.prototype, "color", void 0), e$2g([o$29("color")], m$29.prototype, "readColor", null), m$29 = e$2g([n$2P("esri.symbols.Symbol")], m$29);
const a$2u = m$29;
var m$28;
let l$2d = m$28 = class extends a$2u {
  constructor(r2) {
    super(r2), this.data = null, this.type = "cim";
  }
  readData(r2, o2) {
    return o2;
  }
  writeData(r2, o2) {
    if (r2)
      for (const t2 in r2)
        o2[t2] = r2[t2];
  }
  async collectRequiredFields(r2, o2) {
    var _a2;
    if (((_a2 = this.data) == null ? void 0 : _a2.type) === "CIMSymbolReference") {
      const t2 = this.data.primitiveOverrides;
      if (t2) {
        const e2 = t2.map((t3) => {
          const e3 = t3.valueExpressionInfo;
          return S$Q(r2, o2, e3.expression);
        });
        await Promise.all(e2);
      }
    }
  }
  clone() {
    return new m$28({ data: y$1L(this.data) });
  }
  hash() {
    return c$3r(JSON.stringify(this.data)).toString();
  }
};
e$2g([y$1I({ json: { write: false } })], l$2d.prototype, "color", void 0), e$2g([y$1I({ json: { write: true } })], l$2d.prototype, "data", void 0), e$2g([o$29("data", ["symbol"])], l$2d.prototype, "readData", null), e$2g([r$1P("data", {})], l$2d.prototype, "writeData", null), e$2g([r$1H({ CIMSymbolReference: "cim" }, { readOnly: true })], l$2d.prototype, "type", void 0), l$2d = m$28 = e$2g([n$2P("esri.symbols.CIMSymbol")], l$2d);
const d$1H = l$2d;
let p$33 = class extends l$2B {
  constructor(e2) {
    super(e2), this.enabled = true, this.type = null;
  }
  writeEnabled(e2, r2, o2) {
    e2 || (r2[o2] = e2);
  }
};
e$2g([y$1I({ type: Boolean, json: { read: { source: "enable" }, write: { target: "enable" } } })], p$33.prototype, "enabled", void 0), e$2g([r$1P("enabled")], p$33.prototype, "writeEnabled", null), e$2g([y$1I({ type: ["icon", "object", "line", "path", "fill", "water", "extrude", "text"], readOnly: true })], p$33.prototype, "type", void 0), p$33 = e$2g([n$2P("esri.symbols.Symbol3DLayer")], p$33);
const a$2t = p$33;
const n$2s = /^-?(\d+(\.\d+)?)\s*((px)|(pt))?$/i, t$1S = "screenUtils.toPt: input not recognized!", r$1x = 96;
function u$1Q(n2) {
  return n2 ? n2 / 72 * r$1x : 0;
}
function e$1D(n2) {
  return n2 ? 72 * n2 / r$1x : 0;
}
function o$1N(r2) {
  if (typeof r2 == "string") {
    const u2 = r2.match(n$2s);
    if (u2) {
      const n2 = Number(u2[1]), t2 = u2[3] && u2[3].toLowerCase(), o2 = r2.charAt(0) === "-", c2 = t2 === "px" ? e$1D(n2) : n2;
      return o2 ? -c2 : c2;
    }
    return console.warn(t$1S), null;
  }
  return r2;
}
function c$2K(n2 = 0, t2 = 0) {
  return { x: n2, y: t2 };
}
function i$2w(n2 = 0, t2 = 0) {
  return [n2, t2];
}
function x$R(n2 = 0, t2 = 0, r2 = 0) {
  return p$32([n2, t2, r2]);
}
function y$1o(n2) {
  return n2;
}
function p$32(n2) {
  return n2;
}
function l$2c(n2) {
  return n2;
}
function d$1G(n2, t2) {
  return t2 ? (t2[0] = n2.x, t2[1] = n2.y, t2.length > 2 && (t2[2] = 0), t2) : [n2.x, n2.y];
}
function n$2r(n2) {
  const r2 = s$2y(100 * (1 - n2));
  return Math.max(0, Math.min(r2, 100));
}
function r$1w(t2) {
  const n2 = 1 - t2 / 100;
  return Math.max(0, Math.min(n2, 1));
}
function s$1W(o2, t2) {
  const n2 = t2.transparency != null ? r$1w(t2.transparency) : 1, s2 = t2.color;
  return s2 && Array.isArray(s2) ? new l$2e([s2[0] || 0, s2[1] || 0, s2[2] || 0, n2]) : null;
}
function c$2J(r2, o2) {
  o2.color = r2.toJSON().slice(0, 3);
  const t2 = n$2r(r2.a);
  t2 !== 0 && (o2.transparency = t2);
}
const p$31 = { type: l$2e, json: { type: [T$G], default: null, read: { source: ["color", "transparency"], reader: s$1W }, write: { target: { color: { type: [T$G] }, transparency: { type: T$G } }, writer: c$2J } } }, a$2s = { type: Number, cast: o$1N, json: { write: true } };
let l$2b = class extends l$2B {
  constructor(o2) {
    super(o2), this.color = new l$2e([0, 0, 0, 1]), this.extensionLength = 0, this.size = e$1D(1);
  }
  clone() {
  }
  cloneProperties() {
    return { color: y$1L(this.color), size: this.size, extensionLength: this.extensionLength };
  }
};
e$2g([y$1I({ type: ["solid", "sketch"], readOnly: true, json: { read: true, write: { ignoreOrigin: true } } })], l$2b.prototype, "type", void 0), e$2g([y$1I(p$31)], l$2b.prototype, "color", void 0), e$2g([y$1I(__spreadProps(__spreadValues({}, a$2s), { json: { write: { overridePolicy: (o2) => ({ enabled: !!o2 }) } } }))], l$2b.prototype, "extensionLength", void 0), e$2g([y$1I(a$2s)], l$2b.prototype, "size", void 0), l$2b = e$2g([n$2P("esri.symbols.edges.Edges3D")], l$2b);
const m$27 = l$2b;
var t$1R;
let c$2I = t$1R = class extends m$27 {
  constructor(r2) {
    super(r2), this.type = "sketch";
  }
  clone() {
    return new t$1R(this.cloneProperties());
  }
};
e$2g([r$1H({ sketch: "sketch" }, { readOnly: true })], c$2I.prototype, "type", void 0), c$2I = t$1R = e$2g([n$2P("esri.symbols.edges.SketchEdges3D")], c$2I);
const p$30 = c$2I;
var t$1Q;
let p$2$ = t$1Q = class extends m$27 {
  constructor(r2) {
    super(r2), this.type = "solid";
  }
  clone() {
    return new t$1Q(this.cloneProperties());
  }
};
e$2g([r$1H({ solid: "solid" }, { readOnly: true })], p$2$.prototype, "type", void 0), p$2$ = t$1Q = e$2g([n$2P("esri.symbols.support.SolidEdges3D")], p$2$);
const c$2H = p$2$;
const t$1P = { types: { key: "type", base: m$27, typeMap: { solid: c$2H, sketch: p$30 } }, json: { write: true } };
var p$2_;
let l$2a = p$2_ = class extends l$2B {
  constructor(o2) {
    super(o2), this.color = null;
  }
  clone() {
    const o2 = { color: r$1$(this.color) ? this.color.clone() : null };
    return new p$2_(o2);
  }
};
e$2g([y$1I(p$31)], l$2a.prototype, "color", void 0), l$2a = p$2_ = e$2g([n$2P("esri.symbols.support.Symbol3DMaterial")], l$2a);
var l$29;
let c$2G = l$29 = class extends a$2t {
  constructor(e2) {
    super(e2), this.type = "extrude", this.size = 1, this.material = null, this.castShadows = true, this.edges = null;
  }
  clone() {
    return new l$29({ edges: this.edges && this.edges.clone(), enabled: this.enabled, material: r$1$(this.material) ? this.material.clone() : null, castShadows: this.castShadows, size: this.size });
  }
};
e$2g([r$1H({ Extrude: "extrude" }, { readOnly: true })], c$2G.prototype, "type", void 0), e$2g([y$1I({ type: Number, json: { write: { enabled: true, isRequired: true } }, nonNullable: true })], c$2G.prototype, "size", void 0), e$2g([y$1I({ type: l$2a, json: { write: true } })], c$2G.prototype, "material", void 0), e$2g([y$1I({ type: Boolean, nonNullable: true, json: { write: true, default: true } })], c$2G.prototype, "castShadows", void 0), e$2g([y$1I(t$1P)], c$2G.prototype, "edges", void 0), c$2G = l$29 = e$2g([n$2P("esri.symbols.ExtrudeSymbol3DLayer")], c$2G);
const d$1F = c$2G;
let i$2v = class extends a$2u {
  constructor(r2) {
    super(r2), this.type = "simple-line", this.width = 0.75;
  }
  hash() {
    return `${this.type}.${this.width}`;
  }
};
e$2g([r$1H({ esriSLS: "simple-line" }, { readOnly: true })], i$2v.prototype, "type", void 0), e$2g([y$1I({ type: Number, cast: o$1N, json: { write: true } })], i$2v.prototype, "width", void 0), i$2v = e$2g([n$2P("esri.symbols.LineSymbol")], i$2v);
const c$2F = i$2v;
const e$1C = ["begin", "end", "begin-end"], n$2q = ["arrow", "circle", "square", "diamond", "cross", "x"];
var n$2p;
let m$26 = n$2p = class extends l$2B {
  constructor(r2) {
    super(r2), this.placement = "begin-end", this.type = "line-marker", this.style = "arrow";
  }
  writeStyle(r2, o2, e2, t2) {
    o2[e2] = (t2 == null ? void 0 : t2.origin) === "web-map" ? "arrow" : r2;
  }
  set color(r2) {
    this._set("color", r2);
  }
  readColor(r2) {
    return r2 && r2[0] != null ? [r2[0], r2[1], r2[2], r2[3] / 255] : r2;
  }
  writeColor(r2, o2, e2, t2) {
    (t2 == null ? void 0 : t2.origin) === "web-map" || (o2[e2] = r2);
  }
  clone() {
    return new n$2p({ color: y$1L(this.color), placement: this.placement, style: this.style });
  }
  hash() {
    var _a2;
    return `${this.placement}.${(_a2 = this.color) == null ? void 0 : _a2.hash()}.${this.style}`;
  }
};
e$2g([y$1I({ type: ["begin", "end", "begin-end"], json: { write: true } })], m$26.prototype, "placement", void 0), e$2g([r$1H({ "line-marker": "line-marker" }, { readOnly: true }), y$1I({ json: { origins: { "web-map": { write: false } } } })], m$26.prototype, "type", void 0), e$2g([y$1I({ type: n$2q })], m$26.prototype, "style", void 0), e$2g([r$1P("style")], m$26.prototype, "writeStyle", null), e$2g([y$1I({ type: l$2e, value: null, json: { write: { allowNull: true } } })], m$26.prototype, "color", null), e$2g([o$29("color")], m$26.prototype, "readColor", null), e$2g([r$1P("color")], m$26.prototype, "writeColor", null), m$26 = n$2p = e$2g([n$2P("esri.symbols.LineSymbolMarker")], m$26);
const u$1P = m$26;
var p$2Z;
const h$1z = new s$2a({ esriSLSSolid: "solid", esriSLSDash: "dash", esriSLSDot: "dot", esriSLSDashDot: "dash-dot", esriSLSDashDotDot: "long-dash-dot-dot", esriSLSNull: "none", esriSLSInsideFrame: "inside-frame", esriSLSShortDash: "short-dash", esriSLSShortDot: "short-dot", esriSLSShortDashDot: "short-dash-dot", esriSLSShortDashDotDot: "short-dash-dot-dot", esriSLSLongDash: "long-dash", esriSLSLongDashDot: "long-dash-dot" });
let d$1E = p$2Z = class extends c$2F {
  constructor(...r2) {
    super(...r2), this.type = "simple-line", this.style = "solid", this.cap = "round", this.join = "round", this.marker = null, this.miterLimit = 2;
  }
  normalizeCtorArgs(r2, o2, e2, s2, i2, n2) {
    if (r2 && typeof r2 != "string")
      return r2;
    const l2 = {};
    return r2 != null && (l2.style = r2), o2 != null && (l2.color = o2), e2 != null && (l2.width = o$1N(e2)), s2 != null && (l2.cap = s2), i2 != null && (l2.join = i2), n2 != null && (l2.miterLimit = o$1N(n2)), l2;
  }
  clone() {
    var _a2;
    return new p$2Z({ color: y$1L(this.color), style: this.style, width: this.width, cap: this.cap, join: this.join, miterLimit: this.miterLimit, marker: (_a2 = this.marker) == null ? void 0 : _a2.clone() });
  }
  hash() {
    var _a2, _b2;
    return `${super.hash()}.${(_a2 = this.color) == null ? void 0 : _a2.hash()}.${this.style}.${this.cap}.${this.join}.${this.miterLimit}.${(_b2 = this.marker) == null ? void 0 : _b2.hash()}`;
  }
};
e$2g([r$1H({ esriSLS: "simple-line" }, { readOnly: true })], d$1E.prototype, "type", void 0), e$2g([y$1I({ type: h$1z.apiValues, json: { read: h$1z.read, write: h$1z.write } })], d$1E.prototype, "style", void 0), e$2g([y$1I({ type: ["butt", "round", "square"], json: { write: { overridePolicy: (r2, o2, e2) => ({ enabled: r2 !== "round" && (e2 == null || e2.origin == null) }) } } })], d$1E.prototype, "cap", void 0), e$2g([y$1I({ type: ["miter", "round", "bevel"], json: { write: { overridePolicy: (r2, o2, e2) => ({ enabled: r2 !== "round" && (e2 == null || e2.origin == null) }) } } })], d$1E.prototype, "join", void 0), e$2g([y$1I({ types: { key: "type", base: null, defaultKeyValue: "line-marker", typeMap: { "line-marker": u$1P } }, json: { write: true, origins: { "web-scene": { write: false } } } })], d$1E.prototype, "marker", void 0), e$2g([y$1I({ type: Number, json: { read: false, write: false } })], d$1E.prototype, "miterLimit", void 0), d$1E = p$2Z = e$2g([n$2P("esri.symbols.SimpleLineSymbol")], d$1E);
const m$25 = d$1E;
let l$28 = class extends a$2u {
  constructor(e2) {
    super(e2), this.outline = null, this.type = null;
  }
  hash() {
    return `${this.type}.${this.outline && this.outline.hash()}`;
  }
};
e$2g([y$1I({ types: { key: "type", base: null, defaultKeyValue: "simple-line", typeMap: { "simple-line": m$25 } }, json: { default: null, write: true } })], l$28.prototype, "outline", void 0), e$2g([y$1I({ type: ["simple-fill", "picture-fill"], readOnly: true })], l$28.prototype, "type", void 0), l$28 = e$2g([n$2P("esri.symbols.FillSymbol")], l$28);
const p$2Y = l$28;
let t$1O = class extends l$2B {
  constructor(r2) {
    super(r2);
  }
  clone() {
  }
};
e$2g([y$1I({ type: ["style"], readOnly: true, json: { read: true, write: { ignoreOrigin: true } } })], t$1O.prototype, "type", void 0), t$1O = e$2g([n$2P("esri.symbols.patterns.LinePattern3D")], t$1O);
const p$2X = t$1O;
const o$1M = ["dash", "dash-dot", "dot", "long-dash", "long-dash-dot", "long-dash-dot-dot", "none", "short-dash", "short-dash-dot", "short-dash-dot-dot", "short-dot", "solid"];
var p$2W;
const h$1y = o$1_()({ dash: "dash", "dash-dot": "dash-dot", "dash-dot-dot": "long-dash-dot-dot", dot: "dot", "long-dash": "long-dash", "long-dash-dot": "long-dash-dot", null: "none", "short-dash": "short-dash", "short-dash-dot": "short-dash-dot", "short-dash-dot-dot": "short-dash-dot-dot", "short-dot": "short-dot", solid: "solid" });
let l$27 = p$2W = class extends p$2X {
  constructor(o2) {
    super(o2), this.type = "style", this.style = "solid";
  }
  clone() {
    const o2 = { style: this.style };
    return new p$2W(o2);
  }
};
e$2g([y$1I({ type: ["style"] })], l$27.prototype, "type", void 0), e$2g([r$1H(h$1y), y$1I({ type: o$1M })], l$27.prototype, "style", void 0), l$27 = p$2W = e$2g([n$2P("esri.symbols.patterns.LineStylePattern3D")], l$27);
const n$2o = l$27;
let t$1N = class extends l$2B {
  constructor(r2) {
    super(r2);
  }
  clone() {
  }
};
e$2g([y$1I({ type: ["style"], readOnly: true, json: { read: true, write: { ignoreOrigin: true } } })], t$1N.prototype, "type", void 0), t$1N = e$2g([n$2P("esri.symbols.patterns.Pattern3D")], t$1N);
const p$2V = t$1N;
const a$2r = ["backward-diagonal", "cross", "diagonal-cross", "forward-diagonal", "horizontal", "none", "solid", "vertical"];
var p$2U;
let c$2E = p$2U = class extends p$2V {
  constructor(t2) {
    super(t2), this.type = "style", this.style = "solid";
  }
  clone() {
    const t2 = { style: this.style };
    return new p$2U(t2);
  }
};
e$2g([y$1I({ type: ["style"] })], c$2E.prototype, "type", void 0), e$2g([y$1I({ type: a$2r, json: { read: true, write: true } })], c$2E.prototype, "style", void 0), c$2E = p$2U = e$2g([n$2P("esri.symbols.patterns.StylePattern3D")], c$2E);
const y$1n = c$2E;
const s$1V = { types: { key: "type", base: p$2V, typeMap: { style: y$1n } }, json: { write: true } }, o$1L = { types: { key: "type", base: p$2X, typeMap: { style: n$2o } }, json: { write: true } };
const o$1K = new l$2e("white");
new l$2e("black");
const e$1B = new l$2e([255, 255, 255, 0]);
function t$1M(n2) {
  return n2.r === 0 && n2.g === 0 && n2.b === 0;
}
var c$2D;
let l$26 = c$2D = class extends l$2a {
  constructor(o2) {
    super(o2), this.colorMixMode = null;
  }
  clone() {
    const o2 = { color: r$1$(this.color) ? this.color.clone() : null, colorMixMode: this.colorMixMode };
    return new c$2D(o2);
  }
};
e$2g([r$1H({ multiply: "multiply", replace: "replace", tint: "tint" })], l$26.prototype, "colorMixMode", void 0), l$26 = c$2D = e$2g([n$2P("esri.symbols.support.Symbol3DFillMaterial")], l$26);
function i$2u(n2) {
  return n2;
}
function u$1O(n2 = L$s) {
  return i$2u([n2[0], n2[1], n2[2], n2[3]]);
}
function e$1A(n2) {
  return i$2u([n2[0], n2[1], n2[2], n2[3]]);
}
function a$2q(n2, t2) {
  return n2 !== t2 && (n2[0] = t2[0], n2[1] = t2[1], n2[2] = t2[2], n2[3] = t2[3]), n2;
}
function o$1J(n2, t2, r2, i2, e2 = u$1O()) {
  return e2[0] = n2, e2[1] = t2, e2[2] = r2, e2[3] = i2, e2;
}
function c$2C(n2, t2 = u$1O()) {
  return t2[0] = n2.xmin, t2[1] = n2.ymin, t2[2] = n2.xmax, t2[3] = n2.ymax, t2;
}
function f$1A(n2, t2) {
  return new w$Z({ xmin: n2[0], ymin: n2[1], xmax: n2[2], ymax: n2[3], spatialReference: t2 });
}
function m$24(n2, t2) {
  t2[0] < n2[0] && (n2[0] = t2[0]), t2[0] > n2[2] && (n2[2] = t2[0]), t2[1] < n2[1] && (n2[1] = t2[1]), t2[1] > n2[3] && (n2[3] = t2[1]);
}
function h$1x(n2, r2, i2) {
  if (t$2r(r2))
    a$2q(i2, n2);
  else if ("length" in r2)
    G$s(r2) ? (i2[0] = Math.min(n2[0], r2[0]), i2[1] = Math.min(n2[1], r2[1]), i2[2] = Math.max(n2[2], r2[2]), i2[3] = Math.max(n2[3], r2[3])) : r2.length !== 2 && r2.length !== 3 || (i2[0] = Math.min(n2[0], r2[0]), i2[1] = Math.min(n2[1], r2[1]), i2[2] = Math.max(n2[2], r2[0]), i2[3] = Math.max(n2[3], r2[1]));
  else
    switch (r2.type) {
      case "extent":
        i2[0] = Math.min(n2[0], r2.xmin), i2[1] = Math.min(n2[1], r2.ymin), i2[2] = Math.max(n2[2], r2.xmax), i2[3] = Math.max(n2[3], r2.ymax);
        break;
      case "point":
        i2[0] = Math.min(n2[0], r2.x), i2[1] = Math.min(n2[1], r2.y), i2[2] = Math.max(n2[2], r2.x), i2[3] = Math.max(n2[3], r2.y);
    }
}
function x$Q(n2, t2, r2 = n2) {
  const i2 = t2.length;
  let u2 = n2[0], e2 = n2[1], a2 = n2[2], o2 = n2[3];
  for (let c2 = 0; c2 < i2; c2++) {
    const n3 = t2[c2];
    u2 = Math.min(u2, n3[0]), e2 = Math.min(e2, n3[1]), a2 = Math.max(a2, n3[0]), o2 = Math.max(o2, n3[1]);
  }
  return r2[0] = u2, r2[1] = e2, r2[2] = a2, r2[3] = o2, r2;
}
function M$D(n2) {
  for (let t2 = 0; t2 < 4; t2++)
    if (!isFinite(n2[t2]))
      return false;
  return true;
}
function s$1U(n2) {
  return t$2r(n2) || n2[0] >= n2[2] ? 0 : n2[2] - n2[0];
}
function l$25(n2) {
  return n2[1] >= n2[3] ? 0 : n2[3] - n2[1];
}
function y$1m(n2) {
  return s$1U(n2) * l$25(n2);
}
function p$2T(n2, t2 = [0, 0]) {
  return t2[0] = (n2[0] + n2[2]) / 2, t2[1] = (n2[1] + n2[3]) / 2, t2;
}
function b$$(n2, t2) {
  return w$U(n2, t2[0], t2[1]);
}
function F$x(n2, t2) {
  return w$U(n2, t2.x, t2.y);
}
function w$U(n2, t2, r2) {
  return t2 >= n2[0] && r2 >= n2[1] && t2 <= n2[2] && r2 <= n2[3];
}
function q$o(n2, t2, r2) {
  return t2[0] >= n2[0] - r2 && t2[1] >= n2[1] - r2 && t2[0] <= n2[2] + r2 && t2[1] <= n2[3] + r2;
}
function E$I(n2, t2) {
  return Math.max(t2[0], n2[0]) <= Math.min(t2[2], n2[2]) && Math.max(t2[1], n2[1]) <= Math.min(t2[3], n2[3]);
}
function R$y(n2, t2) {
  return t2[0] >= n2[0] && t2[2] <= n2[2] && t2[1] >= n2[1] && t2[3] <= n2[3];
}
function z$E(n2, t2, r2, i2 = n2) {
  return i2[0] = n2[0] + t2, i2[1] = n2[1] + r2, i2[2] = n2[2] + t2, i2[3] = n2[3] + r2, i2;
}
function D$u(n2) {
  return n2 ? a$2q(n2, K$h) : u$1O(K$h);
}
function G$s(n2) {
  return n2 != null && n2.length === 4;
}
function I$F(n2, t2) {
  return G$s(n2) && G$s(t2) ? n2[0] === t2[0] && n2[1] === t2[1] && n2[2] === t2[2] && n2[3] === t2[3] : n2 === t2;
}
const K$h = i$2u([1 / 0, 1 / 0, -1 / 0, -1 / 0]), L$s = i$2u([0, 0, 0, 0]);
function i$2t(n2) {
  return n2;
}
function a$2p(n2 = D$t) {
  return i$2t([n2[0], n2[1], n2[2], n2[3], n2[4], n2[5]]);
}
function u$1N(n2, t2, r2, i2, u2, e2, m2 = a$2p()) {
  return m2[0] = n2, m2[1] = t2, m2[2] = r2, m2[3] = i2, m2[4] = u2, m2[5] = e2, m2;
}
function m$23(n2, r2) {
  const i2 = isFinite(n2[2]) || isFinite(n2[5]);
  return new w$Z(i2 ? { xmin: n2[0], xmax: n2[3], ymin: n2[1], ymax: n2[4], zmin: n2[2], zmax: n2[5], spatialReference: r2 } : { xmin: n2[0], xmax: n2[3], ymin: n2[1], ymax: n2[4], spatialReference: r2 });
}
function f$1z(n2, t2) {
  n2[0] = Math.min(n2[0], t2[0]), n2[1] = Math.min(n2[1], t2[1]), n2[2] = Math.min(n2[2], t2[2]), n2[3] = Math.max(n2[3], t2[3]), n2[4] = Math.max(n2[4], t2[4]), n2[5] = Math.max(n2[5], t2[5]);
}
function h$1w(n2, t2) {
  n2[0] = Math.min(n2[0], t2[0]), n2[1] = Math.min(n2[1], t2[1]), n2[3] = Math.max(n2[3], t2[2]), n2[4] = Math.max(n2[4], t2[3]);
}
function c$2B(n2, t2) {
  n2[0] = Math.min(n2[0], t2[0]), n2[1] = Math.min(n2[1], t2[1]), n2[2] = Math.min(n2[2], t2[2]), n2[3] = Math.max(n2[3], t2[0]), n2[4] = Math.max(n2[4], t2[1]), n2[5] = Math.max(n2[5], t2[2]);
}
function M$C(n2, t2, r2 = 0, i2 = t2.length / 3) {
  let a2 = n2[0], u2 = n2[1], e2 = n2[2], m2 = n2[3], o2 = n2[4], f2 = n2[5];
  for (let h2 = 0; h2 < i2; h2++)
    a2 = Math.min(a2, t2[r2 + 3 * h2]), u2 = Math.min(u2, t2[r2 + 3 * h2 + 1]), e2 = Math.min(e2, t2[r2 + 3 * h2 + 2]), m2 = Math.max(m2, t2[r2 + 3 * h2]), o2 = Math.max(o2, t2[r2 + 3 * h2 + 1]), f2 = Math.max(f2, t2[r2 + 3 * h2 + 2]);
  n2[0] = a2, n2[1] = u2, n2[2] = e2, n2[3] = m2, n2[4] = o2, n2[5] = f2;
}
function s$1T(n2, t2, r2) {
  const i2 = t2.length;
  let a2 = n2[0], u2 = n2[1], e2 = n2[2], m2 = n2[3], o2 = n2[4], f2 = n2[5];
  if (r2)
    for (let h2 = 0; h2 < i2; h2++) {
      const n3 = t2[h2];
      a2 = Math.min(a2, n3[0]), u2 = Math.min(u2, n3[1]), e2 = Math.min(e2, n3[2]), m2 = Math.max(m2, n3[0]), o2 = Math.max(o2, n3[1]), f2 = Math.max(f2, n3[2]);
    }
  else
    for (let h2 = 0; h2 < i2; h2++) {
      const n3 = t2[h2];
      a2 = Math.min(a2, n3[0]), u2 = Math.min(u2, n3[1]), m2 = Math.max(m2, n3[0]), o2 = Math.max(o2, n3[1]);
    }
  n2[0] = a2, n2[1] = u2, n2[2] = e2, n2[3] = m2, n2[4] = o2, n2[5] = f2;
}
function l$24(n2) {
  for (let t2 = 0; t2 < 6; t2++)
    if (!isFinite(n2[t2]))
      return false;
  return true;
}
function I$E(n2) {
  return n2[0] >= n2[3] ? 0 : n2[3] - n2[0];
}
function y$1l(n2) {
  return n2[1] >= n2[4] ? 0 : n2[4] - n2[1];
}
function N$r(n2) {
  return n2[2] >= n2[5] ? 0 : n2[5] - n2[2];
}
function g$16(n2) {
  const t2 = I$E(n2), r2 = N$r(n2), i2 = y$1l(n2);
  return Math.sqrt(t2 * t2 + r2 * r2 + i2 * i2);
}
function p$2S(n2, t2 = [0, 0, 0]) {
  return t2[0] = n2[0] + I$E(n2) / 2, t2[1] = n2[1] + y$1l(n2) / 2, t2[2] = n2[2] + N$r(n2) / 2, t2;
}
function F$w(n2, t2 = [0, 0, 0]) {
  return t2[0] = I$E(n2), t2[1] = y$1l(n2), t2[2] = N$r(n2), t2;
}
function E$H(n2, t2) {
  return t2[0] >= n2[0] && t2[1] >= n2[1] && t2[2] >= n2[2] && t2[0] <= n2[3] && t2[1] <= n2[4] && t2[2] <= n2[5];
}
function j$R(n2, t2) {
  return Math.max(t2[0], n2[0]) <= Math.min(t2[3], n2[3]) && Math.max(t2[1], n2[1]) <= Math.min(t2[4], n2[4]) && Math.max(t2[2], n2[2]) <= Math.min(t2[5], n2[5]);
}
function R$x(t2, r2) {
  return !!t$2r(r2) || j$R(t2, r2);
}
function V$n(n2, t2, r2, i2, a2 = n2) {
  return a2[0] = n2[0] + t2, a2[1] = n2[1] + r2, a2[2] = n2[2] + i2, a2[3] = n2[3] + t2, a2[4] = n2[4] + r2, a2[5] = n2[5] + i2, a2;
}
function Y$f(n2, t2, r2 = n2) {
  const i2 = n2[0] + I$E(n2) / 2, a2 = n2[1] + y$1l(n2) / 2, u2 = n2[2] + N$r(n2) / 2;
  return r2[0] = i2 + (n2[0] - i2) * t2, r2[1] = a2 + (n2[1] - a2) * t2, r2[2] = u2 + (n2[2] - u2) * t2, r2[3] = i2 + (n2[3] - i2) * t2, r2[4] = a2 + (n2[4] - a2) * t2, r2[5] = u2 + (n2[5] - u2) * t2, r2;
}
function Z$g(n2, t2) {
  return t2[0] = n2[0], t2[1] = n2[1], t2[2] = n2[2], t2;
}
function d$1D(n2, t2, r2 = n2) {
  return r2[0] = t2[0], r2[1] = t2[1], r2[2] = t2[2], r2 !== n2 && (r2[3] = n2[3], r2[4] = n2[4], r2[5] = n2[5]), r2;
}
function q$n(n2, t2, r2 = n2) {
  return r2[3] = t2[0], r2[4] = t2[1], r2[5] = t2[2], r2 !== n2 && (r2[0] = n2[0], r2[1] = n2[1], r2[2] = n2[2]), n2;
}
function w$T(n2, t2) {
  return n2[0] = t2[0], n2[1] = t2[1], n2[2] = t2[2], n2[3] = t2[3], n2[4] = t2[4], n2[5] = t2[5], n2;
}
function A$u(n2) {
  return n2 ? w$T(n2, C$y) : a$2p(C$y);
}
function B$s(n2, t2) {
  return t2 || (t2 = u$1O()), t2[0] = n2[0], t2[1] = n2[1], t2[2] = n2[3], t2[3] = n2[4], t2;
}
function G$r(n2, t2) {
  return n2[0] = t2[0], n2[1] = t2[1], n2[2] = Number.NEGATIVE_INFINITY, n2[3] = t2[2], n2[4] = t2[3], n2[5] = Number.POSITIVE_INFINITY, n2;
}
function O$x(n2) {
  return n2.length === 6;
}
function P$y(n2) {
  return I$E(n2) === 0 && y$1l(n2) === 0 && N$r(n2) === 0;
}
function S$M(t2, r2, i2) {
  if (t$2r(t2) || t$2r(r2))
    return t2 === r2;
  if (!O$x(t2) || !O$x(r2))
    return false;
  if (i2) {
    for (let n2 = 0; n2 < t2.length; n2++)
      if (!i2(t2[n2], r2[n2]))
        return false;
  } else
    for (let n2 = 0; n2 < t2.length; n2++)
      if (t2[n2] !== r2[n2])
        return false;
  return true;
}
const C$y = i$2t([1 / 0, 1 / 0, 1 / 0, -1 / 0, -1 / 0, -1 / 0]), D$t = i$2t([0, 0, 0, 0, 0, 0]);
a$2p();
function t$1L(r2, { isPrimitive: t2, width: n2, depth: o2, height: s2 }) {
  const c2 = t2 ? 10 : 1;
  if (n2 == null && s2 == null && o2 == null)
    return [c2 * r2[0], c2 * r2[1], c2 * r2[2]];
  const u2 = r$1B(n2, o2, s2);
  let i2;
  for (let e2 = 0; e2 < 3; e2++) {
    const t3 = u2[e2];
    if (t3 != null) {
      i2 = t3 / r2[e2];
      break;
    }
  }
  for (let e2 = 0; e2 < 3; e2++)
    u2[e2] == null && (u2[e2] = r2[e2] * i2);
  return u2;
}
const n$2n = u$1N(-0.5, -0.5, -0.5, 0.5, 0.5, 0.5), o$1I = u$1N(-0.5, -0.5, 0, 0.5, 0.5, 1), s$1S = u$1N(-0.5, -0.5, 0, 0.5, 0.5, 0.5);
function c$2A(e2) {
  switch (e2) {
    case "sphere":
    case "cube":
    case "diamond":
      return n$2n;
    case "cylinder":
    case "cone":
    case "inverted-cone":
      return o$1I;
    case "tetrahedron":
      return s$1S;
    default:
      return;
  }
}
const u$1M = ["butt", "square", "round"], i$2s = [...u$1M, "none"], a$2o = ["miter", "bevel", "round"];
var m$22;
let u$1L = m$22 = class extends l$2B {
  constructor(t2) {
    super(t2), this.color = new l$2e([0, 0, 0, 1]), this.size = e$1D(1), this.pattern = null, this.patternCap = "butt";
  }
  clone() {
    const t2 = { color: r$1$(this.color) ? this.color.clone() : null, size: this.size, pattern: r$1$(this.pattern) ? this.pattern.clone() : null, patternCap: this.patternCap };
    return new m$22(t2);
  }
};
e$2g([y$1I(p$31)], u$1L.prototype, "color", void 0), e$2g([y$1I(a$2s)], u$1L.prototype, "size", void 0), e$2g([y$1I(o$1L)], u$1L.prototype, "pattern", void 0), e$2g([y$1I({ type: u$1M, json: { default: "butt", write: { overridePolicy() {
  return { enabled: r$1$(this.pattern) };
} } } })], u$1L.prototype, "patternCap", void 0), u$1L = m$22 = e$2g([n$2P("esri.symbols.support.Symbol3DOutline")], u$1L);
var d$1C;
let h$1v = d$1C = class extends a$2t {
  constructor(t2) {
    super(t2), this.type = "fill", this.material = null, this.pattern = null, this.castShadows = true, this.outline = null, this.edges = null;
  }
  clone() {
    const t2 = { edges: r$1$(this.edges) ? this.edges.clone() : null, enabled: this.enabled, material: r$1$(this.material) ? this.material.clone() : null, pattern: r$1$(this.pattern) ? this.pattern.clone() : null, castShadows: this.castShadows, outline: r$1$(this.outline) ? this.outline.clone() : null };
    return new d$1C(t2);
  }
  static fromSimpleFillSymbol(t2) {
    var _a2, _b2, _c2, _d2, _e3, _f2;
    const e2 = t2.outline && t2.outline.style && t2.outline.style !== "inside-frame" && t2.outline.style !== "solid" ? new n$2o({ style: t2.outline.style }) : null, o2 = { size: (_b2 = (_a2 = t2.outline) == null ? void 0 : _a2.width) != null ? _b2 : 0, color: ((_d2 = (_c2 = t2.outline) == null ? void 0 : _c2.color) != null ? _d2 : o$1K).clone(), pattern: e2 };
    return e2 && ((_e3 = t2.outline) == null ? void 0 : _e3.cap) && (o2.patternCap = t2.outline.cap), new d$1C({ material: new l$26({ color: ((_f2 = t2.color) != null ? _f2 : e$1B).clone() }), pattern: t2.style && t2.style !== "solid" ? new y$1n({ style: t2.style }) : null, outline: o2 });
  }
};
e$2g([r$1H({ Fill: "fill" }, { readOnly: true })], h$1v.prototype, "type", void 0), e$2g([y$1I({ type: l$26, json: { write: true } })], h$1v.prototype, "material", void 0), e$2g([y$1I(s$1V)], h$1v.prototype, "pattern", void 0), e$2g([y$1I({ type: Boolean, nonNullable: true, json: { write: true, default: true } })], h$1v.prototype, "castShadows", void 0), e$2g([y$1I({ type: u$1L, json: { write: true } })], h$1v.prototype, "outline", void 0), e$2g([y$1I(t$1P)], h$1v.prototype, "edges", void 0), h$1v = d$1C = e$2g([n$2P("esri.symbols.FillSymbol3DLayer")], h$1v);
const f$1y = h$1v;
const l$23 = ["none", "underline", "line-through"], t$1K = ["normal", "italic", "oblique"], r$1v = ["normal", "lighter", "bold", "bolder"], n$2m = { type: Number, cast: (l2) => {
  const t2 = a$2_(l2);
  return t2 === 0 ? 1 : a$2v(t2, 0.1, 4);
}, nonNullable: true }, i$2r = ["left", "right", "center"], a$2n = ["baseline", "top", "middle", "bottom"], m$21 = { type: i$2r, nonNullable: true }, p$2R = { type: a$2n, nonNullable: true };
var c$2z;
let l$22 = c$2z = class extends l$2B {
  constructor(t2) {
    super(t2), this.decoration = "none", this.family = "sans-serif", this.size = 9, this.style = "normal", this.weight = "normal";
  }
  castSize(t2) {
    return o$1N(t2);
  }
  clone() {
    return new c$2z({ decoration: this.decoration, family: this.family, size: this.size, style: this.style, weight: this.weight });
  }
  hash() {
    return `${this.decoration}.${this.family}.${this.size}.${this.style}.${this.weight}`;
  }
};
e$2g([y$1I({ type: l$23, json: { default: "none", write: true } })], l$22.prototype, "decoration", void 0), e$2g([y$1I({ type: String, json: { write: true } })], l$22.prototype, "family", void 0), e$2g([y$1I({ type: Number, json: { write: { overridePolicy: (t2, o2, e2) => ({ enabled: !e2 || !e2.textSymbol3D }) } } })], l$22.prototype, "size", void 0), e$2g([s$2i("size")], l$22.prototype, "castSize", null), e$2g([y$1I({ type: t$1K, json: { default: "normal", write: true } })], l$22.prototype, "style", void 0), e$2g([y$1I({ type: r$1v, json: { default: "normal", write: true } })], l$22.prototype, "weight", void 0), l$22 = c$2z = e$2g([n$2P("esri.symbols.Font")], l$22);
const m$20 = l$22;
const s$1R = s$2z.getLogger("esri.core.urlUtils"), u$1K = s$2A.request, l$21 = "esri/config: esriConfig.request.proxyUrl is not set.", c$2y = /^\s*[a-z][a-z0-9-+.]*:(?![0-9])/i, f$1x = /^\s*http:/i, a$2m = /^\s*https:/i, h$1u = /^\s*file:/i, p$2Q = /:\d+$/, d$1B = /^https?:\/\/[^/]+\.arcgis.com\/sharing(\/|$)/i, g$15 = new RegExp("^(([^:/?#]+):)?(//([^/?#]*))?([^?#]*)(\\?([^#]*))?(#(.*))?$"), m$1$ = new RegExp("^((([^\\[:]+):)?([^@]+)@)?(\\[([^\\]]+)\\]|([^\\[:]*))(:([0-9]+))?$");
class y$1k {
  constructor(t2 = "") {
    this.uri = t2, this.scheme = null, this.authority = null, this.path = null, this.query = null, this.fragment = null, this.user = null, this.password = null, this.host = null, this.port = null;
    let n2 = x$16(this.uri.match(g$15));
    this.scheme = n2[2] || (n2[1] ? "" : null), this.authority = n2[4] || (n2[3] ? "" : null), this.path = n2[5], this.query = n2[7] || (n2[6] ? "" : null), this.fragment = n2[9] || (n2[8] ? "" : null), this.authority != null && (n2 = x$16(this.authority.match(m$1$)), this.user = n2[3] || null, this.password = n2[4] || null, this.host = n2[6] || n2[7], this.port = n2[9] || null);
  }
  toString() {
    return this.uri;
  }
}
const $$i = {}, x$P = new y$1k(s$2A.applicationUrl);
let w$S = x$P;
const O$w = q$m();
let U$v = O$w;
const b$_ = () => w$S, C$x = () => U$v;
function q$m() {
  const t2 = x$16(w$S.path), n2 = t2.substring(0, t2.lastIndexOf(t2.split("/")[t2.split("/").length - 1]));
  return `${`${w$S.scheme}://${w$S.host}${w$S.port != null ? `:${w$S.port}` : ""}`}${n2}`;
}
function j$Q(t2) {
  if (!t2)
    return null;
  const n2 = { path: null, query: null }, e2 = new y$1k(t2), r2 = t2.indexOf("?");
  return e2.query === null ? n2.path = t2 : (n2.path = t2.substring(0, r2), n2.query = L$r(e2.query)), e2.fragment && (n2.hash = e2.fragment, e2.query === null && (n2.path = n2.path.substring(0, n2.path.length - (e2.fragment.length + 1)))), n2;
}
function L$r(t2) {
  const n2 = t2.split("&"), e2 = {};
  for (const r2 of n2) {
    if (!r2)
      continue;
    const t3 = r2.indexOf("=");
    let n3, o2;
    t3 < 0 ? (n3 = decodeURIComponent(r2), o2 = "") : (n3 = decodeURIComponent(r2.slice(0, t3)), o2 = decodeURIComponent(r2.slice(t3 + 1)));
    let i2 = e2[n3];
    typeof i2 == "string" && (i2 = e2[n3] = [i2]), Array.isArray(i2) ? i2.push(o2) : e2[n3] = o2;
  }
  return e2;
}
function v$$(t2) {
  return t2 && typeof t2 == "object" && "toJSON" in t2 && typeof t2.toJSON == "function";
}
function I$D(t2, n2) {
  return t2 ? n2 && typeof n2 == "function" ? Object.keys(t2).map((e2) => encodeURIComponent(e2) + "=" + encodeURIComponent(n2(e2, t2[e2]))).join("&") : Object.keys(t2).map((e2) => {
    const r2 = t2[e2];
    if (r2 == null)
      return "";
    const o2 = encodeURIComponent(e2) + "=", i2 = n2 && n2[e2];
    return i2 ? o2 + encodeURIComponent(i2(r2)) : Array.isArray(r2) ? r2.map((t3) => v$$(t3) ? o2 + encodeURIComponent(JSON.stringify(t3)) : o2 + encodeURIComponent(t3)).join("&") : v$$(r2) ? o2 + encodeURIComponent(JSON.stringify(r2)) : o2 + encodeURIComponent(r2);
  }).filter((t3) => t3).join("&") : "";
}
function A$t(t2 = false) {
  let e2, r2 = u$1K.proxyUrl;
  if (typeof t2 == "string") {
    e2 = ht$2(t2);
    const n2 = J$o(t2);
    n2 && (r2 = n2.proxyUrl);
  } else
    e2 = !!t2;
  if (!r2)
    throw s$1R.warn(l$21), new s$2u("urlutils:proxy-not-set", l$21);
  e2 && $t() && (r2 = mt$2(r2));
  return j$Q(r2);
}
function S$L(t2) {
  const n2 = J$o(t2);
  let e2, r2;
  if (n2) {
    const t3 = P$x(n2.proxyUrl);
    e2 = t3.path, r2 = t3.query ? L$r(t3.query) : null;
  }
  if (e2) {
    const n3 = j$Q(t2);
    t2 = e2 + "?" + n3.path;
    const o2 = I$D(__spreadValues(__spreadValues({}, r2), n3.query));
    o2 && (t2 = `${t2}?${o2}`);
  }
  return t2;
}
const B$r = { path: "", query: "" };
function P$x(t2) {
  const n2 = t2.indexOf("?");
  return n2 !== -1 ? (B$r.path = t2.slice(0, n2), B$r.query = t2.slice(n2 + 1)) : (B$r.path = t2, B$r.query = null), B$r;
}
function k$y(t2) {
  return t2 = (t2 = xt$1(t2 = bt$1(t2 = P$x(t2).path), true)).toLowerCase();
}
function E$G(t2) {
  const n2 = { proxyUrl: t2.proxyUrl, urlPrefix: k$y(t2.urlPrefix) }, e2 = u$1K.proxyRules, r2 = n2.urlPrefix;
  let o2 = e2.length;
  for (let i2 = 0; i2 < e2.length; i2++) {
    const t3 = e2[i2].urlPrefix;
    if (r2.indexOf(t3) === 0) {
      if (r2.length === t3.length)
        return -1;
      o2 = i2;
      break;
    }
    t3.indexOf(r2) === 0 && (o2 = i2 + 1);
  }
  return e2.splice(o2, 0, n2), o2;
}
function J$o(t2) {
  const n2 = u$1K.proxyRules, e2 = k$y(t2);
  for (let r2 = 0; r2 < n2.length; r2++)
    if (e2.indexOf(n2[r2].urlPrefix) === 0)
      return n2[r2];
}
function N$q(t2, n2) {
  return t2 = T$y(t2), n2 = T$y(n2), xt$1(t2) === xt$1(n2);
}
function T$y(t2) {
  const n2 = (t2 = F$v(t2)).indexOf("/sharing");
  return n2 > 0 ? t2.substring(0, n2) : t2.replace(/\/+$/, "");
}
function W$g(t2) {
  const n2 = (n3) => n3 == null || n3 instanceof RegExp && n3.test(t2) || typeof n3 == "string" && t2.startsWith(n3), e2 = u$1K.interceptors;
  if (e2) {
    for (const r2 of e2)
      if (Array.isArray(r2.urls)) {
        if (r2.urls.some(n2))
          return r2;
      } else if (n2(r2.urls))
        return r2;
  }
  return null;
}
function z$D(t2, n2, e2 = false) {
  if (!t2 || !n2)
    return false;
  const r2 = vt(t2), o2 = vt(n2);
  return !(!e2 && r2.scheme !== o2.scheme) && (r2.host != null && o2.host != null && (r2.host.toLowerCase() === o2.host.toLowerCase() && r2.port === o2.port));
}
function D$s(t2) {
  if (typeof t2 == "string") {
    if (!K$g(t2))
      return true;
    t2 = vt(t2);
  }
  if (z$D(t2, w$S))
    return true;
  const n2 = u$1K.trustedServers || [];
  for (let e2 = 0; e2 < n2.length; e2++) {
    const r2 = M$B(n2[e2]);
    for (let n3 = 0; n3 < r2.length; n3++)
      if (z$D(t2, r2[n3]))
        return true;
  }
  return false;
}
function M$B(t2) {
  return $$i[t2] || (at$3(t2) || ft$2(t2) ? $$i[t2] = [new y$1k(Q$h(t2))] : $$i[t2] = [new y$1k(`http://${t2}`), new y$1k(`https://${t2}`)]), $$i[t2];
}
function Q$h(t2, n2 = U$v, e2) {
  return ft$2(t2) ? e2 && e2.preserveProtocolRelative ? t2 : w$S.scheme === "http" && w$S.authority === H$j(t2).slice(2) ? `http:${t2}` : `https:${t2}` : at$3(t2) ? t2 : x$16(G$q(t2[0] === "/" ? wt$2(n2) : n2, t2));
}
function _$I(t2, n2 = U$v, e2) {
  if (t2 == null || !K$g(t2))
    return t2;
  const r2 = F$v(t2), o2 = r2.toLowerCase(), i2 = F$v(n2).toLowerCase().replace(/\/+$/, ""), s2 = e2 ? F$v(e2).toLowerCase().replace(/\/+$/, "") : null;
  if (s2 && i2.indexOf(s2) !== 0)
    return t2;
  const u2 = (t3, n3, e3) => (e3 = t3.indexOf(n3, e3)) === -1 ? t3.length : e3;
  let l2 = u2(o2, "/", o2.indexOf("//") + 2), c2 = -1;
  for (; o2.slice(0, l2 + 1) === i2.slice(0, l2) + "/" && (c2 = l2 + 1, l2 !== o2.length); )
    l2 = u2(o2, "/", l2 + 1);
  if (c2 === -1)
    return t2;
  if (s2 && c2 < s2.length)
    return t2;
  t2 = r2.slice(c2);
  const f2 = i2.slice(c2 - 1).replace(/[^/]+/g, "").length;
  if (f2 > 0)
    for (let a2 = 0; a2 < f2; a2++)
      t2 = `../${t2}`;
  else
    t2 = `./${t2}`;
  return t2;
}
function F$v(t2) {
  return t2 = jt$1(t2 = Rt$1(t2 = qt(t2 = Q$h(t2 = t2.trim()))));
}
function G$q(...t2) {
  const n2 = t2.filter(r$1$);
  if (!n2 || !n2.length)
    return;
  const e2 = [];
  if (K$g(n2[0])) {
    const t3 = n2[0], r3 = t3.indexOf("//");
    r3 !== -1 && (e2.push(t3.slice(0, r3 + 1)), dt$2(n2[0]) && (e2[0] += "/"), n2[0] = t3.slice(r3 + 2));
  } else
    n2[0][0] === "/" && e2.push("");
  const r2 = n2.reduce((t3, n3) => n3 ? t3.concat(n3.split("/")) : t3, []);
  for (let o2 = 0; o2 < r2.length; o2++) {
    const t3 = r2[o2];
    t3 === ".." && e2.length > 0 && e2[e2.length - 1] !== ".." ? e2.pop() : (!t3 && o2 === r2.length - 1 || t3 && (t3 !== "." || e2.length === 0)) && e2.push(t3);
  }
  return e2.join("/");
}
function H$j(t2, n2 = false) {
  if (t2 == null || V$m(t2) || X$e(t2))
    return null;
  let e2 = t2.indexOf("://");
  if (e2 === -1 && ft$2(t2))
    e2 = 2;
  else {
    if (e2 === -1)
      return null;
    e2 += 3;
  }
  const r2 = t2.indexOf("/", e2);
  return r2 !== -1 && (t2 = t2.slice(0, r2)), n2 && (t2 = xt$1(t2, true)), t2;
}
function K$g(t2) {
  return ft$2(t2) || at$3(t2);
}
function V$m(t2) {
  return t2 != null && t2.slice(0, 5) === "blob:";
}
function X$e(t2) {
  return t2 != null && t2.slice(0, 5) === "data:";
}
function Y$e(t2) {
  const n2 = nt$4(t2);
  if (!n2 || !n2.isBase64)
    return null;
  const e2 = atob(n2.data), r2 = new Uint8Array(e2.length);
  for (let o2 = 0; o2 < e2.length; o2++)
    r2[o2] = e2.charCodeAt(o2);
  return r2.buffer;
}
function Z$f(t2) {
  return btoa(String.fromCharCode.apply(null, t2)).replace(/\+/g, "-").replace(/\//g, "_").replace(/=+$/, "");
}
const tt$4 = /^data:(.*?)(;base64)?,(.*)$/;
function nt$4(t2) {
  const n2 = t2.match(tt$4);
  if (!n2)
    return null;
  const [, e2, r2, o2] = n2;
  return { mediaType: e2, isBase64: !!r2, data: o2 };
}
function et$2(t2) {
  return t2.isBase64 ? `data:${t2.mediaType};base64,${t2.data}` : `data:${t2.mediaType},${t2.data}`;
}
function it$2(t2, n2) {
  ut$2(t2, n2) || ct$2(t2, n2);
}
function ut$2(t2, n2) {
  if (!t2)
    return false;
  const e2 = document.createElement("a");
  if (!("download" in e2))
    return false;
  const r2 = URL.createObjectURL(t2);
  return e2.download = n2, e2.href = r2, e2.style.display = "none", document.body.appendChild(e2), e2.click(), document.body.removeChild(e2), URL.revokeObjectURL(r2), true;
}
function ct$2(t2, n2) {
  return !!window.navigator.msSaveOrOpenBlob && window.navigator.msSaveOrOpenBlob(t2, n2);
}
function ft$2(t2) {
  return t2 != null && t2[0] === "/" && t2[1] === "/";
}
function at$3(t2) {
  return t2 != null && c$2y.test(t2);
}
function ht$2(t2) {
  return t2 != null && a$2m.test(t2) || w$S.scheme === "https" && ft$2(t2);
}
function pt$2(t2) {
  return t2 != null && f$1x.test(t2) || w$S.scheme === "http" && ft$2(t2);
}
function dt$2(t2) {
  return t2 != null && h$1u.test(t2);
}
function mt$2(t2) {
  return ft$2(t2) ? `https:${t2}` : t2.replace(f$1x, "https:");
}
function yt$1() {
  return w$S.scheme === "http";
}
function $t() {
  return w$S.scheme === "https";
}
function xt$1(t2, n2 = false) {
  return ft$2(t2) ? t2.slice(2) : (t2 = t2.replace(c$2y, ""), n2 && t2.length > 1 && t2[0] === "/" && t2[1] === "/" && (t2 = t2.slice(2)), t2);
}
function wt$2(t2) {
  const n2 = t2.indexOf("//"), e2 = t2.indexOf("/", n2 + 2);
  return e2 === -1 ? t2 : t2.slice(0, e2);
}
function Ot(t2) {
  let n2 = 0;
  if (K$g(t2)) {
    const e3 = t2.indexOf("//");
    e3 !== -1 && (n2 = e3 + 2);
  }
  const e2 = t2.lastIndexOf("/");
  return e2 < n2 ? t2 : t2.slice(0, e2 + 1);
}
function Ut(t2, n2) {
  if (!t2)
    return "";
  const e2 = j$Q(t2).path.replace(/\/+$/, ""), r2 = e2.substring(e2.lastIndexOf("/") + 1);
  if (!(n2 == null ? void 0 : n2.length))
    return r2;
  const o2 = new RegExp(`.(${n2.join("|")})$`, "ig");
  return r2.replace(o2, "");
}
function bt$1(t2) {
  return t2 && t2[t2.length - 1] === "/" ? t2 : `${t2}/`;
}
function Ct(t2) {
  return t2.replace(/\/+$/, "");
}
function qt(t2) {
  if (/^https?:\/\//i.test(t2)) {
    const n2 = P$x(t2);
    t2 = (t2 = n2.path.replace(/\/{2,}/g, "/")).replace("/", "//"), n2.query && (t2 += `?${n2.query}`);
  }
  return t2;
}
function Rt$1(t2) {
  return t2.replace(/^(https?:\/\/)(arcgis\.com)/i, "$1www.$2");
}
function jt$1(t2) {
  const n2 = u$1K.httpsDomains;
  if (!pt$2(t2))
    return t2;
  const e2 = t2.indexOf("/", 7);
  let r2;
  if (r2 = e2 === -1 ? t2 : t2.slice(0, e2), r2 = r2.toLowerCase().slice(7), p$2Q.test(r2)) {
    if (!r2.endsWith(":80"))
      return t2;
    r2 = r2.slice(0, -3), t2 = t2.replace(":80", "");
  }
  return yt$1() && r2 === w$S.authority && !d$1B.test(t2) || ($t() && r2 === w$S.authority || n2 && n2.some((t3) => r2 === t3 || r2.endsWith(`.${t3}`)) || $t() && !J$o(t2)) && (t2 = mt$2(t2)), t2;
}
function Lt(t2, n2, e2) {
  if (!(n2 && e2 && t2 && K$g(t2)))
    return t2;
  const r2 = t2.indexOf("//"), o2 = t2.indexOf("/", r2 + 2), i2 = t2.indexOf(":", r2 + 2), s2 = Math.min(o2 < 0 ? t2.length : o2, i2 < 0 ? t2.length : i2);
  if (t2.slice(r2 + 2, s2).toLowerCase() !== n2.toLowerCase())
    return t2;
  return `${t2.slice(0, r2 + 2)}${e2}${t2.slice(s2)}`;
}
function vt(t2) {
  return typeof t2 == "string" ? new y$1k(Q$h(t2)) : (t2.scheme || (t2.scheme = w$S.scheme), t2);
}
function It$1(t2) {
  return Nt.test(t2);
}
function At$1(t2, n2) {
  const e2 = j$Q(t2), r2 = Object.keys(e2.query || {});
  return r2.length > 0 && n2 && n2.warn("removeQueryParameters()", `Url query parameters are not supported, the following parameters have been removed: ${r2.join(", ")}.`), e2.path;
}
function St$1(t2, n2, e2) {
  const r2 = j$Q(t2), o2 = r2.query || {};
  return o2[n2] = String(e2), `${r2.path}?${I$D(o2)}`;
}
function Bt(t2, n2) {
  const e2 = j$Q(t2), r2 = e2.query || {};
  for (const i2 in n2)
    r2[i2] = n2[i2];
  const o2 = I$D(r2);
  return o2 ? `${e2.path}?${o2}` : e2.path;
}
function kt$1(t2) {
  if (t$2r(t2))
    return null;
  const n2 = t2.match(Jt);
  return n2 ? n2[2] : null;
}
function Et(t2) {
  if (t$2r(t2))
    return null;
  const n2 = t2.match(Jt);
  return n2 ? { path: n2[1], extension: n2[2] } : { path: t2, extension: null };
}
const Jt = /([^.]*)\.([^\/]*)$/, Nt = /(^data:image\/svg|\.svg$)/i;
function c$2x(e2, o2) {
  const l2 = o2 && o2.url && o2.url.path;
  if (e2 && l2 && (e2 = Q$h(e2, l2, { preserveProtocolRelative: true }), o2.portalItem && o2.readResourcePaths)) {
    const r2 = _$I(e2, o2.portalItem.itemUrl);
    r2 != null && v$_.test(r2) && o2.readResourcePaths.push(o2.portalItem.resourceFromPath(r2).path);
  }
  return I$C(e2, o2 && o2.portal);
}
function m$1_(e2, n2, a2 = R$w.YES) {
  if (e2 == null)
    return e2;
  !K$g(e2) && n2 && n2.blockedRelativeUrls && n2.blockedRelativeUrls.push(e2);
  let u2 = Q$h(e2);
  if (n2) {
    const r2 = n2.verifyItemRelativeUrls && n2.verifyItemRelativeUrls.rootPath || n2.url && n2.url.path;
    if (r2) {
      const o2 = I$C(r2, n2.portal);
      u2 = _$I(I$C(u2, n2.portal), o2, o2), u2 != null && u2 !== e2 && n2.verifyItemRelativeUrls && n2.verifyItemRelativeUrls.writtenUrls.push(u2);
    }
  }
  return u2 = y$1j(u2, n2 == null ? void 0 : n2.portal), K$g(u2) && (u2 = F$v(u2)), (n2 == null ? void 0 : n2.resources) && (n2 == null ? void 0 : n2.portalItem) && !K$g(u2) && !X$e(u2) && a2 === R$w.YES && n2.resources.toKeep.push({ resource: n2.portalItem.resourceFromPath(u2), compress: false }), u2;
}
function p$2P(e2, r2, t2) {
  return c$2x(e2, t2);
}
function f$1w(e2, r2, t2, o2) {
  const l2 = m$1_(e2, o2);
  l2 !== void 0 && (r2[t2] = l2);
}
const h$1t = /\/items\/([^\/]+)\/resources\/(.*)/, v$_ = /^\.\/resources\//;
function U$u(e2) {
  var _a2, _b2, _c2;
  return (_c2 = (_b2 = (_a2 = e2 == null ? void 0 : e2.match(h$1t)) != null ? _a2 : null) == null ? void 0 : _b2[1]) != null ? _c2 : null;
}
function d$1A(r2) {
  var _a2;
  const t2 = (_a2 = r2 == null ? void 0 : r2.match(h$1t)) != null ? _a2 : null;
  if (t2 == null)
    return null;
  const o2 = t2[2], l2 = o2.lastIndexOf("/");
  if (l2 === -1) {
    const { path: r3, extension: t3 } = Et(o2);
    return { prefix: null, filename: r3, extension: e$2e(t3) };
  }
  const { path: s2, extension: a2 } = Et(o2.slice(l2 + 1));
  return { prefix: o2.slice(0, l2), filename: s2, extension: e$2e(a2) };
}
function y$1j(e2, r2) {
  return r2 && !r2.isPortal && r2.urlKey && r2.customBaseUrl ? Lt(e2, `${r2.urlKey}.${r2.customBaseUrl}`, r2.portalHostname) : e2;
}
function I$C(e2, r2) {
  if (!r2 || r2.isPortal || !r2.urlKey || !r2.customBaseUrl)
    return e2;
  const t2 = `${r2.urlKey}.${r2.customBaseUrl}`, o2 = b$_();
  return z$D(o2, `${o2.scheme}://${t2}`) ? Lt(e2, r2.portalHostname, t2) : Lt(e2, t2, r2.portalHostname);
}
var R$w;
!function(e2) {
  e2[e2.YES = 0] = "YES", e2[e2.NO = 1] = "NO";
}(R$w || (R$w = {}));
const x$O = Object.freeze(Object.defineProperty({ __proto__: null, fromJSON: c$2x, toJSON: m$1_, read: p$2P, write: f$1w, itemIdFromResourceUrl: U$u, prefixAndFilenameFromResourceUrl: d$1A, ensureMainOnlineDomain: y$1j, get MarkKeep() {
  return R$w;
} }, Symbol.toStringTag, { value: "Module" }));
var l$20;
const d$1z = o$1_()({ circle: "circle", square: "square", cross: "cross", x: "x", kite: "kite", triangle: "triangle" });
let h$1s = l$20 = class extends l$2B {
  constructor(r2) {
    super(r2);
  }
  readHref(r2, e2, o2) {
    return r2 ? c$2x(r2, o2) : e2.dataURI;
  }
  writeHref(r2, e2, o2, c2) {
    r2 && (X$e(r2) ? e2.dataURI = r2 : (e2.href = m$1_(r2, c2), K$g(e2.href) && (e2.href = F$v(e2.href))));
  }
  clone() {
    return new l$20({ href: this.href, primitive: this.primitive });
  }
};
e$2g([y$1I({ type: String, json: { write: true, read: { source: ["href", "dataURI"] } } })], h$1s.prototype, "href", void 0), e$2g([o$29("href")], h$1s.prototype, "readHref", null), e$2g([r$1P("href", { href: { type: String }, dataURI: { type: String } })], h$1s.prototype, "writeHref", null), e$2g([r$1H(d$1z)], h$1s.prototype, "primitive", void 0), h$1s = l$20 = e$2g([n$2P("esri.symbols.support.IconSymbol3DLayerResource")], h$1s);
const j$P = "circle";
var e$1z;
let p$2O = e$1z = class extends m$2q {
  constructor() {
    super(...arguments), this.x = 0, this.y = 0;
  }
  clone() {
    return new e$1z({ x: this.x, y: this.y });
  }
};
e$2g([y$1I({ type: Number })], p$2O.prototype, "x", void 0), e$2g([y$1I({ type: Number })], p$2O.prototype, "y", void 0), p$2O = e$1z = e$2g([n$2P("esri.symbols.support.Symbol3DAnchorPosition2D")], p$2O);
var l$1$;
let a$2l = l$1$ = class extends l$2B {
  constructor(o2) {
    super(o2), this.color = new l$2e([0, 0, 0, 1]), this.size = e$1D(1);
  }
  clone() {
    const o2 = { color: r$1$(this.color) ? this.color.clone() : null, size: this.size };
    return new l$1$(o2);
  }
};
e$2g([y$1I(p$31)], a$2l.prototype, "color", void 0), e$2g([y$1I(a$2s)], a$2l.prototype, "size", void 0), a$2l = l$1$ = e$2g([n$2P("esri.symbols.support.Symbol3DIconOutline")], a$2l);
var f$1v;
const d$1y = "esri.symbols.IconSymbol3DLayer";
let b$Z = f$1v = class extends a$2t {
  constructor(o2) {
    super(o2), this.material = null, this.resource = null, this.type = "icon", this.size = 12, this.anchor = "center", this.anchorPosition = null, this.outline = null;
  }
  clone() {
    return new f$1v({ anchor: this.anchor, anchorPosition: this.anchorPosition && this.anchorPosition.clone(), enabled: this.enabled, material: r$1$(this.material) ? this.material.clone() : null, outline: r$1$(this.outline) ? this.outline.clone() : null, resource: this.resource && this.resource.clone(), size: this.size });
  }
  static fromSimpleMarkerSymbol(o2) {
    const t2 = o2.color || o$1K, r2 = j$O(o2), e2 = o2.outline && o2.outline.width > 0 ? { size: o2.outline.width, color: (o2.outline.color || o$1K).clone() } : null;
    return new f$1v({ size: o2.size, resource: { primitive: w$R(o2.style) }, material: { color: t2 }, outline: e2, anchor: r2 ? "relative" : void 0, anchorPosition: r2 });
  }
  static fromPictureMarkerSymbol(o2) {
    const t2 = !o2.color || t$1M(o2.color) ? o$1K : o2.color, r2 = j$O(o2);
    return new f$1v({ size: o2.width <= o2.height ? o2.height : o2.width, resource: { href: o2.url }, material: { color: t2.clone() }, anchor: r2 ? "relative" : void 0, anchorPosition: r2 });
  }
  static fromCIMSymbol(o2) {
    return new f$1v({ resource: { href: et$2({ mediaType: "application/json", data: JSON.stringify(o2.data) }) } });
  }
};
function j$O(o2) {
  const t2 = "width" in o2 ? o2.width : o2.size, r2 = "height" in o2 ? o2.height : o2.size, e2 = g$14(o2.xoffset), i2 = g$14(o2.yoffset);
  return (e2 || i2) && t2 && r2 ? { x: -e2 / t2, y: i2 / r2 } : null;
}
function g$14(o2) {
  return isFinite(o2) ? o2 : 0;
}
e$2g([y$1I({ type: l$2a, json: { write: true } })], b$Z.prototype, "material", void 0), e$2g([y$1I({ type: h$1s, json: { write: true } })], b$Z.prototype, "resource", void 0), e$2g([r$1H({ Icon: "icon" }, { readOnly: true })], b$Z.prototype, "type", void 0), e$2g([y$1I(a$2s)], b$Z.prototype, "size", void 0), e$2g([r$1H({ center: "center", left: "left", right: "right", top: "top", bottom: "bottom", topLeft: "top-left", topRight: "top-right", bottomLeft: "bottom-left", bottomRight: "bottom-right", relative: "relative" }), y$1I({ json: { default: "center" } })], b$Z.prototype, "anchor", void 0), e$2g([y$1I({ type: p$2O, json: { type: [Number], read: { reader: (o2) => new p$2O({ x: o2[0], y: o2[1] }) }, write: { writer: (o2, t2) => {
  t2.anchorPosition = [o2.x, o2.y];
}, overridePolicy() {
  return { enabled: this.anchor === "relative" };
} } } })], b$Z.prototype, "anchorPosition", void 0), e$2g([y$1I({ type: a$2l, json: { write: true } })], b$Z.prototype, "outline", void 0), b$Z = f$1v = e$2g([n$2P(d$1y)], b$Z);
const v$Z = { circle: "circle", cross: "cross", diamond: "kite", square: "square", x: "x", triangle: "triangle", path: null };
function w$R(o2) {
  const r2 = v$Z[o2];
  return r2 || (s$2z.getLogger(d$1y).warn(`${o2} cannot be mapped to Icon symbol. Fallback to "circle"`), "circle");
}
const S$K = b$Z;
function n$2l(n2, t2, i2 = j$V) {
  return t2 || (t2 = new i2()), t2 === n2 || (t2.removeAll(), e$1y(n2) ? t2.addMany(n2) : n2 && t2.add(n2)), t2;
}
function t$1J(r2) {
  return r2;
}
function e$1y(r2) {
  return r2 && (Array.isArray(r2) || "items" in r2 && Array.isArray(r2.items));
}
const e$1x = "20221121", f$1u = "f520630575ed53cf8b49e5f1492799065ee366e5";
const a$2k = "4.25", r$1u = { async request(t2, a2) {
  var _a2, _b2;
  const { default: r2 } = await Promise.resolve().then(function() {
    return request;
  }), s2 = t2.options, n2 = s2.responseType;
  s2.signal = a2 == null ? void 0 : a2.signal, s2.responseType = n2 === "native" || n2 === "native-request-init" ? "native-request-init" : n2 && ["blob", "json", "text"].includes(n2) && ((_a2 = W$g(t2.url)) == null ? void 0 : _a2.after) ? n2 : "array-buffer";
  const o2 = await r2(t2.url, s2), i2 = { data: o2.data, ssl: o2.ssl };
  switch ((_b2 = o2.requestOptions) == null ? void 0 : _b2.responseType) {
    case "native-request-init":
      return delete i2.data.signal, i2;
    case "blob":
      i2.data = await i2.data.arrayBuffer();
      break;
    case "json":
      i2.data = new TextEncoder().encode(JSON.stringify(i2.data)).buffer;
      break;
    case "text":
      i2.data = new TextEncoder().encode(i2.data).buffer;
  }
  return { result: i2, transferList: [i2.data] };
} };
let s$1Q;
function n$2k(e2) {
  s$1Q = e2;
}
function o$1H(e2) {
  const a2 = s$1Q && s$1Q.findCredential(e2);
  return a2 && a2.token ? St$1(e2, "token", a2.token) : e2;
}
has("host-webworker");
const e$1w = /^https:\/\/([a-z\d-]+)(\.maps([^.]*))?\.arcgis\.com/i, s$1P = { devext: { customBaseUrl: "mapsdevext.arcgis.com", portalHostname: "devext.arcgis.com" }, qaext: { customBaseUrl: "mapsqa.arcgis.com", portalHostname: "qaext.arcgis.com" }, www: { customBaseUrl: "maps.arcgis.com", portalHostname: "www.arcgis.com" } };
function a$2j(a2) {
  const t2 = a2 == null ? void 0 : a2.match(e$1w);
  if (!t2)
    return null;
  const [, r2, o2, l2] = t2;
  if (!r2)
    return null;
  let c2 = null, m2 = null, n2 = null;
  const { devext: u2, qaext: i2, www: p2 } = s$1P;
  if (o2)
    if (c2 = r2, l2)
      switch (l2.toLowerCase()) {
        case "devext":
          ({ customBaseUrl: m2, portalHostname: n2 } = u2);
          break;
        case "qa":
          ({ customBaseUrl: m2, portalHostname: n2 } = i2);
          break;
        default:
          return null;
      }
    else
      ({ customBaseUrl: m2, portalHostname: n2 } = p2);
  else
    switch (r2.toLowerCase()) {
      case "devext":
        ({ customBaseUrl: m2, portalHostname: n2 } = u2);
        break;
      case "qaext":
        ({ customBaseUrl: m2, portalHostname: n2 } = i2);
        break;
      case "www":
        ({ customBaseUrl: m2, portalHostname: n2 } = p2);
        break;
      default:
        return null;
    }
  return { customBaseUrl: m2, isPortal: false, portalHostname: n2, urlKey: c2 };
}
function t$1I(e2) {
  return /\/(sharing|usrsvcs)\/(appservices|servers)\//i.test(e2);
}
const t$1H = ["elevation3d.arcgis.com", "js.arcgis.com", "jsdev.arcgis.com", "jsqa.arcgis.com", "static.arcgis.com"];
function r$1t(c2) {
  const r2 = H$j(c2, true);
  return !!r2 && (r2.endsWith(".arcgis.com") && !t$1H.includes(r2) && !c2.endsWith("/sharing/rest/generateToken"));
}
function c$2w(r2, t2, n2 = false, s2) {
  return new Promise((i2, c2) => {
    if (p$3D(s2))
      return void c2(a$2i());
    let m2 = () => {
      f2(), c2(new Error(`Unable to load ${t2}`));
    }, u2 = () => {
      const e2 = r2;
      f2(), i2(e2);
    }, d2 = () => {
      if (!r2)
        return;
      const e2 = r2;
      f2(), e2.src = "", c2(a$2i());
    };
    const f2 = () => {
      has("esri-image-decode") || (r2.removeEventListener("error", m2), r2.removeEventListener("load", u2)), m2 = null, u2 = null, r2 = null, r$1$(s2) && s2.removeEventListener("abort", d2), d2 = null, n2 && URL.revokeObjectURL(t2);
    };
    r$1$(s2) && s2.addEventListener("abort", d2), has("esri-image-decode") ? r2.decode().then(u2, m2) : (r2.addEventListener("error", m2), r2.addEventListener("load", u2));
  });
}
function a$2i() {
  try {
    return new DOMException("Aborted", "AbortError");
  } catch {
    const r2 = new Error();
    return r2.name = "AbortError", r2;
  }
}
function m$1Z(e2) {
  var _a2, _b2, _c2;
  s$2A.request.crossOriginNoCorsDomains || (s$2A.request.crossOriginNoCorsDomains = {});
  const o2 = s$2A.request.crossOriginNoCorsDomains;
  for (let r2 of e2)
    r2 = r2.toLowerCase(), /^https?:\/\//.test(r2) ? o2[(_a2 = H$j(r2)) != null ? _a2 : ""] = 0 : (o2[(_b2 = H$j("http://" + r2)) != null ? _b2 : ""] = 0, o2[(_c2 = H$j("https://" + r2)) != null ? _c2 : ""] = 0);
}
function u$1J(e2) {
  const o2 = s$2A.request.crossOriginNoCorsDomains;
  if (o2) {
    let r2 = H$j(e2);
    if (r2)
      return r2 = r2.toLowerCase(), !z$D(r2, b$_()) && o2[r2] < Date.now() - 36e5;
  }
  return false;
}
async function d$1x(e2) {
  var _a2;
  const o2 = s$2A.request.crossOriginNoCorsDomains, n2 = H$j(e2);
  o2 && n2 && (o2[n2.toLowerCase()] = Date.now());
  const s2 = j$Q(e2);
  e2 = s2.path, ((_a2 = s2.query) == null ? void 0 : _a2.f) === "json" && (e2 += "?f=json");
  try {
    await fetch(e2, { mode: "no-cors", credentials: "include" });
  } catch {
  }
}
async function U$t(e2, r2) {
  var _a2;
  const t2 = X$e(e2), s2 = V$m(e2);
  s2 || t2 || (e2 = F$v(e2));
  const n2 = { url: e2, requestOptions: __spreadValues({}, e$2e(r2)) };
  let i2 = W$g(e2);
  if (i2) {
    const e3 = await G$p(i2, n2);
    if (e3 != null)
      return { data: e3, getHeader: M$A, requestOptions: n2.requestOptions, url: n2.url };
    i2.after || i2.error || (i2 = null);
  }
  if (e2 = n2.url, (r2 = n2.requestOptions).responseType === "image") {
    if (has("host-webworker") || has("host-node"))
      throw N$p("request:invalid-parameters", new Error("responseType 'image' is not supported in Web Workers or Node environment"), n2);
  } else if (t2)
    throw N$p("request:invalid-parameters", new Error("Data URLs are not supported for responseType = " + r2.responseType), n2);
  if (r2.method === "head") {
    if (r2.body)
      throw N$p("request:invalid-parameters", new Error("body parameter cannot be set when method is 'head'"), n2);
    if (t2 || s2)
      throw N$p("request:invalid-parameters", new Error("data and blob URLs are not supported for method 'head'"), n2);
  }
  if (await B$q(), j$N)
    return j$N.execute(e2, r2);
  const l2 = new AbortController();
  v$19(r2, () => l2.abort());
  const m2 = { controller: l2, credential: void 0, credentialToken: void 0, fetchOptions: void 0, hasToken: false, interceptor: i2, params: n2, redoRequest: false, useIdentity: P$w.useIdentity, useProxy: false, useSSL: false, withCredentials: false }, h2 = await Q$g(m2);
  return (_a2 = i2 == null ? void 0 : i2.after) == null ? void 0 : _a2.call(i2, h2), h2;
}
let j$N;
const P$w = s$2A.request, D$r = "FormData" in globalThis, _$H = [499, 498, 403, 401], F$u = ["COM_0056", "COM_0057", "SB_0008"], I$B = [/\/arcgis\/tokens/i, /\/sharing(\/rest)?\/generatetoken/i, /\/rest\/info/i], M$A = () => null, R$v = Symbol();
function A$s(e2) {
  const r2 = H$j(e2);
  r2 && !U$t._corsServers.includes(r2) && U$t._corsServers.push(r2);
}
function H$i(e2) {
  const r2 = H$j(e2);
  return !r2 || r2.endsWith(".arcgis.com") || U$t._corsServers.includes(r2) || D$s(r2);
}
function N$p(e2, r2, o2, a2) {
  let l2 = "Error";
  const u2 = { url: o2.url, requestOptions: o2.requestOptions, getHeader: M$A, ssl: false };
  if (r2 instanceof s$2u)
    return r2.details ? (r2.details = y$1L(r2.details), r2.details.url = o2.url, r2.details.requestOptions = o2.requestOptions) : r2.details = u2, r2;
  if (r2) {
    const e3 = a2 && ((e4) => a2.headers.get(e4)), t2 = a2 && a2.status, s2 = r2.message;
    s2 && (l2 = s2), e3 && (u2.getHeader = e3), u2.httpStatus = (r2.httpCode != null ? r2.httpCode : r2.code) || t2 || 0, u2.subCode = r2.subcode, u2.messageCode = r2.messageCode, typeof r2.details == "string" ? u2.messages = [r2.details] : u2.messages = r2.details, u2.raw = R$v in r2 ? r2[R$v] : r2;
  }
  return j$_(r2) ? a$2T() : new s$2u(e2, l2, u2);
}
async function B$q() {
  has("host-webworker") ? j$N || (j$N = await import("./request.js")) : U$t._abortableFetch || (U$t._abortableFetch = globalThis.fetch.bind(globalThis));
}
async function $$h() {
  s$1Q || await import("./IdentityManager.js");
}
async function z$C(t2) {
  var _a2;
  const s2 = t2.params.url, o2 = t2.params.requestOptions, a2 = t2.controller.signal, n2 = o2.body;
  let i2 = null, u2 = null;
  if (D$r && "HTMLFormElement" in globalThis && (n2 instanceof FormData ? i2 = n2 : n2 instanceof HTMLFormElement && (i2 = new FormData(n2))), typeof n2 == "string" && (u2 = n2), t2.fetchOptions = { cache: o2.cacheBust && !U$t._abortableFetch.polyfill ? "no-cache" : "default", credentials: "same-origin", headers: o2.headers || {}, method: o2.method === "head" ? "HEAD" : "GET", mode: "cors", priority: P$w.priority, redirect: "follow", signal: a2 }, (i2 || u2) && (t2.fetchOptions.body = i2 || u2), o2.authMode === "anonymous" && (t2.useIdentity = false), t2.hasToken = !!(/token=/i.test(s2) || ((_a2 = o2.query) == null ? void 0 : _a2.token) || (i2 == null ? void 0 : i2.get("token"))), !t2.hasToken && s$2A.apiKey && r$1t(s2) && (o2.query || (o2.query = {}), o2.query.token = s$2A.apiKey, t2.hasToken = true), t2.useIdentity && !t2.hasToken && !t2.credentialToken && !K$f(s2) && !p$3D(a2)) {
    let e2;
    o2.authMode === "immediate" ? (await $$h(), e2 = await s$1Q.getCredential(s2, { signal: a2 }), t2.credential = e2) : o2.authMode === "no-prompt" ? (await $$h(), e2 = await s$1Q.getCredential(s2, { prompt: false, signal: a2 }).catch(() => {
    }), t2.credential = e2) : s$1Q && (e2 = s$1Q.findCredential(s2)), e2 && (t2.credentialToken = e2.token, t2.useSSL = !!e2.ssl);
  }
}
function K$f(e2) {
  return I$B.some((r2) => r2.test(e2));
}
async function W$f(e2) {
  var _a2, _b2;
  let t2 = e2.params.url;
  const s2 = e2.params.requestOptions, o2 = (_a2 = e2.fetchOptions) != null ? _a2 : {}, a2 = V$m(t2) || X$e(t2), n2 = s2.responseType || "json", l2 = a2 ? 0 : s2.timeout != null ? s2.timeout : P$w.timeout;
  let d2 = false;
  if (!a2) {
    e2.useSSL && (t2 = mt$2(t2)), s2.cacheBust && o2.cache === "default" && (t2 = St$1(t2, "request.preventCache", Date.now()));
    let a3 = __spreadValues({}, s2.query);
    e2.credentialToken && (a3.token = e2.credentialToken);
    let n3 = I$D(a3);
    has("esri-url-encodes-apostrophe") && (n3 = n3.replace(/'/g, "%27"));
    const i2 = t2.length + 1 + n3.length;
    let l3;
    d2 = s2.method === "delete" || s2.method === "post" || s2.method === "put" || !!s2.body || i2 > P$w.maxUrlLength;
    const u2 = s2.useProxy || !!J$o(t2);
    if (u2) {
      const e3 = A$t(t2);
      l3 = e3.path, !d2 && l3.length + 1 + i2 > P$w.maxUrlLength && (d2 = true), e3.query && (a3 = __spreadValues(__spreadValues({}, e3.query), a3));
    }
    if (o2.method === "HEAD" && (d2 || u2)) {
      if (d2) {
        if (i2 > P$w.maxUrlLength)
          throw N$p("request:invalid-parameters", new Error("URL exceeds maximum length"), e2.params);
        throw N$p("request:invalid-parameters", new Error("cannot use POST request when method is 'head'"), e2.params);
      }
      if (u2)
        throw N$p("request:invalid-parameters", new Error("cannot use proxy when method is 'head'"), e2.params);
    }
    if (d2 ? (o2.method = s2.method === "delete" ? "DELETE" : s2.method === "put" ? "PUT" : "POST", s2.body ? t2 = Bt(t2, a3) : (o2.body = I$D(a3), o2.headers || (o2.headers = {}), o2.headers["Content-Type"] = "application/x-www-form-urlencoded")) : t2 = Bt(t2, a3), u2 && (e2.useProxy = true, t2 = `${l3}?${t2}`), a3.token && D$r && o2.body instanceof FormData && !t$1I(t2) && o2.body.set("token", a3.token), s2.hasOwnProperty("withCredentials"))
      e2.withCredentials = s2.withCredentials;
    else if (!z$D(t2, b$_())) {
      if (D$s(t2))
        e2.withCredentials = true;
      else if (s$1Q) {
        const s3 = s$1Q.findServerInfo(t2);
        s3 && s3.webTierAuth && (e2.withCredentials = true);
      }
    }
    e2.withCredentials && (o2.credentials = "include", u$1J(t2) && await d$1x(d2 ? Bt(t2, a3) : t2));
  }
  let p2, v2, C2 = 0, L2 = false;
  l2 > 0 && (C2 = setTimeout(() => {
    L2 = true, e2.controller.abort();
  }, l2));
  try {
    if (s2.responseType === "native-request-init")
      v2 = o2, v2.url = t2;
    else if (s2.responseType !== "image" || o2.cache !== "default" || o2.method !== "GET" || d2 || J$n(s2.headers) || !a2 && !e2.useProxy && P$w.proxyUrl && !H$i(t2)) {
      if (p2 = await U$t._abortableFetch(t2, o2), e2.useProxy || A$s(t2), s2.responseType === "native")
        v2 = p2;
      else if (o2.method !== "HEAD")
        if (p2.ok) {
          switch (n2) {
            case "array-buffer":
              v2 = await p2.arrayBuffer();
              break;
            case "blob":
            case "image":
              v2 = await p2.blob();
              break;
            default:
              v2 = await p2.text();
          }
          if (C2 && (clearTimeout(C2), C2 = 0), n2 === "json" || n2 === "xml" || n2 === "document")
            if (v2)
              switch (n2) {
                case "json":
                  v2 = JSON.parse(v2);
                  break;
                case "xml":
                  v2 = X$d(v2, "application/xml");
                  break;
                case "document":
                  v2 = X$d(v2, "text/html");
              }
            else
              v2 = null;
          if (v2) {
            if (n2 === "array-buffer" || n2 === "blob") {
              const e3 = p2.headers.get("Content-Type");
              if (e3 && /application\/json|text\/plain/i.test(e3) && v2[n2 === "blob" ? "size" : "byteLength"] <= 750)
                try {
                  const e4 = await new Response(v2).json();
                  e4.error && (v2 = e4);
                } catch {
                }
            }
            n2 === "image" && v2 instanceof Blob && (v2 = await Y$d(URL.createObjectURL(v2), e2, true));
          }
        } else
          v2 = await p2.text();
    } else
      v2 = await Y$d(t2, e2);
  } catch (j2) {
    if (j2.name === "AbortError") {
      if (L2)
        throw new Error("Timeout exceeded");
      throw a$2T("Request canceled");
    }
    if (!(!p2 && j2 instanceof TypeError && P$w.proxyUrl) || s2.body || s2.method === "delete" || s2.method === "head" || s2.method === "post" || s2.method === "put" || e2.useProxy || H$i(t2))
      throw j2;
    e2.redoRequest = true, E$G({ proxyUrl: P$w.proxyUrl, urlPrefix: (_b2 = H$j(t2)) != null ? _b2 : "" });
  } finally {
    C2 && clearTimeout(C2);
  }
  return [p2, v2];
}
async function G$p(e2, r2) {
  if (e2.responseData != null)
    return e2.responseData;
  if (e2.headers && (r2.requestOptions.headers = __spreadValues(__spreadValues({}, r2.requestOptions.headers), e2.headers)), e2.query && (r2.requestOptions.query = __spreadValues(__spreadValues({}, r2.requestOptions.query), e2.query)), e2.before) {
    let o2, a2;
    try {
      a2 = await e2.before(r2);
    } catch (s2) {
      o2 = N$p("request:interceptor", s2, r2);
    }
    if ((a2 instanceof Error || a2 instanceof s$2u) && (o2 = N$p("request:interceptor", a2, r2)), o2)
      throw e2.error && e2.error(o2), o2;
    return a2;
  }
}
function J$n(e2) {
  if (e2) {
    for (const r2 of Object.getOwnPropertyNames(e2))
      if (e2[r2])
        return true;
  }
  return false;
}
function X$d(e2, r2) {
  let t2;
  try {
    t2 = new DOMParser().parseFromString(e2, r2);
  } catch {
  }
  if (!t2 || t2.getElementsByTagName("parsererror").length)
    throw new SyntaxError("XML Parse error");
  return t2;
}
async function Q$g(e2) {
  var _a2;
  let t2, s2;
  await z$C(e2);
  try {
    do {
      [t2, s2] = await W$f(e2);
    } while (!await V$l(e2, t2, s2));
  } catch (n2) {
    const r2 = N$p("request:server", n2, e2.params, t2);
    throw r2.details.ssl = e2.useSSL, e2.interceptor && e2.interceptor.error && e2.interceptor.error(r2), r2;
  }
  const o2 = e2.params.url;
  if (s2 && /\/sharing\/rest\/(accounts|portals)\/self/i.test(o2)) {
    if (!e2.hasToken && !e2.credentialToken && ((_a2 = s2.user) == null ? void 0 : _a2.username) && !D$s(o2)) {
      const e3 = H$j(o2, true);
      e3 && P$w.trustedServers.push(e3);
    }
    Array.isArray(s2.authorizedCrossOriginNoCorsDomains) && m$1Z(s2.authorizedCrossOriginNoCorsDomains);
  }
  const a2 = e2.credential;
  if (a2 && s$1Q) {
    const e3 = s$1Q.findServerInfo(a2.server);
    let t3 = e3 && e3.owningSystemUrl;
    if (t3) {
      t3 = t3.replace(/\/?$/, "/sharing");
      const e4 = s$1Q.findCredential(t3, a2.userId);
      e4 && s$1Q._getIdenticalSvcIdx(t3, e4) === -1 && e4.resources.unshift(t3);
    }
  }
  return { data: s2, getHeader: t2 ? (e3) => t2 == null ? void 0 : t2.headers.get(e3) : M$A, requestOptions: e2.params.requestOptions, ssl: e2.useSSL, url: e2.params.url };
}
async function V$l(e2, t2, s2) {
  if (e2.redoRequest)
    return e2.redoRequest = false, false;
  const o2 = e2.params.requestOptions;
  if (!t2 || o2.responseType === "native" || o2.responseType === "native-request-init")
    return true;
  let a2, n2;
  if (!t2.ok)
    throw a2 = new Error(`Unable to load ${t2.url} status: ${t2.status}`), a2[R$v] = s2, a2;
  s2 && (s2.error ? a2 = s2.error : s2.status === "error" && Array.isArray(s2.messages) && (a2 = __spreadValues({}, s2), a2[R$v] = s2, a2.details = s2.messages));
  let i2, l2 = null;
  a2 && (n2 = Number(a2.code), l2 = a2.hasOwnProperty("subcode") ? Number(a2.subcode) : null, i2 = a2.messageCode, i2 = i2 && i2.toUpperCase());
  const u2 = o2.authMode;
  if (n2 === 403 && (l2 === 4 || a2.message && a2.message.toLowerCase().includes("ssl") && !a2.message.toLowerCase().includes("permission"))) {
    if (!e2.useSSL)
      return e2.useSSL = true, false;
  } else if (!e2.hasToken && e2.useIdentity && (u2 !== "no-prompt" || n2 === 498) && n2 !== void 0 && _$H.includes(n2) && !K$f(e2.params.url) && (n2 !== 403 || i2 && !F$u.includes(i2) && (l2 == null || l2 === 2 && e2.credentialToken))) {
    await $$h();
    try {
      const t3 = await s$1Q.getCredential(e2.params.url, { error: N$p("request:server", a2, e2.params), prompt: u2 !== "no-prompt", signal: e2.controller.signal, token: e2.credentialToken });
      return e2.credential = t3, e2.credentialToken = t3.token, e2.useSSL = e2.useSSL || t3.ssl, false;
    } catch (c2) {
      if (u2 === "no-prompt")
        return e2.credential = void 0, e2.credentialToken = void 0, false;
      a2 = c2;
    }
  }
  if (a2)
    throw a2;
  return true;
}
function Y$d(e2, r2, t2 = false) {
  const s2 = r2.controller.signal, o2 = new Image();
  return r2.withCredentials ? o2.crossOrigin = "use-credentials" : o2.crossOrigin = "anonymous", o2.alt = "", o2.fetchPriority = P$w.priority, o2.src = e2, c$2w(o2, e2, t2, s2);
}
U$t._abortableFetch = null, U$t._corsServers = ["https://server.arcgisonline.com", "https://services.arcgisonline.com"];
var request = /* @__PURE__ */ Object.freeze({
  __proto__: null,
  [Symbol.toStringTag]: "Module",
  "default": U$t
});
var h$1r;
!function(s2) {
  s2[s2.PENDING = 0] = "PENDING", s2[s2.RESOLVED = 1] = "RESOLVED", s2[s2.REJECTED = 2] = "REJECTED";
}(h$1r || (h$1r = {}));
class n$2j {
  constructor(s2) {
    this.instance = s2, this._resolver = A$B(), this._status = h$1r.PENDING, this._resolvingPromises = [], this._resolver.promise.then(() => {
      this._status = h$1r.RESOLVED, this._cleanUp();
    }, () => {
      this._status = h$1r.REJECTED, this._cleanUp();
    });
  }
  addResolvingPromise(s2) {
    this._resolvingPromises.push(s2), this._tryResolve();
  }
  isResolved() {
    return this._status === h$1r.RESOLVED;
  }
  isRejected() {
    return this._status === h$1r.REJECTED;
  }
  isFulfilled() {
    return this._status !== h$1r.PENDING;
  }
  abort() {
    this._resolver.reject(a$2T());
  }
  when(s2, e2) {
    return this._resolver.promise.then(s2, e2);
  }
  _cleanUp() {
    this._allPromise = this._resolvingPromises = this._allPromise = null;
  }
  _tryResolve() {
    if (this.isFulfilled())
      return;
    const s2 = A$B(), e2 = [...this._resolvingPromises, x$16(s2.promise)], t2 = this._allPromise = Promise.all(e2);
    t2.then(() => {
      this.isFulfilled() || this._allPromise !== t2 || this._resolver.resolve(this.instance);
    }, (s3) => {
      this.isFulfilled() || this._allPromise !== t2 || j$_(s3) || this._resolver.reject(s3);
    }), s2.resolve();
  }
}
const m$1Y = (e2) => {
  let i2 = class extends e2 {
    constructor(...s2) {
      super(...s2), this._promiseProps = new n$2j(this), this.addResolvingPromise(Promise.resolve());
    }
    isResolved() {
      return this._promiseProps.isResolved();
    }
    isRejected() {
      return this._promiseProps.isRejected();
    }
    isFulfilled() {
      return this._promiseProps.isFulfilled();
    }
    when(s2, e3) {
      return new Promise((s3, e4) => {
        this._promiseProps.when(s3, e4);
      }).then(s2, e3);
    }
    catch(s2) {
      return this.when(null, s2);
    }
    addResolvingPromise(s2) {
      s2 && !this._promiseProps.isFulfilled() && this._promiseProps.addResolvingPromise("_promiseProps" in s2 ? s2.when() : s2);
    }
  };
  return i2 = e$2g([n$2P("esri.core.Promise")], i2), i2;
};
let _$G = class extends m$1Y(m$2q) {
};
_$G = e$2g([n$2P("esri.core.Promise")], _$G);
const i$2q = "not-loaded", d$1w = "loading", c$2v = "failed", h$1q = "loaded", u$1I = (s2) => {
  let u2 = class extends s2 {
    constructor(...o2) {
      super(...o2), this._loadController = null, this.loadError = null, this.loadStatus = "not-loaded", this._set("loadWarnings", []), this.addResolvingPromise(new Promise((o3) => {
        const s3 = this.load.bind(this);
        this.load = (l2) => {
          const a2 = new Promise((o4, s4) => {
            const e2 = d$1X(l2, s4);
            this.destroyed && s4(new s$2u("load:instance-destroyed", `Instance of '${this.declaredClass || this.constructor.name}' is already destroyed`, { instance: this })), this._promiseProps.when(o4, s4).finally(() => {
              e2 && e2.remove();
            });
          });
          if (this.loadStatus === i$2q) {
            this._set("loadStatus", d$1w);
            const o4 = this._loadController = new AbortController();
            s3({ signal: o4.signal }), v$19(o4.signal, () => {
              this._promiseProps.abort();
            });
          }
          return o3(), a2;
        };
      })), this.when(() => {
        this._set("loadStatus", h$1q), this._loadController = null;
      }, (o3) => {
        this._set("loadStatus", c$2v), this._set("loadError", o3), this._loadController = null;
      });
    }
    get loaded() {
      return this.loadStatus === h$1q;
    }
    get loadWarnings() {
      return this._get("loadWarnings");
    }
    load() {
      return null;
    }
    cancelLoad() {
      var _a2;
      return this.isFulfilled() || (this._set("loadError", new s$2u("load:cancelled", "Cancelled")), (_a2 = this._loadController) == null ? void 0 : _a2.abort()), this;
    }
  };
  return e$2g([y$1I({ readOnly: true })], u2.prototype, "loaded", null), e$2g([y$1I({ readOnly: true })], u2.prototype, "loadError", void 0), e$2g([y$1I({ clonable: false })], u2.prototype, "loadStatus", void 0), e$2g([y$1I({ type: [t$2j], readOnly: true })], u2.prototype, "loadWarnings", null), u2 = e$2g([n$2P("esri.core.Loadable")], u2), u2;
};
let p$2N = class extends u$1I(_$G) {
};
p$2N = e$2g([n$2P("esri.core.Loadable")], p$2N), function(o2) {
  function t2(o3) {
    return !(!o3 || !o3.load);
  }
  o2.LoadableMixin = u$1I, o2.isLoadable = t2;
}(p$2N || (p$2N = {}));
const m$1X = p$2N;
var u$1H;
const m$1W = new s$2a({ avgRating: "avg-rating", numRatings: "num-ratings", numComments: "num-comments", numViews: "num-views" });
let c$2u = u$1H = class extends m$2q {
  constructor(t2) {
    super(t2), this.categories = null, this.disableExtraQuery = false, this.extent = null, this.filter = null, this.num = 10, this.query = null, this.sortField = null, this.start = 1;
  }
  get sortOrder() {
    return this._get("sortOrder") || "asc";
  }
  set sortOrder(t2) {
    t2 !== "asc" && t2 !== "desc" || this._set("sortOrder", t2);
  }
  clone() {
    return new u$1H({ categories: this.categories ? y$1L(this.categories) : null, disableExtraQuery: this.disableExtraQuery, extent: this.extent ? this.extent.clone() : null, filter: this.filter, num: this.num, query: this.query, sortField: this.sortField, sortOrder: this.sortOrder, start: this.start });
  }
  toRequestOptions(t2, r2) {
    let e2, s2;
    if (this.categories && (e2 = this.categories.map((t3) => Array.isArray(t3) ? JSON.stringify(t3) : t3)), this.extent) {
      const t3 = M$L(this.extent, k$C.WGS84);
      r$1$(t3) && (s2 = `${t3.xmin},${t3.ymin},${t3.xmax},${t3.ymax}`);
    }
    let i2 = this.query;
    !this.disableExtraQuery && t2.extraQuery && (i2 = "(" + i2 + ")" + t2.extraQuery);
    const a2 = { categories: e2, bbox: s2, q: i2, filter: this.filter, num: this.num, sortField: null, sortOrder: null, start: this.start };
    return this.sortField && (a2.sortField = this.sortField.split(",").map((t3) => m$1W.toJSON(t3.trim())).join(","), a2.sortOrder = this.sortOrder), { query: __spreadValues(__spreadValues({}, r2), a2) };
  }
};
e$2g([y$1I()], c$2u.prototype, "categories", void 0), e$2g([y$1I()], c$2u.prototype, "disableExtraQuery", void 0), e$2g([y$1I({ type: w$Z })], c$2u.prototype, "extent", void 0), e$2g([y$1I()], c$2u.prototype, "filter", void 0), e$2g([y$1I()], c$2u.prototype, "num", void 0), e$2g([y$1I()], c$2u.prototype, "query", void 0), e$2g([y$1I()], c$2u.prototype, "sortField", void 0), e$2g([y$1I()], c$2u.prototype, "sortOrder", null), e$2g([y$1I()], c$2u.prototype, "start", void 0), c$2u = u$1H = e$2g([n$2P("esri.portal.PortalQueryParams")], c$2u);
const d$1v = c$2u;
let e$1v = class extends m$2q {
  constructor(r2) {
    super(r2), this.nextQueryParams = null, this.queryParams = null, this.results = null, this.total = null;
  }
};
e$2g([y$1I()], e$1v.prototype, "nextQueryParams", void 0), e$2g([y$1I()], e$1v.prototype, "queryParams", void 0), e$2g([y$1I()], e$1v.prototype, "results", void 0), e$2g([y$1I()], e$1v.prototype, "total", void 0), e$1v = e$2g([n$2P("esri.portal.PortalQueryResult")], e$1v);
const p$2M = e$1v;
let p$2L = class extends l$2B {
  constructor(t2) {
    super(t2), this.created = null, this.id = null, this.portal = null, this.title = null, this.username = null;
  }
  get url() {
    const t2 = this.get("portal.restUrl");
    return t2 ? `${t2}/content/users/${this.username}/${this.id}` : null;
  }
  toJSON() {
    throw new s$2u("internal:not-yet-implemented", "PortalFolder.toJSON is not yet implemented");
  }
};
e$2g([y$1I({ type: Date })], p$2L.prototype, "created", void 0), e$2g([y$1I()], p$2L.prototype, "id", void 0), e$2g([y$1I()], p$2L.prototype, "portal", void 0), e$2g([y$1I()], p$2L.prototype, "title", void 0), e$2g([y$1I({ readOnly: true })], p$2L.prototype, "url", null), e$2g([y$1I()], p$2L.prototype, "username", void 0), p$2L = e$2g([n$2P("esri.portal.PortalFolder")], p$2L);
const l$1_ = p$2L;
let u$1G = class extends l$2B {
  constructor(t2) {
    super(t2), this.access = null, this.created = null, this.description = null, this.id = null, this.isInvitationOnly = false, this.modified = null, this.owner = null, this.portal = null, this.snippet = null, this.sortField = null, this.sortOrder = null, this.tags = null, this.title = null;
  }
  get thumbnailUrl() {
    var _a2;
    const t2 = this.url, r2 = this.thumbnail;
    return t2 && r2 && this.portal ? (_a2 = this.portal) == null ? void 0 : _a2._normalizeUrl(`${t2}/info/${r2}?f=json`) : null;
  }
  get url() {
    const t2 = this.get("portal.restUrl");
    return t2 ? t2 + "/community/groups/" + this.id : null;
  }
  fetchCategorySchema(t2) {
    return f$21(this.portal)._request(this.url + "/categorySchema", t2).then((r2) => {
      const e2 = r2.categorySchema || [];
      return e2.some((t3) => t3.source === "contentCategorySetsGroupQuery.LivingAtlas") ? this._fetchCategorySchemaSet("LivingAtlas", t2) : e2;
    });
  }
  fetchMembers(t2) {
    return f$21(this.portal)._request(this.url + "/users", t2);
  }
  getThumbnailUrl(t2) {
    let r2 = this.thumbnailUrl;
    return r2 && t2 && (r2 += `&w=${t2}`), r2;
  }
  toJSON() {
    throw new s$2u("internal:not-yet-implemented", "PortalGroup.toJSON is not yet implemented");
  }
  queryItems(t2, r2) {
    let e2 = b$1a(d$1v, t2);
    const s2 = f$21(this.portal);
    return parseFloat(s2.currentVersion) > 5 ? (e2 = e2 || new d$1v(), s2._queryPortal(`/content/groups/${this.id}/search`, e2, "PortalItem", r2)) : (e2 = e2 ? e2.clone() : new d$1v(), e2.query = "group:" + this.id + (e2.query ? " " + e2.query : ""), s2.queryItems(e2, r2));
  }
  _fetchCategorySchemaSet(t2, e2) {
    const s2 = f$21(this.portal);
    return s2._fetchSelf(s2.authMode, true, e2).then((t3) => {
      const o2 = t3.contentCategorySetsGroupQuery;
      if (o2) {
        const t4 = new d$1v();
        return t4.disableExtraQuery = true, t4.num = 1, t4.query = o2, s2.queryGroups(t4, e2);
      }
      throw new s$2u("portal-group:fetchCategorySchema", "contentCategorySetsGroupQuery value not found");
    }).then((o2) => {
      if (o2.total) {
        const r2 = o2.results[0], s3 = new d$1v();
        return s3.num = 1, s3.query = `typekeywords:"${t2}"`, r2.queryItems(s3, e2);
      }
      throw new s$2u("portal-group:fetchCategorySchema", "contentCategorySetsGroupQuery group not found");
    }).then((t3) => {
      if (t3.total) {
        return t3.results[0].fetchData("json", e2).then((t4) => {
          const r2 = t4 && t4.categorySchema;
          return r2 && r2.length ? r2 : [];
        });
      }
      return [];
    });
  }
};
e$2g([y$1I()], u$1G.prototype, "access", void 0), e$2g([y$1I({ type: Date })], u$1G.prototype, "created", void 0), e$2g([y$1I()], u$1G.prototype, "description", void 0), e$2g([y$1I()], u$1G.prototype, "id", void 0), e$2g([y$1I()], u$1G.prototype, "isInvitationOnly", void 0), e$2g([y$1I({ type: Date })], u$1G.prototype, "modified", void 0), e$2g([y$1I()], u$1G.prototype, "owner", void 0), e$2g([y$1I()], u$1G.prototype, "portal", void 0), e$2g([y$1I()], u$1G.prototype, "snippet", void 0), e$2g([y$1I()], u$1G.prototype, "sortField", void 0), e$2g([y$1I()], u$1G.prototype, "sortOrder", void 0), e$2g([y$1I()], u$1G.prototype, "tags", void 0), e$2g([y$1I()], u$1G.prototype, "thumbnail", void 0), e$2g([y$1I({ readOnly: true })], u$1G.prototype, "thumbnailUrl", null), e$2g([y$1I()], u$1G.prototype, "title", void 0), e$2g([y$1I({ readOnly: true })], u$1G.prototype, "url", null), u$1G = e$2g([n$2P("esri.portal.PortalGroup")], u$1G);
const p$2K = u$1G;
var PortalGroup = /* @__PURE__ */ Object.freeze({
  __proto__: null,
  [Symbol.toStringTag]: "Module",
  "default": p$2K
});
var i$2p;
let u$1F = i$2p = class extends l$2B {
  constructor(...t2) {
    super(...t2), this.access = null, this.created = null, this.culture = null, this.description = null, this.email = null, this.fullName = null, this.modified = null, this.orgId = null, this.portal = null, this.preferredView = null, this.privileges = null, this.region = null, this.role = null, this.roleId = null, this.sourceJSON = null, this.units = null, this.username = null, this.userType = null;
  }
  get thumbnailUrl() {
    const t2 = this.url, r2 = this.thumbnail;
    return t2 && r2 ? this.portal._normalizeUrl(`${t2}/info/${r2}?f=json`) : null;
  }
  get userContentUrl() {
    const t2 = this.get("portal.restUrl");
    return t2 ? `${t2}/content/users/${this.username}` : null;
  }
  get url() {
    const t2 = this.get("portal.restUrl");
    return t2 ? `${t2}/community/users/${this.username}` : null;
  }
  addItem(t2) {
    const r2 = t2 && t2.item, e2 = t2 && t2.data, o2 = t2 && t2.folder, l2 = { method: "post" };
    r2 && (l2.query = r2.createPostQuery(), e2 != null && (typeof e2 == "string" ? l2.query.text = e2 : typeof e2 == "object" && (l2.query.text = JSON.stringify(e2))));
    let s2 = this.userContentUrl;
    return o2 && (s2 += "/" + (typeof o2 == "string" ? o2 : o2.id)), this.portal._request(s2 + "/addItem", l2).then((t3) => (r2.id = t3.id, r2.portal = this.portal, r2.loaded ? r2.reload() : r2.load()));
  }
  deleteItem(t2) {
    let r2 = this.userContentUrl;
    return t2.ownerFolder && (r2 += "/" + t2.ownerFolder), this.portal._request(r2 + `/items/${t2.id}/delete`, { method: "post" }).then(() => {
      t2.id = null, t2.portal = null;
    });
  }
  deleteItems(t2) {
    const r2 = this.userContentUrl + "/deleteItems", e2 = t2.map((t3) => t3.id);
    if (e2.length) {
      const o2 = { method: "post", query: { items: e2.join(",") } };
      return this.portal._request(r2, o2).then(() => {
        t2.forEach((t3) => {
          t3.id = null, t3.portal = null;
        });
      });
    }
    return Promise.resolve(void 0);
  }
  fetchFolders() {
    var _a2;
    const t2 = { query: { num: 1 } };
    return this.portal._request((_a2 = this.userContentUrl) != null ? _a2 : "", t2).then((t3) => {
      let r2;
      return r2 = t3 && t3.folders ? t3.folders.map((t4) => {
        const r3 = l$1_.fromJSON(t4);
        return r3.portal = this.portal, r3;
      }) : [], r2;
    });
  }
  fetchGroups() {
    var _a2;
    return this.portal._request((_a2 = this.url) != null ? _a2 : "").then((t2) => {
      let r2;
      return r2 = t2 && t2.groups ? t2.groups.map((t3) => {
        const r3 = p$2K.fromJSON(t3);
        return r3.portal = this.portal, r3;
      }) : [], r2;
    });
  }
  fetchItems(t2) {
    var _a2;
    const r2 = t2 != null ? t2 : {};
    let e2, o2 = (_a2 = this.userContentUrl) != null ? _a2 : "";
    return r2.folder && (o2 += "/" + r2.folder.id), Promise.resolve().then(function() {
      return PortalItem;
    }).then(({ default: t3 }) => {
      e2 = t3;
      const l2 = { folders: false, num: r2.num || 10, start: r2.start || 1, sortField: r2.sortField || "created", sortOrder: r2.sortOrder || "asc" };
      return this.portal._request(o2, { query: l2 });
    }).then((t3) => {
      let r3;
      return t3 && t3.items ? (r3 = t3.items.map((t4) => {
        const r4 = e2.fromJSON(t4);
        return r4.portal = this.portal, r4;
      }), Promise.all(r3.map((t4) => t4.load())).catch((t4) => t4).then(() => ({ items: r3, nextStart: t3.nextStart, total: t3.total }))) : { items: [], nextStart: -1, total: 0 };
    });
  }
  fetchTags() {
    return this.portal._request(this.url + "/tags").then((t2) => t2.tags);
  }
  getThumbnailUrl(t2) {
    let r2 = this.thumbnailUrl;
    return r2 && t2 && (r2 += `&w=${t2}`), r2;
  }
  queryFavorites(t2) {
    return this.favGroupId ? (this._favGroup || (this._favGroup = new p$2K({ id: this.favGroupId, portal: this.portal })), this._favGroup.queryItems(t2)) : Promise.reject(new s$2u("internal:unknown", "Unknown internal error", { internalError: "Unknown favGroupId" }));
  }
  toJSON() {
    throw new s$2u("internal:not-yet-implemented", "PortalGroup.toJSON is not yet implemented");
  }
  static fromJSON(t2) {
    if (!t2)
      return null;
    if (t2.declaredClass)
      throw new Error("JSON object is already hydrated");
    const r2 = new i$2p();
    return r2.sourceJSON = t2, r2.read(t2), r2;
  }
};
e$2g([y$1I()], u$1F.prototype, "access", void 0), e$2g([y$1I({ type: Date })], u$1F.prototype, "created", void 0), e$2g([y$1I()], u$1F.prototype, "culture", void 0), e$2g([y$1I()], u$1F.prototype, "description", void 0), e$2g([y$1I()], u$1F.prototype, "email", void 0), e$2g([y$1I()], u$1F.prototype, "favGroupId", void 0), e$2g([y$1I()], u$1F.prototype, "fullName", void 0), e$2g([y$1I({ type: Date })], u$1F.prototype, "modified", void 0), e$2g([y$1I()], u$1F.prototype, "orgId", void 0), e$2g([y$1I()], u$1F.prototype, "portal", void 0), e$2g([y$1I()], u$1F.prototype, "preferredView", void 0), e$2g([y$1I()], u$1F.prototype, "privileges", void 0), e$2g([y$1I()], u$1F.prototype, "region", void 0), e$2g([y$1I()], u$1F.prototype, "role", void 0), e$2g([y$1I()], u$1F.prototype, "roleId", void 0), e$2g([y$1I()], u$1F.prototype, "sourceJSON", void 0), e$2g([y$1I()], u$1F.prototype, "thumbnail", void 0), e$2g([y$1I({ readOnly: true })], u$1F.prototype, "thumbnailUrl", null), e$2g([y$1I()], u$1F.prototype, "units", void 0), e$2g([y$1I({ readOnly: true })], u$1F.prototype, "userContentUrl", null), e$2g([y$1I({ readOnly: true })], u$1F.prototype, "url", null), e$2g([y$1I()], u$1F.prototype, "username", void 0), e$2g([y$1I()], u$1F.prototype, "userType", void 0), u$1F = i$2p = e$2g([n$2P("esri.portal.PortalUser")], u$1F);
const p$2J = u$1F;
var PortalUser = /* @__PURE__ */ Object.freeze({
  __proto__: null,
  [Symbol.toStringTag]: "Module",
  "default": p$2J
});
var G$o;
let U$s;
const B$p = { PortalGroup: () => Promise.resolve().then(function() {
  return PortalGroup;
}), PortalItem: () => Promise.resolve().then(function() {
  return PortalItem;
}), PortalUser: () => Promise.resolve().then(function() {
  return PortalUser;
}) };
let D$q = G$o = class extends u$2b(m$1X) {
  constructor(e2) {
    super(e2), this._esriIdCredentialCreateHandle = null, this.access = null, this.allSSL = false, this.authMode = "auto", this.authorizedCrossOriginDomains = null, this.basemapGalleryGroupQuery = null, this.bingKey = null, this.canListApps = false, this.canListData = false, this.canListPreProvisionedItems = false, this.canProvisionDirectPurchase = false, this.canSearchPublic = true, this.canShareBingPublic = false, this.canSharePublic = false, this.canSignInArcGIS = false, this.canSignInIDP = false, this.colorSetsGroupQuery = null, this.commentsEnabled = false, this.created = null, this.culture = null, this.customBaseUrl = null, this.defaultBasemap = null, this.defaultDevBasemap = null, this.defaultExtent = null, this.defaultVectorBasemap = null, this.description = null, this.devBasemapGalleryGroupQuery = null, this.eueiEnabled = null, this.featuredGroups = null, this.featuredItemsGroupQuery = null, this.galleryTemplatesGroupQuery = null, this.livingAtlasGroupQuery = null, this.hasCategorySchema = false, this.helperServices = null, this.homePageFeaturedContent = null, this.homePageFeaturedContentCount = null, this.httpPort = null, this.httpsPort = null, this.id = null, this.ipCntryCode = null, this.isPortal = false, this.isReadOnly = false, this.layerTemplatesGroupQuery = null, this.maxTokenExpirationMinutes = null, this.modified = null, this.name = null, this.portalHostname = null, this.portalMode = null, this.portalProperties = null, this.region = null, this.rotatorPanels = null, this.showHomePageDescription = false, this.sourceJSON = null, this.supportsHostedServices = false, this.symbolSetsGroupQuery = null, this.templatesGroupQuery = null, this.units = null, this.url = s$2A.portalUrl, this.urlKey = null, this.user = null, this.useStandardizedQuery = false, this.useVectorBasemaps = false, this.vectorBasemapGalleryGroupQuery = null;
  }
  normalizeCtorArgs(e2) {
    return typeof e2 == "string" ? { url: e2 } : e2;
  }
  destroy() {
    this._esriIdCredentialCreateHandle = h$1W(this._esriIdCredentialCreateHandle);
  }
  readAuthorizedCrossOriginDomains(e2) {
    if (e2)
      for (const r2 of e2)
        s$2A.request.trustedServers.includes(r2) || s$2A.request.trustedServers.push(r2);
    return e2;
  }
  readDefaultBasemap(e2) {
    return this._readBasemap(e2);
  }
  readDefaultDevBasemap(e2) {
    return this._readBasemap(e2);
  }
  readDefaultVectorBasemap(e2) {
    return this._readBasemap(e2);
  }
  get extraQuery() {
    const e2 = !(this.user && this.user.orgId) || this.canSearchPublic;
    return this.id && !e2 ? ` AND orgid:${this.id}` : null;
  }
  get isOrganization() {
    return !!this.access;
  }
  get itemPageUrl() {
    return this.url ? `${this.url}/home/item.html` : null;
  }
  get restUrl() {
    let e2 = this.url;
    if (e2) {
      const t2 = e2.indexOf("/sharing");
      e2 = t2 > 0 ? e2.substring(0, t2) : this.url.replace(/\/+$/, ""), e2 += "/sharing/rest";
    }
    return e2;
  }
  get thumbnailUrl() {
    const e2 = this.restUrl, t2 = this.thumbnail;
    return e2 && t2 ? this._normalizeSSL(e2 + "/portals/self/resources/" + t2) : null;
  }
  readUrlKey(e2) {
    return e2 ? e2.toLowerCase() : e2;
  }
  readUser(e2) {
    let t2 = null;
    return e2 && (t2 = p$2J.fromJSON(e2), t2.portal = this), t2;
  }
  load(e2) {
    const t2 = Promise.resolve().then(function() {
      return Basemap;
    }).then(({ default: t3 }) => {
      f$1V(e2), U$s = t3;
    }).then(() => this.sourceJSON ? this.sourceJSON : this._fetchSelf(this.authMode, false, e2)).then((e3) => {
      if (s$1Q) {
        const e4 = s$1Q;
        this.credential = e4.findCredential(this.restUrl), this.credential || this.authMode !== G$o.AUTH_MODE_AUTO || (this._esriIdCredentialCreateHandle = e4.on("credential-create", () => {
          e4.findCredential(this.restUrl) && this._signIn().catch(() => {
          });
        }));
      }
      this.sourceJSON = e3, this.read(e3);
    });
    return this.addResolvingPromise(t2), Promise.resolve(this);
  }
  async createElevationLayers() {
    await this.load();
    const e2 = this._getHelperService("defaultElevationLayers"), t2 = (await import("./ElevationLayer.js")).default;
    return e2 ? e2.map((e3) => new t2({ id: e3.id, url: e3.url })) : [];
  }
  fetchBasemaps(e2, r2) {
    const o2 = new d$1v();
    return o2.query = e2 || (s$2A.apiKey && r$1t(this.url) ? this.devBasemapGalleryGroupQuery : this.useVectorBasemaps ? this.vectorBasemapGalleryGroupQuery : this.basemapGalleryGroupQuery), o2.disableExtraQuery = true, this.queryGroups(o2, r2).then((e3) => {
      if (o2.num = 100, o2.query = 'type:"Web Map" -type:"Web Application"', e3.total) {
        const t2 = e3.results[0];
        return o2.sortField = t2.sortField || "name", o2.sortOrder = t2.sortOrder || "desc", t2.queryItems(o2, r2);
      }
      return null;
    }).then((e3) => {
      let t2;
      return t2 = e3 && e3.total ? e3.results.filter((e4) => e4.type === "Web Map").map((e4) => new U$s({ portalItem: e4 })) : [], t2;
    });
  }
  fetchCategorySchema(e2) {
    return this.hasCategorySchema ? this._request(this.restUrl + "/portals/self/categorySchema", e2).then((e3) => e3.categorySchema) : p$3D(e2) ? Promise.reject(a$2T()) : Promise.resolve([]);
  }
  fetchFeaturedGroups(e2) {
    const t2 = this.featuredGroups, r2 = new d$1v();
    if (r2.num = 100, r2.sortField = "title", t2 && t2.length) {
      const o2 = [];
      for (const e3 of t2)
        o2.push(`(title:"${e3.title}" AND owner:${e3.owner})`);
      return r2.query = o2.join(" OR "), this.queryGroups(r2, e2).then((e3) => e3.results);
    }
    return p$3D(e2) ? Promise.reject(a$2T()) : Promise.resolve([]);
  }
  fetchRegions(e2) {
    var _a2;
    const t2 = ((_a2 = this.user) == null ? void 0 : _a2.culture) || this.culture || l$2r();
    return this._request(this.restUrl + "/portals/regions", __spreadProps(__spreadValues({}, e2), { query: { culture: t2 } }));
  }
  fetchSettings(e2) {
    var _a2;
    const t2 = ((_a2 = this.user) == null ? void 0 : _a2.culture) || this.culture || l$2r();
    return this._request(this.restUrl + "/portals/self/settings", __spreadProps(__spreadValues({}, e2), { query: { culture: t2 } }));
  }
  static getDefault() {
    return G$o._default && !G$o._default.destroyed || (G$o._default = new G$o()), G$o._default;
  }
  queryGroups(e2, t2) {
    return this._queryPortal("/community/groups", e2, "PortalGroup", t2);
  }
  queryItems(e2, t2) {
    return this._queryPortal("/search", e2, "PortalItem", t2);
  }
  queryUsers(e2, t2) {
    return e2.sortField || (e2.sortField = "username"), this._queryPortal("/community/users", e2, "PortalUser", t2);
  }
  toJSON() {
    throw new s$2u("internal:not-yet-implemented", "Portal.toJSON is not yet implemented");
  }
  static fromJSON(e2) {
    if (!e2)
      return null;
    if (e2.declaredClass)
      throw new Error("JSON object is already hydrated");
    return new G$o({ sourceJSON: e2 });
  }
  _getHelperService(e2) {
    const t2 = this.helperServices && this.helperServices[e2];
    if (!t2)
      throw new s$2u("portal:service-not-found", `The \`helperServices\` do not include an entry named "${e2}"`);
    return t2;
  }
  _getHelperServiceUrl(e2) {
    const t2 = this._getHelperService(e2);
    if (!(t2 == null ? void 0 : t2.url))
      throw new s$2u("portal:service-url-not-found", `The \`helperServices\` entry "${e2}" does not include a \`url\` value`);
    return t2.url;
  }
  _fetchSelf(e2 = this.authMode, t2 = false, r2) {
    const o2 = this.restUrl + "/portals/self", s2 = __spreadValues({ authMode: e2, query: { culture: l$2r().toLowerCase() } }, r2);
    return s2.authMode === "auto" && (s2.authMode = "no-prompt"), t2 && (s2.query.default = true), this._request(o2, s2);
  }
  _queryPortal(e2, t2, r2, o2) {
    const s2 = b$1a(d$1v, t2), i2 = (t3) => this._request(this.restUrl + e2, __spreadValues(__spreadValues({}, s2.toRequestOptions(this)), o2)).then((e3) => {
      const r3 = s2.clone();
      return r3.start = e3.nextStart, new p$2M({ nextQueryParams: r3, queryParams: s2, total: e3.total, results: G$o._resultsToTypedArray(t3, { portal: this }, e3, o2) });
    }).then((e3) => Promise.all(e3.results.map((t4) => typeof t4.when == "function" ? t4.when() : e3)).then(() => e3, (t4) => (w$12(t4), e3)));
    return r2 && B$p[r2] ? B$p[r2]().then(({ default: e3 }) => (f$1V(o2), i2(e3))) : i2();
  }
  _signIn() {
    if (this.authMode === G$o.AUTH_MODE_ANONYMOUS)
      return Promise.reject(new s$2u("portal:invalid-auth-mode", `Current "authMode"' is "${this.authMode}"`));
    if (this.loadStatus === "failed")
      return Promise.reject(this.loadError);
    const e2 = (e3) => Promise.resolve().then(() => this.loadStatus === "not-loaded" ? (e3 || (this.authMode = "immediate"), this.load().then(() => null)) : this.loadStatus === "loading" ? this.load().then(() => this.credential ? null : (this.credential = e3, this._fetchSelf("immediate"))) : this.user && this.credential === e3 ? null : (this.credential = e3, this._fetchSelf("immediate"))).then((e4) => {
      e4 && (this.sourceJSON = e4, this.read(e4));
    });
    return s$1Q ? s$1Q.getCredential(this.restUrl).then((t2) => e2(t2)) : e2(this.credential);
  }
  _normalizeSSL(e2) {
    return e2.replace(/^http:/i, "https:").replace(":7080", ":7443");
  }
  _normalizeUrl(e2) {
    const t2 = this.credential && this.credential.token;
    return this._normalizeSSL(t2 ? e2 + (e2.includes("?") ? "&" : "?") + "token=" + t2 : e2);
  }
  _requestToTypedArray(e2, t2, r2) {
    return this._request(e2, t2).then((e3) => {
      const t3 = G$o._resultsToTypedArray(r2, { portal: this }, e3);
      return Promise.all(t3.map((t4) => typeof t4.when == "function" ? t4.when() : e3)).then(() => t3, () => t3);
    });
  }
  _readBasemap(e2) {
    if (e2) {
      const t2 = U$s.fromJSON(e2);
      return t2.portalItem = { portal: this }, t2;
    }
    return null;
  }
  _request(e2, t2 = {}) {
    const r2 = __spreadValues({ f: "json" }, t2.query), { authMode: s2 = this.authMode === G$o.AUTH_MODE_ANONYMOUS ? "anonymous" : "auto", body: i2 = null, cacheBust: a2 = false, method: l2 = "auto", responseType: u2 = "json", signal: n2 } = t2, p2 = { authMode: s2, body: i2, cacheBust: a2, method: l2, query: r2, responseType: u2, timeout: 0, signal: n2 };
    return U$t(this._normalizeSSL(e2), p2).then((e3) => e3.data);
  }
  static _resultsToTypedArray(e2, t2, r2, o2) {
    let s2;
    if (r2) {
      const i2 = r$1$(o2) ? o2.signal : null;
      s2 = r2.listings || r2.notifications || r2.userInvitations || r2.tags || r2.items || r2.groups || r2.comments || r2.provisions || r2.results || r2.relatedItems || r2, (e2 || t2) && (s2 = s2.map((r3) => {
        const o3 = Object.assign(e2 ? e2.fromJSON(r3) : r3, t2);
        return typeof o3.load == "function" && o3.load(i2), o3;
      }));
    } else
      s2 = [];
    return s2;
  }
};
D$q.AUTH_MODE_ANONYMOUS = "anonymous", D$q.AUTH_MODE_AUTO = "auto", D$q.AUTH_MODE_IMMEDIATE = "immediate", e$2g([y$1I()], D$q.prototype, "access", void 0), e$2g([y$1I()], D$q.prototype, "allSSL", void 0), e$2g([y$1I()], D$q.prototype, "authMode", void 0), e$2g([y$1I()], D$q.prototype, "authorizedCrossOriginDomains", void 0), e$2g([o$29("authorizedCrossOriginDomains")], D$q.prototype, "readAuthorizedCrossOriginDomains", null), e$2g([y$1I()], D$q.prototype, "basemapGalleryGroupQuery", void 0), e$2g([y$1I()], D$q.prototype, "bingKey", void 0), e$2g([y$1I()], D$q.prototype, "canListApps", void 0), e$2g([y$1I()], D$q.prototype, "canListData", void 0), e$2g([y$1I()], D$q.prototype, "canListPreProvisionedItems", void 0), e$2g([y$1I()], D$q.prototype, "canProvisionDirectPurchase", void 0), e$2g([y$1I()], D$q.prototype, "canSearchPublic", void 0), e$2g([y$1I()], D$q.prototype, "canShareBingPublic", void 0), e$2g([y$1I()], D$q.prototype, "canSharePublic", void 0), e$2g([y$1I()], D$q.prototype, "canSignInArcGIS", void 0), e$2g([y$1I()], D$q.prototype, "canSignInIDP", void 0), e$2g([y$1I()], D$q.prototype, "colorSetsGroupQuery", void 0), e$2g([y$1I()], D$q.prototype, "commentsEnabled", void 0), e$2g([y$1I({ type: Date })], D$q.prototype, "created", void 0), e$2g([y$1I()], D$q.prototype, "credential", void 0), e$2g([y$1I()], D$q.prototype, "culture", void 0), e$2g([y$1I()], D$q.prototype, "currentVersion", void 0), e$2g([y$1I()], D$q.prototype, "customBaseUrl", void 0), e$2g([y$1I()], D$q.prototype, "defaultBasemap", void 0), e$2g([o$29("defaultBasemap")], D$q.prototype, "readDefaultBasemap", null), e$2g([y$1I()], D$q.prototype, "defaultDevBasemap", void 0), e$2g([o$29("defaultDevBasemap")], D$q.prototype, "readDefaultDevBasemap", null), e$2g([y$1I({ type: w$Z })], D$q.prototype, "defaultExtent", void 0), e$2g([y$1I()], D$q.prototype, "defaultVectorBasemap", void 0), e$2g([o$29("defaultVectorBasemap")], D$q.prototype, "readDefaultVectorBasemap", null), e$2g([y$1I()], D$q.prototype, "description", void 0), e$2g([y$1I()], D$q.prototype, "devBasemapGalleryGroupQuery", void 0), e$2g([y$1I()], D$q.prototype, "eueiEnabled", void 0), e$2g([y$1I({ readOnly: true })], D$q.prototype, "extraQuery", null), e$2g([y$1I()], D$q.prototype, "featuredGroups", void 0), e$2g([y$1I()], D$q.prototype, "featuredItemsGroupQuery", void 0), e$2g([y$1I()], D$q.prototype, "galleryTemplatesGroupQuery", void 0), e$2g([y$1I()], D$q.prototype, "livingAtlasGroupQuery", void 0), e$2g([y$1I()], D$q.prototype, "hasCategorySchema", void 0), e$2g([y$1I()], D$q.prototype, "helpBase", void 0), e$2g([y$1I()], D$q.prototype, "helperServices", void 0), e$2g([y$1I()], D$q.prototype, "helpMap", void 0), e$2g([y$1I()], D$q.prototype, "homePageFeaturedContent", void 0), e$2g([y$1I()], D$q.prototype, "homePageFeaturedContentCount", void 0), e$2g([y$1I()], D$q.prototype, "httpPort", void 0), e$2g([y$1I()], D$q.prototype, "httpsPort", void 0), e$2g([y$1I()], D$q.prototype, "id", void 0), e$2g([y$1I()], D$q.prototype, "ipCntryCode", void 0), e$2g([y$1I({ readOnly: true })], D$q.prototype, "isOrganization", null), e$2g([y$1I()], D$q.prototype, "isPortal", void 0), e$2g([y$1I()], D$q.prototype, "isReadOnly", void 0), e$2g([y$1I({ readOnly: true })], D$q.prototype, "itemPageUrl", null), e$2g([y$1I()], D$q.prototype, "layerTemplatesGroupQuery", void 0), e$2g([y$1I()], D$q.prototype, "maxTokenExpirationMinutes", void 0), e$2g([y$1I({ type: Date })], D$q.prototype, "modified", void 0), e$2g([y$1I()], D$q.prototype, "name", void 0), e$2g([y$1I()], D$q.prototype, "portalHostname", void 0), e$2g([y$1I()], D$q.prototype, "portalMode", void 0), e$2g([y$1I()], D$q.prototype, "portalProperties", void 0), e$2g([y$1I()], D$q.prototype, "region", void 0), e$2g([y$1I({ readOnly: true })], D$q.prototype, "restUrl", null), e$2g([y$1I()], D$q.prototype, "rotatorPanels", void 0), e$2g([y$1I()], D$q.prototype, "showHomePageDescription", void 0), e$2g([y$1I()], D$q.prototype, "sourceJSON", void 0), e$2g([y$1I()], D$q.prototype, "staticImagesUrl", void 0), e$2g([y$1I({ json: { name: "2DStylesGroupQuery" } })], D$q.prototype, "stylesGroupQuery2d", void 0), e$2g([y$1I({ json: { name: "stylesGroupQuery" } })], D$q.prototype, "stylesGroupQuery3d", void 0), e$2g([y$1I()], D$q.prototype, "supportsHostedServices", void 0), e$2g([y$1I()], D$q.prototype, "symbolSetsGroupQuery", void 0), e$2g([y$1I()], D$q.prototype, "templatesGroupQuery", void 0), e$2g([y$1I()], D$q.prototype, "thumbnail", void 0), e$2g([y$1I({ readOnly: true })], D$q.prototype, "thumbnailUrl", null), e$2g([y$1I()], D$q.prototype, "units", void 0), e$2g([y$1I()], D$q.prototype, "url", void 0), e$2g([y$1I()], D$q.prototype, "urlKey", void 0), e$2g([o$29("urlKey")], D$q.prototype, "readUrlKey", null), e$2g([y$1I()], D$q.prototype, "user", void 0), e$2g([o$29("user")], D$q.prototype, "readUser", null), e$2g([y$1I()], D$q.prototype, "useStandardizedQuery", void 0), e$2g([y$1I()], D$q.prototype, "useVectorBasemaps", void 0), e$2g([y$1I()], D$q.prototype, "vectorBasemapGalleryGroupQuery", void 0), D$q = G$o = e$2g([n$2P("esri.portal.Portal")], D$q);
const j$M = D$q;
let m$1V = class extends i$2R(l$2B) {
  constructor(o2) {
    super(o2), this.type = "style", this.placement = "begin-end", this.style = "arrow", this.color = null;
  }
  equals(o2) {
    return r$1$(o2) && o2.placement === this.placement && o2.style === this.style && (t$2r(this.color) && t$2r(o2.color) || r$1$(this.color) && r$1$(o2.color) && this.color.toJSON() === o2.color.toJSON());
  }
};
e$2g([y$1I({ type: ["style"], readOnly: true, json: { read: true, write: { ignoreOrigin: true } } })], m$1V.prototype, "type", void 0), e$2g([y$1I({ type: e$1C, json: { default: "begin-end", write: true } })], m$1V.prototype, "placement", void 0), e$2g([y$1I({ type: n$2q, json: { default: "arrow", write: true } })], m$1V.prototype, "style", void 0), e$2g([y$1I({ type: l$2e, json: { type: [T$G], default: null, write: true } })], m$1V.prototype, "color", void 0), m$1V = e$2g([n$2P("esri.symbols.LineStyleMarker3D")], m$1V);
const y$1i = m$1V;
var d$1u;
let f$1t = d$1u = class extends a$2t {
  constructor(t2) {
    super(t2), this.material = null, this.type = "line", this.join = "miter", this.cap = "butt", this.size = e$1D(1), this.pattern = null, this.marker = null;
  }
  clone() {
    const t2 = { enabled: this.enabled, material: r$1$(this.material) ? this.material.clone() : null, size: this.size, join: this.join, cap: this.cap, pattern: r$1$(this.pattern) ? this.pattern.clone() : null, marker: r$1$(this.marker) ? this.marker.clone() : null };
    return new d$1u(t2);
  }
  static fromSimpleLineSymbol(t2) {
    var _a2, _b2, _c2;
    const e2 = { enabled: true, size: (_a2 = t2.width) != null ? _a2 : e$1D(1), cap: t2.cap || "butt", join: t2.join || "miter", pattern: t2.style && t2.style !== "inside-frame" ? new n$2o({ style: t2.style }) : null, material: new l$2a({ color: (t2.color || o$1K).clone() }), marker: t2.marker ? new y$1i({ placement: t2.marker.placement, style: t2.marker.style, color: (_c2 = (_b2 = t2.marker.color) == null ? void 0 : _b2.clone()) != null ? _c2 : null }) : null };
    return new d$1u(e2);
  }
};
e$2g([y$1I({ type: l$2a, json: { write: true } })], f$1t.prototype, "material", void 0), e$2g([r$1H({ Line: "line" }, { readOnly: true })], f$1t.prototype, "type", void 0), e$2g([y$1I({ type: a$2o, json: { write: true, default: "miter" } })], f$1t.prototype, "join", void 0), e$2g([y$1I({ type: u$1M, json: { write: true, default: "butt" } })], f$1t.prototype, "cap", void 0), e$2g([y$1I(a$2s)], f$1t.prototype, "size", void 0), e$2g([y$1I(o$1L)], f$1t.prototype, "pattern", void 0), e$2g([y$1I({ types: { key: "type", base: y$1i, typeMap: { style: y$1i } }, json: { write: true } })], f$1t.prototype, "marker", void 0), f$1t = d$1u = e$2g([n$2P("esri.symbols.LineSymbol3DLayer")], f$1t);
const h$1p = f$1t;
var n$2i;
const a$2h = o$1_()({ sphere: "sphere", cylinder: "cylinder", cube: "cube", cone: "cone", diamond: "diamond", tetrahedron: "tetrahedron", invertedCone: "inverted-cone" });
let m$1U = n$2i = class extends l$2B {
  clone() {
    return new n$2i({ href: this.href, primitive: this.primitive });
  }
};
e$2g([y$1I({ type: String, json: { read: p$2P, write: f$1w } })], m$1U.prototype, "href", void 0), e$2g([r$1H(a$2h)], m$1U.prototype, "primitive", void 0), m$1U = n$2i = e$2g([n$2P("esri.symbols.support.ObjectSymbol3DLayerResource")], m$1U);
const d$1t = "sphere";
var e$1u;
let p$2I = e$1u = class extends m$2q {
  constructor() {
    super(...arguments), this.x = 0, this.y = 0, this.z = 0;
  }
  clone() {
    return new e$1u({ x: this.x, y: this.y, z: this.z });
  }
};
e$2g([y$1I({ type: Number })], p$2I.prototype, "x", void 0), e$2g([y$1I({ type: Number })], p$2I.prototype, "y", void 0), e$2g([y$1I({ type: Number })], p$2I.prototype, "z", void 0), p$2I = e$1u = e$2g([n$2P("esri.symbols.support.Symbol3DAnchorPosition3D")], p$2I);
var n$2h;
let c$2t = n$2h = class extends a$2t {
  constructor(o2) {
    super(o2), this.material = null, this.castShadows = true, this.resource = null, this.type = "object", this.width = void 0, this.height = void 0, this.depth = void 0, this.anchor = void 0, this.anchorPosition = void 0, this.heading = void 0, this.tilt = void 0, this.roll = void 0;
  }
  clone() {
    return new n$2h({ heading: this.heading, tilt: this.tilt, roll: this.roll, anchor: this.anchor, anchorPosition: this.anchorPosition && this.anchorPosition.clone(), depth: this.depth, enabled: this.enabled, height: this.height, material: r$1$(this.material) ? this.material.clone() : null, castShadows: this.castShadows, resource: this.resource && this.resource.clone(), width: this.width });
  }
  get isPrimitive() {
    return !this.resource || typeof this.resource.href != "string";
  }
};
e$2g([y$1I({ type: l$2a, json: { write: true } })], c$2t.prototype, "material", void 0), e$2g([y$1I({ type: Boolean, nonNullable: true, json: { write: true, default: true } })], c$2t.prototype, "castShadows", void 0), e$2g([y$1I({ type: m$1U, json: { write: true } })], c$2t.prototype, "resource", void 0), e$2g([r$1H({ Object: "object" }, { readOnly: true })], c$2t.prototype, "type", void 0), e$2g([y$1I({ type: Number, json: { write: true } })], c$2t.prototype, "width", void 0), e$2g([y$1I({ type: Number, json: { write: true } })], c$2t.prototype, "height", void 0), e$2g([y$1I({ type: Number, json: { write: true } })], c$2t.prototype, "depth", void 0), e$2g([r$1H({ center: "center", top: "top", bottom: "bottom", origin: "origin", relative: "relative" }), y$1I({ json: { default: "origin" } })], c$2t.prototype, "anchor", void 0), e$2g([y$1I({ type: p$2I, json: { type: [Number], read: { reader: (o2) => new p$2I({ x: o2[0], y: o2[1], z: o2[2] }) }, write: { writer: (o2, t2) => {
  t2.anchorPosition = [o2.x, o2.y, o2.z];
}, overridePolicy() {
  return { enabled: this.anchor === "relative" };
} } } })], c$2t.prototype, "anchorPosition", void 0), e$2g([y$1I({ type: Number, json: { write: true } })], c$2t.prototype, "heading", void 0), e$2g([y$1I({ type: Number, json: { write: true } })], c$2t.prototype, "tilt", void 0), e$2g([y$1I({ type: Number, json: { write: true } })], c$2t.prototype, "roll", void 0), e$2g([y$1I({ readOnly: true })], c$2t.prototype, "isPrimitive", null), c$2t = n$2h = e$2g([n$2P("esri.symbols.ObjectSymbol3DLayer")], c$2t);
const l$1Z = c$2t;
var n$2g;
let d$1s = n$2g = class extends a$2t {
  constructor(t2) {
    super(t2), this.material = null, this.castShadows = true, this.type = "path", this.profile = "circle", this.join = "miter", this.cap = "butt", this.width = void 0, this.height = void 0, this.anchor = "center", this.profileRotation = "all";
  }
  readWidth(t2, e2) {
    return t2 != null ? t2 : e2.height == null && e2.size != null ? e2.size : void 0;
  }
  readHeight(t2, e2) {
    return t2 != null ? t2 : e2.width == null && e2.size != null ? e2.size : void 0;
  }
  clone() {
    return new n$2g({ enabled: this.enabled, material: r$1$(this.material) ? this.material.clone() : null, castShadows: this.castShadows, profile: this.profile, join: this.join, cap: this.cap, width: this.width, height: this.height, profileRotation: this.profileRotation, anchor: this.anchor });
  }
};
e$2g([y$1I({ type: l$2a, json: { write: true } })], d$1s.prototype, "material", void 0), e$2g([y$1I({ type: Boolean, nonNullable: true, json: { write: true, default: true } })], d$1s.prototype, "castShadows", void 0), e$2g([r$1H({ Path: "path" }, { readOnly: true })], d$1s.prototype, "type", void 0), e$2g([y$1I({ type: ["circle", "quad"], json: { write: true, default: "circle" } })], d$1s.prototype, "profile", void 0), e$2g([y$1I({ type: a$2o, json: { write: true, default: "miter" } })], d$1s.prototype, "join", void 0), e$2g([y$1I({ type: i$2s, json: { write: true, default: "butt" } })], d$1s.prototype, "cap", void 0), e$2g([y$1I({ type: Number, json: { write: { enabled: true, target: { width: { type: Number }, size: { type: Number } } } } })], d$1s.prototype, "width", void 0), e$2g([o$29("width", ["width", "size", "height"])], d$1s.prototype, "readWidth", null), e$2g([y$1I({ type: Number, json: { write: true } })], d$1s.prototype, "height", void 0), e$2g([o$29("height", ["height", "size", "width"])], d$1s.prototype, "readHeight", null), e$2g([y$1I({ type: ["center", "bottom", "top"], json: { write: true, default: "center" } })], d$1s.prototype, "anchor", void 0), e$2g([y$1I({ type: ["heading", "all"], json: { write: true, default: "all" } })], d$1s.prototype, "profileRotation", void 0), d$1s = n$2g = e$2g([n$2P("esri.symbols.PathSymbol3DLayer")], d$1s);
const c$2s = d$1s;
var m$1T;
let l$1Y = m$1T = class extends l$2B {
  constructor() {
    super(...arguments), this.color = new l$2e([0, 0, 0, 1]), this.size = 0;
  }
  clone() {
    const o2 = { color: y$1L(this.color), size: this.size };
    return new m$1T(o2);
  }
};
e$2g([y$1I(p$31)], l$1Y.prototype, "color", void 0), e$2g([y$1I(a$2s)], l$1Y.prototype, "size", void 0), l$1Y = m$1T = e$2g([n$2P("esri.symbols.support.Symbol3DHalo")], l$1Y);
let c$2r = class extends i$2R(l$2B) {
  constructor(o2) {
    super(o2), this.color = null;
  }
};
e$2g([y$1I(p$31)], c$2r.prototype, "color", void 0), c$2r = e$2g([n$2P("esri.symbols.support.Symbol3DTextBackground")], c$2r);
var g$13;
let d$1r = g$13 = class extends a$2t {
  constructor(t2) {
    super(t2), this._userSize = void 0, this.halo = null, this.horizontalAlignment = "center", this.lineHeight = 1, this.material = null, this.background = null, this.text = null, this.type = "text", this.verticalAlignment = "baseline";
  }
  get font() {
    return this._get("font") || null;
  }
  set font(t2) {
    r$1$(t2) && r$1$(this._userSize) && (t2.size = this._userSize), this._set("font", t2);
  }
  writeFont(t2, o2, e2, r2) {
    const i2 = __spreadProps(__spreadValues({}, r2), { textSymbol3D: true });
    o2.font = t2.write({}, i2), delete o2.font.size;
  }
  get size() {
    return r$1$(this._userSize) ? this._userSize : r$1$(this.font) && this.font.size != null ? this.font.size : 9;
  }
  set size(t2) {
    this._userSize = t2, r$1$(this.font) && (this.font.size = this._userSize), this.notifyChange("size");
  }
  clone() {
    const t2 = new g$13({ enabled: this.enabled, font: this.font && y$1L(this.font), halo: this.halo && y$1L(this.halo), horizontalAlignment: this.horizontalAlignment, lineHeight: this.lineHeight, material: r$1$(this.material) ? this.material.clone() : null, text: this.text, verticalAlignment: this.verticalAlignment, background: y$1L(this.background) });
    return t2._userSize = this._userSize, t2;
  }
  static fromTextSymbol(t2) {
    return new g$13({ font: r$1$(t2.font) ? t2.font.clone() : new m$20(), halo: z$B(t2.haloColor, t2.haloSize), horizontalAlignment: t2.horizontalAlignment, lineHeight: t2.lineHeight, material: t2.color ? new l$2a({ color: t2.color.clone() }) : null, text: t2.text, verticalAlignment: t2.verticalAlignment, background: t2.backgroundColor ? new c$2r({ color: t2.backgroundColor.clone() }) : null });
  }
};
function z$B(t2, e2) {
  return t2 && e2 != null && e2 > 0 ? new l$1Y({ color: y$1L(t2), size: e2 }) : null;
}
e$2g([y$1I({ type: m$20, json: { write: true } })], d$1r.prototype, "font", null), e$2g([r$1P("font")], d$1r.prototype, "writeFont", null), e$2g([y$1I({ type: l$1Y, json: { write: true } })], d$1r.prototype, "halo", void 0), e$2g([y$1I(__spreadProps(__spreadValues({}, m$21), { json: { default: "center", write: true } }))], d$1r.prototype, "horizontalAlignment", void 0), e$2g([y$1I(__spreadProps(__spreadValues({}, n$2m), { json: { default: 1, write: true } }))], d$1r.prototype, "lineHeight", void 0), e$2g([y$1I({ type: l$2a, json: { write: true } })], d$1r.prototype, "material", void 0), e$2g([y$1I({ type: c$2r, json: { write: true } })], d$1r.prototype, "background", void 0), e$2g([y$1I(a$2s)], d$1r.prototype, "size", null), e$2g([y$1I({ type: String, json: { write: true } })], d$1r.prototype, "text", void 0), e$2g([r$1H({ Text: "text" }, { readOnly: true })], d$1r.prototype, "type", void 0), e$2g([y$1I(__spreadProps(__spreadValues({}, p$2R), { json: { default: "baseline", write: true } }))], d$1r.prototype, "verticalAlignment", void 0), d$1r = g$13 = e$2g([n$2P("esri.symbols.TextSymbol3DLayer")], d$1r);
const j$L = d$1r;
var l$1X;
let c$2q = l$1X = class extends a$2t {
  constructor(e2) {
    super(e2), this.color = m$1S.clone(), this.type = "water", this.waterbodySize = "medium", this.waveDirection = null, this.waveStrength = "moderate";
  }
  clone() {
    return new l$1X({ color: y$1L(this.color), waterbodySize: this.waterbodySize, waveDirection: this.waveDirection, waveStrength: this.waveStrength });
  }
};
e$2g([y$1I({ type: l$2e, nonNullable: true, json: { type: [T$G], write: (e2, r2, t2) => r2[t2] = e2.toArray(l$2e.AlphaMode.UNLESS_OPAQUE), default: () => m$1S.clone(), defaultEquals: (e2) => e2.toCss(true) === m$1S.toCss(true) } })], c$2q.prototype, "color", void 0), e$2g([r$1H({ Water: "water" }, { readOnly: true })], c$2q.prototype, "type", void 0), e$2g([y$1I({ type: ["small", "medium", "large"], json: { write: true, default: "medium" } })], c$2q.prototype, "waterbodySize", void 0), e$2g([y$1I({ type: Number, json: { write: true, default: null } })], c$2q.prototype, "waveDirection", void 0), e$2g([y$1I({ type: ["calm", "rippled", "slight", "moderate"], json: { write: true, default: "moderate" } })], c$2q.prototype, "waveStrength", void 0), c$2q = l$1X = e$2g([n$2P("esri.symbols.WaterSymbol3DLayer")], c$2q);
const m$1S = new l$2e([0, 119, 190]), n$2f = c$2q;
var p$2H;
let l$1W = p$2H = class extends m$2q {
  constructor(t2) {
    super(t2), this.name = null, this.styleUrl = null, this.styleName = null, this.portal = null;
  }
  clone() {
    return new p$2H({ name: this.name, styleUrl: this.styleUrl, styleName: this.styleName, portal: this.portal });
  }
};
e$2g([y$1I({ type: String })], l$1W.prototype, "name", void 0), e$2g([y$1I({ type: String })], l$1W.prototype, "styleUrl", void 0), e$2g([y$1I({ type: String })], l$1W.prototype, "styleName", void 0), e$2g([y$1I({ type: j$M })], l$1W.prototype, "portal", void 0), l$1W = p$2H = e$2g([n$2P("esri.symbols.support.StyleOrigin")], l$1W);
const a$2g = l$1W;
var t$1G;
let p$2G = t$1G = class extends m$2q {
  constructor() {
    super(...arguments), this.url = "";
  }
  clone() {
    return new t$1G({ url: this.url });
  }
};
e$2g([y$1I({ type: String })], p$2G.prototype, "url", void 0), p$2G = t$1G = e$2g([n$2P("esri.symbols.support.Thumbnail")], p$2G);
const v$Y = { icon: S$K, object: l$1Z, line: h$1p, path: c$2s, fill: f$1y, extrude: d$1F, text: j$L, water: n$2f }, C$w = j$V.ofType({ base: a$2t, key: "type", typeMap: v$Y, errorContext: "symbol-layer" });
let T$x = class extends a$2u {
  constructor(e2) {
    super(e2), this.styleOrigin = null, this.thumbnail = null, this.type = null;
    const t2 = this.__accessor__ && this.__accessor__.metadatas && this.__accessor__.metadatas.symbolLayers, o2 = t2 && t2.type || j$V;
    this._set("symbolLayers", new o2());
  }
  get color() {
    return null;
  }
  set color(e2) {
    this.constructed && s$2z.getLogger(this.declaredClass).error("Symbol3D does not support colors on the symbol level. Colors may be set on individual symbol layer materials instead.");
  }
  set symbolLayers(e2) {
    n$2l(e2, this._get("symbolLayers"));
  }
  readStyleOrigin(e2, r2, t2) {
    if (e2.styleUrl && e2.name) {
      const r3 = c$2x(e2.styleUrl, t2);
      return new a$2g({ styleUrl: r3, name: e2.name });
    }
    if (e2.styleName && e2.name)
      return new a$2g({ portal: t2 && t2.portal || j$M.getDefault(), styleName: e2.styleName, name: e2.name });
    t2 && t2.messages && t2.messages.push(new t$2j("symbol3d:incomplete-style-origin", "Style origin requires either a 'styleUrl' or 'styleName' and a 'name' property", { context: t2, definition: e2 }));
  }
  writeStyleOrigin(e2, r2, t2, o2) {
    if (e2.styleUrl && e2.name) {
      let t3 = m$1_(e2.styleUrl, o2);
      K$g(t3) && (t3 = F$v(t3)), r2.styleOrigin = { styleUrl: t3, name: e2.name };
    } else
      e2.styleName && e2.name && (e2.portal && o2 && o2.portal && !N$q(e2.portal.restUrl, o2.portal.restUrl) ? o2 && o2.messages && o2.messages.push(new t$2j("symbol:cross-portal", "The symbol style origin cannot be persisted because it refers to an item on a different portal than the one being saved to.", { symbol: this })) : r2.styleOrigin = { styleName: e2.styleName, name: e2.name });
  }
  normalizeCtorArgs(e2) {
    return e2 instanceof a$2t || e2 && v$Y[e2.type] ? { symbolLayers: [e2] } : Array.isArray(e2) ? { symbolLayers: e2 } : e2;
  }
};
e$2g([y$1I({ json: { read: false, write: false } })], T$x.prototype, "color", null), e$2g([y$1I({ type: C$w, nonNullable: true, json: { write: true } }), s$2i(t$1J)], T$x.prototype, "symbolLayers", null), e$2g([y$1I({ type: a$2g })], T$x.prototype, "styleOrigin", void 0), e$2g([o$29("styleOrigin")], T$x.prototype, "readStyleOrigin", null), e$2g([r$1P("styleOrigin", { "styleOrigin.styleUrl": { type: String }, "styleOrigin.styleName": { type: String }, "styleOrigin.name": { type: String } })], T$x.prototype, "writeStyleOrigin", null), e$2g([y$1I({ type: p$2G, json: { read: false } })], T$x.prototype, "thumbnail", void 0), e$2g([y$1I({ type: ["point-3d", "line-3d", "polygon-3d", "mesh-3d", "label-3d"], readOnly: true })], T$x.prototype, "type", void 0), T$x = e$2g([n$2P("esri.symbols.Symbol3D")], T$x);
const k$x = T$x;
let t$1F = class extends l$2B {
  constructor(r2) {
    super(r2), this.visible = true;
  }
  clone() {
  }
};
e$2g([y$1I({ type: ["line"], readOnly: true, json: { read: false, write: { ignoreOrigin: true } } })], t$1F.prototype, "type", void 0), e$2g([y$1I({ readOnly: true })], t$1F.prototype, "visible", void 0), t$1F = e$2g([n$2P("esri.symbols.callouts.Callout3D")], t$1F);
const p$2F = t$1F;
var l$1V;
let a$2f = l$1V = class extends l$2B {
  constructor() {
    super(...arguments), this.color = new l$2e("white");
  }
  clone() {
    return new l$1V({ color: y$1L(this.color) });
  }
};
e$2g([y$1I(p$31)], a$2f.prototype, "color", void 0), a$2f = l$1V = e$2g([n$2P("esri.symbols.callouts.LineCallout3DBorder")], a$2f);
const i$2o = a$2f;
Object.freeze(Object.defineProperty({ __proto__: null, default: i$2o }, Symbol.toStringTag, { value: "Module" }));
var u$1E;
let d$1q = u$1E = class extends p$2F {
  constructor(o2) {
    super(o2), this.type = "line", this.color = new l$2e([0, 0, 0, 1]), this.size = e$1D(1), this.border = null;
  }
  get visible() {
    return this.size > 0 && r$1$(this.color) && this.color.a > 0;
  }
  clone() {
    return new u$1E({ color: y$1L(this.color), size: this.size, border: y$1L(this.border) });
  }
};
e$2g([r$1H({ line: "line" }, { readOnly: true })], d$1q.prototype, "type", void 0), e$2g([y$1I(p$31)], d$1q.prototype, "color", void 0), e$2g([y$1I(a$2s)], d$1q.prototype, "size", void 0), e$2g([y$1I({ type: i$2o, json: { write: true } })], d$1q.prototype, "border", void 0), e$2g([y$1I({ readOnly: true })], d$1q.prototype, "visible", null), d$1q = u$1E = e$2g([n$2P("esri.symbols.callouts.LineCallout3D")], d$1q);
const y$1h = d$1q;
function n$2e(e2) {
  if (!e2)
    return false;
  const r2 = e2.verticalOffset;
  return !!r2 && !(r2.screenLength <= 0 || r$1$(r2.maxWorldLength) && r2.maxWorldLength <= 0);
}
function o$1G(t2) {
  if (!t2)
    return false;
  if (!t2.supportsCallout || !t2.supportsCallout())
    return false;
  const e2 = t2.callout;
  return !!e2 && (!!e2.visible && !!n$2e(t2));
}
function i$2n(t2) {
  return t2.type === "point-3d" || t2.type === "label-3d";
}
function l$1U(t2) {
  return t2.horizontalAlignment === "center";
}
const u$1D = { types: { key: "type", base: p$2F, typeMap: { line: y$1h } }, json: { write: true } };
var n$2d;
let p$2E = n$2d = class extends l$2B {
  constructor(r2) {
    super(r2), this.screenLength = 0, this.minWorldLength = 0, this.maxWorldLength = null;
  }
  clone() {
    return new n$2d({ screenLength: this.screenLength, minWorldLength: this.minWorldLength, maxWorldLength: this.maxWorldLength });
  }
};
e$2g([y$1I(a$2s)], p$2E.prototype, "screenLength", void 0), e$2g([y$1I({ type: Number, nonNullable: true, json: { write: true, default: 0 } })], p$2E.prototype, "minWorldLength", void 0), e$2g([y$1I({ type: Number, json: { write: true } })], p$2E.prototype, "maxWorldLength", void 0), p$2E = n$2d = e$2g([n$2P("esri.symbols.support.Symbol3DVerticalOffset")], p$2E);
const i$2m = p$2E;
var n$2c;
const u$1C = j$V.ofType({ base: null, key: "type", typeMap: { text: j$L } });
let f$1s = n$2c = class extends k$x {
  constructor(t2) {
    super(t2), this.verticalOffset = null, this.callout = null, this.styleOrigin = null, this.symbolLayers = new u$1C(), this.type = "label-3d";
  }
  supportsCallout() {
    return true;
  }
  hasVisibleCallout() {
    return o$1G(this);
  }
  hasVisibleVerticalOffset() {
    return n$2e(this);
  }
  clone() {
    return new n$2c({ styleOrigin: y$1L(this.styleOrigin), symbolLayers: y$1L(this.symbolLayers), thumbnail: y$1L(this.thumbnail), callout: y$1L(this.callout), verticalOffset: y$1L(this.verticalOffset) });
  }
  static fromTextSymbol(t2) {
    return new n$2c({ symbolLayers: [j$L.fromTextSymbol(t2)] });
  }
};
e$2g([y$1I({ type: i$2m, json: { write: true } })], f$1s.prototype, "verticalOffset", void 0), e$2g([y$1I(u$1D)], f$1s.prototype, "callout", void 0), e$2g([y$1I({ json: { read: false, write: false } })], f$1s.prototype, "styleOrigin", void 0), e$2g([y$1I({ type: u$1C })], f$1s.prototype, "symbolLayers", void 0), e$2g([r$1H({ LabelSymbol3D: "label-3d" }, { readOnly: true })], f$1s.prototype, "type", void 0), f$1s = n$2c = e$2g([n$2P("esri.symbols.LabelSymbol3D")], f$1s);
const b$Y = f$1s;
var l$1T;
const a$2e = j$V.ofType({ base: null, key: "type", typeMap: { line: h$1p, path: c$2s } }), n$2b = j$V.ofType({ base: null, key: "type", typeMap: { line: h$1p, path: c$2s } });
let c$2p = l$1T = class extends k$x {
  constructor(o2) {
    super(o2), this.symbolLayers = new a$2e(), this.type = "line-3d";
  }
  clone() {
    return new l$1T({ styleOrigin: y$1L(this.styleOrigin), symbolLayers: y$1L(this.symbolLayers), thumbnail: y$1L(this.thumbnail) });
  }
  static fromSimpleLineSymbol(o2) {
    return new l$1T({ symbolLayers: [h$1p.fromSimpleLineSymbol(o2)] });
  }
};
e$2g([y$1I({ type: a$2e, json: { type: n$2b } })], c$2p.prototype, "symbolLayers", void 0), e$2g([r$1H({ LineSymbol3D: "line-3d" }, { readOnly: true })], c$2p.prototype, "type", void 0), c$2p = l$1T = e$2g([n$2P("esri.symbols.LineSymbol3D")], c$2p);
const b$X = c$2p;
let p$2D = class extends a$2u {
  constructor(t2) {
    super(t2), this.angle = 0, this.type = null, this.xoffset = 0, this.yoffset = 0, this.size = 9;
  }
  hash() {
    return `${this.type}.${this.angle}.${this.size}.${this.xoffset}.${this.yoffset}`;
  }
};
e$2g([y$1I({ type: Number, json: { read: (t2) => t2 && -1 * t2, write: (t2, e2) => e2.angle = t2 && -1 * t2 } })], p$2D.prototype, "angle", void 0), e$2g([y$1I({ type: ["simple-marker", "picture-marker"], readOnly: true })], p$2D.prototype, "type", void 0), e$2g([y$1I({ type: Number, cast: o$1N, json: { write: true } })], p$2D.prototype, "xoffset", void 0), e$2g([y$1I({ type: Number, cast: o$1N, json: { write: true } })], p$2D.prototype, "yoffset", void 0), e$2g([y$1I({ type: Number, cast: (t2) => t2 === "auto" ? t2 : o$1N(t2), json: { write: true } })], p$2D.prototype, "size", void 0), p$2D = e$2g([n$2P("esri.symbols.MarkerSymbol")], p$2D);
const i$2l = p$2D;
var i$2k;
const y$1g = j$V.ofType({ base: null, key: "type", typeMap: { fill: f$1y } });
let a$2d = i$2k = class extends k$x {
  constructor(o2) {
    super(o2), this.symbolLayers = new y$1g(), this.type = "mesh-3d";
  }
  clone() {
    return new i$2k({ styleOrigin: y$1L(this.styleOrigin), symbolLayers: y$1L(this.symbolLayers), thumbnail: y$1L(this.thumbnail) });
  }
  static fromSimpleFillSymbol(o2) {
    return new i$2k({ symbolLayers: [f$1y.fromSimpleFillSymbol(o2)] });
  }
};
e$2g([y$1I({ type: y$1g })], a$2d.prototype, "symbolLayers", void 0), e$2g([r$1H({ MeshSymbol3D: "mesh-3d" }, { readOnly: true })], a$2d.prototype, "type", void 0), a$2d = i$2k = e$2g([n$2P("esri.symbols.MeshSymbol3D")], a$2d);
const c$2o = a$2d;
function o$1F(a2, r2, t2) {
  return r2.imageData ? et$2({ mediaType: r2.contentType || "image/png", isBase64: true, data: r2.imageData }) : s$1O(r2.url, t2);
}
function s$1O(e2, t2) {
  var _a2;
  return p$2C(t2) && !K$g(e2) && ((_a2 = t2 == null ? void 0 : t2.layer) == null ? void 0 : _a2.parsedUrl) ? G$q(t2.layer.parsedUrl.path, "images", e2) : c$2x(e2, t2);
}
function u$1B(e2, a2, r2, n2) {
  if (X$e(e2)) {
    const t2 = nt$4(e2);
    if (!t2)
      return;
    a2.contentType = t2.mediaType, a2.imageData = t2.data, r2 && r2.imageData === a2.imageData && r2.url && f$1w(r2.url, a2, "url", n2);
  } else
    f$1w(e2, a2, "url", n2);
}
const m$1R = { json: { read: { source: ["imageData", "url"], reader: o$1F }, write: { writer(e2, a2, r2, t2) {
  u$1B(e2, a2, this.source, t2);
} } } }, c$2n = { readOnly: true, json: { read: { source: ["imageData", "url"], reader(e2, a2, r2) {
  const t2 = {};
  return a2.imageData && (t2.imageData = a2.imageData), a2.contentType && (t2.contentType = a2.contentType), a2.url && (t2.url = s$1O(a2.url, r2)), t2;
} } } };
function p$2C(e2) {
  var _a2, _b2;
  return !(e2 == null || e2.origin !== "service" && e2.origin !== "portal-item" || ((_a2 = e2.layer) == null ? void 0 : _a2.type) !== "feature" && ((_b2 = e2.layer) == null ? void 0 : _b2.type) !== "stream");
}
var c$2m;
let u$1A = c$2m = class extends p$2Y {
  constructor(...t2) {
    super(...t2), this.type = "picture-fill", this.url = null, this.xscale = 1, this.yscale = 1, this.width = 12, this.height = 12, this.xoffset = 0, this.yoffset = 0, this.source = null;
  }
  normalizeCtorArgs(t2, s2, e2, r2) {
    if (t2 && typeof t2 != "string" && t2.imageData == null)
      return t2;
    const i2 = {};
    return t2 && (i2.url = t2), s2 && (i2.outline = s2), e2 != null && (i2.width = o$1N(e2)), r2 != null && (i2.height = o$1N(r2)), i2;
  }
  clone() {
    const t2 = new c$2m({ color: y$1L(this.color), height: this.height, outline: this.outline && this.outline.clone(), url: this.url, width: this.width, xoffset: this.xoffset, xscale: this.xscale, yoffset: this.yoffset, yscale: this.yscale });
    return t2._set("source", y$1L(this.source)), t2;
  }
  hash() {
    var _a2;
    return `${super.hash()}.${(_a2 = this.color) == null ? void 0 : _a2.hash()}.${this.height}.${this.url}.${this.width}.${this.xoffset}.${this.xscale}.${this.yoffset}.${this.yscale}`;
  }
};
e$2g([r$1H({ esriPFS: "picture-fill" }, { readOnly: true })], u$1A.prototype, "type", void 0), e$2g([y$1I(m$1R)], u$1A.prototype, "url", void 0), e$2g([y$1I({ type: Number, json: { write: true } })], u$1A.prototype, "xscale", void 0), e$2g([y$1I({ type: Number, json: { write: true } })], u$1A.prototype, "yscale", void 0), e$2g([y$1I({ type: Number, cast: o$1N, json: { write: true } })], u$1A.prototype, "width", void 0), e$2g([y$1I({ type: Number, cast: o$1N, json: { write: true } })], u$1A.prototype, "height", void 0), e$2g([y$1I({ type: Number, cast: o$1N, json: { write: true } })], u$1A.prototype, "xoffset", void 0), e$2g([y$1I({ type: Number, cast: o$1N, json: { write: true } })], u$1A.prototype, "yoffset", void 0), e$2g([y$1I(c$2n)], u$1A.prototype, "source", void 0), u$1A = c$2m = e$2g([n$2P("esri.symbols.PictureFillSymbol")], u$1A);
const a$2c = u$1A;
var l$1S;
let a$2b = l$1S = class extends i$2l {
  constructor(...r2) {
    super(...r2), this.color = null, this.type = "picture-marker", this.url = null, this.source = null, this.height = 12, this.width = 12, this.size = null;
  }
  normalizeCtorArgs(r2, t2, o2) {
    if (r2 && typeof r2 != "string" && r2.imageData == null)
      return r2;
    const s2 = {};
    return r2 && (s2.url = r2), t2 != null && (s2.width = o$1N(t2)), o2 != null && (s2.height = o$1N(o2)), s2;
  }
  readHeight(r2, t2) {
    return t2.size || r2;
  }
  readWidth(r2, t2) {
    return t2.size || r2;
  }
  clone() {
    const r2 = new l$1S({ angle: this.angle, height: this.height, url: this.url, width: this.width, xoffset: this.xoffset, yoffset: this.yoffset });
    return r2._set("source", y$1L(this.source)), r2;
  }
  hash() {
    return `${super.hash()}.${this.height}.${this.url}.${this.width}`;
  }
};
e$2g([y$1I({ json: { write: false } })], a$2b.prototype, "color", void 0), e$2g([r$1H({ esriPMS: "picture-marker" }, { readOnly: true })], a$2b.prototype, "type", void 0), e$2g([y$1I(m$1R)], a$2b.prototype, "url", void 0), e$2g([y$1I(c$2n)], a$2b.prototype, "source", void 0), e$2g([y$1I({ type: Number, cast: o$1N, json: { write: true } })], a$2b.prototype, "height", void 0), e$2g([o$29("height", ["height", "size"])], a$2b.prototype, "readHeight", null), e$2g([y$1I({ type: Number, cast: o$1N, json: { write: true } })], a$2b.prototype, "width", void 0), e$2g([y$1I({ json: { write: false } })], a$2b.prototype, "size", void 0), a$2b = l$1S = e$2g([n$2P("esri.symbols.PictureMarkerSymbol")], a$2b);
const n$2a = a$2b;
var b$W;
const f$1r = j$V.ofType({ base: null, key: "type", typeMap: { icon: S$K, object: l$1Z, text: j$L } });
let S$J = b$W = class extends k$x {
  constructor(t2) {
    super(t2), this.verticalOffset = null, this.callout = null, this.symbolLayers = new f$1r(), this.type = "point-3d";
  }
  supportsCallout() {
    if ((this.symbolLayers ? this.symbolLayers.length : 0) < 1)
      return false;
    for (const t2 of this.symbolLayers.items)
      switch (t2.type) {
        case "icon":
        case "text":
        case "object":
          continue;
        default:
          return false;
      }
    return true;
  }
  hasVisibleCallout() {
    return o$1G(this);
  }
  hasVisibleVerticalOffset() {
    return n$2e(this);
  }
  clone() {
    return new b$W({ verticalOffset: y$1L(this.verticalOffset), callout: y$1L(this.callout), styleOrigin: y$1L(this.styleOrigin), symbolLayers: y$1L(this.symbolLayers), thumbnail: y$1L(this.thumbnail) });
  }
  static fromSimpleMarkerSymbol(t2) {
    return new b$W({ symbolLayers: [S$K.fromSimpleMarkerSymbol(t2)] });
  }
  static fromPictureMarkerSymbol(t2) {
    return new b$W({ symbolLayers: [S$K.fromPictureMarkerSymbol(t2)] });
  }
  static fromCIMSymbol(t2) {
    var _a2, _b2;
    const o2 = (_b2 = (_a2 = t2.data) == null ? void 0 : _a2.symbol) == null ? void 0 : _b2.type;
    if (o2 !== "CIMPointSymbol")
      return null;
    const r2 = t2.data.symbol;
    return new b$W((r2 == null ? void 0 : r2.callout) ? { symbolLayers: [S$K.fromCIMSymbol(t2)], callout: { type: "line", size: 0.5, color: [0, 0, 0] }, verticalOffset: { screenLength: 40 } } : { symbolLayers: [S$K.fromCIMSymbol(t2)] });
  }
  static fromTextSymbol(t2) {
    return new b$W({ symbolLayers: [j$L.fromTextSymbol(t2)] });
  }
};
e$2g([y$1I({ type: i$2m, json: { write: true } })], S$J.prototype, "verticalOffset", void 0), e$2g([y$1I(u$1D)], S$J.prototype, "callout", void 0), e$2g([y$1I({ type: f$1r, json: { origins: { "web-scene": { write: true } } } })], S$J.prototype, "symbolLayers", void 0), e$2g([r$1H({ PointSymbol3D: "point-3d" }, { readOnly: true })], S$J.prototype, "type", void 0), S$J = b$W = e$2g([n$2P("esri.symbols.PointSymbol3D")], S$J);
const h$1o = S$J;
var L$q;
const u$1z = j$V.ofType({ base: null, key: "type", typeMap: { extrude: d$1F, fill: f$1y, icon: S$K, line: h$1p, object: l$1Z, text: j$L, water: n$2f } });
let j$K = L$q = class extends k$x {
  constructor(o2) {
    super(o2), this.symbolLayers = new u$1z(), this.type = "polygon-3d";
  }
  clone() {
    return new L$q({ styleOrigin: y$1L(this.styleOrigin), symbolLayers: y$1L(this.symbolLayers), thumbnail: y$1L(this.thumbnail) });
  }
  static fromJSON(o2) {
    const e2 = new L$q();
    if (e2.read(o2), e2.symbolLayers.length === 2 && e2.symbolLayers.getItemAt(0).type === "fill" && e2.symbolLayers.getItemAt(1).type === "line") {
      const r2 = e2.symbolLayers.getItemAt(0), s2 = e2.symbolLayers.getItemAt(1);
      !s2.enabled || o2.symbolLayers && o2.symbolLayers[1] && o2.symbolLayers[1].enable === false || (r2.outline = { size: s2.size, color: r$1$(s2.material) ? s2.material.color : null }), e2.symbolLayers.removeAt(1);
    }
    return e2;
  }
  static fromSimpleFillSymbol(o2) {
    return new L$q({ symbolLayers: [f$1y.fromSimpleFillSymbol(o2)] });
  }
};
e$2g([y$1I({ type: u$1z, json: { write: true } })], j$K.prototype, "symbolLayers", void 0), e$2g([r$1H({ PolygonSymbol3D: "polygon-3d" }, { readOnly: true })], j$K.prototype, "type", void 0), j$K = L$q = e$2g([n$2P("esri.symbols.PolygonSymbol3D")], j$K);
const S$I = j$K;
var p$2B;
const c$2l = new s$2a({ esriSFSSolid: "solid", esriSFSNull: "none", esriSFSHorizontal: "horizontal", esriSFSVertical: "vertical", esriSFSForwardDiagonal: "forward-diagonal", esriSFSBackwardDiagonal: "backward-diagonal", esriSFSCross: "cross", esriSFSDiagonalCross: "diagonal-cross" });
let m$1Q = p$2B = class extends p$2Y {
  constructor(...o2) {
    super(...o2), this.color = new l$2e([0, 0, 0, 0.25]), this.outline = new m$25(), this.type = "simple-fill", this.style = "solid";
  }
  normalizeCtorArgs(o2, r2, s2) {
    if (o2 && typeof o2 != "string")
      return o2;
    const e2 = {};
    return o2 && (e2.style = o2), r2 && (e2.outline = r2), s2 && (e2.color = s2), e2;
  }
  clone() {
    return new p$2B({ color: y$1L(this.color), outline: this.outline && this.outline.clone(), style: this.style });
  }
  hash() {
    return `${super.hash()}${this.style}.${this.color && this.color.hash()}`;
  }
};
e$2g([y$1I()], m$1Q.prototype, "color", void 0), e$2g([y$1I()], m$1Q.prototype, "outline", void 0), e$2g([r$1H({ esriSFS: "simple-fill" }, { readOnly: true })], m$1Q.prototype, "type", void 0), e$2g([y$1I({ type: c$2l.apiValues, json: { read: c$2l.read, write: c$2l.write } })], m$1Q.prototype, "style", void 0), m$1Q = p$2B = e$2g([n$2P("esri.symbols.SimpleFillSymbol")], m$1Q);
const S$H = m$1Q;
var h$1n;
const m$1P = new s$2a({ esriSMSCircle: "circle", esriSMSSquare: "square", esriSMSCross: "cross", esriSMSX: "x", esriSMSDiamond: "diamond", esriSMSTriangle: "triangle", esriSMSPath: "path" });
let u$1y = h$1n = class extends i$2l {
  constructor(...e2) {
    super(...e2), this.color = new l$2e([255, 255, 255, 0.25]), this.type = "simple-marker", this.size = 12, this.style = "circle", this.outline = new m$25();
  }
  normalizeCtorArgs(e2, o2, r2, t2) {
    if (e2 && typeof e2 != "string")
      return e2;
    const i2 = {};
    return e2 && (i2.style = e2), o2 != null && (i2.size = o$1N(o2)), r2 && (i2.outline = r2), t2 && (i2.color = t2), i2;
  }
  writeColor(e2, o2) {
    e2 && this.style !== "x" && this.style !== "cross" && (o2.color = e2.toJSON()), e2 === null && (o2.color = null);
  }
  set path(e2) {
    this.style = "path", this._set("path", e2);
  }
  clone() {
    return new h$1n({ angle: this.angle, color: y$1L(this.color), outline: this.outline && this.outline.clone(), path: this.path, size: this.size, style: this.style, xoffset: this.xoffset, yoffset: this.yoffset });
  }
  hash() {
    var _a2;
    return `${super.hash()}.${this.color && this.color.hash()}.${this.path}.${this.style}.${(_a2 = this.outline) == null ? void 0 : _a2.hash()}`;
  }
};
e$2g([y$1I()], u$1y.prototype, "color", void 0), e$2g([r$1P("color")], u$1y.prototype, "writeColor", null), e$2g([r$1H({ esriSMS: "simple-marker" }, { readOnly: true })], u$1y.prototype, "type", void 0), e$2g([y$1I()], u$1y.prototype, "size", void 0), e$2g([y$1I({ type: m$1P.apiValues, json: { read: m$1P.read, write: m$1P.write } })], u$1y.prototype, "style", void 0), e$2g([y$1I({ type: String, json: { write: true } })], u$1y.prototype, "path", null), e$2g([y$1I({ types: { key: "type", base: null, defaultKeyValue: "simple-line", typeMap: { "simple-line": m$25 } }, json: { default: null, write: true } })], u$1y.prototype, "outline", void 0), u$1y = h$1n = e$2g([n$2P("esri.symbols.SimpleMarkerSymbol")], u$1y);
const y$1f = u$1y;
var f$1q;
let g$12 = f$1q = class extends a$2u {
  constructor(...t2) {
    super(...t2), this.backgroundColor = null, this.borderLineColor = null, this.borderLineSize = null, this.font = new m$20(), this.horizontalAlignment = "center", this.kerning = true, this.haloColor = null, this.haloSize = null, this.rightToLeft = null, this.rotated = false, this.text = "", this.type = "text", this.verticalAlignment = "baseline", this.xoffset = 0, this.yoffset = 0, this.angle = 0, this.width = null, this.lineWidth = 192, this.lineHeight = 1;
  }
  normalizeCtorArgs(t2, o2, e2) {
    if (t2 && typeof t2 != "string")
      return t2;
    const i2 = {};
    return t2 && (i2.text = t2), o2 && (i2.font = o2), e2 && (i2.color = e2), i2;
  }
  writeLineWidth(t2, o2, e2, i2) {
    i2 && typeof i2 != "string" ? i2.origin : o2[e2] = t2;
  }
  castLineWidth(t2) {
    return o$1N(t2);
  }
  writeLineHeight(t2, o2, e2, i2) {
    i2 && typeof i2 != "string" ? i2.origin : o2[e2] = t2;
  }
  clone() {
    return new f$1q({ angle: this.angle, backgroundColor: y$1L(this.backgroundColor), borderLineColor: y$1L(this.borderLineColor), borderLineSize: this.borderLineSize, color: y$1L(this.color), font: this.font && this.font.clone(), haloColor: y$1L(this.haloColor), haloSize: this.haloSize, horizontalAlignment: this.horizontalAlignment, kerning: this.kerning, lineHeight: this.lineHeight, lineWidth: this.lineWidth, rightToLeft: this.rightToLeft, rotated: this.rotated, text: this.text, verticalAlignment: this.verticalAlignment, width: this.width, xoffset: this.xoffset, yoffset: this.yoffset });
  }
  hash() {
    var _a2;
    return `${this.backgroundColor && this.backgroundColor.hash()}.${this.borderLineColor}.${this.borderLineSize}.${(_a2 = this.color) == null ? void 0 : _a2.hash()}.${this.font && this.font.hash()}.${this.haloColor && this.haloColor.hash()}.${this.haloSize}.${this.horizontalAlignment}.${this.kerning}.${this.rightToLeft}.${this.rotated}.${this.text}.${this.verticalAlignment}.${this.width}.${this.xoffset}.${this.yoffset}.${this.lineHeight}.${this.lineWidth}.${this.angle}`;
  }
};
e$2g([y$1I({ type: l$2e, json: { write: true } })], g$12.prototype, "backgroundColor", void 0), e$2g([y$1I({ type: l$2e, json: { write: true } })], g$12.prototype, "borderLineColor", void 0), e$2g([y$1I({ type: Number, json: { write: true } })], g$12.prototype, "borderLineSize", void 0), e$2g([y$1I({ type: m$20, json: { write: true } })], g$12.prototype, "font", void 0), e$2g([y$1I(__spreadProps(__spreadValues({}, m$21), { json: { write: true } }))], g$12.prototype, "horizontalAlignment", void 0), e$2g([y$1I({ type: Boolean, json: { write: true } })], g$12.prototype, "kerning", void 0), e$2g([y$1I({ type: l$2e, json: { write: true } })], g$12.prototype, "haloColor", void 0), e$2g([y$1I({ type: Number, cast: o$1N, json: { write: true } })], g$12.prototype, "haloSize", void 0), e$2g([y$1I({ type: Boolean, json: { write: true } })], g$12.prototype, "rightToLeft", void 0), e$2g([y$1I({ type: Boolean, json: { write: true } })], g$12.prototype, "rotated", void 0), e$2g([y$1I({ type: String, json: { write: true } })], g$12.prototype, "text", void 0), e$2g([r$1H({ esriTS: "text" }, { readOnly: true })], g$12.prototype, "type", void 0), e$2g([y$1I(__spreadProps(__spreadValues({}, p$2R), { json: { write: true } }))], g$12.prototype, "verticalAlignment", void 0), e$2g([y$1I({ type: Number, cast: o$1N, json: { write: true } })], g$12.prototype, "xoffset", void 0), e$2g([y$1I({ type: Number, cast: o$1N, json: { write: true } })], g$12.prototype, "yoffset", void 0), e$2g([y$1I({ type: Number, json: { read: (t2) => t2 && -1 * t2, write: (t2, o2) => o2.angle = t2 && -1 * t2 } })], g$12.prototype, "angle", void 0), e$2g([y$1I({ type: Number, json: { write: true } })], g$12.prototype, "width", void 0), e$2g([y$1I({ type: Number })], g$12.prototype, "lineWidth", void 0), e$2g([r$1P("lineWidth")], g$12.prototype, "writeLineWidth", null), e$2g([s$2i("lineWidth")], g$12.prototype, "castLineWidth", null), e$2g([y$1I(n$2m)], g$12.prototype, "lineHeight", void 0), e$2g([r$1P("lineHeight")], g$12.prototype, "writeLineHeight", null), g$12 = f$1q = e$2g([n$2P("esri.symbols.TextSymbol")], g$12);
const m$1O = g$12;
var y$1e;
let h$1m = y$1e = class extends a$2u {
  constructor(t2) {
    super(t2), this.styleName = null, this.portal = null, this.styleUrl = null, this.thumbnail = null, this.name = null, this.type = "web-style";
  }
  get _fetchCacheKey() {
    const t2 = r$1$(this.portal) ? this.portal : j$M.getDefault(), e2 = t2.user ? t2.user.username : null;
    return `${this.styleName}:${this.styleUrl}:${this.name}:${e2}:${t2.url}`;
  }
  read(t2, e2) {
    this.portal = e2 ? e2.portal : void 0, super.read(t2, e2);
  }
  clone() {
    return new y$1e({ name: this.name, styleUrl: this.styleUrl, styleName: this.styleName, portal: this.portal });
  }
  fetchSymbol(t2) {
    return this._fetchSymbol("webRef", t2);
  }
  fetchCIMSymbol(t2) {
    return this._fetchSymbol("cimRef", t2);
  }
  async _fetchSymbol(t2, s2) {
    const l2 = r$1$(s2) ? s2.cache : null, i2 = l2 ? this._fetchCacheKey : null;
    if (r$1$(l2)) {
      const t3 = i2 && l2.get(i2);
      if (t3)
        return t3.clone();
    }
    const p2 = await u$1x();
    f$1V(s2);
    const a2 = p2.resolveWebStyleSymbol(this, { portal: this.portal }, t2, s2);
    a2.catch((t3) => {
      s$2z.getLogger(this.declaredClass).error("#fetchSymbol()", "Failed to create symbol from style", t3);
    });
    const c2 = await a2;
    return t2 === "webRef" && c2.type === "point-3d" || t2 === "cimRef" && c2.type === "cim" ? (r$1$(l2) && l2.set(i2, c2.clone()), c2) : null;
  }
};
function u$1x() {
  return import("./webStyleSymbolUtils.js");
}
e$2g([y$1I({ json: { write: false } })], h$1m.prototype, "color", void 0), e$2g([y$1I({ type: String, json: { write: true } })], h$1m.prototype, "styleName", void 0), e$2g([y$1I({ type: j$M, json: { write: false } })], h$1m.prototype, "portal", void 0), e$2g([y$1I({ type: String, json: { read: p$2P, write: f$1w } })], h$1m.prototype, "styleUrl", void 0), e$2g([y$1I({ type: p$2G, json: { read: false } })], h$1m.prototype, "thumbnail", void 0), e$2g([y$1I({ type: String, json: { write: true } })], h$1m.prototype, "name", void 0), e$2g([r$1H({ styleSymbolReference: "web-style" }, { readOnly: true })], h$1m.prototype, "type", void 0), e$2g([y$1I()], h$1m.prototype, "_fetchCacheKey", null), h$1m = y$1e = e$2g([n$2P("esri.symbols.WebStyleSymbol")], h$1m);
const f$1p = h$1m;
function x$N(e2) {
  if (!e2)
    return false;
  switch (e2.type) {
    case "picture-fill":
    case "picture-marker":
    case "simple-fill":
    case "simple-line":
    case "simple-marker":
    case "text":
    case "cim":
      return true;
    default:
      return false;
  }
}
function c$2k(e2) {
  if (!e2)
    return false;
  switch (e2.type) {
    case "label-3d":
    case "line-3d":
    case "mesh-3d":
    case "point-3d":
    case "polygon-3d":
      return true;
    default:
      return false;
  }
}
const j$J = { base: a$2u, key: "type", typeMap: { "simple-fill": S$H, "picture-fill": a$2c, "picture-marker": n$2a, "simple-line": m$25, "simple-marker": y$1f, text: m$1O, "label-3d": b$Y, "line-3d": b$X, "mesh-3d": c$2o, "point-3d": h$1o, "polygon-3d": S$I, "web-style": f$1p, cim: d$1H }, errorContext: "symbol" }, D$p = { base: a$2u, key: "type", typeMap: { "picture-marker": n$2a, "simple-marker": y$1f, text: m$1O, "web-style": f$1p, cim: d$1H }, errorContext: "symbol" }, k$w = s$2r({ types: j$J }), M$z = { base: a$2u, key: "type", typeMap: { "simple-fill": S$H, "picture-fill": a$2c, "picture-marker": n$2a, "simple-line": m$25, "simple-marker": y$1f, text: m$1O, "line-3d": b$X, "mesh-3d": c$2o, "point-3d": h$1o, "polygon-3d": S$I, "web-style": f$1p, cim: d$1H }, errorContext: "symbol" }, P$v = { base: a$2u, key: "type", typeMap: { text: m$1O, "label-3d": b$Y }, errorContext: "symbol" }, h$1l = { base: a$2u, key: "type", typeMap: { "line-3d": b$X, "mesh-3d": c$2o, "point-3d": h$1o, "polygon-3d": S$I, "web-style": f$1p, cim: d$1H }, errorContext: "symbol" }, F$t = { base: a$2u, key: "type", typeMap: { "label-3d": b$Y }, errorContext: "symbol" }, g$11 = S$V(j$J);
function y$1d(t2) {
  if (!t2)
    return null;
  const e2 = {};
  for (const r2 in t2) {
    const o2 = v$14(t2[r2]);
    o2 && (e2[r2] = o2);
  }
  return Object.keys(e2).length !== 0 ? e2 : null;
}
function m$1N(t2) {
  if (!r$1$(t2))
    return null;
  const e2 = {};
  for (const r2 in t2) {
    const o2 = t2[r2];
    o2 && (e2[r2] = o2.toJSON());
  }
  return Object.keys(e2).length !== 0 ? e2 : null;
}
let h$1k = class extends i$2R(l$2B) {
  constructor(...t2) {
    super(...t2), this.isAggregate = false, this.layer = null, this.popupTemplate = null, this.sourceLayer = null, Object.defineProperty(this, "uid", { value: e$1_(), configurable: true });
  }
  normalizeCtorArgs(t2, e2, r2, o2) {
    return t2 && !t2.declaredClass ? t2 : { geometry: t2, symbol: e2, attributes: r2, popupTemplate: o2 };
  }
  set aggregateGeometries(t2) {
    const e2 = this._get("aggregateGeometries");
    JSON.stringify(e2) !== JSON.stringify(t2) && this._set("aggregateGeometries", t2);
  }
  set attributes(t2) {
    const e2 = this._get("attributes");
    e2 !== t2 && (this._set("attributes", t2), this._notifyLayer("attributes", e2, t2));
  }
  set geometry(t2) {
    const e2 = this._get("geometry");
    e2 !== t2 && (this._set("geometry", t2), this._notifyLayer("geometry", e2, t2));
  }
  set symbol(t2) {
    const e2 = this._get("symbol");
    e2 !== t2 && (this._set("symbol", t2), this._notifyLayer("symbol", e2, t2));
  }
  set visible(t2) {
    const e2 = this._get("visible");
    e2 !== t2 && (this._set("visible", t2), this._notifyLayer("visible", e2, t2));
  }
  getEffectivePopupTemplate(t2 = false) {
    if (this.popupTemplate)
      return this.popupTemplate;
    for (const e2 of [this.sourceLayer, this.layer])
      if (e2) {
        if ("popupTemplate" in e2 && e2.popupTemplate)
          return e2.popupTemplate;
        if (t2 && "defaultPopupTemplate" in e2 && r$1$(e2.defaultPopupTemplate))
          return e2.defaultPopupTemplate;
      }
    return null;
  }
  getAttribute(t2) {
    var _a2;
    return (_a2 = this.attributes) == null ? void 0 : _a2[t2];
  }
  setAttribute(t2, e2) {
    if (this.attributes) {
      const r2 = this.getAttribute(t2);
      this.attributes[t2] = e2, this._notifyLayer("attributes", r2, e2, t2);
    } else
      this.attributes = { [t2]: e2 }, this._notifyLayer("attributes", void 0, e2, t2);
  }
  getObjectId() {
    return this.sourceLayer && "objectIdField" in this.sourceLayer && this.sourceLayer.objectIdField ? this.getAttribute(this.sourceLayer.objectIdField) : null;
  }
  toJSON() {
    return { aggregateGeometries: m$1N(this.aggregateGeometries), geometry: r$1$(this.geometry) ? this.geometry.toJSON() : null, symbol: r$1$(this.symbol) ? this.symbol.toJSON() : null, attributes: __spreadValues({}, this.attributes), popupTemplate: this.popupTemplate && this.popupTemplate.toJSON() };
  }
  notifyGeometryChanged() {
    this._notifyLayer("geometry", this.geometry, this.geometry);
  }
  notifyMeshTransformChanged() {
    r$1$(this.geometry) && this.geometry.type === "mesh" && this._notifyLayer("transform", this.geometry.transform, this.geometry.transform);
  }
  _notifyLayer(t2, e2, r2, o2) {
    if (!this.layer || !("graphicChanged" in this.layer))
      return;
    const s2 = { graphic: this, property: t2, oldValue: e2, newValue: r2 };
    t2 === "attributes" && (s2.attributeName = o2), this.layer.graphicChanged(s2);
  }
};
e$2g([y$1I({ value: null, json: { read: y$1d } })], h$1k.prototype, "aggregateGeometries", null), e$2g([y$1I({ value: null })], h$1k.prototype, "attributes", null), e$2g([y$1I({ value: null, types: i$2S, json: { read: v$14 } })], h$1k.prototype, "geometry", null), e$2g([y$1I({ type: Boolean })], h$1k.prototype, "isAggregate", void 0), e$2g([y$1I({ clonable: "reference" })], h$1k.prototype, "layer", void 0), e$2g([y$1I({ type: k$B })], h$1k.prototype, "popupTemplate", void 0), e$2g([y$1I({ clonable: "reference" })], h$1k.prototype, "sourceLayer", void 0), e$2g([y$1I({ value: null, types: j$J })], h$1k.prototype, "symbol", null), e$2g([y$1I({ type: Boolean, value: true })], h$1k.prototype, "visible", null), h$1k = e$2g([n$2P("esri.Graphic")], h$1k), function(t2) {
  t2.generateUID = e$1_;
}(h$1k || (h$1k = {}));
const g$10 = h$1k;
class i$2j {
  constructor(n2, i2) {
    this.min = n2, this.max = i2, this.range = i2 - n2;
  }
  ndiff(n2, i2 = 0) {
    return Math.ceil((n2 - i2) / this.range) * this.range + i2;
  }
  _normalize(n2, i2, t2, o2 = 0, r2 = false) {
    return (t2 -= o2) < n2 ? t2 += this.ndiff(n2 - t2) : t2 > i2 && (t2 -= this.ndiff(t2 - i2)), r2 && t2 === i2 && (t2 = n2), t2 + o2;
  }
  normalize(n2, i2 = 0, t2 = false) {
    return this._normalize(this.min, this.max, n2, i2, t2);
  }
  clamp(i2, t2 = 0) {
    return a$2v(i2 - t2, this.min, this.max) + t2;
  }
  monotonic(n2, i2, t2) {
    return n2 < i2 ? i2 : i2 + this.ndiff(n2 - i2, t2);
  }
  minimalMonotonic(n2, i2, t2) {
    return this._normalize(n2, n2 + this.range, i2, t2);
  }
  center(n2, i2, t2) {
    return i2 = this.monotonic(n2, i2, t2), this.normalize((n2 + i2) / 2, t2);
  }
  diff(n2, i2, t2) {
    return this.monotonic(n2, i2, t2) - n2;
  }
  shortestSignedDiff(n2, i2) {
    n2 = this.normalize(n2);
    const t2 = (i2 = this.normalize(i2)) - n2, o2 = i2 < n2 ? this.minimalMonotonic(n2, i2) - n2 : i2 - this.minimalMonotonic(i2, n2);
    return Math.abs(t2) < Math.abs(o2) ? t2 : o2;
  }
  contains(n2, i2, t2) {
    return i2 = this.minimalMonotonic(n2, i2), (t2 = this.minimalMonotonic(n2, t2)) > n2 && t2 < i2;
  }
}
function t$1E(n2) {
  for (const i2 in n2) {
    const t2 = n2[i2];
    t2 instanceof Function && (n2[i2] = t2.bind(n2));
  }
  return n2;
}
t$1E(new i$2j(0, 2 * Math.PI));
const r$1s = t$1E(new i$2j(-Math.PI, Math.PI)), s$1N = t$1E(new i$2j(0, 360));
let d$1p = class extends i$2R(l$2B) {
  constructor(...o2) {
    super(...o2), this.position = new w$_([0, 0, 0]), this.heading = 0, this.tilt = 0, this.fov = 55;
  }
  normalizeCtorArgs(o2, r2, t2, e2) {
    if (o2 && typeof o2 == "object" && ("x" in o2 || Array.isArray(o2))) {
      const s2 = { position: o2 };
      return r2 != null && (s2.heading = r2), t2 != null && (s2.tilt = t2), e2 != null && (s2.fov = e2), s2;
    }
    return o2;
  }
  writePosition(o2, r2, t2, e2) {
    const s2 = o2.clone();
    s2.x = a$2_(o2.x || 0), s2.y = a$2_(o2.y || 0), s2.z = o2.hasZ ? a$2_(o2.z || 0) : o2.z, r2[t2] = s2.write({}, e2);
  }
  readPosition(o2, r2) {
    const t2 = new w$_();
    return t2.read(o2, r2), t2.x = a$2_(t2.x || 0), t2.y = a$2_(t2.y || 0), t2.z = t2.hasZ ? a$2_(t2.z || 0) : t2.z, t2;
  }
  equals(o2) {
    return !t$2r(o2) && (this.tilt === o2.tilt && this.heading === o2.heading && this.fov === o2.fov && this.position.equals(o2.position));
  }
};
e$2g([y$1I({ type: w$_, json: { write: { isRequired: true } } })], d$1p.prototype, "position", void 0), e$2g([r$1P("position")], d$1p.prototype, "writePosition", null), e$2g([o$29("position")], d$1p.prototype, "readPosition", null), e$2g([y$1I({ type: Number, nonNullable: true, json: { write: { isRequired: true } } }), s$2i((o2) => s$1N.normalize(a$2_(o2)))], d$1p.prototype, "heading", void 0), e$2g([y$1I({ type: Number, nonNullable: true, json: { write: { isRequired: true } } }), s$2i((o2) => a$2v(a$2_(o2), -180, 180))], d$1p.prototype, "tilt", void 0), e$2g([y$1I({ type: Number, nonNullable: true, json: { read: false, write: false } })], d$1p.prototype, "fov", void 0), d$1p = e$2g([n$2P("esri.Camera")], d$1p);
const y$1c = d$1p;
var m$1M;
let n$29 = m$1M = class extends l$2B {
  constructor(r2) {
    super(r2), this.rotation = 0, this.scale = 0, this.targetGeometry = null, this.camera = null;
  }
  castRotation(r2) {
    return (r2 %= 360) < 0 && (r2 += 360), r2;
  }
  clone() {
    return new m$1M({ rotation: this.rotation, scale: this.scale, targetGeometry: r$1$(this.targetGeometry) ? this.targetGeometry.clone() : null, camera: r$1$(this.camera) ? this.camera.clone() : null });
  }
};
function l$1R() {
  return { enabled: !this.camera };
}
e$2g([y$1I({ type: Number, json: { write: true, origins: { "web-map": { default: 0, write: true }, "web-scene": { write: { overridePolicy: l$1R } } } } })], n$29.prototype, "rotation", void 0), e$2g([s$2i("rotation")], n$29.prototype, "castRotation", null), e$2g([y$1I({ type: Number, json: { write: true, origins: { "web-map": { default: 0, write: true }, "web-scene": { write: { overridePolicy: l$1R } } } } })], n$29.prototype, "scale", void 0), e$2g([y$1I({ types: i$2S, json: { read: v$14, write: true, origins: { "web-scene": { read: v$14, write: { overridePolicy: l$1R } } } } })], n$29.prototype, "targetGeometry", void 0), e$2g([y$1I({ type: y$1c, json: { write: true } })], n$29.prototype, "camera", void 0), n$29 = m$1M = e$2g([n$2P("esri.Viewpoint")], n$29);
const u$1w = n$29;
let c$2j = class extends j$V {
  constructor(t2) {
    super(t2), this.getCollections = null;
  }
  initialize() {
    this.own(l$2D(() => this._refresh()));
  }
  destroy() {
    this.getCollections = null;
  }
  _refresh() {
    const t2 = r$1$(this.getCollections) ? this.getCollections() : null;
    if (t$2r(t2))
      return void this.removeAll();
    let o2 = 0;
    for (const r2 of t2)
      r$1$(r2) && (o2 = this._processCollection(o2, r2));
    this.splice(o2, this.length);
  }
  _createNewInstance(t2) {
    return new j$V(t2);
  }
  _processCollection(t2, o2) {
    if (!o2)
      return t2;
    const s2 = this.itemFilterFunction ? this.itemFilterFunction : (t3) => !!t3;
    for (const r2 of o2)
      if (r2) {
        if (s2(r2)) {
          const o3 = this.indexOf(r2, t2);
          o3 >= 0 ? o3 !== t2 && this.reorder(r2, t2) : this.add(r2, t2), ++t2;
        }
        if (this.getChildrenFunction) {
          const o3 = this.getChildrenFunction(r2);
          if (Array.isArray(o3))
            for (const s3 of o3)
              t2 = this._processCollection(t2, s3);
          else
            t2 = this._processCollection(t2, o3);
        }
      }
    return t2;
  }
};
e$2g([y$1I()], c$2j.prototype, "getCollections", void 0), e$2g([y$1I()], c$2j.prototype, "getChildrenFunction", void 0), e$2g([y$1I()], c$2j.prototype, "itemFilterFunction", void 0), c$2j = e$2g([n$2P("esri.core.CollectionFlattener")], c$2j);
const l$1Q = c$2j;
function l$1P(n2, t2, r2 = {}) {
  return m$1L(n2, t2, r2, y$1b);
}
function f$1o(n2, t2, r2 = {}) {
  return m$1L(n2, t2, r2, d$1o);
}
function m$1L(n2, t2, r2 = {}, e2) {
  let i2 = null;
  const u2 = r2.once ? (n3, r3) => {
    e2(n3) && (h$1W(i2), t2(n3, r3));
  } : (n3, r3) => {
    e2(n3) && t2(n3, r3);
  };
  if (i2 = P$E(n2, u2, r2.sync, r2.equals), r2.initial) {
    const t3 = n2();
    u2(t3, t3);
  }
  return i2;
}
function a$2a(r2, i2, u2, s2 = {}) {
  let c2 = null, f2 = null, m2 = null;
  function a2() {
    var _a2;
    c2 && f2 && (f2.remove(), (_a2 = s2.onListenerRemove) == null ? void 0 : _a2.call(s2, c2), c2 = null, f2 = null);
  }
  function p2(n2) {
    s2.once && s2.once && h$1W(m2), u2(n2);
  }
  const j2 = l$1P(r2, (r3, e2) => {
    var _a2;
    a2(), e$1$(r3) && (c2 = r3, f2 = r$1R(r3, i2, p2), (_a2 = s2.onListenerAdd) == null ? void 0 : _a2.call(s2, r3));
  }, { sync: s2.sync, initial: true });
  return m2 = n$2U(() => {
    j2.remove(), a2();
  }), m2;
}
function j$I(n2, t2) {
  return v$X(n2, d$1o, t2);
}
function v$X(n2, t2, e2) {
  if (p$3D(e2))
    return Promise.reject(a$2T());
  const c2 = n2();
  if (t2 == null ? void 0 : t2(c2))
    return Promise.resolve(c2);
  let l2 = null;
  function f2() {
    l2 = h$1W(l2);
  }
  return new Promise((o2, i2) => {
    l2 = r$1X([v$19(e2, () => {
      f2(), i2(a$2T());
    }), m$1L(n2, (n3) => {
      f2(), o2(n3);
    }, { sync: false, once: true }, t2 != null ? t2 : y$1b)]);
  });
}
function y$1b(n2) {
  return true;
}
function d$1o(n2) {
  return !!n2;
}
function P$u(n2, t2, r2 = {}) {
  let e2 = false;
  const o2 = l$1P(n2, (n3, r3) => {
    e2 || t2(n3, r3);
  }, r2);
  return { remove() {
    o2.remove();
  }, pause() {
    e2 = true;
  }, resume() {
    e2 = false;
  } };
}
const U$r = { sync: true }, h$1j = { initial: true }, w$Q = { sync: true, initial: true };
class e$1t {
  constructor(t2 = (t3) => t3.values().next().value) {
    this._peeker = t2, this._items = new Set();
  }
  get length() {
    return this._items.size;
  }
  clear() {
    this._items.clear();
  }
  last() {
    if (this._items.size === 0)
      return;
    let t2;
    for (t2 of this._items)
      ;
    return t2;
  }
  peek() {
    if (this._items.size !== 0)
      return this._peeker(this._items);
  }
  push(t2) {
    this.contains(t2) || this._items.add(t2);
  }
  contains(t2) {
    return this._items.has(t2);
  }
  pop() {
    if (this.length === 0)
      return;
    const e2 = this.peek();
    return this._items.delete(x$16(e2)), e2;
  }
  popLast() {
    if (this.length === 0)
      return;
    const e2 = this.last();
    return this._items.delete(x$16(e2)), e2;
  }
  remove(t2) {
    this._items.delete(t2);
  }
  filter(t2) {
    return this._items.forEach((e2) => {
      t2(e2) || this._items.delete(e2);
    }), this;
  }
}
var t$1D;
!function(t2) {
  t2[t2.HANDSHAKE = 0] = "HANDSHAKE", t2[t2.OPEN = 1] = "OPEN", t2[t2.OPENED = 2] = "OPENED", t2[t2.RESPONSE = 3] = "RESPONSE", t2[t2.INVOKE = 4] = "INVOKE", t2[t2.ABORT = 5] = "ABORT", t2[t2.CLOSE = 6] = "CLOSE", t2[t2.OPEN_PORT = 7] = "OPEN_PORT", t2[t2.ON = 8] = "ON";
}(t$1D || (t$1D = {}));
let e$1s = 0;
function r$1r() {
  return e$1s++;
}
function n$28(t2) {
  return t2 && typeof t2 == "object" && ("result" in t2 || "transferList" in t2);
}
function s$1M(t2) {
  return t2 ? typeof t2 == "string" ? JSON.stringify({ name: "message", message: t2 }) : t2.toJSON ? JSON.stringify(t2) : JSON.stringify({ name: t2.name, message: t2.message, details: t2.details || { stack: t2.stack } }) : null;
}
function o$1E(e2, r2, f2, a2) {
  if (r2.type === t$1D.OPEN_PORT)
    return void e2.postMessage(r2, [r2.port]);
  if (r2.type !== t$1D.INVOKE && r2.type !== t$1D.RESPONSE)
    return void e2.postMessage(r2);
  let u2;
  if (n$28(f2) ? (u2 = i$2i(f2.transferList), r2.data = f2.result) : (u2 = i$2i(a2), r2.data = f2), u2) {
    if (has("ff")) {
      for (const n2 of u2)
        if ("byteLength" in n2 && n2.byteLength > 267386880) {
          const n3 = "Worker call with large ArrayBuffer would crash Firefox";
          switch (r2.type) {
            case t$1D.INVOKE:
              throw n3;
            case t$1D.RESPONSE:
              return void o$1E(e2, { type: t$1D.RESPONSE, jobId: r2.jobId, error: s$1M(n3) });
          }
        }
    }
    e2.postMessage(r2, u2);
  } else
    e2.postMessage(r2);
}
function f$1n(t2) {
  if (!t2)
    return null;
  const e2 = t2.data;
  return e2 ? typeof e2 == "string" ? JSON.parse(e2) : e2 : null;
}
function i$2i(t2) {
  if (!t2 || !t2.length)
    return null;
  if (has("esri-workers-arraybuffer-transfer"))
    return t2;
  const e2 = t2.filter((t3) => !a$29(t3));
  return e2.length ? e2 : null;
}
function a$29(t2) {
  return t2 instanceof ArrayBuffer || t2 && t2.constructor && t2.constructor.name === "ArrayBuffer";
}
const k$v = { statsWorker: () => import("./statsWorker.js"), geometryEngineWorker: () => import("./geometryEngineWorker.js"), CSVSourceWorker: () => import("./CSVSourceWorker.js"), EdgeProcessingWorker: () => import("./EdgeProcessingWorker.js"), ElevationSamplerWorker: () => import("./ElevationSamplerWorker.js"), FeatureServiceSnappingSourceWorker: () => import("./FeatureServiceSnappingSourceWorker.js"), GeoJSONSourceWorker: () => import("./GeoJSONSourceWorker.js"), LercWorker: () => import("./LercWorker.js"), MemorySourceWorker: () => import("./MemorySourceWorker.js"), PBFDecoderWorker: () => import("./PBFDecoderWorker.js"), Pipeline: () => import("./Pipeline.js"), PointCloudWorker: () => import("./PointCloudWorker.js"), RasterWorker: () => import("./RasterWorker.js"), SceneLayerSnappingSourceWorker: () => import("./SceneLayerSnappingSourceWorker.js"), SceneLayerWorker: () => import("./SceneLayerWorker.js"), WFSSourceWorker: () => import("./WFSSourceWorker.js"), WorkerTileHandler: () => import("./WorkerTileHandler.js") }, { CLOSE: b$V, ABORT: v$W, INVOKE: y$1a, RESPONSE: j$H, OPEN_PORT: S$G, ON: f$1m } = t$1D, W$e = 2;
class M$y {
  constructor(e2) {
    this._timer = null, this._cancelledJobIds = new Set(), this._invokeMessages = [], this._invoke = e2, this._timer = null, this._process = this._process.bind(this);
  }
  push(e2) {
    e2.type === t$1D.ABORT ? this._cancelledJobIds.add(e2.jobId) : (this._invokeMessages.push(e2), this._timer === null && (this._timer = setTimeout(this._process, 0)));
  }
  clear() {
    this._invokeMessages.length = 0, this._cancelledJobIds.clear(), this._timer = null;
  }
  _process() {
    this._timer = null;
    for (const e2 of this._invokeMessages)
      this._cancelledJobIds.has(e2.jobId) || this._invoke(e2);
    this._cancelledJobIds.clear(), this._invokeMessages.length = 0;
  }
}
class w$P {
  constructor(e2, s2, t2) {
    this._port = e2, this._getNextJob = t2, this._outJobs = new Map(), this._inJobs = new Map(), this._invokeQueue = new M$y((e3) => this._onInvokeMessage(e3)), this._client = s2.client, this._onMessage = this._onMessage.bind(this), this._channel = s2.channel, this._schedule = s2.schedule, this._port.addEventListener("message", this._onMessage), this._port.start();
  }
  static connect(e2) {
    const s2 = new MessageChannel();
    let t2;
    t2 = typeof e2 == "function" ? new e2() : "default" in e2 && typeof e2.default == "function" ? new e2.default() : e2;
    const o2 = new w$P(s2.port1, { channel: s2, client: t2 }, () => null);
    return typeof t2 == "object" && "remoteClient" in t2 && (t2.remoteClient = o2), w$P.clients.set(o2, t2), s2.port2;
  }
  static loadWorker(e2) {
    const s2 = k$v[e2];
    return s2 ? s2() : Promise.resolve(null);
  }
  close() {
    this._post({ type: b$V }), this._close();
  }
  isBusy() {
    return this._outJobs.size > 0;
  }
  invoke(e2, t2, r2) {
    const c2 = r2 && r2.signal, l2 = r2 && r2.transferList;
    if (!this._port)
      return Promise.reject(new s$2u("worker:port-closed", `Cannot call invoke('${e2}'), port is closed`, { methodName: e2, data: t2 }));
    const h2 = r$1r();
    return new Promise((s2, r3) => {
      if (p$3D(c2))
        return this._processWork(), void r3(a$2T());
      const p2 = v$19(c2, () => {
        const e3 = this._outJobs.get(h2);
        e3 && (this._outJobs.delete(h2), this._processWork(), h$1W(e3.abortHandle), this._post({ type: v$W, jobId: h2 }), r3(a$2T()));
      }), u2 = { resolve: s2, reject: r3, abortHandle: p2, debugInfo: e2 };
      this._outJobs.set(h2, u2), this._post({ type: y$1a, jobId: h2, methodName: e2, abortable: c2 != null }, t2, l2);
    });
  }
  on(e2, s2) {
    const t2 = new MessageChannel();
    function o2(e3) {
      s2(e3.data);
    }
    return this._port.postMessage({ type: t$1D.ON, eventType: e2, port: t2.port2 }, [t2.port2]), t2.port1.addEventListener("message", o2), t2.port1.start(), { remove() {
      t2.port1.postMessage({ type: t$1D.CLOSE }), t2.port1.close(), t2.port1.removeEventListener("message", o2);
    } };
  }
  jobAdded() {
    this._processWork();
  }
  openPort() {
    const e2 = new MessageChannel();
    return this._post({ type: S$G, port: e2.port2 }), e2.port1;
  }
  _processWork() {
    if (this._outJobs.size >= W$e)
      return;
    const e2 = this._getNextJob();
    if (!e2)
      return;
    const { methodName: s2, data: t2, invokeOptions: o2, deferred: r2 } = e2;
    this.invoke(s2, t2, o2).then((e3) => r2.resolve(e3)).catch((e3) => r2.reject(e3));
  }
  _close() {
    this._channel && (this._channel = void 0), this._port.removeEventListener("message", this._onMessage), this._port.close(), this._outJobs.forEach((e2) => {
      h$1W(e2.abortHandle), e2.reject(a$2T(`Worker closing, aborting job calling '${e2.debugInfo}'`));
    }), this._inJobs.clear(), this._outJobs.clear(), this._invokeQueue.clear(), this._port = this._client = this._schedule = null;
  }
  _onMessage(e2) {
    r$1$(this._schedule) ? this._schedule(() => this._processMessage(e2)) : this._processMessage(e2);
  }
  _processMessage(e2) {
    const s2 = f$1n(e2);
    if (s2)
      switch (s2.type) {
        case j$H:
          this._onResponseMessage(s2);
          break;
        case y$1a:
          this._invokeQueue.push(s2);
          break;
        case v$W:
          this._onAbortMessage(s2);
          break;
        case b$V:
          this._onCloseMessage();
          break;
        case S$G:
          this._onOpenPortMessage(s2);
          break;
        case f$1m:
          this._onOnMessage(s2);
      }
  }
  _onAbortMessage(e2) {
    const s2 = this._inJobs, t2 = e2.jobId, o2 = s2.get(t2);
    this._invokeQueue.push(e2), o2 && (o2.controller && o2.controller.abort(), s2.delete(t2));
  }
  _onCloseMessage() {
    const e2 = this._client;
    this._close(), e2 && "destroy" in e2 && w$P.clients.get(this) === e2 && e2.destroy(), w$P.clients.delete(this), e2 && e2.remoteClient && (e2.remoteClient = null);
  }
  _onInvokeMessage(e2) {
    const { methodName: s2, jobId: t2, data: o2, abortable: r2 } = e2, i2 = r2 ? new AbortController() : null, n2 = this._inJobs;
    let a2, p2 = this._client, h2 = p2[s2];
    try {
      if (!h2 && s2 && s2.includes(".")) {
        const e3 = s2.split(".");
        for (let s3 = 0; s3 < e3.length - 1; s3++)
          p2 = p2[e3[s3]], h2 = p2[e3[s3 + 1]];
      }
      if (typeof h2 != "function")
        throw new TypeError(`${s2} is not a function`);
      a2 = h2.call(p2, o2, { client: this, signal: i2 ? i2.signal : null });
    } catch (u2) {
      return void this._post({ type: j$H, jobId: t2, error: s$1M(u2) });
    }
    C$E(a2) ? (n2.set(t2, { controller: i2, promise: a2 }), a2.then((e3) => {
      n2.has(t2) && (n2.delete(t2), this._post({ type: j$H, jobId: t2 }, e3));
    }, (e3) => {
      n2.has(t2) && (n2.delete(t2), j$_(e3) || this._post({ type: j$H, jobId: t2, error: s$1M(e3 || { message: `Error encountered at method ${s2}` }) }));
    })) : this._post({ type: j$H, jobId: t2 }, a2);
  }
  _onOpenPortMessage(e2) {
    new w$P(e2.port, { client: this._client }, () => null);
  }
  _onOnMessage(e2) {
    const { port: s2 } = e2, o2 = this._client.on(e2.eventType, (e3) => {
      s2.postMessage(e3);
    }), r2 = r$1R(e2.port, "message", (e3) => {
      var _a2;
      ((_a2 = f$1n(e3)) == null ? void 0 : _a2.type) === t$1D.CLOSE && (r2.remove(), o2.remove(), s2.close());
    });
  }
  _onResponseMessage(e2) {
    const { jobId: t2, error: r2, data: i2 } = e2, n2 = this._outJobs;
    if (!n2.has(t2))
      return;
    const a2 = n2.get(t2);
    n2.delete(t2), this._processWork(), h$1W(a2.abortHandle), r2 ? a2.reject(s$2u.fromJSON(JSON.parse(r2))) : a2.resolve(i2);
  }
  _post(e2, s2, t2) {
    return o$1E(this._port, e2, s2, t2);
  }
}
w$P.kernelInfo = { revision: f$1u, version: a$2k, buildDate: e$1x }, w$P.clients = new Map();
class h$1i {
  constructor() {
    this._inUseClients = new Array(), this._clients = new Array(), this._clientPromises = new Array(), this._ongoingJobsQueue = new e$1t();
  }
  destroy() {
    this.close();
  }
  get closed() {
    return !this._clients || !this._clients.length;
  }
  open(e2, t2) {
    return new Promise((n2, i2) => {
      let r2 = true;
      const h2 = (e3) => {
        f$1V(t2.signal), r2 && (r2 = false, e3());
      };
      this._clients.length = e2.length, this._clientPromises.length = e2.length, this._inUseClients.length = e2.length;
      for (let o2 = 0; o2 < e2.length; ++o2) {
        const r3 = e2[o2];
        C$E(r3) ? this._clientPromises[o2] = r3.then((e3) => (this._clients[o2] = new w$P(e3, t2, () => {
          var _a2;
          return (_a2 = this._ongoingJobsQueue.pop()) != null ? _a2 : null;
        }), h2(n2), this._clients[o2]), () => (h2(i2), null)) : (this._clients[o2] = new w$P(r3, t2, () => {
          var _a2;
          return (_a2 = this._ongoingJobsQueue.pop()) != null ? _a2 : null;
        }), this._clientPromises[o2] = Promise.resolve(this._clients[o2]), h2(n2));
      }
    });
  }
  broadcast(e2, t2, s2) {
    const n2 = new Array(this._clientPromises.length);
    for (let i2 = 0; i2 < this._clientPromises.length; ++i2) {
      const o2 = this._clientPromises[i2];
      n2[i2] = o2.then((n3) => n3 == null ? void 0 : n3.invoke(e2, t2, s2));
    }
    return n2;
  }
  close() {
    let e2;
    for (; e2 = this._ongoingJobsQueue.pop(); )
      e2.deferred.reject(a$2T(`Worker closing, aborting job calling '${e2.methodName}'`));
    for (const t2 of this._clientPromises)
      t2.then((e3) => e3 == null ? void 0 : e3.close());
    this._clients.length = 0, this._clientPromises.length = 0;
  }
  invoke(e2, s2, n2) {
    let o2;
    Array.isArray(n2) ? (s$2z.getLogger("esri.core.workers.Connection").warn("invoke()", "The transferList parameter is deprecated, use the options object instead"), o2 = { transferList: n2 }) : o2 = n2;
    const r2 = A$B();
    this._ongoingJobsQueue.push({ methodName: e2, data: s2, invokeOptions: o2, deferred: r2 });
    for (let t2 = 0; t2 < this._clientPromises.length; t2++) {
      const e3 = this._clients[t2];
      e3 ? e3.jobAdded() : this._clientPromises[t2].then((e4) => e4 == null ? void 0 : e4.jobAdded());
    }
    return r2.promise;
  }
  on(t2, s2) {
    return Promise.all(this._clientPromises).then(() => r$1X(this._clients.map((e2) => e2.on(t2, s2))));
  }
  openPorts() {
    return new Promise((e2) => {
      const t2 = new Array(this._clientPromises.length);
      let s2 = t2.length;
      for (let n2 = 0; n2 < this._clientPromises.length; ++n2) {
        this._clientPromises[n2].then((i2) => {
          i2 && (t2[n2] = i2.openPort()), --s2 == 0 && e2(t2);
        });
      }
    });
  }
  get test() {
    return { numClients: this._clients.length };
  }
}
const i$2h = s$2z.getLogger("esri.assets");
function a$28(t2) {
  if (!s$2A.assetsPath)
    throw i$2h.errorOnce("The API assets location needs to be set using config.assetsPath. More information: https://arcg.is/1OzLe50"), new s$2u("assets:path-not-set", "config.assetsPath is not set");
  return G$q(s$2A.assetsPath, t2);
}
const i$2g = s$2z.getLogger("esri.intl.substitute");
function s$1L(t2, r2, n2 = {}) {
  const { format: o2 = {} } = n2;
  return n$2W(t2, (t3) => u$1v(t3, r2, o2));
}
function u$1v(t2, e2, n2) {
  var _a2;
  let o2, i2;
  const s2 = t2.indexOf(":");
  if (s2 === -1 ? o2 = t2.trim() : (o2 = t2.slice(0, s2).trim(), i2 = t2.slice(s2 + 1).trim()), !o2)
    return "";
  const u2 = t$2o(o2, e2);
  if (u2 == null)
    return "";
  const m2 = (_a2 = i2 ? n2 == null ? void 0 : n2[i2] : null) != null ? _a2 : n2 == null ? void 0 : n2[o2];
  return m2 ? c$2i(u2, m2) : i2 ? a$27(u2, i2) : f$1l(u2);
}
function c$2i(t2, r2) {
  switch (r2.type) {
    case "date":
      return L$x(t2, r2.intlOptions);
    case "number":
      return m$2f(t2, r2.intlOptions);
    default:
      return i$2g.warn("missing format descriptor for key {key}"), f$1l(t2);
  }
}
function a$27(t2, r2) {
  switch (r2.toLowerCase()) {
    case "dateformat":
      return L$x(t2);
    case "numberformat":
      return m$2f(t2);
    default:
      return i$2g.warn(`inline format is unsupported since 4.12: ${r2}`), /^(dateformat|datestring)/i.test(r2) ? L$x(t2) : /^numberformat/i.test(r2) ? m$2f(t2) : f$1l(t2);
  }
}
function f$1l(t2) {
  switch (typeof t2) {
    case "string":
      return t2;
    case "number":
      return m$2f(t2);
    case "boolean":
      return "" + t2;
    default:
      return t2 instanceof Date ? L$x(t2) : "";
  }
}
const r$1q = /^([a-z]{2})(?:[-_]([A-Za-z]{2}))?$/, o$1D = { ar: true, bg: true, bs: true, ca: true, cs: true, da: true, de: true, el: true, en: true, es: true, et: true, fi: true, fr: true, he: true, hr: true, hu: true, id: true, it: true, ja: true, ko: true, lt: true, lv: true, nb: true, nl: true, pl: true, "pt-BR": true, "pt-PT": true, ro: true, ru: true, sk: true, sl: true, sr: true, sv: true, th: true, tr: true, uk: true, vi: true, "zh-CN": true, "zh-HK": true, "zh-TW": true };
function i$2f(t2) {
  var _a2;
  return (_a2 = o$1D[t2]) != null ? _a2 : false;
}
const a$26 = [], c$2h = new Map();
function d$1n(t2) {
  for (const e2 of c$2h.keys())
    _$F(t2.pattern, e2) && c$2h.delete(e2);
}
function l$1O(t2) {
  return a$26.includes(t2) || (d$1n(t2), a$26.unshift(t2)), { remove() {
    const e2 = a$26.indexOf(t2);
    e2 > -1 && (a$26.splice(e2, 1), d$1n(t2));
  } };
}
async function u$1u(t2) {
  const e2 = l$2r();
  c$2h.has(t2) || c$2h.set(t2, f$1k(t2, e2));
  const n2 = c$2h.get(t2);
  return n2 && await m$1K.add(n2), n2;
}
function h$1h(t2) {
  if (!r$1q.test(t2))
    return null;
  const e2 = r$1q.exec(t2);
  if (e2 === null)
    return null;
  const [, n2, s2] = e2, o2 = n2 + (s2 ? "-" + s2.toUpperCase() : "");
  return i$2f(o2) ? o2 : i$2f(n2) ? n2 : null;
}
async function f$1k(e2, n2) {
  const s2 = [];
  for (const t2 of a$26)
    if (_$F(t2.pattern, e2))
      try {
        return await t2.fetchMessageBundle(e2, n2);
      } catch (r2) {
        s2.push(r2);
      }
  if (s2.length)
    throw new s$2u("intl:message-bundle-error", `Errors occurred while loading "${e2}"`, { errors: s2 });
  throw new s$2u("intl:no-message-bundle-loader", `No loader found for message bundle "${e2}"`);
}
function _$F(t2, e2) {
  return typeof t2 == "string" ? e2.startsWith(t2) : t2.test(e2);
}
g$1a(() => {
  c$2h.clear();
});
const m$1K = new class {
  constructor() {
    this._numLoading = 0, this._dfd = null;
  }
  async waitForAll() {
    this._dfd && await this._dfd.promise;
  }
  add(t2) {
    return this._increase(), t2.then(() => this._decrease(), () => this._decrease()), this.waitForAll();
  }
  _increase() {
    this._numLoading++, this._dfd || (this._dfd = A$B());
  }
  _decrease() {
    this._numLoading = Math.max(this._numLoading - 1, 0), this._dfd && this._numLoading === 0 && (this._dfd.resolve(), this._dfd = null);
  }
}();
async function o$1C(e2, n2, o2, i2) {
  const a2 = n2.exec(o2);
  if (!a2)
    throw new s$2u("esri-intl:invalid-bundle", `Bundle id "${o2}" is not compatible with the pattern "${n2}"`);
  const c2 = a2[1] ? `${a2[1]}/` : "", l2 = a2[2], w2 = h$1h(i2), h2 = `${c2}${l2}.json`, u2 = w2 ? `${c2}${l2}_${w2}.json` : h2;
  let f2;
  try {
    f2 = await s$1K(e2(u2));
  } catch (d2) {
    if (u2 === h2)
      throw new s$2u("intl:unknown-bundle", `Bundle "${o2}" cannot be loaded`, { error: d2 });
    try {
      f2 = await s$1K(e2(h2));
    } catch (d3) {
      throw new s$2u("intl:unknown-bundle", `Bundle "${o2}" cannot be loaded`, { error: d3 });
    }
  }
  return f2;
}
async function s$1K(t2) {
  if (r$1$(c$2g.fetchBundleAsset))
    return c$2g.fetchBundleAsset(t2);
  const r2 = await U$t(t2, { responseType: "text" });
  return JSON.parse(r2.data);
}
class i$2e {
  constructor({ base: e2 = "", pattern: t2, location: n2 = new URL(window.location.href) }) {
    let r2;
    r2 = typeof n2 == "string" ? (e3) => new URL(e3, new URL(n2, window.location.href)).href : n2 instanceof URL ? (e3) => new URL(e3, n2).href : n2, this.pattern = typeof t2 == "string" ? new RegExp(`^${t2}`) : t2, this.getAssetUrl = r2, e2 = e2 ? e2.endsWith("/") ? e2 : e2 + "/" : "", this.matcher = new RegExp(`^${e2}(?:(.*)/)?(.*)$`);
  }
  fetchMessageBundle(e2, t2) {
    return o$1C(this.getAssetUrl, this.matcher, e2, t2);
  }
}
function a$25(e2) {
  return new i$2e(e2);
}
const c$2g = {};
l$1O(a$25({ pattern: "esri/", location: a$28 }));
const a$24 = {};
function e$1r(s2, a2) {
  for (const e2 of s2)
    if (e2.name === a2.name)
      return;
  s2.push(a2);
}
function r$1p(s2) {
  var _a2;
  const r2 = { async: s2.async, isDebug: s2.isDebug, locale: s2.locale, baseUrl: s2.baseUrl, has: __spreadValues({}, s2.has), map: __spreadValues({}, s2.map), packages: s2.packages && s2.packages.concat() || [], paths: __spreadValues({}, s2.paths) };
  return s2.hasOwnProperty("async") || (r2.async = true), s2.hasOwnProperty("isDebug") || (r2.isDebug = false), s2.baseUrl || (r2.baseUrl = a$24.baseUrl), (_a2 = a$24.packages) == null ? void 0 : _a2.forEach((s3) => {
    var _a3;
    e$1r((_a3 = r2.packages) != null ? _a3 : [], s3);
  }), r2;
}
class n$27 {
  constructor() {
    const e2 = document.createDocumentFragment();
    ["addEventListener", "dispatchEvent", "removeEventListener"].forEach((s2) => {
      this[s2] = (...r2) => e2[s2](...r2);
    });
  }
}
class a$23 {
  constructor() {
    this._dispatcher = new n$27(), this._workerPostMessage({ type: t$1D.HANDSHAKE });
  }
  terminate() {
  }
  get onmessage() {
    return this._onmessageHandler;
  }
  set onmessage(e2) {
    this._onmessageHandler && this.removeEventListener("message", this._onmessageHandler), this._onmessageHandler = e2, e2 && this.addEventListener("message", e2);
  }
  get onmessageerror() {
    return this._onmessageerrorHandler;
  }
  set onmessageerror(e2) {
    this._onmessageerrorHandler && this.removeEventListener("messageerror", this._onmessageerrorHandler), this._onmessageerrorHandler = e2, e2 && this.addEventListener("messageerror", e2);
  }
  get onerror() {
    return this._onerrorHandler;
  }
  set onerror(e2) {
    this._onerrorHandler && this.removeEventListener("error", this._onerrorHandler), this._onerrorHandler = e2, e2 && this.addEventListener("error", e2);
  }
  postMessage(s2) {
    t$2a(() => {
      this._workerMessageHandler(new MessageEvent("message", { data: s2 }));
    });
  }
  dispatchEvent(e2) {
    return this._dispatcher.dispatchEvent(e2);
  }
  addEventListener(e2, s2, r2) {
    this._dispatcher.addEventListener(e2, s2, r2);
  }
  removeEventListener(e2, s2, r2) {
    this._dispatcher.removeEventListener(e2, s2, r2);
  }
  _workerPostMessage(s2) {
    t$2a(() => {
      this.dispatchEvent(new MessageEvent("message", { data: s2 }));
    });
  }
  async _workerMessageHandler(e2) {
    const n2 = f$1n(e2);
    if (n2 && n2.type === t$1D.OPEN) {
      const { modulePath: e3, jobId: t2 } = n2;
      let a2 = await w$P.loadWorker(e3);
      a2 || (a2 = await import(
        /* @vite-ignore */
        /* webpackIgnore: true */
        e3
      ));
      const o2 = w$P.connect(a2);
      this._workerPostMessage({ type: t$1D.OPENED, jobId: t2, data: o2 });
    }
  }
}
const u$1t = s$2z.getLogger("esri.core.workers.workerFactory"), { HANDSHAKE: m$1J } = t$1D, p$2A = 'let globalId=0;const outgoing=new Map,configuration=JSON.parse("{CONFIGURATION}");self.esriConfig=configuration.esriConfig;const workerPath=self.esriConfig.workers.workerPath,HANDSHAKE=0,OPEN=1,OPENED=2,RESPONSE=3,INVOKE=4,ABORT=5;function createAbortError(){const e=new Error("Aborted");return e.name="AbortError",e}function receiveMessage(e){return e&&e.data?"string"==typeof e.data?JSON.parse(e.data):e.data:null}function invokeStaticMessage(e,o,r){const t=r&&r.signal,n=globalId++;return new Promise(((r,i)=>{if(t){if(t.aborted)return i(createAbortError());t.addEventListener("abort",(()=>{outgoing.get(n)&&(outgoing.delete(n),self.postMessage({type:5,jobId:n}),i(createAbortError()))}))}outgoing.set(n,{resolve:r,reject:i}),self.postMessage({type:4,jobId:n,methodName:e,abortable:null!=t,data:o})}))}let workerRevisionChecked=!1;function checkWorkerRevision(e){if(!workerRevisionChecked&&e.kernelInfo){workerRevisionChecked=!0;const{revision:o,version:r}=configuration.kernelInfo,{revision:t,version:n}=e.kernelInfo;esriConfig.assetsPath!==esriConfig.defaultAssetsPath&&o!==t&&console.warn(`Version mismatch detected between ArcGIS API for JavaScript modules and assets. For more information visit https://bit.ly/3QnsuSo.\\nModules version: ${r}\\nAssets version: ${n}`)}}function messageHandler(e){const o=receiveMessage(e);if(!o)return;const r=o.jobId;switch(o.type){case 1:let n;function t(e){const o=n.connect(e);self.postMessage({type:2,jobId:r,data:o},[o])}"function"==typeof define&&define.amd?require([workerPath],(e=>{n=e.default||e,checkWorkerRevision(n),n.loadWorker(o.modulePath).then((e=>e||new Promise((e=>{require([o.modulePath],e)})))).then(t)})):"System"in self&&"function"==typeof System.import?System.import(workerPath).then((e=>(n=e.default,checkWorkerRevision(n),n.loadWorker(o.modulePath)))).then((e=>e||System.import(o.modulePath))).then(t):esriConfig.workers.useDynamicImport?import(workerPath).then((e=>{n=e.default||e,checkWorkerRevision(n),n.loadWorker(o.modulePath).then((e=>e||import(o.modulePath))).then(t)})):(self.RemoteClient||importScripts(workerPath),n=self.RemoteClient.default||self.RemoteClient,checkWorkerRevision(n),n.loadWorker(o.modulePath).then(t));break;case 3:if(outgoing.has(r)){const i=outgoing.get(r);outgoing.delete(r),o.error?i.reject(JSON.parse(o.error)):i.resolve(o.data)}}}self.dojoConfig=configuration.loaderConfig,esriConfig.workers.loaderUrl&&(self.importScripts(esriConfig.workers.loaderUrl),"function"==typeof require&&"function"==typeof require.config&&require.config(configuration.loaderConfig)),self.addEventListener("message",messageHandler),self.postMessage({type:0});';
let g$$, k$u;
const h$1g = "Failed to create Worker. Fallback to execute module in main thread";
async function w$O() {
  if (!has("esri-workers") || (has("mozilla"), 0))
    return y$19(new a$23());
  if (!g$$ && !k$u)
    try {
      const e3 = p$2A.split('"{CONFIGURATION}"').join(`'${b$U()}'`);
      g$$ = URL.createObjectURL(new Blob([e3], { type: "text/javascript" }));
    } catch (r2) {
      k$u = r2 || {};
    }
  let e2;
  if (g$$)
    try {
      e2 = new Worker(g$$, { name: "esri-worker-" + v$V++ });
    } catch (r2) {
      u$1t.warn(h$1g, k$u), e2 = new a$23();
    }
  else
    u$1t.warn(h$1g, k$u), e2 = new a$23();
  return y$19(e2);
}
async function y$19(e2) {
  return new Promise((r2) => {
    function o2(s2) {
      const n2 = f$1n(s2);
      n2 && n2.type === m$1J && (e2.removeEventListener("message", o2), e2.removeEventListener("error", t2), r2(e2));
    }
    function t2(r3) {
      r3.preventDefault(), e2.removeEventListener("message", o2), e2.removeEventListener("error", t2), u$1t.warn("Failed to create Worker. Fallback to execute module in main thread", r3), (e2 = new a$23()).addEventListener("message", o2), e2.addEventListener("error", t2);
    }
    e2.addEventListener("message", o2), e2.addEventListener("error", t2);
  });
}
function b$U() {
  let t2;
  if (s$2A.default != null) {
    const e2 = __spreadValues({}, s$2A);
    delete e2.default, t2 = JSON.parse(JSON.stringify(e2));
  } else
    t2 = JSON.parse(JSON.stringify(s$2A));
  t2.assetsPath = Q$h(t2.assetsPath), t2.defaultAssetsPath = t2.defaultAssetsPath ? Q$h(t2.defaultAssetsPath) : void 0, t2.request.interceptors = [], t2.log.interceptors = [], t2.locale = l$2r(), t2.has = { "esri-csp-restrictions": has("esri-csp-restrictions"), "esri-2d-debug": false, "esri-2d-update-debug": has("esri-2d-update-debug"), "featurelayer-pbf": has("featurelayer-pbf"), "featurelayer-simplify-thresholds": has("featurelayer-simplify-thresholds"), "featurelayer-simplify-payload-size-factors": has("featurelayer-simplify-payload-size-factors"), "featurelayer-simplify-mobile-factor": has("featurelayer-simplify-mobile-factor"), "esri-atomics": has("esri-atomics"), "esri-shared-array-buffer": has("esri-shared-array-buffer"), "esri-tiles-debug": has("esri-tiles-debug"), "esri-workers-arraybuffer-transfer": has("esri-workers-arraybuffer-transfer"), "feature-polyline-generalization-factor": has("feature-polyline-generalization-factor"), "host-webworker": 1, "polylabel-placement-enabled": has("polylabel-placement-enabled") }, t2.workers.loaderUrl && (t2.workers.loaderUrl = Q$h(t2.workers.loaderUrl)), t2.workers.workerPath ? t2.workers.workerPath = Q$h(t2.workers.workerPath) : t2.workers.workerPath = Q$h(a$28("esri/core/workers/RemoteClient.js")), t2.workers.useDynamicImport = false;
  const i2 = s$2A.workers.loaderConfig, a2 = r$1p({ baseUrl: i2 == null ? void 0 : i2.baseUrl, locale: l$2r(), has: __spreadValues({ "csp-restrictions": 1, "dojo-test-sniff": 0, "host-webworker": 1 }, i2 == null ? void 0 : i2.has), map: __spreadValues({}, i2 == null ? void 0 : i2.map), paths: __spreadValues({}, i2 == null ? void 0 : i2.paths), packages: (i2 == null ? void 0 : i2.packages) || [] }), l2 = { version: a$2k, buildDate: e$1x, revision: f$1u };
  return JSON.stringify({ esriConfig: t2, loaderConfig: a2, kernelInfo: l2 });
}
let v$V = 0;
const { ABORT: b$T, INVOKE: m$1I, OPEN: _$E, OPENED: g$_, RESPONSE: u$1s } = t$1D;
class j$G {
  constructor(e2, t2) {
    this._outJobs = new Map(), this._inJobs = new Map(), this.worker = e2, this.id = t2, e2.addEventListener("message", this._onMessage.bind(this)), e2.addEventListener("error", (e3) => {
      e3.preventDefault(), s$2z.getLogger("esri.core.workers.WorkerOwner").error(e3);
    });
  }
  static async create(e2) {
    const t2 = await w$O();
    return new j$G(t2, e2);
  }
  terminate() {
    this.worker.terminate();
  }
  async open(e2, t2 = {}) {
    const { signal: o2 } = t2, s2 = r$1r();
    return new Promise((t3, n2) => {
      const a2 = { resolve: t3, reject: n2, abortHandle: d$1X(o2, () => {
        this._outJobs.delete(s2), this._post({ type: b$T, jobId: s2 });
      }) };
      this._outJobs.set(s2, a2), this._post({ type: _$E, jobId: s2, modulePath: e2 });
    });
  }
  _onMessage(e2) {
    const t2 = f$1n(e2);
    if (t2)
      switch (t2.type) {
        case g$_:
          this._onOpenedMessage(t2);
          break;
        case u$1s:
          this._onResponseMessage(t2);
          break;
        case b$T:
          this._onAbortMessage(t2);
          break;
        case m$1I:
          this._onInvokeMessage(t2);
      }
  }
  _onAbortMessage(e2) {
    const t2 = this._inJobs, o2 = e2.jobId, s2 = t2.get(o2);
    s2 && (s2.controller && s2.controller.abort(), t2.delete(o2));
  }
  _onInvokeMessage(t2) {
    const { methodName: o2, jobId: s2, data: r2, abortable: i2 } = t2, l2 = i2 ? new AbortController() : null, h2 = this._inJobs, c2 = r$1u[o2];
    let p2;
    try {
      if (typeof c2 != "function")
        throw new TypeError(`${o2} is not a function`);
      p2 = c2.call(null, r2, { signal: l2 ? l2.signal : null });
    } catch (b2) {
      return void this._post({ type: u$1s, jobId: s2, error: s$1M(b2) });
    }
    C$E(p2) ? (h2.set(s2, { controller: l2, promise: p2 }), p2.then((e2) => {
      h2.has(s2) && (h2.delete(s2), this._post({ type: u$1s, jobId: s2 }, e2));
    }, (e2) => {
      h2.has(s2) && (h2.delete(s2), e2 || (e2 = { message: "Error encountered at method" + o2 }), j$_(e2) || this._post({ type: u$1s, jobId: s2, error: s$1M(e2 || { message: `Error encountered at method ${o2}` }) }));
    })) : this._post({ type: u$1s, jobId: s2 }, p2);
  }
  _onOpenedMessage(e2) {
    const { jobId: t2, data: o2 } = e2, r2 = this._outJobs.get(t2);
    r2 && (this._outJobs.delete(t2), h$1W(r2.abortHandle), r2.resolve(o2));
  }
  _onResponseMessage(e2) {
    const { jobId: o2, error: r2, data: n2 } = e2, a2 = this._outJobs.get(o2);
    a2 && (this._outJobs.delete(o2), h$1W(a2.abortHandle), r2 ? a2.reject(s$2u.fromJSON(JSON.parse(r2))) : a2.resolve(n2));
  }
  _post(e2, t2, o2) {
    return o$1E(this.worker, e2, t2, o2);
  }
}
let i$2d = has("esri-workers-debug") ? 1 : has("esri-mobile") ? Math.min(navigator.hardwareConcurrency - 1, 3) : has("host-browser") ? navigator.hardwareConcurrency - 1 : 0;
i$2d || (i$2d = has("safari") && has("mac") || has("trident") ? 7 : 2);
let a$22 = 0;
const s$1J = [];
function l$1N() {
  d$1m();
}
async function m$1H(r2, t2) {
  const o2 = new h$1i();
  return await o2.open(r2, t2), o2;
}
async function u$1r(e2, n2 = {}) {
  if (typeof e2 != "string")
    throw new s$2u("workers:undefined-module", "modulePath is missing");
  let l2 = n2.strategy || "distributed";
  if (has("host-webworker") && !has("esri-workers") && (l2 = "local"), l2 === "local") {
    let r2 = await w$P.loadWorker(e2);
    r2 || (r2 = await import(
      /* @vite-ignore */
      /* webpackIgnore: true */
      e2
    )), f$1V(n2.signal);
    const i2 = n2.client || r2;
    return m$1H([w$P.connect(r2)], __spreadProps(__spreadValues({}, n2), { client: i2 }));
  }
  if (await d$1m(), f$1V(n2.signal), l2 === "dedicated") {
    const r2 = a$22++ % i$2d;
    return m$1H([await s$1J[r2].open(e2, n2)], n2);
  }
  if (n2.maxNumWorkers && n2.maxNumWorkers > 0) {
    const r2 = Math.min(n2.maxNumWorkers, i$2d);
    if (r2 < i$2d) {
      const t2 = new Array(r2);
      for (let o2 = 0; o2 < r2; ++o2) {
        const r3 = a$22++ % i$2d;
        t2[o2] = s$1J[r3].open(e2, n2);
      }
      return m$1H(t2, n2);
    }
  }
  return m$1H(s$1J.map((r2) => r2.open(e2, n2)), n2);
}
let p$2z = null;
async function d$1m() {
  if (p$2z)
    return p$2z;
  new AbortController();
  const r2 = [];
  for (let t2 = 0; t2 < i$2d; t2++) {
    const e2 = j$G.create(t2).then((r3) => (s$1J[t2] = r3, r3));
    r2.push(e2);
  }
  return p$2z = Promise.all(r2), p$2z;
}
function G$n(n2) {
  return new k$C({ wkt: `GEOCCS["Spherical geocentric",
    DATUM["Not specified",
      SPHEROID["Sphere",${n2.radius},0]],
    PRIMEM["Greenwich",0.0,
      AUTHORITY["EPSG","8901"]],
    UNIT["m",1.0],
    AXIS["Geocentric X",OTHER],
    AXIS["Geocentric Y",EAST],
    AXIS["Geocentric Z",NORTH]
  ]` });
}
const I$A = G$n(s$2h), E$F = G$n(t$20), R$u = G$n(e$1W), p$2y = new k$C({ wkt: `GEOCCS["WGS 84",
  DATUM["WGS_1984",
    SPHEROID["WGS 84",${s$2h.radius},298.257223563,
      AUTHORITY["EPSG","7030"]],
    AUTHORITY["EPSG","6326"]],
  PRIMEM["Greenwich",0,
    AUTHORITY["EPSG","8901"]],
  UNIT["m",1.0,
    AUTHORITY["EPSG","9001"]],
  AXIS["Geocentric X",OTHER],
  AXIS["Geocentric Y",OTHER],
  AXIS["Geocentric Z",NORTH],
  AUTHORITY["EPSG","4978"]
]` });
function O$v(n2) {
  return n2 && (P$D(n2) || n2 === E$F) ? E$F : n2 && (s$2j(n2) || n2 === R$u) ? R$u : I$A;
}
function u$1q(e2) {
  return r$1$(e2) && (P$D(e2) || e2 === E$F) ? t$20 : r$1$(e2) && (s$2j(e2) || e2 === R$u) ? e$1W : s$2h;
}
function s$1I(n2) {
  return w$$(n2) ? t$20 : C$D(n2) ? e$1W : s$2h;
}
const f$1j = 39.37, d$1l = s$2h.radius * Math.PI / 200, U$q = /UNIT\[([^\]]+)\]\]$/i, q$l = r$1O, h$1f = /UNIT\[([^\]]+)\]/i, B$o = new Set([4261, 4305, 4807, 4810, 4811, 4812, 4816, 4819, 4821, 4901, 4902, 37225, 104139, 104140]), p$2x = o$1_()({ meter: "meters", foot: "feet", foot_us: "us-feet", foot_clarke: "clarke-feet", yard_clarke: "clarke-yards", link_clarke: "clarke-links", yard_sears: "sears-yards", foot_sears: "sears-feet", chain_sears: "sears-chains", chain_benoit_1895_b: "benoit-1895-b-chains", yard_indian: "indian-yards", yard_indian_1937: "indian-1937-yards", foot_gold_coast: "gold-coast-feet", chain_sears_1922_truncated: "sears-1922-truncated-chains", "50_kilometers": "50-kilometers", "150_kilometers": "150-kilometers" }), k$t = (e2) => e2 * e2, b$S = (e2) => e2 * e2 * e2, y$18 = { length: { baseUnit: "meters", units: { millimeters: { inBaseUnits: 1e-3 }, centimeters: { inBaseUnits: 0.01 }, decimeters: { inBaseUnits: 0.1 }, meters: { inBaseUnits: 1 }, kilometers: { inBaseUnits: 1e3 }, inches: { inBaseUnits: 0.0254 }, feet: { inBaseUnits: 0.3048 }, yards: { inBaseUnits: 0.9144 }, miles: { inBaseUnits: 1609.344 }, "nautical-miles": { inBaseUnits: 1852 }, "us-feet": { inBaseUnits: 1200 / 3937 } } }, area: { baseUnit: "square-meters", units: { "square-millimeters": { inBaseUnits: k$t(1e-3) }, "square-centimeters": { inBaseUnits: k$t(0.01) }, "square-decimeters": { inBaseUnits: k$t(0.1) }, "square-meters": { inBaseUnits: 1 }, "square-kilometers": { inBaseUnits: k$t(1e3) }, "square-inches": { inBaseUnits: k$t(0.0254) }, "square-feet": { inBaseUnits: k$t(0.3048) }, "square-yards": { inBaseUnits: k$t(0.9144) }, "square-miles": { inBaseUnits: k$t(1609.344) }, "square-us-feet": { inBaseUnits: k$t(1200 / 3937) }, acres: { inBaseUnits: 15625e-7 * k$t(1609.344) }, ares: { inBaseUnits: 100 }, hectares: { inBaseUnits: 1e4 } } }, volume: { baseUnit: "liters", units: { liters: { inBaseUnits: 1 }, "cubic-millimeters": { inBaseUnits: 1e3 * b$S(1e-3) }, "cubic-centimeters": { inBaseUnits: 1e3 * b$S(0.01) }, "cubic-decimeters": { inBaseUnits: 1e3 * b$S(0.1) }, "cubic-meters": { inBaseUnits: 1e3 }, "cubic-kilometers": { inBaseUnits: 1e3 * b$S(1e3) }, "cubic-inches": { inBaseUnits: 1e3 * b$S(0.0254) }, "cubic-feet": { inBaseUnits: 1e3 * b$S(0.3048) }, "cubic-yards": { inBaseUnits: 1e3 * b$S(0.9144) }, "cubic-miles": { inBaseUnits: 1e3 * b$S(1609.344) } } }, angle: { baseUnit: "radians", units: { radians: { inBaseUnits: 1 }, degrees: { inBaseUnits: Math.PI / 180 } } } }, _$D = (() => {
  const e2 = {};
  for (const s2 in y$18)
    for (const t2 in y$18[s2].units)
      e2[t2] = s2;
  return e2;
})();
function M$x(e2, s2, t2) {
  return e2 * y$18[t2].units[s2].inBaseUnits;
}
function g$Z(e2, s2, t2) {
  return e2 / y$18[t2].units[s2].inBaseUnits;
}
const S$F = ["metric", "imperial", "inches", "feet", "yards", "miles", "nautical-miles", "us-feet", "meters", "kilometers"], I$z = new Map([["meters", "square-meters"], ["feet", "square-feet"], ["us-feet", "square-us-feet"]]);
function P$t(e2) {
  const s2 = _$D[e2];
  if (!s2)
    throw new Error("unknown type");
  return s2;
}
function x$M(e2, s2 = null) {
  return s2 = s2 || P$t(e2), y$18[s2].baseUnit === e2;
}
function E$E(e2, s2, t2) {
  if (s2 === t2)
    return e2;
  const r2 = P$t(s2);
  if (r2 !== P$t(t2))
    throw new Error("incompatible units");
  const i2 = x$M(s2, r2) ? e2 : M$x(e2, s2, r2);
  return x$M(t2, r2) ? i2 : g$Z(i2, t2, r2);
}
function O$u(e2, s2) {
  const t2 = E$E(e2, s2, "meters");
  return Math.abs(t2) < 3e3 ? "meters" : "kilometers";
}
function J$m(e2, s2) {
  const t2 = E$E(e2, s2, "meters");
  return Math.abs(t2) < 1e5 ? "meters" : "kilometers";
}
function K$e(e2, s2) {
  const t2 = E$E(e2, s2, "feet");
  return Math.abs(t2) < 1e3 ? "feet" : "miles";
}
function R$t(e2, s2) {
  const t2 = E$E(e2, s2, "feet");
  return Math.abs(t2) < 1e5 ? "feet" : "miles";
}
function A$r(e2, s2) {
  const t2 = E$E(e2, s2, "square-meters");
  return Math.abs(t2) < 3e6 ? "square-meters" : "square-kilometers";
}
function T$w(e2, s2) {
  const t2 = E$E(e2, s2, "square-feet");
  return Math.abs(t2) < 1e6 ? "square-feet" : "square-miles";
}
function Y$c(e2, s2, t2) {
  return E$E(e2, s2, "meters") / (t2 * Math.PI / 180);
}
function G$m(e2) {
  return p$2x.fromJSON(e2.toLowerCase()) || null;
}
function L$p(e2) {
  if (r$1$(e2) && !A$z(e2))
    return 1;
  const t2 = $$g(e2);
  return t2 > 1e5 ? 1 : t2;
}
function W$d(e2) {
  return $$g(e2) >= u$1q(e2).metersPerDegree ? "meters" : X$c(e2);
}
function $$g(e2, s2 = s$2h.metersPerDegree) {
  return i$3f(z$A(e2, true), s2);
}
function z$A(e2, t2 = false) {
  const r2 = r$1$(e2) ? e2.wkid : null, i2 = r$1$(e2) ? e2.wkt : null;
  let n2 = null;
  if (r2) {
    if (w$$(r2))
      return t$20.metersPerDegree;
    if (C$D(r2))
      return e$1W.metersPerDegree;
    n2 = q$l.values[q$l[r2]], !n2 && t2 && B$o.has(r2) && (n2 = d$1l);
  } else
    i2 && (re$5(i2) ? n2 = Q$f(U$q.exec(i2), n2) : te$5(i2) && (n2 = Q$f(h$1f.exec(i2), n2)));
  return n2;
}
function Q$f(e2, s2) {
  return e2 && e2[1] ? V$k(e2[1]) : s2;
}
function V$k(e2) {
  return parseFloat(e2.split(",")[1]);
}
function X$c(e2) {
  const t2 = r$1$(e2) ? e2.wkid : null, r2 = r$1$(e2) ? e2.wkt : null;
  let i2 = null;
  if (t2)
    i2 = q$l.units[q$l[t2]];
  else if (r2) {
    const e3 = re$5(r2) ? U$q : te$5(r2) ? h$1f : null;
    if (e3) {
      const s2 = e3.exec(r2);
      s2 && s2[1] && (i2 = ne$4(s2[1]));
    }
  }
  return r$1$(i2) ? G$m(i2) : null;
}
function Z$e(e2) {
  const s2 = X$c(e2);
  return t$2r(s2) || !S$F.includes(s2) ? null : s2;
}
function ee$5(e2) {
  const s2 = W$d(e2);
  return t$2r(s2) || !S$F.includes(s2) ? null : s2;
}
function se$3(e2) {
  const s2 = X$c(e2);
  return t$2r(s2) ? null : I$z.get(s2);
}
function te$5(e2) {
  return /^GEOCCS/i.test(e2);
}
function re$5(e2) {
  return /^PROJCS/i.test(e2);
}
const ie$5 = 1e-7;
function ne$4(e2) {
  const s2 = /[\\"\\']{1}([^\\"\\']+)/.exec(e2);
  let t2 = s2 && s2[1];
  if (!t2 || !q$l.units.includes(t2)) {
    const s3 = V$k(e2);
    t2 = null;
    const r2 = q$l.values;
    for (let e3 = 0; e3 < r2.length; ++e3)
      if (Math.abs(s3 - r2[e3]) < ie$5) {
        t2 = q$l.units[e3];
        break;
      }
  }
  return t2;
}
function ae$4(e2) {
  const s2 = X$c(e2);
  if (t$2r(s2))
    return null;
  switch (s2) {
    case "feet":
    case "us-feet":
    case "clarke-feet":
    case "clarke-yards":
    case "clarke-links":
    case "sears-yards":
    case "sears-feet":
    case "sears-chains":
    case "benoit-1895-b-chains":
    case "indian-yards":
    case "indian-1937-yards":
    case "gold-coast-feet":
    case "sears-1922-truncated-chains":
      return "imperial";
    case "50-kilometers":
    case "150-kilometers":
    case "meters":
      return "metric";
  }
  return null;
}
function ue$4(e2) {
  var _a2, _b2, _c2;
  const s2 = "metric";
  if (t$2r(e2))
    return s2;
  const i2 = e2.map, n2 = i2 && "portalItem" in i2 ? (_a2 = i2.portalItem) == null ? void 0 : _a2.portal : null;
  if (n2) {
    switch ((_c2 = (_b2 = n2 == null ? void 0 : n2.user) == null ? void 0 : _b2.units) != null ? _c2 : n2.units) {
      case s2:
        return s2;
      case "english":
        return "imperial";
    }
  }
  return i$3f(ae$4(e2.spatialReference), s2);
}
const ce$4 = { esriAcres: "acres", esriAres: "ares", esriHectares: "hectares", esriSquareCentimeters: "square-centimeters", esriSquareDecimeters: "square-decimeters", esriSquareFeet: "square-feet", esriSquareInches: "square-inches", esriSquareKilometers: "square-kilometers", esriSquareMeters: "square-meters", esriSquareMiles: "square-miles", esriSquareMillimeters: "square-millimeters", esriSquareUsFeet: "square-us-feet", esriSquareYards: "square-yards" }, oe$5 = { esriCentimeters: "centimeters", esriDecimeters: "decimeters", esriFeet: "feet", esriInches: "inches", esriKilometers: "kilometers", esriMeters: "meters", esriMiles: "miles", esriMillimeters: "millimeters", esriNauticalMiles: "nautical-miles", esriYards: "yards" }, le$4 = o$1_()(ce$4), me$3 = o$1_()(oe$5);
o$1_()(__spreadValues(__spreadValues({}, ce$4), oe$5));
function n$26(t2, a2) {
  return t2[0] = a2[0], t2[1] = a2[1], t2[2] = a2[2], t2[3] = a2[3], t2[4] = a2[4], t2[5] = a2[5], t2[6] = a2[6], t2[7] = a2[7], t2[8] = a2[8], t2[9] = a2[9], t2[10] = a2[10], t2[11] = a2[11], t2[12] = a2[12], t2[13] = a2[13], t2[14] = a2[14], t2[15] = a2[15], t2;
}
function s$1H(t2, a2, n2, s2, r2, o2, h2, e2, M2, u2, c2, i2, f2, b2, l2, m2, x2) {
  return t2[0] = a2, t2[1] = n2, t2[2] = s2, t2[3] = r2, t2[4] = o2, t2[5] = h2, t2[6] = e2, t2[7] = M2, t2[8] = u2, t2[9] = c2, t2[10] = i2, t2[11] = f2, t2[12] = b2, t2[13] = l2, t2[14] = m2, t2[15] = x2, t2;
}
function r$1o(t2) {
  return t2[0] = 1, t2[1] = 0, t2[2] = 0, t2[3] = 0, t2[4] = 0, t2[5] = 1, t2[6] = 0, t2[7] = 0, t2[8] = 0, t2[9] = 0, t2[10] = 1, t2[11] = 0, t2[12] = 0, t2[13] = 0, t2[14] = 0, t2[15] = 1, t2;
}
function o$1B(t2, a2) {
  if (t2 === a2) {
    const n2 = a2[1], s2 = a2[2], r2 = a2[3], o2 = a2[6], h2 = a2[7], e2 = a2[11];
    t2[1] = a2[4], t2[2] = a2[8], t2[3] = a2[12], t2[4] = n2, t2[6] = a2[9], t2[7] = a2[13], t2[8] = s2, t2[9] = o2, t2[11] = a2[14], t2[12] = r2, t2[13] = h2, t2[14] = e2;
  } else
    t2[0] = a2[0], t2[1] = a2[4], t2[2] = a2[8], t2[3] = a2[12], t2[4] = a2[1], t2[5] = a2[5], t2[6] = a2[9], t2[7] = a2[13], t2[8] = a2[2], t2[9] = a2[6], t2[10] = a2[10], t2[11] = a2[14], t2[12] = a2[3], t2[13] = a2[7], t2[14] = a2[11], t2[15] = a2[15];
  return t2;
}
function h$1e(t2, a2) {
  const n2 = a2[0], s2 = a2[1], r2 = a2[2], o2 = a2[3], h2 = a2[4], e2 = a2[5], M2 = a2[6], u2 = a2[7], c2 = a2[8], i2 = a2[9], f2 = a2[10], b2 = a2[11], l2 = a2[12], m2 = a2[13], x2 = a2[14], q2 = a2[15], g2 = n2 * e2 - s2 * h2, p2 = n2 * M2 - r2 * h2, d2 = n2 * u2 - o2 * h2, R2 = s2 * M2 - r2 * e2, S2 = s2 * u2 - o2 * e2, y2 = r2 * u2 - o2 * M2, T2 = c2 * m2 - i2 * l2, j2 = c2 * x2 - f2 * l2, v2 = c2 * q2 - b2 * l2, O2 = i2 * x2 - f2 * m2, P2 = i2 * q2 - b2 * m2, D2 = f2 * q2 - b2 * x2;
  let I2 = g2 * D2 - p2 * P2 + d2 * O2 + R2 * v2 - S2 * j2 + y2 * T2;
  return I2 ? (I2 = 1 / I2, t2[0] = (e2 * D2 - M2 * P2 + u2 * O2) * I2, t2[1] = (r2 * P2 - s2 * D2 - o2 * O2) * I2, t2[2] = (m2 * y2 - x2 * S2 + q2 * R2) * I2, t2[3] = (f2 * S2 - i2 * y2 - b2 * R2) * I2, t2[4] = (M2 * v2 - h2 * D2 - u2 * j2) * I2, t2[5] = (n2 * D2 - r2 * v2 + o2 * j2) * I2, t2[6] = (x2 * d2 - l2 * y2 - q2 * p2) * I2, t2[7] = (c2 * y2 - f2 * d2 + b2 * p2) * I2, t2[8] = (h2 * P2 - e2 * v2 + u2 * T2) * I2, t2[9] = (s2 * v2 - n2 * P2 - o2 * T2) * I2, t2[10] = (l2 * S2 - m2 * d2 + q2 * g2) * I2, t2[11] = (i2 * d2 - c2 * S2 - b2 * g2) * I2, t2[12] = (e2 * j2 - h2 * O2 - M2 * T2) * I2, t2[13] = (n2 * O2 - s2 * j2 + r2 * T2) * I2, t2[14] = (m2 * p2 - l2 * R2 - x2 * g2) * I2, t2[15] = (c2 * R2 - i2 * p2 + f2 * g2) * I2, t2) : null;
}
function e$1q(t2, a2) {
  const n2 = a2[0], s2 = a2[1], r2 = a2[2], o2 = a2[3], h2 = a2[4], e2 = a2[5], M2 = a2[6], u2 = a2[7], c2 = a2[8], i2 = a2[9], f2 = a2[10], b2 = a2[11], l2 = a2[12], m2 = a2[13], x2 = a2[14], q2 = a2[15];
  return t2[0] = e2 * (f2 * q2 - b2 * x2) - i2 * (M2 * q2 - u2 * x2) + m2 * (M2 * b2 - u2 * f2), t2[1] = -(s2 * (f2 * q2 - b2 * x2) - i2 * (r2 * q2 - o2 * x2) + m2 * (r2 * b2 - o2 * f2)), t2[2] = s2 * (M2 * q2 - u2 * x2) - e2 * (r2 * q2 - o2 * x2) + m2 * (r2 * u2 - o2 * M2), t2[3] = -(s2 * (M2 * b2 - u2 * f2) - e2 * (r2 * b2 - o2 * f2) + i2 * (r2 * u2 - o2 * M2)), t2[4] = -(h2 * (f2 * q2 - b2 * x2) - c2 * (M2 * q2 - u2 * x2) + l2 * (M2 * b2 - u2 * f2)), t2[5] = n2 * (f2 * q2 - b2 * x2) - c2 * (r2 * q2 - o2 * x2) + l2 * (r2 * b2 - o2 * f2), t2[6] = -(n2 * (M2 * q2 - u2 * x2) - h2 * (r2 * q2 - o2 * x2) + l2 * (r2 * u2 - o2 * M2)), t2[7] = n2 * (M2 * b2 - u2 * f2) - h2 * (r2 * b2 - o2 * f2) + c2 * (r2 * u2 - o2 * M2), t2[8] = h2 * (i2 * q2 - b2 * m2) - c2 * (e2 * q2 - u2 * m2) + l2 * (e2 * b2 - u2 * i2), t2[9] = -(n2 * (i2 * q2 - b2 * m2) - c2 * (s2 * q2 - o2 * m2) + l2 * (s2 * b2 - o2 * i2)), t2[10] = n2 * (e2 * q2 - u2 * m2) - h2 * (s2 * q2 - o2 * m2) + l2 * (s2 * u2 - o2 * e2), t2[11] = -(n2 * (e2 * b2 - u2 * i2) - h2 * (s2 * b2 - o2 * i2) + c2 * (s2 * u2 - o2 * e2)), t2[12] = -(h2 * (i2 * x2 - f2 * m2) - c2 * (e2 * x2 - M2 * m2) + l2 * (e2 * f2 - M2 * i2)), t2[13] = n2 * (i2 * x2 - f2 * m2) - c2 * (s2 * x2 - r2 * m2) + l2 * (s2 * f2 - r2 * i2), t2[14] = -(n2 * (e2 * x2 - M2 * m2) - h2 * (s2 * x2 - r2 * m2) + l2 * (s2 * M2 - r2 * e2)), t2[15] = n2 * (e2 * f2 - M2 * i2) - h2 * (s2 * f2 - r2 * i2) + c2 * (s2 * M2 - r2 * e2), t2;
}
function M$w(t2) {
  const a2 = t2[0], n2 = t2[1], s2 = t2[2], r2 = t2[3], o2 = t2[4], h2 = t2[5], e2 = t2[6], M2 = t2[7], u2 = t2[8], c2 = t2[9], i2 = t2[10], f2 = t2[11], b2 = t2[12], l2 = t2[13], m2 = t2[14], x2 = t2[15];
  return (a2 * h2 - n2 * o2) * (i2 * x2 - f2 * m2) - (a2 * e2 - s2 * o2) * (c2 * x2 - f2 * l2) + (a2 * M2 - r2 * o2) * (c2 * m2 - i2 * l2) + (n2 * e2 - s2 * h2) * (u2 * x2 - f2 * b2) - (n2 * M2 - r2 * h2) * (u2 * m2 - i2 * b2) + (s2 * M2 - r2 * e2) * (u2 * l2 - c2 * b2);
}
function u$1p(t2, a2, n2) {
  const s2 = a2[0], r2 = a2[1], o2 = a2[2], h2 = a2[3], e2 = a2[4], M2 = a2[5], u2 = a2[6], c2 = a2[7], i2 = a2[8], f2 = a2[9], b2 = a2[10], l2 = a2[11], m2 = a2[12], x2 = a2[13], q2 = a2[14], g2 = a2[15];
  let p2 = n2[0], d2 = n2[1], R2 = n2[2], S2 = n2[3];
  return t2[0] = p2 * s2 + d2 * e2 + R2 * i2 + S2 * m2, t2[1] = p2 * r2 + d2 * M2 + R2 * f2 + S2 * x2, t2[2] = p2 * o2 + d2 * u2 + R2 * b2 + S2 * q2, t2[3] = p2 * h2 + d2 * c2 + R2 * l2 + S2 * g2, p2 = n2[4], d2 = n2[5], R2 = n2[6], S2 = n2[7], t2[4] = p2 * s2 + d2 * e2 + R2 * i2 + S2 * m2, t2[5] = p2 * r2 + d2 * M2 + R2 * f2 + S2 * x2, t2[6] = p2 * o2 + d2 * u2 + R2 * b2 + S2 * q2, t2[7] = p2 * h2 + d2 * c2 + R2 * l2 + S2 * g2, p2 = n2[8], d2 = n2[9], R2 = n2[10], S2 = n2[11], t2[8] = p2 * s2 + d2 * e2 + R2 * i2 + S2 * m2, t2[9] = p2 * r2 + d2 * M2 + R2 * f2 + S2 * x2, t2[10] = p2 * o2 + d2 * u2 + R2 * b2 + S2 * q2, t2[11] = p2 * h2 + d2 * c2 + R2 * l2 + S2 * g2, p2 = n2[12], d2 = n2[13], R2 = n2[14], S2 = n2[15], t2[12] = p2 * s2 + d2 * e2 + R2 * i2 + S2 * m2, t2[13] = p2 * r2 + d2 * M2 + R2 * f2 + S2 * x2, t2[14] = p2 * o2 + d2 * u2 + R2 * b2 + S2 * q2, t2[15] = p2 * h2 + d2 * c2 + R2 * l2 + S2 * g2, t2;
}
function c$2f(t2, a2, n2) {
  const s2 = n2[0], r2 = n2[1], o2 = n2[2];
  if (a2 === t2)
    t2[12] = a2[0] * s2 + a2[4] * r2 + a2[8] * o2 + a2[12], t2[13] = a2[1] * s2 + a2[5] * r2 + a2[9] * o2 + a2[13], t2[14] = a2[2] * s2 + a2[6] * r2 + a2[10] * o2 + a2[14], t2[15] = a2[3] * s2 + a2[7] * r2 + a2[11] * o2 + a2[15];
  else {
    const n3 = a2[0], h2 = a2[1], e2 = a2[2], M2 = a2[3], u2 = a2[4], c2 = a2[5], i2 = a2[6], f2 = a2[7], b2 = a2[8], l2 = a2[9], m2 = a2[10], x2 = a2[11];
    t2[0] = n3, t2[1] = h2, t2[2] = e2, t2[3] = M2, t2[4] = u2, t2[5] = c2, t2[6] = i2, t2[7] = f2, t2[8] = b2, t2[9] = l2, t2[10] = m2, t2[11] = x2, t2[12] = n3 * s2 + u2 * r2 + b2 * o2 + a2[12], t2[13] = h2 * s2 + c2 * r2 + l2 * o2 + a2[13], t2[14] = e2 * s2 + i2 * r2 + m2 * o2 + a2[14], t2[15] = M2 * s2 + f2 * r2 + x2 * o2 + a2[15];
  }
  return t2;
}
function i$2c(t2, a2, n2) {
  const s2 = n2[0], r2 = n2[1], o2 = n2[2];
  return t2[0] = a2[0] * s2, t2[1] = a2[1] * s2, t2[2] = a2[2] * s2, t2[3] = a2[3] * s2, t2[4] = a2[4] * r2, t2[5] = a2[5] * r2, t2[6] = a2[6] * r2, t2[7] = a2[7] * r2, t2[8] = a2[8] * o2, t2[9] = a2[9] * o2, t2[10] = a2[10] * o2, t2[11] = a2[11] * o2, t2[12] = a2[12], t2[13] = a2[13], t2[14] = a2[14], t2[15] = a2[15], t2;
}
function f$1i(t2, n2, s2, r2) {
  let o2, h2, e2, M2, u2, c2, i2, f2, b2, l2, m2, x2, q2, g2, p2, d2, R2, S2, y2, T2, j2, v2, O2, P2, D2 = r2[0], I2 = r2[1], A2 = r2[2], _2 = Math.sqrt(D2 * D2 + I2 * I2 + A2 * A2);
  return _2 < a$2x() ? null : (_2 = 1 / _2, D2 *= _2, I2 *= _2, A2 *= _2, o2 = Math.sin(s2), h2 = Math.cos(s2), e2 = 1 - h2, M2 = n2[0], u2 = n2[1], c2 = n2[2], i2 = n2[3], f2 = n2[4], b2 = n2[5], l2 = n2[6], m2 = n2[7], x2 = n2[8], q2 = n2[9], g2 = n2[10], p2 = n2[11], d2 = D2 * D2 * e2 + h2, R2 = I2 * D2 * e2 + A2 * o2, S2 = A2 * D2 * e2 - I2 * o2, y2 = D2 * I2 * e2 - A2 * o2, T2 = I2 * I2 * e2 + h2, j2 = A2 * I2 * e2 + D2 * o2, v2 = D2 * A2 * e2 + I2 * o2, O2 = I2 * A2 * e2 - D2 * o2, P2 = A2 * A2 * e2 + h2, t2[0] = M2 * d2 + f2 * R2 + x2 * S2, t2[1] = u2 * d2 + b2 * R2 + q2 * S2, t2[2] = c2 * d2 + l2 * R2 + g2 * S2, t2[3] = i2 * d2 + m2 * R2 + p2 * S2, t2[4] = M2 * y2 + f2 * T2 + x2 * j2, t2[5] = u2 * y2 + b2 * T2 + q2 * j2, t2[6] = c2 * y2 + l2 * T2 + g2 * j2, t2[7] = i2 * y2 + m2 * T2 + p2 * j2, t2[8] = M2 * v2 + f2 * O2 + x2 * P2, t2[9] = u2 * v2 + b2 * O2 + q2 * P2, t2[10] = c2 * v2 + l2 * O2 + g2 * P2, t2[11] = i2 * v2 + m2 * O2 + p2 * P2, n2 !== t2 && (t2[12] = n2[12], t2[13] = n2[13], t2[14] = n2[14], t2[15] = n2[15]), t2);
}
function b$R(t2, a2, n2) {
  const s2 = Math.sin(n2), r2 = Math.cos(n2), o2 = a2[4], h2 = a2[5], e2 = a2[6], M2 = a2[7], u2 = a2[8], c2 = a2[9], i2 = a2[10], f2 = a2[11];
  return a2 !== t2 && (t2[0] = a2[0], t2[1] = a2[1], t2[2] = a2[2], t2[3] = a2[3], t2[12] = a2[12], t2[13] = a2[13], t2[14] = a2[14], t2[15] = a2[15]), t2[4] = o2 * r2 + u2 * s2, t2[5] = h2 * r2 + c2 * s2, t2[6] = e2 * r2 + i2 * s2, t2[7] = M2 * r2 + f2 * s2, t2[8] = u2 * r2 - o2 * s2, t2[9] = c2 * r2 - h2 * s2, t2[10] = i2 * r2 - e2 * s2, t2[11] = f2 * r2 - M2 * s2, t2;
}
function l$1M(t2, a2, n2) {
  const s2 = Math.sin(n2), r2 = Math.cos(n2), o2 = a2[0], h2 = a2[1], e2 = a2[2], M2 = a2[3], u2 = a2[8], c2 = a2[9], i2 = a2[10], f2 = a2[11];
  return a2 !== t2 && (t2[4] = a2[4], t2[5] = a2[5], t2[6] = a2[6], t2[7] = a2[7], t2[12] = a2[12], t2[13] = a2[13], t2[14] = a2[14], t2[15] = a2[15]), t2[0] = o2 * r2 - u2 * s2, t2[1] = h2 * r2 - c2 * s2, t2[2] = e2 * r2 - i2 * s2, t2[3] = M2 * r2 - f2 * s2, t2[8] = o2 * s2 + u2 * r2, t2[9] = h2 * s2 + c2 * r2, t2[10] = e2 * s2 + i2 * r2, t2[11] = M2 * s2 + f2 * r2, t2;
}
function m$1G(t2, a2, n2) {
  const s2 = Math.sin(n2), r2 = Math.cos(n2), o2 = a2[0], h2 = a2[1], e2 = a2[2], M2 = a2[3], u2 = a2[4], c2 = a2[5], i2 = a2[6], f2 = a2[7];
  return a2 !== t2 && (t2[8] = a2[8], t2[9] = a2[9], t2[10] = a2[10], t2[11] = a2[11], t2[12] = a2[12], t2[13] = a2[13], t2[14] = a2[14], t2[15] = a2[15]), t2[0] = o2 * r2 + u2 * s2, t2[1] = h2 * r2 + c2 * s2, t2[2] = e2 * r2 + i2 * s2, t2[3] = M2 * r2 + f2 * s2, t2[4] = u2 * r2 - o2 * s2, t2[5] = c2 * r2 - h2 * s2, t2[6] = i2 * r2 - e2 * s2, t2[7] = f2 * r2 - M2 * s2, t2;
}
function x$L(t2, a2) {
  return t2[0] = 1, t2[1] = 0, t2[2] = 0, t2[3] = 0, t2[4] = 0, t2[5] = 1, t2[6] = 0, t2[7] = 0, t2[8] = 0, t2[9] = 0, t2[10] = 1, t2[11] = 0, t2[12] = a2[0], t2[13] = a2[1], t2[14] = a2[2], t2[15] = 1, t2;
}
function q$k(t2, a2) {
  return t2[0] = a2[0], t2[1] = 0, t2[2] = 0, t2[3] = 0, t2[4] = 0, t2[5] = a2[1], t2[6] = 0, t2[7] = 0, t2[8] = 0, t2[9] = 0, t2[10] = a2[2], t2[11] = 0, t2[12] = 0, t2[13] = 0, t2[14] = 0, t2[15] = 1, t2;
}
function g$Y(t2, n2, s2) {
  if (n2 === 0)
    return r$1o(t2);
  let o2, h2, e2, M2 = s2[0], u2 = s2[1], c2 = s2[2], i2 = Math.sqrt(M2 * M2 + u2 * u2 + c2 * c2);
  return i2 < a$2x() ? null : (i2 = 1 / i2, M2 *= i2, u2 *= i2, c2 *= i2, o2 = Math.sin(n2), h2 = Math.cos(n2), e2 = 1 - h2, t2[0] = M2 * M2 * e2 + h2, t2[1] = u2 * M2 * e2 + c2 * o2, t2[2] = c2 * M2 * e2 - u2 * o2, t2[3] = 0, t2[4] = M2 * u2 * e2 - c2 * o2, t2[5] = u2 * u2 * e2 + h2, t2[6] = c2 * u2 * e2 + M2 * o2, t2[7] = 0, t2[8] = M2 * c2 * e2 + u2 * o2, t2[9] = u2 * c2 * e2 - M2 * o2, t2[10] = c2 * c2 * e2 + h2, t2[11] = 0, t2[12] = 0, t2[13] = 0, t2[14] = 0, t2[15] = 1, t2);
}
function p$2w(t2, a2) {
  const n2 = Math.sin(a2), s2 = Math.cos(a2);
  return t2[0] = 1, t2[1] = 0, t2[2] = 0, t2[3] = 0, t2[4] = 0, t2[5] = s2, t2[6] = n2, t2[7] = 0, t2[8] = 0, t2[9] = -n2, t2[10] = s2, t2[11] = 0, t2[12] = 0, t2[13] = 0, t2[14] = 0, t2[15] = 1, t2;
}
function d$1k(t2, a2) {
  const n2 = Math.sin(a2), s2 = Math.cos(a2);
  return t2[0] = s2, t2[1] = 0, t2[2] = -n2, t2[3] = 0, t2[4] = 0, t2[5] = 1, t2[6] = 0, t2[7] = 0, t2[8] = n2, t2[9] = 0, t2[10] = s2, t2[11] = 0, t2[12] = 0, t2[13] = 0, t2[14] = 0, t2[15] = 1, t2;
}
function R$s(t2, a2) {
  const n2 = Math.sin(a2), s2 = Math.cos(a2);
  return t2[0] = s2, t2[1] = n2, t2[2] = 0, t2[3] = 0, t2[4] = -n2, t2[5] = s2, t2[6] = 0, t2[7] = 0, t2[8] = 0, t2[9] = 0, t2[10] = 1, t2[11] = 0, t2[12] = 0, t2[13] = 0, t2[14] = 0, t2[15] = 1, t2;
}
function S$E(t2, a2, n2) {
  const s2 = a2[0], r2 = a2[1], o2 = a2[2], h2 = a2[3], e2 = s2 + s2, M2 = r2 + r2, u2 = o2 + o2, c2 = s2 * e2, i2 = s2 * M2, f2 = s2 * u2, b2 = r2 * M2, l2 = r2 * u2, m2 = o2 * u2, x2 = h2 * e2, q2 = h2 * M2, g2 = h2 * u2;
  return t2[0] = 1 - (b2 + m2), t2[1] = i2 + g2, t2[2] = f2 - q2, t2[3] = 0, t2[4] = i2 - g2, t2[5] = 1 - (c2 + m2), t2[6] = l2 + x2, t2[7] = 0, t2[8] = f2 + q2, t2[9] = l2 - x2, t2[10] = 1 - (c2 + b2), t2[11] = 0, t2[12] = n2[0], t2[13] = n2[1], t2[14] = n2[2], t2[15] = 1, t2;
}
function y$17(t2, a2) {
  const n2 = T$v, s2 = -a2[0], r2 = -a2[1], o2 = -a2[2], h2 = a2[3], e2 = a2[4], M2 = a2[5], u2 = a2[6], c2 = a2[7], i2 = s2 * s2 + r2 * r2 + o2 * o2 + h2 * h2;
  return i2 > 0 ? (n2[0] = 2 * (e2 * h2 + c2 * s2 + M2 * o2 - u2 * r2) / i2, n2[1] = 2 * (M2 * h2 + c2 * r2 + u2 * s2 - e2 * o2) / i2, n2[2] = 2 * (u2 * h2 + c2 * o2 + e2 * r2 - M2 * s2) / i2) : (n2[0] = 2 * (e2 * h2 + c2 * s2 + M2 * o2 - u2 * r2), n2[1] = 2 * (M2 * h2 + c2 * r2 + u2 * s2 - e2 * o2), n2[2] = 2 * (u2 * h2 + c2 * o2 + e2 * r2 - M2 * s2)), S$E(t2, a2, n2), t2;
}
const T$v = n$2v();
function j$F(t2, a2) {
  return t2[0] = a2[12], t2[1] = a2[13], t2[2] = a2[14], t2;
}
function v$U(t2, a2) {
  const n2 = a2[0], s2 = a2[1], r2 = a2[2], o2 = a2[4], h2 = a2[5], e2 = a2[6], M2 = a2[8], u2 = a2[9], c2 = a2[10];
  return t2[0] = Math.sqrt(n2 * n2 + s2 * s2 + r2 * r2), t2[1] = Math.sqrt(o2 * o2 + h2 * h2 + e2 * e2), t2[2] = Math.sqrt(M2 * M2 + u2 * u2 + c2 * c2), t2;
}
function O$t(t2, a2) {
  const n2 = a2[0] + a2[5] + a2[10];
  let s2 = 0;
  return n2 > 0 ? (s2 = 2 * Math.sqrt(n2 + 1), t2[3] = 0.25 * s2, t2[0] = (a2[6] - a2[9]) / s2, t2[1] = (a2[8] - a2[2]) / s2, t2[2] = (a2[1] - a2[4]) / s2) : a2[0] > a2[5] && a2[0] > a2[10] ? (s2 = 2 * Math.sqrt(1 + a2[0] - a2[5] - a2[10]), t2[3] = (a2[6] - a2[9]) / s2, t2[0] = 0.25 * s2, t2[1] = (a2[1] + a2[4]) / s2, t2[2] = (a2[8] + a2[2]) / s2) : a2[5] > a2[10] ? (s2 = 2 * Math.sqrt(1 + a2[5] - a2[0] - a2[10]), t2[3] = (a2[8] - a2[2]) / s2, t2[0] = (a2[1] + a2[4]) / s2, t2[1] = 0.25 * s2, t2[2] = (a2[6] + a2[9]) / s2) : (s2 = 2 * Math.sqrt(1 + a2[10] - a2[0] - a2[5]), t2[3] = (a2[1] - a2[4]) / s2, t2[0] = (a2[8] + a2[2]) / s2, t2[1] = (a2[6] + a2[9]) / s2, t2[2] = 0.25 * s2), t2;
}
function P$s(t2, a2, n2, s2) {
  const r2 = a2[0], o2 = a2[1], h2 = a2[2], e2 = a2[3], M2 = r2 + r2, u2 = o2 + o2, c2 = h2 + h2, i2 = r2 * M2, f2 = r2 * u2, b2 = r2 * c2, l2 = o2 * u2, m2 = o2 * c2, x2 = h2 * c2, q2 = e2 * M2, g2 = e2 * u2, p2 = e2 * c2, d2 = s2[0], R2 = s2[1], S2 = s2[2];
  return t2[0] = (1 - (l2 + x2)) * d2, t2[1] = (f2 + p2) * d2, t2[2] = (b2 - g2) * d2, t2[3] = 0, t2[4] = (f2 - p2) * R2, t2[5] = (1 - (i2 + x2)) * R2, t2[6] = (m2 + q2) * R2, t2[7] = 0, t2[8] = (b2 + g2) * S2, t2[9] = (m2 - q2) * S2, t2[10] = (1 - (i2 + l2)) * S2, t2[11] = 0, t2[12] = n2[0], t2[13] = n2[1], t2[14] = n2[2], t2[15] = 1, t2;
}
function D$o(t2, a2, n2, s2, r2) {
  const o2 = a2[0], h2 = a2[1], e2 = a2[2], M2 = a2[3], u2 = o2 + o2, c2 = h2 + h2, i2 = e2 + e2, f2 = o2 * u2, b2 = o2 * c2, l2 = o2 * i2, m2 = h2 * c2, x2 = h2 * i2, q2 = e2 * i2, g2 = M2 * u2, p2 = M2 * c2, d2 = M2 * i2, R2 = s2[0], S2 = s2[1], y2 = s2[2], T2 = r2[0], j2 = r2[1], v2 = r2[2], O2 = (1 - (m2 + q2)) * R2, P2 = (b2 + d2) * R2, D2 = (l2 - p2) * R2, I2 = (b2 - d2) * S2, A2 = (1 - (f2 + q2)) * S2, _2 = (x2 + g2) * S2, w2 = (l2 + p2) * y2, F2 = (x2 - g2) * y2, Q2 = (1 - (f2 + m2)) * y2;
  return t2[0] = O2, t2[1] = P2, t2[2] = D2, t2[3] = 0, t2[4] = I2, t2[5] = A2, t2[6] = _2, t2[7] = 0, t2[8] = w2, t2[9] = F2, t2[10] = Q2, t2[11] = 0, t2[12] = n2[0] + T2 - (O2 * T2 + I2 * j2 + w2 * v2), t2[13] = n2[1] + j2 - (P2 * T2 + A2 * j2 + F2 * v2), t2[14] = n2[2] + v2 - (D2 * T2 + _2 * j2 + Q2 * v2), t2[15] = 1, t2;
}
function I$y(t2, a2) {
  const n2 = a2[0], s2 = a2[1], r2 = a2[2], o2 = a2[3], h2 = n2 + n2, e2 = s2 + s2, M2 = r2 + r2, u2 = n2 * h2, c2 = s2 * h2, i2 = s2 * e2, f2 = r2 * h2, b2 = r2 * e2, l2 = r2 * M2, m2 = o2 * h2, x2 = o2 * e2, q2 = o2 * M2;
  return t2[0] = 1 - i2 - l2, t2[1] = c2 + q2, t2[2] = f2 - x2, t2[3] = 0, t2[4] = c2 - q2, t2[5] = 1 - u2 - l2, t2[6] = b2 + m2, t2[7] = 0, t2[8] = f2 + x2, t2[9] = b2 - m2, t2[10] = 1 - u2 - i2, t2[11] = 0, t2[12] = 0, t2[13] = 0, t2[14] = 0, t2[15] = 1, t2;
}
function A$q(t2, a2, n2, s2, r2, o2, h2) {
  const e2 = 1 / (n2 - a2), M2 = 1 / (r2 - s2), u2 = 1 / (o2 - h2);
  return t2[0] = 2 * o2 * e2, t2[1] = 0, t2[2] = 0, t2[3] = 0, t2[4] = 0, t2[5] = 2 * o2 * M2, t2[6] = 0, t2[7] = 0, t2[8] = (n2 + a2) * e2, t2[9] = (r2 + s2) * M2, t2[10] = (h2 + o2) * u2, t2[11] = -1, t2[12] = 0, t2[13] = 0, t2[14] = h2 * o2 * 2 * u2, t2[15] = 0, t2;
}
function _$C(t2, a2, n2, s2, r2) {
  const o2 = 1 / Math.tan(a2 / 2);
  let h2;
  return t2[0] = o2 / n2, t2[1] = 0, t2[2] = 0, t2[3] = 0, t2[4] = 0, t2[5] = o2, t2[6] = 0, t2[7] = 0, t2[8] = 0, t2[9] = 0, t2[11] = -1, t2[12] = 0, t2[13] = 0, t2[15] = 0, r2 != null && r2 !== 1 / 0 ? (h2 = 1 / (s2 - r2), t2[10] = (r2 + s2) * h2, t2[14] = 2 * r2 * s2 * h2) : (t2[10] = -1, t2[14] = -2 * s2), t2;
}
function w$N(t2, a2, n2, s2) {
  const r2 = Math.tan(a2.upDegrees * Math.PI / 180), o2 = Math.tan(a2.downDegrees * Math.PI / 180), h2 = Math.tan(a2.leftDegrees * Math.PI / 180), e2 = Math.tan(a2.rightDegrees * Math.PI / 180), M2 = 2 / (h2 + e2), u2 = 2 / (r2 + o2);
  return t2[0] = M2, t2[1] = 0, t2[2] = 0, t2[3] = 0, t2[4] = 0, t2[5] = u2, t2[6] = 0, t2[7] = 0, t2[8] = -(h2 - e2) * M2 * 0.5, t2[9] = (r2 - o2) * u2 * 0.5, t2[10] = s2 / (n2 - s2), t2[11] = -1, t2[12] = 0, t2[13] = 0, t2[14] = s2 * n2 / (n2 - s2), t2[15] = 0, t2;
}
function F$s(t2, a2, n2, s2, r2, o2, h2) {
  const e2 = 1 / (a2 - n2), M2 = 1 / (s2 - r2), u2 = 1 / (o2 - h2);
  return t2[0] = -2 * e2, t2[1] = 0, t2[2] = 0, t2[3] = 0, t2[4] = 0, t2[5] = -2 * M2, t2[6] = 0, t2[7] = 0, t2[8] = 0, t2[9] = 0, t2[10] = 2 * u2, t2[11] = 0, t2[12] = (a2 + n2) * e2, t2[13] = (r2 + s2) * M2, t2[14] = (h2 + o2) * u2, t2[15] = 1, t2;
}
function Q$e(t2, n2, s2, o2) {
  let h2, e2, M2, u2, c2, i2, f2, b2, l2, m2;
  const x2 = n2[0], q2 = n2[1], g2 = n2[2], p2 = o2[0], d2 = o2[1], R2 = o2[2], S2 = s2[0], y2 = s2[1], T2 = s2[2], j2 = a$2x();
  return Math.abs(x2 - S2) < j2 && Math.abs(q2 - y2) < j2 && Math.abs(g2 - T2) < j2 ? r$1o(t2) : (f2 = x2 - S2, b2 = q2 - y2, l2 = g2 - T2, m2 = 1 / Math.sqrt(f2 * f2 + b2 * b2 + l2 * l2), f2 *= m2, b2 *= m2, l2 *= m2, h2 = d2 * l2 - R2 * b2, e2 = R2 * f2 - p2 * l2, M2 = p2 * b2 - d2 * f2, m2 = Math.sqrt(h2 * h2 + e2 * e2 + M2 * M2), m2 ? (m2 = 1 / m2, h2 *= m2, e2 *= m2, M2 *= m2) : (h2 = 0, e2 = 0, M2 = 0), u2 = b2 * M2 - l2 * e2, c2 = l2 * h2 - f2 * M2, i2 = f2 * e2 - b2 * h2, m2 = Math.sqrt(u2 * u2 + c2 * c2 + i2 * i2), m2 ? (m2 = 1 / m2, u2 *= m2, c2 *= m2, i2 *= m2) : (u2 = 0, c2 = 0, i2 = 0), t2[0] = h2, t2[1] = u2, t2[2] = f2, t2[3] = 0, t2[4] = e2, t2[5] = c2, t2[6] = b2, t2[7] = 0, t2[8] = M2, t2[9] = i2, t2[10] = l2, t2[11] = 0, t2[12] = -(h2 * x2 + e2 * q2 + M2 * g2), t2[13] = -(u2 * x2 + c2 * q2 + i2 * g2), t2[14] = -(f2 * x2 + b2 * q2 + l2 * g2), t2[15] = 1, t2);
}
function k$s(t2, a2, n2, s2) {
  const r2 = a2[0], o2 = a2[1], h2 = a2[2], e2 = s2[0], M2 = s2[1], u2 = s2[2];
  let c2 = r2 - n2[0], i2 = o2 - n2[1], f2 = h2 - n2[2], b2 = c2 * c2 + i2 * i2 + f2 * f2;
  b2 > 0 && (b2 = 1 / Math.sqrt(b2), c2 *= b2, i2 *= b2, f2 *= b2);
  let l2 = M2 * f2 - u2 * i2, m2 = u2 * c2 - e2 * f2, x2 = e2 * i2 - M2 * c2;
  return b2 = l2 * l2 + m2 * m2 + x2 * x2, b2 > 0 && (b2 = 1 / Math.sqrt(b2), l2 *= b2, m2 *= b2, x2 *= b2), t2[0] = l2, t2[1] = m2, t2[2] = x2, t2[3] = 0, t2[4] = i2 * x2 - f2 * m2, t2[5] = f2 * l2 - c2 * x2, t2[6] = c2 * m2 - i2 * l2, t2[7] = 0, t2[8] = c2, t2[9] = i2, t2[10] = f2, t2[11] = 0, t2[12] = r2, t2[13] = o2, t2[14] = h2, t2[15] = 1, t2;
}
function z$z(t2) {
  return "mat4(" + t2[0] + ", " + t2[1] + ", " + t2[2] + ", " + t2[3] + ", " + t2[4] + ", " + t2[5] + ", " + t2[6] + ", " + t2[7] + ", " + t2[8] + ", " + t2[9] + ", " + t2[10] + ", " + t2[11] + ", " + t2[12] + ", " + t2[13] + ", " + t2[14] + ", " + t2[15] + ")";
}
function E$D(t2) {
  return Math.sqrt(t2[0] ** 2 + t2[1] ** 2 + t2[2] ** 2 + t2[3] ** 2 + t2[4] ** 2 + t2[5] ** 2 + t2[6] ** 2 + t2[7] ** 2 + t2[8] ** 2 + t2[9] ** 2 + t2[10] ** 2 + t2[11] ** 2 + t2[12] ** 2 + t2[13] ** 2 + t2[14] ** 2 + t2[15] ** 2);
}
function N$o(t2, a2, n2) {
  return t2[0] = a2[0] + n2[0], t2[1] = a2[1] + n2[1], t2[2] = a2[2] + n2[2], t2[3] = a2[3] + n2[3], t2[4] = a2[4] + n2[4], t2[5] = a2[5] + n2[5], t2[6] = a2[6] + n2[6], t2[7] = a2[7] + n2[7], t2[8] = a2[8] + n2[8], t2[9] = a2[9] + n2[9], t2[10] = a2[10] + n2[10], t2[11] = a2[11] + n2[11], t2[12] = a2[12] + n2[12], t2[13] = a2[13] + n2[13], t2[14] = a2[14] + n2[14], t2[15] = a2[15] + n2[15], t2;
}
function X$b(t2, a2, n2) {
  return t2[0] = a2[0] - n2[0], t2[1] = a2[1] - n2[1], t2[2] = a2[2] - n2[2], t2[3] = a2[3] - n2[3], t2[4] = a2[4] - n2[4], t2[5] = a2[5] - n2[5], t2[6] = a2[6] - n2[6], t2[7] = a2[7] - n2[7], t2[8] = a2[8] - n2[8], t2[9] = a2[9] - n2[9], t2[10] = a2[10] - n2[10], t2[11] = a2[11] - n2[11], t2[12] = a2[12] - n2[12], t2[13] = a2[13] - n2[13], t2[14] = a2[14] - n2[14], t2[15] = a2[15] - n2[15], t2;
}
function Y$b(t2, a2, n2) {
  return t2[0] = a2[0] * n2, t2[1] = a2[1] * n2, t2[2] = a2[2] * n2, t2[3] = a2[3] * n2, t2[4] = a2[4] * n2, t2[5] = a2[5] * n2, t2[6] = a2[6] * n2, t2[7] = a2[7] * n2, t2[8] = a2[8] * n2, t2[9] = a2[9] * n2, t2[10] = a2[10] * n2, t2[11] = a2[11] * n2, t2[12] = a2[12] * n2, t2[13] = a2[13] * n2, t2[14] = a2[14] * n2, t2[15] = a2[15] * n2, t2;
}
function Z$d(t2, a2, n2, s2) {
  return t2[0] = a2[0] + n2[0] * s2, t2[1] = a2[1] + n2[1] * s2, t2[2] = a2[2] + n2[2] * s2, t2[3] = a2[3] + n2[3] * s2, t2[4] = a2[4] + n2[4] * s2, t2[5] = a2[5] + n2[5] * s2, t2[6] = a2[6] + n2[6] * s2, t2[7] = a2[7] + n2[7] * s2, t2[8] = a2[8] + n2[8] * s2, t2[9] = a2[9] + n2[9] * s2, t2[10] = a2[10] + n2[10] * s2, t2[11] = a2[11] + n2[11] * s2, t2[12] = a2[12] + n2[12] * s2, t2[13] = a2[13] + n2[13] * s2, t2[14] = a2[14] + n2[14] * s2, t2[15] = a2[15] + n2[15] * s2, t2;
}
function B$n(t2, a2) {
  return t2[0] === a2[0] && t2[1] === a2[1] && t2[2] === a2[2] && t2[3] === a2[3] && t2[4] === a2[4] && t2[5] === a2[5] && t2[6] === a2[6] && t2[7] === a2[7] && t2[8] === a2[8] && t2[9] === a2[9] && t2[10] === a2[10] && t2[11] === a2[11] && t2[12] === a2[12] && t2[13] === a2[13] && t2[14] === a2[14] && t2[15] === a2[15];
}
function C$v(t2, n2) {
  if (t2 === n2)
    return true;
  const s2 = t2[0], r2 = t2[1], o2 = t2[2], h2 = t2[3], e2 = t2[4], M2 = t2[5], u2 = t2[6], c2 = t2[7], i2 = t2[8], f2 = t2[9], b2 = t2[10], l2 = t2[11], m2 = t2[12], x2 = t2[13], q2 = t2[14], g2 = t2[15], p2 = n2[0], d2 = n2[1], R2 = n2[2], S2 = n2[3], y2 = n2[4], T2 = n2[5], j2 = n2[6], v2 = n2[7], O2 = n2[8], P2 = n2[9], D2 = n2[10], I2 = n2[11], A2 = n2[12], _2 = n2[13], w2 = n2[14], F2 = n2[15], Q2 = a$2x();
  return Math.abs(s2 - p2) <= Q2 * Math.max(1, Math.abs(s2), Math.abs(p2)) && Math.abs(r2 - d2) <= Q2 * Math.max(1, Math.abs(r2), Math.abs(d2)) && Math.abs(o2 - R2) <= Q2 * Math.max(1, Math.abs(o2), Math.abs(R2)) && Math.abs(h2 - S2) <= Q2 * Math.max(1, Math.abs(h2), Math.abs(S2)) && Math.abs(e2 - y2) <= Q2 * Math.max(1, Math.abs(e2), Math.abs(y2)) && Math.abs(M2 - T2) <= Q2 * Math.max(1, Math.abs(M2), Math.abs(T2)) && Math.abs(u2 - j2) <= Q2 * Math.max(1, Math.abs(u2), Math.abs(j2)) && Math.abs(c2 - v2) <= Q2 * Math.max(1, Math.abs(c2), Math.abs(v2)) && Math.abs(i2 - O2) <= Q2 * Math.max(1, Math.abs(i2), Math.abs(O2)) && Math.abs(f2 - P2) <= Q2 * Math.max(1, Math.abs(f2), Math.abs(P2)) && Math.abs(b2 - D2) <= Q2 * Math.max(1, Math.abs(b2), Math.abs(D2)) && Math.abs(l2 - I2) <= Q2 * Math.max(1, Math.abs(l2), Math.abs(I2)) && Math.abs(m2 - A2) <= Q2 * Math.max(1, Math.abs(m2), Math.abs(A2)) && Math.abs(x2 - _2) <= Q2 * Math.max(1, Math.abs(x2), Math.abs(_2)) && Math.abs(q2 - w2) <= Q2 * Math.max(1, Math.abs(q2), Math.abs(w2)) && Math.abs(g2 - F2) <= Q2 * Math.max(1, Math.abs(g2), Math.abs(F2));
}
function G$l(t2) {
  const n2 = a$2x(), s2 = t2[0], r2 = t2[1], o2 = t2[2], h2 = t2[4], e2 = t2[5], M2 = t2[6], u2 = t2[8], c2 = t2[9], i2 = t2[10];
  return Math.abs(1 - (s2 * s2 + h2 * h2 + u2 * u2)) <= n2 && Math.abs(1 - (r2 * r2 + e2 * e2 + c2 * c2)) <= n2 && Math.abs(1 - (o2 * o2 + M2 * M2 + i2 * i2)) <= n2;
}
const H$h = u$1p, J$l = X$b;
Object.freeze(Object.defineProperty({ __proto__: null, copy: n$26, set: s$1H, identity: r$1o, transpose: o$1B, invert: h$1e, adjoint: e$1q, determinant: M$w, multiply: u$1p, translate: c$2f, scale: i$2c, rotate: f$1i, rotateX: b$R, rotateY: l$1M, rotateZ: m$1G, fromTranslation: x$L, fromScaling: q$k, fromRotation: g$Y, fromXRotation: p$2w, fromYRotation: d$1k, fromZRotation: R$s, fromRotationTranslation: S$E, fromQuat2: y$17, getTranslation: j$F, getScaling: v$U, getRotation: O$t, fromRotationTranslationScale: P$s, fromRotationTranslationScaleOrigin: D$o, fromQuat: I$y, frustum: A$q, perspective: _$C, perspectiveFromFieldOfView: w$N, ortho: F$s, lookAt: Q$e, targetTo: k$s, str: z$z, frob: E$D, add: N$o, subtract: X$b, multiplyScalar: Y$b, multiplyScalarAndAdd: Z$d, exactEquals: B$n, equals: C$v, isOrthoNormal: G$l, mul: H$h, sub: J$l }, Symbol.toStringTag, { value: "Module" }));
let t$1C, o$1A = null;
function r$1n() {
  return !!o$1A;
}
function n$25() {
  return !!has("esri-wasm");
}
function _$B() {
  return t$1C || (t$1C = import("./pe-wasm.js").then((e2) => e2.p).then(({ default: t2 }) => t2({ locateFile: (t3) => a$28(`esri/geometry/support/${t3}`) })).then((e2) => {
    S$D(e2);
  }), t$1C);
}
var P$r, s$1G, E$C;
!function(e2) {
  function t2(e3, t3, r3) {
    o$1A.ensureCache.prepare();
    const n3 = M$v(r3), _3 = r3 === n3, P2 = o$1A.ensureFloat64(n3), s2 = o$1A._pe_geog_to_proj(o$1A.getPointer(e3), t3, P2);
    return s2 && A$p(r3, t3, P2, _3), s2;
  }
  function r2(e3, o2, r3, _3) {
    switch (_3) {
      case s$1G.PE_TRANSFORM_P_TO_G:
        return n2(e3, o2, r3);
      case s$1G.PE_TRANSFORM_G_TO_P:
        return t2(e3, o2, r3);
    }
    return 0;
  }
  function n2(e3, t3, o2) {
    return _2(e3, t3, o2, 0);
  }
  function _2(e3, t3, r3, n3) {
    o$1A.ensureCache.prepare();
    const _3 = M$v(r3), P2 = r3 === _3, s2 = o$1A.ensureFloat64(_3), E2 = o$1A._pe_proj_to_geog_center(o$1A.getPointer(e3), t3, s2, n3);
    return E2 && A$p(r3, t3, s2, P2), E2;
  }
  e2.geogToProj = t2, e2.projGeog = r2, e2.projToGeog = n2, e2.projToGeogCenter = _2;
}(P$r || (P$r = {})), function(e2) {
  function t2() {
    e2.PE_BUFFER_MAX = o$1A.PeDefs.prototype.PE_BUFFER_MAX, e2.PE_NAME_MAX = o$1A.PeDefs.prototype.PE_NAME_MAX, e2.PE_MGRS_MAX = o$1A.PeDefs.prototype.PE_MGRS_MAX, e2.PE_USNG_MAX = o$1A.PeDefs.prototype.PE_USNG_MAX, e2.PE_DD_MAX = o$1A.PeDefs.prototype.PE_DD_MAX, e2.PE_DDM_MAX = o$1A.PeDefs.prototype.PE_DDM_MAX, e2.PE_DMS_MAX = o$1A.PeDefs.prototype.PE_DMS_MAX, e2.PE_UTM_MAX = o$1A.PeDefs.prototype.PE_UTM_MAX, e2.PE_PARM_MAX = o$1A.PeDefs.prototype.PE_PARM_MAX, e2.PE_TYPE_NONE = o$1A.PeDefs.prototype.PE_TYPE_NONE, e2.PE_TYPE_GEOGCS = o$1A.PeDefs.prototype.PE_TYPE_GEOGCS, e2.PE_TYPE_PROJCS = o$1A.PeDefs.prototype.PE_TYPE_PROJCS, e2.PE_TYPE_GEOGTRAN = o$1A.PeDefs.prototype.PE_TYPE_GEOGTRAN, e2.PE_TYPE_COORDSYS = o$1A.PeDefs.prototype.PE_TYPE_COORDSYS, e2.PE_TYPE_UNIT = o$1A.PeDefs.prototype.PE_TYPE_UNIT, e2.PE_TYPE_LINUNIT = o$1A.PeDefs.prototype.PE_TYPE_LINUNIT, e2.PE_STR_OPTS_NONE = o$1A.PeDefs.prototype.PE_STR_OPTS_NONE, e2.PE_STR_AUTH_NONE = o$1A.PeDefs.prototype.PE_STR_AUTH_NONE, e2.PE_STR_AUTH_TOP = o$1A.PeDefs.prototype.PE_STR_AUTH_TOP, e2.PE_STR_NAME_CANON = o$1A.PeDefs.prototype.PE_STR_NAME_CANON, e2.PE_PARM_X0 = o$1A.PeDefs.prototype.PE_PARM_X0, e2.PE_PARM_ND = o$1A.PeDefs.prototype.PE_PARM_ND, e2.PE_TRANSFORM_1_TO_2 = o$1A.PeDefs.prototype.PE_TRANSFORM_1_TO_2, e2.PE_TRANSFORM_2_TO_1 = o$1A.PeDefs.prototype.PE_TRANSFORM_2_TO_1, e2.PE_TRANSFORM_P_TO_G = o$1A.PeDefs.prototype.PE_TRANSFORM_P_TO_G, e2.PE_TRANSFORM_G_TO_P = o$1A.PeDefs.prototype.PE_TRANSFORM_G_TO_P, e2.PE_HORIZON_RECT = o$1A.PeDefs.prototype.PE_HORIZON_RECT, e2.PE_HORIZON_POLY = o$1A.PeDefs.prototype.PE_HORIZON_POLY, e2.PE_HORIZON_LINE = o$1A.PeDefs.prototype.PE_HORIZON_LINE, e2.PE_HORIZON_DELTA = o$1A.PeDefs.prototype.PE_HORIZON_DELTA;
  }
  e2.init = t2;
}(s$1G || (s$1G = {})), function(e2) {
  const t2 = {}, r2 = {}, n2 = (e3) => {
    if (e3) {
      const t3 = e3.getType();
      switch (t3) {
        case s$1G.PE_TYPE_GEOGCS:
          e3 = o$1A.castObject(e3, o$1A.PeGeogcs);
          break;
        case s$1G.PE_TYPE_PROJCS:
          e3 = o$1A.castObject(e3, o$1A.PeProjcs);
          break;
        case s$1G.PE_TYPE_GEOGTRAN:
          e3 = o$1A.castObject(e3, o$1A.PeGeogtran);
          break;
        default:
          t3 & s$1G.PE_TYPE_UNIT && (e3 = o$1A.castObject(e3, o$1A.PeUnit));
      }
    }
    return e3;
  };
  function _2() {
    o$1A.PeFactory.prototype.initialize(null);
  }
  function P2(e3) {
    return E2(s$1G.PE_TYPE_COORDSYS, e3);
  }
  function E2(e3, r3) {
    let _3 = null, P3 = t2[e3];
    if (P3 || (P3 = {}, t2[e3] = P3), P3.hasOwnProperty(String(r3)))
      _3 = P3[r3];
    else {
      const t3 = o$1A.PeFactory.prototype.factoryByType(e3, r3);
      o$1A.compare(t3, o$1A.NULL) || (_3 = t3, P3[r3] = _3);
    }
    return _3 = n2(_3), _3;
  }
  function i2(e3, t3) {
    let _3 = null, P3 = r2[e3];
    if (P3 || (P3 = {}, r2[e3] = P3), P3.hasOwnProperty(t3))
      _3 = P3[t3];
    else {
      const r3 = o$1A.PeFactory.prototype.fromString(e3, t3);
      o$1A.compare(r3, o$1A.NULL) || (_3 = r3, P3[t3] = _3);
    }
    return _3 = n2(_3), _3;
  }
  function p2(e3) {
    return E2(s$1G.PE_TYPE_GEOGCS, e3);
  }
  function u2(e3) {
    return E2(s$1G.PE_TYPE_GEOGTRAN, e3);
  }
  function a2(e3) {
    return o$1A.PeFactory.prototype.getCode(e3);
  }
  function c2(e3) {
    return E2(s$1G.PE_TYPE_PROJCS, e3);
  }
  function g2(e3) {
    return E2(s$1G.PE_TYPE_UNIT, e3);
  }
  e2.initialize = _2, e2.coordsys = P2, e2.factoryByType = E2, e2.fromString = i2, e2.geogcs = p2, e2.geogtran = u2, e2.getCode = a2, e2.projcs = c2, e2.unit = g2;
}(E$C || (E$C = {}));
let i$2b = null;
var p$2v, u$1o, a$21, c$2e, g$X, T$u, f$1h, O$s, l$1L;
function S$D(e2) {
  function t2(e3, t3, o2) {
    e3[t3] = o2(e3[t3]);
  }
  o$1A = e2, s$1G.init(), p$2v.init(), g$X.init(), f$1h.init(), O$s.init(), i$2b = class extends o$1A.PeGCSExtent {
    destroy() {
      o$1A.destroy(this);
    }
  };
  const r2 = [o$1A.PeDatum, o$1A.PeGeogcs, o$1A.PeGeogtran, o$1A.PeObject, o$1A.PeParameter, o$1A.PePrimem, o$1A.PeProjcs, o$1A.PeSpheroid, o$1A.PeUnit];
  for (const o2 of r2)
    t2(o2.prototype, "getName", (e3) => function() {
      return e3.call(this, new Array(s$1G.PE_NAME_MAX));
    });
  for (const P2 of [o$1A.PeGeogtran, o$1A.PeProjcs])
    t2(P2.prototype, "getParameters", (e3) => function() {
      const t3 = new Array(s$1G.PE_PARM_MAX);
      let r3 = e3.call(this);
      for (let e4 = 0; e4 < t3.length; e4++) {
        const n3 = o$1A.getValue(r3, "*");
        t3[e4] = n3 ? o$1A.wrapPointer(n3, o$1A.PeParameter) : null, r3 += Int32Array.BYTES_PER_ELEMENT;
      }
      return t3;
    });
  t2(o$1A.PeHorizon.prototype, "getCoord", (e3) => function() {
    const t3 = this.getSize();
    if (!t3)
      return null;
    const o2 = [];
    return A$p(o2, t3, e3.call(this)), o2;
  }), t2(o$1A.PeGTlistExtendedEntry.prototype, "getEntries", (e3) => {
    const t3 = o$1A._pe_getPeGTlistExtendedGTsSize();
    return function() {
      let r3 = null;
      const n3 = e3.call(this);
      if (!o$1A.compare(n3, o$1A.NULL)) {
        r3 = [n3];
        const e4 = this.getSteps();
        if (e4 > 1) {
          const _3 = o$1A.getPointer(n3);
          for (let n4 = 1; n4 < e4; n4++)
            r3.push(o$1A.wrapPointer(_3 + t3 * n4, o$1A.PeGTlistExtendedGTs));
        }
      }
      return r3;
    };
  });
  const n2 = o$1A._pe_getPeHorizonSize(), _2 = (e3) => function() {
    let t3 = this._cache;
    if (t3 || (t3 = new Map(), this._cache = t3), t3.has(e3))
      return t3.get(e3);
    let r3 = null;
    const _3 = e3.call(this);
    if (!o$1A.compare(_3, o$1A.NULL)) {
      r3 = [_3];
      const e4 = _3.getNump();
      if (e4 > 1) {
        const t4 = o$1A.getPointer(_3);
        for (let _4 = 1; _4 < e4; _4++)
          r3.push(o$1A.wrapPointer(t4 + n2 * _4, o$1A.PeHorizon));
      }
    }
    return t3.set(e3, r3), r3;
  };
  t2(o$1A.PeProjcs.prototype, "horizonGcsGenerate", _2), t2(o$1A.PeProjcs.prototype, "horizonPcsGenerate", _2), o$1A.PeObject.prototype.toString = function(e3 = s$1G.PE_STR_OPTS_NONE) {
    o$1A.ensureCache.prepare();
    const t3 = o$1A.getPointer(this), r3 = o$1A.ensureInt8(new Array(s$1G.PE_BUFFER_MAX));
    return o$1A.UTF8ToString(o$1A._pe_object_to_string_ext(t3, e3, r3));
  };
}
function N$n(e2) {
  if (!e2)
    return;
  const t2 = o$1A.getClass(e2);
  if (!t2)
    return;
  const r2 = o$1A.getCache(t2);
  if (!r2)
    return;
  const n2 = o$1A.getPointer(e2);
  n2 && delete r2[n2];
}
function y$16(e2, t2) {
  const r2 = [], n2 = new Array(t2);
  for (let _2 = 0; _2 < e2; _2++)
    r2.push(o$1A.ensureInt8(n2));
  return r2;
}
function M$v(e2) {
  let t2;
  return Array.isArray(e2[0]) ? (t2 = [], e2.forEach((e3) => {
    t2.push(e3[0], e3[1]);
  })) : t2 = e2, t2;
}
function A$p(e2, t2, r2, n2 = false) {
  if (n2)
    for (let _2 = 0; _2 < 2 * t2; _2++)
      e2[_2] = o$1A.getValue(r2 + _2 * Float64Array.BYTES_PER_ELEMENT, "double");
  else {
    const n3 = e2.length === 0;
    for (let _2 = 0; _2 < t2; _2++)
      n3 && (e2[_2] = new Array(2)), e2[_2][0] = o$1A.getValue(r2, "double"), e2[_2][1] = o$1A.getValue(r2 + Float64Array.BYTES_PER_ELEMENT, "double"), r2 += 2 * Float64Array.BYTES_PER_ELEMENT;
  }
}
!function(e2) {
  let t2;
  function r2() {
    e2.PE_GTLIST_OPTS_COMMON = o$1A.PeGTlistExtended.prototype.PE_GTLIST_OPTS_COMMON, t2 = o$1A._pe_getPeGTlistExtendedEntrySize();
  }
  function n2(e3, r3, n3, _2, P2, s2) {
    let E2 = null;
    const i2 = new o$1A.PeInteger(s2);
    try {
      const p2 = o$1A.PeGTlistExtended.prototype.getGTlist(e3, r3, n3, _2, P2, i2);
      if ((s2 = i2.val) && (E2 = [p2], s2 > 1)) {
        const e4 = o$1A.getPointer(p2);
        for (let r4 = 1; r4 < s2; r4++)
          E2.push(o$1A.wrapPointer(e4 + t2 * r4, o$1A.PeGTlistExtendedEntry));
      }
    } finally {
      o$1A.destroy(i2);
    }
    return E2;
  }
  e2.init = r2, e2.getGTlist = n2;
}(p$2v || (p$2v = {})), function(e2) {
  function t2(e3) {
    if (e3 && e3.length) {
      for (const t3 of e3)
        N$n(t3), t3.getEntries().forEach((e4) => {
          N$n(e4);
          const t4 = e4.getGeogtran();
          N$n(t4), t4.getParameters().forEach(N$n), [t4.getGeogcs1(), t4.getGeogcs2()].forEach((e5) => {
            N$n(e5);
            const t5 = e5.getDatum();
            N$n(t5), N$n(t5.getSpheroid()), N$n(e5.getPrimem()), N$n(e5.getUnit());
          });
        });
      o$1A.PeGTlistExtendedEntry.prototype.Delete(e3[0]);
    }
  }
  e2.destroy = t2;
}(u$1o || (u$1o = {})), function(e2) {
  function t2(e3, t3, r2, n2, _2) {
    o$1A.ensureCache.prepare();
    const P2 = M$v(r2), s2 = r2 === P2, E2 = o$1A.ensureFloat64(P2);
    let i2 = 0;
    n2 && (i2 = o$1A.ensureFloat64(n2));
    const p2 = o$1A._pe_geog_to_geog(o$1A.getPointer(e3), t3, E2, i2, _2);
    return p2 && A$p(r2, t3, E2, s2), p2;
  }
  e2.geogToGeog = t2;
}(a$21 || (a$21 = {})), function(e2) {
  const t2 = (e3, t3, r3, n3, _3, P3) => {
    let E3, i3;
    switch (o$1A.ensureCache.prepare(), e3) {
      case "dd":
        E3 = o$1A._pe_geog_to_dd, i3 = s$1G.PE_DD_MAX;
        break;
      case "ddm":
        E3 = o$1A._pe_geog_to_ddm, i3 = s$1G.PE_DDM_MAX;
        break;
      case "dms":
        E3 = o$1A._pe_geog_to_dms, i3 = s$1G.PE_DMS_MAX;
    }
    let p3 = 0;
    t3 && (p3 = o$1A.getPointer(t3));
    const u2 = M$v(n3), a2 = o$1A.ensureFloat64(u2), c2 = y$16(r3, i3), g2 = E3(p3, r3, a2, _3, o$1A.ensureInt32(c2));
    if (g2)
      for (let s2 = 0; s2 < r3; s2++)
        P3[s2] = o$1A.UTF8ToString(c2[s2]);
    return g2;
  }, r2 = (e3, t3, r3, n3, _3) => {
    let P3;
    switch (o$1A.ensureCache.prepare(), e3) {
      case "dd":
        P3 = o$1A._pe_dd_to_geog;
        break;
      case "ddm":
        P3 = o$1A._pe_ddm_to_geog;
        break;
      case "dms":
        P3 = o$1A._pe_dms_to_geog;
    }
    let s2 = 0;
    t3 && (s2 = o$1A.getPointer(t3));
    const E3 = n3.map((e4) => o$1A.ensureString(e4)), i3 = o$1A.ensureInt32(E3), p3 = o$1A.ensureFloat64(new Array(2 * r3)), u2 = P3(s2, r3, i3, p3);
    return u2 && A$p(_3, r3, p3), u2;
  };
  function n2(e3, o2, r3, n3, _3) {
    return t2("dms", e3, o2, r3, n3, _3);
  }
  function _2(e3, t3, o2, n3) {
    return r2("dms", e3, t3, o2, n3);
  }
  function P2(e3, o2, r3, n3, _3) {
    return t2("ddm", e3, o2, r3, n3, _3);
  }
  function E2(e3, t3, o2, n3) {
    return r2("ddm", e3, t3, o2, n3);
  }
  function i2(e3, o2, r3, n3, _3) {
    return t2("dd", e3, o2, r3, n3, _3);
  }
  function p2(e3, t3, o2, n3) {
    return r2("dd", e3, t3, o2, n3);
  }
  e2.geogToDms = n2, e2.dmsToGeog = _2, e2.geogToDdm = P2, e2.ddmToGeog = E2, e2.geogToDd = i2, e2.ddToGeog = p2;
}(c$2e || (c$2e = {})), function(e2) {
  function t2() {
    e2.PE_MGRS_STYLE_NEW = o$1A.PeNotationMgrs.prototype.PE_MGRS_STYLE_NEW, e2.PE_MGRS_STYLE_OLD = o$1A.PeNotationMgrs.prototype.PE_MGRS_STYLE_OLD, e2.PE_MGRS_STYLE_AUTO = o$1A.PeNotationMgrs.prototype.PE_MGRS_STYLE_AUTO, e2.PE_MGRS_180_ZONE_1_PLUS = o$1A.PeNotationMgrs.prototype.PE_MGRS_180_ZONE_1_PLUS, e2.PE_MGRS_ADD_SPACES = o$1A.PeNotationMgrs.prototype.PE_MGRS_ADD_SPACES;
  }
  function r2(e3, t3, r3, n3, _2, P2, E2) {
    o$1A.ensureCache.prepare();
    let i2 = 0;
    e3 && (i2 = o$1A.getPointer(e3));
    const p2 = M$v(r3), u2 = o$1A.ensureFloat64(p2), a2 = y$16(t3, s$1G.PE_MGRS_MAX), c2 = o$1A.ensureInt32(a2), g2 = o$1A._pe_geog_to_mgrs_extended(i2, t3, u2, n3, _2, P2, c2);
    if (g2)
      for (let s2 = 0; s2 < t3; s2++)
        E2[s2] = o$1A.UTF8ToString(a2[s2]);
    return g2;
  }
  function n2(e3, t3, r3, n3, _2) {
    o$1A.ensureCache.prepare();
    let P2 = 0;
    e3 && (P2 = o$1A.getPointer(e3));
    const s2 = r3.map((e4) => o$1A.ensureString(e4)), E2 = o$1A.ensureInt32(s2), i2 = o$1A.ensureFloat64(new Array(2 * t3)), p2 = o$1A._pe_mgrs_to_geog_extended(P2, t3, E2, n3, i2);
    return p2 && A$p(_2, t3, i2), p2;
  }
  e2.init = t2, e2.geogToMgrsExtended = r2, e2.mgrsToGeogExtended = n2;
}(g$X || (g$X = {})), function(e2) {
  function t2(e3, t3, r3, n2, _2, P2, E2) {
    o$1A.ensureCache.prepare();
    let i2 = 0;
    e3 && (i2 = o$1A.getPointer(e3));
    const p2 = M$v(r3), u2 = o$1A.ensureFloat64(p2), a2 = y$16(t3, s$1G.PE_MGRS_MAX), c2 = o$1A.ensureInt32(a2), g2 = o$1A._pe_geog_to_usng(i2, t3, u2, n2, _2, P2, c2);
    if (g2)
      for (let s2 = 0; s2 < t3; s2++)
        E2[s2] = o$1A.UTF8ToString(a2[s2]);
    return g2;
  }
  function r2(e3, t3, r3, n2) {
    o$1A.ensureCache.prepare();
    let _2 = 0;
    e3 && (_2 = o$1A.getPointer(e3));
    const P2 = r3.map((e4) => o$1A.ensureString(e4)), s2 = o$1A.ensureInt32(P2), E2 = o$1A.ensureFloat64(new Array(2 * t3)), i2 = o$1A._pe_usng_to_geog(_2, t3, s2, E2);
    return i2 && A$p(n2, t3, E2), i2;
  }
  e2.geogToUsng = t2, e2.usngToGeog = r2;
}(T$u || (T$u = {})), function(e2) {
  function t2() {
    e2.PE_UTM_OPTS_NONE = o$1A.PeNotationUtm.prototype.PE_UTM_OPTS_NONE, e2.PE_UTM_OPTS_ADD_SPACES = o$1A.PeNotationUtm.prototype.PE_UTM_OPTS_ADD_SPACES, e2.PE_UTM_OPTS_NS = o$1A.PeNotationUtm.prototype.PE_UTM_OPTS_NS;
  }
  function r2(e3, t3, r3, n3, _2) {
    o$1A.ensureCache.prepare();
    let P2 = 0;
    e3 && (P2 = o$1A.getPointer(e3));
    const E2 = M$v(r3), i2 = o$1A.ensureFloat64(E2), p2 = y$16(t3, s$1G.PE_UTM_MAX), u2 = o$1A.ensureInt32(p2), a2 = o$1A._pe_geog_to_utm(P2, t3, i2, n3, u2);
    if (a2)
      for (let s2 = 0; s2 < t3; s2++)
        _2[s2] = o$1A.UTF8ToString(p2[s2]);
    return a2;
  }
  function n2(e3, t3, r3, n3, _2) {
    o$1A.ensureCache.prepare();
    let P2 = 0;
    e3 && (P2 = o$1A.getPointer(e3));
    const s2 = r3.map((e4) => o$1A.ensureString(e4)), E2 = o$1A.ensureInt32(s2), i2 = o$1A.ensureFloat64(new Array(2 * t3)), p2 = o$1A._pe_utm_to_geog(P2, t3, E2, n3, i2);
    return p2 && A$p(_2, t3, i2), p2;
  }
  e2.init = t2, e2.geogToUtm = r2, e2.utmToGeog = n2;
}(f$1h || (f$1h = {})), function(e2) {
  const t2 = new Map();
  function r2() {
    e2.PE_PCSINFO_OPTION_NONE = o$1A.PePCSInfo.prototype.PE_PCSINFO_OPTION_NONE, e2.PE_PCSINFO_OPTION_DOMAIN = o$1A.PePCSInfo.prototype.PE_PCSINFO_OPTION_DOMAIN, e2.PE_POLE_OUTSIDE_BOUNDARY = o$1A.PePCSInfo.prototype.PE_POLE_OUTSIDE_BOUNDARY, e2.PE_POLE_POINT = o$1A.PePCSInfo.prototype.PE_POLE_POINT;
  }
  function n2(r3, n3 = e2.PE_PCSINFO_OPTION_DOMAIN) {
    let _2 = null, P2 = null;
    return t2.has(r3) && (P2 = t2.get(r3), P2[n3] && (_2 = P2[n3])), _2 || (_2 = o$1A.PePCSInfo.prototype.generate(r3, n3), P2 || (P2 = [], t2.set(r3, P2)), P2[n3] = _2), _2;
  }
  e2.init = r2, e2.generate = n2;
}(O$s || (O$s = {})), function(e2) {
  function t2() {
    return o$1A.PeVersion.prototype.version_string();
  }
  e2.versionString = t2;
}(l$1L || (l$1L = {}));
const d$1j = Object.freeze(Object.defineProperty({ __proto__: null, get _pe() {
  return o$1A;
}, isLoaded: r$1n, isSupported: n$25, load: _$B, get PeCSTransformations() {
  return P$r;
}, get PeDefs() {
  return s$1G;
}, get PeFactory() {
  return E$C;
}, get PeGCSExtent() {
  return i$2b;
}, get PeGTlistExtended() {
  return p$2v;
}, get PeGTlistExtendedEntry() {
  return u$1o;
}, get PeGTTransformations() {
  return a$21;
}, get PeNotationDms() {
  return c$2e;
}, get PeNotationMgrs() {
  return g$X;
}, get PeNotationUsng() {
  return T$u;
}, get PeNotationUtm() {
  return f$1h;
}, get PePCSInfo() {
  return O$s;
}, get PeVersion() {
  return l$1L;
}, _init: S$D }, Symbol.toStringTag, { value: "Module" }));
const i$2a = Math.PI / 180, t$1B = /SPHEROID\[([^\]]+)]/i, r$1m = s$2h.radius, n$24 = s$2h.eccentricitySquared, s$1F = { a1: r$1m * n$24, a2: r$1m * n$24 * r$1m * n$24, a3: r$1m * n$24 * n$24 / 2, a4: r$1m * n$24 * r$1m * n$24 * 2.5, a5: r$1m * n$24 + r$1m * n$24 * n$24 / 2, a6: 1 - n$24 }, d$1i = { 4267: { a: 63782064e-1, f: 1 / 294.9786982 }, 4269: { a: 6378137, f: 1 / 298.257222101 }, 4326: { a: s$2h.radius, f: s$2h.flattening }, 104900: { a: 2439700, f: 0 }, 104901: { a: 6051e3, f: 0 }, 104902: { a: 6051800, f: 0 }, 104903: { a: e$1W.radius, f: e$1W.flattening }, 104904: { a: 3393400, f: 1 / 192.0430107526882 }, 104905: { a: t$20.radius, f: t$20.flattening }, 104906: { a: 6200, f: 0 }, 104907: { a: 11100, f: 0 }, 104908: { a: 71492e3, f: 0.06487439154031222 }, 104909: { a: 8200, f: 0 }, 104910: { a: 83500, f: 0 }, 104911: { a: 1e4, f: 0 }, 104912: { a: 2409300, f: 0 }, 104913: { a: 15e3, f: 0 }, 104914: { a: 4e4, f: 0 }, 104915: { a: 1562090, f: 0 }, 104916: { a: 2632345, f: 0 }, 104917: { a: 85e3, f: 0 }, 104918: { a: 1821460, f: 0 }, 104919: { a: 5e3, f: 0 }, 104920: { a: 12e3, f: 0 }, 104921: { a: 3e4, f: 3 }, 104922: { a: 18e3, f: 0 }, 104923: { a: 14e3, f: 0 }, 104924: { a: 49300, f: 0 }, 104925: { a: 60268e3, f: 1 / 10.2079945799458 }, 104926: { a: 16e3, f: 0 }, 104927: { a: 9500, f: 0 }, 104928: { a: 56e4, f: 0 }, 104929: { a: 249400, f: 0 }, 104930: { a: 59500, f: 0 }, 104931: { a: 16e3, f: 0 }, 104932: { a: 133e3, f: 0 }, 104933: { a: 718e3, f: 0 }, 104934: { a: 888e3, f: 0 }, 104935: { a: 1986300, f: 0 }, 104936: { a: 1e4, f: 0 }, 104937: { a: 41900, f: 0 }, 104938: { a: 11e4, f: 0 }, 104939: { a: 50100, f: 0 }, 104940: { a: 764e3, f: 0 }, 104941: { a: 11e3, f: 0 }, 104942: { a: 529800, f: 0 }, 104943: { a: 2575e3, f: 0 }, 104944: { a: 25559e3, f: 1 / 43.61604095563141 }, 104945: { a: 578900, f: 0 }, 104946: { a: 33e3, f: 0 }, 104947: { a: 21e3, f: 0 }, 104948: { a: 13e3, f: 0 }, 104949: { a: 31e3, f: 0 }, 104950: { a: 27e3, f: 0 }, 104951: { a: 42e3, f: 0 }, 104952: { a: 235800, f: 0 }, 104953: { a: 761400, f: 0 }, 104954: { a: 15e3, f: 0 }, 104955: { a: 54e3, f: 0 }, 104956: { a: 77e3, f: 0 }, 104957: { a: 27e3, f: 0 }, 104958: { a: 788900, f: 0 }, 104959: { a: 584700, f: 0 }, 104960: { a: 24764e3, f: 0.01708124697141011 }, 104961: { a: 74e3, f: 0 }, 104962: { a: 79e3, f: 0 }, 104963: { a: 104e3, f: 0.14423076923076922 }, 104964: { a: 29e3, f: 0 }, 104965: { a: 17e4, f: 0 }, 104966: { a: 208e3, f: 0 }, 104967: { a: 4e4, f: 0 }, 104968: { a: 1352600, f: 0 }, 104969: { a: 1195e3, f: 0 }, 104970: { a: 593e3, f: 0 }, 104971: { a: t$20.radius, f: 0 }, 104972: { a: 47e4, f: 0 }, 104973: { a: 255e3, f: 0 }, 104974: { a: 2439400, f: 0 } };
let s$1E = 0;
class t$1A {
  constructor(t2) {
    this.uid = s$1E++, t2 ? (this._wkt = t2.wkt != null ? t2.wkt : null, this._wkid = t2.wkid != null ? t2.wkid : -1, this._isInverse = t2.isInverse != null && t2.isInverse === true) : (this._wkt = null, this._wkid = -1, this._isInverse = false);
  }
  static fromGE(s2) {
    const i2 = new t$1A();
    return i2._wkt = s2.wkt, i2._wkid = s2.wkid, i2._isInverse = s2.isInverse, i2;
  }
  get wkt() {
    return this._wkt;
  }
  set wkt(t2) {
    this._wkt = t2, this.uid = s$1E++;
  }
  get wkid() {
    return this._wkid;
  }
  set wkid(t2) {
    this._wkid = t2, this.uid = s$1E++;
  }
  get isInverse() {
    return this._isInverse;
  }
  set isInverse(t2) {
    this._isInverse = t2, this.uid = s$1E++;
  }
  getInverse() {
    const s2 = new t$1A();
    return s2._wkt = this.wkt, s2._wkid = this._wkid, s2._isInverse = !this.isInverse, s2;
  }
}
class s$1D {
  constructor(s2) {
    if (this.steps = [], this._cachedProjection = {}, this._chain = "", this._gtlistentry = null, s2 && s2.steps)
      for (const i2 of s2.steps)
        i2 instanceof t$1A ? this.steps.push(i2) : this.steps.push(new t$1A({ wkid: i2.wkid, wkt: i2.wkt, isInverse: i2.isInverse }));
  }
  static cacheKey(t2, s2) {
    return [t2.wkid !== void 0 && t2.wkid !== null ? t2.wkid.toString() : "-1", t2.wkt !== void 0 && t2.wkt !== null ? t2.wkt.toString() : "", s2.wkid !== void 0 && s2.wkid !== null ? s2.wkid.toString() : "-1", s2.wkt !== void 0 && s2.wkt !== null ? s2.wkt.toString() : ""].join(",");
  }
  static fromGE(i2) {
    const e2 = new s$1D();
    let n2 = "";
    for (const s2 of i2.steps) {
      const i3 = t$1A.fromGE(s2);
      e2.steps.push(i3), n2 += i3.uid.toString() + ",";
    }
    return e2._cachedProjection = {}, e2._gtlistentry = null, e2._chain = n2, e2;
  }
  getInverse() {
    const t2 = new s$1D();
    t2.steps = [];
    for (let s2 = this.steps.length - 1; s2 >= 0; s2--) {
      const i2 = this.steps[s2];
      t2.steps.push(i2.getInverse());
    }
    return t2;
  }
  getGTListEntry() {
    let t2 = "";
    for (const s2 of this.steps)
      t2 += s2.uid.toString() + ",";
    return t2 !== this._chain && (this._gtlistentry = null, this._cachedProjection = {}, this._chain = t2), this._gtlistentry;
  }
  assignCachedGe(t2, i2, e2) {
    this._cachedProjection[s$1D.cacheKey(t2, i2)] = e2;
  }
  getCachedGeTransformation(t2, i2) {
    let e2 = "";
    for (const s2 of this.steps)
      e2 += s2.uid.toString() + ",";
    e2 !== this._chain && (this._gtlistentry = null, this._cachedProjection = {}, this._chain = e2);
    const n2 = this._cachedProjection[s$1D.cacheKey(t2, i2)];
    return n2 === void 0 ? null : n2;
  }
}
function o$1z(o2, f2, u2) {
  if (t$2r(f2) || t$2r(u2) || u2.vcsWkid || E$P(f2, u2))
    return null;
  const a2 = L$p(f2) / L$p(u2);
  if (a2 === 1)
    return null;
  switch (o2) {
    case "point":
    case "esriGeometryPoint":
      return (n2) => r$1l(n2, a2);
    case "polyline":
    case "esriGeometryPolyline":
      return (n2) => s$1C(n2, a2);
    case "polygon":
    case "esriGeometryPolygon":
      return (n2) => i$29(n2, a2);
    case "multipoint":
    case "esriGeometryMultipoint":
      return (n2) => c$2d(n2, a2);
    case "extent":
    case "esriGeometryExtent":
      return (n2) => l$1K(n2, a2);
    default:
      return null;
  }
}
function r$1l(n2, e2) {
  n2 && n2.z != null && (n2.z *= e2);
}
function i$29(n2, e2) {
  if (n2)
    for (const t2 of n2.rings)
      for (const n3 of t2)
        n3.length > 2 && (n3[2] *= e2);
}
function s$1C(n2, e2) {
  if (n2)
    for (const t2 of n2.paths)
      for (const n3 of t2)
        n3.length > 2 && (n3[2] *= e2);
}
function c$2d(n2, e2) {
  if (n2)
    for (const t2 of n2.points)
      t2.length > 2 && (t2[2] *= e2);
}
function l$1K(n2, e2) {
  n2 && n2.zmin != null && n2.zmax != null && (n2.zmin *= e2, n2.zmax *= e2);
}
let J$k = null, Q$d = null, Y$a = null, $$f = {};
const nn = new e$1Q();
function en() {
  return !!J$k && r$1n();
}
function tn(n2) {
  return t$2r(Y$a) && (Y$a = Promise.all([_$B(), Promise.resolve().then(function() {
    return geometryEngineBase;
  }).then((n3) => n3.g), Promise.resolve().then(function() {
    return hydrated;
  })])), Y$a.then(([, e2, { hydratedAdapter: t2 }]) => {
    f$1V(n2), Q$d = t2, J$k = e2.default, J$k._enableProjection(d$1j), nn.notify();
  });
}
function rn(n2, e2, t2 = null, r2 = null) {
  return Array.isArray(n2) ? n2.length === 0 ? [] : ln(Q$d, n2, n2[0].spatialReference, e2, t2, r2) : ln(Q$d, [n2], n2.spatialReference, e2, t2, r2)[0];
}
function ln(n2, e2, t2, r2, l2 = null, i2 = null) {
  if (t$2r(t2) || t$2r(r2))
    return e2;
  if (An(t2, r2, l2))
    return e2.map((n3) => e$2e(Pn(n3, t2, r2)));
  if (t$2r(l2)) {
    const n3 = s$1D.cacheKey(t2, r2);
    $$f[n3] !== void 0 ? l2 = $$f[n3] : (l2 = sn(t2, r2, void 0), t$2r(l2) && (l2 = new s$1D()), $$f[n3] = l2);
  }
  if (t$2r(J$k) || t$2r(n2))
    throw new cn();
  return r$1$(i2) ? J$k._project(n2, e2, t2, r2, l2, i2) : J$k._project(n2, e2, t2, r2, l2);
}
function un(n2, e2) {
  const t2 = on([n2], e2);
  return r$1$(t2.pending) ? { pending: t2.pending, geometry: null } : r$1$(t2.geometries) ? { pending: null, geometry: t2.geometries[0] } : { pending: null, geometry: null };
}
function on(n2, e2) {
  if (!en()) {
    for (const t2 of n2)
      if (r$1$(t2) && !E$P(t2.spatialReference, e2) && I$K(t2.spatialReference) && I$K(e2) && !An(t2.spatialReference, e2))
        return s$2s(nn), { pending: tn(), geometries: null };
  }
  return { pending: null, geometries: n2.map((n3) => t$2r(n3) ? null : E$P(n3.spatialReference, e2) ? n3 : I$K(n3.spatialReference) && I$K(e2) ? fn(n3, e2) : null) };
}
function sn(n2, e2, t2 = null) {
  if (t$2r(n2) || t$2r(e2))
    return null;
  if (t$2r(J$k) || t$2r(Q$d))
    throw new cn();
  const r2 = J$k._getTransformation(Q$d, n2, e2, t2, t2 == null ? void 0 : t2.spatialReference);
  return r2 !== null ? s$1D.fromGE(r2) : null;
}
class cn extends s$2u {
  constructor() {
    super("projection:not-loaded", "projection engine not fully loaded yet, please call load()");
  }
}
var En;
!function(n2) {
  n2[n2.UNKNOWN = 0] = "UNKNOWN", n2[n2.SPHERICAL_ECEF = 1] = "SPHERICAL_ECEF", n2[n2.WGS84 = 2] = "WGS84", n2[n2.WEB_MERCATOR = 3] = "WEB_MERCATOR", n2[n2.WGS84_ECEF = 4] = "WGS84_ECEF", n2[n2.CGCS2000 = 5] = "CGCS2000", n2[n2.WGS84_COMPARABLE_LON_LAT = 6] = "WGS84_COMPARABLE_LON_LAT", n2[n2.SPHERICAL_MARS_PCPF = 7] = "SPHERICAL_MARS_PCPF", n2[n2.GCSMARS2000 = 8] = "GCSMARS2000", n2[n2.SPHERICAL_MOON_PCPF = 9] = "SPHERICAL_MOON_PCPF", n2[n2.GCSMOON2000 = 10] = "GCSMOON2000", n2[n2.LON_LAT = 11] = "LON_LAT", n2[n2.PLATE_CARREE = 12] = "PLATE_CARREE";
}(En || (En = {}));
function fn(n2, e2) {
  try {
    const t2 = rn(n2, e2);
    if (t2 == null)
      return null;
    "xmin" in n2 && "xmin" in t2 && (t2.zmin = n2.zmin, t2.zmax = n2.zmax);
    const r2 = o$1z(t2.type, n2.spatialReference, e2);
    return r$1$(r2) && r2(t2), t2;
  } catch (t2) {
    if (!(t2 instanceof cn))
      throw t2;
    return null;
  }
}
function An(n2, e2, t2) {
  return !t2 && (!!E$P(n2, e2) || I$K(n2) && I$K(e2) && !!de$2(n2, e2, ye$3));
}
async function _n(n2, e2, t2, r2) {
  if (en())
    return O$E(r2);
  if (Array.isArray(n2)) {
    for (const { source: l2, dest: u2, geographicTransformation: o2 } of n2)
      if (!An(l2, u2, o2))
        return tn(r2);
  } else if (!An(n2, e2, t2))
    return tn(r2);
  return O$E(r2);
}
function Pn(n2, e2, t2) {
  return n2 ? "x" in n2 ? Ln(n2, e2, new w$_(), t2, 0) : "xmin" in n2 ? In(n2, e2, new w$Z(), t2, 0) : "rings" in n2 ? Tn(n2, e2, new v$15(), t2, 0) : "paths" in n2 ? Gn(n2, e2, new m$2i(), t2, 0) : "points" in n2 ? Mn(n2, e2, new u$26(), t2, 0) : null : null;
}
function pn(n2, e2, t2 = e2.spatialReference, r2 = 0) {
  return r$1$(t2) && r$1$(n2.spatialReference) && r$1$(Ln(n2, n2.spatialReference, e2, t2, r2));
}
function Ln(n2, e2, t2, r2, l2) {
  ze$1[0] = n2.x, ze$1[1] = n2.y;
  const u2 = n2.z;
  return ze$1[2] = u2 !== void 0 ? u2 : l2, xn(ze$1, e2, 0, ze$1, r2, 0, 1) ? (t2.x = ze$1[0], t2.y = ze$1[1], t2.spatialReference = r2, u2 === void 0 ? (t2.z = void 0, t2.hasZ = false) : (t2.z = ze$1[2], t2.hasZ = true), n2.m === void 0 ? (t2.m = void 0, t2.hasM = false) : (t2.m = n2.m, t2.hasM = true), t2) : null;
}
function Mn(n2, e2, t2, r2, l2) {
  const { points: u2, hasZ: o2, hasM: s2 } = n2, i2 = [], a2 = u2.length, c2 = [];
  for (const E2 of u2)
    c2.push(E2[0], E2[1], o2 ? E2[2] : l2);
  if (!xn(c2, e2, 0, c2, r2, 0, a2))
    return null;
  for (let E2 = 0; E2 < a2; ++E2) {
    const n3 = 3 * E2, e3 = c2[n3], t3 = c2[n3 + 1];
    o2 && s2 ? i2.push([e3, t3, c2[n3 + 2], u2[E2][3]]) : o2 ? i2.push([e3, t3, c2[n3 + 2]]) : s2 ? i2.push([e3, t3, u2[E2][2]]) : i2.push([e3, t3]);
  }
  return t2.points = i2, t2.spatialReference = r2, t2.hasZ = o2, t2.hasM = s2, t2;
}
function Gn(n2, e2, t2, r2, l2) {
  const { paths: u2, hasZ: o2, hasM: s2 } = n2, i2 = [];
  return bn(u2, o2 != null ? o2 : false, s2 != null ? s2 : false, e2, i2, r2, l2) ? (t2.paths = i2, t2.spatialReference = r2, t2.hasZ = o2, t2.hasM = s2, t2) : null;
}
function hn({ hasZ: n2, spatialReference: e2, paths: t2 }, r2, l2 = 0) {
  const o2 = Jn(e2, Be$1), s2 = Ie[o2][En.WGS84_COMPARABLE_LON_LAT];
  if (t$2r(s2))
    return false;
  const i2 = n2 ? (n3) => n3 : (n3) => o$1Q(ze$1, n3[0], n3[1], l2);
  for (const u2 of t2) {
    const n3 = [];
    for (const e3 of u2) {
      const t3 = [0, 0, l2];
      s2(i2(e3), 0, t3, 0), n3.push(t3);
    }
    r2.push(n3);
  }
  return true;
}
function Wn({ hasZ: n2, spatialReference: e2, rings: t2 }, r2, l2 = 0) {
  const o2 = Jn(e2, Be$1), s2 = Ie[o2][En.WGS84_COMPARABLE_LON_LAT];
  if (t$2r(s2))
    return false;
  const i2 = n2 ? (n3) => n3 : (n3) => o$1Q(ze$1, n3[0], n3[1], l2);
  for (const u2 of t2) {
    const n3 = [];
    for (const e3 of u2) {
      const t3 = [0, 0, l2];
      s2(i2(e3), 0, t3, 0), n3.push(t3);
    }
    r2.push(n3);
  }
  return true;
}
function mn(n2, e2, t2 = e2.spatialReference, r2 = 0) {
  return r$1$(n2.spatialReference) && r$1$(t2) && r$1$(Tn(n2, n2.spatialReference, e2, t2, r2));
}
function Tn(n2, e2, t2, r2, l2) {
  const { rings: u2, hasZ: o2, hasM: s2 } = n2, i2 = [];
  return bn(u2, o2 != null ? o2 : false, s2 != null ? s2 : false, e2, i2, r2, l2) ? (t2.rings = i2, t2.spatialReference = r2, t2.hasZ = o2, t2.hasM = s2, t2) : null;
}
function In(n2, e2, t2, r2, l2) {
  const { xmin: u2, ymin: o2, xmax: s2, ymax: i2, hasZ: a2, hasM: c2 } = n2;
  if (!Bn(u2, o2, a2 ? n2.zmin : l2, e2, ze$1, r2))
    return null;
  t2.xmin = ze$1[0], t2.ymin = ze$1[1], a2 && (t2.zmin = ze$1[2]);
  return Bn(s2, i2, a2 ? n2.zmax : l2, e2, ze$1, r2) ? (t2.xmax = ze$1[0], t2.ymax = ze$1[1], a2 && (t2.zmax = ze$1[2]), c2 && (t2.mmin = n2.mmin, t2.mmax = n2.mmax), t2.spatialReference = r2, t2) : null;
}
function Hn(n2, e2, t2) {
  return xn(n2, e2, 0, ze$1, t2.spatialReference, 0, 1) ? (t2.x = ze$1[0], t2.y = ze$1[1], t2.z = ze$1[2], t2) : null;
}
function gn(n2, e2, t2, r2 = 0) {
  ze$1[0] = n2.x, ze$1[1] = n2.y;
  const l2 = n2.z;
  return ze$1[2] = l2 !== void 0 ? l2 : r2, xn(ze$1, n2.spatialReference, 0, e2, t2, 0, 1);
}
function Bn(n2, e2, t2, r2, l2, u2) {
  return Ke[0] = n2, Ke[1] = e2, Ke[2] = t2, xn(Ke, r2, 0, l2, u2, 0, 1);
}
function jn(n2, e2, t2, r2) {
  return !(t$2r(e2) || t$2r(r2) || n2.length < 2) && (n2.length === 2 && (Ke[0] = n2[0], Ke[1] = n2[1], Ke[2] = 0, n2 = Ke), xn(n2, e2, 0, t2, r2, 0, 1));
}
function wn(n2, e2, t2) {
  return Un(n2, e2, t2);
}
function Un(n2, e2, t2) {
  if (t$2r(e2))
    return false;
  const r2 = Jn(e2, Be$1), l2 = Ie[r2][En.WGS84_COMPARABLE_LON_LAT];
  return !t$2r(l2) && (l2(n2, 0, Ke, 0), t2 !== Ke && (t2[0] = Ke[0], t2[1] = Ke[1], t2.length > 2 && (t2[2] = Ke[2])), true);
}
function xn(n2, e2, t2, r2, l2, o2, s2 = 1) {
  const i2 = de$2(e2, l2, ye$3);
  if (t$2r(i2))
    return false;
  if (i2 === Qn) {
    if (n2 === r2 && t2 === o2)
      return true;
    const e3 = t2 + 3 * s2;
    for (let l3 = t2, u2 = o2; l3 < e3; l3++, u2++)
      r2[u2] = n2[l3];
    return true;
  }
  const a2 = t2 + 3 * s2;
  for (let u2 = t2, c2 = o2; u2 < a2; u2 += 3, c2 += 3)
    i2(n2, u2, r2, c2);
  return true;
}
function bn(n2, e2, t2, r2, l2, u2, o2 = 0) {
  const s2 = new Array();
  for (const a2 of n2)
    for (const n3 of a2)
      s2.push(n3[0], n3[1], e2 ? n3[2] : o2);
  if (!xn(s2, r2, 0, s2, u2, 0, s2.length / 3))
    return false;
  let i2 = 0;
  l2.length = 0;
  for (const a2 of n2) {
    const n3 = new Array();
    for (const r3 of a2)
      e2 && t2 ? n3.push([s2[i2++], s2[i2++], s2[i2++], r3[3]]) : e2 ? n3.push([s2[i2++], s2[i2++], s2[i2++]]) : t2 ? (n3.push([s2[i2++], s2[i2++], r3[2]]), i2++) : (n3.push([s2[i2++], s2[i2++]]), i2++);
    l2.push(n3);
  }
  return true;
}
function vn(n2, e2, t2, r2) {
  return n2 != null && (E$P(e2, r2) ? (a$2q(t2, n2), true) : (Ke[0] = n2[0], Ke[1] = n2[1], Ke[2] = 0, !!xn(Ke, e2, 0, Ke, r2, 0, 1) && (t2[0] = Ke[0], t2[1] = Ke[1], Ke[0] = n2[2], Ke[1] = n2[3], Ke[2] = 0, !!xn(Ke, e2, 0, Ke, r2, 0, 1) && (t2[2] = Ke[0], t2[3] = Ke[1], true))));
}
function Zn(n2, e2, t2, r2) {
  if (t$2r(n2) || t$2r(r2))
    return false;
  const l2 = Jn(n2, Be$1), o2 = Jn(r2, je$1);
  if (l2 === o2 && !Vn(o2) && (l2 !== En.UNKNOWN || E$P(n2, r2)))
    return x$L(t2, e2), true;
  if (Vn(o2)) {
    const n3 = Ie[l2][En.LON_LAT], r3 = Ie[En.LON_LAT][o2];
    return !t$2r(n3) && !t$2r(r3) && (n3(e2, 0, be, 0), r3(be, 0, ke, 0), Xn(Ue * be[0], Ue * be[1], t2), t2[12] = ke[0], t2[13] = ke[1], t2[14] = ke[2], true);
  }
  if ((o2 === En.WEB_MERCATOR || o2 === En.PLATE_CARREE) && (l2 === En.WGS84 || l2 === En.CGCS2000 && o2 === En.PLATE_CARREE || l2 === En.SPHERICAL_ECEF || l2 === En.WEB_MERCATOR)) {
    const n3 = Ie[l2][En.LON_LAT], r3 = Ie[En.LON_LAT][o2];
    return !t$2r(n3) && !t$2r(r3) && (n3(e2, 0, be, 0), r3(be, 0, ke, 0), l2 === En.SPHERICAL_ECEF ? Dn(Ue * be[0], Ue * be[1], t2) : r$1o(t2), t2[12] = ke[0], t2[13] = ke[1], t2[14] = ke[2], true);
  }
  return false;
}
function Vn(n2) {
  return n2 === En.SPHERICAL_ECEF || n2 === En.SPHERICAL_MARS_PCPF || n2 === En.SPHERICAL_MOON_PCPF;
}
function Xn(n2, e2, t2) {
  const r2 = Math.sin(n2), l2 = Math.cos(n2), u2 = Math.sin(e2), o2 = Math.cos(e2), s2 = t2;
  return s2[0] = -r2, s2[4] = -u2 * l2, s2[8] = o2 * l2, s2[12] = 0, s2[1] = l2, s2[5] = -u2 * r2, s2[9] = o2 * r2, s2[13] = 0, s2[2] = 0, s2[6] = o2, s2[10] = u2, s2[14] = 0, s2[3] = 0, s2[7] = 0, s2[11] = 0, s2[15] = 1, s2;
}
function Dn(n2, e2, t2) {
  return Xn(n2, e2, t2), o$1B(t2, t2), t2;
}
function Jn(n2, e2) {
  return n2 ? e2.spatialReference === n2 ? e2.spatialReferenceId : (e2.spatialReference = n2, "metersPerUnit" in e2 && (e2.metersPerUnit = $$g(n2, 1)), n2.wkt === I$A.wkt ? e2.spatialReferenceId = En.SPHERICAL_ECEF : G$w(n2) ? e2.spatialReferenceId = En.WGS84 : k$D(n2) ? e2.spatialReferenceId = En.WEB_MERCATOR : T$D(n2) ? e2.spatialReferenceId = En.PLATE_CARREE : n2.wkt === p$2y.wkt ? e2.spatialReferenceId = En.WGS84_ECEF : n2.wkid === S$T.CGCS2000 ? e2.spatialReferenceId = En.CGCS2000 : n2.wkt === E$F.wkt ? e2.spatialReferenceId = En.SPHERICAL_MARS_PCPF : n2.wkt === R$u.wkt ? e2.spatialReferenceId = En.SPHERICAL_MOON_PCPF : P$D(n2) ? e2.spatialReferenceId = En.GCSMARS2000 : s$2j(n2) ? e2.spatialReferenceId = En.GCSMOON2000 : e2.spatialReferenceId = En.UNKNOWN) : En.UNKNOWN;
}
function Qn(n2, e2, t2, r2) {
  n2 !== t2 && (t2[r2++] = n2[e2++], t2[r2++] = n2[e2++], t2[r2] = n2[e2]);
}
function Yn(n2, e2, t2, r2) {
  t2[r2++] = xe * (n2[e2++] / s$2h.radius), t2[r2++] = xe * (Math.PI / 2 - 2 * Math.atan(Math.exp(-n2[e2++] / s$2h.radius))), t2[r2] = n2[e2];
}
function $n(n2, e2, t2, r2) {
  Yn(n2, e2, t2, r2), Pe(t2, r2, t2, r2);
}
function ne$3(n2, e2, t2, r2) {
  Yn(n2, e2, t2, r2), We$1(t2, r2, t2, r2);
}
function ee$4(n2, t2, r2, l2, u2) {
  const o2 = 0.4999999 * Math.PI, s2 = a$2v(Ue * n2[t2 + 1], -o2, o2), i2 = Math.sin(s2);
  r2[l2++] = Ue * n2[t2] * u2.radius, r2[l2++] = u2.halfSemiMajorAxis * Math.log((1 + i2) / (1 - i2)), r2[l2] = n2[t2 + 2];
}
function te$4(n2, e2, t2, r2) {
  ee$4(n2, e2, t2, r2, s$2h);
}
const re$4 = s$2h.radius * Math.PI / 180, le$3 = 180 / (s$2h.radius * Math.PI);
function ue$3(n2, e2, t2, r2) {
  t2[r2] = n2[e2] * re$4, t2[r2 + 1] = n2[e2 + 1] * re$4, t2[r2 + 2] = n2[e2 + 2];
}
function oe$4(n2, e2, t2, r2) {
  t2[r2] = n2[e2] * le$3, t2[r2 + 1] = n2[e2 + 1] * le$3, t2[r2 + 2] = n2[e2 + 2];
}
function se$2(n2, e2, t2, r2) {
  Yn(n2, e2, t2, r2), ue$3(t2, r2, t2, r2);
}
function ie$4(n2, e2, t2, r2) {
  me$2(n2, e2, t2, r2), ue$3(t2, r2, t2, r2);
}
function ae$3(n2, e2, t2, r2) {
  Me(n2, e2, t2, r2), ue$3(t2, r2, t2, r2);
}
function ce$3(n2, e2, t2, r2) {
  oe$4(n2, e2, t2, r2), Pe(t2, r2, t2, r2);
}
function Ee(n2, e2, t2, r2) {
  oe$4(n2, e2, t2, r2), te$4(t2, r2, t2, r2);
}
function Ce(n2, e2, t2, r2) {
  oe$4(n2, e2, t2, r2), We$1(t2, r2, t2, r2);
}
function Ae(n2, e2, t2, r2, l2) {
  const u2 = l2 + n2[e2 + 2], o2 = Ue * n2[e2 + 1], s2 = Ue * n2[e2], i2 = Math.cos(o2);
  t2[r2++] = Math.cos(s2) * i2 * u2, t2[r2++] = Math.sin(s2) * i2 * u2, t2[r2] = Math.sin(o2) * u2;
}
function _e$1(n2, e2, t2, r2) {
  Ae(n2, e2, t2, r2, e$1W.radius);
}
function Se$1(n2, e2, t2, r2) {
  Ae(n2, e2, t2, r2, t$20.radius);
}
function Pe(n2, e2, t2, r2) {
  Ae(n2, e2, t2, r2, s$2h.radius);
}
function pe$2(n2, e2, t2, r2, u2) {
  const o2 = n2[e2], s2 = n2[e2 + 1], i2 = n2[e2 + 2], a2 = Math.sqrt(o2 * o2 + s2 * s2 + i2 * i2), c2 = N$s(i2 / (a2 === 0 ? 1 : a2)), E2 = Math.atan2(s2, o2);
  t2[r2++] = xe * E2, t2[r2++] = xe * c2, t2[r2] = a2 - u2;
}
function Le(n2, e2, t2, r2) {
  pe$2(n2, e2, t2, r2, e$1W.radius);
}
function Oe(n2, e2, t2, r2) {
  pe$2(n2, e2, t2, r2, t$20.radius);
}
function Me(n2, e2, t2, r2) {
  pe$2(n2, e2, t2, r2, s$2h.radius);
}
function Ne$1(n2, e2, t2, r2) {
  Me(n2, e2, t2, r2), te$4(t2, r2, t2, r2);
}
function Ge$1(n2, e2, t2, r2) {
  Me(n2, e2, t2, r2), We$1(t2, r2, t2, r2);
}
function he$1(n2, e2, t2, r2, l2) {
  const u2 = Ue * n2[e2], o2 = Ue * n2[e2 + 1], s2 = n2[e2 + 2], i2 = Math.sin(o2), a2 = Math.cos(o2), c2 = l2.radius / Math.sqrt(1 - l2.eccentricitySquared * i2 * i2);
  t2[r2++] = (c2 + s2) * a2 * Math.cos(u2), t2[r2++] = (c2 + s2) * a2 * Math.sin(u2), t2[r2++] = (c2 * (1 - l2.eccentricitySquared) + s2) * i2;
}
function We$1(n2, e2, t2, r2) {
  he$1(n2, e2, t2, r2, s$2h);
}
function me$2(n2, e2, t2, r2) {
  const l2 = s$1F, u2 = n2[e2], o2 = n2[e2 + 1], s2 = n2[e2 + 2];
  let i2, a2, c2, E2, C2, R2, f2, A2, _2, S2, P2, p2, L2, O2, M2, N2, G2, h2, W2, m2, T2;
  i2 = Math.abs(s2), a2 = u2 * u2 + o2 * o2, c2 = Math.sqrt(a2), E2 = a2 + s2 * s2, C2 = Math.sqrt(E2), m2 = Math.atan2(o2, u2), R2 = s2 * s2 / E2, f2 = a2 / E2, O2 = l2.a2 / C2, M2 = l2.a3 - l2.a4 / C2, f2 > 0.3 ? (A2 = i2 / C2 * (1 + f2 * (l2.a1 + O2 + R2 * M2) / C2), W2 = Math.asin(A2), S2 = A2 * A2, _2 = Math.sqrt(1 - S2)) : (_2 = c2 / C2 * (1 - R2 * (l2.a5 - O2 - f2 * M2) / C2), W2 = Math.acos(_2), S2 = 1 - _2 * _2, A2 = Math.sqrt(S2)), P2 = 1 - s$2h.eccentricitySquared * S2, p2 = s$2h.radius / Math.sqrt(P2), L2 = l2.a6 * p2, O2 = c2 - p2 * _2, M2 = i2 - L2 * A2, G2 = _2 * O2 + A2 * M2, N2 = _2 * M2 - A2 * O2, h2 = N2 / (L2 / P2 + G2), W2 += h2, T2 = G2 + N2 * h2 / 2, s2 < 0 && (W2 = -W2), t2[r2++] = xe * m2, t2[r2++] = xe * W2, t2[r2] = T2;
}
function Te(n2, e2, t2, r2) {
  me$2(n2, e2, t2, r2), Pe(t2, r2, t2, r2);
}
function Fe(n2, e2, t2, r2) {
  me$2(n2, e2, t2, r2), te$4(t2, r2, t2, r2);
}
const Ie = { [En.WGS84]: { [En.CGCS2000]: null, [En.GCSMARS2000]: null, [En.GCSMOON2000]: null, [En.LON_LAT]: Qn, [En.WGS84_COMPARABLE_LON_LAT]: Qn, [En.SPHERICAL_ECEF]: Pe, [En.SPHERICAL_MARS_PCPF]: null, [En.SPHERICAL_MOON_PCPF]: null, [En.UNKNOWN]: null, [En.WEB_MERCATOR]: te$4, [En.PLATE_CARREE]: ue$3, [En.WGS84]: Qn, [En.WGS84_ECEF]: We$1 }, [En.CGCS2000]: { [En.CGCS2000]: Qn, [En.GCSMARS2000]: null, [En.GCSMOON2000]: null, [En.LON_LAT]: Qn, [En.WGS84_COMPARABLE_LON_LAT]: Qn, [En.SPHERICAL_ECEF]: Pe, [En.SPHERICAL_MARS_PCPF]: null, [En.SPHERICAL_MOON_PCPF]: null, [En.UNKNOWN]: null, [En.WEB_MERCATOR]: null, [En.PLATE_CARREE]: ue$3, [En.WGS84]: null, [En.WGS84_ECEF]: We$1 }, [En.GCSMARS2000]: { [En.CGCS2000]: null, [En.GCSMARS2000]: Qn, [En.GCSMOON2000]: null, [En.LON_LAT]: Qn, [En.WGS84_COMPARABLE_LON_LAT]: null, [En.SPHERICAL_ECEF]: null, [En.SPHERICAL_MARS_PCPF]: Se$1, [En.SPHERICAL_MOON_PCPF]: null, [En.UNKNOWN]: null, [En.WEB_MERCATOR]: null, [En.PLATE_CARREE]: null, [En.WGS84]: null, [En.WGS84_ECEF]: null }, [En.GCSMOON2000]: { [En.CGCS2000]: null, [En.GCSMARS2000]: null, [En.GCSMOON2000]: Qn, [En.LON_LAT]: Qn, [En.WGS84_COMPARABLE_LON_LAT]: null, [En.SPHERICAL_ECEF]: null, [En.SPHERICAL_MARS_PCPF]: null, [En.SPHERICAL_MOON_PCPF]: _e$1, [En.UNKNOWN]: null, [En.WEB_MERCATOR]: null, [En.PLATE_CARREE]: null, [En.WGS84]: null, [En.WGS84_ECEF]: null }, [En.WEB_MERCATOR]: { [En.CGCS2000]: null, [En.GCSMARS2000]: null, [En.GCSMOON2000]: null, [En.LON_LAT]: Yn, [En.WGS84_COMPARABLE_LON_LAT]: Yn, [En.SPHERICAL_ECEF]: $n, [En.SPHERICAL_MARS_PCPF]: null, [En.SPHERICAL_MOON_PCPF]: null, [En.UNKNOWN]: null, [En.WEB_MERCATOR]: Qn, [En.PLATE_CARREE]: se$2, [En.WGS84]: Yn, [En.WGS84_ECEF]: ne$3 }, [En.WGS84_ECEF]: { [En.CGCS2000]: me$2, [En.GCSMARS2000]: null, [En.GCSMOON2000]: null, [En.LON_LAT]: me$2, [En.WGS84_COMPARABLE_LON_LAT]: me$2, [En.SPHERICAL_ECEF]: Te, [En.SPHERICAL_MARS_PCPF]: null, [En.SPHERICAL_MOON_PCPF]: null, [En.UNKNOWN]: null, [En.WEB_MERCATOR]: Fe, [En.PLATE_CARREE]: ie$4, [En.WGS84]: me$2, [En.WGS84_ECEF]: Qn }, [En.SPHERICAL_ECEF]: { [En.CGCS2000]: Me, [En.GCSMARS2000]: null, [En.GCSMOON2000]: null, [En.LON_LAT]: Me, [En.WGS84_COMPARABLE_LON_LAT]: Me, [En.SPHERICAL_ECEF]: Qn, [En.SPHERICAL_MARS_PCPF]: null, [En.SPHERICAL_MOON_PCPF]: null, [En.UNKNOWN]: null, [En.WEB_MERCATOR]: Ne$1, [En.PLATE_CARREE]: ae$3, [En.WGS84]: Me, [En.WGS84_ECEF]: Ge$1 }, [En.SPHERICAL_MARS_PCPF]: { [En.CGCS2000]: null, [En.GCSMARS2000]: Oe, [En.GCSMOON2000]: null, [En.LON_LAT]: Oe, [En.WGS84_COMPARABLE_LON_LAT]: null, [En.SPHERICAL_ECEF]: null, [En.SPHERICAL_MARS_PCPF]: Qn, [En.SPHERICAL_MOON_PCPF]: null, [En.UNKNOWN]: null, [En.WEB_MERCATOR]: null, [En.PLATE_CARREE]: null, [En.WGS84]: null, [En.WGS84_ECEF]: null }, [En.SPHERICAL_MOON_PCPF]: { [En.CGCS2000]: null, [En.GCSMARS2000]: null, [En.GCSMOON2000]: Le, [En.LON_LAT]: Le, [En.WGS84_COMPARABLE_LON_LAT]: null, [En.SPHERICAL_ECEF]: null, [En.SPHERICAL_MARS_PCPF]: null, [En.SPHERICAL_MOON_PCPF]: Qn, [En.UNKNOWN]: null, [En.WEB_MERCATOR]: null, [En.PLATE_CARREE]: null, [En.WGS84]: null, [En.WGS84_ECEF]: null }, [En.UNKNOWN]: { [En.CGCS2000]: null, [En.GCSMARS2000]: null, [En.GCSMOON2000]: null, [En.LON_LAT]: null, [En.WGS84_COMPARABLE_LON_LAT]: null, [En.SPHERICAL_ECEF]: null, [En.SPHERICAL_MARS_PCPF]: null, [En.SPHERICAL_MOON_PCPF]: null, [En.UNKNOWN]: Qn, [En.WEB_MERCATOR]: null, [En.PLATE_CARREE]: null, [En.WGS84]: null, [En.WGS84_ECEF]: null }, [En.LON_LAT]: { [En.CGCS2000]: Qn, [En.GCSMARS2000]: Qn, [En.GCSMOON2000]: Qn, [En.LON_LAT]: Qn, [En.WGS84_COMPARABLE_LON_LAT]: Qn, [En.SPHERICAL_ECEF]: Pe, [En.SPHERICAL_MARS_PCPF]: Se$1, [En.SPHERICAL_MOON_PCPF]: _e$1, [En.UNKNOWN]: null, [En.WEB_MERCATOR]: te$4, [En.PLATE_CARREE]: ue$3, [En.WGS84]: Qn, [En.WGS84_ECEF]: We$1 }, [En.WGS84_COMPARABLE_LON_LAT]: { [En.CGCS2000]: null, [En.GCSMARS2000]: null, [En.GCSMOON2000]: null, [En.LON_LAT]: Qn, [En.WGS84_COMPARABLE_LON_LAT]: Qn, [En.SPHERICAL_ECEF]: Pe, [En.SPHERICAL_MARS_PCPF]: null, [En.SPHERICAL_MOON_PCPF]: null, [En.UNKNOWN]: null, [En.WEB_MERCATOR]: null, [En.PLATE_CARREE]: ue$3, [En.WGS84]: Qn, [En.WGS84_ECEF]: We$1 }, [En.PLATE_CARREE]: { [En.CGCS2000]: oe$4, [En.GCSMARS2000]: null, [En.GCSMOON2000]: null, [En.LON_LAT]: oe$4, [En.WGS84_COMPARABLE_LON_LAT]: oe$4, [En.SPHERICAL_ECEF]: ce$3, [En.SPHERICAL_MARS_PCPF]: null, [En.SPHERICAL_MOON_PCPF]: null, [En.UNKNOWN]: null, [En.WEB_MERCATOR]: Ee, [En.PLATE_CARREE]: Qn, [En.WGS84]: oe$4, [En.WGS84_ECEF]: Ce } };
function de$2(n2, e2, t2 = ge$2()) {
  return t$2r(n2) || t$2r(e2) ? null : He(n2, e2, t2).projector;
}
function He(n2, e2, t2) {
  if (t$2r(n2) || t$2r(e2) || t2.source.spatialReference === n2 && t2.dest.spatialReference === e2)
    return t2;
  const r2 = Jn(n2, t2.source), l2 = Jn(e2, t2.dest);
  return r2 === En.UNKNOWN && l2 === En.UNKNOWN ? E$P(n2, e2) ? t2.projector = Qn : t2.projector = null : t2.projector = Ie[r2][l2], t2;
}
function ge$2() {
  return { source: { spatialReference: null, spatialReferenceId: En.UNKNOWN, metersPerUnit: 1 }, dest: { spatialReference: null, spatialReferenceId: En.UNKNOWN, metersPerUnit: 1 }, projector: Qn };
}
const Be$1 = { spatialReference: null, spatialReferenceId: En.UNKNOWN }, je$1 = { spatialReference: null, spatialReferenceId: En.UNKNOWN }, ye$3 = ge$2();
ge$2();
const Ue = m$2a(1), xe = b$10(1), Ke = n$2v(), be = n$2v(), ke = n$2v(), ze$1 = n$2v();
var i$28;
let l$1J = i$28 = class extends l$2B {
  constructor(e2) {
    super(e2), this.cols = null, this.level = 0, this.levelValue = null, this.origin = null, this.resolution = 0, this.rows = null, this.scale = 0;
  }
  clone() {
    return new i$28({ cols: this.cols, level: this.level, levelValue: this.levelValue, resolution: this.resolution, rows: this.rows, scale: this.scale });
  }
};
e$2g([y$1I({ json: { write: true, origins: { "web-document": { read: false, write: false }, "portal-item": { read: false, write: false } } } })], l$1J.prototype, "cols", void 0), e$2g([y$1I({ type: T$G, json: { write: true } })], l$1J.prototype, "level", void 0), e$2g([y$1I({ type: String, json: { write: true } })], l$1J.prototype, "levelValue", void 0), e$2g([y$1I({ json: { write: true, origins: { "web-document": { read: false, write: false }, "portal-item": { read: false, write: false } } } })], l$1J.prototype, "origin", void 0), e$2g([y$1I({ type: Number, json: { write: true } })], l$1J.prototype, "resolution", void 0), e$2g([y$1I({ json: { write: true, origins: { "web-document": { read: false, write: false }, "portal-item": { read: false, write: false } } } })], l$1J.prototype, "rows", void 0), e$2g([y$1I({ type: Number, json: { write: true } })], l$1J.prototype, "scale", void 0), l$1J = i$28 = e$2g([n$2P("esri.layers.support.LOD")], l$1J);
const p$2u = l$1J;
class t$1z {
  constructor(t2, s2, i2, e2, h2) {
    this.id = t2, this.level = s2, this.row = i2, this.col = e2, this.extent = h2;
  }
}
var x$K;
const O$r = new s$2a({ PNG: "png", PNG8: "png8", PNG24: "png24", PNG32: "png32", JPEG: "jpg", JPG: "jpg", DIB: "dib", TIFF: "tiff", EMF: "emf", PS: "ps", PDF: "pdf", GIF: "gif", SVG: "svg", SVGZ: "svgz", Mixed: "mixed", MIXED: "mixed", LERC: "lerc", LERC2D: "lerc2d", RAW: "raw", pbf: "pbf" });
let S$C = x$K = class extends l$2B {
  constructor(e2) {
    super(e2), this.dpi = 96, this.format = null, this.origin = null, this.minScale = 0, this.maxScale = 0, this.size = null, this.spatialReference = null;
  }
  static create(e2 = {}) {
    const { resolutionFactor: t2 = 1, scales: o2, size: r2 = 256, spatialReference: i2 = k$C.WebMercator, numLODs: l2 = 24 } = e2;
    if (!I$K(i2)) {
      const e3 = [];
      if (o2)
        for (let t3 = 0; t3 < o2.length; t3++) {
          const r3 = o2[t3];
          e3.push({ level: t3, scale: r3, resolution: r3 });
        }
      else {
        let t3 = 5e-4;
        for (let o3 = l2 - 1; o3 >= 0; o3--)
          e3.unshift({ level: o3, scale: t3, resolution: t3 }), t3 *= 2;
      }
      return new x$K({ dpi: 96, lods: e3, origin: new w$_(0, 0, i2), size: [r2, r2], spatialReference: i2 });
    }
    const n2 = R$B(i2), a2 = e2.origin ? new w$_({ x: e2.origin.x, y: e2.origin.y, spatialReference: i2 }) : new w$_(n2 ? { x: n2.origin[0], y: n2.origin[1], spatialReference: i2 } : { x: 0, y: 0, spatialReference: i2 }), p2 = 96, f2 = 1 / ($$g(i2) * 39.37 * p2), y2 = [];
    if (o2)
      for (let s2 = 0; s2 < o2.length; s2++) {
        const e3 = o2[s2], t3 = e3 * f2;
        y2.push({ level: s2, scale: e3, resolution: t3 });
      }
    else {
      let e3 = o$27(i2) ? 512 / r2 * 5916575275917094e-7 : 256 / r2 * 591657527591555e-6;
      const o3 = Math.ceil(l2 / t2);
      y2.push({ level: 0, scale: e3, resolution: e3 * f2 });
      for (let r3 = 1; r3 < o3; r3++) {
        const o4 = e3 / 2 ** t2, s2 = o4 * f2;
        y2.push({ level: r3, scale: o4, resolution: s2 }), e3 = o4;
      }
    }
    return new x$K({ dpi: p2, lods: y2, origin: a2, size: [r2, r2], spatialReference: i2 });
  }
  get isWrappable() {
    const { spatialReference: e2, origin: t2 } = this;
    if (e2 && t2) {
      const o2 = R$B(e2);
      return e2.isWrappable && !!o2 && Math.abs(o2.origin[0] - t2.x) <= o2.dx;
    }
    return false;
  }
  readOrigin(e2, t2) {
    return w$_.fromJSON(__spreadValues({ spatialReference: t2.spatialReference }, e2));
  }
  set lods(e2) {
    let t2 = 0, o2 = 0;
    const r2 = [], s2 = this._levelToLOD = {};
    e2 && (t2 = -1 / 0, o2 = 1 / 0, e2.forEach((e3) => {
      r2.push(e3.scale), t2 = e3.scale > t2 ? e3.scale : t2, o2 = e3.scale < o2 ? e3.scale : o2, s2[e3.level] = e3;
    })), this._set("scales", r2), this._set("minScale", t2), this._set("maxScale", o2), this._set("lods", e2), this._initializeUpsampleLevels();
  }
  readSize(e2, t2) {
    return [t2.cols, t2.rows];
  }
  writeSize(e2, t2) {
    t2.cols = e2[0], t2.rows = e2[1];
  }
  zoomToScale(e2) {
    const t2 = this.scales;
    if (e2 <= 0)
      return t2[0];
    if (e2 >= t2.length - 1)
      return t2[t2.length - 1];
    const o2 = Math.floor(e2), r2 = o2 + 1;
    return t2[o2] / (t2[o2] / t2[r2]) ** (e2 - o2);
  }
  scaleToZoom(e2) {
    const t2 = this.scales, o2 = t2.length - 1;
    let r2 = 0;
    for (; r2 < o2; r2++) {
      const o3 = t2[r2], s2 = t2[r2 + 1];
      if (o3 <= e2)
        return r2;
      if (s2 === e2)
        return r2 + 1;
      if (o3 > e2 && s2 < e2)
        return r2 + Math.log(o3 / e2) / Math.log(o3 / s2);
    }
    return r2;
  }
  snapScale(e2, t2 = 0.95) {
    const o2 = this.scaleToZoom(e2);
    return o2 % Math.floor(o2) >= t2 ? this.zoomToScale(Math.ceil(o2)) : this.zoomToScale(Math.floor(o2));
  }
  tileAt(e2, t2, o2, s2) {
    const i2 = this.lodAt(e2);
    if (!i2)
      return null;
    let l2, n2;
    if (typeof t2 == "number")
      l2 = t2, n2 = o2;
    else if (E$P(t2.spatialReference, this.spatialReference))
      l2 = t2.x, n2 = t2.y, s2 = o2;
    else {
      const e3 = M$L(t2, this.spatialReference);
      if (t$2r(e3))
        return null;
      l2 = e3.x, n2 = e3.y, s2 = o2;
    }
    const a2 = i2.resolution * this.size[0], p2 = i2.resolution * this.size[1];
    return s2 || (s2 = new t$1z(null, 0, 0, 0, u$1O())), s2.level = e2, s2.row = Math.floor((this.origin.y - n2) / p2 + 1e-3), s2.col = Math.floor((l2 - this.origin.x) / a2 + 1e-3), this.updateTileInfo(s2), s2;
  }
  updateTileInfo(e2, t2 = x$K.ExtrapolateOptions.NONE) {
    let o2 = this.lodAt(e2.level);
    if (!o2 && t2 === x$K.ExtrapolateOptions.POWER_OF_TWO) {
      const t3 = this.lods[this.lods.length - 1];
      t3.level < e2.level && (o2 = t3);
    }
    if (!o2)
      return;
    const r2 = e2.level - o2.level, s2 = o2.resolution * this.size[0] / 2 ** r2, i2 = o2.resolution * this.size[1] / 2 ** r2;
    e2.id = `${e2.level}/${e2.row}/${e2.col}`, e2.extent || (e2.extent = u$1O()), e2.extent[0] = this.origin.x + e2.col * s2, e2.extent[1] = this.origin.y - (e2.row + 1) * i2, e2.extent[2] = e2.extent[0] + s2, e2.extent[3] = e2.extent[1] + i2;
  }
  upsampleTile(e2) {
    const t2 = this._upsampleLevels[e2.level];
    return !(!t2 || t2.parentLevel === -1) && (e2.level = t2.parentLevel, e2.row = Math.floor(e2.row / t2.factor + 1e-3), e2.col = Math.floor(e2.col / t2.factor + 1e-3), this.updateTileInfo(e2), true);
  }
  getTileBounds(e2, t2) {
    const o2 = this.lodAt(t2.level);
    if (o2 == null)
      return null;
    const { resolution: r2 } = o2, s2 = r2 * this.size[0], i2 = r2 * this.size[1];
    return e2[0] = this.origin.x + t2.col * s2, e2[1] = this.origin.y - (t2.row + 1) * i2, e2[2] = e2[0] + s2, e2[3] = e2[1] + i2, e2;
  }
  lodAt(e2) {
    var _a2, _b2;
    return (_b2 = (_a2 = this._levelToLOD) == null ? void 0 : _a2[e2]) != null ? _b2 : null;
  }
  clone() {
    return x$K.fromJSON(this.write({}));
  }
  getOrCreateCompatible(e2, t2) {
    if (this.size[0] === 256 && this.size[1] === 256)
      return e2 === 256 ? this : null;
    const o2 = [], r2 = this.lods.length;
    for (let s2 = 0; s2 < r2; s2++) {
      const e3 = this.lods[s2], r3 = e3.resolution * t2;
      o2.push(new p$2u({ level: e3.level, scale: e3.scale, resolution: r3 }));
    }
    return new x$K({ size: [e2, e2], dpi: this.dpi, format: this.format, compressionQuality: this.compressionQuality, origin: this.origin, spatialReference: this.spatialReference, lods: o2 });
  }
  _initializeUpsampleLevels() {
    const e2 = this.lods;
    this._upsampleLevels = [];
    let t2 = null;
    for (let o2 = 0; o2 < e2.length; o2++) {
      const r2 = e2[o2];
      this._upsampleLevels[r2.level] = { parentLevel: t2 ? t2.level : -1, factor: t2 ? t2.resolution / r2.resolution : 0 }, t2 = r2;
    }
  }
};
e$2g([y$1I({ type: Number, json: { write: true } })], S$C.prototype, "compressionQuality", void 0), e$2g([y$1I({ type: Number, json: { write: true } })], S$C.prototype, "dpi", void 0), e$2g([y$1I({ type: String, json: { read: O$r.read, write: O$r.write, origins: { "web-scene": { read: false, write: false } } } })], S$C.prototype, "format", void 0), e$2g([y$1I({ readOnly: true })], S$C.prototype, "isWrappable", null), e$2g([y$1I({ type: w$_, json: { write: true } })], S$C.prototype, "origin", void 0), e$2g([o$29("origin")], S$C.prototype, "readOrigin", null), e$2g([y$1I({ type: [p$2u], value: null, json: { write: true } })], S$C.prototype, "lods", null), e$2g([y$1I({ readOnly: true })], S$C.prototype, "minScale", void 0), e$2g([y$1I({ readOnly: true })], S$C.prototype, "maxScale", void 0), e$2g([y$1I({ readOnly: true })], S$C.prototype, "scales", void 0), e$2g([y$1I({ cast: (e2) => Array.isArray(e2) ? e2 : typeof e2 == "number" ? [e2, e2] : [256, 256] })], S$C.prototype, "size", void 0), e$2g([o$29("size", ["rows", "cols"])], S$C.prototype, "readSize", null), e$2g([r$1P("size", { cols: { type: T$G }, rows: { type: T$G } })], S$C.prototype, "writeSize", null), e$2g([y$1I({ type: k$C, json: { write: true } })], S$C.prototype, "spatialReference", void 0), S$C = x$K = e$2g([n$2P("esri.layers.support.TileInfo")], S$C), function(e2) {
  var t2;
  (t2 = e2.ExtrapolateOptions || (e2.ExtrapolateOptions = {}))[t2.NONE = 0] = "NONE", t2[t2.POWER_OF_TWO = 1] = "POWER_OF_TWO";
}(S$C || (S$C = {}));
const j$E = S$C;
const n$23 = { widthBreakpoint: { getValue(e2) {
  const i2 = e2.viewSize[0], s2 = e2.breakpoints, a2 = this.values;
  return i2 <= s2.xsmall ? a2.xsmall : i2 <= s2.small ? a2.small : i2 <= s2.medium ? a2.medium : i2 <= s2.large ? a2.large : a2.xlarge;
}, values: { xsmall: "xsmall", small: "small", medium: "medium", large: "large", xlarge: "xlarge" }, valueToClassName: { xsmall: "esri-view-width-xsmall esri-view-width-less-than-small esri-view-width-less-than-medium esri-view-width-less-than-large esri-view-width-less-than-xlarge", small: "esri-view-width-small esri-view-width-greater-than-xsmall esri-view-width-less-than-medium esri-view-width-less-than-large esri-view-width-less-than-xlarge", medium: "esri-view-width-medium esri-view-width-greater-than-xsmall esri-view-width-greater-than-small esri-view-width-less-than-large esri-view-width-less-than-xlarge", large: "esri-view-width-large esri-view-width-greater-than-xsmall esri-view-width-greater-than-small esri-view-width-greater-than-medium esri-view-width-less-than-xlarge", xlarge: "esri-view-width-xlarge esri-view-width-greater-than-xsmall esri-view-width-greater-than-small esri-view-width-greater-than-medium esri-view-width-greater-than-large" } }, heightBreakpoint: { getValue(e2) {
  const i2 = e2.viewSize[1], s2 = e2.breakpoints, a2 = this.values;
  return i2 <= s2.xsmall ? a2.xsmall : i2 <= s2.small ? a2.small : i2 <= s2.medium ? a2.medium : i2 <= s2.large ? a2.large : a2.xlarge;
}, values: { xsmall: "xsmall", small: "small", medium: "medium", large: "large", xlarge: "xlarge" }, valueToClassName: { xsmall: "esri-view-height-xsmall esri-view-height-less-than-small esri-view-height-less-than-medium esri-view-height-less-than-large esri-view-height-less-than-xlarge", small: "esri-view-height-small esri-view-height-greater-than-xsmall esri-view-height-less-than-medium esri-view-height-less-than-large esri-view-height-less-than-xlarge", medium: "esri-view-height-medium esri-view-height-greater-than-xsmall esri-view-height-greater-than-small esri-view-height-less-than-large esri-view-height-less-than-xlarge", large: "esri-view-height-large esri-view-height-greater-than-xsmall esri-view-height-greater-than-small esri-view-height-greater-than-medium esri-view-height-less-than-xlarge", xlarge: "esri-view-height-xlarge esri-view-height-greater-than-xsmall esri-view-height-greater-than-small esri-view-height-greater-than-medium esri-view-height-greater-than-large" } }, orientation: { getValue(e2) {
  const i2 = e2.viewSize, s2 = i2[0], a2 = i2[1], t2 = this.values;
  return a2 >= s2 ? t2.portrait : t2.landscape;
}, values: { portrait: "portrait", landscape: "landscape" }, valueToClassName: { portrait: "esri-view-orientation-portrait", landscape: "esri-view-orientation-landscape" } } }, o$1y = { xsmall: 544, small: 768, medium: 992, large: 1200 };
function m$1F(e2) {
  const i2 = e2;
  return i2 && i2.xsmall < i2.small && i2.small < i2.medium && i2.medium < i2.large;
}
function g$W(e2, i2) {
  return i2 ? n$23[e2].valueToClassName[i2].split(" ") : [];
}
const w$M = (w2) => {
  let d2 = class extends w2 {
    constructor(...e2) {
      super(...e2), this._breakpointsHandles = new t$2g(), this.orientation = null, this.widthBreakpoint = null, this.heightBreakpoint = null, this.breakpoints = o$1y;
    }
    initialize() {
      this._breakpointsHandles.add(l$1P(() => [this.breakpoints, this.size], () => this._updateClassNames(), h$1j));
    }
    destroy() {
      this.destroyed || (this._removeActiveClassNames(), this._breakpointsHandles = s$2D(this._breakpointsHandles));
    }
    set breakpoints(e2) {
      if (e2 === this._get("breakpoints"))
        return;
      const i2 = m$1F(e2);
      if (!i2) {
        const e3 = JSON.stringify(o$1y, null, 2);
        console.warn("provided breakpoints are not valid, using defaults:" + e3);
      }
      e2 = i2 ? e2 : o$1y, this._set("breakpoints", __spreadValues({}, e2));
    }
    _updateClassNames() {
      if (!this.container)
        return;
      const e2 = t$2c.acquire(), s2 = t$2c.acquire();
      let a2, t2 = false;
      for (a2 in n$23) {
        const i2 = this[a2], r2 = n$23[a2].getValue({ viewSize: this.size, breakpoints: this.breakpoints });
        i2 !== r2 && (t2 = true, this[a2] = r2, g$W(a2, i2).forEach((e3) => s2.push(e3)), g$W(a2, r2).forEach((i3) => e2.push(i3)));
      }
      t2 && (this._applyClassNameChanges(e2, s2), t$2c.release(e2), t$2c.release(s2));
    }
    _applyClassNameChanges(e2, i2) {
      const s2 = this.container;
      s2 && (i2.forEach((e3) => s2.classList.remove(e3)), e2.forEach((e3) => s2.classList.add(e3)));
    }
    _removeActiveClassNames() {
      const e2 = this.container;
      if (!e2)
        return;
      let i2;
      for (i2 in n$23)
        g$W(i2, this[i2]).forEach((i3) => e2.classList.remove(i3));
    }
  };
  return e$2g([y$1I()], d2.prototype, "breakpoints", null), e$2g([y$1I()], d2.prototype, "orientation", void 0), e$2g([y$1I()], d2.prototype, "widthBreakpoint", void 0), e$2g([y$1I()], d2.prototype, "heightBreakpoint", void 0), d2 = e$2g([n$2P("esri.views.BreakpointsOwner")], d2), d2;
};
function e$1p(e2) {
  return typeof e2 == "string" ? document.getElementById(e2) : e2 != null ? e2 : null;
}
function t$1y(e2) {
  for (; e2.hasChildNodes(); )
    e2.removeChild(e2.firstChild);
}
function o$1x(e2, t2) {
  const n2 = t2.parentNode;
  n2 && n2.insertBefore(e2, t2);
}
function r$1k(e2, t2) {
  for (; ; ) {
    const n2 = e2.firstChild;
    if (!n2)
      break;
    t2.appendChild(n2);
  }
}
let c$2c = class extends m$2q {
  constructor() {
    super(...arguments), this.updating = false, this._handleId = 0, this._handles = new t$2g(), this._scheduleHandleId = 0, this._pendingPromises = new Set();
  }
  destroy() {
    this.removeAll(), this._handles.destroy();
  }
  add(e2, s2, t2 = {}) {
    return this._installWatch(e2, s2, t2, l$1P);
  }
  addWhen(e2, s2, t2 = {}) {
    return this._installWatch(e2, s2, t2, f$1o);
  }
  addOnCollectionChange(e2, s2, { initial: t2 = false, final: i2 = false } = {}) {
    const n2 = ++this._handleId;
    return this._handles.add([a$2a(e2, "after-changes", this._createSyncUpdatingCallback(), U$r), a$2a(e2, "change", s2, { onListenerAdd: t2 ? (e3) => s2({ added: e3.toArray(), removed: [] }) : void 0, onListenerRemove: i2 ? (e3) => s2({ added: [], removed: e3.toArray() }) : void 0 })], n2), { remove: () => this._handles.remove(n2) };
  }
  addPromise(e2) {
    if (t$2r(e2))
      return e2;
    const s2 = ++this._handleId;
    this._handles.add({ remove: () => {
      this._pendingPromises.delete(e2) && (this._pendingPromises.size !== 0 || this._handles.has(_$A) || this._set("updating", false));
    } }, s2), this._pendingPromises.add(e2), this._set("updating", true);
    const t2 = () => this._handles.remove(s2);
    return e2.then(t2, t2), e2;
  }
  removeAll() {
    this._pendingPromises.clear(), this._handles.removeAll(), this._set("updating", false);
  }
  _installWatch(e2, s2, t2 = {}, i2) {
    const n2 = ++this._handleId;
    t2.sync || this._installSyncUpdatingWatch(e2, n2);
    const d2 = i2(e2, s2, t2);
    return this._handles.add(d2, n2), { remove: () => this._handles.remove(n2) };
  }
  _installSyncUpdatingWatch(e2, s2) {
    const t2 = this._createSyncUpdatingCallback(), i2 = l$1P(e2, t2, { sync: true, equals: () => false });
    return this._handles.add(i2, s2), i2;
  }
  _createSyncUpdatingCallback() {
    return () => {
      this._handles.remove(_$A), ++this._scheduleHandleId;
      const e2 = this._scheduleHandleId;
      this._get("updating") || this._set("updating", true), this._handles.add(v$18(() => {
        e2 === this._scheduleHandleId && (this._set("updating", this._pendingPromises.size > 0), this._handles.remove(_$A));
      }), _$A);
    };
  }
};
e$2g([y$1I({ readOnly: true })], c$2c.prototype, "updating", void 0), c$2c = e$2g([n$2P("esri.core.support.WatchUpdatingTracking")], c$2c);
const _$A = -42;
/*!
 * @esri/arcgis-html-sanitizer - v3.0.1 - Tue Nov 15 2022 09:46:54 GMT-0800 (Pacific Standard Time)
 * Copyright (c) 2022 - Environmental Systems Research Institute, Inc.
 * Apache-2.0
 * 
 * js-xss
 * Copyright (c) 2012-2018 Zongmin Lei() <leizongmin@gmail.com>
 * http://ucdok.com
 * MIT License, see https://github.com/leizongmin/js-xss/blob/master/LICENSE for details
 */
var isPlainObject = function(value) {
  if (typeof value !== "object" || value === null) {
    return false;
  }
  if (Object.prototype.toString.call(value) !== "[object Object]") {
    return false;
  }
  var proto = Object.getPrototypeOf(value);
  if (proto === null) {
    return true;
  }
  while (Object.getPrototypeOf(proto) !== null) {
    proto = Object.getPrototypeOf(proto);
  }
  return Object.getPrototypeOf(value) === proto;
};
var lib$1 = { exports: {} };
var _default$1 = {};
var lib = { exports: {} };
var _default = {};
function getDefaultWhiteList$1() {
  var whiteList = {};
  whiteList["align-content"] = false;
  whiteList["align-items"] = false;
  whiteList["align-self"] = false;
  whiteList["alignment-adjust"] = false;
  whiteList["alignment-baseline"] = false;
  whiteList["all"] = false;
  whiteList["anchor-point"] = false;
  whiteList["animation"] = false;
  whiteList["animation-delay"] = false;
  whiteList["animation-direction"] = false;
  whiteList["animation-duration"] = false;
  whiteList["animation-fill-mode"] = false;
  whiteList["animation-iteration-count"] = false;
  whiteList["animation-name"] = false;
  whiteList["animation-play-state"] = false;
  whiteList["animation-timing-function"] = false;
  whiteList["azimuth"] = false;
  whiteList["backface-visibility"] = false;
  whiteList["background"] = true;
  whiteList["background-attachment"] = true;
  whiteList["background-clip"] = true;
  whiteList["background-color"] = true;
  whiteList["background-image"] = true;
  whiteList["background-origin"] = true;
  whiteList["background-position"] = true;
  whiteList["background-repeat"] = true;
  whiteList["background-size"] = true;
  whiteList["baseline-shift"] = false;
  whiteList["binding"] = false;
  whiteList["bleed"] = false;
  whiteList["bookmark-label"] = false;
  whiteList["bookmark-level"] = false;
  whiteList["bookmark-state"] = false;
  whiteList["border"] = true;
  whiteList["border-bottom"] = true;
  whiteList["border-bottom-color"] = true;
  whiteList["border-bottom-left-radius"] = true;
  whiteList["border-bottom-right-radius"] = true;
  whiteList["border-bottom-style"] = true;
  whiteList["border-bottom-width"] = true;
  whiteList["border-collapse"] = true;
  whiteList["border-color"] = true;
  whiteList["border-image"] = true;
  whiteList["border-image-outset"] = true;
  whiteList["border-image-repeat"] = true;
  whiteList["border-image-slice"] = true;
  whiteList["border-image-source"] = true;
  whiteList["border-image-width"] = true;
  whiteList["border-left"] = true;
  whiteList["border-left-color"] = true;
  whiteList["border-left-style"] = true;
  whiteList["border-left-width"] = true;
  whiteList["border-radius"] = true;
  whiteList["border-right"] = true;
  whiteList["border-right-color"] = true;
  whiteList["border-right-style"] = true;
  whiteList["border-right-width"] = true;
  whiteList["border-spacing"] = true;
  whiteList["border-style"] = true;
  whiteList["border-top"] = true;
  whiteList["border-top-color"] = true;
  whiteList["border-top-left-radius"] = true;
  whiteList["border-top-right-radius"] = true;
  whiteList["border-top-style"] = true;
  whiteList["border-top-width"] = true;
  whiteList["border-width"] = true;
  whiteList["bottom"] = false;
  whiteList["box-decoration-break"] = true;
  whiteList["box-shadow"] = true;
  whiteList["box-sizing"] = true;
  whiteList["box-snap"] = true;
  whiteList["box-suppress"] = true;
  whiteList["break-after"] = true;
  whiteList["break-before"] = true;
  whiteList["break-inside"] = true;
  whiteList["caption-side"] = false;
  whiteList["chains"] = false;
  whiteList["clear"] = true;
  whiteList["clip"] = false;
  whiteList["clip-path"] = false;
  whiteList["clip-rule"] = false;
  whiteList["color"] = true;
  whiteList["color-interpolation-filters"] = true;
  whiteList["column-count"] = false;
  whiteList["column-fill"] = false;
  whiteList["column-gap"] = false;
  whiteList["column-rule"] = false;
  whiteList["column-rule-color"] = false;
  whiteList["column-rule-style"] = false;
  whiteList["column-rule-width"] = false;
  whiteList["column-span"] = false;
  whiteList["column-width"] = false;
  whiteList["columns"] = false;
  whiteList["contain"] = false;
  whiteList["content"] = false;
  whiteList["counter-increment"] = false;
  whiteList["counter-reset"] = false;
  whiteList["counter-set"] = false;
  whiteList["crop"] = false;
  whiteList["cue"] = false;
  whiteList["cue-after"] = false;
  whiteList["cue-before"] = false;
  whiteList["cursor"] = false;
  whiteList["direction"] = false;
  whiteList["display"] = true;
  whiteList["display-inside"] = true;
  whiteList["display-list"] = true;
  whiteList["display-outside"] = true;
  whiteList["dominant-baseline"] = false;
  whiteList["elevation"] = false;
  whiteList["empty-cells"] = false;
  whiteList["filter"] = false;
  whiteList["flex"] = false;
  whiteList["flex-basis"] = false;
  whiteList["flex-direction"] = false;
  whiteList["flex-flow"] = false;
  whiteList["flex-grow"] = false;
  whiteList["flex-shrink"] = false;
  whiteList["flex-wrap"] = false;
  whiteList["float"] = false;
  whiteList["float-offset"] = false;
  whiteList["flood-color"] = false;
  whiteList["flood-opacity"] = false;
  whiteList["flow-from"] = false;
  whiteList["flow-into"] = false;
  whiteList["font"] = true;
  whiteList["font-family"] = true;
  whiteList["font-feature-settings"] = true;
  whiteList["font-kerning"] = true;
  whiteList["font-language-override"] = true;
  whiteList["font-size"] = true;
  whiteList["font-size-adjust"] = true;
  whiteList["font-stretch"] = true;
  whiteList["font-style"] = true;
  whiteList["font-synthesis"] = true;
  whiteList["font-variant"] = true;
  whiteList["font-variant-alternates"] = true;
  whiteList["font-variant-caps"] = true;
  whiteList["font-variant-east-asian"] = true;
  whiteList["font-variant-ligatures"] = true;
  whiteList["font-variant-numeric"] = true;
  whiteList["font-variant-position"] = true;
  whiteList["font-weight"] = true;
  whiteList["grid"] = false;
  whiteList["grid-area"] = false;
  whiteList["grid-auto-columns"] = false;
  whiteList["grid-auto-flow"] = false;
  whiteList["grid-auto-rows"] = false;
  whiteList["grid-column"] = false;
  whiteList["grid-column-end"] = false;
  whiteList["grid-column-start"] = false;
  whiteList["grid-row"] = false;
  whiteList["grid-row-end"] = false;
  whiteList["grid-row-start"] = false;
  whiteList["grid-template"] = false;
  whiteList["grid-template-areas"] = false;
  whiteList["grid-template-columns"] = false;
  whiteList["grid-template-rows"] = false;
  whiteList["hanging-punctuation"] = false;
  whiteList["height"] = true;
  whiteList["hyphens"] = false;
  whiteList["icon"] = false;
  whiteList["image-orientation"] = false;
  whiteList["image-resolution"] = false;
  whiteList["ime-mode"] = false;
  whiteList["initial-letters"] = false;
  whiteList["inline-box-align"] = false;
  whiteList["justify-content"] = false;
  whiteList["justify-items"] = false;
  whiteList["justify-self"] = false;
  whiteList["left"] = false;
  whiteList["letter-spacing"] = true;
  whiteList["lighting-color"] = true;
  whiteList["line-box-contain"] = false;
  whiteList["line-break"] = false;
  whiteList["line-grid"] = false;
  whiteList["line-height"] = false;
  whiteList["line-snap"] = false;
  whiteList["line-stacking"] = false;
  whiteList["line-stacking-ruby"] = false;
  whiteList["line-stacking-shift"] = false;
  whiteList["line-stacking-strategy"] = false;
  whiteList["list-style"] = true;
  whiteList["list-style-image"] = true;
  whiteList["list-style-position"] = true;
  whiteList["list-style-type"] = true;
  whiteList["margin"] = true;
  whiteList["margin-bottom"] = true;
  whiteList["margin-left"] = true;
  whiteList["margin-right"] = true;
  whiteList["margin-top"] = true;
  whiteList["marker-offset"] = false;
  whiteList["marker-side"] = false;
  whiteList["marks"] = false;
  whiteList["mask"] = false;
  whiteList["mask-box"] = false;
  whiteList["mask-box-outset"] = false;
  whiteList["mask-box-repeat"] = false;
  whiteList["mask-box-slice"] = false;
  whiteList["mask-box-source"] = false;
  whiteList["mask-box-width"] = false;
  whiteList["mask-clip"] = false;
  whiteList["mask-image"] = false;
  whiteList["mask-origin"] = false;
  whiteList["mask-position"] = false;
  whiteList["mask-repeat"] = false;
  whiteList["mask-size"] = false;
  whiteList["mask-source-type"] = false;
  whiteList["mask-type"] = false;
  whiteList["max-height"] = true;
  whiteList["max-lines"] = false;
  whiteList["max-width"] = true;
  whiteList["min-height"] = true;
  whiteList["min-width"] = true;
  whiteList["move-to"] = false;
  whiteList["nav-down"] = false;
  whiteList["nav-index"] = false;
  whiteList["nav-left"] = false;
  whiteList["nav-right"] = false;
  whiteList["nav-up"] = false;
  whiteList["object-fit"] = false;
  whiteList["object-position"] = false;
  whiteList["opacity"] = false;
  whiteList["order"] = false;
  whiteList["orphans"] = false;
  whiteList["outline"] = false;
  whiteList["outline-color"] = false;
  whiteList["outline-offset"] = false;
  whiteList["outline-style"] = false;
  whiteList["outline-width"] = false;
  whiteList["overflow"] = false;
  whiteList["overflow-wrap"] = false;
  whiteList["overflow-x"] = false;
  whiteList["overflow-y"] = false;
  whiteList["padding"] = true;
  whiteList["padding-bottom"] = true;
  whiteList["padding-left"] = true;
  whiteList["padding-right"] = true;
  whiteList["padding-top"] = true;
  whiteList["page"] = false;
  whiteList["page-break-after"] = false;
  whiteList["page-break-before"] = false;
  whiteList["page-break-inside"] = false;
  whiteList["page-policy"] = false;
  whiteList["pause"] = false;
  whiteList["pause-after"] = false;
  whiteList["pause-before"] = false;
  whiteList["perspective"] = false;
  whiteList["perspective-origin"] = false;
  whiteList["pitch"] = false;
  whiteList["pitch-range"] = false;
  whiteList["play-during"] = false;
  whiteList["position"] = false;
  whiteList["presentation-level"] = false;
  whiteList["quotes"] = false;
  whiteList["region-fragment"] = false;
  whiteList["resize"] = false;
  whiteList["rest"] = false;
  whiteList["rest-after"] = false;
  whiteList["rest-before"] = false;
  whiteList["richness"] = false;
  whiteList["right"] = false;
  whiteList["rotation"] = false;
  whiteList["rotation-point"] = false;
  whiteList["ruby-align"] = false;
  whiteList["ruby-merge"] = false;
  whiteList["ruby-position"] = false;
  whiteList["shape-image-threshold"] = false;
  whiteList["shape-outside"] = false;
  whiteList["shape-margin"] = false;
  whiteList["size"] = false;
  whiteList["speak"] = false;
  whiteList["speak-as"] = false;
  whiteList["speak-header"] = false;
  whiteList["speak-numeral"] = false;
  whiteList["speak-punctuation"] = false;
  whiteList["speech-rate"] = false;
  whiteList["stress"] = false;
  whiteList["string-set"] = false;
  whiteList["tab-size"] = false;
  whiteList["table-layout"] = false;
  whiteList["text-align"] = true;
  whiteList["text-align-last"] = true;
  whiteList["text-combine-upright"] = true;
  whiteList["text-decoration"] = true;
  whiteList["text-decoration-color"] = true;
  whiteList["text-decoration-line"] = true;
  whiteList["text-decoration-skip"] = true;
  whiteList["text-decoration-style"] = true;
  whiteList["text-emphasis"] = true;
  whiteList["text-emphasis-color"] = true;
  whiteList["text-emphasis-position"] = true;
  whiteList["text-emphasis-style"] = true;
  whiteList["text-height"] = true;
  whiteList["text-indent"] = true;
  whiteList["text-justify"] = true;
  whiteList["text-orientation"] = true;
  whiteList["text-overflow"] = true;
  whiteList["text-shadow"] = true;
  whiteList["text-space-collapse"] = true;
  whiteList["text-transform"] = true;
  whiteList["text-underline-position"] = true;
  whiteList["text-wrap"] = true;
  whiteList["top"] = false;
  whiteList["transform"] = false;
  whiteList["transform-origin"] = false;
  whiteList["transform-style"] = false;
  whiteList["transition"] = false;
  whiteList["transition-delay"] = false;
  whiteList["transition-duration"] = false;
  whiteList["transition-property"] = false;
  whiteList["transition-timing-function"] = false;
  whiteList["unicode-bidi"] = false;
  whiteList["vertical-align"] = false;
  whiteList["visibility"] = false;
  whiteList["voice-balance"] = false;
  whiteList["voice-duration"] = false;
  whiteList["voice-family"] = false;
  whiteList["voice-pitch"] = false;
  whiteList["voice-range"] = false;
  whiteList["voice-rate"] = false;
  whiteList["voice-stress"] = false;
  whiteList["voice-volume"] = false;
  whiteList["volume"] = false;
  whiteList["white-space"] = false;
  whiteList["widows"] = false;
  whiteList["width"] = true;
  whiteList["will-change"] = false;
  whiteList["word-break"] = true;
  whiteList["word-spacing"] = true;
  whiteList["word-wrap"] = true;
  whiteList["wrap-flow"] = false;
  whiteList["wrap-through"] = false;
  whiteList["writing-mode"] = false;
  whiteList["z-index"] = false;
  return whiteList;
}
function onAttr(name, value, options) {
}
function onIgnoreAttr(name, value, options) {
}
var REGEXP_URL_JAVASCRIPT = /javascript\s*\:/img;
function safeAttrValue$1(name, value) {
  if (REGEXP_URL_JAVASCRIPT.test(value))
    return "";
  return value;
}
_default.whiteList = getDefaultWhiteList$1();
_default.getDefaultWhiteList = getDefaultWhiteList$1;
_default.onAttr = onAttr;
_default.onIgnoreAttr = onIgnoreAttr;
_default.safeAttrValue = safeAttrValue$1;
var util$1 = {
  indexOf: function(arr, item) {
    var i2, j2;
    if (Array.prototype.indexOf) {
      return arr.indexOf(item);
    }
    for (i2 = 0, j2 = arr.length; i2 < j2; i2++) {
      if (arr[i2] === item) {
        return i2;
      }
    }
    return -1;
  },
  forEach: function(arr, fn2, scope) {
    var i2, j2;
    if (Array.prototype.forEach) {
      return arr.forEach(fn2, scope);
    }
    for (i2 = 0, j2 = arr.length; i2 < j2; i2++) {
      fn2.call(scope, arr[i2], i2, arr);
    }
  },
  trim: function(str) {
    if (String.prototype.trim) {
      return str.trim();
    }
    return str.replace(/(^\s*)|(\s*$)/g, "");
  },
  trimRight: function(str) {
    if (String.prototype.trimRight) {
      return str.trimRight();
    }
    return str.replace(/(\s*$)/g, "");
  }
};
var _$3$1 = util$1;
function parseStyle$1(css2, onAttr2) {
  css2 = _$3$1.trimRight(css2);
  if (css2[css2.length - 1] !== ";")
    css2 += ";";
  var cssLength = css2.length;
  var isParenthesisOpen = false;
  var lastPos = 0;
  var i2 = 0;
  var retCSS = "";
  function addNewAttr() {
    if (!isParenthesisOpen) {
      var source = _$3$1.trim(css2.slice(lastPos, i2));
      var j3 = source.indexOf(":");
      if (j3 !== -1) {
        var name = _$3$1.trim(source.slice(0, j3));
        var value = _$3$1.trim(source.slice(j3 + 1));
        if (name) {
          var ret = onAttr2(lastPos, retCSS.length, name, value, source);
          if (ret)
            retCSS += ret + "; ";
        }
      }
    }
    lastPos = i2 + 1;
  }
  for (; i2 < cssLength; i2++) {
    var c2 = css2[i2];
    if (c2 === "/" && css2[i2 + 1] === "*") {
      var j2 = css2.indexOf("*/", i2 + 2);
      if (j2 === -1)
        break;
      i2 = j2 + 1;
      lastPos = i2 + 1;
      isParenthesisOpen = false;
    } else if (c2 === "(") {
      isParenthesisOpen = true;
    } else if (c2 === ")") {
      isParenthesisOpen = false;
    } else if (c2 === ";") {
      if (isParenthesisOpen)
        ;
      else {
        addNewAttr();
      }
    } else if (c2 === "\n") {
      addNewAttr();
    }
  }
  return _$3$1.trim(retCSS);
}
var parser$2 = parseStyle$1;
var DEFAULT$1 = _default;
var parseStyle = parser$2;
function isNull$1(obj) {
  return obj === void 0 || obj === null;
}
function shallowCopyObject$1(obj) {
  var ret = {};
  for (var i2 in obj) {
    ret[i2] = obj[i2];
  }
  return ret;
}
function FilterCSS$2(options) {
  options = shallowCopyObject$1(options || {});
  options.whiteList = options.whiteList || DEFAULT$1.whiteList;
  options.onAttr = options.onAttr || DEFAULT$1.onAttr;
  options.onIgnoreAttr = options.onIgnoreAttr || DEFAULT$1.onIgnoreAttr;
  options.safeAttrValue = options.safeAttrValue || DEFAULT$1.safeAttrValue;
  this.options = options;
}
FilterCSS$2.prototype.process = function(css2) {
  css2 = css2 || "";
  css2 = css2.toString();
  if (!css2)
    return "";
  var me2 = this;
  var options = me2.options;
  var whiteList = options.whiteList;
  var onAttr2 = options.onAttr;
  var onIgnoreAttr2 = options.onIgnoreAttr;
  var safeAttrValue2 = options.safeAttrValue;
  var retCSS = parseStyle(css2, function(sourcePosition, position, name, value, source) {
    var check = whiteList[name];
    var isWhite = false;
    if (check === true)
      isWhite = check;
    else if (typeof check === "function")
      isWhite = check(value);
    else if (check instanceof RegExp)
      isWhite = check.test(value);
    if (isWhite !== true)
      isWhite = false;
    value = safeAttrValue2(name, value);
    if (!value)
      return;
    var opts = {
      position,
      sourcePosition,
      source,
      isWhite
    };
    if (isWhite) {
      var ret = onAttr2(name, value, opts);
      if (isNull$1(ret)) {
        return name + ":" + value;
      } else {
        return ret;
      }
    } else {
      var ret = onIgnoreAttr2(name, value, opts);
      if (!isNull$1(ret)) {
        return ret;
      }
    }
  });
  return retCSS;
};
var css = FilterCSS$2;
(function(module, exports) {
  var DEFAULT2 = _default;
  var FilterCSS2 = css;
  function filterCSS(html, options) {
    var xss2 = new FilterCSS2(options);
    return xss2.process(html);
  }
  exports = module.exports = filterCSS;
  exports.FilterCSS = FilterCSS2;
  for (var i2 in DEFAULT2)
    exports[i2] = DEFAULT2[i2];
})(lib, lib.exports);
var util = {
  indexOf: function(arr, item) {
    var i2, j2;
    if (Array.prototype.indexOf) {
      return arr.indexOf(item);
    }
    for (i2 = 0, j2 = arr.length; i2 < j2; i2++) {
      if (arr[i2] === item) {
        return i2;
      }
    }
    return -1;
  },
  forEach: function(arr, fn2, scope) {
    var i2, j2;
    if (Array.prototype.forEach) {
      return arr.forEach(fn2, scope);
    }
    for (i2 = 0, j2 = arr.length; i2 < j2; i2++) {
      fn2.call(scope, arr[i2], i2, arr);
    }
  },
  trim: function(str) {
    if (String.prototype.trim) {
      return str.trim();
    }
    return str.replace(/(^\s*)|(\s*$)/g, "");
  },
  spaceIndex: function(str) {
    var reg = /\s|\n|\t/;
    var match = reg.exec(str);
    return match ? match.index : -1;
  }
};
var FilterCSS$1 = lib.exports.FilterCSS;
var getDefaultCSSWhiteList = lib.exports.getDefaultWhiteList;
var _$2$1 = util;
function getDefaultWhiteList() {
  return {
    a: ["target", "href", "title"],
    abbr: ["title"],
    address: [],
    area: ["shape", "coords", "href", "alt"],
    article: [],
    aside: [],
    audio: [
      "autoplay",
      "controls",
      "crossorigin",
      "loop",
      "muted",
      "preload",
      "src"
    ],
    b: [],
    bdi: ["dir"],
    bdo: ["dir"],
    big: [],
    blockquote: ["cite"],
    br: [],
    caption: [],
    center: [],
    cite: [],
    code: [],
    col: ["align", "valign", "span", "width"],
    colgroup: ["align", "valign", "span", "width"],
    dd: [],
    del: ["datetime"],
    details: ["open"],
    div: [],
    dl: [],
    dt: [],
    em: [],
    figcaption: [],
    figure: [],
    font: ["color", "size", "face"],
    footer: [],
    h1: [],
    h2: [],
    h3: [],
    h4: [],
    h5: [],
    h6: [],
    header: [],
    hr: [],
    i: [],
    img: ["src", "alt", "title", "width", "height"],
    ins: ["datetime"],
    li: [],
    mark: [],
    nav: [],
    ol: [],
    p: [],
    pre: [],
    s: [],
    section: [],
    small: [],
    span: [],
    sub: [],
    summary: [],
    sup: [],
    strong: [],
    strike: [],
    table: ["width", "border", "align", "valign"],
    tbody: ["align", "valign"],
    td: ["width", "rowspan", "colspan", "align", "valign"],
    tfoot: ["align", "valign"],
    th: ["width", "rowspan", "colspan", "align", "valign"],
    thead: ["align", "valign"],
    tr: ["rowspan", "align", "valign"],
    tt: [],
    u: [],
    ul: [],
    video: [
      "autoplay",
      "controls",
      "crossorigin",
      "loop",
      "muted",
      "playsinline",
      "poster",
      "preload",
      "src",
      "height",
      "width"
    ]
  };
}
var defaultCSSFilter = new FilterCSS$1();
function onTag(tag, html, options) {
}
function onIgnoreTag(tag, html, options) {
}
function onTagAttr(tag, name, value) {
}
function onIgnoreTagAttr(tag, name, value) {
}
function escapeHtml(html) {
  return html.replace(REGEXP_LT, "&lt;").replace(REGEXP_GT, "&gt;");
}
function safeAttrValue(tag, name, value, cssFilter) {
  value = friendlyAttrValue(value);
  if (name === "href" || name === "src") {
    value = _$2$1.trim(value);
    if (value === "#")
      return "#";
    if (!(value.substr(0, 7) === "http://" || value.substr(0, 8) === "https://" || value.substr(0, 7) === "mailto:" || value.substr(0, 4) === "tel:" || value.substr(0, 11) === "data:image/" || value.substr(0, 6) === "ftp://" || value.substr(0, 2) === "./" || value.substr(0, 3) === "../" || value[0] === "#" || value[0] === "/")) {
      return "";
    }
  } else if (name === "background") {
    REGEXP_DEFAULT_ON_TAG_ATTR_4.lastIndex = 0;
    if (REGEXP_DEFAULT_ON_TAG_ATTR_4.test(value)) {
      return "";
    }
  } else if (name === "style") {
    REGEXP_DEFAULT_ON_TAG_ATTR_7.lastIndex = 0;
    if (REGEXP_DEFAULT_ON_TAG_ATTR_7.test(value)) {
      return "";
    }
    REGEXP_DEFAULT_ON_TAG_ATTR_8.lastIndex = 0;
    if (REGEXP_DEFAULT_ON_TAG_ATTR_8.test(value)) {
      REGEXP_DEFAULT_ON_TAG_ATTR_4.lastIndex = 0;
      if (REGEXP_DEFAULT_ON_TAG_ATTR_4.test(value)) {
        return "";
      }
    }
    if (cssFilter !== false) {
      cssFilter = cssFilter || defaultCSSFilter;
      value = cssFilter.process(value);
    }
  }
  value = escapeAttrValue(value);
  return value;
}
var REGEXP_LT = /</g;
var REGEXP_GT = />/g;
var REGEXP_QUOTE = /"/g;
var REGEXP_QUOTE_2 = /&quot;/g;
var REGEXP_ATTR_VALUE_1 = /&#([a-zA-Z0-9]*);?/gim;
var REGEXP_ATTR_VALUE_COLON = /&colon;?/gim;
var REGEXP_ATTR_VALUE_NEWLINE = /&newline;?/gim;
var REGEXP_DEFAULT_ON_TAG_ATTR_4 = /((j\s*a\s*v\s*a|v\s*b|l\s*i\s*v\s*e)\s*s\s*c\s*r\s*i\s*p\s*t\s*|m\s*o\s*c\s*h\s*a):/gi;
var REGEXP_DEFAULT_ON_TAG_ATTR_7 = /e\s*x\s*p\s*r\s*e\s*s\s*s\s*i\s*o\s*n\s*\(.*/gi;
var REGEXP_DEFAULT_ON_TAG_ATTR_8 = /u\s*r\s*l\s*\(.*/gi;
function escapeQuote(str) {
  return str.replace(REGEXP_QUOTE, "&quot;");
}
function unescapeQuote(str) {
  return str.replace(REGEXP_QUOTE_2, '"');
}
function escapeHtmlEntities(str) {
  return str.replace(REGEXP_ATTR_VALUE_1, function replaceUnicode(str2, code) {
    return code[0] === "x" || code[0] === "X" ? String.fromCharCode(parseInt(code.substr(1), 16)) : String.fromCharCode(parseInt(code, 10));
  });
}
function escapeDangerHtml5Entities(str) {
  return str.replace(REGEXP_ATTR_VALUE_COLON, ":").replace(REGEXP_ATTR_VALUE_NEWLINE, " ");
}
function clearNonPrintableCharacter(str) {
  var str2 = "";
  for (var i2 = 0, len = str.length; i2 < len; i2++) {
    str2 += str.charCodeAt(i2) < 32 ? " " : str.charAt(i2);
  }
  return _$2$1.trim(str2);
}
function friendlyAttrValue(str) {
  str = unescapeQuote(str);
  str = escapeHtmlEntities(str);
  str = escapeDangerHtml5Entities(str);
  str = clearNonPrintableCharacter(str);
  return str;
}
function escapeAttrValue(str) {
  str = escapeQuote(str);
  str = escapeHtml(str);
  return str;
}
function onIgnoreTagStripAll() {
  return "";
}
function StripTagBody(tags, next) {
  if (typeof next !== "function") {
    next = function() {
    };
  }
  var isRemoveAllTag = !Array.isArray(tags);
  function isRemoveTag(tag) {
    if (isRemoveAllTag)
      return true;
    return _$2$1.indexOf(tags, tag) !== -1;
  }
  var removeList = [];
  var posStart = false;
  return {
    onIgnoreTag: function(tag, html, options) {
      if (isRemoveTag(tag)) {
        if (options.isClosing) {
          var ret = "[/removed]";
          var end = options.position + ret.length;
          removeList.push([
            posStart !== false ? posStart : options.position,
            end
          ]);
          posStart = false;
          return ret;
        } else {
          if (!posStart) {
            posStart = options.position;
          }
          return "[removed]";
        }
      } else {
        return next(tag, html, options);
      }
    },
    remove: function(html) {
      var rethtml = "";
      var lastPos = 0;
      _$2$1.forEach(removeList, function(pos) {
        rethtml += html.slice(lastPos, pos[0]);
        lastPos = pos[1];
      });
      rethtml += html.slice(lastPos);
      return rethtml;
    }
  };
}
function stripCommentTag(html) {
  var retHtml = "";
  var lastPos = 0;
  while (lastPos < html.length) {
    var i2 = html.indexOf("<!--", lastPos);
    if (i2 === -1) {
      retHtml += html.slice(lastPos);
      break;
    }
    retHtml += html.slice(lastPos, i2);
    var j2 = html.indexOf("-->", i2);
    if (j2 === -1) {
      break;
    }
    lastPos = j2 + 3;
  }
  return retHtml;
}
function stripBlankChar(html) {
  var chars = html.split("");
  chars = chars.filter(function(char) {
    var c2 = char.charCodeAt(0);
    if (c2 === 127)
      return false;
    if (c2 <= 31) {
      if (c2 === 10 || c2 === 13)
        return true;
      return false;
    }
    return true;
  });
  return chars.join("");
}
_default$1.whiteList = getDefaultWhiteList();
_default$1.getDefaultWhiteList = getDefaultWhiteList;
_default$1.onTag = onTag;
_default$1.onIgnoreTag = onIgnoreTag;
_default$1.onTagAttr = onTagAttr;
_default$1.onIgnoreTagAttr = onIgnoreTagAttr;
_default$1.safeAttrValue = safeAttrValue;
_default$1.escapeHtml = escapeHtml;
_default$1.escapeQuote = escapeQuote;
_default$1.unescapeQuote = unescapeQuote;
_default$1.escapeHtmlEntities = escapeHtmlEntities;
_default$1.escapeDangerHtml5Entities = escapeDangerHtml5Entities;
_default$1.clearNonPrintableCharacter = clearNonPrintableCharacter;
_default$1.friendlyAttrValue = friendlyAttrValue;
_default$1.escapeAttrValue = escapeAttrValue;
_default$1.onIgnoreTagStripAll = onIgnoreTagStripAll;
_default$1.StripTagBody = StripTagBody;
_default$1.stripCommentTag = stripCommentTag;
_default$1.stripBlankChar = stripBlankChar;
_default$1.cssFilter = defaultCSSFilter;
_default$1.getDefaultCSSWhiteList = getDefaultCSSWhiteList;
var parser$1 = {};
var _$1$1 = util;
function getTagName(html) {
  var i2 = _$1$1.spaceIndex(html);
  var tagName;
  if (i2 === -1) {
    tagName = html.slice(1, -1);
  } else {
    tagName = html.slice(1, i2 + 1);
  }
  tagName = _$1$1.trim(tagName).toLowerCase();
  if (tagName.slice(0, 1) === "/")
    tagName = tagName.slice(1);
  if (tagName.slice(-1) === "/")
    tagName = tagName.slice(0, -1);
  return tagName;
}
function isClosing(html) {
  return html.slice(0, 2) === "</";
}
function parseTag$1(html, onTag2, escapeHtml2) {
  var rethtml = "";
  var lastPos = 0;
  var tagStart = false;
  var quoteStart = false;
  var currentPos = 0;
  var len = html.length;
  var currentTagName = "";
  var currentHtml = "";
  chariterator:
    for (currentPos = 0; currentPos < len; currentPos++) {
      var c2 = html.charAt(currentPos);
      if (tagStart === false) {
        if (c2 === "<") {
          tagStart = currentPos;
          continue;
        }
      } else {
        if (quoteStart === false) {
          if (c2 === "<") {
            rethtml += escapeHtml2(html.slice(lastPos, currentPos));
            tagStart = currentPos;
            lastPos = currentPos;
            continue;
          }
          if (c2 === ">") {
            rethtml += escapeHtml2(html.slice(lastPos, tagStart));
            currentHtml = html.slice(tagStart, currentPos + 1);
            currentTagName = getTagName(currentHtml);
            rethtml += onTag2(tagStart, rethtml.length, currentTagName, currentHtml, isClosing(currentHtml));
            lastPos = currentPos + 1;
            tagStart = false;
            continue;
          }
          if (c2 === '"' || c2 === "'") {
            var i2 = 1;
            var ic = html.charAt(currentPos - i2);
            while (ic.trim() === "" || ic === "=") {
              if (ic === "=") {
                quoteStart = c2;
                continue chariterator;
              }
              ic = html.charAt(currentPos - ++i2);
            }
          }
        } else {
          if (c2 === quoteStart) {
            quoteStart = false;
            continue;
          }
        }
      }
    }
  if (lastPos < html.length) {
    rethtml += escapeHtml2(html.substr(lastPos));
  }
  return rethtml;
}
var REGEXP_ILLEGAL_ATTR_NAME = /[^a-zA-Z0-9\\_:.-]/gim;
function parseAttr$1(html, onAttr2) {
  var lastPos = 0;
  var lastMarkPos = 0;
  var retAttrs = [];
  var tmpName = false;
  var len = html.length;
  function addAttr(name, value) {
    name = _$1$1.trim(name);
    name = name.replace(REGEXP_ILLEGAL_ATTR_NAME, "").toLowerCase();
    if (name.length < 1)
      return;
    var ret = onAttr2(name, value || "");
    if (ret)
      retAttrs.push(ret);
  }
  for (var i2 = 0; i2 < len; i2++) {
    var c2 = html.charAt(i2);
    var v2, j2;
    if (tmpName === false && c2 === "=") {
      tmpName = html.slice(lastPos, i2);
      lastPos = i2 + 1;
      lastMarkPos = html.charAt(lastPos) === '"' || html.charAt(lastPos) === "'" ? lastPos : findNextQuotationMark(html, i2 + 1);
      continue;
    }
    if (tmpName !== false) {
      if (i2 === lastMarkPos) {
        j2 = html.indexOf(c2, i2 + 1);
        if (j2 === -1) {
          break;
        } else {
          v2 = _$1$1.trim(html.slice(lastMarkPos + 1, j2));
          addAttr(tmpName, v2);
          tmpName = false;
          i2 = j2;
          lastPos = i2 + 1;
          continue;
        }
      }
    }
    if (/\s|\n|\t/.test(c2)) {
      html = html.replace(/\s|\n|\t/g, " ");
      if (tmpName === false) {
        j2 = findNextEqual(html, i2);
        if (j2 === -1) {
          v2 = _$1$1.trim(html.slice(lastPos, i2));
          addAttr(v2);
          tmpName = false;
          lastPos = i2 + 1;
          continue;
        } else {
          i2 = j2 - 1;
          continue;
        }
      } else {
        j2 = findBeforeEqual(html, i2 - 1);
        if (j2 === -1) {
          v2 = _$1$1.trim(html.slice(lastPos, i2));
          v2 = stripQuoteWrap(v2);
          addAttr(tmpName, v2);
          tmpName = false;
          lastPos = i2 + 1;
          continue;
        } else {
          continue;
        }
      }
    }
  }
  if (lastPos < html.length) {
    if (tmpName === false) {
      addAttr(html.slice(lastPos));
    } else {
      addAttr(tmpName, stripQuoteWrap(_$1$1.trim(html.slice(lastPos))));
    }
  }
  return _$1$1.trim(retAttrs.join(" "));
}
function findNextEqual(str, i2) {
  for (; i2 < str.length; i2++) {
    var c2 = str[i2];
    if (c2 === " ")
      continue;
    if (c2 === "=")
      return i2;
    return -1;
  }
}
function findNextQuotationMark(str, i2) {
  for (; i2 < str.length; i2++) {
    var c2 = str[i2];
    if (c2 === " ")
      continue;
    if (c2 === "'" || c2 === '"')
      return i2;
    return -1;
  }
}
function findBeforeEqual(str, i2) {
  for (; i2 > 0; i2--) {
    var c2 = str[i2];
    if (c2 === " ")
      continue;
    if (c2 === "=")
      return i2;
    return -1;
  }
}
function isQuoteWrapString(text) {
  if (text[0] === '"' && text[text.length - 1] === '"' || text[0] === "'" && text[text.length - 1] === "'") {
    return true;
  } else {
    return false;
  }
}
function stripQuoteWrap(text) {
  if (isQuoteWrapString(text)) {
    return text.substr(1, text.length - 2);
  } else {
    return text;
  }
}
parser$1.parseTag = parseTag$1;
parser$1.parseAttr = parseAttr$1;
var FilterCSS = lib.exports.FilterCSS;
var DEFAULT = _default$1;
var parser = parser$1;
var parseTag = parser.parseTag;
var parseAttr = parser.parseAttr;
var _$z = util;
function isNull(obj) {
  return obj === void 0 || obj === null;
}
function getAttrs(html) {
  var i2 = _$z.spaceIndex(html);
  if (i2 === -1) {
    return {
      html: "",
      closing: html[html.length - 2] === "/"
    };
  }
  html = _$z.trim(html.slice(i2 + 1, -1));
  var isClosing2 = html[html.length - 1] === "/";
  if (isClosing2)
    html = _$z.trim(html.slice(0, -1));
  return {
    html,
    closing: isClosing2
  };
}
function shallowCopyObject(obj) {
  var ret = {};
  for (var i2 in obj) {
    ret[i2] = obj[i2];
  }
  return ret;
}
function keysToLowerCase(obj) {
  var ret = {};
  for (var i2 in obj) {
    if (Array.isArray(obj[i2])) {
      ret[i2.toLowerCase()] = obj[i2].map(function(item) {
        return item.toLowerCase();
      });
    } else {
      ret[i2.toLowerCase()] = obj[i2];
    }
  }
  return ret;
}
function FilterXSS(options) {
  options = shallowCopyObject(options || {});
  if (options.stripIgnoreTag) {
    if (options.onIgnoreTag) {
      console.error('Notes: cannot use these two options "stripIgnoreTag" and "onIgnoreTag" at the same time');
    }
    options.onIgnoreTag = DEFAULT.onIgnoreTagStripAll;
  }
  if (options.whiteList || options.allowList) {
    options.whiteList = keysToLowerCase(options.whiteList || options.allowList);
  } else {
    options.whiteList = DEFAULT.whiteList;
  }
  options.onTag = options.onTag || DEFAULT.onTag;
  options.onTagAttr = options.onTagAttr || DEFAULT.onTagAttr;
  options.onIgnoreTag = options.onIgnoreTag || DEFAULT.onIgnoreTag;
  options.onIgnoreTagAttr = options.onIgnoreTagAttr || DEFAULT.onIgnoreTagAttr;
  options.safeAttrValue = options.safeAttrValue || DEFAULT.safeAttrValue;
  options.escapeHtml = options.escapeHtml || DEFAULT.escapeHtml;
  this.options = options;
  if (options.css === false) {
    this.cssFilter = false;
  } else {
    options.css = options.css || {};
    this.cssFilter = new FilterCSS(options.css);
  }
}
FilterXSS.prototype.process = function(html) {
  html = html || "";
  html = html.toString();
  if (!html)
    return "";
  var me2 = this;
  var options = me2.options;
  var whiteList = options.whiteList;
  var onTag2 = options.onTag;
  var onIgnoreTag2 = options.onIgnoreTag;
  var onTagAttr2 = options.onTagAttr;
  var onIgnoreTagAttr2 = options.onIgnoreTagAttr;
  var safeAttrValue2 = options.safeAttrValue;
  var escapeHtml2 = options.escapeHtml;
  var cssFilter = me2.cssFilter;
  if (options.stripBlankChar) {
    html = DEFAULT.stripBlankChar(html);
  }
  if (!options.allowCommentTag) {
    html = DEFAULT.stripCommentTag(html);
  }
  var stripIgnoreTagBody = false;
  if (options.stripIgnoreTagBody) {
    stripIgnoreTagBody = DEFAULT.StripTagBody(options.stripIgnoreTagBody, onIgnoreTag2);
    onIgnoreTag2 = stripIgnoreTagBody.onIgnoreTag;
  }
  var retHtml = parseTag(html, function(sourcePosition, position, tag, html2, isClosing2) {
    var info = {
      sourcePosition,
      position,
      isClosing: isClosing2,
      isWhite: Object.prototype.hasOwnProperty.call(whiteList, tag)
    };
    var ret = onTag2(tag, html2, info);
    if (!isNull(ret))
      return ret;
    if (info.isWhite) {
      if (info.isClosing) {
        return "</" + tag + ">";
      }
      var attrs = getAttrs(html2);
      var whiteAttrList = whiteList[tag];
      var attrsHtml = parseAttr(attrs.html, function(name, value) {
        var isWhiteAttr = _$z.indexOf(whiteAttrList, name) !== -1;
        var ret2 = onTagAttr2(tag, name, value, isWhiteAttr);
        if (!isNull(ret2))
          return ret2;
        if (isWhiteAttr) {
          value = safeAttrValue2(tag, name, value, cssFilter);
          if (value) {
            return name + '="' + value + '"';
          } else {
            return name;
          }
        } else {
          ret2 = onIgnoreTagAttr2(tag, name, value, isWhiteAttr);
          if (!isNull(ret2))
            return ret2;
          return;
        }
      });
      html2 = "<" + tag;
      if (attrsHtml)
        html2 += " " + attrsHtml;
      if (attrs.closing)
        html2 += " /";
      html2 += ">";
      return html2;
    } else {
      ret = onIgnoreTag2(tag, html2, info);
      if (!isNull(ret))
        return ret;
      return escapeHtml2(html2);
    }
  }, escapeHtml2);
  if (stripIgnoreTagBody) {
    retHtml = stripIgnoreTagBody.remove(retHtml);
  }
  return retHtml;
};
var xss = FilterXSS;
(function(module, exports) {
  var DEFAULT2 = _default$1;
  var parser2 = parser$1;
  var FilterXSS2 = xss;
  function filterXSS(html, options) {
    var xss2 = new FilterXSS2(options);
    return xss2.process(html);
  }
  exports = module.exports = filterXSS;
  exports.filterXSS = filterXSS;
  exports.FilterXSS = FilterXSS2;
  (function() {
    for (var i2 in DEFAULT2) {
      exports[i2] = DEFAULT2[i2];
    }
    for (var j2 in parser2) {
      exports[j2] = parser2[j2];
    }
  })();
  function isWorkerEnv() {
    return typeof self !== "undefined" && typeof DedicatedWorkerGlobalScope !== "undefined" && self instanceof DedicatedWorkerGlobalScope;
  }
  if (isWorkerEnv()) {
    self.filterXSS = module.exports;
  }
})(lib$1, lib$1.exports);
var Sanitizer = function() {
  function Sanitizer2(filterOptions, extendDefaults) {
    var _this = this;
    this.arcgisWhiteList = {
      a: ["href", "style", "target"],
      abbr: ["title"],
      audio: ["autoplay", "controls", "loop", "muted", "preload"],
      b: [],
      br: [],
      dd: ["style"],
      div: ["align", "style"],
      dl: ["style"],
      dt: ["style"],
      em: [],
      figcaption: ["style"],
      figure: ["style"],
      font: ["color", "face", "size", "style"],
      h1: ["style"],
      h2: ["style"],
      h3: ["style"],
      h4: ["style"],
      h5: ["style"],
      h6: ["style"],
      hr: [],
      i: [],
      img: ["alt", "border", "height", "src", "style", "width"],
      li: [],
      ol: [],
      p: ["style"],
      source: ["media", "src", "type"],
      span: ["style"],
      strong: [],
      sub: ["style"],
      sup: ["style"],
      table: ["border", "cellpadding", "cellspacing", "height", "style", "width"],
      tbody: [],
      tr: ["align", "height", "style", "valign"],
      td: [
        "align",
        "colspan",
        "height",
        "nowrap",
        "rowspan",
        "style",
        "valign",
        "width"
      ],
      th: [
        "align",
        "colspan",
        "height",
        "nowrap",
        "rowspan",
        "style",
        "valign",
        "width"
      ],
      u: [],
      ul: [],
      video: [
        "autoplay",
        "controls",
        "height",
        "loop",
        "muted",
        "poster",
        "preload",
        "width"
      ]
    };
    this.allowedProtocols = [
      "http",
      "https",
      "mailto",
      "iform",
      "tel",
      "flow",
      "lfmobile",
      "arcgis-navigator",
      "arcgis-appstudio-player",
      "arcgis-survey123",
      "arcgis-collector",
      "arcgis-workforce",
      "arcgis-explorer",
      "arcgis-trek2there",
      "arcgis-quickcapture",
      "mspbi",
      "comgooglemaps",
      "pdfefile",
      "pdfehttp",
      "pdfehttps",
      "boxapp",
      "boxemm",
      "awb",
      "awbs",
      "gropen",
      "radarscope"
    ];
    this.arcgisFilterOptions = {
      allowCommentTag: true,
      safeAttrValue: function(tag, name, value, cssFilter) {
        if (tag === "a" && name === "href" || (tag === "img" || tag === "source") && name === "src") {
          return _this.sanitizeUrl(value);
        }
        return lib$1.exports.safeAttrValue(tag, name, value, cssFilter);
      }
    };
    this._entityMap = {
      "&": "&#x38;",
      "<": "&#x3C;",
      ">": "&#x3E;",
      '"': "&#x22;",
      "'": "&#x27;",
      "/": "&#x2F;"
    };
    var xssFilterOptions;
    if (filterOptions && !extendDefaults) {
      xssFilterOptions = filterOptions;
    } else if (filterOptions && extendDefaults) {
      xssFilterOptions = Object.create(this.arcgisFilterOptions);
      Object.keys(filterOptions).forEach(function(key) {
        if (key === "whiteList") {
          xssFilterOptions.whiteList = _this._extendObjectOfArrays([
            _this.arcgisWhiteList,
            filterOptions.whiteList || {}
          ]);
        } else {
          xssFilterOptions[key] = filterOptions[key];
        }
      });
    } else {
      xssFilterOptions = Object.create(this.arcgisFilterOptions);
      xssFilterOptions.whiteList = this.arcgisWhiteList;
    }
    this.xssFilterOptions = xssFilterOptions;
    this._xssFilter = new lib$1.exports.FilterXSS(xssFilterOptions);
  }
  Sanitizer2.prototype.sanitize = function(value, options) {
    if (options === void 0) {
      options = {};
    }
    switch (typeof value) {
      case "number":
        if (isNaN(value) || !isFinite(value)) {
          return null;
        }
        return value;
      case "boolean":
        return value;
      case "string":
        return this._xssFilter.process(value);
      case "object":
        return this._iterateOverObject(value, options);
      default:
        if (options.allowUndefined && typeof value === "undefined") {
          return;
        }
        return null;
    }
  };
  Sanitizer2.prototype.sanitizeUrl = function(value, options) {
    var _a2 = (options !== null && options !== void 0 ? options : {}).isProtocolRequired, isProtocolRequired = _a2 === void 0 ? true : _a2;
    var protocol = this._trim(value.substring(0, value.indexOf(":")));
    var isRootUrl = value === "/";
    var isUrlFragment = /^#/.test(value);
    var isValidProtocol = protocol && this.allowedProtocols.indexOf(protocol.toLowerCase()) > -1;
    if (isRootUrl || isUrlFragment || isValidProtocol) {
      return lib$1.exports.escapeAttrValue(value);
    }
    if (!protocol && !isProtocolRequired) {
      return lib$1.exports.escapeAttrValue("https://".concat(value));
    }
    return "";
  };
  Sanitizer2.prototype.sanitizeHTMLAttribute = function(tag, attribute, value, cssFilter) {
    if (typeof this.xssFilterOptions.safeAttrValue === "function") {
      return this.xssFilterOptions.safeAttrValue(tag, attribute, value, cssFilter);
    }
    return lib$1.exports.safeAttrValue(tag, attribute, value, cssFilter);
  };
  Sanitizer2.prototype.validate = function(value, options) {
    if (options === void 0) {
      options = {};
    }
    var sanitized = this.sanitize(value, options);
    return {
      isValid: value === sanitized,
      sanitized
    };
  };
  Sanitizer2.prototype.encodeHTML = function(value) {
    var _this = this;
    return String(value).replace(/[&<>"'\/]/g, function(s2) {
      return _this._entityMap[s2];
    });
  };
  Sanitizer2.prototype.encodeAttrValue = function(value) {
    var alphanumericRE = /^[a-zA-Z0-9]$/;
    return String(value).replace(/[\x00-\xFF]/g, function(c2, idx) {
      return !alphanumericRE.test(c2) ? "&#x".concat(Number(value.charCodeAt(idx)).toString(16), ";") : c2;
    });
  };
  Sanitizer2.prototype._extendObjectOfArrays = function(objects) {
    var finalObj = {};
    objects.forEach(function(obj) {
      Object.keys(obj).forEach(function(key) {
        if (Array.isArray(obj[key]) && Array.isArray(finalObj[key])) {
          finalObj[key] = finalObj[key].concat(obj[key]);
        } else {
          finalObj[key] = obj[key];
        }
      });
    });
    return finalObj;
  };
  Sanitizer2.prototype._iterateOverObject = function(obj, options) {
    var _this = this;
    if (options === void 0) {
      options = {};
    }
    try {
      var hasChanged_1 = false;
      var changedObj = void 0;
      if (Array.isArray(obj)) {
        changedObj = obj.reduce(function(prev, value) {
          var validation = _this.validate(value, options);
          if (validation.isValid) {
            return prev.concat([value]);
          } else {
            hasChanged_1 = true;
            return prev.concat([validation.sanitized]);
          }
        }, []);
      } else if (!isPlainObject(obj)) {
        if (options.allowUndefined && typeof obj === "undefined") {
          return;
        }
        return null;
      } else {
        var keys = Object.keys(obj);
        changedObj = keys.reduce(function(prev, key) {
          var value = obj[key];
          var validation = _this.validate(value, options);
          if (validation.isValid) {
            prev[key] = value;
          } else {
            hasChanged_1 = true;
            prev[key] = validation.sanitized;
          }
          return prev;
        }, {});
      }
      if (hasChanged_1) {
        return changedObj;
      }
      return obj;
    } catch (err) {
      return null;
    }
  };
  Sanitizer2.prototype._trim = function(val) {
    return String.prototype.trim ? val.trim() : val.replace(/(^\s*)|(\s*$)/g, "");
  };
  return Sanitizer2;
}();
const n$22 = new Map();
function t$1x() {
  n$22.clear();
}
function e$1o(t2) {
  return n$22.get(t2);
}
function c$2b(t2, e2) {
  n$22.set(t2, e2);
}
function o$1w(t2) {
  n$22.delete(t2);
}
var o$1v, s$1B, a$20 = function(e2) {
  if ("WebkitTransition" in e2.style)
    o$1v = "webkitTransitionEnd", s$1B = "webkitAnimationEnd";
  else {
    if (!("transition" in e2.style))
      throw new Error("Your browser is not supported!");
    o$1v = "transitionend", s$1B = "animationend";
  }
}, c$2a = function(e2) {
  o$1v || a$20(e2);
}, l$1I = function(e2, t2) {
  return t2 === void 0 && (t2 = e2 + "-active"), function(n2) {
    c$2a(n2);
    var r2 = false, i2 = function(a2) {
      r2 || (r2 = true, n2.removeEventListener(o$1v, i2), n2.removeEventListener(s$1B, i2), n2.classList.remove(e2), n2.classList.remove(t2));
    };
    n2.classList.add(e2), n2.addEventListener(o$1v, i2), n2.addEventListener(s$1B, i2), requestAnimationFrame(function() {
      n2.classList.add(t2);
    });
  };
}, d$1h = function(e2, t2) {
  return t2 === void 0 && (t2 = e2 + "-active"), function(n2, r2) {
    c$2a(n2);
    var i2 = false, a2 = function(e3) {
      i2 || (i2 = true, n2.removeEventListener(o$1v, a2), n2.removeEventListener(s$1B, a2), r2());
    };
    n2.classList.add(e2), n2.addEventListener(o$1v, a2), n2.addEventListener(s$1B, a2), requestAnimationFrame(function() {
      n2.classList.add(t2);
    });
  };
};
const u$1n = s$2z.getLogger("esri.widgets.support.widgetUtils");
function p$2t(e2) {
  const n2 = t$2c.acquire();
  for (let t2 = 0; t2 < arguments.length; t2++) {
    const e3 = arguments[t2], r3 = typeof e3;
    if (r3 === "string")
      n2.push(e3);
    else if (Array.isArray(e3))
      n2.push.apply(n2, e3);
    else if (r3 === "object")
      for (const t3 in e3)
        e3[t3] && n2.push(t3);
  }
  const r2 = n2.join(" ");
  return t$2c.release(n2), r2;
}
(() => {
  const e2 = new Map(), t2 = new ResizeObserver((t3) => {
    var _a2;
    t$1x();
    for (const n2 of t3)
      (_a2 = e2.get(n2.target)) == null ? void 0 : _a2(n2);
  });
  return (r2, i2, o2) => (e2.has(r2) && u$1n.error("Already observing element", r2), e2.set(r2, i2), t2.observe(r2, o2), n$2U(() => {
    t2.unobserve(r2), e2.delete(r2);
  }));
})();
function f$1g(e2) {
  const t2 = e2 == null ? void 0 : e2.closest("[dir]");
  return t2 !== null && t2 instanceof HTMLElement && t2.dir === "rtl" || document.dir === "rtl";
}
function h$1d(e2) {
  const t2 = "data-node-ref";
  this[e2.getAttribute(t2)] = null;
}
function v$T(e2) {
  const t2 = "data-node-ref";
  this[e2.getAttribute(t2)] = e2;
}
function w$L(e2, t2) {
  return (e2 === "enter" ? l$1I : d$1h)(t2);
}
const L$o = ["dd", "dl", "dt", "h1", "h2", "h3", "h4", "h5", "h6", "sub", "sup", ...["animate", "animatetransform", "circle", "clippath", "defs", "ellipse", "g", "image", "line", "lineargradient", "marker", "mask", "path", "pattern", "polygon", "polyline", "radialgradient", "rect", "stop", "svg", "switch", "symbol", "text", "textpath", "tspan", "use"]], b$Q = L$o.reduce((e2, t2) => (e2[t2] = [], e2), {}), y$15 = ["align", "alink", "alt", "bgcolor", "border", "cellpadding", "cellspacing", "class", "color", "cols", "colspan", "coords", "d", "dir", "face", "height", "hspace", "ismap", "lang", "marginheight", "marginwidth", "multiple", "nohref", "noresize", "noshade", "nowrap", "ref", "rel", "rev", "rows", "rowspan", "scrolling", "shape", "span", "summary", "tabindex", "title", "usemap", "valign", "value", "vlink", "vspace", "width"], E$B = new Sanitizer({ whiteList: b$Q, onTagAttr: (e2, t2, n2) => {
  const r2 = `${t2}="${n2}"`;
  if (y$15.includes(t2))
    return r2;
}, stripIgnoreTag: true, stripIgnoreTagBody: ["script", "style"] }, true);
function k$r(e2) {
  return e2 === "Enter" || e2 === " ";
}
const t$1w = "http://www.w3.org/", r$1j = `${t$1w}2000/svg`, o$1u = `${t$1w}1999/xlink`;
let i$27, l$1H = [], n$21 = (e2, t2) => {
  let r2 = {};
  return Object.keys(e2).forEach((t3) => {
    r2[t3] = e2[t3];
  }), t2 && Object.keys(t2).forEach((e3) => {
    r2[e3] = t2[e3];
  }), r2;
}, s$1A = (e2, t2) => e2.vnodeSelector === t2.vnodeSelector && (e2.properties && t2.properties ? e2.properties.key === t2.properties.key && e2.properties.bind === t2.properties.bind : !e2.properties && !t2.properties), p$2s = (e2) => {
  if (typeof e2 != "string")
    throw new Error("Style values must be strings");
}, d$1g = (e2, t2, r2) => {
  if (t2.vnodeSelector !== "") {
    for (let o2 = r2; o2 < e2.length; o2++)
      if (s$1A(e2[o2], t2))
        return o2;
  }
  return -1;
}, a$1$ = (e2, t2, r2, o2) => {
  let i2 = e2[t2];
  if (i2.vnodeSelector === "")
    return;
  let l2 = i2.properties;
  if (!(l2 ? l2.key === void 0 ? l2.bind : l2.key : void 0)) {
    for (let n2 = 0; n2 < e2.length; n2++)
      if (n2 !== t2) {
        let t3 = e2[n2];
        if (s$1A(t3, i2))
          throw new Error(`${r2.vnodeSelector} had a ${i2.vnodeSelector} child ${o2 === "added" ? o2 : "removed"}, but there is now more than one. You must add unique key properties to make them distinguishable.`);
      }
  }
}, f$1f = (e2) => {
  if (e2.properties) {
    let t2 = e2.properties.enterAnimation;
    t2 && t2(e2.domNode, e2.properties);
  }
}, c$29 = [], u$1m = false, h$1c = (e2) => {
  (e2.children || []).forEach(h$1c), e2.properties && e2.properties.afterRemoved && e2.properties.afterRemoved.apply(e2.properties.bind || e2.properties, [e2.domNode]);
}, m$1E = () => {
  u$1m = false, c$29.forEach(h$1c), c$29.length = 0;
}, v$S = (e2) => {
  c$29.push(e2), u$1m || (u$1m = true, typeof window != "undefined" && "requestIdleCallback" in window ? window.requestIdleCallback(m$1E, { timeout: 16 }) : setTimeout(m$1E, 16));
}, y$14 = (e2) => {
  let t2 = e2.domNode;
  if (e2.properties) {
    let r2 = e2.properties.exitAnimation;
    if (r2) {
      t2.style.pointerEvents = "none";
      let o2 = () => {
        t2.parentNode && (t2.parentNode.removeChild(t2), v$S(e2));
      };
      return void r2(t2, o2, e2.properties);
    }
  }
  t2.parentNode && (t2.parentNode.removeChild(t2), v$S(e2));
}, g$V = (t2, i2, l2) => {
  if (!i2)
    return;
  let n2 = l2.eventHandlerInterceptor, s2 = Object.keys(i2), d2 = s2.length;
  for (let a2 = 0; a2 < d2; a2++) {
    let d3 = s2[a2], f2 = i2[d3];
    if (d3 === "className")
      throw new Error('Property "className" is not supported, use "class".');
    if (d3 === "class")
      x$J(t2, f2, true);
    else if (d3 === "classes") {
      let e2 = Object.keys(f2), r2 = e2.length;
      for (let o2 = 0; o2 < r2; o2++) {
        let r3 = e2[o2];
        f2[r3] && t2.classList.add(r3);
      }
    } else if (d3 === "styles") {
      let e2 = Object.keys(f2), r2 = e2.length;
      for (let o2 = 0; o2 < r2; o2++) {
        let r3 = e2[o2], i3 = f2[r3];
        i3 && (p$2s(i3), l2.styleApplyer(t2, r3, i3));
      }
    } else if (d3 !== "key" && f2 != null) {
      let s3 = typeof f2;
      s3 === "function" ? (d3.lastIndexOf("on", 0) === 0 && (n2 && (f2 = n2(d3, f2, t2, i2)), d3 === "oninput" && function() {
        let e2 = f2;
        f2 = function(t3) {
          e2.apply(this, [t3]), t3.target["oninput-value"] = t3.target.value;
        };
      }()), t2[d3] = f2) : l2.namespace === r$1j ? d3 === "href" ? t2.setAttributeNS(o$1u, d3, f2) : t2.setAttribute(d3, f2) : s3 === "string" && d3 !== "value" ? d3 === "innerHTML" ? t2[d3] = E$B.sanitize(f2) : t2.setAttribute(d3, f2) : t2[d3] = f2;
    }
  }
}, b$P = (e2, t2, r2) => {
  if (t2)
    for (let o2 of t2)
      w$K(o2, e2, void 0, r2);
}, N$m = (e2, t2, r2) => {
  b$P(e2, t2.children, r2), t2.text && (e2.textContent = t2.text), g$V(e2, t2.properties, r2), t2.properties && t2.properties.afterCreate && t2.properties.afterCreate.apply(t2.properties.bind || t2.properties, [e2, r2, t2.vnodeSelector, t2.properties, t2.children]);
}, w$K = (e2, t2, o2, i2) => {
  let l2, s2 = 0, p2 = e2.vnodeSelector, d2 = t2.ownerDocument;
  if (p2 === "")
    l2 = e2.domNode = d2.createTextNode(e2.text), o2 !== void 0 ? t2.insertBefore(l2, o2) : t2.appendChild(l2);
  else {
    for (let a2 = 0; a2 <= p2.length; ++a2) {
      let f2 = p2.charAt(a2);
      if (a2 === p2.length || f2 === "." || f2 === "#") {
        let f3 = p2.charAt(s2 - 1), c2 = p2.slice(s2, a2);
        f3 === "." ? l2.classList.add(c2) : f3 === "#" ? l2.id = c2 : (c2 === "svg" && (i2 = n$21(i2, { namespace: r$1j })), i2.namespace !== void 0 ? l2 = e2.domNode = d2.createElementNS(i2.namespace, c2) : (l2 = e2.domNode = e2.domNode || d2.createElement(c2), c2 === "input" && e2.properties && e2.properties.type !== void 0 && l2.setAttribute("type", e2.properties.type)), o2 !== void 0 ? t2.insertBefore(l2, o2) : l2.parentNode !== t2 && t2.appendChild(l2)), s2 = a2 + 1;
      }
    }
    N$m(l2, e2, i2);
  }
}, x$J = (e2, t2, r2) => {
  t2 && t2.split(" ").forEach((t3) => {
    t3 && e2.classList.toggle(t3, r2);
  });
}, k$q = (t2, i2, l2, n2) => {
  if (!l2)
    return;
  let s2 = false, d2 = Object.keys(l2), a2 = d2.length;
  for (let f2 = 0; f2 < a2; f2++) {
    let a3 = d2[f2], c2 = l2[a3], u2 = i2[a3];
    if (a3 === "class")
      u2 !== c2 && (x$J(t2, u2, false), x$J(t2, c2, true));
    else if (a3 === "classes") {
      let e2 = t2.classList, r2 = Object.keys(c2), o2 = r2.length;
      for (let t3 = 0; t3 < o2; t3++) {
        let o3 = r2[t3], i3 = !!c2[o3];
        i3 !== !!u2[o3] && (s2 = true, i3 ? e2.add(o3) : e2.remove(o3));
      }
    } else if (a3 === "styles") {
      let e2 = Object.keys(c2), r2 = e2.length;
      for (let o2 = 0; o2 < r2; o2++) {
        let r3 = e2[o2], i3 = c2[r3];
        i3 !== u2[r3] && (s2 = true, i3 ? (p$2s(i3), n2.styleApplyer(t2, r3, i3)) : n2.styleApplyer(t2, r3, ""));
      }
    } else if (c2 || typeof u2 != "string" || (c2 = ""), a3 === "value") {
      let e2 = t2[a3];
      e2 !== c2 && (t2["oninput-value"] ? e2 === t2["oninput-value"] : c2 !== u2) && (t2[a3] = c2, t2["oninput-value"] = void 0), c2 !== u2 && (s2 = true);
    } else if (c2 !== u2) {
      let i3 = typeof c2;
      i3 === "function" && n2.eventHandlerInterceptor || (n2.namespace === r$1j ? a3 === "href" ? t2.setAttributeNS(o$1u, a3, c2) : t2.setAttribute(a3, c2) : i3 === "string" ? a3 === "innerHTML" ? t2[a3] = E$B.sanitize(c2) : a3 === "role" && c2 === "" ? t2.removeAttribute(a3) : t2.setAttribute(a3, c2) : t2[a3] !== c2 && (t2[a3] = c2), s2 = true);
    }
  }
  return s2;
}, A$o = (e2, t2, r2, o2, n2) => {
  if (r2 === o2)
    return false;
  o2 = o2 || l$1H;
  let p2, c2 = (r2 = r2 || l$1H).length, u2 = o2.length, h2 = 0, m2 = 0, v2 = false;
  for (; m2 < u2; ) {
    let l2 = h2 < c2 ? r2[h2] : void 0, u3 = o2[m2];
    if (l2 !== void 0 && s$1A(l2, u3))
      v2 = i$27(l2, u3, n2) || v2, h2++;
    else {
      let l3 = d$1g(r2, u3, h2 + 1);
      if (l3 >= 0) {
        for (p2 = h2; p2 < l3; p2++)
          y$14(r2[p2]), a$1$(r2, p2, e2, "removed");
        v2 = i$27(r2[l3], u3, n2) || v2, h2 = l3 + 1;
      } else
        w$K(u3, t2, h2 < c2 ? r2[h2].domNode : void 0, n2), f$1f(u3), a$1$(o2, m2, e2, "added");
    }
    m2++;
  }
  if (c2 > h2)
    for (p2 = h2; p2 < c2; p2++)
      y$14(r2[p2]), a$1$(r2, p2, e2, "removed");
  return v2;
};
i$27 = (e2, t2, o2) => {
  let i2 = e2.domNode, l2 = false;
  if (e2 === t2)
    return false;
  let s2 = false;
  if (t2.vnodeSelector === "") {
    if (t2.text !== e2.text) {
      let e3 = i2.ownerDocument.createTextNode(t2.text);
      return i2.parentNode.replaceChild(e3, i2), t2.domNode = e3, l2 = true, l2;
    }
    t2.domNode = i2;
  } else
    t2.vnodeSelector.lastIndexOf("svg", 0) === 0 && (o2 = n$21(o2, { namespace: r$1j })), e2.text !== t2.text && (s2 = true, t2.text === void 0 ? i2.removeChild(i2.firstChild) : i2.textContent = t2.text), t2.domNode = i2, s2 = A$o(t2, i2, e2.children, t2.children, o2) || s2, s2 = k$q(i2, e2.properties, t2.properties, o2) || s2, t2.properties && t2.properties.afterUpdate && t2.properties.afterUpdate.apply(t2.properties.bind || t2.properties, [i2, o2, t2.vnodeSelector, t2.properties, t2.children]);
  return s2 && t2.properties && t2.properties.updateAnimation && t2.properties.updateAnimation(i2, t2.properties, e2.properties), l2;
};
let S$B = (e2, t2) => ({ getLastRender: () => e2, update: (r2) => {
  if (e2.vnodeSelector !== r2.vnodeSelector)
    throw new Error("The selector for the root VNode may not be changed. (consider using dom.merge and add one extra level to the virtual DOM)");
  let o2 = e2;
  e2 = r2, i$27(o2, r2, t2);
}, domNode: e2.domNode });
const p$2r = { namespace: void 0, performanceLogger: () => {
}, eventHandlerInterceptor: void 0, styleApplyer: (e2, r2, o2) => {
  r2.charAt(0) === "-" ? e2.style.setProperty(r2, o2) : e2.style[r2] = o2;
} };
let d$1f = (r2) => n$21(p$2r, r2), n$20 = { create: (e2, t2) => (t2 = d$1f(t2), w$K(e2, document.createElement("div"), void 0, t2), S$B(e2, t2)), append: (e2, t2, p2) => (p2 = d$1f(p2), w$K(t2, e2, void 0, p2), S$B(t2, p2)), insertBefore: (e2, t2, p2) => (p2 = d$1f(p2), w$K(t2, e2.parentNode, e2, p2), S$B(t2, p2)), merge: (e2, r2, p2) => (p2 = d$1f(p2), r2.domNode = e2, N$m(e2, r2, p2), S$B(r2, p2)), replace: (e2, t2, p2) => (p2 = d$1f(p2), w$K(t2, e2.parentNode, e2, p2), e2.parentNode.removeChild(e2), S$B(t2, p2)) };
let t$1v, n$1$ = (e2, r2) => {
  let t2 = [];
  for (; e2 && e2 !== r2; )
    t2.push(e2), e2 = e2.parentNode;
  return t2;
};
t$1v = Array.prototype.find ? (e2, r2) => e2.find(r2) : (e2, r2) => e2.filter(r2)[0];
let o$1t = (e2, r2) => {
  let n2 = e2;
  return r2.forEach((e3) => {
    n2 = n2 && n2.children ? t$1v(n2.children, (r3) => r3.domNode === e3) : void 0;
  }), n2;
}, d$1e = (e2, r2, t2) => {
  let d2 = function(d3) {
    t2("domEvent", d3);
    let i2 = r2(), p2 = n$1$(d3.currentTarget, i2.domNode);
    p2.reverse();
    let l2, a2 = o$1t(i2.getLastRender(), p2);
    return e2.scheduleRender(), a2 && (l2 = a2.properties[`on${d3.type}`].apply(a2.properties.bind || this, arguments)), t2("domEventProcessed", d3), l2;
  };
  return (e3, r3, t3, n2) => d2;
}, i$26 = (t2) => {
  let n2, o2, i2 = d$1f(t2), p2 = i2.performanceLogger, l2 = true, a2 = false, s2 = [], c2 = [], u2 = (e2, r2, t3) => {
    let o3, l3 = () => o3;
    i2.eventHandlerInterceptor = d$1e(n2, l3, p2), o3 = e2(r2, t3(), i2), s2.push(o3), c2.push(t3);
  }, f2 = () => {
    if (o2 = void 0, l2) {
      l2 = false, p2("renderStart", void 0);
      for (let e2 = 0; e2 < s2.length; e2++) {
        let r2 = c2[e2]();
        p2("rendered", void 0), s2[e2].update(r2), p2("patched", void 0);
      }
      p2("renderDone", void 0), l2 = true;
    }
  };
  return n2 = { renderNow: f2, scheduleRender: () => {
    o2 || a2 || (o2 = requestAnimationFrame(f2));
  }, stop: () => {
    o2 && (cancelAnimationFrame(o2), o2 = void 0), a2 = true;
  }, resume: () => {
    a2 = false, l2 = true, n2.scheduleRender();
  }, append: (e2, t3) => {
    u2(n$20.append, e2, t3);
  }, insertBefore: (e2, t3) => {
    u2(n$20.insertBefore, e2, t3);
  }, merge: (e2, t3) => {
    u2(n$20.merge, e2, t3);
  }, replace: (e2, t3) => {
    u2(n$20.replace, e2, t3);
  }, detach: (e2) => {
    for (let r2 = 0; r2 < c2.length; r2++)
      if (c2[r2] === e2)
        return c2.splice(r2, 1), s2.splice(r2, 1)[0];
    throw new Error("renderFunction was not found");
  } }, n2;
};
let a$1_ = class extends m$2q {
  constructor() {
    super(...arguments), this.items = new j$V(), this._watchUpdatingTracking = new c$2c(), this._callbacks = new Map(), this._projector = i$26(), this._hiddenProjector = i$26();
  }
  get needsRender() {
    return this.items.length > 0;
  }
  get updating() {
    var _a2, _b2;
    return (_b2 = (_a2 = this._watchUpdatingTracking) == null ? void 0 : _a2.updating) != null ? _b2 : false;
  }
  initialize() {
    const t2 = document.createElement("div");
    t2.className = "esri-overlay-surface", this._set("surface", t2), this._hiddenSurface = document.createElement("div"), this._hiddenSurface.setAttribute("style", "visibility: hidden;"), t2.appendChild(this._hiddenSurface), this._watchUpdatingTracking.addOnCollectionChange(() => this.items, (t3) => {
      for (const e2 of t3.added) {
        const t4 = () => e2.render();
        this._callbacks.set(e2, t4), this._projector.append(this.surface, t4);
      }
      for (const e2 of t3.removed) {
        const t4 = this._projector.detach(this._callbacks.get(e2));
        this.surface.removeChild(t4.domNode), this._callbacks.delete(e2);
      }
    });
  }
  addItem(t2) {
    this.items.add(t2);
  }
  removeItem(t2) {
    this.items.remove(t2);
  }
  destroy() {
    this.items.removeAll(), this._callbacks.forEach((t2) => this._projector.detach(t2)), this._callbacks = null, this._projector = null, this._watchUpdatingTracking.destroy();
  }
  render() {
    this._projector.renderNow();
  }
  computeBoundingRect(t2) {
    const e2 = this._hiddenSurface, r2 = this._hiddenProjector;
    let o2 = null;
    const s2 = () => (o2 = t2.render(), o2);
    r2.append(e2, s2), r2.renderNow();
    const i2 = { left: 0, top: 0, right: 0, bottom: 0 };
    if (o2 && o2.domNode) {
      const t3 = o2.domNode.getBoundingClientRect();
      i2.left = t3.left, i2.top = t3.top, i2.right = t3.right, i2.bottom = t3.bottom;
    }
    for (r2.detach(s2); e2.firstChild; )
      e2.removeChild(e2.firstChild);
    return i2;
  }
  overlaps(t2, e2) {
    const r2 = this.computeBoundingRect(t2), o2 = this.computeBoundingRect(e2);
    return Math.max(r2.left, o2.left) <= Math.min(r2.right, o2.right) && Math.max(r2.top, o2.top) <= Math.min(r2.bottom, o2.bottom);
  }
  get hasVisibleItems() {
    return this.items.some((t2) => t2.visible);
  }
  async prepare() {
    await document.fonts.load(this._fontString()).catch(() => {
    });
  }
  renderCanvas(t2) {
    if (!this.items.some((t3) => t3.visible))
      return;
    const e2 = t2.getContext("2d");
    e2.save(), e2.font = this._fontString(), this.items.forEach((t3) => {
      e2.save(), t3.renderCanvas(e2), e2.restore();
    }), e2.restore();
  }
  _fontString() {
    return `10px ${getComputedStyle(this.surface).fontFamily}`;
  }
};
e$2g([y$1I({ readOnly: true })], a$1_.prototype, "surface", void 0), e$2g([y$1I({ readOnly: true })], a$1_.prototype, "items", void 0), e$2g([y$1I({ readOnly: true })], a$1_.prototype, "needsRender", null), e$2g([y$1I({ readOnly: true })], a$1_.prototype, "_watchUpdatingTracking", void 0), e$2g([y$1I({ readOnly: true })], a$1_.prototype, "updating", null), a$1_ = e$2g([n$2P("esri.views.overlay.ViewOverlay")], a$1_);
const c$28 = a$1_;
function e$1n(e2, t2, l2, n2) {
  let o2 = null, p2 = 1e3;
  typeof t2 == "number" ? (p2 = t2, n2 = l2) : (o2 = t2 != null ? t2 : null, p2 = l2);
  let r2, u2 = 0;
  const a2 = () => {
    u2 = 0, e2.apply(n2, r2);
  }, c2 = (...e3) => {
    o2 && o2.apply(n2, e3), r2 = e3, p2 ? u2 || (u2 = setTimeout(a2, p2)) : a2();
  };
  return c2.remove = () => {
    u2 && (clearTimeout(u2), u2 = 0);
  }, c2.forceUpdate = () => {
    u2 && (clearTimeout(u2), a2());
  }, c2.hasPendingUpdates = () => !!u2, c2;
}
const t$1u = "randomUUID" in crypto;
function n$1_() {
  if (t$1u)
    return crypto.randomUUID();
  const n2 = crypto.getRandomValues(new Uint16Array(8));
  n2[3] = 4095 & n2[3] | 16384, n2[4] = 16383 & n2[4] | 32768;
  const r2 = (t2) => n2[t2].toString(16).padStart(4, "0");
  return r2(0) + r2(1) + "-" + r2(2) + "-" + r2(3) + "-" + r2(4) + "-" + r2(5) + r2(6) + r2(7);
}
const e$1m = { handleInterceptedEvent: (e2, p2, t2, n2) => (e2.scheduleRender(), p2.properties[`on${n2.type}`].apply(p2.properties.bind || t2, [n2])) };
const e$1l = { namespace: void 0, performanceLogger: () => {
}, eventHandlerInterceptor: void 0, styleApplyer: (e2, r2, o2) => {
  e2.style[r2] = o2;
} }, r$1i = (r2) => __spreadValues(__spreadValues({}, e$1l), r2);
const o$1s = (e2, t2) => {
  const r2 = [];
  for (; e2 && e2 !== t2; )
    r2.push(e2), e2 = e2.parentNode;
  return r2;
}, n$1Z = (e2, t2) => e2.find(t2), d$1d = (e2, t2, r2 = false) => {
  let o2 = e2;
  return t2.forEach((e3, d2) => {
    const s2 = (o2 == null ? void 0 : o2.children) ? n$1Z(o2.children, (t3) => t3.domNode === e3) : void 0;
    r2 && !s2 && d2 !== t2.length - 1 || (o2 = s2);
  }), o2;
}, s$1z = (n2) => {
  let s2;
  const i2 = __spreadValues(__spreadValues({}, e$1m), n2), c2 = r$1i(i2), a2 = c2.performanceLogger;
  let m2, p2 = true, l2 = false;
  const f2 = [], u2 = [], h2 = (e2, t2, r2) => {
    var _a2;
    let n3;
    c2.eventHandlerInterceptor = (e3, t3, r3, c3) => function(e4) {
      let t4;
      a2("domEvent", e4);
      const r4 = o$1s(e4.currentTarget, n3.domNode), c4 = r4.some((e5) => {
        var _a3;
        return customElements.get((_a3 = e5 == null ? void 0 : e5.tagName) == null ? void 0 : _a3.toLowerCase());
      });
      if (e4.eventPhase === Event.CAPTURING_PHASE || !c4)
        r4.reverse(), t4 = d$1d(n3.getLastRender(), r4);
      else {
        const r5 = e4.composedPath(), o2 = r5.slice(r5.indexOf(e4.currentTarget), r5.indexOf(n3.domNode)).filter((e5) => e5.getRootNode() === e5.ownerDocument).reverse();
        t4 = d$1d(n3.getLastRender(), o2, true);
      }
      let m4;
      return t4 && (m4 = i2.handleInterceptedEvent(s2, t4, this, e4)), a2("domEventProcessed", e4), m4;
    }, (_a2 = i2.postProcessProjectionOptions) == null ? void 0 : _a2.call(i2, c2);
    const m3 = r2();
    n3 = e2(t2, m3, c2), f2.push(n3), u2.push(r2), i2.afterFirstVNodeRendered && i2.afterFirstVNodeRendered(n3, m3);
  };
  let v2 = () => {
    if (m2 = void 0, p2) {
      p2 = false, a2("renderStart", void 0);
      for (let e2 = 0; e2 < f2.length; e2++) {
        const t2 = u2[e2]();
        a2("rendered", void 0), f2[e2].update(t2), a2("patched", void 0);
      }
      a2("renderDone", void 0), p2 = true;
    }
  };
  return i2.modifyDoRenderImplementation && (v2 = i2.modifyDoRenderImplementation(v2, f2, u2)), s2 = { renderNow: v2, scheduleRender: () => {
    m2 || l2 || (m2 = requestAnimationFrame(v2));
  }, stop: () => {
    m2 && (cancelAnimationFrame(m2), m2 = void 0), l2 = true;
  }, resume: () => {
    l2 = false, p2 = true, s2.scheduleRender();
  }, append: (t2, r2) => {
    h2(n$20.append, t2, r2);
  }, insertBefore: (t2, r2) => {
    h2(n$20.insertBefore, t2, r2);
  }, merge: (t2, r2) => {
    h2(n$20.merge, t2, r2);
  }, replace: (t2, r2) => {
    h2(n$20.replace, t2, r2);
  }, detach: (e2) => {
    for (let t2 = 0; t2 < u2.length; t2++)
      if (u2[t2] === e2)
        return u2.splice(t2, 1), f2.splice(t2, 1)[0];
    throw new Error("renderFunction was not found");
  } }, s2;
};
const BUILD = {
  allRenderFn: false,
  cmpDidLoad: true,
  cmpDidUnload: false,
  cmpDidUpdate: true,
  cmpDidRender: true,
  cmpWillLoad: true,
  cmpWillUpdate: true,
  cmpWillRender: true,
  connectedCallback: true,
  disconnectedCallback: true,
  element: true,
  event: true,
  hasRenderFn: true,
  lifecycle: true,
  hostListener: true,
  hostListenerTargetWindow: true,
  hostListenerTargetDocument: true,
  hostListenerTargetBody: true,
  hostListenerTargetParent: false,
  hostListenerTarget: true,
  member: true,
  method: true,
  mode: true,
  observeAttribute: true,
  prop: true,
  propMutable: true,
  reflect: true,
  scoped: true,
  shadowDom: true,
  slot: true,
  cssAnnotations: true,
  state: true,
  style: true,
  svg: true,
  updatable: true,
  vdomAttribute: true,
  vdomXlink: true,
  vdomClass: true,
  vdomFunctional: true,
  vdomKey: true,
  vdomListener: true,
  vdomRef: true,
  vdomPropOrAttr: true,
  vdomRender: true,
  vdomStyle: true,
  vdomText: true,
  watchCallback: true,
  taskQueue: true,
  hotModuleReplacement: false,
  isDebug: false,
  isDev: false,
  isTesting: false,
  hydrateServerSide: false,
  hydrateClientSide: false,
  lifecycleDOMEvents: false,
  lazyLoad: false,
  profile: false,
  slotRelocation: true,
  appendChildSlotFix: false,
  cloneNodeFix: false,
  hydratedAttribute: false,
  hydratedClass: true,
  safari10: false,
  scriptDataOpts: false,
  scopedSlotTextContentFix: false,
  shadowDomShim: false,
  slotChildNodesFix: false,
  invisiblePrehydration: true,
  propBoolean: true,
  propNumber: true,
  propString: true,
  cssVarShim: false,
  constructableCSS: true,
  cmpShouldUpdate: true,
  devTools: false,
  dynamicImportShim: false,
  shadowDelegatesFocus: true,
  initializeNextTick: false,
  asyncLoading: false,
  asyncQueue: false,
  transformTagName: false,
  attachStyles: true
};
let scopeId;
let contentRef;
let hostTagName;
let useNativeShadowDom = false;
let checkSlotFallbackVisibility = false;
let checkSlotRelocate = false;
let isSvgMode = false;
let renderingRef = null;
let queuePending = false;
const Build = {
  isDev: BUILD.isDev ? true : false,
  isBrowser: true,
  isServer: false,
  isTesting: BUILD.isTesting ? true : false
};
const getAssetPath = (path) => {
  const assetUrl = new URL(path, plt.$resourcesUrl$);
  return assetUrl.origin !== win.location.origin ? assetUrl.href : assetUrl.pathname;
};
const setAssetPath = (path) => plt.$resourcesUrl$ = path;
const createTime = (fnName, tagName = "") => {
  {
    return () => {
      return;
    };
  }
};
const XLINK_NS = "http://www.w3.org/1999/xlink";
const EMPTY_OBJ = {};
const SVG_NS = "http://www.w3.org/2000/svg";
const HTML_NS = "http://www.w3.org/1999/xhtml";
const isDef = (v2) => v2 != null;
const isComplexType = (o2) => {
  o2 = typeof o2;
  return o2 === "object" || o2 === "function";
};
const h$1b = (nodeName, vnodeData, ...children) => {
  let child = null;
  let key = null;
  let slotName = null;
  let simple = false;
  let lastSimple = false;
  const vNodeChildren = [];
  const walk = (c2) => {
    for (let i2 = 0; i2 < c2.length; i2++) {
      child = c2[i2];
      if (Array.isArray(child)) {
        walk(child);
      } else if (child != null && typeof child !== "boolean") {
        if (simple = typeof nodeName !== "function" && !isComplexType(child)) {
          child = String(child);
        }
        if (simple && lastSimple) {
          vNodeChildren[vNodeChildren.length - 1].$text$ += child;
        } else {
          vNodeChildren.push(simple ? newVNode(null, child) : child);
        }
        lastSimple = simple;
      }
    }
  };
  walk(children);
  if (vnodeData) {
    if (BUILD.isDev && nodeName === "input") {
      validateInputProperties(vnodeData);
    }
    if (BUILD.vdomKey && vnodeData.key) {
      key = vnodeData.key;
    }
    if (BUILD.slotRelocation && vnodeData.name) {
      slotName = vnodeData.name;
    }
    if (BUILD.vdomClass) {
      const classData = vnodeData.className || vnodeData.class;
      if (classData) {
        vnodeData.class = typeof classData !== "object" ? classData : Object.keys(classData).filter((k2) => classData[k2]).join(" ");
      }
    }
  }
  if (BUILD.isDev && vNodeChildren.some(isHost)) {
    consoleDevError(`The <Host> must be the single root component. Make sure:
- You are NOT using hostData() and <Host> in the same component.
- <Host> is used once, and it's the single root component of the render() function.`);
  }
  if (BUILD.vdomFunctional && typeof nodeName === "function") {
    return nodeName(vnodeData === null ? {} : vnodeData, vNodeChildren, vdomFnUtils);
  }
  const vnode = newVNode(nodeName, null);
  vnode.$attrs$ = vnodeData;
  if (vNodeChildren.length > 0) {
    vnode.$children$ = vNodeChildren;
  }
  if (BUILD.vdomKey) {
    vnode.$key$ = key;
  }
  if (BUILD.slotRelocation) {
    vnode.$name$ = slotName;
  }
  return vnode;
};
const newVNode = (tag, text) => {
  const vnode = {
    $flags$: 0,
    $tag$: tag,
    $text$: text,
    $elm$: null,
    $children$: null
  };
  if (BUILD.vdomAttribute) {
    vnode.$attrs$ = null;
  }
  if (BUILD.vdomKey) {
    vnode.$key$ = null;
  }
  if (BUILD.slotRelocation) {
    vnode.$name$ = null;
  }
  return vnode;
};
const Host = {};
const isHost = (node) => node && node.$tag$ === Host;
const vdomFnUtils = {
  forEach: (children, cb) => children.map(convertToPublic).forEach(cb),
  map: (children, cb) => children.map(convertToPublic).map(cb).map(convertToPrivate)
};
const convertToPublic = (node) => ({
  vattrs: node.$attrs$,
  vchildren: node.$children$,
  vkey: node.$key$,
  vname: node.$name$,
  vtag: node.$tag$,
  vtext: node.$text$
});
const convertToPrivate = (node) => {
  if (typeof node.vtag === "function") {
    const vnodeData = Object.assign({}, node.vattrs);
    if (node.vkey) {
      vnodeData.key = node.vkey;
    }
    if (node.vname) {
      vnodeData.name = node.vname;
    }
    return h$1b(node.vtag, vnodeData, ...node.vchildren || []);
  }
  const vnode = newVNode(node.vtag, node.vtext);
  vnode.$attrs$ = node.vattrs;
  vnode.$children$ = node.vchildren;
  vnode.$key$ = node.vkey;
  vnode.$name$ = node.vname;
  return vnode;
};
const validateInputProperties = (inputElm) => {
  const props = Object.keys(inputElm);
  const value = props.indexOf("value");
  if (value === -1) {
    return;
  }
  const typeIndex = props.indexOf("type");
  const minIndex = props.indexOf("min");
  const maxIndex = props.indexOf("max");
  const stepIndex = props.indexOf("step");
  if (value < typeIndex || value < minIndex || value < maxIndex || value < stepIndex) {
    consoleDevWarn(`The "value" prop of <input> should be set after "min", "max", "type" and "step"`);
  }
};
const computeMode = (elm) => modeResolutionChain.map((h2) => h2(elm)).find((m2) => !!m2);
const parsePropertyValue = (propValue, propType) => {
  if (propValue != null && !isComplexType(propValue)) {
    if (propType & 4) {
      return propValue === "false" ? false : propValue === "" || !!propValue;
    }
    if (propType & 2) {
      return parseFloat(propValue);
    }
    if (propType & 1) {
      return String(propValue);
    }
    return propValue;
  }
  return propValue;
};
const getElement = (ref2) => BUILD.lazyLoad ? getHostRef(ref2).$hostElement$ : ref2;
const createEvent = (ref2, name, flags) => {
  const elm = getElement(ref2);
  return {
    emit: (detail) => {
      if (BUILD.isDev && !elm.isConnected) {
        consoleDevWarn(`The "${name}" event was emitted, but the dispatcher node is no longer connected to the dom.`);
      }
      return emitEvent(elm, name, {
        bubbles: !!(flags & 4),
        composed: !!(flags & 2),
        cancelable: !!(flags & 1),
        detail
      });
    }
  };
};
const emitEvent = (elm, name, opts) => {
  const ev = plt.ce(name, opts);
  elm.dispatchEvent(ev);
  return ev;
};
const rootAppliedStyles = /* @__PURE__ */ new WeakMap();
const registerStyle = (scopeId2, cssText, allowCS) => {
  let style = styles.get(scopeId2);
  if (supportsConstructableStylesheets && allowCS) {
    style = style || new CSSStyleSheet();
    if (typeof style === "string") {
      style = cssText;
    } else {
      style.replaceSync(cssText);
    }
  } else {
    style = cssText;
  }
  styles.set(scopeId2, style);
};
const addStyle = (styleContainerNode, cmpMeta, mode, hostElm) => {
  let scopeId2 = getScopeId(cmpMeta, mode);
  const style = styles.get(scopeId2);
  styleContainerNode = styleContainerNode.nodeType === 11 ? styleContainerNode : doc;
  if (style) {
    if (typeof style === "string") {
      styleContainerNode = styleContainerNode.head || styleContainerNode;
      let appliedStyles = rootAppliedStyles.get(styleContainerNode);
      let styleElm;
      if (!appliedStyles) {
        rootAppliedStyles.set(styleContainerNode, appliedStyles = new Set());
      }
      if (!appliedStyles.has(scopeId2)) {
        {
          {
            styleElm = doc.createElement("style");
            styleElm.innerHTML = style;
          }
          styleContainerNode.insertBefore(styleElm, styleContainerNode.querySelector("link"));
        }
        if (appliedStyles) {
          appliedStyles.add(scopeId2);
        }
      }
    } else if (!styleContainerNode.adoptedStyleSheets.includes(style)) {
      styleContainerNode.adoptedStyleSheets = [...styleContainerNode.adoptedStyleSheets, style];
    }
  }
  return scopeId2;
};
const attachStyles = (hostRef) => {
  const cmpMeta = hostRef.$cmpMeta$;
  const elm = hostRef.$hostElement$;
  const flags = cmpMeta.$flags$;
  const endAttachStyles = createTime("attachStyles", cmpMeta.$tagName$);
  const scopeId2 = addStyle(supportsShadow && elm.shadowRoot ? elm.shadowRoot : elm.getRootNode(), cmpMeta, hostRef.$modeName$);
  if (flags & 10) {
    elm["s-sc"] = scopeId2;
    elm.classList.add(scopeId2 + "-h");
    if (flags & 2) {
      elm.classList.add(scopeId2 + "-s");
    }
  }
  endAttachStyles();
};
const getScopeId = (cmp, mode) => "sc-" + (mode && cmp.$flags$ & 32 ? cmp.$tagName$ + "-" + mode : cmp.$tagName$);
const setAccessor = (elm, memberName, oldValue, newValue, isSvg, flags) => {
  if (oldValue !== newValue) {
    let isProp = isMemberInElement(elm, memberName);
    let ln2 = memberName.toLowerCase();
    if (memberName === "class") {
      const classList = elm.classList;
      const oldClasses = parseClassList(oldValue);
      const newClasses = parseClassList(newValue);
      classList.remove(...oldClasses.filter((c2) => c2 && !newClasses.includes(c2)));
      classList.add(...newClasses.filter((c2) => c2 && !oldClasses.includes(c2)));
    } else if (memberName === "style") {
      {
        for (const prop in oldValue) {
          if (!newValue || newValue[prop] == null) {
            if (prop.includes("-")) {
              elm.style.removeProperty(prop);
            } else {
              elm.style[prop] = "";
            }
          }
        }
      }
      for (const prop in newValue) {
        if (!oldValue || newValue[prop] !== oldValue[prop]) {
          if (prop.includes("-")) {
            elm.style.setProperty(prop, newValue[prop]);
          } else {
            elm.style[prop] = newValue[prop];
          }
        }
      }
    } else if (memberName === "key")
      ;
    else if (memberName === "ref") {
      if (newValue) {
        newValue(elm);
      }
    } else if (!elm.__lookupSetter__(memberName) && memberName[0] === "o" && memberName[1] === "n") {
      if (memberName[2] === "-") {
        memberName = memberName.slice(3);
      } else if (isMemberInElement(win, ln2)) {
        memberName = ln2.slice(2);
      } else {
        memberName = ln2[2] + memberName.slice(3);
      }
      if (oldValue) {
        plt.rel(elm, memberName, oldValue, false);
      }
      if (newValue) {
        plt.ael(elm, memberName, newValue, false);
      }
    } else {
      const isComplex = isComplexType(newValue);
      if ((isProp || isComplex && newValue !== null) && !isSvg) {
        try {
          if (!elm.tagName.includes("-")) {
            const n2 = newValue == null ? "" : newValue;
            if (memberName === "list") {
              isProp = false;
            } else if (oldValue == null || elm[memberName] != n2) {
              elm[memberName] = n2;
            }
          } else {
            elm[memberName] = newValue;
          }
        } catch (e2) {
        }
      }
      let xlink = false;
      {
        if (ln2 !== (ln2 = ln2.replace(/^xlink\:?/, ""))) {
          memberName = ln2;
          xlink = true;
        }
      }
      if (newValue == null || newValue === false) {
        if (newValue !== false || elm.getAttribute(memberName) === "") {
          if (xlink) {
            elm.removeAttributeNS(XLINK_NS, memberName);
          } else {
            elm.removeAttribute(memberName);
          }
        }
      } else if ((!isProp || flags & 4 || isSvg) && !isComplex) {
        newValue = newValue === true ? "" : newValue;
        if (xlink) {
          elm.setAttributeNS(XLINK_NS, memberName, newValue);
        } else {
          elm.setAttribute(memberName, newValue);
        }
      }
    }
  }
};
const parseClassListRegex = /\s/;
const parseClassList = (value) => !value ? [] : value.split(parseClassListRegex);
const updateElement = (oldVnode, newVnode, isSvgMode2, memberName) => {
  const elm = newVnode.$elm$.nodeType === 11 && newVnode.$elm$.host ? newVnode.$elm$.host : newVnode.$elm$;
  const oldVnodeAttrs = oldVnode && oldVnode.$attrs$ || EMPTY_OBJ;
  const newVnodeAttrs = newVnode.$attrs$ || EMPTY_OBJ;
  {
    for (memberName in oldVnodeAttrs) {
      if (!(memberName in newVnodeAttrs)) {
        setAccessor(elm, memberName, oldVnodeAttrs[memberName], void 0, isSvgMode2, newVnode.$flags$);
      }
    }
  }
  for (memberName in newVnodeAttrs) {
    setAccessor(elm, memberName, oldVnodeAttrs[memberName], newVnodeAttrs[memberName], isSvgMode2, newVnode.$flags$);
  }
};
const createElm = (oldParentVNode, newParentVNode, childIndex, parentElm) => {
  const newVNode2 = newParentVNode.$children$[childIndex];
  let i2 = 0;
  let elm;
  let childNode;
  let oldVNode;
  if (!useNativeShadowDom) {
    checkSlotRelocate = true;
    if (newVNode2.$tag$ === "slot") {
      if (scopeId) {
        parentElm.classList.add(scopeId + "-s");
      }
      newVNode2.$flags$ |= newVNode2.$children$ ? 2 : 1;
    }
  }
  if (newVNode2.$text$ !== null) {
    elm = newVNode2.$elm$ = doc.createTextNode(newVNode2.$text$);
  } else if (newVNode2.$flags$ & 1) {
    elm = newVNode2.$elm$ = doc.createTextNode("");
  } else {
    if (!isSvgMode) {
      isSvgMode = newVNode2.$tag$ === "svg";
    }
    elm = newVNode2.$elm$ = doc.createElementNS(isSvgMode ? SVG_NS : HTML_NS, newVNode2.$flags$ & 2 ? "slot-fb" : newVNode2.$tag$);
    if (isSvgMode && newVNode2.$tag$ === "foreignObject") {
      isSvgMode = false;
    }
    {
      updateElement(null, newVNode2, isSvgMode);
    }
    if (isDef(scopeId) && elm["s-si"] !== scopeId) {
      elm.classList.add(elm["s-si"] = scopeId);
    }
    if (newVNode2.$children$) {
      for (i2 = 0; i2 < newVNode2.$children$.length; ++i2) {
        childNode = createElm(oldParentVNode, newVNode2, i2, elm);
        if (childNode) {
          elm.appendChild(childNode);
        }
      }
    }
    {
      if (newVNode2.$tag$ === "svg") {
        isSvgMode = false;
      } else if (elm.tagName === "foreignObject") {
        isSvgMode = true;
      }
    }
  }
  {
    elm["s-hn"] = hostTagName;
    if (newVNode2.$flags$ & (2 | 1)) {
      elm["s-sr"] = true;
      elm["s-cr"] = contentRef;
      elm["s-sn"] = newVNode2.$name$ || "";
      oldVNode = oldParentVNode && oldParentVNode.$children$ && oldParentVNode.$children$[childIndex];
      if (oldVNode && oldVNode.$tag$ === newVNode2.$tag$ && oldParentVNode.$elm$) {
        putBackInOriginalLocation(oldParentVNode.$elm$, false);
      }
    }
  }
  return elm;
};
const putBackInOriginalLocation = (parentElm, recursive) => {
  plt.$flags$ |= 1;
  const oldSlotChildNodes = parentElm.childNodes;
  for (let i2 = oldSlotChildNodes.length - 1; i2 >= 0; i2--) {
    const childNode = oldSlotChildNodes[i2];
    if (childNode["s-hn"] !== hostTagName && childNode["s-ol"]) {
      parentReferenceNode(childNode).insertBefore(childNode, referenceNode(childNode));
      childNode["s-ol"].remove();
      childNode["s-ol"] = void 0;
      checkSlotRelocate = true;
    }
    if (recursive) {
      putBackInOriginalLocation(childNode, recursive);
    }
  }
  plt.$flags$ &= ~1;
};
const addVnodes = (parentElm, before, parentVNode, vnodes, startIdx, endIdx) => {
  let containerElm = parentElm["s-cr"] && parentElm["s-cr"].parentNode || parentElm;
  let childNode;
  if (containerElm.shadowRoot && containerElm.tagName === hostTagName) {
    containerElm = containerElm.shadowRoot;
  }
  for (; startIdx <= endIdx; ++startIdx) {
    if (vnodes[startIdx]) {
      childNode = createElm(null, parentVNode, startIdx, parentElm);
      if (childNode) {
        vnodes[startIdx].$elm$ = childNode;
        containerElm.insertBefore(childNode, referenceNode(before));
      }
    }
  }
};
const removeVnodes = (vnodes, startIdx, endIdx, vnode, elm) => {
  for (; startIdx <= endIdx; ++startIdx) {
    if (vnode = vnodes[startIdx]) {
      elm = vnode.$elm$;
      callNodeRefs(vnode);
      {
        checkSlotFallbackVisibility = true;
        if (elm["s-ol"]) {
          elm["s-ol"].remove();
        } else {
          putBackInOriginalLocation(elm, true);
        }
      }
      elm.remove();
    }
  }
};
const updateChildren = (parentElm, oldCh, newVNode2, newCh) => {
  let oldStartIdx = 0;
  let newStartIdx = 0;
  let idxInOld = 0;
  let i2 = 0;
  let oldEndIdx = oldCh.length - 1;
  let oldStartVnode = oldCh[0];
  let oldEndVnode = oldCh[oldEndIdx];
  let newEndIdx = newCh.length - 1;
  let newStartVnode = newCh[0];
  let newEndVnode = newCh[newEndIdx];
  let node;
  let elmToMove;
  while (oldStartIdx <= oldEndIdx && newStartIdx <= newEndIdx) {
    if (oldStartVnode == null) {
      oldStartVnode = oldCh[++oldStartIdx];
    } else if (oldEndVnode == null) {
      oldEndVnode = oldCh[--oldEndIdx];
    } else if (newStartVnode == null) {
      newStartVnode = newCh[++newStartIdx];
    } else if (newEndVnode == null) {
      newEndVnode = newCh[--newEndIdx];
    } else if (isSameVnode(oldStartVnode, newStartVnode)) {
      patch(oldStartVnode, newStartVnode);
      oldStartVnode = oldCh[++oldStartIdx];
      newStartVnode = newCh[++newStartIdx];
    } else if (isSameVnode(oldEndVnode, newEndVnode)) {
      patch(oldEndVnode, newEndVnode);
      oldEndVnode = oldCh[--oldEndIdx];
      newEndVnode = newCh[--newEndIdx];
    } else if (isSameVnode(oldStartVnode, newEndVnode)) {
      if (oldStartVnode.$tag$ === "slot" || newEndVnode.$tag$ === "slot") {
        putBackInOriginalLocation(oldStartVnode.$elm$.parentNode, false);
      }
      patch(oldStartVnode, newEndVnode);
      parentElm.insertBefore(oldStartVnode.$elm$, oldEndVnode.$elm$.nextSibling);
      oldStartVnode = oldCh[++oldStartIdx];
      newEndVnode = newCh[--newEndIdx];
    } else if (isSameVnode(oldEndVnode, newStartVnode)) {
      if (oldStartVnode.$tag$ === "slot" || newEndVnode.$tag$ === "slot") {
        putBackInOriginalLocation(oldEndVnode.$elm$.parentNode, false);
      }
      patch(oldEndVnode, newStartVnode);
      parentElm.insertBefore(oldEndVnode.$elm$, oldStartVnode.$elm$);
      oldEndVnode = oldCh[--oldEndIdx];
      newStartVnode = newCh[++newStartIdx];
    } else {
      idxInOld = -1;
      {
        for (i2 = oldStartIdx; i2 <= oldEndIdx; ++i2) {
          if (oldCh[i2] && oldCh[i2].$key$ !== null && oldCh[i2].$key$ === newStartVnode.$key$) {
            idxInOld = i2;
            break;
          }
        }
      }
      if (idxInOld >= 0) {
        elmToMove = oldCh[idxInOld];
        if (elmToMove.$tag$ !== newStartVnode.$tag$) {
          node = createElm(oldCh && oldCh[newStartIdx], newVNode2, idxInOld, parentElm);
        } else {
          patch(elmToMove, newStartVnode);
          oldCh[idxInOld] = void 0;
          node = elmToMove.$elm$;
        }
        newStartVnode = newCh[++newStartIdx];
      } else {
        node = createElm(oldCh && oldCh[newStartIdx], newVNode2, newStartIdx, parentElm);
        newStartVnode = newCh[++newStartIdx];
      }
      if (node) {
        {
          parentReferenceNode(oldStartVnode.$elm$).insertBefore(node, referenceNode(oldStartVnode.$elm$));
        }
      }
    }
  }
  if (oldStartIdx > oldEndIdx) {
    addVnodes(parentElm, newCh[newEndIdx + 1] == null ? null : newCh[newEndIdx + 1].$elm$, newVNode2, newCh, newStartIdx, newEndIdx);
  } else if (newStartIdx > newEndIdx) {
    removeVnodes(oldCh, oldStartIdx, oldEndIdx);
  }
};
const isSameVnode = (leftVNode, rightVNode) => {
  if (leftVNode.$tag$ === rightVNode.$tag$) {
    if (leftVNode.$tag$ === "slot") {
      return leftVNode.$name$ === rightVNode.$name$;
    }
    {
      return leftVNode.$key$ === rightVNode.$key$;
    }
  }
  return false;
};
const referenceNode = (node) => {
  return node && node["s-ol"] || node;
};
const parentReferenceNode = (node) => (node["s-ol"] ? node["s-ol"] : node).parentNode;
const patch = (oldVNode, newVNode2) => {
  const elm = newVNode2.$elm$ = oldVNode.$elm$;
  const oldChildren = oldVNode.$children$;
  const newChildren = newVNode2.$children$;
  const tag = newVNode2.$tag$;
  const text = newVNode2.$text$;
  let defaultHolder;
  if (text === null) {
    {
      isSvgMode = tag === "svg" ? true : tag === "foreignObject" ? false : isSvgMode;
    }
    {
      if (tag === "slot")
        ;
      else {
        updateElement(oldVNode, newVNode2, isSvgMode);
      }
    }
    if (oldChildren !== null && newChildren !== null) {
      updateChildren(elm, oldChildren, newVNode2, newChildren);
    } else if (newChildren !== null) {
      if (oldVNode.$text$ !== null) {
        elm.textContent = "";
      }
      addVnodes(elm, null, newVNode2, newChildren, 0, newChildren.length - 1);
    } else if (oldChildren !== null) {
      removeVnodes(oldChildren, 0, oldChildren.length - 1);
    }
    if (isSvgMode && tag === "svg") {
      isSvgMode = false;
    }
  } else if (defaultHolder = elm["s-cr"]) {
    defaultHolder.parentNode.textContent = text;
  } else if (oldVNode.$text$ !== text) {
    elm.data = text;
  }
};
const updateFallbackSlotVisibility = (elm) => {
  const childNodes = elm.childNodes;
  let childNode;
  let i2;
  let ilen;
  let j2;
  let slotNameAttr;
  let nodeType;
  for (i2 = 0, ilen = childNodes.length; i2 < ilen; i2++) {
    childNode = childNodes[i2];
    if (childNode.nodeType === 1) {
      if (childNode["s-sr"]) {
        slotNameAttr = childNode["s-sn"];
        childNode.hidden = false;
        for (j2 = 0; j2 < ilen; j2++) {
          nodeType = childNodes[j2].nodeType;
          if (childNodes[j2]["s-hn"] !== childNode["s-hn"] || slotNameAttr !== "") {
            if (nodeType === 1 && slotNameAttr === childNodes[j2].getAttribute("slot")) {
              childNode.hidden = true;
              break;
            }
          } else {
            if (nodeType === 1 || nodeType === 3 && childNodes[j2].textContent.trim() !== "") {
              childNode.hidden = true;
              break;
            }
          }
        }
      }
      updateFallbackSlotVisibility(childNode);
    }
  }
};
const relocateNodes = [];
const relocateSlotContent = (elm) => {
  let childNode;
  let node;
  let hostContentNodes;
  let slotNameAttr;
  let relocateNodeData;
  let j2;
  let i2 = 0;
  const childNodes = elm.childNodes;
  const ilen = childNodes.length;
  for (; i2 < ilen; i2++) {
    childNode = childNodes[i2];
    if (childNode["s-sr"] && (node = childNode["s-cr"]) && node.parentNode) {
      hostContentNodes = node.parentNode.childNodes;
      slotNameAttr = childNode["s-sn"];
      for (j2 = hostContentNodes.length - 1; j2 >= 0; j2--) {
        node = hostContentNodes[j2];
        if (!node["s-cn"] && !node["s-nr"] && node["s-hn"] !== childNode["s-hn"]) {
          if (isNodeLocatedInSlot(node, slotNameAttr)) {
            relocateNodeData = relocateNodes.find((r2) => r2.$nodeToRelocate$ === node);
            checkSlotFallbackVisibility = true;
            node["s-sn"] = node["s-sn"] || slotNameAttr;
            if (relocateNodeData) {
              relocateNodeData.$slotRefNode$ = childNode;
            } else {
              relocateNodes.push({
                $slotRefNode$: childNode,
                $nodeToRelocate$: node
              });
            }
            if (node["s-sr"]) {
              relocateNodes.map((relocateNode) => {
                if (isNodeLocatedInSlot(relocateNode.$nodeToRelocate$, node["s-sn"])) {
                  relocateNodeData = relocateNodes.find((r2) => r2.$nodeToRelocate$ === node);
                  if (relocateNodeData && !relocateNode.$slotRefNode$) {
                    relocateNode.$slotRefNode$ = relocateNodeData.$slotRefNode$;
                  }
                }
              });
            }
          } else if (!relocateNodes.some((r2) => r2.$nodeToRelocate$ === node)) {
            relocateNodes.push({
              $nodeToRelocate$: node
            });
          }
        }
      }
    }
    if (childNode.nodeType === 1) {
      relocateSlotContent(childNode);
    }
  }
};
const isNodeLocatedInSlot = (nodeToRelocate, slotNameAttr) => {
  if (nodeToRelocate.nodeType === 1) {
    if (nodeToRelocate.getAttribute("slot") === null && slotNameAttr === "") {
      return true;
    }
    if (nodeToRelocate.getAttribute("slot") === slotNameAttr) {
      return true;
    }
    return false;
  }
  if (nodeToRelocate["s-sn"] === slotNameAttr) {
    return true;
  }
  return slotNameAttr === "";
};
const callNodeRefs = (vNode) => {
  {
    vNode.$attrs$ && vNode.$attrs$.ref && vNode.$attrs$.ref(null);
    vNode.$children$ && vNode.$children$.map(callNodeRefs);
  }
};
const renderVdom = (hostRef, renderFnResults) => {
  const hostElm = hostRef.$hostElement$;
  const cmpMeta = hostRef.$cmpMeta$;
  const oldVNode = hostRef.$vnode$ || newVNode(null, null);
  const rootVnode = isHost(renderFnResults) ? renderFnResults : h$1b(null, null, renderFnResults);
  hostTagName = hostElm.tagName;
  if (cmpMeta.$attrsToReflect$) {
    rootVnode.$attrs$ = rootVnode.$attrs$ || {};
    cmpMeta.$attrsToReflect$.map(([propName, attribute]) => rootVnode.$attrs$[attribute] = hostElm[propName]);
  }
  rootVnode.$tag$ = null;
  rootVnode.$flags$ |= 4;
  hostRef.$vnode$ = rootVnode;
  rootVnode.$elm$ = oldVNode.$elm$ = hostElm.shadowRoot || hostElm;
  {
    scopeId = hostElm["s-sc"];
  }
  {
    contentRef = hostElm["s-cr"];
    useNativeShadowDom = supportsShadow && (cmpMeta.$flags$ & 1) !== 0;
    checkSlotFallbackVisibility = false;
  }
  patch(oldVNode, rootVnode);
  {
    plt.$flags$ |= 1;
    if (checkSlotRelocate) {
      relocateSlotContent(rootVnode.$elm$);
      let relocateData;
      let nodeToRelocate;
      let orgLocationNode;
      let parentNodeRef;
      let insertBeforeNode;
      let refNode;
      let i2 = 0;
      for (; i2 < relocateNodes.length; i2++) {
        relocateData = relocateNodes[i2];
        nodeToRelocate = relocateData.$nodeToRelocate$;
        if (!nodeToRelocate["s-ol"]) {
          orgLocationNode = doc.createTextNode("");
          orgLocationNode["s-nr"] = nodeToRelocate;
          nodeToRelocate.parentNode.insertBefore(nodeToRelocate["s-ol"] = orgLocationNode, nodeToRelocate);
        }
      }
      for (i2 = 0; i2 < relocateNodes.length; i2++) {
        relocateData = relocateNodes[i2];
        nodeToRelocate = relocateData.$nodeToRelocate$;
        if (relocateData.$slotRefNode$) {
          parentNodeRef = relocateData.$slotRefNode$.parentNode;
          insertBeforeNode = relocateData.$slotRefNode$.nextSibling;
          orgLocationNode = nodeToRelocate["s-ol"];
          while (orgLocationNode = orgLocationNode.previousSibling) {
            refNode = orgLocationNode["s-nr"];
            if (refNode && refNode["s-sn"] === nodeToRelocate["s-sn"] && parentNodeRef === refNode.parentNode) {
              refNode = refNode.nextSibling;
              if (!refNode || !refNode["s-nr"]) {
                insertBeforeNode = refNode;
                break;
              }
            }
          }
          if (!insertBeforeNode && parentNodeRef !== nodeToRelocate.parentNode || nodeToRelocate.nextSibling !== insertBeforeNode) {
            if (nodeToRelocate !== insertBeforeNode) {
              if (!nodeToRelocate["s-hn"] && nodeToRelocate["s-ol"]) {
                nodeToRelocate["s-hn"] = nodeToRelocate["s-ol"].parentNode.nodeName;
              }
              parentNodeRef.insertBefore(nodeToRelocate, insertBeforeNode);
            }
          }
        } else {
          if (nodeToRelocate.nodeType === 1) {
            nodeToRelocate.hidden = true;
          }
        }
      }
    }
    if (checkSlotFallbackVisibility) {
      updateFallbackSlotVisibility(rootVnode.$elm$);
    }
    plt.$flags$ &= ~1;
    relocateNodes.length = 0;
  }
};
const attachToAncestor = (hostRef, ancestorComponent) => {
};
const scheduleUpdate = (hostRef, isInitialLoad) => {
  if (BUILD.taskQueue && BUILD.updatable) {
    hostRef.$flags$ |= 16;
  }
  attachToAncestor(hostRef, hostRef.$ancestorComponent$);
  const dispatch = () => dispatchHooks(hostRef, isInitialLoad);
  return BUILD.taskQueue ? writeTask(dispatch) : dispatch();
};
const dispatchHooks = (hostRef, isInitialLoad) => {
  const elm = hostRef.$hostElement$;
  const endSchedule = createTime("scheduleUpdate", hostRef.$cmpMeta$.$tagName$);
  const instance = elm;
  let promise;
  if (isInitialLoad) {
    {
      promise = safeCall(instance, "componentWillLoad");
    }
  } else {
    {
      promise = safeCall(instance, "componentWillUpdate");
    }
  }
  {
    promise = then(promise, () => safeCall(instance, "componentWillRender"));
  }
  endSchedule();
  return then(promise, () => updateComponent(hostRef, instance, isInitialLoad));
};
const updateComponent = async (hostRef, instance, isInitialLoad) => {
  const elm = hostRef.$hostElement$;
  const endUpdate = createTime("update", hostRef.$cmpMeta$.$tagName$);
  elm["s-rc"];
  if (isInitialLoad) {
    attachStyles(hostRef);
  }
  const endRender = createTime("render", hostRef.$cmpMeta$.$tagName$);
  {
    callRender(hostRef, instance, elm);
  }
  endRender();
  endUpdate();
  {
    postUpdateComponent(hostRef);
  }
};
const callRender = (hostRef, instance, elm) => {
  const allRenderFn = false;
  const lazyLoad = false;
  const taskQueue = true;
  const updatable = true;
  try {
    renderingRef = instance;
    instance = allRenderFn ? instance.render() : instance.render && instance.render();
    if (updatable && taskQueue) {
      hostRef.$flags$ &= ~16;
    }
    if (updatable || lazyLoad) {
      hostRef.$flags$ |= 2;
    }
    if (BUILD.hasRenderFn || BUILD.reflect) {
      if (BUILD.vdomRender || BUILD.reflect) {
        if (BUILD.hydrateServerSide)
          ;
        else {
          renderVdom(hostRef, instance);
        }
      }
    }
  } catch (e2) {
    consoleError(e2, hostRef.$hostElement$);
  }
  renderingRef = null;
  return null;
};
const postUpdateComponent = (hostRef) => {
  const tagName = hostRef.$cmpMeta$.$tagName$;
  const elm = hostRef.$hostElement$;
  const endPostUpdate = createTime("postUpdate", tagName);
  const instance = elm;
  hostRef.$ancestorComponent$;
  {
    safeCall(instance, "componentDidRender");
  }
  if (!(hostRef.$flags$ & 64)) {
    hostRef.$flags$ |= 64;
    {
      safeCall(instance, "componentDidLoad");
    }
    endPostUpdate();
  } else {
    {
      safeCall(instance, "componentDidUpdate");
    }
    endPostUpdate();
  }
};
const forceUpdate = (ref2) => {
  if (BUILD.updatable) {
    const hostRef = getHostRef(ref2);
    const isConnected = hostRef.$hostElement$.isConnected;
    if (isConnected && (hostRef.$flags$ & (2 | 16)) === 2) {
      scheduleUpdate(hostRef, false);
    }
    return isConnected;
  }
  return false;
};
const safeCall = (instance, method, arg) => {
  if (instance && instance[method]) {
    try {
      return instance[method](arg);
    } catch (e2) {
      consoleError(e2);
    }
  }
  return void 0;
};
const then = (promise, thenFn) => {
  return promise && promise.then ? promise.then(thenFn) : thenFn();
};
const getValue = (ref2, propName) => getHostRef(ref2).$instanceValues$.get(propName);
const setValue = (ref2, propName, newVal, cmpMeta) => {
  const hostRef = getHostRef(ref2);
  const elm = ref2;
  const oldVal = hostRef.$instanceValues$.get(propName);
  const flags = hostRef.$flags$;
  const instance = elm;
  newVal = parsePropertyValue(newVal, cmpMeta.$members$[propName][0]);
  const areBothNaN = Number.isNaN(oldVal) && Number.isNaN(newVal);
  const didValueChange = newVal !== oldVal && !areBothNaN;
  if (didValueChange) {
    hostRef.$instanceValues$.set(propName, newVal);
    {
      if (cmpMeta.$watchers$ && flags & 128) {
        const watchMethods = cmpMeta.$watchers$[propName];
        if (watchMethods) {
          watchMethods.map((watchMethodName) => {
            try {
              instance[watchMethodName](newVal, oldVal, propName);
            } catch (e2) {
              consoleError(e2, elm);
            }
          });
        }
      }
      if ((flags & (2 | 16)) === 2) {
        if (instance.componentShouldUpdate) {
          if (instance.componentShouldUpdate(newVal, oldVal, propName) === false) {
            return;
          }
        }
        scheduleUpdate(hostRef, false);
      }
    }
  }
};
const proxyComponent = (Cstr, cmpMeta, flags) => {
  if (cmpMeta.$members$) {
    if (Cstr.watchers) {
      cmpMeta.$watchers$ = Cstr.watchers;
    }
    const members = Object.entries(cmpMeta.$members$);
    const prototype = Cstr.prototype;
    members.map(([memberName, [memberFlags]]) => {
      if (memberFlags & 31 || memberFlags & 32) {
        Object.defineProperty(prototype, memberName, {
          get() {
            return getValue(this, memberName);
          },
          set(newValue) {
            setValue(this, memberName, newValue, cmpMeta);
          },
          configurable: true,
          enumerable: true
        });
      }
    });
    {
      const attrNameToPropName = new Map();
      prototype.attributeChangedCallback = function(attrName, _oldValue, newValue) {
        plt.jmp(() => {
          const propName = attrNameToPropName.get(attrName);
          if (this.hasOwnProperty(propName)) {
            newValue = this[propName];
            delete this[propName];
          } else if (prototype.hasOwnProperty(propName) && typeof this[propName] === "number" && this[propName] == newValue) {
            return;
          }
          this[propName] = newValue === null && typeof this[propName] === "boolean" ? false : newValue;
        });
      };
      Cstr.observedAttributes = members.filter(([_2, m2]) => m2[0] & 15).map(([propName, m2]) => {
        const attrName = m2[1] || propName;
        attrNameToPropName.set(attrName, propName);
        if (m2[0] & 512) {
          cmpMeta.$attrsToReflect$.push([propName, attrName]);
        }
        return attrName;
      });
    }
  }
  return Cstr;
};
const initializeComponent = async (elm, hostRef, cmpMeta, hmrVersionId, Cstr) => {
  if ((hostRef.$flags$ & 32) === 0) {
    {
      Cstr = elm.constructor;
      hostRef.$flags$ |= 32;
      customElements.whenDefined(cmpMeta.$tagName$).then(() => hostRef.$flags$ |= 128);
    }
    if (Cstr.style) {
      let style = Cstr.style;
      if (typeof style !== "string") {
        style = style[hostRef.$modeName$ = computeMode(elm)];
      }
      const scopeId2 = getScopeId(cmpMeta, hostRef.$modeName$);
      if (!styles.has(scopeId2)) {
        const endRegisterStyles = createTime("registerStyles", cmpMeta.$tagName$);
        registerStyle(scopeId2, style, !!(cmpMeta.$flags$ & 1));
        endRegisterStyles();
      }
    }
  }
  hostRef.$ancestorComponent$;
  const schedule = () => scheduleUpdate(hostRef, true);
  {
    schedule();
  }
};
const fireConnectedCallback = (instance) => {
};
const connectedCallback = (elm) => {
  if ((plt.$flags$ & 1) === 0) {
    const hostRef = getHostRef(elm);
    const cmpMeta = hostRef.$cmpMeta$;
    const endConnected = createTime("connectedCallback", cmpMeta.$tagName$);
    if (!(hostRef.$flags$ & 1)) {
      hostRef.$flags$ |= 1;
      {
        if (cmpMeta.$flags$ & (4 | 8)) {
          setContentReference(elm);
        }
      }
      if (cmpMeta.$members$) {
        Object.entries(cmpMeta.$members$).map(([memberName, [memberFlags]]) => {
          if (memberFlags & 31 && elm.hasOwnProperty(memberName)) {
            const value = elm[memberName];
            delete elm[memberName];
            elm[memberName] = value;
          }
        });
      }
      {
        initializeComponent(elm, hostRef, cmpMeta);
      }
    } else {
      addHostEventListeners(elm, hostRef, cmpMeta.$listeners$);
      fireConnectedCallback(hostRef.$lazyInstance$);
    }
    endConnected();
  }
};
const setContentReference = (elm) => {
  const contentRefElm = elm["s-cr"] = doc.createComment("");
  contentRefElm["s-cn"] = true;
  elm.insertBefore(contentRefElm, elm.firstChild);
};
const disconnectedCallback = (elm) => {
  if ((plt.$flags$ & 1) === 0) {
    const hostRef = getHostRef(elm);
    {
      if (hostRef.$rmListeners$) {
        hostRef.$rmListeners$.map((rmListener) => rmListener());
        hostRef.$rmListeners$ = void 0;
      }
    }
  }
};
const proxyCustomElement = (Cstr, compactMeta) => {
  const cmpMeta = {
    $flags$: compactMeta[0],
    $tagName$: compactMeta[1]
  };
  if (BUILD.member) {
    cmpMeta.$members$ = compactMeta[2];
  }
  if (BUILD.hostListener) {
    cmpMeta.$listeners$ = compactMeta[3];
  }
  if (BUILD.watchCallback) {
    cmpMeta.$watchers$ = Cstr.$watchers$;
  }
  if (BUILD.reflect) {
    cmpMeta.$attrsToReflect$ = [];
  }
  if (BUILD.shadowDom && !supportsShadow && cmpMeta.$flags$ & 1) {
    cmpMeta.$flags$ |= 8;
  }
  const originalConnectedCallback = Cstr.prototype.connectedCallback;
  const originalDisconnectedCallback = Cstr.prototype.disconnectedCallback;
  Object.assign(Cstr.prototype, {
    __registerHost() {
      registerHost(this, cmpMeta);
    },
    connectedCallback() {
      connectedCallback(this);
      if (BUILD.connectedCallback && originalConnectedCallback) {
        originalConnectedCallback.call(this);
      }
    },
    disconnectedCallback() {
      disconnectedCallback(this);
      if (BUILD.disconnectedCallback && originalDisconnectedCallback) {
        originalDisconnectedCallback.call(this);
      }
    },
    __attachShadow() {
      if (supportsShadow) {
        if (BUILD.shadowDelegatesFocus) {
          this.attachShadow({
            mode: "open",
            delegatesFocus: !!(cmpMeta.$flags$ & 16)
          });
        } else {
          this.attachShadow({ mode: "open" });
        }
      } else {
        this.shadowRoot = this;
      }
    }
  });
  Cstr.is = cmpMeta.$tagName$;
  return proxyComponent(Cstr, cmpMeta);
};
const Fragment = (_2, children) => children;
const addHostEventListeners = (elm, hostRef, listeners, attachParentListeners) => {
  if (listeners) {
    listeners.map(([flags, name, method]) => {
      const target = getHostListenerTarget(elm, flags);
      const handler = hostListenerProxy(hostRef, method);
      const opts = hostListenerOpts(flags);
      plt.ael(target, name, handler, opts);
      (hostRef.$rmListeners$ = hostRef.$rmListeners$ || []).push(() => plt.rel(target, name, handler, opts));
    });
  }
};
const hostListenerProxy = (hostRef, methodName) => (ev) => {
  try {
    if (BUILD.lazyLoad)
      ;
    else {
      hostRef.$hostElement$[methodName](ev);
    }
  } catch (e2) {
    consoleError(e2);
  }
};
const getHostListenerTarget = (elm, flags) => {
  if (flags & 4)
    return doc;
  if (flags & 8)
    return win;
  if (flags & 16)
    return doc.body;
  return elm;
};
const hostListenerOpts = (flags) => supportsListenerOptions ? {
  passive: (flags & 1) !== 0,
  capture: (flags & 2) !== 0
} : (flags & 2) !== 0;
const hostRefs = /* @__PURE__ */ new WeakMap();
const getHostRef = (ref2) => hostRefs.get(ref2);
const registerHost = (elm, cmpMeta) => {
  const hostRef = {
    $flags$: 0,
    $hostElement$: elm,
    $cmpMeta$: cmpMeta,
    $instanceValues$: new Map()
  };
  if (BUILD.isDev) {
    hostRef.$renderCount$ = 0;
  }
  if (BUILD.method && BUILD.lazyLoad) {
    hostRef.$onInstancePromise$ = new Promise((r2) => hostRef.$onInstanceResolve$ = r2);
  }
  if (BUILD.asyncLoading) {
    hostRef.$onReadyPromise$ = new Promise((r2) => hostRef.$onReadyResolve$ = r2);
    elm["s-p"] = [];
    elm["s-rc"] = [];
  }
  addHostEventListeners(elm, hostRef, cmpMeta.$listeners$);
  return hostRefs.set(elm, hostRef);
};
const isMemberInElement = (elm, memberName) => memberName in elm;
const consoleError = (e2, el) => (0, console.error)(e2, el);
const STENCIL_DEV_MODE = BUILD.isTesting ? ["STENCIL:"] : [
  "%cstencil",
  "color: white;background:#4c47ff;font-weight: bold; font-size:10px; padding:2px 6px; border-radius: 5px"
];
const consoleDevError = (...m2) => console.error(...STENCIL_DEV_MODE, ...m2);
const consoleDevWarn = (...m2) => console.warn(...STENCIL_DEV_MODE, ...m2);
const styles = /* @__PURE__ */ new Map();
const modeResolutionChain = [];
const win = typeof window !== "undefined" ? window : {};
BUILD.cssVarShim ? win.CSS : null;
const doc = win.document || { head: {} };
const H$g = win.HTMLElement || class {
};
const plt = {
  $flags$: 0,
  $resourcesUrl$: "",
  jmp: (h2) => h2(),
  raf: (h2) => requestAnimationFrame(h2),
  ael: (el, eventName, listener, opts) => el.addEventListener(eventName, listener, opts),
  rel: (el, eventName, listener, opts) => el.removeEventListener(eventName, listener, opts),
  ce: (eventName, opts) => new CustomEvent(eventName, opts)
};
const supportsShadow = BUILD.shadowDomShim && BUILD.shadowDom ? /* @__PURE__ */ (() => (doc.head.attachShadow + "").indexOf("[native") > -1)() : true;
const supportsListenerOptions = /* @__PURE__ */ (() => {
  let supportsListenerOptions2 = false;
  try {
    doc.addEventListener("e", null, Object.defineProperty({}, "passive", {
      get() {
        supportsListenerOptions2 = true;
      }
    }));
  } catch (e2) {
  }
  return supportsListenerOptions2;
})();
const promiseResolve = (v2) => Promise.resolve(v2);
const supportsConstructableStylesheets = BUILD.constructableCSS ? /* @__PURE__ */ (() => {
  try {
    new CSSStyleSheet();
    return typeof new CSSStyleSheet().replaceSync === "function";
  } catch (e2) {
  }
  return false;
})() : false;
const queueDomReads = [];
const queueDomWrites = [];
const queueTask = (queue, write) => (cb) => {
  queue.push(cb);
  if (!queuePending) {
    queuePending = true;
    if (write && plt.$flags$ & 4) {
      nextTick(flush);
    } else {
      plt.raf(flush);
    }
  }
};
const consume = (queue) => {
  for (let i2 = 0; i2 < queue.length; i2++) {
    try {
      queue[i2](performance.now());
    } catch (e2) {
      consoleError(e2);
    }
  }
  queue.length = 0;
};
const flush = () => {
  consume(queueDomReads);
  {
    consume(queueDomWrites);
    if (queuePending = queueDomReads.length > 0) {
      plt.raf(flush);
    }
  }
};
const nextTick = (cb) => promiseResolve().then(cb);
const writeTask = /* @__PURE__ */ queueTask(queueDomWrites, true);
/*!
 * All material copyright ESRI, All Rights Reserved, unless otherwise specified.
 * See https://github.com/Esri/calcite-components/blob/master/LICENSE.md for details.
 * v1.0.0-beta.97
 */
const autoTheme = "calcite-theme-auto";
const darkTheme = "calcite-theme-dark";
function getElementDir(el) {
  const prop = "dir";
  const selector = `[${prop}]`;
  const closest = closestElementCrossShadowBoundary(el, selector);
  return closest ? closest.getAttribute(prop) : "ltr";
}
function getRootNode(el) {
  return el.getRootNode();
}
function getHost(root) {
  return root.host || null;
}
function queryElementRoots(element, { selector, id }) {
  function queryFrom(el) {
    if (!el) {
      return null;
    }
    if (el.assignedSlot) {
      el = el.assignedSlot;
    }
    const rootNode = getRootNode(el);
    const found = id ? "getElementById" in rootNode ? rootNode.getElementById(id) : null : selector ? rootNode.querySelector(selector) : null;
    const host = getHost(rootNode);
    return found ? found : host ? queryFrom(host) : null;
  }
  return queryFrom(element);
}
function closestElementCrossShadowBoundary(element, selector) {
  function closestFrom(el) {
    return el ? el.closest(selector) || closestFrom(getHost(getRootNode(el))) : null;
  }
  return closestFrom(element);
}
function isCalciteFocusable(el) {
  return typeof (el === null || el === void 0 ? void 0 : el.setFocus) === "function";
}
async function focusElement(el) {
  if (!el) {
    return;
  }
  return isCalciteFocusable(el) ? el.setFocus() : el.focus();
}
const defaultSlotSelector = ":not([slot])";
function getSlotted(element, slotName, options) {
  if (slotName && !Array.isArray(slotName) && typeof slotName !== "string") {
    options = slotName;
    slotName = null;
  }
  const slotSelector = slotName ? Array.isArray(slotName) ? slotName.map((name) => `[slot="${name}"]`).join(",") : `[slot="${slotName}"]` : defaultSlotSelector;
  if (options === null || options === void 0 ? void 0 : options.all) {
    return queryMultiple(element, slotSelector, options);
  }
  return querySingle(element, slotSelector, options);
}
function getDirectChildren(el, selector) {
  return el ? Array.from(el.children || []).filter((child) => child === null || child === void 0 ? void 0 : child.matches(selector)) : [];
}
function queryMultiple(element, slotSelector, options) {
  let matches = slotSelector === defaultSlotSelector ? getDirectChildren(element, defaultSlotSelector) : Array.from(element.querySelectorAll(slotSelector));
  matches = options && options.direct === false ? matches : matches.filter((el) => el.parentElement === element);
  matches = (options === null || options === void 0 ? void 0 : options.matches) ? matches.filter((el) => el === null || el === void 0 ? void 0 : el.matches(options.matches)) : matches;
  const selector = options === null || options === void 0 ? void 0 : options.selector;
  return selector ? matches.map((item) => Array.from(item.querySelectorAll(selector))).reduce((previousValue, currentValue) => [...previousValue, ...currentValue], []).filter((match) => !!match) : matches;
}
function querySingle(element, slotSelector, options) {
  let match = slotSelector === defaultSlotSelector ? getDirectChildren(element, defaultSlotSelector)[0] || null : element.querySelector(slotSelector);
  match = options && options.direct === false ? match : (match === null || match === void 0 ? void 0 : match.parentElement) === element ? match : null;
  match = (options === null || options === void 0 ? void 0 : options.matches) ? (match === null || match === void 0 ? void 0 : match.matches(options.matches)) ? match : null : match;
  const selector = options === null || options === void 0 ? void 0 : options.selector;
  return selector ? match === null || match === void 0 ? void 0 : match.querySelector(selector) : match;
}
function setRequestedIcon(iconObject, iconValue, matchedValue) {
  if (typeof iconValue === "string" && iconValue !== "") {
    return iconValue;
  } else if (iconValue === "") {
    return iconObject[matchedValue];
  }
}
function toAriaBoolean(value) {
  return Boolean(value).toString();
}
function isPrimaryPointerButton(event) {
  return !!(event.isPrimary && event.button === 0);
}
/*!
 * All material copyright ESRI, All Rights Reserved, unless otherwise specified.
 * See https://github.com/Esri/calcite-components/blob/master/LICENSE.md for details.
 * v1.0.0-beta.97
 */
function initThemeChangeEvent() {
  const { classList } = document.body;
  const prefersDark = window.matchMedia("(prefers-color-scheme: dark)").matches;
  const getTheme = () => classList.contains(darkTheme) || classList.contains(autoTheme) && prefersDark ? "dark" : "light";
  const emitThemeChange = (theme) => document.body.dispatchEvent(new CustomEvent("calciteThemeChange", { bubbles: true, detail: { theme } }));
  const themeChangeHandler = (newTheme) => {
    currentTheme !== newTheme && emitThemeChange(newTheme);
    currentTheme = newTheme;
  };
  let currentTheme = getTheme();
  emitThemeChange(currentTheme);
  window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change", (event) => themeChangeHandler(event.matches ? "dark" : "light"));
  new MutationObserver(() => themeChangeHandler(getTheme())).observe(document.body, {
    attributes: true,
    attributeFilter: ["class"]
  });
}
function appGlobalScript() {
  const isBrowser = typeof window !== "undefined" && typeof location !== "undefined" && typeof document !== "undefined" && window.location === location && window.document === document;
  if (isBrowser) {
    if (document.readyState === "interactive") {
      initThemeChangeEvent();
    } else {
      document.addEventListener("DOMContentLoaded", () => initThemeChangeEvent(), { once: true });
    }
  }
}
const globalScripts = appGlobalScript;
globalScripts();
let e$1k;
function r$1h() {
  setAssetPath(Q$h(a$28(e$1k)));
}
e$1k = "components/assets";
const t$1t = Symbol("widget"), r$1g = [], n$1Y = {}, o$1r = new WeakMap();
function i$25(e2, t2) {
  let o2 = t2.children;
  if (o2 && o2.length)
    for (let r2 = 0; r2 < o2.length; ++r2)
      o2[r2] = i$25(e2, o2[r2]);
  else
    o2 = r$1g;
  const l2 = t2.vnodeSelector;
  if (a$1Z(l2)) {
    const r2 = t2.properties || n$1Y, i2 = r2.key || l2;
    return { vnodeSelector: "div", properties: { key: i2, afterCreate: d$1c, afterUpdate: c$27, afterRemoved: s$1y, parentWidget: e2, widgetConstructor: l2, widgetProperties: __spreadProps(__spreadValues({}, r2), { key: i2, children: o2 }) }, children: void 0, text: void 0, domNode: null };
  }
  return t2;
}
function d$1c(t2, r2, n2, { parentWidget: i2, widgetConstructor: d2, widgetProperties: c2 }) {
  var _a2;
  const a2 = new d2(c2);
  a2.container = t2, o$1r.set(t2, a2), (_a2 = a2.afterCreate) == null ? void 0 : _a2.call(a2, a2, t2), i2._internalHandles.add(n$2U(() => s$1y(t2)));
}
function c$27(e2, t2, r2, { widgetProperties: n2 }) {
  var _a2;
  const i2 = o$1r.get(e2);
  i2 && (i2.set(n2), (_a2 = i2.afterUpdate) == null ? void 0 : _a2.call(i2, i2, e2));
}
function s$1y(e2) {
  const t2 = o$1r.get(e2);
  t2 && (t2.destroy(), o$1r.delete(e2));
}
function a$1Z(e2) {
  return typeof e2 == "function" && e2[t$1t];
}
const e$1j = new Set();
function n$1X(n2) {
  e$1j.add(n2), n2.finally(() => e$1j.delete(n2));
}
const U$p = "esri.widgets.Widget";
let $$e = 0;
const x$I = { widgetIcon: "esri-icon-checkbox-unchecked" };
function z$y(e2, t2) {
  for (const r2 in t2)
    e2[r2] != null && (typeof e2[r2] == "object" && typeof t2[r2] == "object" ? z$y(e2[r2], t2 == null ? void 0 : t2[r2]) : e2[r2] = t2[r2]);
  return e2;
}
const A$n = s$1z({ postProcessProjectionOptions(e2) {
  const t2 = e2.eventHandlerInterceptor, r2 = /capture$/i;
  e2.eventHandlerInterceptor = (e3, o2, s2, i2) => {
    const n2 = t2 == null ? void 0 : t2(e3, o2, s2, i2), a2 = r2.test(e3);
    if (!((e3 = e3.replace(r2, "")).toLowerCase() in s2) || a2) {
      const t3 = e3[2].toLowerCase() + e3.slice(3), r3 = (e4) => n2 == null ? void 0 : n2.call(s2, e4);
      s2.addEventListener(t3, r3, a2);
      const o3 = () => s2.removeEventListener(t3, r3, a2), c2 = i2.afterRemoved;
      i2.afterRemoved = (e4) => {
        c2 == null ? void 0 : c2(e4), o3();
      };
    }
    return n2;
  };
}, handleInterceptedEvent(e2, t2, r2, o2) {
  const { eventPhase: s2, type: i2 } = o2, n2 = s2 === Event.CAPTURING_PHASE;
  let a2 = `on${i2}${n2 ? "capture" : ""}`;
  const c2 = t2.properties;
  (c2 && a2 in c2 || (a2 = `on${i2[0].toUpperCase()}${i2.slice(1)}${n2 ? "Capture" : ""}`, c2 && a2 in c2)) && (t$1x(), e2.scheduleRender(), c2[a2].call(c2.bind || r2, o2));
} });
let B$m = false, D$n = class extends m$1Y(n$2G.EventedAccessor) {
  constructor(e2, t2) {
    super(e2, t2), this._attached = false, this._internalHandles = new t$2g(), this._projector = A$n, this._readyForTrueRender = false, this.iconClass = x$I.widgetIcon, this.key = this, this._loadLocale = x$14(async () => {
      if (this._messageBundleProps && this._messageBundleProps.length) {
        const e3 = await E$Q(this._messageBundleProps.map(async ({ bundlePath: e4, propertyName: t3 }) => {
          let r3 = await u$1u(e4);
          this.uiStrings && Object.keys(this.uiStrings) && (r3 = z$y(y$1L(r3), this.uiStrings)), this[t3] = r3;
        }));
        for (const t3 of e3)
          t3.error && s$2z.getLogger(this.declaredClass).error("widget-intl:locale-error", this.declaredClass, t3.error);
      }
      await this.loadLocale();
    }), r$1h();
    const r2 = "esri-widget-uid-" + n$1_(), o2 = this.render.bind(this);
    this._trackingTarget = new s$2m(() => this.scheduleRender());
    const s2 = () => {
      var _a2;
      if (!this._readyForTrueRender || this.destroyed)
        return null;
      if (!this.visible)
        return { vnodeSelector: "div", properties: { key: r2, class: "", styles: { display: "none" } }, domNode: null, children: void 0, text: void 0 };
      const e3 = o2();
      let { properties: t3 } = e3;
      t3 || (e3.properties = t3 = {});
      let { key: s3, styles: i2 } = t3;
      s3 || (t3.key = r2), i2 || (t3.styles = i2 = {}), i2.display || (i2.display = "");
      let n2 = 0;
      return (_a2 = e3.children) == null ? void 0 : _a2.forEach((e4) => {
        if (a$1Z(e4.vnodeSelector))
          return;
        let { properties: t4 } = e4;
        t4 || (e4.properties = t4 = {}), t4.key || (t4.key = `${this.id}--${n2++}`);
      }), i$25(this, e3);
    };
    this.render = () => {
      var _a2;
      if (B$m)
        return s2();
      let e3 = (_a2 = e$1o(this)) != null ? _a2 : null;
      if (e3)
        return e3;
      this._trackingTarget.clear(), B$m = true;
      try {
        e3 = f$1Z(this._trackingTarget, s2);
      } catch (t3) {
        throw console.error(t3), t3;
      } finally {
        B$m = false;
      }
      return e3 && c$2b(this, e3), e3;
    }, this.addResolvingPromise(this._resourcesFetch = this.beforeFirstRender().then(() => {
      this._readyForTrueRender = true, this._postInitialize();
    })), n$1X(this._resourcesFetch);
  }
  normalizeCtorArgs(e2, t2) {
    const r2 = __spreadValues({}, e2);
    return t2 && (r2.container = t2), r2;
  }
  postInitialize() {
  }
  beforeFirstRender() {
    return Promise.all([this.loadDependencies(), this._loadLocale()]).then(() => {
    }).catch(b$19);
  }
  async loadDependencies() {
  }
  async loadLocale() {
  }
  destroy() {
    this.destroyed || (s$2D(this._trackingTarget), s$2D(this.viewModel), this._detach(this.container), this._set("container", null), this._internalHandles.destroy(), this._emitter.clear(), this.render = () => null, this._projector = null, o$1w(this));
  }
  set container(e2) {
    this._get("container") || this._set("container", e2);
  }
  castContainer(e2) {
    return e$1p(e2);
  }
  get domNode() {
    return this.container;
  }
  set domNode(e2) {
    this.container = e2;
  }
  get id() {
    return this._get("id") || this.get("container.id") || Date.now().toString(16) + "-widget-" + $$e++;
  }
  set id(e2) {
    e2 && this._set("id", e2);
  }
  get label() {
    return this.declaredClass.split(".").pop();
  }
  set label(e2) {
    this._overrideIfSome("label", e2);
  }
  get renderable() {
    return this._resourcesFetch;
  }
  get visible() {
    return this._get("visible");
  }
  set visible(e2) {
    this._set("visible", e2);
  }
  get test() {
    return { projector: this._projector };
  }
  render() {
    throw new Error("not implemented");
  }
  scheduleRender() {
    this.destroyed || (o$1w(this), this._projector.scheduleRender());
  }
  classes(...e2) {
    return p$2t.apply(this, e2);
  }
  renderNow() {
    o$1w(this), this._projector.renderNow();
  }
  _postInitialize() {
    var _a2;
    if (this.destroyed)
      return;
    this.scheduleRender(), ((_a2 = this._delegatedEventNames) == null ? void 0 : _a2.length) && this._internalHandles.add(l$1P(() => this.viewModel, (e3, t2) => {
      t2 && this._internalHandles.remove("delegated-events"), e3 && e$1$(e3) && this._internalHandles.add(this._delegatedEventNames.map((t3) => r$1R(e3, t3, (e4) => {
        this.emit(t3, e4);
      })), "delegated-events");
    }, h$1j)), this.postInitialize();
    const e2 = async () => {
      await this._loadLocale().catch(b$19), this.scheduleRender();
    };
    this._internalHandles.add([s$25(e2), l$1P(() => this.uiStrings, e2), f$1o(() => this.container, (e3) => {
      this.destroyed || this._attach(e3);
    }, { initial: true, once: true })]);
  }
  _attach(e2) {
    e2 && (this._projector.merge(e2, this.render), this._attached = true);
  }
  _detach(e2) {
    var _a2;
    this._attached && (this._projector.detach(this.render), this._attached = false), (_a2 = e2 == null ? void 0 : e2.parentNode) == null ? void 0 : _a2.removeChild(e2);
  }
};
D$n[t$1t] = true, e$2g([y$1I()], D$n.prototype, "_readyForTrueRender", void 0), e$2g([y$1I({ value: null })], D$n.prototype, "container", null), e$2g([s$2i("container")], D$n.prototype, "castContainer", null), e$2g([y$1I()], D$n.prototype, "domNode", null), e$2g([y$1I()], D$n.prototype, "iconClass", void 0), e$2g([y$1I()], D$n.prototype, "id", null), e$2g([y$1I()], D$n.prototype, "label", null), e$2g([y$1I()], D$n.prototype, "renderable", null), e$2g([y$1I()], D$n.prototype, "uiStrings", void 0), e$2g([y$1I()], D$n.prototype, "viewModel", void 0), e$2g([y$1I({ value: true })], D$n.prototype, "visible", null), e$2g([y$1I()], D$n.prototype, "key", void 0), e$2g([y$1I()], D$n.prototype, "children", void 0), e$2g([y$1I()], D$n.prototype, "afterCreate", void 0), e$2g([y$1I()], D$n.prototype, "afterUpdate", void 0), e$2g([y$1I()], D$n.prototype, "afterRemoved", void 0), D$n = e$2g([n$2P(U$p)], D$n);
const M$u = D$n;
function n$1W(n2) {
  return 32 + n2.length;
}
function r$1f(n2) {
  return 16;
}
function t$1s(t2) {
  if (!t2)
    return 0;
  let e2 = f$1e;
  for (const o2 in t2)
    if (t2.hasOwnProperty(o2)) {
      const u2 = t2[o2];
      switch (typeof u2) {
        case "string":
          e2 += n$1W(u2);
          break;
        case "number":
          e2 += r$1f();
          break;
        case "boolean":
          e2 += 4;
      }
    }
  return e2;
}
function e$1i(n2) {
  if (!n2)
    return 0;
  if (Array.isArray(n2))
    return o$1q(n2);
  let r2 = f$1e;
  for (const t2 in n2)
    n2.hasOwnProperty(t2) && (r2 += u$1l(n2[t2]));
  return r2;
}
function o$1q(n2) {
  const r2 = n2.length;
  if (r2 === 0 || typeof n2[0] == "number")
    return 32 + 8 * r2;
  let t2 = i$24;
  for (let e2 = 0; e2 < r2; e2++)
    t2 += u$1l(n2[e2]);
  return t2;
}
function u$1l(t2) {
  switch (typeof t2) {
    case "object":
      return e$1i(t2);
    case "string":
      return n$1W(t2);
    case "number":
      return r$1f();
    case "boolean":
      return 4;
    default:
      return 8;
  }
}
function c$26(n2, r2) {
  return i$24 + n2.length * r2;
}
const f$1e = 32, i$24 = 32;
var s$1x;
!function(n2) {
  n2[n2.KILOBYTES = 1024] = "KILOBYTES", n2[n2.MEGABYTES = 1048576] = "MEGABYTES", n2[n2.GIGABYTES = 1073741824] = "GIGABYTES";
}(s$1x || (s$1x = {}));
function l$1G(t2, n2, r2) {
  return t2.units[n2][r2];
}
function g$U(t2, n2, r2, i2 = 2, e2 = "abbr") {
  return `${m$2f(n2, { minimumFractionDigits: i2, maximumFractionDigits: i2, signDisplay: n2 > 0 ? "never" : "exceptZero" })} ${l$1G(t2, r2, e2)}`;
}
function p$2q(t2, n2, r2, i2 = 2, e2 = "abbr") {
  return `${m$2f(n2, { minimumFractionDigits: i2, maximumFractionDigits: i2, signDisplay: "exceptZero" })} ${l$1G(t2, r2, e2)}`;
}
function D$m(t2, n2, r2, i2 = 2, e2 = "abbr") {
  const s2 = O$u(n2, r2);
  return g$U(t2, E$E(n2, r2, s2), s2, i2, e2);
}
function x$H(t2, n2, r2, i2 = 2, e2 = "abbr") {
  const s2 = O$u(n2, r2);
  return p$2q(t2, E$E(n2, r2, s2), s2, i2, e2);
}
function y$13(t2, n2, r2, i2 = 2, e2 = "abbr") {
  const o2 = J$m(n2, r2);
  return g$U(t2, E$E(n2, r2, o2), o2, i2, e2);
}
function F$r(t2, n2, r2, i2 = 2, e2 = "abbr") {
  const o2 = J$m(n2, r2);
  return p$2q(t2, E$E(n2, r2, o2), o2, i2, e2);
}
function h$1a(t2, n2, r2, i2 = 2, e2 = "abbr") {
  const o2 = K$e(n2, r2);
  return g$U(t2, E$E(n2, r2, o2), o2, i2, e2);
}
function d$1b(t2, n2, r2, i2 = 2, e2 = "abbr") {
  const o2 = K$e(n2, r2);
  return p$2q(t2, E$E(n2, r2, o2), o2, i2, e2);
}
function j$D(t2, n2, r2, i2 = 2, e2 = "abbr") {
  const o2 = R$t(n2, r2);
  return g$U(t2, E$E(n2, r2, o2), o2, i2, e2);
}
function B$l(t2, n2, r2, i2 = 2, e2 = "abbr") {
  const o2 = R$t(n2, r2);
  return p$2q(t2, E$E(n2, r2, o2), o2, i2, e2);
}
function M$t(t2, n2, r2, i2 = 2, e2 = "abbr") {
  const o2 = A$r(n2, r2);
  return g$U(t2, E$E(n2, r2, o2), o2, i2, e2);
}
function $$d(t2, n2, r2, i2 = 2, e2 = "abbr") {
  const o2 = T$w(n2, r2);
  return g$U(t2, E$E(n2, r2, o2), o2, i2, e2);
}
function w$J(t2, r2, e2, o2, s2) {
  s2 = i$3f(s2, 2);
  let c2 = s$1N.normalize(I$x(E$E(t2, r2, "degrees"), e2, o2), 0, true);
  const a2 = { style: "unit", unitDisplay: "narrow", unit: "degree", maximumFractionDigits: s2, minimumFractionDigits: s2, signDisplay: c2 > 0 ? "never" : "exceptZero" };
  return c2 = E$A(c2, a2), m$2f(c2, a2);
}
function Z$c(t2, n2, r2, e2, o2) {
  r2 !== e2 && (t2 = -t2);
  const s2 = { style: "unit", unitDisplay: "narrow", unit: "degree", maximumFractionDigits: o2 = i$3f(o2, 2), minimumFractionDigits: o2, signDisplay: "exceptZero" };
  let c2 = E$E(t2, n2, "degrees") % 360;
  return c2 = E$A(c2, s2), m$2f(c2, s2);
}
const z$x = new Map();
function E$A(t2, n2) {
  const r2 = JSON.stringify(n2);
  let i2 = z$x.get(r2);
  return i2 || (i2 = new Intl.NumberFormat("en-US", n2), z$x.set(r2, i2)), /\-?\+?360/.test(i2.format(t2)) ? 0 : t2;
}
function I$x(t2, n2, r2) {
  if (n2 === r2)
    return t2;
  switch (r2) {
    case "arithmetic":
      return O$q(t2);
    case "geographic":
      return T$t(t2);
  }
}
function O$q(t2) {
  return 90 - t2;
}
function T$t(t2) {
  return -t2 - 90;
}
const U$o = ["B", "kB", "MB", "GB", "TB"];
function v$R(n2, i2) {
  let o2 = i2 === 0 ? 0 : Math.floor(Math.log(i2) / Math.log(s$1x.KILOBYTES));
  o2 = a$2v(o2, 0, U$o.length - 1);
  const u2 = m$2f(i2 / s$1x.KILOBYTES ** o2, { maximumFractionDigits: 2 });
  return n$2W(n2.units.bytes[U$o[o2]], { fileSize: u2 });
}
function n$1V(n2) {
  const { exifInfo: e2, exifName: a2, tagName: u2 } = n2;
  if (!e2 || !a2 || !u2)
    return null;
  const f2 = e2.find((n3) => n3.name === a2);
  return f2 ? t$1r({ tagName: u2, tags: f2.tags }) : null;
}
function t$1r(n2) {
  const { tagName: t2, tags: e2 } = n2;
  if (!e2 || !t2)
    return null;
  const a2 = e2.find((n3) => n3.name === t2);
  return a2 && a2.value || null;
}
var s$1w;
const p$2p = { 1: { id: 1, rotation: 0, mirrored: false }, 2: { id: 2, rotation: 0, mirrored: true }, 3: { id: 3, rotation: 180, mirrored: false }, 4: { id: 4, rotation: 180, mirrored: true }, 5: { id: 5, rotation: -90, mirrored: true }, 6: { id: 6, rotation: 90, mirrored: false }, 7: { id: 7, rotation: 90, mirrored: true }, 8: { id: 8, rotation: -90, mirrored: false } };
let l$1F = s$1w = class extends l$2B {
  constructor(t2) {
    super(t2), this.contentType = null, this.exifInfo = null, this.id = null, this.globalId = null, this.keywords = null, this.name = null, this.parentGlobalId = null, this.parentObjectId = null, this.size = null, this.url = null;
  }
  get orientationInfo() {
    const { exifInfo: t2 } = this, o2 = n$1V({ exifName: "Exif IFD0", tagName: "Orientation", exifInfo: t2 });
    return p$2p[o2] || null;
  }
  clone() {
    return new s$1w({ contentType: this.contentType, exifInfo: this.exifInfo, id: this.id, globalId: this.globalId, keywords: this.keywords, name: this.name, parentGlobalId: this.parentGlobalId, parentObjectId: this.parentObjectId, size: this.size, url: this.url });
  }
};
e$2g([y$1I({ type: String })], l$1F.prototype, "contentType", void 0), e$2g([y$1I()], l$1F.prototype, "exifInfo", void 0), e$2g([y$1I({ readOnly: true })], l$1F.prototype, "orientationInfo", null), e$2g([y$1I({ type: T$G })], l$1F.prototype, "id", void 0), e$2g([y$1I({ type: String })], l$1F.prototype, "globalId", void 0), e$2g([y$1I({ type: String })], l$1F.prototype, "keywords", void 0), e$2g([y$1I({ type: String })], l$1F.prototype, "name", void 0), e$2g([y$1I({ json: { read: false } })], l$1F.prototype, "parentGlobalId", void 0), e$2g([y$1I({ json: { read: false } })], l$1F.prototype, "parentObjectId", void 0), e$2g([y$1I({ type: T$G })], l$1F.prototype, "size", void 0), e$2g([y$1I({ json: { read: false } })], l$1F.prototype, "url", void 0), l$1F = s$1w = e$2g([n$2P("esri.layers.support.AttachmentInfo")], l$1F);
const a$1Y = l$1F;
var a$1X;
let p$2o = a$1X = class extends l$2B {
  constructor(t2) {
    super(t2), this.attachmentTypes = null, this.attachmentsWhere = null, this.cacheHint = void 0, this.keywords = null, this.globalIds = null, this.name = null, this.num = null, this.objectIds = null, this.returnMetadata = false, this.size = null, this.start = null, this.where = null;
  }
  writeStart(t2, e2) {
    e2.resultOffset = this.start, e2.resultRecordCount = this.num || 10;
  }
  clone() {
    return new a$1X(y$1L({ attachmentTypes: this.attachmentTypes, attachmentsWhere: this.attachmentsWhere, cacheHint: this.cacheHint, keywords: this.keywords, where: this.where, globalIds: this.globalIds, name: this.name, num: this.num, objectIds: this.objectIds, returnMetadata: this.returnMetadata, size: this.size, start: this.start }));
  }
};
e$2g([y$1I({ type: [String], json: { write: true } })], p$2o.prototype, "attachmentTypes", void 0), e$2g([y$1I({ type: String, json: { read: { source: "attachmentsDefinitionExpression" }, write: { target: "attachmentsDefinitionExpression" } } })], p$2o.prototype, "attachmentsWhere", void 0), e$2g([y$1I({ type: Boolean, json: { write: true } })], p$2o.prototype, "cacheHint", void 0), e$2g([y$1I({ type: [String], json: { write: true } })], p$2o.prototype, "keywords", void 0), e$2g([y$1I({ type: [Number], json: { write: true } })], p$2o.prototype, "globalIds", void 0), e$2g([y$1I({ json: { write: true } })], p$2o.prototype, "name", void 0), e$2g([y$1I({ type: Number, json: { read: { source: "resultRecordCount" } } })], p$2o.prototype, "num", void 0), e$2g([y$1I({ type: [Number], json: { write: true } })], p$2o.prototype, "objectIds", void 0), e$2g([y$1I({ type: Boolean, json: { default: false, write: true } })], p$2o.prototype, "returnMetadata", void 0), e$2g([y$1I({ type: [Number], json: { write: true } })], p$2o.prototype, "size", void 0), e$2g([y$1I({ type: Number, json: { read: { source: "resultOffset" } } })], p$2o.prototype, "start", void 0), e$2g([r$1P("start"), r$1P("num")], p$2o.prototype, "writeStart", null), e$2g([y$1I({ type: String, json: { read: { source: "definitionExpression" }, write: { target: "definitionExpression" } } })], p$2o.prototype, "where", void 0), p$2o = a$1X = e$2g([n$2P("esri.rest.support.AttachmentQuery")], p$2o), p$2o.from = b$1a(p$2o);
const c$25 = p$2o;
const d$1a = "esri.widgets.Feature.support.featureUtils", p$2n = s$2z.getLogger(d$1a), m$1D = /href=(""|'')/gi, y$12 = /(\{([^\{\r\n]+)\})/g, g$T = /\'/g, h$19 = /^\s*expression\//i, I$w = /(\n)/gi, b$O = /[\u00A0-\u9999<>\&]/gim, F$q = /href\s*=\s*(?:\"([^\"]+)\"|\'([^\']+)\')/gi, w$I = /^(?:mailto:|tel:)/, N$l = "relationships/", E$z = S$P("short-date-short-time");
function T$s(e2) {
  if (!t$2r(e2))
    return e2.get("sourceLayer") || e2.get("layer");
}
async function j$C(e2, t2) {
  return typeof e2 == "function" ? e2.call(null, t2) : e2;
}
function x$G(e2 = "") {
  if (e2)
    return !w$I.test(e2.trim().toLowerCase());
}
function C$u(e2) {
  return !!e2 && h$19.test(e2);
}
function M$s(e2, t2) {
  if (!C$u(t2) || !e2)
    return null;
  const r2 = t2.replace(h$19, "").toLowerCase();
  let n2;
  return e2.some((e3) => e3.name.toLowerCase() === r2 && (n2 = e3, true)), n2;
}
function q$j(e2, t2) {
  const r2 = M$s(t2, e2 == null ? void 0 : e2.fieldName);
  return r2 ? r2.title || null : e2 ? e2.label || e2.fieldName : null;
}
function R$r(e2, t2) {
  const r2 = t2.get(e2.toLowerCase());
  return `{${r2 && r2.fieldName || e2}}`;
}
function v$Q(e2) {
  return e2.replace(m$1D, "");
}
function D$l(e2, t2) {
  const r2 = A$m(t2, e2);
  return r2 ? r2.name : e2;
}
function L$n(e2, t2) {
  return e2 && e2.map((e3) => D$l(e3, t2));
}
function A$m(e2, t2) {
  return e2 && typeof e2.getField == "function" ? e2.getField(t2) : null;
}
function U$n(e2) {
  return `${e2}`.trim();
}
function $$c({ attributes: e2, globalAttributes: t2, layer: r2, text: n2, expressionAttributes: i2, fieldInfoMap: o2 }) {
  return n2 ? S$A({ formattedAttributes: t2, template: _$y(n2, __spreadValues(__spreadValues(__spreadValues({}, t2), i2), e2), r2), fieldInfoMap: o2 }) : "";
}
function S$A({ formattedAttributes: e2, template: t2, fieldInfoMap: r2 }) {
  return U$n(v$Q(n$2W(n$2W(t2, (e3) => R$r(e3, r2)), e2)));
}
function G$k(e2, t2, r2 = false) {
  const n2 = t2[e2];
  if (typeof n2 == "string") {
    const i2 = "%27", o2 = (r2 ? encodeURIComponent(n2) : n2).replace(g$T, i2);
    t2[e2] = o2;
  }
}
function k$p(e2, t2 = false) {
  const r2 = __spreadValues({}, e2);
  return Object.keys(r2).forEach((e3) => G$k(e3, r2, t2)), r2;
}
function O$p(e2, t2, r2) {
  const i2 = (t2 = U$n(t2)) && t2[0] !== "{";
  return n$2W(e2, k$p(r2, i2));
}
function P$q(e2, t2) {
  return e2.replace(y$12, (e3, r2, n2) => {
    const i2 = A$m(t2, n2);
    return i2 ? `{${i2.name}}` : r2;
  });
}
function _$y(e2, t2, r2) {
  const n2 = P$q(e2, r2);
  return n2 ? n2.replace(F$q, (e3, r3, n3) => O$p(e3, r3 || n3, t2)) : n2;
}
function z$w(e2, t2) {
  if (typeof e2 == "string" && t2 && t2.dateFormat == null && (t2.places != null || t2.digitSeparator != null)) {
    const t3 = Number(e2);
    if (!isNaN(t3))
      return t3;
  }
  return e2;
}
function H$f(e2) {
  return (e2 == null ? void 0 : e2.type) === "feature";
}
function Q$c(e2) {
  return !!(e2 == null ? void 0 : e2.layer);
}
function Z$b(e2) {
  return (e2 == null ? void 0 : e2.type) === "map-image";
}
function V$j(e2, t2) {
  var _a2;
  const r2 = t2.fieldInfos, n2 = t2.fieldName, i2 = (_a2 = B$k(r2, n2)) == null ? void 0 : _a2.clone(), o2 = t2.preventPlacesFormatting, s2 = t2.layer, c2 = A$m(s2, n2);
  if (i2 && (c2 == null ? void 0 : c2.type) === "date") {
    const e3 = i2.format || new u$1W();
    e3.dateFormat = e3.dateFormat || "short-date-short-time", e3.dateTimeFormatOptions = !Q$c(s2) && H$f(s2) && s2.datesInUnknownTimezone || Q$c(s2) && Z$b(s2.layer) && s2.layer.datesInUnknownTimezone ? { timeZone: "UTC" } : null, i2.format = e3;
  }
  const d2 = i2 && i2.format;
  return typeof e2 == "string" && he$2(n2) && d2 ? d2.formatRasterPixelValue(e2) : typeof (e2 = z$w(e2, d2)) == "string" || e2 == null || d2 == null ? te$3(e2) : o2 ? m$2f(e2, __spreadProps(__spreadValues({}, u$1X(d2)), { minimumFractionDigits: 0, maximumFractionDigits: 20 })) : d2.format(e2);
}
function B$k(e2, t2) {
  if (!e2 || !e2.length || !t2)
    return;
  const r2 = t2.toLowerCase();
  let n2;
  return e2.some((e3) => !(!e3.fieldName || e3.fieldName.toLowerCase() !== r2) && (n2 = e3, true)), n2;
}
function J$j({ fieldName: e2, graphic: t2, layer: r2 }) {
  if (le$2(e2))
    return null;
  if (!r2 || typeof r2.getFeatureType != "function")
    return null;
  const { typeIdField: n2 } = r2;
  if (!n2 || e2 !== n2)
    return null;
  const i2 = r2.getFeatureType(t2);
  return i2 ? i2.name : null;
}
function K$d({ fieldName: e2, value: t2, graphic: r2, layer: n2 }) {
  if (le$2(e2))
    return null;
  if (!n2 || typeof n2.getFieldDomain != "function")
    return null;
  const i2 = n2.getFieldDomain(e2, { feature: r2 });
  return i2 && i2.type === "coded-value" ? i2.getName(t2) : null;
}
function W$c(e2, t2) {
  const { creatorField: r2, creationDateField: n2, editorField: o2, editDateField: a2 } = e2;
  if (!t2)
    return;
  const l2 = t2[a2];
  if (typeof l2 == "number") {
    const e3 = t2[o2];
    return { type: "edit", date: L$x(l2, E$z), user: e3 };
  }
  const u2 = t2[n2];
  if (typeof u2 == "number") {
    const e3 = t2[r2];
    return { type: "create", date: L$x(u2, E$z), user: e3 };
  }
  return null;
}
function X$a(e2, t2) {
  const r2 = new Map();
  return e2 && e2.forEach((e3) => {
    const n2 = D$l(e3.fieldName, t2);
    e3.fieldName = n2, r2.set(n2.toLowerCase(), e3);
  }), r2;
}
function Y$9(e2) {
  const t2 = [];
  if (!e2)
    return t2;
  const { fieldInfos: r2, content: n2 } = e2;
  return r2 && t2.push(...r2), n2 && Array.isArray(n2) ? (n2.forEach((e3) => {
    if (e3.type === "fields") {
      const r3 = e3 && e3.fieldInfos;
      r3 && t2.push(...r3);
    }
  }), t2) : t2;
}
function ee$3(e2) {
  return e2.replace(b$O, (e3) => `&#${e3.charCodeAt(0)};`);
}
function te$3(e2) {
  return typeof e2 == "string" ? e2.replace(I$w, '<br class="esri-text-new-line" />') : e2;
}
function re$3(e2) {
  const { value: t2, fieldName: r2, fieldInfos: n2, fieldInfoMap: o2, layer: a2, graphic: l2 } = e2;
  if (t2 == null)
    return "";
  const u2 = K$d({ fieldName: r2, value: t2, graphic: l2, layer: a2 });
  if (u2)
    return u2;
  const s2 = J$j({ fieldName: r2, graphic: l2, layer: a2 });
  if (s2)
    return s2;
  if (o2.get(r2.toLowerCase()))
    return V$j(t2, { fieldInfos: n2 || Array.from(o2.values()), fieldName: r2, layer: a2 });
  const f2 = a2 && a2.fieldsIndex;
  return f2 && f2.isDateField(r2) ? L$x(t2, E$z) : te$3(t2);
}
function ne$2({ fieldInfos: e2, attributes: t2, layer: r2, graphic: n2, fieldInfoMap: i2, relatedInfos: o2 }) {
  const a2 = {};
  return o2 == null ? void 0 : o2.forEach((t3) => fe$1({ attributes: a2, relatedInfo: t3, fieldInfoMap: i2, fieldInfos: e2, layer: r2 })), Object.keys(t2).forEach((o3) => {
    const l2 = t2[o3];
    a2[o3] = re$3({ fieldName: o3, fieldInfos: e2, fieldInfoMap: i2, layer: r2, value: l2, graphic: n2 });
  }), a2;
}
async function ie$3(e2, t2) {
  var _a2, _b2;
  const { layer: r2, graphic: n2, outFields: i2, objectIds: o2, returnGeometry: a2, spatialReference: l2 } = e2, u2 = o2[0];
  if (typeof u2 != "number" && typeof u2 != "string") {
    const e3 = "Could not query required fields for the specified feature. The feature's ID is invalid.", t3 = { layer: r2, graphic: n2, objectId: u2, requiredFields: i2 };
    return p$2n.warn(e3, t3), null;
  }
  if (!((_b2 = (_a2 = r2.capabilities) == null ? void 0 : _a2.operations) == null ? void 0 : _b2.supportsQuery)) {
    const e3 = "The specified layer cannot be queried. The following fields will not be available.", t3 = { layer: r2, graphic: n2, requiredFields: i2, returnGeometry: a2 };
    return p$2n.warn(e3, t3), null;
  }
  const s2 = r2.createQuery();
  s2.objectIds = o2, s2.outFields = (i2 == null ? void 0 : i2.length) ? i2 : [r2.objectIdField], s2.returnGeometry = !!a2, s2.returnZ = !!a2, s2.returnM = !!a2, s2.outSpatialReference = l2;
  return (await r2.queryFeatures(s2, t2)).features[0];
}
async function oe$3(e2) {
  var _a2;
  if (!((_a2 = e2.expressionInfos) == null ? void 0 : _a2.length))
    return false;
  const t2 = await i$2P(), { arcadeUtils: { hasGeometryFunctions: r2 } } = t2;
  return r2(e2);
}
async function ae$2({ graphic: e2, popupTemplate: t2, layer: r2, spatialReference: n2 }, i2) {
  if (!r2 || !t2)
    return;
  if (typeof r2.load == "function" && await r2.load(i2), !e2.attributes)
    return;
  const o2 = e2.attributes[r2.objectIdField];
  if (o2 == null)
    return;
  const a2 = [o2], l2 = await t2.getRequiredFields(r2.fieldsIndex), u2 = xe$1(l2, e2), f2 = u2 ? [] : l2, c2 = t2.returnGeometry || await oe$3(t2);
  if (u2 && !c2)
    return;
  const d2 = await ie$3({ layer: r2, graphic: e2, outFields: f2, objectIds: a2, returnGeometry: c2, spatialReference: n2 }, i2);
  d2 && (d2.geometry && (e2.geometry = d2.geometry), d2.attributes && (e2.attributes = __spreadValues(__spreadValues({}, e2.attributes), d2.attributes)));
}
function le$2(e2 = "") {
  return !!e2 && e2.includes(N$l);
}
function ue$2(e2) {
  return e2 ? `${N$l}${e2.layerId}/${e2.fieldName}` : "";
}
function se$1({ attributes: e2, graphic: t2, relatedInfo: r2, fieldInfos: n2, fieldInfoMap: i2, layer: o2 }) {
  e2 && t2 && r2 && Object.keys(t2.attributes).forEach((a2) => {
    const l2 = ue$2({ layerId: r2.relation.id.toString(), fieldName: a2 }), u2 = t2.attributes[a2];
    e2[l2] = re$3({ fieldName: l2, fieldInfos: n2, fieldInfoMap: i2, layer: o2, value: u2, graphic: t2 });
  });
}
function fe$1({ attributes: e2, relatedInfo: t2, fieldInfoMap: r2, fieldInfos: n2, layer: i2 }) {
  e2 && t2 && (t2.relatedFeatures && t2.relatedFeatures && t2.relatedFeatures.forEach((o2) => se$1({ attributes: e2, graphic: o2, relatedInfo: t2, fieldInfoMap: r2, fieldInfos: n2, layer: i2 })), t2.relatedStatsFeatures && t2.relatedStatsFeatures && t2.relatedStatsFeatures.forEach((o2) => se$1({ attributes: e2, graphic: o2, relatedInfo: t2, fieldInfoMap: r2, fieldInfos: n2, layer: i2 })));
}
const ce$2 = (e2) => {
  if (!e2)
    return false;
  const t2 = e2.toUpperCase();
  return t2.includes("CURRENT_TIMESTAMP") || t2.includes("CURRENT_DATE") || t2.includes("CURRENT_TIME");
}, de$1 = ({ layer: e2, method: t2, query: n2, definitionExpression: i2 }) => {
  var _a2, _b2;
  if (!((_b2 = (_a2 = e2.capabilities) == null ? void 0 : _a2.query) == null ? void 0 : _b2.supportsCacheHint) || t2 === "attachments")
    return;
  const o2 = r$1$(n2.where) && n2.where, a2 = r$1$(n2.geometry) && n2.geometry;
  ce$2(i2) || ce$2(o2) || (a2 == null ? void 0 : a2.type) === "extent" || n2.resultType === "tile" || (n2.cacheHint = true);
}, pe$1 = ({ query: e2, layer: t2, method: r2 }) => {
  de$1({ layer: t2, method: r2, query: e2, definitionExpression: `${t2.definitionExpression} ${t2.serviceDefinitionExpression}` });
}, me$1 = ({ queryPayload: e2, layer: t2, method: r2 }) => {
  de$1({ layer: t2, method: r2, query: e2, definitionExpression: `${t2.definitionExpression} ${t2.serviceDefinitionExpression}` });
};
function ye$2(e2, t2, r2) {
  return e2 && t2 && r2 ? ge$1(e2.allLayers, t2, r2) || ge$1(e2.allTables, t2, r2) : null;
}
function ge$1(e2, t2, r2) {
  return e2.find((e3) => e3 !== t2 && e3.type === "feature" && e3.url === t2.url && e3.layerId === r2.relatedTableId);
}
const f$1d = { editing: false, operations: { add: true, update: true, delete: true } }, u$1k = j$V.ofType(a$1Y);
let y$11 = class extends m$2q {
  constructor(t2) {
    super(t2), this._getAttachmentsPromise = null, this._attachmentLayer = null, this.abilities = __spreadValues({}, f$1d), this.activeAttachmentInfo = null, this.activeFileInfo = null, this.attachmentInfos = new u$1k(), this.fileInfos = new j$V(), this.graphic = null, this.mode = "view", this.filesEnabled = false, this.addHandles(l$1P(() => this.graphic, () => this._graphicChanged(), h$1j));
  }
  destroy() {
    this._attachmentLayer = null, this.graphic = null;
  }
  castAbilities(t2) {
    return __spreadValues(__spreadValues({}, f$1d), t2);
  }
  get state() {
    return this._getAttachmentsPromise ? "loading" : this.graphic ? "ready" : "disabled";
  }
  get supportsResizeAttachments() {
    const { graphic: t2 } = this;
    if (!t2)
      return false;
    const e2 = t2.layer || t2.sourceLayer;
    return (e2 == null ? void 0 : e2.loaded) && "capabilities" in e2 && "operations" in e2.capabilities && "supportsResizeAttachments" in e2.capabilities.operations && e2.capabilities.operations.supportsResizeAttachments || false;
  }
  async getAttachments() {
    const { _attachmentLayer: t2, attachmentInfos: e2 } = this;
    if (!t2 || typeof t2.queryAttachments != "function")
      throw new s$2u("invalid-layer", "getAttachments(): A valid layer is required.");
    const i2 = this._getObjectId(), a2 = new c$25({ objectIds: [i2], returnMetadata: true }), s2 = [], r2 = t2.queryAttachments(a2).then((t3) => t3[i2] || s2).catch(() => s2);
    this._getAttachmentsPromise = r2, this.notifyChange("state");
    const o2 = await r2;
    return e2.removeAll(), o2.length && e2.addMany(o2), this._getAttachmentsPromise = null, this.notifyChange("state"), o2;
  }
  async addAttachment(t2, e2 = this.graphic) {
    const { _attachmentLayer: i2, attachmentInfos: a2, abilities: s2 } = this;
    if (!e2)
      throw new s$2u("invalid-graphic", "addAttachment(): A valid graphic is required.", { graphic: e2 });
    if (!t2)
      throw new s$2u("invalid-attachment", "addAttachment(): An attachment is required.", { attachment: t2 });
    if (!s2.operations.add)
      throw new s$2u("invalid-abilities", "addAttachment(): add abilities are required.");
    if (!i2 || typeof i2.addAttachment != "function")
      throw new s$2u("invalid-layer", "addAttachment(): A valid layer is required.");
    const r2 = i2.addAttachment(e2, t2).then((t3) => this._queryAttachment(t3.objectId, e2)), o2 = await r2;
    return a2.add(o2), o2;
  }
  async deleteAttachment(t2) {
    const { _attachmentLayer: e2, attachmentInfos: i2, graphic: a2, abilities: s2 } = this;
    if (!t2)
      throw new s$2u("invalid-attachment-info", "deleteAttachment(): An attachmentInfo is required.", { attachmentInfo: t2 });
    if (!s2.operations.delete)
      throw new s$2u("invalid-abilities", "deleteAttachment(): delete abilities are required.");
    if (!e2 || typeof e2.deleteAttachments != "function")
      throw new s$2u("invalid-layer", "deleteAttachment(): A valid layer is required.");
    const r2 = e2.deleteAttachments(a2, [t2.id]).then(() => t2), o2 = await r2;
    return i2.remove(o2), o2;
  }
  async updateAttachment(t2, e2 = this.activeAttachmentInfo) {
    const { _attachmentLayer: i2, attachmentInfos: a2, graphic: s2, abilities: r2 } = this;
    if (!t2)
      throw new s$2u("invalid-attachment", "updateAttachment(): An attachment is required.", { attachment: t2 });
    if (!e2)
      throw new s$2u("invalid-attachment-info", "updateAttachment(): An attachmentInfo is required.", { attachmentInfo: e2 });
    if (!r2.operations.update)
      throw new s$2u("invalid-abilities", "updateAttachment(): Update abilities are required.");
    const o2 = a2.findIndex((t3) => t3 === e2);
    if (!i2 || typeof i2.updateAttachment != "function")
      throw new s$2u("invalid-layer", "updateAttachment(): A valid layer is required.");
    const c2 = i2.updateAttachment(s2, e2.id, t2).then((t3) => this._queryAttachment(t3.objectId)), h2 = await c2;
    return a2.splice(o2, 1, h2), h2;
  }
  async commitFiles() {
    return await Promise.all(this.fileInfos.items.map((t2) => this.addAttachment(t2.form))), this.fileInfos.removeAll(), this.getAttachments();
  }
  addFile(t2, e2) {
    if (!t2 || !e2)
      return null;
    const i2 = { file: t2, form: e2 };
    return this.fileInfos.add(i2), i2;
  }
  updateFile(t2, e2, i2 = this.activeFileInfo) {
    if (!t2 || !e2 || !i2)
      return null;
    const a2 = this.fileInfos.findIndex((t3) => i2 === t3);
    return a2 > -1 && this.fileInfos.splice(a2, 1, { file: t2, form: e2 }), this.fileInfos.items[a2];
  }
  deleteFile(t2) {
    var _a2;
    const e2 = this.fileInfos.find((e3) => e3.file === t2);
    return (_a2 = this.fileInfos.remove(e2)) != null ? _a2 : null;
  }
  async _queryAttachment(t2, e2) {
    if (!t2)
      throw new s$2u("invalid-attachment-id", "Could not query attachment.");
    const { _attachmentLayer: i2 } = this, a2 = this._getObjectId(e2), s2 = new c$25({ objectIds: [a2], attachmentsWhere: `AttachmentId=${t2}`, returnMetadata: true });
    return i2.queryAttachments(s2).then((t3) => t3[a2][0]);
  }
  _getObjectId(t2 = this.graphic) {
    var _a2;
    return (_a2 = t2 == null ? void 0 : t2.getObjectId()) != null ? _a2 : null;
  }
  _graphicChanged() {
    this.graphic && (this._setAttachmentLayer(), this.getAttachments().catch(() => {
    }));
  }
  _setAttachmentLayer() {
    const { graphic: t2 } = this, e2 = T$s(t2);
    this._attachmentLayer = e2 ? e2.type === "scene" && r$1$(e2.associatedLayer) ? e2.associatedLayer : e2 : null;
  }
};
e$2g([y$1I()], y$11.prototype, "abilities", void 0), e$2g([s$2i("abilities")], y$11.prototype, "castAbilities", null), e$2g([y$1I()], y$11.prototype, "activeAttachmentInfo", void 0), e$2g([y$1I()], y$11.prototype, "activeFileInfo", void 0), e$2g([y$1I({ readOnly: true, type: u$1k })], y$11.prototype, "attachmentInfos", void 0), e$2g([y$1I()], y$11.prototype, "fileInfos", void 0), e$2g([y$1I({ type: g$10 })], y$11.prototype, "graphic", void 0), e$2g([y$1I()], y$11.prototype, "mode", void 0), e$2g([y$1I({ readOnly: true })], y$11.prototype, "state", null), e$2g([y$1I()], y$11.prototype, "filesEnabled", void 0), e$2g([y$1I({ readOnly: true })], y$11.prototype, "supportsResizeAttachments", null), y$11 = e$2g([n$2P("esri.widgets.Attachments.AttachmentsViewModel")], y$11);
const A$l = y$11;
function e$1h(i2) {
  const e2 = i2.toLowerCase();
  return e2 === "image/bmp" || e2 === "image/emf" || e2 === "image/exif" || e2 === "image/gif" || e2 === "image/x-icon" || e2 === "image/jpeg" || e2 === "image/png" || e2 === "image/tiff" || e2 === "image/x-wmf";
}
function p$2m(e2) {
  const p2 = a$28("esri/themes/base/images/files/");
  return e2 ? e2 === "text/plain" ? `${p2}text-32.svg` : e2 === "application/pdf" ? `${p2}pdf-32.svg` : e2 === "text/csv" ? `${p2}csv-32.svg` : e2 === "application/gpx+xml" ? `${p2}gpx-32.svg` : e2 === "application/x-dwf" ? `${p2}cad-32.svg` : e2 === "application/postscript" || e2 === "application/json" || e2 === "text/xml" || e2 === "model/vrml" ? `${p2}code-32.svg` : e2 === "application/x-zip-compressed" || e2 === "application/x-7z-compressed" || e2 === "application/x-gzip" || e2 === "application/x-tar" || e2 === "application/x-gtar" || e2 === "application/x-bzip2" || e2 === "application/gzip" || e2 === "application/x-compress" || e2 === "application/x-apple-diskimage" || e2 === "application/x-rar-compressed" || e2 === "application/zip" ? `${p2}zip-32.svg` : e2.includes("image/") ? `${p2}image-32.svg` : e2.includes("audio/") ? `${p2}sound-32.svg` : e2.includes("video/") ? `${p2}video-32.svg` : e2.includes("msexcel") || e2.includes("ms-excel") || e2.includes("spreadsheetml") ? `${p2}excel-32.svg` : e2.includes("msword") || e2.includes("ms-word") || e2.includes("wordprocessingml") ? `${p2}word-32.svg` : e2.includes("powerpoint") || e2.includes("presentationml") ? `${p2}report-32.svg` : `${p2}generic-32.svg` : `${p2}generic-32.svg`;
}
function e$1g(e2) {
  return (s2, r2) => {
    s2.hasOwnProperty("_messageBundleProps") || (s2._messageBundleProps = s2._messageBundleProps ? s2._messageBundleProps.slice() : []);
    s2._messageBundleProps.push({ bundlePath: e2, propertyName: r2 });
  };
}
var e$1f = function(r2) {
  return { vnodeSelector: "", properties: void 0, children: void 0, text: r2.toString(), domNode: null };
}, o$1p = function(r2, t2) {
  for (var n2 = 0, i2 = r2.length; n2 < i2; n2++) {
    var d2 = r2[n2];
    Array.isArray(d2) ? o$1p(d2, t2) : d2 != null && d2 !== false && (d2.hasOwnProperty("vnodeSelector") || (d2 = e$1f(d2)), t2.push(d2));
  }
}, t$1q = function(r2, e2) {
  for (var t2 = [], n2 = 2; n2 < arguments.length; n2++)
    t2[n2 - 2] = arguments[n2];
  if (t2.length === 1 && typeof t2[0] == "string")
    return { vnodeSelector: r2, properties: e2 || void 0, children: void 0, text: t2[0], domNode: null };
  var i2 = [];
  return o$1p(t2, i2), { vnodeSelector: r2, properties: e2 || void 0, children: i2, text: void 0, domNode: null };
};
function n$1U(e2, o2, ...n2) {
  return typeof e2 != "function" || a$1Z(e2) ? t$1q(e2, o2, ...n2) : e2(o2, ...n2);
}
const v$P = { addButton: true, addSubmitButton: true, cancelAddButton: true, cancelUpdateButton: true, deleteButton: true, errorMessage: true, progressBar: true, updateButton: true }, y$10 = { base: "esri-attachments", loaderContainer: "esri-attachments__loader-container", loader: "esri-attachments__loader", fadeIn: "esri-attachments--fade-in", container: "esri-attachments__container", containerList: "esri-attachments__container--list", containerPreview: "esri-attachments__container--preview", actions: "esri-attachments__actions", deleteButton: "esri-attachments__delete-button", addAttachmentButton: "esri-attachments__add-attachment-button", errorMessage: "esri-attachments__error-message", items: "esri-attachments__items", item: "esri-attachments__item", itemButton: "esri-attachments__item-button", itemMask: "esri-attachments__item-mask", itemMaskIcon: "esri-attachments__item-mask--icon", itemImage: "esri-attachments__image", itemImageResizable: "esri-attachments__image--resizable", itemLabel: "esri-attachments__label", itemFilename: "esri-attachments__filename", itemChevronIcon: "esri-attachments__item-chevron-icon", itemLink: "esri-attachments__item-link", itemLinkOverlay: "esri-attachments__item-link-overlay", itemLinkOverlayIcon: "esri-attachments__item-link-overlay-icon", itemEditIcon: "esri-attachments__item-edit-icon", itemAddIcon: "esri-attachments__item-add-icon", itemAddButton: "esri-attachments__item-add-button", formNode: "esri-attachments__form-node", fileFieldset: "esri-attachments__file-fieldset", fileLabel: "esri-attachments__file-label", fileName: "esri-attachments__file-name", fileInput: "esri-attachments__file-input", metadata: "esri-attachments__metadata", metadataFieldset: "esri-attachments__metadata-fieldset", progressBar: "esri-attachments__progress-bar", esriWidget: "esri-widget", esriButton: "esri-button", buttonDisabled: "esri-button--disabled", esriButtonSecondary: "esri-button--secondary", esriButtonTertiary: "esri-button--tertiary", esriButtonThird: "esri-button--third", esriButtonSmall: "esri-button--small", esriButtonHalf: "esri-button--half", empty: "esri-widget__content--empty", iconExternalLink: "esri-icon-link-external", iconEdit: "esri-icon-edit", iconRight: "esri-icon-right", iconLeft: "esri-icon-left", iconPlus: "esri-icon-plus" }, A$k = window.CSS;
let w$H = class extends M$u {
  constructor(e2, t2) {
    super(e2, t2), this.displayType = "auto", this.messages = null, this.messagesUnits = null, this.selectedFile = null, this.submitting = false, this.viewModel = new A$l(), this.visibleElements = __spreadValues({}, v$P), this._supportsImageOrientation = A$k && A$k.supports && A$k.supports("image-orientation", "from-image"), this._addAttachmentForm = null, this._updateAttachmentForm = null;
  }
  initialize() {
    this.addHandles([a$2a(() => {
      var _a2;
      return (_a2 = this.viewModel) == null ? void 0 : _a2.attachmentInfos;
    }, "change", () => this.scheduleRender()), a$2a(() => {
      var _a2;
      return (_a2 = this.viewModel) == null ? void 0 : _a2.fileInfos;
    }, "change", () => this.scheduleRender()), l$1P(() => {
      var _a2;
      return (_a2 = this.viewModel) == null ? void 0 : _a2.mode;
    }, () => this._modeChanged(), h$1j)]);
  }
  loadDependencies() {
    return Promise.all([import("./calcite-icon.js")]);
  }
  get abilities() {
    return this.viewModel.abilities;
  }
  set abilities(e2) {
    this.viewModel.abilities = e2;
  }
  get effectiveDisplayType() {
    const { displayType: e2 } = this;
    return e2 && e2 !== "auto" ? e2 : this.viewModel.supportsResizeAttachments ? "preview" : "list";
  }
  get graphic() {
    return this.viewModel.graphic;
  }
  set graphic(e2) {
    this.viewModel.graphic = e2;
  }
  get label() {
    var _a2, _b2;
    return (_b2 = (_a2 = this.messages) == null ? void 0 : _a2.widgetLabel) != null ? _b2 : "";
  }
  set label(e2) {
    this._overrideIfSome("label", e2);
  }
  castVisibleElements(e2) {
    return __spreadValues(__spreadValues({}, v$P), e2);
  }
  addAttachment() {
    const { _addAttachmentForm: e2, viewModel: s2 } = this;
    return this._set("submitting", true), this._set("error", null), s2.addAttachment(e2).then((e3) => (this._set("submitting", false), this._set("error", null), s2.mode = "view", e3)).catch((e3) => {
      throw this._set("submitting", false), this._set("error", new s$2u("attachments:add-attachment", this.messages.addErrorMessage, e3)), e3;
    });
  }
  deleteAttachment(e2) {
    const { viewModel: s2 } = this;
    return this._set("submitting", true), this._set("error", null), s2.deleteAttachment(e2).then((e3) => (this._set("submitting", false), this._set("error", null), s2.mode = "view", e3)).catch((e3) => {
      throw this._set("submitting", false), this._set("error", new s$2u("attachments:delete-attachment", this.messages.deleteErrorMessage, e3)), e3;
    });
  }
  updateAttachment() {
    const { viewModel: e2 } = this, { _updateAttachmentForm: s2 } = this;
    return this._set("submitting", true), this._set("error", null), e2.updateAttachment(s2).then((t2) => (this._set("submitting", false), this._set("error", null), e2.mode = "view", t2)).catch((e3) => {
      throw this._set("submitting", false), this._set("error", new s$2u("attachments:update-attachment", this.messages.updateErrorMessage, e3)), e3;
    });
  }
  addFile() {
    const e2 = this.viewModel.addFile(this.selectedFile, this._addAttachmentForm);
    return this.viewModel.mode = "view", e2;
  }
  updateFile() {
    const { viewModel: e2 } = this, t2 = e2.updateFile(this.selectedFile, this._updateAttachmentForm, e2.activeFileInfo);
    return e2.mode = "view", t2;
  }
  deleteFile(e2) {
    const t2 = this.viewModel.deleteFile(e2 || this.viewModel.activeFileInfo.file);
    return this.viewModel.mode = "view", t2;
  }
  render() {
    const { submitting: e2, viewModel: t2 } = this, { state: s2 } = t2;
    return n$1U("div", { class: this.classes(y$10.base, y$10.esriWidget) }, e2 ? this.renderProgressBar() : null, s2 === "loading" ? this.renderLoading() : this.renderAttachments(), this.renderErrorMessage());
  }
  renderErrorMessage() {
    const { error: e2, visibleElements: t2 } = this;
    return e2 && t2.errorMessage ? n$1U("div", { key: "error-message", class: y$10.errorMessage }, e2.message) : null;
  }
  renderAttachments() {
    const { activeFileInfo: e2, mode: t2, activeAttachmentInfo: s2 } = this.viewModel;
    return t2 === "add" ? this.renderAddForm() : t2 === "edit" ? this.renderDetailsForm(s2 || e2) : this.renderAttachmentContainer();
  }
  renderLoading() {
    return n$1U("div", { class: y$10.loaderContainer, key: "loader" }, n$1U("div", { class: y$10.loader }));
  }
  renderProgressBar() {
    return this.visibleElements.progressBar ? n$1U("div", { class: y$10.progressBar, key: "progress-bar" }) : null;
  }
  renderAddForm() {
    const { submitting: e2, selectedFile: t2 } = this, s2 = e2 || !t2, i2 = this.visibleElements.cancelAddButton ? n$1U("button", { type: "button", bind: this, disabled: e2, onclick: this._cancelForm, class: this.classes(y$10.esriButton, y$10.esriButtonTertiary, y$10.esriButtonSmall, y$10.esriButtonHalf, e2 && y$10.buttonDisabled) }, this.messages.cancel) : null, a2 = this.visibleElements.addSubmitButton ? n$1U("button", { type: "submit", disabled: s2, class: this.classes(y$10.esriButton, y$10.esriButtonSecondary, y$10.esriButtonSmall, y$10.esriButtonHalf, { [y$10.buttonDisabled]: s2 }) }, this.messages.add) : null, n2 = t2 ? n$1U("span", { key: "file-name", class: y$10.fileName }, t2.name) : null, r2 = n$1U("form", { bind: this, afterCreate: v$T, afterRemoved: h$1d, "data-node-ref": "_addAttachmentForm", onsubmit: this._submitAddAttachment }, n$1U("fieldset", { class: y$10.fileFieldset }, n2, n$1U("label", { class: this.classes(y$10.fileLabel, y$10.esriButton, y$10.esriButtonSecondary) }, t2 ? this.messages.changeFile : this.messages.selectFile, n$1U("input", { class: y$10.fileInput, type: "file", name: "attachment", bind: this, onchange: this._handleFileInputChange }))), a2, i2);
    return n$1U("div", { key: "add-form-container", class: y$10.formNode }, r2);
  }
  renderDetailsForm(e2) {
    const { visibleElements: t2, viewModel: i2, selectedFile: a2, submitting: n2 } = this, { abilities: l2 } = i2, o2 = n2 || !a2;
    let d2, c2, m2, h2;
    a2 ? (d2 = a2.type, c2 = a2.name, m2 = a2.size) : "file" in e2 ? (d2 = e2.file.type, c2 = e2.file.name, m2 = e2.file.size) : (d2 = e2.contentType, c2 = e2.name, m2 = e2.size, h2 = e2.url);
    const u2 = l2.editing && l2.operations.delete && t2.deleteButton ? n$1U("button", { key: "delete-button", type: "button", disabled: n2, bind: this, onclick: (t3) => this._submitDeleteAttachment(t3, e2), class: this.classes(y$10.esriButton, y$10.esriButtonSmall, y$10.esriButtonTertiary, y$10.deleteButton, { [y$10.buttonDisabled]: n2 }) }, this.messages.delete) : void 0, g2 = l2.editing && l2.operations.update && t2.updateButton ? n$1U("button", { disabled: o2, key: "update-button", type: "submit", class: this.classes(y$10.esriButton, y$10.esriButtonSmall, y$10.esriButtonThird, { [y$10.buttonDisabled]: o2 }) }, this.messages.update) : void 0, _2 = this.visibleElements.cancelUpdateButton ? n$1U("button", { disabled: n2, key: "cancel-button", type: "button", bind: this, onclick: this._cancelForm, class: this.classes(y$10.esriButton, y$10.esriButtonSmall, y$10.esriButtonTertiary, y$10.esriButtonThird, { [y$10.buttonDisabled]: n2 }) }, this.messages.cancel) : void 0, v2 = l2.editing && l2.operations.update ? n$1U("fieldset", { key: "file", class: y$10.fileFieldset }, n$1U("span", { key: "file-name", class: y$10.fileName }, c2), n$1U("label", { class: this.classes(y$10.fileLabel, y$10.esriButton, y$10.esriButtonSecondary) }, this.messages.changeFile, n$1U("input", { class: y$10.fileInput, type: "file", name: "attachment", bind: this, onchange: this._handleFileInputChange }))) : void 0, A2 = n$1U("fieldset", { key: "size", class: y$10.metadataFieldset }, n$1U("label", null, v$R(this.messagesUnits, m2))), w2 = n$1U("fieldset", { key: "content-type", class: y$10.metadataFieldset }, n$1U("label", null, d2)), F2 = r$1$(h2) ? n$1U("a", { class: y$10.itemLink, href: h2, rel: "noreferrer", target: "_blank" }, this.renderImageMask(e2, 400), n$1U("div", { class: y$10.itemLinkOverlay }, n$1U("span", { class: y$10.itemLinkOverlayIcon }, n$1U("calcite-icon", { icon: "launch" })))) : this.renderImageMask(e2, 400), k2 = n$1U("form", { bind: this, afterCreate: v$T, afterRemoved: h$1d, "data-node-ref": "_updateAttachmentForm", onsubmit: (t3) => this._submitUpdateAttachment(t3, e2) }, n$1U("div", { class: y$10.metadata }, A2, w2), v2, n$1U("div", { class: y$10.actions }, u2, _2, g2));
    return n$1U("div", { key: "edit-form-container", class: y$10.formNode }, F2, k2);
  }
  renderImageMask(e2, t2) {
    return "file" in e2 ? this.renderGenericImageMask(e2.file.name, e2.file.type) : this.renderImageMaskForAttachment(e2, t2);
  }
  renderGenericImageMask(e2, t2) {
    const { supportsResizeAttachments: s2 } = this.viewModel, i2 = p$2m(t2), a2 = { [y$10.itemImageResizable]: s2 };
    return n$1U("div", { class: this.classes(y$10.itemMaskIcon, y$10.itemMask) }, n$1U("img", { title: e2, alt: e2, src: i2, class: this.classes(a2, y$10.itemImage) }));
  }
  renderImageMaskForAttachment(e2, t2) {
    const { supportsResizeAttachments: s2 } = this.viewModel, { contentType: i2, name: a2, url: n2 } = e2;
    if (!s2 || !e$1h(i2))
      return this.renderGenericImageMask(a2, i2);
    const r2 = this._getCSSTransform(e2), l2 = r2 ? { transform: r2, "image-orientation": "none" } : {}, o2 = `${n2}${n2.includes("?") ? "&" : "?"}w=${t2}`, d2 = { [y$10.itemImageResizable]: s2 };
    return n$1U("div", { class: this.classes(y$10.itemMask) }, n$1U("img", { styles: l2, alt: a2, title: a2, src: o2, class: this.classes(d2, y$10.itemImage) }));
  }
  renderFile(e2) {
    const { file: t2 } = e2;
    return n$1U("li", { class: y$10.item, key: t2 }, n$1U("button", { key: "details-button", bind: this, class: y$10.itemButton, title: this.messages.attachmentDetails, "aria-label": this.messages.attachmentDetails, onclick: () => this._startEditFile(e2), type: "button" }, this.renderImageMask(e2), n$1U("label", { class: y$10.itemLabel }, n$1U("span", { class: y$10.itemFilename }, t2.name || this.messages.noTitle), n$1U("span", { "aria-hidden": "true", class: this.classes(y$10.itemChevronIcon, f$1g(this.container) ? y$10.iconLeft : y$10.iconRight) }))));
  }
  renderAttachmentInfo({ attachmentInfo: e2, displayType: t2 }) {
    const { viewModel: s2, effectiveDisplayType: i2 } = this, { abilities: a2, supportsResizeAttachments: n2 } = s2, { contentType: r2, name: l2, url: o2 } = e2, d2 = this.renderImageMask(e2, t2 === "list" ? 48 : 400), c2 = a2.editing ? n$1U("span", { "aria-hidden": "true", class: this.classes(y$10.itemChevronIcon, f$1g(this.container) ? y$10.iconLeft : y$10.iconRight) }) : null, m2 = [d2, i2 === "preview" && n2 && e$1h(r2) ? null : n$1U("label", { class: y$10.itemLabel }, n$1U("span", { class: y$10.itemFilename }, l2 || this.messages.noTitle), c2)], h2 = a2.editing ? n$1U("button", { key: "details-button", bind: this, class: y$10.itemButton, title: this.messages.attachmentDetails, "aria-label": this.messages.attachmentDetails, "data-attachment-info-id": e2.id, onclick: () => this._startEditAttachment(e2), type: "button" }, m2) : n$1U("a", { key: "details-link", class: y$10.itemButton, href: o2, target: "_blank" }, m2);
    return n$1U("li", { class: y$10.item, key: e2 }, h2);
  }
  renderAttachmentContainer() {
    const { effectiveDisplayType: e2, viewModel: t2, visibleElements: s2 } = this, { attachmentInfos: i2, abilities: a2, fileInfos: n2 } = t2, r2 = !!(i2 == null ? void 0 : i2.length), l2 = !!(n2 == null ? void 0 : n2.length), o2 = { [y$10.containerList]: e2 !== "preview", [y$10.containerPreview]: e2 === "preview" }, d2 = a2.editing && a2.operations.add && s2.addButton ? n$1U("button", { bind: this, onclick: () => this._startAddAttachment(), class: this.classes(y$10.esriButton, y$10.esriButtonTertiary, y$10.addAttachmentButton), type: "button" }, n$1U("span", { "aria-hidden": "true", class: this.classes(y$10.itemAddIcon, y$10.iconPlus) }), this.messages.add) : void 0, c2 = r2 ? n$1U("ul", { key: "attachments-list", class: y$10.items }, i2.toArray().map((t3) => this.renderAttachmentInfo({ attachmentInfo: t3, displayType: e2 }))) : void 0, m2 = l2 ? n$1U("ul", { key: "file-list", class: y$10.items }, n2.toArray().map((e3) => this.renderFile(e3))) : void 0, h2 = l2 || r2 ? void 0 : n$1U("div", { class: y$10.empty }, this.messages.noAttachments);
    return n$1U("div", { key: "attachments-container", class: this.classes(y$10.container, o2) }, c2, m2, h2, d2);
  }
  _modeChanged() {
    this._set("error", null), this._set("selectedFile", null);
  }
  _handleFileInputChange(e2) {
    const t2 = e2.target, s2 = t2 && t2.files && t2.files.item(0);
    this._set("selectedFile", s2);
  }
  _submitDeleteAttachment(e2, t2) {
    e2.preventDefault(), "file" in t2 ? this.deleteFile(t2.file) : this.deleteAttachment(t2);
  }
  _submitAddAttachment(e2) {
    e2.preventDefault(), this.viewModel.filesEnabled ? this.addFile() : this.addAttachment();
  }
  _submitUpdateAttachment(e2, t2) {
    e2.preventDefault(), "file" in t2 ? this.updateFile() : this.updateAttachment();
  }
  _startEditAttachment(e2) {
    const { viewModel: t2 } = this;
    t2.activeFileInfo = null, t2.activeAttachmentInfo = e2, t2.mode = "edit";
  }
  _startEditFile(e2) {
    const { viewModel: t2 } = this;
    t2.activeAttachmentInfo = null, t2.activeFileInfo = e2, t2.mode = "edit";
  }
  _startAddAttachment() {
    this.viewModel.mode = "add";
  }
  _cancelForm(e2) {
    e2.preventDefault(), this.viewModel.mode = "view";
  }
  _getCSSTransform(e2) {
    const { orientationInfo: t2 } = e2;
    return !this._supportsImageOrientation && t2 ? [t2.rotation ? `rotate(${t2.rotation}deg)` : "", t2.mirrored ? "scaleX(-1)" : ""].join(" ") : "";
  }
};
e$2g([y$1I()], w$H.prototype, "abilities", null), e$2g([y$1I()], w$H.prototype, "displayType", void 0), e$2g([y$1I({ readOnly: true })], w$H.prototype, "effectiveDisplayType", null), e$2g([y$1I()], w$H.prototype, "graphic", null), e$2g([y$1I()], w$H.prototype, "label", null), e$2g([y$1I(), e$1g("esri/widgets/Attachments/t9n/Attachments")], w$H.prototype, "messages", void 0), e$2g([y$1I(), e$1g("esri/core/t9n/Units")], w$H.prototype, "messagesUnits", void 0), e$2g([y$1I({ readOnly: true })], w$H.prototype, "selectedFile", void 0), e$2g([y$1I({ readOnly: true })], w$H.prototype, "submitting", void 0), e$2g([y$1I({ readOnly: true })], w$H.prototype, "error", void 0), e$2g([y$1I({ type: A$l })], w$H.prototype, "viewModel", void 0), e$2g([y$1I()], w$H.prototype, "visibleElements", void 0), e$2g([s$2i("visibleElements")], w$H.prototype, "castVisibleElements", null), w$H = e$2g([n$2P("esri.widgets.Attachments")], w$H);
const F$p = w$H;
let o$1o = class extends A$l {
  constructor(t2) {
    super(t2), this.description = null, this.title = null;
  }
};
e$2g([y$1I()], o$1o.prototype, "description", void 0), e$2g([y$1I()], o$1o.prototype, "title", void 0), o$1o = e$2g([n$2P("esri.widgets.Feature.FeatureAttachments.FeatureAttachmentsViewModel")], o$1o);
const c$24 = o$1o;
const i$23 = { heading: "esri-widget__heading" };
function n$1T(e2, n2) {
  const l2 = o$1n(e2.level), s2 = `h${l2}`;
  return delete e2.level, n$1U(s2, __spreadProps(__spreadValues({}, e2), { class: p$2t(i$23.heading, e2.class), role: "heading", "aria-level": String(l2) }), n2);
}
function o$1n(t2) {
  return a$2v(Math.ceil(t2), 1, 6);
}
const p$2l = { base: "esri-feature-element-info", title: "esri-feature-element-info__title", description: "esri-feature-element-info__description" };
let n$1S = class extends M$u {
  constructor(e2, t2) {
    super(e2, t2), this.description = null, this.headingLevel = 2, this.title = null;
  }
  render() {
    return n$1U("div", { class: p$2l.base }, this.renderTitle(), this.renderDescription());
  }
  renderTitle() {
    const { title: e2 } = this;
    return e2 ? n$1U(n$1T, { level: this.headingLevel, class: p$2l.title }, e2) : null;
  }
  renderDescription() {
    const { description: e2 } = this;
    return e2 ? n$1U("div", { key: "description", class: p$2l.description }, e2) : null;
  }
};
e$2g([y$1I()], n$1S.prototype, "description", void 0), e$2g([y$1I()], n$1S.prototype, "headingLevel", void 0), e$2g([y$1I()], n$1S.prototype, "title", void 0), n$1S = e$2g([n$2P("esri.widgets.Feature.support.FeatureElementInfo")], n$1S);
const l$1E = n$1S;
const d$19 = { base: "esri-feature-attachments" };
let c$23 = class extends M$u {
  constructor(e2, t2) {
    super(e2, t2), this._featureElementInfo = null, this.attachmentsWidget = new F$p(), this.headingLevel = 2, this.viewModel = new c$24();
  }
  initialize() {
    this._featureElementInfo = new l$1E(), this.addHandles([l$1P(() => {
      var _a2, _b2;
      return [(_a2 = this.viewModel) == null ? void 0 : _a2.description, (_b2 = this.viewModel) == null ? void 0 : _b2.title, this.headingLevel];
    }, () => this._setupFeatureElementInfo(), h$1j), l$1P(() => {
      var _a2;
      return (_a2 = this.viewModel) == null ? void 0 : _a2.graphic;
    }, (e2) => this.attachmentsWidget.graphic = e2, h$1j)]);
  }
  destroy() {
    this.attachmentsWidget.destroy(), this._featureElementInfo.destroy();
  }
  get description() {
    return this.viewModel.description;
  }
  set description(e2) {
    this.viewModel.description = e2;
  }
  get displayType() {
    return this.attachmentsWidget.displayType;
  }
  set displayType(e2) {
    this.attachmentsWidget.displayType = e2;
  }
  get graphic() {
    return this.viewModel.graphic;
  }
  set graphic(e2) {
    this.viewModel.graphic = e2;
  }
  get title() {
    return this.viewModel.title;
  }
  set title(e2) {
    this.viewModel.title = e2;
  }
  render() {
    var _a2;
    const { attachmentsWidget: e2 } = this;
    return n$1U("div", { class: d$19.base }, (_a2 = this._featureElementInfo) == null ? void 0 : _a2.render(), e2 == null ? void 0 : e2.render());
  }
  _setupFeatureElementInfo() {
    const { description: e2, title: t2, headingLevel: i2 } = this;
    this._featureElementInfo.set({ description: e2, title: t2, headingLevel: i2 });
  }
};
e$2g([y$1I({ readOnly: true })], c$23.prototype, "attachmentsWidget", void 0), e$2g([y$1I()], c$23.prototype, "description", null), e$2g([y$1I()], c$23.prototype, "displayType", null), e$2g([y$1I()], c$23.prototype, "graphic", null), e$2g([y$1I()], c$23.prototype, "headingLevel", void 0), e$2g([y$1I()], c$23.prototype, "title", null), e$2g([y$1I({ type: c$24 })], c$23.prototype, "viewModel", void 0), c$23 = e$2g([n$2P("esri.widgets.Feature.FeatureAttachments")], c$23);
const h$18 = c$23;
const a$1W = (s2) => {
  let a2 = class extends s2 {
    destroy() {
      var _a2, _b2;
      this.destroyed || ((_a2 = this._get("handles")) == null ? void 0 : _a2.destroy(), (_b2 = this._get("updatingHandles")) == null ? void 0 : _b2.destroy());
    }
    get handles() {
      return this._get("handles") || new t$2g();
    }
    get updatingHandles() {
      return this._get("updatingHandles") || new c$2c();
    }
  };
  return e$2g([y$1I({ readOnly: true })], a2.prototype, "handles", null), e$2g([y$1I({ readOnly: true })], a2.prototype, "updatingHandles", null), a2 = e$2g([n$2P("esri.core.HandleOwner")], a2), a2;
};
let d$18 = class extends a$1W(m$2q) {
};
d$18 = e$2g([n$2P("esri.core.HandleOwner")], d$18);
let p$2k = class extends a$1W(m$2q) {
  constructor(t2) {
    super(t2), this._loadingPromise = null, this.created = null, this.creator = null, this.destroyer = null, this.graphic = null, this.handles.add(l$1P(() => this.creator, (t3) => {
      this._destroyContent(), this._createContent(t3);
    }, h$1j));
  }
  destroy() {
    this._destroyContent();
  }
  get state() {
    return this._loadingPromise ? "loading" : "ready";
  }
  _destroyContent() {
    const { created: t2, graphic: e2, destroyer: r2 } = this;
    t2 && (j$C(r2, { graphic: e2 }).catch(() => null), this._set("created", null));
  }
  async _createContent(t2) {
    const { graphic: e2 } = this, r2 = j$C(t2, { graphic: e2 }).catch(() => null);
    this._loadingPromise = r2, this.notifyChange("state");
    const o2 = await r2;
    r2 === this._loadingPromise && (this._loadingPromise = null, this.notifyChange("state"), this._set("created", o2));
  }
};
e$2g([y$1I({ readOnly: true })], p$2k.prototype, "created", void 0), e$2g([y$1I()], p$2k.prototype, "creator", void 0), e$2g([y$1I()], p$2k.prototype, "destroyer", void 0), e$2g([y$1I({ type: g$10 })], p$2k.prototype, "graphic", void 0), e$2g([y$1I({ readOnly: true })], p$2k.prototype, "state", null), p$2k = e$2g([n$2P("esri.widgets.Feature.FeatureContent.FeatureContentViewModel")], p$2k);
const l$1D = p$2k;
function t$1p() {
  return function(n2, t2) {
    if (!n2[t2])
      throw new TypeError(`Cannot auto bind undefined function '${t2}'`);
    return { value: o$1m(n2[t2]) };
  };
}
function e$1e(n2) {
  const { type: t2 } = n2;
  return n2 instanceof KeyboardEvent || t2 === "keyup" || t2 === "keydown" || t2 === "keypress";
}
function o$1m(t2) {
  return function(o2, ...r2) {
    e$1e(o2) ? k$r(o2.key) && (o2.preventDefault(), o2.stopPropagation(), o2.target.click()) : t2.call(this, o2, ...r2);
  };
}
function e$1d(e2) {
  return (a2) => {
    a2.hasOwnProperty("_delegatedEventNames") || (a2._delegatedEventNames = a2._delegatedEventNames ? a2._delegatedEventNames.slice() : []);
    const n2 = a2._delegatedEventNames, r2 = Array.isArray(e2) ? e2 : t$1o(e2);
    n2.push(...r2);
  };
}
function t$1o(e2) {
  return e2.split(",").map((e3) => e3.trim());
}
const t$1n = "calcite-theme-";
function e$1c() {
  return getComputedStyle(document.body).getPropertyValue("--esri-calcite-theme-name").replace(/\s|'|"/g, "");
}
function r$1e() {
  return e$1c().startsWith("dark");
}
function c$22() {
  return `${t$1n}${r$1e() ? "dark" : "light"}`;
}
function n$1R(t2) {
  s$1v(t2), t2.classList.add(c$22());
}
function s$1v(e2) {
  Array.from(e2.classList).forEach((r2) => {
    r2.startsWith(t$1n) && e2.classList.remove(r2);
  });
}
function e$1b(e2) {
  return e2 && typeof e2.render == "function";
}
function t$1m(e2) {
  return e2 && typeof e2.postMixInProperties == "function" && typeof e2.buildRendering == "function" && typeof e2.postCreate == "function" && typeof e2.startup == "function";
}
const d$17 = { base: "esri-feature-content", loaderContainer: "esri-feature-content__loader-container", loader: "esri-feature-content__loader" };
let c$21 = class extends M$u {
  constructor(e2, r2) {
    super(e2, r2), this.viewModel = null, this._addTargetToAnchors = (e3) => {
      Array.from(e3.querySelectorAll("a")).forEach((e4) => {
        x$G(e4.href) && !e4.hasAttribute("target") && e4.setAttribute("target", "_blank");
      });
    };
  }
  get creator() {
    return this.viewModel.creator;
  }
  set creator(e2) {
    this.viewModel.creator = e2;
  }
  get graphic() {
    return this.viewModel.graphic;
  }
  set graphic(e2) {
    this.viewModel.graphic = e2;
  }
  renderLoading() {
    return n$1U("div", { class: d$17.loaderContainer, key: "loader" }, n$1U("div", { class: d$17.loader }));
  }
  renderCreated() {
    var _a2;
    const e2 = (_a2 = this.viewModel) == null ? void 0 : _a2.created;
    return e2 ? e2 instanceof HTMLElement ? n$1U("div", { key: e2, bind: e2, afterCreate: this._attachToNode }) : e$1b(e2) ? n$1U("div", { key: e2 }, !e2.destroyed && e2.render()) : n$1U("div", { key: e2, innerHTML: e2, afterCreate: this._addTargetToAnchors }) : null;
  }
  render() {
    var _a2;
    const e2 = (_a2 = this.viewModel) == null ? void 0 : _a2.state;
    return n$1U("div", { class: d$17.base }, e2 === "loading" ? this.renderLoading() : this.renderCreated());
  }
  _attachToNode(e2) {
    const r2 = this;
    e2.appendChild(r2);
  }
};
e$2g([y$1I()], c$21.prototype, "creator", null), e$2g([y$1I()], c$21.prototype, "graphic", null), e$2g([y$1I({ type: l$1D })], c$21.prototype, "viewModel", void 0), c$21 = e$2g([n$2P("esri.widgets.Feature.FeatureContent")], c$21);
const l$1C = c$21;
let l$1B = class extends m$2q {
  constructor(o2) {
    super(o2), this.attributes = null, this.expressionInfos = null, this.description = null, this.fieldInfos = null, this.title = null;
  }
  get formattedFieldInfos() {
    const { expressionInfos: o2, fieldInfos: e2 } = this, s2 = [];
    return e2 == null ? void 0 : e2.forEach((e3) => {
      if (!(!e3.hasOwnProperty("visible") || e3.visible))
        return;
      const t2 = e3.clone();
      t2.label = q$j(t2, o2), s2.push(t2);
    }), s2;
  }
};
e$2g([y$1I()], l$1B.prototype, "attributes", void 0), e$2g([y$1I({ type: [i$2D] })], l$1B.prototype, "expressionInfos", void 0), e$2g([y$1I()], l$1B.prototype, "description", void 0), e$2g([y$1I({ type: [c$2Z] })], l$1B.prototype, "fieldInfos", void 0), e$2g([y$1I({ readOnly: true })], l$1B.prototype, "formattedFieldInfos", null), e$2g([y$1I()], l$1B.prototype, "title", void 0), l$1B = e$2g([n$2P("esri.widgets.Feature.FeatureFields.FeatureFieldsViewModel")], l$1B);
const n$1Q = l$1B;
const s$1u = [{ pattern: /^\s*(https?:\/\/([^\s]+))\s*$/i, target: "_blank", label: "{messages.view}" }, { pattern: /^\s*(tel:([^\s]+))\s*$/i, label: "{hierPart}" }, { pattern: /^\s*(mailto:([^\s]+))\s*$/i, label: "{hierPart}" }, { pattern: /^\s*(arcgis-appstudio-player:\/\/([^\s]+))\s*$/i, label: "{messages.openInApp}", appName: "App Studio Player" }, { pattern: /^\s*(arcgis-collector:\/\/([^\s]+))\s*$/i, label: "{messages.openInApp}", appName: "Collector" }, { pattern: /^\s*(arcgis-explorer:\/\/([^\s]+))\s*$/i, label: "{messages.openInApp}", appName: "Explorer" }, { pattern: /^\s*(arcgis-navigator:\/\/([^\s]+))\s*$/i, label: "{messages.openInApp}", appName: "Navigator" }, { pattern: /^\s*(arcgis-survey123:\/\/([^\s]+))\s*$/i, label: "{messages.openInApp}", appName: "Survey123" }, { pattern: /^\s*(arcgis-trek2there:\/\/([^\s]+))\s*$/i, label: "{messages.openInApp}", appName: "Trek2There" }, { pattern: /^\s*(arcgis-workforce:\/\/([^\s]+))\s*$/i, label: "{messages.openInApp}", appName: "Workforce" }, { pattern: /^\s*(iform:\/\/([^\s]+))\s*$/i, label: "{messages.openInApp}", appName: "iForm" }, { pattern: /^\s*(flow:\/\/([^\s]+))\s*$/i, label: "{messages.openInApp}", appName: "FlowFinity" }, { pattern: /^\s*(lfmobile:\/\/([^\s]+))\s*$/i, label: "{messages.openInApp}", appName: "Laserfische" }, { pattern: /^\s*(mspbi:\/\/([^\s]+))\s*$/i, label: "{messages.openInApp}", appName: "Microsoft Power Bi" }];
function a$1V(e2) {
  let a2 = null;
  return s$1u.some((s2) => (s2.pattern.test(e2) && (a2 = s2), !!a2)), a2;
}
function p$2j(s2, p2) {
  if (typeof p2 != "string" || !p2)
    return p2;
  const r2 = a$1V(p2);
  if (!r2)
    return p2;
  const t2 = p2.match(r2.pattern), n2 = t2 && t2[2], l2 = n$2W(n$2W(r2.label, { messages: s2, hierPart: n2 }), { appName: r2.appName }), i2 = r2.target ? ` target="${r2.target}"` : "", o2 = r2.target === "_blank" ? ' rel="noreferrer"' : "";
  return p2.replace(r2.pattern, `<a${i2} href="$1"${o2}>${l2}</a>`);
}
const p$2i = { base: "esri-feature-fields", fieldHeader: "esri-feature-fields__field-header", fieldData: "esri-feature-fields__field-data", fieldDataDate: "esri-feature-fields__field-data--date", esriTable: "esri-widget__table" };
let u$1j = class extends M$u {
  constructor(e2, t2) {
    super(e2, t2), this._featureElementInfo = null, this.viewModel = new n$1Q(), this.messages = null, this.messagesURIUtils = null;
  }
  initialize() {
    this._featureElementInfo = new l$1E(), this.addHandles(l$1P(() => {
      var _a2, _b2;
      return [(_a2 = this.viewModel) == null ? void 0 : _a2.description, (_b2 = this.viewModel) == null ? void 0 : _b2.title];
    }, () => this._setupFeatureElementInfo(), h$1j));
  }
  destroy() {
    this._featureElementInfo.destroy();
  }
  get attributes() {
    return this.viewModel.attributes;
  }
  set attributes(e2) {
    this.viewModel.attributes = e2;
  }
  get description() {
    return this.viewModel.description;
  }
  set description(e2) {
    this.viewModel.description = e2;
  }
  get expressionInfos() {
    return this.viewModel.expressionInfos;
  }
  set expressionInfos(e2) {
    this.viewModel.expressionInfos = e2;
  }
  get fieldInfos() {
    return this.viewModel.fieldInfos;
  }
  set fieldInfos(e2) {
    this.viewModel.fieldInfos = e2;
  }
  get title() {
    return this.viewModel.title;
  }
  set title(e2) {
    this.viewModel.title = e2;
  }
  renderFieldInfo(e2, t2) {
    const { attributes: s2 } = this.viewModel, i2 = e2.fieldName, r2 = e2.label || i2, o2 = s2 ? s2[i2] == null ? "" : s2[i2] : "", l2 = !(!e2.format || !e2.format.dateFormat), n2 = typeof o2 == "number" && !l2 ? this._forceLTR(o2) : p$2j(this.messagesURIUtils, o2), a2 = { [p$2i.fieldDataDate]: l2 };
    return n$1U("tr", { key: `fields-element-info-row-${i2}-${t2}` }, n$1U("th", { key: `fields-element-info-row-header-${i2}-${t2}`, class: p$2i.fieldHeader, innerHTML: r2 }), n$1U("td", { key: `fields-element-info-row-data-${i2}-${t2}`, class: this.classes(p$2i.fieldData, a2), innerHTML: n2 }));
  }
  renderFields() {
    const { formattedFieldInfos: e2 } = this.viewModel;
    return (e2 == null ? void 0 : e2.length) ? n$1U("table", { class: p$2i.esriTable, summary: this.messages.fieldsSummary }, n$1U("tbody", null, e2.map((e3, t2) => this.renderFieldInfo(e3, t2)))) : null;
  }
  render() {
    var _a2;
    return n$1U("div", { class: p$2i.base }, (_a2 = this._featureElementInfo) == null ? void 0 : _a2.render(), this.renderFields());
  }
  _setupFeatureElementInfo() {
    const { description: e2, title: t2 } = this;
    this._featureElementInfo.set({ description: e2, title: t2 });
  }
  _forceLTR(e2) {
    return `&lrm;${e2}`;
  }
};
e$2g([y$1I()], u$1j.prototype, "attributes", null), e$2g([y$1I()], u$1j.prototype, "description", null), e$2g([y$1I()], u$1j.prototype, "expressionInfos", null), e$2g([y$1I()], u$1j.prototype, "fieldInfos", null), e$2g([y$1I()], u$1j.prototype, "title", null), e$2g([y$1I({ type: n$1Q, nonNullable: true })], u$1j.prototype, "viewModel", void 0), e$2g([y$1I(), e$1g("esri/widgets/Feature/t9n/Feature")], u$1j.prototype, "messages", void 0), e$2g([y$1I(), e$1g("esri/widgets/support/t9n/uriUtils")], u$1j.prototype, "messagesURIUtils", void 0), u$1j = e$2g([n$2P("esri.widgets.Feature.FeatureFields")], u$1j);
const m$1C = u$1j;
const s$1t = { maximumFractionDigits: 20 };
function c$20(n2) {
  return m$2f(n2, s$1t);
}
var i$22;
let c$1$ = i$22 = class extends l$2B {
  constructor(r2) {
    super(r2), this.color = null, this.label = null, this.value = null;
  }
  writeValue(r2, o2, e2) {
    o2[e2] = r2 != null ? r2 : 0;
  }
  clone() {
    return new i$22({ color: this.color && this.color.clone(), label: this.label, value: this.value });
  }
};
e$2g([y$1I({ type: l$2e, json: { type: [T$G], write: true } })], c$1$.prototype, "color", void 0), e$2g([y$1I({ type: String, json: { write: true } })], c$1$.prototype, "label", void 0), e$2g([y$1I({ type: Number, json: { write: { writerEnsuresNonNull: true } } })], c$1$.prototype, "value", void 0), e$2g([r$1P("value")], c$1$.prototype, "writeValue", null), c$1$ = i$22 = e$2g([n$2P("esri.renderers.visualVariables.support.ColorStop")], c$1$);
const a$1U = c$1$;
function c$1_(r2, t2, o2) {
  return E$Q(r2.map((r3, e2) => t2.apply(o2, [r3, e2])));
}
async function h$17(r2, t2, o2) {
  return (await E$Q(r2.map((r3, e2) => t2.apply(o2, [r3, e2])))).map((r3) => r3.value);
}
function m$1B(r2) {
  return { ok: true, value: r2 };
}
function f$1c(r2) {
  return { ok: false, error: r2 };
}
function _$x(r2) {
  return r$1$(r2) && r2.ok === true ? r2.value : null;
}
function y$$(r2) {
  return r$1$(r2) && r2.ok === false ? r2.error : null;
}
async function b$N(r2) {
  if (t$2r(r2))
    return { ok: false, error: new Error("no promise provided") };
  try {
    return m$1B(await r2);
  } catch (t2) {
    return f$1c(t2);
  }
}
async function d$16(r2) {
  try {
    return m$1B(await r2);
  } catch (t2) {
    return w$12(t2), f$1c(t2);
  }
}
function j$B(r2, t2) {
  return new k$o(r2, t2);
}
let k$o = class extends m$2q {
  constructor(r2, t2) {
    super({}), this._result = null, this._abortHandle = null, this.abort = () => {
      this._abortController = p$3M(this._abortController);
    }, this.remove = this.abort, this._abortController = new AbortController();
    const { signal: o2 } = this._abortController;
    this.promise = r2(o2), this.promise.then((r3) => {
      this._result = m$1B(r3), this._cleanup();
    }, (r3) => {
      this._result = f$1c(r3), this._cleanup();
    }), this._abortHandle = v$19(t2, this.abort);
  }
  get value() {
    return _$x(this._result);
  }
  get error() {
    return y$$(this._result);
  }
  get finished() {
    return r$1$(this._result);
  }
  normalizeCtorArgs() {
    return {};
  }
  destroy() {
    this.abort();
  }
  _cleanup() {
    this._abortHandle = h$1W(this._abortHandle), this._abortController = null;
  }
};
e$2g([y$1I()], k$o.prototype, "value", null), e$2g([y$1I()], k$o.prototype, "error", null), e$2g([y$1I()], k$o.prototype, "finished", null), e$2g([y$1I()], k$o.prototype, "promise", void 0), e$2g([y$1I()], k$o.prototype, "_result", void 0), k$o = e$2g([n$2P("esri.core.asyncUtils.ReactiveTask")], k$o);
function e$1a() {
  const e2 = new Float32Array(16);
  return e2[0] = 1, e2[5] = 1, e2[10] = 1, e2[15] = 1, e2;
}
function r$1d(e2) {
  const r2 = new Float32Array(16);
  return r2[0] = e2[0], r2[1] = e2[1], r2[2] = e2[2], r2[3] = e2[3], r2[4] = e2[4], r2[5] = e2[5], r2[6] = e2[6], r2[7] = e2[7], r2[8] = e2[8], r2[9] = e2[9], r2[10] = e2[10], r2[11] = e2[11], r2[12] = e2[12], r2[13] = e2[13], r2[14] = e2[14], r2[15] = e2[15], r2;
}
function t$1l(e2, r2, t2, n2, o2, a2, c2, u2, l2, s2, f2, i2, y2, w2, b2, A2) {
  const F2 = new Float32Array(16);
  return F2[0] = e2, F2[1] = r2, F2[2] = t2, F2[3] = n2, F2[4] = o2, F2[5] = a2, F2[6] = c2, F2[7] = u2, F2[8] = l2, F2[9] = s2, F2[10] = f2, F2[11] = i2, F2[12] = y2, F2[13] = w2, F2[14] = b2, F2[15] = A2, F2;
}
function n$1P(e2, r2) {
  return new Float32Array(e2, r2, 16);
}
const o$1l = e$1a();
Object.freeze(Object.defineProperty({ __proto__: null, create: e$1a, clone: r$1d, fromValues: t$1l, createView: n$1P, IDENTITY: o$1l }, Symbol.toStringTag, { value: "Module" }));
const r$1c = (r2, s2) => {
  const o2 = s$1H(r2, s2, 0, 0, 0, 0, s2, 0, 0, 0, 0, s2, 0, 0, 0, 0, 1);
  return o$1B(o2, o2);
}, s$1s = (r2, s2) => {
  const o2 = s$1H(r2, s2, 0, 0, 0.5 - 0.5 * s2, 0, s2, 0, 0.5 - 0.5 * s2, 0, 0, s2, 0.5 - 0.5 * s2, 0, 0, 0, 1);
  return o$1B(o2, o2);
}, o$1k = (r2, s2) => {
  const o2 = 1 - s2, c2 = s$1H(r2, 0.2126 + 0.7874 * o2, 0.7152 - 0.7152 * o2, 0.0722 - 0.0722 * o2, 0, 0.2126 - 0.2126 * o2, 0.7152 + 0.2848 * o2, 0.0722 - 0.0722 * o2, 0, 0.2126 - 0.2126 * o2, 0.7152 - 0.7152 * o2, 0.0722 + 0.9278 * o2, 0, 0, 0, 0, 1);
  return o$1B(c2, c2);
}, c$1Z = (r2, s2) => {
  const o2 = Math.sin(s2 * Math.PI / 180), c2 = Math.cos(s2 * Math.PI / 180), e2 = s$1H(r2, 0.213 + 0.787 * c2 - 0.213 * o2, 0.715 - 0.715 * c2 - 0.715 * o2, 0.072 - 0.072 * c2 + 0.928 * o2, 0, 0.213 - 0.213 * c2 + 0.143 * o2, 0.715 + 0.285 * c2 + 0.14 * o2, 0.072 - 0.072 * c2 - 0.283 * o2, 0, 0.213 - 0.213 * c2 - 0.787 * o2, 0.715 - 0.715 * c2 + 0.715 * o2, 0.072 + 0.928 * c2 + 0.072 * o2, 0, 0, 0, 0, 1);
  return o$1B(e2, e2);
}, e$19 = (r2, s2) => {
  const o2 = 1 - 2 * s2, c2 = s$1H(r2, o2, 0, 0, s2, 0, o2, 0, s2, 0, 0, o2, s2, 0, 0, 0, 1);
  return o$1B(c2, c2);
}, u$1i = (r2, s2) => {
  const o2 = s$1H(r2, 0.213 + 0.787 * s2, 0.715 - 0.715 * s2, 0.072 - 0.072 * s2, 0, 0.213 - 0.213 * s2, 0.715 + 0.285 * s2, 0.072 - 0.072 * s2, 0, 0.213 - 0.213 * s2, 0.715 - 0.715 * s2, 0.072 + 0.928 * s2, 0, 0, 0, 0, 1);
  return o$1B(o2, o2);
}, a$1T = (r2, s2) => {
  const o2 = 1 - s2, c2 = s$1H(r2, 0.393 + 0.607 * o2, 0.769 - 0.769 * o2, 0.189 - 0.189 * o2, 0, 0.349 - 0.349 * o2, 0.686 + 0.314 * o2, 0.168 - 0.168 * o2, 0, 0.272 - 0.272 * o2, 0.534 - 0.534 * o2, 0.131 + 0.869 * o2, 0, 0, 0, 0, 1);
  return o$1B(c2, c2);
};
class c$1Y {
  constructor(t2, s2, r2) {
    this.strength = t2, this.radius = s2, this.threshold = r2, this.type = "bloom";
  }
  interpolate(t2, s2, r2) {
    this.strength = M$r(t2.strength, s2.strength, r2), this.radius = M$r(t2.radius, s2.radius, r2), this.threshold = M$r(t2.threshold, s2.threshold, r2);
  }
  clone() {
    return new c$1Y(this.strength, this.radius, this.threshold);
  }
  toJSON() {
    return { type: "bloom", radius: y$_(this.radius), strength: this.strength, threshold: this.threshold };
  }
}
class l$1A {
  constructor(t2) {
    this.radius = t2, this.type = "blur";
  }
  interpolate(t2, s2, r2) {
    this.radius = Math.round(M$r(t2.radius, s2.radius, r2));
  }
  clone() {
    return new l$1A(this.radius);
  }
  toJSON() {
    return { type: "blur", radius: y$_(this.radius) };
  }
}
class p$2h {
  constructor(t2, s2) {
    this.type = t2, this.amount = s2, this.type !== "invert" && this.type !== "grayscale" && this.type !== "sepia" || (this.amount = Math.min(this.amount, 1));
  }
  get colorMatrix() {
    return this._colorMatrix || this._updateMatrix(), this._colorMatrix;
  }
  interpolate(t2, s2, r2) {
    this.amount = M$r(t2.amount, s2.amount, r2), this._updateMatrix();
  }
  clone() {
    return new p$2h(this.type, this.amount);
  }
  toJSON() {
    return { type: this.type, amount: this.amount };
  }
  _updateMatrix() {
    const t2 = this._colorMatrix || e$1a();
    switch (this.type) {
      case "brightness":
        this._colorMatrix = r$1c(t2, this.amount);
        break;
      case "contrast":
        this._colorMatrix = s$1s(t2, this.amount);
        break;
      case "grayscale":
        this._colorMatrix = o$1k(t2, this.amount);
        break;
      case "invert":
        this._colorMatrix = e$19(t2, this.amount);
        break;
      case "saturate":
        this._colorMatrix = u$1i(t2, this.amount);
        break;
      case "sepia":
        this._colorMatrix = a$1T(t2, this.amount);
    }
  }
}
class d$15 {
  constructor(t2, s2, r2, o2) {
    this.offsetX = t2, this.offsetY = s2, this.blurRadius = r2, this.color = o2, this.type = "drop-shadow";
  }
  interpolate(t2, s2, r2) {
    this.offsetX = M$r(t2.offsetX, s2.offsetX, r2), this.offsetY = M$r(t2.offsetY, s2.offsetY, r2), this.blurRadius = M$r(t2.blurRadius, s2.blurRadius, r2), this.color[0] = Math.round(M$r(t2.color[0], s2.color[0], r2)), this.color[1] = Math.round(M$r(t2.color[1], s2.color[1], r2)), this.color[2] = Math.round(M$r(t2.color[2], s2.color[2], r2)), this.color[3] = M$r(t2.color[3], s2.color[3], r2);
  }
  clone() {
    return new d$15(this.offsetX, this.offsetY, this.blurRadius, [...this.color]);
  }
  toJSON() {
    const t2 = [...this.color];
    return t2[3] *= 255, { type: "drop-shadow", xoffset: y$_(this.offsetX), yoffset: y$_(this.offsetY), blurRadius: y$_(this.blurRadius), color: t2 };
  }
}
class m$1A {
  constructor(t2) {
    this.angle = t2, this.type = "hue-rotate";
  }
  get colorMatrix() {
    return this._colorMatrix || this._updateMatrix(), this._colorMatrix;
  }
  interpolate(t2, s2, r2) {
    this.angle = M$r(t2.angle, s2.angle, r2), this._updateMatrix();
  }
  clone() {
    return new m$1A(this.angle);
  }
  toJSON() {
    return { type: "hue-rotate", angle: this.angle };
  }
  _updateMatrix() {
    const t2 = this._colorMatrix || e$1a();
    this._colorMatrix = c$1Z(t2, this.angle);
  }
}
class f$1b {
  constructor(t2) {
    this.amount = t2, this.type = "opacity", this.amount = Math.min(this.amount, 1);
  }
  interpolate(t2, s2, r2) {
    this.amount = M$r(t2.amount, s2.amount, r2);
  }
  clone() {
    return new f$1b(this.amount);
  }
  toJSON() {
    return { type: "opacity", amount: this.amount };
  }
}
function M$r(t2, s2, r2) {
  return t2 + (s2 - t2) * r2;
}
function y$_(t2) {
  return Math.round(1e3 * e$1D(t2)) / 1e3;
}
function x$F(s2) {
  switch (s2.type) {
    case "grayscale":
    case "sepia":
    case "invert":
      return new p$2h(s2.type, 0);
    case "saturate":
    case "brightness":
    case "contrast":
      return new p$2h(s2.type, 1);
    case "opacity":
      return new f$1b(1);
    case "hue-rotate":
      return new m$1A(0);
    case "blur":
      return new l$1A(0);
    case "drop-shadow":
      return new d$15(0, 0, 0, [...l$2j("transparent")]);
    case "bloom":
      return new c$1Y(0, 0, 1);
  }
}
function n$1O(t2, n2) {
  const e2 = t2.length > n2.length ? t2 : n2;
  return (t2.length > n2.length ? n2 : t2).every((t3, n3) => t3.type === e2[n3].type);
}
function e$18(n2, e2) {
  const h2 = n2.length > e2.length ? n2 : e2, l2 = n2.length > e2.length ? e2 : n2;
  for (let g2 = l2.length; g2 < h2.length; g2++)
    l2.push(x$F(h2[g2]));
}
function h$16(t2) {
  const n2 = t2[0];
  return !!n2 && "type" in n2;
}
var m$1z, g$S, v$O = { exports: {} };
function d$14(t2) {
  if (!t2 || t2.length === 0)
    return null;
  if (typeof t2 == "string") {
    const e3 = y$Z(t2);
    return e3 && e3.length !== 0 ? e3 : null;
  }
  const e2 = t2.map((t3) => {
    if (!Number.isFinite(t3.scale) || t3.scale <= 0)
      throw new s$2u("effect:invalid-scale", "scale must be finite and greater than 0", { stop: t3 });
    return { scale: t3.scale, effects: y$Z(t3.value) };
  });
  e2.sort((t3, e3) => e3.effects.length - t3.effects.length);
  for (let r2 = 0; r2 < e2.length - 1; r2++) {
    if (!n$1O(e2[r2].effects, e2[r2 + 1].effects))
      throw new s$2u("effect:interpolation-impossible", "Cannot interpolate by scale between 2 lists of mixed effects", { a: e2[r2].effects, b: e2[r2 + 1].effects });
    e$18(e2[r2].effects, e2[r2 + 1].effects);
  }
  return e2.sort((t3, e3) => e3.scale - t3.scale), e2;
}
function y$Z(t2) {
  let e2;
  if (!t2)
    return [];
  try {
    e2 = v$O.exports.parse(t2);
  } catch (r2) {
    throw new s$2u("effect:invalid-syntax", "Invalid effect syntax", { value: t2, error: r2 });
  }
  return e2.map((t3) => A$j(t3));
}
function A$j(t2) {
  try {
    switch (t2.name) {
      case "grayscale":
      case "sepia":
      case "saturate":
      case "invert":
      case "brightness":
      case "contrast":
        return w$G(t2);
      case "opacity":
        return x$E(t2);
      case "hue-rotate":
        return b$M(t2);
      case "blur":
        return C$t(t2);
      case "drop-shadow":
        return F$o(t2);
      case "bloom":
        return E$y(t2);
    }
  } catch (e2) {
    throw e2.details.filter = t2, e2;
  }
  throw new s$2u("effect:unknown-effect", `Effect '${t2.name}' is not supported`, { effect: t2 });
}
function w$G(t2) {
  let e2 = 1;
  return j$A(t2.parameters, 1), t2.parameters.length === 1 && (e2 = M$q(t2.parameters[0])), new p$2h(t2.name, e2);
}
function x$E(t2) {
  let e2 = 1;
  return j$A(t2.parameters, 1), t2.parameters.length === 1 && (e2 = M$q(t2.parameters[0])), new f$1b(e2);
}
function b$M(t2) {
  let e2 = 0;
  return j$A(t2.parameters, 1), t2.parameters.length === 1 && (e2 = N$k(t2.parameters[0])), new m$1A(e2);
}
function C$t(t2) {
  let e2 = 0;
  return j$A(t2.parameters, 1), t2.parameters.length === 1 && (e2 = T$r(t2.parameters[0]), O$o(e2, t2.parameters[0])), new l$1A(e2);
}
function F$o(t2) {
  const e2 = [];
  let r2 = null;
  for (const n2 of t2.parameters)
    if (n2.type === "color") {
      if (e2.length && Object.freeze(e2), r2)
        throw new s$2u("effect:type-error", "Accepts only one color", {});
      r2 = U$m(n2);
    } else {
      const t3 = T$r(n2);
      if (Object.isFrozen(e2))
        throw new s$2u("effect:type-error", "<length> parameters not consecutive", { lengths: e2 });
      e2.push(t3), e2.length === 3 && O$o(t3, n2);
    }
  if (e2.length < 2 || e2.length > 3)
    throw new s$2u("effect:type-error", `Expected <length>{2,3}, Actual: <length>{${e2.length}}`, { lengths: e2 });
  return new d$15(e2[0], e2[1], e2[2] || 0, r2 || H$e("black"));
}
function E$y(t2) {
  let e2 = 1, r2 = 0, n2 = 0;
  return j$A(t2.parameters, 3), t2.parameters[0] && (e2 = M$q(t2.parameters[0])), t2.parameters[1] && (r2 = T$r(t2.parameters[1]), O$o(r2, t2.parameters[1])), t2.parameters[2] && (n2 = M$q(t2.parameters[2])), new c$1Y(e2, r2, n2);
}
function j$A(t2, e2) {
  if (t2.length > e2)
    throw new s$2u("effect:type-error", `Function supports up to ${e2} parameters, Actual: ${t2.length}`, { parameters: t2 });
}
function $$b(t2) {
  if (t2.type === "color")
    return "<color>";
  if (t2.unit) {
    if (R$q[t2.unit])
      return "<length>";
    if (S$z[t2.unit])
      return "<angle>";
    if (t2.unit === "%")
      return "<percentage>";
  }
  return "<double>";
}
function O$o(t2, e2) {
  if (t2 < 0)
    throw new s$2u("effect:type-error", `Negative values are not allowed, Actual: ${t2}`, { term: e2 });
}
function k$n(t2) {
  if (t2.type !== "quantity" || t2.unit !== null)
    throw new s$2u("effect:type-error", `Expected <double>, Actual: ${$$b(t2)}`, { term: t2 });
}
function q$i(t2) {
  if (t2.type !== "quantity" || t2.unit !== null && t2.unit !== "%")
    throw new s$2u("effect:type-error", `Expected <double> or <percentage>, Actual: ${$$b(t2)}`, { term: t2 });
}
g$S = function() {
  function t2(t3, e3) {
    function r3() {
      this.constructor = t3;
    }
    r3.prototype = e3.prototype, t3.prototype = new r3();
  }
  function e2(t3, r3, n3, u2) {
    var a2 = Error.call(this, t3);
    return Object.setPrototypeOf && Object.setPrototypeOf(a2, e2.prototype), a2.expected = r3, a2.found = n3, a2.location = u2, a2.name = "SyntaxError", a2;
  }
  function r2(t3, e3, r3) {
    return r3 = r3 || " ", t3.length > e3 ? t3 : (e3 -= t3.length, t3 + (r3 += r3.repeat(e3)).slice(0, e3));
  }
  function n2(t3, r3) {
    var n3, u2 = {}, a2 = (r3 = r3 !== void 0 ? r3 : {}).grammarSource, o2 = { start: Lt2 }, c2 = Lt2, i2 = "none", l2 = ")", s2 = ",", f2 = "(", p2 = "%", h2 = "px", m2 = "cm", g2 = "mm", v2 = "in", d2 = "pt", y2 = "pc", A2 = "deg", w2 = "rad", x2 = "grad", b2 = "turn", C2 = "#", F2 = ".", E2 = "e", j2 = /^[ \t\n\r]/, $2 = /^[a-z\-]/, O2 = /^[0-9a-fA-F]/, k2 = /^[+\-]/, q2 = /^[0-9]/, S2 = Bt2("none"), z2 = Ut2("none", false), R2 = Ut2(")", false), I2 = Ut2(",", false), M2 = Bt2("whitespace"), P2 = Ht([" ", "	", "\n", "\r"], false, false), N2 = Bt2("function"), T2 = Ut2("(", false), U2 = Bt2("identifier"), H2 = Ht([["a", "z"], "-"], false, false), _2 = Bt2("percentage"), B2 = Ut2("%", false), D2 = Bt2("length"), G2 = Ut2("px", false), J2 = Ut2("cm", false), K2 = Ut2("mm", false), L2 = Ut2("in", false), Q2 = Ut2("pt", false), V2 = Ut2("pc", false), W2 = Bt2("angle"), X2 = Ut2("deg", false), Y2 = Ut2("rad", false), Z2 = Ut2("grad", false), tt2 = Ut2("turn", false), et2 = Bt2("number"), rt2 = Bt2("color"), nt2 = Ut2("#", false), ut2 = Ht([["0", "9"], ["a", "f"], ["A", "F"]], false, false), at2 = Ht(["+", "-"], false, false), ot2 = Ht([["0", "9"]], false, false), ct2 = Ut2(".", false), it2 = Ut2("e", false), lt2 = function() {
      return [];
    }, st2 = function(t4, e3) {
      return { type: "function", name: t4, parameters: e3 || [] };
    }, ft2 = function(t4, e3) {
      return e3.length > 0 ? le2(t4, e3, 3) : [t4];
    }, pt2 = function(t4) {
      return { type: "quantity", value: t4.value, unit: t4.unit };
    }, ht2 = function(t4) {
      return { type: "color", colorType: t4.type, value: t4.value };
    }, mt2 = function(t4) {
      return t4;
    }, gt2 = function() {
      return Tt2();
    }, vt2 = function(t4) {
      return { value: t4, unit: "%" };
    }, dt2 = function(t4) {
      return { value: t4, unit: "px" };
    }, yt2 = function(t4) {
      return { value: t4, unit: "cm" };
    }, At2 = function(t4) {
      return { value: t4, unit: "mm" };
    }, wt2 = function(t4) {
      return { value: t4, unit: "in" };
    }, xt2 = function(t4) {
      return { value: t4, unit: "pt" };
    }, bt2 = function(t4) {
      return { value: t4, unit: "pc" };
    }, Ct2 = function(t4) {
      return { value: t4, unit: "deg" };
    }, Ft2 = function(t4) {
      return { value: t4, unit: "rad" };
    }, Et2 = function(t4) {
      return { value: t4, unit: "grad" };
    }, jt2 = function(t4) {
      return { value: t4, unit: "turn" };
    }, $t2 = function(t4) {
      return { value: t4, unit: null };
    }, Ot2 = function() {
      return { type: "hex", value: Tt2() };
    }, kt2 = function(t4) {
      return { type: "function", value: t4 };
    }, qt2 = function() {
      return { type: "named", value: Tt2() };
    }, St2 = function() {
      return parseFloat(Tt2());
    }, zt = 0, Rt2 = 0, It2 = [{ line: 1, column: 1 }], Mt2 = 0, Pt2 = [], Nt2 = 0;
    if ("startRule" in r3) {
      if (!(r3.startRule in o2))
        throw new Error(`Can't start parsing from rule "` + r3.startRule + '".');
      c2 = o2[r3.startRule];
    }
    function Tt2() {
      return t3.substring(Rt2, zt);
    }
    function Ut2(t4, e3) {
      return { type: "literal", text: t4, ignoreCase: e3 };
    }
    function Ht(t4, e3, r4) {
      return { type: "class", parts: t4, inverted: e3, ignoreCase: r4 };
    }
    function _t() {
      return { type: "end" };
    }
    function Bt2(t4) {
      return { type: "other", description: t4 };
    }
    function Dt(e3) {
      var r4, n4 = It2[e3];
      if (n4)
        return n4;
      for (r4 = e3 - 1; !It2[r4]; )
        r4--;
      for (n4 = { line: (n4 = It2[r4]).line, column: n4.column }; r4 < e3; )
        t3.charCodeAt(r4) === 10 ? (n4.line++, n4.column = 1) : n4.column++, r4++;
      return It2[e3] = n4, n4;
    }
    function Gt2(t4, e3) {
      var r4 = Dt(t4), n4 = Dt(e3);
      return { source: a2, start: { offset: t4, line: r4.line, column: r4.column }, end: { offset: e3, line: n4.line, column: n4.column } };
    }
    function Jt2(t4) {
      zt < Mt2 || (zt > Mt2 && (Mt2 = zt, Pt2 = []), Pt2.push(t4));
    }
    function Kt(t4, r4, n4) {
      return new e2(e2.buildMessage(t4, r4), t4, r4, n4);
    }
    function Lt2() {
      var t4;
      return (t4 = Qt()) === u2 && (t4 = Vt()), t4;
    }
    function Qt() {
      var e3, r4;
      return Nt2++, e3 = zt, Zt(), t3.substr(zt, 4) === i2 ? (r4 = i2, zt += 4) : (r4 = u2, Nt2 === 0 && Jt2(z2)), r4 !== u2 ? (Zt(), Rt2 = e3, e3 = lt2()) : (zt = e3, e3 = u2), Nt2--, e3 === u2 && Nt2 === 0 && Jt2(S2), e3;
    }
    function Vt() {
      var t4, e3;
      if (t4 = [], (e3 = Wt()) !== u2)
        for (; e3 !== u2; )
          t4.push(e3), e3 = Wt();
      else
        t4 = u2;
      return t4;
    }
    function Wt() {
      var e3, r4, n4, a3;
      return e3 = zt, Zt(), (r4 = te2()) !== u2 ? (Zt(), (n4 = Xt()) === u2 && (n4 = null), Zt(), t3.charCodeAt(zt) === 41 ? (a3 = l2, zt++) : (a3 = u2, Nt2 === 0 && Jt2(R2)), a3 !== u2 ? (Zt(), Rt2 = e3, e3 = st2(r4, n4)) : (zt = e3, e3 = u2)) : (zt = e3, e3 = u2), e3;
    }
    function Xt() {
      var e3, r4, n4, a3, o3, c3, i3, l3;
      if (e3 = zt, (r4 = Yt()) !== u2) {
        for (n4 = [], a3 = zt, o3 = Zt(), t3.charCodeAt(zt) === 44 ? (c3 = s2, zt++) : (c3 = u2, Nt2 === 0 && Jt2(I2)), c3 === u2 && (c3 = null), i3 = Zt(), (l3 = Yt()) !== u2 ? a3 = o3 = [o3, c3, i3, l3] : (zt = a3, a3 = u2); a3 !== u2; )
          n4.push(a3), a3 = zt, o3 = Zt(), t3.charCodeAt(zt) === 44 ? (c3 = s2, zt++) : (c3 = u2, Nt2 === 0 && Jt2(I2)), c3 === u2 && (c3 = null), i3 = Zt(), (l3 = Yt()) !== u2 ? a3 = o3 = [o3, c3, i3, l3] : (zt = a3, a3 = u2);
        Rt2 = e3, e3 = ft2(r4, n4);
      } else
        zt = e3, e3 = u2;
      return e3;
    }
    function Yt() {
      var t4, e3;
      return t4 = zt, (e3 = re2()) === u2 && (e3 = ne2()) === u2 && (e3 = ue2()) === u2 && (e3 = ae2()), e3 !== u2 && (Rt2 = t4, e3 = pt2(e3)), (t4 = e3) === u2 && (t4 = zt, (e3 = oe2()) !== u2 && (Rt2 = t4, e3 = ht2(e3)), t4 = e3), t4;
    }
    function Zt() {
      var e3, r4;
      for (Nt2++, e3 = [], j2.test(t3.charAt(zt)) ? (r4 = t3.charAt(zt), zt++) : (r4 = u2, Nt2 === 0 && Jt2(P2)); r4 !== u2; )
        e3.push(r4), j2.test(t3.charAt(zt)) ? (r4 = t3.charAt(zt), zt++) : (r4 = u2, Nt2 === 0 && Jt2(P2));
      return Nt2--, r4 = u2, Nt2 === 0 && Jt2(M2), e3;
    }
    function te2() {
      var e3, r4, n4;
      return Nt2++, e3 = zt, (r4 = ee2()) !== u2 ? (t3.charCodeAt(zt) === 40 ? (n4 = f2, zt++) : (n4 = u2, Nt2 === 0 && Jt2(T2)), n4 !== u2 ? (Rt2 = e3, e3 = mt2(r4)) : (zt = e3, e3 = u2)) : (zt = e3, e3 = u2), Nt2--, e3 === u2 && (r4 = u2, Nt2 === 0 && Jt2(N2)), e3;
    }
    function ee2() {
      var e3, r4, n4;
      if (Nt2++, e3 = zt, r4 = [], $2.test(t3.charAt(zt)) ? (n4 = t3.charAt(zt), zt++) : (n4 = u2, Nt2 === 0 && Jt2(H2)), n4 !== u2)
        for (; n4 !== u2; )
          r4.push(n4), $2.test(t3.charAt(zt)) ? (n4 = t3.charAt(zt), zt++) : (n4 = u2, Nt2 === 0 && Jt2(H2));
      else
        r4 = u2;
      return r4 !== u2 && (Rt2 = e3, r4 = gt2()), Nt2--, (e3 = r4) === u2 && (r4 = u2, Nt2 === 0 && Jt2(U2)), e3;
    }
    function re2() {
      var e3, r4, n4;
      return Nt2++, e3 = zt, Zt(), (r4 = ce2()) !== u2 ? (t3.charCodeAt(zt) === 37 ? (n4 = p2, zt++) : (n4 = u2, Nt2 === 0 && Jt2(B2)), n4 !== u2 ? (Rt2 = e3, e3 = vt2(r4)) : (zt = e3, e3 = u2)) : (zt = e3, e3 = u2), Nt2--, e3 === u2 && Nt2 === 0 && Jt2(_2), e3;
    }
    function ne2() {
      var e3, r4, n4;
      return Nt2++, e3 = zt, Zt(), (r4 = ce2()) !== u2 ? (t3.substr(zt, 2) === h2 ? (n4 = h2, zt += 2) : (n4 = u2, Nt2 === 0 && Jt2(G2)), n4 !== u2 ? (Rt2 = e3, e3 = dt2(r4)) : (zt = e3, e3 = u2)) : (zt = e3, e3 = u2), e3 === u2 && (e3 = zt, Zt(), (r4 = ce2()) !== u2 ? (t3.substr(zt, 2) === m2 ? (n4 = m2, zt += 2) : (n4 = u2, Nt2 === 0 && Jt2(J2)), n4 !== u2 ? (Rt2 = e3, e3 = yt2(r4)) : (zt = e3, e3 = u2)) : (zt = e3, e3 = u2), e3 === u2 && (e3 = zt, Zt(), (r4 = ce2()) !== u2 ? (t3.substr(zt, 2) === g2 ? (n4 = g2, zt += 2) : (n4 = u2, Nt2 === 0 && Jt2(K2)), n4 !== u2 ? (Rt2 = e3, e3 = At2(r4)) : (zt = e3, e3 = u2)) : (zt = e3, e3 = u2), e3 === u2 && (e3 = zt, Zt(), (r4 = ce2()) !== u2 ? (t3.substr(zt, 2) === v2 ? (n4 = v2, zt += 2) : (n4 = u2, Nt2 === 0 && Jt2(L2)), n4 !== u2 ? (Rt2 = e3, e3 = wt2(r4)) : (zt = e3, e3 = u2)) : (zt = e3, e3 = u2), e3 === u2 && (e3 = zt, Zt(), (r4 = ce2()) !== u2 ? (t3.substr(zt, 2) === d2 ? (n4 = d2, zt += 2) : (n4 = u2, Nt2 === 0 && Jt2(Q2)), n4 !== u2 ? (Rt2 = e3, e3 = xt2(r4)) : (zt = e3, e3 = u2)) : (zt = e3, e3 = u2), e3 === u2 && (e3 = zt, Zt(), (r4 = ce2()) !== u2 ? (t3.substr(zt, 2) === y2 ? (n4 = y2, zt += 2) : (n4 = u2, Nt2 === 0 && Jt2(V2)), n4 !== u2 ? (Rt2 = e3, e3 = bt2(r4)) : (zt = e3, e3 = u2)) : (zt = e3, e3 = u2)))))), Nt2--, e3 === u2 && Nt2 === 0 && Jt2(D2), e3;
    }
    function ue2() {
      var e3, r4, n4;
      return Nt2++, e3 = zt, (r4 = ce2()) !== u2 ? (t3.substr(zt, 3) === A2 ? (n4 = A2, zt += 3) : (n4 = u2, Nt2 === 0 && Jt2(X2)), n4 !== u2 ? (Rt2 = e3, e3 = Ct2(r4)) : (zt = e3, e3 = u2)) : (zt = e3, e3 = u2), e3 === u2 && (e3 = zt, (r4 = ce2()) !== u2 ? (t3.substr(zt, 3) === w2 ? (n4 = w2, zt += 3) : (n4 = u2, Nt2 === 0 && Jt2(Y2)), n4 !== u2 ? (Rt2 = e3, e3 = Ft2(r4)) : (zt = e3, e3 = u2)) : (zt = e3, e3 = u2), e3 === u2 && (e3 = zt, (r4 = ce2()) !== u2 ? (t3.substr(zt, 4) === x2 ? (n4 = x2, zt += 4) : (n4 = u2, Nt2 === 0 && Jt2(Z2)), n4 !== u2 ? (Rt2 = e3, e3 = Et2(r4)) : (zt = e3, e3 = u2)) : (zt = e3, e3 = u2), e3 === u2 && (e3 = zt, (r4 = ce2()) !== u2 ? (t3.substr(zt, 4) === b2 ? (n4 = b2, zt += 4) : (n4 = u2, Nt2 === 0 && Jt2(tt2)), n4 !== u2 ? (Rt2 = e3, e3 = jt2(r4)) : (zt = e3, e3 = u2)) : (zt = e3, e3 = u2)))), Nt2--, e3 === u2 && (r4 = u2, Nt2 === 0 && Jt2(W2)), e3;
    }
    function ae2() {
      var t4, e3;
      return Nt2++, t4 = zt, Zt(), (e3 = ce2()) !== u2 ? (Rt2 = t4, t4 = $t2(e3)) : (zt = t4, t4 = u2), Nt2--, t4 === u2 && Nt2 === 0 && Jt2(et2), t4;
    }
    function oe2() {
      var e3, r4, n4, a3;
      if (Nt2++, e3 = zt, t3.charCodeAt(zt) === 35 ? (r4 = C2, zt++) : (r4 = u2, Nt2 === 0 && Jt2(nt2)), r4 !== u2) {
        if (n4 = [], O2.test(t3.charAt(zt)) ? (a3 = t3.charAt(zt), zt++) : (a3 = u2, Nt2 === 0 && Jt2(ut2)), a3 !== u2)
          for (; a3 !== u2; )
            n4.push(a3), O2.test(t3.charAt(zt)) ? (a3 = t3.charAt(zt), zt++) : (a3 = u2, Nt2 === 0 && Jt2(ut2));
        else
          n4 = u2;
        n4 !== u2 ? (Rt2 = e3, e3 = Ot2()) : (zt = e3, e3 = u2);
      } else
        zt = e3, e3 = u2;
      return e3 === u2 && (e3 = zt, (r4 = Wt()) !== u2 && (Rt2 = e3, r4 = kt2(r4)), (e3 = r4) === u2 && (e3 = zt, (r4 = ee2()) !== u2 && (Rt2 = e3, r4 = qt2()), e3 = r4)), Nt2--, e3 === u2 && (r4 = u2, Nt2 === 0 && Jt2(rt2)), e3;
    }
    function ce2() {
      var e3, r4, n4, a3, o3, c3, i3;
      for (e3 = zt, k2.test(t3.charAt(zt)) ? (t3.charAt(zt), zt++) : Nt2 === 0 && Jt2(at2), r4 = zt, n4 = [], q2.test(t3.charAt(zt)) ? (a3 = t3.charAt(zt), zt++) : (a3 = u2, Nt2 === 0 && Jt2(ot2)); a3 !== u2; )
        n4.push(a3), q2.test(t3.charAt(zt)) ? (a3 = t3.charAt(zt), zt++) : (a3 = u2, Nt2 === 0 && Jt2(ot2));
      if (t3.charCodeAt(zt) === 46 ? (a3 = F2, zt++) : (a3 = u2, Nt2 === 0 && Jt2(ct2)), a3 !== u2) {
        if (o3 = [], q2.test(t3.charAt(zt)) ? (c3 = t3.charAt(zt), zt++) : (c3 = u2, Nt2 === 0 && Jt2(ot2)), c3 !== u2)
          for (; c3 !== u2; )
            o3.push(c3), q2.test(t3.charAt(zt)) ? (c3 = t3.charAt(zt), zt++) : (c3 = u2, Nt2 === 0 && Jt2(ot2));
        else
          o3 = u2;
        o3 !== u2 ? r4 = n4 = [n4, a3, o3] : (zt = r4, r4 = u2);
      } else
        zt = r4, r4 = u2;
      if (r4 === u2)
        if (r4 = [], q2.test(t3.charAt(zt)) ? (n4 = t3.charAt(zt), zt++) : (n4 = u2, Nt2 === 0 && Jt2(ot2)), n4 !== u2)
          for (; n4 !== u2; )
            r4.push(n4), q2.test(t3.charAt(zt)) ? (n4 = t3.charAt(zt), zt++) : (n4 = u2, Nt2 === 0 && Jt2(ot2));
        else
          r4 = u2;
      if (r4 !== u2) {
        if (n4 = zt, t3.charCodeAt(zt) === 101 ? (a3 = E2, zt++) : (a3 = u2, Nt2 === 0 && Jt2(it2)), a3 !== u2) {
          if (k2.test(t3.charAt(zt)) ? (o3 = t3.charAt(zt), zt++) : (o3 = u2, Nt2 === 0 && Jt2(at2)), o3 === u2 && (o3 = null), c3 = [], q2.test(t3.charAt(zt)) ? (i3 = t3.charAt(zt), zt++) : (i3 = u2, Nt2 === 0 && Jt2(ot2)), i3 !== u2)
            for (; i3 !== u2; )
              c3.push(i3), q2.test(t3.charAt(zt)) ? (i3 = t3.charAt(zt), zt++) : (i3 = u2, Nt2 === 0 && Jt2(ot2));
          else
            c3 = u2;
          c3 !== u2 ? n4 = a3 = [a3, o3, c3] : (zt = n4, n4 = u2);
        } else
          zt = n4, n4 = u2;
        n4 === u2 && (n4 = null), Rt2 = e3, e3 = St2();
      } else
        zt = e3, e3 = u2;
      return e3;
    }
    function ie2(t4, e3) {
      return t4.map(function(t5) {
        return t5[e3];
      });
    }
    function le2(t4, e3, r4) {
      return [t4].concat(ie2(e3, r4));
    }
    if ((n3 = c2()) !== u2 && zt === t3.length)
      return n3;
    throw n3 !== u2 && zt < t3.length && Jt2(_t()), Kt(Pt2, Mt2 < t3.length ? t3.charAt(Mt2) : null, Mt2 < t3.length ? Gt2(Mt2, Mt2 + 1) : Gt2(Mt2, Mt2));
  }
  return t2(e2, Error), e2.prototype.format = function(t3) {
    var e3 = "Error: " + this.message;
    if (this.location) {
      var n3, u2 = null;
      for (n3 = 0; n3 < t3.length; n3++)
        if (t3[n3].source === this.location.source) {
          u2 = t3[n3].text.split(/\r\n|\n|\r/g);
          break;
        }
      var a2 = this.location.start, o2 = this.location.source + ":" + a2.line + ":" + a2.column;
      if (u2) {
        var c2 = this.location.end, i2 = r2("", a2.line.toString().length, " "), l2 = u2[a2.line - 1], s2 = (a2.line === c2.line ? c2.column : l2.length + 1) - a2.column || 1;
        e3 += "\n --> " + o2 + "\n" + i2 + " |\n" + a2.line + " | " + l2 + "\n" + i2 + " | " + r2("", a2.column - 1, " ") + r2("", s2, "^");
      } else
        e3 += "\n at " + o2;
    }
    return e3;
  }, e2.buildMessage = function(t3, e3) {
    var r3 = { literal: function(t4) {
      return '"' + u2(t4.text) + '"';
    }, class: function(t4) {
      var e4 = t4.parts.map(function(t5) {
        return Array.isArray(t5) ? a2(t5[0]) + "-" + a2(t5[1]) : a2(t5);
      });
      return "[" + (t4.inverted ? "^" : "") + e4.join("") + "]";
    }, any: function() {
      return "any character";
    }, end: function() {
      return "end of input";
    }, other: function(t4) {
      return t4.description;
    } };
    function n3(t4) {
      return t4.charCodeAt(0).toString(16).toUpperCase();
    }
    function u2(t4) {
      return t4.replace(/\\/g, "\\\\").replace(/"/g, '\\"').replace(/\0/g, "\\0").replace(/\t/g, "\\t").replace(/\n/g, "\\n").replace(/\r/g, "\\r").replace(/[\x00-\x0F]/g, function(t5) {
        return "\\x0" + n3(t5);
      }).replace(/[\x10-\x1F\x7F-\x9F]/g, function(t5) {
        return "\\x" + n3(t5);
      });
    }
    function a2(t4) {
      return t4.replace(/\\/g, "\\\\").replace(/\]/g, "\\]").replace(/\^/g, "\\^").replace(/-/g, "\\-").replace(/\0/g, "\\0").replace(/\t/g, "\\t").replace(/\n/g, "\\n").replace(/\r/g, "\\r").replace(/[\x00-\x0F]/g, function(t5) {
        return "\\x0" + n3(t5);
      }).replace(/[\x10-\x1F\x7F-\x9F]/g, function(t5) {
        return "\\x" + n3(t5);
      });
    }
    function o2(t4) {
      return r3[t4.type](t4);
    }
    function c2(t4) {
      var e4, r4, n4 = t4.map(o2);
      if (n4.sort(), n4.length > 0) {
        for (e4 = 1, r4 = 1; e4 < n4.length; e4++)
          n4[e4 - 1] !== n4[e4] && (n4[r4] = n4[e4], r4++);
        n4.length = r4;
      }
      switch (n4.length) {
        case 1:
          return n4[0];
        case 2:
          return n4[0] + " or " + n4[1];
        default:
          return n4.slice(0, -1).join(", ") + ", or " + n4[n4.length - 1];
      }
    }
    function i2(t4) {
      return t4 ? '"' + u2(t4) + '"' : "end of input";
    }
    return "Expected " + c2(t3) + " but " + i2(e3) + " found.";
  }, { SyntaxError: e2, parse: n2 };
}, (m$1z = v$O).exports && (m$1z.exports = g$S());
const S$z = { deg: 1, grad: 0.9, rad: 180 / Math.PI, turn: 360 };
function z$v(t2) {
  if (t2.type !== "quantity" || !(t2.value === 0 && t2.unit === null || t2.unit && S$z[t2.unit] != null))
    throw new s$2u("effect:type-error", `Expected <angle>, Actual: ${$$b(t2)}`, { term: t2 });
}
const R$q = { px: 1, cm: 96 / 2.54, mm: 96 / 2.54 / 10, in: 96, pc: 16, pt: 96 / 72 };
function I$v(t2) {
  if (t2.type !== "quantity" || !(t2.value === 0 && t2.unit === null || t2.unit && R$q[t2.unit] != null))
    throw new s$2u("effect:type-error", `Expected <length>, Actual: ${$$b(t2)}`, { term: t2 });
}
function M$q(t2) {
  q$i(t2);
  const e2 = t2.value;
  return O$o(e2, t2), t2.unit === "%" ? 0.01 * e2 : e2;
}
function P$p(t2) {
  return k$n(t2), O$o(t2.value, t2), t2.value;
}
function N$k(t2) {
  return z$v(t2), t2.value * S$z[t2.unit] || 0;
}
function T$r(t2) {
  return I$v(t2), t2.value * R$q[t2.unit] || 0;
}
function U$m(e2) {
  switch (e2.colorType) {
    case "hex":
      return i$2B(e2.value);
    case "named":
      return H$e(e2.value);
    case "function":
      return D$k(e2.value);
  }
}
function H$e(t2) {
  if (!r$1C(t2))
    throw new s$2u("effect:unknown-color", `color '${t2}' isn't valid`, { namedColor: t2 });
  return a$2z(t2);
}
const _$w = /^rgba?/i, B$j = /^hsla?/i;
function D$k(t2) {
  if (j$A(t2.parameters, 4), _$w.test(t2.name))
    return [M$q(t2.parameters[0]), M$q(t2.parameters[1]), M$q(t2.parameters[2]), t2.parameters[3] ? M$q(t2.parameters[3]) : 1];
  if (B$j.test(t2.name))
    return o$1T(P$p(t2.parameters[0]), M$q(t2.parameters[1]), M$q(t2.parameters[2]), t2.parameters[3] ? M$q(t2.parameters[3]) : 1);
  throw new s$2u("effect:syntax-error", `Invalid color function '${t2.name}'`, { colorFunction: t2 });
}
function n$1N(e2, t2, r2) {
  var _a2;
  try {
    return c$1X(e2);
  } catch (s2) {
    (_a2 = r2 == null ? void 0 : r2.messages) == null ? void 0 : _a2.push(s2);
  }
  return null;
}
function a$1S(e2, r2, s2, n2) {
  try {
    const n3 = o$1j(e2);
    o$2q(s2, n3, r2);
  } catch (a2) {
    n2.messages && n2.messages.push(a2);
  }
}
function o$1j(e2) {
  const t2 = d$14(e2);
  return t2 ? h$16(t2) ? t2.map((e3) => e3.toJSON()) : t2.map(({ scale: e3, effects: t3 }) => ({ scale: e3, value: t3.map((e4) => e4.toJSON()) })) : null;
}
function c$1X(e2) {
  if (!e2 || e2.length === 0)
    return null;
  if (f$1a(e2)) {
    const t2 = [];
    for (const r2 of e2)
      t2.push({ scale: r2.scale, value: i$21(r2.value) });
    return t2;
  }
  return i$21(e2);
}
function f$1a(e2) {
  const t2 = e2[0];
  return !!t2 && "scale" in t2;
}
function i$21(e2) {
  if (!e2 || !e2.length)
    return "";
  const t2 = [];
  for (const s2 of e2) {
    let e3 = [];
    switch (s2.type) {
      case "grayscale":
      case "sepia":
      case "saturate":
      case "invert":
      case "brightness":
      case "contrast":
      case "opacity":
        e3 = [u$1h(s2, "amount")];
        break;
      case "blur":
        e3 = [u$1h(s2, "radius", "pt")];
        break;
      case "hue-rotate":
        e3 = [u$1h(s2, "angle", "deg")];
        break;
      case "drop-shadow":
        e3 = [u$1h(s2, "xoffset", "pt"), u$1h(s2, "yoffset", "pt"), u$1h(s2, "blurRadius", "pt"), l$1z(s2, "color")];
        break;
      case "bloom":
        e3 = [u$1h(s2, "strength"), u$1h(s2, "radius", "pt"), u$1h(s2, "threshold")];
    }
    const n2 = `${s2.type}(${e3.filter(Boolean).join(" ")})`;
    d$14(n2), t2.push(n2);
  }
  return t2.join(" ");
}
function u$1h(t2, r2, s2) {
  if (t2[r2] == null)
    throw new s$2u("effect:missing-parameter", `Missing parameter '${r2}' in ${t2.type} effect`, { effect: t2 });
  return s2 ? t2[r2] + s2 : "" + t2[r2];
}
function l$1z(t2, r2) {
  if (t2[r2] == null)
    throw new s$2u("effect:missing-parameter", `Missing parameter '${r2}' in ${t2.type} effect`, { effect: t2 });
  const s2 = t2[r2];
  return `rgba(${s2[0] || 0}, ${s2[1] || 0}, ${s2[2] || 0}, ${s2[3] / 255 || 0})`;
}
const s$1r = -3;
var i$20;
!function(t2) {
  t2[t2.ALL = 0] = "ALL", t2[t2.SOME = 1] = "SOME";
}(i$20 || (i$20 = {}));
class r$1b {
  constructor(t2, e2, s2) {
    this._namespace = t2, this._storage = e2, this._removeFunc = false, this._hit = 0, this._miss = 0, this._storage.register(this), this._namespace += ":", s2 && (this._storage.registerRemoveFunc(this._namespace, s2), this._removeFunc = true);
  }
  destroy() {
    this._storage.clear(this._namespace), this._removeFunc && this._storage.deregisterRemoveFunc(this._namespace), this._storage.deregister(this), this._storage = null;
  }
  get namespace() {
    return this._namespace.slice(0, -1);
  }
  get hitRate() {
    return this._hit / (this._hit + this._miss);
  }
  get size() {
    return this._storage.size;
  }
  get maxSize() {
    return this._storage.maxSize;
  }
  resetHitRate() {
    this._hit = this._miss = 0;
  }
  put(t2, e2, s2, i2 = 0) {
    this._storage.put(this._namespace + t2, e2, s2, i2);
  }
  get(t2) {
    const e2 = this._storage.get(this._namespace + t2);
    return e2 === void 0 ? ++this._miss : ++this._hit, e2;
  }
  pop(t2) {
    const e2 = this._storage.pop(this._namespace + t2);
    return e2 === void 0 ? ++this._miss : ++this._hit, e2;
  }
  updateSize(t2, e2, s2) {
    this._storage.updateSize(this._namespace + t2, e2, s2);
  }
  clear() {
    this._storage.clear(this._namespace);
  }
  clearAll() {
    this._storage.clearAll();
  }
  getStats() {
    return this._storage.getStats();
  }
  resetStats() {
    this._storage.resetStats();
  }
}
class h$15 {
  constructor(t2 = 10485760) {
    this._maxSize = t2, this._db = new Map(), this._size = 0, this._hit = 0, this._miss = 0, this._removeFuncs = new l$2F(), this._users = new l$2F();
  }
  destroy() {
    this.clearAll(), this._removeFuncs.clear(), this._users.clear(), this._db = null;
  }
  register(t2) {
    this._users.push(t2);
  }
  deregister(t2) {
    this._users.removeUnordered(t2);
  }
  registerRemoveFunc(t2, e2) {
    this._removeFuncs.push([t2, e2]);
  }
  deregisterRemoveFunc(t2) {
    this._removeFuncs.filterInPlace((e2) => e2[0] !== t2);
  }
  get size() {
    return this._size;
  }
  get maxSize() {
    return this._maxSize;
  }
  set maxSize(t2) {
    this._maxSize = Math.max(t2, 0), this._checkSizeLimit();
  }
  put(t2, e2, r2, h2) {
    const _2 = this._db.get(t2);
    if (_2 && (this._size -= _2.size, this._db.delete(t2), _2.entry !== e2 && this._notifyRemove(t2, _2.entry, i$20.ALL)), r2 > this._maxSize)
      return void this._notifyRemove(t2, e2, i$20.ALL);
    if (e2 === void 0)
      return void console.warn("Refusing to cache undefined entry ");
    if (!r2 || r2 < 0)
      return void console.warn("Refusing to cache entry with invalid size " + r2);
    const o2 = 1 + Math.max(h2, s$1r) - s$1r;
    this._db.set(t2, { entry: e2, size: r2, lifetime: o2, lives: o2 }), this._size += r2, this._checkSizeLimit();
  }
  updateSize(e2, s2, r2) {
    const h2 = this._db.get(e2);
    if (h2 && h2.entry === s2) {
      for (this._size -= h2.size; r2 > this._maxSize; ) {
        const h3 = this._notifyRemove(e2, s2, i$20.SOME);
        if (!(r$1$(h3) && h3 > 0))
          return void this._db.delete(e2);
        r2 = h3;
      }
      h2.size = r2, this._size += r2, this._checkSizeLimit();
    }
  }
  pop(t2) {
    const e2 = this._db.get(t2);
    if (e2)
      return this._size -= e2.size, this._db.delete(t2), ++this._hit, e2.entry;
    ++this._miss;
  }
  get(t2) {
    const e2 = this._db.get(t2);
    if (e2 !== void 0)
      return this._db.delete(t2), e2.lives = e2.lifetime, this._db.set(t2, e2), ++this._hit, e2.entry;
    ++this._miss;
  }
  getStats() {
    const t2 = { Size: Math.round(this._size / 1048576) + "/" + Math.round(this._maxSize / 1048576) + "MB", "Hit rate": Math.round(100 * this._getHitRate()) + "%", Entries: this._db.size.toString() }, e2 = {}, i2 = new Array();
    this._db.forEach((t3, s2) => {
      const r3 = t3.lifetime;
      i2[r3] = (i2[r3] || 0) + t3.size, this._users.forAll((i3) => {
        const r4 = i3.namespace;
        if (s2.startsWith(r4)) {
          const s3 = e2[r4] || 0;
          e2[r4] = s3 + t3.size;
        }
      });
    });
    const r2 = {};
    this._users.forAll((t3) => {
      const s2 = t3.namespace;
      if (!isNaN(t3.hitRate) && t3.hitRate > 0) {
        const i3 = e2[s2] || 0;
        e2[s2] = i3, r2[s2] = Math.round(100 * t3.hitRate) + "%";
      } else
        r2[s2] = "0%";
    });
    const h2 = Object.keys(e2);
    h2.sort((t3, s2) => e2[s2] - e2[t3]), h2.forEach((s2) => t2[s2] = Math.round(e2[s2] / 2 ** 20) + "MB / " + r2[s2]);
    for (let _2 = i2.length - 1; _2 >= 0; --_2) {
      const e3 = i2[_2];
      e3 && (t2["Priority " + (_2 + s$1r - 1)] = Math.round(e3 / this.size * 100) + "%");
    }
    return t2;
  }
  resetStats() {
    this._hit = this._miss = 0, this._users.forAll((t2) => t2.resetHitRate());
  }
  clear(t2) {
    this._db.forEach((e2, s2) => {
      s2.startsWith(t2) && (this._size -= e2.size, this._db.delete(s2), this._notifyRemove(s2, e2.entry, i$20.ALL));
    });
  }
  clearAll() {
    this._db.forEach((t2, e2) => this._notifyRemove(e2, t2.entry, i$20.ALL)), this._size = 0, this._db.clear();
  }
  _getHitRate() {
    return this._hit / (this._hit + this._miss);
  }
  _notifyRemove(t2, e2, s2) {
    let i2;
    return this._removeFuncs.some((r2) => {
      if (t2.startsWith(r2[0])) {
        const t3 = r2[1](e2, s2);
        return typeof t3 == "number" && (i2 = t3), true;
      }
      return false;
    }), i2;
  }
  _checkSizeLimit() {
    if (!(this._size <= this._maxSize))
      for (const [e2, s2] of this._db) {
        if (this._db.delete(e2), s2.lives <= 1) {
          this._size -= s2.size;
          const r2 = this._notifyRemove(e2, s2.entry, i$20.SOME);
          r$1$(r2) && r2 > 0 && (this._size += r2, s2.lives = s2.lifetime, s2.size = r2, this._db.set(e2, s2));
        } else
          --s2.lives, this._db.set(e2, s2);
        if (this._size <= 0.9 * this.maxSize)
          return;
      }
  }
}
class e$17 {
  constructor(e2, s2) {
    this._storage = new h$15(), this._storage.maxSize = e2, s2 && this._storage.registerRemoveFunc("", s2);
  }
  put(t2, e2) {
    this._storage.put(t2, e2, 1, 1);
  }
  pop(t2) {
    return this._storage.pop(t2);
  }
  get(t2) {
    return this._storage.get(t2);
  }
  clear() {
    this._storage.clearAll();
  }
  destroy() {
    this._storage.destroy();
  }
}
new e$17(1e3);
new l$2e([128, 128, 128]);
const p$2g = /\/resource\/(.*?)\.svg$/, h$14 = new l$2e("white");
function d$13(e2) {
  if (t$2r(e2) || !("symbolLayers" in e2) || t$2r(e2.symbolLayers))
    return false;
  switch (e2.type) {
    case "point-3d":
      return e2.symbolLayers.some((e3) => e3.type === "object");
    case "line-3d":
      return e2.symbolLayers.some((e3) => e3.type === "path");
    case "polygon-3d":
      return e2.symbolLayers.some((e3) => e3.type === "object" || e3.type === "extrude");
    default:
      return false;
  }
}
function g$R(e2, t2) {
  const o2 = f$21(t2.resource).href;
  return !has("esri-canvas-svg-support") && e2.styleOrigin && p$2g.test(o2) ? o2.replace(p$2g, "/resource/png/$1.png") : o2;
}
function j$z(r2, n2) {
  if (!r2)
    return null;
  let l2 = null;
  return c$2k(r2) ? l2 = k$m(r2) : x$N(r2) && (l2 = r2.color ? new l$2e(r2.color) : null), l2 ? L$m(l2, n2) : null;
}
function k$m(t2) {
  const o2 = t2.symbolLayers;
  if (!o2)
    return null;
  let r2 = null;
  return o2.forEach((e2) => {
    var _a2;
    e2.type === "object" && ((_a2 = e2.resource) == null ? void 0 : _a2.href) != null || (r2 = e2.type === "water" ? e$2e(e2.color) : r$1$(e2.material) ? e$2e(e2.material.color) : null);
  }), r2 ? new l$2e(r2) : null;
}
function L$m(t2, o2) {
  if (o2 == null || t2 == null)
    return t2;
  const r2 = t2.toRgba();
  return r2[3] = r2[3] * o2, new l$2e(r2);
}
function z$u(e2, t2, o2) {
  const r2 = e2.symbolLayers;
  if (!r2)
    return;
  const i2 = (e3) => {
    var _a2;
    const r3 = r$1$(e3) ? e3 : null;
    return L$m(t2 = (_a2 = t2 != null ? t2 : r3) != null ? _a2 : o2 != null ? h$14 : null, o2);
  };
  r2.forEach((e3) => {
    var _a2;
    if (e3.type !== "object" || ((_a2 = e3.resource) == null ? void 0 : _a2.href) == null || t2)
      if (e3.type === "water")
        e3.color = i2(e3.color);
      else {
        const t3 = r$1$(e3.material) ? e3.material.color : null, r3 = i2(t3);
        t$2r(e3.material) ? e3.material = new l$2a({ color: r3 }) : e3.material.color = r3, o2 != null && "outline" in e3 && r$1$(e3.outline) && r$1$(e3.outline.color) && (e3.outline.color = L$m(e3.outline.color, o2));
      }
  });
}
function v$N(e2, t2, o2) {
  (t2 = t2 != null ? t2 : e2.color) && (e2.color = L$m(t2, o2)), o2 != null && "outline" in e2 && e2.outline && e2.outline.color && (e2.outline.color = L$m(e2.outline.color, o2));
}
function x$D(r2, n2, l2) {
  r2 && (n2 || l2 != null) && (n2 && (n2 = new l$2e(n2)), c$2k(r2) ? z$u(r2, n2, l2) : x$N(r2) && v$N(r2, n2, l2));
}
async function S$y(e2, t2) {
  const o2 = e2.symbolLayers;
  o2 && await c$1_(o2, async (e3) => U$l(e3, t2));
}
async function U$l(e2, t2) {
  switch (e2.type) {
    case "extrude":
      R$p(e2, t2);
      break;
    case "icon":
    case "line":
    case "text":
      O$n(e2, t2);
      break;
    case "path":
      A$i(e2, t2);
      break;
    case "object":
      await $$a(e2, t2);
  }
}
function O$n(e2, t2) {
  const o2 = E$x(t2);
  r$1$(o2) && (e2.size = o2);
}
function E$x(e2) {
  for (const t2 of e2)
    if (typeof t2 == "number")
      return t2;
  return null;
}
function R$p(e2, t2) {
  e2.size = typeof t2[2] == "number" ? t2[2] : 0;
}
async function $$a(e2, t2) {
  const { resourceSize: o2, symbolSize: r2 } = await D$j(e2), n2 = C$s(t2, o2, r2);
  e2.width = I$u(t2[0], r2[0], o2[0], n2), e2.depth = I$u(t2[1], r2[1], o2[1], n2), e2.height = I$u(t2[2], r2[2], o2[2], n2);
}
function A$i(e2, t2) {
  const o2 = C$s(t2, l$2i, [e2.width, void 0, e2.height]);
  e2.width = I$u(t2[0], e2.width, 1, o2), e2.height = I$u(t2[2], e2.height, 1, o2);
}
function C$s(e2, t2, o2) {
  for (let r2 = 0; r2 < 3; r2++) {
    const n2 = e2[r2];
    switch (n2) {
      case "symbol-value": {
        const e3 = o2[r2];
        return e3 != null ? e3 / t2[r2] : 1;
      }
      case "proportional":
        break;
      default:
        if (n2 && t2[r2])
          return n2 / t2[r2];
    }
  }
  return 1;
}
async function D$j(e2) {
  const t2 = await import("./symbolLayerUtils.js"), o2 = await t2.computeObjectLayerResourceSize(e2, 10), { width: r2, height: n2, depth: l2 } = e2, i2 = [r2, l2, n2];
  let s2 = 1;
  for (let c2 = 0; c2 < 3; c2++) {
    const e3 = i2[c2];
    if (e3 != null) {
      s2 = e3 / o2[c2];
      break;
    }
  }
  for (let c2 = 0; c2 < 3; c2++)
    i2[c2] == null && (i2[c2] = o2[c2] * s2);
  return { resourceSize: o2, symbolSize: i2 };
}
function I$u(e2, t2, o2, r2) {
  switch (e2) {
    case "proportional":
      return o2 * r2;
    case "symbol-value":
      return t2 != null ? t2 : o2;
    default:
      return e2;
  }
}
function J$i(e2, t2) {
  const o2 = E$x(t2);
  if (!t$2r(o2))
    switch (e2.type) {
      case "simple-marker":
        e2.size = o2;
        break;
      case "picture-marker": {
        const t3 = e2.width / e2.height;
        t3 > 1 ? (e2.width = o2, e2.height = o2 * t3) : (e2.width = o2 * t3, e2.height = o2);
        break;
      }
      case "simple-line":
        e2.width = o2;
        break;
      case "text":
        e2.font.size = o2;
    }
}
async function M$p(e2, r2) {
  if (e2 && r2)
    return c$2k(e2) ? S$y(e2, r2) : void (x$N(e2) && J$i(e2, r2));
}
function N$j(e2, r2, n2) {
  if (e2 && r2 != null)
    if (c$2k(e2)) {
      const t2 = e2.symbolLayers;
      t2 && t2.forEach((e3) => {
        if (e3 && e3.type === "object")
          switch (n2) {
            case "tilt":
              e3.tilt = r2;
              break;
            case "roll":
              e3.roll = r2;
              break;
            default:
              e3.heading = r2;
          }
      });
    } else
      x$N(e2) && (e2.type !== "simple-marker" && e2.type !== "picture-marker" && e2.type !== "text" || (e2.angle = r2));
}
function B$i(e2) {
  return r$1$(e2) && e2.type === "polygon-3d" && e2.symbolLayers.some((e3) => e3.type === "extrude");
}
const s$1q = "<", i$1$ = ">", r$1a = S$P("short-date");
function o$1i(t2, l2, o2, e2) {
  let n2 = "";
  l2 === 0 ? n2 = `${s$1q} ` : l2 === o2 && (n2 = `${i$1$} `);
  let u2 = null;
  return u2 = e2 ? L$x(t2, r$1a) : c$20(t2), n2 + u2;
}
const o$1h = new l$2e([64, 64, 64]);
function n$1M(l2, o2) {
  const n2 = [], r2 = l2.length - 1;
  return l2.length === 5 ? n2.push(0, 2, 4) : n2.push(0, r2), l2.map((l3, t2) => n2.includes(t2) ? o$1i(l3, t2, r2, o2) : null);
}
async function r$19(l2, e2, o2) {
  let r2 = false, a2 = [], u2 = [];
  if (l2.stops) {
    const e3 = l2.stops;
    a2 = e3.map((l3) => l3.value), r2 = e3.some((l3) => !!l3.label), r2 && (u2 = e3.map((l3) => l3.label));
  }
  const s2 = a2[0], i2 = a2[a2.length - 1];
  if (s2 == null && i2 == null)
    return null;
  const c2 = r2 ? null : n$1M(a2, o2);
  return (await Promise.all(a2.map(async (o3, n2) => ({ value: o3, color: l2.type === "opacity" ? await t$1k(o3, l2, e2) : (await Promise.resolve().then(function() {
    return visualVariableUtils;
  })).getColor(l2, o3), label: r2 ? u2[n2] : c2[n2] })))).reverse();
}
async function t$1k(e2, n2, r2 = o$1h) {
  const t2 = new l$2e(r2), a2 = (await Promise.resolve().then(function() {
    return visualVariableUtils;
  })).getOpacity(n2, e2);
  return a2 != null && (t2.a = a2), t2;
}
var c$1W;
let i$1_ = c$1W = class extends l$2B {
  constructor(o2) {
    super(o2), this.color = null, this.ratio = null;
  }
  clone() {
    return new c$1W({ color: this.color, ratio: this.ratio });
  }
};
e$2g([y$1I({ type: l$2e, json: { type: [T$G], default: null, write: true } })], i$1_.prototype, "color", void 0), e$2g([y$1I({ type: Number, json: { write: true } })], i$1_.prototype, "ratio", void 0), i$1_ = c$1W = e$2g([n$2P("esri.renderers.support.HeatmapColorStop")], i$1_);
const a$1R = i$1_;
function r$18(r2) {
  if (!r2.colorStops)
    return [];
  const e2 = [...r2.colorStops].filter((o2) => {
    var _a2;
    return ((_a2 = o2.color) == null ? void 0 : _a2.a) > 0;
  });
  let t2 = e2.length - 1;
  if (e2 && e2[0]) {
    const r3 = e2[t2];
    r3 && r3.ratio !== 1 && (e2.push(new a$1R({ ratio: 1, color: r3.color })), t2++);
  }
  return e2.map((o2, e3) => {
    var _a2, _b2;
    let l2 = "";
    return e3 === 0 ? l2 = ((_a2 = r2.legendOptions) == null ? void 0 : _a2.minLabel) || "low" : e3 === t2 && (l2 = ((_b2 = r2.legendOptions) == null ? void 0 : _b2.maxLabel) || "high"), { color: o2.color, label: l2, ratio: o2.ratio };
  }).reverse();
}
s$2z.getLogger("esri.renderers.support.utils");
async function h$13(e2, t2, i2) {
  r$1Z(e2, t2, () => []).push(...i2);
}
async function b$L(t2) {
  var _a2, _b2, _c2, _d2;
  const l2 = new Map();
  if (!t2)
    return l2;
  if ("visualVariables" in t2 && t2.visualVariables) {
    const e2 = t2.visualVariables.filter((e3) => e3.type === "color");
    for (const t3 of e2) {
      const e3 = (await r$19(t3)).map((e4) => e4.color);
      await h$13(l2, t3.field || t3.valueExpression, e3);
    }
  }
  if (t2.type === "heatmap") {
    const e2 = r$18(t2).map((e3) => e3.color);
    await h$13(l2, t2.field || t2.valueExpression, e2);
  } else if (t2.type === "pie-chart") {
    for (const e2 of t2.attributes)
      await h$13(l2, e2.field || e2.valueExpression, [e2.color]);
    await h$13(l2, "default", [(_a2 = t2 == null ? void 0 : t2.othersCategory) == null ? void 0 : _a2.color, j$z(t2.backgroundFillSymbol, null)]);
  } else if (t2.type === "dot-density") {
    for (const e2 of t2.attributes)
      await h$13(l2, e2.field || e2.valueExpression, [e2.color]);
    await h$13(l2, "default", [t2.backgroundColor]);
  } else if (t2.type === "unique-value")
    if (((_b2 = t2.authoringInfo) == null ? void 0 : _b2.type) === "predominance")
      for (const e2 of (_c2 = t2.uniqueValueInfos) != null ? _c2 : [])
        await h$13(l2, e2.value.toString(), [j$z(e2.symbol, null)]);
    else {
      const e2 = ((_d2 = t2.uniqueValueInfos) != null ? _d2 : []).map((e3) => j$z(e3.symbol, null)), { field: i2, field2: o2, field3: n2, valueExpression: a2 } = t2;
      (i2 || a2) && await h$13(l2, i2 || a2, e2), o2 && await h$13(l2, o2, e2), n2 && await h$13(l2, n2, e2);
    }
  else if (t2.type === "class-breaks") {
    const e2 = t2.classBreakInfos.map((e3) => j$z(e3.symbol, null)), { field: i2, valueExpression: o2 } = t2;
    await h$13(l2, i2 != null ? i2 : o2, e2);
  } else
    t2.type === "simple" && await h$13(l2, "default", [j$z(t2.symbol, null)]);
  return "defaultSymbol" in t2 && t2.defaultSymbol && await h$13(l2, "default", [j$z(t2.defaultSymbol, null)]), l2.forEach((t3, i2) => {
    const o2 = u$2o(t3.filter(Boolean), (e2, t4) => JSON.stringify(e2) === JSON.stringify(t4));
    l2.set(i2, o2);
  }), l2;
}
var t$1j;
let p$2f = t$1j = class extends l$2B {
  constructor(r2) {
    super(r2), this.name = null, this.code = null;
  }
  clone() {
    return new t$1j({ name: this.name, code: this.code });
  }
};
e$2g([y$1I({ type: String, json: { write: true } })], p$2f.prototype, "name", void 0), e$2g([y$1I({ type: [String, Number], json: { write: true } })], p$2f.prototype, "code", void 0), p$2f = t$1j = e$2g([n$2P("esri.layers.support.CodedValue")], p$2f);
const c$1V = new s$2a({ inherited: "inherited", codedValue: "coded-value", range: "range" });
let a$1Q = class extends l$2B {
  constructor(r2) {
    super(r2), this.name = null, this.type = null;
  }
};
e$2g([y$1I({ type: String, json: { write: true } })], a$1Q.prototype, "name", void 0), e$2g([r$1H(c$1V)], a$1Q.prototype, "type", void 0), a$1Q = e$2g([n$2P("esri.layers.support.Domain")], a$1Q);
const i$1Z = a$1Q;
var d$12;
let p$2e = d$12 = class extends i$1Z {
  constructor(e2) {
    super(e2), this.codedValues = null, this.type = "coded-value";
  }
  getName(e2) {
    let o2 = null;
    if (this.codedValues) {
      const r2 = String(e2);
      this.codedValues.some((e3) => (String(e3.code) === r2 && (o2 = e3.name), !!o2));
    }
    return o2;
  }
  clone() {
    return new d$12({ codedValues: y$1L(this.codedValues), name: this.name });
  }
};
e$2g([y$1I({ type: [p$2f], json: { write: true } })], p$2e.prototype, "codedValues", void 0), e$2g([r$1H({ codedValue: "coded-value" })], p$2e.prototype, "type", void 0), p$2e = d$12 = e$2g([n$2P("esri.layers.support.CodedValueDomain")], p$2e);
const u$1g = p$2e;
var t$1i;
let i$1Y = t$1i = class extends i$1Z {
  constructor(r2) {
    super(r2), this.type = "inherited";
  }
  clone() {
    return new t$1i();
  }
};
e$2g([r$1H({ inherited: "inherited" })], i$1Y.prototype, "type", void 0), i$1Y = t$1i = e$2g([n$2P("esri.layers.support.InheritedDomain")], i$1Y);
const p$2d = i$1Y;
var s$1p;
let n$1L = s$1p = class extends i$1Z {
  constructor(e2) {
    super(e2), this.maxValue = null, this.minValue = null, this.type = "range";
  }
  clone() {
    return new s$1p({ maxValue: this.maxValue, minValue: this.minValue, name: this.name });
  }
};
e$2g([y$1I({ type: Number, json: { type: [Number], read: { source: "range", reader: (e2, r2) => r2.range && r2.range[1] }, write: { enabled: false, overridePolicy() {
  return { enabled: this.maxValue != null && this.minValue == null };
}, target: "range", writer(e2, r2, a2) {
  r2[a2] = [this.minValue || 0, e2];
} } } })], n$1L.prototype, "maxValue", void 0), e$2g([y$1I({ type: Number, json: { type: [Number], read: { source: "range", reader: (e2, r2) => r2.range && r2.range[0] }, write: { target: "range", writer(e2, r2, a2) {
  r2[a2] = [e2, this.maxValue || 0];
} } } })], n$1L.prototype, "minValue", void 0), e$2g([r$1H({ range: "range" })], n$1L.prototype, "type", void 0), n$1L = s$1p = e$2g([n$2P("esri.layers.support.RangeDomain")], n$1L);
const i$1X = n$1L;
const n$1K = { key: "type", base: i$1Z, typeMap: { range: i$1X, "coded-value": u$1g, inherited: p$2d } };
function t$1h(o2) {
  if (!o2 || !o2.type)
    return null;
  switch (o2.type) {
    case "range":
      return i$1X.fromJSON(o2);
    case "codedValue":
      return u$1g.fromJSON(o2);
    case "inherited":
      return p$2d.fromJSON(o2);
  }
  return null;
}
const i$1W = new s$2a({ esriFieldTypeSmallInteger: "small-integer", esriFieldTypeInteger: "integer", esriFieldTypeSingle: "single", esriFieldTypeDouble: "double", esriFieldTypeLong: "long", esriFieldTypeString: "string", esriFieldTypeDate: "date", esriFieldTypeOID: "oid", esriFieldTypeGeometry: "geometry", esriFieldTypeBlob: "blob", esriFieldTypeRaster: "raster", esriFieldTypeGUID: "guid", esriFieldTypeGlobalID: "global-id", esriFieldTypeXML: "xml" });
var u$1f;
const c$1U = new s$2a({ binary: "binary", coordinate: "coordinate", countOrAmount: "count-or-amount", dateAndTime: "date-and-time", description: "description", locationOrPlaceName: "location-or-place-name", measurement: "measurement", nameOrTitle: "name-or-title", none: "none", orderedOrRanked: "ordered-or-ranked", percentageOrRatio: "percentage-or-ratio", typeOrCategory: "type-or-category", uniqueIdentifier: "unique-identifier" });
let m$1y = u$1f = class extends l$2B {
  constructor(e2) {
    super(e2), this.alias = null, this.defaultValue = void 0, this.description = null, this.domain = null, this.editable = true, this.length = -1, this.name = null, this.nullable = true, this.type = null, this.valueType = null, this.visible = true;
  }
  readDescription(e2, { description: t2 }) {
    var _a2;
    let o2 = null;
    try {
      o2 = t2 ? JSON.parse(t2) : null;
    } catch (r2) {
    }
    return (_a2 = o2 == null ? void 0 : o2.value) != null ? _a2 : null;
  }
  readValueType(e2, { description: t2 }) {
    let o2 = null;
    try {
      o2 = t2 ? JSON.parse(t2) : null;
    } catch (r2) {
    }
    return o2 ? c$1U.fromJSON(o2.fieldValueType) : null;
  }
  clone() {
    return new u$1f({ alias: this.alias, defaultValue: this.defaultValue, description: this.description, domain: this.domain && this.domain.clone() || null, editable: this.editable, length: this.length, name: this.name, nullable: this.nullable, type: this.type, valueType: this.valueType, visible: this.visible });
  }
};
e$2g([y$1I({ type: String, json: { write: true } })], m$1y.prototype, "alias", void 0), e$2g([y$1I({ type: [String, Number], json: { write: { allowNull: true } } })], m$1y.prototype, "defaultValue", void 0), e$2g([y$1I()], m$1y.prototype, "description", void 0), e$2g([o$29("description")], m$1y.prototype, "readDescription", null), e$2g([y$1I({ types: n$1K, json: { read: { reader: t$1h }, write: true } })], m$1y.prototype, "domain", void 0), e$2g([y$1I({ type: Boolean, json: { write: true } })], m$1y.prototype, "editable", void 0), e$2g([y$1I({ type: T$G, json: { write: true } })], m$1y.prototype, "length", void 0), e$2g([y$1I({ type: String, json: { write: true } })], m$1y.prototype, "name", void 0), e$2g([y$1I({ type: Boolean, json: { write: true } })], m$1y.prototype, "nullable", void 0), e$2g([r$1H(i$1W)], m$1y.prototype, "type", void 0), e$2g([y$1I()], m$1y.prototype, "valueType", void 0), e$2g([o$29("valueType", ["description"])], m$1y.prototype, "readValueType", null), e$2g([y$1I({ type: Boolean, json: { read: false } })], m$1y.prototype, "visible", void 0), m$1y = u$1f = e$2g([n$2P("esri.layers.support.Field")], m$1y);
const y$Y = m$1y;
var a$1P;
let c$1T = a$1P = class extends l$2B {
  constructor(r2) {
    super(r2), this.type = "map-layer";
  }
  clone() {
    const { mapLayerId: r2, gdbVersion: o2 } = this;
    return new a$1P({ mapLayerId: r2, gdbVersion: o2 });
  }
};
e$2g([r$1H({ mapLayer: "map-layer" })], c$1T.prototype, "type", void 0), e$2g([y$1I({ type: T$G, json: { write: true } })], c$1T.prototype, "mapLayerId", void 0), e$2g([y$1I({ type: String, json: { write: true } })], c$1T.prototype, "gdbVersion", void 0), c$1T = a$1P = e$2g([n$2P("esri.layers.support.source.MapLayerSource")], c$1T);
var c$1S;
let y$X = c$1S = class extends l$2B {
  constructor(e2) {
    super(e2), this.type = "query-table";
  }
  clone() {
    var _a2;
    const { workspaceId: e2, query: r2, oidFields: o2, spatialReference: t2, geometryType: p2 } = this, s2 = { workspaceId: e2, query: r2, oidFields: o2, spatialReference: (_a2 = t2 == null ? void 0 : t2.clone()) != null ? _a2 : void 0, geometryType: p2 };
    return new c$1S(s2);
  }
};
e$2g([r$1H({ queryTable: "query-table" })], y$X.prototype, "type", void 0), e$2g([y$1I({ type: String, json: { write: true } })], y$X.prototype, "workspaceId", void 0), e$2g([y$1I({ type: String, json: { write: true } })], y$X.prototype, "query", void 0), e$2g([y$1I({ type: String, json: { write: true } })], y$X.prototype, "oidFields", void 0), e$2g([y$1I({ type: k$C, json: { write: true } })], y$X.prototype, "spatialReference", void 0), e$2g([r$1H(i$2T)], y$X.prototype, "geometryType", void 0), y$X = c$1S = e$2g([n$2P("esri.layers.support.source.QueryTableDataSource")], y$X);
var p$2c;
let a$1O = p$2c = class extends l$2B {
  constructor(r2) {
    super(r2), this.type = "raster";
  }
  clone() {
    const { workspaceId: r2, dataSourceName: o2 } = this;
    return new p$2c({ workspaceId: r2, dataSourceName: o2 });
  }
};
e$2g([r$1H({ raster: "raster" })], a$1O.prototype, "type", void 0), e$2g([y$1I({ type: String, json: { write: true } })], a$1O.prototype, "dataSourceName", void 0), e$2g([y$1I({ type: String, json: { write: true } })], a$1O.prototype, "workspaceId", void 0), a$1O = p$2c = e$2g([n$2P("esri.layers.support.source.RasterDataSource")], a$1O);
var p$2b;
let a$1N = p$2b = class extends l$2B {
  constructor(r2) {
    super(r2), this.type = "table";
  }
  clone() {
    const { workspaceId: r2, gdbVersion: o2, dataSourceName: e2 } = this;
    return new p$2b({ workspaceId: r2, gdbVersion: o2, dataSourceName: e2 });
  }
};
e$2g([r$1H({ table: "table" })], a$1N.prototype, "type", void 0), e$2g([y$1I({ type: String, json: { write: true } })], a$1N.prototype, "workspaceId", void 0), e$2g([y$1I({ type: String, json: { write: true } })], a$1N.prototype, "gdbVersion", void 0), e$2g([y$1I({ type: String, json: { write: true } })], a$1N.prototype, "dataSourceName", void 0), a$1N = p$2b = e$2g([n$2P("esri.layers.support.source.TableDataSource")], a$1N);
var d$11, m$1x;
const j$y = o$1_()({ esriLeftInnerJoin: "left-inner-join", esriLeftOuterJoin: "left-outer-join" });
let T$q = d$11 = class extends l$2B {
  constructor(e2) {
    super(e2), this.type = "join-table";
  }
  readLeftTableSource(e2, r2, o2) {
    return g$Q()(e2, r2, o2);
  }
  castLeftTableSource(e2) {
    return S$V(L$l(), e2);
  }
  readRightTableSource(e2, r2, o2) {
    return g$Q()(e2, r2, o2);
  }
  castRightTableSource(e2) {
    return S$V(L$l(), e2);
  }
  clone() {
    var _a2, _b2;
    const { leftTableKey: e2, rightTableKey: r2, leftTableSource: o2, rightTableSource: t2, joinType: a2 } = this, s2 = { leftTableKey: e2, rightTableKey: r2, leftTableSource: (_a2 = o2 == null ? void 0 : o2.clone()) != null ? _a2 : void 0, rightTableSource: (_b2 = t2 == null ? void 0 : t2.clone()) != null ? _b2 : void 0, joinType: a2 };
    return new d$11(s2);
  }
};
e$2g([r$1H({ joinTable: "join-table" })], T$q.prototype, "type", void 0), e$2g([y$1I({ type: String, json: { write: true } })], T$q.prototype, "leftTableKey", void 0), e$2g([y$1I({ type: String, json: { write: true } })], T$q.prototype, "rightTableKey", void 0), e$2g([y$1I({ json: { write: true } })], T$q.prototype, "leftTableSource", void 0), e$2g([o$29("leftTableSource")], T$q.prototype, "readLeftTableSource", null), e$2g([s$2i("leftTableSource")], T$q.prototype, "castLeftTableSource", null), e$2g([y$1I({ json: { write: true } })], T$q.prototype, "rightTableSource", void 0), e$2g([o$29("rightTableSource")], T$q.prototype, "readRightTableSource", null), e$2g([s$2i("rightTableSource")], T$q.prototype, "castRightTableSource", null), e$2g([r$1H(j$y)], T$q.prototype, "joinType", void 0), T$q = d$11 = e$2g([n$2P("esri.layers.support.source.JoinTableDataSource")], T$q);
let h$12 = null;
function g$Q() {
  return h$12 || (h$12 = s$2r({ types: L$l() })), h$12;
}
let v$M = null;
function L$l() {
  return v$M || (v$M = { key: "type", base: null, typeMap: { "data-layer": K$c, "map-layer": c$1T } }), v$M;
}
const w$F = { key: "type", base: null, typeMap: { "join-table": T$q, "query-table": y$X, raster: a$1O, table: a$1N } };
let K$c = m$1x = class extends l$2B {
  constructor(e2) {
    super(e2), this.type = "data-layer";
  }
  clone() {
    const { fields: e2, dataSource: r2 } = this;
    return new m$1x({ fields: e2, dataSource: r2 });
  }
};
e$2g([r$1H({ dataLayer: "data-layer" })], K$c.prototype, "type", void 0), e$2g([y$1I({ type: [y$Y], json: { write: true } })], K$c.prototype, "fields", void 0), e$2g([y$1I({ types: w$F, json: { write: true } })], K$c.prototype, "dataSource", void 0), K$c = m$1x = e$2g([n$2P("esri.layers.support.source.DataLayerSource")], K$c), K$c.from = b$1a(K$c);
function i$1V(r2, t2) {
  return t2 ? __spreadProps(__spreadValues({}, t2), { query: __spreadValues(__spreadValues({}, r2), t2.query) }) : { query: r2 };
}
function f$19(r2) {
  return typeof r2 == "string" ? j$Q(r2) : y$1L(r2);
}
function s$1o(r2, t2, o2) {
  const e2 = {};
  for (const n2 in r2) {
    if (n2 === "declaredClass")
      continue;
    const i2 = r2[n2];
    if (i2 != null && typeof i2 != "function")
      if (Array.isArray(i2)) {
        e2[n2] = [];
        for (let r3 = 0; r3 < i2.length; r3++)
          e2[n2][r3] = s$1o(i2[r3]);
      } else if (typeof i2 == "object")
        if (i2.toJSON) {
          const r3 = i2.toJSON(o2 && o2[n2]);
          e2[n2] = t2 ? r3 : JSON.stringify(r3);
        } else
          e2[n2] = t2 ? i2 : JSON.stringify(i2);
      else
        e2[n2] = i2;
  }
  return e2;
}
function u$1e(o2, e2) {
  var _a2;
  return r$1t(o2) && (e2 || s$2A.apiKey) ? e2 || s$2A.apiKey : (_a2 = s$1Q == null ? void 0 : s$1Q.findCredential(o2)) == null ? void 0 : _a2.token;
}
const r$17 = { 102100: { maxX: 20037508342788905e-9, minX: -20037508342788905e-9, plus180Line: new m$2i({ paths: [[[20037508342788905e-9, -20037508342788905e-9], [20037508342788905e-9, 20037508342788905e-9]]], spatialReference: k$C.WebMercator }), minus180Line: new m$2i({ paths: [[[-20037508342788905e-9, -20037508342788905e-9], [-20037508342788905e-9, 20037508342788905e-9]]], spatialReference: k$C.WebMercator }) }, 4326: { maxX: 180, minX: -180, plus180Line: new m$2i({ paths: [[[180, -180], [180, 180]]], spatialReference: k$C.WGS84 }), minus180Line: new m$2i({ paths: [[[-180, -180], [-180, 180]]], spatialReference: k$C.WGS84 }) } };
function i$1U(e2, n2) {
  return Math.ceil((e2 - n2) / (2 * n2));
}
function s$1n(e2, n2) {
  const t2 = o$1g(e2);
  for (const r2 of t2)
    for (const e3 of r2)
      e3[0] += n2;
  return e2;
}
function o$1g(e2) {
  return y$1t(e2) ? e2.rings : e2.paths;
}
async function o$1f(o2, i2, n2, m2) {
  const a2 = f$19(o2), p2 = i2[0].spatialReference, u2 = __spreadProps(__spreadValues({}, m2), { query: __spreadProps(__spreadValues({}, a2.query), { f: "json", sr: JSON.stringify(p2), target: JSON.stringify({ geometryType: c$32(i2[0]), geometries: i2 }), cutter: JSON.stringify(n2) }) }), c2 = await U$t(a2.path + "/cut", u2), { cutIndexes: f2, geometries: g2 = [] } = c2.data;
  return { cutIndexes: f2, geometries: g2.map((e2) => {
    const t2 = v$14(e2);
    return t2.spatialReference = p2, t2;
  }) };
}
function r$16(t2) {
  return { geometryType: c$32(t2[0]), geometries: t2.map((e2) => e2.toJSON()) };
}
function o$1e(e2, r2, o2) {
  const n2 = d$1P(r2);
  return e2.map((e3) => {
    const t2 = n2.fromJSON(e3);
    return t2.spatialReference = o2, t2;
  });
}
async function o$1d(o2, m2, f2) {
  const n2 = typeof o2 == "string" ? j$Q(o2) : o2, p2 = m2[0].spatialReference, a2 = c$32(m2[0]), u2 = __spreadProps(__spreadValues({}, f2), { query: __spreadProps(__spreadValues({}, n2.query), { f: "json", sr: p2.wkid ? p2.wkid : JSON.stringify(p2), geometries: JSON.stringify(r$16(m2)) }) }), { data: y2 } = await U$t(n2.path + "/simplify", u2);
  return o$1e(y2.geometries, a2, p2);
}
const y$W = s$2z.getLogger("esri.geometry.support.normalizeUtils");
function x$C(e2) {
  return e2.type === "polygon";
}
function d$10(e2) {
  return e2[0].type === "polygon";
}
function w$E(e2) {
  return e2[0].type === "polyline";
}
function M$o(e2, n2) {
  if (!(e2 instanceof m$2i || e2 instanceof v$15)) {
    const e3 = "straightLineDensify: the input geometry is neither polyline nor polygon";
    throw y$W.error(e3), new s$2u(e3);
  }
  const o2 = o$1g(e2), s2 = [];
  for (const t2 of o2) {
    const e3 = [];
    s2.push(e3), e3.push([t2[0][0], t2[0][1]]);
    for (let o3 = 0; o3 < t2.length - 1; o3++) {
      const s3 = t2[o3][0], r2 = t2[o3][1], i2 = t2[o3 + 1][0], l2 = t2[o3 + 1][1], f2 = Math.sqrt((i2 - s3) * (i2 - s3) + (l2 - r2) * (l2 - r2)), c2 = (l2 - r2) / f2, p2 = (i2 - s3) / f2, u2 = f2 / n2;
      if (u2 > 1) {
        for (let l3 = 1; l3 <= u2 - 1; l3++) {
          const t4 = l3 * n2, o5 = p2 * t4 + s3, i4 = c2 * t4 + r2;
          e3.push([o5, i4]);
        }
        const t3 = (f2 + Math.floor(u2 - 1) * n2) / 2, o4 = p2 * t3 + s3, i3 = c2 * t3 + r2;
        e3.push([o4, i3]);
      }
      e3.push([i2, l2]);
    }
  }
  return x$C(e2) ? new v$15({ rings: s2, spatialReference: e2.spatialReference }) : new m$2i({ paths: s2, spatialReference: e2.spatialReference });
}
function R$o(e2, t2, n2) {
  if (t2) {
    const t3 = M$o(e2, 1e6);
    e2 = j$X(t3, true);
  }
  return n2 && (e2 = s$1n(e2, n2)), e2;
}
function b$K(e2, t2, n2) {
  if (Array.isArray(e2)) {
    const o2 = e2[0];
    if (o2 > t2) {
      const n3 = i$1U(o2, t2);
      e2[0] = o2 + n3 * (-2 * t2);
    } else if (o2 < n2) {
      const t3 = i$1U(o2, n2);
      e2[0] = o2 + t3 * (-2 * n2);
    }
  } else {
    const o2 = e2.x;
    if (o2 > t2) {
      const n3 = i$1U(o2, t2);
      e2 = e2.clone().offset(n3 * (-2 * t2), 0);
    } else if (o2 < n2) {
      const t3 = i$1U(o2, n2);
      e2 = e2.clone().offset(t3 * (-2 * n2), 0);
    }
  }
  return e2;
}
function P$o(e2, t2) {
  let n2 = -1;
  for (let o2 = 0; o2 < t2.cutIndexes.length; o2++) {
    const s2 = t2.cutIndexes[o2], r2 = t2.geometries[o2], i2 = o$1g(r2);
    for (let e3 = 0; e3 < i2.length; e3++) {
      const t3 = i2[e3];
      t3.some((n3) => {
        if (n3[0] < 180)
          return true;
        {
          let n4 = 0;
          for (let e4 = 0; e4 < t3.length; e4++) {
            const o4 = t3[e4][0];
            n4 = o4 > n4 ? o4 : n4;
          }
          n4 = Number(n4.toFixed(9));
          const o3 = -360 * i$1U(n4, 180);
          for (let s3 = 0; s3 < t3.length; s3++) {
            const t4 = r2.getPoint(e3, s3);
            r2.setPoint(e3, s3, t4.clone().offset(o3, 0));
          }
          return true;
        }
      });
    }
    if (s2 === n2) {
      if (d$10(e2))
        for (const t3 of o$1g(r2))
          e2[s2] = e2[s2].addRing(t3);
      else if (w$E(e2))
        for (const t3 of o$1g(r2))
          e2[s2] = e2[s2].addPath(t3);
    } else
      n2 = s2, e2[s2] = r2;
  }
  return e2;
}
async function v$L(t2, n2, l2) {
  var _a2;
  if (!Array.isArray(t2))
    return v$L([t2], n2);
  n2 && typeof n2 != "string" && y$W.warn("normalizeCentralMeridian()", "The url object is deprecated, use the url string instead");
  const h2 = typeof n2 == "string" ? n2 : (_a2 = n2 == null ? void 0 : n2.url) != null ? _a2 : s$2A.geometryServiceUrl;
  let x2, d2, w2, j2, M2, L2, U2, z2, A2 = 0;
  const S2 = [], k2 = [];
  for (const e2 of t2)
    if (t$2r(e2))
      k2.push(e2);
    else if (x2 || (x2 = e2.spatialReference, d2 = R$B(x2), w2 = x2.isWebMercator, L2 = w2 ? 102100 : 4326, j2 = r$17[L2].maxX, M2 = r$17[L2].minX, U2 = r$17[L2].plus180Line, z2 = r$17[L2].minus180Line), d2)
      if (e2.type === "mesh")
        k2.push(e2);
      else if (e2.type === "point")
        k2.push(b$K(e2.clone(), j2, M2));
      else if (e2.type === "multipoint") {
        const t3 = e2.clone();
        t3.points = t3.points.map((e3) => b$K(e3, j2, M2)), k2.push(t3);
      } else if (e2.type === "extent") {
        const t3 = e2.clone()._normalize(false, false, d2);
        k2.push(t3.rings ? new v$15(t3) : t3);
      } else if (e2.extent) {
        const t3 = e2.extent, n3 = i$1U(t3.xmin, M2) * (2 * j2);
        let o2 = n3 === 0 ? e2.clone() : s$1n(e2.clone(), n3);
        t3.offset(n3, 0), t3.intersects(U2) && t3.xmax !== j2 ? (A2 = t3.xmax > A2 ? t3.xmax : A2, o2 = R$o(o2, w2), S2.push(o2), k2.push("cut")) : t3.intersects(z2) && t3.xmin !== M2 ? (A2 = t3.xmax * (2 * j2) > A2 ? t3.xmax * (2 * j2) : A2, o2 = R$o(o2, w2, 360), S2.push(o2), k2.push("cut")) : k2.push(o2);
      } else
        k2.push(e2.clone());
    else
      k2.push(e2);
  let C2 = i$1U(A2, j2), I2 = -90;
  const X2 = C2, q2 = new m$2i();
  for (; C2 > 0; ) {
    const e2 = 360 * C2 - 180;
    q2.addPath([[e2, I2], [e2, -1 * I2]]), I2 *= -1, C2--;
  }
  if (S2.length > 0 && X2 > 0) {
    const e2 = P$o(S2, await o$1f(h2, S2, q2, l2)), n3 = [], o2 = [];
    for (let l3 = 0; l3 < k2.length; l3++) {
      const r3 = k2[l3];
      if (r3 !== "cut")
        o2.push(r3);
      else {
        const r4 = e2.shift(), i3 = t2[l3];
        r$1$(i3) && i3.type === "polygon" && i3.rings && i3.rings.length > 1 && r4.rings.length >= i3.rings.length ? (n3.push(r4), o2.push("simplify")) : o2.push(w2 ? R$A(r4) : r4);
      }
    }
    if (!n3.length)
      return o2;
    const r2 = await o$1d(h2, n3, l2), i2 = [];
    for (let t3 = 0; t3 < o2.length; t3++) {
      const e3 = o2[t3];
      e3 !== "simplify" ? i2.push(e3) : i2.push(w2 ? R$A(r2.shift()) : r2.shift());
    }
    return i2;
  }
  const D2 = [];
  for (let e2 = 0; e2 < k2.length; e2++) {
    const t3 = k2[e2];
    if (t3 !== "cut")
      D2.push(t3);
    else {
      const e3 = S2.shift();
      D2.push(w2 === true ? R$A(e3) : e3);
    }
  }
  return D2;
}
function U$k(e2, t2) {
  const n2 = R$B(t2);
  if (n2) {
    const [t3, o2] = n2.valid, s2 = o2 - t3;
    if (e2 < t3)
      for (; e2 < t3; )
        e2 += s2;
    if (e2 > o2)
      for (; e2 > o2; )
        e2 -= s2;
  }
  return e2;
}
function t$1g(n2) {
  const o2 = {};
  for (const e2 in n2) {
    if (e2 === "declaredClass")
      continue;
    const r2 = n2[e2];
    if (r2 != null && typeof r2 != "function")
      if (Array.isArray(r2)) {
        o2[e2] = [];
        for (let n3 = 0; n3 < r2.length; n3++)
          o2[e2][n3] = t$1g(r2[n3]);
      } else
        typeof r2 == "object" ? r2.toJSON && (o2[e2] = JSON.stringify(r2)) : o2[e2] = r2;
  }
  return o2;
}
var e$16;
!function(t2) {
  t2[t2.varint = 0] = "varint", t2[t2.fixed64 = 1] = "fixed64", t2[t2.delimited = 2] = "delimited", t2[t2.fixed32 = 5] = "fixed32", t2[t2.unknown = 99] = "unknown";
}(e$16 || (e$16 = {}));
const i$1T = 4294967296, s$1m = new TextDecoder("utf-8"), r$15 = has("safari") || has("ios") ? 6 : has("ff") ? 12 : 32;
class n$1J {
  constructor(t2, i2, s2 = 0, r2 = t2 ? t2.byteLength : 0) {
    this._tag = 0, this._dataType = e$16.unknown, this._init(t2, i2, s2, r2);
  }
  _init(t2, e2, i2, s2) {
    this._data = t2, this._dataView = e2, this._pos = i2, this._end = s2;
  }
  asUnsafe() {
    return this;
  }
  clone() {
    return new n$1J(this._data, this._dataView, this._pos, this._end);
  }
  pos() {
    return this._pos;
  }
  move(t2) {
    this._pos = t2;
  }
  nextTag(t2) {
    for (; ; ) {
      if (this._pos === this._end)
        return false;
      const e2 = this._decodeVarint();
      if (this._tag = e2 >> 3, this._dataType = 7 & e2, !t2 || t2 === this._tag)
        break;
      this.skip();
    }
    return true;
  }
  next() {
    if (this._pos === this._end)
      return false;
    const t2 = this._decodeVarint();
    return this._tag = t2 >> 3, this._dataType = 7 & t2, true;
  }
  empty() {
    return this._pos >= this._end;
  }
  tag() {
    return this._tag;
  }
  getInt32() {
    return this._decodeVarint();
  }
  getInt64() {
    return this._decodeVarint();
  }
  getUInt32() {
    let t2 = 4294967295;
    return t2 = (127 & this._data[this._pos]) >>> 0, this._data[this._pos++] < 128 ? t2 : (t2 = (t2 | (127 & this._data[this._pos]) << 7) >>> 0, this._data[this._pos++] < 128 ? t2 : (t2 = (t2 | (127 & this._data[this._pos]) << 14) >>> 0, this._data[this._pos++] < 128 ? t2 : (t2 = (t2 | (127 & this._data[this._pos]) << 21) >>> 0, this._data[this._pos++] < 128 ? t2 : (t2 = (t2 | (15 & this._data[this._pos]) << 28) >>> 0, this._data[this._pos++] < 128 ? t2 : void 0))));
  }
  getUInt64() {
    return this._decodeVarint();
  }
  getSInt32() {
    const t2 = this.getUInt32();
    if (t2 !== void 0)
      return t2 >>> 1 ^ -(1 & t2) | 0;
  }
  getSInt64() {
    return this._decodeSVarint();
  }
  getBool() {
    const t2 = this._data[this._pos] !== 0;
    return this._skip(1), t2;
  }
  getEnum() {
    return this._decodeVarint();
  }
  getFixed64() {
    const t2 = this._dataView, e2 = this._pos, s2 = t2.getUint32(e2, true) + t2.getUint32(e2 + 4, true) * i$1T;
    return this._skip(8), s2;
  }
  getSFixed64() {
    const t2 = this._dataView, e2 = this._pos, s2 = t2.getUint32(e2, true) + t2.getInt32(e2 + 4, true) * i$1T;
    return this._skip(8), s2;
  }
  getDouble() {
    const t2 = this._dataView.getFloat64(this._pos, true);
    return this._skip(8), t2;
  }
  getFixed32() {
    const t2 = this._dataView.getUint32(this._pos, true);
    return this._skip(4), t2;
  }
  getSFixed32() {
    const t2 = this._dataView.getInt32(this._pos, true);
    return this._skip(4), t2;
  }
  getFloat() {
    const t2 = this._dataView.getFloat32(this._pos, true);
    return this._skip(4), t2;
  }
  getString() {
    const t2 = this._getLength(), e2 = this._pos, i2 = this._toString(this._data, e2, e2 + t2);
    return this._skip(t2), i2;
  }
  getBytes() {
    const t2 = this._getLength(), e2 = this._pos, i2 = this._toBytes(this._data, e2, e2 + t2);
    return this._skip(t2), i2;
  }
  getLength() {
    return this._getLengthUnsafe();
  }
  processMessageWithArgs(t2, e2, i2, s2) {
    const r2 = this.getMessage(), n2 = t2(r2, e2, i2, s2);
    return r2.release(), n2;
  }
  processMessage(t2) {
    const e2 = this.getMessage(), i2 = t2(e2);
    return e2.release(), i2;
  }
  getMessage() {
    const t2 = this._getLength(), e2 = n$1J.pool.acquire();
    return e2._init(this._data, this._dataView, this._pos, this._pos + t2), this._skip(t2), e2;
  }
  release() {
    n$1J.pool.release(this);
  }
  dataType() {
    return this._dataType;
  }
  skip() {
    switch (this._dataType) {
      case e$16.varint:
        this._decodeVarint();
        break;
      case e$16.fixed64:
        this._skip(8);
        break;
      case e$16.delimited:
        this._skip(this._getLength());
        break;
      case e$16.fixed32:
        this._skip(4);
        break;
      default:
        throw new Error("Invalid data type!");
    }
  }
  skipLen(t2) {
    this._skip(t2);
  }
  _skip(t2) {
    if (this._pos + t2 > this._end)
      throw new Error("Attempt to skip past the end of buffer!");
    this._pos += t2;
  }
  _decodeVarint() {
    const t2 = this._data;
    let e2 = this._pos, i2 = 0, s2 = 0;
    if (this._end - e2 >= 10)
      do {
        if (s2 = t2[e2++], i2 |= 127 & s2, (128 & s2) == 0)
          break;
        if (s2 = t2[e2++], i2 |= (127 & s2) << 7, (128 & s2) == 0)
          break;
        if (s2 = t2[e2++], i2 |= (127 & s2) << 14, (128 & s2) == 0)
          break;
        if (s2 = t2[e2++], i2 |= (127 & s2) << 21, (128 & s2) == 0)
          break;
        if (s2 = t2[e2++], i2 += 268435456 * (127 & s2), (128 & s2) == 0)
          break;
        if (s2 = t2[e2++], i2 += 34359738368 * (127 & s2), (128 & s2) == 0)
          break;
        if (s2 = t2[e2++], i2 += 4398046511104 * (127 & s2), (128 & s2) == 0)
          break;
        if (s2 = t2[e2++], i2 += 562949953421312 * (127 & s2), (128 & s2) == 0)
          break;
        if (s2 = t2[e2++], i2 += 72057594037927940 * (127 & s2), (128 & s2) == 0)
          break;
        if (s2 = t2[e2++], i2 += 9223372036854776e3 * (127 & s2), (128 & s2) == 0)
          break;
        throw new Error("Varint too long!");
      } while (0);
    else {
      let r2 = 1;
      for (; e2 !== this._end && (s2 = t2[e2], (128 & s2) != 0); )
        ++e2, i2 += (127 & s2) * r2, r2 *= 128;
      if (e2 === this._end)
        throw new Error("Varint overrun!");
      ++e2, i2 += s2 * r2;
    }
    return this._pos = e2, i2;
  }
  _decodeSVarint() {
    const t2 = this._data;
    let e2 = this._pos, i2 = 0, s2 = 0;
    const r2 = 1 & t2[e2];
    if (this._end - e2 >= 10)
      do {
        if (s2 = t2[e2++], i2 |= 127 & s2, (128 & s2) == 0)
          break;
        if (s2 = t2[e2++], i2 |= (127 & s2) << 7, (128 & s2) == 0)
          break;
        if (s2 = t2[e2++], i2 |= (127 & s2) << 14, (128 & s2) == 0)
          break;
        if (s2 = t2[e2++], i2 |= (127 & s2) << 21, (128 & s2) == 0)
          break;
        if (s2 = t2[e2++], i2 += 268435456 * (127 & s2), (128 & s2) == 0)
          break;
        if (s2 = t2[e2++], i2 += 34359738368 * (127 & s2), (128 & s2) == 0)
          break;
        if (s2 = t2[e2++], i2 += 4398046511104 * (127 & s2), (128 & s2) == 0)
          break;
        if (s2 = t2[e2++], i2 += 562949953421312 * (127 & s2), (128 & s2) == 0)
          break;
        if (s2 = t2[e2++], i2 += 72057594037927940 * (127 & s2), (128 & s2) == 0)
          break;
        if (s2 = t2[e2++], i2 += 9223372036854776e3 * (127 & s2), (128 & s2) == 0)
          break;
        throw new Error("Varint too long!");
      } while (0);
    else {
      let r3 = 1;
      for (; e2 !== this._end && (s2 = t2[e2], (128 & s2) != 0); )
        ++e2, i2 += (127 & s2) * r3, r3 *= 128;
      if (e2 === this._end)
        throw new Error("Varint overrun!");
      ++e2, i2 += s2 * r3;
    }
    return this._pos = e2, r2 ? -(i2 + 1) / 2 : i2 / 2;
  }
  _getLength() {
    if (this._dataType !== e$16.delimited)
      throw new Error("Not a delimited data type!");
    return this._decodeVarint();
  }
  _getLengthUnsafe() {
    return this.getUInt32();
  }
  _toString(t2, e2, i2) {
    if ((i2 = Math.min(this._end, i2)) - e2 > r$15) {
      const r2 = t2.subarray(e2, i2);
      return s$1m.decode(r2);
    }
    let n2 = "", a2 = "";
    for (let s2 = e2; s2 < i2; ++s2) {
      const e3 = t2[s2];
      128 & e3 ? a2 += "%" + e3.toString(16) : (n2 += decodeURIComponent(a2) + String.fromCharCode(e3), a2 = "");
    }
    return a2.length && (n2 += decodeURIComponent(a2)), n2;
  }
  _toBytes(t2, e2, i2) {
    return i2 = Math.min(this._end, i2), new Uint8Array(t2.buffer, e2, i2 - e2);
  }
}
n$1J.pool = new e$24(n$1J, void 0, (t2) => {
  t2._data = null, t2._dataView = null;
});
class t$1f {
  constructor(t2 = [], e2 = [], s2 = false) {
    this.lengths = t2 != null ? t2 : [], this.coords = e2 != null ? e2 : [], this.hasIndeterminateRingOrder = s2;
  }
  static fromRect(e2) {
    const [s2, h2, n2, r2] = e2, i2 = n2 - s2, o2 = r2 - h2;
    return new t$1f([5], [s2, h2, i2, 0, 0, o2, -i2, 0, 0, -o2]);
  }
  get isPoint() {
    return this.lengths.length === 0;
  }
  get maxLength() {
    return Math.max(...this.lengths);
  }
  get size() {
    return this.lengths.reduce((t2, e2) => t2 + e2);
  }
  forEachVertex(t2) {
    let e2 = 0;
    this.lengths.length || t2(this.coords[0], this.coords[1]);
    for (let s2 = 0; s2 < this.lengths.length; s2++) {
      const h2 = this.lengths[s2];
      for (let s3 = 0; s3 < h2; s3++) {
        t2(this.coords[2 * (s3 + e2)], this.coords[2 * (s3 + e2) + 1]);
      }
      e2 += h2;
    }
  }
  clone(e2) {
    return e2 ? (e2.set(this.coords), new t$1f(this.lengths.slice(), e2, this.hasIndeterminateRingOrder)) : new t$1f(this.lengths.slice(), this.coords.slice(), this.hasIndeterminateRingOrder);
  }
}
class s$1l {
  constructor(t2 = null, s2 = {}, e2, o2) {
    this.geometry = t2, this.attributes = s2, this.centroid = e2, this.objectId = o2, this.displayId = 0, this.geohashX = 0, this.geohashY = 0;
  }
  weakClone() {
    const t2 = new s$1l(this.geometry, this.attributes, this.centroid, this.objectId);
    return t2.displayId = this.displayId, t2.geohashX = this.geohashX, t2.geohashY = this.geohashY, t2;
  }
}
function e$15(s2) {
  return !(t$2r(s2.geometry) || !s2.geometry.coords || !s2.geometry.coords.length);
}
class o$1c extends s$1l {
}
class e$14 {
  constructor() {
    this.objectIdFieldName = null, this.globalIdFieldName = null, this.geohashFieldName = null, this.geometryProperties = null, this.geometryType = null, this.spatialReference = null, this.hasZ = false, this.hasM = false, this.features = [], this.fields = [], this.transform = null, this.exceededTransferLimit = false, this.uniqueIdField = null, this.queryGeometryType = null, this.queryGeometry = null;
  }
  weakClone() {
    const t2 = new e$14();
    return t2.objectIdFieldName = this.objectIdFieldName, t2.globalIdFieldName = this.globalIdFieldName, t2.geohashFieldName = this.geohashFieldName, t2.geometryProperties = this.geometryProperties, t2.geometryType = this.geometryType, t2.spatialReference = this.spatialReference, t2.hasZ = this.hasZ, t2.hasM = this.hasM, t2.features = this.features, t2.fields = this.fields, t2.transform = this.transform, t2.exceededTransferLimit = this.exceededTransferLimit, t2.uniqueIdField = this.uniqueIdField, t2.queryGeometry = this.queryGeometry, t2.queryGeometryType = this.queryGeometryType, t2;
  }
}
const n$1I = ["esriGeometryPoint", "esriGeometryMultipoint", "esriGeometryPolyline", "esriGeometryPolygon"];
class a$1M {
  constructor(e2) {
    this._options = e2, this.geometryTypes = n$1I, this._coordinatePtr = 0, this._vertexDimension = 0;
  }
  createFeatureResult() {
    return new e$14();
  }
  prepareFeatures(e2) {
    this._vertexDimension = 2, e2.hasZ && this._vertexDimension++, e2.hasM && this._vertexDimension++;
  }
  finishFeatureResult(o2) {
    if (!o2 || !o2.features || !o2.hasZ || !this._options.sourceSpatialReference || !o2.spatialReference || E$P(o2.spatialReference, this._options.sourceSpatialReference) || o2.spatialReference.vcsWkid)
      return;
    const i2 = L$p(this._options.sourceSpatialReference) / L$p(o2.spatialReference);
    if (i2 !== 1)
      for (const e2 of o2.features) {
        if (!e$15(e2))
          continue;
        const t2 = e2.geometry.coords;
        for (let e3 = 2; e3 < t2.length; e3 += 3)
          t2[e3] *= i2;
      }
  }
  addFeature(e2, t2) {
    e2.features.push(t2);
  }
  createFeature() {
    return new s$1l();
  }
  createSpatialReference() {
    return { wkid: 0 };
  }
  createGeometry() {
    return new t$1f();
  }
  addField(e2, t2) {
    e2.fields.push(t2);
  }
  allocateCoordinates(e2) {
    e2.coords.length = e2.lengths.reduce((e3, t2) => e3 + t2, 0) * this._vertexDimension, this._coordinatePtr = 0;
  }
  addCoordinate(e2, t2) {
    e2.coords[this._coordinatePtr++] = t2;
  }
  addCoordinatePoint(e2, t2) {
    e2.coords.push(t2);
  }
  addLength(e2, t2) {
    e2.lengths.push(t2);
  }
  addQueryGeometry(e2, t2) {
    e2.queryGeometry = t2.queryGeometry, e2.queryGeometryType = t2.queryGeometryType;
  }
  createPointGeometry() {
    return new t$1f();
  }
}
const n$1H = ["esriFieldTypeSmallInteger", "esriFieldTypeInteger", "esriFieldTypeSingle", "esriFieldTypeDouble", "esriFieldTypeString", "esriFieldTypeDate", "esriFieldTypeOID", "esriFieldTypeGeometry", "esriFieldTypeBlob", "esriFieldTypeRaster", "esriFieldTypeGUID", "esriFieldTypeGlobalID", "esriFieldTypeXML"], o$1b = ["sqlTypeBigInt", "sqlTypeBinary", "sqlTypeBit", "sqlTypeChar", "sqlTypeDate", "sqlTypeDecimal", "sqlTypeDouble", "sqlTypeFloat", "sqlTypeGeometry", "sqlTypeGUID", "sqlTypeInteger", "sqlTypeLongNVarchar", "sqlTypeLongVarbinary", "sqlTypeLongVarchar", "sqlTypeNChar", "sqlTypeNVarchar", "sqlTypeOther", "sqlTypeReal", "sqlTypeSmallInt", "sqlTypeSqlXml", "sqlTypeTime", "sqlTypeTimestamp", "sqlTypeTimestamp2", "sqlTypeTinyInt", "sqlTypeVarbinary", "sqlTypeVarchar"], i$1S = ["upperLeft", "lowerLeft"];
function c$1R(e2) {
  return e2 >= n$1H.length ? null : n$1H[e2];
}
function l$1y(e2) {
  return e2 >= o$1b.length ? null : o$1b[e2];
}
function g$P(e2) {
  return e2 >= i$1S.length ? null : i$1S[e2];
}
function p$2a(e2, t2) {
  return t2 >= e2.geometryTypes.length ? null : e2.geometryTypes[t2];
}
function u$1d(e2, t2, s2) {
  const r2 = 3, a2 = e2.asUnsafe(), n2 = t2.createPointGeometry(s2);
  for (; a2.next(); )
    switch (a2.tag()) {
      case r2: {
        const e3 = a2.getUInt32(), s3 = a2.pos() + e3;
        let r3 = 0;
        for (; a2.pos() < s3; )
          t2.addCoordinatePoint(n2, a2.getSInt64(), r3++);
        break;
      }
      default:
        a2.skip();
    }
  return n2;
}
function f$18(e2, t2, s2) {
  const r2 = 2, a2 = 3, n2 = e2.asUnsafe(), o2 = t2.createGeometry(s2), i2 = 2 + (s2.hasZ ? 1 : 0) + (s2.hasM ? 1 : 0);
  for (; n2.next(); )
    switch (n2.tag()) {
      case r2: {
        const e3 = n2.getUInt32(), s3 = n2.pos() + e3;
        let r3 = 0;
        for (; n2.pos() < s3; )
          t2.addLength(o2, n2.getUInt32(), r3++);
        break;
      }
      case a2: {
        const e3 = n2.getUInt32(), s3 = n2.pos() + e3;
        let r3 = 0;
        for (t2.allocateCoordinates(o2); n2.pos() < s3; )
          t2.addCoordinate(o2, n2.getSInt64(), r3), r3++, r3 === i2 && (r3 = 0);
        break;
      }
      default:
        n2.skip();
    }
  return o2;
}
function y$V(e2) {
  const t2 = 1, s2 = 2, n2 = 3, o2 = e2.asUnsafe(), i2 = new t$1f();
  let c2 = "esriGeometryPoint";
  for (; o2.next(); )
    switch (o2.tag()) {
      case s2: {
        const e3 = o2.getUInt32(), t3 = o2.pos() + e3;
        for (; o2.pos() < t3; )
          i2.lengths.push(o2.getUInt32());
        break;
      }
      case n2: {
        const e3 = o2.getUInt32(), t3 = o2.pos() + e3;
        for (; o2.pos() < t3; )
          i2.coords.push(o2.getSInt64());
        break;
      }
      case t2:
        c2 = n$1I[o2.getEnum()];
        break;
      default:
        o2.skip();
    }
  return { queryGeometry: i2, queryGeometryType: c2 };
}
function b$J(e2) {
  const t2 = 1, s2 = 2, r2 = 3, a2 = 4, n2 = 5, o2 = 6, i2 = 7, c2 = 8, l2 = 9, g2 = e2.asUnsafe();
  for (; g2.next(); )
    switch (g2.tag()) {
      case t2:
        return g2.getString();
      case s2:
        return g2.getFloat();
      case r2:
        return g2.getDouble();
      case a2:
        return g2.getSInt32();
      case n2:
        return g2.getUInt32();
      case o2:
        return g2.getInt64();
      case i2:
        return g2.getUInt64();
      case c2:
        return g2.getSInt64();
      case l2:
        return g2.getBool();
      default:
        return g2.skip(), null;
    }
  return null;
}
function k$l(e2) {
  const t2 = 1, s2 = 2, r2 = 3, a2 = 4, n2 = 5, o2 = 6, i2 = e2.asUnsafe(), g2 = { type: c$1R(0) };
  for (; i2.next(); )
    switch (i2.tag()) {
      case t2:
        g2.name = i2.getString();
        break;
      case s2:
        g2.type = c$1R(i2.getEnum());
        break;
      case r2:
        g2.alias = i2.getString();
        break;
      case a2:
        g2.sqlType = l$1y(i2.getEnum());
        break;
      case n2:
        i2.skip();
        break;
      case o2:
        g2.defaultValue = i2.getString();
        break;
      default:
        i2.skip();
    }
  return g2;
}
function d$$(e2) {
  const t2 = 1, s2 = 2, r2 = {}, a2 = e2.asUnsafe();
  for (; a2.next(); )
    switch (a2.tag()) {
      case t2:
        r2.name = a2.getString();
        break;
      case s2:
        r2.isSystemMaintained = a2.getBool();
        break;
      default:
        a2.skip();
    }
  return r2;
}
function m$1w(e2, t2, s2, r2) {
  const a2 = 1, n2 = 2, o2 = 4, i2 = t2.createFeature(s2);
  let c2 = 0;
  for (; e2.next(); )
    switch (e2.tag()) {
      case a2: {
        const t3 = r2[c2++].name;
        i2.attributes[t3] = e2.processMessage(b$J);
        break;
      }
      case n2:
        i2.geometry = e2.processMessageWithArgs(f$18, t2, s2);
        break;
      case o2:
        i2.centroid = e2.processMessageWithArgs(u$1d, t2, s2);
        break;
      default:
        e2.skip();
    }
  return i2;
}
function h$11(e2) {
  const t2 = 1, s2 = 2, r2 = 3, a2 = 4, n2 = [1, 1, 1, 1], o2 = e2.asUnsafe();
  for (; o2.next(); )
    switch (o2.tag()) {
      case t2:
        n2[0] = o2.getDouble();
        break;
      case s2:
        n2[1] = o2.getDouble();
        break;
      case a2:
        n2[2] = o2.getDouble();
        break;
      case r2:
        n2[3] = o2.getDouble();
        break;
      default:
        o2.skip();
    }
  return n2;
}
function T$p(e2) {
  const t2 = 1, s2 = 2, r2 = 3, a2 = 4, n2 = [0, 0, 0, 0], o2 = e2.asUnsafe();
  for (; o2.next(); )
    switch (o2.tag()) {
      case t2:
        n2[0] = o2.getDouble();
        break;
      case s2:
        n2[1] = o2.getDouble();
        break;
      case a2:
        n2[2] = o2.getDouble();
        break;
      case r2:
        n2[3] = o2.getDouble();
        break;
      default:
        o2.skip();
    }
  return n2;
}
function q$h(e2) {
  const t2 = 1, s2 = 2, r2 = 3, a2 = { originPosition: g$P(0) }, n2 = e2.asUnsafe();
  for (; n2.next(); )
    switch (n2.tag()) {
      case t2:
        a2.originPosition = g$P(n2.getEnum());
        break;
      case s2:
        a2.scale = n2.processMessage(h$11);
        break;
      case r2:
        a2.translate = n2.processMessage(T$p);
        break;
      default:
        n2.skip();
    }
  return a2;
}
function I$t(e2) {
  const t2 = 1, s2 = 2, r2 = 3, a2 = {}, n2 = e2.asUnsafe();
  for (; n2.next(); )
    switch (n2.tag()) {
      case t2:
        a2.shapeAreaFieldName = n2.getString();
        break;
      case s2:
        a2.shapeLengthFieldName = n2.getString();
        break;
      case r2:
        a2.units = n2.getString();
        break;
      default:
        n2.skip();
    }
  return a2;
}
function F$n(e2, t2) {
  const s2 = 1, r2 = 2, a2 = 3, n2 = 4, o2 = 5, i2 = t2.createSpatialReference();
  for (; e2.next(); )
    switch (e2.tag()) {
      case s2:
        i2.wkid = e2.getUInt32();
        break;
      case o2:
        i2.wkt = e2.getString();
        break;
      case r2:
        i2.latestWkid = e2.getUInt32();
        break;
      case a2:
        i2.vcsWkid = e2.getUInt32();
        break;
      case n2:
        i2.latestVcsWkid = e2.getUInt32();
        break;
      default:
        e2.skip();
    }
  return i2;
}
function U$j(e2, t2) {
  const s2 = 1, r2 = 2, a2 = 3, n2 = 4, o2 = 5, i2 = 7, c2 = 8, l2 = 9, g2 = 10, u2 = 11, f2 = 12, y2 = 13, b2 = 15, h2 = t2.createFeatureResult(), T2 = e2.asUnsafe();
  h2.geometryType = p$2a(t2, 0);
  let U2 = false;
  for (; T2.next(); )
    switch (T2.tag()) {
      case s2:
        h2.objectIdFieldName = T2.getString();
        break;
      case a2:
        h2.globalIdFieldName = T2.getString();
        break;
      case n2:
        h2.geohashFieldName = T2.getString();
        break;
      case o2:
        h2.geometryProperties = T2.processMessage(I$t);
        break;
      case i2:
        h2.geometryType = p$2a(t2, T2.getEnum());
        break;
      case c2:
        h2.spatialReference = T2.processMessageWithArgs(F$n, t2);
        break;
      case g2:
        h2.hasZ = T2.getBool();
        break;
      case u2:
        h2.hasM = T2.getBool();
        break;
      case f2:
        h2.transform = T2.processMessage(q$h);
        break;
      case l2: {
        const e3 = T2.getBool();
        h2.exceededTransferLimit = e3;
        break;
      }
      case y2:
        t2.addField(h2, T2.processMessage(k$l));
        break;
      case b2:
        U2 || (t2.prepareFeatures(h2), U2 = true), t2.addFeature(h2, T2.processMessageWithArgs(m$1w, t2, h2, h2.fields));
        break;
      case r2:
        h2.uniqueIdField = T2.processMessage(d$$);
        break;
      default:
        T2.skip();
    }
  return t2.finishFeatureResult(h2), h2;
}
function S$x(e2, s2) {
  const r2 = 1, a2 = 4, n2 = {};
  let o2 = null;
  for (; e2.next(); )
    switch (e2.tag()) {
      case a2:
        o2 = e2.processMessageWithArgs(y$V);
        break;
      case r2:
        n2.featureResult = e2.processMessageWithArgs(U$j, s2);
        break;
      default:
        e2.skip();
    }
  return r$1$(o2) && n2.featureResult && s2.addQueryGeometry(n2, o2), n2;
}
function w$D(t2, r2) {
  try {
    const e2 = 2, a2 = new n$1J(new Uint8Array(t2), new DataView(t2)), n2 = {};
    for (; a2.next(); )
      if (a2.tag() === e2)
        n2.queryResult = a2.processMessageWithArgs(S$x, r2);
      else
        a2.skip();
    return n2;
  } catch (a2) {
    throw new s$2u("query:parsing-pbf", "Error while parsing FeatureSet PBF payload", { error: a2 });
  }
}
function t$1e(t2, r2) {
  const u2 = w$D(t2, r2), o2 = u2.queryResult.featureResult, s2 = u2.queryResult.queryGeometry, y2 = u2.queryResult.queryGeometryType;
  if (o2 && o2.features && o2.features.length && o2.objectIdFieldName) {
    const e2 = o2.objectIdFieldName;
    for (const t3 of o2.features)
      t3.attributes && (t3.objectId = t3.attributes[e2]);
  }
  return o2 && (o2.queryGeometry = s2, o2.queryGeometryType = y2), o2;
}
function r$14(r2, t2, f2) {
  if (!f2 || !f2.features || !f2.hasZ)
    return;
  const s2 = o$1z(f2.geometryType, t2, r2.outSpatialReference);
  if (!t$2r(s2))
    for (const e2 of f2.features)
      s2(e2.geometry);
}
const l$1x = "Layer does not support extent calculation.";
function m$1v(e2, t2) {
  if (t2 && e2.type === "extent")
    return `${e2.xmin},${e2.ymin},${e2.xmax},${e2.ymax}`;
  if (t2 && e2.type === "point")
    return `${e2.x},${e2.y}`;
  const r2 = e2.toJSON();
  return delete r2.spatialReference, JSON.stringify(r2);
}
function y$U(e2, r2) {
  const n2 = e2.geometry, o2 = e2.toJSON();
  delete o2.compactGeometryEnabled, delete o2.defaultSpatialReferenceEnabled;
  const a2 = o2;
  let s2, u2, l2;
  if (r$1$(n2) && (u2 = n2.spatialReference, l2 = n2.spatialReference.wkid || JSON.stringify(n2.spatialReference), a2.geometryType = c$32(n2), a2.geometry = m$1v(n2, e2.compactGeometryEnabled), a2.inSR = l2), o2.groupByFieldsForStatistics && (a2.groupByFieldsForStatistics = o2.groupByFieldsForStatistics.join(",")), o2.objectIds && (a2.objectIds = o2.objectIds.join(",")), o2.orderByFields && (a2.orderByFields = o2.orderByFields.join(",")), !o2.outFields || !o2.returnDistinctValues && ((r2 == null ? void 0 : r2.returnCountOnly) || (r2 == null ? void 0 : r2.returnExtentOnly) || (r2 == null ? void 0 : r2.returnIdsOnly)) ? delete a2.outFields : o2.outFields.includes("*") ? a2.outFields = "*" : a2.outFields = o2.outFields.join(","), o2.outSR ? (a2.outSR = o2.outSR.wkid || JSON.stringify(o2.outSR), s2 = e2.outSpatialReference) : n2 && (o2.returnGeometry || o2.returnCentroid) && (a2.outSR = a2.inSR, s2 = u2), o2.returnGeometry && delete o2.returnGeometry, o2.outStatistics && (a2.outStatistics = JSON.stringify(o2.outStatistics)), o2.fullText && (a2.fullText = JSON.stringify(o2.fullText)), o2.pixelSize && (a2.pixelSize = JSON.stringify(o2.pixelSize)), o2.quantizationParameters && (e2.defaultSpatialReferenceEnabled && r$1$(u2) && r$1$(e2.quantizationParameters) && r$1$(e2.quantizationParameters.extent) && u2.equals(e2.quantizationParameters.extent.spatialReference) && delete o2.quantizationParameters.extent.spatialReference, a2.quantizationParameters = JSON.stringify(o2.quantizationParameters)), o2.parameterValues && (a2.parameterValues = JSON.stringify(o2.parameterValues)), o2.rangeValues && (a2.rangeValues = JSON.stringify(o2.rangeValues)), o2.dynamicDataSource && (a2.layer = JSON.stringify({ source: o2.dynamicDataSource }), delete o2.dynamicDataSource), o2.timeExtent) {
    const e3 = o2.timeExtent, { start: t2, end: r3 } = e3;
    t2 == null && r3 == null || (a2.time = t2 === r3 ? t2 : `${t2 != null ? t2 : "null"},${r3 != null ? r3 : "null"}`), delete o2.timeExtent;
  }
  return e2.defaultSpatialReferenceEnabled && r$1$(u2) && r$1$(s2) && u2.equals(s2) && (a2.defaultSR = a2.inSR, delete a2.inSR, delete a2.outSR), a2;
}
async function c$1Q(e2, r2, n2, i2) {
  const o2 = r$1$(r2.timeExtent) && r2.timeExtent.isEmpty ? { data: { features: [] } } : await E$w(e2, r2, "json", i2);
  return r$14(r2, n2, o2.data), o2;
}
async function f$17(e2, r2, n2, i2) {
  if (r$1$(r2.timeExtent) && r2.timeExtent.isEmpty)
    return { data: n2.createFeatureResult() };
  const o2 = await d$_(e2, r2, i2), a2 = o2;
  return a2.data = t$1e(o2.data, n2), a2;
}
function d$_(e2, t2, r2) {
  return E$w(e2, t2, "pbf", r2);
}
function p$29(e2, r2, n2) {
  return r$1$(r2.timeExtent) && r2.timeExtent.isEmpty ? Promise.resolve({ data: { objectIds: [] } }) : E$w(e2, r2, "json", n2, { returnIdsOnly: true });
}
function S$w(e2, r2, n2) {
  return r$1$(r2.timeExtent) && r2.timeExtent.isEmpty ? Promise.resolve({ data: { count: 0 } }) : E$w(e2, r2, "json", n2, { returnIdsOnly: true, returnCountOnly: true });
}
function x$B(e2, r2, n2) {
  return r$1$(r2.timeExtent) && r2.timeExtent.isEmpty ? Promise.resolve({ data: { count: 0, extent: null } }) : E$w(e2, r2, "json", n2, { returnExtentOnly: true, returnCountOnly: true }).then((e3) => {
    const t2 = e3.data;
    if (t2.hasOwnProperty("extent"))
      return e3;
    if (t2.features)
      throw new Error(l$1x);
    if (t2.hasOwnProperty("count"))
      throw new Error(l$1x);
    return e3;
  });
}
function E$w(i2, s2, u2, l2 = {}, m2 = {}) {
  const c2 = typeof i2 == "string" ? j$Q(i2) : i2, f2 = s2.geometry ? [s2.geometry] : [];
  return l2.responseType = u2 === "pbf" ? "array-buffer" : "json", v$L(f2, null, l2).then((r2) => {
    const i3 = r2 && r2[0];
    r$1$(i3) && ((s2 = s2.clone()).geometry = i3);
    const o2 = t$1g(__spreadValues(__spreadValues(__spreadProps(__spreadValues({}, c2.query), { f: u2 }), m2), y$U(s2, m2)));
    return U$t(G$q(c2.path, "query"), __spreadProps(__spreadValues({}, l2), { query: __spreadValues(__spreadValues({}, o2), l2.query) }));
  });
}
var query$1 = /* @__PURE__ */ Object.freeze({
  __proto__: null,
  [Symbol.toStringTag]: "Module",
  encodeGeometry: m$1v,
  executeQuery: c$1Q,
  executeQueryForCount: S$w,
  executeQueryForExtent: x$B,
  executeQueryForIds: p$29,
  executeQueryPBF: f$17,
  executeQueryPBFBuffer: d$_,
  queryToQueryStringParameters: y$U,
  runQuery: E$w
});
var d$Z;
const g$O = new s$2a({ esriGeometryPoint: "point", esriGeometryMultipoint: "multipoint", esriGeometryPolyline: "polyline", esriGeometryPolygon: "polygon", esriGeometryEnvelope: "extent", mesh: "mesh", "": null });
let j$x = d$Z = class extends l$2B {
  constructor(e2) {
    super(e2), this.displayFieldName = null, this.exceededTransferLimit = false, this.features = [], this.fields = null, this.geometryType = null, this.hasM = false, this.hasZ = false, this.queryGeometry = null, this.spatialReference = null;
  }
  readFeatures(e2, t2) {
    var _a2;
    const o2 = k$C.fromJSON(t2.spatialReference), s2 = [];
    for (let i2 = 0; i2 < e2.length; i2++) {
      const t3 = e2[i2], a2 = g$10.fromJSON(t3), p2 = t3.geometry && t3.geometry.spatialReference;
      r$1$(a2.geometry) && !p2 && (a2.geometry.spatialReference = o2);
      const l2 = t3.aggregateGeometries, y2 = a2.aggregateGeometries;
      if (l2 && r$1$(y2))
        for (const e3 in y2) {
          const t4 = y2[e3], r2 = (_a2 = l2[e3]) == null ? void 0 : _a2.spatialReference;
          r$1$(t4) && !r2 && (t4.spatialReference = o2);
        }
      s2.push(a2);
    }
    return s2;
  }
  writeGeometryType(e2, t2, r2, o2) {
    if (e2)
      return void g$O.write(e2, t2, r2, o2);
    const { features: s2 } = this;
    if (s2) {
      for (const i2 of s2)
        if (i2 && r$1$(i2.geometry))
          return void g$O.write(i2.geometry.type, t2, r2, o2);
    }
  }
  readQueryGeometry(e2, t2) {
    if (!e2)
      return null;
    const r2 = !!e2.spatialReference, o2 = v$14(e2);
    return o2 && !r2 && t2.spatialReference && (o2.spatialReference = k$C.fromJSON(t2.spatialReference)), o2;
  }
  writeSpatialReference(e2, t2) {
    if (e2)
      return void (t2.spatialReference = e2.toJSON());
    const { features: r2 } = this;
    if (r2) {
      for (const o2 of r2)
        if (o2 && r$1$(o2.geometry) && o2.geometry.spatialReference)
          return void (t2.spatialReference = o2.geometry.spatialReference.toJSON());
    }
  }
  clone() {
    return new d$Z(this.cloneProperties());
  }
  cloneProperties() {
    return y$1L({ displayFieldName: this.displayFieldName, exceededTransferLimit: this.exceededTransferLimit, features: this.features, fields: this.fields, geometryType: this.geometryType, hasM: this.hasM, hasZ: this.hasZ, queryGeometry: this.queryGeometry, spatialReference: this.spatialReference, transform: this.transform });
  }
  toJSON(e2) {
    const t2 = this.write();
    if (t2.features && Array.isArray(e2) && e2.length > 0)
      for (let r2 = 0; r2 < t2.features.length; r2++) {
        const o2 = t2.features[r2];
        if (o2.geometry) {
          const t3 = e2 && e2[r2];
          o2.geometry = t3 && t3.toJSON() || o2.geometry;
        }
      }
    return t2;
  }
  quantize(e2) {
    const { scale: [t2, r2], translate: [o2, s2] } = e2, i2 = (e3) => Math.round((e3 - o2) / t2), n2 = (e3) => Math.round((s2 - e3) / r2), p2 = this.features, l2 = this._getQuantizationFunction(this.geometryType, i2, n2);
    for (let y2 = 0, m2 = p2.length; y2 < m2; y2++)
      (l2 == null ? void 0 : l2(e$2e(p2[y2].geometry))) || (p2.splice(y2, 1), y2--, m2--);
    return this.transform = e2, this;
  }
  unquantize() {
    const { geometryType: e2, features: t2, transform: r2 } = this;
    if (!r2)
      return this;
    const { translate: [o2, s2], scale: [i2, a2] } = r2, p2 = (e3) => e3 * i2 + o2, l2 = (e3) => s2 - e3 * a2, y2 = this._getHydrationFunction(e2, p2, l2);
    for (const { geometry: m2 } of t2)
      r$1$(m2) && y2 && y2(m2);
    return this.transform = null, this;
  }
  _quantizePoints(e2, t2, r2) {
    let o2, s2;
    const i2 = [];
    for (let n2 = 0, a2 = e2.length; n2 < a2; n2++) {
      const a3 = e2[n2];
      if (n2 > 0) {
        const e3 = t2(a3[0]), n3 = r2(a3[1]);
        e3 === o2 && n3 === s2 || (i2.push([e3 - o2, n3 - s2]), o2 = e3, s2 = n3);
      } else
        o2 = t2(a3[0]), s2 = r2(a3[1]), i2.push([o2, s2]);
    }
    return i2.length > 0 ? i2 : null;
  }
  _getQuantizationFunction(e2, t2, r2) {
    return e2 === "point" ? (e3) => (e3.x = t2(e3.x), e3.y = r2(e3.y), e3) : e2 === "polyline" || e2 === "polygon" ? (e3) => {
      const o2 = y$1t(e3) ? e3.rings : e3.paths, s2 = [];
      for (let i2 = 0, n2 = o2.length; i2 < n2; i2++) {
        const e4 = o2[i2], n3 = this._quantizePoints(e4, t2, r2);
        n3 && s2.push(n3);
      }
      return s2.length > 0 ? (y$1t(e3) ? e3.rings = s2 : e3.paths = s2, e3) : null;
    } : e2 === "multipoint" ? (e3) => {
      const o2 = this._quantizePoints(e3.points, t2, r2);
      return o2 && o2.length > 0 ? (e3.points = o2, e3) : null;
    } : e2 === "extent" ? (e3) => e3 : null;
  }
  _getHydrationFunction(e2, t2, r2) {
    return e2 === "point" ? (e3) => {
      e3.x = t2(e3.x), e3.y = r2(e3.y);
    } : e2 === "polyline" || e2 === "polygon" ? (e3) => {
      const o2 = y$1t(e3) ? e3.rings : e3.paths;
      let s2, i2;
      for (let n2 = 0, a2 = o2.length; n2 < a2; n2++) {
        const e4 = o2[n2];
        for (let o3 = 0, n3 = e4.length; o3 < n3; o3++) {
          const n4 = e4[o3];
          o3 > 0 ? (s2 += n4[0], i2 += n4[1]) : (s2 = n4[0], i2 = n4[1]), n4[0] = t2(s2), n4[1] = r2(i2);
        }
      }
    } : e2 === "extent" ? (e3) => {
      e3.xmin = t2(e3.xmin), e3.ymin = r2(e3.ymin), e3.xmax = t2(e3.xmax), e3.ymax = r2(e3.ymax);
    } : e2 === "multipoint" ? (e3) => {
      const o2 = e3.points;
      let s2, i2;
      for (let n2 = 0, a2 = o2.length; n2 < a2; n2++) {
        const e4 = o2[n2];
        n2 > 0 ? (s2 += e4[0], i2 += e4[1]) : (s2 = e4[0], i2 = e4[1]), e4[0] = t2(s2), e4[1] = r2(i2);
      }
    } : null;
  }
};
e$2g([y$1I({ type: String, json: { write: true } })], j$x.prototype, "displayFieldName", void 0), e$2g([y$1I({ type: Boolean, json: { write: { overridePolicy: (e2) => ({ enabled: e2 }) } } })], j$x.prototype, "exceededTransferLimit", void 0), e$2g([y$1I({ type: [g$10], json: { write: true } })], j$x.prototype, "features", void 0), e$2g([o$29("features")], j$x.prototype, "readFeatures", null), e$2g([y$1I({ type: [y$Y], json: { write: true } })], j$x.prototype, "fields", void 0), e$2g([y$1I({ type: ["point", "multipoint", "polyline", "polygon", "extent", "mesh"], json: { read: { reader: g$O.read } } })], j$x.prototype, "geometryType", void 0), e$2g([r$1P("geometryType")], j$x.prototype, "writeGeometryType", null), e$2g([y$1I({ type: Boolean, json: { write: { overridePolicy: (e2) => ({ enabled: e2 }) } } })], j$x.prototype, "hasM", void 0), e$2g([y$1I({ type: Boolean, json: { write: { overridePolicy: (e2) => ({ enabled: e2 }) } } })], j$x.prototype, "hasZ", void 0), e$2g([y$1I({ types: i$2S, json: { write: true } })], j$x.prototype, "queryGeometry", void 0), e$2g([o$29("queryGeometry")], j$x.prototype, "readQueryGeometry", null), e$2g([y$1I({ type: k$C, json: { write: true } })], j$x.prototype, "spatialReference", void 0), e$2g([r$1P("spatialReference")], j$x.prototype, "writeSpatialReference", null), e$2g([y$1I({ json: { write: true } })], j$x.prototype, "transform", void 0), j$x = d$Z = e$2g([n$2P("esri.rest.support.FeatureSet")], j$x), j$x.prototype.toJSON.isDefaultToJSON = true;
const x$A = j$x;
var FeatureSet = /* @__PURE__ */ Object.freeze({
  __proto__: null,
  [Symbol.toStringTag]: "Module",
  "default": x$A
});
const e$13 = { milliseconds: 1, seconds: 1e3, minutes: 6e4, hours: 36e5, days: 864e5, weeks: 6048e5, months: 26784e5, years: 31536e6, decades: 31536e7, centuries: 31536e8 }, t$1d = { milliseconds: { getter: "getMilliseconds", setter: "setMilliseconds", multiplier: 1 }, seconds: { getter: "getSeconds", setter: "setSeconds", multiplier: 1 }, minutes: { getter: "getMinutes", setter: "setMinutes", multiplier: 1 }, hours: { getter: "getHours", setter: "setHours", multiplier: 1 }, days: { getter: "getDate", setter: "setDate", multiplier: 1 }, weeks: { getter: "getDate", setter: "setDate", multiplier: 7 }, months: { getter: "getMonth", setter: "setMonth", multiplier: 1 }, years: { getter: "getFullYear", setter: "setFullYear", multiplier: 1 }, decades: { getter: "getFullYear", setter: "setFullYear", multiplier: 10 }, centuries: { getter: "getFullYear", setter: "setFullYear", multiplier: 100 } };
function s$1k(e2, t2) {
  const s2 = new Date(e2, t2 + 1, 1);
  return s2.setDate(0), s2.getDate();
}
function n$1G(e2, n2, r2) {
  const l2 = new Date(e2.getTime());
  if (n2 && r2) {
    const e3 = t$1d[r2], { getter: u2, setter: i2, multiplier: a2 } = e3;
    if (r2 === "months") {
      const e4 = s$1k(l2.getFullYear(), l2.getMonth() + n2);
      l2.getDate() > e4 && l2.setDate(e4);
    }
    l2[i2](l2[u2]() + n2 * a2);
  }
  return l2;
}
function l$1w(e2, t2) {
  switch (t2) {
    case "milliseconds":
      return new Date(e2.getTime());
    case "seconds":
      return new Date(e2.getFullYear(), e2.getMonth(), e2.getDate(), e2.getHours(), e2.getMinutes(), e2.getSeconds());
    case "minutes":
      return new Date(e2.getFullYear(), e2.getMonth(), e2.getDate(), e2.getHours(), e2.getMinutes());
    case "hours":
      return new Date(e2.getFullYear(), e2.getMonth(), e2.getDate(), e2.getHours());
    case "days":
      return new Date(e2.getFullYear(), e2.getMonth(), e2.getDate());
    case "weeks":
      return new Date(e2.getFullYear(), e2.getMonth(), e2.getDate() - e2.getDay());
    case "months":
      return new Date(e2.getFullYear(), e2.getMonth(), 1);
    case "years":
      return new Date(e2.getFullYear(), 0, 1);
    case "decades":
      return new Date(e2.getFullYear() - e2.getFullYear() % 10, 0, 1);
    case "centuries":
      return new Date(e2.getFullYear() - e2.getFullYear() % 100, 0, 1);
    default:
      return new Date();
  }
}
function g$N(t2, s2, n2) {
  if (t2 === 0)
    return 0;
  return t2 * e$13[s2] / e$13[n2];
}
var p$28;
let d$Y = p$28 = class extends l$2B {
  constructor(t2) {
    super(t2), this.end = null, this.start = null;
  }
  static get allTime() {
    return c$1P;
  }
  static get empty() {
    return h$10;
  }
  readEnd(t2, e2) {
    return e2.end != null ? new Date(e2.end) : null;
  }
  writeEnd(t2, e2) {
    e2.end = t2 ? t2.getTime() : null;
  }
  get isAllTime() {
    return this.equals(p$28.allTime);
  }
  get isEmpty() {
    return this.equals(p$28.empty);
  }
  readStart(t2, e2) {
    return e2.start != null ? new Date(e2.start) : null;
  }
  writeStart(t2, e2) {
    e2.start = t2 ? t2.getTime() : null;
  }
  clone() {
    return new p$28({ end: this.end, start: this.start });
  }
  equals(t2) {
    if (!t2)
      return false;
    const e2 = r$1$(this.start) ? this.start.getTime() : this.start, s2 = r$1$(this.end) ? this.end.getTime() : this.end, n2 = r$1$(t2.start) ? t2.start.getTime() : t2.start, i2 = r$1$(t2.end) ? t2.end.getTime() : t2.end;
    return e2 === n2 && s2 === i2;
  }
  expandTo(t2) {
    if (this.isEmpty || this.isAllTime)
      return this.clone();
    const e2 = o$2s(this.start, (e3) => l$1w(e3, t2)), r2 = o$2s(this.end, (e3) => {
      const r3 = l$1w(e3, t2);
      return e3.getTime() === r3.getTime() ? r3 : n$1G(r3, 1, t2);
    });
    return new p$28({ start: e2, end: r2 });
  }
  intersection(t2) {
    if (!t2)
      return this.clone();
    if (this.isEmpty || t2.isEmpty)
      return p$28.empty;
    if (this.isAllTime)
      return t2.clone();
    if (t2.isAllTime)
      return this.clone();
    const e2 = b$1d(this.start, -1 / 0, (t3) => t3.getTime()), r2 = b$1d(this.end, 1 / 0, (t3) => t3.getTime()), s2 = b$1d(t2.start, -1 / 0, (t3) => t3.getTime()), i2 = b$1d(t2.end, 1 / 0, (t3) => t3.getTime());
    let o2, l2;
    if (s2 >= e2 && s2 <= r2 ? o2 = s2 : e2 >= s2 && e2 <= i2 && (o2 = e2), r2 >= s2 && r2 <= i2 ? l2 = r2 : i2 >= e2 && i2 <= r2 && (l2 = i2), o2 != null && l2 != null && !isNaN(o2) && !isNaN(l2)) {
      const t3 = new p$28();
      return t3.start = o2 === -1 / 0 ? null : new Date(o2), t3.end = l2 === 1 / 0 ? null : new Date(l2), t3;
    }
    return p$28.empty;
  }
  offset(t2, e2) {
    if (this.isEmpty || this.isAllTime)
      return this.clone();
    const s2 = new p$28(), { start: n2, end: i2 } = this;
    return r$1$(n2) && (s2.start = n$1G(n2, t2, e2)), r$1$(i2) && (s2.end = n$1G(i2, t2, e2)), s2;
  }
  union(t2) {
    if (!t2 || t2.isEmpty)
      return this.clone();
    if (this.isEmpty)
      return t2.clone();
    if (this.isAllTime || t2.isAllTime)
      return c$1P.clone();
    const e2 = r$1$(this.start) && r$1$(t2.start) ? new Date(Math.min(this.start.getTime(), t2.start.getTime())) : null, s2 = r$1$(this.end) && r$1$(t2.end) ? new Date(Math.max(this.end.getTime(), t2.end.getTime())) : null;
    return new p$28({ start: e2, end: s2 });
  }
};
e$2g([y$1I({ type: Date, json: { write: { allowNull: true } } })], d$Y.prototype, "end", void 0), e$2g([o$29("end")], d$Y.prototype, "readEnd", null), e$2g([r$1P("end")], d$Y.prototype, "writeEnd", null), e$2g([y$1I({ readOnly: true, json: { read: false } })], d$Y.prototype, "isAllTime", null), e$2g([y$1I({ readOnly: true, json: { read: false } })], d$Y.prototype, "isEmpty", null), e$2g([y$1I({ type: Date, json: { write: { allowNull: true } } })], d$Y.prototype, "start", void 0), e$2g([o$29("start")], d$Y.prototype, "readStart", null), e$2g([r$1P("start")], d$Y.prototype, "writeStart", null), d$Y = p$28 = e$2g([n$2P("esri.TimeExtent")], d$Y);
const c$1P = new d$Y(), h$10 = new d$Y({ start: void 0, end: void 0 }), T$o = d$Y;
let i$1R = class extends i$2R(l$2B) {
  constructor(r2) {
    super(r2), this.onFields = null, this.operator = null, this.searchTerm = null, this.searchType = null;
  }
};
e$2g([y$1I({ type: [String], json: { write: { enabled: true, overridePolicy() {
  return { enabled: r$1$(this.onFields) && this.onFields.length > 0 };
} } } })], i$1R.prototype, "onFields", void 0), e$2g([y$1I({ type: String, json: { write: true } })], i$1R.prototype, "operator", void 0), e$2g([y$1I({ type: String, json: { write: true } })], i$1R.prototype, "searchTerm", void 0), e$2g([y$1I({ type: String, json: { write: true } })], i$1R.prototype, "searchType", void 0), i$1R = e$2g([n$2P("esri.rest.support.FullTextSearch")], i$1R);
const c$1O = i$1R;
var n$1F;
const c$1N = new s$2a({ upperLeft: "upper-left", lowerLeft: "lower-left" });
let m$1u = n$1F = class extends l$2B {
  constructor(e2) {
    super(e2), this.extent = null, this.mode = "view", this.originPosition = "upper-left", this.tolerance = 1;
  }
  clone() {
    return new n$1F(y$1L({ extent: this.extent, mode: this.mode, originPosition: this.originPosition, tolerance: this.tolerance }));
  }
};
e$2g([y$1I({ type: w$Z, json: { write: { overridePolicy() {
  return { enabled: this.mode === "view" };
} } } })], m$1u.prototype, "extent", void 0), e$2g([y$1I({ type: ["view", "edit"], json: { write: true } })], m$1u.prototype, "mode", void 0), e$2g([y$1I({ type: String, json: { read: c$1N.read, write: c$1N.write } })], m$1u.prototype, "originPosition", void 0), e$2g([y$1I({ type: Number, json: { write: { overridePolicy() {
  return { enabled: this.mode === "view" };
} } } })], m$1u.prototype, "tolerance", void 0), m$1u = n$1F = e$2g([n$2P("esri.rest.support.QuantizationParameters")], m$1u);
const a$1L = m$1u;
var c$1M;
const n$1E = new s$2a({ count: "count", sum: "sum", min: "min", max: "max", avg: "avg", stddev: "stddev", var: "var", exceedslimit: "exceedslimit", percentile_cont: "percentile-continuous", percentile_disc: "percentile-discrete", EnvelopeAggregate: "envelope-aggregate", CentroidAggregate: "centroid-aggregate", ConvexHullAggregate: "convex-hull-aggregate" });
let p$27 = c$1M = class extends l$2B {
  constructor(t2) {
    super(t2), this.maxPointCount = void 0, this.maxRecordCount = void 0, this.maxVertexCount = void 0, this.onStatisticField = null, this.outStatisticFieldName = null, this.statisticType = null, this.statisticParameters = null;
  }
  writeStatisticParameters(t2, e2) {
    this.statisticType !== "percentile-continuous" && this.statisticType !== "percentile-discrete" || (e2.statisticParameters = y$1L(t2));
  }
  clone() {
    return new c$1M({ maxPointCount: this.maxPointCount, maxRecordCount: this.maxRecordCount, maxVertexCount: this.maxVertexCount, onStatisticField: this.onStatisticField, outStatisticFieldName: this.outStatisticFieldName, statisticType: this.statisticType, statisticParameters: y$1L(this.statisticParameters) });
  }
};
e$2g([y$1I({ type: Number, json: { write: true } })], p$27.prototype, "maxPointCount", void 0), e$2g([y$1I({ type: Number, json: { write: true } })], p$27.prototype, "maxRecordCount", void 0), e$2g([y$1I({ type: Number, json: { write: true } })], p$27.prototype, "maxVertexCount", void 0), e$2g([y$1I({ type: String, json: { write: true } })], p$27.prototype, "onStatisticField", void 0), e$2g([y$1I({ type: String, json: { write: true } })], p$27.prototype, "outStatisticFieldName", void 0), e$2g([y$1I({ type: String, json: { read: { source: "statisticType", reader: n$1E.read }, write: { target: "statisticType", writer: n$1E.write } } })], p$27.prototype, "statisticType", void 0), e$2g([y$1I({ type: Object })], p$27.prototype, "statisticParameters", void 0), e$2g([r$1P("statisticParameters")], p$27.prototype, "writeStatisticParameters", null), p$27 = c$1M = e$2g([n$2P("esri.rest.support.StatisticDefinition")], p$27);
const m$1t = p$27;
var v$K;
const g$M = new s$2a({ esriSpatialRelIntersects: "intersects", esriSpatialRelContains: "contains", esriSpatialRelCrosses: "crosses", esriSpatialRelDisjoint: "disjoint", esriSpatialRelEnvelopeIntersects: "envelope-intersects", esriSpatialRelIndexIntersects: "index-intersects", esriSpatialRelOverlaps: "overlaps", esriSpatialRelTouches: "touches", esriSpatialRelWithin: "within", esriSpatialRelRelation: "relation" }), R$n = new s$2a({ esriSRUnit_Meter: "meters", esriSRUnit_Kilometer: "kilometers", esriSRUnit_Foot: "feet", esriSRUnit_StatuteMile: "miles", esriSRUnit_NauticalMile: "nautical-miles", esriSRUnit_USNauticalMile: "us-nautical-miles" });
let b$I = v$K = class extends l$2B {
  constructor(t2) {
    super(t2), this.aggregateIds = null, this.cacheHint = void 0, this.compactGeometryEnabled = false, this.datumTransformation = null, this.defaultSpatialReferenceEnabled = false, this.distance = void 0, this.dynamicDataSource = void 0, this.formatOf3DObjects = null, this.fullText = null, this.gdbVersion = null, this.geometry = null, this.geometryPrecision = void 0, this.groupByFieldsForStatistics = null, this.having = null, this.historicMoment = null, this.maxAllowableOffset = void 0, this.maxRecordCountFactor = 1, this.multipatchOption = null, this.num = void 0, this.objectIds = null, this.orderByFields = null, this.outFields = null, this.outSpatialReference = null, this.outStatistics = null, this.parameterValues = null, this.pixelSize = null, this.quantizationParameters = null, this.rangeValues = null, this.relationParameter = null, this.resultType = null, this.returnCentroid = false, this.returnDistinctValues = false, this.returnExceededLimitFeatures = true, this.returnGeometry = false, this.returnQueryGeometry = false, this.returnM = void 0, this.returnZ = void 0, this.sourceSpatialReference = null, this.spatialRelationship = "intersects", this.start = void 0, this.sqlFormat = null, this.text = null, this.timeExtent = null, this.timeReferenceUnknownClient = false, this.units = null, this.where = null;
  }
  static from(t2) {
    return v$1c(v$K, t2);
  }
  castDatumTransformation(t2) {
    return typeof t2 == "number" || typeof t2 == "object" ? t2 : null;
  }
  writeHistoricMoment(t2, e2) {
    e2.historicMoment = t2 && t2.getTime();
  }
  writeParameterValues(t2, e2) {
    if (t2) {
      const r2 = {};
      for (const e3 in t2) {
        const o2 = t2[e3];
        Array.isArray(o2) ? r2[e3] = o2.map((t3) => t3 instanceof Date ? t3.getTime() : t3) : o2 instanceof Date ? r2[e3] = o2.getTime() : r2[e3] = o2;
      }
      e2.parameterValues = r2;
    }
  }
  writeStart(t2, e2) {
    e2.resultOffset = this.start, e2.resultRecordCount = this.num || 10, e2.where = "1=1";
  }
  writeWhere(t2, e2) {
    e2.where = t2 || "1=1";
  }
  clone() {
    return new v$K(y$1L({ aggregateIds: this.aggregateIds, cacheHint: this.cacheHint, compactGeometryEnabled: this.compactGeometryEnabled, datumTransformation: this.datumTransformation, defaultSpatialReferenceEnabled: this.defaultSpatialReferenceEnabled, distance: this.distance, fullText: this.fullText, gdbVersion: this.gdbVersion, geometry: this.geometry, geometryPrecision: this.geometryPrecision, groupByFieldsForStatistics: this.groupByFieldsForStatistics, having: this.having, historicMoment: r$1$(this.historicMoment) ? new Date(this.historicMoment.getTime()) : null, maxAllowableOffset: this.maxAllowableOffset, maxRecordCountFactor: this.maxRecordCountFactor, multipatchOption: this.multipatchOption, num: this.num, objectIds: this.objectIds, orderByFields: this.orderByFields, outFields: this.outFields, outSpatialReference: this.outSpatialReference, outStatistics: this.outStatistics, parameterValues: this.parameterValues, pixelSize: this.pixelSize, quantizationParameters: this.quantizationParameters, rangeValues: this.rangeValues, relationParameter: this.relationParameter, resultType: this.resultType, returnDistinctValues: this.returnDistinctValues, returnGeometry: this.returnGeometry, returnCentroid: this.returnCentroid, returnExceededLimitFeatures: this.returnExceededLimitFeatures, returnQueryGeometry: this.returnQueryGeometry, returnM: this.returnM, returnZ: this.returnZ, dynamicDataSource: this.dynamicDataSource, sourceSpatialReference: this.sourceSpatialReference, spatialRelationship: this.spatialRelationship, start: this.start, sqlFormat: this.sqlFormat, text: this.text, timeExtent: this.timeExtent, timeReferenceUnknownClient: this.timeReferenceUnknownClient, units: this.units, where: this.where }));
  }
};
b$I.MAX_MAX_RECORD_COUNT_FACTOR = 5, e$2g([y$1I({ json: { write: true } })], b$I.prototype, "aggregateIds", void 0), e$2g([y$1I({ type: Boolean, json: { write: true } })], b$I.prototype, "cacheHint", void 0), e$2g([y$1I({ type: Boolean, json: { default: false, write: true } })], b$I.prototype, "compactGeometryEnabled", void 0), e$2g([y$1I({ json: { write: true } })], b$I.prototype, "datumTransformation", void 0), e$2g([s$2i("datumTransformation")], b$I.prototype, "castDatumTransformation", null), e$2g([y$1I({ type: Boolean, json: { default: false, write: true } })], b$I.prototype, "defaultSpatialReferenceEnabled", void 0), e$2g([y$1I({ type: Number, json: { write: { overridePolicy: (t2) => ({ enabled: t2 > 0 }) } } })], b$I.prototype, "distance", void 0), e$2g([y$1I({ type: K$c, json: { write: true } })], b$I.prototype, "dynamicDataSource", void 0), e$2g([y$1I({ type: String, json: { write: true } })], b$I.prototype, "formatOf3DObjects", void 0), e$2g([y$1I({ type: [c$1O], json: { write: { enabled: true, overridePolicy() {
  return { enabled: r$1$(this.fullText) && this.fullText.length > 0 };
} } } })], b$I.prototype, "fullText", void 0), e$2g([y$1I({ type: String, json: { write: true } })], b$I.prototype, "gdbVersion", void 0), e$2g([y$1I({ types: i$2S, json: { read: v$14, write: true } })], b$I.prototype, "geometry", void 0), e$2g([y$1I({ type: Number, json: { write: true } })], b$I.prototype, "geometryPrecision", void 0), e$2g([y$1I({ type: [String], json: { write: true } })], b$I.prototype, "groupByFieldsForStatistics", void 0), e$2g([y$1I({ type: String, json: { write: true } })], b$I.prototype, "having", void 0), e$2g([y$1I({ type: Date })], b$I.prototype, "historicMoment", void 0), e$2g([r$1P("historicMoment")], b$I.prototype, "writeHistoricMoment", null), e$2g([y$1I({ type: Number, json: { write: true } })], b$I.prototype, "maxAllowableOffset", void 0), e$2g([y$1I({ type: Number, cast: (t2) => t2 < 1 ? 1 : t2 > v$K.MAX_MAX_RECORD_COUNT_FACTOR ? v$K.MAX_MAX_RECORD_COUNT_FACTOR : t2, json: { write: { overridePolicy: (t2) => ({ enabled: t2 > 1 }) } } })], b$I.prototype, "maxRecordCountFactor", void 0), e$2g([y$1I({ type: ["xyFootprint"], json: { write: true } })], b$I.prototype, "multipatchOption", void 0), e$2g([y$1I({ type: Number, json: { read: { source: "resultRecordCount" } } })], b$I.prototype, "num", void 0), e$2g([y$1I({ json: { write: true } })], b$I.prototype, "objectIds", void 0), e$2g([y$1I({ type: [String], json: { write: true } })], b$I.prototype, "orderByFields", void 0), e$2g([y$1I({ type: [String], json: { write: true } })], b$I.prototype, "outFields", void 0), e$2g([y$1I({ type: k$C, json: { name: "outSR", write: true } })], b$I.prototype, "outSpatialReference", void 0), e$2g([y$1I({ type: [m$1t], json: { write: { enabled: true, overridePolicy() {
  return { enabled: r$1$(this.outStatistics) && this.outStatistics.length > 0 };
} } } })], b$I.prototype, "outStatistics", void 0), e$2g([y$1I({ json: { write: true } })], b$I.prototype, "parameterValues", void 0), e$2g([r$1P("parameterValues")], b$I.prototype, "writeParameterValues", null), e$2g([y$1I({ type: w$_, json: { write: true } })], b$I.prototype, "pixelSize", void 0), e$2g([y$1I({ type: a$1L, json: { write: true } })], b$I.prototype, "quantizationParameters", void 0), e$2g([y$1I({ type: [Object], json: { write: true } })], b$I.prototype, "rangeValues", void 0), e$2g([y$1I({ type: String, json: { read: { source: "relationParam" }, write: { target: "relationParam", overridePolicy() {
  return { enabled: this.spatialRelationship === "relation" };
} } } })], b$I.prototype, "relationParameter", void 0), e$2g([y$1I({ type: String, json: { write: true } })], b$I.prototype, "resultType", void 0), e$2g([y$1I({ type: Boolean, json: { default: false, write: true } })], b$I.prototype, "returnCentroid", void 0), e$2g([y$1I({ type: Boolean, json: { default: false, write: true } })], b$I.prototype, "returnDistinctValues", void 0), e$2g([y$1I({ type: Boolean, json: { default: true, write: true } })], b$I.prototype, "returnExceededLimitFeatures", void 0), e$2g([y$1I({ type: Boolean, json: { write: true } })], b$I.prototype, "returnGeometry", void 0), e$2g([y$1I({ type: Boolean, json: { default: false, write: true } })], b$I.prototype, "returnQueryGeometry", void 0), e$2g([y$1I({ type: Boolean, json: { default: false, write: true } })], b$I.prototype, "returnM", void 0), e$2g([y$1I({ type: Boolean, json: { write: { overridePolicy: (t2) => ({ enabled: t2 }) } } })], b$I.prototype, "returnZ", void 0), e$2g([y$1I({ type: k$C, json: { write: true } })], b$I.prototype, "sourceSpatialReference", void 0), e$2g([r$1H(g$M, { ignoreUnknown: false, name: "spatialRel" })], b$I.prototype, "spatialRelationship", void 0), e$2g([y$1I({ type: Number, json: { read: { source: "resultOffset" } } })], b$I.prototype, "start", void 0), e$2g([r$1P("start"), r$1P("num")], b$I.prototype, "writeStart", null), e$2g([y$1I({ type: String, json: { write: true } })], b$I.prototype, "sqlFormat", void 0), e$2g([y$1I({ type: String, json: { write: true } })], b$I.prototype, "text", void 0), e$2g([y$1I({ type: T$o, json: { write: true } })], b$I.prototype, "timeExtent", void 0), e$2g([y$1I({ type: Boolean, json: { default: false, write: true } })], b$I.prototype, "timeReferenceUnknownClient", void 0), e$2g([r$1H(R$n, { ignoreUnknown: false }), y$1I({ json: { write: { overridePolicy(t2) {
  return { enabled: !!t2 && this.distance != null && this.distance > 0 };
} } } })], b$I.prototype, "units", void 0), e$2g([y$1I({ type: String, json: { write: { overridePolicy(t2) {
  return { enabled: t2 != null || this.start != null && this.start > 0 };
} } } })], b$I.prototype, "where", void 0), e$2g([r$1P("where")], b$I.prototype, "writeWhere", null), b$I = v$K = e$2g([n$2P("esri.rest.support.Query")], b$I);
const x$z = b$I;
async function s$1j(r2, t2, e2) {
  const s2 = await a$1K(r2, t2, e2);
  return x$A.fromJSON(s2);
}
async function a$1K(o2, s2, a2) {
  const n2 = f$19(o2), i2 = __spreadValues({}, a2), p2 = x$z.from(s2), { data: u2 } = await c$1Q(n2, p2, p2.sourceSpatialReference, i2);
  return u2;
}
function h$$(t2, e2) {
  return t2 ? e2 ? 4 : 3 : e2 ? 3 : 2;
}
const d$X = s$2z.getLogger("esri.layers.graphics.featureConversionUtils"), m$1s = { esriGeometryPoint: 0, esriGeometryPolyline: 2, esriGeometryPolygon: 3, esriGeometryMultipoint: 0 }, g$L = (t2, e2, o2, n2, r2, s2) => {
  t2[o2] = r2, t2[o2 + 1] = s2;
}, y$T = (t2, e2, o2, n2, r2, s2) => {
  t2[o2] = r2, t2[o2 + 1] = s2, t2[o2 + 2] = e2[n2 + 2];
}, p$26 = (t2, e2, o2, n2, r2, s2) => {
  t2[o2] = r2, t2[o2 + 1] = s2, t2[o2 + 2] = e2[n2 + 3];
}, I$s = (t2, e2, o2, n2, r2, s2) => {
  t2[o2] = r2, t2[o2 + 1] = s2, t2[o2 + 2] = e2[n2 + 2], t2[o2 + 3] = e2[n2 + 3];
};
function b$H(t2, e2, o2, n2) {
  if (t2) {
    if (o2)
      return e2 && n2 ? I$s : y$T;
    if (e2 && n2)
      return p$26;
  } else if (e2 && n2)
    return y$T;
  return g$L;
}
function w$C({ scale: t2, translate: e2 }, o2) {
  return Math.round((o2 - e2[0]) / t2[0]);
}
function M$n({ scale: t2, translate: e2 }, o2) {
  return Math.round((e2[1] - o2) / t2[1]);
}
function T$n({ scale: t2, translate: e2 }, o2, n2) {
  return o2 * t2[n2] + e2[n2];
}
function F$m(t2, e2, o2) {
  return t2 ? e2 ? o2 ? E$v(t2) : Z$a(t2) : o2 ? k$k(t2) : P$n(t2) : null;
}
function P$n(t2) {
  const e2 = t2.coords;
  return { x: e2[0], y: e2[1] };
}
function x$y(t2, e2) {
  return t2.coords[0] = e2.x, t2.coords[1] = e2.y, t2;
}
function Z$a(t2) {
  const e2 = t2.coords;
  return { x: e2[0], y: e2[1], z: e2[2] };
}
function j$w(t2, e2) {
  return t2.coords[0] = e2.x, t2.coords[1] = e2.y, t2.coords[2] = e2.z, t2;
}
function k$k(t2) {
  const e2 = t2.coords;
  return { x: e2[0], y: e2[1], m: e2[2] };
}
function v$J(t2, e2) {
  return t2.coords[0] = e2.x, t2.coords[1] = e2.y, t2.coords[2] = e2.m, t2;
}
function E$v(t2) {
  const e2 = t2.coords;
  return { x: e2[0], y: e2[1], z: e2[2], m: e2[3] };
}
function z$t(t2, e2) {
  return t2.coords[0] = e2.x, t2.coords[1] = e2.y, t2.coords[2] = e2.z, t2.coords[3] = e2.m, t2;
}
function S$v(t2, e2, n2, r2) {
  let s2 = P$n;
  n2 && r2 ? s2 = E$v : n2 ? s2 = Z$a : r2 && (s2 = k$k);
  for (const c2 of e2) {
    const { geometry: e3, attributes: n3 } = c2, r3 = r$1$(e3) ? s2(e3) : null;
    t2.push({ attributes: n3, geometry: r3 });
  }
  return t2;
}
function V$i(t2, e2) {
  return t2 && e2 ? z$t : t2 ? j$w : e2 ? v$J : x$y;
}
function Y$8(t2, e2, n2, r2, s2) {
  const c2 = V$i(n2, r2);
  for (const { geometry: u2, attributes: l2 } of e2) {
    const e3 = r$1$(u2) ? c2(new t$1f(), u2) : null;
    t2.push(new s$1l(e3, l2, null, s2 ? l2[s2] : void 0));
  }
  return t2;
}
function _$v(t2, e2, o2 = V$i(e2.z != null, e2.m != null)) {
  return o2(t2, e2);
}
function L$k(t2, e2, n2, r2) {
  for (const { geometry: s2, attributes: c2 } of e2)
    t2.push({ attributes: c2, geometry: r$1$(s2) ? O$m(s2, n2, r2) : null });
  return t2;
}
function O$m(t2, e2, o2) {
  if (t$2r(t2))
    return null;
  const r2 = h$$(e2, o2), s2 = [];
  for (let n2 = 0; n2 < t2.coords.length; n2 += r2) {
    const e3 = [];
    for (let o3 = 0; o3 < r2; o3++)
      e3.push(t2.coords[n2 + o3]);
    s2.push(e3);
  }
  return e2 ? o2 ? { points: s2, hasZ: e2, hasM: o2 } : { points: s2, hasZ: e2 } : o2 ? { points: s2, hasM: o2 } : { points: s2 };
}
function U$i(t2, e2, n2, r2, s2) {
  const c2 = h$$(n2, r2);
  for (const { geometry: u2, attributes: l2 } of e2) {
    const e3 = r$1$(u2) ? A$h(new t$1f(), u2, c2) : null;
    t2.push(new s$1l(e3, l2, null, s2 ? l2[s2] : void 0));
  }
  return t2;
}
function A$h(t2, e2, o2 = h$$(e2.hasZ, e2.hasM)) {
  t2.lengths[0] = e2.points.length;
  const n2 = t2.coords;
  let r2 = 0;
  for (const s2 of e2.points)
    for (let t3 = 0; t3 < o2; t3++)
      n2[r2++] = s2[t3];
  return t2;
}
function q$g(t2, e2, n2, r2) {
  for (const { geometry: s2, attributes: c2 } of e2)
    t2.push({ attributes: c2, geometry: r$1$(s2) ? $$9(s2, n2, r2) : null });
  return t2;
}
function $$9(t2, e2, o2) {
  if (!t2)
    return null;
  const n2 = h$$(e2, o2), { coords: r2, lengths: s2 } = t2, c2 = [];
  let u2 = 0;
  for (const l2 of s2) {
    const t3 = [];
    for (let e3 = 0; e3 < l2; e3++) {
      const e4 = [];
      for (let t4 = 0; t4 < n2; t4++)
        e4.push(r2[u2++]);
      t3.push(e4);
    }
    c2.push(t3);
  }
  return e2 ? o2 ? { paths: c2, hasZ: e2, hasM: o2 } : { paths: c2, hasZ: e2 } : o2 ? { paths: c2, hasM: o2 } : { paths: c2 };
}
function R$m(t2, e2, n2, r2, s2) {
  const c2 = h$$(n2, r2);
  for (const { geometry: u2, attributes: l2 } of e2) {
    const e3 = r$1$(u2) ? C$r(new t$1f(), u2, c2) : null;
    t2.push(new s$1l(e3, l2, null, s2 ? l2[s2] : void 0));
  }
  return t2;
}
function C$r(t2, e2, o2 = h$$(e2.hasZ, e2.hasM)) {
  const { lengths: n2, coords: r2 } = t2;
  let s2 = 0;
  for (const c2 of e2.paths) {
    for (const t3 of c2)
      for (let e3 = 0; e3 < o2; e3++)
        r2[s2++] = t3[e3];
    n2.push(c2.length);
  }
  return t2;
}
function B$h(t2, e2, n2, r2) {
  for (const { geometry: s2, attributes: c2, centroid: u2 } of e2) {
    const e3 = r$1$(s2) ? D$i(s2, n2, r2) : null;
    if (r$1$(u2)) {
      const o2 = P$n(u2);
      t2.push({ attributes: c2, centroid: o2, geometry: e3 });
    } else
      t2.push({ attributes: c2, geometry: e3 });
  }
  return t2;
}
function D$i(t2, e2, o2) {
  if (!t2)
    return null;
  const n2 = h$$(e2, o2), { coords: r2, lengths: s2 } = t2, c2 = [];
  let u2 = 0;
  for (const l2 of s2) {
    const t3 = [];
    for (let e3 = 0; e3 < l2; e3++) {
      const e4 = [];
      for (let t4 = 0; t4 < n2; t4++)
        e4.push(r2[u2++]);
      t3.push(e4);
    }
    c2.push(t3);
  }
  return e2 ? o2 ? { rings: c2, hasZ: e2, hasM: o2 } : { rings: c2, hasZ: e2 } : o2 ? { rings: c2, hasM: o2 } : { rings: c2 };
}
function H$d(t2, e2, n2, r2, s2) {
  for (const { geometry: c2, centroid: u2, attributes: l2 } of e2) {
    const e3 = r$1$(c2) ? J$h(new t$1f(), c2, n2, r2) : null, f2 = s2 ? l2[s2] : void 0;
    r$1$(u2) ? t2.push(new s$1l(e3, l2, x$y(new t$1f(), u2), f2)) : t2.push(new s$1l(e3, l2, null, f2));
  }
  return t2;
}
function J$h(t2, e2, o2 = e2.hasZ, n2 = e2.hasM) {
  return K$b(t2, e2.rings, o2, n2), t2;
}
function K$b(t2, e2, o2, n2) {
  const r2 = h$$(o2, n2), { lengths: s2, coords: c2 } = t2;
  let u2 = 0;
  Tt(t2);
  for (const l2 of e2) {
    for (const t3 of l2)
      for (let e3 = 0; e3 < r2; e3++)
        c2[u2++] = t3[e3];
    s2.push(l2.length);
  }
  return t2;
}
const Q$b = [], W$b = [];
function X$9(t2, e2, o2, n2, r2) {
  Q$b[0] = t2;
  const [s2] = tt$3(W$b, Q$b, e2, o2, n2, r2);
  return Ft(Q$b), Ft(W$b), s2;
}
function tt$3(e2, o2, n2, r2, s2, c2) {
  if (Ft(e2), !n2) {
    for (const t2 of o2) {
      const o3 = c2 ? t2.attributes[c2] : void 0;
      e2.push(new s$1l(null, t2.attributes, null, o3));
    }
    return e2;
  }
  switch (n2) {
    case "esriGeometryPoint":
      return Y$8(e2, o2, r2, s2, c2);
    case "esriGeometryMultipoint":
      return U$i(e2, o2, r2, s2, c2);
    case "esriGeometryPolyline":
      return R$m(e2, o2, r2, s2, c2);
    case "esriGeometryPolygon":
      return H$d(e2, o2, r2, s2, c2);
    default:
      d$X.error("convertToFeatureSet:unknown-geometry", new s$2u(`Unable to parse unknown geometry type '${n2}'`)), Ft(e2);
  }
  return e2;
}
function et$1(e2, o2, n2, r2, s2, c2) {
  const u2 = e2.length;
  switch (n2) {
    case "esriGeometryPoint":
      Y$8(e2, o2, r2, s2, c2);
      break;
    case "esriGeometryMultipoint":
      U$i(e2, o2, r2, s2, c2);
      break;
    case "esriGeometryPolyline":
      R$m(e2, o2, r2, s2, c2);
      break;
    case "esriGeometryPolygon":
      H$d(e2, o2, r2, s2, c2);
      break;
    default:
      d$X.error("convertToFeatureSet:unknown-geometry", new s$2u(`Unable to parse unknown geometry type '${n2}'`));
  }
  for (let t2 = 0; t2 < o2.length; t2++)
    e2[t2 + u2].geometryType = n2, e2[t2 + u2].insertAfter = o2[t2].insertAfter, e2[t2 + u2].groupId = o2[t2].groupId;
  return e2;
}
function ot$2(t2, e2, o2, n2) {
  W$b[0] = t2, ct$1(Q$b, W$b, e2, o2, n2);
  const r2 = Q$b[0];
  return Ft(Q$b), Ft(W$b), r2;
}
function nt$3(e2, o2, r2) {
  if (t$2r(e2))
    return null;
  const i2 = new t$1f();
  if ("hasZ" in e2 && o2 == null && (o2 = e2.hasZ), "hasM" in e2 && r2 == null && (r2 = e2.hasM), s$29(e2)) {
    return V$i(o2 != null ? o2 : e2.z != null, r2 != null ? r2 : e2.m != null)(i2, e2);
  }
  return y$1t(e2) ? J$h(i2, e2, o2, r2) : f$1H(e2) ? C$r(i2, e2, h$$(o2, r2)) : l$2t(e2) ? A$h(i2, e2, h$$(o2, r2)) : void d$X.error("convertFromGeometry:unknown-geometry", new s$2u(`Unable to parse unknown geometry type '${e2}'`));
}
function rt$1(e2, o2, r2, s2) {
  const c2 = e2 && ("coords" in e2 ? e2 : e2.geometry);
  if (t$2r(c2))
    return null;
  switch (o2) {
    case "esriGeometryPoint": {
      let t2 = P$n;
      return r2 && s2 ? t2 = E$v : r2 ? t2 = Z$a : s2 && (t2 = k$k), t2(c2);
    }
    case "esriGeometryMultipoint":
      return O$m(c2, r2, s2);
    case "esriGeometryPolyline":
      return $$9(c2, r2, s2);
    case "esriGeometryPolygon":
      return D$i(c2, r2, s2);
    default:
      return d$X.error("convertToGeometry:unknown-geometry", new s$2u(`Unable to parse unknown geometry type '${o2}'`)), null;
  }
}
function st$2(t2, e2) {
  for (const o2 of e2)
    t2.push({ attributes: o2.attributes });
  return t2;
}
function ct$1(e2, o2, r2, s2, c2) {
  if (Ft(e2), t$2r(r2))
    return st$2(e2, o2);
  switch (r2) {
    case "esriGeometryPoint":
      return S$v(e2, o2, s2, c2);
    case "esriGeometryMultipoint":
      return L$k(e2, o2, s2, c2);
    case "esriGeometryPolyline":
      return q$g(e2, o2, s2, c2);
    case "esriGeometryPolygon":
      return B$h(e2, o2, s2, c2);
    default:
      d$X.error("convertToFeatureSet:unknown-geometry", new s$2u(`Unable to parse unknown geometry type '${r2}'`));
  }
  return e2;
}
function ut$1(t2) {
  const { objectIdFieldName: e2, spatialReference: o2, transform: n2, fields: r2, hasM: s2, hasZ: c2, features: u2, geometryType: l2, exceededTransferLimit: i2, uniqueIdField: f2, queryGeometry: a2, queryGeometryType: h2 } = t2, d2 = { features: ct$1([], u2, l2, c2, s2), fields: r2, geometryType: l2, objectIdFieldName: e2, spatialReference: o2, uniqueIdField: f2, queryGeometry: rt$1(a2, h2, false, false) };
  return n2 && (d2.transform = n2), i2 && (d2.exceededTransferLimit = i2), s2 && (d2.hasM = s2), c2 && (d2.hasZ = c2), d2;
}
function lt$1(e2, o2) {
  var _a2;
  const n2 = new e$14(), { hasM: r2, hasZ: s2, features: c2, objectIdFieldName: u2, spatialReference: l2, geometryType: i2, exceededTransferLimit: a2, transform: h2, fields: m2 } = e2;
  return m2 && (n2.fields = m2), n2.geometryType = i2 != null ? i2 : null, n2.objectIdFieldName = (_a2 = u2 != null ? u2 : o2) != null ? _a2 : null, n2.spatialReference = l2 != null ? l2 : null, n2.objectIdFieldName ? (c2 && tt$3(n2.features, c2, i2, s2, r2, n2.objectIdFieldName), a2 && (n2.exceededTransferLimit = a2), r2 && (n2.hasM = r2), s2 && (n2.hasZ = s2), h2 && (n2.transform = h2), n2) : (d$X.error(new s$2u("optimized-features:invalid-objectIdFieldName", "objectIdFieldName is missing")), n2);
}
function it$1(t2) {
  const { transform: e2, features: n2, hasM: r2, hasZ: s2 } = t2;
  if (!e2)
    return t2;
  for (const c2 of n2)
    r$1$(c2.geometry) && pt$1(c2.geometry, c2.geometry, r2, s2, e2), r$1$(c2.centroid) && pt$1(c2.centroid, c2.centroid, r2, s2, e2);
  return t2.transform = null, t2;
}
function ft$1(t2, e2) {
  const { geometryType: o2, features: n2, hasM: r2, hasZ: s2 } = e2;
  if (!t2)
    return e2;
  for (let c2 = 0; c2 < n2.length; c2++) {
    const e3 = n2[c2], u2 = e3.weakClone();
    u2.geometry = new t$1f(), at$2(u2.geometry, e3.geometry, r2, s2, o2, t2), e3.centroid && (u2.centroid = new t$1f(), at$2(u2.centroid, e3.centroid, r2, s2, "esriGeometryPoint", t2)), n2[c2] = u2;
  }
  return e2.transform = t2, e2;
}
function at$2(t2, e2, o2, r2, s2, c2, u2 = o2, l2 = r2) {
  if (Tt(t2), t$2r(e2) || !e2.coords.length)
    return null;
  const i2 = m$1s[s2], { coords: f2, lengths: a2 } = e2, d2 = h$$(o2, r2), g2 = h$$(o2 && u2, r2 && l2), y2 = b$H(o2, r2, u2, l2);
  if (!a2.length)
    return y2(t2.coords, f2, 0, 0, w$C(c2, f2[0]), M$n(c2, f2[1])), Tt(t2, d2, 0), t2;
  let p2, I2, N2, G2, T2 = 0, F2 = 0, P2 = F2;
  for (const n2 of a2) {
    if (n2 < i2)
      continue;
    let e3 = 0;
    F2 = P2, N2 = p2 = w$C(c2, f2[T2]), G2 = I2 = M$n(c2, f2[T2 + 1]), y2(t2.coords, f2, F2, T2, N2, G2), e3++, T2 += d2, F2 += g2;
    for (let o3 = 1; o3 < n2; o3++, T2 += d2)
      N2 = w$C(c2, f2[T2]), G2 = M$n(c2, f2[T2 + 1]), N2 === p2 && G2 === I2 || (y2(t2.coords, f2, F2, T2, N2 - p2, G2 - I2), F2 += g2, e3++, p2 = N2, I2 = G2);
    e3 >= i2 && (t2.lengths.push(e3), P2 = F2);
  }
  return Ft(t2.coords, P2), t2.coords.length ? t2 : null;
}
function ht$1(t2, e2, o2, n2, r2, s2, c2 = o2, u2 = n2) {
  if (Tt(t2), !e2 || !e2.coords.length)
    return null;
  const l2 = m$1s[r2], { coords: i2, lengths: f2 } = e2, a2 = h$$(o2, n2), d2 = h$$(o2 && c2, n2 && u2), g2 = b$H(o2, n2, c2, u2);
  if (!f2.length)
    return g2(t2.coords, i2, 0, 0, i2[0], i2[1]), Tt(t2, a2, 0), t2;
  let y2 = 0;
  const p2 = s2 * s2;
  for (const h2 of f2) {
    if (h2 < l2) {
      y2 += h2 * a2;
      continue;
    }
    const e3 = t2.coords.length / d2, o3 = y2, n3 = y2 + (h2 - 1) * a2;
    g2(t2.coords, i2, t2.coords.length, o3, i2[o3], i2[o3 + 1]), mt$1(t2.coords, i2, a2, p2, g2, o3, n3), g2(t2.coords, i2, t2.coords.length, n3, i2[n3], i2[n3 + 1]);
    const r3 = t2.coords.length / d2 - e3;
    r3 >= l2 ? t2.lengths.push(r3) : Ft(t2.coords, e3 * d2), y2 += h2 * a2;
  }
  return t2.coords.length ? t2 : null;
}
function dt$1(t2, e2, o2, n2) {
  const r2 = t2[e2], s2 = t2[e2 + 1], c2 = t2[o2], u2 = t2[o2 + 1], l2 = t2[n2], i2 = t2[n2 + 1];
  let f2 = c2, a2 = u2, h2 = l2 - f2, d2 = i2 - a2;
  if (h2 !== 0 || d2 !== 0) {
    const t3 = ((r2 - f2) * h2 + (s2 - a2) * d2) / (h2 * h2 + d2 * d2);
    t3 > 1 ? (f2 = l2, a2 = i2) : t3 > 0 && (f2 += h2 * t3, a2 += d2 * t3);
  }
  return h2 = r2 - f2, d2 = s2 - a2, h2 * h2 + d2 * d2;
}
function mt$1(t2, e2, o2, n2, r2, s2, c2) {
  let u2, l2 = n2, i2 = 0;
  for (let f2 = s2 + o2; f2 < c2; f2 += o2)
    u2 = dt$1(e2, f2, s2, c2), u2 > l2 && (i2 = f2, l2 = u2);
  l2 > n2 && (i2 - s2 > o2 && mt$1(t2, e2, o2, n2, r2, s2, i2), r2(t2, e2, t2.length, i2, e2[i2], e2[i2 + 1]), c2 - i2 > o2 && mt$1(t2, e2, o2, n2, r2, i2, c2));
}
function gt$1(t2, e2, o2, r2) {
  if (t$2r(e2) || !e2.coords || !e2.coords.length)
    return null;
  const s2 = h$$(o2, r2);
  let c2 = Number.POSITIVE_INFINITY, u2 = Number.POSITIVE_INFINITY, l2 = Number.NEGATIVE_INFINITY, i2 = Number.NEGATIVE_INFINITY;
  if (e2 && e2.coords) {
    const t3 = e2.coords;
    for (let e3 = 0; e3 < t3.length; e3 += s2) {
      const o3 = t3[e3], n2 = t3[e3 + 1];
      c2 = Math.min(c2, o3), l2 = Math.max(l2, o3), u2 = Math.min(u2, n2), i2 = Math.max(i2, n2);
    }
  }
  return t2[0] = c2, t2[1] = u2, t2[2] = l2, t2[3] = i2, t2;
}
function pt$1(t2, e2, o2, n2, s2) {
  var _a2, _b2, _c2, _d2, _e3, _f2, _g2, _h2;
  const { coords: c2, lengths: u2 } = e2, l2 = h$$(o2, n2);
  if (!c2.length)
    return t2 !== e2 && Tt(t2), t2;
  c$3u(s2);
  const { originPosition: i2, scale: f2, translate: a2 } = s2, d2 = Pt;
  d2.originPosition = i2;
  const m2 = d2.scale;
  m2[0] = (_a2 = f2[0]) != null ? _a2 : 1, m2[1] = -((_b2 = f2[1]) != null ? _b2 : 1), m2[2] = (_c2 = f2[2]) != null ? _c2 : 1, m2[3] = (_d2 = f2[3]) != null ? _d2 : 1;
  const g2 = d2.translate;
  if (g2[0] = (_e3 = a2[0]) != null ? _e3 : 0, g2[1] = (_f2 = a2[1]) != null ? _f2 : 0, g2[2] = (_g2 = a2[2]) != null ? _g2 : 0, g2[3] = (_h2 = a2[3]) != null ? _h2 : 0, !u2.length) {
    for (let e3 = 0; e3 < l2; ++e3)
      t2.coords[e3] = T$n(d2, c2[e3], e3);
    return t2 !== e2 && Tt(t2, l2, 0), t2;
  }
  let y2 = 0;
  for (let r2 = 0; r2 < u2.length; r2++) {
    const e3 = u2[r2];
    t2.lengths[r2] = e3;
    for (let r3 = 0; r3 < l2; ++r3)
      t2.coords[y2 + r3] = T$n(d2, c2[y2 + r3], r3);
    let o3 = t2.coords[y2], n3 = t2.coords[y2 + 1];
    y2 += l2;
    for (let r3 = 1; r3 < e3; r3++, y2 += l2) {
      o3 += c2[y2] * m2[0], n3 += c2[y2 + 1] * m2[1], t2.coords[y2] = o3, t2.coords[y2 + 1] = n3;
      for (let e4 = 2; e4 < l2; ++e4)
        t2.coords[y2 + e4] = T$n(d2, c2[y2 + e4], e4);
    }
  }
  return t2 !== e2 && Tt(t2, c2.length, u2.length), t2;
}
function It(t2, e2, o2, n2, r2, s2) {
  if (Tt(t2), t2.lengths.push(...e2.lengths), o2 === r2 && n2 === s2)
    for (let c2 = 0; c2 < e2.coords.length; c2++)
      t2.coords.push(e2.coords[c2]);
  else {
    const c2 = h$$(o2, n2), u2 = b$H(o2, n2, r2, s2), l2 = e2.coords;
    for (let e3 = 0; e3 < l2.length; e3 += c2)
      u2(t2.coords, l2, t2.coords.length, e3, l2[e3], l2[e3 + 1]);
  }
  return t2;
}
function wt$1(t2, e2, o2, n2) {
  let r2 = 0, s2 = t2[n2 * e2], c2 = t2[n2 * (e2 + 1)];
  for (let u2 = 1; u2 < o2; u2++) {
    const o3 = s2 + t2[n2 * (e2 + u2)], l2 = c2 + t2[n2 * (e2 + u2) + 1], i2 = (o3 - s2) * (l2 + c2);
    s2 = o3, c2 = l2, r2 += i2;
  }
  return 0.5 * r2;
}
function Mt(t2, e2) {
  const { coords: o2, lengths: n2 } = t2;
  let r2 = 0, s2 = 0;
  for (let c2 = 0; c2 < n2.length; c2++) {
    const t3 = n2[c2];
    s2 += wt$1(o2, r2, t3, e2), r2 += t3;
  }
  return Math.abs(s2);
}
function Gt$1(t2, e2) {
  if (t$2r(t2))
    return null;
  const o2 = t2.clone(), r2 = t2.coords, s2 = t2.lengths;
  let c2 = 0;
  for (let n2 = 0; n2 < s2.length; n2++) {
    const t3 = s2[n2];
    let u2 = r2[e2 * c2], l2 = r2[e2 * c2 + 1];
    for (let n3 = 1; n3 < t3; n3++) {
      const t4 = u2 + r2[e2 * (c2 + n3)], s3 = l2 + r2[e2 * (c2 + n3) + 1];
      o2.coords[e2 * (c2 + n3)] = t4, o2.coords[e2 * (c2 + n3) + 1] = s3, u2 = t4, l2 = s3;
    }
    c2 += t3;
  }
  return o2;
}
function Tt(t2, e2 = 0, o2 = 0) {
  Ft(t2.lengths, o2), Ft(t2.coords, e2);
}
function Ft(t2, e2 = 0) {
  t2.length !== e2 && (t2.length = e2);
}
const Pt = { originPosition: "lowerLeft", scale: [1, 1, 1, 1], translate: [0, 0, 0, 0] };
var u$1c;
let c$1L = u$1c = class extends l$2B {
  constructor(t2) {
    super(t2), this.cacheHint = void 0, this.dynamicDataSource = void 0, this.gdbVersion = null, this.geometryPrecision = void 0, this.historicMoment = null, this.maxAllowableOffset = void 0, this.objectIds = null, this.orderByFields = null, this.outFields = null, this.outSpatialReference = null, this.relationshipId = void 0, this.start = void 0, this.num = void 0, this.returnGeometry = false, this.returnM = void 0, this.returnZ = void 0, this.where = null;
  }
  _writeHistoricMoment(t2, e2) {
    e2.historicMoment = t2 && t2.getTime();
  }
  writeStart(t2, e2) {
    e2.resultOffset = this.start, e2.resultRecordCount = this.num || 10, this.start > 0 && this.where == null && (e2.definitionExpression = "1=1");
  }
  clone() {
    return new u$1c(y$1L({ cacheHint: this.cacheHint, dynamicDataSource: this.dynamicDataSource, gdbVersion: this.gdbVersion, geometryPrecision: this.geometryPrecision, historicMoment: this.historicMoment && new Date(this.historicMoment.getTime()), maxAllowableOffset: this.maxAllowableOffset, objectIds: this.objectIds, orderByFields: this.orderByFields, outFields: this.outFields, outSpatialReference: this.outSpatialReference, relationshipId: this.relationshipId, start: this.start, num: this.num, returnGeometry: this.returnGeometry, where: this.where, returnZ: this.returnZ, returnM: this.returnM }));
  }
};
e$2g([y$1I({ type: Boolean, json: { write: true } })], c$1L.prototype, "cacheHint", void 0), e$2g([y$1I({ type: K$c, json: { write: true } })], c$1L.prototype, "dynamicDataSource", void 0), e$2g([y$1I({ type: String, json: { write: true } })], c$1L.prototype, "gdbVersion", void 0), e$2g([y$1I({ type: Number, json: { write: true } })], c$1L.prototype, "geometryPrecision", void 0), e$2g([y$1I({ type: Date })], c$1L.prototype, "historicMoment", void 0), e$2g([r$1P("historicMoment")], c$1L.prototype, "_writeHistoricMoment", null), e$2g([y$1I({ type: Number, json: { write: true } })], c$1L.prototype, "maxAllowableOffset", void 0), e$2g([y$1I({ type: [Number], json: { write: true } })], c$1L.prototype, "objectIds", void 0), e$2g([y$1I({ type: [String], json: { write: true } })], c$1L.prototype, "orderByFields", void 0), e$2g([y$1I({ type: [String], json: { write: true } })], c$1L.prototype, "outFields", void 0), e$2g([y$1I({ type: k$C, json: { read: { source: "outSR" }, write: { target: "outSR" } } })], c$1L.prototype, "outSpatialReference", void 0), e$2g([y$1I({ json: { write: true } })], c$1L.prototype, "relationshipId", void 0), e$2g([y$1I({ type: Number, json: { read: { source: "resultOffset" } } })], c$1L.prototype, "start", void 0), e$2g([r$1P("start"), r$1P("num")], c$1L.prototype, "writeStart", null), e$2g([y$1I({ type: Number, json: { read: { source: "resultRecordCount" } } })], c$1L.prototype, "num", void 0), e$2g([y$1I({ json: { write: true } })], c$1L.prototype, "returnGeometry", void 0), e$2g([y$1I({ type: Boolean, json: { write: { overridePolicy: (t2) => ({ enabled: t2 }) } } })], c$1L.prototype, "returnM", void 0), e$2g([y$1I({ type: Boolean, json: { write: { overridePolicy: (t2) => ({ enabled: t2 }) } } })], c$1L.prototype, "returnZ", void 0), e$2g([y$1I({ type: String, json: { read: { source: "definitionExpression" }, write: { target: "definitionExpression" } } })], c$1L.prototype, "where", void 0), c$1L = u$1c = e$2g([n$2P("esri.rest.support.RelationshipQuery")], c$1L), c$1L.from = b$1a(c$1L);
const d$W = c$1L;
var e$12;
let p$25 = e$12 = class extends l$2B {
  constructor(o2) {
    super(o2), this.groupByFields = void 0, this.topCount = void 0, this.orderByFields = void 0;
  }
  clone() {
    return new e$12({ groupByFields: this.groupByFields, topCount: this.topCount, orderByFields: this.orderByFields });
  }
};
e$2g([y$1I({ type: [String], json: { write: true } })], p$25.prototype, "groupByFields", void 0), e$2g([y$1I({ type: Number, json: { write: true } })], p$25.prototype, "topCount", void 0), e$2g([y$1I({ type: [String], json: { write: true } })], p$25.prototype, "orderByFields", void 0), p$25 = e$12 = e$2g([n$2P("esri.rest.support.TopFilter")], p$25);
const i$1Q = p$25;
var y$S;
const h$_ = new s$2a({ esriSpatialRelIntersects: "intersects", esriSpatialRelContains: "contains", esriSpatialRelCrosses: "crosses", esriSpatialRelDisjoint: "disjoint", esriSpatialRelEnvelopeIntersects: "envelope-intersects", esriSpatialRelIndexIntersects: "index-intersects", esriSpatialRelOverlaps: "overlaps", esriSpatialRelTouches: "touches", esriSpatialRelWithin: "within", esriSpatialRelRelation: "relation" }), j$v = new s$2a({ esriSRUnit_Meter: "meters", esriSRUnit_Kilometer: "kilometers", esriSRUnit_Foot: "feet", esriSRUnit_StatuteMile: "miles", esriSRUnit_NauticalMile: "nautical-miles", esriSRUnit_USNauticalMile: "us-nautical-miles" });
let S$u = y$S = class extends l$2B {
  constructor(e2) {
    super(e2), this.cacheHint = void 0, this.distance = void 0, this.geometry = null, this.geometryPrecision = void 0, this.maxAllowableOffset = void 0, this.num = void 0, this.objectIds = null, this.orderByFields = null, this.outFields = null, this.outSpatialReference = null, this.resultType = null, this.returnGeometry = false, this.returnM = void 0, this.returnZ = void 0, this.start = void 0, this.spatialRelationship = "intersects", this.timeExtent = null, this.topFilter = void 0, this.units = null, this.where = "1=1";
  }
  writeStart(e2, t2) {
    t2.resultOffset = this.start, t2.resultRecordCount = this.num || 10;
  }
  clone() {
    return new y$S(y$1L({ cacheHint: this.cacheHint, distance: this.distance, geometry: this.geometry, geometryPrecision: this.geometryPrecision, maxAllowableOffset: this.maxAllowableOffset, num: this.num, objectIds: this.objectIds, orderByFields: this.orderByFields, outFields: this.outFields, outSpatialReference: this.outSpatialReference, resultType: this.resultType, returnGeometry: this.returnGeometry, returnZ: this.returnZ, returnM: this.returnM, start: this.start, spatialRelationship: this.spatialRelationship, timeExtent: this.timeExtent, topFilter: this.topFilter, units: this.units, where: this.where }));
  }
};
e$2g([y$1I({ type: Boolean, json: { write: true } })], S$u.prototype, "cacheHint", void 0), e$2g([y$1I({ type: Number, json: { write: { overridePolicy: (e2) => ({ enabled: e2 > 0 }) } } })], S$u.prototype, "distance", void 0), e$2g([y$1I({ types: i$2S, json: { read: v$14, write: true } })], S$u.prototype, "geometry", void 0), e$2g([y$1I({ type: Number, json: { write: true } })], S$u.prototype, "geometryPrecision", void 0), e$2g([y$1I({ type: Number, json: { write: true } })], S$u.prototype, "maxAllowableOffset", void 0), e$2g([y$1I({ type: Number, json: { read: { source: "resultRecordCount" } } })], S$u.prototype, "num", void 0), e$2g([y$1I({ json: { write: true } })], S$u.prototype, "objectIds", void 0), e$2g([y$1I({ type: [String], json: { write: true } })], S$u.prototype, "orderByFields", void 0), e$2g([y$1I({ type: [String], json: { write: true } })], S$u.prototype, "outFields", void 0), e$2g([y$1I({ type: k$C, json: { read: { source: "outSR" }, write: { target: "outSR" } } })], S$u.prototype, "outSpatialReference", void 0), e$2g([y$1I({ type: String, json: { write: true } })], S$u.prototype, "resultType", void 0), e$2g([y$1I({ json: { write: true } })], S$u.prototype, "returnGeometry", void 0), e$2g([y$1I({ type: Boolean, json: { write: { overridePolicy: (e2) => ({ enabled: e2 }) } } })], S$u.prototype, "returnM", void 0), e$2g([y$1I({ type: Boolean, json: { write: { overridePolicy: (e2) => ({ enabled: e2 }) } } })], S$u.prototype, "returnZ", void 0), e$2g([y$1I({ type: Number, json: { read: { source: "resultOffset" } } })], S$u.prototype, "start", void 0), e$2g([r$1P("start"), r$1P("num")], S$u.prototype, "writeStart", null), e$2g([y$1I({ type: String, json: { read: { source: "spatialRel", reader: h$_.read }, write: { target: "spatialRel", writer: h$_.write } } })], S$u.prototype, "spatialRelationship", void 0), e$2g([y$1I({ type: T$o, json: { write: true } })], S$u.prototype, "timeExtent", void 0), e$2g([y$1I({ type: i$1Q, json: { write: true } })], S$u.prototype, "topFilter", void 0), e$2g([y$1I({ type: String, json: { read: j$v.read, write: { writer: j$v.write, overridePolicy(e2) {
  return { enabled: r$1$(e2) && r$1$(this.distance) && this.distance > 0 };
} } } })], S$u.prototype, "units", void 0), e$2g([y$1I({ type: String, json: { write: true } })], S$u.prototype, "where", void 0), S$u = y$S = e$2g([n$2P("esri.rest.support.TopFeaturesQuery")], S$u), S$u.from = b$1a(S$u);
const v$I = S$u;
const p$24 = "esri.widgets.Feature.support.relatedFeatureUtils", c$1K = s$2z.getLogger(p$24), f$16 = new Map();
function d$V(e2) {
  if (!le$2(e2))
    return null;
  const [t2, r2] = e2.split("/").slice(1);
  return { layerId: t2, fieldName: r2 };
}
function m$1r(e2, t2) {
  if (!t2.relationships)
    return null;
  let r2 = null;
  const { relationships: s2 } = t2;
  return s2.some((t3) => t3.id === parseInt(e2, 10) && (r2 = t3, true)), r2;
}
function y$R({ originRelationship: e2, relationships: t2, layerId: r2 }) {
  let s2;
  return t2 && t2.some((t3) => (`${t3.relatedTableId}` === r2 && t3.id === e2.id && (s2 = t3), !!s2)), s2;
}
function j$u(e2, t2) {
  const r2 = t2.toLowerCase();
  for (const s2 in e2)
    if (s2.toLowerCase() === r2)
      return e2[s2];
  return null;
}
function h$Z(e2, t2) {
  const r2 = m$1r(e2, t2);
  if (!r2)
    return;
  return { url: `${t2.url}/${r2.relatedTableId}`, sourceSpatialReference: t2.spatialReference, relation: r2, relatedFields: [], outStatistics: [] };
}
function g$K(e2, t2) {
  if (!t2)
    return;
  if (!e2)
    return;
  const { features: r2, statsFeatures: s2 } = e2, o2 = r2 && r2.value;
  t2.relatedFeatures = o2 ? o2.features : [];
  const i2 = s2 && s2.value;
  t2.relatedStatsFeatures = i2 ? i2.features : [];
}
function F$l(e2, t2, r2, s2) {
  const o2 = new d$W();
  return o2.outFields = ["*"], o2.relationshipId = typeof t2.id == "number" ? t2.id : parseInt(t2.id, 10), o2.objectIds = [e2.attributes[r2.objectIdField]], r2.queryRelatedFeatures(o2, s2);
}
function I$r(e2, t2, r2) {
  let s2 = 0;
  const o2 = [];
  for (; s2 < t2.length; )
    o2.push(`${e2} IN (${t2.slice(s2, r2 + s2)})`), s2 += r2;
  return o2.join(" OR ");
}
async function S$t(e2, t2, r2, a2) {
  const l2 = r2.layerId.toString(), { layerInfo: u2, relation: p2, relatedFields: c2, outStatistics: f2, url: d2, sourceSpatialReference: m2 } = t2, h2 = y$R({ originRelationship: p2, relationships: u2.relationships, layerId: l2 });
  if (h2.relationshipTableId && h2.keyFieldInRelationshipTable) {
    const t3 = (await F$l(e2, h2, r2, a2))[e2.attributes[r2.objectIdField]];
    if (!t3)
      return null;
    const o2 = t3.features.map((e3) => e3.attributes[u2.objectIdField]);
    if ((f2 == null ? void 0 : f2.length) > 0 && u2.supportsStatistics) {
      const e3 = new x$z();
      e3.where = I$r(u2.objectIdField, o2, 1e3), e3.outFields = c2, e3.outStatistics = f2, e3.sourceSpatialReference = m2;
      const r3 = { features: Promise.resolve(t3), statsFeatures: s$1j(d2, e3) };
      return E$Q(r3);
    }
  }
  const g2 = h2 == null ? void 0 : h2.keyField;
  if (g2) {
    const r3 = ie$6(U$h(u2.fields, g2)), l3 = j$u(e2.attributes, p2.keyField), c3 = r3 ? `${g2}=${l3}` : `${g2}='${l3}'`, f3 = s$1j(d2, new x$z({ where: c3, outFields: t2.relatedFields, sourceSpatialReference: m2 }), a2), y2 = t2.outStatistics && t2.outStatistics.length > 0 && u2.supportsStatistics ? s$1j(d2, new x$z({ where: c3, outFields: t2.relatedFields, outStatistics: t2.outStatistics, sourceSpatialReference: m2 }), a2) : null, h3 = { features: f3 };
    return y2 && (h3.statsFeatures = y2), E$Q(h3);
  }
  return null;
}
function w$B(t2, r2) {
  return U$t(t2, { query: { f: "json" }, signal: r2 && r2.signal });
}
function b$G({ relatedInfos: e2, layer: r2 }, o2) {
  const i2 = {};
  return e2.forEach((e3, s2) => {
    const { relation: n2 } = e3;
    if (!n2) {
      const e4 = new s$2u("relation-required", "A relation is required on a layer to retrieve related records.");
      throw c$1K.error(e4), e4;
    }
    const { relatedTableId: a2 } = n2;
    if (typeof a2 != "number") {
      const e4 = new s$2u("A related table ID is required on a layer to retrieve related records.");
      throw c$1K.error(e4), e4;
    }
    const l2 = `${r2.url}/${a2}`, u2 = f$16.get(l2), p2 = u2 || w$B(l2, o2);
    u2 || f$16.set(l2, p2), i2[s2] = p2;
  }), E$Q(i2);
}
function R$l({ graphic: e2, relatedInfos: t2, layer: r2 }, o2) {
  const i2 = {};
  return t2.forEach((t3, s2) => {
    t3.layerInfo && (i2[s2] = S$t(e2, t3, r2, o2));
  }), E$Q(i2);
}
function $$8({ relatedInfo: e2, fieldName: t2, fieldInfo: r2 }) {
  if (e2.relatedFields.push(t2), r2.statisticType) {
    const s2 = new m$1t({ statisticType: r2.statisticType, onStatisticField: t2, outStatisticFieldName: t2 });
    e2.outStatistics.push(s2);
  }
}
function U$h(e2, t2) {
  if (e2 != null) {
    t2 = t2.toLowerCase();
    for (const r2 of e2)
      if (r2 && r2.name.toLowerCase() === t2)
        return r2;
  }
  return null;
}
const y$Q = { chartAnimation: true };
let I$q = class extends m$2q {
  constructor(t2) {
    super(t2), this.abilities = __spreadValues({}, y$Q), this.activeMediaInfoIndex = 0, this.attributes = null, this.description = null, this.fieldInfoMap = null, this.formattedAttributes = null, this.expressionAttributes = null, this.layer = null, this.mediaInfos = null, this.popupTemplate = null, this.relatedInfos = null, this.title = null;
  }
  castAbilities(t2) {
    return __spreadValues(__spreadValues({}, y$Q), t2);
  }
  get activeMediaInfo() {
    return this.formattedMediaInfos[this.activeMediaInfoIndex] || null;
  }
  get formattedMediaInfos() {
    return this._formatMediaInfos() || [];
  }
  get formattedMediaInfoCount() {
    return this.formattedMediaInfos.length;
  }
  setActiveMedia(t2) {
    this._setContentElementMedia(t2);
  }
  next() {
    this._pageContentElementMedia(1);
  }
  previous() {
    this._pageContentElementMedia(-1);
  }
  _setContentElementMedia(t2) {
    const { formattedMediaInfoCount: e2 } = this, i2 = (t2 + e2) % e2;
    this.activeMediaInfoIndex = i2;
  }
  _pageContentElementMedia(t2) {
    const { activeMediaInfoIndex: e2 } = this, i2 = e2 + t2;
    this._setContentElementMedia(i2);
  }
  _formatMediaInfos() {
    const { attributes: t2, mediaInfos: e2, formattedAttributes: i2, expressionAttributes: o2, fieldInfoMap: r2, layer: a2 } = this;
    return e2 == null ? void 0 : e2.map((e3) => {
      const s2 = e3 == null ? void 0 : e3.clone();
      if (!s2)
        return null;
      if (s2.title = $$c({ attributes: t2, fieldInfoMap: r2, globalAttributes: i2, expressionAttributes: o2, layer: a2, text: s2.title }), s2.caption = $$c({ attributes: t2, fieldInfoMap: r2, globalAttributes: i2, expressionAttributes: o2, layer: a2, text: s2.caption }), s2.altText = $$c({ attributes: t2, fieldInfoMap: r2, globalAttributes: i2, expressionAttributes: o2, layer: a2, text: s2.altText }), s2.type === "image") {
        const { value: t3 } = s2;
        return this._setImageValue({ value: t3, formattedAttributes: i2, layer: a2 }), s2.value.sourceURL ? s2 : void 0;
      }
      if (s2.type === "pie-chart" || s2.type === "line-chart" || s2.type === "column-chart" || s2.type === "bar-chart") {
        const { value: e4 } = s2;
        return this._setChartValue({ value: e4, chartType: s2.type, attributes: t2, formattedAttributes: i2, layer: a2, expressionAttributes: o2 }), s2;
      }
      return null;
    }).filter(Boolean);
  }
  _setImageValue(t2) {
    const { fieldInfoMap: e2 } = this, { value: i2, formattedAttributes: o2, layer: r2 } = t2, { linkURL: a2, sourceURL: s2 } = i2;
    if (s2) {
      const t3 = P$q(s2, r2);
      i2.sourceURL = S$A({ formattedAttributes: o2, template: t3, fieldInfoMap: e2 });
    }
    if (a2) {
      const t3 = P$q(a2, r2);
      i2.linkURL = S$A({ formattedAttributes: o2, template: t3, fieldInfoMap: e2 });
    }
  }
  _setChartValue(t2) {
    const { value: e2, attributes: i2, formattedAttributes: o2, chartType: r2, layer: a2, expressionAttributes: s2 } = t2, { popupTemplate: l2, relatedInfos: n2 } = this, { fields: p2, normalizeField: c2 } = e2;
    e2.fields = L$n(p2, a2), c2 && (e2.normalizeField = D$l(c2, a2));
    if (!p2.some((t3) => !!(o2[t3] != null || le$2(t3) && n2.size)))
      return;
    const m2 = l2 == null ? void 0 : l2.fieldInfos;
    p2.forEach((t3) => {
      if (le$2(t3))
        return void (e2.series = [...e2.series, ...this._getRelatedChartInfos({ fieldInfos: m2, fieldName: t3, formattedAttributes: o2, chartType: r2, value: e2 })]);
      const a3 = this._getChartOption({ value: e2, attributes: i2, chartType: r2, formattedAttributes: o2, expressionAttributes: s2, fieldName: t3, fieldInfos: m2 });
      e2.series.push(a3);
    });
  }
  _getRelatedChartInfos(t2) {
    var _a2;
    const { fieldInfos: e2, fieldName: i2, formattedAttributes: o2, chartType: r2, value: a2 } = t2, s2 = [], l2 = d$V(i2), { layerId: n2, fieldName: p2 } = l2, d2 = (_a2 = this.relatedInfos) == null ? void 0 : _a2.get(n2.toString());
    if (!d2)
      return s2;
    const { relatedFeatures: u2, relation: f2 } = d2;
    if (!f2 || !u2)
      return s2;
    const { cardinality: c2 } = f2;
    u2.forEach((t3) => {
      const { attributes: l3 } = t3;
      l3 && Object.keys(l3).forEach((t4) => {
        t4 === p2 && s2.push(this._getChartOption({ value: a2, attributes: l3, formattedAttributes: o2, fieldName: i2, chartType: r2, relatedFieldName: t4, fieldInfos: e2 }));
      });
    });
    return c2 === "one-to-many" || c2 === "many-to-many" ? s2 : [s2[0]];
  }
  _getTooltip({ label: t2, value: e2, chartType: i2 }) {
    return i2 === "pie-chart" ? `${t2}` : `${t2}: ${e2}`;
  }
  _getChartOption(t2) {
    var _a2, _b2, _c2, _d2, _e3, _f2;
    const { value: e2, attributes: i2, formattedAttributes: o2, expressionAttributes: r2, fieldName: l2, relatedFieldName: n2, fieldInfos: p2, chartType: d2 } = t2, { layer: y2, fieldInfoMap: I2 } = this, { normalizeField: v2, tooltipField: M2 } = e2, A2 = v2 ? le$2(v2) ? i2[d$V(v2).fieldName] : i2[v2] : null, g2 = C$u(l2) && r2 && r2[l2] !== void 0 ? r2[l2] : n2 && i2[n2] !== void 0 ? i2[n2] : i2[l2] !== void 0 ? i2[l2] : o2[l2], x2 = new i$2I({ fieldName: l2, value: g2 === void 0 ? null : g2 && A2 ? g2 / A2 : g2 });
    if (le$2(l2)) {
      const t3 = I2.get(l2.toLowerCase()), e3 = I2.get(M2.toLowerCase()), i3 = (_a2 = t3 == null ? void 0 : t3.fieldName) != null ? _a2 : l2, r3 = (_e3 = (_d2 = (_c2 = o2[(_b2 = e3 == null ? void 0 : e3.fieldName) != null ? _b2 : M2]) != null ? _c2 : t3 == null ? void 0 : t3.label) != null ? _d2 : t3 == null ? void 0 : t3.fieldName) != null ? _e3 : n2, a2 = o2[i3];
      return x2.tooltip = this._getTooltip({ label: r3, value: a2, chartType: d2 }), x2;
    }
    const _2 = B$k(p2, l2), C2 = D$l(l2, y2), T2 = M2 && o2[M2] !== void 0 ? o2[M2] : q$j(_2 || new c$2Z({ fieldName: C2 }), (_f2 = this.popupTemplate) == null ? void 0 : _f2.expressionInfos), N2 = o2[C2];
    return x2.tooltip = this._getTooltip({ label: T2, value: N2, chartType: d2 }), x2;
  }
};
e$2g([y$1I()], I$q.prototype, "abilities", void 0), e$2g([s$2i("abilities")], I$q.prototype, "castAbilities", null), e$2g([y$1I()], I$q.prototype, "activeMediaInfoIndex", void 0), e$2g([y$1I({ readOnly: true })], I$q.prototype, "activeMediaInfo", null), e$2g([y$1I()], I$q.prototype, "attributes", void 0), e$2g([y$1I()], I$q.prototype, "description", void 0), e$2g([y$1I()], I$q.prototype, "fieldInfoMap", void 0), e$2g([y$1I()], I$q.prototype, "formattedAttributes", void 0), e$2g([y$1I()], I$q.prototype, "expressionAttributes", void 0), e$2g([y$1I({ readOnly: true })], I$q.prototype, "formattedMediaInfos", null), e$2g([y$1I()], I$q.prototype, "layer", void 0), e$2g([y$1I({ readOnly: true })], I$q.prototype, "formattedMediaInfoCount", null), e$2g([y$1I()], I$q.prototype, "mediaInfos", void 0), e$2g([y$1I()], I$q.prototype, "popupTemplate", void 0), e$2g([y$1I()], I$q.prototype, "relatedInfos", void 0), e$2g([y$1I()], I$q.prototype, "title", void 0), I$q = e$2g([n$2P("esri.widgets.Feature.FeatureMedia.FeatureMediaViewModel")], I$q);
const v$H = I$q;
var f$15 = ["#ffffff", "#858585", "#ffbebe", "#ffebbe", "#ffebaf", "#ffffbe", "#e9ffbe", "#d3ffbe", "#beffe8", "#bee8ff", "#bed2ff", "#e8beff", "#ffbee8", "#ebebeb", "#707070", "#ff7f7f", "#ffa77f", "#ffd37f", "#ffff73", "#d1ff73", "#a3ff73", "#73ffdf", "#73dfff", "#73b2ff", "#df73ff", "#ff73df", "#d6d6d6", "#5c5c5c", "#ff0000", "#ff5500", "#ffaa00", "#ffff00", "#aaff00", "#55ff00", "#00ffc5", "#00c5ff", "#0070ff", "#c500ff", "#ff00c5", "#c2c2c2", "#474747", "#e60000", "#e64c00", "#e69800", "#e6e600", "#98e600", "#4ce600", "#00e6a9", "#00a9e6", "#005ce6", "#a900e6", "#e600a9", "#adadad", "#242424", "#a80000", "#a83800", "#a87000", "#a8a800", "#70a800", "#38a800", "#00a884", "#0084a8", "#004da8", "#8400a8", "#a80084", "#999999", "#1a1a1a", "#730000", "#732600", "#734c00", "#737300", "#4c7300", "#267300", "#00734c", "#004c73", "#002673", "#4c0073", "#73004"], b$F = [].concat(f$15.slice(30, 39), f$15.slice(28, 30).reverse()), e$11 = [{ name: "default", colors: b$F }, { name: "cat-dark", colors: ["#ed5151", "#149ece", "#a7c636", "#9e559c", "#fc921f", "#ffde3e", "#f789d8", "#b7814a", "#3caf99", "#6b6bd6", "#b54779", "#7f7f7f"] }, { name: "tropical-bliss", colors: ["#fce138", "#ff9399", "#fcd27e", "#f1983c", "#a553b7", "#b1a9d0", "#6ecffc", "#4c81cd", "#fc6f84", "#fc3e5a", "#6af689", "#48885c"] }, { name: "desert-blooms", colors: ["#102432", "#144d59", "#ffc730", "#ed9310", "#a64f1b", "#661510", "#d9351a", "#b31515", "#4a0932", "#8c213f", "#18382e", "#2c6954"] }, { name: "under-the-sea", colors: ["#bf9727", "#607100", "#00734c", "#704489", "#01acca", "#024e76", "#f09100", "#ea311f", "#c6004b", "#7570b3", "#666666", "#333333"] }, { name: "vibrant-rainbow", colors: ["#fffb00", "#f5cb11", "#9fd40c", "#46e39c", "#32b8a6", "#7ff2fa", "#ac08cc", "#dd33ff", "#eb7200", "#e8a784", "#bf2e2e", "#6c7000"] }, { name: "ocean-bay", colors: ["#191921", "#11495c", "#78b1c2", "#454f4b", "#8f8f82", "#9be0c0", "#87b051", "#f7ec88", "#ebdcc1", "#dbb658", "#c43541", "#75351e"] }, { name: "prairie-summer", colors: ["#332424", "#751555", "#d47013", "#d68989", "#211173", "#82aad6", "#7bfaeb", "#6ec9a8", "#6b6408", "#eada40", "#ccc54a", "#1fc235"] }, { name: "pastel-chalk", colors: ["#fffd99", "#f5e6a4", "#c1d48c", "#b8e3d0", "#a0b8b5", "#cbf7fa", "#d791f2", "#dfc1eb", "#f2b983", "#e8c4b2", "#bf8e8e", "#94995c"] }, { name: "seq-yellow-orange-red-bright", colors: ["#910000", "#b1260b", "#c0370f", "#e05919", "#ef6a1d", "#ff7b22", "#ffa143", "#ffb454", "#ffda74", "#ffed85"] }, { name: "seq-reds-bright", colors: ["#57453b", "#7b4238", "#9f4036", "#c23d33", "#d7483c", "#ec5244", "#f3696c", "#f9816c", "#ffc4ae", "#fff0dc"] }, { name: "seq-purples-bright", colors: ["#4e465c", "#5a4a78", "#695291", "#775baa", "#8663c3", "#946bdc", "#aa89e8", "#c1a6f3", "#d7c4ff", "#e6e1ff"] }, { name: "seq-blues-bright", colors: ["#404d54", "#435c6c", "#48799d", "#4b88b6", "#4d96ce", "#50a5e7", "#74bbed", "#98d0f3", "#bce6f9", "#e6faff"] }, { name: "seq-greens-bright", colors: ["#39544c", "#386757", "#368165", "#359b73", "#33b581", "#4bc392", "#64d2a2", "#7ce0b3", "#cbf6d9", "#f4ffea"] }, { name: "seq-browns-bright", colors: ["#524834", "#715b38", "#8f6e3c", "#ae8140", "#cc9444", "#eba748", "#eeb664", "#f0c47f", "#f9e0b7", "#fff8eb"] }];
const n$1D = "en-us", h$Y = new Map([["ar", () => import("./ar.js").then((t2) => t2.a)], ["bg-bg", () => import("./bg_BG.js").then((t2) => t2.b)], ["bs-ba", () => import("./bs_BA.js").then((t2) => t2.b)], ["ca-es", () => import("./ca_ES.js").then((t2) => t2.c)], ["cs-cz", () => import("./cs_CZ.js").then((t2) => t2.c)], ["da-dk", () => import("./da_DK.js").then((t2) => t2.d)], ["de-de", () => import("./de_DE.js").then((t2) => t2.d)], ["de-ch", () => import("./de_CH.js").then((t2) => t2.d)], ["el-gr", () => import("./el_GR.js").then((t2) => t2.e)], ["en-us", () => import("./en_US.js").then((t2) => t2.e)], ["en-ca", () => import("./en_CA.js").then((t2) => t2.e)], ["es-es", () => import("./es_ES.js").then((t2) => t2.e)], ["et-ee", () => import("./et_EE.js").then((t2) => t2.e)], ["fi-fi", () => import("./fi_FI.js").then((t2) => t2.f)], ["fr-fr", () => import("./fr_FR.js").then((t2) => t2.f)], ["he-il", () => import("./he_IL.js").then((t2) => t2.h)], ["hr-hr", () => import("./hr_HR.js").then((t2) => t2.h)], ["hu-hu", () => import("./hu_HU.js").then((t2) => t2.h)], ["id-id", () => import("./id_ID.js").then((t2) => t2.i)], ["it-it", () => import("./it_IT.js").then((t2) => t2.i)], ["ja-jp", () => import("./ja_JP.js").then((t2) => t2.j)], ["ko-kr", () => import("./ko_KR.js").then((t2) => t2.k)], ["lt-lt", () => import("./lt_LT.js").then((t2) => t2.l)], ["lv-lv", () => import("./lv_LV.js").then((t2) => t2.l)], ["nb-no", () => import("./nb_NO.js").then((t2) => t2.n)], ["nl-nl", () => import("./nl_NL.js").then((t2) => t2.n)], ["pl-pl", () => import("./pl_PL.js").then((t2) => t2.p)], ["pt-br", () => import("./pt_BR.js").then((t2) => t2.p)], ["pt-pt", () => import("./pt_PT.js").then((t2) => t2.p)], ["ro-ro", () => import("./ro_RO.js").then((t2) => t2.r)], ["ru-ru", () => import("./ru_RU.js").then((t2) => t2.r)], ["sk-sk", () => import("./sk_SK.js").then((t2) => t2.s)], ["sl-sl", () => import("./sl_SL.js").then((t2) => t2.s)], ["sr-rs", () => import("./sr_RS.js").then((t2) => t2.s)], ["sv-se", () => import("./sv_SE.js").then((t2) => t2.s)], ["th-th", () => import("./th_TH.js").then((t2) => t2.t)], ["tr-tr", () => import("./tr_TR.js").then((t2) => t2.t)], ["uk-ua", () => import("./uk_UA.js").then((t2) => t2.u)], ["vi-vn", () => import("./vi_VN.js").then((t2) => t2.v)], ["zh-cn", () => import("./zh_Hans.js").then((t2) => t2.z)], ["zh-hk", () => import("./zh_Hant.js").then((t2) => t2.z)], ["zh-tw", () => import("./zh_Hant.js").then((t2) => t2.z)]]);
function e$10(t2) {
  const s2 = t2.split("-")[0].toLowerCase();
  let n2 = null;
  for (const e2 of h$Y.keys())
    if (e2.startsWith(s2)) {
      n2 = e2;
      break;
    }
  return n2;
}
function r$13(t2) {
  return t2 ? h$Y.has(t2.toLowerCase()) ? t2.toLowerCase() : e$10(t2) || n$1D : n$1D;
}
let o$1a, i$1P;
async function c$1J(t2 = l$2r()) {
  if (t2 = r$13(t2), o$1a && t2 === i$1P)
    return o$1a;
  o$1a = import("./index2.js").then((t3) => t3.i), i$1P = t2;
  try {
    const [s2, n2] = await Promise.all([o$1a, h$Y.get(i$1P)()]);
    i$1P === t2 && (s2.am4core.options.defaultLocale = n2.default), s2.am4core.options.suppressWarnings = true, s2.am4core.options.autoDispose = true;
  } catch {
    return o$1a = null, i$1P = null, null;
  }
  return o$1a;
}
function u$1b(s2, n2 = "default") {
  const h2 = e$11.find((t2) => t2.name === n2);
  return h2 ? h2.colors.map((t2) => s2.color(t2)) : null;
}
const M$m = { base: "esri-feature-media", mediaContainer: "esri-feature-media__container", mediaItemContainer: "esri-feature-media__item-container", mediaItem: "esri-feature-media__item", mediaItemTitle: "esri-feature-media__item-title", mediaItemCaption: "esri-feature-media__item-caption", mediaPrevious: "esri-feature-media__previous", mediaPreviousIconLTR: "esri-feature-media__previous-icon", mediaPreviousIconRTL: "esri-feature-media__previous-icon--rtl", mediaNext: "esri-feature-media__next", mediaNextIconLTR: "esri-feature-media__next-icon", mediaNextIconRTL: "esri-feature-media__next-icon--rtl", mediaChart: "esri-feature-media__chart", mediaButton: "esri-feature-media__button", mediaIcon: "esri-feature-media__icon", iconLeftTriangleArrow: "esri-icon-left-triangle-arrow", iconRightTriangleArrow: "esri-icon-right-triangle-arrow" }, I$p = 0.05, _$u = 0.95, w$A = 15, g$J = "color", y$P = "tooltip", T$m = "value", b$E = "default-line-value";
let C$q = class extends M$u {
  constructor(e2, t2) {
    super(e2, t2), this._refreshTimer = null, this._refreshIntervalInfo = null, this._featureElementInfo = null, this.viewModel = new v$H(), this.messages = null, this._getChartDependencies = async (e3) => {
      const t3 = await c$1J(), { destroyed: i2, viewModel: r2 } = this;
      if (i2 || !r2 || !e3)
        return;
      const { activeMediaInfo: s2 } = r2, a2 = await this._getRendererColors(t3);
      this._renderChart({ chartDiv: e3, mediaInfo: s2, chartsModule: t3, colorMap: a2 });
    };
  }
  initialize() {
    this._featureElementInfo = new l$1E(), this.addHandles([l$1P(() => {
      var _a2, _b2;
      return [(_a2 = this.viewModel) == null ? void 0 : _a2.activeMediaInfo, (_b2 = this.viewModel) == null ? void 0 : _b2.activeMediaInfoIndex];
    }, () => this._setupMediaRefreshTimer(), h$1j), l$1P(() => {
      var _a2, _b2;
      return [(_a2 = this.viewModel) == null ? void 0 : _a2.description, (_b2 = this.viewModel) == null ? void 0 : _b2.title];
    }, () => this._setupFeatureElementInfo(), h$1j)]);
  }
  destroy() {
    this._clearMediaRefreshTimer(), this._featureElementInfo.destroy();
  }
  get attributes() {
    return this.viewModel.attributes;
  }
  set attributes(e2) {
    this.viewModel.attributes = e2;
  }
  get activeMediaInfoIndex() {
    return this.viewModel.activeMediaInfoIndex;
  }
  set activeMediaInfoIndex(e2) {
    this.viewModel.activeMediaInfoIndex = e2;
  }
  get description() {
    return this.viewModel.description;
  }
  set description(e2) {
    this.viewModel.description = e2;
  }
  get fieldInfoMap() {
    return this.viewModel.fieldInfoMap;
  }
  set fieldInfoMap(e2) {
    this.viewModel.fieldInfoMap = e2;
  }
  get layer() {
    return this.viewModel.layer;
  }
  set layer(e2) {
    this.viewModel.layer = e2;
  }
  get mediaInfos() {
    return this.viewModel.mediaInfos;
  }
  set mediaInfos(e2) {
    this.viewModel.mediaInfos = e2;
  }
  get popupTemplate() {
    return this.viewModel.popupTemplate;
  }
  set popupTemplate(e2) {
    this.viewModel.popupTemplate = e2;
  }
  get relatedInfos() {
    return this.viewModel.relatedInfos;
  }
  set relatedInfos(e2) {
    this.viewModel.relatedInfos = e2;
  }
  get title() {
    return this.viewModel.title;
  }
  set title(e2) {
    this.viewModel.title = e2;
  }
  render() {
    var _a2;
    return n$1U("div", { bind: this, class: M$m.base, onkeyup: this._handleMediaKeyup }, (_a2 = this._featureElementInfo) == null ? void 0 : _a2.render(), this.renderMedia());
  }
  renderMedia() {
    const { formattedMediaInfoCount: e2 } = this.viewModel;
    return e2 ? n$1U("div", { key: "media-element-container", class: M$m.mediaContainer }, this.renderMediaPageButton("previous"), this.renderMediaInfo(), this.renderMediaPageButton("next")) : null;
  }
  renderImageMediaInfo(e2) {
    const { _refreshIntervalInfo: t2 } = this, { activeMediaInfoIndex: i2, formattedMediaInfoCount: r2 } = this.viewModel, { value: s2, refreshInterval: a2, altText: o2, title: n2, type: l2 } = e2, { sourceURL: d2, linkURL: m2 } = s2, u2 = x$G(m2) ? "_blank" : "_self", p2 = u2 === "_blank" ? "noreferrer" : "", h2 = a2 ? t2 : null, v2 = h2 ? h2.timestamp : 0, M2 = h2 ? h2.sourceURL : d2, I2 = n$1U("img", { alt: o2 || n2, key: `media-${l2}-${i2}-${r2}-${v2}`, src: M2 }), _2 = m2 ? n$1U("a", { title: n2, href: m2, rel: p2, target: u2 }, I2) : null;
    return _2 || I2;
  }
  renderChartMediaInfo(e2) {
    const { activeMediaInfoIndex: t2, formattedMediaInfoCount: i2 } = this.viewModel;
    return n$1U("div", { key: `media-${e2.type}-${t2}-${i2}`, bind: this, class: M$m.mediaChart, afterCreate: this._getChartDependencies });
  }
  renderMediaInfoType() {
    const { activeMediaInfo: e2 } = this.viewModel;
    return e2 ? e2.type === "image" ? this.renderImageMediaInfo(e2) : e2.type.includes("chart") ? this.renderChartMediaInfo(e2) : null : null;
  }
  renderMediaInfo() {
    const { activeMediaInfo: e2 } = this.viewModel;
    if (!e2)
      return null;
    const t2 = e2.title ? n$1U("div", { key: "media-title", class: M$m.mediaItemTitle, innerHTML: e2.title }) : null, i2 = e2.caption ? n$1U("div", { key: "media-caption", class: M$m.mediaItemCaption, innerHTML: e2.caption }) : null;
    return n$1U("div", { key: "media-container", class: M$m.mediaItemContainer }, n$1U("div", { key: "media-item-container", class: M$m.mediaItem }, this.renderMediaInfoType()), t2, i2);
  }
  renderMediaPageButton(e2) {
    if (this.viewModel.formattedMediaInfoCount < 2)
      return null;
    const t2 = e2 === "previous", i2 = t2 ? this.messages.previous : this.messages.next, r2 = t2 ? this.classes(M$m.mediaButton, M$m.mediaPrevious) : this.classes(M$m.mediaButton, M$m.mediaNext), s2 = t2 ? this.classes(M$m.mediaIcon, M$m.mediaPreviousIconLTR, M$m.iconLeftTriangleArrow) : this.classes(M$m.mediaIcon, M$m.mediaNextIconLTR, M$m.iconRightTriangleArrow), a2 = t2 ? this.classes(M$m.mediaIcon, M$m.mediaPreviousIconRTL, M$m.iconRightTriangleArrow) : this.classes(M$m.mediaIcon, M$m.mediaNextIconRTL, M$m.iconLeftTriangleArrow), o2 = t2 ? "media-previous" : "media-next", n2 = t2 ? this._previous : this._next;
    return n$1U("button", { type: "button", key: o2, title: i2, "aria-label": i2, tabIndex: 0, class: r2, bind: this, onclick: n2 }, n$1U("span", { "aria-hidden": "true", class: s2 }), n$1U("span", { "aria-hidden": "true", class: a2 }));
  }
  _setupFeatureElementInfo() {
    const { description: e2, title: t2 } = this;
    this._featureElementInfo.set({ description: e2, title: t2 });
  }
  _next() {
    this.viewModel.next();
  }
  _previous() {
    this.viewModel.previous();
  }
  async _getRendererColors(e2) {
    var _a2, _b2;
    const { am4core: t2 } = e2, i2 = new Map(), r2 = (_b2 = (_a2 = this.viewModel) == null ? void 0 : _a2.layer) == null ? void 0 : _b2.renderer, s2 = "default";
    if (!r2)
      return i2;
    const a2 = await b$L(r2);
    a2.delete(s2);
    return Array.from(a2.values()).every((e3) => (e3 == null ? void 0 : e3.length) === 1) ? (i2.set(b$E, t2.color({ r: 50, g: 50, b: 50, a: 1 })), Array.from(a2.keys()).forEach((e3) => {
      e3 && i2.set(e3, t2.color(a2.get(e3)[0].toCss(true)));
    }), i2) : i2;
  }
  _handleMediaKeyup(e2) {
    const i2 = i$31(e2);
    i2 === "ArrowLeft" && (e2.stopPropagation(), this.viewModel.previous()), i2 === "ArrowRight" && (e2.stopPropagation(), this.viewModel.next());
  }
  _renderChart(e2) {
    const { abilities: t2 } = this.viewModel, { chartsModule: i2, chartDiv: r2, mediaInfo: s2, colorMap: a2 } = e2, { value: o2, type: n2 } = s2, { am4core: l2 } = i2, d2 = u$1b(l2);
    function c2(e3) {
      e3 instanceof l2.ColorSet && d2 && (e3.list = d2);
    }
    r$1e() && l2.useTheme(i2.am4themes_dark);
    const m2 = window.matchMedia("(prefers-reduced-motion: reduce)");
    t2.chartAnimation && !m2.matches ? l2.useTheme(i2.am4themes_animated) : l2.unuseTheme(i2.am4themes_animated), l2.useTheme(c2);
    const p2 = n2 === "pie-chart" ? this._createPieChart(e2) : this._createXYChart(e2);
    r2.setAttribute("aria-label", s2.altText || s2.title), p2.data = o2.series.map((e3) => ({ [y$P]: e3.tooltip, [T$m]: e3.value, [g$J]: a2.get(e3.fieldName) })).filter((e3) => n2 !== "pie-chart" || e3.value > 0);
  }
  _customizeChartTooltip(e2, t2) {
    e2.label.wrap = true, e2.label.maxWidth = 200, e2.autoTextColor = false, e2.getFillFromObject = false, e2.label.fill = t2.color("#ffffff"), e2.background.fill = t2.color({ r: 0, g: 0, b: 0, a: 0.7 });
  }
  _createPieChart(e2) {
    const { chartDiv: t2, chartsModule: i2 } = e2, { am4core: r2, am4charts: s2 } = i2, a2 = r2.create(t2, s2.PieChart);
    a2.rtl = f$1g(this.container);
    const o2 = a2.series.push(new s2.PieSeries());
    return o2.labels.template.disabled = true, o2.ticks.template.disabled = true, o2.dataFields.value = T$m, o2.dataFields.category = y$P, this._customizeChartTooltip(o2.tooltip, r2), o2.slices.template.propertyFields.fill = g$J, o2.slices.template.propertyFields.stroke = g$J, a2;
  }
  _getMinSeriesValue(e2) {
    let t2 = 0;
    return e2.forEach((e3) => t2 = Math.min(e3.value, t2)), t2;
  }
  _createColumnChart(e2, t2) {
    const { chartsModule: i2, mediaInfo: r2 } = t2, { value: s2 } = r2, { am4core: a2, am4charts: o2 } = i2, n2 = e2.xAxes.push(new o2.CategoryAxis());
    n2.dataFields.category = y$P, n2.renderer.labels.template.disabled = true, this._customizeChartTooltip(n2.tooltip, a2), n2.tooltip.events.on("sizechanged", () => {
      n2.tooltip.dy = -n2.tooltip.contentHeight;
    });
    const l2 = e2.yAxes.push(new o2.ValueAxis()), d2 = l2.renderer.labels.template;
    l2.renderer.minLabelPosition = I$p, l2.renderer.maxLabelPosition = _$u, l2.min = this._getMinSeriesValue(s2.series), this._customizeChartTooltip(l2.tooltip, a2), d2.wrap = true;
    const c2 = e2.series.push(new o2.ColumnSeries());
    c2.dataFields.valueY = T$m, c2.dataFields.categoryX = y$P, c2.columns.template.propertyFields.fill = g$J, c2.columns.template.propertyFields.stroke = g$J, e2.cursor = new o2.XYCursor(), s2.series.length > w$A && (e2.scrollbarX = new a2.Scrollbar());
  }
  _createBarChart(e2, t2) {
    const { chartsModule: i2, mediaInfo: r2 } = t2, { value: s2 } = r2, { am4core: a2, am4charts: o2 } = i2, n2 = e2.yAxes.push(new o2.CategoryAxis());
    n2.dataFields.category = y$P, n2.renderer.inversed = true, n2.renderer.labels.template.disabled = true, this._customizeChartTooltip(n2.tooltip, a2), n2.tooltip.events.on("sizechanged", () => {
      n2.tooltip.dx = n2.tooltip.contentWidth;
    });
    const l2 = e2.xAxes.push(new o2.ValueAxis()), d2 = l2.renderer.labels.template;
    l2.renderer.minLabelPosition = I$p, l2.renderer.maxLabelPosition = _$u, l2.min = this._getMinSeriesValue(s2.series), this._customizeChartTooltip(l2.tooltip, a2), d2.wrap = true;
    const c2 = e2.series.push(new o2.ColumnSeries());
    c2.dataFields.valueX = T$m, c2.dataFields.categoryY = y$P, c2.columns.template.propertyFields.fill = g$J, c2.columns.template.propertyFields.stroke = g$J, e2.cursor = new o2.XYCursor(), s2.series.length > w$A && (e2.scrollbarY = new a2.Scrollbar());
  }
  _createLineChart(e2, t2) {
    const { chartsModule: i2, mediaInfo: r2, colorMap: s2 } = t2, { value: a2 } = r2, { am4core: o2, am4charts: n2 } = i2, l2 = e2.xAxes.push(new n2.CategoryAxis());
    l2.dataFields.category = y$P, l2.renderer.labels.template.disabled = true, this._customizeChartTooltip(l2.tooltip, o2), l2.tooltip.events.on("sizechanged", () => {
      l2.tooltip.dy = -l2.tooltip.contentHeight;
    });
    const d2 = e2.yAxes.push(new n2.ValueAxis()), c2 = d2.renderer.labels.template;
    d2.renderer.minLabelPosition = I$p, d2.renderer.maxLabelPosition = _$u, d2.min = this._getMinSeriesValue(a2.series), this._customizeChartTooltip(d2.tooltip, o2), c2.wrap = true;
    const m2 = e2.series.push(new n2.LineSeries());
    m2.dataFields.categoryX = y$P, m2.dataFields.valueY = T$m, m2.strokeWidth = 1;
    const u2 = s2.get(b$E);
    u2 && (m2.stroke = u2);
    const p2 = m2.bullets.push(new n2.CircleBullet());
    p2.propertyFields.fill = g$J, p2.propertyFields.stroke = g$J, e2.cursor = new n2.XYCursor(), a2.series.length > w$A && (e2.scrollbarX = new o2.Scrollbar());
  }
  _createXYChart(e2) {
    const { chartDiv: t2, chartsModule: i2, mediaInfo: r2 } = e2, { type: s2 } = r2, { am4core: a2, am4charts: o2 } = i2, n2 = a2.create(t2, o2.XYChart);
    return n2.rtl = f$1g(this.container), s2 === "column-chart" && this._createColumnChart(n2, e2), s2 === "bar-chart" && this._createBarChart(n2, e2), s2 === "line-chart" && this._createLineChart(n2, e2), n2;
  }
  _clearMediaRefreshTimer() {
    const { _refreshTimer: e2 } = this;
    e2 && (clearTimeout(e2), this._refreshTimer = null);
  }
  _updateMediaInfoTimestamp(e2) {
    const t2 = Date.now();
    this._refreshIntervalInfo = { timestamp: t2, sourceURL: this._getImageSource(e2, t2) }, this.scheduleRender();
  }
  _setupMediaRefreshTimer() {
    this._clearMediaRefreshTimer();
    const { activeMediaInfo: e2 } = this.viewModel;
    e2 && e2.type === "image" && e2.refreshInterval && this._setRefreshTimeout(e2);
  }
  _setRefreshTimeout(e2) {
    const { refreshInterval: t2, value: i2 } = e2;
    if (!t2)
      return;
    const r2 = 6e4 * t2;
    this._updateMediaInfoTimestamp(i2.sourceURL);
    const s2 = setInterval(() => {
      this._updateMediaInfoTimestamp(i2.sourceURL);
    }, r2);
    this._refreshTimer = s2;
  }
  _getImageSource(e2, t2) {
    const i2 = e2.includes("?") ? "&" : "?", [r2, s2 = ""] = e2.split("#");
    return `${r2}${i2}timestamp=${t2}${s2 ? "#" : ""}${s2}`;
  }
};
e$2g([y$1I()], C$q.prototype, "attributes", null), e$2g([y$1I()], C$q.prototype, "activeMediaInfoIndex", null), e$2g([y$1I()], C$q.prototype, "description", null), e$2g([y$1I()], C$q.prototype, "fieldInfoMap", null), e$2g([y$1I()], C$q.prototype, "layer", null), e$2g([y$1I()], C$q.prototype, "mediaInfos", null), e$2g([y$1I()], C$q.prototype, "popupTemplate", null), e$2g([y$1I()], C$q.prototype, "relatedInfos", null), e$2g([y$1I()], C$q.prototype, "title", null), e$2g([y$1I({ type: v$H })], C$q.prototype, "viewModel", void 0), e$2g([y$1I(), e$1g("esri/widgets/Feature/t9n/Feature")], C$q.prototype, "messages", void 0), C$q = e$2g([n$2P("esri.widgets.Feature.FeatureMedia")], C$q);
const x$x = C$q;
var t$1c;
let p$23 = t$1c = class extends l$2B {
  constructor(r2) {
    super(r2), this.minValue = 0, this.maxValue = 0;
  }
  clone() {
    return new t$1c({ minValue: this.minValue, maxValue: this.maxValue });
  }
};
e$2g([y$1I({ type: Number, json: { write: true } })], p$23.prototype, "minValue", void 0), e$2g([y$1I({ type: Number, json: { write: true } })], p$23.prototype, "maxValue", void 0), p$23 = t$1c = e$2g([n$2P("esri.renderer.support.AuthoringInfoClassBreakInfo")], p$23);
var n$1C;
let p$22 = n$1C = class extends l$2B {
  constructor(o2) {
    super(o2), this.field = "", this.normalizationField = "", this.label = "", this.classBreakInfos = [];
  }
  clone() {
    return new n$1C({ field: this.field, normalizationField: this.normalizationField, label: this.label, classBreakInfos: y$1L(this.classBreakInfos) });
  }
};
e$2g([y$1I({ type: String, json: { write: true } })], p$22.prototype, "field", void 0), e$2g([y$1I({ type: String, json: { write: true } })], p$22.prototype, "normalizationField", void 0), e$2g([y$1I({ type: String, json: { write: true } })], p$22.prototype, "label", void 0), e$2g([y$1I({ type: [p$23], json: { write: true } })], p$22.prototype, "classBreakInfos", void 0), p$22 = n$1C = e$2g([n$2P("esri.renderers.support.AuthoringInfoFieldInfo")], p$22);
var n$1B;
const l$1v = new s$2a({ percentTotal: "percent-of-total", ratio: "ratio", percent: "percent" }), p$21 = new s$2a({ sizeInfo: "size", colorInfo: "color", transparencyInfo: "opacity", rotationInfo: "rotation" }), a$1J = { key: (e2) => typeof e2 == "number" ? "number" : "string", typeMap: { number: Number, string: String }, base: null }, u$1a = ["high-to-low", "above-and-below", "centered-on", "extremes"], m$1q = [...new Set([...["high-to-low", "above-and-below", "centered-on", "extremes", "90-10", "above", "below"], ...["high-to-low", "above-and-below", "90-10", "above", "below"]])], y$O = ["seconds", "minutes", "hours", "days", "months", "years"];
let d$U = n$1B = class extends l$2B {
  constructor(e2) {
    super(e2), this.endTime = null, this.field = null, this.maxSliderValue = null, this.minSliderValue = null, this.startTime = null, this.type = null, this.units = null;
  }
  castEndTime(e2) {
    return typeof e2 == "string" || typeof e2 == "number" ? e2 : null;
  }
  castStartTime(e2) {
    return typeof e2 == "string" || typeof e2 == "number" ? e2 : null;
  }
  get style() {
    return this.type === "color" ? this._get("style") : null;
  }
  set style(e2) {
    this._set("style", e2);
  }
  get theme() {
    return this.type === "color" || this.type === "size" ? this._get("theme") || "high-to-low" : null;
  }
  set theme(e2) {
    this._set("theme", e2);
  }
  clone() {
    return new n$1B({ endTime: this.endTime, field: this.field, maxSliderValue: this.maxSliderValue, minSliderValue: this.minSliderValue, startTime: this.startTime, style: this.style, theme: this.theme, type: this.type, units: this.units });
  }
};
e$2g([y$1I({ types: a$1J, json: { write: true } })], d$U.prototype, "endTime", void 0), e$2g([s$2i("endTime")], d$U.prototype, "castEndTime", null), e$2g([y$1I({ type: String, json: { write: true } })], d$U.prototype, "field", void 0), e$2g([y$1I({ type: Number, json: { write: true } })], d$U.prototype, "maxSliderValue", void 0), e$2g([y$1I({ type: Number, json: { write: true } })], d$U.prototype, "minSliderValue", void 0), e$2g([y$1I({ types: a$1J, json: { write: true } })], d$U.prototype, "startTime", void 0), e$2g([s$2i("startTime")], d$U.prototype, "castStartTime", null), e$2g([y$1I({ type: l$1v.apiValues, value: null, json: { type: l$1v.jsonValues, read: l$1v.read, write: l$1v.write } })], d$U.prototype, "style", null), e$2g([y$1I({ type: m$1q, value: null, json: { type: m$1q, origins: { "web-scene": { type: u$1a, write: { writer: (e2, t2) => {
  u$1a.includes(e2) && (t2.theme = e2);
} } } }, write: true } })], d$U.prototype, "theme", null), e$2g([y$1I({ type: p$21.apiValues, json: { type: p$21.jsonValues, read: p$21.read, write: p$21.write } })], d$U.prototype, "type", void 0), e$2g([y$1I({ type: y$O, json: { type: y$O, write: true } })], d$U.prototype, "units", void 0), d$U = n$1B = e$2g([n$2P("esri.renderers.support.AuthoringInfoVisualVariable")], d$U);
const c$1I = d$U;
let e$$ = class extends l$2B {
  constructor(r2) {
    super(r2), this.type = null;
  }
};
e$2g([y$1I({ readOnly: true, json: { read: false, write: true } })], e$$.prototype, "type", void 0), e$$ = e$2g([n$2P("esri.rest.support.ColorRamp")], e$$);
const p$20 = e$$;
var m$1p;
let c$1H = m$1p = class extends p$20 {
  constructor(o2) {
    super(o2), this.algorithm = null, this.fromColor = null, this.toColor = null, this.type = "algorithmic";
  }
  clone() {
    return new m$1p({ fromColor: y$1L(this.fromColor), toColor: y$1L(this.toColor), algorithm: this.algorithm });
  }
};
e$2g([r$1H({ esriCIELabAlgorithm: "cie-lab", esriHSVAlgorithm: "hsv", esriLabLChAlgorithm: "lab-lch" })], c$1H.prototype, "algorithm", void 0), e$2g([y$1I({ type: l$2e, json: { type: [T$G], write: true } })], c$1H.prototype, "fromColor", void 0), e$2g([y$1I({ type: l$2e, json: { type: [T$G], write: true } })], c$1H.prototype, "toColor", void 0), e$2g([y$1I({ type: ["algorithmic"] })], c$1H.prototype, "type", void 0), c$1H = m$1p = e$2g([n$2P("esri.rest.support.AlgorithmicColorRamp")], c$1H);
const a$1I = c$1H;
var c$1G;
let m$1o = c$1G = class extends p$20 {
  constructor(o2) {
    super(o2), this.colorRamps = null, this.type = "multipart";
  }
  clone() {
    return new c$1G({ colorRamps: y$1L(this.colorRamps) });
  }
};
e$2g([y$1I({ type: [a$1I], json: { write: true } })], m$1o.prototype, "colorRamps", void 0), e$2g([y$1I({ type: ["multipart"] })], m$1o.prototype, "type", void 0), m$1o = c$1G = e$2g([n$2P("esri.rest.support.MultipartColorRamp")], m$1o);
const a$1H = m$1o;
const m$1n = { key: "type", base: p$20, typeMap: { algorithmic: a$1I, multipart: a$1H } };
function p$1$(o2) {
  return o2 && o2.type ? o2.type === "algorithmic" ? a$1I.fromJSON(o2) : o2.type === "multipart" ? a$1H.fromJSON(o2) : null : null;
}
var c$1F;
const h$X = new s$2a({ esriClassifyDefinedInterval: "defined-interval", esriClassifyEqualInterval: "equal-interval", esriClassifyManual: "manual", esriClassifyNaturalBreaks: "natural-breaks", esriClassifyQuantile: "quantile", esriClassifyStandardDeviation: "standard-deviation" }), y$N = new s$2a({ pieChart: "pie-chart", classedSize: "class-breaks-size", classedColor: "class-breaks-color", univariateColorSize: "univariate-color-size", relationship: "relationship", predominance: "predominance", dotDensity: "dot-density", flow: "flow" }), m$1m = new s$2a({ classedSize: "class-breaks-size", classedColor: "class-breaks-color", univariateColorSize: "univariate-color-size", relationship: "relationship", predominance: "predominance", dotDensity: "dot-density" }), f$14 = ["inches", "feet", "yards", "miles", "nautical-miles", "millimeters", "centimeters", "decimeters", "meters", "kilometers", "decimal-degrees"], v$G = ["high-to-low", "above-and-below", "above", "below", "90-10"], w$z = ["flow-line", "wave-front"], b$D = ["caret", "circle-caret", "arrow", "circle-arrow", "plus-minus", "circle-plus-minus", "square", "circle", "triangle", "happy-sad", "thumb", "custom"];
let g$I = c$1F = class extends l$2B {
  constructor(e2) {
    super(e2), this.colorRamp = null, this.fadeRatio = null, this.isAutoGenerated = false, this.lengthUnit = null, this.maxSliderValue = null, this.minSliderValue = null, this.visualVariables = null;
  }
  get classificationMethod() {
    const e2 = this._get("classificationMethod"), t2 = this.type;
    return t2 && t2 !== "relationship" ? t2 === "class-breaks-size" || t2 === "class-breaks-color" ? e2 || "manual" : null : e2;
  }
  set classificationMethod(e2) {
    this._set("classificationMethod", e2);
  }
  readColorRamp(e2) {
    return e2 ? p$1$(e2) : void 0;
  }
  get fields() {
    return this.type && this.type !== "predominance" ? null : this._get("fields");
  }
  set fields(e2) {
    this._set("fields", e2);
  }
  get field1() {
    return this.type && this.type !== "relationship" ? null : this._get("field1");
  }
  set field1(e2) {
    this._set("field1", e2);
  }
  get field2() {
    return this.type && this.type !== "relationship" ? null : this._get("field2");
  }
  set field2(e2) {
    this._set("field2", e2);
  }
  get flowTheme() {
    return this.type === "flow" ? this._get("flowTheme") : null;
  }
  set flowTheme(e2) {
    this._set("flowTheme", e2);
  }
  get focus() {
    return this.type && this.type !== "relationship" ? null : this._get("focus");
  }
  set focus(e2) {
    this._set("focus", e2);
  }
  get numClasses() {
    return this.type && this.type !== "relationship" ? null : this._get("numClasses");
  }
  set numClasses(e2) {
    this._set("numClasses", e2);
  }
  get statistics() {
    return this.type === "univariate-color-size" && this.univariateTheme === "above-and-below" ? this._get("statistics") : null;
  }
  set statistics(e2) {
    this._set("statistics", e2);
  }
  get standardDeviationInterval() {
    const e2 = this.type;
    return e2 && e2 !== "relationship" && e2 !== "class-breaks-size" && e2 !== "class-breaks-color" || this.classificationMethod && this.classificationMethod !== "standard-deviation" ? null : this._get("standardDeviationInterval");
  }
  set standardDeviationInterval(e2) {
    this._set("standardDeviationInterval", e2);
  }
  get type() {
    return this._get("type");
  }
  set type(e2) {
    let t2 = e2;
    e2 === "classed-size" ? t2 = "class-breaks-size" : e2 === "classed-color" && (t2 = "class-breaks-color"), this._set("type", t2);
  }
  get univariateSymbolStyle() {
    return this.type === "univariate-color-size" && this.univariateTheme === "above-and-below" ? this._get("univariateSymbolStyle") : null;
  }
  set univariateSymbolStyle(e2) {
    this._set("univariateSymbolStyle", e2);
  }
  get univariateTheme() {
    return this.type === "univariate-color-size" ? this._get("univariateTheme") : null;
  }
  set univariateTheme(e2) {
    this._set("univariateTheme", e2);
  }
  clone() {
    return new c$1F({ classificationMethod: this.classificationMethod, colorRamp: y$1L(this.colorRamp), fadeRatio: y$1L(this.fadeRatio), fields: this.fields && this.fields.slice(0), field1: y$1L(this.field1), field2: y$1L(this.field2), isAutoGenerated: this.isAutoGenerated, focus: this.focus, numClasses: this.numClasses, maxSliderValue: this.maxSliderValue, minSliderValue: this.minSliderValue, lengthUnit: this.lengthUnit, statistics: this.statistics, standardDeviationInterval: this.standardDeviationInterval, type: this.type, visualVariables: this.visualVariables && this.visualVariables.map((e2) => e2.clone()), univariateSymbolStyle: this.univariateSymbolStyle, univariateTheme: this.univariateTheme, flowTheme: this.flowTheme });
  }
};
e$2g([y$1I({ type: h$X.apiValues, value: null, json: { type: h$X.jsonValues, read: h$X.read, write: h$X.write, origins: { "web-document": { default: "manual", type: h$X.jsonValues, read: h$X.read, write: h$X.write } } } })], g$I.prototype, "classificationMethod", null), e$2g([y$1I({ types: m$1n, json: { write: true } })], g$I.prototype, "colorRamp", void 0), e$2g([o$29("colorRamp")], g$I.prototype, "readColorRamp", null), e$2g([y$1I({ json: { write: true, origins: { "web-scene": { write: false, read: false } } } })], g$I.prototype, "fadeRatio", void 0), e$2g([y$1I({ type: [String], value: null, json: { write: true } })], g$I.prototype, "fields", null), e$2g([y$1I({ type: p$22, value: null, json: { write: true } })], g$I.prototype, "field1", null), e$2g([y$1I({ type: p$22, value: null, json: { write: true } })], g$I.prototype, "field2", null), e$2g([y$1I({ type: w$z, value: null, json: { write: true, origins: { "web-scene": { write: false } } } })], g$I.prototype, "flowTheme", null), e$2g([y$1I({ type: ["HH", "HL", "LH", "LL"], value: null, json: { write: true } })], g$I.prototype, "focus", null), e$2g([y$1I({ type: Boolean, json: { write: true, default: false, origins: { "web-scene": { write: false } } } })], g$I.prototype, "isAutoGenerated", void 0), e$2g([y$1I({ type: Number, value: null, json: { type: T$G, write: true } })], g$I.prototype, "numClasses", null), e$2g([y$1I({ type: f$14, json: { type: f$14, read: false, write: false, origins: { "web-scene": { read: true, write: true } } } })], g$I.prototype, "lengthUnit", void 0), e$2g([y$1I({ type: Number, json: { write: true, origins: { "web-scene": { write: false, read: false } } } })], g$I.prototype, "maxSliderValue", void 0), e$2g([y$1I({ type: Number, json: { write: true, origins: { "web-scene": { write: false, read: false } } } })], g$I.prototype, "minSliderValue", void 0), e$2g([y$1I({ type: Object, value: null, json: { write: true, origins: { "web-scene": { write: false, read: false } } } })], g$I.prototype, "statistics", null), e$2g([y$1I({ type: [0.25, 0.33, 0.5, 1], value: null, json: { type: [0.25, 0.33, 0.5, 1], write: true } })], g$I.prototype, "standardDeviationInterval", null), e$2g([y$1I({ type: y$N.apiValues, value: null, json: { type: y$N.jsonValues, read: y$N.read, write: y$N.write, origins: { "web-scene": { type: m$1m.jsonValues, write: { writer: m$1m.write, overridePolicy: (e2) => ({ enabled: e2 !== "flow" }) } } } } })], g$I.prototype, "type", null), e$2g([y$1I({ type: [c$1I], json: { write: true } })], g$I.prototype, "visualVariables", void 0), e$2g([y$1I({ type: b$D, value: null, json: { write: true, origins: { "web-scene": { write: false } } } })], g$I.prototype, "univariateSymbolStyle", null), e$2g([y$1I({ type: v$G, value: null, json: { write: true, origins: { "web-scene": { write: false } } } })], g$I.prototype, "univariateTheme", null), g$I = c$1F = e$2g([n$2P("esri.renderers.support.AuthoringInfo")], g$I);
const j$t = g$I;
const n$1A = new s$2a({ simple: "simple", uniqueValue: "unique-value", classBreaks: "class-breaks", heatmap: "heatmap", dotDensity: "dot-density", dictionary: "dictionary", pieChart: "pie-chart" }, { ignoreUnknown: true });
let a$1G = class extends l$2B {
  constructor(r2) {
    super(r2), this.authoringInfo = null, this.type = null;
  }
  async getRequiredFields(r2) {
    if (!this.collectRequiredFields)
      return [];
    const e2 = new Set();
    return await this.collectRequiredFields(e2, r2), Array.from(e2).sort();
  }
  getSymbol(r2, e2) {
  }
  async getSymbolAsync(r2, e2) {
  }
  getSymbols() {
    return [];
  }
  getAttributeHash() {
    return JSON.stringify(this);
  }
  getMeshHash() {
    return JSON.stringify(this);
  }
};
e$2g([y$1I({ type: j$t, json: { write: true } })], a$1G.prototype, "authoringInfo", void 0), e$2g([y$1I({ type: n$1A.apiValues, readOnly: true, json: { type: n$1A.jsonValues, read: false, write: { writer: n$1A.write, ignoreOrigin: true } } })], a$1G.prototype, "type", void 0), a$1G = e$2g([n$2P("esri.renderers.Renderer")], a$1G);
const p$1_ = a$1G;
function e$_(e2) {
  var _a2, _b2, _c2;
  return (_c2 = (_b2 = (_a2 = e2.match(t$1b)) == null ? void 0 : _a2[1]) == null ? void 0 : _b2.replace(/\\'/g, "'")) != null ? _c2 : null;
}
const t$1b = /^hash\(\$feature\['((\\'|[^'])+)'\]\) \* 8\.381e-8$/;
var s$1i;
let p$1Z = s$1i = class extends l$2B {
  constructor() {
    super(...arguments), this.title = null;
  }
  clone() {
    return new s$1i({ title: this.title });
  }
};
e$2g([y$1I({ type: String, json: { write: true } })], p$1Z.prototype, "title", void 0), p$1Z = s$1i = e$2g([n$2P("esri.renderers.support.LegendOptions")], p$1Z);
var t$1a;
let p$1Y = t$1a = class extends p$1Z {
  constructor() {
    super(...arguments), this.showLegend = null;
  }
  clone() {
    return new t$1a({ title: this.title, showLegend: this.showLegend });
  }
};
e$2g([y$1I({ type: Boolean, json: { write: true } })], p$1Y.prototype, "showLegend", void 0), p$1Y = t$1a = e$2g([n$2P("esri.renderers.visualVariables.support.VisualVariableLegendOptions")], p$1Y);
const i$1O = p$1Y;
const a$1F = new s$2a({ colorInfo: "color", transparencyInfo: "opacity", rotationInfo: "rotation", sizeInfo: "size" });
let u$19 = class extends l$2B {
  constructor(e2) {
    super(e2), this.index = null, this.type = null, this.field = null, this.valueExpression = null, this.valueExpressionTitle = null, this.legendOptions = null;
  }
  castField(e2) {
    return e2 == null ? e2 : typeof e2 == "function" ? (s$2z.getLogger(this.declaredClass).error(".field: field must be a string value"), null) : u$2l(e2);
  }
  get arcadeRequired() {
    return !!this.valueExpression;
  }
  clone() {
  }
  getAttributeHash() {
    return `${this.type}-${this.field}-${this.valueExpression}`;
  }
};
e$2g([y$1I()], u$19.prototype, "index", void 0), e$2g([y$1I({ type: a$1F.apiValues, readOnly: true, json: { read: a$1F.read, write: a$1F.write } })], u$19.prototype, "type", void 0), e$2g([y$1I({ type: String, json: { write: true } })], u$19.prototype, "field", void 0), e$2g([s$2i("field")], u$19.prototype, "castField", null), e$2g([y$1I({ type: String, json: { write: true } })], u$19.prototype, "valueExpression", void 0), e$2g([y$1I({ type: String, json: { write: true } })], u$19.prototype, "valueExpressionTitle", void 0), e$2g([y$1I({ readOnly: true })], u$19.prototype, "arcadeRequired", null), e$2g([y$1I({ type: i$1O, json: { write: true } })], u$19.prototype, "legendOptions", void 0), u$19 = e$2g([n$2P("esri.renderers.visualVariables.VisualVariable")], u$19);
const c$1E = u$19;
var i$1N;
let p$1X = i$1N = class extends c$1E {
  constructor(t2) {
    super(t2), this.type = "color", this.normalizationField = null;
  }
  get cache() {
    return { ipData: this._interpolateData(), hasExpression: !!this.valueExpression, compiledFunc: null };
  }
  set stops(t2) {
    t2 && Array.isArray(t2) && (t2 = t2.filter((t3) => !!t3)).sort((t3, s2) => t3.value - s2.value), this._set("stops", t2);
  }
  clone() {
    return new i$1N({ field: this.field, normalizationField: this.normalizationField, valueExpression: this.valueExpression, valueExpressionTitle: this.valueExpressionTitle, stops: this.stops && this.stops.map((t2) => t2.clone()), legendOptions: this.legendOptions && this.legendOptions.clone() });
  }
  getAttributeHash() {
    return `${super.getAttributeHash()}-${this.normalizationField}`;
  }
  _interpolateData() {
    return this.stops && this.stops.map((t2) => t2.value || 0);
  }
};
e$2g([y$1I({ readOnly: true })], p$1X.prototype, "cache", null), e$2g([y$1I({ type: ["color"], json: { type: ["colorInfo"] } })], p$1X.prototype, "type", void 0), e$2g([y$1I({ type: String, json: { write: true } })], p$1X.prototype, "normalizationField", void 0), e$2g([y$1I({ type: [a$1U], json: { write: true } })], p$1X.prototype, "stops", null), p$1X = i$1N = e$2g([n$2P("esri.renderers.visualVariables.ColorVariable")], p$1X);
const a$1E = p$1X;
var l$1u;
let u$18 = l$1u = class extends l$2B {
  constructor(r2) {
    super(r2), this.label = null, this.opacity = null, this.value = null;
  }
  readOpacity(r2, t2) {
    return r$1w(t2.transparency);
  }
  writeOpacity(r2, t2, o2) {
    t2[o2] = n$2r(r2);
  }
  clone() {
    return new l$1u({ label: this.label, opacity: this.opacity, value: this.value });
  }
};
e$2g([y$1I({ type: String, json: { write: true } })], u$18.prototype, "label", void 0), e$2g([y$1I({ type: Number, json: { type: T$G, write: { target: "transparency" } } })], u$18.prototype, "opacity", void 0), e$2g([o$29("opacity", ["transparency"])], u$18.prototype, "readOpacity", null), e$2g([r$1P("opacity")], u$18.prototype, "writeOpacity", null), e$2g([y$1I({ type: Number, json: { write: true } })], u$18.prototype, "value", void 0), u$18 = l$1u = e$2g([n$2P("esri.renderers.visualVariables.support.OpacityStop")], u$18);
const y$M = u$18;
var i$1M;
let p$1W = i$1M = class extends c$1E {
  constructor(t2) {
    super(t2), this.type = "opacity", this.normalizationField = null;
  }
  get cache() {
    return { ipData: this._interpolateData(), hasExpression: !!this.valueExpression, compiledFunc: null };
  }
  set stops(t2) {
    t2 && Array.isArray(t2) && (t2 = t2.filter((t3) => !!t3)).sort((t3, s2) => t3.value - s2.value), this._set("stops", t2);
  }
  clone() {
    return new i$1M({ field: this.field, normalizationField: this.normalizationField, valueExpression: this.valueExpression, valueExpressionTitle: this.valueExpressionTitle, stops: this.stops && this.stops.map((t2) => t2.clone()), legendOptions: this.legendOptions && this.legendOptions.clone() });
  }
  getAttributeHash() {
    return `${super.getAttributeHash()}-${this.normalizationField}`;
  }
  _interpolateData() {
    return this.stops && this.stops.map((t2) => t2.value || 0);
  }
};
e$2g([y$1I({ readOnly: true })], p$1W.prototype, "cache", null), e$2g([y$1I({ type: ["opacity"], json: { type: ["transparencyInfo"] } })], p$1W.prototype, "type", void 0), e$2g([y$1I({ type: String, json: { write: true } })], p$1W.prototype, "normalizationField", void 0), e$2g([y$1I({ type: [y$M], json: { write: true } })], p$1W.prototype, "stops", null), p$1W = i$1M = e$2g([n$2P("esri.renderers.visualVariables.OpacityVariable")], p$1W);
const a$1D = p$1W;
var p$1V;
let a$1C = p$1V = class extends c$1E {
  constructor(e2) {
    super(e2), this.axis = null, this.type = "rotation", this.rotationType = "geographic", this.valueExpressionTitle = null;
  }
  get cache() {
    return { hasExpression: !!this.valueExpression, compiledFunc: null };
  }
  writeValueExpressionTitleWebScene(e2, s2, o2, r2) {
    if (r2 && r2.messages) {
      const e3 = `visualVariables[${this.index}]`;
      r2.messages.push(new s$2u("property:unsupported", this.type + "VisualVariable.valueExpressionTitle is not supported in Web Scene. Please remove this property to save the Web Scene.", { instance: this, propertyName: e3 + ".valueExpressionTitle", context: r2 }));
    }
  }
  clone() {
    return new p$1V({ axis: this.axis, rotationType: this.rotationType, field: this.field, valueExpression: this.valueExpression, valueExpressionTitle: this.valueExpressionTitle, legendOptions: this.legendOptions && this.legendOptions.clone() });
  }
};
e$2g([y$1I({ readOnly: true })], a$1C.prototype, "cache", null), e$2g([y$1I({ type: ["heading", "tilt", "roll"], json: { origins: { "web-scene": { default: "heading", write: true } } } })], a$1C.prototype, "axis", void 0), e$2g([y$1I({ type: ["rotation"], json: { type: ["rotationInfo"] } })], a$1C.prototype, "type", void 0), e$2g([y$1I({ type: ["geographic", "arithmetic"], json: { write: true, origins: { "web-document": { write: true, default: "geographic" } } } })], a$1C.prototype, "rotationType", void 0), e$2g([y$1I({ type: String, json: { write: true } })], a$1C.prototype, "valueExpressionTitle", void 0), e$2g([r$1P("web-scene", "valueExpressionTitle")], a$1C.prototype, "writeValueExpressionTitleWebScene", null), a$1C = p$1V = e$2g([n$2P("esri.renderers.visualVariables.RotationVariable")], a$1C);
const n$1z = a$1C;
var p$1U;
let i$1L = p$1U = class extends l$2B {
  constructor(r2) {
    super(r2), this.label = null, this.size = null, this.value = null;
  }
  clone() {
    return new p$1U({ label: this.label, size: this.size, value: this.value });
  }
};
e$2g([y$1I({ type: String, json: { write: true } })], i$1L.prototype, "label", void 0), e$2g([y$1I({ type: Number, cast: o$1N, json: { write: true } })], i$1L.prototype, "size", void 0), e$2g([y$1I({ type: Number, json: { write: true } })], i$1L.prototype, "value", void 0), i$1L = p$1U = e$2g([n$2P("esri.renderers.visualVariables.support.SizeStop")], i$1L);
const l$1t = i$1L;
var t$19;
let i$1K = t$19 = class extends i$1O {
  constructor() {
    super(...arguments), this.customValues = null;
  }
  clone() {
    return new t$19({ title: this.title, showLegend: this.showLegend, customValues: this.customValues && this.customValues.slice(0) });
  }
};
e$2g([y$1I({ type: [Number], json: { write: true } })], i$1K.prototype, "customValues", void 0), i$1K = t$19 = e$2g([n$2P("esri.renderers.visualVariables.support.SizeVariableLegendOptions")], i$1K);
const a$1B = i$1K;
var n$1y, i$1J;
function e$Z(n2) {
  return n2 && n2.declaredClass === "esri.renderers.visualVariables.SizeVariable";
}
function l$1s(n2) {
  return n2 != null && !isNaN(n2) && isFinite(n2);
}
function t$18(i2) {
  return i2.valueExpression ? n$1y.Expression : i2.field && typeof i2.field == "string" ? n$1y.Field : n$1y.Unknown;
}
function a$1A(e2, l2) {
  const a2 = l2 || t$18(e2), o2 = e2.valueUnit || "unknown";
  return a2 === n$1y.Unknown ? i$1J.Constant : e2.stops ? i$1J.Stops : e2.minSize != null && e2.maxSize != null && e2.minDataValue != null && e2.maxDataValue != null ? i$1J.ClampedLinear : o2 === "unknown" ? e2.minSize != null && e2.minDataValue != null ? e2.minSize && e2.minDataValue ? i$1J.Proportional : i$1J.Additive : i$1J.Identity : i$1J.RealWorldSize;
}
!function(n2) {
  n2.Unknown = "unknown", n2.Expression = "expression", n2.Field = "field";
}(n$1y || (n$1y = {})), function(n2) {
  n2.Unknown = "unknown", n2.Stops = "stops", n2.ClampedLinear = "clamped-linear", n2.Proportional = "proportional", n2.Additive = "additive", n2.Constant = "constant", n2.Identity = "identity", n2.RealWorldSize = "real-world-size";
}(i$1J || (i$1J = {}));
function n$1x(n2) {
}
function o$19(n2) {
  return () => n2;
}
const m$1l = { inches: E$E(1, "meters", "inches"), feet: E$E(1, "meters", "feet"), "us-feet": E$E(1, "meters", "us-feet"), yards: E$E(1, "meters", "yards"), miles: E$E(1, "meters", "miles"), "nautical-miles": E$E(1, "meters", "nautical-miles"), millimeters: E$E(1, "meters", "millimeters"), centimeters: E$E(1, "meters", "centimeters"), decimeters: E$E(1, "meters", "decimeters"), meters: E$E(1, "meters", "meters"), kilometers: E$E(1, "meters", "kilometers"), "decimal-degrees": 1 / Y$c(1, "meters", s$2h.radius) };
const f$13 = s$2z.getLogger("esri.renderers.visualVariables.support.visualVariableUtils"), p$1T = new g$10(), d$T = Math.PI, v$F = /^\s*(return\s+)?\$view\.scale\s*(;)?\s*$/i;
function b$C(a2, r2, i2) {
  const s2 = "visualVariables" in a2 && a2.visualVariables ? a2.visualVariables.find((e2) => e2.type === "color") : a2;
  if (!s2)
    return;
  if (s2.declaredClass !== "esri.renderers.visualVariables.ColorVariable")
    return void f$13.warn("The visualVariable should be an instance of esri.renderers.visualVariables.ColorVariable");
  const l2 = typeof r2 == "number", o2 = l2 ? null : r2, c2 = o2 && o2.attributes;
  let u2 = l2 ? r2 : null;
  const p2 = s2.field, { ipData: d2, hasExpression: v2 } = s2.cache;
  let b2 = s2.cache.compiledFunc;
  if (!p2 && !v2) {
    const e2 = s2.stops;
    return e2 && e2[0] && e2[0].color;
  }
  if (typeof u2 != "number")
    if (v2) {
      if (t$2r(i2) || t$2r(i2.arcade))
        return void f$13.error("Use of arcade expressions requires an arcade context");
      const e2 = { viewingMode: i2.viewingMode, scale: i2.scale, spatialReference: i2.spatialReference }, a3 = i2.arcade.arcadeUtils, r3 = a3.getViewInfo(e2), t2 = a3.createExecContext(o2, r3);
      if (!b2) {
        const e3 = a3.createSyntaxTree(s2.valueExpression);
        b2 = a3.createFunction(e3), s2.cache.compiledFunc = b2;
      }
      u2 = a3.executeFunction(b2, t2);
    } else
      c2 && (u2 = c2[p2]);
  const h2 = s2.normalizationField, m2 = c2 != null && h2 != null ? parseFloat(c2[h2]) : void 0;
  if (u2 != null && (!h2 || l2 || !isNaN(m2) && m2 !== 0)) {
    isNaN(m2) || l2 || (u2 /= m2);
    const a3 = R$k(u2, d2);
    if (a3) {
      const r3 = a3[0], n2 = a3[1], l3 = r3 === n2 ? s2.stops[r3].color : l$2e.blendColors(s2.stops[r3].color, s2.stops[n2].color, a3[2], r$1$(i2) ? i2.color : void 0);
      return new l$2e(l3);
    }
  }
}
function h$W(e2, a2, r2) {
  const i2 = "visualVariables" in e2 && e2.visualVariables ? e2.visualVariables.find((e3) => e3.type === "opacity") : e2;
  if (!i2)
    return;
  if (i2.declaredClass !== "esri.renderers.visualVariables.OpacityVariable")
    return void f$13.warn("The visualVariable should be an instance of esri.renderers.visualVariables.OpacityVariable");
  const t2 = typeof a2 == "number", s2 = t2 ? null : a2, l2 = s2 && s2.attributes;
  let o2 = t2 ? a2 : null;
  const c2 = i2.field, { ipData: u2, hasExpression: p2 } = i2.cache;
  let d2 = i2.cache.compiledFunc;
  if (!c2 && !p2) {
    const e3 = i2.stops;
    return e3 && e3[0] && e3[0].opacity;
  }
  if (typeof o2 != "number")
    if (p2) {
      if (t$2r(r2) || t$2r(r2.arcade))
        return void f$13.error("Use of arcade expressions requires an arcade context");
      const e3 = { viewingMode: r2.viewingMode, scale: r2.scale, spatialReference: r2.spatialReference }, a3 = r2.arcade.arcadeUtils, t3 = a3.getViewInfo(e3), l3 = a3.createExecContext(s2, t3);
      if (!d2) {
        const e4 = a3.createSyntaxTree(i2.valueExpression);
        d2 = a3.createFunction(e4), i2.cache.compiledFunc = d2;
      }
      o2 = a3.executeFunction(d2, l3);
    } else
      l2 && (o2 = l2[c2]);
  const v2 = i2.normalizationField, b2 = l2 != null && v2 != null ? parseFloat(l2[v2]) : void 0;
  if (o2 != null && (!v2 || t2 || !isNaN(b2) && b2 !== 0)) {
    isNaN(b2) || t2 || (o2 /= b2);
    const e3 = R$k(o2, u2);
    if (e3) {
      const a3 = e3[0], r3 = e3[1];
      if (a3 === r3)
        return i2.stops[a3].opacity;
      {
        const n2 = i2.stops[a3].opacity;
        return n2 + (i2.stops[r3].opacity - n2) * e3[2];
      }
    }
  }
}
function m$1k(e2, a2, r2) {
  const i2 = "visualVariables" in e2 && e2.visualVariables ? e2.visualVariables.find((e3) => e3.type === "rotation") : e2;
  if (!i2)
    return;
  if (i2.declaredClass !== "esri.renderers.visualVariables.RotationVariable")
    return void f$13.warn("The visualVariable should be an instance of esri.renderers.visualVariables.RotationVariable");
  const t2 = i2.axis || "heading", s2 = t2 === "heading" && i2.rotationType === "arithmetic" ? 90 : 0, l2 = t2 === "heading" && i2.rotationType === "arithmetic" ? -1 : 1, o2 = typeof a2 == "number" ? null : a2, c2 = o2 && o2.attributes, u2 = i2.field, { hasExpression: p2 } = i2.cache;
  let d2 = i2.cache.compiledFunc, v2 = 0;
  if (!u2 && !p2)
    return v2;
  if (p2) {
    if (t$2r(r2) || t$2r(r2.arcade))
      return void f$13.error("Use of arcade expressions requires an arcade context");
    const e3 = { viewingMode: r2.viewingMode, scale: r2.scale, spatialReference: r2.spatialReference }, a3 = r2.arcade.arcadeUtils, t3 = a3.getViewInfo(e3), s3 = a3.createExecContext(o2, t3);
    if (!d2) {
      const e4 = a3.createSyntaxTree(i2.valueExpression);
      d2 = a3.createFunction(e4), i2.cache.compiledFunc = d2;
    }
    v2 = a3.executeFunction(d2, s3);
  } else
    c2 && (v2 = c2[u2] || 0);
  return v2 = typeof v2 != "number" || isNaN(v2) ? null : s2 + l2 * v2, v2;
}
function V$h(e2, a2, r2) {
  const i2 = typeof a2 == "number", s2 = i2 ? null : a2, l2 = s2 && s2.attributes;
  let c2 = i2 ? a2 : null;
  const { isScaleDriven: p2 } = e2.cache;
  let d2 = e2.cache.compiledFunc;
  if (p2) {
    const a3 = r$1$(r2) ? r2.scale : void 0, i3 = r$1$(r2) ? r2.view : void 0;
    c2 = a3 == null || i3 === "3d" ? x$w(e2) : a3;
  } else if (!i2)
    switch (e2.inputValueType) {
      case n$1y.Expression: {
        if (t$2r(r2) || t$2r(r2.arcade))
          return void f$13.error("Use of arcade expressions requires an arcade context");
        const a3 = { viewingMode: r2.viewingMode, scale: r2.scale, spatialReference: r2.spatialReference }, i3 = r2.arcade.arcadeUtils, t2 = i3.getViewInfo(a3), l3 = i3.createExecContext(s2, t2);
        if (!d2) {
          const a4 = i3.createSyntaxTree(e2.valueExpression);
          d2 = i3.createFunction(a4), e2.cache.compiledFunc = d2;
        }
        c2 = i3.executeFunction(d2, l3);
        break;
      }
      case n$1y.Field:
        l2 && (c2 = l2[e2.field]);
        break;
      case n$1y.Unknown:
        c2 = null;
    }
  if (!l$1s(c2))
    return null;
  if (i2 || !e2.normalizationField)
    return c2;
  const v2 = l2 ? parseFloat(l2[e2.normalizationField]) : null;
  return l$1s(v2) && v2 !== 0 ? c2 / v2 : null;
}
function x$w(e2) {
  let a2 = null, r2 = null;
  const i2 = e2.stops;
  return i2 ? (a2 = i2[0].value, r2 = i2[i2.length - 1].value) : (a2 = e2.minDataValue || 0, r2 = e2.maxDataValue || 0), (a2 + r2) / 2;
}
function y$L(e2, a2, r2) {
  const i2 = "visualVariables" in e2 && e2.visualVariables ? e2.visualVariables.find((e3) => e3.type === "size") : e2;
  if (!i2)
    return;
  if (i2.declaredClass !== "esri.renderers.visualVariables.SizeVariable")
    return void f$13.warn("The visualVariable should be an instance of esri.renderers.visualVariables.SizeVariable");
  const n2 = M$l(V$h(i2, a2, r2), i2, a2, r2, i2.cache.ipData);
  return n2 == null || isNaN(n2) ? 0 : n2;
}
function w$y(e2, a2, r2) {
  return e2 == null ? null : e$Z(e2) ? y$L(e2, a2, r2) : l$1s(e2) ? e2 : null;
}
function g$H(e2, a2, r2) {
  return l$1s(r2) && e2 > r2 ? r2 : l$1s(a2) && e2 < a2 ? a2 : e2;
}
function z$s(e2, a2, r2, i2) {
  var _a2;
  return e2 + ((_a2 = w$y(a2.minSize, r2, i2) || a2.minDataValue) != null ? _a2 : 0);
}
function F$k(e2, a2, r2) {
  const i2 = e2.stops;
  let n2 = i2 && i2.length && i2[0].size;
  return n2 == null && (n2 = e2.minSize), w$y(n2, a2, r2);
}
function S$s(e2, a2, r2, i2) {
  const n2 = (e2 - a2.minDataValue) / (a2.maxDataValue - a2.minDataValue), s2 = w$y(a2.minSize, r2, i2), l2 = w$y(a2.maxSize, r2, i2), o2 = r$1$(i2) ? i2.shape : void 0;
  if (e2 <= a2.minDataValue)
    return s2;
  if (e2 >= a2.maxDataValue)
    return l2;
  if (s2 == null || l2 == null)
    return null;
  if (a2.scaleBy === "area" && o2) {
    const e3 = o2 === "circle", a3 = e3 ? d$T * (s2 / 2) ** 2 : s2 * s2, r3 = a3 + n2 * ((e3 ? d$T * (l2 / 2) ** 2 : l2 * l2) - a3);
    return e3 ? 2 * Math.sqrt(r3 / d$T) : Math.sqrt(r3);
  }
  return s2 + n2 * (l2 - s2);
}
function E$u(e2, a2, r2, i2) {
  const n2 = r$1$(i2) ? i2.shape : void 0, s2 = e2 / a2.minDataValue, l2 = w$y(a2.minSize, r2, i2), o2 = w$y(a2.maxSize, r2, i2);
  let c2 = null;
  return c2 = n2 === "circle" ? 2 * Math.sqrt(s2 * (l2 / 2) ** 2) : n2 === "square" || n2 === "diamond" || n2 === "image" ? Math.sqrt(s2 * l2 ** 2) : s2 * l2, g$H(c2, l2, o2);
}
function U$g(e2, a2, r2, i2, n2) {
  var _a2, _b2, _c2;
  const [t2, s2, l2] = R$k(e2, n2);
  if (t2 === s2)
    return w$y((_a2 = a2.stops) == null ? void 0 : _a2[t2].size, r2, i2);
  {
    const e3 = w$y((_b2 = a2.stops) == null ? void 0 : _b2[t2].size, r2, i2);
    return e3 + (w$y((_c2 = a2.stops) == null ? void 0 : _c2[s2].size, r2, i2) - e3) * l2;
  }
}
function C$p(e2, a2, r2, i2) {
  const n2 = (r$1$(i2) && i2.resolution ? i2.resolution : 1) * m$1l[a2.valueUnit], l2 = w$y(a2.minSize, r2, i2), o2 = w$y(a2.maxSize, r2, i2), { valueRepresentation: c2 } = a2;
  let u2 = null;
  return u2 = c2 === "area" ? 2 * Math.sqrt(e2 / d$T) / n2 : c2 === "radius" || c2 === "distance" ? 2 * e2 / n2 : e2 / n2, g$H(u2, l2, o2);
}
function D$h(e2) {
  return e2;
}
function M$l(e2, a2, r2, i2, n2) {
  switch (a2.transformationType) {
    case i$1J.Additive:
      return z$s(e2, a2, r2, i2);
    case i$1J.Constant:
      return F$k(a2, r2, i2);
    case i$1J.ClampedLinear:
      return S$s(e2, a2, r2, i2);
    case i$1J.Proportional:
      return E$u(e2, a2, r2, i2);
    case i$1J.Stops:
      return U$g(e2, a2, r2, i2, n2);
    case i$1J.RealWorldSize:
      return C$p(e2, a2, r2, i2);
    case i$1J.Identity:
      return D$h(e2);
    case i$1J.Unknown:
      return null;
  }
}
function k$j(e2, a2, r2) {
  const { isScaleDriven: i2 } = e2.cache;
  if (!(i2 && r2 === "3d" || a2))
    return null;
  const n2 = { scale: a2, view: r2 };
  let t2 = w$y(e2.minSize, p$1T, n2), s2 = w$y(e2.maxSize, p$1T, n2);
  if (t2 != null || s2 != null) {
    if (t2 > s2) {
      const e3 = s2;
      s2 = t2, t2 = e3;
    }
    return { minSize: t2, maxSize: s2 };
  }
}
function N$i(e2, a2, r2) {
  if (!e2.visualVariables)
    return;
  const i2 = [], n2 = [], t2 = [], s2 = [], l2 = [];
  for (const o2 of e2.visualVariables)
    switch (o2.type) {
      case "color":
        n2.push(o2);
        break;
      case "opacity":
        t2.push(o2);
        break;
      case "rotation":
        l2.push(o2);
        break;
      case "size":
        s2.push(o2);
    }
  return n2.forEach((e3) => {
    const n3 = b$C(e3, a2, r2);
    i2.push({ variable: e3, value: n3 });
  }), t2.forEach((e3) => {
    const n3 = h$W(e3, a2, r2);
    i2.push({ variable: e3, value: n3 });
  }), l2.forEach((e3) => {
    const n3 = m$1k(e3, a2, r2);
    i2.push({ variable: e3, value: n3 });
  }), s2.forEach((e3) => {
    const n3 = y$L(e3, a2, r2);
    i2.push({ variable: e3, value: n3 });
  }), i2.filter((e3) => e3.value != null);
}
function R$k(e2, a2) {
  if (!a2)
    return;
  let r2 = 0, i2 = a2.length - 1;
  return a2.some((a3, n2) => e2 < a3 ? (i2 = n2, true) : (r2 = n2, false)), [r2, i2, (e2 - a2[r2]) / (a2[i2] - a2[r2])];
}
function T$l(e2, a2, i2) {
  const n2 = ["proportional", "proportional", "proportional"];
  for (const t2 of e2) {
    const e3 = t2.useSymbolValue ? "symbol-value" : y$L(t2, a2, i2);
    switch (t2.axis) {
      case "width":
        n2[0] = e3;
        break;
      case "depth":
        n2[1] = e3;
        break;
      case "height":
        n2[2] = e3;
        break;
      case "width-and-depth":
        n2[0] = e3, n2[1] = e3;
        break;
      case "all":
      case void 0:
      case null:
        n2[0] = e3, n2[1] = e3, n2[2] = e3;
        break;
      default:
        n$1x(t2.axis);
    }
  }
  return n2;
}
var visualVariableUtils = /* @__PURE__ */ Object.freeze({
  __proto__: null,
  [Symbol.toStringTag]: "Module",
  getAllSizes: T$l,
  getColor: b$C,
  getOpacity: h$W,
  getRotationAngle: m$1k,
  getSize: y$L,
  getSizeForValue: M$l,
  getSizeFromNumberOrVariable: w$y,
  getSizeRangeAtScale: k$j,
  getVisualVariableValues: N$i,
  viewScaleRE: v$F
});
var z$r;
const v$E = new s$2a({ width: "width", depth: "depth", height: "height", widthAndDepth: "width-and-depth", all: "all" }), g$G = new s$2a({ unknown: "unknown", inch: "inches", foot: "feet", yard: "yards", mile: "miles", "nautical-mile": "nautical-miles", millimeter: "millimeters", centimeter: "centimeters", decimeter: "decimeters", meter: "meters", kilometer: "kilometers", "decimal-degree": "decimal-degrees" });
function w$x(e2) {
  if (e2 != null)
    return typeof e2 == "string" || typeof e2 == "number" ? o$1N(e2) : e2.type === "size" ? e$Z(e2) ? e2 : (delete (e2 = __spreadValues({}, e2)).type, new V$g(e2)) : void 0;
}
function f$12(e2, t2, i2) {
  if (typeof e2 != "object")
    return e2;
  const s2 = new V$g();
  return s2.read(e2, i2), s2;
}
let V$g = z$r = class extends c$1E {
  constructor(e2) {
    super(e2), this.axis = null, this.legendOptions = null, this.normalizationField = null, this.scaleBy = null, this.target = null, this.type = "size", this.useSymbolValue = null, this.valueExpression = null, this.valueRepresentation = null, this.valueUnit = null;
  }
  get cache() {
    return { ipData: this._interpolateData(), hasExpression: !!this.valueExpression, compiledFunc: null, isScaleDriven: this.valueExpression != null && v$F.test(this.valueExpression) };
  }
  set expression(e2) {
    s$2z.getLogger(this.declaredClass).warn("'expression' is deprecated since version 4.2. Use 'valueExpression' instead. The only supported expression is 'view.scale'."), e2 === "view.scale" ? (this.valueExpression = "$view.scale", this._set("expression", e2)) : this._set("expression", null);
  }
  set index(e2) {
    e$Z(this.maxSize) && (this.maxSize.index = `visualVariables[${e2}].maxSize`), e$Z(this.minSize) && (this.minSize.index = `visualVariables[${e2}].minSize`), this._set("index", e2);
  }
  get inputValueType() {
    return t$18(this);
  }
  set maxDataValue(e2) {
    e2 && this.stops && (s$2z.getLogger(this.declaredClass).warn("cannot set maxDataValue when stops is not null."), e2 = null), this._set("maxDataValue", e2);
  }
  set maxSize(e2) {
    e2 && this.stops && (s$2z.getLogger(this.declaredClass).warn("cannot set maxSize when stops is not null."), e2 = null), this._set("maxSize", e2);
  }
  castMaxSize(e2) {
    return w$x(e2);
  }
  readMaxSize(e2, t2, i2) {
    return f$12(e2, t2, i2);
  }
  set minDataValue(e2) {
    e2 && this.stops && (s$2z.getLogger(this.declaredClass).warn("cannot set minDataValue when stops is not null."), e2 = null), this._set("minDataValue", e2);
  }
  set minSize(e2) {
    e2 && this.stops && (s$2z.getLogger(this.declaredClass).warn("cannot set minSize when stops is not null."), e2 = null), this._set("minSize", e2);
  }
  castMinSize(e2) {
    return w$x(e2);
  }
  readMinSize(e2, t2, i2) {
    return f$12(e2, t2, i2);
  }
  get arcadeRequired() {
    return !!this.valueExpression || (this.minSize != null && typeof this.minSize == "object" && this.minSize.arcadeRequired || this.maxSize != null && typeof this.maxSize == "object" && this.maxSize.arcadeRequired);
  }
  set stops(e2) {
    this.minDataValue == null && this.maxDataValue == null && this.minSize == null && this.maxSize == null ? e2 && Array.isArray(e2) && (e2 = e2.filter((e3) => !!e3)).sort((e3, t2) => e3.value - t2.value) : e2 && (s$2z.getLogger(this.declaredClass).warn("cannot set stops when one of minDataValue, maxDataValue, minSize or maxSize is not null."), e2 = null), this._set("stops", e2);
  }
  get transformationType() {
    return a$1A(this, this.inputValueType);
  }
  readValueExpression(e2, t2) {
    return e2 || t2.expression && "$view.scale";
  }
  writeValueExpressionWebScene(e2, i2, s2, r2) {
    if (e2 === "$view.scale") {
      if (r2 && r2.messages) {
        const e3 = this.index, i3 = typeof e3 == "string" ? e3 : `visualVariables[${e3}]`;
        r2.messages.push(new s$2u("property:unsupported", this.type + "VisualVariable.valueExpression = '$view.scale' is not supported in Web Scene. Please remove this property to save the Web Scene.", { instance: this, propertyName: i3 + ".valueExpression", context: r2 }));
      }
    } else
      i2[s2] = e2;
  }
  readValueUnit(e2) {
    return e2 ? g$G.read(e2) : null;
  }
  clone() {
    return new z$r({ axis: this.axis, field: this.field, valueExpression: this.valueExpression, valueExpressionTitle: this.valueExpressionTitle, maxDataValue: this.maxDataValue, maxSize: e$Z(this.maxSize) ? this.maxSize.clone() : this.maxSize, minDataValue: this.minDataValue, minSize: e$Z(this.minSize) ? this.minSize.clone() : this.minSize, normalizationField: this.normalizationField, stops: this.stops && this.stops.map((e2) => e2.clone()), target: this.target, useSymbolValue: this.useSymbolValue, valueRepresentation: this.valueRepresentation, valueUnit: this.valueUnit, legendOptions: this.legendOptions && this.legendOptions.clone() });
  }
  flipSizes() {
    if (this.transformationType === i$1J.ClampedLinear) {
      const { minSize: e2, maxSize: t2 } = this;
      return this.minSize = t2, this.maxSize = e2, this;
    }
    if (this.transformationType === i$1J.Stops) {
      const e2 = this.stops;
      if (!e2)
        return this;
      const t2 = e2.map((e3) => e3.size).reverse(), i2 = e2.length;
      for (let s2 = 0; s2 < i2; s2++)
        e2[s2].size = t2[s2];
      return this;
    }
    return this;
  }
  getAttributeHash() {
    return `${super.getAttributeHash()}-${this.target}-${this.normalizationField}`;
  }
  _interpolateData() {
    return this.stops && this.stops.map((e2) => e2.value || 0);
  }
};
e$2g([y$1I({ readOnly: true })], V$g.prototype, "cache", null), e$2g([y$1I({ type: v$E.apiValues, json: { type: v$E.jsonValues, origins: { "web-map": { read: false } }, read: v$E.read, write: v$E.write } })], V$g.prototype, "axis", void 0), e$2g([y$1I({ type: String, value: null, json: { read: false } })], V$g.prototype, "expression", null), e$2g([y$1I()], V$g.prototype, "index", null), e$2g([y$1I({ type: String, readOnly: true })], V$g.prototype, "inputValueType", null), e$2g([y$1I({ type: a$1B, json: { write: true } })], V$g.prototype, "legendOptions", void 0), e$2g([y$1I({ type: Number, value: null, json: { write: true } })], V$g.prototype, "maxDataValue", null), e$2g([y$1I({ type: Number, value: null, json: { write: true } })], V$g.prototype, "maxSize", null), e$2g([s$2i("maxSize")], V$g.prototype, "castMaxSize", null), e$2g([o$29("maxSize")], V$g.prototype, "readMaxSize", null), e$2g([y$1I({ type: Number, value: null, json: { write: true } })], V$g.prototype, "minDataValue", null), e$2g([y$1I({ type: Number, value: null, json: { write: true } })], V$g.prototype, "minSize", null), e$2g([s$2i("minSize")], V$g.prototype, "castMinSize", null), e$2g([o$29("minSize")], V$g.prototype, "readMinSize", null), e$2g([y$1I({ type: String, json: { write: true } })], V$g.prototype, "normalizationField", void 0), e$2g([y$1I({ readOnly: true })], V$g.prototype, "arcadeRequired", null), e$2g([y$1I({ type: String })], V$g.prototype, "scaleBy", void 0), e$2g([y$1I({ type: [l$1t], value: null, json: { write: true } })], V$g.prototype, "stops", null), e$2g([y$1I({ type: ["outline"], json: { write: true } })], V$g.prototype, "target", void 0), e$2g([y$1I({ type: String, readOnly: true })], V$g.prototype, "transformationType", null), e$2g([y$1I({ type: ["size"], json: { type: ["sizeInfo"] } })], V$g.prototype, "type", void 0), e$2g([y$1I({ type: Boolean, json: { write: true, origins: { "web-map": { read: false } } } })], V$g.prototype, "useSymbolValue", void 0), e$2g([y$1I({ type: String, json: { write: true } })], V$g.prototype, "valueExpression", void 0), e$2g([o$29("valueExpression", ["valueExpression", "expression"])], V$g.prototype, "readValueExpression", null), e$2g([r$1P("web-scene", "valueExpression")], V$g.prototype, "writeValueExpressionWebScene", null), e$2g([y$1I({ type: ["radius", "diameter", "area", "width", "distance"], json: { write: true } })], V$g.prototype, "valueRepresentation", void 0), e$2g([y$1I({ type: g$G.apiValues, json: { write: g$G.write, origins: { "web-map": { read: false }, "web-scene": { write: true } } } })], V$g.prototype, "valueUnit", void 0), e$2g([o$29("valueUnit")], V$g.prototype, "readValueUnit", null), V$g = z$r = e$2g([n$2P("esri.renderers.visualVariables.SizeVariable")], V$g);
const j$s = V$g;
const u$17 = { color: a$1E, size: j$s, opacity: a$1D, rotation: n$1z }, b$B = new s$2a({ colorInfo: "color", transparencyInfo: "opacity", rotationInfo: "rotation", sizeInfo: "size" }), h$V = /^\[([^\]]+)\]$/i;
let V$f = class extends m$2q {
  constructor() {
    super(...arguments), this.colorVariables = null, this.opacityVariables = null, this.rotationVariables = null, this.sizeVariables = null;
  }
  set visualVariables(r2) {
    if (this._resetVariables(), (r2 = r2 && r2.filter((r3) => !!r3)) && r2.length) {
      for (const s2 of r2)
        switch (s2.type) {
          case "color":
            this.colorVariables.push(s2);
            break;
          case "opacity":
            this.opacityVariables.push(s2);
            break;
          case "rotation":
            this.rotationVariables.push(s2);
            break;
          case "size":
            this.sizeVariables.push(s2);
        }
      if (this.sizeVariables.length) {
        this.sizeVariables.some((r3) => !!r3.target) && r2.sort((r3, s2) => {
          let e2 = null;
          return e2 = r3.target === s2.target ? 0 : r3.target ? 1 : -1, e2;
        });
      }
      for (let s2 = 0; s2 < r2.length; s2++) {
        r2[s2].index = s2;
      }
      this._set("visualVariables", r2);
    } else
      this._set("visualVariables", r2);
  }
  readVariables(r2, s2, e2) {
    const { rotationExpression: a2, rotationType: i2 } = s2, l2 = a2 && a2.match(h$V), n2 = l2 && l2[1];
    if (n2 && (r2 || (r2 = []), r2.push({ type: "rotationInfo", rotationType: i2, field: n2 })), r2)
      return r2.map((r3) => {
        const s3 = b$B.read(r3.type), a3 = u$17[s3];
        a3 || (s$2z.getLogger(this.declaredClass).warn(`Unknown variable type: ${s3}`), e2 && e2.messages && e2.messages.push(new t$2j("visual-variable:unsupported", `visualVariable of type '${s3}' is not supported`, { definition: r3, context: e2 })));
        const i3 = new a3();
        return i3.read(r3, e2), i3;
      });
  }
  writeVariables(r2, s2) {
    const e2 = [];
    for (const o2 of r2) {
      const r3 = o2.toJSON(s2);
      r3 && e2.push(r3);
    }
    return e2;
  }
  _resetVariables() {
    this.colorVariables = [], this.opacityVariables = [], this.rotationVariables = [], this.sizeVariables = [];
  }
};
e$2g([y$1I()], V$f.prototype, "visualVariables", null), V$f = e$2g([n$2P("esri.renderers.visualVariables.VisualVariableFactory")], V$f);
const f$11 = V$f;
const v$D = { base: c$1E, key: "type", typeMap: { opacity: a$1D, color: a$1E, rotation: n$1z, size: j$s } }, y$K = (a2) => {
  let u2 = class extends a2 {
    constructor() {
      super(...arguments), this._vvFactory = new f$11();
    }
    set visualVariables(r2) {
      this._vvFactory.visualVariables = r2, this._set("visualVariables", this._vvFactory.visualVariables);
    }
    readVisualVariables(r2, a3, s2) {
      return this._vvFactory.readVariables(r2, a3, s2);
    }
    writeVisualVariables(r2, a3, s2, i2) {
      a3[s2] = this._vvFactory.writeVariables(r2, i2);
    }
    get arcadeRequiredForVisualVariables() {
      if (!this.visualVariables)
        return false;
      for (const r2 of this.visualVariables)
        if (r2.arcadeRequired)
          return true;
      return false;
    }
    hasVisualVariables(r2, a3) {
      return r2 ? this.getVisualVariablesForType(r2, a3).length > 0 : this.getVisualVariablesForType("size", a3).length > 0 || this.getVisualVariablesForType("color", a3).length > 0 || this.getVisualVariablesForType("opacity", a3).length > 0 || this.getVisualVariablesForType("rotation", a3).length > 0;
    }
    getVisualVariablesForType(r2, a3) {
      const s2 = this.visualVariables;
      return s2 ? s2.filter((s3) => s3.type === r2 && (typeof a3 == "string" ? s3.target === a3 : a3 !== false || !s3.target)) : [];
    }
    async collectVVRequiredFields(r2, a3) {
      let s2 = [];
      this.visualVariables && (s2 = s2.concat(this.visualVariables));
      for (const i2 of s2)
        i2 && (i2.field && w$X(r2, a3, i2.field), i2.normalizationField && w$X(r2, a3, i2.normalizationField), i2.valueExpression && (f$10(i2.valueExpression, r2, a3) || await S$Q(r2, a3, i2.valueExpression)));
    }
  };
  return e$2g([y$1I({ types: [v$D], value: null, json: { write: true } })], u2.prototype, "visualVariables", null), e$2g([o$29("visualVariables", ["visualVariables", "rotationType", "rotationExpression"])], u2.prototype, "readVisualVariables", null), e$2g([r$1P("visualVariables")], u2.prototype, "writeVisualVariables", null), u2 = e$2g([n$2P("esri.renderers.mixins.VisualVariablesMixin")], u2), u2;
};
function f$10(r2, s2, i2) {
  const e2 = e$_(r2);
  return !!r$1$(e2) && (w$X(s2, i2, e2), true);
}
const a$1z = { retainId: false, ignoreDrivers: false, hasLabelingContext: true };
function S$r(S2, c2 = a$1z) {
  var _a2, _b2;
  if (!S2)
    return { symbol: null };
  const { retainId: u2 = a$1z.retainId, ignoreDrivers: d2 = a$1z.ignoreDrivers, hasLabelingContext: j2 = a$1z.hasLabelingContext, retainCIM: g2 = a$1z.retainCIM } = c2;
  let D2 = null;
  if (c$2k(S2) || S2 instanceof f$1p)
    D2 = S2.clone();
  else if (S2.type === "cim") {
    const o2 = (_b2 = (_a2 = S2.data) == null ? void 0 : _a2.symbol) == null ? void 0 : _b2.type;
    if (o2 !== "CIMPointSymbol")
      return { error: new s$2u("symbol-conversion:unsupported-cim-symbol", `CIM symbol of type '${o2 || "unknown"}' is unsupported in 3D`, { symbol: S2 }) };
    D2 = g2 ? S2.clone() : h$1o.fromCIMSymbol(S2);
  } else if (S2 instanceof m$25)
    D2 = b$X.fromSimpleLineSymbol(S2);
  else if (S2 instanceof y$1f)
    D2 = h$1o.fromSimpleMarkerSymbol(S2);
  else if (S2 instanceof n$2a)
    D2 = h$1o.fromPictureMarkerSymbol(S2);
  else if (S2 instanceof S$H)
    D2 = c2.geometryType && c2.geometryType === "mesh" ? c$2o.fromSimpleFillSymbol(S2) : S$I.fromSimpleFillSymbol(S2);
  else {
    if (!(S2 instanceof m$1O))
      return { error: new s$2u("symbol-conversion:unsupported-2d-symbol", `2D symbol of type '${S2.type || S2.declaredClass}' is unsupported in 3D`, { symbol: S2 }) };
    D2 = j2 ? b$Y.fromTextSymbol(S2) : h$1o.fromTextSymbol(S2);
  }
  if (u2 && D2 && D2.type !== "cim" && (D2.id = S2.id), d2 && c$2k(D2))
    for (let o2 = 0; o2 < D2.symbolLayers.length; ++o2)
      D2.symbolLayers.getItemAt(o2)._ignoreDrivers = true;
  return { symbol: D2 };
}
const l$1r = ["building-scene", "integrated-mesh", "point-cloud", "scene"];
function m$1j(e2, o2, t2, s2) {
  const r2 = a$1y(e2, {}, { context: s2, isLabelSymbol: false });
  r$1$(r2) && (o2[t2] = r2);
}
function c$1D(e2, o2, t2, s2) {
  const r2 = a$1y(e2, {}, { context: s2, isLabelSymbol: true });
  r$1$(r2) && (o2[t2] = r2);
}
function b$A(e2) {
  return e2 instanceof k$x || e2 instanceof f$1p;
}
function a$1y(e2, s2, i2) {
  var _a2;
  if (t$2r(e2))
    return null;
  const { context: m2, isLabelSymbol: c2 } = i2, a2 = m2 == null ? void 0 : m2.origin, p2 = m2 == null ? void 0 : m2.messages;
  if (a2 === "web-scene" && !b$A(e2)) {
    const t2 = S$r(e2, { retainCIM: true, hasLabelingContext: c2 });
    return r$1$(t2.symbol) ? t2.symbol.write(s2, m2) : (p2 == null ? void 0 : p2.push(new s$2u("symbol:unsupported", `Symbols of type '${e2.declaredClass}' are not supported in scenes. Use 3D symbology instead when working with WebScene and SceneView`, { symbol: e2, context: m2, error: t2.error })), null);
  }
  const y2 = (_a2 = m2 == null ? void 0 : m2.layer) == null ? void 0 : _a2.type;
  return a2 !== "web-map" && (a2 !== "portal-item" || y2 && l$1r.includes(y2)) || !b$A(e2) ? e2.write(s2, m2) : (p2 == null ? void 0 : p2.push(new s$2u("symbol:unsupported", `Symbols of type '${e2.declaredClass}' are not supported in web maps and portal items. Use 2D symbology and CIMSymbol instead when working with MapView`, { symbol: e2, context: m2 })), null);
}
function p$1S(o2, n2) {
  return k$w(o2, null, n2);
}
const l$1q = { types: M$z, json: { write: { writer: m$1j }, origins: { "web-scene": { types: h$1l, write: { writer: m$1j }, read: { reader: s$2r({ types: h$1l }) } } } } }, y$J = { types: { base: a$2u, key: "type", typeMap: { "simple-fill": j$J.typeMap["simple-fill"], "picture-fill": j$J.typeMap["picture-fill"], "polygon-3d": j$J.typeMap["polygon-3d"] } }, json: { write: { writer: m$1j }, origins: { "web-scene": { type: S$I, write: { writer: m$1j } } } } }, m$1i = { cast: (e2) => e2 == null || typeof e2 == "string" || typeof e2 == "number" ? e2 : `${e2}`, json: { type: String, write: { writer: (e2, r2) => {
  r2.value = e2 == null ? void 0 : e2.toString();
} } } };
var i$1I;
let l$1p = i$1I = class extends l$2B {
  constructor(s2) {
    super(s2), this.description = null, this.label = null, this.minValue = null, this.maxValue = 0, this.symbol = null;
  }
  clone() {
    return new i$1I({ description: this.description, label: this.label, minValue: this.minValue, maxValue: this.maxValue, symbol: this.symbol ? this.symbol.clone() : null });
  }
  getMeshHash() {
    const s2 = JSON.stringify(this.symbol);
    return `${this.minValue}.${this.maxValue}.${s2}`;
  }
};
e$2g([y$1I({ type: String, json: { write: true } })], l$1p.prototype, "description", void 0), e$2g([y$1I({ type: String, json: { write: true } })], l$1p.prototype, "label", void 0), e$2g([y$1I({ type: Number, json: { read: { source: "classMinValue" }, write: { target: "classMinValue" } } })], l$1p.prototype, "minValue", void 0), e$2g([y$1I({ type: Number, json: { read: { source: "classMaxValue" }, write: { target: "classMaxValue" } } })], l$1p.prototype, "maxValue", void 0), e$2g([y$1I(l$1q)], l$1p.prototype, "symbol", void 0), l$1p = i$1I = e$2g([n$2P("esri.renderers.support.ClassBreakInfo")], l$1p);
const a$1x = l$1p;
var V$e;
const E$t = "log", j$r = "percent-of-total", z$q = "field", w$w = new s$2a({ esriNormalizeByLog: E$t, esriNormalizeByPercentOfTotal: j$r, esriNormalizeByField: z$q }), T$k = b$1a(a$1x);
let C$o = V$e = class extends y$K(p$1_) {
  constructor(e2) {
    super(e2), this._compiledValueExpression = { valueExpression: null, compiledFunction: null }, this.backgroundFillSymbol = null, this.classBreakInfos = null, this.defaultLabel = null, this.defaultSymbol = null, this.field = null, this.isMaxInclusive = true, this.legendOptions = null, this.normalizationField = null, this.normalizationTotal = null, this.type = "class-breaks", this.valueExpression = null, this.valueExpressionTitle = null, this._set("classBreakInfos", []);
  }
  readClassBreakInfos(e2, s2, t2) {
    if (!Array.isArray(e2))
      return;
    let o2 = s2.minValue;
    return e2.map((e3) => {
      const s3 = new a$1x();
      return s3.read(e3, t2), s3.minValue == null && (s3.minValue = o2), s3.maxValue == null && (s3.maxValue = s3.minValue), o2 = s3.maxValue, s3;
    });
  }
  writeClassBreakInfos(e2, s2, t2, o2) {
    const i2 = e2.map((e3) => e3.write({}, o2));
    this._areClassBreaksConsecutive() && i2.forEach((e3) => delete e3.classMinValue), s2[t2] = i2;
  }
  castField(e2) {
    return e2 == null ? e2 : typeof e2 == "function" ? (s$2z.getLogger(this.declaredClass).error(".field: field must be a string value"), null) : u$2l(e2);
  }
  get minValue() {
    return this.classBreakInfos && this.classBreakInfos[0] && this.classBreakInfos[0].minValue || 0;
  }
  get normalizationType() {
    let e2 = this._get("normalizationType");
    const s2 = !!this.normalizationField, t2 = this.normalizationTotal != null;
    return s2 || t2 ? (e2 = s2 && z$q || t2 && j$r || null, s2 && t2 && s$2z.getLogger(this.declaredClass).warn("warning: both normalizationField and normalizationTotal are set!")) : e2 !== z$q && e2 !== j$r || (e2 = null), e2;
  }
  set normalizationType(e2) {
    this._set("normalizationType", e2);
  }
  addClassBreakInfo(e2, t2, i2) {
    let r2 = null;
    r2 = typeof e2 == "number" ? new a$1x({ minValue: e2, maxValue: t2, symbol: g$11(i2) }) : T$k(y$1L(e2)), this.classBreakInfos.push(r2), this.classBreakInfos.length === 1 && this.notifyChange("minValue");
  }
  removeClassBreakInfo(e2, s2) {
    const t2 = this.classBreakInfos.length;
    for (let o2 = 0; o2 < t2; o2++) {
      const t3 = [this.classBreakInfos[o2].minValue, this.classBreakInfos[o2].maxValue];
      if (t3[0] === e2 && t3[1] === s2) {
        this.classBreakInfos.splice(o2, 1);
        break;
      }
    }
  }
  getBreakIndex(e2, s2) {
    return this.valueExpression && (t$2r(s2) || t$2r(s2.arcade)) && s$2z.getLogger(this.declaredClass).warn(""), this.valueExpression ? this._getBreakIndexForExpression(e2, s2) : this._getBreakIndexForField(e2);
  }
  async getClassBreakInfo(e2, s2) {
    let t2 = s2;
    this.valueExpression && (t$2r(s2) || t$2r(s2.arcade)) && (t2 = __spreadProps(__spreadValues({}, t2), { arcade: await i$2P() }));
    const o2 = this.getBreakIndex(e2, t2);
    return o2 !== -1 ? this.classBreakInfos[o2] : null;
  }
  getSymbol(e2, s2) {
    if (this.valueExpression && (t$2r(s2) || t$2r(s2.arcade)))
      return void s$2z.getLogger(this.declaredClass).error("#getSymbol()", "Please use getSymbolAsync if valueExpression is used");
    const t2 = this.getBreakIndex(e2, s2);
    return t2 > -1 ? this.classBreakInfos[t2].symbol : this.defaultSymbol;
  }
  async getSymbolAsync(e2, s2) {
    let t2 = s2;
    if (this.valueExpression && (t$2r(s2) || t$2r(s2.arcade))) {
      const e3 = await i$2P(), { arcadeUtils: s3 } = e3;
      s3.hasGeometryOperations(this.valueExpression) && await s3.enableGeometryOperations(), t2 = __spreadProps(__spreadValues({}, t2), { arcade: e3 });
    }
    const o2 = this.getBreakIndex(e2, t2);
    return o2 > -1 ? this.classBreakInfos[o2].symbol : this.defaultSymbol;
  }
  getSymbols() {
    const e2 = [];
    return this.classBreakInfos.forEach((s2) => {
      s2.symbol && e2.push(s2.symbol);
    }), this.defaultSymbol && e2.push(this.defaultSymbol), e2;
  }
  getAttributeHash() {
    return this.visualVariables && this.visualVariables.reduce((e2, s2) => e2 + s2.getAttributeHash(), "");
  }
  getMeshHash() {
    const e2 = JSON.stringify(this.backgroundFillSymbol), s2 = JSON.stringify(this.defaultSymbol), t2 = `${this.normalizationField}.${this.normalizationType}.${this.normalizationTotal}`;
    return `${e2}.${s2}.${this.classBreakInfos.reduce((e3, s3) => e3 + s3.getMeshHash(), "")}.${t2}.${this.field}.${this.valueExpression}`;
  }
  get arcadeRequired() {
    return this.arcadeRequiredForVisualVariables || !!this.valueExpression;
  }
  clone() {
    return new V$e({ field: this.field, backgroundFillSymbol: this.backgroundFillSymbol && this.backgroundFillSymbol.clone(), defaultLabel: this.defaultLabel, defaultSymbol: this.defaultSymbol && this.defaultSymbol.clone(), valueExpression: this.valueExpression, valueExpressionTitle: this.valueExpressionTitle, classBreakInfos: y$1L(this.classBreakInfos), isMaxInclusive: this.isMaxInclusive, normalizationField: this.normalizationField, normalizationTotal: this.normalizationTotal, normalizationType: this.normalizationType, visualVariables: y$1L(this.visualVariables), legendOptions: y$1L(this.legendOptions), authoringInfo: this.authoringInfo && this.authoringInfo.clone() });
  }
  async collectRequiredFields(e2, s2) {
    const t2 = [this.collectVVRequiredFields(e2, s2), this.collectSymbolFields(e2, s2)];
    await Promise.all(t2);
  }
  async collectSymbolFields(e2, s2) {
    const t2 = [...this.getSymbols().map((t3) => t3.collectRequiredFields(e2, s2)), S$Q(e2, s2, this.valueExpression)];
    w$X(e2, s2, this.field), w$X(e2, s2, this.normalizationField), await Promise.all(t2);
  }
  _getBreakIndexForExpression(e2, s2) {
    const { viewingMode: t2, scale: o2, spatialReference: i2, arcade: r2 } = i$3f(s2, {}), { valueExpression: n2 } = this;
    let u2 = this._compiledValueExpression.valueExpression === n2 ? this._compiledValueExpression.compiledFunction : null;
    const c2 = e$2e(r2).arcadeUtils;
    if (!u2) {
      const e3 = c2.createSyntaxTree(n2);
      u2 = c2.createFunction(e3), this._compiledValueExpression.compiledFunction = u2;
    }
    this._compiledValueExpression.valueExpression = n2;
    const p2 = c2.executeFunction(u2, c2.createExecContext(e2, c2.getViewInfo({ viewingMode: t2, scale: o2, spatialReference: i2 })));
    return this._getBreakIndexfromInfos(p2);
  }
  _getBreakIndexForField(e2) {
    const s2 = this.field, t2 = e2.attributes, o2 = this.normalizationType;
    let i2 = parseFloat(t2[s2]);
    if (o2) {
      const e3 = this.normalizationTotal, s3 = parseFloat(this.normalizationField ? t2[this.normalizationField] : void 0);
      if (o2 === E$t)
        i2 = Math.log(i2) * Math.LOG10E;
      else if (o2 !== j$r || e3 == null || isNaN(e3)) {
        if (o2 === z$q && !isNaN(s3)) {
          if (isNaN(i2) || isNaN(s3))
            return -1;
          i2 /= s3;
        }
      } else
        i2 = i2 / e3 * 100;
    }
    return this._getBreakIndexfromInfos(i2);
  }
  _getBreakIndexfromInfos(e2) {
    const s2 = this.isMaxInclusive;
    if (e2 != null && typeof e2 == "number" && !isNaN(e2))
      for (let t2 = 0; t2 < this.classBreakInfos.length; t2++) {
        const o2 = [this.classBreakInfos[t2].minValue, this.classBreakInfos[t2].maxValue];
        if (o2[0] <= e2 && (s2 ? e2 <= o2[1] : e2 < o2[1]))
          return t2;
      }
    return -1;
  }
  _areClassBreaksConsecutive() {
    const e2 = this.classBreakInfos, s2 = e2.length;
    for (let t2 = 1; t2 < s2; t2++)
      if (e2[t2 - 1].maxValue !== e2[t2].minValue)
        return false;
    return true;
  }
};
e$2g([y$1I(y$J)], C$o.prototype, "backgroundFillSymbol", void 0), e$2g([y$1I({ type: [a$1x] })], C$o.prototype, "classBreakInfos", void 0), e$2g([o$29("classBreakInfos")], C$o.prototype, "readClassBreakInfos", null), e$2g([r$1P("classBreakInfos")], C$o.prototype, "writeClassBreakInfos", null), e$2g([y$1I({ type: String, json: { write: true } })], C$o.prototype, "defaultLabel", void 0), e$2g([y$1I(l$1q)], C$o.prototype, "defaultSymbol", void 0), e$2g([y$1I({ type: String, json: { write: true } })], C$o.prototype, "field", void 0), e$2g([s$2i("field")], C$o.prototype, "castField", null), e$2g([y$1I({ type: Boolean })], C$o.prototype, "isMaxInclusive", void 0), e$2g([y$1I({ type: p$1Z, json: { write: true } })], C$o.prototype, "legendOptions", void 0), e$2g([y$1I({ type: Number, readOnly: true, value: null, json: { read: false, write: { overridePolicy() {
  return this.classBreakInfos.length !== 0 && this._areClassBreaksConsecutive() ? { enabled: true } : { enabled: false };
} } } })], C$o.prototype, "minValue", null), e$2g([y$1I({ type: String, json: { write: true } })], C$o.prototype, "normalizationField", void 0), e$2g([y$1I({ type: Number, cast: (e2) => a$2_(e2), json: { write: true } })], C$o.prototype, "normalizationTotal", void 0), e$2g([y$1I({ type: w$w.apiValues, value: null, json: { type: w$w.jsonValues, read: w$w.read, write: w$w.write } })], C$o.prototype, "normalizationType", null), e$2g([r$1H({ classBreaks: "class-breaks" })], C$o.prototype, "type", void 0), e$2g([y$1I({ type: String, json: { write: true } })], C$o.prototype, "valueExpression", void 0), e$2g([y$1I({ type: String, json: { write: true } })], C$o.prototype, "valueExpressionTitle", void 0), C$o = V$e = e$2g([n$2P("esri.renderers.ClassBreaksRenderer")], C$o);
const _$t = C$o;
class e$Y {
  constructor(e2, s2) {
    this._storage = new h$15(), this._storage.maxSize = e2, s2 && this._storage.registerRemoveFunc("", s2);
  }
  put(t2, e2, s2) {
    this._storage.put(t2, e2, s2, 1);
  }
  pop(t2) {
    return this._storage.pop(t2);
  }
  get(t2) {
    return this._storage.get(t2);
  }
  clear() {
    this._storage.clearAll();
  }
  destroy() {
    this._storage.destroy();
  }
  get maxSize() {
    return this._storage.maxSize;
  }
  set maxSize(t2) {
    this._storage.maxSize = t2;
  }
}
const h$U = "esri.renderers.support.DictionaryLoader", y$I = { type: "CIMSimpleLineCallout", lineSymbol: { type: "CIMLineSymbol", symbolLayers: [{ type: "CIMSolidStroke", width: 0.5, color: [0, 0, 0, 255] }] } };
class u$16 {
  constructor(e2, t2, s2) {
    this.config = null, this.fieldMap = null, this.url = null, this._ongoingRequests = new Map(), this._symbolCache = new e$Y(100), this._dictionaryPromise = null, this.url = e2, this.config = t2, this.fieldMap = s2;
  }
  getSymbolFields() {
    return this._symbolFields;
  }
  async getSymbolAsync(t2, s2) {
    let o2;
    this._dictionaryPromise || (this._dictionaryPromise = this.fetchResources(s2));
    try {
      o2 = await this._dictionaryPromise;
    } catch (g2) {
      if (j$_(g2))
        return this._dictionaryPromise = null, null;
    }
    const i2 = {};
    if (this.fieldMap)
      for (const e2 of this._symbolFields) {
        const s3 = this.fieldMap[e2];
        if (s3 && t2.attributes[s3] != null) {
          const o3 = "" + t2.attributes[s3];
          i2[e2] = o3;
        } else
          i2[e2] = "";
      }
    const n2 = o2 == null ? void 0 : o2(i2, s2);
    if (!n2 || typeof n2 != "string")
      return null;
    const c2 = c$3r(n2).toString(), m2 = this._symbolCache.get(c2);
    if (m2)
      return m2.catch(() => {
        this._symbolCache.pop(c2);
      }), m2;
    const f2 = n2.split(";"), h2 = [], y2 = [];
    for (const r2 of f2)
      if (r2)
        if (r2.includes("po:")) {
          const t3 = r2.substr(3).split("|");
          if (t3.length === 3) {
            const s3 = t3[0], o3 = t3[1];
            let i3 = t3[2];
            if (o3 === "DashTemplate")
              i3 = i3.split(" ").map((e2) => Number(e2));
            else if (o3 === "Color") {
              const t4 = new l$2e(i3).toRgba();
              i3 = [t4[0], t4[1], t4[2], 255 * t4[3]];
            } else
              i3 = Number(i3);
            y2.push({ primitiveName: s3, propertyName: o3, value: i3 });
          }
        } else if (r2.includes("|")) {
          for (const e2 of r2.split("|"))
            if (this._itemNames.has(e2)) {
              h2.push(e2);
              break;
            }
        } else
          this._itemNames.has(r2) && h2.push(r2);
    const u2 = !r$1$(t2.geometry) || !t2.geometry.hasZ && t2.geometry.type === "point", p2 = this._cimPartsToCIMSymbol(h2, y2, u2, s2);
    return this._symbolCache.put(c2, p2, 1), p2;
  }
  async fetchResources(e2) {
    if (this._dictionaryPromise)
      return this._dictionaryPromise;
    if (!this.url)
      return void s$2z.getLogger(h$U).error("no valid URL!");
    const i2 = U$t(this.url + "/resources/styles/dictionary-info.json", { responseType: "json", query: { f: "json" }, signal: r$1$(e2) ? e2.signal : null }), [{ data: l2 }] = await Promise.all([i2, i$2P()]);
    if (!l2)
      throw this._dictionaryPromise = null, new s$2u("esri.renderers.DictionaryRenderer", "Bad dictionary data!");
    const a2 = l2.expression, f2 = l2.authoringInfo;
    this._refSymbolUrlTemplate = this.url + "/" + l2.cimRefTemplateUrl, this._itemNames = new Set(l2.itemsNames), this._symbolFields = f2.symbol;
    const y2 = {};
    if (this.config) {
      const e3 = this.config;
      for (const t2 in e3)
        y2[t2] = e3[t2];
    }
    if (f2.configuration)
      for (const t2 of f2.configuration)
        y2.hasOwnProperty(t2.name) || (y2[t2.name] = t2.value);
    const u2 = [];
    if (r$1$(e2) && e2.fields && this.fieldMap)
      for (const t2 of this._symbolFields) {
        const s2 = this.fieldMap[t2], o2 = e2.fields.filter((e3) => e3.name === s2);
        o2.length > 0 && u2.push(__spreadProps(__spreadValues({}, o2[0]), { name: t2 }));
      }
    const p2 = u$1$(a2, r$1$(e2) ? e2.spatialReference : null, u2, y2).then((e3) => {
      const t2 = { scale: 0 };
      return (s2, o2) => {
        if (t$2r(e3))
          return null;
        const i3 = e3.repurposeFeature({ geometry: null, attributes: s2 });
        return t2.scale = r$1$(o2) ? o2.scale : void 0, e3.evaluate({ $feature: i3, $view: t2 });
      };
    }).catch((e3) => (s$2z.getLogger(h$U).error("Creating dictinoary expression failed:", e3), null));
    return this._dictionaryPromise = p2, p2;
  }
  async _cimPartsToCIMSymbol(e2, t2, s2, o2) {
    const i2 = new Array(e2.length);
    for (let l2 = 0; l2 < e2.length; l2++)
      i2[l2] = this._getSymbolPart(e2[l2], o2);
    const r2 = await Promise.all(i2), n2 = this.fieldMap;
    if (n2)
      for (const l2 of r2)
        p$1R(l2, n2);
    return new d$1H({ data: this._combineSymbolParts(r2, t2, s2) });
  }
  async _getSymbolPart(e2, s2) {
    if (this._ongoingRequests.has(e2))
      return this._ongoingRequests.get(e2).then((e3) => e3.data);
    const o2 = this._refSymbolUrlTemplate.replace(/\{itemName\}/gi, e2), i2 = U$t(o2, __spreadValues({ responseType: "json", query: { f: "json" } }, s2));
    this._ongoingRequests.set(e2, i2);
    try {
      return (await i2).data;
    } catch (r2) {
      throw this._ongoingRequests.delete(e2), r2;
    }
  }
  _combineSymbolParts(e2, t2, s2) {
    if (!e2 || e2.length === 0)
      return null;
    const o2 = __spreadValues({}, e2[0]);
    if (e2.length > 1) {
      o2.symbolLayers = [];
      for (const t3 of e2) {
        const e3 = t3;
        o2.symbolLayers.unshift(...e3.symbolLayers);
      }
    }
    return s2 && (o2.callout = y$I), { type: "CIMSymbolReference", symbol: o2, primitiveOverrides: t2 };
  }
}
function p$1R(e2, t2) {
  if (!e2)
    return;
  const s2 = e2.symbolLayers;
  if (!s2)
    return;
  let o2 = s2.length;
  for (; o2--; ) {
    const e3 = s2[o2];
    if (e3 && e3.enable !== false && e3.type === "CIMVectorMarker")
      g$F(e3, t2);
  }
}
function g$F(e2, t2) {
  const s2 = e2.markerGraphics;
  if (s2)
    for (const o2 of s2) {
      if (!o2)
        continue;
      const e3 = o2.symbol;
      if (e3)
        switch (e3.type) {
          case "CIMPointSymbol":
          case "CIMLineSymbol":
          case "CIMPolygonSymbol":
            p$1R(e3, t2);
            break;
          case "CIMTextSymbol":
            e3.fieldMap = t2;
        }
    }
}
var DictionaryLoader = /* @__PURE__ */ Object.freeze({
  __proto__: null,
  [Symbol.toStringTag]: "Module",
  DictionaryLoader: u$16
});
var p$1Q;
let c$1C = p$1Q = class extends y$K(p$1_) {
  constructor(e2) {
    super(e2), this.config = null, this.fieldMap = null, this.scaleExpression = null, this.scaleExpressionTitle = null, this.url = null, this.type = "dictionary";
  }
  get _loader() {
    return new u$16(this.url, this.config, this.fieldMap);
  }
  writeData(e2, r2) {
    e2 && (r2.scalingExpressionInfo = { expression: e2, returnType: "number" });
  }
  writeVisualVariables(e2, r2, s2, i2) {
    (i2 == null ? void 0 : i2.origin) || super.writeVisualVariables(e2, r2, s2, i2);
  }
  clone() {
    return new p$1Q({ config: y$1L(this.config), scaleExpression: this.scaleExpression, scaleExpressionTitle: this.scaleExpressionTitle, fieldMap: y$1L(this.fieldMap), url: y$1L(this.url), visualVariables: y$1L(this.visualVariables) });
  }
  async getSymbolAsync(e2, r2) {
    return this._loader.getSymbolAsync(e2, r2);
  }
  async collectRequiredFields(e2, r2) {
    await this.collectVVRequiredFields(e2, r2), this.scaleExpression && await S$Q(e2, r2, this.scaleExpression);
    for (const s2 in this.fieldMap) {
      const i2 = this.fieldMap[s2];
      r2.has(i2) && e2.add(i2);
    }
  }
  get arcadeRequired() {
    return true;
  }
  getSymbol() {
    return null;
  }
  getSymbols() {
    return [];
  }
  getAttributeHash() {
    return this.visualVariables && this.visualVariables.reduce((e2, r2) => e2 + r2.getAttributeHash(), "");
  }
  getMeshHash() {
    return `${this.url}-${JSON.stringify(this.fieldMap)}`;
  }
  getSymbolFields() {
    return this._loader.getSymbolFields();
  }
};
e$2g([y$1I({ type: u$16 })], c$1C.prototype, "_loader", null), e$2g([y$1I({ type: Object, json: { read: { source: "configuration" }, write: { target: "configuration" } } })], c$1C.prototype, "config", void 0), e$2g([y$1I({ type: Object, json: { write: true } })], c$1C.prototype, "fieldMap", void 0), e$2g([y$1I({ type: String, json: { read: { source: "scalingExpressionInfo.expression" }, write: true } })], c$1C.prototype, "scaleExpression", void 0), e$2g([r$1P("scaleExpression")], c$1C.prototype, "writeData", null), e$2g([y$1I({ type: String, json: { read: { source: "scalingExpressionInfo.title" }, write: { target: "scalingExpressionInfo.title", overridePolicy(e2) {
  return { enabled: !!e2 && !!this.scaleExpression };
} } } })], c$1C.prototype, "scaleExpressionTitle", void 0), e$2g([y$1I({ type: String, json: { write: true } })], c$1C.prototype, "url", void 0), e$2g([r$1P("visualVariables")], c$1C.prototype, "writeVisualVariables", null), c$1C = p$1Q = e$2g([n$2P("esri.renderers.DictionaryRenderer")], c$1C);
const u$15 = c$1C;
var n$1w;
let u$14 = n$1w = class extends l$2B {
  constructor(e2) {
    super(e2), this.color = null, this.field = null, this.label = null, this.valueExpression = null, this.valueExpressionTitle = null;
  }
  castField(e2) {
    return e2 == null ? e2 : typeof e2 == "function" ? (s$2z.getLogger(this.declaredClass).error(".field: field must be a string value"), null) : u$2l(e2);
  }
  getAttributeHash() {
    return `${this.field}-${this.valueExpression}`;
  }
  clone() {
    return new n$1w({ color: this.color && this.color.clone(), field: this.field, label: this.label, valueExpression: this.valueExpression, valueExpressionTitle: this.valueExpressionTitle });
  }
};
e$2g([y$1I({ type: l$2e, json: { type: [Number], write: true } })], u$14.prototype, "color", void 0), e$2g([y$1I({ type: String, json: { write: true } })], u$14.prototype, "field", void 0), e$2g([s$2i("field")], u$14.prototype, "castField", null), e$2g([y$1I({ type: String, json: { write: true } })], u$14.prototype, "label", void 0), e$2g([y$1I({ type: String, json: { write: true } })], u$14.prototype, "valueExpression", void 0), e$2g([y$1I({ type: String, json: { write: true } })], u$14.prototype, "valueExpressionTitle", void 0), u$14 = n$1w = e$2g([n$2P("esri.renderers.support.AttributeColorInfo")], u$14);
const a$1w = u$14;
var e$X;
let p$1P = e$X = class extends l$2B {
  constructor() {
    super(...arguments), this.unit = null;
  }
  clone() {
    return new e$X({ unit: this.unit });
  }
};
e$2g([y$1I({ type: String, json: { write: true } })], p$1P.prototype, "unit", void 0), p$1P = e$X = e$2g([n$2P("esri.renderers.support.DotDensityLegendOptions")], p$1P);
const c$1B = p$1P;
var h$T;
let m$1h = h$T = class extends y$K(p$1_) {
  constructor(t2) {
    super(t2), this.attributes = null, this.backgroundColor = new l$2e([0, 0, 0, 0]), this.dotBlendingEnabled = true, this.dotShape = "square", this.dotSize = 1, this.legendOptions = null, this.outline = new m$25(), this.dotValue = null, this.referenceScale = null, this.seed = 1, this.type = "dot-density";
  }
  calculateDotValue(t2) {
    if (this.referenceScale == null)
      return this.dotValue;
    const e2 = t2 / this.referenceScale * this.dotValue;
    return e2 < 1 ? 1 : e2;
  }
  getSymbol() {
    return new S$H({ outline: this.outline });
  }
  async getSymbolAsync() {
    return this.getSymbol();
  }
  getSymbols() {
    return [this.getSymbol()];
  }
  getAttributeHash() {
    var _a2, _b2;
    return (_b2 = (_a2 = this.attributes) == null ? void 0 : _a2.reduce((t2, e2) => t2 + e2.getAttributeHash(), "")) != null ? _b2 : "";
  }
  getMeshHash() {
    return JSON.stringify(this.outline);
  }
  clone() {
    return new h$T({ attributes: y$1L(this.attributes), backgroundColor: y$1L(this.backgroundColor), dotBlendingEnabled: y$1L(this.dotBlendingEnabled), dotShape: y$1L(this.dotShape), dotSize: y$1L(this.dotSize), dotValue: y$1L(this.dotValue), legendOptions: y$1L(this.legendOptions), outline: y$1L(this.outline), referenceScale: y$1L(this.referenceScale), visualVariables: y$1L(this.visualVariables), authoringInfo: this.authoringInfo && this.authoringInfo.clone() });
  }
  getControllerHash() {
    var _a2;
    const t2 = (_a2 = this.attributes) == null ? void 0 : _a2.map((t3) => t3.field || t3.valueExpression || "");
    return `${t2}-${this.outline && JSON.stringify(this.outline.toJSON()) || ""}`;
  }
  async collectRequiredFields(t2, e2) {
    var _a2;
    await this.collectVVRequiredFields(t2, e2);
    for (const o2 of (_a2 = this.attributes) != null ? _a2 : [])
      o2.valueExpression && await S$Q(t2, e2, o2.valueExpression), o2.field && t2.add(o2.field);
  }
};
e$2g([y$1I({ type: [a$1w], json: { write: true } })], m$1h.prototype, "attributes", void 0), e$2g([y$1I({ type: l$2e, json: { write: true } })], m$1h.prototype, "backgroundColor", void 0), e$2g([y$1I({ type: Boolean, json: { write: true } })], m$1h.prototype, "dotBlendingEnabled", void 0), e$2g([y$1I({ type: String, json: { write: false } })], m$1h.prototype, "dotShape", void 0), e$2g([y$1I({ type: Number, json: { write: true } })], m$1h.prototype, "dotSize", void 0), e$2g([y$1I({ type: c$1B, json: { write: true } })], m$1h.prototype, "legendOptions", void 0), e$2g([y$1I({ type: m$25, json: { default: null, write: true } })], m$1h.prototype, "outline", void 0), e$2g([y$1I({ type: Number, json: { write: true } })], m$1h.prototype, "dotValue", void 0), e$2g([y$1I({ type: Number, json: { write: true } })], m$1h.prototype, "referenceScale", void 0), e$2g([y$1I({ type: Number, json: { write: true } })], m$1h.prototype, "seed", void 0), e$2g([r$1H({ dotDensity: "dot-density" })], m$1h.prototype, "type", void 0), m$1h = h$T = e$2g([n$2P("esri.renderers.DotDensityRenderer")], m$1h);
const y$H = m$1h;
let p$1O = class extends i$2R(l$2B) {
  constructor() {
    super(...arguments), this.minLabel = null, this.maxLabel = null, this.title = null;
  }
};
e$2g([y$1I({ type: String, json: { write: true } })], p$1O.prototype, "minLabel", void 0), e$2g([y$1I({ type: String, json: { write: true } })], p$1O.prototype, "maxLabel", void 0), e$2g([y$1I({ type: String, json: { write: true } })], p$1O.prototype, "title", void 0), p$1O = e$2g([n$2P("esri.renderers.support.HeatmapLegendOptions")], p$1O);
function n$1v() {
  return [0, 0, 0, 0];
}
function t$17(n2) {
  return [n2[0], n2[1], n2[2], n2[3]];
}
function r$12(n2, t2, r2, e2) {
  return [n2, t2, r2, e2];
}
function e$W(t2) {
  const r2 = n$1v(), e2 = Math.min(4, t2.length);
  for (let n2 = 0; n2 < e2; ++n2)
    r2[n2] = t2[n2];
  return r2;
}
function u$13(n2, t2) {
  return new Float64Array(n2, t2, 4);
}
function a$1v() {
  return n$1v();
}
function o$18() {
  return r$12(1, 1, 1, 1);
}
function s$1h() {
  return r$12(1, 0, 0, 0);
}
function i$1H() {
  return r$12(0, 1, 0, 0);
}
function c$1A() {
  return r$12(0, 0, 1, 0);
}
function f$$() {
  return r$12(0, 0, 0, 1);
}
const l$1o = a$1v(), _$s = o$18(), N$h = s$1h(), O$l = i$1H(), T$j = c$1A(), U$f = f$$();
Object.freeze(Object.defineProperty({ __proto__: null, create: n$1v, clone: t$17, fromValues: r$12, fromArray: e$W, createView: u$13, zeros: a$1v, ones: o$18, unitX: s$1h, unitY: i$1H, unitZ: c$1A, unitW: f$$, ZEROS: l$1o, ONES: _$s, UNIT_X: N$h, UNIT_Y: O$l, UNIT_Z: T$j, UNIT_W: U$f }, Symbol.toStringTag, { value: "Module" }));
const a$1u = 2.4;
function i$1G(t2) {
  return e$1D(t2 * a$1u);
}
function c$1z(t2) {
  return u$1Q(t2) / a$1u;
}
function f$_(r2, n2, e2, a2) {
  let { color: i2, ratio: c2 } = n2, { color: f2, ratio: u2 } = e2;
  if (u2 === c2) {
    const t2 = 1e-6;
    u2 === 1 ? c2 -= t2 : u2 += t2;
  }
  const s2 = a$2v((a2 - c2) / (u2 - c2), 0, 1);
  j$S(r2, i2.toArray(), f2.toArray(), s2);
}
function u$12(t2) {
  const r2 = 512, n2 = new Uint8ClampedArray(4 * r2);
  if (t2 = t2.filter(({ ratio: t3 }) => t3 >= 0 && t3 <= 1).sort((t3, r3) => t3.ratio - r3.ratio).map(({ color: t3, ratio: r3 }) => ({ color: t3, ratio: Math.max(r3, 1e-3) })), t2.length < 1)
    return n2;
  let o2 = t2[0], a2 = t2[0], i2 = 1;
  const c2 = n$1v();
  for (let e2 = 0; e2 < r2; e2++) {
    const u2 = (e2 + 0.5) / r2;
    for (; u2 > a2.ratio && i2 < t2.length; )
      o2 = a2, a2 = t2[i2++];
    f$_(c2, o2, a2, u2), n2.set(c2, 4 * e2);
  }
  return n2;
}
function s$1g(t2, r2, o2, e2) {
  const { radius: a2, fieldOffset: i2, field: c2 } = r2, f2 = Math.round(u$1Q(a2)), u2 = new Float64Array(o2 * e2);
  let s2, l2 = Number.NEGATIVE_INFINITY;
  const h2 = d$S(c2, i2), y2 = new Set();
  for (const n2 of t2) {
    const t3 = n2.getCursor();
    for (; t3.next(); ) {
      const r3 = t3.getObjectId();
      if (y2.has(r3))
        continue;
      y2.add(r3);
      const n3 = t3.readLegacyPointGeometry(), a3 = 128;
      if (n3.x < -a3 || n3.x >= o2 + a3 || n3.y < -a3 || n3.y > e2 + a3)
        continue;
      const i3 = +h2(t3), c3 = Math.max(0, Math.round(n3.x) - f2), d2 = Math.max(0, Math.round(n3.y) - f2), g2 = Math.min(e2, Math.round(n3.y) + f2), A2 = Math.min(o2, Math.round(n3.x) + f2);
      for (let t4 = d2; t4 < g2; t4++)
        for (let r4 = c3; r4 < A2; r4++) {
          const e3 = t4 * o2 + r4, a4 = m$1g(n3.x - r4, n3.y - t4, f2);
          s2 = u2[e3] += a4 * i3, s2 > l2 && (l2 = s2);
        }
    }
  }
  return { matrix: u2.buffer, max: l2 };
}
function l$1n(t2, r2, n2, o2, e2, a2) {
  t2.canvas.width = t2.canvas.height = r2, t2.clearRect(0, 0, r2, r2);
  const i2 = t2.getImageData(0, 0, r2, r2);
  n2 && o2 && i2.data.set(new Uint8ClampedArray(h$S(r2, n2, o2, e2, a2))), t2.putImageData(i2, 0, 0);
}
function h$S(r2, n2, o2, e2, a2) {
  const i2 = new Uint32Array(r2 * r2), c2 = "buffer" in n2 ? n2 : new Float64Array(n2), f2 = "buffer" in o2 ? new Uint32Array(o2.buffer) : new Uint32Array(new Uint8Array(o2).buffer), u2 = f2.length / (a2 - e2);
  for (let s2 = 0; s2 < c2.length; s2++) {
    const r3 = c2[s2], n3 = Math.floor((r3 - e2) * u2);
    i2[s2] = f2[a$2v(n3, 0, f2.length - 1)];
  }
  return i2.buffer;
}
function m$1g(t2, r2, n2) {
  const o2 = Math.sqrt(t2 ** 2 + r2 ** 2) / n2;
  return o2 > 1 ? 0 : 3 / (Math.PI * n2 ** 2) * (1 - o2 ** 2) ** 2;
}
function y$G(t2, r2) {
  return typeof t2 == "function" ? t2 : t2 ? typeof r2 == "string" ? (r3) => -1 * +r3[t2] : (n2) => +n2[t2] + r2 : () => 1;
}
function d$S(t2, r2) {
  return t2 != null ? typeof r2 == "string" ? (r3) => -1 * +r3.readAttribute(t2) : (n2) => +n2.readAttribute(t2) + r2 : (t3) => 1;
}
var j$q;
const D$g = "esri.renderers.HeatmapRenderer", I$o = s$2z.getLogger(D$g);
function S$q(e2) {
  if (e2 != null) {
    const { maxDensity: t2, minDensity: i2, radius: s2 } = e2;
    if (t2 != null || i2 != null || s2 != null) {
      const _a2 = e2, { blurRadius: t3, maxPixelIntensity: i3, minPixelIntensity: s3 } = _a2, r2 = __objRest(_a2, ["blurRadius", "maxPixelIntensity", "minPixelIntensity"]);
      return r2;
    }
  }
  return e2;
}
let v$C = j$q = class extends p$1_ {
  constructor(e2) {
    super(e2), this.authoringInfo = null, this.colorStops = [new a$1R({ ratio: 0, color: new l$2e("rgba(255, 140, 0, 0)") }), new a$1R({ ratio: 0.75, color: new l$2e("rgba(255, 140, 0, 1)") }), new a$1R({ ratio: 0.9, color: new l$2e("rgba(255, 0,   0, 1)") })], this.field = null, this.fieldOffset = 0, this.legendOptions = null, this.maxDensity = 0.04, this.minDensity = 0, this.radius = 18, this.referenceScale = 0, this.type = "heatmap", this.valueExpression = null, this.valueExpressionTitle = null, this._warnedProps = { blurRadius: false, maxPixelIntensity: false, minPixelIntensity: false };
  }
  normalizeCtorArgs(e2) {
    return S$q(e2);
  }
  get blurRadius() {
    return c$1z(this.radius);
  }
  set blurRadius(e2) {
    const t2 = this.maxPixelIntensity, i2 = this.minPixelIntensity;
    this._set("radius", i$1G(e2)), this._warnAboutDeprecatedGaussianBlurProp("blurRadius", "radius"), this._set("maxDensity", t2 * this._pixelIntensityToDensity), this._set("minDensity", i2 * this._pixelIntensityToDensity);
  }
  get maxPixelIntensity() {
    return this.maxDensity / this._pixelIntensityToDensity;
  }
  set maxPixelIntensity(e2) {
    this._set("maxDensity", e2 * this._pixelIntensityToDensity), this._warnAboutDeprecatedGaussianBlurProp("maxPixelIntensity", "maxDensity");
  }
  get minPixelIntensity() {
    return this.minDensity / this._pixelIntensityToDensity;
  }
  set minPixelIntensity(e2) {
    this._set("minDensity", e2 * this._pixelIntensityToDensity), this._warnAboutDeprecatedGaussianBlurProp("minPixelIntensity", "minDensity");
  }
  get _pixelIntensityToDensity() {
    return 24 / (a$1u ** 2 * this.blurRadius ** 4);
  }
  _warnAboutDeprecatedGaussianBlurProp(e2, t2) {
    if (this._warnedProps[e2])
      return;
    e$2a(this).getDefaultOrigin() === "user" && (this._warnedProps[e2] = true, v$18(() => {
      t$27(I$o, e2, { replacement: `${String(t2)} (suggested value: ${this._get(t2)})`, version: "4.24" });
    }));
  }
  read(e2, t2) {
    e2 = S$q(e2), super.read(e2, t2);
  }
  getSymbol() {
    return new y$1f();
  }
  async getSymbolAsync() {
    return this.getSymbol();
  }
  getSymbols() {
    return [this.getSymbol()];
  }
  async collectRequiredFields(e2, t2) {
    const i2 = this.field, s2 = this.valueExpression;
    i2 && typeof i2 == "string" && await w$X(e2, t2, i2), s2 && typeof s2 == "string" && await S$Q(e2, t2, s2);
  }
  getAttributeHash() {
    return null;
  }
  getMeshHash() {
    return `${JSON.stringify(this.colorStops)}.${this.blurRadius}.${this.field}`;
  }
  clone() {
    return new j$q({ authoringInfo: this.authoringInfo && this.authoringInfo.clone(), colorStops: y$1L(this.colorStops), field: this.field, legendOptions: y$1L(this.legendOptions), maxDensity: this.maxDensity, minDensity: this.minDensity, radius: this.radius, referenceScale: this.referenceScale, valueExpression: this.valueExpression, valueExpressionTitle: this.valueExpressionTitle });
  }
};
e$2g([y$1I({ type: j$t, json: { write: true, origins: { "web-scene": { write: false, read: false } } } })], v$C.prototype, "authoringInfo", void 0), e$2g([y$1I({ type: Number, json: { origins: { "portal-item": { write: true }, "web-map": { write: true } } } })], v$C.prototype, "blurRadius", null), e$2g([y$1I({ type: [a$1R], json: { write: true } })], v$C.prototype, "colorStops", void 0), e$2g([y$1I({ type: String, json: { write: true } })], v$C.prototype, "field", void 0), e$2g([y$1I({ type: Number, json: { write: { overridePolicy: (e2, t2, i2) => ({ enabled: i2 == null }) }, origins: { "web-scene": { write: false } } } })], v$C.prototype, "fieldOffset", void 0), e$2g([y$1I({ type: p$1O, json: { write: true } })], v$C.prototype, "legendOptions", void 0), e$2g([y$1I({ type: Number, json: { write: true } })], v$C.prototype, "maxDensity", void 0), e$2g([y$1I({ type: Number, json: { origins: { "portal-item": { write: true }, "web-map": { write: true } } } })], v$C.prototype, "maxPixelIntensity", null), e$2g([y$1I({ type: Number, json: { write: true } })], v$C.prototype, "minDensity", void 0), e$2g([y$1I({ type: Number, json: { origins: { "portal-item": { write: true }, "web-map": { write: true } } } })], v$C.prototype, "minPixelIntensity", null), e$2g([y$1I({ type: Number, cast: o$1N, json: { write: true } })], v$C.prototype, "radius", void 0), e$2g([y$1I({ type: Number, range: { min: 0 }, json: { default: 0, write: true } })], v$C.prototype, "referenceScale", void 0), e$2g([r$1H({ heatmap: "heatmap" })], v$C.prototype, "type", void 0), e$2g([y$1I({ type: String, json: { write: true, origins: { "web-document": { write: false }, "portal-item": { write: false } } } })], v$C.prototype, "valueExpression", void 0), e$2g([y$1I({ type: String })], v$C.prototype, "valueExpressionTitle", void 0), e$2g([y$1I({ readOnly: true })], v$C.prototype, "_pixelIntensityToDensity", null), v$C = j$q = e$2g([n$2P(D$g)], v$C);
const P$m = v$C;
let i$1F = class extends i$2R(l$2B) {
  constructor() {
    super(...arguments), this.color = new l$2e([0, 0, 0, 0]), this.label = null, this.threshold = 0;
  }
};
e$2g([y$1I({ type: l$2e, json: { write: true } })], i$1F.prototype, "color", void 0), e$2g([y$1I({ type: String, json: { write: true } })], i$1F.prototype, "label", void 0), e$2g([y$1I({ type: Number, range: { min: 0, max: 1 }, json: { write: true } })], i$1F.prototype, "threshold", void 0), i$1F = e$2g([n$2P("esri.renderers.support.OthersCategory")], i$1F);
let p$1N = class extends i$2R(l$2B) {
  constructor() {
    super(...arguments), this.title = null;
  }
};
e$2g([y$1I({ type: String, json: { write: true } })], p$1N.prototype, "title", void 0), p$1N = e$2g([n$2P("esri.renderers.support.PieChartLegendOptions")], p$1N);
let f$Z = class extends y$K(i$2R(p$1_)) {
  constructor(t2) {
    super(t2), this.attributes = null, this.backgroundFillSymbol = null, this.defaultColor = new l$2e([0, 0, 0, 0]), this.defaultLabel = null, this.holePercentage = 0, this.othersCategory = new i$1F(), this.legendOptions = null, this.outline = null, this.size = 12, this.type = "pie-chart";
  }
  getSymbol() {
    var _a2;
    return new y$1f({ size: this.size ? this.size / 2 + (((_a2 = this.outline) == null ? void 0 : _a2.width) || 0) : 0 });
  }
  async getSymbolAsync() {
    return this.getSymbol();
  }
  getSymbols() {
    return [this.getSymbol(), this.backgroundFillSymbol].filter(r$1$);
  }
  getAttributeHash() {
    return this.visualVariables && this.visualVariables.reduce((t2, e2) => t2 + e2.getAttributeHash(), "");
  }
  getMeshHash() {
    return this.getSymbols().reduce((t2, e2) => t2 + JSON.stringify(e2), "");
  }
  async collectRequiredFields(t2, e2) {
    await this.collectVVRequiredFields(t2, e2);
    for (const o2 of this.attributes)
      o2.valueExpression && await S$Q(t2, e2, o2.valueExpression), o2.field && t2.add(o2.field);
  }
};
e$2g([y$1I({ type: [a$1w], json: { write: true } })], f$Z.prototype, "attributes", void 0), e$2g([y$1I({ type: S$H, json: { default: null, write: true } })], f$Z.prototype, "backgroundFillSymbol", void 0), e$2g([y$1I({ type: l$2e, json: { write: true } })], f$Z.prototype, "defaultColor", void 0), e$2g([y$1I({ type: String, json: { write: true } })], f$Z.prototype, "defaultLabel", void 0), e$2g([y$1I({ type: Number, range: { min: 0, max: 1 }, json: { write: true } })], f$Z.prototype, "holePercentage", void 0), e$2g([y$1I({ type: i$1F, json: { write: true } })], f$Z.prototype, "othersCategory", void 0), e$2g([y$1I({ type: p$1N, json: { write: true } })], f$Z.prototype, "legendOptions", void 0), e$2g([y$1I({ type: m$25, json: { default: null, write: true } })], f$Z.prototype, "outline", void 0), e$2g([y$1I({ type: Number, cast: o$1N, json: { write: true } })], f$Z.prototype, "size", void 0), e$2g([r$1H({ pieChart: "pie-chart" })], f$Z.prototype, "type", void 0), f$Z = e$2g([n$2P("esri.renderers.PieChartRenderer")], f$Z);
const j$p = f$Z;
var c$1y;
let n$1u = c$1y = class extends y$K(p$1_) {
  constructor(e2) {
    super(e2), this.description = null, this.label = null, this.symbol = null, this.type = "simple";
  }
  async collectRequiredFields(e2, s2) {
    await Promise.all([this.collectSymbolFields(e2, s2), this.collectVVRequiredFields(e2, s2)]);
  }
  async collectSymbolFields(e2, s2) {
    await Promise.all(this.getSymbols().map((r2) => r2.collectRequiredFields(e2, s2)));
  }
  getSymbol(e2, s2) {
    return this.symbol;
  }
  async getSymbolAsync(e2, s2) {
    return this.symbol;
  }
  getSymbols() {
    return this.symbol ? [this.symbol] : [];
  }
  getAttributeHash() {
    return this.visualVariables && this.visualVariables.reduce((e2, s2) => e2 + s2.getAttributeHash(), "");
  }
  getMeshHash() {
    return this.getSymbols().reduce((e2, s2) => e2 + JSON.stringify(s2), "");
  }
  get arcadeRequired() {
    return this.arcadeRequiredForVisualVariables;
  }
  clone() {
    return new c$1y({ description: this.description, label: this.label, symbol: this.symbol && this.symbol.clone(), visualVariables: y$1L(this.visualVariables), authoringInfo: this.authoringInfo && this.authoringInfo.clone() });
  }
};
e$2g([y$1I({ type: String, json: { write: true } })], n$1u.prototype, "description", void 0), e$2g([y$1I({ type: String, json: { write: true } })], n$1u.prototype, "label", void 0), e$2g([y$1I(l$1q)], n$1u.prototype, "symbol", void 0), e$2g([r$1H({ simple: "simple" })], n$1u.prototype, "type", void 0), n$1u = c$1y = e$2g([n$2P("esri.renderers.SimpleRenderer")], n$1u);
const p$1M = n$1u;
const f$Y = ["esri.Color", "esri.portal.Portal", "esri.symbols.support.Symbol3DAnchorPosition2D", "esri.symbols.support.Symbol3DAnchorPosition3D"];
function i$1E(t2) {
  return t2 instanceof m$2q;
}
function c$1x(e2) {
  return e2 instanceof j$V ? Object.keys(e2.items) : i$1E(e2) ? e$2a(e2).keys() : e2 ? Object.keys(e2) : [];
}
function l$1m(e2, n2) {
  return e2 instanceof j$V ? e2.items[n2] : e2[n2];
}
function u$11(e2, t2) {
  return !(!Array.isArray(e2) || !Array.isArray(t2)) && e2.length !== t2.length;
}
function s$1f(e2) {
  return e2 ? e2.declaredClass : null;
}
function p$1L(e2, t2) {
  const n2 = e2.diff;
  if (n2 && typeof n2 == "function")
    return n2(e2, t2);
  const r2 = c$1x(e2), a2 = c$1x(t2);
  if (r2.length === 0 && a2.length === 0)
    return;
  if (!r2.length || !a2.length || u$11(e2, t2))
    return { type: "complete", oldValue: e2, newValue: t2 };
  const y2 = a2.filter((e3) => !r2.includes(e3)), m2 = r2.filter((e3) => !a2.includes(e3)), d2 = r2.filter((n3) => a2.includes(n3) && l$1m(e2, n3) !== l$1m(t2, n3)).concat(y2, m2).sort(), b2 = s$1f(e2);
  if (b2 && f$Y.includes(b2) && d2.length)
    return { type: "complete", oldValue: e2, newValue: t2 };
  let h2;
  const g2 = i$1E(e2) && i$1E(t2);
  for (const f2 of d2) {
    const r3 = l$1m(e2, f2), i2 = l$1m(t2, f2);
    let c2;
    if ((g2 || typeof r3 != "function" && typeof i2 != "function") && (r3 !== i2 && (r3 != null || i2 != null))) {
      if (n2 && n2[f2] && typeof n2[f2] == "function")
        c2 = n2[f2](r3, i2);
      else if (r3 instanceof Date && i2 instanceof Date) {
        if (r3.getTime() === i2.getTime())
          continue;
        c2 = { type: "complete", oldValue: r3, newValue: i2 };
      } else
        c2 = typeof r3 == "object" && typeof i2 == "object" && s$1f(r3) === s$1f(i2) ? p$1L(r3, i2) : { type: "complete", oldValue: r3, newValue: i2 };
      r$1$(c2) && (r$1$(h2) ? h2.diff[f2] = c2 : h2 = { type: "partial", diff: { [f2]: c2 } });
    }
  }
  return h2;
}
function a$1t(e2, t2) {
  if (t$2r(e2))
    return false;
  const o2 = t2.split(".");
  let r2 = e2;
  for (const n2 of o2) {
    if (r2.type === "complete")
      return true;
    if (r2.type !== "partial")
      return false;
    {
      const e3 = r2.diff[n2];
      if (!e3)
        return false;
      r2 = e3;
    }
  }
  return true;
}
function y$F(e2, t2) {
  for (const n2 of t2)
    if (a$1t(e2, n2))
      return true;
  return false;
}
function m$1f(e2, t2) {
  if (!(typeof e2 == "function" || typeof t2 == "function" || t$2r(e2) && t$2r(t2)))
    return t$2r(e2) || t$2r(t2) || typeof e2 == "object" && typeof t2 == "object" && s$1f(e2) !== s$1f(t2) ? { type: "complete", oldValue: e2, newValue: t2 } : p$1L(e2, t2);
}
function d$R(e2) {
  if (t$2r(e2))
    return true;
  switch (e2.type) {
    case "complete":
      return false;
    case "collection": {
      const t2 = e2;
      for (const e3 of t2.added)
        if (!d$R(e3))
          return false;
      for (const e3 of t2.removed)
        if (!d$R(e3))
          return false;
      for (const e3 of t2.changed)
        if (!d$R(e3))
          return false;
      return true;
    }
    case "partial":
      for (const t2 in e2.diff) {
        if (!d$R(e2.diff[t2]))
          return false;
      }
      return true;
  }
}
let u$10 = class extends i$2R(l$2B) {
  constructor(o2) {
    super(o2), this.value = null, this.value2 = null, this.value3 = null;
  }
};
e$2g([y$1I(m$1i)], u$10.prototype, "value", void 0), e$2g([y$1I(m$1i)], u$10.prototype, "value2", void 0), e$2g([y$1I(m$1i)], u$10.prototype, "value3", void 0), u$10 = e$2g([n$2P("esri.renderers.support.UniqueValue")], u$10);
const c$1w = u$10;
let n$1t = class extends i$2R(l$2B) {
  constructor(r2) {
    super(r2), this.description = null, this.label = null, this.symbol = null, this.values = null;
  }
  castValues(r2) {
    if (r2 == null)
      return null;
    const o2 = typeof (r2 = Array.isArray(r2) ? r2 : [r2])[0];
    return o2 === "string" || o2 === "number" ? r2.map((r3) => new c$1w({ value: r3 })) : o2 === "object" ? r2[0] instanceof c$1w ? r2 : r2.map((r3) => new c$1w(r3)) : null;
  }
};
e$2g([y$1I({ type: String, json: { write: true } })], n$1t.prototype, "description", void 0), e$2g([y$1I({ type: String, json: { write: true } })], n$1t.prototype, "label", void 0), e$2g([y$1I(l$1q)], n$1t.prototype, "symbol", void 0), e$2g([y$1I({ type: [c$1w], json: { type: [[String]], read: { reader: (r2) => r2 ? r2.map((r3) => new c$1w({ value: r3[0], value2: r3[1], value3: r3[2] })) : null }, write: { writer: (r2, o2) => {
  const e2 = [];
  for (const s2 of r2) {
    const r3 = [s2.value, s2.value2, s2.value3].filter(r$1$).map((r4) => r4.toString());
    e2.push(r3);
  }
  o2.values = e2;
} } } })], n$1t.prototype, "values", void 0), e$2g([s$2i("values")], n$1t.prototype, "castValues", null), n$1t = e$2g([n$2P("esri.renderers.support.UniqueValueClass")], n$1t);
const u$$ = n$1t;
let c$1v = class extends i$2R(l$2B) {
  constructor(r2) {
    super(r2), this.heading = null, this.classes = null;
  }
};
e$2g([y$1I({ type: String, json: { write: true } })], c$1v.prototype, "heading", void 0), e$2g([y$1I({ type: [u$$], json: { write: true } })], c$1v.prototype, "classes", void 0), c$1v = e$2g([n$2P("esri.renderers.support.UniqueValueGroup")], c$1v);
const i$1D = c$1v;
var l$1l;
let p$1K = l$1l = class extends l$2B {
  constructor(o2) {
    super(o2), this.description = null, this.label = null, this.symbol = null, this.value = null;
  }
  clone() {
    return new l$1l({ value: this.value, description: this.description, label: this.label, symbol: this.symbol ? this.symbol.clone() : null });
  }
  getMeshHash() {
    const o2 = JSON.stringify(this.symbol && this.symbol.toJSON());
    return `${this.value}.${o2}`;
  }
};
e$2g([y$1I({ type: String, json: { write: true } })], p$1K.prototype, "description", void 0), e$2g([y$1I({ type: String, json: { write: true } })], p$1K.prototype, "label", void 0), e$2g([y$1I(l$1q)], p$1K.prototype, "symbol", void 0), e$2g([y$1I(m$1i)], p$1K.prototype, "value", void 0), p$1K = l$1l = e$2g([n$2P("esri.renderers.support.UniqueValueInfo")], p$1K);
const n$1s = p$1K;
const e$V = () => !!has("enable-feature:force-wosr"), t$16 = () => !!has("enable-feature:SceneLayer-editing");
const u$_ = {};
async function f$X(e2, r2) {
  try {
    return { data: (await b$z(e2, r2)).data, baseUrl: Ot(e2), styleUrl: e2 };
  } catch (t2) {
    return w$12(t2), null;
  }
}
function i$1C(e2, r2, o2) {
  const s2 = r$1$(r2.portal) ? r2.portal : j$M.getDefault();
  let n2;
  const a2 = `${s2.url} - ${s2.user && s2.user.username} - ${e2}`;
  return u$_[a2] || (u$_[a2] = y$E(e2, s2, o2).then((e3) => (n2 = e3, e3.fetchData())).then((r3) => {
    var _a2;
    return { data: r3, baseUrl: (_a2 = n2.itemUrl) != null ? _a2 : "", styleName: e2 };
  })), u$_[a2];
}
function y$E(e2, t2, o2) {
  return t2.load(o2).then(() => {
    const r2 = new d$1v({ disableExtraQuery: true, query: `owner:${j$o} AND type:${h$R} AND typekeywords:"${e2}"` });
    return t2.queryItems(r2, o2);
  }).then(({ results: t3 }) => {
    var _a2;
    let s2 = null;
    const n2 = e2.toLowerCase();
    if (t3 && Array.isArray(t3))
      for (const e3 of t3) {
        const r2 = (_a2 = e3.typeKeywords) == null ? void 0 : _a2.some((e4) => e4.toLowerCase() === n2);
        if (r2 && e3.type === h$R && e3.owner === j$o) {
          s2 = e3;
          break;
        }
      }
    if (!s2)
      throw new s$2u("symbolstyleutils:style-not-found", `The style '${e2}' could not be found`, { styleName: e2 });
    return s2.load(o2);
  });
}
function c$1u(e2, o2, s2) {
  return e2 && r$1$(e2.styleUrl) ? f$X(e2.styleUrl, s2) : e2 && r$1$(e2.styleName) ? i$1C(e2.styleName, o2, s2) : Promise.reject(new s$2u("symbolstyleutils:style-url-and-name-missing", "Either styleUrl or styleName is required to resolve a style"));
}
function p$1J(e2) {
  return e2 === null || e2.type === "CIMSymbolReference" ? e2 : { type: "CIMSymbolReference", symbol: e2 };
}
function d$Q(e2, r2) {
  if (r2 === "cimRef")
    return e2.cimRef;
  if (e2.formatInfos && !e$V()) {
    for (const t2 of e2.formatInfos)
      if (t2.type === "gltf")
        return t2.href;
  }
  return e2.webRef;
}
function b$z(r2, t2) {
  const o2 = __spreadValues({ responseType: "json", query: { f: "json" } }, t2);
  return U$t(F$v(r2), o2);
}
const j$o = "esri_en", h$R = "Style", w$v = "https://cdn.arcgis.com/sharing/rest/content/items/220936cc6ed342c9937abd8f180e7d1e/resources/styles/cim/{SymbolName}.json?f=json";
var R$j;
const P$l = "esri.renderers.UniqueValueRenderer", $$7 = s$2z.getLogger(P$l), z$p = "uvInfos-watcher", k$i = "uvGroups-watcher", A$g = ",", H$c = b$1a(n$1s);
function L$j(e2) {
  const { field1: t2, field2: s2, field3: i2, fieldDelimiter: o2, uniqueValueInfos: l2, valueExpression: r2 } = e2, u2 = !(!t2 || !s2);
  return [{ classes: (l2 != null ? l2 : []).map((e3) => {
    var _a2;
    const { symbol: l3, label: n2, value: a2, description: p2 } = e3, [f2, d2, c2] = u2 ? ((_a2 = a2 == null ? void 0 : a2.toString()) == null ? void 0 : _a2.split(o2 || "")) || [] : [a2], h2 = [];
    return (t2 || r2) && h2.push(f2), s2 && h2.push(d2), i2 && h2.push(c2), { symbol: l3, label: n2, values: [h2], description: p2 };
  }) }];
}
let T$i = R$j = class extends y$K(p$1_) {
  constructor(e2) {
    super(e2), this._valueInfoMap = {}, this._isDefaultSymbolDerived = false, this._isInfosSource = null, this.type = "unique-value", this.backgroundFillSymbol = null, this.valueExpressionTitle = null, this.legendOptions = null, this.defaultLabel = null, this.portal = null, this.styleOrigin = null, this.diff = { uniqueValueInfos(e3, t2) {
      if (!e3 && !t2)
        return;
      if (!e3 || !t2)
        return { type: "complete", oldValue: e3, newValue: t2 };
      let s2 = false;
      const i2 = { type: "collection", added: [], removed: [], changed: [], unchanged: [] };
      for (let o2 = 0; o2 < t2.length; o2++) {
        const l2 = e3.find((e4) => e4.value === t2[o2].value);
        l2 ? m$1f(l2, t2[o2]) ? (i2.changed.push({ type: "complete", oldValue: l2, newValue: t2[o2] }), s2 = true) : i2.unchanged.push({ oldValue: l2, newValue: t2[o2] }) : (i2.added.push(t2[o2]), s2 = true);
      }
      for (let o2 = 0; o2 < e3.length; o2++) {
        t2.find((t3) => t3.value === e3[o2].value) || (i2.removed.push(e3[o2]), s2 = true);
      }
      return s2 ? i2 : void 0;
    } }, this._set("uniqueValueInfos", []), this._set("uniqueValueGroups", []);
  }
  get _cache() {
    return { compiledFunc: null };
  }
  set field(e2) {
    this._set("field", e2), this._updateFieldDelimiter(), this._updateUniqueValues();
  }
  castField(e2) {
    return e2 == null || typeof e2 == "function" ? e2 : u$2l(e2);
  }
  writeField(e2, t2, i2, o2) {
    typeof e2 == "string" ? t2[i2] = e2 : o2 && o2.messages ? o2.messages.push(new s$2u("property:unsupported", "UniqueValueRenderer.field set to a function cannot be written to JSON")) : $$7.error(".field: cannot write field to JSON since it's not a string value");
  }
  set field2(e2) {
    this._set("field2", e2), this._updateFieldDelimiter(), this._updateUniqueValues();
  }
  set field3(e2) {
    this._set("field3", e2), this._updateUniqueValues();
  }
  set valueExpression(e2) {
    this._set("valueExpression", e2), this._updateUniqueValues();
  }
  set defaultSymbol(e2) {
    this._isDefaultSymbolDerived = false, this._set("defaultSymbol", e2);
  }
  set fieldDelimiter(e2) {
    this._set("fieldDelimiter", e2), this._updateUniqueValues();
  }
  readPortal(e2, t2, s2) {
    return s2.portal || j$M.getDefault();
  }
  readStyleOrigin(e2, t2, s2) {
    if (t2.styleName)
      return Object.freeze({ styleName: t2.styleName });
    if (t2.styleUrl) {
      const e3 = c$2x(t2.styleUrl, s2);
      return Object.freeze({ styleUrl: e3 });
    }
  }
  writeStyleOrigin(e2, t2, s2, i2) {
    e2.styleName ? t2.styleName = e2.styleName : e2.styleUrl && (t2.styleUrl = m$1_(e2.styleUrl, i2));
  }
  set uniqueValueGroups(e2) {
    this.styleOrigin ? $$7.error("#uniqueValueGroups=", "Cannot modify unique value groups of a UniqueValueRenderer created from a web style") : (this._set("uniqueValueGroups", e2), this._updateInfosFromGroups(), this._isInfosSource = false, this._watchUniqueValueGroups());
  }
  set uniqueValueInfos(e2) {
    this.styleOrigin ? $$7.error("#uniqueValueInfos=", "Cannot modify unique value infos of a UniqueValueRenderer created from a web style") : (this._set("uniqueValueInfos", e2), this._updateValueInfoMap(), this._updateGroupsFromInfos(), this._isInfosSource = true, this._watchUniqueValueInfos());
  }
  addUniqueValueInfo(e2, s2) {
    var _a2;
    if (this.styleOrigin)
      return void $$7.error("#addUniqueValueInfo()", "Cannot modify unique value infos of a UniqueValueRenderer created from a web style");
    let i2;
    i2 = typeof e2 == "object" ? H$c(e2) : new n$1s({ value: e2, symbol: g$11(s2) }), (_a2 = this.uniqueValueInfos) == null ? void 0 : _a2.push(i2), this._valueInfoMap[i2.value] = i2, this._updateGroupsFromInfos(), this._isInfosSource = true, this._watchUniqueValueInfos();
  }
  removeUniqueValueInfo(e2) {
    if (this.styleOrigin)
      return void $$7.error("#removeUniqueValueInfo()", "Cannot modify unique value infos of a UniqueValueRenderer created from a web style");
    const t2 = this.uniqueValueInfos;
    if (t2)
      for (let s2 = 0; s2 < t2.length; s2++) {
        if (t2[s2].value === e2 + "") {
          delete this._valueInfoMap[e2], t2.splice(s2, 1);
          break;
        }
      }
    this._updateGroupsFromInfos(), this._isInfosSource = true, this._watchUniqueValueInfos();
  }
  async getUniqueValueInfo(e2, t2) {
    let s2 = t2;
    return this.valueExpression && (t$2r(t2) || t$2r(t2.arcade)) && (s2 = __spreadProps(__spreadValues({}, s2), { arcade: await i$2P() })), this._getUniqueValueInfo(e2, s2);
  }
  getSymbol(e2, t2) {
    if (this.valueExpression && (t$2r(t2) || t$2r(t2.arcade)))
      return void $$7.error("#getSymbol()", "Please use getSymbolAsync if valueExpression is used");
    const s2 = this._getUniqueValueInfo(e2, t2);
    return s2 && s2.symbol || this.defaultSymbol;
  }
  async getSymbolAsync(e2, t2) {
    let s2 = t2;
    if (this.valueExpression && (t$2r(s2) || t$2r(s2.arcade))) {
      const e3 = await i$2P(), { arcadeUtils: t3 } = e3;
      t3.hasGeometryOperations(this.valueExpression) && await t3.enableGeometryOperations(), s2 = __spreadProps(__spreadValues({}, s2), { arcade: e3 });
    }
    const i2 = this._getUniqueValueInfo(e2, s2);
    return i2 && i2.symbol || this.defaultSymbol;
  }
  getSymbols() {
    var _a2;
    const e2 = [];
    for (const t2 of (_a2 = this.uniqueValueInfos) != null ? _a2 : [])
      t2.symbol && e2.push(t2.symbol);
    return this.defaultSymbol && e2.push(this.defaultSymbol), e2;
  }
  getAttributeHash() {
    return this.visualVariables && this.visualVariables.reduce((e2, t2) => e2 + t2.getAttributeHash(), "");
  }
  getMeshHash() {
    var _a2;
    const e2 = JSON.stringify(this.backgroundFillSymbol), t2 = JSON.stringify(this.defaultSymbol), s2 = (_a2 = this.uniqueValueInfos) == null ? void 0 : _a2.reduce((e3, t3) => e3 + t3.getMeshHash(), "");
    return `${e2}.${t2}.${s2}.${`${this.field}.${this.field2}.${this.field3}.${this.fieldDelimiter}`}.${this.valueExpression}`;
  }
  clone() {
    const e2 = new R$j({ field: this.field, field2: this.field2, field3: this.field3, defaultLabel: this.defaultLabel, defaultSymbol: y$1L(this.defaultSymbol), valueExpression: this.valueExpression, valueExpressionTitle: this.valueExpressionTitle, fieldDelimiter: this.fieldDelimiter, visualVariables: y$1L(this.visualVariables), legendOptions: y$1L(this.legendOptions), authoringInfo: this.authoringInfo && this.authoringInfo.clone(), backgroundFillSymbol: y$1L(this.backgroundFillSymbol) });
    this._isDefaultSymbolDerived && (e2._isDefaultSymbolDerived = true), e2._set("portal", this.portal);
    const t2 = y$1L(this.uniqueValueInfos), s2 = y$1L(this.uniqueValueGroups);
    return this.styleOrigin && (e2._set("styleOrigin", Object.freeze(y$1L(this.styleOrigin))), Object.freeze(t2), Object.freeze(s2)), e2._set("uniqueValueInfos", t2), e2._updateValueInfoMap(), e2._set("uniqueValueGroups", s2), e2._isInfosSource = this._isInfosSource, e2._watchUniqueValueInfosAndGroups(), e2;
  }
  get arcadeRequired() {
    return this.arcadeRequiredForVisualVariables || !!this.valueExpression;
  }
  async collectRequiredFields(e2, t2) {
    const s2 = [this.collectVVRequiredFields(e2, t2), this.collectSymbolFields(e2, t2)];
    await Promise.all(s2);
  }
  async collectSymbolFields(e2, t2) {
    const s2 = [...this.getSymbols().map((s3) => s3.collectRequiredFields(e2, t2)), S$Q(e2, t2, this.valueExpression)];
    w$X(e2, t2, this.field), w$X(e2, t2, this.field2), w$X(e2, t2, this.field3), await Promise.all(s2);
  }
  populateFromStyle() {
    return c$1u(this.styleOrigin, { portal: this.portal }).then((e2) => {
      var _a2;
      const t2 = [];
      return this._valueInfoMap = {}, e2 && e2.data && Array.isArray(e2.data.items) && e2.data.items.forEach((s2) => {
        const i2 = new f$1p({ styleUrl: e2.styleUrl, styleName: e2.styleName, portal: this.portal, name: s2.name });
        this.defaultSymbol || s2.name !== e2.data.defaultItem || (this.defaultSymbol = i2, this._isDefaultSymbolDerived = true);
        const o2 = new n$1s({ value: s2.name, symbol: i2 });
        t2.push(o2), this._valueInfoMap[s2.name] = o2;
      }), this._set("uniqueValueInfos", Object.freeze(t2)), this._updateGroupsFromInfos(true), this._isInfosSource = null, this._watchUniqueValueInfos(), !this.defaultSymbol && ((_a2 = this.uniqueValueInfos) == null ? void 0 : _a2.length) && (this.defaultSymbol = this.uniqueValueInfos[0].symbol, this._isDefaultSymbolDerived = true), this;
    });
  }
  _updateFieldDelimiter() {
    this.field && this.field2 && !this.fieldDelimiter && this._set("fieldDelimiter", A$g);
  }
  _updateUniqueValues() {
    this._isInfosSource != null && (this._isInfosSource ? this._updateGroupsFromInfos() : this._updateInfosFromGroups());
  }
  _updateValueInfoMap() {
    this._valueInfoMap = {};
    const { uniqueValueInfos: e2 } = this;
    if (e2)
      for (const t2 of e2)
        this._valueInfoMap[t2.value + ""] = t2;
  }
  _watchUniqueValueInfosAndGroups() {
    this._watchUniqueValueInfos(), this._watchUniqueValueGroups();
  }
  _watchUniqueValueInfos() {
    this.removeHandles(z$p);
    const { uniqueValueInfos: e2 } = this;
    if (e2) {
      const t2 = [];
      for (const s2 of e2)
        t2.push(l$1P(() => ({ symbol: s2.symbol, value: s2.value, label: s2.label, description: s2.description }), (e3, t3) => {
          e3 !== t3 && (this._updateGroupsFromInfos(), this._isInfosSource = true);
        }, { sync: true }));
      this.addHandles(t2, z$p);
    }
  }
  _watchUniqueValueGroups() {
    this.removeHandles(k$i);
    const { uniqueValueGroups: e2 } = this;
    if (e2) {
      const t2 = [];
      for (const s2 of e2) {
        t2.push(l$1P(() => ({ classes: s2.classes }), (e3, t3) => {
          e3 !== t3 && (this._updateInfosFromGroups(), this._isInfosSource = false);
        }, { sync: true }));
        for (const e3 of s2.classes)
          t2.push(l$1P(() => ({ symbol: e3.symbol, values: e3.values, label: e3.label, description: e3.description }), (e4, t3) => {
            e4 !== t3 && (this._updateInfosFromGroups(), this._isInfosSource = false);
          }, { sync: true }));
      }
      this.addHandles(t2, k$i);
    }
  }
  _updateInfosFromGroups() {
    var _a2;
    if (!this.uniqueValueGroups)
      return this._set("uniqueValueInfos", null), this._updateValueInfoMap(), void this._watchUniqueValueInfos();
    const e2 = [], { field: t2, field2: s2, field3: i2, fieldDelimiter: o2, uniqueValueGroups: l2, valueExpression: r2 } = this;
    if (!t2 && !r2)
      return this._set("uniqueValueInfos", e2), this._updateValueInfoMap(), void this._watchUniqueValueInfos();
    const u2 = !(!t2 || !s2);
    for (const n2 of l2)
      for (const t3 of (_a2 = n2.classes) != null ? _a2 : []) {
        const { symbol: l3, label: r3, values: n3, description: a2 } = t3;
        for (const t4 of n3 != null ? n3 : []) {
          const { value: n4, value2: p2, value3: f2 } = t4, d2 = [n4];
          s2 && d2.push(p2), i2 && d2.push(f2);
          const c2 = u2 ? d2.join(o2 || "") : d2[0];
          e2.push(new n$1s({ symbol: l3, label: r3, value: c2, description: a2 }));
        }
      }
    this._set("uniqueValueInfos", e2), this._updateValueInfoMap(), this._watchUniqueValueInfos();
  }
  _updateGroupsFromInfos(e2 = false) {
    if (!this.uniqueValueInfos)
      return this._set("uniqueValueGroups", null), void this._watchUniqueValueGroups();
    const { field: t2, field2: s2, valueExpression: i2, fieldDelimiter: o2, uniqueValueInfos: l2 } = this;
    if (!t2 && !i2 || !l2.length)
      return this._set("uniqueValueGroups", []), void this._watchUniqueValueGroups();
    const r2 = !(!t2 || !s2), u2 = l2.map((e3) => {
      var _a2;
      const { symbol: t3, label: s3, value: i3, description: l3 } = e3, [u3, n3, a2] = r2 ? ((_a2 = i3 == null ? void 0 : i3.toString()) == null ? void 0 : _a2.split(o2 || "")) || [] : [i3];
      return new u$$({ symbol: t3, label: s3, description: l3, values: [new c$1w({ value: u3, value2: n3, value3: a2 })] });
    }), n2 = [new i$1D({ classes: u2 })];
    e2 && Object.freeze(n2), this._set("uniqueValueGroups", n2), this._watchUniqueValueGroups();
  }
  _getUniqueValueInfo(e2, t2) {
    return this.valueExpression ? this._getUnqiueValueInfoForExpression(e2, t2) : this._getUnqiueValueInfoForFields(e2);
  }
  _getUnqiueValueInfoForExpression(e2, t2) {
    const { viewingMode: s2, scale: i2, spatialReference: o2, arcade: l2 } = i$3f(t2, {});
    let n2 = this._cache.compiledFunc;
    const a2 = e$2e(l2).arcadeUtils;
    if (!n2) {
      const e3 = a2.createSyntaxTree(this.valueExpression);
      n2 = a2.createFunction(e3), this._cache.compiledFunc = n2;
    }
    const p2 = a2.executeFunction(n2, a2.createExecContext(e2, a2.getViewInfo({ viewingMode: s2, scale: i2, spatialReference: o2 })));
    return this._valueInfoMap[p2 + ""];
  }
  _getUnqiueValueInfoForFields(e2) {
    const t2 = this.field, s2 = e2.attributes;
    let i2;
    if (typeof t2 != "function" && this.field2) {
      const e3 = this.field2, o2 = this.field3, l2 = [];
      t2 && l2.push(s2[t2]), e3 && l2.push(s2[e3]), o2 && l2.push(s2[o2]), i2 = l2.join(this.fieldDelimiter || "");
    } else
      typeof t2 == "function" ? i2 = t2(e2) : t2 && (i2 = s2[t2]);
    return this._valueInfoMap[i2 + ""];
  }
  static fromPortalStyle(e2, t2) {
    const s2 = new R$j(t2 && t2.properties);
    s2._set("styleOrigin", Object.freeze({ styleName: e2 })), s2._set("portal", t2 && t2.portal || j$M.getDefault());
    const i2 = s2.populateFromStyle();
    return i2.catch((t3) => {
      $$7.error(`#fromPortalStyle('${e2}'[, ...])`, "Failed to create unique value renderer from style name", t3);
    }), i2;
  }
  static fromStyleUrl(e2, t2) {
    const s2 = new R$j(t2 && t2.properties);
    s2._set("styleOrigin", Object.freeze({ styleUrl: e2 }));
    const i2 = s2.populateFromStyle();
    return i2.catch((t3) => {
      $$7.error(`#fromStyleUrl('${e2}'[, ...])`, "Failed to create unique value renderer from style URL", t3);
    }), i2;
  }
};
e$2g([y$1I({ readOnly: true })], T$i.prototype, "_cache", null), e$2g([r$1H({ uniqueValue: "unique-value" })], T$i.prototype, "type", void 0), e$2g([y$1I(y$J)], T$i.prototype, "backgroundFillSymbol", void 0), e$2g([y$1I({ value: null, json: { type: String, read: { source: "field1" }, write: { target: "field1" } } })], T$i.prototype, "field", null), e$2g([s$2i("field")], T$i.prototype, "castField", null), e$2g([r$1P("field")], T$i.prototype, "writeField", null), e$2g([y$1I({ type: String, value: null, json: { write: true } })], T$i.prototype, "field2", null), e$2g([y$1I({ type: String, value: null, json: { write: true } })], T$i.prototype, "field3", null), e$2g([y$1I({ type: String, value: null, json: { write: true } })], T$i.prototype, "valueExpression", null), e$2g([y$1I({ type: String, json: { write: true } })], T$i.prototype, "valueExpressionTitle", void 0), e$2g([y$1I({ type: p$1Z, json: { write: true } })], T$i.prototype, "legendOptions", void 0), e$2g([y$1I({ type: String, json: { write: true } })], T$i.prototype, "defaultLabel", void 0), e$2g([y$1I(n$2X(__spreadValues({}, l$1q), { json: { write: { overridePolicy() {
  return { enabled: !this._isDefaultSymbolDerived };
} }, origins: { "web-scene": { write: { overridePolicy() {
  return { enabled: !this._isDefaultSymbolDerived };
} } } } } }))], T$i.prototype, "defaultSymbol", null), e$2g([y$1I({ type: String, value: null, json: { write: true } })], T$i.prototype, "fieldDelimiter", null), e$2g([y$1I({ type: j$M, readOnly: true })], T$i.prototype, "portal", void 0), e$2g([o$29("portal", ["styleName"])], T$i.prototype, "readPortal", null), e$2g([y$1I({ readOnly: true, json: { write: { enabled: false, overridePolicy: () => ({ enabled: true }) } } })], T$i.prototype, "styleOrigin", void 0), e$2g([o$29("styleOrigin", ["styleName", "styleUrl"])], T$i.prototype, "readStyleOrigin", null), e$2g([r$1P("styleOrigin", { styleName: { type: String }, styleUrl: { type: String } })], T$i.prototype, "writeStyleOrigin", null), e$2g([y$1I({ type: [i$1D], json: { read: { source: ["uniqueValueGroups", "uniqueValueInfos"], reader: (e2, t2, s2) => (t2.uniqueValueGroups || L$j(t2)).map((e3) => i$1D.fromJSON(e3, s2)) }, write: { overridePolicy() {
  return this.styleOrigin ? { enabled: false } : { enabled: true };
} } } })], T$i.prototype, "uniqueValueGroups", null), e$2g([y$1I({ type: [n$1s], json: { read: false, write: { overridePolicy() {
  return this.styleOrigin ? { enabled: false } : { enabled: true };
} } } })], T$i.prototype, "uniqueValueInfos", null), T$i = R$j = e$2g([n$2P(P$l)], T$i);
const C$n = T$i;
const p$1I = { key: "type", base: p$1_, typeMap: { heatmap: P$m, simple: p$1M, "unique-value": C$n, "class-breaks": _$t, "dot-density": y$H, dictionary: u$15, "pie-chart": j$p }, errorContext: "renderer" }, n$1r = { key: "type", base: p$1_, typeMap: { simple: p$1M, "unique-value": C$n, "class-breaks": _$t, heatmap: P$m }, errorContext: "renderer" };
function t$15(e2, r2) {
  return o$17(e2, null, r2);
}
const s$1e = s$2r({ types: p$1I });
function o$17(r2, n2, t2) {
  return r2 ? r2 && (r2.styleName || r2.styleUrl) && r2.type !== "uniqueValue" ? (t2 && t2.messages && t2.messages.push(new t$2j("renderer:unsupported", "Only UniqueValueRenderer can be referenced from a web style, but found '" + r2.type + "'", { definition: r2, context: t2 })), null) : s$1e(r2, n2, t2) : null;
}
class i$1B {
  constructor() {
    this._propertyOriginMap = new Map(), this._originStores = new Array(E$R), this._values = new Map(), this.multipleOriginsSupported = true;
  }
  clone(s2) {
    const o2 = new i$1B(), n2 = this._originStores[r$1U.DEFAULTS];
    n2 && n2.forEach((s3, e2) => {
      o2.set(e2, y$1L(s3), r$1U.DEFAULTS);
    });
    for (let i2 = r$1U.SERVICE; i2 < E$R; i2++) {
      const e2 = this._originStores[i2];
      e2 && e2.forEach((e3, r2) => {
        s2 && s2.has(r2) || o2.set(r2, y$1L(e3), i2);
      });
    }
    return o2;
  }
  get(t2, s2) {
    const e2 = s2 === void 0 ? this._values : this._originStores[s2];
    return e2 ? e2.get(t2) : void 0;
  }
  keys(t2) {
    const s2 = t2 == null ? this._values : this._originStores[t2];
    return s2 ? [...s2.keys()] : [];
  }
  set(t2, e2, i2 = r$1U.USER) {
    let o2 = this._originStores[i2];
    if (o2 || (o2 = new Map(), this._originStores[i2] = o2), o2.set(t2, e2), !this._values.has(t2) || x$16(this._propertyOriginMap.get(t2)) <= i2) {
      const s2 = this._values.get(t2);
      return this._values.set(t2, e2), this._propertyOriginMap.set(t2, i2), s2 !== e2;
    }
    return false;
  }
  delete(t2, s2 = r$1U.USER) {
    const e2 = this._originStores[s2];
    if (!e2)
      return;
    const i2 = e2.get(t2);
    if (e2.delete(t2), this._values.has(t2) && this._propertyOriginMap.get(t2) === s2) {
      this._values.delete(t2);
      for (let e3 = s2 - 1; e3 >= 0; e3--) {
        const s3 = this._originStores[e3];
        if (s3 && s3.has(t2)) {
          this._values.set(t2, s3.get(t2)), this._propertyOriginMap.set(t2, e3);
          break;
        }
      }
    }
    return i2;
  }
  has(t2, s2) {
    const e2 = s2 === void 0 ? this._values : this._originStores[s2];
    return !!e2 && e2.has(t2);
  }
  revert(t2, s2) {
    for (; s2 > 0 && !this.has(t2, s2); )
      --s2;
    const e2 = this._originStores[s2], r2 = e2 && e2.get(t2), i2 = this._values.get(t2);
    return this._values.set(t2, r2), this._propertyOriginMap.set(t2, s2), i2 !== r2;
  }
  originOf(t2) {
    return this._propertyOriginMap.get(t2) || r$1U.DEFAULTS;
  }
  forEach(t2) {
    this._values.forEach(t2);
  }
}
const a$1s = (t2) => {
  let a2 = class extends t2 {
    constructor(...r2) {
      super(...r2);
      const t3 = x$16(e$2a(this)), i2 = t3.store, c2 = new i$1B();
      t3.store = c2, e$1Y(t3, i2, c2);
    }
    read(r2, t3) {
      u$2c(this, r2, t3);
    }
    getAtOrigin(r2, t3) {
      const s2 = m$1e(this), o2 = t$2e(t3);
      if (typeof r2 == "string")
        return s2.get(r2, o2);
      const e2 = {};
      return r2.forEach((r3) => {
        e2[r3] = s2.get(r3, o2);
      }), e2;
    }
    originOf(r2) {
      return n$2N(this.originIdOf(r2));
    }
    originIdOf(r2) {
      return m$1e(this).originOf(r2);
    }
    revert(r2, t3) {
      const s2 = m$1e(this), o2 = t$2e(t3), e2 = e$2a(this);
      let c2;
      c2 = typeof r2 == "string" ? r2 === "*" ? s2.keys(o2) : [r2] : r2, c2.forEach((r3) => {
        e2.invalidate(r3), s2.revert(r3, o2), e2.commit(r3);
      });
    }
  };
  return a2 = e$2g([n$2P("esri.core.ReadOnlyMultiOriginJSONSupport")], a2), a2;
};
function m$1e(r2) {
  return e$2a(r2).store;
}
let f$W = class extends a$1s(m$2q) {
};
f$W = e$2g([n$2P("esri.core.ReadOnlyMultiOriginJSONSupport")], f$W);
const u$Z = (t2) => {
  let s2 = class extends t2 {
    constructor(...r2) {
      super(...r2);
    }
    clear(r2, t3 = "user") {
      return l$1k(this).delete(r2, t$2e(t3));
    }
    write(r2 = {}, t3) {
      return c$3e(this, r2 = r2 || {}, t3), r2;
    }
    setAtOrigin(r2, t3, s3) {
      e$2a(this).setAtOrigin(r2, t3, t$2e(s3));
    }
    removeOrigin(r2) {
      const t3 = l$1k(this), s3 = t$2e(r2), i2 = t3.keys(s3);
      for (const e2 of i2)
        t3.originOf(e2) === s3 && t3.set(e2, t3.get(e2, s3), r$1U.USER);
    }
    updateOrigin(r2, t3) {
      const s3 = l$1k(this), o2 = t$2e(t3), c2 = this.get(r2);
      for (let e2 = o2 + 1; e2 < E$R; ++e2)
        s3.delete(r2, e2);
      s3.set(r2, c2, o2);
    }
    toJSON(r2) {
      return this.write({}, r2);
    }
  };
  return s2 = e$2g([n$2P("esri.core.WriteableMultiOriginJSONSupport")], s2), s2.prototype.toJSON.isDefaultToJSON = true, s2;
};
function l$1k(r2) {
  return e$2a(r2).store;
}
const O$k = (t2) => {
  let e2 = class extends u$Z(a$1s(t2)) {
    constructor(...r2) {
      super(...r2);
    }
  };
  return e2 = e$2g([n$2P("esri.core.MultiOriginJSONSupport")], e2), e2;
};
let S$p = class extends O$k(m$2q) {
};
S$p = e$2g([n$2P("esri.core.MultiOriginJSONSupport")], S$p);
async function r$11(e2, r2) {
  const { WhereClause: t2 } = await Promise.resolve().then(function() {
    return WhereClause;
  });
  return t2.create(e2, r2);
}
function t$14(r2, t2) {
  return r$1$(r2) ? r$1$(t2) ? `(${r2}) AND (${t2})` : r2 : t2;
}
var s$1d;
let p$1H = s$1d = class extends l$2B {
  constructor(e2) {
    super(e2), this.expression = null, this.name = null, this.returnType = "boolean", this.title = null;
  }
  clone() {
    return new s$1d({ name: this.name, title: this.title, expression: this.expression, returnType: this.returnType });
  }
};
e$2g([y$1I({ type: String, json: { write: true } })], p$1H.prototype, "expression", void 0), e$2g([y$1I({ type: String, json: { write: true } })], p$1H.prototype, "name", void 0), e$2g([y$1I({ type: ["boolean", "date", "number", "string"], json: { write: true } })], p$1H.prototype, "returnType", void 0), e$2g([y$1I({ type: String, json: { write: true } })], p$1H.prototype, "title", void 0), p$1H = s$1d = e$2g([n$2P("esri.form.ExpressionInfo")], p$1H);
const i$1A = p$1H;
let e$U = class extends l$2B {
  constructor(t2) {
    super(t2), this.description = null, this.label = null, this.type = null, this.visibilityExpression = null;
  }
};
e$2g([y$1I({ type: String, json: { write: true } })], e$U.prototype, "description", void 0), e$2g([y$1I({ type: String, json: { write: true } })], e$U.prototype, "label", void 0), e$2g([y$1I()], e$U.prototype, "type", void 0), e$2g([y$1I({ type: String, json: { write: true } })], e$U.prototype, "visibilityExpression", void 0), e$U = e$2g([n$2P("esri.form.elements.Element")], e$U);
const i$1z = e$U;
var s$1c;
let p$1G = s$1c = class extends l$2B {
  constructor(t2) {
    super(t2), this.type = null;
  }
  clone() {
    return new s$1c({ type: this.type });
  }
};
e$2g([y$1I({ type: ["attachment", "audio", "document", "image", "signature", "video"], json: { write: true } })], p$1G.prototype, "type", void 0), p$1G = s$1c = e$2g([n$2P("esri.form.elements.inputs.AttachmentInput")], p$1G);
const c$1t = p$1G;
var i$1y;
let p$1F = i$1y = class extends i$1z {
  constructor(t2) {
    super(t2), this.attachmentKeyword = null, this.editable = true, this.input = null, this.type = "attachment";
  }
  clone() {
    return new i$1y({ attachmentKeyword: this.attachmentKeyword, description: this.description, editable: this.editable, input: this.input, label: this.label, visibilityExpression: this.visibilityExpression });
  }
};
e$2g([y$1I({ type: String, json: { write: true } })], p$1F.prototype, "attachmentKeyword", void 0), e$2g([y$1I({ type: Boolean, json: { write: true } })], p$1F.prototype, "editable", void 0), e$2g([y$1I({ type: c$1t, json: { read: { source: "inputType" }, write: { target: "inputType" } } })], p$1F.prototype, "input", void 0), e$2g([y$1I({ type: ["attachment"], json: { read: false, write: true } })], p$1F.prototype, "type", void 0), p$1F = i$1y = e$2g([n$2P("esri.form.elements.AttachmentElement")], p$1F);
const n$1q = p$1F;
let e$T = class extends l$2B {
  constructor(r2) {
    super(r2), this.type = null;
  }
};
e$2g([y$1I()], e$T.prototype, "type", void 0), e$T = e$2g([n$2P("esri.form.elements.inputs.Input")], e$T);
const p$1E = e$T;
let s$1b = class extends p$1E {
  constructor(r2) {
    super(r2), this.maxLength = null, this.minLength = 0;
  }
};
e$2g([y$1I({ type: Number, json: { write: true } })], s$1b.prototype, "maxLength", void 0), e$2g([y$1I({ type: Number, json: { write: true } })], s$1b.prototype, "minLength", void 0), s$1b = e$2g([n$2P("esri.form.elements.inputs.TextInput")], s$1b);
const p$1D = s$1b;
var o$16;
let c$1s = o$16 = class extends p$1D {
  constructor(r2) {
    super(r2), this.type = "barcode-scanner";
  }
  clone() {
    return new o$16({ maxLength: this.maxLength, minLength: this.minLength });
  }
};
e$2g([y$1I({ type: ["barcode-scanner"], json: { read: false, write: true } })], c$1s.prototype, "type", void 0), c$1s = o$16 = e$2g([n$2P("esri.form.elements.inputs.BarcodeScannerInput")], c$1s);
const n$1p = c$1s;
var s$1a;
let p$1C = s$1a = class extends p$1E {
  constructor(o2) {
    super(o2), this.noValueOptionLabel = null, this.showNoValueOption = true, this.type = "combo-box";
  }
  clone() {
    return new s$1a({ showNoValueOption: this.showNoValueOption, noValueOptionLabel: this.noValueOptionLabel });
  }
};
e$2g([y$1I({ type: String, json: { write: true } })], p$1C.prototype, "noValueOptionLabel", void 0), e$2g([y$1I({ type: Boolean, json: { write: true } })], p$1C.prototype, "showNoValueOption", void 0), e$2g([y$1I({ type: ["combo-box"], json: { read: false, write: true } })], p$1C.prototype, "type", void 0), p$1C = s$1a = e$2g([n$2P("esri.form.elements.inputs.ComboBoxInput")], p$1C);
const i$1x = p$1C;
var s$19;
function n$1o(e2) {
  return e2 != null ? new Date(e2) : null;
}
function a$1r(e2) {
  return e2 ? e2.getTime() : null;
}
let m$1d = s$19 = class extends p$1E {
  constructor(e2) {
    super(e2), this.includeTime = false, this.max = null, this.min = null, this.type = "datetime-picker";
  }
  readMax(e2, r2) {
    return n$1o(r2.max);
  }
  writeMax(e2, r2) {
    r2.max = a$1r(e2);
  }
  readMin(e2, r2) {
    return n$1o(r2.min);
  }
  writeMin(e2, r2) {
    r2.min = a$1r(e2);
  }
  clone() {
    return new s$19({ includeTime: this.includeTime, max: this.max, min: this.min, type: this.type });
  }
};
e$2g([y$1I({ type: Boolean, json: { write: true } })], m$1d.prototype, "includeTime", void 0), e$2g([y$1I({ type: Date, json: { type: Number, write: true } })], m$1d.prototype, "max", void 0), e$2g([o$29("max")], m$1d.prototype, "readMax", null), e$2g([r$1P("max")], m$1d.prototype, "writeMax", null), e$2g([y$1I({ type: Date, json: { type: Number, write: true } })], m$1d.prototype, "min", void 0), e$2g([o$29("min")], m$1d.prototype, "readMin", null), e$2g([r$1P("min")], m$1d.prototype, "writeMin", null), e$2g([y$1I({ type: ["datetime-picker"], json: { read: false, write: true } })], m$1d.prototype, "type", void 0), m$1d = s$19 = e$2g([n$2P("esri.form.elements.inputs.DateTimePickerInput")], m$1d);
const c$1r = m$1d;
var s$18;
let p$1B = s$18 = class extends p$1E {
  constructor(o2) {
    super(o2), this.noValueOptionLabel = null, this.showNoValueOption = true, this.type = "radio-buttons";
  }
  clone() {
    return new s$18({ noValueOptionLabel: this.noValueOptionLabel, showNoValueOption: this.showNoValueOption });
  }
};
e$2g([y$1I({ type: String, json: { write: true } })], p$1B.prototype, "noValueOptionLabel", void 0), e$2g([y$1I({ type: Boolean, json: { write: true } })], p$1B.prototype, "showNoValueOption", void 0), e$2g([y$1I({ type: ["radio-buttons"], json: { read: false, write: true } })], p$1B.prototype, "type", void 0), p$1B = s$18 = e$2g([n$2P("esri.form.elements.inputs.RadioButtonsInput")], p$1B);
const i$1w = p$1B;
var s$17;
let p$1A = s$17 = class extends p$1E {
  constructor(o2) {
    super(o2), this.offValue = null, this.onValue = null, this.type = "switch";
  }
  clone() {
    return new s$17({ offValue: this.offValue, onValue: this.onValue });
  }
};
e$2g([y$1I({ type: [String, Number], json: { write: true } })], p$1A.prototype, "offValue", void 0), e$2g([y$1I({ type: [String, Number], json: { write: true } })], p$1A.prototype, "onValue", void 0), e$2g([y$1I({ type: ["switch"], json: { read: false, write: true } })], p$1A.prototype, "type", void 0), p$1A = s$17 = e$2g([n$2P("esri.form.elements.inputs.SwitchInput")], p$1A);
const i$1v = p$1A;
var o$15;
let p$1z = o$15 = class extends p$1D {
  constructor(t2) {
    super(t2), this.type = "text-area";
  }
  clone() {
    return new o$15({ maxLength: this.maxLength, minLength: this.minLength });
  }
};
e$2g([y$1I({ type: ["text-area"], json: { read: false, write: true } })], p$1z.prototype, "type", void 0), p$1z = o$15 = e$2g([n$2P("esri.form.elements.inputs.TextAreaInput")], p$1z);
const a$1q = p$1z;
var s$16;
let p$1y = s$16 = class extends p$1D {
  constructor(t2) {
    super(t2), this.type = "text-box";
  }
  clone() {
    return new s$16({ maxLength: this.maxLength, minLength: this.minLength });
  }
};
e$2g([y$1I({ type: ["text-box"], json: { read: false, write: true } })], p$1y.prototype, "type", void 0), p$1y = s$16 = e$2g([n$2P("esri.form.elements.inputs.TextBoxInput")], p$1y);
const c$1q = p$1y;
const m$1c = { base: p$1E, key: "type", typeMap: { "barcode-scanner": n$1p, "combo-box": i$1x, "datetime-picker": c$1r, "radio-buttons": i$1w, switch: i$1v, "text-area": a$1q, "text-box": c$1q } };
var n$1n;
let l$1j = n$1n = class extends i$1z {
  constructor(e2) {
    super(e2), this.domain = null, this.editable = true, this.editableExpression = null, this.fieldName = null, this.hint = null, this.input = null, this.requiredExpression = null, this.type = "field", this.valueExpression = null;
  }
  clone() {
    return new n$1n({ description: this.description, domain: this.domain, editable: this.editable, editableExpression: this.editableExpression, fieldName: this.fieldName, hint: this.hint, input: this.input, label: this.label, requiredExpression: this.requiredExpression, valueExpression: this.valueExpression, visibilityExpression: this.visibilityExpression });
  }
};
e$2g([y$1I({ types: n$1K, json: { read: { reader: t$1h }, write: true } })], l$1j.prototype, "domain", void 0), e$2g([y$1I({ type: Boolean, json: { write: true } })], l$1j.prototype, "editable", void 0), e$2g([y$1I({ type: String, json: { write: true } })], l$1j.prototype, "editableExpression", void 0), e$2g([y$1I({ type: String, json: { write: true } })], l$1j.prototype, "fieldName", void 0), e$2g([y$1I({ type: String, json: { write: true } })], l$1j.prototype, "hint", void 0), e$2g([y$1I({ types: m$1c, json: { read: { source: "inputType" }, write: { target: "inputType" } } })], l$1j.prototype, "input", void 0), e$2g([y$1I({ type: String, json: { write: true } })], l$1j.prototype, "requiredExpression", void 0), e$2g([y$1I({ type: String, json: { read: false, write: true } })], l$1j.prototype, "type", void 0), e$2g([y$1I({ type: String, json: { write: true } })], l$1j.prototype, "valueExpression", void 0), l$1j = n$1n = e$2g([n$2P("esri.form.elements.FieldElement")], l$1j);
const a$1p = l$1j;
var p$1x;
let l$1i = p$1x = class extends i$1z {
  constructor(e2) {
    super(e2), this.displayCount = null, this.displayType = "list", this.editable = true, this.orderByFields = null, this.relationshipId = null, this.type = "relationship";
  }
  clone() {
    return new p$1x({ description: this.description, displayCount: this.displayCount, displayType: this.displayType, editable: this.editable, label: this.label, orderByFields: y$1L(this.orderByFields), relationshipId: this.relationshipId, visibilityExpression: this.visibilityExpression });
  }
};
e$2g([y$1I({ type: Number, json: { write: true } })], l$1i.prototype, "displayCount", void 0), e$2g([y$1I({ type: ["list"], json: { write: true } })], l$1i.prototype, "displayType", void 0), e$2g([y$1I({ type: Boolean, json: { write: true } })], l$1i.prototype, "editable", void 0), e$2g([y$1I({ type: [c$2U], json: { write: true } })], l$1i.prototype, "orderByFields", void 0), e$2g([y$1I({ type: Number, json: { write: true } })], l$1i.prototype, "relationshipId", void 0), e$2g([y$1I({ type: ["relationship"], json: { read: false, write: true } })], l$1i.prototype, "type", void 0), l$1i = p$1x = e$2g([n$2P("esri.form.elements.RelationshipElement")], l$1i);
const d$P = l$1i;
function n$1m(t2) {
  return { typesWithGroup: { base: i$1z, key: "type", typeMap: { attachment: n$1q, field: a$1p, group: t2, relationship: d$P } }, typesWithoutGroup: { base: i$1z, key: "type", typeMap: { attachment: n$1q, field: a$1p, relationship: d$P } } };
}
function i$1u(t2, e2, p2 = true) {
  if (!t2)
    return null;
  const r2 = p2 ? e2.typesWithGroup.typeMap : e2.typesWithoutGroup.typeMap;
  return t2.filter((t3) => r2[t3.type]).map((t3) => r2[t3.type].fromJSON(t3));
}
function u$Y(t2, e2, p2 = true) {
  if (!t2)
    return null;
  const r2 = p2 ? e2.typesWithGroup.typeMap : e2.typesWithoutGroup.typeMap;
  return t2.filter((t3) => r2[t3.type]).map((t3) => t3.toJSON());
}
function s$15(e2, p2, r2 = true) {
  return e2 ? e2.map((e3) => S$V(r2 ? p2.typesWithGroup : p2.typesWithoutGroup, e3)) : null;
}
var d$O;
let u$X = d$O = class extends i$1z {
  constructor(e2) {
    super(e2), this.elements = null, this.initialState = "expanded", this.type = "group";
  }
  castElements(e2) {
    return s$15(e2, f$V, false);
  }
  readElements(e2, t2) {
    return i$1u(t2.formElements, f$V, false);
  }
  writeElements(e2, t2) {
    t2.formElements = u$Y(e2, f$V, false);
  }
  clone() {
    return new d$O({ description: this.description, elements: y$1L(this.elements), initialState: this.initialState, label: this.label, visibilityExpression: this.visibilityExpression });
  }
};
e$2g([y$1I({ json: { write: true } })], u$X.prototype, "elements", void 0), e$2g([s$2i("elements")], u$X.prototype, "castElements", null), e$2g([o$29("elements", ["formElements"])], u$X.prototype, "readElements", null), e$2g([r$1P("elements")], u$X.prototype, "writeElements", null), e$2g([y$1I({ type: ["collapsed", "expanded"], json: { write: true } })], u$X.prototype, "initialState", void 0), e$2g([y$1I({ type: String, json: { read: false, write: true } })], u$X.prototype, "type", void 0), u$X = d$O = e$2g([n$2P("esri.form.elements.GroupElement")], u$X);
const f$V = n$1m(u$X), y$D = u$X;
var f$U;
const j$n = n$1m(y$D);
let h$Q = f$U = class extends l$2B {
  constructor(e2) {
    super(e2), this.description = null, this.elements = null, this.expressionInfos = null, this.preserveFieldValuesWhenHidden = false, this.title = null;
  }
  castElements(e2) {
    return s$15(e2, j$n);
  }
  readElements(e2, t2) {
    return i$1u(t2.formElements, j$n);
  }
  writeElements(e2, t2) {
    t2.formElements = u$Y(e2, j$n);
  }
  clone() {
    return new f$U({ description: this.description, expressionInfos: y$1L(this.expressionInfos), elements: y$1L(this.elements), title: this.title, preserveFieldValuesWhenHidden: this.preserveFieldValuesWhenHidden });
  }
};
e$2g([y$1I({ type: String, json: { write: true } })], h$Q.prototype, "description", void 0), e$2g([y$1I({ json: { write: true } })], h$Q.prototype, "elements", void 0), e$2g([s$2i("elements")], h$Q.prototype, "castElements", null), e$2g([o$29("elements", ["formElements"])], h$Q.prototype, "readElements", null), e$2g([r$1P("elements")], h$Q.prototype, "writeElements", null), e$2g([y$1I({ type: [i$1A], json: { write: true } })], h$Q.prototype, "expressionInfos", void 0), e$2g([y$1I({ type: Boolean, json: { default: false, write: true } })], h$Q.prototype, "preserveFieldValuesWhenHidden", void 0), e$2g([y$1I({ type: String, json: { write: true } })], h$Q.prototype, "title", void 0), h$Q = f$U = e$2g([n$2P("esri.form.FormTemplate")], h$Q);
const y$C = h$Q;
async function o$14(o2) {
  const a2 = "portalItem" in o2 ? o2 : { portalItem: o2 }, e2 = await import("./portalLayers.js");
  try {
    return await e2.fromItem(a2);
  } catch (p2) {
    const o3 = a2 && a2.portalItem, e3 = o3 && o3.id || "unset", l2 = o3 && o3.portal && o3.portal.url || s$2A.portalUrl;
    throw s$2z.getLogger("esri.layers.support.fromPortalItem").error("#fromPortalItem()", "Failed to create layer from portal item (portal: '" + l2 + "', id: '" + e3 + "')", p2), p2;
  }
}
let m$1b = 0, h$P = class extends n$2G.EventedMixin(s$1$(m$1X)) {
  constructor() {
    super(...arguments), this.attributionDataUrl = null, this.fullExtent = new w$Z(-180, -90, 180, 90, k$C.WGS84), this.id = Date.now().toString(16) + "-layer-" + m$1b++, this.legendEnabled = true, this.listMode = "show", this.opacity = 1, this.parent = null, this.popupEnabled = true, this.attributionVisible = true, this.spatialReference = k$C.WGS84, this.title = null, this.type = null, this.url = null, this.visible = true;
  }
  static async fromArcGISServerUrl(t2) {
    const e2 = typeof t2 == "string" ? { url: t2 } : t2;
    return (await import("./arcgisLayers.js")).fromUrl(e2);
  }
  static fromPortalItem(t2) {
    return o$14(t2);
  }
  initialize() {
    this.when().catch((t2) => {
      var _a2, _b2;
      j$_(t2) || s$2z.getLogger(this.declaredClass).error("#load()", `Failed to load layer (title: '${(_a2 = this.title) != null ? _a2 : "no title"}', id: '${(_b2 = this.id) != null ? _b2 : "no id"}')`, { error: t2 });
    });
  }
  destroy() {
    if (this.parent) {
      const t2 = this, e2 = this.parent;
      "layers" in e2 && e2.layers.includes(t2) ? e2.layers.remove(t2) : "tables" in e2 && e2.tables.includes(t2) ? e2.tables.remove(t2) : "baseLayers" in e2 && e2.baseLayers.includes(t2) ? e2.baseLayers.remove(t2) : "baseLayers" in e2 && e2.referenceLayers.includes(t2) && e2.referenceLayers.remove(t2);
    }
  }
  get hasAttributionData() {
    return this.attributionDataUrl != null;
  }
  get parsedUrl() {
    return j$Q(this.url);
  }
  async fetchAttributionData() {
    const t2 = this.attributionDataUrl;
    if (this.hasAttributionData && t2) {
      return (await U$t(t2, { query: { f: "json" }, responseType: "json" })).data;
    }
    throw new s$2u("layer:no-attribution-data", "Layer does not have attribution data");
  }
};
e$2g([y$1I({ type: String })], h$P.prototype, "attributionDataUrl", void 0), e$2g([y$1I({ type: w$Z })], h$P.prototype, "fullExtent", void 0), e$2g([y$1I({ readOnly: true })], h$P.prototype, "hasAttributionData", null), e$2g([y$1I({ type: String, clonable: false })], h$P.prototype, "id", void 0), e$2g([y$1I({ type: Boolean, nonNullable: true })], h$P.prototype, "legendEnabled", void 0), e$2g([y$1I({ type: ["show", "hide", "hide-children"] })], h$P.prototype, "listMode", void 0), e$2g([y$1I({ type: Number, range: { min: 0, max: 1 }, nonNullable: true })], h$P.prototype, "opacity", void 0), e$2g([y$1I({ clonable: false })], h$P.prototype, "parent", void 0), e$2g([y$1I({ readOnly: true })], h$P.prototype, "parsedUrl", null), e$2g([y$1I({ type: Boolean })], h$P.prototype, "popupEnabled", void 0), e$2g([y$1I({ type: Boolean })], h$P.prototype, "attributionVisible", void 0), e$2g([y$1I({ type: k$C })], h$P.prototype, "spatialReference", void 0), e$2g([y$1I({ type: String })], h$P.prototype, "title", void 0), e$2g([y$1I({ readOnly: true, json: { read: false } })], h$P.prototype, "type", void 0), e$2g([y$1I()], h$P.prototype, "url", void 0), e$2g([y$1I({ type: Boolean, nonNullable: true })], h$P.prototype, "visible", void 0), h$P = e$2g([n$2P("esri.layers.Layer")], h$P);
const b$y = h$P;
function t$13(e2, n2, o2) {
  if (e2.hasM == null || e2.hasZ)
    for (const t2 of n2)
      for (const e3 of t2)
        e3.length > 2 && (e3[2] *= o2);
}
function i$1t(e2, o2, t2) {
  if (!e2 && !o2 || !t2)
    return;
  const i2 = L$p(t2);
  s$14(e2, t2, i2), s$14(o2, t2, i2);
}
function s$14(e2, n2, o2) {
  if (e2)
    for (const t2 of e2)
      f$T(t2.geometry, n2, o2);
}
function f$T(i2, s2, f2) {
  if (t$2r(i2) || !i2.spatialReference || E$P(i2.spatialReference, s2))
    return;
  const r2 = L$p(i2.spatialReference) / f2;
  if (r2 !== 1) {
    if ("x" in i2)
      i2.z != null && (i2.z *= r2);
    else if ("rings" in i2)
      t$13(i2, i2.rings, r2);
    else if ("paths" in i2)
      t$13(i2, i2.paths, r2);
    else if ("points" in i2 && (i2.hasM == null || i2.hasZ))
      for (const e2 of i2.points)
        e2.length > 2 && (e2[2] *= r2);
  }
}
let b$x = 0;
const T$h = "esri.layers.graphics.sources.MemorySource", F$j = s$2z.getLogger(T$h);
let G$j = class extends m$1X.LoadableMixin(m$1Y(a$1W(j$V))) {
  constructor(e2) {
    super(e2), this._idToClientGraphic = null, this.type = "memory";
  }
  load(e2) {
    const t2 = r$1$(e2) ? e2.signal : null;
    return this.addResolvingPromise(this._startWorker(t2)), Promise.resolve(this);
  }
  destroy() {
    var _a2;
    (_a2 = this._connection) == null ? void 0 : _a2.close(), this._connection = null;
  }
  get _workerGeometryType() {
    var _a2;
    const e2 = (_a2 = this.layer) == null ? void 0 : _a2.geometryType;
    return e2 ? this._geometryTypeRequiresClientGraphicMapping(e2) ? "polygon" : e2 : null;
  }
  applyEdits(e2) {
    return this.load().then(() => this._applyEdits(e2));
  }
  openPorts() {
    return this.load().then(() => this._connection.openPorts());
  }
  async queryFeatures(e2, t2 = {}) {
    await this.load(t2);
    const r2 = await this._connection.invoke("queryFeatures", e2 ? e2.toJSON() : null, t2);
    r$14(e2, this.layer.spatialReference, r2);
    const s2 = x$A.fromJSON(r2);
    if (!this._requiresClientGraphicMapping())
      return s2;
    const o2 = this.layer.objectIdField;
    for (const i2 of s2.features) {
      const e3 = i2.attributes[o2], t3 = this._idToClientGraphic.get(e3);
      t3 && (i2.geometry = t3.geometry);
    }
    return s2.geometryType = this.layer.geometryType, s2;
  }
  async queryFeaturesJSON(e2, t2 = {}) {
    if (this._requiresClientGraphicMapping())
      throw new s$2u("query-features-json:unsupported", "Cannot query in JSON format for client only geometry types (mesh and extent)");
    await this.load(t2);
    const r2 = await this._connection.invoke("queryFeatures", e2 ? e2.toJSON() : null, t2);
    return r$14(e2, this.layer.spatialReference, r2), r2;
  }
  queryFeatureCount(e2, t2 = {}) {
    return this.load(t2).then(() => this._connection.invoke("queryFeatureCount", e2 ? e2.toJSON() : null, t2));
  }
  queryObjectIds(e2, t2 = {}) {
    return this.load(t2).then(() => this._connection.invoke("queryObjectIds", e2 ? e2.toJSON() : null, t2));
  }
  queryExtent(e2, t2 = {}) {
    return this.load(t2).then(() => this._connection.invoke("queryExtent", e2 ? e2.toJSON() : null, t2)).then((e3) => ({ count: e3.count, extent: w$Z.fromJSON(e3.extent) }));
  }
  querySnapping(e2, t2 = {}) {
    return this.load(t2).then(() => this._connection.invoke("querySnapping", e2, t2));
  }
  async _applyEdits(e2) {
    if (!this._connection)
      throw new s$2u("feature-layer-source:edit-failure", "Memory source not loaded");
    const t2 = this.layer.objectIdField;
    let r2 = null;
    const o2 = [], i2 = [];
    await Promise.all([this._prepareClientMapping(e2.addFeatures, null), this._prepareClientMapping(e2.updateFeatures, null)]);
    const n2 = (e3) => "objectId" in e3 && e3.objectId != null ? e3.objectId : "attributes" in e3 && e3.attributes[t2] != null ? e3.attributes[t2] : null;
    if (e2.addFeatures && (r2 = this._prepareAddFeatures(e2.addFeatures)), e2.deleteFeatures)
      for (const s2 of e2.deleteFeatures) {
        const e3 = n2(s2);
        e3 != null && o2.push(e3);
      }
    const a2 = e2.updateFeatures && this._idToClientGraphic ? new Map() : null;
    if (e2.updateFeatures) {
      for (const s2 of e2.updateFeatures)
        if (i2.push(this._serializeFeature(s2)), a2) {
          const e3 = n2(s2);
          e3 != null && a2.set(e3, s2);
        }
    }
    i$1t(r2 ? r2.features : null, i2, this.layer.spatialReference);
    const { fullExtent: l2, featureEditResults: u2 } = await this._connection.invoke("applyEdits", { adds: r2 ? r2.features : [], updates: i2, deletes: o2 });
    return this.fullExtent = l2, r2 && r2.finish(u2.uidToObjectId), this._updateClientGraphicIds(a2, u2), this._createEditsResult(u2);
  }
  async _prepareClientMapping(e2, t2) {
    if (this._layerOrSourceGeometryType !== "mesh" || t$2r(e2))
      return;
    const r2 = [];
    for (const { geometry: s2 } of e2)
      !r$1$(s2) || s2.type !== "mesh" || s2.hasExtent || s2.loaded || r2.push(s2.load({ signal: t2 }));
    r2.length && await Promise.all(r2);
  }
  _updateClientGraphicIds(e2, t2) {
    if (this._idToClientGraphic) {
      if (e2)
        for (const r2 of t2.updateResults) {
          if (!r2.success)
            continue;
          const t3 = e2.get(r2.objectId);
          t3 != null && this._addIdToClientGraphic(t3);
        }
      for (const e3 of t2.deleteResults)
        e3.success && this._idToClientGraphic.delete(e3.objectId);
    }
  }
  _createEditsResult(e2) {
    return { addFeatureResults: e2.addResults ? e2.addResults.map(this._createFeatureEditResult, this) : [], updateFeatureResults: e2.updateResults ? e2.updateResults.map(this._createFeatureEditResult, this) : [], deleteFeatureResults: e2.deleteResults ? e2.deleteResults.map(this._createFeatureEditResult, this) : [], addAttachmentResults: [], updateAttachmentResults: [], deleteAttachmentResults: [] };
  }
  _createFeatureEditResult(e2) {
    const t2 = e2.success === true ? null : e2.error || { code: void 0, description: void 0 };
    return { objectId: e2.objectId, globalId: e2.globalId, error: t2 ? new s$2u("feature-layer-source:edit-failure", t2.description, { code: t2.code }) : null };
  }
  _prepareAddFeatures(e2) {
    const t2 = new Map(), r2 = new Array(e2.length);
    let s2 = null;
    for (let i2 = 0; i2 < e2.length; i2++) {
      const o3 = e2[i2], n2 = this._serializeFeature(o3);
      !s2 && r$1$(o3.geometry) && (s2 = o3.geometry.type), r2[i2] = n2, t2.set(`${n2.uid}`, o3);
    }
    const o2 = this;
    return { features: r2, inferredGeometryType: s2, finish(e3) {
      const r3 = o2.sourceJSON.objectIdField;
      for (const s3 in e3) {
        const i2 = e3[s3], n2 = t2.get(s3);
        n2 && (n2.attributes || (n2.attributes = {}), i2 === -1 ? delete n2.attributes[r3] : n2.attributes[r3] = i2, o2._addIdToClientGraphic(n2));
      }
    } };
  }
  _addIdToClientGraphic(e2) {
    if (!this._idToClientGraphic)
      return;
    const t2 = this.sourceJSON.objectIdField, r2 = e2.attributes && e2.attributes[t2];
    r2 != null && this._idToClientGraphic.set(r2, e2);
  }
  get _layerOrSourceGeometryType() {
    var _a2, _b2, _c2;
    return (_c2 = (_a2 = this.layer) == null ? void 0 : _a2.geometryType) != null ? _c2 : (_b2 = this.sourceJSON) == null ? void 0 : _b2.geometryType;
  }
  _requiresClientGraphicMapping() {
    return this._geometryTypeRequiresClientGraphicMapping(this._layerOrSourceGeometryType);
  }
  _geometryRequiresClientGraphicMapping(e2) {
    return this._geometryTypeRequiresClientGraphicMapping(e2.type);
  }
  _geometryTypeRequiresClientGraphicMapping(e2) {
    return e2 === "mesh" || e2 === "multipatch" || e2 === "extent";
  }
  _serializeFeature(e2) {
    const { attributes: t2 } = e2, r2 = this._geometryForSerialization(e2), s2 = (b$x++).toString();
    return r2 ? { uid: s2, geometry: r2.toJSON(), attributes: t2 } : { uid: s2, attributes: t2 };
  }
  _geometryForSerialization(e2) {
    const { geometry: t2 } = e2;
    if (t$2r(t2))
      return null;
    if (this._geometryRequiresClientGraphicMapping(t2)) {
      return t2.extent ? v$15.fromExtent(t2.extent) : null;
    }
    return t2;
  }
  async _startWorker(e2) {
    this._connection = await u$1r("MemorySourceWorker", { strategy: has("feature-layers-workers") ? "dedicated" : "local", signal: e2 });
    const { fields: t2, spatialReference: r2, objectIdField: s2, hasM: o2, hasZ: i2, timeInfo: n2 } = this.layer, a2 = this.layer.originOf("spatialReference") === "defaults";
    await this._prepareClientMapping(this.items, e2);
    const l2 = this._prepareAddFeatures(this.items);
    this.handles.add(this.on("before-changes", (e3) => {
      F$j.error("Source modifications will not propagate after layer has been loaded. Please use .applyEdits() instead"), e3.preventDefault();
    }));
    const u2 = { features: l2.features, fields: t2 && t2.map((e3) => e3.toJSON()), geometryType: t$1Y.toJSON(this._workerGeometryType), hasM: this._layerOrSourceGeometryType !== "mesh" && o2, hasZ: this._layerOrSourceGeometryType === "mesh" || i2, objectIdField: s2, spatialReference: a2 ? null : r2 && r2.toJSON(), timeInfo: n2 ? n2.toJSON() : null }, c2 = await this._connection.invoke("load", u2, { signal: e2 });
    for (const p2 of c2.warnings)
      F$j.warn(p2.message, { layer: this.layer, warning: p2 });
    c2.featureErrors.length && F$j.warn(`Encountered ${c2.featureErrors.length} validation errors while loading features`, c2.featureErrors);
    const d2 = c2.layerDefinition;
    this._geometryTypeRequiresClientGraphicMapping(l2.inferredGeometryType) && (d2.geometryType = t$1Y.toJSON(l2.inferredGeometryType)), this.sourceJSON = d2, this._requiresClientGraphicMapping() && (this._idToClientGraphic = new Map()), l2.finish(c2.assignedObjectIds);
  }
};
e$2g([n$2F({ Type: g$10, ensureType: b$1a(g$10) })], G$j.prototype, "itemType", void 0), e$2g([y$1I()], G$j.prototype, "type", void 0), e$2g([y$1I({ constructOnly: true })], G$j.prototype, "layer", void 0), e$2g([y$1I({ readOnly: true })], G$j.prototype, "_workerGeometryType", null), e$2g([y$1I()], G$j.prototype, "sourceJSON", void 0), G$j = e$2g([n$2P(T$h)], G$j);
function t$12(e2) {
  return "portalItem" in e2;
}
const i$1s = (i2) => {
  let o2 = class extends i2 {
    get apiKey() {
      var _a2;
      return this._isOverridden("apiKey") ? this._get("apiKey") : t$12(this) ? (_a2 = this.portalItem) == null ? void 0 : _a2.apiKey : null;
    }
    set apiKey(e2) {
      e2 != null ? this._override("apiKey", e2) : (this._clearOverride("apiKey"), this.clear("apiKey", "user"));
    }
  };
  return e$2g([y$1I({ type: String })], o2.prototype, "apiKey", null), o2 = e$2g([n$2P("esri.layers.mixins.APIKeyMixin")], o2), o2;
};
const c$1p = { mapserver: "MapServer", imageserver: "ImageServer", featureserver: "FeatureServer", sceneserver: "SceneServer", streamserver: "StreamServer", vectortileserver: "VectorTileServer" }, a$1o = Object.values(c$1p), f$S = new RegExp(`^((?:https?:)?\\/\\/\\S+?\\/rest\\/services\\/(.+?)\\/(${a$1o.join("|")}))(?:\\/(?:layers\\/)?(\\d+))?`, "i"), v$B = new RegExp(`^((?:https?:)?\\/\\/\\S+?\\/([^\\/\\n]+)\\/(${a$1o.join("|")}))(?:\\/(?:layers\\/)?(\\d+))?`, "i"), p$1w = /(.*?)\/(?:layers\/)?(\d+)\/?$/i;
function d$N(e2) {
  return !!f$S.test(e2);
}
function m$1a(r2) {
  if (t$2r(r2))
    return null;
  const n2 = j$Q(r2), s2 = n2.path.match(f$S) || n2.path.match(v$B);
  if (!s2)
    return null;
  const [, l2, u2, i2, o2] = s2, a2 = u2.indexOf("/");
  return { title: h$O(a2 !== -1 ? u2.slice(a2 + 1) : u2), serverType: c$1p[i2.toLowerCase()], sublayer: o2 != null && o2 !== "" ? parseInt(o2, 10) : null, url: { path: l2 } };
}
function w$u(e2) {
  const r2 = j$Q(e2).path.match(p$1w);
  return r2 ? { serviceUrl: r2[1], sublayerId: Number(r2[2]) } : null;
}
function h$O(e2) {
  return (e2 = e2.replace(/\s*[/_]+\s*/g, " "))[0].toUpperCase() + e2.slice(1);
}
function y$B(e2, t2) {
  const n2 = [];
  if (e2) {
    const t3 = m$1a(e2);
    r$1$(t3) && t3.title && n2.push(t3.title);
  }
  if (t2) {
    const e3 = h$O(t2);
    n2.push(e3);
  }
  if (n2.length === 2) {
    if (n2[0].toLowerCase().includes(n2[1].toLowerCase()))
      return n2[0];
    if (n2[1].toLowerCase().includes(n2[0].toLowerCase()))
      return n2[1];
  }
  return n2.join(" - ");
}
function g$E(e2) {
  if (!e2)
    return false;
  const r2 = ".arcgis.com/", t2 = "//services", n2 = "//tiles", s2 = "//features", l2 = (e2 = e2.toLowerCase()).includes(r2), u2 = e2.includes(t2) || e2.includes(n2) || e2.includes(s2);
  return l2 && u2;
}
function S$o(e2, r2) {
  return e2 ? Ct(At$1(e2, r2)) : e2;
}
function L$i(e2) {
  let { url: l2 } = e2;
  if (!l2)
    return { url: l2 };
  l2 = At$1(l2, e2.logger);
  const u2 = j$Q(l2), i2 = m$1a(u2.path);
  let o2;
  if (r$1$(i2))
    i2.sublayer != null && e2.layer.layerId == null && (o2 = i2.sublayer), l2 = i2.url.path;
  else if (e2.nonStandardUrlAllowed) {
    const e3 = w$u(u2.path);
    r$1$(e3) && (l2 = e3.serviceUrl, o2 = e3.sublayerId);
  }
  return { url: Ct(l2), layerId: o2 };
}
function b$w(e2, r2, t2, n2, s2) {
  f$1w(r2, n2, "url", s2), n2.url && e2.layerId != null && (n2.url = G$q(n2.url, t2, e2.layerId.toString()));
}
function I$n(e2) {
  if (!e2)
    return false;
  const r2 = e2.toLowerCase(), t2 = r2.includes("/services/"), n2 = r2.includes("/mapserver/wmsserver"), s2 = r2.includes("/imageserver/wmsserver"), l2 = r2.includes("/wmsserver");
  return t2 && (n2 || s2 || l2);
}
const p$1v = (p2) => {
  let c2 = class extends p2 {
    get title() {
      if (this._get("title") && this.originOf("title") !== "defaults")
        return this._get("title");
      if (this.url) {
        const t2 = m$1a(this.url);
        if (r$1$(t2) && t2.title)
          return t2.title;
      }
      return this._get("title") || "";
    }
    set title(t2) {
      this._set("title", t2);
    }
    set url(t2) {
      this._set("url", S$o(t2, s$2z.getLogger(this.declaredClass)));
    }
  };
  return e$2g([y$1I()], c2.prototype, "title", null), e$2g([y$1I({ type: String })], c2.prototype, "url", null), c2 = e$2g([n$2P("esri.layers.mixins.ArcGISService")], c2), c2;
};
const i$1r = { read: { reader: n$1N }, write: { allowNull: true, writer: a$1S } }, n$1l = (t2) => {
  let s2 = class extends t2 {
    constructor() {
      super(...arguments), this.blendMode = "normal", this.effect = null;
    }
  };
  return e$2g([y$1I({ type: ["average", "color-burn", "color-dodge", "color", "darken", "destination-atop", "destination-in", "destination-out", "destination-over", "difference", "exclusion", "hard-light", "hue", "invert", "lighten", "lighter", "luminosity", "minus", "multiply", "normal", "overlay", "plus", "reflect", "saturation", "screen", "soft-light", "source-atop", "source-in", "source-out", "vivid-light", "xor"], nonNullable: true, json: { read: false, write: false, origins: { "web-map": { read: true, write: true }, "portal-item": { read: true, write: true } } } })], s2.prototype, "blendMode", void 0), e$2g([y$1I({ json: { read: false, write: false, origins: { "web-map": i$1r, "portal-item": i$1r } } })], s2.prototype, "effect", void 0), s2 = e$2g([n$2P("esri.layers.mixins.BlendLayer")], s2), s2;
};
const o$13 = (o2) => {
  let t2 = class extends o2 {
    constructor() {
      super(...arguments), this.customParameters = null;
    }
  };
  return e$2g([y$1I({ type: Object, json: { write: { overridePolicy: (r2) => ({ enabled: !!(r2 && Object.keys(r2).length > 0) }) } } })], t2.prototype, "customParameters", void 0), t2 = e$2g([n$2P("esri.layers.mixins.CustomParametersMixin")], t2), t2;
};
const d$M = new n$2G.EventEmitter(), i$1q = "esri.layers.mixins.EditBusLayer", l$1h = Symbol(i$1q);
function o$12(e2) {
  return e2 != null && typeof e2 == "object" && l$1h in e2;
}
const a$1n = (t2) => {
  var o2;
  let a2 = class extends t2 {
    constructor(...e2) {
      super(...e2), this[o2] = true, this.when().then(() => {
        this.own([d$M.on("edits", (e3) => {
          var _a2, _b2, _c2;
          const t3 = "layer" in e3 ? e3.layer : null, r2 = "layer" in e3 ? (_a2 = e3.layer) == null ? void 0 : _a2.url : e3.serviceUrl, d2 = "layer" in e3 ? (_b2 = e3.layer) == null ? void 0 : _b2.layerId : e3.layerId, i2 = e3.event;
          if (t3 === this || r2 !== this.url)
            return;
          if (d2 != null && this.layerId != null && d2 === this.layerId)
            return void this.emit("edits", y$1L(i2));
          const l2 = (_c2 = i2.editedFeatures) == null ? void 0 : _c2.find(({ layerId: e4 }) => e4 === this.layerId);
          if (l2) {
            const { adds: e4, updates: t4, deletes: r3 } = l2.editedFeatures, d3 = { edits: null, addedAttachments: [], deletedAttachments: [], updatedAttachments: [], addedFeatures: e4 ? e4.map(({ attributes: e5 }) => ({ objectId: this.objectIdField && e5[this.objectIdField], globalId: this.globalIdField && e5[this.globalIdField] })) : [], deletedFeatures: r3 ? r3.map(({ attributes: e5 }) => ({ objectId: this.objectIdField && e5[this.objectIdField], globalId: this.globalIdField && e5[this.globalIdField] })) : [], updatedFeatures: t4 ? t4.map(({ current: { attributes: e5 } }) => ({ objectId: this.objectIdField && e5[this.objectIdField], globalId: this.globalIdField && e5[this.globalIdField] })) : [], editedFeatures: y$1L(i2.editedFeatures) };
            this.emit("edits", d3);
          }
        })]);
      }, () => {
      });
    }
  };
  return o2 = l$1h, a2 = e$2g([n$2P(i$1q)], a2), a2;
};
var c$1o;
const m$19 = new s$2a({ esriSpatialRelIntersects: "intersects", esriSpatialRelContains: "contains", esriSpatialRelCrosses: "crosses", esriSpatialRelDisjoint: "disjoint", esriSpatialRelEnvelopeIntersects: "envelope-intersects", esriSpatialRelIndexIntersects: "index-intersects", esriSpatialRelOverlaps: "overlaps", esriSpatialRelTouches: "touches", esriSpatialRelWithin: "within", esriSpatialRelRelation: "relation" }), u$W = new s$2a({ esriSRUnit_Meter: "meters", esriSRUnit_Kilometer: "kilometers", esriSRUnit_Foot: "feet", esriSRUnit_StatuteMile: "miles", esriSRUnit_NauticalMile: "nautical-miles", esriSRUnit_USNauticalMile: "us-nautical-miles" });
let d$L = c$1o = class extends l$2B {
  constructor(e2) {
    super(e2), this.where = null, this.geometry = null, this.spatialRelationship = "intersects", this.distance = void 0, this.objectIds = null, this.units = null, this.timeExtent = null;
  }
  createQuery(e2 = {}) {
    const { where: t2, geometry: i2, spatialRelationship: r2, timeExtent: s2, objectIds: n2, units: a2, distance: l2 } = this;
    return new x$z(__spreadValues({ geometry: y$1L(i2), objectIds: y$1L(n2), spatialRelationship: r2, timeExtent: y$1L(s2), where: t2, units: a2, distance: l2 }, e2));
  }
  clone() {
    const { where: e2, geometry: t2, spatialRelationship: i2, timeExtent: r2, objectIds: s2, units: n2, distance: a2 } = this;
    return new c$1o({ geometry: y$1L(t2), objectIds: y$1L(s2), spatialRelationship: i2, timeExtent: y$1L(r2), where: e2, units: n2, distance: a2 });
  }
};
e$2g([y$1I({ type: String, json: { write: true } })], d$L.prototype, "where", void 0), e$2g([y$1I({ types: i$2S, json: { write: true } })], d$L.prototype, "geometry", void 0), e$2g([y$1I({ type: m$19.apiValues, json: { name: "spatialRel", read: { reader: m$19.read }, write: { allowNull: false, writer: m$19.write, overridePolicy() {
  return { enabled: r$1$(this.geometry) };
} } } })], d$L.prototype, "spatialRelationship", void 0), e$2g([y$1I({ type: Number, json: { write: { overridePolicy(e2) {
  return { enabled: e2 != null && this.geometry != null };
} } } })], d$L.prototype, "distance", void 0), e$2g([y$1I({ type: [Number], json: { write: true } })], d$L.prototype, "objectIds", void 0), e$2g([y$1I({ type: u$W.apiValues, json: { read: u$W.read, write: { writer: u$W.write, overridePolicy(e2) {
  return { enabled: e2 != null && this.geometry != null };
} } } })], d$L.prototype, "units", void 0), e$2g([y$1I({ type: T$o, json: { write: true } })], d$L.prototype, "timeExtent", void 0), d$L = c$1o = e$2g([n$2P("esri.layers.support.FeatureFilter")], d$L);
const y$A = d$L;
var d$K;
const n$1k = { read: { reader: n$1N }, write: { writer: a$1S, overridePolicy() {
  return { allowNull: this.excludedEffect != null, isRequired: this.excludedEffect == null };
} } }, a$1m = { read: { reader: n$1N }, write: { writer: a$1S, overridePolicy() {
  return { allowNull: this.includedEffect != null, isRequired: this.includedEffect == null };
} } }, p$1u = { name: "showExcludedLabels", default: true };
let m$18 = d$K = class extends l$2B {
  constructor(e2) {
    super(e2), this.filter = null, this.includedEffect = null, this.excludedEffect = null, this.excludedLabelsVisible = false;
  }
  write(e2, t2) {
    var _a2, _b2;
    const l2 = super.write(e2, t2);
    if (t2 == null ? void 0 : t2.origin) {
      if (l2.filter) {
        const e3 = Object.keys(l2.filter);
        if (e3.length > 1 || e3[0] !== "where")
          return (_a2 = t2.messages) == null ? void 0 : _a2.push(new s$2u("web-document-write:unsupported-feature-effect", "Invalid feature effect 'filter'. A filter can only contain a 'where' property", { layer: t2.layer, effect: this })), null;
      }
      if ("showExcludedLabels" in l2)
        return (_b2 = t2.messages) == null ? void 0 : _b2.push(new s$2u("web-document-write:unsupported-feature-effect", "Invalid value for property 'excludedLabelsVisible' which should always be 'true'", { layer: t2.layer, effect: this })), null;
    }
    return l2;
  }
  clone() {
    return new d$K({ filter: r$1$(this.filter) ? this.filter.clone() : null, includedEffect: this.includedEffect, excludedEffect: this.excludedEffect, excludedLabelsVisible: this.excludedLabelsVisible });
  }
};
e$2g([y$1I({ type: y$A, json: { write: { allowNull: true, writer(e2, r2, t2, l2) {
  const s2 = e2 == null ? void 0 : e2.write({}, l2);
  s2 && Object.keys(s2).length !== 0 ? o$2q(t2, s2, r2) : o$2q(t2, null, r2);
} } } })], m$18.prototype, "filter", void 0), e$2g([y$1I({ json: { write: true, origins: { "web-map": n$1k, "portal-item": n$1k } } })], m$18.prototype, "includedEffect", void 0), e$2g([y$1I({ json: { write: true, origins: { "web-map": a$1m, "portal-item": a$1m } } })], m$18.prototype, "excludedEffect", void 0), e$2g([y$1I({ type: Boolean, json: { write: true, name: "showExcludedLabels", origins: { "web-map": p$1u, "portal-item": p$1u } } })], m$18.prototype, "excludedLabelsVisible", void 0), m$18 = d$K = e$2g([n$2P("esri.layers.support.FeatureEffect")], m$18);
const w$t = m$18;
const s$13 = { write: { allowNull: true } }, p$1t = (p2) => {
  let c2 = class extends p2 {
    constructor() {
      super(...arguments), this.featureEffect = null;
    }
  };
  return e$2g([y$1I({ type: w$t, json: { origins: { "web-map": s$13, "portal-item": s$13 } } })], c2.prototype, "featureEffect", void 0), c2 = e$2g([n$2P("esri.layers.mixins.FeatureEffectLayer")], c2), c2;
};
var d$J;
const p$1s = o$1_()({ orthometric: "gravity-related-height", gravity_related_height: "gravity-related-height", ellipsoidal: "ellipsoidal" }), u$V = p$1s.jsonValues.slice();
v$1d(u$V, "orthometric");
const g$D = o$1_()({ meter: "meters", foot: "feet", "us-foot": "us-feet", "clarke-foot": "clarke-feet", "clarke-yard": "clarke-yards", "clarke-link": "clarke-links", "sears-yard": "sears-yards", "sears-foot": "sears-feet", "sears-chain": "sears-chains", "benoit-1895-b-chain": "benoit-1895-b-chains", "indian-yard": "indian-yards", "indian-1937-yard": "indian-1937-yards", "gold-coast-foot": "gold-coast-feet", "sears-1922-truncated-chain": "sears-1922-truncated-chains", "50-kilometers": "50-kilometers", "150-kilometers": "150-kilometers" });
let m$17 = d$J = class extends l$2B {
  constructor(e2) {
    super(e2), this.heightModel = "gravity-related-height", this.heightUnit = "meters", this.vertCRS = null;
  }
  writeHeightModel(e2, t2, r2) {
    return p$1s.write(e2, t2, r2);
  }
  readHeightModel(e2, t2, r2) {
    const o2 = p$1s.read(e2);
    return o2 || (r2 && r2.messages && r2.messages.push(f$R(e2, { context: r2 })), null);
  }
  readHeightUnit(e2, t2, r2) {
    const o2 = g$D.read(e2);
    return o2 || (r2 && r2.messages && r2.messages.push(y$z(e2, { context: r2 })), null);
  }
  readHeightUnitService(e2, t2, r2) {
    const o2 = G$m(e2) || g$D.read(e2);
    return o2 || (r2 && r2.messages && r2.messages.push(y$z(e2, { context: r2 })), null);
  }
  readVertCRS(e2, t2) {
    return t2.vertCRS || t2.ellipsoid || t2.geoid;
  }
  clone() {
    return new d$J({ heightModel: this.heightModel, heightUnit: this.heightUnit, vertCRS: this.vertCRS });
  }
  equals(e2) {
    return !!e2 && (this === e2 || this.heightModel === e2.heightModel && this.heightUnit === e2.heightUnit && this.vertCRS === e2.vertCRS);
  }
  static deriveUnitFromSR(e2, t2) {
    const r2 = W$d(t2);
    return new d$J({ heightModel: e2.heightModel, heightUnit: r2, vertCRS: e2.vertCRS });
  }
  write(e2, t2) {
    return t2 = __spreadValues({ origin: "web-scene" }, t2), super.write(e2, t2);
  }
  static fromJSON(e2) {
    if (!e2)
      return null;
    const t2 = new d$J();
    return t2.read(e2, { origin: "web-scene" }), t2;
  }
};
function y$z(e2, t2) {
  return new t$2j("height-unit:unsupported", `Height unit of value '${e2}' is not supported`, t2);
}
function f$R(e2, t2) {
  return new t$2j("height-model:unsupported", `Height model of value '${e2}' is not supported`, t2);
}
e$2g([y$1I({ type: p$1s.apiValues, constructOnly: true, json: { origins: { "web-scene": { type: u$V, default: "ellipsoidal" } } } })], m$17.prototype, "heightModel", void 0), e$2g([r$1P("web-scene", "heightModel")], m$17.prototype, "writeHeightModel", null), e$2g([o$29(["web-scene", "service"], "heightModel")], m$17.prototype, "readHeightModel", null), e$2g([y$1I({ type: g$D.apiValues, constructOnly: true, json: { origins: { "web-scene": { type: g$D.jsonValues, write: g$D.write } } } })], m$17.prototype, "heightUnit", void 0), e$2g([o$29("web-scene", "heightUnit")], m$17.prototype, "readHeightUnit", null), e$2g([o$29("service", "heightUnit")], m$17.prototype, "readHeightUnitService", null), e$2g([y$1I({ type: String, constructOnly: true, json: { origins: { "web-scene": { write: true } } } })], m$17.prototype, "vertCRS", void 0), e$2g([o$29("service", "vertCRS", ["vertCRS", "ellipsoid", "geoid"])], m$17.prototype, "readVertCRS", null), m$17 = d$J = e$2g([n$2P("esri.geometry.HeightModelInfo")], m$17);
const v$A = m$17;
function a$1l(t2) {
  if (!t2)
    return t2;
  const { start: i2, end: o2 } = t2;
  return new T$o({ start: r$1$(i2) ? n$1G(i2, -i2.getTimezoneOffset(), "minutes") : i2, end: r$1$(o2) ? n$1G(o2, -o2.getTimezoneOffset(), "minutes") : o2 });
}
function f$Q(t2) {
  if (!t2)
    return t2;
  const { start: i2, end: o2 } = t2;
  return new T$o({ start: r$1$(i2) ? n$1G(i2, i2.getTimezoneOffset(), "minutes") : i2, end: r$1$(o2) ? n$1G(o2, o2.getTimezoneOffset(), "minutes") : o2 });
}
var i$1p;
let p$1r = i$1p = class extends l$2B {
  constructor(r2) {
    super(r2);
  }
  async collectRequiredFields(r2, e2) {
    return S$Q(r2, e2, this.expression);
  }
  clone() {
    return new i$1p({ expression: this.expression, title: this.title });
  }
  equals(r2) {
    return this.expression === r2.expression && this.title === r2.title;
  }
};
e$2g([y$1I({ type: String, json: { write: true } })], p$1r.prototype, "expression", void 0), e$2g([y$1I({ type: String, json: { write: true } })], p$1r.prototype, "title", void 0), p$1r = i$1p = e$2g([n$2P("esri.layers.support.FeatureExpressionInfo")], p$1r);
const c$1n = p$1r;
function n$1j(n2) {
  return m$1l[n2] != null;
}
function r$10(n2) {
  return 1 / (m$1l[n2] || 1);
}
function e$S() {
  const n2 = Object.keys(m$1l);
  return n2.sort(), n2;
}
const o$11 = e$S();
var m$16;
const d$I = o$1_()({ onTheGround: "on-the-ground", relativeToGround: "relative-to-ground", relativeToScene: "relative-to-scene", absoluteHeight: "absolute-height" }), c$1m = new s$2a({ foot: "feet", kilometer: "kilometers", meter: "meters", mile: "miles", "us-foot": "us-feet", yard: "yards" });
let h$N = m$16 = class extends l$2B {
  constructor(e2) {
    super(e2), this.offset = null;
  }
  readFeatureExpressionInfo(e2, r2) {
    return e2 != null ? e2 : r2.featureExpression && r2.featureExpression.value === 0 ? { expression: "0" } : void 0;
  }
  writeFeatureExpressionInfo(e2, r2, o2, t2) {
    r2[o2] = e2.write({}, t2), e2.expression === "0" && (r2.featureExpression = { value: 0 });
  }
  get mode() {
    const { offset: e2, featureExpressionInfo: r2 } = this;
    return this._isOverridden("mode") ? this._get("mode") : r$1$(e2) || r2 ? "relative-to-ground" : "on-the-ground";
  }
  set mode(e2) {
    this._override("mode", e2);
  }
  set unit(e2) {
    this._set("unit", e2);
  }
  write(e2, r2) {
    return this.offset || this.mode || this.featureExpressionInfo || this.unit ? super.write(e2, r2) : null;
  }
  clone() {
    return new m$16({ mode: this.mode, offset: this.offset, featureExpressionInfo: this.featureExpressionInfo ? this.featureExpressionInfo.clone() : void 0, unit: this.unit });
  }
  equals(e2) {
    return this.mode === e2.mode && this.offset === e2.offset && this.unit === e2.unit && y$1O(this.featureExpressionInfo, e2.featureExpressionInfo);
  }
};
e$2g([y$1I({ type: c$1n, json: { write: true } })], h$N.prototype, "featureExpressionInfo", void 0), e$2g([o$29("featureExpressionInfo", ["featureExpressionInfo", "featureExpression"])], h$N.prototype, "readFeatureExpressionInfo", null), e$2g([r$1P("featureExpressionInfo", { featureExpressionInfo: { type: c$1n }, "featureExpression.value": { type: [0] } })], h$N.prototype, "writeFeatureExpressionInfo", null), e$2g([y$1I({ type: d$I.apiValues, nonNullable: true, json: { type: d$I.jsonValues, read: d$I.read, write: { writer: d$I.write, isRequired: true } } })], h$N.prototype, "mode", null), e$2g([y$1I({ type: Number, json: { write: true } })], h$N.prototype, "offset", void 0), e$2g([y$1I({ type: o$11, json: { type: String, read: c$1m.read, write: c$1m.write } })], h$N.prototype, "unit", null), h$N = m$16 = e$2g([n$2P("esri.layers.support.ElevationInfo")], h$N);
const x$v = h$N;
const l$1g = { type: Boolean, value: true, json: { origins: { service: { read: false, write: false }, "web-map": { read: false, write: false } }, name: "screenSizePerspective", write: true } }, p$1q = { type: Boolean, value: true, json: { name: "disablePopup", read: { reader: (e2, r2) => !r2.disablePopup }, write: { enabled: true, writer(e2, r2, i2) {
  r2[i2] = !e2;
} } } }, m$15 = { type: Boolean, value: true, nonNullable: true, json: { name: "showLabels", write: true } }, f$P = { type: String, json: { origins: { "portal-item": { write: false } }, write: { isRequired: true, ignoreOrigin: true, writer: f$1w } } }, c$1l = { type: Boolean, value: true, nonNullable: true, json: { origins: { service: { read: { enabled: false } } }, name: "showLegend", write: true } }, d$H = { value: null, type: x$v, json: { origins: { service: { name: "elevationInfo", write: true } }, name: "layerDefinition.elevationInfo", write: true } };
function y$y(e2) {
  return { type: e2, readOnly: true, json: { origins: { service: { read: true } }, read: false } };
}
const w$s = { type: Number, json: { origins: { "web-document": { write: true, read: true }, "portal-item": { write: true } } } }, u$U = __spreadProps(__spreadValues({}, w$s), { json: __spreadProps(__spreadValues({}, w$s.json), { origins: { "web-document": __spreadProps(__spreadValues({}, w$s.json.origins["web-document"]), { write: { enabled: true, target: { opacity: { type: Number }, "layerDefinition.drawingInfo.transparency": { type: Number } } } }) }, read: { source: ["layerDefinition.drawingInfo.transparency", "drawingInfo.transparency"], reader: (e2, r2, i2) => i2 && i2.origin !== "service" || !r2.drawingInfo || r2.drawingInfo.transparency === void 0 ? r2.layerDefinition && r2.layerDefinition.drawingInfo && r2.layerDefinition.drawingInfo.transparency !== void 0 ? r$1w(r2.layerDefinition.drawingInfo.transparency) : void 0 : r$1w(r2.drawingInfo.transparency) } }) }), g$C = { type: T$o, readOnly: true, get() {
  var _a2, _b2;
  if (!((_a2 = this.layer) == null ? void 0 : _a2.timeInfo))
    return null;
  const { datesInUnknownTimezone: e2, timeOffset: r2, useViewTime: i2 } = this.layer, n2 = (_b2 = this.view) == null ? void 0 : _b2.timeExtent;
  let a2 = this.layer.timeExtent;
  e2 && (a2 = f$Q(a2));
  let s2 = i2 ? n2 && a2 ? n2.intersection(a2) : n2 || a2 : a2;
  if (!s2 || s2.isEmpty || s2.isAllTime)
    return s2;
  r2 && (s2 = s2.offset(-r2.value, r2.unit)), e2 && (s2 = a$1l(s2));
  const l2 = this._get("timeExtent");
  return s2.equals(l2) ? l2 : s2;
} }, b$v = { type: w$Z, readOnly: true, json: { origins: { service: { read: { source: ["fullExtent", "spatialReference"], reader: (e2, n2) => {
  const t2 = w$Z.fromJSON(e2);
  return n2.spatialReference != null && typeof n2.spatialReference == "object" && (t2.spatialReference = k$C.fromJSON(n2.spatialReference)), t2;
} } } }, read: false } }, j$m = { type: String, json: { origins: { service: { read: false }, "portal-item": { read: false } } } }, v$z = { type: Number, json: { origins: { service: { write: { enabled: false } } }, read: { source: "layerDefinition.minScale" }, write: { target: "layerDefinition.minScale" } } }, I$m = { type: Number, json: { origins: { service: { write: { enabled: false } } }, read: { source: "layerDefinition.maxScale" }, write: { target: "layerDefinition.maxScale" } } }, D$f = { json: { write: { ignoreOrigin: true }, origins: { "web-map": { read: false, write: false } } } };
let p$1p = class extends i$2R(l$2B) {
  constructor(o2) {
    super(o2);
  }
};
e$2g([y$1I({ constructOnly: true, json: { write: true } })], p$1p.prototype, "name", void 0), e$2g([y$1I({ constructOnly: true, json: { write: true } })], p$1p.prototype, "fields", void 0), e$2g([y$1I({ constructOnly: true, json: { write: true } })], p$1p.prototype, "isAscending", void 0), e$2g([y$1I({ constructOnly: true, json: { write: true } })], p$1p.prototype, "indexType", void 0), e$2g([y$1I({ constructOnly: true, json: { write: true } })], p$1p.prototype, "isUnique", void 0), e$2g([y$1I({ constructOnly: true, json: { write: true } })], p$1p.prototype, "description", void 0), p$1p = e$2g([n$2P("esri.layers.support.FeatureIndex")], p$1p);
const i$1o = new s$2a({ esriGeometryPoint: "point", esriGeometryMultipoint: "multipoint", esriGeometryPolyline: "polyline", esriGeometryPolygon: "polygon", esriGeometryMultiPatch: "multipatch" }), c$1k = { name: "supportsName", size: "supportsSize", contentType: "supportsContentType", keywords: "supportsKeywords", exifInfo: "supportsExifInfo" };
function l$1f(t2, e2, r2) {
  return !!(t2 && t2.hasOwnProperty(e2) ? t2[e2] : r2);
}
function d$G(t2, e2, r2) {
  return t2 && t2.hasOwnProperty(e2) ? t2[e2] : r2;
}
function y$x(t2) {
  var _a2;
  const e2 = (_a2 = t2 == null ? void 0 : t2.supportedSpatialAggregationStatistics) == null ? void 0 : _a2.map((t3) => t3.toLowerCase());
  return { envelope: !!(e2 == null ? void 0 : e2.includes("envelopeaggregate")), centroid: !!(e2 == null ? void 0 : e2.includes("centroidaggregate")), convexHull: !!(e2 == null ? void 0 : e2.includes("convexhullaggregate")) };
}
function m$14(t2, e2) {
  var _a2;
  const r2 = (_a2 = t2 == null ? void 0 : t2.supportedOperationsWithCacheHint) == null ? void 0 : _a2.map((t3) => t3.toLowerCase());
  return !!(r2 == null ? void 0 : r2.includes(e2.toLowerCase()));
}
function h$M(t2, e2, r2) {
  return { analytics: f$O(e2), attachment: w$r(e2), data: g$B(e2), metadata: C$m(e2), operations: b$u(e2.capabilities || t2, e2, r2), query: A$f(e2, r2), queryRelated: R$i(e2), queryTopFeatures: S$n(e2), editing: Q$a(e2) };
}
function f$O(t2) {
  return { supportsCacheHint: m$14(t2.advancedQueryCapabilities, "queryAnalytics") };
}
function w$r(t2) {
  const e2 = t2.attachmentProperties, r2 = { supportsName: false, supportsSize: false, supportsContentType: false, supportsKeywords: false, supportsExifInfo: false, supportsCacheHint: m$14(t2.advancedQueryCapabilities, "queryAttachments"), supportsResize: l$1f(t2, "supportsAttachmentsResizing", false) };
  return e2 && Array.isArray(e2) && e2.forEach((t3) => {
    const e3 = c$1k[t3.name];
    e3 && (r2[e3] = !!t3.isEnabled);
  }), r2;
}
function g$B(t2) {
  return { isVersioned: l$1f(t2, "isDataVersioned", false), supportsAttachment: l$1f(t2, "hasAttachments", false), supportsM: l$1f(t2, "hasM", false), supportsZ: l$1f(t2, "hasZ", false) };
}
function C$m(t2) {
  return { supportsAdvancedFieldProperties: l$1f(t2, "supportsFieldDescriptionProperty", false) };
}
function b$u(t2, e2, s2) {
  const a2 = t2 ? t2.toLowerCase().split(",").map((t3) => t3.trim()) : [], n2 = s2 ? m$1a(s2) : null, p2 = a2.includes(r$1$(n2) && n2.serverType === "MapServer" ? "data" : "query"), u2 = a2.includes("editing") && !e2.datesInUnknownTimezone;
  let i2 = u2 && a2.includes("create"), c2 = u2 && a2.includes("delete"), d2 = u2 && a2.includes("update");
  const y2 = a2.includes("changetracking"), m2 = e2.advancedQueryCapabilities;
  return u2 && !(i2 || c2 || d2) && (i2 = c2 = d2 = true), { supportsCalculate: l$1f(e2, "supportsCalculate", false), supportsTruncate: l$1f(e2, "supportsTruncate", false), supportsValidateSql: l$1f(e2, "supportsValidateSql", false), supportsAdd: i2, supportsDelete: c2, supportsEditing: u2, supportsChangeTracking: y2, supportsQuery: p2, supportsQueryAnalytics: l$1f(m2, "supportsQueryAnalytic", false), supportsQueryAttachments: l$1f(m2, "supportsQueryAttachments", false), supportsQueryTopFeatures: l$1f(m2, "supportsTopFeaturesQuery", false), supportsResizeAttachments: l$1f(e2, "supportsAttachmentsResizing", false), supportsSync: a2.includes("sync"), supportsUpdate: d2, supportsExceedsLimitStatistics: l$1f(e2, "supportsExceedsLimitStatistics", false) };
}
function A$f(t2, e2) {
  const r2 = t2.advancedQueryCapabilities, s2 = t2.ownershipBasedAccessControlForFeatures, o2 = t2.archivingInfo, n2 = B$g(t2), p2 = e2 == null ? void 0 : e2.includes("MapServer"), u2 = !has("mapserver-pbf-enabled") && p2 && (n2 != null ? n2 : 0) < 10.81, i2 = g$E(e2), c2 = (t2.supportedQueryFormats || "").split(",").reduce((t3, e3) => {
    const r3 = e3.toLowerCase().trim();
    return r3 && t3.add(r3), t3;
  }, new Set());
  return { supportsStatistics: l$1f(r2, "supportsStatistics", t2.supportsStatistics), supportsPercentileStatistics: l$1f(r2, "supportsPercentileStatistics", false), supportsSpatialAggregationStatistics: l$1f(r2, "supportsSpatialAggregationStatistics", false), supportedSpatialAggregationStatistics: y$x(r2), supportsCentroid: l$1f(r2, "supportsReturningGeometryCentroid", false), supportsDistance: l$1f(r2, "supportsQueryWithDistance", false), supportsDistinct: l$1f(r2, "supportsDistinct", t2.supportsAdvancedQueries), supportsExtent: l$1f(r2, "supportsReturningQueryExtent", false), supportsGeometryProperties: l$1f(r2, "supportsReturningGeometryProperties", false), supportsHavingClause: l$1f(r2, "supportsHavingClause", false), supportsOrderBy: l$1f(r2, "supportsOrderBy", t2.supportsAdvancedQueries), supportsPagination: l$1f(r2, "supportsPagination", false), supportsQuantization: l$1f(t2, "supportsCoordinatesQuantization", false), supportsQuantizationEditMode: l$1f(t2, "supportsQuantizationEditMode", false), supportsQueryGeometry: l$1f(t2, "supportsReturningQueryGeometry", false), supportsResultType: l$1f(r2, "supportsQueryWithResultType", false), supportsMaxRecordCountFactor: l$1f(r2, "supportsMaxRecordCountFactor", false), supportsSqlExpression: l$1f(r2, "supportsSqlExpression", false), supportsStandardizedQueriesOnly: l$1f(t2, "useStandardizedQueries", false), supportsTopFeaturesQuery: l$1f(r2, "supportsTopFeaturesQuery", false), supportsQueryByOthers: l$1f(s2, "allowOthersToQuery", true), supportsHistoricMoment: l$1f(o2, "supportsQueryWithHistoricMoment", false), supportsFormatPBF: !u2 && c2.has("pbf"), supportsDisjointSpatialRelationship: l$1f(r2, "supportsDisjointSpatialRel", false), supportsCacheHint: l$1f(r2, "supportsQueryWithCacheHint", false) || m$14(r2, "query"), supportsDefaultSpatialReference: l$1f(r2, "supportsDefaultSR", false), supportsCompactGeometry: i2, supportsFullTextSearch: l$1f(r2, "supportsFullTextSearch", false), maxRecordCountFactor: d$G(t2, "maxRecordCountFactor", void 0), maxRecordCount: d$G(t2, "maxRecordCount", void 0), standardMaxRecordCount: d$G(t2, "standardMaxRecordCount", void 0), tileMaxRecordCount: d$G(t2, "tileMaxRecordCount", void 0) };
}
function R$i(t2) {
  const e2 = t2.advancedQueryCapabilities, r2 = l$1f(e2, "supportsAdvancedQueryRelated", false);
  return { supportsPagination: l$1f(e2, "supportsQueryRelatedPagination", false), supportsCount: r2, supportsOrderBy: r2, supportsCacheHint: m$14(e2, "queryRelated") };
}
function S$n(t2) {
  return { supportsCacheHint: m$14(t2.advancedQueryCapabilities, "queryTopFilter") };
}
function Q$a(t2) {
  const e2 = t2.ownershipBasedAccessControlForFeatures;
  return { supportsGeometryUpdate: l$1f(t2, "allowGeometryUpdates", true), supportsGlobalId: l$1f(t2, "supportsApplyEditsWithGlobalIds", false), supportsReturnServiceEditsInSourceSpatialReference: l$1f(t2, "supportsReturnServiceEditsInSourceSR", false), supportsRollbackOnFailure: l$1f(t2, "supportsRollbackOnFailureParameter", false), supportsUpdateWithoutM: l$1f(t2, "allowUpdateWithoutMValues", false), supportsUploadWithItemId: l$1f(t2, "supportsAttachmentsByUploadId", false), supportsDeleteByAnonymous: l$1f(e2, "allowAnonymousToDelete", true), supportsDeleteByOthers: l$1f(e2, "allowOthersToDelete", true), supportsUpdateByAnonymous: l$1f(e2, "allowAnonymousToUpdate", true), supportsUpdateByOthers: l$1f(e2, "allowOthersToUpdate", true) };
}
async function F$i(e2, r2, s2, o2) {
  const { source: a2 } = await e2.load();
  if (await q$f(e2, r2, o2), !a2.addAttachment)
    throw new s$2u(o2, "Layer source does not support addAttachment capability");
  return a2.addAttachment(r2, s2);
}
function q$f(e2, r2, s2) {
  const { attributes: o2 } = r2, { objectIdField: a2 } = e2;
  return e2.get("capabilities.data.supportsAttachment") ? r2 ? o2 ? a2 && o2[a2] ? Promise.resolve() : Promise.reject(new s$2u(s2, `feature is missing the identifying attribute ${a2}`)) : Promise.reject(new s$2u(s2, "'attributes' are required on a feature to query attachments")) : Promise.reject(new s$2u(s2, "A feature is required to add/delete/update attachments")) : Promise.reject(new s$2u(s2, "this layer doesn't support attachments"));
}
async function x$u(e2, r2, s2, o2, a2) {
  const { source: n2 } = await e2.load();
  if (await q$f(e2, r2, a2), !n2.updateAttachment)
    throw new s$2u(a2, "Layer source does not support updateAttachment capability");
  return n2.updateAttachment(r2, s2, o2);
}
async function P$k(t2, e2, r2) {
  const s2 = await import("./editingSupport.js"), o2 = await t2.load();
  return s2.applyEdits(o2, o2.source, e2, r2);
}
async function O$j(e2, r2, s2, o2) {
  const { source: a2 } = await e2.load();
  if (await q$f(e2, r2, o2), !a2.deleteAttachments)
    throw new s$2u(o2, "Layer source does not support deleteAttachments capability");
  return a2.deleteAttachments(r2, s2);
}
async function v$y(e2, r2, s2) {
  const { source: o2 } = await e2.load({ signal: r2 == null ? void 0 : r2.signal });
  if (!o2.fetchRecomputedExtents)
    throw new s$2u(s2, "Layer source does not support fetchUpdates capability");
  return o2.fetchRecomputedExtents(r2);
}
async function E$s(e2, r2, s2, o2) {
  var _a2, _b2;
  r2 = c$25.from(r2);
  const { source: a2, capabilities: p2 } = await e2.load();
  if (!((_a2 = p2 == null ? void 0 : p2.data) == null ? void 0 : _a2.supportsAttachment))
    throw new s$2u(o2, "this layer doesn't support attachments");
  const { attachmentTypes: u2, objectIds: i2, globalIds: c2, num: l2, size: d2, start: y2, where: m2 } = r2;
  if (!((_b2 = p2 == null ? void 0 : p2.operations) == null ? void 0 : _b2.supportsQueryAttachments)) {
    const e3 = i2 && i2.length > 1, s3 = u2 && u2.length, a3 = c2 && c2.length, n2 = d2 && d2.length;
    if (e3 || s3 || a3 || n2 || l2 || y2 || m2)
      throw new s$2u(o2, "when 'supportsQueryAttachments' is false, only objectIds of length 1 are supported", r2);
  }
  if (!(i2 == null ? void 0 : i2.length) && !m2)
    throw new s$2u(o2, "'objectIds' or 'where' are required to perform attachment query", r2);
  if (!a2.queryAttachments)
    throw new s$2u(o2, "Layer source does not support queryAttachments capability", r2);
  return a2.queryAttachments(r2);
}
async function I$l(e2, r2, s2, o2) {
  var _a2;
  const { source: a2 } = await e2.load();
  if (!a2.queryObjectIds)
    throw new s$2u(o2, "Layer source does not support queryObjectIds capability");
  return a2.queryObjectIds((_a2 = x$z.from(r2)) != null ? _a2 : e2.createQuery(), s2);
}
async function T$g(e2, r2, s2, o2) {
  var _a2;
  const { source: a2 } = await e2.load();
  if (!a2.queryFeatureCount)
    throw new s$2u(o2, "Layer source does not support queryFeatureCount capability");
  return a2.queryFeatureCount((_a2 = x$z.from(r2)) != null ? _a2 : e2.createQuery(), s2);
}
async function j$l(e2, r2, s2, o2) {
  var _a2;
  const { source: a2 } = await e2.load();
  if (!a2.queryExtent)
    throw new s$2u(o2, "Layer source does not support queryExtent capability");
  return a2.queryExtent((_a2 = x$z.from(r2)) != null ? _a2 : e2.createQuery(), s2);
}
async function M$k(e2, r2, s2, o2) {
  const { source: a2 } = await e2.load();
  if (!a2.queryRelatedFeatures)
    throw new s$2u(o2, "Layer source does not support queryRelatedFeatures capability");
  return a2.queryRelatedFeatures(d$W.from(r2), s2);
}
async function D$e(e2, r2, s2, o2) {
  const { source: a2 } = await e2.load();
  if (!a2.queryRelatedFeaturesCount)
    throw new s$2u(o2, "Layer source does not support queryRelatedFeaturesCount capability");
  return a2.queryRelatedFeaturesCount(d$W.from(r2), s2);
}
async function G$i(t2) {
  const e2 = t2.source;
  if (e2 == null ? void 0 : e2.refresh)
    try {
      const { dataChanged: s2, updates: o2 } = await e2.refresh();
      if (r$1$(o2) && (t2.sourceJSON = __spreadValues(__spreadValues({}, t2.sourceJSON), o2), t2.read(o2, { origin: "service", url: t2.parsedUrl })), s2)
        return true;
    } catch {
    }
  if (t2.definitionExpression)
    try {
      return (await r$11(t2.definitionExpression, t2.fieldsIndex)).hasDateFunctions;
    } catch {
    }
  return false;
}
function L$h(t2) {
  const e2 = new x$z(), r2 = t2.get("capabilities.data"), s2 = t2.get("capabilities.query");
  e2.historicMoment = t2.historicMoment, e2.gdbVersion = t2.gdbVersion, e2.returnGeometry = true, s2 && (e2.compactGeometryEnabled = s2.supportsCompactGeometry, e2.defaultSpatialReferenceEnabled = s2.supportsDefaultSpatialReference), r2 && (r2.supportsZ && t2.returnZ != null && (e2.returnZ = t2.returnZ), r2.supportsM && t2.returnM != null && (e2.returnM = t2.returnM)), e2.outFields = ["*"];
  const { timeOffset: o2, timeExtent: a2 } = t2;
  return e2.timeExtent = o2 != null && a2 != null ? a2.offset(-o2.value, o2.unit) : a2 || null, e2.multipatchOption = t2.geometryType === "multipatch" ? "xyFootprint" : null, e2;
}
function z$o(t2) {
  const { globalIdField: e2, fields: r2 } = t2;
  if (e2)
    return e2;
  if (r2) {
    for (const s2 of r2)
      if (s2.type === "esriFieldTypeGlobalID")
        return s2.name;
  }
}
function U$e(t2) {
  const { objectIdField: e2, fields: r2 } = t2;
  if (e2)
    return e2;
  if (r2) {
    for (const s2 of r2)
      if (s2.type === "esriFieldTypeOID")
        return s2.name;
  }
}
function B$g(t2) {
  return t2.currentVersion ? t2.currentVersion : t2.hasOwnProperty("capabilities") || t2.hasOwnProperty("drawingInfo") || t2.hasOwnProperty("hasAttachments") || t2.hasOwnProperty("htmlPopupType") || t2.hasOwnProperty("relationships") || t2.hasOwnProperty("timeInfo") || t2.hasOwnProperty("typeIdField") || t2.hasOwnProperty("types") ? 10 : 9.3;
}
let a$1k = class extends i$2R(l$2B) {
  constructor(e2) {
    super(e2), this.shapeAreaField = null, this.shapeLengthField = null, this.units = null;
  }
};
e$2g([y$1I({ type: String, json: { read: { source: "shapeAreaFieldName" } } })], a$1k.prototype, "shapeAreaField", void 0), e$2g([y$1I({ type: String, json: { read: { source: "shapeLengthFieldName" } } })], a$1k.prototype, "shapeLengthField", void 0), e$2g([y$1I({ type: String, json: { read: (e2) => le$4.read(e2) || me$3.read(e2) } })], a$1k.prototype, "units", void 0), a$1k = e$2g([n$2P("esri.layers.support.GeometryFieldsInfo")], a$1k);
const c$1j = a$1k;
var l$1e;
let i$1n = l$1e = class extends l$2B {
  constructor(o2) {
    super(o2), this.floorField = null, this.viewAllMode = false, this.viewAllLevelIds = new j$V();
  }
  clone() {
    return new l$1e({ floorField: this.floorField, viewAllMode: this.viewAllMode, viewAllLevelIds: this.viewAllLevelIds });
  }
};
e$2g([y$1I({ type: String, json: { write: true } })], i$1n.prototype, "floorField", void 0), e$2g([y$1I({ json: { read: false, write: false } })], i$1n.prototype, "viewAllMode", void 0), e$2g([y$1I({ json: { read: false, write: false } })], i$1n.prototype, "viewAllLevelIds", void 0), i$1n = l$1e = e$2g([n$2P("esri.layers.support.LayerFloorInfo")], i$1n);
const p$1o = i$1n;
const n$1i = new s$2a({ esriRelCardinalityOneToOne: "one-to-one", esriRelCardinalityOneToMany: "one-to-many", esriRelCardinalityManyToMany: "many-to-many" }), a$1j = new s$2a({ esriRelRoleOrigin: "origin", esriRelRoleDestination: "destination" });
let l$1d = class extends i$2R(l$2B) {
  constructor(e2) {
    super(e2), this.cardinality = null, this.composite = null, this.id = null, this.keyField = null, this.keyFieldInRelationshipTable = null, this.name = null, this.relatedTableId = null, this.relationshipTableId = null, this.role = null;
  }
};
e$2g([y$1I({ json: { read: n$1i.read, write: n$1i.write } })], l$1d.prototype, "cardinality", void 0), e$2g([y$1I({ json: { read: true, write: true } })], l$1d.prototype, "composite", void 0), e$2g([y$1I({ json: { read: true, write: true } })], l$1d.prototype, "id", void 0), e$2g([y$1I({ json: { read: true, write: true } })], l$1d.prototype, "keyField", void 0), e$2g([y$1I({ json: { read: true, write: true } })], l$1d.prototype, "keyFieldInRelationshipTable", void 0), e$2g([y$1I({ json: { read: true, write: true } })], l$1d.prototype, "name", void 0), e$2g([y$1I({ json: { read: true, write: true } })], l$1d.prototype, "relatedTableId", void 0), e$2g([y$1I({ json: { read: true, write: true } })], l$1d.prototype, "relationshipTableId", void 0), e$2g([y$1I({ json: { read: a$1j.read, write: a$1j.write } })], l$1d.prototype, "role", void 0), l$1d = e$2g([n$2P("esri.layers.support.Relationship")], l$1d);
const p$1n = l$1d;
const M$j = (M2) => {
  let E2 = class extends M2 {
    constructor() {
      super(...arguments), this.capabilities = null, this.copyright = null, this.datesInUnknownTimezone = false, this.displayField = null, this.definitionExpression = null, this.editFieldsInfo = null, this.editingInfo = null, this.elevationInfo = null, this.floorInfo = null, this.fullExtent = null, this.gdbVersion = null, this.geometryFieldsInfo = null, this.geometryType = null, this.hasM = void 0, this.hasZ = void 0, this.heightModelInfo = null, this.historicMoment = null, this.isTable = false, this.layerId = void 0, this.minScale = 0, this.maxScale = 0, this.globalIdField = null, this.objectIdField = null, this.relationships = null, this.sourceJSON = null, this.returnM = void 0, this.returnZ = void 0, this.serviceDefinitionExpression = null, this.spatialReference = k$C.WGS84, this.subtypeField = null, this.trackIdField = null, this.indexes = new (j$V.ofType(p$1p))(), this.userIsAdmin = false, this.version = void 0;
    }
    readCapabilitiesFromService(e2, o2) {
      return h$M(e2, o2, this.url);
    }
    readEditingInfo(e2, o2) {
      const { editingInfo: r2 } = o2;
      return r2 ? { lastEditDate: r2.lastEditDate != null ? new Date(r2.lastEditDate) : null } : null;
    }
    readIsTableFromService(e2, o2) {
      return o2.type === "Table";
    }
    readMinScale(e2, o2) {
      return o2.effectiveMinScale || e2 || 0;
    }
    readMaxScale(e2, o2) {
      return o2.effectiveMaxScale || e2 || 0;
    }
    readGlobalIdFieldFromService(e2, o2) {
      return z$o(o2);
    }
    readObjectIdFieldFromService(e2, o2) {
      return U$e(o2);
    }
    readServiceDefinitionExpression(e2, o2) {
      return o2.definitionQuery || o2.definitionExpression;
    }
    set url(e2) {
      const o2 = L$i({ layer: this, url: e2, nonStandardUrlAllowed: true, logger: s$2z.getLogger(this.declaredClass) });
      this._set("url", o2.url), o2.layerId != null && this._set("layerId", o2.layerId);
    }
    writeUrl(e2, o2, r2, t2) {
      b$w(this, e2, null, o2, t2);
    }
    readVersion(e2, o2) {
      return B$g(o2);
    }
  };
  return e$2g([y$1I({ readOnly: true, json: { read: false, origins: { service: { read: { source: ["advancedQueryCapabilities", "allowGeometryUpdates", "allowUpdateWithoutMValues", "archivingInfo", "capabilities", "datesInUnknownTimezone", "hasAttachments", "hasM", "hasZ", "maxRecordCount", "maxRecordCountFactor", "ownershipBasedAccessControlForFeatures", "standardMaxRecordCount", "supportedQueryFormats", "supportsAdvancedQueries", "supportsApplyEditsWithGlobalIds", "supportsAttachmentsByUploadId", "supportsAttachmentsResizing", "supportsCalculate", "supportsCoordinatesQuantization", "supportsExceedsLimitStatistics", "supportsFieldDescriptionProperty", "supportsQuantizationEditMode", "supportsRollbackOnFailureParameter", "supportsStatistics", "supportsTruncate", "supportsValidateSql", "tileMaxRecordCount", "useStandardizedQueries"] } } } } })], E2.prototype, "capabilities", void 0), e$2g([o$29("service", "capabilities")], E2.prototype, "readCapabilitiesFromService", null), e$2g([y$1I({ type: String, json: { origins: { service: { read: { source: "copyrightText" } } } } })], E2.prototype, "copyright", void 0), e$2g([y$1I({ type: Boolean })], E2.prototype, "datesInUnknownTimezone", void 0), e$2g([y$1I({ type: String, json: { origins: { service: { read: { source: "displayField" } } } } })], E2.prototype, "displayField", void 0), e$2g([y$1I({ type: String, json: { origins: { service: { read: false, write: false } }, name: "layerDefinition.definitionExpression", write: { enabled: true, allowNull: true } } })], E2.prototype, "definitionExpression", void 0), e$2g([y$1I({ readOnly: true })], E2.prototype, "editFieldsInfo", void 0), e$2g([y$1I({ readOnly: true })], E2.prototype, "editingInfo", void 0), e$2g([o$29("editingInfo")], E2.prototype, "readEditingInfo", null), e$2g([y$1I((() => {
    const e2 = y$1L(d$H), o2 = e2.json.origins;
    return o2["web-map"] = { read: false, write: false }, o2["portal-item"] = { read: false, write: false }, e2;
  })())], E2.prototype, "elevationInfo", void 0), e$2g([y$1I({ type: p$1o, json: { read: { source: "layerDefinition.floorInfo" }, write: { target: "layerDefinition.floorInfo" } } })], E2.prototype, "floorInfo", void 0), e$2g([y$1I({ type: w$Z, json: { origins: { service: { read: { source: "extent" } } } } })], E2.prototype, "fullExtent", void 0), e$2g([y$1I()], E2.prototype, "gdbVersion", void 0), e$2g([y$1I({ readOnly: true, type: c$1j, json: { read: { source: "geometryProperties" } } })], E2.prototype, "geometryFieldsInfo", void 0), e$2g([y$1I({ type: ["point", "polygon", "polyline", "multipoint", "multipatch", "mesh"], json: { origins: { service: { read: i$1o.read } } } })], E2.prototype, "geometryType", void 0), e$2g([y$1I({ type: Boolean, json: { origins: { service: { read: true } } } })], E2.prototype, "hasM", void 0), e$2g([y$1I({ type: Boolean, json: { origins: { service: { read: true } } } })], E2.prototype, "hasZ", void 0), e$2g([y$1I({ readOnly: true, type: v$A })], E2.prototype, "heightModelInfo", void 0), e$2g([y$1I({ type: Date })], E2.prototype, "historicMoment", void 0), e$2g([y$1I({ readOnly: true })], E2.prototype, "isTable", void 0), e$2g([o$29("service", "isTable", ["type"])], E2.prototype, "readIsTableFromService", null), e$2g([y$1I({ type: Number, json: { origins: { service: { read: { source: "id" } }, "portal-item": { read: false, write: { target: "id" } } }, read: false } })], E2.prototype, "layerId", void 0), e$2g([y$1I(v$z)], E2.prototype, "minScale", void 0), e$2g([o$29("service", "minScale", ["minScale", "effectiveMinScale"])], E2.prototype, "readMinScale", null), e$2g([y$1I(I$m)], E2.prototype, "maxScale", void 0), e$2g([o$29("service", "maxScale", ["maxScale", "effectiveMaxScale"])], E2.prototype, "readMaxScale", null), e$2g([y$1I({ type: String })], E2.prototype, "globalIdField", void 0), e$2g([o$29("service", "globalIdField", ["globalIdField", "fields"])], E2.prototype, "readGlobalIdFieldFromService", null), e$2g([y$1I({ type: String })], E2.prototype, "objectIdField", void 0), e$2g([o$29("service", "objectIdField", ["objectIdField", "fields"])], E2.prototype, "readObjectIdFieldFromService", null), e$2g([y$1I({ type: [p$1n], readOnly: true })], E2.prototype, "relationships", void 0), e$2g([y$1I()], E2.prototype, "sourceJSON", void 0), e$2g([y$1I({ type: Boolean })], E2.prototype, "returnM", void 0), e$2g([y$1I({ type: Boolean })], E2.prototype, "returnZ", void 0), e$2g([y$1I({ readOnly: true })], E2.prototype, "serviceDefinitionExpression", void 0), e$2g([o$29("service", "serviceDefinitionExpression", ["definitionQuery", "definitionExpression"])], E2.prototype, "readServiceDefinitionExpression", null), e$2g([y$1I({ type: k$C, json: { origins: { service: { read: { source: "extent.spatialReference" } } } } })], E2.prototype, "spatialReference", void 0), e$2g([y$1I({ type: String, readOnly: true, json: { origins: { service: { read: true } } } })], E2.prototype, "subtypeField", void 0), e$2g([y$1I({ type: String, json: { read: { source: "timeInfo.trackIdField" } } })], E2.prototype, "trackIdField", void 0), e$2g([y$1I({ readOnly: true, json: { write: false } })], E2.prototype, "serverGens", void 0), e$2g([y$1I({ type: j$V.ofType(p$1p), readOnly: true })], E2.prototype, "indexes", void 0), e$2g([y$1I(f$P)], E2.prototype, "url", null), e$2g([r$1P("url")], E2.prototype, "writeUrl", null), e$2g([y$1I({ readOnly: true })], E2.prototype, "userIsAdmin", void 0), e$2g([y$1I({ json: { origins: { service: { read: true } }, read: false } })], E2.prototype, "version", void 0), e$2g([o$29("service", "version", ["currentVersion", "capabilities", "drawingInfo", "hasAttachments", "htmlPopupType", "relationships", "timeInfo", "typeIdField", "types"])], E2.prototype, "readVersion", null), E2 = e$2g([n$2P("esri.layers.mixins.FeatureLayerBase")], E2), E2;
};
let p$1m = class extends i$2R(l$2B) {
  constructor(r2) {
    super(r2), this.expression = null, this.title = null, this.returnType = null;
  }
};
e$2g([y$1I({ type: String, json: { write: true } })], p$1m.prototype, "expression", void 0), e$2g([y$1I({ type: String, json: { write: true } })], p$1m.prototype, "title", void 0), e$2g([y$1I({ type: String, json: { write: true } })], p$1m.prototype, "returnType", void 0), p$1m = e$2g([n$2P("esri.layers.support.ExpressionInfo")], p$1m);
const i$1m = p$1m;
var p$1l;
let n$1h = p$1l = class extends l$2B {
  constructor(t2) {
    super(t2), this.isAutoGenerated = false, this.name = null, this.alias = null, this.onStatisticField = null, this.onStatisticExpression = null, this.statisticType = null;
  }
  clone() {
    return new p$1l({ name: this.name, alias: this.alias, isAutoGenerated: this.isAutoGenerated, onStatisticExpression: y$1L(this.onStatisticExpression), onStatisticField: this.onStatisticField, statisticType: this.statisticType });
  }
};
e$2g([y$1I({ type: Boolean, json: { write: true } })], n$1h.prototype, "isAutoGenerated", void 0), e$2g([y$1I({ type: String, json: { write: true } })], n$1h.prototype, "name", void 0), e$2g([y$1I({ type: String, json: { write: true } })], n$1h.prototype, "alias", void 0), e$2g([y$1I({ type: String, json: { write: true } })], n$1h.prototype, "onStatisticField", void 0), e$2g([y$1I({ type: i$1m, json: { write: true } })], n$1h.prototype, "onStatisticExpression", void 0), e$2g([y$1I({ type: String, json: { write: true } })], n$1h.prototype, "statisticType", void 0), n$1h = p$1l = e$2g([n$2P("esri.layers.support.AggregateField")], n$1h);
const a$1i = n$1h;
let t$11 = class extends l$2B {
  constructor() {
    super(...arguments), this.type = null;
  }
};
e$2g([y$1I({ type: ["selection", "cluster", "binning"], readOnly: true, json: { read: false, write: true } })], t$11.prototype, "type", void 0), t$11 = e$2g([n$2P("esri.layers.support.FeatureReduction")], t$11);
const n$1g = "__begin__", r$$ = "__end__", s$12 = new RegExp(n$1g, "ig"), t$10 = new RegExp(r$$, "ig"), o$10 = new RegExp("^" + n$1g, "i"), i$1l = new RegExp(r$$ + "$", "i"), l$1c = '"', a$1h = l$1c + " + ", c$1i = " + " + l$1c;
function p$1k(e2) {
  return e2.replace(new RegExp("\\[", "g"), "{").replace(new RegExp("\\]", "g"), "}");
}
function u$T(e2) {
  return e2.replace(new RegExp("\\{", "g"), "[").replace(new RegExp("\\}", "g"), "]");
}
function x$t(e2) {
  const n2 = { expression: "", type: "none" };
  return e2.labelExpressionInfo ? e2.labelExpressionInfo.value ? (n2.expression = e2.labelExpressionInfo.value, n2.type = "conventional") : e2.labelExpressionInfo.expression && (n2.expression = e2.labelExpressionInfo.expression, n2.type = "arcade") : e2.labelExpression != null && (n2.expression = p$1k(e2.labelExpression), n2.type = "conventional"), n2;
}
function f$N(e2) {
  const n2 = x$t(e2);
  if (!n2)
    return null;
  switch (n2.type) {
    case "conventional":
      return w$q(n2.expression);
    case "arcade":
      return n2.expression;
  }
  return null;
}
function g$A(e2) {
  const n2 = x$t(e2);
  if (!n2)
    return null;
  switch (n2.type) {
    case "conventional":
      return $$6(n2.expression);
    case "arcade":
      return _$r(n2.expression);
  }
  return null;
}
function w$q(p2) {
  let u2;
  return p2 ? (u2 = n$2W(p2, (e2) => n$1g + '$feature["' + e2 + '"]' + r$$), u2 = o$10.test(u2) ? u2.replace(o$10, "") : l$1c + u2, u2 = i$1l.test(u2) ? u2.replace(i$1l, "") : u2 + l$1c, u2 = u2.replace(s$12, a$1h).replace(t$10, c$1i)) : u2 = '""', u2;
}
const E$r = /^\s*\{([^}]+)\}\s*$/i;
function $$6(e2) {
  const n2 = e2.match(E$r);
  return n2 && n2[1].trim() || null;
}
const b$t = /^\s*(?:(?:\$feature\.(\w+))|(?:\$feature\[(["'])([\w\s]+)(\2)\]));?\s*$/i, m$13 = /^\s*(?:(?:\$feature\.(\w+))|(?:\$feature\[(["'])([\w\s]+)(\2)\]));?\s*(?:DomainName\(\s*\$feature\s*,\s*(["'])(\1|\3)(\5)\s*\));?\s*$/i, R$h = /^\s*(?:DomainName\(\s*\$feature\s*,\s*(["'])([\w\s]+)(\1)\s*\));?\s*$/i;
function _$r(e2) {
  if (!e2)
    return null;
  let n2 = b$t.exec(e2) || m$13.exec(e2);
  return n2 ? n2[1] || n2[3] : (n2 = R$h.exec(e2), n2 ? n2[2] : null);
}
var l$1b;
let n$1f = l$1b = class extends l$2B {
  constructor() {
    super(...arguments), this.expression = null, this.title = null, this.value = null;
  }
  readExpression(r2, e2) {
    return e2.value ? w$q(e2.value) : r2;
  }
  writeExpression(r2, e2, s2) {
    this.value != null && (r2 = w$q(this.value)), r2 != null && (e2[s2] = r2);
  }
  clone() {
    return new l$1b({ expression: this.expression, title: this.title, value: this.value });
  }
};
e$2g([y$1I({ type: String, json: { write: { writerEnsuresNonNull: true } } })], n$1f.prototype, "expression", void 0), e$2g([o$29("expression", ["expression", "value"])], n$1f.prototype, "readExpression", null), e$2g([r$1P("expression")], n$1f.prototype, "writeExpression", null), e$2g([y$1I({ type: String, json: { write: true, origins: { "web-scene": { write: false } } } })], n$1f.prototype, "title", void 0), e$2g([y$1I({ json: { read: false, write: false } })], n$1f.prototype, "value", void 0), n$1f = l$1b = e$2g([n$2P("esri.layers.support.LabelExpressionInfo")], n$1f);
const a$1g = n$1f;
const e$R = [252, 146, 31, 255], i$1k = [153, 153, 153, 255], l$1a = { type: "esriSMS", style: "esriSMSCircle", size: 6, color: e$R, outline: { type: "esriSLS", style: "esriSLSSolid", width: 0.75, color: [153, 153, 153, 255] } }, o$$ = { type: "esriSLS", style: "esriSLSSolid", width: 0.75, color: e$R }, S$m = { type: "esriSFS", style: "esriSFSSolid", color: [252, 146, 31, 196], outline: { type: "esriSLS", style: "esriSLSSolid", width: 0.75, color: [255, 255, 255, 191] } }, t$$ = { type: "esriTS", color: [255, 255, 255, 255], font: { family: "arial-unicode-ms", size: 10, weight: "bold" }, horizontalAlignment: "center", kerning: true, haloColor: [0, 0, 0, 255], haloSize: 1, rotated: false, text: "", xoffset: 0, yoffset: 0, angle: 0 }, r$_ = { type: "esriSMS", style: "esriSMSCircle", color: [0, 0, 0, 255], outline: null, size: 10.5 }, s$11 = { type: "esriSLS", style: "esriSLSSolid", color: [0, 0, 0, 255], width: 1.5 }, y$w = { type: "esriSFS", style: "esriSFSSolid", color: [0, 0, 0, 255], outline: null };
const c$1h = y$1f.fromJSON(l$1a), u$S = m$25.fromJSON(o$$), a$1f = S$H.fromJSON(S$m), y$v = m$1O.fromJSON(t$$);
function J$g(o2) {
  if (t$2r(o2))
    return null;
  switch (o2.type) {
    case "mesh":
      return null;
    case "point":
    case "multipoint":
      return c$1h;
    case "polyline":
      return u$S;
    case "polygon":
    case "extent":
      return a$1f;
  }
  return null;
}
const N$g = y$1f.fromJSON(r$_), O$i = m$25.fromJSON(s$11), j$k = S$H.fromJSON(y$w);
var y$u;
const d$F = new s$2a({ esriServerPointLabelPlacementAboveCenter: "above-center", esriServerPointLabelPlacementAboveLeft: "above-left", esriServerPointLabelPlacementAboveRight: "above-right", esriServerPointLabelPlacementBelowCenter: "below-center", esriServerPointLabelPlacementBelowLeft: "below-left", esriServerPointLabelPlacementBelowRight: "below-right", esriServerPointLabelPlacementCenterCenter: "center-center", esriServerPointLabelPlacementCenterLeft: "center-left", esriServerPointLabelPlacementCenterRight: "center-right", esriServerLinePlacementAboveAfter: "above-after", esriServerLinePlacementAboveAlong: "above-along", esriServerLinePlacementAboveBefore: "above-before", esriServerLinePlacementAboveStart: "above-start", esriServerLinePlacementAboveEnd: "above-end", esriServerLinePlacementBelowAfter: "below-after", esriServerLinePlacementBelowAlong: "below-along", esriServerLinePlacementBelowBefore: "below-before", esriServerLinePlacementBelowStart: "below-start", esriServerLinePlacementBelowEnd: "below-end", esriServerLinePlacementCenterAfter: "center-after", esriServerLinePlacementCenterAlong: "center-along", esriServerLinePlacementCenterBefore: "center-before", esriServerLinePlacementCenterStart: "center-start", esriServerLinePlacementCenterEnd: "center-end", esriServerPolygonPlacementAlwaysHorizontal: "always-horizontal" }, { ignoreUnknown: true });
function x$s(e2) {
  var _a2;
  return !e2 || e2.origin !== "service" && !(((_a2 = e2.layer) == null ? void 0 : _a2.type) === "map-image");
}
function L$g(e2) {
  return (e2 == null ? void 0 : e2.type) === "map-image";
}
function P$j(e2) {
  var _a2, _b2;
  return !!L$g(e2) && !!((_b2 = (_a2 = e2.capabilities) == null ? void 0 : _a2.exportMap) == null ? void 0 : _b2.supportsArcadeExpressionForLabeling);
}
function g$z(e2) {
  return x$s(e2) || P$j(e2.layer);
}
let E$q = y$u = class extends l$2B {
  constructor(e2) {
    super(e2), this.type = "label", this.name = null, this.allowOverrun = false, this.deconflictionStrategy = "static", this.labelExpression = null, this.labelExpressionInfo = null, this.labelPlacement = null, this.labelPosition = "curved", this.maxScale = 0, this.minScale = 0, this.repeatLabel = true, this.repeatLabelDistance = null, this.symbol = y$v, this.useCodedValues = void 0, this.where = null;
  }
  static evaluateWhere(e2, r2) {
    const t2 = (e3, r3, t3) => {
      switch (r3) {
        case "=":
          return e3 == t3;
        case "<>":
          return e3 != t3;
        case ">":
          return e3 > t3;
        case ">=":
          return e3 >= t3;
        case "<":
          return e3 < t3;
        case "<=":
          return e3 <= t3;
      }
      return false;
    };
    try {
      if (e2 == null)
        return true;
      const o2 = e2.split(" ");
      if (o2.length === 3)
        return t2(r2[o2[0]], o2[1], o2[2]);
      if (o2.length === 7) {
        const e3 = t2(r2[o2[0]], o2[1], o2[2]), n2 = o2[3], s2 = t2(r2[o2[4]], o2[5], o2[6]);
        switch (n2) {
          case "AND":
            return e3 && s2;
          case "OR":
            return e3 || s2;
        }
      }
      return false;
    } catch (o2) {
      console.log("Error.: can't parse = " + e2);
    }
  }
  readLabelExpression(e2, r2) {
    const t2 = r2.labelExpressionInfo;
    if (!t2 || !t2.value && !t2.expression)
      return e2;
  }
  writeLabelExpression(e2, r2, t2) {
    if (this.labelExpressionInfo) {
      if (this.labelExpressionInfo.value != null)
        e2 = u$T(this.labelExpressionInfo.value);
      else if (this.labelExpressionInfo.expression != null) {
        const r3 = _$r(this.labelExpressionInfo.expression);
        r3 && (e2 = "[" + r3 + "]");
      }
    }
    e2 != null && (r2[t2] = e2);
  }
  writeLabelExpressionInfo(e2, r2, t2, o2) {
    if (e2 == null && this.labelExpression != null && x$s(o2))
      e2 = new a$1g({ expression: this.getLabelExpressionArcade() });
    else if (!e2)
      return;
    const n2 = e2.toJSON(o2);
    n2.expression && (r2[t2] = n2);
  }
  writeMaxScale(e2, r2) {
    (e2 || this.minScale) && (r2.maxScale = e2);
  }
  writeMinScale(e2, r2) {
    (e2 || this.maxScale) && (r2.minScale = e2);
  }
  getLabelExpression() {
    return x$t(this);
  }
  getLabelExpressionArcade() {
    return f$N(this);
  }
  getLabelExpressionSingleField() {
    return g$A(this);
  }
  hash() {
    return JSON.stringify(this);
  }
  clone() {
    return new y$u({ allowOverrun: this.allowOverrun, deconflictionStrategy: this.deconflictionStrategy, labelExpression: this.labelExpression, labelExpressionInfo: y$1L(this.labelExpressionInfo), labelPosition: this.labelPosition, labelPlacement: this.labelPlacement, maxScale: this.maxScale, minScale: this.minScale, name: this.name, repeatLabel: this.repeatLabel, repeatLabelDistance: this.repeatLabelDistance, symbol: y$1L(this.symbol), where: this.where, useCodedValues: this.useCodedValues });
  }
};
e$2g([y$1I({ type: String, json: { write: true } })], E$q.prototype, "name", void 0), e$2g([y$1I({ type: Boolean, json: { write: true, default: false, origins: { "web-scene": { write: false } } } })], E$q.prototype, "allowOverrun", void 0), e$2g([y$1I({ type: String, json: { write: true, default: "static", origins: { "web-scene": { write: false } } } })], E$q.prototype, "deconflictionStrategy", void 0), e$2g([y$1I({ type: String, json: { write: { overridePolicy(e2, r2, t2) {
  return this.labelExpressionInfo && (t2 == null ? void 0 : t2.origin) === "service" && P$j(t2.layer) ? { enabled: false } : { allowNull: true };
} } } })], E$q.prototype, "labelExpression", void 0), e$2g([o$29("labelExpression")], E$q.prototype, "readLabelExpression", null), e$2g([r$1P("labelExpression")], E$q.prototype, "writeLabelExpression", null), e$2g([y$1I({ type: a$1g, json: { write: { overridePolicy: (e2, r2, t2) => g$z(t2) ? { allowNull: true } : { enabled: false } } } })], E$q.prototype, "labelExpressionInfo", void 0), e$2g([r$1P("labelExpressionInfo")], E$q.prototype, "writeLabelExpressionInfo", null), e$2g([y$1I({ type: d$F.apiValues, json: { type: d$F.jsonValues, read: d$F.read, write: d$F.write } })], E$q.prototype, "labelPlacement", void 0), e$2g([y$1I({ type: ["curved", "parallel"], json: { write: true, origins: { "web-map": { write: false }, "web-scene": { write: false }, "portal-item": { write: false } } } })], E$q.prototype, "labelPosition", void 0), e$2g([y$1I({ type: Number })], E$q.prototype, "maxScale", void 0), e$2g([r$1P("maxScale")], E$q.prototype, "writeMaxScale", null), e$2g([y$1I({ type: Number })], E$q.prototype, "minScale", void 0), e$2g([r$1P("minScale")], E$q.prototype, "writeMinScale", null), e$2g([y$1I({ type: Boolean, json: { write: true, origins: { "web-scene": { write: false }, "portal-item": { write: false } } } })], E$q.prototype, "repeatLabel", void 0), e$2g([y$1I({ type: Number, cast: o$1N, json: { write: true, origins: { "web-scene": { write: false } } } })], E$q.prototype, "repeatLabelDistance", void 0), e$2g([y$1I({ types: P$v, json: { origins: { "web-scene": { types: F$t, write: c$1D, default: null } }, write: c$1D, default: null } })], E$q.prototype, "symbol", void 0), e$2g([y$1I({ type: Boolean, json: { write: true } })], E$q.prototype, "useCodedValues", void 0), e$2g([y$1I({ type: String, json: { write: true } })], E$q.prototype, "where", void 0), E$q = y$u = e$2g([n$2P("esri.layers.support.LabelClass")], E$q);
const j$j = E$q;
var v$x;
const w$p = s$2r({ types: M$z }), I$k = "esri.layers.support.FeatureReductionBinning";
let S$l = v$x = class extends t$11 {
  constructor(e2) {
    super(e2), this.type = "binning", this.binType = "geohash", this.fixedBinLevel = 3, this.labelingInfo = null, this.labelsVisible = true, this.popupEnabled = true, this.popupTemplate = null, this.fields = [], this.renderer = null;
  }
  writeFields(e2, r2, o2) {
    const t2 = e2.filter((e3) => e3.statisticType !== "avg_angle").map((e3) => e3.toJSON());
    o$2q(o2, t2, r2);
  }
  readRenderer(e2, r2, i2) {
    var _a2, _b2;
    const p2 = (_a2 = r2.drawingInfo) == null ? void 0 : _a2.renderer;
    return p2 ? (_b2 = o$17(p2, r2, i2)) != null ? _b2 : void 0 : r2.defaultSymbol ? r2.types && r2.types.length ? new C$n({ defaultSymbol: w$p(r2.defaultSymbol, r2, i2), field: r2.typeIdField, uniqueValueInfos: r2.types.map((e3) => ({ id: e3.id, symbol: w$p(e3.symbol, e3, i2) })) }) : new p$1M({ symbol: w$p(r2.defaultSymbol, r2, i2) }) : null;
  }
  clone() {
    return new v$x({ fields: y$1L(this.fields), fixedBinLevel: this.fixedBinLevel, labelingInfo: y$1L(this.labelingInfo), labelsVisible: this.labelsVisible, popupEnabled: this.popupEnabled, popupTemplate: y$1L(this.popupTemplate), renderer: y$1L(this.renderer) });
  }
};
e$2g([r$1H({ binning: "binning" })], S$l.prototype, "type", void 0), e$2g([r$1H({ geohash: "geohash" })], S$l.prototype, "binType", void 0), e$2g([y$1I({ type: Number, range: { min: 1, max: 9 }, json: { write: true } })], S$l.prototype, "fixedBinLevel", void 0), e$2g([y$1I({ type: [j$j], json: { read: { source: "drawingInfo.labelingInfo" }, write: { target: "drawingInfo.labelingInfo" } } })], S$l.prototype, "labelingInfo", void 0), e$2g([y$1I(m$15)], S$l.prototype, "labelsVisible", void 0), e$2g([y$1I(p$1q)], S$l.prototype, "popupEnabled", void 0), e$2g([y$1I({ type: k$B, json: { name: "popupInfo", write: true } })], S$l.prototype, "popupTemplate", void 0), e$2g([y$1I({ type: [a$1i], json: { write: true } })], S$l.prototype, "fields", void 0), e$2g([r$1P("fields")], S$l.prototype, "writeFields", null), e$2g([y$1I({ types: p$1I, json: { write: { target: "drawingInfo.renderer" } } })], S$l.prototype, "renderer", void 0), e$2g([o$29("renderer", ["drawingInfo.renderer"])], S$l.prototype, "readRenderer", null), S$l = v$x = e$2g([n$2P(I$k)], S$l);
const R$g = S$l;
var w$o;
const I$j = s$2r({ types: M$z }), v$w = "esri.layers.support.FeatureReductionCluster";
function R$f(e2) {
  var _a2;
  return e2.type === "simple" && !((_a2 = e2.visualVariables) == null ? void 0 : _a2.length);
}
let x$r = w$o = class extends l$2B {
  constructor(e2) {
    super(e2), this.type = "cluster", this.clusterRadius = o$1N("80px"), this.clusterMinSize = o$1N("12px"), this.clusterMaxSize = o$1N("50px"), this.popupEnabled = true, this.popupTemplate = null, this.renderer = null, this.symbol = null, this.labelingInfo = null, this.labelsVisible = true, this.fields = null;
  }
  readRenderer(e2, r2, i2) {
    var _a2, _b2, _c2;
    const p2 = (_a2 = r2.drawingInfo) == null ? void 0 : _a2.renderer;
    return ((_b2 = p2 == null ? void 0 : p2.authoringInfo) == null ? void 0 : _b2.isAutoGenerated) ? null : p2 ? R$f(p2) ? null : (_c2 = o$17(p2, r2, i2)) != null ? _c2 : void 0 : r2.defaultSymbol ? r2.types && r2.types.length ? new C$n({ defaultSymbol: I$j(r2.defaultSymbol, r2, i2), field: r2.typeIdField, uniqueValueInfos: r2.types.map((e3) => ({ id: e3.id, symbol: I$j(e3.symbol, e3, i2) })) }) : new p$1M({ symbol: I$j(r2.defaultSymbol, r2, i2) }) : null;
  }
  readSymbol(e2, r2, o2) {
    var _a2, _b2, _c2;
    const t2 = (_a2 = r2.drawingInfo) == null ? void 0 : _a2.renderer;
    if ((_b2 = t2 == null ? void 0 : t2.authoringInfo) == null ? void 0 : _b2.isAutoGenerated)
      return null;
    if (t2 && R$f(t2)) {
      return (_c2 = o$17(t2, r2, o2)) == null ? void 0 : _c2.symbol;
    }
    return null;
  }
  writeSymbol(e2, r2, t2, s2) {
    var _a2, _b2;
    const i2 = (_b2 = (_a2 = this.renderer) == null ? void 0 : _a2.authoringInfo) == null ? void 0 : _b2.isAutoGenerated;
    if (!this.renderer || i2) {
      const t3 = new p$1M({ symbol: e2 });
      r2.drawingInfo = { renderer: t3.write({}, s2) };
    }
  }
  writeFields(e2, r2, o2) {
    const t2 = e2.filter((e3) => e3.statisticType !== "avg_angle").map((e3) => e3.toJSON());
    o$2q(o2, t2, r2);
  }
  readFields(e2, r2, o2) {
    return e2.filter((e3) => !e3.isAutoGenerated).map((e3) => a$1i.fromJSON(e3));
  }
  clone() {
    return new w$o({ clusterRadius: this.clusterRadius, clusterMinSize: this.clusterMinSize, clusterMaxSize: this.clusterMaxSize, labelingInfo: y$1L(this.labelingInfo), labelsVisible: this.labelsVisible, fields: y$1L(this.fields), renderer: y$1L(this.renderer), symbol: y$1L(this.symbol), popupEnabled: this.popupEnabled, popupTemplate: y$1L(this.popupTemplate) });
  }
};
e$2g([y$1I({ type: ["cluster"], readOnly: true, json: { write: true } })], x$r.prototype, "type", void 0), e$2g([y$1I({ type: Number, cast: (e2) => e2 === "auto" ? e2 : o$1N(e2), json: { write: true } })], x$r.prototype, "clusterRadius", void 0), e$2g([y$1I({ type: Number, cast: o$1N, json: { write: true } })], x$r.prototype, "clusterMinSize", void 0), e$2g([y$1I({ type: Number, cast: o$1N, json: { write: true } })], x$r.prototype, "clusterMaxSize", void 0), e$2g([y$1I(p$1q)], x$r.prototype, "popupEnabled", void 0), e$2g([y$1I({ type: k$B, json: { read: { source: "popupInfo" }, write: { target: "popupInfo" } } })], x$r.prototype, "popupTemplate", void 0), e$2g([y$1I({ types: p$1I, json: { write: { target: "drawingInfo.renderer" } } })], x$r.prototype, "renderer", void 0), e$2g([o$29("renderer", ["drawingInfo.renderer"])], x$r.prototype, "readRenderer", null), e$2g([y$1I({ types: D$p })], x$r.prototype, "symbol", void 0), e$2g([o$29("symbol", ["drawingInfo.renderer"])], x$r.prototype, "readSymbol", null), e$2g([r$1P("symbol")], x$r.prototype, "writeSymbol", null), e$2g([y$1I({ type: [j$j], json: { read: { source: "drawingInfo.labelingInfo" }, write: { target: "drawingInfo.labelingInfo" } } })], x$r.prototype, "labelingInfo", void 0), e$2g([y$1I(m$15)], x$r.prototype, "labelsVisible", void 0), e$2g([y$1I({ type: [a$1i], json: { write: true } })], x$r.prototype, "fields", void 0), e$2g([r$1P("fields")], x$r.prototype, "writeFields", null), e$2g([o$29("fields")], x$r.prototype, "readFields", null), x$r = w$o = e$2g([n$2P(v$w)], x$r);
const z$n = x$r;
var t$_;
let c$1g = t$_ = class extends t$11 {
  constructor(r2) {
    super(r2), this.type = "selection";
  }
  clone() {
    return new t$_();
  }
};
e$2g([y$1I({ type: ["selection"] })], c$1g.prototype, "type", void 0), c$1g = t$_ = e$2g([n$2P("esri.layers.support.FeatureReductionSelection")], c$1g);
const p$1j = c$1g;
const o$_ = { key: "type", base: t$11, typeMap: { cluster: z$n, binning: R$g } }, r$Z = { types: { key: "type", base: t$11, typeMap: { selection: p$1j, cluster: z$n, binning: R$g } }, json: { name: "layerDefinition.featureReduction", write: { allowNull: true }, origins: { "web-map": { types: o$_ }, "portal-item": { types: o$_ }, "web-scene": { types: { key: "type", base: t$11, typeMap: { selection: p$1j } } } } } };
const n$1e = { Base64: 0, Hex: 1, String: 2, Raw: 3 }, t$Z = 8, r$Y = (1 << t$Z) - 1;
function e$Q(n2, t2) {
  const r2 = (65535 & n2) + (65535 & t2);
  return (n2 >> 16) + (t2 >> 16) + (r2 >> 16) << 16 | 65535 & r2;
}
function o$Z(n2) {
  const e2 = [];
  for (let o2 = 0, u2 = n2.length * t$Z; o2 < u2; o2 += t$Z)
    e2[o2 >> 5] |= (n2.charCodeAt(o2 / t$Z) & r$Y) << o2 % 32;
  return e2;
}
function u$R(n2) {
  const e2 = [];
  for (let o2 = 0, u2 = 32 * n2.length; o2 < u2; o2 += t$Z)
    e2.push(String.fromCharCode(n2[o2 >> 5] >>> o2 % 32 & r$Y));
  return e2.join("");
}
function c$1f(n2) {
  const t2 = "0123456789abcdef", r2 = [];
  for (let e2 = 0, o2 = 4 * n2.length; e2 < o2; e2++)
    r2.push(t2.charAt(n2[e2 >> 2] >> e2 % 4 * 8 + 4 & 15) + t2.charAt(n2[e2 >> 2] >> e2 % 4 * 8 & 15));
  return r2.join("");
}
function f$M(n2) {
  const t2 = "=", r2 = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/", e2 = [];
  for (let o2 = 0, u2 = 4 * n2.length; o2 < u2; o2 += 3) {
    const u3 = (n2[o2 >> 2] >> o2 % 4 * 8 & 255) << 16 | (n2[o2 + 1 >> 2] >> (o2 + 1) % 4 * 8 & 255) << 8 | n2[o2 + 2 >> 2] >> (o2 + 2) % 4 * 8 & 255;
    for (let c2 = 0; c2 < 4; c2++)
      8 * o2 + 6 * c2 > 32 * n2.length ? e2.push(t2) : e2.push(r2.charAt(u3 >> 6 * (3 - c2) & 63));
  }
  return e2.join("");
}
function s$10(n2, t2) {
  return n2 << t2 | n2 >>> 32 - t2;
}
function i$1j(n2, t2, r2, o2, u2, c2) {
  return e$Q(s$10(e$Q(e$Q(t2, n2), e$Q(o2, c2)), u2), r2);
}
function h$L(n2, t2, r2, e2, o2, u2, c2) {
  return i$1j(t2 & r2 | ~t2 & e2, n2, t2, o2, u2, c2);
}
function a$1e(n2, t2, r2, e2, o2, u2, c2) {
  return i$1j(t2 & e2 | r2 & ~e2, n2, t2, o2, u2, c2);
}
function l$19(n2, t2, r2, e2, o2, u2, c2) {
  return i$1j(t2 ^ r2 ^ e2, n2, t2, o2, u2, c2);
}
function g$y(n2, t2, r2, e2, o2, u2, c2) {
  return i$1j(r2 ^ (t2 | ~e2), n2, t2, o2, u2, c2);
}
function p$1i(n2, t2) {
  n2[t2 >> 5] |= 128 << t2 % 32, n2[14 + (t2 + 64 >>> 9 << 4)] = t2;
  let r2 = 1732584193, o2 = -271733879, u2 = -1732584194, c2 = 271733878;
  for (let f2 = 0; f2 < n2.length; f2 += 16) {
    const t3 = r2, s2 = o2, i2 = u2, p2 = c2;
    r2 = h$L(r2, o2, u2, c2, n2[f2 + 0], 7, -680876936), c2 = h$L(c2, r2, o2, u2, n2[f2 + 1], 12, -389564586), u2 = h$L(u2, c2, r2, o2, n2[f2 + 2], 17, 606105819), o2 = h$L(o2, u2, c2, r2, n2[f2 + 3], 22, -1044525330), r2 = h$L(r2, o2, u2, c2, n2[f2 + 4], 7, -176418897), c2 = h$L(c2, r2, o2, u2, n2[f2 + 5], 12, 1200080426), u2 = h$L(u2, c2, r2, o2, n2[f2 + 6], 17, -1473231341), o2 = h$L(o2, u2, c2, r2, n2[f2 + 7], 22, -45705983), r2 = h$L(r2, o2, u2, c2, n2[f2 + 8], 7, 1770035416), c2 = h$L(c2, r2, o2, u2, n2[f2 + 9], 12, -1958414417), u2 = h$L(u2, c2, r2, o2, n2[f2 + 10], 17, -42063), o2 = h$L(o2, u2, c2, r2, n2[f2 + 11], 22, -1990404162), r2 = h$L(r2, o2, u2, c2, n2[f2 + 12], 7, 1804603682), c2 = h$L(c2, r2, o2, u2, n2[f2 + 13], 12, -40341101), u2 = h$L(u2, c2, r2, o2, n2[f2 + 14], 17, -1502002290), o2 = h$L(o2, u2, c2, r2, n2[f2 + 15], 22, 1236535329), r2 = a$1e(r2, o2, u2, c2, n2[f2 + 1], 5, -165796510), c2 = a$1e(c2, r2, o2, u2, n2[f2 + 6], 9, -1069501632), u2 = a$1e(u2, c2, r2, o2, n2[f2 + 11], 14, 643717713), o2 = a$1e(o2, u2, c2, r2, n2[f2 + 0], 20, -373897302), r2 = a$1e(r2, o2, u2, c2, n2[f2 + 5], 5, -701558691), c2 = a$1e(c2, r2, o2, u2, n2[f2 + 10], 9, 38016083), u2 = a$1e(u2, c2, r2, o2, n2[f2 + 15], 14, -660478335), o2 = a$1e(o2, u2, c2, r2, n2[f2 + 4], 20, -405537848), r2 = a$1e(r2, o2, u2, c2, n2[f2 + 9], 5, 568446438), c2 = a$1e(c2, r2, o2, u2, n2[f2 + 14], 9, -1019803690), u2 = a$1e(u2, c2, r2, o2, n2[f2 + 3], 14, -187363961), o2 = a$1e(o2, u2, c2, r2, n2[f2 + 8], 20, 1163531501), r2 = a$1e(r2, o2, u2, c2, n2[f2 + 13], 5, -1444681467), c2 = a$1e(c2, r2, o2, u2, n2[f2 + 2], 9, -51403784), u2 = a$1e(u2, c2, r2, o2, n2[f2 + 7], 14, 1735328473), o2 = a$1e(o2, u2, c2, r2, n2[f2 + 12], 20, -1926607734), r2 = l$19(r2, o2, u2, c2, n2[f2 + 5], 4, -378558), c2 = l$19(c2, r2, o2, u2, n2[f2 + 8], 11, -2022574463), u2 = l$19(u2, c2, r2, o2, n2[f2 + 11], 16, 1839030562), o2 = l$19(o2, u2, c2, r2, n2[f2 + 14], 23, -35309556), r2 = l$19(r2, o2, u2, c2, n2[f2 + 1], 4, -1530992060), c2 = l$19(c2, r2, o2, u2, n2[f2 + 4], 11, 1272893353), u2 = l$19(u2, c2, r2, o2, n2[f2 + 7], 16, -155497632), o2 = l$19(o2, u2, c2, r2, n2[f2 + 10], 23, -1094730640), r2 = l$19(r2, o2, u2, c2, n2[f2 + 13], 4, 681279174), c2 = l$19(c2, r2, o2, u2, n2[f2 + 0], 11, -358537222), u2 = l$19(u2, c2, r2, o2, n2[f2 + 3], 16, -722521979), o2 = l$19(o2, u2, c2, r2, n2[f2 + 6], 23, 76029189), r2 = l$19(r2, o2, u2, c2, n2[f2 + 9], 4, -640364487), c2 = l$19(c2, r2, o2, u2, n2[f2 + 12], 11, -421815835), u2 = l$19(u2, c2, r2, o2, n2[f2 + 15], 16, 530742520), o2 = l$19(o2, u2, c2, r2, n2[f2 + 2], 23, -995338651), r2 = g$y(r2, o2, u2, c2, n2[f2 + 0], 6, -198630844), c2 = g$y(c2, r2, o2, u2, n2[f2 + 7], 10, 1126891415), u2 = g$y(u2, c2, r2, o2, n2[f2 + 14], 15, -1416354905), o2 = g$y(o2, u2, c2, r2, n2[f2 + 5], 21, -57434055), r2 = g$y(r2, o2, u2, c2, n2[f2 + 12], 6, 1700485571), c2 = g$y(c2, r2, o2, u2, n2[f2 + 3], 10, -1894986606), u2 = g$y(u2, c2, r2, o2, n2[f2 + 10], 15, -1051523), o2 = g$y(o2, u2, c2, r2, n2[f2 + 1], 21, -2054922799), r2 = g$y(r2, o2, u2, c2, n2[f2 + 8], 6, 1873313359), c2 = g$y(c2, r2, o2, u2, n2[f2 + 15], 10, -30611744), u2 = g$y(u2, c2, r2, o2, n2[f2 + 6], 15, -1560198380), o2 = g$y(o2, u2, c2, r2, n2[f2 + 13], 21, 1309151649), r2 = g$y(r2, o2, u2, c2, n2[f2 + 4], 6, -145523070), c2 = g$y(c2, r2, o2, u2, n2[f2 + 11], 10, -1120210379), u2 = g$y(u2, c2, r2, o2, n2[f2 + 2], 15, 718787259), o2 = g$y(o2, u2, c2, r2, n2[f2 + 9], 21, -343485551), r2 = e$Q(r2, t3), o2 = e$Q(o2, s2), u2 = e$Q(u2, i2), c2 = e$Q(c2, p2);
  }
  return [r2, o2, u2, c2];
}
function x$q(r2, e2 = n$1e.Hex) {
  const s2 = e2 || n$1e.Base64, i2 = p$1i(o$Z(r2), r2.length * t$Z);
  switch (s2) {
    case n$1e.Raw:
      return i2;
    case n$1e.Hex:
      return c$1f(i2);
    case n$1e.String:
      return u$R(i2);
    case n$1e.Base64:
      return f$M(i2);
  }
}
var l$18;
let n$1d = l$18 = class extends j$s {
  writeLevels(e2, s2, i2) {
    for (const t2 in e2) {
      const e3 = this.levels[t2];
      return void (s2.stops = e3);
    }
  }
  clone() {
    return new l$18({ axis: this.axis, field: this.field, valueExpression: this.valueExpression, valueExpressionTitle: this.valueExpressionTitle, maxDataValue: this.maxDataValue, maxSize: e$Z(this.maxSize) ? this.maxSize.clone() : this.maxSize, minDataValue: this.minDataValue, minSize: e$Z(this.minSize) ? this.minSize.clone() : this.minSize, normalizationField: this.normalizationField, stops: this.stops && this.stops.map((e2) => e2.clone()), target: this.target, useSymbolValue: this.useSymbolValue, valueRepresentation: this.valueRepresentation, valueUnit: this.valueUnit, legendOptions: this.legendOptions && this.legendOptions.clone(), levels: y$1L(this.levels) });
  }
};
e$2g([y$1I()], n$1d.prototype, "levels", void 0), e$2g([r$1P("levels")], n$1d.prototype, "writeLevels", null), n$1d = l$18 = e$2g([n$2P("esri.views.2d.engine.LevelDependentSizeVariable")], n$1d);
const p$1h = s$2z.getLogger("esri.views.2d.layers.support.clusterUtils");
has.add("esri-cluster-arcade-enabled", true);
const c$1e = has("esri-cluster-arcade-enabled"), d$E = (e2, r2, i2, n2, a2) => {
  const l2 = r2.clone();
  if (!g$x(l2))
    return l2;
  if (l2.authoringInfo || (l2.authoringInfo = new j$t()), l2.authoringInfo.isAutoGenerated = true, "visualVariables" in l2) {
    const r3 = (l2.visualVariables || []).filter((e3) => e3.valueExpression !== "$view.scale"), t2 = f$L(r3);
    r3.forEach((r4) => {
      r4.type === "rotation" ? r4.field ? r4.field = w$n(e2, r4.field, "avg_angle", "number") : r4.valueExpression && (r4.field = E$p(e2, r4.valueExpression, "avg_angle", "number"), r4.valueExpression = null) : r4.normalizationField ? (r4.field = w$n(e2, r4.field, "avg_norm", "number", r4.normalizationField), r4.normalizationField = null) : r4.field ? r4.field = w$n(e2, r4.field, "avg", "number") : r4.valueExpression && (r4.field = E$p(e2, r4.valueExpression, "avg", "number"), r4.valueExpression = null);
    }), t$2r(t2) && !v$v(r3) && a2 && (r3.push(b$s(i2, n2)), l2.dynamicClusterSize = true), l2.visualVariables = r3;
  }
  switch (l2.type) {
    case "simple":
      break;
    case "pie-chart":
      for (const r3 of l2.attributes)
        r3.field ? r3.field = w$n(e2, r3.field, "sum", "number") : r3.valueExpression && (r3.field = E$p(e2, r3.valueExpression, "sum", "number"), r3.valueExpression = null);
      break;
    case "unique-value":
      l2.field ? l2.field = w$n(e2, l2.field, "mode", "string") : l2.valueExpression && (l2.field = E$p(e2, l2.valueExpression, "mode", "string"), l2.valueExpression = null);
      break;
    case "class-breaks":
      l2.normalizationField ? (l2.field = w$n(e2, l2.field, "avg_norm", "number", l2.normalizationField), l2.normalizationField = null) : l2.field ? l2.field = w$n(e2, l2.field, "avg", "number") : l2.valueExpression && (l2.field = E$p(e2, l2.valueExpression, "avg", "number"), l2.valueExpression = null);
  }
  return l2;
}, f$L = (e2) => {
  for (const r2 of e2)
    if (r2.type === "size")
      return r2;
  return null;
};
function m$12(e2, r2, i2) {
  const n2 = e2.clone();
  let a2 = false;
  if ("visualVariables" in n2) {
    const e3 = (n2.visualVariables || []).filter((e4) => e4.valueExpression !== "$view.scale"), t2 = f$L(e3);
    t$2r(t2) && (n2.visualVariables || (n2.visualVariables = []), n2.visualVariables.push(b$s(r2, i2)), n2.dynamicClusterSize = true, a2 = true);
  }
  return { renderer: n2, didInject: a2 };
}
const v$v = (e2) => {
  for (const r2 of e2)
    if (r2.field === "cluster_count")
      return true;
  return false;
}, b$s = (e2, r2) => {
  const i2 = [new l$1t({ value: 0, size: 0 }), new l$1t({ value: 1 })];
  if (t$2r(r2))
    return new j$s({ field: "cluster_count", stops: [...i2, new l$1t({ value: 2, size: 0 })] });
  const n2 = Object.keys(r2).reduce((s2, n3) => __spreadProps(__spreadValues({}, s2), { [n3]: [...i2, new l$1t({ value: Math.max(2, r2[n3].minValue), size: e2.clusterMinSize }), new l$1t({ value: Math.max(3, r2[n3].maxValue), size: e2.clusterMaxSize })] }), {});
  return new n$1d({ field: "cluster_count", levels: n2 });
}, g$x = (r2) => {
  const s2 = (s3) => p$1h.error(new s$2u("Unsupported-renderer", s3, { renderer: r2 }));
  switch (r2.type) {
    case "unique-value":
      if (r2.field2 || r2.field3)
        return s2("FeatureReductionCluster does not support multi-field UniqueValueRenderers"), false;
      break;
    case "class-breaks":
      if (r2.normalizationField) {
        const e2 = r2.normalizationType;
        if (e2 !== "field")
          return s2(`FeatureReductionCluster does not support a normalizationType of ${e2}`), false;
        break;
      }
    case "simple":
    case "pie-chart":
      break;
    default:
      return s2(`FeatureReductionCluster does not support renderers of type ${r2.type}`), false;
  }
  if (!c$1e) {
    if ("valueExpression" in r2 && r2.valueExpression)
      return s2("FeatureReductionCluster does not currently support renderer.valueExpression. Support will be added in a future release"), false;
    if (("visualVariables" in r2 && r2.visualVariables || []).some((e2) => !(!("valueExpression" in e2) || !e2.valueExpression)))
      return s2("FeatureReductionCluster does not currently support visualVariables with a valueExpression. Support will be added in a future release"), false;
  }
  return true;
};
function x$p(e2, r2, s2) {
  switch (e2) {
    case "sum":
      return `cluster_sum_${r2}`;
    case "avg":
    case "avg_angle":
      return `cluster_avg_${r2}`;
    case "mode":
      return `cluster_type_${r2}`;
    case "avg_norm": {
      const e3 = s2, n2 = "field", a2 = r2.toLowerCase() + ",norm:" + n2 + "," + e3.toLowerCase();
      return "cluster_avg_" + x$q(a2);
    }
  }
}
function E$p(e2, r2, s2, t2) {
  const l2 = x$q(r2), o2 = s2 === "mode" ? `cluster_type_${l2}` : s2 === "sum" ? `cluster_sum_${l2}` : `cluster_avg_${l2}`;
  return e2.some((e3) => e3.name === o2) || e2.push(new a$1i({ name: o2, isAutoGenerated: true, onStatisticExpression: new i$1m({ expression: r2, returnType: t2 }), statisticType: s2 })), o2;
}
function w$n(e2, r2, s2, i2, t2) {
  if (r2 === "cluster_count" || e2.some((e3) => e3.name === r2))
    return r2;
  const l2 = x$p(s2, r2, t2);
  return e2.some((e3) => e3.name === l2) || (s2 === "avg_norm" ? e2.push(new a$1i({ name: l2, isAutoGenerated: true, onStatisticExpression: new i$1m({ expression: `$feature.${r2} / $feature.${t2}`, returnType: i2 }), statisticType: "avg" })) : e2.push(new a$1i({ name: l2, isAutoGenerated: true, onStatisticField: r2, statisticType: s2 }))), l2;
}
const n$1c = (n2) => {
  let u2 = class extends n2 {
    constructor(...e2) {
      super(...e2), this.own(this.watch("renderer", () => {
        if (this.featureReduction) {
          const e3 = this._normalizeFeatureReduction(this.featureReduction);
          this._set("featureReduction", e3);
        }
      }, true));
    }
    set featureReduction(e2) {
      const r2 = this._normalizeFeatureReduction(e2);
      this._set("featureReduction", r2);
    }
    set renderer(e2) {
    }
    _normalizeFeatureReduction(e2) {
      var _a2, _b2;
      if ((e2 == null ? void 0 : e2.type) !== "cluster")
        return e2;
      const r2 = e2.clone(), t2 = [new a$1i({ name: "cluster_count", isAutoGenerated: true, statisticType: "count" })], o2 = ((_a2 = r2.fields) != null ? _a2 : []).filter((e3) => !e3.isAutoGenerated);
      if (e2.renderer && !((_b2 = e2.renderer.authoringInfo) == null ? void 0 : _b2.isAutoGenerated))
        return r2.fields = [...t2, ...o2], r2;
      if (e2.symbol)
        return r2.fields = [...t2, ...o2], r2.renderer = null, r2;
      if (!this.renderer)
        return e2;
      const n3 = d$E(t2, this.renderer, e2, null, false);
      return r2.fields = [...t2, ...o2], r2.renderer = n3, r2;
    }
  };
  return e$2g([y$1I(r$Z)], u2.prototype, "featureReduction", null), u2 = e$2g([n$2P("esri.layers.mixins.FeatureReductionLayer")], u2), u2;
};
const e$P = { "web-scene/operational-layers": { ArcGISDimensionLayer: true, ArcGISFeatureLayer: true, ArcGISImageServiceLayer: true, ArcGISMapServiceLayer: true, ArcGISSceneServiceLayer: true, ArcGISTiledElevationServiceLayer: true, ArcGISTiledImageServiceLayer: true, ArcGISTiledMapServiceLayer: true, BuildingSceneLayer: true, GroupLayer: true, IntegratedMeshLayer: true, OGCFeatureLayer: true, PointCloudLayer: true, WebTiledLayer: true, CSV: true, GeoJSON: true, VectorTileLayer: true, WFS: true, WMS: true, KML: true, RasterDataLayer: true, Voxel: true, LineOfSightLayer: true }, "web-scene/basemap": { ArcGISTiledImageServiceLayer: true, ArcGISTiledMapServiceLayer: true, WebTiledLayer: true, OpenStreetMap: true, VectorTileLayer: true, ArcGISImageServiceLayer: true, WMS: true, ArcGISMapServiceLayer: true }, "web-scene/ground": { ArcGISTiledElevationServiceLayer: true, RasterDataElevationLayer: true }, "web-map/operational-layers": { ArcGISAnnotationLayer: true, ArcGISDimensionLayer: true, ArcGISFeatureLayer: true, ArcGISImageServiceLayer: true, ArcGISImageServiceVectorLayer: true, ArcGISMapServiceLayer: true, ArcGISStreamLayer: true, ArcGISTiledImageServiceLayer: true, ArcGISTiledMapServiceLayer: true, BingMapsAerial: true, BingMapsHybrid: true, BingMapsRoad: true, CSV: true, GeoRSS: true, GeoJSON: true, GroupLayer: true, KML: true, OGCFeatureLayer: true, OrientedImageryLayer: true, SubtypeGroupLayer: true, VectorTileLayer: true, WFS: true, WMS: true, WebTiledLayer: true }, "web-map/basemap": { ArcGISImageServiceLayer: true, ArcGISImageServiceVectorLayer: true, ArcGISMapServiceLayer: true, ArcGISTiledImageServiceLayer: true, ArcGISTiledMapServiceLayer: true, OpenStreetMap: true, VectorTileLayer: true, WMS: true, WebTiledLayer: true, BingMapsAerial: true, BingMapsRoad: true, BingMapsHybrid: true }, "web-map/tables": { ArcGISFeatureLayer: true }, "portal-item/operational-layers": { ArcGISFeatureLayer: true, ArcGISSceneServiceLayer: true, PointCloudLayer: true, BuildingSceneLayer: true, IntegratedMeshLayer: true, OrientedImageryLayer: true } };
const c$1d = (c2) => {
  let u2 = class extends c2 {
    constructor() {
      super(...arguments), this.title = null;
    }
    writeListMode(e2, r2, t2, o2) {
      (o2 && o2.layerContainerType === "ground" || e2 && g$1j(this, t2, {}, o2)) && (r2[t2] = e2);
    }
    writeOperationalLayerType(e2, r2, t2, o2) {
      !e2 || o2 && o2.layerContainerType === "tables" || (r2.layerType = e2);
    }
    writeTitle(e2, r2) {
      r2.title = e2 != null ? e2 : "Layer";
    }
    read(e2, r2) {
      r2 && (r2.layer = this), d$1U(this, e2, (r3) => super.read(e2, r3), r2);
    }
    write(e2, o2) {
      var _a2, _b2;
      if (o2 == null ? void 0 : o2.origin) {
        const e3 = `${o2.origin}/${o2.layerContainerType || "operational-layers"}`, t2 = e$P[e3];
        let i3 = t2 && t2[this.operationalLayerType];
        if (this.operationalLayerType === "ArcGISTiledElevationServiceLayer" && e3 === "web-scene/operational-layers" && (i3 = false), this.operationalLayerType === "ArcGISDimensionLayer" && e3 === "web-map/operational-layers" && (i3 = false), !i3)
          return (_a2 = o2.messages) == null ? void 0 : _a2.push(new s$2u("layer:unsupported", `Layers (${this.title}, ${this.id}) of type '${this.declaredClass}' are not supported in the context of '${e3}'`, { layer: this })), null;
      }
      const i2 = super.write(e2, __spreadProps(__spreadValues({}, o2), { layer: this })), s2 = !!o2 && !!o2.messages && !!o2.messages.filter((e3) => e3 instanceof s$2u && e3.name === "web-document-write:property-required").length;
      return V$m(i2 == null ? void 0 : i2.url) ? ((_b2 = o2 == null ? void 0 : o2.messages) == null ? void 0 : _b2.push(new s$2u("layer:invalid-url", `Layer (${this.title}, ${this.id}) of type '${this.declaredClass}' using a Blob URL cannot be written to web scenes and web maps`, { layer: this })), null) : !this.url && s2 ? null : i2;
    }
    beforeSave() {
    }
  };
  return e$2g([y$1I({ type: String, json: { write: { ignoreOrigin: true }, origins: { "web-scene": { write: { isRequired: true, ignoreOrigin: true } }, "portal-item": { write: false } } } })], u2.prototype, "id", void 0), e$2g([y$1I(D$f)], u2.prototype, "listMode", void 0), e$2g([r$1P("listMode")], u2.prototype, "writeListMode", null), e$2g([y$1I({ type: String, readOnly: true, json: { read: false, write: { target: "layerType", ignoreOrigin: true }, origins: { "portal-item": { write: false } } } })], u2.prototype, "operationalLayerType", void 0), e$2g([r$1P("operationalLayerType")], u2.prototype, "writeOperationalLayerType", null), e$2g([y$1I(w$s)], u2.prototype, "opacity", void 0), e$2g([y$1I({ type: String, json: { write: { ignoreOrigin: true, writerEnsuresNonNull: true }, origins: { "web-scene": { write: { isRequired: true, ignoreOrigin: true, writerEnsuresNonNull: true } }, "portal-item": { write: false } } }, value: "Layer" })], u2.prototype, "title", void 0), e$2g([r$1P("title"), r$1P(["web-scene"], "title")], u2.prototype, "writeTitle", null), e$2g([y$1I({ type: Boolean, json: { name: "visibility" } })], u2.prototype, "visible", void 0), u2 = e$2g([n$2P("esri.layers.mixins.OperationalLayer")], u2), u2;
};
var i$1i;
const p$1g = new s$2a({ asc: "ascending", desc: "descending" });
let n$1b = i$1i = class extends l$2B {
  constructor(r2) {
    super(r2), this.field = null, this.valueExpression = null, this.order = "ascending";
  }
  clone() {
    return new i$1i({ field: this.field, valueExpression: this.valueExpression, order: this.order });
  }
};
e$2g([y$1I({ type: String, json: { write: true } })], n$1b.prototype, "field", void 0), e$2g([y$1I({ type: String, json: { write: true } })], n$1b.prototype, "valueExpression", void 0), e$2g([y$1I({ type: p$1g.apiValues, json: { read: p$1g.read, write: p$1g.write } })], n$1b.prototype, "order", void 0), n$1b = i$1i = e$2g([n$2P("esri.layers.support.OrderByInfo")], n$1b);
const c$1c = n$1b;
function i$1h(r2, e2, o2) {
  if (!r2)
    return null;
  const t2 = r2.find((r3) => !!r3.field);
  if (!t2)
    return null;
  const i2 = new c$1c();
  return i2.read(t2, o2), [i2];
}
function n$1a(r2, o2, t2, s2) {
  const i2 = r2.find((r3) => !!r3.field);
  i2 && o$2q(t2, [i2.toJSON()], o2);
}
const c$1b = (e2) => {
  let c2 = class extends e2 {
    constructor() {
      super(...arguments), this.orderBy = null;
    }
  };
  return e$2g([y$1I({ type: [c$1c], json: { origins: { "web-scene": { write: false, read: false } }, read: { source: "layerDefinition.orderBy", reader: i$1h }, write: { target: "layerDefinition.orderBy", writer: n$1a } } })], c2.prototype, "orderBy", void 0), c2 = e$2g([n$2P("esri.layers.mixins.OrderedLayer")], c2), c2;
};
let h$K = class extends m$2q {
  constructor(t2) {
    super(t2), this.portalItem = null;
  }
  normalizeCtorArgs(t2) {
    return t2 && t2.portalItem && t2.path ? __spreadProps(__spreadValues({}, t2), { path: this._normalizePath(t2.path, t2.portalItem) }) : t2;
  }
  set path(t2) {
    r$1$(t2) && K$g(t2) ? s$2z.getLogger(this.declaredClass).error("portalitemresource:invalid-path", "A portal item resource path must be relative") : this._set("path", t2);
  }
  _castPath(t2) {
    return this._normalizePath(t2, this.portalItem);
  }
  get url() {
    return this.portalItem && this.path ? `${this.portalItem.itemUrl}/resources/${this.path}` : null;
  }
  get itemRelativeUrl() {
    return this.portalItem && this.path ? `./resources/${this.path}` : null;
  }
  fetch(t2 = "json", r2) {
    const o2 = this.url;
    if (t$2r(o2))
      throw new s$2u("portal-item-resource:fetch", "Portal item resource does not refer to a valid item or path");
    return this.portalItem.portal._request(o2, { responseType: t2, query: { token: this.portalItem.apiKey }, signal: q$u(r2, "signal") });
  }
  async update(t2, r2) {
    return (await import("./resourceUtils.js")).addOrUpdateResource(this, "update", t2, r2);
  }
  hasPath() {
    return r$1$(this.path);
  }
  _normalizePath(t2, r2) {
    return t$2r(t2) ? t2 : (t2 = t2.replace(/^\/+/, ""), r$1$(r2) && K$g(t2) && (t2 = _$I(t2, r2.itemUrl)), t2.replace(/^\/+/, "").replace(/^(\.\/)?resources\//, ""));
  }
};
e$2g([y$1I()], h$K.prototype, "portalItem", void 0), e$2g([y$1I({ type: String, value: null })], h$K.prototype, "path", null), e$2g([s$2i("path")], h$K.prototype, "_castPath", null), e$2g([y$1I({ type: String, readOnly: true })], h$K.prototype, "url", null), e$2g([y$1I({ type: String, readOnly: true })], h$K.prototype, "itemRelativeUrl", null), h$K = e$2g([n$2P("esri.portal.PortalItemResource")], h$K);
const n$19 = h$K;
let e$O = class extends m$2q {
  constructor(r2) {
    super(r2), this.created = null, this.rating = null;
  }
};
e$2g([y$1I()], e$O.prototype, "created", void 0), e$2g([y$1I()], e$O.prototype, "rating", void 0), e$O = e$2g([n$2P("esri.portal.PortalRating")], e$O);
const c$1a = e$O;
var f$K;
const b$r = new Set(["Map Service", "Feature Service", "Feature Collection", "Scene Service", "Image Service", "Stream Service", "Vector Tile Service", "GeoJson", "CSV", "KML", "WFS", "WMTS", "WMS", "Feed"]), k$h = new Set(["KML", "GeoJson", "CSV"]);
let S$k = f$K = class extends u$2b(m$1X) {
  constructor(e2) {
    super(e2), this.access = null, this.accessInformation = null, this.apiKey = null, this.applicationProxies = null, this.avgRating = null, this.categories = null, this.created = null, this.culture = null, this.description = null, this.extent = null, this.groupCategories = null, this.id = null, this.itemControl = null, this.licenseInfo = null, this.modified = null, this.name = null, this.numComments = null, this.numRatings = null, this.numViews = null, this.owner = null, this.ownerFolder = null, this.portal = null, this.screenshots = null, this.size = null, this.snippet = null, this.sourceJSON = null, this.spatialReference = null, this.tags = null, this.title = null, this.type = null, this.typeKeywords = null, this.url = null;
  }
  static from(e2) {
    return v$1c(f$K, e2);
  }
  destroy() {
    this.portal = null;
  }
  get displayName() {
    const e2 = this.type, t2 = this.typeKeywords || [];
    let i2 = e2;
    return e2 === "Feature Service" || e2 === "Feature Collection" ? i2 = t2.includes("Table") ? "Table" : t2.includes("Route Layer") ? "Route Layer" : t2.includes("Markup") ? "Markup" : "Feature Layer" : e2 === "Image Service" ? i2 = t2.includes("Elevation 3D Layer") ? "Elevation Layer" : t2.includes("Tiled Imagery") ? "Tiled Imagery Layer" : "Imagery Layer" : e2 === "Scene Service" ? i2 = "Scene Layer" : e2 === "Video Service" ? i2 = "Video Layer" : e2 === "Scene Package" ? i2 = "Scene Layer Package" : e2 === "Stream Service" ? i2 = "Feature Layer" : e2 === "Geoprocessing Service" && this.portal && this.portal.isPortal ? i2 = t2.includes("Web Tool") ? "Tool" : "Geoprocessing Service" : e2 === "Geocoding Service" ? i2 = "Locator" : e2 === "Geoenrichment Service" ? i2 = "GeoEnrichment Service" : e2 === "Microsoft Powerpoint" ? i2 = "Microsoft PowerPoint" : e2 === "GeoJson" ? i2 = "GeoJSON" : e2 === "Globe Service" ? i2 = "Globe Layer" : e2 === "Vector Tile Service" ? i2 = "Tile Layer" : e2 === "netCDF" ? i2 = "NetCDF" : e2 === "Map Service" ? i2 = t2.includes("Spatiotemporal") || !t2.includes("Hosted Service") && !t2.includes("Tiled") || t2.includes("Relational") ? "Map Image Layer" : "Tile Layer" : e2 && e2.toLowerCase().includes("add in") ? i2 = e2.replace(/(add in)/gi, "Add-In") : e2 === "datastore catalog service" ? i2 = "Big Data File Share" : e2 === "Compact Tile Package" ? i2 = "Tile Package (tpkx)" : e2 === "OGCFeatureServer" ? i2 = "OGC Feature Layer" : e2 === "web mapping application" && t2.includes("configurableApp") && (i2 = "Instant App"), i2;
  }
  readExtent(e2) {
    return e2 && e2.length ? new w$Z(e2[0][0], e2[0][1], e2[1][0], e2[1][1]) : null;
  }
  get iconUrl() {
    const e2 = this.type && this.type.toLowerCase() || "", i2 = this.typeKeywords || [], r2 = "esri/images/portal/", o2 = "16";
    let s2, a2 = false, n2 = false, l2 = false, p2 = false, c2 = false, d2 = false;
    return e2.indexOf("service") > 0 || e2 === "feature collection" || e2 === "kml" || e2 === "wms" || e2 === "wmts" || e2 === "wfs" ? (a2 = i2.includes("Hosted Service"), e2 === "feature service" || e2 === "feature collection" || e2 === "kml" || e2 === "wfs" ? (n2 = i2.includes("Table"), l2 = i2.includes("Route Layer"), p2 = i2.includes("Markup"), c2 = i2.includes("Spatiotemporal"), d2 = i2.includes("UtilityNetwork"), s2 = c2 && n2 ? "spatiotemporaltable" : n2 ? "table" : l2 ? "routelayer" : p2 ? "markup" : c2 ? "spatiotemporal" : a2 ? "featureshosted" : d2 ? "utilitynetwork" : "features") : s2 = e2 === "map service" || e2 === "wms" || e2 === "wmts" ? a2 || i2.includes("Tiled") || e2 === "wmts" ? "maptiles" : "mapimages" : e2 === "scene service" ? i2.includes("Line") ? "sceneweblayerline" : i2.includes("3DObject") ? "sceneweblayermultipatch" : i2.includes("Point") ? "sceneweblayerpoint" : i2.includes("IntegratedMesh") ? "sceneweblayermesh" : i2.includes("PointCloud") ? "sceneweblayerpointcloud" : i2.includes("Polygon") ? "sceneweblayerpolygon" : i2.includes("Building") ? "sceneweblayerbuilding" : i2.includes("Voxel") ? "sceneweblayervoxel" : "sceneweblayer" : e2 === "image service" ? i2.includes("Elevation 3D Layer") ? "elevationlayer" : i2.includes("Tiled Imagery") ? "tiledimagerylayer" : "imagery" : e2 === "stream service" ? "streamlayer" : e2 === "video service" ? "mediaservice" : e2 === "vector tile service" ? "vectortile" : e2 === "datastore catalog service" ? "datastorecollection" : e2 === "geocoding service" ? "geocodeservice" : e2 === "geoprocessing service" ? i2.includes("Web Tool") && this.portal && this.portal.isPortal ? "tool" : "layers" : e2 === "geodata service" ? "geodataservice" : "layers") : s2 = e2 === "web map" || e2 === "cityengine web scene" ? "maps" : e2 === "web scene" ? i2.includes("ViewingMode-Local") ? "webscenelocal" : "websceneglobal" : e2 === "web mapping application" && i2.includes("configurableApp") ? "instantapps" : e2 === "web mapping application" || e2 === "mobile application" || e2 === "application" || e2 === "operation view" || e2 === "desktop application" ? "apps" : e2 === "map document" || e2 === "map package" || e2 === "published map" || e2 === "scene document" || e2 === "globe document" || e2 === "basemap package" || e2 === "mobile basemap package" || e2 === "mobile map package" || e2 === "project package" || e2 === "project template" || e2 === "pro map" || e2 === "layout" || e2 === "layer" && i2.includes("ArcGIS Pro") || e2 === "explorer map" && i2.indexOf("Explorer Document") ? "mapsgray" : e2 === "service definition" || e2 === "csv" || e2 === "shapefile" || e2 === "cad drawing" || e2 === "geojson" || e2 === "360 vr experience" || e2 === "netcdf" || e2 === "administrative report" ? "datafiles" : e2 === "explorer add in" || e2 === "desktop add in" || e2 === "windows viewer add in" || e2 === "windows viewer configuration" ? "appsgray" : e2 === "arcgis pro add in" || e2 === "arcgis pro configuration" ? "addindesktop" : e2 === "rule package" || e2 === "file geodatabase" || e2 === "sqlite geodatabase" || e2 === "csv collection" || e2 === "kml collection" || e2 === "windows mobile package" || e2 === "map template" || e2 === "desktop application template" || e2 === "gml" || e2 === "arcpad package" || e2 === "code sample" || e2 === "form" || e2 === "document link" || e2 === "earth configuration" || e2 === "operations dashboard add in" || e2 === "rules package" || e2 === "image" || e2 === "workflow manager package" || e2 === "explorer map" && i2.includes("Explorer Mapping Application") || i2.includes("Document") ? "datafilesgray" : e2 === "network analysis service" || e2 === "geoprocessing service" || e2 === "geodata service" || e2 === "geometry service" || e2 === "geoprocessing package" || e2 === "locator package" || e2 === "geoprocessing sample" || e2 === "workflow manager service" ? "toolsgray" : e2 === "layer" || e2 === "layer package" || e2 === "explorer layer" ? "layersgray" : e2 === "scene package" ? "scenepackage" : e2 === "mobile scene package" ? "mobilescenepackage" : e2 === "tile package" || e2 === "compact tile package" ? "tilepackage" : e2 === "task file" ? "taskfile" : e2 === "report template" ? "report-template" : e2 === "statistical data collection" ? "statisticaldatacollection" : e2 === "insights workbook" ? "workbook" : e2 === "insights model" ? "insightsmodel" : e2 === "insights page" ? "insightspage" : e2 === "insights theme" ? "insightstheme" : e2 === "hub initiative" ? "hubinitiative" : e2 === "hubpage" ? "hubpage" : e2 === "hub event" ? "hubevent" : e2 === "hub site application" ? "hubsite" : e2 === "hub project" ? "hubproject" : e2 === "relational database connection" ? "relationaldatabaseconnection" : e2 === "big data file share" ? "datastorecollection" : e2 === "image collection" ? "imagecollection" : e2 === "style" ? "style" : e2 === "desktop style" ? "desktopstyle" : e2 === "dashboard" ? "dashboard" : e2 === "raster function template" ? "rasterprocessingtemplate" : e2 === "vector tile package" ? "vectortilepackage" : e2 === "ortho mapping project" ? "orthomappingproject" : e2 === "ortho mapping template" ? "orthomappingtemplate" : e2 === "solution" ? "solutions" : e2 === "geopackage" ? "geopackage" : e2 === "deep learning package" ? "deeplearningpackage" : e2 === "real time analytic" ? "realtimeanalytics" : e2 === "big data analytic" ? "bigdataanalytics" : e2 === "feed" ? "feed" : e2 === "excalibur imagery project" ? "excaliburimageryproject" : e2 === "notebook" ? "notebook" : e2 === "storymap" ? "storymap" : e2 === "survey123 add in" ? "survey123addin" : e2 === "mission" ? "mission" : e2 === "mission report" ? "missionreport" : e2 === "quickcapture project" ? "quickcaptureproject" : e2 === "pro report" ? "proreport" : e2 === "pro report template" ? "proreporttemplate" : e2 === "urban model" ? "urbanmodel" : e2 === "web experience" ? "experiencebuilder" : e2 === "web experience template" ? "webexperiencetemplate" : e2 === "experience builder widget" ? "experiencebuilderwidget" : e2 === "experience builder widget package" ? "experiencebuilderwidgetpackage" : e2 === "workflow" ? "workflow" : e2 === "insights script" ? "insightsscript" : e2 === "kernel gateway connection" ? "kernelgatewayconnection" : e2 === "hub initiative template" ? "hubinitiativetemplate" : e2 === "storymap theme" ? "storymaptheme" : e2 === "knowledge graph" ? "knowledgegraph" : e2 === "native application" ? "nativeapp" : e2 === "native application installer" ? "nativeappinstaller" : e2 === "link chart" ? "linkchart" : e2 === "investigation" ? "investigation" : e2 === "ogcfeatureserver" ? "features" : e2 === "pro project" ? "proproject" : e2 === "insights workbook package" ? "insightsworkbookpackage" : e2 === "apache parquet" ? "apacheparquet" : e2 === "notebook code snippets" || e2 === "notebook code snippet library" ? "notebookcodesnippets" : e2 === "suitability model" ? "suitabilitymodel" : e2 === "esri classifier definition" ? "classifierdefinition" : e2 === "esri classification schema" ? "classificationschema" : e2 === "insights data engineering workbook" ? "dataengineeringworkbook" : e2 === "insights data engineering model" ? "dataengineeringmodel" : e2 === "deep learning studio project" ? "deeplearningproject" : e2 === "discussion" ? "discussion" : "maps", s2 ? a$28(r2 + s2 + o2 + ".png") : null;
  }
  get isLayer() {
    return this.type != null && b$r.has(this.type);
  }
  get itemPageUrl() {
    var _a2;
    const e2 = (_a2 = this.portal) == null ? void 0 : _a2.itemPageUrl;
    return e2 && this.id ? `${e2}?id=${this.id}` : null;
  }
  get itemUrl() {
    var _a2;
    const e2 = (_a2 = this.portal) == null ? void 0 : _a2.restUrl;
    return e2 && this.id ? `${e2}/content/items/${this.id}` : null;
  }
  get thumbnailUrl() {
    var _a2, _b2;
    const e2 = this.itemUrl, t2 = this.thumbnail;
    return e2 && t2 ? (_b2 = (_a2 = this.portal) == null ? void 0 : _a2._normalizeUrl(`${e2}/info/${t2}?f=json`)) != null ? _b2 : null : null;
  }
  get userItemUrl() {
    const e2 = this.get("portal.restUrl");
    if (!e2)
      return null;
    const t2 = this.owner || this.get("portal.user.username");
    if (!t2)
      return null;
    return `${e2}/content/users/${this.ownerFolder ? `${t2}/${this.ownerFolder}` : t2}/items/${this.id}`;
  }
  load(e2) {
    var _a2;
    const t2 = (_a2 = this.portal) != null ? _a2 : this.portal = j$M.getDefault(), i2 = t2.load(e2).then(() => this.sourceJSON ? this.sourceJSON : this.id && this.itemUrl ? t2._request(this.itemUrl, { signal: r$1$(e2) ? e2.signal : null, query: { token: this.apiKey } }) : {}).then((e3) => {
      this.sourceJSON = e3, this.read(e3);
    });
    return this.addResolvingPromise(i2), Promise.resolve(this);
  }
  async addRating(e2) {
    const t2 = { method: "post", query: {} };
    return e2 instanceof c$1a && (e2 = e2.rating), e2 == null || isNaN(e2) || typeof e2 != "number" || (t2.query.rating = e2), this.portal ? (await this.portal._request(this.itemUrl + "/addRating", t2), new c$1a({ rating: e2, created: new Date() })) : null;
  }
  clone() {
    const e2 = { access: this.access, accessInformation: this.accessInformation, applicationProxies: y$1L(this.applicationProxies), avgRating: this.avgRating, categories: y$1L(this.categories), created: y$1L(this.created), culture: this.culture, description: this.description, extent: y$1L(this.extent), groupCategories: y$1L(this.groupCategories), id: this.id, itemControl: this.itemControl, licenseInfo: this.licenseInfo, modified: y$1L(this.modified), name: this.name, numComments: this.numComments, numRatings: this.numRatings, numViews: this.numViews, owner: this.owner, ownerFolder: this.ownerFolder, portal: this.portal, screenshots: y$1L(this.screenshots), size: this.size, snippet: this.snippet, spatialReference: this.spatialReference, tags: y$1L(this.tags), thumbnail: this.thumbnail, title: this.title, type: this.type, typeKeywords: y$1L(this.typeKeywords), url: this.url };
    return this.loaded && (e2.loadStatus = "loaded"), new f$K({ sourceJSON: this.sourceJSON }).set(e2);
  }
  createPostQuery() {
    const e2 = this.toJSON();
    for (const i2 of ["tags", "typeKeywords", "categories"])
      e2[i2] && (e2[i2] = e2[i2].join(", "));
    const { extent: t2 } = e2;
    return t2 && (e2.extent = JSON.stringify(t2)), e2;
  }
  async deleteRating() {
    await f$21(this.portal)._request(this.itemUrl + "/deleteRating", { method: "post" });
  }
  fetchData(e2 = "json", t2) {
    return f$21(this.portal)._request(this.itemUrl + "/data", __spreadProps(__spreadValues({ responseType: e2 }, t2), { query: { token: this.apiKey } }));
  }
  async fetchRating(e2) {
    const t2 = await f$21(this.portal)._request(this.itemUrl + "/rating", __spreadValues({ query: { token: this.apiKey } }, e2));
    return t2.rating != null ? (t2.created = new Date(t2.created), new c$1a(t2)) : null;
  }
  fetchRelatedItems(e2, t2) {
    return f$21(this.portal)._requestToTypedArray(this.itemUrl + "/relatedItems", __spreadValues({ query: __spreadProps(__spreadValues({}, e2), { token: this.apiKey }) }, t2), f$K);
  }
  getThumbnailUrl(e2) {
    let t2 = this.thumbnailUrl;
    return t2 && e2 && (t2 += `&w=${e2}`), t2;
  }
  reload() {
    var _a2;
    return f$21(this.portal)._request((_a2 = this.itemUrl) != null ? _a2 : "", { cacheBust: true, query: { token: this.apiKey } }).then((e2) => (this.sourceJSON = e2, this.read(e2), this));
  }
  update(e2) {
    return this.id ? this.load().then(() => f$21(this.portal)._signIn()).then(() => {
      const t2 = e2 && e2.data, i2 = { method: "post" };
      i2.query = this.createPostQuery();
      for (const e3 in i2.query)
        i2.query[e3] === null && (i2.query[e3] = "");
      return i2.query.clearEmptyFields = true, t2 != null && (typeof t2 == "string" ? i2.query.text = t2 : typeof t2 == "object" && (i2.query.text = JSON.stringify(t2))), this.portal._request(`${this.userItemUrl}/update`, i2).then(() => this.reload());
    }) : Promise.reject(new s$2u("portal:item-does-not-exist", "The item does not exist yet and cannot be updated"));
  }
  updateThumbnail(e2) {
    return this.id ? this.load().then(() => this.portal._signIn()).then(() => {
      const t2 = e2.thumbnail, i2 = e2.filename, r2 = { method: "post" };
      if (typeof t2 == "string")
        X$e(t2) ? r2.query = { data: t2 } : r2.query = { url: Q$h(t2) }, r$1$(i2) && (r2.query.filename = i2);
      else {
        const e3 = new FormData();
        r$1$(i2) ? e3.append("file", t2, i2) : e3.append("file", t2), r2.body = e3;
      }
      return this.portal._request(`${this.userItemUrl}/updateThumbnail`, r2).then(() => this.reload());
    }) : Promise.reject(new s$2u("portal:item-does-not-exist", "The item does not exist yet and cannot be updated"));
  }
  async fetchResources(e2 = {}, t2) {
    return (await import("./resourceUtils.js")).fetchResources(this, e2, t2);
  }
  async addResource(e2, t2, i2) {
    const r2 = await import("./resourceUtils.js");
    return e2.portalItem = this, r2.addOrUpdateResource(e2, "add", t2, i2);
  }
  async removeResource(e2, t2) {
    const r2 = await import("./resourceUtils.js");
    if (e2.portalItem && e2.portalItem.itemUrl !== this.itemUrl)
      throw new s$2u("removeresource:portal-item-mismatch", "The portal item associated with the provided resource does not match the item");
    return r2.removeResource(this, e2, t2);
  }
  async removeAllResources(e2) {
    return (await import("./resourceUtils.js")).removeAllResources(this, e2);
  }
  resourceFromPath(e2) {
    return new n$19({ portalItem: this, path: e2 });
  }
  toJSON() {
    const e2 = this.extent, t2 = { accessInformation: this.accessInformation, categories: y$1L(this.categories), created: this.created && this.created.getTime(), description: this.description, extent: e2 && [[e2.xmin, e2.ymin], [e2.xmax, e2.ymax]], id: this.id, licenseInfo: this.licenseInfo, modified: this.modified && this.modified.getTime(), name: this.name, owner: this.owner, ownerFolder: this.ownerFolder, snippet: this.snippet, spatialReference: this.spatialReference, tags: y$1L(this.tags), thumbnail: this.thumbnail, title: this.title, type: this.type, typeKeywords: y$1L(this.typeKeywords), url: this.url };
    return p$3K(t2);
  }
  static fromJSON(e2) {
    if (!e2)
      return null;
    if (e2.declaredClass)
      throw new Error("JSON object is already hydrated");
    return new f$K({ sourceJSON: e2 });
  }
  _getPostQuery() {
    const e2 = this.toJSON();
    for (const t2 in e2)
      t2 === "tags" && e2[t2] !== null && (e2[t2] = e2[t2].join(", ")), t2 === "typeKeywords" && e2[t2] !== null && (e2[t2] = e2[t2].join(", ")), t2 === "extent" && e2[t2] && (e2[t2] = JSON.stringify(e2[t2]));
    return e2;
  }
};
e$2g([y$1I({ type: ["private", "shared", "org", "public"] })], S$k.prototype, "access", void 0), e$2g([y$1I()], S$k.prototype, "accessInformation", void 0), e$2g([y$1I({ type: String })], S$k.prototype, "apiKey", void 0), e$2g([y$1I({ json: { read: { source: "appProxies" } } })], S$k.prototype, "applicationProxies", void 0), e$2g([y$1I()], S$k.prototype, "avgRating", void 0), e$2g([y$1I()], S$k.prototype, "categories", void 0), e$2g([y$1I({ type: Date })], S$k.prototype, "created", void 0), e$2g([y$1I()], S$k.prototype, "culture", void 0), e$2g([y$1I()], S$k.prototype, "description", void 0), e$2g([y$1I({ readOnly: true })], S$k.prototype, "displayName", null), e$2g([y$1I({ type: w$Z })], S$k.prototype, "extent", void 0), e$2g([o$29("extent")], S$k.prototype, "readExtent", null), e$2g([y$1I()], S$k.prototype, "groupCategories", void 0), e$2g([y$1I({ readOnly: true })], S$k.prototype, "iconUrl", null), e$2g([y$1I()], S$k.prototype, "id", void 0), e$2g([y$1I({ readOnly: true })], S$k.prototype, "isLayer", null), e$2g([y$1I()], S$k.prototype, "itemControl", void 0), e$2g([y$1I({ readOnly: true })], S$k.prototype, "itemPageUrl", null), e$2g([y$1I({ readOnly: true })], S$k.prototype, "itemUrl", null), e$2g([y$1I()], S$k.prototype, "licenseInfo", void 0), e$2g([y$1I({ type: Date })], S$k.prototype, "modified", void 0), e$2g([y$1I()], S$k.prototype, "name", void 0), e$2g([y$1I()], S$k.prototype, "numComments", void 0), e$2g([y$1I()], S$k.prototype, "numRatings", void 0), e$2g([y$1I()], S$k.prototype, "numViews", void 0), e$2g([y$1I()], S$k.prototype, "owner", void 0), e$2g([y$1I()], S$k.prototype, "ownerFolder", void 0), e$2g([y$1I({ type: j$M })], S$k.prototype, "portal", void 0), e$2g([y$1I()], S$k.prototype, "screenshots", void 0), e$2g([y$1I()], S$k.prototype, "size", void 0), e$2g([y$1I()], S$k.prototype, "snippet", void 0), e$2g([y$1I()], S$k.prototype, "sourceJSON", void 0), e$2g([y$1I({ type: String })], S$k.prototype, "spatialReference", void 0), e$2g([y$1I()], S$k.prototype, "tags", void 0), e$2g([y$1I()], S$k.prototype, "thumbnail", void 0), e$2g([y$1I({ readOnly: true })], S$k.prototype, "thumbnailUrl", null), e$2g([y$1I()], S$k.prototype, "title", void 0), e$2g([y$1I()], S$k.prototype, "type", void 0), e$2g([y$1I()], S$k.prototype, "typeKeywords", void 0), e$2g([y$1I({ type: String, json: { read(e2, t2) {
  var _a2;
  if (k$h.has(t2.type)) {
    const t3 = (_a2 = this.portal) == null ? void 0 : _a2.restUrl;
    e2 || (e2 = t3 && this.id ? `${t3}/content/items/${this.id}/data` : null);
  }
  return e2;
} } })], S$k.prototype, "url", void 0), e$2g([y$1I({ readOnly: true })], S$k.prototype, "userItemUrl", null), S$k = f$K = e$2g([n$2P("esri.portal.PortalItem")], S$k);
const x$o = S$k;
var PortalItem = /* @__PURE__ */ Object.freeze({
  __proto__: null,
  [Symbol.toStringTag]: "Module",
  "default": x$o
});
const v$u = (v2) => {
  let U2 = class extends v2 {
    constructor() {
      super(...arguments), this.resourceReferences = { portalItem: null, paths: [] }, this.userHasEditingPrivileges = true;
    }
    destroy() {
      this.portalItem = s$2D(this.portalItem);
    }
    set portalItem(t2) {
      t2 !== this._get("portalItem") && (this.removeOrigin("portal-item"), this._set("portalItem", t2));
    }
    readPortalItem(t2, e2, r2) {
      if (e2.itemId)
        return new x$o({ id: e2.itemId, portal: r2 && r2.portal });
    }
    writePortalItem(t2, e2) {
      t2 && t2.id && (e2.itemId = t2.id);
    }
    async loadFromPortal(t2, e2) {
      if (this.portalItem && this.portalItem.id)
        try {
          const r2 = await import("./layersLoader.js").then(function(n2) {
            return n2.l;
          });
          return f$1V(e2), await r2.load({ instance: this, supportedTypes: t2.supportedTypes, validateItem: t2.validateItem, supportsData: t2.supportsData, layerModuleTypeMap: t2.layerModuleTypeMap }, e2);
        } catch (r2) {
          throw j$_(r2) || s$2z.getLogger(this.declaredClass).warn(`Failed to load layer (${this.title}, ${this.id}) portal item (${this.portalItem.id})
  ${r2}`), r2;
        }
    }
    async finishLoadEditablePortalLayer(t2) {
      this._set("userHasEditingPrivileges", await this._fetchUserHasEditingPrivileges(t2).catch((t3) => (w$12(t3), true)));
    }
    async _fetchUserHasEditingPrivileges(t2) {
      const r2 = this.url ? s$1Q == null ? void 0 : s$1Q.findCredential(this.url) : null;
      if (!r2)
        return true;
      const s2 = P$i.credential === r2 ? P$i.user : await this._fetchEditingUser(t2);
      return P$i.credential = r2, P$i.user = s2, t$2r(s2) || s2.privileges == null || s2.privileges.includes("features:user:edit");
    }
    async _fetchEditingUser(t2) {
      var _a2, _b2, _c2;
      const o2 = (_b2 = (_a2 = this.portalItem) == null ? void 0 : _a2.portal) == null ? void 0 : _b2.user;
      if (o2)
        return o2;
      const i2 = s$1Q.findServerInfo((_c2 = this.url) != null ? _c2 : "");
      if (!(i2 == null ? void 0 : i2.owningSystemUrl))
        return null;
      const a2 = `${i2.owningSystemUrl}/sharing/rest`, l2 = j$M.getDefault();
      if (l2 && l2.loaded && F$v(l2.restUrl) === F$v(a2))
        return l2.user;
      const n2 = `${a2}/community/self`, m2 = r$1$(t2) ? t2.signal : null, c2 = await b$N(U$t(n2, { authMode: "no-prompt", query: { f: "json" }, signal: m2 }));
      return c2.ok ? p$2J.fromJSON(c2.value.data) : null;
    }
    read(t2, e2) {
      e2 && (e2.layer = this), super.read(t2, e2);
    }
    write(t2, e2) {
      const r2 = e2 && e2.portal, s2 = this.portalItem && this.portalItem.id && (this.portalItem.portal || j$M.getDefault());
      return r2 && s2 && !N$q(s2.restUrl, r2.restUrl) ? (e2.messages && e2.messages.push(new s$2u("layer:cross-portal", `The layer '${this.title} (${this.id})' cannot be persisted because it refers to an item on a different portal than the one being saved to. To save, set layer.portalItem to null or save to the same portal as the item associated with the layer`, { layer: this })), null) : super.write(t2, __spreadProps(__spreadValues({}, e2), { layer: this }));
    }
  };
  return e$2g([y$1I({ type: x$o })], U2.prototype, "portalItem", null), e$2g([o$29("web-document", "portalItem", ["itemId"])], U2.prototype, "readPortalItem", null), e$2g([r$1P("web-document", "portalItem", { itemId: { type: String } })], U2.prototype, "writePortalItem", null), e$2g([y$1I({ clonable: false })], U2.prototype, "resourceReferences", void 0), e$2g([y$1I({ readOnly: true })], U2.prototype, "userHasEditingPrivileges", void 0), U2 = e$2g([n$2P("esri.layers.mixins.PortalLayer")], U2), U2;
}, P$i = { credential: null, user: null };
let e$N = class extends m$2q {
  constructor() {
    super(...arguments), this.updating = false, this.status = "unknown";
  }
};
e$2g([y$1I()], e$N.prototype, "updating", void 0), e$2g([y$1I()], e$N.prototype, "status", void 0), e$N = e$2g([n$2P("esri.layers.support.PublishingInfo")], e$N);
const p$1f = e$N;
const o$Y = "esri.layers.mixins.PublishableLayer";
const u$Q = (i2) => {
  let n2 = class extends i2 {
    get publishingInfo() {
      if (this.destroyed)
        return null;
      const t2 = this._get("publishingInfo");
      if (t2)
        return t2;
      const s2 = new p$1f();
      return this._checkPublishingStatus(s2), s2;
    }
    _checkPublishingStatus(t2) {
      const s2 = 250, e2 = 125;
      let r2 = 0;
      const o2 = async (s3) => {
        let n3;
        t2.updating = true;
        try {
          n3 = await this.fetchPublishingStatus();
        } catch (u2) {
          n3 = "unavailable";
        }
        n3 !== "published" && n3 !== "unavailable" || (t2.status === "publishing" && this.refresh(), i3.remove()), t2.status = n3, t2.updating = false, i3.removed || (r2 = setTimeout(o2, s3, s3 + e2));
      }, i3 = { removed: false, remove() {
        this.removed = true, clearTimeout(r2);
      } };
      this.when().catch(() => i3.remove()), o2(s2), this.own(i3);
    }
  };
  return e$2g([y$1I({ readOnly: true, clonable: false })], n2.prototype, "publishingInfo", null), n2 = e$2g([n$2P(o$Y)], n2), n2;
};
const t$Y = new j$V(), o$X = new WeakMap();
function n$18(e2) {
  c$19(e2) && t$Y.push(e2);
}
function s$$(e2) {
  c$19(e2) && t$Y.includes(e2) && t$Y.remove(e2);
}
function c$19(e2) {
  return e2 != null && typeof e2 == "object" && "refreshInterval" in e2 && "refresh" in e2;
}
function i$1g(e2, r2) {
  return Number.isFinite(e2) && Number.isFinite(r2) ? r2 <= 0 ? e2 : i$1g(r2, e2 % r2) : 0;
}
let f$J = 0, a$1d = 0;
function l$17() {
  var _a2;
  const e2 = Date.now();
  for (const r2 of t$Y)
    if (r2.refreshInterval) {
      e2 - ((_a2 = o$X.get(r2)) != null ? _a2 : 0) + 5 >= 6e4 * r2.refreshInterval && (o$X.set(r2, e2), r2.refresh(e2));
    }
}
l$2D(() => {
  const e2 = Date.now();
  let r2 = 0;
  for (const n2 of t$Y)
    r2 = i$1g(Math.round(6e4 * n2.refreshInterval), r2), n2.refreshInterval ? o$X.get(n2) || o$X.set(n2, e2) : o$X.delete(n2);
  if (r2 !== a$1d) {
    if (a$1d = r2, clearInterval(f$J), a$1d === 0)
      return void (f$J = 0);
    f$J = setInterval(l$17, a$1d);
  }
});
const p$1e = (n2) => {
  let p2 = class extends n2 {
    constructor(...e2) {
      super(...e2), this.refreshInterval = 0, this.refreshTimestamp = 0, this._debounceHasDataChanged = x$14(() => this.hasDataChanged()), this.when().then(() => {
        n$18(this);
      }, () => {
      });
    }
    destroy() {
      s$$(this);
    }
    get refreshParameters() {
      return { _ts: this.refreshTimestamp || null };
    }
    refresh(e2 = Date.now()) {
      g$1m(this._debounceHasDataChanged()).then((r2) => {
        r2 && this._set("refreshTimestamp", e2), this.emit("refresh", { dataChanged: r2 });
      }, (e3) => {
        s$2z.getLogger(this.declaredClass).error(e3), this.emit("refresh", { dataChanged: false, error: e3 });
      });
    }
    async hasDataChanged() {
      return true;
    }
  };
  return e$2g([y$1I({ type: Number, cast: (e2) => e2 >= 0.1 ? e2 : e2 <= 0 ? 0 : 0.1, json: { write: true } })], p2.prototype, "refreshInterval", void 0), e$2g([y$1I({ readOnly: true })], p2.prototype, "refreshTimestamp", void 0), e$2g([y$1I()], p2.prototype, "refreshParameters", null), p2 = e$2g([n$2P("esri.layers.mixins.RefreshableLayer")], p2), p2;
};
const t$X = (t2) => {
  let l2 = class extends t2 {
    constructor() {
      super(...arguments), this.minScale = 0, this.maxScale = 0;
    }
    get effectiveScaleRange() {
      const e2 = { minScale: this.minScale, maxScale: this.maxScale }, a2 = this.parent;
      a2 && "effectiveScaleRange" in a2 && r$X(e2, a2.effectiveScaleRange);
      const c2 = this._get("effectiveScaleRange");
      return c2 && c2.minScale === e2.minScale && c2.maxScale === e2.maxScale ? c2 : e2;
    }
  };
  return e$2g([y$1I({ type: Number, nonNullable: true, json: { write: true } })], l2.prototype, "minScale", void 0), e$2g([y$1I({ type: Number, nonNullable: true, json: { write: true } })], l2.prototype, "maxScale", void 0), e$2g([y$1I({ readOnly: true })], l2.prototype, "effectiveScaleRange", null), l2 = e$2g([n$2P("esri.layers.mixins.ScaleRangeLayer")], l2), l2;
};
function r$X(e2, a2) {
  return e2.minScale = e2.minScale > 0 ? a2.minScale > 0 ? Math.min(e2.minScale, a2.minScale) : e2.minScale : a2.minScale, e2.maxScale = e2.maxScale > 0 ? a2.maxScale > 0 ? Math.max(e2.maxScale, a2.maxScale) : e2.maxScale : a2.maxScale, e2;
}
const e$M = o$1_()({ esriTimeUnitsMilliseconds: "milliseconds", esriTimeUnitsSeconds: "seconds", esriTimeUnitsMinutes: "minutes", esriTimeUnitsHours: "hours", esriTimeUnitsDays: "days", esriTimeUnitsWeeks: "weeks", esriTimeUnitsMonths: "months", esriTimeUnitsYears: "years", esriTimeUnitsDecades: "decades", esriTimeUnitsCenturies: "centuries", esriTimeUnitsUnknown: void 0 });
var p$1d;
let a$1c = p$1d = class extends l$2B {
  constructor(r2) {
    super(r2), this.value = 0, this.unit = "milliseconds";
  }
  toMilliseconds() {
    return g$N(this.value, this.unit, "milliseconds");
  }
  clone() {
    return new p$1d({ value: this.value, unit: this.unit });
  }
};
e$2g([y$1I({ type: Number, json: { write: true }, nonNullable: true })], a$1c.prototype, "value", void 0), e$2g([y$1I({ type: e$M.apiValues, json: { type: e$M.jsonValues, read: e$M.read, write: e$M.write }, nonNullable: true })], a$1c.prototype, "unit", void 0), a$1c = p$1d = e$2g([n$2P("esri.TimeInterval")], a$1c);
const l$16 = a$1c;
var i$1f;
let a$1b = i$1f = class extends l$2B {
  constructor(e2) {
    super(e2), this.respectsDaylightSaving = false, this.timezone = null;
  }
  readRespectsDaylightSaving(e2, t2) {
    return t2.respectsDaylightSaving !== void 0 ? t2.respectsDaylightSaving : t2.respectDaylightSaving !== void 0 && t2.respectDaylightSaving;
  }
  clone() {
    const { respectsDaylightSaving: e2, timezone: t2 } = this;
    return new i$1f({ respectsDaylightSaving: e2, timezone: t2 });
  }
};
e$2g([y$1I({ type: Boolean, json: { write: true } })], a$1b.prototype, "respectsDaylightSaving", void 0), e$2g([o$29("respectsDaylightSaving", ["respectsDaylightSaving", "respectDaylightSaving"])], a$1b.prototype, "readRespectsDaylightSaving", null), e$2g([y$1I({ type: String, json: { read: { source: "timeZone" }, write: { target: "timeZone" } } })], a$1b.prototype, "timezone", void 0), a$1b = i$1f = e$2g([n$2P("esri.layers.support.TimeReference")], a$1b);
const p$1c = a$1b;
var d$D;
let c$18 = d$D = class extends l$2B {
  constructor(e2) {
    super(e2), this.cumulative = false, this.endField = null, this.fullTimeExtent = null, this.hasLiveData = false, this.interval = null, this.startField = null, this.timeReference = null, this.trackIdField = null, this.useTime = true;
  }
  readFullTimeExtent(e2, r2) {
    if (!r2.timeExtent || !Array.isArray(r2.timeExtent) || r2.timeExtent.length !== 2)
      return null;
    const i2 = new Date(r2.timeExtent[0]), l2 = new Date(r2.timeExtent[1]);
    return new T$o({ start: i2, end: l2 });
  }
  writeFullTimeExtent(e2, t2) {
    e2 && r$1$(e2.start) && r$1$(e2.end) ? t2.timeExtent = [e2.start.getTime(), e2.end.getTime()] : t2.timeExtent = null;
  }
  readInterval(e2, t2) {
    return t2.timeInterval && t2.timeIntervalUnits ? new l$16({ value: t2.timeInterval, unit: e$M.fromJSON(t2.timeIntervalUnits) }) : t2.defaultTimeInterval && t2.defaultTimeIntervalUnits ? new l$16({ value: t2.defaultTimeInterval, unit: e$M.fromJSON(t2.defaultTimeIntervalUnits) }) : null;
  }
  writeInterval(e2, t2) {
    if (e2) {
      const r2 = e2.toJSON();
      t2.timeInterval = r2.value, t2.timeIntervalUnits = r2.unit;
    } else
      t2.timeInterval = null, t2.timeIntervalUnits = null;
  }
  clone() {
    const { cumulative: e2, endField: t2, hasLiveData: r2, interval: i2, startField: o2, timeReference: n2, fullTimeExtent: a2, trackIdField: s2, useTime: m2 } = this;
    return new d$D({ cumulative: e2, endField: t2, hasLiveData: r2, interval: i2, startField: o2, timeReference: y$1L(n2), fullTimeExtent: y$1L(a2), trackIdField: s2, useTime: m2 });
  }
};
e$2g([y$1I({ type: Boolean, json: { read: { source: "exportOptions.timeDataCumulative" }, write: { target: "exportOptions.timeDataCumulative" } } })], c$18.prototype, "cumulative", void 0), e$2g([y$1I({ type: String, json: { read: { source: "endTimeField" }, write: { target: "endTimeField", allowNull: true } } })], c$18.prototype, "endField", void 0), e$2g([y$1I({ type: T$o, json: { write: { enabled: true, allowNull: true } } })], c$18.prototype, "fullTimeExtent", void 0), e$2g([o$29("fullTimeExtent", ["timeExtent"])], c$18.prototype, "readFullTimeExtent", null), e$2g([r$1P("fullTimeExtent")], c$18.prototype, "writeFullTimeExtent", null), e$2g([y$1I({ type: Boolean, json: { write: true } })], c$18.prototype, "hasLiveData", void 0), e$2g([y$1I({ type: l$16, json: { write: { enabled: true, allowNull: true } } })], c$18.prototype, "interval", void 0), e$2g([o$29("interval", ["timeInterval", "timeIntervalUnits", "defaultTimeInterval", "defaultTimeIntervalUnits"])], c$18.prototype, "readInterval", null), e$2g([r$1P("interval")], c$18.prototype, "writeInterval", null), e$2g([y$1I({ type: String, json: { read: { source: "startTimeField" }, write: { target: "startTimeField", allowNull: true } } })], c$18.prototype, "startField", void 0), e$2g([y$1I({ type: p$1c, json: { write: { enabled: true, allowNull: true } } })], c$18.prototype, "timeReference", void 0), e$2g([y$1I({ type: String, json: { write: { enabled: true, allowNull: true } } })], c$18.prototype, "trackIdField", void 0), e$2g([y$1I({ type: Boolean, json: { read: { source: "exportOptions.useTime" }, write: { target: "exportOptions.useTime" } } })], c$18.prototype, "useTime", void 0), c$18 = d$D = e$2g([n$2P("esri.layers.support.TimeInfo")], c$18);
const v$t = c$18;
const a$1a = (a2) => {
  let f2 = class extends a2 {
    constructor() {
      super(...arguments), this.timeExtent = null, this.timeOffset = null, this.useViewTime = true;
    }
    readOffset(e2, t2) {
      const o2 = t2.timeInfo.exportOptions;
      if (!o2)
        return null;
      const i2 = o2.timeOffset, s2 = e$M.fromJSON(o2.timeOffsetUnits);
      return i2 && s2 ? new l$16({ value: i2, unit: s2 }) : null;
    }
    set timeInfo(e2) {
      x$V(e2, this.fieldsIndex), this._set("timeInfo", e2);
    }
  };
  return e$2g([y$1I({ type: T$o, json: { write: false } })], f2.prototype, "timeExtent", void 0), e$2g([y$1I({ type: l$16 })], f2.prototype, "timeOffset", void 0), e$2g([o$29("service", "timeOffset", ["timeInfo.exportOptions"])], f2.prototype, "readOffset", null), e$2g([y$1I({ value: null, type: v$t, json: { write: true, origins: { "web-document": { read: false, write: false }, "portal-item": { read: false, write: false } } } })], f2.prototype, "timeInfo", null), e$2g([y$1I({ type: Boolean, json: { read: { source: "timeAnimation" }, write: { target: "timeAnimation" }, origins: { "web-scene": { read: false, write: false } } } })], f2.prototype, "useViewTime", void 0), f2 = e$2g([n$2P("esri.layers.mixins.TemporalLayer")], f2), f2;
};
const l$15 = new s$2a({ esriFeatureEditToolAutoCompletePolygon: "auto-complete-polygon", esriFeatureEditToolCircle: "circle", esriFeatureEditToolEllipse: "ellipse", esriFeatureEditToolFreehand: "freehand", esriFeatureEditToolLine: "line", esriFeatureEditToolNone: "none", esriFeatureEditToolPoint: "point", esriFeatureEditToolPolygon: "polygon", esriFeatureEditToolRectangle: "rectangle", esriFeatureEditToolArrow: "arrow", esriFeatureEditToolTriangle: "triangle", esriFeatureEditToolLeftArrow: "left-arrow", esriFeatureEditToolRightArrow: "right-arrow", esriFeatureEditToolUpArrow: "up-arrow", esriFeatureEditToolDownArrow: "down-arrow" });
let a$19 = class extends i$2R(l$2B) {
  constructor(o2) {
    super(o2), this.name = null, this.description = null, this.drawingTool = null, this.prototype = null, this.thumbnail = null;
  }
};
e$2g([y$1I({ json: { write: true } })], a$19.prototype, "name", void 0), e$2g([y$1I({ json: { write: true } })], a$19.prototype, "description", void 0), e$2g([y$1I({ json: { read: l$15.read, write: l$15.write } })], a$19.prototype, "drawingTool", void 0), e$2g([y$1I({ json: { write: true } })], a$19.prototype, "prototype", void 0), e$2g([y$1I({ json: { write: true } })], a$19.prototype, "thumbnail", void 0), a$19 = e$2g([n$2P("esri.layers.support.FeatureTemplate")], a$19);
const p$1b = a$19;
let c$17 = class extends i$2R(l$2B) {
  constructor(o2) {
    super(o2), this.id = null, this.name = null, this.domains = null, this.templates = null;
  }
  readDomains(o2) {
    const r2 = {};
    for (const t2 of Object.keys(o2))
      r2[t2] = t$1h(o2[t2]);
    return r2;
  }
  writeDomains(o2, r2) {
    var _a2;
    const t2 = {};
    for (const s2 of Object.keys(o2))
      o2[s2] && (t2[s2] = (_a2 = o2[s2]) == null ? void 0 : _a2.toJSON());
    r2.domains = t2;
  }
};
e$2g([y$1I({ json: { write: true } })], c$17.prototype, "id", void 0), e$2g([y$1I({ json: { write: true } })], c$17.prototype, "name", void 0), e$2g([y$1I({ json: { write: true } })], c$17.prototype, "domains", void 0), e$2g([o$29("domains")], c$17.prototype, "readDomains", null), e$2g([r$1P("domains")], c$17.prototype, "writeDomains", null), e$2g([y$1I({ type: [p$1b], json: { write: true } })], c$17.prototype, "templates", void 0), c$17 = e$2g([n$2P("esri.layers.support.FeatureType")], c$17);
const n$17 = c$17;
function s$_(e2) {
  return e2.type === "date" || e2.type === "esriFieldTypeDate";
}
function l$14(e2) {
  return e2.type === "oid" || e2.type === "esriFieldTypeOID";
}
function d$C(e2) {
  return e2.type === "global-id" || e2.type === "esriFieldTypeGlobalID";
}
class r$W {
  constructor(i2 = []) {
    if (this.fields = [], this._fieldsMap = new Map(), this._normalizedFieldsMap = new Map(), this._dateFieldsSet = new Set(), this._numericFieldsSet = new Set(), this.dateFields = [], this.numericFields = [], this._requiredFields = null, !i2)
      return;
    this.fields = i2;
    const t2 = [];
    for (const r2 of i2) {
      const i3 = r2 && r2.name;
      if (i3) {
        const u2 = n$16(i3), h2 = a$18(i3);
        this._fieldsMap.set(i3, r2), this._fieldsMap.set(u2, r2), this._normalizedFieldsMap.set(h2, r2), t2.push(u2), s$_(r2) ? (this.dateFields.push(r2), this._dateFieldsSet.add(r2)) : ie$6(r2) && (this._numericFieldsSet.add(r2), this.numericFields.push(r2)), l$14(r2) || d$C(r2) || (r2.editable = r2.editable == null || !!r2.editable, r2.nullable = r2.nullable == null || !!r2.nullable);
      }
    }
    t2.sort(), this.uid = t2.join(",");
  }
  destroy() {
    this._fieldsMap.clear();
  }
  get requiredFields() {
    if (!this._requiredFields) {
      this._requiredFields = [];
      for (const e2 of this.fields)
        l$14(e2) || d$C(e2) || e2.nullable || M$H(e2) !== void 0 || this._requiredFields.push(e2);
    }
    return this._requiredFields;
  }
  has(e2) {
    return this.get(e2) != null;
  }
  get(e2) {
    var _a2;
    if (!e2)
      return;
    let i2 = this._fieldsMap.get(e2);
    return i2 || (i2 = (_a2 = this._fieldsMap.get(n$16(e2))) != null ? _a2 : this._normalizedFieldsMap.get(a$18(e2)), i2 && this._fieldsMap.set(e2, i2), i2);
  }
  isDateField(e2) {
    return this._dateFieldsSet.has(this.get(e2));
  }
  isNumericField(e2) {
    return this._numericFieldsSet.has(this.get(e2));
  }
  normalizeFieldName(e2) {
    var _a2;
    const i2 = this.get(e2);
    if (i2)
      return (_a2 = i2.name) != null ? _a2 : void 0;
  }
}
function n$16(e2) {
  return e2.trim().toLowerCase();
}
function a$18(e2) {
  return p$3s(e2).toLowerCase();
}
function s$Z() {
  return { fields: { type: [y$Y], value: null }, fieldsIndex: { readOnly: true, get() {
    return new r$W(this.fields || []);
  } }, outFields: { type: [String], json: { read: false }, set: function(e2) {
    this._userOutFields = e2, this.notifyChange("outFields");
  }, get: function() {
    var _a2;
    const i2 = this._userOutFields;
    if (!i2 || !i2.length)
      return null;
    if (i2.includes("*"))
      return ["*"];
    if (!this.fields)
      return i2;
    for (const t2 of i2) {
      const r2 = (_a2 = this.fieldsIndex) == null ? void 0 : _a2.has(t2);
      r2 || s$2z.getLogger("esri.layers.support.fieldProperties").error("field-attributes-layer:invalid-field", `Invalid field ${t2} found in outFields`, { layer: this, outFields: i2 });
    }
    return T$C(this.fieldsIndex, i2);
  } } };
}
const n$15 = s$2z.getLogger("esri.layers.support.labelingInfo"), l$13 = /\[([^\[\]]+)\]/gi;
function i$1e(e2, r2, o2) {
  return e2 ? e2.map((e3) => {
    const n2 = new j$j();
    if (n2.read(e3, o2), n2.labelExpression) {
      const e4 = r2.fields || r2.layerDefinition && r2.layerDefinition.fields || this.fields;
      n2.labelExpression = n2.labelExpression.replace(l$13, (r3, o3) => `[${s$Y(o3, e4)}]`);
    }
    return n2;
  }) : null;
}
function s$Y(e2, r2) {
  if (!r2)
    return e2;
  const o2 = e2.toLowerCase();
  for (let t2 = 0; t2 < r2.length; t2++) {
    const e3 = r2[t2].name;
    if (e3.toLowerCase() === o2)
      return e3;
  }
  return e2;
}
const a$17 = { esriGeometryPoint: ["above-right", "above-center", "above-left", "center-center", "center-left", "center-right", "below-center", "below-left", "below-right"], esriGeometryPolygon: ["always-horizontal"], esriGeometryPolyline: ["center-along"], esriGeometryMultipoint: null };
function c$16(e2, o2) {
  const t2 = y$1L(e2);
  return t2.some((e3) => f$I(e3, o2)) ? [] : t2;
}
function f$I(r2, o2) {
  const t2 = r2.labelPlacement, l2 = a$17[o2];
  if (!r2.symbol)
    return n$15.warn("No ILabelClass symbol specified."), true;
  if (!l2)
    return n$15.error(new s$2u("labeling:unsupported-geometry-type", `Unable to create labels for layer, geometry type '${o2}' is not supported`)), true;
  if (!l2.includes(t2)) {
    const e2 = l2[0];
    t2 && n$15.warn(`Found invalid label placement type ${t2} for ${o2}. Defaulting to ${e2}`), r2.labelPlacement = e2;
  }
  return false;
}
const t$W = [];
function e$L(e2, r2) {
  var _a2, _b2;
  if (g$E((_a2 = e2.url) != null ? _a2 : ""))
    return true;
  const { wkid: o2 } = r2;
  for (const d2 of t$W) {
    if (((_b2 = e2.version) != null ? _b2 : 0) >= d2[0])
      return true;
    if (typeof d2[1] == "function" && (d2[1] = d2[1]()), d2[1].has(o2))
      return false;
  }
  return true;
}
t$W.push([10.91, () => {
  const d2 = new Set([9709, 9716, 9741, 9761, 9766]);
  for (let t2 = 9712; t2 <= 9713; t2++)
    d2.add(t2);
  for (let t2 = 9748; t2 <= 9749; t2++)
    d2.add(t2);
  for (let t2 = 20904; t2 <= 20932; t2++)
    d2.add(t2);
  for (let t2 = 21004; t2 <= 21032; t2++)
    d2.add(t2);
  for (let t2 = 21207; t2 <= 21264; t2++)
    d2.add(t2);
  for (let t2 = 21307; t2 <= 21364; t2++)
    d2.add(t2);
  for (let t2 = 102759; t2 <= 102760; t2++)
    d2.add(t2);
  for (let t2 = 102901; t2 <= 102955; t2++)
    d2.add(t2);
  return d2;
}]), t$W.push([10.9, () => {
  const d2 = new Set([9300, 9354, 9364, 9367, 9373, 9377, 9387, 9456, 9473, 9498, 9678, 9680, 29874, 103599, 103872, 104028]);
  for (let t2 = 9356; t2 <= 9360; t2++)
    d2.add(t2);
  for (let t2 = 9404; t2 <= 9407; t2++)
    d2.add(t2);
  for (let t2 = 9476; t2 <= 9482; t2++)
    d2.add(t2);
  for (let t2 = 9487; t2 <= 9494; t2++)
    d2.add(t2);
  for (let t2 = 9697; t2 <= 9699; t2++)
    d2.add(t2);
  return d2;
}]), t$W.push([10.81, () => {
  const d2 = new Set([9265, 9333, 103598, 103699]);
  for (let t2 = 9248; t2 <= 9254; t2++)
    d2.add(t2);
  for (let t2 = 9271; t2 <= 9273; t2++)
    d2.add(t2);
  for (let t2 = 9284; t2 <= 9285; t2++)
    d2.add(t2);
  for (let t2 = 21453; t2 <= 21463; t2++)
    d2.add(t2);
  return d2;
}]), t$W.push([10.8, () => {
  const d2 = new Set([8088, 8395, 8428, 8433, 8531, 8687, 8692, 8694, 8699, 8900, 9003, 9006, 9009, 9012, 9017, 9191]);
  for (let t2 = 8035; t2 <= 8036; t2++)
    d2.add(t2);
  for (let t2 = 8455; t2 <= 8456; t2++)
    d2.add(t2);
  for (let t2 = 8518; t2 <= 8529; t2++)
    d2.add(t2);
  for (let t2 = 8533; t2 <= 8536; t2++)
    d2.add(t2);
  for (let t2 = 8538; t2 <= 8540; t2++)
    d2.add(t2);
  for (let t2 = 8677; t2 <= 8679; t2++)
    d2.add(t2);
  for (let t2 = 8902; t2 <= 8903; t2++)
    d2.add(t2);
  for (let t2 = 8907; t2 <= 8910; t2++)
    d2.add(t2);
  for (let t2 = 8949; t2 <= 8951; t2++)
    d2.add(t2);
  for (let t2 = 8972; t2 <= 8987; t2++)
    d2.add(t2);
  for (let t2 = 9039; t2 <= 9040; t2++)
    d2.add(t2);
  for (let t2 = 9068; t2 <= 9069; t2++)
    d2.add(t2);
  for (let t2 = 9140; t2 <= 9141; t2++)
    d2.add(t2);
  for (let t2 = 9148; t2 <= 9150; t2++)
    d2.add(t2);
  for (let t2 = 9153; t2 <= 9159; t2++)
    d2.add(t2);
  for (let t2 = 9205; t2 <= 9218; t2++)
    d2.add(t2);
  for (let t2 = 9221; t2 <= 9222; t2++)
    d2.add(t2);
  for (let t2 = 54098; t2 <= 54101; t2++)
    d2.add(t2);
  return d2;
}]), t$W.push([10.71, () => {
  const d2 = new Set([6316]);
  for (let t2 = 8351; t2 <= 8353; t2++)
    d2.add(t2);
  for (let t2 = 9294; t2 <= 9297; t2++)
    d2.add(t2);
  for (let t2 = 103586; t2 <= 103594; t2++)
    d2.add(t2);
  for (let t2 = 103696; t2 <= 103698; t2++)
    d2.add(t2);
  return d2;
}]), t$W.push([10.7, () => {
  const d2 = new Set([8387, 8391, 8427, 8545, 8682, 8685, 8818, 31370, 104022, 104024, 104975]);
  for (let t2 = 8065; t2 <= 8068; t2++)
    d2.add(t2);
  for (let t2 = 8082; t2 <= 8083; t2++)
    d2.add(t2);
  for (let t2 = 8379; t2 <= 8385; t2++)
    d2.add(t2);
  for (let t2 = 8836; t2 <= 8840; t2++)
    d2.add(t2);
  for (let t2 = 8857; t2 <= 8860; t2++)
    d2.add(t2);
  for (let t2 = 53035; t2 <= 53037; t2++)
    d2.add(t2);
  for (let t2 = 54090; t2 <= 54091; t2++)
    d2.add(t2);
  for (let t2 = 102498; t2 <= 102499; t2++)
    d2.add(t2);
  return d2;
}]), t$W.push([10.61, () => new Set([102497])]), t$W.push([10.6, () => {
  const d2 = new Set([7803, 7805, 7887, 8086, 8232, 8237, 8240, 8246, 8249, 8252, 8255, 9019, 9391]);
  for (let t2 = 7755; t2 <= 7787; t2++)
    d2.add(t2);
  for (let t2 = 7791; t2 <= 7795; t2++)
    d2.add(t2);
  for (let t2 = 7799; t2 <= 7801; t2++)
    d2.add(t2);
  for (let t2 = 7825; t2 <= 7831; t2++)
    d2.add(t2);
  for (let t2 = 7877; t2 <= 7878; t2++)
    d2.add(t2);
  for (let t2 = 7882; t2 <= 7883; t2++)
    d2.add(t2);
  for (let t2 = 7991; t2 <= 7992; t2++)
    d2.add(t2);
  for (let t2 = 8042; t2 <= 8043; t2++)
    d2.add(t2);
  for (let t2 = 8058; t2 <= 8059; t2++)
    d2.add(t2);
  for (let t2 = 8311; t2 <= 8348; t2++)
    d2.add(t2);
  for (let t2 = 9060; t2 <= 9067; t2++)
    d2.add(t2);
  for (let t2 = 102562; t2 <= 102568; t2++)
    d2.add(t2);
  for (let t2 = 102799; t2 <= 102900; t2++)
    d2.add(t2);
  return d2;
}]), t$W.push([10.51, () => {
  const d2 = new Set([7683, 7881, 7886, 7899, 8888, 9e3]);
  for (let t2 = 8013; t2 <= 8032; t2++)
    d2.add(t2);
  for (let t2 = 9053; t2 <= 9057; t2++)
    d2.add(t2);
  for (let t2 = 104017; t2 <= 104018; t2++)
    d2.add(t2);
  for (let t2 = 104971; t2 <= 104974; t2++)
    d2.add(t2);
  return d2;
}]), t$W.push([10.5, () => {
  const d2 = new Set([6962, 7035, 7037, 7039, 7041, 7084, 7086, 7133, 7798, 102399]);
  for (let t2 = 4087; t2 <= 4088; t2++)
    d2.add(t2);
  for (let t2 = 5896; t2 <= 5899; t2++)
    d2.add(t2);
  for (let t2 = 7005; t2 <= 7007; t2++)
    d2.add(t2);
  for (let t2 = 7057; t2 <= 7070; t2++)
    d2.add(t2);
  for (let t2 = 7073; t2 <= 7082; t2++)
    d2.add(t2);
  for (let t2 = 7109; t2 <= 7128; t2++)
    d2.add(t2);
  for (let t2 = 7844; t2 <= 7859; t2++)
    d2.add(t2);
  return d2;
}]);
async function t$V(t2, i2, n2) {
  const s2 = t2 && t2.getAtOrigin && t2.getAtOrigin("renderer", i2.origin);
  if (s2 && s2.type === "unique-value" && s2.styleOrigin) {
    const a2 = await b$N(s2.populateFromStyle());
    if (f$1V(n2), a2.ok === false) {
      const e2 = a2.error;
      i2 && i2.messages && i2.messages.push(new t$2j("renderer:style-reference", `Failed to create unique value renderer from style reference: ${e2.message}`, { error: e2, context: i2 })), t2.clear("renderer", i2 == null ? void 0 : i2.origin);
    }
  }
}
const l$12 = ["oid", "global-id"], a$16 = ["oid", "global-id", "guid"];
function p$1a({ displayField: t2, editFieldsInfo: n2, fields: i2, objectIdField: o2, title: r2 }, s2) {
  if (!i2)
    return null;
  const l2 = g$w({ editFieldsInfo: n2, fields: i2, objectIdField: o2 }, s2);
  if (!l2.length)
    return null;
  const a2 = L$f({ titleBase: r2, fields: i2, displayField: t2 }), p2 = I$i();
  return new k$B({ title: a2, content: p2, fieldInfos: l2 });
}
const u$P = [/^fnode_$/i, /^tnode_$/i, /^lpoly_$/i, /^rpoly_$/i, /^poly_$/i, /^subclass$/i, /^subclass_$/i, /^rings_ok$/i, /^rings_nok$/i, /shape/i, /perimeter/i, /objectid/i, /_i$/i], c$15 = (e2, { editFieldsInfo: t2, objectIdField: n2, visibleFieldNames: i2 }) => i2 ? i2.has(e2.name) : !F$h(e2.name, t2) && ((!n2 || e2.name !== n2) && (!l$12.includes(e2.type) && !u$P.some((t3) => t3.test(e2.name))));
function f$H(e2, t2) {
  const n2 = e2;
  return t2 && (e2 = e2.filter((e3) => !t2.includes(e3.type))), e2 === n2 && (e2 = e2.slice()), e2.sort(m$11), e2;
}
function m$11(e2, t2) {
  return e2.type === "oid" ? -1 : t2.type === "oid" ? 1 : _$q(e2) ? -1 : _$q(t2) ? 1 : (e2.alias || e2.name).toLocaleLowerCase().localeCompare((t2.alias || t2.name).toLocaleLowerCase());
}
function F$h(e2, t2) {
  if (!e2 || !t2)
    return false;
  const { creationDateField: n2, creatorField: i2, editDateField: o2, editorField: r2 } = t2;
  return [n2 && n2.toLowerCase(), i2 && i2.toLowerCase(), o2 && o2.toLowerCase(), r2 && r2.toLowerCase()].includes(e2.toLowerCase());
}
function b$q(e2, t2) {
  return e2.editable && !a$16.includes(e2.type) && !F$h(e2.name, t2);
}
function g$w({ editFieldsInfo: e2, fields: t2, objectIdField: n2 }, i2) {
  return f$H(t2 != null ? t2 : [], (i2 == null ? void 0 : i2.ignoreFieldTypes) || h$J).map((t3) => new c$2Z({ fieldName: t3.name, isEditable: b$q(t3, e2), label: t3.alias, format: j$i(t3), visible: c$15(t3, { editFieldsInfo: e2, objectIdField: n2, visibleFieldNames: i2 == null ? void 0 : i2.visibleFieldNames }) }));
}
function j$i(e2) {
  switch (e2.type) {
    case "small-integer":
    case "integer":
    case "single":
      return new u$1W({ digitSeparator: true, places: 0 });
    case "double":
      return new u$1W({ digitSeparator: true, places: 2 });
    case "date":
      return new u$1W({ dateFormat: "long-month-day-year" });
    default:
      return e2.type === "string" && he$2(e2.name) ? new u$1W({ digitSeparator: true, places: 0 }) : null;
  }
}
function I$i() {
  return [new c$2Y(), new i$2O()];
}
function L$f(e2) {
  const t2 = E$M(e2), { titleBase: i2 } = e2;
  return t2 ? `${i2}: {${t2.trim()}}` : i2 != null ? i2 : "";
}
function _$q(e2) {
  if ((e2.name && e2.name.toLowerCase()) === "name")
    return true;
  return (e2.alias && e2.alias.toLowerCase()) === "name";
}
const h$J = ["geometry", "blob", "raster", "guid", "xml"];
const Ve$1 = "FeatureLayer", Qe = "esri.layers.FeatureLayer", Ne = s$2z.getLogger(Qe);
function Ge(e2, r2) {
  return new s$2u("layer:unsupported", `Layer (${e2.title}, ${e2.id}) of type '${e2.declaredClass}' ${r2}`, { layer: e2 });
}
function Je(e2) {
  return e2 && e2 instanceof j$V;
}
const $e = s$Z();
function We(e2, r2, t2) {
  const i2 = !!(t2 == null ? void 0 : t2.writeLayerSchema);
  return { enabled: i2, ignoreOrigin: i2 };
}
let Be = class extends M$j(n$1c(p$1t(u$Q(a$1n(n$1l(c$1b(a$1a(t$X(p$1e(p$1v(c$1d(v$u(O$k(o$13(i$1s(i$2R(b$y))))))))))))))))) {
  constructor(...e2) {
    super(...e2), this._handles = new t$2g(), this.charts = null, this.copyright = null, this.displayField = null, this.dynamicDataSource = null, this.fields = null, this.fieldsIndex = null, this.formTemplate = null, this.fullExtent = null, this.geometryType = null, this.hasM = void 0, this.hasZ = void 0, this.infoFor3D = null, this.isTable = false, this.labelsVisible = true, this.labelingInfo = null, this.legendEnabled = true, this.objectIdField = null, this.outFields = null, this.path = null, this.popupEnabled = true, this.popupTemplate = null, this.screenSizePerspectiveEnabled = true, this.spatialReference = k$C.WGS84, this.subtypeCode = null, this.templates = null, this.timeInfo = null, this.title = null, this.sublayerTitleMode = "item-title", this.type = "feature", this.typeIdField = null, this.types = null, this.visible = true;
  }
  destroy() {
    var _a2;
    (_a2 = this.source) == null ? void 0 : _a2.destroy(), this._handles = s$2D(this._handles);
  }
  normalizeCtorArgs(e2, r2) {
    return typeof e2 == "string" ? __spreadValues({ url: e2 }, r2) : e2;
  }
  load(e2) {
    var _a2;
    const r2 = r$1$(e2) ? e2.signal : null;
    if (((_a2 = this.portalItem) == null ? void 0 : _a2.loaded) && this.source)
      return this.addResolvingPromise(this.createGraphicsSource(r2).then((e3) => this.initLayerProperties(e3))), Promise.resolve(this);
    const t2 = this.loadFromPortal({ supportedTypes: ["Feature Service", "Feature Collection"] }, e2).catch(w$12).then(async () => {
      if (this.url && this.layerId == null && /FeatureServer|MapServer\/*$/i.test(this.url)) {
        const e3 = await this._fetchFirstLayerId(r2);
        e3 != null && (this.layerId = e3);
      }
      if (!this.url && !this._hasMemorySource())
        throw new s$2u("feature-layer:missing-url-or-source", "Feature layer must be created with either a url or a source");
      return this.initLayerProperties(await this.createGraphicsSource(r2));
    }).then(() => this.finishLoadEditablePortalLayer(e2));
    return this.addResolvingPromise(t2), Promise.resolve(this);
  }
  readCapabilities(e2, r2) {
    return r2 = r2.layerDefinition || r2, h$M(e2, r2, this.url);
  }
  get createQueryVersion() {
    var _a2;
    return this.commitProperty("definitionExpression"), this.commitProperty("dynamicDataSource"), this.commitProperty("timeExtent"), this.commitProperty("timeOffset"), this.commitProperty("geometryType"), this.commitProperty("gdbVersion"), this.commitProperty("historicMoment"), this.commitProperty("returnZ"), this.commitProperty("capabilities"), this.commitProperty("returnM"), ((_a2 = this._get("createQueryVersion")) != null ? _a2 : 0) + 1;
  }
  get editingEnabled() {
    var _a2;
    return !(this.loaded && !((_a2 = this.capabilities) == null ? void 0 : _a2.operations.supportsEditing)) && (this._isOverridden("editingEnabled") ? this._get("editingEnabled") : this._hasMemorySource() || this.userHasEditingPrivileges);
  }
  set editingEnabled(e2) {
    this._overrideIfSome("editingEnabled", e2);
  }
  readEditingEnabled(e2, r2) {
    return this._readEditingEnabled(r2, false);
  }
  readEditingEnabledFromWebMap(e2, r2, t2) {
    return this._readEditingEnabled(r2, true, t2);
  }
  writeEditingEnabled(e2, r2) {
    this._writeEditingEnabled(e2, r2, false);
  }
  writeEditingEnabledToWebMap(e2, r2, t2, i2) {
    this._writeEditingEnabled(e2, r2, true, i2);
  }
  readIsTable(e2, r2) {
    var _a2;
    return (r2 = (_a2 = r2 == null ? void 0 : r2.layerDefinition) != null ? _a2 : r2).type === "Table" || !r2.geometryType;
  }
  writeIsTable(e2, r2, t2, i2) {
    (i2 == null ? void 0 : i2.writeLayerSchema) && o$2q(t2, e2 ? "Table" : "Feature Layer", r2);
  }
  readGlobalIdField(e2, r2) {
    return z$o(r2.layerDefinition || r2);
  }
  readObjectIdField(e2, r2) {
    return U$e(r2.layerDefinition || r2);
  }
  get parsedUrl() {
    const e2 = j$Q(this.url);
    return e2 != null && (this.dynamicDataSource != null ? e2.path = G$q(e2.path, "dynamicLayer") : this.layerId != null && (e2.path = G$q(e2.path, this.layerId.toString()))), e2;
  }
  get defaultPopupTemplate() {
    return this.createPopupTemplate();
  }
  set renderer(e2) {
    F$B(e2, this.fieldsIndex), this._set("renderer", e2);
  }
  readRenderer(e2, r2, s2) {
    var _a2, _b2;
    const a2 = (_a2 = (r2 = r2.layerDefinition || r2).drawingInfo) == null ? void 0 : _a2.renderer;
    if (a2) {
      const e3 = (_b2 = o$17(a2, r2, s2)) != null ? _b2 : void 0;
      return e3 || Ne.error("Failed to create renderer", { rendererDefinition: r2.drawingInfo.renderer, layer: this, context: s2 }), e3;
    }
    if (r2.defaultSymbol)
      return r2.types && r2.types.length ? new C$n({ defaultSymbol: ze(r2.defaultSymbol, r2, s2), field: r2.typeIdField, uniqueValueInfos: r2.types.map((e3) => ({ id: e3.id, symbol: ze(e3.symbol, e3, s2) })) }) : new p$1M({ symbol: ze(r2.defaultSymbol, r2, s2) });
  }
  set source(e2) {
    const r2 = this._get("source");
    r2 !== e2 && (Je(r2) && this._resetMemorySource(r2), Je(e2) && this._initMemorySource(e2), this._set("source", e2));
  }
  castSource(e2) {
    return e2 ? Array.isArray(e2) || e2 instanceof j$V ? new G$j({ layer: this, items: e2 }) : e2 : null;
  }
  readSource(e2, r2) {
    var _a2;
    const t2 = x$A.fromJSON(r2.featureSet);
    return new G$j({ layer: this, items: (_a2 = t2 == null ? void 0 : t2.features) != null ? _a2 : [] });
  }
  readTemplates(e2, r2) {
    const t2 = r2.editFieldsInfo, i2 = t2 && t2.creatorField, o2 = t2 && t2.editorField;
    return e2 = e2 && e2.map((e3) => p$1b.fromJSON(e3)), this._fixTemplates(e2, i2), this._fixTemplates(e2, o2), e2;
  }
  readTitle(e2, r2) {
    var _a2, _b2;
    const t2 = (_b2 = (_a2 = r2.layerDefinition) == null ? void 0 : _a2.name) != null ? _b2 : r2.name, i2 = r2.title || r2.layerDefinition && r2.layerDefinition.title;
    if (t2) {
      const e3 = this.portalItem && this.portalItem.title;
      if (this.sublayerTitleMode === "item-title")
        return this.url ? y$B(this.url, t2) : t2;
      let r3 = t2;
      if (!r3 && this.url) {
        const e4 = m$1a(this.url);
        r$1$(e4) && (r3 = e4.title);
      }
      if (!r3)
        return;
      return this.sublayerTitleMode === "item-title-and-service-name" && e3 && e3 !== r3 && (r3 = e3 + " - " + r3), h$O(r3);
    }
    if (this.sublayerTitleMode === "item-title" && i2)
      return i2;
  }
  readTitleFromWebMap(e2, r2) {
    return r2.title || r2.layerDefinition && r2.layerDefinition.name;
  }
  readTypeIdField(e2, r2) {
    let t2 = (r2 = r2.layerDefinition || r2).typeIdField;
    if (t2 && r2.fields) {
      t2 = t2.toLowerCase();
      const e3 = r2.fields.find((e4) => e4.name.toLowerCase() === t2);
      e3 && (t2 = e3.name);
    }
    return t2;
  }
  readTypes(e2, r2) {
    e2 = (r2 = r2.layerDefinition || r2).types;
    const t2 = r2.editFieldsInfo, i2 = t2 && t2.creatorField, o2 = t2 && t2.editorField;
    return e2 && e2.map((e3) => (e3 = n$17.fromJSON(e3), this._fixTemplates(e3.templates, i2), this._fixTemplates(e3.templates, o2), e3));
  }
  readVisible(e2, r2) {
    return r2.layerDefinition && r2.layerDefinition.defaultVisibility != null ? !!r2.layerDefinition.defaultVisibility : r2.visibility != null ? !!r2.visibility : void 0;
  }
  async addAttachment(e2, r2) {
    return F$i(this, e2, r2, Ve$1);
  }
  async updateAttachment(e2, r2, t2) {
    return x$u(this, e2, r2, t2, Ve$1);
  }
  async applyEdits(e2, r2) {
    return P$k(this, e2, r2);
  }
  on(e2, r2) {
    return super.on(e2, r2);
  }
  createPopupTemplate(e2) {
    return p$1a(this, e2);
  }
  async createGraphicsSource(e2) {
    if (this._hasMemorySource() && this.source)
      return this.source.load({ signal: e2 });
    const { default: r2 } = await y$1C(import("./FeatureLayerSource.js"), e2);
    return new r2({ layer: this }).load({ signal: e2 });
  }
  createQuery() {
    const e2 = L$h(this);
    e2.dynamicDataSource = this.dynamicDataSource;
    const r2 = r$1$(this.subtypeCode) ? `${this.subtypeField} = ${this.subtypeCode}` : null, t2 = t$14(this.definitionExpression, r2);
    return e2.where = t2 || "1=1", e2;
  }
  async deleteAttachments(e2, r2) {
    return O$j(this, e2, r2, Ve$1);
  }
  async fetchRecomputedExtents(e2) {
    return v$y(this, e2, Ve$1);
  }
  getFeatureType(e2) {
    const { typeIdField: r2, types: t2 } = this;
    if (!r2 || !e2)
      return null;
    const i2 = e2.attributes ? e2.attributes[r2] : void 0;
    if (i2 == null)
      return null;
    let o2 = null;
    return t2 == null ? void 0 : t2.some((e3) => {
      const { id: r3 } = e3;
      return r3 != null && (r3.toString() === i2.toString() && (o2 = e3), !!o2);
    }), o2;
  }
  getFieldDomain(e2, r2) {
    const t2 = r2 && r2.feature, i2 = this.getFeatureType(t2);
    if (i2) {
      const r3 = i2.domains && i2.domains[e2];
      if (r3 && r3.type !== "inherited")
        return r3;
    }
    return this._getLayerDomain(e2);
  }
  getField(e2) {
    return this.fieldsIndex.get(e2);
  }
  async queryAttachments(e2, r2) {
    return E$s(this, e2, r2, Ve$1);
  }
  async queryFeatures(e2, r2) {
    var _a2;
    const t2 = await this.load(), i2 = await t2.source.queryFeatures((_a2 = x$z.from(e2)) != null ? _a2 : t2.createQuery(), r2);
    if (i2 == null ? void 0 : i2.features)
      for (const o2 of i2.features)
        o2.layer = o2.sourceLayer = t2;
    return i2;
  }
  async queryObjectIds(e2, r2) {
    return I$l(this, e2, r2, Ve$1);
  }
  async queryFeatureCount(e2, r2) {
    return T$g(this, e2, r2, Ve$1);
  }
  async queryExtent(e2, r2) {
    return j$l(this, e2, r2, Ve$1);
  }
  async queryRelatedFeatures(e2, r2) {
    return M$k(this, e2, r2, Ve$1);
  }
  async queryRelatedFeaturesCount(e2, r2) {
    return D$e(this, e2, r2, Ve$1);
  }
  async queryTopFeatures(e2, r2) {
    var _a2;
    const { source: t2, capabilities: i2 } = await this.load();
    if (!t2.queryTopFeatures || !((_a2 = i2 == null ? void 0 : i2.query) == null ? void 0 : _a2.supportsTopFeaturesQuery))
      throw new s$2u(Ve$1, "Layer source does not support queryTopFeatures capability");
    const o2 = await t2.queryTopFeatures(v$I.from(e2), r2);
    if (o2 == null ? void 0 : o2.features)
      for (const s2 of o2.features)
        s2.layer = s2.sourceLayer = this;
    return o2;
  }
  async queryTopObjectIds(e2, r2) {
    const { source: t2, capabilities: i2 } = await this.load();
    if (!t2.queryTopObjectIds || !(i2 == null ? void 0 : i2.query.supportsTopFeaturesQuery))
      throw new s$2u(Ve$1, "Layer source does not support queryTopObjectIds capability");
    return t2.queryTopObjectIds(v$I.from(e2), r2);
  }
  async queryTopFeaturesExtent(e2, r2) {
    var _a2;
    const { source: t2, capabilities: i2 } = await this.load();
    if (!t2.queryTopExtents || !((_a2 = i2 == null ? void 0 : i2.query) == null ? void 0 : _a2.supportsTopFeaturesQuery))
      throw new s$2u(Ve$1, "Layer source does not support queryTopExtents capability");
    return t2.queryTopExtents(v$I.from(e2), r2);
  }
  async queryTopFeatureCount(e2, r2) {
    var _a2;
    const { source: t2, capabilities: i2 } = await this.load();
    if (!t2.queryTopCount || !((_a2 = i2 == null ? void 0 : i2.query) == null ? void 0 : _a2.supportsTopFeaturesQuery))
      throw new s$2u(Ve$1, "Layer source does not support queryFeatureCount capability");
    return t2.queryTopCount(v$I.from(e2), r2);
  }
  read(e2, r2) {
    const t2 = e2.featureCollection;
    if (t2) {
      const e3 = t2.layers;
      e3 && e3.length === 1 && (super.read(e3[0], r2), t2.showLegend != null && super.read({ showLegend: t2.showLegend }, r2));
    }
    super.read(e2, r2), r2 && r2.origin === "service" && this.revert(["objectIdField", "fields", "timeInfo", "spatialReference"], "service");
  }
  write(e2, r2) {
    var _a2, _b2;
    r2 = __spreadProps(__spreadValues({}, r2), { origin: (_a2 = r2 == null ? void 0 : r2.origin) != null ? _a2 : void 0, writeLayerSchema: (_b2 = r2 == null ? void 0 : r2.writeLayerSchema) != null ? _b2 : this._hasMemorySource() });
    const { origin: t2, layerContainerType: i2, messages: o2 } = r2;
    if (this.dynamicDataSource)
      return o2 == null ? void 0 : o2.push(Ge(this, "using a dynamic data source cannot be written to web scenes, web maps and feature service items")), null;
    if (this.isTable) {
      if (t2 === "web-scene" || t2 === "web-map" && i2 !== "tables")
        return o2 == null ? void 0 : o2.push(Ge(this, "using a table source cannot be written to web scenes and web maps")), null;
      if (this._hasMemorySource())
        return o2 == null ? void 0 : o2.push(Ge(this, "using an in-memory table source cannot be written to web scenes and web maps")), null;
    } else if (this.loaded && t2 === "web-map" && i2 === "tables")
      return o2 == null ? void 0 : o2.push(Ge(this, "using a non-table source cannot be written to tables in web maps")), null;
    return super.write(e2, r2);
  }
  clone() {
    if (this._hasMemorySource())
      throw new s$2u(Ve$1, `FeatureLayer (title: ${this.title}, id: ${this.id}) created using in-memory source cannot be cloned`);
    return super.clone();
  }
  serviceSupportsSpatialReference(e2) {
    var _a2;
    return !!this.loaded && (((_a2 = this.source) == null ? void 0 : _a2.type) === "memory" || e$L(this, e2));
  }
  async save(e2) {
    return (await import("./featureLayerUtils.js")).save(this, e2);
  }
  async saveAs(e2, r2) {
    return (await import("./featureLayerUtils.js")).saveAs(this, e2, r2);
  }
  _readEditingEnabled(e2, r2, t2) {
    var _a2;
    let i2 = (_a2 = e2.layerDefinition) == null ? void 0 : _a2.capabilities;
    return i2 ? this._hasEditingCapability(i2) : (i2 = e2.capabilities, r2 && (t2 == null ? void 0 : t2.origin) === "web-map" && !this._hasMemorySource() && i2 ? this._hasEditingCapability(i2) : void 0);
  }
  _hasEditingCapability(e2) {
    return e2.toLowerCase().split(",").map((e3) => e3.trim()).includes("editing");
  }
  _writeEditingEnabled(e2, r2, t2, i2) {
    var _a2, _b2;
    if (!e2) {
      const e3 = ((_b2 = (_a2 = this.capabilities) == null ? void 0 : _a2.operations) == null ? void 0 : _b2.supportsSync) ? "Query,Sync" : "Query";
      o$2q("layerDefinition.capabilities", e3, r2), t2 && !(i2 == null ? void 0 : i2.writeLayerSchema) && (r2.capabilities = e3);
    }
  }
  _getLayerDomain(e2) {
    const r2 = this.fieldsIndex.get(e2);
    return r2 ? r2.domain : null;
  }
  _fetchFirstLayerId(e2) {
    return U$t(this.url, { query: __spreadProps(__spreadValues({ f: "json" }, this.customParameters), { token: this.apiKey }), responseType: "json", signal: e2 }).then((e3) => {
      const r2 = e3.data;
      if (r2)
        return Array.isArray(r2.layers) && r2.layers.length > 0 ? r2.layers[0].id : Array.isArray(r2.tables) && r2.tables.length > 0 ? r2.tables[0].id : void 0;
    });
  }
  async initLayerProperties(e2) {
    return this._set("source", e2), e2.sourceJSON && (this.sourceJSON = e2.sourceJSON, this.read(e2.sourceJSON, { origin: "service", url: this.parsedUrl })), this._verifySource(), this._verifyFields(), F$B(this.renderer, this.fieldsIndex), x$V(this.timeInfo, this.fieldsIndex), t$V(this, { origin: "service" });
  }
  async hasDataChanged() {
    return G$i(this);
  }
  async fetchPublishingStatus() {
    const e2 = this.source;
    return (e2 == null ? void 0 : e2.fetchPublishingStatus) ? e2.fetchPublishingStatus() : "unavailable";
  }
  _verifyFields() {
    var _a2, _b2, _c2;
    const e2 = (_b2 = (_a2 = this.parsedUrl) == null ? void 0 : _a2.path) != null ? _b2 : "undefined";
    this.objectIdField || console.log("FeatureLayer: 'objectIdField' property is not defined (url: " + e2 + ")"), this.isTable || this._hasMemorySource() || e2.search(/\/FeatureServer\//i) !== -1 || ((_c2 = this.fields) == null ? void 0 : _c2.some((e3) => e3.type === "geometry")) || console.log("FeatureLayer: unable to find field of type 'geometry' in the layer 'fields' list. If you are using a map service layer, features will not have geometry (url: " + e2 + ")");
  }
  _fixTemplates(e2, r2) {
    e2 && e2.forEach((e3) => {
      const t2 = e3.prototype && e3.prototype.attributes;
      t2 && r2 && delete t2[r2];
    });
  }
  _verifySource() {
    if (this._hasMemorySource()) {
      if (this.url)
        throw new s$2u("feature-layer:mixed-source-and-url", "FeatureLayer cannot be created with both an in-memory source and a url");
    } else if (!this.url)
      throw new s$2u("feature-layer:source-or-url-required", "FeatureLayer requires either a url, a valid portal item or a source");
  }
  _initMemorySource(e2) {
    e2.forEach((e3) => {
      e3.layer = this, e3.sourceLayer = this;
    }), this._handles.add([e2.on("after-add", (e3) => {
      e3.item.layer = this, e3.item.sourceLayer = this;
    }), e2.on("after-remove", (e3) => {
      e3.item.layer = null, e3.item.sourceLayer = null;
    })], "fl-source");
  }
  _resetMemorySource(e2) {
    e2.forEach((e3) => {
      e3.layer = null, e3.sourceLayer = null;
    }), this._handles.remove("fl-source");
  }
  _hasMemorySource() {
    return !(this.url || !this.source);
  }
};
e$2g([o$29("service", "capabilities")], Be.prototype, "readCapabilities", null), e$2g([y$1I({ json: { origins: { "portal-item": { write: true }, "web-map": { write: true } } } })], Be.prototype, "charts", void 0), e$2g([y$1I({ readOnly: true })], Be.prototype, "createQueryVersion", null), e$2g([y$1I({ json: { read: { source: "layerDefinition.copyrightText" } } })], Be.prototype, "copyright", void 0), e$2g([y$1I({ json: { read: { source: "layerDefinition.displayField" } } })], Be.prototype, "displayField", void 0), e$2g([y$1I({ types: j$J, readOnly: true })], Be.prototype, "defaultSymbol", void 0), e$2g([y$1I({ type: K$c })], Be.prototype, "dynamicDataSource", void 0), e$2g([y$1I({ type: Boolean })], Be.prototype, "editingEnabled", null), e$2g([o$29(["portal-item", "web-scene"], "editingEnabled", ["layerDefinition.capabilities"])], Be.prototype, "readEditingEnabled", null), e$2g([o$29("web-map", "editingEnabled", ["capabilities", "layerDefinition.capabilities"])], Be.prototype, "readEditingEnabledFromWebMap", null), e$2g([r$1P(["portal-item", "web-scene"], "editingEnabled", { "layerDefinition.capabilities": { type: String } })], Be.prototype, "writeEditingEnabled", null), e$2g([r$1P("web-map", "editingEnabled", { capabilities: { type: String }, "layerDefinition.capabilities": { type: String } })], Be.prototype, "writeEditingEnabledToWebMap", null), e$2g([y$1I(__spreadProps(__spreadValues({}, $e.fields), { json: { read: { source: "layerDefinition.fields" }, origins: { service: { name: "fields" }, "web-map": { write: { target: "layerDefinition.fields", overridePolicy: We } } } } }))], Be.prototype, "fields", void 0), e$2g([y$1I($e.fieldsIndex)], Be.prototype, "fieldsIndex", void 0), e$2g([y$1I({ type: y$C, json: { name: "formInfo", write: true, origins: { "web-scene": { read: false, write: false } } } })], Be.prototype, "formTemplate", void 0), e$2g([y$1I({ json: { read: { source: "layerDefinition.extent" } } })], Be.prototype, "fullExtent", void 0), e$2g([y$1I({ json: { origins: { "web-map": { write: { target: "layerDefinition.geometryType", overridePolicy: We, writer(e2, r2, t2) {
  const i2 = e2 ? i$1o.toJSON(e2) : null;
  i2 && o$2q(t2, i2, r2);
} } } }, read: { source: "layerDefinition.geometryType", reader: i$1o.read } } })], Be.prototype, "geometryType", void 0), e$2g([y$1I({ json: { read: { source: "layerDefinition.hasM" } } })], Be.prototype, "hasM", void 0), e$2g([y$1I({ json: { read: { source: "layerDefinition.hasZ" } } })], Be.prototype, "hasZ", void 0), e$2g([y$1I(j$m)], Be.prototype, "id", void 0), e$2g([y$1I({ readOnly: true, json: { origins: { service: { read: true } }, read: false } })], Be.prototype, "infoFor3D", void 0), e$2g([y$1I({ json: { origins: { "web-map": { write: { target: "layerDefinition.type" } } } } })], Be.prototype, "isTable", void 0), e$2g([o$29("service", "isTable", ["type", "geometryType"]), o$29("isTable", ["layerDefinition.type", "layerDefinition.geometryType"])], Be.prototype, "readIsTable", null), e$2g([r$1P("web-map", "isTable")], Be.prototype, "writeIsTable", null), e$2g([y$1I(m$15)], Be.prototype, "labelsVisible", void 0), e$2g([y$1I({ type: [j$j], json: { origins: { service: { read: { source: "drawingInfo.labelingInfo", reader: i$1e }, write: { target: "drawingInfo.labelingInfo", enabled: false } } }, read: { source: "layerDefinition.drawingInfo.labelingInfo", reader: i$1e }, write: { target: "layerDefinition.drawingInfo.labelingInfo" } } })], Be.prototype, "labelingInfo", void 0), e$2g([y$1I((() => {
  const e2 = y$1L(u$U);
  return e2.json.origins["portal-item"] = { write: { target: "layerDefinition.drawingInfo.transparency", writer(e3, r2, t2) {
    o$2q(t2, n$2r(e3), r2);
  } } }, e2;
})())], Be.prototype, "opacity", void 0), e$2g([y$1I(c$1l)], Be.prototype, "legendEnabled", void 0), e$2g([y$1I({ type: ["show", "hide"], json: (() => {
  const e2 = y$1L(D$f.json);
  return e2.origins["portal-item"] = { read: false, write: false }, e2;
})() })], Be.prototype, "listMode", void 0), e$2g([o$29("globalIdField", ["layerDefinition.globalIdField", "layerDefinition.fields"])], Be.prototype, "readGlobalIdField", null), e$2g([y$1I({ json: { origins: { "web-map": { write: { target: "layerDefinition.objectIdField", overridePolicy: We } } } } })], Be.prototype, "objectIdField", void 0), e$2g([o$29("objectIdField", ["layerDefinition.objectIdField", "layerDefinition.fields"])], Be.prototype, "readObjectIdField", null), e$2g([y$1I({ value: "ArcGISFeatureLayer", type: ["ArcGISFeatureLayer"] })], Be.prototype, "operationalLayerType", void 0), e$2g([y$1I($e.outFields)], Be.prototype, "outFields", void 0), e$2g([y$1I({ readOnly: true })], Be.prototype, "parsedUrl", null), e$2g([y$1I({ type: String, json: { origins: { "web-scene": { read: true, write: true } }, read: false } })], Be.prototype, "path", void 0), e$2g([y$1I(p$1q)], Be.prototype, "popupEnabled", void 0), e$2g([y$1I({ type: k$B, json: { name: "popupInfo", write: true } })], Be.prototype, "popupTemplate", void 0), e$2g([y$1I({ readOnly: true })], Be.prototype, "defaultPopupTemplate", null), e$2g([y$1I({ types: p$1I, json: { origins: { service: { write: { target: "drawingInfo.renderer", enabled: false } }, "web-scene": { types: n$1r, name: "layerDefinition.drawingInfo.renderer", write: { overridePolicy: (e2, r2, t2) => ({ ignoreOrigin: t2 == null ? void 0 : t2.writeLayerSchema }) } } }, write: { target: "layerDefinition.drawingInfo.renderer", overridePolicy: (e2, r2, t2) => ({ ignoreOrigin: t2 == null ? void 0 : t2.writeLayerSchema }) } } })], Be.prototype, "renderer", null), e$2g([o$29("service", "renderer", ["drawingInfo.renderer", "defaultSymbol"]), o$29("renderer", ["layerDefinition.drawingInfo.renderer", "layerDefinition.defaultSymbol"])], Be.prototype, "readRenderer", null), e$2g([y$1I((() => {
  const e2 = y$1L(l$1g);
  return e2.json.origins["portal-item"] = { read: false, write: false }, e2;
})())], Be.prototype, "screenSizePerspectiveEnabled", void 0), e$2g([y$1I({ clonable: false })], Be.prototype, "source", null), e$2g([s$2i("source")], Be.prototype, "castSource", null), e$2g([o$29("portal-item", "source", ["featureSet"]), o$29("web-map", "source", ["featureSet"])], Be.prototype, "readSource", null), e$2g([y$1I({ json: { read: { source: "layerDefinition.extent.spatialReference" } } })], Be.prototype, "spatialReference", void 0), e$2g([y$1I({ type: Number })], Be.prototype, "subtypeCode", void 0), e$2g([y$1I({ type: [p$1b] })], Be.prototype, "templates", void 0), e$2g([o$29("templates", ["editFieldsInfo", "creatorField", "editorField", "templates"])], Be.prototype, "readTemplates", null), e$2g([y$1I({ type: v$t })], Be.prototype, "timeInfo", void 0), e$2g([y$1I()], Be.prototype, "title", void 0), e$2g([o$29("service", "title", ["name"]), o$29("portal-item", "title", ["layerDefinition.title", "layerDefinition.name", "title"])], Be.prototype, "readTitle", null), e$2g([o$29("web-map", "title", ["layerDefinition.name", "title"])], Be.prototype, "readTitleFromWebMap", null), e$2g([y$1I({ type: String })], Be.prototype, "sublayerTitleMode", void 0), e$2g([y$1I({ json: { read: false } })], Be.prototype, "type", void 0), e$2g([y$1I({ type: String })], Be.prototype, "typeIdField", void 0), e$2g([o$29("service", "typeIdField"), o$29("typeIdField", ["layerDefinition.typeIdField"])], Be.prototype, "readTypeIdField", null), e$2g([y$1I({ type: [n$17] })], Be.prototype, "types", void 0), e$2g([o$29("service", "types", ["types"]), o$29("types", ["layerDefinition.types"])], Be.prototype, "readTypes", null), e$2g([y$1I({ type: Boolean, json: { origins: { "portal-item": { write: { target: "layerDefinition.defaultVisibility" } } } } })], Be.prototype, "visible", void 0), e$2g([o$29("portal-item", "visible", ["visibility", "layerDefinition.defaultVisibility"])], Be.prototype, "readVisible", null), Be = e$2g([n$2P(Qe)], Be);
const ze = s$2r({ types: M$z }), Ze = Be;
var FeatureLayer = /* @__PURE__ */ Object.freeze({
  __proto__: null,
  [Symbol.toStringTag]: "Module",
  "default": Ze
});
const s$X = ["$datastore", "$map", "$layer", "$aggregatedfeatures"], n$14 = "esri.widgets.Feature.support.arcadeFeatureUtils", o$W = s$2z.getLogger(n$14);
function c$14(e2) {
  return typeof e2 == "string" ? te$3(ee$3(e2)) : Array.isArray(e2) ? p$19(e2) : (e2 == null ? void 0 : e2.declaredClass) === "esri.arcade.Dictionary" ? l$11(e2) : e2;
}
function p$19(e2) {
  return `<ul class="esri-widget__list">${e2.map((e3) => `<li>${typeof e3 == "string" ? te$3(ee$3(e3)) : e3}</li>`).join("")}</ul>`;
}
function l$11(e2) {
  return `<table class="esri-widget__table">${e2.keys().map((r2) => {
    const t2 = e2.field(r2);
    return `<tr><th>${r2}</th><td>${typeof t2 == "string" ? te$3(ee$3(t2)) : t2}</td></tr>`;
  }).join("")}</table>`;
}
function u$O({ aggregatedFeatures: e2, arcadeUtils: r2, featureSetVars: a2, context: i2, viewInfo: s2, map: n2, graphic: o2, interceptor: c2 }) {
  a2.forEach((a3) => {
    const p2 = a3.toLowerCase(), l2 = { map: n2, spatialReference: s2.sr, interceptor: c2 };
    if (p2 === "$map" && (i2.vars[p2] = r2.convertMapToFeatureSetCollection(l2)), p2 === "$layer" && (i2.vars[p2] = r2.convertFeatureLayerToFeatureSet({ layer: o2.sourceLayer, spatialReference: s2.sr, interceptor: c2 })), p2 === "$datastore" && (i2.vars[p2] = r2.convertServiceUrlToWorkspace({ url: o2.sourceLayer.url, spatialReference: s2.sr, interceptor: c2 })), p2 === "$aggregatedfeatures") {
      const a4 = o2.layer, { fields: n3, objectIdField: l3, geometryType: u2, spatialReference: f2, displayField: g2 } = a4, y2 = new Ze(__spreadProps(__spreadValues({ fields: n3, objectIdField: l3, geometryType: u2, spatialReference: f2, displayField: g2 }, a4.type === "feature" ? { templates: a4.templates, typeIdField: a4.typeIdField, types: a4.types } : null), { source: e2 }));
      i2.vars[p2] = r2.convertFeatureLayerToFeatureSet({ layer: y2, spatialReference: s2.sr, interceptor: c2 });
    }
  });
}
function f$G() {
  return import("./arcadeUtils.js").then(function(n2) {
    return n2.ay;
  });
}
function g$v(e2) {
  return "createQuery" in e2 && "queryFeatures" in e2;
}
async function y$t({ graphic: e2, view: r2 }) {
  const { isAggregate: t2, layer: a2 } = e2;
  if (!t2 || !a2 || (r2 == null ? void 0 : r2.type) !== "2d")
    return [];
  const i2 = await r2.whenLayerView(a2);
  if (!g$v(i2))
    return [];
  const s2 = i2.createQuery();
  s2.aggregateIds = [e2.getObjectId()];
  const { features: n2 } = await i2.queryFeatures(s2);
  return n2;
}
async function d$B({ expressionInfo: e2, arcadeUtils: r2, interceptor: t2, spatialReference: a2, map: i2, graphic: n2, view: c2 }) {
  if (!e2 || !e2.expression)
    return null;
  const p2 = r2.createSyntaxTree(e2.expression), l2 = s$X.filter((e3) => r2.hasVariable(p2, e3)), [f2] = await Promise.all([y$t({ graphic: n2, view: c2 }), r2.loadScriptDependencies(p2, true, l2)]), g2 = r2.getViewInfo({ spatialReference: a2 }), d2 = r2.createExecContext(n2, g2);
  d2.interceptor = t2, d2.useAsync = true, u$O({ aggregatedFeatures: f2, arcadeUtils: r2, featureSetVars: l2, context: d2, viewInfo: g2, map: i2, graphic: n2, interceptor: t2 });
  const m2 = r2.createFunction(p2, d2);
  return r2.executeAsyncFunction(m2, d2).catch((r3) => o$W.error("arcade-execution-error", { error: r3, graphic: n2, expressionInfo: e2 }));
}
async function m$10({ expressionInfos: e2, spatialReference: t2, graphic: a2, interceptor: i2, map: s2, view: n2 }) {
  if (!e2 || !e2.length)
    return {};
  const o2 = await f$G(), p2 = {};
  for (const r2 of e2)
    p2[`expression/${r2.name}`] = d$B({ expressionInfo: r2, arcadeUtils: o2, interceptor: i2, spatialReference: t2, map: s2, graphic: a2, view: n2 });
  const l2 = await E$Q(p2), u2 = {};
  for (const r2 in l2)
    u2[r2] = c$14(l2[r2].value);
  return u2;
}
const w$m = 1;
let j$h = class extends a$1W(m$2q) {
  constructor(t2) {
    super(t2), this._abortController = null, this.expressionInfo = null, this.graphic = null, this.contentElement = null, this.contentElementViewModel = null, this.interceptor = null, this.view = null, this._cancelQuery = () => {
      const { _abortController: t3 } = this;
      t3 && t3.abort(), this._abortController = null;
    }, this._createVM = () => {
      var _a2, _b2;
      const t3 = (_a2 = this.contentElement) == null ? void 0 : _a2.type;
      (_b2 = this.contentElementViewModel) == null ? void 0 : _b2.destroy();
      const e2 = t3 === "fields" ? new n$1Q() : t3 === "media" ? new v$H() : t3 === "text" ? new l$1D() : null;
      this._set("contentElementViewModel", e2);
    }, this._compile = async () => {
      this._cancelQuery();
      const t3 = new AbortController();
      this._abortController = t3, await this._compileExpression(), this._abortController === t3 && (this._abortController = null);
    }, this._compileThrottled = e$1n(this._compile, w$m, this), this._compileExpression = async () => {
      const { expressionInfo: t3, graphic: e2, interceptor: o2, spatialReference: r2, map: n2, view: s2, _abortController: i2 } = this;
      if (!(t3 && e2 && r2 && n2))
        return void this._set("contentElement", null);
      const l2 = await f$G();
      if (i2 !== this._abortController)
        return;
      const p2 = await d$B({ arcadeUtils: l2, expressionInfo: t3, graphic: e2, interceptor: o2, map: n2, spatialReference: r2, view: s2 });
      if (!p2 || p2.declaredClass !== "esri.arcade.Dictionary")
        return void this._set("contentElement", null);
      const h2 = await p2.castAsJsonAsync(i2.signal), u2 = h2 == null ? void 0 : h2.type, d2 = u2 === "media" ? I$I.fromJSON(h2) : u2 === "text" ? c$2T.fromJSON(h2) : u2 === "fields" ? c$2Y.fromJSON(h2) : null;
      this._set("contentElement", d2);
    }, this.handles.add([l$1P(() => [this.expressionInfo, this.graphic, this.map, this.spatialReference, this.view], () => this._compileThrottled(), h$1j), l$1P(() => [this.contentElement], () => this._createVM(), h$1j)]);
  }
  destroy() {
    var _a2;
    this._cancelQuery(), (_a2 = this.contentElementViewModel) == null ? void 0 : _a2.destroy(), this._set("contentElementViewModel", null), this._set("contentElement", null);
  }
  get spatialReference() {
    var _a2, _b2;
    return (_b2 = (_a2 = this.view) == null ? void 0 : _a2.spatialReference) != null ? _b2 : null;
  }
  set spatialReference(t2) {
    this._override("spatialReference", t2);
  }
  get state() {
    const { _abortController: t2, contentElement: e2, contentElementViewModel: o2 } = this;
    return t2 ? "loading" : e2 || o2 ? "ready" : "disabled";
  }
  get map() {
    var _a2, _b2;
    return (_b2 = (_a2 = this.view) == null ? void 0 : _a2.map) != null ? _b2 : null;
  }
  set map(t2) {
    this._override("map", t2);
  }
};
e$2g([y$1I()], j$h.prototype, "_abortController", void 0), e$2g([y$1I({ type: i$2M })], j$h.prototype, "expressionInfo", void 0), e$2g([y$1I({ type: g$10 })], j$h.prototype, "graphic", void 0), e$2g([y$1I({ readOnly: true })], j$h.prototype, "contentElement", void 0), e$2g([y$1I({ readOnly: true })], j$h.prototype, "contentElementViewModel", void 0), e$2g([y$1I()], j$h.prototype, "interceptor", void 0), e$2g([y$1I()], j$h.prototype, "spatialReference", null), e$2g([y$1I({ readOnly: true })], j$h.prototype, "state", null), e$2g([y$1I()], j$h.prototype, "map", null), e$2g([y$1I()], j$h.prototype, "view", void 0), j$h = e$2g([n$2P("esri.widgets.Feature.FeatureExpression.FeatureExpressionViewModel")], j$h);
const C$l = j$h;
const c$13 = { iconLoading: "esri-icon-loading-indicator esri-rotating", base: "esri-feature-expression", loadingSpinnerContainer: "esri-feature__loading-container", spinner: "esri-feature__loading-spinner" };
let u$N = class extends M$u {
  constructor(e2, t2) {
    super(e2, t2), this.viewModel = new C$l();
  }
  initialize() {
    this.addHandles(l$1P(() => {
      var _a2;
      return (_a2 = this.viewModel) == null ? void 0 : _a2.contentElementViewModel;
    }, () => this._setupExpressionWidget(), h$1j));
  }
  destroy() {
    this._destroyContentWidget();
  }
  renderLoading() {
    return n$1U("div", { key: "loading-container", class: c$13.loadingSpinnerContainer }, n$1U("span", { class: this.classes(c$13.iconLoading, c$13.spinner) }));
  }
  render() {
    var _a2;
    const { state: e2 } = this.viewModel;
    return n$1U("div", { class: c$13.base }, e2 === "loading" ? this.renderLoading() : e2 === "disabled" ? null : (_a2 = this._contentWidget) == null ? void 0 : _a2.render());
  }
  _destroyContentWidget() {
    const { _contentWidget: e2 } = this;
    e2 && (e2.viewModel = null, e2.destroy()), this._contentWidget = null;
  }
  _setupExpressionWidget() {
    const { contentElementViewModel: e2, contentElement: t2 } = this.viewModel, s2 = t2 == null ? void 0 : t2.type;
    this._destroyContentWidget();
    const o2 = e2 ? s2 === "fields" ? new m$1C({ viewModel: e2 }) : s2 === "media" ? new x$x({ viewModel: e2 }) : s2 === "text" ? new l$1C({ viewModel: e2 }) : null : null;
    this._contentWidget = o2, this.scheduleRender();
  }
};
e$2g([y$1I({ type: C$l })], u$N.prototype, "viewModel", void 0), u$N = e$2g([n$2P("esri.widgets.Feature.FeatureExpression")], u$N);
const m$$ = u$N;
const _$p = 100;
let g$u = class extends i$2R(s$1$(a$1W(m$2q))) {
  constructor(e2) {
    super(e2), this._queryAbortController = null, this._queryPageAbortController = null, this._queryFeatureCountAbortController = null, this.featuresPerPage = 10, this.description = null, this.graphic = null, this.layer = null, this.map = null, this.orderByFields = null, this.featureCount = 0, this.relationshipId = null, this.showAllEnabled = false, this.title = null, this._cancelQuery = () => {
      const { _queryAbortController: e3 } = this;
      e3 && e3.abort(), this._queryAbortController = null;
    }, this._cancelQueryFeatureCount = () => {
      const { _queryFeatureCountAbortController: e3 } = this;
      e3 && e3.abort(), this._queryFeatureCountAbortController = null;
    }, this._cancelQueryPage = () => {
      const { _queryPageAbortController: e3 } = this;
      e3 && e3.abort(), this._queryPageAbortController = null;
    }, this._queryController = async () => {
      this._cancelQuery();
      const e3 = new AbortController();
      this._queryAbortController = e3, await g$1m(this._query()), this._queryAbortController === e3 && (this._queryAbortController = null);
    }, this._queryFeatureCountController = async () => {
      this._cancelQueryFeatureCount();
      const e3 = new AbortController();
      this._queryFeatureCountAbortController = e3, await g$1m(this._queryFeatureCount()), this._queryFeatureCountAbortController === e3 && (this._queryFeatureCountAbortController = null);
    }, this._queryPageController = async () => {
      const e3 = new AbortController();
      this._queryPageAbortController = e3, await g$1m(this._queryPage()), this._queryPageAbortController === e3 && (this._queryPageAbortController = null);
    }, this._queryThrottled = e$1n(this._queryController, _$p, this), this._queryFeatureCountThrottled = e$1n(this._queryFeatureCountController, _$p, this), this._queryPageThrottled = e$1n(this._queryPageController, _$p, this), this._query = async () => {
      const { _queryAbortController: e3, relatedFeatures: t2 } = this;
      this._destroyRelatedFeatureViewModels(), this.featurePage = 1, t2.removeAll(), t2.addMany(this._sliceFeatures(await this._queryRelatedFeatures({ signal: e3 == null ? void 0 : e3.signal })));
    }, this.handles.add([l$1P(() => [this.displayCount, this.graphic, this.layer, this.map, this.orderByFieldsFixedCasing, this.relationshipId, this.featuresPerPage, this.showAllEnabled], () => this._queryThrottled(), h$1j), l$1P(() => [this.featurePage, this.showAllEnabled], () => this._queryPageThrottled()), l$1P(() => [this.layer, this.relationshipId, this.objectId], () => this._queryFeatureCountThrottled())]);
  }
  destroy() {
    this._destroyRelatedFeatureViewModels(), this.relatedFeatures.removeAll(), this._cancelQuery(), this._cancelQueryFeatureCount(), this._cancelQueryPage();
  }
  set featurePage(e2) {
    const { featuresPerPage: t2, featureCount: r2 } = this, o2 = 1, l2 = Math.ceil(r2 / t2) || 1;
    this._set("featurePage", Math.min(Math.max(e2, o2), l2));
  }
  get featurePage() {
    return this._get("featurePage");
  }
  get orderByFieldsFixedCasing() {
    const { orderByFields: e2, relatedLayer: t2 } = this;
    return e2 && (t2 == null ? void 0 : t2.loaded) ? e2.map((e3) => {
      const r2 = e3.clone(), o2 = D$l(e3.field, t2);
      return r2.field = o2, r2;
    }) : e2;
  }
  get itemDescriptionFieldName() {
    var _a2, _b2;
    return ((_b2 = (_a2 = this.orderByFieldsFixedCasing) == null ? void 0 : _a2[0]) == null ? void 0 : _b2.field) || null;
  }
  set displayCount(e2) {
    const t2 = 0, r2 = 10;
    this._set("displayCount", Math.min(Math.max(e2, t2), r2));
  }
  get displayCount() {
    return this._get("displayCount");
  }
  get objectId() {
    var _a2, _b2, _c2;
    return (_c2 = (_b2 = (_a2 = this.graphic) == null ? void 0 : _a2.attributes) == null ? void 0 : _b2[this.objectIdField]) != null ? _c2 : null;
  }
  get objectIdField() {
    var _a2;
    return ((_a2 = this.layer) == null ? void 0 : _a2.objectIdField) || null;
  }
  get relatedFeatures() {
    return this._get("relatedFeatures") || new j$V();
  }
  get relatedLayer() {
    const { layer: e2, map: t2, relationship: r2 } = this;
    return (e2 == null ? void 0 : e2.loaded) ? ye$2(t2, e2, r2) : null;
  }
  get relationship() {
    var _a2, _b2;
    const { relationshipId: e2, layer: t2 } = this;
    return typeof e2 == "number" ? (_b2 = (_a2 = t2 == null ? void 0 : t2.relationships) == null ? void 0 : _a2.find(({ id: t3 }) => t3 === e2)) != null ? _b2 : null : null;
  }
  get relatedFeatureViewModels() {
    return this._get("relatedFeatureViewModels") || new j$V();
  }
  get state() {
    const { _queryAbortController: e2, _queryFeatureCountAbortController: t2, _queryPageAbortController: r2, graphic: o2, relatedLayer: l2 } = this;
    return t2 ? "loading" : e2 || r2 ? "querying" : o2 && l2 ? "ready" : "disabled";
  }
  _destroyRelatedFeatureViewModels() {
    var _a2;
    (_a2 = this.relatedFeatureViewModels) == null ? void 0 : _a2.forEach((e2) => !e2.destroyed && e2.destroy()), this.relatedFeatureViewModels.removeAll();
  }
  async _queryFeatureCount() {
    var _a2, _b2, _c2, _d2, _e3;
    const { layer: e2, relatedLayer: t2, relationshipId: r2, objectId: o2, _queryFeatureCountAbortController: l2 } = this;
    if (await (e2 == null ? void 0 : e2.load()), !t2 || typeof o2 != "number" || !((_b2 = (_a2 = e2 == null ? void 0 : e2.capabilities) == null ? void 0 : _a2.queryRelated) == null ? void 0 : _b2.supportsCount))
      return void this._set("featureCount", 0);
    await t2.load();
    const a2 = t2.createQuery(), s2 = (_e3 = (_d2 = (_c2 = e2.capabilities) == null ? void 0 : _c2.queryRelated) == null ? void 0 : _d2.supportsCacheHint) != null ? _e3 : false, i2 = new d$W({ cacheHint: s2, relationshipId: r2, returnGeometry: false, objectIds: [o2], where: a2.where }), n2 = await e2.queryRelatedFeaturesCount(i2, { signal: l2 == null ? void 0 : l2.signal });
    this._set("featureCount", n2[o2] || 0);
  }
  _sliceFeatures(e2) {
    const { showAllEnabled: t2, displayCount: r2 } = this;
    return t2 ? e2 : r2 ? e2.slice(0, r2) : [];
  }
  async _queryPage() {
    const { relatedFeatures: e2, featurePage: t2, showAllEnabled: r2, _queryPageAbortController: o2 } = this;
    !r2 || t2 < 2 || e2.addMany(await this._queryRelatedFeatures({ signal: o2 == null ? void 0 : o2.signal }));
  }
  async _queryRelatedFeatures(e2) {
    var _a2, _b2, _c2, _d2, _e3;
    const { orderByFieldsFixedCasing: t2, showAllEnabled: r2, featuresPerPage: o2, displayCount: l2, layer: a2, relationshipId: s2, featurePage: i2, featureCount: n2, relatedLayer: u2 } = this;
    await (a2 == null ? void 0 : a2.load());
    const { relationship: d2, objectId: y2 } = this;
    if (!d2 || typeof y2 != "number" || !((_b2 = (_a2 = a2 == null ? void 0 : a2.capabilities) == null ? void 0 : _a2.queryRelated) == null ? void 0 : _b2.supportsPagination))
      return [];
    const h2 = r2 ? ((i2 - 1) * o2 + n2) % n2 : 0, c2 = r2 ? o2 : l2;
    if (!u2)
      return [];
    await u2.load();
    const C2 = u2.objectIdField, _2 = [...t2 == null ? void 0 : t2.map((e3) => e3.field), C2], g2 = t2 == null ? void 0 : t2.map((e3) => `${e3.field} ${e3.order}`), b2 = ((_d2 = (_c2 = a2.capabilities) == null ? void 0 : _c2.queryRelated) == null ? void 0 : _d2.supportsCacheHint) || false, F2 = u2.createQuery(), m2 = new d$W({ orderByFields: g2, start: h2, num: c2, outFields: _2, cacheHint: b2, relationshipId: s2, returnGeometry: false, objectIds: [y2], where: F2.where }), q2 = ((_e3 = (await a2.queryRelatedFeatures(m2, { signal: e2 == null ? void 0 : e2.signal }))[y2]) == null ? void 0 : _e3.features) || [];
    return q2.forEach((e3) => e3.sourceLayer = u2), q2;
  }
};
e$2g([y$1I()], g$u.prototype, "_queryAbortController", void 0), e$2g([y$1I()], g$u.prototype, "_queryPageAbortController", void 0), e$2g([y$1I()], g$u.prototype, "_queryFeatureCountAbortController", void 0), e$2g([y$1I({ value: 1 })], g$u.prototype, "featurePage", null), e$2g([y$1I()], g$u.prototype, "featuresPerPage", void 0), e$2g([y$1I({ readOnly: true })], g$u.prototype, "orderByFieldsFixedCasing", null), e$2g([y$1I()], g$u.prototype, "description", void 0), e$2g([y$1I({ readOnly: true })], g$u.prototype, "itemDescriptionFieldName", null), e$2g([y$1I({ value: 3 })], g$u.prototype, "displayCount", null), e$2g([y$1I({ type: g$10 })], g$u.prototype, "graphic", void 0), e$2g([y$1I()], g$u.prototype, "layer", void 0), e$2g([y$1I()], g$u.prototype, "map", void 0), e$2g([y$1I({ readOnly: true })], g$u.prototype, "objectId", null), e$2g([y$1I({ readOnly: true })], g$u.prototype, "objectIdField", null), e$2g([y$1I()], g$u.prototype, "orderByFields", void 0), e$2g([y$1I({ readOnly: true })], g$u.prototype, "relatedFeatures", null), e$2g([y$1I({ readOnly: true })], g$u.prototype, "relatedLayer", null), e$2g([y$1I({ readOnly: true })], g$u.prototype, "relationship", null), e$2g([y$1I({ readOnly: true })], g$u.prototype, "featureCount", void 0), e$2g([y$1I({ readOnly: true })], g$u.prototype, "relatedFeatureViewModels", null), e$2g([y$1I()], g$u.prototype, "relationshipId", void 0), e$2g([y$1I()], g$u.prototype, "showAllEnabled", void 0), e$2g([y$1I({ readOnly: true })], g$u.prototype, "state", null), e$2g([y$1I()], g$u.prototype, "title", void 0), g$u = e$2g([n$2P("esri.widgets.Feature.FeatureRelationship.FeatureRelationshipViewModel")], g$u);
const b$p = g$u;
const g$t = { base: "esri-feature-relationship", esriWidget: "esri-widget", listContainer: "esri-feature-relationship__list", listContainerQuerying: "esri-feature-relationship__list--querying", featureObserver: "esri-feature__feature-observer", stickySpinnerContainer: "esri-feature__sticky-loading-container", loadingSpinnerContainer: "esri-feature__loading-container", spinner: "esri-feature__loading-spinner", iconLoading: "esri-icon-loading-indicator esri-rotating" }, f$F = { title: true, description: true };
let w$l = class extends M$u {
  constructor(e2, t2) {
    super(e2, t2), this._featureElementInfo = null, this._relatedFeatureIntersectionObserver = new IntersectionObserver(([e3]) => {
      (e3 == null ? void 0 : e3.isIntersecting) && this._increaseFeaturePage();
    }, { root: window.document }), this.headingLevel = 2, this.viewModel = new b$p(), this.messages = null, this.messagesCommon = null, this.visibleElements = __spreadValues({}, f$F), this._increaseFeaturePage = () => {
      const { state: e3, showAllEnabled: t3, relatedFeatures: r2, featuresPerPage: s2, featurePage: i2 } = this.viewModel;
      e3 === "ready" && t3 && r2.length >= s2 * i2 && this.viewModel.featurePage++;
    };
  }
  initialize() {
    this._featureElementInfo = new l$1E(), this.addHandles([l$1P(() => [this.viewModel.description, this.viewModel.title, this.headingLevel], () => this._setupFeatureElementInfo(), h$1j), l$1P(() => [this.viewModel.state, this.viewModel.showAllEnabled, this._relatedFeatureIntersectionObserverNode], () => this._handleRelatedFeatureObserverChange()), a$2a(() => this.viewModel.relatedFeatureViewModels, "change", () => this._setupRelatedFeatureViewModels())]);
  }
  loadDependencies() {
    return Promise.all([import("./calcite-list.js"), import("./calcite-list-item.js"), import("./calcite-icon.js"), import("./calcite-notice.js")]);
  }
  destroy() {
    this._unobserveRelatedFeatureObserver(), this._featureElementInfo = s$2D(this._featureElementInfo);
  }
  get displayShowAllButton() {
    const { showAllEnabled: e2, featureCount: t2, displayCount: r2 } = this.viewModel;
    return !e2 && (t2 > r2 || r2 === 0);
  }
  get displayListItems() {
    return this.displayShowAllButton || this.viewModel.relatedFeatureViewModels.length > 0;
  }
  get description() {
    return this.viewModel.description;
  }
  set description(e2) {
    this.viewModel.description = e2;
  }
  get featureCountDescription() {
    const { messages: e2 } = this, { featureCount: t2 } = this.viewModel;
    return s$1L(t2 === 1 ? e2 == null ? void 0 : e2.numberRecord : e2 == null ? void 0 : e2.numberRecords, { number: t2 });
  }
  get title() {
    return this.viewModel.title;
  }
  set title(e2) {
    this.viewModel.title = e2;
  }
  castVisibleElements(e2) {
    return __spreadValues(__spreadValues({}, f$F), e2);
  }
  renderStickyLoading() {
    return this.viewModel.state === "querying" ? n$1U("div", { key: "sticky-loader", class: g$t.stickySpinnerContainer }, this.renderLoadingIcon()) : null;
  }
  renderLoadingIcon() {
    return n$1U("span", { class: this.classes(g$t.iconLoading, g$t.spinner) });
  }
  renderLoading() {
    return n$1U("div", { key: "loading-container", class: g$t.loadingSpinnerContainer }, this.renderLoadingIcon());
  }
  renderShowAllIconNode() {
    return n$1U("calcite-icon", { scale: "s", icon: "list", slot: "content-end" });
  }
  renderChevronIconNode() {
    const e2 = f$1g(this.container) ? "chevron-left" : "chevron-right";
    return n$1U("calcite-icon", { scale: "s", icon: e2, slot: "content-end" });
  }
  renderRelatedFeature(e2) {
    var _a2, _b2;
    const { itemDescriptionFieldName: t2 } = this.viewModel, r2 = e2.title;
    e2.description = t2 && ((_a2 = e2.formattedAttributes) == null ? void 0 : _a2.global[t2]);
    const s2 = e2.state === "loading";
    return n$1U("calcite-list-item", { key: e2.uid, label: s2 ? `${(_b2 = this.messagesCommon) == null ? void 0 : _b2.loading}\u2026` : r2, description: s2 ? "\u2026" : e2.description, onclick: () => this.emit("select-record", { featureViewModel: e2 }) }, this.renderChevronIconNode());
  }
  renderShowAllListItem() {
    var _a2;
    return this.displayShowAllButton ? n$1U("calcite-list-item", { key: "show-all-item", label: (_a2 = this.messages) == null ? void 0 : _a2.showAll, description: this.featureCountDescription, onclick: () => this.emit("show-all-records") }, this.renderShowAllIconNode()) : null;
  }
  renderNoRelatedFeaturesMessage() {
    var _a2;
    return n$1U("calcite-notice", { key: "no-related-features-message", icon: "information", open: true, color: "blue", scale: "s", width: "full" }, n$1U("div", { slot: "message" }, (_a2 = this.messages) == null ? void 0 : _a2.noRelatedFeatures));
  }
  renderFeatureObserver() {
    return n$1U("div", { key: "feature-observer", class: g$t.featureObserver, bind: this, afterCreate: this._relatedFeatureIntersectionObserverCreated });
  }
  renderList() {
    const { relatedFeatureViewModels: e2 } = this.viewModel;
    return n$1U("calcite-list", null, e2.toArray().map((e3) => this.renderRelatedFeature(e3)), this.renderShowAllListItem());
  }
  renderRelatedFeatures() {
    const { displayListItems: e2 } = this, { state: t2 } = this.viewModel;
    return n$1U("div", { key: "list-container", class: this.classes(g$t.listContainer, { [g$t.listContainerQuerying]: t2 === "querying" }) }, e2 ? this.renderList() : t2 === "ready" ? this.renderNoRelatedFeaturesMessage() : null, this.renderStickyLoading(), this.renderFeatureObserver());
  }
  renderRelationshipNotFound() {
    var _a2;
    return n$1U("calcite-notice", { key: "relationship-not-found", icon: "exclamation-mark-triangle", open: true, color: "red", scale: "s", width: "full" }, n$1U("div", { slot: "message" }, (_a2 = this.messages) == null ? void 0 : _a2.relationshipNotFound));
  }
  render() {
    var _a2;
    const { state: e2 } = this.viewModel;
    return n$1U("div", { class: this.classes(g$t.base, g$t.esriWidget) }, (_a2 = this._featureElementInfo) == null ? void 0 : _a2.render(), e2 === "loading" ? this.renderLoading() : e2 === "disabled" ? this.renderRelationshipNotFound() : this.renderRelatedFeatures());
  }
  _setupRelatedFeatureViewModels() {
    const { relatedFeatureViewModels: e2 } = this.viewModel, t2 = "related-feature-viewmodels";
    this.removeHandles(t2), e2 == null ? void 0 : e2.forEach((e3) => {
      this.addHandles(l$1P(() => [e3.title, e3.state], () => this.scheduleRender(), h$1j), t2);
    }), this.scheduleRender();
  }
  _setupFeatureElementInfo() {
    const { headingLevel: e2, visibleElements: t2 } = this, r2 = t2.description && this.description, s2 = t2.title && this.title;
    this._featureElementInfo.set({ description: r2, title: s2, headingLevel: e2 });
  }
  async _handleRelatedFeatureObserverChange() {
    this._unobserveRelatedFeatureObserver();
    const { state: e2, showAllEnabled: t2 } = this.viewModel;
    await U$z(0), this._relatedFeatureIntersectionObserverNode && e2 === "ready" && t2 && this._relatedFeatureIntersectionObserver.observe(this._relatedFeatureIntersectionObserverNode);
  }
  _relatedFeatureIntersectionObserverCreated(e2) {
    this._relatedFeatureIntersectionObserverNode = e2;
  }
  _unobserveRelatedFeatureObserver() {
    this._relatedFeatureIntersectionObserverNode && this._relatedFeatureIntersectionObserver.unobserve(this._relatedFeatureIntersectionObserverNode);
  }
};
e$2g([y$1I()], w$l.prototype, "_relatedFeatureIntersectionObserverNode", void 0), e$2g([y$1I({ readOnly: true })], w$l.prototype, "displayShowAllButton", null), e$2g([y$1I({ readOnly: true })], w$l.prototype, "displayListItems", null), e$2g([y$1I()], w$l.prototype, "description", null), e$2g([y$1I({ readOnly: true })], w$l.prototype, "featureCountDescription", null), e$2g([y$1I()], w$l.prototype, "headingLevel", void 0), e$2g([y$1I()], w$l.prototype, "title", null), e$2g([y$1I({ type: b$p })], w$l.prototype, "viewModel", void 0), e$2g([y$1I(), e$1g("esri/widgets/Feature/t9n/Feature")], w$l.prototype, "messages", void 0), e$2g([y$1I(), e$1g("esri/t9n/common")], w$l.prototype, "messagesCommon", void 0), e$2g([y$1I()], w$l.prototype, "visibleElements", void 0), e$2g([s$2i("visibleElements")], w$l.prototype, "castVisibleElements", null), w$l = e$2g([n$2P("esri.widgets.Feature.FeatureRelationship")], w$l);
const b$o = w$l;
class e$K {
  constructor(e2, a2) {
    this.preLayerQueryCallback = e2, this.preRequestCallback = a2, this.preLayerQueryCallback || (this.preLayerQueryCallback = (e3) => {
    }), this.preRequestCallback || (this.preLayerQueryCallback = (e3) => {
    });
  }
}
var Q$9;
const G$h = 1, H$b = "content-view-models", z$m = "relationship-view-models", J$f = { attachmentsContent: true, chartAnimation: true, customContent: true, expressionContent: true, fieldsContent: true, mediaContent: true, textContent: true, relationshipContent: true };
let K$a = Q$9 = class extends s$1$(m$2q) {
  constructor(e2) {
    super(e2), this._handles = new t$2g(), this._error = null, this._featureAbortController = null, this._graphicChangedThrottled = e$1n(this._graphicChanged, G$h, this), this._expressionAttributes = null, this._graphicExpressionAttributes = null, this.abilities = __spreadValues({}, J$f), this.content = null, this.contentViewModels = [], this.description = null, this.defaultPopupTemplateEnabled = false, this.formattedAttributes = null, this.lastEditInfo = null, this.relatedInfos = new Map(), this.title = "", this.view = null, this._isAllowedContentType = (e3) => {
      const { abilities: t2 } = this;
      return e3.type === "attachments" && t2.attachmentsContent || e3.type === "custom" && t2.customContent || e3.type === "fields" && t2.fieldsContent || e3.type === "media" && t2.mediaContent || e3.type === "text" && t2.textContent || e3.type === "expression" && t2.expressionContent || e3.type === "relationship" && t2.relationshipContent;
    }, this._handles.add(l$1P(() => [this.graphic, this._effectivePopupTemplate, this.abilities], () => this._graphicChangedThrottled(), h$1j));
  }
  destroy() {
    this._clear(), this._cancelFeatureQuery(), this._error = null, this._handles.destroy(), this._handles = null, this.graphic = null, this._destroyContentViewModels(), this.relatedInfos.clear();
  }
  get _effectivePopupTemplate() {
    return r$1$(this.graphic) ? this.graphic.getEffectivePopupTemplate(this.defaultPopupTemplateEnabled) : null;
  }
  get _fieldInfoMap() {
    return X$a(Y$9(this._effectivePopupTemplate), this._sourceLayer);
  }
  get _sourceLayer() {
    return T$s(this.graphic);
  }
  castAbilities(e2) {
    return __spreadValues(__spreadValues({}, J$f), e2);
  }
  get state() {
    return this.graphic ? this._error ? "error" : this.waitingForContent ? "loading" : "ready" : "disabled";
  }
  set graphic(e2) {
    this._set("graphic", e2 ? e2.clone() : null);
  }
  get spatialReference() {
    var _a2, _b2;
    return (_b2 = (_a2 = this.view) == null ? void 0 : _a2.spatialReference) != null ? _b2 : null;
  }
  set spatialReference(e2) {
    this._override("spatialReference", e2);
  }
  get map() {
    var _a2;
    return ((_a2 = this.view) == null ? void 0 : _a2.map) || null;
  }
  set map(e2) {
    this._override("map", e2);
  }
  get waitingForContent() {
    return !!this._featureAbortController;
  }
  setActiveMedia(e2, t2) {
    const i2 = this.contentViewModels[e2];
    i2 instanceof v$H && i2.setActiveMedia(t2);
  }
  nextMedia(e2) {
    const t2 = this.contentViewModels[e2];
    t2 instanceof v$H && t2.next();
  }
  previousMedia(e2) {
    const t2 = this.contentViewModels[e2];
    t2 instanceof v$H && t2.previous();
  }
  _clear() {
    this._set("title", ""), this._set("content", null), this._set("formattedAttributes", null);
  }
  async _graphicChanged() {
    this._cancelFeatureQuery(), this._error = null, this._clear();
    const { graphic: e2 } = this;
    if (!e2)
      return;
    const t2 = new AbortController();
    this._featureAbortController = t2;
    try {
      await this._queryFeature({ signal: t2.signal });
    } catch (i2) {
      j$_(i2) || (this._error = i2, s$2z.getLogger(this.declaredClass).error("error", "The popupTemplate could not be displayed for this feature.", { error: i2, graphic: e2, popupTemplate: this._effectivePopupTemplate }));
    }
    this._featureAbortController === t2 && (this._featureAbortController = null);
  }
  _cancelFeatureQuery() {
    const { _featureAbortController: e2 } = this;
    e2 && e2.abort(), this._featureAbortController = null;
  }
  _compileContentElement(e2, t2) {
    return e2.type === "attachments" ? this._compileAttachments(e2, t2) : e2.type === "custom" ? this._compileCustom(e2, t2) : e2.type === "fields" ? this._compileFields(e2, t2) : e2.type === "media" ? this._compileMedia(e2, t2) : e2.type === "text" ? this._compileText(e2, t2) : e2.type === "expression" ? this._compileExpression(e2, t2) : e2.type === "relationship" ? this._compileRelationship(e2, t2) : void 0;
  }
  _compileContent(e2) {
    if (this._destroyContentViewModels(), this.graphic)
      return Array.isArray(e2) ? e2.filter(this._isAllowedContentType).map((e3, t2) => this._compileContentElement(e3, t2)) : typeof e2 == "string" ? this._compileText(new c$2T({ text: e2 }), 0).text : e2;
  }
  _destroyContentViewModels() {
    var _a2, _b2;
    (_a2 = this._handles) == null ? void 0 : _a2.remove(z$m), (_b2 = this._handles) == null ? void 0 : _b2.remove(H$b), this.contentViewModels.forEach((e2) => e2 && !e2.destroyed && e2.destroy()), this._set("contentViewModels", []);
  }
  _matchesFeature(e2, t2) {
    var _a2;
    const i2 = (_a2 = e2 == null ? void 0 : e2.graphic) == null ? void 0 : _a2.getObjectId(), r2 = t2 == null ? void 0 : t2.getObjectId();
    return r$1$(i2) && r$1$(r2) && i2 === r2;
  }
  _setRelatedFeaturesViewModels({ relatedFeatureViewModels: e2, relatedFeatures: t2, map: i2 }) {
    t2 == null ? void 0 : t2.filter(Boolean).forEach((t3) => {
      e2.find((e3) => this._matchesFeature(e3, t3)) || e2.add(new Q$9({ abilities: { relationshipContent: false }, map: i2, graphic: t3 }));
    }), e2.forEach((i3) => {
      const r2 = t2 == null ? void 0 : t2.find((e3) => this._matchesFeature(i3, e3));
      r2 || e2.remove(i3);
    });
  }
  _setExpressionContentVM(e2, t2) {
    const { formattedAttributes: i2 } = this, { contentElement: r2, contentElementViewModel: o2 } = e2, s2 = r2 == null ? void 0 : r2.type;
    o2 && s2 && (s2 === "fields" && (this._createFieldsFormattedAttributes({ contentElement: r2, contentElementIndex: t2, formattedAttributes: i2 }), o2.set(this._createFieldsVMParams(r2, t2))), s2 === "media" && (this._createMediaFormattedAttributes({ contentElement: r2, contentElementIndex: t2, formattedAttributes: i2 }), o2.set(this._createMediaVMParams(r2, t2))), s2 === "text" && o2.set(this._createTextVMParams(r2)));
  }
  _compileRelationship(e2, t2) {
    const { displayCount: i2, orderByFields: r2, relationshipId: o2, title: s2, description: n2 } = e2, { _sourceLayer: a2, graphic: l2, map: p2 } = this, c2 = new b$p(__spreadValues({ displayCount: i2, graphic: l2, orderByFields: r2, relationshipId: o2, layer: a2, map: p2 }, this._compileTitleAndDesc({ title: s2, description: n2 })));
    return this.contentViewModels[t2] = c2, this._handles.add(a$2a(() => c2.relatedFeatures, "change", () => this._setRelatedFeaturesViewModels(c2)), z$m), e2;
  }
  _compileExpression(e2, t2) {
    const { expressionInfo: i2 } = e2, { graphic: r2, map: o2, spatialReference: s2, view: n2 } = this, a2 = new C$l({ expressionInfo: i2, graphic: r2, interceptor: Q$9.interceptor, map: o2, spatialReference: s2, view: n2 });
    return this.contentViewModels[t2] = a2, this._handles.add(l$1P(() => a2.contentElementViewModel, () => this._setExpressionContentVM(a2, t2), h$1j), H$b), e2;
  }
  _compileAttachments(e2, t2) {
    const { graphic: i2 } = this, { description: r2, title: o2 } = e2;
    return this.contentViewModels[t2] = new c$24(__spreadValues({ graphic: i2 }, this._compileTitleAndDesc({ title: o2, description: r2 }))), e2;
  }
  _compileCustom(e2, t2) {
    const { graphic: i2 } = this, { creator: r2, destroyer: o2 } = e2;
    return this.contentViewModels[t2] = new l$1D({ graphic: i2, creator: r2, destroyer: o2 }), e2;
  }
  _compileTitleAndDesc({ title: e2, description: t2 }) {
    const { _fieldInfoMap: i2, _sourceLayer: r2, graphic: o2, formattedAttributes: s2, _expressionAttributes: n2 } = this, { attributes: a2 } = o2, l2 = s2.global;
    return { title: $$c({ attributes: a2, fieldInfoMap: i2, globalAttributes: l2, expressionAttributes: n2, layer: r2, text: e2 }), description: $$c({ attributes: a2, fieldInfoMap: i2, globalAttributes: l2, expressionAttributes: n2, layer: r2, text: t2 }) };
  }
  _createFieldsVMParams(e2, t2) {
    var _a2;
    const { _effectivePopupTemplate: i2, formattedAttributes: r2 } = this, o2 = __spreadValues(__spreadValues({}, r2.global), r2.content[t2]), s2 = (_a2 = (e2 == null ? void 0 : e2.fieldInfos) || (i2 == null ? void 0 : i2.fieldInfos)) == null ? void 0 : _a2.filter(({ fieldName: e3 }) => C$u(e3) || le$2(e3) || o2.hasOwnProperty(e3)), n2 = i2 == null ? void 0 : i2.expressionInfos, { description: a2, title: l2 } = e2;
    return __spreadValues({ attributes: o2, expressionInfos: n2, fieldInfos: s2 }, this._compileTitleAndDesc({ title: l2, description: a2 }));
  }
  _compileFields(e2, t2) {
    const i2 = e2.clone(), r2 = new n$1Q(this._createFieldsVMParams(e2, t2));
    return this.contentViewModels[t2] = r2, i2.fieldInfos = r2.formattedFieldInfos.slice(0), i2;
  }
  _createMediaVMParams(e2, t2) {
    const { abilities: i2, graphic: r2, _fieldInfoMap: o2, formattedAttributes: s2, _effectivePopupTemplate: n2, relatedInfos: a2, _sourceLayer: l2, _expressionAttributes: p2 } = this, { attributes: c2 } = r2, { description: d2, mediaInfos: h2, title: u2 } = e2;
    return __spreadValues({ abilities: { chartAnimation: i2.chartAnimation }, activeMediaInfoIndex: e2.activeMediaInfoIndex || 0, attributes: c2, layer: l2, fieldInfoMap: o2, formattedAttributes: __spreadValues(__spreadValues({}, s2.global), s2.content[t2]), expressionAttributes: p2, mediaInfos: h2, popupTemplate: n2, relatedInfos: a2 }, this._compileTitleAndDesc({ title: u2, description: d2 }));
  }
  _compileMedia(e2, t2) {
    const i2 = e2.clone(), r2 = new v$H(this._createMediaVMParams(e2, t2));
    return i2.mediaInfos = r2.formattedMediaInfos.slice(0), this.contentViewModels[t2] = r2, i2;
  }
  _createTextVMParams(e2) {
    const { graphic: t2, _fieldInfoMap: i2, _sourceLayer: r2, _expressionAttributes: o2 } = this;
    if (e2 && e2.text) {
      const { attributes: s2 } = t2, n2 = this.formattedAttributes.global;
      e2.text = $$c({ attributes: s2, fieldInfoMap: i2, globalAttributes: n2, expressionAttributes: o2, layer: r2, text: e2.text });
    }
    return { graphic: t2, creator: e2.text };
  }
  _compileText(e2, t2) {
    const i2 = e2.clone();
    return this.contentViewModels[t2] = new l$1D(this._createTextVMParams(i2)), i2;
  }
  _compileLastEditInfo() {
    const { _effectivePopupTemplate: e2, _sourceLayer: t2, graphic: i2 } = this;
    if (!e2)
      return;
    const { lastEditInfoEnabled: r2 } = e2, o2 = t2 == null ? void 0 : t2.editFieldsInfo;
    return r2 && o2 ? W$c(o2, i2.attributes) : void 0;
  }
  _compileTitle(e2) {
    const { _fieldInfoMap: t2, _sourceLayer: i2, graphic: r2, _expressionAttributes: o2 } = this, { attributes: s2 } = r2, n2 = this.formattedAttributes.global;
    return $$c({ attributes: s2, fieldInfoMap: t2, globalAttributes: n2, expressionAttributes: o2, layer: i2, text: e2 });
  }
  async _getTitle() {
    const { _effectivePopupTemplate: e2, graphic: t2 } = this, i2 = e2 == null ? void 0 : e2.title;
    return j$C(i2, { graphic: t2 });
  }
  async _getContent() {
    const { _effectivePopupTemplate: e2, graphic: t2 } = this, i2 = e2 == null ? void 0 : e2.content;
    return j$C(i2, { graphic: t2 });
  }
  async _queryFeature(e2) {
    const { _featureAbortController: t2, _sourceLayer: i2, graphic: r2, _effectivePopupTemplate: o2, spatialReference: s2, map: n2, view: a2 } = this;
    if (t2 !== this._featureAbortController || !r2)
      return;
    await ae$2({ graphic: r2, popupTemplate: o2, layer: i2, spatialReference: s2 }, e2);
    const { content: { value: l2 }, title: { value: c2 } } = await E$Q({ content: this._getContent(), title: this._getTitle() }), { expressionAttributes: { value: d2 } } = await E$Q({ checkForRelatedFeatures: this._checkForRelatedFeatures(e2), expressionAttributes: m$10({ expressionInfos: o2 == null ? void 0 : o2.expressionInfos, spatialReference: s2, graphic: r2, map: n2, interceptor: Q$9.interceptor, view: a2 }) });
    t2 === this._featureAbortController && r2 && (this._expressionAttributes = d2, this._graphicExpressionAttributes = __spreadValues(__spreadValues({}, r2.attributes), d2), this._set("formattedAttributes", this._createFormattedAttributes(l2)), this._set("title", this._compileTitle(c2)), this._set("lastEditInfo", this._compileLastEditInfo() || null), this._set("content", this._compileContent(l2) || null));
  }
  _createMediaFormattedAttributes({ contentElement: e2, contentElementIndex: t2, formattedAttributes: i2 }) {
    const { _effectivePopupTemplate: r2, graphic: o2, relatedInfos: s2, _sourceLayer: n2, _fieldInfoMap: a2, _graphicExpressionAttributes: l2 } = this;
    i2.content[t2] = ne$2({ fieldInfos: r2 == null ? void 0 : r2.fieldInfos, graphic: o2, attributes: __spreadValues(__spreadValues({}, l2), e2.attributes), layer: n2, fieldInfoMap: a2, relatedInfos: s2 });
  }
  _createFieldsFormattedAttributes({ contentElement: e2, contentElementIndex: t2, formattedAttributes: i2 }) {
    if (e2.fieldInfos) {
      const { graphic: r2, relatedInfos: o2, _sourceLayer: s2, _fieldInfoMap: n2, _graphicExpressionAttributes: a2 } = this;
      i2.content[t2] = ne$2({ fieldInfos: e2.fieldInfos, graphic: r2, attributes: __spreadValues(__spreadValues({}, a2), e2.attributes), layer: s2, fieldInfoMap: n2, relatedInfos: o2 });
    }
  }
  _createFormattedAttributes(e2) {
    const { _effectivePopupTemplate: t2, graphic: i2, relatedInfos: r2, _sourceLayer: o2, _fieldInfoMap: s2, _graphicExpressionAttributes: n2 } = this, a2 = t2 == null ? void 0 : t2.fieldInfos, l2 = { global: ne$2({ fieldInfos: a2, graphic: i2, attributes: n2, layer: o2, fieldInfoMap: s2, relatedInfos: r2 }), content: [] };
    return Array.isArray(e2) && e2.forEach((e3, t3) => {
      e3.type === "fields" && this._createFieldsFormattedAttributes({ contentElement: e3, contentElementIndex: t3, formattedAttributes: l2 }), e3.type === "media" && this._createMediaFormattedAttributes({ contentElement: e3, contentElementIndex: t3, formattedAttributes: l2 });
    }), l2;
  }
  _checkForRelatedFeatures(e2) {
    const { graphic: t2, _effectivePopupTemplate: i2 } = this;
    return this._queryRelatedInfos(t2, Y$9(i2), e2);
  }
  async _queryRelatedInfos(e2, t2, i2) {
    const { relatedInfos: r2, _sourceLayer: o2 } = this;
    r2.clear();
    const s2 = r$1$(o2.associatedLayer) ? await o2.associatedLayer.load(i2) : o2;
    if (!s2)
      return;
    const n2 = t2.filter((e3) => e3 && le$2(e3.fieldName));
    if (!n2 || !n2.length)
      return;
    t2.forEach((e3) => this._configureRelatedInfo(e3, s2));
    const l2 = await b$G({ relatedInfos: r2, layer: s2 }, i2);
    Object.keys(l2).forEach((e3) => {
      var _a2;
      const t3 = r2.get(e3.toString()), i3 = (_a2 = l2[e3]) == null ? void 0 : _a2.value;
      t3 && i3 && (t3.layerInfo = i3.data);
    });
    const p2 = await R$l({ graphic: e2, relatedInfos: r2, layer: s2 }, i2);
    Object.keys(p2).forEach((e3) => {
      var _a2;
      g$K((_a2 = p2[e3]) == null ? void 0 : _a2.value, r2.get(e3.toString()));
    });
  }
  _configureRelatedInfo(e2, t2) {
    const { relatedInfos: i2 } = this, r2 = d$V(e2.fieldName);
    if (!r2)
      return;
    const { layerId: o2, fieldName: s2 } = r2;
    if (!o2)
      return;
    const n2 = i2.get(o2.toString()) || h$Z(o2, t2);
    n2 && ($$8({ relatedInfo: n2, fieldName: s2, fieldInfo: e2 }), this.relatedInfos.set(o2, n2));
  }
};
K$a.interceptor = new e$K(pe$1, me$1), e$2g([y$1I()], K$a.prototype, "_error", void 0), e$2g([y$1I()], K$a.prototype, "_featureAbortController", void 0), e$2g([y$1I({ readOnly: true })], K$a.prototype, "_effectivePopupTemplate", null), e$2g([y$1I({ readOnly: true })], K$a.prototype, "_fieldInfoMap", null), e$2g([y$1I({ readOnly: true })], K$a.prototype, "_sourceLayer", null), e$2g([y$1I()], K$a.prototype, "abilities", void 0), e$2g([s$2i("abilities")], K$a.prototype, "castAbilities", null), e$2g([y$1I({ readOnly: true })], K$a.prototype, "content", void 0), e$2g([y$1I({ readOnly: true })], K$a.prototype, "contentViewModels", void 0), e$2g([y$1I()], K$a.prototype, "description", void 0), e$2g([y$1I({ type: Boolean })], K$a.prototype, "defaultPopupTemplateEnabled", void 0), e$2g([y$1I({ readOnly: true })], K$a.prototype, "state", null), e$2g([y$1I({ readOnly: true })], K$a.prototype, "formattedAttributes", void 0), e$2g([y$1I({ type: g$10, value: null })], K$a.prototype, "graphic", null), e$2g([y$1I({ readOnly: true })], K$a.prototype, "lastEditInfo", void 0), e$2g([y$1I({ readOnly: true })], K$a.prototype, "relatedInfos", void 0), e$2g([y$1I()], K$a.prototype, "spatialReference", null), e$2g([y$1I({ readOnly: true })], K$a.prototype, "title", void 0), e$2g([y$1I()], K$a.prototype, "map", null), e$2g([y$1I({ readOnly: true })], K$a.prototype, "waitingForContent", null), e$2g([y$1I()], K$a.prototype, "view", void 0), K$a = Q$9 = e$2g([n$2P("esri.widgets.FeatureViewModel")], K$a);
const W$a = K$a;
const e$J = { iconText: "esri-icon-font-fallback-text", iconLoading: "esri-icon-loading-indicator esri-rotating", esriTable: "esri-widget__table", esriWidget: "esri-widget", base: "esri-feature", container: "esri-feature__size-container", title: "esri-feature__title", main: "esri-feature__main-container", btn: "esri-feature__button", icon: "esri-feature__icon", content: "esri-feature__content", contentNode: "esri-feature__content-node", contentElement: "esri-feature__content-element", text: "esri-feature__text", lastEditedInfo: "esri-feature__last-edited-info", fields: "esri-feature__fields", fieldHeader: "esri-feature__field-header", fieldData: "esri-feature__field-data", fieldDataDate: "esri-feature__field-data--date", loadingSpinnerContainer: "esri-feature__loading-container", spinner: "esri-feature__loading-spinner" };
const i$1d = (i2) => {
  let n2 = class extends i2 {
    constructor() {
      super(...arguments), this.renderNodeContent = (e2) => e$1b(e2) && !e2.destroyed ? n$1U("div", { class: e$J.contentNode, key: e2 }, e2.render()) : e2 instanceof HTMLElement ? n$1U("div", { class: e$J.contentNode, key: e2, bind: e2, afterCreate: this._attachToNode }) : t$1m(e2) ? n$1U("div", { class: e$J.contentNode, key: e2, bind: e2.domNode, afterCreate: this._attachToNode }) : null;
    }
    _attachToNode(e2) {
      const o2 = this;
      e2.appendChild(o2);
    }
  };
  return n2 = e$2g([n$2P("esri.widgets.Feature.ContentMixin")], n2), n2;
};
var E$o;
const _$o = { title: true, content: true, lastEditedInfo: true }, b$n = "relationship-handles";
let W$9 = E$o = class extends i$1d(M$u) {
  constructor(e2, t2) {
    super(e2, t2), this._contentWidgets = [], this.flowItems = null, this.headingLevel = 2, this.messages = null, this.messagesCommon = null, this.messagesURIUtils = null, this.visibleElements = __spreadValues({}, _$o), this.viewModel = new W$a();
  }
  initialize() {
    this.addHandles(l$1P(() => {
      var _a2;
      return (_a2 = this.viewModel) == null ? void 0 : _a2.contentViewModels;
    }, () => this._setupContentWidgets(), h$1j));
  }
  loadDependencies() {
    return import("./calcite-notice.js");
  }
  destroy() {
    this._destroyContentWidgets();
  }
  get graphic() {
    return this.viewModel.graphic;
  }
  set graphic(e2) {
    this.viewModel.graphic = e2;
  }
  get defaultPopupTemplateEnabled() {
    return this.viewModel.defaultPopupTemplateEnabled;
  }
  set defaultPopupTemplateEnabled(e2) {
    this.viewModel.defaultPopupTemplateEnabled = e2;
  }
  get label() {
    var _a2, _b2;
    return (_b2 = (_a2 = this.messages) == null ? void 0 : _a2.widgetLabel) != null ? _b2 : "";
  }
  set label(e2) {
    this._overrideIfSome("label", e2);
  }
  get spatialReference() {
    return this.viewModel.spatialReference;
  }
  set spatialReference(e2) {
    this.viewModel.spatialReference = e2;
  }
  get title() {
    return this.viewModel.title;
  }
  castVisibleElements(e2) {
    return __spreadValues(__spreadValues({}, _$o), e2);
  }
  get map() {
    return this.viewModel.map;
  }
  set map(e2) {
    this.viewModel.map = e2;
  }
  get view() {
    return this.viewModel.view;
  }
  set view(e2) {
    this.viewModel.view = e2;
  }
  render() {
    const { state: e2 } = this.viewModel, t2 = n$1U("div", { class: e$J.container, key: "container" }, this.renderTitle(), e2 === "error" ? this.renderError() : e2 === "loading" ? this.renderLoading() : this.renderContentContainer());
    return n$1U("div", { class: this.classes(e$J.base, e$J.esriWidget) }, t2);
  }
  setActiveMedia(e2, t2) {
    return this.viewModel.setActiveMedia(e2, t2);
  }
  nextMedia(e2) {
    return this.viewModel.nextMedia(e2);
  }
  previousMedia(e2) {
    return this.viewModel.previousMedia(e2);
  }
  renderError() {
    const { messagesCommon: e2, messages: t2, visibleElements: s2 } = this;
    return n$1U("calcite-notice", { active: true, color: "red", icon: "exclamation-mark-circle", scale: "s" }, s2.title ? n$1U("div", { key: "error-title", slot: "title" }, e2.errorMessage) : null, n$1U("div", { key: "error-message", slot: "message" }, t2.loadingError));
  }
  renderLoading() {
    return n$1U("div", { key: "loading-container", class: e$J.loadingSpinnerContainer }, n$1U("span", { class: this.classes(e$J.iconLoading, e$J.spinner) }));
  }
  renderContentContainer() {
    const { visibleElements: e2 } = this;
    return e2.content ? n$1U("div", { class: e$J.main }, [this.renderContent(), this.renderLastEditInfo()]) : null;
  }
  renderTitle() {
    const { visibleElements: e2, title: t2 } = this;
    return e2.title ? n$1U(n$1T, { level: this.headingLevel, class: e$J.title, innerHTML: t2 }) : null;
  }
  renderContent() {
    const e2 = this.viewModel.content, t2 = "content";
    if (!e2)
      return null;
    if (Array.isArray(e2))
      return e2.length ? n$1U("div", { class: e$J.contentNode, key: `${t2}-content-elements` }, e2.map(this.renderContentElement, this)) : null;
    if (typeof e2 == "string") {
      const e3 = this._contentWidgets[0];
      return !e3 || e3.destroyed ? null : n$1U("div", { class: e$J.contentNode, key: `${t2}-content` }, e3.render());
    }
    return this.renderNodeContent(e2);
  }
  renderContentElement(e2, t2) {
    const { visibleElements: s2 } = this;
    if (typeof s2.content != "boolean" && !s2.content[e2.type])
      return null;
    switch (e2.type) {
      case "attachments":
        return this.renderAttachments(t2);
      case "custom":
        return this.renderCustom(e2, t2);
      case "fields":
        return this.renderFields(t2);
      case "media":
        return this.renderMedia(t2);
      case "text":
        return this.renderText(e2, t2);
      case "expression":
        return this.renderExpression(t2);
      case "relationship":
        return this.renderRelationship(t2);
      default:
        return null;
    }
  }
  renderAttachments(e2) {
    const t2 = this._contentWidgets[e2];
    if (!t2 || t2.destroyed)
      return null;
    const { state: s2, attachmentInfos: i2 } = t2.viewModel;
    return s2 === "loading" || i2.length > 0 ? n$1U("div", { key: this._buildKey("attachments-element", e2), class: this.classes(e$J.contentElement) }, t2.render()) : null;
  }
  renderRelationship(e2) {
    const t2 = this._contentWidgets[e2];
    return t2 && !t2.destroyed && this.flowItems ? n$1U("div", { key: this._buildKey("relationship-element", e2), class: e$J.contentElement }, t2.render()) : null;
  }
  renderExpression(e2) {
    const t2 = this._contentWidgets[e2];
    return !t2 || t2.destroyed ? null : n$1U("div", { key: this._buildKey("expression-element", e2), class: e$J.contentElement }, t2.render());
  }
  renderCustom(e2, t2) {
    const { creator: s2 } = e2, i2 = this._contentWidgets[t2];
    return !i2 || i2.destroyed ? null : s2 ? n$1U("div", { key: this._buildKey("custom-element", t2), class: e$J.contentElement }, i2.render()) : null;
  }
  renderFields(e2) {
    const t2 = this._contentWidgets[e2];
    return !t2 || t2.destroyed ? null : n$1U("div", { key: this._buildKey("fields-element", e2), class: e$J.contentElement }, t2.render());
  }
  renderMedia(e2) {
    const t2 = this._contentWidgets[e2];
    return !t2 || t2.destroyed ? null : n$1U("div", { key: this._buildKey("media-element", e2), class: e$J.contentElement }, t2.render());
  }
  renderLastEditInfo() {
    const { visibleElements: e2, messages: t2 } = this, { lastEditInfo: s2 } = this.viewModel;
    if (!s2 || !e2.lastEditedInfo)
      return null;
    const { date: i2, user: n2 } = s2, r2 = s2.type === "edit" ? n2 ? t2.lastEditedByUser : t2.lastEdited : n2 ? t2.lastCreatedByUser : t2.lastCreated, o2 = s$1L(r2, { date: i2, user: n2 });
    return n$1U("div", { key: "edit-info-element", class: this.classes(e$J.lastEditedInfo, e$J.contentElement) }, o2);
  }
  renderText(e2, t2) {
    const s2 = e2.text, i2 = this._contentWidgets[t2];
    return !i2 || i2.destroyed ? null : s2 ? n$1U("div", { key: this._buildKey("text-element", t2), class: this.classes(e$J.contentElement, e$J.text) }, i2.render()) : null;
  }
  _buildKey(e2, ...t2) {
    return `${e2}__${this.get("viewModel.graphic.uid") || "0"}-${t2.join("-")}`;
  }
  _destroyContentWidget(e2) {
    e2 && (e2.viewModel = null, !e2.destroyed && e2.destroy());
  }
  _destroyContentWidgets() {
    this.removeHandles(b$n), this._contentWidgets.forEach((e2) => this._destroyContentWidget(e2)), this._contentWidgets = [];
  }
  _addFeatureRelationshipHandles(e2) {
    const { flowItems: t2, visibleElements: i2 } = this;
    this.addHandles([a$2a(() => e2, "select-record", ({ featureViewModel: e3 }) => {
      t2 && (e3.abilities = { relationshipContent: true }, t2.push(new E$o({ flowItems: t2, viewModel: e3, visibleElements: i2 })));
    }), a$2a(() => e2, "show-all-records", () => {
      if (!t2)
        return;
      const { viewModel: s2 } = e2;
      s2.showAllEnabled = true;
      const i3 = new b$o({ visibleElements: { title: false, description: false }, viewModel: s2 });
      this._addFeatureRelationshipHandles(i3), t2.push(i3);
    })], b$n);
  }
  _setupContentWidgets() {
    this._destroyContentWidgets();
    const { headingLevel: e2, visibleElements: t2 } = this, s2 = this.get("viewModel.content"), { contentViewModels: i2 } = this.viewModel;
    if (Array.isArray(s2))
      s2.forEach((s3, n2) => {
        if (s3.type === "attachments" && (this._contentWidgets[n2] = new h$18({ displayType: s3.displayType, headingLevel: t2.title ? e2 + 1 : e2, viewModel: i2[n2] })), s3.type === "fields" && (this._contentWidgets[n2] = new m$1C({ viewModel: i2[n2] })), s3.type === "media" && (this._contentWidgets[n2] = new x$x({ viewModel: i2[n2] })), s3.type === "text" && (this._contentWidgets[n2] = new l$1C({ viewModel: i2[n2] })), s3.type === "custom" && (this._contentWidgets[n2] = new l$1C({ viewModel: i2[n2] })), s3.type === "expression" && (this._contentWidgets[n2] = new m$$({ viewModel: i2[n2] })), s3.type === "relationship") {
          const e3 = new b$o({ viewModel: i2[n2] });
          this._addFeatureRelationshipHandles(e3), this._contentWidgets[n2] = e3;
        }
      }, this);
    else {
      const e3 = i2[0];
      e3 && !e3.destroyed && (this._contentWidgets[0] = new l$1C({ viewModel: e3 }));
    }
    this.scheduleRender();
  }
};
e$2g([y$1I()], W$9.prototype, "graphic", null), e$2g([y$1I()], W$9.prototype, "defaultPopupTemplateEnabled", null), e$2g([y$1I()], W$9.prototype, "flowItems", void 0), e$2g([y$1I()], W$9.prototype, "headingLevel", void 0), e$2g([y$1I()], W$9.prototype, "label", null), e$2g([y$1I(), e$1g("esri/widgets/Feature/t9n/Feature")], W$9.prototype, "messages", void 0), e$2g([y$1I(), e$1g("esri/t9n/common")], W$9.prototype, "messagesCommon", void 0), e$2g([y$1I(), e$1g("esri/widgets/support/t9n/uriUtils")], W$9.prototype, "messagesURIUtils", void 0), e$2g([y$1I()], W$9.prototype, "spatialReference", null), e$2g([y$1I({ readOnly: true })], W$9.prototype, "title", null), e$2g([y$1I()], W$9.prototype, "visibleElements", void 0), e$2g([s$2i("visibleElements")], W$9.prototype, "castVisibleElements", null), e$2g([y$1I()], W$9.prototype, "map", null), e$2g([y$1I()], W$9.prototype, "view", null), e$2g([y$1I({ type: W$a })], W$9.prototype, "viewModel", void 0), W$9 = E$o = e$2g([n$2P("esri.widgets.Feature")], W$9);
const C$k = W$9;
var l$10;
const d$A = Symbol("anchorHandles");
let m$_ = class extends n$2G.EventedAccessor {
  constructor(e2) {
    super(e2), this[l$10] = new t$2g(), this.location = null, this.screenLocationEnabled = false, this.view = null, this[d$A].add([f$1o(() => o$2s(this.screenLocationEnabled ? this.view : null, (e3) => [e3.size, e3.type === "3d" ? e3.camera : e3.viewpoint]), () => this.notifyChange("screenLocation")), l$1P(() => this.screenLocation, (e3, o2) => {
      r$1$(e3) && r$1$(o2) && this.emit("view-change");
    })]);
  }
  destroy() {
    this.view = null, this[d$A] = s$2D(this[d$A]);
  }
  get screenLocation() {
    const { location: e2, view: o2, screenLocationEnabled: t2 } = this;
    return t2 && r$1$(e2) && r$1$(o2) && o2.ready ? o2.toScreen(e2) : null;
  }
};
l$10 = d$A, e$2g([y$1I()], m$_.prototype, "location", void 0), e$2g([y$1I()], m$_.prototype, "screenLocation", null), e$2g([y$1I()], m$_.prototype, "screenLocationEnabled", void 0), e$2g([y$1I()], m$_.prototype, "view", void 0), m$_ = e$2g([n$2P("esri.widgets.support.AnchorElementViewModel")], m$_);
const h$I = m$_;
const t$U = "esri.widgets.CompassViewModel";
let p$18 = class extends h$I {
  constructor(s2) {
    super(s2), this.visible = false;
  }
};
e$2g([y$1I()], p$18.prototype, "visible", void 0), p$18 = e$2g([n$2P(t$U)], p$18);
const c$12 = p$18;
const p$17 = { base: "esri-spinner", spinnerStart: "esri-spinner--start", spinnerFinish: "esri-spinner--finish" };
let c$11 = class extends M$u {
  constructor(i2, e2) {
    super(i2, e2), this._animationDelay = 500, this._animationPromise = null, this.viewModel = new c$12();
  }
  initialize() {
    this.addHandles(l$1P(() => this.visible, (i2) => this._visibleChange(i2)));
  }
  destroy() {
    this._animationPromise = null;
  }
  get location() {
    return this.viewModel.location;
  }
  set location(i2) {
    this.viewModel.location = i2;
  }
  get view() {
    return this.viewModel.view;
  }
  set view(i2) {
    this.viewModel.view = i2;
  }
  get visible() {
    return this.viewModel.visible;
  }
  set visible(i2) {
    this.viewModel.visible = i2;
  }
  show(i2) {
    const { location: e2, promise: t2 } = i2;
    e2 && (this.viewModel.location = e2), this.visible = true;
    const s2 = () => this.hide();
    t2 && t2.catch(() => {
    }).then(s2);
  }
  hide() {
    this.visible = false;
  }
  render() {
    const { visible: i2 } = this, { screenLocation: e2 } = this.viewModel, t2 = !!e2, s2 = i2 && t2, o2 = !i2 && t2, r2 = { [p$17.spinnerStart]: s2, [p$17.spinnerFinish]: o2 }, n2 = this._getPositionStyles();
    return n$1U("div", { class: this.classes(p$17.base, r2), styles: n2 });
  }
  _visibleChange(i2) {
    if (i2)
      return void (this.viewModel.screenLocationEnabled = true);
    const e2 = U$z(this._animationDelay);
    this._animationPromise = e2, e2.catch(() => {
    }).then(() => {
      this._animationPromise === e2 && (this.viewModel.screenLocationEnabled = false, this._animationPromise = null);
    });
  }
  _getPositionStyles() {
    const { screenLocation: i2, view: t2 } = this.viewModel;
    if (t$2r(t2) || t$2r(i2))
      return {};
    const { padding: s2 } = t2;
    return { left: i2.x - s2.left + "px", top: i2.y - s2.top + "px" };
  }
};
e$2g([y$1I()], c$11.prototype, "location", null), e$2g([y$1I()], c$11.prototype, "view", null), e$2g([y$1I({ type: c$12 })], c$11.prototype, "viewModel", void 0), e$2g([y$1I()], c$11.prototype, "visible", null), c$11 = e$2g([n$2P("esri.widgets.Spinner")], c$11);
const h$H = c$11;
const o$V = "OBJECTID";
var t$T;
!function(a2) {
  a2[a2.size = 22] = "size", a2[a2.lineWidth = 50] = "lineWidth", a2[a2.maxSize = 120] = "maxSize", a2[a2.maxOutlineSize = 80] = "maxOutlineSize", a2[a2.tallSymbolWidth = 20] = "tallSymbolWidth";
}(t$T || (t$T = {}));
function n$13() {
  const n2 = new Float32Array(6);
  return n2[0] = 1, n2[3] = 1, n2;
}
function t$S(n2) {
  const t2 = new Float32Array(6);
  return t2[0] = n2[0], t2[1] = n2[1], t2[2] = n2[2], t2[3] = n2[3], t2[4] = n2[4], t2[5] = n2[5], t2;
}
function r$V(n2, t2, r2, e2, o2, a2) {
  const c2 = new Float32Array(6);
  return c2[0] = n2, c2[1] = t2, c2[2] = r2, c2[3] = e2, c2[4] = o2, c2[5] = a2, c2;
}
function e$I(n2, t2) {
  return new Float32Array(n2, t2, 6);
}
function o$U(n2, t2, r2, e2) {
  const o2 = t2[e2], a2 = t2[e2 + 1];
  n2[e2] = r2[0] * o2 + r2[2] * a2 + r2[4], n2[e2 + 1] = r2[1] * o2 + r2[3] * a2 + r2[5];
}
function a$15(n2, t2, r2, e2 = 0, a2 = 0, c2 = 2) {
  const s2 = a2 || t2.length / c2;
  for (let u2 = e2; u2 < s2; u2++) {
    o$U(n2, t2, r2, u2 * c2);
  }
}
Object.freeze(Object.defineProperty({ __proto__: null, create: n$13, clone: t$S, fromValues: r$V, createView: e$I, transform: o$U, transformMany: a$15 }, Symbol.toStringTag, { value: "Module" }));
function a$14(t2, a2) {
  return t2[0] = a2[0], t2[1] = a2[1], t2[2] = a2[2], t2[3] = a2[3], t2[4] = a2[4], t2[5] = a2[5], t2;
}
function n$12(t2) {
  return t2[0] = 1, t2[1] = 0, t2[2] = 0, t2[3] = 1, t2[4] = 0, t2[5] = 0, t2;
}
function s$W(t2, a2, n2, s2, r2, u2, o2) {
  return t2[0] = a2, t2[1] = n2, t2[2] = s2, t2[3] = r2, t2[4] = u2, t2[5] = o2, t2;
}
function r$U(t2, a2) {
  const n2 = a2[0], s2 = a2[1], r2 = a2[2], u2 = a2[3], o2 = a2[4], e2 = a2[5];
  let c2 = n2 * u2 - s2 * r2;
  return c2 ? (c2 = 1 / c2, t2[0] = u2 * c2, t2[1] = -s2 * c2, t2[2] = -r2 * c2, t2[3] = n2 * c2, t2[4] = (r2 * e2 - u2 * o2) * c2, t2[5] = (s2 * o2 - n2 * e2) * c2, t2) : null;
}
function u$M(t2) {
  return t2[0] * t2[3] - t2[1] * t2[2];
}
function o$T(t2, a2, n2) {
  const s2 = a2[0], r2 = a2[1], u2 = a2[2], o2 = a2[3], e2 = a2[4], c2 = a2[5], i2 = n2[0], h2 = n2[1], M2 = n2[2], f2 = n2[3], b2 = n2[4], l2 = n2[5];
  return t2[0] = s2 * i2 + u2 * h2, t2[1] = r2 * i2 + o2 * h2, t2[2] = s2 * M2 + u2 * f2, t2[3] = r2 * M2 + o2 * f2, t2[4] = s2 * b2 + u2 * l2 + e2, t2[5] = r2 * b2 + o2 * l2 + c2, t2;
}
function e$H(t2, a2, n2) {
  const s2 = a2[0], r2 = a2[1], u2 = a2[2], o2 = a2[3], e2 = a2[4], c2 = a2[5], i2 = Math.sin(n2), h2 = Math.cos(n2);
  return t2[0] = s2 * h2 + u2 * i2, t2[1] = r2 * h2 + o2 * i2, t2[2] = s2 * -i2 + u2 * h2, t2[3] = r2 * -i2 + o2 * h2, t2[4] = e2, t2[5] = c2, t2;
}
function c$10(t2, a2, n2) {
  const s2 = a2[0], r2 = a2[1], u2 = a2[2], o2 = a2[3], e2 = a2[4], c2 = a2[5], i2 = n2[0], h2 = n2[1];
  return t2[0] = s2 * i2, t2[1] = r2 * i2, t2[2] = u2 * h2, t2[3] = o2 * h2, t2[4] = e2, t2[5] = c2, t2;
}
function i$1c(t2, a2, n2) {
  const s2 = a2[0], r2 = a2[1], u2 = a2[2], o2 = a2[3], e2 = a2[4], c2 = a2[5], i2 = n2[0], h2 = n2[1];
  return t2[0] = s2, t2[1] = r2, t2[2] = u2, t2[3] = o2, t2[4] = s2 * i2 + u2 * h2 + e2, t2[5] = r2 * i2 + o2 * h2 + c2, t2;
}
function h$G(t2, a2) {
  const n2 = Math.sin(a2), s2 = Math.cos(a2);
  return t2[0] = s2, t2[1] = n2, t2[2] = -n2, t2[3] = s2, t2[4] = 0, t2[5] = 0, t2;
}
function M$i(t2, a2) {
  return t2[0] = a2[0], t2[1] = 0, t2[2] = 0, t2[3] = a2[1], t2[4] = 0, t2[5] = 0, t2;
}
function f$E(t2, a2) {
  return t2[0] = 1, t2[1] = 0, t2[2] = 0, t2[3] = 1, t2[4] = a2[0], t2[5] = a2[1], t2;
}
function b$m(t2) {
  return "mat2d(" + t2[0] + ", " + t2[1] + ", " + t2[2] + ", " + t2[3] + ", " + t2[4] + ", " + t2[5] + ")";
}
function l$$(t2) {
  return Math.sqrt(t2[0] ** 2 + t2[1] ** 2 + t2[2] ** 2 + t2[3] ** 2 + t2[4] ** 2 + t2[5] ** 2 + 1);
}
function m$Z(t2, a2, n2) {
  return t2[0] = a2[0] + n2[0], t2[1] = a2[1] + n2[1], t2[2] = a2[2] + n2[2], t2[3] = a2[3] + n2[3], t2[4] = a2[4] + n2[4], t2[5] = a2[5] + n2[5], t2;
}
function d$z(t2, a2, n2) {
  return t2[0] = a2[0] - n2[0], t2[1] = a2[1] - n2[1], t2[2] = a2[2] - n2[2], t2[3] = a2[3] - n2[3], t2[4] = a2[4] - n2[4], t2[5] = a2[5] - n2[5], t2;
}
function p$16(t2, a2, n2) {
  return t2[0] = a2[0] * n2, t2[1] = a2[1] * n2, t2[2] = a2[2] * n2, t2[3] = a2[3] * n2, t2[4] = a2[4] * n2, t2[5] = a2[5] * n2, t2;
}
function x$n(t2, a2, n2, s2) {
  return t2[0] = a2[0] + n2[0] * s2, t2[1] = a2[1] + n2[1] * s2, t2[2] = a2[2] + n2[2] * s2, t2[3] = a2[3] + n2[3] * s2, t2[4] = a2[4] + n2[4] * s2, t2[5] = a2[5] + n2[5] * s2, t2;
}
function y$s(t2, a2) {
  return t2[0] === a2[0] && t2[1] === a2[1] && t2[2] === a2[2] && t2[3] === a2[3] && t2[4] === a2[4] && t2[5] === a2[5];
}
function g$s(a2, n2) {
  const s2 = a2[0], r2 = a2[1], u2 = a2[2], o2 = a2[3], e2 = a2[4], c2 = a2[5], i2 = n2[0], h2 = n2[1], M2 = n2[2], f2 = n2[3], b2 = n2[4], l2 = n2[5], m2 = a$2x();
  return Math.abs(s2 - i2) <= m2 * Math.max(1, Math.abs(s2), Math.abs(i2)) && Math.abs(r2 - h2) <= m2 * Math.max(1, Math.abs(r2), Math.abs(h2)) && Math.abs(u2 - M2) <= m2 * Math.max(1, Math.abs(u2), Math.abs(M2)) && Math.abs(o2 - f2) <= m2 * Math.max(1, Math.abs(o2), Math.abs(f2)) && Math.abs(e2 - b2) <= m2 * Math.max(1, Math.abs(e2), Math.abs(b2)) && Math.abs(c2 - l2) <= m2 * Math.max(1, Math.abs(c2), Math.abs(l2));
}
const S$j = o$T, j$g = d$z;
Object.freeze(Object.defineProperty({ __proto__: null, copy: a$14, identity: n$12, set: s$W, invert: r$U, determinant: u$M, multiply: o$T, rotate: e$H, scale: c$10, translate: i$1c, fromRotation: h$G, fromScaling: M$i, fromTranslation: f$E, str: b$m, frob: l$$, add: m$Z, subtract: d$z, multiplyScalar: p$16, multiplyScalarAndAdd: x$n, exactEquals: y$s, equals: g$s, mul: S$j, sub: j$g }, Symbol.toStringTag, { value: "Module" }));
const u$L = has("android");
has("chrome") || u$L && u$L >= 4 ? "auto" : "optimizeLegibility";
i$26();
function v$s(e2) {
  return e2 && "opacity" in e2 ? e2.opacity * v$s(e2.parent) : 1;
}
async function x$m(i2, s2) {
  var _a2, _b2;
  if (!i2)
    return;
  const o2 = i2.sourceLayer, a2 = (_a2 = r$1$(s2) && s2.useSourceLayer ? o2 : i2.layer) != null ? _a2 : o2, f2 = v$s(a2);
  if (r$1$(i2.symbol) && (!r$1$(s2) || s2.ignoreGraphicSymbol !== true)) {
    const t2 = i2.symbol.type === "web-style" ? await i2.symbol.fetchSymbol(__spreadProps(__spreadValues({}, s2), { cache: r$1$(s2) ? s2.webStyleCache : null })) : i2.symbol.clone();
    return x$D(t2, null, f2), t2;
  }
  const h2 = (_b2 = r$1$(s2) ? s2.renderer : null) != null ? _b2 : a2 && "renderer" in a2 ? a2.renderer : null;
  let y2 = h2 && "getSymbolAsync" in h2 ? await h2.getSymbolAsync(i2, s2) : null;
  if (!y2)
    return;
  if (y2 = y2.type === "web-style" ? await y2.fetchSymbol(__spreadProps(__spreadValues({}, s2), { cache: r$1$(s2) ? s2.webStyleCache : null })) : y2.clone(), !(h2 && "visualVariables" in h2 && h2.visualVariables && h2.visualVariables.length))
    return x$D(y2, null, f2), y2;
  if ("arcadeRequiredForVisualVariables" in h2 && h2.arcadeRequiredForVisualVariables && (t$2r(s2) || t$2r(s2.arcade))) {
    const e2 = __spreadValues({}, e$2e(s2));
    e2.arcade = await i$2P(), s2 = e2;
  }
  const p2 = await Promise.resolve().then(function() {
    return visualVariableUtils;
  }), d2 = [], m2 = [], b2 = [], g2 = [];
  for (const e2 of h2.visualVariables)
    switch (e2.type) {
      case "color":
        d2.push(e2);
        break;
      case "opacity":
        m2.push(e2);
        break;
      case "rotation":
        g2.push(e2);
        break;
      case "size":
        e2.target || b2.push(e2);
    }
  const w2 = !!d2.length && d2[d2.length - 1], S2 = w2 ? p2.getColor(w2, i2, s2) : null, x2 = !!m2.length && m2[m2.length - 1];
  let V2 = x2 ? p2.getOpacity(x2, i2, s2) : null;
  if (f2 != null && (V2 = V2 != null ? V2 * f2 : f2), x$D(y2, S2, V2), b2.length) {
    const e2 = p2.getAllSizes(b2, i2, s2);
    await M$p(y2, e2);
  }
  for (const e2 of g2)
    N$j(y2, p2.getRotationAngle(e2, i2, s2), e2.axis);
  return y2;
}
class o$S {
  constructor(r2, o2) {
    this._owner = o2, this._properties = {}, this._afterDispatchHandle = null;
    for (const t2 in r2) {
      const o3 = r2[t2], s2 = new t$2b(o3, void 0, void 0, 2, 2);
      this._properties[t2] = { pool: s2, acquired: [] };
    }
    this._afterDispatchHandle = y$1A(() => this._release());
  }
  destroy() {
    this._afterDispatchHandle && (this._afterDispatchHandle.remove(), this._afterDispatchHandle = null);
    for (const e2 in this._properties) {
      const t2 = this._properties[e2];
      for (const e3 of t2.acquired)
        x$12(e3) || t2.pool.release(e3);
      t2.pool.destroy(), t2.pool = null, t2.acquired = null;
    }
    this._properties = null, this._owner = null;
  }
  get(e2) {
    const t2 = this._owner._get(e2), r2 = this._properties[e2];
    let o2 = r2.pool.acquire();
    for (r2.acquired.push(o2); o2 === t2; )
      r2.acquired.push(o2), o2 = r2.pool.acquire();
    return o2;
  }
  _release() {
    for (const e2 in this._properties) {
      const t2 = this._properties[e2];
      let o2 = 0;
      for (const e3 of t2.acquired)
        x$12(e3) ? t2.acquired[o2++] = e3 : t2.pool.release(e3);
      t2.acquired.length = o2;
    }
  }
}
const e$G = has("mac") ? "Meta" : "Ctrl", t$R = { 8: "Backspace", 9: "Tab", 13: "Enter", 27: "Escape", 33: "PageUp", 34: "PageDown", 35: "End", 36: "Home", 37: "ArrowLeft", 38: "ArrowUp", 39: "ArrowRight", 40: "ArrowDown", 45: "Insert", 46: "Delete" };
for (let n2 = 48; n2 < 58; n2++)
  t$R[n2] = String.fromCharCode(n2);
for (let n2 = 1; n2 < 25; n2++)
  t$R[111 + n2] = `F${n2}`;
for (let n2 = 65; n2 < 91; n2++)
  t$R[n2] = [String.fromCharCode(n2 + 32), String.fromCharCode(n2)];
function o$R(e2) {
  if (e2.key !== void 0)
    return i$31(e2);
  const o2 = t$R[e2.keyCode];
  return Array.isArray(o2) ? e2.shiftKey ? o2[1] : o2[0] : o2;
}
function a$13(r2) {
  switch (r2) {
    case "Ctrl":
    case "Alt":
    case "Shift":
    case "Meta":
    case "Primary":
      return true;
  }
  return false;
}
class e$F {
  constructor(e2, t2 = []) {
    this.eventType = e2, this.keyModifiers = t2;
  }
  matches(e2) {
    if (e2.type !== this.eventType)
      return false;
    if (this.keyModifiers.length === 0)
      return true;
    const t2 = e2.modifiers;
    for (const i2 of this.keyModifiers)
      if (!t2.has(i2))
        return false;
    return true;
  }
}
const n$11 = s$2z.getLogger("esri.views.input.InputHandler");
class i$1b {
  constructor(e2) {
    this._manager = null, this._incoming = {}, this._outgoing = {}, this._incomingEventMatches = null, this._incomingEventTypes = null, this._outgoingEventTypes = null, this._hasSideEffects = e2;
  }
  get incomingEventMatches() {
    if (!this._incomingEventMatches) {
      this._incomingEventMatches = [];
      for (const e2 in this._incoming) {
        const t2 = this._incoming[e2];
        for (const e3 of t2)
          this._incomingEventMatches.push(e3.match);
      }
    }
    return this._incomingEventMatches;
  }
  get incomingEventTypes() {
    return this._incomingEventTypes || (this._incomingEventTypes = this.incomingEventMatches.map((e2) => e2.eventType)), this._incomingEventTypes;
  }
  get outgoingEventTypes() {
    return this._outgoingEventTypes || (this._outgoingEventTypes = Object.keys(this._outgoing)), this._outgoingEventTypes;
  }
  get hasSideEffects() {
    return this._hasSideEffects;
  }
  get hasPendingInputs() {
    return false;
  }
  onInstall(e2) {
    this._manager ? n$11.error("This InputHandler has already been registered with an InputManager") : (e2.setEventCallback((e3) => this._handleEvent(e3)), e2.setUninstallCallback(() => this._onUninstall()), this._manager = e2);
  }
  onUninstall() {
  }
  registerIncoming(e2, n2, i2) {
    let a2;
    typeof n2 == "function" ? (i2 = n2, a2 = []) : a2 = n2 || [];
    const o2 = typeof e2 == "string" ? new e$F(e2, a2) : e2, h2 = () => {
      this._incomingEventTypes = null, this._incomingEventMatches = null;
    }, r2 = (e3) => {
      const t2 = this._incoming[e3.match.eventType];
      if (t2) {
        const n3 = t2.indexOf(e3);
        t2.splice(n3, 1), h2(), this._manager && this._manager.updateDependencies();
      }
    }, g2 = new s$V(o2, i2, { onPause: r2, onRemove: r2, onResume: (e3) => {
      const t2 = this._incoming[e3.match.eventType];
      t2 && !t2.includes(e3) && (t2.push(e3), h2(), this._manager && this._manager.updateDependencies());
    } });
    let c2 = this._incoming[o2.eventType];
    return c2 || (c2 = [], this._incoming[o2.eventType] = c2), c2.push(g2), h2(), this._manager && this._manager.updateDependencies(), g2;
  }
  registerOutgoing(e2) {
    if (this._outgoing[e2])
      throw new Error("There is already a callback registered for this outgoing InputEvent: " + e2);
    const t2 = new a$12(e2, { onEmit: (e3, t3, n2, i2) => {
      var _a2;
      (_a2 = this._manager) == null ? void 0 : _a2.emit(e3.eventType, t3, n2, i2);
    }, onRemove: (e3) => {
      var _a2;
      delete this._outgoing[e3.eventType], (_a2 = this._manager) == null ? void 0 : _a2.updateDependencies();
    } });
    return this._outgoing[e2] = t2, this._outgoingEventTypes = null, this._manager && this._manager.updateDependencies(), t2;
  }
  startCapturingPointer(e2) {
    var _a2;
    (_a2 = this._manager) == null ? void 0 : _a2.setPointerCapture(e2, true);
  }
  stopCapturingPointer(e2) {
    var _a2;
    (_a2 = this._manager) == null ? void 0 : _a2.setPointerCapture(e2, false);
  }
  refreshHasPendingInputs() {
    var _a2;
    (_a2 = this._manager) == null ? void 0 : _a2.refreshHasPendingInputs();
  }
  _onUninstall() {
    this._manager ? (this.onUninstall(), this._manager = null) : n$11.error("This InputHandler is not registered with an InputManager");
  }
  _handleEvent(e2) {
    var _a2;
    const t2 = this._incoming[e2.type];
    if (t2) {
      for (const n2 of t2)
        if (n2.match.matches(e2) && ((_a2 = n2.callback) == null ? void 0 : _a2.call(n2, e2), e2.shouldStopPropagation()))
          break;
    }
  }
}
class s$V {
  constructor(e2, t2, n2) {
    this.match = e2, this._callback = t2, this._handler = n2;
  }
  pause() {
    this._handler.onPause(this);
  }
  resume() {
    this._handler.onResume(this);
  }
  remove() {
    this._handler.onRemove(this);
  }
  get callback() {
    return this._callback;
  }
}
class a$12 {
  constructor(e2, t2) {
    this.eventType = e2, this._removed = false, this._handler = t2;
  }
  emit(e2, t2, n2) {
    this._removed || this._handler.onEmit(this, e2, t2, n2);
  }
  remove() {
    this._removed = true, this._handler.onRemove(this);
  }
}
class s$U extends i$1b {
  constructor(t2) {
    super(true), this._onChange = t2, this._value = "mouse", this._x = null, this._y = null, this.registerIncoming("pointer-move", (t3) => {
      this._update(t3.data);
    });
  }
  _update(t2) {
    const s2 = t2.native.pointerType === "touch" ? "touch" : "mouse", { x: e2, y: i2 } = t2;
    s2 === this._value && this._x === e2 && this._y === i2 || (this._value = s2, this._x = e2, this._y = i2, this._onChange(s2, e2, i2));
  }
}
class t$Q {
  constructor(e2) {
    this._observable = new e$1Q(), this._value = e2;
  }
  get() {
    return s$2s(this._observable), this._value;
  }
  set(e2) {
    e2 !== this._value && (this._value = e2, this._observable.notify());
  }
}
class i$1a extends i$1b {
  constructor() {
    super(true), this._activeTouchPointerIds = new Set(), this._multiTouchActive = new t$Q(false), this._onPointerAdd = ({ data: t2 }) => {
      t2.pointerType === "touch" && (this._activeTouchPointerIds.add(t2.native.pointerId), this._update());
    }, this._onPointerRemove = ({ data: t2 }) => {
      t2.pointerType === "touch" && (this._activeTouchPointerIds.delete(t2.native.pointerId), this._update());
    }, this.registerIncoming("pointer-down", this._onPointerAdd), this.registerIncoming("pointer-up", this._onPointerRemove), this.registerIncoming("pointer-capture-lost", this._onPointerRemove), this.registerIncoming("pointer-cancel", this._onPointerRemove);
  }
  get multiTouchActive() {
    return this._multiTouchActive.get();
  }
  _update() {
    this._multiTouchActive.set(this._activeTouchPointerIds.size > 1);
  }
}
let u$K = class extends m$2q {
  constructor(e2) {
    super(e2), this._pointerCaptures = new Map(), this._nameToGroup = {}, this._handlers = [], this._handlersPriority = [], this._currentPropagation = null, this._updateDependenciesAfterPropagation = false, this._sourceEvents = new Set(), this._keyModifiers = new Set(), this._activeKeyModifiers = new Set(), this._stoppedPropagationEventIds = new Set(), this.primaryKey = e$G, this._latestPointerType = "mouse", this._propertiesPool = new o$S({ latestPointerLocation: v$r }, this), this.latestPointerLocation = null, this.test = { timestamp: void 0, hasCurrentPropagation: () => !!this._currentPropagation };
  }
  initialize() {
    this.eventSource.onEventReceived = this._onEventReceived.bind(this), this._installRecognizers();
  }
  destroy() {
    const e2 = Object.keys(this._nameToGroup);
    for (const t2 of e2)
      this.uninstallHandlers(t2);
    this.eventSource.destroy(), this._currentPropagation = null, this._propertiesPool.destroy();
  }
  get hasPendingInputs() {
    return this._handlers.some((e2) => e2.handler.hasPendingInputs);
  }
  get latestPointerType() {
    return this._latestPointerType;
  }
  get multiTouchActive() {
    return this._multiTouchHandler.multiTouchActive;
  }
  installHandlers(e2, t2, i2 = P$h.INTERNAL) {
    if (this._nameToGroup[e2])
      return void s$2z.getLogger(this.declaredClass).error("There is already an InputHandler group registered under the name `" + e2 + "`");
    if (t2.length === 0)
      return void s$2z.getLogger(this.declaredClass).error("Can't register a group of zero handlers");
    const n2 = { name: e2, handlers: t2.map((e3) => ({ handler: e3, active: true, removed: false, priorityIndex: 0, groupPriority: i2, eventCallback: null, uninstallCallback: null })) };
    this._nameToGroup[e2] = n2;
    for (let r2 = n2.handlers.length - 1; r2 >= 0; r2--) {
      const e3 = n2.handlers[r2];
      this._handlers.push(e3), e3.handler.onInstall({ updateDependencies: () => {
        this.updateDependencies();
      }, emit: (t3, r3, i3, n3, s2) => {
        this._emitInputEvent(e3.priorityIndex + 1, t3, r3, i3, s2, n3);
      }, setPointerCapture: (t3, r3) => {
        this._setPointerCapture(n2, e3, t3, r3);
      }, setEventCallback: (t3) => {
        e3.eventCallback = t3;
      }, setUninstallCallback: (t3) => {
        e3.uninstallCallback = t3;
      }, refreshHasPendingInputs: () => {
        this.notifyChange("hasPendingInputs");
      } });
    }
    this.updateDependencies();
  }
  uninstallHandlers(e2) {
    const t2 = this._nameToGroup[e2];
    t2 ? (t2.handlers.forEach((e3) => {
      var _a2;
      e3.removed = true, (_a2 = e3.uninstallCallback) == null ? void 0 : _a2.call(e3);
    }), delete this._nameToGroup[e2], this._currentPropagation ? this._currentPropagation.needsHandlerGarbageCollect = true : this._garbageCollectRemovedHandlers()) : s$2z.getLogger(this.declaredClass).error("There is no InputHandler group registered under the name `" + e2 + "`");
  }
  hasHandlers(e2) {
    return this._nameToGroup[e2] !== void 0;
  }
  updateDependencies() {
    if (this._currentPropagation)
      return void (this._updateDependenciesAfterPropagation = true);
    this._updateDependenciesAfterPropagation = false;
    const e2 = new Set(), t2 = new Set();
    this._handlersPriority = [];
    for (let r2 = this._handlers.length - 1; r2 >= 0; r2--) {
      const e3 = this._handlers[r2];
      e3.priorityIndex = r2, this._handlersPriority.push(e3);
    }
    this._handlersPriority = this._sortHandlersPriority(this._handlersPriority);
    for (let r2 = this._handlersPriority.length - 1; r2 >= 0; r2--) {
      const i2 = this._handlersPriority[r2];
      i2.priorityIndex = r2;
      let n2 = i2.handler.hasSideEffects;
      if (!n2) {
        for (const t3 of i2.handler.outgoingEventTypes)
          if (e2.has(t3)) {
            n2 = true;
            break;
          }
      }
      if (n2)
        for (const r3 of i2.handler.incomingEventMatches) {
          e2.add(r3.eventType);
          for (const e3 of r3.keyModifiers)
            a$13(e3) || t2.add(e3);
        }
      i2.active = n2;
    }
    this._sourceEvents = e2, this._keyModifiers = t2, this._pointerCaptures.size > 0 && this._sourceEvents.add("pointer-capture-lost"), this._keyModifiers.size > 0 && (this._sourceEvents.add("key-down"), this._sourceEvents.add("key-up")), this.eventSource && (this.eventSource.activeEvents = this._sourceEvents);
  }
  _setLatestPointer(e2, t2, r2) {
    this._latestPointerType = e2;
    const n2 = this._get("latestPointerLocation");
    if (t$2r(n2) || n2.x !== t2 || n2.y !== r2) {
      const e3 = this._propertiesPool.get("latestPointerLocation");
      e3.x = t2, e3.y = r2, this._set("latestPointerLocation", e3);
    }
  }
  _onEventReceived(e2, t2) {
    if (e2 === "pointer-capture-lost") {
      const e3 = t2;
      this._pointerCaptures.delete(e3.native.pointerId);
    }
    this._updateKeyModifiers(e2, t2);
    const r2 = this.test.timestamp != null ? this.test.timestamp : t2.native ? t2.native.timestamp : void 0, i2 = t2.native ? t2.native.cancelable : void 0;
    this._emitInputEventFromSource(e2, t2, r2, i2);
  }
  _updateKeyModifiers(e2, t2) {
    if (!t2)
      return;
    let r2 = false;
    const i2 = () => {
      if (!r2) {
        const e3 = new Set();
        this._activeKeyModifiers.forEach((t3) => {
          e3.add(t3);
        }), this._activeKeyModifiers = e3, r2 = true;
      }
    }, n2 = (e3, t3) => {
      t3 && !this._activeKeyModifiers.has(e3) ? (i2(), this._activeKeyModifiers.add(e3)) : !t3 && this._activeKeyModifiers.has(e3) && (i2(), this._activeKeyModifiers.delete(e3));
    };
    if (e2 === "key-down" || e2 === "key-up") {
      const r3 = t2.key;
      this._keyModifiers.has(r3) && n2(r3, e2 === "key-down");
    }
    const s2 = t2.native;
    n2("Alt", !(!s2 || !s2.altKey)), n2("Ctrl", !(!s2 || !s2.ctrlKey)), n2("Shift", !(!s2 || !s2.shiftKey)), n2("Meta", !(!s2 || !s2.metaKey)), n2("Primary", this._activeKeyModifiers.has(this.primaryKey));
  }
  _installRecognizers() {
    this._latestPointerHandler = new s$U((e2, t2, r2) => this._setLatestPointer(e2, t2, r2)), this._multiTouchHandler = new i$1a(), this.installHandlers("input-manager-logic", [this._latestPointerHandler, this._multiTouchHandler], P$h.ALWAYS), this.recognizers.length > 0 && this.installHandlers("default", this.recognizers, P$h.INTERNAL);
  }
  _setPointerCapture(e2, t2, r2, i2) {
    const n2 = e2.name + "-" + t2.priorityIndex, s2 = this._pointerCaptures.get(r2.pointerId) || new Set();
    this._pointerCaptures.set(r2.pointerId, s2), i2 ? (s2.add(n2), s2.size === 1 && this.eventSource && this.eventSource.setPointerCapture(r2, true)) : s2.has(n2) && (s2.delete(n2), s2.size === 0 && (this._pointerCaptures.delete(r2.pointerId), this.eventSource && this.eventSource.setPointerCapture(r2, false)));
  }
  _garbageCollectRemovedHandlers() {
    this._handlers = this._handlers.filter((e2) => !e2.removed), this.updateDependencies();
  }
  _emitInputEventFromSource(e2, t2, r2, i2) {
    this._emitInputEvent(0, e2, t2, r2, i2);
  }
  _emitInputEvent(e2, t2, r2, i2, n2, s2) {
    const o2 = i2 !== void 0 ? i2 : this._currentPropagation ? this._currentPropagation.timestamp : performance.now(), a2 = n2 !== void 0 && n2, l2 = { event: new _$n(t2, r2, o2, s2 || this._activeKeyModifiers, a2), priorityIndex: e2 };
    this._currentPropagation ? this._currentPropagation.events.push(l2) : this._doNewPropagation(l2);
  }
  _doNewPropagation(e2) {
    this._currentPropagation = { events: new e$1t(), currentHandler: null, needsHandlerGarbageCollect: false, timestamp: e2.event.timestamp }, this._currentPropagation.events.push(e2), this._continuePropagation();
  }
  _continuePropagation() {
    var _a2, _b2;
    const e2 = f$21(this._currentPropagation);
    for (; e2.events.length > 0; ) {
      const { event: t2, priorityIndex: r2 } = e2.events.pop(), i2 = t2.data && t2.data.eventId;
      if (!(i2 != null && this._stoppedPropagationEventIds.has(i2)))
        for (e2.currentHandler = this._handlersPriority[r2]; e2.currentHandler; ) {
          if (e2.currentHandler.removed)
            e2.needsHandlerGarbageCollect = true;
          else {
            if (e2.currentHandler.active && !t2.shouldStopPropagation() && ((_b2 = (_a2 = e2.currentHandler).eventCallback) == null ? void 0 : _b2.call(_a2, t2)), t2.shouldStopPropagation()) {
              i2 != null && this._stoppedPropagationEventIds.add(i2);
              break;
            }
            if (t2.shouldPausePropagation(() => this._continuePropagation()))
              return void this._pausePropagation({ event: t2, priorityIndex: e2.currentHandler.priorityIndex + 1 });
          }
          e2.currentHandler = this._handlersPriority[e2.currentHandler.priorityIndex + 1];
        }
    }
    e2.needsHandlerGarbageCollect && this._garbageCollectRemovedHandlers(), this.hasPendingInputs || this._stoppedPropagationEventIds.clear(), this._currentPropagation = null, this._updateDependenciesAfterPropagation && this.updateDependencies();
  }
  _pausePropagation(e2) {
    const t2 = new e$1t();
    t2.push(e2);
    const r2 = this._currentPropagation;
    if (r2) {
      for (; r2.events.length; )
        t2.push(r2.events.pop());
      r2.events = t2, r2.currentHandler = null;
    }
  }
  _compareHandlerPriority(e2, t2) {
    if (e2.handler.hasSideEffects !== t2.handler.hasSideEffects)
      return e2.handler.hasSideEffects ? 1 : -1;
    if (e2.groupPriority !== t2.groupPriority)
      return e2.groupPriority > t2.groupPriority ? -1 : 1;
    for (const r2 of e2.handler.incomingEventMatches)
      for (const e3 of t2.handler.incomingEventMatches) {
        if (r2.eventType !== e3.eventType)
          continue;
        const t3 = r2.keyModifiers.filter((t4) => e3.keyModifiers.includes(t4));
        if (t3.length === r2.keyModifiers.length !== (t3.length === e3.keyModifiers.length))
          return r2.keyModifiers.length > e3.keyModifiers.length ? -1 : 1;
      }
    return e2.priorityIndex > t2.priorityIndex ? -1 : 1;
  }
  _sortHandlersPriority(e2) {
    const t2 = [];
    for (const r2 of e2) {
      let e3 = 0;
      for (; e3 < t2.length && this._compareHandlerPriority(r2, t2[e3]) >= 0; )
        e3++;
      t2.splice(e3, 0, r2);
    }
    return t2;
  }
  get debug() {
    const e2 = (e3) => {
      const t2 = this._setPointerCapture;
      this._setPointerCapture = () => {
      }, e3(), this._setPointerCapture = t2;
    };
    return { injectEvent: (t2, r2) => {
      e2(() => {
        this._onEventReceived(t2, r2);
      });
    }, disablePointerCapture: e2 };
  }
};
e$2g([y$1I({ readOnly: true })], u$K.prototype, "hasPendingInputs", null), e$2g([y$1I({ constructOnly: true })], u$K.prototype, "eventSource", void 0), e$2g([y$1I({ constructOnly: true })], u$K.prototype, "recognizers", void 0), e$2g([y$1I()], u$K.prototype, "_latestPointerType", void 0), e$2g([y$1I()], u$K.prototype, "latestPointerType", null), e$2g([y$1I()], u$K.prototype, "multiTouchActive", null), e$2g([y$1I({ readOnly: true })], u$K.prototype, "latestPointerLocation", void 0), u$K = e$2g([n$2P("esri.views.input.InputManager")], u$K);
class _$n {
  constructor(e2, t2, r2, i2, n2) {
    this.type = e2, this.data = t2, this.timestamp = r2, this.modifiers = i2, this.cancelable = n2, this._propagationState = g$r.NONE, this._resumeCallback = null;
  }
  stopPropagation() {
    this._propagationState |= g$r.STOPPED;
  }
  shouldStopPropagation() {
    return (this._propagationState & g$r.STOPPED) != 0;
  }
  async(e2) {
    this._propagationState |= g$r.PAUSED;
    const t2 = (e3, t3) => {
      this._propagationState &= ~g$r.PAUSED;
      const r2 = this._resumeCallback;
      if (this._resumeCallback = null, r2 && r2(), t3)
        throw e3;
      return e3;
    };
    return (typeof e2 == "function" ? e2() : e2).then((e3) => t2(e3, false), (e3) => t2(e3, true));
  }
  shouldPausePropagation(e2) {
    return !!(this._propagationState & g$r.PAUSED) && (this._resumeCallback = e2, true);
  }
  preventDefault() {
    this.data.native.preventDefault();
  }
}
var g$r;
!function(e2) {
  e2[e2.NONE = 0] = "NONE", e2[e2.STOPPED = 1] = "STOPPED", e2[e2.PAUSED = 2] = "PAUSED";
}(g$r || (g$r = {}));
const P$h = { ALWAYS: 1, DEFAULT: 0, TOOL: -1, WIDGET: -2, INTERNAL: -3 };
class v$r {
}
function e$E(n2) {
  return n2 && typeof n2.highlight == "function";
}
function c$$(e2, t2, c2) {
  return t$2r(e2) || e2 > c2 && (t2 === 0 || e2 < t2);
}
const s$T = { iconZoom: "esri-icon-zoom-in-magnifying-glass", iconTrash: "esri-icon-trash", iconBrowseClusteredFeatures: "esri-icon-table" }, o$Q = new a$2B({ id: "zoom-to-feature", title: "{messages.zoom}", className: s$T.iconZoom }), t$P = new a$2B({ id: "remove-selected-feature", title: "{messages.remove}", className: s$T.iconTrash }), r$T = new a$2B({ id: "zoom-to-clustered-features", title: "{messages.zoom}", className: s$T.iconZoom }), i$19 = new a$2B({ id: "browse-clustered-features", title: "{messages.browseClusteredFeatures}", className: s$T.iconBrowseClusteredFeatures });
const s$S = "esri.widgets.Popup.PopupViewModel", c$_ = s$2z.getLogger(s$S), u$J = (t2) => {
  const { event: s2, view: c2 } = t2, { action: u2 } = s2, d2 = c2 && c2.popup;
  if (!u2)
    return Promise.reject(new s$2u("trigger-action:missing-arguments", "Event has no action"));
  if (!d2)
    return Promise.reject(new s$2u("trigger-action:missing-arguments", "view.popup is missing"));
  const { disabled: l2, id: g2 } = u2;
  if (!g2)
    return Promise.reject(new s$2u("trigger-action:invalid-action", "action.id is missing"));
  if (l2)
    return Promise.reject(new s$2u("trigger-action:invalid-action", "Action is disabled"));
  if (g2 === o$Q.id)
    return w$k(d2.viewModel).catch(b$19);
  if (g2 === r$T.id)
    return p$15(d2.viewModel);
  if (g2 === i$19.id)
    return d2.featureMenuOpen = !d2.featureMenuOpen, d2.viewModel.browseClusterEnabled = !d2.viewModel.browseClusterEnabled, Promise.resolve();
  if (d2.viewModel.browseClusterEnabled = false, g2 === t$P.id) {
    d2.close();
    const { selectedFeature: t3 } = d2;
    if (!t3)
      return Promise.reject(new s$2u(`trigger-action:${t$P.id}`, "selectedFeature is required", { selectedFeature: t3 }));
    const { sourceLayer: r2 } = t3;
    return r2 ? r2.remove(t3) : c2.graphics.remove(t3), Promise.resolve();
  }
  return Promise.resolve();
};
function d$y(e2) {
  const { selectedFeature: t2, location: r2, view: o2 } = e2;
  if (!o2)
    return null;
  if (o2.type === "3d")
    return t2 || r2;
  return e2.get("selectedFeature.geometry") || r2;
}
function l$_(e2) {
  var _a2, _b2;
  return (e2 == null ? void 0 : e2.isAggregate) && ((_b2 = (_a2 = e2 == null ? void 0 : e2.sourceLayer) == null ? void 0 : _a2.featureReduction) == null ? void 0 : _b2.type) === "cluster";
}
async function g$q(e2, t2) {
  if ((t2 == null ? void 0 : t2.type) !== "3d" || !e2 || e2.declaredClass !== "esri.Graphic")
    return true;
  const r2 = t2.getViewForGraphic(e2);
  if (r2 && "whenGraphicBounds" in r2) {
    let t3;
    try {
      t3 = await r2.whenGraphicBounds(e2, { useViewElevation: true });
    } catch (o2) {
    }
    return !t3 || !t3.boundingBox || t3.boundingBox[0] === t3.boundingBox[3] && t3.boundingBox[1] === t3.boundingBox[4] && t3.boundingBox[2] === t3.boundingBox[5];
  }
  return true;
}
async function w$k(t2) {
  const { location: r2, selectedFeature: i2, view: n2, zoomFactor: a2 } = t2, s2 = d$y(t2);
  if (!s2) {
    const t3 = new s$2u("zoom-to:invalid-target-or-view", "Cannot zoom to location without a target and view.", { target: s2, view: n2 });
    throw c$_.error(t3), t3;
  }
  const u2 = n2.scale / a2, l2 = t2.get("selectedFeature.geometry") || r2, w2 = l2 && l2.type === "point" && await g$q(i2, n2);
  o$Q.active = true, o$Q.disabled = true;
  try {
    await t2.zoomTo({ target: { target: s2, scale: w2 ? u2 : void 0 } });
  } catch (p2) {
    const t3 = new s$2u("zoom-to:invalid-graphic", "Could not zoom to the location of the graphic.", { graphic: i2 });
    c$_.error(t3);
  } finally {
    o$Q.active = false, o$Q.disabled = false, t2.zoomToLocation = null, w2 && (t2.location = l2);
  }
}
async function p$15(t2) {
  const { selectedFeature: r2, view: o2 } = t2;
  if ((o2 == null ? void 0 : o2.type) !== "2d") {
    const t3 = new s$2u("zoomToCluster:invalid-view", "View must be 2d MapView.", { view: o2 });
    throw c$_.error(t3), t3;
  }
  if (!l$_(r2)) {
    const t3 = new s$2u("zoomToCluster:invalid-selectedFeature", "Selected feature must represent an aggregate/cluster graphic.", { selectedFeature: r2 });
    throw c$_.error(t3), t3;
  }
  const n2 = r2.sourceLayer, a2 = await o2.whenLayerView(n2), s2 = a2.createQuery();
  s2.aggregateIds = [r2.getObjectId()], r$T.active = true, r$T.disabled = true;
  const { extent: u2 } = await a2.queryExtent(s2);
  await t2.zoomTo({ target: u2 }), r$T.active = false, r$T.disabled = false;
}
async function f$D(e2) {
  const { selectedFeature: t2, view: r2 } = e2, o2 = t2.sourceLayer, i2 = await r2.whenLayerView(o2), n2 = i2.createQuery();
  n2.aggregateIds = [t2.getObjectId()];
  const { extent: a2 } = await i2.queryExtent(n2);
  e2.selectedClusterBoundaryFeature.geometry = a2, r2.graphics.add(e2.selectedClusterBoundaryFeature);
}
async function m$Y(e2) {
  const { selectedFeature: t2, view: r2 } = e2, o2 = t2.sourceLayer, i2 = await r2.whenLayerView(o2), a2 = i2.createQuery();
  a2.aggregateIds = [t2.getObjectId()], i$19.active = true, i$19.disabled = true;
  const { features: s2 } = await i2.queryFeatures(a2);
  i$19.active = false, i$19.disabled = false, r2.popup.open({ features: [t2].concat(s2), featureMenuOpen: true });
}
function v$q(e2) {
  const t2 = e2.features.filter((e3) => l$_(e3));
  t2.length && (e2.features = t2);
}
const e$D = (e2) => {
  let t2 = class extends e2 {
    constructor(...o2) {
      super(...o2), this.goToOverride = null, this.view = null;
    }
    callGoTo(o2) {
      const { view: r2 } = this;
      return this.goToOverride ? this.goToOverride(r2, o2) : r2.goTo(o2.target, o2.options);
    }
  };
  return e$2g([y$1I()], t2.prototype, "goToOverride", void 0), e$2g([y$1I()], t2.prototype, "view", void 0), t2 = e$2g([n$2P("esri.widgets.support.GoTo")], t2), t2;
};
const B$f = j$V.ofType({ key: "type", defaultKeyValue: "button", base: c$2R, typeMap: { button: a$2B, toggle: a$2A } }), G$g = () => [o$Q.clone()], R$e = () => [r$T.clone(), i$19.clone()];
let z$l = class extends e$D(h$I) {
  constructor(e2) {
    super(e2), this._handles = new t$2g(), this._pendingPromises = new Set(), this._fetchFeaturesController = null, this._selectedClusterFeature = null, this.featurePage = null, this.actions = new B$f(), this.activeFeature = null, this.defaultPopupTemplateEnabled = false, this.autoCloseEnabled = false, this.autoOpenEnabled = true, this.browseClusterEnabled = false, this.content = null, this.featuresPerPage = 20, this.featureViewModelAbilities = null, this.featureViewModels = [], this.highlightEnabled = true, this.includeDefaultActions = true, this.selectedClusterBoundaryFeature = new g$10({ symbol: new S$H({ outline: { width: 1.5, color: "cyan" }, style: "none" }) }), this.title = null, this.updateLocationEnabled = false, this.view = null, this.visible = false, this.zoomFactor = 4, this.zoomToLocation = null;
  }
  get isLoadingFeature() {
    return this.featureViewModels.some((e2) => e2.waitingForContent);
  }
  initialize() {
    this._handles.add([l$1P(() => [this.autoOpenEnabled, this.view], () => this._autoOpenEnabledChange()), this.on("view-change", () => this._autoClose()), l$1P(() => [this.highlightEnabled, this.selectedFeature, this.visible, this.view], () => this._highlightSelectedFeature()), l$1P(() => [this.highlightEnabled, this.activeFeature, this.visible, this.view], () => this._highlightActiveFeature()), l$1P(() => {
      var _a2, _b2;
      return (_b2 = (_a2 = this.view) == null ? void 0 : _a2.animation) == null ? void 0 : _b2.state;
    }, (e2) => this._animationStateChange(e2)), l$1P(() => this.location, (e2) => this._locationChange(e2)), l$1P(() => this.selectedFeature, (e2) => this._selectedFeatureChange(e2)), l$1P(() => [this.selectedFeatureIndex, this.featureCount, this.featuresPerPage], () => this._selectedFeatureIndexChange()), l$1P(() => [this.featurePage, this.selectedFeatureIndex, this.featureCount, this.featuresPerPage, this.featureViewModels], () => this._setGraphicOnFeatureViewModels()), l$1P(() => this.featureViewModels, () => this._featureViewModelsChange()), this.on("trigger-action", (e2) => u$J({ event: e2, view: this.view })), f$1o(() => !this.waitingForResult, () => this._waitingForResultChange(), U$r), l$1P(() => {
      var _a2, _b2;
      return [this.features, (_a2 = this.view) == null ? void 0 : _a2.map, (_b2 = this.view) == null ? void 0 : _b2.spatialReference];
    }, () => this._updateFeatureVMs()), l$1P(() => {
      var _a2;
      return (_a2 = this.view) == null ? void 0 : _a2.scale;
    }, () => this._viewScaleChange()), f$1o(() => !this.visible, () => this.browseClusterEnabled = false), l$1P(() => this.browseClusterEnabled, (e2) => e2 ? this.enableClusterBrowsing() : this.disableClusterBrowsing())]);
  }
  destroy() {
    this._cancelFetchingFeatures(), this._handles.destroy(), this._handles = null, this._pendingPromises.clear(), this.browseClusterEnabled = false, this.view = null;
  }
  get active() {
    return !(!this.visible || this.waitingForResult);
  }
  get allActions() {
    const e2 = this._get("allActions") || new B$f();
    e2.removeAll();
    const { actions: t2, defaultActions: i2, defaultPopupTemplateEnabled: s2, includeDefaultActions: r2, selectedFeature: o2 } = this, n2 = r2 ? i2.concat(t2) : t2, a2 = o2 && (typeof o2.getEffectivePopupTemplate == "function" && o2.getEffectivePopupTemplate(s2) || o2.popupTemplate), l2 = a2 && a2.actions, h2 = a2 && a2.overwriteActions ? l2 : l2 ? l2.concat(n2) : n2;
    return h2 && h2.filter(Boolean).forEach((t3) => e2.add(t3)), e2;
  }
  get defaultActions() {
    const e2 = this._get("defaultActions") || new B$f();
    return e2.removeAll(), e2.addMany(l$_(this.selectedFeature) ? R$e() : G$g()), e2;
  }
  get featureCount() {
    return this.features.length;
  }
  get features() {
    return this._get("features") || [];
  }
  set features(e2) {
    const t2 = e2 || [];
    this._set("features", t2);
    const { pendingPromisesCount: i2, promiseCount: s2, selectedFeatureIndex: r2 } = this, o2 = s2 && t2.length;
    o2 && i2 && r2 === -1 ? this.selectedFeatureIndex = 0 : o2 && r2 !== -1 || (this.selectedFeatureIndex = t2.length ? 0 : -1);
  }
  get location() {
    return this._get("location") || null;
  }
  set location(e2) {
    const t2 = this.get("view.spatialReference.isWebMercator");
    e2 && e2.get("spatialReference.isWGS84") && t2 && (e2 = R$A(e2)), this._set("location", e2);
  }
  get pendingPromisesCount() {
    return this._pendingPromises.size;
  }
  get waitingForResult() {
    return !(!(!!this._fetchFeaturesController || this.pendingPromisesCount > 0) || this.featureCount !== 0);
  }
  get promiseCount() {
    return this.promises.length;
  }
  get promises() {
    return this._get("promises") || [];
  }
  set promises(e2) {
    if (this._pendingPromises.clear(), this.features = [], !Array.isArray(e2) || !e2.length)
      return this._set("promises", []), void this.notifyChange("pendingPromisesCount");
    this._set("promises", e2), (e2 = e2.slice(0)).forEach((e3) => {
      this._pendingPromises.add(e3);
      const t2 = (t3) => {
        this._pendingPromises.has(e3) && this._updateFeatures(t3), this._updatePendingPromises(e3);
      }, i2 = () => this._updatePendingPromises(e3);
      e3.then(t2, i2);
    }), this.notifyChange("pendingPromisesCount");
  }
  get selectedFeature() {
    const { features: e2, selectedFeatureIndex: t2 } = this;
    if (t2 === -1)
      return null;
    return e2[t2] || null;
  }
  get selectedFeatureIndex() {
    const e2 = this._get("selectedFeatureIndex");
    return typeof e2 == "number" ? e2 : -1;
  }
  set selectedFeatureIndex(e2) {
    const { featureCount: t2 } = this;
    e2 = isNaN(e2) || e2 < -1 || !t2 ? -1 : (e2 + t2) % t2, this.activeFeature = null, this._set("selectedFeatureIndex", e2);
  }
  get selectedFeatureViewModel() {
    return this.featureViewModels[this.selectedFeatureIndex] || null;
  }
  get state() {
    return this.get("view.ready") ? "ready" : "disabled";
  }
  centerAtLocation() {
    const { view: e2 } = this, t2 = d$y(this);
    return t2 ? this.callGoTo({ target: { target: t2, scale: e2.scale } }) : Promise.reject(new s$2u("center-at-location:invalid-target-or-view", "Cannot center at a location without a target and view.", { target: t2, view: e2 }));
  }
  zoomTo(e2) {
    return this.callGoTo(e2);
  }
  clear() {
    this.set({ promises: [], features: [], content: null, title: null, location: null, activeFeature: null });
  }
  fetchFeatures(e2, t2) {
    const { view: i2 } = this;
    if (!i2 || !e2)
      throw new s$2u("fetch-features:invalid-screenpoint-or-view", "Cannot fetch features without a screenPoint and view.", { screenPoint: e2, view: i2 });
    return i2.fetchPopupFeatures(e2, { event: t2 && t2.event, defaultPopupTemplateEnabled: this.defaultPopupTemplateEnabled, signal: t2 && t2.signal });
  }
  open(e2) {
    const t2 = __spreadProps(__spreadValues({ updateLocationEnabled: false, promises: [], fetchFeatures: false }, e2), { visible: true }), { fetchFeatures: i2 } = t2;
    delete t2.fetchFeatures, i2 && this._setFetchFeaturesPromises(t2.location);
    const s2 = ["actionsMenuOpen", "collapsed", "featureMenuOpen"];
    for (const r2 of s2)
      delete t2[r2];
    this.set(t2);
  }
  triggerAction(e2) {
    const t2 = this.allActions.getItemAt(e2);
    t2 && !t2.disabled && this.emit("trigger-action", { action: t2 });
  }
  next() {
    return this.selectedFeatureIndex = this.selectedFeatureIndex + 1, this;
  }
  previous() {
    return this.selectedFeatureIndex = this.selectedFeatureIndex - 1, this;
  }
  disableClusterBrowsing() {
    v$q(this), this._clearBrowsedClusterGraphics();
  }
  async enableClusterBrowsing() {
    const { view: e2, selectedFeature: t2 } = this;
    (e2 == null ? void 0 : e2.type) === "2d" ? l$_(t2) ? (await f$D(this), await m$Y(this)) : s$2z.getLogger(this.declaredClass).warn("enableClusterBrowsing:invalid-selectedFeature: Selected feature must represent an aggregate/cluster graphic.", t2) : s$2z.getLogger(this.declaredClass).warn("enableClusterBrowsing:invalid-view: View must be 2d MapView.", t2);
  }
  _animationStateChange(e2) {
    this.zoomToLocation || (o$Q.disabled = e2 === "waiting-for-target");
  }
  _clearBrowsedClusterGraphics() {
    var _a2;
    const e2 = (_a2 = this.view) == null ? void 0 : _a2.graphics;
    e2 && (e2.remove(this.selectedClusterBoundaryFeature), e2.remove(this._selectedClusterFeature)), this._selectedClusterFeature = null, this.selectedClusterBoundaryFeature.geometry = null;
  }
  _viewScaleChange() {
    if (l$_(this.selectedFeature))
      return this.browseClusterEnabled = false, this.visible = false, void this.clear();
    this.browseClusterEnabled && (this.features = [this.selectedFeature]);
  }
  _locationChange(e2) {
    const { selectedFeature: t2, updateLocationEnabled: i2 } = this;
    i2 && e2 && (!t2 || t2.geometry) && this.centerAtLocation();
  }
  _selectedFeatureIndexChange() {
    this.featurePage = this.featureCount > 1 ? Math.floor(this.selectedFeatureIndex / this.featuresPerPage) + 1 : null;
  }
  _featureViewModelsChange() {
    this.featurePage = this.featureCount > 1 ? 1 : null;
  }
  _setGraphicOnFeatureViewModels() {
    const { features: e2, featureCount: t2, featurePage: i2, featuresPerPage: s2, featureViewModels: r2 } = this;
    if (i2 === null)
      return;
    const o2 = ((i2 - 1) * s2 + t2) % t2, n2 = o2 + s2;
    r2.slice(o2, n2).forEach((t3, i3) => {
      t3 && !t3.graphic && (t3.graphic = e2[o2 + i3]);
    });
  }
  async _selectedFeatureChange(e2) {
    if (!e2)
      return;
    const { location: t2, updateLocationEnabled: i2, view: s2 } = this;
    if (this.browseClusterEnabled) {
      if (this._selectedClusterFeature && (s2.graphics.remove(this._selectedClusterFeature), this._selectedClusterFeature = null), l$_(e2))
        return;
      return e2.symbol = await x$m(e2), this._selectedClusterFeature = e2, void s2.graphics.add(this._selectedClusterFeature);
    }
    !i2 && t2 || !e2.geometry ? i2 && !e2.geometry && this.centerAtLocation().then(() => {
      this.location = s2.center.clone();
    }) : this.location = e$2e(this._getPointFromGeometry(e2.geometry));
  }
  _waitingForResultChange() {
    !this.featureCount && this.promises && (this.visible = false);
  }
  _setFetchFeaturesPromises(e2) {
    return this._fetchFeaturesWithController(this._getScreenPoint(e2 || this.location)).then((e3) => {
      const { clientOnlyGraphics: t2, promisesPerLayerView: i2 } = e3, s2 = Promise.resolve(t2), r2 = i2.map((e4) => e4.promise);
      this.promises = [s2, ...r2];
    });
  }
  _destroyFeatureVMs() {
    this.featureViewModels.forEach((e2) => e2 && !e2.destroyed && e2.destroy()), this._set("featureViewModels", []);
  }
  _updateFeatureVMs() {
    const { selectedFeature: e2, features: t2, featureViewModels: i2 } = this;
    if (l$_(e2) || (this.browseClusterEnabled = false), this._destroyFeatureVMs(), !t2 || !t2.length)
      return;
    const s2 = i2.slice(0), r2 = [];
    t2.forEach((t3, i3) => {
      var _a2, _b2;
      if (!t3)
        return;
      let o2 = null;
      if (s2.some((e3, i4) => (e3 && e3.graphic === t3 && (o2 = e3, s2.splice(i4, 1)), !!o2)), o2)
        r2[i3] = o2;
      else {
        const s3 = new W$a({ abilities: this.featureViewModelAbilities, defaultPopupTemplateEnabled: this.defaultPopupTemplateEnabled, spatialReference: (_a2 = this.view) == null ? void 0 : _a2.spatialReference, graphic: t3 === e2 ? t3 : null, map: (_b2 = this.view) == null ? void 0 : _b2.map, view: this.view });
        r2[i3] = s3;
      }
    }), s2.forEach((e3) => e3 && !e3.destroyed && e3.destroy()), this._set("featureViewModels", r2);
  }
  _getScreenPoint(e2) {
    const { view: t2 } = this;
    return t2 && e2 && typeof t2.toScreen == "function" ? t2.toScreen(e2) : null;
  }
  _autoOpenEnabledChange() {
    const e2 = "auto-fetch-features", { _handles: t2, autoOpenEnabled: i2 } = this;
    if (t2.remove(e2), i2 && this.view) {
      const i3 = this.view.on("click", (e3) => {
        e3.pointerType === "mouse" && e3.button !== 0 || this._fetchFeaturesAndOpen(e3);
      }, P$h.WIDGET);
      t2.add(i3, e2);
    }
  }
  _cancelFetchingFeatures() {
    const e2 = this._fetchFeaturesController;
    e2 && e2.abort(), this._fetchFeaturesController = null, this.notifyChange("waitingForResult");
  }
  _fetchFeaturesWithController(e2, t2) {
    this._cancelFetchingFeatures();
    const i2 = new AbortController(), { signal: s2 } = i2;
    this._fetchFeaturesController = i2, this.notifyChange("waitingForResult");
    const r2 = this.fetchFeatures(e2, { signal: s2, event: t2 });
    return r2.catch(() => {
    }).then(() => {
      this._fetchFeaturesController = null, this.notifyChange("waitingForResult");
    }), r2;
  }
  _fetchFeaturesAndOpen(e2) {
    const { screenPoint: t2, mapPoint: i2 } = e2, { view: s2 } = this;
    this._fetchFeaturesWithController(t2, e2).then((e3) => {
      const { clientOnlyGraphics: t3, promisesPerLayerView: r2, location: o2 } = e3, n2 = [Promise.resolve(t3), ...r2.map((e4) => e4.promise)];
      return s2.popup.open({ location: o2 || i2, promises: n2 }), e3;
    });
  }
  _updatePendingPromises(e2) {
    e2 && this._pendingPromises.has(e2) && (this._pendingPromises.delete(e2), this.notifyChange("pendingPromisesCount"));
  }
  _autoClose() {
    this.autoCloseEnabled && (this.visible = false);
  }
  _getPointFromGeometry(e2) {
    var _a2;
    return t$2r(e2) ? null : e2.type === "point" ? e2 : e2.type === "extent" ? e2.center : e2.type === "polygon" ? e2.centroid : e2.type === "multipoint" || e2.type === "polyline" ? (_a2 = e2.extent) == null ? void 0 : _a2.center : null;
  }
  async _getLayerView(e2, t2) {
    return await e2.when(), e2.whenLayerView(t2);
  }
  _getHighlightLayer(e2) {
    const { layer: t2, sourceLayer: i2 } = e2;
    return i2 && "layer" in i2 && i2.layer ? i2.layer : (i2 == null ? void 0 : i2.type) === "map-notes" || (i2 == null ? void 0 : i2.type) === "subtype-group" ? i2 : t2;
  }
  _getHighlightTarget(e2, t2) {
    const i2 = t2.type === "imagery" ? void 0 : "objectIdField" in t2 ? t2.objectIdField || o$V : null, s2 = e2.attributes;
    return s2 && i2 && s2[i2] || e2;
  }
  async _highlightActiveFeature() {
    const e2 = "highlight-active-feature";
    this._handles.remove(e2);
    const { highlightEnabled: t2, view: i2, activeFeature: s2, visible: r2 } = this;
    if (!(s2 && i2 && t2 && r2))
      return;
    const o2 = this._getHighlightLayer(s2);
    if (!(o2 && o2 instanceof b$y))
      return;
    const n2 = this._getLayerView(i2, o2);
    this._highlightActiveFeaturePromise = n2;
    const a2 = await n2;
    if (!(a2 && e$E(a2) && this._highlightActiveFeaturePromise === n2 && this.activeFeature && this.highlightEnabled))
      return;
    const l2 = a2.highlight(this._getHighlightTarget(s2, o2));
    this._handles.add(l2, e2);
  }
  async _highlightSelectedFeature() {
    const e2 = "highlight-selected-feature";
    this._handles.remove(e2);
    const { selectedFeature: t2, highlightEnabled: i2, view: s2, visible: r2 } = this;
    if (!(t2 && s2 && i2 && r2))
      return;
    const o2 = this._getHighlightLayer(t2);
    if (!(o2 && o2 instanceof b$y))
      return;
    const n2 = this._getLayerView(s2, o2);
    this._highlightSelectedFeaturePromise = n2;
    const a2 = await n2;
    if (!(a2 && e$E(a2) && this._highlightSelectedFeaturePromise === n2 && this.selectedFeature && this.highlightEnabled && this.visible))
      return;
    const l2 = a2.highlight(this._getHighlightTarget(t2, o2));
    this._handles.add(l2, e2);
  }
  _updateFeatures(e2) {
    const { features: t2 } = this;
    if (!e2 || !e2.length)
      return;
    if (!t2.length)
      return void (this.features = e2);
    const i2 = e2.filter((e3) => !t2.includes(e3));
    this.features = t2.concat(i2);
  }
};
e$2g([y$1I()], z$l.prototype, "featurePage", void 0), e$2g([y$1I()], z$l.prototype, "isLoadingFeature", null), e$2g([y$1I({ type: B$f })], z$l.prototype, "actions", void 0), e$2g([y$1I({ readOnly: true })], z$l.prototype, "active", null), e$2g([y$1I()], z$l.prototype, "activeFeature", void 0), e$2g([y$1I({ readOnly: true })], z$l.prototype, "allActions", null), e$2g([y$1I({ type: Boolean })], z$l.prototype, "defaultPopupTemplateEnabled", void 0), e$2g([y$1I()], z$l.prototype, "autoCloseEnabled", void 0), e$2g([y$1I()], z$l.prototype, "autoOpenEnabled", void 0), e$2g([y$1I()], z$l.prototype, "browseClusterEnabled", void 0), e$2g([y$1I()], z$l.prototype, "content", void 0), e$2g([y$1I({ type: B$f, readOnly: true })], z$l.prototype, "defaultActions", null), e$2g([y$1I({ readOnly: true })], z$l.prototype, "featureCount", null), e$2g([y$1I()], z$l.prototype, "features", null), e$2g([y$1I()], z$l.prototype, "featuresPerPage", void 0), e$2g([y$1I()], z$l.prototype, "featureViewModelAbilities", void 0), e$2g([y$1I({ readOnly: true })], z$l.prototype, "featureViewModels", void 0), e$2g([y$1I()], z$l.prototype, "highlightEnabled", void 0), e$2g([y$1I()], z$l.prototype, "includeDefaultActions", void 0), e$2g([y$1I({ type: w$_ })], z$l.prototype, "location", null), e$2g([y$1I({ readOnly: true })], z$l.prototype, "pendingPromisesCount", null), e$2g([y$1I({ readOnly: true })], z$l.prototype, "selectedClusterBoundaryFeature", void 0), e$2g([y$1I({ readOnly: true })], z$l.prototype, "waitingForResult", null), e$2g([y$1I({ readOnly: true })], z$l.prototype, "promiseCount", null), e$2g([y$1I()], z$l.prototype, "promises", null), e$2g([y$1I({ value: null, readOnly: true })], z$l.prototype, "selectedFeature", null), e$2g([y$1I({ value: -1 })], z$l.prototype, "selectedFeatureIndex", null), e$2g([y$1I({ readOnly: true })], z$l.prototype, "selectedFeatureViewModel", null), e$2g([y$1I({ readOnly: true })], z$l.prototype, "state", null), e$2g([y$1I()], z$l.prototype, "title", void 0), e$2g([y$1I()], z$l.prototype, "updateLocationEnabled", void 0), e$2g([y$1I()], z$l.prototype, "view", void 0), e$2g([y$1I()], z$l.prototype, "visible", void 0), e$2g([y$1I()], z$l.prototype, "zoomFactor", void 0), e$2g([y$1I()], z$l.prototype, "zoomToLocation", void 0), e$2g([y$1I()], z$l.prototype, "centerAtLocation", null), z$l = e$2g([n$2P("esri.widgets.Popup.PopupViewModel")], z$l);
const H$a = z$l;
const E$n = "selected-index", N$f = 0, D$d = "popup-spinner", B$e = { calciteThemeLight: "calcite-theme-light", calciteThemeDark: "calcite-theme-dark", iconLeftTriangleArrow: "esri-icon-left-triangle-arrow", iconRightTriangleArrow: "esri-icon-right-triangle-arrow", iconDockToTop: "esri-icon-maximize", iconDockToBottom: "esri-icon-dock-bottom", iconDockToLeft: "esri-icon-dock-left", iconDockToRight: "esri-icon-dock-right", iconClose: "esri-icon-close", iconUndock: "esri-icon-minimize", iconCheckMark: "esri-icon-check-mark", iconLoading: "esri-icon-loading-indicator", iconDefaultAction: "esri-icon-default-action", iconActionsMenu: "esri-icon-handle-horizontal", rotating: "esri-rotating", base: "esri-popup", widget: "esri-widget", main: "esri-popup__main-container", loadingContainer: "esri-popup__loading-container", isCollapsible: "esri-popup--is-collapsible", isCollapsed: "esri-popup--is-collapsed", shadow: "esri-popup--shadow", isDocked: "esri-popup--is-docked", isDockedTopLeft: "esri-popup--is-docked-top-left", isDockedTopCenter: "esri-popup--is-docked-top-center", isDockedTopRight: "esri-popup--is-docked-top-right", isDockedBottomLeft: "esri-popup--is-docked-bottom-left", isDockedBottomCenter: "esri-popup--is-docked-bottom-center", isDockedBottomRight: "esri-popup--is-docked-bottom-right", alignTopCenter: "esri-popup--aligned-top-center", alignBottomCenter: "esri-popup--aligned-bottom-center", alignTopLeft: "esri-popup--aligned-top-left", alignBottomLeft: "esri-popup--aligned-bottom-left", alignTopRight: "esri-popup--aligned-top-right", alignBottomRight: "esri-popup--aligned-bottom-right", isFeatureMenuOpen: "esri-popup--feature-menu-open", isActionsMenuOpen: "esri-popup--actions-menu-open", hasFeatureUpdated: "esri-popup--feature-updated", header: "esri-popup__header", headerButtons: "esri-popup__header-buttons", headerContainer: "esri-popup__header-container", headerContainerButton: "esri-popup__header-container--button", headerTitle: "esri-popup__header-title", content: "esri-popup__content", contentHasFlows: "esri-content--has-flows", contentFlowItem: "esri-content__flow-item", footer: "esri-popup__footer", footerHasPagination: "esri-popup__footer--has-pagination", footerHasActions: "esri-popup__footer--has-actions", footerHasActionsMenu: "esri-popup__footer--has-actions-menu", button: "esri-popup__button", buttonDisabled: "esri-popup__button--disabled", buttonDock: "esri-popup__button--dock", icon: "esri-popup__icon", iconDock: "esri-popup__icon--dock-icon", inlineActionsContainer: "esri-popup__inline-actions-container", actionsMenuButton: "esri-popup__actions-menu-button", actions: "esri-popup__actions", action: "esri-popup__action", actionImage: "esri-popup__action-image", actionText: "esri-popup__action-text", actionToggle: "esri-popup__action-toggle", actionToggleOn: "esri-popup__action-toggle--on", actionExit: "esri-popup__action--exit", pointer: "esri-popup__pointer", pointerDirection: "esri-popup__pointer-direction", navigation: "esri-popup__navigation", paginationPrevious: "esri-popup__pagination-previous", paginationNext: "esri-popup__pagination-next", paginationPreviousIconLTR: "esri-popup__pagination-previous-icon", paginationPreviousIconRTL: "esri-popup__pagination-previous-icon--rtl", paginationNextIconLTR: "esri-popup__pagination-next-icon", paginationNextIconRTL: "esri-popup__pagination-next-icon--rtl", featureMenu: "esri-popup__feature-menu", featureMenuList: "esri-popup__feature-menu-list", featureMenuItem: "esri-popup__feature-menu-item", featureMenuViewport: "esri-popup__feature-menu-viewport", featureMenuHeader: "esri-popup__feature-menu-header", featureMenuNote: "esri-popup__feature-menu-note", featureMenuSelected: "esri-popup__feature-menu-item--selected", featureMenuButton: "esri-popup__feature-menu-button", featureMenuTitle: "esri-popup__feature-menu-title", featureMenuObserver: "esri-popup__feature-menu-observer", featureMenuLoader: "esri-popup__feature-menu-loader", collapseButton: "esri-popup__collapse-button", collapseIcon: "esri-popup__collapse-icon" }, P$g = { buttonEnabled: true, position: "auto", breakpoint: { width: 544 } }, L$e = "esri-popup";
function R$d(e2, t2) {
  return t2 === void 0 ? `${L$e}__${e2}` : `${L$e}__${e2}-${t2}`;
}
const S$i = { closeButton: true, featureNavigation: true };
let V$d = class extends i$1d(M$u) {
  constructor(e2, i2) {
    super(e2, i2), this._blurClose = false, this._blurContainer = false, this._containerNode = null, this._mainContainerNode = null, this._featureMenuNode = null, this._actionsMenuNode = null, this._focusClose = false, this._focusContainer = false, this._focusDockButton = false, this._focusFeatureMenuButton = false, this._focusActionsMenuButton = false, this._focusFirstFeature = false, this._focusFirstAction = false, this._handles = new t$2g(), this._pointerOffsetInPx = 16, this._spinner = null, this._feature = null, this._featureMenuIntersectionObserverCallback = ([e3]) => {
      (e3 == null ? void 0 : e3.isIntersecting) && this.viewModel.featurePage++;
    }, this._featureMenuIntersectionObserver = new IntersectionObserver(this._featureMenuIntersectionObserverCallback, { root: window.document }), this._displaySpinnerThrottled = e$1n(() => this._displaySpinner(), N$f), this._exitRelatedRecordsActions = new WeakMap(), this._flowItems = new j$V(), this.alignment = "auto", this.collapsed = false, this.collapseEnabled = true, this.dockEnabled = false, this.featureMenuOpen = false, this.headingLevel = 2, this.maxInlineActions = 3, this.messages = null, this.messagesCommon = null, this.spinnerEnabled = true, this.viewModel = new H$a(), this.visibleElements = __spreadValues({}, S$i), this._addSelectedFeatureIndexHandle(), this.addHandles([l$1P(() => {
      var _a2;
      return (_a2 = this.viewModel) == null ? void 0 : _a2.screenLocation;
    }, () => this._positionContainer()), l$1P(() => {
      var _a2;
      return [(_a2 = this.viewModel) == null ? void 0 : _a2.active, this.dockEnabled];
    }, () => this._toggleScreenLocationEnabled()), l$1P(() => {
      var _a2;
      return (_a2 = this.viewModel) == null ? void 0 : _a2.screenLocation;
    }, (e3, t2) => {
      !!e3 != !!t2 && this.reposition();
    }), l$1P(() => {
      var _a2, _b2, _c2, _d2, _e3, _f2;
      return [(_b2 = (_a2 = this.viewModel) == null ? void 0 : _a2.view) == null ? void 0 : _b2.padding, (_d2 = (_c2 = this.viewModel) == null ? void 0 : _c2.view) == null ? void 0 : _d2.size, (_e3 = this.viewModel) == null ? void 0 : _e3.active, (_f2 = this.viewModel) == null ? void 0 : _f2.location, this.alignment];
    }, () => this.reposition()), l$1P(() => this.spinnerEnabled, (e3) => this._spinnerEnabledChange(e3)), l$1P(() => {
      var _a2, _b2;
      return (_b2 = (_a2 = this.viewModel) == null ? void 0 : _a2.view) == null ? void 0 : _b2.size;
    }, (e3, t2) => this._updateDockEnabledForViewSize(e3, t2)), l$1P(() => {
      var _a2;
      return (_a2 = this.viewModel) == null ? void 0 : _a2.view;
    }, (e3, t2) => this._viewChange(e3, t2)), l$1P(() => {
      var _a2, _b2;
      return (_b2 = (_a2 = this.viewModel) == null ? void 0 : _a2.view) == null ? void 0 : _b2.ready;
    }, (e3, t2) => this._viewReadyChange(e3, t2)), l$1P(() => {
      var _a2, _b2;
      return [(_a2 = this.viewModel) == null ? void 0 : _a2.waitingForResult, (_b2 = this.viewModel) == null ? void 0 : _b2.location];
    }, () => {
      this._hideSpinner(), this._displaySpinnerThrottled();
    }), l$1P(() => this.selectedFeatureWidget, () => this._destroyFlowItemWidgets()), l$1P(() => {
      var _a2, _b2, _c2, _d2;
      return [(_b2 = (_a2 = this.selectedFeatureWidget) == null ? void 0 : _a2.viewModel) == null ? void 0 : _b2.title, (_d2 = (_c2 = this.selectedFeatureWidget) == null ? void 0 : _c2.viewModel) == null ? void 0 : _d2.state];
    }, () => this._setTitleFromFeatureWidget()), l$1P(() => {
      var _a2, _b2, _c2, _d2;
      return [(_b2 = (_a2 = this.selectedFeatureWidget) == null ? void 0 : _a2.viewModel) == null ? void 0 : _b2.content, (_d2 = (_c2 = this.selectedFeatureWidget) == null ? void 0 : _c2.viewModel) == null ? void 0 : _d2.state];
    }, () => this._setContentFromFeatureWidget()), f$1o(() => !this.collapsed, () => {
      var _a2, _b2;
      ((_b2 = (_a2 = this.viewModel) == null ? void 0 : _a2.view) == null ? void 0 : _b2.widthBreakpoint) === "xsmall" && this.viewModel.active && this.collapseEnabled && this.viewModel.centerAtLocation();
    }), a$2a(() => {
      var _a2;
      return (_a2 = this.viewModel) == null ? void 0 : _a2.allActions;
    }, "change", () => this._watchActions()), l$1P(() => {
      var _a2;
      return (_a2 = this.viewModel) == null ? void 0 : _a2.allActions;
    }, () => this._watchActions(), h$1j), l$1P(() => {
      var _a2;
      return (_a2 = this.viewModel) == null ? void 0 : _a2.featureViewModels;
    }, () => this._featureMenuViewportScrollTop()), a$2a(() => this._flowItems, "change", () => {
      this.notifyChange("_activeFlowItemWidget"), this.scheduleRender();
    }), l$1P(() => {
      var _a2, _b2, _c2, _d2;
      return [(_b2 = (_a2 = this._activeFlowItemWidget) == null ? void 0 : _a2.viewModel) == null ? void 0 : _b2.state, (_d2 = (_c2 = this._activeFlowItemWidget) == null ? void 0 : _c2.viewModel) == null ? void 0 : _d2.title];
    }, () => this.scheduleRender())]);
  }
  loadDependencies() {
    return Promise.all([import("./calcite-flow.js"), import("./calcite-flow-item.js"), import("./calcite-action.js"), import("./calcite-tooltip.js"), import("./calcite-icon.js")]);
  }
  destroy() {
    var _a2, _b2;
    this._destroyFlowItemWidgets(), this._destroySelectedFeatureWidget(), this._destroySpinner(), (_a2 = this._handles) == null ? void 0 : _a2.destroy(), this._unobserveFeatureMenuObserver(), (_b2 = this._featureMenuIntersectionObserver) == null ? void 0 : _b2.disconnect(), this._handles = null;
  }
  get actionsMenuId() {
    return `${this.id}-actions-menu`;
  }
  get actionsMenuButtonId() {
    return `${this.id}-actions-menu-button`;
  }
  get featureMenuId() {
    return `${this.id}-feature-menu`;
  }
  get titleId() {
    return `${this.id}-popup-title`;
  }
  get contentId() {
    return `${this.id}-popup-content`;
  }
  get hasContent() {
    const { selectedFeatureWidget: e2, viewModel: t2 } = this;
    if (!e2)
      return !!(t2 == null ? void 0 : t2.content);
    const i2 = e2.viewModel;
    if ((i2 == null ? void 0 : i2.waitingForContent) || (i2 == null ? void 0 : i2.state) === "error")
      return true;
    const o2 = i2 == null ? void 0 : i2.content;
    return Array.isArray(o2) ? !!o2.length : !!o2;
  }
  get featureNavigationVisible() {
    return this.viewModel.active && this.viewModel.featureCount > 1 && this.visibleElements.featureNavigation;
  }
  get collapsible() {
    return !!(this.collapseEnabled && this.viewModel.title && this.hasContent);
  }
  get featureMenuVisible() {
    return this.featureNavigationVisible && this.featureMenuOpen;
  }
  get contentCollapsed() {
    return this.collapsible && !this.featureMenuVisible && this.collapsed;
  }
  get dividedActions() {
    return this._divideActions();
  }
  get _activeFlowItemWidget() {
    const { _flowItems: e2 } = this;
    return e2.getItemAt(e2.length - 1) || null;
  }
  get actions() {
    return this.viewModel.actions;
  }
  set actions(e2) {
    this.viewModel.actions = e2;
  }
  set actionsMenuOpen(e2) {
    this._set("actionsMenuOpen", !!e2);
  }
  get actionsMenuOpen() {
    return !!this.viewModel.active && this._get("actionsMenuOpen");
  }
  get autoCloseEnabled() {
    return this.viewModel.autoCloseEnabled;
  }
  set autoCloseEnabled(e2) {
    this.viewModel.autoCloseEnabled = e2;
  }
  get autoOpenEnabled() {
    return this.viewModel.autoOpenEnabled;
  }
  set autoOpenEnabled(e2) {
    this.viewModel.autoOpenEnabled = e2;
  }
  get defaultPopupTemplateEnabled() {
    return this.viewModel.defaultPopupTemplateEnabled;
  }
  set defaultPopupTemplateEnabled(e2) {
    this.viewModel.defaultPopupTemplateEnabled = e2;
  }
  get content() {
    return this.viewModel.content;
  }
  set content(e2) {
    this.viewModel.content = e2;
  }
  get currentAlignment() {
    return this._getCurrentAlignment();
  }
  get currentDockPosition() {
    return this._getCurrentDockPosition();
  }
  get dockOptions() {
    return this._get("dockOptions") || P$g;
  }
  set dockOptions(e2) {
    const t2 = __spreadValues({}, P$g), i2 = this.get("viewModel.view.breakpoints"), o2 = {};
    i2 && (o2.width = i2.xsmall, o2.height = i2.xsmall);
    const n2 = __spreadValues(__spreadValues({}, t2), e2), s2 = __spreadValues(__spreadValues({}, t2.breakpoint), o2), { breakpoint: r2 } = n2;
    r2 === true ? n2.breakpoint = s2 : typeof r2 == "object" && (n2.breakpoint = __spreadValues(__spreadValues({}, s2), r2)), this._set("dockOptions", n2), this._setCurrentDockPosition(), this.reposition();
  }
  get featureCount() {
    return this.viewModel.featureCount;
  }
  get features() {
    return this.viewModel.features;
  }
  set features(e2) {
    this.viewModel.features = e2;
  }
  get goToOverride() {
    return this.viewModel.goToOverride;
  }
  set goToOverride(e2) {
    this.viewModel.goToOverride = e2;
  }
  get highlightEnabled() {
    return this.viewModel.highlightEnabled;
  }
  set highlightEnabled(e2) {
    this.viewModel.highlightEnabled = e2;
  }
  get location() {
    return this.viewModel.location;
  }
  set location(e2) {
    this.viewModel.location = e2;
  }
  get label() {
    var _a2, _b2;
    return (_b2 = (_a2 = this.messages) == null ? void 0 : _a2.widgetLabel) != null ? _b2 : "";
  }
  set label(e2) {
    this._overrideIfSome("label", e2);
  }
  get promises() {
    return this.viewModel.promises;
  }
  set promises(e2) {
    this.viewModel.promises = e2;
  }
  get selectedFeature() {
    return this.viewModel.selectedFeature;
  }
  get selectedFeatureIndex() {
    return this.viewModel.selectedFeatureIndex;
  }
  set selectedFeatureIndex(e2) {
    this.viewModel.selectedFeatureIndex = e2;
  }
  get selectedFeatureWidget() {
    const { _feature: e2, visibleElements: t2, headingLevel: i2, _flowItems: o2 } = this, { selectedFeatureViewModel: n2 } = this.viewModel, s2 = __spreadProps(__spreadValues({}, t2), { title: false });
    return n2 ? (e2 ? (e2.viewModel = n2, e2.visibleElements = s2) : this._feature = new C$k({ flowItems: o2, headingLevel: i2 + 1, viewModel: n2, visibleElements: s2 }), this._feature) : null;
  }
  get title() {
    return this.viewModel.title;
  }
  set title(e2) {
    this.viewModel.title = e2;
  }
  get updateLocationEnabled() {
    return this.viewModel.updateLocationEnabled;
  }
  set updateLocationEnabled(e2) {
    this.viewModel.updateLocationEnabled = e2;
  }
  get view() {
    return this.viewModel.view;
  }
  set view(e2) {
    this.viewModel.view = e2;
  }
  get visible() {
    return this.viewModel.visible;
  }
  set visible(e2) {
    this.viewModel.visible = e2;
  }
  castVisibleElements(e2) {
    return __spreadValues(__spreadValues({}, S$i), e2);
  }
  blur() {
    const { active: e2 } = this.viewModel;
    e2 || s$2z.getLogger(this.declaredClass).warn("Popup can only be blurred when currently active."), this.visibleElements.closeButton ? this._blurClose = true : this._blurContainer = true, this.scheduleRender();
  }
  clear() {
    return this.viewModel.clear();
  }
  close() {
    this.visible = false;
  }
  fetchFeatures(e2, t2) {
    return this.viewModel.fetchFeatures(e2, t2);
  }
  focus() {
    const { active: e2 } = this.viewModel;
    e2 || s$2z.getLogger(this.declaredClass).warn("Popup can only be focused when currently active."), this.visibleElements.closeButton ? this._focusClose = true : this._focusContainer = true, this.scheduleRender();
  }
  next() {
    return this.viewModel.next();
  }
  open(e2) {
    var _a2, _b2;
    this._handles.remove(E$n);
    const t2 = !!e2 && !!e2.featureMenuOpen, i2 = !!e2 && !!e2.actionsMenuOpen, o2 = { collapsed: !!e2 && !!e2.collapsed, actionsMenuOpen: i2, featureMenuOpen: t2 };
    ((_b2 = (_a2 = this.viewModel) == null ? void 0 : _a2.view) == null ? void 0 : _b2.widthBreakpoint) === "xsmall" && (o2.collapsed = true), this.set(o2), this.viewModel.open(e2), this._shouldFocus(e2), this._addSelectedFeatureIndexHandle();
  }
  previous() {
    return this.viewModel.previous();
  }
  reposition() {
    this.renderNow(), this._positionContainer(), this._setCurrentAlignment();
  }
  triggerAction(e2) {
    return this.viewModel.triggerAction(e2);
  }
  render() {
    var _a2, _b2, _c2, _d2;
    const { actionsMenuOpen: e2, dockEnabled: t2, featureMenuVisible: i2, dividedActions: o2, currentAlignment: n2, currentDockPosition: s2 } = this, { active: r2 } = this.viewModel, { menuActions: a2 } = o2, l2 = r2 && a2.length > 1 && e2, c2 = r2 && t2, u2 = r2 && !t2, d2 = (_b2 = (_a2 = this.selectedFeature) == null ? void 0 : _a2.layer) == null ? void 0 : _b2.title, p2 = (_d2 = (_c2 = this.selectedFeature) == null ? void 0 : _c2.layer) == null ? void 0 : _d2.id, h2 = { [B$e.alignTopCenter]: n2 === "top-center", [B$e.alignBottomCenter]: n2 === "bottom-center", [B$e.alignTopLeft]: n2 === "top-left", [B$e.alignBottomLeft]: n2 === "bottom-left", [B$e.alignTopRight]: n2 === "top-right", [B$e.alignBottomRight]: n2 === "bottom-right", [B$e.isDocked]: c2, [B$e.shadow]: u2, [B$e.isDockedTopLeft]: s2 === "top-left", [B$e.isDockedTopCenter]: s2 === "top-center", [B$e.isDockedTopRight]: s2 === "top-right", [B$e.isDockedBottomLeft]: s2 === "bottom-left", [B$e.isDockedBottomCenter]: s2 === "bottom-center", [B$e.isDockedBottomRight]: s2 === "bottom-right", [B$e.isFeatureMenuOpen]: i2, [B$e.isActionsMenuOpen]: l2 };
    return n$1U("div", { class: this.classes(B$e.base, h2), role: "presentation", "data-layer-title": d2, "data-layer-id": p2, bind: this, afterCreate: this._positionContainer, afterUpdate: this._positionContainer }, r2 ? [this.renderMainContainer(), this.renderPointer()] : null);
  }
  renderLoadingIcon() {
    return n$1U("span", { "aria-hidden": "true", class: this.classes(B$e.icon, B$e.iconLoading, B$e.rotating) });
  }
  renderNavigationLoading() {
    const { messagesCommon: e2 } = this;
    return this.viewModel.pendingPromisesCount ? n$1U("div", { key: R$d("loading-container"), role: "presentation", class: B$e.loadingContainer, "aria-label": e2.loading, title: e2.loading }, this.renderLoadingIcon()) : null;
  }
  renderPreviousIcon() {
    const e2 = f$1g(this.container), t2 = { [B$e.iconRightTriangleArrow]: e2, [B$e.paginationPreviousIconRTL]: e2, [B$e.iconLeftTriangleArrow]: !e2, [B$e.paginationPreviousIconLTR]: !e2 };
    return n$1U("span", { "aria-hidden": "true", class: this.classes(B$e.icon, t2) });
  }
  renderPreviousButton() {
    const { messages: e2 } = this;
    return n$1U("div", { role: "button", tabIndex: 0, bind: this, onclick: this._previous, onkeydown: this._previous, class: this.classes(B$e.button, B$e.paginationPrevious), "aria-label": e2.previous, title: e2.previous }, this.renderPreviousIcon());
  }
  renderNextIcon() {
    const e2 = f$1g(this.container), t2 = { [B$e.iconLeftTriangleArrow]: e2, [B$e.paginationNextIconRTL]: e2, [B$e.iconRightTriangleArrow]: !e2, [B$e.paginationNextIconLTR]: !e2 };
    return n$1U("span", { "aria-hidden": "true", class: this.classes(B$e.icon, t2) });
  }
  renderNextButton() {
    const { messages: e2 } = this;
    return n$1U("div", { role: "button", tabIndex: 0, bind: this, onclick: this._next, onkeydown: this._next, class: this.classes(B$e.button, B$e.paginationNext), "aria-label": e2.next, title: e2.next }, this.renderNextIcon());
  }
  renderFeatureMenuButton() {
    const { featureMenuOpen: e2, featureMenuId: t2, messagesCommon: i2 } = this, { featureCount: o2, selectedFeatureIndex: n2 } = this.viewModel;
    return n$1U("div", { role: "button", tabIndex: 0, bind: this, onclick: this._toggleFeatureMenu, onkeydown: this._toggleFeatureMenu, afterCreate: this._focusFeatureMenuButtonNode, afterUpdate: this._focusFeatureMenuButtonNode, class: this.classes(B$e.button, B$e.featureMenuButton), "aria-haspopup": "true", "aria-controls": t2, "aria-expanded": e2.toString(), "aria-label": i2.menu, title: i2.menu }, this._getPageText(o2, n2));
  }
  renderNavigationButtons() {
    return this.featureNavigationVisible ? [this.renderPreviousButton(), this.renderNavigationLoading() || this.renderFeatureMenuButton(), this.renderNextButton()] : null;
  }
  renderDockIcon() {
    const { dockEnabled: e2 } = this, t2 = this._wouldDockTo(), i2 = { [B$e.iconUndock]: e2, [B$e.iconDock]: !e2, [B$e.iconDockToRight]: !e2 && (t2 === "top-right" || t2 === "bottom-right"), [B$e.iconDockToLeft]: !e2 && (t2 === "top-left" || t2 === "bottom-left"), [B$e.iconDockToTop]: !e2 && t2 === "top-center", [B$e.iconDockToBottom]: !e2 && t2 === "bottom-center" };
    return n$1U("span", { "aria-hidden": "true", class: this.classes(i2, B$e.icon) });
  }
  renderDockButton() {
    var _a2, _b2, _c2;
    const { dockEnabled: e2, messages: t2 } = this, i2 = (_b2 = (_a2 = this.viewModel) == null ? void 0 : _a2.view) == null ? void 0 : _b2.widthBreakpoint, o2 = e2 ? t2.undock : t2.dock;
    return i2 !== "xsmall" && ((_c2 = this.dockOptions) == null ? void 0 : _c2.buttonEnabled) ? n$1U("div", { role: "button", "aria-label": o2, title: o2, tabIndex: 0, bind: this, onclick: this._toggleDockEnabled, onkeydown: this._toggleDockEnabled, afterCreate: this._focusDockButtonNode, afterUpdate: this._focusDockButtonNode, class: this.classes(B$e.button, B$e.buttonDock) }, this.renderDockIcon()) : null;
  }
  renderTitle() {
    const { title: e2 } = this.viewModel, { titleId: t2, collapsible: i2, contentCollapsed: o2, messagesCommon: n2 } = this, s2 = { [B$e.headerContainerButton]: i2 }, r2 = n$1U(n$1T, { level: this.headingLevel, class: B$e.headerTitle, innerHTML: e2 }), a2 = i2 ? n$1U("button", { key: `${e2}--collapsible`, id: t2, title: o2 ? n2.expand : n2.collapse, bind: this, enterAnimation: this._createFeatureUpdatedAnimation(), class: this.classes(B$e.headerContainer, s2), "aria-expanded": o2 ? "false" : "true", onclick: this._toggleCollapsed, type: "button" }, r2, n$1U("calcite-icon", { class: B$e.collapseIcon, key: "collapse-icon", icon: o2 ? "chevron-down" : "chevron-up", scale: "m" })) : n$1U("div", { key: e2, id: t2, bind: this, enterAnimation: this._createFeatureUpdatedAnimation(), class: this.classes(B$e.headerContainer, s2) }, r2);
    return e2 ? a2 : null;
  }
  renderCloseIcon() {
    return n$1U("span", { "aria-hidden": "true", class: this.classes(B$e.icon, B$e.iconClose) });
  }
  renderCloseButton() {
    const { visibleElements: e2, messagesCommon: t2 } = this;
    return e2.closeButton ? n$1U("div", { role: "button", tabIndex: 0, bind: this, onclick: this._close, onkeydown: this._close, class: B$e.button, "aria-label": t2.close, title: t2.close, afterCreate: this._closeButtonNodeUpdated, afterUpdate: this._closeButtonNodeUpdated }, this.renderCloseIcon()) : null;
  }
  renderHeader() {
    return n$1U("header", { class: B$e.header }, this.renderTitle(), n$1U("div", { class: B$e.headerButtons }, this.renderDockButton(), this.renderCloseButton()));
  }
  renderContentContainer() {
    const { contentId: e2, hasContent: t2, contentCollapsed: i2, _flowItems: o2, messagesCommon: n2 } = this, { content: s2 } = this.viewModel, r2 = o2.toArray(), a2 = { [B$e.contentHasFlows]: !!r2.length };
    return t2 && !i2 ? n$1U("div", { key: s2, enterAnimation: this._createFeatureUpdatedAnimation(), id: e2, class: this.classes(B$e.content, a2) }, n$1U("calcite-flow", { bind: this, onCalciteFlowItemBack: this._handleBackClick }, n$1U("calcite-flow-item", { bind: this, "data-node-ref": "_rootFlowItemNode", "intl-back": n2.back, afterCreate: v$T, key: "root-flow-item" }, this.renderContent()), r2.map((e3) => this.renderFlowItem(e3))), r2.map((e3) => this.renderFlowItemTooltip(e3))) : null;
  }
  renderFlowItem(e2) {
    const { messages: t2, messagesCommon: i2 } = this, o2 = r$1e();
    return n$1U("calcite-flow-item", { class: this.classes({ [B$e.calciteThemeDark]: !o2, [B$e.calciteThemeLight]: o2 }), heading: e2.title, "intl-back": i2.back, description: this._getFlowItemDescription(e2), key: `flow-item-${e2.viewModel.uid}` }, n$1U("calcite-action", { class: B$e.actionExit, icon: "move-up", label: t2 == null ? void 0 : t2.exitRelatedRecords, text: t2 == null ? void 0 : t2.exitRelatedRecords, slot: "header-actions-start", bind: this, afterCreate: (t3) => this._storeExitRelatedRecordsAction(e2, t3), onclick: this._destroyFlowItemWidgets }), n$1U("div", { class: this.classes(B$e.contentFlowItem, { [B$e.calciteThemeDark]: o2, [B$e.calciteThemeLight]: !o2 }) }, e2.render()));
  }
  renderFlowItemTooltip(e2) {
    const { messages: t2, _exitRelatedRecordsActions: i2 } = this, o2 = r$1e();
    return n$1U("calcite-tooltip", { class: this.classes({ [B$e.calciteThemeDark]: !o2, [B$e.calciteThemeLight]: o2 }), key: `exit-related-records-tooltip-${e2.viewModel.uid}`, label: t2 == null ? void 0 : t2.exitRelatedRecords, overlayPositioning: "fixed", referenceElement: i2.get(e2), placement: "top" }, t2 == null ? void 0 : t2.exitRelatedRecords);
  }
  renderActionsMenuButton() {
    const { actionsMenuId: e2, actionsMenuButtonId: t2, actionsMenuOpen: i2, dividedActions: o2, messagesCommon: n2 } = this, s2 = i2 ? n2.close : n2.open, { menuActions: r2 } = o2;
    return r2.length ? n$1U("div", { key: R$d("actions-menu-button"), class: this.classes(B$e.button, B$e.actionsMenuButton), role: "button", id: t2, "aria-haspopup": "true", "aria-controls": i2 ? e2 : null, tabIndex: 0, bind: this, onclick: this._toggleActionsMenu, onkeydown: this._toggleActionsMenu, afterCreate: this._focusActionsMenuButtonNode, afterUpdate: this._focusActionsMenuButtonNode, "aria-label": s2, title: s2 }, n$1U("span", { "aria-hidden": "true", class: B$e.iconActionsMenu })) : null;
  }
  renderMenuActions() {
    const { actionsMenuId: e2, actionsMenuButtonId: t2, actionsMenuOpen: i2, dividedActions: o2 } = this, { menuActions: n2 } = o2;
    return n2.length && i2 ? n$1U("ul", { id: e2, role: "menu", "aria-labelledby": t2, key: R$d("actions"), class: B$e.actions, bind: this, onkeyup: this._handleActionMenuKeyup, afterCreate: this._actionsMenuNodeUpdated, afterUpdate: this._actionsMenuNodeUpdated }, n2.toArray().map((e3) => this.renderAction({ action: e3, type: "menu-item" }))) : null;
  }
  renderInlineActions() {
    const { inlineActions: e2 } = this.dividedActions;
    return !!e2.length && e2.toArray().map((e3) => this.renderAction({ action: e3, type: "inline" }));
  }
  renderInlineActionsContainer() {
    const { inlineActions: e2, menuActions: t2 } = this.dividedActions, i2 = !!e2.length, o2 = !!t2.length;
    return i2 || o2 ? n$1U("div", { key: "inline-actions-container", "data-inline-actions": i2.toString(), "data-menu-actions": o2.toString(), class: B$e.inlineActionsContainer }, this.renderInlineActions(), this.renderActionsMenuButton(), this.renderMenuActions()) : null;
  }
  renderNavigation() {
    return this.featureNavigationVisible ? n$1U("section", { key: R$d("navigation"), class: this.classes(B$e.navigation) }, this.renderNavigationButtons()) : null;
  }
  renderFooter() {
    const { featureNavigationVisible: e2, dividedActions: t2 } = this, { inlineActions: i2, menuActions: o2 } = t2, n2 = !!i2.length, s2 = !!o2.length, r2 = { [B$e.footerHasPagination]: e2, [B$e.footerHasActions]: n2, [B$e.footerHasActionsMenu]: s2 };
    return e2 || n2 ? n$1U("div", { key: R$d("feature-buttons"), class: this.classes(B$e.footer, r2) }, this.renderInlineActionsContainer(), this.renderNavigation()) : null;
  }
  renderFeatureMenuContainer() {
    const { messages: e2 } = this, { featureViewModels: t2, isLoadingFeature: i2 } = this.viewModel, o2 = s$1L(e2.selectedFeatures, { total: t2.length });
    return n$1U("section", { key: R$d("menu"), class: B$e.featureMenu }, n$1U("strong", { class: B$e.featureMenuHeader }, o2), n$1U("nav", { bind: this, class: B$e.featureMenuViewport, "data-node-ref": "_featureMenuViewportNode", afterCreate: v$T }, this.renderFeatureMenu(), n$1U("div", { class: B$e.featureMenuObserver, bind: this, afterCreate: this._featureMenuIntersectionObserverCreated }), i2 ? n$1U("div", { class: B$e.featureMenuLoader }, this.renderLoadingIcon()) : null));
  }
  renderPointer() {
    return this.dockEnabled ? null : n$1U("div", { key: R$d("pointer"), class: B$e.pointer, role: "presentation" }, n$1U("div", { class: this.classes(B$e.pointerDirection, B$e.shadow) }));
  }
  renderMainContainer() {
    const { dockEnabled: e2, currentAlignment: t2, currentDockPosition: i2, titleId: o2, contentId: n2, collapsible: s2, hasContent: r2, contentCollapsed: a2, visibleElements: l2 } = this, { title: c2 } = this.viewModel, u2 = t2 === "bottom-left" || t2 === "bottom-center" || t2 === "bottom-right" || i2 === "top-left" || i2 === "top-center" || i2 === "top-right", d2 = t2 === "top-left" || t2 === "top-center" || t2 === "top-right" || i2 === "bottom-left" || i2 === "bottom-center" || i2 === "bottom-right", p2 = { [B$e.shadow]: e2, [B$e.isCollapsible]: s2, [B$e.isCollapsed]: a2 };
    return n$1U("div", { class: this.classes(B$e.main, B$e.widget, p2), tabIndex: l2.closeButton ? null : -1, role: "dialog", "aria-labelledby": c2 ? o2 : "", "aria-describedby": r2 && !a2 ? n2 : "", bind: this, onkeyup: this._handleMainKeyup, afterCreate: this._mainContainerNodeUpdated, afterUpdate: this._mainContainerNodeUpdated }, u2 ? this.renderFooter() : null, u2 ? this.renderFeatureMenuContainer() : null, this.renderHeader(), this.renderContentContainer(), d2 ? this.renderFooter() : null, d2 ? this.renderFeatureMenuContainer() : null);
  }
  renderContent() {
    var _a2;
    const e2 = (_a2 = this.viewModel) == null ? void 0 : _a2.content;
    return e2 ? typeof e2 == "string" ? n$1U("div", { class: e$J.contentNode, key: e2, innerHTML: e2 }) : this.renderNodeContent(e2) : null;
  }
  renderActionText(e2) {
    return n$1U("span", { key: "text", class: B$e.actionText }, e2);
  }
  renderActionIcon(e2) {
    const t2 = this._getActionClass(e2), i2 = this._getActionImage(e2), o2 = { [B$e.iconLoading]: e2.active, [B$e.rotating]: e2.active, [B$e.icon]: !!t2, [B$e.actionImage]: !e2.active && !!i2 };
    return t2 && (o2[t2] = !e2.active), n$1U("span", { key: "icon", "aria-hidden": "true", class: this.classes(B$e.icon, o2), styles: this._getIconStyles(i2) });
  }
  renderAction(e2) {
    const { action: t2, type: i2 } = e2, o2 = this._getActionTitle(t2), n2 = { [B$e.action]: t2.type !== "toggle", [B$e.actionToggle]: t2.type === "toggle", [B$e.actionToggleOn]: t2.type === "toggle" && t2.value, [B$e.buttonDisabled]: t2.disabled }, s2 = [this.renderActionIcon(t2), this.renderActionText(o2)], r2 = i2 === "menu-item" ? n$1U("li", { key: t2.uid, role: "menuitem", tabIndex: 0, title: o2, "aria-label": o2, class: this.classes(B$e.button, n2), onkeyup: this._handleActionMenuItemKeyup, bind: this, "data-action-uid": t2.uid, onclick: this._triggerAction, onkeydown: this._triggerAction }, s2) : n$1U("div", { key: t2.uid, role: "button", tabIndex: 0, title: o2, "aria-label": o2, class: this.classes(B$e.button, n2), onkeyup: this._handleActionMenuItemKeyup, bind: this, "data-action-uid": t2.uid, onclick: this._triggerAction, onkeydown: this._triggerAction }, s2);
    return t2.visible ? r2 : null;
  }
  renderFeatureMenuItem(e2, t2) {
    const { messages: i2, messagesCommon: o2 } = this, { selectedFeatureIndex: n2, selectedFeatureViewModel: s2 } = this.viewModel, r2 = e2 === s2, a2 = { [B$e.featureMenuSelected]: r2 }, l2 = r2 ? n$1U("span", { key: R$d(`feature-menu-selected-feature-${n2}`), title: i2.selectedFeature, "aria-label": i2.selectedFeature, class: B$e.iconCheckMark }) : null, c2 = n$1U("span", { innerHTML: e2.title || o2.untitled });
    return n$1U("li", { role: "menuitem", tabIndex: -1, key: R$d(`feature-menu-feature-${n2}`), class: this.classes(a2, B$e.featureMenuItem), bind: this, "data-feature-index": t2, onblur: this._removeActiveFeature, onfocus: this._setActiveFeature, onkeyup: this._handleFeatureMenuItemKeyup, onclick: this._selectFeature, onkeydown: this._selectFeature, onmouseover: this._setActiveFeature, onmouseleave: this._removeActiveFeature }, n$1U("span", { class: B$e.featureMenuTitle }, c2, l2));
  }
  renderFeatureMenu() {
    const { featureMenuId: e2 } = this, { featureViewModels: t2 } = this.viewModel;
    return t2.length > 1 ? n$1U("ol", { class: B$e.featureMenuList, id: e2, bind: this, afterCreate: this._featureMenuNodeUpdated, afterUpdate: this._featureMenuNodeUpdated, onkeyup: this._handleFeatureMenuKeyup, role: "menu" }, t2.filter((e3) => !!e3.graphic).map((e3, t3) => this.renderFeatureMenuItem(e3, t3))) : null;
  }
  _storeExitRelatedRecordsAction(e2, t2) {
    this._exitRelatedRecordsActions.set(e2, t2), this.scheduleRender();
  }
  _getFlowItemDescription(e2) {
    return "featureCountDescription" in e2 ? e2.featureCountDescription : e2.viewModel.description;
  }
  _destroyFlowItemWidgets() {
    this._flowItems.removeAll().forEach((e2) => {
      "showAllEnabled" in e2.viewModel && (e2.viewModel.showAllEnabled = false), e2.viewModel = null, e2.destroy();
    });
  }
  _handleBackClick() {
    const e2 = this._flowItems.pop();
    this._exitRelatedRecordsActions.delete(e2), "showAllEnabled" in e2.viewModel && (e2.viewModel.showAllEnabled = false), e2 && (e2.viewModel = null, e2.destroy());
  }
  _getActionTitle(e2) {
    const { messages: t2, selectedFeature: i2, messagesCommon: o2 } = this, { id: n2 } = e2, s2 = i2 == null ? void 0 : i2.attributes, r2 = n2 === "zoom-to-feature" ? s$1L(e2.title, { messages: t2 }) : n2 === "remove-selected-feature" ? s$1L(e2.title, { messages: o2 }) : n2 === "zoom-to-clustered-features" || n2 === "browse-clustered-features" ? s$1L(e2.title, { messages: t2 }) : e2.title;
    return r2 && s2 ? s$1L(r2, s2) : r2;
  }
  _getActionClass(e2) {
    const { selectedFeature: t2 } = this, i2 = t2 == null ? void 0 : t2.attributes, { className: o2, image: n2 } = e2, s2 = n2 || o2 ? o2 : B$e.iconDefaultAction;
    return s2 && i2 ? s$1L(s2, i2) : s2;
  }
  _getActionImage(e2) {
    const { selectedFeature: t2 } = this, i2 = t2 == null ? void 0 : t2.attributes, { image: o2 } = e2;
    return o2 && i2 ? s$1L(o2, i2) : o2;
  }
  _createFeatureUpdatedAnimation() {
    return w$L("enter", B$e.hasFeatureUpdated);
  }
  _getInlineActionCount() {
    const { maxInlineActions: e2, featureNavigationVisible: t2 } = this;
    if (typeof e2 != "number")
      return null;
    const i2 = Math.round(e2);
    return Math.max(t2 ? i2 - 1 : i2, 0);
  }
  _watchActions() {
    const { allActions: e2 } = this.viewModel;
    this.notifyChange("dividedActions");
    const t2 = "actions";
    this._handles.remove(t2), e2 && e2.forEach((e3) => {
      this._handles.add(l$1P(() => [e3.uid, e3.active, e3.className, e3.disabled, e3.id, e3.title, e3.image, e3.visible], () => this.scheduleRender()), t2);
    });
  }
  _divideActions() {
    const { allActions: e2 } = this.viewModel, i2 = e2.filter((e3) => e3.visible), o2 = this._getInlineActionCount(), n2 = o2 === null, s2 = o2 === 0;
    return { inlineActions: n2 ? i2.slice(0) : s2 ? new j$V() : i2.slice(0, o2), menuActions: n2 ? new j$V() : s2 ? i2.slice(0) : i2.slice(o2) };
  }
  _featureMenuOpenChanged(e2) {
    e2 ? this._focusFirstFeature = true : this._focusFeatureMenuButton = true;
  }
  _actionsMenuOpenChanged(e2) {
    e2 ? this._focusFirstAction = true : this._focusActionsMenuButton = true;
  }
  _setTitleFromFeatureWidget() {
    var _a2, _b2;
    const { selectedFeatureWidget: e2, messagesCommon: t2 } = this;
    e2 && (this.viewModel.title = ((_a2 = e2.viewModel) == null ? void 0 : _a2.state) === "error" ? t2.errorMessage : ((_b2 = e2.viewModel) == null ? void 0 : _b2.title) || "");
  }
  _setContentFromFeatureWidget() {
    const { selectedFeatureWidget: e2 } = this;
    e2 && (this.viewModel.content = e2);
  }
  _unobserveFeatureMenuObserver() {
    this._featureMenuIntersectionObserverNode && this._featureMenuIntersectionObserver.unobserve(this._featureMenuIntersectionObserverNode);
  }
  _featureMenuIntersectionObserverCreated(e2) {
    this._unobserveFeatureMenuObserver(), this._featureMenuIntersectionObserver.observe(e2), this._featureMenuIntersectionObserverNode = e2;
  }
  _handleFeatureMenuKeyup(e2) {
    i$31(e2) === "Escape" && (e2.stopPropagation(), this._focusFeatureMenuButton = true, this.featureMenuOpen = false, this.scheduleRender());
  }
  _handleActionMenuKeyup(e2) {
    i$31(e2) === "Escape" && (e2.stopPropagation(), this._focusActionsMenuButton = true, this.actionsMenuOpen = false, this.scheduleRender());
  }
  _setActiveFeature(e2) {
    const { viewModel: t2 } = this, i2 = e2.currentTarget["data-feature-index"];
    t2.activeFeature = t2.features[i2] || null;
  }
  _removeActiveFeature() {
    this.viewModel.activeFeature = null;
  }
  _handleFeatureMenuItemKeyup(e2) {
    const t2 = i$31(e2), { _featureMenuNode: o2 } = this, n2 = e2.currentTarget["data-feature-index"];
    if (!o2)
      return;
    const s2 = o2.querySelectorAll("li"), r2 = s2.length;
    if (t2 !== "ArrowUp")
      if (t2 !== "ArrowDown")
        if (t2 !== "Home")
          if (t2 !== "End")
            ;
          else {
            e2.stopPropagation();
            s2[s2.length - 1].focus();
          }
        else {
          e2.stopPropagation();
          s2[0].focus();
        }
      else {
        e2.stopPropagation();
        s2[(n2 + 1 + r2) % r2].focus();
      }
    else {
      e2.stopPropagation();
      s2[(n2 - 1 + r2) % r2].focus();
    }
  }
  _handleActionMenuItemKeyup(e2) {
    const t2 = i$31(e2), { _actionsMenuNode: o2 } = this, n2 = e2.currentTarget.dataset.actionUid, { menuActions: s2 } = this.dividedActions, r2 = s2.findIndex((e3) => e3.uid === n2);
    if (!o2)
      return;
    const a2 = o2.querySelectorAll("li"), l2 = a2.length;
    if (t2 !== "ArrowUp")
      if (t2 !== "ArrowDown")
        if (t2 !== "Home")
          if (t2 !== "End")
            ;
          else {
            e2.stopPropagation();
            a2[a2.length - 1].focus();
          }
        else {
          e2.stopPropagation();
          a2[0].focus();
        }
      else {
        e2.stopPropagation();
        a2[(r2 + 1 + l2) % l2].focus();
      }
    else {
      e2.stopPropagation();
      a2[(r2 - 1 + l2) % l2].focus();
    }
  }
  _handleMainKeyup(e2) {
    const t2 = i$31(e2);
    t2 === "ArrowLeft" && (e2.stopPropagation(), this.previous()), t2 === "ArrowRight" && (e2.stopPropagation(), this.next());
  }
  _spinnerEnabledChange(e2) {
    if (this._destroySpinner(), !e2)
      return;
    const t2 = this.get("viewModel.view");
    this._createSpinner(t2);
  }
  _hideSpinner() {
    const { _spinner: e2 } = this;
    e2 && (e2.location = null, e2.hide());
  }
  _displaySpinner() {
    const { _spinner: e2 } = this;
    if (!e2)
      return;
    const { location: t2, waitingForResult: i2 } = this.viewModel;
    i2 ? e2.show({ location: t2 }) : e2.hide();
  }
  _getIconStyles(e2) {
    return { "background-image": e2 ? `url(${e2})` : "" };
  }
  async _shouldFocus(e2) {
    e2.shouldFocus && (await j$I(() => {
      var _a2;
      return ((_a2 = this.viewModel) == null ? void 0 : _a2.active) === true;
    }), this.focus());
  }
  _addSelectedFeatureIndexHandle() {
    const e2 = l$1P(() => {
      var _a2;
      return (_a2 = this.viewModel) == null ? void 0 : _a2.selectedFeatureIndex;
    }, (e3, t2) => this._selectedFeatureIndexUpdated(e3, t2));
    this._handles.add(e2, E$n);
  }
  _selectedFeatureIndexUpdated(e2, t2) {
    const { featureCount: i2 } = this;
    i2 && e2 !== t2 && e2 !== -1 && (this._destroyFlowItemWidgets(), this.actionsMenuOpen = false, this.featureMenuOpen = false, this._mainContainerNode && (this._mainContainerNode.scrollTop = 0), this._rootFlowItemNode && this._rootFlowItemNode.scrollContentTo({ top: 0 }));
  }
  _destroySelectedFeatureWidget() {
    const { _feature: e2 } = this;
    e2 && (e2.viewModel = null, e2 && !e2.destroyed && e2.destroy()), this._feature = null;
  }
  _isScreenLocationWithinView(e2, t2) {
    return e2.x > -1 && e2.y > -1 && e2.x <= t2.width && e2.y <= t2.height;
  }
  _isOutsideView(e2) {
    const { popupHeight: t2, popupWidth: i2, screenLocation: o2, side: n2, view: s2 } = e2;
    if (isNaN(i2) || isNaN(t2) || !s2 || !o2)
      return false;
    const r2 = s2.padding;
    return n2 === "right" && o2.x + i2 / 2 > s2.width - r2.right || (n2 === "left" && o2.x - i2 / 2 < r2.left || (n2 === "top" && o2.y - t2 < r2.top || n2 === "bottom" && o2.y + t2 > s2.height - r2.bottom));
  }
  _calculateAutoAlignment(e2) {
    if (e2 !== "auto")
      return e2;
    const { _pointerOffsetInPx: t2, _containerNode: i2, _mainContainerNode: o2, viewModel: n2 } = this, { screenLocation: r2, view: a2 } = n2;
    if (t$2r(r2) || !a2 || !i2)
      return "top-center";
    if (!this._isScreenLocationWithinView(r2, a2))
      return this._get("currentAlignment") || "top-center";
    function l2(e3) {
      return parseInt(e3.replace(/[^-\d\.]/g, ""), 10);
    }
    const c2 = o2 ? window.getComputedStyle(o2, null) : null, u2 = c2 ? l2(c2.getPropertyValue("max-height")) : 0, d2 = c2 ? l2(c2.getPropertyValue("height")) : 0, { height: p2, width: h2 } = i2.getBoundingClientRect(), g2 = h2 + t2, _2 = Math.max(p2, u2, d2) + t2, m2 = this._isOutsideView({ popupHeight: _2, popupWidth: g2, screenLocation: r2, side: "right", view: a2 }), f2 = this._isOutsideView({ popupHeight: _2, popupWidth: g2, screenLocation: r2, side: "left", view: a2 }), v2 = this._isOutsideView({ popupHeight: _2, popupWidth: g2, screenLocation: r2, side: "top", view: a2 }), b2 = this._isOutsideView({ popupHeight: _2, popupWidth: g2, screenLocation: r2, side: "bottom", view: a2 });
    return f2 ? v2 ? "bottom-right" : "top-right" : m2 ? v2 ? "bottom-left" : "top-left" : v2 ? b2 ? "top-center" : "bottom-center" : "top-center";
  }
  _callCurrentAlignment(e2) {
    return typeof e2 == "function" ? e2.call(this) : e2;
  }
  _getCurrentAlignment() {
    const { alignment: e2, dockEnabled: t2 } = this;
    return t2 || !this.viewModel.active ? null : this._calculatePositionResult(this._calculateAutoAlignment(this._callCurrentAlignment(e2)));
  }
  _setCurrentAlignment() {
    this._set("currentAlignment", this._getCurrentAlignment());
  }
  _setCurrentDockPosition() {
    this._set("currentDockPosition", this._getCurrentDockPosition());
  }
  _calculatePositionResult(e2) {
    const t2 = ["left", "right"];
    return f$1g(this.container) && t2.reverse(), e2.replace(/leading/gi, t2[0]).replace(/trailing/gi, t2[1]);
  }
  _callDockPosition(e2) {
    return typeof e2 == "function" ? e2.call(this) : e2;
  }
  _getDockPosition() {
    var _a2;
    return this._calculatePositionResult(this._calculateAutoDockPosition(this._callDockPosition((_a2 = this.dockOptions) == null ? void 0 : _a2.position)));
  }
  _getCurrentDockPosition() {
    return this.dockEnabled && this.viewModel.active ? this._getDockPosition() : null;
  }
  _wouldDockTo() {
    return this.dockEnabled ? null : this._getDockPosition();
  }
  _calculateAutoDockPosition(e2) {
    var _a2;
    if (e2 !== "auto")
      return e2;
    const t2 = (_a2 = this.viewModel) == null ? void 0 : _a2.view, i2 = f$1g(this.container) ? "top-left" : "top-right";
    if (!t2)
      return i2;
    const o2 = t2.padding || { left: 0, right: 0, top: 0, bottom: 0 }, n2 = t2.width - o2.left - o2.right, { breakpoints: s2 } = t2;
    return s2 && n2 <= s2.xsmall ? "bottom-center" : i2;
  }
  _positionContainer(e2 = this._containerNode) {
    if (e2 && (this._containerNode = e2), !e2)
      return;
    const { screenLocation: t2 } = this.viewModel, { width: i2 } = e2.getBoundingClientRect(), o2 = this._calculatePositionStyle(t2, i2);
    o2 && (e2.style.top = o2.top, e2.style.left = o2.left, e2.style.bottom = o2.bottom, e2.style.right = o2.right);
  }
  _calculateFullWidth(e2) {
    const { currentAlignment: t2, _pointerOffsetInPx: i2 } = this;
    return t2 === "top-left" || t2 === "bottom-left" || t2 === "top-right" || t2 === "bottom-right" ? e2 + i2 : e2;
  }
  _calculateAlignmentPosition(e2, t2, i2, o2) {
    const { currentAlignment: n2, _pointerOffsetInPx: s2 } = this, r2 = o2 / 2, a2 = i2.height - t2, l2 = i2.width - e2, { padding: c2 } = this.view;
    return n2 === "bottom-center" ? { top: t2 + s2 - c2.top, left: e2 - r2 - c2.left } : n2 === "top-left" ? { bottom: a2 + s2 - c2.bottom, right: l2 + s2 - c2.right } : n2 === "bottom-left" ? { top: t2 + s2 - c2.top, right: l2 + s2 - c2.right } : n2 === "top-right" ? { bottom: a2 + s2 - c2.bottom, left: e2 + s2 - c2.left } : n2 === "bottom-right" ? { top: t2 + s2 - c2.top, left: e2 + s2 - c2.left } : n2 === "top-center" ? { bottom: a2 + s2 - c2.bottom, left: e2 - r2 - c2.left } : void 0;
  }
  _calculatePositionStyle(e2, t2) {
    const { dockEnabled: i2, view: o2 } = this;
    if (!o2)
      return;
    if (i2)
      return { left: "", top: "", right: "", bottom: "" };
    if (t$2r(e2) || !t2)
      return;
    const n2 = this._calculateFullWidth(t2), r2 = this._calculateAlignmentPosition(e2.x, e2.y, o2, n2);
    return r2 ? { top: r2.top !== void 0 ? `${r2.top}px` : "auto", left: r2.left !== void 0 ? `${r2.left}px` : "auto", bottom: r2.bottom !== void 0 ? `${r2.bottom}px` : "auto", right: r2.right !== void 0 ? `${r2.right}px` : "auto" } : void 0;
  }
  _viewChange(e2, t2) {
    e2 && t2 && (this.close(), this.clear());
  }
  _viewReadyChange(e2, t2) {
    if (e2) {
      const e3 = this.get("viewModel.view");
      this._wireUpView(e3);
    } else
      t2 && (this.close(), this.clear());
  }
  _wireUpView(e2) {
    if (this._destroySpinner(), !e2)
      return;
    const { spinnerEnabled: t2 } = this;
    t2 && this._createSpinner(e2), this._setDockEnabledForViewSize(this.dockOptions);
  }
  _dockingThresholdCrossed(e2, t2, i2) {
    const [o2, n2] = e2, [s2, r2] = t2, { width: a2, height: l2 } = i2;
    return o2 <= a2 && s2 > a2 || o2 > a2 && s2 <= a2 || n2 <= l2 && r2 > l2 || n2 > l2 && r2 <= l2;
  }
  _updateDockEnabledForViewSize(e2, t2) {
    if (!e2 || !t2)
      return;
    const i2 = this.get("viewModel.view.padding") || { left: 0, right: 0, top: 0, bottom: 0 }, o2 = i2.left + i2.right, n2 = i2.top + i2.bottom, s2 = [], r2 = [];
    s2[0] = e2[0] - o2, s2[1] = e2[1] - n2, r2[0] = t2[0] - o2, r2[1] = t2[1] - n2;
    const { dockOptions: a2 } = this, l2 = a2.breakpoint;
    this._dockingThresholdCrossed(s2, r2, l2) && this._setDockEnabledForViewSize(a2), this._setCurrentDockPosition();
  }
  _focusDockButtonNode(e2) {
    this._focusDockButton && (this._focusDockButton = false, e2.focus());
  }
  _closeButtonNodeUpdated(e2) {
    return this._focusClose ? (this._focusClose = false, void e2.focus()) : this._blurClose ? (this._blurClose = false, void e2.blur()) : void 0;
  }
  _mainContainerNodeUpdated(e2) {
    return this._mainContainerNode = e2, this._focusContainer ? (this._focusContainer = false, void e2.focus()) : this._blurContainer ? (this._blurContainer = false, void e2.blur()) : void 0;
  }
  _featureMenuNodeUpdated(e2) {
    if (this._featureMenuNode = e2, !e2 || !this._focusFirstFeature)
      return;
    this._focusFirstFeature = false;
    const t2 = e2.querySelectorAll("li");
    if (t2.length) {
      t2[0].focus();
    }
  }
  _actionsMenuNodeUpdated(e2) {
    if (this._actionsMenuNode = e2, !e2 || !this._focusFirstAction)
      return;
    this._focusFirstAction = false;
    const t2 = e2.querySelectorAll("li");
    if (t2.length) {
      t2[0].focus();
    }
  }
  _focusFeatureMenuButtonNode(e2) {
    this._focusFeatureMenuButton && (this._focusFeatureMenuButton = false, e2.focus());
  }
  _focusActionsMenuButtonNode(e2) {
    this._focusActionsMenuButton && (this._focusActionsMenuButton = false, e2.focus());
  }
  _featureMenuViewportScrollTop() {
    this._featureMenuViewportNode && (this._featureMenuViewportNode.scrollTop = 0);
  }
  _toggleScreenLocationEnabled() {
    const { dockEnabled: e2, viewModel: t2 } = this;
    if (!t2)
      return;
    const i2 = t2.active && !e2;
    t2.screenLocationEnabled = i2;
  }
  _shouldDockAtCurrentViewSize(e2) {
    var _a2, _b2;
    const t2 = e2.breakpoint, i2 = (_b2 = (_a2 = this.viewModel) == null ? void 0 : _a2.view) == null ? void 0 : _b2.ui;
    if (!i2)
      return false;
    const { width: o2, height: n2 } = i2;
    if (isNaN(o2) || isNaN(n2))
      return false;
    const s2 = t2.hasOwnProperty("width") && o2 <= t2.width, r2 = t2.hasOwnProperty("height") && n2 <= t2.height;
    return s2 || r2;
  }
  _setDockEnabledForViewSize(e2) {
    e2.breakpoint && (this.dockEnabled = this._shouldDockAtCurrentViewSize(e2));
  }
  _getPageText(e2, t2) {
    return this.featureNavigationVisible ? s$1L(this.messages.pageText, { index: t2 + 1, total: e2 }) : null;
  }
  _destroySpinner() {
    const { _spinner: e2, view: t2 } = this;
    e2 && (t2 && t2.ui && t2.ui.remove(this._spinner, D$d), e2.destroy(), this._spinner = null);
  }
  _createSpinner(e2) {
    e2 && (this._spinner = new h$H({ view: e2 }), e2.ui.add(this._spinner, { key: D$d, position: "manual" }));
  }
  _toggleCollapsed() {
    this.collapsed = !this.collapsed;
  }
  _close() {
    this.close(), this.view && this.view.focus();
  }
  _toggleDockEnabled() {
    this.dockEnabled = !this.dockEnabled, this._focusDockButton = true, this.scheduleRender();
  }
  _toggleFeatureMenu() {
    const e2 = !this.featureMenuOpen;
    this._featureMenuOpenChanged(e2), this.actionsMenuOpen = false, this.featureMenuOpen = e2;
  }
  _toggleActionsMenu() {
    const e2 = !this.actionsMenuOpen;
    this._actionsMenuOpenChanged(e2), this.featureMenuOpen = false, this.actionsMenuOpen = e2;
  }
  _triggerAction(e2) {
    const t2 = e2.currentTarget.dataset.actionUid, { allActions: i2 } = this.viewModel, o2 = i2.findIndex((e3) => e3.uid === t2), n2 = i2.getItemAt(o2);
    n2 && n2.type === "toggle" && (n2.value = !n2.value), this.actionsMenuOpen = false, this.viewModel.triggerAction(o2);
  }
  _selectFeature(e2) {
    const t2 = e2.currentTarget["data-feature-index"];
    isNaN(t2) || (this.viewModel.selectedFeatureIndex = t2), this.featureMenuOpen = false, this._focusFeatureMenuButton = true, this.scheduleRender();
  }
  _next() {
    this.next();
  }
  _previous() {
    this.previous();
  }
};
e$2g([y$1I({ readOnly: true })], V$d.prototype, "actionsMenuId", null), e$2g([y$1I({ readOnly: true })], V$d.prototype, "actionsMenuButtonId", null), e$2g([y$1I({ readOnly: true })], V$d.prototype, "featureMenuId", null), e$2g([y$1I({ readOnly: true })], V$d.prototype, "titleId", null), e$2g([y$1I({ readOnly: true })], V$d.prototype, "contentId", null), e$2g([y$1I({ readOnly: true })], V$d.prototype, "hasContent", null), e$2g([y$1I({ readOnly: true })], V$d.prototype, "featureNavigationVisible", null), e$2g([y$1I({ readOnly: true })], V$d.prototype, "collapsible", null), e$2g([y$1I({ readOnly: true })], V$d.prototype, "featureMenuVisible", null), e$2g([y$1I({ readOnly: true })], V$d.prototype, "contentCollapsed", null), e$2g([y$1I({ readOnly: true })], V$d.prototype, "dividedActions", null), e$2g([y$1I({ readOnly: true, dependsOn: ["_flowItems.length"] })], V$d.prototype, "_activeFlowItemWidget", null), e$2g([y$1I()], V$d.prototype, "actions", null), e$2g([y$1I()], V$d.prototype, "actionsMenuOpen", null), e$2g([y$1I()], V$d.prototype, "alignment", void 0), e$2g([y$1I()], V$d.prototype, "autoCloseEnabled", null), e$2g([y$1I()], V$d.prototype, "autoOpenEnabled", null), e$2g([y$1I()], V$d.prototype, "defaultPopupTemplateEnabled", null), e$2g([y$1I()], V$d.prototype, "content", null), e$2g([y$1I()], V$d.prototype, "collapsed", void 0), e$2g([y$1I()], V$d.prototype, "collapseEnabled", void 0), e$2g([y$1I({ readOnly: true })], V$d.prototype, "currentAlignment", null), e$2g([y$1I({ readOnly: true })], V$d.prototype, "currentDockPosition", null), e$2g([y$1I()], V$d.prototype, "dockOptions", null), e$2g([y$1I()], V$d.prototype, "dockEnabled", void 0), e$2g([y$1I({ readOnly: true })], V$d.prototype, "featureCount", null), e$2g([y$1I()], V$d.prototype, "featureMenuOpen", void 0), e$2g([y$1I()], V$d.prototype, "features", null), e$2g([y$1I()], V$d.prototype, "goToOverride", null), e$2g([y$1I()], V$d.prototype, "headingLevel", void 0), e$2g([y$1I()], V$d.prototype, "highlightEnabled", null), e$2g([y$1I()], V$d.prototype, "location", null), e$2g([y$1I()], V$d.prototype, "label", null), e$2g([y$1I()], V$d.prototype, "maxInlineActions", void 0), e$2g([y$1I(), e$1g("esri/widgets/Popup/t9n/Popup")], V$d.prototype, "messages", void 0), e$2g([y$1I(), e$1g("esri/t9n/common")], V$d.prototype, "messagesCommon", void 0), e$2g([y$1I()], V$d.prototype, "promises", null), e$2g([y$1I({ readOnly: true })], V$d.prototype, "selectedFeature", null), e$2g([y$1I()], V$d.prototype, "selectedFeatureIndex", null), e$2g([y$1I({ readOnly: true })], V$d.prototype, "selectedFeatureWidget", null), e$2g([y$1I()], V$d.prototype, "spinnerEnabled", void 0), e$2g([y$1I()], V$d.prototype, "title", null), e$2g([y$1I()], V$d.prototype, "updateLocationEnabled", null), e$2g([y$1I()], V$d.prototype, "view", null), e$2g([y$1I({ type: H$a }), e$1d(["triggerAction", "trigger-action"])], V$d.prototype, "viewModel", void 0), e$2g([y$1I()], V$d.prototype, "visible", null), e$2g([y$1I()], V$d.prototype, "visibleElements", void 0), e$2g([s$2i("visibleElements")], V$d.prototype, "castVisibleElements", null), e$2g([t$1p()], V$d.prototype, "_close", null), e$2g([t$1p()], V$d.prototype, "_toggleDockEnabled", null), e$2g([t$1p()], V$d.prototype, "_toggleFeatureMenu", null), e$2g([t$1p()], V$d.prototype, "_toggleActionsMenu", null), e$2g([t$1p()], V$d.prototype, "_triggerAction", null), e$2g([t$1p()], V$d.prototype, "_selectFeature", null), e$2g([t$1p()], V$d.prototype, "_next", null), e$2g([t$1p()], V$d.prototype, "_previous", null), V$d = e$2g([n$2P("esri.widgets.Popup")], V$d);
const U$d = V$d;
const m$X = [0, 0];
function f$C(e2) {
  var _a2, _b2;
  const t2 = (e2.ownerDocument || window.document).defaultView, s2 = e2.getBoundingClientRect();
  return m$X[0] = s2.left + ((_a2 = t2 == null ? void 0 : t2.pageXOffset) != null ? _a2 : 0), m$X[1] = s2.top + ((_b2 = t2 == null ? void 0 : t2.pageYOffset) != null ? _b2 : 0), m$X;
}
function y$r(e2) {
  e2 && (t$1y(e2), e2.parentNode && e2.parentNode.removeChild(e2));
}
function v$p(e2) {
  const t2 = document.createElement("div");
  return e2.appendChild(t2), t2;
}
const _$m = 16, g$p = 750, w$j = 512, C$j = 2, z$k = (i2) => {
  let m2 = class extends i2 {
    constructor(...e2) {
      var _a2;
      super(...e2), this._freqInfo = { freq: _$m, time: g$p }, this._overlayRenderTaskHandle = null, this.height = 0, this.overlay = null, this.position = null, this.resizing = false, this.root = null, this.surface = null, this.suspended = true, this.ui = null, this.userContent = null, this.width = 0, this.widthBreakpoint = null, e2.length !== 0 && ((_a2 = e2[0]) == null ? void 0 : _a2.popup) !== void 0 || (this.popup = new U$d({ view: this })), this.handles.add([l$1P(() => this.cursor, (e3) => {
        const { surface: t2 } = this;
        t2 && t2.setAttribute("data-cursor", e3);
      }), l$1P(() => this.interacting, (e3) => {
        const { surface: t2 } = this;
        t2 && t2.setAttribute("data-interacting", e3.toString());
      })]);
    }
    initialize() {
      this.handles.add(l$1P(() => this.ui, (e2, t2) => this._handleUIChange(e2, t2))), this._wireUI(this.ui), this.handles.add([this.on("focus", () => this.notifyChange("focused")), this.on("blur", () => this.notifyChange("focused"))]);
    }
    destroy() {
      this.destroyed || (this.ui = s$2D(this.ui), this.popup && !this.popup.destroyed && this.popup.destroy(), this.container = null);
    }
    get container() {
      var _a2;
      return (_a2 = this._get("container")) != null ? _a2 : null;
    }
    set container(e2) {
      const i3 = this._get("container"), r2 = e$1p(e2), l2 = r2 instanceof HTMLDivElement ? r2 : null;
      if (l2 || typeof e2 != "string" || s$2z.getLogger(this.declaredClass).error("#container", `element with id '${e2}' not found`), i3 === l2)
        return;
      const u2 = "dom-size";
      if (this.handles.remove(u2), this._stopMeasuring(), i3 && (i3.classList.remove("esri-view"), this._overlayRenderTaskHandle && (this._overlayRenderTaskHandle.remove(), this._overlayRenderTaskHandle = null), this.overlay && (this.overlay.destroy(), this._set("overlay", null)), this.root && (y$r(this.root), this._set("root", null)), this.userContent && (r$1k(this.userContent, i3), y$r(this.userContent), this._set("userContent", null))), !l2)
        return this._set("width", 0), this._set("height", 0), this._set("position", null), this._set("suspended", true), this._set("surface", null), void this._set("container", null);
      l2.classList.add("esri-view");
      const c2 = document.createElement("div");
      c2.className = "esri-view-user-storage", r$1k(l2, c2), l2.appendChild(c2), this._set("userContent", c2);
      const m3 = document.createElement("div");
      m3.className = "esri-view-root", l2.insertBefore(m3, l2.firstChild), this._set("root", m3);
      const f2 = document.createElement("div");
      f2.className = "esri-view-surface", f2.setAttribute("role", "application"), f2.tabIndex = 0, m3.appendChild(f2), this._set("surface", f2);
      const v2 = new c$28();
      m3.appendChild(v2.surface), this._set("overlay", v2), l$1P(() => v2.needsRender, (e3) => {
        e3 && !this._overlayRenderTaskHandle ? this._overlayRenderTaskHandle = A$A({ render: () => {
          var _a2;
          return (_a2 = this.overlay) == null ? void 0 : _a2.render();
        } }) : this._overlayRenderTaskHandle = h$1W(this._overlayRenderTaskHandle);
      }), this.forceDOMReadyCycle(), this.handles.add(l$1P(() => this.size, (e3) => {
        const [t2, s2] = e3, i4 = "esri-view-surface--inset-outline";
        t2 >= document.body.clientWidth || s2 >= document.body.clientHeight ? f2.classList.add(i4) : f2.classList.remove(i4);
      }, h$1j), u2), this._set("container", l2), this._startMeasuring();
    }
    get focused() {
      const e2 = document.activeElement === this.surface;
      return document.hasFocus() && e2;
    }
    set popup(e2) {
      const t2 = this._get("popup");
      t2 && t2 !== e2 && t2.destroy(), this._set("popup", e2);
    }
    get size() {
      return [this.width, this.height];
    }
    blur() {
      this.surface && this.surface.blur();
    }
    focus() {
      this.surface && this.surface.focus();
    }
    pageToContainer(e2, t2, s2) {
      const i3 = this.position;
      return e2 -= i3 ? i3[0] : 0, t2 -= i3 ? i3[1] : 0, s2 ? (s2[0] = e2, s2[1] = t2) : s2 = [e2, t2], s2;
    }
    containerToPage(e2, t2, s2) {
      const i3 = this.position;
      return e2 += i3 ? i3[0] : 0, t2 += i3 ? i3[1] : 0, s2 ? (s2[0] = e2, s2[1] = t2) : s2 = [e2, t2], s2;
    }
    _handleUIChange(e2, t2) {
      t2 && (this.handles.remove("ui"), t2.destroy()), e2 && this._wireUI(e2), this._set("ui", e2);
    }
    _wireUI(e2) {
      this.handles.remove("ui"), e2 && (e2.view = this, this.handles.add([l$1P(() => this.root, (t2) => {
        e2.container = t2 ? v$p(t2) : null;
      }, h$1j), l$1P(() => this.popup, (t2, s2) => {
        const i3 = "popup", o2 = "manual";
        s2 && e2.remove(s2, i3), t2 && (t2.view = e2.view, e2.add(t2, { key: i3, position: o2 }));
      }, h$1j)], "ui"));
    }
    _stopMeasuring() {
      this.handles.remove("measuring"), this._get("resizing") && this._set("resizing", false);
    }
    _startMeasuring() {
      const e2 = this._freqInfo;
      e2.freq = _$m, e2.time = g$p, this.handles.add([(() => {
        const t2 = () => {
          e2.freq = _$m, e2.time = g$p;
        };
        return window.addEventListener("resize", t2), { remove() {
          window.removeEventListener("resize", t2);
        } };
      })(), A$A({ prepare: (e3) => {
        const t2 = this._measure(), s2 = this._freqInfo;
        if (s2.time += e3.deltaTime, t2 && (s2.freq = _$m, this._get("resizing") || this._set("resizing", true)), s2.time < s2.freq)
          return;
        s2.time = 0;
        const i3 = this._position();
        s2.freq = i3 || t2 ? _$m : Math.min(g$p, s2.freq * C$j), !t2 && s2.freq >= w$j && this._get("resizing") && this._set("resizing", false);
      } })], "measuring"), this._measure(), this._position();
    }
    _measure() {
      const e2 = this.container, t2 = e2 ? e2.clientWidth : 0, s2 = e2 ? e2.clientHeight : 0;
      if (t2 === 0 || s2 === 0)
        return this.suspended || this._set("suspended", true), false;
      const i3 = this.width, o2 = this.height;
      return t2 === i3 && s2 === o2 ? (this.suspended && this._set("suspended", false), false) : (this._set("width", t2), this._set("height", s2), this.suspended && this._set("suspended", false), this.emit("resize", { oldWidth: i3, oldHeight: o2, width: t2, height: s2 }), true);
    }
    _position() {
      const e2 = this.container, t2 = this.position, s2 = e2 && f$C(e2);
      return !!s2 && ((!t2 || s2[0] !== t2[0] || s2[1] !== t2[1]) && (this._set("position", [s2[0], s2[1]]), true));
    }
    forceDOMReadyCycle() {
    }
  };
  return e$2g([y$1I()], m2.prototype, "container", null), e$2g([y$1I({ readOnly: true })], m2.prototype, "focused", null), e$2g([y$1I({ readOnly: true })], m2.prototype, "height", void 0), e$2g([y$1I({ type: U$d })], m2.prototype, "popup", null), e$2g([y$1I({ type: c$28 })], m2.prototype, "overlay", void 0), e$2g([y$1I({ readOnly: true })], m2.prototype, "position", void 0), e$2g([y$1I({ readOnly: true })], m2.prototype, "resizing", void 0), e$2g([y$1I({ readOnly: true })], m2.prototype, "root", void 0), e$2g([y$1I({ value: null, readOnly: true })], m2.prototype, "size", null), e$2g([y$1I({ readOnly: true })], m2.prototype, "surface", void 0), e$2g([y$1I({ readOnly: true })], m2.prototype, "suspended", void 0), e$2g([y$1I()], m2.prototype, "ui", void 0), e$2g([y$1I({ readOnly: true })], m2.prototype, "userContent", void 0), e$2g([y$1I({ readOnly: true })], m2.prototype, "width", void 0), e$2g([y$1I()], m2.prototype, "widthBreakpoint", void 0), m2 = e$2g([n$2P("esri.views.DOMContainer")], m2), m2;
};
const a$11 = (a2) => {
  let p2 = class extends a2 {
    async fetchPopupFeatures(e2, r2) {
      await this.when();
      const { location: i2, queryArea: a3, layerViewsAndGraphics: p3, clientOnlyGraphics: t2 } = await this._prepareFetchPopupFeatures(e2, r2), o2 = Promise.resolve(t2), c2 = this._queryLayerPopupFeatures(a3, p3, r2), n2 = c2.map((e3) => e3.promise);
      return { location: i2, clientOnlyGraphics: t2, allGraphicsPromise: L$z([o2, ...n2]).then((e3) => Array.from(new Set(e3.flat()))), promisesPerLayerView: c2 };
    }
    _queryLayerPopupFeatures(e2, s2, i2) {
      return s2.map(({ layerView: s3, graphics: a3 }) => {
        const p3 = { clientGraphics: a3, event: r$1$(i2) ? i2.event : null, signal: r$1$(i2) ? i2.signal : null, defaultPopupTemplateEnabled: !!r$1$(i2) && !!i2.defaultPopupTemplateEnabled }, t2 = s3.fetchPopupFeatures(e2, p3);
        return { layerView: s3, promise: t2 };
      });
    }
    _isValidPopupGraphic(e2, s2) {
      return e2 && !!e2.getEffectivePopupTemplate(r$1$(s2) && s2.defaultPopupTemplateEnabled);
    }
    async _prepareFetchPopupFeatures(e2, r2) {
      const { clientGraphics: s2, queryArea: i2, location: a3 } = await this._popupHitTestGraphics(e2, r2), p3 = this._getFetchPopupLayerViews(), { layerViewsAndGraphics: t2, clientOnlyGraphics: o2 } = this._graphicsPerFetchPopupLayerView(s2, p3);
      return { clientOnlyGraphics: o2, layerViewsAndGraphics: t2, queryArea: i2, location: a3 };
    }
    async _popupHitTestGraphics(e2, r2) {
      const { results: s2, mapPoint: i2 } = await this.popupHitTest(e2), a3 = s2.filter((e3) => e3.type === "graphic" && this._isValidPopupGraphic(e3.graphic, r2)), p3 = a3.length ? a3[0].mapPoint : null;
      return { clientGraphics: a3.map((e3) => e3.graphic), queryArea: i2, location: i2 || p3 };
    }
    _getFetchPopupLayerViews() {
      const e2 = [];
      return this.allLayerViews.forEach((r2) => {
        this._isValidPopupLayerView(r2) && e2.push(r2);
      }), r$1$(this.graphicsView) && this._isValidPopupLayerView(this.graphicsView) && e2.push(this.graphicsView), e2.reverse();
    }
    _isValidPopupLayerView(e2) {
      return r$1$(e2) && (!("layer" in e2) || !e2.suspended) && "fetchPopupFeatures" in e2;
    }
    _graphicsPerFetchPopupLayerView(e2, r2) {
      const s2 = [], i2 = new Map(), a3 = r2.map((e3) => {
        const r3 = [];
        return "layer" in e3 ? i2.set(e3.layer, r3) : i2.set(e3.graphics, r3), { layerView: e3, graphics: r3 };
      });
      for (const p3 of e2) {
        const e3 = i2.get(p3.layer) || i2.get(p3.sourceLayer) || null;
        e3 ? e3.push(p3) : s2.push(p3);
      }
      return { layerViewsAndGraphics: a3, clientOnlyGraphics: s2 };
    }
  };
  return p2 = e$2g([n$2P("esri.views.PopupView")], p2), p2;
};
async function n$10(o2, r2) {
  return await o2.load(), i$18(o2, r2);
}
async function i$18(n2, i2) {
  const c2 = [], f2 = (...o2) => {
    for (const r2 of o2)
      t$2r(r2) || (Array.isArray(r2) ? f2(...r2) : j$V.isCollection(r2) ? r2.forEach((o3) => f2(o3)) : m$1X.isLoadable(r2) && c2.push(r2));
  };
  i2(f2);
  let e2 = null;
  if (await h$17(c2, async (o2) => {
    (await b$N(s$R(o2) ? o2.loadAll() : o2.load())).ok !== false || e2 || (e2 = o2);
  }), e2)
    throw e2.loadError;
  return n2;
}
function s$R(o2) {
  return "loadAll" in o2 && typeof o2.loadAll == "function";
}
async function a$10(e2) {
  if (!e2)
    return;
  const a2 = e2.includes("-vector") ? e2.slice(0, e2.indexOf("-vector")) : e2, s2 = await u$1u("esri/t9n/basemaps");
  return s2[e2] || s2[a2];
}
const s$Q = { streets: { id: "streets", classic: true, deprecated: true, get thumbnailUrl() {
  return a$28("esri/images/basemap/streets.jpg");
}, baseMapLayers: [{ id: "streets-base-layer", url: "//services.arcgisonline.com/ArcGIS/rest/services/World_Street_Map/MapServer", layerType: "ArcGISTiledMapServiceLayer", title: "World Street Map", showLegend: false, visibility: true, opacity: 1 }] }, satellite: { id: "satellite", classic: true, get thumbnailUrl() {
  return a$28("esri/images/basemap/satellite.jpg");
}, baseMapLayers: [{ id: "satellite-base-layer", url: "//services.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer", layerType: "ArcGISTiledMapServiceLayer", title: "World Imagery", showLegend: false, visibility: true, opacity: 1 }] }, hybrid: { id: "hybrid", classic: true, get thumbnailUrl() {
  return a$28("esri/images/basemap/hybrid.jpg");
}, baseMapLayers: [{ id: "hybrid-base-layer", url: "//services.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer", layerType: "ArcGISTiledMapServiceLayer", title: "World Imagery", showLegend: false, visibility: true, opacity: 1 }, { id: "hybrid-reference-layer", styleUrl: "https://cdn.arcgis.com/sharing/rest/content/items/30d6b8271e1849cd9c3042060001f425/resources/styles/root.json", layerType: "VectorTileLayer", title: "Hybrid Reference Layer", isReference: true, showLegend: false, visibility: true, opacity: 1 }] }, terrain: { id: "terrain", classic: true, get thumbnailUrl() {
  return a$28("esri/images/basemap/terrain.jpg");
}, baseMapLayers: [{ id: "terrain-base-layer", url: "//services.arcgisonline.com/ArcGIS/rest/services/World_Terrain_Base/MapServer", layerType: "ArcGISTiledMapServiceLayer", title: "World Terrain Base", showLegend: false, visibility: true, opacity: 1 }, { id: "terrain-reference-layer", url: "//services.arcgisonline.com/ArcGIS/rest/services/Reference/World_Reference_Overlay/MapServer", layerType: "ArcGISTiledMapServiceLayer", title: "World Reference Overlay", isReference: true, showLegend: false, visibility: true, opacity: 1 }] }, topo: { id: "topo", classic: true, deprecated: true, get thumbnailUrl() {
  return a$28("esri/images/basemap/topo.jpg");
}, baseMapLayers: [{ id: "topo-base-layer", url: "//services.arcgisonline.com/ArcGIS/rest/services/World_Topo_Map/MapServer", layerType: "ArcGISTiledMapServiceLayer", title: "World Topo Map", showLegend: false, visibility: true, opacity: 1 }] }, gray: { id: "gray", classic: true, deprecated: true, get thumbnailUrl() {
  return a$28("esri/images/basemap/gray.jpg");
}, baseMapLayers: [{ id: "gray-base-layer", url: "//services.arcgisonline.com/ArcGIS/rest/services/Canvas/World_Light_Gray_Base/MapServer", layerType: "ArcGISTiledMapServiceLayer", title: "World Light Gray Base", showLegend: false, visibility: true, opacity: 1 }, { id: "gray-reference-layer", url: "//services.arcgisonline.com/ArcGIS/rest/services/Canvas/World_Light_Gray_Reference/MapServer", layerType: "ArcGISTiledMapServiceLayer", title: "World Light Gray Reference", isReference: true, showLegend: false, visibility: true, opacity: 1 }] }, "dark-gray": { id: "dark-gray", classic: true, deprecated: true, get thumbnailUrl() {
  return a$28("esri/images/basemap/dark-gray.jpg");
}, baseMapLayers: [{ id: "dark-gray-base-layer", url: "//services.arcgisonline.com/ArcGIS/rest/services/Canvas/World_Dark_Gray_Base/MapServer", layerType: "ArcGISTiledMapServiceLayer", title: "World Dark Gray Base", showLegend: false, visibility: true, opacity: 1 }, { id: "dark-gray-reference-layer", url: "//services.arcgisonline.com/ArcGIS/rest/services/Canvas/World_Dark_Gray_Reference/MapServer", layerType: "ArcGISTiledMapServiceLayer", title: "World Dark Gray Reference", isReference: true, showLegend: false, visibility: true, opacity: 1 }] }, oceans: { id: "oceans", classic: true, get thumbnailUrl() {
  return a$28("esri/images/basemap/oceans.jpg");
}, baseMapLayers: [{ id: "oceans-base-layer", url: "//services.arcgisonline.com/arcgis/rest/services/Ocean/World_Ocean_Base/MapServer", layerType: "ArcGISTiledMapServiceLayer", title: "World Ocean Base", showLegend: false, visibility: true, opacity: 1 }, { id: "oceans-reference-layer", url: "//services.arcgisonline.com/arcgis/rest/services/Ocean/World_Ocean_Reference/MapServer", layerType: "ArcGISTiledMapServiceLayer", title: "World Ocean Reference", isReference: true, showLegend: false, visibility: true, opacity: 1 }] }, "national-geographic": { id: "national-geographic", classic: true, deprecated: true, get thumbnailUrl() {
  return a$28("esri/images/basemap/national-geographic.jpg");
}, baseMapLayers: [{ id: "national-geographic-base-layer", url: "//services.arcgisonline.com/ArcGIS/rest/services/NatGeo_World_Map/MapServer", title: "NatGeo World Map", showLegend: false, layerType: "ArcGISTiledMapServiceLayer", visibility: true, opacity: 1 }] }, osm: { id: "osm", classic: true, get thumbnailUrl() {
  return a$28("esri/images/basemap/osm.jpg");
}, baseMapLayers: [{ id: "osm-base-layer", layerType: "OpenStreetMap", title: "Open Street Map", showLegend: false, visibility: true, opacity: 1 }] }, "dark-gray-vector": { id: "dark-gray-vector", classic: true, get thumbnailUrl() {
  return a$28("esri/images/basemap/dark-gray-vector.jpg");
}, baseMapLayers: [{ id: "dark-gray-base-layer", styleUrl: "https://cdn.arcgis.com/sharing/rest/content/items/5e9b3685f4c24d8781073dd928ebda50/resources/styles/root.json", layerType: "VectorTileLayer", title: "Dark Gray Base", visibility: true, opacity: 1 }, { id: "dark-gray-reference-layer", styleUrl: "https://cdn.arcgis.com/sharing/rest/content/items/747cb7a5329c478cbe6981076cc879c5/resources/styles/root.json", layerType: "VectorTileLayer", title: "Dark Gray Reference", isReference: true, visibility: true, opacity: 1 }] }, "gray-vector": { id: "gray-vector", classic: true, get thumbnailUrl() {
  return a$28("esri/images/basemap/gray-vector.jpg");
}, baseMapLayers: [{ id: "gray-base-layer", styleUrl: "https://cdn.arcgis.com/sharing/rest/content/items/291da5eab3a0412593b66d384379f89f/resources/styles/root.json", layerType: "VectorTileLayer", title: "Light Gray Base", visibility: true, opacity: 1 }, { id: "gray-reference-layer", styleUrl: "https://cdn.arcgis.com/sharing/rest/content/items/1768e8369a214dfab4e2167d5c5f2454/resources/styles/root.json", layerType: "VectorTileLayer", title: "Light Gray Reference", isReference: true, visibility: true, opacity: 1 }] }, "streets-vector": { id: "streets-vector", classic: true, get thumbnailUrl() {
  return a$28("esri/images/basemap/streets-vector.jpg");
}, baseMapLayers: [{ id: "streets-vector-base-layer", styleUrl: "//cdn.arcgis.com/sharing/rest/content/items/de26a3cf4cc9451298ea173c4b324736/resources/styles/root.json", layerType: "VectorTileLayer", title: "World Streets", visibility: true, opacity: 1 }] }, "topo-vector": { id: "topo-vector", classic: true, get thumbnailUrl() {
  return a$28("esri/images/basemap/topo-vector.jpg");
}, baseMapLayers: [{ id: "world-hillshade-layer", url: "//services.arcgisonline.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer", layerType: "ArcGISTiledMapServiceLayer", title: "World Hillshade", showLegend: false, visibility: true, opacity: 1 }, { id: "topo-vector-base-layer", styleUrl: "//cdn.arcgis.com/sharing/rest/content/items/7dc6cea0b1764a1f9af2e679f642f0f5/resources/styles/root.json", layerType: "VectorTileLayer", title: "World Topo", visibility: true, opacity: 1 }] }, "streets-night-vector": { id: "streets-night-vector", classic: true, get thumbnailUrl() {
  return a$28("esri/images/basemap/streets-night.jpg");
}, baseMapLayers: [{ id: "streets-night-vector-base-layer", styleUrl: "//cdn.arcgis.com/sharing/rest/content/items/86f556a2d1fd468181855a35e344567f/resources/styles/root.json", layerType: "VectorTileLayer", title: "World Streets Night", visibility: true, opacity: 1 }] }, "streets-relief-vector": { id: "streets-relief-vector", classic: true, get thumbnailUrl() {
  return a$28("esri/images/basemap/streets-relief.jpg");
}, baseMapLayers: [{ id: "world-hillshade-layer", url: "//services.arcgisonline.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer", layerType: "ArcGISTiledMapServiceLayer", title: "World Hillshade", showLegend: false, visibility: true, opacity: 1 }, { id: "streets-relief-vector-base-layer", styleUrl: "//www.arcgis.com/sharing/rest/content/items/b266e6d17fc345b498345613930fbd76/resources/styles/root.json", title: "World Streets Relief", layerType: "VectorTileLayer", visibility: true, opacity: 1 }] }, "streets-navigation-vector": { id: "streets-navigation-vector", classic: true, get thumbnailUrl() {
  return a$28("esri/images/basemap/streets-navigation.jpg");
}, baseMapLayers: [{ id: "streets-navigation-vector-base-layer", styleUrl: "//cdn.arcgis.com/sharing/rest/content/items/63c47b7177f946b49902c24129b87252/resources/styles/root.json", layerType: "VectorTileLayer", title: "World Streets Navigation", visibility: true, opacity: 1 }] }, "arcgis-imagery": { get thumbnailUrl() {
  return a$28("esri/images/basemap/hybrid.jpg");
}, title: "Imagery Hybrid", baseMapLayers: [{ layerType: "ArcGISTiledMapServiceLayer", showLegend: false, title: "World Imagery", url: "https://ibasemaps-api.arcgis.com/arcgis/rest/services/World_Imagery/MapServer" }, { layerType: "VectorTileLayer", styleUrl: "https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Imagery:Labels", title: "Hybrid Reference Layer", isReference: true }] }, "arcgis-imagery-standard": { get thumbnailUrl() {
  return a$28("esri/images/basemap/satellite.jpg");
}, title: "Imagery", baseMapLayers: [{ layerType: "ArcGISTiledMapServiceLayer", showLegend: false, title: "World Imagery", url: "https://ibasemaps-api.arcgis.com/arcgis/rest/services/World_Imagery/MapServer" }] }, "arcgis-imagery-labels": { title: "Hybrid [Reference]", baseMapLayers: [{ layerType: "VectorTileLayer", styleUrl: "https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Imagery:Labels", title: "Hybrid Reference Layer", isReference: true }] }, "arcgis-light-gray": { get thumbnailUrl() {
  return a$28("esri/images/basemap/gray-vector.jpg");
}, title: "Light Gray Canvas", baseMapLayers: [{ layerType: "VectorTileLayer", styleUrl: "https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:LightGray:Base", title: "Light Gray Canvas Base" }, { layerType: "VectorTileLayer", styleUrl: "https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:LightGray:Labels", title: "Light Gray Canvas Labels", isReference: true }] }, "arcgis-dark-gray": { get thumbnailUrl() {
  return a$28("esri/images/basemap/dark-gray.jpg");
}, title: "Dark Gray Canvas", baseMapLayers: [{ layerType: "VectorTileLayer", styleUrl: "https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:DarkGray:Base", title: "Dark Gray Canvas Base" }, { layerType: "VectorTileLayer", styleUrl: "https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:DarkGray:Labels", title: "Dark Gray Canvas Labels", isReference: true }] }, "arcgis-navigation": { get thumbnailUrl() {
  return a$28("esri/images/basemap/streets-navigation.jpg");
}, title: "Navigation", baseMapLayers: [{ layerType: "VectorTileLayer", styleUrl: "https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Navigation", title: "World Navigation Map" }] }, "arcgis-navigation-night": { title: "Navigation (Dark Mode)", baseMapLayers: [{ layerType: "VectorTileLayer", styleUrl: "https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:NavigationNight", title: "World Navigation Map (Dark Mode)" }] }, "arcgis-streets": { get thumbnailUrl() {
  return a$28("esri/images/basemap/streets-vector.jpg");
}, title: "Streets", baseMapLayers: [{ layerType: "VectorTileLayer", styleUrl: "https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Streets", title: "World Street Map" }] }, "arcgis-streets-night": { get thumbnailUrl() {
  return a$28("esri/images/basemap/streets-night.jpg");
}, title: "Streets (Night)", baseMapLayers: [{ layerType: "VectorTileLayer", styleUrl: "https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:StreetsNight", title: "World Street Map (Night)" }] }, "arcgis-streets-relief": { get thumbnailUrl() {
  return a$28("esri/images/basemap/streets-relief.jpg");
}, title: "Streets (with Relief)", baseMapLayers: [{ layerType: "ArcGISTiledMapServiceLayer", showLegend: false, title: "World Hillshade", url: "https://ibasemaps-api.arcgis.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer" }, { layerType: "VectorTileLayer", styleUrl: "https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:StreetsRelief:Base", title: "World Street Map (with Relief)" }] }, "arcgis-topographic": { get thumbnailUrl() {
  return a$28("esri/images/basemap/topo.jpg");
}, title: "Topographic", baseMapLayers: [{ layerType: "ArcGISTiledMapServiceLayer", showLegend: false, title: "World Hillshade", url: "https://ibasemaps-api.arcgis.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer" }, { layerType: "VectorTileLayer", styleUrl: "https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Topographic:Base", title: "World Topographic Map" }] }, "arcgis-oceans": { get thumbnailUrl() {
  return a$28("esri/images/basemap/oceans.jpg");
}, title: "Oceans", baseMapLayers: [{ layerType: "ArcGISTiledMapServiceLayer", showLegend: false, title: "World Ocean Base", url: "https://ibasemaps-api.arcgis.com/arcgis/rest/services/Ocean/World_Ocean_Base/MapServer" }, { layerType: "VectorTileLayer", styleUrl: "https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Oceans:Labels", title: "World Ocean Reference", isReference: true }] }, "osm-standard": { title: "OpenStreetMap", baseMapLayers: [{ layerType: "VectorTileLayer", styleUrl: "https://basemaps-api.arcgis.com/arcgis/rest/services/styles/OSM:Standard", title: "OpenStreetMap" }] }, "osm-standard-relief": { title: "OpenStreetMap (with relief)", baseMapLayers: [{ layerType: "ArcGISTiledMapServiceLayer", showLegend: false, title: "World Hillshade", url: "https://ibasemaps-api.arcgis.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer" }, { styleUrl: "https://basemaps-api.arcgis.com/arcgis/rest/services/styles/OSM:StandardRelief:Base", layerType: "VectorTileLayer", title: "OpenStreetMap Relief Base" }] }, "osm-streets": { title: "OpenStreetMap (Streets)", baseMapLayers: [{ layerType: "VectorTileLayer", styleUrl: "https://basemaps-api.arcgis.com/arcgis/rest/services/styles/OSM:Streets", title: "OpenStreetMap (Streets)" }] }, "osm-streets-relief": { title: "OpenStreetMap (Streets with relief)", baseMapLayers: [{ layerType: "ArcGISTiledMapServiceLayer", showLegend: false, title: "World Hillshade", url: "https://ibasemaps-api.arcgis.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer" }, { styleUrl: "https://basemaps-api.arcgis.com/arcgis/rest/services/styles/OSM:StreetsRelief:Base", layerType: "VectorTileLayer", title: "OpenStreetMap Relief Base" }] }, "osm-light-gray": { title: "OpenStreetMap (Light Gray Canvas)", baseMapLayers: [{ layerType: "VectorTileLayer", styleUrl: "https://basemaps-api.arcgis.com/arcgis/rest/services/styles/OSM:LightGray:Base", title: "OSM (Light Gray Base)" }, { layerType: "VectorTileLayer", styleUrl: "https://basemaps-api.arcgis.com/arcgis/rest/services/styles/OSM:LightGray:Labels", title: "OSM (Light Gray Reference)", isReference: true }] }, "osm-dark-gray": { title: "OpenStreetMap (Dark Gray Canvas)", baseMapLayers: [{ layerType: "VectorTileLayer", styleUrl: "https://basemaps-api.arcgis.com/arcgis/rest/services/styles/OSM:DarkGray:Base", title: "OSM (Dark Gray Base)" }, { layerType: "VectorTileLayer", styleUrl: "https://basemaps-api.arcgis.com/arcgis/rest/services/styles/OSM:DarkGray:Labels", title: "OSM (Dark Gray Reference)", isReference: true }] }, "arcgis-terrain": { title: "Terrain with Labels", baseMapLayers: [{ layerType: "ArcGISTiledMapServiceLayer", showLegend: false, title: "World Hillshade", url: "https://ibasemaps-api.arcgis.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer" }, { layerType: "VectorTileLayer", styleUrl: "https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Terrain:Base", title: "World Terrain Base" }, { layerType: "VectorTileLayer", styleUrl: "https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Terrain:Detail", title: "World Terrain Reference", isReference: true }] }, "arcgis-community": { title: "Community", baseMapLayers: [{ layerType: "VectorTileLayer", styleUrl: "https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Community", title: "Community" }] }, "arcgis-charted-territory": { title: "Charted Territory", baseMapLayers: [{ layerType: "ArcGISTiledMapServiceLayer", showLegend: false, title: "World Hillshade", url: "https://ibasemaps-api.arcgis.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer" }, { layerType: "VectorTileLayer", styleUrl: "https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:ChartedTerritory:Base", title: "Charted Territory" }] }, "arcgis-colored-pencil": { title: "Colored Pencil", baseMapLayers: [{ layerType: "VectorTileLayer", styleUrl: "https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:ColoredPencil", title: "Colored Pencil" }] }, "arcgis-nova": { title: "Nova", baseMapLayers: [{ layerType: "VectorTileLayer", styleUrl: "https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Nova", title: "Nova" }] }, "arcgis-modern-antique": { title: "Modern Antique", baseMapLayers: [{ layerType: "ArcGISTiledMapServiceLayer", showLegend: false, title: "World Hillshade", url: "https://ibasemaps-api.arcgis.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer" }, { layerType: "VectorTileLayer", styleUrl: "https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:ModernAntique:Base", title: "Modern Antique" }] }, "arcgis-midcentury": { title: "Mid-Century", baseMapLayers: [{ layerType: "VectorTileLayer", styleUrl: "https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Midcentury", title: "Mid-Century" }] }, "arcgis-newspaper": { title: "Newspaper", baseMapLayers: [{ layerType: "VectorTileLayer", styleUrl: "https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Newspaper", title: "Newspaper" }] }, "arcgis-hillshade-light": { title: "Hillshade", baseMapLayers: [{ layerType: "ArcGISTiledMapServiceLayer", showLegend: false, title: "World Hillshade", url: "https://ibasemaps-api.arcgis.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer" }] }, "arcgis-hillshade-dark": { title: "Hillshade (Dark)", baseMapLayers: [{ layerType: "ArcGISTiledMapServiceLayer", showLegend: false, title: "World Hillshade (Dark)", url: "https://ibasemaps-api.arcgis.com/arcgis/rest/services/Elevation/World_Hillshade_Dark/MapServer" }] }, "arcgis-human-geography": { title: "Human Geography", baseMapLayers: [{ layerType: "VectorTileLayer", styleUrl: "https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:HumanGeography:Base", title: "Human Geography Base" }, { layerType: "VectorTileLayer", styleUrl: "https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:HumanGeography:Detail", title: "Human Geography Detail", isReference: true }, { layerType: "VectorTileLayer", styleUrl: "https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:HumanGeography:Label", title: "Human Geography Label", isReference: true }] }, "arcgis-human-geography-dark": { title: "Human Geography (Dark)", baseMapLayers: [{ layerType: "VectorTileLayer", styleUrl: "https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:HumanGeographyDark:Base", title: "Human Geography Dark Base" }, { layerType: "VectorTileLayer", styleUrl: "https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:HumanGeographyDark:Detail", title: "Human Geography Dark Detail", isReference: true }, { layerType: "VectorTileLayer", styleUrl: "https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:HumanGeographyDark:Label", title: "Human Geography Dark Label", isReference: true }] } };
function l$Z(e2) {
  var _a2;
  return (e2 == null ? void 0 : e2.type) === "feature" && !e2.url && ((_a2 = e2.source) == null ? void 0 : _a2.type) === "memory";
}
function o$P(e2) {
  var _a2;
  return (e2 == null ? void 0 : e2.type) === "feature" && ((_a2 = e2.source) == null ? void 0 : _a2.type) === "feature-layer";
}
function u$I(e2) {
  const t2 = /[:;]/, n2 = [];
  let r2 = false;
  if (e2 && (e2.forEach((e3, i2) => {
    n2.push([i2, e3]), !r2 && t2.test(e3) && (r2 = true);
  }), n2.length > 0)) {
    let e3;
    if (r2) {
      const t3 = {};
      n2.forEach((e4) => {
        t3[e4[0]] = e4[1];
      }), e3 = JSON.stringify(t3);
    } else {
      const t3 = [];
      n2.forEach((e4) => {
        t3.push(e4[0] + ":" + e4[1]);
      }), e3 = t3.join(";");
    }
    return e3;
  }
  return null;
}
const l$Y = new Set(["bing-maps", "imagery", "imagery-tile", "map-image", "open-street-map", "tile", "unknown", "unsupported", "vector-tile", "web-tile", "wms", "wmts"]), a$$ = new Set(["csv", "feature", "geo-rss", "geojson", "group", "imagery", "imagery-tile", "kml", "map-image", "map-notes", "ogc-feature", "route", "subtype-group", "tile", "unknown", "unsupported", "vector-tile", "web-tile", "wfs", "wms", "wmts"]);
function m$W(e2) {
  return e2.layerContainerType === "basemap" ? l$Y : e2.layerContainerType === "operational-layers" ? a$$ : null;
}
function c$Z(e2, t2) {
  if (t2.restrictedWebMapWriting) {
    const r2 = m$W(t2);
    return !r$1$(r2) || r2.has(e2.type) && !l$Z(e2);
  }
  return true;
}
function u$H(e2, t2) {
  if (l$Z(e2)) {
    const n2 = t$2o("featureCollection.layers", t2), i2 = n2 && n2[0] && n2[0].layerDefinition;
    i2 && d$x(e2, i2);
  } else if (e2.type === "stream") {
    d$x(e2, t2.layerDefinition = t2.layerDefinition || {});
  } else
    e2.type !== "group" && d$x(e2, t2);
}
function d$x(e2, t2) {
  "maxScale" in e2 && (t2.maxScale = y$1F(e2.maxScale)), "minScale" in e2 && (t2.minScale = y$1F(e2.minScale));
}
function f$B(e2, t2) {
  if (u$H(e2, t2), "blendMode" in e2 && (t2.blendMode = e2.blendMode, t2.blendMode === "normal" && delete t2.blendMode), t2.opacity = y$1F(e2.opacity), t2.title = e2.title || "Layer", t2.visibility = e2.visible, "legendEnabled" in e2 && e2.type !== "wmts")
    if (l$Z(e2)) {
      const n2 = t2.featureCollection;
      n2 && (n2.showLegend = e2.legendEnabled);
    } else
      t2.showLegend = e2.legendEnabled;
}
function y$q(r2, i2, o2) {
  if (!("write" in r2) || !r2.write)
    return o2 && o2.messages && o2.messages.push(new s$2u("layer:unsupported", `Layers (${r2.title}, ${r2.id}) of type '${r2.declaredClass}' cannot be persisted`, { layer: r2 })), null;
  if (c$Z(r2, o2)) {
    const e2 = {};
    return r2.write(e2, o2) ? e2 : null;
  }
  return r$1$(i2) && f$B(r2, i2 = y$1L(i2)), i2;
}
var v$o;
let S$h = 0;
const _$l = "esri.Basemap";
let U$c = v$o = class extends u$2b(m$1X) {
  constructor(e2) {
    super(e2), this.id = null, this.portalItem = null, this.spatialReference = null, this.thumbnailUrl = null, this.title = "Basemap", this.id = Date.now().toString(16) + "-basemap-" + S$h++, this.baseLayers = new j$V(), this.referenceLayers = new j$V();
    const t2 = (e3) => {
      e3.parent && e3.parent !== this && "remove" in e3.parent && e3.parent.remove(e3), e3.parent = this, e3.type === "elevation" && s$2z.getLogger(this.declaredClass).error(`Layer '${e3.title}, id:${e3.id}' of type '${e3.type}' is not supported as a basemap layer and will therefore be ignored.`);
    }, s2 = (e3) => {
      e3.parent = null;
    };
    this.baseLayers.on("after-add", (e3) => t2(e3.item)), this.referenceLayers.on("after-add", (e3) => t2(e3.item)), this.baseLayers.on("after-remove", (e3) => s2(e3.item)), this.referenceLayers.on("after-remove", (e3) => s2(e3.item));
  }
  initialize() {
    this.when().catch((e2) => {
      s$2z.getLogger(this.declaredClass).error("#load()", `Failed to load basemap (title: '${this.title}', id: '${this.id}')`, e2);
    }), this.resourceInfo && this.read(this.resourceInfo.data, this.resourceInfo.context);
  }
  destroy() {
    var _a2;
    const e2 = this.baseLayers.removeAll();
    for (const t2 of e2)
      t2.destroy();
    const r2 = this.referenceLayers.removeAll();
    for (const t2 of r2)
      t2.destroy();
    this.baseLayers.destroy(), this.referenceLayers.destroy(), (_a2 = this.portalItem) == null ? void 0 : _a2.destroy(), this.portalItem = null;
  }
  normalizeCtorArgs(e2) {
    return e2 && "resourceInfo" in e2 && (this._set("resourceInfo", e2.resourceInfo), delete (e2 = __spreadValues({}, e2)).resourceInfo), e2;
  }
  set baseLayers(e2) {
    this._set("baseLayers", n$2l(e2, this._get("baseLayers")));
  }
  _writeBaseLayers(e2, r2, t2) {
    const s2 = [];
    e2 ? (t2 = __spreadProps(__spreadValues({}, t2), { layerContainerType: "basemap" }), this.baseLayers.forEach((e3) => {
      const r3 = y$q(e3, t2.webmap ? t2.webmap.getLayerJSONFromResourceInfo(e3) : null, t2);
      r$1$(r3) && s2.push(r3);
    }), this.referenceLayers.forEach((e3) => {
      const r3 = y$q(e3, t2.webmap ? t2.webmap.getLayerJSONFromResourceInfo(e3) : null, t2);
      r$1$(r3) && (r3.isReference = true, s2.push(r3));
    }), r2.baseMapLayers = s2) : r2.baseMapLayers = s2;
  }
  set referenceLayers(e2) {
    this._set("referenceLayers", n$2l(e2, this._get("referenceLayers")));
  }
  writeTitle(e2, r2) {
    r2.title = e2 || "Basemap";
  }
  load(e2) {
    return this.addResolvingPromise(this._loadFromSource(e2)), Promise.resolve(this);
  }
  loadAll() {
    return n$10(this, (e2) => {
      e2(this.baseLayers, this.referenceLayers);
    });
  }
  clone() {
    const e2 = { id: this.id, title: this.title, portalItem: this.portalItem, baseLayers: this.baseLayers.slice(), referenceLayers: this.referenceLayers.slice() };
    return this.loaded && (e2.loadStatus = "loaded"), new v$o({ resourceInfo: this.resourceInfo }).set(e2);
  }
  read(e2, r2) {
    this.resourceInfo || this._set("resourceInfo", { data: e2, context: r2 }), super.read(e2, r2);
  }
  write(e2, r2) {
    return e2 = e2 || {}, r2 && r2.origin || (r2 = __spreadValues({ origin: "web-map" }, r2)), super.write(e2, r2), !this.loaded && this.resourceInfo && this.resourceInfo.data.baseMapLayers && (e2.baseMapLayers = this.resourceInfo.data.baseMapLayers.map((e3) => {
      const r3 = y$1L(e3);
      return r3.url && ft$2(r3.url) && (r3.url = `https:${r3.url}`), r3.templateUrl && ft$2(r3.templateUrl) && (r3.templateUrl = `https:${r3.templateUrl}`), r3;
    })), e2;
  }
  async _loadFromSource(e2) {
    const { resourceInfo: r2, portalItem: t2 } = this;
    f$1V(e2);
    const s2 = [];
    if (r2) {
      const t3 = r2.context ? r2.context.url : null;
      if (s2.push(this._loadLayersFromJSON(r2.data, t3, e2)), r2.data.id && !r2.data.title) {
        const e3 = r2.data.id;
        s2.push(a$10(e3).then((e4) => {
          e4 && this.read({ title: e4 }, r2.context);
        }));
      }
    } else
      t2 && s2.push(this._loadFromItem(t2, e2));
    await Promise.all(s2);
  }
  async _loadLayersFromJSON(e2, r2, t2) {
    const s2 = this.resourceInfo && this.resourceInfo.context, o2 = this.portalItem && this.portalItem.portal || s2 && s2.portal || null, a2 = s2 && s2.origin === "web-scene" ? "web-scene" : "web-map", { populateOperationalLayers: i2 } = await import("./layersCreator.js"), n2 = [];
    if (f$1V(t2), e2.baseMapLayers && Array.isArray(e2.baseMapLayers)) {
      const t3 = { context: { origin: a2, url: r2, portal: o2, layerContainerType: "basemap" }, defaultLayerType: "DefaultTileLayer" }, s3 = i2(this.baseLayers, e2.baseMapLayers.filter((e3) => !e3.isReference), t3);
      n2.push(s3);
      const l2 = i2(this.referenceLayers, e2.baseMapLayers.filter((e3) => e3.isReference), t3);
      n2.push(l2);
    }
    await E$Q(n2);
  }
  async _loadFromItem(e2, r2) {
    var _a2, _b2;
    const t2 = await e2.load(r2), s2 = await t2.fetchData("json", r2), o2 = j$Q((_a2 = e2.itemUrl) != null ? _a2 : "");
    return this._set("resourceInfo", { data: (_b2 = s2.baseMap) != null ? _b2 : {}, context: { origin: "web-map", portal: e2.portal || j$M.getDefault(), url: o2 } }), this.read(this.resourceInfo.data, this.resourceInfo.context), this.read({ spatialReference: s2.spatialReference }, this.resourceInfo.context), this.read({ title: e2.title, thumbnailUrl: e2.thumbnailUrl }, { origin: "portal-item", portal: e2.portal || j$M.getDefault(), url: o2 }), this._loadLayersFromJSON(this.resourceInfo.data, o2, r2);
  }
  static fromId(e2) {
    const r2 = s$Q[e2];
    if (r2) {
      if (r2.deprecated) {
        let r3 = null;
        e2 === "dark-gray" ? r3 = "dark-gray-vector" : e2 === "gray" ? r3 = "gray-vector" : e2 === "streets" ? r3 = "streets-vector" : e2 === "topo" && (r3 = "topo-vector"), r$1S(s$2z.getLogger(_$l), `The ${e2} basemap has entered mature support and is no longer being updated.`, { replacement: r3, see: "https://arcg.is/1iq8aD", warnOnce: true });
      }
      return v$o.fromJSON(r2);
    }
    return null;
  }
};
e$2g([y$1I({ json: { write: { ignoreOrigin: true, target: "baseMapLayers", writer(e2, r2, t2, s2) {
  this._writeBaseLayers(e2, r2, s2);
} }, origins: { "web-scene": { write: { ignoreOrigin: true, target: { baseMapLayers: { type: j$V } }, writer(e2, r2, t2, s2) {
  this._writeBaseLayers(e2, r2, s2);
} } } } } })], U$c.prototype, "baseLayers", null), e$2g([y$1I({ type: String, json: { origins: { "web-scene": { write: true } } } })], U$c.prototype, "id", void 0), e$2g([y$1I({ type: x$o })], U$c.prototype, "portalItem", void 0), e$2g([y$1I()], U$c.prototype, "referenceLayers", null), e$2g([y$1I({ readOnly: true })], U$c.prototype, "resourceInfo", void 0), e$2g([y$1I({ type: k$C })], U$c.prototype, "spatialReference", void 0), e$2g([y$1I()], U$c.prototype, "thumbnailUrl", void 0), e$2g([y$1I({ type: String, json: { origins: { "web-scene": { write: { isRequired: true } } } } })], U$c.prototype, "title", void 0), e$2g([r$1P("title")], U$c.prototype, "writeTitle", null), U$c = v$o = e$2g([n$2P(_$l)], U$c);
const x$l = U$c;
var Basemap = /* @__PURE__ */ Object.freeze({
  __proto__: null,
  [Symbol.toStringTag]: "Module",
  "default": x$l
});
var t$O;
let p$14 = t$O = class extends l$2B {
  constructor(r2) {
    super(r2), this.type = "none";
  }
  clone() {
    return new t$O({ type: this.type });
  }
};
e$2g([r$1H({ none: "none", stayAbove: "stay-above" })], p$14.prototype, "type", void 0), p$14 = t$O = e$2g([n$2P("esri.ground.NavigationConstraint")], p$14);
let T$f = class extends m$2q {
  constructor() {
    super(...arguments), this.SCENEVIEW_HITTEST_RETURN_INTERSECTOR = false, this.DECONFLICTOR_SHOW_VISIBLE = false, this.DECONFLICTOR_SHOW_INVISIBLE = false, this.DECONFLICTOR_SHOW_GRID = false, this.LABELS_SHOW_BORDER = false, this.TEXT_SHOW_BASELINE = false, this.TEXT_SHOW_BORDER = false, this.OVERLAY_DRAW_DEBUG_TEXTURE = false, this.OVERLAY_SHOW_CENTER = false, this.SHOW_POI = false, this.TESTS_DISABLE_OPTIMIZATIONS = false, this.TESTS_DISABLE_FAST_UPDATES = false, this.DRAW_MESH_GEOMETRY_NORMALS = false, this.FEATURE_TILE_FETCH_SHOW_TILES = false, this.FEATURE_TILE_TREE_SHOW_TILES = false, this.TERRAIN_TILE_TREE_SHOW_TILES = false, this.I3S_TREE_SHOW_TILES = false, this.I3S_SHOW_MODIFICATIONS = false, this.LOD_INSTANCE_RENDERER_DISABLE_UPDATES = false, this.LOD_INSTANCE_RENDERER_COLORIZE_BY_LEVEL = false, this.EDGES_SHOW_HIDDEN_TRANSPARENT_EDGES = false, this.LINE_WIREFRAMES = false, this.TERRAIN_USE_LEGACY_SHADING = false;
  }
};
e$2g([y$1I()], T$f.prototype, "SCENEVIEW_HITTEST_RETURN_INTERSECTOR", void 0), e$2g([y$1I()], T$f.prototype, "DECONFLICTOR_SHOW_VISIBLE", void 0), e$2g([y$1I()], T$f.prototype, "DECONFLICTOR_SHOW_INVISIBLE", void 0), e$2g([y$1I()], T$f.prototype, "DECONFLICTOR_SHOW_GRID", void 0), e$2g([y$1I()], T$f.prototype, "LABELS_SHOW_BORDER", void 0), e$2g([y$1I()], T$f.prototype, "TEXT_SHOW_BASELINE", void 0), e$2g([y$1I()], T$f.prototype, "TEXT_SHOW_BORDER", void 0), e$2g([y$1I()], T$f.prototype, "OVERLAY_DRAW_DEBUG_TEXTURE", void 0), e$2g([y$1I()], T$f.prototype, "OVERLAY_SHOW_CENTER", void 0), e$2g([y$1I()], T$f.prototype, "SHOW_POI", void 0), e$2g([y$1I()], T$f.prototype, "TESTS_DISABLE_OPTIMIZATIONS", void 0), e$2g([y$1I()], T$f.prototype, "TESTS_DISABLE_FAST_UPDATES", void 0), e$2g([y$1I()], T$f.prototype, "DRAW_MESH_GEOMETRY_NORMALS", void 0), e$2g([y$1I()], T$f.prototype, "FEATURE_TILE_FETCH_SHOW_TILES", void 0), e$2g([y$1I()], T$f.prototype, "FEATURE_TILE_TREE_SHOW_TILES", void 0), e$2g([y$1I()], T$f.prototype, "TERRAIN_TILE_TREE_SHOW_TILES", void 0), e$2g([y$1I()], T$f.prototype, "I3S_TREE_SHOW_TILES", void 0), e$2g([y$1I()], T$f.prototype, "I3S_SHOW_MODIFICATIONS", void 0), e$2g([y$1I()], T$f.prototype, "LOD_INSTANCE_RENDERER_DISABLE_UPDATES", void 0), e$2g([y$1I()], T$f.prototype, "LOD_INSTANCE_RENDERER_COLORIZE_BY_LEVEL", void 0), e$2g([y$1I()], T$f.prototype, "EDGES_SHOW_HIDDEN_TRANSPARENT_EDGES", void 0), e$2g([y$1I()], T$f.prototype, "LINE_WIREFRAMES", void 0), e$2g([y$1I()], T$f.prototype, "TERRAIN_USE_LEGACY_SHADING", void 0), T$f = e$2g([n$2P("esri.views.3d.support.DebugFlags")], T$f);
const t$N = new T$f();
var C$i;
let S$g = C$i = class extends u$2b(m$1X) {
  constructor(r2) {
    super(r2), this.opacity = 1, this.shading = !t$N.TERRAIN_USE_LEGACY_SHADING, this.surfaceColor = null, this.navigationConstraint = null, this.layers = new j$V();
    const e2 = (r3) => {
      r3.parent && r3.parent !== this && "remove" in r3.parent && r3.parent.remove(r3), r3.parent = this, r3.type !== "elevation" && r3.type !== "base-elevation" && s$2z.getLogger(this.declaredClass).error(`Layer '${r3.title}, id:${r3.id}' of type '${r3.type}' is not supported as a ground layer and will therefore be ignored. Only layers of type 'elevation' are supported.`);
    }, t2 = (r3) => {
      r3.parent = null;
    };
    this.layers.on("after-add", (r3) => e2(r3.item)), this.layers.on("after-remove", (r3) => t2(r3.item));
  }
  initialize() {
    this.when().catch((r2) => {
      s$2z.getLogger(this.declaredClass).error("#load()", "Failed to load ground", r2);
    }), this.resourceInfo && this.read(this.resourceInfo.data, this.resourceInfo.context);
  }
  destroy() {
    const r2 = this.layers.removeAll();
    for (const e2 of r2)
      e2.destroy();
    this.layers.destroy();
  }
  normalizeCtorArgs(r2) {
    return r2 && "resourceInfo" in r2 && (this._set("resourceInfo", r2.resourceInfo), delete (r2 = __spreadValues({}, r2)).resourceInfo), r2;
  }
  set layers(r2) {
    this._set("layers", n$2l(r2, this._get("layers")));
  }
  writeLayers(r2, e2, o2, t2) {
    const i2 = [];
    r2 ? (t2 = __spreadProps(__spreadValues({}, t2), { layerContainerType: "ground" }), r2.forEach((r3) => {
      if ("write" in r3) {
        const e3 = {};
        o$19(r3)().write(e3, t2) && i2.push(e3);
      } else
        t2 && t2.messages && t2.messages.push(new s$2u("layer:unsupported", `Layers (${r3.title}, ${r3.id}) of type '${r3.declaredClass}' cannot be persisted in the ground`, { layer: r3 }));
    }), e2.layers = i2) : e2.layers = i2;
  }
  load(r2) {
    return this.addResolvingPromise(this._loadFromSource(r2)), Promise.resolve(this);
  }
  loadAll() {
    return n$10(this, (r2) => {
      r2(this.layers);
    });
  }
  async queryElevation(r2, e2) {
    await this.load({ signal: e2 == null ? void 0 : e2.signal });
    const { ElevationQuery: o2 } = await import("./ElevationQuery.js");
    f$1V(e2);
    const t2 = new o2(), s2 = this.layers.filter(A$e).toArray();
    return t2.queryAll(s2, r2, e2);
  }
  async createElevationSampler(r2, e2) {
    await this.load({ signal: e2 == null ? void 0 : e2.signal });
    const { ElevationQuery: o2 } = await import("./ElevationQuery.js");
    f$1V(e2);
    const t2 = new o2(), s2 = this.layers.filter(A$e).toArray();
    return t2.createSamplerAll(s2, r2, e2);
  }
  clone() {
    const r2 = { opacity: this.opacity, surfaceColor: y$1L(this.surfaceColor), navigationConstraint: y$1L(this.navigationConstraint), layers: this.layers.slice() };
    return this.loaded && (r2.loadStatus = "loaded"), new C$i({ resourceInfo: this.resourceInfo }).set(r2);
  }
  read(r2, e2) {
    this.resourceInfo || this._set("resourceInfo", { data: r2, context: e2 }), super.read(r2, e2);
  }
  _loadFromSource(r2) {
    const e2 = this.resourceInfo;
    return e2 ? this._loadLayersFromJSON(e2.data, e2.context, r2) : Promise.resolve();
  }
  _loadLayersFromJSON(r2, e2, o2) {
    const t2 = e2 && e2.origin || "web-scene", s2 = e2 && e2.portal || null, a2 = e2 && e2.url || null;
    return import("./layersCreator.js").then(({ populateOperationalLayers: e3 }) => {
      f$1V(o2);
      const i2 = [];
      if (r2.layers && Array.isArray(r2.layers)) {
        const o3 = { context: { origin: t2, url: a2, portal: s2, layerContainerType: "ground" }, defaultLayerType: "ArcGISTiledElevationServiceLayer" };
        i2.push(e3(this.layers, r2.layers, o3));
      }
      return E$Q(i2);
    }).then(() => {
    });
  }
};
function I$h(r2) {
  return r2 && "createElevationSampler" in r2;
}
function A$e(r2) {
  return r2.type === "elevation" || I$h(r2);
}
e$2g([y$1I({ json: { read: false } })], S$g.prototype, "layers", null), e$2g([r$1P("layers")], S$g.prototype, "writeLayers", null), e$2g([y$1I({ readOnly: true })], S$g.prototype, "resourceInfo", void 0), e$2g([y$1I({ type: Number, nonNullable: true, range: { min: 0, max: 1 }, json: { type: T$G, read: { reader: r$1w, source: "transparency" }, write: { writer: (r2, e2) => {
  e2.transparency = n$2r(r2);
}, target: "transparency" } } })], S$g.prototype, "opacity", void 0), e$2g([y$1I({ type: Boolean, nonNullable: true, json: { read: false } })], S$g.prototype, "shading", void 0), e$2g([y$1I({ type: l$2e, json: { type: [T$G], write: (r2, e2) => {
  e2.surfaceColor = r2.toJSON().slice(0, 3);
} } })], S$g.prototype, "surfaceColor", void 0), e$2g([y$1I({ type: p$14, json: { write: true } })], S$g.prototype, "navigationConstraint", void 0), S$g = C$i = e$2g([n$2P("esri.Ground")], S$g);
const L$d = S$g;
function i$17(i2) {
  var _a2;
  return !!(i2 && i2.loaded && "capabilities" in i2 && ((_a2 = i2 == null ? void 0 : i2.capabilities) == null ? void 0 : _a2.operations) && "supportsEditing" in i2.capabilities.operations && i2.capabilities.operations.supportsEditing === true) && !("editingEnabled" in i2 && !i2.editingEnabled);
}
const f$A = s$2z.getLogger("esri.support.basemapUtils");
function p$13() {
  return {};
}
function y$p(e2) {
  for (const r2 in e2) {
    const a2 = e2[r2];
    (a2 == null ? void 0 : a2.destroyed) === false && a2.destroy(), delete e2[r2];
  }
}
function m$V(a2, t2) {
  let n2;
  if (typeof a2 == "string") {
    if (!(a2 in s$Q)) {
      const e2 = Object.entries(s$Q).filter(([e3, a3]) => s$2A.apiKey && !a3.classic || !s$2A.apiKey && a3.classic && !a3.deprecated).map(([e3]) => `"${e3}"`).join(", ");
      return f$A.warn(`Unable to find basemap definition for: ${a2}. Try one of these: ${e2}`), null;
    }
    t2 && (n2 = t2[a2]), n2 || (n2 = x$l.fromId(a2), t2 && (t2[a2] = n2));
  } else
    n2 = b$1a(x$l, a2);
  return (n2 == null ? void 0 : n2.destroyed) && (f$A.warn("The provided basemap is already destroyed", { basemap: n2 }), n2 = null), n2;
}
function t$M(t2) {
  return new l$1Q({ getCollections: () => [t2.tables, t2.layers], getChildrenFunction: (e2) => {
    const t3 = [];
    return "tables" in e2 && t3.push(e2.tables), "layers" in e2 && t3.push(e2.layers), t3;
  }, itemFilterFunction: (e2) => {
    const t3 = e2.parent;
    return t3 && "tables" in t3 && t3.tables.includes(e2);
  } });
}
const i$16 = { "world-elevation": { id: "worldElevation", url: "//elevation3d.arcgis.com/arcgis/rest/services/WorldElevation3D/Terrain3D/ImageServer", layerType: "ArcGISTiledElevationServiceLayer" }, "world-topobathymetry": { id: "worldTopoBathymetry", url: "//elevation3d.arcgis.com/arcgis/rest/services/WorldElevation3D/TopoBathy3D/ImageServer", layerType: "ArcGISTiledElevationServiceLayer" } };
function t$L(t2) {
  let a2 = null;
  if (typeof t2 == "string")
    if (t2 in i$16) {
      const r2 = i$16[t2];
      a2 = new L$d({ resourceInfo: { data: { layers: [r2] } } });
    } else
      s$2z.getLogger("esri.support.groundUtils").warn(`Unable to find ground definition for: ${t2}. Try "world-elevation"`);
  else
    a2 = b$1a(L$d, t2);
  return a2;
}
function n$$(e2, r2, t2) {
  let s2, o2;
  if (e2)
    for (let a2 = 0, i2 = e2.length; a2 < i2; a2++) {
      if (s2 = e2.getItemAt(a2), s2[r2] === t2)
        return s2;
      if ((s2 == null ? void 0 : s2.type) === "group" && (o2 = n$$(s2.layers, r2, t2), o2))
        return o2;
    }
}
const d$w = (d2) => {
  let y2 = class extends d2 {
    constructor(...e2) {
      super(...e2), this.layers = new j$V();
      const t2 = (e3) => {
        e3.parent && "remove" in e3.parent && e3.parent.remove(e3);
      }, o2 = (e3) => {
        e3.parent = this, this.layerAdded(e3), e3.type !== "elevation" && e3.type !== "base-elevation" || s$2z.getLogger(this.declaredClass).error(`Layer 'title:${e3.title}, id:${e3.id}' of type '${e3.type}' is not supported as an operational layer and will therefore be ignored.`);
      }, a2 = (e3) => {
        e3.parent = null, this.layerRemoved(e3);
      };
      this.layers.on("before-add", (e3) => t2(e3.item)), this.layers.on("after-add", (e3) => o2(e3.item)), this.layers.on("after-remove", (e3) => a2(e3.item));
    }
    destroy() {
      const e2 = this.layers.removeAll();
      for (const r2 of e2)
        this.layerRemoved(r2), r2.destroy();
      this.layers.destroy();
    }
    set layers(e2) {
      this._set("layers", n$2l(e2, this._get("layers")));
    }
    add(e2, r2) {
      const t2 = this.layers;
      if (r2 = t2.getNextIndex(r2), e2 instanceof b$y) {
        const s2 = e2;
        s2.parent === this ? this.reorder(s2, r2) : t2.add(s2, r2);
      } else
        C$E(e2) ? e2.then((e3) => {
          this.destroyed || this.add(e3, r2);
        }) : s$2z.getLogger(this.declaredClass).error("#add()", "The item being added is not a Layer or a Promise that resolves to a Layer.");
    }
    addMany(e2, r2) {
      const t2 = this.layers;
      r2 = t2.getNextIndex(r2), e2.slice().forEach((e3) => {
        e3.parent !== this ? (t2.add(e3, r2), r2 += 1) : this.reorder(e3, r2);
      });
    }
    findLayerById(e2) {
      return n$$(this.layers, "id", e2);
    }
    findLayerByUid(e2) {
      return n$$(this.layers, "uid", e2);
    }
    remove(e2) {
      return this.layers.remove(e2);
    }
    removeMany(e2) {
      return this.layers.removeMany(e2);
    }
    removeAll() {
      return this.layers.removeAll();
    }
    reorder(e2, r2) {
      return this.layers.reorder(e2, r2);
    }
    layerAdded(e2) {
    }
    layerRemoved(e2) {
    }
  };
  return e$2g([y$1I()], y2.prototype, "layers", null), y2 = e$2g([n$2P("esri.support.LayersMixin")], y2), y2;
};
function a$_(t2, e2, r2) {
  if (t2)
    for (let s2 = 0, o2 = t2.length; s2 < o2; s2++) {
      const o3 = t2.getItemAt(s2);
      if (o3[e2] === r2)
        return o3;
      if ((o3 == null ? void 0 : o3.type) === "group") {
        const t3 = a$_(o3.tables, e2, r2);
        if (t3)
          return t3;
      }
    }
}
const l$X = (l2) => {
  let n2 = class extends l2 {
    constructor(...t2) {
      super(...t2), this.tables = new j$V(), this.tables.on("after-add", (t3) => {
        const e2 = t3.item;
        e2.parent && e2.parent !== this && "tables" in e2.parent && e2.parent.tables.remove(e2), e2.parent = this, e2.type !== "feature" && s$2z.getLogger(this.declaredClass).error(`Layer 'title:${e2.title}, id:${e2.id}' of type '${e2.type}' is not supported as a table and will therefore be ignored.`);
      }), this.tables.on("after-remove", (t3) => {
        t3.item.parent = null;
      });
    }
    destroy() {
      const t2 = this.tables.removeAll();
      for (const e2 of t2)
        e2.destroy();
      this.tables.destroy();
    }
    set tables(t2) {
      this._set("tables", n$2l(t2, this._get("tables")));
    }
    findTableById(t2) {
      return a$_(this.tables, "id", t2);
    }
    findTableByUid(t2) {
      return a$_(this.tables, "uid", t2);
    }
  };
  return e$2g([y$1I()], n2.prototype, "tables", null), n2 = e$2g([n$2P("esri.support.TablesMixin")], n2), n2;
};
let j$f = class extends l$X(d$w(n$2G.EventedMixin(m$2q))) {
  constructor(s2) {
    super(s2), this.allLayers = new l$1Q({ getCollections: () => {
      var _a2, _b2, _c2;
      return [(_a2 = this.basemap) == null ? void 0 : _a2.baseLayers, (_b2 = this.ground) == null ? void 0 : _b2.layers, this.layers, (_c2 = this.basemap) == null ? void 0 : _c2.referenceLayers];
    }, getChildrenFunction: (s3) => "layers" in s3 ? s3.layers : null }), this.allTables = t$M(this), this.basemap = null, this.editableLayers = new l$1Q({ getCollections: () => [this.allLayers], itemFilterFunction: i$17 }), this.ground = new L$d(), this._basemapCache = p$13();
  }
  destroy() {
    var _a2, _b2;
    this.allLayers.destroy(), this.allTables.destroy(), this.editableLayers.destroy(), (_a2 = this.ground) == null ? void 0 : _a2.destroy(), (_b2 = this.basemap) == null ? void 0 : _b2.destroy(), y$p(this._basemapCache), this._basemapCache = null;
  }
  castBasemap(s2) {
    return m$V(s2, this._basemapCache);
  }
  castGround(s2) {
    const e2 = t$L(s2);
    return t$2r(e2) ? this._get("ground") : e2;
  }
  findLayerById(s2) {
    return this.allLayers.find((e2) => e2.id === s2);
  }
  findTableById(s2) {
    return this.allTables.find((e2) => e2.id === s2);
  }
};
e$2g([y$1I({ readOnly: true, dependsOn: [] })], j$f.prototype, "allLayers", void 0), e$2g([y$1I({ readOnly: true })], j$f.prototype, "allTables", void 0), e$2g([y$1I({ type: x$l })], j$f.prototype, "basemap", void 0), e$2g([s$2i("basemap")], j$f.prototype, "castBasemap", null), e$2g([y$1I({ readOnly: true })], j$f.prototype, "editableLayers", void 0), e$2g([y$1I({ type: L$d, nonNullable: true })], j$f.prototype, "ground", void 0), e$2g([s$2i("ground")], j$f.prototype, "castGround", null), j$f = e$2g([n$2P("esri.Map")], j$f);
const L$c = j$f;
let l$W = class extends a$1W(j$V) {
  constructor(e2) {
    super(e2), this.handles.add([this.on("before-add", (e3) => {
      t$2r(e3.item) && e3.preventDefault();
    }), this.on("after-add", (e3) => this._own(e3.item)), this.on("after-remove", (e3) => this._release(e3.item))]);
  }
  get owner() {
    return this._get("owner");
  }
  set owner(e2) {
    e2 !== this._get("owner") && (this._releaseAll(), this._set("owner", e2), this._ownAll());
  }
  _ownAll() {
    for (const e2 of this.items)
      this._own(e2);
  }
  _releaseAll() {
    for (const e2 of this.items)
      this._release(e2);
  }
  _createNewInstance(e2) {
    return this.itemType ? new (j$V.ofType(this.itemType.Type))(e2) : new j$V(e2);
  }
};
function a$Z(e2, t2) {
  return { type: e2, cast: t$1J, set(s2) {
    const r2 = n$2l(s2, this._get(t2), e2);
    r2.owner = this, this._set(t2, r2);
  } };
}
e$2g([y$1I()], l$W.prototype, "owner", null), l$W = e$2g([n$2P("esri.core.support.OwningCollection")], l$W);
let i$15 = class extends l$W {
  constructor(e2) {
    super(e2), this.handles.add(this.on("before-add", (e3) => {
      t$2r(e3.item) || e3.item.parent === this.owner && (s$2z.getLogger(this.declaredClass).warn("Analysis inside the collection must be unique. Not adding this element again."), e3.preventDefault());
    }));
  }
  _own(e2) {
    e2.parent = this.owner;
  }
  _release(e2) {
    e2.parent = null;
  }
};
i$15 = e$2g([n$2P("esri.support.AnalysesCollection")], i$15);
let i$14 = class extends l$W {
  _own(r2) {
    r2.layer && "remove" in r2.layer && r2.layer !== this.owner && r2.layer.remove(r2), r2.layer = this.owner;
  }
  _release(r2) {
    r2.layer === this.owner && (r2.layer = null);
  }
};
e$2g([n$2F({ Type: g$10, ensureType: b$1a(g$10) })], i$14.prototype, "itemType", void 0), i$14 = e$2g([n$2P("esri.support.GraphicsCollection")], i$14);
let p$12 = class extends m$2q {
  constructor(e2) {
    super(e2), this.view = null, this.baseLayerViews = new j$V(), this.referenceLayerViews = new j$V(), this._loadingHandle = l$1P(() => {
      var _a2, _b2;
      return (_b2 = (_a2 = this.view) == null ? void 0 : _a2.map) == null ? void 0 : _b2.basemap;
    }, (e3) => {
      e3 && e3.load().catch(() => {
      });
    }, h$1j);
  }
  destroy() {
    this._set("view", null), this._loadingHandle && (this._loadingHandle.remove(), this._loadingHandle = null);
  }
  get suspended() {
    return !this.view || this.view.suspended;
  }
  get updating() {
    var _a2, _b2;
    if (this.view && this.view.suspended)
      return false;
    const e2 = (_b2 = (_a2 = this.view) == null ? void 0 : _a2.map) == null ? void 0 : _b2.basemap;
    return !!e2 && (!!e2.loaded && (this.baseLayerViews.some((e3) => e3.updating) || this.referenceLayerViews.some((e3) => e3.updating)));
  }
};
e$2g([y$1I({ constructOnly: true })], p$12.prototype, "view", void 0), e$2g([y$1I({ readOnly: true })], p$12.prototype, "baseLayerViews", void 0), e$2g([y$1I({ readOnly: true })], p$12.prototype, "referenceLayerViews", void 0), e$2g([y$1I({ readOnly: true })], p$12.prototype, "suspended", null), e$2g([y$1I({ type: Boolean, readOnly: true })], p$12.prototype, "updating", null), p$12 = e$2g([n$2P("esri.views.BasemapView")], p$12);
class v$n {
  constructor(e2, r2, i2) {
    this.layer = e2, this.view = r2, this.layerViewImporter = i2, this._controller = new AbortController(), this._deferred = A$B(), this._started = false, this.done = false, v$19(this._controller.signal, () => {
      const r3 = new s$2u("cancelled:layerview-create", "layerview creation cancelled", { layer: e2 });
      this._deferred.reject(r3);
    });
  }
  get promise() {
    return this._deferred.promise;
  }
  destroy() {
    this._controller.abort();
    const { layerView: e2 } = this;
    if (!e2)
      return;
    const { layer: r2, view: t2 } = this;
    r2.emit("layerview-destroy", { view: t2, layerView: e2 }), t2.emit("layerview-destroy", { layer: r2, layerView: e2 }), this.done = true, this.layer = null, this.layerView = null, this.view = null, this.layerViewImporter = null;
  }
  async start() {
    var _a2, _b2;
    if (this._started)
      return;
    this._started = true;
    const { _controller: { signal: e2 }, layer: r2, view: i2 } = this;
    this._map = i2.map;
    try {
      let s2, o2;
      if (await r2.load({ signal: e2 }), "prefetchResources" in r2 && await r2.prefetchResources({ signal: e2 }), r2.createLayerView)
        s2 = await r2.createLayerView(i2, { signal: e2 });
      else {
        if (!this.layerViewImporter.hasLayerViewModule(r2))
          throw new s$2u("layer:view-not-supported", "No layerview implementation was found");
        const a2 = await this.layerViewImporter.importLayerView(r2);
        f$1V(e2), s2 = "default" in a2 ? new a2.default({ layer: r2, view: i2 }) : new a2({ layer: r2, view: i2 });
      }
      const n2 = () => {
        o2 = h$1W(o2), s2.destroyed || s2.destroy(), s2.layer = null, s2.parent = null, s2.view = null, this.done = true;
      };
      o2 = v$19(e2, n2), f$1V(e2);
      try {
        await s2.when();
      } catch (a2) {
        throw n2(), a2;
      }
      const y2 = (_b2 = (_a2 = this._map) == null ? void 0 : _a2.allLayers) == null ? void 0 : _b2.includes(r2);
      if (!y2)
        return n2(), void this._deferred.reject(new s$2u("view:no-layerview-for-layer", "The layer has been removed from the map", { layer: r2 }));
      this.layerView = s2, r2.emit("layerview-create", { view: i2, layerView: s2 }), i2.emit("layerview-create", { layer: r2, layerView: s2 }), this.done = true, this._deferred.resolve(s2);
    } catch (a2) {
      r2.emit("layerview-create-error", { view: i2, error: a2 }), i2.emit("layerview-create-error", { layer: r2, error: a2 }), this.done = true, this._deferred.reject(new s$2u("layerview:create-error", "layerview creation failed", { layer: r2, error: a2 }));
    }
  }
}
let V$c = class extends m$2q {
  constructor(e2) {
    super(e2), this._layerLayerViewInfoMap = new Map(), this._watchUpdatingTracking = new c$2c(), this.supportsGround = true, this._preloadLayerViewModules = () => {
      var _a2;
      const e3 = (_a2 = this.view.map) == null ? void 0 : _a2.allLayers;
      if (e3)
        for (const r2 of e3)
          this.layerViewImporter.hasLayerViewModule(r2) && this.layerViewImporter.importLayerView(r2);
    }, this._reschedule = () => (t$2r(this._workPromise) && (this._workPromise = A$B(), this._workPromise.promise.catch(() => {
    })), this.removeHandles("reschedule"), this.addHandles(v$18(this._doWork), "reschedule"), this._workPromise.promise), this._doWork = () => {
      var _a2, _b2, _c2;
      const e3 = this.view.map;
      if (this._map !== e3 && (this.clear(), this._map = e3), t$2r(this._workPromise))
        return void this.notifyChange("updating");
      this.removeHandles("reschedule"), this.removeHandles("collection-change");
      const r2 = [], t2 = (e4) => {
        if (!t$2r(e4))
          for (const i3 of e4)
            i3 && (r2.push(i3), this._createLayerView(i3), "layers" in i3 && i3.layers && t2(i3.layers));
      };
      for (const s2 of this._rootCollectionNames)
        t2(this.get(s2));
      this._refreshCollections();
      for (const [s2, o2] of this._layerLayerViewInfoMap)
        r2.includes(s2) || (this._layerLayerViewInfoMap.delete(o2.layer), o2.destroy());
      const i2 = r2.filter((e4) => e4.type === "group").map((e4) => e4.layers), a2 = [(_a2 = e3 == null ? void 0 : e3.ground) == null ? void 0 : _a2.layers, (_b2 = e3 == null ? void 0 : e3.basemap) == null ? void 0 : _b2.baseLayers, (_c2 = e3 == null ? void 0 : e3.basemap) == null ? void 0 : _c2.referenceLayers, e3 == null ? void 0 : e3.layers, ...i2].filter((e4) => !!e4);
      this.addHandles(a2.map((e4) => this._watchUpdatingTracking.addOnCollectionChange(() => e4, this._reschedule)), "collection-change"), this._workPromise.resolve(), this._workPromise = null;
    };
  }
  initialize() {
    this.own([a$2a(() => {
      var _a2, _b2;
      return (_b2 = (_a2 = this.view) == null ? void 0 : _a2.map) == null ? void 0 : _b2.allLayers;
    }, "change", this._preloadLayerViewModules, { onListenerAdd: this._preloadLayerViewModules }), l$1P(() => {
      const e2 = this.view, r2 = e2 == null ? void 0 : e2.map;
      return [r2 == null ? void 0 : r2.basemap, r2 == null ? void 0 : r2.ground, r2 == null ? void 0 : r2.layers, e2 == null ? void 0 : e2.ready];
    }, () => this._reschedule(), w$Q)]), this._preloadLayerViewModules(), this._reschedule();
  }
  destroy() {
    this.clear(), this._watchUpdatingTracking.destroy(), this._map = null, r$1$(this._workPromise) && (this._workPromise.reject(a$2T()), this._workPromise = null);
  }
  get _layersToLayerViews() {
    const e2 = [["view.map.basemap.baseLayers", "view.basemapView.baseLayerViews"], ["view.map.layers", "view.layerViews"], ["view.map.basemap.referenceLayers", "view.basemapView.referenceLayerViews"]];
    return this.supportsGround && e2.push(["view.map.ground.layers", "view.groundView.layerViews"]), new Map(e2);
  }
  get _rootCollectionNames() {
    return Array.from(this._layersToLayerViews.keys());
  }
  get updating() {
    return r$1$(this._workPromise) || this._watchUpdatingTracking.updating || n$2V(this._layerLayerViewInfoMap, (e2) => !e2.done);
  }
  get updatingRemaining() {
    let e2 = 0;
    for (const r2 of this._layerLayerViewInfoMap.values())
      r2.done || ++e2;
    return e2;
  }
  clear() {
    if (!this.destroyed) {
      for (const e2 of this._layerLayerViewInfoMap.values())
        e2.destroy();
      this._layerLayerViewInfoMap.clear(), this._refreshCollections();
    }
  }
  async whenLayerView(e2) {
    if (await this._reschedule(), !this._layerLayerViewInfoMap.has(e2))
      throw new s$2u("view:no-layerview-for-layer", "No layerview has been found for the layer", { layer: e2 });
    return this._layerLayerViewInfoMap.get(e2).promise;
  }
  _refreshCollections() {
    for (const [e2, r2] of this._layersToLayerViews)
      this._populateLayerViewsOwners(this.get(e2), this.get(r2), this.view);
    this.notifyChange("updating"), this.notifyChange("updatingRemaining");
  }
  _populateLayerViewsOwners(e2, r2, t2) {
    if (!e2 || !r2)
      return void (r2 && r2.removeAll());
    let i2 = 0;
    for (const a2 of e2) {
      const e3 = this._layerLayerViewInfoMap.get(a2);
      if (!e3 || !e3.layerView)
        continue;
      const s2 = e3.layerView;
      s2.layer = a2, s2.parent = t2, r2.getItemAt(i2) !== s2 && r2.splice(i2, 0, s2), a2.layers && this._populateLayerViewsOwners(a2.layers, s2.layerViews, s2), i2 += 1;
    }
    i2 < r2.length && r2.splice(i2, r2.length);
  }
  _createLayerView(e2) {
    if (this._layerLayerViewInfoMap.has(e2))
      return this.view.ready && this._layerLayerViewInfoMap.get(e2).start(), this.notifyChange("updating"), void this.notifyChange("updatingRemaining");
    e2.load().catch(() => {
    }), this.layerViewImporter.hasLayerViewModule(e2) && this.layerViewImporter.importLayerView(e2);
    const r2 = new v$n(e2, this.view, this.layerViewImporter);
    r2.promise.then(() => this._refreshCollections(), (r3) => {
      var _a2, _b2;
      r3 && (j$_(r3) || r3.name === "cancelled:layerview-create") || s$2z.getLogger(this.declaredClass).error(`Failed to create layerview for layer title:'${(_a2 = e2.title) != null ? _a2 : "no title"}', id:'${(_b2 = e2.id) != null ? _b2 : "no id"}' of type '${e2.type}'.`, { layer: e2, error: r3 }), this._refreshCollections();
    }), this._layerLayerViewInfoMap.set(e2, r2), this.view.ready && r2.start(), this.notifyChange("updating"), this.notifyChange("updatingRemaining");
  }
};
e$2g([y$1I()], V$c.prototype, "_workPromise", void 0), e$2g([y$1I({ readOnly: true })], V$c.prototype, "_watchUpdatingTracking", void 0), e$2g([y$1I({ readOnly: true })], V$c.prototype, "_layersToLayerViews", null), e$2g([y$1I({ readOnly: true })], V$c.prototype, "_rootCollectionNames", null), e$2g([y$1I()], V$c.prototype, "layerViewImporter", void 0), e$2g([y$1I()], V$c.prototype, "supportsGround", void 0), e$2g([y$1I({ readOnly: true })], V$c.prototype, "updating", null), e$2g([y$1I({ readOnly: true })], V$c.prototype, "updatingRemaining", null), e$2g([y$1I({ constructOnly: true })], V$c.prototype, "view", void 0), V$c = e$2g([n$2P("esri.views.LayerViewManager")], V$c);
const L$b = V$c;
let i$13 = class extends m$2q {
  constructor(o2) {
    super(o2), this.factor = 1.5, this.offset = c$2K(0, 0), this.position = null, this.size = 120, this.maskUrl = null, this.maskEnabled = true, this.overlayUrl = null, this.overlayEnabled = true, this.visible = true;
  }
  get version() {
    return this.commitProperty("factor"), this.commitProperty("offset"), this.commitProperty("position"), this.commitProperty("visible"), this.commitProperty("size"), this.commitProperty("maskUrl"), this.commitProperty("maskEnabled"), this.commitProperty("overlayUrl"), this.commitProperty("overlayEnabled"), (this._get("version") || 0) + 1;
  }
};
e$2g([y$1I({ type: Number })], i$13.prototype, "factor", void 0), e$2g([y$1I({ nonNullable: true })], i$13.prototype, "offset", void 0), e$2g([y$1I()], i$13.prototype, "position", void 0), e$2g([y$1I({ type: Number, range: { min: 0 } })], i$13.prototype, "size", void 0), e$2g([y$1I()], i$13.prototype, "maskUrl", void 0), e$2g([y$1I()], i$13.prototype, "maskEnabled", void 0), e$2g([y$1I()], i$13.prototype, "overlayUrl", void 0), e$2g([y$1I()], i$13.prototype, "overlayEnabled", void 0), e$2g([y$1I({ readOnly: true })], i$13.prototype, "version", null), e$2g([y$1I({ type: Boolean })], i$13.prototype, "visible", void 0), i$13 = e$2g([n$2P("esri.views.Magnifier")], i$13);
const p$11 = i$13;
class n$_ {
  constructor() {
    this._tasks = new Array(), this._running = new t$Q(false);
  }
  get length() {
    return this._tasks.length;
  }
  get running() {
    return this._running.get();
  }
  destroy() {
    this.cancelAll();
  }
  runTask(s2) {
    for (; !s2.done && this._process(s2); )
      s2.madeProgress();
  }
  push(s2, t2, e2) {
    return this._running.set(true), new Promise((r2, n2) => this._tasks.push(new i$12(r2, n2, s2, t2, e2)));
  }
  unshift(s2, t2, e2) {
    return this._running.set(true), new Promise((r2, n2) => this._tasks.unshift(new i$12(r2, n2, s2, t2, e2)));
  }
  _process(r2) {
    var _a2;
    if (this._tasks.length === 0)
      return false;
    const n2 = this._tasks.shift();
    try {
      const i2 = p$3D(n2.signal);
      if (i2 && !n2.abortCallback)
        n2.reject(a$2T());
      else {
        const s2 = i2 ? (_a2 = n2.abortCallback) == null ? void 0 : _a2.call(n2, a$2T()) : n2.callback(r2);
        C$E(s2) ? s2.then(n2.resolve, n2.reject) : n2.resolve(s2);
      }
    } catch (i2) {
      n2.reject(i2);
    }
    return this._running.set(this._tasks.length > 0), true;
  }
  cancelAll() {
    const s2 = a$2T();
    for (const t2 of this._tasks)
      if (t2.abortCallback) {
        const e2 = t2.abortCallback(s2);
        t2.resolve(e2);
      } else
        t2.reject(s2);
    this._tasks.length = 0, this._running.set(false);
  }
}
class i$12 {
  constructor(s2, t2, e2, r2, n2) {
    this.resolve = s2, this.reject = t2, this.callback = e2, this.signal = r2, this.abortCallback = n2;
  }
}
let t$K = class extends m$2q {
  constructor() {
    super(...arguments), this.SCHEDULER_LOG_SLOW_TASKS = false, this.FEATURE_SERVICE_SNAPPING_SOURCE_TILE_TREE_SHOW_TILES = false;
  }
};
e$2g([y$1I()], t$K.prototype, "SCHEDULER_LOG_SLOW_TASKS", void 0), e$2g([y$1I()], t$K.prototype, "FEATURE_SERVICE_SNAPPING_SOURCE_TILE_TREE_SHOW_TILES", void 0), t$K = e$2g([n$2P("esri.views.support.DebugFlags")], t$K);
const p$10 = new t$K();
var I$g;
!function(I2) {
  I2[I2.ANIMATING = 0] = "ANIMATING", I2[I2.INTERACTING = 1] = "INTERACTING", I2[I2.IDLE = 2] = "IDLE";
}(I$g || (I$g = {}));
var I$f;
!function(e2) {
  e2.RESOURCE_CONTROLLER = "schedule", e2.SLIDE = "slide", e2.STREAM_DATA_LOADER = "stream loader", e2.ELEVATION_QUERY = "elevation query", e2.TERRAIN_SURFACE = "terrain", e2.SURFACE_GEOMETRY_UPDATES = "surface geometry updates", e2.GRAPHICS_CORE = "Graphics3D", e2.I3S_CONTROLLER = "I3S", e2.POINT_CLOUD_LAYER = "point cloud", e2.FEATURE_TILE_FETCHER = "feature fetcher", e2.OVERLAY = "overlay", e2.STAGE = "stage", e2.GRAPHICS_DECONFLICTOR = "graphics deconflictor", e2.FILTER_VISIBILITY = "Graphics3D filter visibility", e2.SCALE_VISIBILITY = "Graphics3D scale visibility", e2.FRUSTUM_VISIBILITY = "Graphics3D frustum visibility", e2.POINT_OF_INTEREST_FREQUENT = "POI frequent", e2.POINT_OF_INTEREST_INFREQUENT = "POI infrequent", e2.LABELER = "labeler", e2.FEATURE_QUERY_ENGINE = "feature query", e2.FEATURE_TILE_TREE = "feature tile tree", e2.FEATURE_TILE_TREE_ACTIVE = "fast feature tile tree", e2.ELEVATION_ALIGNMENT = "elevation alignment", e2.TEXT_TEXTURE_ATLAS = "text texture atlas", e2.TEXTURE_UNLOAD = "texture unload", e2.LINE_OF_SIGHT_TOOL = "line of sight tool", e2.LINE_OF_SIGHT_TOOL_INTERACTIVE = "interactive line of sight tool", e2.ELEVATION_PROFILE = "elevation profile", e2.SNAPPING = "snapping", e2.SHADOW_ACCUMULATOR = "shadow accumulator", e2.CLOUDS_GENERATOR = "cloud generator", e2[e2.TEST_PRIO = 1] = "TEST_PRIO";
}(I$f || (I$f = {}));
const R$c = 0, p$$ = new Map([[I$f.RESOURCE_CONTROLLER, R$c], [I$f.SLIDE, R$c], [I$f.STREAM_DATA_LOADER, R$c], [I$f.ELEVATION_QUERY, R$c], [I$f.TERRAIN_SURFACE, 1], [I$f.SURFACE_GEOMETRY_UPDATES, 1], [I$f.GRAPHICS_CORE, 2], [I$f.I3S_CONTROLLER, 2], [I$f.POINT_CLOUD_LAYER, 2], [I$f.FEATURE_TILE_FETCHER, 2], [I$f.OVERLAY, 4], [I$f.STAGE, 4], [I$f.GRAPHICS_DECONFLICTOR, 4], [I$f.FILTER_VISIBILITY, 4], [I$f.SCALE_VISIBILITY, 4], [I$f.FRUSTUM_VISIBILITY, 4], [I$f.CLOUDS_GENERATOR, 4], [I$f.POINT_OF_INTEREST_FREQUENT, 6], [I$f.POINT_OF_INTEREST_INFREQUENT, 30], [I$f.LABELER, 8], [I$f.FEATURE_QUERY_ENGINE, 8], [I$f.FEATURE_TILE_TREE, 16], [I$f.FEATURE_TILE_TREE_ACTIVE, R$c], [I$f.ELEVATION_ALIGNMENT, 12], [I$f.TEXT_TEXTURE_ATLAS, 12], [I$f.TEXTURE_UNLOAD, 12], [I$f.LINE_OF_SIGHT_TOOL, 16], [I$f.LINE_OF_SIGHT_TOOL_INTERACTIVE, R$c], [I$f.SNAPPING, R$c], [I$f.SHADOW_ACCUMULATOR, 30]]), f$z = 32;
function A$d(e2) {
  return p$$.has(e2) ? p$$.get(e2) : typeof e2 == "number" ? e2 : 1;
}
const b$l = n$2K(6.5), L$a = n$2K(1), S$f = n$2K(30), k$g = n$2K(1e3 / 30), O$h = n$2K(100), U$b = 0.9;
var N$e, P$f;
!function(n2) {
  class u2 {
    constructor() {
      this._updating = new t$Q(true), this._microTaskQueued = false, this._frameNumber = 0, this.performanceInfo = { total: new e$23("total"), tasks: new Map() }, this._frameTaskTimes = new Map(), this._budget = new g2(), this._state = I$g.INTERACTING, this._tasks = new l$2F(), this._runQueue = new l$2F(), this._load = 0, this._idleStateCallbacks = new l$2F(), this._idleUpdatesStartFired = false, this._maxReschedule = f$z, this._forceTask = false, this._debug = false, this._debugHandle = l$1P(() => p$10.SCHEDULER_LOG_SLOW_TASKS, (e3) => this._debug = e3, h$1j);
      for (const t2 of Object.keys(I$f))
        this.performanceInfo.tasks.set(I$f[t2], new e$23(I$f[t2]));
      const e2 = this;
      this._test = { FRAME_SAFETY_BUDGET: b$l, INTERACTING_BUDGET: k$g, IDLE_BUDGET: O$h, get availableBudget() {
        return e2._budget.budget;
      }, usedBudget: 0, getBudget: () => e2._budget, setBudget: (t2) => e2._budget = t2, updateTask: (e3) => this._updateTask(e3), getState: (e3) => this._getState(e3), getRuntime: (e3) => this._getRuntime(e3), frameTaskTimes: this._frameTaskTimes, resetRuntimes: () => this._resetRuntimes(), getRunning: () => this._getRunning() };
    }
    get updating() {
      return this._updating.get();
    }
    set updating(e2) {
      this._updating.set(e2);
    }
    destroy() {
      this._tasks.toArray().forEach((e2) => e2.remove()), this._tasks.clear(), h$1W(this._debugHandle), this._microTaskQueued = false, this._updating.set(false);
    }
    activate() {
      this._budget.done || this._microTaskQueued || (this._microTaskQueued = true, queueMicrotask(() => {
        this._microTaskQueued && (this._microTaskQueued = false, this._budget.done || (this._maxReschedule = f$z, this._schedule(), this.frame()));
      }));
    }
    registerTask(e2, t2) {
      const s2 = A$d(e2), i2 = new _2(this, e2, t2, s2);
      return this._tasks.push(i2), this.performanceInfo.tasks.has(e2) || this.performanceInfo.tasks.set(e2, new e$23(e2)), i2;
    }
    registerIdleStateCallbacks(e2, t2) {
      const s2 = { idleBegin: e2, idleEnd: t2 };
      this._idleStateCallbacks.push(s2), this.state === I$g.IDLE && this._idleUpdatesStartFired && s2.idleBegin();
      const i2 = this;
      return { remove: () => this._removeIdleStateCallbacks(s2), set idleBegin(e3) {
        i2._idleUpdatesStartFired && (s2.idleEnd(), i2._state === I$g.IDLE && e3()), s2.idleBegin = e3;
      }, set idleEnd(e3) {
        s2.idleEnd = e3;
      } };
    }
    get load() {
      return this._load;
    }
    set state(e2) {
      this._state !== e2 && (this._state = e2, this.state !== I$g.IDLE && this._idleUpdatesStartFired && (this._idleUpdatesStartFired = false, this._idleStateCallbacks.forAll((e3) => e3.idleEnd())));
    }
    get state() {
      return this._state;
    }
    updateBudget(e2) {
      this._test.usedBudget = 0, ++this._frameNumber;
      let t2 = b$l, s2 = e2.frameDuration, i2 = L$a;
      switch (this.state) {
        case I$g.IDLE:
          t2 = n$2K(0), s2 = n$2K(Math.max(O$h, e2.frameDuration)), i2 = S$f;
          break;
        case I$g.INTERACTING:
          s2 = n$2K(Math.max(k$g, e2.frameDuration));
        case I$g.ANIMATING:
      }
      return s2 = n$2K(s2 - e2.elapsedFrameTime - t2), this.state !== I$g.IDLE && s2 < L$a && !this._forceTask ? (this._forceTask = true, false) : (s2 = n$2K(Math.max(s2, i2)), this._budget.reset(s2, this.state), this._maxReschedule = f$z, this._updateLoad(), this._schedule());
    }
    frame() {
      switch (this._forceTask = false, this._microTaskQueued = false, this.state) {
        case I$g.IDLE:
          this._idleUpdatesStartFired || (this._idleUpdatesStartFired = true, this._idleStateCallbacks.forAll((e2) => e2.idleBegin())), this._runIdle();
          break;
        case I$g.INTERACTING:
          this._runInteracting();
          break;
        default:
          this._runAnimating();
      }
      this._test.usedBudget = this._budget.elapsed;
    }
    stopFrame() {
      this._budget.reset(n$2K(0), this._state), this._budget.madeProgress();
    }
    _removeIdleStateCallbacks(e2) {
      this._idleUpdatesStartFired && e2.idleEnd(), this._idleStateCallbacks.removeUnordered(e2);
    }
    removeTask(e2) {
      this._tasks.removeUnordered(e2), this._runQueue.removeUnordered(e2);
    }
    _updateTask(e2) {
      this._tasks.forAll((t2) => {
        t2.name === e2 && t2.setPriority(e2);
      });
    }
    _getState(e2) {
      if (this._runQueue.some((t3) => t3.name === e2))
        return P$f.SCHEDULED;
      let t2 = P$f.IDLE;
      return this._tasks.forAll((s2) => {
        s2.name === e2 && s2.needsUpdate && (s2.schedulePriority <= 1 ? t2 = P$f.READY : t2 !== P$f.READY && (t2 = P$f.WAITING));
      }), t2;
    }
    _getRuntime(e2) {
      let t2 = 0;
      return this._tasks.forAll((s2) => {
        s2.name === e2 && (t2 += s2.runtime);
      }), t2;
    }
    _resetRuntimes() {
      this._tasks.forAll((e2) => e2.runtime = 0);
    }
    _getRunning() {
      const e2 = new Map();
      if (this._tasks.forAll((t3) => {
        t3.needsUpdate && e2.set(t3.name, (e2.get(t3.name) || 0) + 1);
      }), e2.size === 0)
        return null;
      let t2 = "";
      return e2.forEach((e3, s2) => {
        t2 += e3 > 1 ? ` ${e3}x ${s2}` : ` ${s2}`;
      }), t2;
    }
    _runIdle() {
      this._run();
    }
    _runInteracting() {
      this._run();
    }
    _runAnimating() {
      this._run();
    }
    _updateLoad() {
      const e2 = this._tasks.reduce((e3, t2) => t2.needsUpdate ? ++e3 : e3, 0);
      this._load = this._load * U$b + e2 * (1 - U$b);
    }
    _schedule() {
      if (this._maxReschedule <= 0)
        return false;
      for (this._runQueue.filterInPlace((e2) => !!e2.needsUpdate || (e2.schedulePriority = e2.basePriority, false)), this._tasks.forAll((e2) => {
        e2.basePriority === R$c && e2.needsUpdate && !this._runQueue.includes(e2) && this._runQueue.unshift(e2);
      }); this._runQueue.length === 0; ) {
        let e2 = false, t2 = 0;
        if (this._tasks.forAll((s2) => {
          if (s2.needsUpdate && s2.schedulePriority !== 0 && s2.basePriority !== R$c && (!s2.task.runOncePerFrame || s2.lastFrameRun !== this._frameNumber))
            if (e2 = true, t2 = Math.max(t2, s2.basePriority), s2.schedulePriority === 1)
              s2.schedulePriority = 0, this._runQueue.push(s2);
            else
              --s2.schedulePriority;
        }), !e2)
          return this._updating.set(false), false;
        --this._maxReschedule;
      }
      return this._updating.set(true), true;
    }
    _run() {
      const e2 = this._budget.now();
      this._startFrameTaskTimes();
      do {
        for (; this._runQueue.length > 0; ) {
          const i2 = this._budget.now(), r2 = this._runQueue.pop();
          this._budget.resetProgress();
          try {
            r2.task.runTask(this._budget);
          } catch (s2) {
            s$2z.getLogger("esri.views.support.Scheduler").error(`Exception in task "${r2.name}"`, s2);
          }
          r2.schedulePriority = r2.basePriority, r2.lastFrameRun = this._frameNumber;
          const a2 = this._budget.now() - i2;
          if (r2.runtime += a2, this._frameTaskTimes.set(r2.priority, this._frameTaskTimes.get(r2.priority) + a2), this._debug && this._budget.elapsed > 2 * this._budget.budget && console.log("Task", r2.name, "used", this._budget.elapsed, "of max", this._budget.budget, "ms"), this._budget.remaining <= 0)
            return this._updating.set(this._tasks.some((e3) => e3.needsUpdate)), void this._recordFrameTaskTimes(this._budget.now() - e2);
        }
      } while (this._schedule());
      this._updating.set(this._tasks.some((e3) => e3.needsUpdate)), this._recordFrameTaskTimes(this._budget.now() - e2);
    }
    _startFrameTaskTimes() {
      for (const e2 of Object.keys(I$f))
        this._frameTaskTimes.set(I$f[e2], 0);
    }
    _recordFrameTaskTimes(e2) {
      this._frameTaskTimes.forEach((e3, t2) => this.performanceInfo.tasks.get(t2).record(e3)), this.performanceInfo.total.record(e2);
    }
    get test() {
      return this._test;
    }
  }
  n2.Scheduler = u2;
  class _2 {
    constructor(t2, s2, r2, a2) {
      this._scheduler = t2, this.name = s2, this._basePriority = a2, this.lastFrameRun = 0, this.runtime = 0, this._queue = new n$_(), this._handles = new t$2g(), this.schedulePriority = this._basePriority, this._task = new t$Q(r$1$(r2) ? r2 : this._queue), this._handles.add(f$1o(() => this.task.running, () => t2.activate()));
    }
    get task() {
      return this._task.get();
    }
    get updating() {
      return this._queue.running;
    }
    remove() {
      this.processQueue(F$g), this._scheduler.removeTask(this), this.schedule = y$o.schedule, this.reschedule = y$o.reschedule, this._handles.destroy();
    }
    get basePriority() {
      return this._basePriority;
    }
    setPriority(e2) {
      this.name = e2;
      const t2 = A$d(e2);
      this._basePriority !== R$c && this.schedulePriority === 0 || (this.schedulePriority = t2), this._basePriority = t2;
    }
    get priority() {
      return this.name;
    }
    set priority(e2) {
      this.setPriority(e2);
    }
    get needsUpdate() {
      return this.updating || this.task.running;
    }
    schedule(e2, t2, s2) {
      return this._queue.push(e2, t2, s2);
    }
    reschedule(e2, t2, s2) {
      return this._queue.unshift(e2, t2, s2);
    }
    processQueue(e2) {
      this._queue.runTask(e2);
    }
  }
  class g2 {
    constructor() {
      this._begin = typeof performance != "undefined" ? performance.now() : 0, this._budget = 0, this._state = I$g.IDLE, this._done = false, this._enabled = true;
    }
    run(e2) {
      return !this.done && (e2() === true && this.madeProgress(), true);
    }
    get done() {
      return this._done;
    }
    get budget() {
      return this._budget;
    }
    madeProgress() {
      this._done = this.elapsed >= this._budget && this._enabled;
    }
    get state() {
      return this._state;
    }
    get enabled() {
      return this._enabled;
    }
    set enabled(e2) {
      this._enabled = e2;
    }
    reset(e2, t2) {
      this._begin = this.now(), this._budget = e2, this._state = t2, this._done = false;
    }
    get remaining() {
      return Math.max(this._budget - this.elapsed, 0);
    }
    now() {
      return performance.now();
    }
    get elapsed() {
      return performance.now() - this._begin;
    }
    resetProgress() {
      this._done = false;
    }
    get hasProgressed() {
      return this._done;
    }
  }
  n2.Budget = g2;
}(N$e || (N$e = {})), function(e2) {
  e2.SCHEDULED = "s", e2.READY = "r", e2.WAITING = "w", e2.IDLE = "i";
}(P$f || (P$f = {}));
const F$g = (() => {
  const e2 = new N$e.Budget();
  return e2.enabled = false, e2;
})();
class C$h {
  remove() {
  }
  processQueue() {
  }
  schedule(e2, t2, s2) {
    try {
      if (p$3D(t2)) {
        const e3 = a$2T();
        return s2 ? Promise.resolve(s2(e3)) : Promise.reject(e3);
      }
      return $$l(e2(F$g));
    } catch (i2) {
      return Promise.reject(i2);
    }
  }
  reschedule(e2, t2, s2) {
    return this.schedule(e2, t2, s2);
  }
}
const y$o = new C$h();
let n$Z = class extends m$2q {
  constructor(e2, t2) {
    var _a2;
    super({}), this._stage = e2, this._textureRequests = new Map(), this._frameTask = (_a2 = t2 == null ? void 0 : t2.registerTask(I$f.TEXTURE_UNLOAD)) != null ? _a2 : y$o;
  }
  normalizeCtorArgs() {
    return {};
  }
  destroy() {
    super.destroy(), this._frameTask.remove(), this._textureRequests.forEach((e2) => this._releaseTextureRequest(e2)), this._textureRequests.clear();
  }
  get updating() {
    return this._frameTask.updating;
  }
  fromData(e2, t2, r2) {
    const s2 = this.makeUid(e2);
    let o2 = this._textureRequests.get(s2);
    return o2 || (o2 = { referenceCount: 0, texture: t2(), textureAsync: null, abortController: null, onRemove: r2 }, this._stage && (this._stage.add(o2.texture), this._stage.loadImmediate(o2.texture)), this._textureRequests.set(s2, o2)), o2.referenceCount++, { uid: s2, texture: o2.texture, release: () => this._release(s2) };
  }
  _release(e2) {
    const t2 = this._textureRequests.get(e2);
    t2 ? (t2.referenceCount < 1 && console.warn("TextureCollection: reference count is < 1 for " + e2), t2.referenceCount--, t2.referenceCount < 1 && this._frameTask.schedule(() => this._releaseNow(e2))) : console.warn(`TextureCollection: texture doesn't exist: '${e2}'`);
  }
  get test() {
    return { textureRequests: this._textureRequests };
  }
  _releaseNow(e2) {
    if (!this._textureRequests)
      return;
    const t2 = this._textureRequests.get(e2);
    !t2 || t2.referenceCount > 0 || (this._releaseTextureRequest(t2), this._textureRequests.delete(e2));
  }
  _releaseTextureRequest(e2) {
    var _a2;
    e2.onRemove && e2.onRemove(), e2.texture ? (_a2 = this._stage) == null ? void 0 : _a2.remove(e2.texture) : e2.abortController && (e2.abortController.abort(), e2.abortController = null);
  }
  makeUid(e2, t2 = null) {
    return r$1$(t2) ? `${e2}.${t2}px` : e2;
  }
};
e$2g([y$1I()], n$Z.prototype, "_frameTask", void 0), e$2g([y$1I()], n$Z.prototype, "updating", null), n$Z = e$2g([n$2P("esri.views.3d.support.TextureCollection")], n$Z);
var t$J;
!function(t2) {
  t2[t2.Left = 0] = "Left", t2[t2.Middle = 1] = "Middle", t2[t2.Right = 2] = "Right";
}(t$J || (t$J = {}));
const r$S = ["click", "double-click", "immediate-click", "immediate-double-click", "hold", "drag", "key-down", "key-up", "pointer-down", "pointer-move", "pointer-up", "pointer-drag", "mouse-wheel", "pointer-enter", "pointer-leave", "gamepad", "focus", "blur"], i$11 = {};
function o$O(t2) {
  return !!i$11[t2];
}
function s$P(t2) {
  for (const e2 of t2)
    if (!o$O(e2))
      return false;
  return true;
}
r$S.forEach((t2) => {
  i$11[t2] = true;
});
class p$_ {
  constructor(t2) {
    this._handlers = new Map(), this._counter = 0, this._handlerCounts = new Map(), this.view = t2, this.inputManager = null;
  }
  connect(t2) {
    t2 && this.disconnect(), this.inputManager = t2, this._handlers.forEach(({ handler: t3, priority: e2 }, a2) => this.inputManager.installHandlers(a2, [t3], e2));
  }
  disconnect() {
    this.inputManager && this._handlers.forEach((t2, e2) => this.inputManager.uninstallHandlers(e2)), this.inputManager = null;
  }
  destroy() {
    this.disconnect(), this._handlers.clear(), this.view = null;
  }
  on(t2, e2, a2, r2) {
    const i2 = Array.isArray(t2) ? t2 : t2.split(",");
    if (!s$P(i2))
      return i2.some(o$O) && console.error("Error: registering input events and other events on the view at the same time is not supported."), null;
    let p2, l2;
    Array.isArray(e2) ? l2 = e2 : (p2 = e2, l2 = []), typeof a2 == "function" ? p2 = a2 : r2 = a2, r2 = r2 != null ? r2 : P$h.DEFAULT;
    const u2 = this._createUniqueGroupName(), m2 = new c$Y(this.view, i2, l2, p2);
    this._handlers.set(u2, { handler: m2, priority: r2 });
    for (const n2 of i2) {
      const t3 = this._handlerCounts.get(n2) || 0;
      this._handlerCounts.set(n2, t3 + 1);
    }
    return this.inputManager && this.inputManager.installHandlers(u2, [m2], r2), { remove: () => this._removeHandler(u2, i2) };
  }
  hasHandler(t2) {
    return !!this._handlerCounts.get(t2);
  }
  _removeHandler(t2, e2) {
    if (this._handlers.has(t2)) {
      this._handlers.delete(t2);
      for (const t3 of e2) {
        const e3 = this._handlerCounts.get(t3);
        e3 === void 0 ? console.error("Trying to remove handler for event that has no handlers registered: ", t3) : e3 === 1 ? this._handlerCounts.delete(t3) : this._handlerCounts.set(t3, e3 - 1);
      }
    }
    this.inputManager && this.inputManager.uninstallHandlers(t2);
  }
  _createUniqueGroupName() {
    return this._counter += 1, `viewEvents_${this._counter}`;
  }
}
class c$Y extends i$1b {
  constructor(t2, e2, a2, n2) {
    super(true), this.view = t2;
    for (const r2 of e2)
      switch (r2) {
        case "click":
          this.registerIncoming("click", a2, (t3) => n2(this._wrapClick(t3)));
          break;
        case "double-click":
          this.registerIncoming("double-click", a2, (t3) => n2(this._wrapDoubleClick(t3)));
          break;
        case "immediate-click":
          this.registerIncoming("immediate-click", a2, (t3) => n2(this._wrapImmediateClick(t3)));
          break;
        case "immediate-double-click":
          this.registerIncoming("immediate-double-click", a2, (t3) => n2(this._wrapImmediateDoubleClick(t3)));
          break;
        case "hold":
          this.registerIncoming("hold", a2, (t3) => n2(this._wrapHold(t3)));
          break;
        case "drag":
          this.registerIncoming("drag", a2, (t3) => {
            const e3 = this._wrapDrag(t3);
            e3 && n2(e3);
          });
          break;
        case "key-down":
          this.registerIncoming("key-down", a2, (t3) => n2(this._wrapKeyDown(t3)));
          break;
        case "key-up":
          this.registerIncoming("key-up", a2, (t3) => n2(this._wrapKeyUp(t3)));
          break;
        case "pointer-down":
          this.registerIncoming("pointer-down", a2, (t3) => n2(this._wrapPointer(t3, "pointer-down")));
          break;
        case "pointer-move":
          this.registerIncoming("pointer-move", a2, (t3) => n2(this._wrapPointer(t3, "pointer-move")));
          break;
        case "pointer-up":
          this.registerIncoming("pointer-up", a2, (t3) => n2(this._wrapPointer(t3, "pointer-up")));
          break;
        case "pointer-drag":
          this.registerIncoming("pointer-drag", a2, (t3) => n2(this._wrapPointerDrag(t3)));
          break;
        case "mouse-wheel":
          this.registerIncoming("mouse-wheel", a2, (t3) => n2(this._wrapMouseWheel(t3)));
          break;
        case "pointer-enter":
          this.registerIncoming("pointer-enter", a2, (t3) => n2(this._wrapPointer(t3, "pointer-enter")));
          break;
        case "pointer-leave":
          this.registerIncoming("pointer-leave", a2, (t3) => n2(this._wrapPointer(t3, "pointer-leave")));
          break;
        case "gamepad":
          this.registerIncoming("gamepad", a2, (t3) => {
            n2(this._wrapGamepad(t3));
          });
          break;
        case "focus":
          this.registerIncoming("focus", a2, (t3) => {
            n2(this._wrapFocus(t3));
          });
          break;
        case "blur":
          this.registerIncoming("blur", a2, (t3) => {
            n2(this._wrapBlur(t3));
          });
      }
  }
  _wrapFocus(t2) {
    return { type: "focus", timestamp: t2.timestamp, native: t2.data.native, cancelable: t2.cancelable, stopPropagation: () => t2.stopPropagation(), async: (e2) => t2.async(e2), preventDefault: () => t2.preventDefault() };
  }
  _wrapBlur(t2) {
    return { type: "blur", timestamp: t2.timestamp, native: t2.data.native, cancelable: t2.cancelable, stopPropagation: () => t2.stopPropagation(), async: (e2) => t2.async(e2), preventDefault: () => t2.preventDefault() };
  }
  _wrapClick(t2) {
    const { pointerType: a2, button: n2, buttons: r2, x: i2, y: o2, native: s2, eventId: p2 } = t2.data, { cancelable: c2, timestamp: l2 } = t2;
    return { type: "click", pointerType: a2, button: n2, buttons: r2, x: i2, y: o2, native: s2, timestamp: l2, screenPoint: c$2K(i2, o2), mapPoint: this._getMapPoint(i2, o2), eventId: p2, cancelable: c2, stopPropagation: () => t2.stopPropagation(), async: (e2) => t2.async(e2), preventDefault: () => t2.preventDefault() };
  }
  _wrapDoubleClick(t2) {
    const { pointerType: e2, button: a2, buttons: n2, x: r2, y: i2, native: o2, eventId: s2 } = t2.data, { cancelable: p2, timestamp: c2 } = t2;
    return { type: "double-click", pointerType: e2, button: a2, buttons: n2, x: r2, y: i2, native: o2, timestamp: c2, mapPoint: this._getMapPoint(r2, i2), eventId: s2, cancelable: p2, stopPropagation: () => t2.stopPropagation(), async: (e3) => t2.async(e3), preventDefault: () => t2.preventDefault() };
  }
  _wrapImmediateClick(t2) {
    const { pointerType: e2, button: a2, buttons: n2, x: r2, y: i2, native: o2, eventId: s2 } = t2.data, p2 = o2.pointerId, { cancelable: c2, timestamp: l2 } = t2;
    return { type: "immediate-click", pointerId: p2, pointerType: e2, button: a2, buttons: n2, x: r2, y: i2, native: o2, timestamp: l2, mapPoint: this._getMapPoint(r2, i2), eventId: s2, cancelable: c2, stopPropagation: () => t2.stopPropagation(), async: (e3) => t2.async(e3), preventDefault: () => t2.preventDefault() };
  }
  _wrapImmediateDoubleClick(t2) {
    const { pointerType: e2, button: a2, buttons: n2, x: r2, y: i2, native: o2, eventId: s2 } = t2.data, p2 = o2.pointerId, { cancelable: c2, timestamp: l2 } = t2;
    return { type: "immediate-double-click", pointerId: p2, pointerType: e2, button: a2, buttons: n2, x: r2, y: i2, native: o2, timestamp: l2, mapPoint: this._getMapPoint(r2, i2), eventId: s2, cancelable: c2, stopPropagation: () => t2.stopPropagation(), async: (e3) => t2.async(e3), preventDefault: () => t2.preventDefault() };
  }
  _wrapHold(t2) {
    const { pointerType: e2, button: a2, buttons: n2, x: r2, y: i2, native: o2 } = t2.data, { cancelable: s2, timestamp: p2 } = t2;
    return { type: "hold", pointerType: e2, button: a2, buttons: n2, x: r2, y: i2, native: o2, timestamp: p2, mapPoint: this._getMapPoint(r2, i2), cancelable: s2, stopPropagation: () => t2.stopPropagation(), async: (e3) => t2.async(e3), preventDefault: () => t2.preventDefault() };
  }
  _getMapPoint(t2, a2) {
    return this.view.toMap(c$2K(t2, a2), { exclude: [] });
  }
  _wrapDrag(e2) {
    const a2 = e2.data, { x: n2, y: r2 } = a2.center, { action: i2, pointerType: o2, button: s2 } = a2;
    if (i2 === "start" && (this._latestDragStart = a2), !this._latestDragStart)
      return;
    const p2 = a2.pointer.native, c2 = a2.buttons, { cancelable: l2, timestamp: u2 } = e2, m2 = { x: this._latestDragStart.center.x, y: this._latestDragStart.center.y };
    return i2 === "end" && (this._latestDragStart = void 0), { type: "drag", action: i2, x: n2, y: r2, origin: m2, pointerType: o2, button: s2, buttons: c2, radius: a2.radius, angle: b$10(a2.angle), native: p2, timestamp: u2, cancelable: l2, stopPropagation: () => e2.stopPropagation(), async: (t2) => e2.async(t2), preventDefault: () => e2.preventDefault() };
  }
  _wrapKeyDown(t2) {
    const { key: e2, repeat: a2, native: n2 } = t2.data, { cancelable: r2, timestamp: i2 } = t2;
    return { type: "key-down", key: e2, repeat: a2, native: n2, timestamp: i2, cancelable: r2, stopPropagation: () => t2.stopPropagation(), async: (e3) => t2.async(e3), preventDefault: () => t2.preventDefault() };
  }
  _wrapKeyUp(t2) {
    const { key: e2, native: a2 } = t2.data, { cancelable: n2, timestamp: r2 } = t2;
    return { type: "key-up", key: e2, native: a2, timestamp: r2, cancelable: n2, stopPropagation: () => t2.stopPropagation(), async: (e3) => t2.async(e3), preventDefault: () => t2.preventDefault() };
  }
  _wrapPointer(t2, e2) {
    const { x: a2, y: n2, button: r2, buttons: i2, native: o2, eventId: s2 } = t2.data, p2 = o2.pointerId, c2 = o2.pointerType, { cancelable: l2, timestamp: u2 } = t2;
    return { type: e2, x: a2, y: n2, pointerId: p2, pointerType: c2, button: r2, buttons: i2, native: o2, timestamp: u2, eventId: s2, cancelable: l2, stopPropagation: () => t2.stopPropagation(), async: (e3) => t2.async(e3), preventDefault: () => t2.preventDefault() };
  }
  _wrapPointerDrag(t2) {
    const { x: e2, y: a2, buttons: n2, native: r2, eventId: i2 } = t2.data.currentEvent, { button: o2 } = t2.data.startEvent, s2 = t2.data.startEvent.native.pointerId, p2 = t2.data.startEvent.native.pointerType, c2 = t2.data.action, l2 = { x: t2.data.startEvent.x, y: t2.data.startEvent.y }, { cancelable: u2, timestamp: m2 } = t2;
    return { type: "pointer-drag", x: e2, y: a2, pointerId: s2, pointerType: p2, button: o2, buttons: n2, action: c2, origin: l2, native: r2, timestamp: m2, eventId: i2, cancelable: u2, stopPropagation: () => t2.stopPropagation(), async: (e3) => t2.async(e3), preventDefault: () => t2.preventDefault() };
  }
  _wrapMouseWheel(t2) {
    const { cancelable: e2, data: a2, timestamp: n2 } = t2, { x: r2, y: i2, deltaY: o2, native: s2 } = a2;
    return { type: "mouse-wheel", x: r2, y: i2, deltaY: o2, native: s2, timestamp: n2, cancelable: e2, stopPropagation: () => t2.stopPropagation(), async: (e3) => t2.async(e3), preventDefault: () => t2.preventDefault() };
  }
  _wrapGamepad(t2) {
    const { action: e2, state: a2, device: n2 } = t2.data, { cancelable: r2, timestamp: i2 } = t2, { buttons: o2, axes: s2 } = a2;
    return { type: "gamepad", device: n2, timestamp: i2, action: e2, buttons: o2, axes: s2, cancelable: r2, stopPropagation: () => t2.stopPropagation(), async: (e3) => t2.async(e3), preventDefault: () => t2.preventDefault() };
  }
}
var o$N, t$I, u$G;
!function(o2) {
  o2[o2.USER = 0] = "USER", o2[o2.MANAGER = 1] = "MANAGER";
}(o$N || (o$N = {})), function(o2) {
  o2[o2.None = 0] = "None", o2[o2.Unfocused = 1] = "Unfocused", o2[o2.Focused = 2] = "Focused", o2[o2.Unselected = 4] = "Unselected", o2[o2.Selected = 8] = "Selected", o2[o2.All = 15] = "All";
}(t$I || (t$I = {})), function(o2) {
  o2[o2.None = 0] = "None", o2[o2.Custom1 = 16] = "Custom1", o2[o2.Custom2 = 32] = "Custom2", o2[o2.Custom3 = 64] = "Custom3", o2[o2.Custom4 = 128] = "Custom4", o2[o2.Custom5 = 256] = "Custom5", o2[o2.Custom6 = 512] = "Custom6", o2[o2.Custom7 = 1024] = "Custom7", o2[o2.Custom8 = 2048] = "Custom8", o2[o2.Custom9 = 4096] = "Custom9", o2[o2.Custom10 = 8192] = "Custom10", o2[o2.Custom11 = 16384] = "Custom11", o2[o2.Custom12 = 32768] = "Custom12", o2[o2.All = 65520] = "All";
}(u$G || (u$G = {}));
function o$M(t2) {
  return [t2.on("before-add", (o2) => {
    const i2 = o2.item;
    if (i2 == null || t2.includes(i2))
      return s$2z.getLogger("esri.views.interactive.interactiveToolUtils").warn("Tool is either already in the list of tools or tool is `null`. Not adding tool."), void o2.preventDefault();
    i2.onAdd();
  }), t2.on("after-remove", (e2) => {
    const t3 = e2.item;
    t3.active && (t3.view.activeTool = null), t3.destroy();
  })];
}
function i$10(e2) {
  return e2.visible && e2.getEditableFlag(o$N.USER) && e2.getEditableFlag(o$N.MANAGER);
}
function n$Y(t2) {
  return c$2K(t2.x, t2.y);
}
function i$$(t2, n2) {
  const c2 = (t2 instanceof HTMLElement ? t2 : t2.surface).getBoundingClientRect();
  return c$2K(n2.clientX - c2.left, n2.clientY - c2.top);
}
function r$R(e2, t2) {
  return t2 instanceof Event ? i$$(e2, t2) : n$Y(t2);
}
function o$L(e2) {
  if (e2 instanceof Event)
    return true;
  if (typeof e2 == "object" && "type" in e2) {
    switch (e2.type) {
      case "click":
      case "double-click":
      case "pointer-down":
      case "pointer-drag":
      case "pointer-enter":
      case "pointer-leave":
      case "pointer-up":
      case "pointer-move":
      case "immediate-click":
      case "immediate-double-click":
      case "hold":
      case "drag":
      case "mouse-wheel":
        return true;
      default:
        return false;
    }
  }
  return false;
}
class c$X {
  constructor() {
    this._pointerLocations = new Map(), this._hoveredManipulators = new Map(), this._grabbedManipulators = new Map(), this._draggedManipulators = new Map(), this._stopDrag = false, this._revertToNullActiveTool = false, this._cursor = null;
  }
  get cursor() {
    return this._cursor;
  }
  handleInputEvent(t2, e2) {
    const s2 = () => t2.stopPropagation();
    switch (t2.type) {
      case "pointer-move":
        u$F(t2.pointerType) && this._pointerLocations.set(t2.pointerId, { x: t2.x, y: t2.y, pointerType: t2.pointerType });
        break;
      case "drag":
        this._grabbedManipulators.size > 0 && (this._stopDrag = true), this._stopDrag && (s2(), t2.action === "end" && (this._stopDrag = false));
        break;
      case "pointer-down": {
        if (!h$F(t2))
          break;
        const o2 = n$Y(t2), a2 = this._intersect(o2, t2.pointerType, e2.forEachTool);
        if (t$2r(a2))
          break;
        const n2 = a2.manipulator, p2 = a2.tool;
        !(r$1$(n2) && r$1$(p2) && n2.interactive) || n2.grabbable && n2.grabbableForEvent(t2) || !n2.grabbing || n2.dragging || this._ungrabManipulatorBeforeDragging(n2, t2, e2), r$1$(n2) && r$1$(p2) && n2.interactive && n2.grabbable && n2.grabbableForEvent(t2) && !n2.grabbing && (this._grabbedManipulators.set(t2.pointerId, { manipulator: n2, tool: p2, start: o2, pointerType: t2.pointerType }), this._grabbedManipulators.size === 1 && t$2r(e2.activeTool) && (this._revertToNullActiveTool = true, e2.setActiveTool(a2.tool)), n2.grabbing = true, n2.events.emit("grab-changed", { action: "start", pointerType: t2.pointerType, screenPoint: o2 }), s2());
        break;
      }
      case "pointer-up":
        this._draggedManipulators.has(t2.pointerId) || this._handlePointerEnd(t2, e2);
        break;
      case "pointer-drag": {
        if (!h$F(t2))
          break;
        const r2 = this._grabbedManipulators.get(t2.pointerId), p2 = o$2s(r2, ({ manipulator: t3 }) => t3), c2 = o$2s(r2, ({ tool: t3 }) => t3);
        if (t$2r(p2) || t$2r(c2))
          break;
        const u2 = n$Y(t2);
        u2.x = a$2v(u2.x, 0, e2.view.width), u2.y = a$2v(u2.y, 0, e2.view.height);
        const d2 = e$2e(r2).start, g2 = this._draggedManipulators.get(t2.pointerId);
        switch (t2.action) {
          case "start":
          case "update":
            t2.action !== "update" && this._grabbedManipulators.size !== 1 || (p2.dragging = true, g2 ? p2.events.emit("drag", { action: "update", start: d2, screenPoint: u2 }) : p2.events.emit("drag", { action: "start", start: d2, screenPoint: u2, pointerType: t2.pointerType }), this._draggedManipulators.set(t2.pointerId, { tool: c2, manipulator: p2, start: d2 }));
            break;
          case "end":
            p2.dragging = false, g2 && p2.events.emit("drag", { action: "end", start: d2, screenPoint: u2 }), this._draggedManipulators.delete(t2.pointerId), this._handlePointerEnd(t2, e2);
        }
        s2();
        break;
      }
      case "immediate-click": {
        const o2 = n$Y(t2), a2 = this._intersect(o2, t2.pointerType, e2.forEachTool);
        if (d$v(t2) || e2.forEachTool((t3) => {
          if ((!r$1$(a2) || a2.tool !== t3 || t3.automaticManipulatorSelection) && t3.manipulators) {
            let e3 = false;
            t3.manipulators.forEach(({ manipulator: t4 }) => {
              t4.selected && (t4.selected = false, e3 = true);
            }), e3 && t3.onManipulatorSelectionChanged && t3.onManipulatorSelectionChanged();
          }
        }), t$2r(a2))
          break;
        const { manipulator: n2, tool: p2 } = a2;
        if (!n2.interactive)
          break;
        n2.selectable && p2.automaticManipulatorSelection && (n2.selected = !n2.selected, p2.onManipulatorSelectionChanged && p2.onManipulatorSelectionChanged());
        const c2 = t2.native.shiftKey;
        n2.events.emit("immediate-click", { screenPoint: o2, button: t2.button, pointerType: t2.pointerType, shiftKey: c2, stopPropagation: s2 });
        break;
      }
      case "click": {
        const o2 = n$Y(t2), a2 = this._intersect(o2, t2.pointerType, e2.forEachTool), n2 = r$1$(a2) ? a2.manipulator : null;
        if (t$2r(n2) || !n2.interactive)
          break;
        const p2 = t2.native.shiftKey;
        n2.events.emit(t2.type, { screenPoint: o2, button: t2.button, pointerType: t2.pointerType, shiftKey: p2 }), s2();
        break;
      }
      case "double-click": {
        const o2 = n$Y(t2), a2 = this._intersect(o2, t2.pointerType, e2.forEachTool), n2 = r$1$(a2) ? a2.manipulator : null;
        if (t$2r(n2) || !n2.interactive)
          break;
        const p2 = t2.native.shiftKey;
        n2.events.emit("double-click", { screenPoint: o2, button: t2.button, pointerType: t2.pointerType, shiftKey: p2, stopPropagation: s2 });
        break;
      }
      case "immediate-double-click": {
        const o2 = n$Y(t2), a2 = this._intersect(o2, t2.pointerType, e2.forEachTool), n2 = r$1$(a2) ? a2.manipulator : null;
        if (t$2r(n2) || !n2.interactive)
          break;
        const p2 = t2.native.shiftKey;
        n2.events.emit("immediate-double-click", { screenPoint: o2, button: t2.button, pointerType: t2.pointerType, shiftKey: p2, stopPropagation: s2 });
        break;
      }
    }
    this._onFocusChange(e2.forEachTool);
  }
  _ungrabManipulatorBeforeDragging(t2, e2, o2) {
    t2.grabbing = false, t2.events.emit("grab-changed", { action: "end", pointerType: e2.pointerType, screenPoint: n$Y(e2) }), this._grabbedManipulators.forEach(({ manipulator: e3 }, o3) => {
      e3 === t2 && this._grabbedManipulators.delete(o3);
    }), this._afterManipulatorUngrab(o2.setActiveTool);
  }
  _handlePointerEnd(t2, e2) {
    const o2 = o$2s(this._grabbedManipulators.get(t2.pointerId), ({ manipulator: t3 }) => t3);
    t$2r(o2) || o2.grabbing && (o2.grabbing = false, o2.events.emit("grab-changed", { action: "end", pointerType: t2.pointerType, screenPoint: n$Y(t2) }), this._grabbedManipulators.delete(t2.pointerId), this._afterManipulatorUngrab(e2.setActiveTool));
  }
  _cursorFromMap(t2) {
    let o2 = null;
    return n$2V(t2, ({ manipulator: t3 }) => !(t$2r(t3) || !t3.interactive) && (t3.grabbing && t3.grabCursor ? (o2 = t3.grabCursor, true) : !!t3.cursor && (o2 = t3.cursor, true))), o2;
  }
  _onFocusChange(t2) {
    this._updateCursor(), this._updateFocusedManipulatorTools(t2);
  }
  _updateCursor() {
    this._grabbedManipulators.size > 0 ? this._cursor = this._cursorFromMap(this._grabbedManipulators) || "grabbing" : this._hoveredManipulators.size > 0 ? this._cursor = this._cursorFromMap(this._hoveredManipulators) || "pointer" : this._cursor = null;
  }
  _updateFocusedManipulatorTools(e2) {
    const o2 = new Set(), i2 = new Set();
    this._grabbedManipulators.forEach(({ tool: t2 }) => {
      o2.add(t2);
    }), this._hoveredManipulators.forEach(({ tool: t2 }) => {
      i2.add(t2);
    }), e2((e3) => {
      e3.hasGrabbedManipulators = o2.has(e3), e3.hasHoveredManipulators = i2.has(e3);
      const a2 = this._grabbedManipulators.values(), n2 = o$2f(a2, ({ tool: t2 }) => t2 === e3);
      e3.firstGrabbedManipulator = r$1$(n2) ? n2.manipulator : null;
    });
  }
  clearPointers(t2, { forEachTool: e2, setActiveTool: o2 }, r2 = true, a2) {
    const n2 = (e3, o3) => e3 === t2 && (t$2r(a2) || a2 === o3);
    this._grabbedManipulators.forEach(({ tool: t3, manipulator: e3, pointerType: o3 }, r3) => {
      n2(t3, e3) && (this._grabbedManipulators.delete(r3), e3.grabbing = false, e3.events.emit("grab-changed", { action: "end", screenPoint: null, pointerType: o3 }));
    }), this._draggedManipulators.forEach(({ tool: t3, manipulator: e3 }, o3) => {
      n2(t3, e3) && (this._draggedManipulators.delete(o3), e3.dragging = false, e3.events.emit("drag", { action: "cancel" }));
    }), r2 && this._hoveredManipulators.forEach(({ tool: t3, manipulator: e3 }, o3) => {
      n2(t3, e3) && (this._hoveredManipulators.delete(o3), e3.hovering = false);
    }), this._afterManipulatorUngrab(o2), this._onFocusChange(e2);
  }
  _intersect(t2, e2, o2) {
    let r2 = null;
    return o2((o3) => {
      if (o3.manipulators == null || !i$10(o3))
        return false;
      const a2 = o3.manipulators.intersect(t2, e2);
      return !t$2r(a2) && (r2 = { tool: o3, manipulator: a2 }, true);
    }), r2;
  }
  updateHoveredStateFromKnownPointers(t2) {
    this._pointerLocations.forEach((e2, o2) => {
      this._updateHoveredStateForPointerAtScreenPosition(c$2K(e2.x, e2.y), o2, e2.pointerType, t2);
    });
  }
  handleHoverEvent(t2, e2) {
    t2.type !== "pointer-up" && t2.type !== "immediate-click" && t2.type !== "pointer-move" || !u$F(t2.pointerType) || this._updateHoveredStateForPointerAtScreenPosition(n$Y(t2), t2.pointerId, t2.pointerType, e2);
  }
  _updateHoveredStateForPointerAtScreenPosition(t2, e2, o2, i2) {
    let n2 = this._intersect(t2, o2, i2);
    const s2 = o$2s(this._hoveredManipulators.get(e2), ({ manipulator: t3 }) => t3);
    r$1$(n2) && !n2.manipulator.interactive && (n2 = null), r$1$(n2) && s2 === n2.manipulator || (r$1$(s2) && (s2.hovering = false), r$1$(n2) ? (n2.manipulator.hovering = true, this._hoveredManipulators.set(e2, n2)) : this._hoveredManipulators.delete(e2), this._onFocusChange(i2));
  }
  _afterManipulatorUngrab(t2) {
    this._grabbedManipulators.size === 0 && this._revertToNullActiveTool && (t2(null), this._revertToNullActiveTool = false);
  }
}
function u$F(t2) {
  return t2 === "mouse";
}
function h$F(t2) {
  return t2.pointerType !== "mouse" || t2.button === 0;
}
function d$v(t2) {
  return !!t2.native.shiftKey;
}
const g$o = "attached", E$m = "tools";
let w$i = class extends d$18 {
  constructor(t2) {
    super(t2), this._manipulatorState = new c$X(), this.tools = new j$V(), this.cursor = null, this._forEachTool = (t3) => {
      for (const o2 of this.tools.items)
        if (t3(o2))
          return;
    };
  }
  initialize() {
    this.handles.add([this.view.on(r$S, (t2) => {
      this._handleInputEvent(t2);
    }, P$h.TOOL), ...o$M(this.tools), this.tools.on("before-add", ({ item: t2 }) => {
      this._updateToolEditableFlag(t2);
    }), this.tools.on("before-remove", ({ item: t2 }) => {
      this._manipulatorState.clearPointers(t2, this._manipulatorStateEventArgs), this._updateCursor();
    }), this.tools.on("change", () => {
      this._refreshToolWatchers();
    })]);
  }
  destroy() {
    this.detach(), this.handles.removeAll();
  }
  get _manipulatorStateEventArgs() {
    return { forEachTool: this._forEachTool, activeTool: this.activeTool, setActiveTool: (t2) => {
      this.activeTool = t2;
    }, view: this.view };
  }
  set activeTool(t2) {
    if (r$1$(t2) && !this.view.ready)
      return void s$2z.getLogger(this.declaredClass).error("Cannot set active tool while view is not ready.");
    if (t2 === this.activeTool)
      return;
    const o2 = this.activeTool;
    this._set("activeTool", t2), r$1$(o2) && o2.deactivate(), r$1$(t2) && t2.activate(), this._removeIncompleteTools(t2);
    for (const e2 of this.tools) {
      this._updateToolEditableFlag(e2);
      const t3 = i$10(e2);
      !t$2r(this.activeTool) && t3 || this._manipulatorState.clearPointers(e2, this._manipulatorStateEventArgs, !t3);
    }
    this._updateCursor();
  }
  get updating() {
    var _a2, _b2;
    return this.updatingHandles.updating || this.tools.some((t2) => t2.updating) || ((_b2 = (_a2 = this.textures) == null ? void 0 : _a2.updating) != null ? _b2 : false);
  }
  attach() {
    this.view.type === "3d" ? (this._set("textures", new n$Z(this.view._stage, this.view.resourceController.scheduler)), this.handles.add([l$1P(() => {
      const { state: t2 } = this.view;
      return "camera" in t2 && t2.camera;
    }, () => {
      this._forEachManipulator((t2) => {
        t2.onViewChange != null && t2.onViewChange();
      });
    }), this.view.elevationProvider.on("elevation-change", (t2) => {
      this._forEachManipulator((o2) => {
        o2.onElevationChange != null && o2.onElevationChange(t2);
      });
    }), n$2U(() => this._set("textures", s$2D(this.textures)))], g$o)) : this.handles.add(l$1P(() => this.view.extent, () => {
      this._forEachManipulator((t2) => {
        t2.onViewChange != null && t2.onViewChange();
      });
    }));
  }
  detach() {
    r$1$(this.activeTool) && (this.activeTool = null), this.tools.removeAll(), this.handles.remove(g$o);
  }
  _forEachManipulator(t2) {
    this._forEachTool((o2) => {
      o2.manipulators && o2.manipulators.forEach(({ manipulator: e2 }) => t2(e2, o2));
    });
  }
  _handleInputEvent(t2) {
    let o2 = false;
    const e2 = __spreadProps(__spreadValues({}, t2), { stopPropagation: () => {
      o2 = true, t2.stopPropagation();
    } });
    r$1$(this.activeTool) ? this.activeTool.handleInputEvent && this.activeTool.handleInputEvent(e2) : this._forEachTool((t3) => {
      !o2 && t3.visible && t3.handleInputEvent(e2);
    }), !o2 && t2.type === "key-down" && t2.key === "Escape" && this.activeTool && (t2.stopPropagation(), this.activeTool = null), this._manipulatorState.handleInputEvent(e2, this._manipulatorStateEventArgs), !o2 && r$1$(this.activeTool) && this.activeTool.handleInputEventAfter(e2), this._manipulatorState.handleHoverEvent(e2, this._forEachTool), this._updateCursor();
  }
  _refreshToolWatchers() {
    this.handles.remove(E$m), this._forEachTool((t2) => {
      if (t2 instanceof m$2q) {
        const o2 = l$1P(() => [t2.cursor, t2.visible, t2.editable], () => {
          i$10(t2) || this._manipulatorState.clearPointers(t2, this._manipulatorStateEventArgs), this._updateCursor();
        });
        this.handles.add(o2, E$m);
      }
      t2.manipulators && this.handles.add([t2.manipulators.on("after-remove", (o2) => {
        this._manipulatorState.clearPointers(t2, this._manipulatorStateEventArgs, true, o2.item.manipulator);
      }), t2.manipulators.on("change", () => {
        this._manipulatorState.updateHoveredStateFromKnownPointers(this._forEachTool), this._updateCursor();
      })], E$m);
    }), this._manipulatorState.updateHoveredStateFromKnownPointers(this._forEachTool), this._updateCursor();
  }
  _updateToolEditableFlag(t2) {
    t2.setEditableFlag(o$N.MANAGER, t$2r(this.activeTool) || t2 === this.activeTool);
  }
  _updateCursor() {
    let t2 = this._manipulatorState.cursor;
    t$2r(t2) && this._forEachTool((o2) => !(!r$1$(o2.cursor) || !o2.visible) && (t2 = o2.cursor, true)), this._get("cursor") !== t2 && this._set("cursor", t2);
  }
  _removeIncompleteTools(t2) {
    this.tools.filter((o2) => (t$2r(t2) || o2 !== t2) && !o2.created && o2.removeIncompleteOnCancel).forEach((t3) => {
      this.tools.remove(t3);
    });
  }
};
e$2g([y$1I({ constructOnly: true, nonNullable: true })], w$i.prototype, "view", void 0), e$2g([y$1I({ readOnly: true, nonNullable: true })], w$i.prototype, "textures", void 0), e$2g([y$1I({ value: null })], w$i.prototype, "activeTool", null), e$2g([y$1I({ readOnly: true, type: j$V })], w$i.prototype, "tools", void 0), e$2g([y$1I({ readOnly: true })], w$i.prototype, "cursor", void 0), e$2g([y$1I({ readOnly: true })], w$i.prototype, "updating", null), w$i = e$2g([n$2P("esri.views.ToolViewManager")], w$i);
const y$n = w$i;
let n$X = class extends m$2q {
  constructor(e2) {
    super(), this.nativeIndex = null, this._detectedDeviceType = "unknown", e2.mapping === "standard" ? this._detectedDeviceType = "standard" : o$K.test(e2.id) ? this._detectedDeviceType = "spacemouse" : this._detectedDeviceType = "unknown", this.nativeIndex = e2.index;
  }
  get native() {
    const e2 = navigator.getGamepads ? navigator.getGamepads() : [];
    return this.nativeIndex != null && this.nativeIndex < e2.length ? e2[this.nativeIndex] : null;
  }
  get deviceType() {
    return this._detectedDeviceType;
  }
  get axisThreshold() {
    return i$_[this.deviceType];
  }
};
e$2g([y$1I({ nonNullable: true, readOnly: true })], n$X.prototype, "nativeIndex", void 0), e$2g([y$1I({ type: String, readOnly: true })], n$X.prototype, "deviceType", null), e$2g([y$1I({ type: Number, readOnly: true })], n$X.prototype, "axisThreshold", null), n$X = e$2g([n$2P("esri.views.input.gamepad.GamepadInputDevice")], n$X);
const o$K = new RegExp("^(3dconnexion|space(mouse|navigator|pilot|explorer))", "i"), i$_ = { standard: 0.15, spacemouse: 0.025, unknown: 0 }, a$Y = n$X;
let c$W = class extends m$2q {
  constructor(...e2) {
    super(...e2), this.devices = new j$V(), this.enabledFocusMode = "document";
  }
};
e$2g([y$1I({ type: j$V.ofType(a$Y), readOnly: true })], c$W.prototype, "devices", void 0), e$2g([y$1I({ type: ["document", "view", "none"] })], c$W.prototype, "enabledFocusMode", void 0), c$W = e$2g([n$2P("esri.views.input.gamepad.GamepadSettings")], c$W);
const i$Z = c$W;
let p$Z = class extends m$2q {
  constructor() {
    super(...arguments), this.gamepad = new i$Z();
  }
};
e$2g([y$1I({ readOnly: true })], p$Z.prototype, "gamepad", void 0), p$Z = e$2g([n$2P("esri.views.input.Input")], p$Z);
const a$X = p$Z;
let s$O = class extends m$2q {
  constructor(o2) {
    super(o2), this.enabled = true, this.device = null, this.mode = "pan", this.tiltDirection = "forward-down", this.velocityFactor = 1;
  }
};
e$2g([y$1I({ type: Boolean, nonNullable: true })], s$O.prototype, "enabled", void 0), e$2g([y$1I({ type: a$Y })], s$O.prototype, "device", void 0), e$2g([y$1I({ type: ["pan", "zoom"], nonNullable: true })], s$O.prototype, "mode", void 0), e$2g([y$1I({ type: ["forward-down", "forward-up"], nonNullable: true })], s$O.prototype, "tiltDirection", void 0), e$2g([y$1I({ type: Number, nonNullable: true })], s$O.prototype, "velocityFactor", void 0), s$O = e$2g([n$2P("esri.views.navigation.gamepad.GamepadSettings")], s$O);
const a$W = s$O;
let a$V = class extends m$2q {
  constructor(o2) {
    super(o2), this.browserTouchPanEnabled = true, this.gamepad = new a$W(), this.momentumEnabled = true, this.mouseWheelZoomEnabled = true;
  }
};
e$2g([y$1I({ type: Boolean })], a$V.prototype, "browserTouchPanEnabled", void 0), e$2g([y$1I({ type: a$W, nonNullable: true })], a$V.prototype, "gamepad", void 0), e$2g([y$1I({ type: Boolean })], a$V.prototype, "momentumEnabled", void 0), e$2g([y$1I({ type: Boolean })], a$V.prototype, "mouseWheelZoomEnabled", void 0), a$V = e$2g([n$2P("esri.views.navigation.Navigation")], a$V);
const p$Y = a$V;
function o$J(t2, i2, r2) {
  const o2 = h$E(t2), c2 = i2, u2 = a$U(o2, c2, r2);
  if (o2) {
    const i3 = v$A.deriveUnitFromSR(o2, t2.spatialReference).heightUnit;
    if (!r2 && i3 !== o2.heightUnit) {
      const t3 = new s$2u("layerview:unmatched-height-unit", `The vertical units of the layer must match the horizontal units (${i3})`, { horizontalUnit: i3 });
      return new s$2u("layerview:unsupported-height-model-info", "The vertical coordinate system of the layer is not supported", { heightModelInfo: o2, error: t3 });
    }
  }
  if (!l$V(t2) || u2 === s$N.Unsupported)
    return new s$2u("layerview:unsupported-height-model-info", "The vertical coordinate system of the layer is not supported", { heightModelInfo: o2 });
  switch (u2) {
    case s$N.Units: {
      const t3 = (o2 == null ? void 0 : o2.heightUnit) || "unknown", n2 = (c2 == null ? void 0 : c2.heightUnit) || "unknown", i3 = new s$2u("layerview:incompatible-height-unit", `The vertical units of the layer (${t3}) must match the vertical units of the scene (${n2})`, { layerUnit: t3, sceneUnit: n2 });
      return new s$2u("layerview:incompatible-height-model-info", "The vertical coordinate system of the layer is incompatible with the scene", { layerHeightModelInfo: o2, sceneHeightModelInfo: c2, error: i3 });
    }
    case s$N.HeightModel: {
      const t3 = (o2 == null ? void 0 : o2.heightModel) || "unknown", n2 = (c2 == null ? void 0 : c2.heightModel) || "unknown", i3 = new s$2u("layerview:incompatible-height-model", `The height model of the layer (${t3}) must match the height model of the scene (${n2})`, { layerHeightModel: t3, sceneHeightModel: n2 });
      return new s$2u("layerview:incompatible-height-model-info", "The vertical coordinate system of the layer is incompatible with the scene", { layerHeightModelInfo: o2, sceneHeightModelInfo: c2, error: i3 });
    }
    case s$N.CRS: {
      const t3 = (o2 == null ? void 0 : o2.vertCRS) || "unknown", n2 = (c2 == null ? void 0 : c2.vertCRS) || "unknown", i3 = new s$2u("layerview:incompatible-vertical-datum", `The vertical datum of the layer (${t3}) must match the vertical datum of the scene (${n2})`, { layerDatum: t3, sceneDatum: n2 });
      return new s$2u("layerview:incompatible-height-model-info", "The vertical coordinate system of the layer is incompatible with the scene", { layerHeightModelInfo: o2, sceneHeightModelInfo: c2, error: i3 });
    }
  }
  return null;
}
function a$U(e2, t2, n2) {
  if (!c$V(e2) || !c$V(t2))
    return s$N.Unsupported;
  if (e2 == null || t2 == null)
    return s$N.Ok;
  if (!n2 && e2.heightUnit !== t2.heightUnit)
    return s$N.Units;
  if (e2.heightModel !== t2.heightModel)
    return s$N.HeightModel;
  switch (e2.heightModel) {
    case "gravity-related-height":
      return s$N.Ok;
    case "ellipsoidal":
      return e2.vertCRS === t2.vertCRS ? s$N.Ok : s$N.CRS;
    default:
      return s$N.Unsupported;
  }
}
var s$N;
function c$V(e2) {
  return e2 == null || e2.heightModel != null && e2.heightUnit != null;
}
function l$V(e2) {
  return "heightModelInfo" in e2 && e2.heightModelInfo != null || e2.spatialReference != null || !f$y(e2);
}
function h$E(e2) {
  var _a2;
  const r2 = e2.url ? m$1a(e2.url) : void 0, o2 = (_a2 = e2.spatialReference) == null ? void 0 : _a2.vcsWkid;
  return !(o2 == null && r$1$(r2) && r2.serverType === "ImageServer") && u$E(e2) && e2.heightModelInfo ? e2.heightModelInfo : f$y(e2) ? v$A.deriveUnitFromSR(p$X, e2.spatialReference) : null;
}
function u$E(e2) {
  return "heightModelInfo" in e2;
}
function d$u(e2) {
  if (e2.type === "unknown" || !("capabilities" in e2))
    return false;
  switch (e2.type) {
    case "csv":
    case "feature":
    case "geojson":
    case "subtype-group":
    case "ogc-feature":
    case "oriented-imagery":
    case "wfs":
      return true;
    default:
      return false;
  }
}
function f$y(e2) {
  return d$u(e2) ? !!(e2.capabilities && e2.capabilities.data && e2.capabilities.data.supportsZ) : m$U(e2);
}
function g$n(e2) {
  return e2.layers != null || m$U(e2) || d$u(e2) || u$E(e2);
}
function m$U(e2) {
  switch (e2.type) {
    case "building-scene":
    case "elevation":
    case "integrated-mesh":
    case "point-cloud":
    case "scene":
    case "voxel":
      return true;
    case "base-dynamic":
    case "base-elevation":
    case "base-tile":
    case "bing-maps":
    case "csv":
    case "dimension":
    case "geojson":
    case "feature":
    case "subtype-group":
    case "geo-rss":
    case "graphics":
    case "group":
    case "imagery":
    case "imagery-tile":
    case "kml":
    case "line-of-sight":
    case "map-image":
    case "map-notes":
    case "media":
    case "ogc-feature":
    case "open-street-map":
    case "oriented-imagery":
    case "route":
    case "stream":
    case "tile":
    case "unknown":
    case "unsupported":
    case "vector-tile":
    case "wcs":
    case "web-tile":
    case "wfs":
    case "wms":
    case "wmts":
    case null:
      return false;
  }
  return false;
}
!function(e2) {
  e2[e2.Ok = 0] = "Ok", e2[e2.Units = 1] = "Units", e2[e2.HeightModel = 2] = "HeightModel", e2[e2.CRS = 3] = "CRS", e2[e2.Unsupported = 4] = "Unsupported";
}(s$N || (s$N = {}));
const p$X = new v$A({ heightModel: "gravity-related-height" });
var l$U;
!function(l2) {
  l2[l2.Global = 1] = "Global", l2[l2.Local = 2] = "Local";
}(l$U || (l$U = {}));
let n$W, s$M = null;
async function c$U(r2) {
  s$M || (s$M = import("./geometryServiceUtils.js").then((e2) => n$W = e2)), await s$M, f$1V(r2);
}
async function p$W(e2, s2, a2, m2) {
  if (!e2)
    return null;
  const l2 = e2.spatialReference;
  return en() || An(l2, s2) ? rn(e2, s2) : n$W ? n$W.projectGeometry(e2, s2, a2, m2) : (await Promise.race([c$U(m2), tn(m2)]), p$W(e2, s2, a2, m2));
}
let h$D = class extends m$2q {
  constructor(e2) {
    super(e2), this.required = { tileInfo: false, heightModelInfo: false, extent: false }, this.defaultSpatialReference = null, this.userSpatialReference = null, this.sourcePreloadCount = 10, this.priorityCollection = null, this.requiresExtentInSpatialReference = true, this.suspended = false, this._projectExtentTask = { task: null, input: null, output: null, spatialReference: null };
  }
  destroy() {
    this._projectExtentTask.task && (this._projectExtentTask.task = p$3M(this._projectExtentTask.task)), this._set("map", null);
  }
  get ready() {
    return !this._spatialReferenceTask.updating && !this._tileInfoTask.updating && !this._extentTask.updating;
  }
  get heightModelInfoReady() {
    return !this._heightModelInfoTask.updating;
  }
  get spatialReference() {
    return r$1$(this.userSpatialReference) ? this.userSpatialReference : e$2e(this._spatialReferenceTask.spatialReference);
  }
  get extent() {
    return e$2e(this._extentTask.extent);
  }
  get heightModelInfo() {
    return e$2e(this._heightModelInfoTask.heightModelInfo);
  }
  get vcsWkid() {
    return e$2e(this._heightModelInfoTask.vcsWkid);
  }
  get latestVcsWkid() {
    return e$2e(this._heightModelInfoTask.latestVcsWkid);
  }
  get viewingMode() {
    return t$2r(this.userSpatialReference) || this.userSpatialReference.equals(e$2e(this._spatialReferenceTask.spatialReference)) ? e$2e(this._spatialReferenceTask.viewingMode) : null;
  }
  get tileInfo() {
    return e$2e(this._tileInfoTask.tileInfo);
  }
  get mapCollections() {
    var _a2, _b2, _c2, _d2;
    const e2 = (_a2 = this.map) == null ? void 0 : _a2.call(this), t2 = [];
    return r$1$(this.priorityCollection) && t2.push(this.priorityCollection), t2.push({ parent: e2 == null ? void 0 : e2.basemap, layers: (_b2 = e2 == null ? void 0 : e2.basemap) == null ? void 0 : _b2.baseLayers }, { layers: e2 == null ? void 0 : e2.layers }, { parent: e2 == null ? void 0 : e2.ground, layers: (_c2 = e2 == null ? void 0 : e2.ground) == null ? void 0 : _c2.layers }, { parent: e2 == null ? void 0 : e2.basemap, layers: (_d2 = e2 == null ? void 0 : e2.basemap) == null ? void 0 : _d2.referenceLayers }), t2;
  }
  get _allLayers() {
    return this._collectLayers(this.mapCollections);
  }
  get _spatialReferenceTask() {
    var _a2;
    if (this.suspended)
      return (_a2 = this._get("_spatialReferenceTask")) != null ? _a2 : { updating: false };
    const { layers: e2, updating: t2 } = this._allLayers;
    let a2 = null;
    for (const i2 of e2) {
      const e3 = this._getSupportedSpatialReferences(i2);
      if (e3.length > 0) {
        const t3 = this._narrowDownSpatialReferenceCandidates(a2, e3);
        r$1$(t3) && (a2 = t3);
      }
      if (r$1$(a2) && a2.length === 1)
        break;
    }
    if (t2 && (t$2r(a2) || a2.length !== 1))
      return { updating: true };
    const n2 = this._pickSpatialReferenceCandidate(a2);
    return { spatialReference: r$1$(n2) ? n2.spatialReference : null, viewingMode: r$1$(n2) ? n2.viewingMode : null, updating: false };
  }
  get _tileInfoTask() {
    var _a2, _b2, _c2, _d2, _e3, _f2, _g2, _h2;
    if (!this.required.tileInfo)
      return (_a2 = this._get("_tileInfoTask")) != null ? _a2 : { updating: false };
    if (!this.spatialReference)
      return { updating: this._spatialReferenceTask.updating };
    const { layers: e2, updating: t2 } = this._collectLayers([{ parent: (_c2 = (_b2 = this.map) == null ? void 0 : _b2.call(this)) == null ? void 0 : _c2.basemap, layers: (_f2 = (_e3 = (_d2 = this.map) == null ? void 0 : _d2.call(this)) == null ? void 0 : _e3.basemap) == null ? void 0 : _f2.baseLayers }, { layers: (_h2 = (_g2 = this.map) == null ? void 0 : _g2.call(this)) == null ? void 0 : _h2.layers }]);
    if (e2 && e2.length > 0 && "tileInfo" in e2[0]) {
      const t3 = e2[0].tileInfo;
      return { tileInfo: t3 && t3.spatialReference.equals(this.spatialReference) ? t3 : null, updating: false };
    }
    return { updating: t2 };
  }
  get _heightModelInfoTask() {
    var _a2, _b2, _c2, _d2;
    if (!this.required.heightModelInfo || this.suspended && ((_a2 = this._get("_heightModelInfoTask")) == null ? void 0 : _a2.heightModelInfo))
      return (_b2 = this._get("_heightModelInfoTask")) != null ? _b2 : { updating: false };
    const { layers: e2, updating: t2 } = this._allLayers;
    for (const a2 of e2)
      if (g$n(a2)) {
        const e3 = h$E(a2);
        if (e3)
          return { heightModelInfo: e3, vcsWkid: (_c2 = a2.spatialReference) == null ? void 0 : _c2.vcsWkid, latestVcsWkid: (_d2 = a2.spatialReference) == null ? void 0 : _d2.latestVcsWkid, updating: false };
      }
    return { updating: t2 };
  }
  get _extentCandidatesTask() {
    var _a2, _b2;
    if (this.suspended || !this.required.extent)
      return (_a2 = this._get("_extentCandidatesTask")) != null ? _a2 : { updating: false };
    if (!this.spatialReference)
      return { updating: this._spatialReferenceTask.updating };
    const e2 = this._allLayers, t2 = e2.updating, a2 = [];
    for (const n2 of e2.layers) {
      const e3 = "fullExtents" in n2 && n2.fullExtents || (r$1$(n2.fullExtent) ? [n2.fullExtent] : []), t3 = this.requiresExtentInSpatialReference ? null : e3[0], i2 = (_b2 = e3.find((e4) => e4.spatialReference.equals(this.spatialReference))) != null ? _b2 : t3;
      if (i2)
        return { candidates: [{ extent: i2, layer: n2 }], updating: false };
      if (this._getSupportedSpatialReferences(n2).length > 0)
        for (const s2 of e3)
          a2.push({ extent: s2, layer: n2 });
    }
    return { candidates: a2, updating: t2 };
  }
  get _extentTask() {
    const { candidates: e2, updating: t2 } = this._extentCandidatesTask;
    if (t2)
      return { updating: t2 };
    if (t$2r(e2) || e2.length === 0)
      return { updating: false };
    if (!this.spatialReference)
      return { updating: this._spatialReferenceTask.updating };
    const i2 = this._pickExtentCandidate(e2), l2 = this.spatialReference;
    return i2.extent.equals(this._projectExtentTask.input) && l2.equals(this._projectExtentTask.spatialReference) ? { extent: this._projectExtentTask.output, updating: r$1$(this._projectExtentTask.task) && !this._projectExtentTask.task.finished } : (r$1$(this._projectExtentTask.task) && (this._projectExtentTask.task = p$3M(this._projectExtentTask.task)), this._projectExtentTask = { input: i2.extent.clone(), output: null, spatialReference: l2.clone(), task: j$B(async (e3) => {
      try {
        const t3 = await p$W(i2.extent, l2, i2.layer.portalItem, e3);
        this._projectExtentTask = __spreadProps(__spreadValues({}, this._projectExtentTask), { task: null, output: t3 });
      } catch (t3) {
        if (p$3D(e3))
          return;
        this._projectExtentTask = __spreadProps(__spreadValues({}, this._projectExtentTask), { task: null });
      }
    }) }, { updating: true });
  }
  _narrowDownSpatialReferenceCandidates(e2, t2) {
    if (t$2r(e2))
      return t2;
    const a2 = [], n2 = (e3, t3) => r$1$(e3) ? r$1$(t3) ? e3 === t3 && e3 : e3 : t3;
    for (const s2 of e2)
      for (const e3 of t2) {
        if (!s2.spatialReference.equals(e3.spatialReference))
          continue;
        const t3 = n2(s2.viewingMode, e3.viewingMode);
        if (t3 !== false) {
          a2.push({ spatialReference: s2.spatialReference, viewingMode: t3 });
          break;
        }
      }
    return a2.length > 0 ? a2 : null;
  }
  _pickSpatialReferenceCandidate(e2) {
    const t2 = this.defaultSpatialReference;
    return t$2r(e2) || e2.length < 1 ? r$1$(t2) ? { spatialReference: t2, viewingMode: null } : null : (r$1$(t2) && e2.length > 1 && e2.some(({ spatialReference: e3 }) => e3.equals(t2)) && (e2 = e2.filter(({ spatialReference: e3 }) => e3.equals(t2))), e2.length > 1 && e2.some(({ viewingMode: e3 }) => e3 !== l$U.Local) && (e2 = e2.filter(({ viewingMode: e3 }) => e3 !== l$U.Local)), e2[0]);
  }
  _getSupportedSpatialReferences(e2) {
    const t2 = "supportedSpatialReferences" in e2 && e2.supportedSpatialReferences || (e2.spatialReference ? [e2.spatialReference] : []);
    if (t2.length === 0)
      return [];
    const a2 = [];
    for (const n2 of t2) {
      const t3 = this.getSpatialReferenceSupport({ spatialReference: n2, layer: e2 });
      if (r$1$(t3)) {
        const e3 = r$1$(t3.constraints) ? t3.constraints : [{ spatialReference: n2, viewingMode: null }];
        for (const { spatialReference: t4, viewingMode: n3 } of e3)
          (!this.requiresExtentInSpatialReference || t$2r(this.userSpatialReference) || t4.equals(this.userSpatialReference)) && a2.push({ spatialReference: t4, viewingMode: n3 });
      }
    }
    return a2;
  }
  _pickExtentCandidate(e2) {
    const t2 = this.spatialReference;
    return e2.find(({ extent: e3 }) => t2.equals(e3.spatialReference)) || e2[0];
  }
  _collectLayers(e2) {
    var _a2;
    if (this._loadMaybe((_a2 = this.map) == null ? void 0 : _a2.call(this)) !== "loaded")
      return { layers: [], updating: true };
    const t2 = { layers: [], preloading: -1, updating: false };
    for (const a2 of e2)
      if (this._collectCollection(a2, t2), t2.preloading === this.sourcePreloadCount)
        break;
    return { layers: t2.layers, updating: t2.updating };
  }
  _collectCollection(e2, t2) {
    if (e2.layers) {
      switch (this._loadMaybe(e2.parent)) {
        case "loading":
          return t2.updating = true, void ++t2.preloading;
        case "failed":
          return;
      }
      for (const a2 of e2.layers) {
        switch (this._loadMaybe(a2)) {
          case "failed":
            continue;
          case "loading":
            t2.updating = true, ++t2.preloading;
            break;
          case "loaded":
            t2.updating || t2.layers.push(a2), "layers" in a2 && this._collectCollection({ layers: a2.layers }, t2);
        }
        if (t2.preloading === this.sourcePreloadCount)
          break;
      }
    }
  }
  _loadMaybe(e2) {
    return e2 && "loadStatus" in e2 ? e2.loadStatus === "not-loaded" ? (e2.load().catch(() => {
    }), "loading") : e2.loadStatus : "loaded";
  }
};
e$2g([y$1I()], h$D.prototype, "required", void 0), e$2g([y$1I({ constructOnly: true })], h$D.prototype, "map", void 0), e$2g([y$1I({ constructOnly: true })], h$D.prototype, "getSpatialReferenceSupport", void 0), e$2g([y$1I()], h$D.prototype, "defaultSpatialReference", void 0), e$2g([y$1I()], h$D.prototype, "userSpatialReference", void 0), e$2g([y$1I()], h$D.prototype, "sourcePreloadCount", void 0), e$2g([y$1I()], h$D.prototype, "priorityCollection", void 0), e$2g([y$1I()], h$D.prototype, "requiresExtentInSpatialReference", void 0), e$2g([y$1I()], h$D.prototype, "suspended", void 0), e$2g([y$1I({ readOnly: true })], h$D.prototype, "ready", null), e$2g([y$1I({ readOnly: true })], h$D.prototype, "heightModelInfoReady", null), e$2g([y$1I({ readOnly: true })], h$D.prototype, "spatialReference", null), e$2g([y$1I({ readOnly: true })], h$D.prototype, "extent", null), e$2g([y$1I({ readOnly: true })], h$D.prototype, "heightModelInfo", null), e$2g([y$1I({ readOnly: true })], h$D.prototype, "vcsWkid", null), e$2g([y$1I({ readOnly: true })], h$D.prototype, "latestVcsWkid", null), e$2g([y$1I({ readOnly: true })], h$D.prototype, "viewingMode", null), e$2g([y$1I({ readOnly: true })], h$D.prototype, "tileInfo", null), e$2g([y$1I({ readOnly: true })], h$D.prototype, "mapCollections", null), e$2g([y$1I({ readOnly: true })], h$D.prototype, "_allLayers", null), e$2g([y$1I({ readOnly: true })], h$D.prototype, "_spatialReferenceTask", null), e$2g([y$1I({ readOnly: true })], h$D.prototype, "_tileInfoTask", null), e$2g([y$1I({ readOnly: true })], h$D.prototype, "_heightModelInfoTask", null), e$2g([y$1I({ readOnly: true })], h$D.prototype, "_extentCandidatesTask", null), e$2g([y$1I()], h$D.prototype, "_extentTask", null), e$2g([y$1I()], h$D.prototype, "_projectExtentTask", void 0), h$D = e$2g([n$2P("esri.views.support.DefaultsFromMap")], h$D);
var P$e;
let W$8 = P$e = class extends a$1W(n$2G.EventedMixin(m$1Y(m$2q))) {
  constructor(e2) {
    super(e2), this._userSpatialReference = null, this._cursor = null, this.allLayerViews = new l$1Q({ getCollections: () => {
      var _a2, _b2, _c2;
      return [(_a2 = this.basemapView) == null ? void 0 : _a2.baseLayerViews, (_b2 = this.groundView) == null ? void 0 : _b2.layerViews, this.layerViews, (_c2 = this.basemapView) == null ? void 0 : _c2.referenceLayerViews];
    }, getChildrenFunction: (e3) => e3.layerViews }), this.groundView = null, this.basemapView = null, this.fatalError = null, this.graphics = new i$14(), this.analyses = new i$15(), this.typeSpecificPreconditionsReady = true, this.layerViews = new j$V(), this.magnifier = new p$11(), this.padding = { left: 0, top: 0, right: 0, bottom: 0 }, this.ready = false, this.spatialReferenceWarningDelay = 1e3, this.supportsGround = true, this.timeExtent = null, this.type = null, this.scale = null, this.updating = false, this.initialExtentRequired = true, this.input = new a$X(), this.navigation = new p$Y(), this.layerViewManager = null, this.analysisViewManager = null, this.isHeightModelInfoRequired = false, this.width = null, this.height = null, this.resizing = false, this.suspended = false, this.viewEvents = new p$_(this), this.persistableViewModels = new j$V(), this._isValid = false, this._readyCycleForced = false, this.handles.add(l$1P(() => this.preconditionsReady, (e3) => {
      var _a2, _b2;
      e3 ? (this._currentSpatialReference = this.spatialReference, P$e.views.add(this)) : (this._currentSpatialReference = null, P$e.views.remove(this)), this.notifyChange("spatialReference"), !e3 && this.ready ? ((_a2 = this.toolViewManager) == null ? void 0 : _a2.detach(), r$1$(this.analysisViewManager) && this.analysisViewManager.detach(), (_b2 = this.layerViewManager) == null ? void 0 : _b2.clear(), this._teardown()) : e3 && !this.ready && (this._startup(), r$1$(this.analysisViewManager) && this.analysisViewManager.attach(), this.toolViewManager.attach());
    }, U$r));
  }
  initialize() {
    this.addResolvingPromise(this.validate().then(() => (this._isValid = true, j$I(() => this.ready)))), this.basemapView = new p$12({ view: this }), this.layerViewManager = new L$b({ view: this, layerViewImporter: { importLayerView: (e2) => this.importLayerView(e2), hasLayerViewModule: (e2) => this.hasLayerViewModule(e2) }, supportsGround: this.supportsGround }), this.toolViewManager = new y$n({ view: this }), this._setupSpatialReferenceLogger(), this.handles.add([l$1P(() => this.initialExtentRequired, (e2) => this.defaultsFromMap.required = __spreadProps(__spreadValues({}, this.defaultsFromMap.required), { extent: e2 }), { sync: true, initial: true }), l$1P(() => this.ready, (e2) => {
      this.defaultsFromMap && (this.defaultsFromMap.suspended = e2, this.defaultsFromMap.userSpatialReference = e2 ? this.spatialReference : this._userSpatialReference);
    }, { sync: true }), l$1P(() => this._userSpatialReference, (e2) => {
      this.defaultsFromMap && (this.defaultsFromMap.userSpatialReference = e2);
    }, { sync: true, initial: true })]);
  }
  _setupSpatialReferenceLogger() {
    let e2 = null;
    this.handles.add([l$1P(() => {
      var _a2;
      return (_a2 = this.defaultsFromMap) == null ? void 0 : _a2.ready;
    }, (t2) => {
      var _a2;
      const i2 = ((_a2 = this.map) == null ? void 0 : _a2.allLayers.length) > 0;
      if (t2 && !this.spatialReference && i2) {
        if (r$1$(e2))
          return;
        const t3 = n$2U(() => e2 = p$3M(e2));
        e2 = j$B(async (t4) => {
          try {
            await U$z(this.spatialReferenceWarningDelay, null, t4);
          } catch {
            return;
          } finally {
            e2 = null;
          }
          s$2z.getLogger(this.declaredClass).warn("#spatialReference", "no spatial reference could be derived from the currently added map layers");
        }), this.handles.add(t3, "spatial-reference-logger-task");
      } else
        this.handles.remove("spatial-reference-logger-task");
    }, { sync: true })]);
  }
  destroy() {
    if (this.destroyed)
      return;
    this.viewEvents.destroy(), this.allLayerViews.destroy(), this.navigation && (this.navigation.destroy(), this._set("navigation", null)), this.graphics = s$2D(this.graphics), this.analyses = s$2D(this.analyses), this.handles.remove("defaultsFromMap"), this.defaultsFromMap.destroy(), this._set("defaultsFromMap", null), s$2D(this.analysisViewManager), this.toolViewManager = s$2D(this.toolViewManager), this.layerViewManager = s$2D(this.layerViewManager), this.basemapView = s$2D(this.basemapView), this.invalidate(), this._emitter.clear(), this.handles.removeAll();
    const e2 = this.map;
    this.map = null, e2 == null ? void 0 : e2.destroy();
  }
  _startup() {
    this._set("ready", true);
  }
  _teardown() {
    this._set("ready", false);
  }
  whenReady() {
    return Promise.resolve(this);
  }
  toMap() {
    return s$2z.getLogger(this.declaredClass).error("#toMap()", "Not implemented on this instance of View"), null;
  }
  get activeTool() {
    var _a2;
    return (_a2 = this.toolViewManager) == null ? void 0 : _a2.activeTool;
  }
  set activeTool(e2) {
    this.toolViewManager && (this.toolViewManager.activeTool = e2);
  }
  get animation() {
    return this._get("animation");
  }
  set animation(e2) {
    this._set("animation", e2);
  }
  get _defaultsFromMapSettings() {
    return {};
  }
  get defaultsFromMap() {
    return new h$D(__spreadValues({ required: { tileInfo: false, heightModelInfo: false, extent: false }, map: () => this.map, getSpatialReferenceSupport: (e2) => this.getSpatialReferenceSupport(e2) }, this._defaultsFromMapSettings));
  }
  get extent() {
    return this._get("extent");
  }
  set extent(e2) {
    this._set("extent", e2);
  }
  get heightModelInfo() {
    return this.getDefaultHeightModelInfo();
  }
  get interacting() {
    return this.navigating;
  }
  get navigating() {
    return false;
  }
  get preconditionsReady() {
    var _a2;
    return !(this.fatalError || !this._isValid || this._readyCycleForced || !this.map || m$1X.isLoadable(this.map) && !this.map.loaded || this.width === 0 || this.height === 0 || !this.spatialReference || !this._validateSpatialReference(this.spatialReference) || !this._currentSpatialReference && !((_a2 = this.defaultsFromMap) == null ? void 0 : _a2.ready) || !this.typeSpecificPreconditionsReady);
  }
  set map(e2) {
    e2 !== this._get("map") && ((e2 == null ? void 0 : e2.destroyed) && (s$2z.getLogger(this.declaredClass).warn("#map", "The provided map is already destroyed", { map: e2 }), e2 = null), m$1X.isLoadable(e2) && e2.load().catch(() => {
    }), this.constructed && (this.forceReadyCycle(), this._currentSpatialReference = null), this._set("map", e2));
  }
  get spatialReference() {
    var _a2, _b2;
    let e2 = this._userSpatialReference || this._currentSpatialReference || this.getDefaultSpatialReference() || null;
    return e2 && ((_b2 = (_a2 = this.defaultsFromMap) == null ? void 0 : _a2.required) == null ? void 0 : _b2.heightModelInfo) && (e2 = e2.clone(), e2.vcsWkid = this.defaultsFromMap.vcsWkid, e2.latestVcsWkid = this.defaultsFromMap.latestVcsWkid), e2;
  }
  set spatialReference(e2) {
    const t2 = !E$P(e2, this._get("spatialReference"));
    this._set("_userSpatialReference", e2), t2 && (this._set("spatialReference", e2), this._spatialReferenceChanged(e2));
  }
  _spatialReferenceChanged(e2) {
  }
  get stationary() {
    return !this.animation && !this.navigating && !this.resizing;
  }
  get tools() {
    var _a2;
    return (_a2 = this.toolViewManager) == null ? void 0 : _a2.tools;
  }
  get initialExtent() {
    var _a2;
    return (_a2 = this.defaultsFromMap) == null ? void 0 : _a2.extent;
  }
  get cursor() {
    const e2 = this.toolViewManager ? this.toolViewManager.cursor : null;
    return r$1$(e2) ? e2 : this._cursor || "default";
  }
  set cursor(e2) {
    this._cursor = e2, this.notifyChange("cursor");
  }
  get size() {
    return [this.width, this.height];
  }
  whenLayerView(e2) {
    return this.layerViewManager.whenLayerView(e2);
  }
  getDefaultSpatialReference() {
    var _a2;
    return (_a2 = this.defaultsFromMap) == null ? void 0 : _a2.spatialReference;
  }
  getDefaultHeightModelInfo() {
    var _a2, _b2, _c2;
    return (_c2 = (_b2 = this.map && "heightModelInfo" in this.map ? this.map.heightModelInfo : void 0) != null ? _b2 : (_a2 = this.defaultsFromMap) == null ? void 0 : _a2.heightModelInfo) != null ? _c2 : null;
  }
  importLayerView(e2) {
    throw new s$2u("importLayerView() not implemented");
  }
  hasLayerViewModule(e2) {
    return false;
  }
  async validate() {
  }
  invalidate() {
    this._isValid = false;
  }
  getSpatialReferenceSupport() {
    return { constraints: null };
  }
  _validateSpatialReference(e2) {
    return r$1$(this.getSpatialReferenceSupport({ spatialReference: e2 }));
  }
  when(e2, t2) {
    return this.isResolved() && !this.ready && s$2z.getLogger(this.declaredClass).warn("#when()", "Calling view.when() while the view is no longer ready but was already resolved once will resolve immediately. Use reactiveUtils.whenOnce(() => view.ready).then(...) instead."), super.when(e2, t2);
  }
  forceReadyCycle() {
    this.ready && (f$1o(() => this.preconditionsReady === false, () => this._readyCycleForced = false, { once: true }), this._readyCycleForced = true);
  }
  addAndActivateTool(e2) {
    this.toolViewManager.tools.add(e2), this.activeTool = e2;
  }
  tryFatalErrorRecovery() {
    this.fatalError = null;
  }
};
W$8.views = new j$V(), e$2g([y$1I()], W$8.prototype, "_userSpatialReference", void 0), e$2g([y$1I()], W$8.prototype, "activeTool", null), e$2g([y$1I({ readOnly: true })], W$8.prototype, "allLayerViews", void 0), e$2g([y$1I()], W$8.prototype, "groundView", void 0), e$2g([y$1I()], W$8.prototype, "animation", null), e$2g([y$1I()], W$8.prototype, "basemapView", void 0), e$2g([y$1I({ readOnly: true })], W$8.prototype, "_defaultsFromMapSettings", null), e$2g([y$1I()], W$8.prototype, "defaultsFromMap", null), e$2g([y$1I()], W$8.prototype, "fatalError", void 0), e$2g([y$1I({ type: w$Z })], W$8.prototype, "extent", null), e$2g([y$1I(a$Z(i$14, "graphics"))], W$8.prototype, "graphics", void 0), e$2g([y$1I(a$Z(i$15, "analyses"))], W$8.prototype, "analyses", void 0), e$2g([y$1I({ readOnly: true, type: v$A })], W$8.prototype, "heightModelInfo", null), e$2g([y$1I({ readOnly: true })], W$8.prototype, "interacting", null), e$2g([y$1I({ readOnly: true })], W$8.prototype, "navigating", null), e$2g([y$1I({ readOnly: true, dependsOn: ["fatalError", "_isValid", "_readyCycleForced", "map", "map.loaded?", "width", "height", "spatialReference", "_currentSpatialReference", "defaultsFromMap.ready", "typeSpecificPreconditionsReady"] })], W$8.prototype, "preconditionsReady", null), e$2g([y$1I({ readOnly: true })], W$8.prototype, "typeSpecificPreconditionsReady", void 0), e$2g([y$1I({ type: j$V, readOnly: true })], W$8.prototype, "layerViews", void 0), e$2g([y$1I({ type: p$11 })], W$8.prototype, "magnifier", void 0), e$2g([y$1I({ value: null, type: L$c })], W$8.prototype, "map", null), e$2g([y$1I()], W$8.prototype, "padding", void 0), e$2g([y$1I({ readOnly: true })], W$8.prototype, "ready", void 0), e$2g([y$1I({ type: k$C })], W$8.prototype, "spatialReference", null), e$2g([y$1I()], W$8.prototype, "spatialReferenceWarningDelay", void 0), e$2g([y$1I()], W$8.prototype, "stationary", null), e$2g([y$1I({ readOnly: true })], W$8.prototype, "supportsGround", void 0), e$2g([y$1I({ type: T$o })], W$8.prototype, "timeExtent", void 0), e$2g([y$1I()], W$8.prototype, "tools", null), e$2g([y$1I()], W$8.prototype, "toolViewManager", void 0), e$2g([y$1I({ readOnly: true })], W$8.prototype, "type", void 0), e$2g([y$1I({ type: Number })], W$8.prototype, "scale", void 0), e$2g([y$1I({ readOnly: true })], W$8.prototype, "updating", void 0), e$2g([y$1I({ readOnly: true })], W$8.prototype, "initialExtentRequired", void 0), e$2g([y$1I({ readOnly: true })], W$8.prototype, "initialExtent", null), e$2g([y$1I()], W$8.prototype, "cursor", null), e$2g([y$1I({ readOnly: true })], W$8.prototype, "input", void 0), e$2g([y$1I({ type: p$Y, nonNullable: true })], W$8.prototype, "navigation", void 0), e$2g([y$1I()], W$8.prototype, "layerViewManager", void 0), e$2g([y$1I()], W$8.prototype, "analysisViewManager", void 0), e$2g([y$1I()], W$8.prototype, "width", void 0), e$2g([y$1I()], W$8.prototype, "height", void 0), e$2g([y$1I({ readOnly: true })], W$8.prototype, "resizing", void 0), e$2g([y$1I({ value: null, readOnly: true })], W$8.prototype, "size", null), e$2g([y$1I({ readOnly: true })], W$8.prototype, "suspended", void 0), e$2g([y$1I({ readOnly: true })], W$8.prototype, "viewEvents", void 0), e$2g([y$1I({ readOnly: true })], W$8.prototype, "persistableViewModels", void 0), e$2g([y$1I()], W$8.prototype, "_isValid", void 0), e$2g([y$1I()], W$8.prototype, "_readyCycleForced", void 0), e$2g([y$1I()], W$8.prototype, "_currentSpatialReference", void 0), W$8 = P$e = e$2g([n$2P("esri.views.View")], W$8);
const z$j = W$8;
let n$V = class extends _$G {
  constructor(t2) {
    super(t2), this.state = "running", this.target = null, this._dfd = null;
  }
  initialize() {
    this.addResolvingPromise(new Promise((t2, s2) => this._dfd = { resolve: t2, reject: s2 }));
  }
  get done() {
    return this.state === "finished" || this.state === "stopped";
  }
  stop() {
    var _a2;
    this.state !== "stopped" && this.state !== "finished" && (this._set("state", "stopped"), (_a2 = this._dfd) == null ? void 0 : _a2.reject(new s$2u("ViewAnimation stopped")));
  }
  finish() {
    var _a2;
    this.state !== "stopped" && this.state !== "finished" && (this._set("state", "finished"), (_a2 = this._dfd) == null ? void 0 : _a2.resolve());
  }
  update(t2, s2) {
    s2 || (s2 = C$E(t2) ? "waiting-for-target" : "running"), this._set("target", t2), this._set("state", s2);
  }
};
e$2g([y$1I({ readOnly: true })], n$V.prototype, "done", null), e$2g([y$1I({ readOnly: true, type: String })], n$V.prototype, "state", void 0), e$2g([y$1I()], n$V.prototype, "target", void 0), n$V = e$2g([n$2P("esri.views.ViewAnimation")], n$V), function(t2) {
  t2.State = { RUNNING: "running", STOPPED: "stopped", FINISHED: "finished", WAITING_FOR_TARGET: "waiting-for-target" };
}(n$V || (n$V = {}));
const p$V = n$V;
function e$C(e2, n2, t2, r2) {
  const u2 = 3 * e2, i2 = 3 * (t2 - e2) - u2, a2 = 1 - u2 - i2, o2 = 3 * n2, s2 = 3 * (r2 - n2) - o2, f2 = 1 - o2 - s2;
  function c2(e3) {
    return ((a2 * e3 + i2) * e3 + u2) * e3;
  }
  function l2(e3) {
    return ((f2 * e3 + s2) * e3 + o2) * e3;
  }
  function b2(e3) {
    return (3 * a2 * e3 + 2 * i2) * e3 + u2;
  }
  function p2(e3, n3) {
    let t3, r3, u3, i3, a3, o3;
    for (u3 = e3, o3 = 0; o3 < 8; o3++) {
      if (i3 = c2(u3) - e3, Math.abs(i3) < n3)
        return u3;
      if (a3 = b2(u3), Math.abs(a3) < 1e-6)
        break;
      u3 -= i3 / a3;
    }
    if (t3 = 0, r3 = 1, u3 = e3, u3 < t3)
      return t3;
    if (u3 > r3)
      return r3;
    for (; t3 < r3; ) {
      if (i3 = c2(u3), Math.abs(i3 - e3) < n3)
        return u3;
      e3 > i3 ? t3 = u3 : r3 = u3, u3 = 0.5 * (r3 - t3) + t3;
    }
    return u3;
  }
  return function(e3, n3 = 1e-6) {
    return l2(p2(e3, n3));
  };
}
const n$U = /^cubic-bezier\((.*)\)/, t$H = {};
function r$Q(r2) {
  let u2 = t$H[r2] || null;
  if (!u2) {
    const t2 = n$U.exec(r2);
    if (t2) {
      const n2 = t2[1].split(",").map((e2) => parseFloat(e2.trim()));
      n2.length !== 4 || n2.some((e2) => isNaN(e2)) || (u2 = e$C.apply(e$C, n2));
    }
  }
  return u2;
}
t$H.ease = e$C(0.25, 0.1, 0.25, 1), t$H.linear = e$C(0, 0, 1, 1), t$H.easeIn = t$H["ease-in"] = e$C(0.42, 0, 1, 1), t$H.easeOut = t$H["ease-out"] = e$C(0, 0, 0.58, 1), t$H.easeInOut = t$H["ease-in-out"] = e$C(0.42, 0, 0.58, 1);
function e$B() {
  return [1, 0, 0, 1, 0, 0];
}
function r$P(e2) {
  return [e2[0], e2[1], e2[2], e2[3], e2[4], e2[5]];
}
function t$G(e2, r2, t2, n2, o2, a2) {
  return [e2, r2, t2, n2, o2, a2];
}
function n$T(e2, r2) {
  return new Float64Array(e2, r2, 6);
}
Object.freeze(Object.defineProperty({ __proto__: null, create: e$B, clone: r$P, fromValues: t$G, createView: n$T }, Symbol.toStringTag, { value: "Module" }));
function a$T(t2, n2) {
  return t2[0] = n2[0], t2[1] = n2[1], t2;
}
function r$O(t2, n2, a2) {
  return t2[0] = n2, t2[1] = a2, t2;
}
function s$L(t2, n2, a2) {
  return t2[0] = n2[0] + a2[0], t2[1] = n2[1] + a2[1], t2;
}
function o$I(t2, n2, a2) {
  return t2[0] = n2[0] - a2[0], t2[1] = n2[1] - a2[1], t2;
}
function u$D(t2, n2, a2) {
  return t2[0] = n2[0] * a2[0], t2[1] = n2[1] * a2[1], t2;
}
function e$A(t2, n2, a2) {
  return t2[0] = n2[0] / a2[0], t2[1] = n2[1] / a2[1], t2;
}
function c$T(t2, n2) {
  return t2[0] = Math.ceil(n2[0]), t2[1] = Math.ceil(n2[1]), t2;
}
function i$Y(t2, n2) {
  return t2[0] = Math.floor(n2[0]), t2[1] = Math.floor(n2[1]), t2;
}
function f$x(t2, n2, a2) {
  return t2[0] = Math.min(n2[0], a2[0]), t2[1] = Math.min(n2[1], a2[1]), t2;
}
function M$h(t2, n2, a2) {
  return t2[0] = Math.max(n2[0], a2[0]), t2[1] = Math.max(n2[1], a2[1]), t2;
}
function h$C(t2, n2) {
  return t2[0] = Math.round(n2[0]), t2[1] = Math.round(n2[1]), t2;
}
function l$T(t2, n2, a2) {
  return t2[0] = n2[0] * a2, t2[1] = n2[1] * a2, t2;
}
function d$t(t2, n2, a2, r2) {
  return t2[0] = n2[0] + a2[0] * r2, t2[1] = n2[1] + a2[1] * r2, t2;
}
function m$T(t2, n2) {
  const a2 = n2[0] - t2[0], r2 = n2[1] - t2[1];
  return Math.sqrt(a2 * a2 + r2 * r2);
}
function b$k(t2, n2) {
  const a2 = n2[0] - t2[0], r2 = n2[1] - t2[1];
  return a2 * a2 + r2 * r2;
}
function q$e(t2) {
  const n2 = t2[0], a2 = t2[1];
  return Math.sqrt(n2 * n2 + a2 * a2);
}
function p$U(t2) {
  const n2 = t2[0], a2 = t2[1];
  return n2 * n2 + a2 * a2;
}
function g$m(t2, n2) {
  return t2[0] = -n2[0], t2[1] = -n2[1], t2;
}
function x$k(t2, n2) {
  return t2[0] = 1 / n2[0], t2[1] = 1 / n2[1], t2;
}
function v$m(t2, n2) {
  const a2 = n2[0], r2 = n2[1];
  let s2 = a2 * a2 + r2 * r2;
  return s2 > 0 && (s2 = 1 / Math.sqrt(s2), t2[0] = n2[0] * s2, t2[1] = n2[1] * s2), t2;
}
function j$e(t2, n2) {
  return t2[0] * n2[0] + t2[1] * n2[1];
}
function y$m(t2, n2, a2) {
  const r2 = n2[0] * a2[1] - n2[1] * a2[0];
  return t2[0] = t2[1] = 0, t2[2] = r2, t2;
}
function A$c(t2, n2, a2, r2) {
  const s2 = n2[0], o2 = n2[1];
  return t2[0] = s2 + r2 * (a2[0] - s2), t2[1] = o2 + r2 * (a2[1] - o2), t2;
}
function P$d(n2, a2) {
  a2 = a2 || 1;
  const r2 = 2 * n$2u() * Math.PI;
  return n2[0] = Math.cos(r2) * a2, n2[1] = Math.sin(r2) * a2, n2;
}
function _$k(t2, n2, a2) {
  const r2 = n2[0], s2 = n2[1];
  return t2[0] = a2[0] * r2 + a2[2] * s2, t2[1] = a2[1] * r2 + a2[3] * s2, t2;
}
function z$i(t2, n2, a2) {
  const r2 = n2[0], s2 = n2[1];
  return t2[0] = a2[0] * r2 + a2[2] * s2 + a2[4], t2[1] = a2[1] * r2 + a2[3] * s2 + a2[5], t2;
}
function D$c(t2, n2, a2) {
  const r2 = n2[0], s2 = n2[1];
  return t2[0] = a2[0] * r2 + a2[3] * s2 + a2[6], t2[1] = a2[1] * r2 + a2[4] * s2 + a2[7], t2;
}
function I$e(t2, n2, a2) {
  const r2 = n2[0], s2 = n2[1];
  return t2[0] = a2[0] * r2 + a2[4] * s2 + a2[12], t2[1] = a2[1] * r2 + a2[5] * s2 + a2[13], t2;
}
function L$9(t2, n2, a2, r2) {
  const s2 = n2[0] - a2[0], o2 = n2[1] - a2[1], u2 = Math.sin(r2), e2 = Math.cos(r2);
  return t2[0] = s2 * e2 - o2 * u2 + a2[0], t2[1] = s2 * u2 + o2 * e2 + a2[1], t2;
}
function O$g(t2, n2) {
  const a2 = t2[0], r2 = t2[1], s2 = n2[0], o2 = n2[1];
  let u2 = a2 * a2 + r2 * r2;
  u2 > 0 && (u2 = 1 / Math.sqrt(u2));
  let e2 = s2 * s2 + o2 * o2;
  e2 > 0 && (e2 = 1 / Math.sqrt(e2));
  const c2 = (a2 * s2 + r2 * o2) * u2 * e2;
  return c2 > 1 ? 0 : c2 < -1 ? Math.PI : Math.acos(c2);
}
function S$e(t2) {
  return "vec2(" + t2[0] + ", " + t2[1] + ")";
}
function E$l(t2, n2) {
  return t2[0] === n2[0] && t2[1] === n2[1];
}
function k$f(t2, a2) {
  const r2 = t2[0], s2 = t2[1], o2 = a2[0], u2 = a2[1], e2 = a$2x();
  return Math.abs(r2 - o2) <= e2 * Math.max(1, Math.abs(r2), Math.abs(o2)) && Math.abs(s2 - u2) <= e2 * Math.max(1, Math.abs(s2), Math.abs(u2));
}
function w$h(t2, n2, a2, r2, s2) {
  let o2 = n2[0] - a2[0], u2 = n2[1] - a2[1];
  const e2 = (r2[0] * o2 + r2[1] * u2) * (s2 - 1);
  return o2 = r2[0] * e2, u2 = r2[1] * e2, t2[0] = n2[0] + o2, t2[1] = n2[1] + u2, t2;
}
const B$d = q$e, C$g = o$I, F$f = u$D, G$f = e$A, H$9 = m$T, J$e = b$k, K$9 = p$U;
Object.freeze(Object.defineProperty({ __proto__: null, copy: a$T, set: r$O, add: s$L, subtract: o$I, multiply: u$D, divide: e$A, ceil: c$T, floor: i$Y, min: f$x, max: M$h, round: h$C, scale: l$T, scaleAndAdd: d$t, distance: m$T, squaredDistance: b$k, length: q$e, squaredLength: p$U, negate: g$m, inverse: x$k, normalize: v$m, dot: j$e, cross: y$m, lerp: A$c, random: P$d, transformMat2: _$k, transformMat2d: z$i, transformMat3: D$c, transformMat4: I$e, rotate: L$9, angle: O$g, str: S$e, exactEquals: E$l, equals: k$f, projectAndScale: w$h, len: B$d, sub: C$g, mul: F$f, div: G$f, dist: H$9, sqrDist: J$e, sqrLen: K$9 }, Symbol.toStringTag, { value: "Module" }));
function n$S() {
  return [0, 0];
}
function t$F(n2) {
  return [n2[0], n2[1]];
}
function r$N(n2, t2) {
  return [n2, t2];
}
function e$z(t2) {
  const r2 = n$S(), e2 = Math.min(2, t2.length);
  for (let n2 = 0; n2 < e2; ++n2)
    r2[n2] = t2[n2];
  return r2;
}
function o$H(n2, t2) {
  return new Float64Array(n2, t2, 2);
}
function u$C() {
  return n$S();
}
function a$S() {
  return r$N(1, 1);
}
function s$K() {
  return r$N(1, 0);
}
function c$S() {
  return r$N(0, 1);
}
const f$w = u$C(), i$X = a$S(), l$S = s$K(), _$j = c$S();
Object.freeze(Object.defineProperty({ __proto__: null, create: n$S, clone: t$F, fromValues: r$N, fromArray: e$z, createView: o$H, zeros: u$C, ones: a$S, unitX: s$K, unitY: c$S, ZEROS: f$w, ONES: i$X, UNIT_X: l$S, UNIT_Y: _$j }, Symbol.toStringTag, { value: "Module" }));
const Q$8 = 96, U$a = 39.37, B$c = 180 / Math.PI;
function D$b(t2) {
  return t2.wkid ? t2 : t2.spatialReference || k$C.WGS84;
}
function T$e(t2, e2) {
  return e2.type ? r$O(t2, e2.x, e2.y) : a$T(t2, e2);
}
function W$7(t2) {
  return $$g(t2);
}
function H$8(t2, e2) {
  const n2 = Math.max(1, e2[0]), r2 = Math.max(1, e2[1]);
  return Math.max(t2.width / n2, t2.height / r2) * ct(t2.spatialReference);
}
async function J$d(t2, a2, i2, c2) {
  let s2, u2;
  if (!t2)
    return null;
  if (Array.isArray(t2) && !t2.length)
    return null;
  if (j$V.isCollection(t2) && (t2 = t2.toArray()), Array.isArray(t2) && t2.length && typeof t2[0] == "object") {
    const e2 = t2.every((t3) => "attributes" in t3), r2 = t2.some((t3) => !t3.geometry);
    let o2 = t2;
    if (e2 && r2 && a2 && a2.allLayerViews) {
      const e3 = new Map();
      for (const n2 of t2) {
        const t3 = n2.layer, r4 = e3.get(t3) || [], o3 = n2.attributes[t3.objectIdField];
        o3 != null && r4.push(o3), e3.set(t3, r4);
      }
      const r3 = [];
      e3.forEach((t3, e4) => {
        const n2 = a2.allLayerViews.find((t4) => t4.layer.id === e4.id);
        if ("queryFeatures" in n2) {
          const o3 = e4.createQuery();
          o3.objectIds = t3, o3.returnGeometry = true, r3.push(n2.queryFeatures(o3));
        }
      });
      const i3 = await Promise.all(r3), c3 = [];
      for (const t3 of i3)
        if (t3 && t3.features && t3.features.length)
          for (const e4 of t3.features)
            r$1$(e4.geometry) && c3.push(e4.geometry);
      o2 = c3;
    }
    for (const t3 of o2)
      c2 = await J$d(t3, a2, i2, c2);
    return c2;
  }
  if (Array.isArray(t2) && t2.length === 2 && typeof t2[0] == "number" && typeof t2[1] == "number")
    s2 = new w$_(t2);
  else if (t2 instanceof p$3y)
    s2 = t2;
  else if ("geometry" in t2) {
    if (t2.geometry)
      s2 = t2.geometry;
    else if (t2.layer) {
      const e2 = t2.layer, n2 = a2.allLayerViews.find((t3) => t3.layer.id === e2.id);
      if ("queryFeatures" in n2) {
        const o2 = e2.createQuery();
        o2.objectIds = [t2.attributes[e2.objectIdField]], o2.returnGeometry = true;
        const a3 = await n2.queryFeatures(o2);
        s2 = q$u(a3, "features", 0, "geometry");
      }
    }
  }
  if (t$2r(s2))
    return null;
  if (u2 = s2.type === "point" ? new w$Z({ xmin: s2.x, ymin: s2.y, xmax: s2.x, ymax: s2.y, spatialReference: s2.spatialReference }) : s2.extent, !u2)
    return null;
  en() || An(u2.spatialReference, i2) || await tn();
  const f2 = rn(u2, i2);
  return f2 ? c2 = c2 ? c2.union(f2) : f2 : null;
}
function K$8(t2) {
  if (t2 && (!Array.isArray(t2) || typeof t2[0] != "number") && (typeof t2 == "object" || Array.isArray(t2) && typeof t2[0] == "object")) {
    if ("layer" in t2 && t2.layer && t2.layer.minScale && t2.layer.maxScale) {
      const e2 = t2.layer;
      return { min: e2.minScale, max: e2.maxScale };
    }
    if (Array.isArray(t2) && t2.length && t2.every((t3) => "layer" in t3)) {
      let e2 = 0, n2 = 0;
      for (const r2 of t2) {
        const t3 = r2.layer;
        t3 && t3.minScale && t3.maxScale && (e2 = t3.minScale < e2 ? t3.minScale : e2, n2 = t3.maxScale > n2 ? t3.maxScale : n2);
      }
      return e2 && n2 ? { min: e2, max: n2 } : null;
    }
  }
}
function X$8(t2, e2) {
  return E$P(D$b(t2), e2) ? t2 : rn(t2, e2);
}
async function Y$7(e2, r2) {
  if (!e2 || !r2)
    return new u$1w({ targetGeometry: new w$_(), scale: 0, rotation: 0 });
  let o2 = r2.spatialReference;
  const { constraints: a2, padding: i2, viewpoint: c2, size: s2 } = r2, u2 = [i2 ? s2[0] - i2.left - i2.right : s2[0], i2 ? s2[1] - i2.top - i2.bottom : s2[1]];
  let f2 = null;
  e2 instanceof u$1w ? f2 = e2 : e2.viewpoint ? f2 = e2.viewpoint : e2.target && e2.target.declaredClass === "esri.Viewpoint" && (f2 = e2.target);
  let l2 = null;
  f2 && f2.targetGeometry ? l2 = f2.targetGeometry : e2 instanceof w$Z ? l2 = e2 : (e2 || e2 && ("center" in e2 || "extent" in e2 || "target" in e2)) && (l2 = await J$d(e2.center, r2, o2) || await J$d(e2.extent, r2, o2) || await J$d(e2.target, r2, o2) || await J$d(e2, r2, o2)), !l2 && c2 && c2.targetGeometry ? l2 = c2.targetGeometry : !l2 && r2.extent && (l2 = r2.extent), o2 || (o2 = D$b(r2.spatialReference || r2.extent || l2)), en() || E$P(l2.spatialReference, o2) || An(l2, o2) || await tn();
  const m2 = X$8(l2.center ? l2.center : l2, o2);
  let y2 = null;
  if (f2 && r$1$(f2.targetGeometry) && f2.targetGeometry.type === "point")
    y2 = f2.scale;
  else if ("scale" in e2 && e2.scale)
    y2 = e2.scale;
  else if ("zoom" in e2 && e2.zoom !== -1 && a2 && a2.effectiveLODs)
    y2 = a2.zoomToScale(e2.zoom);
  else if (Array.isArray(l2) || l2.type === "point" || l2.type === "extent" && l2.width === 0 && l2.height === 0) {
    const t2 = X$8(r2.extent, o2);
    y2 = r$1$(t2) ? H$8(t2, u2) : r2.extent ? H$8(r2.extent, u2) : c2.scale;
  } else
    y2 = H$8(X$8(l2.extent, o2), u2);
  const p2 = K$8(e2);
  p2 && (p2.min && p2.min > y2 ? y2 = p2.min : p2.max && p2.max < y2 && (y2 = p2.max));
  let g2 = 0;
  f2 ? g2 = f2.rotation : e2.hasOwnProperty("rotation") ? g2 = e2.rotation : c2 && (g2 = c2.rotation);
  let x2 = new u$1w({ targetGeometry: m2, scale: y2, rotation: g2 });
  return a2 && (x2 = a2.fit(x2), a2.constrainByGeometry(x2), a2.rotationEnabled || (x2.rotation = g2)), x2;
}
function Z$9(t2, e2) {
  const n2 = t2.targetGeometry, r2 = e2.targetGeometry;
  return n2.x = r2.x, n2.y = r2.y, n2.spatialReference = r2.spatialReference, t2.scale = e2.scale, t2.rotation = e2.rotation, t2;
}
function $$5(t2, e2, n2) {
  return n2 ? r$O(t2, 0.5 * (e2[0] - n2.right + n2.left), 0.5 * (e2[1] - n2.bottom + n2.top)) : l$T(t2, e2, 0.5);
}
const _$i = function() {
  const t2 = n$S();
  return function(e2, n2, r2) {
    const o2 = n2.targetGeometry;
    T$e(t2, o2);
    const a2 = 0.5 * ot$1(n2);
    return e2.xmin = t2[0] - a2 * r2[0], e2.ymin = t2[1] - a2 * r2[1], e2.xmax = t2[0] + a2 * r2[0], e2.ymax = t2[1] + a2 * r2[1], e2.spatialReference = o2.spatialReference, e2;
  };
}();
function tt$2(t2, e2, n2, r2, o2) {
  return xt(t2, e2, n2.center), t2.scale = H$8(n2, r2), o2 && o2.constraints && o2.constraints.constrain(t2), t2;
}
function et(t2, e2, n2, r2) {
  return ft(t2, e2, n2, r2), r$U(t2, t2);
}
const nt$2 = function() {
  const t2 = n$S();
  return function(e2, n2, r2) {
    return C$g(e2, st$1(e2, n2), $$5(t2, n2, r2));
  };
}(), rt = function() {
  const t2 = e$B(), e2 = n$S();
  return function(n2, r2, o2, a2) {
    const i2 = ot$1(r2), f2 = it(r2);
    return r$O(e2, i2, i2), M$i(t2, e2), e$H(t2, t2, f2), i$1c(t2, t2, nt$2(e2, o2, a2)), i$1c(t2, t2, [0, a2.top - a2.bottom]), r$O(n2, t2[4], t2[5]);
  };
}();
function ot$1(t2) {
  return t2.scale * at$1(t2.targetGeometry);
}
function at$1(t2) {
  return r$1$(t2) && I$K(t2.spatialReference) ? 1 / (W$7(t2.spatialReference) * U$a * Q$8) : 1;
}
function it(t2) {
  return r$1A(t2.rotation) || 0;
}
function ct(t2) {
  return I$K(t2) ? W$7(t2) * U$a * Q$8 : 1;
}
function st$1(t2, e2) {
  return l$T(t2, e2, 0.5);
}
const ut = function() {
  const t2 = n$S(), e2 = n$S(), n2 = n$S();
  return function(r2, o2, a2, i2, c2, m2) {
    return g$m(t2, o2), l$T(e2, a2, 0.5 * m2), r$O(n2, 1 / i2 * m2, -1 / i2 * m2), f$E(r2, e2), c2 && e$H(r2, r2, c2), c$10(r2, r2, n2), i$1c(r2, r2, t2), r2;
  };
}(), ft = function() {
  const t2 = n$S();
  return function(e2, n2, r2, o2) {
    const a2 = ot$1(n2), i2 = it(n2);
    return T$e(t2, n2.targetGeometry), ut(e2, t2, r2, a2, i2, o2);
  };
}(), lt = function() {
  const t2 = n$S();
  return function(e2, n2, r2, o2) {
    const a2 = ot$1(n2);
    return T$e(t2, n2.targetGeometry), ut(e2, t2, r2, a2, 0, o2);
  };
}();
function mt(t2) {
  const e2 = R$B(t2);
  return e2 ? e2.valid[1] - e2.valid[0] : 0;
}
function yt(t2, e2) {
  return Math.round(mt(t2) / e2);
}
const pt = function() {
  const t2 = n$S(), e2 = n$S(), n2 = [0, 0, 0];
  return function(r2, o2, a2) {
    o$I(t2, r2, o2), v$m(t2, t2), o$I(e2, r2, a2), v$m(e2, e2), y$m(n2, t2, e2);
    let i2 = Math.acos(j$e(t2, e2) / (q$e(t2) * q$e(e2))) * B$c;
    return n2[2] < 0 && (i2 = -i2), isNaN(i2) && (i2 = 0), i2;
  };
}(), gt = function() {
  const t2 = n$S();
  return function(e2, n2, r2, o2) {
    const a2 = e2.targetGeometry;
    return Z$9(e2, n2), rt(t2, n2, r2, o2), a2.x += t2[0], a2.y += t2[1], e2;
  };
}(), xt = function(t2, e2, n2) {
  Z$9(t2, e2);
  const r2 = t2.targetGeometry;
  return r2.x = n2.x, r2.y = n2.y, r2.spatialReference = n2.spatialReference, t2;
}, ht = function() {
  const t2 = n$S();
  return function(e2, n2, r2, o2, a2) {
    a2 || (a2 = "center"), C$g(t2, r2, o2), l$T(t2, t2, 0.5);
    const i2 = t2[0], c2 = t2[1];
    switch (a2) {
      case "center":
        r$O(t2, 0, 0);
        break;
      case "left":
        r$O(t2, -i2, 0);
        break;
      case "top":
        r$O(t2, 0, c2);
        break;
      case "right":
        r$O(t2, i2, 0);
        break;
      case "bottom":
        r$O(t2, 0, -c2);
        break;
      case "top-left":
        r$O(t2, -i2, c2);
        break;
      case "bottom-left":
        r$O(t2, -i2, -c2);
        break;
      case "top-right":
        r$O(t2, i2, c2);
        break;
      case "bottom-right":
        r$O(t2, i2, -c2);
    }
    return St(e2, n2, t2), e2;
  };
}();
function bt(t2, e2, n2) {
  return Z$9(t2, e2), t2.rotation += n2, t2;
}
function wt(t2, e2, n2) {
  return Z$9(t2, e2), t2.rotation = n2, t2;
}
const dt = function() {
  const t2 = n$S();
  return function(e2, n2, r2, o2, a2) {
    return Z$9(e2, n2), isNaN(r2) || r2 === 0 || (At(t2, o2, n2, a2), e2.scale = n2.scale * r2, kt(t2, t2, e2, a2), St(e2, e2, r$O(t2, t2[0] - o2[0], o2[1] - t2[1]))), e2;
  };
}();
function jt(t2, e2, n2) {
  return Z$9(t2, e2), t2.scale = n2, t2;
}
const Gt = function() {
  const t2 = n$S();
  return function(e2, n2, r2, o2, a2, i2) {
    return Z$9(e2, n2), isNaN(r2) || r2 === 0 || (At(t2, a2, n2, i2), e2.scale = n2.scale * r2, e2.rotation += o2, kt(t2, t2, e2, i2), St(e2, e2, r$O(t2, t2[0] - a2[0], a2[1] - t2[1]))), e2;
  };
}(), Rt = function() {
  const t2 = n$S(), e2 = n$S();
  return function(n2, r2, o2, a2, i2, c2, s2) {
    return nt$2(e2, c2, s2), s$L(t2, i2, e2), a2 ? Gt(n2, r2, o2, a2, t2, c2) : dt(n2, r2, o2, t2, c2);
  };
}(), At = function() {
  const t2 = e$B();
  return function(e2, n2, r2, o2) {
    return z$i(e2, n2, et(t2, r2, o2, 1));
  };
}(), kt = function() {
  const t2 = e$B();
  return function(e2, n2, r2, o2) {
    return z$i(e2, n2, ft(t2, r2, o2, 1));
  };
}(), St = function() {
  const t2 = n$S(), e2 = e$B();
  return function(n2, r2, o2) {
    Z$9(n2, r2);
    const a2 = ot$1(r2), i2 = n2.targetGeometry;
    return h$G(e2, it(r2)), c$10(e2, e2, r$N(a2, a2)), z$i(t2, o2, e2), i2.x += t2[0], i2.y += t2[1], n2;
  };
}();
class m$S {
  constructor(t2, i2, s2, e2) {
    const o2 = t2.targetGeometry, n2 = i2.targetGeometry;
    e2 ? typeof e2 == "string" && (e2 = r$Q(e2) || t$H.ease) : e2 = t$H.ease, this.easing = e2, this.duration = s2, this.sCenterX = o2.x, this.sCenterY = o2.y, this.sScale = t2.scale, this.sRotation = t2.rotation, this.tCenterX = n2.x, this.tCenterY = n2.y, this.tScale = i2.scale, this.tRotation = i2.rotation, this.dCenterX = this.tCenterX - this.sCenterX, this.dCenterY = this.tCenterY - this.sCenterY, this.dScale = this.tScale - this.sScale, this.dRotation = this.tRotation - this.sRotation, this.dRotation > 180 ? this.dRotation -= 360 : this.dRotation < -180 && (this.dRotation += 360);
  }
  applyRatio(t2, i2) {
    const s2 = this.easing(i2);
    let e2, o2, n2, a2;
    i2 >= 1 ? (e2 = this.tCenterX, o2 = this.tCenterY, n2 = this.tRotation, a2 = this.tScale) : (e2 = this.sCenterX + s2 * this.dCenterX, o2 = this.sCenterY + s2 * this.dCenterY, n2 = this.sRotation + s2 * this.dRotation, a2 = this.sScale + s2 * this.dScale), t2.targetGeometry.x = e2, t2.targetGeometry.y = o2, t2.scale = a2, t2.rotation = n2;
  }
}
let u$B = class extends m$2q {
  constructor(t2) {
    super(t2), this.duration = 200, this.transition = null, this.easing = t$H.ease, this.view = null, this.viewpoint = null, this.viewpoint = new u$1w({ targetGeometry: new w$_(), scale: 0, rotation: 0 }), this._updateTask = A$A({ postRender: this._postRender.bind(this) }), this._updateTask.pause();
  }
  destroy() {
    this._updateTask.remove(), this._updateTask = null;
  }
  animate(t2, i2, s2) {
    this.stop();
    const e2 = this.viewpoint;
    Z$9(e2, i2), this.transition = new m$S(this.viewpoint, t2.target, s2 && s2.duration || this.duration, s2 && s2.easing || this.easing);
    const o2 = () => {
      this.animation === t2 && this._updateTask && (t2.state === "finished" && (this.transition.applyRatio(this.viewpoint, 1), this.view.state && (this.view.state.viewpoint = this.viewpoint.clone())), this.animation = null, this.updateFunction = null);
    };
    return t2.when(o2, o2), this._startTime = performance.now(), this._updateTask.resume(), this.animation = t2, t2;
  }
  animateContinous(t2, i2) {
    this.stop(), this.updateFunction = i2, this.viewpoint = t2;
    const s2 = new p$V({ target: t2.clone() }), e2 = () => {
      this.animation === s2 && this._updateTask && (this.animation = null, this.updateFunction = null);
    };
    return s2.when(e2, e2), this._startTime = performance.now(), this._updateTask.resume(), this.animation = s2, s2;
  }
  stop() {
    this.animation && (this.animation.stop(), this.animation = null, this.updateFunction = null);
  }
  _postRender(t2) {
    const i2 = this.animation;
    if (i2 && i2.state !== p$V.State.STOPPED) {
      if (this.updateFunction)
        this.updateFunction(this.viewpoint, t2.deltaTime);
      else {
        const t3 = (performance.now() - this._startTime) / this.transition.duration, i3 = t3 >= 1;
        this.transition.applyRatio(this.viewpoint, t3), i3 && this.animation.finish();
      }
      this.view.state && (this.view.state.viewpoint = this.viewpoint.clone());
    } else
      this._updateTask.pause();
  }
};
e$2g([y$1I()], u$B.prototype, "animation", void 0), e$2g([y$1I()], u$B.prototype, "duration", void 0), e$2g([y$1I()], u$B.prototype, "transition", void 0), e$2g([y$1I()], u$B.prototype, "easing", void 0), e$2g([y$1I()], u$B.prototype, "view", void 0), e$2g([y$1I()], u$B.prototype, "viewpoint", void 0), u$B = e$2g([n$2P("esri.views.2d.AnimationManager")], u$B);
const d$s = u$B;
class s$J {
  constructor(t2) {
    this.view = t2, this._frameTaskHandle = null, this._updateRequested = false, this.stationary = true, this.animationInProgress = false, this.prepare = () => {
      this._updateParameters.state = this.view.state, this._updateParameters.stationary = this.view.stationary, this._updateParameters.pixelRatio = window.devicePixelRatio, this._updateParameters.renderingOptions = this.view.renderingOptions;
    }, this.update = () => {
      this._updateRequested = false;
      const { basemapView: t3, graphicsView: a2, labelManager: s2, layerViews: i2, state: { id: r2 } } = this.view;
      t3.baseLayerViews.forEach(this._updateLayerView, this), i2.forEach(this._updateLayerView, this), t3.referenceLayerViews.forEach(this._updateLayerView, this), r$1$(s2) && (s2.lastUpdateId !== r2 && (s2.viewChange(), s2.lastUpdateId = r2), s2.updateRequested && s2.processUpdate(this._updateParameters)), r$1$(a2) && (a2.lastUpdateId !== r2 && (a2.viewChange(), a2.lastUpdateId = r2), a2.updateRequested && a2.processUpdate(this._updateParameters)), this.view.graphicsTileStore.setViewState(this._updateParameters.state), this.animationInProgress || this._updateRequested || this._frameTaskHandle.pause();
    };
  }
  destroy() {
    this.stop();
  }
  start() {
    if (this._frameTaskHandle)
      return;
    const e2 = this.view;
    this.stationary = e2.stationary, this._updateParameters = { state: e2.state, pixelRatio: window.devicePixelRatio, stationary: this.stationary, renderingOptions: e2.renderingOptions }, this._stationaryHandle = l$1P(() => e2.stationary, (e3) => {
      this.stationary = e3, this.requestFrame();
    }), this._frameTaskHandle = A$A(this), this.requestUpdate();
  }
  stop() {
    this._frameTaskHandle && (this._updateRequested = false, this._stationaryHandle.remove(), this._frameTaskHandle.remove(), this._updateParameters = this._stationaryHandle = this._frameTaskHandle = null, this.stationary = true, this.animationInProgress = false);
  }
  requestUpdate() {
    this._updateRequested || (this._updateRequested = true, this.requestFrame());
  }
  requestFrame() {
    this._frameTaskHandle && this._frameTaskHandle.resume();
  }
  _updateLayerView(e2) {
    const t2 = this.view.state, a2 = e2.lastUpdateId;
    a2 != null && (this.stationary || e2.moving) || (e2.moving = true, e2.moveStart()), a2 !== t2.id && e2.viewChange(), this.stationary && e2.moving && (e2.moving = false, e2.moveEnd()), e2.lastUpdateId = t2.id, e2.updateRequested && e2.processUpdate(this._updateParameters), "layerViews" in e2 && e2.layerViews.forEach(this._updateLayerView, this);
  }
}
function s$I() {
  return Promise.all([import("./webglDeps.js"), import("./mapViewDeps.js")]);
}
const a$R = () => s$I().then(() => import("./TileLayerView2D.js")), i$W = () => s$I().then(() => import("./FeatureLayerView2D.js")), o$G = { "base-dynamic": () => s$I().then(() => import("./BaseDynamicLayerView2D.js")), "base-tile": a$R, "bing-maps": a$R, csv: i$W, "geo-rss": () => s$I().then(() => import("./GeoRSSLayerView2D.js")), feature: i$W, geojson: i$W, graphics: () => s$I().then(() => import("./GraphicsLayerView2D.js")), group: () => s$I().then(() => import("./GroupLayerView2D.js")), imagery: () => s$I().then(() => import("./ImageryLayerView2D.js")), "imagery-tile": () => s$I().then(() => import("./ImageryTileLayerView2D.js")), kml: () => s$I().then(() => import("./KMLLayerView2D.js")), "map-image": () => s$I().then(() => import("./MapImageLayerView2D.js")), "map-notes": () => s$I().then(() => import("./MapNotesLayerView2D.js")), media: () => s$I().then(() => import("./MediaLayerView2D.js")), "ogc-feature": () => s$I().then(() => import("./OGCFeatureLayerView2D.js")), "open-street-map": a$R, "oriented-imagery": i$W, route: () => s$I().then(() => import("./RouteLayerView2D.js")), stream: () => s$I().then(() => import("./StreamLayerView2D.js")), "subtype-group": () => s$I().then(() => import("./SubtypeGroupLayerView2D.js")), tile: a$R, "vector-tile": () => s$I().then(() => import("./VectorTileLayerView2D.js")), wcs: () => s$I().then(() => import("./ImageryTileLayerView2D.js")), "web-tile": a$R, wfs: i$W, wms: () => s$I().then(() => import("./WMSLayerView2D.js")), wmts: () => s$I().then(() => import("./WMTSLayerView2D.js")), "line-of-sight": null, "base-elevation": null, "building-scene": null, dimension: null, elevation: null, "integrated-mesh": null, "point-cloud": null, voxel: null, scene: null, unknown: null, unsupported: null };
function l$R(r2) {
  const t2 = r2.declaredClass ? r2.declaredClass.slice(r2.declaredClass.lastIndexOf(".") + 1) : "Unknown", s2 = t2.replace(/([a-z])([A-Z])/g, "$1-$2").toLowerCase();
  return new s$2u(`${s2}:view-not-supported`, `${t2} is not supported in 2D`);
}
const n$R = { hasLayerViewModule: (e2) => r$1$(o$G[e2.type]), importLayerView: (e2) => {
  const r2 = o$G[e2.type];
  if (t$2r(r2))
    throw l$R(e2);
  return r2(e2);
} };
function o$F(o2, m2) {
  const { spatialReference: r2 } = m2, i2 = [m2.x, m2.y];
  let s2 = Number.POSITIVE_INFINITY, x2 = 0, c2 = 0;
  const a2 = [0, 0], f2 = o2.type === "extent" ? [[[o2.xmin, o2.ymin], [o2.xmin, o2.ymax], [o2.xmax, o2.ymax], [o2.xmax, o2.ymin], [o2.xmin, o2.ymin]]] : o2.rings;
  for (const n2 of f2)
    for (let o3 = 0; o3 < n2.length - 1; o3++) {
      i$2W(a2, i2, n2, o3);
      const m3 = m$T(i2, a2);
      m3 < s2 && (s2 = m3, x2 = a2[0], c2 = a2[1]);
    }
  return { coordinate: new w$_({ x: x2, y: c2, spatialReference: r2 }), distance: s2 };
}
var l$Q;
let y$l = l$Q = class extends i$2C(m$2q) {
  constructor(e2) {
    super(e2), this.geometry = null, this.spatialReference = null;
  }
  get normalizedGeometry() {
    if (t$2r(this.geometry) || !this.spatialReference)
      return null;
    if (!this.spatialReference.equals(this.geometry.spatialReference))
      try {
        return rn(this.geometry, this.spatialReference);
      } catch (e2) {
        return s$2z.getLogger(this.declaredClass).error("#constraints.geometry", "could not project the geometry to the view's spatial reference", { geometry: this.geometry, spatialReference: this.spatialReference, error: e2 }), null;
      }
    return this.geometry;
  }
  constrain(e2, r2) {
    if (t$2r(this.normalizedGeometry))
      return e2;
    const t2 = e2.targetGeometry;
    if (this.normalizedGeometry.type === "extent" ? r$1M(this.normalizedGeometry, t2) : c$3a(this.normalizedGeometry, t2))
      return e2;
    const { coordinate: o2 } = o$F(this.normalizedGeometry, t2);
    return o2 ? (e2.targetGeometry = o2, e2) : e2;
  }
  clone() {
    var _a2, _b2;
    return new l$Q({ geometry: (_a2 = this.geometry) == null ? void 0 : _a2.clone(), spatialReference: (_b2 = this.spatialReference) == null ? void 0 : _b2.clone() });
  }
};
e$2g([y$1I({ constructOnly: true })], y$l.prototype, "geometry", void 0), e$2g([y$1I({ readOnly: true })], y$l.prototype, "normalizedGeometry", null), e$2g([y$1I({ constructOnly: true })], y$l.prototype, "spatialReference", void 0), y$l = l$Q = e$2g([n$2P("esri.views.2d.constraints.GeometryConstraint")], y$l);
var a$Q;
let n$Q = a$Q = class extends i$2C(m$2q) {
  constructor() {
    super(...arguments), this.enabled = true, this.rotationEnabled = true;
  }
  constrain(o2, r2) {
    return this.enabled && r2 ? (this.rotationEnabled || (o2.rotation = r2.rotation), o2) : o2;
  }
  clone() {
    return new a$Q({ enabled: this.enabled, rotationEnabled: this.rotationEnabled });
  }
};
e$2g([y$1I()], n$Q.prototype, "enabled", void 0), e$2g([y$1I()], n$Q.prototype, "rotationEnabled", void 0), n$Q = a$Q = e$2g([n$2P("esri.views.2d.constraints.RotationConstraint")], n$Q);
const i$V = n$Q;
var a$P;
let c$R = a$P = class extends i$2C(m$2q) {
  constructor(e2) {
    super(e2), this._lodByScale = {}, this._scales = [], this.effectiveLODs = null, this.effectiveMinZoom = -1, this.effectiveMaxZoom = -1, this.effectiveMinScale = 0, this.effectiveMaxScale = 0, this.lods = null, this.minZoom = -1, this.maxZoom = -1, this.minScale = 0, this.maxScale = 0, this.snapToZoom = true;
  }
  initialize() {
    let e2, { lods: t2, minScale: o2, maxScale: s2, minZoom: i2, maxZoom: a2 } = this, c2 = -1, r2 = -1, l2 = false, n2 = false;
    if (o2 !== 0 && s2 !== 0 && o2 < s2 && ([o2, s2] = [s2, o2]), !t2 || !t2.length)
      return this._set("effectiveMinScale", o2), void this._set("effectiveMaxScale", s2);
    t2 = t2.map((e3) => e3.clone()), t2.sort((e3, t3) => t3.scale - e3.scale), t2.forEach((e3, t3) => e3.level = t3);
    for (const f2 of t2)
      !l2 && o2 > 0 && o2 >= f2.scale && (c2 = f2.level, l2 = true), !n2 && s2 > 0 && s2 >= f2.scale && (r2 = e2 ? e2.level : -1, n2 = true), e2 = f2;
    i2 === -1 && (i2 = o2 === 0 ? 0 : c2), a2 === -1 && (a2 = s2 === 0 ? t2.length - 1 : r2), i2 = Math.max(i2, 0), i2 = Math.min(i2, t2.length - 1), a2 = Math.max(a2, 0), a2 = Math.min(a2, t2.length - 1), i2 > a2 && ([i2, a2] = [a2, i2]), o2 = t2[i2].scale, s2 = t2[a2].scale, t2.splice(0, i2), t2.splice(a2 - i2 + 1, t2.length), t2.forEach((e3, t3) => {
      this._lodByScale[e3.scale] = e3, this._scales[t3] = e3.scale;
    }), this._set("effectiveLODs", t2), this._set("effectiveMinZoom", i2), this._set("effectiveMaxZoom", a2), this._set("effectiveMinScale", o2), this._set("effectiveMaxScale", s2);
  }
  constrain(e2, t2) {
    if (t2 && e2.scale === t2.scale)
      return e2;
    const o2 = this.effectiveMinScale, s2 = this.effectiveMaxScale, i2 = e2.targetGeometry, a2 = t2 && t2.targetGeometry, c2 = s2 !== 0 && e2.scale < s2, r2 = o2 !== 0 && e2.scale > o2;
    if (c2 || r2) {
      const c3 = r2 ? o2 : s2;
      if (t2 && a2) {
        const o3 = (c3 - t2.scale) / (e2.scale - t2.scale);
        i2.x = a2.x + (i2.x - a2.x) * o3, i2.y = a2.y + (i2.y - a2.y) * o3;
      }
      e2.scale = c3;
    }
    return this.snapToZoom && this.effectiveLODs && (e2.scale = this._getClosestScale(e2.scale)), e2;
  }
  fit(e2) {
    if (!this.effectiveLODs || !this.snapToZoom)
      return this.constrain(e2, null);
    const t2 = this.scaleToZoom(e2.scale), o2 = Math.abs(t2 - Math.floor(t2));
    return e2.scale = this.zoomToScale(o2 > 0.99 ? Math.round(t2) : Math.floor(t2)), e2;
  }
  zoomToScale(e2) {
    if (!this.effectiveLODs)
      return 0;
    e2 -= this.effectiveMinZoom, e2 = Math.max(0, e2);
    const t2 = this._scales;
    if (e2 <= 0)
      return t2[0];
    if (e2 >= t2.length)
      return t2[t2.length - 1];
    const o2 = Math.round(e2 - 0.5), s2 = Math.round(e2);
    return t2[s2] + (s2 - e2) * (t2[o2] - t2[s2]);
  }
  scaleToZoom(e2) {
    if (!this.effectiveLODs)
      return -1;
    const t2 = this._scales;
    let o2, s2;
    if (e2 >= t2[0])
      return this.effectiveMinZoom;
    if (e2 <= t2[t2.length - 1])
      return this.effectiveMaxZoom;
    for (let i2 = 0; i2 < t2.length - 1; i2++) {
      if (o2 = t2[i2], s2 = t2[i2 + 1], s2 === e2) {
        return i2 + this.effectiveMinZoom + 1;
      }
      if (o2 > e2 && s2 < e2) {
        return i2 + this.effectiveMinZoom + 1 - (e2 - s2) / (o2 - s2);
      }
    }
    return -1;
  }
  snapToClosestScale(e2) {
    if (!this.effectiveLODs)
      return e2;
    const t2 = this.scaleToZoom(e2);
    return this.zoomToScale(Math.round(t2));
  }
  snapToNextScale(e2, t2 = 0.5) {
    if (!this.effectiveLODs)
      return e2 * t2;
    const o2 = Math.round(this.scaleToZoom(e2));
    return this.zoomToScale(o2 + 1);
  }
  snapToPreviousScale(e2, t2 = 2) {
    if (!this.effectiveLODs)
      return e2 * t2;
    const o2 = Math.round(this.scaleToZoom(e2));
    return this.zoomToScale(o2 - 1);
  }
  clone() {
    return new a$P({ lods: this.lods, minZoom: this.minZoom, maxZoom: this.maxZoom, minScale: this.minScale, maxScale: this.maxScale });
  }
  _getClosestScale(e2) {
    return this._lodByScale[e2] || (e2 = this._scales.reduce((t2, o2) => Math.abs(o2 - e2) <= Math.abs(t2 - e2) ? o2 : t2, this._scales[0])), this._lodByScale[e2].scale;
  }
};
e$2g([y$1I({ readOnly: true })], c$R.prototype, "effectiveLODs", void 0), e$2g([y$1I({ readOnly: true })], c$R.prototype, "effectiveMinZoom", void 0), e$2g([y$1I({ readOnly: true })], c$R.prototype, "effectiveMaxZoom", void 0), e$2g([y$1I({ readOnly: true })], c$R.prototype, "effectiveMinScale", void 0), e$2g([y$1I({ readOnly: true })], c$R.prototype, "effectiveMaxScale", void 0), e$2g([y$1I()], c$R.prototype, "lods", void 0), e$2g([y$1I()], c$R.prototype, "minZoom", void 0), e$2g([y$1I()], c$R.prototype, "maxZoom", void 0), e$2g([y$1I()], c$R.prototype, "minScale", void 0), e$2g([y$1I()], c$R.prototype, "maxScale", void 0), e$2g([y$1I()], c$R.prototype, "snapToZoom", void 0), c$R = a$P = e$2g([n$2P("esri.views.2d.constraints.ZoomConstraint")], c$R);
const r$M = c$R;
const p$T = { base: null, key: "type", typeMap: { extent: w$Z, polygon: v$15 } };
let c$Q = class extends m$2q {
  constructor(o2) {
    super(o2), this.lods = null, this.minScale = 0, this.maxScale = 0, this.minZoom = -1, this.maxZoom = -1, this.rotationEnabled = true, this.snapToZoom = true;
  }
  destroy() {
    this.view = null;
  }
  get effectiveLODs() {
    return this._zoom.effectiveLODs;
  }
  get effectiveMinScale() {
    return this._zoom.effectiveMinScale;
  }
  get effectiveMaxScale() {
    return this._zoom.effectiveMaxScale;
  }
  get effectiveMinZoom() {
    return this._zoom.effectiveMinZoom;
  }
  get effectiveMaxZoom() {
    return this._zoom.effectiveMaxZoom;
  }
  set geometry(o2) {
    o2 ? this._set("geometry", o2) : this._set("geometry", null);
  }
  get version() {
    var _a2, _b2, _c2;
    return `${(_a2 = this._zoom) == null ? void 0 : _a2.uid}/${(_b2 = this._rotation) == null ? void 0 : _b2.uid}/${(_c2 = this._geometry) == null ? void 0 : _c2.uid}`;
  }
  get _defaultLODs() {
    var _a2, _b2, _c2;
    const o2 = (_b2 = (_a2 = this.view) == null ? void 0 : _a2.defaultsFromMap) == null ? void 0 : _b2.tileInfo, e2 = (_c2 = this.view) == null ? void 0 : _c2.spatialReference;
    return o2 && e2 && o2.spatialReference.equals(e2) ? o2.lods : null;
  }
  get _geometry() {
    var _a2;
    return new y$l({ geometry: this.geometry, spatialReference: (_a2 = this.view) == null ? void 0 : _a2.spatialReference });
  }
  get _rotation() {
    return new i$V({ rotationEnabled: this.rotationEnabled });
  }
  get _zoom() {
    const o2 = this._get("_zoom"), e2 = this.lods || this._defaultLODs, t2 = this.minZoom, r2 = this.maxZoom, s2 = this.minScale, i2 = this.maxScale, n2 = this.snapToZoom;
    return o2 && o2.lods === e2 && o2.minZoom === t2 && o2.maxZoom === r2 && o2.minScale === s2 && o2.maxScale === i2 && o2.snapToZoom === n2 ? o2 : new r$M({ lods: e2, minZoom: t2, maxZoom: r2, minScale: s2, maxScale: i2, snapToZoom: n2 });
  }
  canZoomInTo(o2) {
    const e2 = this.effectiveMaxScale;
    return e2 === 0 || o2 >= e2;
  }
  canZoomOutTo(o2) {
    const e2 = this.effectiveMinScale;
    return e2 === 0 || o2 <= e2;
  }
  constrain(o2, e2) {
    return this._zoom.constrain(o2, e2), this._rotation.constrain(o2, e2), this._geometry.constrain(o2, e2), o2;
  }
  constrainByGeometry(o2) {
    return this._geometry.constrain(o2);
  }
  fit(o2) {
    return this._zoom.fit(o2);
  }
  zoomToScale(o2) {
    return this._zoom.zoomToScale(o2);
  }
  scaleToZoom(o2) {
    return this._zoom.scaleToZoom(o2);
  }
  snapScale(o2) {
    return this._zoom.snapToClosestScale(o2);
  }
  snapToNextScale(o2) {
    return this._zoom.snapToNextScale(o2);
  }
  snapToPreviousScale(o2) {
    return this._zoom.snapToPreviousScale(o2);
  }
};
e$2g([y$1I({ readOnly: true })], c$Q.prototype, "effectiveLODs", null), e$2g([y$1I({ readOnly: true })], c$Q.prototype, "effectiveMinScale", null), e$2g([y$1I({ readOnly: true })], c$Q.prototype, "effectiveMaxScale", null), e$2g([y$1I({ readOnly: true })], c$Q.prototype, "effectiveMinZoom", null), e$2g([y$1I({ readOnly: true })], c$Q.prototype, "effectiveMaxZoom", null), e$2g([y$1I({ types: p$T, value: null })], c$Q.prototype, "geometry", null), e$2g([y$1I({ type: [p$2u] })], c$Q.prototype, "lods", void 0), e$2g([y$1I()], c$Q.prototype, "minScale", void 0), e$2g([y$1I()], c$Q.prototype, "maxScale", void 0), e$2g([y$1I()], c$Q.prototype, "minZoom", void 0), e$2g([y$1I()], c$Q.prototype, "maxZoom", void 0), e$2g([y$1I()], c$Q.prototype, "rotationEnabled", void 0), e$2g([y$1I()], c$Q.prototype, "snapToZoom", void 0), e$2g([y$1I()], c$Q.prototype, "view", void 0), e$2g([y$1I({ readOnly: true })], c$Q.prototype, "version", null), e$2g([y$1I()], c$Q.prototype, "_defaultLODs", null), e$2g([y$1I({ type: y$l })], c$Q.prototype, "_geometry", null), e$2g([y$1I({ type: i$V })], c$Q.prototype, "_rotation", null), e$2g([y$1I({ readOnly: true, type: r$M })], c$Q.prototype, "_zoom", null), c$Q = e$2g([n$2P("esri.views.2d.MapViewConstraints")], c$Q);
const u$A = c$Q;
function a$O(t2, a2) {
  return t2[0] = a2[0], t2[1] = a2[1], t2[2] = a2[2], t2[3] = a2[4], t2[4] = a2[5], t2[5] = a2[6], t2[6] = a2[8], t2[7] = a2[9], t2[8] = a2[10], t2;
}
function n$P(t2, a2) {
  return t2[0] = a2[0], t2[1] = a2[1], t2[2] = a2[2], t2[3] = a2[3], t2[4] = a2[4], t2[5] = a2[5], t2[6] = a2[6], t2[7] = a2[7], t2[8] = a2[8], t2;
}
function s$H(t2, a2, n2, s2, r2, o2, u2, c2, e2, i2) {
  return t2[0] = a2, t2[1] = n2, t2[2] = s2, t2[3] = r2, t2[4] = o2, t2[5] = u2, t2[6] = c2, t2[7] = e2, t2[8] = i2, t2;
}
function r$L(t2) {
  return t2[0] = 1, t2[1] = 0, t2[2] = 0, t2[3] = 0, t2[4] = 1, t2[5] = 0, t2[6] = 0, t2[7] = 0, t2[8] = 1, t2;
}
function o$E(t2, a2) {
  if (t2 === a2) {
    const n2 = a2[1], s2 = a2[2], r2 = a2[5];
    t2[1] = a2[3], t2[2] = a2[6], t2[3] = n2, t2[5] = a2[7], t2[6] = s2, t2[7] = r2;
  } else
    t2[0] = a2[0], t2[1] = a2[3], t2[2] = a2[6], t2[3] = a2[1], t2[4] = a2[4], t2[5] = a2[7], t2[6] = a2[2], t2[7] = a2[5], t2[8] = a2[8];
  return t2;
}
function u$z(t2, a2) {
  const n2 = a2[0], s2 = a2[1], r2 = a2[2], o2 = a2[3], u2 = a2[4], c2 = a2[5], e2 = a2[6], i2 = a2[7], M2 = a2[8], h2 = M2 * u2 - c2 * i2, f2 = -M2 * o2 + c2 * e2, b2 = i2 * o2 - u2 * e2;
  let l2 = n2 * h2 + s2 * f2 + r2 * b2;
  return l2 ? (l2 = 1 / l2, t2[0] = h2 * l2, t2[1] = (-M2 * s2 + r2 * i2) * l2, t2[2] = (c2 * s2 - r2 * u2) * l2, t2[3] = f2 * l2, t2[4] = (M2 * n2 - r2 * e2) * l2, t2[5] = (-c2 * n2 + r2 * o2) * l2, t2[6] = b2 * l2, t2[7] = (-i2 * n2 + s2 * e2) * l2, t2[8] = (u2 * n2 - s2 * o2) * l2, t2) : null;
}
function c$P(t2, a2) {
  const n2 = a2[0], s2 = a2[1], r2 = a2[2], o2 = a2[3], u2 = a2[4], c2 = a2[5], e2 = a2[6], i2 = a2[7], M2 = a2[8];
  return t2[0] = u2 * M2 - c2 * i2, t2[1] = r2 * i2 - s2 * M2, t2[2] = s2 * c2 - r2 * u2, t2[3] = c2 * e2 - o2 * M2, t2[4] = n2 * M2 - r2 * e2, t2[5] = r2 * o2 - n2 * c2, t2[6] = o2 * i2 - u2 * e2, t2[7] = s2 * e2 - n2 * i2, t2[8] = n2 * u2 - s2 * o2, t2;
}
function e$y(t2) {
  const a2 = t2[0], n2 = t2[1], s2 = t2[2], r2 = t2[3], o2 = t2[4], u2 = t2[5], c2 = t2[6], e2 = t2[7], i2 = t2[8];
  return a2 * (i2 * o2 - u2 * e2) + n2 * (-i2 * r2 + u2 * c2) + s2 * (e2 * r2 - o2 * c2);
}
function i$U(t2, a2, n2) {
  const s2 = a2[0], r2 = a2[1], o2 = a2[2], u2 = a2[3], c2 = a2[4], e2 = a2[5], i2 = a2[6], M2 = a2[7], h2 = a2[8], f2 = n2[0], b2 = n2[1], l2 = n2[2], m2 = n2[3], d2 = n2[4], x2 = n2[5], p2 = n2[6], y2 = n2[7], g2 = n2[8];
  return t2[0] = f2 * s2 + b2 * u2 + l2 * i2, t2[1] = f2 * r2 + b2 * c2 + l2 * M2, t2[2] = f2 * o2 + b2 * e2 + l2 * h2, t2[3] = m2 * s2 + d2 * u2 + x2 * i2, t2[4] = m2 * r2 + d2 * c2 + x2 * M2, t2[5] = m2 * o2 + d2 * e2 + x2 * h2, t2[6] = p2 * s2 + y2 * u2 + g2 * i2, t2[7] = p2 * r2 + y2 * c2 + g2 * M2, t2[8] = p2 * o2 + y2 * e2 + g2 * h2, t2;
}
function M$g(t2, a2, n2) {
  const s2 = a2[0], r2 = a2[1], o2 = a2[2], u2 = a2[3], c2 = a2[4], e2 = a2[5], i2 = a2[6], M2 = a2[7], h2 = a2[8], f2 = n2[0], b2 = n2[1];
  return t2[0] = s2, t2[1] = r2, t2[2] = o2, t2[3] = u2, t2[4] = c2, t2[5] = e2, t2[6] = f2 * s2 + b2 * u2 + i2, t2[7] = f2 * r2 + b2 * c2 + M2, t2[8] = f2 * o2 + b2 * e2 + h2, t2;
}
function h$B(t2, a2, n2) {
  const s2 = a2[0], r2 = a2[1], o2 = a2[2], u2 = a2[3], c2 = a2[4], e2 = a2[5], i2 = a2[6], M2 = a2[7], h2 = a2[8], f2 = Math.sin(n2), b2 = Math.cos(n2);
  return t2[0] = b2 * s2 + f2 * u2, t2[1] = b2 * r2 + f2 * c2, t2[2] = b2 * o2 + f2 * e2, t2[3] = b2 * u2 - f2 * s2, t2[4] = b2 * c2 - f2 * r2, t2[5] = b2 * e2 - f2 * o2, t2[6] = i2, t2[7] = M2, t2[8] = h2, t2;
}
function f$v(t2, a2, n2) {
  const s2 = n2[0], r2 = n2[1], o2 = n2[2];
  return t2[0] = s2 * a2[0], t2[1] = s2 * a2[1], t2[2] = s2 * a2[2], t2[3] = r2 * a2[3], t2[4] = r2 * a2[4], t2[5] = r2 * a2[5], t2[6] = o2 * a2[6], t2[7] = o2 * a2[7], t2[8] = o2 * a2[8], t2;
}
function b$j(t2, a2, n2) {
  const s2 = n2[0], r2 = n2[1];
  return t2[0] = s2 * a2[0], t2[1] = s2 * a2[1], t2[2] = s2 * a2[2], t2[3] = r2 * a2[3], t2[4] = r2 * a2[4], t2[5] = r2 * a2[5], t2;
}
function l$P(t2, a2) {
  return t2[0] = 1, t2[1] = 0, t2[2] = 0, t2[3] = 0, t2[4] = 1, t2[5] = 0, t2[6] = a2[0], t2[7] = a2[1], t2[8] = 1, t2;
}
function m$R(t2, a2) {
  const n2 = Math.sin(a2), s2 = Math.cos(a2);
  return t2[0] = s2, t2[1] = n2, t2[2] = 0, t2[3] = -n2, t2[4] = s2, t2[5] = 0, t2[6] = 0, t2[7] = 0, t2[8] = 1, t2;
}
function d$r(t2, a2) {
  return t2[0] = a2[0], t2[1] = 0, t2[2] = 0, t2[3] = 0, t2[4] = a2[1], t2[5] = 0, t2[6] = 0, t2[7] = 0, t2[8] = 1, t2;
}
function x$j(t2, a2) {
  return t2[0] = a2[0], t2[1] = a2[1], t2[2] = 0, t2[3] = a2[2], t2[4] = a2[3], t2[5] = 0, t2[6] = a2[4], t2[7] = a2[5], t2[8] = 1, t2;
}
function p$S(t2, a2) {
  const n2 = a2[0], s2 = a2[1], r2 = a2[2], o2 = a2[3], u2 = n2 + n2, c2 = s2 + s2, e2 = r2 + r2, i2 = n2 * u2, M2 = s2 * u2, h2 = s2 * c2, f2 = r2 * u2, b2 = r2 * c2, l2 = r2 * e2, m2 = o2 * u2, d2 = o2 * c2, x2 = o2 * e2;
  return t2[0] = 1 - h2 - l2, t2[3] = M2 - x2, t2[6] = f2 + d2, t2[1] = M2 + x2, t2[4] = 1 - i2 - l2, t2[7] = b2 - m2, t2[2] = f2 - d2, t2[5] = b2 + m2, t2[8] = 1 - i2 - h2, t2;
}
function y$k(t2, a2) {
  const n2 = a2[0], s2 = a2[1], r2 = a2[2], o2 = a2[4], u2 = a2[5], c2 = a2[6], e2 = a2[8], i2 = a2[9], M2 = a2[10], h2 = M2 * u2 - c2 * i2, f2 = -M2 * o2 + c2 * e2, b2 = i2 * o2 - u2 * e2, l2 = n2 * h2 + s2 * f2 + r2 * b2;
  if (!l2)
    return null;
  const m2 = 1 / l2;
  return t2[0] = h2 * m2, t2[1] = (-M2 * s2 + r2 * i2) * m2, t2[2] = (c2 * s2 - r2 * u2) * m2, t2[3] = f2 * m2, t2[4] = (M2 * n2 - r2 * e2) * m2, t2[5] = (-c2 * n2 + r2 * o2) * m2, t2[6] = b2 * m2, t2[7] = (-i2 * n2 + s2 * e2) * m2, t2[8] = (u2 * n2 - s2 * o2) * m2, t2;
}
function g$l(t2, a2) {
  const n2 = a2[0], s2 = a2[1], r2 = a2[2], o2 = a2[3], u2 = a2[4], c2 = a2[5], e2 = a2[6], i2 = a2[7], M2 = a2[8], h2 = a2[9], f2 = a2[10], b2 = a2[11], l2 = a2[12], m2 = a2[13], d2 = a2[14], x2 = a2[15], p2 = n2 * c2 - s2 * u2, y2 = n2 * e2 - r2 * u2, g2 = n2 * i2 - o2 * u2, j2 = s2 * e2 - r2 * c2, S2 = s2 * i2 - o2 * c2, q2 = r2 * i2 - o2 * e2, _2 = M2 * m2 - h2 * l2, v2 = M2 * d2 - f2 * l2, A2 = M2 * x2 - b2 * l2, F2 = h2 * d2 - f2 * m2, O2 = h2 * x2 - b2 * m2, z2 = f2 * x2 - b2 * d2;
  let B2 = p2 * z2 - y2 * O2 + g2 * F2 + j2 * A2 - S2 * v2 + q2 * _2;
  return B2 ? (B2 = 1 / B2, t2[0] = (c2 * z2 - e2 * O2 + i2 * F2) * B2, t2[1] = (e2 * A2 - u2 * z2 - i2 * v2) * B2, t2[2] = (u2 * O2 - c2 * A2 + i2 * _2) * B2, t2[3] = (r2 * O2 - s2 * z2 - o2 * F2) * B2, t2[4] = (n2 * z2 - r2 * A2 + o2 * v2) * B2, t2[5] = (s2 * A2 - n2 * O2 - o2 * _2) * B2, t2[6] = (m2 * q2 - d2 * S2 + x2 * j2) * B2, t2[7] = (d2 * g2 - l2 * q2 - x2 * y2) * B2, t2[8] = (l2 * S2 - m2 * g2 + x2 * p2) * B2, t2) : null;
}
function j$d(t2, a2, n2) {
  return t2[0] = 2 / a2, t2[1] = 0, t2[2] = 0, t2[3] = 0, t2[4] = -2 / n2, t2[5] = 0, t2[6] = -1, t2[7] = 1, t2[8] = 1, t2;
}
function S$d(t2) {
  return "mat3(" + t2[0] + ", " + t2[1] + ", " + t2[2] + ", " + t2[3] + ", " + t2[4] + ", " + t2[5] + ", " + t2[6] + ", " + t2[7] + ", " + t2[8] + ")";
}
function q$d(t2) {
  return Math.sqrt(t2[0] ** 2 + t2[1] ** 2 + t2[2] ** 2 + t2[3] ** 2 + t2[4] ** 2 + t2[5] ** 2 + t2[6] ** 2 + t2[7] ** 2 + t2[8] ** 2);
}
function _$h(t2, a2, n2) {
  return t2[0] = a2[0] + n2[0], t2[1] = a2[1] + n2[1], t2[2] = a2[2] + n2[2], t2[3] = a2[3] + n2[3], t2[4] = a2[4] + n2[4], t2[5] = a2[5] + n2[5], t2[6] = a2[6] + n2[6], t2[7] = a2[7] + n2[7], t2[8] = a2[8] + n2[8], t2;
}
function v$l(t2, a2, n2) {
  return t2[0] = a2[0] - n2[0], t2[1] = a2[1] - n2[1], t2[2] = a2[2] - n2[2], t2[3] = a2[3] - n2[3], t2[4] = a2[4] - n2[4], t2[5] = a2[5] - n2[5], t2[6] = a2[6] - n2[6], t2[7] = a2[7] - n2[7], t2[8] = a2[8] - n2[8], t2;
}
function A$b(t2, a2, n2) {
  return t2[0] = a2[0] * n2, t2[1] = a2[1] * n2, t2[2] = a2[2] * n2, t2[3] = a2[3] * n2, t2[4] = a2[4] * n2, t2[5] = a2[5] * n2, t2[6] = a2[6] * n2, t2[7] = a2[7] * n2, t2[8] = a2[8] * n2, t2;
}
function F$e(t2, a2, n2, s2) {
  return t2[0] = a2[0] + n2[0] * s2, t2[1] = a2[1] + n2[1] * s2, t2[2] = a2[2] + n2[2] * s2, t2[3] = a2[3] + n2[3] * s2, t2[4] = a2[4] + n2[4] * s2, t2[5] = a2[5] + n2[5] * s2, t2[6] = a2[6] + n2[6] * s2, t2[7] = a2[7] + n2[7] * s2, t2[8] = a2[8] + n2[8] * s2, t2;
}
function O$f(t2, a2) {
  return t2[0] === a2[0] && t2[1] === a2[1] && t2[2] === a2[2] && t2[3] === a2[3] && t2[4] === a2[4] && t2[5] === a2[5] && t2[6] === a2[6] && t2[7] === a2[7] && t2[8] === a2[8];
}
function z$h(a2, n2) {
  const s2 = a2[0], r2 = a2[1], o2 = a2[2], u2 = a2[3], c2 = a2[4], e2 = a2[5], i2 = a2[6], M2 = a2[7], h2 = a2[8], f2 = n2[0], b2 = n2[1], l2 = n2[2], m2 = n2[3], d2 = n2[4], x2 = n2[5], p2 = n2[6], y2 = n2[7], g2 = n2[8], j2 = a$2x();
  return Math.abs(s2 - f2) <= j2 * Math.max(1, Math.abs(s2), Math.abs(f2)) && Math.abs(r2 - b2) <= j2 * Math.max(1, Math.abs(r2), Math.abs(b2)) && Math.abs(o2 - l2) <= j2 * Math.max(1, Math.abs(o2), Math.abs(l2)) && Math.abs(u2 - m2) <= j2 * Math.max(1, Math.abs(u2), Math.abs(m2)) && Math.abs(c2 - d2) <= j2 * Math.max(1, Math.abs(c2), Math.abs(d2)) && Math.abs(e2 - x2) <= j2 * Math.max(1, Math.abs(e2), Math.abs(x2)) && Math.abs(i2 - p2) <= j2 * Math.max(1, Math.abs(i2), Math.abs(p2)) && Math.abs(M2 - y2) <= j2 * Math.max(1, Math.abs(M2), Math.abs(y2)) && Math.abs(h2 - g2) <= j2 * Math.max(1, Math.abs(h2), Math.abs(g2));
}
function B$b(a2) {
  const n2 = a$2x(), s2 = a2[0], r2 = a2[1], o2 = a2[2], u2 = a2[3], c2 = a2[4], e2 = a2[5], i2 = a2[6], M2 = a2[7], h2 = a2[8];
  return Math.abs(1 - (s2 * s2 + u2 * u2 + i2 * i2)) <= n2 && Math.abs(1 - (r2 * r2 + c2 * c2 + M2 * M2)) <= n2 && Math.abs(1 - (o2 * o2 + e2 * e2 + h2 * h2)) <= n2;
}
const E$k = i$U, T$d = v$l;
Object.freeze(Object.defineProperty({ __proto__: null, fromMat4: a$O, copy: n$P, set: s$H, identity: r$L, transpose: o$E, invert: u$z, adjoint: c$P, determinant: e$y, multiply: i$U, translate: M$g, rotate: h$B, scale: f$v, scaleByVec2: b$j, fromTranslation: l$P, fromRotation: m$R, fromScaling: d$r, fromMat2d: x$j, fromQuat: p$S, normalFromMat4Legacy: y$k, normalFromMat4: g$l, projection: j$d, str: S$d, frob: q$d, add: _$h, subtract: v$l, multiplyScalar: A$b, multiplyScalarAndAdd: F$e, exactEquals: O$f, equals: z$h, isOrthoNormal: B$b, mul: E$k, sub: T$d }, Symbol.toStringTag, { value: "Module" }));
function e$x() {
  const e2 = new Float32Array(9);
  return e2[0] = 1, e2[4] = 1, e2[8] = 1, e2;
}
function r$K(e2) {
  const r2 = new Float32Array(9);
  return r2[0] = e2[0], r2[1] = e2[1], r2[2] = e2[2], r2[3] = e2[3], r2[4] = e2[4], r2[5] = e2[5], r2[6] = e2[6], r2[7] = e2[7], r2[8] = e2[8], r2;
}
function t$E(e2, r2, t2, n2, o2, a2, c2, u2, l2) {
  const s2 = new Float32Array(9);
  return s2[0] = e2, s2[1] = r2, s2[2] = t2, s2[3] = n2, s2[4] = o2, s2[5] = a2, s2[6] = c2, s2[7] = u2, s2[8] = l2, s2;
}
function n$O(e2, r2) {
  return new Float32Array(e2, r2, 9);
}
Object.freeze(Object.defineProperty({ __proto__: null, create: e$x, clone: r$K, fromValues: t$E, createView: n$O }, Symbol.toStringTag, { value: "Module" }));
function n$N() {
  return new Float32Array(2);
}
function r$J(n2) {
  const r2 = new Float32Array(2);
  return r2[0] = n2[0], r2[1] = n2[1], r2;
}
function t$D(n2, r2) {
  const t2 = new Float32Array(2);
  return t2[0] = n2, t2[1] = r2, t2;
}
function e$w(n2, r2) {
  return new Float32Array(n2, r2, 2);
}
function a$N() {
  return n$N();
}
function o$D() {
  return t$D(1, 1);
}
function u$y() {
  return t$D(1, 0);
}
function s$G() {
  return t$D(0, 1);
}
const c$O = a$N(), i$T = o$D(), f$u = u$y(), l$O = s$G();
Object.freeze(Object.defineProperty({ __proto__: null, create: n$N, clone: r$J, fromValues: t$D, createView: e$w, zeros: a$N, ones: o$D, unitX: u$y, unitY: s$G, ZEROS: c$O, ONES: i$T, UNIT_X: f$u, UNIT_Y: l$O }, Symbol.toStringTag, { value: "Module" }));
function n$M(n2) {
  return n2 instanceof Float32Array && n2.length >= 2;
}
function r$I(n2) {
  return Array.isArray(n2) && n2.length >= 2;
}
function t$C(t2) {
  return n$M(t2) || r$I(t2);
}
var b$i;
const G$e = [0, 0];
let O$e = b$i = class extends l$2B {
  constructor(t2) {
    super(t2), this._viewpoint2D = { center: n$S(), rotation: 0, scale: 0, spatialReference: null }, this.center = [0, 0], this.extent = new w$Z(), this.id = 0, this.inverseTransform = e$B(), this.resolution = 0, this.rotation = 0, this.scale = 0, this.transform = e$B(), this.transformNoRotation = e$B(), this.displayMat3 = e$x(), this.displayViewMat3 = e$x(), this.viewMat3 = e$x(), this.viewMat2d = n$13(), this.worldScreenWidth = 0, this.size = [0, 0];
  }
  set pixelRatio(t2) {
    this._set("pixelRatio", t2), this._update();
  }
  set size(t2) {
    this._set("size", t2), this._update();
  }
  set viewpoint(t2) {
    if (t2) {
      const s2 = this._viewpoint2D, i2 = t2.targetGeometry;
      s2.center[0] = i2.x, s2.center[1] = i2.y, s2.rotation = t2.rotation, s2.scale = t2.scale, s2.spatialReference = i2.spatialReference;
    }
    this._update();
  }
  copy(t2) {
    const s2 = this.size, i2 = this.viewpoint;
    return i2 && s2 ? (this.viewpoint = Z$9(i2, t2.viewpoint), this._set("size", a$T(s2, t2.size))) : (this.viewpoint = t2.viewpoint.clone(), this._set("size", [t2.size[0], t2.size[1]])), this._set("pixelRatio", t2.pixelRatio), this;
  }
  clone() {
    return new b$i({ size: this.size, viewpoint: this.viewpoint.clone(), pixelRatio: this.pixelRatio });
  }
  toMap(t2, s2, i2) {
    return t$C(s2) ? z$i(t2, s2, this.inverseTransform) : (G$e[0] = s2, G$e[1] = i2, z$i(t2, G$e, this.inverseTransform));
  }
  toScreen(t2, s2, i2) {
    return t$C(s2) ? z$i(t2, s2, this.transform) : (G$e[0] = s2, G$e[1] = i2, z$i(t2, G$e, this.transform));
  }
  toScreenNoRotation(t2, s2, i2) {
    return t$C(s2) ? z$i(t2, s2, this.transformNoRotation) : (G$e[0] = s2, G$e[1] = i2, z$i(t2, G$e, this.transformNoRotation));
  }
  getScreenTransform(t2, s2) {
    const { center: i2 } = this._viewpoint2D, e2 = this._get("pixelRatio") || 1, o2 = this._get("size");
    return ut(t2, i2, o2, s2, 0, e2), t2;
  }
  _update() {
    const { center: t2, spatialReference: i2, scale: e2, rotation: o2 } = this._viewpoint2D, c2 = this._get("pixelRatio") || 1, m2 = this._get("size"), d2 = new u$1w({ targetGeometry: new w$_(t2[0], t2[1], i2), scale: e2, rotation: o2 });
    if (this._set("viewpoint", d2), !m2 || !i2 || !e2)
      return;
    this.resolution = ot$1(d2), this.rotation = o2, this.scale = e2, this.spatialReference = i2, a$T(this.center, t2);
    const y2 = m2[0] !== 0 ? 2 / m2[0] : 0, _2 = m2[1] !== 0 ? -2 / m2[1] : 0;
    s$H(this.displayMat3, y2, 0, 0, 0, _2, 0, -1, 1, 1);
    const x2 = r$L(this.viewMat3), z2 = t$D(m2[0] / 2, m2[1] / 2), g2 = t$D(-m2[0] / 2, -m2[1] / 2), D2 = r$1A(o2);
    M$g(x2, x2, z2), h$B(x2, x2, D2), M$g(x2, x2, g2), i$U(this.displayViewMat3, this.displayMat3, x2);
    const b2 = f$E(this.viewMat2d, z2);
    return e$H(b2, b2, D2), i$1c(b2, b2, g2), _$i(this.extent, d2, m2), ft(this.transform, d2, m2, c2), r$U(this.inverseTransform, this.transform), lt(this.transformNoRotation, d2, m2, c2), this.worldScreenWidth = yt(this.spatialReference, this.resolution), this._set("id", this.id + 1), this;
  }
};
e$2g([y$1I({ readOnly: true })], O$e.prototype, "id", void 0), e$2g([y$1I({ value: 1, json: { write: true } })], O$e.prototype, "pixelRatio", null), e$2g([y$1I({ json: { write: true } })], O$e.prototype, "size", null), e$2g([y$1I()], O$e.prototype, "spatialReference", void 0), e$2g([y$1I({ type: u$1w, json: { write: true } })], O$e.prototype, "viewpoint", null), O$e = b$i = e$2g([n$2P("esri.views.2d.ViewState")], O$e);
const U$9 = O$e;
var l$N, m$Q;
let w$g = l$N = class extends m$2q {
  constructor() {
    super(...arguments), this.left = 0, this.top = 0, this.right = 0, this.bottom = 0;
  }
  clone() {
    return new l$N({ left: this.left, top: this.top, right: this.right, bottom: this.bottom });
  }
};
e$2g([y$1I()], w$g.prototype, "left", void 0), e$2g([y$1I()], w$g.prototype, "top", void 0), e$2g([y$1I()], w$g.prototype, "right", void 0), e$2g([y$1I()], w$g.prototype, "bottom", void 0), w$g = l$N = e$2g([n$2P("esri.views.2d.PaddedViewState.Padding")], w$g);
let u$x = m$Q = class extends U$9 {
  constructor(...t2) {
    super(...t2), this.paddedViewState = new U$9(), this._updateContent = (() => {
      const t3 = n$S();
      return () => {
        const e2 = this._get("size"), i2 = this._get("padding");
        if (!e2 || !i2)
          return;
        const o2 = this.paddedViewState;
        r$O(t3, i2.left + i2.right, i2.top + i2.bottom), o$I(t3, e2, t3), a$T(o2.size, t3);
        const s2 = o2.viewpoint;
        s2 && (this.viewpoint = s2);
      };
    })(), this.addHandles(l$1P(() => [this.size, this.padding], () => this._updateContent(), U$r)), this.padding = new w$g(), this.size = [0, 0];
  }
  set padding(t2) {
    this._set("padding", t2 || new w$g());
  }
  set viewpoint(t2) {
    if (t2) {
      const e2 = t2.clone();
      this.paddedViewState.viewpoint = t2, gt(e2, t2, this._get("size"), this._get("padding"));
      const i2 = this._viewpoint2D, o2 = e2.targetGeometry;
      i2.center[0] = o2.x, i2.center[1] = o2.y, i2.rotation = e2.rotation, i2.scale = e2.scale, i2.spatialReference = o2.spatialReference, this._update();
    }
  }
  clone() {
    return new m$Q({ padding: this.padding.clone(), size: this.size.slice(), viewpoint: this.paddedViewState.viewpoint.clone(), pixelRatio: this.pixelRatio });
  }
};
e$2g([y$1I()], u$x.prototype, "paddedViewState", void 0), e$2g([y$1I({ type: w$g })], u$x.prototype, "padding", null), e$2g([y$1I()], u$x.prototype, "viewpoint", null), u$x = m$Q = e$2g([n$2P("esri.views.2d.PaddedViewState")], u$x);
const f$t = u$x;
class u$w {
  constructor(e2, s2) {
    this.item = e2, this.controller = s2, this.promise = null;
  }
}
class l$M {
  constructor(s2) {
    this._deferreds = new Map(), this._controllers = new Map(), this._processingItems = new Map(), this._isPaused = false, this._schedule = null, this._task = null, this.concurrency = 1, s2.concurrency && (this.concurrency = s2.concurrency), this._queue = new e$1t(s2.peeker), this.process = s2.process;
    const t2 = s2.scheduler;
    s2.priority && r$1$(t2) && (this._task = t2.registerTask(s2.priority, this));
  }
  destroy() {
    this.clear(), this._schedule && (this._schedule.remove(), this._schedule = null), this._task && (this._task.remove(), this._task = null);
  }
  get length() {
    return this._processingItems.size + this._queue.length;
  }
  abort(e2) {
    const s2 = this._controllers.get(e2);
    s2 && s2.abort();
  }
  clear() {
    this._queue.clear();
    const e2 = [];
    this._controllers.forEach((s2) => e2.push(s2)), this._controllers.clear(), e2.forEach((e3) => e3.abort()), this._processingItems.clear(), this._cancelNext();
  }
  forEach(e2) {
    this._deferreds.forEach((s2, t2) => e2(t2));
  }
  get(e2) {
    const s2 = this._deferreds.get(e2);
    return s2 ? s2.promise : void 0;
  }
  isOngoing(e2) {
    return this._processingItems.has(e2);
  }
  has(e2) {
    return this._deferreds.has(e2);
  }
  pause() {
    this._isPaused || (this._isPaused = true, this._cancelNext());
  }
  push(s2, h2) {
    const c2 = this.get(s2);
    if (c2)
      return c2;
    const n2 = new AbortController();
    let u2 = null;
    h2 && (u2 = v$19(h2, () => n2.abort()));
    const l2 = () => {
      const e2 = this._processingItems.get(s2);
      e2 && e2.controller.abort(), _2(), a2.reject(a$2T());
    }, _2 = () => {
      p2.remove(), r$1$(u2) && u2.remove(), this._deferreds.delete(s2), this._controllers.delete(s2), this._queue.remove(s2), this._processingItems.delete(s2), this._scheduleNext();
    }, p2 = d$1X(n2.signal, l2), a2 = A$B();
    return this._deferreds.set(s2, a2), this._controllers.set(s2, n2), a2.promise.then(_2, _2), this._queue.push(s2), this._scheduleNext(), a2.promise;
  }
  last() {
    return this._queue.last();
  }
  peek() {
    return this._queue.peek();
  }
  popLast() {
    return this._queue.popLast();
  }
  reset() {
    const e2 = [];
    this._processingItems.forEach((s2) => e2.push(s2)), this._processingItems.clear();
    for (const s2 of e2)
      this._queue.push(s2.item), s2.controller.abort();
    this._scheduleNext();
  }
  resume() {
    this._isPaused && (this._isPaused = false, this._scheduleNext());
  }
  takeAll() {
    const e2 = [];
    for (; this._queue.length; )
      e2.push(this._queue.pop());
    return this.clear(), e2;
  }
  get running() {
    return !this._isPaused && this._queue.length > 0 && this._processingItems.size < this.concurrency;
  }
  runTask(e2) {
    for (; !e2.done && this._queue.length > 0 && this._processingItems.size < this.concurrency; )
      this._process(this._queue.pop()), e2.madeProgress();
  }
  _scheduleNext() {
    this._task || this._isPaused || this._schedule || (this._schedule = v$18(() => {
      this._schedule = null, this._next();
    }));
  }
  _next() {
    for (; this._queue.length > 0 && this._processingItems.size < this.concurrency; )
      this._process(this._queue.pop());
  }
  _cancelNext() {
    this._schedule && (this._schedule.remove(), this._schedule = null);
  }
  _processResult(e2, s2) {
    this._canProcessFulfillment(e2) && (this._scheduleNext(), this._deferreds.get(e2.item).resolve(s2));
  }
  _processError(e2, s2) {
    this._canProcessFulfillment(e2) && (this._scheduleNext(), this._deferreds.get(e2.item).reject(s2));
  }
  _canProcessFulfillment(e2) {
    return !!this._deferreds.get(e2.item) && this._processingItems.get(e2.item) === e2;
  }
  _process(e2) {
    if (t$2r(e2))
      return;
    let t2;
    const r2 = new AbortController(), i2 = new u$w(e2, r2);
    this._processingItems.set(e2, i2);
    try {
      t2 = this.process(e2, r2.signal);
    } catch (o2) {
      this._processError(i2, o2);
    }
    C$E(t2) ? (i2.promise = t2, t2.then((e3) => this._processResult(i2, e3), (e3) => this._processError(i2, e3))) : this._processResult(i2, t2);
  }
  get test() {
    return { update: (e2) => this.runTask(e2) };
  }
}
function u$v(e2, t2) {
  return e2.length = 0, t2.forEach((t3) => e2.push(t3)), e2;
}
const a$M = new Set(), c$N = [], h$A = new Map(), l$L = [0, 0];
let p$R = class extends m$2q {
  constructor(e2) {
    super(e2), this._keyToItem = new Map(), this.concurrency = 6, this.strategy = "scale-first", this.tileInfoView = null;
  }
  initialize() {
    const { concurrency: e2, process: t2 } = this;
    this._queue = new l$M({ concurrency: e2, process: (e3, s2) => {
      const r2 = this._keyToItem.get(e3);
      return t2(r2, { signal: s2 });
    }, peeker: (e3) => e3.values().next().value });
  }
  destroy() {
    this.clear(), this._queue = s$2D(this._queue);
  }
  get length() {
    return this._queue ? this._queue.length : 0;
  }
  get onGoingCount() {
    return this._keyToItem.size;
  }
  get updating() {
    return this.length > 0 || this.onGoingCount > 0;
  }
  abort(e2) {
    const t2 = typeof e2 == "string" ? e2 : e2.id;
    this._queue.abort(t2);
  }
  clear() {
    this._queue.clear(), this._keyToItem.clear(), this.notifyChange("updating");
  }
  has(e2) {
    return typeof e2 == "string" ? this._keyToItem.has(e2) : this._keyToItem.has(e2.id);
  }
  isOngoing(e2) {
    const t2 = typeof e2 == "string" ? e2 : e2.id;
    return this.has(t2) && this._queue.isOngoing(t2);
  }
  pause() {
    this._queue.pause();
  }
  push(e2, t2) {
    const s2 = e2.key.id + "-" + t2;
    if (this.has(s2))
      return this.get(s2);
    const r2 = this._queue.push(s2), o2 = () => {
      this._keyToItem.delete(s2), this.notifyChange("updating");
    };
    return this._keyToItem.set(s2, e2), r2.then(o2, o2), this.notifyChange("updating"), r2;
  }
  reset() {
    this._queue.reset(), this.notifyChange("updating");
  }
  resume() {
    this._queue.resume();
  }
  _peekByScaleFirst(e2) {
    if (!this.state)
      return e2.values().next().value;
    const t2 = this.tileInfoView;
    let s2 = Number.NEGATIVE_INFINITY, r2 = Number.POSITIVE_INFINITY;
    e2.forEach((e3) => {
      const t3 = this._keyToItem.get(e3), o3 = this.tileInfoView.getTileScale(t3.key);
      h$A.has(o3) || (h$A.set(o3, []), s2 = Math.max(o3, s2), r2 = Math.min(o3, r2)), h$A.get(o3).push(t3.key), a$M.add(o3);
    });
    let o2 = this.state.scale;
    h$A.has(o2) || (u$v(c$N, a$M), c$N.sort((e3, t3) => e3 - t3), o2 = c$N.reduce((e3, t3) => Math.abs(t3 - o2) < Math.abs(e3 - o2) ? t3 : e3, c$N[0])), o2 = Math.min(o2, s2), o2 = Math.max(o2, r2);
    const i2 = h$A.get(o2), n2 = t2.getClosestInfoForScale(o2), l2 = n2.getColumnForX(this.state.center[0]), p2 = n2.getRowForY(this.state.center[1]);
    return i2.sort((e3, t3) => {
      const s3 = n2.denormalizeCol(e3.col, e3.world), r3 = n2.denormalizeCol(t3.col, t3.world);
      return Math.sqrt((l2 - s3) * (l2 - s3) + (p2 - e3.row) * (p2 - e3.row)) - Math.sqrt((l2 - r3) * (l2 - r3) + (p2 - t3.row) * (p2 - t3.row));
    }), a$M.clear(), h$A.clear(), i2[0].id;
  }
  _peekByCenterFirst(e2) {
    if (!this.state)
      return e2.values().next().value;
    const t2 = this.tileInfoView, s2 = this.state.center;
    let r2, o2 = Number.POSITIVE_INFINITY;
    return e2.forEach((e3) => {
      const n2 = this._keyToItem.get(e3);
      t2.getTileCoords(l$L, n2.key);
      const u2 = m$T(l$L, s2);
      u2 < o2 && (o2 = u2, r2 = n2.key);
    }), r2.id;
  }
};
e$2g([y$1I({ constructOnly: true })], p$R.prototype, "concurrency", void 0), e$2g([y$1I({ constructOnly: true })], p$R.prototype, "process", void 0), e$2g([y$1I()], p$R.prototype, "state", void 0), e$2g([y$1I({ constructOnly: true })], p$R.prototype, "strategy", void 0), e$2g([y$1I({ constructOnly: true })], p$R.prototype, "tileInfoView", void 0), e$2g([y$1I({ readOnly: true })], p$R.prototype, "updating", null), p$R = e$2g([n$2P("esri.views.2d.tiling.PagedTileQueue")], p$R);
class e$v {
  constructor(t2, e2, l2, s2) {
    this.set(t2, e2, l2, s2);
  }
  static getId(t2, e2, l2, s2) {
    return typeof t2 == "object" ? `${t2.level}/${t2.row}/${t2.col}/${t2.world}` : `${t2}/${e2}/${l2}/${s2}`;
  }
  get key() {
    return this;
  }
  get id() {
    return this.toString();
  }
  set id(t2) {
    this.set(t2);
  }
  get hash() {
    const t2 = 4095 & this.row, e2 = 4095 & this.col, l2 = 63 & this.level;
    return (3 & this.world) << 30 | e2 << 22 | t2 << 8 | l2;
  }
  acquire(t2, e2, l2, s2) {
    this.set(t2, e2, l2, s2);
  }
  contains(t2) {
    const e2 = t2.level - this.level;
    return e2 >= 0 && this.row === t2.row >> e2 && this.col === t2.col >> e2 && this.world === t2.world;
  }
  equals(t2) {
    return this.level === t2.level && this.row === t2.row && this.col === t2.col && this.world === t2.world;
  }
  clone() {
    return new e$v(this);
  }
  release() {
    this.level = 0, this.row = 0, this.col = 0, this.world = 0;
  }
  set(t2, e2, l2, s2) {
    if (t2 == null)
      this.level = 0, this.row = 0, this.col = 0, this.world = 0;
    else if (typeof t2 == "object")
      this.level = t2.level || 0, this.row = t2.row || 0, this.col = t2.col || 0, this.world = t2.world || 0;
    else if (typeof t2 == "string") {
      const [e3, l3, s3, o2] = t2.split("/");
      this.level = parseFloat(e3), this.row = parseFloat(l3), this.col = parseFloat(s3), this.world = parseFloat(o2);
    } else
      this.level = +t2, this.row = +e2, this.col = +l2, this.world = +s2 || 0;
    return this;
  }
  toString() {
    return `${this.level}/${this.row}/${this.col}/${this.world}`;
  }
  getParentKey() {
    return this.level <= 0 ? null : new e$v(this.level - 1, this.row >> 1, this.col >> 1, this.world);
  }
  getChildKeys() {
    const t2 = this.level + 1, l2 = this.row << 1, s2 = this.col << 1, o2 = this.world;
    return [new e$v(t2, l2, s2, o2), new e$v(t2, l2, s2 + 1, o2), new e$v(t2, l2 + 1, s2, o2), new e$v(t2, l2 + 1, s2 + 1, o2)];
  }
  compareRowMajor(t2) {
    return this.row < t2.row ? -1 : this.row > t2.row ? 1 : this.col < t2.col ? -1 : this.col > t2.col ? 1 : 0;
  }
}
e$v.pool = new e$24(e$v, null, null, 25, 50);
function i$S(t2, r2) {
  return [t2, r2];
}
function e$u(t2, r2, o2) {
  return t2[0] = r2, t2[1] = o2, t2;
}
function s$F(t2, r2, o2, i2, e2) {
  return t2[0] = r2, t2[1] = o2, t2[2] = i2, t2[3] = e2, t2;
}
const n$L = new e$v("0/0/0/0");
class l$K {
  constructor(t2, r2, o2, i2, e2, s2, n2, l2, h2, a2, u2, m2) {
    this.level = t2, this.resolution = r2, this.scale = o2, this.origin = i2, this.first = e2, this.last = s2, this.size = n2, this.norm = l2, this.worldStart = h2, this.worldEnd = a2, this.worldSize = u2, this.wrap = m2;
  }
  static create(o2, s2, n2 = null) {
    const h2 = R$B(o2.spatialReference), a2 = s2.origin || i$S(o2.origin.x, o2.origin.y), u2 = i$S(o2.size[0] * s2.resolution, o2.size[1] * s2.resolution), m2 = i$S(-1 / 0, -1 / 0), g2 = i$S(1 / 0, 1 / 0), w2 = i$S(1 / 0, 1 / 0);
    r$1$(n2) && (e$u(m2, Math.max(0, Math.floor((n2.xmin - a2[0]) / u2[0])), Math.max(0, Math.floor((a2[1] - n2.ymax) / u2[1]))), e$u(g2, Math.max(0, Math.floor((n2.xmax - a2[0]) / u2[0])), Math.max(0, Math.floor((a2[1] - n2.ymin) / u2[1]))), e$u(w2, g2[0] - m2[0] + 1, g2[1] - m2[1] + 1));
    const { cols: c2, rows: d2 } = s2;
    let f2, F2, z2, p2;
    return !n2 && c2 && d2 && (e$u(m2, c2[0], d2[0]), e$u(g2, c2[1], d2[1]), e$u(w2, c2[1] - c2[0] + 1, d2[1] - d2[0] + 1)), o2.isWrappable ? (f2 = i$S(Math.ceil(Math.round((h2.valid[1] - h2.valid[0]) / s2.resolution) / o2.size[0]), w2[1]), F2 = i$S(Math.floor((h2.origin[0] - a2[0]) / u2[0]), m2[1]), z2 = i$S(f2[0] + F2[0] - 1, g2[1]), p2 = true) : (F2 = m2, z2 = g2, f2 = w2, p2 = false), new l$K(s2.level, s2.resolution, s2.scale, a2, m2, g2, w2, u2, F2, z2, f2, p2);
  }
  normalizeCol(t2) {
    if (!this.wrap)
      return t2;
    const r2 = this.worldSize[0];
    return t2 < 0 ? r2 - 1 - Math.abs((t2 + 1) % r2) : t2 % r2;
  }
  denormalizeCol(t2, r2) {
    return this.wrap ? this.worldSize[0] * r2 + t2 : t2;
  }
  getWorldForColumn(t2) {
    return this.wrap ? Math.floor(t2 / this.worldSize[0]) : 0;
  }
  getFirstColumnForWorld(t2) {
    return t2 * this.worldSize[0] + this.first[0];
  }
  getLastColumnForWorld(t2) {
    return t2 * this.worldSize[0] + this.first[0] + this.size[0] - 1;
  }
  getColumnForX(t2) {
    return (t2 - this.origin[0]) / this.norm[0];
  }
  getXForColumn(t2) {
    return this.origin[0] + t2 * this.norm[0];
  }
  getRowForY(t2) {
    return (this.origin[1] - t2) / this.norm[1];
  }
  getYForRow(t2) {
    return this.origin[1] - t2 * this.norm[1];
  }
  getTileBounds(t2, r2, o2 = false) {
    n$L.set(r2);
    const i2 = o2 ? n$L.col : this.denormalizeCol(n$L.col, n$L.world), e2 = n$L.row;
    return s$F(t2, this.getXForColumn(i2), this.getYForRow(e2 + 1), this.getXForColumn(i2 + 1), this.getYForRow(e2)), t2;
  }
  getTileCoords(t2, r2, o2 = false) {
    n$L.set(r2);
    const i2 = o2 ? n$L.col : this.denormalizeCol(n$L.col, n$L.world);
    return Array.isArray(t2) ? e$u(t2, this.getXForColumn(i2), this.getYForRow(n$L.row)) : (t2.x = this.getXForColumn(i2), t2.y = this.getYForRow(n$L.row)), t2;
  }
}
class l$J {
  constructor() {
    this.spans = [];
  }
  acquire(o2) {
    this.lodInfo = o2;
  }
  release() {
    this.lodInfo = null, this.spans.length = 0;
  }
  forEach(o2, l2) {
    const { spans: s2, lodInfo: t2 } = this, { level: e2 } = t2;
    if (s2.length !== 0)
      for (const { row: r2, colFrom: n2, colTo: c2 } of s2)
        for (let s3 = n2; s3 <= c2; s3++)
          o2.call(l2, e2, r2, t2.normalizeCol(s3), t2.getWorldForColumn(s3));
  }
}
l$J.pool = new e$24(l$J);
class o$C {
  constructor(o2, s2, t2) {
    this.row = o2, this.colFrom = s2, this.colTo = t2;
  }
}
const i$R = new e$v("0/0/0/0");
class n$K {
  constructor(e2, t2, o2, l2, s2, i2, n2, r2) {
    this.x = e2, this.ymin = t2, this.ymax = o2, this.invM = l2, this.leftAdjust = s2, this.rightAdjust = i2, this.leftBound = n2, this.rightBound = r2;
  }
  static create(e2, t2) {
    e2[1] > t2[1] && ([e2, t2] = [t2, e2]);
    const [o2, l2] = e2, [s2, i2] = t2, r2 = s2 - o2, a2 = i2 - l2, h2 = a2 !== 0 ? r2 / a2 : 0, c2 = (Math.ceil(l2) - l2) * h2, f2 = (Math.floor(l2) - l2) * h2;
    return new n$K(o2, Math.floor(l2), Math.ceil(i2), h2, r2 < 0 ? c2 : f2, r2 < 0 ? f2 : c2, r2 < 0 ? s2 : o2, r2 < 0 ? o2 : s2);
  }
  incrRow() {
    this.x += this.invM;
  }
  getLeftCol() {
    return Math.max(this.x + this.leftAdjust, this.leftBound);
  }
  getRightCol() {
    return Math.min(this.x + this.rightAdjust, this.rightBound);
  }
}
const r$H = [[0, 0], [0, 0], [0, 0], [0, 0]], a$L = 1e-6;
class h$z {
  constructor(e2, o2 = null) {
    this.tileInfo = e2, this.fullExtent = o2, this.scales = [], this._infoByScale = {}, this._infoByLevel = {};
    const l2 = e2.lods.slice();
    l2.sort((e3, t2) => t2.scale - e3.scale);
    const s2 = this._lodInfos = l2.map((l3) => l$K.create(e2, l3, o2));
    l2.forEach((e3, t2) => {
      this._infoByLevel[e3.level] = s2[t2], this._infoByScale[e3.scale] = s2[t2], this.scales[t2] = e3.scale;
    }, this), this._wrap = e2.isWrappable;
  }
  get spatialReference() {
    return this.tileInfo.spatialReference;
  }
  getLODInfoAt(e2) {
    return this._infoByLevel[typeof e2 == "number" ? e2 : e2.level];
  }
  getTileBounds(e2, t2, o2 = false) {
    i$R.set(t2);
    const l2 = this._infoByLevel[i$R.level];
    return l2 ? l2.getTileBounds(e2, i$R, o2) : e2;
  }
  getTileCoords(e2, t2, o2 = false) {
    i$R.set(t2);
    const l2 = this._infoByLevel[i$R.level];
    return l2 ? l2.getTileCoords(e2, i$R, o2) : e2;
  }
  getTileCoverage(e2, t2 = 192, l2 = "closest") {
    const i2 = l2 === "closest" ? this.getClosestInfoForScale(e2.scale) : this.getSmallestInfoForScale(e2.scale), a2 = l$J.pool.acquire(i2), h2 = this._wrap;
    let c2, f2, u2, m2 = 1 / 0, g2 = -1 / 0;
    const d2 = a2.spans;
    r$H[0][0] = r$H[0][1] = r$H[1][1] = r$H[3][0] = -t2, r$H[1][0] = r$H[2][0] = e2.size[0] + t2, r$H[2][1] = r$H[3][1] = e2.size[1] + t2;
    for (const o2 of r$H)
      e2.toMap(o2, o2), o2[0] = i2.getColumnForX(o2[0]), o2[1] = i2.getRowForY(o2[1]);
    const y2 = [];
    let v2 = 3;
    for (let o2 = 0; o2 < 4; o2++) {
      if (r$H[o2][1] === r$H[v2][1]) {
        v2 = o2;
        continue;
      }
      const e3 = n$K.create(r$H[o2], r$H[v2]);
      m2 = Math.min(e3.ymin, m2), g2 = Math.max(e3.ymax, g2), y2[e3.ymin] === void 0 && (y2[e3.ymin] = []), y2[e3.ymin].push(e3), v2 = o2;
    }
    if (m2 == null || g2 == null || g2 - m2 > 100)
      return null;
    let _2 = [];
    for (c2 = m2; c2 < g2; ) {
      y2[c2] != null && (_2 = _2.concat(y2[c2])), f2 = 1 / 0, u2 = -1 / 0;
      for (let e3 = _2.length - 1; e3 >= 0; e3--) {
        const t3 = _2[e3];
        f2 = Math.min(f2, t3.getLeftCol()), u2 = Math.max(u2, t3.getRightCol());
      }
      if (f2 = Math.floor(f2), u2 = Math.floor(u2), c2 >= i2.first[1] && c2 <= i2.last[1])
        if (h2)
          if (i2.size[0] < i2.worldSize[0]) {
            const e3 = Math.floor(u2 / i2.worldSize[0]);
            for (let t3 = Math.floor(f2 / i2.worldSize[0]); t3 <= e3; t3++)
              d2.push(new o$C(c2, Math.max(i2.getFirstColumnForWorld(t3), f2), Math.min(i2.getLastColumnForWorld(t3), u2)));
          } else
            d2.push(new o$C(c2, f2, u2));
        else
          f2 > i2.last[0] || u2 < i2.first[0] || (f2 = Math.max(f2, i2.first[0]), u2 = Math.min(u2, i2.last[0]), d2.push(new o$C(c2, f2, u2)));
      c2 += 1;
      for (let e3 = _2.length - 1; e3 >= 0; e3--) {
        const t3 = _2[e3];
        t3.ymax >= c2 ? t3.incrRow() : _2.splice(e3, 1);
      }
    }
    return a2;
  }
  getTileParentId(e2) {
    i$R.set(e2);
    const t2 = this._infoByLevel[i$R.level], o2 = this._lodInfos.indexOf(t2) - 1;
    return o2 < 0 ? null : (this._getTileIdAtLOD(i$R, this._lodInfos[o2], i$R), i$R.id);
  }
  getTileResolution(e2) {
    const t2 = this._infoByLevel[typeof e2 == "object" ? e2.level : e2];
    return t2 ? t2.resolution : -1;
  }
  getTileScale(e2) {
    const t2 = this._infoByLevel[e2.level];
    return t2 ? t2.scale : -1;
  }
  intersects(e2, t2) {
    i$R.set(t2);
    const o2 = this._infoByLevel[i$R.level], l2 = e2.lodInfo;
    if (l2.resolution > o2.resolution) {
      this._getTileIdAtLOD(i$R, l2, i$R);
      const t3 = l2.denormalizeCol(i$R.col, i$R.world);
      for (const o3 of e2.spans)
        if (o3.row === i$R.row && o3.colFrom <= t3 && o3.colTo >= t3)
          return true;
    }
    if (l2.resolution < o2.resolution) {
      const [t3, s3, n2, r2] = e2.spans.reduce((e3, t4) => (e3[0] = Math.min(e3[0], t4.row), e3[1] = Math.max(e3[1], t4.row), e3[2] = Math.min(e3[2], t4.colFrom), e3[3] = Math.max(e3[3], t4.colTo), e3), [1 / 0, -1 / 0, 1 / 0, -1 / 0]), a2 = o2.denormalizeCol(i$R.col, i$R.world), h2 = l2.getColumnForX(o2.getXForColumn(a2)), c2 = l2.getRowForY(o2.getYForRow(i$R.row)), f2 = l2.getColumnForX(o2.getXForColumn(a2 + 1)) - 1, u2 = l2.getRowForY(o2.getYForRow(i$R.row + 1)) - 1;
      return !(h2 > r2 || f2 < n2 || c2 > s3 || u2 < t3);
    }
    const s2 = l2.denormalizeCol(i$R.col, i$R.world);
    return e2.spans.some((e3) => e3.row === i$R.row && e3.colFrom <= s2 && e3.colTo >= s2);
  }
  normalizeBounds(t2, o2, l2) {
    if (t2[0] = o2[0], t2[1] = o2[1], t2[2] = o2[2], t2[3] = o2[3], this._wrap) {
      const o3 = R$B(this.tileInfo.spatialReference), s2 = -l2 * (o3.valid[1] - o3.valid[0]);
      t2[0] += s2, t2[2] += s2;
    }
    return t2;
  }
  getSmallestInfoForScale(e2) {
    const t2 = this.scales;
    if (this._infoByScale[e2])
      return this._infoByScale[e2];
    if (e2 > t2[0])
      return this._infoByScale[t2[0]];
    for (let o2 = 1; o2 < t2.length - 1; o2++)
      if (e2 > t2[o2] + a$L)
        return this._infoByScale[t2[o2 - 1]];
    return this._infoByScale[t2[t2.length - 1]];
  }
  getClosestInfoForScale(e2) {
    const t2 = this.scales;
    return this._infoByScale[e2] || (e2 = t2.reduce((t3, o2) => Math.abs(o2 - e2) < Math.abs(t3 - e2) ? o2 : t3, t2[0])), this._infoByScale[e2];
  }
  scaleToLevel(e2) {
    const t2 = this.scales;
    if (this._infoByScale[e2])
      return this._infoByScale[e2].level;
    for (let o2 = t2.length - 1; o2 >= 0; o2--)
      if (e2 < t2[o2]) {
        if (o2 === t2.length - 1)
          return this._infoByScale[t2[t2.length - 1]].level;
        return this._infoByScale[t2[o2]].level + (t2[o2] - e2) / (t2[o2] - t2[o2 + 1]);
      }
    return this._infoByScale[t2[0]].level;
  }
  scaleToZoom(e2) {
    return this.tileInfo.scaleToZoom(e2);
  }
  _getTileIdAtLOD(e2, t2, o2) {
    const l2 = this._infoByLevel[o2.level];
    return e2.set(o2), t2.resolution < l2.resolution ? null : (t2.resolution === l2.resolution || (e2.level = t2.level, e2.col = Math.floor(o2.col * l2.resolution / t2.resolution + 0.01), e2.row = Math.floor(o2.row * l2.resolution / t2.resolution + 0.01)), e2);
  }
}
function u$u(e2, t2) {
  return e2.length = 0, t2.forEach((t3) => e2.push(t3)), e2;
}
const c$M = new Set(), a$K = [], h$y = new Map(), l$I = [0, 0];
let p$Q = class extends m$2q {
  constructor(e2) {
    super(e2), this._keyToItem = new Map(), this.concurrency = 6, this.strategy = "scale-first", this.tileInfoView = null;
  }
  initialize() {
    const { concurrency: e2, process: t2, strategy: s2 } = this;
    this._queue = new l$M({ concurrency: e2, process: (e3, s3) => {
      const r2 = this._keyToItem.get(e3);
      return t2(r2, { signal: s3 });
    }, peeker: s2 === "scale-first" ? (e3) => this._peekByScaleFirst(e3) : (e3) => this._peekByCenterFirst(e3) });
  }
  destroy() {
    this.clear(), this._queue = s$2D(this._queue);
  }
  get length() {
    return this._queue ? this._queue.length : 0;
  }
  get onGoingCount() {
    return this._keyToItem.size;
  }
  get updating() {
    return this.length > 0 || this.onGoingCount > 0;
  }
  abort(e2) {
    const t2 = typeof e2 == "string" ? e2 : e2.id;
    this._queue.abort(t2);
  }
  clear() {
    this._queue.clear(), this._keyToItem.clear(), this.notifyChange("updating");
  }
  has(e2) {
    return typeof e2 == "string" ? this._keyToItem.has(e2) : this._keyToItem.has(e2.id);
  }
  isOngoing(e2) {
    const t2 = typeof e2 == "string" ? e2 : e2.id;
    return this.has(t2) && this._queue.isOngoing(t2);
  }
  pause() {
    this._queue.pause();
  }
  push(e2) {
    const t2 = e2.key.id;
    if (this._queue.has(t2))
      return this._queue.get(t2);
    const s2 = this._queue.push(t2), r2 = () => {
      this._keyToItem.delete(t2), this.notifyChange("updating");
    };
    return this._keyToItem.set(t2, e2), s2.then(r2, r2), this.notifyChange("updating"), s2;
  }
  reset() {
    this._queue.reset();
  }
  resume() {
    this._queue.resume();
  }
  _peekByScaleFirst(e2) {
    if (!this.state)
      return e2.values().next().value;
    const t2 = this.tileInfoView;
    let s2 = Number.NEGATIVE_INFINITY, r2 = Number.POSITIVE_INFINITY;
    e2.forEach((e3) => {
      const t3 = this._keyToItem.get(e3), o3 = this.tileInfoView.getTileScale(t3.key);
      h$y.has(o3) || (h$y.set(o3, []), s2 = Math.max(o3, s2), r2 = Math.min(o3, r2)), h$y.get(o3).push(t3.key), c$M.add(o3);
    });
    let o2 = this.state.scale;
    h$y.has(o2) || (u$u(a$K, c$M), a$K.sort((e3, t3) => e3 - t3), o2 = a$K.reduce((e3, t3) => Math.abs(t3 - o2) < Math.abs(e3 - o2) ? t3 : e3, a$K[0])), o2 = Math.min(o2, s2), o2 = Math.max(o2, r2);
    const i2 = h$y.get(o2), n2 = t2.getClosestInfoForScale(o2), l2 = n2.getColumnForX(this.state.center[0]), p2 = n2.getRowForY(this.state.center[1]);
    return i2.sort((e3, t3) => {
      const s3 = n2.denormalizeCol(e3.col, e3.world), r3 = n2.denormalizeCol(t3.col, t3.world);
      return Math.sqrt((l2 - s3) * (l2 - s3) + (p2 - e3.row) * (p2 - e3.row)) - Math.sqrt((l2 - r3) * (l2 - r3) + (p2 - t3.row) * (p2 - t3.row));
    }), c$M.clear(), h$y.clear(), i2[0].id;
  }
  _peekByCenterFirst(e2) {
    if (!this.state)
      return e2.values().next().value;
    const t2 = this.tileInfoView, s2 = this.state.center;
    let r2, o2 = Number.POSITIVE_INFINITY;
    return e2.forEach((e3) => {
      const n2 = this._keyToItem.get(e3);
      t2.getTileCoords(l$I, n2.key);
      const u2 = m$T(l$I, s2);
      u2 < o2 && (o2 = u2, r2 = n2.key);
    }), r2.id;
  }
};
e$2g([y$1I({ constructOnly: true })], p$Q.prototype, "concurrency", void 0), e$2g([y$1I({ constructOnly: true })], p$Q.prototype, "process", void 0), e$2g([y$1I()], p$Q.prototype, "state", void 0), e$2g([y$1I({ constructOnly: true })], p$Q.prototype, "strategy", void 0), e$2g([y$1I({ constructOnly: true })], p$Q.prototype, "tileInfoView", void 0), e$2g([y$1I({ readOnly: true })], p$Q.prototype, "updating", null), p$Q = e$2g([n$2P("esri.views.2d.tiling.TileQueue")], p$Q);
const y$j = p$Q;
class t$B {
  constructor(e2, t2, i2) {
    this.maxSize = e2, this._tileInfoView = t2, this._removedFunc = i2, this._tilePerId = new Map(), this._tileKeysPerLevel = [];
  }
  has(e2) {
    return this._tilePerId.has(e2);
  }
  get(e2) {
    return this._tilePerId.get(e2);
  }
  pop(e2) {
    const t2 = this._tilePerId.get(e2);
    if (!t2)
      return;
    const s2 = t2.key.level, r2 = this._tileKeysPerLevel[s2];
    i$Q(this._tilePerId, e2);
    for (let i2 = 0; i2 < r2.length; i2++)
      if (r2[i2].id === e2) {
        r2.splice(i2, 1);
        break;
      }
    return t2.visible = true, t2;
  }
  add(e2) {
    e2.visible = false;
    const t2 = e2.key, i2 = t2.id;
    if (this._tilePerId.has(i2))
      return;
    this._tilePerId.set(i2, e2);
    const s2 = t2.level;
    this._tileKeysPerLevel[s2] || (this._tileKeysPerLevel[s2] = []), this._tileKeysPerLevel[s2].push(t2);
  }
  prune(e2, t2, i2) {
    let s2 = this._tilePerId.size;
    if (s2 <= this.maxSize)
      return;
    let r2 = this._tileKeysPerLevel.length - 1;
    for (; s2 > this.maxSize && r2 >= 0; )
      r2 !== e2 && (s2 = this._pruneAroundCenterTile(s2, t2, i2, r2)), r2--;
    s2 > this.maxSize && (s2 = this._pruneAroundCenterTile(s2, t2, i2, e2));
  }
  _pruneAroundCenterTile(t2, i2, s2, r2) {
    const l2 = this._tileKeysPerLevel[r2];
    if (!l2 || l2.length === 0)
      return t2;
    const { size: n2, origin: h2 } = this._tileInfoView.tileInfo, o2 = s2 * n2[0], _2 = s2 * n2[1], d2 = [0, 0], u2 = [0, 0];
    for (l2.sort((t3, s3) => (d2[0] = h2.x + o2 * (t3.col + 0.5), d2[1] = h2.y - _2 * (t3.row + 0.5), u2[0] = h2.x + o2 * (s3.col + 0.5), u2[1] = h2.y - _2 * (s3.row + 0.5), b$k(d2, i2) - b$k(u2, i2))); l2.length > 0; ) {
      const e2 = l2.pop();
      if (this._removeTile(e2.id), --t2 === this.maxSize)
        break;
    }
    return t2;
  }
  _removeTile(e2) {
    const t2 = this._tilePerId.get(e2);
    this._removedFunc && t2 && this._removedFunc(t2), i$Q(this._tilePerId, e2);
  }
}
function i$Q(e2, t2) {
  e2.delete(t2);
}
const a$J = new e$v(0, 0, 0, 0), h$x = new Map(), o$B = [], c$L = [];
class r$G {
  constructor(e2) {
    this._previousScale = Number.POSITIVE_INFINITY, this.cachePolicy = "keep", this.coveragePolicy = "closest", this.resampling = true, this.tileIndex = new Map(), this.tiles = [], this.buffer = 192, this.acquireTile = e2.acquireTile, this.releaseTile = e2.releaseTile, this.tileInfoView = e2.tileInfoView, this.resampling = e2.resampling == null || !!e2.resampling, e2.cachePolicy && (this.cachePolicy = e2.cachePolicy), e2.coveragePolicy && (this.coveragePolicy = e2.coveragePolicy), e2.buffer != null && (this.buffer = e2.buffer), e2.cacheSize && (this._tileCache = new t$B(e2.cacheSize, this.tileInfoView, (e3) => {
      this.releaseTile(e3);
    }));
  }
  destroy() {
    this.tileIndex.clear();
  }
  update(e2) {
    const { resampling: i2, tileIndex: t2 } = this, l2 = this.tileInfoView.getTileCoverage(e2.state, this.buffer, this.coveragePolicy);
    if (c$L.length = 0, o$B.length = 0, h$x.clear(), !l2)
      return;
    const { minScale: r2, maxScale: n2 } = this.tileInfoView.tileInfo, { spans: f2, lodInfo: d2 } = l2, { level: u2 } = d2, { scale: p2, center: g2, resolution: y2 } = e2.state, I2 = !e2.stationary && p2 > this._previousScale;
    if (this._previousScale = p2, this.tiles.length = 0, !i2 && (p2 > r2 || p2 < n2))
      return this.tiles.length = 0, h$x.clear(), t2.forEach((e3) => {
        this.releaseTile(e3);
      }), t2.clear(), c$L.length = 0, o$B.length = 0, h$x.clear(), l$J.pool.release(l2), true;
    t2.forEach((e3) => e3.visible = true);
    let T2 = 0, _2 = 0;
    if (f2.length > 0)
      for (const { row: s2, colFrom: o2, colTo: c2 } of f2)
        for (let e3 = o2; e3 <= c2; e3++) {
          T2++;
          const i3 = a$J.set(u2, s2, d2.normalizeCol(e3), d2.getWorldForColumn(e3)).id;
          if (t2.has(i3)) {
            const e4 = t2.get(i3);
            e4.isReady ? (h$x.set(i3, e4), _2++) : I2 || this._addParentTile(i3, h$x);
          } else {
            let e4;
            if (this._tileCache && this._tileCache.has(i3)) {
              if (e4 = this._tileCache.pop(i3), this.tileIndex.set(i3, e4), e4.isReady) {
                h$x.set(i3, e4), _2++;
                continue;
              }
            } else
              e4 = this.acquireTile(a$J), this.tileIndex.set(i3, e4);
            I2 || this._addParentTile(i3, h$x);
          }
        }
    const m2 = _2 === T2;
    t2.forEach((e3, i3) => {
      if (a$J.set(i3), h$x.has(i3))
        return;
      const t3 = this.tileInfoView.intersects(l2, a$J), s2 = this.cachePolicy === "purge" ? a$J.level !== u2 : a$J.level > u2;
      !t3 || !I2 && m2 ? !s2 && t3 || o$B.push(i3) : e3.isReady ? s2 && this.cachePolicy === "purge" && this._hasReadyAncestor(a$J, u2) ? o$B.push(i3) : c$L.push(i3) : s2 && o$B.push(i3);
    });
    for (const s2 of c$L) {
      const e3 = t2.get(s2);
      e3 && e3.isReady && h$x.set(s2, e3);
    }
    for (const s2 of o$B) {
      const e3 = t2.get(s2);
      this._tileCache ? this._tileCache.add(e3) : this.releaseTile(e3), t2.delete(s2);
    }
    return h$x.forEach((e3) => this.tiles.push(e3)), t2.forEach((e3) => {
      h$x.has(e3.key.id) || (e3.visible = false);
    }), this._tileCache && this._tileCache.prune(u2, g2, y2), l$J.pool.release(l2), h$x.clear(), m2;
  }
  clear(e2 = true) {
    const { tileIndex: i2 } = this;
    e2 && i2.forEach((e3) => {
      this.releaseTile(e3);
    }), i2.clear();
  }
  updateCacheSize(e2) {
    this._tileCache && (this._tileCache.maxSize = e2);
  }
  _addParentTile(e2, i2) {
    let t2 = e2, s2 = null;
    for (; t2 = this.tileInfoView.getTileParentId(t2), t2; )
      if (this.tileIndex.has(t2)) {
        if (s2 = this.tileIndex.get(t2), s2 && s2.isReady) {
          i2.has(s2.key.id) || i2.set(s2.key.id, s2);
          break;
        }
      } else if (this._tileCache && this._tileCache.has(t2) && (s2 = this._tileCache.pop(t2), this.tileIndex.set(t2, s2), s2 && s2.isReady)) {
        i2.has(s2.key.id) || i2.set(s2.key.id, s2);
        break;
      }
  }
  _hasReadyAncestor(t2, s2) {
    const l2 = u$1O();
    this.tileInfoView.getTileBounds(l2, t2, true);
    for (const a2 of this.tileIndex.values())
      if (a2.isReady && a2.key.level >= s2 && a2.key.level < t2.level) {
        const t3 = u$1O();
        if (this.tileInfoView.getTileBounds(t3, a2.key, true), R$y(t3, l2))
          return true;
      }
    return false;
  }
}
function t$A(t2, r2) {
  switch (r2) {
    case "primary":
      return t2.pointerType === "touch" || t2.button === 0;
    case "secondary":
      return t2.pointerType !== "touch" && t2.button === 2;
    case "tertiary":
      return t2.pointerType !== "touch" && t2.button === 1;
  }
}
class a$I extends i$1b {
  constructor(t2, i2) {
    super(true), this._view = t2, this.registerIncoming("double-click", i2, (t3) => this._handleDoubleClick(t3, i2));
  }
  _handleDoubleClick(t2, a2) {
    t$A(t2.data, "primary") && (t2.stopPropagation(), a2 ? this._view.mapViewNavigation.zoomOut([t2.data.x, t2.data.y]) : this._view.mapViewNavigation.zoomIn([t2.data.x, t2.data.y]));
  }
}
class e$t extends i$1b {
  constructor(t2, e2, a2) {
    super(true), this.view = t2, this.pointerType = e2, this.registerIncoming("double-tap-drag", a2, (t3) => this._handleDoubleTapDrag(t3));
  }
  _handleDoubleTapDrag(t2) {
    const { data: e2 } = t2, { pointerType: a2 } = e2;
    if (a2 !== this.pointerType)
      return;
    t2.stopPropagation();
    const { action: s2, delta: i2 } = e2, { view: r2 } = this, { mapViewNavigation: n2 } = r2;
    switch (s2) {
      case "begin": {
        const { scale: t3 } = r2;
        this._startScale = t3, this._currentScale = t3, this._previousDelta = i2, n2.begin();
        break;
      }
      case "update": {
        if (this._previousDelta.y === i2.y)
          return;
        this._previousDelta = i2;
        const t3 = 1.015 ** i2.y, e3 = this._startScale * t3, a3 = e3 / this._currentScale;
        n2.setViewpointImmediate(a3), this._currentScale = e3;
        break;
      }
      case "end": {
        const { constraints: t3 } = r2, { effectiveLODs: e3, snapToZoom: a3 } = t3;
        if (!a3 || !e3)
          return void n2.end();
        const s3 = t3.snapScale(this._currentScale), o2 = (i2.y > 0 ? Math.max(s3, t3.snapToPreviousScale(this._startScale)) : Math.min(s3, t3.snapToNextScale(this._startScale))) / this._currentScale;
        n2.zoom(o2);
        break;
      }
    }
  }
}
class t$z {
  constructor(t2) {
    this._callbacks = t2, this._currentCount = 0, this._callbacks.condition || (this._callbacks.condition = () => true);
  }
  handle(t2) {
    const s2 = t2.data, i2 = s2.pointers.size;
    switch (s2.action) {
      case "start":
        this._currentCount = i2, this._emitStart(t2);
        break;
      case "added":
        this._emitEnd(this._previousEvent), this._currentCount = i2, this._emitStart(t2);
        break;
      case "update":
        this._emitUpdate(t2);
        break;
      case "removed":
        this._startEvent && this._emitEnd(this._previousEvent), this._currentCount = i2, this._emitStart(t2);
        break;
      case "end":
        this._emitEnd(t2), this._currentCount = 0;
    }
    this._previousEvent = t2;
  }
  _emitStart(t2) {
    var _a2, _b2;
    this._startEvent = t2, ((_b2 = (_a2 = this._callbacks).condition) == null ? void 0 : _b2.call(_a2, this._currentCount, t2)) && this._callbacks.start(this._currentCount, t2, this._startEvent);
  }
  _emitUpdate(t2) {
    var _a2, _b2;
    ((_b2 = (_a2 = this._callbacks).condition) == null ? void 0 : _b2.call(_a2, this._currentCount, t2)) && this._callbacks.update(this._currentCount, t2, this._startEvent);
  }
  _emitEnd(t2) {
    var _a2, _b2;
    ((_b2 = (_a2 = this._callbacks).condition) == null ? void 0 : _b2.call(_a2, this._currentCount, t2)) && this._callbacks.end(this._currentCount, t2, this._startEvent), this._startEvent = null;
  }
}
class n$J extends i$1b {
  constructor(t2, i2, a2) {
    super(true), this.view = t2, this.pointerAction = i2, this.registerIncoming("drag", a2, (t3) => this._handleDrag(t3)), this.registerIncoming("pointer-down", () => this.stopMomentumNavigation());
  }
  onInstall(i2) {
    super.onInstall(i2), this._dragEventSeparator = new t$z({ start: (t2, i3) => {
      this.view.mapViewNavigation.pan.begin(this.view, i3.data), i3.stopPropagation();
    }, update: (t2, i3) => {
      this.view.mapViewNavigation.pan.update(this.view, i3.data), i3.stopPropagation();
    }, end: (t2, i3) => {
      this.view.mapViewNavigation.pan.end(this.view, i3.data), i3.stopPropagation();
    }, condition: (t2, i3) => t2 === 1 && t$A(i3.data, this.pointerAction) });
  }
  _handleDrag(t2) {
    const i2 = this.view.mapViewNavigation;
    i2.pinch.zoomMomentum || i2.pinch.rotateMomentum ? this.stopMomentumNavigation() : this._dragEventSeparator.handle(t2);
  }
  stopMomentumNavigation() {
    this.view.mapViewNavigation.pan.stopMomentumNavigation();
  }
}
class o$A extends i$1b {
  constructor(a2, o2, r2) {
    super(true), this._view = a2, this.pointerAction = o2;
    const e2 = this._view.mapViewNavigation;
    this._dragEventSeparator = new t$z({ start: (t2, a3) => {
      e2.rotate.begin(this._view, a3.data), a3.stopPropagation();
    }, update: (t2, a3) => {
      e2.rotate.update(this._view, a3.data), a3.stopPropagation();
    }, end: (t2, a3) => {
      e2.rotate.end(), a3.stopPropagation();
    }, condition: (t2, a3) => t2 === 1 && t$A(a3.data, this.pointerAction) }), this.registerIncoming("drag", r2, (t2) => this._dragEventSeparator.handle(t2));
  }
}
function n$I(t2) {
  let n2 = t2 * t2;
  return t2 < 0 && (n2 *= -1), n2;
}
function a$H(t2) {
  return t2.translation[0] = 0, t2.translation[1] = 0, t2.translation[2] = 0, t2.heading = 0, t2.tilt = 0, t2;
}
function i$P(a2, i2, o2) {
  const s2 = o2, e2 = a2.state, r2 = a2.device, l2 = i2.tiltDirection === "forward-down" ? 1 : -1, c2 = 1;
  return r2.deviceType === "standard" ? (s2.translation[0] = n$I(e2.axes[0]), s2.translation[1] = n$I(e2.axes[1]), s2.translation[2] = n$I(e2.buttons[7]) - n$I(e2.buttons[6]), s2.heading = n$I(e2.axes[2]), s2.tilt = n$I(e2.axes[3])) : r2.deviceType === "spacemouse" && (s2.translation[0] = 1.2 * n$I(e2.axes[0]), s2.translation[1] = 1.2 * n$I(e2.axes[1]), s2.translation[2] = 2 * -n$I(e2.axes[2]), s2.heading = 1.2 * n$I(e2.axes[5]), s2.tilt = 1.2 * n$I(e2.axes[3])), s2.tilt *= l2, g$19(s2.translation, s2.translation, c2), s2;
}
function s$E(t2) {
  return t2.translation[0] === 0 && t2.translation[1] === 0 && t2.translation[2] === 0 && t2.heading === 0 && t2.tilt === 0 && t2.zoom === 0;
}
class d$q extends i$1b {
  constructor(i2) {
    super(true), this._view = i2, this._frameTask = null, this._watchHandles = new t$2g(), this._currentDevice = null, this._transformation = { translation: [0, 0, 0], heading: 0, tilt: 0, zoom: 0 }, this._handle = this.registerIncoming("gamepad", (t2) => this._handleGamePadEvent(t2)), this._handle.pause();
  }
  onInstall(t2) {
    super.onInstall(t2), this._watchHandles.add([l$1P(() => {
      var _a2;
      return (_a2 = this._view.navigation.gamepad) == null ? void 0 : _a2.enabled;
    }, (t3) => {
      t3 ? (this._handle.resume(), this._frameTask || (this._frameTask = A$A({ update: (t4) => this._frameUpdate(t4.deltaTime) }))) : (this._handle.pause(), this._frameTask && (this._frameTask.remove(), this._frameTask = null));
    }, h$1j)]);
  }
  onUninstall() {
    this._watchHandles.removeAll(), this._frameTask && (this._frameTask.remove(), this._frameTask = null), super.onUninstall();
  }
  _handleGamePadEvent(t2) {
    const i2 = this._view.navigation.gamepad.device;
    i2 && t2.data.device !== i2 || this._currentDevice && this._currentDevice !== t2.data.device || (t2.data.action === "end" ? (this._currentDevice = null, a$H(this._transformation)) : (this._currentDevice = t2.data.device, i$P(t2.data, this._view.navigation.gamepad, this._transformation)));
  }
  _frameUpdate(t2) {
    const i2 = this._transformation;
    if (s$E(i2))
      return;
    const e2 = this._view.viewpoint.clone(), a2 = this._view.navigation.gamepad.velocityFactor, r2 = _$g * a2 * t2;
    St(e2, e2, [i2.translation[0] * r2, -i2.translation[1] * r2]);
    const o2 = 1 + i2.translation[2] * c$K * t2, h2 = this._view.constraints.rotationEnabled ? -i2.heading * m$P * t2 : 0, d2 = this._view.size, v2 = [d2[0] / 2, d2[1]];
    Gt(e2, e2, o2, h2, v2, d2);
    const p2 = this._view.constraints.constrain(e2, this._view.viewpoint);
    this._view.viewpoint = p2;
  }
}
const m$P = 0.06, _$g = 0.7, c$K = 6e-4;
class i$O extends i$1b {
  constructor(e2, i2, t2) {
    super(true), this.view = e2, this.keys = i2, this._pressed = false, this._keyMap = { [i2.left]: "left", [i2.right]: "right", [i2.up]: "up", [i2.down]: "down" }, this.registerIncoming("key-down", t2, (e3) => this._handleKeyDown(e3)), this.registerIncoming("key-up", t2, (e3) => this._handleKeyUp(e3)), this.registerIncoming("blur", t2, () => this._handleBlur());
  }
  _handleKeyDown(e2) {
    e2.data.repeat || this._handleKey(e2, true);
  }
  _handleKeyUp(e2) {
    this._handleKey(e2, false);
  }
  _handleBlur() {
    this._pressed && (this._pressed = false, this.view.mapViewNavigation.stop());
  }
  _handleKey(e2, i2) {
    const t2 = this._keyMap[e2.data.key];
    if (this._pressed = t2 != null, this._pressed) {
      if (i2)
        switch (this.view.mapViewNavigation.begin(), t2) {
          case "left":
            this.view.mapViewNavigation.continousPanLeft();
            break;
          case "right":
            this.view.mapViewNavigation.continousPanRight();
            break;
          case "up":
            this.view.mapViewNavigation.continousPanUp();
            break;
          case "down":
            this.view.mapViewNavigation.continousPanDown();
        }
      else
        this._pressed = false, this.view.mapViewNavigation.stop();
      e2.stopPropagation();
    }
  }
}
class i$N extends i$1b {
  constructor(e2, i2, t2) {
    super(true), this.view = e2, this.keys = i2, this._pressed = false, this._keyToDirection = { [i2.clockwiseOption1]: "clockwise", [i2.clockwiseOption2]: "clockwise", [i2.counterClockwiseOption1]: "counterClockwise", [i2.counterClockwiseOption2]: "counterClockwise", [i2.resetOption1]: "reset", [i2.resetOption2]: "reset" }, this.registerIncoming("key-down", t2, (e3) => this._handleKeyDown(e3)), this.registerIncoming("key-up", t2, (e3) => this._handleKeyUp(e3)), this.registerIncoming("blur", t2, () => this._handleBlur());
  }
  _handleKeyDown(e2) {
    e2.data.repeat || this._handleKey(e2, true);
  }
  _handleKeyUp(e2) {
    this._handleKey(e2, false);
  }
  _handleBlur() {
    this._pressed && (this._pressed = false, this.view.mapViewNavigation.stop());
  }
  _handleKey(e2, i2) {
    const t2 = e2.modifiers;
    if (t2.size > 0 && !t2.has("Shift") || !this.view.constraints.rotationEnabled)
      return;
    const s2 = this._keyToDirection[e2.data.key];
    if (this._pressed = s2 != null, this._pressed) {
      if (i2)
        switch (this.view.mapViewNavigation.begin(), s2) {
          case "clockwise":
            this.view.mapViewNavigation.continousRotateClockwise();
            break;
          case "counterClockwise":
            this.view.mapViewNavigation.continousRotateCounterclockwise();
            break;
          case "reset":
            this.view.mapViewNavigation.resetRotation();
        }
      else
        this._pressed = false, this.view.mapViewNavigation.stop();
      e2.stopPropagation();
    }
  }
}
var t$y;
!function(o2) {
  o2[o2.IN = 0] = "IN", o2[o2.OUT = 1] = "OUT";
}(t$y || (t$y = {}));
class e$s extends i$1b {
  constructor(o2, e2, i2) {
    super(true), this.view = o2, this.keys = e2, this._keysToZoomAction = {}, this.registerIncoming("key-down", i2, (o3) => this._handleKeyDown(o3)), e2.zoomIn.forEach((o3) => this._keysToZoomAction[o3] = t$y.IN), e2.zoomOut.forEach((o3) => this._keysToZoomAction[o3] = t$y.OUT);
  }
  _handleKeyDown(o2) {
    this._handleKey(o2);
  }
  _handleKey(o2) {
    const e2 = o2.modifiers;
    if (e2.size > 0 && !e2.has("Shift"))
      return;
    const { key: i2 } = o2.data;
    if (!(i2 in this._keysToZoomAction))
      return;
    const n2 = this._keysToZoomAction[i2], { mapViewNavigation: s2 } = this.view;
    let r2 = null;
    switch (n2) {
      case t$y.IN:
        r2 = s2.zoomIn();
        break;
      case t$y.OUT:
        r2 = s2.zoomOut();
        break;
      default:
        return;
    }
    s2.begin(), r2.then(() => s2.end()), o2.stopPropagation();
  }
}
const t$x = 0.6;
class o$z extends i$1b {
  constructor(e2, t2) {
    super(true), this._view = e2, this._canZoom = true, this.registerIncoming("mouse-wheel", t2, (e3) => this._handleMouseWheel(e3));
  }
  _handleMouseWheel(e2) {
    if (!this._view.navigation.mouseWheelZoomEnabled)
      return;
    if (e2.preventDefault(), e2.stopPropagation(), !this._canZoom)
      return;
    const o2 = this._view.mapViewNavigation, { x: n2, y: i2, deltaY: s2 } = e2.data, a2 = 1 / t$x ** (1 / 60 * s2), h2 = o2.zoom(a2, [n2, i2]);
    h2 && (this._canZoom = false, h2.catch(() => {
    }).then(() => {
      this._canZoom = true, o2.end();
    }));
  }
}
class a$G extends i$1b {
  constructor(i2) {
    super(true), this.view = i2, this.registerIncoming("drag", (t2) => this._handleDrag(t2)), this.registerIncoming("pointer-down", () => this._stopMomentumNavigation());
    const a2 = this.view.mapViewNavigation;
    this._dragEventSeparator = new t$z({ start: (t2, i3) => {
      a2.pinch.begin(this.view, i3.data), i3.stopPropagation();
    }, update: (t2, i3) => {
      a2.pinch.update(this.view, i3.data), i3.stopPropagation();
    }, end: (t2, i3) => {
      a2.pinch.end(this.view), i3.stopPropagation();
    }, condition: (t2) => t2 >= 2 });
  }
  _handleDrag(t2) {
    this._dragEventSeparator.handle(t2);
  }
  _stopMomentumNavigation() {
    this.view.mapViewNavigation.pinch.stopMomentumNavigation();
  }
}
function t$w(t2) {
  const n2 = t2.native;
  return n2 ? { buttons: n2.buttons.map((t3) => t3.pressed ? t3.value ? t3.value : 1 : 0), axes: n2.axes.map((n3) => s$D(n3, t2.axisThreshold)) } : { buttons: [], axes: [] };
}
function n$H(t2, n2) {
  if (t2.axes.length !== n2.axes.length)
    return false;
  if (t2.buttons.length !== n2.buttons.length)
    return false;
  for (let e2 = 0; e2 < t2.axes.length; e2++)
    if (t2.axes[e2] !== n2.axes[e2])
      return false;
  for (let e2 = 0; e2 < t2.buttons.length; e2++)
    if (t2.buttons[e2] !== n2.buttons[e2])
      return false;
  return true;
}
function e$r(t2) {
  for (let n2 = 0; n2 < t2.axes.length; n2++)
    if (t2.axes[n2] !== 0)
      return false;
  for (let n2 = 0; n2 < t2.buttons.length; n2++)
    if (t2.buttons[n2] !== 0)
      return false;
  return true;
}
function s$D(t2, n2) {
  const e2 = Math.abs(t2);
  return e2 < n2 ? 0 : Math.sign(t2) * (e2 - n2) / (1 - n2);
}
class a$F {
  constructor(e2, t2) {
    this._element = e2, this._input = t2, this._hasEventListeners = false, this._onConnectGamepad = (e3) => {
      this._connectGamepad(e3.gamepad);
    }, this._onDisconnectGamepad = (e3) => {
      const t3 = e3.gamepad, i3 = t3.index, n3 = this._inputDevices[i3];
      n3 && (this._emitGamepadEvent(t3, t$w(n3), false), this._inputDevices.splice(i3, 1), this._latestUpdate.splice(i3, 1), this._input.gamepad.devices.remove(n3), this.ensurePollingState());
    }, this._frameTask = null, this._latestUpdate = new Array(), this._inputDevices = new Array(), this._callback = null;
    const i2 = "getGamepads" in window.navigator, n2 = window.isSecureContext;
    this.supported = i2 && n2, this.supported && (this._forEachGamepad((e3) => this._connectGamepad(e3)), window.addEventListener("gamepadconnected", this._onConnectGamepad), window.addEventListener("gamepaddisconnected", this._onDisconnectGamepad), this.ensurePollingState());
  }
  destroy() {
    this.hasEventListeners = false, this.supported && (window.removeEventListener("gamepadconnected", this._onConnectGamepad), window.removeEventListener("gamepaddisconnected", this._onDisconnectGamepad));
  }
  set hasEventListeners(e2) {
    this._hasEventListeners !== e2 && (this._hasEventListeners = e2, this.ensurePollingState());
  }
  get _eventsEnabled() {
    return this.supported && this._inputDevices.length > 0 && this._hasEventListeners;
  }
  set onEvent(e2) {
    this._callback = e2;
  }
  _connectGamepad(e2) {
    const s2 = new a$Y(e2);
    s2.deviceType !== "unknown" && (this._inputDevices[e2.index] = s2, this._input.gamepad.devices.add(s2)), this.ensurePollingState();
  }
  ensurePollingState() {
    this._eventsEnabled ? this._startPolling() : this._stopPolling();
  }
  _startPolling() {
    this._frameTask == null && (this._frameTask = A$A({ update: () => this._readGamepadState() }));
  }
  _stopPolling() {
    this._frameTask != null && (this._frameTask.remove(), this._frameTask = null, this._latestUpdate = new Array());
  }
  _readGamepadState() {
    const e2 = document.hasFocus(), t2 = this._element.contains(document.activeElement), a2 = this._input.gamepad.enabledFocusMode === "document" && !e2 || this._input.gamepad.enabledFocusMode === "view" && !t2;
    this._forEachGamepad((e3) => {
      const t3 = this._inputDevices[e3.index];
      if (!t3)
        return;
      const d2 = this._latestUpdate[e3.index], o2 = t$w(t3), r2 = a2 || e$r(o2);
      if (d2) {
        if (d2.timestamp === e3.timestamp)
          return;
        if (!d2.active && r2)
          return;
        if (n$H(d2.state, o2))
          return;
      }
      this._emitGamepadEvent(e3, o2, !r2);
    });
  }
  _forEachGamepad(e2) {
    const t2 = window.navigator.getGamepads();
    for (let s2 = 0; s2 < t2.length; s2++) {
      const i2 = t2[s2];
      this._validate(i2) && e2(i2);
    }
  }
  _emitGamepadEvent(e2, t2, s2) {
    const i2 = this._latestUpdate[e2.index], n2 = i2 && i2.active;
    if (!n2 && !s2)
      return;
    const a2 = !n2 && s2 ? "start" : n2 && s2 ? "update" : "end";
    this._latestUpdate[e2.index] = { timestamp: e2.timestamp, state: t2, active: s2 }, this._callback && this._callback({ device: this._inputDevices[e2.index], state: t2, action: a2 });
  }
  _validate(e2) {
    if (!e2)
      return false;
    if (!e2.connected)
      return false;
    for (let t2 = 0; t2 < e2.axes.length; t2++)
      if (isNaN(e2.axes[t2]))
        return false;
    return true;
  }
}
const o$y = has("trident"), a$E = has("edge"), s$C = has("chrome"), r$F = has("ff"), h$w = has("safari"), l$H = { touchNone: "esri-view-surface--touch-none", touchPan: "esri-view-surface--touch-pan" };
class u$t {
  constructor(e2, t2) {
    this._input = t2, this._active = {}, this._activePointerCaptures = new Set(), this._keyDownState = new Set(), this._eventId = 1, this._browserTouchPanningEnabled = false, this._element = e2, e2.getAttribute("tabindex") || e2.setAttribute("tabindex", "0"), this._eventHandlers = { "key-down": this._handleKey, "key-up": this._handleKey, "pointer-down": this._handlePointer, "pointer-move": this._handlePointerPreventDefault, "pointer-up": this._handlePointerPreventDefault, "pointer-enter": this._handlePointer, "pointer-leave": this._handlePointer, "pointer-cancel": this._handlePointer, "mouse-wheel": this._handleMouseWheel, "pointer-capture-lost": this._handlePointerCaptureLost }, this._updateTouchAction(), this._element.addEventListener("keydown", this._preventAltKeyDefault), this._gamepadSource = new a$F(e2, this._input), this._gamepadSource.onEvent = (e3) => this._callback("gamepad", e3);
  }
  destroy() {
    this._callback = null, this.activeEvents = null, this._activePointerCaptures.forEach((e2) => {
      this._releasePointerCaptureSafe(e2);
    }), this._gamepadSource = s$2D(this._gamepadSource), this._activePointerCaptures = null, this._removeTouchAction(), this._element.removeEventListener("keydown", this._preventAltKeyDefault);
  }
  get browserTouchPanningEnabled() {
    return this._browserTouchPanningEnabled;
  }
  set browserTouchPanningEnabled(e2) {
    this._browserTouchPanningEnabled = e2, this._updateTouchAction(), this._updateTouchEventHandling();
  }
  set onEventReceived(e2) {
    this._callback = e2;
  }
  set activeEvents(e2) {
    for (const t2 in this._active)
      if (!e2 || !e2.has(t2)) {
        const e3 = this._active[t2];
        this._element.removeEventListener(c$J[t2], e3), delete this._active[t2];
      }
    e2 && e2.forEach((e3) => {
      if (!this._active[e3] && c$J[e3]) {
        const t2 = (this._eventHandlers[e3] || this._handleDefault).bind(this, e3);
        this._element.addEventListener(c$J[e3], t2), this._active[e3] = t2;
      }
    }), this._gamepadSource.hasEventListeners = e2 && e2.has("gamepad");
  }
  setPointerCapture(e2, t2) {
    t2 ? (this._element.setPointerCapture(e2.pointerId), this._activePointerCaptures.add(e2.pointerId)) : (this._releasePointerCaptureSafe(e2.pointerId), this._activePointerCaptures.delete(e2.pointerId));
  }
  _updateTouchAction() {
    this._element.classList.remove(this._browserTouchPanningEnabled ? l$H.touchNone : l$H.touchPan), this._element.classList.add(this._browserTouchPanningEnabled ? l$H.touchPan : l$H.touchNone);
  }
  _updateTouchEventHandling() {
    this._browserTouchPanningEnabled ? this._element.addEventListener("touchmove", this._preventMultiTouchPanning) : this._element.removeEventListener("touchmove", this._preventMultiTouchPanning);
  }
  _removeTouchAction() {
    this._element.classList.remove(l$H.touchNone), this._element.classList.remove(l$H.touchPan), this._element.removeEventListener("touchmove", this._preventMultiTouchPanning);
  }
  _releasePointerCaptureSafe(e2) {
    try {
      if (this._element.hasPointerCapture && !this._element.hasPointerCapture(e2))
        return;
      this._element.releasePointerCapture(e2);
    } catch (t2) {
    }
  }
  _updateNormalizedPointerLikeEvent(e2, t2) {
    const n2 = i$$(this._element, e2);
    return u$t.test.disableSubpixelCoordinates && (n2.x = Math.round(n2.x), n2.y = Math.round(n2.y)), t2.x = n2.x, t2.y = n2.y, t2;
  }
  _handleKey(e2, n2) {
    const i2 = o$R(n2);
    i2 && e2 === "key-up" && this._keyDownState.delete(i2);
    const o2 = { native: n2, key: i2, repeat: i2 && this._keyDownState.has(i2) };
    i2 && e2 === "key-down" && this._keyDownState.add(o2.key), this._callback(e2, o2);
  }
  _handlePointer(e2, t2) {
    const n2 = this._updateNormalizedPointerLikeEvent(t2, { native: t2, x: 0, y: 0, pointerType: t2.pointerType, button: t2.button, buttons: t2.buttons, eventId: this._eventId++ });
    this._callback(e2, n2);
  }
  _handlePointerPreventDefault(e2, t2) {
    const n2 = this._updateNormalizedPointerLikeEvent(t2, { native: t2, x: 0, y: 0, pointerType: t2.pointerType, button: t2.button, buttons: t2.buttons, eventId: this._eventId++ });
    t2.preventDefault(), this._callback(e2, n2);
  }
  _handleMouseWheel(e2, t2) {
    let n2 = t2.deltaY;
    switch (t2.deltaMode) {
      case 0:
        (o$y || a$E) && (n2 = n2 / document.documentElement.clientHeight * 600);
        break;
      case 1:
        n2 *= 30;
        break;
      case 2:
        n2 *= 900;
    }
    o$y || a$E ? n2 *= 0.7 : s$C || h$w ? n2 *= 0.6 : r$F && (n2 *= 1.375);
    const i2 = 100, l2 = Math.abs(n2);
    if (l2 > i2) {
      const e3 = 0.02;
      n2 = n2 / l2 * 200 / (1 + Math.exp(-e3 * (l2 - i2)));
    }
    const u2 = this._updateNormalizedPointerLikeEvent(t2, { native: t2, x: 0, y: 0, deltaY: n2 });
    this._callback(e2, u2);
  }
  _handlePointerCaptureLost(e2, t2) {
    this._activePointerCaptures.delete(t2.pointerId), this._handleDefault(e2, t2);
  }
  _handleDefault(e2, t2) {
    const n2 = { native: t2 };
    t2.preventDefault(), this._callback(e2, n2);
  }
  _preventAltKeyDefault(e2) {
    e2.key === "Alt" && e2.preventDefault();
  }
  _preventMultiTouchPanning(e2) {
    e2.touches.length > 1 && e2.preventDefault();
  }
}
u$t.test = { disableSubpixelCoordinates: false };
const c$J = { "key-down": "keydown", "key-up": "keyup", "pointer-down": "pointerdown", "pointer-up": "pointerup", "pointer-move": "pointermove", "mouse-wheel": "wheel", "pointer-capture-got": "gotpointercapture", "pointer-capture-lost": "lostpointercapture", "context-menu": "contextmenu", "pointer-enter": "pointerenter", "pointer-leave": "pointerleave", "pointer-cancel": "pointercancel", focus: "focus", blur: "blur" };
class e$q extends i$1b {
  constructor() {
    super(true), this.registerIncoming("context-menu", (t2) => {
      t2.data.native.preventDefault();
    });
  }
}
function e$p(t2, e2) {
  return Math.abs(e2.x - t2.x) + Math.abs(e2.y - t2.y);
}
function n$G(t2, e2) {
  const n2 = e2.x - t2.x, r2 = e2.y - t2.y;
  return Math.sqrt(n2 * n2 + r2 * r2);
}
function r$E(e2, n2) {
  if (n2 ? (n2.radius = 0, n2.center.x = 0, n2.center.y = 0) : n2 = { radius: 0, center: c$2K() }, e2.length === 0)
    return n2;
  if (e2.length === 1)
    return n2.center.x = e2[0].x, n2.center.y = e2[0].y, n2;
  if (e2.length === 2) {
    const [t2, r3] = e2, [c3, o3] = [r3.x - t2.x, r3.y - t2.y];
    return n2.radius = Math.sqrt(c3 * c3 + o3 * o3) / 2, n2.center.x = (t2.x + r3.x) / 2, n2.center.y = (t2.y + r3.y) / 2, n2;
  }
  let r2 = 0, c2 = 0;
  for (let t2 = 0; t2 < e2.length; t2++)
    r2 += e2[t2].x, c2 += e2[t2].y;
  r2 /= e2.length, c2 /= e2.length;
  const o2 = e2.map((t2) => t2.x - r2), s2 = e2.map((t2) => t2.y - c2);
  let u2 = 0, i2 = 0, x2 = 0, y2 = 0, a2 = 0, h2 = 0, l2 = 0;
  for (let t2 = 0; t2 < o2.length; t2++) {
    const e3 = o2[t2], n3 = s2[t2], r3 = e3 * e3, c3 = n3 * n3;
    u2 += r3, i2 += c3, x2 += e3 * n3, y2 += r3 * e3, a2 += c3 * n3, h2 += e3 * c3, l2 += n3 * r3;
  }
  const f2 = 0.5 * (y2 + h2), g2 = 0.5 * (a2 + l2), p2 = u2 * i2 - x2 * x2, d2 = (f2 * i2 - g2 * x2) / p2, m2 = (u2 * g2 - x2 * f2) / p2, M2 = c$2K(d2 + r2, m2 + c2);
  return { radius: Math.sqrt(d2 * d2 + m2 * m2 + (u2 + i2) / e2.length), center: M2 };
}
function c$I(t2) {
  const { native: e2 } = t2, { pointerId: n2, button: r2, pointerType: c2 } = e2;
  return c2 === "mouse" ? `${n2}:${r2}` : `${c2}`;
}
const l$G = { maximumDoubleClickDelay: 250, maximumDoubleClickDistance: 10, maximumDoubleTouchDelay: 350, maximumDoubleTouchDistance: 35 };
class m$O extends i$1b {
  constructor(t2 = l$G.maximumDoubleClickDelay, i2 = l$G.maximumDoubleClickDistance, o2 = l$G.maximumDoubleTouchDelay, n2 = l$G.maximumDoubleTouchDistance, s2 = t$28) {
    super(false), this._maximumDoubleClickDelay = t2, this._maximumDoubleClickDistance = i2, this._maximumDoubleTouchDelay = o2, this._maximumDoubleTouchDistance = n2, this._clock = s2, this._pointerState = new Map(), this._click = this.registerOutgoing("click"), this._doubleClick = this.registerOutgoing("double-click"), this.registerIncoming("immediate-click", this._handleImmediateClick.bind(this)), this.registerIncoming("pointer-down", this._handlePointerDown.bind(this));
  }
  onUninstall() {
    this._pointerState.forEach((e2) => e2.doubleClickTimer = h$1W(e2.doubleClickTimer));
  }
  get hasPendingInputs() {
    return n$2V(this._pointerState, (e2) => e2.doubleClickTimer != null);
  }
  _clearDoubleClickTimer(e2, t2) {
    const o2 = this._pointerState.get(e2);
    o2 && (o2.doubleClickTimer = h$1W(o2.doubleClickTimer), t2 && this._click.emit(o2.event.data, void 0, o2.event.modifiers), this._pointerState.delete(e2), this.refreshHasPendingInputs());
  }
  _doubleClickTimeoutExceeded(e2) {
    const t2 = this._pointerState.get(e2);
    t2.pointerDownCount === 1 && this._click.emit(t2.event.data, void 0, t2.event.modifiers), t2.doubleClickTimer = null, this._pointerState.delete(e2), this.refreshHasPendingInputs();
  }
  _getPointerId(e2) {
    const { pointerId: t2, pointerType: i2, button: o2 } = e2.native;
    return i2 === "mouse" ? `${t2}:${o2}` : `${i2}`;
  }
  _handleImmediateClick(e2) {
    const t2 = e2.data, { pointerType: i2 } = t2.native, o2 = this._getPointerId(t2);
    if (!this._pointerState.has(o2))
      return void this._startClick(e2);
    const s2 = this._pointerState.get(o2), { data: l2, modifiers: m2 } = s2.event, c2 = i2 === "touch" ? this._maximumDoubleTouchDistance : this._maximumDoubleClickDistance;
    e$p(l2, t2) > c2 ? (this._clearDoubleClickTimer(o2, true), this._startClick(e2)) : (this._clearDoubleClickTimer(o2, false), s2.pointerDownCount === 2 && this._doubleClick.emit(l2, void 0, m2));
  }
  _handlePointerDown(e2) {
    const t2 = c$I(e2.data), i2 = this._pointerState.get(t2);
    i2 && (i2.pointerDownCount += 1);
  }
  _startClick(e2) {
    const { data: t2 } = e2, { native: { pointerType: i2 } } = t2, o2 = c$I(t2), n2 = i2 === "touch" ? this._maximumDoubleTouchDelay : this._maximumDoubleClickDelay, l2 = this._clock.setTimeout(() => this._doubleClickTimeoutExceeded(o2), n2), m2 = 1;
    this._pointerState.set(o2, { event: e2, doubleClickTimer: l2, pointerDownCount: m2 }), this.refreshHasPendingInputs();
  }
}
class p$P extends i$1b {
  constructor(e2 = l$G.maximumDoubleClickDelay, a2 = l$G.maximumDoubleClickDistance, r2 = l$G.maximumDoubleTouchDelay, n2 = l$G.maximumDoubleTouchDistance, u2 = t$28) {
    super(false), this._maximumDoubleClickDelay = e2, this._maximumDoubleClickDistance = a2, this._maximumDoubleTouchDelay = r2, this._maximumDoubleTouchDistance = n2, this._clock = u2, this._doubleTapDragReady = false, this._doubleTapDragActive = false, this._dragStartCenter = c$2K(0, 0), this._pointerState = new Map(), this._doubleTapDrag = this.registerOutgoing("double-tap-drag"), this._dragEventSeparator = new t$z({ start: (t2, e3) => this._dragStart(t2, e3), update: (t2, e3) => this._dragUpdate(e3), end: (t2, e3) => this._dragEnd(e3) }), this.registerIncoming("drag", (t2) => this._dragEventSeparator.handle(t2)), this.registerIncoming("pointer-down", (t2) => this._handlePointerDown(t2)), this.registerIncoming("pointer-up", () => this._handlePointerUp());
  }
  onUninstall() {
    this._pointerState.forEach((t2) => {
      t2.doubleTapTimeout = h$1W(t2.doubleTapTimeout);
    });
  }
  get hasPendingInputs() {
    return n$2V(this._pointerState, (t2) => t2.doubleTapTimeout != null);
  }
  _clearPointerDown(t2) {
    const e2 = this._pointerState.get(t2);
    e2 && (e2.doubleTapTimeout = h$1W(e2.doubleTapTimeout), this._pointerState.delete(t2), this.refreshHasPendingInputs());
  }
  _createDoubleTapDragData(t2, e2, a2) {
    const { button: i2, buttons: o2, pointer: r2, pointers: s2, pointerType: n2, timestamp: u2 } = a2;
    return { action: t2, delta: e2, button: i2, buttons: o2, pointer: r2, pointers: s2, pointerType: n2, timestamp: u2 };
  }
  _dragStart(t2, e2) {
    if (!this._doubleTapDragReady || t2 !== 1)
      return;
    this._doubleTapDragReady = false, this._doubleTapDragActive = true;
    const { data: a2, modifiers: o2 } = e2, { center: r2 } = a2;
    this._dragStartCenter = r2;
    const s2 = this._createDoubleTapDragData("begin", c$2K(0, 0), a2);
    this._doubleTapDrag.emit(s2, void 0, o2), e2.stopPropagation();
  }
  _dragUpdate(t2) {
    if (!this._doubleTapDragActive)
      return;
    const { data: e2, modifiers: a2 } = t2, { center: o2 } = e2, r2 = c$2K(o2.x - this._dragStartCenter.x, o2.y - this._dragStartCenter.y), s2 = this._createDoubleTapDragData("update", r2, e2);
    this._doubleTapDrag.emit(s2, void 0, a2), t2.stopPropagation();
  }
  _dragEnd(t2) {
    if (!this._doubleTapDragActive)
      return;
    const { data: e2, modifiers: a2 } = t2, { center: o2 } = e2, r2 = c$2K(o2.x - this._dragStartCenter.x, o2.y - this._dragStartCenter.y), s2 = this._createDoubleTapDragData("end", r2, e2);
    this._doubleTapDrag.emit(s2, void 0, a2), this._doubleTapDragActive = false, t2.stopPropagation();
  }
  _handlePointerDown(t2) {
    const { data: e2 } = t2, a2 = c$I(e2), i2 = this._pointerState.get(a2), { pointerType: o2 } = e2.native;
    if (i2) {
      const r2 = o2 === "touch" ? this._maximumDoubleTouchDistance : this._maximumDoubleClickDistance;
      this._clearPointerDown(a2), e$p(i2.event.data, e2) > r2 ? this._storePointerDown(t2) : this._doubleTapDragReady = true;
    } else
      this._storePointerDown(t2);
  }
  _handlePointerUp() {
    this._doubleTapDragReady = false;
  }
  _storePointerDown(t2) {
    const { data: e2 } = t2, { pointerType: a2 } = e2.native, i2 = c$I(e2), o2 = a2 === "touch" ? this._maximumDoubleTouchDelay : this._maximumDoubleClickDelay, r2 = this._clock.setTimeout(() => this._clearPointerDown(i2), o2);
    this._pointerState.set(i2, { event: t2, doubleTapTimeout: r2 }), this.refreshHasPendingInputs();
  }
}
class s$B extends i$1b {
  constructor(t2) {
    super(false), this._navigationTouch = t2, this._startStateModifiers = new Set(), this._activePointerMap = new Map(), this._isDragging = false, this._isCurrentDragSuppressed = false, this._drag = this.registerOutgoing("drag"), this.registerIncoming("pointer-drag", this._handlePointerDrag.bind(this)), this.registerIncoming("pointer-up", this._handlePointerUpAndPointerLost.bind(this)), this.registerIncoming("pointer-capture-lost", this._handlePointerUpAndPointerLost.bind(this)), this.registerIncoming("pointer-cancel", this._handlePointerUpAndPointerLost.bind(this));
  }
  _createPayload(t2, e2, i2, n2) {
    return { action: t2, pointerType: this._pointerType, button: this._mouseButton, buttons: e2.buttons, timestamp: n2, pointers: o$x(this._activePointerMap), pointer: e2, angle: i2.angle, radius: i2.radius, center: i2.center };
  }
  _addPointer(t2) {
    const e2 = t2.native.pointerId, i2 = a$D(this._activePointerMap).angle, n2 = { event: t2, initialAngle: 0, lastAngle: 0 };
    this._activePointerMap.set(e2, n2);
    const s2 = h$v(n2, r$D(this._activePointerMap));
    n2.initialAngle = s2, n2.lastAngle = s2, this._updatePointerAngles(i2);
  }
  _updatePointer(t2) {
    if (t2 && t2.x == null && t2.y == null)
      return;
    const e2 = t2.native.pointerId, i2 = this._activePointerMap.get(e2);
    i2 ? i2.event = t2 : this._addPointer(t2);
  }
  _removePointer(t2) {
    const e2 = a$D(this._activePointerMap).angle;
    this._activePointerMap.delete(t2), this._updatePointerAngles(e2);
  }
  _updatePointerAngles(t2) {
    const e2 = a$D(this._activePointerMap);
    this._activePointerMap.forEach((i2) => {
      i2.initialAngle = h$v(i2, e2) - t2, i2.lastAngle = h$v(i2, e2) - t2;
    });
  }
  _emitEvent(t2, e2, i2) {
    const n2 = a$D(this._activePointerMap);
    this._drag.emit(this._createPayload(t2, e2, n2, i2), void 0, this._startStateModifiers);
  }
  _handlePointerUpAndPointerLost(t2) {
    const i2 = t2.data.native.pointerId, n2 = n$2K(t2.timestamp);
    this._activePointerMap.get(i2) && (this._activePointerMap.size === 1 ? (this._updatePointer(t2.data), !this._isCurrentDragSuppressed && this._emitEvent("end", t2.data, n2), this._isDragging = false, this._isCurrentDragSuppressed = false, this._removePointer(i2)) : (this._removePointer(i2), this._emitEvent("removed", t2.data, n$2K(t2.timestamp))));
  }
  _handlePointerDrag(t2) {
    const i2 = t2.data, n2 = i2.currentEvent, s2 = n$2K(t2.timestamp);
    switch (i2.action) {
      case "start":
      case "update":
        this._isDragging ? this._activePointerMap.has(n2.native.pointerId) ? (this._updatePointer(n2), !this._isCurrentDragSuppressed && this._emitEvent("update", n2, s2)) : (this._addPointer(n2), this._emitEvent("added", n2, s2), this._isCurrentDragSuppressed = this._isSuppressed) : (this._updatePointer(n2), this._pointerType = t2.data.startEvent.pointerType, this._mouseButton = t2.data.startEvent.button, this._startStateModifiers = t2.modifiers, this._isDragging = true, this._isCurrentDragSuppressed = this._isSuppressed, !this._isCurrentDragSuppressed && this._emitEvent("start", n2, s2));
    }
  }
  get _isSuppressed() {
    return !!this._navigationTouch && !this._navigationTouch.browserTouchPanEnabled && this._pointerType === "touch" && this._activePointerMap.size === 1;
  }
}
function r$D(e2) {
  const i2 = [];
  return e2.forEach((e3) => {
    i2.push(c$2K(e3.event.x, e3.event.y));
  }), r$E(i2);
}
function a$D(t2) {
  const e2 = r$D(t2);
  let i2 = 0;
  return t2.forEach((t3) => {
    let n2 = h$v(t3, e2), s2 = n2 - t3.lastAngle;
    for (; s2 > Math.PI; )
      s2 -= 2 * Math.PI;
    for (; s2 < -Math.PI; )
      s2 += 2 * Math.PI;
    n2 = t3.lastAngle + s2, t3.lastAngle = n2;
    const r2 = n2 - t3.initialAngle;
    i2 += r2;
  }), i2 /= t2.size || 1, { angle: i2, radius: e2.radius, center: e2.center };
}
function o$x(t2) {
  const e2 = new Map();
  return t2.forEach((t3, i2) => e2.set(i2, t3.event)), e2;
}
function h$v(t2, e2) {
  const i2 = t2.event, n2 = i2.x - e2.center.x, s2 = i2.y - e2.center.y;
  return Math.atan2(s2, n2);
}
var p$O;
!function(t2) {
  t2[t2.Left = 0] = "Left", t2[t2.Middle = 1] = "Middle", t2[t2.Right = 2] = "Right", t2[t2.Back = 3] = "Back", t2[t2.Forward = 4] = "Forward", t2[t2.Undefined = -1] = "Undefined";
}(p$O || (p$O = {}));
class m$N extends i$1b {
  constructor(e2 = l$G.maximumDoubleClickDelay, o2 = l$G.maximumDoubleClickDistance, a2 = l$G.maximumDoubleTouchDelay, m2 = l$G.maximumDoubleTouchDistance, n2 = t$28) {
    super(false), this._maximumDoubleClickDelay = e2, this._maximumDoubleClickDistance = o2, this._maximumDoubleTouchDelay = a2, this._maximumDoubleTouchDistance = m2, this._clock = n2, this._pointerState = new Map(), this._immediateDoubleClick = this.registerOutgoing("immediate-double-click"), this.registerIncoming("pointer-down", this._handlePointerDown.bind(this)), this.registerIncoming("pointer-up", this._handlePointerUp.bind(this));
  }
  onUninstall() {
    this._pointerState.forEach((t2) => {
      t2.immediateDoubleClick && t2.immediateDoubleClick.timeoutHandle.remove();
    }), super.onUninstall();
  }
  _handlePointerDown(t2) {
    const e2 = t2.data, i2 = c$I(e2);
    if (!this._pointerState.has(i2)) {
      const t3 = { downButton: e2.native.button, immediateDoubleClick: null };
      this._pointerState.set(i2, t3), this.startCapturingPointer(e2.native);
    }
  }
  _handlePointerUp(t2) {
    const e2 = t2.data, i2 = c$I(e2), m2 = this._pointerState.get(i2);
    if (m2 && m2.downButton === e2.native.button) {
      const i3 = m2.immediateDoubleClick;
      if (i3) {
        i3.timeoutHandle.remove();
        const o2 = t2.data.native.pointerType === "touch" ? this._maximumDoubleTouchDistance : this._maximumDoubleClickDistance;
        e$p(i3, t2.data) > o2 ? this._startImmediateDoubleClick(t2, m2) : (this._immediateDoubleClick.emit(t2.data, void 0, i3.modifiers), this._removeState(e2));
      } else
        this._startImmediateDoubleClick(t2, m2);
    }
  }
  _startImmediateDoubleClick(t2, e2) {
    const i2 = t2.data.native.pointerType === "touch" ? this._maximumDoubleTouchDelay : this._maximumDoubleClickDelay;
    e2.immediateDoubleClick = { x: t2.data.x, y: t2.data.y, modifiers: t2.modifiers, timeoutHandle: this._clock.setTimeout(() => this._removeState(t2.data), i2) };
  }
  _removeState(t2) {
    const e2 = c$I(t2);
    this._pointerState.delete(e2), this.stopCapturingPointer(t2.native), this.refreshHasPendingInputs();
  }
}
const o$w = { maximumClickDelay: 300, movementUntilMouseDrag: 1.5, movementUntilPenDrag: 6, movementUntilTouchDrag: 6, holdDelay: 500 };
class r$C extends i$1b {
  constructor(e2 = o$w.maximumClickDelay, i2 = o$w.movementUntilMouseDrag, n2 = o$w.movementUntilPenDrag, r2 = o$w.movementUntilTouchDrag, s2 = o$w.holdDelay, a2 = t$28) {
    super(false), this._maximumClickDelay = e2, this._movementUntilMouseDrag = i2, this._movementUntilPenDrag = n2, this._movementUntilTouchDrag = r2, this._holdDelay = s2, this._clock = a2, this._pointerState = new Map(), this._pointerDrag = this.registerOutgoing("pointer-drag"), this._immediateClick = this.registerOutgoing("immediate-click"), this._pointerHold = this.registerOutgoing("hold"), this.registerIncoming("pointer-down", this._handlePointerDown.bind(this)), this.registerIncoming("pointer-up", (t2) => {
      this._handlePointerLoss(t2, "pointer-up");
    }), this.registerIncoming("pointer-capture-lost", (t2) => {
      this._handlePointerLoss(t2, "pointer-capture-lost");
    }), this.registerIncoming("pointer-cancel", (t2) => {
      this._handlePointerLoss(t2, "pointer-cancel");
    }), this._moveHandle = this.registerIncoming("pointer-move", this._handlePointerMove.bind(this)), this._moveHandle.pause();
  }
  onUninstall() {
    this._pointerState.forEach((t2) => {
      t2.holdTimeout = h$1W(t2.holdTimeout);
    }), super.onUninstall();
  }
  _handlePointerDown(t2) {
    const e2 = t2.data, i2 = e2.native.pointerId;
    let n2 = null;
    this._pointerState.size === 0 && (n2 = this._clock.setTimeout(() => {
      const e3 = this._pointerState.get(i2);
      if (e3) {
        if (!e3.isDragging) {
          const i3 = e3.previousEvent;
          this._pointerHold.emit(i3, void 0, t2.modifiers), e3.holdEmitted = true;
        }
        e3.holdTimeout = null;
      }
    }, this._holdDelay));
    const o2 = { startEvent: e2, previousEvent: e2, startTimestamp: t2.timestamp, isDragging: false, downButton: e2.native.button, holdTimeout: n2, modifiers: new Set() };
    this._pointerState.set(i2, o2), this.startCapturingPointer(e2.native), this._moveHandle.resume(), this._pointerState.size > 1 && this._startDragging(t2);
  }
  _createPointerDragData(t2, e2, i2) {
    return { action: t2, startEvent: e2.startEvent, previousEvent: e2.previousEvent, currentEvent: i2 };
  }
  _handlePointerMove(t2) {
    const e2 = t2.data, i2 = e2.native.pointerId, o2 = this._pointerState.get(i2);
    if (o2) {
      if (o2.isDragging)
        this._pointerDrag.emit(this._createPointerDragData("update", o2, e2), void 0, o2.modifiers);
      else {
        n$G(e2, o2.startEvent) > this._getDragThreshold(e2.native.pointerType) && this._startDragging(t2);
      }
      o2.previousEvent = e2;
    }
  }
  _getDragThreshold(t2) {
    switch (t2) {
      case "touch":
        return this._movementUntilTouchDrag;
      case "pen":
        return this._movementUntilPenDrag;
      default:
        return this._movementUntilMouseDrag;
    }
  }
  _startDragging(t2) {
    const e2 = t2.data, i2 = e2.native.pointerId;
    this._pointerState.forEach((n2) => {
      n2.holdTimeout != null && (n2.holdTimeout.remove(), n2.holdTimeout = null), n2.isDragging || (n2.modifiers = t2.modifiers, n2.isDragging = true, i2 === n2.startEvent.native.pointerId ? this._pointerDrag.emit(this._createPointerDragData("start", n2, e2)) : this._pointerDrag.emit(this._createPointerDragData("start", n2, n2.previousEvent), t2.timestamp));
    });
  }
  _handlePointerLoss(t2, e2) {
    const i2 = t2.data, n2 = i2.native.pointerId, o2 = this._pointerState.get(n2);
    if (o2) {
      if (o2.holdTimeout != null && (o2.holdTimeout.remove(), o2.holdTimeout = null), o2.isDragging)
        this._pointerDrag.emit(this._createPointerDragData("end", o2, e2 === "pointer-up" ? i2 : o2.previousEvent), void 0, o2.modifiers);
      else if (e2 === "pointer-up" && o2.downButton === i2.native.button) {
        t2.timestamp - o2.startTimestamp <= this._maximumClickDelay && !o2.holdEmitted && this._immediateClick.emit(i2);
      }
      this._pointerState.delete(n2), this.stopCapturingPointer(i2.native), this._pointerState.size === 0 && this._moveHandle.pause();
    }
  }
}
const z$g = { counter: "Ctrl", pan: { left: "ArrowLeft", right: "ArrowRight", up: "ArrowUp", down: "ArrowDown" }, zoom: { zoomIn: ["=", "+"], zoomOut: ["-", "_"] }, rotate: { clockwiseOption1: "a", clockwiseOption2: "A", counterClockwiseOption1: "d", counterClockwiseOption2: "D", resetOption1: "n", resetOption2: "N" } };
let k$e = class extends m$2q {
  constructor() {
    super(...arguments), this._handles = new t$2g();
  }
  initialize() {
    const e2 = () => {
      var _a2;
      return (_a2 = this.view) == null ? void 0 : _a2.ready;
    };
    this._handles.add([f$1o(() => !e2(), () => this._disconnect()), f$1o(e2, () => this._connect())]);
  }
  destroy() {
    this._handles && (this._handles.removeAll(), this._handles = null), this._disconnect();
  }
  get latestPointerType() {
    var _a2;
    return (_a2 = this._inputManager) == null ? void 0 : _a2.latestPointerType;
  }
  get latestPointerLocation() {
    var _a2;
    return (_a2 = this._inputManager) == null ? void 0 : _a2.latestPointerLocation;
  }
  get multiTouchActive() {
    var _a2, _b2;
    return (_b2 = (_a2 = this._inputManager) == null ? void 0 : _a2.multiTouchActive) != null ? _b2 : false;
  }
  _disconnect() {
    this.view.viewEvents.disconnect(), this._inputManager = s$2D(this._inputManager);
  }
  _connect() {
    const e2 = this.view.surface, t2 = new u$t(e2, this.view.input), o2 = [new m$N(), new r$C(), new m$O(), new s$B(this.view.navigation), new p$P()], r2 = new u$K({ eventSource: t2, recognizers: o2 });
    r2.installHandlers("prevent-context-menu", [new e$q()], P$h.INTERNAL), r2.installHandlers("navigation", [new a$G(this.view), new d$q(this.view), new o$z(this.view), new a$I(this.view), new a$I(this.view, [z$g.counter]), new n$J(this.view, "primary"), new i$O(this.view, z$g.pan), new e$s(this.view, z$g.zoom), new i$N(this.view, z$g.rotate), new o$A(this.view, "secondary"), new e$t(this.view, "touch")], P$h.INTERNAL), this.view.viewEvents.connect(r2), this._source = t2, this._inputManager = r2, l$1P(() => {
      var _a2, _b2;
      return (_b2 = (_a2 = this.view) == null ? void 0 : _a2.navigation) == null ? void 0 : _b2.browserTouchPanEnabled;
    }, (e3) => {
      this._source && (this._source.browserTouchPanningEnabled = !e3);
    }, h$1j);
  }
  get test() {
    return { inputManager: this._inputManager };
  }
};
e$2g([y$1I()], k$e.prototype, "view", void 0), e$2g([y$1I()], k$e.prototype, "latestPointerType", null), e$2g([y$1I()], k$e.prototype, "latestPointerLocation", null), e$2g([y$1I()], k$e.prototype, "multiTouchActive", null), k$e = e$2g([n$2P("esri.views.2d.input.MapViewInputManager")], k$e);
const C$f = k$e;
var t$v, o$v, r$B, n$F = { exports: {} };
t$v = n$F, o$v = function() {
  function t2(t3, r3, a2, f2, e2) {
    o2(t3, r3, a2 || 0, f2 || t3.length - 1, e2 || n2);
  }
  function o2(t3, n3, a2, f2, e2) {
    for (; f2 > a2; ) {
      if (f2 - a2 > 600) {
        var h2 = f2 - a2 + 1, i2 = n3 - a2 + 1, u2 = Math.log(h2), M2 = 0.5 * Math.exp(2 * u2 / 3), c2 = 0.5 * Math.sqrt(u2 * M2 * (h2 - M2) / h2) * (i2 - h2 / 2 < 0 ? -1 : 1);
        o2(t3, n3, Math.max(a2, Math.floor(n3 - i2 * M2 / h2 + c2)), Math.min(f2, Math.floor(n3 + (h2 - i2) * M2 / h2 + c2)), e2);
      }
      var s2 = t3[n3], x2 = a2, p2 = f2;
      for (r2(t3, a2, n3), e2(t3[f2], s2) > 0 && r2(t3, a2, f2); x2 < p2; ) {
        for (r2(t3, x2, p2), x2++, p2--; e2(t3[x2], s2) < 0; )
          x2++;
        for (; e2(t3[p2], s2) > 0; )
          p2--;
      }
      e2(t3[a2], s2) === 0 ? r2(t3, a2, p2) : r2(t3, ++p2, f2), p2 <= n3 && (a2 = p2 + 1), n3 <= p2 && (f2 = p2 - 1);
    }
  }
  function r2(t3, o3, r3) {
    var n3 = t3[o3];
    t3[o3] = t3[r3], t3[r3] = n3;
  }
  function n2(t3, o3) {
    return t3 < o3 ? -1 : t3 > o3 ? 1 : 0;
  }
  return t2;
}, (r$B = o$v()) !== void 0 && (t$v.exports = r$B);
const a$C = n$F.exports;
function i$M(t2, n2) {
  if (!(this instanceof i$M))
    return new i$M(t2, n2);
  this._maxEntries = Math.max(4, t2 || 9), this._minEntries = Math.max(2, Math.ceil(0.4 * this._maxEntries)), n2 && (typeof n2 == "function" ? this.toBBox = n2 : this._initFormat(n2)), this.clear();
}
function n$E(t2, i2, n2) {
  if (!n2)
    return i2.indexOf(t2);
  for (var h2 = 0; h2 < i2.length; h2++)
    if (n2(t2, i2[h2]))
      return h2;
  return -1;
}
function h$u(t2, i2) {
  a$B(t2, 0, t2.children.length, i2, t2);
}
function a$B(t2, i2, n2, h2, a2) {
  a2 || (a2 = x$i(null)), a2.minX = 1 / 0, a2.minY = 1 / 0, a2.maxX = -1 / 0, a2.maxY = -1 / 0;
  for (var e2, o2 = i2; o2 < n2; o2++)
    e2 = t2.children[o2], r$A(a2, t2.leaf ? h2(e2) : e2);
  return a2;
}
function r$A(t2, i2) {
  return t2.minX = Math.min(t2.minX, i2.minX), t2.minY = Math.min(t2.minY, i2.minY), t2.maxX = Math.max(t2.maxX, i2.maxX), t2.maxY = Math.max(t2.maxY, i2.maxY), t2;
}
function e$o(t2, i2) {
  return t2.minX - i2.minX;
}
function o$u(t2, i2) {
  return t2.minY - i2.minY;
}
function s$A(t2) {
  return (t2.maxX - t2.minX) * (t2.maxY - t2.minY);
}
function l$F(t2) {
  return t2.maxX - t2.minX + (t2.maxY - t2.minY);
}
function m$M(t2, i2) {
  return (Math.max(i2.maxX, t2.maxX) - Math.min(i2.minX, t2.minX)) * (Math.max(i2.maxY, t2.maxY) - Math.min(i2.minY, t2.minY));
}
function c$H(t2, i2) {
  var n2 = Math.max(t2.minX, i2.minX), h2 = Math.max(t2.minY, i2.minY), a2 = Math.min(t2.maxX, i2.maxX), r2 = Math.min(t2.maxY, i2.maxY);
  return Math.max(0, a2 - n2) * Math.max(0, r2 - h2);
}
function u$s(t2, i2) {
  return t2.minX <= i2.minX && t2.minY <= i2.minY && i2.maxX <= t2.maxX && i2.maxY <= t2.maxY;
}
function f$s(t2, i2) {
  return i2.minX <= t2.maxX && i2.minY <= t2.maxY && i2.maxX >= t2.minX && i2.maxY >= t2.minY;
}
function x$i(t2) {
  return { children: t2, height: 1, leaf: true, minX: 1 / 0, minY: 1 / 0, maxX: -1 / 0, maxY: -1 / 0 };
}
function d$p(i2, n2, h2, a2, r2) {
  for (var e2, o2 = [n2, h2]; o2.length; )
    (h2 = o2.pop()) - (n2 = o2.pop()) <= a2 || (e2 = n2 + Math.ceil((h2 - n2) / a2 / 2) * a2, a$C(i2, e2, n2, h2, r2), o2.push(n2, e2, e2, h2));
}
i$M.prototype = { all: function() {
  return this._all(this.data, []);
}, search: function(t2) {
  var i2 = this.data, n2 = [], h2 = this.toBBox;
  if (!f$s(t2, i2))
    return n2;
  for (var a2, r2, e2, o2, s2 = []; i2; ) {
    for (a2 = 0, r2 = i2.children.length; a2 < r2; a2++)
      e2 = i2.children[a2], f$s(t2, o2 = i2.leaf ? h2(e2) : e2) && (i2.leaf ? n2.push(e2) : u$s(t2, o2) ? this._all(e2, n2) : s2.push(e2));
    i2 = s2.pop();
  }
  return n2;
}, collides: function(t2) {
  var i2 = this.data, n2 = this.toBBox;
  if (!f$s(t2, i2))
    return false;
  for (var h2, a2, r2, e2, o2 = []; i2; ) {
    for (h2 = 0, a2 = i2.children.length; h2 < a2; h2++)
      if (r2 = i2.children[h2], f$s(t2, e2 = i2.leaf ? n2(r2) : r2)) {
        if (i2.leaf || u$s(t2, e2))
          return true;
        o2.push(r2);
      }
    i2 = o2.pop();
  }
  return false;
}, load: function(t2) {
  if (!t2 || !t2.length)
    return this;
  if (t2.length < this._minEntries) {
    for (var i2 = 0, n2 = t2.length; i2 < n2; i2++)
      this.insert(t2[i2]);
    return this;
  }
  var h2 = this._build(t2.slice(), 0, t2.length - 1, 0);
  if (this.data.children.length)
    if (this.data.height === h2.height)
      this._splitRoot(this.data, h2);
    else {
      if (this.data.height < h2.height) {
        var a2 = this.data;
        this.data = h2, h2 = a2;
      }
      this._insert(h2, this.data.height - h2.height - 1, true);
    }
  else
    this.data = h2;
  return this;
}, insert: function(t2) {
  return t2 && this._insert(t2, this.data.height - 1), this;
}, clear: function() {
  return this.data = x$i([]), this;
}, remove: function(t2, i2) {
  if (!t2)
    return this;
  for (var h2, a2, r2, e2, o2 = this.data, s2 = this.toBBox(t2), l2 = [], m2 = []; o2 || l2.length; ) {
    if (o2 || (o2 = l2.pop(), a2 = l2[l2.length - 1], h2 = m2.pop(), e2 = true), o2.leaf && (r2 = n$E(t2, o2.children, i2)) !== -1)
      return o2.children.splice(r2, 1), l2.push(o2), this._condense(l2), this;
    e2 || o2.leaf || !u$s(o2, s2) ? a2 ? (h2++, o2 = a2.children[h2], e2 = false) : o2 = null : (l2.push(o2), m2.push(h2), h2 = 0, a2 = o2, o2 = o2.children[0]);
  }
  return this;
}, toBBox: function(t2) {
  return t2;
}, compareMinX: e$o, compareMinY: o$u, toJSON: function() {
  return this.data;
}, fromJSON: function(t2) {
  return this.data = t2, this;
}, _all: function(t2, i2) {
  for (var n2 = []; t2; )
    t2.leaf ? i2.push.apply(i2, t2.children) : n2.push.apply(n2, t2.children), t2 = n2.pop();
  return i2;
}, _build: function(t2, i2, n2, a2) {
  var r2, e2 = n2 - i2 + 1, o2 = this._maxEntries;
  if (e2 <= o2)
    return h$u(r2 = x$i(t2.slice(i2, n2 + 1)), this.toBBox), r2;
  a2 || (a2 = Math.ceil(Math.log(e2) / Math.log(o2)), o2 = Math.ceil(e2 / Math.pow(o2, a2 - 1))), (r2 = x$i([])).leaf = false, r2.height = a2;
  var s2, l2, m2, c2, u2 = Math.ceil(e2 / o2), f2 = u2 * Math.ceil(Math.sqrt(o2));
  for (d$p(t2, i2, n2, f2, this.compareMinX), s2 = i2; s2 <= n2; s2 += f2)
    for (d$p(t2, s2, m2 = Math.min(s2 + f2 - 1, n2), u2, this.compareMinY), l2 = s2; l2 <= m2; l2 += u2)
      c2 = Math.min(l2 + u2 - 1, m2), r2.children.push(this._build(t2, l2, c2, a2 - 1));
  return h$u(r2, this.toBBox), r2;
}, _chooseSubtree: function(t2, i2, n2, h2) {
  for (var a2, r2, e2, o2, l2, c2, u2, f2; h2.push(i2), !i2.leaf && h2.length - 1 !== n2; ) {
    for (u2 = f2 = 1 / 0, a2 = 0, r2 = i2.children.length; a2 < r2; a2++)
      l2 = s$A(e2 = i2.children[a2]), (c2 = m$M(t2, e2) - l2) < f2 ? (f2 = c2, u2 = l2 < u2 ? l2 : u2, o2 = e2) : c2 === f2 && l2 < u2 && (u2 = l2, o2 = e2);
    i2 = o2 || i2.children[0];
  }
  return i2;
}, _insert: function(t2, i2, n2) {
  var h2 = this.toBBox, a2 = n2 ? t2 : h2(t2), e2 = [], o2 = this._chooseSubtree(a2, this.data, i2, e2);
  for (o2.children.push(t2), r$A(o2, a2); i2 >= 0 && e2[i2].children.length > this._maxEntries; )
    this._split(e2, i2), i2--;
  this._adjustParentBBoxes(a2, e2, i2);
}, _split: function(t2, i2) {
  var n2 = t2[i2], a2 = n2.children.length, r2 = this._minEntries;
  this._chooseSplitAxis(n2, r2, a2);
  var e2 = this._chooseSplitIndex(n2, r2, a2), o2 = x$i(n2.children.splice(e2, n2.children.length - e2));
  o2.height = n2.height, o2.leaf = n2.leaf, h$u(n2, this.toBBox), h$u(o2, this.toBBox), i2 ? t2[i2 - 1].children.push(o2) : this._splitRoot(n2, o2);
}, _splitRoot: function(t2, i2) {
  this.data = x$i([t2, i2]), this.data.height = t2.height + 1, this.data.leaf = false, h$u(this.data, this.toBBox);
}, _chooseSplitIndex: function(t2, i2, n2) {
  var h2, r2, e2, o2, l2, m2, u2, f2;
  for (m2 = u2 = 1 / 0, h2 = i2; h2 <= n2 - i2; h2++)
    o2 = c$H(r2 = a$B(t2, 0, h2, this.toBBox), e2 = a$B(t2, h2, n2, this.toBBox)), l2 = s$A(r2) + s$A(e2), o2 < m2 ? (m2 = o2, f2 = h2, u2 = l2 < u2 ? l2 : u2) : o2 === m2 && l2 < u2 && (u2 = l2, f2 = h2);
  return f2;
}, _chooseSplitAxis: function(t2, i2, n2) {
  var h2 = t2.leaf ? this.compareMinX : e$o, a2 = t2.leaf ? this.compareMinY : o$u;
  this._allDistMargin(t2, i2, n2, h2) < this._allDistMargin(t2, i2, n2, a2) && t2.children.sort(h2);
}, _allDistMargin: function(t2, i2, n2, h2) {
  t2.children.sort(h2);
  var e2, o2, s2 = this.toBBox, m2 = a$B(t2, 0, i2, s2), c2 = a$B(t2, n2 - i2, n2, s2), u2 = l$F(m2) + l$F(c2);
  for (e2 = i2; e2 < n2 - i2; e2++)
    o2 = t2.children[e2], r$A(m2, t2.leaf ? s2(o2) : o2), u2 += l$F(m2);
  for (e2 = n2 - i2 - 1; e2 >= i2; e2--)
    o2 = t2.children[e2], r$A(c2, t2.leaf ? s2(o2) : o2), u2 += l$F(c2);
  return u2;
}, _adjustParentBBoxes: function(t2, i2, n2) {
  for (var h2 = n2; h2 >= 0; h2--)
    r$A(i2[h2], t2);
}, _condense: function(t2) {
  for (var i2, n2 = t2.length - 1; n2 >= 0; n2--)
    t2[n2].children.length === 0 ? n2 > 0 ? (i2 = t2[n2 - 1].children).splice(i2.indexOf(t2[n2]), 1) : this.clear() : h$u(t2[n2], this.toBBox);
}, _initFormat: function(t2) {
  var i2 = ["return a", " - b", ";"];
  this.compareMinX = new Function("a", "b", i2.join(t2[0])), this.compareMinY = new Function("a", "b", i2.join(t2[1])), this.toBBox = new Function("a", "return {minX: a" + t2[0] + ", minY: a" + t2[1] + ", maxX: a" + t2[2] + ", maxY: a" + t2[3] + "};");
} };
class n$D {
  constructor(t2, e2) {
    this.key = new e$v(0, 0, 0, 0), this.bounds = u$1O(), this.objectIds = new Set(), this.key.set(e2);
    const s2 = t2.getLODInfoAt(this.key);
    this.tileInfoView = t2, this.tileInfoView.getTileBounds(this.bounds, this.key, true), this.resolution = s2.resolution, this.scale = s2.scale, this.level = s2.level;
  }
  get id() {
    return this.key.id;
  }
  get extent() {
    return w$Z.fromBounds(this.bounds, this.tileInfoView.tileInfo.spatialReference);
  }
  get transform() {
    return { originPosition: "upperLeft", scale: [this.resolution, this.resolution], translate: [this.bounds[0], this.bounds[3]] };
  }
  createChildTiles() {
    const e2 = this.key.getChildKeys(), i2 = t$2c.acquire();
    for (let t2 = 0; t2 < e2.length; t2++)
      i2[t2] = new n$D(this.tileInfoView, e2[t2]);
    return i2;
  }
  getQuantizationParameters() {
    return a$1L.fromJSON({ mode: "view", originPosition: "upperLeft", tolerance: this.resolution, extent: { xmin: this.bounds[0], ymin: this.bounds[1], xmax: this.bounds[2], ymax: this.bounds[3], spatialReference: this.tileInfoView.tileInfo.spatialReference } });
  }
}
const h$t = { added: [], removed: [] }, n$C = new Set(), r$z = new e$v(0, 0, 0, 0);
class d$o extends n$2G {
  constructor(e2) {
    super(), this._tiles = new Map(), this._index = i$M(9, has("esri-csp-restrictions") ? (e3) => ({ minX: e3.bounds[0], minY: e3.bounds[1], maxX: e3.bounds[2], maxY: e3.bounds[3] }) : [".bounds[0]", ".bounds[1]", ".bounds[2]", ".bounds[3]"]), this.tiles = [], this.tileScheme = e2;
  }
  destroy() {
    this.clear();
  }
  clear() {
    this.tiles.length = 0, this._tiles.clear(), this._index.clear();
  }
  has(e2) {
    return this._tiles.has(e2);
  }
  get(e2) {
    return this._tiles.get(e2);
  }
  boundsIntersections(e2) {
    return this._index.search({ minX: e2[0], minY: e2[1], maxX: e2[2], maxY: e2[3] });
  }
  updateTiles(e2) {
    const t2 = { added: [], removed: [] };
    for (const i2 of e2.added)
      if (!this.has(i2)) {
        const e3 = new n$D(this.tileScheme, i2);
        this._tiles.set(i2, e3), this._index.insert(e3), t2.added.push(e3);
      }
    for (const s2 of e2.removed)
      if (this.has(s2)) {
        const e3 = this.get(s2);
        this._tiles.delete(s2), this._index.remove(e3), t2.removed.push(e3);
      }
    this.tiles.length = 0, this._tiles.forEach((e3) => this.tiles.push(e3)), (t2.added.length || t2.removed.length) && this.emit("update", t2);
  }
  setViewState(e2) {
    const t2 = this.tileScheme.getTileCoverage(e2, 0);
    if (!t2)
      return;
    const { spans: o2, lodInfo: d2 } = t2, { level: l2 } = d2;
    if (o2.length > 0)
      for (const { row: i2, colFrom: a2, colTo: m2 } of o2)
        for (let e3 = a2; e3 <= m2; e3++) {
          const t3 = r$z.set(l2, i2, d2.normalizeCol(e3), d2.getWorldForColumn(e3)).id;
          if (n$C.add(t3), !this.has(t3)) {
            const e4 = new n$D(this.tileScheme, t3);
            this._tiles.set(t3, e4), this._index.insert(e4), this.tiles.push(e4), h$t.added.push(e4);
          }
        }
    for (let s2 = this.tiles.length - 1; s2 >= 0; s2--) {
      const e3 = this.tiles[s2];
      n$C.has(e3.id) || (this._tiles.delete(e3.id), this.tiles.splice(s2, 1), this._index.remove(e3), h$t.removed.push(e3));
    }
    (h$t.added.length || h$t.removed.length) && this.emit("update", h$t), l$J.pool.release(t2), n$C.clear(), h$t.added.length = 0, h$t.removed.length = 0;
  }
}
let p$N = 0, i$L = class extends m$2q {
  constructor() {
    super(...arguments), this.color = new l$2e([0, 255, 255]), this.haloOpacity = 1, this.fillOpacity = 0.25;
  }
  get version() {
    return p$N++;
  }
};
e$2g([y$1I({ readOnly: true })], i$L.prototype, "version", null), e$2g([y$1I({ type: l$2e })], i$L.prototype, "color", void 0), e$2g([y$1I({ type: l$2e })], i$L.prototype, "haloColor", void 0), e$2g([y$1I()], i$L.prototype, "haloOpacity", void 0), e$2g([y$1I()], i$L.prototype, "fillOpacity", void 0), i$L = e$2g([n$2P("esri.views.2d.support.HighlightOptions")], i$L);
const c$G = i$L;
const s$z = (s2) => s2.includes("Brush");
class e$n {
  constructor() {
    this._names = new Map();
  }
  begin(e2) {
    this._names.has(e2) || (this._names.set(e2, false), s$z(e2) && this.record("Esri.FirstDraw"), performance.mark(`Esri.${e2}.Start`));
  }
  end(s2) {
    this._names.has(s2) && !this._names.get(s2) && (this._names.set(s2, true), performance.mark(`Esri.${s2}.End`));
  }
  record(s2) {
    this._names.has(s2) || (this._names.set(s2, true), performance.mark(`Esri.${s2}`));
  }
}
function t$u(t2, h2, i2, e2, d2, l2, n2, o2) {
  let u2;
  t2.ignorePadding && (e2 = { left: 0, right: 0, top: 0, bottom: 0 }), t2.width != null && t2.height != null ? u2 = [t2.width, t2.height] : t2.width == null && t2.height != null ? u2 = [t2.height, t2.height] : t2.width != null && t2.height == null ? u2 = [t2.width, t2.width] : t2.width == null && t2.height == null && (u2 = null);
  const r2 = i2[0] - (e2.left + e2.right), a2 = i2[1] - (e2.top + e2.bottom);
  let g2, w2, c2 = t2.area || { x: 0, y: 0, width: r2, height: a2 };
  if (u2) {
    const t3 = r2 / a2, h3 = u2[0] / u2[1];
    if (h3 > t3) {
      const t4 = c2.width / h3;
      c2 = { x: c2.x, y: Math.round(c2.y + (c2.height - t4) / 2), width: c2.width, height: Math.round(t4) };
    } else {
      const t4 = c2.height * h3;
      c2 = { x: Math.round(c2.x + (c2.width - t4) / 2), y: c2.y, width: Math.round(t4), height: c2.height };
    }
  } else
    u2 = [c2.width, c2.height];
  u2[0] > c2.width ? (g2 = Math.min(u2[0] / c2.width, h2), w2 = u2[0] / c2.width / g2) : (g2 = 1, w2 = u2[0] / c2.width);
  return { resolutionScale: g2, cropArea: { x: Math.round((c2.x + e2.left) * g2), y: Math.round((c2.y + e2.top) * g2), width: Math.round(c2.width * g2), height: Math.round(c2.height * g2) }, outputScale: w2, format: d2, quality: l2, children: n2, rotation: o2 };
}
function r$y(t2, h2, i2) {
  const { ctx: e2, canvas: o2 } = g$k(t2, i2), n2 = e2.getImageData(0, 0, t2.width, t2.height), a2 = c$F(o2, h2);
  return f$r(o2), { dataUrl: a2, data: n2 };
}
function l$E(t2, h2) {
  const { ctx: i2, canvas: e2 } = g$k(t2, h2), o2 = i2.getImageData(0, 0, t2.width, t2.height);
  return f$r(e2), o2;
}
function g$k(t2, h2) {
  const i2 = d$n();
  h2.premultipliedAlpha && v$k(t2), i2.width = t2.width, i2.height = t2.height;
  const e2 = i2.getContext("2d");
  return e2.putImageData(t2, 0, 0), h2.flipY && q$c(e2), { ctx: e2, canvas: i2 };
}
function f$r(t2) {
  t2.width = 0, t2.height = 0;
}
function d$n() {
  return t$2r(u$r) && (u$r = document.createElement("canvas")), u$r;
}
let u$r = null;
function c$F(t2, h2) {
  const i2 = I$d[h2.format], e2 = h2.quality / 100;
  return t2.toDataURL(i2, e2);
}
function s$y(h2, i2) {
  const e2 = D$a(h2), o2 = B$a[e2];
  return { format: e2, quality: a$2v(i2 != null ? i2 : o2, 0, 100) };
}
function w$f(t2, h2) {
  return h2 / Math.max(t2[0], t2[1]);
}
function m$L(t2, h2, i2, e2 = 0, o2 = 0, n2 = t2.width - e2, a2 = t2.height - o2, r2 = false) {
  const { data: l2 } = t2, { width: g2, height: f2, data: d2 } = h2, u2 = n2 / g2, c2 = a2 / f2, s2 = Math.ceil(u2 / 2), w2 = Math.ceil(c2 / 2), m2 = t2.width;
  for (let M2 = 0; M2 < f2; M2++)
    for (let t3 = 0; t3 < g2; t3++) {
      const h3 = 4 * (t3 + (r2 ? f2 - M2 - 1 : M2) * g2);
      let n3 = 0, a3 = 0, p2 = 0, y2 = 0, x2 = 0, b2 = 0;
      const j2 = (M2 + 0.5) * c2;
      for (let r3 = Math.floor(M2 * c2); r3 < (M2 + 1) * c2; r3++) {
        const h4 = Math.abs(j2 - (r3 + 0.5)) / w2, g3 = (t3 + 0.5) * u2, f3 = h4 * h4;
        for (let d3 = Math.floor(t3 * u2); d3 < (t3 + 1) * u2; d3++) {
          const t4 = Math.abs(g3 - (d3 + 0.5)) / s2, h5 = Math.sqrt(f3 + t4 * t4);
          if (h5 >= 1)
            continue;
          let u3 = 2 * h5 * h5 * h5 - 3 * h5 * h5 + 1;
          const c3 = 4 * (e2 + d3 + (o2 + r3) * m2);
          b2 += u3 * l2[c3 + 3], a3 += u3, !i2 && l2[c3 + 3] < 255 && (u3 = u3 * l2[c3 + 3] / 255), p2 += u3 * l2[c3], y2 += u3 * l2[c3 + 1], x2 += u3 * l2[c3 + 2], n3 += u3;
        }
      }
      d2[h3] = p2 / n3, d2[h3 + 1] = y2 / n3, d2[h3 + 2] = x2 / n3, d2[h3 + 3] = b2 / a3;
    }
  return h2;
}
function D$a(t2) {
  switch (t2) {
    case "png":
    case "jpg":
    case "jpeg":
      return t2;
    default:
      return k$d;
  }
}
function q$c(t2) {
  t2.save(), t2.globalCompositeOperation = "copy", t2.scale(1, -1), t2.translate(0, -t2.canvas.height), t2.drawImage(t2.canvas, 0, 0), t2.restore();
}
function v$k(t2) {
  const h2 = t2.data, i2 = h2.length;
  for (let e2 = 0; e2 < i2; e2 += 4) {
    const t3 = h2[e2 + 3];
    if (t3 !== 255 && t3 > 0) {
      const i3 = 255 / t3;
      h2[e2 + 0] = h2[e2 + 0] * i3, h2[e2 + 1] = h2[e2 + 1] * i3, h2[e2 + 2] = h2[e2 + 2] * i3;
    }
  }
}
const I$d = { png: "image/png", jpg: "image/jpeg", jpeg: "image/jpeg" }, P$c = 98, k$d = "png", B$a = { png: 100, jpg: P$c, jpeg: P$c };
var r$x;
function o$t(t2, r2, o2 = {}) {
  const l2 = n$B(t2);
  for (; l2.length > 1; ) {
    const t3 = c$E(r2, l2.shift(), o2);
    if (r$1$(t3))
      return t3;
  }
  return i$K(r2, l2.shift(), o2);
}
function n$B(e2) {
  const t2 = has("esri-force-webgl");
  if (t2 === r$x.WEBGL1 || t2 === r$x.WEBGL2)
    return [t2];
  switch (e2) {
    case "2d":
      return has("mac") && has("chrome") ? [r$x.WEBGL1, r$x.WEBGL2] : [r$x.WEBGL2, r$x.WEBGL1];
    case "3d":
      return [r$x.WEBGL2, r$x.WEBGL1];
  }
}
function i$K(e2, r2, o2 = {}) {
  if (!window.WebGLRenderingContext)
    return l$D(e2, a$A), null;
  const n2 = c$E(e2, r2, o2);
  return t$2r(n2) && l$D(e2, s$x), n2;
}
function c$E(e2, t2, o2 = {}) {
  const n2 = t2 === r$x.WEBGL1 ? ["webgl", "experimental-webgl", "webkit-3d", "moz-webgl"] : ["webgl2"];
  let i2 = null;
  for (const r2 of n2) {
    try {
      i2 = e2.getContext(r2, o2);
    } catch (c2) {
    }
    if (i2)
      break;
  }
  return i2;
}
function l$D(e2, t2) {
  const r2 = e2.parentNode;
  r2 && (r2.innerHTML = '<table style="background-color: #8CE; width: 100%; height: 100%;"><tr><td align="center"><div style="display: table-cell; vertical-align: middle;"><div style="">' + t2 + "</div></div></td></tr></table>");
}
!function(e2) {
  e2[e2.WEBGL1 = 1] = "WEBGL1", e2[e2.WEBGL2 = 2] = "WEBGL2";
}(r$x || (r$x = {}));
const a$A = 'This page requires a browser that supports WebGL.<br/><a href="http://get.webgl.org">Click here to upgrade your browser.</a>', s$x = `It doesn't appear your computer can support WebGL.<br/><a href="http://get.webgl.org/troubleshooting/">Click here for more information.</a>`;
let n$A, a$z;
function l$C(t2) {
  const e2 = n$B(t2);
  for (; e2.length > 1; ) {
    const t3 = u$q(e2.shift());
    if (t3.available)
      return t3;
  }
  return u$q(e2.shift());
}
function u$q(t2) {
  switch (t2) {
    case r$x.WEBGL1:
      return i$J();
    case r$x.WEBGL2:
      return f$q();
  }
}
function i$J() {
  return n$A || (n$A = d$m()), n$A;
}
function f$q() {
  return a$z || (a$z = x$h()), a$z;
}
class p$M {
  constructor() {
    this.available = false, this.majorPerformanceCaveat = false, this.maxTextureSize = 0, this.supportsVertexShaderSamplers = false, this.supportsHighPrecisionFragment = false, this.supportsElementIndexUint = false, this.supportsStandardDerivatives = false, this.supportsInstancedArrays = false, this.supportsTextureFloat = false, this.supportsTextureHalfFloat = false, this.supportsColorBufferFloat = false, this.supportsColorBufferFloatBlend = false, this.supportsColorBufferHalfFloat = false;
  }
}
class c$D extends p$M {
  constructor() {
    super(...arguments), this.type = r$x.WEBGL1;
  }
}
class E$j extends p$M {
  constructor() {
    super(...arguments), this.type = r$x.WEBGL2, this.supportsElementIndexUint = true, this.supportsStandardDerivatives = true, this.supportsInstancedArrays = true, this.supportsTextureFloat = true, this.supportsTextureHalfFloat = true;
  }
}
function _$f(r2, n2) {
  var _a2;
  if (r2 === r$x.WEBGL1 && typeof WebGLRenderingContext == "undefined" || r2 === r$x.WEBGL2 && typeof WebGL2RenderingContext == "undefined")
    return null;
  const a2 = document.createElement("canvas");
  if (!a2)
    return null;
  let l2 = c$E(a2, r2, { failIfMajorPerformanceCaveat: true });
  if (t$2r(l2) && (l2 = c$E(a2, r2), r$1$(l2) && (n2.majorPerformanceCaveat = true)), t$2r(l2))
    return l2;
  if (r2 === r$x.WEBGL1) {
    const t2 = (_a2 = l2.getParameter(l2.VERSION)) == null ? void 0 : _a2.match(/^WebGL\s+([\d.]*)/);
    if (t2) {
      const e2 = parseFloat(t2[1]);
      n2.available = e2 >= 0.94;
    }
  } else
    n2.available = true;
  n2.maxTextureSize = l2.getParameter(l2.MAX_TEXTURE_SIZE), n2.supportsVertexShaderSamplers = l2.getParameter(l2.MAX_VERTEX_TEXTURE_IMAGE_UNITS) > 0;
  const u2 = l2.getShaderPrecisionFormat(l2.FRAGMENT_SHADER, l2.HIGH_FLOAT);
  return u2 && (n2.supportsHighPrecisionFragment = u2.precision > 0), l2;
}
function d$m() {
  const e2 = new c$D(), r2 = _$f(r$x.WEBGL1, e2);
  return t$2r(r2) || (e2.supportsElementIndexUint = r2.getExtension("OES_element_index_uint") !== null, e2.supportsStandardDerivatives = r2.getExtension("OES_standard_derivatives") !== null, e2.supportsInstancedArrays = r2.getExtension("ANGLE_instanced_arrays") !== null, e2.supportsTextureFloat = r2.getExtension("OES_texture_float") !== null, e2.supportsTextureHalfFloat = r2.getExtension("OES_texture_half_float") !== null, e2.supportsColorBufferFloat = r2.getExtension("WEBGL_color_buffer_float") !== null, e2.supportsColorBufferFloatBlend = r2.getExtension("EXT_float_blend") !== null, e2.supportsColorBufferHalfFloat = r2.getExtension("EXT_color_buffer_half_float") !== null), e2;
}
function x$h() {
  const e2 = new E$j(), r2 = _$f(r$x.WEBGL2, e2);
  return t$2r(r2) || (e2.supportsColorBufferFloat = r2.getExtension("EXT_color_buffer_float") !== null, e2.supportsColorBufferFloatBlend = r2.getExtension("EXT_float_blend") !== null, e2.supportsColorBufferHalfFloat = e2.supportsColorBufferFloat || r2.getExtension("EXT_color_buffer_half_float") !== null), e2;
}
function i$I(i2) {
  const s2 = l$C(i2);
  if (!s2.available)
    return new s$2u("webgl:required", "WebGL is required but not supported.");
  if (i2 === "3d" && s2.majorPerformanceCaveat)
    return new s$2u("webgl:major-performance-caveat-detected", "Your WebGL implementation doesn't seem to support hardware accelerated rendering. Check your browser settings or if your GPU is in a blocklist.");
  if (!s2.supportsHighPrecisionFragment)
    return new s$2u("webgl:high-precision-fragment-required", "WebGL support for high precision fragment shaders is required but not supported.");
  if (!s2.supportsVertexShaderSamplers)
    return new s$2u("webgl:vertex-shader-samplers-required", "WebGL support for vertex shader samplers is required but not supported.");
  if (s2.type === r$x.WEBGL1) {
    if (!s2.supportsElementIndexUint)
      return new s$2u("webgl:element-index-uint-required", "WebGL support for uint vertex indices is required but not supported.");
    if (!s2.supportsStandardDerivatives)
      return new s$2u("webgl:standard-derivatives-required", "WebGL support for standard derivatives is required but not supported.");
    if (!s2.supportsInstancedArrays)
      return new s$2u("webgl:instanced-arrays-required", "WebGL support for instanced rendering is required but not supported.");
  }
  return null;
}
function i$H(t2) {
  return t2 && "nodeType" in t2;
}
function d$l(t2) {
  return t2 && typeof t2.render == "function";
}
const c$C = { component: "esri-component" };
let p$L = class extends m$2q {
  constructor() {
    super(...arguments), this.widget = null;
  }
  destroy() {
    this.widget && this.widget.destroy(), this.node = null;
  }
  get id() {
    return this.get("widget.id") || this.get("node.id");
  }
  set node(t2) {
    const e2 = this._get("node");
    t2 !== e2 && (t2 && t2.classList.add(c$C.component), e2 && e2.classList.remove(c$C.component), this._set("node", t2));
  }
  castNode(t2) {
    return t2 ? typeof t2 == "string" || i$H(t2) ? (this._set("widget", null), e$1p(t2)) : (d$l(t2) && !t2.domNode && (t2.domNode = document.createElement("div")), this._set("widget", t2), t2.domNode) : (this._set("widget", null), null);
  }
};
e$2g([y$1I({ dependsOn: [] })], p$L.prototype, "id", null), e$2g([y$1I()], p$L.prototype, "node", null), e$2g([s$2i("node")], p$L.prototype, "castNode", null), e$2g([y$1I({ readOnly: true })], p$L.prototype, "widget", void 0), p$L = e$2g([n$2P("esri.views.ui.Component")], p$L);
const l$B = p$L;
const m$K = { left: 0, top: 0, bottom: 0, right: 0 }, u$p = { bottom: 30, top: 15, right: 15, left: 15 }, f$p = "manual", _$e = { ui: "esri-ui", corner: "esri-ui-corner", innerContainer: "esri-ui-inner-container", manualContainer: "esri-ui-manual-container", cornerContainer: "esri-ui-corner-container", topLeft: "esri-ui-top-left", topRight: "esri-ui-top-right", bottomLeft: "esri-ui-bottom-left", bottomRight: "esri-ui-bottom-right" };
function g$j(t2) {
  return t2 && !t2._started && typeof t2.postMixInProperties == "function" && typeof t2.buildRendering == "function" && typeof t2.postCreate == "function" && typeof t2.startup == "function";
}
function y$i(t2) {
  const o2 = t2, i2 = typeof o2 == "object" && o2 !== null && Object.getPrototypeOf(o2);
  return (i2 === null || i2 === Object.prototype) && ("component" in o2 || "index" in o2 || "position" in o2) ? t2 : null;
}
function C$e(t2, { top: o2, bottom: i2, left: e2, right: n2 }) {
  t2.style.top = o2, t2.style.bottom = i2, t2.style.left = e2, t2.style.right = n2;
}
let v$j = class extends n$2G.EventedAccessor {
  constructor(t2) {
    super(t2), this._cornerNameToContainerLookup = {}, this._positionNameToContainerLookup = {}, this._components = new Array(), this._componentToKey = new Map(), this._handles = new t$2g(), this.view = null, this._applyViewPadding = () => {
      const t3 = this.container;
      t3 && C$e(t3, this._toPxPosition(this._getViewPadding()));
    }, this._applyUIPadding = () => {
      const t3 = this._innerContainer;
      t3 && C$e(t3, this._toPxPosition(this.padding));
    }, this._initContainers();
  }
  initialize() {
    this._handles.add([l$1P(() => {
      var _a2;
      return [(_a2 = this.view) == null ? void 0 : _a2.padding, this.container];
    }, this._applyViewPadding, h$1j), l$1P(() => this.padding, this._applyUIPadding, h$1j)]);
  }
  destroy() {
    this.container = null;
    for (const t2 of this._components)
      t2.destroy();
    this._components.length = 0, this._handles.destroy(), this._componentToKey.clear();
  }
  set container(t2) {
    const i2 = this._get("container");
    t2 !== i2 && (t2 && (t2.classList.add(_$e.ui), n$1R(t2), this._attachContainers(t2)), i2 && (i2.classList.remove(_$e.ui), C$e(i2, { top: "", bottom: "", left: "", right: "" }), t$1y(i2)), this._set("container", t2));
  }
  get height() {
    const t2 = this.get("view.height") || 0;
    if (t2 === 0)
      return t2;
    const o2 = this._getViewPadding(), i2 = o2.top + o2.bottom;
    return Math.max(t2 - i2, 0);
  }
  get padding() {
    return this._get("padding");
  }
  set padding(t2) {
    this._overrideIfSome("padding", t2);
  }
  castPadding(t2) {
    return typeof t2 == "number" ? { bottom: t2, top: t2, right: t2, left: t2 } : __spreadValues(__spreadValues({}, u$p), t2);
  }
  get width() {
    const t2 = this.get("view.width") || 0;
    if (t2 === 0)
      return t2;
    const o2 = this._getViewPadding(), i2 = o2.left + o2.right;
    return Math.max(t2 - i2, 0);
  }
  add(t2, o2) {
    let i2, e2;
    if (Array.isArray(t2))
      return void t2.forEach((t3) => this.add(t3, o2));
    const n2 = y$i(t2);
    n2 && ({ index: i2, position: o2, component: t2, key: e2 } = n2), o2 && typeof o2 == "object" && ({ index: i2, key: e2, position: o2 } = o2), !t2 || o2 && !this._isValidPosition(o2) || this._add(t2, o2, i2, e2);
  }
  remove(t2, o2) {
    if (!t2)
      return;
    if (Array.isArray(t2))
      return t2.map((t3) => this.remove(t3, o2));
    const i2 = this._find(t2);
    if (i2) {
      const e2 = this._componentToKey;
      if (e2.has(t2) && e2.get(t2) !== o2)
        return;
      const n2 = this._components.indexOf(i2);
      return i2.node.parentNode && i2.node.parentNode.removeChild(i2.node), this._componentToKey.delete(t2), this._components.splice(n2, 1)[0];
    }
  }
  empty(t2) {
    if (Array.isArray(t2))
      return t2.map((t3) => this.empty(t3)).reduce((t3, o2) => t3.concat(o2));
    if ((t2 = t2 || f$p) === f$p) {
      return Array.prototype.slice.call(this._manualContainer.children).filter((t3) => !t3.classList.contains(_$e.corner)).map((t3) => this.remove(t3));
    }
    return this._isValidPosition(t2) ? Array.prototype.slice.call(this._cornerNameToContainerLookup[t2].children).map(this.remove, this) : null;
  }
  move(t2, o2) {
    if (Array.isArray(t2) && t2.forEach((t3) => this.move(t3, o2)), !t2)
      return;
    let i2;
    const e2 = y$i(t2) || y$i(o2);
    if (e2 && (i2 = e2.index, o2 = e2.position, t2 = e2.component || t2), o2 && !this._isValidPosition(o2))
      return;
    const n2 = this.remove(t2);
    n2 && this.add(n2, { position: o2, index: i2 });
  }
  find(t2) {
    if (!t2)
      return null;
    const o2 = this._findById(t2);
    return o2 && (o2.widget || o2.node);
  }
  getPosition(t2) {
    for (const o2 in this._positionNameToContainerLookup) {
      if (this._positionNameToContainerLookup[o2].contains(t2))
        return o2;
    }
    return null;
  }
  _add(t2, o2, i2, e2) {
    t2 instanceof l$B || (t2 = new l$B({ node: t2 })), this._place({ component: t2, position: o2, index: i2 }), this._components.push(t2), e2 && this._componentToKey.set(t2, e2);
  }
  _find(t2) {
    return t2 ? t2 instanceof l$B ? this._findByComponent(t2) : typeof t2 == "string" ? this._findById(t2) : this._findByNode(t2.domNode || t2) : null;
  }
  _getViewPadding() {
    return this.get("view.padding") || m$K;
  }
  _attachContainers(t2) {
    t2.appendChild(this._innerContainer), t2.appendChild(this._manualContainer);
  }
  _initContainers() {
    const t2 = document.createElement("div");
    t2.classList.add(_$e.innerContainer), t2.classList.add(_$e.cornerContainer);
    const o2 = document.createElement("div");
    o2.classList.add(_$e.innerContainer), o2.classList.add(_$e.manualContainer);
    const i2 = document.createElement("div");
    i2.classList.add(_$e.topLeft), i2.classList.add(_$e.corner), t2.appendChild(i2);
    const e2 = document.createElement("div");
    e2.classList.add(_$e.topRight), e2.classList.add(_$e.corner), t2.appendChild(e2);
    const n2 = document.createElement("div");
    n2.classList.add(_$e.bottomLeft), n2.classList.add(_$e.corner), t2.appendChild(n2);
    const r2 = document.createElement("div");
    r2.classList.add(_$e.bottomRight), r2.classList.add(_$e.corner), t2.appendChild(r2), this._innerContainer = t2, this._manualContainer = o2;
    const s2 = f$1g();
    this._cornerNameToContainerLookup = { "top-left": i2, "top-right": e2, "bottom-left": n2, "bottom-right": r2, "top-leading": s2 ? e2 : i2, "top-trailing": s2 ? i2 : e2, "bottom-leading": s2 ? r2 : n2, "bottom-trailing": s2 ? n2 : r2 }, this._positionNameToContainerLookup = __spreadValues({ manual: o2 }, this._cornerNameToContainerLookup);
  }
  _isValidPosition(t2) {
    return !!this._positionNameToContainerLookup[t2];
  }
  _place(t2) {
    const o2 = t2.component, e2 = t2.position || f$p, n2 = t2.index, r2 = this._positionNameToContainerLookup[e2], s2 = n2 > -1;
    if (g$j(o2.widget) && o2.widget.startup(), !s2)
      return void r2.appendChild(o2.node);
    const a2 = Array.prototype.slice.call(r2.children);
    if (n2 === 0)
      return void (r2.firstChild ? o$1x(o2.node, r2.firstChild) : r2.appendChild(o2.node));
    n2 >= a2.length ? r2.appendChild(o2.node) : o$1x(o2.node, a2[n2]);
  }
  _toPxPosition(t2) {
    return { top: this._toPxUnit(t2.top), left: this._toPxUnit(t2.left), right: this._toPxUnit(t2.right), bottom: this._toPxUnit(t2.bottom) };
  }
  _toPxUnit(t2) {
    return t2 === 0 ? "0" : t2 + "px";
  }
  _findByComponent(t2) {
    let o2, i2 = null;
    return this._components.some((e2) => (o2 = e2 === t2, o2 && (i2 = e2), o2)), i2;
  }
  _findById(t2) {
    let o2, i2 = null;
    return this._components.some((e2) => (o2 = e2.id === t2, o2 && (i2 = e2), o2)), i2;
  }
  _findByNode(t2) {
    let o2, i2 = null;
    return this._components.some((e2) => (o2 = e2.node === t2, o2 && (i2 = e2), o2)), i2;
  }
};
e$2g([y$1I()], v$j.prototype, "container", null), e$2g([y$1I()], v$j.prototype, "height", null), e$2g([y$1I({ value: u$p })], v$j.prototype, "padding", null), e$2g([s$2i("padding")], v$j.prototype, "castPadding", null), e$2g([y$1I()], v$j.prototype, "view", void 0), e$2g([y$1I()], v$j.prototype, "width", null), v$j = e$2g([n$2P("esri.views.ui.UI")], v$j);
const L$8 = v$j;
function p$K(t2, e2) {
  return t2 && "copyright" in t2 && (!e2 || typeof t2.originOf == "function" && t2.originOf("copyright") === "user");
}
function m$J(t2, e2) {
  return t2.length !== e2.length || t2.some((t3, i2) => t3.text !== e2[i2].text);
}
function f$o(t2, e2, i2) {
  if (!i2 || !e2)
    return;
  t2.find((t3) => t3.layerView === e2 && t3.text === i2) || t2.push({ text: i2, layerView: e2 });
}
function y$h(t2) {
  return t2.type === "bing-maps";
}
const b$h = [];
let g$i = class extends d$18 {
  constructor(t2) {
    super(t2), this._clear = () => {
      this._fetchedAttributionData.clear(), this._pendingAttributions.clear(), this.handles.remove("suspension"), this.notifyChange("state");
    }, this._pendingAttributions = new Set(), this._fetchedAttributionData = new Map(), this.items = new j$V(), this.view = null, this._allLayerViewsChange = (t3) => {
      this.handles.remove("suspension");
      const e2 = this.get("view.allLayerViews");
      e2 && this.handles.add(e2.map((t4) => l$1P(() => {
        var _a2;
        return [t4.suspended, (_a2 = t4.layer) == null ? void 0 : _a2.attributionVisible];
      }, () => this._updateAttributionItems())), "suspension"), t3 && t3.removed && t3.removed.forEach((t4) => {
        this._pendingAttributions.delete(t4), this._fetchedAttributionData.delete(t4);
      }), this._updateAttributionItems();
    }, this.handles.add([a$2a(() => {
      var _a2;
      return (_a2 = this.view) == null ? void 0 : _a2.allLayerViews;
    }, "change", (t3) => this._allLayerViewsChange(t3), { onListenerAdd: () => this._allLayerViewsChange(), onListenerRemove: this._clear }), f$1o(() => {
      var _a2;
      return ((_a2 = this.view) == null ? void 0 : _a2.stationary) === true;
    }, () => this._updateAttributionItems())]);
  }
  destroy() {
    this.view = null, this._fetchedAttributionData.clear(), this._pendingAttributions.clear(), this.items.removeAll();
  }
  get state() {
    return this.get("view.ready") ? this._pendingAttributions.size > 0 ? "loading" : "ready" : "disabled";
  }
  _updateAttributionItems() {
    const t2 = this.get("view.allLayerViews");
    b$h.length = 0, t2 ? (t2.forEach((t3) => {
      var _a2;
      if (t3.suspended || !((_a2 = t3.layer) == null ? void 0 : _a2.attributionVisible))
        return;
      const e2 = t3.layer;
      if (p$K(e2, "user"))
        return void f$o(b$h, t3, e2.copyright);
      if (e2.hasAttributionData) {
        if (this._fetchedAttributionData.has(t3)) {
          const i3 = this._fetchedAttributionData.get(t3);
          return void (i3 ? f$o(b$h, t3, this._getDynamicAttribution(i3, this.view, e2)) : p$K(e2) && f$o(b$h, t3, e2.copyright));
        }
        return void this._fetchAttributionData(t3);
      }
      const i2 = e2.get("portalItem.accessInformation");
      f$o(b$h, t3, i2 || e2.copyright);
    }), m$J(this.items, b$h) && (this.items.removeAll(), this.items.addMany(b$h)), b$h.length = 0, this.notifyChange("state")) : this._clear();
  }
  async _fetchAttributionData(t2) {
    if (this._pendingAttributions.has(t2))
      return;
    this._pendingAttributions.add(t2);
    const i2 = await b$N(t2.layer.fetchAttributionData());
    if (this._pendingAttributions.has(t2)) {
      const e2 = i2.ok ? this._createContributionIndex(i2.value, y$h(t2.layer)) : null;
      this._pendingAttributions.delete(t2), this._fetchedAttributionData.set(t2, e2);
    }
    this._updateAttributionItems();
  }
  _createContributionIndex(t2, e2) {
    const i2 = t2.contributors, r2 = {};
    if (!i2)
      return r2;
    for (let s2 = 0; s2 < i2.length; s2++) {
      const t3 = i2[s2], o2 = t3.coverageAreas;
      if (!o2)
        return;
      for (const i3 of o2) {
        const o3 = i3.bbox, n2 = i3.zoomMin - (e2 && i3.zoomMin ? 1 : 0), a2 = i3.zoomMax - (e2 && i3.zoomMax ? 1 : 0), c2 = { xmin: o3[1], ymin: o3[0], xmax: o3[3], ymax: o3[2], spatialReference: k$C.WGS84 }, u2 = { extent: R$A(c2), attribution: t3.attribution || "", score: i3.score != null ? i3.score : 100, id: s2 };
        for (let t4 = n2; t4 <= a2; t4++)
          r2[t4] = r2[t4] || [], r2[t4].push(u2);
      }
    }
    return r2.maxKey = Math.max.apply(null, Object.keys(r2)), r2;
  }
  _getDynamicAttribution(t2, e2, i2) {
    const { extent: r2, scale: s2 } = e2;
    let o2 = i2.tileInfo.scaleToZoom(s2);
    if (o2 = Math.min(t2.maxKey, Math.round(o2)), !r2 || o2 == null || o2 <= -1)
      return "";
    const n2 = t2[o2], a2 = M$L(r2.center.clone().normalize(), e2.spatialReference), c2 = {};
    return n2 ? n2.filter((t3) => {
      const e3 = !c2[t3.id] && a2 && r$1M(t3.extent, a2);
      return e3 && (c2[t3.id] = true), e3;
    }).sort((t3, e3) => e3.score - t3.score || t3.objectId - e3.objectId).map((t3) => t3.attribution).join(", ") : "";
  }
};
e$2g([y$1I({ readOnly: true, type: j$V })], g$i.prototype, "items", void 0), e$2g([y$1I({ readOnly: true })], g$i.prototype, "state", null), e$2g([y$1I()], g$i.prototype, "view", void 0), g$i = e$2g([n$2P("esri.widgets.Attribution.AttributionViewModel")], g$i);
const _$d = g$i;
const l$A = { base: "esri-attribution esri-widget", poweredBy: "esri-attribution__powered-by", sources: "esri-attribution__sources", open: "esri-attribution--open", sourcesOpen: "esri-attribution__sources--open", link: "esri-attribution__link", widgetIcon: "esri-icon-description", interactive: "esri-interactive" };
let p$J = class extends M$u {
  constructor(e2, t2) {
    super(e2, t2), this._isOpen = false, this._attributionTextOverflowed = false, this._prevSourceNodeHeight = 0, this._resizeObserver = new ResizeObserver((e3) => e3.forEach(({ target: e4 }) => this._checkSourceTextOverflow(e4))), this.iconClass = l$A.widgetIcon, this.itemDelimiter = " | ", this.messages = null, this.viewModel = new _$d();
  }
  initialize() {
    this.addHandles(a$2a(() => {
      var _a2;
      return (_a2 = this.viewModel) == null ? void 0 : _a2.items;
    }, "change", () => this.scheduleRender()));
  }
  destroy() {
    var _a2;
    (_a2 = this._resizeObserver) == null ? void 0 : _a2.disconnect();
  }
  get _isInteractive() {
    return this._isOpen || this._attributionTextOverflowed;
  }
  get attributionText() {
    return this.viewModel.items.reduce((e2, t2) => (e2.includes(t2.text) || e2.push(t2.text), e2), []).join(this.itemDelimiter);
  }
  get label() {
    var _a2, _b2;
    return (_b2 = (_a2 = this.messages) == null ? void 0 : _a2.widgetLabel) != null ? _b2 : "";
  }
  set label(e2) {
    this._overrideIfSome("label", e2);
  }
  get view() {
    return this.viewModel.view;
  }
  set view(e2) {
    this.viewModel.view = e2;
  }
  render() {
    const e2 = { [l$A.open]: this._isOpen };
    return n$1U("div", { bind: this, class: this.classes(l$A.base, e2), dir: "ltr", onclick: this._toggleState, onkeydown: this._toggleState }, this.renderSourcesNode(), this.renderPoweredBy());
  }
  renderPoweredBy() {
    return n$1U("div", { class: l$A.poweredBy }, "Powered by", " ", n$1U("a", { class: l$A.link, href: "http://www.esri.com/", target: "_blank", rel: "noreferrer" }, "Esri"));
  }
  renderSourcesNode() {
    const e2 = this._isOpen, t2 = this._isInteractive, i2 = t2 ? "0" : "", { attributionText: r2 } = this, s2 = { [l$A.sourcesOpen]: e2, [l$A.interactive]: t2 };
    return n$1U("div", { afterCreate: this._afterSourcesNodeCreate, bind: this, class: this.classes(l$A.sources, s2), innerHTML: r2, tabindex: i2 });
  }
  _afterSourcesNodeCreate(e2) {
    this._prevSourceNodeHeight = e2.clientWidth, this._resizeObserver.observe(e2);
  }
  _checkSourceTextOverflow(e2) {
    let t2 = false;
    const { clientHeight: i2, clientWidth: r2, scrollWidth: s2 } = e2, o2 = s2 > r2, n2 = this._attributionTextOverflowed !== o2;
    if (this._attributionTextOverflowed = o2, n2 && (t2 = true), this._isOpen) {
      const e3 = i2 < this._prevSourceNodeHeight;
      this._prevSourceNodeHeight = i2, e3 && (this._isOpen = false, t2 = true);
    }
    t2 && this.scheduleRender();
  }
  _toggleState() {
    this._isInteractive && (this._isOpen = !this._isOpen);
  }
};
e$2g([y$1I()], p$J.prototype, "_isOpen", void 0), e$2g([y$1I()], p$J.prototype, "_isInteractive", null), e$2g([y$1I()], p$J.prototype, "_attributionTextOverflowed", void 0), e$2g([y$1I()], p$J.prototype, "_prevSourceNodeHeight", void 0), e$2g([y$1I({ readOnly: true, dependsOn: ["viewModel.items.length", "itemDelimiter"] })], p$J.prototype, "attributionText", null), e$2g([y$1I()], p$J.prototype, "iconClass", void 0), e$2g([y$1I()], p$J.prototype, "itemDelimiter", void 0), e$2g([y$1I()], p$J.prototype, "label", null), e$2g([y$1I(), e$1g("esri/widgets/Attribution/t9n/Attribution")], p$J.prototype, "messages", void 0), e$2g([y$1I()], p$J.prototype, "view", null), e$2g([y$1I({ type: _$d })], p$J.prototype, "viewModel", void 0), e$2g([t$1p()], p$J.prototype, "_toggleState", null), p$J = e$2g([n$2P("esri.widgets.Attribution")], p$J);
const a$y = p$J;
const p$I = "esri.widgets.CompassViewModel";
let d$k = class extends e$D(m$2q) {
  constructor(t2) {
    super(t2), this._handles = new t$2g(), this.orientation = { x: 0, y: 0, z: 0 }, this.view = null, this._updateForCamera = this._updateForCamera.bind(this), this._updateForRotation = this._updateForRotation.bind(this), this._updateRotationWatcher = this._updateRotationWatcher.bind(this);
  }
  initialize() {
    this._handles.add(l$1P(() => this.view, this._updateRotationWatcher, h$1j));
  }
  destroy() {
    this._handles = h$1W(this._handles), this.view = null;
  }
  get canShowNorth() {
    const t2 = this.get("view.spatialReference");
    return !(!t2 || !t2.isWebMercator && !t2.isGeographic);
  }
  get state() {
    return this.get("view.ready") ? this.canShowNorth ? "compass" : "rotation" : "disabled";
  }
  reset() {
    if (!this.get("view.ready"))
      return;
    const t2 = {};
    this.view.type === "2d" ? t2.rotation = 0 : t2.heading = 0, this.callGoTo({ target: t2 });
  }
  _updateForRotation(t2) {
    t2 != null && (this.orientation = { z: t2 });
  }
  _updateForCamera(t2) {
    if (!t2)
      return;
    const o2 = -t2.heading;
    this.orientation = { x: 0, y: 0, z: o2 };
  }
  _updateRotationWatcher(t2) {
    this._handles.removeAll(), t2 && this._handles.add(t2.type === "2d" ? l$1P(() => t2 == null ? void 0 : t2.rotation, this._updateForRotation, h$1j) : l$1P(() => t2 == null ? void 0 : t2.camera, this._updateForCamera, h$1j));
  }
};
e$2g([y$1I({ readOnly: true })], d$k.prototype, "canShowNorth", null), e$2g([y$1I()], d$k.prototype, "orientation", void 0), e$2g([y$1I({ readOnly: true })], d$k.prototype, "state", null), e$2g([y$1I()], d$k.prototype, "view", void 0), d$k = e$2g([n$2P(p$I)], d$k);
const c$B = d$k;
const l$z = { base: "esri-compass esri-widget--button esri-widget", text: "esri-icon-font-fallback-text", icon: "esri-compass__icon", rotationIcon: "esri-icon-dial", northIcon: "esri-icon-compass", widgetIcon: "esri-icon-locate-circled", interactive: "esri-interactive", disabled: "esri-disabled" };
let c$A = class extends M$u {
  constructor(e2, s2) {
    super(e2, s2), this.iconClass = l$z.widgetIcon, this.messages = null, this.viewModel = new c$B();
  }
  get goToOverride() {
    return this.viewModel.goToOverride;
  }
  set goToOverride(e2) {
    this.viewModel.goToOverride = e2;
  }
  get label() {
    var _a2, _b2;
    return (_b2 = (_a2 = this.messages) == null ? void 0 : _a2.widgetLabel) != null ? _b2 : "";
  }
  set label(e2) {
    this._overrideIfSome("label", e2);
  }
  get view() {
    return this.viewModel.view;
  }
  set view(e2) {
    this.viewModel.view = e2;
  }
  reset() {
    return this.viewModel.reset();
  }
  render() {
    const { orientation: e2, state: s2 } = this.viewModel, t2 = s2 === "disabled", o2 = (s2 === "rotation" ? "rotation" : "compass") === "compass", r2 = t2 ? -1 : 0, i2 = { [l$z.disabled]: t2, [l$z.interactive]: !t2 }, a2 = { [l$z.northIcon]: o2, [l$z.rotationIcon]: !o2 }, { messages: c2 } = this;
    return n$1U("div", { bind: this, class: this.classes(l$z.base, i2), onclick: this._reset, onkeydown: this._reset, role: "button", tabIndex: r2, "aria-label": c2.reset, title: c2.reset }, n$1U("span", { "aria-hidden": "true", class: this.classes(l$z.icon, a2), styles: this._toRotationTransform(e2) }), n$1U("span", { class: l$z.text }, c2.reset));
  }
  _reset() {
    this.viewModel.reset();
  }
  _toRotationTransform(e2) {
    return { transform: `rotateZ(${e2.z}deg)` };
  }
};
e$2g([y$1I()], c$A.prototype, "goToOverride", null), e$2g([y$1I()], c$A.prototype, "iconClass", void 0), e$2g([y$1I()], c$A.prototype, "label", null), e$2g([y$1I(), e$1g("esri/widgets/Compass/t9n/Compass")], c$A.prototype, "messages", void 0), e$2g([y$1I()], c$A.prototype, "view", null), e$2g([y$1I({ type: c$B })], c$A.prototype, "viewModel", void 0), e$2g([t$1p()], c$A.prototype, "_reset", null), c$A = e$2g([n$2P("esri.widgets.Compass")], c$A);
const p$H = c$A;
let r$w = class extends m$2q {
  constructor(t2) {
    super(t2), this.navigationMode = "pan", this.view = null;
  }
  initialize() {
    this.own(f$1o(() => {
      var _a2;
      return (_a2 = this.view) == null ? void 0 : _a2.inputManager;
    }, () => this._setNavigationMode()));
  }
  destroy() {
    this.view = null;
  }
  get state() {
    return this.get("view.ready") && this.view.type === "3d" ? "ready" : "disabled";
  }
  toggle() {
    this.state !== "disabled" && (this.navigationMode = this.navigationMode !== "pan" ? "pan" : "rotate", this._setNavigationMode());
  }
  _setNavigationMode() {
    this.get("view.inputManager").primaryDragAction = this.navigationMode === "pan" ? "pan" : "rotate";
  }
};
e$2g([y$1I({ readOnly: true })], r$w.prototype, "state", null), e$2g([y$1I()], r$w.prototype, "navigationMode", void 0), e$2g([y$1I()], r$w.prototype, "view", void 0), r$w = e$2g([n$2P("esri.widgets.NavigationToggleViewModel")], r$w);
const a$x = r$w;
const l$y = { base: "esri-navigation-toggle esri-widget", button: "esri-navigation-toggle__button esri-widget--button", activeButton: "esri-navigation-toggle__button--active", panButton: "esri-navigation-toggle__button--pan", rotateButton: "esri-navigation-toggle__button--rotate", isLayoutHorizontal: "esri-navigation-toggle--horizontal", rotationIcon: "esri-icon-rotate", panIcon: "esri-icon-pan", widgetIcon: "esri-icon-pan2", disabled: "esri-disabled" };
let g$h = class extends M$u {
  constructor(t2, o2) {
    super(t2, o2), this.iconClass = l$y.widgetIcon, this.messages = null, this.viewModel = new a$x();
  }
  get label() {
    var _a2, _b2;
    return (_b2 = (_a2 = this.messages) == null ? void 0 : _a2.widgetLabel) != null ? _b2 : "";
  }
  set label(t2) {
    this._overrideIfSome("label", t2);
  }
  set layout(t2) {
    t2 !== "horizontal" && (t2 = "vertical"), this._set("layout", t2);
  }
  get view() {
    return this.viewModel.view;
  }
  set view(t2) {
    this.viewModel.view = t2;
  }
  toggle() {
    return this.viewModel.toggle();
  }
  render() {
    const t2 = this.get("viewModel.state") === "disabled", o2 = this.get("viewModel.navigationMode") === "pan", e2 = { [l$y.disabled]: t2, [l$y.isLayoutHorizontal]: this.layout === "horizontal" }, s2 = { [l$y.activeButton]: o2 }, i2 = { [l$y.activeButton]: !o2 }, a2 = t2 ? -1 : 0, r2 = this.messages.toggle;
    return n$1U("div", { bind: this, class: this.classes(l$y.base, e2), onclick: this._toggle, onkeydown: this._toggle, tabIndex: a2, "aria-label": r2, title: r2 }, n$1U("div", { class: this.classes(l$y.button, l$y.panButton, s2) }, n$1U("span", { class: l$y.panIcon })), n$1U("div", { class: this.classes(l$y.button, l$y.rotateButton, i2) }, n$1U("span", { class: l$y.rotationIcon })));
  }
  _toggle() {
    this.toggle();
  }
};
e$2g([y$1I()], g$h.prototype, "iconClass", void 0), e$2g([y$1I()], g$h.prototype, "label", null), e$2g([y$1I({ value: "vertical" })], g$h.prototype, "layout", null), e$2g([y$1I(), e$1g("esri/widgets/NavigationToggle/t9n/NavigationToggle")], g$h.prototype, "messages", void 0), e$2g([y$1I()], g$h.prototype, "view", null), e$2g([y$1I({ type: a$x })], g$h.prototype, "viewModel", void 0), e$2g([t$1p()], g$h.prototype, "_toggle", null), g$h = e$2g([n$2P("esri.widgets.NavigationToggle")], g$h);
const p$G = g$h;
const c$z = { button: "esri-widget--button esri-widget", disabled: "esri-disabled", interactive: "esri-interactive", iconText: "esri-icon-font-fallback-text", icon: "esri-icon" };
let n$z = class extends M$u {
  constructor() {
    super(...arguments), this.enabled = true, this.iconClass = "", this.title = "";
  }
  render() {
    const t2 = this.enabled ? 0 : -1, s2 = { [c$z.disabled]: !this.enabled, [c$z.interactive]: this.enabled }, i2 = { [this.iconClass]: !!this.iconClass };
    return n$1U("div", { bind: this, class: this.classes(c$z.button, s2), onclick: this._triggerAction, onkeydown: this._triggerAction, role: "button", tabIndex: t2, title: this.title }, n$1U("span", { "aria-hidden": "true", role: "presentation", class: this.classes(c$z.icon, i2) }), n$1U("span", { class: c$z.iconText }, this.title));
  }
  _triggerAction() {
    this.action.call(this);
  }
};
e$2g([y$1I()], n$z.prototype, "action", void 0), e$2g([y$1I()], n$z.prototype, "enabled", void 0), e$2g([y$1I()], n$z.prototype, "iconClass", void 0), e$2g([y$1I()], n$z.prototype, "title", void 0), e$2g([t$1p()], n$z.prototype, "_triggerAction", null), n$z = e$2g([n$2P("esri.widgets.IconButton")], n$z);
const a$w = n$z;
let s$w = class extends m$2q {
  get canZoomIn() {
    if (!this.get("view.ready"))
      return false;
    const e2 = this.get("view.animation.target.scale") || this.get("view.scale"), t2 = this.get("view.constraints.effectiveMaxScale");
    return t2 === 0 || e2 > t2;
  }
  get canZoomOut() {
    if (!this.get("view.ready"))
      return false;
    const e2 = this.get("view.animation.target.scale") || this.get("view.scale"), t2 = this.get("view.constraints.effectiveMinScale");
    return t2 === 0 || e2 < t2;
  }
};
e$2g([y$1I({ readOnly: true })], s$w.prototype, "canZoomIn", null), e$2g([y$1I({ readOnly: true })], s$w.prototype, "canZoomOut", null), e$2g([y$1I()], s$w.prototype, "view", void 0), s$w = e$2g([n$2P("esri.widgets.Zoom.ZoomConditions2D")], s$w);
const i$G = s$w;
let t$t = class extends m$2q {
  get canZoomIn() {
    return !!this.view.ready;
  }
  get canZoomOut() {
    return !!this.view.ready;
  }
};
e$2g([y$1I({ readOnly: true })], t$t.prototype, "canZoomIn", null), e$2g([y$1I({ readOnly: true })], t$t.prototype, "canZoomOut", null), e$2g([y$1I()], t$t.prototype, "view", void 0), t$t = e$2g([n$2P("esri.widgets.Zoom.ZoomConditions3D")], t$t);
const c$y = t$t;
let p$F = class extends m$2q {
  constructor(o2) {
    super(o2);
  }
  destroy() {
    this.view = null;
  }
  get canZoomIn() {
    return r$1$(this._zoomConditions) && this._zoomConditions.canZoomIn;
  }
  get canZoomOut() {
    var _a2;
    return r$1$(this._zoomConditions) && ((_a2 = this._zoomConditions) == null ? void 0 : _a2.canZoomOut);
  }
  get state() {
    var _a2;
    return ((_a2 = this.view) == null ? void 0 : _a2.ready) ? "ready" : "disabled";
  }
  set view(o2) {
    o2 ? o2.type === "2d" ? this._zoomConditions = new i$G({ view: o2 }) : o2.type === "3d" && (this._zoomConditions = new c$y({ view: o2 })) : this._zoomConditions = null, this._set("view", o2);
  }
  zoomIn() {
    if (!this.canZoomIn)
      return;
    const o2 = this.view;
    o2.type === "2d" ? o2.mapViewNavigation.zoomIn() : g$1m(o2.goTo({ zoomFactor: 2 }));
  }
  zoomOut() {
    if (!this.canZoomOut)
      return;
    const o2 = this.view;
    o2.type === "2d" ? o2.mapViewNavigation.zoomOut() : g$1m(o2.goTo({ zoomFactor: 0.5 }));
  }
};
e$2g([y$1I()], p$F.prototype, "_zoomConditions", void 0), e$2g([y$1I()], p$F.prototype, "canZoomIn", null), e$2g([y$1I()], p$F.prototype, "canZoomOut", null), e$2g([y$1I({ readOnly: true })], p$F.prototype, "state", null), e$2g([y$1I()], p$F.prototype, "view", null), p$F = e$2g([n$2P("esri.widgets.Zoom.ZoomViewModel")], p$F);
const a$v = p$F;
const u$o = { base: "esri-zoom esri-widget", horizontalLayout: "esri-zoom--horizontal", zoomInIcon: "esri-icon-plus", zoomOutIcon: "esri-icon-minus", widgetIcon: "esri-icon-zoom-in-magnifying-glass" };
let a$u = class extends M$u {
  constructor(o2, t2) {
    super(o2, t2), this.iconClass = u$o.widgetIcon, this.messages = null, this.viewModel = new a$v();
  }
  initialize() {
    this._zoomInButton = new a$w({ action: this.zoomIn.bind(this), iconClass: u$o.zoomInIcon }), this._zoomOutButton = new a$w({ action: this.zoomOut.bind(this), iconClass: u$o.zoomOutIcon });
  }
  destroy() {
    this._zoomInButton = s$2D(this._zoomInButton), this._zoomOutButton = s$2D(this._zoomOutButton);
  }
  get label() {
    var _a2, _b2;
    return (_b2 = (_a2 = this.messages) == null ? void 0 : _a2.widgetLabel) != null ? _b2 : "";
  }
  set label(o2) {
    this._overrideIfSome("label", o2);
  }
  set layout(o2) {
    o2 !== "horizontal" && (o2 = "vertical"), this._set("layout", o2);
  }
  set view(o2) {
    this.viewModel.view = o2;
  }
  get view() {
    return this.viewModel.view;
  }
  render() {
    const o2 = this.viewModel, t2 = { [u$o.horizontalLayout]: this.layout === "horizontal" }, { canZoomIn: s2, canZoomOut: e2 } = o2;
    this._zoomInButton.enabled = s2, this._zoomOutButton.enabled = e2;
    const { zoomIn: i2, zoomOut: r2 } = this.messages;
    return this._zoomInButton.title = i2, this._zoomOutButton.title = r2, n$1U("div", { class: this.classes(u$o.base, t2) }, this._zoomInButton.render(), this._zoomOutButton.render());
  }
  zoomIn() {
    return this.viewModel.zoomIn();
  }
  zoomOut() {
    return this.viewModel.zoomOut();
  }
};
e$2g([y$1I()], a$u.prototype, "iconClass", void 0), e$2g([y$1I()], a$u.prototype, "label", null), e$2g([y$1I({ value: "vertical" })], a$u.prototype, "layout", null), e$2g([y$1I(), e$1g("esri/widgets/Zoom/t9n/Zoom")], a$u.prototype, "messages", void 0), e$2g([y$1I()], a$u.prototype, "view", null), e$2g([y$1I({ type: a$v })], a$u.prototype, "viewModel", void 0), a$u = e$2g([n$2P("esri.widgets.Zoom")], a$u);
const c$x = a$u;
function m$I(t2) {
  return t2 && t2.view !== void 0;
}
let h$s = class extends L$8 {
  constructor(t2) {
    super(t2), this._defaultPositionLookup = { attribution: "manual", compass: "top-left", "navigation-toggle": "top-left", zoom: "top-left" }, this.components = [];
  }
  initialize() {
    this._handles.add([l$1P(() => this.components, this._componentsWatcher.bind(this), h$1j), l$1P(() => this.view, this._updateViewAwareWidgets.bind(this), h$1j)]);
  }
  _add(t2, o2, e2, i2) {
    if (typeof t2 == "string" && this._defaultPositionLookup[t2]) {
      if (this._find(t2))
        return;
      t2 = this._createComponent(t2);
    }
    super._add(t2, o2, e2, i2);
  }
  _removeComponents(t2) {
    t2.forEach((t3) => {
      const o2 = this._find(t3);
      o2 && (this.remove(o2), o2.destroy());
    });
  }
  _updateViewAwareWidgets(t2) {
    this.components.forEach((o2) => {
      const e2 = this._find(o2), i2 = e2 && e2.widget;
      m$I(i2) && (i2.view = t2);
    });
  }
  _componentsWatcher(t2, o2) {
    this._removeComponents(o2), this._addComponents(t2), this._adjustPadding(t2);
  }
  _adjustPadding(t2) {
    if (!t2.includes("attribution") && !this._isOverridden("padding")) {
      const { top: t3 } = this.padding;
      this.padding = t3;
    }
  }
  _addComponents(t2) {
    this.constructed && t2.forEach((t3) => this.add(this._createComponent(t3), this._defaultPositionLookup[t3]));
  }
  _createComponent(t2) {
    const o2 = this._createWidget(t2);
    if (o2)
      return new l$B({ id: t2, node: o2 });
  }
  _createWidget(t2) {
    return t2 === "attribution" ? this._createAttribution() : t2 === "compass" ? this._createCompass() : t2 === "navigation-toggle" ? this._createNavigationToggle() : t2 === "zoom" ? this._createZoom() : void 0;
  }
  _createAttribution() {
    return new a$y({ view: this.view });
  }
  _createCompass() {
    return new p$H({ view: this.view });
  }
  _createNavigationToggle() {
    return new p$G({ view: this.view });
  }
  _createZoom() {
    return new c$x({ view: this.view });
  }
};
e$2g([y$1I()], h$s.prototype, "components", void 0), h$s = e$2g([n$2P("esri.views.ui.DefaultUI")], h$s);
const u$n = h$s;
let e$m = class extends u$n {
  constructor(o2) {
    super(o2), this.components = ["attribution", "zoom"];
  }
};
e$2g([y$1I()], e$m.prototype, "components", void 0), e$m = e$2g([n$2P("esri.views.ui.2d.DefaultUI2D")], e$m);
const p$E = e$m;
var p$D;
let a$t = p$D = class extends l$2B {
  constructor(o2) {
    super(o2), this.color = new l$2e([0, 0, 0, 1]);
  }
  clone() {
    return new p$D(y$1L({ color: this.color }));
  }
};
e$2g([y$1I({ type: l$2e, json: { write: true } })], a$t.prototype, "color", void 0), a$t = p$D = e$2g([n$2P("esri.webmap.background.ColorBackground")], a$t);
const m$H = a$t;
let pe, he, ce$1, de, ue$1, ge;
async function me() {
  const [, { GraphicsView2D: e2, GraphicContainer: t2, LabelManager: i2, MapViewNavigation: s2, MagnifierView2D: r2, Stage: n2 }] = await Promise.all([import("./webglDeps.js"), import("./mapViewDeps.js")]);
  he = e2, ce$1 = t2, de = i2, ue$1 = s2, ge = r2, pe = n2;
}
const ye$1 = 160;
function we(e2) {
  return e2 && e2.declaredClass === "esri.Viewpoint";
}
let fe = class extends w$M(z$k(a$11(z$j))) {
  constructor(e2) {
    super(e2), this._magnifierView = null, this._stage = null, this._resolveWhenReady = [], this.rootLayerViews = new l$1Q({ getCollections: () => {
      var _a2, _b2;
      return [(_a2 = this.basemapView) == null ? void 0 : _a2.baseLayerViews, this.layerViews, (_b2 = this.basemapView) == null ? void 0 : _b2.referenceLayerViews];
    }, getChildrenFunction: () => null }), this.featuresTilingScheme = null, this.fullOpacity = 1, this.graphicsView = null, this.labelManager = null, this.mapViewNavigation = null, this.renderingOptions = { samplingMode: "dynamic", edgeLabelsVisible: true, labelsAnimationTime: 125, labelCollisionsEnabled: true }, this.rendering = false, this.supersampleScreenshotsEnabled = false, this.supportsGround = false, this._stationaryTimer = null, this.frameTask = new s$J(this), this._pePromise = null, this.floors = new j$V(), this.highlightOptions = new c$G(), this.inputManager = new C$f({ view: this }), this.map = null, this.resizeAlign = "center", this.spatialReferenceLocked = false, this.timeline = new e$n(), this.type = "2d", this.ui = new p$E(), this._pixelFormat = { flipY: true, premultipliedAlpha: true }, this.constraints = new u$A(), this.padding = { top: 0, right: 0, bottom: 0, left: 0 }, this.handles.add([l$1P(() => this.viewpoint, () => {
      this._lastStationaryEventTimestamp = performance.now(), this._flipStationary(ye$1);
    }, U$r), this.on("resize", (e3) => this._resizeHandler(e3)), l$1P(() => {
      var _a2;
      return (_a2 = this.animationManager) == null ? void 0 : _a2.animation;
    }, (e3) => {
      this.animation = e3;
    })]), l$1N();
  }
  destroy() {
    this._set("preconditionsReady", false), this._gotoTask = this.frameTask = null, this.rootLayerViews.destroy(), this.inputManager.destroy(), this._set("inputManager", null);
  }
  get graphicsTileStore() {
    return new d$o(this.featuresTilingScheme);
  }
  get initialExtentRequired() {
    var _a2;
    const { scale: e2, constraints: t2, center: i2, viewpoint: s2, extent: r2 } = this;
    let n2 = this.zoom;
    return !(this.map && "initialViewProperties" in this.map && ((_a2 = this.map.initialViewProperties) == null ? void 0 : _a2.viewpoint)) && (!r2 && ((t2 == null ? void 0 : t2.effectiveLODs) || (n2 = -1), (!i2 || e2 === 0 && n2 === -1) && (!s2 || !r$1$(s2.targetGeometry) || s2.targetGeometry.type !== "extent" && !s2.scale)));
  }
  get resourceManager() {
    return this._stage.resourceManager;
  }
  get textureManager() {
    return this._stage.painter.textureManager;
  }
  get _defaultsFromMapSettings() {
    return { required: { tileInfo: true, heightModelInfo: false, extent: false }, requiresExtentInSpatialReference: this.spatialReferenceLocked };
  }
  get _projectionEngineLoaded() {
    return !!en() || (this._pePromise || (this._pePromise = tn().finally(() => {
      this._pePromise = null;
    })), false);
  }
  get typeSpecificPreconditionsReady() {
    const e2 = this._getDefaultViewpoint();
    if (!e2)
      return false;
    const t2 = this.spatialReference, i2 = e$2e(e2.targetGeometry);
    return !!An(i2.spatialReference, t2) || this._projectionEngineLoaded;
  }
  set animation(e2) {
    const t2 = this._get("animation");
    if (e2 === t2)
      return;
    if (t2 && t2.stop(), !e2 || e2.isFulfilled())
      return void this._set("animation", null);
    this._set("animation", e2), this.frameTask.animationInProgress = true;
    const i2 = () => {
      var _a2;
      e2 === this._get("animation") && (this._set("animation", null), (_a2 = this.frameTask) == null ? void 0 : _a2.requestFrame()), this.frameTask && (this.frameTask.animationInProgress = false);
    };
    e2.when(i2, i2);
  }
  get background() {
    return je(this.map) ? this.map.initialViewProperties.background : null;
  }
  set background(e2) {
    this._override("background", e2);
  }
  get center() {
    if (!this.ready)
      return this._get("center");
    const { center: e2, spatialReference: t2 } = this.state.paddedViewState;
    return new w$_({ x: e2[0], y: e2[1], spatialReference: t2 });
  }
  set center(e2) {
    if (e2 == null)
      return;
    if (!this.ready)
      return this._set("center", e2), void this.notifyChange("initialExtentRequired");
    let t2;
    try {
      t2 = this._project(e2, this.spatialReference);
    } catch (s2) {
      return void s$2z.getLogger(this.declaredClass).error(new s$2u("mapview:invalid-center", "could not project the value in the view's spatial reference", { input: e2, error: s2 }));
    }
    const i2 = this.viewpoint;
    xt(i2, i2, t2), this.viewpoint = i2;
  }
  set constraints(e2) {
    const t2 = this._get("constraints");
    t2 && (this.handles.remove("map-view-constraints"), t2.destroy()), this._set("constraints", e2), e2 && (e2.view = this, this.ready && (this.state.viewpoint = e2.fit(this.state.paddedViewState.viewpoint)), this.handles.add(l$1P(() => e2.version, () => {
      this.ready && this.state && (this.state.viewpoint = e2.fit(this.state.paddedViewState.viewpoint));
    }, U$r), "map-view-constraints"));
  }
  get extent() {
    return this.ready ? this.state.paddedViewState.extent.clone() : this._get("extent");
  }
  set extent(e2) {
    if (e2 == null)
      return;
    if (!e2.width || !e2.height)
      return void s$2z.getLogger(this.declaredClass).error(new s$2u("mapview:invalid-extent", "invalid extent size"));
    if (!this.ready)
      return this._set("extent", e2), this._set("center", null), this._set("viewpoint", null), this._set("scale", 0), this._set("zoom", -1), void this.notifyChange("initialExtentRequired");
    let t2;
    try {
      t2 = this._project(e2, this.spatialReference);
    } catch (s2) {
      return void s$2z.getLogger(this.declaredClass).error(new s$2u("mapview:invalid-extent", "could not project the value in the view's spatial reference", { error: s2 }));
    }
    const i2 = this.viewpoint;
    tt$2(i2, i2, t2, this.size, { constraints: this.constraints }), this.viewpoint = i2;
  }
  get padding() {
    return this.ready ? this.state.padding : this._get("padding");
  }
  set padding(e2) {
    this.ready ? (this.state.padding = e2, this._set("padding", this.state.padding)) : this._set("padding", e2);
  }
  get resolution() {
    return this.state ? this.state.resolution : 0;
  }
  get rotation() {
    return this.ready ? this.state.rotation : this._get("rotation");
  }
  set rotation(e2) {
    if (isNaN(e2))
      return;
    if (!this.ready)
      return void this._set("rotation", e2);
    const t2 = this.viewpoint;
    wt(t2, t2, e2), this.viewpoint = t2;
  }
  get scale() {
    return this.ready ? this.state.scale : this._get("scale");
  }
  set scale(e2) {
    if (!e2 || isNaN(e2))
      return;
    if (!this.ready) {
      this._set("scale", e2), this._set("zoom", -1);
      const t3 = this._get("extent");
      return t3 && (this._set("extent", null), this._set("center", t3.center)), void this.notifyChange("initialExtentRequired");
    }
    const t2 = this.viewpoint;
    jt(t2, t2, e2), this.viewpoint = t2;
  }
  get stationary() {
    return !(this.animation || this.navigating || this.resizing || this._stationaryTimer);
  }
  get updating() {
    var _a2, _b2, _c2;
    const e2 = !this.destroyed && (!this.layerViewManager || !this.labelManager || !this.graphicsView || this.layerViewManager.updating === true || this.labelManager.updating === true || this.graphicsView.updating === true || this.allLayerViews.some((e3) => !e3.destroyed && !("layerViews" in e3) && e3.updating === true));
    if (has("esri-2d-log-updating")) {
      const t2 = this.allLayerViews.reduce((e3, t3) => __spreadProps(__spreadValues({}, e3), { [t3.layer.id]: !t3.destroyed && !("layerViews" in t3) && t3.updating }), {});
      console.log(`Updating MapView: ${e2}
-> Null LayerViewManager: ${!this.layerViewManager}
-> Null LabelManager: ${!this.labelManager}
-> Null GraphicsView: ${!this.graphicsView}
-> layerViewManager.updating: ${(_a2 = this.layerViewManager) == null ? void 0 : _a2.updating}
-> labelManager.updating: ${(_b2 = this.labelManager) == null ? void 0 : _b2.updating}
-> graphicsView.updating: ${(_c2 = this.graphicsView) == null ? void 0 : _c2.updating}
-> allLayerViews: ${JSON.stringify(t2)}
`);
    }
    return e2;
  }
  get viewpoint() {
    if (!this.ready)
      return this._get("viewpoint");
    const e2 = this.state.paddedViewState;
    return e2 && e2.viewpoint.clone();
  }
  set viewpoint(e2) {
    if (e2 == null)
      return;
    if (!this.ready)
      return this._set("viewpoint", e2), this._set("extent", null), this._set("center", null), this._set("zoom", -1), this._set("scale", 0), void this.notifyChange("initialExtentRequired");
    let t2, s2;
    try {
      t2 = this._project(e2, this.spatialReference), !e2.scale || isNaN(e2.scale) ? s2 = new s$2u("mapview:invalid-viewpoint", `invalid scale value of ${e2.scale}`) : t$2r(e2.targetGeometry) && (s2 = new s$2u("mapview:invalid-viewpoint", "geometry not defined"));
    } catch (a2) {
      s2 = new s$2u("mapview:invalid-viewpoint", "could not project the value in the view's spatial reference", { error: a2 });
    }
    if (s2)
      return void s$2z.getLogger(this.declaredClass).error(s2);
    this._scaleBeforeChangingSpatialReference = null;
    const r2 = new u$1w({ targetGeometry: new w$_(), scale: 0, rotation: 0 });
    Z$9(r2, t2), this.constraints.constrain(r2, this.state.paddedViewState.viewpoint), this.state.viewpoint = r2, this.frameTask.requestFrame(), this._set("viewpoint", r2);
  }
  get zoom() {
    return this.ready ? this.constraints.scaleToZoom(this.scale) : this._get("zoom");
  }
  set zoom(e2) {
    if (e2 == null)
      return;
    if (!this.ready) {
      this._set("zoom", e2), this._set("scale", 0);
      const t3 = this._get("extent");
      return t3 && (this._set("extent", null), this._set("center", t3.center)), void this.notifyChange("initialExtentRequired");
    }
    if (!this.constraints.effectiveLODs)
      return void this._set("zoom", -1);
    const t2 = this.viewpoint;
    jt(t2, t2, this.constraints.zoomToScale(e2)), this.viewpoint = t2, this._set("zoom", this.constraints.scaleToZoom(this.scale));
  }
  get navigating() {
    return !(!this.mapViewNavigation || !this.mapViewNavigation.interacting);
  }
  goTo(e2, t2) {
    if (e2)
      return this.animation && (this.animation = null), this._createAnimation(), j$I(() => this.ready, t2).then(() => {
        const i2 = __spreadValues({ animate: true }, t2), s2 = Y$7(e2, this);
        return this.animation.update(s2), this._gotoTask = {}, i2.animate ? this._gotoAnimated(s2, i2) : this._gotoImmediate(s2, i2);
      });
    s$2z.getLogger(this.declaredClass).error("#goTo()", "target cannot be null or undefined");
  }
  async hitTest(e2, t2) {
    const i2 = o$L(e2) ? r$R(this, e2) : e2;
    if (!this.ready || isNaN(i2.x) || isNaN(i2.y))
      return { screenPoint: i2, results: [] };
    let s2 = new Set(), r2 = false, n2 = null, a2 = null;
    (t2 == null ? void 0 : t2.include) ? Se(t2.include, Ve(this, (e3) => s2.add(e3), (e3) => {
      n2 || (n2 = new Set()), n2.add(e3);
    }, (e3) => s2.add(e3), () => r2 = true)) : (r2 = true, s2 = new Set(this.allLayerViews)), (t2 == null ? void 0 : t2.exclude) && Se(t2.exclude, Ve(this, (e3) => s2.delete(e3), (e3) => {
      a2 || (a2 = new Set()), a2.add(e3);
    }));
    const o2 = this.allLayerViews.filter((e3) => !e3.suspended && s2.has(e3)).reverse(), p2 = this.toMap(i2);
    let h2 = [...r2 ? this.graphicsView.hitTest(p2).map((e3) => ({ type: "graphic", graphic: e3, layer: null, mapPoint: p2 })) : [], ...await Promise.all(o2.map((e3) => e3.hitTest(p2, i2)).toArray())].filter(r$1$).flat().filter(r$1$);
    return n2 && (h2 = h2.filter((e3) => !("graphic" in e3) || !e3.graphic || n2.has(ve(e3.graphic)))), a2 && (h2 = h2.filter((e3) => !("graphic" in e3) || !e3.graphic || a2.has(ve(e3.graphic)))), { screenPoint: i2, results: h2 };
  }
  async takeScreenshot(e2) {
    const t2 = this._createScreenshotPlan(e2), i2 = await this._stage.takeScreenshot(t2);
    return r$y(i2, { format: t2.format, quality: t2.quality, rotation: 0, disableDecorations: false }, this._pixelFormat);
  }
  async _takeScreenshot(e2) {
    const t2 = this._createScreenshotPlan(e2), i2 = await this._stage.takeScreenshot(t2);
    return l$E(i2, this._pixelFormat);
  }
  _createScreenshotPlan(e2) {
    e2 = e2 || {};
    const t2 = this.supersampleScreenshotsEnabled ? Math.min(4, w$f(this.size, Math.min(4096, this._stage.context.parameters.maxTextureSize))) : 1;
    let i2;
    e2.layers ? (i2 = [], e2.layers.forEach((e3) => {
      const t3 = this.allLayerViews.find((t4) => t4.layer.id === e3.id);
      t3 && "container" in t3 && t3.container && i2.push(t3.container);
    })) : i2 = this._stage.children;
    const { format: s2, quality: r2 } = s$y(e2.format, e2.quality);
    return t$u(e2, t2, this.size, this.padding, s2, r2, i2, e2.rotation);
  }
  get test() {
    return { takeScreenshot: (e2) => this._takeScreenshot(e2) };
  }
  toMap(e2) {
    if (!this.ready)
      return null;
    const t2 = o$L(e2) ? r$R(this, e2) : e2, i2 = [0, 0], [s2, r2] = this.state.toMap(i2, [t2.x, t2.y]), n2 = this.spatialReference;
    return new w$_({ x: s2, y: r2, spatialReference: n2 });
  }
  toScreen(e2) {
    if (!this.ready)
      return null;
    const t2 = this._project(e2, this.spatialReference), i2 = [t2.x, t2.y];
    return this.state.toScreen(i2, i2), c$2K(i2[0], i2[1]);
  }
  on(e2, t2, i2, s2) {
    const r2 = this.inputManager && this.viewEvents.on(e2, t2, i2, s2);
    return r2 || super.on(e2, t2);
  }
  hasEventListener(e2) {
    return super.hasEventListener(e2) || this.viewEvents.hasHandler(e2);
  }
  whenLayerView(e2) {
    return super.whenLayerView(e2);
  }
  graphicChanged(e2) {
    if (this.graphicsView) {
      this.graphicsView.graphicUpdateHandler(e2);
    }
  }
  whenReady() {
    return new Promise((e2) => {
      this.ready ? e2(this) : this._resolveWhenReady.push(e2);
    });
  }
  forceDOMReadyCycle() {
    this.forceReadyCycle();
  }
  getDefaultSpatialReference() {
    var _a2, _b2, _c2;
    return this.map && "initialViewProperties" in this.map && ((_b2 = (_a2 = this.map) == null ? void 0 : _a2.initialViewProperties) == null ? void 0 : _b2.spatialReference) || ((_c2 = this.defaultsFromMap) == null ? void 0 : _c2.spatialReference) || null;
  }
  hasLayerViewModule(e2) {
    return n$R.hasLayerViewModule(e2);
  }
  importLayerView(e2) {
    return n$R.importLayerView(e2);
  }
  pixelSizeAt() {
    return this.ready ? this.state.resolution : (s$2z.getLogger(this.declaredClass).error("#pixelSizeAt()", "Map view cannot be used before it is ready"), null);
  }
  popupHitTest(e2) {
    return this.hitTest(e2).then((t2) => __spreadProps(__spreadValues({}, t2), { mapPoint: this.toMap(e2) }));
  }
  requestUpdate() {
    this.ready && this.frameTask.requestUpdate();
  }
  validate() {
    let e2 = i$I(this.type);
    return has("safari") && has("safari") < 9 && (e2 = new s$2u("mapview:browser-not-supported", "This browser is not supported by MapView (Safari < 9)", { type: "safari", requiredVersion: 9, detectedVersion: has("safari") })), r$1$(e2) ? (s$2z.getLogger(this.declaredClass).warn("#validate()", e2.message), Promise.reject(e2)) : me();
  }
  _createAnimation() {
    return this.animation && !this.animation.done || (this.animation = new p$V()), this.animation;
  }
  _cancellableGoTo(e2, t2, i2) {
    const s2 = () => e2 === this._gotoTask, r2 = i2.then(() => {
      s2() && (this.animation = null);
    }).catch((e3) => {
      throw s2() && (this.animation = null, t2.done || (t2.stop(), this.frameTask.animationInProgress = false)), e3;
    }), n2 = new Promise((e3) => e3(r2));
    return t2.when().catch(() => {
      s2() && n2.cancel && n2.cancel();
    }), n2;
  }
  _gotoImmediate(e2, t2) {
    const i2 = this._gotoTask, s2 = this.animation, r2 = e2.then((e3) => {
      if (f$1V(t2), i2 !== this._gotoTask)
        throw new s$2u("view:goto-interrupted", "Goto was interrupted");
      this.viewpoint = s2.target = e3, s2.finish();
    });
    return this._cancellableGoTo(i2, s2, r2);
  }
  _flipStationary(e2) {
    return this._stationaryTimer !== null || (this._stationaryTimer = setTimeout(() => {
      this._stationaryTimer = null;
      const e3 = performance.now() - this._lastStationaryEventTimestamp;
      e3 < ye$1 && (this._stationaryTimer = this._flipStationary(e3));
    }, e2)), this._stationaryTimer;
  }
  _getDefaultViewpoint() {
    var _a2, _b2, _c2, _d2;
    const { constraints: e2, initialExtent: t2, map: s2, padding: r2, size: n2 } = this;
    if (!e2)
      return null;
    const a2 = s2 && "initialViewProperties" in s2 && s2.initialViewProperties, o2 = { zoom: this._get("zoom"), scale: this._get("scale"), center: this._get("center"), extent: this._get("extent"), rotation: this._get("rotation"), viewpoint: this._get("viewpoint"), spatialReference: this._userSpatialReference };
    e2.effectiveLODs ? o2.zoom !== -1 && (o2.scale = e2.zoomToScale(o2.zoom)) : o2.zoom = -1;
    let h2 = null, c2 = null, d2 = 0;
    const u2 = o2.viewpoint && o2.viewpoint.rotation, g2 = o2.viewpoint && o2.viewpoint.targetGeometry;
    r$1$(g2) && (g2.type === "extent" ? h2 = g2 : g2.type === "point" && (c2 = g2, d2 = o2.viewpoint.scale));
    const m2 = o2.extent || h2 || ((_b2 = e$2e((_a2 = a2 == null ? void 0 : a2.viewpoint) == null ? void 0 : _a2.targetGeometry)) == null ? void 0 : _b2.extent) || t2, y2 = o2.center || c2 || (m2 == null ? void 0 : m2.center), w2 = o2.scale || d2 || ((_c2 = a2 == null ? void 0 : a2.viewpoint) == null ? void 0 : _c2.scale) || m2 && H$8(m2, [n2[0] - r2.left - r2.right, n2[1] - r2.top - r2.bottom]), f2 = o2.rotation || u2 || ((_d2 = a2 == null ? void 0 : a2.viewpoint) == null ? void 0 : _d2.rotation) || 0;
    return y2 && w2 ? new u$1w({ targetGeometry: y2, scale: w2, rotation: f2 }) : null;
  }
  _gotoAnimated(e2, t2) {
    const i2 = this._gotoTask, s2 = this.animation, r2 = e2.then((e3) => {
      if (f$1V(t2), i2 !== this._gotoTask)
        throw new s$2u("view:goto-interrupted", "Goto was interrupted");
      return s2.update(e3), this.animationManager.animate(s2, this.viewpoint, t2), s2.when().then(() => {
      }, () => {
      });
    });
    return this._cancellableGoTo(i2, s2, r2);
  }
  _project(e2, t2) {
    var _a2;
    const i2 = e2 && e2.targetGeometry || e2;
    if (!t2)
      return e2;
    if (!i2)
      return null;
    if (t2.imageCoordinateSystem || ((_a2 = i2.spatialReference) == null ? void 0 : _a2.imageCoordinateSystem))
      return e2;
    if (E$P(t2, i2.spatialReference))
      return e2;
    const s2 = rn(i2, t2);
    if (!s2)
      throw new s$2u("mapview:projection-not-possible", "projecting input geometry to target spatial reference returned a null value", { geometry: i2, spatialReference: t2 });
    return we(e2) ? (e2.targetGeometry = s2, e2) : s2;
  }
  _resizeHandler(e2) {
    if (!this.ready)
      return;
    const t2 = this.state;
    let i2 = this.state.paddedViewState.viewpoint;
    const s2 = this.state.paddedViewState.size.concat();
    t2.size = [e2.width, e2.height], ht(i2, i2, s2, this.state.paddedViewState.size, this.resizeAlign), i2 = this.constraints.constrain(i2, null), this.state.viewpoint = i2;
  }
  _startup() {
    var _a2, _b2;
    this.timeline.begin("MapView Startup");
    const e2 = this._getDefaultViewpoint(), t2 = e2.targetGeometry;
    try {
      this._project(e2, this.spatialReference);
    } catch (l2) {
      s$2z.getLogger(this.declaredClass).warn(new t$2j("mapview:startup-projection-error", "projection of initial viewpoint to the view's spatial reference, defaulting to the initial viewpoint.", { center: t2.toJSON(), spatialReference: this.spatialReference, error: l2 })), e2.targetGeometry = ((_a2 = this.defaultsFromMap.extent) == null ? void 0 : _a2.center) || new w$_({ x: 0, y: 0, spatialReference: this.spatialReference });
    }
    (_b2 = this.constraints) == null ? void 0 : _b2.fit(e2), this._set("state", new f$t({ padding: this._get("padding"), size: this.size, viewpoint: e2 })), this.graphics.owner = this;
    const i2 = new pe(this.surface, { canvas: this.renderCanvas, supersampleScreenshots: this.supersampleScreenshotsEnabled, contextOptions: { disabledExtensions: this.deactivatedWebGLExtensions, debugWebGLExtensions: this.debugWebGLExtensions }, renderingOptions: this.renderingOptions, timeline: this.timeline });
    this._stage = i2, this._magnifierView = new ge(), this._magnifierView.magnifier = this.magnifier;
    const s2 = new de({ view: this });
    this._set("labelManager", s2);
    const r2 = new d$s({ view: this });
    this._set("animationManager", r2);
    const n2 = new ue$1({ view: this, animationManager: r2 });
    this._set("mapViewNavigation", n2), this._setupSpatialReferenceDependentProperties(), this.handles.add([this.rootLayerViews.on("change", () => this._updateStageChildren()), i2.on("post-render", () => this._set("rendering", i2.renderRequested)), i2.on("will-render", () => this._set("rendering", i2.renderRequested)), i2.on("webgl-error", (e3) => this.fatalError = e3.error), l$1P(() => this.stationary, (e3) => i2.stationary = e3, w$Q), l$1P(() => this.background, (e3) => {
      i2.background = e3, this._magnifierView.background = e3;
    }, w$Q), l$1P(() => this.magnifier, (e3) => this._magnifierView.magnifier = e3, w$Q), l$1P(() => this.renderingOptions, (e3) => i2.renderingOptions = e3, w$Q), l$1P(() => this.highlightOptions, (e3) => i2.highlightOptions = e3, w$Q), l$1P(() => this.state.id, () => i2.state = this.state, w$Q)], "map-view"), this._updateStageChildren();
    const a2 = this._resolveWhenReady;
    this._resolveWhenReady = [], a2.forEach((e3) => e3(this)), this.timeline.end("MapView Startup"), this.frameTask && this.frameTask.start(), this._set("ready", true);
  }
  _teardown() {
    this._destroySpatialReferenceDependentProperties(), this.handles.remove("map-view"), this.mapViewNavigation.destroy(), this._set("mapViewNavigation", null), this.animationManager.destroy(), this._set("animationManager", null), this.layerViewManager.clear(), this.labelManager.destroy(), this._magnifierView.destroy(), this._stage.destroy(), this._stage = null, this._set("graphicsView", null), this._magnifierView = null, this._set("labelManager", null), this._set("mapViewNavigation", null), this.graphics.owner = null, this.frameTask && this.frameTask.stop(), this._stationaryTimer && (clearTimeout(this._stationaryTimer), this._stationaryTimer = null), this._set("ready", false);
    const { center: [e2, t2], spatialReference: i2, rotation: s2, scale: r2 } = this.state.paddedViewState, n2 = new w$_({ x: e2, y: t2, spatialReference: i2 });
    this._set("viewpoint", null), this._set("extent", null), this._set("center", n2), this._set("zoom", -1), this._set("rotation", s2), this._set("scale", r2), this._set("spatialReference", i2), this._set("state", null), this.animation = null;
  }
  _updateStageChildren() {
    this._stage.removeAllChildren(), this.rootLayerViews.forEach((e3) => {
      this._stage.addChild(e3.container);
    });
    const e2 = this.graphicsView;
    this._stage.addChild(e2.container), this._stage.addChild(this._magnifierView);
  }
  _setupSpatialReferenceDependentProperties() {
    const e2 = new h$z(j$E.create({ spatialReference: this.spatialReference, size: 512, numLODs: 36 }));
    this._set("featuresTilingScheme", e2);
    const t2 = new he({ view: this, graphics: this.graphics, requestUpdateCallback: () => this.requestUpdate(), container: new ce$1(e2) });
    this.frameTask.graphicsView = t2, this._set("graphicsView", t2);
  }
  _destroySpatialReferenceDependentProperties() {
    const e2 = this.graphicsView;
    this._set("graphicsView", null), this.frameTask.graphicsView = null, e2.destroy(), this._set("featuresTilingScheme", null);
  }
  _spatialReferenceChanged(e2) {
    if (!this.ready)
      return;
    this.frameTask.stop();
    for (const i2 of this.allLayerViews)
      i2.processDetach();
    this._destroySpatialReferenceDependentProperties();
    const t2 = this.state.paddedViewState.clone();
    if (t$2r(this._scaleBeforeChangingSpatialReference))
      this._scaleBeforeChangingSpatialReference = t2.scale;
    else {
      const e3 = t2.viewpoint.clone();
      e3.scale = this._scaleBeforeChangingSpatialReference, t2.viewpoint = e3;
    }
    const s2 = t2.clone(), [r2, n2] = t2.center;
    let a2 = null;
    try {
      a2 = this._project(new w$_({ x: r2, y: n2, spatialReference: t2.spatialReference }), e2);
    } catch (p2) {
      en() || s$2z.getLogger(this.declaredClass).warn(new t$2j("mapview:spatial-reference-change", "could not project the view's center to the new spatial reference", { center: a2.toJSON(), spatialReference: e2, error: p2 }));
    }
    a2 || (a2 = new w$_({ x: 0, y: 0, spatialReference: e2 }));
    const l2 = xt(new u$1w({ targetGeometry: new w$_(), scale: 0, rotation: 0 }), t2.viewpoint, a2);
    s2.viewpoint = l2;
    try {
      const i2 = 20, r3 = [t2.size[0] / 2, t2.size[1] / 2], n3 = [r3[0] + i2, r3[1]], a3 = t2.toMap([0, 0], n3), { x: o2, y: p2 } = this._project(new w$_({ x: a3[0], y: a3[1], spatialReference: t2.spatialReference }), e2);
      a3[0] = o2, a3[1] = p2, s2.toScreen(a3, a3);
      const h2 = pt(r3, a3, n3), c2 = Math.hypot(a3[0] - r3[0], a3[1] - r3[1]) / i2;
      !Number.isFinite(c2) || Math.abs(c2) > 4 ? (l2.rotation = 0, l2.targetGeometry = new w$_({ x: 0, y: 0, spatialReference: e2 })) : (l2.scale *= c2, l2.scale > has("mapview-srswitch-adjust-rotation-scale-threshold") ? l2.rotation = 0 : l2.rotation += Number.isFinite(h2) ? h2 : 0);
    } catch {
    }
    this._get("constraints").constrain(l2, null), this._get("state").viewpoint = l2, this._stage.state = this.state, this._setupSpatialReferenceDependentProperties();
    for (const i2 of this.allLayerViews)
      i2.processAttach();
    this.frameTask.requestFrame(), this.frameTask.start(), this._updateStageChildren();
  }
};
fe.type = "2d", e$2g([y$1I({ readOnly: true })], fe.prototype, "animationManager", void 0), e$2g([y$1I({ constructOnly: true })], fe.prototype, "deactivatedWebGLExtensions", void 0), e$2g([y$1I({ constructOnly: true })], fe.prototype, "debugWebGLExtensions", void 0), e$2g([y$1I({ readOnly: true })], fe.prototype, "featuresTilingScheme", void 0), e$2g([y$1I({ readOnly: true })], fe.prototype, "fullOpacity", void 0), e$2g([y$1I({ readOnly: true })], fe.prototype, "graphicsTileStore", null), e$2g([y$1I()], fe.prototype, "graphicsView", void 0), e$2g([y$1I({ readOnly: true })], fe.prototype, "state", void 0), e$2g([y$1I()], fe.prototype, "initialExtentRequired", null), e$2g([y$1I()], fe.prototype, "labelManager", void 0), e$2g([y$1I({ readOnly: true })], fe.prototype, "resourceManager", null), e$2g([y$1I({ readOnly: true })], fe.prototype, "textureManager", null), e$2g([y$1I({ readOnly: true })], fe.prototype, "mapViewNavigation", void 0), e$2g([y$1I({ constructOnly: true })], fe.prototype, "renderCanvas", void 0), e$2g([y$1I()], fe.prototype, "renderingOptions", void 0), e$2g([y$1I({ readOnly: true })], fe.prototype, "rendering", void 0), e$2g([y$1I({ constructOnly: true })], fe.prototype, "supersampleScreenshotsEnabled", void 0), e$2g([y$1I({ readOnly: true })], fe.prototype, "supportsGround", void 0), e$2g([y$1I()], fe.prototype, "_stationaryTimer", void 0), e$2g([y$1I()], fe.prototype, "_defaultsFromMapSettings", null), e$2g([y$1I()], fe.prototype, "_pePromise", void 0), e$2g([y$1I({ readOnly: true })], fe.prototype, "typeSpecificPreconditionsReady", null), e$2g([y$1I()], fe.prototype, "animation", null), e$2g([y$1I({ type: m$H })], fe.prototype, "background", null), e$2g([y$1I({ value: null, type: w$_, dependsOn: ["state.id", "ready"] })], fe.prototype, "center", null), e$2g([y$1I({ type: u$A })], fe.prototype, "constraints", null), e$2g([y$1I({ value: null, type: w$Z, dependsOn: ["state.id", "ready"] })], fe.prototype, "extent", null), e$2g([y$1I()], fe.prototype, "floors", void 0), e$2g([y$1I({ type: c$G })], fe.prototype, "highlightOptions", void 0), e$2g([y$1I({ readOnly: true })], fe.prototype, "inputManager", void 0), e$2g([y$1I()], fe.prototype, "map", void 0), e$2g([y$1I({ value: { top: 0, right: 0, bottom: 0, left: 0 }, cast: (e2) => __spreadValues({ top: 0, right: 0, bottom: 0, left: 0 }, e2) })], fe.prototype, "padding", null), e$2g([y$1I()], fe.prototype, "resizeAlign", void 0), e$2g([y$1I({ readOnly: true, dependsOn: ["state.id"] })], fe.prototype, "resolution", null), e$2g([y$1I({ value: 0, type: Number, dependsOn: ["state.id", "ready"] })], fe.prototype, "rotation", null), e$2g([y$1I({ value: 0, type: Number, dependsOn: ["state.id", "ready"] })], fe.prototype, "scale", null), e$2g([y$1I({ constructOnly: true })], fe.prototype, "spatialReferenceLocked", void 0), e$2g([y$1I()], fe.prototype, "stationary", null), e$2g([y$1I({ type: e$n, readOnly: true })], fe.prototype, "timeline", void 0), e$2g([y$1I({ readOnly: true })], fe.prototype, "type", void 0), e$2g([y$1I({ readOnly: true })], fe.prototype, "updating", null), e$2g([y$1I({ value: null, type: u$1w, dependsOn: ["state.id", "ready"] })], fe.prototype, "viewpoint", null), e$2g([y$1I({ value: -1, dependsOn: ["state.id", "ready"] })], fe.prototype, "zoom", null), e$2g([y$1I({ readOnly: true })], fe.prototype, "navigating", null), e$2g([y$1I({ type: p$E })], fe.prototype, "ui", void 0), fe = e$2g([n$2P("esri.views.MapView")], fe);
const _e = fe;
function ve(e2) {
  var _a2, _b2, _c2, _d2;
  const t2 = e2.getObjectId();
  return t2 ? `${(_d2 = (_c2 = (_a2 = e2.layer) == null ? void 0 : _a2.uid) != null ? _c2 : (_b2 = e2.sourceLayer) == null ? void 0 : _b2.uid) != null ? _d2 : "MapView"}/${t2}` : `"MapView/${e2.uid}`;
}
function Ve(e2, i2, s2, r2, n2) {
  return (a2) => {
    if (a2 instanceof g$10) {
      if (a2.layer === e2)
        n2 == null ? void 0 : n2();
      else {
        const t2 = e2.allLayerViews.find((e3) => e3.layer === a2.layer);
        t2 && (r2 == null ? void 0 : r2(t2));
      }
      s2(ve(a2));
    } else {
      const t2 = e2.allLayerViews.find((e3) => e3.layer === a2);
      t2 && i2(t2);
    }
  };
}
function Se(e2, t2) {
  if (e2)
    if (t$2h(e2))
      for (const i2 of e2)
        if (t$2h(i2))
          for (const e3 of i2)
            t2(e3);
        else
          t2(i2);
    else
      t2(e2);
}
function je(e2) {
  return (e2 == null ? void 0 : e2.declaredClass) === "esri.WebMap";
}
var index_vue_vue_type_style_index_0_scoped_true_lang = "";
var index_vue_vue_type_style_index_1_lang = "";
const _sfc_main = /* @__PURE__ */ defineComponent({
  props: {
    basemap: null
  },
  setup(__props, { expose }) {
    const props = __props;
    const refMap = ref();
    const init = (options) => {
      const map = new L$c({
        basemap: props.basemap || "satellite"
      });
      const view = new _e({
        container: refMap.value,
        map,
        center: (options == null ? void 0 : options.center) || [117.09, 30.64],
        zoom: (options == null ? void 0 : options.zoom) || 5,
        highlightOptions: {
          fillOpacity: 0,
          haloOpacity: 0.7
        }
      });
      view.ui.remove("attribution");
      view.ui.remove("zoom");
      view.ui.padding = {
        bottom: 15,
        left: 15,
        right: 15,
        top: 15
      };
      return view;
    };
    expose({
      init
    });
    return (_ctx, _cache) => {
      return openBlock(), createElementBlock("div", {
        id: "viewDiv",
        ref: (_value, _refs) => {
          _refs["refMap"] = _value;
          refMap.value = _value;
        },
        class: "viewDiv"
      }, null, 512);
    };
  }
});
var ArcMap = /* @__PURE__ */ _export_sfc(_sfc_main, [["__scopeId", "data-v-13df5150"]]);
var m$G;
let a$s = m$G = class extends l$2B {
  constructor(t2) {
    super(t2), this.dpi = 96, this.floors = null, this.gdbVersion = null, this.geometry = null, this.geometryPrecision = null, this.height = 400, this.layerIds = null, this.layerOption = "top", this.mapExtent = null, this.maxAllowableOffset = null, this.returnFieldName = true, this.returnGeometry = false, this.returnM = false, this.returnUnformattedValues = true, this.returnZ = false, this.spatialReference = null, this.sublayers = null, this.timeExtent = null, this.tolerance = null, this.width = 400;
  }
  static from(t2) {
    return v$1c(m$G, t2);
  }
};
e$2g([y$1I({ type: Number, json: { write: true } })], a$s.prototype, "dpi", void 0), e$2g([y$1I()], a$s.prototype, "floors", void 0), e$2g([y$1I({ type: String, json: { write: true } })], a$s.prototype, "gdbVersion", void 0), e$2g([y$1I({ types: i$2S, json: { read: v$14, write: true } })], a$s.prototype, "geometry", void 0), e$2g([y$1I({ type: Number, json: { write: true } })], a$s.prototype, "geometryPrecision", void 0), e$2g([y$1I({ type: Number, json: { write: true } })], a$s.prototype, "height", void 0), e$2g([y$1I({ type: [Number], json: { write: true } })], a$s.prototype, "layerIds", void 0), e$2g([y$1I({ type: ["top", "visible", "all", "popup"], json: { write: true } })], a$s.prototype, "layerOption", void 0), e$2g([y$1I({ type: w$Z, json: { write: true } })], a$s.prototype, "mapExtent", void 0), e$2g([y$1I({ type: Number, json: { write: true } })], a$s.prototype, "maxAllowableOffset", void 0), e$2g([y$1I({ type: Boolean, json: { write: true } })], a$s.prototype, "returnFieldName", void 0), e$2g([y$1I({ type: Boolean, json: { write: true } })], a$s.prototype, "returnGeometry", void 0), e$2g([y$1I({ type: Boolean, json: { write: true } })], a$s.prototype, "returnM", void 0), e$2g([y$1I({ type: Boolean, json: { write: true } })], a$s.prototype, "returnUnformattedValues", void 0), e$2g([y$1I({ type: Boolean, json: { write: true } })], a$s.prototype, "returnZ", void 0), e$2g([y$1I({ type: k$C, json: { write: true } })], a$s.prototype, "spatialReference", void 0), e$2g([y$1I()], a$s.prototype, "sublayers", void 0), e$2g([y$1I({ type: T$o, json: { write: true } })], a$s.prototype, "timeExtent", void 0), e$2g([y$1I({ type: Number, json: { write: true } })], a$s.prototype, "tolerance", void 0), e$2g([y$1I({ type: Number, json: { write: true } })], a$s.prototype, "width", void 0), a$s = m$G = e$2g([n$2P("esri.rest.support.IdentifyParameters")], a$s);
const u$m = a$s;
const e$l = 96;
function i$F(i2, r2) {
  const o2 = r2 || i2.extent, c2 = i2.width, d2 = $$g(o2 && o2.spatialReference);
  return o2 && c2 ? o2.width / c2 * d2 * f$1j * e$l : 0;
}
function r$v(i2, r2) {
  return i2 / ($$g(r2) * f$1j * e$l);
}
function o$s(o2) {
  var _a2;
  const n2 = o2.layer;
  if ("floorInfo" in n2 && ((_a2 = n2.floorInfo) == null ? void 0 : _a2.floorField) && "floors" in o2.view) {
    return l$x(o2.view.floors, n2.floorInfo.floorField);
  }
  return null;
}
function n$y(o2, n2) {
  var _a2;
  return "floorInfo" in n2 && ((_a2 = n2.floorInfo) == null ? void 0 : _a2.floorField) ? l$x(o2, n2.floorInfo.floorField) : null;
}
function l$x(o2, n2) {
  if (!(o2 == null ? void 0 : o2.length))
    return null;
  const l2 = o2.filter((o3) => o3 !== "").map((o3) => `'${o3}'`);
  return l2.push("''"), `${n2} IN (${l2.join(",")}) OR ${n2} IS NULL`;
}
function n$x(r2, e2, n2) {
  const i2 = e2.flatten(({ sublayers: r3 }) => r3).length;
  if (i2 !== r2.length)
    return true;
  return !!r2.some((r3) => r3.originIdOf("minScale") > n2 || r3.originIdOf("maxScale") > n2 || r3.originIdOf("renderer") > n2 || r3.originIdOf("labelingInfo") > n2 || r3.originIdOf("opacity") > n2 || r3.originIdOf("labelsVisible") > n2 || r3.originIdOf("source") > n2) || !o$r(r2, e2);
}
function i$E(n2, i2, t2) {
  return !!n2.some((n3) => {
    const i3 = n3.source;
    return !(!i3 || i3.type === "map-layer" && i3.mapLayerId === n3.id && (t$2r(i3.gdbVersion) || i3.gdbVersion === t2)) || n3.originIdOf("renderer") > r$1U.SERVICE || n3.originIdOf("labelingInfo") > r$1U.SERVICE || n3.originIdOf("opacity") > r$1U.SERVICE || n3.originIdOf("labelsVisible") > r$1U.SERVICE;
  }) || !o$r(n2, i2);
}
function o$r(e2, n2) {
  if (!e2 || !e2.length || t$2r(n2))
    return true;
  const i2 = n2.slice().reverse().flatten(({ sublayers: r2 }) => r2 && r2.toArray().reverse()).map((r2) => r2.id).toArray();
  if (e2.length > i2.length)
    return false;
  let o2 = 0;
  const t2 = i2.length;
  for (const { id: r2 } of e2) {
    for (; o2 < t2 && i2[o2] !== r2; )
      o2++;
    if (o2 >= t2)
      return false;
  }
  return true;
}
function t$s(r2) {
  return !!r2 && r2.some((r3) => r3.minScale != null || r3.layerDefinition && r3.layerDefinition.minScale != null);
}
const o$q = (e2) => e2.spatialReference.wkid || JSON.stringify(e2.spatialReference);
function l$w(r2, i2) {
  const { dpi: n2, gdbVersion: s2, geometry: l2, geometryPrecision: f2, height: p2, layerOption: m2, mapExtent: y2, maxAllowableOffset: c2, returnFieldName: u2, returnGeometry: d2, returnUnformattedValues: g2, returnZ: x2, spatialReference: b2, timeExtent: h2, tolerance: E2, width: O2 } = r2.toJSON(), { dynamicLayers: S2, layerDefs: j2, layerIds: N2 } = a$r(r2), J2 = i2 && r$1$(i2.geometry) ? i2.geometry : null, R2 = { geometryPrecision: f2, maxAllowableOffset: c2, returnFieldName: u2, returnGeometry: d2, returnUnformattedValues: g2, returnZ: x2, tolerance: E2 }, $2 = J2 && J2.toJSON() || l2;
  if (R2.imageDisplay = `${O2},${p2},${n2}`, s2 && (R2.gdbVersion = s2), $2 && (delete $2.spatialReference, R2.geometry = JSON.stringify($2), R2.geometryType = c$32($2)), b2 ? R2.sr = b2.wkid || JSON.stringify(b2) : $2 && $2.spatialReference ? R2.sr = o$q($2) : y2 && y2.spatialReference && (R2.sr = o$q(y2)), R2.time = h2 ? [h2.start, h2.end].join(",") : null, y2) {
    const { xmin: e2, ymin: r3, xmax: t2, ymax: i3 } = y2;
    R2.mapExtent = `${e2},${r3},${t2},${i3}`;
  }
  return j2 && (R2.layerDefs = j2), S2 && !j2 && (R2.dynamicLayers = S2), R2.layers = m2 === "popup" ? "visible" : m2, N2 && !S2 && (R2.layers += `:${N2.join(",")}`), R2;
}
function a$r(r2) {
  var _a2, _b2;
  const { mapExtent: t2, floors: o2, width: l2, sublayers: a2, layerIds: p2, layerOption: m2, gdbVersion: y2 } = r2, c2 = (_b2 = (_a2 = a2 == null ? void 0 : a2.find((e2) => e2.layer != null)) == null ? void 0 : _a2.layer) == null ? void 0 : _b2.serviceSublayers, u2 = m2 === "popup", d2 = {}, g2 = i$F({ extent: t2, width: l2, spatialReference: t2 == null ? void 0 : t2.spatialReference }), x2 = [], b2 = (e2) => {
    const r3 = g2 === 0, t3 = e2.minScale === 0 || g2 <= e2.minScale, i2 = e2.maxScale === 0 || g2 >= e2.maxScale;
    if (e2.visible && (r3 || t3 && i2))
      if (e2.sublayers)
        e2.sublayers.forEach(b2);
      else {
        if ((p2 == null ? void 0 : p2.includes(e2.id)) === false || u2 && (!e2.popupTemplate || !e2.popupEnabled))
          return;
        x2.unshift(e2);
      }
  };
  if (a2 == null ? void 0 : a2.forEach(b2), a2 && !x2.length)
    d2.layerIds = [];
  else {
    const r3 = i$E(x2, c2, y2), t3 = x2.map((e2) => {
      const r4 = n$y(o2, e2);
      return e2.toExportImageJSON(r4);
    });
    if (r3)
      d2.dynamicLayers = JSON.stringify(t3);
    else {
      if (a2) {
        let e2 = x2.map(({ id: e3 }) => e3);
        p2 && (e2 = e2.filter((e3) => p2.includes(e3))), d2.layerIds = e2;
      } else
        (p2 == null ? void 0 : p2.length) && (d2.layerIds = p2);
      const r4 = f$n(o2, x2);
      if (r$1$(r4) && r4.length) {
        const e2 = {};
        for (const t4 of r4)
          t4.definitionExpression && (e2[t4.id] = t4.definitionExpression);
        Object.keys(e2).length && (d2.layerDefs = JSON.stringify(e2));
      }
    }
  }
  return d2;
}
function f$n(e2, t2) {
  const i2 = !!(e2 == null ? void 0 : e2.length), s2 = t2.filter((e3) => e3.definitionExpression != null || i2 && e3.floorInfo != null);
  return s2.length ? s2.map((t3) => {
    const i3 = n$y(e2, t3), s3 = t$14(i3, t3.definitionExpression);
    return { id: t3.id, definitionExpression: s3 };
  }) : null;
}
let m$F = class extends l$2B {
  constructor(r2) {
    super(r2), this.displayFieldName = null, this.feature = null, this.layerId = null, this.layerName = null;
  }
  readFeature(r2, t2) {
    return g$10.fromJSON({ attributes: __spreadValues({}, t2.attributes), geometry: __spreadValues({}, t2.geometry) });
  }
  writeFeature(r2, e2) {
    if (!r2)
      return;
    const { attributes: t2, geometry: s2 } = r2;
    t2 && (e2.attributes = __spreadValues({}, t2)), r$1$(s2) && (e2.geometry = s2.toJSON(), e2.geometryType = t$1Y.toJSON(s2.type));
  }
};
e$2g([y$1I({ type: String, json: { write: true } })], m$F.prototype, "displayFieldName", void 0), e$2g([y$1I({ type: g$10 })], m$F.prototype, "feature", void 0), e$2g([o$29("feature", ["attributes", "geometry"])], m$F.prototype, "readFeature", null), e$2g([r$1P("feature")], m$F.prototype, "writeFeature", null), e$2g([y$1I({ type: Number, json: { write: true } })], m$F.prototype, "layerId", void 0), e$2g([y$1I({ type: String, json: { write: true } })], m$F.prototype, "layerName", void 0), m$F = e$2g([n$2P("esri.rest.support.IdentifyResult")], m$F);
const y$g = m$F;
async function f$m(u2, i2, f2) {
  const c2 = (i2 = a$q(i2)).geometry ? [i2.geometry] : [], l2 = f$19(u2);
  return l2.path += "/identify", v$L(c2).then((e2) => {
    const t2 = l$w(i2, { geometry: e2 && e2[0] }), u3 = s$1o(__spreadValues(__spreadProps(__spreadValues({}, l2.query), { f: "json" }), t2)), a2 = i$1V(u3, f2);
    return U$t(l2.path, a2).then(m$E).then((r2) => p$C(r2, i2.sublayers));
  });
}
function m$E(r2) {
  const e2 = r2.data;
  return e2.results = e2.results || [], e2.exceededTransferLimit = Boolean(e2.exceededTransferLimit), e2.results = e2.results.map((r3) => y$g.fromJSON(r3)), e2;
}
function a$q(r2) {
  return r2 = u$m.from(r2);
}
function p$C(r2, e2) {
  if (!(e2 == null ? void 0 : e2.length))
    return r2;
  const t2 = new Map();
  function o2(r3) {
    t2.set(r3.id, r3), r3.sublayers && r3.sublayers.forEach(o2);
  }
  e2.forEach(o2);
  for (const s2 of r2.results)
    s2.feature.sourceLayer = t2.get(s2.layerId);
  return r2;
}
var identify = /* @__PURE__ */ Object.freeze({
  __proto__: null,
  [Symbol.toStringTag]: "Module",
  identify: f$m
});
let c$w = class extends n$1l(t$X(b$y)) {
  constructor(r2) {
    super(r2), this.elevationInfo = null, this.graphics = new i$14(), this.screenSizePerspectiveEnabled = true, this.type = "graphics", this.internal = false;
  }
  destroy() {
    this.removeAll(), this.graphics.destroy();
  }
  add(r2) {
    return this.graphics.add(r2), this;
  }
  addMany(r2) {
    return this.graphics.addMany(r2), this;
  }
  removeAll() {
    return this.graphics.removeAll(), this;
  }
  remove(r2) {
    this.graphics.remove(r2);
  }
  removeMany(r2) {
    this.graphics.removeMany(r2);
  }
  on(r2, e2) {
    return super.on(r2, e2);
  }
  graphicChanged(r2) {
    this.emit("graphic-update", r2);
  }
};
e$2g([y$1I({ type: x$v })], c$w.prototype, "elevationInfo", void 0), e$2g([y$1I(a$Z(i$14, "graphics"))], c$w.prototype, "graphics", void 0), e$2g([y$1I({ type: ["show", "hide"] })], c$w.prototype, "listMode", void 0), e$2g([y$1I()], c$w.prototype, "screenSizePerspectiveEnabled", void 0), e$2g([y$1I({ readOnly: true })], c$w.prototype, "type", void 0), e$2g([y$1I({ constructOnly: true })], c$w.prototype, "internal", void 0), c$w = e$2g([n$2P("esri.layers.GraphicsLayer")], c$w);
const h$r = c$w;
const a$p = (n2, t2, e2) => [t2, e2], m$D = (n2, t2, e2) => [t2, e2, n2[2]], c$v = (n2, t2, e2) => [t2, e2, n2[2], n2[3]];
function s$v(t2) {
  if (!t2)
    return null;
  return { originPosition: t2.originPosition === "upper-left" ? "upperLeft" : t2.originPosition === "lower-left" ? "lowerLeft" : t2.originPosition, scale: t2.tolerance ? [t2.tolerance, t2.tolerance] : [1, 1], translate: r$1$(t2.extent) ? [t2.extent.xmin, t2.extent.ymax] : [0, 0] };
}
function x$g({ scale: n2, translate: t2 }, e2) {
  return Math.round((e2 - t2[0]) / n2[0]);
}
function h$q({ scale: n2, translate: t2 }, e2) {
  return Math.round((t2[1] - e2) / n2[1]);
}
function I$c(n2, t2, e2) {
  const r2 = [];
  let u2, i2, o2, l2;
  for (let a2 = 0; a2 < e2.length; a2++) {
    const m2 = e2[a2];
    a2 > 0 ? (o2 = x$g(n2, m2[0]), l2 = h$q(n2, m2[1]), o2 === u2 && l2 === i2 || (r2.push(t2(m2, o2 - u2, l2 - i2)), u2 = o2, i2 = l2)) : (u2 = x$g(n2, m2[0]), i2 = h$q(n2, m2[1]), r2.push(t2(m2, u2, i2)));
  }
  return r2.length > 0 ? r2 : null;
}
function p$B(n2, t2, e2, r2) {
  return I$c(n2, e2 ? r2 ? c$v : m$D : r2 ? m$D : a$p, t2);
}
function N$d(n2, t2, e2, r2) {
  const u2 = [], i2 = e2 ? r2 ? c$v : m$D : r2 ? m$D : a$p;
  for (let o2 = 0; o2 < t2.length; o2++) {
    const e3 = I$c(n2, i2, t2[o2]);
    e3 && e3.length >= 3 && u2.push(e3);
  }
  return u2.length ? u2 : null;
}
function y$f(n2, t2, e2, r2) {
  const u2 = [], i2 = e2 ? r2 ? c$v : m$D : r2 ? m$D : a$p;
  for (let o2 = 0; o2 < t2.length; o2++) {
    const e3 = I$c(n2, i2, t2[o2]);
    e3 && e3.length >= 2 && u2.push(e3);
  }
  return u2.length ? u2 : null;
}
function z$f({ scale: n2, translate: t2 }, e2) {
  return e2 * n2[0] + t2[0];
}
function T$c({ scale: n2, translate: t2 }, e2) {
  return t2[1] - e2 * n2[1];
}
function M$f(n2, t2, e2) {
  const r2 = new Array(e2.length);
  if (!e2.length)
    return r2;
  const [u2, i2] = n2.scale;
  let o2 = z$f(n2, e2[0][0]), l2 = T$c(n2, e2[0][1]);
  r2[0] = t2(e2[0], o2, l2);
  for (let a2 = 1; a2 < e2.length; a2++) {
    const n3 = e2[a2];
    o2 += n3[0] * u2, l2 -= n3[1] * i2, r2[a2] = t2(n3, o2, l2);
  }
  return r2;
}
function E$i(n2, t2, e2) {
  const r2 = new Array(e2.length);
  for (let u2 = 0; u2 < e2.length; u2++)
    r2[u2] = M$f(n2, t2, e2[u2]);
  return r2;
}
function b$g(n2, t2, e2, r2) {
  return M$f(n2, e2 ? r2 ? c$v : m$D : r2 ? m$D : a$p, t2);
}
function F$d(n2, t2, e2, r2) {
  return E$i(n2, e2 ? r2 ? c$v : m$D : r2 ? m$D : a$p, t2);
}
function V$b(n2, t2, e2, r2) {
  return E$i(n2, e2 ? r2 ? c$v : m$D : r2 ? m$D : a$p, t2);
}
function G$d(n2, t2, e2, r2, u2) {
  return t2.xmin = x$g(n2, e2.xmin), t2.ymin = h$q(n2, e2.ymin), t2.xmax = x$g(n2, e2.xmax), t2.ymax = h$q(n2, e2.ymax), t2 !== e2 && (r2 && (t2.zmin = e2.zmin, t2.zmax = e2.zmax), u2 && (t2.mmin = e2.mmin, t2.mmax = e2.mmax)), t2;
}
function L$7(n2, t2, e2, r2, u2) {
  var _a2;
  return t2.points = (_a2 = p$B(n2, e2.points, r2, u2)) != null ? _a2 : [], t2;
}
function O$d(n2, t2, e2, r2, u2) {
  return t2.x = x$g(n2, e2.x), t2.y = h$q(n2, e2.y), t2 !== e2 && (r2 && (t2.z = e2.z), u2 && (t2.m = e2.m)), t2;
}
function S$c(n2, t2, e2, r2, u2) {
  const i2 = N$d(n2, e2.rings, r2, u2);
  return i2 ? (t2.rings = i2, t2) : null;
}
function d$j(n2, t2, e2, r2, u2) {
  const i2 = y$f(n2, e2.paths, r2, u2);
  return i2 ? (t2.paths = i2, t2) : null;
}
function U$8(n2, t2) {
  return n2 && t2 ? s$29(t2) ? O$d(n2, {}, t2, false, false) : f$1H(t2) ? d$j(n2, {}, t2, false, false) : y$1t(t2) ? S$c(n2, {}, t2, false, false) : l$2t(t2) ? L$7(n2, {}, t2, false, false) : u$20(t2) ? G$d(n2, {}, t2, false, false) : null : null;
}
function q$b(t2, e2, r2, u2, i2) {
  return r$1$(r2) && (e2.points = b$g(t2, r2.points, u2, i2)), e2;
}
function v$i(n2, e2, r2, u2, i2) {
  return t$2r(r2) || (e2.x = z$f(n2, r2.x), e2.y = T$c(n2, r2.y), e2 !== r2 && (u2 && (e2.z = r2.z), i2 && (e2.m = r2.m))), e2;
}
function B$9(t2, e2, r2, u2, i2) {
  return r$1$(r2) && (e2.rings = V$b(t2, r2.rings, u2, i2)), e2;
}
function C$d(t2, e2, r2, u2, i2) {
  return r$1$(r2) && (e2.paths = F$d(t2, r2.paths, u2, i2)), e2;
}
function i$D(t2, r2) {
  return t2 === r2 || r$1$(t2) && r$1$(r2) && E$P(t2.spatialReference, r2.spatialReference) && t2.x === r2.x && t2.y === r2.y && t2.z === r2.z && t2.m === r2.m;
}
class j$c {
  constructor(e2, t2, s2) {
    this.uid = e2, this.geometry = t2, this.attributes = s2, this.visible = true, this.objectId = null, this.centroid = null;
  }
}
function M$e(e2) {
  return r$1$(e2.geometry);
}
class N$c {
  constructor() {
    this.exceededTransferLimit = false, this.features = [], this.fields = [], this.hasM = false, this.hasZ = false, this.geometryType = null, this.objectIdFieldName = null, this.globalIdFieldName = null, this.geometryProperties = null, this.geohashFieldName = null, this.spatialReference = null, this.transform = null;
  }
}
function v$h(e2, t2, s2, r2) {
  return { x: e2, y: t2, z: s2, hasZ: s2 != null, hasM: false, spatialReference: r2, type: "point" };
}
function w$e(e2) {
  if (t$2r(e2))
    return 0;
  switch (e2.type) {
    case "point":
      return 1;
    case "polyline": {
      let t2 = 0;
      for (const s2 of e2.paths)
        t2 += s2.length;
      return t2;
    }
    case "polygon": {
      let t2 = 0;
      for (const s2 of e2.rings)
        t2 += s2.length;
      return t2;
    }
    case "multipoint":
      return e2.points.length;
    case "extent":
      return 2;
    case "mesh": {
      const t2 = e2.vertexAttributes && e2.vertexAttributes.position;
      return t2 ? t2.length / 3 : 0;
    }
    default:
      return;
  }
}
function T$b(e2, t2) {
  switch (A$u(t2), e2.type === "mesh" && (e2 = e2.extent), e2.type) {
    case "point":
      t2[0] = t2[3] = e2.x, t2[1] = t2[4] = e2.y, e2.hasZ && (t2[2] = t2[5] = e2.z);
      break;
    case "polyline":
      for (let s2 = 0; s2 < e2.paths.length; s2++)
        s$1T(t2, e2.paths[s2], e2.hasZ);
      break;
    case "polygon":
      for (let s2 = 0; s2 < e2.rings.length; s2++)
        s$1T(t2, e2.rings[s2], e2.hasZ);
      break;
    case "multipoint":
      s$1T(t2, e2.points, e2.hasZ);
      break;
    case "extent":
      t2[0] = e2.xmin, t2[1] = e2.ymin, t2[3] = e2.xmax, t2[4] = e2.ymax, e2.zmin != null && (t2[2] = e2.zmin), e2.zmax != null && (t2[5] = e2.zmax);
  }
}
function J$c(e2, t2) {
  switch (D$u(t2), e2.type === "mesh" && (e2 = e2.extent), e2.type) {
    case "point":
      t2[0] = t2[2] = e2.x, t2[1] = t2[3] = e2.y;
      break;
    case "polyline":
      for (let s2 = 0; s2 < e2.paths.length; s2++)
        x$Q(t2, e2.paths[s2]);
      break;
    case "polygon":
      for (let s2 = 0; s2 < e2.rings.length; s2++)
        x$Q(t2, e2.rings[s2]);
      break;
    case "multipoint":
      x$Q(t2, e2.points);
      break;
    case "extent":
      t2[0] = e2.xmin, t2[1] = e2.ymin, t2[2] = e2.xmax, t2[3] = e2.ymax;
  }
}
function O$c(e2, t2) {
  return e2.objectId != null ? e2.objectId : e2.attributes && t2 ? e2.attributes[t2] : null;
}
a$2p();
u$1O();
var e$k, n$w, i$C, t$r, o$p, r$u, l$v, a$o, u$l, c$u, d$i, f$l, s$u, p$A, g$g, C$c, m$C, T$a, S$b, P$b, R$b, B$8, N$b, h$p, O$b, L$6, M$d, A$a, y$e, E$h, D$9, F$c, v$g, x$f, W$6, U$7, k$c, H$7, b$f, w$d, I$b, G$c, q$a, J$b, X$7, Y$6, Z$8, K$7, Q$7, V$a, j$b, z$e, $$4, _$c, ee$2, ne$1, ie$2, te$2, oe$2, re$2, le$1;
!function(e2) {
  e2[e2.BUTT = 0] = "BUTT", e2[e2.ROUND = 1] = "ROUND", e2[e2.SQUARE = 2] = "SQUARE", e2[e2.UNKNOWN = 4] = "UNKNOWN";
}(e$k || (e$k = {})), function(e2) {
  e2[e2.BEVEL = 0] = "BEVEL", e2[e2.ROUND = 1] = "ROUND", e2[e2.MITER = 2] = "MITER", e2[e2.UNKNOWN = 4] = "UNKNOWN";
}(n$w || (n$w = {})), function(e2) {
  e2[e2.SCREEN = 0] = "SCREEN", e2[e2.MAP = 1] = "MAP";
}(i$C || (i$C = {})), function(e2) {
  e2[e2.Tint = 0] = "Tint", e2[e2.Ignore = 1] = "Ignore", e2[e2.Multiply = 99] = "Multiply";
}(t$r || (t$r = {})), function(e2) {
  e2.Both = "Both", e2.JustBegin = "JustBegin", e2.JustEnd = "JustEnd", e2.None = "None";
}(o$p || (o$p = {})), function(e2) {
  e2[e2.Mosaic = 0] = "Mosaic", e2[e2.Centered = 1] = "Centered";
}(r$u || (r$u = {})), function(e2) {
  e2[e2.Normal = 0] = "Normal", e2[e2.Superscript = 1] = "Superscript", e2[e2.Subscript = 2] = "Subscript";
}(l$v || (l$v = {})), function(e2) {
  e2[e2.MSSymbol = 0] = "MSSymbol", e2[e2.Unicode = 1] = "Unicode";
}(a$o || (a$o = {})), function(e2) {
  e2[e2.Unspecified = 0] = "Unspecified", e2[e2.TrueType = 1] = "TrueType", e2[e2.PSOpenType = 2] = "PSOpenType", e2[e2.TTOpenType = 3] = "TTOpenType", e2[e2.Type1 = 4] = "Type1";
}(u$l || (u$l = {})), function(e2) {
  e2[e2.Display = 0] = "Display", e2[e2.Map = 1] = "Map";
}(c$u || (c$u = {})), function(e2) {
  e2.None = "None", e2.Loop = "Loop", e2.Oscillate = "Oscillate";
}(d$i || (d$i = {})), function(e2) {
  e2[e2.Z = 0] = "Z", e2[e2.X = 1] = "X", e2[e2.Y = 2] = "Y";
}(f$l || (f$l = {})), function(e2) {
  e2[e2.XYZ = 0] = "XYZ", e2[e2.ZXY = 1] = "ZXY", e2[e2.YXZ = 2] = "YXZ";
}(s$u || (s$u = {})), function(e2) {
  e2[e2.Rectangle = 0] = "Rectangle", e2[e2.RoundedRectangle = 1] = "RoundedRectangle", e2[e2.Oval = 2] = "Oval";
}(p$A || (p$A = {})), function(e2) {
  e2[e2.None = 0] = "None", e2[e2.Alpha = 1] = "Alpha", e2[e2.Screen = 2] = "Screen", e2[e2.Multiply = 3] = "Multiply", e2[e2.Add = 4] = "Add";
}(g$g || (g$g = {})), function(e2) {
  e2[e2.TTB = 0] = "TTB", e2[e2.RTL = 1] = "RTL", e2[e2.BTT = 2] = "BTT";
}(C$c || (C$c = {})), function(e2) {
  e2[e2.None = 0] = "None", e2[e2.SignPost = 1] = "SignPost", e2[e2.FaceNearPlane = 2] = "FaceNearPlane";
}(m$C || (m$C = {})), function(e2) {
  e2[e2.Float = 0] = "Float", e2[e2.String = 1] = "String", e2[e2.Boolean = 2] = "Boolean";
}(T$a || (T$a = {})), function(e2) {
  e2[e2.Intersect = 0] = "Intersect", e2[e2.Subtract = 1] = "Subtract";
}(S$b || (S$b = {})), function(e2) {
  e2.OpenEnded = "OpenEnded", e2.Block = "Block", e2.Crossed = "Crossed";
}(P$b || (P$b = {})), function(e2) {
  e2.FullGeometry = "FullGeometry", e2.PerpendicularFromFirstSegment = "PerpendicularFromFirstSegment", e2.ReversedFirstSegment = "ReversedFirstSegment", e2.PerpendicularToSecondSegment = "PerpendicularToSecondSegment", e2.SecondSegmentWithTicks = "SecondSegmentWithTicks", e2.DoublePerpendicular = "DoublePerpendicular", e2.OppositeToFirstSegment = "OppositeToFirstSegment", e2.TriplePerpendicular = "TriplePerpendicular", e2.HalfCircleFirstSegment = "HalfCircleFirstSegment", e2.HalfCircleSecondSegment = "HalfCircleSecondSegment", e2.HalfCircleExtended = "HalfCircleExtended", e2.OpenCircle = "OpenCircle", e2.CoverageEdgesWithTicks = "CoverageEdgesWithTicks", e2.GapExtentWithDoubleTicks = "GapExtentWithDoubleTicks", e2.GapExtentMidline = "GapExtentMidline", e2.Chevron = "Chevron", e2.PerpendicularWithArc = "PerpendicularWithArc", e2.ClosedHalfCircle = "ClosedHalfCircle", e2.TripleParallelExtended = "TripleParallelExtended", e2.ParallelWithTicks = "ParallelWithTicks", e2.Parallel = "Parallel", e2.PerpendicularToFirstSegment = "PerpendicularToFirstSegment", e2.ParallelOffset = "ParallelOffset", e2.OffsetOpposite = "OffsetOpposite", e2.OffsetSame = "OffsetSame", e2.CircleWithArc = "CircleWithArc", e2.DoubleJog = "DoubleJog", e2.PerpendicularOffset = "PerpendicularOffset", e2.LineExcludingLastSegment = "LineExcludingLastSegment", e2.MultivertexArrow = "MultivertexArrow", e2.CrossedArrow = "CrossedArrow", e2.ChevronArrow = "ChevronArrow", e2.ChevronArrowOffset = "ChevronArrowOffset", e2.PartialFirstSegment = "PartialFirstSegment", e2.Arch = "Arch", e2.CurvedParallelTicks = "CurvedParallelTicks", e2.Arc90Degrees = "Arc90Degrees";
}(R$b || (R$b = {})), function(e2) {
  e2.Mitered = "Mitered", e2.Bevelled = "Bevelled", e2.Rounded = "Rounded", e2.Square = "Square", e2.TrueBuffer = "TrueBuffer";
}(B$8 || (B$8 = {})), function(e2) {
  e2.ClosePath = "ClosePath", e2.ConvexHull = "ConvexHull", e2.RectangularBox = "RectangularBox";
}(N$b || (N$b = {})), function(e2) {
  e2.BeginningOfLine = "BeginningOfLine", e2.EndOfLine = "EndOfLine";
}(h$p || (h$p = {})), function(e2) {
  e2.Mitered = "Mitered", e2.Bevelled = "Bevelled", e2.Rounded = "Rounded", e2.Square = "Square";
}(O$b || (O$b = {})), function(e2) {
  e2.Fast = "Fast", e2.Accurate = "Accurate";
}(L$6 || (L$6 = {})), function(e2) {
  e2.BeginningOfLine = "BeginningOfLine", e2.EndOfLine = "EndOfLine";
}(M$d || (M$d = {})), function(e2) {
  e2.Sinus = "Sinus", e2.Square = "Square", e2.Triangle = "Triangle", e2.Random = "Random";
}(A$a || (A$a = {})), function(e2) {
  e2[e2.None = 0] = "None", e2[e2.Default = 1] = "Default", e2[e2.Force = 2] = "Force";
}(y$e || (y$e = {})), function(e2) {
  e2[e2.Buffered = 0] = "Buffered", e2[e2.Left = 1] = "Left", e2[e2.Right = 2] = "Right", e2[e2.AlongLine = 3] = "AlongLine";
}(E$h || (E$h = {})), function(e2) {
  e2[e2.Linear = 0] = "Linear", e2[e2.Rectangular = 1] = "Rectangular", e2[e2.Circular = 2] = "Circular", e2[e2.Buffered = 3] = "Buffered";
}(D$9 || (D$9 = {})), function(e2) {
  e2[e2.Discrete = 0] = "Discrete", e2[e2.Continuous = 1] = "Continuous";
}(F$c || (F$c = {})), function(e2) {
  e2[e2.AcrossLine = 0] = "AcrossLine", e2[e2.AloneLine = 1] = "AloneLine";
}(v$g || (v$g = {})), function(e2) {
  e2[e2.Left = 0] = "Left", e2[e2.Right = 1] = "Right", e2[e2.Center = 2] = "Center", e2[e2.Justify = 3] = "Justify";
}(x$f || (x$f = {})), function(e2) {
  e2[e2.Base = 0] = "Base", e2[e2.MidPoint = 1] = "MidPoint", e2[e2.ThreePoint = 2] = "ThreePoint", e2[e2.FourPoint = 3] = "FourPoint", e2[e2.Underline = 4] = "Underline", e2[e2.CircularCW = 5] = "CircularCW", e2[e2.CircularCCW = 6] = "CircularCCW";
}(W$6 || (W$6 = {})), function(e2) {
  e2.Butt = "Butt", e2.Round = "Round", e2.Square = "Square";
}(U$7 || (U$7 = {})), function(e2) {
  e2.NoConstraint = "NoConstraint", e2.HalfPattern = "HalfPattern", e2.HalfGap = "HalfGap", e2.FullPattern = "FullPattern", e2.FullGap = "FullGap", e2.Custom = "Custom";
}(k$c || (k$c = {})), function(e2) {
  e2[e2.None = -1] = "None", e2[e2.Custom = 0] = "Custom", e2[e2.Circle = 1] = "Circle", e2[e2.OpenArrow = 2] = "OpenArrow", e2[e2.ClosedArrow = 3] = "ClosedArrow", e2[e2.Diamond = 4] = "Diamond";
}(H$7 || (H$7 = {})), function(e2) {
  e2[e2.ExtraLeading = 0] = "ExtraLeading", e2[e2.Multiple = 1] = "Multiple", e2[e2.Exact = 2] = "Exact";
}(b$f || (b$f = {})), function(e2) {
  e2.Bevel = "Bevel", e2.Round = "Round", e2.Miter = "Miter";
}(w$d || (w$d = {})), function(e2) {
  e2[e2.Default = 0] = "Default", e2[e2.String = 1] = "String", e2[e2.Numeric = 2] = "Numeric";
}(I$b || (I$b = {})), function(e2) {
  e2[e2.InsidePolygon = 0] = "InsidePolygon", e2[e2.PolygonCenter = 1] = "PolygonCenter", e2[e2.RandomlyInsidePolygon = 2] = "RandomlyInsidePolygon";
}(G$c || (G$c = {})), function(e2) {
  e2[e2.Tint = 0] = "Tint", e2[e2.Replace = 1] = "Replace", e2[e2.Multiply = 2] = "Multiply";
}(q$a || (q$a = {})), function(e2) {
  e2[e2.ClipAtBoundary = 0] = "ClipAtBoundary", e2[e2.RemoveIfCenterOutsideBoundary = 1] = "RemoveIfCenterOutsideBoundary", e2[e2.DoNotTouchBoundary = 2] = "DoNotTouchBoundary", e2[e2.DoNotClip = 3] = "DoNotClip";
}(J$b || (J$b = {})), function(e2) {
  e2.NoConstraint = "NoConstraint", e2.WithMarkers = "WithMarkers", e2.WithFullGap = "WithFullGap", e2.WithHalfGap = "WithHalfGap", e2.Custom = "Custom";
}(X$7 || (X$7 = {})), function(e2) {
  e2.Fixed = "Fixed", e2.Random = "Random", e2.RandomFixedQuantity = "RandomFixedQuantity";
}(Y$6 || (Y$6 = {})), function(e2) {
  e2.LineMiddle = "LineMiddle", e2.LineBeginning = "LineBeginning", e2.LineEnd = "LineEnd", e2.SegmentMidpoint = "SegmentMidpoint";
}(Z$8 || (Z$8 = {})), function(e2) {
  e2.OnPolygon = "OnPolygon", e2.CenterOfMass = "CenterOfMass", e2.BoundingBoxCenter = "BoundingBoxCenter";
}(K$7 || (K$7 = {})), function(e2) {
  e2[e2.Low = 0] = "Low", e2[e2.Medium = 1] = "Medium", e2[e2.High = 2] = "High";
}(Q$7 || (Q$7 = {})), function(e2) {
  e2[e2.MarkerCenter = 0] = "MarkerCenter", e2[e2.MarkerBounds = 1] = "MarkerBounds";
}(V$a || (V$a = {})), function(e2) {
  e2[e2.None = 0] = "None", e2[e2.PropUniform = 1] = "PropUniform", e2[e2.PropNonuniform = 2] = "PropNonuniform", e2[e2.DifUniform = 3] = "DifUniform", e2[e2.DifNonuniform = 4] = "DifNonuniform";
}(j$b || (j$b = {})), function(e2) {
  e2.Tube = "Tube", e2.Strip = "Strip", e2.Wall = "Wall";
}(z$e || (z$e = {})), function(e2) {
  e2[e2.Random = 0] = "Random", e2[e2.Increasing = 1] = "Increasing", e2[e2.Decreasing = 2] = "Decreasing", e2[e2.IncreasingThenDecreasing = 3] = "IncreasingThenDecreasing";
}($$4 || ($$4 = {})), function(e2) {
  e2[e2.Relative = 0] = "Relative", e2[e2.Absolute = 1] = "Absolute";
}(_$c || (_$c = {})), function(e2) {
  e2[e2.Normal = 0] = "Normal", e2[e2.LowerCase = 1] = "LowerCase", e2[e2.Allcaps = 2] = "Allcaps";
}(ee$2 || (ee$2 = {})), function(e2) {
  e2[e2.LTR = 0] = "LTR", e2[e2.RTL = 1] = "RTL";
}(ne$1 || (ne$1 = {})), function(e2) {
  e2.Draft = "Draft", e2.Picture = "Picture", e2.Text = "Text";
}(ie$2 || (ie$2 = {})), function(e2) {
  e2[e2.Top = 0] = "Top", e2[e2.Center = 1] = "Center", e2[e2.Baseline = 2] = "Baseline", e2[e2.Bottom = 3] = "Bottom";
}(te$2 || (te$2 = {})), function(e2) {
  e2[e2.Right = 0] = "Right", e2[e2.Upright = 1] = "Upright";
}(oe$2 || (oe$2 = {})), function(e2) {
  e2[e2.Small = 0] = "Small", e2[e2.Medium = 1] = "Medium", e2[e2.Large = 2] = "Large";
}(re$2 || (re$2 = {})), function(e2) {
  e2[e2.Calm = 0] = "Calm", e2[e2.Rippled = 1] = "Rippled", e2[e2.Slight = 2] = "Slight", e2[e2.Moderate = 3] = "Moderate";
}(le$1 || (le$1 = {}));
const o$o = { main: new l$2e([255, 127, 0]), selected: new l$2e([255, 255, 255]), outline: new l$2e([0, 0, 0, 0.5]), selectedOutline: new l$2e([255, 255, 255]), hoverOutline: new l$2e([255, 255, 255]), secondary: new l$2e([255, 255, 255]), secondaryOutline: new l$2e([100, 100, 100]), transparent: new l$2e([0, 0, 0, 0]) };
function t$q(e2, o2) {
  if (o2)
    for (const t2 in o2)
      e2[t2] = o2[t2];
}
class s$t {
  constructor(e2) {
    this.size = 8, this.hoverSize = 10, this.color = o$o.main, this.hoverColor = o$o.main, this.outlineColor = o$o.outline, this.hoverOutlineColor = o$o.hoverOutline, t$q(this, e2);
  }
}
class n$v {
  constructor(e2) {
    this.color = o$o.secondary, this.hoverColor = o$o.main, t$q(this, e2);
  }
}
class r$t {
  constructor(e2) {
    this.color = o$o.transparent, this.hoverColor = o$o.transparent, this.outlineColor = o$o.main, this.hoverOutlineColor = o$o.main, this.stagedColor = o$o.transparent, this.stagedOutlineColor = o$o.secondary, t$q(this, e2);
  }
}
class i$B {
  constructor(e2) {
    this.vertex = new s$t(), this.midpoint = new s$t({ color: o$o.secondary, outlineColor: o$o.secondaryOutline, size: 6 }), this.selected = new s$t({ color: o$o.selected, hoverColor: o$o.selected, hoverOutlineColor: o$o.hoverOutline }), t$q(this, e2);
  }
}
class l$u {
  constructor(e2) {
    this.center = new s$t({ color: o$o.secondaryOutline }), this.fill = new r$t(), this.line = new n$v(), this.vertex = new s$t({ color: o$o.selected, outlineColor: o$o.main, hoverColor: o$o.selected, hoverOutlineColor: o$o.secondaryOutline }), t$q(this, e2);
  }
}
class c$t {
  constructor(e2) {
    this.reshapeGraphics = new i$B(), this.transformGraphics = new l$u(), t$q(this, e2);
  }
}
const h$o = new c$t();
let r$s = class extends l$2B {
  constructor() {
    super(...arguments), this.enabled = true;
  }
};
e$2g([y$1I({ type: Boolean })], r$s.prototype, "enabled", void 0), r$s = e$2g([n$2P("esri.views.interactive.snapping.Settings.DefaultSnappingAlgorithm")], r$s);
let l$t = class extends l$2B {
  constructor(e2) {
    super(e2), this.lineSnapper = new r$s(), this.parallelLineSnapper = new r$s(), this.rightAngleSnapper = new r$s(), this.rightAngleTriangleSnapper = new r$s(), this.shortLineThreshold = 15, this.distance = 5, this.pointThreshold = 1e-6, this.intersectionParallelLineThreshold = 1e-6, this.parallelLineThreshold = 1e-6, this.touchSensitivityMultiplier = 1.5, this.pointOnLineThreshold = 1e-6, this.orange = new l$2e([255, 127, 0]), this.lineHintWidthReference = 3, this.lineHintWidthTarget = 3, this.lineHintFadedExtensions = 0.3, this.parallelLineHintWidth = 2, this.parallelLineHintLength = 24, this.parallelLineHintOffset = 1.5, this.rightAngleHintSize = 24, this.rightAngleHintOutlineSize = 1.5;
  }
};
e$2g([y$1I({ type: r$s, constructOnly: true, nonNullable: true, json: { write: true } })], l$t.prototype, "lineSnapper", void 0), e$2g([y$1I({ type: r$s, constructOnly: true, nonNullable: true, json: { write: true } })], l$t.prototype, "parallelLineSnapper", void 0), e$2g([y$1I({ type: r$s, constructOnly: true, nonNullable: true, json: { write: true } })], l$t.prototype, "rightAngleSnapper", void 0), e$2g([y$1I({ type: r$s, constructOnly: true, nonNullable: true, json: { write: true } })], l$t.prototype, "rightAngleTriangleSnapper", void 0), e$2g([y$1I({ type: Number, nonNullable: true, range: { min: -1, max: 50, step: 1 }, json: { write: true } })], l$t.prototype, "shortLineThreshold", void 0), e$2g([y$1I({ type: Number, nonNullable: true, range: { min: -1, max: 50, step: 1 }, json: { write: true } })], l$t.prototype, "distance", void 0), e$2g([y$1I({ type: Number, nonNullable: true, range: { min: 0, max: 1e-5 }, json: { write: true } })], l$t.prototype, "pointThreshold", void 0), e$2g([y$1I({ type: Number, nonNullable: true, range: { min: 0, max: 1e-5 }, json: { write: true } })], l$t.prototype, "intersectionParallelLineThreshold", void 0), e$2g([y$1I({ type: Number, nonNullable: true, range: { min: 0, max: 1e-5 }, json: { write: true } })], l$t.prototype, "parallelLineThreshold", void 0), e$2g([y$1I({ type: Number, nonNullable: true, range: { min: 0, max: 10 }, json: { write: true } })], l$t.prototype, "touchSensitivityMultiplier", void 0), e$2g([y$1I({ type: Number, nonNullable: true, range: { min: 0, max: 1e-5 }, json: { write: true } })], l$t.prototype, "pointOnLineThreshold", void 0), e$2g([y$1I({ type: l$2e, nonNullable: true })], l$t.prototype, "orange", void 0), e$2g([y$1I({ type: Number, nonNullable: true, range: { min: 0, max: 10 }, json: { write: true } })], l$t.prototype, "lineHintWidthReference", void 0), e$2g([y$1I({ type: Number, nonNullable: true, range: { min: 0, max: 10 }, json: { write: true } })], l$t.prototype, "lineHintWidthTarget", void 0), e$2g([y$1I({ type: Number, nonNullable: true, range: { min: 0, max: 1 }, json: { write: true } })], l$t.prototype, "lineHintFadedExtensions", void 0), e$2g([y$1I({ type: Number, nonNullable: true, range: { min: 0, max: 10 }, json: { write: true } })], l$t.prototype, "parallelLineHintWidth", void 0), e$2g([y$1I({ type: Number, nonNullable: true, range: { min: 0, max: 50 }, json: { write: true } })], l$t.prototype, "parallelLineHintLength", void 0), e$2g([y$1I({ type: Number, nonNullable: true, range: { min: 0, max: 5 }, json: { write: true } })], l$t.prototype, "parallelLineHintOffset", void 0), e$2g([y$1I({ type: Number, nonNullable: true, range: { min: 0, max: 46 }, json: { write: true } })], l$t.prototype, "rightAngleHintSize", void 0), e$2g([y$1I({ type: Number, nonNullable: true, range: { min: 0, max: 6 }, json: { write: true } })], l$t.prototype, "rightAngleHintOutlineSize", void 0), l$t = e$2g([n$2P("esri.views.interactive.snapping.Settings.Defaults")], l$t);
const p$z = new l$t();
var E$g;
!function(E2) {
  E2[E2.FEATURE = 1] = "FEATURE", E2[E2.SELF = 2] = "SELF", E2[E2.ALL = 3] = "ALL";
}(E$g || (E$g = {}));
function r$r(e2) {
  return e2 ? E$f : Z$7;
}
function u$k(t2, n2) {
  return t$2r(n2) || !n2.mode ? r$r(t2).mode : n2.mode;
}
function s$s(e2, n2) {
  return r$1$(n2) ? n2 : r$r(e2);
}
function i$A(e2, n2) {
  return u$k(!!r$1$(e2) && e2.hasZ, n2);
}
function a$n(e2, n2) {
  return s$s(!!r$1$(e2) && e2.hasZ, n2);
}
function l$s(e2) {
  const t2 = v$f(e2);
  return i$A(e2.geometry, t2);
}
function f$k(e2) {
  const r2 = v$f(e2), u2 = i$A(e2.geometry, r2);
  return { mode: u2, offset: r$1$(r2) && u2 !== "on-the-ground" ? i$3f(r2.offset, 0) * r$10(i$3f(r2.unit, "meters")) : 0 };
}
function c$s(e2) {
  if (l$s(e2) === "on-the-ground")
    return false;
  const n2 = v$f(e2), o2 = r$1$(n2) && n2.featureExpressionInfo ? n2.featureExpressionInfo.expression : null;
  return !(!o2 || o2 === "0");
}
function v$f(e2) {
  return e2.layer && "elevationInfo" in e2.layer ? e2.layer.elevationInfo : null;
}
function d$h(o2, r2, u2) {
  if (t$2r(u2) || !u2.mode)
    return;
  const s2 = o2.hasZ ? o2.z : 0, i2 = r$1$(u2.offset) ? u2.offset : 0;
  switch (u2.mode) {
    case "absolute-height":
      return s2 - i2;
    case "on-the-ground":
      return 0;
    case "relative-to-ground":
      return s2 - (i$3f(r2.elevationProvider.getElevation(o2.x, o2.y, o2.z, o2.spatialReference, "ground"), 0) + i2);
    case "relative-to-scene":
      return s2 - (i$3f(r2.elevationProvider.getElevation(o2.x, o2.y, o2.z, o2.spatialReference, "scene"), 0) + i2);
  }
}
function g$f(e2, t2, n2, o2 = null) {
  return m$B(e2, t2.x, t2.y, t2.hasZ ? t2.z : 0, t2.spatialReference, n2, o2);
}
function h$n(e2, t2, n2, o2, r2 = null) {
  return m$B(e2, t2[0], t2[1], t2.length > 2 ? t2[2] : 0, n2, o2, r2);
}
function m$B(n2, o2, r2, u2, s2, i2, a2 = null) {
  if (t$2r(i2))
    return;
  const l2 = r$1$(a2) ? a2.mode : "absolute-height";
  if (l2 === "on-the-ground")
    return 0;
  const { absoluteZ: f2 } = b$e(o2, r2, u2, s2, n2, i2);
  return p$y(f2, o2, r2, u2, s2, n2, a2, l2);
}
function b$e(e2, o2, r2, u2, s2, i2) {
  const a2 = r$1$(i2.offset) ? i2.offset : 0;
  switch (i2.mode) {
    case "absolute-height":
      return { absoluteZ: r2 + a2, elevation: 0 };
    case "on-the-ground": {
      const t2 = i$3f(s2.elevationProvider.getElevation(e2, o2, 0, u2, "ground"), 0);
      return { absoluteZ: t2, elevation: t2 };
    }
    case "relative-to-ground": {
      const t2 = i$3f(s2.elevationProvider.getElevation(e2, o2, r2, u2, "ground"), 0);
      return { absoluteZ: r2 + t2 + a2, elevation: t2 };
    }
    case "relative-to-scene": {
      const t2 = i$3f(s2.elevationProvider.getElevation(e2, o2, r2, u2, "scene"), 0);
      return { absoluteZ: r2 + t2 + a2, elevation: t2 };
    }
  }
}
function p$y(e2, o2, r2, u2, s2, i2, a2, l2) {
  const f2 = r$1$(a2) && r$1$(a2.offset) ? a2.offset : 0;
  switch (l2) {
    case "absolute-height":
      return e2 - f2;
    case "relative-to-ground":
      return e2 - (i$3f(i2.elevationProvider.getElevation(o2, r2, u2, s2, "ground"), 0) + f2);
    case "relative-to-scene":
      return e2 - (i$3f(i2.elevationProvider.getElevation(o2, r2, u2, s2, "scene"), 0) + f2);
  }
}
function y$d(n2, o2) {
  if (t$2r(o2))
    return false;
  const { mode: r2 } = o2;
  return r$1$(r2) && (n2 === "scene" && r2 === "relative-to-scene" || n2 === "ground" && r2 !== "absolute-height");
}
const E$f = { mode: "absolute-height", offset: 0 }, Z$7 = { mode: "on-the-ground", offset: null };
function x$e(e2, n2) {
  return e2 === n2 || r$1$(e2) && r$1$(n2) && e2.mode === n2.mode && e2.offset === n2.offset;
}
function i$z(t2, e2) {
  const n2 = t2.length === e2.length && t2[0] === e2[0] && t2[1] === e2[1];
  switch (t2.length) {
    case 2:
      return n2;
    case 3:
      return n2 && t2[2] === e2[2];
    case 4:
      return n2 && t2[2] === e2[2] && t2[3] === e2[3];
  }
  return false;
}
function u$j(t2, e2) {
  const n2 = t2.x - e2.x, r2 = t2.y - e2.y;
  return n2 * n2 + r2 * r2;
}
function E$e(t2, e2) {
  return Math.sqrt(u$j(t2, e2));
}
function a$m(t2, e2, r2) {
  const o2 = r2.toXYZ(t2, f$j);
  e2.sort((t3, e3) => {
    const c2 = r2.toXYZ(t3.targetPoint, p$x), s2 = p$37(c2, o2), i2 = r2.toXYZ(e3.targetPoint, p$x);
    return s2 - p$37(i2, o2);
  });
}
const f$j = n$2v(), p$x = n$2v();
var l$r;
function h$m(e2, n2) {
  return { point: e2.coordinateHelper.vectorToPoint(e2.point).toJSON(), distance: e2.distance, types: e2.types, query: r$1$(n2) ? n2.toJSON() : { where: "1=1" } };
}
function R$a(t2, n2, r2, s2) {
  const { coordinateHelper: i2, elevationInfo: u2 } = r2;
  if (!i2.hasZ() || t$2r(n2) || n2.type !== "3d" || t$2r(t2) || x$e(u2, s2))
    return t2;
  const E2 = h$n(n2, t2, i2.spatialReference, u2, s2), a2 = i2.clone(t2);
  return a2[2] = E2, a2;
}
function N$a(t2, e2, n2, r2 = E$f) {
  return { left: R$a(t2.leftVertex.pos, e2, n2, r2), right: R$a(t2.rightVertex.pos, e2, n2, r2) };
}
function m$A(t2) {
  return t2.createQuery();
}
!function(t2) {
  t2[t2.TARGET = 0] = "TARGET", t2[t2.REFERENCE = 1] = "REFERENCE", t2[t2.REFERENCE_EXTENSION = 2] = "REFERENCE_EXTENSION";
}(l$r || (l$r = {}));
class o$n {
  constructor(o2, t2) {
    this.elevationInfo = o2, this.domain = t2;
  }
}
class o$m extends o$n {
  constructor(t2, i2, o2 = E$g.ALL) {
    super(i2, o2), this.intersectionPoint = t2;
  }
  equals(n2) {
    return n2 instanceof o$m && i$z(this.intersectionPoint, n2.intersectionPoint);
  }
}
class s$r extends o$n {
  constructor(i2, e2, s2, n2, r2 = E$g.ALL, a2 = true, o2 = true) {
    super(n2, r2), this.type = i2, this.lineStart = e2, this.lineEnd = s2, this.fadeLeft = a2, this.fadeRight = o2;
  }
  equals(t2) {
    return t2 instanceof s$r && (this.type === t2.type && i$z(this.lineStart, t2.lineStart) && i$z(this.lineEnd, t2.lineEnd) && this.fadeLeft === t2.fadeLeft && this.fadeRight === t2.fadeRight);
  }
}
class r$q extends o$n {
  constructor(i2, n2, r2, s2 = E$g.ALL) {
    super(r2, s2), this.lineStart = i2, this.lineEnd = n2;
  }
  equals(t2) {
    return t2 instanceof r$q && (i$z(this.lineStart, t2.lineStart) && i$z(this.lineEnd, t2.lineEnd));
  }
}
class s$q extends o$n {
  constructor(t2, n2, s2) {
    super(n2, s2), this.point = t2;
  }
  equals(n2) {
    return n2 instanceof s$q && i$z(this.point, n2.point);
  }
}
class s$p extends o$n {
  constructor(t2, r2, s2, i2, n2 = E$g.ALL) {
    super(i2, n2), this.previousVertex = t2, this.centerVertex = r2, this.nextVertex = s2;
  }
  equals(e2) {
    return e2 instanceof s$p && (i$z(this.previousVertex, e2.previousVertex) && i$z(this.centerVertex, e2.centerVertex) && i$z(this.nextVertex, e2.nextVertex));
  }
}
class r$p {
  draw(r2, a2) {
    const p2 = this._getUniqueHints(r2), h2 = [];
    for (const i2 of p2)
      i2 instanceof o$m && h2.push(this.visualizeIntersectionPoint(i2, a2)), i2 instanceof s$r && h2.push(this.visualizeLine(i2, a2)), i2 instanceof r$q && h2.push(this.visualizeParallelSign(i2, a2)), i2 instanceof s$p && h2.push(this.visualizeRightAngleQuad(i2, a2)), i2 instanceof s$q && h2.push(this.visualizePoint(i2, a2));
    return r$1X(h2);
  }
  _getUniqueHints(i2) {
    const n2 = [];
    for (const t2 of i2) {
      let i3 = true;
      for (const s2 of n2)
        if (t2.equals(s2)) {
          i3 = false;
          break;
        }
      i3 && n2.push(t2);
    }
    return n2;
  }
}
class g$e extends r$p {
  constructor(e2) {
    super(), this._graphicsLayer = e2;
  }
  visualizeIntersectionPoint(e2, r2) {
    return this._visualizeSnappingIndicator(new w$_({ x: e2.intersectionPoint[0], y: e2.intersectionPoint[1], spatialReference: r2.coordinateHelper.spatialReference }), f$i);
  }
  visualizePoint(e2, r2) {
    return this._visualizeSnappingIndicator(new w$_({ x: e2.point[0], y: e2.point[1], spatialReference: r2.coordinateHelper.spatialReference }), I$a);
  }
  visualizeLine(e2, r2) {
    return this._visualizeSnappingIndicator(new m$2i({ paths: [[e2.lineStart, e2.lineEnd]], spatialReference: r2.coordinateHelper.spatialReference }), P$a);
  }
  visualizeParallelSign(e2, r2) {
    return this._visualizeSnappingIndicator(new m$2i({ paths: [[e2.lineStart, e2.lineEnd]], spatialReference: r2.coordinateHelper.spatialReference }), x$d);
  }
  visualizeRightAngleQuad(e2, r2) {
    return this._visualizeSnappingIndicator(new m$2i({ paths: [[e2.previousVertex, e2.centerVertex, e2.nextVertex]], spatialReference: r2.coordinateHelper.spatialReference }), z$d(e2));
  }
  _visualizeSnappingIndicator(i2, t2) {
    const n2 = new g$10({ geometry: i2, symbol: t2 });
    return this._graphicsLayer.add(n2), n$2U(() => {
      this._graphicsLayer.remove(n2);
    });
  }
}
const u$i = o$o.main.toArray(), M$c = [...o$o.main.toRgb(), 100], f$i = new y$1f({ outline: new m$25({ width: 1.5, color: u$i }), size: 15, color: [0, 0, 0, 0] }), I$a = new y$1f({ outline: { width: 0.5, color: [0, 0, 0, 1] }, size: 10, color: u$i }), P$a = new d$1H({ data: { type: "CIMSymbolReference", symbol: { type: "CIMLineSymbol", symbolLayers: [{ type: "CIMSolidStroke", enable: true, capStyle: U$7.Butt, joinStyle: w$d.Round, miterLimit: 10, width: e$1D(p$z.lineHintWidthTarget), color: u$i }] } } }), x$d = new d$1H({ data: { type: "CIMSymbolReference", symbol: { type: "CIMLineSymbol", symbolLayers: [{ type: "CIMVectorMarker", enable: true, anchorPoint: { x: 0, y: -1, z: 0 }, anchorPointUnits: "Relative", size: 5, markerPlacement: { type: "CIMMarkerPlacementOnLine", placePerPart: true, angleToLine: true, relativeTo: "LineMiddle" }, frame: { xmin: -5, ymin: -1.5, xmax: 5, ymax: 1.5 }, markerGraphics: [{ type: "CIMMarkerGraphic", geometry: { rings: [[[7, 0], [-7, 0], [-7, 1.5], [7, 1.5]]] }, symbol: { type: "CIMPolygonSymbol", symbolLayers: [{ type: "CIMSolidFill", enable: true, color: u$i }] } }], scaleSymbolsProportionally: true, respectFrame: true }, { type: "CIMVectorMarker", enable: true, anchorPoint: { x: 0, y: 1, z: 0 }, anchorPointUnits: "Relative", size: 5, markerPlacement: { type: "CIMMarkerPlacementOnLine", placePerPart: true, angleToLine: true, relativeTo: "LineMiddle" }, frame: { xmin: -5, ymin: -1.5, xmax: 5, ymax: 1.5 }, markerGraphics: [{ type: "CIMMarkerGraphic", geometry: { rings: [[[7, 0], [-7, 0], [-7, -1.5], [7, -1.5]]] }, symbol: { type: "CIMPolygonSymbol", symbolLayers: [{ type: "CIMSolidFill", enable: true, color: u$i }] } }], scaleSymbolsProportionally: true, respectFrame: true }] } } }), v$e = (e2) => new d$1H({ data: { type: "CIMSymbolReference", symbol: { type: "CIMLineSymbol", symbolLayers: [{ type: "CIMVectorMarker", enable: true, anchorPoint: { x: 0.5, y: 0.5, z: 0 }, anchorPointUnits: "Relative", size: e$1D(p$z.rightAngleHintSize), rotation: e2, markerPlacement: { type: "CIMMarkerPlacementOnVertices", placePerPart: true, angleToLine: true, placeOnEndPoints: false }, frame: { xmin: -5, ymin: -5, xmax: 5, ymax: 5 }, markerGraphics: [{ type: "CIMMarkerGraphic", geometry: { paths: [[[5, -5], [-5, -5], [-5, 5], [5, 5], [5, -5]]] }, symbol: { type: "CIMLineSymbol", symbolLayers: [{ type: "CIMSolidStroke", enable: true, capStyle: "Butt", joinStyle: "Round", miterLimit: 10, width: e$1D(p$z.rightAngleHintOutlineSize), color: u$i }, { type: "CIMSolidFill", enable: true, color: M$c }] } }], scaleSymbolsProportionally: true, respectFrame: true }] } } }), C$b = v$e(45), L$5 = v$e(225), z$d = (() => {
  const e2 = n$S(), r2 = n$S(), i2 = n$2v();
  return (o2) => (o$I(e2, o2.centerVertex, o2.previousVertex), o$I(r2, o2.nextVertex, o2.previousVertex), y$m(i2, e2, r2), i2[2] < 0 ? C$b : L$5);
})();
var R$9;
!function(e2) {
  e2[e2.Z = 0] = "Z", e2[e2.M = 1] = "M";
}(R$9 || (R$9 = {}));
class x$c {
  constructor(e2) {
    this.spatialReference = e2;
  }
  createVector() {
    return this._tag(n$S());
  }
  pointToVector(e2) {
    return this._tag(r$N(e2.x, e2.y));
  }
  arrayToVector(e2) {
    return this._tag(r$N(e2[0], e2[1]));
  }
  vectorToArray(e2) {
    return [e2[0], e2[1]];
  }
  pointToArray(e2) {
    return [e2.x, e2.y];
  }
  vectorToPoint(e2, t2 = new w$_()) {
    return t2.x = e2[0], t2.y = e2[1], t2.z = void 0, t2.m = void 0, t2.spatialReference = this.spatialReference, t2;
  }
  arrayToPoint(e2, t2 = new w$_()) {
    return t2.x = e2[0], t2.y = e2[1], t2.z = void 0, t2.m = void 0, t2.spatialReference = this.spatialReference, t2;
  }
  vectorToDehydratedPoint(e2, t2 = { x: void 0, y: void 0, z: void 0, m: void 0, hasZ: void 0, hasM: void 0, spatialReference: void 0, type: "point" }) {
    return t2.x = e2[0], t2.y = e2[1], t2.z = void 0, t2.m = void 0, t2.hasZ = false, t2.hasM = false, t2.spatialReference = this.spatialReference, t2;
  }
  lerp(t2, r2, a2, s2) {
    return A$c(s2, t2, r2, a2);
  }
  addDelta(e2, t2, r2) {
    e2[0] += t2, e2[1] += r2;
  }
  distance(e2, r2) {
    return m$T(e2, r2);
  }
  getZ(e2, t2) {
    return t2;
  }
  hasZ() {
    return false;
  }
  getM(e2, t2) {
    return t2;
  }
  hasM() {
    return false;
  }
  clone(e2) {
    return this._tag(e$z(e2));
  }
  copy(e2, t2) {
    return a$T(t2, e2);
  }
  fromXYZ(e2) {
    return this._tag(r$N(e2[0], e2[1]));
  }
  toXYZ(e2, t2 = n$2v()) {
    return o$1Q(t2, e2[0], e2[1], 0);
  }
  equals(e2, t2) {
    return k$f(e2, t2);
  }
  _tag(e2) {
    return e2;
  }
}
class M$b {
  constructor(e2, t2) {
    this._valueType = e2, this.spatialReference = t2;
  }
  createVector() {
    return this._tag(n$2v());
  }
  pointToVector(e2) {
    return this._tag(r$1B(e2.x, e2.y, this._valueType === R$9.Z ? e2.z : e2.m));
  }
  arrayToVector(e2) {
    return this._tag(r$1B(e2[0], e2[1], e2[2] || 0));
  }
  vectorToArray(e2) {
    return [e2[0], e2[1], e2[2]];
  }
  pointToArray(e2) {
    return this._valueType === R$9.Z ? [e2.x, e2.y, e2.z] : [e2.x, e2.y, e2.m];
  }
  vectorToPoint(e2, t2 = new w$_()) {
    return t2.x = e2[0], t2.y = e2[1], t2.z = this._valueType === R$9.Z ? e2[2] : void 0, t2.m = this._valueType === R$9.M ? e2[2] : void 0, t2.spatialReference = this.spatialReference, t2;
  }
  arrayToPoint(e2, t2 = new w$_()) {
    return t2.x = e2[0], t2.y = e2[1], t2.z = this._valueType === R$9.Z ? e2[2] : void 0, t2.m = this._valueType === R$9.M ? e2[2] : void 0, t2.spatialReference = this.spatialReference, t2;
  }
  vectorToDehydratedPoint(e2, t2 = { x: void 0, y: void 0, z: void 0, m: void 0, hasZ: void 0, hasM: void 0, spatialReference: void 0, type: "point" }) {
    const r2 = this._valueType === R$9.Z, a2 = this._valueType === R$9.M;
    return t2.x = e2[0], t2.y = e2[1], t2.z = r2 ? e2[2] : void 0, t2.m = a2 ? e2[2] : void 0, t2.hasZ = r2, t2.hasM = a2, t2.spatialReference = this.spatialReference, t2;
  }
  lerp(e2, t2, r2, a2) {
    return A$x(a2, e2, t2, r2);
  }
  addDelta(e2, t2, r2, a2) {
    e2[0] += t2, e2[1] += r2, this._valueType === R$9.Z && (e2[2] += a2);
  }
  distance(e2, r2) {
    return this._valueType === R$9.Z ? x$U(e2, r2) : m$T(e2, r2);
  }
  getZ(e2, t2) {
    return this._valueType === R$9.Z ? e2[2] : t2;
  }
  hasZ() {
    return this._valueType === R$9.Z;
  }
  getM(e2, t2) {
    return this._valueType === R$9.M ? e2[2] : t2;
  }
  hasM() {
    return this._valueType === R$9.M;
  }
  clone(e2) {
    return this._tag(e$1I(e2));
  }
  copy(e2, t2) {
    return r$1z(t2, e2);
  }
  fromXYZ(e2, t2 = 0, r2 = 0) {
    return this._tag(r$1B(e2[0], e2[1], this._valueType === R$9.Z ? e2.length > 2 ? e2[2] : t2 : r2));
  }
  toXYZ(e2, t2 = n$2v()) {
    return o$1Q(t2, e2[0], e2[1], this._valueType === R$9.Z ? e2[2] : 0);
  }
  equals(e2, t2) {
    return G$t(e2, t2);
  }
  _tag(e2) {
    return e2;
  }
}
class z$c {
  constructor(e2) {
    this.spatialReference = e2;
  }
  createVector() {
    return this._tag(n$1v());
  }
  pointToVector(e2) {
    return this._tag(r$12(e2.x, e2.y, e2.z, e2.m));
  }
  arrayToVector(e2) {
    return this._tag(r$12(e2[0], e2[1], e2[2] || 0, e2[3] || 0));
  }
  vectorToArray(e2) {
    return [e2[0], e2[1], e2[2], e2[3]];
  }
  pointToArray(e2) {
    return [e2.x, e2.y, e2.z, e2.m];
  }
  vectorToPoint(e2, t2 = new w$_()) {
    return t2.x = e2[0], t2.y = e2[1], t2.z = e2[2], t2.m = e2[3], t2.spatialReference = this.spatialReference, t2;
  }
  arrayToPoint(e2, t2 = new w$_()) {
    return t2.x = e2[0], t2.y = e2[1], t2.z = e2[2], t2.m = e2[3], t2.spatialReference = this.spatialReference, t2;
  }
  vectorToDehydratedPoint(e2, t2 = { x: void 0, y: void 0, z: void 0, m: void 0, hasZ: void 0, hasM: void 0, spatialReference: void 0, type: "point" }) {
    return t2.x = e2[0], t2.y = e2[1], t2.z = e2[2], t2.m = e2[3], t2.hasZ = true, t2.hasM = true, t2.spatialReference = this.spatialReference, t2;
  }
  lerp(e2, t2, r2, a2) {
    return j$S(a2, e2, t2, r2);
  }
  addDelta(e2, t2, r2, a2) {
    e2[0] += t2, e2[1] += r2, e2[2] += a2;
  }
  distance(e2, t2) {
    return x$U(e2, t2);
  }
  getZ(e2) {
    return e2[2];
  }
  hasZ() {
    return true;
  }
  getM(e2) {
    return e2[3];
  }
  hasM() {
    return true;
  }
  clone(e2) {
    return this._tag(e$W(e2));
  }
  copy(e2, t2) {
    return a$2w(t2, e2);
  }
  fromXYZ(e2, t2 = 0, r2 = 0) {
    return this._tag(r$12(e2[0], e2[1], e2.length > 2 ? e2[2] : t2, r2));
  }
  toXYZ(e2, t2 = n$2v()) {
    return o$1Q(t2, e2[0], e2[1], e2[2]);
  }
  equals(e2, t2) {
    return E$K(e2, t2);
  }
  _tag(e2) {
    return e2;
  }
}
function w$c(e2, t2, r2) {
  return e2 && t2 ? new z$c(r2) : t2 ? new M$b(R$9.M, r2) : e2 ? new M$b(R$9.Z, r2) : new x$c(r2);
}
function e$j(o2, r2) {
  if (!r2.supported)
    return;
  let e2 = 1 / 0, p2 = -1 / 0;
  const n2 = r2.upperBoundX - r2.lowerBoundX;
  o2.forEach((o3) => {
    let u3 = o3.pos[0];
    for (; u3 < r2.lowerBoundX; )
      u3 += n2;
    for (; u3 > r2.upperBoundX; )
      u3 -= n2;
    e2 = Math.min(e2, u3), p2 = Math.max(p2, u3), o3.pos[0] = u3;
  });
  const u2 = p2 - e2;
  n2 - u2 < u2 && o2.forEach((o3) => {
    o3.pos[0] < 0 && (o3.pos[0] += n2);
  });
}
function p$w(e2, p2) {
  const n2 = R$B(e2);
  return p2 === l$U.Global && n2 ? { supported: true, lowerBoundX: n2.valid[0], upperBoundX: n2.valid[1] } : { supported: false, lowerBoundX: null, upperBoundX: null };
}
class c$r {
  constructor(e2) {
    this.component = e2, this.leftEdge = null, this.rightEdge = null, this.type = "vertex", this.index = null;
  }
  get pos() {
    return this._pos;
  }
  set pos(e2) {
    this._pos = e2, this.component.unnormalizeVertexPositions();
  }
}
class l$q {
  constructor(e2, t2, s2) {
    this.component = e2, this.leftVertex = t2, this.rightVertex = s2, this.type = "edge", t2.rightEdge = this, s2.leftEdge = this;
  }
}
class p$v {
  constructor(e2, t2) {
    this._spatialReference = e2, this._viewingMode = t2, this.vertices = [], this.edges = [];
  }
  unnormalizeVertexPositions() {
    this.vertices.length <= 1 || e$j(this.vertices, p$w(this._spatialReference, this._viewingMode));
  }
  updateVertexIndex(e2, t2) {
    if (this.vertices.length === 0)
      return;
    const s2 = this.vertices[0];
    let i2 = null, r2 = e2, o2 = t2;
    do {
      i2 = r2, i2.index = o2++, r2 = i2.rightEdge ? i2.rightEdge.rightVertex : null;
    } while (r2 != null && r2 !== s2);
    i2.leftEdge && i2 !== this.vertices[this.vertices.length - 1] && this.swapVertices(this.vertices.indexOf(i2), this.vertices.length - 1);
  }
  getFirstVertex() {
    return this.vertices.length === 0 ? null : this.vertices[0];
  }
  getLastVertex() {
    return this.vertices.length === 0 ? null : this.vertices[this.vertices.length - 1];
  }
  isClosed() {
    return this.vertices.length > 2 && this.vertices[0].leftEdge !== null;
  }
  swapVertices(e2, t2) {
    const s2 = this.vertices[e2];
    this.vertices[e2] = this.vertices[t2], this.vertices[t2] = s2;
  }
  iterateVertices(e2) {
    if (this.vertices.length === 0)
      return;
    const t2 = this.vertices[0];
    let i2 = t2;
    do {
      e2(i2, i2.index), i2 = r$1$(i2.rightEdge) ? i2.rightEdge.rightVertex : null;
    } while (i2 !== t2 && i2 != null);
  }
}
class g$d extends n$2G {
  constructor(e2, t2) {
    super(), this.type = e2, this.coordinateHelper = t2, this._geometry = null, this._dirty = true, this.components = [];
  }
  get geometry() {
    if (this._dirty) {
      switch (this.type) {
        case "point":
          this._geometry = this._toPoint();
          break;
        case "polyline":
          this._geometry = this._toPolyline();
          break;
        case "polygon":
          this._geometry = this._toPolygon();
      }
      this._dirty = false;
    }
    return this._geometry;
  }
  get spatialReference() {
    return this.coordinateHelper.spatialReference;
  }
  notifyChanges(e2) {
    this._dirty = true, this.emit("change", e2);
  }
  _toPoint() {
    return this.components.length === 0 || this.components[0].vertices.length === 0 ? null : this.coordinateHelper.vectorToPoint(this.components[0].vertices[0].pos);
  }
  _toPolyline() {
    const e2 = [], t2 = this.coordinateHelper.vectorToArray;
    for (const s2 of this.components) {
      if (s2.vertices.length < 1)
        continue;
      const i2 = [];
      let r2 = s2.vertices.find((e3) => e3.leftEdge == null);
      const o2 = r2;
      do {
        i2.push(t2(r2.pos)), r2 = r2.rightEdge ? r2.rightEdge.rightVertex : null;
      } while (r2 && r2 !== o2);
      e2.push(i2);
    }
    return new m$2i({ paths: e2, spatialReference: this.spatialReference, hasZ: this.coordinateHelper.hasZ(), hasM: this.coordinateHelper.hasM() });
  }
  _toPolygon() {
    const e2 = [], t2 = this.coordinateHelper.vectorToArray;
    for (const i2 of this.components) {
      if (i2.vertices.length < 1)
        continue;
      const r2 = [], o2 = i2.vertices[0];
      let n2 = o2;
      const h2 = n2;
      do {
        r2.push(t2(n2.pos)), n2 = r$1$(n2.rightEdge) ? n2.rightEdge.rightVertex : null;
      } while (n2 && n2 !== h2);
      i2.isClosed() && r2.push(t2(o2.pos)), e2.push(r2);
    }
    return new v$15({ rings: e2, spatialReference: this.spatialReference, hasZ: this.coordinateHelper.hasZ(), hasM: this.coordinateHelper.hasM() });
  }
  static fromGeometry(t2, s2) {
    const i2 = t2.spatialReference, r2 = w$c(t2.hasZ, t2.hasM, i2), n2 = new g$d(t2.type, r2);
    switch (t2.type) {
      case "polygon": {
        const o2 = t2.rings;
        for (let t3 = 0; t3 < o2.length; ++t3) {
          const h2 = o2[t3], g2 = new p$v(i2, s2), a2 = h2.length > 2 && i$3e(h2[0], h2[h2.length - 1]), d2 = a2 ? h2.length - 1 : h2.length;
          for (let e2 = 0; e2 < d2; ++e2) {
            const t4 = r2.arrayToVector(h2[e2]), s3 = new c$r(g2);
            g2.vertices.push(s3), s3.pos = t4, s3.index = e2;
          }
          const u2 = g2.vertices.length - 1;
          for (let e2 = 0; e2 < u2; ++e2) {
            const t4 = g2.vertices[e2], s3 = g2.vertices[e2 + 1], i3 = new l$q(g2, t4, s3);
            g2.edges.push(i3);
          }
          if (a2) {
            const e2 = new l$q(g2, g2.vertices[g2.vertices.length - 1], g2.vertices[0]);
            g2.edges.push(e2);
          }
          n2.components.push(g2);
        }
        break;
      }
      case "polyline":
        for (const e2 of t2.paths) {
          const t3 = new p$v(i2, s2), o2 = e2.length;
          for (let s3 = 0; s3 < o2; ++s3) {
            const i3 = r2.arrayToVector(e2[s3]), o3 = new c$r(t3);
            t3.vertices.push(o3), o3.pos = i3, o3.index = s3;
          }
          const h2 = t3.vertices.length - 1;
          for (let e3 = 0; e3 < h2; ++e3) {
            const s3 = t3.vertices[e3], i3 = t3.vertices[e3 + 1], r3 = new l$q(t3, s3, i3);
            t3.edges.push(r3);
          }
          n2.components.push(t3);
        }
        break;
      case "point": {
        const e2 = new p$v(i2, s2), o2 = new c$r(e2);
        o2.index = 0, o2.pos = r2.pointToVector(t2), e2.vertices.push(o2), n2.components.push(e2);
        break;
      }
    }
    return n2;
  }
}
var E$d;
!function(E2) {
  E2[E2.NEW_STEP = 0] = "NEW_STEP", E2[E2.ACCUMULATE_STEPS = 1] = "ACCUMULATE_STEPS";
}(E$d || (E$d = {}));
class d$g {
  constructor(e2, t2, i2) {
    this._editGeometry = e2, this._component = t2, this._pos = i2, this._addedVertex = null, this._originalEdge = null, this._left = null, this._right = null;
  }
  apply() {
    let d2 = "redo";
    t$2r(this._addedVertex) && (d2 = "apply", this._addedVertex = new c$r(this._component));
    const h2 = this._component.getLastVertex();
    if (t$2r(h2))
      this._component.vertices.push(this._addedVertex), this._addedVertex.pos = this._pos, this._addedVertex.index = 0;
    else {
      let i2 = null;
      h2.rightEdge && (this._originalEdge = h2.rightEdge, i2 = this._originalEdge.rightVertex, this._component.edges.splice(this._component.edges.indexOf(this._originalEdge), 1)), this._component.vertices.push(this._addedVertex), this._addedVertex.pos = this._pos, t$2r(this._left) && (this._left = new l$q(this._component, h2, this._addedVertex)), this._component.edges.push(this._left), h2.rightEdge = this._left, r$1$(this._originalEdge) && r$1$(i2) && (t$2r(this._right) && (this._right = new l$q(this._component, this._addedVertex, i2)), this._component.edges.push(this._right), i2.leftEdge = this._right), this._component.updateVertexIndex(this._addedVertex, h2.index + 1);
    }
    this._editGeometry.notifyChanges({ operation: d2, addedVertices: [this._addedVertex] });
  }
  undo() {
    t$2r(this._addedVertex) || (this._component.vertices.splice(this._component.vertices.indexOf(this._addedVertex), 1), r$1$(this._left) && (this._component.edges.splice(this._component.edges.indexOf(this._left), 1), this._left.leftVertex.rightEdge = null), r$1$(this._right) && (this._component.edges.splice(this._component.edges.indexOf(this._right), 1), this._right.rightVertex.leftEdge = null), r$1$(this._originalEdge) && (this._component.edges.push(this._originalEdge), this._originalEdge.leftVertex.rightEdge = this._originalEdge, this._originalEdge.rightVertex.leftEdge = this._originalEdge), r$1$(this._left) ? this._component.updateVertexIndex(this._left.leftVertex, this._left.leftVertex.index) : this._component.updateVertexIndex(this._addedVertex, 0), this._editGeometry.notifyChanges({ operation: "undo", removedVertices: [this._addedVertex] }));
  }
  accumulate() {
    return false;
  }
}
class t$p {
  constructor(t2, e2, i2) {
    this._editGeometry = t2, this._vertices = e2, this.operation = i2, this._undone = false;
  }
  apply() {
    this._vertices.forEach((t2) => this.operation.apply(t2)), this._editGeometry.components.forEach((t2) => t2.unnormalizeVertexPositions()), this._editGeometry.notifyChanges({ operation: this._undone ? "redo" : "apply", updatedVertices: this._vertices });
  }
  undo() {
    this._vertices.forEach((t2) => this.operation.undo(t2)), this._editGeometry.notifyChanges({ operation: "undo", updatedVertices: this._vertices }), this._undone = true;
  }
  canAccumulate(t2) {
    if (this._undone || t2._vertices.length !== this._vertices.length)
      return false;
    for (let e2 = 0; e2 < t2._vertices.length; ++e2)
      if (t2._vertices[e2] !== this._vertices[e2])
        return false;
    return this.operation.canAccumulate(t2.operation);
  }
  accumulate(e2) {
    return !!(e2 instanceof t$p && this.canAccumulate(e2)) && (this._vertices.forEach((t2) => this.operation.accumulate(t2, e2.operation)), this.operation.accumulateParams(e2.operation), this._editGeometry.components.forEach((t2) => t2.unnormalizeVertexPositions()), this._editGeometry.notifyChanges({ operation: "apply", updatedVertices: this._vertices }), true);
  }
}
var e$i;
!function(t2) {
  t2[t2.CUMULATIVE = 0] = "CUMULATIVE", t2[t2.REPLACE = 1] = "REPLACE";
}(e$i || (e$i = {}));
class r$o {
  constructor(e2, t2, r2 = 0) {
    this._editGeometry = e2, this._vertices = t2, this._minNumberOfVertices = r2, this.removedVertices = null;
  }
  apply() {
    let t2 = "redo";
    if (this.removedVertices == null) {
      const r2 = this.removedVertices = [];
      this._vertices.forEach((t3) => {
        const i2 = this._removeVertex(t3);
        r$1$(i2) && r2.push(i2);
      }), t2 = "apply";
    } else
      this.removedVertices.forEach((e2) => {
        this._removeVertex(e2.removedVertex);
      });
    this._editGeometry.notifyChanges({ operation: t2, removedVertices: this._vertices });
  }
  undo() {
    var _a2;
    (_a2 = this.removedVertices) == null ? void 0 : _a2.forEach((e2) => {
      this._undoRemoveVertex(e2);
    }), this._editGeometry.notifyChanges({ operation: "undo", addedVertices: this._vertices });
  }
  accumulate() {
    return false;
  }
  _removeVertex(e2) {
    const r2 = e2.component;
    if (r2.vertices.length <= this._minNumberOfVertices)
      return null;
    const i2 = { removedVertex: e2, createdEdge: null }, s2 = e2.leftEdge, d2 = e2.rightEdge;
    return r2.vertices.splice(r2.vertices.indexOf(e2), 1), s2 && (r2.edges.splice(r2.edges.indexOf(s2), 1), s2.leftVertex.rightEdge = null), d2 && (r2.edges.splice(r2.edges.indexOf(d2), 1), d2.rightVertex.leftEdge = null), e2.index === 0 && d2 && this._vertices.length > 0 && r2.swapVertices(r2.vertices.indexOf(d2.rightVertex), 0), s2 && d2 && (i2.createdEdge = new l$q(r2, s2.leftVertex, d2.rightVertex), r2.edges.push(i2.createdEdge)), d2 && r2.updateVertexIndex(d2.rightVertex, d2.rightVertex.index - 1), i2;
  }
  _undoRemoveVertex(e2) {
    const t2 = e2.removedVertex, r2 = e2.removedVertex.component, i2 = t2.leftEdge, s2 = t2.rightEdge;
    e2.createdEdge && r2.edges.splice(r2.edges.indexOf(e2.createdEdge), 1), r2.vertices.push(t2), i2 && (r2.edges.push(i2), i2.leftVertex.rightEdge = i2), s2 && (r2.edges.push(s2), s2.rightVertex.leftEdge = s2), r2.updateVertexIndex(t2, t2.index);
  }
}
class r$n {
  constructor(e2, t2, i2) {
    this._editGeometry = e2, this._edge = t2, this._t = i2, this.createdVertex = null, this._left = null, this._right = null;
  }
  apply() {
    let r2 = "redo";
    const s2 = this._edge, d2 = s2.component, h2 = s2.leftVertex, g2 = s2.rightVertex;
    d2.edges.splice(d2.edges.indexOf(s2), 1), t$2r(this.createdVertex) && (r2 = "apply", this.createdVertex = new c$r(s2.component)), d2.vertices.push(this.createdVertex), this.createdVertex.pos = this._editGeometry.coordinateHelper.lerp(s2.leftVertex.pos, s2.rightVertex.pos, this._t, this._editGeometry.coordinateHelper.createVector()), t$2r(this._left) && (this._left = new l$q(d2, h2, this.createdVertex)), this._left.leftVertex.leftEdge ? d2.edges.push(this._left) : d2.edges.unshift(this._left), h2.rightEdge = this._left, t$2r(this._right) && (this._right = new l$q(d2, this.createdVertex, g2)), d2.edges.push(this._right), g2.leftEdge = this._right, d2.updateVertexIndex(this.createdVertex, h2.index + 1), this._editGeometry.notifyChanges({ operation: r2, addedVertices: [this.createdVertex] });
  }
  undo() {
    if (t$2r(this.createdVertex) || t$2r(this._left) || t$2r(this._right))
      return null;
    const t2 = this._edge, i2 = t2.component, r2 = this.createdVertex.leftEdge, s2 = this.createdVertex.rightEdge, d2 = r2 == null ? void 0 : r2.leftVertex, h2 = s2 == null ? void 0 : s2.rightVertex;
    i2.vertices.splice(i2.vertices.indexOf(this.createdVertex), 1), i2.edges.splice(i2.edges.indexOf(this._left), 1), i2.edges.splice(i2.edges.indexOf(this._right), 1), this._edge.leftVertex.leftEdge ? i2.edges.push(this._edge) : i2.edges.unshift(this._edge), d2 && (d2.rightEdge = t2), h2 && (h2.leftEdge = t2), d2 && i2.updateVertexIndex(d2, d2.index), this._editGeometry.notifyChanges({ operation: "undo", removedVertices: [this.createdVertex] });
  }
  accumulate() {
    return false;
  }
}
class i$y {
  constructor(t2, e2, i2) {
    this._editGeometry = t2, this._vertex = e2, this._pos = i2;
  }
  apply() {
    const e2 = t$2r(this._originalPosition);
    e2 && (this._originalPosition = this._vertex.pos), this._apply(e2 ? "apply" : "redo");
  }
  undo() {
    this._vertex.pos = e$2e(this._originalPosition), this._editGeometry.notifyChanges({ operation: "undo", updatedVertices: [this._vertex] });
  }
  accumulate(t2) {
    return t2 instanceof i$y && t2._vertex === this._vertex && (this._pos = t2._pos, this._apply("apply"), true);
  }
  _apply(t2) {
    this._vertex.pos = this._pos, this._editGeometry.components.forEach((t3) => t3.unnormalizeVertexPositions()), this._editGeometry.notifyChanges({ operation: t2, updatedVertices: [this._vertex] });
  }
}
class i$x {
  constructor(e2, t2) {
    this._editGeometry = e2, this._component = t2, this._createdEdge = null;
  }
  apply() {
    let e2 = "redo";
    if (t$2r(this._createdEdge)) {
      e2 = "apply";
      const i2 = this._component.getFirstVertex(), o2 = this._component.getLastVertex();
      if (this._component.isClosed() || this._component.vertices.length < 3 || t$2r(i2) || t$2r(o2))
        return;
      this._createdEdge = new l$q(this._component, o2, i2);
    }
    this._createdEdge.leftVertex.rightEdge = this._createdEdge, this._createdEdge.rightVertex.leftEdge = this._createdEdge, this._component.edges.push(this._createdEdge), this._editGeometry.notifyChanges({ operation: e2 });
  }
  undo() {
    t$2r(this._createdEdge) || (C$G(this._component.edges, this._createdEdge), this._createdEdge.leftVertex.rightEdge = null, this._createdEdge.rightVertex.leftEdge = null, this._editGeometry.notifyChanges({ operation: "undo" }));
  }
  accumulate() {
    return false;
  }
}
class t$o {
  constructor(t2, s2, d2, h2) {
    this._helper = t2, this.dx = s2, this.dy = d2, this.dz = h2;
  }
  _move(t2, s2, d2, h2) {
    this._helper.addDelta(t2.pos, s2, d2, h2);
  }
  apply(t2) {
    this._move(t2, this.dx, this.dy, this.dz);
  }
  undo(t2) {
    this._move(t2, -this.dx, -this.dy, -this.dz);
  }
  canAccumulate(s2) {
    return s2 instanceof t$o;
  }
  accumulate(t2, s2) {
    this._move(t2, s2.dx, s2.dy, s2.dz);
  }
  accumulateParams(t2) {
    this.dx += t2.dx, this.dy += t2.dy, this.dz += t2.dz;
  }
}
var n$u;
!function(n2) {
  n2[n2.X = 0] = "X", n2[n2.Y = 1] = "Y", n2[n2.Z = 2] = "Z";
}(n$u || (n$u = {}));
class s$o {
  constructor(t2) {
    this._allocator = t2, this._items = [], this._itemsPtr = 0, this._grow();
  }
  get() {
    return this._itemsPtr === 0 && t$2a(() => this._reset()), this._itemsPtr === this._items.length && this._grow(), this._items[this._itemsPtr++];
  }
  _reset() {
    const t2 = Math.min(3 * Math.max(8, this._itemsPtr), this._itemsPtr + 3 * i$w);
    this._items.length = Math.min(t2, this._items.length), this._itemsPtr = 0;
  }
  _grow() {
    for (let t2 = 0; t2 < Math.max(8, Math.min(this._items.length, i$w)); t2++)
      this._items.push(this._allocator());
  }
}
const i$w = 1024;
function e$h() {
  return [1, 0, 0, 0, 1, 0, 0, 0, 1];
}
function r$m(e2) {
  return [e2[0], e2[1], e2[2], e2[3], e2[4], e2[5], e2[6], e2[7], e2[8]];
}
function t$n(e2, r2, t2, n2, o2, a2, u2, c2, f2) {
  return [e2, r2, t2, n2, o2, a2, u2, c2, f2];
}
function n$t(e2, r2) {
  return new Float64Array(e2, r2, 9);
}
Object.freeze(Object.defineProperty({ __proto__: null, create: e$h, clone: r$m, fromValues: t$n, createView: n$t }, Symbol.toStringTag, { value: "Module" }));
function e$g() {
  return [1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1];
}
function r$l(e2) {
  return [e2[0], e2[1], e2[2], e2[3], e2[4], e2[5], e2[6], e2[7], e2[8], e2[9], e2[10], e2[11], e2[12], e2[13], e2[14], e2[15]];
}
function t$m(e2, r2, t2, n2, o2, a2, u2, c2, f2, l2, s2, i2, b2, _2, m2, p2) {
  return [e2, r2, t2, n2, o2, a2, u2, c2, f2, l2, s2, i2, b2, _2, m2, p2];
}
function n$s(e2, r2) {
  return new Float64Array(e2, r2, 16);
}
const o$l = e$g();
Object.freeze(Object.defineProperty({ __proto__: null, create: e$g, clone: r$l, fromValues: t$m, createView: n$s, IDENTITY: o$l }, Symbol.toStringTag, { value: "Module" }));
function e$f() {
  return [0, 0, 0, 1];
}
function r$k(e2) {
  return [e2[0], e2[1], e2[2], e2[3]];
}
function t$l(e2, r2, t2, n2) {
  return [e2, r2, t2, n2];
}
function n$r(e2, r2) {
  return new Float64Array(e2, r2, 4);
}
const o$k = e$f();
Object.freeze(Object.defineProperty({ __proto__: null, create: e$f, clone: r$k, fromValues: t$l, createView: n$r, IDENTITY: o$k }, Symbol.toStringTag, { value: "Module" }));
class a$l {
  constructor(t2, e2, s2) {
    this._itemByteSize = t2, this._itemCreate = e2, this._buffers = new Array(), this._items = new Array(), this._itemsPtr = 0, this._itemsPerBuffer = Math.ceil(s2 / this._itemByteSize);
  }
  get() {
    this._itemsPtr === 0 && t$2a(() => this._reset());
    const t2 = Math.floor(this._itemsPtr / this._itemsPerBuffer);
    for (; this._buffers.length <= t2; ) {
      const t3 = new ArrayBuffer(this._itemsPerBuffer * this._itemByteSize);
      for (let e2 = 0; e2 < this._itemsPerBuffer; ++e2)
        this._items.push(this._itemCreate(t3, e2 * this._itemByteSize));
      this._buffers.push(t3);
    }
    return this._items[this._itemsPtr++];
  }
  _reset() {
    const t2 = 2 * (Math.floor(this._itemsPtr / this._itemsPerBuffer) + 1);
    for (; this._buffers.length > t2; )
      this._buffers.pop(), this._items.length = this._buffers.length * this._itemsPerBuffer;
    this._itemsPtr = 0;
  }
  static createVec2f64(t2 = c$q) {
    return new a$l(16, o$H, t2);
  }
  static createVec3f64(t2 = c$q) {
    return new a$l(24, u$1U, t2);
  }
  static createVec4f64(t2 = c$q) {
    return new a$l(32, u$13, t2);
  }
  static createMat3f64(t2 = c$q) {
    return new a$l(72, n$t, t2);
  }
  static createMat4f64(t2 = c$q) {
    return new a$l(128, n$s, t2);
  }
  static createQuatf64(t2 = c$q) {
    return new a$l(32, n$r, t2);
  }
  get test() {
    return { size: this._buffers.length * this._itemsPerBuffer * this._itemByteSize };
  }
}
const c$q = 4 * s$1x.KILOBYTES;
const t$k = a$l.createVec2f64(), c$p = a$l.createVec3f64(), r$j = a$l.createVec4f64();
a$l.createMat3f64();
const f$h = a$l.createMat4f64(), o$j = a$l.createQuatf64();
function d$f(i2) {
  return i2 ? m$z(t$1U(i2.origin), t$1U(i2.direction)) : m$z(n$2v(), n$2v());
}
function m$z(i2, n2) {
  return { origin: i2, direction: n2 };
}
function p$u(i2, n2) {
  const r2 = S$a.get();
  return r2.origin = i2, r2.direction = n2, r2;
}
function k$b(i2, n2 = d$f()) {
  return v$d(i2.origin, i2.direction, n2);
}
function h$l(i2, n2, o2 = d$f()) {
  return r$1z(o2.origin, i2), e$1G(o2.direction, n2, i2), o2;
}
function v$d(i2, n2, t2 = d$f()) {
  return r$1z(t2.origin, i2), r$1z(t2.direction, n2), t2;
}
function b$d(i2, n2) {
  const r2 = _$K(c$p.get(), z$G(c$p.get(), i2.direction), e$1G(c$p.get(), n2, i2.origin));
  return P$A(r2, r2);
}
function q$9(i2, n2, r2) {
  const o2 = P$A(i2.direction, e$1G(r2, n2, i2.origin));
  return u$1S(r2, i2.origin, g$19(r2, i2.direction, o2)), r2;
}
const S$a = new s$o(() => d$f());
function e$e(n2, r2, s2) {
  const c2 = P$A(n2, r2) / P$A(n2, n2);
  return g$19(s2, n2, c2);
}
function f$g(n2, o2) {
  return P$A(n2, o2) / s$1Y(n2);
}
function a$k(o2, s2) {
  const c2 = P$A(o2, s2) / (s$1Y(o2) * s$1Y(s2));
  return -l$2f(c2);
}
function i$v(o2, r2, u2) {
  z$G(m$y, o2), z$G(h$k, r2);
  const e2 = P$A(m$y, h$k), f2 = l$2f(e2), a2 = _$K(m$y, m$y, h$k);
  return P$A(a2, u2) < 0 ? 2 * Math.PI - f2 : f2;
}
const m$y = n$2v(), h$k = n$2v();
function R$8() {
  return n$1v();
}
function _$b(t2, r2 = R$8()) {
  return a$2w(r2, t2);
}
function q$8(t2, r2) {
  return r$12(t2[0], t2[1], t2[2], r2);
}
function w$b(t2) {
  return t2;
}
function C$a(t2) {
  t2[0] = t2[1] = t2[2] = t2[3] = 0;
}
function O$a(t2, r2) {
  return t2[0] = t2[1] = t2[2] = 0, t2[3] = r2, t2;
}
function T$9(t2) {
  return t2[3];
}
function k$a(t2) {
  return t2;
}
function E$c(t2, r2, n2, e2) {
  return r$12(t2, r2, n2, e2);
}
function L$4(t2, r2, n2) {
  return t2 !== n2 && r$1z(n2, t2), n2[3] = t2[3] + r2, n2;
}
function Z$6(r2, n2, e2) {
  return s$2z.getLogger("esri.geometry.support.sphere").error("sphere.setExtent is not yet supported"), r2 === e2 ? e2 : _$b(r2, e2);
}
function z$b(t2, r2, n2) {
  if (t$2r(r2))
    return false;
  const { origin: o2, direction: s2 } = r2, i2 = U$6;
  i2[0] = o2[0] - t2[0], i2[1] = o2[1] - t2[1], i2[2] = o2[2] - t2[2];
  const a2 = s2[0] * s2[0] + s2[1] * s2[1] + s2[2] * s2[2];
  if (a2 === 0)
    return false;
  const c2 = 2 * (s2[0] * i2[0] + s2[1] * i2[1] + s2[2] * i2[2]), u2 = c2 * c2 - 4 * a2 * (i2[0] * i2[0] + i2[1] * i2[1] + i2[2] * i2[2] - t2[3] * t2[3]);
  if (u2 < 0)
    return false;
  const f2 = Math.sqrt(u2);
  let m2 = (-c2 - f2) / (2 * a2);
  const p2 = (-c2 + f2) / (2 * a2);
  return (m2 < 0 || p2 < m2 && p2 > 0) && (m2 = p2), !(m2 < 0) && (n2 && (n2[0] = o2[0] + s2[0] * m2, n2[1] = o2[1] + s2[1] * m2, n2[2] = o2[2] + s2[2] * m2), true);
}
const U$6 = n$2v();
function V$9(t2, r2) {
  return z$b(t2, r2, null);
}
function X$6(t2, r2, n2) {
  if (z$b(t2, r2, n2))
    return n2;
  const e2 = Y$5(t2, r2, c$p.get());
  return u$1S(n2, r2.origin, g$19(c$p.get(), r2.direction, x$U(r2.origin, e2) / s$1Y(r2.direction))), n2;
}
function Y$5(t2, r2, n2) {
  const e2 = c$p.get(), s2 = f$h.get();
  _$K(e2, r2.origin, r2.direction);
  const i2 = T$9(t2);
  _$K(n2, e2, r2.origin), g$19(n2, n2, 1 / s$1Y(n2) * i2);
  const c2 = G$b(t2, r2.origin), p2 = a$k(r2.origin, n2);
  return g$Y(s2, p2 + c2, e2), O$z(n2, n2, s2), n2;
}
function B$7(t2, r2, n2) {
  return z$b(t2, r2, n2) ? n2 : (q$9(r2, k$a(t2), n2), D$8(t2, n2, n2));
}
function D$8(t2, r2, n2) {
  const e2 = e$1G(c$p.get(), r2, k$a(t2)), o2 = g$19(c$p.get(), e2, t2[3] / s$1Y(e2));
  return u$1S(n2, o2, k$a(t2));
}
function F$b(t2, r2) {
  const n2 = e$1G(c$p.get(), r2, k$a(t2)), e2 = v$11(n2), o2 = t2[3] * t2[3];
  return Math.sqrt(Math.abs(e2 - o2));
}
function G$b(t2, n2) {
  const e2 = e$1G(c$p.get(), n2, k$a(t2)), o2 = s$1Y(e2), s2 = T$9(t2), i2 = s2 + Math.abs(s2 - o2);
  return l$2f(s2 / i2);
}
const H$6 = n$2v();
function I$9(t2, r2, e2, o2) {
  const s2 = e$1G(H$6, r2, k$a(t2));
  switch (e2) {
    case n$u.X: {
      const t3 = L$t(s2, H$6)[2];
      return o$1Q(o2, -Math.sin(t3), Math.cos(t3), 0);
    }
    case n$u.Y: {
      const t3 = L$t(s2, H$6), r3 = t3[1], e3 = t3[2], i2 = Math.sin(r3);
      return o$1Q(o2, -i2 * Math.cos(e3), -i2 * Math.sin(e3), Math.cos(r3));
    }
    case n$u.Z:
      return z$G(o2, s2);
    default:
      return;
  }
}
function J$a(t2, r2) {
  const n2 = e$1G(Q$6, r2, k$a(t2));
  return s$1Y(n2) - t2[3];
}
function K$6(t2, r2, n2, e2) {
  const o2 = J$a(t2, r2), s2 = I$9(t2, r2, n$u.Z, Q$6), c2 = g$19(Q$6, s2, n2 - o2);
  return u$1S(e2, r2, c2);
}
function N$9(t2, r2) {
  const n2 = p$37(k$a(t2), r2), e2 = T$9(t2);
  return n2 <= e2 * e2;
}
const Q$6 = n$2v(), W$5 = R$8();
Object.freeze(Object.defineProperty({ __proto__: null, create: R$8, copy: _$b, fromCenterAndRadius: q$8, wrap: w$b, clear: C$a, fromRadius: O$a, getRadius: T$9, getCenter: k$a, fromValues: E$c, elevate: L$4, setExtent: Z$6, intersectRay: z$b, intersectsRay: V$9, intersectRayClosestSilhouette: X$6, closestPointOnSilhouette: Y$5, closestPoint: B$7, projectPoint: D$8, distanceToSilhouette: F$b, angleToSilhouette: G$b, axisAt: I$9, altitudeAt: J$a, setAltitudeAt: K$6, containsPoint: N$9, tmpSphere: W$5 }, Symbol.toStringTag, { value: "Module" }));
function l$p(t2) {
  const n2 = t2[0] * t2[0] + t2[4] * t2[4] + t2[8] * t2[8], s2 = t2[1] * t2[1] + t2[5] * t2[5] + t2[9] * t2[9], r2 = t2[2] * t2[2] + t2[6] * t2[6] + t2[10] * t2[10];
  return Math.sqrt(Math.max(n2, s2, r2));
}
function p$t(t2, s2) {
  const r2 = Math.sqrt(s2[0] * s2[0] + s2[4] * s2[4] + s2[8] * s2[8]), a2 = Math.sqrt(s2[1] * s2[1] + s2[5] * s2[5] + s2[9] * s2[9]), o2 = Math.sqrt(s2[2] * s2[2] + s2[6] * s2[6] + s2[10] * s2[10]);
  return o$1Q(t2, r2, a2, o2), t2;
}
function b$c(t2, s2, o2) {
  Math.abs(t2[0]) > Math.abs(t2[1]) ? o$1Q(s2, 0, 1, 0) : o$1Q(s2, 1, 0, 0), _$K(o2, t2, s2), z$G(s2, s2), _$K(s2, o2, t2), z$G(o2, o2);
}
function p$s(t2 = Z$5) {
  return [t2[0], t2[1], t2[2], t2[3]];
}
function E$b(t2 = Z$5[0], n2 = Z$5[1], r2 = Z$5[2], o2 = Z$5[3]) {
  return F$a(t2, n2, r2, o2, r$j.get());
}
function A$9(t2, n2) {
  return F$a(n2[0], n2[1], n2[2], n2[3], t2);
}
function F$a(t2, n2, r2, o2, c2 = p$s()) {
  return c2[0] = t2, c2[1] = n2, c2[2] = r2, c2[3] = o2, c2;
}
function _$a(t2, n2, r2) {
  const o2 = n2[0] * n2[0] + n2[1] * n2[1] + n2[2] * n2[2], c2 = Math.abs(o2 - 1) > 1e-5 && o2 > 1e-12 ? 1 / Math.sqrt(o2) : 1;
  return r2[0] = n2[0] * c2, r2[1] = n2[1] * c2, r2[2] = n2[2] * c2, r2[3] = -(r2[0] * t2[0] + r2[1] * t2[1] + r2[2] * t2[2]), r2;
}
function j$a(t2, n2, r2, o2 = p$s()) {
  const c2 = r2[0] - n2[0], e2 = r2[1] - n2[1], u2 = r2[2] - n2[2], i2 = t2[0] - n2[0], f2 = t2[1] - n2[1], s2 = t2[2] - n2[2], a2 = e2 * s2 - u2 * f2, I2 = u2 * i2 - c2 * s2, N2 = c2 * f2 - e2 * i2, m2 = a2 * a2 + I2 * I2 + N2 * N2, M2 = Math.abs(m2 - 1) > 1e-5 && m2 > 1e-12 ? 1 / Math.sqrt(m2) : 1;
  return o2[0] = a2 * M2, o2[1] = I2 * M2, o2[2] = N2 * M2, o2[3] = -(o2[0] * t2[0] + o2[1] * t2[1] + o2[2] * t2[2]), o2;
}
function b$b(t2, n2, r2, i2, f2) {
  if (t2.count < 3)
    return false;
  t2.getVec(r2, y$c);
  let s2 = i2, a2 = false;
  for (; s2 < t2.count - 1 && !a2; )
    t2.getVec(s2, X$5), s2++, a2 = !F$A(y$c, X$5);
  if (!a2)
    return false;
  for (s2 = Math.max(s2, f2), a2 = false; s2 < t2.count && !a2; )
    t2.getVec(s2, d$e), s2++, e$1G(l$o, y$c, X$5), z$G(l$o, l$o), e$1G(C$9, X$5, d$e), z$G(C$9, C$9), a2 = !F$A(y$c, d$e) && !F$A(X$5, d$e) && Math.abs(P$A(l$o, C$9)) < k$9;
  return a2 ? (j$a(y$c, X$5, d$e, n2), true) : (r2 !== 0 || i2 !== 1 || f2 !== 2) && b$b(t2, n2, 0, 1, 2);
}
const k$9 = 0.99619469809, y$c = n$2v(), X$5 = n$2v(), d$e = n$2v(), l$o = n$2v(), C$9 = n$2v();
function L$3(t2, n2, r2) {
  return n2 !== t2 && A$9(t2, n2), t2[3] = -P$A(Y$4(t2), r2), t2;
}
function P$9(t2, n2) {
  return n2[0] = -t2[0], n2[1] = -t2[1], n2[2] = -t2[2], n2[3] = -t2[3], n2;
}
function O$9(t2, n2, r2, o2) {
  return _$K(d$e, n2, t2), _$a(r2, d$e, o2);
}
function V$8(t2, n2, r2, o2) {
  return W$4(t2, n2, e$1G(c$p.get(), r2, n2), tt$1, o2);
}
function q$7(t2, r2, o2) {
  return !!r$1$(r2) && W$4(t2, r2.origin, r2.direction, nt$1, o2);
}
function x$b(t2, n2, r2) {
  return W$4(t2, n2.origin, n2.vector, $$3.NONE, r2);
}
function U$5(t2, n2, r2) {
  return W$4(t2, n2.origin, n2.vector, $$3.CLAMP, r2);
}
function z$a(t2, n2) {
  return R$7(t2, n2) >= 0;
}
function G$a(t2, n2) {
  const r2 = P$A(Y$4(t2), n2.ray.direction), o2 = -R$7(t2, n2.ray.origin);
  if (r2 > -1e-6 && r2 < 1e-6)
    return o2 > 0;
  const c2 = o2 / r2;
  return r2 > 0 ? c2 < n2.c1 && (n2.c1 = c2) : c2 > n2.c0 && (n2.c0 = c2), n2.c0 <= n2.c1;
}
function H$5(t2, n2, r2) {
  const o2 = g$19(c$p.get(), Y$4(t2), -t2[3]), e2 = K$5(t2, e$1G(c$p.get(), n2, o2), c$p.get());
  return u$1S(r2, e2, o2), r2;
}
function J$9(t2, n2, r2, o2) {
  const e2 = Y$4(t2), u2 = c$p.get(), i2 = c$p.get();
  b$c(e2, u2, i2);
  const f2 = e$1G(c$p.get(), r2, n2), s2 = f$g(u2, f2), I2 = f$g(i2, f2), N2 = f$g(e2, f2);
  return o$1Q(o2, s2, I2, N2);
}
function K$5(t2, n2, r2) {
  const o2 = g$19(c$p.get(), Y$4(t2), P$A(Y$4(t2), n2));
  return e$1G(r2, n2, o2), r2;
}
function R$7(t2, n2) {
  return P$A(Y$4(t2), n2) + t2[3];
}
function W$4(n2, r2, o2, c2, e2) {
  const i2 = P$A(Y$4(n2), o2);
  if (i2 === 0)
    return false;
  let a2 = -(P$A(Y$4(n2), r2) + n2[3]) / i2;
  return c2 & $$3.CLAMP && (a2 = a$2v(a2, 0, 1)), !(!(c2 & $$3.INFINITE_MIN) && a2 < 0 || !(c2 & $$3.INFINITE_MAX) && a2 > 1) && (u$1S(e2, r2, g$19(e2, o2, a2)), true);
}
function Y$4(t2) {
  return t2;
}
const Z$5 = [0, 0, 1, 0];
var $$3;
!function(t2) {
  t2[t2.NONE = 0] = "NONE", t2[t2.CLAMP = 1] = "CLAMP", t2[t2.INFINITE_MIN = 4] = "INFINITE_MIN", t2[t2.INFINITE_MAX = 8] = "INFINITE_MAX";
}($$3 || ($$3 = {}));
const tt$1 = $$3.INFINITE_MIN | $$3.INFINITE_MAX, nt$1 = $$3.INFINITE_MAX;
function h$j(t2, n2) {
  return t2[0] * n2[1] - t2[1] * n2[0];
}
function I$8(t2, n2, o2) {
  const u2 = j$e(o2, n2) / p$U(o2);
  return l$T(t2, o2, u2);
}
function L$2(t2, n2, r2, s2, e2 = r2) {
  return o$I(M$a, s2, r2), o$I(A$8, n2, e2), I$8(R$6, A$8, M$a), s$L(t2, e2, R$6);
}
function m$x(t2, n2, r2, s2) {
  o$I(M$a, n2, r2);
  const e2 = s2 / q$e(M$a);
  return d$t(t2, r2, M$a, e2);
}
function j$9(t2, n2) {
  const r2 = t2.start, s2 = t2.end, e2 = n2.start, u2 = n2.end, c2 = o$I(M$a, s2, r2), i2 = o$I(k$8, u2, e2), f2 = h$j(c2, i2);
  if (Math.abs(f2) <= l$n)
    return [];
  const p2 = o$I(A$8, r2, e2), E2 = h$j(i2, p2) / f2, I2 = h$j(c2, p2) / f2;
  if (E2 >= 0) {
    if (I2 >= 0 || n2.type === b$a.LINE)
      return [d$t(R$6, r2, c2, E2)];
  } else if (t2.type === b$a.LINE && (I2 >= 0 || n2.type === b$a.LINE))
    return [d$t(R$6, r2, c2, E2)];
  return [];
}
var b$a;
!function(t2) {
  t2[t2.RAY = 0] = "RAY", t2[t2.LINE = 1] = "LINE";
}(b$a || (b$a = {}));
const l$n = 1e-6, M$a = n$S(), k$8 = n$S(), A$8 = n$S(), R$6 = n$S();
class P$8 {
  constructor(t2, i2, e2, s2 = 0, n2 = j$8.IMMEDIATE) {
    this._helper = t2, this._planeType = i2, this._edge = e2, this.distance = s2, this._plane = p$s(), this._offsetPlane = p$s(), this._minDistance = -1 / 0, this._maxDistance = 1 / 0, this._selectedArrow = 1, n2 === j$8.IMMEDIATE && this._initialize();
  }
  get plane() {
    return this._plane;
  }
  get requiresSplitEdgeLeft() {
    return !this._left.isOriginalDirection;
  }
  get requiresSplitEdgeRight() {
    return !this._right.isOriginalDirection;
  }
  get edgeDirection() {
    return this._edgeDirection;
  }
  _initialize() {
    this._initializeNeighbors(), this._initializePlane(), this._initializeDistanceConstraints();
  }
  _initializeNeighbors() {
    var _a2, _b2, _c2, _d2;
    const t2 = this._toXYZ(this._edge.leftVertex.pos), i2 = this._toXYZ((_b2 = (_a2 = this._edge.leftVertex.leftEdge) == null ? void 0 : _a2.leftVertex) == null ? void 0 : _b2.pos), e2 = this._toXYZ(this._edge.rightVertex.pos), s2 = this._toXYZ((_d2 = (_c2 = this._edge.rightVertex.rightEdge) == null ? void 0 : _c2.rightVertex) == null ? void 0 : _d2.pos);
    this._edgeDirection = H$k(n$2v(), t2, e2), this._left = this._computeNeighbor(t2, i2, this._edgeDirection), this._right = this._computeNeighbor(e2, s2, this._edgeDirection);
  }
  _toXYZ(t2) {
    return r$1$(t2) ? this._helper.toXYZ(t2) : null;
  }
  _pointToXYZ(t2) {
    return this._toXYZ(this._helper.pointToVector(t2));
  }
  _computeNeighbor(t2, i2, s2) {
    if (t$2r(i2))
      return { start: t2, end: i2, direction: r$1B(-s2[1], s2[0], 0), isOriginalDirection: true };
    const n2 = H$k(n$2v(), t2, i2), r2 = !this._passesBisectingAngleThreshold(n2, s2);
    return { start: t2, end: i2, direction: r2 ? this._bisectVectorsPerpendicular(s2, n2) : n2, isOriginalDirection: !r2 };
  }
  _passesBisectingAngleThreshold(t2, i2) {
    const e2 = Math.abs(a$k(i2, t2));
    return e2 >= T$8 && e2 <= Math.PI - T$8;
  }
  _bisectVectorsPerpendicular(t2, i2) {
    const e2 = P$A(t2, i2) < 0 ? t2 : j$T(n$2v(), t2), s2 = Math.abs(P$A(e2, i2));
    if (!(s2 < Z$4 || s2 > 1 - Z$4))
      return this._bisectDirection(e2, i2);
    const n2 = _$K(n$2v(), e2, [0, 0, 1]);
    return z$G(n2, n2);
  }
  _bisectDirection(t2, i2) {
    const e2 = u$1S(n$2v(), t2, i2);
    return z$G(e2, e2);
  }
  _initializePlane() {
    const t2 = this._computeNormalDirection(this._left), i2 = this._computeNormalDirection(this._right);
    P$A(t2, i2) < 0 && j$T(i2, i2), _$a(this._left.start, this._bisectDirection(t2, i2), this._plane);
  }
  _computeNormalDirection(t2) {
    const i2 = _$K(n$2v(), t2.direction, this._edgeDirection);
    z$G(i2, i2);
    const e2 = _$K(n$2v(), this._edgeDirection, i2);
    return this._planeType === A$7.XY && (e2[2] = 0), z$G(e2, e2);
  }
  _initializeDistanceConstraints() {
    r$1$(this._left.end) && !this.requiresSplitEdgeLeft && this._updateDistanceConstraint(R$7(this._plane, this._left.end)), r$1$(this._right.end) && !this.requiresSplitEdgeRight && this._updateDistanceConstraint(R$7(this._plane, this._right.end)), this._updateIntersectDistanceConstraint(this._plane);
  }
  _updateDistanceConstraint(t2) {
    t2 <= 0 && (this._minDistance = Math.max(this._minDistance, t2)), t2 >= 0 && (this._maxDistance = Math.min(this._maxDistance, t2));
  }
  _updateIntersectDistanceConstraint(t2) {
    const i2 = Y$4(t2), e2 = this._edgeDirection, o2 = u$1S(n$2v(), this._left.start, this._left.direction), a2 = u$1S(n$2v(), this._right.start, this._right.direction), _2 = this._pointInBasis2D(n$S(), i2, e2, this._left.start), c2 = this._pointInBasis2D(n$S(), i2, e2, o2), l2 = this._pointInBasis2D(n$S(), i2, e2, this._right.start), g2 = this._pointInBasis2D(n$S(), i2, e2, a2), [f2] = j$9({ start: c2, end: _2, type: b$a.LINE }, { start: g2, end: l2, type: b$a.LINE });
    if (!f2)
      return;
    const u2 = o$I(n$S(), _2, c2);
    v$m(u2, u2);
    const D2 = o$I(n$S(), f2, c2), E2 = j$e(u2, D2), b2 = u$1S(n$2v(), o2, g$19(n$2v(), this._left.direction, -E2)), I2 = R$7(t2, b2);
    this._updateDistanceConstraint(I2);
  }
  _pointInBasis2D(t2, i2, e2, s2) {
    return t2[0] = f$g(i2, s2), t2[1] = f$g(e2, s2), t2;
  }
  _offset(t2, e2) {
    Number.isFinite(this._minDistance) && (e2 = Math.max(this._minDistance, e2)), Number.isFinite(this._maxDistance) && (e2 = Math.min(this._maxDistance, e2)), A$9(this._offsetPlane, this._plane), this._offsetPlane[3] -= e2;
    const s2 = (t3, e3, s3) => r$1$(e3) && V$8(this._offsetPlane, t3, u$1S(n$2v(), t3, e3), s3), n2 = n$2v();
    (t2 === this._edge.leftVertex ? s2(this._left.start, this._left.direction, n2) : s2(this._right.start, this._right.direction, n2)) && this._helper.copy(this._helper.fromXYZ(n2, void 0, this._helper.getM(t2.pos)), t2.pos);
  }
  selectArrowFromStartPoint(t2) {
    this._selectedArrow = z$a(this.plane, this._pointToXYZ(t2)) ? 1 : -1;
  }
  get selectedArrow() {
    return this._selectedArrow;
  }
  signedDistanceToPoint(t2) {
    return R$7(this.plane, this._pointToXYZ(t2));
  }
  apply(t2) {
    this._offset(t2, this.distance);
  }
  undo(t2) {
    this._offset(t2, 0);
  }
  canAccumulate(t2) {
    return t2 instanceof P$8 && this._edge.leftVertex.index === t2._edge.leftVertex.index && this._edge.rightVertex.index === t2._edge.rightVertex.index && this._edge.component === t2._edge.component && this._maybeEqualsVec3(this._left.direction, t2._left.direction) && this._maybeEqualsVec3(this._right.direction, t2._right.direction) && G$t(Y$4(this._plane), Y$4(t2._plane));
  }
  accumulate(t2, i2) {
    const e2 = this._plane[3] - i2._plane[3] + i2.distance;
    this._offset(t2, e2);
  }
  accumulateParams(t2) {
    const i2 = t2.distance - t2._plane[3];
    this.distance = i2 + this._plane[3];
  }
  clone() {
    const t2 = new P$8(this._helper, this._planeType, this._edge, this.distance, j$8.DEFERRED);
    return A$9(t2._plane, this._plane), A$9(t2._offsetPlane, this._offsetPlane), t2._maxDistance = this._maxDistance, t2._minDistance = this._minDistance, t2._left = this._cloneNeighbor(this._left), t2._right = this._cloneNeighbor(this._right), t2._edgeDirection = r$1z(n$2v(), this._edgeDirection), t2;
  }
  _maybeEqualsVec3(t2, s2) {
    return t$2r(t2) && t$2r(s2) || r$1$(t2) && r$1$(s2) && G$t(t2, s2);
  }
  _cloneNeighbor({ start: t2, end: e2, direction: s2, isOriginalDirection: n2 }) {
    return { start: r$1z(n$2v(), t2), end: r$1$(e2) ? r$1z(n$2v(), e2) : null, direction: r$1z(n$2v(), s2), isOriginalDirection: n2 };
  }
}
const T$8 = m$2a(15), Z$4 = 1e-3;
var A$7, j$8;
!function(t2) {
  t2[t2.XYZ = 0] = "XYZ", t2[t2.XY = 1] = "XY";
}(A$7 || (A$7 = {})), function(t2) {
  t2[t2.IMMEDIATE = 0] = "IMMEDIATE", t2[t2.DEFERRED = 1] = "DEFERRED";
}(j$8 || (j$8 = {}));
class s$n {
  constructor(t2, a2, s2 = e$i.CUMULATIVE) {
    this.origin = t2, this.angle = a2, this._accumulationType = s2;
  }
  _rotate(t2, i2) {
    L$9(t2.pos, t2.pos, this.origin, i2);
  }
  apply(t2) {
    this._rotate(t2, this.angle);
  }
  undo(t2) {
    this._rotate(t2, -this.angle);
  }
  canAccumulate(a2) {
    return a2 instanceof s$n && i$3e(this.origin, a2.origin);
  }
  accumulate(t2, a2) {
    const s2 = a2._accumulationType === e$i.REPLACE;
    this._rotate(t2, s2 ? a2.angle - this.angle : a2.angle);
  }
  accumulateParams(t2) {
    const a2 = t2._accumulationType === e$i.REPLACE;
    this.angle = a2 ? t2.angle : this.angle + t2.angle;
  }
}
class c$o {
  constructor(t2, a2, c2, o2, r2 = e$i.CUMULATIVE) {
    this.origin = t2, this.axis1 = a2, this.factor1 = c2, this.factor2 = o2, this._accumulationType = r2, this.axis2 = r$N(a2[1], -a2[0]);
  }
  _scale(t2, s2, i2) {
    w$h(t2.pos, t2.pos, this.origin, this.axis1, s2), w$h(t2.pos, t2.pos, this.origin, this.axis2, i2);
  }
  apply(t2) {
    this._scale(t2, this.factor1, this.factor2);
  }
  undo(t2) {
    this._scale(t2, 1 / this.factor1, 1 / this.factor2);
  }
  canAccumulate(s2) {
    return s2 instanceof c$o && i$3e(this.origin, s2.origin) && i$3e(this.axis1, s2.axis1);
  }
  accumulate(t2, s2) {
    s2._accumulationType === e$i.REPLACE ? this._scale(t2, s2.factor1 / this.factor1, s2.factor2 / this.factor2) : this._scale(t2, s2.factor1, s2.factor2);
  }
  accumulateParams(t2) {
    const s2 = t2._accumulationType === e$i.REPLACE;
    this.factor1 = s2 ? t2.factor1 : this.factor1 * t2.factor1, this.factor2 = s2 ? t2.factor2 : this.factor2 * t2.factor2;
  }
}
class t$j {
  constructor() {
    this._operations = [], this._closed = false;
  }
  close() {
    this._closed = true;
  }
  apply() {
    for (const t2 of this._operations)
      t2.apply();
  }
  undo() {
    for (let t2 = this._operations.length - 1; t2 >= 0; t2--)
      this._operations[t2].undo();
  }
  accumulate(t2) {
    if (this._closed)
      return false;
    const o2 = this._operations.length ? this._operations[this._operations.length - 1] : null;
    return o2 && o2.accumulate(t2) || (this._operations.push(t2), t2.apply()), true;
  }
}
class V$7 extends n$2G {
  constructor(e2) {
    super(), this.data = e2, this._undoStack = [], this._redoStack = [], this._listener = this.data.on("change", (e3) => {
      e3.addedVertices && this.emit("vertex-add", { type: "vertex-add", vertices: e3.addedVertices, operation: e3.operation }), e3.removedVertices && this.emit("vertex-remove", { type: "vertex-remove", vertices: e3.removedVertices, operation: e3.operation }), e3.updatedVertices && this.emit("vertex-update", { type: "vertex-update", vertices: e3.updatedVertices, operation: e3.operation });
    });
  }
  destroy() {
    this._listener.remove();
  }
  splitEdge(e2, t2) {
    return this._apply(new r$n(this.data, e2, t2));
  }
  updateVertices(e2, t2, r2 = E$d.ACCUMULATE_STEPS) {
    return this._apply(new t$p(this.data, e2, t2), r2);
  }
  moveVertices(e2, t2, r2, s2, i2 = E$d.ACCUMULATE_STEPS) {
    return this.updateVertices(e2, new t$o(this.data.coordinateHelper, t2, r2, s2), i2);
  }
  scaleVertices(e2, t2, r2, s2, i2, a2 = E$d.ACCUMULATE_STEPS, p2 = e$i.CUMULATIVE) {
    return this.updateVertices(e2, new c$o(t2, r2, s2, i2, p2), a2);
  }
  rotateVertices(e2, t2, r2, s2 = E$d.ACCUMULATE_STEPS, i2 = e$i.CUMULATIVE) {
    return this.updateVertices(e2, new s$n(t2, r2, i2), s2);
  }
  removeVertices(e2) {
    return this._apply(new r$o(this.data, e2, this._minNumVerticesPerType));
  }
  appendVertex(e2) {
    return this.data.components.length === 0 ? null : this._apply(new d$g(this.data, this.data.components[0], e2));
  }
  setVertexPosition(e2, t2) {
    return this._apply(new i$y(this.data, e2, t2));
  }
  offsetEdge(e2, t2, r2, s2 = E$d.ACCUMULATE_STEPS) {
    return this.updateVertices([t2.leftVertex, t2.rightVertex], new P$8(this.data.coordinateHelper, e2, t2, r2), s2);
  }
  closeComponent(e2) {
    return this.data.components.includes(e2) ? this._apply(new i$x(this.data, e2)) : null;
  }
  canRemoveVertex() {
    return this.data.components[0].vertices.length > this._minNumVerticesPerType;
  }
  createUndoGroup() {
    const e2 = new t$j();
    return this._apply(e2), { remove: () => e2.close() };
  }
  undo() {
    if (this._undoStack.length > 0) {
      const e2 = this._undoStack.pop();
      return e2.undo(), this._redoStack.push(e2), e2;
    }
    return null;
  }
  redo() {
    if (this._redoStack.length > 0) {
      const e2 = this._redoStack.pop();
      return e2.apply(), this._undoStack.push(e2), e2;
    }
    return null;
  }
  get canUndo() {
    return this._undoStack.length > 0;
  }
  get canRedo() {
    return this._redoStack.length > 0;
  }
  get lastOperation() {
    return this._undoStack.length > 0 ? this._undoStack[this._undoStack.length - 1] : null;
  }
  get _minNumVerticesPerType() {
    switch (this.data.type) {
      case "point":
        return 1;
      case "polyline":
        return 2;
      case "polygon":
        return 3;
      default:
        return 0;
    }
  }
  _apply(e2, r2 = E$d.ACCUMULATE_STEPS) {
    return r2 !== E$d.NEW_STEP && !t$2r(this.lastOperation) && this.lastOperation.accumulate(e2) || (e2.apply(), this._undoStack.push(e2), this._redoStack = []), e2;
  }
  static fromGeometry(e2, t2) {
    return new V$7(g$d.fromGeometry(e2, t2));
  }
}
class e$d {
  constructor(e2) {
    this.vertexHandle = null, this.excludeFeature = null, this.visualizer = null, this.selfSnappingZ = null, this.editGeometryOperations = e2.editGeometryOperations, this.elevationInfo = e2.elevationInfo, this.pointer = e2.pointer, this.vertexHandle = e2.vertexHandle, this.excludeFeature = e2.excludeFeature, this.visualizer = e2.visualizer, this.selfSnappingZ = e2.selfSnappingZ;
  }
  get coordinateHelper() {
    return this.editGeometryOperations.data.coordinateHelper;
  }
}
let h$i = class extends m$2q {
  constructor(t2) {
    super(t2), this.constrainResult = (t3) => t3, this._snapPoints = null, this._abortController = null, this._stagedPoint = null, this._snap = x$14(async (t3, s2, r2, e2) => {
      const i2 = await this._frameTask.schedule(() => s2.snap(__spreadProps(__spreadValues({}, t3), { context: r2, signal: e2 })), e2);
      i2.valid && await this._frameTask.schedule(() => {
        this.stagedPoint = i2.apply(), t3 !== this._snapPoints && r$1$(this._snapPoints) && (this.stagedPoint = s2.update(__spreadProps(__spreadValues({}, this._snapPoints), { context: r2 })));
      }, e2);
    });
  }
  get stagedPoint() {
    return this._stagedPoint;
  }
  set stagedPoint(t2) {
    this._stagedPoint = this.constrainResult(t2);
  }
  initialize() {
    var _a2, _b2;
    const t2 = this.view.type === "3d" ? (_b2 = (_a2 = this.view) == null ? void 0 : _a2.resourceController) == null ? void 0 : _b2.scheduler : null;
    this._frameTask = r$1$(t2) ? t2.registerTask(I$f.SNAPPING) : y$o;
  }
  destroy() {
    this._abortController = p$3M(this._abortController), this._frameTask = h$1W(this._frameTask);
  }
  async snap(t2, s2, o2) {
    const { point: r2, scenePoint: e2 } = t2;
    return this.stagedPoint = s2.update({ point: r2, scenePoint: e2, context: o2 }), this._snapPoints = t2, t$2r(this._abortController) && (this._abortController = new AbortController()), this._snap(t2, s2, o2, this._abortController.signal);
  }
  abort() {
    this._abortController = p$3M(this._abortController);
  }
};
e$2g([y$1I({ constructOnly: true })], h$i.prototype, "view", void 0), e$2g([y$1I()], h$i.prototype, "stagedPoint", null), e$2g([y$1I()], h$i.prototype, "constrainResult", void 0), e$2g([y$1I()], h$i.prototype, "_stagedPoint", void 0), h$i = e$2g([n$2P("esri.views.interactive.snapping.SnappingOperation")], h$i);
var G$9;
let V$6 = G$9 = class extends n$2G.EventedAccessor {
  constructor(e2) {
    var _a2;
    super(e2), this._hasZ = null, this._cursorScreenPoint = null, this._activePointerId = null, this._stagedVertexUnsnapped = null, this._lastVertexUnsnapped = null, this._handles = new t$2g(), this._viewHandlesKey = "view-handles", this._undoRedoHandlesKey = "undo-redo-handles", this._drawToolHandlesKey = "draw-tool", this._nativeEventHistory = { undoStack: [], redoStack: [] }, this.interactiveUndoDisabled = false, this.history = [], this.redoHistory = [], this.snapToScene = false, this.view = null, this.elevationInfo = null, this.defaultZ = 0, this._coordinateHelper = w$c(e2.hasZ, false, e2.view.spatialReference), this._snappingManager = e2.snappingManager, this._editGeometryOperations = new V$7(new g$d((_a2 = e2.editGeometryType) != null ? _a2 : "polygon", this._coordinateHelper)), this._snappingGraphicsLayer = new h$r({ id: G$9.SNAPPING_GRAPHICS_LAYER_ID, listMode: "hide", internal: true }), this._snappingContext = new e$d({ editGeometryOperations: this._editGeometryOperations, elevationInfo: { mode: "on-the-ground", offset: 0 }, pointer: "mouse", visualizer: new g$e(this._snappingGraphicsLayer) }), this._activeComponent = new p$v(e2.view.spatialReference, l$U.Local), this._editGeometryOperations.data.components.push(this._activeComponent);
  }
  normalizeCtorArgs(e2) {
    const t2 = __spreadValues({}, e2);
    return delete t2.editGeometryType, t2;
  }
  initialize() {
    this._snappingOperation = new h$i({ view: this.view }), this.view.type === "2d" && this.view.map.layers.add(this._snappingGraphicsLayer);
  }
  destroy() {
    this._handles.destroy(), this.view.map.layers.remove(this._snappingGraphicsLayer), this._snappingGraphicsLayer.destroy(), r$1$(this._snappingManager) && this._snappingManager.doneSnapping(), this._snappingOperation = s$2D(this._snappingOperation), this._editGeometryOperations.destroy();
  }
  get _committedVertices() {
    return this._editGeometryOperations.data.components[0].vertices.map((e2) => e2.pos);
  }
  get vertices() {
    return r$1$(this._stagedVertex) ? [...this._committedVertices, this._coordinateHelper.pointToArray(this._stagedVertex)] : this._committedVertices;
  }
  get hasZ() {
    return r$1$(this._hasZ) ? this._hasZ : this.view.type === "3d";
  }
  set hasZ(e2) {
    this._hasZ = e2, this.notifyChange("hasZ");
  }
  get _stagedVertex() {
    return this._snappingOperation.stagedPoint;
  }
  set _stagedVertex(e2) {
    this._snappingOperation.stagedPoint = y$1L(e2);
  }
  canUndo() {
    return this._editGeometryOperations.canUndo;
  }
  canRedo() {
    return this._editGeometryOperations.canRedo;
  }
  undo() {
    this.canUndo && this._editGeometryOperations.undo();
  }
  redo() {
    this.canRedo && this._editGeometryOperations.redo();
  }
  getCoordsFromScreenPoint(e2) {
    const t2 = this.screenToMap(e2);
    return t$2r(t2) ? null : t2.hasZ ? [t2.x, t2.y, t2.z] : [t2.x, t2.y];
  }
  getCoordsAndPointFromScreenPoint(e2) {
    const t2 = this.screenToMap(e2);
    return t$2r(t2) ? null : t2.hasZ ? { vertex: [t2.x, t2.y, t2.z], mapPoint: t2 } : { vertex: [t2.x, t2.y], mapPoint: t2 };
  }
  screenToMap(e2) {
    let t2 = null;
    if (this.view.type === "3d")
      if (this.hasZ) {
        const i2 = i$3f(this.elevationInfo, O$8);
        t2 = this.view.sceneIntersectionHelper.intersectElevationFromScreen(i$2w(e2.x, e2.y), i2, this._getGeometryZValue());
      } else {
        const i2 = i$3f(this.elevationInfo, P$7);
        t2 = this.view.sceneIntersectionHelper.intersectElevationFromScreen(i$2w(e2.x, e2.y), i2, 0), r$1$(t2) && (t2.z = void 0);
      }
    else
      t2 = this.view.toMap(e2), r$1$(t2) && (t2.z = this.hasZ ? this._getGeometryZValue() : void 0);
    return t2;
  }
  _pushCursorVertex(e2, t2) {
    const i2 = v$h(e2[0], e2[1], null, this.view.spatialReference);
    this._stagedVertexUnsnapped = i2;
    const r2 = this._snappingManager;
    if (t$2r(r2))
      return this._stagedVertex = i2, void t2();
    g$1m(this._snappingOperation.snap({ point: i2 }, r2, this._snappingContext)).then(() => {
      t2();
    });
  }
  _popCursorVertex() {
    this._stagedVertexUnsnapped = null, this._stagedVertex = null;
  }
  _getGeometryZValue() {
    return this.defaultZ;
  }
  _abortSnapping() {
    this._snappingOperation.abort();
  }
  _isDuplicateOfLastVertex(e2) {
    const t2 = this._editGeometryOperations.data.components[0].getLastVertex();
    if (r$1$(t2) && e2[0] === t2[0] && e2[1] === t2[1])
      return true;
    const { x: i2, y: r2 } = this._coordinateHelper.vectorToDehydratedPoint(e2);
    return !(!r$1$(this._lastVertexUnsnapped) || i2 !== this._lastVertexUnsnapped.x || r2 !== this._lastVertexUnsnapped.y);
  }
  _shouldHandlePointerEvent(e2) {
    return this._isPrimaryPointerAction(e2) && (t$2r(this._activePointerId) || this._activePointerId === e2.pointerId);
  }
  _vertexAddHandler(e2) {
    const t2 = r$1$(this._stagedVertex) ? this._coordinateHelper.pointToArray(this._stagedVertex) : this.getCoordsFromScreenPoint(this._cursorScreenPoint);
    r$1$(t2) && this._addVertex(t2, e2.native);
  }
  _drawCompleteHandler(e2) {
    this._completeDrawing(e2.native);
  }
  _isPrimaryPointerAction(e2) {
    return e2.pointerType !== "mouse" || e2.button === 0;
  }
};
V$6.SNAPPING_GRAPHICS_LAYER_ID = "DrawAction-snapping-graphics-layer", e$2g([y$1I({ readOnly: true })], V$6.prototype, "vertices", null), e$2g([y$1I({ type: Boolean, nonNullable: true })], V$6.prototype, "interactiveUndoDisabled", void 0), e$2g([y$1I({ readOnly: true })], V$6.prototype, "history", void 0), e$2g([y$1I({ readOnly: true })], V$6.prototype, "redoHistory", void 0), e$2g([y$1I()], V$6.prototype, "snapToScene", void 0), e$2g([y$1I()], V$6.prototype, "view", void 0), e$2g([y$1I()], V$6.prototype, "elevationInfo", void 0), e$2g([y$1I({ nonNullable: true })], V$6.prototype, "defaultZ", void 0), e$2g([y$1I()], V$6.prototype, "hasZ", null), e$2g([y$1I()], V$6.prototype, "_snappingOperation", void 0), e$2g([y$1I()], V$6.prototype, "_stagedVertex", null), V$6 = G$9 = e$2g([n$2P("esri.views.draw.DrawAction")], V$6);
const O$8 = { mode: "absolute-height", offset: 0 }, P$7 = { mode: "on-the-ground", offset: 0 }, S$9 = V$6;
class t$i {
  constructor(t2, e2, s2, i2) {
    this.view = t2, this.native = e2, this.vertexIndex = s2, this.vertices = i2, this.defaultPrevented = false, this.type = "vertex-add";
  }
  preventDefault() {
    this.defaultPrevented = true;
  }
}
class s$m {
  constructor(t2, e2, s2, i2) {
    this.view = t2, this.native = e2, this.vertexIndex = s2, this.vertices = i2, this.defaultPrevented = false, this.type = "vertex-remove";
  }
  preventDefault() {
    this.defaultPrevented = true;
  }
}
class i$u {
  constructor(t2, e2, s2, i2, r2 = null) {
    this.view = t2, this.native = e2, this.vertexIndex = s2, this.vertices = i2, this.mapPoint = r2, this.coordinates = null, this.defaultPrevented = false, this.type = "cursor-update", this.coordinates = i2.length === 1 ? i2[0] : null;
  }
  preventDefault() {
    this.defaultPrevented = true;
  }
}
class r$i {
  constructor(t2, e2) {
    this.native = t2, this.vertices = e2, this.coordinates = null, this.defaultPrevented = false, this.type = "draw-complete", this.coordinates = e2.length === 1 ? e2[0] : null;
  }
  preventDefault() {
    this.defaultPrevented = true;
  }
}
const e$c = { redo: "r", undo: "z", center: "Alt", constraint: "Shift", snappingToggle: "Control", cancel: "Escape", delete: ["Backspace", "Delete"], complete: "Enter", vertexAdd: "f", pan: " " };
let _$9 = class extends S$9 {
  constructor(e2) {
    super(e2), this._popVertexOnPointerMove = false, this._addVertexOnPointerUp = false;
  }
  initialize() {
    this._addViewHandles(), this._addUndoRedoHandles();
  }
  destroy() {
    this._removeViewHandles(), this._removeUndoRedoHandles(), this.emit("destroy");
  }
  undo() {
    super.undo(), this.notifyChange("vertices");
  }
  redo() {
    super.redo(), this.notifyChange("vertices");
  }
  complete() {
    this._completeDrawing();
  }
  _addViewHandles() {
    this._removeViewHandles(), this._handles.add([this.view.on("click", (e2) => {
      e2.stopPropagation();
    }, P$h.TOOL), this.view.on("pointer-down", (e2) => {
      this._shouldHandlePointerEvent(e2) && (this._abortSnapping(), this._activePointerId = e2.pointerId, this._addVertexOnPointerUp = true, this._cursorScreenPoint = n$Y(e2), e2.pointerType === "touch" && this._updateCursor(e2.native));
    }, P$h.TOOL), this.view.on("pointer-move", (e2) => {
      this._popVertexOnPointerMove && (this.undo(), this._popVertexOnPointerMove = false), this._abortSnapping(), this._cursorScreenPoint = n$Y(e2), e2.pointerType !== "touch" && this._updateCursor(e2.native);
    }, P$h.TOOL), this.view.on("pointer-drag", (e2) => {
      this._shouldHandlePointerEvent(e2) && (this._abortSnapping(), this._addVertexOnPointerUp = false);
    }, P$h.TOOL), this.view.on("pointer-up", (e2) => {
      if (this._shouldHandlePointerEvent(e2))
        if (this._abortSnapping(), this._activePointerId = null, this._addVertexOnPointerUp)
          this._vertexAddHandler(e2);
        else {
          const t2 = e2.pointerType === "touch";
          this._updateCursor(e2.native, t2);
        }
    }, P$h.TOOL), this.view.on("drag", ["Shift"], (e2) => {
      e2.stopPropagation();
    }, P$h.TOOL), this.view.on("double-click", (e2) => {
      e2.stopPropagation(), this._drawCompleteHandler(e2);
    }, P$h.TOOL), this.view.on("double-click", ["Control"], (e2) => {
      e2.stopPropagation(), this._drawCompleteHandler(e2);
    }, P$h.TOOL), this.view.on("key-down", (e2) => {
      const { key: t2, repeat: i2 } = e2;
      t2 === e$c.vertexAdd && !i2 && this._cursorScreenPoint ? (e2.stopPropagation(), this._abortSnapping(), this._vertexAddHandler(e2)) : t2 !== e$c.complete || i2 ? t2 !== e$c.undo || this.interactiveUndoDisabled || i2 ? t2 !== e$c.redo || this.interactiveUndoDisabled || i2 ? t2 !== e$c.pan || i2 || e2.stopPropagation() : (e2.stopPropagation(), this.redo()) : (e2.stopPropagation(), this.undo()) : (e2.stopPropagation(), this._drawCompleteHandler(e2));
    }, P$h.TOOL), this.view.on("key-up", (e2) => {
      e2.key === e$c.pan && e2.stopPropagation();
    }, P$h.TOOL)], this._viewHandlesKey);
  }
  _addUndoRedoHandles() {
    this._removeUndoRedoHandles(), this._handles.add([this._editGeometryOperations.on("vertex-remove", (e2) => {
      if (this.notifyChange("vertices"), e2.operation === "undo") {
        const i2 = this._nativeEventHistory.undoStack.pop();
        this._nativeEventHistory.redoStack.push(i2);
        const o2 = [...this._committedVertices];
        r$1$(this._stagedVertex) && o2.push(this._coordinateHelper.pointToArray(this._stagedVertex)), this.emit("undo", new s$m(this.view, i2, e2.vertices[0].index, o2));
      }
    }), this._editGeometryOperations.on("vertex-add", (e2) => {
      if (this.notifyChange("vertices"), e2.operation === "apply") {
        const e3 = this._nativeEventHistory.undoStack[this._nativeEventHistory.undoStack.length], t2 = this._committedVertices.length - 1, i2 = new t$i(this.view, e3, t2, this.vertices);
        this.emit("vertex-add", i2), i2.defaultPrevented && (this._popVertexOnPointerMove = true);
      } else if (e2.operation === "redo") {
        const i2 = this._nativeEventHistory.redoStack.pop();
        this._nativeEventHistory.undoStack.push(i2);
        const o2 = [...this._committedVertices];
        r$1$(this._stagedVertex) && o2.push(this._coordinateHelper.pointToArray(this._stagedVertex)), this.emit("redo", new t$i(this.view, i2, e2.vertices[0].index, o2));
      }
    })], this._undoRedoHandlesKey);
  }
  _removeViewHandles() {
    this._handles.remove(this._viewHandlesKey);
  }
  _removeUndoRedoHandles() {
    this._handles.remove(this._undoRedoHandlesKey);
  }
  _addVertex(e2, t2) {
    const i2 = this._coordinateHelper.arrayToVector(e2);
    if (this._isDuplicateOfLastVertex(i2))
      return;
    this._lastVertexUnsnapped = this._stagedVertexUnsnapped, this._popCursorVertex(), this._editGeometryOperations.appendVertex(i2);
    const o2 = t2 || new Event("placeholder");
    this._nativeEventHistory.undoStack.push(o2);
  }
  _updateCursor(e2, i2 = false) {
    if (this._popCursorVertex(), !this._cursorScreenPoint)
      return;
    const o2 = this.getCoordsAndPointFromScreenPoint(this._cursorScreenPoint);
    r$1$(o2) && !i2 && this._pushCursorVertex(o2.vertex, () => this.emit("cursor-update", new i$u(this.view, e2, this._activeComponent.vertices.length, this.vertices, r$1$(this._stagedVertex) ? new w$_(this._stagedVertex) : null)));
  }
  _completeDrawing(e2) {
    if (this._activePointerId = null, this._popCursorVertex(), this._abortSnapping(), r$1$(this._snappingManager) && this._snappingManager.doneSnapping(), this.vertices.length < 1)
      return;
    const i2 = new r$i(e2, this.vertices);
    this.emit("draw-complete", i2), i2.defaultPrevented || this._removeViewHandles();
  }
};
_$9 = e$2g([n$2P("esri.views.draw.MultipointDrawAction")], _$9);
const c$n = ["freehand", "hybrid", "click"], e$b = "click";
class e$a {
  constructor({ grabbableForEvent: e2 }) {
    this.events = new n$2G(), this.interactive = true, this.selectable = false, this.cursor = null, this.grabbable = true, this.grabbableForEvent = e2;
  }
  intersectionDistance(t2, e2) {
    return 0;
  }
  attach() {
  }
  detach() {
  }
}
function l$m(e2) {
  return "declaredClass" in e2;
}
function u$h(e2) {
  return "declaredClass" in e2;
}
function c$m(e2) {
  return "declaredClass" in e2;
}
function f$f(r2, n2) {
  if (!r2)
    return null;
  if (c$m(r2))
    return r2;
  const s2 = new g$10({ layer: n2, sourceLayer: n2 });
  return s2.visible = r2.visible, s2.symbol = y$1L(r2.symbol), s2.attributes = y$1L(r2.attributes), s2.geometry = p$r(r2.geometry), s2;
}
function p$r(e2) {
  return t$2r(e2) ? null : l$m(e2) ? e2 : v$14(h$h(e2));
}
function h$h(e2) {
  const { wkid: t2, wkt: r2, latestWkid: n2 } = e2.spatialReference, s2 = { wkid: t2, wkt: r2, latestWkid: n2 };
  switch (e2.type) {
    case "point": {
      const { x: t3, y: r3, z: n3, m: a2 } = e2;
      return { x: t3, y: r3, z: n3, m: a2, spatialReference: s2 };
    }
    case "polygon": {
      const { rings: t3, hasZ: r3, hasM: n3 } = e2;
      return { rings: y$b(t3), hasZ: r3, hasM: n3, spatialReference: s2 };
    }
    case "polyline": {
      const { paths: t3, hasZ: r3, hasM: n3 } = e2;
      return { paths: y$b(t3), hasZ: r3, hasM: n3, spatialReference: s2 };
    }
    case "extent": {
      const { xmin: t3, xmax: r3, ymin: n3, ymax: a2, zmin: i2, zmax: o2, mmin: m2, mmax: l2, hasZ: u2, hasM: c2 } = e2;
      return { xmin: t3, xmax: r3, ymin: n3, ymax: a2, zmin: i2, zmax: o2, mmin: m2, mmax: l2, hasZ: u2, hasM: c2, spatialReference: s2 };
    }
    case "multipoint": {
      const { points: t3, hasZ: r3, hasM: n3 } = e2;
      return { points: M$9(t3) ? d$d(t3) : t3, hasZ: r3, hasM: n3, spatialReference: s2 };
    }
    default:
      return;
  }
}
function y$b(e2) {
  return x$a(e2) ? e2.map((e3) => d$d(e3)) : e2;
}
function d$d(e2) {
  return e2.map((e3) => l$2M(e3));
}
function x$a(e2) {
  for (const t2 of e2)
    if (t2.length !== 0)
      return M$9(t2);
  return false;
}
function M$9(e2) {
  return e2.length && (y$1M(e2[0]) || A$E(e2[0]));
}
function k$7(e2, t2) {
  if (!e2)
    return null;
  let r2;
  if (u$h(e2)) {
    if (t2 == null)
      return e2.clone();
    if (u$h(t2))
      return t2.copy(e2);
  }
  return t2 != null ? (r2 = t2, r2.x = e2.x, r2.y = e2.y, r2.spatialReference = e2.spatialReference, e2.hasZ ? (r2.z = e2.z, r2.hasZ = e2.hasZ) : (r2.z = null, r2.hasZ = false), e2.hasM ? (r2.m = e2.m, r2.hasM = true) : (r2.m = null, r2.hasM = false)) : (r2 = v$h(e2.x, e2.y, e2.z, e2.spatialReference), e2.hasM && (r2.m = e2.m, r2.hasM = true)), r2;
}
function Z$3(e2) {
  const { wkid: t2, wkt: r2, latestWkid: n2 } = e2, s2 = { wkid: t2, wkt: r2, latestWkid: n2 };
  return k$C.fromJSON(s2);
}
function r$h(t2, n2, e2, r2) {
  if (r2 == null || t2.hasZ || (r2 = void 0), t2.type === "point")
    return t2.x += n2, t2.y += e2, t2.hasZ && r2 != null && (t2.z += r2), t2;
  if (t2.type === "multipoint") {
    const o2 = t2.points;
    for (let t3 = 0; t3 < o2.length; t3++)
      o2[t3] = l$l(o2[t3], n2, e2, r2);
    return t2;
  }
  if (t2.type === "extent")
    return t2.xmin += n2, t2.xmax += n2, t2.ymin += e2, t2.ymax += e2, r2 != null && (t2.zmin += r2, t2.zmax += r2), t2;
  const s2 = r$1L(t2), i2 = t2.type === "polyline" ? t2.paths : t2.rings;
  for (let o2 = 0; o2 < s2.length; o2++) {
    const t3 = s2[o2];
    for (let o3 = 0; o3 < t3.length; o3++)
      t3[o3] = l$l(t3[o3], n2, e2, r2);
  }
  return "paths" in t2 ? t2.paths = i2 : t2.rings = i2, t2;
}
function s$l(t2, n2, e2, s2, i2) {
  const a2 = t2.clone(), m2 = s2.resolution;
  if (a2.type === "point") {
    if (i2)
      r$h(a2, n2 * m2, -e2 * m2);
    else {
      const t3 = s2.state.transform, o2 = s2.state.inverseTransform, r2 = t3[0] * a2.x + t3[2] * a2.y + t3[4], i3 = t3[1] * a2.x + t3[3] * a2.y + t3[5];
      a2.x = o2[0] * (r2 + n2) + o2[2] * (i3 + e2) + o2[4], a2.y = o2[1] * (r2 + n2) + o2[3] * (i3 + e2) + o2[5];
    }
    return a2;
  }
  if (a2.type === "multipoint") {
    if (i2)
      r$h(a2, n2 * m2, -e2 * m2);
    else {
      const t3 = a2.points, o2 = s2.state.transform, r2 = s2.state.inverseTransform;
      for (let s3 = 0; s3 < t3.length; s3++) {
        const i3 = t3[s3], a3 = o2[0] * i3[0] + o2[2] * i3[1] + o2[4], m3 = o2[1] * i3[0] + o2[3] * i3[1] + o2[5], l2 = r2[0] * (a3 + n2) + r2[2] * (m3 + e2) + r2[4], p2 = r2[1] * (a3 + n2) + r2[3] * (m3 + e2) + r2[5];
        t3[s3] = x$9(i3, l2, p2, void 0);
      }
    }
    return a2;
  }
  if (a2.type === "extent") {
    if (i2)
      r$h(a2, n2 * m2, -e2 * m2);
    else {
      const t3 = s2.state.transform, o2 = s2.state.inverseTransform, r2 = t3[0] * a2.xmin + t3[2] * a2.ymin + t3[4], i3 = t3[1] * a2.xmin + t3[3] * a2.ymin + t3[5], m3 = t3[0] * a2.xmax + t3[2] * a2.ymax + t3[4], l2 = t3[1] * a2.xmax + t3[3] * a2.ymax + t3[5];
      a2.xmin = o2[0] * (r2 + n2) + o2[2] * (i3 + e2) + o2[4], a2.ymin = o2[1] * (r2 + n2) + o2[3] * (i3 + e2) + o2[5], a2.xmax = o2[0] * (m3 + n2) + o2[2] * (l2 + e2) + o2[4], a2.ymax = o2[1] * (m3 + n2) + o2[3] * (l2 + e2) + o2[5];
    }
    return a2;
  }
  if (i2)
    r$h(a2, n2 * m2, -e2 * m2);
  else {
    const t3 = r$1L(a2), r2 = a2.type === "polyline" ? a2.paths : a2.rings, i3 = s2.state.transform, m3 = s2.state.inverseTransform;
    for (let o2 = 0; o2 < t3.length; o2++) {
      const r3 = t3[o2];
      for (let t4 = 0; t4 < r3.length; t4++) {
        const o3 = r3[t4], s3 = i3[0] * o3[0] + i3[2] * o3[1] + i3[4], a3 = i3[1] * o3[0] + i3[3] * o3[1] + i3[5], l2 = m3[0] * (s3 + n2) + m3[2] * (a3 + e2) + m3[4], p2 = m3[1] * (s3 + n2) + m3[3] * (a3 + e2) + m3[5];
        r3[t4] = x$9(o3, l2, p2, void 0);
      }
    }
    "paths" in a2 ? a2.paths = r2 : a2.rings = r2;
  }
  return a2;
}
function i$t(t2, r2, s2, i2) {
  if (t2.type === "point") {
    const { x: n2, y: e2 } = t2, o2 = i2 ? i2[0] : n2, a3 = i2 ? i2[1] : e2, m3 = t2.clone(), l3 = (n2 - o2) * r2 + o2, x2 = (e2 - a3) * s2 + a3;
    return m3.x = l3, m3.y = x2, m3;
  }
  if (t2.type === "multipoint") {
    const a3 = r$1L(t2), m3 = u$1O(), [l3, p3, y3, f3] = h$1I(m3, [a3]), u3 = i2 ? i2[0] : (l3 + y3) / 2, c3 = i2 ? i2[1] : (f3 + p3) / 2, h3 = t2.clone(), g3 = h3.points;
    for (let t3 = 0; t3 < g3.length; t3++) {
      const n2 = g3[t3], [e2, o2] = n2, i3 = (e2 - u3) * r2 + u3, a4 = (o2 - c3) * s2 + c3;
      g3[t3] = x$9(n2, i3, a4, void 0);
    }
    return h3;
  }
  if (t2.type === "extent") {
    const { xmin: n2, xmax: e2, ymin: o2, ymax: a3 } = t2, m3 = i2 ? i2[0] : (n2 + e2) / 2, l3 = i2 ? i2[1] : (a3 + o2) / 2, x2 = t2.clone();
    if (x2.xmin = (n2 - m3) * r2 + m3, x2.ymax = (a3 - l3) * s2 + l3, x2.xmax = (e2 - m3) * r2 + m3, x2.ymin = (o2 - l3) * s2 + l3, x2.xmin > x2.xmax) {
      const t3 = x2.xmin, n3 = x2.xmax;
      x2.xmin = n3, x2.xmax = t3;
    }
    if (x2.ymin > x2.ymax) {
      const t3 = x2.ymin, n3 = x2.ymax;
      x2.ymin = n3, x2.ymax = t3;
    }
    return x2;
  }
  const a2 = r$1L(t2), m2 = u$1O(), [l2, p2, y2, f2] = h$1I(m2, a2), u2 = i2 ? i2[0] : (l2 + y2) / 2, c2 = i2 ? i2[1] : (f2 + p2) / 2, h2 = t2.clone(), g2 = h2.type === "polyline" ? h2.paths : h2.rings;
  for (let n2 = 0; n2 < a2.length; n2++) {
    const t3 = a2[n2];
    for (let e2 = 0; e2 < t3.length; e2++) {
      const o2 = t3[e2], [i3, a3] = o2, m3 = (i3 - u2) * r2 + u2, l3 = (a3 - c2) * s2 + c2;
      g2[n2][e2] = x$9(o2, m3, l3, void 0);
    }
  }
  return "paths" in h2 ? h2.paths = g2 : h2.rings = g2, h2;
}
function a$j(t2, n2, e2, o2, r2, s2) {
  const i2 = Math.sqrt((e2 - t2) * (e2 - t2) + (o2 - n2) * (o2 - n2));
  return Math.sqrt((r2 - t2) * (r2 - t2) + (s2 - n2) * (s2 - n2)) / i2;
}
function m$w(n2, e2, o2) {
  const r2 = Math.atan2(e2.y - o2.y, e2.x - o2.x) - Math.atan2(n2.y - o2.y, n2.x - o2.x), s2 = Math.atan2(Math.sin(r2), Math.cos(r2));
  return b$10(s2);
}
function l$l(t2, n2, e2, o2) {
  return x$9(t2, t2[0] + n2, t2[1] + e2, t2[2] != null && o2 != null ? t2[2] + o2 : void 0);
}
function x$9(t2, n2, e2, o2) {
  const r2 = [n2, e2];
  return t2.length > 2 && r2.push(o2 != null ? o2 : t2[2]), t2.length > 3 && r2.push(t2[3]), r2;
}
function y$a(t2, n2) {
  let e2 = null, a2 = null;
  return (s2) => {
    if (s2.action === "cancel")
      return void (r$1$(a2) && (a2.execute({ action: "cancel" }), e2 = null, a2 = null));
    const c2 = { action: s2.action, screenStart: s2.start, screenEnd: s2.screenPoint };
    s2.action === "start" && t$2r(e2) && (e2 = new G$8(), a2 = new G$8(), n2(t2, e2, a2, s2.pointerType, c2)), r$1$(e2) && e2.execute(c2), s2.action === "end" && r$1$(e2) && (e2 = null, a2 = null);
  };
}
function d$c(t2, n2) {
  return t2.events.on("drag", y$a(t2, n2));
}
function g$c(t2, n2) {
  const e2 = [t2.x, t2.y, t2.z], r2 = n2, o2 = [Math.cos(r2), Math.sin(r2)], a2 = Math.sqrt(o2[0] * o2[0] + o2[1] * o2[1]);
  if (a2 === 0)
    return null;
  o2[0] /= a2, o2[1] /= a2;
  const s2 = (t3) => {
    const n3 = (t3.x - e2[0]) * o2[0] + (t3.y - e2[1]) * o2[1];
    t3.x = e2[0] + n3 * o2[0], t3.y = e2[1] + n3 * o2[1];
  };
  return (t3) => (s2(t3.mapStart), s2(t3.mapEnd), __spreadProps(__spreadValues({}, t3), { axis: o2 }));
}
function h$g(t2, n2) {
  let e2 = null;
  return (r2) => {
    if (r2.action === "start" && (e2 = S$8(t2, r2.mapStart.spatialReference, n2)), t$2r(e2))
      return null;
    const a2 = r2.mapEnd.x - r2.mapStart.x, s2 = r2.mapEnd.y - r2.mapStart.y, c2 = r2.mapEnd.z - r2.mapStart.z;
    return e2.move(a2, s2, c2), __spreadProps(__spreadValues({}, r2), { translationX: a2, translationY: s2, translationZ: c2 });
  };
}
function E$a(t2, n2) {
  return t$2r(t2) ? null : t2.spatialReference.equals(n2) ? t2.clone() : rn(t2, n2);
}
function S$8(t2, n2, e2) {
  const r2 = t2.geometry, a2 = Z$3(n2);
  if (t$2r(r2))
    return null;
  if (r2.type === "mesh")
    return j$7(t2, r2, a2, e2);
  const s2 = E$a(r2, a2), c2 = r2.spatialReference;
  return t$2r(s2) ? null : { move: (n3, e3, r3) => {
    const o2 = r$h(s2.clone(), n3, e3, r3);
    o2.spatialReference.equals(c2) ? t2.geometry = o2 : t2.geometry = rn(o2, c2);
  } };
}
function j$7(t2, n2, e2, o2) {
  if (r$1$(n2.transform))
    return z$9(t2, n2, n2.transform, e2);
  if (!n2.spatialReference.equals(e2))
    return null;
  let a2 = 0, s2 = 0, c2 = 0;
  return { move: (e3, r2, i2) => {
    const l2 = e3 - a2, u2 = r2 - s2, f2 = i2 - c2;
    if (l2 || u2 || f2) {
      const y2 = new w$_(n2.origin.x + l2, n2.origin.y + u2, n2.origin.z + f2, n2.origin.spatialReference);
      n2.centerAt(y2, { geographic: o2 === l$U.Global }), t2.notifyGeometryChanged(), a2 = e3, s2 = r2, c2 = i2;
    }
  } };
}
function z$9(t2, n2, e2, a2) {
  const s2 = E$a(e2.getOriginPoint(n2.spatialReference), a2), l2 = n2.spatialReference;
  return t$2r(s2) ? null : { move: (n3, o2, a3) => {
    const u2 = r$h(s2.clone(), n3, o2, a3);
    if (u2.spatialReference.equals(l2))
      e2.origin = r$1B(u2.x, u2.y, u2.z);
    else {
      const t3 = rn(u2, l2);
      r$1$(t3) && (e2.origin = r$1B(t3.x, t3.y, t3.z));
    }
    t2.notifyMeshTransformChanged(), t2.notifyGeometryChanged();
  } };
}
function v$c(t2, n2) {
  const e2 = t2.map((t3) => e$2e(h$g(t3, n2))).filter((t3) => r$1$(t3));
  return (t3) => {
    const n3 = t3.mapEnd.x - t3.mapStart.x, r2 = t3.mapEnd.y - t3.mapStart.y, o2 = t3.mapEnd.z - t3.mapStart.z;
    return e2.forEach((n4) => n4(t3)), __spreadProps(__spreadValues({}, t3), { translationX: n3, translationY: r2, translationZ: o2 });
  };
}
function w$a(t2, e2) {
  const r2 = new Map();
  for (const o2 of e2)
    r2.set(o2, y$1L(t2[o2]));
  return (n2) => (r2.forEach((n3, e3) => {
    t2[e3] = n3;
  }), n2);
}
function M$8(t2) {
  return r$1$(t2.geometry) && t2.geometry.type === "mesh" ? q$6(t2, t2.geometry) : w$a(t2, ["geometry"]);
}
function q$6(t2, n2) {
  const e2 = r$1$(n2.transform) ? n2.transform.clone() : null, o2 = n2.vertexAttributes.clonePositional();
  return (r2) => (n2.transform = e2, n2.vertexAttributes = o2, t2.notifyGeometryChanged(), r2);
}
function D$7(t2) {
  const n2 = t2.map((t3) => e$2e(M$8(t3))).filter((t3) => r$1$(t3));
  return (t3) => (n2.forEach((n3) => n3(t3)), t3);
}
function P$6() {
  let t2 = 0, n2 = 0, e2 = 0;
  return (r2) => {
    r2.action === "start" && (t2 = r2.mapStart.x, n2 = r2.mapStart.y, e2 = r2.mapStart.z);
    const o2 = r2.mapEnd.x - t2, a2 = r2.mapEnd.y - n2, s2 = r2.mapEnd.z - e2;
    return t2 = r2.mapEnd.x, n2 = r2.mapEnd.y, e2 = r2.mapEnd.z, __spreadProps(__spreadValues({}, r2), { mapDeltaX: o2, mapDeltaY: a2, mapDeltaZ: s2, mapDeltaSpatialReference: r2.mapStart.spatialReference });
  };
}
function U$4() {
  let t2 = 0, n2 = 0;
  return (e2) => {
    e2.action === "start" && (t2 = e2.screenStart.x, n2 = e2.screenStart.y);
    const r2 = e2.screenEnd.x - t2, o2 = e2.screenEnd.y - n2;
    return t2 = e2.screenEnd.x, n2 = e2.screenEnd.y, __spreadProps(__spreadValues({}, e2), { screenDeltaX: r2, screenDeltaY: o2 });
  };
}
function C$8(t2, n2) {
  let r2 = null, o2 = 0, a2 = 0;
  return (c2) => {
    if (c2.action === "start" && (r2 = t2.toScreen(n2), r2.x < 0 || r2.x > t2.width || r2.y < 0 || r2.y > t2.height ? r2 = null : (o2 = c2.screenStart.x - r2.x, a2 = c2.screenStart.y - r2.y)), r2 == null)
      return null;
    const i2 = a$2v(c2.screenEnd.x - o2, 0, t2.width), l2 = a$2v(c2.screenEnd.y - a2, 0, t2.height), u2 = c$2K(i2, l2);
    return c2.screenStart = r2, c2.screenEnd = u2, c2;
  };
}
class G$8 {
  constructor() {
    this.execute = () => {
    };
  }
  next(t2, n2 = new G$8()) {
    return r$1$(t2) && (this.execute = (e2) => {
      const o2 = t2(e2);
      r$1$(o2) && n2.execute(o2);
    }), n2;
  }
}
function X$4(t2, n2, e2 = []) {
  if (t2.type === "2d")
    return (t3) => t3;
  let o2 = null;
  return (a2) => {
    a2.action === "start" && (o2 = t2.toMap(a2.screenStart, { exclude: e2 }), r$1$(o2) && (o2.z = d$h(o2, t2, n2)));
    const s2 = t2.toMap(a2.screenEnd, { exclude: e2 });
    r$1$(s2) && (s2.z = d$h(s2, t2, n2));
    const c2 = r$1$(o2) && r$1$(s2) ? { sceneStart: o2, sceneEnd: s2 } : null;
    return __spreadProps(__spreadValues({}, a2), { scenePoints: c2 });
  };
}
let t$h = class extends m$2q {
  constructor(o2) {
    super(o2), this.enabled = false;
  }
};
e$2g([y$1I({ type: Boolean, nonNullable: true })], t$h.prototype, "enabled", void 0), t$h = e$2g([n$2P("esri.views.interactive.sketch.SketchLabelOptions")], t$h);
const c$l = t$h;
let t$g = class extends m$2q {
  constructor(o2) {
    super(o2), this.mode = "absolute-height";
  }
  toJSON() {
    return { mode: this.mode };
  }
};
e$2g([y$1I({ type: String, nonNullable: true })], t$g.prototype, "mode", void 0), t$g = e$2g([n$2P("esri.widgets.Sketch.SketchTooltipOptions.ElevationOptions")], t$g);
let i$s = class extends m$2q {
  constructor() {
    super(...arguments), this.distance = true, this.elevation = true, this.size = true, this.scale = true, this.rotation = true, this.orientation = true, this.totalLength = true, this.area = true, this.radius = true;
  }
  toJSON() {
    return { distance: this.distance, size: this.size, scale: this.scale, rotation: this.rotation, orientation: this.orientation, totalLength: this.totalLength, area: this.area, radius: this.radius };
  }
};
e$2g([y$1I({ type: Boolean, nonNullable: true })], i$s.prototype, "distance", void 0), e$2g([y$1I({ type: Boolean, nonNullable: true })], i$s.prototype, "elevation", void 0), e$2g([y$1I({ type: Boolean, nonNullable: true })], i$s.prototype, "size", void 0), e$2g([y$1I({ type: Boolean, nonNullable: true })], i$s.prototype, "scale", void 0), e$2g([y$1I({ type: Boolean, nonNullable: true })], i$s.prototype, "rotation", void 0), e$2g([y$1I({ type: Boolean, nonNullable: true })], i$s.prototype, "orientation", void 0), e$2g([y$1I({ type: Boolean, nonNullable: true })], i$s.prototype, "totalLength", void 0), e$2g([y$1I({ type: Boolean, nonNullable: true })], i$s.prototype, "area", void 0), e$2g([y$1I({ type: Boolean, nonNullable: true })], i$s.prototype, "radius", void 0), i$s = e$2g([n$2P("esri.widgets.Sketch.SketchTooltipOptions.VisibleElements")], i$s);
let l$k = class extends m$2q {
  constructor(e2) {
    super(e2), this.enabled = false, this.elevation = new t$g(), this.visibleElements = new i$s(), this.visualVariables = null;
  }
  toJSON() {
    return { enabled: this.enabled, elevation: this.elevation, visibleElements: this.visibleElements };
  }
};
e$2g([y$1I({ type: Boolean, nonNullable: true })], l$k.prototype, "enabled", void 0), e$2g([y$1I({ type: t$g, nonNullable: true })], l$k.prototype, "elevation", void 0), e$2g([y$1I({ type: i$s, nonNullable: true })], l$k.prototype, "visibleElements", void 0), e$2g([y$1I()], l$k.prototype, "visualVariables", void 0), l$k = e$2g([n$2P("esri.widgets.Sketch.SketchTooltipOptions")], l$k);
const p$q = l$k;
class u$g {
  constructor() {
    this.next = new G$8();
  }
  createSnapDragEventPipelineStep({ predicate: o2 = () => true, cancel: i2, snappingManager: r2, snappingContext: p2, updatingHandles: l2, useZ: c2 = true }) {
    if (t$2r(r2))
      return (e2) => e2;
    let u2 = null, d2 = null;
    const f2 = () => {
      u2 = p$3M(u2), r2.doneSnapping(), r$1$(d2) && d2.frameTask.remove(), d2 = null;
    };
    i2.next((e2) => (f2(), e2)), this.next = new G$8();
    const m2 = this._createSnapFunction(r2, c2);
    let h2 = null, S2 = null, x2 = null;
    return (n2) => {
      if (!o2(n2))
        return n2;
      if (n2.action === "start") {
        const e2 = this._createFrameTask(r2.view);
        if (d2 = this._createSnappingInfo(p2, n2, e2), d2.context.selfSnappingZ = null, !c2 && r$1$(n2.info)) {
          const e3 = this._extractSelfSnappingZ(p2.coordinateHelper, n2.info.handle.component);
          r$1$(e3) && (d2.context.selfSnappingZ = { value: e3, elevationInfo: p2.elevationInfo });
        }
      }
      if (r$1$(d2)) {
        const { context: t2, originalScenePos: o3, originalPos: i3 } = d2, { mapEnd: s2, mapStart: p3, action: f3, scenePoints: P2 } = n2, g2 = this._updatePosition(i3, this._computeMapDelta(s2, p3)), _2 = this._computeMapDelta(p3, i3), y2 = __spreadProps(__spreadValues({}, n2), { action: "update" }), v2 = d2.context, Z2 = this._updateScenePosition(o3, P2), T2 = r2.update({ point: g2, scenePoint: Z2, context: t2 });
        if (x2 = T2, this._applySnappedUpdate(s2, T2, _2, c2), h2 = g2, S2 = Z2, f3 !== "end") {
          const { frameTask: t3 } = d2;
          t$2r(u2) && (u2 = new AbortController()), l2.addPromise(g$1m(m2({ frameTask: t3, event: y2, context: v2, point: g2, scenePoint: Z2, delta: _2, lastPos: h2, lastScenePos: S2, lastUpdate: x2 }, u2.signal)));
        }
      }
      return n2.action === "end" && f2(), n2;
    };
  }
  _createSnapFunction(e2, n2) {
    return x$14(async ({ frameTask: a2, point: o2, scenePoint: r2, context: s2, event: p2, delta: l2, lastPos: c2, lastScenePos: u2, lastUpdate: d2 }, f2) => {
      const m2 = await a2.schedule(() => e2.snap({ point: o2, scenePoint: r2, context: s2, signal: f2 }), f2);
      if (m2.valid) {
        let r3 = await a2.schedule(() => m2.apply(), f2);
        o2 !== c2 && r$1$(c2) && (r3 = e2.update({ point: c2, scenePoint: u2, context: s2 })), i$D(r3, d2) || (this._applySnappedUpdate(p2.mapEnd, r3, l2, n2), this.next.execute(p2));
      }
    });
  }
  _createFrameTask(e2) {
    return e2.type === "3d" ? e2.resourceController.scheduler.registerTask(I$f.SNAPPING) : y$o;
  }
  _createSnappingInfo(e2, n2, a2) {
    return { context: new e$d({ editGeometryOperations: e2.editGeometryOperations, elevationInfo: e2.elevationInfo, pointer: e2.pointer, vertexHandle: r$1$(n2.info) ? n2.info.handle : null, excludeFeature: e2.excludeFeature, visualizer: e2.visualizer }), originalPos: r$1$(n2.snapOrigin) ? e2.coordinateHelper.vectorToDehydratedPoint(n2.snapOrigin) : n2.mapStart, originalScenePos: r$1$(n2.scenePoints) ? n2.scenePoints.sceneStart : null, frameTask: a2 };
  }
  _updatePosition(e2, [t2, n2, a2]) {
    const o2 = k$7(e2);
    return o2.x += t2, o2.y += n2, o2.hasZ && (o2.z += a2), o2;
  }
  _updateScenePosition(t2, n2) {
    return t$2r(t2) || t$2r(n2) ? null : this._updatePosition(t2, this._computeMapDelta(n2.sceneEnd, n2.sceneStart));
  }
  _computeMapDelta(e2, t2) {
    const n2 = e2.hasZ && t2.hasZ ? e2.z - t2.z : 0;
    return [e2.x - t2.x, e2.y - t2.y, n2];
  }
  _applySnappedUpdate(e2, t2, [n2, a2, o2], i2) {
    e2.x = t2.x + n2, e2.y = t2.y + a2, i2 && e2.hasZ && t2.hasZ && (e2.z = t2.z + o2);
  }
  _extractSelfSnappingZ(n2, a2) {
    if (!n2.hasZ())
      return null;
    const o2 = a2.vertices;
    let i2 = null;
    for (const r2 of o2) {
      const a3 = n2.getZ(r2.pos);
      if (r$1$(i2) && Math.abs(a3 - i2) > 1e-6)
        return null;
      t$2r(i2) && (i2 = a3);
    }
    return i2;
  }
}
let C$7 = class extends n$2G.EventedMixin(d$18) {
  constructor(e2) {
    super(e2), this._createOperationCompleted = false, this._pointerDownStates = new Set(), this._snappingPipeline = new u$g(), this.isDraped = true, this.labelOptions = new c$l(), this.tooltipOptions = new p$q(), this.snapToSceneEnabled = null, this.lastVertex = null, t$2r(e2.elevationInfo) && (this.elevationInfo = s$s(e2.hasZ));
  }
  initialize() {
    const { geometryType: e2, view: t2 } = this, { spatialReference: i2 } = t2, n2 = "viewingMode" in t2.state ? t2.state.viewingMode : l$U.Local, s2 = e2 === "segment" || e2 === "multipoint" ? "polyline" : e2;
    this.coordinateHelper = w$c(this.hasZ, this.hasM, i2), this._editGeometryOperations = new V$7(new g$d(s2, this.coordinateHelper)), this._snappingOperation = new h$i({ view: t2, constrainResult: (e3) => t$2r(e3) ? e3 : this._getEffectiveDrawSurface().constrainZ(e3) }), this.handles.add(l$1P(() => this.stagedVertex, (e3) => {
      t$2r(e3) || this.emit("cursor-update", { updated: null, vertices: [{ componentIndex: 0, vertexIndex: this._activeComponent.vertices.length, coordinates: this.coordinateHelper.pointToArray(e3) }], operation: "apply", type: "vertex-update" });
    }, { sync: true, equals: (e3, t3) => y$1O(e3, t3, i$D) })), this._activeComponent = new p$v(i2, n2), this._editGeometryOperations.data.components.push(this._activeComponent);
    const a2 = this.segmentLabels;
    r$1$(a2) && (a2.context = { view: t2, editGeometryOperations: this._editGeometryOperations, elevationInfo: this.elevationInfo, labelOptions: this.labelOptions }, this.handles.add([l$1P(() => this.labelOptions.enabled, (e3) => {
      a2.visible = e3;
    }, w$Q), this.on("cursor-update", () => {
      const e3 = this.stagedVertex;
      a2.stagedVertex = r$1$(e3) ? this.coordinateHelper.pointToVector(e3) : null;
    })])), this.handles.add(this._editGeometryOperations.on(["vertex-add", "vertex-update", "vertex-remove"], (e3) => {
      const t3 = e3.vertices.map((e4) => ({ componentIndex: 0, vertexIndex: e4.index, coordinates: this.coordinateHelper.vectorToArray(e4.pos) })), i3 = t3.map((e4) => e4.coordinates);
      switch (e3.type) {
        case "vertex-add":
          this.emit(e3.type, __spreadProps(__spreadValues({}, e3), { added: i3, vertices: t3 }));
          break;
        case "vertex-update":
          this.emit(e3.type, __spreadProps(__spreadValues({}, e3), { updated: i3, vertices: t3 }));
          break;
        case "vertex-remove":
          this.emit(e3.type, __spreadProps(__spreadValues({}, e3), { removed: i3, vertices: t3 }));
      }
      const n3 = this._activeComponent.getLastVertex(), s3 = r$1$(n3) ? this.coordinateHelper.vectorToDehydratedPoint(n3.pos) : null;
      (t$2r(s3) || t$2r(this.lastVertex) || !i$D(this.lastVertex, s3)) && (this.lastVertex = s3);
    })), this._manipulator = new e$a({ grabbableForEvent: (e3) => this.drawingMode !== "click" || e3.pointerType === "touch" && this._snappingEnabled && this._pointerDownStates.size === 1 }), this.manipulators.add(this._manipulator), this._manipulator.grabbable = e2 !== "point", this.handles.add([this._createManipulatorDragPipeline(this._manipulator), this._manipulator.events.on("immediate-click", (e3) => this._onImmediateClick(e3)), this._manipulator.events.on("immediate-double-click", (e3) => this._onImmediateDoubleClick(e3))]);
  }
  destroy() {
    s$2D(this.segmentLabels), s$2D(this._snappingOperation), this._editGeometryOperations = s$2D(this._editGeometryOperations);
  }
  get _snappingEnabled() {
    return r$1$(this.snappingManager) && this.snappingManager.options.effectiveEnabled;
  }
  get _requiresScenePoint() {
    const e2 = this._getEffectiveDrawSurface();
    return this.view.type === "3d" && this.drawSurface !== e2;
  }
  get canRedo() {
    return this._editGeometryOperations.canRedo;
  }
  get canUndo() {
    return this._editGeometryOperations.canUndo;
  }
  get committedVertices() {
    return this._activeComponent.vertices.map((e2) => this.coordinateHelper.vectorToArray(e2.pos));
  }
  set drawingMode(e2) {
    this._set("drawingMode", e2 != null ? e2 : e$b);
  }
  get interactive() {
    return this._manipulator.interactive;
  }
  set interactive(e2) {
    this._manipulator.interactive = e2;
  }
  get isCompleted() {
    return this._createOperationCompleted;
  }
  get numCommittedVertices() {
    return this._activeComponent.vertices.length;
  }
  get numVertices() {
    return r$1$(this.stagedVertex) ? this._activeComponent.vertices.length + 1 : this._activeComponent.vertices.length;
  }
  get stagedVertex() {
    return this._snappingOperation.stagedPoint;
  }
  set stagedVertex(e2) {
    this._snappingOperation.stagedPoint = y$1L(e2);
  }
  get updating() {
    return this.updatingHandles.updating;
  }
  get vertices() {
    const e2 = this.committedVertices;
    return r$1$(this.stagedVertex) && e2.push(this.coordinateHelper.pointToArray(this.stagedVertex)), e2;
  }
  cancel() {
    this.complete({ aborted: true });
  }
  commitStagedVertex() {
    if (this._snappingOperation.abort(), r$1$(this.stagedVertex)) {
      const { stagedVertex: e2 } = this;
      this.stagedVertex = null, this._editGeometryOperations.appendVertex(this.coordinateHelper.pointToVector(e2));
    }
  }
  complete(e2) {
    const t2 = e2 && e2.aborted || false;
    this._snappingOperation.abort(), r$1$(this.snappingManager) && this.snappingManager.doneSnapping(), this.geometryType === "segment" || this.geometryType === "point" ? this.commitStagedVertex() : this.stagedVertex = null;
    const i2 = this.geometryType === "multipoint" && this.numVertices === 0 || this.geometryType === "polyline" && this.numVertices < 2 || this.geometryType === "polygon" && this.numVertices < 3;
    this._createOperationCompleted = !i2, (this.isCompleted || t2) && this.emit("complete", { vertices: this.vertices.map((e3, t3) => ({ componentIndex: 0, vertexIndex: t3, coordinates: e3 })), aborted: t2, type: "complete" });
  }
  onInputEvent(e2) {
    switch (e2.type) {
      case "pointer-down":
        this._pointerDownStates.add(e2.pointerId);
        break;
      case "pointer-up":
        this._pointerDownStates.delete(e2.pointerId);
    }
    switch (e2.type) {
      case "pointer-move":
        return this._onPointerMove(e2);
      case "hold":
        return this._onHold(e2);
    }
  }
  redo() {
    this._editGeometryOperations.redo();
  }
  undo() {
    r$1$(this.snappingManager) && this.snappingManager.doneSnapping(), this._editGeometryOperations.undo();
  }
  _closeOnClickVertexIndex(e2) {
    const t2 = this._activeComponent;
    if (this.geometryType === "polygon" && t2.vertices.length > 2) {
      if (this._vertexWithinPointerDistance(t2.vertices[0].pos, e2))
        return 0;
      if (this._vertexWithinPointerDistance(t2.vertices[t2.vertices.length - 1].pos, e2))
        return t2.vertices.length - 1;
    }
    return null;
  }
  _createManipulatorDragPipeline(e2) {
    switch (e$2e(this.drawingMode)) {
      case "click":
        return this._createManipulatorDragPipelineClick(e2);
      case "freehand":
        return this._createManipulatorDragPipelineFreehand(e2);
      case "hybrid":
        return this._createManipulatorDragPipelineHybrid(e2);
    }
  }
  _createManipulatorDragPipelineClick(e2) {
    return d$c(e2, (e3, t2, i2, n2) => {
      const r2 = n2 === "touch" && this._snappingEnabled;
      !this.isCompleted && r2 && (i2 = i2.next((e4) => (r2 && r$1$(this.snappingManager) && this.snappingManager.doneSnapping(), e4)), t2.next(this._screenToMapDragEventStep()).next((e4) => (e4.action === "start" && (this.stagedVertex = e4.mapStart, (this.geometryType === "segment" || r2 && this.numVertices === 0) && this.commitStagedVertex()), e4)).next(X$4(this.view, this.elevationInfo)).next(this._snappingPipeline.createSnapDragEventPipelineStep({ predicate: () => r2, cancel: i2, snappingManager: this.snappingManager, snappingContext: new e$d({ editGeometryOperations: this._editGeometryOperations, elevationInfo: this.elevationInfo, pointer: n2, visualizer: this.snappingVisualizer }), updatingHandles: this.updatingHandles, useZ: !this._requiresScenePoint }), this._snappingPipeline.next).next((e4) => (r2 && (this.stagedVertex = e4.mapEnd, e4.action === "end" && this.commitStagedVertex()), e4)).next((e4) => (e4.action === "end" && (this.geometryType !== "segment" && this.geometryType !== "point" || this.complete()), e4)));
    });
  }
  _createManipulatorDragPipelineFreehand(e2) {
    return d$c(e2, (e3, t2) => {
      this.isCompleted || t2.next(this._screenToMapDragEventStep()).next((e4) => (e4.action === "start" && (t$2r(this.stagedVertex) && (this.stagedVertex = e4.mapStart), this.geometryType === "segment" && this.commitStagedVertex()), e4)).next((e4) => {
        switch (e4.action) {
          case "start":
          case "update":
            this.stagedVertex = e4.mapEnd, this.geometryType !== "polygon" && this.geometryType !== "polyline" || this.commitStagedVertex();
            break;
          case "end":
            this.complete();
        }
        return e4;
      });
    });
  }
  _createManipulatorDragPipelineHybrid(e2) {
    return d$c(e2, (e3, t2) => {
      this.isCompleted || t2.next(this._screenToMapDragEventStep()).next((e4) => (e4.action === "start" && (t$2r(this.stagedVertex) && (this.stagedVertex = e4.mapStart), this.commitStagedVertex()), e4)).next((e4) => {
        switch (e4.action) {
          case "start":
          case "update":
            this.stagedVertex = e4.mapEnd, this.geometryType !== "polygon" && this.geometryType !== "polyline" || this.commitStagedVertex();
            break;
          case "end":
            this.geometryType !== "segment" && this.geometryType !== "point" || this.complete();
        }
        return e4;
      });
    });
  }
  get _drawAtFixedElevation() {
    return (this.geometryType === "segment" || this.geometryType === "polygon") && this.numCommittedVertices > 0;
  }
  _getEffectiveDrawSurface() {
    if (t$2r(this.elevationDrawSurface))
      return this.drawSurface;
    if (!this.coordinateHelper.hasZ())
      return this.elevationDrawSurface.defaultZ = null, this.elevationDrawSurface;
    let e2 = this.defaultZ, t2 = false;
    return r$1$(this.elevationInfo) && this.elevationInfo.mode === "absolute-height" && (t2 = true), r$1$(this.snapToSceneEnabled) && (t2 = this.snapToSceneEnabled), r$1$(this.elevationInfo) && this.elevationInfo.mode === "on-the-ground" && (t2 = false), this._drawAtFixedElevation && (e2 = this.coordinateHelper.getZ(this._activeComponent.vertices[0].pos), t2 = false), t2 ? this.drawSurface : (this.elevationDrawSurface.defaultZ = e2, this.elevationDrawSurface);
  }
  _mapToScreen(e2) {
    return this._getEffectiveDrawSurface().mapToScreen(e2);
  }
  _onHold(e2) {
    this._snappingOperation.abort(), this.drawingMode === "click" && e2.pointerType === "touch" && this._snappingEnabled && (this.stagedVertex = e2.mapPoint), e2.stopPropagation();
  }
  _onImmediateClick(e2) {
    if (e2.pointerType === "mouse" && e2.button === 2 || this._manipulator.dragging)
      return;
    const t2 = this._activeComponent, i2 = this._closeOnClickVertexIndex(e2.screenPoint);
    if (r$1$(i2))
      return e2.stopPropagation(), void this.complete();
    const n2 = this._screenToMap(e2.screenPoint);
    if (r$1$(n2))
      switch (this.drawingMode) {
        case "freehand":
          this.geometryType === "point" && (r$1$(this.stagedVertex) ? this.commitStagedVertex() : this._editGeometryOperations.appendVertex(this.coordinateHelper.pointToVector(n2)), this.complete());
          break;
        case "click":
        case "hybrid":
          this._snappingOperation.abort(), r$1$(this.stagedVertex) ? this.commitStagedVertex() : this._editGeometryOperations.appendVertex(this.coordinateHelper.pointToVector(n2)), (this.geometryType === "point" || this.geometryType === "segment" && t2.vertices.length === 2 || this.geometryType === "segment" && this.drawingMode === "hybrid" && t2.vertices.length === 1) && this.complete();
      }
    e2.stopPropagation();
  }
  _onImmediateDoubleClick(e2) {
    this._manipulator.dragging || this.geometryType === "point" || (this.complete(), e2.stopPropagation());
  }
  _onPointerMove(e2) {
    const t2 = c$2K(e2.x, e2.y), i2 = this._snappingOperation;
    if (this._manipulator.dragging || this._pointerDownStates.has(e2.pointerId) || this._manipulator.grabbing || !this._manipulator.interactive)
      return void i2.abort();
    e2.stopPropagation();
    const n2 = this._closeOnClickVertexIndex(t2);
    if (r$1$(n2))
      return this._closeOnVertex(n2), void i2.abort();
    const s2 = this._screenToMap(t2), a2 = this._requiresScenePoint ? this.drawSurface.screenToMap(t2) : null;
    if (this._manipulator.cursor = r$1$(s2) ? "crosshair" : null, t$2r(s2))
      return void i2.abort();
    const c2 = this.snappingManager;
    if (t$2r(c2))
      return this.stagedVertex = s2, void i2.abort();
    const d2 = this._drawAtFixedElevation ? o$2s(this.elevationDrawSurface, ({ defaultZ: e3 }) => e3) : null, l2 = new e$d({ editGeometryOperations: this._editGeometryOperations, elevationInfo: this.elevationInfo, pointer: e2.pointerType, visualizer: this.snappingVisualizer, selfSnappingZ: r$1$(d2) ? { value: d2, elevationInfo: this.elevationInfo } : null });
    this.updatingHandles.addPromise(g$1m(i2.snap({ point: s2, scenePoint: a2 }, c2, l2)));
  }
  _closeOnVertex(e2) {
    this.stagedVertex = null;
    const t2 = { componentIndex: 0, vertexIndex: e2, coordinates: this.coordinateHelper.vectorToArray(this._activeComponent.vertices[e2].pos) };
    this.emit("cursor-update", { updated: null, vertices: [t2], operation: "apply", type: "vertex-update" });
  }
  _screenToMap(e2) {
    return this._getEffectiveDrawSurface().screenToMap(e2);
  }
  _screenToMapDragEventStep() {
    let e2 = null;
    return (t2) => {
      if (t2.action === "start" && (e2 = this._screenToMap(t2.screenStart)), t$2r(e2))
        return null;
      const i2 = this._screenToMap(t2.screenEnd);
      return r$1$(i2) ? __spreadProps(__spreadValues({}, t2), { mapStart: e2, mapEnd: i2 }) : null;
    };
  }
  _vertexWithinPointerDistance(e2, t2) {
    const i2 = 25, n2 = this._mapToScreen(this.coordinateHelper.vectorToDehydratedPoint(e2));
    return !!r$1$(n2) && k$6(n2, t2, i2);
  }
};
function k$6(e2, t2, i2) {
  const n2 = e2.x - t2.x, r2 = e2.y - t2.y;
  return n2 * n2 + r2 * r2 <= i2;
}
e$2g([y$1I()], C$7.prototype, "_snappingEnabled", null), e$2g([y$1I()], C$7.prototype, "defaultZ", void 0), e$2g([y$1I()], C$7.prototype, "isDraped", void 0), e$2g([y$1I({ value: e$b })], C$7.prototype, "drawingMode", null), e$2g([y$1I({ constructOnly: true })], C$7.prototype, "elevationDrawSurface", void 0), e$2g([y$1I({ constructOnly: true })], C$7.prototype, "elevationInfo", void 0), e$2g([y$1I({ constructOnly: true, type: c$l })], C$7.prototype, "labelOptions", void 0), e$2g([y$1I({ constructOnly: true, type: p$q })], C$7.prototype, "tooltipOptions", void 0), e$2g([y$1I({ constructOnly: true })], C$7.prototype, "geometryType", void 0), e$2g([y$1I({ constructOnly: true })], C$7.prototype, "hasM", void 0), e$2g([y$1I({ constructOnly: true })], C$7.prototype, "hasZ", void 0), e$2g([y$1I({ constructOnly: true })], C$7.prototype, "manipulators", void 0), e$2g([y$1I({ constructOnly: true })], C$7.prototype, "drawSurface", void 0), e$2g([y$1I({ constructOnly: true })], C$7.prototype, "segmentLabels", void 0), e$2g([y$1I({ constructOnly: true })], C$7.prototype, "snappingManager", void 0), e$2g([y$1I({ constructOnly: true })], C$7.prototype, "snappingVisualizer", void 0), e$2g([y$1I()], C$7.prototype, "snapToSceneEnabled", void 0), e$2g([y$1I()], C$7.prototype, "_snappingOperation", void 0), e$2g([y$1I()], C$7.prototype, "stagedVertex", null), e$2g([y$1I()], C$7.prototype, "lastVertex", void 0), e$2g([y$1I()], C$7.prototype, "updating", null), e$2g([y$1I({ constructOnly: true })], C$7.prototype, "view", void 0), C$7 = e$2g([n$2P("esri.views.draw.DrawOperation")], C$7);
class o$i {
  constructor(e2, t2, s2, i2 = null) {
    this._elevationInfo = e2, this.defaultZ = t2, this._view = s2, this._excludeGraphics = i2;
  }
  screenToMap(s2) {
    if (r$1$(this.defaultZ))
      return this._view.sceneIntersectionHelper.intersectElevationFromScreen(i$2w(s2.x, s2.y), this._elevationInfo, this.defaultZ, this._excludeGraphics);
    const i2 = this._view.sceneIntersectionHelper.intersectElevationFromScreen(i$2w(s2.x, s2.y), this._elevationInfo, 0, this._excludeGraphics);
    return r$1$(i2) && (i2.z = void 0), i2;
  }
  mapToScreen(e2) {
    const t2 = v$h(e2.x, e2.y, g$f(this._view, e2, this._elevationInfo), e2.spatialReference);
    return this._view.toScreen(t2);
  }
  constrainZ(t2) {
    const { defaultZ: s2 } = this;
    return r$1$(s2) && t2.z !== s2 && ((t2 = k$7(t2)).z = s2), t2;
  }
}
class c$k {
  constructor(e2, t2, s2 = []) {
    this.view = e2, this.elevationInfo = t2, this.exclude = s2;
  }
  screenToMap(t2) {
    const s2 = this.view.toMap(t2, { exclude: this.exclude });
    return r$1$(s2) && (s2.z = d$h(s2, this.view, this.elevationInfo)), s2;
  }
  mapToScreen(t2) {
    let i2 = t2;
    return r$1$(this.elevationInfo) && (i2 = v$h(t2.x, t2.y, g$f(this.view, t2, this.elevationInfo), t2.spatialReference)), this.view.toScreen(i2);
  }
  constrainZ(e2) {
    return e2;
  }
}
class a$i {
  constructor(e2, t2 = false, s2 = 0) {
    this.view = e2, this.hasZ = t2, this.defaultZ = s2, this.mapToScreen = (t3) => e2.toScreen(t3), this.screenToMap = t2 ? (t3) => {
      const i2 = e2.toMap(t3);
      return i2.z = s2, i2;
    } : (t3) => e2.toMap(t3);
  }
  constrainZ(e2) {
    const { defaultZ: t2 } = this;
    return this.hasZ && e2.z !== t2 && ((e2 = k$7(e2)).z = t2), e2;
  }
}
var i$r;
!function(t2) {
  t2[t2.WhenToolEditable = 0] = "WhenToolEditable", t2[t2.WhenToolNotEditable = 1] = "WhenToolNotEditable", t2[t2.Always = 2] = "Always";
}(i$r || (i$r = {}));
class e$9 {
  constructor() {
    this._isToolEditable = true, this._manipulators = new j$V(), this._resourceContexts = { manipulator3D: {} }, this._attached = false;
  }
  set isToolEditable(t2) {
    this._isToolEditable = t2;
  }
  get length() {
    return this._manipulators.length;
  }
  add(t2, a2 = i$r.WhenToolEditable) {
    this.addMany([t2], a2);
  }
  addMany(t2, a2 = i$r.WhenToolEditable) {
    for (const i2 of t2) {
      const t3 = { manipulator: i2, visibilityPredicate: a2, attached: false };
      this._manipulators.add(t3), this._attached && this._updateManipulatorAttachment(t3);
    }
  }
  remove(t2) {
    for (let a2 = 0; a2 < this._manipulators.length; a2++)
      if (this._manipulators.getItemAt(a2).manipulator === t2) {
        const t3 = this._manipulators.splice(a2, 1)[0];
        this._detachManipulator(t3);
        break;
      }
  }
  removeAll() {
    this._manipulators.forEach((t2) => {
      this._detachManipulator(t2);
    }), this._manipulators.removeAll();
  }
  attach() {
    this._manipulators.forEach((t2) => {
      this._updateManipulatorAttachment(t2);
    }), this._attached = true;
  }
  detach() {
    this._manipulators.forEach((t2) => {
      this._detachManipulator(t2);
    }), this._attached = false;
  }
  destroy() {
    this.detach(), this._manipulators.forEach(({ manipulator: t2 }) => {
      t2.destroy && t2.destroy();
    }), this._manipulators.destroy(), this._resourceContexts = null;
  }
  on(t2, a2) {
    return this._manipulators.on(t2, (t3) => {
      a2(t3);
    });
  }
  forEach(t2) {
    for (const a2 of this._manipulators.items)
      t2(a2);
  }
  some(t2) {
    return this._manipulators.items.some(t2);
  }
  toArray() {
    const t2 = [];
    return this.forEach((a2) => t2.push(a2.manipulator)), t2;
  }
  intersect(t2, i2) {
    let e2 = null, o2 = Number.MAX_VALUE;
    return this._manipulators.forEach(({ manipulator: s2, attached: r2 }) => {
      if (!r2 || !s2.interactive)
        return;
      const n2 = s2.intersectionDistance(t2, i2);
      r$1$(n2) && n2 < o2 && (o2 = n2, e2 = s2);
    }), e2;
  }
  _updateManipulatorAttachment(t2) {
    this._isManipulatorItemVisible(t2) ? this._attachManipulator(t2) : this._detachManipulator(t2);
  }
  _attachManipulator(t2) {
    t2.attached || (t2.manipulator.attach && t2.manipulator.attach(this._resourceContexts), t2.attached = true);
  }
  _detachManipulator(t2) {
    if (!t2.attached)
      return;
    const a2 = t2.manipulator;
    a2.grabbing = false, a2.dragging = false, a2.hovering = false, a2.selected = false, a2.detach && a2.detach(this._resourceContexts), t2.attached = false;
  }
  _isManipulatorItemVisible(t2) {
    return t2.visibilityPredicate === i$r.Always || (this._isToolEditable ? t2.visibilityPredicate === i$r.WhenToolEditable : t2.visibilityPredicate === i$r.WhenToolNotEditable);
  }
}
let p$p = class extends m$2q {
  constructor(t2) {
    super(t2), this.manipulators = new e$9(), this.automaticManipulatorSelection = true, this.hasGrabbedManipulators = false, this.hasHoveredManipulators = false, this.firstGrabbedManipulator = null, this.created = false, this.removeIncompleteOnCancel = true, this._editableFlags = new Map([[o$N.MANAGER, true], [o$N.USER, true]]), this._creationFinishedResolver = D$D();
  }
  get active() {
    return this.view != null && this.view.activeTool === this;
  }
  set visible(t2) {
    this._get("visible") !== t2 && (this._set("visible", t2), this._syncVisible());
  }
  get editable() {
    return this.getEditableFlag(o$N.USER);
  }
  set editable(t2) {
    this.setEditableFlag(o$N.USER, t2);
  }
  get updating() {
    return false;
  }
  get cursor() {
    return null;
  }
  get hasFocusedManipulators() {
    return this.hasGrabbedManipulators || this.hasHoveredManipulators;
  }
  destroy() {
    this.manipulators.destroy(), this._set("view", null);
  }
  onAdd() {
    this._syncVisible();
  }
  activate() {
    t$2r(this.view) ? s$2z.getLogger(this.declaredClass).error("Can't activate tool if view is not defined.") : (this.view.focus(), this.onActivate());
  }
  deactivate() {
    this.onDeactivate();
  }
  handleInputEvent(t2) {
    this.onInputEvent(t2);
  }
  handleInputEventAfter(t2) {
    this.onInputEventAfter(t2);
  }
  setEditableFlag(t2, e2) {
    this._editableFlags.set(t2, e2), this.manipulators.isToolEditable = this.internallyEditable, this._updateManipulatorAttachment(), t2 === o$N.USER && this.notifyChange("editable"), this.onEditableChange(), this.onManipulatorSelectionChanged();
  }
  getEditableFlag(t2) {
    return this._editableFlags.get(t2);
  }
  whenCreated() {
    return this._creationFinishedResolver.promise;
  }
  onManipulatorSelectionChanged() {
  }
  onActivate() {
  }
  onDeactivate() {
  }
  onShow() {
  }
  onHide() {
  }
  onEditableChange() {
  }
  onInputEvent(t2) {
  }
  onInputEventAfter(t2) {
  }
  get internallyEditable() {
    return this.getEditableFlag(o$N.USER) && this.getEditableFlag(o$N.MANAGER);
  }
  finishToolCreation() {
    this.created || this._creationFinishedResolver.resolve(this), this._set("created", true);
  }
  _syncVisible() {
    if (this.initialized) {
      if (this.visible)
        this._show();
      else if (this._hide(), this.active)
        return void (this.view.activeTool = null);
    }
  }
  _show() {
    this._updateManipulatorAttachment(), this.onShow();
  }
  _hide() {
    this._updateManipulatorAttachment(), this.onHide();
  }
  _updateManipulatorAttachment() {
    this.visible ? this.manipulators.attach() : this.manipulators.detach();
  }
};
e$2g([y$1I({ constructOnly: true })], p$p.prototype, "view", void 0), e$2g([y$1I({ readOnly: true })], p$p.prototype, "active", null), e$2g([y$1I({ value: true })], p$p.prototype, "visible", null), e$2g([y$1I({ value: true })], p$p.prototype, "editable", null), e$2g([y$1I({ readOnly: true })], p$p.prototype, "manipulators", void 0), e$2g([y$1I({ readOnly: true })], p$p.prototype, "updating", null), e$2g([y$1I()], p$p.prototype, "cursor", null), e$2g([y$1I({ readOnly: true })], p$p.prototype, "automaticManipulatorSelection", void 0), e$2g([y$1I()], p$p.prototype, "hasFocusedManipulators", null), e$2g([y$1I()], p$p.prototype, "hasGrabbedManipulators", void 0), e$2g([y$1I()], p$p.prototype, "hasHoveredManipulators", void 0), e$2g([y$1I()], p$p.prototype, "firstGrabbedManipulator", void 0), e$2g([y$1I({ readOnly: true })], p$p.prototype, "created", void 0), e$2g([y$1I({ readOnly: true })], p$p.prototype, "removeIncompleteOnCancel", void 0), p$p = e$2g([n$2P("esri.views.interactive.InteractiveToolBase")], p$p);
let h$f = class extends a$1W(n$2G.EventedMixin(p$p)) {
  constructor(e2) {
    super(e2), this.defaultZ = 0, this.elevationInfo = null, this.hasZ = true, this.mode = null, this.snapToScene = null, this.type = "draw-3d";
  }
  initialize() {
    const e2 = this.view, t2 = s$s(this.hasZ, this.elevationInfo);
    this.drawOperation = new C$7({ view: e2, manipulators: this.manipulators, geometryType: this.geometryType, drawingMode: this.mode, hasZ: this.hasZ, defaultZ: this.defaultZ, snapToSceneEnabled: this.snapToScene, drawSurface: e2.type === "3d" ? new c$k(e2, t2) : null, elevationDrawSurface: e2.type === "3d" ? new o$i(t2, this.defaultZ, e2) : null, hasM: false, elevationInfo: t2 }), this.handles.add([this.drawOperation.on("vertex-add", (e3) => this.onVertexAdd(e3)), this.drawOperation.on("vertex-remove", (e3) => this.onVertexRemove(e3)), this.drawOperation.on("vertex-update", (e3) => this.onVertexUpdate(e3)), this.drawOperation.on("cursor-update", (e3) => this.onCursorUpdate(e3)), this.drawOperation.on("complete", (e3) => this.onComplete(e3))]), this.finishToolCreation();
  }
  destroy() {
    this.drawOperation = s$2D(this.drawOperation), this._set("view", null);
  }
  get canRedo() {
    return this.drawOperation.canRedo;
  }
  get canUndo() {
    return this.drawOperation.canUndo;
  }
  set enabled(e2) {
    this.drawOperation.interactive = e2, this._set("enabled", e2);
  }
  get updating() {
    var _a2, _b2;
    return (_b2 = (_a2 = this.drawOperation) == null ? void 0 : _a2.updating) != null ? _b2 : false;
  }
  completeCreateOperation() {
    this.drawOperation.complete();
  }
  onDeactivate() {
    this.drawOperation.isCompleted || this.drawOperation.cancel();
  }
  getVertexCoords() {
    return this.drawOperation.vertices;
  }
  onInputEvent(e2) {
    this.drawOperation.onInputEvent(e2);
  }
  redo() {
    this.drawOperation.redo();
  }
  reset() {
  }
  undo() {
    this.drawOperation.undo();
  }
  onComplete(e2) {
    this.emit("complete", e2);
  }
  onCursorUpdate(e2) {
    this.emit("cursor-update", e2);
  }
  onVertexAdd(e2) {
    this.emit("vertex-add", e2);
  }
  onVertexRemove(e2) {
    this.emit("vertex-remove", e2);
  }
  onVertexUpdate(e2) {
    this.emit("vertex-update", e2);
  }
};
e$2g([y$1I({ constructOnly: true, nonNullable: true })], h$f.prototype, "defaultZ", void 0), e$2g([y$1I()], h$f.prototype, "drawOperation", void 0), e$2g([y$1I({ constructOnly: true })], h$f.prototype, "elevationInfo", void 0), e$2g([y$1I({ value: true })], h$f.prototype, "enabled", null), e$2g([y$1I({ constructOnly: true })], h$f.prototype, "geometryType", void 0), e$2g([y$1I({ constructOnly: true })], h$f.prototype, "hasZ", void 0), e$2g([y$1I({ constructOnly: true })], h$f.prototype, "mode", void 0), e$2g([y$1I()], h$f.prototype, "snapToScene", void 0), e$2g([y$1I({ readOnly: true })], h$f.prototype, "type", void 0), e$2g([y$1I({ readOnly: true })], h$f.prototype, "updating", null), e$2g([y$1I({ constructOnly: true, nonNullable: true })], h$f.prototype, "view", void 0), h$f = e$2g([n$2P("esri.views.draw.DrawTool")], h$f);
let _$8 = class extends S$9 {
  constructor(e2) {
    super(e2), this._addVertexOnPointerUp = false;
  }
  initialize() {
    this.view.type === "2d" ? this._addViewHandles() : this._addDrawTool();
  }
  destroy() {
    this.view.type === "2d" ? this._removeViewHandles() : this._removeDrawTool(), this.emit("destroy");
  }
  complete() {
    this.view.type === "2d" ? this._cursorScreenPoint && this._completeDrawing() : this._drawTool.completeCreateOperation();
  }
  _addViewHandles() {
    this._removeViewHandles(), this._handles.add([this.view.on("pointer-down", (e2) => {
      this._shouldHandlePointerEvent(e2) && (this._abortSnapping(), this._activePointerId = e2.pointerId, this._addVertexOnPointerUp = true, this._cursorScreenPoint = n$Y(e2), e2.pointerType === "touch" && this._updateCursor(e2.native));
    }, P$h.TOOL), this.view.on("pointer-move", (e2) => {
      this._abortSnapping(), this._cursorScreenPoint = n$Y(e2), e2.pointerType !== "touch" && this._updateCursor(e2.native);
    }, P$h.TOOL), this.view.on("pointer-drag", (e2) => {
      this._shouldHandlePointerEvent(e2) && (this._abortSnapping(), this._addVertexOnPointerUp = false);
    }, P$h.TOOL), this.view.on("pointer-up", (e2) => {
      if (this._shouldHandlePointerEvent(e2))
        if (this._abortSnapping(), this._activePointerId = null, this._addVertexOnPointerUp)
          e2.stopPropagation(), this._vertexAddHandler(e2);
        else {
          const t2 = e2.pointerType === "touch";
          this._updateCursor(e2.native, t2);
        }
    }, P$h.TOOL), this.view.on("drag", ["Shift"], (e2) => {
      e2.stopPropagation();
    }, P$h.TOOL), this.view.on("key-down", (e2) => {
      e2.key === e$c.complete && this._cursorScreenPoint && (this._abortSnapping(), this._vertexAddHandler(e2));
    }, P$h.TOOL)], this._viewHandlesKey);
  }
  _removeViewHandles() {
    this._handles.remove(this._viewHandlesKey);
  }
  _addDrawTool() {
    this._drawTool = new h$f({ view: this.view, elevationInfo: this.elevationInfo, hasZ: this.hasZ, geometryType: "point", mode: "click" }), this.view.addAndActivateTool(this._drawTool), this._handles.add([this._drawTool.on("cursor-update", (e2) => {
      e2.vertices.length === 1 && this.emit("cursor-update", new i$u(this.view, null, e2.vertices[0].vertexIndex, this._drawTool.getVertexCoords()));
    }), this._drawTool.on("complete", (e2) => {
      this.emit("draw-complete", new r$i(null, this._drawTool.getVertexCoords())), this._removeDrawTool();
    })], this._drawToolHandlesKey);
  }
  _removeDrawTool() {
    this._handles.remove(this._drawToolHandlesKey), this.view.tools.remove(this._drawTool), this._drawTool = s$2D(this._drawTool);
  }
  _addVertex(e2) {
    const t2 = this._coordinateHelper.arrayToVector(e2);
    this._isDuplicateOfLastVertex(t2) || (this._lastVertexUnsnapped = this._stagedVertexUnsnapped, this._popCursorVertex(), this._editGeometryOperations.appendVertex(t2), this.notifyChange("vertices"), this._completeDrawing());
  }
  _updateCursor(e2, t2 = false) {
    if (this._popCursorVertex(), !this._cursorScreenPoint)
      return;
    const o2 = this.getCoordsAndPointFromScreenPoint(this._cursorScreenPoint);
    r$1$(o2) && !t2 && this._pushCursorVertex(o2.vertex, () => this.emit("cursor-update", new i$u(this.view, e2, this._activeComponent.vertices.length, this.vertices, r$1$(this._stagedVertex) ? new w$_(this._stagedVertex) : null)));
  }
  _completeDrawing(e2) {
    this._activePointerId = null, this._popCursorVertex(), this._abortSnapping(), r$1$(this._snappingManager) && this._snappingManager.doneSnapping();
    const t2 = new r$i(e2, this.vertices);
    this.emit("draw-complete", t2), t2.defaultPrevented || this._removeViewHandles();
  }
};
_$8 = e$2g([n$2P("esri.views.draw.PointDrawAction")], _$8);
let w$9 = class extends S$9 {
  constructor(e2) {
    super(e2), this._panEnabled = false, this._popVertexOnPointerMove = false, this._addVertexOnPointerUp = false, this.mode = e$b;
  }
  initialize() {
    this.view.type === "2d" ? (this._addViewHandles(), this._addUndoRedoHandles()) : this._addDrawTool();
  }
  destroy() {
    this.view.type === "2d" ? (this._removeViewHandles(), this._removeUndoRedoHandles()) : this._removeDrawTool(), this.emit("destroy");
  }
  get _dragEnabled() {
    return this.mode === "freehand" || this.mode === "hybrid";
  }
  get _clickEnabled() {
    return this.mode === "click" || this.mode === "hybrid";
  }
  undo() {
    super.undo(), this.notifyChange("vertices");
  }
  redo() {
    super.redo(), this.notifyChange("vertices");
  }
  complete() {
    this.view.type === "2d" ? this._completeDrawing() : this._drawTool.completeCreateOperation();
  }
  _getGeometryZValue() {
    return this.hasZ && this.vertices.length > 0 ? this.vertices[0][2] : this.defaultZ;
  }
  _addViewHandles() {
    this._removeViewHandles(), this._handles.add([this.view.on("click", (e2) => {
      e2.stopPropagation();
    }, P$h.TOOL), this.view.on("pointer-down", (e2) => {
      this._shouldHandlePointerEvent(e2) && (this._abortSnapping(), this._activePointerId = e2.pointerId, this._addVertexOnPointerUp = true, this._cursorScreenPoint = n$Y(e2), e2.pointerType === "touch" && this._updateCursor(e2.native));
    }, P$h.TOOL), this.view.on("pointer-move", (e2) => {
      this._abortSnapping(), this._popVertexOnPointerMove && (this.undo(), this._popVertexOnPointerMove = false), this._cursorScreenPoint = n$Y(e2), e2.pointerType !== "touch" && this._updateCursor(e2.native);
    }, P$h.TOOL), this.view.on("pointer-drag", (e2) => {
      this._shouldHandlePointerEvent(e2) && (this._abortSnapping(), this._cursorScreenPoint = n$Y(e2), this._dragEnabled && !this._panEnabled ? this._vertexAddHandler(e2) : this._addVertexOnPointerUp = false);
    }, P$h.TOOL), this.view.on("pointer-up", (e2) => {
      if (this._shouldHandlePointerEvent(e2))
        if (this._abortSnapping(), this._activePointerId = null, this._addVertexOnPointerUp) {
          if (!this._clickEnabled)
            return this.vertices.length === 1 && this.vertices.pop(), void this._drawCompleteHandler(e2);
          this._vertexAddHandler(e2);
        } else {
          const t2 = e2.pointerType === "touch";
          this._updateCursor(e2.native, t2);
        }
    }, P$h.TOOL), this.view.on("drag", (e2) => {
      this._dragEnabled && r$1$(this._activePointerId) && !this._panEnabled && e2.stopPropagation();
    }, P$h.TOOL), this.view.on("drag", ["Shift"], (e2) => {
      e2.stopPropagation();
    }, P$h.TOOL), this.view.on("double-click", (e2) => {
      e2.stopPropagation(), this._drawCompleteHandler(e2);
    }, P$h.TOOL), this.view.on("double-click", ["Control"], (e2) => {
      e2.stopPropagation(), this._drawCompleteHandler(e2);
    }, P$h.TOOL), this.view.on("key-down", (e2) => {
      const { key: t2, repeat: i2 } = e2;
      t2 === e$c.vertexAdd && !i2 && this._cursorScreenPoint ? (e2.stopPropagation(), this._abortSnapping(), this._vertexAddHandler(e2)) : t2 !== e$c.complete || i2 ? t2 !== e$c.undo || this.interactiveUndoDisabled || i2 ? t2 !== e$c.redo || this.interactiveUndoDisabled || i2 ? t2 !== e$c.pan || i2 || (e2.stopPropagation(), this._panEnabled = true) : (e2.stopPropagation(), this.redo()) : (e2.stopPropagation(), this.undo()) : (e2.stopPropagation(), this._drawCompleteHandler(e2));
    }, P$h.TOOL), this.view.on("key-up", (e2) => {
      e2.key === e$c.pan && (e2.stopPropagation(), this._panEnabled = false);
    }, P$h.TOOL)], this._viewHandlesKey);
  }
  _addUndoRedoHandles() {
    this._removeUndoRedoHandles(), this._handles.add([this._editGeometryOperations.on("vertex-remove", (e2) => {
      if (this.notifyChange("vertices"), e2.operation === "undo") {
        const i2 = this._nativeEventHistory.undoStack.pop();
        this._nativeEventHistory.redoStack.push(i2);
        const o2 = [...this._committedVertices];
        r$1$(this._stagedVertex) && o2.push(this._coordinateHelper.pointToArray(this._stagedVertex)), this.emit("undo", new s$m(this.view, i2, e2.vertices[0].index, o2));
      }
    }), this._editGeometryOperations.on("vertex-add", (e2) => {
      if (this.notifyChange("vertices"), e2.operation === "apply") {
        const e3 = this._nativeEventHistory.undoStack[this._nativeEventHistory.undoStack.length], t2 = this._committedVertices.length - 1, i2 = new t$i(this.view, e3, t2, this.vertices);
        this.emit("vertex-add", i2), i2.defaultPrevented && (this._popVertexOnPointerMove = true);
      } else if (e2.operation === "redo") {
        const i2 = this._nativeEventHistory.redoStack.pop();
        this._nativeEventHistory.undoStack.push(i2);
        const o2 = [...this._committedVertices];
        r$1$(this._stagedVertex) && o2.push(this._coordinateHelper.pointToArray(this._stagedVertex)), this.emit("redo", new t$i(this.view, i2, e2.vertices[0].index, o2));
      }
    })], this._undoRedoHandlesKey);
  }
  _removeViewHandles() {
    this._handles.remove(this._viewHandlesKey);
  }
  _removeUndoRedoHandles() {
    this._handles.remove(this._undoRedoHandlesKey);
  }
  _addDrawTool() {
    this._drawTool = new h$f({ view: this.view, elevationInfo: this.elevationInfo, hasZ: this.hasZ, geometryType: "polygon", mode: this.mode }), this.view.addAndActivateTool(this._drawTool), this._drawTool.on("vertex-add", (e2) => {
      e2.vertices.length === 1 && this.emit("vertex-add", new t$i(this.view, null, e2.vertices[0].vertexIndex, this._drawTool.getVertexCoords()));
    }), this._drawTool.on("cursor-update", (e2) => {
      e2.vertices.length === 1 && this.emit("cursor-update", new i$u(this.view, null, e2.vertices[0].vertexIndex, this._drawTool.getVertexCoords()));
    }), this._drawTool.on("complete", (e2) => {
      this.emit("draw-complete", new r$i(null, this._drawTool.getVertexCoords())), this._removeDrawTool();
    });
  }
  _removeDrawTool() {
    this._handles.remove(this._drawToolHandlesKey), this.view.tools.remove(this._drawTool), this._drawTool = s$2D(this._drawTool);
  }
  _addVertex(e2, t2) {
    const i2 = this._coordinateHelper.arrayToVector(e2);
    if (this._isDuplicateOfLastVertex(i2))
      return;
    this._lastVertexUnsnapped = this._stagedVertexUnsnapped, this._popCursorVertex(), this._editGeometryOperations.appendVertex(i2);
    const o2 = t2 || new Event("placeholder");
    this._nativeEventHistory.undoStack.push(o2);
  }
  _updateCursor(e2, i2 = false) {
    if (this._popCursorVertex(), !this._cursorScreenPoint)
      return;
    const o2 = this.getCoordsAndPointFromScreenPoint(this._cursorScreenPoint);
    r$1$(o2) && !i2 && this._pushCursorVertex(o2.vertex, () => this.emit("cursor-update", new i$u(this.view, e2, this._activeComponent.vertices.length, this.vertices, r$1$(this._stagedVertex) ? new w$_(this._stagedVertex) : null)));
  }
  _completeDrawing(e2) {
    if (this._activePointerId = null, this._popCursorVertex(), this._committedVertices.length < 3)
      return;
    this._abortSnapping(), r$1$(this._snappingManager) && this._snappingManager.doneSnapping();
    const i2 = new r$i(e2, this.vertices);
    this.emit("draw-complete", i2), i2.defaultPrevented || this._removeViewHandles();
  }
};
e$2g([y$1I()], w$9.prototype, "_dragEnabled", null), e$2g([y$1I()], w$9.prototype, "_clickEnabled", null), e$2g([y$1I({ type: c$n })], w$9.prototype, "mode", void 0), w$9 = e$2g([n$2P("esri.views.draw.PolygonDrawAction")], w$9);
let w$8 = class extends S$9 {
  constructor(e2) {
    super(e2), this._panEnabled = false, this._popVertexOnPointerMove = false, this._addVertexOnPointerUp = false, this.mode = e$b;
  }
  initialize() {
    this.view.type === "2d" ? (this._addViewHandles(), this._addUndoRedoHandles()) : this._addDrawTool();
  }
  destroy() {
    this.view.type === "2d" ? (this._removeViewHandles(), this._removeUndoRedoHandles()) : this._removeDrawTool(), this.emit("destroy");
  }
  get _clickEnabled() {
    return this.mode === "click" || this.mode === "hybrid";
  }
  get _dragEnabled() {
    return this.mode === "freehand" || this.mode === "hybrid";
  }
  undo() {
    super.undo(), this.notifyChange("vertices");
  }
  redo() {
    super.redo(), this.notifyChange("vertices");
  }
  complete() {
    this.view.type === "2d" ? this._completeDrawing() : this._drawTool.completeCreateOperation();
  }
  _addViewHandles() {
    this._removeViewHandles(), this._handles.add([this.view.on("click", (e2) => {
      e2.stopPropagation();
    }, P$h.TOOL), this.view.on("pointer-down", (e2) => {
      this._shouldHandlePointerEvent(e2) && !this._panEnabled && (this._abortSnapping(), this._activePointerId = e2.pointerId, this._addVertexOnPointerUp = true, this._cursorScreenPoint = n$Y(e2), e2.pointerType === "touch" && this._updateCursor(e2.native));
    }, P$h.TOOL), this.view.on("pointer-move", (e2) => {
      this._popVertexOnPointerMove && (this.undo(), this._popVertexOnPointerMove = false), this._abortSnapping(), this._cursorScreenPoint = n$Y(e2), e2.pointerType !== "touch" && this._updateCursor(e2.native);
    }, P$h.TOOL), this.view.on("pointer-drag", (e2) => {
      this._shouldHandlePointerEvent(e2) && (this._abortSnapping(), this._cursorScreenPoint = n$Y(e2), this._dragEnabled && !this._panEnabled ? this._vertexAddHandler(e2) : this._addVertexOnPointerUp = false);
    }, P$h.TOOL), this.view.on("pointer-up", (e2) => {
      if (this._shouldHandlePointerEvent(e2))
        if (this._abortSnapping(), this._activePointerId = null, this._addVertexOnPointerUp) {
          if (!this._clickEnabled)
            return this.vertices.length === 1 && this.vertices.pop(), void this._drawCompleteHandler(e2);
          this._vertexAddHandler(e2);
        } else {
          const t2 = e2.pointerType === "touch";
          this._updateCursor(e2.native, t2);
        }
    }, P$h.TOOL), this.view.on("drag", (e2) => {
      this._dragEnabled && r$1$(this._activePointerId) && !this._panEnabled && e2.stopPropagation();
    }, P$h.TOOL), this.view.on("drag", ["Shift"], (e2) => {
      e2.stopPropagation();
    }, P$h.TOOL), this.view.on("double-click", (e2) => {
      e2.stopPropagation(), this._drawCompleteHandler(e2);
    }, P$h.TOOL), this.view.on("double-click", ["Control"], (e2) => {
      e2.stopPropagation(), this._drawCompleteHandler(e2);
    }, P$h.TOOL), this.view.on("key-down", (e2) => {
      const { key: t2, repeat: i2 } = e2;
      t2 === e$c.vertexAdd && !i2 && this._cursorScreenPoint ? (e2.stopPropagation(), this._abortSnapping(), this._vertexAddHandler(e2)) : t2 !== e$c.complete || i2 ? t2 !== e$c.undo || this.interactiveUndoDisabled || i2 ? t2 !== e$c.redo || this.interactiveUndoDisabled || i2 ? t2 !== e$c.pan || i2 || (e2.stopPropagation(), this._panEnabled = true) : (e2.stopPropagation(), this.redo()) : (e2.stopPropagation(), this.undo()) : (e2.stopPropagation(), this._drawCompleteHandler(e2));
    }, P$h.TOOL), this.view.on("key-up", (e2) => {
      e2.key === e$c.pan && (e2.stopPropagation(), this._panEnabled = false);
    }, P$h.TOOL)], this._viewHandlesKey);
  }
  _addUndoRedoHandles() {
    this._removeUndoRedoHandles(), this._handles.add([this._editGeometryOperations.on("vertex-remove", (e2) => {
      if (this.notifyChange("vertices"), e2.operation === "undo") {
        const i2 = this._nativeEventHistory.undoStack.pop();
        this._nativeEventHistory.redoStack.push(i2);
        const o2 = [...this._committedVertices];
        r$1$(this._stagedVertex) && o2.push(this._coordinateHelper.pointToArray(this._stagedVertex)), this.emit("undo", new s$m(this.view, i2, e2.vertices[0].index, o2));
      }
    }), this._editGeometryOperations.on("vertex-add", (e2) => {
      if (this.notifyChange("vertices"), e2.operation === "apply") {
        const e3 = this._nativeEventHistory.undoStack[this._nativeEventHistory.undoStack.length], t2 = this._committedVertices.length - 1, i2 = new t$i(this.view, e3, t2, this.vertices);
        this.emit("vertex-add", i2), i2.defaultPrevented && (this._popVertexOnPointerMove = true);
      } else if (e2.operation === "redo") {
        const i2 = this._nativeEventHistory.redoStack.pop();
        this._nativeEventHistory.undoStack.push(i2);
        const o2 = [...this._committedVertices];
        r$1$(this._stagedVertex) && o2.push(this._coordinateHelper.pointToArray(this._stagedVertex)), this.emit("redo", new t$i(this.view, i2, e2.vertices[0].index, o2));
      }
    })], this._undoRedoHandlesKey);
  }
  _removeViewHandles() {
    this._handles.remove(this._viewHandlesKey);
  }
  _removeUndoRedoHandles() {
    this._handles.remove(this._undoRedoHandlesKey);
  }
  _addDrawTool() {
    this._drawTool = new h$f({ view: this.view, elevationInfo: this.elevationInfo, hasZ: this.hasZ, geometryType: "polyline", mode: this.mode }), this.view.addAndActivateTool(this._drawTool), this._handles.add([this._drawTool.on("vertex-add", (e2) => {
      e2.vertices.length === 1 && this.emit("vertex-add", new t$i(this.view, null, e2.vertices[0].vertexIndex, this._drawTool.getVertexCoords()));
    }), this._drawTool.on("cursor-update", (e2) => {
      e2.vertices.length === 1 && this.emit("cursor-update", new i$u(this.view, null, e2.vertices[0].vertexIndex, this._drawTool.getVertexCoords()));
    }), this._drawTool.on("complete", (e2) => {
      this.emit("draw-complete", new r$i(null, this._drawTool.getVertexCoords())), this._removeDrawTool();
    })], this._drawToolHandlesKey);
  }
  _removeDrawTool() {
    this._handles.remove(this._drawToolHandlesKey), this.view.tools.remove(this._drawTool), this._drawTool = s$2D(this._drawTool);
  }
  _addVertex(e2, t2) {
    const i2 = this._coordinateHelper.arrayToVector(e2);
    if (this._isDuplicateOfLastVertex(i2))
      return;
    this._lastVertexUnsnapped = this._stagedVertexUnsnapped, this._popCursorVertex(), this._editGeometryOperations.appendVertex(i2);
    const o2 = t2 || new Event("placeholder");
    this._nativeEventHistory.undoStack.push(o2);
  }
  _updateCursor(e2, i2 = false) {
    if (this._popCursorVertex(), !this._cursorScreenPoint)
      return;
    const o2 = this.getCoordsAndPointFromScreenPoint(this._cursorScreenPoint);
    r$1$(o2) && !i2 && this._pushCursorVertex(o2.vertex, () => this.emit("cursor-update", new i$u(this.view, e2, this._activeComponent.vertices.length, this.vertices, r$1$(this._stagedVertex) ? new w$_(this._stagedVertex) : null)));
  }
  _completeDrawing(e2) {
    if (this._activePointerId = null, this._popCursorVertex(), this._committedVertices.length < 2)
      return;
    this._abortSnapping(), r$1$(this._snappingManager) && this._snappingManager.doneSnapping();
    const i2 = new r$i(e2, this.vertices);
    this.emit("draw-complete", i2), i2.defaultPrevented || this._removeViewHandles();
  }
};
e$2g([y$1I()], w$8.prototype, "_clickEnabled", null), e$2g([y$1I()], w$8.prototype, "_dragEnabled", null), e$2g([y$1I({ type: c$n })], w$8.prototype, "mode", void 0), w$8 = e$2g([n$2P("esri.views.draw.PolylineDrawAction")], w$8);
function b$9(t2) {
  return t2[0] = 0, t2[1] = 0, t2[2] = 0, t2[3] = 1, t2;
}
function v$b(t2, s2, a2) {
  a2 *= 0.5;
  const n2 = Math.sin(a2);
  return t2[0] = n2 * s2[0], t2[1] = n2 * s2[1], t2[2] = n2 * s2[2], t2[3] = Math.cos(a2), t2;
}
function x$8(t2, s2) {
  const a2 = 2 * Math.acos(s2[3]), n2 = Math.sin(a2 / 2);
  return n2 > a$2x() ? (t2[0] = s2[0] / n2, t2[1] = s2[1] / n2, t2[2] = s2[2] / n2) : (t2[0] = 1, t2[1] = 0, t2[2] = 0), a2;
}
function y$9(t2, s2, a2) {
  const n2 = s2[0], o2 = s2[1], r2 = s2[2], e2 = s2[3], c2 = a2[0], u2 = a2[1], i2 = a2[2], h2 = a2[3];
  return t2[0] = n2 * h2 + e2 * c2 + o2 * i2 - r2 * u2, t2[1] = o2 * h2 + e2 * u2 + r2 * c2 - n2 * i2, t2[2] = r2 * h2 + e2 * i2 + n2 * u2 - o2 * c2, t2[3] = e2 * h2 - n2 * c2 - o2 * u2 - r2 * i2, t2;
}
function A$6(t2, s2, a2) {
  a2 *= 0.5;
  const n2 = s2[0], o2 = s2[1], r2 = s2[2], e2 = s2[3], c2 = Math.sin(a2), u2 = Math.cos(a2);
  return t2[0] = n2 * u2 + e2 * c2, t2[1] = o2 * u2 + r2 * c2, t2[2] = r2 * u2 - o2 * c2, t2[3] = e2 * u2 - n2 * c2, t2;
}
function I$7(t2, s2, a2) {
  a2 *= 0.5;
  const n2 = s2[0], o2 = s2[1], r2 = s2[2], e2 = s2[3], c2 = Math.sin(a2), u2 = Math.cos(a2);
  return t2[0] = n2 * u2 - r2 * c2, t2[1] = o2 * u2 + e2 * c2, t2[2] = r2 * u2 + n2 * c2, t2[3] = e2 * u2 - o2 * c2, t2;
}
function _$7(t2, s2, a2) {
  a2 *= 0.5;
  const n2 = s2[0], o2 = s2[1], r2 = s2[2], e2 = s2[3], c2 = Math.sin(a2), u2 = Math.cos(a2);
  return t2[0] = n2 * u2 + o2 * c2, t2[1] = o2 * u2 - n2 * c2, t2[2] = r2 * u2 + e2 * c2, t2[3] = e2 * u2 - r2 * c2, t2;
}
function z$8(t2, s2) {
  const a2 = s2[0], n2 = s2[1], o2 = s2[2];
  return t2[0] = a2, t2[1] = n2, t2[2] = o2, t2[3] = Math.sqrt(Math.abs(1 - a2 * a2 - n2 * n2 - o2 * o2)), t2;
}
function E$9(t2, s2, a2, n2) {
  const r2 = s2[0], e2 = s2[1], c2 = s2[2], u2 = s2[3];
  let i2, h2, M2, f2, l2, m2 = a2[0], p2 = a2[1], q2 = a2[2], g2 = a2[3];
  return h2 = r2 * m2 + e2 * p2 + c2 * q2 + u2 * g2, h2 < 0 && (h2 = -h2, m2 = -m2, p2 = -p2, q2 = -q2, g2 = -g2), 1 - h2 > a$2x() ? (i2 = Math.acos(h2), M2 = Math.sin(i2), f2 = Math.sin((1 - n2) * i2) / M2, l2 = Math.sin(n2 * i2) / M2) : (f2 = 1 - n2, l2 = n2), t2[0] = f2 * r2 + l2 * m2, t2[1] = f2 * e2 + l2 * p2, t2[2] = f2 * c2 + l2 * q2, t2[3] = f2 * u2 + l2 * g2, t2;
}
function L$1(t2) {
  const s2 = n$2u, a2 = s2(), n2 = s2(), o2 = s2(), e2 = Math.sqrt(1 - a2), c2 = Math.sqrt(a2);
  return t2[0] = e2 * Math.sin(2 * Math.PI * n2), t2[1] = e2 * Math.cos(2 * Math.PI * n2), t2[2] = c2 * Math.sin(2 * Math.PI * o2), t2[3] = c2 * Math.cos(2 * Math.PI * o2), t2;
}
function O$7(t2, s2) {
  const a2 = s2[0], n2 = s2[1], o2 = s2[2], r2 = s2[3], e2 = a2 * a2 + n2 * n2 + o2 * o2 + r2 * r2, c2 = e2 ? 1 / e2 : 0;
  return t2[0] = -a2 * c2, t2[1] = -n2 * c2, t2[2] = -o2 * c2, t2[3] = r2 * c2, t2;
}
function S$7(t2, s2) {
  return t2[0] = -s2[0], t2[1] = -s2[1], t2[2] = -s2[2], t2[3] = s2[3], t2;
}
function T$7(t2, s2) {
  const a2 = s2[0] + s2[4] + s2[8];
  let n2;
  if (a2 > 0)
    n2 = Math.sqrt(a2 + 1), t2[3] = 0.5 * n2, n2 = 0.5 / n2, t2[0] = (s2[5] - s2[7]) * n2, t2[1] = (s2[6] - s2[2]) * n2, t2[2] = (s2[1] - s2[3]) * n2;
  else {
    let a3 = 0;
    s2[4] > s2[0] && (a3 = 1), s2[8] > s2[3 * a3 + a3] && (a3 = 2);
    const o2 = (a3 + 1) % 3, r2 = (a3 + 2) % 3;
    n2 = Math.sqrt(s2[3 * a3 + a3] - s2[3 * o2 + o2] - s2[3 * r2 + r2] + 1), t2[a3] = 0.5 * n2, n2 = 0.5 / n2, t2[3] = (s2[3 * o2 + r2] - s2[3 * r2 + o2]) * n2, t2[o2] = (s2[3 * o2 + a3] + s2[3 * a3 + o2]) * n2, t2[r2] = (s2[3 * r2 + a3] + s2[3 * a3 + r2]) * n2;
  }
  return t2;
}
function k$5(t2, s2, a2, n2) {
  const o2 = 0.5 * Math.PI / 180;
  s2 *= o2, a2 *= o2, n2 *= o2;
  const r2 = Math.sin(s2), e2 = Math.cos(s2), c2 = Math.sin(a2), u2 = Math.cos(a2), i2 = Math.sin(n2), h2 = Math.cos(n2);
  return t2[0] = r2 * u2 * h2 - e2 * c2 * i2, t2[1] = e2 * c2 * h2 + r2 * u2 * i2, t2[2] = e2 * u2 * i2 - r2 * c2 * h2, t2[3] = e2 * u2 * h2 + r2 * c2 * i2, t2;
}
function w$7(t2) {
  return "quat(" + t2[0] + ", " + t2[1] + ", " + t2[2] + ", " + t2[3] + ")";
}
const B$6 = a$2w, C$6 = r$1y, D$6 = s$1X, F$9 = y$9, G$7 = l$2g, R$5 = y$1p, W$3 = j$S, X$3 = x$T, Y$3 = X$3, Z$2 = q$p, H$4 = Z$2, J$8 = v$10, K$4 = D$w, N$8 = E$K;
function Q$5(t2, s2, a2) {
  const n2 = P$A(s2, a2);
  return n2 < -0.999999 ? (_$K(U$3, V$5, s2), Y$g(U$3) < 1e-6 && _$K(U$3, $$2, s2), z$G(U$3, U$3), v$b(t2, U$3, Math.PI), t2) : n2 > 0.999999 ? (t2[0] = 0, t2[1] = 0, t2[2] = 0, t2[3] = 1, t2) : (_$K(U$3, s2, a2), t2[0] = U$3[0], t2[1] = U$3[1], t2[2] = U$3[2], t2[3] = 1 + n2, J$8(t2, t2));
}
const U$3 = n$2v(), V$5 = r$1B(1, 0, 0), $$2 = r$1B(0, 1, 0);
function tt(t2, s2, a2, n2, o2, r2) {
  return E$9(st, s2, o2, r2), E$9(at, a2, n2, r2), E$9(t2, st, at, 2 * r2 * (1 - r2)), t2;
}
const st = e$f(), at = e$f();
function nt(t2, s2, a2, n2) {
  const o2 = ot;
  return o2[0] = a2[0], o2[3] = a2[1], o2[6] = a2[2], o2[1] = n2[0], o2[4] = n2[1], o2[7] = n2[2], o2[2] = -s2[0], o2[5] = -s2[1], o2[8] = -s2[2], J$8(t2, T$7(t2, o2));
}
const ot = e$h();
Object.freeze(Object.defineProperty({ __proto__: null, identity: b$9, setAxisAngle: v$b, getAxisAngle: x$8, multiply: y$9, rotateX: A$6, rotateY: I$7, rotateZ: _$7, calculateW: z$8, slerp: E$9, random: L$1, invert: O$7, conjugate: S$7, fromMat3: T$7, fromEuler: k$5, str: w$7, copy: B$6, set: C$6, add: D$6, mul: F$9, scale: G$7, dot: R$5, lerp: W$3, length: X$3, len: Y$3, squaredLength: Z$2, sqrLen: H$4, normalize: J$8, exactEquals: K$4, equals: N$8, rotationTo: Q$5, sqlerp: tt, setAxes: nt }, Symbol.toStringTag, { value: "Module" }));
function g$b(r2, e2, s2 = null) {
  return r$1$(s2) ? [r2, e2, s2] : [r2, e2];
}
function R$4(r2, e2, s2 = null) {
  return r$1$(s2) ? { x: r2, y: e2, z: s2 } : { x: r2, y: e2 };
}
class W$2 {
  constructor(t2) {
    this.spatialReference = t2;
  }
  mapToLocalMultiple(t2) {
    return m$2z(t2.map((t3) => this.mapToLocal(t3)));
  }
  get doUnnormalization() {
    return false;
  }
}
class v$a extends W$2 {
  constructor(t2, r2, o2 = null) {
    super(r2), this._defaultZ = o2, this.transform = e$B(), this.transformInv = e$B(), this.transform = r$P(t2), r$U(this.transformInv, this.transform);
  }
  makeMapPoint(t2, r2) {
    return g$b(t2, r2, this._defaultZ);
  }
  mapToLocal(t2) {
    return R$4(this.transform[0] * t2[0] + this.transform[2] * t2[1] + this.transform[4], this.transform[1] * t2[0] + this.transform[3] * t2[1] + this.transform[5]);
  }
  localToMap(t2) {
    return g$b(this.transformInv[0] * t2.x + this.transformInv[2] * t2.y + this.transformInv[4], this.transformInv[1] * t2.x + this.transformInv[3] * t2.y + this.transformInv[5], this._defaultZ);
  }
}
class F$8 extends W$2 {
  constructor(t2, r2) {
    super(t2.spatialReference), this.view = t2, this.defaultZ = null, this.pWS = n$2v(), this.tangentFrameUpWS = n$2v(), this.tangentFrameRightWS = n$2v(), this.tangentFrameForwardWS = n$2v(), this.localFrameRightWS = n$2v(), this.localFrameUpWS = n$2v(), this.worldToLocalTransform = e$f(), this.localToWorldTransform = e$f(), this.scale = 1, this.scale = t2.resolution, this.referenceMapPoint = r2, this.defaultZ = r2.hasZ ? r2.z : null;
    const e2 = t2.state.camera.viewRight;
    this.view.renderCoordsHelper.toRenderCoords(this.referenceMapPoint, this.pWS), this.view.renderCoordsHelper.worldBasisAtPosition(this.pWS, n$u.X, this.tangentFrameRightWS), this.view.renderCoordsHelper.worldBasisAtPosition(this.pWS, n$u.Y, this.tangentFrameUpWS), this.view.renderCoordsHelper.worldBasisAtPosition(this.pWS, n$u.Z, this.tangentFrameForwardWS);
    const s2 = n$2v();
    g$19(s2, this.tangentFrameForwardWS, P$A(e2, this.tangentFrameForwardWS)), e$1G(this.localFrameRightWS, e2, s2), z$G(this.localFrameRightWS, this.localFrameRightWS), _$K(this.localFrameUpWS, this.tangentFrameForwardWS, this.localFrameRightWS), Q$5(this.worldToLocalTransform, this.localFrameRightWS, this.tangentFrameRightWS), O$7(this.localToWorldTransform, this.worldToLocalTransform);
  }
  get doUnnormalization() {
    return this.view.viewingMode === "global";
  }
  makeMapPoint(t2, r2) {
    return g$b(t2, r2, this.defaultZ);
  }
  mapToLocal(r2) {
    const e2 = n$2v();
    this.view.renderCoordsHelper.toRenderCoords(new w$_({ x: r2[0], y: r2[1], spatialReference: this.spatialReference }), e2), E$L(e2, e2, this.worldToLocalTransform);
    const s2 = this.view.renderCoordsHelper.fromRenderCoords(e2, this.view.spatialReference);
    return r$1$(s2) ? R$4(s2.x / this.scale, s2.y / this.scale) : null;
  }
  localToMap(r2) {
    const e2 = n$2v();
    this.view.renderCoordsHelper.toRenderCoords(new w$_({ x: r2.x * this.scale, y: r2.y * this.scale, spatialReference: this.spatialReference }), e2), E$L(e2, e2, this.localToWorldTransform);
    const s2 = this.view.renderCoordsHelper.fromRenderCoords(e2, this.view.spatialReference);
    return r$1$(s2) ? g$b(s2.x, s2.y, this.defaultZ) : null;
  }
}
function S$6(t2, r2) {
  if (t2.type === "2d")
    return new v$a(t2.state.transform, t2.spatialReference, r2.length > 2 ? r2[2] : null);
  if (t2.type === "3d") {
    const e2 = r2.length > 2 ? new w$_({ x: r2[0], y: r2[1], z: r2[2], spatialReference: t2.spatialReference }) : new w$_({ x: r2[0], y: r2[1], spatialReference: t2.spatialReference });
    return new F$8(t2, e2);
  }
  return null;
}
const T$6 = ["freehand", "click"];
let O$6 = class extends S$9 {
  constructor(e2) {
    super(e2), this._isDragging = false, this._panEnabled = false, this._addVertexOnPointerUp = false, this.viewAlignedCoordinateSystem = null, this.mode = "freehand";
  }
  initialize() {
    this.view.type === "2d" ? this._addViewHandles() : this._addDrawTool();
  }
  destroy() {
    this.view.type === "2d" ? this._removeViewHandles() : this._removeDrawTool(), this.emit("destroy");
  }
  complete() {
    this.view.type === "2d" ? this._completeDrawing() : this._drawTool.completeCreateOperation();
  }
  _getGeometryZValue() {
    return this.hasZ && this.vertices.length > 0 ? this.vertices[0][2] : this.defaultZ;
  }
  _addViewHandles() {
    this._removeViewHandles(), this.mode === "click" ? this._handles.add(this._getClickModeViewHandles(), this._viewHandlesKey) : this._handles.add(this._getDragModeViewHandles(), this._viewHandlesKey);
  }
  _getDragModeViewHandles() {
    return [this.view.on("immediate-click", (e2) => {
      if (e2.stopPropagation(), e2.mapPoint && !this._panEnabled) {
        const i2 = this.getCoordsFromScreenPoint(n$Y(e2));
        r$1$(i2) && (this._vertexAddHandler(e2), this._drawCompleteHandler(e2));
      }
    }, P$h.TOOL), this.view.on("pointer-down", (e2) => {
      this._shouldHandlePointerEvent(e2) && (this._abortSnapping(), this._panEnabled || (this._resetGeometry(), this._addVertexOnPointerUp = true, this._cursorScreenPoint = n$Y(e2), this._activePointerId = e2.pointerId, this._vertexAddHandler(e2), this._isDragging = false, e2.pointerType === "touch" && this._updateCursor(e2.native)));
    }, P$h.TOOL), this.view.on("pointer-move", (e2) => {
      this._abortSnapping(), t$2r(this._activePointerId) && e2.pointerType !== "touch" && (this._cursorScreenPoint = n$Y(e2), this._updateCursor(e2.native));
    }, P$h.TOOL), this.view.on("pointer-drag", (e2) => {
      this._shouldHandlePointerEvent(e2) && (this._abortSnapping(), this._isDragging = true, this._cursorScreenPoint = n$Y(e2), this._updateCursor(e2.native));
    }, P$h.TOOL), this.view.on("pointer-up", (e2) => {
      this._shouldHandlePointerEvent(e2) && this._addVertexOnPointerUp && (this._abortSnapping(), this._activePointerId = null, this._isDragging && this._vertexAddHandler(e2), this._committedVertices.length === 2 && this._drawCompleteHandler(e2), this._isDragging = false);
    }, P$h.TOOL), this.view.on("key-down", (e2) => {
      e2.key === e$c.complete && this._cursorScreenPoint ? (this._abortSnapping(), this._vertexAddHandler(e2), this._drawCompleteHandler(e2)) : e2.key === e$c.pan && (this._panEnabled = true);
    }, P$h.TOOL), this.view.on("key-up", (e2) => {
      e2.key === e$c.pan && (this._panEnabled = false);
    }, P$h.TOOL), this.view.on("drag", (e2) => {
      r$1$(this._activePointerId) && e2.stopPropagation();
    }, P$h.TOOL), this.view.on("drag", ["Shift"], (e2) => {
      e2.stopPropagation();
    }, P$h.TOOL)];
  }
  _getClickModeViewHandles() {
    return [this.view.on("pointer-down", (e2) => {
      this._abortSnapping(), this._cursorScreenPoint = n$Y(e2), this._activePointerId = e2.pointerId, this._isDragging = false, e2.pointerType === "touch" && this._updateCursor(e2.native);
    }, P$h.TOOL), this.view.on("pointer-move", (e2) => {
      this._abortSnapping(), this._cursorScreenPoint = n$Y(e2), t$2r(this._activePointerId) && e2.pointerType !== "touch" && this._updateCursor(e2.native);
    }, P$h.TOOL), this.view.on("pointer-drag", (e2) => {
      this._shouldHandlePointerEvent(e2) && (this._abortSnapping(), this._isDragging = true);
    }, P$h.TOOL), this.view.on("pointer-up", (e2) => {
      this._shouldHandlePointerEvent(e2) && (this._abortSnapping(), this._activePointerId = null, e2.stopPropagation(), this._isDragging || this._vertexAddHandler(e2), this.vertices.length !== 2 || this._isDragging || this._drawCompleteHandler(e2), this._isDragging = false);
    }, P$h.TOOL), this.view.on("key-down", (e2) => {
      e2.key === e$c.vertexAdd && this._cursorScreenPoint && (this._vertexAddHandler(e2), this.vertices.length === 2 && this._drawCompleteHandler(e2)), e2.key === e$c.complete && this._cursorScreenPoint && this.vertices.length === 2 && (this._vertexAddHandler(e2), this._drawCompleteHandler(e2));
    }, P$h.TOOL)];
  }
  _removeViewHandles() {
    this._handles.remove(this._viewHandlesKey);
  }
  _addDrawTool() {
    this._drawTool = new h$f({ view: this.view, elevationInfo: this.elevationInfo, hasZ: this.hasZ, geometryType: "segment", mode: this.mode }), this.view.addAndActivateTool(this._drawTool), this._handles.add([this._drawTool.on("vertex-add", (e2) => {
      e2.vertices.length === 1 && this.emit("vertex-add", new t$i(this.view, null, e2.vertices[0].vertexIndex, this._drawTool.getVertexCoords()));
    }), this._drawTool.on("cursor-update", (e2) => {
      e2.vertices.length === 1 && this.emit("cursor-update", new i$u(this.view, null, e2.vertices[0].vertexIndex, this._drawTool.getVertexCoords()));
    }), this._drawTool.on("complete", (e2) => {
      this.emit("draw-complete", new r$i(null, this._drawTool.getVertexCoords())), this._removeDrawTool();
    })], this._drawToolHandlesKey);
  }
  _removeDrawTool() {
    this._handles.remove(this._drawToolHandlesKey), this.view.tools.remove(this._drawTool), this._drawTool = s$2D(this._drawTool);
  }
  _addVertex(e2, t2) {
    const i2 = this._coordinateHelper.arrayToVector(e2);
    if (this._isDuplicateOfLastVertex(i2))
      return;
    this._lastVertexUnsnapped = this._stagedVertexUnsnapped, this._popCursorVertex(), this._editGeometryOperations.appendVertex(i2), this._committedVertices.length === 1 && (this.viewAlignedCoordinateSystem = S$6(this.view, this._committedVertices[0]));
    const r2 = this._committedVertices.length - 1, s2 = new t$i(this.view, t2, r2, this.vertices);
    this.emit("vertex-add", s2);
  }
  _updateCursor(e2) {
    if (this._popCursorVertex(), !this._cursorScreenPoint)
      return;
    const i2 = this.getCoordsAndPointFromScreenPoint(this._cursorScreenPoint);
    r$1$(i2) && this._pushCursorVertex(i2.vertex, () => this.emit("cursor-update", new i$u(this.view, e2, this._activeComponent.vertices.length, this.vertices, r$1$(this._stagedVertex) ? new w$_(this._stagedVertex) : null)));
  }
  _completeDrawing(e2) {
    if (this._activePointerId = null, this._popCursorVertex(), this._cursorScreenPoint = null, this._isDragging = false, this._abortSnapping(), r$1$(this._snappingManager) && this._snappingManager.doneSnapping(), this.vertices.length < 1)
      return;
    const i2 = new r$i(e2, this.vertices);
    this.emit("draw-complete", i2), i2.defaultPrevented || this._removeViewHandles();
  }
  _resetGeometry() {
    this._editGeometryOperations.destroy(), this._editGeometryOperations = new V$7(new g$d("polygon", this._coordinateHelper)), this._activeComponent = new p$v(this._coordinateHelper.spatialReference, l$U.Local), this._editGeometryOperations.data.components.push(this._activeComponent);
  }
};
e$2g([y$1I({ type: T$6 })], O$6.prototype, "mode", void 0), O$6 = e$2g([n$2P("esri/views/2d/engine/markup/SegmentDrawAction")], O$6);
let p$o = class extends m$2q {
  constructor() {
    super(...arguments), this.activeAction = null, this.type = "draw", this.view = null;
  }
  destroy() {
    this.activeAction && (this.activeAction.destroy(), this.activeAction = null);
  }
  create(t2, e2) {
    this.reset();
    const o2 = __spreadValues({ view: this.view }, e2);
    switch (t2) {
      case "point":
        o2.editGeometryType = "point", this.activeAction = new _$8(o2);
        break;
      case "polyline":
        o2.editGeometryType = "polyline", this.activeAction = new w$8(o2);
        break;
      case "multipoint":
        o2.editGeometryType = "polygon", this.activeAction = new _$9(o2);
        break;
      case "polygon":
        o2.editGeometryType = "polygon", this.activeAction = new w$9(o2);
        break;
      case "rectangle":
      case "circle":
      case "ellipse":
      case "triangle":
        o2.editGeometryType = "polygon", this.activeAction = new O$6(o2);
    }
    return this.activeAction;
  }
  complete() {
    this.activeAction && this.activeAction.complete(), this.activeAction = null;
  }
  reset() {
    this.activeAction && this.activeAction.destroy(), this.activeAction = null;
  }
};
e$2g([y$1I()], p$o.prototype, "activeAction", void 0), e$2g([y$1I({ readOnly: true })], p$o.prototype, "type", void 0), e$2g([y$1I()], p$o.prototype, "view", void 0), p$o = e$2g([n$2P("esri.views.draw.Draw")], p$o);
const l$j = p$o;
function n$q(e2, t2) {
  return t2;
}
function a$h(e2, t2, r2, s2) {
  switch (r2) {
    case 0:
      return c$j(e2, t2 + s2, 0);
    case 1:
      return e2.originPosition === "lowerLeft" ? c$j(e2, t2 + s2, 1) : l$i(e2, t2 + s2, 1);
  }
}
function h$e(e2, t2, r2, s2) {
  return r2 === 2 ? c$j(e2, t2, 2) : a$h(e2, t2, r2, s2);
}
function u$f(e2, t2, r2, s2) {
  return r2 === 2 ? c$j(e2, t2, 3) : a$h(e2, t2, r2, s2);
}
function d$b(e2, t2, r2, s2) {
  return r2 === 3 ? c$j(e2, t2, 3) : h$e(e2, t2, r2, s2);
}
function c$j({ translate: e2, scale: t2 }, r2, s2) {
  return e2[s2] + r2 * t2[s2];
}
function l$i({ translate: e2, scale: t2 }, r2, s2) {
  return e2[s2] - r2 * t2[s2];
}
class f$e {
  constructor(e2) {
    this._options = e2, this.geometryTypes = ["esriGeometryPoint", "esriGeometryMultipoint", "esriGeometryPolyline", "esriGeometryPolygon"], this._previousCoordinate = [0, 0], this._transform = null, this._applyTransform = n$q, this._lengths = [], this._currentLengthIndex = 0, this._toAddInCurrentPath = 0, this._vertexDimension = 0, this._coordinateBuffer = null, this._coordinateBufferPtr = 0, this._attributesConstructor = class {
    };
  }
  createFeatureResult() {
    return { fields: [], features: [] };
  }
  finishFeatureResult(t2) {
    if (this._options.applyTransform && (t2.transform = null), this._attributesConstructor = class {
    }, this._coordinateBuffer = null, this._lengths.length = 0, !t2.hasZ)
      return;
    const r2 = o$1z(t2.geometryType, this._options.sourceSpatialReference, t2.spatialReference);
    if (!t$2r(r2))
      for (const e2 of t2.features)
        r2(e2.geometry);
  }
  createSpatialReference() {
    return {};
  }
  addField(e2, r2) {
    const s2 = e2.fields;
    c$3u(s2), s2.push(r2);
    const o2 = s2.map((e3) => e3.name);
    this._attributesConstructor = function() {
      for (const e3 of o2)
        this[e3] = null;
    };
  }
  addFeature(e2, t2) {
    e2.features.push(t2);
  }
  prepareFeatures(e2) {
    switch (this._transform = e2.transform, this._options.applyTransform && e2.transform && (this._applyTransform = this._deriveApplyTransform(e2)), this._vertexDimension = 2, e2.hasZ && this._vertexDimension++, e2.hasM && this._vertexDimension++, e2.geometryType) {
      case "esriGeometryPoint":
        this.addCoordinate = (e3, t2, r2) => this.addCoordinatePoint(e3, t2, r2), this.createGeometry = (e3) => this.createPointGeometry(e3);
        break;
      case "esriGeometryPolygon":
        this.addCoordinate = (e3, t2, r2) => this._addCoordinatePolygon(e3, t2, r2), this.createGeometry = (e3) => this._createPolygonGeometry(e3);
        break;
      case "esriGeometryPolyline":
        this.addCoordinate = (e3, t2, r2) => this._addCoordinatePolyline(e3, t2, r2), this.createGeometry = (e3) => this._createPolylineGeometry(e3);
        break;
      case "esriGeometryMultipoint":
        this.addCoordinate = (e3, t2, r2) => this._addCoordinateMultipoint(e3, t2, r2), this.createGeometry = (e3) => this._createMultipointGeometry(e3);
    }
  }
  createFeature() {
    return this._lengths.length = 0, this._currentLengthIndex = 0, this._previousCoordinate[0] = 0, this._previousCoordinate[1] = 0, this._coordinateBuffer = null, this._coordinateBufferPtr = 0, { attributes: new this._attributesConstructor() };
  }
  allocateCoordinates() {
  }
  addLength(e2, t2, r2) {
    this._lengths.length === 0 && (this._toAddInCurrentPath = t2), this._lengths.push(t2);
  }
  addQueryGeometry(e2, t2) {
    const { queryGeometry: r2, queryGeometryType: s2 } = t2, n2 = pt$1(r2.clone(), r2, false, false, this._transform), a2 = rt$1(n2, s2, false, false);
    e2.queryGeometryType = s2, e2.queryGeometry = __spreadValues({}, a2);
  }
  createPointGeometry(e2) {
    const t2 = { x: 0, y: 0, spatialReference: e2.spatialReference };
    return e2.hasZ && (t2.z = 0), e2.hasM && (t2.m = 0), t2;
  }
  addCoordinatePoint(e2, t2, s2) {
    const o2 = f$21(this._transform, "transform");
    switch (t2 = this._applyTransform(o2, t2, s2, 0), s2) {
      case 0:
        e2.x = t2;
        break;
      case 1:
        e2.y = t2;
        break;
      case 2:
        "z" in e2 ? e2.z = t2 : e2.m = t2;
        break;
      case 3:
        e2.m = t2;
    }
  }
  _transformPathLikeValue(e2, t2) {
    let s2 = 0;
    t2 <= 1 && (s2 = this._previousCoordinate[t2], this._previousCoordinate[t2] += e2);
    const o2 = f$21(this._transform, "transform");
    return this._applyTransform(o2, e2, t2, s2);
  }
  _addCoordinatePolyline(e2, t2, r2) {
    this._dehydratedAddPointsCoordinate(e2.paths, t2, r2);
  }
  _addCoordinatePolygon(e2, t2, r2) {
    this._dehydratedAddPointsCoordinate(e2.rings, t2, r2);
  }
  _addCoordinateMultipoint(e2, t2, r2) {
    r2 === 0 && e2.points.push([]);
    const s2 = this._transformPathLikeValue(t2, r2);
    e2.points[e2.points.length - 1].push(s2);
  }
  _createPolygonGeometry(e2) {
    return { rings: [[]], spatialReference: e2.spatialReference, hasZ: !!e2.hasZ, hasM: !!e2.hasM };
  }
  _createPolylineGeometry(e2) {
    return { paths: [[]], spatialReference: e2.spatialReference, hasZ: !!e2.hasZ, hasM: !!e2.hasM };
  }
  _createMultipointGeometry(e2) {
    return { points: [], spatialReference: e2.spatialReference, hasZ: !!e2.hasZ, hasM: !!e2.hasM };
  }
  _dehydratedAddPointsCoordinate(e2, t2, r2) {
    r2 === 0 && this._toAddInCurrentPath-- == 0 && (e2.push([]), this._toAddInCurrentPath = this._lengths[++this._currentLengthIndex] - 1, this._previousCoordinate[0] = 0, this._previousCoordinate[1] = 0);
    const s2 = this._transformPathLikeValue(t2, r2), o2 = e2[e2.length - 1];
    r2 === 0 && (this._coordinateBufferPtr = 0, this._coordinateBuffer = new Array(this._vertexDimension), o2.push(this._coordinateBuffer)), this._coordinateBuffer[this._coordinateBufferPtr++] = s2;
  }
  _deriveApplyTransform(e2) {
    const { hasZ: t2, hasM: r2 } = e2;
    return t2 && r2 ? d$b : t2 ? h$e : r2 ? u$f : a$h;
  }
}
async function s$k(r2, e2, t2) {
  const s2 = await n$p(r2, x$z.from(e2), t2);
  return x$A.fromJSON(s2);
}
async function n$p(o2, s2, n2) {
  const p2 = f$19(o2), i2 = __spreadValues({}, n2), u2 = x$z.from(s2), m2 = !u2.quantizationParameters, { data: f2 } = await f$17(p2, u2, new f$e({ sourceSpatialReference: u2.sourceSpatialReference, applyTransform: m2 }), i2);
  return f2;
}
async function u$e(o2, t2, r2, e2) {
  return c$i(o2, t2, r2, e2).then((o3) => l$h(t2, o3, r2, e2));
}
async function c$i(o2, t2, r2, e2) {
  var _a2;
  const n2 = __spreadValues({}, e2), s2 = p$n(t2, r2), f2 = ((_a2 = t2.outStatistics) == null ? void 0 : _a2[0]) != null, u2 = has("featurelayer-pbf-statistics"), c2 = !f2 || u2;
  let l2;
  if (r2.format === "pbf" && c2)
    try {
      l2 = await n$p(o2, s2, n2);
    } catch (d2) {
      if (d2.name !== "query:parsing-pbf")
        throw d2;
      r2.format = "json";
    }
  return r2.format !== "json" && c2 || (l2 = await a$1K(o2, s2, n2)), m$v(r2.fieldsIndex, l2.fields), l2;
}
function m$v(o2, r2) {
  if (r$1$(o2) && r$1$(r2))
    for (const t2 of r2) {
      const r3 = o2.get(t2.name);
      r3 && Object.assign(t2, r3.toJSON());
    }
}
async function l$h(o2, t2, n2, a2) {
  if (!d$a(o2, n2 == null ? void 0 : n2.infoFor3D) || t$2r(n2.infoFor3D) || !t2.assetMaps || !t2.features || !t2.features.length)
    return x$A.fromJSON(t2);
  const { meshFeatureSetFromJSON: i2 } = await y$1C(import("./meshFeatureSet.js"), a2);
  return i2(o2, n2.infoFor3D, t2);
}
function p$n(e2, a2) {
  let i2 = x$z.from(e2);
  if (i2.sourceSpatialReference = i2.sourceSpatialReference || (a2 == null ? void 0 : a2.sourceSpatialReference), (a2.gdbVersion || a2.dynamicDataSource) && (i2 = i2 === e2 ? i2.clone() : i2, i2.gdbVersion = e2.gdbVersion || a2.gdbVersion, i2.dynamicDataSource = e2.dynamicDataSource ? K$c.from(e2.dynamicDataSource) : a2.dynamicDataSource), r$1$(a2.infoFor3D) && d$a(e2, a2 == null ? void 0 : a2.infoFor3D)) {
    i2 = i2 === e2 ? i2.clone() : i2, i2.formatOf3DObjects = null;
    for (const o2 of a2.infoFor3D.queryFormats) {
      if (o2 === "3D_glb") {
        i2.formatOf3DObjects = o2;
        break;
      }
      o2 !== "3D_gltf" || i2.formatOf3DObjects || (i2.formatOf3DObjects = o2);
    }
    if (!i2.formatOf3DObjects)
      throw new s$2u("query:unsupported-3d-query-formats", "Could not find any supported 3D object query format. Only supported formats are 3D_glb and 3D_gltf");
    if (t$2r(i2.outFields) || !i2.outFields.includes("*")) {
      i2 = i2 === e2 ? i2.clone() : i2, t$2r(i2.outFields) && (i2.outFields = []);
      const { originX: o2, originY: t2, originZ: n2, translationX: s2, translationY: f2, translationZ: u2, scaleX: c2, scaleY: m2, scaleZ: l2, rotationX: p2, rotationY: d2, rotationZ: y2, rotationDeg: D2 } = a2.infoFor3D.transformFieldRoles;
      i2.outFields.push(o2, t2, n2, s2, f2, u2, c2, m2, l2, p2, d2, y2, D2);
    }
  }
  return i2;
}
function d$a(o2, r2) {
  return r$1$(r2) && o2.returnGeometry && o2.multipatchOption !== "xyFootprint" && !o2.outStatistics;
}
function n$o(t2) {
  const o2 = t2.toJSON();
  return o2.attachmentTypes && (o2.attachmentTypes = o2.attachmentTypes.join(",")), o2.keywords && (o2.keywords = o2.keywords.join(",")), o2.globalIds && (o2.globalIds = o2.globalIds.join(",")), o2.objectIds && (o2.objectIds = o2.objectIds.join(",")), o2.size && (o2.size = o2.size.join(",")), o2;
}
function a$g(o2, r2) {
  const n2 = {};
  for (const a2 of o2) {
    const { parentObjectId: o3, parentGlobalId: c2, attachmentInfos: i2 } = a2;
    for (const a3 of i2) {
      const { id: i3 } = a3, m2 = S$L(o$1H(`${r2}/${o3}/attachments/${i3}`)), p2 = a$1Y.fromJSON(a3);
      p2.set({ url: m2, parentObjectId: o3, parentGlobalId: c2 }), n2[o3] ? n2[o3].push(p2) : n2[o3] = [p2];
    }
  }
  return n2;
}
function c$h(t2, e2, s2) {
  let a2 = { query: t$1g(__spreadValues(__spreadProps(__spreadValues({}, t2.query), { f: "json" }), n$o(e2))) };
  return s2 && (a2 = __spreadProps(__spreadValues(__spreadValues({}, s2), a2), { query: __spreadValues(__spreadValues({}, s2.query), a2.query) })), U$t(t2.path + "/queryAttachments", a2);
}
async function a$f(a2, m2, n2) {
  const s2 = f$19(a2);
  return c$h(s2, c$25.from(m2), __spreadValues({}, n2)).then((t2) => a$g(t2.data.attachmentGroups, s2.path));
}
async function n$n(n2, s2, m2) {
  const p2 = f$19(n2);
  return S$w(p2, x$z.from(s2), __spreadValues({}, m2)).then((o2) => o2.data.count);
}
async function m$u(m2, n2, s2) {
  const p2 = f$19(m2);
  return x$B(p2, x$z.from(n2), __spreadValues({}, s2)).then((t2) => ({ count: t2.data.count, extent: w$Z.fromJSON(t2.data.extent) }));
}
async function s$j(s2, e2, m2) {
  const n2 = f$19(s2);
  return p$29(n2, x$z.from(e2), __spreadValues({}, m2)).then((o2) => o2.data.objectIds);
}
function o$h(e2, t2) {
  const o2 = e2.toJSON();
  return o2.objectIds && (o2.objectIds = o2.objectIds.join(",")), o2.orderByFields && (o2.orderByFields = o2.orderByFields.join(",")), o2.outFields && !(t2 == null ? void 0 : t2.returnCountOnly) ? o2.outFields.includes("*") ? o2.outFields = "*" : o2.outFields = o2.outFields.join(",") : delete o2.outFields, o2.outSpatialReference && (o2.outSR = o2.outSR.wkid || JSON.stringify(o2.outSR.toJSON()), delete o2.outSpatialReference), o2.dynamicDataSource && (o2.layer = JSON.stringify({ source: o2.dynamicDataSource }), delete o2.dynamicDataSource), o2;
}
async function r$g(e2, t2, o2) {
  const r2 = await s$i(e2, t2, o2), n2 = r2.data, a2 = n2.geometryType, d2 = n2.spatialReference, c2 = {};
  for (const s2 of n2.relatedRecordGroups) {
    const e3 = { fields: void 0, objectIdFieldName: void 0, geometryType: a2, spatialReference: d2, hasZ: !!n2.hasZ, hasM: !!n2.hasM, features: s2.relatedRecords };
    if (s2.objectId != null)
      c2[s2.objectId] = e3;
    else
      for (const t3 in s2)
        s2.hasOwnProperty(t3) && t3 !== "relatedRecords" && (c2[s2[t3]] = e3);
  }
  return __spreadProps(__spreadValues({}, r2), { data: c2 });
}
async function n$m(e2, t2, o2) {
  const r2 = await s$i(e2, t2, o2, { returnCountOnly: true }), n2 = r2.data, a2 = {};
  for (const s2 of n2.relatedRecordGroups)
    s2.objectId != null && (a2[s2.objectId] = s2.count);
  return __spreadProps(__spreadValues({}, r2), { data: a2 });
}
async function s$i(r2, n2, s2 = {}, a2) {
  const d2 = t$1g(__spreadValues(__spreadValues(__spreadProps(__spreadValues({}, r2.query), { f: "json" }), a2), o$h(n2, a2)));
  return U$t(r2.path + "/queryRelatedRecords", __spreadProps(__spreadValues({}, s2), { query: __spreadValues(__spreadValues({}, s2.query), d2) }));
}
async function n$l(e2, n2, u2) {
  n2 = d$W.from(n2);
  const a2 = f$19(e2);
  return r$g(a2, n2, u2).then((t2) => {
    const r2 = t2.data, e3 = {};
    return Object.keys(r2).forEach((t3) => e3[t3] = x$A.fromJSON(r2[t3])), e3;
  });
}
async function u$d(r2, o2, n2) {
  o2 = d$W.from(o2);
  const u2 = f$19(r2);
  return n$m(u2, o2, __spreadValues({}, n2)).then((t2) => t2.data);
}
const l$g = "Layer does not support extent calculation.";
function y$8(t2, r2) {
  var _a2, _b2;
  const o2 = t2.geometry, i2 = t2.toJSON(), s2 = i2;
  if (r$1$(o2) && (s2.geometry = JSON.stringify(o2), s2.geometryType = c$32(o2), s2.inSR = o2.spatialReference.wkid || JSON.stringify(o2.spatialReference)), ((_a2 = i2.topFilter) == null ? void 0 : _a2.groupByFields) && (s2.topFilter.groupByFields = i2.topFilter.groupByFields.join(",")), ((_b2 = i2.topFilter) == null ? void 0 : _b2.orderByFields) && (s2.topFilter.orderByFields = i2.topFilter.orderByFields.join(",")), i2.topFilter && (s2.topFilter = JSON.stringify(s2.topFilter)), i2.objectIds && (s2.objectIds = i2.objectIds.join(",")), i2.orderByFields && (s2.orderByFields = i2.orderByFields.join(",")), i2.outFields && !((r2 == null ? void 0 : r2.returnCountOnly) || (r2 == null ? void 0 : r2.returnExtentOnly) || (r2 == null ? void 0 : r2.returnIdsOnly)) ? i2.outFields.includes("*") ? s2.outFields = "*" : s2.outFields = i2.outFields.join(",") : delete s2.outFields, i2.outSR ? s2.outSR = i2.outSR.wkid || JSON.stringify(i2.outSR) : o2 && i2.returnGeometry && (s2.outSR = s2.inSR), i2.returnGeometry && delete i2.returnGeometry, i2.timeExtent) {
    const t3 = i2.timeExtent, { start: e2, end: r3 } = t3;
    e2 == null && r3 == null || (s2.time = e2 === r3 ? e2 : `${e2 != null ? e2 : "null"},${r3 != null ? r3 : "null"}`), delete i2.timeExtent;
  }
  return s2;
}
async function d$9(t2, e2, r2, o2) {
  const n2 = await c$g(t2, e2, "json", o2);
  return r$14(e2, r2, n2.data), n2;
}
async function m$t(t2, r2, o2) {
  return r$1$(r2.timeExtent) && r2.timeExtent.isEmpty ? { data: { objectIds: [] } } : c$g(t2, r2, "json", o2, { returnIdsOnly: true });
}
async function p$m(t2, r2, o2) {
  return r$1$(r2.timeExtent) && r2.timeExtent.isEmpty ? { data: { count: 0, extent: null } } : c$g(t2, r2, "json", o2, { returnExtentOnly: true, returnCountOnly: true }).then((t3) => {
    const e2 = t3.data;
    if (e2.hasOwnProperty("extent"))
      return t3;
    if (e2.features)
      throw new Error(l$g);
    if (e2.hasOwnProperty("count"))
      throw new Error(l$g);
    return t3;
  });
}
function a$e(t2, r2, o2) {
  return r$1$(r2.timeExtent) && r2.timeExtent.isEmpty ? Promise.resolve({ data: { count: 0 } }) : c$g(t2, r2, "json", o2, { returnIdsOnly: true, returnCountOnly: true });
}
function c$g(n2, u2, l2, d2 = {}, m2 = {}) {
  const p2 = typeof n2 == "string" ? j$Q(n2) : n2, a2 = u2.geometry ? [u2.geometry] : [];
  return d2.responseType = l2 === "pbf" ? "array-buffer" : "json", v$L(a2, null, d2).then((r2) => {
    const n3 = r2 && r2[0];
    r$1$(n3) && ((u2 = u2.clone()).geometry = n3);
    const i2 = t$1g(__spreadValues(__spreadValues(__spreadProps(__spreadValues({}, p2.query), { f: l2 }), m2), y$8(u2, m2)));
    return U$t(G$q(p2.path, "queryTopFeatures"), __spreadProps(__spreadValues({}, d2), { query: __spreadValues(__spreadValues({}, i2), d2.query) }));
  });
}
async function s$h(s2, p2, u2, a2) {
  const m2 = f$19(s2), i2 = __spreadValues({}, a2), { data: f2 } = await d$9(m2, v$I.from(p2), u2, i2);
  return x$A.fromJSON(f2);
}
async function s$g(s2, e2, p2) {
  const a2 = f$19(s2);
  return (await m$t(a2, v$I.from(e2), __spreadValues({}, p2))).data.objectIds;
}
async function m$s(m2, s2, n2) {
  const p2 = f$19(m2), a2 = await p$m(p2, v$I.from(s2), __spreadValues({}, n2));
  return { count: a2.data.count, extent: w$Z.fromJSON(a2.data.extent) };
}
async function s$f(s2, e2, p2) {
  const u2 = f$19(s2);
  return (await a$e(u2, v$I.from(e2), __spreadValues({}, p2))).data.count;
}
var query = /* @__PURE__ */ Object.freeze({
  __proto__: null,
  [Symbol.toStringTag]: "Module",
  executeQuery: u$e,
  executeRawQuery: c$i,
  normalizeFields: m$v,
  executeAttachmentQuery: a$f,
  executeForCount: n$n,
  executeForExtent: m$u,
  executeForIds: s$j,
  executeQueryJSON: s$1j,
  executeRawQueryJSON: a$1K,
  executeQueryPBF: s$k,
  executeRawQueryPBF: n$p,
  executeRelationshipQuery: n$l,
  executeRelationshipQueryForCount: u$d,
  executeTopFeaturesQuery: s$h,
  executeForTopIds: s$g,
  executeForTopExtents: m$s,
  executeForTopCount: s$f
});
function t$f(t2, i2) {
  for (var s2 = 0; s2 < i2.length; s2++) {
    const n2 = i2[s2];
    if (typeof n2 != "string" && !Array.isArray(n2)) {
      for (const i3 in n2)
        if (i3 !== "default" && !(i3 in t2)) {
          const s3 = Object.getOwnPropertyDescriptor(n2, i3);
          s3 && Object.defineProperty(t2, i3, s3.get ? s3 : { enumerable: true, get: () => n2[i3] });
        }
    }
  }
  return Object.freeze(Object.defineProperty(t2, Symbol.toStringTag, { value: "Module" }));
}
var i$q = { exports: {} };
!function(t2, i2) {
  function s2() {
    function t3(t4) {
      if (typeof t4 == "number")
        return Q2.Uc.ah(t4);
      if (t4 == null)
        return null;
      if (rt2[t4] != null)
        return Q2.Uc.ah(rt2[t4]);
      throw Error("Unrecognised Unit Type");
    }
    function i3(t4) {
      if (typeof t4 == "number")
        return Q2.Uc.ah(t4);
      if (t4 == null)
        return null;
      if (et2[t4] != null)
        return Q2.Uc.ah(et2[t4]);
      throw Error("Unrecognised Unit Type");
    }
    function s3(t4) {
      if (t4)
        switch (t4) {
          case "loxodrome":
            return 1;
          case "great-elliptic":
            return 2;
          case "normal-section":
            return 3;
          case "shape-preserving":
            return 4;
        }
      return 0;
    }
    function n3(t4, i4, s4, n4) {
      if (s4 == null || s4.B())
        return null;
      switch (s4.K()) {
        case Q2.sn.Point:
          return t4.exportPoint(i4, s4, n4);
        case Q2.sn.Polygon:
          return t4.exportPolygon(i4, s4, n4);
        case Q2.sn.Polyline:
          return t4.exportPolyline(i4, s4, n4);
        case Q2.sn.MultiPoint:
          return t4.exportMultipoint(i4, s4, n4);
        case Q2.sn.Envelope:
          return t4.exportExtent(i4, s4, n4);
      }
      return null;
    }
    function h2(t4, i4, s4, n4) {
      if (s4.K() !== Q2.sn.Point)
        throw Error("Geometry not Point");
      return t4.exportPoint(i4, s4, n4);
    }
    function r2(t4, i4, s4) {
      return t4.convertToGEGeometry(i4, s4);
    }
    function e2(t4) {
      var i4 = t4.wkid;
      t4 = t4.wkt;
      var s4 = ot2.get(i4 || t4);
      return s4 == null && (i4 !== -1 && i4 != null ? (s4 = Q2.Gg.create(i4), ot2.set(i4, s4)) : t4 && (s4 = Q2.Gg.lP(t4), ot2.set(t4, s4)), ut2.has(i4 || t4) && s4.QW(ut2.get(i4 || t4))), s4;
    }
    function o2(t4) {
      var i4;
      if (t4 == null)
        return null;
      var s4 = e2(t4);
      return t4 = s4.Id(), s4 = s4.Mn(), (i4 = {}).tolerance = s4, i4.unitType = t4 == null ? -1 : t4.pd, i4.unitID = t4 == null ? -1 : t4.Fc(), i4.unitBaseFactor = t4 == null ? 0 : t4.ci, i4.unitSquareDerivative = t4 == null ? 0 : Q2.Uc.WF(t4).Fc(), i4;
    }
    function a2(t4, i4, s4, h3) {
      return s4 == null ? null : (s4 = Q2.ac.clip(r2(t4, at2, s4), r2(t4, at2, h3), e2(i4)), n3(t4, at2, s4, i4));
    }
    function u2(t4, i4, s4, h3) {
      s4 = Q2.ac.fl(r2(t4, at2, s4), r2(t4, at2, h3), e2(i4)), h3 = [];
      for (var o3 = 0; o3 < s4.length; o3++)
        h3.push(n3(t4, at2, s4[o3], i4));
      return h3;
    }
    function f2(t4, i4, s4, n4) {
      if (s4 == null || n4 == null)
        throw Error("Illegal Argument Exception");
      return Q2.ac.contains(r2(t4, at2, s4), r2(t4, at2, n4), e2(i4));
    }
    function c2(t4, i4, s4, n4) {
      if (s4 == null || n4 == null)
        throw Error("Illegal Argument Exception");
      return Q2.ac.wP(r2(t4, at2, s4), r2(t4, at2, n4), e2(i4));
    }
    function l2(i4, s4, n4, h3, o3) {
      if (n4 == null || h3 == null)
        throw Error("Illegal Argument Exception");
      return Q2.ac.ub(r2(i4, at2, n4), r2(i4, at2, h3), e2(s4), t3(o3));
    }
    function p2(t4, i4, s4, n4) {
      return !(s4 == null && n4 != null || n4 == null && s4 != null) && Q2.ac.Nb(r2(t4, at2, s4), r2(t4, at2, n4), e2(i4));
    }
    function v2(t4, i4, s4, n4) {
      if (s4 == null || n4 == null)
        throw Error("Illegal Argument Exception");
      return Q2.ac.OS(r2(t4, at2, s4), r2(t4, at2, n4), e2(i4));
    }
    function y2(t4, i4, s4, n4) {
      if (s4 == null || n4 == null)
        throw Error("Illegal Argument Exception");
      return Q2.ac.touches(r2(t4, at2, s4), r2(t4, at2, n4), e2(i4));
    }
    function b2(t4, i4, s4, n4) {
      if (s4 == null || n4 == null)
        throw Error("Illegal Argument Exception");
      return Q2.ac.mY(r2(t4, at2, s4), r2(t4, at2, n4), e2(i4));
    }
    function d2(t4, i4, s4, n4) {
      if (s4 == null || n4 == null)
        throw Error("Illegal Argument Exception");
      return Q2.ac.OP(r2(t4, at2, s4), r2(t4, at2, n4), e2(i4));
    }
    function g2(t4, i4, s4, n4) {
      if (s4 == null || n4 == null)
        throw Error("Illegal Argument Exception");
      return Q2.ac.yU(r2(t4, at2, s4), r2(t4, at2, n4), e2(i4));
    }
    function w2(t4, i4, s4, n4, h3) {
      if (s4 == null || n4 == null)
        throw Error("Illegal Argument Exception");
      return Q2.ac.tB(r2(t4, at2, s4), r2(t4, at2, n4), e2(i4), h3);
    }
    function x2(t4, i4, s4) {
      if (s4 == null)
        throw Error("Illegal Argument Exception");
      return Q2.ac.ZS(r2(t4, at2, s4), e2(i4));
    }
    function m2(t4, i4, s4) {
      if (s4 == null)
        throw Error("Illegal Argument Exception");
      return s4 = Q2.ac.$B(r2(t4, at2, s4), e2(i4)), n3(t4, at2, s4, i4);
    }
    function j2(t4, i4, s4, h3) {
      if (h3 === void 0 && (h3 = false), s4 == null)
        throw Error("Illegal Argument Exception");
      if (Array.isArray(s4)) {
        var o3 = h3, a3 = [];
        for (h3 = 0; h3 < s4.length; h3++)
          a3.push(r2(t4, at2, s4[h3]));
        for (s4 = Q2.ac.eP(a3, o3), o3 = Array(s4.length), h3 = 0; h3 < s4.length; h3++)
          o3[h3] = n3(t4, at2, s4[h3], i4);
        return o3;
      }
      return h3 = Q2.ac.dP(r2(t4, at2, s4), e2(i4)), n3(t4, at2, h3, i4);
    }
    function M2(t4, i4, s4, h3) {
      if (s4 == null || h3 == null)
        throw Error("Illegal Argument Exception");
      if (Array.isArray(s4)) {
        for (var o3 = [], a3 = 0; a3 < s4.length; a3++)
          o3.push(r2(t4, at2, s4[a3]));
        for (s4 = Q2.ac.LP(o3, r2(t4, at2, h3), e2(i4)), h3 = Array(s4.length), a3 = 0; a3 < s4.length; a3++)
          h3[a3] = n3(t4, at2, s4[a3], i4);
        return h3;
      }
      return a3 = Q2.ac.km(r2(t4, at2, s4), r2(t4, at2, h3), e2(i4)), n3(t4, at2, a3, i4);
    }
    function k2(t4, i4, s4, h3) {
      if (s4 == null || h3 == null)
        throw Error("Illegal Argument Exception");
      if (Array.isArray(s4)) {
        for (var o3 = [], a3 = 0; a3 < s4.length; a3++)
          o3.push(r2(t4, at2, s4[a3]));
        for (s4 = Q2.ac.RX(o3, r2(t4, at2, h3), e2(i4)), h3 = Array(s4.length), a3 = 0; a3 < s4.length; a3++)
          h3[a3] = n3(t4, at2, s4[a3], i4);
        return h3;
      }
      return a3 = Q2.ac.gp(r2(t4, at2, s4), r2(t4, at2, h3), e2(i4)), n3(t4, at2, a3, i4);
    }
    function z2(t4, i4, s4, h3) {
      if (s4 == null || h3 == null)
        throw Error("Illegal Argument Exception");
      if (Array.isArray(s4)) {
        for (var o3 = [], a3 = 0; a3 < s4.length; a3++)
          o3.push(r2(t4, at2, s4[a3]));
        for (s4 = Q2.ac.MS(o3, r2(t4, at2, h3), e2(i4)), h3 = Array(s4.length), a3 = 0; a3 < s4.length; a3++)
          h3[a3] = n3(t4, at2, s4[a3], i4);
        return h3;
      }
      return a3 = Q2.ac.Fa(r2(t4, at2, s4), r2(t4, at2, h3), e2(i4)), n3(t4, at2, a3, i4);
    }
    function A2(t4, i4, s4, h3) {
      if (s4 == null)
        return null;
      var o3 = [];
      if (Array.isArray(s4)) {
        if (s4.length === 0)
          return null;
        for (h3 = 0; h3 < s4.length; h3++)
          o3.push(r2(t4, at2, s4[h3]));
      } else
        o3.push(r2(t4, at2, s4)), h3 != null && o3.push(r2(t4, at2, h3));
      return n3(t4, at2, Q2.ac.fY(o3, e2(i4)), i4);
    }
    function N2(i4, s4, h3, o3, a3, u3, f3, c3) {
      var l3 = 0;
      if (u3 != null)
        switch (u3) {
          case "round":
            l3 = 0;
            break;
          case "bevel":
            l3 = 1;
            break;
          case "miter":
            l3 = 2;
            break;
          case "square":
            l3 = 3;
        }
      if (Array.isArray(h3)) {
        if (h3 == null)
          i4 = null;
        else if (h3.length === 0)
          i4 = [];
        else {
          var p3 = [];
          for (u3 = 0; u3 < h3.length; u3++)
            p3.push(r2(i4, at2, h3[u3]));
          for (h3 = Q2.ac.wU(p3, e2(s4), o3, l3, f3, c3, t3(a3)), o3 = Array(h3.length), u3 = 0; u3 < h3.length; u3++)
            o3[u3] = n3(i4, at2, h3[u3], s4);
          i4 = o3;
        }
        return i4;
      }
      return h3 = Q2.ac.offset(r2(i4, at2, h3), e2(s4), o3, l3, f3, c3, t3(a3)), n3(i4, at2, h3, s4);
    }
    function I2(i4, s4, h3, o3, a3, u3) {
      if (u3 === void 0 && (u3 = false), Array.isArray(h3)) {
        if (!Array.isArray(o3)) {
          for (var f3 = [], c3 = 0; c3 < h3.length; c3++)
            f3.push(o3);
          o3 = f3;
        }
        if (o3.length != h3.length) {
          if (o3.length == 0)
            throw Error("Illegal Argument Exception");
          f3 = [];
          var l3 = 0;
          for (c3 = 0; c3 < h3.length; c3++)
            o3[c3] === void 0 ? f3.push(l3) : (f3.push(o3[c3]), l3 = o3[c3]);
          o3 = f3;
        }
        return C2(i4, s4, h3, o3, a3, false, u3, "geodesic", NaN);
      }
      return h3 = Q2.ac.buffer(r2(i4, at2, h3), e2(s4), o3, t3(a3), false, 0, NaN), n3(i4, at2, h3, s4);
    }
    function P2(i4, h3, o3, a3, u3, f3, c3, l3) {
      if (Array.isArray(o3)) {
        if (!Array.isArray(a3)) {
          for (var p3 = [], v3 = 0; v3 < o3.length; v3++)
            p3.push(a3);
          a3 = p3;
        }
        if (a3.length !== o3.length) {
          if (a3.length === 0)
            throw Error("Illegal Argument Exception");
          p3 = [];
          var y3 = 0;
          for (v3 = 0; v3 < o3.length; v3++)
            a3[v3] === void 0 ? p3.push(y3) : (p3.push(a3[v3]), y3 = a3[v3]);
          a3 = p3;
        }
        return C2(i4, h3, o3, a3, u3, true, f3, c3, l3);
      }
      return c3 === void 0 && (c3 = NaN), o3 = Q2.ac.buffer(r2(i4, at2, o3), e2(h3), a3, t3(u3), true, s3(f3), c3), n3(i4, at2, o3, h3);
    }
    function C2(i4, h3, o3, a3, u3, f3, c3, l3, p3) {
      if (p3 === void 0 && (p3 = NaN), o3 == null)
        return null;
      if (o3.length === 0)
        return [];
      for (var v3 = [], y3 = 0; y3 < o3.length; y3++)
        v3.push(r2(i4, at2, o3[y3]));
      for (o3 = Q2.ac.HN(v3, e2(h3), a3, t3(u3), f3, c3, s3(l3), p3), a3 = Array(o3.length), y3 = 0; y3 < o3.length; y3++)
        a3[y3] = n3(i4, at2, o3[y3], h3);
      return a3;
    }
    function B2(t4, i4, s4, n4, e3) {
      var o3;
      return e3 === void 0 && (e3 = true), s4 = Q2.ac.iz(r2(t4, at2, s4), r2(t4, at2, n4), e3), (o3 = {}).coordinate = h2(t4, at2, s4.az(), i4), o3.distance = s4.cz(), o3.isRightSide = s4.Nz(), o3.vertexIndex = s4.Va(), o3.isEmpty = s4.B(), o3;
    }
    function D2(t4, i4, s4, n4) {
      var e3;
      return s4 = Q2.ac.jz(r2(t4, at2, s4), r2(t4, at2, n4)), (e3 = {}).coordinate = h2(t4, at2, s4.az(), i4), e3.distance = s4.cz(), e3.isRightSide = s4.Nz(), e3.vertexIndex = s4.Va(), e3.isEmpty = s4.B(), e3;
    }
    function q2(t4, i4, s4, n4, e3, o3) {
      var a3;
      for (s4 = Q2.ac.kz(r2(t4, at2, s4), r2(t4, at2, n4), e3, o3), n4 = [], e3 = 0; e3 < s4.length; e3++)
        s4[e3].B() === false && n4.push(((a3 = {}).coordinate = h2(t4, at2, s4[e3].az(), i4), a3.distance = s4[e3].cz(), a3.isRightSide = s4[e3].Nz(), a3.vertexIndex = s4[e3].Va(), a3.isEmpty = s4[e3].B(), a3));
      return n4;
    }
    function G2(i4, s4, h3, o3, a3, u3) {
      return h3 = Q2.ac.LQ(r2(i4, at2, h3), e2(s4), o3, a3, t3(u3)), n3(i4, at2, h3, s4);
    }
    function F2(i4, s4, h3, o3, a3) {
      return h3 = Q2.ac.Sr(r2(i4, at2, h3), e2(s4), o3, t3(a3)), n3(i4, at2, h3, s4);
    }
    function T2(i4, s4, h3, o3, a3, u3) {
      return u3 === void 0 && (u3 = 0), h3 = Q2.ac.Ry(r2(i4, at2, h3), e2(s4), o3, t3(a3), u3), n3(i4, at2, h3, s4);
    }
    function E2(t4, s4, n4, h3) {
      if (n4 == null)
        throw Error("Illegal Argument Exception");
      return Q2.ac.EU(r2(t4, at2, n4), e2(s4), i3(h3));
    }
    function S2(i4, s4, n4, h3) {
      if (n4 == null)
        throw Error("Illegal Argument Exception");
      return Q2.ac.FU(r2(i4, at2, n4), e2(s4), t3(h3));
    }
    function O2(t4, n4, h3, o3, a3) {
      if (h3 == null)
        throw Error("Illegal Argument Exception");
      return Q2.ac.RQ(r2(t4, at2, h3), e2(n4), i3(o3), s3(a3));
    }
    function H2(i4, n4, h3, o3, a3) {
      if (h3 == null)
        throw Error("Illegal Argument Exception");
      return Q2.ac.UQ(r2(i4, at2, h3), e2(n4), t3(o3), s3(a3));
    }
    function J2(t4) {
      Q2.IL.bind(t4);
    }
    function R2(t4, i4, s4, n4, h3) {
      var o3 = null, a3 = null;
      if (n4) {
        if (!h3)
          throw Q2.i.O("AOI missing Spatial Reference");
        o3 = r2(t4, at2, n4), a3 = e2(h3).hh();
      }
      return (t4 = Q2.iu.SR(e2(i4).hh(), e2(s4).hh(), o3, a3)) !== null ? t4 : null;
    }
    function L2(t4, i4, s4, n4, h3) {
      var o3 = null, a3 = null;
      if (n4) {
        if (!h3)
          throw Q2.i.O("AOI missing Spatial Reference");
        o3 = r2(t4, at2, n4), a3 = e2(h3).hh();
      }
      return Q2.iu.TR(e2(i4).hh(), e2(s4).hh(), o3, a3);
    }
    function K2(t4, i4, s4, n4, h3, r3) {
      if (h3 === void 0 && (h3 = null), r3 === void 0 && (r3 = null), r3) {
        var o3 = new Q2.tC();
        o3.Xu = r3.densificationStep, o3.Lr = r3.centralMeridianOfOutputGCS, r3.clipWithInputHorizon && o3.KW(r3.clipWithInputHorizon), r3.clipWithOutputHorizon && o3.LW(r3.clipWithOutputHorizon);
      }
      if (this.GY === false)
        throw Error("Projection Engine must be enabled using enableProjection");
      if (i4.length === 0)
        return [];
      if (h3) {
        if (!(r3 = h3.getCachedGeTransformation(s4, n4)))
          t: {
            if (r3 = h3, h3 = null, r3) {
              var a3 = r3.getGTListEntry();
              if (a3 !== null) {
                h3 = new Q2.rC(null);
                for (var u3 = 0, f3 = a3.steps; u3 < f3.length; u3++) {
                  a3 = f3[u3];
                  var c3 = new Q2.Cx(a3.geogtran);
                  a3.isInverse && c3.Lz(), h3.add(c3);
                }
                o3 = Q2.xr.Pr(e2(s4).hh(), e2(n4).hh(), h3, o3), r3.assignCachedGe(s4, n4, o3), r3 = o3;
                break t;
              }
            }
            if (h3 === null && r3 && r3.steps && 0 < r3.steps.length) {
              for (h3 = new Q2.rC(null), u3 = 0, f3 = r3.steps; u3 < f3.length; u3++)
                (a3 = f3[u3]).wkid != -1 && a3.wkid != null ? h3.add(Q2.Cx.create(a3.wkid, a3.isInverse)) : h3.add(Q2.Cx.pP(a3.wkt, a3.isInverse));
              o3 = Q2.xr.Pr(e2(s4).hh(), e2(n4).hh(), h3, o3), r3.assignCachedGe(s4, n4, o3), r3 = o3;
            } else
              r3 = Q2.xr.Pr(e2(s4).hh(), e2(n4).hh(), h3, o3);
          }
        for (s4 = [], h3 = 0; h3 < i4.length; h3++)
          o3 = i4[h3], s4.push(U2(t4, o3, n4, r3));
      } else
        for (r3 = Q2.xr.Pr(e2(s4).hh(), e2(n4).hh(), null), s4 = [], h3 = 0; h3 < i4.length; h3++)
          o3 = i4[h3], s4.push(U2(t4, o3, n4, r3));
      return s4;
    }
    function U2(t4, i4, s4, h3) {
      return i4 = Q2.ac.Bh(r2(t4, at2, i4), h3), n3(t4, at2, i4, s4);
    }
    function W2(t4, i4) {
      t4 != null && (t4 = t4.wkid || t4.wkt, ut2.has(t4), ut2.set(t4, i4), ot2.has(t4) && ot2.delete(t4));
    }
    function V2(t4) {
      t4 != null && (t4 = t4.wkid || t4.wkt, ut2.has(t4) && (ut2.delete(t4), ot2.has(t4) && ot2.delete(t4)));
    }
    function X2(t4, i4, s4, h3) {
      if (s4 == null || h3 == null)
        return [];
      var o3 = [], a3 = 0;
      for (s4 = Q2.ac.LS(r2(t4, at2, s4), r2(t4, at2, h3), e2(i4)) || []; a3 < s4.length; a3++)
        o3.push(n3(t4, at2, s4[a3], i4));
      return o3;
    }
    var Y2, Q2, $2, Z2, _2 = this && this.__extends || function() {
      function t4(i4, s4) {
        return (t4 = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(t5, i5) {
          t5.__proto__ = i5;
        } || function(t5, i5) {
          for (var s5 in i5)
            i5.hasOwnProperty(s5) && (t5[s5] = i5[s5]);
        })(i4, s4);
      }
      return function(i4, s4) {
        function n4() {
          this.constructor = i4;
        }
        t4(i4, s4), i4.prototype = s4 === null ? Object.create(s4) : (n4.prototype = s4.prototype, new n4());
      };
    }();
    !function(t4) {
      var i4;
      (i4 = t4.sn || (t4.sn = {}))[i4.Unknown = 0] = "Unknown", i4[i4.Point = 33] = "Point", i4[i4.Line = 322] = "Line", i4[i4.Envelope = 197] = "Envelope", i4[i4.MultiPoint = 550] = "MultiPoint", i4[i4.Polyline = 1607] = "Polyline", i4[i4.Polygon = 1736] = "Polygon", function(t5) {
        t5[t5.enumMild = 0] = "enumMild", t5[t5.enumMedium = 1] = "enumMedium", t5[t5.enumHot = 2] = "enumHot";
      }(t4.TK || (t4.TK = {}));
      var s4 = function() {
        function i5() {
          this.description = null, this.QA = 0;
        }
        return i5.prototype.K = function() {
          return 0;
        }, i5.prototype.Eb = function() {
          return -1;
        }, i5.prototype.Pf = function(t5) {
          this.wc(), t5 != this.description && this.un(t5);
        }, i5.prototype.un = function() {
        }, i5.prototype.Ll = function(i6) {
          this.wc(), i6 != this.description && ((i6 = t4.fe.xR(this.description, i6)) != this.description && this.un(i6));
        }, i5.prototype.hasAttribute = function(t5) {
          return this.description.hasAttribute(t5);
        }, i5.prototype.se = function(i6) {
          this.wc(), this.description.hasAttribute(i6) || (i6 = t4.fe.wR(this.description, i6), this.un(i6));
        }, i5.prototype.Vg = function() {
          return null;
        }, i5.prototype.dn = function() {
        }, i5.prototype.A = function() {
        }, i5.prototype.So = function() {
        }, i5.prototype.yc = function(t5) {
          this.A(t5);
        }, i5.prototype.B = function() {
          return true;
        }, i5.prototype.Pa = function() {
        }, i5.prototype.Pc = function() {
        }, i5.prototype.Ja = function() {
          return null;
        }, i5.prototype.copyTo = function() {
        }, i5.prototype.He = function() {
          return 0;
        }, i5.prototype.Rb = function() {
          return 0;
        }, i5.prototype.dG = function() {
          return this.hasAttribute(1);
        }, i5.uf = function(t5) {
          return 1 + ((192 & t5) >> 6) >> 1;
        }, i5.Tn = function(t5) {
          return (32 & t5) != 0;
        }, i5.PS = function(t5) {
          return (128 & t5) != 0;
        }, i5.zd = function(t5) {
          return (256 & t5) != 0;
        }, i5.zj = function(t5) {
          return (512 & t5) != 0;
        }, i5.Ic = function(t5) {
          return (1024 & t5) != 0;
        }, i5.prototype.Qf = function() {
          var t5 = this.Ja();
          return this.copyTo(t5), t5;
        }, i5.prototype.ng = function() {
          return null;
        }, i5.kg = function(t5) {
          var i6 = t5.Ja();
          return t5.copyTo(i6), i6;
        }, i5.prototype.wc = function() {
          0 <= this.QA && (this.QA += 2147483649);
        }, i5.zx = function(s5) {
          var n4 = s5.K();
          if (i5.zj(n4))
            return s5.I();
          if (s5.B())
            return 0;
          if (n4 == 197)
            return 4;
          if (n4 == 33)
            return 1;
          if (i5.zd(n4))
            return 2;
          throw t4.i.ga("missing type");
        }, i5;
      }();
      t4.ba = s4;
    }(Q2 || (Q2 = {})), $2 = Q2 || (Q2 = {}), Z2 = function() {
      function t4() {
        this.y = this.x = 0;
      }
      return t4.construct = function(i4, s4) {
        var n4 = new t4();
        return n4.x = i4, n4.y = s4, n4;
      }, t4.cl = function(i4) {
        var s4 = new t4();
        return s4.x = i4.x, s4.y = i4.y, s4;
      }, t4.prototype.na = function(t5, i4) {
        this.x = t5, this.y = i4;
      }, t4.prototype.N = function(t5) {
        this.x = t5.x, this.y = t5.y;
      }, t4.prototype.hq = function(t5, i4) {
        return this.x === t5 && this.y === i4;
      }, t4.prototype.Mz = function(t5) {
        return 2220446049250313e-31 >= Math.abs(this.x - t5.x) && 2220446049250313e-31 >= Math.abs(this.y - t5.y);
      }, t4.prototype.rb = function(t5) {
        return this.x === t5.x && this.y === t5.y;
      }, t4.prototype.Nb = function(i4) {
        return i4 == this || i4 instanceof t4 && this.x == i4.x && this.y == i4.y;
      }, t4.prototype.sub = function(t5) {
        this.x -= t5.x, this.y -= t5.y;
      }, t4.prototype.vc = function(t5, i4) {
        this.x = t5.x - i4.x, this.y = t5.y - i4.y;
      }, t4.prototype.add = function(t5, i4) {
        i4 !== void 0 ? (this.x = t5.x + i4.x, this.y = t5.y + i4.y) : (this.x += t5.x, this.y += t5.y);
      }, t4.prototype.Uq = function() {
        this.x = -this.x, this.y = -this.y;
      }, t4.prototype.nt = function(t5) {
        this.x = -t5.x, this.y = -t5.y;
      }, t4.prototype.IS = function(t5, i4, s4) {
        this.x = t5.x * (1 - s4) + i4.x * s4, this.y = t5.y * (1 - s4) + i4.y * s4;
      }, t4.prototype.Dt = function(t5, i4) {
        this.x = this.x * t5 + i4.x, this.y = this.y * t5 + i4.y;
      }, t4.prototype.BW = function(t5, i4, s4) {
        this.x = i4.x * t5 + s4.x, this.y = i4.y * t5 + s4.y;
      }, t4.prototype.scale = function(t5) {
        this.x *= t5, this.y *= t5;
      }, t4.prototype.compare = function(t5) {
        return this.y < t5.y ? -1 : this.y > t5.y ? 1 : this.x < t5.x ? -1 : this.x > t5.x ? 1 : 0;
      }, t4.prototype.normalize = function() {
        var t5 = this.length();
        t5 == 0 && (this.x = 1, this.y = 0), this.x /= t5, this.y /= t5;
      }, t4.prototype.length = function() {
        return Math.sqrt(this.x * this.x + this.y * this.y);
      }, t4.prototype.Uk = function() {
        return this.x * this.x + this.y * this.y;
      }, t4.ub = function(t5, i4) {
        return Math.sqrt(this.zc(t5, i4));
      }, t4.Jy = function(t5, i4, s4, n4) {
        return t5 -= s4, i4 -= n4, Math.sqrt(t5 * t5 + i4 * i4);
      }, t4.prototype.Sh = function(t5) {
        return this.x * t5.x + this.y * t5.y;
      }, t4.prototype.aD = function(t5) {
        return Math.abs(this.x * t5.x) + Math.abs(this.y * t5.y);
      }, t4.prototype.yi = function(t5) {
        return this.x * t5.y - this.y * t5.x;
      }, t4.prototype.Ct = function(t5, i4) {
        var s4 = -this.x * i4 + this.y * t5;
        this.x = this.x * t5 + this.y * i4, this.y = s4;
      }, t4.prototype.Jv = function() {
        var t5 = this.x;
        this.x = -this.y, this.y = t5;
      }, t4.prototype.HG = function(t5) {
        this.x = -t5.y, this.y = t5.x;
      }, t4.prototype.cr = function() {
        var t5 = this.x;
        this.x = this.y, this.y = -t5;
      }, t4.prototype.su = function() {
        return 0 < this.x ? 0 <= this.y ? 1 : 4 : 0 < this.y ? 2 : this.x == 0 ? 4 : 3;
      }, t4.pu = function(t5, i4) {
        var s4 = t5.su(), n4 = i4.su();
        return n4 == s4 ? 0 > (t5 = t5.yi(i4)) ? 1 : 0 < t5 ? -1 : 0 : s4 < n4 ? -1 : 1;
      }, t4.zc = function(t5, i4) {
        var s4 = t5.x - i4.x;
        return s4 * s4 + (t5 = t5.y - i4.y) * t5;
      }, t4.prototype.toString = function() {
        return "(" + this.x + " , " + this.y + ")";
      }, t4.prototype.Sc = function() {
        this.y = this.x = NaN;
      }, t4.prototype.isNaN = function() {
        return isNaN(this.x) || isNaN(this.y);
      }, t4.prototype.offset = function(i4, s4) {
        var n4 = t4.ub(i4, s4), h3 = t4.construct(this.x, this.y);
        if (n4 == 0)
          return t4.ub(h3, i4);
        var r3 = new t4();
        return r3.N(s4), r3.sub(i4), h3.sub(i4), h3.yi(r3) / n4;
      }, t4.Wq = function(t5, i4, s4) {
        var n4 = new $2.Xb();
        n4.set(i4.x), n4.sub(t5.x);
        var h3 = new $2.Xb();
        h3.set(s4.y), h3.sub(t5.y);
        var r3 = new $2.Xb();
        r3.set(i4.y), r3.sub(t5.y);
        var e3 = new $2.Xb();
        return e3.set(s4.x), e3.sub(t5.x), n4.Bg(h3), r3.Bg(e3), n4.sub(r3), n4.rs() ? (n4 = new $2.jp(i4.x), h3 = new $2.jp(t5.x), r3 = new $2.jp(t5.y), n4 = n4.kt(h3), t5 = (t5 = new $2.jp(s4.y)).kt(r3), i4 = (i4 = new $2.jp(i4.y)).kt(r3), s4 = (s4 = new $2.jp(s4.x)).kt(h3), n4 = n4.nr(t5), i4 = i4.nr(s4), (n4 = n4.nr(i4)).iT() ? -1 : n4.aS() ? 1 : 0) : 0 > (s4 = n4.value()) ? -1 : 0 < s4 ? 1 : 0;
      }, t4.prototype.dc = function() {
        return $2.P.wj($2.P.wj());
      }, t4;
    }(), $2.h = Z2, function(t4) {
      var i4 = function() {
        function t5(t6) {
          this.Ay = this.Ot = 0, this.KX = t6;
        }
        return t5.prototype.reset = function() {
          this.Ay = this.Ot = 0;
        }, t5.prototype.add = function(t6) {
          t6 -= this.Ay;
          var i5 = this.Ot + t6;
          this.Ay = i5 - this.Ot - t6, this.Ot = i5;
        }, t5.prototype.sub = function(t6) {
          this.add(-t6);
        }, t5.prototype.tm = function() {
          return this.KX + this.Ot;
        }, t5;
      }();
      t4.Ex = i4, t4.mc = function() {
        function t5() {
        }
        return t5.En = function(t6, i5) {
          return 0 <= i5 ? Math.abs(t6) : -Math.abs(t6);
        }, t5.sign = function(t6) {
          return 0 > t6 ? -1 : 0 < t6 ? 1 : 0;
        }, t5.MK = function(t6) {
          return t6 - 360 * Math.floor(t6 / 360);
        }, t5.round = function(t6) {
          return Math.floor(t6 + 0.5);
        }, t5.ox = function(t6) {
          return t6 * t6;
        }, t5.jq = function(t6, i5, s4) {
          return 0.5 >= s4 ? t6 + (i5 - t6) * s4 : i5 - (i5 - t6) * (1 - s4);
        }, t5.JG = function(t6, i5, s4, n4) {
          0.5 >= s4 ? (n4.x = t6.x + (i5.x - t6.x) * s4, n4.y = t6.y + (i5.y - t6.y) * s4) : (n4.x = i5.x - (i5.x - t6.x) * (1 - s4), n4.y = i5.y - (i5.y - t6.y) * (1 - s4));
        }, t5.gT = function(t6, i5, s4, n4, h3, r3) {
          0.5 >= h3 ? (r3.x = t6 + (s4 - t6) * h3, r3.y = i5 + (n4 - i5) * h3) : (r3.x = s4 - (s4 - t6) * (1 - h3), r3.y = n4 - (n4 - i5) * (1 - h3));
        }, t5;
      }();
    }(Q2 || (Q2 = {})), function(t4) {
      var i4 = function(i5) {
        function s4() {
          var t5 = i5.call(this) || this;
          return t5.ta = 0, t5.oa = 0, t5.qa = 0, t5.ma = 0, t5.la = null, t5;
        }
        return _2(s4, i5), s4.prototype.bc = function() {
          return t4.h.construct(this.ta, this.oa);
        }, s4.prototype.$p = function(t5) {
          t5.x = this.ta, t5.y = this.oa;
        }, s4.prototype.Ec = function(t5) {
          this.gm(0, t5);
        }, s4.prototype.UB = function(i6, s5) {
          this.gm(0, t4.h.construct(i6, s5));
        }, s4.prototype.Vo = function(t5) {
          this.cD(0, t5);
        }, s4.prototype.setStart = function(t5) {
          this.pD(0, t5);
        }, s4.prototype.yv = function(t5, i6) {
          return this.Pd(0, t5, i6);
        }, s4.prototype.TB = function(t5, i6, s5) {
          this.vn(0, t5, i6, s5);
        }, s4.prototype.xc = function() {
          return t4.h.construct(this.qa, this.ma);
        }, s4.prototype.Vr = function(t5) {
          t5.x = this.qa, t5.y = this.ma;
        }, s4.prototype.Rc = function(t5) {
          this.gm(1, t5);
        }, s4.prototype.Sl = function(i6, s5) {
          this.gm(1, t4.h.construct(i6, s5));
        }, s4.prototype.Ro = function(t5) {
          this.cD(1, t5);
        }, s4.prototype.setEnd = function(t5) {
          this.pD(1, t5);
        }, s4.prototype.jv = function(t5, i6) {
          return this.Pd(1, t5, i6);
        }, s4.prototype.JB = function(t5, i6, s5) {
          this.vn(1, t5, i6, s5);
        }, s4.prototype.Eb = function() {
          return 1;
        }, s4.prototype.B = function() {
          return this.Bc();
        }, s4.prototype.Pa = function() {
        }, s4.prototype.He = function() {
          return 0;
        }, s4.prototype.Fa = function(t5, i6, s5, n4, h3) {
          return this.FM(t5, i6, s5, n4, h3);
        }, s4.prototype.isIntersecting = function(t5, i6) {
          return this.Br(t5, i6, false) != 0;
        }, s4.prototype.ss = function(t5, i6) {
          return this.tu(t5, i6, false);
        }, s4.prototype.tu = function() {
          return null;
        }, s4.prototype.Bc = function() {
          return false;
        }, s4.prototype.$x = function(i6) {
          if (this.wc(), this.la == null && 0 < i6)
            this.la = t4.P.mg(2 * i6);
          else if (this.la != null && this.la.length < 2 * i6) {
            for (var s5 = this.la.slice(0), n4 = this.la.length; n4 < 2 * i6; n4++)
              s5[n4] = 0;
            this.la = s5;
          }
        }, s4.bM = function(t5, i6, s5) {
          if (0 < s5)
            var n4 = 0;
          for (var h3 = 0; h3 < s5; h3++)
            i6[0 + n4] = t5[0], n4++;
        }, s4.prototype.gm = function(t5, i6) {
          t5 != 0 ? (this.qa = i6.x, this.ma = i6.y) : (this.ta = i6.x, this.oa = i6.y);
        }, s4.prototype.un = function(i6) {
          if (this.la != null) {
            for (var n4 = t4.fe.Kw(i6, this.description), h3 = [], r3 = s4.Ig(this.description, 0), e3 = s4.Ig(this.description, 1), o3 = s4.Ig(i6, 0), a3 = s4.Ig(i6, 1), u3 = 0, f3 = 1, c3 = i6.Ba; f3 < c3; f3++) {
              var l3 = i6.ld(f3), p3 = t4.sa.Wa(l3);
              if (n4[f3] == -1) {
                var v3 = t4.sa.te(l3);
                for (l3 = 0; l3 < p3; l3++)
                  h3[o3 + u3] = v3, h3[a3 + u3] = v3, u3++;
              } else
                for (v3 = this.description.bk(n4[f3]) - 2, l3 = 0; l3 < p3; l3++)
                  h3[o3 + u3] = this.la[r3 + v3], h3[a3 + u3] = this.la[e3 + v3], u3++, v3++;
            }
            this.la = h3;
          }
          this.description = i6;
        }, s4.prototype.cD = function(i6, s5) {
          if (this.Bc())
            throw t4.i.ga("empty geometry");
          s5.Pf(this.description), s5.Bc() && s5.wn();
          for (var n4 = 0; n4 < this.description.Ba; n4++)
            for (var h3 = this.description.Fd(n4), r3 = 0, e3 = t4.sa.Wa(h3); r3 < e3; r3++) {
              var o3 = this.Pd(i6, h3, r3);
              s5.setAttribute(h3, r3, o3);
            }
        }, s4.prototype.pD = function(i6, s5) {
          if (this.wc(), s5.Bc())
            throw t4.i.ga("empty geometry");
          for (var n4 = s5.description, h3 = 0, r3 = n4.Ba; h3 < r3; h3++)
            for (var e3 = n4.Fd(h3), o3 = t4.sa.Wa(e3), a3 = 0; a3 < o3; a3++) {
              var u3 = s5.Vc(e3, a3);
              this.vn(i6, e3, a3, u3);
            }
        }, s4.prototype.Pd = function(i6, n4, h3) {
          if (this.Bc())
            throw t4.i.ga("This operation was performed on an Empty Geometry.");
          if (n4 == 0)
            return i6 != 0 ? h3 != 0 ? this.ma : this.qa : h3 != 0 ? this.oa : this.ta;
          if (h3 >= t4.sa.Wa(n4))
            throw t4.i.de();
          var r3 = this.description.Rf(n4);
          return 0 <= r3 ? (this.la != null && this.$x(this.description.Be.length - 2), this.la[s4.Ig(this.description, i6) + this.description.bk(r3) - 2 + h3]) : t4.sa.te(n4);
        }, s4.prototype.vn = function(i6, n4, h3, r3) {
          if (this.wc(), h3 >= t4.sa.Wa(n4))
            throw t4.i.de();
          var e3 = this.description.Rf(n4);
          0 > e3 && (this.se(n4), e3 = this.description.Rf(n4)), n4 == 0 ? i6 != 0 ? h3 != 0 ? this.ma = r3 : this.qa = r3 : h3 != 0 ? this.oa = r3 : this.ta = r3 : (this.la == null && this.$x(this.description.Be.length - 2), this.la[s4.Ig(this.description, i6) + this.description.bk(e3) - 2 + h3] = r3);
        }, s4.prototype.copyTo = function(i6) {
          if (i6.K() != this.K())
            throw t4.i.O();
          i6.description = this.description, i6.$x(this.description.Be.length - 2), s4.bM(this.la, i6.la, 2 * (this.description.Be.length - 2)), i6.ta = this.ta, i6.oa = this.oa, i6.qa = this.qa, i6.ma = this.ma, i6.wc(), this.qp(i6);
        }, s4.prototype.Vg = function(i6, s5) {
          var n4 = new t4.Oc();
          return this.Bc() ? (n4.Pa(), n4) : (n4.pa = this.Pd(0, i6, s5), n4.wa = n4.pa, n4.Nk(this.Pd(1, i6, s5)), n4);
        }, s4.prototype.UI = function(t5) {
          this.Bc() ? t5.Pa() : (t5.pa = this.Pd(0, 0, 0), t5.wa = t5.pa, t5.Nk(this.Pd(1, 0, 0)));
        }, s4.prototype.Vw = function(i6, s5) {
          s5.Pf(this.description), s5.Db(this.ic(i6));
          for (var n4 = 1, h3 = this.description.Ba; n4 < h3; n4++)
            for (var r3 = this.description.Fd(n4), e3 = t4.sa.Wa(r3), o3 = 0; o3 < e3; o3++) {
              var a3 = this.Vc(i6, r3, o3);
              s5.setAttribute(r3, o3, a3);
            }
        }, s4.prototype.AM = function(t5) {
          if (this.description != t5.description || this.ta != t5.ta || this.qa != t5.qa || this.oa != t5.oa || this.ma != t5.ma)
            return false;
          for (var i6 = 0; i6 < 2 * (this.description.Be.length - 2); i6++)
            if (this.la[i6] != t5.la[i6])
              return false;
          return true;
        }, s4.prototype.wG = function() {
          return this.ta == this.qa && this.oa == this.ma;
        }, s4.prototype.reverse = function() {
          var i6 = this.ta;
          this.ta = this.qa, this.qa = i6, i6 = this.oa, this.oa = this.ma, this.ma = i6, i6 = 1;
          for (var s5 = this.description.Ba; i6 < s5; i6++)
            for (var n4 = this.description.ld(i6), h3 = 0, r3 = t4.sa.Wa(n4); h3 < r3; h3++) {
              var e3 = this.Pd(0, n4, h3), o3 = this.Pd(1, n4, h3);
              this.vn(0, n4, h3, o3), this.vn(1, n4, h3, e3);
            }
        }, s4.prototype.Br = function(i6, s5, n4) {
          var h3 = i6.K();
          if (this.K() === 322) {
            if (h3 == 322)
              return t4.zb.JM(this, i6, s5, n4);
            throw t4.i.Ra();
          }
          throw t4.i.Ra();
        }, s4.prototype.FM = function(i6, s5, n4, h3, r3) {
          var e3 = i6.K();
          if (this.K() === 322) {
            if (e3 == 322)
              return t4.zb.Yx(this, i6, s5, n4, h3, r3);
            throw t4.i.Ra();
          }
          throw t4.i.Ra();
        }, s4.prototype.Sx = function() {
          return null;
        }, s4.Ig = function(t5, i6) {
          return i6 * (t5.Be.length - 2);
        }, s4.prototype.ic = function(i6, s5) {
          if (s5 === void 0)
            return s5 = new t4.h(), this.ic(i6, s5), s5;
          t4.mc.gT(this.ta, this.oa, this.qa, this.ma, i6, s5);
        }, s4.prototype.ge = function() {
          return null;
        }, s4.prototype.$F = function() {
          return null;
        }, s4.prototype.fq = function() {
          return null;
        }, s4.prototype.Di = function() {
          return null;
        }, s4.prototype.Rn = function() {
          return null;
        }, s4.prototype.lg = function() {
          return null;
        }, s4.prototype.Tx = function(t5, i6) {
          return i6 !== void 0 ? this.ux(i6) - this.ux(t5) : this.ux(t5);
        }, s4.prototype.qp = function() {
        }, s4.prototype.fl = function() {
          return null;
        }, s4.prototype.dh = function() {
        }, s4.prototype.Vc = function() {
          return null;
        }, s4.prototype.Me = function() {
          return null;
        }, s4.prototype.ux = function() {
          return null;
        }, s4.prototype.IG = function() {
          return null;
        }, s4.prototype.ub = function(t5, i6) {
          if (!i6 && this.Br(t5, 0, false) != 0)
            return 0;
          i6 = 17976931348623157e292;
          var s5 = this.bc(), n4 = t5.ge(s5, false);
          return s5.sub(t5.ic(n4)), (s5 = s5.length()) < i6 && (i6 = s5), s5 = this.xc(), n4 = t5.ge(s5, false), s5.sub(t5.ic(n4)), (s5 = s5.length()) < i6 && (i6 = s5), s5 = t5.bc(), n4 = this.ge(s5, false), s5.sub(this.ic(n4)), (s5 = s5.length()) < i6 && (i6 = s5), s5 = t5.xc(), n4 = this.ge(s5, false), s5.sub(this.ic(n4)), (s5 = s5.length()) < i6 && (i6 = s5), i6;
        }, s4.prototype.ng = function() {
          return t4.si.im(this, null);
        }, s4;
      }(t4.ba);
      t4.NC = i4;
    }(Q2 || (Q2 = {})), new Q2.h(), function(t4) {
      var i4;
      (i4 = t4.VK || (t4.VK = {}))[i4.Unknown = -1] = "Unknown", i4[i4.Not = 0] = "Not", i4[i4.Weak = 1] = "Weak", i4[i4.Strong = 2] = "Strong", function(t5) {
        t5[t5.DirtyIsKnownSimple = 1] = "DirtyIsKnownSimple", t5[t5.IsWeakSimple = 2] = "IsWeakSimple", t5[t5.IsStrongSimple = 4] = "IsStrongSimple", t5[t5.DirtyOGCFlags = 8] = "DirtyOGCFlags", t5[t5.DirtyVerifiedStreams = 32] = "DirtyVerifiedStreams", t5[t5.DirtyExactIntervals = 64] = "DirtyExactIntervals", t5[t5.DirtyLooseIntervals = 128] = "DirtyLooseIntervals", t5[t5.DirtyIntervals = 192] = "DirtyIntervals", t5[t5.DirtyIsEnvelope = 256] = "DirtyIsEnvelope", t5[t5.DirtyLength2D = 512] = "DirtyLength2D", t5[t5.DirtyRingAreas2D = 1024] = "DirtyRingAreas2D", t5[t5.DirtyCoordinates = 1993] = "DirtyCoordinates", t5[t5.DirtyAllInternal = 65535] = "DirtyAllInternal", t5[t5.DirtyAll = 16777215] = "DirtyAll";
      }(t4.HK || (t4.HK = {}));
      var s4 = function(i5) {
        function s5() {
          var t5 = i5.call(this) || this;
          return t5.Jm = 65535, t5.xa = 0, t5.Rg = -1, t5.Cb = null, t5;
        }
        return _2(s5, i5), s5.prototype.qp = function() {
        }, s5.prototype.Zx = function() {
        }, s5.prototype.ey = function() {
        }, s5.prototype.I = function() {
          return this.xa;
        }, s5.prototype.B = function() {
          return this.Bc();
        }, s5.prototype.Bc = function() {
          return this.xa == 0;
        }, s5.prototype.ck = function(t5) {
          return (this.Jm & t5) != 0;
        }, s5.prototype.Nf = function(t5, i6) {
          this.Jm = i6 ? this.Jm | t5 : this.Jm & ~t5;
        }, s5.prototype.oc = function() {
          this.ck(32) && this.XM();
        }, s5.prototype.vx = function() {
          if (this.Bc())
            throw t4.i.ga("This operation was performed on an Empty Geometry.");
        }, s5.prototype.we = function(i6, s6) {
          if (0 > i6 || i6 >= this.xa)
            throw t4.i.ga("index out of bounds");
          this.oc(), s6.Pf(this.description), s6.B() && s6.wn();
          for (var n4 = 0; n4 < this.description.Ba; n4++)
            for (var h3 = this.description.Fd(n4), r3 = 0, e3 = t4.sa.Wa(h3); r3 < e3; r3++) {
              var o3 = this.Aa[n4].gg(e3 * i6 + r3);
              s6.setAttribute(h3, r3, o3);
            }
        }, s5.prototype.It = function(i6, s6) {
          this.oc();
          for (var n4 = s6.description, h3 = 0; h3 < n4.Ba; h3++)
            for (var r3 = n4.Fd(h3), e3 = t4.sa.Wa(r3), o3 = 0; o3 < e3; o3++) {
              var a3 = s6.Vc(r3, o3);
              this.setAttribute(r3, i6, o3, a3);
            }
        }, s5.prototype.D = function(i6, s6) {
          if (0 > i6 || i6 >= this.I())
            throw t4.i.de();
          this.oc(), this.Aa[0].uc(2 * i6, s6);
        }, s5.prototype.Oa = function(i6) {
          var s6 = new t4.h();
          return this.D(i6, s6), s6;
        }, s5.prototype.Hc = function(t5, i6) {
          this.Aa[0].uc(2 * t5, i6);
        }, s5.prototype.Db = function(i6, s6, n4) {
          if (0 > i6 || i6 >= this.xa)
            throw t4.i.de();
          this.oc();
          var h3 = this.Aa[0];
          n4 !== void 0 ? (h3.write(2 * i6, s6), h3.write(2 * i6 + 1, n4)) : h3.Vt(2 * i6, s6), this.Qc(1993);
        }, s5.prototype.xz = function() {
          if (void 0 >= this.I())
            throw t4.i.de();
          this.oc();
          var i6 = this.Aa[0], s6 = new t4.Od();
          return s6.x = i6.read(NaN), s6.y = i6.read(NaN), s6.z = this.hasAttribute(1) ? this.Aa[1].gg(void 0) : t4.sa.te(1), s6;
        }, s5.prototype.ZB = function(i6) {
          if (0 > i6 || i6 >= this.I())
            throw t4.i.de();
          this.se(1), this.oc(), this.Qc(1993);
          var s6 = this.Aa[0];
          s6.write(2 * i6, (void 0).x), s6.write(2 * i6 + 1, (void 0).y), this.Aa[1].rr(i6, (void 0).z);
        }, s5.prototype.Vc = function(i6, s6, n4) {
          if (0 > s6 || s6 >= this.xa)
            throw t4.i.de();
          var h3 = t4.sa.Wa(i6);
          if (n4 >= h3)
            throw t4.i.de();
          this.oc();
          var r3 = this.description.Rf(i6);
          return 0 <= r3 ? this.Aa[r3].gg(s6 * h3 + n4) : t4.sa.te(i6);
        }, s5.prototype.tF = function(t5, i6) {
          return this.Vc(t5, i6, void 0);
        }, s5.prototype.setAttribute = function(i6, s6, n4, h3) {
          if (0 > s6 || s6 >= this.xa)
            throw t4.i.de();
          var r3 = t4.sa.Wa(i6);
          if (n4 >= r3)
            throw t4.i.de();
          this.se(i6), this.oc(), i6 = this.description.Rf(i6), this.Qc(1993), this.Aa[i6].rr(s6 * r3 + n4, h3);
        }, s5.prototype.vb = function(t5) {
          return this.vx(), this.se(t5), this.oc(), this.Aa[this.description.Rf(t5)];
        }, s5.prototype.kn = function(i6, s6) {
          if (s6 != null && t4.sa.Vp(i6) != s6.Vp())
            throw t4.i.O();
          this.se(i6), i6 = this.description.Rf(i6), this.Aa == null && (this.Aa = t4.Zc.lI(this.description.Ba)), this.Aa[i6] = s6, this.Qc(16777215);
        }, s5.prototype.un = function(i6) {
          var s6 = null;
          if (this.Aa != null) {
            var n4 = t4.fe.Kw(i6, this.description);
            s6 = [];
            for (var h3 = 0, r3 = i6.Ba; h3 < r3; h3++)
              n4[h3] != -1 && (s6[h3] = this.Aa[n4[h3]]);
          }
          this.description = i6, this.Aa = s6, this.Rg = -1, this.Qc(16777215);
        }, s5.prototype.vD = function(i6) {
          this.yu(true), i6 instanceof t4.l ? this.aa.A(i6) : this.aa.So(i6);
        }, s5.prototype.WM = function(i6) {
          this.yu(false), i6 instanceof t4.l ? this.aa.A(i6) : this.aa.So(i6);
        }, s5.prototype.dn = function(t5) {
          this.yu(true), this.aa.copyTo(t5);
        }, s5.prototype.A = function(t5) {
          this.vD(t5);
        }, s5.prototype.So = function(t5) {
          this.vD(t5);
        }, s5.prototype.yc = function(t5) {
          this.WM(t5);
        }, s5.prototype.Vg = function(i6, s6) {
          var n4 = new t4.Oc();
          return this.Bc() ? (n4.Pa(), n4) : (this.yu(true), this.aa.Vg(i6, s6));
        }, s5.prototype.dc = function() {
          var i6 = this.description.dc();
          if (!this.Bc())
            for (var s6 = this.I(), n4 = 0, h3 = this.description.Ba; n4 < h3; n4++)
              i6 = this.Aa[n4].Cn(i6, 0, s6 * t4.sa.Wa(this.description.Fd(n4)));
          return i6;
        }, s5.prototype.Nb = function(i6) {
          if (i6 == this)
            return true;
          if (!(i6 instanceof s5 && this.description.Nb(i6.description)) || this.Bc() != i6.Bc())
            return false;
          if (this.Bc())
            return true;
          var n4 = this.I();
          if (n4 != i6.I())
            return false;
          for (var h3 = 0; h3 < this.description.Ba; h3++) {
            var r3 = this.description.ld(h3), e3 = this.vb(r3), o3 = i6.vb(r3);
            if (!e3.Nb(o3, 0, n4 * t4.sa.Wa(r3)))
              return false;
          }
          return true;
        }, s5.prototype.copyTo = function(i6) {
          if (i6.K() != this.K())
            throw t4.i.O();
          this.ZC(i6);
        }, s5.prototype.ZC = function(i6) {
          this.oc(), i6.description = this.description, i6.Aa = null;
          var s6 = this.description.Ba, n4 = null;
          if (this.Aa != null) {
            n4 = [];
            for (var h3 = 0; h3 < s6; h3++)
              this.Aa[h3] != null && (n4[h3] = this.Aa[h3].BB(this.I() * t4.sa.Wa(this.description.Fd(h3))));
          }
          this.aa != null ? (i6.aa = this.aa.Ja(), this.aa.copyTo(i6.aa)) : i6.aa = null, i6.xa = this.xa, i6.Jm = this.Jm, i6.Aa = n4;
          try {
            this.qp(i6);
          } catch (r3) {
            throw i6.Pa(), t4.i.hu();
          }
        }, s5.prototype.rD = function() {
          this.xa = 0, this.Rg = -1, this.Aa = null, this.Qc(16777215);
        }, s5.prototype.Qc = function(t5) {
          t5 == 16777215 && (this.Rg = -1, this.Zx()), this.Jm |= t5, this.gM(), this.wc();
        }, s5.prototype.yu = function(i6) {
          if (this.oc(), this.ck(192))
            if (this.aa == null ? this.aa = new t4.Hh(this.description) : this.aa.Pf(this.description), this.B())
              this.aa.Pa();
            else {
              this.dy(i6);
              for (var s6 = 1; s6 < this.description.Ba; s6++)
                for (var n4 = this.description.Fd(s6), h3 = t4.sa.Wa(n4), r3 = this.Aa[s6], e3 = 0; e3 < h3; e3++) {
                  var o3 = new t4.Oc();
                  o3.Pa();
                  for (var a3 = 0; a3 < this.xa; a3++) {
                    var u3 = r3.gg(a3 * h3 + e3);
                    o3.$b(u3);
                  }
                  this.aa.setInterval(n4, e3, o3);
                }
              i6 && this.Nf(192, false);
            }
        }, s5.prototype.dy = function() {
          this.aa.Pa();
          for (var i6 = this.Aa[0], s6 = new t4.h(), n4 = 0; n4 < this.xa; n4++)
            i6.uc(2 * n4, s6), this.aa.$b(s6);
        }, s5.prototype.Ap = function(i6) {
          i6.Pa();
          for (var s6 = this.Aa[0], n4 = new t4.h(), h3 = 0; h3 < this.xa; h3++)
            s6.uc(2 * h3, n4), i6.$b(n4);
        }, s5.prototype.XM = function() {
          if (this.Rg < this.xa) {
            this.Aa == null && (this.Aa = t4.Zc.lI(this.description.Ba)), this.Rg = 2147483647;
            for (var i6 = 0; i6 < this.description.Ba; i6++) {
              var s6 = this.description.Fd(i6);
              if (this.Aa[i6] != null) {
                var n4 = t4.sa.Wa(s6), h3 = t4.P.truncate(this.Aa[i6].size / n4);
                h3 < this.xa && (h3 = t4.P.truncate(this.Rg > this.xa + 5 ? (5 * this.xa + 3) / 4 : this.xa), this.Aa[i6].resize(h3 * n4, t4.sa.te(s6))), h3 < this.Rg && (this.Rg = h3);
              } else
                this.Aa[i6] = t4.Zc.TE(s6, this.xa), this.Rg = this.xa;
            }
          }
          this.ey(), this.Nf(32, false);
        }, s5.prototype.fm = function(i6) {
          if (0 > i6)
            throw t4.i.O();
          i6 != this.xa && (this.xa = i6, this.Qc(65535));
        }, s5.prototype.qm = function(t5) {
          if (!this.ck(1)) {
            if (!this.ck(2))
              return 0;
            if (this.LT >= t5)
              return this.ck(8) ? 1 : 2;
          }
          return -1;
        }, s5.prototype.Eh = function(i6, s6) {
          if (this.LT = s6, i6 == -1)
            this.Nf(1, true), this.Nf(8, true);
          else if (this.Nf(1, false), this.Nf(8, true), i6 == 0)
            this.Nf(2, false), this.Nf(4, false);
          else if (i6 == 1)
            this.Nf(2, true), this.Nf(4, false);
          else {
            if (i6 != 2)
              throw t4.i.ga("internal error.");
            this.Nf(2, true), this.Nf(4, true);
          }
        }, s5.prototype.gM = function() {
          this.Cb != null && (this.Cb = null);
        }, s5.prototype.fD = function(i6, s6, n4, h3) {
          if (0 > i6 || i6 >= this.xa)
            throw t4.i.ga("index out of bounds");
          if (0 > s6 || s6 >= this.xa)
            throw t4.i.ga("index out of bounds");
          this.oc(), h3.Pf(this.description), h3.B() && h3.wn();
          for (var r3 = 0; r3 < this.description.Ba; r3++)
            for (var e3 = this.description.Fd(r3), o3 = 0, a3 = t4.sa.Wa(e3); o3 < a3; o3++) {
              var u3 = this.Aa[r3].gg(a3 * i6 + o3), f3 = this.Aa[r3].gg(a3 * s6 + o3);
              h3.setAttribute(e3, o3, t4.mc.jq(u3, f3, n4));
            }
        }, s5.prototype.Ar = function(t5, i6) {
          var s6 = this.Aa[0].o, n4 = s6[2 * t5] - s6[2 * i6];
          return t5 = s6[2 * t5 + 1] - s6[2 * i6 + 1], Math.sqrt(n4 * n4 + t5 * t5);
        }, s5.prototype.FR = function(i6) {
          if (0 > i6 || i6 >= this.xa)
            throw t4.i.de();
          this.oc();
          var s6 = new t4.Ta();
          s6.Pf(this.description), s6.B() && s6.wn();
          for (var n4 = 0; n4 < this.description.Ba; n4++)
            for (var h3 = this.description.ld(n4), r3 = 0, e3 = t4.sa.Wa(h3); r3 < e3; r3++) {
              var o3 = this.Aa[n4].gg(e3 * i6 + r3);
              s6.setAttribute(h3, r3, o3);
            }
          return s6;
        }, s5.prototype.Fh = function(i6, s6) {
          if (0 > i6 || i6 >= this.xa)
            throw t4.i.de();
          if (s6.B())
            throw t4.i.O();
          this.oc();
          for (var n4 = s6.description, h3 = 0; h3 < n4.Ba; h3++)
            for (var r3 = n4.ld(h3), e3 = t4.sa.Wa(r3), o3 = 0; o3 < e3; o3++) {
              var a3 = s6.Vc(r3, o3);
              this.setAttribute(r3, i6, o3, a3);
            }
        }, s5.prototype.nu = function() {
          return null;
        }, s5.prototype.hj = function() {
          return null;
        }, s5;
      }(t4.ba);
      t4.Fx = s4;
    }(Q2 || (Q2 = {})), function(t4) {
      var i4 = function() {
        function i5() {
          this.ob = this.ao = null, this.Vm = 124234251, this.Tv = true, this.Ne = -1, this.ob = new t4.ad(7), this.ao = null;
        }
        return i5.prototype.Xo = function(t5) {
          this.ao = t5;
        }, i5.prototype.MP = function() {
          this.Tv = false;
        }, i5.prototype.Ee = function(t5) {
          this.ob.Ee(t5);
        }, i5.prototype.Rr = function(t5) {
          var i6 = this.ob.De();
          return this.nX(i6), this.qX(t5, i6), i6;
        }, i5.prototype.HP = function(t5) {
          this.ob.kd(t5);
        }, i5.prototype.addElement = function(t5, i6) {
          return i6 == -1 && (this.Ne == -1 && (this.Ne = this.Rr(-1)), i6 = this.Ne), this.AD(t5, 0, i6);
        }, i5.prototype.ED = function(t5) {
          return this.Ne == -1 && (this.Ne = this.Rr(-1)), this.AD(t5, 1, this.Ne);
        }, i5.prototype.zn = function(t5) {
          this.Ne == -1 && (this.Ne = this.Rr(-1));
          var i6 = this.Ne, s4 = this.ob.o;
          if (i6 == -1 || s4[7 * i6] == -1)
            return t5 = this.ob.Nl([-1, -1, -1, t5, this.il(), -1, -1]), (s4 = this.ob.o)[7 * i6] = t5, this.xp(-1, t5, i6, s4), t5;
          var n4 = i6 == -1 ? -1 : s4[7 * i6 + 2];
          return t5 = this.ob.Nl([-1, -1, n4, t5, this.il(), -1, -1]), (s4 = this.ob.o)[7 * n4 + 1] = t5, this.ky(t5, s4), s4[7 * t5 + 2] === -1 && (s4[7 * i6] = t5), this.xp(-1, t5, i6, s4), t5;
        }, i5.prototype.Bu = function(i6, s4, n4, h3) {
          var r3 = -1;
          r3 == -1 && (this.Ne == -1 && (this.Ne = this.Rr(-1)), r3 = this.Ne);
          var e3 = this.ob.o;
          if (r3 == -1 || e3[7 * r3] == -1)
            return n4 = this.ob.Nl([-1, -1, -1, n4, this.il(), -1, -1]), (e3 = this.ob.o)[7 * r3] = n4, this.xp(-1, n4, r3, e3), n4;
          if (h3) {
            h3 = s4 != -1 ? this.ao.compare(this, n4, s4) : -1;
            var o3 = i6 != -1 ? this.ao.compare(this, n4, i6) : 1;
          } else
            h3 = -1, o3 = 1;
          if (h3 == 0 || o3 == 0)
            return e3[7 * r3 + 3] = h3 == 0 ? s4 : i6, -1;
          for ((s4 != -1 && i6 != -1 ? this.Vm > t4.P.XA(this.Vm) >> 1 : s4 != -1) ? i6 = s4 : h3 = o3, s4 = true; ; ) {
            if (0 > h3) {
              if ((o3 = e3[7 * i6]) == -1) {
                h3 = i6, n4 = this.ob.Nl([-1, -1, i6, n4, this.il(), -1, -1]), (e3 = this.ob.o)[7 * i6] = n4;
                break;
              }
              i6 = o3;
            } else {
              if ((o3 = e3[7 * i6 + 1]) == -1) {
                h3 = e3[7 * i6 + 6], n4 = this.ob.Nl([-1, -1, i6, n4, this.il(), -1, -1]), (e3 = this.ob.o)[7 * i6 + 1] = n4;
                break;
              }
              i6 = o3;
            }
            s4 && (h3 *= -1, s4 = false);
          }
          return this.ky(n4, e3), e3[7 * n4 + 2] === -1 && (e3[7 * r3] = n4), this.xp(h3, n4, r3, e3), n4;
        }, i5.prototype.AF = function() {
          return this.dR(this.Ne);
        }, i5.prototype.wd = function(t5, i6) {
          i6 = i6 == -1 ? this.Ne : i6, this.Tv ? this.GP(t5, i6) : this.eY(t5, i6);
        }, i5.prototype.search = function(t5, i6) {
          for (i6 = this.uv(i6); i6 != -1; ) {
            var s4 = this.ao.compare(this, t5, i6);
            if (s4 == 0)
              return i6;
            i6 = 0 > s4 ? this.nl(i6) : this.Zp(i6);
          }
          return -1;
        }, i5.prototype.DW = function(t5) {
          for (var i6 = this.uv(-1), s4 = -1; i6 != -1; ) {
            var n4 = t5.compare(this, i6);
            if (n4 == 0)
              return i6;
            0 > n4 ? i6 = this.nl(i6) : (s4 = i6, i6 = this.Zp(i6));
          }
          return s4;
        }, i5.prototype.pJ = function(t5) {
          for (var i6 = this.uv(-1), s4 = -1; i6 != -1; ) {
            var n4 = t5.compare(this, i6);
            if (n4 == 0)
              return i6;
            0 > n4 ? (s4 = i6, i6 = this.nl(i6)) : i6 = this.Zp(i6);
          }
          return s4;
        }, i5.prototype.ka = function(t5) {
          return this.ob.U(t5, 3);
        }, i5.prototype.nl = function(t5) {
          return this.ob.U(t5, 0);
        }, i5.prototype.Zp = function(t5) {
          return this.ob.U(t5, 1);
        }, i5.prototype.getParent = function(t5) {
          return this.ob.U(t5, 2);
        }, i5.prototype.lb = function(t5) {
          return this.ob.U(t5, 6);
        }, i5.prototype.xe = function(t5) {
          return this.ob.U(t5, 5);
        }, i5.prototype.sc = function(t5) {
          return t5 == -1 ? this.ml(this.Ne) : this.ml(t5);
        }, i5.prototype.Gc = function(t5) {
          return t5 == -1 ? this.bs(this.Ne) : this.bs(t5);
        }, i5.prototype.UR = function(t5) {
          return t5 == -1 ? this.XF(this.Ne) : this.XF(t5);
        }, i5.prototype.Uj = function(t5, i6) {
          this.IB(t5, i6);
        }, i5.prototype.uv = function(t5) {
          return t5 == -1 ? this.TF(this.Ne) : this.TF(t5);
        }, i5.prototype.clear = function() {
          this.ob.oj(false), this.Ne = -1;
        }, i5.prototype.size = function(t5) {
          return t5 == -1 ? this.VF(this.Ne) : this.VF(t5);
        }, i5.prototype.FN = function(t5, i6) {
          for (var s4 = i6[7 * t5], n4 = i6[7 * t5 + 1], h3 = i6[7 * t5 + 4]; s4 != -1 || n4 != -1; ) {
            var r3 = s4 != -1 ? i6[7 * s4 + 4] : 2147483647;
            if (n4 = n4 != -1 ? i6[7 * n4 + 4] : 2147483647, h3 <= Math.min(r3, n4))
              break;
            r3 <= n4 ? this.nJ(s4, i6) : this.mJ(t5, i6), s4 = i6[7 * t5], n4 = i6[7 * t5 + 1];
          }
        }, i5.prototype.ky = function(t5, i6) {
          if (this.Tv)
            for (var s4 = i6[7 * t5 + 4], n4 = i6[7 * t5 + 2]; n4 != -1 && i6[7 * n4 + 4] > s4; )
              i6[7 * n4] == t5 ? this.nJ(t5, i6) : this.mJ(n4, i6), n4 = i6[7 * t5 + 2];
        }, i5.prototype.mJ = function(t5, i6) {
          var s4 = i6[7 * t5 + 1];
          i6[7 * s4 + 2] = i6[7 * t5 + 2], i6[7 * t5 + 2] = s4;
          var n4 = i6[7 * s4];
          i6[7 * t5 + 1] = n4, n4 != -1 && (i6[7 * n4 + 2] = t5), i6[7 * s4] = t5, (n4 = i6[7 * s4 + 2]) != -1 && (i6[7 * n4] == t5 ? i6[7 * n4] = s4 : i6[7 * n4 + 1] = s4);
        }, i5.prototype.nJ = function(t5, i6) {
          var s4 = i6[7 * t5 + 2];
          i6[7 * t5 + 2] = i6[7 * s4 + 2], i6[7 * s4 + 2] = t5;
          var n4 = i6[7 * t5 + 1];
          i6[7 * s4] = n4, n4 != -1 && (i6[7 * n4 + 2] = s4), i6[7 * t5 + 1] = s4, (n4 = i6[7 * t5 + 2]) != -1 && (i6[7 * n4] === s4 ? i6[7 * n4] = t5 : i6[7 * n4 + 1] = t5);
        }, i5.prototype.Rk = function(t5, i6) {
          this.ob.T(t5, 2, i6);
        }, i5.prototype.OB = function(t5, i6) {
          this.ob.T(t5, 0, i6);
        }, i5.prototype.SB = function(t5, i6) {
          this.ob.T(t5, 1, i6);
        }, i5.prototype.RB = function(t5, i6) {
          this.ob.T(t5, 5, i6);
        }, i5.prototype.fx = function(t5, i6) {
          this.ob.T(t5, 6, i6);
        }, i5.prototype.SJ = function(t5, i6) {
          this.ob.T(i6, 0, t5);
        }, i5.prototype.nX = function(t5) {
          this.ob.T(t5, 4, 0);
        }, i5.prototype.qX = function(t5, i6) {
          this.ob.T(i6, 5, t5);
        }, i5.prototype.TF = function(t5) {
          return t5 == -1 ? -1 : this.ob.U(t5, 0);
        }, i5.prototype.ml = function(t5) {
          return t5 == -1 ? -1 : this.ob.U(t5, 1);
        }, i5.prototype.bs = function(t5) {
          return t5 == -1 ? -1 : this.ob.U(t5, 2);
        }, i5.prototype.dR = function(t5) {
          return t5 == -1 ? -1 : this.ob.U(t5, 3);
        }, i5.prototype.VF = function(t5) {
          return t5 == -1 ? 0 : this.ob.U(t5, 4);
        }, i5.prototype.XF = function(t5) {
          return this.ob.U(t5, 5);
        }, i5.prototype.Rw = function() {
          return this.ob.Nl([-1, -1, -1, void 0, this.il(), -1, -1]);
        }, i5.prototype.hl = function(t5) {
          t5 != -1 && this.ob.kd(t5);
        }, i5.prototype.il = function() {
          return this.Vm = t4.P.XA(this.Vm), 1073741823 & this.Vm;
        }, i5.prototype.AD = function(t5, i6, s4) {
          var n4 = this.ob.o;
          if (s4 == -1 || n4[7 * s4] == -1)
            return t5 = this.ob.Nl([-1, -1, -1, t5, this.il(), -1, -1]), (n4 = this.ob.o)[7 * s4] = t5, this.xp(-1, t5, s4, n4), t5;
          for (var h3 = s4 == -1 ? -1 : n4[7 * s4]; ; ) {
            var r3 = i6 == -1 ? 1 : this.ao.compare(this, t5, h3);
            if (0 > r3) {
              if ((r3 = this.nl(h3)) == -1) {
                i6 = h3, t5 = this.ob.Nl([-1, -1, h3, t5, this.il(), -1, -1]), (n4 = this.ob.o)[7 * h3] = t5;
                break;
              }
              h3 = r3;
            } else {
              if (i6 == 1 && r3 == 0)
                return n4[7 * s4 + 3] = h3, -1;
              if ((r3 = n4[7 * h3 + 1]) == -1) {
                i6 = n4[7 * h3 + 6], t5 = this.ob.Nl([-1, -1, h3, t5, this.il(), -1, -1]), (n4 = this.ob.o)[7 * h3 + 1] = t5;
                break;
              }
              h3 = r3;
            }
          }
          return this.ky(t5, n4), n4[7 * t5 + 2] === -1 && (n4[7 * s4] = t5), this.xp(i6, t5, s4, n4), t5;
        }, i5.prototype.xp = function(t5, i6, s4, n4) {
          if (t5 != -1) {
            var h3 = n4[7 * t5 + 5];
            n4[7 * t5 + 5] = i6;
          } else
            h3 = s4 == -1 ? -1 : n4[7 * s4 + 2];
          n4[7 * i6 + 5] = h3, h3 != -1 && (n4[7 * h3 + 6] = i6), n4[7 * i6 + 6] = t5, t5 == (s4 == -1 ? -1 : n4[7 * s4 + 1]) && (n4[7 * s4 + 1] = i6), t5 == -1 && (n4[7 * s4 + 2] = i6), n4[7 * s4 + 4] = (s4 == -1 ? 0 : n4[7 * s4 + 4]) + 1;
        }, i5.prototype.vB = function(t5, i6) {
          var s4 = this.ob.o, n4 = s4[7 * t5 + 5];
          t5 = s4[7 * t5 + 6], n4 != -1 ? s4[7 * n4 + 6] = t5 : s4[7 * i6 + 1] = t5, t5 != -1 ? s4[7 * t5 + 5] = n4 : s4[7 * i6 + 2] = n4, s4[7 * i6 + 4] = i6 === -1 ? -1 : s4[7 * i6 + 4] - 1;
        }, i5.prototype.eY = function(i6, s4) {
          this.vB(i6, s4);
          var n4 = this.nl(i6), h3 = this.Zp(i6), r3 = this.getParent(i6), e3 = i6;
          if (n4 != -1 && h3 != -1) {
            this.Vm = t4.P.XA(this.Vm);
            var o3 = 1073741823 < this.Vm ? this.lb(i6) : this.xe(i6), a3 = this.getParent(o3) == i6;
            this.ob.bC(i6, o3, 0), this.ob.bC(i6, o3, 1), this.ob.bC(i6, o3, 2), r3 != -1 ? this.nl(r3) == i6 ? this.OB(r3, o3) : this.SB(r3, o3) : this.SJ(o3, s4), a3 ? (n4 == o3 ? (this.OB(o3, i6), this.Rk(h3, o3)) : h3 == o3 && (this.SB(o3, i6), this.Rk(n4, o3)), this.Rk(i6, o3), r3 = o3) : (this.Rk(n4, o3), this.Rk(h3, o3), r3 = this.getParent(i6), e3 = o3), n4 = this.nl(i6), h3 = this.Zp(i6), n4 != -1 && this.Rk(n4, i6), h3 != -1 && this.Rk(h3, i6);
          }
          n4 = n4 != -1 ? n4 : h3, r3 == -1 ? this.SJ(n4, s4) : this.nl(r3) == e3 ? this.OB(r3, n4) : this.SB(r3, n4), n4 != -1 && this.Rk(n4, r3), this.hl(i6);
        }, i5.prototype.GP = function(t5, i6) {
          var s4 = this.ob.o;
          s4[7 * t5 + 4] = 2147483647;
          var n4 = -1, h3 = -1, r3 = i6 === -1 ? -1 : s4[7 * i6], e3 = r3 == t5;
          if (e3 && (n4 = s4[7 * r3], h3 = s4[7 * r3 + 1], n4 == -1 && h3 == -1))
            return this.vB(r3, i6), this.hl(r3), void (s4[7 * i6] = -1);
          this.FN(t5, s4), (r3 = s4[7 * t5 + 2]) != -1 && (s4[7 * r3] == t5 ? s4[7 * r3] = -1 : s4[7 * r3 + 1] = -1), this.vB(t5, i6), this.hl(t5), e3 && (s4[7 * i6] = n4 == -1 || s4[7 * n4 + 2] != -1 ? h3 : n4);
        }, i5.prototype.IB = function(t5, i6) {
          this.ob.T(t5, 3, i6);
        }, i5;
      }();
      t4.$j = i4;
    }(Q2 || (Q2 = {})), function(t4) {
      var i4 = function() {
        function i5(t5, i6) {
          t5 !== void 0 && this.L(t5, i6);
        }
        return i5.prototype.L = function(t5, i6) {
          this.pa = t5, this.wa = i6, this.normalize();
        }, i5.prototype.isIntersecting = function(t5) {
          return this.pa <= t5.pa ? this.wa >= t5.pa : t5.wa >= this.pa;
        }, i5.prototype.move = function(t5) {
          this.B() || (this.pa += t5, this.wa += t5);
        }, i5.prototype.normalize = function() {
          if (!isNaN(this.pa)) {
            if (this.pa > this.wa) {
              var t5 = this.pa;
              this.pa = this.wa, this.wa = t5;
            }
            isNaN(this.wa) && this.Pa();
          }
        }, i5.prototype.Pa = function() {
          this.wa = this.pa = NaN;
        }, i5.prototype.B = function() {
          return isNaN(this.pa);
        }, i5.prototype.$b = function(t5) {
          typeof t5 == "number" ? this.B() ? this.wa = this.pa = t5 : this.Nk(t5) : t5.B() || (this.B() ? (this.pa = t5.pa, this.wa = t5.wa) : (this.pa > t5.pa && (this.pa = t5.pa), this.wa < t5.wa && (this.wa = t5.wa), this.pa > this.wa && this.Pa()));
        }, i5.prototype.Nk = function(t5) {
          t5 < this.pa ? this.pa = t5 : t5 > this.wa && (this.wa = t5);
        }, i5.prototype.contains = function(t5) {
          return typeof t5 == "number" ? t5 >= this.pa && t5 <= this.wa : t5.pa >= this.pa && t5.wa <= this.wa;
        }, i5.prototype.Fa = function(t5) {
          this.B() || t5.B() ? this.Pa() : (this.pa < t5.pa && (this.pa = t5.pa), this.wa > t5.wa && (this.wa = t5.wa), this.pa > this.wa && this.Pa());
        }, i5.prototype.X = function(t5) {
          this.B() || (this.pa -= t5, this.wa += t5, this.wa < this.pa && this.Pa());
        }, i5.prototype.zr = function() {
          return this.B() ? 2220446049250313e-29 : 2220446049250313e-29 * (Math.abs(this.pa) + Math.abs(this.wa) + 1);
        }, i5.prototype.FB = function(t5, i6) {
          t5 > i6 ? (this.pa = i6, this.wa = t5) : (this.pa = t5, this.wa = i6);
        }, i5.prototype.Kt = function(i6) {
          return t4.P.Tk(i6, this.pa, this.wa);
        }, i5.prototype.S = function() {
          return this.wa - this.pa;
        }, i5.prototype.tf = function() {
          return 0.5 * (this.pa + this.wa);
        }, i5.prototype.Nb = function(t5) {
          return t5 == this || t5 instanceof i5 && (!(!this.B() || !t5.B()) || this.pa == t5.pa && this.wa == t5.wa);
        }, i5.prototype.dc = function() {
          return t4.P.wj(t4.P.wj());
        }, i5;
      }();
      t4.Oc = i4;
    }(Q2 || (Q2 = {})), function(t4) {
      var i4 = new t4.Oc(), s4 = new t4.Oc(), n4 = function() {
        this.oe = null, this.pb = -1, this.tb = new t4.zb(), this.lA = 55555555, this.Vv = this.Xv = false, this.Wf = new t4.Oc(), this.Wf.FB(0, 0);
      };
      t4.EY = n4;
      var h3 = function() {
        function h4(i5, s5, h5) {
          this.g = i5, this.Jk = NaN, this.IH = this.Mq = 0, this.JH = NaN, this.ra = s5, this.Pq = 10 * s5, this.KH = this.LH = NaN, this.sg = false, this.Fm = this.ht = this.No = this.Zs = this.Ys = -1, this.bA = h5, this.OA = new n4(), this.TH = new n4(), t4.P.truncate(3 * i5.gd / 2);
        }
        return h4.prototype.hG = function(t5, i5, s5, n5) {
          t5.oe = n5 === null ? null : n5[s5[5 * i5]], t5.Vv = t5.oe != null, t5.Vv || ((n5 = s5[5 * i5 + 2]) !== -1 && this.g.hW(s5[5 * i5], s5[5 * n5], t5.tb), t5.oe = t5.tb, t5.Wf.FB(t5.tb.ta, t5.tb.qa), t5.Wf.wa += this.ra, t5.tb.mI(), t5.Xv = t5.tb.ma == t5.tb.oa, t5.Xv || (t5.lA = (t5.tb.qa - t5.tb.ta) / (t5.tb.ma - t5.tb.oa)));
        }, h4.prototype.JO = function(t5, i5) {
          var s5 = t5.Br(i5, this.ra, true);
          return s5 != 0 ? s5 == 2 ? this.Ly() : this.zi() : (t5.$p(it2), t5.Vr(st2), i5.$p(nt2), i5.Vr(ht2), tt2.na(this.Mq, this.Jk), it2.rb(nt2) && this.Jk == it2.y ? 0 > st2.compare(ht2) ? tt2.N(st2) : tt2.N(ht2) : it2.rb(ht2) && this.Jk == it2.y ? 0 > st2.compare(nt2) ? tt2.N(st2) : tt2.N(nt2) : nt2.rb(st2) && this.Jk == nt2.y ? 0 > it2.compare(ht2) ? tt2.N(it2) : tt2.N(ht2) : st2.rb(ht2) && this.Jk == st2.y && (0 > it2.compare(nt2) ? tt2.N(it2) : tt2.N(nt2)), t5.Me(tt2.y, tt2.x) < i5.Me(tt2.y, tt2.x) ? -1 : 1);
        }, h4.prototype.HO = function(t5, i5) {
          if (t5.tb.oa == i5.tb.oa && t5.tb.ta == i5.tb.ta)
            return t5.tb.ma == i5.tb.ma && t5.tb.qa == i5.tb.qa ? this.bA ? this.Ly() : 0 : this.KE(t5, i5);
          if (t5.tb.ma == i5.tb.ma && t5.tb.qa == i5.tb.qa)
            return this.JE(t5, i5);
          var s5 = this.JE(t5, i5);
          return t5 = this.KE(t5, i5), 0 > s5 && 0 > t5 ? -1 : 0 < s5 && 0 < t5 ? 1 : this.zi();
        }, h4.prototype.DO = function(t5, i5) {
          if (t5.qa > i5.qa) {
            if (i5.qa > i5.ta && i5.ma - i5.oa < 2 * this.ra && t5.xi(i5.qa, i5.ma, this.ra))
              return this.zi();
          } else if ((i5.ma - i5.oa) / (i5.qa - i5.ta) * (t5.qa - t5.ta) < this.Pq && i5.xi(t5.qa, t5.ma, this.ra))
            return this.zi();
          return 1;
        }, h4.prototype.EO = function(t5, i5) {
          if (t5.ta < i5.ta) {
            if (i5.qa > i5.ta && i5.ma - i5.oa < 2 * this.ra && t5.xi(i5.qa, i5.ma, this.ra))
              return this.zi();
          } else if ((i5.ma - i5.oa) / (i5.qa - i5.ta) * (t5.ta - t5.qa) < this.Pq && i5.xi(t5.ta, t5.oa, this.ra))
            return this.zi();
          return -1;
        }, h4.prototype.FO = function(i5, s5) {
          var n5 = new t4.h();
          n5.vc(s5.xc(), s5.bc()), n5.cr(), n5.normalize();
          var h5 = new t4.h();
          h5.vc(i5.bc(), s5.bc());
          var r3 = new t4.h();
          r3.vc(i5.xc(), s5.bc()), h5 = h5.Sh(n5), n5 = r3.Sh(n5), r3 = Math.abs(h5);
          var e3 = Math.abs(n5);
          if (r3 < e3) {
            if (r3 < this.Pq && s5.xi(i5.ta, i5.oa, this.ra))
              return this.zi();
          } else if (e3 < this.Pq && s5.xi(i5.qa, i5.ma, this.ra))
            return this.zi();
          return 0 > h5 && 0 > n5 ? -1 : 0 < h5 && 0 < n5 ? 1 : this.zi();
        }, h4.prototype.IE = function(t5, i5) {
          return t5.oa == i5.oa && t5.ta == i5.ta ? this.DO(t5, i5) : t5.ma == i5.ma && t5.qa == i5.qa ? this.EO(t5, i5) : this.FO(t5, i5);
        }, h4.prototype.GO = function(t5, i5) {
          return t5.ma == i5.ma && t5.qa == i5.qa && t5.oa == i5.oa && t5.ta == i5.ta ? this.bA ? this.Ly() : 0 : this.zi();
        }, h4.prototype.JE = function(t5, i5) {
          var s5 = 1;
          if (t5.tb.oa < i5.tb.oa) {
            s5 = -1;
            var n5 = t5;
            t5 = i5, i5 = n5;
          }
          t5 = t5.tb, n5 = i5.tb;
          var h5 = t5.ta - n5.ta;
          i5 = i5.lA * (t5.oa - n5.oa);
          var r3 = this.Pq;
          return h5 < i5 - r3 ? -s5 : h5 > i5 + r3 ? s5 : n5.xi(t5.ta, t5.oa, this.ra) ? this.zi() : h5 < i5 ? -s5 : s5;
        }, h4.prototype.KE = function(t5, i5) {
          var s5 = 1;
          if (i5.tb.ma < t5.tb.ma) {
            s5 = -1;
            var n5 = t5;
            t5 = i5, i5 = n5;
          }
          t5 = t5.tb, n5 = i5.tb;
          var h5 = t5.qa - n5.ta;
          i5 = i5.lA * (t5.ma - n5.oa);
          var r3 = this.Pq;
          return h5 < i5 - r3 ? -s5 : h5 > i5 + r3 ? s5 : n5.xi(t5.qa, t5.ma, this.ra) ? this.zi() : h5 < i5 ? -s5 : s5;
        }, h4.prototype.Ly = function() {
          return this.sg = true, this.Pi = new t4.Nd(5, this.No, this.ht), -1;
        }, h4.prototype.zi = function() {
          return this.sg = true, this.bA ? this.Pi = new t4.Nd(4, this.No, this.ht) : this.ht = this.No = this.Zs = this.Ys = -1, -1;
        }, h4.prototype.IO = function(t5, n5, h5, r3) {
          if (this.sg)
            return -1;
          var e3 = this.JH == this.Jk && this.IH == this.Mq;
          if (e3 && t5 == this.Ys)
            var o3 = this.KH;
          else
            o3 = NaN, this.Ys = -1;
          return e3 && n5 == this.Zs ? e3 = this.LH : (e3 = NaN, this.Zs = -1), h5.oe.UI(i4), r3.oe.UI(s4), i4.wa < s4.pa ? -1 : s4.wa < i4.pa ? 1 : (this.JH = this.Jk, this.IH = this.Mq, isNaN(o3) && (this.Ys = t5, this.KH = o3 = t5 = h5.oe.Me(this.Jk, this.Mq)), isNaN(e3) && (this.Zs = n5, this.LH = e3 = t5 = r3.oe.Me(this.Jk, this.Mq)), Math.abs(o3 - e3) <= this.ra ? this.JO(h5.oe, r3.oe) : o3 < e3 ? -1 : o3 > e3 ? 1 : 0);
        }, h4.prototype.Mr = function() {
          this.sg = false;
        }, h4.prototype.tm = function() {
          return this.Pi;
        }, h4.prototype.VJ = function(t5, i5) {
          this.Jk = t5, this.Mq = i5, this.ht = this.No = this.Zs = this.Ys = -1;
        }, h4.prototype.compare = function(t5, i5, s5) {
          return this.sg ? -1 : (t5 = t5.ka(s5), this.Fm = s5, this.ME(i5, i5, t5, t5));
        }, h4.prototype.ME = function(t5, i5, s5, n5) {
          if (this.No == i5)
            var h5 = this.OA;
          else
            this.No = i5, h5 = this.OA, this.OA.pb = t5, this.hG(h5, i5, this.g.ud.o, this.g.Te);
          if (r3 == null) {
            this.ht = n5;
            var r3 = this.TH;
            this.TH.pb = s5, this.hG(r3, n5, this.g.ud.o, this.g.Te);
          }
          return h5.Vv || r3.Vv ? this.IO(i5, n5, h5, r3) : h5.Wf.wa < r3.Wf.pa ? -1 : r3.Wf.wa < h5.Wf.pa ? 1 : (t5 = h5.Xv ? 1 : 0, (t5 |= r3.Xv ? 2 : 0) == 0 ? this.HO(h5, r3) : t5 == 1 ? this.IE(h5.tb, r3.tb) : t5 == 2 ? -1 * this.IE(r3.tb, h5.tb) : this.GO(h5.tb, r3.tb));
        }, h4;
      }();
      t4.PC = h3;
    }(Q2 || (Q2 = {})), function(t4) {
      var i4 = function() {
        function i5(i6, s4) {
          this.g = i6, this.ra = s4, this.sg = false, this.No = -1, this.Wf = new t4.Oc(), this.Iq = new t4.h(), this.Iq.Sc(), this.je = new t4.zb(), this.Fm = -1, this.wA = 17976931348623157e292;
        }
        return i5.prototype.Mr = function() {
          this.sg = false, this.wA = 17976931348623157e292;
        }, i5.prototype.Fh = function(t5) {
          this.Iq.N(t5);
        }, i5.prototype.compare = function(t5, i6) {
          return this.NE(i6, t5.ka(i6));
        }, i5.prototype.NE = function(i6, s4) {
          var n4 = this.g.cc(s4) != null;
          if (n4 || (this.g.fd(s4, this.je), this.Wf.FB(this.je.ta, this.je.qa)), n4)
            throw t4.i.ga("not implemented");
          if (this.Iq.x + this.ra < this.Wf.pa)
            return -1;
          if (this.Iq.x - this.ra > this.Wf.wa)
            return 1;
          if (this.je.oa == this.je.ma)
            return this.Fm = i6, this.sg = true, 0;
          this.je.mI(), n4 = this.je.bc(), (s4 = new t4.h()).vc(this.je.xc(), n4), s4.cr();
          var h3 = new t4.h();
          return h3.vc(this.Iq, n4), n4 = s4.Sh(h3), (n4 /= s4.length()) < 10 * -this.ra ? -1 : n4 > 10 * this.ra ? 1 : this.je.ss(this.Iq, this.ra) && ((s4 = Math.abs(n4)) < this.wA && (this.Fm = i6, this.wA = s4), this.sg = true, s4 < 0.25 * this.ra) ? 0 : 0 > n4 ? -1 : 1;
        }, i5;
      }();
      t4.WL = i4;
    }(Q2 || (Q2 = {})), function(t4) {
      function i4(t5, i5, s5, n4) {
        s5 = new Float64Array(t5.subarray(s5, n4)), t5.set(s5, i5);
      }
      var s4 = function() {
        function s5(t5) {
          this.Pb = this.rk = false, this.o = null;
          var i5 = t5;
          2 > i5 && (i5 = 2), this.o = new Float64Array(i5), this.size = t5;
        }
        return s5.prototype.rotate = function(i5, s6, n4) {
          if (this.Pb)
            throw t4.i.ga("invalid_call");
          if (s6 < i5 || s6 > n4 || i5 > n4)
            throw t4.i.O();
          i5 != s6 && n4 != s6 && (this.pi(i5, s6 - i5, 1), this.pi(s6, n4 - s6, 1), this.pi(i5, n4 - i5, 1));
        }, s5.rf = function(t5, i5) {
          var n4 = new s5(t5), h3 = n4.o;
          if (2 > t5 && (t5 = 2), i5 !== 0)
            for (var r3 = 0; r3 < t5; r3++)
              h3[r3] = i5;
          return n4;
        }, s5.Dn = function(t5) {
          var i5 = new s5(0);
          return i5.o = new Float64Array(t5.o), i5.size = t5.size, i5;
        }, s5.Nr = function(t5, i5) {
          var n4 = new s5(0);
          return n4.size = t5.size, n4.size > i5 && (n4.size = i5), 2 > (i5 = n4.size) && (i5 = 2), n4.o = new Float64Array(i5), n4.o.set(t5.o.length <= i5 ? t5.o : t5.o.subarray(0, i5), 0), n4;
        }, s5.prototype.Jb = function(t5) {
          0 >= t5 || (this.o == null ? this.o = new Float64Array(t5) : t5 <= this.o.length || (0 < this.o.length ? ((t5 = new Float64Array(t5)).set(this.o), this.o = t5) : this.o = new Float64Array(t5)));
        }, s5.prototype.read = function(t5) {
          return this.o[t5];
        }, s5.prototype.uc = function(t5, i5) {
          i5.x = this.o[t5], i5.y = this.o[t5 + 1];
        }, s5.prototype.get = function(t5) {
          return this.o[t5];
        }, s5.prototype.write = function(i5, s6) {
          if (this.Pb)
            throw t4.i.Hb();
          this.o[i5] = s6;
        }, s5.prototype.set = function(i5, s6) {
          if (this.Pb)
            throw t4.i.Hb();
          this.o[i5] = s6;
        }, s5.prototype.Vt = function(i5, s6) {
          if (this.Pb)
            throw t4.i.Hb();
          this.o[i5] = s6.x, this.o[i5 + 1] = s6.y;
        }, s5.prototype.add = function(t5) {
          this.resize(this.size + 1), this.o[this.size - 1] = t5;
        }, s5.prototype.BB = function(t5) {
          return s5.Nr(this, t5);
        }, s5.prototype.gg = function(t5) {
          return this.read(t5);
        }, s5.prototype.resize = function(i5, s6) {
          if (s6 === void 0 && (s6 = 0), this.rk)
            throw t4.i.ga("invalid call. Attribute Stream is locked and cannot be resized.");
          if (i5 <= this.size) {
            if (30 < this.o.length && 5 * i5 / 4 < this.o.length) {
              var n4 = new Float64Array(this.o, 0, i5);
              this.o = n4;
            }
          } else {
            i5 > this.o.length && (n4 = t4.P.truncate(64 > i5 ? Math.max(2 * i5, 4) : 5 * i5 / 4), (n4 = new Float64Array(n4)).set(this.o), this.o = n4), n4 = this.o;
            for (var h3 = this.size; h3 < i5; h3++)
              n4[h3] = s6;
          }
          this.size = i5;
        }, s5.prototype.Dh = function(i5) {
          if ((this.o == null || i5 > this.o.length) && this.resize(i5), this.rk)
            throw t4.i.ga("invalid call. Attribute Stream is locked and cannot be resized.");
          this.size = i5;
        }, s5.prototype.rr = function(t5, i5) {
          this.write(t5, i5);
        }, s5.prototype.Cn = function(i5, s6, n4) {
          for (var h3 = this.size; s6 < h3 && s6 < n4; s6++)
            i5 = t4.P.wj(this.read(s6));
          return i5;
        }, s5.prototype.Nb = function(t5, i5, n4) {
          if (t5 == null || !(t5 instanceof s5))
            return false;
          var h3 = this.size, r3 = t5.size;
          if (n4 > h3 || n4 > r3 && h3 != r3)
            return false;
          for (n4 > h3 && (n4 = h3); i5 < n4; i5++)
            if (this.read(i5) != t5.read(i5))
              return false;
          return true;
        }, s5.prototype.addRange = function(i5, s6, n4, h3, r3) {
          if (this.Pb)
            throw t4.i.Hb();
          if (!h3 && (1 > r3 || n4 % r3 != 0))
            throw t4.i.O();
          var e3 = this.size;
          if (this.resize(e3 + n4), h3)
            this.o.set(i5.o.subarray(s6, s6 + n4), e3);
          else {
            h3 = n4;
            for (var o3 = 0; o3 < n4; o3 += r3) {
              h3 -= r3;
              for (var a3 = 0; a3 < r3; a3++)
                this.o[e3 + o3 + a3] = i5.o[s6 + h3 + a3];
            }
          }
        }, s5.prototype.On = function(s6, n4, h3, r3, e3, o3, a3) {
          if (this.Pb)
            throw t4.i.Hb();
          if (!e3 && (1 > o3 || r3 % o3 != 0))
            throw t4.i.O();
          var u3 = this.size - a3;
          if (u3 < r3 && this.resize(this.size + r3 - u3), i4(this.o, s6 + r3, s6, s6 + (a3 - s6)), this.o == n4.o && s6 < h3 && (h3 += r3), e3)
            this.o.set(n4.o.subarray(h3, h3 + r3), s6);
          else
            for (e3 = r3, a3 = 0; a3 < r3; a3 += o3)
              for (e3 -= o3, u3 = 0; u3 < o3; u3++)
                this.o[s6 + a3 + u3] = n4.o[h3 + e3 + u3];
        }, s5.prototype.Dz = function(s6, n4, h3, r3, e3, o3) {
          if (this.Pb)
            throw t4.i.Hb();
          if (0 > o3 && (o3 = this.size), this.size + 2 * r3 > this.o.length ? this.resize(this.size + 2 * r3) : this.size += 2 * r3, i4(this.o, s6 + 2 * r3, s6, s6 + (o3 - s6)), e3)
            for (e3 = 0; e3 < r3; e3++)
              o3 = n4[h3++], this.o[s6++] = o3.x, this.o[s6++] = o3.y;
          else {
            e3 = 0;
            for (var a3 = r3 - 1; e3 < r3; ++e3)
              o3 = n4[h3 + a3], this.o[s6++] = o3.x, this.o[s6++] = o3.y, a3--;
          }
        }, s5.prototype.Nn = function(s6, n4, h3, r3) {
          if (this.Pb)
            throw t4.i.Hb();
          for (r3 -= s6, i4(this.o, s6 + r3, s6, s6 + r3), r3 = 0; r3 < h3; r3++)
            this.o[s6 + r3] = n4;
        }, s5.prototype.xj = function(s6, n4, h3) {
          if (this.Pb)
            throw t4.i.Hb();
          i4(this.o, s6 + 2, s6, s6 + (h3 - s6)), this.o[s6] = n4.x, this.o[s6 + 1] = n4.y;
        }, s5.prototype.Wt = function(i5, s6, n4, h3, r3, e3) {
          if (0 > i5 || 0 > s6 || 0 > h3)
            throw t4.i.O();
          if (!r3 && (0 >= e3 || s6 % e3 != 0))
            throw t4.i.O();
          if (n4.size < h3 + s6)
            throw t4.i.O();
          if (s6 != 0)
            if (this.size < s6 + i5 && this.resize(s6 + i5), n4 == this)
              this.Cr(i5, s6, h3, r3, e3);
            else if (r3)
              for (r3 = 0; r3 < s6; r3++)
                this.o[i5] = n4.o[h3], i5++, h3++;
            else if (h3 = h3 + s6 - e3, e3 == 1)
              for (r3 = 0; r3 < s6; r3++)
                this.o[i5] = n4.o[h3], i5++, h3--;
            else
              for (r3 = 0, s6 = t4.P.truncate(s6 / e3); r3 < s6; r3++) {
                for (var o3 = 0; o3 < e3; o3++)
                  this.o[i5 + o3] = n4.o[h3 + o3];
                i5 += e3, h3 -= e3;
              }
        }, s5.prototype.Gn = function(s6, n4, h3) {
          if (this.Pb)
            throw t4.i.Hb();
          if (s6 + n4 > this.size)
            throw t4.i.Hb();
          0 < h3 - (s6 + n4) && i4(this.o, s6, s6 + n4, s6 + (h3 - (s6 + n4)) + n4), this.size -= n4;
        }, s5.prototype.pi = function(i5, s6, n4) {
          if (this.Pb)
            throw t4.i.Hb();
          if (1 > n4 || s6 % n4 != 0)
            throw t4.i.Hb();
          for (var h3 = s6 >> 1, r3 = 0; r3 < h3; r3 += n4) {
            s6 -= n4;
            for (var e3 = 0; e3 < n4; e3++) {
              var o3 = this.o[i5 + r3 + e3];
              this.o[i5 + r3 + e3] = this.o[i5 + s6 + e3], this.o[i5 + s6 + e3] = o3;
            }
          }
        }, s5.prototype.Yj = function(i5, s6, n4) {
          if (0 > s6 || 0 > n4 || 0 > s6 || n4 + s6 > this.size)
            throw t4.i.O();
          for (var h3 = s6; h3 < s6 + n4; h3++)
            this.o[h3] = i5;
        }, s5.prototype.Cr = function(i5, s6, n4, h3, r3) {
          if (!(h3 && i5 == n4 || (this.o.set(this.o.subarray(n4, n4 + s6), i5), h3)))
            for (n4 = i5, i5 = i5 + s6 - r3, h3 = 0, s6 = t4.P.truncate(s6 / 2); h3 < s6; h3++) {
              for (var e3 = 0; e3 < r3; e3++) {
                var o3 = this.o[n4 + e3];
                this.o[n4 + e3] = this.o[i5 + e3], this.o[i5 + e3] = o3;
              }
              n4 += r3, i5 -= r3;
            }
        }, s5.prototype.qC = function(i5, s6, n4, h3, r3) {
          if (0 > i5 || 0 > s6 || 0 > h3)
            throw t4.i.O();
          if (s6 != 0)
            for (this.size < (s6 << 1) + i5 && this.resize((s6 << 1) + i5), r3 || (i5 += s6 - 1 << 1), r3 = r3 ? 2 : -2, s6 += h3; h3 < s6; h3++)
              this.o[i5] = n4[h3].x, this.o[i5 + 1] = n4[h3].y, i5 += r3;
        }, s5.prototype.pC = function(i5, s6, n4) {
          if (0 > i5 || 0 > s6)
            throw t4.i.O();
          if (s6 != 0) {
            this.size < (s6 << 1) + i5 && this.resize((s6 << 1) + i5), s6 += 0;
            for (var h3 = 0; h3 < s6; h3++)
              this.o[i5] = n4[h3][0], this.o[i5 + 1] = n4[h3][1], i5 += 2;
          }
        }, s5.prototype.Xw = function(i5, s6, n4, h3, r3) {
          if (0 > i5 || 0 > s6 || 0 > h3 || this.size < s6 + i5)
            throw t4.i.O();
          if (r3)
            for (r3 = 0; r3 < s6; r3++)
              n4[h3 + r3] = this.o[i5 + r3];
          else
            for (h3 = h3 + s6 - 1; i5 < s6; i5++)
              n4[h3] = this.o[i5], h3--;
        }, s5.prototype.pB = function(i5, s6, n4) {
          if (0 > i5 || 0 > s6 || this.size < (s6 >> 1) + i5)
            throw t4.i.O();
          if (s6 != 0) {
            s6 = 0 + s6;
            for (var h3 = 0; h3 < s6; h3++)
              n4[h3][0] = this.o[i5], n4[h3][1] = this.o[i5 + 1], i5 += 2;
          }
        }, s5.prototype.clear = function(t5) {
          t5 ? this.resize(0) : this.Dh(0);
        }, s5.prototype.ix = function() {
          this.rk = this.Pb = true;
        }, s5.prototype.Wd = function(t5, i5, s6) {
          Array.prototype.sort.call(this.o.subarray(t5, i5), s6);
        }, s5.prototype.Vp = function() {
          return 1;
        }, s5;
      }();
      t4.ce = s4;
    }(Q2 || (Q2 = {})), function(t4) {
      function i4(t5, i5, s5, n4) {
        s5 = new Int32Array(t5.subarray(s5, n4)), t5.set(s5, i5);
      }
      t4.nY = function() {
        this.random = 1973;
      };
      var s4 = function() {
        function s5(t5) {
          this.Pb = this.rk = false, this.o = null;
          var i5 = t5;
          2 > i5 && (i5 = 2), this.o = new Int32Array(i5), this.size = t5;
        }
        return s5.prototype.rotate = function(i5, s6, n4) {
          if (this.Pb)
            throw t4.i.ga("invalid_call");
          if (s6 < i5 || s6 > n4 || i5 > n4)
            throw t4.i.O();
          i5 != s6 && n4 != s6 && (this.pi(i5, s6 - i5, 1), this.pi(s6, n4 - s6, 1), this.pi(i5, n4 - i5, 1));
        }, s5.rf = function(t5, i5) {
          var n4 = new s5(t5), h3 = n4.o;
          if (2 > t5 && (t5 = 2), i5 !== 0)
            for (var r3 = 0; r3 < t5; r3++)
              h3[r3] = i5;
          return n4;
        }, s5.Dn = function(t5) {
          var i5 = new s5(0);
          return i5.o = new Int32Array(t5.o), i5.size = t5.size, i5;
        }, s5.Nr = function(t5, i5) {
          var n4 = new s5(0);
          return n4.size = t5.size, n4.size > i5 && (n4.size = i5), 2 > (i5 = n4.size) && (i5 = 2), n4.o = new Int32Array(i5), n4.o.set(t5.o.length <= i5 ? t5.o : t5.o.subarray(0, i5), 0), n4;
        }, s5.prototype.Jb = function(t5) {
          0 >= t5 || (this.o == null ? this.o = new Int32Array(t5) : t5 <= this.o.length || (0 < this.o.length ? ((t5 = new Int32Array(t5)).set(this.o), this.o = t5) : this.o = new Int32Array(t5)));
        }, s5.prototype.read = function(t5) {
          return this.o[t5];
        }, s5.prototype.uc = function(t5, i5) {
          i5.x = this.o[t5], i5.y = this.o[t5 + 1];
        }, s5.prototype.get = function(t5) {
          return this.o[t5];
        }, s5.prototype.write = function(i5, s6) {
          if (this.Pb)
            throw t4.i.Hb();
          this.o[i5] = s6;
        }, s5.prototype.set = function(i5, s6) {
          if (this.Pb)
            throw t4.i.Hb();
          this.o[i5] = s6;
        }, s5.prototype.Vt = function(i5, s6) {
          if (this.Pb)
            throw t4.i.Hb();
          this.o[i5] = s6.x, this.o[i5 + 1] = s6.y;
        }, s5.prototype.add = function(t5) {
          this.resize(this.size + 1), this.o[this.size - 1] = t5;
        }, s5.prototype.BB = function(t5) {
          return s5.Nr(this, t5);
        }, s5.prototype.gg = function(t5) {
          return this.read(t5);
        }, s5.prototype.resize = function(i5, s6) {
          if (s6 === void 0 && (s6 = 0), this.rk)
            throw t4.i.ga("invalid call. Attribute Stream is locked and cannot be resized.");
          if (i5 <= this.size) {
            if (30 < this.o.length && 5 * i5 / 4 < this.o.length) {
              var n4 = new Int32Array(this.o, 0, i5);
              this.o = n4;
            }
          } else {
            i5 > this.o.length && (n4 = t4.P.truncate(64 > i5 ? Math.max(2 * i5, 4) : 5 * i5 / 4), (n4 = new Int32Array(n4)).set(this.o), this.o = n4), n4 = this.o;
            for (var h3 = this.size; h3 < i5; h3++)
              n4[h3] = s6;
          }
          this.size = i5;
        }, s5.prototype.Dh = function(i5) {
          if ((this.o == null || i5 > this.o.length) && this.resize(i5), this.rk)
            throw t4.i.ga("invalid call. Attribute Stream is locked and cannot be resized.");
          this.size = i5;
        }, s5.prototype.rr = function(t5, i5) {
          this.write(t5, i5);
        }, s5.prototype.Cn = function(i5, s6, n4) {
          for (var h3 = this.size; s6 < h3 && s6 < n4; s6++)
            i5 = t4.P.Vh(this.read(s6), i5);
          return i5;
        }, s5.prototype.Nb = function(t5, i5, n4) {
          if (t5 == null || !(t5 instanceof s5))
            return false;
          var h3 = this.size, r3 = t5.size;
          if (n4 > h3 || n4 > r3 && h3 != r3)
            return false;
          for (n4 > h3 && (n4 = h3); i5 < n4; i5++)
            if (this.read(i5) != t5.read(i5))
              return false;
          return true;
        }, s5.prototype.addRange = function(i5, s6, n4, h3, r3) {
          if (this.Pb)
            throw t4.i.Hb();
          if (!h3 && (1 > r3 || n4 % r3 != 0))
            throw t4.i.O();
          var e3 = this.size;
          if (this.resize(e3 + n4), h3)
            this.o.set(i5.o.subarray(s6, s6 + n4), e3);
          else {
            h3 = n4;
            for (var o3 = 0; o3 < n4; o3 += r3) {
              h3 -= r3;
              for (var a3 = 0; a3 < r3; a3++)
                this.o[e3 + o3 + a3] = i5.o[s6 + h3 + a3];
            }
          }
        }, s5.prototype.On = function(s6, n4, h3, r3, e3, o3, a3) {
          if (this.Pb)
            throw t4.i.Hb();
          if (!e3 && (1 > o3 || r3 % o3 != 0))
            throw t4.i.O();
          if (i4(this.o, s6 + r3, s6, s6 + (a3 - s6)), this.o == n4.o && s6 < h3 && (h3 += r3), e3)
            this.o.set(n4.o.subarray(h3, h3 + r3), s6);
          else
            for (e3 = r3, a3 = 0; a3 < r3; a3 += o3) {
              e3 -= o3;
              for (var u3 = 0; u3 < o3; u3++)
                this.o[s6 + a3 + u3] = n4.o[h3 + e3 + u3];
            }
        }, s5.prototype.Dz = function(s6, n4, h3, r3, e3, o3) {
          if (this.Pb)
            throw t4.i.Hb();
          if (0 > o3 && (o3 = this.size), this.size + 2 * r3 > this.o.length ? this.resize(this.size + 2 * r3) : this.size += 2 * r3, i4(this.o, s6 + 2 * r3, s6, s6 + (o3 - s6)), e3)
            for (e3 = 0; e3 < r3; e3++)
              o3 = n4[h3++], this.o[s6++] = o3.x, this.o[s6++] = o3.y;
          else {
            e3 = 0;
            for (var a3 = r3 - 1; e3 < r3; ++e3)
              o3 = n4[h3 + a3], this.o[s6++] = o3.x, this.o[s6++] = o3.y, a3--;
          }
        }, s5.prototype.Nn = function(s6, n4, h3, r3) {
          if (this.Pb)
            throw t4.i.Hb();
          for (r3 -= s6, i4(this.o, s6 + r3, s6, s6 + r3), r3 = 0; r3 < h3; r3++)
            this.o[s6 + r3] = n4;
        }, s5.prototype.xj = function(s6, n4, h3) {
          if (this.Pb)
            throw t4.i.Hb();
          i4(this.o, s6 + 2, s6, s6 + (h3 - s6)), this.o[s6] = n4.x, this.o[s6 + 1] = n4.y;
        }, s5.prototype.Wt = function(i5, s6, n4, h3, r3, e3) {
          if (0 > i5 || 0 > s6 || 0 > h3)
            throw t4.i.O();
          if (!r3 && (0 >= e3 || s6 % e3 != 0))
            throw t4.i.O();
          if (n4.size < h3 + s6)
            throw t4.i.O();
          if (s6 != 0)
            if (this.size < s6 + i5 && this.resize(s6 + i5), n4 == this)
              this.Cr(i5, s6, h3, r3, e3);
            else if (r3)
              for (r3 = 0; r3 < s6; r3++)
                this.o[i5] = n4.o[h3], i5++, h3++;
            else if (h3 = h3 + s6 - e3, e3 == 1)
              for (r3 = 0; r3 < s6; r3++)
                this.o[i5] = n4.o[h3], i5++, h3--;
            else
              for (r3 = 0, s6 = t4.P.truncate(s6 / e3); r3 < s6; r3++) {
                for (var o3 = 0; o3 < e3; o3++)
                  this.o[i5 + o3] = n4.o[h3 + o3];
                i5 += e3, h3 -= e3;
              }
        }, s5.prototype.Gn = function(s6, n4, h3) {
          if (this.Pb)
            throw t4.i.Hb();
          if (s6 + n4 > this.size)
            throw t4.i.Hb();
          0 < h3 - (s6 + n4) && i4(this.o, s6, s6 + n4, s6 + (h3 - (s6 + n4)) + n4), this.size -= n4;
        }, s5.prototype.pi = function(i5, s6, n4) {
          if (this.Pb)
            throw t4.i.Hb();
          if (1 > n4 || s6 % n4 != 0)
            throw t4.i.Hb();
          for (var h3 = s6 >> 1, r3 = 0; r3 < h3; r3 += n4) {
            s6 -= n4;
            for (var e3 = 0; e3 < n4; e3++) {
              var o3 = this.o[i5 + r3 + e3];
              this.o[i5 + r3 + e3] = this.o[i5 + s6 + e3], this.o[i5 + s6 + e3] = o3;
            }
          }
        }, s5.prototype.Yj = function(i5, s6, n4) {
          if (0 > s6 || 0 > n4 || 0 > s6 || n4 + s6 > this.size)
            throw t4.i.O();
          for (var h3 = s6; h3 < s6 + n4; h3++)
            this.o[h3] = i5;
        }, s5.prototype.Cr = function(i5, s6, n4, h3, r3) {
          if (!(h3 && i5 == n4 || (this.o.set(this.o.subarray(n4, n4 + s6), i5), h3)))
            for (n4 = i5, i5 = i5 + s6 - r3, h3 = 0, s6 = t4.P.truncate(s6 / 2); h3 < s6; h3++) {
              for (var e3 = 0; e3 < r3; e3++) {
                var o3 = this.o[n4 + e3];
                this.o[n4 + e3] = this.o[i5 + e3], this.o[i5 + e3] = o3;
              }
              n4 += r3, i5 -= r3;
            }
        }, s5.prototype.qC = function(i5, s6, n4, h3, r3) {
          if (0 > i5 || 0 > s6 || 0 > h3)
            throw t4.i.O();
          if (s6 != 0)
            for (this.size < (s6 << 1) + i5 && this.resize((s6 << 1) + i5), r3 || (i5 += s6 - 1 << 1), r3 = r3 ? 2 : -2, s6 += h3; h3 < s6; h3++)
              this.o[i5] = n4[h3].x, this.o[i5 + 1] = n4[h3].y, i5 += r3;
        }, s5.prototype.Xw = function(i5, s6, n4, h3, r3) {
          if (0 > i5 || 0 > s6 || 0 > h3 || this.size < s6 + i5)
            throw t4.i.O();
          if (r3)
            for (r3 = 0; r3 < s6; r3++)
              n4[h3 + r3] = this.o[i5 + r3];
          else
            for (h3 = h3 + s6 - 1; i5 < s6; i5++)
              n4[h3] = this.o[i5], h3--;
        }, s5.prototype.clear = function(t5) {
          t5 ? this.resize(0) : this.Dh(0);
        }, s5.prototype.ix = function() {
          this.rk = this.Pb = true;
        }, s5.prototype.Wd = function(t5, i5, n4) {
          10 > i5 - t5 ? s5.mG(this.o, t5, i5, n4) : s5.lB(this.o, t5, i5 - 1, n4);
        }, s5.prototype.Vp = function() {
          return 2;
        }, s5.prototype.Gc = function() {
          return this.o[this.size - 1];
        }, s5.prototype.Jf = function() {
          this.resize(this.size - 1);
        }, s5.prototype.XW = function(t5) {
          this.o[this.size - 1] = t5;
        }, s5.prototype.NV = function(t5) {
          t5 < this.size - 1 && (this.o[t5] = this.o[this.size - 1]), this.resize(this.size - 1);
        }, s5.prototype.gF = function(t5) {
          for (var i5 = 0, s6 = this.size; i5 < s6; i5++)
            if (this.o[i5] == t5)
              return i5;
          return -1;
        }, s5.prototype.cG = function(t5) {
          return 0 <= this.gF(t5);
        }, s5.mG = function(t5, i5, s6, n4) {
          for (var h3 = i5; h3 < s6; h3++) {
            for (var r3 = t5[h3], e3 = h3 - 1; e3 >= i5 && 0 < n4(t5[e3], r3); )
              t5[e3 + 1] = t5[e3], e3--;
            t5[e3 + 1] = r3;
          }
        }, s5.sx = function(t5, i5, s6) {
          var n4 = t5[s6];
          t5[s6] = t5[i5], t5[i5] = n4;
        }, s5.lB = function(t5, i5, n4, h3) {
          if (!(i5 >= n4))
            for (; ; ) {
              if (9 > n4 - i5) {
                s5.mG(t5, i5, n4 + 1, h3);
                break;
              }
              var r3 = t5[i5];
              s5.sx(t5, i5, n4);
              for (var e3 = i5, o3 = i5; o3 < n4; o3++)
                0 >= h3(t5[o3], r3) && (s5.sx(t5, e3, o3), e3 += 1);
              s5.sx(t5, e3, n4), e3 - i5 < n4 - e3 ? (s5.lB(t5, i5, e3 - 1, h3), i5 = e3 + 1) : (s5.lB(t5, e3 + 1, n4, h3), n4 = e3 - 1);
            }
        }, s5;
      }();
      t4.ja = s4;
    }(Q2 || (Q2 = {})), function(t4) {
      function i4(t5, i5, s5, n4) {
        s5 = new Int8Array(t5.subarray(s5, n4)), t5.set(s5, i5);
      }
      var s4 = function() {
        function s5(t5) {
          this.o = null;
          var i5 = t5;
          2 > i5 && (i5 = 2), this.o = new Int8Array(i5), this.size = t5;
        }
        return s5.prototype.rotate = function(i5, s6, n4) {
          if (this.Pb)
            throw t4.i.ga("invalid_call");
          if (s6 < i5 || s6 > n4 || i5 > n4)
            throw t4.i.O();
          i5 != s6 && n4 != s6 && (this.pi(i5, s6 - i5, 1), this.pi(s6, n4 - s6, 1), this.pi(i5, n4 - i5, 1));
        }, s5.rf = function(t5, i5) {
          var n4 = new s5(t5), h3 = n4.o;
          if (2 > t5 && (t5 = 2), i5 !== 0)
            for (var r3 = 0; r3 < t5; r3++)
              h3[r3] = i5;
          return n4;
        }, s5.Dn = function(t5) {
          var i5 = new s5(0);
          return i5.o = new Int8Array(t5.o), i5.size = t5.size, i5;
        }, s5.Nr = function(t5, i5) {
          var n4 = new s5(0);
          return n4.size = t5.size, n4.size > i5 && (n4.size = i5), 2 > (i5 = n4.size) && (i5 = 2), n4.o = new Int8Array(i5), n4.o.set(t5.o.length <= i5 ? t5.o : t5.o.subarray(0, i5), 0), n4;
        }, s5.prototype.Jb = function(t5) {
          0 >= t5 || (this.o == null ? this.o = new Int8Array(t5) : t5 <= this.o.length || (0 < this.o.length ? ((t5 = new Int8Array(t5)).set(this.o), this.o = t5) : this.o = new Int8Array(t5)));
        }, s5.prototype.read = function(t5) {
          return this.o[t5];
        }, s5.prototype.uc = function(t5, i5) {
          i5.x = this.o[t5], i5.y = this.o[t5 + 1];
        }, s5.prototype.get = function(t5) {
          return this.o[t5];
        }, s5.prototype.write = function(i5, s6) {
          if (this.Pb)
            throw t4.i.Hb();
          this.o[i5] = s6;
        }, s5.prototype.set = function(i5, s6) {
          if (this.Pb)
            throw t4.i.Hb();
          this.o[i5] = s6;
        }, s5.prototype.Vt = function(i5, s6) {
          if (this.Pb)
            throw t4.i.Hb();
          this.o[i5] = s6.x, this.o[i5 + 1] = s6.y;
        }, s5.prototype.add = function(t5) {
          this.resize(this.size + 1), this.o[this.size - 1] = t5;
        }, s5.prototype.BB = function(t5) {
          return s5.Nr(this, t5);
        }, s5.prototype.gg = function(t5) {
          return this.read(t5);
        }, s5.prototype.resize = function(i5, s6) {
          if (s6 === void 0 && (s6 = 0), this.rk)
            throw t4.i.ga("invalid call. Attribute Stream is locked and cannot be resized.");
          if (i5 <= this.size) {
            if (30 < this.o.length && 5 * i5 / 4 < this.o.length) {
              var n4 = new Int8Array(this.o, 0, i5);
              this.o = n4;
            }
          } else {
            i5 > this.o.length && (n4 = t4.P.truncate(64 > i5 ? Math.max(2 * i5, 4) : 5 * i5 / 4), (n4 = new Int8Array(n4)).set(this.o), this.o = n4), n4 = this.o;
            for (var h3 = this.size; h3 < i5; h3++)
              n4[h3] = s6;
          }
          this.size = i5;
        }, s5.prototype.Dh = function(i5) {
          if ((this.o == null || i5 > this.o.length) && this.resize(i5), this.rk)
            throw t4.i.ga("invalid call. Attribute Stream is locked and cannot be resized.");
          this.size = i5;
        }, s5.prototype.rr = function(t5, i5) {
          this.write(t5, i5);
        }, s5.prototype.Cn = function(i5, s6, n4) {
          for (var h3 = this.size; s6 < h3 && s6 < n4; s6++)
            i5 = t4.P.Vh(this.read(s6), i5);
          return i5;
        }, s5.prototype.Nb = function(t5, i5, n4) {
          if (t5 == null || !(t5 instanceof s5))
            return false;
          var h3 = this.size, r3 = t5.size;
          if (n4 > h3 || n4 > r3 && h3 != r3)
            return false;
          for (n4 > h3 && (n4 = h3); i5 < n4; i5++)
            if (this.read(i5) != t5.read(i5))
              return false;
          return true;
        }, s5.prototype.addRange = function(i5, s6, n4, h3, r3) {
          if (this.Pb)
            throw t4.i.Hb();
          if (!h3 && (1 > r3 || n4 % r3 != 0))
            throw t4.i.O();
          var e3 = this.size;
          if (this.resize(e3 + n4), h3)
            this.o.set(i5.o.subarray(s6, s6 + n4), e3);
          else {
            h3 = n4;
            for (var o3 = 0; o3 < n4; o3 += r3) {
              h3 -= r3;
              for (var a3 = 0; a3 < r3; a3++)
                this.o[e3 + o3 + a3] = i5.o[s6 + h3 + a3];
            }
          }
        }, s5.prototype.On = function(s6, n4, h3, r3, e3, o3, a3) {
          if (this.Pb)
            throw t4.i.Hb();
          if (!e3 && (1 > o3 || r3 % o3 != 0))
            throw t4.i.O();
          if (i4(this.o, s6 + r3, s6, s6 + (a3 - s6)), this.o == n4.o && s6 < h3 && (h3 += r3), e3)
            this.o.set(n4.o.subarray(h3, h3 + r3), s6);
          else
            for (e3 = r3, a3 = 0; a3 < r3; a3 += o3) {
              e3 -= o3;
              for (var u3 = 0; u3 < o3; u3++)
                this.o[s6 + a3 + u3] = n4.o[h3 + e3 + u3];
            }
        }, s5.prototype.Nn = function(s6, n4, h3, r3) {
          if (this.Pb)
            throw t4.i.Hb();
          for (r3 -= s6, i4(this.o, s6 + r3, s6, s6 + r3), r3 = 0; r3 < h3; r3++)
            this.o[s6 + r3] = n4;
        }, s5.prototype.Dz = function(s6, n4, h3, r3, e3, o3) {
          if (this.Pb)
            throw t4.i.Hb();
          if (0 > o3 && (o3 = this.size), this.size + 2 * r3 > this.o.length ? this.resize(this.size + 2 * r3) : this.size += 2 * r3, i4(this.o, s6 + 2 * r3, s6, s6 + (o3 - s6)), e3)
            for (e3 = 0; e3 < r3; e3++)
              o3 = n4[h3++], this.o[s6++] = o3.x, this.o[s6++] = o3.y;
          else {
            e3 = 0;
            for (var a3 = r3 - 1; e3 < r3; ++e3)
              o3 = n4[h3 + a3], this.o[s6++] = o3.x, this.o[s6++] = o3.y, a3--;
          }
        }, s5.prototype.xj = function(s6, n4, h3) {
          if (this.Pb)
            throw t4.i.Hb();
          i4(this.o, s6 + 2, s6, s6 + (h3 - s6)), this.o[s6] = n4.x, this.o[s6 + 1] = n4.y;
        }, s5.prototype.Wt = function(i5, s6, n4, h3, r3, e3) {
          if (0 > i5 || 0 > s6 || 0 > h3)
            throw t4.i.O();
          if (!r3 && (0 >= e3 || s6 % e3 != 0))
            throw t4.i.O();
          if (n4.size < h3 + s6)
            throw t4.i.O();
          if (s6 != 0)
            if (this.size < s6 + i5 && this.resize(s6 + i5), n4 == this)
              this.Cr(i5, s6, h3, r3, e3);
            else if (r3)
              for (r3 = 0; r3 < s6; r3++)
                this.o[i5] = n4.o[h3], i5++, h3++;
            else if (h3 = h3 + s6 - e3, e3 == 1)
              for (r3 = 0; r3 < s6; r3++)
                this.o[i5] = n4.o[h3], i5++, h3--;
            else
              for (r3 = 0, s6 = t4.P.truncate(s6 / e3); r3 < s6; r3++) {
                for (var o3 = 0; o3 < e3; o3++)
                  this.o[i5 + o3] = n4.o[h3 + o3];
                i5 += e3, h3 -= e3;
              }
        }, s5.prototype.Gn = function(s6, n4, h3) {
          if (this.Pb)
            throw t4.i.Hb();
          if (s6 + n4 > this.size)
            throw t4.i.Hb();
          0 < h3 - (s6 + n4) && i4(this.o, s6, s6 + n4, s6 + (h3 - (s6 + n4)) + n4), this.size -= n4;
        }, s5.prototype.pi = function(i5, s6, n4) {
          if (this.Pb)
            throw t4.i.Hb();
          if (1 > n4 || s6 % n4 != 0)
            throw t4.i.Hb();
          for (var h3 = s6 >> 1, r3 = 0; r3 < h3; r3 += n4) {
            s6 -= n4;
            for (var e3 = 0; e3 < n4; e3++) {
              var o3 = this.o[i5 + r3 + e3];
              this.o[i5 + r3 + e3] = this.o[i5 + s6 + e3], this.o[i5 + s6 + e3] = o3;
            }
          }
        }, s5.prototype.Yj = function(i5, s6, n4) {
          if (0 > s6 || 0 > n4 || 0 > s6 || n4 + s6 > this.size)
            throw t4.i.O();
          for (var h3 = s6; h3 < s6 + n4; h3++)
            this.o[h3] = i5;
        }, s5.prototype.Cr = function(i5, s6, n4, h3, r3) {
          if (!(h3 && i5 == n4 || (this.o.set(this.o.subarray(n4, n4 + s6), i5), h3)))
            for (n4 = i5, i5 = i5 + s6 - r3, h3 = 0, s6 = t4.P.truncate(s6 / 2); h3 < s6; h3++) {
              for (var e3 = 0; e3 < r3; e3++) {
                var o3 = this.o[n4 + e3];
                this.o[n4 + e3] = this.o[i5 + e3], this.o[i5 + e3] = o3;
              }
              n4 += r3, i5 -= r3;
            }
        }, s5.prototype.qC = function(i5, s6, n4, h3, r3) {
          if (0 > i5 || 0 > s6 || 0 > h3)
            throw t4.i.O();
          if (s6 != 0)
            for (this.size < (s6 << 1) + i5 && this.resize((s6 << 1) + i5), r3 || (i5 += s6 - 1 << 1), r3 = r3 ? 2 : -2, s6 += h3; h3 < s6; h3++)
              this.o[i5] = n4[h3].x, this.o[i5 + 1] = n4[h3].y, i5 += r3;
        }, s5.prototype.Xw = function(i5, s6, n4, h3, r3) {
          if (0 > i5 || 0 > s6 || 0 > h3 || this.size < s6 + i5)
            throw t4.i.O();
          if (r3)
            for (r3 = 0; r3 < s6; r3++)
              n4[h3 + r3] = this.o[i5 + r3];
          else
            for (h3 = h3 + s6 - 1; i5 < s6; i5++)
              n4[h3] = this.o[i5], h3--;
        }, s5.prototype.clear = function(t5) {
          t5 ? this.resize(0) : this.Dh(0);
        }, s5.prototype.ix = function() {
          this.rk = this.Pb = true;
        }, s5.prototype.Wd = function(t5, i5, s6) {
          i5 = this.o.subarray(t5, i5), Array.prototype.sort.call(i5, s6), this.o.set(i5, t5);
        }, s5.prototype.uJ = function(i5, s6) {
          if (this.Pb)
            throw t4.i.ga("invalid call. Attribute Stream is read only.");
          this.o[i5] |= s6;
        }, s5.prototype.FE = function(i5, s6) {
          if (this.Pb)
            throw t4.i.ga("invalid call. Attribute Stream is read only.");
          this.o[i5] &= ~s6;
        }, s5.prototype.Vp = function() {
          return 1;
        }, s5;
      }();
      t4.rn = s4;
    }(Q2 || (Q2 = {})), function(t4) {
      t4.Zc = function() {
        function i4() {
        }
        return i4.Or = function(i5, s4) {
          return t4.rn.rf(i5, s4);
        }, i4.Fn = function(i5, s4) {
          return t4.ce.rf(i5, s4);
        }, i4.kP = function(i5, s4, n4) {
          switch (i5) {
            case 1:
              i5 = t4.ce.rf(s4, n4);
              break;
            case 2:
              i5 = t4.ja.rf(s4, n4);
              break;
            case 4:
              i5 = t4.rn.rf(s4, n4);
              break;
            default:
              throw t4.i.Ra();
          }
          return i5;
        }, i4.TE = function(s4, n4) {
          return i4.kP(t4.sa.Vp(s4), n4 * t4.sa.Wa(s4), t4.sa.te(s4));
        }, i4.Qh = function(i5, s4) {
          return t4.ja.rf(i5, s4);
        }, i4.lI = function(t5) {
          var i5, s4 = [];
          for (i5 = 0; i5 < t5; i5++)
            s4.push(null);
          return s4;
        }, i4;
      }();
    }(Q2 || (Q2 = {})), function(t4) {
      t4.ha = function(t5) {
        t5 === void 0 && (t5 = 0), this.u = t5;
      };
    }(Q2 || (Q2 = {})), function(t4) {
      t4.IL = function() {
        function i4() {
        }
        return i4.bind = function(i5) {
          t4.Tc = i5.PeDefs, t4.qf = i5.PeFactory, t4.IC = i5.PeVertcs, t4.gj = i5.PeCSTransformations, t4.HC = i5.PeGTTransformations, t4.GL = i5.PeGeogtran, t4.FL = i5.PeFactoryCodechange, t4.GC = i5.PeGCSExtent, t4.Eg = i5.PePCSInfo, t4.HL = i5.PeHorizon, t4.EL = i5.PeCoordsys, t4.np = i5.PeGTlistExtended, t4.np.PE_GTLIST_OPTS_USE_DEFAULT = 128, t4.qf.initialize(null), t4.Lx = i5.PeGTlistExtendedEntry, t4.qf.fromString(t4.Tc.PE_TYPE_UNIT, 'UNIT["Meter",1.0]');
        }, i4;
      }(), t4.qf = null, t4.IC = null, t4.EL = null, t4.HL = null, t4.Eg = null, t4.np = null, t4.Lx = null, t4.GC = null, t4.FL = null, t4.GL = null, t4.Tc = null, t4.HC = null, t4.gj = null;
    }(Q2 || (Q2 = {})), function(t4) {
      var i4 = function() {
        function t5() {
        }
        return t5.Mb = function(i5, s4) {
          return 0 <= s4 ? t5.R(i5) : -t5.R(i5);
        }, t5.R = function(t6) {
          return 0 > t6 ? -t6 : t6;
        }, t5.vi = function(t6) {
          return 3552713678800501e-30 > t6;
        }, t5.FC = function(i5, s4, n4) {
          return t5.R(i5 - s4) <= n4 * (1 + (t5.R(i5) + t5.R(s4)) / 2);
        }, t5.$ = function(i5, s4) {
          return t5.FC(i5, s4, 3552713678800501e-30);
        }, t5.AL = function(i5) {
          return 3552713678800501e-30 >= t5.R(i5);
        }, t5.Dd = function(i5) {
          return t5.AL(i5);
        }, t5;
      }();
      t4.s = i4, t4.F = function() {
        function s4() {
        }
        return s4.ip = function(t5, s5) {
          var n4 = 0;
          return (t5 = i4.R(t5)) + (s5 = i4.R(s5)) != 0 && (t5 > s5 ? (n4 = s5 / t5, n4 = t5 * Math.sqrt(1 + n4 * n4)) : (n4 = t5 / s5, n4 = s5 * Math.sqrt(1 + n4 * n4))), n4;
        }, s4.Yq = function(t5, n4, h3, r3, e3) {
          for (var o3 = [0, 0, 0], a3 = [0, 0, 0], u3 = 0; 2 >= u3; u3++)
            n4[u3] -= t5[u3], h3[u3] -= n4[u3];
          h3 = o3[1] * a3[2] - o3[2] * a3[1], n4 = o3[2] * a3[0] - o3[0] * a3[2], o3 = o3[0] * a3[1] - o3[1] * a3[0], t5 = -1 * (h3 * t5[0] + n4 * t5[1] + o3 * t5[2]), r3[0] = h3, r3[1] = n4, r3[2] = o3, r3[3] = t5, a3 = s4.qn(r3), r3[0] /= a3, r3[1] /= a3, r3[2] /= a3, r3[3] /= a3, e3 != 0 && (a3 = i4.Dd(o3) ? i4.Dd(t5) ? i4.Mb(1, n4) : -i4.Mb(1, t5) : i4.Mb(1, o3), a3 *= i4.Mb(1, e3), r3[0] *= a3, r3[1] *= a3, r3[2] *= a3, r3[3] *= a3);
        }, s4.yx = function(t5, i5, s5) {
          s5[0] = t5[1] * i5[2] - i5[1] * t5[2], s5[1] = t5[2] * i5[0] - i5[2] * t5[0], s5[2] = t5[0] * i5[1] - i5[0] * t5[1];
        }, s4.Ut = function(t5, i5) {
          return t5[0] * i5[0] + t5[1] * i5[1] + t5[2] * i5[2];
        }, s4.qn = function(t5) {
          return s4.ip(s4.ip(t5[0], t5[1]), t5[2]);
        }, s4.el = function(t5, i5, n4, h3, r3, e3, o3, a3) {
          t5 = s4.n(t5, i5, n4);
          var u3 = Math.cos(n4);
          e3.u = (t5 + r3) * u3 * Math.cos(h3), o3.u = (t5 + r3) * u3 * Math.sin(h3), a3.u = (t5 * (1 - i5) + r3) * Math.sin(n4);
        }, s4.eO = function(t5, n4, h3, r3, e3, o3, a3) {
          var u3 = s4.ip(n4, h3), f3 = 1 * Math.sqrt(1 - t5), c3 = f3 / 1;
          if (i4.$(u3, 0))
            o3.u = 0, e3.u = i4.Mb(1.570796326794897, r3), a3.u = i4.R(r3) - f3;
          else {
            o3.u = Math.atan2(h3, n4), h3 = Math.atan2(1 * r3, f3 * u3), o3 = Math.cos(h3);
            var l3 = Math.sin(h3);
            n4 = f3 * t5 / (1 - t5), t5 *= 1, h3 = Math.atan2(r3 + n4 * l3 * l3 * l3, u3 - t5 * o3 * o3 * o3), 3.141592653589793 < i4.R(h3) && (h3 = i4.Mb(3.141592653589793, h3) - h3), h3 = Math.atan(c3 * Math.tan(h3)), l3 = Math.sin(h3), o3 = Math.cos(h3), e3.u = Math.atan2(r3 + n4 * l3 * l3 * l3, u3 - t5 * o3 * o3 * o3), 1.570796326794897 < i4.R(e3.u) && (e3.u = i4.Mb(3.141592653589793, e3.u) - e3.u), h3 = Math.atan(c3 * Math.tan(e3.u)), l3 = Math.sin(h3), o3 = Math.cos(h3), a3.u = (r3 - f3 * l3) * Math.sin(e3.u) + (u3 - 1 * o3) * Math.cos(e3.u);
          }
        }, s4.n = function(t5, i5, s5) {
          return s5 = Math.sin(s5), t5 / Math.sqrt(1 - i5 * s5 * s5);
        }, s4.pt = function(t5, i5) {
          return Math.atan2(Math.sin(i5) * (1 - t5), Math.cos(i5));
        }, s4.Sj = function(t5, i5) {
          return Math.atan2(Math.sin(i5), Math.cos(i5) * (1 - t5));
        }, s4.Tq = function(t5, n4) {
          if (i4.vi(t5) || n4 == 0 || i4.$(i4.R(n4), 1.570796326794897))
            return n4;
          if (0.006884661117170036 > t5) {
            var h3 = Math.sqrt(1 - t5), r3 = (1 - h3) / (1 + h3), e3 = r3 * r3, o3 = r3 * e3, a3 = r3 * o3, u3 = r3 * a3, f3 = r3 * u3, c3 = r3 * f3, l3 = 1.572916666666667 * o3 - 3.2578125 * u3 + 4.295068359375 * c3;
            t5 = 2.142578125 * a3 - 6.071484375 * f3, h3 = 3.129296875 * u3 - 11.249837239583334 * c3;
            var p3 = 4.775276692708333 * f3, v3 = 7.958636765252976 * c3, y3 = Math.cos(2 * n4);
            return n4 + Math.sin(2 * n4) * (1.5 * r3 - 0.84375 * o3 + 0.525390625 * u3 - 0.2688395182291667 * c3 - l3 + h3 - v3 + y3 * (2 * (1.3125 * e3 - 1.71875 * a3 + 1.650146484375 * f3) - 4 * t5 + 6 * p3 + y3 * (4 * l3 - 12 * h3 + 24 * v3 + y3 * (8 * t5 - 32 * p3 + y3 * (16 * h3 - 80 * v3 + y3 * (32 * p3 + 64 * y3 * v3))))));
          }
          for (h3 = 1 - t5, r3 = t5 / 2, o3 = (e3 = i4.R(n4)) * s4.av(t5) / (1.570796326794897 * h3), a3 = 9999, f3 = e3, e3 = 0; 1e-16 < a3 && 50 > e3; e3++)
            c3 = s4.w(t5, f3), u3 = f3 - (l3 = (u3 = (s4.fG(f3, t5) - r3 * Math.sin(2 * f3) / c3) / h3 - o3) / (c3 = 1 / (c3 * c3 * c3))), a3 = i4.R(l3), f3 = u3;
          return 0 <= n4 ? f3 : -f3;
        }, s4.lW = function(t5, n4) {
          return i4.vi(n4) ? t5 : t5 * s4.av(n4) / 1.570796326794897;
        }, s4.ca = function(t5) {
          return 0 > (t5 = s4.kF(t5, 6.283185307179586)) ? t5 + 6.283185307179586 : 3.141592653589793 > i4.R(t5) || i4.$(i4.R(t5), 3.141592653589793) ? t5 : t5 - 6.283185307179586;
        }, s4.kF = function(t5, i5) {
          return t5 - Math.floor(t5 / i5) * i5;
        }, s4.Ch = function(t5, i5) {
          if (0.006884661117170036 > i5) {
            var n4 = (i5 = (1 - (i5 = Math.sqrt(1 - i5))) / (1 + i5)) * i5, h3 = n4 * n4;
            return t5 / (1 + i5) * (1 + 0.25 * n4 + 0.015625 * h3 + 390625e-8 * n4 * h3) * 1.570796326794897;
          }
          return t5 * s4.av(i5);
        }, s4.Xq = function(t5, n4) {
          var h3 = i4.Mb(1, Math.sin(n4));
          return n4 = 1.570796326794897 >= (n4 = i4.R(s4.kF(n4, 3.141592653589793))) ? n4 : 3.141592653589793 - n4, (i4.$(n4, 1.570796326794897) ? n4 : Math.atan(Math.sqrt(1 - t5) * Math.tan(n4))) * h3;
        }, s4.q = function(t5, i5, n4) {
          if (0.006884661117170036 > i5) {
            var h3 = (i5 = (1 - (i5 = Math.sqrt(1 - i5))) / (1 + i5)) * i5, r3 = i5 * h3, e3 = i5 * r3, o3 = i5 * e3, a3 = i5 * o3, u3 = i5 * a3, f3 = -0.7291666666666666 * r3 + 0.2278645833333333 * o3 + 0.03987630208333334 * u3, c3 = 0.615234375 * e3 - 0.21533203125 * a3, l3 = -0.54140625 * o3 + 0.20302734375 * u3, p3 = 0.48876953125 * a3, v3 = -0.4488699776785715 * u3, y3 = Math.cos(2 * n4);
            return t5 / (1 + i5) * ((1 + 0.25 * h3 + 0.015625 * e3 + 390625e-8 * a3) * n4 + Math.sin(2 * n4) * (-1.5 * i5 + 0.1875 * r3 + 0.0234375 * o3 + 0.00732421875 * u3 - f3 + l3 - v3 + y3 * (2 * (0.9375 * h3 - 0.234375 * e3 - 0.03662109375 * a3) - 4 * c3 + 6 * p3 + y3 * (4 * f3 - 12 * l3 + 24 * v3 + y3 * (8 * c3 - 32 * p3 + y3 * (16 * l3 - 80 * v3 + y3 * (32 * p3 + 64 * y3 * v3)))))));
          }
          return t5 * (s4.fG(n4, i5) - 0.5 * i5 * Math.sin(2 * n4) / s4.w(i5, n4));
        }, s4.w = function(t5, i5) {
          return i5 = Math.sin(i5), Math.sqrt(1 - t5 * i5 * i5);
        }, s4.av = function(t5) {
          return i4.FC(t5, 1, 2220446049250313e-31) ? 1 : 1 > t5 ? s4.Zw(0, 1 - t5) - t5 / 3 * s4.Ww(0, 1 - t5) : NaN;
        }, s4.fG = function(n4, h3) {
          var r3 = i4.Mb(1, n4);
          n4 = i4.R(n4);
          var e3 = Math.floor(n4 / 1.570796326794897);
          if (1 < h3)
            h3 = n4 == 0 ? 0 : NaN;
          else if (i4.Dd(e3))
            h3 = (n4 = s4.sin(n4)) * s4.Zw(1 - n4 * n4, 1 - h3 * n4 * n4) - h3 / 3 * n4 * n4 * n4 * s4.Ww(1 - n4 * n4, 1 - h3 * n4 * n4);
          else {
            var o3 = t4.P.truncate(e3 % 2), a3 = s4.av(h3);
            0 < o3 ? h3 = a3 * (e3 + 1) - (h3 = (n4 = Math.sin(1.570796326794897 * (e3 + 1) - n4)) * s4.Zw(1 - n4 * n4, 1 - h3 * n4 * n4) - h3 / 3 * n4 * n4 * n4 * s4.Ww(1 - n4 * n4, 1 - h3 * n4 * n4)) : h3 = a3 * e3 + (h3 = (n4 = Math.sin(n4 - 1.570796326794897 * e3)) * s4.Zw(1 - n4 * n4, 1 - h3 * n4 * n4) - h3 / 3 * n4 * n4 * n4 * s4.Ww(1 - n4 * n4, 1 - h3 * n4 * n4));
          }
          return h3 * r3;
        }, s4.sin = function(t5) {
          t5 = s4.ca(t5);
          var n4 = i4.Mb(1, t5);
          return t5 = i4.R(t5), i4.$(t5, 3.141592653589793) ? 0 : i4.$(t5, 1.570796326794897) ? 1 * n4 : Math.sin(t5) * n4;
        }, s4.Ww = function(t5, s5) {
          var n4, h3, r3, e3, o3 = t5, a3 = s5, u3 = 1;
          for (s5 = 0, t5 = 1; h3 = ((n4 = 0.2 * (o3 + a3 + 3 * u3)) - o3) / n4, r3 = (n4 - a3) / n4, e3 = (n4 - u3) / n4, !(1e-4 > i4.R(h3) && 1e-4 > i4.R(r3) && 1e-4 > i4.R(e3)); )
            e3 = Math.sqrt(a3), s5 += t5 / ((n4 = Math.sqrt(u3)) * (u3 + (e3 = Math.sqrt(o3) * (e3 + n4) + e3 * n4))), t5 *= 0.25, o3 = 0.25 * (o3 + e3), a3 = 0.25 * (a3 + e3), u3 = 0.25 * (u3 + e3);
          return a3 = (o3 = h3 * r3) - (u3 = e3 * e3), 3 * s5 + t5 * (1 + (u3 = o3 - 6 * u3) * (0.10227272727272728 * u3 - 0.2142857142857143 - 0.1730769230769231 * e3 * (h3 = u3 + a3 + a3)) + e3 * (0.1666666666666667 * h3 + e3 * (-0.4090909090909091 * a3 + 0.1153846153846154 * e3 * o3))) / (n4 * Math.sqrt(n4));
        }, s4.Zw = function(t5, s5) {
          for (var n4, h3, r3, e3, o3 = 1; h3 = 2 - ((n4 = (t5 + s5 + o3) / 3) + t5) / n4, r3 = 2 - (n4 + s5) / n4, e3 = 2 - (n4 + o3) / n4, !(1e-4 > i4.R(h3) && 1e-4 > i4.R(r3) && 1e-4 > i4.R(e3)); o3 = 0.25 * (o3 + n4))
            n4 = Math.sqrt(s5), h3 = Math.sqrt(o3), t5 = 0.25 * (t5 + (n4 = Math.sqrt(t5) * (n4 + h3) + n4 * h3)), s5 = 0.25 * (s5 + n4);
          return (1 + (0.04166666666666666 * (t5 = h3 * r3 - e3 * e3) - 0.1 - 0.06818181818181818 * (s5 = h3 * r3 * e3)) * t5 + 0.07142857142857142 * s5) / Math.sqrt(n4);
        }, s4.Sw = function(t5, s5) {
          if (i4.vi(t5) || s5 == 0 || i4.$(i4.R(s5), 1.570796326794897))
            return s5;
          if (0.006884661117170036 > t5) {
            var n4 = t5 * t5, h3 = t5 * n4, r3 = t5 * h3, e3 = t5 * r3, o3 = t5 * e3, a3 = t5 * o3, u3 = -(0.02708333333333333 * h3 + 0.03430059523809524 * r3 + 0.03149181547619048 * e3 + 0.02634359154541446 * o3 + 0.02156896735835538 * a3), f3 = 0.007669890873015873 * r3 + 0.01299603174603175 * e3 + 0.0148051353064374 * o3 + 0.01454454953803912 * a3, c3 = -(0.002275545634920635 * e3 + 0.004830845032667949 * o3 + 0.006558395368616723 * a3), l3 = 6957236677288761e-19 * o3 + 0.001775193002406544 * a3, p3 = -217324089394402e-18 * a3, v3 = Math.cos(2 * s5);
            return s5 + Math.sin(2 * s5) * (-(0.5 * t5 + 0.2083333333333333 * n4 + 0.09375 * h3 + 0.04878472222222222 * r3 + 0.02916666666666667 * e3 + 0.01938905423280423 * o3 + 0.01388255931712963 * a3) - u3 + c3 - p3 + v3 * (2 * (0.1041666666666667 * n4 + 0.0875 * h3 + 0.06050347222222222 * r3 + 0.04151785714285714 * e3 + 0.02958958540013228 * o3 + 0.02203667534722222 * a3) - 4 * f3 + 6 * l3 + v3 * (4 * u3 - 12 * c3 + 24 * p3 + v3 * (8 * f3 - 32 * l3 + v3 * (16 * c3 - 80 * p3 + v3 * (32 * l3 + 64 * v3 * p3))))));
          }
          return s5 == 0 || i4.$(i4.R(s5), 1.570796326794897) ? n4 = s5 : (r3 = (h3 = Math.sqrt(t5)) * Math.sin(s5), n4 = Math.tan(0.7853981633974483 + s5 / 2) * Math.pow((1 - r3) / (1 + r3), h3 / 2), n4 = 2 * Math.atan(n4) - 1.570796326794897), n4;
        }, s4.tO = function(t5, s5) {
          if (i4.vi(t5) || s5 == 0 || i4.$(i4.R(s5), 1.570796326794897))
            return s5;
          if (0.006884661117170036 > t5) {
            var n4 = t5 * (l3 = t5 * (c3 = t5 * (v3 = t5 * t5))), h3 = t5 * (p3 = t5 * n4), r3 = 0.05833333333333333 * c3 + 0.07232142857142858 * l3 + 0.05634300595238095 * n4 + 0.0355325796406526 * p3 + 0.020235546186067 * h3, e3 = 0.02653149801587302 * l3 + 0.04379960317460317 * n4 + 0.0429211791776896 * p3 + 0.03255384637546096 * h3, o3 = 0.01294022817460318 * n4 + 0.02668104344536636 * p3 + 0.03155651254609588 * h3, a3 = 0.00659454790965208 * p3 + 0.0163075268674227 * h3, u3 = 0.003463473736911237 * h3, f3 = Math.cos(2 * s5);
            return s5 + Math.sin(2 * s5) * (0.5 * t5 + 0.2083333333333333 * v3 + 0.08333333333333333 * c3 + 0.03611111111111111 * l3 + 0.01875 * n4 + 0.01195601851851852 * p3 + 0.008863673941798942 * h3 - r3 + o3 - u3 + f3 * (2 * (0.1458333333333333 * v3 + 0.1208333333333333 * c3 + 0.07039930555555556 * l3 + 0.03616071428571429 * n4 + 0.01839451058201058 * p3 + 0.01017113095238095 * h3) - 4 * e3 + 6 * a3 + f3 * (4 * r3 - 12 * o3 + 24 * u3 + f3 * (8 * e3 - 32 * a3 + f3 * (16 * o3 - 80 * u3 + f3 * (32 * a3 + 64 * f3 * u3))))));
          }
          var c3 = Math.sqrt(t5), l3 = c3 / 2, p3 = Math.tan(0.7853981633974483 + s5 / 2);
          t5 = 0, r3 = 1;
          for (var v3 = s5; r3 != 0; v3 = h3)
            n4 = c3 * Math.sin(v3), h3 = p3 * Math.pow((1 + n4) / (1 - n4), l3), h3 = 2 * Math.atan(h3) - 1.570796326794897, t5++, (i4.$(h3, v3) || 3e4 < t5) && (r3 = 0);
          return v3;
        }, s4;
      }();
    }(Q2 || (Q2 = {})), function(t4) {
      var i4 = function() {
        function i5(i6) {
          this.wl = this.Ws = null, this.Kv = false, this.BA = this.CA = 0, this.CH = new t4.h(), this.SH = new t4.h(), this.FA = false, this.xq = new t4.l(), this.rH = this.uw = 0, this.vw = null, this.Bl = false, this.Go = null, this.Xz = 0, this.Re = i6, this.Cs = t4.Ab.zv(this.Re, 0, true), this.CH.Sc(), this.SH.Sc(), this.MH = NaN;
          var s4 = i6.getCode();
          0 < s4 ? (this.Mk = s4, t4.qf.getCode(i6)) : this.Mk = t4.qf.getCode(i6), 0 > this.Mk && (this.Mk = 0);
          var n4 = this.Re.getType();
          if (this.eH = n4 == t4.Tc.PE_TYPE_PROJCS ? 2 : 1, n4 == t4.Tc.PE_TYPE_PROJCS && !i6.loadConstants())
            throw t4.i.O("PeProjcs.loadConstants failed");
          s4 = n4 == t4.Tc.PE_TYPE_GEOGCS ? this.Re : this.Re.getGeogcs(), n4 != t4.Tc.PE_TYPE_GEOGCS && t4.qf.getCode(s4), this.Go = i6.getUnit(), this.MH = s4.getPrimem().getLongitude(), this.rH = i6 = s4.getUnit().getUnitFactor(), i6 = Math.PI / (180 * i6), 1e-10 > Math.abs(i6 - 1) && (i6 = 1), this.BA = i6, (n4 & t4.Tc.PE_TYPE_PROJCS) != 0 ? (s4 = this.Re, this.CA = 1 / s4.getUnit().getUnitFactor(), this.uw = 1e-3 / this.Re.getUnit().getUnitFactor(), this.vw = t4.Eg.generate(s4, t4.Eg.PE_PCSINFO_OPTION_NONE), this.Bl = this.vw.isPannableRectangle(), this.Xz = t4.Ab.lN(this.vw.getCentralMeridian(), this.BA)) : (this.FA = this.Bl = true, this.CA = 0, n4 = 1 / s4.getUnit().getUnitFactor(), this.uw = 1e-3 / s4.getDatum().getSpheroid().getAxis() * n4, this.Xz = 0), this.Bl && (this.wx(), this.yK(), this.jY(), this.xK(), this.hY(), this.iY());
        }
        return i5.prototype.cs = function() {
          return this.Mk;
        }, i5.prototype.mk = function() {
          return this.vw;
        }, i5.Ky = function(t5, i6) {
          return t5 == i6 || t5 != null && i6 != null && t5.Mk == 0 && i6.Mk == 0 && t5.Cs === i6.Cs;
        }, i5.prototype.Xc = function() {
          return this.Bl;
        }, i5.prototype.ih = function(t5) {
          t5.L(this.uo);
        }, i5.prototype.rv = function() {
          return this.uo.v;
        }, i5.prototype.qv = function() {
          return this.uo.C;
        }, i5.prototype.BR = function(t5) {
          t5.L(this.ww);
        }, i5.prototype.hY = function() {
          var i6 = this.Re.getType();
          if (i6 == t4.Tc.PE_TYPE_PROJCS) {
            i6 = this.Re;
            var s4 = this.mk().getCentralMeridian(), n4 = i6.getGeogcs();
            if (n4 == null)
              throw t4.i.ga("internal error");
            s4 = [[s4 + (n4 = 1 / n4.getUnit().getUnitFactor() * Math.PI), 0]], t4.gj.geogToProj(i6, 1, s4), s4 = s4[0][0], n4 = i6.getParameters()[t4.Tc.PE_PARM_X0].getValue();
            var h3 = this.ol();
            i6 = new t4.l(), h3.A(i6), s4 = (h3 = Math.abs(s4 - n4)) + n4, n4 = -1 * h3 + n4, h3 = i6.H, i6 = i6.G;
            var r3 = new t4.l();
            r3.L(n4, i6, s4, h3), this.uo == null && (this.uo = r3);
          } else {
            if (i6 != t4.Tc.PE_TYPE_GEOGCS)
              throw t4.i.ga("internal error");
            n4 = 1 / this.Re.getUnit().getUnitFactor() * Math.PI, (i6 = new t4.l()).L(-n4, -n4 / 2, n4, n4 / 2), this.uo == null && (this.uo = i6);
          }
        }, i5.prototype.iY = function() {
          var i6 = this.Re.getType();
          if (i6 == t4.Tc.PE_TYPE_PROJCS) {
            var s4 = this.Re;
            if (i6 = this.mk().getCentralMeridian(), (s4 = s4.getGeogcs()) == null)
              throw t4.i.ga("internal error");
            s4 = 1 / s4.getUnit().getUnitFactor() * Math.PI;
            var n4 = this.Xr(), h3 = new t4.l();
            n4.A(h3), (n4 = new t4.l()).L(i6 - s4, h3.G, i6 + s4, h3.H), this.ww == null && (this.ww = n4);
          } else {
            if (i6 != t4.Tc.PE_TYPE_GEOGCS)
              throw t4.i.ga("internal error");
            s4 = 1 / this.Re.getUnit().getUnitFactor() * Math.PI, (i6 = new t4.l()).L(-s4, -s4 / 2, s4, s4 / 2), this.ww == null && (this.ww = i6);
          }
        }, i5.prototype.bf = function() {
          return this.BA;
        }, i5.prototype.rm = function() {
          return this.CA;
        }, i5.prototype.Xr = function() {
          if (this.Bl)
            return this.wl;
          var t5 = this.wl;
          return t5 != null ? t5 : (this.wx(), this.wl);
        }, i5.prototype.Yr = function() {
          return this.Bl ? null : (this.wl != null || this.wx(), this.TG);
        }, i5.prototype.wx = function() {
          if (this.Re.getType() == t4.Tc.PE_TYPE_PROJCS) {
            var i6 = this.Re, s4 = i6.getGeogcs(), n4 = i6.horizonGcsGenerate();
            if (n4 != null) {
              var h3 = n4[0].getNump(), r3 = n4[0].getKind();
              i6 = 0 < n4[0].getInclusive();
              var e3 = this.bf(), o3 = 90 * e3, a3 = 360 * e3, u3 = 370 * e3, f3 = 180 * e3 * t4.Tc.PE_HORIZON_DELTA / Math.PI, c3 = new t4.l(), l3 = null;
              if (1 < h3) {
                for (var p3 = 1; p3 < h3; p3++)
                  if (n4[p3].getKind() == t4.Tc.PE_HORIZON_LINE) {
                    l3 == null && (l3 = new t4.Ua());
                    var v3 = n4[p3].getCoord();
                    l3.rx(v3[0][0], v3[0][1]), l3.Aj(v3[1][0], v3[1][1]);
                  }
              }
              if (r3 == t4.Tc.PE_HORIZON_RECT)
                n4 = n4[0].getCoord(), c3.L(n4[0][0], n4[0][1]), c3.$b(n4[1][0], n4[1][1]), Math.abs(c3.H - o3) < 1e-7 * f3 && (c3.H = o3), Math.abs(c3.G + o3) < 1e-7 * f3 && (c3.G = -o3), c3.S() > u3 && (n4 = -400 * e3, c3.L(n4, c3.G, n4 + 5 * a3, c3.H)), n4 = new t4.Hh(c3), this.wl == null && (this.wl = n4, this.Kv = i6);
              else {
                if (u3 = new t4.Ea(), a3 = this.mk().isGcsHorizonMultiOverlap(), c3 = t4.iu.XE(s4, t4.ju.Integer64), a3) {
                  for (u3 = new t4.bL(), f3 = t4.Ih.local().W(u3, c3, null), p3 = 0; p3 < h3; p3++)
                    if (n4[p3].getKind() == t4.Tc.PE_HORIZON_POLY) {
                      for (s4 = n4[p3].getSize(), e3 = n4[p3].getCoord(), r3 = [], o3 = 0; o3 < s4; o3++)
                        r3[o3] = t4.h.construct(e3[o3][0], e3[o3][1]);
                      n4[p3].getInclusive(), a3 && ((e3 = new t4.Ea()).$k(r3, s4 - 1), u3.VX(e3), f3.re());
                    }
                  u3 = f3.next();
                } else
                  for (p3 = 0; p3 < h3; p3++)
                    if (n4[p3].getKind() == t4.Tc.PE_HORIZON_POLY) {
                      for (s4 = n4[p3].getSize(), e3 = n4[p3].getCoord(), a3 = [], o3 = 0; o3 < s4; o3++)
                        a3[o3] = t4.h.construct(e3[o3][0], e3[o3][1]);
                      n4[p3].getInclusive(), u3.$k(a3, s4 - 1);
                    }
                i6 ? t4.Zj.local().yn(u3, c3, 1) : t4.mp.local().yn(u3, c3, 1), t4.fj.local().yn(u3, c3, 1), this.wl == null && (this.wl = u3, this.Kv = i6, this.TG = l3);
              }
            }
          }
        }, i5.prototype.kv = function() {
          return this.Bl || this.wl == null && this.wx(), this.Kv;
        }, i5.prototype.yK = function() {
          if (this.eH == 2) {
            var i6 = this.Re.horizonPcsGenerate();
            if (i6 != null) {
              var s4 = i6[0].getKind();
              i6[0].getInclusive();
              var n4 = i6[0].getNump(), h3 = false;
              if (s4 == t4.Tc.PE_HORIZON_RECT)
                i6 = i6[0].getCoord(), (n4 = new t4.l()).L(i6[0][0], i6[0][1]), n4.$b(i6[1][0], i6[1][1]), i6 = new t4.Hh(n4);
              else {
                for (s4 = -1, h3 = 0; h3 < n4; h3++)
                  i6[h3].getKind() == t4.Tc.PE_HORIZON_POLY && (s4 = h3);
                for (h3 = i6[s4].getSize() - 1, i6 = i6[s4].getCoord(), n4 = [], s4 = 0; s4 < h3; s4++)
                  n4[s4] = t4.h.construct(i6[s4][0], i6[s4][1]);
                i6 = s4 = new t4.Ea(), s4.$k(n4, h3), h3 = true;
              }
              this.mk().isDensificationNeeded() && (n4 = 1e5 * this.rm(), i6 = t4.Zl.local().W(i6, n4, null)), h3 && (h3 = new t4.Hh(), i6.dn(h3), i6.He(), i6.Rb(), i6.kR(), t4.Zj.local().yn(i6, null, 1)), this.Ws == null && (this.Ws = i6);
            }
          }
        }, i5.prototype.ol = function() {
          if (this.Bl)
            return this.Ws;
          var t5 = this.Ws;
          return t5 != null ? t5 : (this.yK(), this.Ws);
        }, i5.prototype.jY = function() {
          if (this.Re.getType() == t4.Tc.PE_TYPE_PROJCS) {
            var i6 = 90 * this.bf();
            i6 = [[0, i6], [0, -i6]], t4.gj.geogToProj(this.Re, 2, i6);
            var s4 = this.mk(), n4 = s4.getNorthPoleLocation() != t4.Eg.PE_POLE_OUTSIDE_BOUNDARY;
            s4 = s4.getSouthPoleLocation() != t4.Eg.PE_POLE_OUTSIDE_BOUNDARY, this.FA || (n4 && this.CH.na(i6[0][0], i6[0][1]), s4 && this.SH.na(i6[1][0], i6[1][1]));
          }
          this.FA = true;
        }, i5.prototype.xK = function() {
          if (this.eH == 1) {
            var i6 = 400 * this.bf();
            this.xq.L(-i6, -i6, i6, i6);
          } else
            i6 = t4.Eg.generate(this.Re, t4.Eg.PE_PCSINFO_OPTION_DOMAIN), i6 = t4.l.construct(i6.getDomainMinx(), i6.getDomainMiny(), i6.getDomainMaxx(), i6.getDomainMaxy()), this.xq.B() && this.xq.L(i6);
        }, i5.prototype.cR = function(t5) {
          this.Bl && t5.L(this.xq), this.xq.B() && this.xK(), t5.L(this.xq);
        }, i5.prototype.Wp = function() {
          return this.MH;
        }, i5.prototype.Bi = function() {
          return this.Xz;
        }, i5.prototype.Id = function() {
          return this.Go;
        }, i5.prototype.Zr = function() {
          return this.rH;
        }, i5;
      }();
      t4.JC = i4;
    }(Q2 || (Q2 = {})), function(t4) {
      var i4 = function() {
        function i5(i6) {
          this.FT = i6, this.Cs = t4.Ab.zv(i6, 0, true);
          var s4 = i6.getCode();
          this.us = 0 < s4 ? s4 : t4.qf.getCode(i6), 0 > this.us && (this.us = 0), this.Go = s4 = this.FT.getUnit(), this.DH = 1 / s4.getUnitFactor(), t4.qf.getCode(i6);
        }
        return i5.Ky = function(t5, i6) {
          return t5 == i6 || t5 != null && i6 != null && t5.us == 0 && i6.us == 0 && t5.Cs === i6.Cs;
        }, i5.prototype.cs = function() {
          return this.us;
        }, i5;
      }();
      t4.KL = i4;
    }(Q2 || (Q2 = {})), function(t4) {
      t4.$g = function() {
        function i4() {
        }
        return i4.ub = function(i5, s4, n4, h3, r3, e3, o3, a3) {
          if (e3 != null || o3 != null || a3 != null) {
            h3 = t4.F.ca(h3), s4 = t4.F.ca(s4), n4 = t4.F.ca(n4), r3 = t4.F.ca(r3), 1.570796326794897 < t4.s.R(n4) && (n4 = t4.s.Mb(3.141592653589793, n4) - n4, s4 = t4.F.ca(s4 + 3.141592653589793)), 1.570796326794897 < t4.s.R(r3) && (r3 = t4.s.Mb(3.141592653589793, r3) - r3, h3 = t4.F.ca(h3 + 3.141592653589793));
            var u3 = t4.F.ca(h3 - s4);
            if (t4.s.$(n4, r3) && (t4.s.$(s4, h3) || t4.s.$(t4.s.R(n4), 1.570796326794897)))
              e3 != null && (e3.u = 0), o3 != null && (o3.u = 0), a3 != null && (a3.u = 0);
            else {
              if (t4.s.$(n4, -r3)) {
                if (t4.s.$(t4.s.R(n4), 1.570796326794897))
                  return e3 != null && (e3.u = 3.141592653589793 * i5), o3 != null && (o3.u = 0 < n4 ? t4.F.ca(3.141592653589793 - t4.F.ca(h3)) : t4.F.ca(h3)), void (a3 != null && (a3.u = 0 < n4 ? t4.F.ca(h3) : t4.F.ca(3.141592653589793 - t4.F.ca(h3))));
                if (t4.s.$(t4.s.R(u3), 3.141592653589793))
                  return e3 != null && (e3.u = 3.141592653589793 * i5), o3 != null && (o3.u = 0), void (a3 != null && (a3.u = 0));
              }
              var f3 = t4.s.R(n4) == 1.570796326794897 ? 0 : Math.cos(n4), c3 = Math.sin(n4), l3 = t4.s.R(r3) == 1.570796326794897 ? 0 : Math.cos(r3), p3 = Math.sin(r3), v3 = t4.s.R(u3) == 1.570796326794897 ? 0 : Math.cos(u3), y3 = t4.s.R(u3) == 3.141592653589793 ? 0 : Math.sin(u3);
              if (e3 != null) {
                var b3 = Math.sin((r3 - n4) / 2);
                u3 = Math.sin(u3 / 2), e3.u = 2 * Math.asin(Math.sqrt(b3 * b3 + f3 * l3 * u3 * u3)) * i5;
              }
              o3 != null && (o3.u = t4.s.$(t4.s.R(n4), 1.570796326794897) ? 0 > n4 ? h3 : t4.F.ca(3.141592653589793 - h3) : Math.atan2(l3 * y3, f3 * p3 - c3 * l3 * v3)), a3 != null && (t4.s.$(t4.s.R(r3), 1.570796326794897) ? a3.u = 0 > r3 ? s4 : t4.F.ca(3.141592653589793 - s4) : (a3.u = Math.atan2(f3 * y3, p3 * f3 * v3 - l3 * c3), a3.u = t4.F.ca(a3.u + 3.141592653589793)));
            }
          }
        }, i4.sf = function(i5, s4, n4, h3, r3, e3, o3) {
          if (e3 != null || o3 != null) {
            s4 = t4.F.ca(s4), n4 = t4.F.ca(n4), 1.570796326794897 < t4.s.R(n4) && (n4 = t4.s.Mb(3.141592653589793, n4) - n4, s4 = t4.F.ca(s4 + 3.141592653589793)), t4.s.$(t4.s.R(n4), 1.570796326794897) && (s4 = 0), r3 = t4.F.ca(r3);
            var a3 = t4.s.$(t4.s.R(r3), 1.570796326794897) ? 0 : Math.cos(r3), u3 = t4.s.$(t4.s.R(r3), 3.141592653589793) ? 0 : Math.sin(r3), f3 = t4.s.$(t4.s.R(n4), 1.570796326794897) ? 0 : Math.cos(n4), c3 = Math.sin(n4);
            i5 = h3 / i5, h3 = t4.s.$(t4.s.R(i5), 1.570796326794897) ? 0 : Math.cos(i5);
            var l3 = t4.s.$(t4.s.R(i5), 3.141592653589793) ? 0 : Math.sin(i5), p3 = Math.asin(c3 * h3 + f3 * l3 * a3);
            o3 != null && (o3.u = p3), e3 != null && (e3.u = t4.s.$(t4.s.R(p3), 1.570796326794897) ? t4.s.$(n4, -p3) ? 0 > p3 ? r3 : t4.F.ca(3.141592653589793 - r3) : s4 : t4.s.$(t4.s.R(n4), 1.570796326794897) && t4.s.$(i5, 3.141592653589793) ? 0 > n4 ? r3 : t4.F.ca(3.141592653589793 - r3) : t4.F.ca(s4 + Math.atan2(l3 * u3, f3 * h3 - c3 * l3 * a3)));
          }
        }, i4;
      }();
    }(Q2 || (Q2 = {})), function(t4) {
      t4.Yk = function() {
        function i4() {
        }
        return i4.ub = function(i5, s4, n4, h3, r3, e3, o3, a3, u3) {
          var f3 = new t4.ha(0), c3 = new t4.ha(0), l3 = [0, 0, 0], p3 = [0, 0, 0], v3 = [0, 0, 0], y3 = new t4.ha(0), b3 = new t4.ha(0), d3 = new t4.ha(0), g3 = new t4.ha(0), w3 = new t4.ha(0);
          if (o3 != null || a3 != null || u3 != null)
            if (t4.s.vi(s4))
              t4.$g.ub(i5, n4, h3, r3, e3, o3, a3, u3);
            else {
              r3 = t4.F.ca(r3), n4 = t4.F.ca(n4);
              var x3 = t4.F.ca(r3 - n4);
              if (t4.s.$(h3, e3) && (t4.s.$(n4, r3) || t4.s.$(t4.s.R(h3), 1.570796326794897)))
                o3 != null && (o3.u = 0), a3 != null && (a3.u = 0), u3 != null && (u3.u = 0);
              else {
                if (t4.s.$(h3, -e3)) {
                  if (t4.s.$(t4.s.R(h3), 1.570796326794897))
                    return o3 != null && (o3.u = 2 * t4.F.Ch(i5, s4)), a3 != null && (a3.u = 0 < h3 ? t4.F.ca(3.141592653589793 - t4.F.ca(r3)) : t4.F.ca(r3)), void (u3 != null && (u3.u = 0 < h3 ? t4.F.ca(r3) : t4.F.ca(3.141592653589793 - t4.F.ca(r3))));
                  t4.s.$(t4.s.R(x3), 3.141592653589793) && (o3 != null && (o3.u = 2 * t4.F.Ch(i5, s4)), a3 != null && (a3.u = 0), u3 != null && (u3.u = 0));
                } else
                  (t4.s.$(t4.s.R(h3), 1.570796326794897) || t4.s.$(t4.s.R(e3), 1.570796326794897)) && (t4.s.$(t4.s.R(h3), 1.570796326794897) ? n4 = r3 : r3 = n4);
                var m3 = 0;
                if (0 > x3) {
                  m3 = 1;
                  var j3 = n4;
                  n4 = r3, r3 = j3, j3 = h3, h3 = e3, e3 = j3;
                }
                x3 = t4.F.pt(s4, h3);
                var M3 = t4.F.pt(s4, e3);
                a3 == null && u3 == null || (t4.$g.ub(i5, n4, x3, r3, M3, null, f3, c3), f3 = Math.atan2(Math.sin(f3.u) * Math.cos(h3 - x3), Math.cos(f3.u)), c3 = Math.atan2(Math.sin(c3.u) * Math.cos(e3 - M3), Math.cos(c3.u)), m3 != 0 && (j3 = f3, f3 = c3, c3 = j3), a3 != null && (a3.u = f3), u3 != null && (u3.u = c3)), o3 != null && (t4.F.el(1, s4, h3, n4, 0, d3, g3, w3), l3[0] = d3.u, l3[1] = g3.u, l3[2] = w3.u, t4.F.el(1, s4, e3, r3, 0, d3, g3, w3), p3[0] = d3.u, p3[1] = g3.u, p3[2] = w3.u, v3[0] = l3[1] * p3[2] - p3[1] * l3[2], v3[1] = -(l3[0] * p3[2] - p3[0] * l3[2]), v3[2] = l3[0] * p3[1] - p3[0] * l3[1], s4 = 1 - t4.F.w(s4, t4.F.Xq(s4, t4.F.Sj(s4, Math.acos(v3[2] / Math.sqrt(v3[0] * v3[0] + v3[1] * v3[1] + v3[2] * v3[2]))))), s4 *= 2 - s4, a3 = Math.atan2(-v3[1], -v3[0]), v3 = t4.F.ca(a3 - 1.570796326794897), a3 = t4.F.ca(a3 + 1.570796326794897), v3 = t4.s.R(t4.F.ca(n4 - v3)) <= t4.s.R(t4.F.ca(n4 - a3)) ? v3 : a3, t4.$g.ub(1, v3, 0, n4, x3, y3, null, null), t4.$g.ub(1, v3, 0, r3, M3, b3, null, null), 3.141592653589793 < y3.u + b3.u && (v3 = t4.F.ca(v3 + 3.141592653589793), t4.$g.ub(1, v3, 0, n4, x3, y3, null, null), t4.$g.ub(1, v3, 0, r3, M3, b3, null, null)), y3.u *= t4.s.Mb(1, h3), b3.u *= t4.s.Mb(1, e3), y3.u = t4.F.Sj(s4, y3.u), b3.u = t4.F.Sj(s4, b3.u), n4 = t4.F.q(i5, s4, y3.u), i5 = t4.F.q(i5, s4, b3.u), o3.u = t4.s.R(i5 - n4));
              }
            }
        }, i4.sf = function(i5, s4, n4, h3, r3, e3, o3, a3) {
          var u3 = 0, f3 = new t4.ha(0), c3 = new t4.ha(0), l3 = [0, 0, 0], p3 = [0, 0, 0], v3 = new t4.ha(0), y3 = new t4.ha(0), b3 = new t4.ha(0);
          if (o3 != null || a3 != null)
            if (t4.s.vi(s4))
              t4.$g.sf(i5, n4, h3, r3, e3, o3, a3);
            else if (t4.s.Dd(r3))
              o3 != null && (o3.u = n4), a3 != null && (a3.u = h3);
            else if (e3 = t4.F.ca(e3), 0 > r3 && (r3 = t4.s.R(r3), e3 = t4.F.ca(e3 + 3.141592653589793)), n4 = t4.F.ca(n4), h3 = t4.F.ca(h3), 1.570796326794897 < t4.s.R(h3) && (n4 = t4.F.ca(n4 + 3.141592653589793), h3 = t4.s.Mb(3.141592653589793, h3) - h3), t4.s.$(t4.s.R(h3), 1.570796326794897) && (n4 = 0), t4.s.Dd(h3)) {
              var d3 = t4.s.R(1.570796326794897 - t4.s.R(e3));
              d3 = t4.F.Sj(s4, d3), d3 = 1 - t4.F.w(s4, t4.F.Xq(s4, d3)), d3 *= 2 - d3, i5 = r3 / t4.F.Ch(i5, d3) * 1.570796326794897, i5 = t4.F.Tq(d3, i5), i5 = t4.F.pt(d3, i5), t4.$g.sf(1, n4, h3, i5, e3, o3, f3), a3 != null && (u3 = f3.u), a3 != null && (a3.u = t4.F.Sj(s4, u3));
            } else if (t4.s.$(t4.s.R(h3), 1.570796326794897))
              f3 = 2 * (u3 = t4.F.Ch(i5, s4)), e3 = 0 < (i5 = t4.s.Mb(1.570796326794897, h3)) ? t4.F.ca(3.141592653589793 - e3) : e3, h3 = u3 - r3, t4.s.R(h3) <= u3 ? o3 != null && (o3.u = e3) : (h3 = Math.floor(r3 / f3), t4.P.truncate(h3 % 2) == 0 ? (o3 != null && (o3.u = e3), r3 -= h3 * f3) : (o3 != null && (o3.u = t4.F.ca(e3 + 3.141592653589793)), r3 = (h3 + 1) * f3 - r3), h3 = u3 - r3), a3 != null && (a3.u = t4.F.Tq(s4, h3 / u3 * i5));
            else {
              d3 = t4.F.pt(s4, h3), e3 = Math.atan2(Math.sin(e3), Math.cos(e3) * Math.cos(h3 - d3));
              var g3 = t4.P.truncate(t4.s.Mb(1, d3)) * (1.570796326794897 >= t4.s.R(e3) ? 1 : -1);
              e3 = t4.F.ca(n4 + Math.atan(Math.tan(e3) * -Math.sin(d3))), t4.$g.ub(i5, e3, 0, n4, d3, null, c3, null), d3 = t4.s.R(1.570796326794897 - t4.s.R(c3.u)), d3 = t4.F.Sj(s4, d3), d3 = 1 - t4.F.w(s4, t4.F.Xq(s4, d3)), d3 *= 2 - d3, t4.F.el(1, s4, 0, e3, 0, v3, y3, b3), l3[0] = v3.u, l3[1] = y3.u, l3[2] = b3.u, t4.F.el(1, s4, h3, n4, 0, v3, y3, b3), p3[0] = v3.u, p3[1] = y3.u, p3[2] = b3.u, h3 = Math.acos((l3[0] * p3[0] + l3[1] * p3[1] + l3[2] * p3[2]) / Math.sqrt(p3[0] * p3[0] + p3[1] * p3[1] + p3[2] * p3[2])), h3 = t4.F.Sj(d3, h3), r3 = 0 < (h3 = t4.F.q(i5, d3, h3) + r3 * g3) ? c3.u : t4.F.ca(c3.u + 3.141592653589793), i5 = t4.s.R(h3) / t4.F.Ch(i5, d3) * 1.570796326794897, i5 = t4.F.Tq(d3, i5), i5 = t4.F.pt(d3, i5), t4.$g.sf(1, e3, 0, i5, r3, o3, f3), a3 != null && (u3 = f3.u), a3 != null && (a3.u = t4.F.Sj(s4, u3));
            }
        }, i4;
      }();
    }(Q2 || (Q2 = {})), function(t4) {
      t4.eu = function() {
        function i4() {
        }
        return i4.ub = function(i5, s4, n4, h3, r3, e3, o3, a3, u3) {
          var f3 = 0, c3 = 0, l3 = 0;
          if (o3 != null || a3 != null || u3 != null)
            if (t4.s.vi(s4))
              t4.$g.ub(i5, n4, h3, r3, e3, o3, a3, u3);
            else {
              var p3 = t4.F.ca(r3 - n4);
              if (t4.s.$(h3, e3) && (t4.s.Dd(p3) || t4.s.$(t4.s.R(h3), 1.570796326794897)))
                o3 != null && (o3.u = 0), a3 != null && (a3.u = 0), u3 != null && (u3.u = 0);
              else {
                if (t4.s.$(h3, -e3)) {
                  if (t4.s.$(t4.s.R(h3), 1.570796326794897))
                    return o3 != null && (o3.u = 2 * t4.F.Ch(i5, s4)), a3 != null && (a3.u = 0 < h3 ? t4.F.ca(3.141592653589793 - t4.F.ca(r3)) : t4.F.ca(r3)), void (u3 != null && (u3.u = 0 < h3 ? t4.F.ca(r3) : t4.F.ca(3.141592653589793 - t4.F.ca(r3))));
                  t4.s.$(t4.s.R(p3), 3.141592653589793) && (o3 != null && (o3.u = 2 * t4.F.Ch(i5, s4)), a3 != null && (a3.u = 0), u3 != null && (u3.u = 0));
                } else {
                  if (t4.s.$(t4.s.R(h3), 1.570796326794897) || t4.s.$(t4.s.R(e3), 1.570796326794897))
                    return void t4.Yk.ub(i5, s4, n4, h3, r3, e3, o3, a3, u3);
                  if (t4.s.Dd(p3) || t4.s.$(t4.s.R(p3), 3.141592653589793))
                    return void t4.Yk.ub(i5, s4, n4, h3, r3, e3, o3, a3, u3);
                }
                var v3 = 1 - Math.sqrt(1 - s4), y3 = s4 / (1 - s4), b3 = i5 * (1 - v3);
                i5 = t4.F.Xq(s4, h3);
                var d3 = t4.F.Xq(s4, e3);
                s4 = t4.s.R(i5) == 1.570796326794897 ? 0 : Math.cos(i5);
                var g3 = Math.sin(i5), w3 = t4.s.R(d3) == 1.570796326794897 ? 0 : Math.cos(d3), x3 = Math.sin(d3), m3 = p3, j3 = Math.cos(m3), M3 = Math.sin(m3), k3 = 1, z3 = 0;
                do {
                  var A3 = m3, N3 = Math.sqrt(Math.pow(w3 * M3, 2) + Math.pow(s4 * x3 - g3 * w3 * j3, 2)), I3 = g3 * x3 + s4 * w3 * j3, P3 = Math.atan2(N3, I3);
                  if (N3 == 0) {
                    k3 = 0;
                    break;
                  }
                  var C3 = s4 * w3 * M3 / N3;
                  if (f3 = Math.cos(Math.asin(C3)), c3 = I3 - 2 * g3 * x3 / (f3 *= f3), 1 < t4.s.R(c3) && (c3 = t4.s.Mb(1, c3)), m3 = p3 + (1 - (m3 = v3 / 16 * f3 * (4 + v3 * (4 - 3 * f3)))) * v3 * C3 * (P3 + m3 * N3 * (c3 + m3 * I3 * (2 * (l3 = c3 * c3) - 1))), j3 = Math.cos(m3), M3 = Math.sin(m3), z3++, 3.141592653589793 < t4.s.R(m3) && 30 < z3) {
                    k3 = 0;
                    break;
                  }
                } while (5e3 >= z3 && !t4.s.$(A3, m3));
                if (k3 != 0)
                  v3 = (y3 *= f3) * (256 + y3 * (y3 * (74 - 47 * y3) - 128)) / 1024, o3 != null && (o3.u = b3 * (1 + y3 * (4096 + y3 * (y3 * (320 - 175 * y3) - 768)) / 16384) * (P3 - v3 * N3 * (c3 + v3 / 4 * (I3 * (2 * l3 - 1) - v3 / 6 * c3 * (4 * N3 * N3 - 3) * (4 * l3 - 3))))), a3 != null && (a3.u = t4.s.$(t4.s.R(h3), 1.570796326794897) ? 0 > h3 ? r3 : t4.F.ca(3.141592653589793 - r3) : Math.atan2(w3 * M3, s4 * x3 - g3 * w3 * j3)), u3 != null && (t4.s.$(t4.s.R(e3), 1.570796326794897) ? u3.u = 0 > e3 ? n4 : t4.F.ca(3.141592653589793 - n4) : (u3.u = Math.atan2(s4 * M3, s4 * x3 * j3 - g3 * w3), u3.u = t4.F.ca(u3.u + 3.141592653589793)));
                else {
                  m3 = t4.s.Mb(3.141592653589793, p3), I3 = g3 * x3 - s4 * w3, P3 = Math.acos(I3), N3 = Math.sin(P3), f3 = 1, z3 = C3 = 0;
                  do {
                    l3 = C3, j3 = 1 - 0.25 * (C3 = v3 * (f3 *= f3) * (1 + v3 + v3 * v3)) + 0.1875 * (c3 = v3 * v3 * (j3 = f3 * f3) * (1 + 2.25 * v3)) - 0.1953125 * (k3 = v3 * v3 * v3 * j3 * f3), C3 = 0.25 * C3 - 0.25 * c3 + 0.29296875 * k3, M3 = 0.03125 * c3 - 0.05859375 * k3, k3 *= 0.00651041666666667, c3 = I3 - 2 * g3 * x3 / f3, 1 < t4.s.R(c3) && (c3 = t4.s.Mb(1, c3)), f3 = Math.acos(c3), I3 = Math.cos(2 * f3), A3 = Math.cos(3 * f3), M3 = (C3 = t4.s.$(h3, -e3) ? t4.F.ca(3.141592653589793 - p3) / (3.141592653589793 * v3 * j3) : t4.F.ca(m3 - p3) / (v3 * (j3 * P3 + C3 * N3 * c3 + M3 * Math.sin(2 * P3) * I3 + k3 * Math.sin(3 * P3) * A3))) * N3 / (s4 * w3), m3 = 1.570796326794897 < t4.s.R(p3) ? t4.s.Mb(3.141592653589793, M3) - Math.asin(M3) : Math.asin(M3), j3 = Math.cos(m3), N3 = Math.sqrt(Math.pow(w3 * M3, 2) + Math.pow(s4 * x3 - g3 * w3 * j3, 2)), P3 = 3.141592653589793 - Math.asin(t4.s.R(N3)), I3 = Math.cos(P3), f3 = Math.cos(Math.asin(C3)), z3++;
                  } while (70 >= z3 && !t4.s.$(l3, C3));
                  o3 != null && (j3 = 1 + (y3 *= f3 *= f3) * (4096 + y3 * (y3 * (320 - 175 * y3) - 768)) / 16384, t4.s.$(h3, -e3) ? o3.u = 3.141592653589793 * b3 * j3 : (c3 = I3 - 2 * g3 * x3 / f3, f3 = Math.acos(c3), I3 = Math.cos(2 * f3), A3 = Math.cos(3 * f3), o3.u = b3 * (j3 * P3 + y3 * (y3 * (128 + y3 * (35 * y3 - 60)) - 512) / 2048 * N3 * c3 + y3 * (5 * y3 - 4) / 6144 * y3 * y3 * Math.sin(2 * P3) * I3 + k3 * Math.sin(3 * P3) * A3 + -762939453125e-16 * y3 * y3 * y3 * y3 * Math.sin(4 * P3) * Math.cos(4 * f3)))), a3 != null && (t4.s.Dd(h3) && t4.s.Dd(e3) ? (f3 = Math.sqrt(1 - C3 * C3), a3.u = Math.acos(f3), 0 > p3 && (a3.u *= -1)) : t4.s.$(t4.s.R(h3), 1.570796326794897) ? a3.u = 0 > h3 ? r3 : t4.F.ca(3.141592653589793 - r3) : (o3 = C3 / s4, b3 = Math.sqrt(1 - o3 * o3), 0 > s4 * x3 - g3 * w3 * Math.cos(m3) && (b3 *= -1), a3.u = Math.atan2(o3, b3), t4.s.$(h3, -e3) && t4.s.R(t4.F.ca(n4 - r3)) > 3.141592653589793 * (1 - v3 * Math.cos(h3)) && (0 < h3 && 1.570796326794897 > t4.s.R(a3.u) || 0 > h3 && 1.570796326794897 < t4.s.R(a3.u)) && (a3.u = t4.s.Mb(3.141592653589793, a3.u) - a3.u))), u3 != null && (t4.s.Dd(h3) && t4.s.Dd(e3) ? (f3 = Math.sqrt(1 - C3 * C3), u3.u = Math.acos(f3), 0 <= p3 && (u3.u *= -1)) : t4.s.$(t4.s.R(e3), 1.570796326794897) ? u3.u = 0 > e3 ? n4 : t4.F.ca(3.141592653589793 - n4) : (p3 = C3 / w3, o3 = Math.sqrt(1 - p3 * p3), b3 = Math.sin(m3 / 2), 0 > Math.sin(d3 - i5) - 2 * s4 * x3 * b3 * b3 && (o3 *= -1), u3.u = Math.atan2(p3, o3), u3.u = t4.F.ca(u3.u + 3.141592653589793), t4.s.$(h3, -e3) && !t4.s.Dd(h3) && !t4.s.$(t4.s.R(h3), 1.570796326794897) && t4.s.R(t4.F.ca(n4 - r3)) > 3.141592653589793 * (1 - v3 * Math.cos(h3)) && (a3 != null ? b3 = a3.u : (o3 = C3 / s4, b3 = Math.sqrt(1 - o3 * o3), 0 > s4 * x3 - g3 * w3 * Math.cos(m3) && (b3 *= -1), b3 = Math.atan2(o3, b3), t4.s.$(h3, -e3) && t4.s.R(t4.F.ca(n4 - r3)) > 3.141592653589793 * (1 - v3 * Math.cos(h3)) && (0 < h3 && 1.570796326794897 > t4.s.R(b3) || 0 > h3 && 1.570796326794897 < t4.s.R(b3)) && (b3 = t4.s.Mb(3.141592653589793, b3) - b3)), 1.570796326794897 >= t4.s.R(b3) && 1.570796326794897 < t4.s.R(u3.u) || 1.570796326794897 <= t4.s.R(b3) && 1.570796326794897 > t4.s.R(u3.u)) && (u3.u = -1 * t4.F.ca(u3.u + 3.141592653589793))));
                }
              }
            }
        }, i4.sf = function(i5, s4, n4, h3, r3, e3, o3, a3) {
          if (o3 != null || a3 != null)
            if (t4.s.vi(s4))
              t4.$g.sf(i5, n4, h3, r3, e3, o3, a3);
            else if (e3 = t4.F.ca(e3), t4.s.$(t4.s.R(h3), 1.570796326794897) || t4.s.Dd(e3) || t4.s.$(t4.s.R(e3), 3.141592653589793))
              t4.Yk.sf(i5, s4, n4, h3, r3, e3, o3, a3);
            else {
              var u3 = t4.s.R(e3) == 1.570796326794897 ? 0 : Math.cos(e3), f3 = t4.s.R(e3) == 3.141592653589793 ? 0 : Math.sin(e3);
              t4.s.$(t4.s.R(h3), 1.570796326794897) && (n4 = 0), e3 = 1 - Math.sqrt(1 - s4);
              var c3 = t4.F.Xq(s4, h3);
              h3 = t4.s.R(c3) == 1.570796326794897 ? 0 : Math.cos(c3);
              var l3 = Math.sin(c3);
              c3 = Math.atan2(Math.tan(c3), u3);
              var p3 = h3 * f3, v3 = p3 * p3, y3 = 1 - v3, b3 = s4 / (1 - s4) * y3, d3 = (s4 = b3 * (256 + b3 * (b3 * (74 - 47 * b3) - 128)) / 1024) / 4, g3 = s4 / 6, w3 = r3 / (i5 * (1 - e3) * (1 + b3 * (4096 + b3 * (b3 * (320 - 175 * b3) - 768)) / 16384)), x3 = w3;
              do {
                var m3 = x3;
                r3 = t4.s.R(x3) == 1.570796326794897 ? 0 : Math.cos(x3);
                var j3 = (b3 = t4.s.R(x3) == 3.141592653589793 ? 0 : Math.sin(x3)) * b3;
                x3 = s4 * b3 * ((i5 = Math.cos(2 * c3 + x3)) + d3 * (r3 * (2 * (x3 = i5 * i5) - 1) - g3 * i5 * (4 * j3 - 3) * (4 * x3 - 3))) + w3;
              } while (!t4.s.$(m3, x3));
              r3 = t4.s.R(x3) == 1.570796326794897 ? 0 : Math.cos(x3), b3 = t4.s.R(x3) == 3.141592653589793 ? 0 : Math.sin(x3), o3 != null && (f3 = Math.atan2(b3 * f3, h3 * r3 - l3 * b3 * u3), y3 = e3 / 16 * y3 * (4 + e3 * (4 - 3 * y3)), i5 = Math.cos(2 * c3 + x3), o3.u = t4.F.ca(n4 + (f3 - (1 - y3) * e3 * p3 * (x3 + y3 * b3 * (i5 + y3 * r3 * (2 * i5 * i5 - 1)))))), a3 != null && (y3 = l3 * b3 - h3 * r3 * u3, y3 = (1 - e3) * Math.sqrt(v3 + y3 * y3), a3.u = Math.atan2(l3 * r3 + h3 * b3 * u3, y3));
            }
        }, i4;
      }();
    }(Q2 || (Q2 = {})), function(t4) {
      t4.KC = function() {
        function i4() {
        }
        return i4.ub = function(i5, s4, n4, h3, r3, e3, o3, a3, u3) {
          var f3 = t4.F.ca(r3 - n4), c3 = t4.s.$(t4.s.R(h3), 1.570796326794897), l3 = t4.s.$(t4.s.R(e3), 1.570796326794897);
          if (t4.s.$(h3, e3) && (t4.s.Dd(f3) || c3))
            o3 != null && (o3.u = 0), a3 != null && (a3.u = 0), u3 != null && (u3.u = 0);
          else {
            if (t4.s.vi(s4)) {
              var p3 = Math.sin(h3), v3 = Math.sin(e3);
              p3 = Math.sqrt((1 + p3) / (1 - p3)), v3 = Math.sqrt((1 + v3) / (1 - v3)), p3 = Math.log(v3) - Math.log(p3), p3 = Math.atan2(f3, p3), o3 != null && (o3.u = t4.s.$(h3, e3) ? t4.s.R(i5 * Math.cos(h3) * f3) : t4.s.R((i5 * e3 - i5 * h3) / Math.cos(p3)));
            } else
              v3 = t4.F.Sw(s4, e3), p3 = Math.sin(t4.F.Sw(s4, h3)), v3 = Math.sin(v3), p3 = Math.sqrt((1 + p3) / (1 - p3)), v3 = Math.sqrt((1 + v3) / (1 - v3)), p3 = Math.log(v3) - Math.log(p3), p3 = Math.atan2(f3, p3), o3 != null && (t4.s.$(h3, e3) ? o3.u = t4.s.R(i5 * f3 * Math.cos(h3) / t4.F.w(s4, h3)) : (f3 = t4.F.q(i5, s4, h3), i5 = t4.F.q(i5, s4, e3), o3.u = t4.s.R((i5 - f3) / Math.cos(p3))));
            a3 == null && u3 == null || (o3 = t4.F.ca(p3 + 3.141592653589793), c3 && l3 || !c3 && !l3 || (c3 ? p3 = 0 > h3 ? r3 : t4.F.ca(3.141592653589793 - r3) : l3 && (o3 = 0 > e3 ? n4 : t4.F.ca(3.141592653589793 - n4))), a3 != null && (a3.u = p3), u3 != null && (u3.u = o3));
          }
        }, i4.sf = function(i5, s4, n4, h3, r3, e3, o3, a3) {
          e3 = t4.F.ca(e3), 0 > r3 && (r3 = t4.s.R(r3), e3 = t4.F.ca(e3 + 3.141592653589793)), t4.s.vi(s4) ? t4.s.$(t4.s.R(h3), 1.570796326794897) ? (n4 = 0 > h3 ? e3 : t4.F.ca(3.141592653589793 - e3), 3.141592653589793 >= (e3 = r3 / i5 % 6.283185307179586) ? i5 = h3 - t4.s.Mb(e3, h3) : (n4 = t4.F.ca(n4 + 3.141592653589793), i5 = -h3 + t4.s.Mb(e3 - 3.141592653589793, h3))) : t4.s.$(t4.s.R(e3), 1.570796326794897) ? (n4 = t4.F.ca(n4 + t4.s.Mb(r3, e3) / (i5 * Math.cos(h3))), i5 = h3) : (i5 = h3 + r3 * Math.cos(e3) / i5, 1.570796326794897 < t4.s.R(i5) && (i5 = 1.570796326794897), t4.s.$(t4.s.R(i5), 1.570796326794897) && (t4.s.Dd(e3) || t4.s.$(t4.s.R(e3), 3.141592653589793)) || (1.570796316258184 < t4.s.R(i5) && (i5 = t4.s.Mb(1.570796316258184, i5)), s4 = Math.sin(h3), h3 = Math.sin(i5), s4 = Math.sqrt((1 + s4) / (1 - s4)), h3 = Math.sqrt((1 + h3) / (1 - h3)), s4 = Math.log(h3) - Math.log(s4), n4 = t4.F.ca(n4 + Math.tan(e3) * s4))) : t4.s.$(t4.s.R(h3), 1.570796326794897) ? (n4 = 0 > h3 ? e3 : t4.F.ca(3.141592653589793 - e3), e3 = r3 / t4.F.lW(i5, s4), 3.141592653589793 >= (e3 %= 6.283185307179586) ? i5 = h3 - t4.s.Mb(e3, h3) : (n4 = t4.F.ca(n4 + 3.141592653589793), i5 = -h3 + t4.s.Mb(e3 - 3.141592653589793, h3)), i5 = t4.F.Tq(s4, i5)) : t4.s.$(t4.s.R(e3), 1.570796326794897) ? (n4 = t4.F.ca(n4 + t4.s.Mb(r3, e3) * t4.F.w(s4, h3) / (i5 * Math.cos(h3))), i5 = h3) : (i5 = 1.570796326794897 * (r3 * Math.cos(e3) + t4.F.q(i5, s4, h3)) / t4.F.Ch(i5, s4), 1.570796326794897 < t4.s.R(i5) && (i5 = t4.s.Mb(1.570796326794897, i5)), i5 = t4.F.Tq(s4, i5), t4.s.$(t4.s.R(i5), 1.570796326794897) && (t4.s.Dd(e3) || t4.s.$(t4.s.R(e3), 3.141592653589793)) || (r3 = t4.F.Sw(s4, h3), h3 = t4.F.Sw(s4, i5), 1.570796316258184 < t4.s.R(h3) && (h3 = t4.s.Mb(1.570796316258184, i5), i5 = t4.F.tO(s4, h3)), s4 = Math.sin(r3), h3 = Math.sin(h3), s4 = Math.sqrt((1 + s4) / (1 - s4)), h3 = Math.sqrt((1 + h3) / (1 - h3)), s4 = Math.log(h3) - Math.log(s4), n4 = t4.F.ca(n4 + Math.tan(e3) * s4))), o3 != null && (o3.u = n4), a3 != null && (a3.u = i5);
        }, i4;
      }();
    }(Q2 || (Q2 = {})), function(t4) {
      t4.kb = function() {
        function i4() {
        }
        return i4.Sy = function(i5, s4, n4, h3, r3, e3, o3) {
          t4.eu.ub(i5, s4, n4, h3, r3, e3, null, o3, null);
        }, i4.Ai = function(i5, s4, n4, h3, r3, e3, o3, a3) {
          t4.eu.sf(i5, s4, n4, h3, r3, e3, o3, a3);
        }, i4.xd = function(i5, s4, n4, h3, r3, e3, o3, a3, u3, f3) {
          switch (f3) {
            case 2:
              t4.Yk.ub(i5, s4, n4, h3, r3, e3, o3, a3, u3);
              break;
            case 3:
              t4.LC.ub(i5, s4, n4, h3, r3, e3, o3, a3, u3);
              break;
            case 1:
              t4.KC.ub(i5, s4, n4, h3, r3, e3, o3, a3, u3);
              break;
            default:
              t4.eu.ub(i5, s4, n4, h3, r3, e3, o3, a3, u3);
          }
        }, i4.qj = function(i5, s4, n4, h3, r3, e3, o3, a3, u3) {
          switch (u3) {
            case 2:
              t4.Yk.sf(i5, s4, n4, h3, r3, e3, o3, a3);
              break;
            case 3:
              t4.LC.sf(i5, s4, n4, h3, r3, e3, o3, a3);
              break;
            case 1:
              t4.KC.sf(i5, s4, n4, h3, r3, e3, o3, a3);
              break;
            default:
              t4.eu.sf(i5, s4, n4, h3, r3, e3, o3, a3);
          }
        }, i4;
      }();
    }(Q2 || (Q2 = {})), function(t4) {
      var i4 = function() {
        function i5() {
          this.y = this.x = null;
        }
        return i5.construct = function(s5) {
          var n4 = new i5();
          return n4.x = new t4.Xb(), n4.x.set(s5.x), n4.y = new t4.Xb(), n4.y.set(s5.y), n4;
        }, i5.QE = function(s5, n4) {
          var h3 = new i5();
          return h3.x = new t4.Xb(), h3.x.set(s5), h3.y = new t4.Xb(), h3.y.set(n4), h3;
        }, i5.prototype.rg = function() {
          return this.x.rg() && this.y.rg();
        }, i5.prototype.value = function() {
          return t4.h.construct(this.x.value(), this.y.value());
        }, i5;
      }();
      t4.rY = i4;
      var s4 = function() {
        function i5() {
          this.z = this.y = this.x = null;
        }
        return i5.construct = function(s5) {
          var n4 = new i5();
          return n4.x = new t4.Xb(), n4.x.set(s5.x), n4.y = new t4.Xb(), n4.y.set(s5.y), n4.z = new t4.Xb(), n4.z.set(s5.z), n4;
        }, i5.QE = function(s5, n4, h3) {
          var r3 = new i5();
          return r3.x = new t4.Xb(), r3.x.set(s5), r3.y = new t4.Xb(), r3.y.set(n4), r3.z = new t4.Xb(), r3.z.set(h3), r3;
        }, i5.prototype.rg = function() {
          return this.x.rg() && this.y.rg() && this.z.rg();
        }, i5.prototype.value = function() {
          return new t4.Od(this.x.value(), this.y.value(), this.z.value());
        }, i5.prototype.Sh = function(i6) {
          var s5 = new t4.Xb(), n4 = new t4.Xb(), h3 = new t4.Xb();
          return s5.Ml(this.x, i6.x), n4.Ml(this.y, i6.y), h3.Ml(this.z, i6.z), (i6 = new t4.Xb()).ZM(s5, n4), i6.add(h3), i6;
        }, i5.prototype.YE = function(s5) {
          var n4 = new i5();
          n4.x.Ml(this.y, s5.z), n4.y.Ml(this.z, s5.x), n4.z.Ml(this.x, s5.y);
          var h3 = new t4.Xb(), r3 = new t4.Xb(), e3 = new t4.Xb();
          return h3.Ml(this.z, s5.y), r3.Ml(this.x, s5.z), e3.Ml(this.y, s5.x), n4.x.sub(h3), n4.y.sub(r3), n4.z.sub(e3), n4;
        }, i5;
      }();
      t4.sY = s4, t4.Nx = function() {
        function n4() {
        }
        return n4.zP = function(t5, i5, s5) {
          var h3 = i5.x;
          i5 = i5.y, n4.el(1, t5, Math.cos(h3), Math.sin(h3), Math.cos(i5), Math.sin(i5), s5);
        }, n4.yP = function(i5, s5) {
          var h3 = new t4.Od();
          return n4.zP(i5, s5, h3), h3;
        }, n4.el = function(t5, i5, s5, n5, h3, r3, e3) {
          t5 /= Math.sqrt(1 - i5 * r3 * r3), e3.L(t5 * h3 * s5, t5 * h3 * n5, t5 * (1 - i5) * r3);
        }, n4.$u = function(i5, n5) {
          var h3 = new t4.Xb(), r3 = new t4.Xb(), e3 = new t4.Xb(), o3 = new t4.Xb();
          h3.cos(n5.x), r3.sin(n5.x), e3.cos(n5.y), o3.sin(n5.y);
          var a3 = new t4.Xb();
          return a3.set(o3), a3.Bg(o3), a3.Po(i5), a3.Po(-1), a3.fN(), a3.sqrt(), (n5 = new t4.Xb()).set(1), n5.lm(a3), (a3 = new t4.Xb()).set(n5), a3.Bg(e3), a3.Bg(h3), (h3 = new t4.Xb()).set(n5), h3.Bg(e3), h3.Bg(r3), (r3 = new t4.Xb()).set(n5), r3.Po(1 - i5), r3.Bg(o3), s4.QE(a3, h3, r3);
        }, n4.NS = function(s5, h3, r3, e3) {
          if (Math.abs(h3.x - r3.x) > Math.PI || Math.abs(h3.y) > 0.5 * Math.PI || Math.abs(r3.y) > 0.5 * Math.PI || (Math.abs(h3.y) == 0.5 * Math.PI || Math.abs(r3.y) == 0.5 * Math.PI) && h3.x != r3.x)
            return NaN;
          if (e3 = n4.YA(e3, Math.min(h3.x, r3.x), Math.max(h3.x, r3.x)), !new t4.Oc(h3.x, r3.x).contains(e3))
            return NaN;
          var o3 = i4.construct(h3);
          if (r3 = i4.construct(r3), o3 = n4.$u(s5, o3), r3 = n4.$u(s5, r3), (r3 = o3.YE(r3)).z.rg())
            return h3.y;
          var a3 = new t4.Xb();
          a3.set(r3.x), a3.lm(r3.z), a3.Po(-1);
          var u3 = new t4.Xb();
          u3.set(r3.y), u3.lm(r3.z), u3.Po(-1);
          var f3 = new t4.Xb();
          return f3.set(u3), f3.Bg(u3), (o3 = new t4.Xb()).set(a3), o3.Bg(a3), o3.add(f3), o3.sqrt(), o3.rg() || a3.rg() && u3.rg() ? h3.y : (h3 = Math.atan2(u3.value(), a3.value()), h3 = Math.atan2(o3.value() * Math.cos(h3 - e3), 1 - s5), e3 = n4.yP(s5, t4.h.construct(e3, h3)), s5 = new t4.Od(e3.x, e3.y, -e3.z), e3 = r3.value().Sh(e3), s5 = r3.value().Sh(s5), Math.abs(s5) < Math.abs(e3) && (h3 = -h3), h3);
        }, n4.Jz = function(s5, h3, r3, e3, o3) {
          if (o3[0] = NaN, o3[1] = NaN, Math.abs(h3.x - r3.x) > Math.PI || Math.abs(h3.y) > 0.5 * Math.PI || Math.abs(r3.y) > 0.5 * Math.PI || (Math.abs(h3.y) == 0.5 * Math.PI || Math.abs(r3.y) == 0.5 * Math.PI) && h3.x != r3.x || Math.abs(e3) >= 0.5 * Math.PI || 0 < h3.y && 0 < r3.y && h3.y > e3 && r3.y > e3 || 0 > h3.y && 0 > r3.y && h3.y < e3 && r3.y < e3)
            return 0;
          var a3 = i4.construct(h3), u3 = i4.construct(r3);
          a3 = n4.$u(s5, a3), u3 = n4.$u(s5, u3);
          var f3 = a3.YE(u3);
          if (f3.z.rg())
            return new t4.Oc(h3.y, r3.y).contains(e3) ? (o3[0] = h3.x, 1) : 0;
          (u3 = new t4.Xb()).set(f3.x), u3.lm(f3.z), u3.Po(-1), (a3 = new t4.Xb()).set(f3.y), a3.lm(f3.z), a3.Po(-1), (f3 = new t4.Xb()).set(a3), f3.Bg(a3);
          var c3 = new t4.Xb();
          return c3.set(u3), c3.Bg(u3), c3.add(f3), c3.sqrt(), c3.rg() || u3.rg() && a3.rg() ? e3 == 0 ? (o3[0] = h3.x, o3[1] = r3.x, 2) : 0 : (s5 = (1 - s5) * Math.tan(e3) / c3.value(), 1 < Math.abs(s5) ? 0 : (s5 = Math.acos(s5), f3 = Math.atan2(a3.value(), u3.value()), u3 = Math.min(h3.x, r3.x), a3 = Math.max(h3.x, r3.x), r3 = n4.YA(f3 - s5, u3, a3), s5 = e3 != 0 ? n4.YA(f3 + s5, u3, a3) : r3, e3 = 0, u3 <= r3 && r3 <= a3 && (o3[e3] = r3, e3++), s5 != r3 && u3 <= s5 && s5 <= a3 && (o3[e3] = s5, ++e3 == 2 && Math.abs(o3[0] - h3.x) > Math.abs(o3[1] - h3.x) && (h3 = o3[0], o3[0] = o3[1], o3[1] = h3)), e3));
        }, n4.YA = function(t5, i5, s5) {
          return t5 > s5 ? t5 -= 2 * (i5 = Math.ceil((t5 - s5) / (2 * Math.PI))) * Math.PI : t5 < i5 && (t5 += 2 * (i5 = Math.ceil((i5 - t5) / (2 * Math.PI))) * Math.PI), t5;
        }, n4;
      }();
    }(Q2 || (Q2 = {})), function(t4) {
      t4.SK = function() {
        function i4() {
        }
        return i4.WX = function(s4, n4) {
          var h3 = 8, r3 = [0, 0, 0, 0], e3 = new t4.h();
          e3.N(n4), e3.scale(t4.cb.tc(s4).Id().Fc() == 9102 ? 1 : t4.cb.tc(s4).Id().ci / 3.141592653589793 * 180), -180 > e3.x ? (e3.x -= e3.x % 360, -180 > e3.x && (e3.x += 360)) : 180 < e3.x && (e3.x -= e3.x % 360, 180 < e3.x && (e3.x -= 360)), 90 < e3.y && (e3.y = 90), -90 > e3.y && (e3.y = -90);
          for (var o3 = -180, a3 = 180, u3 = (s4 = 5 * h3) - 1, f3 = (n4 = (s4 + 31) / 32) - 1; 0 <= f3; f3--)
            for (var c3 = u3 - 32 * f3, l3 = Math.min(32, s4 - 32 * f3), p3 = 1; p3 < l3; p3 += 2) {
              var v3 = 0.5 * (a3 + o3);
              e3.x >= v3 ? (r3[f3] |= 1 << c3, o3 = v3) : a3 = v3, c3 -= 2, u3 -= 2;
            }
          for (o3 = -90, a3 = 90, u3 = s4 - 2, f3 = n4 - 1; 0 <= f3; f3--)
            for (c3 = u3 - 32 * f3, l3 = Math.min(32, s4 - 32 * f3), p3 = 0; p3 < l3; p3 += 2)
              v3 = 0.5 * (a3 + o3), e3.y >= v3 ? (r3[f3] |= 1 << c3, o3 = v3) : a3 = v3, c3 -= 2, u3 -= 2;
          return i4.VP(r3, h3, h3);
        }, i4.VP = function(t5, i5, s4) {
          for (var n4 = [], h3 = 0; h3 < i5; h3++)
            n4[h3] = "";
          for (var r3 = h3 = 0, e3 = 0; e3 < i5; e3++) {
            var o3 = t5[h3] >> r3 & 31;
            if (31 < (r3 += 5)) {
              var a3 = 37 - r3;
              o3 &= (1 << a3) - 1, r3 -= 32, o3 |= (t5[++h3] & (1 << r3) - 1) << a3;
            }
            n4[i5 - 1 - e3] = "0123456789bcdefghjkmnpqrstuvwxyz".split("")[o3];
          }
          if (s4 > i5)
            for (e3 = 0; e3 < s4 - i5; e3++)
              n4.push("0");
          else
            s4 < i5 && (n4.length = s4);
          return n4.join("");
        }, i4;
      }();
    }(Q2 || (Q2 = {})), function(t4) {
      var i4 = { gcstol: [0, 2e-9, 1, 2241706620489156e-24, 2, 2313672246530541e-24, 3, 898240164660333e-23, 4, 8982433838020134e-24, 5, 8982439417325895e-24, 6, 8982466029667677e-24, 7, 8982476760268133e-24, 8, 8982492642167149e-24, 9, 898251968292634e-23, 10, 898253685210448e-23, 11, 8982546725256576e-24, 12, 8982557456049832e-24, 13, 898257333682596e-23, 14, 8982575482995276e-24, 15, 8982578488197342e-24, 16, 8982579775336987e-24, 17, 89825840676828e-22, 18, 8982599090925448e-24, 19, 8982605529473397e-24, 20, 8982609220517402e-24, 21, 8982611968030573e-24, 22, 8982616260407152e-24, 23, 8982620552787834e-24, 24, 8982633429954492e-24, 25, 8982637722351582e-24, 26, 898264416095491e-23, 27, 8982646307158072e-24, 28, 8982654891980968e-24, 29, 8982667769246082e-24, 30, 8982674207892485e-24, 31, 8982680646548117e-24, 32, 8982682792768713e-24, 33, 8982685798042582e-24, 34, 8982689231436652e-24, 35, 898269137766135e-23, 36, 898269266624163e-23, 37, 8982705114087017e-24, 38, 8982706830791106e-24, 39, 8982711958374661e-24, 40, 8982712839964735e-24, 41, 8982717991496125e-24, 42, 8982721424914803e-24, 43, 8982723571154887e-24, 44, 8982727863638127e-24, 45, 8982730868942154e-24, 46, 8982734302370678e-24, 47, 8982745033612112e-24, 48, 8982751472369276e-24, 49, 8982755764879183e-24, 50, 8982762203651733e-24, 51, 8982764776628385e-24, 52, 8982766496171896e-24, 53, 898277722749025e-23, 54, 898278152002477e-23, 55, 898279933943848e-23, 56, 89829143024805e-22, 57, 8982922161948598e-24, 58, 898292327314211e-23, 59, 8982925667349601e-24, 60, 8982932222965576e-24, 61, 8982961298941316e-24, 62, 8982965524049989e-24, 63, 8982994818246099e-24, 64, 8982994895706967e-24, 65, 898299489597736e-23, 66, 8983000733443498e-24, 67, 8983055097289157e-24, 68, 8983064111047368e-24, 69, 8983111996941178e-24, 70, 8983120447446023e-24, 71, 898312748954554e-23, 72, 8983134531656096e-24, 73, 8983141573777694e-24, 74, 8983148615910332e-24, 75, 8983152841195215e-24, 76, 8983153545409748e-24, 77, 8983153827095593e-24, 78, 898315396793852e-23, 79, 8983154249624393e-24, 80, 8983155658054012e-24, 81, 8983960794340072e-24, 82, 8984061344391998e-24, 83, 8984072829255685e-24, 84, 8984194981201908e-24, 85, 8984275233099427e-24, 86, 8984326127007554e-24, 87, 8984330099816539e-24, 88, 898433275258421e-23, 89, 8984333047023206e-24, 90, 8984333885258723e-24, 91, 8984337959508212e-24, 92, 8984365176209457e-24, 93, 8984727360418079e-24, 94, 8984901041679577e-24, 95, 898542662091587e-23, 96, 898610024130669e-23, 97, 8992894229037531e-24, 98, 8993203677616635e-24, 99, 8993206178094346e-24, 100, 8993216059187305e-24, 101, 899322029394808e-23, 102, 8994627867045891e-24, 103, 9467559984315793e-24, 104, 946881168618118e-23, 105, 9980888154931644e-24, 106, 9981105353606775e-24, 107, 9983807356573187e-24, 108, 1687060485811522e-23, 109, 1688447560354875e-23, 110, 2176606011487185e-23, 111, 2225078816042032e-23, 112, 2348476432064694e-23, 113, 2348765250187846e-23, 114, 2378108974103778e-23, 115, 314559636297708e-22, 116, 3297788621680806e-23, 117, 3667892343788279e-23, 118, 4235973644320739e-23, 119, 4794625900676345e-23, 120, 7262742998235812e-23, 121, 7499447580246377e-23, 122, 7525056410964318e-23, 123, 7979913581209237e-23, 124, 9662020153976783e-23, 125, 9799175562353741e-23, 126, 9897353517547472e-23, 127, 102313891987647e-21, 128, 1081460541960784e-22, 129, 121905913857622e-21, 130, 2246893314238523e-22, 131, 2297344808062643e-22, 132, 242984645941825e-21, 133, 2754604784282804e-22, 134, 2884548130346993e-22, 135, 3370339971357784e-22, 136, 4307953346848296e-22, 137, 5208707228462029e-22, 138, 5509209568565608e-22, 139, 6452227422644406e-22, 140, 6740679942715567e-22, 141, 6861770001566745e-22, 142, 7252630318111686e-22, 143, 7441010326374328e-22, 144, 7742672907173287e-22, 145, 9629542775307953e-22, 146, 1061032953945969e-21, 147, 1143628333594458e-21, 148, 1162186197019925e-21, 149, 136418522650196e-20, 150, 1367441038498385e-21, 151, 1432394487827058e-21, 152, 1736235742820677e-21, 153, 1848250952034914e-21, 154, 1909859317102744e-21, 155, 1975716534933873e-21, 156, 2122065907891938e-21, 157, 272837045300392e-20, 158, 3183098861837907e-21, 159, 3580986219567645e-21, 160, 3819718634205488e-21, 161, 409255567950588e-20, 162, 4407367654852486e-21, 163, 4774648292756861e-21, 164, 5161781938115525e-21, 165, 520870722846203e-20, 166, 5729577951308232e-21, 167, 6031134685587613e-21, 168, 6987290184522236e-21, 169, 9241254760174569e-21, 170, 1145915590261646e-20], pcstol: [0, 6666666666666667e-24, 1, 2e-8, 2, 4970973863636364e-20, 3, 4970978156565657e-20, 4, 4970980410559237e-20, 5, 1e-3, 6, 0.001093615055555556, 7, 0.001093615194444445, 8, 0.001093619003239988, 9, 0.001093623110088878, 10, 0.003280833333333333, 11, 0.003280839895013123, 12, 0.003280843014596366, 13, 0.003280845583333334, 14, 0.003280869330266636, 15, 0.00497101413676763], newtoold: [2154, 102110, 2195, 102200, 2204, 32036, 2205, 26979, 2225, 102641, 2226, 102642, 2227, 102643, 2228, 102644, 2229, 102645, 2230, 102646, 2231, 102653, 2232, 102654, 2233, 102655, 2234, 102656, 2235, 102657, 2236, 102658, 2237, 102659, 2238, 102660, 2239, 102666, 2240, 102667, 2241, 102668, 2242, 102669, 2243, 102670, 2246, 102679, 2247, 102680, 2248, 102685, 2249, 102686, 2250, 102687, 2254, 102694, 2255, 102695, 2257, 102712, 2258, 102713, 2259, 102714, 2260, 102715, 2261, 102716, 2262, 102717, 2263, 102718, 2264, 102719, 2267, 102724, 2268, 102725, 2271, 102728, 2272, 102729, 2274, 102736, 2275, 102737, 2276, 102738, 2277, 102739, 2278, 102740, 2279, 102741, 2283, 102746, 2284, 102747, 2285, 102748, 2286, 102749, 2287, 102752, 2288, 102753, 2289, 102754, 2312, 23433, 2326, 102140, 2395, 2091, 2396, 2092, 2397, 2166, 2398, 2167, 2399, 2168, 2759, 102229, 2760, 102230, 2761, 102248, 2762, 102249, 2763, 102250, 2764, 102251, 2765, 102252, 2766, 102241, 2767, 102242, 2768, 102243, 2769, 102244, 2770, 102245, 2771, 102246, 2772, 102253, 2773, 102254, 2774, 102255, 2775, 102256, 2776, 102257, 2777, 102258, 2778, 102259, 2779, 102260, 2780, 102266, 2781, 102267, 2782, 102261, 2783, 102262, 2784, 102263, 2785, 102264, 2786, 102265, 2787, 102268, 2788, 102269, 2789, 102270, 2790, 102271, 2791, 102272, 2792, 102273, 2793, 102274, 2794, 102275, 2795, 102276, 2796, 102277, 2797, 102278, 2798, 102279, 2799, 102280, 2800, 102281, 2801, 102282, 2802, 102283, 2803, 102284, 2804, 102285, 2805, 102286, 2806, 102287, 2807, 102288, 2808, 102289, 2809, 102290, 2810, 102291, 2811, 102292, 2812, 102293, 2813, 102294, 2814, 102295, 2815, 102296, 2816, 102297, 2817, 102298, 2818, 102300, 2819, 102304, 2820, 102307, 2821, 102308, 2822, 102309, 2823, 102310, 2824, 102311, 2825, 102312, 2826, 102313, 2827, 102314, 2828, 102315, 2829, 102316, 2830, 102317, 2831, 102318, 2832, 102320, 2833, 102321, 2834, 102322, 2835, 102323, 2836, 102324, 2837, 102325, 2838, 102326, 2839, 102327, 2840, 102330, 2841, 102334, 2842, 102335, 2843, 102336, 2844, 102337, 2845, 102338, 2846, 102339, 2847, 102340, 2848, 102341, 2849, 102342, 2850, 102343, 2851, 102344, 2852, 102345, 2853, 102346, 2854, 102347, 2855, 102348, 2856, 102349, 2857, 102350, 2858, 102351, 2859, 102352, 2860, 102353, 2861, 102354, 2862, 102355, 2863, 102356, 2864, 102357, 2865, 102358, 2866, 102361, 2942, 102167, 2943, 102169, 2944, 2139, 2945, 2140, 2946, 2141, 2947, 2142, 2948, 2143, 2949, 2144, 2950, 2145, 2951, 2146, 2952, 2147, 2953, 2036, 2954, 2291, 2955, 2153, 2956, 2152, 2957, 2151, 2958, 2150, 2959, 2149, 2960, 2037, 2961, 2038, 2962, 2148, 2965, 2244, 2966, 2245, 3003, 102091, 3004, 102092, 3005, 102190, 3060, 2982, 3067, 102139, 3072, 102606, 3074, 102608, 3075, 102208, 3077, 102210, 3078, 102123, 3080, 102119, 3081, 102603, 3082, 102602, 3083, 102601, 3088, 65163, 3089, 102763, 3090, 102363, 3092, 102151, 3093, 102152, 3094, 102153, 3095, 102154, 3096, 102155, 3097, 102145, 3098, 102146, 3099, 102147, 3100, 102148, 3101, 102149, 3102, 2155, 3107, 102172, 3110, 102170, 3111, 102171, 3119, 2214, 3158, 102234, 3159, 102235, 3160, 102236, 3336, 2979, 3338, 102006, 3346, 2600, 3370, 102126, 3371, 102127, 3372, 102130, 3373, 102131, 3389, 2577, 3390, 2694, 3400, 102184, 3401, 102185, 3404, 3359, 3407, 3366, 3417, 102675, 3418, 102676, 3419, 102677, 3420, 102678, 3421, 102707, 3422, 102708, 3423, 102709, 3424, 102711, 3433, 102651, 3434, 102652, 3435, 102671, 3436, 102672, 3437, 102710, 3438, 102730, 3448, 102095, 3451, 102681, 3452, 102682, 3455, 102735, 3461, 2063, 3462, 2064, 3463, 3073, 3464, 3076, 3560, 102742, 3566, 102743, 3567, 102744, 3734, 102722, 3735, 102723, 3736, 102755, 3737, 102756, 3738, 102757, 3739, 102758, 3741, 102205, 3742, 102206, 3743, 102207, 3748, 102211, 3750, 102202, 3751, 102203, 3759, 102663, 3760, 102463, 3764, 102112, 3770, 102090, 3771, 102180, 3772, 102181, 3773, 102182, 3775, 102186, 3776, 102187, 3777, 102188, 3800, 102183, 3801, 102189, 3812, 102199, 3814, 102609, 3815, 102469, 3819, 104990, 3821, 104136, 3824, 104137, 3825, 102444, 3826, 102443, 3827, 102442, 3828, 102441, 3857, 102100, 3889, 104991, 3906, 104992, 4048, 103201, 4049, 103202, 4050, 103203, 4051, 103204, 4056, 103205, 4057, 103206, 4058, 103207, 4059, 103208, 4060, 103209, 4061, 103210, 4062, 103211, 4063, 103212, 4071, 103213, 4082, 103214, 4083, 103215, 4093, 103216, 4094, 103217, 4095, 103218, 4096, 103219, 4167, 104108, 4169, 37252, 4171, 104107, 4189, 104110, 4197, 4234, 4223, 37223, 4304, 104304, 4414, 102201, 4415, 102762, 4417, 102764, 4434, 102765, 4437, 102647, 4455, 32029, 4456, 32018, 4457, 3454, 4462, 102439, 4463, 4466, 4470, 4469, 4484, 103794, 4485, 103795, 4486, 103796, 4487, 103797, 4488, 103798, 4489, 103799, 4611, 104104, 4612, 104111, 4613, 37255, 4615, 37247, 4616, 37250, 4617, 4140, 4618, 4291, 4620, 37211, 4626, 37235, 4647, 102362, 4658, 37204, 4668, 37201, 4669, 4126, 4672, 37217, 4673, 104125, 4675, 37220, 4684, 37232, 4698, 4631, 4707, 37213, 4708, 37231, 4709, 37212, 4710, 37238, 4711, 37214, 4712, 37237, 4713, 37208, 4714, 37215, 4715, 37253, 4716, 37216, 4717, 37239, 4719, 37219, 4722, 37242, 4724, 37233, 4725, 37222, 4727, 37224, 4728, 37246, 4729, 37226, 4730, 37227, 4731, 37228, 4732, 37229, 4733, 37230, 4734, 37251, 4735, 37259, 4736, 37254, 4739, 37205, 4758, 104133, 4760, 37001, 4762, 104114, 4826, 102214, 5013, 104142, 5014, 102331, 5015, 102332, 5016, 102333, 5173, 102085, 5174, 102086, 5175, 102087, 5176, 102088, 5177, 102089, 5178, 102040, 5179, 102080, 5185, 102081, 5186, 102082, 5187, 102083, 5188, 102084, 5221, 102066, 5246, 104100, 5247, 102490, 5324, 104144, 5325, 102420, 5329, 2934, 5365, 104143, 5367, 102305, 5451, 104132, 5513, 102065, 5514, 102067, 5519, 102111, 5520, 31461, 5646, 102745, 5839, 5388, 5858, 5532, 5879, 4474, 6207, 104256, 6244, 102769, 6245, 102790, 6246, 102770, 6247, 102771, 6248, 102793, 6249, 102796, 6250, 102772, 6251, 102788, 6252, 102775, 6253, 102795, 6254, 102781, 6255, 102767, 6256, 102774, 6257, 102768, 6258, 102797, 6259, 102789, 6260, 102780, 6261, 102783, 6262, 102787, 6263, 102791, 6264, 102777, 6265, 102798, 6266, 102779, 6267, 102784, 6268, 102792, 6269, 102782, 6270, 102785, 6271, 102794, 6272, 102773, 6273, 102778, 6274, 102786, 6275, 102776, 6311, 104141, 6318, 104145, 6322, 104287, 6325, 104286, 6328, 102046, 6329, 102047, 6330, 102048, 6331, 102049, 6332, 102050, 6333, 102051, 6334, 102052, 6335, 102053, 6336, 102054, 6337, 102055, 6338, 102056, 6339, 102057, 6340, 102058, 6341, 102059, 6342, 102382, 6343, 102383, 6344, 102384, 6345, 102385, 6346, 102386, 6347, 102387, 6348, 102388, 6350, 102965, 6355, 102975, 6356, 102976, 6391, 6141, 6393, 102966, 6394, 102977, 6395, 102978, 6396, 102979, 6397, 102980, 6398, 102981, 6399, 102982, 6400, 102983, 6401, 102984, 6402, 102985, 6403, 102986, 6404, 102988, 6405, 102991, 6406, 102987, 6407, 102990, 6408, 102989, 6409, 102992, 6410, 102993, 6411, 102995, 6412, 102994, 6413, 102996, 6414, 102962, 6415, 102997, 6416, 103003, 6417, 102998, 6418, 103004, 6419, 102999, 6420, 103005, 6421, 103e3, 6422, 103006, 6423, 103001, 6424, 103007, 6425, 103002, 6426, 103008, 6427, 103010, 6428, 103013, 6429, 103009, 6430, 103012, 6431, 103011, 6432, 103014, 6433, 103015, 6434, 103016, 6435, 103017, 6436, 103018, 6437, 103019, 6438, 103022, 6439, 102967, 6440, 103021, 6441, 103024, 6442, 103020, 6443, 103023, 6444, 103025, 6445, 103027, 6446, 103026, 6447, 103028, 6448, 103030, 6449, 103033, 6450, 103029, 6451, 103032, 6452, 103031, 6453, 103034, 6454, 103035, 6455, 103037, 6456, 103036, 6457, 103038, 6458, 103039, 6459, 103041, 6460, 103040, 6461, 103042, 6462, 103043, 6463, 103045, 6464, 103044, 6465, 103046, 6466, 103047, 6467, 103049, 6468, 103048, 6469, 103050, 6470, 103051, 6471, 103052, 6472, 103053, 6473, 103054, 6474, 103055, 6475, 103056, 6476, 103057, 6477, 103059, 6478, 103058, 6479, 103060, 6480, 103066, 6481, 103065, 6482, 103067, 6483, 103061, 6484, 103063, 6485, 103062, 6486, 103064, 6487, 103068, 6488, 103069, 6489, 103071, 6490, 103073, 6491, 103070, 6492, 103072, 6493, 103075, 6494, 103078, 6495, 103074, 6496, 103077, 6497, 102968, 6498, 103076, 6499, 103079, 6500, 103081, 6501, 103084, 6502, 103080, 6503, 103083, 6504, 103082, 6505, 103085, 6506, 103086, 6507, 103088, 6508, 102963, 6509, 103087, 6510, 103089, 6511, 103091, 6512, 103090, 6513, 103092, 6514, 103093, 6515, 103094, 6516, 103095, 6518, 103098, 6519, 103101, 6520, 103097, 6521, 103100, 6522, 103099, 6523, 103102, 6524, 103103, 6525, 103104, 6526, 103105, 6527, 103106, 6528, 103108, 6529, 103111, 6530, 103107, 6531, 103110, 6532, 103109, 6533, 103112, 6534, 103114, 6535, 103118, 6536, 103113, 6537, 103117, 6538, 103116, 6539, 103120, 6540, 103115, 6541, 103119, 6542, 103121, 6543, 103122, 6544, 103123, 6545, 103125, 6546, 103124, 6547, 103126, 6548, 103127, 6549, 103129, 6550, 103128, 6551, 103130, 6552, 103131, 6553, 103133, 6554, 103132, 6555, 103134, 6556, 102969, 6557, 102970, 6558, 103135, 6559, 103137, 6560, 103136, 6561, 103138, 6562, 103139, 6563, 103140, 6564, 103141, 6565, 103142, 6566, 103200, 6567, 103143, 6568, 103144, 6569, 103145, 6570, 103146, 6571, 103147, 6572, 103149, 6573, 103148, 6574, 103150, 6575, 103151, 6576, 103152, 6577, 103155, 6578, 103160, 6579, 102971, 6580, 102972, 6581, 103153, 6582, 103158, 6583, 103154, 6584, 103159, 6585, 103157, 6586, 103162, 6587, 103156, 6588, 103161, 6589, 103172, 6590, 103173, 6592, 103174, 6593, 103176, 6594, 103175, 6595, 103177, 6596, 103178, 6597, 103180, 6598, 103179, 6599, 103181, 6600, 103182, 6601, 103184, 6602, 103183, 6603, 103185, 6605, 103190, 6606, 103186, 6607, 103189, 6608, 103188, 6609, 103191, 6610, 102973, 6611, 103192, 6612, 103196, 6613, 103193, 6614, 103197, 6615, 103195, 6616, 103199, 6617, 103194, 6618, 103198, 6619, 103164, 6620, 103163, 6621, 103165, 6625, 103170, 6626, 103169, 6627, 103171, 6628, 102520, 6629, 102521, 6630, 102522, 6631, 102523, 6632, 102524, 6633, 102527, 6634, 102493, 6635, 102494, 6636, 102496, 6637, 102495, 6668, 104020, 6669, 102610, 6670, 102611, 6671, 102612, 6672, 102613, 6673, 102614, 6674, 102615, 6675, 102616, 6676, 102617, 6677, 102618, 6678, 102619, 6679, 102620, 6680, 102621, 6681, 102622, 6682, 102623, 6683, 102624, 6684, 102625, 6685, 102626, 6686, 102627, 6687, 102628, 6688, 102593, 6689, 102594, 6690, 102595, 6691, 102596, 6692, 102597, 6783, 104223, 6784, 102530, 6785, 102500, 6788, 102532, 6789, 102502, 6792, 102533, 6793, 102503, 6796, 102531, 6797, 102501, 6800, 102534, 6801, 102504, 6804, 102535, 6805, 102505, 6808, 102536, 6809, 102506, 6812, 102537, 6813, 102507, 6816, 102538, 6817, 102508, 6820, 102539, 6821, 102509, 6824, 102540, 6825, 102510, 6828, 102541, 6829, 102511, 6832, 102542, 6833, 102512, 6836, 102543, 6837, 102513, 6840, 102544, 6841, 102514, 6844, 102546, 6845, 102516, 6848, 102545, 6849, 102515, 6852, 102547, 6853, 102517, 6856, 102548, 6857, 102518, 6860, 102549, 6861, 102519, 6867, 102380, 6868, 102381, 6879, 103187, 6880, 103096, 6884, 102376, 6885, 102378, 6886, 102377, 6887, 102379, 7136, 6980, 7139, 6987, 7142, 102706, 7692, 102557, 7693, 102558, 7694, 102559, 7695, 102560, 7696, 102561, 8090, 103318, 8091, 103418, 8092, 103317, 8093, 103417, 8095, 103371, 8096, 103471, 8097, 103369, 8098, 103469, 8099, 103368, 8100, 103468, 8101, 103367, 8102, 103467, 8103, 103366, 8104, 103466, 8105, 103365, 8106, 103465, 8107, 103364, 8108, 103464, 8109, 103363, 8110, 103463, 8111, 103362, 8112, 103462, 8113, 103361, 8114, 103461, 8115, 103360, 8116, 103460, 8117, 103359, 8118, 103459, 8119, 103357, 8120, 103457, 8121, 103356, 8122, 103456, 8123, 103355, 8124, 103455, 8125, 103354, 8126, 103454, 8127, 103353, 8128, 103453, 8129, 103352, 8130, 103452, 8131, 103350, 8132, 103450, 8133, 103349, 8134, 103449, 8135, 103348, 8136, 103448, 8139, 103343, 8140, 103443, 8141, 103342, 8142, 103442, 8143, 103341, 8144, 103441, 8145, 103339, 8146, 103439, 8147, 103337, 8148, 103437, 8149, 103336, 8150, 103436, 8151, 103334, 8152, 103434, 8153, 103333, 8154, 103433, 8155, 103331, 8156, 103431, 8161, 103326, 8162, 103426, 8163, 103325, 8164, 103425, 8165, 103324, 8166, 103424, 8171, 103321, 8172, 103421, 8173, 103320, 8177, 103420, 8179, 103316, 8180, 103416, 8181, 103315, 8182, 103415, 8184, 103314, 8185, 103414, 8191, 103312, 8193, 103412, 8196, 103311, 8197, 103411, 8198, 103310, 8200, 103410, 8201, 103309, 8202, 103409, 8203, 103308, 8204, 103408, 8207, 103306, 8208, 103406, 8209, 103305, 8210, 103405, 8212, 103304, 8213, 103404, 8214, 103303, 8216, 103403, 8218, 103302, 8220, 103402, 8222, 103301, 8224, 103401, 8431, 104248, 8441, 102590, 8693, 102449, 8826, 102605, 8857, 54035, 8858, 54036, 8859, 54037, 8860, 8449, 8988, 104115, 8989, 104116, 8990, 104117, 8991, 104118, 8992, 104119, 8993, 104120, 8994, 104121, 8995, 104122, 8996, 104123, 8997, 104124, 8998, 104896, 8999, 104257, 9e3, 104019, 9014, 104010, 9019, 104021, 9053, 104011, 9054, 104012, 9055, 104013, 9056, 104014, 9057, 104015, 9059, 104258, 9060, 104179, 9061, 104180, 9062, 104181, 9063, 104182, 9064, 104183, 9065, 104184, 9066, 104185, 9067, 104186, 21896, 21891, 21897, 21892, 21898, 21893, 21899, 21894, 26701, 102124, 26702, 102125, 26799, 26747, 26847, 102683, 26848, 102684, 26849, 102691, 26850, 102692, 26851, 102693, 26852, 102704, 26853, 102750, 26854, 102751, 26857, 102466, 26858, 102467, 26859, 102468, 26901, 102128, 26902, 102129, 27493, 27492, 29101, 29100, 29168, 29118, 29169, 29119, 29170, 29120, 29171, 29121, 29172, 29122, 29187, 29177, 29188, 29178, 29189, 29179, 29190, 29180, 29191, 29181, 29192, 29182, 29193, 29183, 29194, 29184, 29195, 29185, 29902, 29900, 31279, 31278, 31281, 31291, 31282, 31292, 31283, 31293, 31284, 31294, 31285, 31295, 31286, 31296, 31287, 31297, 31466, 31462, 31467, 31463, 31468, 31464, 31469, 31465, 31986, 31917, 31987, 31918, 31988, 31919, 31989, 31920, 31990, 31921, 31991, 31922, 32064, 32074, 32065, 32075, 32066, 32076, 32067, 32077, 102550, 2181, 102551, 2182, 102552, 2183, 102553, 2184, 102554, 2185, 102555, 2186, 102556, 2187], pcsid: [2066, 15, 2136, 12, 2155, 10, 2157, 5, 2158, 5, 2159, 12, 2160, 12, 2219, 5, 2220, 5, 2244, 10, 2245, 10, 2256, 11, 2265, 11, 2266, 11, 2269, 11, 2270, 11, 2273, 11, 2290, 5, 2291, 5, 2294, 5, 2295, 5, 2313, 5, 2314, 14, 2899, 10, 2900, 10, 2901, 11, 2909, 11, 2910, 11, 2911, 10, 2912, 10, 2913, 11, 2914, 11, 2964, 10, 2967, 10, 2968, 10, 2991, 5, 2992, 11, 2993, 5, 2994, 11, 3073, 5, 3076, 5, 3079, 5, 3091, 10, 3106, 5, 3108, 5, 3109, 5, 3141, 5, 3142, 5, 3167, 4, 3337, 5, 3347, 5, 3348, 5, 3359, 10, 3360, 5, 3361, 11, 3362, 5, 3363, 10, 3364, 5, 3365, 10, 3366, 14, 3402, 5, 3403, 5, 3405, 5, 3406, 5, 3439, 5, 3440, 5, 3447, 5, 3449, 5, 3450, 5, 3453, 10, 3454, 10, 3460, 5, 3479, 11, 3480, 5, 3481, 11, 3482, 5, 3483, 11, 3484, 5, 3485, 10, 3486, 5, 3487, 10, 3488, 5, 3489, 5, 3490, 10, 3491, 5, 3492, 10, 3493, 5, 3494, 10, 3495, 5, 3496, 10, 3497, 5, 3498, 10, 3499, 5, 3500, 10, 3501, 5, 3502, 10, 3503, 5, 3504, 10, 3505, 5, 3506, 10, 3507, 5, 3508, 10, 3509, 5, 3510, 10, 3511, 5, 3512, 10, 3513, 5, 3514, 5, 3515, 10, 3516, 5, 3517, 10, 3518, 5, 3519, 10, 3520, 5, 3521, 10, 3522, 5, 3523, 10, 3524, 5, 3525, 10, 3526, 5, 3527, 10, 3528, 5, 3529, 10, 3530, 5, 3531, 10, 3532, 5, 3533, 10, 3534, 5, 3535, 10, 3536, 5, 3537, 10, 3538, 5, 3539, 10, 3540, 5, 3541, 10, 3542, 5, 3543, 10, 3544, 5, 3545, 10, 3546, 5, 3547, 10, 3548, 5, 3549, 10, 3550, 5, 3551, 10, 3552, 5, 3553, 10, 3582, 10, 3583, 5, 3584, 10, 3585, 5, 3586, 10, 3587, 5, 3588, 11, 3589, 5, 3590, 11, 3591, 5, 3592, 5, 3593, 11, 3598, 10, 3599, 5, 3600, 10, 3605, 11, 3606, 5, 3607, 5, 3608, 10, 3609, 5, 3610, 10, 3611, 5, 3612, 10, 3613, 5, 3614, 10, 3615, 5, 3616, 10, 3617, 5, 3618, 10, 3619, 5, 3620, 10, 3621, 5, 3622, 10, 3623, 5, 3624, 10, 3625, 5, 3626, 10, 3627, 5, 3628, 10, 3629, 5, 3630, 10, 3631, 5, 3632, 10, 3633, 5, 3634, 11, 3635, 5, 3636, 11, 3640, 10, 3641, 5, 3642, 10, 3643, 5, 3644, 11, 3645, 5, 3646, 11, 3647, 5, 3648, 11, 3649, 5, 3650, 10, 3651, 5, 3652, 10, 3653, 5, 3654, 10, 3655, 5, 3656, 11, 3657, 5, 3658, 10, 3659, 5, 3660, 10, 3661, 5, 3662, 10, 3663, 5, 3664, 10, 3668, 10, 3669, 5, 3670, 10, 3671, 5, 3672, 10, 3673, 5, 3674, 10, 3675, 5, 3676, 11, 3677, 10, 3678, 5, 3679, 11, 3680, 10, 3681, 5, 3682, 11, 3683, 10, 3684, 5, 3685, 5, 3686, 10, 3687, 5, 3688, 10, 3689, 5, 3690, 10, 3691, 5, 3692, 10, 3696, 10, 3697, 5, 3698, 10, 3699, 5, 3700, 10, 3740, 5, 3749, 5, 3783, 5, 3784, 5, 3793, 5, 3794, 5, 3802, 5, 3816, 5, 3829, 5, 3854, 5, 3911, 5, 3912, 5, 3920, 5, 3978, 5, 3979, 5, 3991, 10, 3992, 10, 4026, 5, 4037, 5, 4038, 5, 4087, 5, 4088, 5, 4217, 10, 4438, 10, 4439, 10, 4467, 5, 4471, 5, 4474, 5, 4559, 5, 4822, 5, 4839, 5, 5018, 5, 5048, 5, 5167, 5, 5168, 5, 5223, 5, 5234, 5, 5235, 5, 5243, 5, 5266, 5, 5316, 5, 5320, 5, 5321, 5, 5330, 5, 5331, 5, 5337, 5, 5361, 5, 5362, 5, 5382, 5, 5383, 5, 5396, 5, 5456, 5, 5457, 5, 5469, 5, 5472, 9, 5490, 5, 5518, 5, 5523, 5, 5559, 5, 5588, 11, 5589, 14, 5596, 5, 5627, 5, 5629, 5, 5641, 5, 5643, 5, 5644, 5, 5654, 10, 5655, 10, 5659, 5, 5700, 5, 5825, 5, 5836, 5, 5837, 5, 5842, 5, 5844, 5, 5880, 5, 5887, 5, 5890, 5, 6128, 11, 6129, 11, 6141, 11, 6204, 5, 6210, 5, 6211, 5, 6307, 5, 6312, 5, 6316, 5, 6362, 5, 6591, 5, 6646, 5, 6703, 5, 6786, 5, 6787, 11, 6790, 5, 6791, 11, 6794, 5, 6795, 11, 6798, 5, 6799, 11, 6802, 5, 6803, 11, 6806, 5, 6807, 11, 6810, 5, 6811, 11, 6814, 5, 6815, 11, 6818, 5, 6819, 11, 6822, 5, 6823, 11, 6826, 5, 6827, 11, 6830, 5, 6831, 11, 6834, 5, 6835, 11, 6838, 5, 6839, 11, 6842, 5, 6843, 11, 6846, 5, 6847, 11, 6850, 5, 6851, 11, 6854, 5, 6855, 11, 6858, 5, 6859, 11, 6862, 5, 6863, 11, 6870, 5, 6875, 5, 6876, 5, 6915, 5, 6922, 5, 6923, 10, 6924, 5, 6925, 10, 6962, 5, 6984, 5, 6991, 5, 7128, 10, 7131, 5, 7132, 10, 7257, 5, 7258, 10, 7259, 5, 7260, 10, 7261, 5, 7262, 10, 7263, 5, 7264, 10, 7265, 5, 7266, 10, 7267, 5, 7268, 10, 7269, 5, 7270, 10, 7271, 5, 7272, 10, 7273, 5, 7274, 10, 7275, 5, 7276, 10, 7277, 5, 7278, 10, 7279, 5, 7280, 10, 7281, 5, 7282, 10, 7283, 5, 7284, 10, 7285, 5, 7286, 10, 7287, 5, 7288, 10, 7289, 5, 7290, 10, 7291, 5, 7292, 10, 7293, 5, 7294, 10, 7295, 5, 7296, 10, 7297, 5, 7298, 10, 7299, 5, 7300, 10, 7301, 5, 7302, 10, 7303, 5, 7304, 10, 7305, 5, 7306, 10, 7307, 5, 7308, 10, 7309, 5, 7310, 10, 7311, 5, 7312, 10, 7313, 5, 7314, 10, 7315, 5, 7316, 10, 7317, 5, 7318, 10, 7319, 5, 7320, 10, 7321, 5, 7322, 10, 7323, 5, 7324, 10, 7325, 5, 7326, 10, 7327, 5, 7328, 10, 7329, 5, 7330, 10, 7331, 5, 7332, 10, 7333, 5, 7334, 10, 7335, 5, 7336, 10, 7337, 5, 7338, 10, 7339, 5, 7340, 10, 7341, 5, 7342, 10, 7343, 5, 7344, 10, 7345, 5, 7346, 10, 7347, 5, 7348, 10, 7349, 5, 7350, 10, 7351, 5, 7352, 10, 7353, 5, 7354, 10, 7355, 5, 7356, 10, 7357, 5, 7358, 10, 7359, 5, 7360, 10, 7361, 5, 7362, 10, 7363, 5, 7364, 10, 7365, 5, 7366, 10, 7367, 5, 7368, 10, 7369, 5, 7370, 10, 7877, 5, 7878, 5, 7882, 5, 7883, 5, 7887, 5, 7899, 5, 7991, 5, 7992, 5, 8035, 10, 8036, 10, 8058, 5, 8059, 5, 8082, 5, 8083, 5, 8088, 5, 8137, 5, 8138, 10, 8157, 5, 8158, 10, 8159, 5, 8160, 10, 8167, 5, 8168, 10, 8169, 5, 8170, 10, 8187, 5, 8189, 10, 8205, 5, 8206, 10, 8225, 5, 8226, 10, 8311, 5, 8312, 11, 8313, 5, 8314, 11, 8315, 5, 8316, 11, 8317, 5, 8318, 11, 8319, 5, 8320, 11, 8321, 5, 8322, 11, 8323, 5, 8324, 11, 8325, 5, 8326, 11, 8327, 5, 8328, 11, 8329, 5, 8330, 11, 8331, 5, 8332, 11, 8333, 5, 8334, 11, 8335, 5, 8336, 11, 8337, 5, 8338, 11, 8339, 5, 8340, 11, 8341, 5, 8342, 11, 8343, 5, 8344, 11, 8345, 5, 8346, 11, 8347, 5, 8348, 11, 8352, 5, 8353, 5, 8379, 5, 8380, 10, 8381, 5, 8382, 10, 8383, 5, 8384, 10, 8385, 5, 8387, 10, 8391, 5, 8395, 5, 8433, 5, 8455, 5, 8456, 5, 8531, 10, 8682, 5, 8687, 5, 8692, 5, 8903, 5, 8950, 5, 8951, 5, 9039, 5, 9040, 5, 9141, 5, 9149, 5, 9150, 5, 9191, 5, 9221, 5, 9222, 5, 20499, 5, 20538, 5, 20539, 5, 20790, 5, 20791, 5, 21291, 5, 21292, 5, 21500, 5, 21817, 5, 21818, 5, 22032, 5, 22033, 5, 22091, 5, 22092, 5, 22332, 5, 22391, 5, 22392, 5, 22700, 5, 22770, 5, 22780, 5, 22832, 5, 23090, 5, 23095, 5, 23239, 5, 23240, 5, 23433, 5, 23700, 5, 24047, 5, 24048, 5, 24100, 14, 24200, 5, 24305, 5, 24306, 5, 24382, 6, 24383, 5, 24500, 5, 24547, 5, 24548, 5, 24571, 2, 24600, 5, 25e3, 5, 25231, 5, 25884, 5, 25932, 5, 26237, 5, 26331, 5, 26332, 5, 26591, 5, 26592, 5, 26632, 5, 26692, 5, 26855, 10, 26856, 10, 27120, 5, 27200, 5, 27291, 7, 27292, 7, 27429, 5, 27492, 5, 27500, 5, 27700, 5, 28232, 5, 28600, 5, 28991, 5, 28992, 5, 29100, 5, 29220, 5, 29221, 5, 29333, 5, 29635, 5, 29636, 5, 29701, 5, 29738, 5, 29739, 5, 29849, 5, 29850, 5, 29871, 3, 29872, 13, 29873, 5, 29900, 5, 29901, 5, 29903, 5, 30200, 15, 30339, 5, 30340, 5, 30791, 5, 30792, 5, 31028, 5, 31121, 5, 31154, 5, 31170, 5, 31171, 5, 31370, 5, 31528, 5, 31529, 5, 31600, 5, 31700, 5, 31838, 5, 31839, 5, 31901, 5, 32061, 5, 32062, 5, 32098, 5, 32099, 10, 32100, 5, 32104, 5, 32161, 5, 32766, 5, 53048, 5, 53049, 5, 54090, 5, 54091, 5, 65061, 10, 65062, 10, 65161, 5, 65163, 5, 102041, 10, 102064, 8, 102068, 1, 102069, 0, 102118, 10, 102119, 11, 102120, 10, 102121, 10, 102217, 10, 102218, 5, 102219, 10, 102220, 10, 102378, 11, 102379, 11, 102380, 5, 102381, 11, 102498, 5, 102499, 5, 102589, 10, 102590, 5, 102599, 10, 102600, 10, 102604, 10, 102605, 5, 102606, 5, 102647, 5, 102704, 10, 102705, 10, 102706, 5, 102733, 10, 102761, 10, 102762, 5, 102763, 10, 102764, 5, 102765, 5, 102766, 10, 102962, 5, 102963, 5, 102970, 11, 102974, 10, 102993, 5, 102994, 5, 102995, 10, 102996, 10, 103015, 5, 103016, 10, 103017, 5, 103018, 10, 103025, 5, 103026, 5, 103027, 10, 103028, 10, 103035, 5, 103036, 5, 103037, 10, 103038, 10, 103039, 5, 103040, 5, 103041, 10, 103042, 10, 103043, 5, 103044, 5, 103045, 10, 103046, 10, 103047, 5, 103048, 5, 103049, 10, 103050, 10, 103051, 5, 103052, 10, 103053, 5, 103054, 10, 103055, 5, 103056, 10, 103057, 5, 103058, 5, 103059, 10, 103060, 10, 103061, 5, 103062, 5, 103063, 10, 103064, 10, 103069, 10, 103070, 5, 103071, 5, 103072, 10, 103073, 10, 103086, 5, 103087, 5, 103088, 10, 103089, 10, 103094, 11, 103095, 5, 103096, 10, 103103, 5, 103104, 10, 103105, 5, 103106, 10, 103121, 5, 103122, 10, 103123, 5, 103124, 5, 103125, 11, 103126, 11, 103127, 5, 103128, 5, 103129, 10, 103130, 10, 103131, 5, 103132, 5, 103133, 10, 103134, 10, 103135, 5, 103136, 5, 103137, 11, 103138, 11, 103139, 5, 103140, 10, 103141, 5, 103142, 10, 103143, 5, 103144, 10, 103145, 5, 103146, 11, 103147, 5, 103148, 5, 103149, 10, 103150, 10, 103151, 5, 103152, 10, 103172, 5, 103173, 10, 103174, 5, 103175, 5, 103176, 10, 103177, 10, 103178, 5, 103179, 5, 103180, 10, 103181, 10, 103182, 5, 103183, 5, 103184, 10, 103185, 10, 103228, 5, 103229, 5, 103230, 10, 103231, 10, 103250, 5, 103251, 10, 103252, 5, 103253, 10, 103260, 5, 103261, 5, 103262, 10, 103263, 10, 103270, 5, 103271, 5, 103272, 10, 103273, 10, 103274, 5, 103275, 5, 103276, 10, 103277, 10, 103278, 5, 103279, 5, 103280, 10, 103281, 10, 103282, 5, 103283, 5, 103284, 10, 103285, 10, 103286, 5, 103287, 10, 103288, 5, 103289, 10, 103290, 5, 103291, 10, 103292, 5, 103293, 5, 103294, 10, 103295, 10, 103296, 5, 103297, 5, 103298, 10, 103299, 10, 103376, 10, 103377, 5, 103378, 5, 103379, 10, 103380, 10, 103393, 5, 103394, 5, 103395, 10, 103396, 10, 103472, 5, 103473, 11, 103474, 5, 103475, 10, 103482, 5, 103483, 10, 103484, 5, 103485, 10, 103500, 5, 103501, 10, 103502, 5, 103503, 5, 103504, 11, 103505, 11, 103506, 5, 103507, 5, 103508, 10, 103509, 10, 103510, 5, 103511, 5, 103512, 10, 103513, 10, 103514, 5, 103515, 10, 103516, 5, 103517, 10, 103518, 5, 103519, 10, 103520, 5, 103521, 11, 103522, 5, 103523, 5, 103524, 10, 103525, 10, 103526, 5, 103527, 10, 103561, 10, 103562, 10, 103563, 5, 103564, 5, 103565, 10, 103566, 10, 103567, 5, 103568, 5, 103569, 10, 103570, 10, 103585, 10, 103586, 5, 103587, 10, 103588, 11, 103589, 5, 103590, 10, 103591, 11, 103592, 5, 103593, 10, 103594, 11, 103695, 10, 103846, 5, 103946, 10], pcsidc: [[2e3, 2045, 5], [2056, 2065, 5], [2067, 2135, 5], [2137, 2153, 5], [2161, 2170, 5], [2172, 2193, 5], [2196, 2198, 5], [2200, 2203, 5], [2206, 2217, 5], [2222, 2224, 11], [2251, 2253, 11], [2280, 2282, 11], [2308, 2311, 5], [2315, 2325, 5], [2327, 2394, 5], [2400, 2491, 5], [2494, 2758, 5], [2867, 2869, 11], [2870, 2888, 10], [2891, 2895, 10], [2896, 2898, 11], [2902, 2908, 10], [2915, 2920, 10], [2921, 2923, 11], [2924, 2930, 10], [2931, 2941, 5], [2969, 2973, 5], [2975, 2982, 5], [2984, 2988, 5], [2995, 3002, 5], [3006, 3051, 5], [3054, 3059, 5], [3061, 3066, 5], [3068, 3071, 5], [3084, 3087, 5], [3112, 3118, 5], [3120, 3138, 5], [3146, 3151, 5], [3153, 3157, 5], [3161, 3166, 5], [3168, 3172, 5], [3174, 3203, 5], [3294, 3313, 5], [3315, 3335, 5], [3339, 3345, 5], [3350, 3358, 5], [3367, 3369, 5], [3374, 3388, 5], [3391, 3399, 5], [3408, 3416, 5], [3425, 3432, 10], [3441, 3446, 10], [3456, 3459, 10], [3465, 3478, 5], [3554, 3559, 5], [3561, 3565, 10], [3568, 3570, 10], [3571, 3581, 5], [3594, 3597, 5], [3601, 3604, 5], [3637, 3639, 5], [3665, 3667, 5], [3693, 3695, 5], [3701, 3727, 5], [3728, 3733, 10], [3744, 3747, 5], [3753, 3758, 10], [3761, 3763, 5], [3765, 3769, 5], [3779, 3781, 5], [3788, 3791, 5], [3797, 3799, 5], [3832, 3841, 5], [3844, 3852, 5], [3873, 3885, 5], [3890, 3893, 5], [3942, 3950, 5], [3968, 3970, 5], [3973, 3976, 5], [3986, 3989, 5], [3994, 3997, 5], [4390, 4398, 5], [4399, 4413, 10], [4418, 4433, 10], [4491, 4554, 5], [4568, 4589, 5], [4652, 4656, 5], [4766, 4800, 5], [5069, 5072, 5], [5105, 5130, 5], [5180, 5184, 5], [5253, 5259, 5], [5269, 5275, 5], [5292, 5311, 5], [5343, 5349, 5], [5355, 5357, 5], [5387, 5389, 5], [5459, 5463, 5], [5479, 5482, 5], [5530, 5539, 5], [5550, 5552, 5], [5562, 5583, 5], [5623, 5625, 10], [5631, 5639, 5], [5649, 5653, 5], [5663, 5680, 5], [5682, 5685, 5], [5875, 5877, 5], [5896, 5899, 5], [5921, 5940, 5], [6050, 6125, 5], [6351, 6354, 5], [6366, 6372, 5], [6381, 6387, 5], [6622, 6624, 5], [6707, 6709, 5], [6720, 6723, 5], [6732, 6738, 5], [6931, 6933, 5], [7005, 7007, 5], [7057, 7070, 10], [7074, 7082, 5], [7109, 7118, 5], [7119, 7127, 11], [7374, 7376, 5], [7528, 7586, 5], [7587, 7645, 10], [7755, 7787, 5], [7791, 7795, 5], [7799, 7801, 5], [7803, 7805, 5], [7825, 7831, 5], [7845, 7859, 5], [8013, 8032, 5], [8065, 8068, 11], [8518, 8529, 10], [8533, 8536, 10], [8538, 8540, 10], [8677, 8679, 5], [8836, 8840, 5], [8908, 8910, 5], [9154, 9159, 5], [9205, 9218, 5], [20002, 20032, 5], [20062, 20092, 5], [20135, 20138, 5], [20248, 20258, 5], [20348, 20358, 5], [20436, 20440, 5], [20822, 20824, 5], [20934, 20936, 5], [21035, 21037, 5], [21095, 21097, 5], [21148, 21150, 5], [21413, 21423, 5], [21473, 21483, 5], [21780, 21782, 5], [21891, 21894, 5], [22171, 22177, 5], [22181, 22187, 5], [22191, 22197, 5], [22234, 22236, 5], [22521, 22525, 5], [22991, 22994, 5], [23028, 23038, 5], [23830, 23853, 5], [23866, 23872, 5], [23877, 23884, 5], [23886, 23894, 5], [23946, 23948, 5], [24311, 24313, 5], [24342, 24347, 5], [24370, 24374, 6], [24375, 24381, 5], [24718, 24721, 5], [24817, 24821, 5], [24877, 24882, 5], [24891, 24893, 5], [25391, 25395, 5], [25828, 25838, 5], [26191, 26195, 5], [26391, 26393, 5], [26703, 26722, 5], [26729, 26760, 10], [26766, 26798, 10], [26860, 26870, 10], [26891, 26899, 5], [26903, 26923, 5], [26929, 26946, 5], [26948, 26998, 5], [27037, 27040, 5], [27205, 27232, 5], [27258, 27260, 5], [27391, 27398, 5], [27561, 27564, 5], [27571, 27574, 5], [27581, 27584, 5], [27591, 27594, 5], [28191, 28193, 5], [28348, 28358, 5], [28402, 28432, 5], [28462, 28492, 5], [29118, 29122, 5], [29177, 29185, 5], [30161, 30179, 5], [30491, 30494, 5], [30729, 30732, 5], [31251, 31259, 5], [31265, 31268, 5], [31275, 31278, 5], [31288, 31297, 5], [31461, 31465, 5], [31491, 31495, 5], [31917, 31922, 5], [31965, 31985, 5], [31992, 32e3, 5], [32001, 32003, 10], [32005, 32031, 10], [32033, 32060, 10], [32074, 32077, 10], [32081, 32086, 5], [32107, 32130, 5], [32133, 32158, 5], [32164, 32167, 10], [32180, 32199, 5], [32201, 32260, 5], [32301, 32360, 5], [32601, 32662, 5], [32664, 32667, 10], [32701, 32761, 5], [53001, 53004, 5], [53008, 53019, 5], [53021, 53032, 5], [53034, 53037, 5], [53042, 53046, 5], [53074, 53080, 5], [54001, 54004, 5], [54008, 54019, 5], [54021, 54032, 5], [54034, 54037, 5], [54042, 54046, 5], [54048, 54053, 5], [54074, 54080, 5], [54098, 54101, 5], [102001, 102040, 5], [102042, 102063, 5], [102065, 102067, 5], [102070, 102112, 5], [102114, 102117, 5], [102122, 102208, 5], [102210, 102216, 5], [102221, 102300, 5], [102304, 102377, 5], [102382, 102388, 5], [102389, 102398, 10], [102399, 102444, 5], [102445, 102447, 10], [102448, 102458, 5], [102459, 102468, 10], [102469, 102496, 5], [102500, 102519, 11], [102520, 102524, 5], [102525, 102529, 10], [102530, 102549, 5], [102557, 102588, 5], [102593, 102598, 5], [102601, 102603, 5], [102608, 102628, 5], [102629, 102646, 10], [102648, 102672, 10], [102675, 102700, 10], [102701, 102703, 5], [102707, 102730, 10], [102735, 102758, 10], [102767, 102900, 5], [102965, 102969, 5], [102971, 102973, 5], [102975, 102989, 5], [102990, 102992, 11], [102997, 103002, 5], [103003, 103008, 10], [103009, 103011, 5], [103012, 103014, 10], [103019, 103021, 5], [103022, 103024, 10], [103029, 103031, 5], [103032, 103034, 10], [103065, 103068, 5], [103074, 103076, 5], [103077, 103079, 11], [103080, 103082, 5], [103083, 103085, 10], [103090, 103093, 5], [103097, 103099, 5], [103100, 103102, 10], [103107, 103109, 5], [103110, 103112, 10], [103113, 103116, 5], [103117, 103120, 10], [103153, 103157, 5], [103158, 103162, 10], [103163, 103165, 5], [103166, 103168, 11], [103169, 103171, 10], [103186, 103188, 5], [103189, 103191, 10], [103192, 103195, 5], [103196, 103199, 10], [103200, 103224, 5], [103225, 103227, 11], [103232, 103237, 5], [103238, 103243, 10], [103244, 103246, 5], [103247, 103249, 10], [103254, 103256, 5], [103257, 103259, 10], [103264, 103266, 5], [103267, 103269, 10], [103300, 103375, 5], [103381, 103383, 5], [103384, 103386, 11], [103387, 103389, 5], [103390, 103392, 10], [103397, 103399, 5], [103400, 103471, 10], [103476, 103478, 5], [103479, 103481, 10], [103486, 103488, 5], [103489, 103491, 10], [103492, 103495, 5], [103496, 103499, 10], [103539, 103543, 5], [103544, 103548, 10], [103549, 103551, 5], [103552, 103554, 11], [103555, 103557, 10], [103558, 103560, 5], [103571, 103573, 5], [103574, 103576, 10], [103577, 103580, 5], [103581, 103583, 10], [103595, 103597, 5], [103600, 103694, 5], [103696, 103698, 5], [103700, 103793, 10], [103794, 103799, 5]], gcsid: [4001, 81, 4002, 85, 4003, 70, 4004, 84, 4005, 82, 4006, 83, 4007, 60, 4008, 67, 4009, 39, 4010, 57, 4011, 63, 4012, 64, 4013, 64, 4014, 63, 4015, 92, 4016, 90, 4018, 86, 4019, 75, 4020, 68, 4021, 70, 4022, 55, 4023, 75, 4024, 66, 4025, 73, 4027, 95, 4028, 59, 4029, 58, 4031, 75, 4032, 78, 4033, 77, 4034, 65, 4035, 100, 4036, 70, 4042, 88, 4044, 87, 4045, 89, 4046, 75, 4047, 99, 4052, 101, 4053, 97, 4054, 61, 4075, 75, 4081, 75, 4120, 84, 4121, 75, 4122, 80, 4123, 55, 4124, 84, 4126, 75, 4130, 75, 4131, 92, 4132, 64, 4133, 75, 4134, 64, 4140, 75, 4141, 75, 4142, 64, 4143, 64, 4144, 92, 4145, 87, 4146, 89, 4147, 66, 4148, 75, 4149, 84, 4150, 84, 4151, 75, 4152, 75, 4153, 55, 4154, 55, 4155, 63, 4156, 84, 4157, 60, 4162, 84, 4163, 75, 4164, 66, 4165, 55, 4166, 75, 4168, 58, 4170, 75, 4172, 75, 4173, 75, 4174, 58, 4175, 64, 4176, 75, 4178, 66, 4179, 66, 4180, 75, 4188, 81, 4190, 75, 4191, 66, 4192, 55, 4193, 63, 4198, 64, 4199, 55, 4200, 66, 4201, 64, 4202, 70, 4203, 70, 4204, 55, 4205, 66, 4206, 63, 4207, 55, 4208, 55, 4209, 64, 4210, 64, 4211, 84, 4212, 64, 4213, 63, 4214, 66, 4215, 55, 4216, 67, 4218, 55, 4219, 84, 4220, 64, 4221, 55, 4222, 64, 4224, 55, 4225, 55, 4229, 68, 4230, 55, 4231, 55, 4232, 64, 4234, 64, 4235, 55, 4236, 55, 4237, 70, 4238, 70, 4239, 92, 4240, 92, 4241, 65, 4242, 67, 4243, 88, 4244, 92, 4245, 86, 4246, 64, 4250, 64, 4251, 64, 4252, 63, 4253, 67, 4254, 55, 4255, 55, 4256, 64, 4257, 84, 4258, 75, 4259, 55, 4260, 64, 4261, 106, 4262, 84, 4263, 64, 4265, 55, 4266, 63, 4267, 67, 4269, 75, 4270, 64, 4271, 55, 4272, 55, 4273, 82, 4274, 55, 4275, 63, 4276, 73, 4280, 84, 4281, 57, 4282, 63, 4283, 75, 4284, 66, 4285, 55, 4286, 68, 4288, 55, 4289, 84, 4291, 70, 4292, 55, 4293, 83, 4294, 84, 4295, 84, 4296, 63, 4297, 55, 4298, 90, 4299, 85, 4300, 85, 4301, 84, 4302, 60, 4303, 68, 4306, 84, 4307, 64, 4308, 84, 4309, 55, 4310, 63, 4311, 55, 4312, 84, 4313, 55, 4314, 84, 4315, 63, 4316, 55, 4317, 66, 4318, 75, 4319, 75, 4322, 80, 4324, 80, 4326, 75, 4466, 75, 4469, 75, 4475, 55, 4483, 75, 4490, 75, 4555, 66, 4558, 75, 4608, 67, 4609, 67, 4610, 74, 4614, 55, 4619, 75, 4624, 75, 4625, 55, 4627, 75, 4636, 55, 4637, 55, 4638, 67, 4639, 55, 4657, 93, 4659, 75, 4660, 55, 4661, 75, 4666, 84, 4667, 75, 4670, 75, 4671, 63, 4674, 75, 4679, 64, 4680, 64, 4682, 92, 4683, 67, 4686, 75, 4687, 75, 4693, 75, 4694, 75, 4695, 67, 4696, 64, 4697, 64, 4702, 75, 4703, 64, 4704, 55, 4705, 55, 4706, 68, 4718, 55, 4720, 80, 4721, 55, 4723, 67, 4726, 67, 4737, 75, 4738, 60, 4740, 79, 4741, 55, 4742, 75, 4743, 64, 4744, 64, 4745, 84, 4746, 84, 4747, 75, 4748, 56, 4749, 75, 4750, 75, 4751, 91, 4752, 56, 4753, 55, 4754, 55, 4759, 75, 4761, 75, 4801, 84, 4802, 55, 4803, 55, 4804, 84, 4805, 84, 4806, 55, 4807, 106, 4808, 84, 4809, 55, 4810, 105, 4811, 106, 4816, 106, 4817, 82, 4818, 84, 4820, 84, 4821, 106, 4823, 55, 4824, 55, 4901, 107, 4902, 107, 4903, 59, 4904, 84, 5228, 84, 5229, 84, 5233, 92, 5252, 75, 5264, 75, 5340, 75, 5354, 75, 5360, 75, 5371, 75, 5373, 75, 5381, 75, 5393, 75, 5464, 60, 5467, 67, 5489, 75, 5524, 55, 5527, 70, 5546, 75, 5561, 66, 5593, 75, 5681, 84, 5886, 75, 6135, 75, 6365, 75, 6706, 75, 6881, 64, 6882, 64, 6883, 55, 6892, 64, 6894, 64, 6980, 75, 6983, 75, 6987, 75, 6990, 75, 7035, 75, 7037, 75, 7039, 75, 7041, 75, 7073, 75, 7084, 75, 7086, 75, 7133, 75, 7373, 75, 7683, 76, 7798, 75, 7844, 75, 7881, 75, 7886, 75, 8042, 96, 8043, 96, 8086, 75, 8232, 75, 8237, 75, 8240, 75, 8246, 75, 8249, 75, 8252, 75, 8255, 75, 8351, 84, 8427, 75, 8428, 55, 8449, 75, 8545, 75, 8685, 75, 8694, 64, 8699, 75, 8818, 75, 8888, 75, 8900, 75, 8902, 75, 8907, 75, 8949, 75, 9003, 75, 9006, 75, 9009, 75, 9012, 75, 9017, 75, 9068, 75, 9069, 75, 9140, 75, 9148, 75, 9153, 75, 37001, 73, 37002, 69, 37003, 72, 37004, 71, 37005, 62, 37006, 91, 37007, 94, 37008, 101, 37201, 55, 37202, 92, 37203, 87, 37204, 55, 37205, 55, 37206, 64, 37207, 71, 37208, 64, 37211, 64, 37220, 67, 37221, 55, 37222, 55, 37223, 63, 37224, 55, 37225, 106, 37226, 55, 37227, 55, 37228, 64, 37229, 62, 37230, 55, 37231, 70, 37232, 55, 37233, 55, 37235, 55, 37237, 55, 37238, 55, 37239, 67, 37240, 64, 37241, 55, 37242, 55, 37243, 67, 37252, 67, 37253, 55, 37254, 64, 37255, 84, 37257, 66, 37259, 55, 37260, 67, 104017, 79, 104018, 79, 104024, 75, 104027, 75, 104047, 98, 104050, 75, 104100, 75, 104101, 84, 104102, 84, 104103, 64, 104104, 55, 104105, 84, 104106, 55, 104107, 75, 104108, 75, 104109, 67, 104110, 75, 104111, 75, 104112, 67, 104113, 67, 104128, 102, 104129, 75, 104130, 55, 104131, 84, 104132, 67, 104133, 75, 104134, 75, 104135, 66, 104136, 70, 104137, 75, 104138, 55, 104139, 106, 104140, 106, 104223, 75, 104248, 55, 104256, 92, 104261, 63, 104286, 75, 104287, 75, 104304, 63, 104700, 49, 104701, 9, 104702, 24, 104703, 15, 104704, 28, 104705, 32, 104706, 53, 104707, 46, 104708, 37, 104709, 54, 104710, 11, 104711, 14, 104712, 30, 104713, 52, 104714, 4, 104715, 4, 104716, 23, 104717, 14, 104718, 48, 104719, 29, 104720, 22, 104721, 21, 104722, 35, 104723, 21, 104724, 46, 104725, 22, 104726, 49, 104727, 45, 104728, 52, 104729, 10, 104730, 10, 104731, 21, 104732, 31, 104733, 26, 104734, 40, 104735, 19, 104736, 30, 104737, 34, 104738, 27, 104739, 46, 104740, 5, 104741, 12, 104742, 50, 104743, 9, 104744, 43, 104745, 21, 104746, 26, 104747, 25, 104748, 21, 104749, 7, 104750, 53, 104751, 6, 104752, 33, 104753, 29, 104754, 19, 104755, 41, 104756, 31, 104757, 3, 104758, 41, 104759, 25, 104760, 49, 104761, 41, 104762, 44, 104763, 50, 104764, 46, 104765, 6, 104766, 40, 104767, 16, 104768, 8, 104769, 17, 104770, 48, 104771, 42, 104772, 50, 104773, 25, 104774, 29, 104775, 25, 104776, 32, 104777, 13, 104778, 36, 104779, 47, 104780, 14, 104781, 29, 104782, 23, 104783, 38, 104784, 42, 104785, 18, 104786, 20, 104808, 51, 104896, 75, 104900, 112, 104901, 104, 104902, 103, 104903, 116, 104904, 109, 104905, 108, 104906, 169, 104907, 164, 104908, 0, 104909, 168, 104910, 141, 104911, 166, 104912, 114, 104913, 160, 104914, 151, 104915, 117, 104916, 110, 104917, 140, 104918, 115, 104919, 170, 104920, 163, 104921, 154, 104922, 158, 104923, 161, 104924, 148, 104925, 0, 104926, 159, 104927, 167, 104928, 127, 104929, 131, 104930, 145, 104931, 159, 104932, 136, 104933, 123, 104934, 139, 104935, 134, 104936, 166, 104937, 150, 104938, 137, 104939, 147, 104940, 121, 104941, 165, 104942, 128, 104943, 111, 104944, 1, 104945, 126, 104946, 152, 104947, 157, 104948, 162, 104949, 153, 104950, 156, 104951, 149, 104952, 132, 104953, 122, 104954, 160, 104955, 146, 104956, 143, 104957, 156, 104958, 120, 104959, 125, 104960, 2, 104961, 144, 104962, 142, 104963, 138, 104964, 155, 104965, 135, 104966, 133, 104967, 151, 104968, 118, 104969, 119, 104970, 124, 104971, 108, 104972, 129, 104973, 130, 104974, 113, 104975, 0, 104990, 84, 104991, 75, 104992, 84], gcsidc: [[4127, 4129, 67], [4135, 4139, 67], [4158, 4161, 55], [4181, 4185, 55], [4194, 4196, 55], [4226, 4228, 63], [4247, 4249, 55], [4277, 4279, 81], [4600, 4607, 64], [4621, 4623, 55], [4628, 4633, 55], [4641, 4646, 55], [4662, 4665, 55], [4676, 4678, 66], [4688, 4692, 55], [4699, 4701, 64], [4755, 4757, 75], [4763, 4765, 75], [4813, 4815, 84], [8972, 8987, 75], [37212, 37219, 55], [37245, 37247, 55], [37249, 37251, 55], [104009, 104015, 75], [104019, 104022, 75], [104114, 104124, 75], [104125, 104127, 55], [104141, 104145, 75], [104179, 104186, 75], [104257, 104260, 75]] }, s4 = { c: [[2e3, 2035, 9001], [2039, 2045, 9001], [2056, 2062, 9001], [2067, 2090, 9001], [2093, 2135, 9001], [2161, 2165, 9001], [2172, 2180, 9001], [2188, 2193, 9001], [2195, 2198, 9001], [2200, 2203, 9001], [2205, 2213, 9001], [2215, 2217, 9001], [2222, 2224, 9002], [2225, 2243, 9003], [2246, 2250, 9003], [2251, 2253, 9002], [2257, 2264, 9003], [2274, 2279, 9003], [2280, 2282, 9002], [2283, 2289, 9003], [2308, 2313, 9001], [2315, 2491, 9001], [2494, 2576, 9001], [2578, 2599, 9001], [2601, 2693, 9001], [2695, 2866, 9001], [2867, 2869, 9002], [2870, 2888, 9003], [2891, 2895, 9003], [2896, 2898, 9002], [2902, 2908, 9003], [2915, 2920, 9003], [2921, 2923, 9002], [2924, 2930, 9003], [2931, 2933, 9001], [2935, 2962, 9001], [2964, 2968, 9003], [2969, 2973, 9001], [2975, 2978, 9001], [2984, 2988, 9001], [2995, 3051, 9001], [3054, 3072, 9001], [3077, 3079, 9001], [3081, 3088, 9001], [3092, 3101, 9001], [3106, 3138, 9001], [3146, 3151, 9001], [3153, 3166, 9001], [3168, 3172, 9001], [3174, 3203, 9001], [3294, 3313, 9001], [3315, 3348, 9001], [3350, 3358, 9001], [3367, 3403, 9001], [3408, 3416, 9001], [3417, 3438, 9003], [3441, 3446, 9003], [3447, 3450, 9001], [3451, 3453, 9003], [3455, 3459, 9003], [3460, 3478, 9001], [3554, 3559, 9001], [3560, 3570, 9003], [3571, 3581, 9001], [3594, 3597, 9001], [3601, 3604, 9001], [3637, 3639, 9001], [3665, 3667, 9001], [3693, 3695, 9001], [3701, 3727, 9001], [3728, 3739, 9003], [3740, 3751, 9001], [3753, 3760, 9003], [3761, 3773, 9001], [3775, 3777, 9001], [3779, 3781, 9001], [3788, 3791, 9001], [3797, 3802, 9001], [3814, 3816, 9001], [3825, 3829, 9001], [3832, 3841, 9001], [3844, 3852, 9001], [3873, 3885, 9001], [3890, 3893, 9001], [3942, 3950, 9001], [3968, 3970, 9001], [3973, 3976, 9001], [3986, 3989, 9001], [3994, 3997, 9001], [4001, 4016, 9102], [4018, 4025, 9102], [4027, 4029, 9102], [4031, 4036, 9102], [4044, 4047, 9102], [4048, 4051, 9001], [4052, 4054, 9102], [4056, 4063, 9001], [4093, 4096, 9001], [4120, 4124, 9102], [4127, 4139, 9102], [4141, 4176, 9102], [4178, 4185, 9102], [4188, 4216, 9102], [4218, 4232, 9102], [4235, 4260, 9102], [4265, 4267, 9102], [4269, 4286, 9102], [4292, 4304, 9102], [4306, 4319, 9102], [4390, 4398, 9001], [4399, 4413, 9003], [4418, 4433, 9003], [4455, 4457, 9003], [4484, 4489, 9001], [4491, 4554, 9001], [4568, 4589, 9001], [4600, 4630, 9102], [4636, 4639, 9102], [4641, 4646, 9102], [4652, 4656, 9001], [4657, 4680, 9102], [4682, 4684, 9102], [4686, 4765, 9102], [4766, 4800, 9001], [4801, 4806, 9102], [4813, 4815, 9102], [5014, 5016, 9001], [5069, 5072, 9001], [5105, 5130, 9001], [5173, 5188, 9001], [5253, 5259, 9001], [5269, 5275, 9001], [5292, 5311, 9001], [5329, 5331, 9001], [5343, 5349, 9001], [5355, 5357, 9001], [5459, 5463, 9001], [5479, 5482, 9001], [5518, 5520, 9001], [5533, 5539, 9001], [5550, 5552, 9001], [5562, 5583, 9001], [5623, 5625, 9003], [5631, 5639, 9001], [5649, 5653, 9001], [5663, 5680, 9001], [5682, 5685, 9001], [5875, 5877, 9001], [5896, 5899, 9001], [5921, 5940, 9001], [6050, 6125, 9001], [6244, 6275, 9001], [6328, 6348, 9001], [6350, 6356, 9001], [6366, 6372, 9001], [6381, 6387, 9001], [6393, 6404, 9001], [6480, 6483, 9001], [6511, 6514, 9001], [6579, 6581, 9001], [6619, 6624, 9001], [6625, 6627, 9003], [6628, 6632, 9001], [6634, 6637, 9001], [6669, 6692, 9001], [6707, 6709, 9001], [6720, 6723, 9001], [6732, 6738, 9001], [6881, 6883, 9102], [6931, 6933, 9001], [7005, 7007, 9001], [7057, 7070, 9003], [7074, 7082, 9001], [7109, 7118, 9001], [7119, 7127, 9002], [7374, 7376, 9001], [7528, 7586, 9001], [7587, 7645, 9003], [7692, 7696, 9001], [7755, 7787, 9001], [7791, 7795, 9001], [7799, 7801, 9001], [7803, 7805, 9001], [7825, 7831, 9001], [7845, 7859, 9001], [8013, 8032, 9001], [8065, 8068, 9002], [8518, 8529, 9003], [8533, 8536, 9003], [8538, 8540, 9003], [8677, 8679, 9001], [8836, 8840, 9001], [8857, 8859, 9001], [8908, 8910, 9001], [8972, 9e3, 9102], [9053, 9057, 9102], [9059, 9069, 9102], [9154, 9159, 9001], [9205, 9218, 9001], [20002, 20032, 9001], [20062, 20092, 9001], [20135, 20138, 9001], [20248, 20258, 9001], [20348, 20358, 9001], [20436, 20440, 9001], [20822, 20824, 9001], [20934, 20936, 9001], [21035, 21037, 9001], [21095, 21097, 9001], [21148, 21150, 9001], [21413, 21423, 9001], [21473, 21483, 9001], [21780, 21782, 9001], [21896, 21899, 9001], [22171, 22177, 9001], [22181, 22187, 9001], [22191, 22197, 9001], [22234, 22236, 9001], [22521, 22525, 9001], [22991, 22994, 9001], [23028, 23038, 9001], [23830, 23853, 9001], [23866, 23872, 9001], [23877, 23884, 9001], [23886, 23894, 9001], [23946, 23948, 9001], [24311, 24313, 9001], [24342, 24347, 9001], [24370, 24374, 9084], [24375, 24381, 9001], [24718, 24721, 9001], [24817, 24821, 9001], [24877, 24882, 9001], [24891, 24893, 9001], [25391, 25395, 9001], [25828, 25838, 9001], [26191, 26195, 9001], [26391, 26393, 9001], [26701, 26722, 9001], [26729, 26746, 9003], [26748, 26760, 9003], [26766, 26799, 9003], [26847, 26870, 9003], [26891, 26899, 9001], [26901, 26923, 9001], [26929, 26946, 9001], [26948, 26978, 9001], [26980, 26998, 9001], [27037, 27040, 9001], [27205, 27232, 9001], [27258, 27260, 9001], [27391, 27398, 9001], [27561, 27564, 9001], [27571, 27574, 9001], [27581, 27584, 9001], [27591, 27594, 9001], [28191, 28193, 9001], [28348, 28358, 9001], [28402, 28432, 9001], [28462, 28492, 9001], [29168, 29172, 9001], [29187, 29195, 9001], [29901, 29903, 9001], [30161, 30179, 9001], [30491, 30494, 9001], [30729, 30732, 9001], [31251, 31259, 9001], [31265, 31268, 9001], [31275, 31277, 9001], [31281, 31290, 9001], [31466, 31469, 9001], [31491, 31495, 9001], [31965, 32e3, 9001], [32001, 32003, 9003], [32005, 32017, 9003], [32019, 32028, 9003], [32033, 32035, 9003], [32037, 32060, 9003], [32064, 32067, 9003], [32081, 32086, 9001], [32107, 32130, 9001], [32133, 32158, 9001], [32164, 32167, 9003], [32180, 32199, 9001], [32201, 32260, 9001], [32301, 32360, 9001], [32601, 32662, 9001], [32664, 32667, 9003], [32701, 32761, 9001], [37002, 37008, 9102], [53001, 53004, 9001], [53008, 53019, 9001], [53021, 53032, 9001], [53034, 53037, 9001], [53042, 53046, 9001], [53074, 53080, 9001], [54001, 54004, 9001], [54008, 54019, 9001], [54021, 54032, 9001], [54042, 54046, 9001], [54048, 54053, 9001], [54074, 54080, 9001], [54098, 54101, 9001], [102001, 102005, 9001], [102007, 102039, 9001], [102042, 102045, 9001], [102060, 102063, 9001], [102070, 102079, 9001], [102096, 102099, 9001], [102101, 102109, 9001], [102114, 102117, 9001], [102132, 102138, 9001], [102141, 102144, 9001], [102156, 102166, 9001], [102173, 102179, 9001], [102191, 102198, 9001], [102221, 102228, 9001], [102231, 102233, 9001], [102237, 102240, 9001], [102364, 102375, 9001], [102389, 102398, 9003], [102399, 102419, 9001], [102421, 102438, 9001], [102445, 102447, 9003], [102450, 102458, 9001], [102459, 102462, 9003], [102470, 102489, 9001], [102550, 102556, 9001], [102562, 102588, 9001], [102629, 102640, 9003], [102648, 102650, 9003], [102688, 102690, 9003], [102696, 102700, 9003], [102701, 102703, 9001], [102799, 102900, 9001], [103166, 103168, 9002], [103220, 103224, 9001], [103225, 103227, 9002], [103232, 103237, 9001], [103238, 103243, 9003], [103244, 103246, 9001], [103247, 103249, 9003], [103254, 103256, 9001], [103257, 103259, 9003], [103264, 103266, 9001], [103267, 103269, 9003], [103327, 103330, 9001], [103344, 103347, 9001], [103372, 103375, 9001], [103381, 103383, 9001], [103384, 103386, 9002], [103387, 103389, 9001], [103390, 103392, 9003], [103397, 103399, 9001], [103427, 103430, 9003], [103444, 103447, 9003], [103476, 103478, 9001], [103479, 103481, 9003], [103486, 103488, 9001], [103489, 103491, 9003], [103492, 103495, 9001], [103496, 103499, 9003], [103539, 103543, 9001], [103544, 103548, 9003], [103549, 103551, 9001], [103552, 103554, 9002], [103555, 103557, 9003], [103558, 103560, 9001], [103571, 103573, 9001], [103574, 103576, 9003], [103577, 103580, 9001], [103581, 103583, 9003], [103595, 103597, 9001], [103600, 103694, 9001], [103696, 103698, 9001], [103700, 103793, 9003], [104101, 104103, 9102], [104126, 104131, 9102], [104259, 104261, 9102], [104700, 104786, 9102], [104900, 104975, 9102]], nc: [2065, 9001, 2066, 9039, 2136, 9094, 2137, 9001, 2138, 9001, 2154, 9001, 2157, 9001, 2158, 9001, 2159, 9094, 2160, 9094, 2169, 9001, 2170, 9001, 2204, 9003, 2219, 9001, 2220, 9001, 2254, 9003, 2255, 9003, 2256, 9002, 2265, 9002, 2266, 9002, 2267, 9003, 2268, 9003, 2269, 9002, 2270, 9002, 2271, 9003, 2272, 9003, 2273, 9002, 2290, 9001, 2294, 9001, 2295, 9001, 2314, 9005, 2899, 9003, 2900, 9003, 2901, 9002, 2909, 9002, 2910, 9002, 2911, 9003, 2912, 9003, 2913, 9002, 2914, 9002, 2980, 9001, 2981, 9001, 2991, 9001, 2992, 9002, 2993, 9001, 2994, 9002, 3074, 9001, 3075, 9001, 3080, 9002, 3089, 9003, 3090, 9001, 3091, 9003, 3102, 9003, 3141, 9001, 3142, 9001, 3167, 9301, 3360, 9001, 3361, 9002, 3362, 9001, 3363, 9003, 3364, 9001, 3365, 9003, 3404, 9003, 3405, 9001, 3406, 9001, 3407, 9005, 3439, 9001, 3440, 9001, 3479, 9002, 3480, 9001, 3481, 9002, 3482, 9001, 3483, 9002, 3484, 9001, 3485, 9003, 3486, 9001, 3487, 9003, 3488, 9001, 3489, 9001, 3490, 9003, 3491, 9001, 3492, 9003, 3493, 9001, 3494, 9003, 3495, 9001, 3496, 9003, 3497, 9001, 3498, 9003, 3499, 9001, 3500, 9003, 3501, 9001, 3502, 9003, 3503, 9001, 3504, 9003, 3505, 9001, 3506, 9003, 3507, 9001, 3508, 9003, 3509, 9001, 3510, 9003, 3511, 9001, 3512, 9003, 3513, 9001, 3514, 9001, 3515, 9003, 3516, 9001, 3517, 9003, 3518, 9001, 3519, 9003, 3520, 9001, 3521, 9003, 3522, 9001, 3523, 9003, 3524, 9001, 3525, 9003, 3526, 9001, 3527, 9003, 3528, 9001, 3529, 9003, 3530, 9001, 3531, 9003, 3532, 9001, 3533, 9003, 3534, 9001, 3535, 9003, 3536, 9001, 3537, 9003, 3538, 9001, 3539, 9003, 3540, 9001, 3541, 9003, 3542, 9001, 3543, 9003, 3544, 9001, 3545, 9003, 3546, 9001, 3547, 9003, 3548, 9001, 3549, 9003, 3550, 9001, 3551, 9003, 3552, 9001, 3553, 9003, 3582, 9003, 3583, 9001, 3584, 9003, 3585, 9001, 3586, 9003, 3587, 9001, 3588, 9002, 3589, 9001, 3590, 9002, 3591, 9001, 3592, 9001, 3593, 9002, 3598, 9003, 3599, 9001, 3600, 9003, 3605, 9002, 3606, 9001, 3607, 9001, 3608, 9003, 3609, 9001, 3610, 9003, 3611, 9001, 3612, 9003, 3613, 9001, 3614, 9003, 3615, 9001, 3616, 9003, 3617, 9001, 3618, 9003, 3619, 9001, 3620, 9003, 3621, 9001, 3622, 9003, 3623, 9001, 3624, 9003, 3625, 9001, 3626, 9003, 3627, 9001, 3628, 9003, 3629, 9001, 3630, 9003, 3631, 9001, 3632, 9003, 3633, 9001, 3634, 9002, 3635, 9001, 3636, 9002, 3640, 9003, 3641, 9001, 3642, 9003, 3643, 9001, 3644, 9002, 3645, 9001, 3646, 9002, 3647, 9001, 3648, 9002, 3649, 9001, 3650, 9003, 3651, 9001, 3652, 9003, 3653, 9001, 3654, 9003, 3655, 9001, 3656, 9002, 3657, 9001, 3658, 9003, 3659, 9001, 3660, 9003, 3661, 9001, 3662, 9003, 3663, 9001, 3664, 9003, 3668, 9003, 3669, 9001, 3670, 9003, 3671, 9001, 3672, 9003, 3673, 9001, 3674, 9003, 3675, 9001, 3676, 9002, 3677, 9003, 3678, 9001, 3679, 9002, 3680, 9003, 3681, 9001, 3682, 9002, 3683, 9003, 3684, 9001, 3685, 9001, 3686, 9003, 3687, 9001, 3688, 9003, 3689, 9001, 3690, 9003, 3691, 9001, 3692, 9003, 3696, 9003, 3697, 9001, 3698, 9003, 3699, 9001, 3700, 9003, 3783, 9001, 3784, 9001, 3793, 9001, 3794, 9001, 3812, 9001, 3819, 9102, 3821, 9102, 3824, 9102, 3854, 9001, 3857, 9001, 3889, 9102, 3906, 9102, 3911, 9001, 3912, 9001, 3920, 9001, 3978, 9001, 3979, 9001, 3991, 9003, 3992, 9003, 4026, 9001, 4037, 9001, 4038, 9001, 4042, 9102, 4071, 9001, 4075, 9102, 4081, 9102, 4082, 9001, 4083, 9001, 4087, 9001, 4088, 9001, 4217, 9003, 4261, 9105, 4262, 9102, 4263, 9102, 4288, 9102, 4289, 9102, 4322, 9102, 4324, 9102, 4326, 9102, 4414, 9001, 4415, 9001, 4417, 9001, 4434, 9001, 4437, 9001, 4438, 9003, 4439, 9003, 4462, 9001, 4463, 9102, 4467, 9001, 4470, 9102, 4471, 9001, 4475, 9102, 4483, 9102, 4490, 9102, 4555, 9102, 4558, 9102, 4559, 9001, 4632, 9102, 4633, 9102, 4647, 9001, 4807, 9105, 4808, 9102, 4809, 9102, 4810, 9105, 4811, 9105, 4816, 9105, 4817, 9102, 4818, 9102, 4820, 9102, 4821, 9105, 4822, 9001, 4823, 9102, 4824, 9102, 4826, 9001, 4839, 9001, 4901, 9105, 4902, 9105, 4903, 9102, 4904, 9102, 5013, 9102, 5018, 9001, 5048, 9001, 5167, 9001, 5168, 9001, 5221, 9001, 5223, 9001, 5228, 9102, 5229, 9102, 5233, 9102, 5234, 9001, 5235, 9001, 5243, 9001, 5246, 9102, 5247, 9001, 5252, 9102, 5264, 9102, 5266, 9001, 5316, 9001, 5320, 9001, 5321, 9001, 5324, 9102, 5325, 9001, 5337, 9001, 5340, 9102, 5354, 9102, 5360, 9102, 5361, 9001, 5362, 9001, 5365, 9102, 5367, 9001, 5371, 9102, 5373, 9102, 5381, 9102, 5382, 9001, 5383, 9001, 5387, 9001, 5389, 9001, 5393, 9102, 5396, 9001, 5451, 9102, 5456, 9001, 5457, 9001, 5464, 9102, 5467, 9102, 5469, 9001, 5472, 9037, 5489, 9102, 5490, 9001, 5513, 9001, 5514, 9001, 5523, 9001, 5524, 9102, 5527, 9102, 5530, 9001, 5531, 9001, 5546, 9102, 5559, 9001, 5561, 9102, 5588, 9002, 5589, 9005, 5593, 9102, 5596, 9001, 5627, 9001, 5629, 9001, 5641, 9001, 5643, 9001, 5644, 9001, 5646, 9003, 5654, 9003, 5655, 9003, 5659, 9001, 5681, 9102, 5700, 9001, 5825, 9001, 5836, 9001, 5837, 9001, 5839, 9001, 5842, 9001, 5844, 9001, 5858, 9001, 5879, 9001, 5880, 9001, 5886, 9102, 5887, 9001, 5890, 9001, 6128, 9002, 6129, 9002, 6135, 9102, 6204, 9001, 6207, 9102, 6210, 9001, 6211, 9001, 6307, 9001, 6311, 9102, 6312, 9001, 6316, 9001, 6318, 9102, 6322, 9102, 6325, 9102, 6362, 9001, 6365, 9102, 6391, 9002, 6405, 9002, 6406, 9001, 6407, 9002, 6408, 9001, 6409, 9002, 6410, 9001, 6411, 9003, 6412, 9001, 6413, 9003, 6414, 9001, 6415, 9001, 6416, 9003, 6417, 9001, 6418, 9003, 6419, 9001, 6420, 9003, 6421, 9001, 6422, 9003, 6423, 9001, 6424, 9003, 6425, 9001, 6426, 9003, 6427, 9001, 6428, 9003, 6429, 9001, 6430, 9003, 6431, 9001, 6432, 9003, 6433, 9001, 6434, 9003, 6435, 9001, 6436, 9003, 6437, 9001, 6438, 9003, 6439, 9001, 6440, 9001, 6441, 9003, 6442, 9001, 6443, 9003, 6444, 9001, 6445, 9003, 6446, 9001, 6447, 9003, 6448, 9001, 6449, 9003, 6450, 9001, 6451, 9003, 6452, 9001, 6453, 9003, 6454, 9001, 6455, 9003, 6456, 9001, 6457, 9003, 6458, 9001, 6459, 9003, 6460, 9001, 6461, 9003, 6462, 9001, 6463, 9003, 6464, 9001, 6465, 9003, 6466, 9001, 6467, 9003, 6468, 9001, 6469, 9003, 6470, 9001, 6471, 9003, 6472, 9001, 6473, 9003, 6474, 9001, 6475, 9003, 6476, 9001, 6477, 9003, 6478, 9001, 6479, 9003, 6484, 9003, 6485, 9001, 6486, 9003, 6487, 9001, 6488, 9003, 6489, 9001, 6490, 9003, 6491, 9001, 6492, 9003, 6493, 9001, 6494, 9002, 6495, 9001, 6496, 9002, 6497, 9001, 6498, 9001, 6499, 9002, 6500, 9001, 6501, 9003, 6502, 9001, 6503, 9003, 6504, 9001, 6505, 9003, 6506, 9001, 6507, 9003, 6508, 9001, 6509, 9001, 6510, 9003, 6515, 9002, 6516, 9001, 6518, 9001, 6519, 9003, 6520, 9001, 6521, 9003, 6522, 9001, 6523, 9003, 6524, 9001, 6525, 9003, 6526, 9001, 6527, 9003, 6528, 9001, 6529, 9003, 6530, 9001, 6531, 9003, 6532, 9001, 6533, 9003, 6534, 9001, 6535, 9003, 6536, 9001, 6537, 9003, 6538, 9001, 6539, 9003, 6540, 9001, 6541, 9003, 6542, 9001, 6543, 9003, 6544, 9001, 6545, 9002, 6546, 9001, 6547, 9002, 6548, 9001, 6549, 9003, 6550, 9001, 6551, 9003, 6552, 9001, 6553, 9003, 6554, 9001, 6555, 9003, 6556, 9001, 6557, 9002, 6558, 9001, 6559, 9002, 6560, 9001, 6561, 9002, 6562, 9001, 6563, 9003, 6564, 9001, 6565, 9003, 6566, 9001, 6567, 9001, 6568, 9003, 6569, 9001, 6570, 9002, 6571, 9001, 6572, 9003, 6573, 9001, 6574, 9003, 6575, 9001, 6576, 9003, 6577, 9001, 6578, 9003, 6582, 9003, 6583, 9001, 6584, 9003, 6585, 9001, 6586, 9003, 6587, 9001, 6588, 9003, 6589, 9001, 6590, 9003, 6591, 9001, 6592, 9001, 6593, 9003, 6594, 9001, 6595, 9003, 6596, 9001, 6597, 9003, 6598, 9001, 6599, 9003, 6600, 9001, 6601, 9003, 6602, 9001, 6603, 9003, 6605, 9003, 6606, 9001, 6607, 9003, 6608, 9001, 6609, 9003, 6610, 9001, 6611, 9001, 6612, 9003, 6613, 9001, 6614, 9003, 6615, 9001, 6616, 9003, 6617, 9001, 6618, 9003, 6633, 9003, 6646, 9001, 6668, 9102, 6703, 9001, 6706, 9102, 6783, 9102, 6784, 9001, 6785, 9002, 6786, 9001, 6787, 9002, 6788, 9001, 6789, 9002, 6790, 9001, 6791, 9002, 6792, 9001, 6793, 9002, 6794, 9001, 6795, 9002, 6796, 9001, 6797, 9002, 6798, 9001, 6799, 9002, 6800, 9001, 6801, 9002, 6802, 9001, 6803, 9002, 6804, 9001, 6805, 9002, 6806, 9001, 6807, 9002, 6808, 9001, 6809, 9002, 6810, 9001, 6811, 9002, 6812, 9001, 6813, 9002, 6814, 9001, 6815, 9002, 6816, 9001, 6817, 9002, 6818, 9001, 6819, 9002, 6820, 9001, 6821, 9002, 6822, 9001, 6823, 9002, 6824, 9001, 6825, 9002, 6826, 9001, 6827, 9002, 6828, 9001, 6829, 9002, 6830, 9001, 6831, 9002, 6832, 9001, 6833, 9002, 6834, 9001, 6835, 9002, 6836, 9001, 6837, 9002, 6838, 9001, 6839, 9002, 6840, 9001, 6841, 9002, 6842, 9001, 6843, 9002, 6844, 9001, 6845, 9002, 6846, 9001, 6847, 9002, 6848, 9001, 6849, 9002, 6850, 9001, 6851, 9002, 6852, 9001, 6853, 9002, 6854, 9001, 6855, 9002, 6856, 9001, 6857, 9002, 6858, 9001, 6859, 9002, 6860, 9001, 6861, 9002, 6862, 9001, 6863, 9002, 6867, 9001, 6868, 9002, 6870, 9001, 6875, 9001, 6876, 9001, 6879, 9001, 6880, 9003, 6884, 9001, 6885, 9002, 6886, 9001, 6887, 9002, 6892, 9102, 6894, 9102, 6915, 9001, 6922, 9001, 6923, 9003, 6924, 9001, 6925, 9003, 6962, 9001, 6983, 9102, 6984, 9001, 6990, 9102, 6991, 9001, 7035, 9102, 7037, 9102, 7039, 9102, 7041, 9102, 7073, 9102, 7084, 9102, 7086, 9102, 7128, 9003, 7131, 9001, 7132, 9003, 7133, 9102, 7136, 9102, 7139, 9102, 7142, 9001, 7257, 9001, 7258, 9003, 7259, 9001, 7260, 9003, 7261, 9001, 7262, 9003, 7263, 9001, 7264, 9003, 7265, 9001, 7266, 9003, 7267, 9001, 7268, 9003, 7269, 9001, 7270, 9003, 7271, 9001, 7272, 9003, 7273, 9001, 7274, 9003, 7275, 9001, 7276, 9003, 7277, 9001, 7278, 9003, 7279, 9001, 7280, 9003, 7281, 9001, 7282, 9003, 7283, 9001, 7284, 9003, 7285, 9001, 7286, 9003, 7287, 9001, 7288, 9003, 7289, 9001, 7290, 9003, 7291, 9001, 7292, 9003, 7293, 9001, 7294, 9003, 7295, 9001, 7296, 9003, 7297, 9001, 7298, 9003, 7299, 9001, 7300, 9003, 7301, 9001, 7302, 9003, 7303, 9001, 7304, 9003, 7305, 9001, 7306, 9003, 7307, 9001, 7308, 9003, 7309, 9001, 7310, 9003, 7311, 9001, 7312, 9003, 7313, 9001, 7314, 9003, 7315, 9001, 7316, 9003, 7317, 9001, 7318, 9003, 7319, 9001, 7320, 9003, 7321, 9001, 7322, 9003, 7323, 9001, 7324, 9003, 7325, 9001, 7326, 9003, 7327, 9001, 7328, 9003, 7329, 9001, 7330, 9003, 7331, 9001, 7332, 9003, 7333, 9001, 7334, 9003, 7335, 9001, 7336, 9003, 7337, 9001, 7338, 9003, 7339, 9001, 7340, 9003, 7341, 9001, 7342, 9003, 7343, 9001, 7344, 9003, 7345, 9001, 7346, 9003, 7347, 9001, 7348, 9003, 7349, 9001, 7350, 9003, 7351, 9001, 7352, 9003, 7353, 9001, 7354, 9003, 7355, 9001, 7356, 9003, 7357, 9001, 7358, 9003, 7359, 9001, 7360, 9003, 7361, 9001, 7362, 9003, 7363, 9001, 7364, 9003, 7365, 9001, 7366, 9003, 7367, 9001, 7368, 9003, 7369, 9001, 7370, 9003, 7373, 9102, 7683, 9102, 7798, 9102, 7844, 9102, 7877, 9001, 7878, 9001, 7881, 9102, 7882, 9001, 7883, 9001, 7886, 9102, 7887, 9001, 7899, 9001, 7991, 9001, 7992, 9001, 8035, 9003, 8036, 9003, 8042, 9102, 8043, 9102, 8058, 9001, 8059, 9001, 8082, 9001, 8083, 9001, 8086, 9102, 8088, 9001, 8090, 9001, 8091, 9003, 8092, 9001, 8093, 9003, 8095, 9001, 8096, 9003, 8097, 9001, 8098, 9003, 8099, 9001, 8100, 9003, 8101, 9001, 8102, 9003, 8103, 9001, 8104, 9003, 8105, 9001, 8106, 9003, 8107, 9001, 8108, 9003, 8109, 9001, 8110, 9003, 8111, 9001, 8112, 9003, 8113, 9001, 8114, 9003, 8115, 9001, 8116, 9003, 8117, 9001, 8118, 9003, 8119, 9001, 8120, 9003, 8121, 9001, 8122, 9003, 8123, 9001, 8124, 9003, 8125, 9001, 8126, 9003, 8127, 9001, 8128, 9003, 8129, 9001, 8130, 9003, 8131, 9001, 8132, 9003, 8133, 9001, 8134, 9003, 8135, 9001, 8136, 9003, 8137, 9001, 8138, 9003, 8139, 9001, 8140, 9003, 8141, 9001, 8142, 9003, 8143, 9001, 8144, 9003, 8145, 9001, 8146, 9003, 8147, 9001, 8148, 9003, 8149, 9001, 8150, 9003, 8151, 9001, 8152, 9003, 8153, 9001, 8154, 9003, 8155, 9001, 8156, 9003, 8157, 9001, 8158, 9003, 8159, 9001, 8160, 9003, 8161, 9001, 8162, 9003, 8163, 9001, 8164, 9003, 8165, 9001, 8166, 9003, 8167, 9001, 8168, 9003, 8169, 9001, 8170, 9003, 8171, 9001, 8172, 9003, 8173, 9001, 8177, 9003, 8179, 9001, 8180, 9003, 8181, 9001, 8182, 9003, 8184, 9001, 8185, 9003, 8187, 9001, 8189, 9003, 8191, 9001, 8193, 9003, 8196, 9001, 8197, 9003, 8198, 9001, 8200, 9003, 8201, 9001, 8202, 9003, 8203, 9001, 8204, 9003, 8205, 9001, 8206, 9003, 8207, 9001, 8208, 9003, 8209, 9001, 8210, 9003, 8212, 9001, 8213, 9003, 8214, 9001, 8216, 9003, 8218, 9001, 8220, 9003, 8222, 9001, 8224, 9003, 8225, 9001, 8226, 9003, 8232, 9102, 8237, 9102, 8240, 9102, 8246, 9102, 8249, 9102, 8252, 9102, 8255, 9102, 8311, 9001, 8312, 9002, 8313, 9001, 8314, 9002, 8315, 9001, 8316, 9002, 8317, 9001, 8318, 9002, 8319, 9001, 8320, 9002, 8321, 9001, 8322, 9002, 8323, 9001, 8324, 9002, 8325, 9001, 8326, 9002, 8327, 9001, 8328, 9002, 8329, 9001, 8330, 9002, 8331, 9001, 8332, 9002, 8333, 9001, 8334, 9002, 8335, 9001, 8336, 9002, 8337, 9001, 8338, 9002, 8339, 9001, 8340, 9002, 8341, 9001, 8342, 9002, 8343, 9001, 8344, 9002, 8345, 9001, 8346, 9002, 8347, 9001, 8348, 9002, 8351, 9102, 8352, 9001, 8353, 9001, 8379, 9001, 8380, 9003, 8381, 9001, 8382, 9003, 8383, 9001, 8384, 9003, 8385, 9001, 8387, 9003, 8391, 9001, 8395, 9001, 8427, 9102, 8428, 9102, 8431, 9102, 8433, 9001, 8441, 9001, 8455, 9001, 8456, 9001, 8531, 9003, 8545, 9102, 8682, 9001, 8685, 9102, 8687, 9001, 8692, 9001, 8693, 9001, 8694, 9102, 8699, 9102, 8818, 9102, 8826, 9001, 8860, 9102, 8888, 9102, 8900, 9102, 8902, 9102, 8903, 9001, 8907, 9102, 8949, 9102, 8950, 9001, 8951, 9001, 9003, 9102, 9006, 9102, 9009, 9102, 9012, 9102, 9014, 9102, 9017, 9102, 9019, 9102, 9039, 9001, 9040, 9001, 9140, 9102, 9141, 9001, 9148, 9102, 9149, 9001, 9150, 9001, 9153, 9102, 9191, 9001, 9221, 9001, 9222, 9001, 20499, 9001, 20538, 9001, 20539, 9001, 20790, 9001, 20791, 9001, 21291, 9001, 21292, 9001, 21500, 9001, 21817, 9001, 21818, 9001, 22032, 9001, 22033, 9001, 22091, 9001, 22092, 9001, 22332, 9001, 22391, 9001, 22392, 9001, 22700, 9001, 22770, 9001, 22780, 9001, 22832, 9001, 23090, 9001, 23095, 9001, 23239, 9001, 23240, 9001, 23700, 9001, 24047, 9001, 24048, 9001, 24100, 9005, 24200, 9001, 24305, 9001, 24306, 9001, 24382, 9084, 24383, 9001, 24500, 9001, 24547, 9001, 24548, 9001, 24571, 9062, 24600, 9001, 25e3, 9001, 25231, 9001, 25884, 9001, 25932, 9001, 26237, 9001, 26331, 9001, 26332, 9001, 26591, 9001, 26592, 9001, 26632, 9001, 26692, 9001, 27120, 9001, 27200, 9001, 27291, 9040, 27292, 9040, 27429, 9001, 27493, 9001, 27500, 9001, 27700, 9001, 28232, 9001, 28600, 9001, 28991, 9001, 28992, 9001, 29101, 9001, 29220, 9001, 29221, 9001, 29333, 9001, 29635, 9001, 29636, 9001, 29701, 9001, 29738, 9001, 29739, 9001, 29849, 9001, 29850, 9001, 29871, 9042, 29872, 9041, 29873, 9001, 30200, 9039, 30339, 9001, 30340, 9001, 30791, 9001, 30792, 9001, 31028, 9001, 31121, 9001, 31154, 9001, 31170, 9001, 31171, 9001, 31279, 9001, 31370, 9001, 31528, 9001, 31529, 9001, 31600, 9001, 31700, 9001, 31838, 9001, 31839, 9001, 31901, 9001, 32030, 9003, 32031, 9003, 32061, 9001, 32062, 9001, 32098, 9001, 32099, 9003, 32100, 9001, 32104, 9001, 32161, 9001, 32766, 9001, 37202, 9102, 37203, 9102, 37206, 9102, 37207, 9102, 37218, 9102, 37221, 9102, 37225, 9105, 37240, 9102, 37241, 9102, 37243, 9102, 37245, 9102, 37249, 9102, 37257, 9102, 37260, 9102, 53048, 9001, 53049, 9001, 54034, 9001, 54090, 9001, 54091, 9001, 65061, 9003, 65062, 9003, 65161, 9001, 102041, 9003, 102064, 9085, 102068, 109030, 102069, 109031, 102093, 9001, 102094, 9001, 102118, 9003, 102120, 9003, 102121, 9003, 102122, 9001, 102150, 9001, 102168, 9001, 102204, 9001, 102212, 9001, 102213, 9001, 102215, 9001, 102216, 9001, 102217, 9003, 102218, 9001, 102219, 9003, 102220, 9003, 102247, 9001, 102299, 9001, 102306, 9001, 102319, 9001, 102328, 9001, 102329, 9001, 102359, 9001, 102360, 9001, 102440, 9001, 102448, 9001, 102464, 9003, 102465, 9003, 102491, 9001, 102492, 9001, 102498, 9001, 102499, 9001, 102525, 9003, 102526, 9003, 102528, 9003, 102529, 9003, 102589, 9003, 102598, 9001, 102599, 9003, 102600, 9003, 102604, 9003, 102661, 9003, 102662, 9003, 102664, 9003, 102665, 9003, 102705, 9003, 102720, 9003, 102721, 9003, 102726, 9003, 102727, 9003, 102733, 9003, 102761, 9003, 102766, 9003, 102974, 9003, 103228, 9001, 103229, 9001, 103230, 9003, 103231, 9003, 103250, 9001, 103251, 9003, 103252, 9001, 103253, 9003, 103260, 9001, 103261, 9001, 103262, 9003, 103263, 9003, 103270, 9001, 103271, 9001, 103272, 9003, 103273, 9003, 103274, 9001, 103275, 9001, 103276, 9003, 103277, 9003, 103278, 9001, 103279, 9001, 103280, 9003, 103281, 9003, 103282, 9001, 103283, 9001, 103284, 9003, 103285, 9003, 103286, 9001, 103287, 9003, 103288, 9001, 103289, 9003, 103290, 9001, 103291, 9003, 103292, 9001, 103293, 9001, 103294, 9003, 103295, 9003, 103296, 9001, 103297, 9001, 103298, 9003, 103299, 9003, 103300, 9001, 103307, 9001, 103313, 9001, 103319, 9001, 103322, 9001, 103323, 9001, 103332, 9001, 103335, 9001, 103338, 9001, 103340, 9001, 103351, 9001, 103358, 9001, 103370, 9001, 103376, 9003, 103377, 9001, 103378, 9001, 103379, 9003, 103380, 9003, 103393, 9001, 103394, 9001, 103395, 9003, 103396, 9003, 103400, 9003, 103407, 9003, 103413, 9003, 103419, 9003, 103422, 9003, 103423, 9003, 103432, 9003, 103435, 9003, 103438, 9003, 103440, 9003, 103451, 9003, 103458, 9003, 103470, 9003, 103472, 9001, 103473, 9002, 103474, 9001, 103475, 9003, 103482, 9001, 103483, 9003, 103484, 9001, 103485, 9003, 103500, 9001, 103501, 9003, 103502, 9001, 103503, 9001, 103504, 9002, 103505, 9002, 103506, 9001, 103507, 9001, 103508, 9003, 103509, 9003, 103510, 9001, 103511, 9001, 103512, 9003, 103513, 9003, 103514, 9001, 103515, 9003, 103516, 9001, 103517, 9003, 103518, 9001, 103519, 9003, 103520, 9001, 103521, 9002, 103522, 9001, 103523, 9001, 103524, 9003, 103525, 9003, 103526, 9001, 103527, 9003, 103561, 9003, 103562, 9003, 103563, 9001, 103564, 9001, 103565, 9003, 103566, 9003, 103567, 9001, 103568, 9001, 103569, 9003, 103570, 9003, 103585, 9003, 103586, 9001, 103587, 9003, 103588, 9002, 103589, 9001, 103590, 9003, 103591, 9002, 103592, 9001, 103593, 9003, 103594, 9002, 103695, 9003, 103846, 9001, 103946, 9003, 104009, 9102, 104017, 9102, 104018, 9102, 104022, 9102, 104024, 9102, 104027, 9102, 104047, 9102, 104050, 9102, 104105, 9102, 104106, 9102, 104109, 9102, 104112, 9102, 104113, 9102, 104134, 9102, 104135, 9102, 104138, 9102, 104139, 9105, 104140, 9105, 104808, 9102] };
      t4.yr = function() {
        function t5() {
        }
        return t5.Ny = function(i5) {
          t5.zp === false && t5.zt();
          var s5 = t5.AQ(i5);
          if (s5 == -1) {
            var n4 = t5.Ax(i5);
            n4 != i5 && (s5 = t5.Ny(n4));
          }
          return s5 == -1 && ((n4 = t5.AK(i5)) != i5 && (s5 = t5.Ny(n4))), s5;
        }, t5.AQ = function(i5) {
          return t5.Hw[i5] !== void 0 ? t5.Hw[i5] : -1;
        }, t5.xQ = function(i5) {
          t5.zp === false && t5.zt();
          var s5 = t5.iF(i5);
          if (s5 == 1e38) {
            var n4 = t5.Ax(i5);
            if (n4 != i5 && (s5 = t5.iF(n4)), s5 == 1e38)
              return 1e-10;
          }
          return s5;
        }, t5.US = function(i5) {
          if (t5.Ks[i5] !== void 0)
            return true;
          var s5 = t5.Ax(i5);
          return s5 != i5 && t5.Ks[s5] !== void 0;
        }, t5.WS = function(i5) {
          if (t5.zo[i5] !== void 0)
            return true;
          var s5 = t5.Ax(i5);
          return s5 != i5 && t5.zo[s5] !== void 0;
        }, t5.iF = function(i5) {
          return t5.zp === false && t5.zt(), t5.Ks[i5] !== void 0 ? t5.Ks[i5] : t5.zo[i5] !== void 0 ? t5.zo[i5] : 1e38;
        }, t5.AK = function(i5) {
          return t5.zp === false && t5.zt(), t5.RA[i5] !== void 0 ? t5.RA[i5] : i5;
        }, t5.Ax = function(i5) {
          return t5.zp === false && t5.zt(), t5.SA[i5] !== void 0 ? t5.SA[i5] : i5;
        }, t5.zt = function() {
          for (var n4, h3 = i4, r3 = 0; r3 < h3.pcsid.length; r3 += 2)
            t5.zo[h3.pcsid[r3]] = h3.pcstol[2 * h3.pcsid[r3 + 1] + 1];
          for (r3 = 0; r3 < h3.pcsidc.length; r3 += 1)
            for (var e3 = (n4 = h3.pcsidc[r3])[0]; e3 <= n4[1]; e3++)
              t5.zo[e3] = h3.pcstol[2 * n4[2] + 1];
          for (r3 = 0; r3 < h3.gcsid.length; r3 += 2)
            t5.Ks[h3.gcsid[r3]] = h3.gcstol[2 * h3.gcsid[r3 + 1] + 1];
          for (r3 = 0; r3 < h3.gcsidc.length; r3 += 1)
            for (e3 = (n4 = h3.gcsidc[r3])[0]; e3 <= n4[1]; e3++)
              t5.zo[e3] = h3.gcstol[2 * n4[2] + 1];
          for (r3 = 0; r3 < s4.c.length; r3 += 1)
            for (e3 = (n4 = s4.c[r3])[0]; e3 <= n4[1]; e3++)
              t5.Hw[e3] = n4[2];
          for (r3 = 0; r3 < s4.nc.length; r3 += 2)
            t5.Hw[s4.nc[r3]] = s4.nc[r3 + 1];
          for (s4 = null, r3 = 0; r3 < h3.newtoold.length; r3 += 2)
            t5.RA[h3.newtoold[r3 + 1]] = h3.newtoold[r3], t5.SA[h3.newtoold[r3]] = h3.newtoold[r3 + 1];
          i4 = null, t5.zp = true;
        }, t5.zp = false, t5.Ks = [], t5.zo = [], t5.RA = [], t5.SA = [], t5.Hw = [], t5;
      }();
    }(Q2 || (Q2 = {})), function(t4) {
      function i4(t5) {
        return t5.length === 0 ? '""' : t5[0] == '"' || t5[0] == "." || "0" <= t5[0] && "9" >= t5[0] ? t5 : '"' + t5.trim() + '"';
      }
      var s4 = [];
      t4.SC = function() {
        function n4() {
        }
        return n4.zQ = function(h3) {
          try {
            for (var r3 = 0; r3 < s4.length; r3++)
              if (s4[r3].wkttext === h3)
                return s4[r3].unit;
            for (var e3, o3 = r3 = "", a3 = false, u3 = 0; u3 < h3.length; u3++) {
              var f3 = h3[u3];
              a3 === true ? f3 == '"' ? h3[u3 + 1] == '"' ? r3 += f3 : a3 = a3 = false : r3 += f3 : /[\s]/.test(f3) || (f3 == "," ? (o3 = r3 !== "" ? o3 + (i4(r3) + ",") : o3 + ",", r3 = "") : f3 == ")" || f3 == "]" ? (o3 = r3 !== "" ? o3 + (i4(r3) + "]}") : o3 + "]}", r3 = "") : f3 == "(" || f3 == "[" ? (o3 += '{ "entity": "' + r3.toUpperCase().trim() + '", "values":[', r3 = "") : f3 == '"' ? (a3 = true, r3 = "") : r3 += f3);
            }
            e3 = JSON.parse(o3);
            var c3 = n4.hF(e3);
            if (c3 === null)
              return null;
            for (e3 = null, f3 = 0; f3 < c3.values.length; f3++)
              if (typeof c3.values[f3] == "object" && c3.values[f3].entity === "UNIT") {
                e3 = c3.values[f3];
                break;
              }
            if (e3 === null)
              return null;
            var l3 = t4.Uc.UO(c3.entity === "GEOGCS" ? 1 : 0, e3.values[1], e3.values[2]);
            return s4.push({ wkttext: h3, unit: l3 }), 10 < s4.length && s4.shift(), l3;
          } catch (p3) {
            return null;
          }
        }, n4.hF = function(t5) {
          if (t5 === null)
            return null;
          if (t5.entity === "GEOGCS" || t5.entity === "PROJCS")
            return t5;
          for (var i5 = [], s5 = 0; s5 < t5.values.length; s5++)
            if (typeof t5.values[s5] == "object" && t5.values[s5].entity !== void 0) {
              if (t5.values[s5].entity === "GEOGCS" || t5.values[s5].entity == "PROJCS")
                return t5.values[s5];
              i5.push(t5.values[s5]);
            }
          for (t5 = 0; t5 < i5.length; t5++)
            if ((s5 = n4.hF(i5[t5])) !== null)
              return s5;
          return null;
        }, n4.yQ = function(t5) {
          var i5 = -1;
          if (t5 != null && 0 < t5.length) {
            var s5 = t5.indexOf("PROJCS");
            if (0 <= s5) {
              var n5 = 0;
              if (0 <= (s5 = t5.lastIndexOf("UNIT")) && 0 < (s5 = t5.indexOf(",", s5 + 4))) {
                s5++;
                var h3 = t5.indexOf("]", s5 + 1);
                if (0 < h3)
                  try {
                    n5 = parseFloat(t5.substring(s5, h3));
                  } catch (e3) {
                    n5 = 0;
                  }
              }
              0 < n5 && (i5 = 1e-3 / n5);
            } else if (0 <= (s5 = t5.indexOf("GEOGCS"))) {
              var r3 = 0;
              if (n5 = 0, 0 < (s5 = t5.indexOf("SPHEROID", s5 + 6)) && 0 < (s5 = t5.indexOf(",", s5 + 8))) {
                if (s5++, 0 < (h3 = t5.indexOf(",", s5 + 1)))
                  try {
                    r3 = parseFloat(t5.substring(s5, h3));
                  } catch (e3) {
                    r3 = 0;
                  }
                if (0 < r3 && (0 <= (s5 = t5.indexOf("UNIT", h3 + 1)) && (0 < (s5 = t5.indexOf(",", s5 + 4)) && (s5++, 0 < (h3 = t5.indexOf("]", s5 + 1))))))
                  try {
                    n5 = parseFloat(t5.substring(s5, h3));
                  } catch (e3) {
                    n5 = 0;
                  }
              }
              0 < r3 && 0 < n5 && (i5 = 1e-3 / (r3 * n5));
            }
          }
          return i5;
        }, n4;
      }();
    }(Q2 || (Q2 = {})), function(t4) {
      var i4;
      (i4 = t4.$K || (t4.$K = {}))[i4.NONE = 0] = "NONE", i4[i4.LINEAR = 1] = "LINEAR", i4[i4.ANGULAR = 2] = "ANGULAR", function(t5) {
        t5[t5.enumFloat = 0] = "enumFloat", t5[t5.enumDouble = 1] = "enumDouble", t5[t5.enumInt32 = 2] = "enumInt32", t5[t5.enumInt64 = 3] = "enumInt64", t5[t5.enumInt8 = 4] = "enumInt8", t5[t5.enumInt16 = 5] = "enumInt16";
      }(t4.LL || (t4.LL = {})), function(t5) {
        t5[t5.POSITION = 0] = "POSITION", t5[t5.Z = 1] = "Z", t5[t5.M = 2] = "M", t5[t5.ID = 3] = "ID", t5[t5.NORMAL = 4] = "NORMAL", t5[t5.TEXTURE1D = 5] = "TEXTURE1D", t5[t5.TEXTURE2D = 6] = "TEXTURE2D", t5[t5.TEXTURE3D = 7] = "TEXTURE3D", t5[t5.ID2 = 8] = "ID2", t5[t5.MAXSEMANTICS = 10] = "MAXSEMANTICS";
      }(t4.Kh || (t4.Kh = {}));
      var s4 = function() {
        function i5(t5, s5) {
          if (this.Xs = this.Be = null, this.Qq = this.Ba = 0, this.wh = this.dg = null, this.yl = 0, s5 !== void 0) {
            for (this.Ba = s5.Ba, this.Qq = s5.Qq, this.dg = s5.dg.slice(0), this.wh = s5.wh.slice(0), this.yl = s5.yl, this.Xs = [], t5 = s5 = 0; t5 < this.Ba; t5++)
              this.Xs[t5] = s5, s5 += i5.Wa(this.dg[t5]);
            for (this.Qq = s5, this.Be = [], t5 = 0; t5 < this.Ba; t5++) {
              s5 = i5.Wa(this.ld(t5));
              for (var n4 = i5.te(this.ld(t5)), h3 = 0; h3 < s5; h3++)
                this.Be[this.Xs[t5] + h3] = n4;
            }
          } else
            this.Qq = this.Ba = 0;
        }
        return i5.prototype.ld = function(i6) {
          if (0 > i6 || i6 > this.Ba)
            throw t4.i.O();
          return this.dg[i6];
        }, i5.prototype.Rf = function(t5) {
          return this.wh[t5];
        }, i5.gz = function(t5) {
          return i5.EM[t5];
        }, i5.Vp = function(t5) {
          return i5.NM[t5];
        }, i5.Wa = function(t5) {
          return i5.mM[t5];
        }, i5.prototype.hasAttribute = function(t5) {
          return 0 <= this.wh[t5];
        }, i5.prototype.dG = function() {
          return this.hasAttribute(1);
        }, i5.te = function(t5) {
          return i5.$C[t5];
        }, i5.prototype.GR = function(t5) {
          return this.Xs[t5];
        }, i5.yG = function(t5, s5) {
          return i5.$C[t5] === s5;
        }, i5.prototype.Nb = function(t5) {
          return this === t5;
        }, i5.prototype.Cn = function() {
          for (var i6 = t4.P.Vh(this.dg[0]), s5 = 1; s5 < this.Ba; s5++)
            i6 = t4.P.Vh(this.dg[s5], i6);
          return i6;
        }, i5.prototype.bk = function(t5) {
          return this.Xs[t5];
        }, i5.prototype.dc = function() {
          return this.yl;
        }, i5.prototype.Fd = function(t5) {
          return this.dg[t5];
        }, i5.$C = [0, 0, NaN, 0, 0, 0, 0, 0, 0], i5.EM = [1, 1, 1, 0, 2, 1, 1, 1, 0], i5.NM = [1, 1, 1, 2, 0, 0, 0, 0, 2], i5.mM = [2, 1, 1, 1, 3, 1, 2, 3, 2], i5;
      }();
      t4.sa = s4;
    }(Q2 || (Q2 = {})), function(t4) {
      function i4(t5, i5, n5) {
        var r4 = i5 - (t5 = new o3(t5)).e, e4 = t5.c;
        for (e4.length > ++i5 && s4(t5, r4, o3.gu), e4[0] ? n5 ? r4 = i5 : (e4 = t5.c, r4 = t5.e + r4 + 1) : ++r4; e4.length < r4; e4.push(0))
          ;
        return r4 = t5.e, n5 === 1 || n5 && (i5 <= r4 || r4 <= h3) ? (0 > t5.Cd && e4[0] ? "-" : "") + (1 < e4.length ? e4[0] + "." + e4.join("").slice(1) : e4[0]) + (0 > r4 ? "e" : "e+") + r4 : t5.toString();
      }
      function s4(t5, i5, s5, h4) {
        var r4 = t5.c, e4 = t5.e + i5 + 1;
        if (s5 === 1 ? h4 = 5 <= r4[e4] : s5 === 2 ? h4 = 5 < r4[e4] || r4[e4] == 5 && (h4 || 0 > e4 || r4[e4 + 1] !== void 0 || 1 & r4[e4 - 1]) : s5 === 3 ? h4 = h4 || r4[e4] !== void 0 || 0 > e4 : (h4 = false, s5 !== 0 && n4("!Big.RM!")), 1 > e4 || !r4[0])
          h4 ? (t5.e = -i5, t5.c = [1]) : t5.c = [t5.e = 0];
        else {
          if (r4.length = e4--, h4)
            for (; 9 < ++r4[e4]; )
              r4[e4] = 0, e4-- || (++t5.e, r4.unshift(1));
          for (e4 = r4.length; !r4[--e4]; r4.pop())
            ;
        }
        return t5;
      }
      function n4(t5) {
        throw (t5 = Error(t5)).name = "BigError", t5;
      }
      var h3 = -7, r3 = 21, e3 = /^-?(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i, o3 = function() {
        function t5(i5) {
          if (i5 instanceof t5)
            this.Cd = i5.Cd, this.e = i5.e, this.c = i5.c.slice();
          else {
            var s5, h4, r4;
            for (i5 === 0 && 0 > 1 / i5 ? i5 = "-0" : e3.test(i5 += "") || n4(NaN), this.Cd = i5.charAt(0) == "-" ? (i5 = i5.slice(1), -1) : 1, -1 < (s5 = i5.indexOf(".")) && (i5 = i5.replace(".", "")), 0 < (h4 = i5.search(/e/i)) ? (0 > s5 && (s5 = h4), s5 += +i5.slice(h4 + 1), i5 = i5.substring(0, h4)) : 0 > s5 && (s5 = i5.length), h4 = 0; i5.charAt(h4) == "0"; h4++)
              ;
            if (h4 == (r4 = i5.length))
              this.c = [this.e = 0];
            else {
              for (; i5.charAt(--r4) == "0"; )
                ;
              for (this.e = s5 - h4 - 1, this.c = [], s5 = 0; h4 <= r4; this.c[s5++] = +i5.charAt(h4++))
                ;
            }
          }
        }
        return t5.prototype.abs = function() {
          var i5 = new t5(this);
          return i5.Cd = 1, i5;
        }, t5.prototype.cmp = function(i5) {
          var s5 = this.c, n5 = (i5 = new t5(i5)).c, h4 = this.Cd, r4 = i5.Cd, e4 = this.e, o4 = i5.e;
          if (!s5[0] || !n5[0])
            return s5[0] ? h4 : n5[0] ? -r4 : 0;
          if (h4 != r4)
            return h4;
          if (i5 = 0 > h4, e4 != o4)
            return e4 > (o4 ^ i5) ? 1 : -1;
          for (h4 = -1, r4 = (e4 = s5.length) < (o4 = n5.length) ? e4 : o4; ++h4 < r4; )
            if (s5[h4] != n5[h4])
              return s5[h4] > (n5[h4] ^ i5) ? 1 : -1;
          return e4 == o4 ? 0 : e4 > (o4 ^ i5) ? 1 : -1;
        }, t5.prototype.lm = function(i5) {
          var h4 = this.c, r4 = (i5 = new t5(i5)).c, e4 = this.Cd == i5.Cd ? 1 : -1, o4 = t5.tr;
          if ((o4 !== ~~o4 || 0 > o4 || 1e6 < o4) && n4("!Big.DP!"), !h4[0] || !r4[0])
            return h4[0] == r4[0] && n4(NaN), r4[0] || n4(e4 / 0), new t5(0 * e4);
          var a3, u3, f3 = r4.slice(), c3 = a3 = r4.length, l3 = h4.length, p3 = h4.slice(0, a3), v3 = p3.length, y3 = i5, b3 = y3.c = [], d3 = 0, g3 = o4 + (y3.e = this.e - i5.e) + 1;
          for (y3.Cd = e4, e4 = 0 > g3 ? 0 : g3, f3.unshift(0); v3++ < a3; p3.push(0))
            ;
          do {
            for (u3 = 0; 10 > u3; u3++) {
              if (a3 != (v3 = p3.length))
                var w3 = a3 > v3 ? 1 : -1;
              else {
                var x3 = -1;
                for (w3 = 0; ++x3 < a3; )
                  if (r4[x3] != p3[x3]) {
                    w3 = r4[x3] > p3[x3] ? 1 : -1;
                    break;
                  }
              }
              if (!(0 > w3))
                break;
              for (i5 = v3 == a3 ? r4 : f3; v3; ) {
                if (p3[--v3] < i5[v3]) {
                  for (x3 = v3; x3 && !p3[--x3]; p3[x3] = 9)
                    ;
                  --p3[x3], p3[v3] += 10;
                }
                p3[v3] -= i5[v3];
              }
              for (; !p3[0]; p3.shift())
                ;
            }
            b3[d3++] = w3 ? u3 : ++u3, p3[0] && w3 ? p3[v3] = h4[c3] || 0 : p3 = [h4[c3]];
          } while ((c3++ < l3 || p3[0] !== void 0) && e4--);
          return b3[0] || d3 == 1 || (b3.shift(), y3.e--), d3 > g3 && s4(y3, o4, t5.gu, p3[0] !== void 0), y3;
        }, t5.prototype.aS = function() {
          return 0 < this.cmp(0);
        }, t5.prototype.iT = function() {
          return 0 > this.cmp(0);
        }, t5.prototype.kt = function(i5) {
          var s5, n5 = this.Cd, h4 = (i5 = new t5(i5)).Cd;
          if (n5 != h4)
            return i5.Cd = -h4, this.oI(i5);
          var r4 = this.c.slice(), e4 = this.e, o4 = i5.c, a3 = i5.e;
          if (!r4[0] || !o4[0])
            return o4[0] ? (i5.Cd = -h4, i5) : new t5(r4[0] ? this : 0);
          if (n5 = e4 - a3) {
            for ((s5 = 0 > n5) ? (n5 = -n5, e4 = r4) : (a3 = e4, e4 = o4), e4.reverse(), h4 = n5; h4--; e4.push(0))
              ;
            e4.reverse();
          } else
            for (e4 = ((s5 = r4.length < o4.length) ? r4 : o4).length, n5 = h4 = 0; h4 < e4; h4++)
              if (r4[h4] != o4[h4]) {
                s5 = r4[h4] < o4[h4];
                break;
              }
          if (s5 && (e4 = r4, r4 = o4, o4 = e4, i5.Cd = -i5.Cd), 0 < (h4 = (e4 = o4.length) - (s5 = r4.length)))
            for (; h4--; r4[s5++] = 0)
              ;
          for (h4 = s5; e4 > n5; ) {
            if (r4[--e4] < o4[e4]) {
              for (s5 = e4; s5 && !r4[--s5]; r4[s5] = 9)
                ;
              --r4[s5], r4[e4] += 10;
            }
            r4[e4] -= o4[e4];
          }
          for (; r4[--h4] == 0; r4.pop())
            ;
          for (; r4[0] == 0; )
            r4.shift(), --a3;
          return r4[0] || (i5.Cd = 1, r4 = [a3 = 0]), i5.c = r4, i5.e = a3, i5;
        }, t5.prototype.oI = function(i5) {
          var s5 = this.Cd, n5 = (i5 = new t5(i5)).Cd;
          if (s5 != n5)
            return i5.Cd = -n5, this.kt(i5);
          n5 = this.e;
          var h4 = this.c, r4 = i5.e, e4 = i5.c;
          if (!h4[0] || !e4[0])
            return e4[0] ? i5 : new t5(h4[0] ? this : 0 * s5);
          if (h4 = h4.slice(), s5 = n5 - r4) {
            for (0 < s5 ? (r4 = n5, n5 = e4) : (s5 = -s5, n5 = h4), n5.reverse(); s5--; n5.push(0))
              ;
            n5.reverse();
          }
          for (0 > h4.length - e4.length && (n5 = e4, e4 = h4, h4 = n5), s5 = e4.length, n5 = 0; s5; )
            n5 = (h4[--s5] = h4[s5] + e4[s5] + n5) / 10 | 0, h4[s5] %= 10;
          for (n5 && (h4.unshift(n5), ++r4), s5 = h4.length; h4[--s5] == 0; h4.pop())
            ;
          return i5.c = h4, i5.e = r4, i5;
        }, t5.prototype.pow = function(i5) {
          var s5 = this, h4 = new t5(1), r4 = h4, e4 = 0 > i5;
          for ((i5 !== ~~i5 || -1e6 > i5 || 1e6 < i5) && n4("!pow!"), i5 = e4 ? -i5 : i5; 1 & i5 && (r4 = r4.nr(s5)), i5 >>= 1; )
            s5 = s5.nr(s5);
          return e4 ? h4.lm(r4) : r4;
        }, t5.prototype.round = function(i5, h4) {
          var r4 = this;
          return i5 == null ? i5 = 0 : (i5 !== ~~i5 || 0 > i5 || 1e6 < i5) && n4("!round!"), s4(r4 = new t5(r4), i5, h4 != null ? h4 : t5.gu), r4;
        }, t5.prototype.sqrt = function() {
          var i5 = this.c, h4 = this.Cd, r4 = this.e, e4 = new t5("0.5");
          if (!i5[0])
            return new t5(this);
          0 > h4 && n4(NaN), (h4 = Math.sqrt(this.toString())) == 0 || h4 == 1 / 0 ? ((h4 = i5.join("")).length + r4 & 1 || (h4 += "0"), (i5 = new t5(Math.sqrt(h4).toString())).e = ((r4 + 1) / 2 | 0) - (0 > r4 || 1 & r4)) : i5 = new t5(h4.toString()), h4 = i5.e + (t5.tr += 4);
          do {
            r4 = i5, i5 = e4.nr(r4.oI(this.lm(r4)));
          } while (r4.c.slice(0, h4).join("") !== i5.c.slice(0, h4).join(""));
          return s4(i5, t5.tr -= 4, t5.gu), i5;
        }, t5.prototype.nr = function(i5) {
          var s5 = this.c, n5 = (i5 = new t5(i5)).c, h4 = s5.length, r4 = n5.length, e4 = this.e, o4 = i5.e;
          if (i5.Cd = this.Cd == i5.Cd ? 1 : -1, !s5[0] || !n5[0])
            return new t5(0 * i5.Cd);
          if (i5.e = e4 + o4, h4 < r4) {
            var a3 = s5;
            s5 = n5, n5 = a3, o4 = h4, h4 = r4, r4 = o4;
          }
          for (a3 = Array(o4 = h4 + r4); o4--; a3[o4] = 0)
            ;
          for (e4 = r4; e4--; ) {
            for (r4 = 0, o4 = h4 + e4; o4 > e4; )
              r4 = a3[o4] + n5[e4] * s5[o4 - e4 - 1] + r4, a3[o4--] = r4 % 10, r4 = r4 / 10 | 0;
            a3[o4] = (a3[o4] + r4) % 10;
          }
          for (r4 && ++i5.e, a3[0] || a3.shift(), e4 = a3.length; !a3[--e4]; a3.pop())
            ;
          return i5.c = a3, i5;
        }, t5.prototype.toString = function() {
          var t6 = this.e, i5 = this.c.join(""), s5 = i5.length;
          if (t6 <= h3 || t6 >= r3)
            i5 = i5.charAt(0) + (1 < s5 ? "." + i5.slice(1) : "") + (0 > t6 ? "e" : "e+") + t6;
          else if (0 > t6) {
            for (; ++t6; i5 = "0" + i5)
              ;
            i5 = "0." + i5;
          } else if (0 < t6)
            if (++t6 > s5)
              for (t6 -= s5; t6--; i5 += "0")
                ;
            else
              t6 < s5 && (i5 = i5.slice(0, t6) + "." + i5.slice(t6));
          else
            1 < s5 && (i5 = i5.charAt(0) + "." + i5.slice(1));
          return 0 > this.Cd && this.c[0] ? "-" + i5 : i5;
        }, t5.prototype.toExponential = function(t6) {
          return t6 == null ? t6 = this.c.length - 1 : (t6 !== ~~t6 || 0 > t6 || 1e6 < t6) && n4("!toExp!"), i4(this, t6, 1);
        }, t5.prototype.toFixed = function(t6) {
          var s5 = h3, e4 = r3;
          if (h3 = -(r3 = 1 / 0), t6 == null)
            var o4 = this.toString();
          else
            t6 === ~~t6 && 0 <= t6 && 1e6 >= t6 && (o4 = i4(this, this.e + t6), 0 > this.Cd && this.c[0] && 0 > o4.indexOf("-") && (o4 = "-" + o4));
          return h3 = s5, r3 = e4, o4 || n4("!toFix!"), o4;
        }, t5.prototype.toPrecision = function(t6) {
          return t6 == null ? this.toString() : ((t6 !== ~~t6 || 1 > t6 || 1e6 < t6) && n4("!toPre!"), i4(this, t6 - 1, 2));
        }, t5.tr = 20, t5.gu = 1, t5;
      }();
      t4.jp = o3;
    }(Q2 || (Q2 = {})), function(t4) {
      var i4 = function() {
        function i5(t5) {
          this.lf = t5;
        }
        return i5.prototype.qr = function(i6, s4, n4) {
          var h3 = new t4.h(), r3 = new t4.h(), e3 = this.lf;
          n4.Wd(i6, s4, function(t5, i7) {
            return e3.uc(2 * t5, h3), e3.uc(2 * i7, r3), h3.compare(r3);
          });
        }, i5.prototype.bq = function(t5) {
          return this.lf.read(2 * t5 + 1);
        }, i5;
      }();
      t4.si = function() {
        function s4() {
        }
        return s4.cq = function(i5) {
          if (i5.B())
            return false;
          var n4 = i5.K();
          return n4 == 1736 ? i5.He() != 0 : n4 == 1607 ? (n4 = [false], s4.nE(i5, true, n4), n4[0]) : !(n4 != 197 && (!t4.ba.zd(n4) || i5.wG()));
        }, s4.im = function(i5) {
          var n4 = i5.K();
          if (n4 == 1736)
            return n4 = new t4.Ua(i5.description), i5.B() || i5.ZC(n4), n4;
          if (n4 == 1607)
            return s4.nE(i5, false, null);
          if (n4 == 197)
            return n4 = new t4.Ua(i5.description), i5.B() || n4.bd(i5, false), n4;
          if (t4.ba.zd(n4)) {
            if (n4 = new t4.ee(i5.description), !i5.B() && !i5.wG()) {
              var h3 = new t4.Ta();
              i5.Vo(h3), n4.add(h3), i5.Ro(h3), n4.add(h3);
            }
            return n4;
          }
          if (t4.ba.Tn(n4))
            return null;
          throw t4.i.O();
        }, s4.nE = function(s5, n4, h3) {
          h3 != null && (h3[0] = false);
          var r3 = null;
          if (n4 || (r3 = new t4.ee(s5.description)), !s5.B()) {
            var e3 = new t4.ja(0);
            e3.Jb(2 * s5.ea());
            for (var o3 = 0, a3 = s5.ea(); o3 < a3; o3++)
              if (0 < s5.Ka(o3) && !s5.Pn(o3)) {
                var u3 = s5.Ca(o3);
                e3.add(u3), u3 = s5.Wc(o3) - 1, e3.add(u3);
              }
            if (0 < e3.size) {
              a3 = new t4.Zt(), o3 = s5.vb(0), a3.sort(e3, 0, e3.size, new i4(o3)), a3 = new t4.h(), o3.uc(2 * e3.get(0), a3), u3 = 0;
              for (var f3 = 1, c3 = new t4.Ta(), l3 = new t4.h(), p3 = 1, v3 = e3.size; p3 < v3; p3++)
                if (o3.uc(2 * e3.get(p3), l3), l3.rb(a3))
                  e3.get(u3) > e3.get(p3) ? (e3.set(u3, 2147483647), u3 = p3) : e3.set(p3, 2147483647), f3++;
                else {
                  if ((1 & f3) == 0)
                    e3.set(u3, 2147483647);
                  else if (n4)
                    return h3 != null && (h3[0] = true), null;
                  a3.N(l3), u3 = p3, f3 = 1;
                }
              if ((1 & f3) == 0)
                e3.set(u3, 2147483647);
              else if (n4)
                return h3 != null && (h3[0] = true), null;
              if (!n4)
                for (e3.Wd(0, e3.size, function(t5, i5) {
                  return t5 - i5;
                }), p3 = 0, v3 = e3.size; p3 < v3 && e3.get(p3) != 2147483647; p3++)
                  s5.we(e3.get(p3), c3), r3.add(c3);
            }
          }
          return n4 ? null : r3;
        }, s4;
      }();
    }(Q2 || (Q2 = {})), function(t4) {
      var i4 = function() {
        function i5() {
          this.zf = new t4.ja(0), this.As = new t4.ja(0), this.zH = 1, this.Gs = NaN;
        }
        return i5.prototype.sort = function(t5, i6, s4, n4) {
          if (32 > s4 - i6)
            n4.qr(i6, s4, t5);
          else {
            var h3 = true;
            try {
              for (var r3 = 1 / 0, e3 = -1 / 0, o3 = i6; o3 < s4; o3++) {
                var a3 = n4.bq(t5.get(o3));
                a3 < r3 && (r3 = a3), a3 > e3 && (e3 = a3);
              }
              if (this.reset(s4 - i6, r3, e3, s4 - i6)) {
                for (o3 = i6; o3 < s4; o3++) {
                  var u3 = t5.get(o3);
                  a3 = n4.bq(u3);
                  var f3 = this.uF(a3);
                  this.zf.set(f3, this.zf.get(f3) + 1), this.As.write(o3 - i6, u3);
                }
                var c3 = this.zf.get(0);
                this.zf.set(0, 0), o3 = 1;
                for (var l3 = this.zf.size; o3 < l3; o3++) {
                  var p3 = this.zf.get(o3);
                  this.zf.set(o3, c3), c3 += p3;
                }
                for (o3 = i6; o3 < s4; o3++) {
                  u3 = this.As.read(o3 - i6), a3 = n4.bq(u3), f3 = this.uF(a3);
                  var v3 = this.zf.get(f3);
                  t5.set(v3 + i6, u3), this.zf.set(f3, v3 + 1);
                }
                h3 = false;
              }
            } catch (y3) {
              this.zf.resize(0), this.As.resize(0);
            }
            if (h3)
              n4.qr(i6, s4, t5);
            else {
              for (o3 = s4 = 0, l3 = this.zf.size; o3 < l3; o3++)
                h3 = s4, (s4 = this.zf.get(o3)) > h3 && n4.qr(i6 + h3, i6 + s4, t5);
              100 < this.zf.size && (this.zf.resize(0), this.As.resize(0));
            }
          }
        }, i5.prototype.reset = function(t5, s4, n4, h3) {
          return !(2 > t5 || n4 == s4) && (t5 = Math.min(i5.cL, t5), this.zf.Jb(t5), this.zf.resize(t5), this.zf.Yj(0, 0, this.zf.size), this.zH = s4, this.As.resize(h3), this.Gs = (n4 - s4) / (t5 - 1), true);
        }, i5.prototype.uF = function(i6) {
          return t4.P.truncate((i6 - this.zH) / this.Gs);
        }, i5.cL = 65536, i5;
      }();
      t4.Zt = i4;
    }(Q2 || (Q2 = {})), function(t4) {
      var i4, s4;
      (s4 = i4 || (i4 = {}))[s4.enum_line = 1] = "enum_line", s4[s4.enum_arc = 2] = "enum_arc", s4[s4.enum_dummy = 4] = "enum_dummy", s4[s4.enum_concave_dip = 8] = "enum_concave_dip", s4[s4.enum_connection = 3] = "enum_connection";
      var n4 = function() {
        function i5() {
        }
        return i5.Su = function(s5, n5, h4, r4, e4, o4) {
          var a3 = new i5();
          return a3.Km = new t4.h(), a3.Xm = new t4.h(), a3.cw = new t4.h(), a3.Km.N(s5), a3.Xm.N(n5), a3.cw.N(h4), a3.Eo = r4, a3.sh = e4, a3.uh = o4, a3;
        }, i5.construct = function(s5, n5, h4, r4) {
          var e4 = new i5();
          return e4.Km = new t4.h(), e4.Xm = new t4.h(), e4.cw = new t4.h(), e4.Km.N(s5), e4.Xm.N(n5), e4.cw.Sc(), e4.Eo = 4, e4.sh = h4, e4.uh = r4, e4;
        }, i5;
      }(), h3 = function() {
        function i5(t5, i6, s5, n5, h4, r4) {
          this.$v = null, this.za = 0, this.zA = t5, this.XH = this.VH = 0, this.La = i6, this.Oj = s5, this.xk = n5, this.Fq = h4, this.Vb = r4;
        }
        return i5.prototype.next = function() {
          for (var i6 = new t4.Ta(); ; ) {
            if (this.za == this.zA.I())
              return null;
            if (this.zA.we(this.za, i6), this.za++, !i6.B())
              break;
          }
          var s5 = false;
          if (this.$v == null && (this.VH = i6.Ng(), this.XH = i6.kh(), this.$v = o3.buffer(i6, this.La, this.Oj, this.xk, this.Fq, this.Vb), s5 = true), this.za < this.zA.I()) {
            var n5 = new t4.Ea();
            this.$v.copyTo(n5);
          } else
            n5 = this.$v;
          if (!s5) {
            s5 = new t4.Ed();
            var h4 = i6.Ng() - this.VH;
            i6 = i6.kh() - this.XH, s5.ig(h4, i6), n5.Pc(s5);
          }
          return n5;
        }, i5.prototype.Ma = function() {
          return 0;
        }, i5.prototype.re = function() {
        }, i5;
      }(), r3 = function() {
        function i5(t5, i6) {
          this.Xa = t5, this.za = 0, this.qq = i6;
        }
        return i5.prototype.next = function() {
          var i6 = this.Xa.Y;
          if (this.za < i6.ea()) {
            var s5 = this.za;
            if (this.za++, !i6.Pn(s5))
              for (var n5 = i6.Oa(i6.Wc(s5) - 1); this.za < i6.ea(); ) {
                var h4 = i6.Oa(i6.Ca(this.za));
                if (i6.Pn(this.za))
                  break;
                if (h4 != n5)
                  break;
                n5 = i6.Oa(i6.Wc(this.za) - 1), this.za++;
              }
            if (this.za - s5 == 1)
              return this.Xa.fE(this.Xa.Y, s5, this.qq);
            for ((n5 = new t4.Ua(this.Xa.Y.description)).addPath(this.Xa.Y, s5, true), s5 += 1; s5 < this.za; s5++)
              n5.Fr(this.Xa.Y, s5, 0, i6.tv(s5), false);
            return this.Xa.fE(n5, 0, this.qq);
          }
          return null;
        }, i5.prototype.Ma = function() {
          return 0;
        }, i5.prototype.re = function() {
        }, i5;
      }(), e3 = function() {
        function t5(t6) {
          this.Xa = t6, this.za = 0;
        }
        return t5.prototype.next = function() {
          var t6 = this.Xa.Y;
          if (this.za < t6.ea()) {
            var i5 = this.za;
            for (t6.Kr(this.za), this.za++; this.za < t6.ea() && !(0 < t6.Kr(this.za)); )
              this.za++;
            return i5 == 0 && this.za == t6.ea() ? this.Xa.ly(t6, 0, t6.ea()) : this.Xa.ly(t6, i5, this.za);
          }
          return null;
        }, t5.prototype.Ma = function() {
          return 0;
        }, t5.prototype.re = function() {
        }, t5;
      }(), o3 = function() {
        function i5(t5) {
          this.Ms = this.nw = this.Ns = this.Jd = null, this.$d = [], this.Vb = t5, this.sb = this.Mv = this.ET = this.La = this.oA = this.dt = this.ra = 0, this.jA = this.xk = -1, this.qq = true;
        }
        return i5.buffer = function(s5, n5, h4, r4, e4, o4) {
          if (s5 == null)
            throw t4.i.O();
          if (0 > r4)
            throw t4.i.O();
          if (s5.B())
            return new t4.Ea(s5.description);
          var a3 = new t4.l();
          return s5.yc(a3), 0 < n5 && a3.X(n5, n5), (o4 = new i5(o4)).Oj = h4, o4.Y = s5, o4.ra = t4.ua.Xd(h4, a3, true), o4.dt = t4.ua.Xd(null, a3, true), o4.La = n5, o4.ET = s5.K(), 0 >= e4 && (e4 = 96), o4.sb = Math.abs(o4.La), o4.Mv = o4.sb != 0 ? 1 / o4.sb : 0, isNaN(r4) || r4 == 0 ? r4 = 1e-5 * o4.sb : r4 > 0.5 * o4.sb && (r4 = 0.5 * o4.sb), 12 > e4 && (e4 = 12), (s5 = Math.abs(n5) * (1 - Math.cos(Math.PI / e4))) > r4 ? r4 = s5 : (s5 = Math.PI / Math.acos(1 - r4 / Math.abs(n5))) < e4 - 1 && (12 > (e4 = t4.P.truncate(s5)) && (e4 = 12, r4 = Math.abs(n5) * (1 - Math.cos(Math.PI / e4)))), o4.xk = r4, o4.Fq = e4, o4.oA = Math.min(o4.dt, 0.25 * r4), o4.gE();
        }, i5.prototype.ev = function() {
          if (this.Jd == null)
            this.Jd = [];
          else if (this.Jd.length !== 0)
            return;
          var i6 = this.lE();
          i6 = t4.P.truncate((i6 + 3) / 4);
          var s5 = 0.5 * Math.PI / i6;
          this.jA = s5;
          for (var n5 = 0; n5 < 4 * i6; n5++)
            this.Jd.push(null);
          var h4 = Math.cos(s5);
          s5 = Math.sin(s5);
          var r4 = t4.h.construct(0, 1);
          for (n5 = 0; n5 < i6; n5++)
            this.Jd[n5 + 0 * i6] = t4.h.construct(r4.y, -r4.x), this.Jd[n5 + 1 * i6] = t4.h.construct(-r4.x, -r4.y), this.Jd[n5 + 2 * i6] = t4.h.construct(-r4.y, r4.x), this.Jd[n5 + 3 * i6] = r4, (r4 = t4.h.construct(r4.x, r4.y)).Ct(h4, s5);
        }, i5.prototype.gE = function() {
          var i6 = this.Y.K();
          if (t4.ba.zd(i6))
            return (i6 = new t4.Ua(this.Y.description)).pc(this.Y, true), this.Y = i6, this.gE();
          if (this.La <= this.ra) {
            if (!t4.ba.PS(i6))
              return new t4.Ea(this.Y.description);
            if (0 >= this.La && (i6 = new t4.l(), this.Y.A(i6), i6.S() <= 2 * -this.La || i6.da() <= 2 * this.La))
              return new t4.Ea(this.Y.description);
          }
          switch (this.Y.K()) {
            case 33:
              return this.KN();
            case 550:
              return this.JN();
            case 1607:
              return this.MN();
            case 1736:
              return this.LN();
            case 197:
              return this.GN();
            default:
              throw t4.i.Ra();
          }
        }, i5.prototype.MN = function() {
          if (this.zG(this.Y)) {
            var i6 = new t4.Ta();
            this.Y.we(0, i6);
            var s5 = new t4.l();
            return this.Y.A(s5), i6.Db(s5.tf()), this.Iu(i6);
          }
          return this.Y = this.RV(this.Y), i6 = new r3(this, this.qq), t4.Ih.local().W(i6, this.Oj, this.Vb).next();
        }, i5.prototype.LN = function() {
          if (this.La == 0)
            return this.Y;
          var i6 = t4.$l.local();
          if (this.ev(), this.Y = i6.W(this.Y, null, false, this.Vb), 0 > this.La) {
            var s5 = this.Y;
            return s5 = this.ly(s5, 0, s5.ea()), i6.W(s5, this.Oj, false, this.Vb);
          }
          return this.zG(this.Y) ? (i6 = new t4.Ta(), this.Y.we(0, i6), s5 = new t4.l(), this.Y.A(s5), i6.Db(s5.tf()), this.Iu(i6)) : (i6 = new e3(this), t4.Ih.local().W(i6, this.Oj, this.Vb).next());
        }, i5.prototype.ly = function(s5, n5, h4) {
          for (var r4 = new t4.Ea(s5.description); n5 < h4; n5++)
            if (!(1 > s5.Ka(n5))) {
              var e4 = s5.Kr(n5), o4 = new t4.l();
              if (s5.Tj(n5, o4), 0 < this.La) {
                if (0 < e4)
                  if (this.AG(s5, n5))
                    e4 = new t4.Ta(), s5.we(s5.Ca(n5), e4), e4.Db(o4.tf()), this.Au(r4, e4);
                  else {
                    var a3 = e4 = new t4.Ua(s5.description);
                    a3 = t4.au.EG(this.Y, n5) || this.Bn(this.Y, n5, a3, true, 1) == 2 ? this.eE(s5, n5) : this.An(e4), r4.add(a3, false);
                  }
                else if (!(o4.S() + this.ra <= 2 * this.sb || o4.da() + this.ra <= 2 * this.sb || (a3 = e4 = new t4.Ua(s5.description), this.Bn(this.Y, n5, a3, true, 1), e4.B()))) {
                  var u3 = new t4.l();
                  for (u3.L(o4), u3.X(this.sb, this.sb), a3.vp(u3), o4 = 1, e4 = (a3 = this.An(e4)).ea(); o4 < e4; o4++)
                    r4.addPath(a3, o4, true);
                }
              } else if (0 < e4) {
                if (!(o4.S() + this.ra <= 2 * this.sb || o4.da() + this.ra <= 2 * this.sb || (a3 = e4 = new t4.Ua(s5.description), this.Bn(this.Y, n5, a3, true, -1), e4.B())))
                  for (u3 = new t4.l(), a3.yc(u3), u3.X(this.sb, this.sb), a3.vp(u3), o4 = 1, e4 = (a3 = this.An(e4)).ea(); o4 < e4; o4++)
                    r4.addPath(a3, o4, true);
              } else
                for (a3 = e4 = new t4.Ua(s5.description), this.Bn(this.Y, n5, a3, true, -1), o4 = 0, e4 = (a3 = this.An(e4)).ea(); o4 < e4; o4++)
                  r4.addPath(a3, o4, true);
            }
          if (0 < this.La)
            return 1 < r4.ea() ? r4 = this.An(r4) : i5.kx(r4);
          if (s5 = new t4.l(), r4.yc(s5), r4.B())
            return i5.kx(r4);
          for (s5.X(this.sb, this.sb), r4.vp(s5), r4 = this.An(r4), s5 = new t4.Ea(r4.description), o4 = 1, e4 = r4.ea(); o4 < e4; o4++)
            s5.addPath(r4, o4, false);
          return i5.kx(s5);
        }, i5.prototype.KN = function() {
          return this.Iu(this.Y);
        }, i5.prototype.Iu = function(i6) {
          var s5 = new t4.Ea(this.Y.description);
          return this.Au(s5, i6), this.oX(s5);
        }, i5.prototype.JN = function() {
          var i6 = new h3(this.Y, this.La, this.Oj, this.xk, this.Fq, this.Vb);
          return t4.Ih.local().W(i6, this.Oj, this.Vb).next();
        }, i5.prototype.GN = function() {
          var i6 = new t4.Ea(this.Y.description);
          if (0 >= this.La) {
            if (this.La == 0)
              i6.bd(this.Y, false);
            else {
              var s5 = new t4.Hh();
              this.Y.dn(s5), s5.X(this.La, this.La), i6.bd(s5, false);
            }
            return i6;
          }
          return i6.bd(this.Y, false), this.Y = i6, this.eE(i6, 0);
        }, i5.prototype.eE = function(s5, n5) {
          this.ev();
          var h4 = new t4.Ea(s5.description), r4 = new t4.h(), e4 = new t4.h(), o4 = new t4.h(), a3 = new t4.h(), u3 = new t4.h(), f3 = new t4.h(), c3 = new t4.h(), l3 = new t4.h(), p3 = s5.Ka(n5), v3 = s5.Ca(n5), y3 = 0;
          for (n5 = s5.Ka(n5); y3 < n5; y3++) {
            if (s5.D(v3 + y3, e4), s5.D(v3 + (y3 + 1) % p3, a3), s5.D(v3 + (y3 + 2) % p3, f3), c3.vc(a3, e4), c3.length() == 0)
              throw t4.i.Ra();
            if (c3.Jv(), c3.normalize(), c3.scale(this.sb), r4.add(c3, e4), o4.add(c3, a3), y3 == 0 ? h4.Nt(r4) : h4.Ei(r4), h4.Ei(o4), l3.vc(f3, a3), l3.length() == 0)
              throw t4.i.Ra();
            l3.Jv(), l3.normalize(), l3.scale(this.sb), u3.add(l3, a3), this.BD(h4, a3, o4, u3, false);
          }
          return i5.kx(h4);
        }, i5.prototype.fE = function(i6, s5, n5) {
          if (this.ev(), 1 > i6.Ka(s5))
            return null;
          if (this.AG(i6, s5) && 0 < this.La) {
            n5 = new t4.Ta(), i6.we(i6.Ca(s5), n5);
            var h4 = new t4.l();
            return i6.Tj(s5, h4), n5.Db(h4.tf()), this.Iu(n5);
          }
          if (h4 = new t4.Ua(i6.description), i6.Pn(s5))
            this.Bn(i6, s5, h4, n5, 1), this.Bn(i6, s5, h4, n5, -1);
          else {
            var r4 = new t4.Ua(i6.description);
            r4.addPath(i6, s5, false), r4.Fr(i6, s5, 0, i6.tv(s5), false), this.Bn(r4, 0, h4, n5, 1);
          }
          return this.An(h4);
        }, i5.prototype.Zq = function() {
          if (this.$s++, this.$s % 1024 == 0 && this.Vb != null && !this.Vb.progress(-1, -1))
            throw t4.i.hu("user_canceled");
        }, i5.prototype.An = function(i6) {
          return t4.Hg.Ok(i6, this.dt, true, true, this.Vb);
        }, i5.prototype.lE = function() {
          if (this.xk == 0)
            return this.Fq;
          var i6 = 1 - this.xk * Math.abs(this.Mv);
          return 4 > (i6 = -1 > i6 ? 4 : 2 * Math.PI / Math.acos(i6) + 0.5) ? i6 = 4 : i6 > this.Fq && (i6 = this.Fq), t4.P.truncate(i6);
        }, i5.prototype.BD = function(i6, s5, n5, h4, r4) {
          this.ev();
          var e4 = new t4.h();
          e4.vc(n5, s5), e4.scale(this.Mv);
          var o4 = new t4.h();
          o4.vc(h4, s5), o4.scale(this.Mv), 0 > (e4 = Math.atan2(e4.y, e4.x) / this.jA) && (e4 = this.Jd.length + e4), e4 = this.Jd.length - e4, 0 > (o4 = Math.atan2(o4.y, o4.x) / this.jA) && (o4 = this.Jd.length + o4), (o4 = this.Jd.length - o4) < e4 && (o4 += this.Jd.length);
          var a3 = t4.P.truncate(o4);
          o4 = t4.P.truncate(Math.ceil(e4)), (e4 = new t4.h()).N(this.Jd[o4 % this.Jd.length]), e4.Dt(this.sb, s5);
          var u3 = 10 * this.ra;
          for (e4.sub(n5), e4.length() < u3 && (o4 += 1), e4.N(this.Jd[a3 % this.Jd.length]), e4.Dt(this.sb, s5), e4.sub(h4), e4.length() < u3 && --a3, n5 = a3 - o4, n5++, a3 = 0, o4 %= this.Jd.length; a3 < n5; a3++, o4 = (o4 + 1) % this.Jd.length)
            e4.N(this.Jd[o4]), e4.Dt(this.sb, s5), i6.Ei(e4), this.Zq();
          r4 && i6.Ei(h4);
        }, i5.prototype.Bn = function(i6, s5, h4, r4, e4) {
          var o4 = new t4.hd(), a3 = o4.hN(i6, s5);
          if (o4.Ip(this.oA, false, false), 2 > o4.I(a3))
            return 0 > e4 || (e4 = i6, o4 = new t4.Ta(), e4.we(e4.Ca(s5), o4), this.Au(h4, o4)), 1;
          var u3 = o4.Oa(o4.Ya(o4.Ob(a3))), f3 = new t4.Ed();
          if (f3.ig(-u3.x, -u3.y), o4.Pc(f3), r4 && (this.oQ(o4, a3, e4), 2 > o4.I(a3)))
            return 0 > e4 || (e4 = i6, o4 = new t4.Ta(), e4.we(e4.Ca(s5), o4), this.Au(h4, o4)), 1;
          this.$d.length = 0;
          var c3 = o4.Ob(a3);
          s5 = o4.Ya(c3);
          var l3 = e4 == 1 ? o4.Na(s5) : o4.V(s5);
          i6 = e4 == 1 ? o4.V(s5) : o4.Na(s5);
          var p3 = true;
          r4 = new t4.h(), a3 = new t4.h();
          var v3 = new t4.h(), y3 = new t4.h(), b3 = new t4.h(), d3 = new t4.h(), g3 = new t4.h(), w3 = new t4.h(), x3 = new t4.h(), m3 = new t4.h(), j3 = this.sb;
          c3 = o4.Ka(c3);
          for (var M3 = 0; M3 < c3; M3++)
            o4.D(i6, a3), p3 && (o4.D(s5, r4), o4.D(l3, v3), w3.vc(r4, v3), w3.normalize(), m3.HG(w3), m3.scale(j3), y3.add(m3, r4)), g3.vc(a3, r4), g3.normalize(), x3.HG(g3), x3.scale(j3), b3.add(r4, x3), l3 = w3.yi(g3), p3 = w3.Sh(g3), 0 > l3 || 0 > p3 && l3 == 0 ? this.$d.push(n4.Su(y3, b3, r4, 2, this.$d.length + 1, this.$d.length - 1)) : y3.rb(b3) || (this.$d.push(n4.construct(y3, r4, this.$d.length + 1, this.$d.length - 1, "dummy")), this.$d.push(n4.construct(r4, b3, this.$d.length + 1, this.$d.length - 1, "dummy"))), d3.add(a3, x3), this.$d.push(n4.Su(b3, d3, r4, 1, this.$d.length + 1, this.$d.length - 1)), y3.N(d3), m3.N(x3), v3.N(r4), r4.N(a3), w3.N(g3), l3 = s5, s5 = i6, p3 = false, i6 = e4 == 1 ? o4.V(s5) : o4.Na(s5);
          return this.$d[this.$d.length - 1].sh = 0, this.$d[0].uh = this.$d.length - 1, this.TV(h4), f3.ig(u3.x, u3.y), h4.TD(f3, h4.ea() - 1), 1;
        }, i5.prototype.TV = function(t5) {
          for (var i6 = this.uO(), s5 = true, n5 = i6 + 1, h4 = i6; n5 != i6; h4 = n5) {
            var r4 = this.$d[h4];
            n5 = r4.sh != -1 ? r4.sh : (h4 + 1) % this.$d.length, r4.Eo != 0 && (s5 && t5.Nt(r4.Km), r4.Eo == 2 ? this.BD(t5, r4.cw, r4.Km, r4.Xm, true) : t5.Ei(r4.Xm), s5 = false);
          }
        }, i5.prototype.uO = function() {
          this.Ms == null && (this.Ms = [null, null, null, null, null, null, null, null, null]);
          for (var i6 = 0, s5 = 0, n5 = this.$d.length; s5 < n5; ) {
            var h4 = this.$d[s5];
            if ((3 & h4.Eo) != 0) {
              i6 = s5;
              break;
            }
            s5 = h4.sh;
          }
          for (n5 = i6 + 1, s5 = i6; n5 != i6; s5 = n5) {
            n5 = (h4 = this.$d[s5]).sh;
            for (var r4 = 1, e4 = null; n5 != s5 && (3 & (e4 = this.$d[n5]).Eo) == 0; )
              n5 = e4.sh, r4++;
            r4 != 1 && (h4.Eo & e4.Eo) == 1 && (this.Ns == null && (this.Ns = new t4.zb(), this.nw = new t4.zb()), this.Ns.Ec(h4.Km), this.Ns.Rc(h4.Xm), this.nw.Ec(e4.Km), this.nw.Rc(e4.Xm), this.Ns.Fa(this.nw, this.Ms, null, null, this.dt) == 1 && (h4.Xm.N(this.Ms[0]), e4.Km.N(this.Ms[0]), h4.sh = n5, e4.uh = s5));
          }
          return i6;
        }, i5.prototype.Hv = function(i6, s5, n5) {
          var h4 = new t4.h();
          if (h4.vc(n5, i6), n5 = h4.length(), 0 < (n5 = this.sb * this.sb - n5 * n5 * 0.25)) {
            n5 = Math.sqrt(n5), h4.normalize(), h4.cr();
            var r4 = new t4.h();
            if (r4.vc(s5, i6), r4.Sh(h4) + n5 >= this.sb)
              return true;
          }
          return false;
        }, i5.prototype.oQ = function(i6, s5, n5) {
          for (var h4 = 0; 1 > h4; h4++) {
            var r4 = false, e4 = i6.Ob(s5), o4 = i6.Ka(e4);
            if (o4 == 0)
              break;
            var a3 = o4;
            if (3 > o4)
              break;
            !i6.ec(e4) && (a3 = o4 - 1), e4 = i6.Ya(e4), o4 = 0 < n5 ? i6.Na(e4) : i6.V(e4);
            for (var u3 = 0 < n5 ? i6.V(e4) : i6.Na(e4), f3 = o4, c3 = true, l3 = new t4.h(), p3 = new t4.h(), v3 = new t4.h(), y3 = new t4.h(), b3 = new t4.h(), d3 = t4.h.construct(0, 0), g3 = new t4.h(), w3 = new t4.h(), x3 = new t4.h(), m3 = new t4.h(), j3 = this.sb, M3 = 0, k3 = 0; k3 < a3 && (i6.D(u3, p3), c3 && (i6.D(e4, l3), i6.D(o4, v3), f3 = o4), w3.vc(l3, v3), w3.normalize(), g3.vc(p3, l3), g3.normalize(), f3 != u3); ) {
              var z3 = w3.yi(g3), A3 = w3.Sh(g3), N3 = true;
              if (0 > z3 || 0 > A3 && z3 == 0 || !this.Hv(v3, l3, p3) || (d3.N(p3), N3 = false, ++M3, r4 = true), N3) {
                if (0 < M3)
                  for (; (z3 = 0 < n5 ? i6.Na(f3) : i6.V(f3)) != e4; ) {
                    if (i6.D(z3, y3), !this.Hv(y3, v3, d3)) {
                      z3 != u3 && this.Hv(y3, v3, p3) && this.Hv(y3, l3, p3) && (v3.N(y3), f3 = z3, N3 = false, ++M3);
                      break;
                    }
                    v3.N(y3), f3 = z3, N3 = false, ++M3;
                  }
                if (!N3)
                  continue;
                if (0 < M3) {
                  for (f3 = 0 < n5 ? i6.Na(o4) : i6.V(o4), c3 = 1; c3 < M3; c3++)
                    N3 = 0 < n5 ? i6.Na(f3) : i6.V(f3), i6.qd(f3, true), f3 = N3;
                  x3.vc(l3, v3), M3 = j3 * j3 - (M3 = x3.length()) * M3 * 0.25, j3 - (M3 = Math.sqrt(M3)) > 0.5 * this.xk ? (b3.add(v3, l3), b3.scale(0.5), x3.normalize(), x3.cr(), m3.N(x3), m3.scale(j3 - M3), b3.add(m3), i6.mf(o4, b3)) : i6.qd(o4, true), M3 = 0;
                }
                v3.N(l3), f3 = e4;
              }
              l3.N(p3), o4 = e4, e4 = u3, u3 = 0 < n5 ? i6.V(e4) : i6.Na(e4), k3++, c3 = false;
            }
            if (0 < M3) {
              for (f3 = 0 < n5 ? i6.Na(o4) : i6.V(o4), c3 = 1; c3 < M3; c3++)
                N3 = 0 < n5 ? i6.Na(f3) : i6.V(f3), i6.qd(f3, true), f3 = N3;
              b3.add(v3, l3), b3.scale(0.5), x3.vc(l3, v3), M3 = j3 * j3 - (M3 = x3.length()) * M3 * 0.25, M3 = Math.sqrt(M3), x3.normalize(), x3.cr(), m3.N(x3), m3.scale(j3 - M3), b3.add(m3), i6.mf(o4, b3);
            }
            if (i6.Ip(this.oA, false, false), !r4)
              break;
          }
        }, i5.prototype.AG = function(i6, s5) {
          if (i6.Ka(s5) == 1)
            return true;
          var n5 = new t4.l();
          return i6.Tj(s5, n5), Math.max(n5.S(), n5.da()) < 0.5 * this.xk;
        }, i5.prototype.zG = function(i6) {
          var s5 = new t4.l();
          return i6.A(s5), Math.max(s5.S(), s5.da()) < 0.5 * this.xk;
        }, i5.prototype.RV = function(i6) {
          for (var s5 = 0, n5 = 0, h4 = (i6 = t4.zC.local().W(i6, 0.25 * this.xk, false, this.Vb)).ea(); n5 < h4; n5++)
            s5 = Math.max(i6.Ka(n5), s5);
          return 32 > s5 ? (this.qq = false, i6) : (this.qq = true, t4.Hg.Ok(i6, this.dt, false, true, this.Vb));
        }, i5.prototype.Au = function(i6, s5) {
          if (s5 = s5.D(), this.Jd != null && this.Jd.length !== 0) {
            var n5 = new t4.h();
            n5.N(this.Jd[0]), n5.Dt(this.sb, s5), i6.Nt(n5);
            for (var h4 = 1, r4 = this.Jd.length; h4 < r4; h4++)
              n5.N(this.Jd[h4]), n5.Dt(this.sb, s5), i6.Ei(n5);
          } else {
            h4 = this.lE(), n5 = t4.P.truncate((h4 + 3) / 4), h4 = 0.5 * Math.PI / n5, r4 = Math.cos(h4);
            for (var e4 = Math.sin(h4), o4 = new t4.h(), a3 = 3; 0 <= a3; a3--) {
              switch (o4.na(0, this.sb), a3) {
                case 0:
                  for (h4 = 0; h4 < n5; h4++)
                    i6.Aj(o4.x + s5.x, o4.y + s5.y), o4.Ct(r4, e4);
                  break;
                case 1:
                  for (h4 = 0; h4 < n5; h4++)
                    i6.Aj(-o4.y + s5.x, o4.x + s5.y), o4.Ct(r4, e4);
                  break;
                case 2:
                  for (h4 = 0; h4 < n5; h4++)
                    i6.Aj(-o4.x + s5.x, -o4.y + s5.y), o4.Ct(r4, e4);
                  break;
                default:
                  for (i6.rx(o4.y + s5.x, -o4.x + s5.y), h4 = 1; h4 < n5; h4++)
                    o4.Ct(r4, e4), i6.Aj(o4.y + s5.x, -o4.x + s5.y);
              }
              this.Zq();
            }
          }
        }, i5.kx = function(t5) {
          return t5.Eh(1, 0), t5;
        }, i5.prototype.oX = function(t5) {
          return t5.Eh(2, this.ra), t5.hm(), t5;
        }, i5;
      }();
      t4.CK = o3;
    }(Q2 || (Q2 = {})), function(t4) {
      var i4 = function() {
        function i5(i6) {
          this.Da = i6, this.g = new t4.hd(), this.ed = new t4.ja(0);
        }
        return i5.prototype.Nh = function(t5, i6, s4) {
          switch (i6) {
            case 0:
              if (t5.v < s4 && t5.C <= s4)
                break;
              return t5.v >= s4 ? 1 : -1;
            case 1:
              if (t5.G < s4 && t5.H <= s4)
                break;
              return t5.G >= s4 ? 1 : -1;
            case 2:
              if (t5.v >= s4 && t5.C > s4)
                break;
              return t5.C <= s4 ? 1 : -1;
            case 3:
              if (!(t5.G >= s4 && t5.H > s4))
                return t5.H <= s4 ? 1 : -1;
          }
          return 0;
        }, i5.prototype.vy = function(t5, i6) {
          return t5.K() == 1736 ? this.xy(t5, i6) : this.yy(t5);
        }, i5.prototype.xy = function(i6, s4) {
          if (this.Da.S() == 0 || this.Da.da() == 0)
            return i6.Ja();
          var n4 = new t4.l();
          i6.yc(n4), this.Y = this.g.Ib(i6);
          var h3 = new t4.l(), r3 = new t4.l(), e3 = new t4.h(), o3 = new t4.h(), a3 = [0, 0, 0, 0, 0, 0, 0, 0, 0], u3 = [0, 0, 0, 0, 0, 0, 0, 0, 0];
          new t4.jg();
          var f3 = new t4.zb(), c3 = new t4.ja(0);
          c3.Jb(Math.min(100, i6.I()));
          for (var l3 = false, p3 = 0; !l3 && 4 > p3; p3++) {
            var v3 = false, y3 = (1 & p3) != 0, b3 = 0;
            switch (p3) {
              case 0:
                b3 = this.Da.v, v3 = n4.v <= b3 && n4.C >= b3;
                break;
              case 1:
                b3 = this.Da.G, v3 = n4.G <= b3 && n4.H >= b3;
                break;
              case 2:
                b3 = this.Da.C, v3 = n4.v <= b3 && n4.C >= b3;
                break;
              case 3:
                b3 = this.Da.H, v3 = n4.G <= b3 && n4.H >= b3;
            }
            if (v3)
              for (l3 = true, v3 = this.g.Ob(this.Y); v3 != -1; ) {
                var d3 = -1, g3 = -1, w3 = this.g.Ya(v3), x3 = w3;
                do {
                  var m3 = this.g.cc(x3);
                  m3 == null && (m3 = f3, this.g.D(x3, e3), m3.Ec(e3), this.g.D(this.g.V(x3), o3), m3.Rc(o3)), m3.A(h3);
                  var j3 = this.Nh(h3, p3, b3), M3 = 0, k3 = -1;
                  if (j3 == -1) {
                    M3 = 0 < (m3 = m3.fq(y3, b3, a3, u3)) ? this.g.Wl(x3, u3, m3) : 0, M3 += 1;
                    var z3 = x3, A3 = this.g.V(z3);
                    for (m3 = 0; m3 < M3; m3++) {
                      if (this.g.D(z3, e3), this.g.D(A3, o3), (k3 = this.g.cc(z3)) == null && ((k3 = f3).Ec(e3), k3.Rc(o3)), k3.A(r3), (k3 = this.Nh(r3, p3, b3)) == -1) {
                        if (y3)
                          (k3 = Math.abs(e3.y - b3)) < (N3 = Math.abs(o3.y - b3)) ? (e3.y = b3, this.g.mf(z3, e3)) : (o3.y = b3, this.g.mf(A3, o3));
                        else {
                          k3 = Math.abs(e3.x - b3);
                          var N3 = Math.abs(o3.x - b3);
                          k3 < N3 ? (e3.x = b3, this.g.mf(z3, e3)) : (o3.x = b3, this.g.mf(A3, o3));
                        }
                        (k3 = this.g.cc(z3)) == null && ((k3 = f3).Ec(e3), k3.Rc(o3)), k3.A(r3), k3 = this.Nh(r3, p3, b3);
                      }
                      N3 = d3, d3 = k3, g3 == -1 && (g3 = d3), N3 == 0 && d3 == 1 || N3 == 1 && d3 == 0 || N3 != 0 || d3 != 0 || c3.add(z3), d3 == 1 && (l3 = false), k3 = z3 = A3, A3 = this.g.V(A3);
                    }
                  }
                  M3 == 0 && (N3 = d3, d3 = j3, g3 == -1 && (g3 = d3), N3 == 0 && d3 == 1 || N3 == 1 && d3 == 0 || N3 != 0 || d3 != 0 || c3.add(x3), d3 == 1 && (l3 = false), k3 = this.g.V(x3)), x3 = k3;
                } while (x3 != w3);
                for (g3 == 0 && d3 == 0 && c3.add(w3), m3 = 0, d3 = c3.size; m3 < d3; m3++)
                  g3 = c3.get(m3), this.g.qd(g3, false);
                c3.clear(false), v3 = 3 > this.g.Ka(v3) ? this.g.ar(v3) : this.g.Sb(v3);
              }
          }
          return l3 ? i6.Ja() : (this.AB(), 0 < s4 && this.Hy(s4), this.g.Ke(this.Y));
        }, i5.prototype.yy = function(i6) {
          var s4 = new t4.l(), n4 = new t4.l(), h3 = [0, 0, 0, 0, 0, 0, 0, 0, 0], r3 = [0, 0, 0, 0, 0, 0, 0, 0, 0], e3 = new t4.jg(), o3 = i6, a3 = new t4.l();
          i6.yc(a3);
          for (var u3 = 0; 4 > u3; u3++) {
            var f3 = false, c3 = (1 & u3) != 0, l3 = 0;
            switch (u3) {
              case 0:
                l3 = this.Da.v, f3 = a3.v <= l3 && a3.C >= l3;
                break;
              case 1:
                l3 = this.Da.G, f3 = a3.G <= l3 && a3.H >= l3;
                break;
              case 2:
                l3 = this.Da.C, f3 = a3.v <= l3 && a3.C >= l3;
                break;
              case 3:
                l3 = this.Da.H, f3 = a3.G <= l3 && a3.H >= l3;
            }
            if (f3) {
              f3 = o3, o3 = i6.Ja(), (f3 = f3.Ha()).aj();
              for (var p3, v3 = new t4.h(); f3.ab(); )
                for (var y3, b3 = true; f3.Ia(); ) {
                  var d3 = f3.ia();
                  d3.A(s4);
                  var g3 = this.Nh(s4, u3, l3);
                  if (g3 == -1) {
                    if (0 < (g3 = d3.fq(c3, l3, h3, r3))) {
                      var w3 = 0;
                      p3 = d3.bc();
                      for (var x3 = 0; x3 <= g3; x3++)
                        if (w3 != (y3 = x3 < g3 ? r3[x3] : 1)) {
                          d3.dh(w3, y3, e3);
                          var m3 = e3.get();
                          m3.Ec(p3), x3 < g3 && (c3 ? (v3.x = h3[x3], v3.y = l3) : (v3.x = l3, v3.y = h3[x3]), m3.Rc(v3)), m3.A(n4);
                          var j3 = this.Nh(n4, u3, l3);
                          if (j3 == -1) {
                            if (p3 = m3.bc(), w3 = m3.xc(), c3)
                              (j3 = Math.abs(p3.y - l3)) < (M3 = Math.abs(w3.y - l3)) ? (p3.y = l3, m3.Ec(p3)) : (w3.y = l3, m3.Rc(w3));
                            else {
                              j3 = Math.abs(p3.x - l3);
                              var M3 = Math.abs(w3.x - l3);
                              j3 < M3 ? (p3.x = l3, m3.Ec(p3)) : (w3.x = l3, m3.Rc(w3));
                            }
                            m3.A(n4), j3 = this.Nh(n4, u3, l3);
                          }
                          p3 = m3.xc(), w3 = y3, (y3 = j3) == 1 ? (o3.pc(m3, b3), b3 = false) : b3 = true;
                        }
                    }
                  } else
                    (y3 = g3) == 1 ? (o3.pc(d3, b3), b3 = false) : b3 = true;
                }
            }
          }
          return o3;
        }, i5.prototype.AB = function() {
          this.li = -1, this.Xl(false, this.Da.v), this.Xl(false, this.Da.C), this.Xl(true, this.Da.G), this.Xl(true, this.Da.H), this.ed.resize(0), this.ed.Jb(100), this.li = this.g.Hd();
          for (var i6 = new t4.h(), s4 = this.g.Ob(this.Y); s4 != -1; s4 = this.g.Sb(s4))
            for (var n4 = this.g.Ya(s4), h3 = 0, r3 = this.g.Ka(s4); h3 < r3; h3++, n4 = this.g.V(n4))
              this.g.D(n4, i6), (this.Da.v == i6.x || this.Da.C == i6.x || this.Da.G == i6.y || this.Da.H == i6.y) && (this.g.Sa(n4, this.li, this.ed.size), this.ed.add(n4));
          this.Pl(false, this.Da.v), this.Pl(false, this.Da.C), this.Pl(true, this.Da.G), this.Pl(true, this.Da.H), this.Oy();
        }, i5.prototype.Hy = function(i6) {
          for (var s4 = new t4.h(), n4 = new t4.h(), h3 = t4.P.mg(2048, 0), r3 = this.g.Ob(this.Y); r3 != -1; r3 = this.g.Sb(r3)) {
            var e3 = this.g.Ya(r3), o3 = e3;
            do {
              var a3 = this.g.V(o3);
              this.g.D(o3, s4);
              var u3 = -1;
              if (s4.x == this.Da.v ? (this.g.D(a3, n4), n4.x == this.Da.v && (u3 = 1)) : s4.x == this.Da.C && (this.g.D(a3, n4), n4.x == this.Da.C && (u3 = 1)), s4.y == this.Da.G ? (this.g.D(a3, n4), n4.y == this.Da.G && (u3 = 0)) : s4.y == this.Da.H && (this.g.D(a3, n4), n4.y == this.Da.H && (u3 = 0)), u3 != -1 && (u3 = t4.h.ub(s4, n4), !(1 >= (u3 = t4.P.truncate(Math.min(Math.ceil(u3 / i6), 2048)))))) {
                for (var f3 = 1; f3 < u3; f3++)
                  h3[f3 - 1] = 1 * f3 / u3;
                this.g.Wl(o3, h3, u3 - 1);
              }
              o3 = a3;
            } while (o3 != e3);
          }
        }, i5.prototype.Xl = function(i6, s4) {
          var n4 = this.g.Hd(), h3 = new t4.h(), r3 = new t4.ja(0);
          r3.Jb(100);
          for (var e3 = this.g.Ob(this.Y); e3 != -1; e3 = this.g.Sb(e3))
            for (var o3 = this.g.Ya(e3), a3 = 0, u3 = this.g.Ka(e3); a3 < u3; a3++) {
              var f3 = this.g.V(o3);
              this.g.D(o3, h3), (i6 ? h3.y == s4 : h3.x == s4) && (this.g.D(f3, h3), (i6 ? h3.y == s4 : h3.x == s4) && (this.g.Qa(o3, n4) != 1 && (r3.add(o3), this.g.Sa(o3, n4, 1)), this.g.Qa(f3, n4) != 1 && (r3.add(f3), this.g.Sa(f3, n4, 1)))), o3 = f3;
            }
          if (this.g.Ud(n4), !(3 > r3.size)) {
            var c3 = this;
            r3.Wd(0, r3.size, function(t5, i7) {
              return c3.Oh(t5, i7);
            }), n4 = new t4.h(), e3 = new t4.h(), o3 = new t4.h(), e3.Sc();
            var l3 = -1;
            a3 = new t4.ja(0), u3 = new t4.ja(0), f3 = this.g.Hd();
            for (var p3 = this.g.Hd(), v3 = 0, y3 = r3.size; v3 < y3; v3++) {
              var b3 = r3.get(v3);
              if (this.g.D(b3, h3), !h3.rb(e3)) {
                if (l3 != -1) {
                  for (var d3 = l3; d3 < v3; d3++) {
                    l3 = r3.get(d3);
                    var g3 = this.g.V(l3);
                    b3 = this.g.Na(l3);
                    var w3 = false;
                    0 > this.Oh(l3, g3) && (this.g.D(g3, n4), i6 ? n4.y == s4 : n4.x == s4) && (a3.add(l3), w3 = true, this.g.Sa(l3, p3, 1)), 0 > this.Oh(l3, b3) && (this.g.D(b3, n4), i6 ? n4.y == s4 : n4.x == s4) && (w3 || a3.add(l3), this.g.Sa(l3, f3, 1));
                  }
                  for (d3 = 0, w3 = a3.size; d3 < w3; d3++) {
                    if (l3 = a3.get(d3), b3 = this.g.Qa(l3, f3), g3 = this.g.Qa(l3, p3), b3 == 1) {
                      b3 = this.g.Na(l3), this.g.D(b3, o3);
                      var x3 = [0];
                      if (x3[0] = 0, !o3.rb(h3)) {
                        var m3 = t4.h.ub(e3, o3);
                        x3[0] = t4.h.ub(o3, h3) / m3, x3[0] == 0 ? x3[0] = 2220446049250313e-31 : x3[0] == 1 && (x3[0] = 0.9999999999999998), this.g.Wl(b3, x3, 1), b3 = this.g.Na(l3), this.g.mf(b3, h3), u3.add(b3), this.g.Sa(b3, f3, 1), this.g.Sa(b3, p3, -1);
                      }
                    }
                    g3 == 1 && (g3 = this.g.V(l3), this.g.D(g3, o3), (x3 = [0])[0] = 0, o3.rb(h3) || (m3 = t4.h.ub(e3, o3), x3[0] = t4.h.ub(e3, h3) / m3, x3[0] == 0 ? x3[0] = 2220446049250313e-31 : x3[0] == 1 && (x3[0] = 0.9999999999999998), this.g.Wl(l3, x3, 1), b3 = this.g.V(l3), this.g.mf(b3, h3), u3.add(b3), this.g.Sa(b3, f3, -1), this.g.Sa(b3, p3, 1)));
                  }
                  l3 = a3, a3 = u3, (u3 = l3).clear(false);
                }
                l3 = v3, e3.N(h3);
              }
            }
            this.g.Ud(f3), this.g.Ud(p3);
          }
        }, i5.prototype.Pl = function(i6, s4) {
          var n4 = new t4.h(), h3 = new t4.ja(0);
          h3.Jb(100);
          for (var r3 = this.g.Hd(), e3 = 0, o3 = this.ed.size; e3 < o3; e3++) {
            var a3 = this.ed.get(e3);
            if (a3 != -1) {
              var u3 = this.g.V(a3);
              this.g.D(a3, n4), (i6 ? n4.y == s4 : n4.x == s4) && (this.g.D(u3, n4), (i6 ? n4.y == s4 : n4.x == s4) && (this.g.Qa(a3, r3) != -2 && (h3.add(a3), this.g.Sa(a3, r3, -2)), this.g.Qa(u3, r3) != -2 && (h3.add(u3), this.g.Sa(u3, r3, -2))));
            }
          }
          if (h3.size != 0) {
            var f3 = this;
            for (h3.Wd(0, h3.size, function(t5, i7) {
              return f3.Oh(t5, i7);
            }), e3 = 0, o3 = h3.size; e3 < o3; e3++) {
              var c3 = h3.get(e3);
              this.g.Sa(c3, r3, e3);
            }
            a3 = new t4.h(), (u3 = new t4.h()).Sc();
            var l3 = -1;
            for (e3 = 0, o3 = h3.size; e3 < o3; e3++)
              if ((c3 = h3.get(e3)) != -1 && (this.g.D(c3, n4), !n4.rb(u3))) {
                if (l3 != -1)
                  for (; ; ) {
                    c3 = false;
                    for (var p3 = 1 < e3 - l3 ? e3 - 1 : e3, v3 = l3; v3 < p3; v3++) {
                      var y3 = h3.get(v3);
                      if (y3 != -1) {
                        var b3 = -1, d3 = this.g.V(y3);
                        0 > this.Oh(y3, d3) && (this.g.D(d3, a3), i6 ? a3.y == s4 : a3.x == s4) && (b3 = d3), d3 = -1;
                        var g3 = this.g.Na(y3);
                        if (0 > this.Oh(y3, g3) && (this.g.D(g3, a3), i6 ? a3.y == s4 : a3.x == s4) && (d3 = g3), b3 != -1 && d3 != -1)
                          this.Mh(y3, h3, r3), this.g.qd(y3, false), this.Mh(b3, h3, r3), this.g.qd(b3, false), c3 = true;
                        else if (b3 != -1 || d3 != -1) {
                          for (g3 = v3 + 1; g3 < e3; g3++) {
                            var w3 = h3.get(g3);
                            if (w3 != -1) {
                              var x3 = this.g.V(w3), m3 = -1;
                              0 > this.Oh(w3, x3) && (this.g.D(x3, a3), i6 ? a3.y == s4 : a3.x == s4) && (m3 = x3), x3 = this.g.Na(w3);
                              var j3 = -1;
                              if (0 > this.Oh(w3, x3) && (this.g.D(x3, a3), i6 ? a3.y == s4 : a3.x == s4) && (j3 = x3), m3 != -1 && j3 != -1) {
                                this.Mh(w3, h3, r3), this.g.qd(w3, false), this.Mh(m3, h3, r3), this.g.qd(m3, false), c3 = true;
                                break;
                              }
                              if (b3 != -1 && j3 != -1) {
                                this.At(h3, y3, b3, w3, j3, r3), c3 = true;
                                break;
                              }
                              if (d3 != -1 && m3 != -1) {
                                this.At(h3, w3, m3, y3, d3, r3), c3 = true;
                                break;
                              }
                            }
                          }
                          if (c3)
                            break;
                        }
                      }
                    }
                    if (!c3)
                      break;
                  }
                l3 = e3, u3.N(n4);
              }
          }
          this.g.Ud(r3);
        }, i5.prototype.Mh = function(t5, i6, s4) {
          s4 = this.g.Qa(t5, s4), i6.set(s4, -1), s4 = this.g.Qa(t5, this.li), this.ed.set(s4, -1), (i6 = this.g.cd(t5)) != -1 && this.g.Ya(i6) == t5 && (this.g.Kf(i6, -1), this.g.Yg(i6, -1));
        }, i5.prototype.At = function(t5, i6, s4, n4, h3, r3) {
          this.g.Cc(i6, n4), this.g.Dc(n4, i6), this.g.Dc(s4, h3), this.g.Cc(h3, s4), this.Mh(n4, t5, r3), this.g.oi(n4, false), this.Mh(h3, t5, r3), this.g.oi(h3, true);
        }, i5.prototype.Oy = function() {
          for (var t5 = 0, i6 = this.ed.size; t5 < i6; t5++) {
            var s4 = this.ed.get(t5);
            s4 != -1 && this.g.cj(s4, -1);
          }
          for (var n4 = 0, h3 = 0, r3 = this.g.Ob(this.Y); r3 != -1; ) {
            var e3 = this.g.Ya(r3);
            if (e3 == -1 || r3 != this.g.cd(e3)) {
              var o3 = r3;
              r3 = this.g.Sb(r3), this.g.Kf(o3, -1), this.g.br(o3);
            } else {
              s4 = e3, o3 = 0;
              do {
                this.g.cj(s4, r3), o3++, s4 = this.g.V(s4);
              } while (s4 != e3);
              2 >= o3 ? (s4 = this.g.Qa(e3, this.li), this.ed.set(s4, -1), e3 = this.g.qd(e3, false), o3 == 2 && (s4 = this.g.Qa(e3, this.li), this.ed.set(s4, -1), this.g.qd(e3, false)), o3 = r3, r3 = this.g.Sb(r3), this.g.Kf(o3, -1), this.g.br(o3)) : (this.g.fp(r3, false), this.g.Yg(r3, this.g.Na(e3)), this.g.Xj(r3, o3), h3 += o3, n4++, r3 = this.g.Sb(r3));
            }
          }
          for (t5 = 0, i6 = this.ed.size; t5 < i6; t5++)
            if ((s4 = this.ed.get(t5)) != -1 && (r3 = this.g.cd(s4)) == -1) {
              r3 = this.g.wf(this.Y, -1), o3 = 0, e3 = s4;
              do {
                this.g.cj(s4, r3), o3++, s4 = this.g.V(s4);
              } while (s4 != e3);
              2 >= o3 ? (s4 = this.g.Qa(e3, this.li), this.ed.set(s4, -1), e3 = this.g.qd(e3, false), o3 == 2 && (0 <= (s4 = this.g.Qa(e3, this.li)) && this.ed.set(s4, -1), this.g.qd(e3, false)), o3 = r3, this.g.Kf(o3, -1), this.g.br(o3)) : (this.g.mn(r3, true), this.g.Xj(r3, o3), this.g.Kf(r3, e3), this.g.Yg(r3, this.g.Na(e3)), this.g.fp(r3, false), h3 += o3, n4++);
            }
          for (this.g.Tl(this.Y, n4), this.g.Vj(this.Y, h3), t5 = 0, i6 = this.g.md; i6 != -1; i6 = this.g.ve(i6))
            t5 += this.g.I(i6);
          this.g.XB(t5);
        }, i5.wy = function(t5, s4, n4) {
          return new i5(s4).vy(t5, n4);
        }, i5.clip = function(s4, n4, h3, r3) {
          if (s4.B())
            return s4;
          if (n4.B())
            return s4.Ja();
          if ((h3 = s4.K()) == 33)
            return r3 = s4.D(), n4.contains(r3) ? s4 : s4.Ja();
          if (h3 == 197)
            return r3 = new t4.l(), s4.A(r3), r3.Fa(n4) ? (n4 = new t4.Hh(), s4.copyTo(n4), n4.Zo(r3), n4) : s4.Ja();
          var e3 = new t4.l();
          if (s4.yc(e3), n4.contains(e3))
            return s4;
          if (!n4.isIntersecting(e3))
            return s4.Ja();
          if ((e3 = s4.Cb) != null && (e3 = e3.Hk) != null) {
            if ((e3 = e3.To(n4)) == 1) {
              if (h3 != 1736)
                throw t4.i.Ra();
              return (s4 = new t4.Ea(s4.description)).vp(n4), s4;
            }
            if (e3 == 0)
              return s4.Ja();
          }
          switch (h3) {
            case 550:
              h3 = null, e3 = s4.I();
              for (var o3 = s4.vb(0), a3 = 0, u3 = 0; u3 < e3; u3++)
                r3 = new t4.h(), o3.uc(2 * u3, r3), n4.contains(r3) || (a3 == 0 && (h3 = s4.Ja()), a3 < u3 && h3.Gd(s4, a3, u3), a3 = u3 + 1);
              return 0 < a3 && h3.Gd(s4, a3, e3), a3 == 0 ? s4 : h3;
            case 1736:
            case 1607:
              return i5.wy(s4, n4, r3);
            default:
              throw t4.i.Ra();
          }
        }, i5.prototype.Oh = function(i6, s4) {
          var n4 = new t4.h();
          return this.g.D(i6, n4), i6 = new t4.h(), this.g.D(s4, i6), n4.compare(i6);
        }, i5;
      }();
      t4.Vd = i4;
    }(Q2 || (Q2 = {})), function(t4) {
      var i4 = function() {
        function i5(i6, s4) {
          this.Da = i6, this.g = new t4.hd(), this.ed = new t4.ja(0), this.od = s4;
        }
        return i5.prototype.Nh = function(t5, i6, s4) {
          switch (i6) {
            case 0:
              if (t5.v < s4 && t5.C <= s4)
                break;
              return t5.v >= s4 ? 1 : -1;
            case 1:
              if (t5.G < s4 && t5.H <= s4)
                break;
              return t5.G >= s4 ? 1 : -1;
            case 2:
              if (t5.v >= s4 && t5.C > s4)
                break;
              return t5.C <= s4 ? 1 : -1;
            case 3:
              if (!(t5.G >= s4 && t5.H > s4))
                return t5.H <= s4 ? 1 : -1;
          }
          return 0;
        }, i5.prototype.vy = function(t5, i6) {
          return t5.K() == 1736 ? this.xy(t5, i6) : this.yy(t5);
        }, i5.prototype.xy = function(i6, s4) {
          if (this.Da.S() == 0 || this.Da.da() == 0)
            return i6.Ja();
          var n4 = new t4.l();
          i6.yc(n4), this.Y = this.g.Ib(i6);
          var h3 = new t4.l(), r3 = new t4.l(), e3 = new t4.h(), o3 = new t4.h(), a3 = [0, 0, 0, 0, 0, 0, 0, 0, 0], u3 = [0, 0, 0, 0, 0, 0, 0, 0, 0], f3 = new t4.zb(), c3 = new t4.ja(0);
          c3.Jb(256);
          for (var l3 = false, p3 = 0; !l3 && 4 > p3; p3++) {
            var v3 = false, y3 = (1 & p3) != 0, b3 = 0;
            switch (p3) {
              case 0:
                b3 = this.Da.v, v3 = n4.v <= b3 && n4.C >= b3;
                break;
              case 1:
                b3 = this.Da.G, v3 = n4.G <= b3 && n4.H >= b3;
                break;
              case 2:
                b3 = this.Da.C, v3 = n4.v <= b3 && n4.C >= b3;
                break;
              case 3:
                b3 = this.Da.H, v3 = n4.G <= b3 && n4.H >= b3;
            }
            if (v3)
              for (l3 = true, v3 = this.g.Ob(this.Y); v3 != -1; ) {
                var d3 = true, g3 = -1, w3 = -1, x3 = this.g.Ya(v3), m3 = x3;
                do {
                  var j3 = this.g.cc(m3);
                  j3 == null && (j3 = f3, this.g.D(m3, e3), j3.Ec(e3), this.g.D(this.g.V(m3), o3), j3.Rc(o3)), j3.A(h3);
                  var M3 = this.Nh(h3, p3, b3), k3 = 0, z3 = -1;
                  if (M3 == -1) {
                    k3 = 0 < (j3 = j3.fq(y3, b3, a3, u3)) ? this.g.HX(m3, u3, j3) : 0, k3 += 1;
                    var A3 = m3, N3 = this.g.V(A3);
                    for (j3 = 0; j3 < k3; j3++) {
                      if (this.g.D(A3, e3), this.g.D(N3, o3), (z3 = this.g.cc(A3)) == null && ((z3 = f3).Ec(e3), z3.Rc(o3)), z3.A(r3), (z3 = this.Nh(r3, p3, b3)) == -1) {
                        if (y3)
                          (z3 = Math.abs(e3.y - b3)) < (I3 = Math.abs(o3.y - b3)) ? (e3.y = b3, this.g.mf(A3, e3)) : (o3.y = b3, this.g.mf(N3, o3));
                        else {
                          z3 = Math.abs(e3.x - b3);
                          var I3 = Math.abs(o3.x - b3);
                          z3 < I3 ? (e3.x = b3, this.g.mf(A3, e3)) : (o3.x = b3, this.g.mf(N3, o3));
                        }
                        (z3 = this.g.cc(A3)) == null && ((z3 = f3).Ec(e3), z3.Rc(o3)), z3.A(r3), z3 = this.Nh(r3, p3, b3);
                      }
                      I3 = g3, g3 = z3, w3 == -1 && (w3 = g3), I3 == 0 && g3 == 1 || I3 == 1 && g3 == 0 || I3 != 0 || g3 != 0 || c3.add(A3), g3 == 1 && (d3 = l3 = false), z3 = A3 = N3, N3 = this.g.V(N3);
                    }
                  }
                  if (k3 == 0 && (I3 = g3, g3 = M3, w3 == -1 && (w3 = g3), I3 == 0 && g3 == 1 || I3 == 1 && g3 == 0 || I3 != 0 || g3 != 0 || c3.add(m3), g3 == 1 && (d3 = l3 = false), z3 = this.g.V(m3)), m3 = z3, 256 <= c3.size) {
                    for (j3 = 1, M3 = c3.size - 1; j3 < M3; j3++)
                      k3 = c3.get(j3), this.g.qd(k3, false);
                    c3.set(1, c3.Gc()), c3.Dh(2);
                  }
                } while (m3 != x3);
                if (!d3)
                  for (w3 == 0 && g3 == 0 && c3.add(x3), j3 = 0, M3 = c3.size; j3 < M3; j3++)
                    k3 = c3.get(j3), this.g.qd(k3, false);
                c3.clear(false), v3 = d3 || this.g.Ka(v3) == 0 ? this.g.ar(v3) : this.g.Sb(v3);
              }
          }
          return l3 ? i6.Ja() : (this.AB(), 0 < s4 && this.Hy(s4), this.g.Ke(this.Y));
        }, i5.prototype.yy = function(i6) {
          var s4 = new t4.l(), n4 = new t4.l(), h3 = [0, 0, 0, 0, 0, 0, 0, 0, 0], r3 = [0, 0, 0, 0, 0, 0, 0, 0, 0], e3 = new t4.jg(), o3 = i6, a3 = new t4.l();
          i6.yc(a3);
          for (var u3 = new t4.h(), f3 = new t4.h(), c3 = null, l3 = null, p3 = 0; 4 > p3; p3++) {
            var v3 = false, y3 = (1 & p3) != 0, b3 = 0;
            switch (p3) {
              case 0:
                b3 = this.Da.v, v3 = a3.v <= b3 && a3.C >= b3;
                break;
              case 1:
                b3 = this.Da.G, v3 = a3.G <= b3 && a3.H >= b3;
                break;
              case 2:
                b3 = this.Da.C, v3 = a3.v <= b3 && a3.C >= b3;
                break;
              case 3:
                b3 = this.Da.H, v3 = a3.G <= b3 && a3.H >= b3;
            }
            if (v3)
              for (v3 = o3, o3 = i6.Ja(), (v3 = v3.Ha()).aj(); v3.ab(); )
                for (var d3, g3 = true; v3.Ia(); ) {
                  var w3 = v3.ia();
                  w3.A(s4);
                  var x3 = this.Nh(s4, p3, b3);
                  if (x3 == -1) {
                    if (0 < (x3 = w3.fq(y3, b3, h3, r3))) {
                      var m3 = 0;
                      w3.$p(u3);
                      for (var j3 = 0; j3 <= x3; j3++)
                        if (m3 != (d3 = j3 < x3 ? r3[j3] : 1)) {
                          w3.dh(m3, d3, e3);
                          var M3 = e3.get();
                          M3.Ec(u3), j3 < x3 && (y3 ? (f3.x = h3[j3], f3.y = b3) : (f3.x = b3, f3.y = h3[j3]), M3.Rc(f3)), M3.A(n4);
                          var k3 = this.Nh(n4, p3, b3);
                          k3 == -1 && (c3 == null && (c3 = new t4.h()), l3 == null && (l3 = new t4.h()), M3.$p(c3), M3.Vr(l3), y3 ? (m3 = Math.abs(c3.y - b3)) < (k3 = Math.abs(l3.y - b3)) ? (c3.y = b3, M3.Ec(c3)) : (l3.y = b3, M3.Rc(l3)) : (m3 = Math.abs(c3.x - b3)) < (k3 = Math.abs(l3.x - b3)) ? (c3.x = b3, M3.Ec(c3)) : (l3.x = b3, M3.Rc(l3)), M3.A(n4), k3 = this.Nh(n4, p3, b3)), M3.Vr(u3), m3 = d3, (d3 = k3) == 1 ? (o3.pc(M3, g3), g3 = false) : g3 = true;
                        }
                    }
                  } else
                    (d3 = x3) == 1 ? (o3.pc(w3, g3), g3 = false) : g3 = true;
                }
          }
          return o3;
        }, i5.prototype.AB = function() {
          this.li = -1, this.Xl(false, this.Da.v), this.Xl(false, this.Da.C), this.Xl(true, this.Da.G), this.Xl(true, this.Da.H), this.ed.resize(0), this.ed.Jb(100), this.li = this.g.Hd();
          for (var i6 = new t4.h(), s4 = this.g.Ob(this.Y); s4 != -1; s4 = this.g.Sb(s4))
            for (var n4 = this.g.Ya(s4), h3 = 0, r3 = this.g.Ka(s4); h3 < r3; h3++, n4 = this.g.V(n4))
              this.g.D(n4, i6), (this.Da.v == i6.x || this.Da.C == i6.x || this.Da.G == i6.y || this.Da.H == i6.y) && (this.g.Sa(n4, this.li, this.ed.size), this.ed.add(n4));
          this.Pl(false, this.Da.v), this.Pl(false, this.Da.C), this.Pl(true, this.Da.G), this.Pl(true, this.Da.H), this.Oy();
        }, i5.prototype.Hy = function(i6) {
          for (var s4 = new t4.h(), n4 = new t4.h(), h3 = null, r3 = null, e3 = t4.P.mg(2048, 0), o3 = this.g.Ob(this.Y); o3 != -1; o3 = this.g.Sb(o3)) {
            var a3 = this.g.Ya(o3), u3 = a3;
            do {
              var f3 = this.g.V(u3);
              this.g.D(u3, s4);
              var c3 = -1;
              if (s4.x == this.Da.v ? (this.g.D(f3, n4), n4.x == this.Da.v && (c3 = 1)) : s4.x == this.Da.C && (this.g.D(f3, n4), n4.x == this.Da.C && (c3 = 1)), s4.y == this.Da.G ? (this.g.D(f3, n4), n4.y == this.Da.G && (c3 = 0)) : s4.y == this.Da.H && (this.g.D(f3, n4), n4.y == this.Da.H && (c3 = 0)), c3 != -1) {
                if (h3 == null && (h3 = new t4.h()), r3 == null && (r3 = new t4.h()), h3.N(s4), r3.na(0, 0), c3 == 0) {
                  var l3 = s4.x - this.Da.v;
                  r3.x = t4.mc.sign(n4.x - s4.x), h3.x = i6 * t4.mc.En(Math.floor(Math.abs(l3 / i6)), l3) + this.Da.v, 0 > h3.x && (h3.x += i6);
                } else
                  l3 = s4.y - this.Da.G, r3.y = t4.mc.sign(n4.y - s4.y), h3.y = i6 * t4.mc.En(Math.floor(Math.abs(l3 / i6)), l3) + this.Da.G, 0 > h3.y && (h3.y += i6);
                l3 = c3 != 0 ? n4.y - s4.y : n4.x - s4.x;
                var p3 = Math.abs(l3);
                if (65536 < p3 / i6)
                  throw t4.i.ga("internal error");
                if (0 < p3) {
                  p3 = t4.P.truncate(p3 / i6) + 2, e3.length < p3 && (e3 = t4.P.mg(p3));
                  for (var v3 = p3 = 0; ; v3++) {
                    var y3 = new t4.h();
                    if (y3.x = h3.x + r3.x * v3 * i6, y3.y = h3.y + r3.y * v3 * i6, 1 <= (y3 = (c3 != 0 ? y3.y - s4.y : y3.x - s4.x) / l3))
                      break;
                    0 >= y3 || (e3[p3] = y3, p3++);
                  }
                  p3 != 0 && this.g.Wl(u3, e3, p3);
                }
              }
              u3 = f3;
            } while (u3 != a3);
          }
        }, i5.prototype.Xl = function(i6, s4) {
          for (var n4 = -1, h3 = new t4.h(), r3 = null, e3 = this.g.Ob(this.Y); e3 != -1; e3 = this.g.Sb(e3))
            for (var o3 = this.g.Ya(e3), a3 = 0, u3 = this.g.Ka(e3); a3 < u3; a3++) {
              var f3 = this.g.V(o3);
              this.g.D(o3, h3), (i6 ? h3.y == s4 : h3.x == s4) && (this.g.D(f3, h3), (i6 ? h3.y == s4 : h3.x == s4) && (n4 == -1 && (n4 = this.g.Hd()), r3 == null && (r3 = new t4.ja(0)).Jb(100), this.g.Qa(o3, n4) != 1 && (r3.add(o3), this.g.Sa(o3, n4, 1)), this.g.Qa(f3, n4) != 1 && (r3.add(f3), this.g.Sa(f3, n4, 1)))), o3 = f3;
            }
          if (n4 != -1 && this.g.Ud(n4), !(r3 == null || 3 > r3.size)) {
            var c3 = this;
            r3.Wd(0, r3.size, function(t5, i7) {
              return c3.Oh(t5, i7);
            }), n4 = new t4.h(), e3 = new t4.h(), o3 = new t4.h(), e3.Sc();
            var l3 = -1;
            a3 = new t4.ja(0), u3 = new t4.ja(0), f3 = null;
            for (var p3 = this.g.Hd(), v3 = this.g.Hd(), y3 = 0, b3 = r3.size; y3 < b3; y3++) {
              var d3 = r3.get(y3);
              if (this.g.D(d3, h3), !h3.rb(e3)) {
                if (l3 != -1) {
                  for (var g3 = l3; g3 < y3; g3++) {
                    l3 = r3.get(g3);
                    var w3 = this.g.V(l3);
                    d3 = this.g.Na(l3);
                    var x3 = false;
                    this.g.D(w3, n4), 0 > e3.compare(n4) && (i6 ? n4.y == s4 : n4.x == s4) && (a3.add(l3), x3 = true, this.g.Sa(l3, v3, 1)), this.g.D(d3, n4), 0 > e3.compare(n4) && (i6 ? n4.y == s4 : n4.x == s4) && (x3 || a3.add(l3), this.g.Sa(l3, p3, 1));
                  }
                  for (g3 = 0, x3 = a3.size; g3 < x3; g3++) {
                    if (l3 = a3.get(g3), d3 = this.g.Qa(l3, p3), w3 = this.g.Qa(l3, v3), d3 == 1 && (d3 = this.g.Na(l3), this.g.D(d3, o3), !o3.rb(h3))) {
                      f3 == null && (f3 = []);
                      var m3 = t4.h.ub(e3, o3);
                      f3[0] = t4.h.ub(o3, h3) / m3, f3[0] == 0 ? f3[0] = 2220446049250313e-31 : f3[0] == 1 && (f3[0] = 0.9999999999999998), this.g.Wl(d3, f3, 1), d3 = this.g.Na(l3), this.g.mf(d3, h3), u3.add(d3), this.g.Sa(d3, p3, 1), this.g.Sa(d3, v3, -1);
                    }
                    w3 == 1 && (w3 = this.g.V(l3), this.g.D(w3, o3), o3.rb(h3) || (f3 == null && (f3 = []), m3 = t4.h.ub(e3, o3), f3[0] = t4.h.ub(e3, h3) / m3, f3[0] == 0 ? f3[0] = 2220446049250313e-31 : f3[0] == 1 && (f3[0] = 0.9999999999999998), this.g.Wl(l3, f3, 1), d3 = this.g.V(l3), this.g.mf(d3, h3), u3.add(d3), this.g.Sa(d3, p3, -1), this.g.Sa(d3, v3, 1)));
                  }
                  l3 = a3, a3 = u3, (u3 = l3).clear(false);
                }
                l3 = y3, e3.N(h3);
              }
            }
            this.g.Ud(p3), this.g.Ud(v3);
          }
        }, i5.prototype.Pl = function(i6, s4) {
          for (var n4 = new t4.h(), h3 = null, r3 = -1, e3 = 0, o3 = this.ed.size; e3 < o3; e3++) {
            var a3 = this.ed.get(e3);
            if (a3 != -1) {
              var u3 = this.g.V(a3);
              this.g.D(a3, n4), (i6 ? n4.y == s4 : n4.x == s4) && (this.g.D(u3, n4), (i6 ? n4.y == s4 : n4.x == s4) && (r3 == -1 && (r3 = this.g.Hd()), h3 == null && (h3 = new t4.ja(0)).Jb(100), this.g.Qa(a3, r3) != -2 && (h3.add(a3), this.g.Sa(a3, r3, -2)), this.g.Qa(u3, r3) != -2 && (h3.add(u3), this.g.Sa(u3, r3, -2))));
            }
          }
          if (h3 == null)
            r3 != -1 && this.g.Ud(r3);
          else {
            var f3 = this;
            for (h3.Wd(0, h3.size, function(t5, i7) {
              return f3.Oh(t5, i7);
            }), e3 = 0, o3 = h3.size; e3 < o3; e3++) {
              var c3 = h3.get(e3);
              this.g.Sa(c3, r3, e3);
            }
            a3 = new t4.h(), (u3 = new t4.h()).Sc();
            var l3 = -1;
            for (e3 = 0, o3 = h3.size; e3 < o3; e3++)
              if ((c3 = h3.get(e3)) != -1 && (this.g.D(c3, n4), !n4.rb(u3))) {
                if (l3 != -1)
                  for (; ; ) {
                    c3 = false;
                    for (var p3 = 1 < e3 - l3 ? e3 - 1 : e3, v3 = l3; v3 < p3; v3++) {
                      var y3 = h3.get(v3);
                      if (y3 != -1) {
                        var b3 = -1, d3 = this.g.V(y3);
                        this.g.D(d3, a3), 0 > u3.compare(a3) && (i6 ? a3.y == s4 : a3.x == s4) && (b3 = d3), d3 = -1;
                        var g3 = this.g.Na(y3);
                        if (this.g.D(g3, a3), 0 > u3.compare(a3) && (i6 ? a3.y == s4 : a3.x == s4) && (d3 = g3), b3 != -1 && d3 != -1)
                          this.Mh(y3, h3, r3), this.g.qd(y3, false), this.Mh(b3, h3, r3), this.g.qd(b3, false), c3 = true;
                        else if (b3 != -1 || d3 != -1) {
                          for (g3 = v3 + 1; g3 < e3; g3++) {
                            var w3 = h3.get(g3);
                            if (w3 != -1) {
                              var x3 = this.g.V(w3), m3 = -1;
                              this.g.D(x3, a3), 0 > u3.compare(a3) && (i6 ? a3.y == s4 : a3.x == s4) && (m3 = x3), x3 = this.g.Na(w3);
                              var j3 = -1;
                              if (this.g.D(x3, a3), 0 > u3.compare(a3) && (i6 ? a3.y == s4 : a3.x == s4) && (j3 = x3), m3 != -1 && j3 != -1) {
                                this.Mh(w3, h3, r3), this.g.qd(w3, false), this.Mh(m3, h3, r3), this.g.qd(m3, false), c3 = true;
                                break;
                              }
                              if (b3 != -1 && j3 != -1) {
                                this.At(h3, y3, b3, w3, j3, r3), c3 = true;
                                break;
                              }
                              if (d3 != -1 && m3 != -1) {
                                this.At(h3, w3, m3, y3, d3, r3), c3 = true;
                                break;
                              }
                            }
                          }
                          if (c3)
                            break;
                        }
                      }
                    }
                    if (!c3)
                      break;
                  }
                l3 = e3, u3.N(n4);
              }
            this.g.Ud(r3);
          }
        }, i5.prototype.Mh = function(t5, i6, s4) {
          s4 = this.g.Qa(t5, s4), i6.set(s4, -1), s4 = this.g.Qa(t5, this.li), this.ed.set(s4, -1), (i6 = this.g.cd(t5)) != -1 && this.g.Ya(i6) == t5 && (this.g.Kf(i6, -1), this.g.Yg(i6, -1));
        }, i5.prototype.At = function(t5, i6, s4, n4, h3, r3) {
          this.g.Cc(i6, n4), this.g.Dc(n4, i6), this.g.Dc(s4, h3), this.g.Cc(h3, s4), this.Mh(n4, t5, r3), this.g.oi(n4, false), this.Mh(h3, t5, r3), this.g.oi(h3, true);
        }, i5.prototype.Oy = function() {
          for (var t5 = 0, i6 = this.ed.size; t5 < i6; t5++) {
            var s4 = this.ed.get(t5);
            s4 != -1 && this.g.cj(s4, -1);
          }
          for (var n4 = 0, h3 = 0, r3 = this.g.Ob(this.Y); r3 != -1; ) {
            var e3 = this.g.Ya(r3);
            if (e3 == -1 || r3 != this.g.cd(e3)) {
              var o3 = r3;
              r3 = this.g.Sb(r3), this.g.Kf(o3, -1), this.g.br(o3);
            } else {
              s4 = e3, o3 = 0;
              do {
                this.g.cj(s4, r3), o3++, s4 = this.g.V(s4);
              } while (s4 != e3);
              this.g.fp(r3, false), this.g.Yg(r3, this.g.Na(e3)), this.g.Xj(r3, o3), h3 += o3, n4++, r3 = this.g.Sb(r3);
            }
          }
          for (t5 = 0, i6 = this.ed.size; t5 < i6; t5++)
            if ((s4 = this.ed.get(t5)) != -1 && (r3 = this.g.cd(s4)) == -1) {
              r3 = this.g.wf(this.Y, -1), o3 = 0, e3 = s4;
              do {
                this.g.cj(s4, r3), o3++, s4 = this.g.V(s4);
              } while (s4 != e3);
              2 >= o3 ? (s4 = this.g.Qa(e3, this.li), this.ed.set(s4, -1), e3 = this.g.qd(e3, false), o3 == 2 && (0 <= (s4 = this.g.Qa(e3, this.li)) && this.ed.set(s4, -1), this.g.qd(e3, false)), o3 = r3, this.g.Kf(o3, -1), this.g.br(o3)) : (this.g.mn(r3, true), this.g.Xj(r3, o3), this.g.Kf(r3, e3), this.g.Yg(r3, this.g.Na(e3)), this.g.fp(r3, false), h3 += o3, n4++);
            }
          for (this.g.Tl(this.Y, n4), this.g.Vj(this.Y, h3), t5 = 0, i6 = this.g.md; i6 != -1; i6 = this.g.ve(i6))
            t5 += this.g.I(i6);
          this.g.XB(t5);
        }, i5.wy = function(t5, s4, n4, h3) {
          return new i5(s4, h3).vy(t5, n4);
        }, i5.clip = function(t5, s4, n4, h3, r3) {
          return i5.Pu(t5, s4, null, n4, h3, r3);
        }, i5.Pu = function(s4, n4, h3, r3, e3, o3) {
          var a3 = s4.K();
          if (a3 == 33)
            return e3 = s4.D(), n4.contains(e3) ? s4 : s4.Ja();
          if (a3 == 197)
            return e3 = new t4.l(), s4.A(e3), e3.Fa(n4) ? (n4 = new t4.Hh(), s4.copyTo(n4), n4.Zo(e3), n4) : s4.Ja();
          if (s4.B())
            return s4;
          if (n4.B())
            return s4.Ja();
          var u3 = new t4.l();
          if (s4.yc(u3), n4.contains(u3))
            return s4;
          if (!n4.isIntersecting(u3))
            return s4.Ja();
          if ((h3 != null || isNaN(r3)) && t4.ua.oy(h3, n4, false), !t4.ba.zj(a3))
            throw t4.i.O();
          if ((h3 = s4.Cb) != null && (h3 = h3.Hk) != null) {
            if ((h3 = h3.To(n4)) == 1) {
              if (a3 != 1736)
                throw t4.i.ga("internal error");
              return (s4 = new t4.Ea(s4.description)).vp(n4), s4;
            }
            if (h3 == 0)
              return s4.Ja();
          }
          switch (a3) {
            case 550:
              for (o3 = null, a3 = s4.I(), h3 = s4.vb(0), r3 = 0, e3 = new t4.h(), u3 = 0; u3 < a3; u3++)
                h3.uc(2 * u3, e3), n4.contains(e3) || (r3 == 0 && (o3 = s4.Ja()), r3 < u3 && o3.Gd(s4, r3, u3), r3 = u3 + 1);
              return 0 < r3 && o3.Gd(s4, r3, a3), r3 == 0 ? s4 : o3;
            case 1736:
            case 1607:
              return i5.wy(s4, n4, e3, o3);
            default:
              throw t4.i.ga("internal error");
          }
        }, i5.prototype.Oh = function(i6, s4) {
          var n4 = new t4.h();
          return this.g.D(i6, n4), i6 = new t4.h(), this.g.D(s4, i6), n4.compare(i6);
        }, i5;
      }();
      t4.ti = i4;
    }(Q2 || (Q2 = {})), function(t4) {
      var i4 = new t4.h(), s4 = function() {
        function i5(i6, s5, n5, h3, r3) {
          this.Rm = new t4.h(), this.Fk = new t4.h(), this.Ri = new t4.h(), this.g = i6, this.Cw = n5, this.po = h3, this.Rm = s5, this.Al = r3, this.Fk.Sc(), this.Ri.Sc();
        }
        return i5.prototype.sE = function(i6) {
          this.g.D(i6, this.Fk), i6 = t4.P.truncate((this.Fk.x - this.Rm.x) * this.po + 0.5);
          var s5 = t4.P.truncate((this.Fk.y - this.Rm.y) * this.po + 0.5);
          return n4.eG(i6, s5);
        }, i5.prototype.ez = function(t5) {
          return this.g.Qa(t5, this.Al);
        }, i5.prototype.Ky = function(t5, i6) {
          return this.g.D(t5, this.Fk), this.g.D(i6, this.Ri), n4.Ev(this.Fk.x, this.Fk.y, this.Ri.x, this.Ri.y, this.Cw);
        }, i5;
      }();
      t4.oY = function() {
      };
      var n4 = function() {
        function n5() {
          this.Rm = new t4.h(), this.rq = [0, 0, 0, 0], this.zs = [0, 0, 0, 0], this.so = this.Al = -1;
        }
        return n5.dQ = function(t5, i5) {
          var s5 = new n5();
          return s5.g = t5, s5.ra = i5, s5.Cw = i5 * i5, s5.bw = 2 * i5, s5.po = 1 / s5.bw, s5.wO();
        }, n5.Ev = function(t5, i5, s5, n6, h3) {
          return (t5 -= s5) * t5 + (i5 -= n6) * i5 <= h3;
        }, n5.eG = function(i5, s5) {
          return t4.P.Vh(s5, t4.P.Vh(i5));
        }, n5.prototype.yO = function(s5, h3) {
          this.g.Hc(s5, i4);
          for (var r3 = (i4.y - this.Rm.y) * this.po, e3 = t4.P.truncate((i4.x - this.Rm.x) * this.po), o3 = t4.P.truncate(r3), a3 = r3 = 0; 1 >= a3; a3 += 1)
            for (var u3 = 0; 1 >= u3; u3 += 1) {
              var f3 = n5.eG(e3 + a3, o3 + u3), c3 = this.zl.lR(f3);
              c3 != -1 && (this.rq[r3] = c3, this.zs[r3] = f3, r3++);
            }
          for (e3 = r3 - 1; 1 <= e3; e3--)
            for (c3 = this.rq[e3], o3 = e3 - 1; 0 <= o3; o3--)
              if (c3 == this.rq[o3]) {
                this.zs[o3] = -1, e3 != --r3 && (this.zs[e3] = this.zs[r3], this.rq[e3] = this.rq[r3]);
                break;
              }
          for (o3 = 0; o3 < r3; o3++)
            this.zO(s5, this.zs[o3], i4, this.rq[o3], h3);
        }, n5.prototype.zO = function(i5, s5, h3, r3, e3) {
          for (var o3 = new t4.h(); r3 != -1; r3 = this.zl.zR(r3)) {
            var a3 = this.zl.ka(r3);
            i5 == a3 || s5 != -1 && this.g.Qa(a3, this.Al) != s5 || (this.g.Hc(a3, o3), n5.Ev(h3.x, h3.y, o3.x, o3.y, this.Cw) && e3.add(r3));
          }
        }, n5.prototype.Zm = function(t5, i5, s5) {
          var n6 = this.g.Qa(t5, this.so), h3 = this.g.Qa(i5, this.so);
          return n6 == -1 && (n6 = this.Ad.Rh(), this.Ad.addElement(n6, t5), this.g.Sa(t5, this.so, n6)), h3 == -1 ? this.Ad.addElement(n6, i5) : this.Ad.Cy(n6, h3), this.g.Sa(i5, this.so, -2), i5 = this.TT(t5, i5), s5 && (s5 = this.mw.sE(t5), this.g.Sa(t5, this.Al, s5)), i5;
        }, n5.RT = function(i5, s5, h3) {
          i5.Nb(s5), h3 = i5;
          var r3 = new t4.h();
          n5.ST(i5.D(), s5.D(), r3), h3.Db(r3);
        }, n5.ST = function(t5, i5, s5) {
          var n6 = t5.x;
          t5.x != i5.x && (n6 = (1 * t5.x + 1 * i5.x) / 2);
          var h3 = t5.y;
          t5.y != i5.y && (h3 = (1 * t5.y + 1 * i5.y) / 2), s5.na(n6, h3);
        }, n5.prototype.TT = function(i5, s5) {
          var n6 = new t4.h();
          this.g.D(i5, n6);
          var h3 = new t4.h();
          this.g.D(s5, h3);
          var r3 = this.g.YF(i5), e3 = r3 + (s5 = this.g.YF(s5)), o3 = 0, a3 = n6.x;
          n6.x != h3.x && (a3 = (n6.x * r3 + h3.x * s5) / e3, o3++);
          var u3 = n6.y;
          return n6.y != h3.y && (u3 = (n6.y * r3 + h3.y * s5) / e3, o3++), 0 < o3 && this.g.Db(i5, a3, u3), this.g.rX(i5, e3), o3 != 0;
        }, n5.prototype.wO = function() {
          var i5 = this.g.gd, n6 = this.g.DF();
          for (this.Rm = n6.hz(), n6 = Math.max(n6.da(), n6.S()) / 2147483646, this.bw < n6 && (this.bw = n6, this.po = 1 / this.bw), this.Ad = new t4.cu(), this.Ad.Bt(t4.P.truncate(this.g.gd / 3 + 1)), this.Ad.hn(t4.P.truncate(this.g.gd / 3 + 1)), this.Al = this.g.Hd(), this.so = this.g.Hd(), this.mw = new s4(this.g, this.Rm, this.Cw, this.po, this.Al), this.zl = new t4.ZK(t4.P.truncate(4 * i5 / 3), this.mw), this.zl.vW(this.g.gd), i5 = false, n6 = this.g.md; n6 != -1; n6 = this.g.ve(n6))
            for (var h3 = this.g.Ob(n6); h3 != -1; h3 = this.g.Sb(h3))
              for (var r3 = this.g.Ya(h3), e3 = 0, o3 = this.g.Ka(h3); e3 < o3; e3++) {
                var a3 = this.mw.sE(r3);
                this.g.Sa(r3, this.Al, a3), this.zl.addElement(r3, a3), r3 = this.g.V(r3);
              }
          var u3 = new t4.ja(0);
          for (u3.Jb(10), n6 = this.g.md; n6 != -1; n6 = this.g.ve(n6))
            for (h3 = this.g.Ob(n6); h3 != -1; h3 = this.g.Sb(h3))
              for (r3 = this.g.Ya(h3), e3 = 0, o3 = this.g.Ka(h3); e3 < o3; e3++) {
                if (this.g.Qa(r3, this.so) != -2)
                  for (a3 = this.g.Qa(r3, this.Al), this.zl.kd(r3, a3); this.yO(r3, u3), u3.size != 0; ) {
                    a3 = false;
                    for (var f3 = 0, c3 = u3.size; f3 < c3; f3++) {
                      var l3 = u3.get(f3), p3 = this.zl.ka(l3);
                      this.zl.wd(l3), a3 = this.Zm(r3, p3, f3 + 1 == c3) || a3;
                    }
                    if (i5 = i5 || a3, u3.clear(false), !a3)
                      break;
                  }
                r3 = this.g.V(r3);
              }
          return i5 && this.qN(), this.mw = this.zl = null, this.g.Ud(this.Al), this.g.Ud(this.so), i5;
        }, n5.prototype.qN = function() {
          for (var i5 = new t4.h(), s5 = this.Ad.ke; s5 != -1; s5 = this.Ad.lz(s5)) {
            var n6 = this.Ad.sc(s5);
            for (this.g.D(this.Ad.ka(n6), i5), n6 = this.Ad.lb(n6); n6 != -1; n6 = this.Ad.lb(n6))
              this.g.mf(this.Ad.ka(n6), i5);
          }
        }, n5;
      }();
      t4.$t = n4;
    }(Q2 || (Q2 = {})), function(t4) {
      var i4 = function() {
        function i5(t5) {
          t5 === void 0 && (t5 = null), this.zg = null, this.Pb = false, this.zg = t5 === null ? [] : t5;
        }
        return i5.prototype.copyTo = function(i6) {
          if (i6.Pb)
            throw t4.i.ga("CompositeGeographicTransformation is read-only");
          for (var s4 = 0; s4 < this.zg.length; s4++)
            i6.zg.push(this.zg[s4].Qf());
        }, i5.prototype.count = function() {
          return this.zg.length;
        }, i5.prototype.add = function(i6) {
          if (this.Pb)
            throw t4.i.ga("CompositeGeographicTransformation is read-only");
          this.zg.push(i6.Qf());
        }, i5.prototype.clear = function() {
          if (this.Pb)
            throw t4.i.ga("CompositeGeographicTransformation is read-only");
          this.zg.length = 0;
        }, i5.prototype.remove = function(i6) {
          if (this.Pb)
            throw t4.i.ga("CompositeGeographicTransformation is read-only");
          this.zg.splice(i6, 1);
        }, i5.prototype.kg = function() {
          var t5 = new i5();
          return this.copyTo(t5), t5;
        }, i5.prototype.Qf = function() {
          return this.kg();
        }, i5.prototype.transform = function(i6, s4, n4, h3) {
          if (i6.length < s4)
            throw t4.i.ga("invalid Argument");
          var r3 = n4;
          for (n4 = 0; n4 < this.zg.length; n4++) {
            var e3 = this.zg[n4];
            if (e3.sm() != null) {
              var o3 = e3.Wn, a3 = o3 ? 1 : 0, u3 = o3 ? e3.sm().getGeogcs2() : e3.sm().getGeogcs1();
              if (u3 = r3 / (u3 = u3.getUnit().getUnitFactor()), 3552713678800501e-30 < Math.abs(u3 - 1))
                for (r3 = 0; r3 < s4; r3++)
                  i6[r3][0] *= u3, i6[r3][1] *= u3;
              t4.HC.geogToGeog(e3.sm(), s4, i6, null, a3), r3 = (o3 ? e3.sm().getGeogcs1() : e3.sm().getGeogcs2()).getUnit().getUnitFactor();
            }
          }
          if (u3 = r3 / h3, 3552713678800501e-30 < Math.abs(u3 - 1))
            for (r3 = 0; r3 < s4; r3++)
              i6[r3][0] *= u3, i6[r3][1] *= u3;
          return s4;
        }, i5.prototype.Nb = function(t5) {
          if (t5 == this)
            return true;
          if (!(t5 instanceof i5) || this.zg.length != t5.zg.length)
            return false;
          for (var s4 = 0; s4 < this.zg.length; s4++)
            if (!this.zg[s4].Nb(t5.zg[s4]))
              return false;
          return true;
        }, i5.prototype.ix = function() {
          this.Pb = true;
        }, i5.prototype.toString = function() {
          for (var t5 = "CGT (" + this.count() + ") ", i6 = 0, s4 = this.count(); i6 < s4; ++i6)
            t5 += this.zg[i6].toString() + ", ";
          return 200 < t5.length ? t5.substring(0, 197) + "... (" + t5.length.toString() + " characters)" : t5;
        }, i5.create = function() {
          return new i5();
        }, i5;
      }();
      t4.rC = i4;
    }(Q2 || (Q2 = {})), function(t4) {
      var i4, s4 = Math.PI, n4 = 2 * Math.PI, h3 = Math.PI / 2, r3 = function() {
        function t5() {
        }
        return t5.OO = function(i5, s5) {
          var n5 = new t5();
          return n5.x = i5, n5.y = s5, n5.type = 0, n5.Wh = 0, n5;
        }, t5.cl = function(i5) {
          var s5 = new t5();
          return s5.x = i5.x, s5.y = i5.y, s5.type = 0, s5.Wh = 0, s5;
        }, t5.NO = function(i5) {
          var s5 = new t5();
          return s5.x = i5.x, s5.y = i5.y, s5.type = i5.type, s5.Wh = i5.Wh, s5;
        }, t5.Qd = function(i5, s5, n5) {
          var h4 = new t5();
          return h4.x = i5.x + s5 * Math.cos(n5), h4.y = i5.y + s5 * Math.sin(n5), h4.type = i5.type, h4.Wh = i5.Wh, h4;
        }, t5.Ru = function(i5, s5) {
          var n5 = new t5();
          return n5.x = 0.5 * (i5.x + s5.x), n5.y = 0.5 * (i5.y + s5.y), n5.type = i5.type, n5.Wh = i5.Wh, n5;
        }, t5.OE = function(i5, s5) {
          var n5 = new t5();
          return n5.x = i5.x + 1e-3 * (s5.x - i5.x), n5.y = i5.y + 1e-3 * (s5.y - i5.y), n5.type = i5.type, n5.Wh = i5.Wh, n5;
        }, t5;
      }(), e3 = function() {
      };
      (i4 = t4.aL || (t4.aL = {}))[i4.Round = 0] = "Round", i4[i4.Bevel = 1] = "Bevel", i4[i4.Miter = 2] = "Miter", i4[i4.Square = 3] = "Square";
      var o3 = function() {
        function i5(t5) {
          this.IA = this.Zb = this.xg = null, this.od = t5;
        }
        return i5.W = function(s5, n5, h4, r4, e4, o4) {
          if (s5 == null)
            throw t4.i.O();
          if (1 > s5.Eb())
            throw t4.i.O();
          return n5 == 0 || s5.B() ? s5 : ((o4 = new i5(o4)).mo = s5, o4.La = n5, o4.ra = e4, o4.Mi = h4, o4.xA = r4, o4.Qx());
        }, i5.prototype.$L = function() {
          var i6 = this.mo, s5 = i6.bc(), n5 = i6.xc(), h4 = new t4.h();
          return h4.vc(n5, s5), h4.normalize(), h4.Jv(), h4.scale(this.La), s5.add(h4), n5.add(h4), h4 = i6.Ja(), i6.Ec(s5), i6.Rc(n5), h4;
        }, i5.prototype.ZL = function() {
          var i6 = this.mo;
          if (0 < this.La && this.Mi != 2) {
            var s5 = new t4.Ea();
            return s5.bd(i6, false), this.mo = s5, this.Qx();
          }
          return (i6 = new t4.Hh(i6.aa)).X(this.La, this.La), i6;
        }, i5.prototype.oJ = function(t5, i6, s5, n5) {
          return (i6.x - t5.x) * (n5.x - s5.x) + (i6.y - t5.y) * (n5.y - s5.y);
        }, i5.prototype.hc = function(t5, i6) {
          if (i6 === void 0)
            this.Zb.push(t5), this.gf++;
          else if (this.gf == 0)
            this.hc(t5);
          else {
            var s5 = this.Dw, n5 = this.xg[i6 == 0 ? s5 - 1 : i6 - 1], e4 = this.xg[i6], o4 = this.oJ(n5, e4, this.Zb[this.gf - 1], t5);
            0 < o4 ? this.hc(t5) : 0 > o4 && (0 < this.oJ(n5, e4, e4, this.Zb[this.gf - 1]) ? (e4 = this.xg[i6 == 0 ? s5 - 2 : i6 == 1 ? s5 - 1 : i6 - 2], s5 = r3.Qd(n5, this.La, Math.atan2(n5.y - e4.y, n5.x - e4.x) - h3), this.Zb[this.gf - 1] = s5, this.Mi == 1 || this.Mi == 2 ? (s5 = r3.Ru(s5, n5), this.hc(s5), s5 = r3.Qd(n5, this.La, this.Lv + h3), (n5 = r3.Ru(s5, n5)).type |= 256, this.hc(n5)) : (s5 = r3.Qd(n5, this.La, this.Lv + h3)).type |= 256, this.hc(s5), this.hc(t5, i6)) : (s5 = r3.Qd(e4, this.La, this.Lv + h3), this.hc(s5), this.Mi == 1 || this.Mi == 2 ? (s5 = r3.Ru(s5, e4), this.hc(s5), s5 = r3.Qd(e4, this.La, this.Wz - h3), (n5 = r3.Ru(s5, e4)).type |= 256, this.hc(n5)) : (s5 = r3.Qd(e4, this.La, this.Wz - h3)).type |= 256, this.hc(s5)));
          }
        }, i5.prototype.hE = function() {
          var i6, e4 = this.Dw;
          this.gf = 0;
          var o4 = 0.5 * this.ra, a3 = 0, u3 = 0;
          for (i6 = 0; i6 < e4; i6++) {
            var f3 = this.xg[i6], c3 = i6 == 0 ? this.xg[e4 - 1] : this.xg[i6 - 1], l3 = i6 == e4 - 1 ? this.xg[0] : this.xg[i6 + 1], p3 = c3.x - f3.x, v3 = c3.y - f3.y, y3 = l3.x - f3.x, b3 = l3.y - f3.y, d3 = Math.atan2(v3, p3), g3 = Math.atan2(b3, y3);
            if (this.Lv = d3, this.Wz = g3, i6 == 0 && (a3 = d3, u3 = g3), p3 = p3 * b3 - y3 * v3, v3 = g3, g3 < d3 && (g3 += n4), 0 < p3 * this.La)
              this.Mi == 1 || this.Mi == 2 ? (d3 = r3.Qd(f3, this.La, d3 + h3), this.hc(d3), d3 = r3.OE(f3, d3), this.hc(d3), d3 = r3.Qd(f3, this.La, g3 - h3), (f3 = r3.OE(f3, d3)).type |= 256, this.hc(f3), this.hc(d3)) : (p3 = 0.5 * (g3 - d3), p3 = this.La / Math.abs(Math.sin(p3)), d3 = r3.Qd(f3, p3, 0.5 * (d3 + g3)), this.hc(d3, i6));
            else if ((512 & f3.type) != 0) {
              for (p3 = 1 - o4 / Math.abs(this.La), c3 = 1, l3 = 0 > this.La ? -s4 : s4, -1 < p3 && 1 > p3 && (0.017453292519943295 > (v3 = 2 * Math.acos(p3)) && (v3 = 0.017453292519943295), 1 < (c3 = t4.P.truncate(s4 / v3 + 1.5)) && (l3 /= c3)), v3 = d3 + h3, d3 = r3.Qd(f3, this.La, v3), i6 == 0 && (d3.type |= 1024), this.hc(d3, i6), p3 = this.La / Math.cos(l3 / 2), v3 += l3 / 2, (d3 = r3.Qd(f3, p3, v3)).type |= 1024, this.hc(d3); 0 < --c3; )
                v3 += l3, (d3 = r3.Qd(f3, p3, v3)).type |= 1024, this.hc(d3);
              (d3 = r3.Qd(f3, this.La, g3 - h3)).type |= 1024, this.hc(d3);
            } else if (this.Mi == 1)
              d3 = r3.Qd(f3, this.La, d3 + h3), this.hc(d3, i6), d3 = r3.Qd(f3, this.La, g3 - h3), this.hc(d3);
            else if (this.Mi == 0)
              for (p3 = 1 - o4 / Math.abs(this.La), c3 = 1, l3 = g3 - h3 - (d3 + h3), -1 < p3 && 1 > p3 && (0.017453292519943295 > (v3 = 2 * Math.acos(p3)) && (v3 = 0.017453292519943295), 1 < (c3 = t4.P.truncate(Math.abs(l3) / v3 + 1.5)) && (l3 /= c3)), p3 = this.La / Math.cos(0.5 * l3), v3 = d3 + h3 + 0.5 * l3, d3 = r3.Qd(f3, p3, v3), this.hc(d3, i6); 0 < --c3; )
                v3 += l3, d3 = r3.Qd(f3, p3, v3), this.hc(d3);
            else
              this.Mi == 2 ? (p3 = c3.x - f3.x, v3 = c3.y - f3.y, 0.99999999 < (c3 = (p3 * (y3 = l3.x - f3.x) + v3 * (b3 = l3.y - f3.y)) / Math.sqrt(p3 * p3 + v3 * v3) / Math.sqrt(y3 * y3 + b3 * b3)) ? (d3 = r3.Qd(f3, 1.4142135623730951 * this.La, g3 - 0.25 * s4), this.hc(d3, i6), d3 = r3.Qd(f3, 1.4142135623730951 * this.La, g3 + 0.25 * s4), this.hc(d3)) : (c3 = Math.abs(this.La / Math.sin(0.5 * Math.acos(c3)))) > (l3 = Math.abs(this.xA * this.La)) ? (p3 = 0.5 * (g3 - d3), p3 = this.La / Math.abs(Math.sin(p3)), d3 = r3.Qd(f3, p3, 0.5 * (d3 + g3)), g3 = t4.h.construct(d3.x, d3.y), d3 = t4.h.construct(f3.x, f3.y), (f3 = new t4.h()).vc(g3, d3), (g3 = new t4.h()).BW(l3 / f3.length(), f3, d3), d3 = (c3 - l3) * Math.abs(this.La) / Math.sqrt(c3 * c3 - this.La * this.La), 0 < this.La ? f3.Jv() : f3.cr(), f3.scale(d3 / f3.length()), (d3 = new t4.h()).add(g3, f3), (c3 = new t4.h()).vc(g3, f3), d3 = r3.cl(d3), this.hc(d3, i6), d3 = r3.cl(c3), this.hc(d3)) : (p3 = 0.5 * (g3 - d3), p3 = this.La / Math.abs(Math.sin(p3)), d3 = r3.Qd(f3, p3, 0.5 * (d3 + g3)), this.hc(d3, i6))) : (g3 = v3, 0 < this.La ? (g3 > d3 && (g3 -= n4), c3 = d3 - g3 < h3) : (g3 < d3 && (g3 += n4), c3 = g3 - d3 < h3), c3 ? (v3 = 0 > (p3 = 1.4142135623730951 * this.La) ? d3 + 0.25 * s4 : d3 + 0.75 * s4, d3 = r3.Qd(f3, p3, v3), this.hc(d3, i6), v3 = 0 > p3 ? g3 - 0.25 * s4 : g3 - 0.75 * s4, d3 = r3.Qd(f3, p3, v3), this.hc(d3)) : (p3 = 0.5 * (g3 - d3), p3 = this.La / Math.abs(Math.sin(p3)), g3 < d3 && (g3 += n4), d3 = r3.Qd(f3, p3, (d3 + g3) / 2), this.hc(d3, i6)));
          }
          return this.Lv = a3, this.Wz = u3, this.hc(this.Zb[0], 0), f3 = r3.NO(this.Zb[this.gf - 1]), this.Zb[0] = f3, this.rW();
        }, i5.prototype.Cu = function(i6, s5) {
          if (!(2 > s5))
            for (var n5 = 0; n5 < s5; n5++) {
              var h4 = this.Zb[i6 + n5];
              n5 != 0 ? this.IA.Ei(t4.h.construct(h4.x, h4.y)) : this.IA.Nt(t4.h.construct(h4.x, h4.y));
            }
        }, i5.prototype.aM = function(t5, i6, s5) {
          var n5 = t5.Ca(i6), h4 = t5.Wc(i6);
          if (this.Zb = [], this.IA = s5, t5.ec(i6)) {
            for (i6 = t5.Oa(n5); t5.Oa(h4 - 1).rb(i6); )
              h4--;
            if (2 <= h4 - n5) {
              for (this.Dw = h4 - n5, this.xg = [], i6 = n5; i6 < h4; i6++)
                this.xg.push(r3.cl(t5.Oa(i6)));
              this.hE() && this.Cu(0, this.gf - 1);
            }
          } else {
            for (i6 = t5.Oa(n5); n5 < h4 && t5.Oa(n5 + 1).rb(i6); )
              n5++;
            for (i6 = t5.Oa(h4 - 1); n5 < h4 && t5.Oa(h4 - 2).rb(i6); )
              h4--;
            if (2 <= h4 - n5) {
              for (this.Dw = 2 * (h4 - n5) - 2, this.xg = [], (s5 = r3.cl(t5.Oa(n5))).type |= 1536, this.xg.push(s5), i6 = n5 + 1; i6 < h4 - 1; i6++)
                s5 = r3.cl(t5.Oa(i6)), this.xg.push(s5);
              for ((s5 = r3.cl(t5.Oa(h4 - 1))).type |= 512, this.xg.push(s5), i6 = h4 - 2; i6 >= n5 + 1; i6--)
                (s5 = r3.cl(t5.Oa(i6))).type |= 1024, this.xg.push(s5);
              if (this.hE())
                if (2 <= this.Zb.length) {
                  for (t5 = -1, (h4 = (1024 & this.Zb[this.gf - 1].type) != 0) || (t5 = 0), i6 = 1; i6 < this.gf; i6++)
                    (n5 = (1024 & this.Zb[i6].type) != 0) ? h4 || 1 < (h4 = i6 - 1) - t5 + 1 && this.Cu(t5, h4 - t5 + 1) : h4 && (t5 = i6 - 1), h4 = n5;
                  h4 || 1 < (h4 = this.gf - 1) - t5 + 1 && this.Cu(t5, h4 - t5 + 1);
                } else
                  t5 = 0, h4 = this.gf - 1, 0 <= t5 && 1 <= h4 - t5 && this.Cu(t5, h4 - t5 + 1);
            }
          }
          this.xg = null, this.Dw = 0, this.Zb = null, this.gf = 0;
        }, i5.prototype.rW = function() {
          for (var t5 = false, i6 = 0; i6 < this.gf; i6++) {
            var s5 = this.Zb[i6];
            s5.sh = i6 + 1, s5.uh = i6 - 1, this.Zb[i6] = s5;
          }
          for ((s5 = this.Zb[0]).uh = this.gf - 2, this.Zb[0] = s5, (s5 = this.Zb[this.gf - 2]).sh = 0, this.Zb[this.gf - 2] = s5, i6 = s5 = 0; i6 < this.gf; i6++)
            if ((256 & this.Zb[s5].type) != 0) {
              var n5 = this.BP(s5);
              if (n5 == -1) {
                t5 = true;
                break;
              }
              s5 = n5;
            } else
              s5 = this.Zb[s5].sh;
          return !t5 && (this.LO(s5), true);
        }, i5.prototype.BP = function(t5) {
          for (var i6, s5, n5 = this.gf - 1, h4 = t5, r4 = 1; r4 <= n5 - 2; r4++) {
            i6 = h4 = this.Zb[h4].sh, s5 = t5;
            for (var e4 = 1; e4 <= r4; e4++) {
              if (s5 = this.Zb[s5].uh, (256 & this.Zb[s5].type) == 0 && (256 & this.Zb[i6].type) == 0) {
                var o4 = this.bS(s5, i6);
                if (o4 != -1)
                  return o4;
              }
              i6 = this.Zb[i6].uh;
            }
          }
          return -1;
        }, i5.prototype.bS = function(i6, s5) {
          var n5 = this.Zb[this.Zb[i6].uh], h4 = this.Zb[i6], r4 = this.Zb[this.Zb[s5].uh], o4 = this.Zb[s5];
          if (!this.EW(n5, h4, r4, o4))
            return -1;
          var a3 = new e3();
          return this.sQ(n5, h4, r4, o4, a3) && !a3.XD && t4.P.XJ((h4.x - n5.x) * (o4.y - r4.y) - (h4.y - n5.y) * (o4.x - r4.x)) != t4.P.XJ(this.La) ? (n5 = this.Zb[i6].uh, a3.cn.type = h4.type, a3.cn.sh = s5, a3.cn.uh = n5, this.Zb[i6] = a3.cn, a3.cn = this.Zb[s5], a3.cn.uh = i6, this.Zb[s5] = a3.cn, s5) : -1;
        }, i5.prototype.EW = function(t5, i6, s5, n5) {
          return Math.max(t5.x, i6.x) >= Math.min(s5.x, n5.x) && Math.max(s5.x, n5.x) >= Math.min(t5.x, i6.x) && Math.max(t5.y, i6.y) >= Math.min(s5.y, n5.y) && Math.max(s5.y, n5.y) >= Math.min(t5.y, i6.y);
        }, i5.prototype.sQ = function(t5, i6, s5, n5, h4) {
          h4.XD = false;
          var e4 = (i6.y - t5.y) * (n5.x - s5.x) - (i6.x - t5.x) * (n5.y - s5.y), o4 = (s5.y - t5.y) * (i6.x - t5.x) - (s5.x - t5.x) * (i6.y - t5.y);
          if (0 <= (e4 = e4 == 0 ? 2 : o4 / e4) && 1 >= e4) {
            var a3 = e4;
            if (e4 = (n5.y - s5.y) * (i6.x - t5.x) - (n5.x - s5.x) * (i6.y - t5.y), o4 = (t5.y - s5.y) * (n5.x - s5.x) - (t5.x - s5.x) * (n5.y - s5.y), 0 <= (e4 = e4 == 0 ? 2 : o4 / e4) && 1 >= e4)
              return h4.cn = r3.OO(t5.x + e4 * (i6.x - t5.x), t5.y + e4 * (i6.y - t5.y)), h4.cn.Wh = s5.Wh + a3 * (n5.Wh - s5.Wh), a3 != 0 && a3 != 1 || e4 != 0 && e4 != 1 || (h4.XD = true), h4.RY = e4, h4.SY = a3, !((a3 == 0 || a3 == 1) && 0 < e4 && 1 > e4 || (e4 == 0 || e4 == 1) && 0 < a3 && 1 > a3);
          }
          return false;
        }, i5.prototype.LO = function(t5) {
          for (; this.Zb[t5].uh < t5; )
            t5 = this.Zb[t5].uh;
          var i6 = 0, s5 = t5;
          do {
            s5 = this.Zb[s5], this.Zb[i6] = s5, s5 = s5.sh, i6++;
          } while (s5 != t5);
          this.Zb[i6] = this.Zb[0], this.gf = i6 + 1;
        }, i5.prototype.VC = function(t5) {
          var i6 = this.mo, s5 = i6.Ha();
          if (s5 != null) {
            s5.aj();
            for (var n5 = -1; s5.ab(); )
              n5++, this.aM(i6, n5, t5);
          }
        }, i5.prototype.Qx = function() {
          var i6 = this.mo.K();
          return i6 == 322 ? this.$L() : i6 == 197 ? this.ZL() : t4.ba.zd(i6) ? ((i6 = new t4.Ua()).pc(this.mo, true), this.mo = i6, this.Qx()) : i6 == 1607 ? (i6 = new t4.Ua(), this.VC(i6), i6) : i6 == 1736 ? (i6 = new t4.Ea(), this.VC(i6), i6) : null;
        }, i5;
      }();
      t4.DK = o3;
    }(Q2 || (Q2 = {})), function(t4) {
      var i4 = function() {
        function t5(t6) {
          this.sk = t6;
        }
        return t5.prototype.D = function(t6, i5) {
          this.sk.g.D(t6, i5);
        }, t5.prototype.wd = function(t6) {
          var i5 = this.sk.Ga.ka(t6);
          this.sk.Ga.wd(t6, -1), this.sk.g.qd(i5, false);
        }, t5;
      }(), s4 = function() {
        function t5(t6) {
          this.sk = t6;
        }
        return t5.prototype.D = function(t6, i5) {
          this.sk.DT.D(t6, i5);
        }, t5.prototype.wd = function(t6) {
          this.sk.Ga.wd(t6, -1);
        }, t5;
      }(), n4 = function() {
        function t5(t6) {
          this.sk = t6;
        }
        return t5.prototype.D = function(t6, i5) {
          i5.N(this.sk.GT[t6]);
        }, t5.prototype.wd = function(t6) {
          this.sk.Ga.wd(t6, -1);
        }, t5;
      }(), h3 = function() {
        function h4(h5) {
          h5 === void 0 ? (this.Ga = new t4.$j(), this.Ga.Ee(20), this.g = new t4.hd(), this.sT = this.g.Kg(550), this.Us = this.g.wf(this.sT, -1), this.Zh = new i4(this)) : h5 instanceof Array ? (this.Ga = new t4.$j(), this.Ga.Ee(20), this.GT = h5, this.Zh = new n4(this)) : (this.Ga = new t4.$j(), this.Ga.Ee(20), this.DT = h5, this.Zh = new s4(this));
        }
        return h4.prototype.Ib = function(i5) {
          var s5 = i5.K();
          if (t4.Fx.zj(s5))
            this.eN(i5);
          else if (t4.Xk.zd(s5))
            this.jN(i5);
          else if (s5 == 197)
            this.bN(i5);
          else {
            if (s5 != 33)
              throw t4.i.O("invalid shape type");
            this.iN(i5);
          }
        }, h4.prototype.YQ = function() {
          var i5 = new t4.Ta(), s5 = this.Ga.sc(-1), n5 = new t4.Ea(this.g.it);
          for (this.g.Xi(this.Ga.ka(s5), i5), n5.nf(i5), s5 = this.Ga.lb(s5); s5 != -1; s5 = this.Ga.lb(s5))
            this.g.Xi(this.Ga.ka(s5), i5), n5.lineTo(i5);
          return n5;
        }, h4.MO = function(i5) {
          var s5 = new h4(i5), n5 = i5.I(), r3 = 1, e3 = new t4.h(), o3 = new t4.h(), a3 = new t4.h();
          for (i5.D(0, e3); i5.D(r3, o3), o3.Mz(e3) && r3 < n5 - 1; )
            r3++;
          for (s5.Ga.addElement(0, -1), s5.Ga.zn(r3), n5 = r3 + 1; n5 < i5.I(); n5++)
            i5.D(n5, a3), (r3 = s5.kC(a3)) != -1 && s5.Ga.Uj(r3, n5);
          for (a3 = new t4.Ta(), r3 = s5.Ga.sc(-1), n5 = new t4.Ea(i5.description), i5.we(s5.Ga.ka(r3), a3), n5.nf(a3), r3 = s5.Ga.lb(r3); r3 != -1; r3 = s5.Ga.lb(r3))
            i5.we(s5.Ga.ka(r3), a3), n5.lineTo(a3);
          return n5;
        }, h4.construct = function(t5, i5, s5) {
          for (var n5 = new h4(t5), r3 = 1, e3 = t5[0]; t5[r3].Mz(e3) && r3 < i5 - 1; )
            r3++;
          for (n5.Ga.addElement(0, -1), n5.Ga.zn(r3), r3 += 1; r3 < i5; r3++)
            (e3 = n5.kC(t5[r3])) != -1 && n5.Ga.Uj(e3, r3);
          for (t5 = 0, i5 = n5.Ga.sc(-1); i5 != -1; i5 = n5.Ga.lb(i5))
            s5[t5++] = n5.Ga.ka(i5);
          return t5;
        }, h4.EG = function(i5, s5) {
          var n5 = i5.Ca(s5), r3 = i5.Wc(s5);
          if (s5 = !i5.ec(s5) && i5.Pn(s5), i5 = i5.vb(0), r3 *= 2, s5 && (r3 -= 2), 6 > r3 - (n5 *= 2))
            return true;
          s5 = new t4.h();
          var e3 = new t4.h(), o3 = new t4.h();
          i5.uc(n5, s5), i5.uc(n5 + 2, e3), i5.uc(n5 + 4, o3);
          var a3 = h4.Yu(e3, o3, s5);
          if (a3.rs() || !h4.wm(a3.value()))
            return false;
          var u3 = t4.h.construct(e3.x, e3.y), f3 = new t4.h();
          for (n5 += 6; n5 < r3; n5 += 2) {
            if (f3.N(e3), e3.N(o3), i5.uc(n5, o3), (a3 = h4.Yu(e3, o3, s5)).rs() || !h4.wm(a3.value()))
              return false;
            if ((a3 = h4.Yu(u3, o3, s5)).rs() || !h4.wm(a3.value()))
              return false;
            if ((a3 = h4.Yu(e3, o3, f3)).rs() || !h4.wm(a3.value()))
              return false;
          }
          return true;
        }, h4.prototype.eN = function(i5) {
          for (var s5 = new t4.Ta(), n5 = new t4.h(), h5 = 0; h5 < i5.I(); h5++) {
            i5.D(h5, n5);
            var r3 = this.Er(n5);
            if (r3 != -1) {
              i5.we(h5, s5);
              var e3 = this.g.hc(this.Us, s5);
              this.Ga.Uj(r3, e3);
            }
          }
        }, h4.prototype.bN = function(i5) {
          for (var s5 = new t4.Ta(), n5 = new t4.h(), h5 = 0; 4 > h5; h5++) {
            i5.hB(h5, n5);
            var r3 = this.Er(n5);
            if (r3 != -1) {
              i5.If(h5, s5);
              var e3 = this.g.hc(this.Us, s5);
              this.Ga.Uj(r3, e3);
            }
          }
        }, h4.prototype.jN = function(i5) {
          var s5 = new t4.Ta(), n5 = i5.bc();
          if ((n5 = this.Er(n5)) != -1) {
            i5.Vo(s5);
            var h5 = this.g.hc(this.Us, s5);
            this.Ga.Uj(n5, h5);
          }
          n5 = i5.xc(), (n5 = this.Er(n5)) != -1 && (i5.Ro(s5), i5 = this.g.hc(this.Us, s5), this.Ga.Uj(n5, i5));
        }, h4.prototype.iN = function(t5) {
          var i5 = t5.D();
          (i5 = this.Er(i5)) != -1 && (t5 = this.g.hc(this.Us, t5), this.Ga.Uj(i5, t5));
        }, h4.prototype.Er = function(t5) {
          var i5 = -1;
          if (this.Ga.size(-1) == 0)
            return this.Ga.addElement(-4, -1);
          if (this.Ga.size(-1) == 1) {
            var s5 = this.g.Oa(this.Ga.ka(this.Ga.sc(-1)));
            return t5.Mz(s5) || (i5 = this.Ga.zn(-5)), i5;
          }
          return this.kC(t5);
        }, h4.prototype.kC = function(i5) {
          var s5 = -1;
          do {
            var n5 = this.Ga.sc(-1), r3 = this.Ga.Gc(-1), e3 = this.Ga.ka(n5), o3 = this.Ga.ka(r3), a3 = new t4.h(), u3 = new t4.h();
            if (this.Zh.D(e3, a3), this.Zh.D(o3, u3), e3 = t4.h.Wq(u3, i5, a3), h4.wm(e3))
              s5 = this.Ga.zn(-1), (a3 = this.iC(i5, r3, n5)) != n5 && this.jC(i5, n5, this.Ga.xe(a3));
            else if (h4.xG(e3)) {
              u3 = this.Ga.uv(-1);
              var f3 = this.Ga.sc(-1), c3 = this.Ga.Gc(-1);
              for (e3 = new t4.h(), o3 = new t4.h(); f3 != this.Ga.xe(c3); ) {
                var l3 = this.Ga.ka(u3);
                this.Zh.D(l3, e3), l3 = t4.h.Wq(e3, i5, a3), h4.xG(l3) ? (c3 = u3, u3 = this.Ga.nl(u3)) : (f3 = u3, u3 = this.Ga.Zp(u3));
              }
              if (u3 = c3, a3 = f3, l3 = this.Ga.ka(u3), f3 = this.Ga.ka(a3), this.Zh.D(l3, e3), this.Zh.D(f3, o3), a3 != n5 && (e3 = t4.h.Wq(o3, i5, e3), !h4.wm(e3)))
                continue;
              s5 = this.Ga.Bu(a3, u3, -2, false), this.jC(i5, u3, r3), this.iC(i5, a3, n5);
            } else
              this.tb == null && (this.tb = new t4.zb()), this.tb.Ec(u3), this.tb.Rc(a3), 0 > (a3 = this.tb.ge(i5, true)) ? (a3 = this.Ga.xe(r3), this.Ga.wd(r3, -1), s5 = this.Ga.zn(-3), this.iC(i5, a3, n5)) : 1 < a3 && (a3 = this.Ga.lb(n5), this.Ga.wd(n5, -1), s5 = this.Ga.Bu(-1, a3, -3, false), this.jC(i5, a3, r3));
          } while (0);
          return s5;
        }, h4.prototype.jC = function(i5, s5, n5) {
          if (s5 != n5) {
            var r3 = this.Ga.ka(s5), e3 = this.Ga.lb(s5), o3 = new t4.h(), a3 = new t4.h();
            for (this.Zh.D(r3, o3); s5 != n5 && 2 < this.Ga.size(-1) && (this.Zh.D(this.Ga.ka(e3), a3), r3 = t4.h.Wq(a3, i5, o3), !h4.wm(r3)); )
              r3 = s5, s5 = e3, o3.N(a3), e3 = this.Ga.lb(s5), this.Zh.wd(r3);
          }
        }, h4.prototype.iC = function(i5, s5, n5) {
          if (s5 == n5)
            return n5;
          var r3 = this.Ga.ka(s5), e3 = this.Ga.xe(s5), o3 = new t4.h(), a3 = new t4.h();
          for (this.Zh.D(r3, o3); s5 != n5 && 2 < this.Ga.size(-1) && (this.Zh.D(this.Ga.ka(e3), a3), r3 = t4.h.Wq(o3, i5, a3), !h4.wm(r3)); )
            r3 = s5, s5 = e3, o3.N(a3), e3 = this.Ga.xe(s5), this.Zh.wd(r3);
          return s5;
        }, h4.Yu = function(i5, s5, n5) {
          var h5 = new t4.Xb();
          h5.set(s5.x), h5.sub(i5.x);
          var r3 = new t4.Xb();
          r3.set(n5.y), r3.sub(i5.y);
          var e3 = new t4.Xb();
          return e3.set(s5.y), e3.sub(i5.y), (s5 = new t4.Xb()).set(n5.x), s5.sub(i5.x), h5.Bg(r3), e3.Bg(s5), h5.sub(e3), h5;
        }, h4.wm = function(t5) {
          return 0 > t5;
        }, h4.xG = function(t5) {
          return 0 < t5;
        }, h4;
      }();
      t4.au = h3;
    }(Q2 || (Q2 = {})), function(t4) {
      var i4 = function() {
        function i5(t5) {
          this.g = null, this.oH = true, this.od = t5;
        }
        return i5.uU = function(i6, s4, n4) {
          return i6 = t4.ua.Gr(i6), t4.$t.Ev(s4.Ng(), s4.kh(), n4.Ng(), n4.kh(), t4.mc.ox(i6));
        }, i5.xO = function(i6, s4) {
          var n4 = new t4.Ta();
          return t4.$t.RT(i6, s4, n4), n4;
        }, i5.W = function(t5, s4, n4, h3) {
          return (n4 = new i5(n4)).g = t5, n4.ra = s4, n4.oH = h3, n4.zM();
        }, i5.prototype.iM = function(i6) {
          return t4.$t.dQ(this.g, i6);
        }, i5.prototype.nM = function(i6) {
          return t4.bu.W(this.g, i6, this.od);
        }, i5.prototype.zM = function() {
          var i6 = this.ra, s4 = t4.ua.Gr(i6), n4 = 1.00001 * (i6 = t4.ua.mN(i6));
          i6 *= 1.000001;
          for (var h3 = false, r3 = 30 < this.g.gd + 10 ? 1e3 : (this.g.gd + 10) * (this.g.gd + 10), e3 = 0, o3 = this.g.eS(); ; e3++) {
            if (e3 > r3)
              throw t4.i.ga("Internal Error: max number of iterations exceeded");
            var a3 = this.iM(s4);
            if (h3 = h3 || a3, this.oH && (a3 = this.g.Ip(s4, true, false) != 0, h3 = h3 || a3), a3 = false, (e3 == 0 || o3 || t4.bu.fI(true, this.g, i6, null, this.od)) && (a3 = this.nM(n4), h3 = h3 || a3), !a3)
              break;
            t4.op.Bp(this.od);
          }
          return h3;
        }, i5;
      }();
      t4.Vk = i4;
    }(Q2 || (Q2 = {})), function(t4) {
      var i4 = function() {
        function i5(t5) {
          this.ae = this.Nc = null, this.$s = 0, this.Vb = t5, this.Yz = true;
        }
        return i5.prototype.wv = function(t5, i6) {
          var s5 = this.g.cc(t5);
          if (s5 == null) {
            if (!this.g.fd(t5, i6))
              return null;
            s5 = i6;
          }
          return s5;
        }, i5.prototype.Zq = function() {
          var i6;
          i6 === void 0 && (i6 = false), this.$s++, (i6 || (4095 & this.$s) == 0) && (this.$s = 0, t4.op.Bp(this.Vb));
        }, i5.prototype.iP = function() {
          var i6 = this.g.$q(false), s5 = false, n4 = new t4.zb(), h3 = new t4.zb(), r3 = new t4.l();
          r3.Pa();
          var e3 = new t4.l();
          e3.Pa();
          for (var o3 = new t4.Ta(), a3 = new t4.OC(), u3 = i6.next(); u3 != -1; u3 = i6.next()) {
            t4.op.Bp(this.Vb);
            var f3 = null, c3 = false;
            if (!t4.ba.Tn(this.g.jc(i6.ek))) {
              if ((f3 = this.wv(u3, n4)) == null)
                continue;
              if (f3.A(r3), r3.X(this.ra, this.ra), f3.Di(this.ra)) {
                if (!f3.Di(0))
                  continue;
                c3 = true, f3 = null;
              }
            }
            var l3 = this.g.$q(i6), p3 = l3.next();
            for (p3 != -1 && (p3 = l3.next()); p3 != -1; p3 = l3.next()) {
              var v3 = null, y3 = false;
              if (!t4.ba.Tn(this.g.jc(l3.ek))) {
                if ((v3 = this.wv(p3, h3)) == null)
                  continue;
                if (v3.A(e3), v3.Di(this.ra)) {
                  if (!v3.Di(0))
                    continue;
                  y3 = true, v3 = null;
                }
              }
              var b3 = 0, d3 = 0;
              if (f3 != null && v3 != null)
                r3.CG(e3) && (a3.Qo(f3), a3.Qo(v3), a3.Fa(this.ra, false), 0 < (b3 = a3.ql(0)) + (d3 = a3.ql(1)) && (this.g.lr(u3, a3, 0, true), this.g.lr(p3, a3, 1, true)), a3.clear());
              else if (f3 != null) {
                var g3 = new t4.h();
                if (this.g.D(p3, g3), r3.contains(g3)) {
                  if (a3.Qo(f3), this.g.Xi(p3, o3), a3.Fz(this.ra, o3, false), 0 < (b3 = a3.ql(0)))
                    if (this.g.lr(u3, a3, 0, true), y3) {
                      for (y3 = -1, g3 = this.g.V(p3); g3 != -1 && g3 != p3 && (y3 = g3, (v3 = this.wv(g3, h3)) != null && v3.Di(0)); g3 = this.g.V(g3))
                        ;
                      for (g3 = p3; g3 != -1 && (this.g.Fh(g3, a3.Cf), g3 != y3); g3 = this.g.V(g3))
                        ;
                    } else
                      this.g.Fh(p3, a3.Cf);
                  a3.clear();
                }
              } else {
                if (v3 == null)
                  continue;
                if (g3 = new t4.h(), this.g.D(u3, g3), e3.X(this.ra, this.ra), e3.contains(g3)) {
                  if (a3.Qo(v3), this.g.Xi(u3, o3), a3.Fz(this.ra, o3, false), 0 < (d3 = a3.ql(0)))
                    if (this.g.lr(p3, a3, 0, true), c3) {
                      for (y3 = -1, g3 = this.g.V(u3); g3 != -1 && g3 != u3 && (y3 = g3, (v3 = this.wv(g3, h3)) != null && v3.Di(0)); g3 = this.g.V(g3))
                        ;
                      for (g3 = u3; g3 != -1 && (this.g.Fh(g3, a3.Cf), g3 != y3); g3 = this.g.V(g3))
                        ;
                    } else
                      this.g.Fh(u3, a3.Cf);
                  a3.clear();
                }
              }
              if (b3 + d3 != 0) {
                if (b3 != 0) {
                  if ((f3 = this.g.cc(u3)) == null) {
                    if (!this.g.fd(u3, n4))
                      continue;
                    f3 = n4, n4.A(r3);
                  } else
                    f3.A(r3);
                  if (f3.Di(this.ra))
                    break;
                }
                s5 = true;
              }
            }
          }
          return s5;
        }, i5.prototype.jP = function() {
          return this.LU();
        }, i5.prototype.LU = function() {
          return new t4.MC().LX(this.g, this.ra);
        }, i5.prototype.gI = function() {
          var i6 = false;
          this.Nc == null && (this.Nc = new t4.$j());
          var s5 = new t4.ja(0);
          s5.Jb(this.g.gd + 1);
          for (var n4 = this.g.$q(), h3 = n4.next(); h3 != -1; h3 = n4.next())
            s5.add(h3);
          this.g.nx(s5, s5.size), s5.add(-1), n4 = this.g.Hd(), h3 = this.g.Hd(), this.ae = new t4.PC(this.g, this.ra, !this.Yz), this.Nc.Xo(this.ae);
          var r3 = new t4.ja(0), e3 = new t4.ja(0), o3 = 0;
          new t4.h();
          var a3 = this.g.ud;
          this.g.wb.oc();
          for (var u3, f3, c3 = this.g.wb.Aa[0].o, l3 = s5.get(o3++); l3 != -1; ) {
            var p3 = u3 = c3[2 * (f3 = a3.U(l3, 0))], v3 = f3 = c3[2 * f3 + 1];
            do {
              var y3 = a3.U(l3, 2), b3 = a3.U(l3, 1);
              if (y3 != -1) {
                var d3 = a3.U(y3, 0), g3 = c3[2 * d3];
                0 > (v3 < (d3 = c3[2 * d3 + 1]) ? -1 : v3 > d3 ? 1 : p3 < g3 ? -1 : p3 > g3 ? 1 : 0) && (e3.add(l3), e3.add(y3));
              }
              b3 != -1 && (g3 = c3[2 * (d3 = a3.U(b3, 0))], 0 > (v3 < (d3 = c3[2 * d3 + 1]) ? -1 : v3 > d3 ? 1 : p3 < g3 ? -1 : p3 > g3 ? 1 : 0) && (e3.add(b3), e3.add(b3))), (g3 = this.g.Qa(l3, n4)) != -1 && (r3.add(g3), this.g.Sa(l3, n4, -1)), (g3 = this.g.Qa(l3, h3)) != -1 && (r3.add(g3), this.g.Sa(l3, h3, -1)), (l3 = s5.get(o3++)) !== -1 && (p3 = c3[2 * (v3 = a3.U(l3, 0))], v3 = c3[2 * v3 + 1]);
            } while (l3 != -1 && p3 === u3 && v3 === f3);
            for (p3 = r3.size == 1 && e3.size == 2, g3 = v3 = -1, y3 = 0, b3 = r3.size; y3 < b3; y3++) {
              d3 = r3.get(y3);
              var w3 = this.Nc.xe(d3);
              if (w3 == -1 || r3.cG(w3) || (v3 = w3), (d3 = this.Nc.lb(d3)) == -1 || r3.cG(d3) || (g3 = d3), v3 != -1 && g3 != -1)
                break;
            }
            for (this.ae.VJ(f3, u3), y3 = 0, b3 = r3.size; y3 < b3; y3++)
              d3 = r3.get(y3), this.Nc.wd(d3, -1);
            if (r3.clear(false), !p3 && v3 != -1 && g3 != -1 && this.lO(v3, g3)) {
              i6 = true, this.Pi = this.ae.tm();
              break;
            }
            for (y3 = 0, b3 = e3.size; y3 < b3; y3 += 2) {
              if (f3 = e3.get(y3), u3 = e3.get(y3 + 1), p3 ? (f3 = this.Nc.Bu(v3, g3, f3, true), p3 = false) : f3 = this.Nc.addElement(f3, -1), this.ae.sg) {
                this.Pi = this.ae.tm(), i6 = true;
                break;
              }
              this.g.Qa(u3, n4) == -1 ? this.g.Sa(u3, n4, f3) : this.g.Sa(u3, h3, f3);
            }
            if (i6)
              break;
            e3.Dh(0);
          }
          return this.g.Ud(n4), this.g.Ud(h3), i6;
        }, i5.prototype.lO = function(t5, i6) {
          return this.ae.compare(this.Nc, this.Nc.ka(t5), i6), t5 = this.ae.sg, this.ae.Mr(), t5;
        }, i5.tE = function(i6) {
          for (var s5 = i6.md; s5 != -1; s5 = i6.ve(s5))
            if (t4.ba.Ic(i6.jc(s5)))
              return true;
          return false;
        }, i5.aQ = function(t5, s5, n4, h3) {
          return !!i5.tE(t5) && ((s5 = new i5(h3)).g = t5, s5.ra = n4, 15 > t5.gd ? t5 = s5.iP() : s5.jP());
        }, i5.W = function(t5, s5, n4) {
          return i5.aQ(t5, t5.DF(), s5, n4);
        }, i5.fI = function(s5, n4, h3, r3, e3) {
          if (!i5.tE(n4))
            return false;
          var o3 = new i5(e3);
          if (o3.g = n4, o3.ra = h3, o3.Yz = s5, o3.gI())
            return r3 != null && r3.Yt(o3.Pi), true;
          var a3 = new t4.Ed();
          return a3.VB(), n4.Pc(a3), (o3 = new i5(e3)).g = n4, o3.ra = h3, o3.Yz = s5, s5 = o3.gI(), a3.VB(), n4.Pc(a3), !!s5 && (r3 != null && r3.Yt(o3.Pi), true);
        }, i5.Ol = function(t5, i6) {
          return !(16 > (t5 = t5.I())) && 2 * t5 + Math.log(t5) * Math.LOG10E / Math.log(2) * i6 < 1 * t5 * i6;
        }, i5.gP = function(s5, n4, h3, r3) {
          if (t4.ba.Ic(n4.K()))
            return new i5(r3).hP(s5, n4, h3);
          throw t4.i.ga("crack_A_with_B");
        }, i5.prototype.hP = function(n4, h3, r3) {
          var e3 = new t4.l();
          n4.yc(e3);
          var o3 = new t4.l();
          if (h3.yc(o3), o3.X(r3, r3), !o3.isIntersecting(e3))
            return n4;
          var a3 = n4.Cb, u3 = null;
          a3 != null && (u3 = a3.Gb), i5.Ol(n4, n4.I()) && (u3 = t4.ua.lj(n4, o3));
          var f3 = u3 != null ? u3.getIterator() : null, c3 = h3.Ha();
          h3 = n4.Ha();
          var l3 = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0];
          for (o3 = []; c3.ab(); )
            for (; c3.Ia(); ) {
              var p3 = c3.ia();
              if (u3 != null) {
                for (f3.Wo(p3, r3), a3 = f3.next(); a3 != -1; a3 = f3.next())
                  if (this.Zq(), h3.Wb(u3.ka(a3), -1), h3.Ia()) {
                    var v3 = (a3 = h3.ia()).Fa(p3, null, l3, null, r3);
                    for (a3 = 0; a3 < v3; ++a3) {
                      var y3 = l3[a3];
                      if (y3 != 0 && y3 != 1) {
                        var b3 = h3.xb(), d3 = new s4();
                        d3.t = y3, d3.index = b3, o3.push(d3);
                      }
                    }
                  }
              } else {
                var g3 = new t4.l();
                if (p3.yc(g3), g3.X(r3, r3), e3.isIntersecting(g3)) {
                  for (h3.aj(); h3.ab(); )
                    for (; h3.Ia(); )
                      if (this.Zq(), a3 = h3.ia(), y3 = new t4.l(), a3.yc(y3), y3.isIntersecting(g3))
                        for (v3 = a3.Fa(p3, null, l3, null, r3), a3 = 0; a3 < v3; ++a3)
                          (y3 = l3[a3]) != 0 && y3 != 1 && (b3 = h3.xb(), (d3 = new s4()).t = y3, d3.index = b3, o3.push(d3));
                }
              }
            }
          if (o3.length == 0)
            return n4;
          for (o3 = o3.sort(s4.zy), n4 = n4.Ja(), h3.aj(); h3.ab() && !h3.Ia(); )
            ;
          for (r3 = h3.ia(), e3 = new t4.jg(), u3 = -1, a3 = 0, f3 = o3.length; a3 < f3; ) {
            for (l3 = o3[a3].index, c3 = a3 + 1; c3 < f3 && o3[c3].index == l3; )
              ++c3;
            for (; h3.xb() < l3; ) {
              if (this.Zq(), p3 = h3.Ia(), y3 = h3.gb, (g3 = p3 || !h3.Qn() || h3.Rn()) && n4.pc(r3, u3 != y3), u3 = y3, !p3)
                for (; h3.ab() && !h3.Ia(); )
                  ;
              r3 = h3.ia();
            }
            for (l3 = 0; a3 < c3; a3++)
              (y3 = o3[a3].t) != l3 && (r3.dh(l3, y3, e3), l3 = y3, y3 = h3.gb, n4.pc(e3.get(), u3 != y3), u3 = y3);
            if ((g3 = (p3 = h3.Ia()) || !h3.Qn() || h3.Rn()) && (r3.dh(l3, 1, e3), n4.pc(e3.get(), false)), p3)
              r3 = h3.ia();
            else {
              for (; h3.ab() && !h3.Ia(); )
                ;
              r3 = h3.Ia() ? h3.ia() : null;
            }
            a3 = c3;
          }
          for (r3 != null && (y3 = h3.gb, (g3 = (p3 = h3.Ia()) || !h3.Qn() || h3.Rn()) && n4.pc(r3, u3 != y3), u3 = y3), p3 = h3.Ia(); ; ) {
            if (!p3) {
              for (; h3.ab() && !(p3 = h3.Ia()); )
                ;
              if (!p3)
                break;
            }
            r3 = h3.ia(), y3 = h3.gb, (g3 = (p3 = h3.Ia()) || !h3.Qn() || h3.Rn()) && n4.pc(r3, u3 != y3), u3 = y3;
          }
          return n4;
        }, i5;
      }();
      t4.bu = i4;
      var s4 = function() {
        function t5() {
        }
        return t5.zy = function(t6, i5) {
          return t6.index == i5.index ? t6.t > i5.t ? 1 : t6.t < i5.t ? -1 : 0 : t6.index > i5.index ? 1 : -1;
        }, t5;
      }();
    }(Q2 || (Q2 = {})), function(t4) {
      var i4;
      (i4 = t4.FK || (t4.FK = {}))[i4.Left = 0] = "Left", i4[i4.Right = 1] = "Right", i4[i4.Coincident = 2] = "Coincident", i4[i4.Undefined = 3] = "Undefined", i4[i4.Uncut = 4] = "Uncut";
      var s4 = function(t5, i5, s5, n5, h4, r3, e3, o3, a3, u3, f3) {
        this.Y = t5, this.ct = i5, this.Ps = s5, this.ug = n5, this.Nm = u3, this.Cl = f3;
      };
      t4.qY = s4;
      var n4 = function() {
        function i5(t5, i6) {
          this.EH = t5, this.Ji = i6;
        }
        return i5.prototype.lM = function(i6, s5) {
          var n5 = new t4.h();
          this.Ji.D(i6, n5);
          var h4 = new t4.h();
          return this.Ji.D(s5, h4), (n5 = n5.compare(h4)) != 0 ? n5 : (i6 = this.Ji.Qa(i6, this.EH)) < (s5 = this.Ji.Qa(s5, this.EH)) ? -1 : i6 == s5 ? 0 : 1;
        }, i5;
      }(), h3 = function(t5, i5, s5, n5, h4, r3, e3, o3, a3) {
        this.ug = t5, this.Ps = i5, this.JA = s5, this.PH = n5, this.Gi = h4, this.Cl = r3, this.Nm = e3, this.QH = o3, this.JT = a3;
      };
      t4.pY = h3, t4.GK = function() {
        function i5() {
        }
        return i5.EK = function(n5, h4, r3, e3, o3, a3) {
          if (h4.B())
            n5 = new s4(h4, 4, -1, -1, NaN, 4, -1, -1, NaN, -1, -1, NaN, -1, -1, NaN), o3.push(n5);
          else if (r3.B())
            n5 = new s4(h4, 4, -1, -1, NaN, 4, -1, -1, NaN, -1, -1, NaN, -1, -1, NaN), o3.push(n5);
          else {
            var u3 = new t4.hd();
            if (u3.Ib(h4), u3.Ib(r3), t4.Vk.W(u3, e3, a3, true), u3.gd == 0)
              n5 = new s4(h4.Ja(), 4, -1, -1, NaN, 4, -1, -1, NaN, -1, -1, NaN, -1, -1, NaN), o3.push(n5);
            else {
              for (h4 = 0, r3 = u3.Hd(), e3 = u3.md; e3 != -1; e3 = u3.ve(e3))
                for (a3 = u3.Ob(e3); a3 != -1; a3 = u3.Sb(a3))
                  for (var f3 = u3.Ya(a3), c3 = 0, l3 = u3.Ka(a3); c3 < l3; f3 = u3.V(f3), c3++)
                    u3.Sa(f3, r3, h4++);
              h4 = i5.CM(r3, u3), i5.YL(n5, h4, u3, o3);
            }
          }
        }, i5.CM = function(s5, h4) {
          for (var r3 = h4.gd, e3 = new t4.ja(0), o3 = h4.md; o3 != -1; o3 = h4.ve(o3))
            for (var a3 = h4.Ob(o3); a3 != -1; a3 = h4.Sb(a3))
              for (var u3 = h4.Ya(a3), f3 = 0, c3 = h4.Ka(a3); f3 < c3; u3 = h4.V(u3), f3++)
                e3.add(u3);
          var l3 = new n4(s5, h4);
          e3.Wd(0, r3, function(t5, i6) {
            return l3.lM(t5, i6);
          }), s5 = [];
          var p3 = [], v3 = h4.Hd(), y3 = h4.Hd();
          o3 = h4.md, a3 = h4.ve(o3), c3 = new t4.h();
          var b3 = new t4.h(), d3 = e3.get(0), g3 = h4.cd(d3), w3 = h4.Sf(g3);
          h4.D(d3, c3);
          var x3 = 1;
          for (u3 = 0; x3 < r3 - 1; ) {
            var m3 = false;
            for (f3 = x3; f3 < r3; f3++)
              if (f3 != u3) {
                var j3 = e3.get(f3), M3 = h4.cd(j3), k3 = h4.Sf(M3);
                if (h4.D(j3, b3), !c3.rb(b3))
                  break;
                w3 == o3 && k3 == a3 && (m3 = i5.pM(v3, y3, h4, s5, p3, g3, d3, M3, j3));
              }
            if (m3 || u3 == x3 - 1) {
              if (m3 && u3 == x3 - 1 && x3--, ++u3 == r3)
                break;
              d3 = e3.get(u3), g3 = h4.cd(d3), w3 = h4.Sf(g3), h4.D(d3, c3);
            }
            m3 || (x3 = u3 + 1);
          }
          for (r3 = [], o3 = h4.md; o3 != -1; o3 = h4.ve(o3))
            for (a3 = h4.Ob(o3); a3 != -1; a3 = h4.Sb(a3))
              for (e3 = h4.Ya(a3), f3 = 0, c3 = h4.Ka(a3); f3 < c3; e3 = h4.V(e3), f3++) {
                if (0 <= (u3 = h4.Qa(e3, y3)))
                  for (; u3 < p3.length && p3[u3].ug == e3; )
                    r3.push(p3[u3++]);
                if (0 <= (u3 = h4.Qa(e3, v3)))
                  for (; u3 < s5.length && s5[u3].ug == e3; )
                    r3.push(s5[u3++]);
              }
          return h4.Ud(v3), h4.Ud(y3), r3;
        }, i5.pM = function(t5, s5, n5, h4, r3, e3, o3, a3, u3) {
          var f3 = n5.tj(e3), c3 = n5.tj(a3), l3 = n5.Ya(e3), p3 = n5.Ya(a3), v3 = n5.Na(o3), y3 = n5.Na(u3), b3 = false, d3 = false, g3 = false, w3 = false;
          return o3 != l3 && (u3 != p3 && (b3 = i5.qM(t5, n5, h4, e3, v3, a3, y3)), u3 != c3 && (d3 = i5.rM(t5, n5, h4, e3, v3, a3, u3))), o3 != f3 && (u3 != p3 && (g3 = i5.sM(s5, n5, r3, e3, o3, a3, y3, l3)), u3 != c3 && (w3 = i5.tM(s5, n5, r3, e3, o3, a3, u3, l3))), b3 && d3 && g3 ? (t5 = h4.length - 1, r3[w3 ? r3.length - 2 : r3.length - 1].Gi == 2 && (h4[t5 - 1] = h4[t5], --h4.length)) : b3 && d3 && w3 && r3[r3.length - 1].Gi == 2 && (r3 = h4[h4.length - 1], --h4.length, n5.Qa(r3.ug, t5) == h4.length && n5.Sa(r3.ug, t5, -1)), b3 || d3 || g3 || w3;
        }, i5.qM = function(i6, s5, n5, r3, e3, o3, a3) {
          var u3 = new t4.zb(), f3 = new t4.zb(), c3 = [0, 0], l3 = [0, 0], p3 = s5.cc(e3);
          return p3 == null && (s5.fd(e3, u3), p3 = u3), (u3 = s5.cc(a3)) == null && (s5.fd(a3, f3), u3 = f3), 2 > (p3 = p3.Fa(u3, null, c3, l3, 0)) && (r3 = new h3(e3, r3, c3[0], NaN, p3, a3, o3, l3[0], NaN), n5.push(r3), 0 > (r3 = s5.Qa(e3, i6)) && s5.Sa(e3, i6, n5.length - 1)), true;
        }, i5.rM = function(i6, s5, n5, r3, e3, o3, a3) {
          var u3 = new t4.zb(), f3 = new t4.zb(), c3 = [0, 0], l3 = [0, 0], p3 = s5.cc(e3);
          return p3 == null && (s5.fd(e3, u3), p3 = u3), (u3 = s5.cc(a3)) == null && (s5.fd(a3, f3), u3 = f3), 2 > (p3 = p3.Fa(u3, null, c3, l3, 0)) && (r3 = new h3(e3, r3, c3[0], NaN, p3, a3, o3, l3[0], NaN), n5.push(r3), 0 > (r3 = s5.Qa(e3, i6)) && s5.Sa(e3, i6, n5.length - 1), true);
        }, i5.sM = function(i6, s5, n5, r3, e3, o3, a3, u3) {
          var f3 = new t4.zb(), c3 = new t4.zb(), l3 = [0, 0], p3 = [0, 0], v3 = s5.cc(e3);
          return v3 == null && (s5.fd(e3, f3), v3 = f3), (f3 = s5.cc(a3)) == null && (s5.fd(a3, c3), f3 = c3), (v3 = v3.Fa(f3, null, l3, p3, 0)) == 2 ? (r3 = new h3(e3, r3, l3[0], l3[1], v3, a3, o3, p3[0], p3[1]), n5.push(r3), 0 > (r3 = s5.Qa(e3, i6)) && s5.Sa(e3, i6, n5.length - 1), true) : (c3 = false, e3 == u3 && (r3 = new h3(e3, r3, l3[0], NaN, v3, a3, o3, p3[0], NaN), n5.push(r3), 0 > (r3 = s5.Qa(e3, i6)) && s5.Sa(e3, i6, n5.length - 1), c3 = true), c3);
        }, i5.tM = function(i6, s5, n5, r3, e3, o3, a3, u3) {
          var f3 = new t4.zb(), c3 = new t4.zb(), l3 = [0, 0], p3 = [0, 0], v3 = s5.cc(e3);
          return v3 == null && (s5.fd(e3, f3), v3 = f3), (f3 = s5.cc(a3)) == null && (s5.fd(a3, c3), f3 = c3), (v3 = v3.Fa(f3, null, l3, p3, 0)) == 2 ? (r3 = new h3(e3, r3, l3[0], l3[1], v3, a3, o3, p3[0], p3[1]), n5.push(r3), 0 > (r3 = s5.Qa(e3, i6)) && s5.Sa(e3, i6, n5.length - 1), true) : (c3 = false, e3 == u3 && (r3 = new h3(e3, r3, l3[0], NaN, v3, a3, o3, p3[0], NaN), n5.push(r3), 0 > (r3 = s5.Qa(e3, i6)) && s5.Sa(e3, i6, n5.length - 1), c3 = true), c3);
        }, i5.YL = function(n5, h4, r3, e3) {
          var o3 = [];
          o3[0] = new t4.h(), o3[1] = new t4.h(), o3[2] = new t4.h(), o3[3] = new t4.h();
          var a3 = new t4.h(), u3 = new t4.h(), f3 = new t4.h(), c3 = new t4.h(), l3 = null;
          e3 != null && (l3 = new t4.jg()).Qr();
          var p3 = 0, v3 = null, y3 = new t4.zb();
          new t4.zb();
          for (var b3 = r3.Ob(r3.md); b3 != -1; b3 = r3.Sb(b3)) {
            for (var d3 = 4, g3 = -1, w3 = -1, x3 = -1, m3 = -1, j3 = NaN, M3 = true, k3 = false, z3 = true, A3 = true, N3 = true, I3 = 0, P3 = b3, C3 = 0, B3 = r3.Ya(b3), D3 = r3.Ka(b3), q3 = 0; q3 < D3; B3 = r3.V(B3), q3++) {
              var G3 = r3.cc(B3);
              if (G3 == null) {
                if (!r3.fd(B3, y3))
                  continue;
                G3 = y3;
              }
              w3 == -1 && (w3 = B3);
              for (var F3 = 0; p3 < h4.length && B3 == h4[p3].ug; ) {
                g3 = h4[p3].Ps;
                var T3 = h4[p3].ug, E3 = h4[p3].JA, S3 = h4[p3].Nm, O3 = h4[p3].Cl, H3 = h4[p3].QH;
                if (h4[p3].Gi == 2) {
                  if (k3 || (P3 = g3, w3 = T3, C3 = E3, x3 = S3, m3 = O3, j3 = H3, d3 = 2, e3 != null ? v3 = new t4.Ua() : I3 = 0, N3 = false, A3 = true), E3 = h4[p3].PH, H3 = h4[p3].JT, e3 != null ? (G3.dh(F3, h4[p3].PH, l3), v3.pc(l3.get(), A3)) : I3++, F3 = E3, k3 = true, A3 = M3 = false, p3 + 1 == h4.length || h4[p3 + 1].Gi != 2 || h4[p3 + 1].ug == T3 && h4[p3 + 1].JA != F3) {
                    if (e3 != null) {
                      var J3 = new s4(v3, 2, g3, T3, E3, d3, P3, w3, C3, S3, O3, H3, x3, m3, j3);
                      e3.push(J3);
                    } else
                      null.add(I3);
                    P3 = g3, w3 = T3, C3 = E3, x3 = S3, m3 = O3, j3 = H3, d3 = 2, k3 = M3 = false, A3 = N3 = true;
                  }
                } else {
                  var R3 = r3.V(T3);
                  if (p3 < h4.length - 1 && h4[p3 + 1].ug == R3 && h4[p3 + 1].Cl == O3 && h4[p3 + 1].Gi == 2)
                    E3 != F3 && (N3 && (e3 != null ? v3 = new t4.Ua() : I3 = 0), M3 = 0 < p3 && h4[p3 - 1].Ps == g3 ? d3 == 1 ? 0 : d3 == 0 ? 1 : 3 : 3, e3 != null ? (G3.dh(F3, E3, l3), v3.pc(l3.get(), A3), J3 = new s4(v3, M3, g3, T3, E3, d3, P3, w3, C3, S3, O3, H3, x3, m3, j3), e3.push(J3)) : (I3++, null.add(I3)), F3 = E3, P3 = g3, w3 = T3, C3 = E3, x3 = S3, m3 = O3, j3 = H3, d3 = M3, M3 = z3 = false, A3 = N3 = true);
                  else if (!i5.xM(n5, r3, h4, p3, a3, u3)) {
                    i5.uM(r3, h4, p3, b3, B3, f3, c3);
                    var L3 = false;
                    if (R3 = false, J3 = true, !(a3.rb(f3) || u3.rb(f3) || a3.rb(c3) || u3.rb(c3))) {
                      o3[0].N(a3), o3[1].N(u3), o3[2].N(f3), o3[3].N(c3), o3.sort(t4.h.pu);
                      var K3 = o3[0], U3 = o3[1], W3 = o3[2], V3 = o3[3];
                      K3.rb(a3) ? U3.rb(u3) ? n5 ? (R3 = L3 = true, J3 = false) : L3 = false : V3.rb(u3) ? n5 ? J3 = R3 = L3 = true : L3 = false : (L3 = true, J3 = U3.rb(f3)) : U3.rb(a3) ? W3.rb(u3) ? n5 ? (R3 = L3 = true, J3 = false) : L3 = false : K3.rb(u3) ? n5 ? J3 = R3 = L3 = true : L3 = false : (L3 = true, J3 = W3.rb(f3)) : W3.rb(a3) ? V3.rb(u3) ? n5 ? (R3 = L3 = true, J3 = false) : L3 = false : U3.rb(u3) ? n5 ? J3 = R3 = L3 = true : L3 = false : (L3 = true, J3 = V3.rb(f3)) : K3.rb(u3) ? n5 ? (R3 = L3 = true, J3 = false) : L3 = false : W3.rb(u3) ? n5 ? J3 = R3 = L3 = true : L3 = false : (L3 = true, J3 = K3.rb(f3));
                    }
                    L3 && (L3 = B3 == T3, (E3 != F3 || L3 && F3 == 0) && (N3 && (e3 != null ? v3 = new t4.Ua() : I3 = 0), e3 != null ? (G3.dh(F3, E3, l3), v3.pc(l3.get(), A3)) : I3++), J3 ? d3 != 1 ? ((E3 != F3 || L3 && F3 == 0) && (e3 != null ? (J3 = new s4(v3, 1, g3, T3, E3, d3, P3, w3, C3, S3, O3, H3, x3, m3, j3), e3.push(J3)) : null.add(I3)), R3 ? (p3 >= h4.length - 2 || h4[p3 + 2].Ps != g3) && (d3 = 0) : d3 = 1) : ((E3 != F3 || L3 && F3 == 0) && (e3 != null ? (J3 = new s4(v3, 3, g3, T3, E3, d3, P3, w3, C3, S3, O3, H3, x3, m3, j3), e3.push(J3)) : null.add(I3)), d3 = 1) : d3 != 0 ? ((E3 != F3 || L3 && F3 == 0) && (e3 != null ? (J3 = new s4(v3, 0, g3, T3, E3, d3, P3, w3, C3, S3, O3, H3, x3, m3, j3), e3.push(J3)) : null.add(I3)), R3 ? (p3 >= h4.length - 2 || h4[p3 + 2].Ps != g3) && (d3 = 1) : d3 = 0) : ((E3 != F3 || L3 && F3 == 0) && (e3 != null ? (J3 = new s4(v3, 3, g3, T3, E3, d3, P3, w3, C3, S3, O3, H3, x3, m3, j3), e3.push(J3)) : null.add(I3)), d3 = 0), (E3 != F3 || L3 && F3 == 0) && (F3 = E3, P3 = g3, w3 = T3, C3 = E3, x3 = S3, m3 = O3, j3 = H3, M3 = z3 = false, A3 = N3 = true));
                  }
                }
                p3++;
              }
              F3 != 1 && (N3 && (e3 != null ? v3 = new t4.Ua() : I3 = 0), e3 != null ? (G3.dh(F3, 1, l3), v3.pc(l3.get(), A3)) : I3++, A3 = N3 = false, z3 = true);
            }
            z3 && (E3 = 1, T3 = r3.tj(b3), T3 = r3.Na(T3), O3 = S3 = -1, H3 = NaN, M3 ? e3 != null ? (J3 = new s4(v3, 4, g3, T3, E3, d3, P3, w3, C3, S3, O3, H3, x3, m3, j3), e3.push(J3)) : null.add(I3) : (M3 = d3 == 1 ? 0 : d3 == 0 ? 1 : 3, e3 != null ? (J3 = new s4(v3, M3, g3, T3, E3, d3, P3, w3, C3, S3, O3, H3, x3, m3, j3), e3.push(J3)) : null.add(I3)));
          }
        }, i5.xM = function(s5, n5, h4, r3, e3, o3) {
          var a3 = h4[r3].QH;
          if (a3 == 1)
            return i5.vM(s5, n5, h4, r3, e3, o3);
          if (a3 == 0)
            return i5.wM(s5, n5, h4, r3, e3, o3);
          throw t4.i.Ra();
        }, i5.vM = function(i6, s5, n5, h4, r3, e3) {
          var o3 = new t4.zb(), a3 = n5[h4].ug, u3 = n5[h4].Nm, f3 = n5[h4].Cl, c3 = -1, l3 = -1, p3 = -1, v3 = -1;
          if (!i6 && 0 < h4) {
            var y3 = n5[h4 - 1];
            c3 = y3.ug, l3 = y3.Nm, p3 = y3.Cl, v3 = y3.Gi;
          }
          var b3 = -1, d3 = -1, g3 = -1, w3 = -1;
          h4 < n5.length - 1 && (b3 = (y3 = n5[h4 + 1]).ug, d3 = y3.Nm, g3 = y3.Cl, w3 = y3.Gi);
          var x3 = s5.V(a3);
          return y3 = s5.V(f3), i6 ? h4 == n5.length - 1 || b3 != a3 || d3 != u3 || g3 != y3 || w3 == 2 ? ((i6 = s5.cc(f3)) == null && (s5.fd(f3, o3), i6 = o3), e3.N(i6.lg()), r3.nt(e3), e3.normalize(), r3.normalize(), false) : ((i6 = s5.cc(f3)) == null && (s5.fd(f3, o3), i6 = o3), r3.N(i6.lg()), (i6 = s5.cc(y3)) == null && (s5.fd(y3, o3), i6 = o3), e3.N(i6.lg()), r3.Uq(), e3.normalize(), r3.normalize(), false) : 0 < h4 && c3 == a3 && l3 == u3 && p3 == y3 && v3 == 2 || h4 < n5.length - 1 && b3 == x3 && d3 == u3 && g3 == y3 && w3 == 2 ? ((i6 = s5.cc(f3)) == null && (s5.fd(f3, o3), i6 = o3), e3.N(i6.lg()), r3.nt(e3), e3.normalize(), r3.normalize(), false) : !(h4 < n5.length - 1 && b3 == a3 && d3 == u3 && g3 == y3) || ((i6 = s5.cc(f3)) == null && (s5.fd(f3, o3), i6 = o3), r3.N(i6.lg()), (i6 = s5.cc(y3)) == null && (s5.fd(y3, o3), i6 = o3), e3.N(i6.lg()), r3.Uq(), e3.normalize(), r3.normalize(), false);
        }, i5.wM = function(i6, s5, n5, h4, r3, e3) {
          var o3 = new t4.zb(), a3 = n5[h4].ug, u3 = n5[h4].Nm, f3 = n5[h4].Cl, c3 = -1, l3 = -1, p3 = -1, v3 = -1;
          if (!i6 && h4 < n5.length - 1) {
            var y3 = n5[h4 + 1];
            c3 = y3.ug, l3 = y3.Nm, p3 = y3.Cl, v3 = y3.Gi;
          }
          var b3 = -1, d3 = -1, g3 = -1;
          y3 = -1, 0 < h4 && (b3 = (y3 = n5[h4 - 1]).ug, d3 = y3.Nm, g3 = y3.Cl, y3 = y3.Gi);
          var w3 = s5.V(a3), x3 = s5.Na(f3);
          return i6 ? h4 != 0 && b3 == a3 && d3 == u3 && g3 == x3 && y3 != 2 || ((i6 = s5.cc(f3)) == null && (s5.fd(f3, o3), i6 = o3), e3.N(i6.lg()), r3.nt(e3), e3.normalize(), r3.normalize(), false) : !(0 < h4 && b3 == a3 && d3 == u3 && g3 == x3 && y3 == 2 || h4 < n5.length - 1 && c3 == w3 && l3 == u3 && p3 == x3 && v3 == 2) || ((i6 = s5.cc(f3)) == null && (s5.fd(f3, o3), i6 = o3), e3.N(i6.lg()), r3.nt(e3), e3.normalize(), r3.normalize(), false);
        }, i5.uM = function(i6, s5, n5, h4, r3, e3, o3) {
          var a3 = new t4.zb(), u3 = i6.cc(r3);
          if (u3 == null && (i6.fd(r3, a3), u3 = a3), s5 = (n5 = s5[n5]).ug, n5 = n5.JA, r3 = i6.V(s5), n5 == 1)
            e3.N(u3.lg()), r3 != -1 && r3 != i6.tj(h4) ? ((u3 = i6.cc(r3)) == null && (i6.fd(r3, a3), u3 = a3), o3.N(u3.lg()), (u3 = i6.cc(s5)) == null && i6.fd(s5, a3)) : o3.N(e3), e3.Uq(), o3.normalize(), e3.normalize();
          else {
            if (n5 != 0)
              throw t4.i.Ra();
            o3.N(u3.lg()), e3.nt(o3), o3.normalize(), e3.normalize();
          }
        }, i5;
      }();
    }(Q2 || (Q2 = {})), function(t4) {
      var i4;
      (i4 = t4.XL || (t4.XL = {}))[i4.Linear = 0] = "Linear", i4[i4.Angular = 1] = "Angular", i4[i4.Area = 2] = "Area";
      var s4 = function() {
        function i5(t5, i6, s5) {
          this.pd = i6, this.ci = s5, this.qA = t5;
        }
        return i5.prototype.Nb = function(t5) {
          return t5 instanceof i5 && this.ci === t5.ci;
        }, i5.WF = function(t5) {
          return t5.pd !== 0 ? null : t5.qA === -1 ? new i5(-1, 2, t5.ci * t5.ci) : i5.ah(o3[t5.qA]);
        }, i5.ah = function(t5) {
          return (t5 = e3[t5]) === void 0 ? null : t5;
        }, i5.UO = function(t5, s5, n5) {
          var h4 = null;
          if (n5 != null)
            try {
              n5.values[0] === "EPSG" && (h4 = i5.ah(parseInt(n5.values[1])));
            } catch (r4) {
            }
          return h4 === null && (h4 = new i5(-1, t5, s5)), h4;
        }, i5.prototype.Fc = function() {
          return this.qA;
        }, i5.prototype.xF = function(i6) {
          if (i6.pd != this.pd)
            throw t4.i.Hb();
          return this.ci / i6.ci;
        }, i5.Ph = function(t5, i6, s5) {
          return i6.xF(s5) * t5;
        }, i5.SE = function(t5, i6, s5, n5, h4) {
          for (s5 = s5.xF(n5), n5 = 0; n5 < i6; n5++)
            h4[n5] = t5[n5] * s5;
        }, i5;
      }();
      t4.Uc = s4;
      for (var n4 = [109401, 1e4, 109402, 4046.8564224, 109403, 4046.87260987425, 109404, 1, 109405, 0.09290304, 109406, 0.09290341161327487, 109407, 0.09290137299531805, 109408, 3.34450944, 109409, 3429904, 109410, 1.000027193184865, 109411, 404.6872609874253, 109412, 0.04046872609874253, 109413, 2.5899984703195216e6, 109414, 1e6, 109415, 0.8361123569578626, 109416, 404.67838076760535, 109417, 0.04046783807676053, 109418, 0.8361244606523066, 109419, 0.09290271785025629, 109420, 404.68423895571647, 109421, 0.04046842389557164, 109422, 0.83612589696064, 109423, 0.0929028774400711, 109424, 404.6849341289498, 109425, 0.04046849341289498, 109426, 0.836125904805842, 109427, 0.09290287831176021, 109428, 404.68493792602754, 109429, 0.04046849379260275, 109430, 0.09290354800069446, 109431, 0.09290274144751023, 109432, 0.09290207073852812, 109433, 0.09290279616016, 109434, 0.09290273520025, 109435, 0.836124673027592, 109436, 0.836118636646753, 109437, 0.8361251654414399, 109438, 0.83612461680225, 109439, 2589988110336e-6, 109440, 0.09290286332673177, 109441, 0.09290349665192114, 109442, 0.83612736, 109443, 0.8361307045194736, 109444, 404.68564224000005, 109445, 0.04046856422400001, 109446, 0.8361237024040001, 109447, 0.0929026336004445, 109448, 404.683871963536, 109449, 0.0404683871963536, 109450, 0.01, 109451, 1e-4, 109452, 1e-6, 109453, 64516e-8, 109454, 6451625806477421e-19, 109455, 25.292852640000003, 109456, 25.29295381171408, 109457, 3.4345281495040003e6, 109458, 3434290937856e-6, 109459, 2.89612324, 109460, 25e8, 109461, 225e8, 109462, 0.7168473118308245, 109463, 100, 109464, 1244521604938272e-22, 109465, 1e-12, 109466, 1e-18], h3 = [1031, 484813681109536e-23, 9101, 1, 9102, 0.0174532925199433, 9103, 2908882086657216e-19, 9104, 484813681109536e-20, 9105, 0.01570796326794897, 9106, 0.01570796326794897, 9109, 1e-6, 9112, 1570796326794897e-19, 9113, 1570796326794897e-21, 9114, 9817477042468104e-19], r3 = [1025, 1e-3, 109452, 1033, 0.01, 109451, 9001, 1, 109404, 9002, 0.3048, 109405, 9003, 0.3048006096012192, 109406, 9005, 0.3047972654, 109407, 9014, 1.8288, 109408, 9030, 1852, 109409, 9031, 1.0000135965, 109410, 9033, 20.11684023368047, 109411, 9034, 0.2011684023368047, 109412, 9035, 1609.3472186944375, 109413, 9036, 1e3, 109414, 9037, 0.9143917962000001, 109415, 9038, 20.1166195164, 109416, 9039, 0.201166195164, 109417, 9040, 0.9143984146160287, 109418, 9041, 0.304799471538676, 109419, 9042, 20.116765121552632, 109420, 9043, 0.2011676512155263, 109421, 9050, 0.9143992, 109422, 9051, 0.3047997333333333, 109423, 9052, 20.1167824, 109424, 9053, 0.201167824, 109425, 9060, 0.9143992042898124, 109426, 9061, 0.3047997347632708, 109427, 9062, 20.116782494375872, 109428, 9063, 0.2011678249437587, 109429, 9070, 0.3048008333333334, 109430, 9080, 0.3047995102481469, 109431, 9081, 0.30479841, 109432, 9082, 0.3047996, 109433, 9083, 0.3047995, 109434, 9084, 0.9143985307444408, 109435, 9085, 0.91439523, 109436, 9086, 0.9143988, 109437, 9087, 0.9143985, 109438, 9093, 1609.344, 109439, 9094, 0.3047997101815088, 109440, 9095, 0.3048007491, 109441, 9096, 0.9144, 109442, 9097, 20.1168, 109444, 9098, 0.201168, 109445, 9099, 0.914398, 109446, 9300, 0.3047993333333334, 109447, 9301, 20.116756, 109448, 9302, 0.20116756, 109449, 109001, 0.9144, 109442, 109002, 0.9144018288036576, 109443, 109003, 20.1168, 109444, 109004, 0.201168, 109445, 109005, 0.1, 109450, 109006, 0.01, 109451, 109007, 1e-3, 109452, 109008, 0.0254, 109453, 109009, 0.0254000508001016, 109454, 109010, 5.0292, 109455, 109011, 5.029210058420118, 109456, 109012, 1853.248, 109457, 109013, 1853.184, 109458, 109014, 1.7018, 109459, 109015, 0.8466683600033867, 109462, 109016, 3527777777777778e-19, 109464, 109017, 1e-6, 109465, 109018, 1e-9, 109466, 109030, 5e4, 109460, 109031, 15e4, 109461], e3 = [], o3 = [], a3 = 0; a3 < n4.length; a3 += 2)
        e3[n4[a3]] = new s4(n4[a3], 2, n4[a3 + 1]);
      for (n4 = null, a3 = 0; a3 < h3.length; a3 += 2)
        e3[h3[a3]] = new s4(h3[a3], 1, h3[a3 + 1]);
      for (h3 = null, a3 = 0; a3 < r3.length; a3 += 3)
        e3[r3[a3]] = new s4(r3[a3], 0, r3[a3 + 1]), o3[r3[a3]] = r3[a3 + 2];
      r3 = null;
    }(Q2 || (Q2 = {})), function(t4) {
      var i4 = function() {
        function t5() {
          this.yb = this.pb = 0;
        }
        return t5.prototype.set = function(t6, i5) {
          i5 !== void 0 ? (this.pb = t6, this.yb = i5) : typeof t6 == "number" ? (this.pb = t6, this.yb = 0) : (this.pb = t6.pb, this.yb = t6.yb);
        }, t5.prototype.value = function() {
          return this.pb;
        }, t5.prototype.add = function(t6) {
          var i5 = this.pb + t6.pb;
          t6 = this.yb + t6.yb + 2220446049250313e-31 * Math.abs(i5), this.pb = i5, this.yb = t6;
        }, t5.prototype.fN = function() {
          var t6 = this.pb + 1, i5 = this.yb + 2220446049250313e-31 * Math.abs(t6);
          this.pb = t6, this.yb = i5;
        }, t5.prototype.ZM = function(t6, i5) {
          this.pb = t6.pb + i5.pb, this.yb = t6.yb + i5.yb + 2220446049250313e-31 * Math.abs(this.pb);
        }, t5.prototype.sub = function(t6) {
          if (typeof t6 == "number") {
            var i5 = this.pb - t6;
            t6 = this.yb + 2220446049250313e-31 * Math.abs(i5);
          } else
            i5 = this.pb - t6.pb, t6 = this.yb + t6.yb + 2220446049250313e-31 * Math.abs(i5);
          this.pb = i5, this.yb = t6;
        }, t5.prototype.Bg = function(t6) {
          var i5 = this.pb * t6.pb;
          this.yb = this.yb * Math.abs(t6.pb) + t6.yb * Math.abs(this.pb) + this.yb * t6.yb + 2220446049250313e-31 * Math.abs(i5), this.pb = i5;
        }, t5.prototype.Po = function(t6) {
          var i5 = this.pb * t6;
          this.yb = this.yb * Math.abs(t6) + 2220446049250313e-31 * Math.abs(i5), this.pb = i5;
        }, t5.prototype.Ml = function(t6, i5) {
          var s4 = Math.abs(t6.pb) * Math.abs(i5.pb);
          this.yb = t6.yb * Math.abs(i5.pb) + i5.yb * Math.abs(t6.pb) + t6.yb * i5.yb + 2220446049250313e-31 * Math.abs(s4), this.pb = s4;
        }, t5.prototype.lm = function(t6) {
          var i5 = Math.abs(t6.pb), s4 = this.pb / t6.pb, n4 = (this.yb + Math.abs(s4) * t6.yb) / i5;
          t6.yb > 0.01 * i5 && (n4 *= 1 + (1 + (t6 = t6.yb / i5)) * t6), this.pb = s4, this.yb = n4 + 2220446049250313e-31 * Math.abs(s4);
        }, t5.prototype.sqrt = function() {
          if (0 <= this.pb) {
            var t6 = Math.sqrt(this.pb), i5 = this.pb > 10 * this.yb ? 0.5 * this.yb / t6 : this.pb > this.yb ? t6 - Math.sqrt(this.pb - this.yb) : Math.max(t6, Math.sqrt(this.pb + this.yb) - t6);
            i5 += 2220446049250313e-31 * Math.abs(t6);
          } else
            this.pb < -1 * this.yb ? i5 = t6 = NaN : (t6 = 0, i5 = Math.sqrt(this.yb));
          this.pb = t6, this.yb = i5;
        }, t5.prototype.sin = function(t6) {
          var i5 = Math.sin(t6.pb), s4 = Math.cos(t6.pb);
          this.pb = i5, i5 = Math.abs(i5), this.yb = (Math.abs(s4) + 0.5 * i5 * t6.yb) * t6.yb + 2220446049250313e-31 * i5;
        }, t5.prototype.cos = function(t6) {
          var i5 = Math.sin(t6.pb), s4 = Math.cos(t6.pb);
          this.pb = s4, s4 = Math.abs(s4), this.yb = (Math.abs(i5) + 0.5 * s4 * t6.yb) * t6.yb + 2220446049250313e-31 * s4;
        }, t5.prototype.rg = function() {
          return Math.abs(this.pb) <= this.yb;
        }, t5.prototype.rs = function() {
          return this.rg() && this.yb != 0;
        }, t5;
      }();
      t4.Xb = i4;
    }(Q2 || (Q2 = {}));
    var tt2 = new Q2.h(), it2 = new Q2.h(), st2 = new Q2.h(), nt2 = new Q2.h(), ht2 = new Q2.h();
    !function(t4) {
      var i4, s4;
      (s4 = i4 || (i4 = {}))[s4.closedPath = 1] = "closedPath", s4[s4.exteriorPath = 2] = "exteriorPath", s4[s4.ringAreaValid = 4] = "ringAreaValid";
      var n4 = function() {
        function i5(t5, i6, s5, n5, h3, r3, e3) {
          i6 !== void 0 ? (this.ib = t5, this.ek = i6, this.dl = s5, this.ki = n5, this.za = r3, this.cA = e3, this.gw = h3) : (this.ib = t5.ib, this.ek = t5.ek, this.dl = t5.dl, this.ki = t5.ki, this.za = t5.za, this.cA = t5.cA, this.gw = t5.gw), this.XG = true;
        }
        return i5.prototype.next = function() {
          return this.XG ? (this.XG = false, this.ki) : this.ki != -1 ? (this.ki = this.ib.V(this.ki), this.za++, this.ki != -1 && this.ki != this.gw ? this.ki : this.VT()) : -1;
        }, i5.prototype.VT = function() {
          for (this.dl = this.ib.Sb(this.dl), this.za = 0; this.ek != -1; ) {
            for (; this.dl != -1; this.dl = this.ib.Sb(this.dl))
              if (this.gw = this.ki = this.ib.Ya(this.dl), this.ki != -1)
                return this.ki;
            if (this.ek = this.ib.ve(this.ek), this.ek == -1)
              break;
            this.cA && !t4.ba.Ic(this.ib.jc(this.ek)) || (this.dl = this.ib.Ob(this.ek));
          }
          return -1;
        }, i5.vP = function(t5, s5, n5, h3, r3, e3, o3) {
          return new i5(t5, s5, n5, h3, r3, e3, o3);
        }, i5;
      }();
      t4.vY = n4, i4 = function() {
        function i5() {
          this.lo = this.Cm = this.yk = this.dd = this.Ek = this.xo = this.Qi = this.nd = this.di = this.Ug = this.Te = this.Kl = null, this.sw = this.md = -1, this.gd = 0, this.aA = false, this.it = this.jt = this.wb = null;
        }
        return i5.prototype.Uh = function(t5) {
          return this.Te != null ? this.Te[t5] : null;
        }, i5.prototype.Zg = function(t5, i6) {
          if (this.Te == null) {
            if (i6 == null)
              return;
            this.Te = [];
            for (var s5 = 0, n5 = this.wb.I(); s5 < n5; s5++)
              this.Te.push(null);
          }
          this.Te[t5] = i6;
        }, i5.prototype.ep = function(t5, i6) {
          this.nd.T(t5, 1, i6);
        }, i5.prototype.cp = function(t5, i6) {
          this.nd.T(t5, 2, i6);
        }, i5.prototype.QB = function(t5, i6) {
          this.nd.T(t5, 6, i6);
        }, i5.prototype.Up = function(t5) {
          return this.nd.U(t5, 6);
        }, i5.prototype.gx = function(t5, i6) {
          this.nd.T(t5, 7, i6);
        }, i5.prototype.sv = function(t5) {
          return this.nd.U(t5, 0);
        }, i5.prototype.JJ = function(t5, i6) {
          this.dd.T(t5, 1, i6);
        }, i5.prototype.NJ = function(t5, i6) {
          this.dd.T(t5, 0, i6);
        }, i5.prototype.EF = function(t5) {
          return this.dd.U(t5, 7);
        }, i5.prototype.ap = function(t5, i6) {
          this.dd.T(t5, 3, i6);
        }, i5.prototype.bp = function(t5, i6) {
          this.dd.T(t5, 4, i6);
        }, i5.prototype.pU = function(i6) {
          this.dd == null && (this.dd = new t4.ad(8));
          var s5 = this.dd.De();
          return this.dd.T(s5, 2, i6), this.dd.T(s5, 5, 0), this.dd.T(s5, 6, 0), this.dd.T(s5, 7, s5), s5;
        }, i5.prototype.JQ = function(t5) {
          this.dd.kd(t5);
        }, i5.prototype.rU = function(i6) {
          this.nd == null && (this.nd = new t4.ad(8), this.ud = new t4.ad(5), this.Qi = new t4.ce(0), this.xo = new t4.ce(0));
          var s5 = this.nd.De();
          return this.nd.T(s5, 0, s5), this.nd.T(s5, 3, 0), this.nd.T(s5, 6, 0), this.gx(s5, i6), s5 >= this.Qi.size && (i6 = 16 > s5 ? 16 : t4.P.truncate(3 * s5 / 2), this.Qi.resize(i6), this.xo.resize(i6)), this.Qi.set(s5, 0), this.xo.set(s5, 0), s5;
        }, i5.prototype.nF = function(t5) {
          this.nd.kd(t5);
        }, i5.prototype.Qy = function(t5) {
          this.ud.kd(t5), this.gd--;
        }, i5.prototype.jI = function(i6) {
          this.nd == null && (this.nd = new t4.ad(8), this.ud = new t4.ad(5), this.Qi = new t4.ce(0), this.xo = new t4.ce(0));
          var s5 = this.ud.De(), n5 = 0 <= i6 ? i6 : s5;
          if (this.ud.T(s5, 0, n5), 0 > i6) {
            if (n5 >= this.wb.I()) {
              if (i6 = 16 > n5 ? 16 : t4.P.truncate(3 * n5 / 2), this.wb.resize(i6), this.Te != null)
                for (var h3 = 0; h3 < i6; h3++)
                  this.Te.push(null);
              this.Ug != null && this.Ug.resize(i6), this.jt = this.wb.vb(0);
            }
            this.wb.Db(n5, -1e38, -1e38), this.Te != null && (this.Te[n5] = null), this.Ug != null && this.Ug.write(n5, 1);
          }
          return this.ud.T(s5, 4, 2 * n5), this.gd++, s5;
        }, i5.prototype.yj = function(t5, i6, s5) {
          var n5 = i6 != -1 ? this.Na(i6) : this.tj(t5), h3 = n5 != -1 ? this.V(n5) : -1, r3 = this.jI(s5 == null ? this.gd : -1), e3 = this.Va(r3);
          return s5 != null && this.wb.It(e3, s5), this.cj(r3, t5), this.Cc(r3, h3), this.Dc(r3, n5), h3 != -1 && this.Dc(h3, r3), n5 != -1 && this.Cc(n5, r3), s5 = this.ec(t5), n5 = this.Ya(t5), i6 == -1 && this.Yg(t5, r3), i6 == n5 && this.Kf(t5, r3), s5 && h3 == -1 && (this.Cc(r3, r3), this.Dc(r3, r3)), this.Xj(t5, this.Ka(t5) + 1), t5 = this.Sf(t5), this.Vj(t5, this.I(t5) + 1), r3;
        }, i5.prototype.pm = function() {
          return this.lo == null && (this.lo = new t4.Ta(this.wb.description)), this.lo;
        }, i5.prototype.$o = function(t5, i6) {
          this.dd.T(t5, 2, -134217729 & this.dd.U(t5, 2) || (i6 == 1 ? 134217728 : 0));
        }, i5.prototype.Kn = function(t5) {
          return (134217728 & this.dd.U(t5, 2)) != 0 ? 1 : 0;
        }, i5.prototype.cN = function(t5) {
          var i6 = this.Kg(t5.K(), t5.description);
          return t5.K() == 1736 && this.$o(i6, t5.Kn()), this.PD(i6, t5), i6;
        }, i5.prototype.dN = function(t5) {
          var i6 = this.Kg(t5.K(), t5.description);
          return this.QD(i6, t5), i6;
        }, i5.prototype.SV = function(i6, s5) {
          this.nd == null && (this.nd = new t4.ad(8), this.ud = new t4.ad(5), this.Qi = new t4.ce(0), this.xo = new t4.ce(0)), this.nd.Ee(this.nd.Jg + i6), this.ud.Ee(this.ud.Jg + s5), this.Qi.Jb(this.Qi.size + i6), this.xo.Jb(this.xo.size + i6);
        }, i5.prototype.PD = function(i6, s5) {
          this.SV(s5.ea(), s5.I()), this.Kl.Gd(s5, 0, s5.I()), this.jt = this.wb.vb(0);
          for (var n5 = this.Te != null && s5.Se != null, h3 = 0, r3 = s5.ea(); h3 < r3; h3++)
            if (!(2 > s5.Ka(h3))) {
              var e3 = this.wf(i6, -1);
              this.mn(e3, s5.ec(h3));
              for (var o3 = s5.Ca(h3), a3 = s5.Wc(h3); o3 < a3; o3++) {
                var u3 = this.yj(e3, -1, null);
                if (n5)
                  if (u3 = this.Va(u3), (1 & s5.UF(o3)) != 0)
                    this.Zg(u3, null);
                  else {
                    var f3 = new t4.jg();
                    s5.cc(o3, f3, true), this.Zg(u3, f3.get());
                  }
              }
            }
        }, i5.prototype.QD = function(t5, i6) {
          this.Kl.Gd(i6, 0, i6.I()), this.jt = this.wb.vb(0), t5 = this.wf(t5, -1);
          var s5 = 0;
          for (i6 = i6.I(); s5 < i6; s5++)
            this.yj(t5, -1, null);
        }, i5.prototype.JX = function(i6, s5, n5) {
          var h3 = this.V(i6);
          if (h3 == -1)
            throw t4.i.Ra();
          for (var r3 = this.pm(), e3 = this.cd(i6), o3 = 0, a3 = s5.ql(n5); o3 < a3; o3++) {
            var u3 = this.Va(i6), f3 = this.V(i6), c3 = s5.Xp(n5, o3);
            o3 == 0 && (c3.Vo(r3), this.Fh(i6, r3)), c3.K() == 322 ? this.Zg(u3, null) : this.Zg(u3, t4.ba.kg(c3)), c3.Ro(r3), o3 < a3 - 1 ? i6 = this.yj(e3, f3, r3) : this.Fh(h3, r3);
          }
        }, i5.prototype.IX = function(i6, s5, n5) {
          var h3 = this.V(i6);
          if (h3 == -1)
            throw t4.i.Ra();
          for (var r3 = this.pm(), e3 = this.cd(i6), o3 = 0, a3 = s5.ql(n5); o3 < a3; o3++) {
            var u3 = this.Va(i6), f3 = this.V(i6), c3 = s5.Xp(n5, a3 - o3 - 1);
            o3 == 0 && (c3.Ro(r3), this.Fh(i6, r3)), c3.K() == 322 ? this.Zg(u3, null) : this.Zg(u3, t4.ba.kg(c3)), c3.Vo(r3), o3 < a3 - 1 ? i6 = this.yj(e3, f3, r3) : this.Fh(h3, r3);
          }
        }, i5.prototype.DF = function() {
          var i6 = new t4.l();
          i6.Pa();
          for (var s5 = this.$q(), n5 = new t4.h(), h3 = true, r3 = s5.next(); r3 != -1; r3 = s5.next())
            this.D(r3, n5), h3 ? i6.$b(n5.x, n5.y) : i6.Nk(n5.x, n5.y), h3 = false;
          return i6;
        }, i5.prototype.Ib = function(i6) {
          var s5 = i6.K();
          if (t4.ba.Ic(s5))
            return this.cN(i6);
          if (s5 == 550)
            return this.dN(i6);
          throw t4.i.Ra();
        }, i5.prototype.pN = function(i6, s5) {
          var n5 = s5.K();
          if (t4.ba.Ic(n5))
            this.PD(i6, s5);
          else {
            if (n5 != 550)
              throw t4.i.Ra();
            this.QD(i6, s5);
          }
        }, i5.prototype.hN = function(i6, s5) {
          var n5 = this.Kg(1736, i6.description);
          if (2 > i6.Ka(s5))
            return n5;
          this.Kl.Gd(i6, i6.Ca(s5), i6.Wc(s5)), this.jt = this.wb.vb(0);
          var h3 = this.wf(n5, -1);
          this.mn(h3, i6.ec(s5) || true);
          var r3 = this.Te != null && i6.Se != null, e3 = i6.Ca(s5);
          for (s5 = i6.Wc(s5); e3 < s5; e3++) {
            var o3 = this.yj(h3, -1, null);
            if (r3)
              if (o3 = this.Va(o3), (1 & i6.UF(e3)) != 0)
                this.Zg(o3, null);
              else {
                var a3 = new t4.jg();
                i6.cc(e3, a3, true), this.Zg(o3, a3.get());
              }
          }
          return n5;
        }, i5.prototype.Ke = function(i6) {
          var s5 = this.jc(i6), n5 = t4.UK.Kg(s5, this.Kl.description), h3 = this.I(i6);
          if (h3 == 0)
            return n5;
          if (t4.ba.Ic(s5)) {
            s5 = this.ea(i6);
            for (var r3 = t4.Zc.Qh(s5 + 1), e3 = t4.Zc.Or(s5 + 1, 0), o3 = n5.description, a3 = 0, u3 = o3.Ba; a3 < u3; a3++) {
              for (var f3 = o3.ld(a3), c3 = t4.sa.Wa(f3), l3 = t4.Zc.TE(f3, h3), p3 = this.wb.vb(f3), v3 = 0, y3 = 0, b3 = 0, d3 = this.Ob(i6); d3 != -1; d3 = this.Sb(d3)) {
                var g3 = 0;
                this.ec(d3) && (g3 |= 1), this.TS(d3) && (g3 |= 4), g3 != 0 && e3.uJ(y3, g3);
                var w3 = this.Ka(d3);
                if (r3.write(y3++, b3), b3 += w3, f3 == 0) {
                  w3 = p3;
                  var x3 = l3, m3 = new t4.h();
                  for (g3 = this.Ya(d3); v3 < b3; g3 = this.V(g3), v3++) {
                    var j3 = this.Va(g3);
                    w3.uc(2 * j3, m3), x3.Vt(2 * v3, m3);
                  }
                } else
                  for (g3 = this.Ya(d3); v3 < b3; g3 = this.V(g3), v3++)
                    for (j3 = this.Va(g3), x3 = 0; x3 < c3; x3++)
                      m3 = p3.gg(j3 * c3 + x3), l3.rr(v3 * c3 + x3, m3);
              }
              n5.kn(f3, l3), r3.write(s5, h3);
            }
            n5.KJ(e3), n5.LJ(r3), n5.Qc(16777215);
          } else if (s5 == 550) {
            for (o3 = n5.description, n5.resize(h3), a3 = 0, u3 = o3.Ba; a3 < u3; a3++) {
              for (f3 = o3.ld(a3), c3 = t4.sa.Wa(f3), l3 = n5.vb(f3), p3 = this.wb.vb(f3), v3 = 0, d3 = this.Ob(i6), w3 = this.Ka(d3), g3 = this.Ya(d3); v3 < w3; g3 = this.V(g3), v3++)
                for (j3 = this.Va(g3), x3 = 0; x3 < c3; x3++)
                  m3 = p3.gg(j3 * c3 + x3), l3.rr(v3 * c3 + x3, m3);
              n5.kn(f3, l3);
            }
            n5.Qc(16777215);
          }
          return n5;
        }, i5.prototype.wB = function(t5) {
          for (var i6 = this.Ob(t5); i6 != -1; i6 = this.ar(i6))
            ;
          i6 = this.KR(t5);
          var s5 = this.ve(t5);
          i6 != -1 ? this.JJ(i6, s5) : this.md = s5, s5 != -1 ? this.NJ(s5, i6) : this.sw = i6, this.JQ(t5);
        }, i5.prototype.Kg = function(i6, s5) {
          return s5 === void 0 ? this.VE(i6, t4.fe.pg()) : this.VE(i6, s5);
        }, i5.prototype.VE = function(i6, s5) {
          return i6 = this.pU(i6), this.wb == null ? this.wb = this.Kl = new t4.ee(s5) : this.Kl.Ll(s5), this.it = this.Kl.description, this.aA = 1 < this.it.Ba, this.md == -1 ? this.md = i6 : (this.NJ(i6, this.sw), this.JJ(this.sw, i6)), this.sw = i6;
        }, i5.prototype.ve = function(t5) {
          return this.dd.U(t5, 1);
        }, i5.prototype.KR = function(t5) {
          return this.dd.U(t5, 0);
        }, i5.prototype.jc = function(t5) {
          return 2147483647 & this.dd.U(t5, 2);
        }, i5.prototype.CJ = function(i6, s5, n5) {
          s5 = this.yk[s5], (i6 = this.EF(i6)) >= s5.size && s5.resize(Math.max(t4.P.truncate(1.25 * i6), 16), -1), s5.write(i6, n5);
        }, i5.prototype.FF = function(t5, i6) {
          return (t5 = this.EF(t5)) < (i6 = this.yk[i6]).size ? i6.read(t5) : -1;
        }, i5.prototype.WE = function() {
          this.yk == null && (this.yk = []);
          for (var i6 = 0; i6 < this.yk.length; i6++)
            if (this.yk[i6] == null)
              return this.yk[i6] = t4.Zc.Qh(0), i6;
          return this.yk.push(t4.Zc.Qh(0)), this.yk.length - 1;
        }, i5.prototype.sW = function(t5) {
          this.yk[t5] = null;
        }, i5.prototype.Ob = function(t5) {
          return this.dd.U(t5, 3);
        }, i5.prototype.mv = function(t5) {
          return this.dd.U(t5, 4);
        }, i5.prototype.I = function(t5) {
          return this.dd.U(t5, 5);
        }, i5.prototype.ea = function(t5) {
          return this.dd.U(t5, 6);
        }, i5.prototype.Ip = function(i6, s5, n5) {
          for (var h3 = 0, r3 = this.md; r3 != -1; r3 = this.ve(r3)) {
            var e3 = this.jc(r3);
            if (t4.ba.Ic(e3) && (!n5 || e3 == 1736)) {
              e3 = this.jc(r3) == 1736;
              for (var o3 = this.Ob(r3); o3 != -1; ) {
                for (var a3 = 0, u3 = this.Ya(o3); a3 < t4.P.truncate(this.Ka(o3) / 2); ) {
                  var f3 = this.V(u3);
                  if (f3 == -1)
                    break;
                  var c3 = this.Va(u3), l3 = this.Uh(c3);
                  l3 != null ? c3 = l3.Rb() : (l3 = this.Va(f3), c3 = this.wb.Ar(c3, l3)), c3 <= i6 ? (c3 == 0 ? h3 == 0 && (h3 = -1) : h3 = 1, f3 != this.tj(o3) && (this.gC(f3, u3), this.qd(f3, true))) : u3 = this.V(u3), a3++;
                }
                for (a3 = this.Ya(o3), u3 = this.ec(o3) ? a3 : this.tj(o3); 0 < this.Ka(o3); ) {
                  if ((f3 = this.Na(u3)) == -1) {
                    this.qd(u3, true), h3 == 0 && (h3 = -1);
                    break;
                  }
                  var p3 = this.Va(f3);
                  if ((l3 = this.Uh(p3)) != null ? c3 = l3.Rb() : (c3 = this.Va(u3), c3 = this.wb.Ar(c3, p3)), c3 <= i6)
                    c3 == 0 ? h3 == 0 && (h3 = -1) : h3 = 1, this.gC(f3, u3), this.qd(f3, false), a3 == f3 && (a3 = this.Ya(o3));
                  else if ((u3 = this.Na(u3)) == a3)
                    break;
                }
                u3 = this.Ka(o3), s5 && (e3 ? 3 > u3 : 2 > u3) ? (o3 = this.ar(o3), h3 = 0 < u3 ? 1 : h3 == 0 ? -1 : h3) : o3 = this.Sb(o3);
              }
            }
          }
          return h3;
        }, i5.prototype.gC = function(t5, i6) {
          var s5 = this.Va(t5), n5 = this.Va(i6);
          if (this.Ug != null && (s5 = this.Ug.read(s5), this.Ug.write(n5, s5)), this.di != null) {
            for (n5 = 0, s5 = this.di.length; n5 < s5; n5++)
              if (this.di[n5] != null) {
                var h3 = this.Qa(t5, n5);
                h3 != -1 && this.Sa(i6, n5, h3);
              }
          }
        }, i5.prototype.Wl = function(i6, s5, n5) {
          var h3 = 0, r3 = this.V(i6);
          if (r3 == -1)
            throw t4.i.Ra();
          for (var e3 = this.Va(i6), o3 = this.Va(r3), a3 = this.Uh(e3), u3 = a3 == null ? this.wb.Ar(e3, o3) : a3.Rb(), f3 = 0; f3 < n5; f3++) {
            var c3 = s5[f3];
            if (0 < c3 && 1 > c3) {
              var l3 = c3;
              a3 != null && (l3 = 0 < u3 ? a3.Tx(c3) / u3 : 0), this.wb.fD(e3, o3, l3, this.pm());
              var p3 = this.yj(this.cd(i6), r3, this.pm());
              if (h3++, a3 != null) {
                var v3 = a3.fl(0, c3);
                l3 = this.Va(this.Na(p3)), this.Zg(l3, v3), this.mf(p3, v3.xc()), f3 != n5 - 1 && s5[f3 + 1] != 1 || (c3 = a3.fl(c3, 1), this.Zg(l3, c3));
              }
            }
          }
          return h3;
        }, i5.prototype.HX = function(i6, s5, n5) {
          var h3 = 0, r3 = this.V(i6);
          if (r3 == -1)
            throw t4.i.ga("internal error");
          var e3 = this.Va(i6), o3 = this.Va(r3), a3 = this.Uh(e3), u3 = a3 == null ? this.wb.Ar(e3, o3) : a3.Rb(), f3 = 0;
          i6 = this.cd(i6);
          for (var c3 = 0; c3 < n5; c3++) {
            var l3 = s5[c3];
            if (f3 < l3 && 1 > l3) {
              var p3 = l3;
              if (a3 != null && (p3 = 0 < u3 ? a3.Tx(l3) / u3 : 0), this.wb.fD(e3, o3, p3, this.pm()), p3 = this.tS(i6, r3, this.pm()), h3++, a3 != null) {
                f3 = a3.fl(f3, l3);
                var v3 = this.Va(this.Na(p3));
                this.Zg(v3, f3), this.Db(p3, f3.qa, f3.ma), c3 != n5 - 1 && s5[c3 + 1] != 1 || (f3 = a3.fl(l3, 1), p3 = this.Va(p3), this.Zg(p3, f3));
              }
            }
            f3 = l3;
          }
          return h3;
        }, i5.prototype.tS = function(t5, i6, s5) {
          var n5 = i6 != -1 ? this.Na(i6) : this.tj(t5), h3 = n5 != -1 ? this.V(n5) : -1, r3 = this.jI(s5 == null ? this.gd : -1), e3 = this.Va(r3);
          return s5 != null && this.wb.It(e3, s5), this.cj(r3, t5), this.Cc(r3, h3), this.Dc(r3, n5), h3 != -1 && this.Dc(h3, r3), n5 != -1 && this.Cc(n5, r3), s5 = this.ec(t5), n5 = this.Ya(t5), i6 == -1 && this.Yg(t5, r3), i6 == n5 && (s5 && n5 != -1 || this.Kf(t5, r3)), s5 && h3 == -1 && (this.Cc(r3, r3), this.Dc(r3, r3)), this.Xj(t5, this.Ka(t5) + 1), t5 = this.Sf(t5), this.Vj(t5, this.I(t5) + 1), r3;
        }, i5.prototype.pE = function(i6, s5, n5) {
          var h3 = this.Va(s5), r3 = this.Va(n5);
          if (0 > h3 || r3 > this.gd - 1)
            throw t4.i.O("invalid call");
          if (h3 > r3 && !this.ec(i6))
            throw t4.i.O("cannot iterate across an open path");
          for (i6 = 0; s5 != n5; s5 = this.V(s5))
            h3 = this.Va(s5), (r3 = this.Uh(h3)) != null ? i6 += r3.Rb() : (r3 = this.Va(this.V(s5)), i6 += this.wb.Ar(h3, r3));
          return i6;
        }, i5.prototype.Fh = function(t5, i6) {
          var s5 = this.Va(t5);
          this.wb.It(s5, i6), (s5 = this.Uh(s5)) != null && s5.setStart(i6), (t5 = this.Na(t5)) != -1 && (t5 = this.Va(t5), this.Uh(t5) != null && s5.setEnd(i6));
        }, i5.prototype.Xi = function(t5, i6) {
          t5 = this.Va(t5), this.wb.we(t5, i6);
        }, i5.prototype.mf = function(t5, i6) {
          this.Db(t5, i6.x, i6.y);
        }, i5.prototype.Db = function(t5, i6, s5) {
          var n5 = this.Va(t5);
          this.wb.Db(n5, i6, s5), (n5 = this.Uh(n5)) != null && n5.UB(i6, s5), (t5 = this.Na(t5)) != -1 && (t5 = this.Va(t5), this.Uh(t5) != null && n5.Sl(i6, s5));
        }, i5.prototype.D = function(t5, i6) {
          this.wb.D(this.ud.U(t5, 0), i6);
        }, i5.prototype.Hc = function(t5, i6) {
          this.wb.Aa[0].uc(2 * this.ud.U(t5, 0), i6);
        }, i5.prototype.Oa = function(i6) {
          var s5 = new t4.h();
          return this.wb.D(this.ud.U(i6, 0), s5), s5;
        }, i5.prototype.ZF = function(t5, i6) {
          this.jt.uc(2 * t5, i6);
        }, i5.prototype.Vc = function(t5, i6, s5) {
          return this.wb.Vc(t5, this.Va(i6), s5);
        }, i5.prototype.setAttribute = function(t5, i6, s5, n5) {
          this.wb.setAttribute(t5, this.Va(i6), s5, n5);
        }, i5.prototype.Va = function(t5) {
          return this.ud.U(t5, 0);
        }, i5.prototype.kh = function() {
          var i6 = new t4.h();
          return this.D(void 0, i6), i6.y;
        }, i5.prototype.hq = function(t5, i6) {
          t5 = this.Va(t5), i6 = this.Va(i6);
          var s5 = this.wb.Aa[0].o;
          return s5[2 * t5] === s5[2 * i6] && s5[2 * t5 + 1] === s5[2 * i6 + 1];
        }, i5.prototype.Fv = function(t5, i6) {
          t5 = this.Va(t5);
          var s5 = this.wb.Aa[0].o;
          return s5[2 * t5] === i6.x && s5[2 * t5 + 1] === i6.y;
        }, i5.prototype.rX = function(i6, s5) {
          if (1 > s5 && (s5 = 1), this.Ug == null) {
            if (s5 == 1)
              return;
            this.Ug = t4.Zc.Fn(this.wb.I(), 1);
          }
          (i6 = this.Va(i6)) >= this.Ug.size && this.Ug.resize(i6 + 1, 1), this.Ug.write(i6, s5);
        }, i5.prototype.YF = function(t5) {
          return t5 = this.Va(t5), this.Ug == null || t5 >= this.Ug.size ? 1 : this.Ug.read(t5);
        }, i5.prototype.Sa = function(t5, i6, s5) {
          i6 = this.di[i6], t5 = this.Va(t5), i6.size < this.wb.I() && i6.resize(this.wb.I(), -1), i6.write(t5, s5);
        }, i5.prototype.Qa = function(t5, i6) {
          return (t5 = this.Va(t5)) < (i6 = this.di[i6]).size ? i6.read(t5) : -1;
        }, i5.prototype.Hd = function() {
          this.di == null && (this.di = []);
          for (var i6 = 0; i6 < this.di.length; i6++)
            if (this.di[i6] == null)
              return this.di[i6] = t4.Zc.Qh(0, -1), i6;
          return this.di.push(t4.Zc.Qh(0, -1)), this.di.length - 1;
        }, i5.prototype.Ud = function(t5) {
          this.di[t5] = null;
        }, i5.prototype.cc = function(t5) {
          return this.Te != null ? (t5 = this.Va(t5), this.Te[t5]) : null;
        }, i5.prototype.fd = function(i6, s5) {
          var n5 = this.ud.U(i6, 2);
          if (n5 == -1)
            return false;
          if (this.aA) {
            var h3 = new t4.Ta();
            this.Xi(i6, h3), s5.setStart(h3), this.Xi(n5, h3), s5.setEnd(h3);
          } else
            this.wb.Hc(this.ud.U(i6, 0), tt2), s5.gm(0, tt2), this.wb.Hc(this.ud.U(n5, 0), tt2), s5.gm(1, tt2);
          return true;
        }, i5.prototype.hW = function(i6, s5, n5) {
          if (this.aA) {
            var h3 = new t4.Ta();
            this.Xi(i6, h3), n5.setStart(h3), this.Xi(s5, h3), n5.setEnd(h3);
          } else
            this.wb.Hc(i6, tt2), n5.gm(0, tt2), this.wb.Hc(s5, tt2), n5.gm(1, tt2);
        }, i5.prototype.wf = function(i6, s5) {
          if (s5 != -1) {
            if (i6 != this.Sf(s5))
              throw t4.i.Ra();
            var n5 = this.es(s5);
          } else
            n5 = this.mv(i6);
          var h3 = this.rU(i6);
          return s5 != -1 && this.ep(s5, h3), this.cp(h3, s5), this.ep(h3, n5), n5 != -1 ? this.cp(n5, h3) : this.ap(i6, h3), s5 == -1 && this.bp(i6, h3), this.Tl(i6, this.ea(i6) + 1), h3;
        }, i5.prototype.iG = function(t5, i6, s5, n5) {
          t5 = this.wf(t5, -1);
          for (var h3 = 0, r3 = i6, e3 = false; r3 == s5 && (e3 = true), this.cj(r3, t5), h3++, (r3 = this.V(r3)) != i6; )
            ;
          return this.mn(t5, true), this.Xj(t5, h3), e3 && (i6 = s5), this.Kf(t5, i6), this.Yg(t5, this.Na(i6)), this.fp(t5, false), n5 != null && (n5[0] = e3), t5;
        }, i5.prototype.ar = function(t5) {
          var i6 = this.es(t5), s5 = this.Sb(t5), n5 = this.Sf(t5);
          return i6 != -1 ? this.cp(i6, s5) : this.ap(n5, s5), s5 != -1 ? this.ep(s5, i6) : this.bp(n5, i6), this.vO(t5), this.Tl(n5, this.ea(n5) - 1), this.nF(t5), s5;
        }, i5.prototype.vO = function(t5) {
          var i6 = this.Ya(t5);
          if (i6 != -1) {
            for (var s5 = 0, n5 = this.Ka(t5); s5 < n5; s5++) {
              var h3 = i6;
              i6 = this.V(i6), this.Qy(h3);
            }
            i6 = this.Sf(t5), this.Vj(i6, this.I(i6) - this.Ka(t5));
          }
          this.Xj(t5, 0);
        }, i5.prototype.Sb = function(t5) {
          return this.nd.U(t5, 2);
        }, i5.prototype.es = function(t5) {
          return this.nd.U(t5, 1);
        }, i5.prototype.Ka = function(t5) {
          return this.nd.U(t5, 3);
        }, i5.prototype.ec = function(t5) {
          return (1 & this.Up(t5)) != 0;
        }, i5.prototype.mn = function(t5, i6) {
          if (this.ec(t5) != i6) {
            if (0 < this.Ka(t5)) {
              var s5 = this.Ya(t5), n5 = this.tj(t5);
              i6 ? (this.Cc(n5, s5), this.Dc(s5, n5), s5 = this.Va(n5)) : (this.Cc(n5, -1), this.Dc(s5, -1), s5 = this.Va(n5)), this.Zg(s5, null);
            }
            this.QB(t5, (1 | this.Up(t5)) - 1 | (i6 ? 1 : 0));
          }
        }, i5.prototype.Sf = function(t5) {
          return this.nd.U(t5, 7);
        }, i5.prototype.TS = function(t5) {
          return (2 & this.Up(t5)) != 0;
        }, i5.prototype.KB = function(t5, i6) {
          this.QB(t5, (2 | this.Up(t5)) - 2 | (i6 ? 2 : 0));
        }, i5.prototype.qz = function(i6) {
          if (this.YS(i6))
            return this.Qi.get(this.sv(i6));
          var s5 = new t4.zb(), n5 = this.Ya(i6);
          if (n5 == -1)
            return 0;
          var h3 = new t4.h();
          this.D(n5, h3);
          for (var r3 = 0, e3 = 0, o3 = this.Ka(i6); e3 < o3; e3++, n5 = this.V(n5)) {
            var a3 = this.cc(n5);
            if (a3 == null) {
              if (!this.fd(n5, s5))
                continue;
              a3 = s5;
            }
            r3 += a3.Sx(h3.x, h3.y);
          }
          return this.fp(i6, true), this.Qi.set(this.sv(i6), r3), r3;
        }, i5.prototype.ir = function(t5, i6, s5) {
          i6 = this.Ek[i6], t5 = this.sv(t5), i6.size < this.Qi.size && i6.resize(this.Qi.size, -1), i6.write(t5, s5);
        }, i5.prototype.uj = function(t5, i6) {
          return (t5 = this.sv(t5)) < (i6 = this.Ek[i6]).size ? i6.read(t5) : -1;
        }, i5.prototype.Fy = function() {
          this.Ek == null && (this.Ek = []);
          for (var i6 = 0; i6 < this.Ek.length; i6++)
            if (this.Ek[i6] == null)
              return this.Ek[i6] = t4.Zc.Qh(0), i6;
          return this.Ek.push(t4.Zc.Qh(0)), this.Ek.length - 1;
        }, i5.prototype.xB = function(t5) {
          this.Ek[t5] = null;
        }, i5.prototype.UT = function(i6, s5, n5) {
          if (n5 == -1)
            throw t4.i.O();
          if (s5 != n5) {
            var h3 = this.Sb(n5), r3 = this.es(n5), e3 = this.Sf(n5);
            r3 == -1 ? this.ap(e3, h3) : this.cp(r3, h3), h3 == -1 ? this.bp(e3, r3) : this.ep(h3, r3), this.Vj(e3, this.I(e3) - this.Ka(n5)), this.Tl(e3, this.ea(e3) - 1), r3 = s5 == -1 ? this.mv(i6) : this.es(s5), this.ep(n5, r3), this.cp(n5, s5), s5 == -1 ? this.bp(i6, n5) : this.ep(s5, n5), r3 == -1 ? this.ap(i6, n5) : this.cp(r3, n5), this.Vj(i6, this.I(i6) + this.Ka(n5)), this.Tl(i6, this.ea(i6) + 1), this.gx(n5, i6);
          }
        }, i5.prototype.kj = function(t5, i6) {
          this.wb.we(this.Va(i6), this.pm()), this.yj(t5, -1, this.pm());
        }, i5.prototype.qd = function(i6, s5) {
          var n5 = this.cd(i6), h3 = this.Na(i6), r3 = this.V(i6);
          h3 != -1 && this.Cc(h3, r3);
          var e3 = this.Ka(n5);
          if (i6 == this.Ya(n5) && this.Kf(n5, 1 < e3 ? r3 : -1), r3 != -1 && this.Dc(r3, h3), i6 == this.tj(n5) && this.Yg(n5, 1 < e3 ? h3 : -1), h3 != -1 && r3 != -1) {
            h3 = this.Va(h3);
            var o3 = this.Va(r3);
            s5 ? (s5 = this.Uh(h3)) != null && (h3 = new t4.h(), this.wb.D(o3, h3), s5.Rc(h3)) : (o3 = this.Va(i6), s5 = this.Uh(o3), this.Zg(h3, s5), s5 != null && (h3 = this.wb.Oa(h3), s5.Ec(h3)));
          }
          return this.Xj(n5, e3 - 1), n5 = this.Sf(n5), this.Vj(n5, this.I(n5) - 1), this.Qy(i6), r3;
        }, i5.prototype.Ya = function(t5) {
          return this.nd.U(t5, 4);
        }, i5.prototype.tj = function(t5) {
          return this.nd.U(t5, 5);
        }, i5.prototype.V = function(t5) {
          return this.ud.U(t5, 2);
        }, i5.prototype.Na = function(t5) {
          return this.ud.U(t5, 1);
        }, i5.prototype.cd = function(t5) {
          return this.ud.U(t5, 3);
        }, i5.prototype.hc = function(t5, i6) {
          return this.yj(t5, -1, i6);
        }, i5.prototype.$q = function(i6) {
          if (i6 === void 0)
            return this.$q(false);
          if (i6 instanceof n4)
            return new n4(i6);
          var s5, h3 = -1, r3 = -1, e3 = -1, o3 = 0, a3 = false;
          for (s5 = this.md; s5 != -1; s5 = this.ve(s5))
            if (!i6 || t4.ba.Ic(this.jc(s5))) {
              for (h3 = this.Ob(s5); h3 != -1; h3 = this.Sb(h3))
                if (e3 = r3 = this.Ya(h3), o3 = 0, r3 != -1) {
                  a3 = true;
                  break;
                }
              if (a3)
                break;
            }
          return n4.vP(this, s5, h3, r3, e3, o3, i6);
        }, i5.prototype.Pc = function(t5) {
          if (this.Kl.Pc(t5), this.Te != null)
            for (var i6 = 0, s5 = this.Te.length; i6 < s5; i6++)
              this.Te[i6] != null && this.Te[i6].Pc(t5);
        }, i5.prototype.lr = function(t5, i6, s5, n5) {
          n5 ? this.JX(t5, i6, s5) : this.IX(t5, i6, s5);
        }, i5.prototype.Dc = function(t5, i6) {
          this.ud.T(t5, 1, i6);
        }, i5.prototype.Cc = function(t5, i6) {
          this.ud.T(t5, 2, i6);
        }, i5.prototype.cj = function(t5, i6) {
          this.ud.T(t5, 3, i6);
        }, i5.prototype.Xj = function(t5, i6) {
          this.nd.T(t5, 3, i6);
        }, i5.prototype.Kf = function(t5, i6) {
          this.nd.T(t5, 4, i6);
        }, i5.prototype.Yg = function(t5, i6) {
          this.nd.T(t5, 5, i6);
        }, i5.prototype.Tl = function(t5, i6) {
          this.dd.T(t5, 6, i6);
        }, i5.prototype.Vj = function(t5, i6) {
          this.dd.T(t5, 5, i6);
        }, i5.prototype.kJ = function(t5) {
          var i6 = t5;
          do {
            var s5 = this.V(i6);
            this.Cc(i6, this.Na(i6)), this.Dc(i6, s5), i6 = s5;
          } while (i6 != t5);
        }, i5.prototype.XB = function(t5) {
          this.gd = t5;
        }, i5.prototype.br = function(t5) {
          var i6 = this.es(t5), s5 = this.Sb(t5), n5 = this.Sf(t5);
          i6 != -1 ? this.cp(i6, s5) : this.ap(n5, s5), s5 != -1 ? this.ep(s5, i6) : this.bp(n5, i6), this.Kf(t5, -1), this.Yg(t5, -1), this.nF(t5);
        }, i5.prototype.oi = function(i6, s5) {
          var n5 = this.Na(i6), h3 = this.V(i6);
          if (n5 != -1 && this.Cc(n5, h3), h3 != -1 && this.Dc(h3, n5), n5 != -1 && h3 != -1)
            if (n5 = this.Va(n5), h3 = this.Va(h3), s5) {
              if ((s5 = this.Uh(n5)) != null) {
                var r3 = new t4.h();
                this.wb.D(h3, r3), s5.Rc(r3);
              }
            } else
              s5 = this.Va(i6), s5 = this.Uh(s5), this.Zg(n5, s5), s5 != null && (r3 = new t4.h(), this.wb.D(n5, r3), s5.Ec(r3));
          this.Qy(i6);
        }, i5.prototype.YS = function(t5) {
          return (4 & this.Up(t5)) != 0;
        }, i5.prototype.fp = function(t5, i6) {
          this.QB(t5, (4 | this.Up(t5)) - 4 | (i6 ? 4 : 0));
        }, i5.prototype.nx = function(t5, i6) {
          var s5 = this.ud.o;
          this.wb.oc();
          var n5 = this.wb.Aa[0].o;
          t5.Wd(0, i6, function(t6, i7) {
            var h3 = s5[5 * t6];
            t6 = s5[5 * i7], i7 = n5[2 * h3], h3 = n5[2 * h3 + 1];
            var r3 = n5[2 * t6];
            return h3 < (t6 = n5[2 * t6 + 1]) ? -1 : h3 > t6 ? 1 : i7 < r3 ? -1 : i7 > r3 ? 1 : 0;
          });
        }, i5.prototype.eS = function() {
          for (var i6 = this.md; i6 != -1; i6 = this.ve(i6))
            if (!t4.ba.Ic(this.jc(i6)))
              return true;
          return false;
        }, i5.prototype.cC = function(t5, i6) {
          for (var s5 = this.Ob(t5), n5 = this.Ob(i6), h3 = this.mv(t5), r3 = this.mv(i6), e3 = this.Ob(t5); e3 != -1; e3 = this.Sb(e3))
            this.gx(e3, i6);
          for (e3 = this.Ob(i6); e3 != -1; e3 = this.Sb(e3))
            this.gx(e3, t5);
          this.ap(t5, n5), this.ap(i6, s5), this.bp(t5, r3), this.bp(i6, h3), s5 = this.I(t5), n5 = this.ea(t5), h3 = this.ea(i6), this.Vj(t5, this.I(i6)), this.Vj(i6, s5), this.Tl(t5, h3), this.Tl(i6, n5), s5 = this.dd.U(t5, 2), this.dd.T(t5, 2, this.dd.U(i6, 2)), this.dd.T(i6, 2, s5);
        }, i5;
      }(), t4.hd = i4;
    }(Q2 || (Q2 = {})), function(t4) {
      var i4 = function(i5) {
        function s4(s5, n4, h3, r3) {
          var e3 = i5.call(this) || this;
          return e3.aa = new t4.l(), s5 === void 0 ? e3.PE() : typeof s5 == "number" ? e3.QO(s5, n4, h3, r3) : s5 instanceof t4.Ta ? n4 !== void 0 ? e3.Su(s5, n4, h3) : e3.RO(s5) : s5 instanceof t4.sa ? n4 !== void 0 ? e3.TO(s5, n4) : e3.SO(s5) : s5 instanceof t4.l ? e3.PO(s5) : e3.PE(), e3;
        }
        return _2(s4, i5), s4.prototype.Su = function(i6, s5, n4) {
          this.description = t4.fe.pg(), this.aa.Pa(), i6.B() || this.vu(i6, s5, n4);
        }, s4.prototype.PO = function(i6) {
          this.description = t4.fe.pg(), this.aa.L(i6), this.aa.normalize();
        }, s4.prototype.SO = function(i6) {
          if (i6 == null)
            throw t4.i.O();
          this.description = i6, this.aa.Pa();
        }, s4.prototype.TO = function(i6, s5) {
          if (i6 == null)
            throw t4.i.O();
          this.description = i6, this.aa.L(s5), this.aa.normalize();
        }, s4.prototype.PE = function() {
          this.description = t4.fe.pg(), this.aa.Pa();
        }, s4.prototype.RO = function(i6) {
          this.description = t4.fe.pg(), this.aa.Pa(), i6.B() || this.vu(i6);
        }, s4.prototype.QO = function(i6, s5, n4, h3) {
          this.description = t4.fe.pg(), this.L(i6, s5, n4, h3);
        }, s4.prototype.L = function(t5, i6, s5, n4) {
          if (this.wc(), typeof t5 == "number")
            this.aa.L(t5, i6, s5, n4);
          else
            for (this.Pa(), i6 = 0, s5 = t5.length; i6 < s5; i6++)
              this.$b(t5[i6]);
        }, s4.prototype.Zo = function(i6) {
          if (this.wc(), !i6.aT())
            throw t4.i.O();
          this.aa.L(i6);
        }, s4.prototype.Pa = function() {
          this.wc(), this.aa.Pa();
        }, s4.prototype.B = function() {
          return this.aa.B();
        }, s4.prototype.S = function() {
          return this.aa.S();
        }, s4.prototype.da = function() {
          return this.aa.da();
        }, s4.prototype.ik = function() {
          return this.aa.ik();
        }, s4.prototype.Lp = function() {
          return this.aa.Lp();
        }, s4.prototype.Kp = function() {
          return this.aa.tf();
        }, s4.prototype.$b = function(i6) {
          if (i6 instanceof t4.h)
            this.wc(), this.aa.$b(i6);
          else if (i6 instanceof t4.l)
            this.wc(), this.aa.$b(i6);
          else if (i6 instanceof t4.Ta) {
            if (this.wc(), !i6.Bc()) {
              var n4 = i6.description;
              if (this.description != n4 && this.Ll(n4), this.B())
                this.vu(i6);
              else {
                this.aa.$b(i6.D());
                for (var h3 = 1, r3 = n4.Ba; h3 < r3; h3++)
                  for (var e3 = n4.Fd(h3), o3 = t4.sa.Wa(e3), a3 = 0; a3 < o3; a3++) {
                    var u3 = i6.Vc(e3, a3), f3 = this.Vg(e3, a3);
                    f3.$b(u3), this.setInterval(e3, a3, f3);
                  }
              }
            }
          } else if (i6 instanceof s4 && !i6.B())
            for ((n4 = i6.description) != this.description && this.Ll(n4), this.aa.$b(i6.aa), h3 = 1, r3 = n4.Ba; h3 < r3; h3++)
              for (e3 = n4.ld(h3), o3 = t4.sa.Wa(e3), a3 = 0; a3 < o3; a3++)
                u3 = i6.Vg(e3, a3), (f3 = this.Vg(e3, a3)).$b(u3), this.setInterval(e3, a3, f3);
        }, s4.prototype.vu = function(i6, s5, n4) {
          if (s5 !== void 0) {
            this.aa.L(i6.D(), s5, n4), n4 = 1;
            for (var h3 = (s5 = i6.description).Ba; n4 < h3; n4++)
              for (var r3 = s5.Fd(n4), e3 = t4.sa.Wa(r3), o3 = 0; o3 < e3; o3++) {
                var a3 = i6.Vc(r3, o3);
                this.setInterval(r3, o3, a3, a3);
              }
          } else
            for (this.aa.L(i6.la[0], i6.la[1]), n4 = 1, h3 = (s5 = i6.description).Ba; n4 < h3; n4++)
              for (r3 = s5.Fd(n4), e3 = t4.sa.Wa(r3), o3 = 0; o3 < e3; o3++)
                a3 = i6.Vc(r3, o3), this.setInterval(r3, o3, a3, a3);
        }, s4.prototype.setInterval = function(i6, s5, n4, h3) {
          if (n4 = typeof n4 == "number" ? new t4.Oc(n4, h3) : n4, this.wc(), i6 == 0)
            if (s5 == 0)
              this.aa.v = n4.pa, this.aa.C = n4.wa;
            else {
              if (s5 != 1)
                throw t4.i.de();
              this.aa.G = n4.pa, this.aa.H = n4.wa;
            }
          else
            this.qD(0, i6, s5, n4.pa), this.qD(1, i6, s5, n4.wa);
        }, s4.prototype.X = function(t5, i6) {
          this.wc(), this.aa.X(t5, i6);
        }, s4.prototype.Pc = function(i6) {
          if (i6 instanceof t4.Ed)
            this.wc(), i6.hC(this.aa);
          else if (this.wc(), !this.aa.B()) {
            var s5 = new t4.JK();
            this.So(s5), s5.SS() ? s5.Pa() : i6.hC(s5);
          }
        }, s4.prototype.copyTo = function(i6) {
          if (i6.K() != this.K())
            throw t4.i.O();
          if (i6.wc(), i6.description = this.description, i6.aa.L(this.aa), i6.la = null, this.la != null) {
            i6.qu();
            for (var s5 = 0; s5 < 2 * (this.description.Be.length - 2); s5++)
              i6.la[s5] = this.la[s5];
          }
        }, s4.prototype.Ja = function() {
          return new s4(this.description);
        }, s4.prototype.He = function() {
          return this.aa.rF();
        }, s4.prototype.Rb = function() {
          return this.aa.tR();
        }, s4.prototype.K = function() {
          return 197;
        }, s4.prototype.Eb = function() {
          return 2;
        }, s4.prototype.dn = function(t5) {
          this.copyTo(t5);
        }, s4.prototype.A = function(t5) {
          t5.v = this.aa.v, t5.G = this.aa.G, t5.C = this.aa.C, t5.H = this.aa.H;
        }, s4.prototype.So = function(t5) {
          t5.v = this.aa.v, t5.G = this.aa.G, t5.C = this.aa.C, t5.H = this.aa.H, t5.L(this.aa.v, this.aa.G, this.Pd(0, 1, 0), this.aa.C, this.aa.H, this.Pd(1, 1, 0));
        }, s4.prototype.Vg = function(i6, s5) {
          var n4 = new t4.Oc();
          return n4.L(this.Pd(0, i6, s5), this.Pd(1, i6, s5)), n4;
        }, s4.prototype.If = function(i6, s5) {
          s5.Pf(this.description);
          var n4 = this.description.Ba - 1;
          switch (i6) {
            case 0:
              for (i6 = 0; i6 < n4; i6++)
                for (var h3 = this.description.ld(i6), r3 = t4.sa.Wa(h3), e3 = 0; e3 < r3; e3++)
                  s5.setAttribute(h3, e3, this.Pd(0, h3, e3));
              s5.Db(this.aa.v, this.aa.G);
              break;
            case 1:
              for (i6 = 0; i6 < n4; i6++)
                for (h3 = this.description.ld(i6), r3 = t4.sa.Wa(h3), e3 = 0; e3 < r3; e3++)
                  s5.setAttribute(h3, e3, this.Pd(1, h3, e3));
              s5.Db(this.aa.v, this.aa.H);
              break;
            case 2:
              for (i6 = 0; i6 < n4; i6++)
                for (h3 = this.description.ld(i6), r3 = t4.sa.Wa(h3), e3 = 0; e3 < r3; e3++)
                  s5.setAttribute(h3, e3, this.Pd(0, h3, e3));
              s5.Db(this.aa.C, this.aa.H);
              break;
            case 3:
              for (i6 = 0; i6 < n4; i6++)
                for (h3 = this.description.ld(i6), r3 = t4.sa.Wa(h3), e3 = 0; e3 < r3; e3++)
                  s5.setAttribute(h3, e3, this.Pd(1, h3, e3));
              s5.Db(this.aa.C, this.aa.G);
              break;
            default:
              throw t4.i.de();
          }
        }, s4.prototype.hB = function(t5, i6) {
          t5 = this.aa.hB(t5), i6.na(t5.x, t5.y);
        }, s4.prototype.fR = function(t5, i6) {
          return i6 * (t5.Qq - 2);
        }, s4.prototype.sF = function(i6, s5, n4) {
          if (this.aa.B())
            throw t4.i.ga("empty geometry");
          if (s5 == 0)
            return i6 != 0 ? n4 != 0 ? this.aa.H : this.aa.C : n4 != 0 ? this.aa.G : this.aa.v;
          if (n4 >= t4.sa.Wa(s5))
            throw t4.i.O();
          var h3 = this.description.Rf(s5);
          return this.qu(), 0 <= h3 ? this.la[this.fR(this.description, i6) + this.description.GR(h3) - 2 + n4] : t4.sa.te(s5);
        }, s4.prototype.qu = function() {
          if (this.wc(), this.la == null && 2 < this.description.Be.length) {
            this.la = [];
            for (var i6 = s4.Ig(this.description, 0), n4 = s4.Ig(this.description, 1), h3 = 0, r3 = 1, e3 = this.description.Ba; r3 < e3; r3++) {
              var o3 = this.description.ld(r3), a3 = t4.sa.Wa(o3);
              o3 = t4.sa.te(o3);
              for (var u3 = 0; u3 < a3; u3++)
                this.la[i6 + h3] = o3, this.la[n4 + h3] = o3, h3++;
            }
          }
        }, s4.prototype.un = function(i6) {
          if (this.la != null)
            if (2 < i6.Be.length) {
              for (var n4 = t4.fe.Kw(i6, this.description), h3 = [], r3 = s4.Ig(this.description, 0), e3 = s4.Ig(this.description, 1), o3 = s4.Ig(i6, 0), a3 = s4.Ig(i6, 1), u3 = 0, f3 = 1, c3 = i6.Ba; f3 < c3; f3++) {
                var l3 = i6.ld(f3), p3 = t4.sa.Wa(l3);
                if (n4[f3] == -1) {
                  var v3 = t4.sa.te(l3);
                  for (l3 = 0; l3 < p3; l3++)
                    h3[o3 + u3] = v3, h3[a3 + u3] = v3, u3++;
                } else
                  for (v3 = this.description.bk(n4[f3]) - 2, l3 = 0; l3 < p3; l3++)
                    h3[o3 + u3] = this.la[r3 + v3], h3[a3 + u3] = this.la[e3 + v3], u3++, v3++;
              }
              this.la = h3;
            } else
              this.la = null;
          this.description = i6;
        }, s4.prototype.Pd = function(i6, n4, h3) {
          if (this.aa.B())
            throw t4.i.ga("This operation was performed on an Empty Geometry.");
          if (n4 == 0)
            return i6 != 0 ? h3 != 0 ? this.aa.H : this.aa.C : h3 != 0 ? this.aa.G : this.aa.v;
          if (h3 >= t4.sa.Wa(n4))
            throw t4.i.de();
          var r3 = this.description.Rf(n4);
          return 0 <= r3 ? (this.qu(), this.la[s4.Ig(this.description, i6) + this.description.bk(r3) - 2 + h3]) : t4.sa.te(n4);
        }, s4.prototype.qD = function(i6, n4, h3, r3) {
          if (this.wc(), n4 == 0)
            i6 != 0 ? h3 != 0 ? this.aa.H = r3 : this.aa.C = r3 : h3 != 0 ? this.aa.G = r3 : this.aa.v = r3;
          else {
            if (h3 >= t4.sa.Wa(n4))
              throw t4.i.de();
            if (!this.hasAttribute(n4)) {
              if (t4.sa.yG(n4, r3))
                return;
              this.se(n4);
            }
            n4 = this.description.Rf(n4), this.qu(), this.la[s4.Ig(this.description, i6) + this.description.bk(n4) - 2 + h3] = r3;
          }
        }, s4.Ig = function(t5, i6) {
          return i6 * (t5.Be.length - 2);
        }, s4.prototype.Fa = function(i6) {
          this.wc();
          var s5 = new t4.l();
          return i6.A(s5), this.aa.Fa(s5);
        }, s4.prototype.isIntersecting = function(i6) {
          return i6 instanceof t4.l ? this.aa.isIntersecting(i6) : this.aa.isIntersecting(i6.aa);
        }, s4.prototype.Lu = function(t5, i6) {
          this.wc(), t5.B() ? this.Pa() : i6 !== void 0 ? this.vu(t5, i6, void 0) : this.aa.Lu(t5.Ng(), t5.kh());
        }, s4.prototype.offset = function(t5, i6) {
          this.wc(), this.aa.offset(t5, i6);
        }, s4.prototype.normalize = function() {
          this.wc(), this.aa.normalize();
        }, s4.prototype.tf = function(i6) {
          if (i6 === void 0) {
            if (i6 = new t4.Ta(this.description), this.B())
              return i6;
            for (s5 = this.description.Ba, n4 = 1; n4 < s5; n4++)
              for (h3 = this.description.Fd(n4), r3 = t4.sa.Wa(h3), e3 = 0; e3 < r3; e3++)
                o3 = 0.5 * (this.Pd(0, h3, e3) + this.Pd(1, h3, e3)), i6.setAttribute(h3, e3, o3);
            return i6.Db(this.aa.ik(), this.aa.Lp()), i6;
          }
          if (i6.Pf(this.description), this.B())
            i6.Pa();
          else {
            for (var s5 = this.description.Ba, n4 = 1; n4 < s5; n4++)
              for (var h3 = this.description.ld(n4), r3 = t4.sa.Wa(h3), e3 = 0; e3 < r3; e3++) {
                var o3 = 0.5 * (this.sF(0, h3, e3) + this.sF(1, h3, e3));
                i6.setAttribute(h3, e3, o3);
              }
            i6.Db(this.aa.tf());
          }
        }, s4.prototype.hz = function() {
          return new t4.Ta(this.aa.hz());
        }, s4.prototype.contains = function(i6) {
          return i6 instanceof t4.Ta ? !i6.B() && this.aa.contains(i6.Ng(), i6.kh()) : this.aa.contains(i6.aa);
        }, s4.prototype.ZO = function(t5) {
          return this.aa.contains(t5);
        }, s4.prototype.Nb = function(t5) {
          if (t5 == this)
            return true;
          if (!(t5 instanceof s4) || this.description != t5.description)
            return false;
          if (this.B())
            return !!t5.B();
          if (!this.aa.Nb(t5.aa))
            return false;
          for (var i6 = 0, n4 = 2 * (this.description.Be.length - 2); i6 < n4; i6++)
            if (this.la[i6] != t5.la[i6])
              return false;
          return true;
        }, s4.prototype.dc = function() {
          var i6 = this.description.dc();
          if (i6 = t4.P.Vh(i6, this.aa.dc()), !this.B() && this.la != null)
            for (var s5 = 0, n4 = 2 * (this.description.Be.length - 2); s5 < n4; s5++)
              i6 = t4.P.Vh(i6, this.la[s5]);
          return i6;
        }, s4.prototype.gs = function() {
          return this.aa.v;
        }, s4.prototype.js = function() {
          return this.aa.G;
        }, s4.prototype.fs = function() {
          return this.aa.C;
        }, s4.prototype.hs = function() {
          return this.aa.H;
        }, s4.prototype.ng = function() {
          return t4.si.im(this, null);
        }, s4.prototype.toString = function() {
          return this.B() ? "Envelope: []" : "Envelope: [" + this.aa.v + ", " + this.aa.G + ", " + this.aa.C + ", " + this.aa.H + "]";
        }, s4;
      }(t4.ba);
      t4.Hh = i4;
    }(Q2 || (Q2 = {})), function(t4) {
      var i4 = function() {
        function i5(t5, i6, s4, n4) {
          t5 === void 0 ? this.Pa() : (this.v = t5, this.G = i6, this.C = s4, this.H = n4);
        }
        return i5.construct = function(t5, s4, n4, h3) {
          var r3 = new i5();
          return r3.v = t5, r3.G = s4, r3.C = n4, r3.H = h3, r3;
        }, i5.prototype.L = function(s4, n4, h3, r3) {
          typeof s4 == "number" ? h3 !== void 0 ? (this.v = s4, this.G = n4, this.C = h3, this.H = r3, this.normalize()) : (this.v = s4, this.G = n4, this.C = s4, this.H = n4) : s4 instanceof t4.h ? n4 !== void 0 ? (this.v = s4.x - 0.5 * n4, this.C = this.v + n4, this.G = s4.y - 0.5 * h3, this.H = this.G + h3, this.normalize()) : (this.v = s4.x, this.G = s4.y, this.C = s4.x, this.H = s4.y) : s4 instanceof i5 ? this.L(s4.v, s4.G, s4.C, s4.H) : s4 instanceof t4.Oc && (s4.B() || n4.B() ? this.Pa() : (this.v = s4.pa, this.C = s4.wa, this.G = n4.pa, this.H = n4.wa));
        }, i5.prototype.bx = function(t5, i6) {
          if (i6 !== void 0)
            if (i6 == 0)
              this.Pa();
            else {
              this.v = t5[0].x, this.G = t5[0].y, this.C = this.v, this.H = this.G;
              for (var s4 = 1; s4 < i6; s4++) {
                var n4 = t5[s4];
                n4.x < this.v ? this.v = n4.x : n4.x > this.C && (this.C = n4.x), n4.y < this.G ? this.G = n4.y : n4.y > this.H && (this.H = n4.y);
              }
            }
          else if (t5 == null || t5.length == 0)
            this.Pa();
          else
            for (n4 = t5[0], this.L(n4.x, n4.y), s4 = 1; s4 < t5.length; s4++)
              i6 = t5[s4], this.Nk(i6.x, i6.y);
        }, i5.prototype.Pa = function() {
          this.H = this.C = this.G = this.v = NaN;
        }, i5.prototype.B = function() {
          return isNaN(this.v);
        }, i5.prototype.$b = function(s4, n4) {
          typeof s4 == "number" ? this.B() ? (this.v = s4, this.G = n4, this.C = s4, this.H = n4) : (this.v > s4 ? this.v = s4 : this.C < s4 && (this.C = s4), this.G > n4 ? this.G = n4 : this.H < n4 && (this.H = n4)) : s4 instanceof t4.h || s4 instanceof t4.Od ? this.$b(s4.x, s4.y) : s4 instanceof i5 && !s4.B() && (this.$b(s4.v, s4.G), this.$b(s4.C, s4.H));
        }, i5.prototype.Nk = function(t5, i6) {
          this.v > t5 ? this.v = t5 : this.C < t5 && (this.C = t5), this.G > i6 ? this.G = i6 : this.H < i6 && (this.H = i6);
        }, i5.prototype.X = function(t5, i6) {
          this.B() || (this.v -= t5, this.C += t5, this.G -= i6, this.H += i6, (this.v > this.C || this.G > this.H) && this.Pa());
        }, i5.prototype.scale = function(t5) {
          0 > t5 && this.Pa(), this.B() || (this.v *= t5, this.C *= t5, this.G *= t5, this.H *= t5);
        }, i5.prototype.zoom = function(t5, i6) {
          this.B() || this.L(this.tf(), t5 * this.S(), i6 * this.da());
        }, i5.prototype.isIntersecting = function(t5) {
          return !this.B() && !t5.B() && (this.v <= t5.v ? this.C >= t5.v : t5.C >= this.v) && (this.G <= t5.G ? this.H >= t5.G : t5.H >= this.G);
        }, i5.prototype.CG = function(t5) {
          return (this.v <= t5.v ? this.C >= t5.v : t5.C >= this.v) && (this.G <= t5.G ? this.H >= t5.G : t5.H >= this.G);
        }, i5.prototype.Fa = function(t5) {
          return !this.B() && !t5.B() && (t5.v > this.v && (this.v = t5.v), t5.C < this.C && (this.C = t5.C), t5.G > this.G && (this.G = t5.G), t5.H < this.H && (this.H = t5.H), (t5 = this.v <= this.C && this.G <= this.H) || this.Pa(), t5);
        }, i5.prototype.hB = function(i6) {
          switch (i6) {
            case 0:
              return t4.h.construct(this.v, this.G);
            case 1:
              return t4.h.construct(this.v, this.H);
            case 2:
              return t4.h.construct(this.C, this.H);
            case 3:
              return t4.h.construct(this.C, this.G);
            default:
              throw t4.i.de();
          }
        }, i5.prototype.iB = function(i6) {
          if (i6 == null || 4 > i6.length)
            throw t4.i.O();
          i6[0] != null ? i6[0].na(this.v, this.G) : i6[0] = t4.h.construct(this.v, this.G), i6[1] != null ? i6[1].na(this.v, this.H) : i6[1] = t4.h.construct(this.v, this.H), i6[2] != null ? i6[2].na(this.C, this.H) : i6[2] = t4.h.construct(this.C, this.H), i6[3] != null ? i6[3].na(this.C, this.G) : i6[3] = t4.h.construct(this.C, this.G);
        }, i5.prototype.rF = function() {
          return this.B() ? 0 : this.S() * this.da();
        }, i5.prototype.tR = function() {
          return this.B() ? 0 : 2 * (this.S() + this.da());
        }, i5.prototype.ik = function() {
          return (this.C + this.v) / 2;
        }, i5.prototype.Lp = function() {
          return (this.H + this.G) / 2;
        }, i5.prototype.S = function() {
          return this.C - this.v;
        }, i5.prototype.da = function() {
          return this.H - this.G;
        }, i5.prototype.move = function(t5, i6) {
          this.B() || (this.v += t5, this.G += i6, this.C += t5, this.H += i6);
        }, i5.prototype.Lu = function(i6, s4) {
          if (s4 !== void 0)
            this.move(i6 - this.ik(), s4 - this.Lp());
          else if (i6 instanceof t4.h)
            this.Lu(i6.x, i6.y);
          else {
            if (!(i6 instanceof t4.Ta))
              throw t4.i.O();
            s4 = (this.C - this.v) / 2;
            var n4 = (this.H - this.G) / 2;
            this.v = i6.Ng() - s4, this.C = i6.Ng() + s4, this.G = i6.kh() - n4, this.H = i6.kh() + n4;
          }
        }, i5.prototype.offset = function(t5, i6) {
          this.v += t5, this.C += t5, this.G += i6, this.H += i6;
        }, i5.prototype.normalize = function() {
          if (!this.B()) {
            var t5 = Math.min(this.v, this.C), i6 = Math.max(this.v, this.C);
            this.v = t5, this.C = i6, t5 = Math.min(this.G, this.H), i6 = Math.max(this.G, this.H), this.G = t5, this.H = i6;
          }
        }, i5.prototype.fn = function(t5) {
          t5.na(this.v, this.G);
        }, i5.prototype.VI = function(t5) {
          t5.na(this.C, this.G);
        }, i5.prototype.YI = function(t5) {
          t5.na(this.v, this.H);
        }, i5.prototype.gn = function(t5) {
          t5.na(this.C, this.H);
        }, i5.prototype.aT = function() {
          return this.B() || this.v <= this.C && this.G <= this.H;
        }, i5.prototype.tf = function() {
          return t4.h.construct((this.C + this.v) / 2, (this.H + this.G) / 2);
        }, i5.prototype.hz = function() {
          return t4.h.construct(this.v, this.G);
        }, i5.prototype.contains = function(s4, n4) {
          if (n4 !== void 0)
            return s4 >= this.v && s4 <= this.C && n4 >= this.G && n4 <= this.H;
          if (s4 instanceof t4.Ta)
            return this.contains(s4.Ng(), s4.kh());
          if (s4 instanceof t4.h)
            return this.contains(s4.x, s4.y);
          if (s4 instanceof i5)
            return s4.v >= this.v && s4.C <= this.C && s4.G >= this.G && s4.H <= this.H;
          throw t4.i.O();
        }, i5.prototype.jm = function(s4, n4) {
          if (n4 !== void 0)
            return s4 > this.v && s4 < this.C && n4 > this.G && n4 < this.H;
          if (s4 instanceof t4.h)
            return this.jm(s4.x, s4.y);
          if (s4 instanceof i5)
            return s4.v > this.v && s4.C < this.C && s4.G > this.G && s4.H < this.H;
          throw t4.i.O();
        }, i5.prototype.Nb = function(t5) {
          return t5 == this || t5 instanceof i5 && (!(!this.B() || !t5.B()) || this.v == t5.v && this.G == t5.G && this.C == t5.C && this.H == t5.H);
        }, i5.prototype.dc = function() {
          var i6 = this.v;
          i6 = t4.P.truncate(i6 ^ i6 >>> 32);
          var s4 = t4.P.Vh(i6);
          return i6 = this.C, i6 = t4.P.truncate(i6 ^ i6 >>> 32), s4 = t4.P.Vh(i6, s4), i6 = this.G, i6 = t4.P.truncate(i6 ^ i6 >>> 32), s4 = t4.P.Vh(i6, s4), i6 = this.H, i6 = t4.P.truncate(i6 ^ i6 >>> 32), t4.P.Vh(i6, s4);
        }, i5.prototype.zr = function() {
          return this.B() ? 2220446049250313e-29 : 2220446049250313e-29 * (Math.abs(this.v) + Math.abs(this.C) + Math.abs(this.G) + Math.abs(this.H) + 1);
        }, i5.prototype.uy = function(t5, s4) {
          var n4 = this.ak(t5), h3 = this.ak(s4);
          if ((n4 & h3) != 0)
            return 0;
          if ((n4 | h3) == 0)
            return 4;
          var r3 = (n4 != 0 ? 1 : 0) | (h3 != 0 ? 2 : 0);
          do {
            var e3 = s4.x - t5.x, o3 = s4.y - t5.y;
            if (e3 > o3 ? (n4 & i5.TC) != 0 ? ((n4 & i5.lu) != 0 ? (t5.y += o3 * (this.v - t5.x) / e3, t5.x = this.v) : (t5.y += o3 * (this.C - t5.x) / e3, t5.x = this.C), n4 = this.ak(t5)) : (h3 & i5.TC) != 0 ? ((h3 & i5.lu) != 0 ? (s4.y += o3 * (this.v - s4.x) / e3, s4.x = this.v) : (s4.y += o3 * (this.C - s4.x) / e3, s4.x = this.C), h3 = this.ak(s4)) : n4 != 0 ? ((n4 & i5.mu) != 0 ? (t5.x += e3 * (this.G - t5.y) / o3, t5.y = this.G) : (t5.x += e3 * (this.H - t5.y) / o3, t5.y = this.H), n4 = this.ak(t5)) : ((h3 & i5.mu) != 0 ? (s4.x += e3 * (this.G - s4.y) / o3, s4.y = this.G) : (s4.x += e3 * (this.H - s4.y) / o3, s4.y = this.H), h3 = this.ak(s4)) : (n4 & i5.UC) != 0 ? ((n4 & i5.mu) != 0 ? (t5.x += e3 * (this.G - t5.y) / o3, t5.y = this.G) : (t5.x += e3 * (this.H - t5.y) / o3, t5.y = this.H), n4 = this.ak(t5)) : (h3 & i5.UC) != 0 ? ((h3 & i5.mu) != 0 ? (s4.x += e3 * (this.G - s4.y) / o3, s4.y = this.G) : (s4.x += e3 * (this.H - s4.y) / o3, s4.y = this.H), h3 = this.ak(s4)) : n4 != 0 ? ((n4 & i5.lu) != 0 ? (t5.y += o3 * (this.v - t5.x) / e3, t5.x = this.v) : (t5.y += o3 * (this.C - t5.x) / e3, t5.x = this.C), n4 = this.ak(t5)) : ((h3 & i5.lu) != 0 ? (s4.y += o3 * (this.v - s4.x) / e3, s4.x = this.v) : (s4.y += o3 * (this.C - s4.x) / e3, s4.x = this.C), h3 = this.ak(s4)), (n4 & h3) != 0)
              return 0;
          } while ((n4 | h3) != 0);
          return r3;
        }, i5.prototype.ak = function(t5) {
          return (t5.x < this.v ? 1 : 0) | (t5.x > this.C ? 1 : 0) << 1 | (t5.y < this.G ? 1 : 0) << 2 | (t5.y > this.H ? 1 : 0) << 3;
        }, i5.prototype.Di = function(t5) {
          return !this.B() && (this.S() <= t5 || this.da() <= t5);
        }, i5.prototype.ub = function(i6) {
          return i6 instanceof t4.h ? Math.sqrt(this.dK(i6)) : Math.sqrt(this.px(i6));
        }, i5.prototype.px = function(t5) {
          var i6 = 0, s4 = 0, n4 = this.v - t5.C;
          return n4 > i6 && (i6 = n4), (n4 = this.G - t5.H) > s4 && (s4 = n4), (n4 = t5.v - this.C) > i6 && (i6 = n4), (n4 = t5.G - this.H) > s4 && (s4 = n4), i6 * i6 + s4 * s4;
        }, i5.prototype.dK = function(t5) {
          var i6 = 0, s4 = 0, n4 = this.v - t5.x;
          return n4 > i6 && (i6 = n4), (n4 = this.G - t5.y) > s4 && (s4 = n4), (n4 = t5.x - this.C) > i6 && (i6 = n4), (n4 = t5.y - this.H) > s4 && (s4 = n4), i6 * i6 + s4 * s4;
        }, i5.prototype.en = function(t5) {
          this.B() ? t5.Pa() : t5.L(this.v, this.C);
        }, i5.lu = 1, i5.mu = 4, i5.TC = 3, i5.UC = 12, i5;
      }();
      t4.l = i4;
    }(Q2 || (Q2 = {})), function(t4) {
      var i4, s4;
      (s4 = i4 || (i4 = {}))[s4.initialize = 0] = "initialize", s4[s4.initializeRed = 1] = "initializeRed", s4[s4.initializeBlue = 2] = "initializeBlue", s4[s4.initializeRedBlue = 3] = "initializeRedBlue", s4[s4.sweep = 4] = "sweep", s4[s4.sweepBruteForce = 5] = "sweepBruteForce", s4[s4.sweepRedBlueBruteForce = 6] = "sweepRedBlueBruteForce", s4[s4.sweepRedBlue = 7] = "sweepRedBlue", s4[s4.sweepRed = 8] = "sweepRed", s4[s4.sweepBlue = 9] = "sweepBlue", s4[s4.iterate = 10] = "iterate", s4[s4.iterateRed = 11] = "iterateRed", s4[s4.iterateBlue = 12] = "iterateBlue", s4[s4.iterateBruteForce = 13] = "iterateBruteForce", s4[s4.iterateRedBlueBruteForce = 14] = "iterateRedBlueBruteForce", s4[s4.resetRed = 15] = "resetRed", s4[s4.resetBlue = 16] = "resetBlue";
      var n4 = function() {
        function t5(t6, i5) {
          this.ei = t6, this.ZG = i5;
        }
        return t5.prototype.qr = function(t6, i5, s5) {
          this.ei.FX(s5, t6, i5, this.ZG);
        }, t5.prototype.bq = function(t6) {
          return this.ei.Tr(t6, this.ZG);
        }, t5;
      }();
      i4 = function() {
        function i5() {
          this.qw = this.qo = this.ff = this.sd = null, this.yq = new t4.l(), this.Cm = this.Jj = this.Kj = this.Bd = this.Ff = this.Md = this.ew = this.io = this.rd = this.Fb = null, this.Yb = -1, this.ra = 0, this.Pk();
        }
        return i5.prototype.mr = function() {
          this.Pk(), this.Rv = true, this.Fb == null ? (this.io = new t4.ja(0), this.Fb = []) : (this.io.Dh(0), this.Fb.length = 0);
        }, i5.prototype.bd = function(i6, s5) {
          if (!this.Rv)
            throw t4.i.Hb();
          var n5 = new t4.l();
          n5.L(s5), this.io.add(i6), this.Fb.push(n5);
        }, i5.prototype.Hp = function() {
          if (!this.Rv)
            throw t4.i.Hb();
          this.Rv = false, this.Fb != null && 0 < this.Fb.length && (this.Yb = 0, this.Jc = false);
        }, i5.prototype.kK = function() {
          this.Pk(), this.Qv = true, this.Fb == null ? (this.io = new t4.ja(0), this.Fb = []) : (this.io.Dh(0), this.Fb.length = 0);
        }, i5.prototype.DD = function(i6, s5) {
          if (!this.Qv)
            throw t4.i.Hb();
          var n5 = new t4.l();
          n5.L(s5), this.io.add(i6), this.Fb.push(n5);
        }, i5.prototype.dF = function() {
          if (!this.Qv)
            throw t4.i.Hb();
          this.Qv = false, this.Fb != null && 0 < this.Fb.length && this.rd != null && 0 < this.rd.length && (this.Yb == -1 || this.Yb == 2 ? this.Yb = 3 : this.Yb != 3 && (this.Yb = 1), this.Jc = false);
        }, i5.prototype.jK = function() {
          this.Pk(), this.Pv = true, this.rd == null ? (this.ew = new t4.ja(0), this.rd = []) : (this.ew.Dh(0), this.rd.length = 0);
        }, i5.prototype.zD = function(i6, s5) {
          if (!this.Pv)
            throw t4.i.Hb();
          var n5 = new t4.l();
          n5.L(s5), this.ew.add(i6), this.rd.push(n5);
        }, i5.prototype.cF = function() {
          if (!this.Pv)
            throw t4.i.Hb();
          this.Pv = false, this.Fb != null && 0 < this.Fb.length && this.rd != null && 0 < this.rd.length && (this.Yb == -1 || this.Yb == 1 ? this.Yb = 3 : this.Yb != 3 && (this.Yb = 2), this.Jc = false);
        }, i5.prototype.next = function() {
          if (this.Jc)
            return false;
          for (var i6 = true; i6; )
            switch (this.Yb) {
              case 0:
                i6 = this.Bz();
                break;
              case 1:
                i6 = this.mS();
                break;
              case 2:
                i6 = this.jS();
                break;
              case 3:
                i6 = this.lS();
                break;
              case 4:
                i6 = this.QX();
                break;
              case 5:
                i6 = this.MX();
                break;
              case 6:
                i6 = this.NX();
                break;
              case 7:
                i6 = this.OX();
                break;
              case 8:
                i6 = this.tx();
                break;
              case 9:
                i6 = this.dC();
                break;
              case 10:
                i6 = this.Pz();
                break;
              case 11:
                i6 = this.eT();
                break;
              case 12:
                i6 = this.bT();
                break;
              case 13:
                i6 = this.cT();
                break;
              case 14:
                i6 = this.dT();
                break;
              case 15:
                i6 = this.fJ();
                break;
              case 16:
                i6 = this.eJ();
                break;
              default:
                throw t4.i.Ra();
            }
          return !this.Jc;
        }, i5.prototype.WB = function(t5) {
          this.ra = t5;
        }, i5.prototype.oz = function(t5) {
          return this.Fb[t5];
        }, i5.prototype.Wy = function(t5) {
          return this.rd[t5];
        }, i5.prototype.pl = function(t5) {
          return this.io.read(t5);
        }, i5.prototype.jl = function(t5) {
          return this.ew.read(t5);
        }, i5.Oz = function(t5) {
          return (1 & t5) == 1;
        }, i5.gq = function(t5) {
          return (1 & t5) == 0;
        }, i5.prototype.Pk = function() {
          this.Rv = this.Pv = this.Qv = false, this.Df = this.Ef = this.Tg = this.qe = -1, this.Jc = true;
        }, i5.prototype.Bz = function() {
          if (this.Bf = this.Xf = -1, 10 > this.Fb.length)
            return this.qe = this.Fb.length, this.Yb = 5, true;
          this.sd == null && (this.sd = new t4.ur(true), this.qo = this.sd.getIterator(), this.Md = new t4.ja(0)), this.sd.mr();
          for (var i6 = 0; i6 < this.Fb.length; i6++) {
            var s5 = this.Fb[i6];
            this.sd.Dr(s5.v, s5.C);
          }
          for (this.sd.Hp(), this.Md.Jb(2 * this.Fb.length), this.Md.resize(0), i6 = 0; i6 < 2 * this.Fb.length; i6++)
            this.Md.add(i6);
          return this.Mt(this.Md, 2 * this.Fb.length, true), this.qe = 2 * this.Fb.length, this.Yb = 4, true;
        }, i5.prototype.mS = function() {
          if (this.Bf = this.Xf = -1, 10 > this.Fb.length || 10 > this.rd.length)
            return this.qe = this.Fb.length, this.Yb = 6, true;
          this.sd == null && (this.sd = new t4.ur(true), this.qo = this.sd.getIterator(), this.Md = new t4.ja(0)), this.sd.mr();
          for (var i6 = 0; i6 < this.Fb.length; i6++) {
            var s5 = this.Fb[i6];
            this.sd.Dr(s5.v, s5.C);
          }
          for (this.sd.Hp(), this.Md.Jb(2 * this.Fb.length), this.Md.resize(0), i6 = 0; i6 < 2 * this.Fb.length; i6++)
            this.Md.add(i6);
          return this.Mt(this.Md, this.Md.size, true), this.qe = this.Md.size, this.Ef != -1 && (this.Bd.eh(this.Ef), this.Kj.resize(0), this.Ef = -1), this.Yb = 7, this.eJ();
        }, i5.prototype.jS = function() {
          if (this.Bf = this.Xf = -1, 10 > this.Fb.length || 10 > this.rd.length)
            return this.qe = this.Fb.length, this.Yb = 6, true;
          this.ff == null && (this.ff = new t4.ur(true), this.qw = this.ff.getIterator(), this.Ff = new t4.ja(0)), this.ff.mr();
          for (var i6 = 0; i6 < this.rd.length; i6++) {
            var s5 = this.rd[i6];
            this.ff.Dr(s5.v, s5.C);
          }
          for (this.ff.Hp(), this.Ff.Jb(2 * this.rd.length), this.Ff.resize(0), i6 = 0; i6 < 2 * this.rd.length; i6++)
            this.Ff.add(i6);
          return this.Mt(this.Ff, this.Ff.size, false), this.Tg = this.Ff.size, this.Df != -1 && (this.Bd.eh(this.Df), this.Jj.resize(0), this.Df = -1), this.Yb = 7, this.fJ();
        }, i5.prototype.lS = function() {
          if (this.Bf = this.Xf = -1, 10 > this.Fb.length || 10 > this.rd.length)
            return this.qe = this.Fb.length, this.Yb = 6, true;
          this.sd == null && (this.sd = new t4.ur(true), this.qo = this.sd.getIterator(), this.Md = new t4.ja(0)), this.ff == null && (this.ff = new t4.ur(true), this.qw = this.ff.getIterator(), this.Ff = new t4.ja(0)), this.sd.mr();
          for (var i6 = 0; i6 < this.Fb.length; i6++) {
            var s5 = this.Fb[i6];
            this.sd.Dr(s5.v, s5.C);
          }
          for (this.sd.Hp(), this.ff.mr(), i6 = 0; i6 < this.rd.length; i6++)
            s5 = this.rd[i6], this.ff.Dr(s5.v, s5.C);
          for (this.ff.Hp(), this.Md.Jb(2 * this.Fb.length), this.Ff.Jb(2 * this.rd.length), this.Md.resize(0), this.Ff.resize(0), i6 = 0; i6 < 2 * this.Fb.length; i6++)
            this.Md.add(i6);
          for (i6 = 0; i6 < 2 * this.rd.length; i6++)
            this.Ff.add(i6);
          return this.Mt(this.Md, this.Md.size, true), this.Mt(this.Ff, this.Ff.size, false), this.qe = this.Md.size, this.Tg = this.Ff.size, this.Ef != -1 && (this.Bd.eh(this.Ef), this.Kj.resize(0), this.Ef = -1), this.Df != -1 && (this.Bd.eh(this.Df), this.Jj.resize(0), this.Df = -1), this.Yb = 7, true;
        }, i5.prototype.QX = function() {
          var t5 = this.Md.get(--this.qe), s5 = t5 >> 1;
          return i5.gq(t5) ? (this.sd.remove(s5), this.qe != 0 || (this.Bf = this.Xf = -1, this.Jc = true, false)) : (this.qo.zB(this.Fb[s5].v, this.Fb[s5].C, this.ra), this.Xf = s5, this.Yb = 10, true);
        }, i5.prototype.MX = function() {
          return --this.qe == -1 ? (this.Bf = this.Xf = -1, this.Jc = true, false) : (this.Tg = this.Xf = this.qe, this.Yb = 13, true);
        }, i5.prototype.NX = function() {
          return --this.qe == -1 ? (this.Bf = this.Xf = -1, this.Jc = true, false) : (this.Xf = this.qe, this.Tg = this.rd.length, this.Yb = 14, true);
        }, i5.prototype.OX = function() {
          var t5 = this.Md.get(this.qe - 1), s5 = this.Ff.get(this.Tg - 1), n5 = this.Tr(t5, true), h3 = this.Tr(s5, false);
          return n5 > h3 ? this.tx() : n5 < h3 ? this.dC() : i5.Oz(t5) ? this.tx() : i5.Oz(s5) ? this.dC() : this.tx();
        }, i5.prototype.tx = function() {
          var s5 = this.Md.get(--this.qe), n5 = s5 >> 1;
          if (i5.gq(s5))
            return this.Ef != -1 && this.Kj.get(n5) != -1 ? (this.Bd.kd(this.Ef, this.Kj.get(n5)), this.Kj.set(n5, -1)) : this.sd.remove(n5), this.qe != 0 || (this.Bf = this.Xf = -1, this.Jc = true, false);
          if (this.Df != -1 && 0 < this.Bd.ds(this.Df))
            for (s5 = this.Bd.sc(this.Df); s5 != -1; ) {
              var h3 = this.Bd.getData(s5);
              this.ff.xj(h3), this.Jj.set(h3, -1), h3 = this.Bd.lb(s5), this.Bd.kd(this.Df, s5), s5 = h3;
            }
          return 0 < this.ff.size() ? (this.qw.zB(this.Fb[n5].v, this.Fb[n5].C, this.ra), this.Xf = n5, this.Yb = 12) : (this.Ef == -1 && (this.Bd == null && (this.Bd = new t4.lp()), this.Kj = new t4.ja(0), this.Kj.resize(this.Fb.length, -1), this.Kj.Yj(-1, 0, this.Fb.length), this.Ef = this.Bd.Rh(1)), this.Kj.set(n5, this.Bd.addElement(this.Ef, n5)), this.Yb = 7), true;
        }, i5.prototype.dC = function() {
          var s5 = this.Ff.get(--this.Tg), n5 = s5 >> 1;
          if (i5.gq(s5))
            return this.Df != -1 && this.Jj.get(n5) != -1 ? (this.Bd.kd(this.Df, this.Jj.get(n5)), this.Jj.set(n5, -1)) : this.ff.remove(n5), this.Tg != 0 || (this.Bf = this.Xf = -1, this.Jc = true, false);
          if (this.Ef != -1 && 0 < this.Bd.ds(this.Ef))
            for (s5 = this.Bd.sc(this.Ef); s5 != -1; ) {
              var h3 = this.Bd.getData(s5);
              this.sd.xj(h3), this.Kj.set(h3, -1), h3 = this.Bd.lb(s5), this.Bd.kd(this.Ef, s5), s5 = h3;
            }
          return 0 < this.sd.size() ? (this.qo.zB(this.rd[n5].v, this.rd[n5].C, this.ra), this.Bf = n5, this.Yb = 11) : (this.Df == -1 && (this.Bd == null && (this.Bd = new t4.lp()), this.Jj = new t4.ja(0), this.Jj.resize(this.rd.length, -1), this.Jj.Yj(-1, 0, this.rd.length), this.Df = this.Bd.Rh(0)), this.Jj.set(n5, this.Bd.addElement(this.Df, n5)), this.Yb = 7), true;
        }, i5.prototype.Pz = function() {
          if (this.Bf = this.qo.next(), this.Bf != -1)
            return false;
          var t5 = this.Md.get(this.qe) >> 1;
          return this.sd.xj(t5), this.Yb = 4, true;
        }, i5.prototype.eT = function() {
          if (this.Xf = this.qo.next(), this.Xf != -1)
            return false;
          this.Bf = this.Xf = -1;
          var t5 = this.Ff.get(this.Tg) >> 1;
          return this.ff.xj(t5), this.Yb = 7, true;
        }, i5.prototype.bT = function() {
          if (this.Bf = this.qw.next(), this.Bf != -1)
            return false;
          var t5 = this.Md.get(this.qe) >> 1;
          return this.sd.xj(t5), this.Yb = 7, true;
        }, i5.prototype.cT = function() {
          if (--this.Tg == -1)
            return this.Yb = 5, true;
          this.yq.L(this.Fb[this.qe]);
          var t5 = this.Fb[this.Tg];
          return this.yq.X(this.ra, this.ra), !this.yq.isIntersecting(t5) || (this.Bf = this.Tg, false);
        }, i5.prototype.dT = function() {
          if (--this.Tg == -1)
            return this.Yb = 6, true;
          this.yq.L(this.Fb[this.qe]);
          var t5 = this.rd[this.Tg];
          return this.yq.X(this.ra, this.ra), !this.yq.isIntersecting(t5) || (this.Bf = this.Tg, false);
        }, i5.prototype.fJ = function() {
          return this.sd == null ? (this.Jc = true, false) : (this.qe = this.Md.size, 0 < this.sd.size() && this.sd.reset(), this.Ef != -1 && (this.Bd.eh(this.Ef), this.Kj.resize(0), this.Ef = -1), this.Jc = false, true);
        }, i5.prototype.eJ = function() {
          return this.ff == null ? (this.Jc = true, false) : (this.Tg = this.Ff.size, 0 < this.ff.size() && this.ff.reset(), this.Df != -1 && (this.Bd.eh(this.Df), this.Jj.resize(0), this.Df = -1), this.Jc = false, true);
        }, i5.prototype.Mt = function(i6, s5, h3) {
          this.Cm == null && (this.Cm = new t4.Zt()), h3 = new n4(this, h3), this.Cm.sort(i6, 0, s5, h3);
        }, i5.prototype.FX = function(t5, s5, n5, h3) {
          var r3 = this;
          t5.Wd(s5, n5, function(t6, s6) {
            var n6 = r3.Tr(t6, h3), e3 = r3.Tr(s6, h3);
            return n6 < e3 || n6 == e3 && i5.gq(t6) && i5.Oz(s6) ? -1 : 1;
          });
        }, i5.prototype.Tr = function(t5, s5) {
          var n5 = 0.5 * this.ra;
          return s5 ? (s5 = this.Fb[t5 >> 1], i5.gq(t5) ? s5.G - n5 : s5.H + n5) : (s5 = this.rd[t5 >> 1], i5.gq(t5) ? s5.G - n5 : s5.H + n5);
        }, i5;
      }(), t4.sC = i4;
    }(Q2 || (Q2 = {})), function(t4) {
      var i4 = function() {
        function i5() {
        }
        return i5.construct = function(t5, s4, n4, h3, r3, e3) {
          var o3 = new i5();
          return o3.v = t5, o3.G = s4, o3.Xe = n4, o3.C = h3, o3.H = r3, o3.Dg = e3, o3;
        }, i5.prototype.Pa = function() {
          this.Xe = this.v = NaN;
        }, i5.prototype.B = function() {
          return isNaN(this.v);
        }, i5.prototype.SS = function() {
          return isNaN(this.Xe);
        }, i5.prototype.L = function(t5, i6, s4, n4, h3, r3) {
          n4 !== void 0 ? typeof t5 == "number" ? (this.v = t5, this.G = i6, this.Xe = s4, this.C = n4, this.H = h3, this.Dg = r3) : (this.v = t5.x - 0.5 * i6, this.C = this.v + i6, this.G = t5.y - 0.5 * s4, this.H = this.G + s4, this.Xe = t5.z - 0.5 * n4, this.Dg = this.Xe + n4) : (this.v = t5, this.G = i6, this.Xe = s4, this.C = t5, this.H = i6, this.Dg = s4);
        }, i5.prototype.move = function(t5) {
          this.v += t5.x, this.G += t5.y, this.Xe += t5.z, this.C += t5.x, this.H += t5.y, this.Dg += t5.z;
        }, i5.prototype.copyTo = function(t5) {
          t5.v = this.v, t5.G = this.G, t5.C = this.C, t5.H = this.H;
        }, i5.prototype.Nk = function(t5, i6, s4) {
          this.v > t5 ? this.v = t5 : this.C < t5 && (this.C = t5), this.G > i6 ? this.G = i6 : this.H < i6 && (this.H = i6), isNaN(this.Xe) == 0 ? this.Xe > s4 ? this.Xe = s4 : this.Dg < s4 && (this.Dg = s4) : this.Dg = this.Xe = s4;
        }, i5.prototype.$b = function(s4, n4, h3) {
          if (typeof s4 == "number")
            this.B() ? (this.v = s4, this.G = n4, this.Xe = h3, this.C = s4, this.H = n4, this.Dg = h3) : this.Nk(s4, n4, h3);
          else if (s4 instanceof t4.Od)
            this.$b(s4.x, s4.y, s4.z);
          else {
            if (!(s4 instanceof i5))
              throw t4.i.O();
            s4.B() || (this.$b(s4.v, s4.G, s4.Xe), this.$b(s4.C, s4.H, s4.Dg));
          }
        }, i5.prototype.construct = function(t5, i6, s4) {
          t5.B() || i6.B() ? this.Pa() : (this.v = t5.pa, this.C = t5.wa, this.G = i6.pa, this.H = i6.wa, this.Xe = s4.pa, this.Dg = s4.wa);
        }, i5.prototype.iB = function(i6) {
          if (i6 == null || 8 > i6.length)
            throw t4.i.O();
          i6[0] = new t4.Od(this.v, this.G, this.Xe), i6[1] = new t4.Od(this.v, this.H, this.Xe), i6[2] = new t4.Od(this.C, this.H, this.Xe), i6[3] = new t4.Od(this.C, this.G, this.Xe), i6[4] = new t4.Od(this.v, this.G, this.Dg), i6[5] = new t4.Od(this.v, this.H, this.Dg), i6[6] = new t4.Od(this.C, this.H, this.Dg), i6[7] = new t4.Od(this.C, this.G, this.Dg);
        }, i5.prototype.bx = function(t5) {
          if (t5 == null || t5.length == 0)
            this.Pa();
          else {
            var i6 = t5[0];
            for (this.L(i6.x, i6.y, i6.z), i6 = 1; i6 < t5.length; i6++) {
              var s4 = t5[i6];
              this.Nk(s4.x, s4.y, s4.z);
            }
          }
        }, i5;
      }();
      t4.JK = i4;
    }(Q2 || (Q2 = {})), function(t4) {
      !function(t5) {
        t5.Ra = function() {
          var t6 = Error();
          return t6.message = "Internal Error", t6;
        }, t5.Fe = function() {
          var t6 = Error();
          return t6.message = "Not Implemented", t6;
        }, t5.Zk = function() {
          var t6 = Error();
          return t6.message = "The input unit and the spatial reference unit are not of the same unit type.ie Linear vs.Angular", t6;
        }, t5.Hb = function() {
          var t6 = Error();
          return t6.message = "Invalid Call", t6;
        }, t5.O = function(t6) {
          var i4 = Error();
          return i4.message = "Illegal Argument Exception", t6 !== void 0 && (i4.message += ": " + t6), i4;
        }, t5.hu = function(t6) {
          var i4 = Error();
          return i4.message = t6 !== void 0 ? "Runtime Exception: " + t6 : "Runtime Exception.", i4;
        }, t5.ga = function(t6) {
          var i4 = Error();
          return i4.message = "Geometry Exception: " + t6, i4;
        }, t5.BK = function() {
          var t6 = Error();
          return t6.message = "Assert Failed Exception", t6;
        }, t5.de = function() {
          var t6 = Error();
          return t6.message = "IndexOutOfBoundsException", t6;
        }, t5.RC = function() {
          var t6 = Error();
          return t6.message = "UserCancelException", t6;
        };
      }(t4.i || (t4.i = {}));
    }(Q2 || (Q2 = {})), function(t4) {
      (t4 = t4.dm || (t4.dm = {}))[t4.forward = 0] = "forward", t4[t4.reverse = 1] = "reverse";
    }(Q2 || (Q2 = {})), function(t4) {
      var i4 = function() {
        function i5(t5, i6) {
          this.Xa = t5, this.AH = i6, this.GH = -1, this.ul = false;
        }
        return i5.prototype.re = function() {
        }, i5.prototype.next = function() {
          if (++this.GH == this.AH.I())
            return null;
          var i6 = this.AH.Oa(this.GH);
          i6.scale(this.Xa.fc);
          var s5 = new t4.Ea();
          return this.Xa.ny(i6, this.ul, s5), s5;
        }, i5.prototype.Ma = function() {
          return 0;
        }, i5;
      }(), s4 = function() {
        function i5(i6, s5, n5) {
          this.Xa = i6, this.tw = s5, this.Zn = false, this.fo = n5, this.dw = [0], this.uk = [0], this.Pj = [0], this.Is = [0], this.ul = false, this.sq = new t4.Ea(), this.wk = [];
        }
        return i5.prototype.re = function() {
        }, i5.prototype.next = function() {
          if (this.Zn) {
            this.Zn = false, this.td.ia();
            var i6 = t4.ba.kg(this.sq);
            return t4.Hg.Ok(i6, this.Xa.Cq, true, true, this.Xa.Vb);
          }
          if (this.td == null && (this.td = this.tw.Ha(), this.td.ab(), this.fo != null && this.fo.$k(null, 0)), !this.td.Ia()) {
            if (!this.td.ab())
              return null;
            this.fo != null && this.fo.$k(null, 0);
          }
          i6 = null, this.uk[0] = 0, this.AA = this.dw[0] = 0, this.fi = NaN, this.Zn = false;
          for (var s5 = this.wk.length = 0, h3 = new t4.h(), r3 = new t4.h(), e3 = [0]; this.td.Ia() && 8 > this.AA; ) {
            var o3 = this.td.ia();
            if (h3.N(o3.bc()), r3.N(o3.xc()), h3.scale(this.Xa.fc), r3.scale(this.Xa.fc), t4.ej.Ou(h3, r3) ? h3.x = r3.x : t4.ej.Mu(h3, r3) && (r3.x = h3.x), this.wk.length = 0, t4.ej.oF(this.Xa.Ub, this.Xa.lc, this.Xa.Ae, h3, r3, this.Xa.LA, this.Xa.at, e3, this.Pj, this.Is, this.wk, this.dw), this.fo != null && (o3 = this.wk.slice(0), this.fo.lG(this.fo.ea() - 1, o3, o3.length - 1)), t4.ej.Nu(h3, r3) ? (this.sq.Pa(), this.Xa.ny(h3, this.ul, this.sq), this.Zn = true) : (this.sq.Pa(), this.Zn = this.sy(e3[0], this.sq)), this.Zn) {
              if (this.td.ni(), this.td.zz()) {
                this.td.ni(), this.td.ia();
                break;
              }
              this.td.xW();
              break;
            }
            i6 == null && (i6 = new t4.Ea()).$k(null, 0), this.JD(i6), s5++;
          }
          if (this.dw[0] = 0, 0 < s5) {
            for (e3 = this.td.xb(); 0 < s5; )
              this.td.ni(), h3.N(this.tw.Oa(this.td.xb())), r3.N(this.tw.Oa(this.td.kk())), h3.scale(this.Xa.fc), r3.scale(this.Xa.fc), this.ul && (t4.ej.Ou(h3, r3) ? h3.x = r3.x : t4.ej.Mu(h3, r3) && (r3.x = h3.x)), this.wk.length = 0, t4.ej.oF(this.Xa.Ub, this.Xa.lc, this.Xa.Ae, r3, h3, this.Xa.LA, this.Xa.at, null, this.Pj, this.Is, this.wk, this.dw), this.JD(i6), s5--;
            return h3.N(this.tw.Oa(this.td.xb())), h3.scale(this.Xa.fc), n4.Jr(this.Xa.Ub, this.Xa.lc, this.Xa.fc, this.Xa.sb, h3, this.fi + 1.570796326794897, this.fi + 4.71238898038469, this.Xa.co, this.ul, this.uk, i6, NaN, NaN), this.td.Wb(e3), this.td.ia(), s5 = t4.ua.mj(null, i6, true), t4.Hg.Ok(i6, s5, true, true, this.Xa.Vb);
          }
          return this.Zn = false, this.td.ia(), i6 = t4.ba.kg(this.sq), t4.Hg.Ok(i6, this.Xa.Cq, true, true, this.Xa.Vb);
        }, i5.prototype.JD = function(i6) {
          var s5 = this.wk[0], h3 = this.Pj[0] - 1.570796326794897, r3 = this.Is[0] + 1.570796326794897;
          if (!isNaN(this.fi)) {
            if (this.fi >= this.Pj[0]) {
              var e3 = this.fi + 1.570796326794897;
              h3 = e3 + 3.141592653589793 - (this.fi - this.Pj[0]);
            } else
              h3 = (e3 = this.fi + 1.570796326794897) + 3.141592653589793 - (6.283185307179586 - (this.Pj[0] - this.fi));
            var o3 = !(this.fi >= this.Pj[0] && 3.141592653589793 >= this.fi - this.Pj[0]) && !(this.fi < this.Pj[0] && 3.141592653589793 <= this.Pj[0] - this.fi), a3 = false;
            if (Math.abs(h3 - e3) <= 0.5 * this.Xa.co)
              if (o3) {
                var u3 = i6.Oa(i6.I() - 2);
                u3.scale(this.Xa.fc);
                var f3 = new t4.ha(0);
                for (t4.kb.Sy(this.Xa.Ub, this.Xa.lc, s5.x, s5.y, u3.x, u3.y, f3), u3 = f3.u; u3 <= e3; )
                  u3 += 6.283185307179586;
                for (; u3 > e3; )
                  u3 -= 6.283185307179586;
                u3 < h3 && (a3 = true);
              } else
                a3 = true;
            a3 ? (i6.yB(0, i6.I() - 1), this.ul || ((s5 = new t4.h()).N(i6.Oa(i6.I() - 1)), s5.scale(this.Xa.fc), -3.141592653589793 > s5.x - this.uk[0] ? this.uk[0] -= 6.283185307179586 : 3.141592653589793 < s5.x - this.uk[0] && (this.uk[0] += 6.283185307179586)), o3 || (h3 = 0.5 * (h3 + e3))) : (o3 ? ((e3 = new t4.h()).N(s5), e3.scale(1 / this.Xa.fc), i6.xf(0, -1, e3)) : n4.Jr(this.Xa.Ub, this.Xa.lc, this.Xa.fc, this.Xa.sb, this.wk[0], e3, h3, this.Xa.co, this.ul, this.uk, i6, NaN, NaN), this.AA += 1);
          }
          n4.my(this.Xa.Ub, this.Xa.lc, this.Xa.fc, this.Xa.sb, this.Xa.Ae, this.wk, h3, r3, this.ul, this.uk, i6), this.fi = this.Is[0];
        }, i5.prototype.sy = function(t5, i6) {
          return this.Xa.sy(this.wk, t5, this.Pj[0], this.Is[0], this.ul, i6);
        }, i5.prototype.Ma = function() {
          return 0;
        }, i5;
      }(), n4 = function() {
        function n5() {
        }
        return n5.buffer = function(i5, s5, h3, r3, e3, o3) {
          if (i5 == null)
            throw t4.i.O("Geometry::Geodesic_bufferer::buffer");
          if (i5.B())
            return new t4.Ea(i5.description);
          var a3 = new n5();
          a3.Sg = s5, a3.Kc = t4.cb.tc(s5);
          var u3 = t4.cb.xv(a3.Kc);
          if (a3.Vb = o3, a3.Ub = t4.cb.gv(a3.Kc), a3.lc = u3 * (2 - u3), a3.fc = a3.Kc.Id().ci, a3.ra = a3.Sg.Mn(), a3.Cq = a3.Kc.Mn(), a3.at = a3.Cq * a3.fc, a3.Bq = 1.570796326794897 / a3.fc, a3.KY = 3.141592653589793 / a3.fc, a3.Ls = 6.283185307179586 / a3.fc, a3.LY = a3.Ls / 6, a3.GA = 0, a3.JY = 1.5707963267948966 * a3.Ub / a3.GA, h3 == 4 ? (a3.Ae = 2, a3.Yv = true) : (a3.Ae = h3, a3.Yv = false), a3.La = r3, a3.sb = Math.abs(r3), isNaN(e3) || 1e-3 > e3 ? a3.tX() : a3.bo = e3, h3 = i5.K(), t4.ba.zd(h3) ? ((h3 = new t4.Ua(i5.description)).pc(i5, true), i5 = h3, h3 = 1607) : h3 == 197 && (h3 = new t4.l(), i5.A(h3), h3.S() <= a3.ra || h3.da() <= a3.ra ? ((h3 = new t4.Ua(i5.description)).bd(i5, false), i5 = h3, h3 = 1607) : ((h3 = new t4.Ea(i5.description)).bd(i5, false), i5 = h3, h3 = 1736)), a3.uX(), t4.ba.Tn(h3) || a3.vX(), a3.sb <= 0.5 * a3.bo)
            return h3 != 1736 ? new t4.Ea(i5.description) : a3.Yv ? i5 : t4.ej.Sr(i5, a3.Sg, a3.Ae, a3.LA, -1, o3);
          if (0 > a3.La && h3 != 1736)
            return new t4.Ea(i5.description);
          if (a3.Yv && t4.ba.Ic(h3) ? (s5 = t4.ej.Sr(i5, s5, 4, NaN, a3.bo, o3), i5 = t4.cb.Bh(s5, a3.Sg, a3.Kc)) : i5 = t4.cb.Bh(i5, a3.Sg, a3.Kc), (i5 = t4.Jh.nj(i5, a3.Kc)).B())
            return new t4.Ea(i5.description);
          switch (!a3.Yv && t4.ba.Ic(h3) && (i5 = t4.ej.kI(a3.fc, i5)), i5 = n5.GX(i5, a3.Kc), h3) {
            case 1736:
              s5 = a3.PN(i5);
              break;
            case 1607:
              s5 = a3.QN(i5);
              break;
            case 550:
              s5 = a3.NN(i5);
              break;
            case 33:
              s5 = a3.ON(i5);
              break;
            default:
              throw t4.i.ga("corrupted_geometry");
          }
          return (a3 = t4.cb.Bh(s5, a3.Kc, a3.Sg)).Ll(i5.description), a3;
        }, n5.prototype.PN = function(i5) {
          var n6 = new t4.Ea();
          i5 = new s4(this, i5, n6), i5 = t4.Ih.local().W(i5, this.Kc, this.Vb).next(), i5 = t4.kp.pj(i5, this.Kc, 2);
          var h3 = new t4.Ed();
          return h3.scale(1 / this.fc, 1 / this.fc), n6.Pc(h3), n6 = t4.kp.pj(n6, this.Kc, 2), 0 <= this.La ? t4.Ih.local().W(n6, i5, this.Kc, this.Vb) : t4.mp.local().W(n6, i5, this.Kc, this.Vb);
        }, n5.prototype.QN = function(i5) {
          return i5 = new s4(this, i5, null), i5 = t4.Ih.local().W(i5, this.Kc, this.Vb).next(), t4.kp.pj(i5, this.Kc, 2);
        }, n5.prototype.NN = function(s5) {
          return s5 = new i4(this, s5), s5 = t4.Ih.local().W(s5, this.Kc, this.Vb).next(), t4.kp.pj(s5, this.Kc, 2);
        }, n5.prototype.ON = function(i5) {
          (i5 = i5.D()).scale(this.fc);
          var s5 = new t4.Ea();
          return this.ny(i5, false, s5), t4.kp.pj(s5, this.Kc, 2);
        }, n5.prototype.sy = function(i5, s5, h3, r3, e3, o3) {
          var a3 = i5[0], u3 = i5[i5.length - 1], f3 = a3.y > u3.y ? a3.y : u3.y, c3 = t4.F.q(this.Ub, this.lc, a3.y < u3.y ? a3.y : u3.y);
          if (f3 = t4.F.q(this.Ub, this.lc, f3), 1e-3 < this.GA - (c3 + s5 + this.sb) && 1e-3 < this.GA + (f3 - s5 - this.sb))
            return false;
          c3 = (s5 = h3 - 1.570796326794897) - 3.141592653589793, f3 = s5 + 3.141592653589793;
          var l3 = (h3 = r3 + 1.570796326794897) + 3.141592653589793, p3 = [NaN], v3 = [NaN], y3 = [NaN], b3 = [NaN];
          if (r3 = false, n5.ZI(this.Ub, this.lc, this.sb, a3, s5, c3, u3, h3, p3, v3), n5.ZI(this.Ub, this.lc, this.sb, u3, l3, h3, a3, c3, y3, b3), (h3 < p3[0] && p3[0] < l3 || h3 < v3[0] && v3[0] < l3) && (r3 = true), r3 || (c3 < y3[0] && y3[0] < s5 || c3 < b3[0] && b3[0] < s5) && (r3 = true), !r3 && e3)
            return false;
          for (var d3 = [], g3 = i5.length - 1; 0 <= g3; g3--)
            d3.push(i5[g3]);
          return o3.Pa(), o3.$k(null, 0), g3 = [0], n5.my(this.Ub, this.lc, this.fc, this.sb, this.Ae, i5, s5, h3, e3, g3, o3), n5.Jr(this.Ub, this.lc, this.fc, this.sb, u3, h3, l3, this.co, e3, g3, o3, p3[0], v3[0]), n5.my(this.Ub, this.lc, this.fc, this.sb, this.Ae, d3, l3, f3, e3, g3, o3), n5.Jr(this.Ub, this.lc, this.fc, this.sb, a3, c3, s5, this.co, e3, g3, o3, y3[0], b3[0]), i5 = false, e3 || (i5 = this.DE(this.fc, o3)), r3 || i5;
        }, n5.prototype.ny = function(t5, i5, s5) {
          s5.Pa(), s5.$k(null, 0), n5.Jr(this.Ub, this.lc, this.fc, this.sb, t5, -this.co, 6.283185307179586, this.co, i5, [0], s5, NaN, NaN), i5 || this.DE(this.fc, s5);
        }, n5.prototype.DE = function(t5, i5) {
          var s5 = this.qO(t5, i5);
          return t5 = this.rO(t5, i5), s5 || t5;
        }, n5.prototype.qO = function(i5, s5) {
          var n6 = s5.I(), h3 = false, r3 = new t4.l();
          if (s5.A(r3), !t4.s.$(r3.H * i5, 1.570796326794897) && !t4.s.$(r3.G * i5, -1.570796326794897))
            return false;
          var e3 = new t4.h();
          for (--n6; 0 <= n6; n6--)
            s5.D(n6, e3), (e3.y == r3.H && t4.s.$(e3.y * i5, 1.570796326794897) || e3.y == r3.G && t4.s.$(e3.y * i5, -1.570796326794897)) && (h3 = true, this.JI(e3, n6, s5));
          return h3;
        }, n5.prototype.rO = function(t5, i5) {
          var s5 = i5.Oa(0), n6 = i5.Oa(i5.I() - 1);
          return 3.141592653589793 < Math.abs(s5.x - n6.x) * t5 ? (this.QV(i5), true) : this.pO(i5);
        }, n5.prototype.pO = function(t5) {
          return 0 > t5.He() && (this.PV(t5), true);
        }, n5.prototype.JI = function(i5, s5, n6) {
          var h3 = n6.I(), r3 = 0 < s5 ? s5 - 1 : h3 - 1;
          if (h3 = n6.Oa(s5 < h3 - 1 ? s5 + 1 : 0), r3 = n6.Oa(r3), !t4.s.$(h3.y, i5.y) && !t4.s.$(h3.x, i5.x)) {
            var e3 = new t4.h();
            e3.na(h3.x, i5.y), n6.Db(s5, e3);
          }
          t4.s.$(r3.y, i5.y) || t4.s.$(r3.x, i5.x) || ((h3 = new t4.h()).na(r3.x, i5.y), n6.xf(0, s5, h3));
        }, n5.prototype.QV = function(i5) {
          var s5 = new t4.Ea(), n6 = new t4.Ea(), h3 = new t4.Ed(), r3 = i5.Oa(0), e3 = i5.Oa(i5.I() - 1), o3 = new t4.h();
          r3.x > e3.x ? (e3 = this.Bq, h3.ig(-this.Ls, 0)) : (e3 = -this.Bq, h3.ig(this.Ls, 0)), s5.add(i5, false), i5.Pa(), n6.add(s5, false), n6.Pc(h3), r3 = new t4.l(), n6.A(r3), r3.X((this.Ls - r3.S()) / 2, 0), r3.G = -this.Bq, r3.H = this.Bq;
          for (var a3 = 0; a3 < n6.I(); a3++)
            n6.D(a3, o3), s5.xf(0, -1, o3);
          for (n6.Pc(h3), a3 = 0; a3 < n6.I(); a3++)
            n6.D(a3, o3), s5.xf(0, -1, o3);
          n6 = s5.Oa(0), h3 = s5.Oa(s5.I() - 1), o3.na(h3.x, e3), s5.xf(0, -1, o3), o3.na(0.5 * (h3.x + n6.x), e3), s5.xf(0, -1, o3), o3.na(n6.x, e3), s5.xf(0, -1, o3), s5 = t4.Jh.ms(s5, this.Kc, 2, true, r3.v), s5 = t4.Jh.ms(s5, this.Kc, 2, true, r3.C), s5 = t4.Vd.clip(s5, r3, this.Cq, NaN), i5.add(s5, false);
        }, n5.prototype.PV = function(i5) {
          var s5 = new t4.l();
          i5.A(s5), s5.X((this.Ls - s5.S()) / 2, 0), s5.G = -this.Bq, s5.H = this.Bq, i5.$k(null, 0);
          var n6 = new t4.h();
          n6.na(s5.v, s5.G), i5.xf(1, -1, n6), n6.na(s5.v, s5.H), i5.xf(1, -1, n6), n6.na(0.5 * (s5.v + s5.C), s5.H), i5.xf(1, -1, n6), n6.na(s5.C, s5.H), i5.xf(1, -1, n6), n6.na(s5.C, s5.G), i5.xf(1, -1, n6), n6.na(0.5 * (s5.v + s5.C), s5.G), i5.xf(1, -1, n6);
        }, n5.my = function(i5, s5, h3, r3, e3, o3, a3, u3, f3, c3, l3) {
          var p3 = null;
          f3 || ((p3 = new t4.h()).Sc(), 0 < l3.I() && (p3.N(l3.Oa(l3.I() - 1)), p3.scale(h3)));
          var v3 = new t4.ha(0), y3 = new t4.ha(0), b3 = new t4.ha(0), d3 = new t4.h(), g3 = new t4.h(), w3 = o3[o3.length - 1];
          h3 = 1 / h3;
          for (var x3 = 0; x3 < o3.length; x3++) {
            var m3 = o3[x3];
            if (x3 == 0)
              var j3 = a3;
            else
              x3 == o3.length - 1 ? j3 = u3 : (t4.kb.xd(i5, s5, w3.x, w3.y, m3.x, m3.y, null, null, v3, e3), j3 = v3.u - 1.570796326794897);
            t4.kb.Ai(i5, s5, m3.x, m3.y, r3, j3, y3, b3), f3 ? g3.na(y3.u, b3.u) : (d3.na(y3.u, b3.u), n5.bJ(m3.x, d3.x, p3.x, c3), g3.na(c3[0] + d3.x, d3.y), p3.N(g3)), g3.scale(h3), l3.xf(0, -1, g3);
          }
        }, n5.Jr = function(i5, s5, h3, r3, e3, o3, a3, u3, f3, c3, l3, p3, v3) {
          if (!(a3 - o3 < u3)) {
            var y3 = new t4.ha(0), b3 = new t4.ha(0), d3 = new t4.h(), g3 = new t4.h(), w3 = null;
            f3 || ((w3 = new t4.h()).Sc(), 0 < l3.I() && (w3.N(l3.Oa(l3.I() - 1)), w3.scale(h3)));
            var x3 = t4.P.truncate(Math.ceil(o3 / u3)), m3 = x3++ * u3;
            for (m3 == o3 && (m3 = x3++ * u3), h3 = 1 / h3; m3 < a3 + u3 && (o3 < p3 && p3 < m3 ? (m3 = p3, x3--) : o3 < v3 && v3 < m3 && (m3 = v3, x3--), !(m3 >= a3)); )
              t4.kb.Ai(i5, s5, e3.x, e3.y, r3, m3, y3, b3), f3 ? g3.na(y3.u, b3.u) : (d3.na(y3.u, b3.u), n5.bJ(e3.x, d3.x, w3.x, c3), g3.na(c3[0] + d3.x, d3.y), w3.N(g3)), g3.scale(h3), l3.xf(0, -1, g3), o3 = m3, m3 = x3++ * u3;
          }
        }, n5.ZI = function(i5, s5, n6, h3, r3, e3, o3, a3, u3, f3) {
          var c3 = new t4.h(), l3 = new t4.h(), p3 = new t4.ha(0), v3 = new t4.ha(0);
          for (t4.kb.Ai(i5, s5, h3.x, h3.y, n6, r3, p3, v3), c3.na(p3.u, v3.u), t4.kb.Ai(i5, s5, h3.x, h3.y, n6, e3, p3, v3), l3.na(p3.u, v3.u), n6 = new t4.ha(0), t4.kb.Sy(i5, s5, o3.x, o3.y, c3.x, c3.y, n6), u3[0] = n6.u, t4.kb.Sy(i5, s5, o3.x, o3.y, l3.x, l3.y, n6), f3[0] = n6.u; u3[0] <= f3[0]; )
            u3[0] += 6.283185307179586;
          for (; u3[0] > f3[0]; )
            u3[0] -= 6.283185307179586;
          for (; u3[0] >= a3; )
            u3[0] -= 6.283185307179586, f3[0] -= 6.283185307179586;
          for (; u3[0] < a3; )
            u3[0] += 6.283185307179586, f3[0] += 6.283185307179586;
        }, n5.bJ = function(t5, i5, s5, n6) {
          if (isNaN(s5)) {
            for (; 3.141592653589793 < n6[0] + i5 - t5; )
              n6[0] -= 6.283185307179586;
            for (; 3.141592653589793 < t5 - (n6[0] + i5); )
              n6[0] += 6.283185307179586;
          } else
            3.141592653589793 < n6[0] + i5 - s5 ? n6[0] -= 6.283185307179586 : 3.141592653589793 < s5 - (n6[0] + i5) && (n6[0] += 6.283185307179586);
        }, n5.GX = function(i5, s5) {
          var n6 = i5.K(), h3 = t4.ba.Ic(n6) ? i5.ea() : n6 == 550 ? i5.I() : 1;
          if (h3 == 1)
            return i5;
          var r3 = new t4.ja(0);
          r3.resize(h3);
          for (var e3 = [], o3 = new t4.l(), a3 = 0; a3 < h3; a3++) {
            if (r3.write(a3, a3), t4.ba.Ic(n6)) {
              i5.Tj(a3, o3);
              var u3 = o3.tf();
            } else
              u3 = i5.Oa(a3);
            u3 = t4.SK.WX(s5, u3), e3[a3] = u3;
          }
          for (r3.Wd(0, r3.size, function(t5, i6) {
            return e3[t5] < e3[i6] ? -1 : e3[t5] > e3[i6] ? 1 : 0;
          }), s5 = i5.Ja(), a3 = 0; a3 < h3; a3++)
            o3 = r3.read(a3), t4.ba.Ic(n6) ? s5.addPath(i5, o3, true) : s5.Gd(i5, o3, o3 + 1);
          return s5;
        }, n5.prototype.uX = function() {
          var i5 = Math.min(3.141592653589793 * this.Ub - this.sb, this.sb);
          i5 = Math.min(i5, 0.39269908169872414 * this.Ub);
          var s5 = new t4.h();
          s5.na(0, 10 * this.fc);
          var n6 = 45 * this.fc, h3 = new t4.ha(0), r3 = new t4.ha(0), e3 = new t4.ha(0), o3 = new t4.ha(0), a3 = new t4.ha(0), u3 = new t4.ha(0), f3 = new t4.ha(0), c3 = new t4.ha(0), l3 = new t4.h(), p3 = new t4.h(), v3 = new t4.h(), y3 = new t4.h();
          t4.kb.Ai(this.Ub, this.lc, s5.x, s5.y, i5, 0, h3, r3), l3.na(h3.u, r3.u), t4.kb.Ai(this.Ub, this.lc, s5.x, s5.y, i5, n6, e3, o3), p3.na(e3.u, o3.u), h3 = new t4.ha(0), r3 = new t4.ha(0);
          for (var b3 = new t4.ha(0); t4.kb.Ai(this.Ub, this.lc, s5.x, s5.y, i5, 0.5 * (0 + n6), a3, u3), v3.na(a3.u, u3.u), t4.kb.xd(this.Ub, this.lc, l3.x, l3.y, p3.x, p3.y, h3, r3, null, 2), t4.kb.qj(this.Ub, this.lc, l3.x, l3.y, 0.5 * h3.u, r3.u, f3, c3, 2), y3.na(f3.u, c3.u), t4.kb.xd(this.Ub, this.lc, v3.x, v3.y, y3.x, y3.y, b3, null, null, 2), !(b3.u <= this.bo); )
            n6 *= 0.9, t4.kb.Ai(this.Ub, this.lc, s5.x, s5.y, i5, n6, e3, o3), p3.na(e3.u, o3.u);
          this.co = 6.283185307179586 / Math.ceil(6.283185307179586 / (n6 - 0));
        }, n5.prototype.vX = function() {
          var i5 = Math.min(3.141592653589793 * this.Ub - this.sb, this.sb);
          i5 = Math.min(i5, 0.39269908169872414 * this.Ub);
          var s5 = new t4.h(), n6 = new t4.h();
          s5.na(0, 10 * this.fc), n6.na(10 * this.fc, 10 * this.fc);
          var h3 = new t4.ha(0), r3 = new t4.ha(0), e3 = new t4.ha(0);
          t4.kb.xd(this.Ub, this.lc, s5.x, s5.y, n6.x, n6.y, e3, h3, r3, this.Ae);
          var o3 = new t4.ha(0), a3 = new t4.ha(0), u3 = new t4.ha(0), f3 = new t4.ha(0), c3 = new t4.h(), l3 = new t4.ha(0), p3 = new t4.ha(0), v3 = new t4.ha(0), y3 = new t4.ha(0), b3 = new t4.ha(0), d3 = new t4.ha(0), g3 = new t4.ha(0), w3 = new t4.ha(0), x3 = new t4.ha(0), m3 = new t4.h(), j3 = new t4.h(), M3 = new t4.h(), k3 = new t4.h(), z3 = 1;
          h3 = h3.u, r3 = r3.u + 1.570796326794897, e3 = e3.u, t4.kb.Ai(this.Ub, this.lc, s5.x, s5.y, i5, h3 - 1.570796326794897, p3, v3), m3.na(p3.u, v3.u), t4.kb.Ai(this.Ub, this.lc, n6.x, n6.y, i5, r3, y3, b3), j3.na(y3.u, b3.u), p3 = new t4.ha(0), v3 = new t4.ha(0), r3 = new t4.ha(0);
          for (var A3 = new t4.ha(0); t4.kb.qj(this.Ub, this.lc, s5.x, s5.y, 0.5 * (0 + z3) * e3, h3, o3, a3, this.Ae), c3.na(o3.u, a3.u), t4.kb.xd(this.Ub, this.lc, s5.x, s5.y, c3.x, c3.y, null, null, l3, this.Ae), t4.kb.Ai(this.Ub, this.lc, c3.x, c3.y, i5, l3.u + 1.570796326794897, d3, g3), M3.na(d3.u, g3.u), t4.kb.xd(this.Ub, this.lc, m3.x, m3.y, j3.x, j3.y, p3, v3, null, 2), t4.kb.qj(this.Ub, this.lc, m3.x, m3.y, 0.5 * p3.u, v3.u, w3, x3, 2), k3.na(w3.u, x3.u), t4.kb.xd(this.Ub, this.lc, M3.x, M3.y, k3.x, k3.y, r3, null, null, 2), !(r3.u <= this.bo); )
            z3 *= 0.9, t4.kb.qj(this.Ub, this.lc, s5.x, s5.y, z3 * e3, h3, u3, f3, this.Ae), n6.na(u3.u, f3.u), t4.kb.xd(this.Ub, this.lc, s5.x, s5.y, n6.x, n6.y, null, null, A3, this.Ae), t4.kb.Ai(this.Ub, this.lc, n6.x, n6.y, i5, A3.u + 1.570796326794897, y3, b3), j3.na(y3.u, b3.u);
          1e5 < (i5 = z3 * e3) && (i5 = 1e5), this.LA = i5;
        }, n5.prototype.tX = function() {
          var t5 = 5e4 < this.sb ? 100 : 1e4 < this.sb ? 10 : 1;
          500 > this.sb / t5 && (t5 = this.sb / 500), 0.01 > t5 && (t5 = 0.01), this.bo = t5;
        }, n5;
      }();
      t4.QK = n4;
    }(Q2 || (Q2 = {})), function(t4) {
      var i4 = function() {
        function i5() {
        }
        return i5.Of = function(i6, s4) {
          var n4 = new t4.h();
          n4.N(s4), i6.push(n4);
        }, i5.wp = function(t5, i6) {
          t5.add(i6.x), t5.add(i6.y);
        }, i5.cB = function(t5) {
          t5.Dh(t5.size - 2);
        }, i5.jB = function(t5, i6) {
          i6.na(t5.get(t5.size - 2), t5.get(t5.size - 1));
        }, i5.Sr = function(s4, n4, h3, r3, e3, o3) {
          if (s4 == null)
            throw t4.i.O();
          var a3 = s4.K();
          if (s4.B() || t4.ba.Tn(a3))
            return s4;
          var u3 = new i5();
          u3.Sg = n4, u3.Kc = t4.cb.tc(n4);
          var f3 = t4.cb.xv(u3.Kc);
          if (u3.Vb = o3, u3.Ub = t4.cb.gv(u3.Kc), u3.lc = f3 * (2 - f3), u3.fc = u3.Kc.Id().ci, u3.Cq = u3.Kc.Mn(), u3.at = u3.Cq * u3.fc, u3.vA = r3, u3.uA = e3, u3.Ae = h3, a3 == 197 ? (h3 = new t4.Ea(s4.description)).bd(s4, false) : t4.ba.zd(a3) ? (h3 = new t4.Ua(s4.description)).pc(s4, true) : h3 = s4, u3.Ae != 4) {
            if ((n4 = u3.Sg.Nb(u3.Kc) == 0 ? t4.cb.Bh(h3, u3.Sg, u3.Kc) : t4.Jh.nj(h3, u3.Kc)).B())
              return n4;
            n4 = i5.kI(u3.fc, n4), n4 = u3.Uy(n4), n4 = t4.kp.pj(n4, u3.Kc, u3.Ae), u3 = t4.cb.Bh(n4, u3.Kc, u3.Sg);
          } else {
            if (t4.Gg.Tb(n4) == 2 ? (s4 = t4.cb.ol(), (n4 = t4.Zj.local().W(h3, s4, n4, o3)) == s4 && (n4 = new t4.Ea(), s4.copyTo(n4))) : n4 = t4.Jh.nj(h3, u3.Kc), n4.B())
              return n4;
            u3 = u3.yX(n4);
          }
          return u3;
        }, i5.kI = function(s4, n4) {
          var h3 = new t4.l();
          if (n4.yc(h3), 3.141592653589793 > h3.S() * s4)
            return n4;
          var r3 = false;
          h3 = n4.Ha();
          for (var e3 = new t4.h(), o3 = new t4.h(); h3.ab(); )
            for (; h3.Ia(); ) {
              var a3 = h3.ia();
              if (e3.N(a3.bc()), o3.N(a3.xc()), e3.scale(s4), o3.scale(s4), 3.141592653589793 < Math.abs(e3.x - o3.x)) {
                var u3 = i5.Nu(e3, o3);
                if (!u3) {
                  r3 = true;
                  break;
                }
                if (6.283185307179586 < Math.abs(e3.x - o3.x)) {
                  r3 = true;
                  break;
                }
              }
            }
          if (!r3)
            return n4;
          r3 = n4.Ja();
          var f3 = 1 < n4.description.Ba, c3 = new t4.h(), l3 = new t4.h(), p3 = new t4.h(), v3 = new t4.h(), y3 = new t4.Ta();
          for (h3.aj(); h3.ab(); )
            for (var b3 = NaN, d3 = [0]; h3.Ia(); ) {
              if (a3 = h3.ia(), e3.N(a3.bc()), o3.N(a3.xc()), e3.scale(s4), o3.scale(s4), isNaN(b3) ? (i5.Yi(e3.x, NaN, d3), l3.N(e3)) : l3.N(p3), b3 = l3.x, u3 = i5.Nu(e3, o3)) {
                if (6.283185307179586 < o3.x - e3.x)
                  for (; 6.283185307179586 < o3.x - e3.x; )
                    o3.x -= 6.283185307179586;
                if (-6.283185307179586 > o3.x - e3.x)
                  for (; -6.283185307179586 > o3.x - e3.x; )
                    o3.x += 6.283185307179586;
                i5.Yi(o3.x, NaN, d3), p3.N(o3);
              } else
                c3.N(o3), i5.vU(c3), i5.Yi(c3.x, b3, d3), p3.na(d3[0] + c3.x, c3.y);
              0.5 > Math.abs(p3.x - o3.x) && p3.N(o3), f3 ? (a3.Vw(0, y3), v3.N(l3), v3.scale(1 / s4), y3.Db(v3), (u3 = h3.xm()) ? r3.nf(y3) : r3.lineTo(y3), h3.Sn() && !n4.ec(h3.gb) && (a3.Vw(1, y3), v3.N(p3), v3.scale(1 / s4), y3.Db(v3), r3.lineTo(y3))) : ((u3 = h3.xm()) && r3.Cz(null, 0), a3 = r3.ea() - 1, v3.N(l3), v3.scale(1 / s4), r3.xf(a3, -1, v3), h3.Sn() && !n4.ec(h3.gb) && (v3.N(p3), v3.scale(1 / s4), r3.xf(a3, -1, v3)));
            }
          return r3;
        }, i5.oF = function(s4, n4, h3, r3, e3, o3, a3, u3, f3, c3, l3, p3) {
          var v3 = new t4.h(), y3 = new t4.h(), b3 = 0 < r3.compare(e3);
          i5.aJ(b3, r3, e3, v3, y3), i5.pF(s4, n4, h3, v3, y3, o3, NaN, a3, u3, f3, c3, null, l3, p3), b3 && i5.aC(f3, c3, null, l3);
        }, i5.prototype.Uy = function(s4) {
          var n4 = s4.Ja(), h3 = s4.Ha(), r3 = [], e3 = null, o3 = null, a3 = 1 < s4.description.Ba;
          a3 && (e3 = new t4.ce(0), o3 = new t4.jg());
          for (var u3 = [0], f3 = new t4.h(), c3 = new t4.h(), l3 = new t4.h(), p3 = new t4.h(); h3.ab(); )
            for (u3[0] = 0; h3.Ia(); ) {
              var v3 = h3.ia();
              f3.N(v3.bc()), c3.N(v3.xc()), f3.scale(this.fc), c3.scale(this.fc);
              var y3 = 0 < f3.compare(c3);
              i5.aJ(y3, f3, c3, l3, p3), r3.length = 0, e3 != null && e3.Dh(0), 0 < this.vA ? i5.pF(this.Ub, this.lc, this.Ae, l3, p3, this.vA, this.uA, this.at, null, null, null, a3 ? e3 : null, r3, u3) : i5.WQ(this.Ub, this.lc, this.Ae, l3, p3, this.uA, this.at, a3 ? e3 : null, r3, u3), y3 && i5.aC(null, null, a3 ? e3 : null, r3), r3[0].N(v3.bc()), r3[r3.length - 1].N(v3.xc());
              for (var b3 = 1; b3 < r3.length - 1; b3++)
                r3[b3].scale(1 / this.fc);
              a3 ? (y3 = i5.$I(y3, v3, o3), i5.OD(h3.xm(), h3.Sn() && !s4.ec(h3.gb), v3, y3, e3, r3, n4)) : i5.ND(h3.xm(), h3.Sn() && !s4.ec(h3.gb), r3, n4);
            }
          return n4;
        }, i5.prototype.yX = function(s4) {
          var n4 = s4.Ja(), h3 = s4.Ha(), r3 = [], e3 = null, o3 = new t4.jg(), a3 = 1 < s4.description.Ba;
          for (a3 && (e3 = new t4.ce(0)); h3.ab(); )
            for (; h3.Ia(); ) {
              var u3 = h3.ia(), f3 = u3.bc(), c3 = u3.xc();
              f3 = 0 < f3.compare(c3), c3 = i5.$I(f3, u3, o3), r3.length = 0, e3 != null && e3.Dh(0), i5.xX(this.Ub, this.lc, this.fc, c3, this.Sg, this.vA, this.uA, a3 ? e3 : null, r3), f3 && i5.aC(null, null, a3 ? e3 : null, r3), a3 ? i5.OD(h3.xm(), h3.Sn() && !s4.ec(h3.gb), u3, c3, e3, r3, n4) : i5.ND(h3.xm(), h3.Sn() && !s4.ec(h3.gb), r3, n4);
            }
          return n4;
        }, i5.ND = function(t5, i6, s4, n4) {
          t5 && n4.Cz(null, 0), t5 = n4.ea() - 1;
          var h3 = s4.slice(0);
          n4.lG(t5, h3, h3.length - 1), i6 && n4.xf(t5, -1, s4[s4.length - 1]);
        }, i5.OD = function(i6, s4, n4, h3, r3, e3, o3) {
          var a3 = new t4.Ta();
          if (n4.Vo(a3), i6 ? o3.nf(a3) : o3.lineTo(a3), 2 < e3.length) {
            i6 = h3.Rb();
            for (var u3 = 1; u3 < e3.length - 1; u3++) {
              var f3 = h3.IG(r3.get(u3) * i6);
              h3.Vw(f3, a3), a3.Db(e3[u3]), o3.lineTo(a3);
            }
          }
          s4 && (n4.Ro(a3), o3.lineTo(a3));
        }, i5.pF = function(s4, n4, h3, r3, e3, o3, a3, u3, f3, c3, l3, p3, v3, y3) {
          var b3 = new t4.ha(0), d3 = new t4.ha(0), g3 = new t4.ha(0);
          t4.kb.xd(s4, n4, r3.x, r3.y, e3.x, e3.y, g3, b3, d3, h3), g3 = g3.u;
          var w3 = b3 = b3.u;
          0 > w3 && (w3 += 6.283185307179586), 0 > (d3 = d3.u) && (d3 += 6.283185307179586), f3 != null && (f3[0] = g3), c3 != null && (c3[0] = w3), l3 != null && (l3[0] = d3), c3 = f3 = NaN, p3 != null && (f3 = ((c3 = t4.F.Ch(s4, n4)) - (l3 = t4.F.q(s4, n4, r3.y))) / g3, c3 = (c3 + l3) / g3), l3 = i5.Ou(r3, e3), d3 = i5.Mu(r3, e3), w3 = l3 || d3;
          var x3 = i5.AE(r3, e3, u3), m3 = new t4.ha(0), j3 = new t4.ha(0), M3 = new t4.h(), k3 = new t4.h(), z3 = new t4.h();
          i5.Yi(r3.x, NaN, y3);
          var A3 = [y3[0]];
          if (g3 <= o3)
            i5.Of(v3, r3), i5.Yi(e3.x, NaN, y3), p3 != null && p3.add(0), w3 ? (l3 && i5.fB(r3, e3, p3, v3), d3 && i5.dB(r3, e3, p3, v3)) : x3 ? i5.eB(r3, e3, b3, f3, c3, p3, v3) : 0 < a3 && (k3.na(r3.x - A3[0], r3.y), M3.na(e3.x - y3[0], e3.y), i5.Ty(s4, n4, h3, r3, g3, b3, k3, M3, 0, 1, a3, p3, v3, A3)), i5.Of(v3, e3);
          else {
            var N3 = g3 / ((o3 = 1 + t4.P.truncate(Math.ceil(g3 / o3))) - 1), I3 = new t4.h(), P3 = 0;
            i5.Of(v3, r3), I3.N(r3), k3.na(r3.x - y3[0], r3.y), p3 != null && p3.add(0);
            for (var C3 = 1; C3 < o3; C3++) {
              if (C3 < o3 - 1) {
                t4.kb.qj(s4, n4, r3.x, r3.y, C3 * N3, b3, m3, j3, h3), M3.na(m3.u, j3.u), i5.Yi(M3.x, I3.x, y3), z3.na(y3[0] + M3.x, M3.y);
                var B3 = C3 / (o3 - 1);
              } else
                i5.Yi(e3.x, NaN, y3), M3.na(e3.x - y3[0], e3.y), z3.N(e3), B3 = 1;
              w3 ? (C3 == 1 && l3 && i5.fB(r3, z3, p3, v3), C3 == o3 - 1 && d3 && i5.dB(I3, e3, p3, v3)) : x3 ? i5.zE(I3, z3, u3) && (r3.x < e3.x ? I3.x > z3.x && (y3[0] += 6.283185307179586, z3.na(y3[0] + M3.x, M3.y)) : I3.x < z3.x && (y3[0] -= 6.283185307179586, z3.na(y3[0] + M3.x, M3.y)), i5.eB(I3, z3, b3, f3, c3, p3, v3)) : 0 < a3 && i5.Ty(s4, n4, h3, r3, g3, b3, k3, M3, P3, B3, a3, p3, v3, A3), i5.Of(v3, z3), p3 != null && p3.add(B3), I3.N(z3), k3.N(M3), A3[0] = y3[0], P3 = B3;
            }
          }
        }, i5.WQ = function(s4, n4, h3, r3, e3, o3, a3, u3, f3, c3) {
          var l3 = new t4.ha(0), p3 = new t4.ha(0), v3 = new t4.ha(0);
          t4.kb.xd(s4, n4, r3.x, r3.y, e3.x, e3.y, v3, l3, p3, h3), p3 = v3.u, l3 = l3.u;
          var y3 = v3 = NaN;
          if (u3 != null) {
            y3 = t4.F.Ch(s4, n4);
            var b3 = t4.F.q(s4, n4, r3.y);
            v3 = (y3 - b3) / p3, y3 = (y3 + b3) / p3;
          }
          b3 = i5.Ou(r3, e3);
          var d3 = i5.Mu(r3, e3), g3 = b3 || d3;
          a3 = i5.AE(r3, e3, a3);
          var w3 = i5.Nu(r3, e3);
          w3 = g3 || a3 || w3, i5.Yi(r3.x, NaN, c3);
          var x3 = new t4.h();
          i5.Of(f3, r3), x3.N(r3), u3 != null && u3.add(0), w3 ? (g3 ? (b3 && i5.fB(r3, e3, u3, f3), d3 && i5.dB(r3, e3, u3, f3)) : a3 && i5.eB(r3, e3, l3, v3, y3, u3, f3), i5.Yi(e3.x, NaN, c3), i5.Of(f3, e3)) : p3 <= o3 ? (i5.Yi(e3.x, NaN, c3), i5.Of(f3, e3)) : (v3 = new t4.h(), a3 = new t4.h(), v3.N(r3), a3.N(e3), v3.x -= c3[0], a3.x -= c3[0], -3.141592653589793 > a3.x ? a3.x += 6.283185307179586 : 3.141592653589793 < a3.x && (a3.x -= 6.283185307179586), i5.Ty(s4, n4, h3, r3, p3, l3, v3, a3, 0, 1, o3, u3, f3, c3), i5.Of(f3, e3), i5.Yi(e3.x, NaN, c3)), u3 != null && u3.add(1);
        }, i5.Ty = function(s4, n4, h3, r3, e3, o3, a3, u3, f3, c3, l3, p3, v3, y3) {
          var b3 = new t4.h(), d3 = new t4.h();
          b3.na(a3.x + y3[0], a3.y), new t4.ha(0), new t4.ha(0), new t4.ha(0), new t4.ha(0);
          var g3 = new t4.ha(0), w3 = new t4.ha(0), x3 = new t4.ha(0), m3 = new t4.h(), j3 = new t4.h(), M3 = new t4.h(), k3 = new t4.h();
          m3.N(a3), j3.N(u3), a3 = new t4.ce(0), u3 = new t4.ce(0), i5.wp(a3, j3), u3.add(c3);
          var z3 = new t4.h(), A3 = new t4.zb(), N3 = [];
          for (i5.TJ(4, N3); 0 < a3.size; ) {
            for (var I3, P3 = false, C3 = NaN, B3 = 0; 3 > B3; B3++)
              if (I3 = N3[B3] * c3 + (1 - N3[B3]) * f3, t4.kb.qj(s4, n4, r3.x, r3.y, I3 * e3, o3, g3, w3, h3), M3.na(g3.u, w3.u), B3 == 0 && (C3 = I3, k3.N(M3)), i5.RW(m3, M3, j3, A3), A3.ic(A3.ge(M3, true), z3), t4.kb.xd(s4, n4, M3.x, M3.y, z3.x, z3.y, x3, null, null, 2), x3.u > l3) {
                P3 = true;
                break;
              }
            P3 ? (j3.N(k3), c3 = C3, i5.wp(a3, j3), u3.add(c3)) : (i5.cB(a3), u3.Gn(u3.size - 1, 1, u3.size - 1), 0 < a3.size && (i5.Yi(j3.x, b3.x, y3), d3.na(y3[0] + j3.x, j3.y), i5.Of(v3, d3), b3.N(d3), p3 != null && p3.add(c3), m3.N(j3), f3 = c3, i5.jB(a3, j3), c3 = u3.get(u3.size - 1)));
          }
        }, i5.xX = function(s4, n4, h3, r3, e3, o3, a3, u3, f3) {
          var c3 = new t4.h(), l3 = new t4.h(), p3 = new t4.h(), v3 = new t4.h(), y3 = new t4.h(), b3 = new t4.h(), d3 = new t4.h(), g3 = new t4.h(), w3 = new t4.h(), x3 = new t4.h(), m3 = new t4.ha(0), j3 = new t4.ha(0), M3 = new t4.h(), k3 = [[], []], z3 = t4.Gg.Tb(e3) == 1;
          e3 = e3.Yd(0);
          var A3 = r3.bc(), N3 = r3.xc();
          z3 ? (b3.na(A3.x * h3, A3.y * h3), d3.na(N3.x * h3, N3.y * h3)) : (k3[0][0] = A3.x, k3[0][1] = A3.y, k3[1][0] = N3.x, k3[1][1] = N3.y, t4.cb.wt(), b3.x = k3[0][0] * h3, b3.y = k3[0][1] * h3, d3.x = k3[1][0] * h3, d3.y = k3[1][1] * h3);
          var I3 = 0, P3 = 0, C3 = 1, B3 = r3.Rn();
          c3.N(A3), l3.N(N3), N3 = new t4.ce(0);
          var D3 = new t4.ce(0), q3 = new t4.ce(0);
          i5.wp(N3, l3), i5.wp(D3, d3), q3.add(C3), i5.Of(f3, c3), u3 != null && u3.add(P3);
          var G3 = [], F3 = 0 < a3 ? B3 ? 5 : 3 : B3 ? 5 : 1;
          i5.TJ(F3, G3);
          for (var T3 = new t4.ha(0), E3 = new t4.ha(0), S3 = new t4.ha(0), O3 = new t4.ha(0), H3 = new t4.ha(0), J3 = new t4.ha(0), R3 = new t4.ha(0); 0 < D3.size; ) {
            var L3 = false, K3 = NaN;
            for (t4.kb.xd(s4, n4, b3.x, b3.y, d3.x, d3.y, T3, E3, null, 2), A3 = 0; A3 < F3; A3++) {
              if (A3 == 0) {
                if (!B3 && 0 >= a3 && T3.u <= o3 && 3.141592653589793 > Math.abs(b3.x - d3.x))
                  break;
                if (r3.Tx(P3, C3) <= e3)
                  break;
              }
              var U3 = G3[A3] * C3 + (1 - G3[A3]) * P3;
              if (r3.ic(U3, p3), z3 ? g3.na(p3.x * h3, p3.y * h3) : (k3[0][0] = p3.x, k3[0][1] = p3.y, t4.cb.wt(), g3.x = k3[0][0] * h3, g3.y = k3[0][1] * h3), A3 == 0 && (K3 = U3, y3.N(p3), x3.N(g3), 0 < o3 && (T3.u > o3 || 3.141592653589793 <= Math.abs(b3.x - d3.x)))) {
                L3 = true;
                break;
              }
              if (B3 && 0 < o3) {
                if (t4.kb.xd(s4, n4, b3.x, b3.y, g3.x, g3.y, S3, null, null, 2), S3.u > o3 || 3.141592653589793 <= Math.abs(b3.x - g3.x)) {
                  L3 = true;
                  break;
                }
              } else if (0 < a3) {
                if (B3 ? (v3.IS(c3, l3, G3[A3]), z3 ? w3.na(v3.x * h3, v3.y * h3) : (k3[0][0] = v3.x, k3[0][1] = v3.y, t4.cb.wt(), w3.x = k3[0][0] * h3, w3.y = k3[0][1] * h3)) : (v3.N(p3), w3.N(g3)), t4.kb.xd(s4, n4, b3.x, b3.y, w3.x, w3.y, O3, null, null, 2), !(O3.u <= T3.u)) {
                  L3 = true;
                  break;
                }
                if (t4.kb.qj(s4, n4, b3.x, b3.y, O3.u, E3.u, m3, j3, 2), M3.na(m3.u, j3.u), t4.kb.xd(s4, n4, M3.x, M3.y, g3.x, g3.y, H3, null, null, 2), H3.u > a3) {
                  L3 = true;
                  break;
                }
                if (B3) {
                  if (t4.kb.xd(s4, n4, M3.x, M3.y, w3.x, w3.y, J3, null, null, 2), J3.u > a3) {
                    L3 = true;
                    break;
                  }
                  if (t4.kb.xd(s4, n4, w3.x, w3.y, g3.x, g3.y, R3, null, null, 2), R3.u > a3) {
                    L3 = true;
                    break;
                  }
                }
              }
            }
            L3 ? (l3.N(y3), d3.N(x3), C3 = K3, i5.wp(N3, l3), i5.wp(D3, d3), q3.add(C3)) : (i5.cB(N3), i5.cB(D3), q3.Gn(q3.size - 1, 1, q3.size - 1), i5.Of(f3, l3), I3 += T3.u, u3 != null && u3.add(I3), 0 < D3.size && (c3.N(l3), b3.N(d3), P3 = C3, i5.jB(N3, l3), i5.jB(D3, d3), C3 = q3.get(q3.size - 1)));
          }
          if (u3 != null)
            for (s4 = 1 / I3, A3 = 0; A3 < u3.size; A3++)
              u3.write(A3, u3.read(A3) * s4);
        }, i5.aC = function(t5, i6, s4, n4) {
          n4.reverse(), s4 != null && s4.pi(0, s4.size, 1), s4 = t5 != null ? t5[0] : NaN, n4 = i6 != null ? i6[0] : NaN, t5 != null && (t5[0] = n4), i6 != null && (i6[0] = s4);
        }, i5.aJ = function(t5, i6, s4, n4, h3) {
          t5 ? (n4.N(s4), h3.N(i6)) : (n4.N(i6), h3.N(s4));
        }, i5.$I = function(t5, i6, s4) {
          return t5 ? (s4.create(i6.K()), i6.copyTo(s4.get()), s4.get().reverse(), s4.get()) : i6;
        }, i5.Yi = function(t5, i6, s4) {
          if (isNaN(i6)) {
            for (; 3.141592653589793 < s4[0] - t5; )
              s4[0] -= 6.283185307179586;
            for (; 3.141592653589793 < t5 - s4[0]; )
              s4[0] += 6.283185307179586;
          } else
            3.141592653589793 < s4[0] + t5 - i6 ? s4[0] -= 6.283185307179586 : 3.141592653589793 < i6 - (s4[0] + t5) && (s4[0] += 6.283185307179586);
        }, i5.RW = function(t5, i6, s4, n4) {
          3.141592653589793 > Math.abs(i6.x - t5.x) ? (n4.Ec(t5), 3.141592653589793 <= s4.x - t5.x ? n4.Sl(s4.x - 6.283185307179586, s4.y) : 3.141592653589793 <= t5.x - s4.x ? n4.Sl(s4.x + 6.283185307179586, s4.y) : n4.Sl(s4.x, s4.y)) : (n4.Ec(s4), 3.141592653589793 <= t5.x - s4.x ? n4.Sl(t5.x - 6.283185307179586, t5.y) : 3.141592653589793 <= s4.x - t5.x ? n4.Sl(t5.x + 6.283185307179586, t5.y) : n4.Sl(t5.x, t5.y));
        }, i5.TJ = function(t5, i6) {
          for (var s4 = 0; s4 < t5; s4++) {
            var n4 = Math.ceil(s4 / 2) / (t5 + 1);
            s4 % 2 != 0 && (n4 = -n4), i6[s4] = 0.5 + n4;
          }
        }, i5.Ou = function(i6, s4) {
          return !!(t4.s.$(i6.y, 1.570796326794897) && !t4.s.$(s4.y, 1.570796326794897) || t4.s.$(i6.y, -1.570796326794897) && !t4.s.$(s4.y, -1.570796326794897));
        }, i5.Mu = function(i6, s4) {
          return !!(t4.s.$(s4.y, 1.570796326794897) && !t4.s.$(i6.y, 1.570796326794897) || t4.s.$(s4.y, -1.570796326794897) && !t4.s.$(i6.y, -1.570796326794897));
        }, i5.AE = function(s4, n4, h3) {
          return !(!i5.zE(s4, n4, h3) || t4.s.$(s4.y, 1.570796326794897) || t4.s.$(s4.y, -1.570796326794897) || t4.s.$(n4.y, 1.570796326794897) || t4.s.$(n4.y, -1.570796326794897));
        }, i5.zE = function(t5, i6, s4) {
          return Math.abs(Math.abs(t5.x - i6.x) - 3.141592653589793) <= s4;
        }, i5.Nu = function(i6, s4) {
          return !!(t4.s.$(i6.y, 1.570796326794897) && t4.s.$(s4.y, 1.570796326794897) || t4.s.$(i6.y, -1.570796326794897) && t4.s.$(s4.y, -1.570796326794897));
        }, i5.fB = function(s4, n4, h3, r3) {
          if (0 < s4.y) {
            var e3 = new t4.h();
            e3.na(n4.x, 1.570796326794897);
          } else
            (e3 = new t4.h()).na(n4.x, -1.570796326794897);
          t4.s.$(s4.x, e3.x) || t4.s.$(n4.y, e3.y) || (i5.Of(r3, e3), h3 != null && h3.add(0));
        }, i5.dB = function(s4, n4, h3, r3) {
          if (0 < n4.y) {
            var e3 = new t4.h();
            e3.na(s4.x, 1.570796326794897);
          } else
            (e3 = new t4.h()).na(s4.x, -1.570796326794897);
          t4.s.$(n4.x, e3.x) || t4.s.$(s4.y, e3.y) || (i5.Of(r3, e3), h3 != null && h3.add(1));
        }, i5.eB = function(s4, n4, h3, r3, e3, o3, a3) {
          t4.s.Dd(h3) ? (0 < 1.570796326794897 - s4.y && ((h3 = new t4.h()).na(s4.x, 1.570796326794897), i5.Of(a3, h3), o3 != null && o3.add(r3)), 0 < 1.570796326794897 - n4.y && ((h3 = new t4.h()).na(n4.x, 1.570796326794897), i5.Of(a3, h3), o3 != null && o3.add(r3))) : (0 < 1.570796326794897 + s4.y && ((h3 = new t4.h()).na(s4.x, -1.570796326794897), i5.Of(a3, h3), o3 != null && o3.add(e3)), 0 < 1.570796326794897 + n4.y && ((h3 = new t4.h()).na(n4.x, -1.570796326794897), i5.Of(a3, h3), o3 != null && o3.add(e3)));
        }, i5.vU = function(t5) {
          if (-3.141592653589793 > t5.x)
            for (; -3.141592653589793 > t5.x; )
              t5.x += 6.283185307179586;
          if (3.141592653589793 < t5.x)
            for (; 3.141592653589793 < t5.x; )
              t5.x -= 6.283185307179586;
        }, i5;
      }();
      t4.ej = i4;
    }(Q2 || (Q2 = {})), function(t4) {
      t4.kp = function() {
        function i4() {
        }
        return i4.pj = function(s4, n4, h3) {
          if (s4 == null || n4 == null || !t4.cb.Xc(n4))
            throw t4.i.O();
          if (s4.B())
            return s4;
          var r3 = s4, e3 = r3.K();
          if (t4.ba.Ic(e3)) {
            r3 = t4.Jh.nj(s4, n4), s4 = new t4.l(), r3.A(s4), e3 = t4.ua.Xd(n4, s4, false);
            for (var o3 = t4.cb.ih(n4), a3 = Math.floor((s4.v - o3.v) / o3.S()) * o3.S() + o3.v; a3 < s4.C; )
              a3 > s4.v + e3 && a3 < s4.C - e3 && (r3 = t4.Jh.ms(r3, n4, h3, true, a3)), a3 += o3.S();
          } else {
            if (e3 == 197)
              return (s4 = new t4.Ea(r3.description)).bd(r3, false), i4.pj(s4, n4, h3);
            if (t4.ba.zd(e3))
              return (s4 = new t4.Ua(r3.description)).pc(r3, true), i4.pj(s4, n4, h3);
          }
          return i4.Py(r3, n4);
        }, i4.Py = function(s4, n4) {
          if (s4 == null || n4 == null || !t4.cb.Xc(n4))
            throw t4.i.O();
          if (s4.B())
            return s4;
          var h3 = s4.K();
          return h3 == 197 ? (h3 = new t4.Ea(s4.description)).bd(s4, false) : t4.ba.zd(h3) ? (h3 = new t4.Ua(s4.description)).pc(s4, true) : h3 = s4, (h3 = t4.Jh.nj(h3, n4)).B() ? h3 : t4.Gg.Tb(n4) == 1 ? t4.Jh.Hn(h3, n4, 0, h3 != s4, 0) : i4.IQ(h3, n4, h3 != s4);
        }, i4.IQ = function(i5, s4, n4) {
          if (!t4.cb.Xc(s4))
            throw t4.i.O();
          if (i5.B())
            return i5;
          var h3 = t4.cb.bf(s4), r3 = -180 * h3;
          return h3 *= 360, t4.Gg.Tb(s4) == 2 && (h3 = (r3 = t4.cb.ih(s4)).C, h3 -= r3 = r3.v), t4.Jh.Jp(i5, r3, h3, s4, n4, 0, true);
        }, i4;
      }();
    }(Q2 || (Q2 = {})), function(t4) {
      t4.xY = function() {
        function t5() {
        }
        return t5.R = function(t6) {
          return 0 > t6 ? -t6 : t6;
        }, t5.Mb = function(i4, s4) {
          return 0 <= s4 ? t5.R(i4) : -t5.R(i4);
        }, t5.$ = function(i4, s4) {
          return i4 == s4 || t5.R(i4 - s4) <= t5.EC * (1 + (t5.R(i4) + t5.R(s4)) / 2);
        }, t5.Dd = function(i4) {
          return i4 == 0 || t5.R(i4) <= t5.EC;
        }, t5.Ch = function(i4, s4) {
          var n4 = (s4 = (1 - (s4 = Math.sqrt(1 - s4))) / (1 + s4)) * s4;
          return i4 / (1 + s4) * (1 + n4 * (0.25 + n4 * (0.015625 + 1 / 256 * n4))) * t5.zL;
        }, t5.zL = 1.5707963267948966, t5.EC = 3552713678800501e-30, t5;
      }();
    }(Q2 || (Q2 = {})), function(t4) {
      var i4 = function(t5) {
        this.Yf = t5, this.Mk = this.Yf.getCode(), 0 > this.Mk && (this.Mk = 0);
      };
      t4.zY = i4;
      var s4 = function() {
        function s5(t5) {
          t5 === void 0 && (t5 = null), this.Ej = null, this.Wn = false, t5 !== null && (this.Ej = new i4(t5));
        }
        return s5.prototype.Fc = function() {
          return this.Ej != null ? this.Ej.Mk : 0;
        }, s5.prototype.Qf = function() {
          var t5 = new s5();
          return this.copyTo(t5), t5;
        }, s5.prototype.copyTo = function(t5) {
          t5.Ej = this.Ej, t5.Wn = this.Wn;
        }, s5.prototype.Lz = function() {
          this.Wn = !this.Wn;
        }, s5.prototype.sm = function() {
          return this.Ej != null ? this.Ej.Yf : null;
        }, s5.prototype.GJ = function(s6) {
          if (0 >= s6)
            throw t4.i.O();
          if (s6 != this.Fc()) {
            if ((s6 = t4.qf.geogtran(s6)) == null)
              throw t4.i.O("Geogtran not found.");
            this.Ej = new i4(s6);
          }
        }, s5.prototype.wz = function() {
          return this.Ej == null ? null : this.Ej.Yf.toString();
        }, s5.prototype.pX = function(s6) {
          if (s6 == null)
            throw t4.i.O();
          var n4 = null;
          try {
            n4 = t4.qf.fromString(t4.Tc.PE_TYPE_GEOGTRAN, s6);
          } catch (h3) {
            throw t4.i.O();
          }
          this.Ej = new i4(n4);
        }, s5.prototype.Nb = function(t5) {
          return t5 == this || !(!(t5 instanceof s5) || (0 >= this.Fc() || this.Fc() != t5.Fc()) && !this.sm().isEqual(t5.sm())) && this.Wn == t5.Wn;
        }, s5.prototype.toString = function() {
          var t5 = "GeographicTransformation: " + this.wz();
          return 200 < t5.length ? t5.substring(0, 197) + "... (" + t5.length.toString() + " characters)" : t5;
        }, s5.create = function(t5, i5) {
          var n4 = new s5();
          return n4.GJ(t5), i5 && n4.Lz(), n4;
        }, s5.pP = function(t5, i5) {
          var n4 = new s5();
          return n4.pX(t5), i5 && n4.Lz(), n4;
        }, s5;
      }();
      t4.Cx = s4;
    }(Q2 || (Q2 = {})), function(t4) {
      var i4 = function() {
        function t5() {
        }
        return t5.construct = function(i5, s5, n4, h3) {
          var r3 = new t5();
          return r3.jw = i5, r3.kw = s5, r3.MY = n4, r3.NY = h3, r3;
        }, t5.zy = function(t6, i5) {
          return t6.jw == i5.jw ? t6.kw == i5.kw ? 0 : t6.kw < i5.kw ? -1 : 1 : t6.jw < i5.jw ? -1 : 1;
        }, t5;
      }(), s4 = function() {
        function t5() {
          this.tT = [], this.uT = [], this.sp();
        }
        return t5.fz = function() {
          return t5.eK == null && (t5.eK = new t5()), t5.eK;
        }, t5.prototype.sp = function() {
          this.dD(this.tT), this.dD(this.uT);
        }, t5.prototype.dD = function(t6) {
          try {
            var s5 = [];
            s5 = s5.sort(i4.zy);
            for (var n4 = 0; n4 < s5.length; n4++)
              t6.push(s5[n4]);
          } catch (h3) {
          }
        }, t5;
      }();
      t4.yY = s4;
    }(Q2 || (Q2 = {})), function(t4) {
      var i4 = function() {
        function t5() {
        }
        return t5.prototype.tD = function(t6) {
          this.Hk = t6;
        }, t5.prototype.RM = function(t6) {
          this.Gb = t6;
        }, t5.prototype.sD = function(t6) {
          this.Bo = t6;
        }, t5.xE = function(t6) {
          return !(t6.B() || t6.K() != 1607 && t6.K() != 1736);
        }, t5.vE = function(t6) {
          return !(t6.B() || t6.K() != 1607 && t6.K() != 1736 || 20 > t6.I());
        }, t5.wE = function(t6) {
          return !(t6.B() || t6.K() != 1607 && t6.K() != 1736 || 20 > t6.I());
        }, t5;
      }();
      t4.Wk = i4;
    }(Q2 || (Q2 = {})), function(t4) {
      t4.ac = function() {
        function i4() {
        }
        return i4.OT = function(i5) {
          var s4 = new t4.Ea();
          return s4.rx(i5.gs(), i5.js()), s4.Aj(i5.gs(), i5.hs()), s4.Aj(i5.fs(), i5.hs()), s4.Aj(i5.fs(), i5.js()), s4;
        }, i4.Bh = function(i5, s4) {
          return i5 === null ? null : t4.Gx.local().W(i5, s4, null);
        }, i4.fY = function(i5, s4) {
          var n4 = t4.Ih.local();
          return i5 = new t4.$c(i5), n4.W(i5, s4, null).next();
        }, i4.km = function(i5, s4, n4) {
          return t4.mp.local().W(i5, s4, n4, null);
        }, i4.gp = function(i5, s4, n4) {
          return t4.Jx.local().W(i5, s4, n4, null);
        }, i4.RX = function(i5, s4, n4) {
          var h3 = t4.Jx.local();
          for (i5 = new t4.$c(i5), s4 = new t4.$c(s4), n4 = h3.W(i5, s4, n4, null), h3 = []; (s4 = n4.next()) != null; )
            h3.push(s4);
          return h3;
        }, i4.Nb = function(i5, s4, n4) {
          return t4.fj.local().W(3, i5, s4, n4, null);
        }, i4.OP = function(i5, s4, n4) {
          return t4.fj.local().W(4, i5, s4, n4, null);
        }, i4.MS = function(i5, s4, n4) {
          var h3 = t4.Zj.local();
          for (i5 = new t4.$c(i5), s4 = new t4.$c(s4), n4 = h3.W(i5, s4, n4, null), h3 = []; (s4 = n4.next()) != null; )
            h3.push(s4);
          return h3;
        }, i4.LP = function(i5, s4, n4) {
          var h3 = t4.mp.local();
          for (i5 = new t4.$c(i5), s4 = new t4.$c(s4), n4 = h3.W(i5, s4, n4, null), h3 = []; (s4 = n4.next()) != null; )
            h3.push(s4);
          return h3;
        }, i4.Fa = function(i5, s4, n4) {
          return t4.Zj.local().W(i5, s4, n4, null);
        }, i4.LS = function(i5, s4, n4) {
          if ((i5 = t4.Zj.local().W(i5, s4, n4, null, 1)) === null)
            return [];
          if (i5.K() === 550) {
            for (s4 = [], n4 = 0; n4 < i5.xa; n4++)
              s4.push(i5.FR(n4));
            return s4;
          }
          return i5.K() === 33 ? [i5] : [];
        }, i4.mY = function(i5, s4, n4) {
          return t4.fj.local().W(2, i5, s4, n4, null);
        }, i4.contains = function(i5, s4, n4) {
          return t4.fj.local().W(1, i5, s4, n4, null);
        }, i4.wP = function(i5, s4, n4) {
          return t4.fj.local().W(16, i5, s4, n4, null);
        }, i4.touches = function(i5, s4, n4) {
          return t4.fj.local().W(8, i5, s4, n4, null);
        }, i4.yU = function(i5, s4, n4) {
          return t4.fj.local().W(32, i5, s4, n4, null);
        }, i4.OS = function(i5, s4, n4) {
          return t4.fj.local().W(1073741824, i5, s4, n4, null);
        }, i4.tB = function(i5, s4, n4, h3) {
          return t4.uL.local().W(i5, s4, n4, h3, null);
        }, i4.ub = function(i5, s4, n4, h3) {
          var r3 = null;
          if (n4 != null) {
            if (r3 = n4.Id(), h3 != null && r3.Fc() != h3.Fc() && r3.pd != h3.pd)
              throw t4.i.Zk();
          } else if (h3 != null)
            throw t4.i.O();
          return i5 = t4.lL.local().W(i5, s4, null), r3 !== null && h3 !== null && (i5 = t4.Uc.Ph(i5, r3, h3)), i5;
        }, i4.clip = function(i5, s4, n4) {
          return t4.fL.local().W(i5, t4.l.construct(s4.gs(), s4.js(), s4.fs(), s4.hs()), n4, null);
        }, i4.fl = function(i5, s4, n4) {
          if (i5 == null || s4 == null)
            return null;
          for (i5 = t4.hL.local().W(true, i5, s4, n4, null), s4 = []; (n4 = i5.next()) != null; )
            n4.B() || s4.push(n4);
          return s4.slice(0);
        }, i4.HN = function(s4, n4, h3, r3, e3, o3, a3, u3) {
          if (e3 === true)
            return i4.IN(s4, n4, h3, r3, o3, a3, u3);
          if (e3 = h3, n4 != null) {
            if (a3 = n4.Id(), r3 != null && a3.Fc() != r3.Fc()) {
              if (a3.pd != r3.pd)
                throw t4.i.Zk();
              e3 = [], t4.Uc.SE(h3, h3.length, r3, a3, e3);
            }
          } else if (r3 != null)
            throw t4.i.O();
          if (h3 = t4.vC.local(), o3) {
            for (s4 = new t4.$c(s4), n4 = h3.W(s4, n4, e3, o3, null), s4 = []; (o3 = n4.next()) != null; )
              s4.push(o3);
            o3 = s4.slice(0);
          } else
            for (o3 = [], r3 = 0; r3 < s4.length; r3++)
              o3[r3] = h3.W(s4[r3], n4, e3[r3], null);
          return o3;
        }, i4.IN = function(i5, s4, n4, h3, r3, e3, o3) {
          if (s4 === null)
            throw t4.i.O();
          if (h3 == null && (h3 = s4.Fc() !== 4326 ? s4.Id() : t4.Uc.ah(9001)), h3.pd !== 0)
            throw t4.i.O();
          if (t4.Uc.SE(n4, n4.length, h3, t4.Uc.ah(9001), n4), h3 = t4.AC.local(), r3) {
            for (i5 = new t4.$c(i5), s4 = h3.W(i5, s4, e3, n4, o3, false, r3, null), n4 = []; (e3 = s4.next()) != null; )
              n4.push(e3);
            r3 = n4.slice(0);
          } else {
            r3 = [];
            for (var a3 = 0; a3 < i5.length; a3++)
              r3[a3] = h3.W(i5[a3], s4, e3, n4[a3], o3, false, null);
          }
          return r3;
        }, i4.buffer = function(i5, s4, n4, h3, r3, e3, o3) {
          var a3 = n4;
          if (r3 === false) {
            if (s4 != null) {
              if (r3 = s4.Id(), h3 != null && r3.Fc() != h3.Fc()) {
                if (r3.pd != h3.pd)
                  throw t4.i.Zk();
                a3 = t4.Uc.Ph(n4, h3, r3);
              }
            } else if (h3 != null)
              throw t4.i.O();
            i5 = t4.vC.local().W(i5, s4, a3, null);
          } else {
            if (s4 === null)
              throw t4.i.O();
            if (h3 == null && (h3 = s4.Fc() !== 4326 ? s4.Id() : t4.Uc.ah(9001)), h3.pd !== 0)
              throw t4.i.O();
            a3 = t4.Uc.Ph(n4, h3, t4.Uc.ah(9001)), i5 = t4.AC.local().W(i5, s4, e3, a3, o3, false, null);
          }
          return i5;
        }, i4.wU = function(i5, s4, n4, h3, r3, e3, o3) {
          if (s4 != null) {
            var a3 = s4.Id();
            if (o3 != null && a3.Fc() != o3.Fc()) {
              if (a3.pd != o3.pd)
                throw t4.i.Zk();
              n4 = t4.Uc.Ph(n4, o3, a3);
            }
          } else if (o3 != null)
            throw t4.i.O();
          for (i5 = new t4.$c(i5), s4 = t4.DC.local().W(i5, s4, n4, h3, r3, e3, null), n4 = []; (h3 = s4.next()) != null; )
            n4.push(h3);
          return n4.slice(0);
        }, i4.offset = function(i5, s4, n4, h3, r3, e3, o3) {
          if (s4 != null) {
            var a3 = s4.Id();
            if (o3 != null && a3.Fc() != o3.Fc()) {
              if (a3.pd != o3.pd)
                throw t4.i.Zk();
              n4 = t4.Uc.Ph(n4, o3, a3);
            }
          } else if (o3 != null)
            throw t4.i.O();
          return t4.DC.local().W(i5, s4, n4, h3, r3, e3, null);
        }, i4.dP = function(i5) {
          return t4.xC.local().W(i5, null);
        }, i4.eP = function(i5, s4) {
          var n4 = t4.xC.local();
          for (i5 = new t4.$c(i5), s4 = n4.W(i5, s4, null), n4 = []; (i5 = s4.next()) != null; )
            n4.push(i5);
          return n4;
        }, i4.iz = function(i5, s4, n4) {
          return t4.Hx.local().iz(i5, s4, n4);
        }, i4.jz = function(i5, s4) {
          return t4.Hx.local().jz(i5, s4);
        }, i4.kz = function(i5, s4, n4, h3) {
          return t4.Hx.local().kz(i5, s4, n4, h3);
        }, i4.$B = function(i5, s4) {
          return t4.$l.local().W(i5, s4, false, null);
        }, i4.ZS = function(i5, s4) {
          return t4.$l.local().ts(i5, s4, null);
        }, i4.LQ = function(i5, s4, n4, h3, r3) {
          var e3 = t4.zC.local();
          if (s4 != null) {
            if (s4 = s4.Id(), r3 != null && s4.Fc() != r3.Fc()) {
              if (s4.pd != r3.pd)
                throw t4.i.Zk();
              n4 = t4.Uc.Ph(n4, r3, s4);
            }
          } else if (r3 != null)
            throw t4.i.O();
          return e3.W(i5, n4, h3, null);
        }, i4.Sr = function(i5, s4, n4, h3) {
          var r3 = t4.Zl.local();
          if (s4 != null) {
            if (s4 = s4.Id(), h3 != null && s4.Fc() != h3.Fc()) {
              if (s4.pd != h3.pd)
                throw t4.i.Zk();
              n4 = t4.Uc.Ph(n4, h3, s4);
            }
          } else if (h3 != null)
            throw t4.i.O();
          return r3.W(i5, n4, null);
        }, i4.Ry = function(i5, s4, n4, h3, r3) {
          r3 === void 0 && (r3 = 0);
          var e3 = t4.nL.local();
          if (r3 == 4)
            throw t4.i.Fe();
          if (r3 !== 0)
            throw t4.i.Fe();
          if (h3 !== null) {
            if (h3.pd !== 0)
              throw t4.i.O("Unit must be a linear unit type");
            n4 = t4.Uc.Ph(n4, h3, t4.Uc.ah(9001));
          }
          return e3.W(i5, n4, s4, r3, null);
        }, i4.RQ = function(s4, n4, h3, r3) {
          if (s4 === null)
            return 0;
          if (r3 == 4)
            throw t4.i.Fe();
          if (r3 !== 0)
            throw t4.i.Fe();
          if (s4.K() == 197)
            s4 = i4.OT(s4);
          else if (s4.K() != 1736)
            return 0;
          if (r3 = t4.cb.tc(n4), s4 = t4.cb.Bh(s4, n4, r3), s4 = t4.PK.SQ([s4])[0], h3 !== null) {
            if (h3.pd !== 2)
              throw t4.i.O("Unit must be a area unit type");
            s4 = t4.Uc.Ph(s4, t4.Uc.ah(109404), h3);
          }
          return s4;
        }, i4.UQ = function(i5, s4, n4, h3) {
          if (i5 = t4.qL.local().W(i5, s4, h3, null), n4 !== null) {
            if (n4.pd !== 0)
              throw t4.i.O("Unit must be a linear unit type");
            i5 = t4.Uc.Ph(i5, t4.Uc.ah(9001), n4);
          }
          return i5;
        }, i4.EU = function(i5, s4, n4) {
          if (i5 === null)
            return 0;
          var h3 = null;
          if (s4 != null) {
            if ((h3 = s4.Id()).pd == 0 && ((h3 = t4.Uc.WF(h3)) == null && n4 !== null))
              throw t4.i.O();
            if (n4 != null && h3.Fc() != n4.Fc() && h3.pd != n4.pd)
              throw t4.i.Zk();
          } else if (n4 != null)
            throw t4.i.O();
          return i5.K() == 1736 || i5.K() == 197 ? (i5 = i5.He(), n4 !== null ? t4.Uc.Ph(i5, h3, n4) : i5) : 0;
        }, i4.FU = function(i5, s4, n4) {
          if (i5 === null || i5.B() || 1 > i5.Eb())
            return 0;
          var h3 = null;
          if (s4 != null) {
            if (h3 = s4.Id(), n4 != null && h3.Fc() != n4.Fc() && h3.pd != n4.pd)
              throw t4.i.Zk();
          } else if (n4 != null)
            throw t4.i.O();
          i5.K() == 1736 || i5.K() == 197 ? s4 = i5.ng() : t4.ba.zd(i5.K()) ? (s4 = new t4.Ua(i5.description)).pc(i5, true) : s4 = i5, i5 = 0, s4 = s4.Ha();
          for (var r3 = new t4.h(), e3 = new t4.h(); s4.ab(); )
            for (; s4.Ia(); ) {
              var o3 = s4.ia();
              o3.$p(r3), o3.Vr(e3), i5 += t4.h.ub(r3, e3);
            }
          return h3 !== null && n4 !== null && (i5 = t4.Uc.Ph(i5, h3, n4)), i5;
        }, i4.aP = function(t5) {
          return t5.points !== void 0 ? i4.hS(t5, t5.hasZ !== void 0 && t5.hasZ, t5.hasM !== void 0 && t5.hasM) : t5.rings !== void 0 ? i4.gG(t5.rings, t5.hasZ !== void 0 && t5.hasZ, t5.hasM !== void 0 && t5.hasM, "P") : t5.paths !== void 0 ? i4.gG(t5.paths, t5.hasZ !== void 0 && t5.hasZ, t5.hasM !== void 0 && t5.hasM, "L") : t5.x !== void 0 ? i4.iS(t5) : t5.xmin !== void 0 ? i4.gS(t5) : null;
        }, i4.iS = function(i5) {
          if (i5.x == null || i5.x == "NaN")
            return new t4.Ta();
          var s4 = new t4.Ta(i5.x, i5.y);
          return i5.z !== void 0 && i5.z !== null && s4.sX(i5.z), i5.m !== void 0 && i5.m !== null && s4.cX(i5.m), s4;
        }, i4.gS = function(i5) {
          if (i5.xmin == null || i5.xmin == "NaN")
            return new t4.Hh();
          var s4 = new t4.Hh(i5.xmin, i5.ymin, i5.xmax, i5.ymax);
          return i5.zmin !== void 0 && i5.zmin !== null && s4.setInterval(1, 0, i5.zmin, i5.zmax), i5.mmin !== void 0 && i5.mmin !== null && s4.setInterval(2, 0, i5.mmin, i5.mmax), s4;
        }, i4.hS = function(i5, s4, n4) {
          var h3 = 0, r3 = new t4.ee(), e3 = 3 * i5.points.length;
          e3 % 2 != 0 && e3++, 2 > e3 && (e3 = 2);
          var o3 = t4.P.truncate(3 * i5.points.length / 2);
          4 > o3 ? o3 = 4 : 16 > o3 && (o3 = 16), e3 = t4.Zc.Fn(e3, 0);
          var a3 = t4.Zc.Fn(o3);
          o3 = t4.Zc.Fn(o3);
          for (var u3 = 0; u3 < i5.points.length; u3++)
            e3.write(2 * u3, i5.points[u3][0]), e3.write(2 * u3 + 1, i5.points[u3][1]), a3.write(u3, s4 || n4 ? i5.points[u3][2] : NaN), o3.write(u3, n4 && s4 ? i5.points[u3][3] : NaN), h3++;
          return h3 != 0 && (r3.resize(h3), r3.kn(0, e3)), s4 && (r3.se(1), r3.kn(1, a3)), n4 && (r3.se(2), r3.kn(2, s4 == 0 ? a3 : o3)), r3.Qc(16777215), r3;
        }, i4.gG = function(i5, s4, n4, h3) {
          var r3 = 0, e3 = 2;
          if (h3 == "P") {
            var o3 = new t4.Ea();
            r3 = 1, e3 = 3;
          } else
            o3 = new t4.Ua();
          for (var a3 = t4.Zc.Qh(0), u3 = t4.Zc.Or(0), f3 = 0, c3 = 0, l3 = [], p3 = [], v3 = 0; v3 < i5.length; v3++) {
            var y3 = i5[v3].length;
            if (l3[v3] = false, h3 === "P" && i5[v3][0][0] === i5[v3][i5[v3].length - 1][0] && i5[v3][0][1] === i5[v3][i5[v3].length - 1][1]) {
              var b3 = n4 == 0 || (i5[v3][0][3] === i5[v3][i5[v3].length - 1][3] || i5[v3][0][3] === void 0 && i5[v3][i5[v3].length - 1][3] === void 0);
              (s4 == 0 || i5[v3][0][2] === i5[v3][i5[v3].length - 1][2] || i5[v3][0][2] === void 0 && i5[v3][i5[v3].length - 1][2] === void 0) && b3 && (l3[v3] = true, --y3);
            }
            y3 >= e3 ? (p3[v3] = false, c3 += 1, a3.add(f3), u3.add(r3), f3 += y3) : p3[v3] = true;
          }
          for ((h3 = 3 * f3) % 2 != 0 && h3++, 2 > h3 && (h3 = 2), 4 > (v3 = t4.P.truncate(3 * f3 / 2)) ? v3 = 4 : 16 > v3 && (v3 = 16), h3 = t4.Zc.Fn(h3, 0), r3 = t4.Zc.Fn(v3), e3 = t4.Zc.Fn(v3), v3 = y3 = 0; v3 < i5.length; v3++)
            if (p3[v3] === false)
              for (b3 = 0; b3 < i5[v3].length; b3++) {
                var d3 = false;
                b3 === i5[v3].length - 1 && l3[v3] === true && (d3 = true), d3 || (h3.write(2 * y3, i5[v3][b3][0]), h3.write(2 * y3 + 1, i5[v3][b3][1]), r3.write(y3, s4 || n4 ? i5[v3][b3][2] : NaN), e3.write(y3, n4 && s4 ? i5[v3][b3][3] : NaN), y3++);
              }
          return f3 != 0 && (i5 = o3, a3.resize(c3), u3.resize(c3), 0 < f3 && (a3.add(f3), u3.add(0)), i5.kn(0, h3), i5.KJ(u3), i5.LJ(a3)), s4 && (o3.se(1), o3.kn(1, r3)), n4 && (o3.se(2), o3.kn(2, s4 == 0 ? r3 : e3)), o3.Qc(16777215), o3;
        }, i4;
      }();
    }(Q2 || (Q2 = {})), function(t4) {
      t4.Dx = function() {
        function t5() {
        }
        return t5.dr = function(t6) {
          var i4, s4 = 0, n4 = t6.length, h3 = t6[0];
          for (i4 = 0; i4 < n4 - 1; i4++) {
            var r3 = t6[i4 + 1];
            s4 += (r3[0] - h3[0]) * (r3[1] + h3[1]), h3 = r3;
          }
          return 0 <= s4;
        }, t5.rotate = function(i4, s4, n4) {
          s4 = s4 * Math.PI / 180;
          var h3 = Math.cos(s4), r3 = Math.sin(s4);
          if (i4.paths !== void 0) {
            s4 = { paths: [] };
            for (var e3 = 0; e3 < i4.paths.length; e3++) {
              for (var o3 = i4.paths[e3], a3 = [], u3 = 0; u3 < o3.length; u3++) {
                var f3 = o3[u3].slice(0);
                a3.push(f3);
                var c3 = h3 * (o3[u3][0] - n4.x) - r3 * (o3[u3][1] - n4.y) + n4.x, l3 = r3 * (o3[u3][0] - n4.x) + h3 * (o3[u3][1] - n4.y) + n4.y;
                f3[0] = c3, f3[1] = l3;
              }
              s4.paths.push(a3), i4.hasZ !== void 0 && (s4.hasZ = i4.hasZ), i4.hasM !== void 0 && (s4.hasM = i4.hasM);
            }
            return s4;
          }
          if (i4.rings !== void 0) {
            for (s4 = { rings: [] }, e3 = 0; e3 < i4.rings.length; e3++) {
              o3 = i4.rings[e3], a3 = [];
              var p3 = t5.dr(o3);
              for (u3 = 0; u3 < o3.length; u3++)
                f3 = o3[u3].slice(0), a3.push(f3), c3 = h3 * (o3[u3][0] - n4.x) - r3 * (o3[u3][1] - n4.y) + n4.x, l3 = r3 * (o3[u3][0] - n4.x) + h3 * (o3[u3][1] - n4.y) + n4.y, f3[0] = c3, f3[1] = l3;
              t5.dr(a3) !== p3 && a3.reverse(), s4.rings.push(a3), i4.hasZ !== void 0 && (s4.hasZ = i4.hasZ), i4.hasM !== void 0 && (s4.hasM = i4.hasM);
            }
            return s4;
          }
          if (i4.x !== void 0)
            return s4 = { x: h3 * (i4.x - n4.x) - r3 * (i4.y - n4.y) + n4.x, y: r3 * (i4.x - n4.x) + h3 * (i4.y - n4.y) + n4.y }, i4.z !== void 0 && (s4.z = i4.z), i4.m !== void 0 && (s4.m = i4.m), i4.hasZ !== void 0 && (s4.hasZ = i4.hasZ), i4.hasM !== void 0 && (s4.hasM = i4.hasM), s4;
          if (i4.points !== void 0) {
            for (s4 = { points: [] }, e3 = i4.points, u3 = 0; u3 < e3.length; u3++)
              (o3 = e3[u3].slice(0))[0] = h3 * (e3[u3][0] - n4.x) - r3 * (e3[u3][1] - n4.y) + n4.x, o3[1] = r3 * (e3[u3][0] - n4.x) + h3 * (e3[u3][1] - n4.y) + n4.y, s4.points.push(o3);
            return i4.hasZ !== void 0 && (s4.hasZ = i4.hasZ), i4.hasM !== void 0 && (s4.hasM = i4.hasM), s4;
          }
          return null;
        }, t5.EQ = function(i4, s4) {
          if (i4.paths !== void 0) {
            for (var n4 = { paths: [] }, h3 = 0; h3 < i4.paths.length; h3++) {
              for (var r3 = i4.paths[h3], e3 = [], o3 = 0; o3 < r3.length; o3++) {
                var a3 = r3[o3].slice(0);
                e3.push(a3);
                var u3 = s4.x - r3[o3][0];
                a3[0] = r3[o3][0] + 2 * u3;
              }
              n4.paths.push(e3);
            }
            return i4.hasZ !== void 0 && (n4.hasZ = i4.hasZ), i4.hasM !== void 0 && (n4.hasM = i4.hasM), n4;
          }
          if (i4.rings !== void 0) {
            for (n4 = { rings: [] }, h3 = 0; h3 < i4.rings.length; h3++) {
              r3 = i4.rings[h3];
              var f3 = t5.dr(r3);
              for (e3 = [], o3 = 0; o3 < r3.length; o3++)
                a3 = r3[o3].slice(0), e3.push(a3), u3 = s4.x - r3[o3][0], a3[0] = r3[o3][0] + 2 * u3;
              t5.dr(e3) !== f3 && e3.reverse(), n4.rings.push(e3);
            }
            return i4.hasZ !== void 0 && (n4.hasZ = i4.hasZ), i4.hasM !== void 0 && (n4.hasM = i4.hasM), n4;
          }
          if (i4.x !== void 0)
            return u3 = s4.x - i4.x, n4 = { x: i4.x + 2 * u3, y: i4.y }, i4.z !== void 0 && (n4.z = i4.z), i4.m !== void 0 && (n4.m = i4.m), i4.hasZ !== void 0 && (n4.hasZ = i4.hasZ), i4.hasM !== void 0 && (n4.hasM = i4.hasM), n4;
          if (i4.points !== void 0) {
            for (n4 = { points: [] }, h3 = i4.points, o3 = 0; o3 < h3.length; o3++)
              r3 = h3[o3].slice(0), u3 = s4.x - r3[0], r3[0] += 2 * u3, n4.points.push(r3);
            return i4.hasZ !== void 0 && (n4.hasZ = i4.hasZ), i4.hasM !== void 0 && (n4.hasM = i4.hasM), n4;
          }
          return i4.xmin !== void 0 ? (n4 = { v: i4.xmin, G: i4.ymin, C: i4.xmax, H: i4.ymax }, i4.zmin !== void 0 && (n4.zmin = i4.zmin, n4.zmax = i4.zmax), i4.mmin !== void 0 && (n4.mmin = i4.mmin, n4.mmax = i4.mmax), u3 = s4.x - i4.xmin, n4.xmax = i4.xmin + 2 * u3, u3 = s4.x - i4.xmax, n4.xmin = i4.xmax + 2 * u3, i4.zmin !== void 0 && (n4.zmin = i4.zmin), i4.zmax !== void 0 && (n4.zmax = i4.zmax), i4.mmin !== void 0 && (n4.mmin = i4.mmin), i4.mmax !== void 0 && (n4.mmax = i4.mmax), i4.hasZ !== void 0 && (n4.hasZ = i4.hasZ), i4.hasM !== void 0 && (n4.hasM = i4.hasM), n4) : null;
        }, t5.FQ = function(i4, s4) {
          if (i4.paths !== void 0) {
            for (var n4 = { paths: [] }, h3 = 0; h3 < i4.paths.length; h3++) {
              for (var r3 = i4.paths[h3], e3 = [], o3 = 0; o3 < r3.length; o3++) {
                var a3 = r3[o3].slice(0);
                e3.push(a3);
                var u3 = s4.y - r3[o3][1];
                a3[1] = r3[o3][1] + 2 * u3;
              }
              n4.paths.push(e3);
            }
            return i4.hasZ !== void 0 && (n4.hasZ = i4.hasZ), i4.hasM !== void 0 && (n4.hasM = i4.hasM), n4;
          }
          if (i4.rings !== void 0) {
            for (n4 = { rings: [] }, h3 = 0; h3 < i4.rings.length; h3++) {
              r3 = i4.rings[h3];
              var f3 = t5.dr(r3);
              for (e3 = [], o3 = 0; o3 < r3.length; o3++)
                a3 = r3[o3].slice(0), e3.push(a3), u3 = s4.y - r3[o3][1], a3[1] = r3[o3][1] + 2 * u3;
              t5.dr(e3) !== f3 && e3.reverse(), n4.rings.push(e3);
            }
            return i4.hasZ !== void 0 && (n4.hasZ = i4.hasZ), i4.hasM !== void 0 && (n4.hasM = i4.hasM), n4;
          }
          if (i4.x !== void 0)
            return u3 = s4.y - i4.y, n4 = { y: i4.y + 2 * u3, x: i4.x }, i4.z !== void 0 && (n4.z = i4.z), i4.m !== void 0 && (n4.m = i4.m), i4.hasZ !== void 0 && (n4.hasZ = i4.hasZ), i4.hasM !== void 0 && (n4.hasM = i4.hasM), n4;
          if (i4.points !== void 0) {
            for (n4 = { points: [] }, h3 = i4.points, o3 = 0; o3 < h3.length; o3++)
              r3 = h3[o3].slice(0), u3 = s4.y - r3[1], r3[1] += 2 * u3, n4.points.push(r3);
            return i4.hasZ !== void 0 && (n4.hasZ = i4.hasZ), i4.hasM !== void 0 && (n4.hasM = i4.hasM), n4;
          }
          return i4.xmin !== void 0 ? (n4 = { v: i4.xmin, G: i4.ymin, C: i4.xmax, H: i4.ymax }, i4.zmin !== void 0 && (n4.zmin = i4.zmin, n4.zmax = i4.zmax), i4.mmin !== void 0 && (n4.mmin = i4.mmin, n4.mmax = i4.mmax), u3 = s4.y - i4.ymin, n4.ymax = i4.ymin + 2 * u3, u3 = s4.y - i4.ymax, n4.ymin = i4.ymax + 2 * u3, i4.zmin !== void 0 && (n4.zmin = i4.zmin), i4.zmax !== void 0 && (n4.zmax = i4.zmax), i4.mmin !== void 0 && (n4.mmin = i4.mmin), i4.mmax !== void 0 && (n4.mmax = i4.mmax), i4.hasZ !== void 0 && (n4.hasZ = i4.hasZ), i4.hasM !== void 0 && (n4.hasM = i4.hasM), n4) : null;
        }, t5;
      }();
    }(Q2 || (Q2 = {})), function(t4) {
      t4.UK = function() {
        function i4() {
        }
        return i4.Kg = function(i5, s4) {
          switch (s4 == null && (s4 = t4.fe.pg()), i5) {
            case 33:
              return new t4.Ta(s4);
            case 322:
              return new t4.zb(s4);
            case 197:
              return new t4.Hh(s4);
            case 550:
              return new t4.ee(s4);
            case 1607:
              return new t4.Ua(s4);
            case 1736:
              return new t4.Ea(s4);
            default:
              throw t4.i.ga("invalid argument.");
          }
        }, i4;
      }();
    }(Q2 || (Q2 = {})), function(t4) {
      var i4 = function() {
        function i5(i6, s4) {
          this.Qe = t4.ja.rf(i6, -1), this.va = new t4.cu(), this.yl = s4;
        }
        return i5.prototype.vW = function(t5) {
          this.va.Bt(Math.min(this.Qe.size, t5)), this.va.hn(t5);
        }, i5.prototype.addElement = function(i6, s4) {
          if (s4 === void 0)
            return this.$M(i6);
          s4 = t4.P.truncate(s4 % this.Qe.size);
          var n4 = this.Qe.get(s4);
          return n4 == -1 && (n4 = this.va.Rh(), this.Qe.set(s4, n4)), this.va.addElement(n4, i6);
        }, i5.prototype.$M = function(i6) {
          var s4 = this.yl.ez(i6);
          s4 = t4.P.truncate(s4 % this.Qe.size);
          var n4 = this.Qe.get(s4);
          return n4 == -1 && (n4 = this.va.Rh(), this.Qe.set(s4, n4)), this.va.addElement(n4, i6);
        }, i5.prototype.kd = function(i6, s4) {
          if (s4 === void 0)
            this.FP(i6);
          else {
            s4 = t4.P.truncate(s4 % this.Qe.size);
            var n4 = this.Qe.get(s4);
            if (n4 == -1)
              throw t4.i.O();
            for (var h3 = this.va.sc(n4), r3 = -1; h3 != -1; ) {
              var e3 = this.va.lb(h3);
              this.va.ka(h3) == i6 ? (this.va.kd(n4, r3, h3), this.va.sc(n4) == -1 && (this.va.eh(n4), this.Qe.set(s4, -1))) : r3 = h3, h3 = e3;
            }
          }
        }, i5.prototype.FP = function(i6) {
          var s4 = this.yl.ez(i6);
          s4 = t4.P.truncate(s4 % this.Qe.size);
          var n4 = this.Qe.get(s4);
          if (n4 == -1)
            throw t4.i.O();
          for (var h3 = this.va.sc(n4), r3 = -1; h3 != -1; ) {
            var e3 = this.va.lb(h3);
            this.va.ka(h3) == i6 ? (this.va.kd(n4, r3, h3), this.va.sc(n4) == -1 && (this.va.eh(n4), this.Qe.set(s4, -1))) : r3 = h3, h3 = e3;
          }
        }, i5.prototype.lR = function(i6) {
          return i6 = t4.P.truncate(i6 % this.Qe.size), (i6 = this.Qe.get(i6)) == -1 ? -1 : this.va.sc(i6);
        }, i5.prototype.zR = function(t5) {
          return this.va.lb(t5);
        }, i5.prototype.wd = function(i6) {
          var s4 = this.yl.ez(this.ka(i6));
          s4 = t4.P.truncate(s4 % this.Qe.size);
          var n4 = this.Qe.get(s4);
          if (n4 == -1)
            throw t4.i.O();
          for (var h3 = this.va.sc(n4), r3 = -1; h3 != -1; ) {
            if (h3 == i6)
              return this.va.kd(n4, r3, h3), void (this.va.sc(n4) == -1 && (this.va.eh(n4), this.Qe.set(s4, -1)));
            r3 = h3, h3 = this.va.lb(h3);
          }
          throw t4.i.O();
        }, i5.prototype.ka = function(t5) {
          return this.va.ka(t5);
        }, i5.prototype.clear = function() {
          this.Qe = t4.ja.rf(this.Qe.size, -1), this.va.clear();
        }, i5.prototype.size = function() {
          return this.va.OF();
        }, i5;
      }();
      t4.ZK = i4;
    }(Q2 || (Q2 = {})), function(t4) {
      var i4 = function() {
        function i5() {
          this.Ni = new t4.ad(3), this.va = new t4.ad(6), this.mT = false, this.ke = -1;
        }
        return i5.prototype.hl = function(t5) {
          this.Ni.kd(t5);
        }, i5.prototype.Rw = function() {
          return this.Ni.De();
        }, i5.prototype.dv = function(t5) {
          this.va.kd(t5);
        }, i5.prototype.VA = function() {
          return this.va.De();
        }, i5.prototype.RB = function(t5, i6) {
          this.Ni.T(t5, 1, i6);
        }, i5.prototype.fx = function(t5, i6) {
          this.Ni.T(t5, 2, i6);
        }, i5.prototype.bX = function(t5, i6) {
          this.Ni.T(t5, 3, i6);
        }, i5.prototype.PB = function(t5, i6) {
          this.va.T(t5, 4, i6);
        }, i5.prototype.eX = function(t5, i6) {
          this.va.T(t5, 3, i6);
        }, i5.prototype.OJ = function(t5, i6) {
          this.va.T(t5, 2, i6);
        }, i5.prototype.Rh = function(t5) {
          var i6 = this.VA();
          return this.va.T(i6, 3, this.ke), this.va.T(i6, 4, 0), this.va.T(i6, 5, t5), this.ke != -1 && this.OJ(this.ke, i6), this.ke = i6;
        }, i5.prototype.eh = function(t5) {
          this.GE(t5);
          var i6 = this.va.U(t5, 2), s4 = this.va.U(t5, 3);
          return i6 != -1 ? this.eX(i6, s4) : this.ke = s4, s4 != -1 && this.OJ(s4, i6), this.dv(t5), s4;
        }, i5.prototype.Bt = function(t5) {
          this.va.Ee(t5);
        }, i5.prototype.KF = function(t5) {
          return this.va.U(t5, 5);
        }, i5.prototype.aX = function(t5, i6) {
          this.va.T(t5, 5, i6);
        }, i5.prototype.addElement = function(t5, i6) {
          return this.oS(t5, i6);
        }, i5.prototype.oS = function(t5, i6) {
          var s4 = this.Rw();
          this.fx(s4, -1), this.va.U(t5, 0) == -1 && this.va.T(t5, 0, s4);
          var n4 = this.va.U(t5, 1);
          return this.RB(s4, n4), n4 != -1 && this.fx(n4, s4), this.va.T(t5, 1, s4), this.setData(s4, i6), this.PB(t5, this.ds(t5) + 1), this.mT && this.bX(s4, t5), s4;
        }, i5.prototype.kd = function(t5, i6) {
          var s4 = this.xe(i6), n4 = this.lb(i6);
          return s4 != -1 ? this.fx(s4, n4) : this.va.T(t5, 0, n4), n4 != -1 ? this.RB(n4, s4) : this.va.T(t5, 1, s4), this.hl(i6), this.PB(t5, this.ds(t5) - 1), n4;
        }, i5.prototype.hn = function(t5) {
          this.Ni.Ee(t5);
        }, i5.prototype.getData = function(t5) {
          return this.Ni.U(t5, 0);
        }, i5.prototype.setData = function(t5, i6) {
          this.Ni.T(t5, 0, i6);
        }, i5.prototype.lb = function(t5) {
          return this.Ni.U(t5, 2);
        }, i5.prototype.xe = function(t5) {
          return this.Ni.U(t5, 1);
        }, i5.prototype.sc = function(t5) {
          return this.va.U(t5, 0);
        }, i5.prototype.Gc = function(t5) {
          return this.va.U(t5, 1);
        }, i5.prototype.clear = function() {
          for (var t5 = this.ke; t5 != -1; )
            t5 = this.eh(t5);
        }, i5.prototype.GE = function(t5) {
          for (var i6 = this.Gc(t5); i6 != -1; ) {
            var s4 = i6;
            i6 = this.xe(s4), this.hl(s4);
          }
          this.va.T(t5, 0, -1), this.va.T(t5, 1, -1), this.PB(t5, 0);
        }, i5.prototype.B = function() {
          return this.Ni.size == 0;
        }, i5.prototype.OF = function() {
          return this.Ni.size;
        }, i5.prototype.ds = function(t5) {
          return this.va.U(t5, 4);
        }, i5.prototype.lz = function(t5) {
          return this.va.U(t5, 3);
        }, i5;
      }();
      t4.lp = i4;
    }(Q2 || (Q2 = {})), function(t4) {
      var i4 = function() {
        function i5(i6) {
          i6 === void 0 ? (this.vg = new t4.ad(2), this.va = new t4.ad(4), this.ke = -1, this.Sv = true) : (this.vg = new t4.ad(2), this.va = new t4.ad(i6 ? 4 : 2), this.ke = -1, this.Sv = i6);
        }
        return i5.prototype.hl = function(t5) {
          this.vg.kd(t5);
        }, i5.prototype.Rw = function() {
          return this.vg.De();
        }, i5.prototype.dv = function(t5) {
          this.va.kd(t5);
        }, i5.prototype.VA = function() {
          return this.va.De();
        }, i5.prototype.Rh = function() {
          var t5 = this.VA();
          return this.Sv && (this.va.T(t5, 3, this.ke), this.ke != -1 && this.va.T(this.ke, 2, t5), this.ke = t5), t5;
        }, i5.prototype.eh = function(t5) {
          for (var i6 = this.sc(t5); i6 != -1; ) {
            var s4 = i6;
            i6 = this.lb(i6), this.hl(s4);
          }
          this.Sv && (i6 = this.va.U(t5, 2), s4 = this.va.U(t5, 3), i6 != -1 ? this.va.T(i6, 3, s4) : this.ke = s4, s4 != -1 && this.va.T(s4, 2, i6)), this.dv(t5);
        }, i5.prototype.Bt = function(t5) {
          this.va.Ee(t5);
        }, i5.prototype.addElement = function(t5, i6) {
          var s4 = this.va.U(t5, 1), n4 = this.Rw();
          return s4 != -1 ? this.vg.T(s4, 1, n4) : this.va.T(t5, 0, n4), this.va.T(t5, 1, n4), this.vg.T(n4, 0, i6), n4;
        }, i5.prototype.hn = function(t5) {
          this.vg.Ee(t5);
        }, i5.prototype.kd = function(t5, i6, s4) {
          i6 != -1 ? (this.vg.T(i6, 1, this.vg.U(s4, 1)), this.va.U(t5, 1) == s4 && this.va.T(t5, 1, i6)) : (this.va.T(t5, 0, this.vg.U(s4, 1)), this.va.U(t5, 1) == s4 && this.va.T(t5, 1, -1)), this.hl(s4);
        }, i5.prototype.Cy = function(t5, i6) {
          var s4 = this.va.U(t5, 1), n4 = this.va.U(i6, 0);
          n4 != -1 && (s4 != -1 ? this.vg.T(s4, 1, n4) : this.va.T(t5, 0, n4), this.va.T(t5, 1, this.va.U(i6, 1))), this.Sv && (t5 = this.va.U(i6, 2), s4 = this.va.U(i6, 3), t5 != -1 ? this.va.T(t5, 3, s4) : this.ke = s4, s4 != -1 && this.va.T(s4, 2, t5)), this.dv(i6);
        }, i5.prototype.ka = function(t5) {
          return this.vg.U(t5, 0);
        }, i5.prototype.Uj = function(t5, i6) {
          this.vg.T(t5, 0, i6);
        }, i5.prototype.lb = function(t5) {
          return this.vg.U(t5, 1);
        }, i5.prototype.sc = function(t5) {
          return this.va.U(t5, 0);
        }, i5.prototype.Ln = function(t5) {
          return this.ka(this.sc(t5));
        }, i5.prototype.clear = function() {
          this.vg.oj(true), this.va.oj(true), this.ke = -1;
        }, i5.prototype.B = function() {
          return this.vg.size == 0;
        }, i5.prototype.OF = function() {
          return this.vg.size;
        }, i5.prototype.lz = function(t5) {
          return this.va.U(t5, 3);
        }, i5;
      }();
      t4.cu = i4;
    }(Q2 || (Q2 = {})), function(t4) {
      t4.ua = function() {
        function i4() {
        }
        return i4.Xd = function(t5, i5, s4) {
          return i5 = i5.zr(), t5 = t5 != null && t5.Yd !== void 0 ? t5.Yd(0) : 0, s4 && (i5 *= 4, t5 *= 1.1), Math.max(t5, i5);
        }, i4.Gr = function(t5) {
          return 2 * Math.sqrt(2) * t5;
        }, i4.mN = function(t5) {
          return Math.sqrt(2) * t5;
        }, i4.mj = function(s4, n4, h3) {
          var r3 = new t4.l();
          return n4.A(r3), i4.Xd(s4, r3, h3);
        }, i4.rE = function(t5, i5, s4) {
          return i5 = i5.Vg(1, 0).zr(), t5 = t5 != null ? t5.Yd(1) : 0, s4 && (i5 *= 4, t5 *= 1.1), Math.max(t5, i5);
        }, i4.ov = function(i5, s4) {
          var n4 = new t4.l();
          return i5.yc(n4), i5 = new t4.l(), s4.yc(i5), n4.$b(i5), n4;
        }, i4.TN = function(i5) {
          var s4 = new t4.l();
          if (i5.yc(s4), s4.B())
            return null;
          var n4 = new t4.fu(s4, 8), h3 = -1, r3 = new t4.l(), e3 = false;
          do {
            for (var o3 = 0, a3 = i5.ea(); o3 < a3; o3++) {
              if (i5.Tj(o3, r3), (h3 = n4.Ez(o3, r3, h3)) == -1) {
                if (e3)
                  throw t4.i.ga("internal error");
                i5.Ap(s4, false), e3 = true, n4.reset(s4, 8);
                break;
              }
              e3 = false;
            }
          } while (e3);
          return n4;
        }, i4.iE = function(i5) {
          var s4 = new t4.l();
          i5.yc(s4);
          for (var n4 = new t4.fu(s4, 8), h3 = -1, r3 = i5.Ha(), e3 = new t4.l(), o3 = false; r3.ab(); )
            for (; r3.Ia(); ) {
              var a3 = r3.ia(), u3 = r3.xb();
              if (a3.A(e3), (h3 = n4.Ez(u3, e3, h3)) == -1) {
                if (o3)
                  throw t4.i.Ra();
                i5.Ap(s4, false), o3 = true, n4.reset(s4, 8), r3.aj();
                break;
              }
            }
          return n4;
        }, i4.lj = function(i5, s4) {
          var n4 = new t4.l();
          i5.yc(n4);
          for (var h3 = new t4.fu(n4, 8), r3 = -1, e3 = new t4.l(), o3 = i5.Ha(), a3 = false; o3.ab(); )
            for (; o3.Ia(); ) {
              var u3 = o3.ia(), f3 = o3.xb();
              if (u3.A(e3), e3.isIntersecting(s4) && (r3 = h3.Ez(f3, e3, r3)) == -1) {
                if (a3)
                  throw t4.i.ga("internal error.");
                i5.Ap(n4, false), a3 = true, h3.reset(n4, 8), o3.aj();
                break;
              }
            }
          return h3;
        }, i4.jE = function(i5, s4) {
          for (var n4 = new t4.fu(s4, 8), h3 = new t4.h(), r3 = false, e3 = new t4.l(), o3 = 0; o3 < i5.I(); o3++)
            if (i5.D(o3, h3), s4.contains(h3) && (e3.L(h3), n4.xj(o3, e3) == -1)) {
              if (r3)
                throw t4.i.Ra();
              r3 = true, o3 = new t4.l(), i5.Ap(o3, false), n4.reset(o3, 8), o3 = -1;
            }
          return n4;
        }, i4.gR = function(i5, s4, n4) {
          var h3 = new t4.l(), r3 = new t4.l();
          i5.yc(h3), s4.yc(r3), h3.X(n4, n4), r3.X(n4, n4);
          var e3 = new t4.l();
          e3.L(h3), e3.Fa(r3), i5 = i5.Ha(), s4 = s4.Ha();
          var o3 = new t4.sC();
          o3.WB(n4);
          var a3 = false;
          for (o3.kK(); i5.ab(); )
            for (; i5.Ia(); )
              i5.ia().A(h3), h3.isIntersecting(e3) && (a3 = true, (n4 = new t4.l()).L(h3), o3.DD(i5.xb(), n4));
          if (o3.dF(), !a3)
            return null;
          for (h3 = false, o3.jK(); s4.ab(); )
            for (; s4.Ia(); )
              s4.ia().A(r3), r3.isIntersecting(e3) && (h3 = true, (n4 = new t4.l()).L(r3), o3.zD(s4.xb(), n4));
          return o3.cF(), h3 ? o3 : null;
        }, i4.hR = function(i5, s4, n4, h3, r3) {
          var e3 = i5.K(), o3 = s4.K(), a3 = new t4.l(), u3 = new t4.l();
          i5.yc(a3), s4.yc(u3), a3.X(n4, n4), u3.X(n4, n4);
          var f3 = new t4.l();
          f3.L(a3), f3.Fa(u3);
          var c3 = new t4.sC();
          c3.WB(n4);
          var l3 = false;
          c3.kK();
          var p3 = 0;
          for (n4 = i5.ea(); p3 < n4; p3++)
            h3 && e3 == 1736 && !i5.Gv(p3) || (i5.Tj(p3, a3), a3.isIntersecting(f3) && (l3 = true, c3.DD(p3, a3)));
          if (c3.dF(), !l3)
            return null;
          for (i5 = false, c3.jK(), h3 = 0, n4 = s4.ea(); h3 < n4; h3++)
            r3 && o3 == 1736 && !s4.Gv(h3) || (s4.Tj(h3, u3), u3.isIntersecting(f3) && (i5 = true, c3.zD(h3, u3)));
          return c3.cF(), i5 ? c3 : null;
        }, i4.Tu = function(i5, s4, n4) {
          if (i5 != s4)
            for (var h3 = 0; h3 < n4; h3++)
              i5[h3] == null ? i5[h3] = t4.h.cl(s4[h3]) : i5[h3].N(s4[h3]);
        }, i4.Ey = function(t5, i5, s4, n4) {
          var h3 = 0;
          for (n4 += 0; h3 < n4; s4++, h3++)
            t5[h3] == null && (t5[h3] = [0, 0]), t5[h3][0] = i5[s4].x, t5[h3][1] = i5[s4].y;
        }, i4.Dy = function(i5, s4, n4, h3) {
          var r3 = s4, e3 = 0;
          for (s4 = h3 + s4; r3 < s4; e3++, r3++)
            i5[r3] == null ? i5[r3] = t4.h.construct(n4[e3][0], n4[e3][1]) : i5[r3].na(n4[e3][0], n4[e3][1]);
        }, i4.fP = function(i5, s4, n4) {
          if (i5 != s4)
            for (var h3 = 0; h3 < n4; h3++)
              i5[h3] == null ? i5[h3] = new t4.Ta(s4[h3]) : s4[h3].copyTo(i5[h3]);
        }, i4.qE = function(t5, i5, s4, n4) {
          var h3 = 0;
          return t5 != null && (h3 = t5.Yd(0), n4 && !s4 || t5 == null || (h3 += 1.01 * t5.pz(0))), s4 && (i5 *= 4, h3 *= 1.01), Math.max(h3, i5);
        }, i4.oy = function(t5, s4, n4) {
          return i4.qE(t5, s4.zr(), n4, false);
        }, i4.bO = function(s4, n4) {
          var h3 = new t4.l();
          return n4.A(h3), i4.oy(s4, h3, true);
        }, i4.py = function(t5, s4) {
          return i4.qE(t5, s4.zr(), false, true);
        }, i4.Ju = function(s4, n4) {
          var h3 = new t4.l();
          return n4.A(h3), i4.py(s4, h3);
        }, i4.vG = function(i5, s4, n4, h3) {
          h3 *= h3;
          var r3 = new t4.h();
          if (r3.vc(i5, s4), (i5 = new t4.h()).vc(n4, s4), s4 = r3.Uk(), n4 = i5.Uk(), s4 <= h3 && n4 <= h3)
            return true;
          var e3 = t4.mc.ox(r3.yi(i5));
          return (e3 <= h3 * s4 || e3 <= h3 * n4) && 0 <= r3.Sh(i5);
        }, i4.ZJ = function(i5, s4, n4, h3) {
          for (var r3 = 0; r3 < s4; r3++) {
            var e3 = i5[r3].y, o3 = t4.P.Tk(e3, n4, h3);
            o3 != e3 && (i5[r3].y = o3);
          }
        }, i4;
      }();
    }(Q2 || (Q2 = {})), function(t4) {
      var i4, s4, n4 = function() {
        function t5(t6) {
          this.Za = t6;
        }
        return t5.prototype.compare = function(t6, i5, s5) {
          t6 = t6.ka(s5), s5 = this.Za.qk(i5);
          var n5 = this.Za.qk(t6);
          return s5 < n5 ? -1 : s5 == n5 ? e3.iq(i5) && e3.Iv(t6) ? -1 : e3.iq(t6) && e3.Iv(i5) ? 1 : 0 : 1;
        }, t5;
      }(), h3 = function() {
        function t5(t6) {
          this.Za = t6;
        }
        return t5.prototype.qr = function(t6, i5, s5) {
          this.Za.CX(s5, t6, i5);
        }, t5.prototype.bq = function(t6) {
          return this.Za.qk(t6);
        }, t5;
      }();
      (s4 = i4 || (i4 = {}))[s4.initialize = 0] = "initialize", s4[s4.pIn = 1] = "pIn", s4[s4.pL = 2] = "pL", s4[s4.pR = 3] = "pR", s4[s4.pT = 4] = "pT", s4[s4.right = 5] = "right", s4[s4.left = 6] = "left", s4[s4.all = 7] = "all";
      var r3 = function() {
        function i5() {
          this.Za = null, this.Si = new t4.Oc(), this.ji = new t4.ja(0), this.tg = [0, 0];
        }
        return i5.prototype.Zi = function(t5, i6) {
          this.Si.pa = t5.pa - i6, this.Si.wa = t5.wa + i6, this.ji.resize(0), this.ie = 0, this.tg[0] = 0;
        }, i5.prototype.zB = function(i6, s5, n5) {
          if (i6 > s5)
            throw t4.i.O();
          this.Si.pa = i6 - n5, this.Si.wa = s5 + n5, this.ji.resize(0), this.ie = 0, this.tg[0] = 0;
        }, i5.prototype.Wo = function(t5, i6) {
          this.Si.pa = t5 - i6, this.Si.wa = t5 + i6, this.ji.resize(0), this.ie = 0, this.tg[0] = 0;
        }, i5.prototype.next = function() {
          if (!this.Za.nq)
            throw t4.i.Hb();
          if (0 > this.ie)
            return -1;
          for (var i6 = true; i6; )
            switch (this.tg[this.ie]) {
              case 1:
                i6 = this.AU();
                break;
              case 2:
                i6 = this.BU();
                break;
              case 3:
                i6 = this.CU();
                break;
              case 4:
                i6 = this.DU();
                break;
              case 5:
                i6 = this.AW();
                break;
              case 6:
                i6 = this.fT();
                break;
              case 7:
                i6 = this.oN();
                break;
              case 0:
                i6 = this.Bz();
                break;
              default:
                throw t4.i.Ra();
            }
          return this.Qg != -1 ? this.Op() >> 1 : -1;
        }, i5.construct = function(t5) {
          var s5 = new i5();
          return s5.Za = t5, s5.ji.Jb(20), s5.ie = -1, s5;
        }, i5.prototype.Bz = function() {
          return this.Qg = this.qH = this.Oi = this.Mc = -1, this.Za.ne != null && 0 < this.Za.ne.size ? (this.tg[0] = 1, this.Oi = this.Za.kf, true) : (this.ie = -1, false);
        }, i5.prototype.AU = function() {
          if (this.Mc = this.Oi, this.Mc == -1)
            return this.Qg = this.ie = -1, false;
          var t5 = this.Za.Pp(this.Mc);
          return this.Si.wa < t5 ? (t5 = this.Za.pk(this.Mc), this.Oi = this.Za.sj(this.Mc), t5 != -1 && (this.gi = this.Za.ml(t5), this.tg[++this.ie] = 6), true) : t5 < this.Si.pa ? (t5 = this.Za.pk(this.Mc), this.Oi = this.Za.nk(this.Mc), t5 != -1 && (this.gi = this.Za.bs(t5), this.tg[++this.ie] = 5), true) : (this.tg[this.ie] = 2, this.qH = this.Mc, t5 = this.Za.pk(this.Mc), this.Oi = this.Za.sj(this.Mc), t5 != -1 && (this.gi = this.Za.ml(t5), this.tg[++this.ie] = 7), true);
        }, i5.prototype.BU = function() {
          if (this.Mc = this.Oi, this.Mc == -1)
            return this.tg[this.ie] = 3, this.Oi = this.Za.nk(this.qH), true;
          if (this.Za.Pp(this.Mc) < this.Si.pa) {
            var t5 = this.Za.pk(this.Mc);
            return this.Oi = this.Za.nk(this.Mc), t5 != -1 && (this.gi = this.Za.bs(t5), this.tg[++this.ie] = 5), true;
          }
          return t5 = this.Za.pk(this.Mc), this.Oi = this.Za.sj(this.Mc), t5 != -1 && (this.gi = this.Za.ml(t5), this.tg[++this.ie] = 7), (t5 = this.Za.nk(this.Mc)) != -1 && this.ji.add(t5), true;
        }, i5.prototype.CU = function() {
          if (this.Mc = this.Oi, this.Mc == -1)
            return this.tg[this.ie] = 4, true;
          if (this.Si.wa < this.Za.Pp(this.Mc)) {
            var t5 = this.Za.pk(this.Mc);
            return this.Oi = this.Za.sj(this.Mc), t5 != -1 && (this.gi = this.Za.ml(t5), this.tg[++this.ie] = 6), true;
          }
          return t5 = this.Za.pk(this.Mc), this.Oi = this.Za.nk(this.Mc), t5 != -1 && (this.gi = this.Za.ml(t5), this.tg[++this.ie] = 7), (t5 = this.Za.sj(this.Mc)) != -1 && this.ji.add(t5), true;
        }, i5.prototype.DU = function() {
          if (this.ji.size == 0)
            return this.Qg = this.ie = -1, false;
          this.Mc = this.ji.get(this.ji.size - 1), this.ji.resize(this.ji.size - 1);
          var t5 = this.Za.pk(this.Mc);
          return t5 != -1 && (this.gi = this.Za.ml(t5), this.tg[++this.ie] = 7), this.Za.sj(this.Mc) != -1 && this.ji.add(this.Za.sj(this.Mc)), this.Za.nk(this.Mc) != -1 && this.ji.add(this.Za.nk(this.Mc)), true;
        }, i5.prototype.fT = function() {
          return this.Qg = this.gi, this.Qg != -1 && e3.iq(this.Op()) && this.Za.qk(this.Op()) <= this.Si.wa ? (this.gi = this.NF(), false) : (this.ie--, true);
        }, i5.prototype.AW = function() {
          return this.Qg = this.gi, this.Qg != -1 && e3.Iv(this.Op()) && this.Za.qk(this.Op()) >= this.Si.pa ? (this.gi = this.LR(), false) : (this.ie--, true);
        }, i5.prototype.oN = function() {
          return this.Qg = this.gi, this.Qg != -1 && e3.iq(this.Op()) ? (this.gi = this.NF(), false) : (this.ie--, true);
        }, i5.prototype.NF = function() {
          return this.Za.Uf ? this.Za.bg.lb(this.Qg) : this.Za.Vi.lb(this.Qg);
        }, i5.prototype.LR = function() {
          return this.Za.Uf ? this.Za.bg.xe(this.Qg) : this.Za.Vi.xe(this.Qg);
        }, i5.prototype.Op = function() {
          return this.Za.Uf ? this.Za.bg.ka(this.Qg) : this.Za.Vi.getData(this.Qg);
        }, i5;
      }();
      t4.AY = r3;
      var e3 = function() {
        function i5(t5) {
          this.Cm = this.bi = this.bg = this.Vi = this.Mm = this.Gj = this.ne = this.Hj = null, this.Uf = t5, this.nq = this.Uv = false;
        }
        return i5.prototype.mr = function() {
          this.Pk(true);
        }, i5.prototype.Dr = function(i6, s5) {
          if (!this.Uv)
            throw t4.i.Hb();
          this.Hj.push(new t4.Oc(i6, s5));
        }, i5.prototype.Hp = function() {
          if (!this.Uv)
            throw t4.i.ga("invalid call");
          this.Uv = false, this.nq = true, this.Uf || (this.qS(), this.aw = this.Hj.length);
        }, i5.prototype.xj = function(i6) {
          if (!this.Uf || !this.nq)
            throw t4.i.O("invalid call");
          if (this.kf == -1) {
            var s5 = this.Hj.length;
            if (this.dA) {
              var n5 = new t4.ja(0);
              n5.Jb(2 * s5), this.XI(n5), this.bi.Jb(2 * s5), this.bi.resize(0), this.WI(n5), this.Mm.resize(s5, -1), this.Mm.Yj(-1, 0, s5), this.dA = false;
            } else
              this.Mm.Yj(-1, 0, s5);
            this.kf = this.Vu();
          }
          s5 = this.kG(i6 << 1, this.kf), n5 = this.bg.addElement(1 + (i6 << 1), this.rz(s5)), this.QJ(s5, n5), this.Mm.set(i6, s5), this.aw++;
        }, i5.prototype.remove = function(i6) {
          if (!this.Uf || !this.nq)
            throw t4.i.ga("invalid call");
          var s5 = this.Mm.get(i6);
          if (s5 == -1)
            throw t4.i.O("the interval does not exist in the interval tree");
          this.Mm.set(i6, -1), this.aw--;
          var n5 = this.rz(s5), h4 = this.bg.UR(n5);
          this.bg.wd(this.rR(s5), n5), this.bg.wd(this.OR(s5), n5), (i6 = this.bg.size(n5)) == 0 && (this.bg.HP(n5), this.UJ(h4, -1)), this.Gj.kd(s5), n5 = this.PF(h4);
          var r4 = this.sj(h4), e4 = this.nk(h4);
          for (s5 = 0; !(0 < i6 || h4 == this.kf || r4 != -1 && e4 != -1); )
            h4 == this.sj(n5) ? r4 != -1 ? (this.Qk(n5, r4), this.Wj(r4, n5), this.Qk(h4, -1)) : e4 != -1 ? (this.Qk(n5, e4), this.Wj(e4, n5), this.Sk(h4, -1)) : this.Qk(n5, -1) : r4 != -1 ? (this.Sk(n5, r4), this.Wj(r4, n5), this.Qk(h4, -1)) : e4 != -1 ? (this.Sk(n5, e4), this.Wj(e4, n5), this.Sk(h4, -1)) : this.Sk(n5, -1), this.Wj(h4, -1), s5++, h4 = n5, i6 = (n5 = this.pk(h4)) != -1 ? this.bg.size(n5) : 0, r4 = this.sj(h4), e4 = this.nk(h4), n5 = this.PF(h4);
        }, i5.prototype.reset = function() {
          if (!this.Uf || !this.nq)
            throw t4.i.O("invalid call");
          this.Pk(false);
        }, i5.prototype.size = function() {
          return this.aw;
        }, i5.prototype.getIterator = function() {
          return r3.construct(this);
        }, i5.prototype.XI = function(t5) {
          for (var i6 = this.Hj.length, s5 = 0; s5 < 2 * i6; s5++)
            t5.add(s5);
          this.DX(t5, 2 * i6);
        }, i5.prototype.WI = function(t5) {
          for (var i6 = NaN, s5 = 0; s5 < t5.size; s5++) {
            var n5 = t5.get(s5), h4 = this.qk(n5);
            h4 != i6 && (this.bi.add(n5), i6 = h4);
          }
        }, i5.prototype.qS = function() {
          var i6 = this.Hj.length, s5 = new t4.ja(0);
          s5.Jb(2 * i6), this.XI(s5), this.bi.Jb(2 * i6), this.bi.resize(0), this.WI(s5), this.Gj.Ee(i6), this.Vi.hn(2 * i6);
          var n5 = t4.Zc.Qh(i6);
          for (n5.Yj(-1, 0, i6), this.kf = this.Vu(), i6 = 0; i6 < s5.size; i6++) {
            var h4 = s5.get(i6), r4 = n5.get(h4 >> 1);
            r4 != -1 ? this.QJ(r4, this.Vi.addElement(this.rz(r4), h4)) : (r4 = this.kG(h4, this.kf), n5.set(h4 >> 1, r4));
          }
        }, i5.prototype.kG = function(i6, s5) {
          var n5 = s5, h4 = s5, r4 = -1, e4 = 0, o3 = this.bi.size - 1, a3 = 0, u3 = i6 >> 1, f3 = NaN, c3 = NaN, l3 = true, p3 = this.yR(u3);
          for (u3 = this.vR(u3); l3; ) {
            e4 < o3 ? (a3 = e4 + t4.P.truncate((o3 - e4) / 2), this.bz(n5) == -1 && this.AJ(n5, this.bi.get(a3), this.bi.get(a3 + 1))) : this.bz(n5) == -1 && this.AJ(n5, this.bi.get(e4), this.bi.get(e4));
            var v3 = this.Pp(n5);
            if (u3 < v3)
              s5 != -1 && (s5 == n5 ? (h4 = n5, f3 = v3, c3 = (s5 = this.sj(n5)) != -1 ? this.Pp(s5) : NaN) : c3 > v3 && (v3 < f3 ? this.Qk(h4, n5) : this.Sk(h4, n5), this.Sk(n5, s5), this.Uf && (this.Wj(n5, h4), this.Wj(s5, n5)), h4 = n5, f3 = v3, s5 = -1, c3 = NaN)), (o3 = this.sR(n5)) == -1 && (o3 = this.Vu(), this.ZW(n5, o3)), n5 = o3, o3 = a3;
            else if (p3 > v3)
              s5 != -1 && (s5 == n5 ? (h4 = n5, f3 = v3, c3 = (s5 = this.nk(n5)) != -1 ? this.Pp(s5) : NaN) : c3 < v3 && (v3 < f3 ? this.Qk(h4, n5) : this.Sk(h4, n5), this.Qk(n5, s5), this.Uf && (this.Wj(n5, h4), this.Wj(s5, n5)), h4 = n5, f3 = v3, s5 = -1, c3 = NaN)), (e4 = this.PR(n5)) == -1 && (e4 = this.Vu(), this.jX(n5, e4)), n5 = e4, e4 = a3 + 1;
            else {
              (l3 = this.pk(n5)) == -1 && (l3 = this.uP(n5), this.UJ(n5, l3));
              var y3 = this.aN(l3, i6);
              r4 = this.sP(), this.mX(r4, l3), this.YW(r4, y3), n5 != s5 && (v3 < f3 ? this.Qk(h4, n5) : this.Sk(h4, n5), this.Uf && this.Wj(n5, h4), s5 != -1 && (c3 < v3 ? this.Qk(n5, s5) : this.Sk(n5, s5), this.Uf && this.Wj(s5, n5))), l3 = false;
            }
          }
          return r4;
        }, i5.prototype.Vu = function() {
          return this.ne.De();
        }, i5.prototype.uP = function(t5) {
          return this.Uf ? this.bg.Rr(t5) : this.Vi.Rh(t5);
        }, i5.prototype.sP = function() {
          return this.Gj.De();
        }, i5.prototype.Pk = function(i6) {
          i6 ? (this.Uv = this.dA = true, this.nq = false, this.bi == null ? this.bi = t4.Zc.Qh(0) : this.bi.resize(0), this.Hj == null ? this.Hj = [] : this.Hj.length = 0) : this.dA = false, this.Uf ? this.Mm == null ? (this.Mm = t4.Zc.Qh(0), this.bg = new t4.$j(), this.bg.Xo(new n4(this))) : this.bg.clear() : this.Vi == null ? this.Vi = new t4.lp() : this.Vi.clear(), this.ne == null ? (this.Gj = new t4.ad(3), this.ne = new t4.ad(this.Uf ? 8 : 7)) : (this.Gj.oj(false), this.ne.oj(false)), this.kf = -1, this.aw = 0;
        }, i5.prototype.AJ = function(t5, i6, s5) {
          this.SW(t5, i6), this.TW(t5, s5);
        }, i5.prototype.Pp = function(t5) {
          var i6 = this.bz(t5);
          return i6 == -1 ? NaN : (i6 = this.qk(i6)) == (t5 = this.qk(this.bR(t5))) ? i6 : 0.5 * (i6 + t5);
        }, i5.prototype.SW = function(t5, i6) {
          this.ne.T(t5, 0, i6);
        }, i5.prototype.TW = function(t5, i6) {
          this.ne.T(t5, 1, i6);
        }, i5.prototype.ZW = function(t5, i6) {
          this.ne.T(t5, 3, i6);
        }, i5.prototype.jX = function(t5, i6) {
          this.ne.T(t5, 4, i6);
        }, i5.prototype.UJ = function(t5, i6) {
          this.ne.T(t5, 2, i6);
        }, i5.prototype.Qk = function(t5, i6) {
          this.ne.T(t5, 5, i6);
        }, i5.prototype.Sk = function(t5, i6) {
          this.ne.T(t5, 6, i6);
        }, i5.prototype.Wj = function(t5, i6) {
          this.ne.T(t5, 7, i6);
        }, i5.prototype.mX = function(t5, i6) {
          this.Gj.T(t5, 0, i6);
        }, i5.prototype.aN = function(t5, i6) {
          return this.Uf ? this.bg.addElement(i6, t5) : this.Vi.addElement(t5, i6);
        }, i5.prototype.YW = function(t5, i6) {
          this.Gj.T(t5, 1, i6);
        }, i5.prototype.QJ = function(t5, i6) {
          this.Gj.T(t5, 2, i6);
        }, i5.prototype.ml = function(t5) {
          return this.Uf ? this.bg.sc(t5) : this.Vi.sc(t5);
        }, i5.prototype.bs = function(t5) {
          return this.Uf ? this.bg.Gc(t5) : this.Vi.Gc(t5);
        }, i5.iq = function(t5) {
          return (1 & t5) == 0;
        }, i5.Iv = function(t5) {
          return (1 & t5) == 1;
        }, i5.prototype.bz = function(t5) {
          return this.ne.U(t5, 0);
        }, i5.prototype.bR = function(t5) {
          return this.ne.U(t5, 1);
        }, i5.prototype.pk = function(t5) {
          return this.ne.U(t5, 2);
        }, i5.prototype.sR = function(t5) {
          return this.ne.U(t5, 3);
        }, i5.prototype.PR = function(t5) {
          return this.ne.U(t5, 4);
        }, i5.prototype.sj = function(t5) {
          return this.ne.U(t5, 5);
        }, i5.prototype.nk = function(t5) {
          return this.ne.U(t5, 6);
        }, i5.prototype.PF = function(t5) {
          return this.ne.U(t5, 7);
        }, i5.prototype.rz = function(t5) {
          return this.Gj.U(t5, 0);
        }, i5.prototype.rR = function(t5) {
          return this.Gj.U(t5, 1);
        }, i5.prototype.OR = function(t5) {
          return this.Gj.U(t5, 2);
        }, i5.prototype.yR = function(t5) {
          return this.Hj[t5].pa;
        }, i5.prototype.vR = function(t5) {
          return this.Hj[t5].wa;
        }, i5.prototype.DX = function(i6, s5) {
          this.Cm == null && (this.Cm = new t4.Zt());
          var n5 = new h3(this);
          this.Cm.sort(i6, 0, s5, n5);
        }, i5.prototype.CX = function(t5, s5, n5) {
          var h4 = this;
          t5.Wd(s5, n5, function(t6, s6) {
            var n6 = h4.qk(t6), r4 = h4.qk(s6);
            return n6 < r4 || n6 == r4 && i5.iq(t6) && i5.Iv(s6) ? -1 : 1;
          });
        }, i5.prototype.qk = function(t5) {
          var s5 = this.Hj[t5 >> 1];
          return i5.iq(t5) ? s5.pa : s5.wa;
        }, i5;
      }();
      t4.ur = e3;
    }(Q2 || (Q2 = {})), function(t4) {
      var i4 = function() {
        function i5(i6) {
          if (i6 == null)
            throw t4.i.ga("Invalid arguement");
          this.hf = i6;
          var s4 = i6.iR();
          s4.cS() ? i6.ef.DG() ? this.no = t4.ui.PannableFold : this.no = t4.ui.Clip : this.no = t4.ui.DontClip, s4.dS() ? i6.$f.DG() ? this.Sm = t4.ui.PannableFold : this.Sm = t4.ui.Clip : this.Sm = t4.ui.DontClip, this.Dm = s4.Lr, this.hH = s4.Xu, i6 = this.hf.nH, this.WG = i6.ks(2147483648), this.Wv = i6.ks(1073741824);
        }
        return i5.Bh = function(t5, i6, s4) {
          return i6.yw.Bh(t5, s4);
        }, i5.Tt = function(t5, i6, s4, n4) {
          return t5.yw.Tt(i6, s4, n4);
        }, i5.St = function(t5, i6, s4, n4) {
          if (s4 = 0 > s4 ? i6.length : s4, (t5 = t5.yw.Tt(i6, s4, n4)) == s4)
            return t5;
          for (var h3 = i6 = 0; h3 < s4; h3++) {
            var r3 = n4[h3];
            r3.isNaN() || (i6 < h3 && n4[i6].N(r3), i6++);
          }
          for (; i6 < s4; i6++)
            n4[i6].Sc();
          return t5;
        }, i5.transform = function(s4, n4, h3, r3, e3) {
          if (s4.isIdentity())
            return t4.ua.fP(r3, n4, h3), h3;
          for (var o3 = [], a3 = 0, u3 = 0; u3 < h3; ) {
            for (var f3 = Math.min(o3.length, h3 - u3), c3 = u3, l3 = 0; c3 < f3; c3++, l3++)
              o3[l3] == null ? o3[l3] = n4[c3].D() : n4[c3].D(o3[l3]);
            var p3 = e3 ? i5.St(s4, o3, f3, o3) : i5.Tt(s4, o3, f3, o3);
            for (l3 = c3 = 0; c3 < p3; c3++, l3++)
              r3[u3] == null && (r3[u3] = new t4.Ta(n4[u3])), r3[u3].Db(o3[l3]);
            u3 += f3, a3 += p3;
          }
          return a3;
        }, i5.prototype.Tt = function(i6, s4, n4) {
          if (this.hf.isIdentity())
            return i6 != n4 && t4.ua.Tu(n4, i6, s4), s4;
          var h3 = this.hf.ef, r3 = this.hf.$f, e3 = h3.Tb(), o3 = r3.Tb();
          if (e3 == 0 && e3 === o3) {
            var a3 = h3.Sp();
            return r3 = a3 / (r3 = r3.Sp()), (a3 = new t4.Ed()).Jt(r3, r3), a3.aY(i6, s4, n4), s4;
          }
          if (a3 = t4.P.Hu(Math.min(s4, 64)), e3 == 3) {
            var u3 = h3.Li;
            e3 = (h3 = u3.hk()).Tb(), n4 != i6 && t4.ua.Tu(n4, i6, s4), t4.Ab.bl(u3, n4, s4, true), u3.St(t4.dm.forward, n4, s4), t4.Ab.al(u3, n4, s4, true);
          }
          if (e3 == 3 || o3 === 3)
            throw t4.i.ga("image: transform_in_place_");
          if (e3 == 2)
            this.no == t4.ui.Clip ? (n4 != i6 && t4.ua.Tu(n4, i6, s4), i6 = h3.ol(), t4.Ab.JS(i6, h3, n4, s4)) : (n4 != i6 && t4.ua.Tu(n4, i6, s4), h3.Xc() && (e3 = h3.Yd(0), u3 = h3.Le(), t4.Ab.AX(n4, s4, u3, e3), t4.Ab.lF(n4, s4, h3, 0))), t4.Ab.DL(h3, n4, s4, a3);
          else
            for (e3 = h3.Yd(0), u3 = h3.Le(), h3 = 0; h3 < s4; h3++)
              t4.Ab.BX(i6[h3], u3, e3, n4[h3]);
          for (t4.Ab.BL(this.hf, n4, s4, a3), i6 = 0, (o3 = o3 == 2) ? i6 = r3.Bi() : isNaN(this.Dm) || (i6 = this.Dm), o3 && this.Sm != t4.ui.Clip || t4.Ab.lF(n4, s4, r3.tc(), i6), o3 && (t4.Ab.tG(n4, s4, r3, this.Sm), t4.Ab.CL(r3, n4, s4, a3)), i6 = s4, h3 = 0; h3 < s4; ++h3)
            n4[h3].isNaN() && i6--;
          return i6;
        }, i5.prototype.Bh = function(i6, s4) {
          if (this.hf.isIdentity() || i6.B())
            return i6;
          if (i6.K() == 33)
            return this.SI(i6);
          var n4 = this.hf.ef, h3 = this.hf.$f, r3 = n4.Tb(), e3 = h3.Tb();
          if (r3 == 0 && r3 == e3)
            return s4 = n4.Sp(), s4 /= h3 = h3.Sp(), (h3 = new t4.Ed()).Jt(s4, s4), (i6 = t4.ba.kg(i6)).Pc(h3), i6;
          switch (i6.K()) {
            case 1607:
            case 1736:
              i6 = this.QI(i6, s4);
              break;
            case 550:
              i6 = this.aW(i6, s4);
              break;
            case 197:
              i6 = this.$V(i6, s4);
              break;
            default:
              throw t4.i.ga("");
          }
          return i6;
        }, i5.prototype.SI = function(i6) {
          var s4 = i6.D(), n4 = [];
          return n4[0] = s4, this.Tt(n4, 1, n4), (i6 = new t4.Ta(i6)).Db(n4[0]), i6;
        }, i5.prototype.QI = function(i6, s4) {
          if (i6.vm())
            throw t4.i.ga("curves not supported");
          var n4 = i6.K();
          if (n4 == 1736)
            return this.bW(i6, s4);
          if (n4 == 1607)
            return this.cW(i6, s4);
          throw t4.i.ga("projectMultiPath");
        }, i5.prototype.bW = function(s4, n4) {
          var h3 = this.hf.ef, r3 = this.hf.$f, e3 = h3.Tb(), o3 = r3.Tb(), a3 = t4.P.Hu(Math.min(s4.I(), 64)), u3 = t4.Ea.kg(s4);
          e3 == 3 && (e3 = (h3 = (s4 = h3.Li).hk()).Tb(), u3 = s4.bl(u3, true), this.yp(s4, t4.dm.forward, u3), u3 = s4.al(u3, true)), s4 = null, o3 == 3 && (o3 = (r3 = (s4 = r3.Li).hk()).Tb());
          var f3 = e3 == 2, c3 = o3 == 2, l3 = c3 ? r3.tc() : r3, p3 = !c3 && !this.Wv;
          o3 = false;
          var v3 = u3;
          if (f3) {
            if ((v3 = t4.Ab.OI(v3, h3, this.no, n4)).B())
              return v3;
          } else {
            if (u3 = new t4.l(), v3.yc(u3), e3 = h3.Le(), u3.G < e3.G || u3.H > e3.H) {
              var y3 = t4.l.construct(u3.v - 1, e3.G, u3.C + 1, e3.H);
              if ((v3 = t4.ti.Pu(v3, y3, h3, NaN, 0, n4)).B())
                return v3;
            }
            u3.S() > 2 * e3.S() && (v3 = t4.Ab.Jp(v3, -2 * e3.S(), 2 * e3.S(), h3, true, 0, true, n4));
          }
          u3 = this.hH, (e3 = !isNaN(u3)) && (v3 = t4.Zl.local().W(v3, u3, n4)), y3 = c3 ? r3.mk() : null;
          var b3 = NaN;
          f3 && (b3 = h3.Bi());
          var d3 = r3.Yr() != null;
          if (this.WG)
            f3 && (t4.Ab.wr(h3, b3, v3, a3), e3 && (f3 = h3.jh(), u3 *= (b3 = h3.tc().jh()) / f3)), t4.Ab.vr(this.hf, v3, p3, a3), e3 && (f3 = h3.tc().jh(), u3 *= (b3 = r3.tc().jh()) / f3), h3 = v3;
          else {
            var g3 = new t4.Ua(v3.description);
            g3.yD(v3), f3 && (t4.Ab.wr(h3, b3, g3, a3), e3 && (f3 = h3.jh(), u3 *= (b3 = h3.tc().jh()) / f3)), t4.Ab.vr(this.hf, g3, p3, a3), e3 && (f3 = h3.tc().rm(), u3 *= (b3 = r3.tc().rm()) / f3), p3 = NaN, c3 ? (y3 = r3.mk(), p3 = r3.Bi()) : isNaN(this.Dm) || (p3 = this.Dm), f3 = i5.vv(h3) | i5.vv(r3), b3 = 10 * l3.Yd(0), this.Wv && (f3 = 3, b3 = 0), h3 = t4.Ab.PQ(v3, h3, g3, l3, p3, n4, f3, b3);
          }
          return d3 && (h3 = t4.Ab.SD(h3, r3, n4)), c3 && (o3 || (c3 = l3.Le().S(), h3.Vg(0, 0).S() >= c3 - l3.Yd(0) && (l3 = y3.getNorthPoleLocation(), c3 = y3.getSouthPoleLocation(), v3 = y3.getNorthPoleGeometry(), y3 = y3.getSouthPoleGeometry(), p3 = 0, v3 == t4.Eg.PE_POLE_POINT && l3 != t4.Eg.PE_POLE_OUTSIDE_BOUNDARY && (p3 = 1), y3 == t4.Eg.PE_POLE_POINT && c3 != t4.Eg.PE_POLE_OUTSIDE_BOUNDARY && (p3 |= 2), p3 !== 0 && (o3 = true))), h3 = t4.Ab.Hz(h3, r3, this.Sm, n4), e3 && (h3 = t4.Zl.local().W(h3, u3, n4)), t4.Ab.Kx(r3, h3, a3)), h3.B() || (o3 && (h3 = t4.$l.local().W(h3, r3, false, n4)), s4 != null && (h3 = s4.al(h3, false), this.yp(s4, t4.dm.reverse, h3), h3 = s4.bl(h3, false))), h3;
        }, i5.vv = function(i6) {
          if (i6.Tb() != 2)
            return 0;
          var s4 = 0, n4 = i6.mk();
          i6 = n4.getNorthPoleLocation();
          var h3 = n4.getSouthPoleLocation(), r3 = n4.getNorthPoleGeometry();
          return n4 = n4.getSouthPoleGeometry(), r3 == t4.Eg.PE_POLE_POINT && i6 != t4.Eg.PE_POLE_OUTSIDE_BOUNDARY && (s4 = 1), n4 == t4.Eg.PE_POLE_POINT && h3 != t4.Eg.PE_POLE_OUTSIDE_BOUNDARY && (s4 |= 2), s4;
        }, i5.prototype.cW = function(s4, n4) {
          var h3 = this.hf.ef, r3 = this.hf.$f, e3 = h3.Tb(), o3 = r3.Tb(), a3 = t4.P.Hu(Math.min(s4.I(), 64)), u3 = t4.Ua.kg(s4);
          e3 == 3 && (e3 = (h3 = (s4 = h3.Li).hk()).Tb(), u3 = s4.bl(u3, true), this.yp(s4, t4.dm.forward, u3), u3 = s4.al(u3, true)), s4 = null, o3 == 3 && (o3 = (r3 = (s4 = r3.Li).hk()).Tb());
          var f3 = e3 == 2;
          e3 = (o3 = o3 == 2) ? r3.tc() : r3;
          var c3 = !o3 && !this.Wv;
          if (f3) {
            if ((u3 = t4.Ab.OI(u3, h3, this.no, n4)).B())
              return u3;
          } else {
            var l3 = new t4.l();
            u3.yc(l3);
            var p3 = h3.Le();
            if ((l3.G < p3.G || l3.H > p3.H) && (l3 = t4.l.construct(l3.v - 1, p3.G, l3.C + 1, p3.H), (u3 = t4.ti.Pu(u3, l3, h3, NaN, 0, n4)).B()))
              return u3;
          }
          var v3 = NaN;
          f3 && (v3 = h3.Bi()), l3 = r3.Yr() != null, p3 = this.hH;
          var y3 = !isNaN(p3);
          if (y3 && (u3 = t4.Zl.local().W(u3, p3, n4)), this.WG)
            f3 && t4.Ab.wr(h3, v3, u3, a3), y3 && (f3 = h3.jh(), p3 *= (v3 = h3.tc().jh()) / f3), t4.Ab.vr(this.hf, u3, c3, a3), y3 && (f3 = h3.tc().jh(), p3 *= (v3 = r3.tc().jh()) / f3), h3 = u3;
          else {
            var b3 = new t4.Ua(u3.description);
            b3.yD(u3), f3 && (t4.Ab.wr(h3, v3, b3, a3), y3 && (f3 = h3.jh(), p3 *= (v3 = h3.tc().jh()) / f3)), t4.Ab.vr(this.hf, b3, c3, a3), y3 && (f3 = h3.tc().jh(), p3 *= (v3 = r3.tc().jh()) / f3), c3 = NaN, o3 ? c3 = r3.Bi() : isNaN(this.Dm) || (c3 = this.Dm), f3 = i5.vv(h3) | i5.vv(r3), v3 = 10 * e3.Yd(0), this.Wv && (f3 = 3, v3 = 0), h3 = t4.Ab.QQ(u3, h3, b3, e3, c3, n4, f3, v3);
          }
          return l3 && (h3 = t4.Ab.SD(h3, r3, n4)), o3 && (h3 = t4.Ab.Hz(h3, r3, this.Sm, n4), y3 && (h3 = t4.Zl.local().W(h3, p3, n4)), t4.Ab.Kx(r3, h3, a3)), h3.B() || s4 != null && (h3 = s4.al(h3, false), this.yp(s4, t4.dm.reverse, h3), h3 = s4.bl(h3, false)), h3;
        }, i5.prototype.$V = function(i6, s4) {
          var n4 = (i6.da() + i6.S()) / 400;
          return n4 != 0 ? (n4 = t4.Zl.local().W(i6, n4, s4), n4 = this.QI(n4, s4), s4 = i6.Ja(), n4.dn(s4)) : (s4 = new t4.Ta(i6.Kp()), n4 = this.SI(s4), s4 = i6.Ja(), n4.B() ? s4.Pa() : (i6.copyTo(s4), i6 = n4.D(), s4.L(i6.x, i6.y, i6.x, i6.y))), s4;
        }, i5.prototype.aW = function(i6, s4) {
          i6 = t4.ba.kg(i6);
          var n4 = this.hf.ef, h3 = this.hf.$f, r3 = n4.Tb(), e3 = h3.Tb(), o3 = t4.P.Hu(Math.min(i6.I(), 64));
          if (r3 == 3) {
            var a3 = n4.Li;
            r3 = (n4 = a3.hk()).Tb(), i6 = a3.al(i6, true), this.yp(a3, t4.dm.forward, i6), i6 = a3.bl(i6, true);
          }
          if (r3 == 2) {
            if (this.no == t4.ui.Clip ? i6 = t4.Zj.local().W(i6, n4.ol(), n4, s4) : n4.Xc() && (r3 = new t4.l(), i6.yc(r3), n4.Le().contains(r3) || (this.no == t4.ui.PannableFold && (i6 = t4.Ab.nj(i6, n4)), t4.Ab.Lt(i6, n4.Le(), n4.Yd(0), true), i6 = t4.Ab.Hn(i6, n4, 0, true, 0, s4))), i6.B())
              return i6;
            t4.Ab.wr(n4, 0, i6, o3);
          } else
            t4.Ab.Lt(i6, n4.Le(), n4.Yd(0), true);
          return t4.Ab.vr(this.hf, i6, false, o3), n4 = 0, r3 = false, a3 = null, e3 == 3 && (r3 = true, e3 = (h3 = (a3 = h3.Li).hk()).Tb()), (e3 = e3 == 2) ? n4 = h3.Bi() : isNaN(this.Dm) || (n4 = this.Dm), e3 && this.Sm != t4.ui.Clip || (i6 = t4.Ab.Hn(i6, h3.tc(), n4, false, 0, s4)), e3 && (i6 = t4.Ab.Hz(i6, h3, this.Sm, s4), t4.Ab.Kx(h3, i6, o3), i6.B()) || r3 && (i6 = a3.al(i6, true), this.yp(a3, t4.dm.reverse, i6), i6 = a3.bl(i6, true)), i6;
        }, i5.prototype.yp = function(i6, s4, n4) {
          var h3 = n4.I();
          if (h3 != 0) {
            for (var r3 = n4.vb(0), e3 = t4.P.mg(200, 0), o3 = [], a3 = 0; a3 < h3; ) {
              var u3 = Math.min(100, h3 - a3);
              r3.Xw(2 * a3, 2 * u3, e3, 2, true);
              for (var f3 = 0; f3 < u3; ++f3)
                o3[f3] = t4.h.construct(e3[2 * a3], e3[2 * a3 + 1]);
              i6.St(s4, o3, u3), a3 += u3;
            }
            n4.Qc(1993);
          }
        }, i5.Py = function(i6, s4, n4) {
          if (i6 == null || s4 == null || !s4.Xc())
            throw t4.i.ga("Invalid Arguement");
          if (i6.B())
            return i6;
          var h3 = i6.K();
          return h3 == 197 ? (h3 = new t4.Ea(i6.description)).bd(i6, false) : t4.ba.zd(h3) ? (h3 = new t4.Ua(i6.description)).pc(i6, true) : h3 = i6, (h3 = t4.Ab.nj(h3, s4)).B() ? h3 : t4.Ab.Hn(h3, s4, 0, h3 != i6, 0, n4);
        }, i5.pj = function(s4, n4, h3, r3) {
          if (s4 == null || n4 == null || !n4.Xc())
            throw t4.i.ga("Invalid Arguement");
          if (s4.B())
            return s4;
          var e3 = s4.K();
          if (t4.ba.Ic(e3)) {
            s4 = t4.Ab.nj(s4, n4), e3 = new t4.l(), s4.A(e3);
            for (var o3 = t4.ua.oy(n4, e3, false), a3 = n4.ih(), u3 = Math.floor((e3.v - a3.v) / a3.S()) * a3.S() + a3.v; u3 < e3.C; )
              u3 > e3.v + o3 && u3 < e3.C - o3 && (s4 = t4.Ab.pS(s4, n4, h3, u3)), u3 += a3.S();
          } else {
            if (e3 == 197)
              return (e3 = new t4.Ea(s4.description)).bd(s4, false), i5.pj(e3, n4, h3, r3);
            if (t4.ba.zd(e3))
              return (e3 = new t4.Ua(s4.description)).pc(s4, true), i5.pj(e3, n4, h3, r3);
          }
          return i5.Py(s4, n4, r3);
        }, i5;
      }();
      t4.du = i4;
    }(Q2 || (Q2 = {})), function(t4) {
      var i4 = function(i5) {
        function s4(s5, n4, h3, r3) {
          var e3 = i5.call(this) || this;
          return s5 === void 0 ? e3.description = t4.fe.pg() : h3 === void 0 ? e3.description = s5 : (e3.description = t4.fe.pg(), e3.UB(s5, n4), e3.Sl(h3, r3)), e3;
        }
        return _2(s4, i5), s4.prototype.K = function() {
          return 322;
        }, s4.prototype.Rb = function() {
          var t5 = this.ta - this.qa, i6 = this.oa - this.ma;
          return Math.sqrt(t5 * t5 + i6 * i6);
        }, s4.prototype.Di = function(t5) {
          var i6 = this.ta - this.qa, s5 = this.oa - this.ma;
          return Math.sqrt(i6 * i6 + s5 * s5) <= t5;
        }, s4.prototype.Rn = function() {
          return false;
        }, s4.prototype.lg = function() {
          var i6 = new t4.h();
          return i6.vc(this.xc(), this.bc()), i6;
        }, s4.YO = function(t5, i6) {
          return new s4(t5.x, t5.y, i6.x, i6.y);
        }, s4.prototype.dn = function(i6) {
          i6.Pa(), i6.Pf(this.description);
          var s5 = new t4.l();
          this.A(s5), i6.Zo(s5), s5 = 1;
          for (var n4 = this.description.Ba; s5 < n4; s5++)
            for (var h3 = this.description.ld(s5), r3 = t4.sa.Wa(h3); s5 < r3; s5++) {
              var e3 = this.Vg(h3, 0);
              i6.setInterval(h3, 0, e3);
            }
        }, s4.prototype.A = function(t5) {
          t5.L(this.ta, this.oa, this.qa, this.ma), t5.normalize();
        }, s4.prototype.So = function(t5) {
          t5.Pa(), t5.$b(this.ta, this.oa, this.Pd(0, 1, 0)), t5.$b(this.qa, this.ma, this.Pd(1, 1, 0));
        }, s4.prototype.Pc = function(i6) {
          if (i6 instanceof t4.Ed) {
            this.wc();
            var s5 = new t4.h();
            s5.x = this.ta, s5.y = this.oa, i6.Gh(s5, s5), this.ta = s5.x, this.oa = s5.y, s5.x = this.qa, s5.y = this.ma, i6.Gh(s5, s5), this.qa = s5.x, this.ma = s5.y;
          } else
            this.wc(), (s5 = new t4.Od()).x = this.ta, s5.y = this.oa, s5.z = this.Pd(0, 1, 0), s5 = i6.hp(s5), this.ta = s5.x, this.oa = s5.y, this.vn(0, 1, 0, s5.z), s5.x = this.qa, s5.y = this.ma, s5.z = this.Pd(1, 1, 0), s5 = i6.hp(s5), this.qa = s5.x, this.ma = s5.y, this.vn(1, 1, 0, s5.z);
        }, s4.prototype.Ja = function() {
          return new s4(this.description);
        }, s4.prototype.Sx = function(t5, i6) {
          return (this.qa - t5 - (this.ta - t5)) * (this.ma - i6 + (this.oa - i6)) * 0.5;
        }, s4.prototype.ux = function(t5) {
          return t5 * this.Rb();
        }, s4.prototype.IG = function(t5) {
          return t5 / this.Rb();
        }, s4.prototype.yF = function(i6) {
          return t4.mc.jq(this.ta, this.qa, i6);
        }, s4.prototype.aR = function(i6) {
          return t4.mc.jq(this.oa, this.ma, i6);
        }, s4.prototype.fl = function(i6, s5) {
          var n4 = new t4.jg();
          return this.dh(i6, s5, n4), n4.get();
        }, s4.prototype.dh = function(i6, s5, n4) {
          if (n4 == null)
            throw t4.i.O();
          n4.Qr(), (n4 = n4.get()).Pf(this.description);
          var h3 = new t4.h();
          this.ic(i6, h3), n4.UB(h3.x, h3.y), this.ic(s5, h3), n4.Sl(h3.x, h3.y), h3 = 1;
          for (var r3 = this.description.Ba; h3 < r3; h3++)
            for (var e3 = this.description.Fd(h3), o3 = t4.sa.Wa(e3), a3 = 0; a3 < o3; a3++) {
              var u3 = this.Vc(i6, e3, a3);
              n4.TB(e3, a3, u3), u3 = this.Vc(s5, e3, a3), n4.JB(e3, a3, u3);
            }
        }, s4.prototype.Vc = function(i6, s5, n4) {
          if (s5 == 0)
            return n4 == 0 ? this.ic(i6).x : this.ic(i6).y;
          switch (t4.sa.gz(s5)) {
            case 0:
              return 0.5 > i6 ? this.yv(s5, n4) : this.jv(s5, n4);
            case 1:
              var h3 = this.yv(s5, n4);
              return s5 = this.jv(s5, n4), t4.mc.jq(h3, s5, i6);
            case 2:
              throw t4.i.ga("not implemented");
          }
          throw t4.i.Ra();
        }, s4.prototype.ge = function(t5, i6) {
          var s5 = this.qa - this.ta, n4 = this.ma - this.oa, h3 = s5 * s5 + n4 * n4;
          return h3 == 0 ? 0.5 : (t5 = ((t5.x - this.ta) * s5 + (t5.y - this.oa) * n4) / h3, i6 || (0 > t5 ? t5 = 0 : 1 < t5 && (t5 = 1)), t5);
        }, s4.prototype.fq = function(t5, i6, s5, n4) {
          if (t5) {
            if ((t5 = this.ma - this.oa) == 0)
              return i6 == this.ma ? -1 : 0;
            if (0 > (i6 = (i6 - this.oa) / t5) || 1 < i6)
              return 0;
            s5 != null && (s5[0] = this.yF(i6));
          } else {
            if ((t5 = this.qa - this.ta) == 0)
              return i6 == this.qa ? -1 : 0;
            if (0 > (i6 = (i6 - this.ta) / t5) || 1 < i6)
              return 0;
            s5 != null && (s5[0] = this.aR(i6));
          }
          return n4 != null && (n4[0] = i6), 1;
        }, s4.prototype.Me = function(t5, i6) {
          var s5 = this.ma - this.oa;
          return s5 == 0 ? t5 == this.ma ? i6 : NaN : (t5 = (t5 - this.oa) / s5, i6 = this.yF(t5), t5 == 1 && (i6 = this.qa), i6);
        }, s4.prototype.tu = function(t5, i6, s5) {
          return 0 <= this.tp(t5.x, t5.y, i6, s5);
        }, s4.prototype.xi = function(t5, i6, s5) {
          return 0 <= this.tp(t5, i6, s5, true);
        }, s4.prototype.ss = function(t5, i6) {
          return this.tu(t5, i6, false);
        }, s4.prototype.mI = function() {
          if (this.ma < this.oa || this.ma == this.oa && this.qa < this.ta) {
            var t5 = this.ta;
            this.ta = this.qa, this.qa = t5, t5 = this.oa, this.oa = this.ma, this.ma = t5, t5 = 0;
            for (var i6 = this.description.Qq - 2; t5 < i6; t5++) {
              var s5 = this.la[t5];
              this.la[t5] = this.la[t5 + i6], this.la[t5 + i6] = s5;
            }
          }
        }, s4.prototype.wu = function(i6, s5) {
          (s5 = t4.h.construct(i6, s5)).sub(this.bc());
          var n4 = new t4.h();
          return n4.vc(this.xc(), this.bc()), (i6 = n4.yi(s5)) > (s5 = 8881784197001252e-31 * (Math.abs(n4.x * s5.y) + Math.abs(n4.y * s5.x))) ? -1 : i6 < -s5 ? 1 : 0;
        }, s4.prototype.tp = function(i6, s5, n4, h3) {
          var r3 = this.ta, e3 = this.oa, o3 = i6 - r3, a3 = s5 - e3;
          if ((o3 = Math.sqrt(o3 * o3 + a3 * a3)) <= Math.max(n4, 6661338147750939e-31 * o3))
            return h3 && o3 == 0 ? NaN : 0;
          if (o3 = i6 - this.qa, a3 = s5 - this.ma, (o3 = Math.sqrt(o3 * o3 + a3 * a3)) <= Math.max(n4, 6661338147750939e-31 * o3))
            return h3 && o3 == 0 ? NaN : 1;
          if (o3 = this.qa - this.ta, a3 = this.ma - this.oa, 0 < (h3 = Math.sqrt(o3 * o3 + a3 * a3))) {
            var u3 = 1 / h3, f3 = i6 - r3, c3 = s5 - e3, l3 = f3 * (o3 *= u3) + c3 * (a3 *= u3), p3 = 17763568394002505e-31 * (Math.abs(f3 * o3) + Math.abs(c3 * a3)), v3 = o3;
            if (o3 = -a3, a3 = v3, l3 < -(p3 = Math.max(n4, p3)) || l3 > h3 + p3)
              return NaN;
            if (Math.abs(f3 * o3 + c3 * a3) <= Math.max(n4, 17763568394002505e-31 * (Math.abs(f3 * o3) + Math.abs(c3 * a3))) && (0.5 >= (o3 = t4.P.Tk(l3 * u3, 0, 1)) ? (a3 = this.ta + (this.qa - this.ta) * o3, h3 = this.oa + (this.ma - this.oa) * o3) : (a3 = this.qa - (this.qa - this.ta) * (1 - o3), h3 = this.ma - (this.ma - this.oa) * (1 - o3)), t4.h.Jy(a3, h3, i6, s5) <= n4)) {
              if (0.5 > o3) {
                if (t4.h.Jy(a3, h3, r3, e3) <= n4)
                  return 0;
              } else if (t4.h.Jy(a3, h3, this.qa, this.ma) <= n4)
                return 1;
              return o3;
            }
          }
          return NaN;
        }, s4.prototype.Nb = function(t5) {
          return t5 != null && (t5 == this || t5.constructor === this.constructor && this.AM(t5));
        }, s4.prototype.mD = function(i6, s5, n4) {
          var h3 = n4 ? this.ta : this.qa;
          n4 = n4 ? this.oa : this.ma;
          var r3 = new t4.h();
          return r3.x = i6.qa - h3, r3.y = i6.ma - n4, !(s5.Sh(r3) > 6661338147750939e-31 * s5.aD(r3)) || (r3.x = i6.ta - h3, r3.y = i6.oa - n4, s5.Sh(r3) <= 6661338147750939e-31 * s5.aD(r3));
        }, s4.prototype.lD = function(i6) {
          var s5 = new t4.h();
          return s5.x = this.qa - this.ta, s5.y = this.ma - this.oa, !!this.mD(i6, s5, false) && (s5.Uq(), !!this.mD(i6, s5, true));
        }, s4.IM = function(t5, i6) {
          var s5 = t5.wu(i6.ta, i6.oa), n4 = t5.wu(i6.qa, i6.ma);
          return !(0 > s5 && 0 > n4 || 0 < s5 && 0 < n4) && (s5 = i6.wu(t5.ta, t5.oa), n4 = i6.wu(t5.qa, t5.ma), !(0 > s5 && 0 > n4 || 0 < s5 && 0 < n4) && ((s5 = t5.Rb()) > (n4 = i6.Rb()) ? t5.lD(i6) : i6.lD(t5)));
        }, s4.GM = function(i6, s5, n4) {
          var h3 = t4.h.construct(NaN, NaN), r3 = i6.qa - i6.ta, e3 = i6.ma - i6.oa, o3 = s5.qa - s5.ta, a3 = s5.ma - s5.oa, u3 = o3 * e3 - r3 * a3;
          if (u3 == 0)
            return h3;
          var f3 = 8881784197001252e-31 * (Math.abs(o3 * e3) + Math.abs(r3 * a3)), c3 = s5.ta - i6.ta, l3 = s5.oa - i6.oa, p3 = o3 * l3 - c3 * a3, v3 = p3 / u3, y3 = Math.abs(u3);
          return v3 < -(o3 = (8881784197001252e-31 * (Math.abs(o3 * l3) + Math.abs(c3 * a3)) * y3 + f3 * Math.abs(p3)) / (u3 * u3) + 2220446049250313e-31 * Math.abs(v3)) || v3 > 1 + o3 || (o3 = (a3 = r3 * l3 - c3 * e3) / u3) < -(r3 = (8881784197001252e-31 * (Math.abs(r3 * l3) + Math.abs(c3 * e3)) * y3 + f3 * Math.abs(a3)) / (u3 * u3) + 2220446049250313e-31 * Math.abs(o3)) || o3 > 1 + r3 ? h3 : (v3 = t4.P.Tk(v3, 0, 1), r3 = t4.P.Tk(o3, 0, 1), e3 = i6.ic(v3), u3 = s5.ic(r3), (f3 = new t4.h()).vc(e3, u3), f3.length() > n4 && (f3.add(e3, u3), f3.scale(0.5), v3 = i6.ge(f3, false), r3 = s5.ge(f3, false), i6 = i6.ic(v3), s5 = s5.ic(r3), i6.sub(s5), i6.length() > n4) || h3.na(v3, r3), h3);
        }, s4.JM = function(t5, i6, n4, h3) {
          var r3 = 0;
          if ((t5.ta == i6.ta && t5.oa == i6.oa || t5.ta == i6.qa && t5.oa == i6.ma) && (r3++, !h3))
            return 1;
          if (t5.qa == i6.ta && t5.ma == i6.oa || t5.qa == i6.qa && t5.ma == i6.ma) {
            if (++r3 == 2)
              return 2;
            if (!h3)
              return 1;
          }
          return i6.xi(t5.ta, t5.oa, n4) || i6.xi(t5.qa, t5.ma, n4) || t5.xi(i6.ta, i6.oa, n4) || t5.xi(i6.qa, i6.ma, n4) ? 1 : h3 && r3 != 0 || s4.IM(t5, i6) == 0 ? 0 : 1;
        }, s4.Yx = function(i6, n4, h3, r3, e3, o3) {
          var a3 = 0, u3 = i6.tp(n4.ta, n4.oa, o3, false), f3 = i6.tp(n4.qa, n4.ma, o3, false), c3 = n4.tp(i6.ta, i6.oa, o3, false), l3 = n4.tp(i6.qa, i6.ma, o3, false);
          return isNaN(u3) || (r3 != null && (r3[a3] = u3), e3 != null && (e3[a3] = 0), h3 != null && (h3[a3] = t4.h.construct(n4.ta, n4.oa)), a3++), isNaN(f3) || (r3 != null && (r3[a3] = f3), e3 != null && (e3[a3] = 1), h3 != null && (h3[a3] = t4.h.construct(n4.qa, n4.ma)), a3++), a3 == 2 || isNaN(c3) || u3 == 0 && c3 == 0 || f3 == 0 && c3 == 1 || (r3 != null && (r3[a3] = 0), e3 != null && (e3[a3] = c3), h3 != null && (h3[a3] = t4.h.construct(i6.ta, i6.oa)), a3++), a3 == 2 || isNaN(l3) || u3 == 1 && l3 == 0 || f3 == 1 && l3 == 1 || (r3 != null && (r3[a3] = 1), e3 != null && (e3[a3] = l3), h3 != null && (h3[a3] = t4.h.construct(n4.qa, n4.ma)), a3++), 0 < a3 ? (a3 == 2 && r3 != null && r3[0] > r3[1] && (i6 = r3[0], r3[0] = r3[1], r3[1] = i6, e3 != null && (r3 = e3[0], e3[0] = e3[1], e3[1] = r3), h3 != null && (e3 = t4.h.construct(h3[0].x, h3[0].y), h3[0] = h3[1], h3[1] = e3)), a3) : (a3 = s4.GM(i6, n4, o3), isNaN(a3.x) ? 0 : (h3 != null && (h3[0] = i6.ic(a3.x)), r3 != null && (r3[0] = a3.x), e3 != null && (e3[0] = a3.y), 1));
        }, s4.prototype.$F = function() {
          return 0;
        }, s4.prototype.qp = function() {
        }, s4.prototype.toString = function() {
          return "Line: [" + this.ta.toString() + ", " + this.oa.toString() + ", " + this.qa.toString() + ", " + this.ma.toString() + "]";
        }, s4;
      }(t4.NC);
      t4.zb = i4;
    }(Q2 || (Q2 = {})), function(t4) {
      var i4 = function() {
        function t5() {
          this.Lm = [], this.za = -1;
        }
        return t5.prototype.Ma = function() {
          return this.za;
        }, t5.prototype.next = function() {
          if (this.Lm != null && this.Lm.length != 0) {
            this.za++;
            var t6 = this.Lm[0];
            return this.Lm = 1 >= this.Lm.length ? [] : this.Lm.slice(1), t6;
          }
          return this.Lm = null;
        }, t5.prototype.VX = function(t6) {
          this.Lm.push(t6);
        }, t5.prototype.re = function() {
        }, t5;
      }();
      t4.bL = i4;
    }(Q2 || (Q2 = {})), function(t4) {
      var i4;
      (i4 = t4.NL || (t4.NL = {}))[i4.enumFillRuleOddEven = 0] = "enumFillRuleOddEven", i4[i4.enumFillRuleWinding = 1] = "enumFillRuleWinding";
      var s4 = function(i5) {
        function s5(s6, n4) {
          var h3 = i5.call(this) || this;
          if (h3.yf = false, h3.Gq = null, h3.uq = 0, h3.tq = 0, h3.Cj = null, h3.Og = false, h3.nb = null, h3.mb = null, h3.Se = null, h3.Nj = null, h3.Td = null, h3.vq = 0, h3.gb = 0, h3.zq = 0, n4 === void 0)
            h3.yf = s6, h3.Og = false, h3.vq = 0, h3.uq = 0, h3.tq = 0, h3.xa = 0, h3.description = t4.fe.pg();
          else {
            if (n4 == null)
              throw t4.i.O();
            h3.yf = s6, h3.Og = false, h3.vq = 0, h3.uq = 0, h3.tq = 0, h3.xa = 0, h3.description = n4;
          }
          return h3.Cj = null, h3.gb = 0, h3;
        }
        return _2(s5, i5), s5.prototype.vm = function() {
          return 0 < this.vq;
        }, s5.prototype.Xx = function() {
          this.wc(), this.Gq == null ? this.Gq = new t4.Ta(this.description) : this.Gq.Pf(this.description);
        }, s5.prototype.rx = function(i6, s6) {
          var n4 = new t4.h();
          n4.x = i6, n4.y = s6, this.Nt(n4);
        }, s5.prototype.Nt = function(t5) {
          this.Xx(), this.Gq.Db(t5), this.Og = true;
        }, s5.prototype.nf = function(i6) {
          if (i6.B())
            throw t4.i.O();
          this.Ll(i6.description), this.Xx(), i6.copyTo(this.Gq), this.Og = true;
        }, s5.prototype.Rx = function() {
          var i6 = 1;
          this.Og && (this.Xx(), this.nb == null ? (this.nb = t4.Zc.Qh(2), this.nb.write(0, 0), this.mb = t4.Zc.Or(2, 0)) : (this.nb.resize(this.nb.size + 1, 0), this.mb.resize(this.mb.size + 1, 0)), this.yf && this.mb.write(this.mb.size - 2, 1), i6++);
          var s6 = this.xa;
          this.nb.write(this.nb.size - 1, this.xa + i6), this.fm(s6 + i6), this.mb.write(this.nb.size - 1, 0), this.Og && (this.It(s6, this.Gq), this.Og = false);
        }, s5.prototype.Aj = function(t5, i6) {
          this.Rx(), this.Db(this.xa - 1, t5, i6);
        }, s5.prototype.Ei = function(t5) {
          this.Rx(), this.Db(this.xa - 1, t5);
        }, s5.prototype.lineTo = function(t5) {
          this.Rx(), this.It(this.xa - 1, t5);
        }, s5.prototype.xU = function(i6) {
          if (this.wc(), this.yf)
            throw t4.i.Ra();
          var s6 = this.ea();
          if (i6 > s6)
            throw t4.i.Ra();
          if (this.ec(i6)) {
            if (this.mb == null)
              throw t4.i.Ra();
            var n4 = this.xa, h3 = this.Ca(i6), r3 = this.Wc(i6);
            this.fm(this.xa + 1), this.oc();
            for (var e3 = 0, o3 = this.description.Ba; e3 < o3; e3++)
              if (this.Aa[e3] != null) {
                var a3 = t4.sa.Wa(this.description.Fd(e3));
                this.Aa[e3].On(a3 * r3, this.Aa[e3], a3 * h3, a3, true, 1, a3 * n4);
              }
            for (; s6 > i6; s6--)
              n4 = this.nb.read(s6), this.nb.write(s6, n4 + 1);
            this.mb.FE(i6, 1);
          }
        }, s5.prototype.Cp = function() {
          if (this.vx(), t5 === void 0) {
            this.Og = false;
            var t5 = this.ea() - 1;
          }
          var i6 = this.mb.read(t5);
          this.mb.write(t5, 1 | i6), this.Se != null && (t5 = this.Wc(t5) - 1, this.Se.write(t5, 1), this.Nj.write(t5, -1));
        }, s5.prototype.ec = function(t5) {
          return (1 & this.mb.read(t5)) != 0;
        }, s5.prototype.Pn = function(t5) {
          if (this.ec(t5))
            return true;
          var i6 = this.Ca(t5);
          return !(i6 > (t5 = this.Wc(t5) - 1)) && (i6 = this.Oa(i6), t5 = this.Oa(t5), i6.rb(t5));
        }, s5.prototype.Av = function(t5) {
          return (2 & this.mb.read(t5)) != 0;
        }, s5.prototype.pc = function(i6, s6) {
          if (this.Ll(i6.description), i6.K() != 322)
            throw t4.i.Ra();
          var n4 = new t4.Ta();
          (s6 || this.B()) && (i6.Vo(n4), this.nf(n4)), i6.Ro(n4), this.lineTo(n4);
        }, s5.prototype.vp = function(t5) {
          var i6 = this.xa == 0;
          this.rx(t5.v, t5.G), this.Aj(t5.v, t5.H), this.Aj(t5.C, t5.H), this.Aj(t5.C, t5.G), this.Cp(), this.Og = false, i6 && this.Nf(256, false);
        }, s5.prototype.bd = function(i6, s6) {
          if (!i6.B()) {
            for (var n4 = this.xa == 0, h3 = new t4.Ta(this.description), r3 = 0; 4 > r3; r3++)
              i6.If(s6 ? 4 - r3 - 1 : r3, h3), r3 == 0 ? this.nf(h3) : this.lineTo(h3);
            this.Cp(), this.Og = false, n4 && !s6 && this.Nf(256, false);
          }
        }, s5.prototype.add = function(t5, i6) {
          for (var s6 = 0; s6 < t5.ea(); s6++)
            this.addPath(t5, s6, !i6);
        }, s5.prototype.addPath = function(t5, i6, s6) {
          this.wf(-1, t5, i6, s6);
        }, s5.prototype.$k = function(t5, i6) {
          this.Cz(t5, i6);
        }, s5.prototype.Fr = function(i6, s6, n4, h3, r3) {
          if (r3 || this.ea() != 0 || (r3 = true), 0 > s6 && (s6 = i6.ea() - 1), s6 >= i6.ea() || 0 > n4 || 0 > h3 || h3 > i6.tv(s6))
            throw t4.i.ga("index out of bounds");
          if (h3 != 0) {
            var e3 = i6.ec(s6) && n4 + h3 == i6.tv(s6);
            if (!e3 || h3 != 1) {
              if (this.Og = false, this.Ll(i6.description), n4 = i6.Ca(s6) + n4 + 1, r3 && (h3++, n4--), e3 && h3--, e3 = this.xa, this.fm(this.xa + h3), this.oc(), r3) {
                if (h3 == 0)
                  return;
                this.nb.add(this.xa), r3 = i6.mb.read(s6), r3 &= -5, this.yf && (r3 |= 1), this.mb.write(this.mb.size - 1, r3), this.mb.add(0);
              } else
                this.nb.write(this.mb.size - 1, this.xa);
              r3 = 0;
              for (var o3 = this.description.Ba; r3 < o3; r3++) {
                var a3 = this.description.ld(r3), u3 = t4.sa.Wa(a3), f3 = i6.description.Rf(a3);
                0 > f3 || i6.Aa[f3] == null ? this.Aa[r3].Nn(u3 * e3, t4.sa.te(a3), h3 * u3, u3 * e3) : this.Aa[r3].On(u3 * e3, i6.Aa[f3], u3 * n4, h3 * u3, true, u3, u3 * e3);
              }
              if (this.vm())
                throw t4.i.Ra();
              if (i6.Av(s6))
                throw t4.i.Ra();
              this.Qc(1993);
            }
          }
        }, s5.prototype.jJ = function() {
          for (var t5 = 0, i6 = this.ea(); t5 < i6; t5++)
            this.zW(t5);
        }, s5.prototype.zW = function(i6) {
          if (this.oc(), i6 >= this.ea())
            throw t4.i.O();
          var s6 = this.Ca(i6), n4 = this.Ka(i6);
          i6 = this.ec(i6) ? 1 : 0;
          for (var h3 = 0, r3 = this.description.Ba; h3 < r3; h3++)
            if (this.Aa[h3] != null) {
              var e3 = t4.sa.Wa(this.description.Fd(h3));
              this.Aa[h3].pi(e3 * (s6 + i6), e3 * (n4 - i6), e3);
            }
          this.Qc(1993);
        }, s5.prototype.ar = function(i6) {
          this.oc();
          var s6 = this.ea();
          if (0 > i6 && (i6 = s6 - 1), i6 >= s6)
            throw t4.i.O();
          for (var n4 = this.Ca(i6), h3 = this.Ka(i6), r3 = 0, e3 = this.description.Ba; r3 < e3; r3++)
            if (this.Aa[r3] != null) {
              var o3 = t4.sa.Wa(this.description.Fd(r3));
              this.Aa[r3].Gn(o3 * n4, o3 * h3, o3 * this.xa);
            }
          for (n4 = i6 + 1; n4 <= s6; n4++)
            r3 = this.nb.read(n4), this.nb.write(n4 - 1, r3 - h3);
          if (this.mb == null)
            for (n4 = i6 + 1; n4 <= s6; n4++)
              i6 = this.mb.read(n4), this.mb.write(n4 - 1, i6);
          this.nb.resize(s6), this.mb.resize(s6), this.xa -= h3, this.Rg -= h3, this.Qc(1993);
        }, s5.prototype.wf = function(i6, s6, n4, h3) {
          if (s6 == this)
            throw t4.i.O();
          if (n4 >= s6.ea())
            throw t4.i.O();
          var r3 = this.ea();
          if (i6 > r3)
            throw t4.i.O();
          0 > i6 && (i6 = r3), 0 > n4 && (n4 = s6.ea() - 1), this.Og = false, this.Ll(s6.description), s6.oc();
          var e3 = s6.Ca(n4), o3 = s6.Ka(n4), a3 = this.xa, u3 = s6.ec(n4) && !h3 ? 1 : 0;
          this.fm(this.xa + o3), this.oc();
          for (var f3 = i6 < r3 ? this.Ca(i6) : a3, c3 = 0, l3 = this.description.Ba; c3 < l3; c3++) {
            var p3 = this.description.Fd(c3), v3 = s6.description.Rf(p3), y3 = t4.sa.Wa(p3);
            0 <= v3 && s6.Aa[v3] != null ? (u3 != 0 && this.Aa[c3].On(f3 * y3, s6.Aa[v3], y3 * e3, y3, true, y3, y3 * a3), this.Aa[c3].On((f3 + u3) * y3, s6.Aa[v3], y3 * (e3 + u3), y3 * (o3 - u3), h3, y3, y3 * (a3 + u3))) : this.Aa[c3].Nn(f3 * y3, t4.sa.te(p3), y3 * o3, y3 * a3);
          }
          for (this.nb.add(a3 + o3), h3 = r3; h3 >= i6 + 1; h3--)
            e3 = this.nb.read(h3 - 1), this.nb.write(h3, e3 + o3);
          for (s6.Av(n4), this.mb.add(0), h3 = r3 - 1; h3 >= i6 + 1; h3--)
            r3 = this.mb.read(h3), r3 &= -5, this.mb.write(h3 + 1, r3);
          r3 = s6.ER().read(n4), r3 &= -5, this.yf && (r3 |= 1), this.mb.write(i6, r3);
        }, s5.prototype.Cz = function(i6, s6) {
          var n4 = -1, h3 = this.ea();
          if (n4 > h3)
            throw t4.i.O();
          0 > n4 && (n4 = h3), this.Og = false;
          var r3 = this.xa;
          this.fm(this.xa + s6), this.oc();
          var e3 = n4 < h3 ? this.Ca(n4) : r3;
          if (i6 != null)
            this.Aa[0].Dz(2 * e3, i6, 0, s6, true, 2 * r3);
          else {
            var o3 = t4.sa.te(0);
            this.Aa[0].Nn(2 * e3, o3, 2 * s6, 2 * r3);
          }
          i6 = 1;
          for (var a3 = this.description.Ba; i6 < a3; i6++) {
            o3 = this.description.ld(i6);
            var u3 = t4.sa.Wa(o3);
            o3 = t4.sa.te(o3), this.Aa[i6].Nn(e3 * u3, o3, u3 * s6, u3 * r3);
          }
          for (this.nb.add(this.xa), r3 = h3; r3 >= n4 + 1; r3--)
            e3 = this.nb.read(r3 - 1), this.nb.write(r3, e3 + s6);
          for (this.mb.add(0), r3 = h3 - 1; r3 >= n4 + 1; r3--)
            s6 = this.mb.read(r3), s6 &= -5, this.mb.write(r3 + 1, s6);
          this.yf && this.mb.write(n4, 1);
        }, s5.prototype.lG = function(i6, s6, n4) {
          var h3 = -1;
          if (0 > i6 && (i6 = this.ea()), i6 > this.ea() || h3 > this.Ka(i6) || n4 > s6.length)
            throw t4.i.ga("index out of bounds");
          if (n4 != 0) {
            i6 == this.ea() && (this.nb.add(this.xa), this.yf ? this.mb.add(1) : this.mb.add(0)), 0 > h3 && (h3 = this.Ka(i6)), this.oc();
            var r3 = this.xa;
            this.fm(this.xa + n4), this.oc();
            for (var e3 = 0, o3 = this.description.Ba; e3 < o3; e3++) {
              var a3 = this.description.Fd(e3), u3 = t4.sa.Wa(a3);
              this.Aa[e3].Wt(u3 * (this.Ca(i6) + h3 + n4), (r3 - this.Ca(i6) - h3) * u3, this.Aa[e3], u3 * (this.Ca(i6) + h3), true, u3), e3 == 0 ? this.Aa[e3].qC(u3 * (this.Ca(i6) + h3), n4, s6, 0, true) : this.Aa[e3].Yj(t4.sa.te(a3), (this.Ca(i6) + h3) * u3, n4 * u3);
            }
            for (this.vm() && (this.Se.Wt(this.Ca(i6) + h3 + n4, r3 - this.Ca(i6) - h3, this.Se, this.Ca(i6) + h3, true, 1), this.Nj.Wt(this.Ca(i6) + h3 + n4, r3 - this.Ca(i6) - h3, this.Nj, this.Ca(i6) + h3, true, 1), this.Se.Yj(1, this.Ca(i6) + h3, n4), this.Nj.Yj(-1, this.Ca(i6) + h3, n4)), i6 += 1, s6 = this.ea(); i6 <= s6; i6++)
              this.nb.write(i6, this.nb.read(i6) + n4);
          }
        }, s5.prototype.xf = function(i6, s6, n4) {
          var h3 = this.ea();
          if (0 > i6 && (i6 = this.ea()), i6 >= h3 || s6 > this.Ka(i6))
            throw t4.i.ga("index out of bounds");
          i6 == this.ea() && (this.nb.add(this.xa), this.yf ? this.mb.add(1) : this.mb.add(0)), 0 > s6 && (s6 = this.Ka(i6));
          var r3 = this.xa;
          this.fm(this.xa + 1), this.oc();
          var e3 = this.Ca(i6);
          this.Aa[0].xj(2 * (e3 + s6), n4, 2 * r3), n4 = 1;
          for (var o3 = this.description.Ba; n4 < o3; n4++) {
            var a3 = this.description.Fd(n4), u3 = t4.sa.Wa(a3);
            this.Aa[n4].Nn(u3 * (e3 + s6), t4.sa.te(a3), u3, u3 * r3);
          }
          for (i6 += 1; i6 <= h3; i6++)
            this.nb.write(i6, this.nb.read(i6) + 1);
        }, s5.prototype.yB = function(i6, s6) {
          var n4 = this.ea();
          if (0 > i6 && (i6 = n4 - 1), i6 >= n4 || s6 >= this.Ka(i6))
            throw t4.i.ga("index out of bounds");
          this.oc();
          var h3 = this.Ca(i6);
          0 > s6 && (s6 = this.Ka(i6) - 1), s6 = h3 + s6, h3 = 0;
          for (var r3 = this.description.Ba; h3 < r3; h3++)
            if (this.Aa[h3] != null) {
              var e3 = t4.sa.Wa(this.description.Fd(h3));
              this.Aa[h3].Gn(e3 * s6, e3, e3 * this.xa);
            }
          for (; n4 >= i6 + 1; n4--)
            s6 = this.nb.read(n4), this.nb.write(n4, s6 - 1);
          this.xa--, this.Rg--, this.Qc(1993);
        }, s5.prototype.pE = function(i6, s6, n4, h3) {
          if (i6 = this.Ca(i6) + s6, (n4 = this.Ca(n4) + h3) < i6 || 0 > i6 || n4 > this.I() - 1)
            throw t4.i.O();
          s6 = 0, (h3 = this.Ha()).Wb(i6);
          do {
            for (; h3.Ia() && (i6 = h3.ia(), h3.xb() != n4); )
              s6 += i6 = i6.Rb();
            if (h3.xb() == n4)
              break;
          } while (h3.ab());
          return s6;
        }, s5.prototype.aO = function(i6, s6, n4) {
          if (s6 = this.Ca(i6) + s6, n4 = this.Ca(i6) + n4, 0 > s6 || n4 > this.I() - 1)
            throw t4.i.O();
          var h3 = this.Ha();
          if (s6 > n4) {
            if (!this.ec(i6))
              throw t4.i.O("cannot iterate across an open path");
            h3.EB();
          }
          var r3 = i6 = 0;
          h3.Wb(s6);
          do {
            r3 += i6, i6 = h3.ia().Rb();
          } while (h3.xb() != n4);
          return r3;
        }, s5.prototype.ng = function() {
          return t4.si.im(this, null);
        }, s5.prototype.FS = function(i6, s6, n4) {
          for (var h3 = i6; h3 < n4 - 1; h3++)
            if (this.ec(h3))
              throw t4.i.O("cannot interpolate across closed paths");
          if ((h3 = this.description.Ba) != 1) {
            var r3 = this.pE(i6, s6, n4, void 0);
            if (r3 != 0)
              for (var e3 = 1; e3 < h3; e3++) {
                var o3 = this.description.ld(e3);
                if (t4.sa.gz(o3) != 2)
                  for (var a3 = t4.sa.Wa(o3), u3 = 0; u3 < a3; u3++)
                    this.HS(o3, i6, s6, n4, r3, u3);
              }
          }
        }, s5.prototype.ES = function(i6, s6, n4) {
          var h3 = this.description.Ba;
          if (h3 != 1) {
            var r3 = this.aO(i6, s6, n4);
            if (r3 != 0)
              for (var e3 = 1; e3 < h3; e3++) {
                var o3 = this.description.ld(e3);
                if (t4.sa.gz(o3) != 2)
                  for (var a3 = t4.sa.Wa(o3), u3 = 0; u3 < a3; u3++)
                    this.GS(o3, i6, s6, n4, r3, u3);
              }
          }
        }, s5.prototype.HS = function(i6, s6, n4, h3, r3, e3) {
          var o3 = this.Ha(), a3 = this.Ca(s6) + n4;
          h3 = this.Ca(h3) + void 0, s6 = this.Vc(i6, a3, e3), n4 = this.Vc(i6, h3, e3);
          var u3 = s6, f3 = 0;
          o3.Wb(a3);
          do {
            if (o3.Ia()) {
              if (o3.ia(), o3.xb() == h3)
                break;
              this.setAttribute(i6, o3.xb(), e3, u3), o3.ni();
              do {
                if (a3 = o3.ia(), o3.kk() == h3)
                  return;
                f3 += a3 = a3.Rb(), u3 = t4.mc.jq(s6, n4, f3 / r3), o3.Qn() || this.setAttribute(i6, o3.kk(), e3, u3);
              } while (o3.Ia());
            }
          } while (o3.ab());
        }, s5.prototype.GS = function(i6, s6, n4, h3, r3, e3) {
          var o3 = this.Ha(), a3 = this.Ca(s6) + n4;
          if ((s6 = this.Ca(s6) + h3) != a3) {
            h3 = this.Vc(i6, a3, e3), n4 = this.Vc(i6, s6, e3);
            var u3 = 0;
            o3.Wb(a3), o3.EB(), a3 = h3;
            do {
              var f3 = o3.ia();
              this.setAttribute(i6, o3.xb(), e3, a3), u3 += a3 = f3.Rb(), a3 = t4.mc.jq(h3, n4, u3 / r3);
            } while (o3.kk() != s6);
          }
        }, s5.prototype.Pa = function() {
          this.vq = 0, this.Og = false, this.Td = this.Se = this.Nj = this.mb = this.nb = null, this.rD();
        }, s5.prototype.Pc = function(i6) {
          i6 instanceof t4.Ed ? this.TD(i6, -1) : this.rN(i6);
        }, s5.prototype.TD = function(i6, s6) {
          if (!this.B() && !i6.isIdentity()) {
            this.oc();
            var n4 = this.Aa[0], h3 = new t4.h(), r3 = new t4.h();
            if (0 > s6) {
              var e3 = this.vm(), o3 = 0;
              s6 = this.xa;
            } else
              e3 = this.Av(s6), o3 = this.Ca(s6), s6 = this.Wc(s6);
            for (; o3 < s6; o3++) {
              if (h3.x = n4.read(2 * o3), h3.y = n4.read(2 * o3 + 1), e3) {
                var a3 = this.Nj.read(o3);
                if (0 <= a3)
                  switch (7 & this.Se.read(o3)) {
                    case 2:
                      r3.x = this.Td.read(a3), r3.y = this.Td.read(a3 + 1), i6.Gh(r3, r3), this.Td.write(a3, r3.x), this.Td.write(a3 + 1, r3.y), r3.x = this.Td.read(a3 + 3), r3.y = this.Td.read(a3 + 4), i6.Gh(r3, r3), this.Td.write(a3 + 3, r3.x), this.Td.write(a3 + 4, r3.y);
                      break;
                    case 4:
                      throw t4.i.Ra();
                  }
              }
              i6.Gh(h3, h3), n4.write(2 * o3, h3.x), n4.write(2 * o3 + 1, h3.y);
            }
            this.Qc(1993);
          }
        }, s5.prototype.rN = function(i6) {
          if (!this.B()) {
            this.se(1), this.oc();
            for (var s6 = this.Aa[0], n4 = this.Aa[1], h3 = new t4.Od(), r3 = new t4.Od(), e3 = this.vm(), o3 = 0; o3 < this.xa; o3++) {
              if (h3.x = s6.read(2 * o3), h3.y = s6.read(2 * o3 + 1), h3.z = n4.read(o3), e3) {
                var a3 = this.Nj.read(o3);
                if (0 <= a3)
                  switch (7 & this.Se.read(o3)) {
                    case 2:
                      r3.x = this.Td.read(a3), r3.y = this.Td.read(a3 + 1), r3.z = this.Td.read(a3 + 2), r3 = i6.hp(r3), this.Td.write(a3, r3.x), this.Td.write(a3 + 1, r3.y), this.Td.write(a3 + 1, r3.z), r3.x = this.Td.read(a3 + 3), r3.y = this.Td.read(a3 + 4), r3.z = this.Td.read(a3 + 5), r3 = i6.hp(r3), this.Td.write(a3 + 3, r3.x), this.Td.write(a3 + 4, r3.y), this.Td.write(a3 + 5, r3.z);
                      break;
                    case 4:
                      throw t4.i.Ra();
                  }
              }
              h3 = i6.hp(h3), s6.write(2 * o3, h3.x), s6.write(2 * o3 + 1, h3.y), n4.write(o3, h3.z);
            }
            this.Qc(1993);
          }
        }, s5.prototype.ey = function() {
          this.nb == null && (this.nb = t4.Zc.Qh(1, 0), this.mb = t4.Zc.Or(1, 0)), this.Se != null && (this.Se.resize(this.Rg, 1), this.Nj.resize(this.Rg, -1));
        }, s5.prototype.qp = function(i6) {
          i6.Og = false, i6.vq = this.vq, i6.zq = this.zq, i6.nb = this.nb != null ? t4.ja.Dn(this.nb) : null, i6.mb = this.mb != null ? t4.rn.Dn(this.mb) : null, i6.Nj = this.Nj != null ? t4.ja.Dn(this.Nj) : null, i6.Se = this.Se != null ? t4.rn.Dn(this.Se) : null, i6.Td = this.Td != null ? t4.ce.Dn(this.Td) : null, i6.uq = this.uq, i6.tq = this.tq, i6.Cj = this.ck(1024) ? null : this.Cj;
        }, s5.prototype.Rb = function() {
          if (!this.ck(512))
            return this.uq;
          for (var i6 = this.Ha(), s6 = new t4.Ex(0); i6.ab(); )
            for (; i6.Ia(); )
              s6.add(i6.ia().Rb());
          return this.uq = s6.tm(), this.Nf(512, false), s6.tm();
        }, s5.prototype.Nb = function(t5) {
          if (t5 == this)
            return true;
          if (!(t5 instanceof s5 && i5.prototype.Nb.call(this, t5)))
            return false;
          var n4 = this.ea();
          return !(n4 != t5.ea() || this.nb != null && !this.nb.Nb(t5.nb, 0, n4 + 1) || this.zq != t5.zq || this.mb != null && !this.mb.Nb(t5.mb, 0, n4)) && i5.prototype.Nb.call(this, t5);
        }, s5.prototype.Ha = function() {
          return new t4.TL(this);
        }, s5.prototype.dy = function(t5) {
          if (i5.prototype.dy.call(this, t5), this.vm())
            for (t5 = this.Ha(); t5.ab(); ) {
              t5.Ia();
            }
        }, s5.prototype.Ap = function(t5, s6) {
          if (i5.prototype.Ap.call(this, t5, s6), this.vm())
            for (t5 = this.Ha(); t5.ab(); ) {
              t5.Ia();
            }
        }, s5.prototype.Zx = function() {
          this.xa = this.nb == null || this.nb.size == 0 ? 0 : this.nb.read(this.nb.size - 1);
        }, s5.prototype.He = function() {
          return this.yf ? (this.zu(), this.tq) : 0;
        }, s5.prototype.Gv = function(t5) {
          return !!this.yf && (this.ck(8) ? (this.zu(), 0 < this.Cj.read(t5)) : (4 & this.mb.read(t5)) != 0);
        }, s5.prototype.Kr = function(t5) {
          return this.yf ? (this.zu(), this.Cj.read(t5)) : 0;
        }, s5.prototype.zu = function() {
          if (this.ck(1024)) {
            var i6 = this.ea();
            this.Cj == null ? this.Cj = new t4.ce(i6) : this.Cj.size != i6 && this.Cj.resize(i6), i6 = new t4.Ex(0);
            for (var s6 = new t4.Ex(0), n4 = new t4.h(), h3 = 0, r3 = this.Ha(); r3.ab(); ) {
              for (s6.reset(), this.D(this.Ca(r3.gb), n4); r3.Ia(); )
                s6.add(r3.ia().Sx(n4.x, n4.y));
              i6.add(s6.tm());
              var e3 = h3++;
              this.Cj.write(e3, s6.tm());
            }
            this.tq = i6.tm(), this.Nf(1024, false);
          }
        }, s5.prototype.AR = function() {
          if (this.yf) {
            this.hm();
            for (var t5 = this.ea(), i6 = 0; i6 < t5; i6++)
              (4 & this.mb.read(i6)) != 0 && 0;
          }
        }, s5.prototype.hm = function() {
          if (this.ck(8)) {
            this.zu();
            var i6 = this.ea();
            (this.mb == null || this.mb.size < i6) && (this.mb = t4.Zc.Or(i6 + 1));
            for (var s6 = 1, n4 = 0; n4 < i6; n4++) {
              var h3 = this.Cj.read(n4);
              n4 == 0 && (s6 = 0 < h3 ? 1 : -1), 0 < h3 * s6 ? this.mb.uJ(n4, 4) : this.mb.FE(n4, 4);
            }
            this.Nf(8, false);
          }
        }, s5.prototype.nz = function(i6) {
          var s6 = this.gb, n4 = this.ea();
          if (0 <= s6 && s6 < n4) {
            if (i6 < this.Wc(s6)) {
              if (i6 >= this.Ca(s6))
                return s6;
              s6--;
            } else
              s6++;
            if (0 <= s6 && s6 < n4 && i6 >= this.Ca(s6) && i6 < this.Wc(s6))
              return this.gb = s6;
          }
          if (5 > n4) {
            for (s6 = 0; s6 < n4; s6++)
              if (i6 < this.Wc(s6))
                return this.gb = s6;
            throw t4.i.ga("corrupted geometry");
          }
          for (s6 = 0, --n4; n4 > s6; ) {
            var h3 = s6 + (n4 - s6 >> 1);
            if (i6 < this.Ca(h3))
              n4 = h3 - 1;
            else {
              if (!(i6 >= (s6 = this.Wc(h3))))
                return this.gb = h3;
              s6 = h3 + 1;
            }
          }
          return this.gb = s6;
        }, s5.prototype.sz = function() {
          var t5 = this.I();
          if (!this.yf) {
            t5 -= this.ea();
            for (var i6 = 0, s6 = this.ea(); i6 < s6; i6++)
              this.ec(i6) && t5++;
          }
          return t5;
        }, s5.prototype.tv = function(t5) {
          var i6 = this.Ka(t5);
          return this.ec(t5) || i6--, i6;
        }, s5.prototype.Ja = function() {
          return new s5(this.yf, this.description);
        }, s5.prototype.Eb = function() {
          return this.yf ? 2 : 1;
        }, s5.prototype.K = function() {
          return this.yf ? 1736 : 1607;
        }, s5.prototype.LJ = function(t5) {
          this.nb = t5, this.Qc(16777215);
        }, s5.prototype.QR = function() {
          return this.vx(), this.Se;
        }, s5.prototype.ER = function() {
          return this.vx(), this.mb;
        }, s5.prototype.KJ = function(t5) {
          this.mb = t5, this.Qc(16777215);
        }, s5.prototype.ea = function() {
          return this.nb != null ? this.nb.size - 1 : 0;
        }, s5.prototype.Wc = function(t5) {
          return this.nb.read(t5 + 1);
        }, s5.prototype.Ka = function(t5) {
          return this.nb.read(t5 + 1) - this.nb.read(t5);
        }, s5.prototype.Ca = function(t5) {
          return this.nb.read(t5);
        }, s5.prototype.nu = function(i6, s6) {
          this.Cb == null && (this.Cb = new t4.Wk()), s6 = t4.Mx.kW(s6);
          var n4 = this.Cb.Hk;
          if (n4 != null) {
            if (!(n4.Kk < i6 || s6 > n4.MR()))
              return true;
            this.Cb.tD(null);
          }
          return n4 = t4.Mx.create(this, i6, s6), this.Cb.tD(n4), true;
        }, s5.prototype.dc = function() {
          var t5 = i5.prototype.dc.call(this);
          if (!this.Bc()) {
            var s6 = this.ea();
            this.nb != null && this.nb.Cn(t5, 0, s6 + 1), this.mb != null && this.mb.Cn(t5, 0, s6);
          }
          return t5;
        }, s5.prototype.UF = function(t5) {
          return this.Se != null ? this.Se.read(t5) : 1;
        }, s5.prototype.cc = function(i6, s6, n4) {
          var h3 = this.nz(i6);
          if (i6 == this.Wc(h3) - 1 && !this.ec(h3))
            throw t4.i.ga("index out of bounds");
          this.oc();
          var r3 = this.Se, e3 = 1;
          if (r3 != null && (e3 = 7 & r3.read(i6)), e3 !== 1)
            throw t4.i.Ra();
          if (s6.Qr(), s6 = s6.get(), n4 ? s6.Pf(t4.fe.pg()) : s6.Pf(this.description), h3 = i6 == this.Wc(h3) - 1 && this.ec(h3) ? this.Ca(h3) : i6 + 1, r3 = new t4.h(), this.D(i6, r3), s6.Ec(r3), this.D(h3, r3), s6.Rc(r3), !n4)
            for (n4 = 1, r3 = this.description.Ba; n4 < r3; n4++) {
              e3 = this.description.Fd(n4);
              for (var o3 = t4.sa.Wa(e3), a3 = 0; a3 < o3; a3++) {
                var u3 = this.Vc(e3, i6, a3);
                s6.TB(e3, a3, u3), u3 = this.Vc(e3, h3, a3), s6.JB(e3, a3, u3);
              }
            }
        }, s5.prototype.Tj = function(i6, s6) {
          if (i6 >= this.ea())
            throw t4.i.O();
          if (this.B())
            s6.Pa();
          else {
            if (this.Av(i6))
              throw t4.i.ga("not implemented");
            var n4 = this.vb(0), h3 = new t4.h(), r3 = new t4.l();
            r3.Pa();
            var e3 = this.Ca(i6);
            for (i6 = this.Wc(i6); e3 < i6; e3++)
              n4.uc(2 * e3, h3), r3.$b(h3);
            s6.L(r3);
          }
        }, s5.prototype.hj = function(i6) {
          return this.Cb == null && (this.Cb = new t4.Wk()), !(i6 == 0 || 16 > this.I()) && (i6 = t4.ua.iE(this), this.Cb.RM(i6), true);
        }, s5.prototype.cM = function() {
          if (this.Cb == null && (this.Cb = new t4.Wk()), this.Cb.Bo == null) {
            this.Cb.sD(null);
            var i6 = t4.ua.TN(this);
            this.Cb.sD(i6);
          }
        }, s5.prototype.$o = function(t5) {
          this.zq = t5;
        }, s5.prototype.Kn = function() {
          return this.zq;
        }, s5.prototype.yD = function(i6) {
          if (this == i6)
            throw t4.i.ga("MultiPathImpl.add");
          for (var s6 = this.ea(), n4 = 0; n4 < i6.ea(); n4++)
            this.addPath(i6, n4, true), this.xU(s6), s6++;
        }, s5.prototype.fO = function(i6) {
          var s6 = this.nz(i6), n4 = this.Ca(s6);
          if (n4 != i6) {
            if (i6 >= (s6 = this.Wc(s6)) || i6 < n4)
              throw t4.i.ga("change_ring_start_point");
            for (var h3 = 0, r3 = this.description.Ba; h3 < r3; h3++) {
              var e3 = this.description.ld(h3);
              e3 = t4.sa.Wa(e3), this.Aa[h3].rotate(n4 * e3, i6 * e3, s6 * e3);
            }
          }
        }, s5;
      }(t4.Fx);
      t4.Xk = s4;
    }(Q2 || (Q2 = {})), function(t4) {
      var i4 = function(i5) {
        function s4(s5) {
          var n4 = i5.call(this) || this;
          if (s5 !== void 0) {
            if (s5 == null)
              throw t4.i.O();
            n4.description = s5;
          } else
            n4.description = t4.fe.pg();
          return n4.xa = 0, n4;
        }
        return _2(s4, i5), s4.prototype.Ja = function() {
          return new s4(this.description);
        }, s4.prototype.add = function(t5) {
          this.resize(this.xa + 1), this.Fh(this.xa - 1, t5);
        }, s4.prototype.Du = function(i6, s5) {
          this.resize(this.xa + 1);
          var n4 = new t4.h();
          n4.na(i6, s5), this.Db(this.xa - 1, n4);
        }, s4.prototype.Gd = function(i6, s5, n4) {
          if (n4 = 0 > n4 ? i6.I() : n4, 0 > s5 || s5 > i6.I() || n4 < s5)
            throw t4.i.O();
          if (s5 != n4) {
            this.Ll(i6.description), n4 -= s5;
            var h3 = this.xa;
            this.resize(this.xa + n4), this.oc();
            for (var r3 = 0, e3 = i6.description.Ba; r3 < e3; r3++) {
              var o3 = i6.description.Fd(r3), a3 = t4.sa.Wa(o3), u3 = this.vb(o3);
              o3 = i6.vb(o3), u3.On(h3 * a3, o3, s5 * a3, n4 * a3, true, 1, h3 * a3);
            }
          }
        }, s4.prototype.CD = function(i6, s5) {
          var n4 = i6.length;
          if (s5 = 0 > s5 ? n4 : s5, 0 > n4 || 0 > s5)
            throw t4.i.O();
          if (s5 != 0) {
            n4 = s5 - 0, s5 = this.xa, this.resize(this.xa + n4);
            for (var h3 = 0; h3 < n4; h3++)
              this.Db(s5 + h3, i6[0 + h3]);
          }
        }, s4.prototype.yB = function(i6) {
          if (0 > i6 || i6 >= this.I())
            throw t4.i.ga("index out of bounds");
          this.oc();
          for (var s5 = 0, n4 = this.description.Ba; s5 < n4; s5++)
            if (this.Aa[s5] != null) {
              var h3 = t4.sa.Wa(this.description.Fd(s5));
              this.Aa[s5].Gn(h3 * i6, h3, h3 * this.xa);
            }
          this.xa--, this.Rg--, this.Qc(1993);
        }, s4.prototype.resize = function(t5) {
          this.fm(t5);
        }, s4.prototype.qp = function() {
        }, s4.prototype.Pa = function() {
          i5.prototype.rD.call(this);
        }, s4.prototype.Pc = function(i6) {
          if (i6 instanceof t4.Ed) {
            if (this.B())
              return;
            this.oc();
            for (var s5 = this.Aa[0], n4 = new t4.h(), h3 = 0; h3 < this.xa; h3++)
              n4.x = s5.read(2 * h3), n4.y = s5.read(2 * h3 + 1), i6.Gh(n4, n4), s5.write(2 * h3, n4.x), s5.write(2 * h3 + 1, n4.y);
          } else {
            if (this.B())
              return;
            this.oc(), this.se(1), this.oc(), s5 = this.Aa[0], n4 = this.Aa[1];
            var r3 = new t4.Od();
            for (h3 = 0; h3 < this.xa; h3++) {
              r3.x = s5.read(2 * h3), r3.y = s5.read(2 * h3 + 1), r3.z = n4.read(h3);
              var e3 = i6.hp(r3);
              s5.write(2 * h3, e3.x), s5.write(2 * h3 + 1, e3.y), n4.write(h3, e3.z);
            }
          }
          this.Qc(1993);
        }, s4.prototype.Eb = function() {
          return 0;
        }, s4.prototype.K = function() {
          return 550;
        }, s4.prototype.He = function() {
          return 0;
        }, s4.prototype.Rb = function() {
          return 0;
        }, s4.prototype.Nb = function(t5) {
          return t5 == this || t5 instanceof s4 && i5.prototype.Nb.call(this, t5);
        }, s4.prototype.gW = function(i6, s5) {
          var n4 = this.xa;
          if (n4 = Math.min(n4, s5 + 1e3), 0 > s5 || s5 >= this.xa || n4 < s5 || i6.length != 1e3)
            throw t4.i.O();
          var h3 = n4 - s5, r3 = [];
          for (this.vb(0).Xw(2 * s5, 2 * h3, r3, 0, true), s5 = 0; s5 < h3; s5++)
            i6[s5] = t4.h.construct(r3[2 * s5], r3[2 * s5 + 1]);
          return n4;
        }, s4.prototype.Zx = function() {
        }, s4.prototype.ey = function() {
        }, s4.prototype.nu = function() {
          return false;
        }, s4.prototype.hj = function() {
          return false;
        }, s4.prototype.ng = function() {
          return null;
        }, s4;
      }(t4.Fx);
      t4.ee = i4;
    }(Q2 || (Q2 = {})), function(t4) {
      var i4;
      (i4 = t4.dL || (t4.dL = {}))[i4.NotDetermined = 0] = "NotDetermined", i4[i4.Structure = 1] = "Structure", i4[i4.DegenerateSegments = 2] = "DegenerateSegments", i4[i4.Clustering = 3] = "Clustering", i4[i4.Cracking = 4] = "Cracking", i4[i4.CrossOver = 5] = "CrossOver", i4[i4.RingOrientation = 6] = "RingOrientation", i4[i4.RingOrder = 7] = "RingOrder", i4[i4.OGCPolylineSelfTangency = 8] = "OGCPolylineSelfTangency", i4[i4.OGCPolygonSelfTangency = 9] = "OGCPolygonSelfTangency", i4[i4.OGCDisconnectedInterior = 10] = "OGCDisconnectedInterior";
      var s4 = function() {
        function t5(t6, i5, s5) {
          t6 === void 0 ? (this.Lj = 0, this.Mo = this.Lo = -1) : (this.Lj = t6, this.Lo = i5, this.Mo = s5);
        }
        return t5.prototype.Yt = function(t6) {
          this.Lj = t6.Lj, this.Lo = t6.Lo, this.Mo = t6.Mo;
        }, t5;
      }();
      t4.Nd = s4;
    }(Q2 || (Q2 = {})), function(t4) {
      t4.P = function() {
        function i4() {
        }
        return i4.assert = function(i5) {
          if (i5 === false)
            throw t4.i.BK();
        }, i4.XJ = function(t5) {
          return isNaN(t5) ? NaN : t5 === 0 ? t5 : 0 < t5 ? 1 : -1;
        }, i4.Hu = function(t5) {
          var s4;
          s4 === void 0 && (s4 = 0);
          for (var n4 = [], h3 = 0; h3 < t5; h3++)
            n4[h3] = i4.mg(2, s4);
          return n4;
        }, i4.mg = function(t5, i5) {
          i5 === void 0 && (i5 = 0);
          for (var s4 = [], n4 = 0; n4 < t5; n4++)
            s4[n4] = i5;
          return s4;
        }, i4.bv = function(t5, i5) {
          var s4, n4;
          for (s4 === void 0 && (s4 = 0), n4 === void 0 && (n4 = t5.length - 1); s4 <= n4; s4++)
            t5[s4] = i5;
        }, i4.Tk = function(t5, i5, s4) {
          return t5 < i5 ? i5 : t5 > s4 ? s4 : t5;
        }, i4.Vh = function(t5, i5) {
          var s4 = 5381;
          return ((s4 = ((s4 = ((s4 = i5 !== void 0 ? (i5 << 5) + i5 + (255 & t5) : (s4 << 5) + s4 + (255 & t5)) << 5) + s4 + (t5 >> 8 & 255)) << 5) + s4 + (t5 >> 16 & 255)) << 5) + s4 + (t5 >> 24 & 255) & 2147483647;
        }, i4.wj = function() {
          throw Error("Not Implemented");
        }, i4.XA = function(t5) {
          return i4.WT(t5) + 12345 & 2147483647;
        }, i4.SG = function(t5) {
          var s4 = 32, n4 = t5 % i4.Px | 0, h3 = t5 / i4.Px | 0;
          return (s4 &= 63) == 0 ? t5 : (32 > s4 ? (t5 = n4 >>> s4 | h3 << 32 - s4, s4 = h3 >> s4) : (t5 = h3 >> s4 - 32, s4 = 0 <= h3 ? 0 : -1), s4 * i4.Px + (t5 >>> 0));
        }, i4.WT = function(t5) {
          var i5 = 1103515245, s4 = 65535 & i5;
          return ((i5 - s4) * (t5 |= 0) | 0) + (s4 * t5 | 0) | 0;
        }, i4.truncate = function(t5) {
          return 0 > t5 ? -1 * Math.floor(Math.abs(t5)) : Math.floor(t5);
        }, i4.MAX_SAFE_INTEGER = Math.pow(2, 53) - 1, i4.MIN_SAFE_INTEGER = -i4.MAX_SAFE_INTEGER, i4.QC = 65536, i4.Px = i4.QC * i4.QC, i4;
      }();
    }(Q2 || (Q2 = {})), function(t4) {
      var i4;
      (i4 = t4.xL || (t4.xL = {}))[i4.Project = 0] = "Project", i4[i4.Union = 1] = "Union", i4[i4.Difference = 2] = "Difference", i4[i4.Proximity2D = 3] = "Proximity2D", i4[i4.Relate = 4] = "Relate", i4[i4.Equals = 5] = "Equals", i4[i4.Disjoint = 6] = "Disjoint", i4[i4.Intersects = 7] = "Intersects", i4[i4.Within = 8] = "Within", i4[i4.Contains = 9] = "Contains", i4[i4.Crosses = 10] = "Crosses", i4[i4.Touches = 11] = "Touches", i4[i4.Overlaps = 12] = "Overlaps", i4[i4.Buffer = 13] = "Buffer", i4[i4.Distance = 14] = "Distance", i4[i4.Intersection = 15] = "Intersection", i4[i4.Clip = 16] = "Clip", i4[i4.Cut = 17] = "Cut", i4[i4.DensifyByLength = 18] = "DensifyByLength", i4[i4.DensifyByAngle = 19] = "DensifyByAngle", i4[i4.LabelPoint = 20] = "LabelPoint", i4[i4.GeodesicBuffer = 21] = "GeodesicBuffer", i4[i4.GeodeticDensifyByLength = 22] = "GeodeticDensifyByLength", i4[i4.ShapePreservingDensify = 23] = "ShapePreservingDensify", i4[i4.GeodeticLength = 24] = "GeodeticLength", i4[i4.GeodeticArea = 25] = "GeodeticArea", i4[i4.Simplify = 26] = "Simplify", i4[i4.SimplifyOGC = 27] = "SimplifyOGC", i4[i4.Offset = 28] = "Offset", i4[i4.Generalize = 29] = "Generalize", i4[i4.SymmetricDifference = 30] = "SymmetricDifference", i4[i4.ConvexHull = 31] = "ConvexHull", i4[i4.Boundary = 32] = "Boundary", i4[i4.SimpleRelation = 33] = "SimpleRelation";
      var s4 = function() {
        function t5() {
        }
        return t5.prototype.K = function() {
          return null;
        }, t5.prototype.yn = function() {
        }, t5.prototype.Ku = function() {
          return false;
        }, t5;
      }();
      t4.Ge = s4;
    }(Q2 || (Q2 = {})), function(t4) {
      var i4 = function(i5) {
        function s4() {
          return i5 !== null && i5.apply(this, arguments) || this;
        }
        return _2(s4, i5), s4.prototype.K = function() {
          return 13;
        }, s4.local = function() {
          return s4.instance === null && (s4.instance = new s4()), s4.instance;
        }, s4.prototype.W = function(i6, s5, n4, h3, r3) {
          return i6 instanceof t4.ba ? (r3 = new t4.$c(i6), this.W(r3, s5, [n4], false, h3).next()) : h3 === true ? (n4 = new t4.wC(i6, s5, n4, false, r3), t4.Ih.local().W(n4, s5, r3)) : new t4.wC(i6, s5, n4, false, r3);
        }, s4.instance = null, s4;
      }(t4.Ge);
      t4.vC = i4;
    }(Q2 || (Q2 = {})), function(t4) {
      var i4 = function() {
        function i5(i6, s4, n4, h3, r3) {
          this.za = -1, this.Sd = i6, this.Vz = s4, this.Es = n4, this.nT = new t4.l(), this.nT.Pa(), this.ho = -1, this.Vb = r3;
        }
        return i5.prototype.next = function() {
          for (var t5; (t5 = this.Sd.next()) != null; )
            return this.za = this.Sd.Ma(), this.ho + 1 < this.Es.length && this.ho++, this.buffer(t5, this.Es[this.ho]);
          return null;
        }, i5.prototype.Ma = function() {
          return this.za;
        }, i5.prototype.buffer = function(i6, s4) {
          return t4.CK.buffer(i6, s4, this.Vz, NaN, 96, this.Vb);
        }, i5.prototype.re = function() {
        }, i5;
      }();
      t4.wC = i4;
    }(Q2 || (Q2 = {})), function(t4) {
      var i4 = function(i5) {
        function s4() {
          return i5 !== null && i5.apply(this, arguments) || this;
        }
        return _2(s4, i5), s4.prototype.K = function() {
          return 16;
        }, s4.local = function() {
          return s4.instance === null && (s4.instance = new s4()), s4.instance;
        }, s4.prototype.W = function(i6, s5, n4, h3) {
          return i6 instanceof t4.ba ? (i6 = new t4.$c(i6), this.W(i6, s5, n4, h3).next()) : new t4.gL(i6, s5, n4, h3);
        }, s4.instance = null, s4;
      }(t4.Ge);
      t4.fL = i4;
    }(Q2 || (Q2 = {})), function(t4) {
      var i4 = function() {
        function i5(i6, s4, n4) {
          if (this.za = -1, i6 == null)
            throw t4.i.O();
          this.aa = s4, this.Ak = i6, this.ra = t4.ua.Xd(n4, s4, false);
        }
        return i5.prototype.next = function() {
          var i6;
          return (i6 = this.Ak.next()) != null ? (this.za = this.Ak.Ma(), t4.Vd.clip(i6, this.aa, this.ra, 0)) : null;
        }, i5.prototype.Ma = function() {
          return this.za;
        }, i5.prototype.re = function() {
        }, i5;
      }();
      t4.gL = i4;
    }(Q2 || (Q2 = {})), function(t4) {
      var i4 = function(i5) {
        function s4() {
          return i5 !== null && i5.apply(this, arguments) || this;
        }
        return _2(s4, i5), s4.prototype.K = function() {
          return 31;
        }, s4.local = function() {
          return s4.instance === null && (s4.instance = new s4()), s4.instance;
        }, s4.prototype.W = function(i6, s5, n4) {
          return i6 instanceof t4.ba ? t4.yC.mE(i6) : new t4.yC(s5, i6, n4);
        }, s4.instance = null, s4;
      }(t4.Ge);
      t4.xC = i4;
    }(Q2 || (Q2 = {})), function(t4) {
      var i4 = function() {
        function i5(i6, s4, n4) {
          if (this.pA = new t4.au(), this.za = -1, s4 == null)
            throw t4.i.O();
          this.YG = i6, this.Jc = false, this.Ak = s4, this.Vb = n4;
        }
        return i5.prototype.next = function() {
          if (this.YG) {
            if (!this.Jc) {
              var t5 = this.ZN(this.Ak);
              return this.Jc = true, t5;
            }
            return null;
          }
          if (!this.Jc) {
            if ((t5 = this.Ak.next()) != null)
              return this.za = this.Ak.Ma(), i5.mE(t5);
            this.Jc = true;
          }
          return null;
        }, i5.prototype.Ma = function() {
          return this.za;
        }, i5.prototype.ZN = function(t5) {
          for (var i6; (i6 = t5.next()) != null; )
            this.pA.Ib(i6);
          return this.pA.YQ();
        }, i5.prototype.re = function() {
          if (!this.Jc) {
            if (!this.YG)
              throw t4.i.ga("Invalid call for non merging convex hull.");
            var i6 = this.Ak.next();
            if (i6 == null)
              throw t4.i.ga("Expects a non-null geometry.");
            this.pA.Ib(i6);
          }
        }, i5.mE = function(s4) {
          if (i5.QS(s4))
            return s4;
          var n4 = s4.K();
          if (t4.Xk.zd(n4))
            return (n4 = new t4.Ua(s4.description)).pc(s4, true), n4;
          if (n4 == 550 && s4.I() == 2) {
            var h3 = new t4.Ta();
            return n4 = new t4.Ua(s4.description), s4.we(0, h3), n4.nf(h3), s4.we(1, h3), n4.lineTo(h3), n4;
          }
          return t4.au.MO(s4);
        }, i5.QS = function(i6) {
          if (i6.B())
            return true;
          var s4 = i6.K();
          return s4 == 33 || s4 == 197 || !t4.Xk.zd(s4) && (s4 == 550 ? i6.I() == 1 : s4 == 1607 ? i6.ea() == 1 && 2 >= i6.I() : i6.ea() == 1 && (2 >= i6.I() || t4.au.EG(i6, 0)));
        }, i5;
      }();
      t4.yC = i4;
    }(Q2 || (Q2 = {})), function(t4) {
      var i4 = function(i5) {
        function s4() {
          return i5 !== null && i5.apply(this, arguments) || this;
        }
        return _2(s4, i5), s4.prototype.K = function() {
          return 17;
        }, s4.local = function() {
          return s4.instance === null && (s4.instance = new s4()), s4.instance;
        }, s4.prototype.W = function(i6, s5, n4, h3, r3) {
          return new t4.iL(i6, s5, n4, h3, r3);
        }, s4.instance = null, s4;
      }(t4.Ge);
      t4.hL = i4;
    }(Q2 || (Q2 = {})), function(t4) {
      var i4 = function() {
        function i5(i6, s4, n4, h3, r3) {
          if (this.Vf = null, s4 == null || n4 == null)
            throw t4.i.ga("invalid argument");
          this.kT = i6, this.iA = s4, this.gH = n4, i6 = t4.ua.ov(s4, n4), this.ra = t4.ua.Xd(h3, i6, true), this.fH = -1, this.od = r3;
        }
        return i5.prototype.Ma = function() {
          return 0;
        }, i5.prototype.next = function() {
          return this.MQ(), ++this.fH < this.Vf.length ? this.Vf[this.fH] : null;
        }, i5.prototype.MQ = function() {
          if (this.Vf == null)
            switch (this.Vf = [], this.iA.K()) {
              case 1607:
                this.OQ();
                break;
              case 1736:
                this.NQ();
            }
        }, i5.prototype.OQ = function() {
          var i6 = new t4.Ua(), s4 = new t4.Ua(), n4 = new t4.Ua();
          this.Vf.push(i6), this.Vf.push(s4);
          var h3 = [];
          t4.GK.EK(this.kT, this.iA, this.gH, this.ra, h3, this.od);
          for (var r3 = 0; r3 < h3.length; r3++) {
            var e3 = h3[r3];
            if (e3.ct == 0)
              i6.add(e3.Y, false);
            else if (e3.ct == 1 || e3.ct == 2)
              s4.add(e3.Y, false);
            else if (e3.ct == 3)
              this.Vf.push(e3.Y);
            else {
              if (e3.ct != 4)
                throw t4.i.ga("internal");
              n4.add(e3.Y, false);
            }
          }
          n4.B() || i6.B() && s4.B() && !(3 <= this.Vf.length) || this.Vf.push(n4), i6.B() && s4.B() && 3 > this.Vf.length && (this.Vf.length = 0);
        }, i5.prototype.NQ = function() {
          var i6 = new t4.ja(0), s4 = new t4.hd(), n4 = s4.WE(), h3 = s4.Ib(this.iA), r3 = s4.Ib(this.gH), e3 = new t4.Hg();
          try {
            e3.Gt(s4, this.ra, this.od), e3.fl(n4, h3, r3, i6);
            var o3 = s4.Ke(h3), a3 = new t4.Ea(), u3 = new t4.Ea();
            for (this.Vf.length = 0, this.Vf.push(a3), this.Vf.push(u3), h3 = 0; h3 < i6.size; h3++) {
              var f3 = new t4.hd(), c3 = f3.Ib(o3), l3 = f3.Ib(s4.Ke(i6.get(h3)));
              e3.fr(f3, this.od);
              var p3 = e3.Cv(c3, l3), v3 = f3.Ke(p3);
              if (!v3.B()) {
                var y3 = s4.FF(i6.get(h3), n4);
                y3 == 2 ? a3.add(v3, false) : y3 == 1 ? u3.add(v3, false) : this.Vf.push(v3);
                var b3 = new t4.hd();
                c3 = b3.Ib(o3), l3 = b3.Ib(s4.Ke(i6.get(h3))), e3.fr(b3, this.od), o3 = b3.Ke(e3.km(c3, l3));
              }
            }
            !o3.B() && 0 < i6.size && this.Vf.push(o3), a3.B() && u3.B() && (this.Vf.length = 0);
          } finally {
            e3.Wg();
          }
        }, i5.prototype.re = function() {
        }, i5;
      }();
      t4.iL = i4;
    }(Q2 || (Q2 = {})), function(t4) {
      var i4 = function(i5) {
        function s4() {
          return i5 !== null && i5.apply(this, arguments) || this;
        }
        return _2(s4, i5), s4.prototype.K = function() {
          return 18;
        }, s4.local = function() {
          return s4.instance === null && (s4.instance = new s4()), s4.instance;
        }, s4.prototype.W = function(i6, s5, n4) {
          if (i6 instanceof t4.ba)
            return i6 = new t4.$c(i6), this.W(i6, s5, n4).next();
          if (0 >= s5)
            throw t4.i.O();
          return new t4.jL(i6, s5, n4);
        }, s4.instance = null, s4;
      }(t4.Ge);
      t4.Zl = i4;
    }(Q2 || (Q2 = {})), function(t4) {
      var i4 = function() {
        function i5(t5, i6) {
          this.za = -1, this.Sd = t5, this.Rs = i6;
        }
        return i5.prototype.Ma = function() {
          return this.za;
        }, i5.prototype.next = function() {
          var t5;
          return (t5 = this.Sd.next()) != null ? (this.za = this.Sd.Ma(), this.IP(t5)) : null;
        }, i5.prototype.IP = function(i6) {
          if (i6.B() || 1 > i6.Eb())
            return i6;
          var s4 = i6.K();
          if (s4 == 1736 || s4 == 1607)
            return this.Iy(i6);
          if (t4.ba.zd(s4))
            return this.KP(i6);
          if (s4 == 197)
            return this.JP(i6);
          throw t4.i.Ra();
        }, i5.prototype.KP = function(i6) {
          if (i6.Rb() <= this.Rs)
            return i6;
          var s4 = new t4.Ua(i6.description);
          return s4.pc(i6, true), this.Iy(s4);
        }, i5.prototype.JP = function(i6) {
          var s4 = new t4.Ea(i6.description);
          s4.bd(i6, false);
          var n4 = new t4.l();
          return i6.A(n4), i6 = n4.da(), n4.S() <= this.Rs && i6 <= this.Rs ? s4 : this.Iy(s4);
        }, i5.prototype.Iy = function(i6) {
          for (var s4 = i6.Ja(), n4 = i6.Ha(); n4.ab(); )
            for (var h3 = true; n4.Ia(); ) {
              var r3 = n4.ia();
              if (r3.K() != 322)
                throw t4.i.ga("not implemented");
              var e3 = n4.Qn(), o3 = r3.Rb();
              if (o3 > this.Rs) {
                var a3 = Math.ceil(o3 / this.Rs);
                o3 = new t4.Ta(i6.description), h3 && (r3.Vo(o3), s4.nf(o3));
                var u3 = h3 = 1 / a3, f3 = 0;
                for (--a3; f3 < a3; f3++)
                  r3.Vw(u3, o3), s4.lineTo(o3), u3 += h3;
                e3 ? s4.Cp() : (r3.Ro(o3), s4.lineTo(o3));
              } else
                e3 ? s4.Cp() : s4.pc(r3, h3);
              h3 = false;
            }
          return s4;
        }, i5.prototype.re = function() {
        }, i5;
      }();
      t4.jL = i4;
    }(Q2 || (Q2 = {})), function(t4) {
      var i4 = function(i5) {
        function s4() {
          return i5 !== null && i5.apply(this, arguments) || this;
        }
        return _2(s4, i5), s4.local = function() {
          return s4.instance === null && (s4.instance = new s4()), s4.instance;
        }, s4.prototype.K = function() {
          return 2;
        }, s4.prototype.W = function(i6, s5, n4, h3) {
          return i6 instanceof t4.ba ? (i6 = new t4.$c(i6), s5 = new t4.$c(s5), this.W(i6, s5, n4, h3).next()) : new t4.kL(i6, s5, n4, h3);
        }, s4.km = function(i6, n4, h3, r3) {
          if (i6.B() || n4.B())
            return i6;
          var e3 = i6.Eb(), o3 = n4.Eb();
          if (e3 > o3)
            return i6;
          var a3 = i6.K(), u3 = n4.K(), f3 = new t4.l(), c3 = new t4.l(), l3 = new t4.l();
          i6.A(f3), n4.A(c3), l3.L(f3), l3.$b(c3);
          var p3 = (l3 = t4.ua.Xd(h3, l3, true)) * Math.sqrt(2) * 1.00001, v3 = new t4.l();
          if (v3.L(f3), v3.X(p3, p3), !v3.isIntersecting(c3))
            return i6;
          if (e3 == 1 && o3 == 2)
            return s4.FV(i6, n4, u3, h3, r3);
          if (a3 == 33)
            switch (t4.Xk.zd(u3) ? (h3 = new t4.Ua(n4.description), h3.pc(n4, true)) : h3 = n4, u3) {
              case 1736:
                return s4.SU(i6, h3, l3);
              case 1607:
                return s4.TU(i6, h3, l3);
              case 550:
                return s4.QU(i6, h3, l3);
              case 197:
                return s4.PU(i6, h3, l3);
              case 33:
                return s4.RU(i6, h3, l3);
              default:
                throw t4.i.O();
            }
          else if (a3 == 550)
            switch (u3) {
              case 1736:
                return s4.iU(i6, n4, l3);
              case 197:
                return s4.gU(i6, n4, l3);
              case 33:
                return s4.hU(i6, n4, l3);
            }
          return t4.Hg.km(i6, n4, h3, r3);
        }, s4.SU = function(i6, s5, n4) {
          return t4.jd.FG(s5, i6, n4) == 0 ? i6 : i6.Ja();
        }, s4.TU = function(i6, s5, n4) {
          var h3 = i6.D();
          s5 = s5.Ha();
          for (var r3 = n4 * Math.sqrt(2) * 1.00001, e3 = r3 * r3, o3 = new t4.l(); s5.ab(); )
            for (; s5.Ia(); ) {
              var a3 = s5.ia();
              if (a3.A(o3), o3.X(r3, r3), o3.contains(h3)) {
                if (a3.ss(h3, n4))
                  return i6.Ja();
                var u3 = a3.bc();
                if (t4.h.zc(h3, u3) <= e3)
                  return i6.Ja();
                if (u3 = a3.xc(), t4.h.zc(h3, u3) <= e3)
                  return i6.Ja();
              }
            }
          return i6;
        }, s4.QU = function(i6, s5, n4) {
          var h3 = s5.vb(0);
          s5 = s5.I();
          var r3 = i6.D(), e3 = new t4.h();
          n4 = n4 * Math.sqrt(2) * 1.00001, n4 *= n4;
          for (var o3 = 0; o3 < s5; o3++)
            if (h3.uc(2 * o3, e3), t4.h.zc(e3, r3) <= n4)
              return i6.Ja();
          return i6;
        }, s4.PU = function(i6, s5, n4) {
          var h3 = new t4.l();
          return s5.A(h3), h3.X(n4, n4), s5 = i6.D(), h3.contains(s5) ? i6.Ja() : i6;
        }, s4.RU = function(i6, s5, n4) {
          n4 = n4 * Math.sqrt(2) * 1.00001, n4 *= n4;
          var h3 = i6.D();
          return s5 = s5.D(), t4.h.zc(h3, s5) <= n4 ? i6.Ja() : i6;
        }, s4.iU = function(i6, s5, n4) {
          var h3 = new t4.l();
          s5.A(h3), h3.X(n4, n4);
          for (var r3 = i6.I(), e3 = false, o3 = [], a3 = 0; a3 < r3; a3++)
            o3[a3] = false;
          var u3 = new t4.h();
          for (a3 = 0; a3 < r3; a3++)
            i6.D(a3, u3), h3.contains(u3) && t4.jd.Zd(s5, u3, n4) != 0 && (e3 = true, o3[a3] = true);
          if (!e3)
            return i6;
          for (s5 = i6.Ja(), a3 = 0; a3 < r3; a3++)
            o3[a3] || s5.Gd(i6, a3, a3 + 1);
          return s5;
        }, s4.gU = function(i6, s5, n4) {
          var h3 = new t4.l();
          s5.A(h3), h3.X(n4, n4), s5 = i6.I();
          var r3 = false;
          n4 = [];
          for (var e3 = 0; e3 < s5; e3++)
            n4[e3] = false;
          var o3 = new t4.h();
          for (e3 = 0; e3 < s5; e3++)
            i6.D(e3, o3), h3.contains(o3) && (r3 = true, n4[e3] = true);
          if (!r3)
            return i6;
          for (h3 = i6.Ja(), e3 = 0; e3 < s5; e3++)
            n4[e3] || h3.Gd(i6, e3, e3 + 1);
          return h3;
        }, s4.hU = function(i6, s5, n4) {
          var h3 = i6.vb(0), r3 = i6.I(), e3 = s5.D(), o3 = new t4.h(), a3 = false;
          s5 = [];
          for (var u3 = 0; u3 < r3; u3++)
            s5[u3] = false;
          for (n4 = (u3 = n4 * Math.sqrt(2) * 1.00001) * u3, u3 = 0; u3 < r3; u3++)
            h3.uc(2 * u3, o3), t4.h.zc(o3, e3) <= n4 && (a3 = true, s5[u3] = true);
          if (!a3)
            return i6;
          for (h3 = i6.Ja(), u3 = 0; u3 < r3; u3++)
            s5[u3] || h3.Gd(i6, u3, u3 + 1);
          return h3;
        }, s4.FV = function(i6, s5, n4, h3, r3) {
          var e3 = new t4.Hh();
          i6.dn(e3);
          var o3 = new t4.l();
          return s5.A(o3), e3.$b(o3), e3.X(0.1 * e3.S(), 0.1 * e3.da()), (o3 = new t4.Ea()).bd(e3, false), n4 == 1736 ? o3.add(s5, true) : o3.bd(s5, true), t4.Zj.local().W(i6, o3, h3, r3);
        }, s4.instance = null, s4;
      }(t4.Ge);
      t4.mp = i4;
    }(Q2 || (Q2 = {})), function(t4) {
      var i4 = function() {
        function i5(t5, i6, s4, n4) {
          this.vs = i6 == null, this.za = -1, this.Sd = t5, this.Vz = s4, this.rT = i6.next(), this.Vb = n4;
        }
        return i5.prototype.next = function() {
          return this.vs ? null : (i6 = this.Sd.next()) != null ? (this.za = this.Sd.Ma(), t4.mp.km(i6, this.rT, this.Vz, this.Vb)) : null;
          var i6;
        }, i5.prototype.Ma = function() {
          return this.za;
        }, i5.prototype.re = function() {
        }, i5;
      }();
      t4.kL = i4;
    }(Q2 || (Q2 = {})), function(t4) {
      var i4 = function() {
        function i5(i6) {
          this.od = i6, this.Dj = new t4.l(), this.Dj.Pa(), this.qh = new t4.l(), this.qh.Pa();
        }
        return i5.prototype.Pt = function() {
          var t5 = this.Dj.v;
          this.Dj.v = this.qh.v, this.qh.v = t5, t5 = this.Dj.C, this.Dj.C = this.qh.C, this.qh.C = t5, t5 = this.Dj.G, this.Dj.G = this.qh.G, this.qh.G = t5, t5 = this.Dj.H, this.Dj.H = this.qh.H, this.qh.H = t5;
        }, i5.prototype.$P = function(i6, s5) {
          if (this.od != null && !this.od.progress(-1, -1))
            throw t4.i.hu("user_canceled");
          var n4 = !this.Dj.isIntersecting(this.qh);
          return t4.ba.Ic(i6.K()) && t4.ba.Ic(s5.K()) ? i6.I() > s5.I() ? this.bE(i6, s5, n4) : (this.Pt(), i6 = this.bE(s5, i6, n4), this.Pt(), i6) : i6.K() == 550 && t4.ba.Ic(s5.K()) ? (i6 = this.cE(s5, i6, n4), this.Pt(), i6) : s5.K() == 550 && t4.ba.Ic(i6.K()) ? this.cE(i6, s5, n4) : i6.K() == 550 && s5.K() == 550 ? i6.I() > s5.I() ? this.dE(i6, s5) : (this.Pt(), i6 = this.dE(s5, i6), this.Pt(), i6) : 0;
        }, i5.prototype.bE = function(i6, s5, n4) {
          var h3 = i6.Ha(), r3 = s5.Ha(), e3 = new t4.l(), o3 = new t4.l(), a3 = 17976931348623157e292;
          if (!n4 && this.lY(i6, s5, h3, r3))
            return 0;
          for (; h3.ab(); )
            for (; h3.Ia(); )
              if ((i6 = h3.ia()).A(e3), !(e3.px(this.qh) > a3)) {
                for (; r3.ab(); )
                  for (; r3.Ia(); )
                    if ((s5 = r3.ia()).A(o3), e3.px(o3) < a3 && (s5 = i6.ub(s5, n4), (s5 *= s5) < a3)) {
                      if (s5 == 0)
                        return 0;
                      a3 = s5;
                    }
                r3.aj();
              }
          return Math.sqrt(a3);
        }, i5.prototype.cE = function(i6, s5, n4) {
          var h3 = i6.Ha(), r3 = new t4.l(), e3 = 17976931348623157e292, o3 = new t4.h(), a3 = s5.I();
          for (n4 = !n4 && i6.K() == 1736; h3.ab(); )
            for (; h3.Ia(); ) {
              var u3 = h3.ia();
              if (u3.A(r3), !(1 < a3 && r3.px(this.qh) > e3)) {
                for (var f3 = 0; f3 < a3; f3++) {
                  if (s5.D(f3, o3), n4 && t4.jd.Zd(i6, o3, 0) != 0)
                    return 0;
                  var c3 = u3.ge(o3, false);
                  if (o3.sub(u3.ic(c3)), (c3 = o3.Uk()) < e3) {
                    if (c3 == 0)
                      return 0;
                    e3 = c3;
                  }
                }
                n4 = false;
              }
            }
          return Math.sqrt(e3);
        }, i5.prototype.dE = function(i6, s5) {
          for (var n4, h3 = 17976931348623157e292, r3 = new t4.h(), e3 = new t4.h(), o3 = i6.I(), a3 = s5.I(), u3 = 0; u3 < o3; u3++)
            if (i6.D(u3, r3), !(1 < a3 && this.qh.dK(r3) > h3)) {
              for (var f3 = 0; f3 < a3; f3++)
                if (s5.D(f3, e3), (n4 = t4.h.zc(r3, e3)) < h3) {
                  if (n4 == 0)
                    return 0;
                  h3 = n4;
                }
            }
          return Math.sqrt(h3);
        }, i5.prototype.lY = function(i6, s5, n4, h3) {
          if (i6.K() == 1736) {
            for (; h3.ab(); )
              if (h3.Ia()) {
                var r3 = h3.ia();
                if (t4.jd.Zd(i6, r3.xc(), 0) != 0)
                  return true;
              }
            h3.aj();
          }
          if (s5.K() == 1736) {
            for (; n4.ab(); )
              if (n4.Ia() && (i6 = n4.ia(), t4.jd.Zd(s5, i6.xc(), 0) != 0))
                return true;
            n4.aj();
          }
          return false;
        }, i5.prototype.im = function(t5, i6) {
          return t5.B() || i6.B() ? NaN : (t5.A(this.Dj), i6.A(this.qh), this.$P(t5, i6));
        }, i5;
      }(), s4 = function(s5) {
        function n4() {
          return s5 !== null && s5.apply(this, arguments) || this;
        }
        return _2(n4, s5), n4.prototype.W = function(s6, n5, h3) {
          if (s6 == null || n5 == null)
            throw t4.i.O();
          if (s6.B() || n5.B())
            return NaN;
          var r3 = s6.K(), e3 = n5.K();
          if (r3 == 33) {
            if (e3 == 33)
              return t4.h.ub(s6.D(), n5.D());
            if (e3 == 197)
              return h3 = new t4.l(), n5.A(h3), h3.ub(s6.D());
            (r3 = new t4.ee()).add(s6), s6 = r3;
          } else if (r3 == 197) {
            if (e3 == 197)
              return e3 = new t4.l(), s6.A(e3), h3 = new t4.l(), n5.A(h3), h3.ub(e3);
            (r3 = new t4.Ea()).bd(s6, false), s6 = r3;
          }
          return e3 == 33 ? ((e3 = new t4.ee()).add(n5), n5 = e3) : e3 == 197 && ((e3 = new t4.Ea()).bd(n5, false), n5 = e3), new i4(h3).im(s6, n5);
        }, n4.local = function() {
          return n4.instance === null && (n4.instance = new n4()), n4.instance;
        }, n4.prototype.K = function() {
          return 14;
        }, n4.instance = null, n4;
      }(t4.Ge);
      t4.lL = s4;
    }(Q2 || (Q2 = {})), function(t4) {
      var i4 = function() {
        function i5(t5, i6, s4, n4) {
          this.uH = t5, this.yH = i6, this.od = n4, this.VG = s4;
        }
        return i5.prototype.next = function() {
          var t5 = this.uH.next();
          return t5 == null ? null : this.uC(t5);
        }, i5.prototype.Ma = function() {
          return this.uH.Ma();
        }, i5.prototype.uC = function(i6) {
          var s4 = i6.K();
          if (t4.ba.Tn(s4))
            return i6;
          if (s4 == 197)
            return (s4 = new t4.Ea(i6.description)).bd(i6, false), this.uC(s4);
          if (i6.B())
            return i6;
          if (i6 == null)
            throw t4.i.Ra();
          s4 = i6.Ja();
          for (var n4 = new t4.zb(), h3 = 0, r3 = i6.ea(); h3 < r3; h3++)
            this.OK(i6, h3, s4, n4);
          return s4;
        }, i5.prototype.OK = function(i6, s4, n4, h3) {
          if (!(2 > i6.Ka(s4))) {
            var r3 = i6.Ca(s4), e3 = i6.Wc(s4) - 1, o3 = i6.vb(0), a3 = i6.ec(s4), u3 = new t4.ja(0);
            u3.Jb(i6.Ka(s4) + 1);
            var f3 = new t4.ja(0);
            for (f3.Jb(i6.Ka(s4) + 1), u3.add(a3 ? r3 : e3), u3.add(r3), r3 = new t4.h(); 1 < u3.size; ) {
              var c3 = u3.Gc();
              u3.Jf();
              var l3 = u3.Gc();
              i6.D(c3, r3), h3.Ec(r3), i6.D(l3, r3), h3.Rc(r3), 0 <= (l3 = this.NK(h3, r3, o3, c3, l3, e3)) ? (u3.add(l3), u3.add(c3)) : f3.add(c3);
            }
            if (a3 || f3.add(u3.get(0)), f3.size == u3.size)
              n4.addPath(i6, s4, true);
            else if (2 <= f3.size && (!this.VG || f3.size != 2 || !(a3 || t4.h.ub(i6.Oa(f3.get(0)), i6.Oa(f3.get(1))) <= this.yH))) {
              for (s4 = new t4.Ta(), h3 = 0, e3 = f3.size; h3 < e3; h3++)
                i6.we(f3.get(h3), s4), h3 == 0 ? n4.nf(s4) : n4.lineTo(s4);
              a3 && (this.VG || f3.size != 2 || n4.lineTo(s4), n4.Cp());
            }
          }
        }, i5.prototype.NK = function(t5, i6, s4, n4, h3, r3) {
          var e3 = h3 - 1;
          for (h3 <= n4 && (e3 = r3), r3 = h3 = -1, n4 += 1; n4 <= e3; n4++) {
            s4.uc(2 * n4, i6);
            var o3 = i6.x, a3 = i6.y;
            t5.ic(t5.ge(i6, false), i6), i6.x -= o3, i6.y -= a3, (o3 = i6.length()) > this.yH && o3 > r3 && (h3 = n4, r3 = o3);
          }
          return h3;
        }, i5.prototype.re = function() {
        }, i5;
      }();
      t4.mL = i4;
    }(Q2 || (Q2 = {})), function(t4) {
      var i4 = function(i5) {
        function s4() {
          return i5 !== null && i5.apply(this, arguments) || this;
        }
        return _2(s4, i5), s4.prototype.K = function() {
          return 29;
        }, s4.prototype.W = function(i6, s5, n4, h3) {
          return i6 instanceof t4.ba ? (i6 = new t4.$c(i6), this.W(i6, s5, n4, h3).next()) : new t4.mL(i6, s5, n4, h3);
        }, s4.local = function() {
          return s4.instance === null && (s4.instance = new s4()), s4.instance;
        }, s4.instance = null, s4;
      }(t4.Ge);
      t4.zC = i4;
    }(Q2 || (Q2 = {})), function(t4) {
      var i4 = function(i5) {
        function s4() {
          return i5 !== null && i5.apply(this, arguments) || this;
        }
        return _2(s4, i5), s4.prototype.K = function() {
          return 21;
        }, s4.local = function() {
          return s4.instance === null && (s4.instance = new s4()), s4.instance;
        }, s4.prototype.W = function(i6, s5, n4, h3, r3, e3, o3, a3) {
          return i6 instanceof t4.ba ? (a3 = new t4.$c(i6), this.W(a3, s5, n4, [h3], r3, e3, false, o3).next()) : o3 === true ? (n4 = new t4.BC(i6, s5, n4, h3, r3, false, false, a3), t4.Ih.local().W(n4, s5, a3)) : new t4.BC(i6, s5, n4, h3, r3, false, false, a3);
        }, s4.instance = null, s4;
      }(t4.Ge);
      t4.AC = i4;
    }(Q2 || (Q2 = {})), function(t4) {
      var i4 = function() {
        function i5(i6, s4, n4, h3, r3, e3, o3, a3) {
          if (e3)
            throw t4.i.Fe();
          if (s4 == null)
            throw t4.i.O();
          this.za = -1, this.Os = i6, this.wg = s4, this.Ae = n4, this.Es = h3, this.bo = r3, this.ho = -1, this.Vb = a3, this.oT = new t4.l(), this.oT.Pa();
        }
        return i5.prototype.next = function() {
          for (var t5; (t5 = this.Os.next()) != null; )
            return this.za = this.Os.Ma(), this.ho + 1 < this.Es.length && this.ho++, this.VQ(t5, this.Es[this.ho]);
          return null;
        }, i5.prototype.Ma = function() {
          return this.za;
        }, i5.prototype.VQ = function(i6, s4) {
          return t4.QK.buffer(i6, this.wg, this.Ae, s4, this.bo, this.Vb);
        }, i5.prototype.re = function() {
        }, i5;
      }();
      t4.BC = i4;
    }(Q2 || (Q2 = {})), function(t4) {
      var i4 = function(i5) {
        function s4() {
          return i5 !== null && i5.apply(this, arguments) || this;
        }
        return _2(s4, i5), s4.prototype.K = function() {
          return 24;
        }, s4.local = function() {
          return s4.instance === null && (s4.instance = new s4()), s4.instance;
        }, s4.prototype.W = function(i6, s5, n4) {
          if (s5 == null)
            throw t4.i.O();
          if (i6.B() || 1 > i6.Eb())
            return 0;
          if (n4 == 4)
            throw t4.i.Fe();
          var h3 = t4.cb.tc(s5), r3 = t4.cb.xv(h3), e3 = t4.cb.gv(h3);
          r3 *= 2 - r3;
          var o3 = h3.Id().ci, a3 = i6.K();
          if (a3 == 1736 || a3 == 197)
            var u3 = i6.ng();
          else
            t4.ba.zd(a3) ? (u3 = new t4.Ua(i6.description)).pc(i6, true) : u3 = i6;
          if (h3.Nb(s5) == 0) {
            if (t4.cb.Xc(s5)) {
              u3 = t4.Jh.nj(u3, s5), a3 == 1607 && u3 == i6 && (u3 = t4.ba.kg(i6)), i6 = new t4.Oc(), t4.cb.ih(s5).en(i6), a3 = 0;
              for (var f3 = u3.I(); a3 < f3; a3++) {
                var c3 = u3.Oa(a3);
                c3.x = t4.Jh.an(c3.x, i6), u3.Db(a3, c3);
              }
            }
            i6 = u3.Ja(), u3 = t4.Jh.RI(s5, h3, u3, i6) ? i6 : t4.cb.Bh(u3, s5, h3);
          }
          return this.cQ(u3, n4, e3, r3, o3);
        }, s4.prototype.cQ = function(i6, s5, n4, h3, r3) {
          var e3 = new t4.ha(0), o3 = 0;
          for (i6 = i6.Ha(); i6.ab(); )
            for (; i6.Ia(); ) {
              var a3 = i6.ia(), u3 = a3.bc();
              a3 = a3.xc(), u3.scale(r3), a3.scale(r3), t4.kb.xd(n4, h3, u3.x, u3.y, a3.x, a3.y, e3, null, null, s5), o3 += e3.u;
            }
          return o3;
        }, s4.instance = null, s4;
      }(t4.Ge);
      t4.qL = i4;
    }(Q2 || (Q2 = {})), function(t4) {
      var i4 = function(i5) {
        function s4() {
          return i5 !== null && i5.apply(this, arguments) || this;
        }
        return _2(s4, i5), s4.prototype.K = function() {
          return 18;
        }, s4.local = function() {
          return s4.instance === null && (s4.instance = new s4()), s4.instance;
        }, s4.prototype.W = function(i6, s5, n4, h3, r3) {
          return i6 instanceof t4.ba ? (i6 = new t4.$c(i6), this.W(i6, s5, n4, h3, r3).next()) : new t4.oL(i6, n4, h3, s5, -1, -1, r3);
        }, s4.instance = null, s4;
      }(t4.Ge);
      t4.nL = i4;
    }(Q2 || (Q2 = {})), function(t4) {
      var i4 = function() {
        function i5(i6, s4, n4, h3, r3, e3) {
          if (0 < e3)
            throw t4.i.Fe();
          if (n4 != 4 && 0 < r3)
            throw t4.i.Fe();
          if (s4 == null)
            throw t4.i.O();
          this.za = -1, this.Os = i6, this.wg = s4, this.Ae = n4, this.yT = h3, this.xT = r3;
        }
        return i5.prototype.next = function() {
          for (var t5; (t5 = this.Os.next()) != null; )
            return this.za = this.Os.Ma(), this.Uy(t5);
          return null;
        }, i5.prototype.Ma = function() {
          return this.za;
        }, i5.prototype.Uy = function(i6) {
          return t4.ej.Sr(i6, this.wg, this.Ae, this.yT, this.xT, this.Vb);
        }, i5.prototype.re = function() {
        }, i5;
      }();
      t4.oL = i4;
    }(Q2 || (Q2 = {})), function(t4) {
      !function(t5) {
        t5[t5.Unknown = 0] = "Unknown", t5[t5.Contains = 1] = "Contains", t5[t5.Within = 2] = "Within", t5[t5.Equals = 3] = "Equals", t5[t5.Disjoint = 4] = "Disjoint", t5[t5.Touches = 8] = "Touches", t5[t5.Crosses = 16] = "Crosses", t5[t5.Overlaps = 32] = "Overlaps", t5[t5.NoThisRelation = 64] = "NoThisRelation", t5[t5.Intersects = 1073741824] = "Intersects", t5[t5.IntersectsOrDisjoint = 1073741828] = "IntersectsOrDisjoint";
      }(t4.YK || (t4.YK = {})), t4.rL = function() {
        function i4() {
        }
        return i4.iW = function(i5, s4) {
          var n4 = i5.K(), h3 = s4.K();
          if (t4.ba.zj(n4)) {
            var r3 = i5.Cb;
            if (r3 != null && (r3 = r3.Hk) != null) {
              if (h3 == 33) {
                var e3 = s4.D();
                r3 = r3.Uo(e3.x, e3.y);
              } else
                e3 = new t4.l(), s4.A(e3), r3 = r3.To(e3);
              if (r3 == 1)
                return 1;
              if (r3 == 0)
                return 4;
            }
          }
          if (t4.ba.zj(h3) && ((r3 = s4.Cb) != null && (r3 = r3.Hk) != null)) {
            if (n4 == 33 ? (i5 = i5.D(), r3 = r3.Uo(i5.x, i5.y)) : (s4 = new t4.l(), i5.A(s4), r3 = r3.To(s4)), r3 == 1)
              return 2;
            if (r3 == 0)
              return 4;
          }
          return 0;
        }, i4;
      }();
    }(Q2 || (Q2 = {})), function(t4) {
      var i4 = function(i5) {
        function s4() {
          return i5 !== null && i5.apply(this, arguments) || this;
        }
        return _2(s4, i5), s4.local = function() {
          return s4.instance === null && (s4.instance = new s4()), s4.instance;
        }, s4.prototype.K = function() {
          return 15;
        }, s4.prototype.W = function(i6, s5, n4, h3, r3) {
          return i6 instanceof t4.ba ? (i6 = new t4.$c(i6), s5 = new t4.$c(s5), this.W(i6, s5, n4, h3, r3 === void 0 ? -1 : r3).next()) : r3 === void 0 ? new t4.CC(i6, s5, n4, h3, -1) : new t4.CC(i6, s5, n4, h3, r3);
        }, s4.prototype.yn = function(i6, s5, n4) {
          this.Ku(i6) && (s5 = t4.ua.mj(s5, i6, false), i6.hj(n4) || i6.nu(s5, n4));
        }, s4.prototype.Ku = function(i6) {
          return t4.Mx.uE(i6);
        }, s4.instance = null, s4;
      }(t4.Ge);
      t4.Zj = i4;
    }(Q2 || (Q2 = {})), function(t4) {
      var i4 = function() {
        function i5(i6, s4, n4, h3, r3) {
          if (this.vs = s4 == null, this.za = -1, this.Sd = i6, this.wg = n4, this.Pe = s4.next(), this.Fj = this.Pe.K(), this.Vb = h3, this.Hi = r3, this.Hi != -1 && (0 >= this.Hi || 7 < this.Hi))
            throw t4.i.O("bad dimension mask");
        }
        return i5.prototype.next = function() {
          if (this.vs)
            return null;
          if (this.Bw != null) {
            var t5 = this.Bw.next();
            if (t5 != null)
              return t5;
            this.Bw = null;
          }
          for (; (t5 = this.Sd.next()) != null; )
            return this.za = this.Sd.Ma(), this.Hi == -1 ? t5 = this.Fa(t5) : (this.Bw = this.KS(t5), t5 = this.Bw.next()), t5;
          return null;
        }, i5.prototype.Ma = function() {
          return this.za;
        }, i5.prototype.Fa = function(i6) {
          var s4 = this.uK(i6);
          if (s4 != null)
            return s4;
          s4 = t4.ua.ov(this.Pe, i6);
          var n4 = t4.ua.Xd(this.wg, s4, true);
          s4 = new t4.l(), this.Pe.A(s4);
          var h3 = new t4.l();
          return i6.A(h3), s4.X(2 * n4, 2 * n4), s4.Fa(h3), s4.X(100 * n4, 100 * n4), n4 = t4.Vd.clip(this.Pe, s4, 0, 0), i6 = t4.Vd.clip(i6, s4, 0, 0), t4.Hg.Cv(i6, n4, this.wg, this.Vb);
        }, i5.prototype.KI = function(i6, s4, n4) {
          var h3 = 0;
          if ((1 & s4) != 0)
            n4[0] == null && (n4[0] = new t4.ee(i6)), h3++;
          else
            for (var r3 = 0; r3 < n4.length - 1; r3++)
              n4[r3] = n4[r3 + 1];
          if ((2 & s4) != 0)
            n4[h3] == null && (n4[h3] = new t4.Ua(i6)), h3++;
          else
            for (r3 = h3; r3 < n4.length - 1; r3++)
              n4[r3] = n4[r3 + 1];
          if ((4 & s4) != 0)
            n4[h3] == null && (n4[h3] = new t4.Ea(i6)), h3++;
          else
            for (r3 = h3; r3 < n4.length - 1; r3++)
              n4[r3] = n4[r3 + 1];
          if (h3 != 3) {
            for (i6 = [], r3 = 0; r3 < h3; r3++)
              i6[r3] = n4[r3];
            return new t4.$c(i6);
          }
          return new t4.$c(n4);
        }, i5.prototype.KS = function(i6) {
          var s4 = this.uK(i6);
          if (s4 != null) {
            var n4 = [null, null, null];
            return n4[s4.Eb()] = s4, this.KI(i6.description, this.Hi, n4);
          }
          s4 = t4.ua.ov(this.Pe, i6), n4 = t4.ua.Xd(this.wg, s4, true), s4 = new t4.l(), this.Pe.A(s4), s4.X(2 * n4, 2 * n4);
          var h3 = new t4.l();
          return i6.A(h3), s4.Fa(h3), s4.X(100 * n4, 100 * n4), n4 = t4.Vd.clip(this.Pe, s4, 0, 0), s4 = t4.Vd.clip(i6, s4, 0, 0), n4 = t4.Hg.Kz(s4, n4, this.wg, this.Vb), this.KI(i6.description, this.Hi, n4);
        }, i5.prototype.uK = function(s4) {
          var n4 = t4.ua.ov(s4, this.Pe), h3 = t4.ua.Xd(this.wg, n4, true);
          n4 = s4.K();
          var r3 = s4.B(), e3 = this.Pe.B();
          if (!(e3 = r3 || e3)) {
            e3 = new t4.l(), s4.A(e3);
            var o3 = new t4.l();
            this.Pe.A(o3), o3.X(2 * h3, 2 * h3), e3 = !e3.isIntersecting(o3);
          }
          if (!e3)
            if ((o3 = t4.rL.iW(this.Pe, s4)) == 4)
              e3 = true;
            else {
              if ((2 & o3) != 0)
                return this.Pe;
              if ((1 & o3) != 0)
                return s4;
            }
          if (e3)
            return (h3 = t4.ba.uf(n4)) < (e3 = t4.ba.uf(this.Fj)) ? i5.CB(s4, r3) : h3 > e3 || h3 == 0 && n4 == 550 && this.Fj == 33 ? this.iJ() : i5.CB(s4, r3);
          if ((this.Hi == -1 || this.Hi == 4) && n4 == 197 && this.Fj == 197)
            return h3 = this.Pe, n4 = new t4.l(), s4.A(n4), r3 = new t4.l(), h3.A(r3), n4.Fa(r3), h3 = new t4.Hh(), s4.copyTo(h3), h3.Zo(n4), h3;
          if (n4 == 197 && t4.ba.uf(this.Fj) == 0 || this.Fj == 197 && t4.ba.uf(n4) == 0)
            return r3 = n4 == 197 ? s4 : this.Pe, s4 = n4 == 197 ? this.Pe : s4, n4 = new t4.l(), r3.A(n4), t4.Vd.clip(s4, n4, h3, 0);
          if (t4.ba.uf(n4) == 0 && 0 < t4.ba.uf(this.Fj) || 0 < t4.ba.uf(n4) && t4.ba.uf(this.Fj) == 0) {
            if (h3 = t4.ua.mj(this.wg, s4, false), n4 == 550 || n4 == 33)
              return t4.Hg.uG(s4, this.Pe, h3);
            if (this.Fj == 550 || this.Fj == 33)
              return t4.Hg.uG(this.Pe, s4, h3);
            throw t4.i.Ra();
          }
          return this.Hi != -1 && this.Hi != 2 || n4 != 1607 || this.Fj != 1736 ? this.Hi != -1 && this.Hi != 2 || n4 != 1736 || this.Fj != 1607 ? null : this.rK(this.Pe, s4) : this.rK(s4, this.Pe);
        }, i5.prototype.rK = function(i6, s4) {
          var n4 = i6, h3 = s4, r3 = t4.ua.mj(this.wg, s4, false), e3 = new t4.l();
          h3.A(e3);
          var o3 = new t4.l();
          n4.A(o3), o3.X(2 * r3, 2 * r3), e3.Fa(o3), e3.X(10 * r3, 10 * r3), n4 = i6 = t4.Vd.clip(i6, e3, 0, 0), o3 = new t4.ja(0);
          var a3 = -1, u3 = h3.Cb;
          if (u3 != null) {
            var f3 = u3.Hk;
            if (f3 != null) {
              a3 = 0, o3.Jb(n4.I() + n4.ea());
              for (var c3 = new t4.l(), l3 = n4.Ha(); l3.ab(); )
                for (; l3.Ia(); ) {
                  l3.ia().A(c3);
                  var p3 = f3.To(c3);
                  p3 == 1 ? o3.add(1) : p3 == 0 ? o3.add(0) : (o3.add(-1), a3++);
                }
            }
          }
          if (5 < s4.I() && (u3 = (h3 = s4 = t4.Vd.clip(s4, e3, 0, 0)).Cb), 0 > a3 && (a3 = n4.sz()), e3 = n4.I() + h3.I(), a3 * h3.I() > Math.log(e3) * e3 * 4)
            return null;
          e3 = null, a3 = h3.Ha(), u3 != null && u3.Gb != null && (e3 = u3.Gb), e3 == null && 20 < h3.I() && (e3 = t4.ua.iE(h3)), i6 = i6.Ja(), h3 = null, u3 = n4.Ha(), f3 = [0, 0, 0, 0, 0, 0, 0, 0, 0], c3 = new t4.ce(0), l3 = new t4.jg(), p3 = -1;
          for (var v3 = 0, y3 = 0, b3 = 0 < o3.size, d3 = -1; u3.ab(); ) {
            d3 = u3.gb;
            var g3 = 0;
            for (p3 = -1, v3 = 0; u3.Ia(); ) {
              var w3 = b3 ? t4.P.truncate(o3.get(y3)) : -1;
              y3++;
              var x3 = u3.ia();
              if (0 > w3) {
                if (e3 != null)
                  for (h3 == null ? h3 = e3.qR(x3, r3) : h3.Wo(x3, r3), w3 = h3.next(); w3 != -1; w3 = h3.next()) {
                    a3.Wb(e3.ka(w3)), w3 = a3.ia();
                    var m3 = x3.Fa(w3, null, f3, null, r3);
                    for (w3 = 0; w3 < m3; w3++)
                      c3.add(f3[w3]);
                  }
                else
                  for (a3.aj(); a3.ab(); )
                    for (; a3.Ia(); )
                      for (w3 = a3.ia(), m3 = x3.Fa(w3, null, f3, null, r3), w3 = 0; w3 < m3; w3++)
                        c3.add(f3[w3]);
                if (0 < c3.size) {
                  c3.Wd(0, c3.size, function(t5, i7) {
                    return t5 - i7;
                  });
                  var j3 = 0;
                  c3.add(1), m3 = -1, w3 = 0;
                  for (var M3 = c3.size; w3 < M3; w3++) {
                    var k3 = c3.get(w3);
                    if (k3 != j3) {
                      var z3 = false;
                      if (j3 != 0 || k3 != 1 ? (x3.dh(j3, k3, l3), j3 = l3.get()) : (j3 = x3, z3 = true), 2 <= g3) {
                        if (i6.Fr(n4, d3, p3, v3, g3 == 3), this.LD(s4, j3.bc(), r3) != 1 && this.MD(s4, j3, r3) != 1)
                          return null;
                        i6.pc(j3, false), g3 = 1, v3 = 0;
                      } else
                        switch (m3 = this.MD(s4, j3, r3), m3) {
                          case 1:
                            z3 ? 2 > g3 ? (p3 = u3.xb() - n4.Ca(d3), v3 = 1, g3 = g3 == 0 ? 3 : 2) : v3++ : (i6.pc(j3, g3 == 0), g3 = 1);
                            break;
                          case 0:
                            g3 = 0, p3 = -1, v3 = 0;
                            break;
                          default:
                            return null;
                        }
                      j3 = k3;
                    }
                  }
                } else {
                  if (0 > (w3 = this.LD(s4, x3.bc(), r3)))
                    return null;
                  w3 == 1 ? (2 > g3 && (p3 = u3.xb() - n4.Ca(d3), g3 = g3 == 0 ? 3 : 2), v3++) : (p3 = -1, v3 = 0);
                }
                c3.clear(false);
              } else
                w3 != 0 && w3 == 1 && (g3 == 0 ? (g3 = 3, p3 = u3.xb() - n4.Ca(d3)) : g3 == 1 ? (g3 = 2, p3 = u3.xb() - n4.Ca(d3)) : v3++);
            }
            2 <= g3 && (i6.Fr(n4, d3, p3, v3, g3 == 3), p3 = -1);
          }
          return i6;
        }, i5.prototype.LD = function(i6, s4, n4) {
          return t4.Fg.ym(i6, s4, n4);
        }, i5.prototype.MD = function(i6, s4, n4) {
          var h3 = s4.bc();
          s4 = s4.xc();
          var r3 = t4.Fg.ym(i6, h3, n4), e3 = t4.Fg.ym(i6, s4, n4);
          return r3 == 1 && e3 == 0 || r3 == 0 && e3 == 1 ? -1 : r3 == 0 || e3 == 0 ? 0 : r3 == 1 || e3 == 1 ? 1 : ((r3 = new t4.h()).add(h3, s4), r3.scale(0.5), (i6 = t4.Fg.ym(i6, r3, n4)) == 0 ? 0 : i6 == 1 ? 1 : -1);
        }, i5.CB = function(t5, i6) {
          return i6 ? t5 : t5.Ja();
        }, i5.prototype.iJ = function() {
          return this.tH == null && (this.tH = this.Pe.Ja()), this.tH;
        }, i5.prototype.re = function() {
        }, i5;
      }();
      t4.CC = i4;
    }(Q2 || (Q2 = {})), function(t4) {
      var i4 = function(i5) {
        function s4() {
          return i5 !== null && i5.apply(this, arguments) || this;
        }
        return _2(s4, i5), s4.prototype.K = function() {
          return 28;
        }, s4.local = function() {
          return s4.instance === null && (s4.instance = new s4()), s4.instance;
        }, s4.prototype.W = function(i6, s5, n4, h3, r3, e3, o3) {
          return i6 instanceof t4.ba ? (i6 = new t4.$c(i6), this.W(i6, s5, n4, h3, r3, e3, o3).next()) : new t4.sL(i6, s5, n4, h3, r3, e3, o3);
        }, s4.instance = null, s4;
      }(t4.Ge);
      t4.DC = i4;
    }(Q2 || (Q2 = {})), function(t4) {
      var i4 = function() {
        function i5(t5, i6, s4, n4, h3, r3, e3) {
          this.za = -1, this.Sd = t5, this.Oj = i6, this.La = s4, this.Mi = n4, this.xA = h3, this.pH = r3, this.od = e3;
        }
        return i5.prototype.next = function() {
          var t5 = this.Sd.next();
          return t5 != null ? (this.za = this.Sd.Ma(), this.eL(t5)) : null;
        }, i5.prototype.Ma = function() {
          return this.za;
        }, i5.prototype.eL = function(i6) {
          var s4 = 0 >= this.pH ? t4.ua.mj(this.Oj, i6, false) : this.pH;
          return t4.DK.W(i6, this.La, this.Mi, this.xA, s4, this.od);
        }, i5.prototype.re = function() {
        }, i5;
      }();
      t4.sL = i4;
    }(Q2 || (Q2 = {})), function(t4) {
      var i4;
      (i4 = t4.IK || (t4.IK = {}))[i4.clipToDomainOnly = 1] = "clipToDomainOnly", i4[i4.clipWithHorizon = 2] = "clipWithHorizon", i4[i4.foldAndClipWithHorizon = 3] = "foldAndClipWithHorizon";
      var s4 = function(i5) {
        function s5() {
          return i5 !== null && i5.apply(this, arguments) || this;
        }
        return _2(s5, i5), s5.prototype.K = function() {
          return 0;
        }, s5.local = function() {
          return s5.instance === null && (s5.instance = new s5()), s5.instance;
        }, s5.prototype.W = function(i6, s6, n4) {
          return i6 instanceof t4.ba ? (i6 = new t4.$c(i6), this.W(i6, s6, n4).next()) : new t4.tL(i6, s6, n4);
        }, s5.prototype.transform = function(i6, s6, n4, h3) {
          return t4.du.transform(i6, s6, n4, h3, true);
        }, s5.prototype.St = function(i6, s6, n4, h3) {
          return t4.du.St(i6, s6, n4, h3);
        }, s5.instance = null, s5;
      }(t4.Ge);
      t4.Gx = s4;
    }(Q2 || (Q2 = {})), function(t4) {
      var i4 = function() {
        function i5(t5, i6, s4) {
          this.za = -1, this.Sd = t5, this.HT = i6, this.od = s4;
        }
        return i5.prototype.next = function() {
          var i6 = this.Sd.next();
          return i6 != null ? (this.za = this.Sd.Ma(), t4.du.Bh(i6, this.HT, this.od)) : null;
        }, i5.prototype.Ma = function() {
          return this.za;
        }, i5.prototype.re = function() {
        }, i5;
      }();
      t4.tL = i4;
    }(Q2 || (Q2 = {})), function(t4) {
      var i4 = function() {
        function i5() {
        }
        return i5.prototype.reset = function() {
          this.rh = this.zk = -1, this.ws = this.mq = false;
        }, i5.prototype.vQ = function(t5, i6, s5) {
          for (t5.Wb(i6, s5); t5.Ia(); ) {
            var n4 = t5.ia();
            if ((n4 = n4.Rb()) != 0)
              return t5.xb();
          }
          for (t5.Wb(i6, s5); t5.zz(); )
            if ((n4 = (n4 = t5.ni()).Rb()) != 0)
              return t5.xb();
          return -1;
        }, i5.prototype.wQ = function(t5, i6) {
          for (t5.Wb(i6, -1); t5.zz(); )
            if (t5.ni().Rb() != 0)
              return t5.xb();
          return -1;
        }, i5.prototype.uQ = function(t5, i6) {
          for (t5.Wb(i6, -1), t5.ia(); t5.Ia(); )
            if (t5.ia().Rb() != 0)
              return t5.xb();
          return -1;
        }, i5.prototype.tQ = function(i6, s5, n4, h3) {
          if (this.zk = this.vQ(s5, n4, h3), this.zk != -1) {
            s5.Wb(this.zk, -1);
            var r3 = s5.ia(), e3 = r3.ic(r3.ge(i6, false));
            if (n4 = t4.h.zc(e3, i6), (h3 = new t4.h()).N(e3), h3.sub(r3.bc()), (e3 = new t4.h()).N(i6), e3.sub(r3.bc()), this.mq = 0 > h3.yi(e3), this.rh = this.uQ(s5, this.zk), this.rh != -1) {
              s5.Wb(this.rh, -1);
              var o3 = (r3 = s5.ia()).ge(i6, false);
              o3 = r3.ic(o3);
              var a3 = t4.h.zc(o3, i6);
              a3 > n4 ? this.rh = -1 : (h3.N(o3), h3.sub(r3.bc()), e3.N(i6), e3.sub(r3.bc()), this.ws = 0 > h3.yi(e3));
            }
            this.rh == -1 && (this.rh = this.wQ(s5, this.zk), this.rh != -1 && (s5.Wb(this.rh, -1), o3 = (r3 = s5.ia()).ge(i6, false), o3 = r3.ic(o3), (a3 = t4.h.zc(o3, i6)) > n4 ? this.rh = -1 : (h3.N(o3), h3.sub(r3.bc()), e3.N(i6), e3.sub(r3.bc()), this.ws = 0 > h3.yi(e3), i6 = this.zk, this.zk = this.rh, this.rh = i6, i6 = this.mq, this.mq = this.ws, this.ws = i6)));
          }
        }, i5.prototype.YN = function(t5, i6, s5, n4, h3) {
          return s5 = s5.Ha(), this.tQ(t5, s5, n4, h3), this.zk != -1 && this.rh == -1 ? this.mq : this.zk != -1 && this.rh != -1 ? this.mq == this.ws ? this.mq : (s5.Wb(this.zk, -1), t5 = s5.ia().lg(), s5.Wb(this.rh, -1), i6 = s5.ia().lg(), 0 <= t5.yi(i6)) : i6;
        }, i5;
      }(), s4 = function(s5) {
        function n4() {
          return s5 !== null && s5.apply(this, arguments) || this;
        }
        return _2(n4, s5), n4.local = function() {
          return n4.instance === null && (n4.instance = new n4()), n4.instance;
        }, n4.prototype.K = function() {
          return 3;
        }, n4.prototype.iz = function(i5, s6, n5) {
          var h3;
          if (h3 === void 0 && (h3 = false), i5.B())
            return new t4.bm();
          s6 = s6.D();
          var r3 = i5, e3 = i5.K();
          switch (e3 == 197 && ((r3 = new t4.Ea()).bd(i5, false), e3 = 1736), e3) {
            case 33:
              return this.sI(r3, s6);
            case 550:
              return this.eI(r3, s6);
            case 1607:
            case 1736:
              return this.XT(r3, s6, n5, h3);
            default:
              throw t4.i.ga("not implemented");
          }
        }, n4.prototype.jz = function(i5, s6) {
          if (i5.B())
            return new t4.bm();
          s6 = s6.D();
          var n5 = i5, h3 = i5.K();
          switch (h3 == 197 && ((n5 = new t4.Ea()).bd(i5, false), h3 = 1736), h3) {
            case 33:
              return this.sI(n5, s6);
            case 550:
            case 1607:
            case 1736:
              return this.eI(n5, s6);
            default:
              throw t4.i.ga("not implemented");
          }
        }, n4.prototype.kz = function(i5, s6, n5, h3) {
          if (0 > h3)
            throw t4.i.O();
          if (i5.B())
            return [];
          s6 = s6.D();
          var r3 = i5, e3 = i5.K();
          switch (e3 == 197 && ((r3 = new t4.Ea()).bd(i5, false), e3 = 1736), e3) {
            case 33:
              return this.OU(r3, s6, n5, h3);
            case 550:
            case 1607:
            case 1736:
              return this.oU(r3, s6, n5, h3);
            default:
              throw t4.i.ga("not implemented");
          }
        }, n4.prototype.XT = function(s6, n5, h3, r3) {
          if (s6.K() == 1736 && h3 && (h3 = new t4.l(), s6.A(h3), h3 = t4.ua.Xd(null, h3, false), (r3 ? t4.jd.Zd(s6, n5, 0) : t4.jd.Zd(s6, n5, h3)) != 0)) {
            var e3 = new t4.bm(n5, 0, 0);
            return r3 && e3.RJ(true), e3;
          }
          var o3 = s6.Ha();
          e3 = new t4.h();
          for (var a3 = h3 = -1, u3 = 17976931348623157e292, f3 = 0; o3.ab(); )
            for (; o3.Ia(); ) {
              var c3 = o3.ia();
              c3 = c3.ic(c3.ge(n5, false));
              var l3 = t4.h.zc(c3, n5);
              l3 < u3 ? (f3 = 1, e3 = c3, h3 = o3.xb(), a3 = o3.gb, u3 = l3) : l3 == u3 && f3++;
            }
          return e3 = new t4.bm(e3, h3, Math.sqrt(u3)), r3 && (o3.Wb(h3, a3), c3 = o3.ia(), r3 = 0 > t4.h.Wq(n5, c3.bc(), c3.xc()), 1 < f3 && ((f3 = new i4()).reset(), r3 = f3.YN(n5, r3, s6, h3, a3)), e3.RJ(r3)), e3;
        }, n4.prototype.sI = function(i5, s6) {
          return i5 = i5.D(), s6 = t4.h.ub(i5, s6), new t4.bm(i5, 0, s6);
        }, n4.prototype.eI = function(i5, s6) {
          for (var n5 = i5.vb(0), h3 = i5.I(), r3 = i5 = 0, e3 = 0, o3 = 17976931348623157e292, a3 = 0; a3 < h3; a3++) {
            var u3 = new t4.h();
            n5.uc(2 * a3, u3);
            var f3 = t4.h.zc(u3, s6);
            f3 < o3 && (r3 = u3.x, e3 = u3.y, i5 = a3, o3 = f3);
          }
          return (s6 = new t4.bm()).by(r3, e3, i5, Math.sqrt(o3)), s6;
        }, n4.prototype.OU = function(i5, s6, n5, h3) {
          return h3 == 0 ? [] : (n5 *= n5, i5 = i5.D(), (s6 = t4.h.zc(i5, s6)) <= n5 ? (n5 = [], (h3 = new t4.bm()).by(i5.x, i5.y, 0, Math.sqrt(s6)), n5[0] = h3) : n5 = [], n5);
        }, n4.prototype.oU = function(i5, s6, n5, h3) {
          if (h3 == 0)
            return [];
          var r3 = i5.vb(0), e3 = i5.I();
          i5 = [], n5 *= n5;
          for (var o3 = 0; o3 < e3; o3++) {
            var a3 = r3.read(2 * o3), u3 = r3.read(2 * o3 + 1), f3 = s6.x - a3, c3 = s6.y - u3;
            (f3 = f3 * f3 + c3 * c3) <= n5 && ((c3 = new t4.bm()).by(a3, u3, o3, Math.sqrt(f3)), i5.push(c3));
          }
          return s6 = i5.length, i5.sort(function(t5, i6) {
            return t5.La < i6.La ? -1 : t5.La == i6.La ? 0 : 1;
          }), h3 >= s6 || (i5.length = h3), i5.slice(0);
        }, n4.instance = null, n4;
      }(t4.Ge);
      t4.Hx = s4;
    }(Q2 || (Q2 = {})), function(t4) {
      var i4 = function(i5) {
        function s4() {
          return i5 !== null && i5.apply(this, arguments) || this;
        }
        return _2(s4, i5), s4.prototype.K = function() {
          return 4;
        }, s4.prototype.W = function(i6, s5, n4, h3, r3) {
          return t4.cm.tB(i6, s5, n4, h3, r3);
        }, s4.local = function() {
          return s4.instance === null && (s4.instance = new s4()), s4.instance;
        }, s4.prototype.Ku = function(i6) {
          return t4.Xt.ry(i6);
        }, s4.prototype.yn = function(i6, s5, n4) {
          t4.Xt.xD(i6, s5, n4);
        }, s4.instance = null, s4;
      }(t4.Ge);
      t4.uL = i4;
    }(Q2 || (Q2 = {})), function(t4) {
      var i4 = function(i5) {
        function s4() {
          return i5 !== null && i5.apply(this, arguments) || this;
        }
        return _2(s4, i5), s4.prototype.K = function() {
          return 33;
        }, s4.prototype.W = function(i6, s5, n4, h3, r3) {
          return i6 === 1073741824 ? !t4.vd.uB(s5, n4, h3, 4, r3) : t4.vd.uB(s5, n4, h3, i6, r3);
        }, s4.local = function() {
          return s4.instance === null && (s4.instance = new s4()), s4.instance;
        }, s4.prototype.Ku = function(i6) {
          return t4.Xt.ry(i6);
        }, s4.prototype.yn = function(i6, s5, n4) {
          t4.Xt.xD(i6, s5, n4);
        }, s4.instance = null, s4;
      }(t4.Ge);
      t4.fj = i4;
    }(Q2 || (Q2 = {})), function(t4) {
      var i4 = function() {
        function i5(i6, s4, n4, h3) {
          if (this.od = h3, this.lT = n4, this.za = -1, i6 == null)
            throw t4.i.O();
          this.Ak = i6, this.Oj = s4;
        }
        return i5.prototype.next = function() {
          var i6;
          if ((i6 = this.Ak.next()) != null) {
            if (this.za = this.Ak.Ma(), this.od != null && !this.od.progress(-1, -1))
              throw t4.i.hu("user_canceled");
            return this.$B(i6);
          }
          return null;
        }, i5.prototype.Ma = function() {
          return this.za;
        }, i5.prototype.$B = function(i6) {
          if (i6 == null)
            throw t4.i.O();
          return t4.Ix.YJ(i6, this.Oj, this.lT, this.od);
        }, i5.prototype.re = function() {
        }, i5;
      }();
      t4.vL = i4;
    }(Q2 || (Q2 = {})), function(t4) {
      var i4 = function(i5) {
        function s4() {
          return i5 !== null && i5.apply(this, arguments) || this;
        }
        return _2(s4, i5), s4.prototype.K = function() {
          return 26;
        }, s4.prototype.W = function(i6, s5, n4, h3) {
          return i6 instanceof t4.ba ? (i6 = new t4.$c(i6), this.W(i6, s5, n4, h3).next()) : new t4.vL(i6, s5, n4, h3);
        }, s4.prototype.ts = function(i6, s5, n4, h3, r3) {
          return 0 < (h3 !== void 0 ? t4.Ix.ts(i6, s5, n4, h3, r3) : t4.Ix.ts(i6, s5, false, null, n4));
        }, s4.local = function() {
          return s4.instance === null && (s4.instance = new s4()), s4.instance;
        }, s4.instance = null, s4;
      }(t4.Ge);
      t4.$l = i4;
    }(Q2 || (Q2 = {})), function(t4) {
      var i4 = function() {
        function t5() {
          this.Aq = 0;
        }
        return t5.prototype.iX = function(t6) {
          this.Aq &= -2, this.Aq |= t6 ? 1 : 0;
        }, t5.prototype.Yp = function() {
          return (1 & this.Aq) != 0;
        }, t5.prototype.SF = function() {
          return this.Yp() ? 0 : 1;
        }, t5;
      }();
      t4.tY = i4;
      var s4 = function() {
      }, n4 = function(t5, i5, s5, n5) {
        this.x = t5, this.y = i5, this.Ci = s5, this.zm = n5;
      }, h3 = function() {
        function t5(t6) {
          this.Ce = t6;
        }
        return t5.prototype.compare = function(t6, i5, s5) {
          return t6 = t6.ka(s5), i5 = this.Ce.lf.read(2 * i5), 0 > (i5 -= t6 = this.Ce.lf.read(2 * t6)) ? -1 : 0 < i5 ? 1 : 0;
        }, t5;
      }(), r3 = function() {
        function t5(t6) {
          this.Ce = t6;
        }
        return t5.prototype.compare = function(t6, i5, s5) {
          i5 = this.Ce.hb[i5], t6 = this.Ce.hb[t6.ka(s5)];
          var n5 = i5.Yp(), h4 = t6.Yp();
          s5 = i5.oe.Me(this.Ce.Oo, 0);
          var r4 = t6.oe.Me(this.Ce.Oo, 0);
          return s5 == r4 && ((n5 = 0.5 * ((s5 = Math.min(n5 ? i5.oe.oa : i5.oe.ma, h4 ? t6.oe.oa : t6.oe.ma)) - this.Ce.Oo) + this.Ce.Oo) == this.Ce.Oo && (n5 = s5), s5 = i5.oe.Me(n5, 0), r4 = t6.oe.Me(n5, 0)), s5 < r4 ? -1 : s5 > r4 ? 1 : 0;
        }, t5;
      }(), e3 = function() {
        function i5(i6, s5) {
          this.TI = new t4.h(), this.parent = i6, this.ZR = s5;
        }
        return i5.prototype.qr = function(t5, i6, s5) {
          var n5 = this.parent, h4 = this.ZR;
          s5.Wd(t5, i6, function(t6, i7) {
            return n5.Oh(t6, i7, h4);
          });
        }, i5.prototype.bq = function(t5) {
          return t5 = this.parent.ii.get(t5), this.parent.lf.uc(2 * (t5 >> 1), this.TI), this.TI.y + ((1 & t5) != 0 ? this.parent.Qj : -this.parent.Qj);
        }, i5;
      }(), o3 = function() {
        function o4(i5, s5, n5, h4, r4) {
          this.iH = i5.description, this.Y = i5, this.Sg = s5, this.Qj = t4.ua.mj(this.Sg, i5, false), this.Do = t4.ua.mj(this.Sg, i5, true), this.sA = n5, this.jT = this.iH.Ba, this.hb = [], this.ro = [], this.oh = new t4.lp(), this.fb = new t4.$j(), this.le = new t4.Nd(), this.UG = this.sl = r4;
        }
        return o4.prototype.$S = function() {
          return this.UG = true, (!t4.ba.Ic(this.Y.K()) || this.BE() && this.yE(false)) && this.hO() ? t4.ba.Ic(this.Y.K()) ? this.kO() ? this.Y.K() == 1607 ? this.mO() ? 2 : 0 : this.nO() ? this.oO() : 0 : 0 : 2 : 0;
        }, o4.prototype.fC = function(i5, s5) {
          var n5 = this.lf.read(2 * i5);
          i5 = this.lf.read(2 * i5 + 1);
          var h4 = this.lf.read(2 * s5);
          s5 = this.lf.read(2 * s5 + 1);
          var r4 = !t4.$t.Ev(n5, i5, h4, s5, this.Qj * this.Qj);
          return r4 || this.Y.Eb() != 0 && (n5 == h4 && i5 == s5);
        }, o4.prototype.BE = function() {
          for (var i5 = this.Y, s5 = i5.yf ? 3 : 2, n5 = 0, h4 = i5.ea(); n5 < h4; n5++)
            if (i5.Ka(n5) < s5)
              return this.le = new t4.Nd(1, n5, 0), false;
          return true;
        }, o4.prototype.yE = function(i5) {
          var s5 = this.Y, n5 = s5.Ha(), h4 = s5.hasAttribute(1);
          for (s5 = h4 ? t4.ua.rE(this.Sg, s5, false) : 0; n5.ab(); )
            for (; n5.Ia(); ) {
              var r4 = n5.ia();
              if (!(r4.Rb() > this.Qj)) {
                if (i5 && h4) {
                  var e4 = r4.yv(1, 0);
                  if (r4 = r4.yv(1, 0), Math.abs(r4 - e4) > s5)
                    continue;
                }
                return this.le = new t4.Nd(2, n5.xb(), -1), false;
              }
            }
          return true;
        }, o4.prototype.hO = function() {
          var i5 = this.Y, s5 = null;
          t4.ba.Ic(this.Y.K()) && (s5 = this.Y);
          var n5 = (this.UG || this.sl) && s5 != null, r4 = i5.I();
          this.lf = i5.vb(0), this.ii = new t4.ja(0), this.ii.Jb(2 * r4), this.hi = new t4.ja(0), this.hi.Jb(2 * r4), n5 && (this.Hl == null && (this.Hl = new t4.ja(0)), this.Hl.Jb(r4));
          for (var o5 = i5 = 0; o5 < r4; o5++)
            if (this.ii.add(2 * o5), this.ii.add(2 * o5 + 1), this.hi.add(2 * o5), this.hi.add(2 * o5 + 1), n5) {
              for (; o5 >= s5.Wc(i5); )
                i5++;
              this.Hl.add(i5);
            }
          for (new t4.Zt().sort(this.hi, 0, 2 * r4, new e3(this, n5)), this.fb.clear(), this.fb.Xo(new h3(this)), this.fb.Ee(r4), s5 = 0, r4 *= 2; s5 < r4; s5++)
            if (n5 = this.hi.get(s5), n5 = (i5 = this.ii.get(n5)) >> 1, (1 & i5) == 0) {
              if (i5 = this.fb.addElement(n5, -1), (o5 = this.fb.xe(i5)) != -1 && !this.fC(this.fb.ka(o5), n5))
                return this.le = new t4.Nd(3, n5, this.fb.ka(o5)), false;
              var a3 = this.fb.lb(i5);
              if (a3 != -1 && !this.fC(this.fb.ka(a3), n5))
                return this.le = new t4.Nd(3, n5, this.fb.ka(a3)), false;
            } else if (i5 = this.fb.search(n5, -1), o5 = this.fb.xe(i5), a3 = this.fb.lb(i5), this.fb.wd(i5, -1), o5 != -1 && a3 != -1 && !this.fC(this.fb.ka(o5), this.fb.ka(a3)))
              return this.le = new t4.Nd(3, this.fb.ka(o5), this.fb.ka(a3)), false;
          return true;
        }, o4.prototype.kO = function() {
          return 10 > this.Y.I() ? this.iO() : this.jO();
        }, o4.prototype.jO = function() {
          var i5 = new t4.hd();
          i5.Ib(this.Y);
          var s5 = new t4.Nd();
          return !t4.bu.fI(false, i5, this.Qj, s5, this.od) || (s5.Lo = i5.Va(s5.Lo), s5.Mo = i5.Va(s5.Mo), this.le.Yt(s5), false);
        }, o4.prototype.iO = function() {
          var i5 = this.Y, s5 = i5.Ha();
          for (i5 = i5.Ha(); s5.ab(); )
            for (; s5.Ia(); ) {
              var n5 = s5.ia();
              if (!s5.Sn() || !s5.VS()) {
                i5.wW(s5);
                do {
                  for (; i5.Ia(); ) {
                    var h4 = i5.ia();
                    if ((h4 = n5.Br(h4, this.Qj, true)) != 0)
                      return this.le = new t4.Nd(h4 == 2 ? 5 : 4, s5.xb(), i5.xb()), false;
                  }
                } while (i5.ab());
              }
            }
          return true;
        }, o4.prototype.nO = function() {
          var i5 = this.Y;
          this.hb.length = 0, this.ro.length = 0, this.ag = i5.Ha(), this.ag.EB();
          var s5 = new t4.ja(0);
          s5.Jb(10);
          var n5 = NaN, h4 = 0, r4 = 0;
          for (i5 = 2 * i5.I(); r4 < i5; r4++) {
            var e4 = this.hi.get(r4);
            if ((1 & (e4 = this.ii.get(e4))) == 0) {
              e4 >>= 1;
              var o5 = this.lf.read(2 * e4), a3 = this.lf.read(2 * e4 + 1);
              if (s5.size != 0 && (o5 != n5 || a3 != h4)) {
                if (!this.LI(s5))
                  return false;
                s5 != null && s5.clear(false);
              }
              s5.add(e4), n5 = o5, h4 = a3;
            }
          }
          return !!this.LI(s5);
        }, o4.prototype.mO = function() {
          for (var i5 = this.Y, n5 = Array(i5.ea()), h4 = 0, r4 = i5.ea(); h4 < r4; h4++)
            n5[h4] = i5.Pn(h4);
          r4 = new s4();
          var e4 = new t4.h();
          h4 = this.hi.get(0);
          var o5 = (h4 = this.ii.get(h4)) >> 1;
          this.lf.uc(2 * o5, e4);
          var a3 = n5[h4 = this.Hl.get(o5)], u3 = i5.Ca(h4), f3 = i5.Wc(h4) - 1;
          r4.gl = o5 == u3 || o5 == f3, r4.jy = this.sl ? !a3 && r4.gl : r4.gl, r4.Ci = h4, r4.x = e4.x, r4.y = e4.y, r4.zm = o5;
          for (var c3 = new s4(), l3 = 1, p3 = this.hi.size; l3 < p3; l3++)
            if (h4 = this.hi.get(l3), (1 & (h4 = this.ii.get(h4))) == 0) {
              o5 = h4 >> 1, this.lf.uc(2 * o5, e4), (h4 = this.Hl.get(o5)) != r4.Ci && (a3 = n5[h4], u3 = i5.Ca(h4), f3 = i5.Wc(h4) - 1);
              var v3 = o5 == u3 || o5 == f3, y3 = this.sl ? !a3 && r4.gl : r4.gl;
              if (c3.x = e4.x, c3.y = e4.y, c3.Ci = h4, c3.zm = o5, c3.jy = y3, c3.gl = v3, c3.x == r4.x && c3.y == r4.y) {
                if (this.sl) {
                  if (!(c3.jy && r4.jy || c3.Ci == r4.Ci && (c3.gl || r4.gl)))
                    return this.le = new t4.Nd(8, c3.zm, r4.zm), false;
                } else if (!c3.gl || !r4.gl)
                  return this.le = new t4.Nd(5, c3.zm, r4.zm), false;
              }
              h4 = r4, r4 = c3, c3 = h4;
            }
          return true;
        }, o4.prototype.EE = function() {
          for (var i5 = this.Y, s5 = [], h4 = -1, r4 = false, e4 = 0, o5 = i5.ea(); e4 < o5; e4++)
            i5.Gv(e4) && (r4 = false, h4++, e4 < o5 - 1 && (i5.Gv(e4 + 1) || (r4 = true))), s5[e4] = r4 ? h4 : -1;
          r4 = new t4.h(), e4 = this.hi.get(0);
          var a3 = (e4 = this.ii.get(e4)) >> 1;
          this.lf.uc(2 * a3, r4), e4 = this.Hl.get(a3), h4 = new n4(r4.x, r4.y, e4, a3, s5[e4]), i5 = [];
          var u3 = 1;
          for (o5 = this.hi.size; u3 < o5; u3++)
            if (e4 = this.hi.get(u3), (1 & (e4 = this.ii.get(e4))) == 0) {
              if (a3 = e4 >> 1, this.lf.uc(2 * a3, r4), e4 = this.Hl.get(a3), (e4 = new n4(r4.x, r4.y, e4, a3, s5[e4])).x == h4.x && e4.y == h4.y) {
                if (e4.Ci == h4.Ci)
                  return this.le = new t4.Nd(9, e4.zm, h4.zm), false;
                0 <= s5[e4.Ci] && s5[e4.Ci] == s5[h4.Ci] && (i5.length != 0 && i5[i5.length - 1] == h4 || i5.push(h4), i5.push(e4));
              }
              h4 = e4;
            }
          if (i5.length == 0)
            return true;
          for (e4 = new t4.lp(true), t4.P.bv(s5, -1), r4 = -1, (u3 = new t4.h()).Sc(), h4 = 0, o5 = i5.length; h4 < o5; h4++) {
            (a3 = i5[h4]).x == u3.x && a3.y == u3.y || (r4 = e4.Rh(0), u3.x = a3.x, u3.y = a3.y);
            var f3 = s5[a3.Ci];
            f3 == -1 && (f3 = e4.Rh(2), s5[a3.Ci] = f3), e4.addElement(f3, r4), e4.addElement(r4, f3);
          }
          for ((o5 = new t4.ja(0)).Jb(10), h4 = e4.ke; h4 != -1; h4 = e4.lz(h4))
            if ((1 & (i5 = e4.KF(h4))) == 0 && (2 & i5) != 0) {
              for (i5 = -1, o5.add(h4), o5.add(-1); 0 < o5.size; ) {
                if (r4 = o5.Gc(), o5.Jf(), u3 = o5.Gc(), o5.Jf(), (1 & (a3 = e4.KF(u3))) != 0) {
                  i5 = (2 & a3) == 0 ? r4 : u3;
                  break;
                }
                for (e4.aX(u3, 1 | a3), a3 = e4.sc(u3); a3 != -1; a3 = e4.lb(a3))
                  (f3 = e4.getData(a3)) != r4 && (o5.add(f3), o5.add(u3));
              }
              if (i5 != -1) {
                for (e4 = -1, h4 = 0, o5 = s5.length; h4 < o5; h4++)
                  if (s5[h4] == i5) {
                    e4 = h4;
                    break;
                  }
                return this.le = new t4.Nd(10, e4, -1), false;
              }
            }
          return true;
        }, o4.prototype.oO = function() {
          var i5 = this.Y;
          if (0 >= i5.He())
            return this.le = new t4.Nd(6, i5.ea() == 1 ? 1 : -1, -1), 0;
          if (i5.ea() == 1)
            return this.sl && !this.EE() ? 0 : 2;
          this.vo = t4.ja.rf(i5.ea(), 0), this.EA = t4.ja.rf(i5.ea(), -1);
          for (var s5 = -1, n5 = 0, h4 = 0, e4 = i5.ea(); h4 < e4; h4++) {
            var o5 = i5.Kr(h4);
            if (this.vo.write(h4, 0 > o5 ? 0 : 256), 0 < o5)
              s5 = h4, n5 = o5;
            else {
              if (o5 == 0)
                return this.le = new t4.Nd(6, h4, -1), 0;
              if ((0 > s5 || n5 < Math.abs(o5)) && (this.le = new t4.Nd(7, h4, -1), this.sl))
                return 0;
              this.EA.write(h4, s5);
            }
          }
          for (this.et = i5.ea(), this.Qm = new t4.ja(0), this.Qm.Jb(10), e4 = i5.I(), this.Oo = NaN, (i5 = new t4.ja(0)).Jb(10), this.Sq = t4.ja.rf(e4, -1), this.Jw = t4.ja.rf(e4, -1), this.Bj != null ? this.Bj.clear(false) : this.Bj = new t4.ja(0), this.Bj.Jb(10), this.fb.clear(), this.fb.Xo(new r3(this)), s5 = 0, e4 *= 2; 0 < this.et && s5 < e4; s5++)
            if (n5 = this.hi.get(s5), (1 & (n5 = this.ii.get(n5))) == 0) {
              if (n5 >>= 1, (h4 = this.lf.read(2 * n5 + 1)) != this.Oo && i5.size != 0) {
                if (!this.vt(i5))
                  return 0;
                i5 != null && i5.clear(false);
              }
              i5.add(n5), this.Oo = h4;
            }
          return 0 < this.et && !this.vt(i5) ? 0 : this.sl ? this.le.Lj == 0 && this.EE() ? 2 : 0 : this.le.Lj == 0 ? 2 : 1;
        }, o4.prototype.LI = function(i5) {
          if (i5.size == 1)
            return true;
          for (var s5 = 0, n5 = i5.size; s5 < n5; s5++) {
            var h4 = i5.get(s5);
            this.ag.Wb(h4);
            var r4 = this.ag.ni();
            this.hb.push(this.Uu(r4, h4, this.ag.gb, true)), this.ag.ia(), r4 = this.ag.ia(), this.hb.push(this.Uu(r4, h4, this.ag.gb, false));
          }
          var e4 = this;
          for (this.hb.sort(function(t5, i6) {
            return e4.SP(t5, i6);
          }), (h4 = this.oh.ke) == -1 && (h4 = this.oh.Rh(0)), this.oh.hn(this.hb.length), s5 = 0, n5 = this.hb.length; s5 < n5; s5++)
            this.oh.addElement(h4, s5);
          s5 = true;
          for (var o5 = n5 = -1; s5 && (s5 = false, (r4 = this.oh.sc(h4)) != -1); )
            for (var a3 = this.oh.lb(r4); a3 != -1; )
              if (n5 = this.oh.getData(r4), o5 = this.oh.getData(a3), (n5 = this.hb[n5].Ko) != (o5 = this.hb[o5].Ko))
                r4 = a3, a3 = this.oh.lb(r4);
              else if (s5 = true, this.oh.kd(h4, r4), r4 = this.oh.xe(a3), (a3 = this.oh.kd(h4, a3)) == -1 || r4 == -1)
                break;
          if (s5 = this.oh.ds(h4), this.oh.GE(h4), 0 < s5)
            return this.le = new t4.Nd(5, n5, o5), false;
          for (s5 = 0, n5 = i5.size; s5 < n5; s5++)
            this.qB(this.hb[s5]);
          return this.hb.length = 0, true;
        }, o4.prototype.vt = function(i5) {
          for (var s5 = 0, n5 = i5.size; s5 < n5; s5++) {
            var h4 = i5.get(s5), r4 = this.Sq.read(h4);
            if (r4 != -1) {
              var e4 = this.fb.ka(r4);
              this.Bj.add(e4), this.fb.wd(r4, -1), this.qB(this.hb[e4]), this.hb[e4] = null, this.Sq.write(h4, -1);
            }
            (r4 = this.Jw.read(h4)) != -1 && (e4 = this.fb.ka(r4), this.Bj.add(e4), this.fb.wd(r4, -1), this.qB(this.hb[e4]), this.hb[e4] = null, this.Jw.write(h4, -1));
          }
          for (s5 = 0, n5 = i5.size; s5 < n5; s5++) {
            if (h4 = i5.get(s5), this.ag.Wb(h4), (r4 = this.ag.ni()).oa > r4.ma) {
              var o5 = this.ag.xb(), a3 = this.Uu(r4, h4, this.ag.gb, true);
              0 < this.Bj.size ? (e4 = this.Bj.Gc(), this.Bj.Jf(), this.hb[e4] = a3) : (e4 = this.hb.length, this.hb.push(a3)), r4 = this.fb.addElement(e4, -1), this.Sq.read(o5) == -1 ? this.Sq.write(o5, r4) : this.Jw.write(o5, r4), (3 & this.vo.read(this.ag.gb)) == 0 && this.Qm.add(r4);
            }
            this.ag.ia(), (r4 = this.ag.ia()).oa < r4.ma && (o5 = this.ag.kk(), a3 = this.Uu(r4, h4, this.ag.gb, false), 0 < this.Bj.size ? (e4 = this.Bj.Gc(), this.Bj.Jf(), this.hb[e4] = a3) : (e4 = this.hb.length, this.hb.push(a3)), r4 = this.fb.addElement(e4, -1), this.Sq.read(o5) == -1 ? this.Sq.write(o5, r4) : this.Jw.write(o5, r4), (3 & this.vo.read(this.ag.gb)) == 0 && this.Qm.add(r4));
          }
          for (s5 = 0, n5 = this.Qm.size; s5 < n5 && 0 < this.et; s5++)
            if (r4 = this.Qm.get(s5), (3 & this.vo.read(this.hb[this.fb.ka(r4)].DA)) == 0) {
              i5 = -1, h4 = this.fb.xe(r4);
              var u3 = r4;
              a3 = null, e4 = -1;
              for (var f3 = 0; h4 != -1 && (e4 = this.fb.ka(h4), e4 = (a3 = this.hb[e4]).DA, (3 & (f3 = this.vo.read(e4))) == 0); )
                u3 = h4, h4 = this.fb.xe(h4);
              h4 == -1 ? (o5 = 1, h4 = u3) : (i5 = (3 & f3) == 1 ? e4 : this.EA.read(e4), o5 = a3.SF() != 0 ? 0 : 1, h4 = this.fb.lb(h4));
              do {
                if (e4 = this.fb.ka(h4), e4 = (a3 = this.hb[e4]).DA, (3 & (u3 = this.vo.read(e4))) == 0) {
                  if (o5 != a3.SF())
                    return this.le = new t4.Nd(6, e4, -1), false;
                  if (u3 = 252 & u3 | (f3 = o5 == 0 || a3.Yp() ? 2 : 1), this.vo.write(e4, f3), f3 == 2 && this.le.Lj == 0 && this.EA.read(e4) != i5 && (this.le = new t4.Nd(7, e4, -1), this.sl))
                    return false;
                  if (this.et--, this.et == 0)
                    return true;
                }
                (3 & u3) == 1 && (i5 = e4), u3 = h4, h4 = this.fb.lb(h4), o5 = o5 != 0 ? 0 : 1;
              } while (u3 != r4);
            }
          return this.Qm != null ? this.Qm.clear(false) : this.Qm = new t4.ja(0), true;
        }, o4.prototype.Uu = function(i5, s5, n5, h4) {
          if (i5.K() != 322)
            throw t4.i.Ra();
          return (i5 = this.nP(i5)).Ko = s5, i5.DA = n5, i5.Aq = 0, i5.iX(h4), i5;
        }, o4.prototype.nP = function(s5) {
          if (0 < this.ro.length) {
            var n5 = this.ro[this.ro.length - 1];
            --this.ro.length, s5.copyTo(n5.oe);
          } else
            (n5 = new i4()).oe = t4.NC.kg(s5);
          return n5;
        }, o4.prototype.qB = function(t5) {
          t5.oe.K() == 322 && this.ro.push(t5);
        }, o4.prototype.fU = function() {
          for (var i5 = this.Y.I(), s5 = new t4.ja(0), n5 = 0; n5 < i5; n5++)
            s5.add(n5);
          var h4 = this;
          for (s5.Wd(0, i5, function(t5, i6) {
            return h4.Qu(t5, i6);
          }), n5 = 1; n5 < i5; n5++)
            if (this.Qu(s5.get(n5 - 1), s5.get(n5)) == 0)
              return this.le = new t4.Nd(3, s5.get(n5 - 1), s5.get(n5)), 0;
          return 2;
        }, o4.prototype.EV = function() {
          return this.BE() && this.yE(true) ? 2 : 0;
        }, o4.prototype.jV = function() {
          return this.$S();
        }, o4.prototype.kU = function() {
          for (var i5 = this.Y.I(), s5 = new t4.ja(0), n5 = 0; n5 < i5; n5++)
            s5.add(n5);
          var h4 = this;
          s5.Wd(0, i5, function(t5, i6) {
            return h4.KO(t5, i6);
          });
          var r4 = Array(i5);
          for (t4.P.bv(r4, false), r4[s5.get(0)] = true, n5 = 1; n5 < i5; n5++) {
            var e4 = s5.get(n5 - 1), o5 = s5.get(n5);
            this.Qu(e4, o5) == 0 ? r4[o5] = false : r4[o5] = true;
          }
          s5 = this.Y.Ja(), e4 = this.Y, o5 = 0;
          var a3 = 1;
          for (n5 = 0; n5 < i5; n5++)
            r4[n5] ? a3 = n5 + 1 : (o5 < a3 && s5.Gd(e4, o5, a3), o5 = n5 + 1);
          return o5 < a3 && s5.Gd(e4, o5, a3), s5.Eh(2, this.Do), s5;
        }, o4.prototype.IV = function() {
          var i5 = this.Y, s5 = i5.Ha(), n5 = i5.Ha(), h4 = this.Y.Ja(), r4 = this.Y, e4 = i5.hasAttribute(1), o5 = e4 ? t4.ua.rE(this.Sg, i5, true) : 0, a3 = new t4.ja(0), u3 = new t4.ja(0);
          for (a3.Jb(t4.P.truncate(i5.I() / 2 + 1)), u3.Jb(t4.P.truncate(i5.I() / 2 + 1)); s5.ab(); )
            if (n5.ab(), !(2 > i5.Ka(s5.gb))) {
              n5.yW();
              for (var f3, c3, l3 = true; s5.Ia(); ) {
                var p3 = s5.ia(), v3 = n5.ni();
                if (s5.xb() > n5.xb())
                  break;
                l3 && (a3.add(s5.xb()), u3.add(n5.kk()), l3 = false), c3 = a3.Gc();
                var y3 = s5.kk();
                if (1 < y3 - c3) {
                  var b3 = new t4.h();
                  b3.vc(i5.Oa(c3), i5.Oa(y3)), f3 = b3.length();
                } else
                  f3 = p3.Rb();
                c3 = u3.Gc(), 1 < (y3 = n5.xb()) - c3 ? ((b3 = new t4.h()).vc(i5.Oa(c3), i5.Oa(y3)), c3 = b3.length()) : c3 = v3.Rb(), f3 > this.Do ? a3.add(s5.kk()) : e4 && (f3 = i5.Vc(1, a3.Gc(), 0), p3 = p3.jv(1, 0), Math.abs(p3 - f3) > o5 && a3.add(s5.kk())), c3 > this.Do ? u3.add(n5.xb()) : e4 && (f3 = i5.Vc(1, u3.Gc(), 0), p3 = v3.jv(1, 0), Math.abs(p3 - f3) > o5 && u3.add(n5.xb()));
              }
              if (a3.Gc() < u3.Gc() ? a3.size > u3.size ? a3.Jf() : u3.Jf() : (a3.Gc() != u3.Gc() && u3.Jf(), u3.Jf()), 2 <= u3.size + a3.size) {
                for (l3 = new t4.Ta(), v3 = 0, p3 = a3.size; v3 < p3; v3++)
                  r4.we(a3.get(v3), l3), v3 == 0 ? h4.nf(l3) : h4.lineTo(l3);
                for (v3 = u3.size - 1; 0 < v3; v3--)
                  r4.we(u3.get(v3), l3), h4.lineTo(l3);
                r4.ec(s5.gb) ? h4.Cp() : 0 < u3.size && (r4.we(u3.get(0), l3), h4.lineTo(l3));
              }
              a3 != null && a3.clear(false), u3 != null && u3.clear(false);
            }
          return h4.Eh(2, this.Do), h4;
        }, o4.prototype.mV = function() {
          return this.zX();
        }, o4.prototype.zX = function() {
          return this.Y.K() == 1736 && this.Y.Kn() == 1 ? t4.Hg.Ok(this.Y, this.Do, true, false, this.od) : (this.Ji = new t4.hd(), this.Ji.Ib(this.Y), this.Ji.gd != 0 && (this.sA != 1 && t4.Vk.W(this.Ji, this.Do, this.od, true), this.Y.K() == 1736 && t4.tn.W(this.Ji, this.Ji.md, this.sA, false, this.od)), this.Y = this.Ji.Ke(this.Ji.md), this.Y.K() == 1736 && (this.Y.hm(), this.Y.$o(0)), this.Y.Eh(2, this.Do), this.Y);
        }, o4.ts = function(i5, s5, n5, h4, r4) {
          if (h4 != null && (h4.Lj = 0, h4.Lo = -1, h4.Mo = -1), i5.B())
            return 1;
          var e4 = i5.K();
          if (e4 == 33)
            return 1;
          var a3 = t4.ua.mj(s5, i5, false);
          if (e4 == 197)
            return s5 = new t4.l(), i5.A(s5), s5.Di(a3) ? (h4 != null && (h4.Lj = 2, h4.Lo = -1, h4.Mo = -1), 0) : 1;
          if (t4.ba.zd(e4))
            return (a3 = new t4.Ua(i5.description)).pc(i5, true), o4.ts(a3, s5, n5, h4, r4);
          var u3 = i5.qm(a3);
          if ((n5 = n5 ? -1 : u3) != -1)
            return n5;
          if (s5 = new o4(i5, s5, n5, r4, false), e4 == 550)
            n5 = s5.fU();
          else if (e4 == 1607)
            n5 = s5.EV();
          else {
            if (e4 != 1736)
              throw t4.i.Ra();
            n5 = s5.jV();
          }
          return i5.Eh(n5, a3), h4 != null && n5 == 0 && h4.Yt(s5.le), n5;
        }, o4.YJ = function(i5, s5, n5, h4) {
          if (i5.B())
            return i5;
          var r4 = i5.K();
          if (r4 == 33)
            return i5;
          var e4 = t4.ua.mj(s5, i5, false);
          if (r4 == 197)
            return s5 = new t4.l(), i5.A(s5), s5.Di(e4) ? i5.Ja() : i5;
          if (t4.ba.zd(r4))
            return (r4 = new t4.Ua(i5.description)).pc(i5, true), o4.YJ(r4, s5, n5, h4);
          if (e4 = i5.qm(e4), (n5 = n5 ? -1 : e4) == 2)
            return i5;
          if (i5 = new o4(i5, s5, n5, h4, false), r4 == 550)
            i5 = i5.kU();
          else if (r4 == 1607)
            i5 = i5.IV();
          else {
            if (r4 != 1736)
              throw t4.i.Ra();
            i5 = i5.mV();
          }
          return i5;
        }, o4.prototype.Oh = function(i5, s5, n5) {
          if (i5 == s5)
            return 0;
          i5 = this.ii.get(i5);
          var h4 = this.ii.get(s5);
          s5 = i5 >> 1;
          var r4 = h4 >> 1, e4 = new t4.h(), o5 = new t4.h();
          return this.lf.uc(2 * s5, e4), e4.y += (1 & i5) != 0 ? this.Qj : -this.Qj, this.lf.uc(2 * r4, o5), o5.y += (1 & h4) != 0 ? this.Qj : -this.Qj, (i5 = e4.compare(o5)) == 0 && n5 ? 0 > (n5 = this.Hl.get(s5) - this.Hl.get(r4)) ? -1 : 0 < n5 ? 1 : 0 : i5;
        }, o4.prototype.Qu = function(i5, s5) {
          if (i5 == s5)
            return 0;
          var n5 = this.Y, h4 = n5.Oa(i5), r4 = n5.Oa(s5);
          if (h4.x < r4.x)
            return -1;
          if (h4.x > r4.x)
            return 1;
          if (h4.y < r4.y)
            return -1;
          if (h4.y > r4.y)
            return 1;
          for (h4 = 1; h4 < this.jT; h4++) {
            r4 = this.iH.ld(h4);
            for (var e4 = t4.sa.Wa(r4), o5 = 0; o5 < e4; o5++) {
              var a3 = n5.Vc(r4, i5, o5), u3 = n5.Vc(r4, s5, o5);
              if (a3 < u3)
                return -1;
              if (a3 > u3)
                return 1;
            }
          }
          return 0;
        }, o4.prototype.KO = function(t5, i5) {
          var s5 = this.Qu(t5, i5);
          return s5 == 0 ? t5 < i5 ? -1 : 1 : s5;
        }, o4.prototype.SP = function(t5, i5) {
          if (t5 === i5)
            return 0;
          var s5 = t5.oe.lg();
          t5.Yp() && s5.Uq(), t5 = i5.oe.lg(), i5.Yp() && t5.Uq(), i5 = s5.su();
          var n5 = t5.su();
          return n5 == i5 ? (i5 = s5.yi(t5), Math.abs(i5) <= 8881784197001252e-31 * (Math.abs(t5.x * s5.y) + Math.abs(t5.y * s5.x)) && (i5--, i5++), 0 > i5 ? 1 : 0 < i5 ? -1 : 0) : i5 < n5 ? -1 : 1;
        }, o4;
      }();
      t4.Ix = o3;
    }(Q2 || (Q2 = {})), function(t4) {
      var i4 = function(i5) {
        function s4() {
          return i5 !== null && i5.apply(this, arguments) || this;
        }
        return _2(s4, i5), s4.prototype.K = function() {
          return 30;
        }, s4.local = function() {
          return s4.instance === null && (s4.instance = new s4()), s4.instance;
        }, s4.prototype.W = function(i6, s5, n4, h3) {
          return i6 instanceof t4.ba ? (i6 = new t4.$c(i6), s5 = new t4.$c(s5), this.W(i6, s5, n4, h3).next()) : new t4.wL(i6, s5, n4, h3);
        }, s4.gp = function(i6, n4, h3, r3) {
          var e3 = i6.Eb(), o3 = n4.Eb();
          if (i6.B() && n4.B())
            return e3 > o3 ? i6 : n4;
          if (i6.B())
            return n4;
          if (n4.B())
            return i6;
          var a3 = new t4.l(), u3 = new t4.l(), f3 = new t4.l();
          return i6.A(a3), n4.A(u3), f3.L(a3), f3.$b(u3), a3 = t4.ua.Xd(h3, f3, true), u3 = i6.K(), f3 = n4.K(), u3 == 33 && f3 == 33 ? s4.WU(i6, n4, a3) : u3 != f3 ? 0 < e3 || 0 < o3 ? e3 > o3 ? i6 : n4 : u3 == 550 ? s4.dI(i6, n4, a3) : s4.dI(n4, i6, a3) : t4.Hg.gp(i6, n4, h3, r3);
        }, s4.WU = function(i6, s5, n4) {
          n4 = n4 * Math.sqrt(2) * 1.00001, n4 *= n4;
          var h3 = i6.D(), r3 = s5.D(), e3 = new t4.ee(i6.description);
          return t4.h.zc(h3, r3) > n4 && (e3.add(i6), e3.add(s5)), e3;
        }, s4.dI = function(i6, s5, n4) {
          var h3 = i6.vb(0), r3 = i6.I(), e3 = s5.D(), o3 = i6.Ja();
          n4 = n4 * Math.sqrt(2) * 1.00001;
          var a3 = new t4.l();
          if (i6.A(a3), a3.X(n4, n4), a3.contains(e3)) {
            n4 *= n4, a3 = false;
            for (var u3 = [], f3 = 0; f3 < r3; f3++)
              u3[f3] = false;
            for (f3 = 0; f3 < r3; f3++) {
              var c3 = h3.read(2 * f3), l3 = h3.read(2 * f3 + 1);
              (c3 -= e3.x) * c3 + (l3 -= e3.y) * l3 <= n4 && (a3 = true, u3[f3] = true);
            }
            if (a3)
              for (f3 = 0; f3 < r3; f3++)
                u3[f3] || o3.Gd(i6, f3, f3 + 1);
            else
              o3.Gd(i6, 0, r3), o3.add(s5);
          } else
            o3.Gd(i6, 0, r3), o3.add(s5);
          return o3;
        }, s4.instance = null, s4;
      }(t4.Ge);
      t4.Jx = i4;
    }(Q2 || (Q2 = {})), function(t4) {
      var i4 = function() {
        function i5(t5, i6, s4, n4) {
          this.vs = i6 == null, this.za = -1, this.Sd = t5, this.wg = s4, this.IT = i6.next(), this.Vb = n4;
        }
        return i5.prototype.next = function() {
          return this.vs ? null : (i6 = this.Sd.next()) != null ? (this.za = this.Sd.Ma(), t4.Jx.gp(i6, this.IT, this.wg, this.Vb)) : null;
          var i6;
        }, i5.prototype.Ma = function() {
          return this.za;
        }, i5.prototype.re = function() {
        }, i5;
      }();
      t4.wL = i4;
    }(Q2 || (Q2 = {})), function(t4) {
      var i4 = function() {
        function t5() {
        }
        return t5.prototype.Az = function() {
          this.Vy = null, this.zx = -1, this.vK = false;
        }, t5;
      }(), s4 = function() {
        function t5() {
          this.Ir = 0, this.rj = [];
        }
        return t5.prototype.kN = function(t6) {
          this.Ir += t6.zx, this.rj.push(t6);
        }, t5.prototype.OV = function() {
          this.Ir -= this.rj[this.rj.length - 1].zx, --this.rj.length;
        }, t5.prototype.iy = function() {
          return this.rj[this.rj.length - 1];
        }, t5.prototype.Nb = function(t6) {
          return t6 === this;
        }, t5;
      }(), n4 = function() {
        function n5(t5, i5, s5) {
          this.za = -1, this.Jc = false, this.vH = [false, false, false, false], this.wq = [0, 0, 0, 0], this.eA = false, this.Bk = -1, this.kq = 0, this.eo = -1, this.Fo = [], this.Sd = t5, this.wg = i5, this.Vb = s5;
        }
        return n5.ZD = function(t5) {
          var i5 = [], s5 = 0;
          for (t5 = Object.keys(t5); s5 < t5.length; s5++)
            i5.push(Number(t5[s5]));
          return i5.sort(function(t6, i6) {
            return t6 - i6;
          }), i5;
        }, n5.prototype.aG = function(i5) {
          var s5 = this.Fo[i5], h3 = n5.ZD(s5)[0], r3 = s5[h3], e3 = r3.iy().Vy;
          return r3 = r3.iy().vK, delete s5[h3], r3 && (e3 = t4.$l.local().W(e3, this.wg, false, this.Vb), i5 == 0 && e3.K() == 33 && (i5 = new t4.ee(e3.description), e3.B() || i5.add(e3), e3 = i5)), e3;
        }, n5.prototype.next = function() {
          if (this.Jc && this.eo == this.Bk)
            return null;
          for (; !this.lK(); )
            ;
          if (this.Bk == -1)
            return null;
          if (this.eA) {
            for (this.eo++; ; ) {
              if (this.eo > this.Bk || 0 > this.eo)
                throw t4.i.Ra();
              if (this.vH[this.eo])
                break;
            }
            return this.za++, this.aG(this.eo);
          }
          return this.za = 0, this.eo = this.Bk, this.aG(this.Bk);
        }, n5.prototype.Ma = function() {
          return this.za;
        }, n5.prototype.lK = function() {
          if (this.Jc)
            return true;
          var i5 = null;
          if (this.Sd != null && ((i5 = this.Sd.next()) == null && (this.Jc = true, this.Sd = null)), t4.op.Bp(this.Vb), i5 != null) {
            var s5 = i5.Eb();
            this.vH[s5] = true, s5 >= this.Bk && !this.eA && (this.HD(s5, false, i5), s5 > this.Bk && !this.eA && this.uW(s5));
          }
          if (0 < this.kq)
            for (s5 = 0; s5 <= this.Bk; s5++)
              for (; 1 < this.wq[s5] && (i5 = this.AO(s5)).length != 0; )
                i5 = t4.Hg.QP(i5, this.wg, this.Vb), this.HD(s5, true, i5);
          return this.Jc;
        }, n5.prototype.AO = function(t5) {
          for (var i5 = [], s5 = [], h3 = this.Fo[t5], r3 = n5.ZD(h3), e3 = 0; e3 < r3.length; e3++) {
            var o3 = r3[e3], a3 = h3[o3];
            if (this.Jc || 1e4 < a3.Ir && 1 < a3.rj.length) {
              for (this.wq[t5] -= a3.rj.length, this.kq -= a3.rj.length; 0 < a3.rj.length; )
                i5.push(a3.iy().Vy), a3.OV();
              s5.push(o3);
            }
          }
          for (e3 = 0; e3 < s5.length; e3++)
            delete h3[s5[e3]];
          return i5;
        }, n5.prototype.uW = function(t5) {
          for (var i5 = 0; i5 < t5; i5++)
            this.Fo[i5] = [], this.kq -= this.wq[i5], this.wq[i5] = 0;
        }, n5.prototype.HD = function(t5, h3, r3) {
          var e3 = new i4();
          if (e3.Az(), e3.Vy = r3, r3 = n5.$R(r3), e3.zx = r3, r3 = n5.YR(r3), t5 + 1 > this.Fo.length)
            for (var o3 = 0, a3 = Math.max(2, t5 + 1); o3 < a3; o3++)
              this.Fo.push([]);
          (o3 = this.Fo[t5][r3]) === void 0 && (o3 = new s4(), this.Fo[t5][r3] = o3), e3.vK = h3, o3.kN(e3), this.wq[t5]++, this.kq++, this.Bk = Math.max(this.Bk, t5);
        }, n5.YR = function(i5) {
          return 0 < i5 ? t4.P.truncate(Math.log(i5) / Math.log(4) + 0.5) : 0;
        }, n5.$R = function(i5) {
          var s5 = i5.K();
          if (t4.ba.zj(s5))
            return i5.I();
          if (s5 == 33)
            return 1;
          if (s5 == 197)
            return 4;
          if (t4.ba.zd(s5))
            return 2;
          throw t4.i.Ra();
        }, n5.prototype.re = function() {
          this.lK();
        }, n5;
      }();
      t4.yL = n4;
    }(Q2 || (Q2 = {})), function(t4) {
      var i4 = function(i5) {
        function s4() {
          return i5 !== null && i5.apply(this, arguments) || this;
        }
        return _2(s4, i5), s4.prototype.K = function() {
          return 1;
        }, s4.prototype.W = function(i6, s5, n4, h3) {
          return h3 === void 0 ? new t4.yL(i6, s5, n4) : this.bQ(i6, s5, n4, h3);
        }, s4.prototype.bQ = function(i6, s5, n4, h3) {
          return i6 = new t4.$c([i6, s5]), this.W(i6, n4, h3).next();
        }, s4.local = function() {
          return s4.instance === null && (s4.instance = new s4()), s4.instance;
        }, s4.instance = null, s4;
      }(t4.Ge);
      t4.Ih = i4;
    }(Q2 || (Q2 = {})), function(t4) {
      var i4, s4;
      (s4 = i4 || (i4 = {}))[s4.nextPath = 0] = "nextPath", s4[s4.nextSegment = 1] = "nextSegment", s4[s4.iterate = 2] = "iterate", i4 = function() {
        function i5(i6, s5, n4, h3) {
          this.Vs = new t4.l(), this.BT = i6, this.CT = s5, this.oq = h3, this.wo = -1, this.tl = false;
          var r3 = i6.Cb;
          r3 != null && ((r3 = h3 ? r3.Bo : r3.Gb) != null && (this.Jc = false, this.ra = n4, this.Gb = r3, this.zw = this.Gb.getIterator(), this.pq = this.tl = true, this.Yb = 0, h3 ? this.wo = s5.ea() : this.td = s5.Ha())), this.tl || (r3 = s5.Cb) != null && ((r3 = h3 ? r3.Bo : r3.Gb) != null && (this.Jc = false, this.ra = n4, this.Gb = r3, this.zw = this.Gb.getIterator(), this.tl = true, this.pq = false, this.Yb = 0, h3 ? this.wo = i6.ea() : this.td = i6.Ha())), this.tl || (this.ei = h3 ? t4.ua.hR(i6, s5, n4, 1 <= i6.qm(0), 1 <= s5.qm(0)) : t4.ua.gR(i6, s5, n4));
        }
        return i5.prototype.next = function() {
          if (this.tl) {
            if (this.Jc)
              return false;
            for (var i6 = true; i6; )
              switch (this.Yb) {
                case 0:
                  i6 = this.sU();
                  break;
                case 1:
                  i6 = this.tU();
                  break;
                case 2:
                  i6 = this.Pz();
                  break;
                default:
                  throw t4.i.ga("internal error");
              }
            return !this.Jc;
          }
          return this.ei != null && this.ei.next();
        }, i5.prototype.pl = function() {
          return this.tl ? this.pq ? this.Gb.ka(this.Hs) : this.oq ? this.wo : this.td.xb() : this.ei.pl(this.ei.Xf);
        }, i5.prototype.jl = function() {
          return this.tl ? this.pq ? this.oq ? this.wo : this.td.xb() : this.Gb.ka(this.Hs) : this.ei.jl(this.ei.Bf);
        }, i5.prototype.oz = function() {
          if (!this.oq)
            throw t4.i.ga("internal error");
          return this.tl ? this.pq ? this.Gb.BF(this.Hs) : this.Vs : this.ei.oz(this.ei.Xf);
        }, i5.prototype.Wy = function() {
          if (!this.oq)
            throw t4.i.ga("internal error");
          return this.tl ? this.pq ? this.Vs : this.Gb.BF(this.Hs) : this.ei.Wy(this.ei.Bf);
        }, i5.prototype.sU = function() {
          return this.oq ? --this.wo == -1 ? (this.Jc = true, false) : (this.pq ? this.CT.Tj(this.wo, this.Vs) : this.BT.Tj(this.wo, this.Vs), this.zw.Zi(this.Vs, this.ra), this.Yb = 2, true) : this.td.ab() ? (this.Yb = 1, true) : (this.Jc = true, false);
        }, i5.prototype.tU = function() {
          if (!this.td.Ia())
            return this.Yb = 0, true;
          var t5 = this.td.ia();
          return this.zw.Wo(t5, this.ra), this.Yb = 2, true;
        }, i5.prototype.Pz = function() {
          return this.Hs = this.zw.next(), this.Hs == -1 && (this.Yb = this.oq ? 0 : 1, true);
        }, i5;
      }(), t4.am = i4;
    }(Q2 || (Q2 = {})), function(t4) {
      (t4 = t4.JL || (t4.JL = {}))[t4.enumClosed = 1] = "enumClosed", t4[t4.enumHasNonlinearSegments = 2] = "enumHasNonlinearSegments", t4[t4.enumOGCStartPolygon = 4] = "enumOGCStartPolygon", t4[t4.enumCalcMask = 4] = "enumCalcMask";
    }(Q2 || (Q2 = {})), function(t4) {
      t4.LC = function() {
        function i4() {
        }
        return i4.ub = function(s4, n4, h3, r3, e3, o3, a3, u3, f3) {
          var c3 = [0, 0, 0], l3 = [0, 0, 0], p3 = [0, 0, 0], v3 = [0, 0, 0, 0], y3 = new t4.ha(0), b3 = new t4.ha(0), d3 = new t4.ha(0);
          if (a3 != null || u3 != null || f3 != null)
            if (t4.s.vi(n4))
              t4.$g.ub(s4, h3, r3, e3, o3, a3, u3, f3);
            else {
              e3 = t4.F.ca(e3), h3 = t4.F.ca(h3);
              var g3 = t4.F.ca(e3 - h3);
              if (t4.s.$(r3, o3) && (t4.s.$(h3, e3) || t4.s.$(t4.s.R(r3), 1.570796326794897)))
                a3 != null && (a3.u = 0), u3 != null && (u3.u = 0), f3 != null && (f3.u = 0);
              else {
                if (t4.s.$(r3, -o3)) {
                  if (t4.s.$(t4.s.R(r3), 1.570796326794897))
                    return a3 != null && (a3.u = 2 * t4.F.Ch(s4, n4)), u3 != null && (u3.u = 0 < r3 ? t4.F.ca(3.141592653589793 - t4.F.ca(e3)) : t4.F.ca(e3)), void (f3 != null && (f3.u = 0 < r3 ? t4.F.ca(e3) : t4.F.ca(3.141592653589793 - t4.F.ca(e3))));
                  t4.s.$(t4.s.R(g3), 3.141592653589793) && (a3 != null && (a3.u = 2 * t4.F.Ch(s4, n4)), u3 != null && (u3.u = 0), f3 != null && (f3.u = 0));
                } else {
                  if (t4.s.$(t4.s.R(r3), 1.570796326794897) || t4.s.$(t4.s.R(o3), 1.570796326794897))
                    return void t4.Yk.ub(s4, n4, h3, r3, e3, o3, a3, u3, f3);
                  if (t4.s.$(h3, e3) || t4.s.$(t4.s.R(g3), 3.141592653589793))
                    return void t4.Yk.ub(s4, n4, h3, r3, e3, o3, a3, u3, f3);
                  if (t4.s.Dd(r3))
                    return void t4.Yk.ub(s4, n4, h3, r3, e3, o3, a3, u3, f3);
                }
                var w3 = Math.sqrt(1 - n4);
                e3 = t4.F.ca(e3 - h3), h3 = 0, t4.F.el(1, n4, r3, h3, 0, y3, b3, d3), c3[0] = y3.u, c3[1] = b3.u, c3[2] = d3.u, t4.F.el(1, n4, o3, e3, 0, y3, b3, d3), l3[0] = y3.u, l3[1] = b3.u, l3[2] = d3.u, p3[0] = 0, p3[1] = 0, p3[2] = -1 * n4 * t4.F.n(1, n4, r3) * Math.sin(r3), 0 > e3 ? t4.F.Yq(p3, l3, c3, v3, 0) : t4.F.Yq(p3, c3, l3, v3, 0), b3 = [0, 0, 0], d3 = [0, 0, 0];
                var x3 = [0, 0, 0];
                c3 = [0, 0, 0], y3 = [0, 0, 0];
                var m3 = Math.acos(v3[2] / 1), j3 = 1 - n4, M3 = Math.tan(m3), k3 = 1 + M3 * M3 / j3, z3 = 2 * p3[2] * M3 / j3;
                for (j3 = (-z3 + (M3 = Math.sqrt(z3 * z3 - 4 * k3 * (p3[2] * p3[2] / j3 - 1)))) / (k3 *= 2), z3 = (-z3 - M3) / k3, M3 = Math.tan(m3), m3 = (j3 + z3) / 2, p3 = ((k3 = M3 * j3 + p3[2]) + (M3 * z3 + p3[2])) / 2, M3 = t4.F.ip(j3 - m3, k3 - p3), j3 = p3 / w3 * 1.570796326794897, z3 = 0; 100 > z3 && (k3 = (k3 = t4.F.w(n4, j3)) * k3 / Math.cos(j3) * (Math.sin(j3) - p3 * k3 / (1 - n4)), !t4.s.Dd(k3)); z3++)
                  j3 -= k3;
                p3 = t4.F.n(1, n4, j3) * Math.cos(j3), M3 = 1 - M3 / (p3 = Math.sqrt((p3 - m3) * (p3 + m3))), M3 *= 2 - M3, k3 = t4.F.qn(b3), m3 = t4.F.qn(d3), j3 = t4.F.qn(x3);
                var A3 = t4.F.Ut(x3, b3);
                z3 = t4.F.Ut(x3, d3), t4.F.yx(x3, b3, c3), t4.F.yx(x3, d3, y3), b3 = Math.acos(A3 / (j3 * k3)), d3 = Math.acos(z3 / (j3 * m3)), d3 *= t4.s.Mb(1, t4.F.Ut(c3, y3)), (1.570796326794897 <= t4.s.R(b3) && 1.570796326794897 <= t4.s.R(d3) || 3.141592653589793 < t4.s.R(b3 - d3)) && (b3 = (3.141592653589793 - t4.s.R(b3)) * t4.s.Mb(1, b3), d3 = (3.141592653589793 - t4.s.R(d3)) * t4.s.Mb(1, d3)), c3 = t4.F.Sj(M3, d3), y3 = t4.F.q(p3, M3, t4.F.Sj(M3, b3)), c3 = t4.F.q(p3, M3, c3), c3 = t4.s.R(c3 - y3) * s4, b3 = new t4.ha(0), d3 = new t4.ha(0), x3 = v3[1] / 1, x3 *= -t4.s.Mb(1, g3), y3 = Math.acos(x3) * t4.s.Mb(1, g3), i4.sf(s4, n4, h3, r3, c3, y3, b3, d3), t4.s.$(e3, b3.u) && t4.s.$(o3, d3.u) || (M3 = t4.F.ip(t4.F.ca(e3 - b3.u), o3 - d3.u), i4.sf(s4, n4, h3, r3, c3, t4.F.ca(y3 + 3.141592653589793), b3, d3), (k3 = t4.F.ip(t4.F.ca(e3 - b3.u), o3 - d3.u)) < M3 && (y3 = t4.F.ca(y3 + 3.141592653589793))), b3 = [0, 0, 0, 0], d3 = [0, 0, 0, 0], M3 = [0, 0, 0], s4 = [0, 0, 0], h3 = [0, 0, 0], r3 = [0, 0, 0], x3 = [0, 0, 0], (p3 = [0, 0, 0])[0] = 0, p3[1] = 0, p3[2] = w3, M3[0] = 0, M3[1] = 0, M3[2] = 0, t4.F.Yq(M3, p3, l3, b3, 0), t4.s.Dd(o3) ? (s4[0] = l3[0], s4[1] = l3[1], s4[2] = 1, h3[0] = 1 * Math.cos(e3) - 1 * Math.sin(e3), h3[1] = 1 * Math.sin(e3) + 1 * Math.cos(e3)) : (n4 = t4.F.n(1, n4, o3) * Math.cos(o3), s4[0] = 0, s4[1] = 0, l3[2] += Math.tan(1.570796326794897 - t4.s.R(o3)) * n4 * t4.s.Mb(1, o3), h3[0] = n4 * Math.cos(e3) - n4 * Math.sin(e3), h3[1] = n4 * Math.sin(e3) + n4 * Math.cos(e3)), h3[2] = l3[2], t4.F.Yq(l3, h3, s4, d3, 1), t4.F.yx(d3, b3, r3), t4.F.yx(d3, v3, x3), x3 = t4.F.Ut(r3, x3) / (t4.F.qn(r3) * t4.F.qn(x3)), x3 *= t4.s.Mb(1, g3), e3 = Math.acos(x3) * -t4.s.Mb(1, g3), (0 < y3 && 0 < e3 || 0 > y3 && 0 > e3) && (e3 = t4.F.ca(e3 + 3.141592653589793)), a3 != null && (a3.u = c3), u3 != null && (u3.u = y3), f3 != null && (f3.u = e3);
              }
            }
        }, i4.sf = function(i5, s4, n4, h3, r3, e3, o3, a3) {
          var u3 = [0, 0, 0], f3 = [0, 0, 0], c3 = [0, 0, 0], l3 = [0, 0, 0], p3 = [0, 0, 0], v3 = [0, 0, 0], y3 = [0, 0, 0], b3 = [0, 0, 0, 0], d3 = new t4.ha(0), g3 = new t4.ha(0), w3 = new t4.ha(0), x3 = new t4.ha(0), m3 = new t4.ha(0), j3 = new t4.ha(0);
          if (o3 != null && a3 != null)
            if (t4.s.vi(s4))
              t4.$g.sf(i5, n4, h3, r3, e3, o3, a3);
            else if (t4.s.Dd(r3))
              o3 != null && (o3.u = n4), a3 != null && (a3.u = h3);
            else if (e3 = t4.F.ca(e3), 0 > r3 && (r3 = t4.s.R(r3), e3 = t4.F.ca(e3 + 3.141592653589793)), n4 = t4.F.ca(n4), h3 = t4.F.ca(h3), 1.570796326794897 < t4.s.R(h3) && (n4 = t4.F.ca(n4 + 3.141592653589793), h3 = t4.s.Mb(3.141592653589793, h3) - h3), t4.s.$(t4.s.R(h3), 1.570796326794897) || t4.s.Dd(h3) || t4.s.Dd(e3) || t4.s.$(t4.s.R(e3), 3.141592653589793))
              t4.Yk.sf(i5, s4, n4, h3, r3, e3, o3, a3);
            else {
              var M3 = Math.sqrt(1 - s4);
              for (i5 = r3 / i5, t4.F.el(1, s4, h3, 0, 0, x3, m3, j3), u3[0] = x3.u, u3[1] = m3.u, u3[2] = m3.u, y3[0] = 0, y3[1] = 0, y3[2] = -1 * s4 * t4.F.n(1, s4, h3) * Math.sin(h3), x3 = t4.F.n(1, s4, h3), m3 = t4.F.ca(1.570796326794897 - e3), j3 = Math.sin(m3), r3 = Math.cos(h3), h3 = Math.sin(h3), p3[0] = x3 * r3 - h3 * j3, p3[1] = Math.cos(m3), p3[2] = (1 - s4) * x3 * h3 + r3 * j3, 0 > e3 ? t4.F.Yq(y3, p3, u3, b3, 0) : t4.F.Yq(y3, u3, p3, b3, 0), u3 = Math.acos(b3[2] / 1), b3 = Math.atan2(-b3[1], -b3[0]), h3 = 1 - s4, m3 = 1 + (p3 = Math.tan(u3)) * p3 / h3, h3 = (-(x3 = 2 * y3[2] * p3 / h3) + (p3 = Math.sqrt(x3 * x3 - 4 * m3 * (y3[2] * y3[2] / h3 - 1)))) / (m3 *= 2), x3 = (-x3 - p3) / m3, p3 = Math.tan(u3), u3 = (h3 + x3) / 2, y3 = ((m3 = p3 * h3 + y3[2]) + (p3 * x3 + y3[2])) / 2, p3 = t4.F.ip(h3 - u3, m3 - y3), M3 = y3 / M3 * 1.570796326794897, h3 = 0; 100 > h3 && (x3 = (x3 = t4.F.w(s4, M3)) * x3 / Math.cos(M3) * (Math.sin(M3) - y3 * x3 / (1 - s4)), !t4.s.Dd(x3)); h3++)
                M3 -= x3;
              M3 = t4.F.n(1, s4, M3) * Math.cos(M3), y3 = 1 - p3 / (M3 = Math.sqrt((M3 - u3) * (M3 + u3))), y3 *= 2 - y3, v3 = Math.acos(t4.F.Ut(v3, f3) / (t4.F.qn(v3) * t4.F.qn(f3))), v3 *= t4.s.Mb(1, f3[0]), e3 = (t4.F.q(M3, y3, t4.F.Sj(y3, v3)) + i5 * t4.s.Mb(1, e3)) / t4.F.Ch(M3, y3), e3 = t4.F.ca(1.570796326794897 * e3), e3 = t4.F.Tq(y3, e3), t4.F.n(M3, y3, e3), p3 = t4.F.ca(b3 + n4), n4 = Math.cos(p3), e3 = Math.sin(p3), c3[0] = l3[0] * n4 + l3[1] * -e3, c3[1] = l3[0] * e3 + l3[1] * n4, c3[2] = l3[2], t4.F.eO(s4, c3[0], c3[1], c3[2], w3, g3, d3), o3 != null && (o3.u = g3.u), a3 != null && (a3.u = w3.u);
            }
        }, i4;
      }();
    }(Q2 || (Q2 = {})), function(t4) {
      var i4 = function() {
        function i5(i6) {
          this.Za = null, this.xt = new t4.h(), this.yt = new t4.h(), this.g = i6;
        }
        return i5.prototype.compare = function(t5, i6, s5) {
          return this.g.Hc(i6, this.xt), this.g.Hc(t5.ka(s5), this.yt), this.xt.compare(this.yt);
        }, i5;
      }(), s4 = function() {
        function i5(i6) {
          this.Cf = new t4.h(), this.Fk = new t4.h(), this.g = i6;
        }
        return i5.prototype.Fh = function(t5) {
          this.Cf.N(t5);
        }, i5.prototype.compare = function(t5, i6) {
          return this.g.Hc(t5.ka(i6), this.Fk), this.Cf.compare(this.Fk);
        }, i5;
      }(), n4 = function(t5) {
        function i5(i6) {
          var s5 = t5.call(this, i6.g, i6.ra, false) || this;
          return s5.ib = i6, s5;
        }
        return _2(i5, t5), i5.prototype.compare = function(t6, i6, s5) {
          if (this.sg)
            return -1;
          var n5 = this.ib.Rd.Ln(this.ib.Th(i6));
          t6 = t6.ka(s5);
          var h4 = this.ib.Rd.Ln(this.ib.Th(t6));
          return this.Fm = s5, this.ME(i6, n5, t6, h4);
        }, i5;
      }(t4.PC), h3 = function(t5) {
        function i5(i6) {
          var s5 = t5.call(this, i6.g, i6.ra) || this;
          return s5.ib = i6, s5;
        }
        return _2(i5, t5), i5.prototype.compare = function(t6, i6) {
          return this.sg ? -1 : (t6 = this.ib.Rd.Ln(this.ib.Th(t6.ka(i6))), this.Fm = i6, this.NE(i6, t6));
        }, i5;
      }(t4.WL), r3 = function() {
        function r4() {
          this.Nc = this.df = this.lo = this.Rd = this.nh = this.Ad = this.hb = this.g = null, this.Pg = false, this.xh = this.Pm = this.je = this.Ik = this.ph = this.Ck = this.Gf = this.ae = null, this.zh = this.Lq = this.PA = this.ra = 0, this.Zv = this.Yn = false, this.Ao = new t4.h(), this.Ri = new t4.h(), this.hb = new t4.ad(8), this.Ad = new t4.ad(5), this.nh = new t4.cu(), this.Rd = new t4.cu(), this.Pg = false, this.xh = new t4.h(), this.xh.na(0, 0), this.ra = 0, this.zh = -1, this.Yn = false, this.g = null, this.df = new t4.$j(), this.Nc = new t4.$j(), this.ph = new t4.ja(0), this.Ik = new t4.OC(), this.Gf = new t4.ja(0), this.Ck = new t4.ja(0), this.lo = new t4.Ta();
        }
        return r4.prototype.LX = function(i5, s5) {
          var n5 = new t4.Ed();
          return n5.VB(), i5.Pc(n5), this.gr(i5), this.Yn = false, this.ra = s5, this.PA = s5 * s5, s5 = this.eC(), i5.Pc(n5), s5 || (this.lQ(), s5 || this.eC()), this.zh != -1 && (this.g.Ud(this.zh), this.zh = -1), this.g = null, this.Yn;
        }, r4.prototype.PX = function(t5, i5) {
          this.gr(t5), this.Yn = false, this.ra = i5, this.PA = i5 * i5, this.Pg = false, this.eC(), this.Pg || (this.Pg = t5.Ip(i5, true, false) == 1), this.zh != -1 && (this.g.Ud(this.zh), this.zh = -1), this.g = null;
        }, r4.prototype.qg = function(t5, i5) {
          return this.hb.U(t5, 0 + i5);
        }, r4.prototype.GB = function(t5, i5, s5) {
          this.hb.T(t5, 0 + i5, s5);
        }, r4.prototype.Th = function(t5) {
          return this.hb.U(t5, 2);
        }, r4.prototype.UW = function(t5, i5) {
          this.hb.T(t5, 2, i5);
        }, r4.prototype.MF = function(t5, i5) {
          return this.hb.U(t5, 3 + i5);
        }, r4.prototype.Rp = function(t5) {
          return this.hb.U(t5, 7);
        }, r4.prototype.Rl = function(t5, i5) {
          this.hb.T(t5, 7, i5);
        }, r4.prototype.Tp = function(t5, i5) {
          return this.hb.U(t5, 3 + this.Qp(t5, i5));
        }, r4.prototype.hr = function(t5, i5, s5) {
          this.hb.T(t5, 3 + this.Qp(t5, i5), s5);
        }, r4.prototype.IR = function(t5, i5) {
          return this.hb.U(t5, 5 + this.Qp(t5, i5));
        }, r4.prototype.jr = function(t5, i5, s5) {
          this.hb.T(t5, 5 + this.Qp(t5, i5), s5);
        }, r4.prototype.Ur = function(t5) {
          return this.Ad.U(t5, 0);
        }, r4.prototype.PW = function(t5, i5) {
          this.Ad.T(t5, 0, i5);
        }, r4.prototype.$y = function(t5) {
          return this.Ad.U(t5, 4);
        }, r4.prototype.er = function(t5, i5) {
          this.Ad.T(t5, 4, i5);
        }, r4.prototype.kl = function(t5) {
          return this.Ad.U(t5, 1);
        }, r4.prototype.nn = function(t5, i5) {
          this.Ad.T(t5, 1, i5);
        }, r4.prototype.Zy = function(t5) {
          return this.Ad.U(t5, 3);
        }, r4.prototype.Ft = function(t5, i5) {
          this.Ad.T(t5, 3, i5);
        }, r4.prototype.$m = function(t5) {
          var i5 = this.Ad.De(), s5 = this.nh.Rh();
          return this.PW(i5, s5), t5 != -1 ? (this.nh.addElement(s5, t5), this.g.Sa(t5, this.zh, i5), this.er(i5, this.g.Va(t5))) : this.er(i5, -1), i5;
        }, r4.prototype.CP = function(t5) {
          this.Ad.kd(t5);
        }, r4.prototype.FD = function(t5, i5) {
          this.nh.addElement(this.Ur(t5), i5), this.g.Sa(i5, this.zh, t5);
        }, r4.prototype.ot = function(t5) {
          var i5 = this.hb.De(), s5 = this.Rd.Rh();
          return this.UW(i5, s5), t5 != -1 && this.Rd.addElement(s5, t5), i5;
        }, r4.prototype.GD = function(t5, i5) {
          this.Rd.addElement(this.Th(t5), i5);
        }, r4.prototype.Wu = function(t5) {
          this.hb.kd(t5), 0 <= (t5 = this.ph.gF(t5)) && this.ph.NV(t5);
        }, r4.prototype.jj = function(i5, s5) {
          if (this.qg(i5, 0) == -1)
            this.GB(i5, 0, s5);
          else {
            if (this.qg(i5, 1) != -1)
              throw t4.i.Ra();
            this.GB(i5, 1, s5);
          }
          this.gy(i5, s5);
        }, r4.prototype.gy = function(t5, i5) {
          var s5 = this.kl(i5);
          if (s5 != -1) {
            var n5 = this.Tp(s5, i5);
            this.jr(n5, i5, t5), this.hr(t5, i5, n5), this.hr(s5, i5, t5), this.jr(t5, i5, s5);
          } else
            this.jr(t5, i5, t5), this.hr(t5, i5, t5), this.nn(i5, t5);
        }, r4.prototype.Qp = function(t5, i5) {
          return this.qg(t5, 0) == i5 ? 0 : 1;
        }, r4.prototype.Zm = function(t5, i5) {
          var s5, n5 = this.Zy(i5);
          if (n5 != -1 && (this.df.wd(n5, -1), this.Ft(i5, -1)), (n5 = this.kl(i5)) != -1) {
            var h4 = s5 = n5;
            do {
              var r5 = false, e3 = this.Qp(s5, i5), o3 = this.MF(s5, e3);
              if (this.qg(s5, e3 + 1 & 1) == t5) {
                if (this.Zu(s5), this.Rd.eh(this.Th(s5)), this.Wu(s5), s5 == o3) {
                  n5 = -1;
                  break;
                }
                n5 == s5 && (n5 = this.kl(i5), h4 = o3, r5 = true);
              }
              s5 = o3;
            } while (s5 != h4 || r5);
            if (n5 != -1) {
              do {
                e3 = this.Qp(s5, i5), o3 = this.MF(s5, e3), this.GB(s5, e3, t5), s5 = o3;
              } while (s5 != h4);
              (s5 = this.kl(t5)) != -1 ? (h4 = this.Tp(s5, t5), r5 = this.Tp(n5, t5), h4 == s5 ? (this.nn(t5, n5), this.gy(s5, t5), this.nn(t5, s5)) : r5 == n5 && this.gy(n5, t5), this.hr(n5, t5, h4), this.jr(h4, t5, n5), this.hr(s5, t5, r5), this.jr(r5, t5, s5)) : this.nn(t5, n5);
            }
          }
          for (n5 = this.Ur(t5), s5 = this.Ur(i5), h4 = this.nh.sc(s5); h4 != -1; h4 = this.nh.lb(h4))
            this.g.Sa(this.nh.ka(h4), this.zh, t5);
          this.nh.Cy(n5, s5), this.CP(i5);
        }, r4.prototype.PT = function(t5, i5) {
          var s5 = this.qg(t5, 0), n5 = this.qg(t5, 1), h4 = this.qg(i5, 0), r5 = this.qg(i5, 1);
          this.Rd.Cy(this.Th(t5), this.Th(i5)), i5 == this.kl(s5) && this.nn(s5, t5), i5 == this.kl(n5) && this.nn(n5, t5), this.Zu(i5), this.Wu(i5), s5 == h4 && n5 == r5 || n5 == h4 && s5 == r5 || (this.Jn(s5, this.Ao), this.Jn(h4, this.Ri), this.Ao.rb(this.Ri) ? (s5 != h4 && this.Zm(s5, h4), n5 != r5 && this.Zm(n5, r5)) : (n5 != h4 && this.Zm(n5, h4), s5 != r5 && this.Zm(s5, r5)));
        }, r4.prototype.Zu = function(t5) {
          var i5 = this.qg(t5, 1);
          this.ZE(t5, this.qg(t5, 0)), this.ZE(t5, i5);
        }, r4.prototype.ZE = function(t5, i5) {
          var s5 = this.Tp(t5, i5), n5 = this.IR(t5, i5), h4 = this.kl(i5);
          s5 != t5 ? (this.hr(n5, i5, s5), this.jr(s5, i5, n5), h4 == t5 && this.nn(i5, s5)) : this.nn(i5, -1);
        }, r4.prototype.RD = function(t5, i5, s5) {
          var n5 = this.Rd.sc(t5), h4 = this.Rd.ka(n5);
          t5 = this.Ie(h4);
          var r5 = this.Ie(this.g.V(h4));
          for (this.g.lr(h4, i5, s5, true), n5 = this.Rd.lb(n5); n5 != -1; n5 = this.Rd.lb(n5)) {
            h4 = this.Rd.ka(n5);
            var e3 = this.Ie(h4) == t5;
            this.g.lr(h4, i5, s5, e3);
          }
          n5 = i5.Xp(s5, 0).bc(), i5 = i5.Xp(s5, i5.ql(s5) - 1).xc(), this.wK(t5, n5), this.wK(r5, i5);
        }, r4.prototype.UE = function(t5, i5, s5) {
          var n5 = this.Th(t5), h4 = this.qg(t5, 0), r5 = this.qg(t5, 1), e3 = this.ot(-1);
          for (this.ph.add(e3), this.Rl(e3, -3), this.Gf.add(e3), this.jj(e3, h4), t5 = 1, i5 = i5.ql(s5); t5 < i5; t5++)
            s5 = this.$m(-1), this.Ck.add(s5), this.Gf.add(s5), this.jj(e3, s5), e3 = this.ot(-1), this.ph.add(e3), this.Rl(e3, -3), this.Gf.add(e3), this.jj(e3, s5);
          for (this.jj(e3, r5), n5 = this.Rd.sc(n5); n5 != -1; n5 = this.Rd.lb(n5))
            if (r5 = this.Rd.ka(n5), this.Ie(r5) == h4) {
              t5 = 0;
              do {
                0 < t5 && (e3 = this.Gf.get(t5 - 1), this.FD(e3, r5), this.$y(e3) == -1 && this.er(e3, this.g.Va(r5))), e3 = this.Gf.get(t5), t5 += 2, this.GD(e3, r5), r5 = this.g.V(r5);
              } while (t5 < this.Gf.size);
            } else {
              t5 = this.Gf.size - 1;
              do {
                t5 < this.Gf.size - 2 && (e3 = this.Gf.get(t5 + 1), this.FD(e3, r5), 0 > this.$y(e3) && this.er(e3, this.g.Va(r5))), e3 = this.Gf.get(t5), t5 -= 2, this.GD(e3, r5), r5 = this.g.V(r5);
              } while (0 <= t5);
            }
          this.Gf.clear(false);
        }, r4.prototype.Ie = function(t5) {
          return this.g.Qa(t5, this.zh);
        }, r4.prototype.NI = function(i5, s5, n5) {
          var h4 = this.qg(s5, 0), r5 = new t4.h();
          this.Jn(h4, r5);
          var e3 = new t4.h(), o3 = this.qg(s5, 1);
          this.Jn(o3, e3);
          var a3 = n5.ql(i5), u3 = n5.Xp(i5, 0), f3 = new t4.h();
          if (u3.$p(f3), !r5.rb(f3)) {
            if (!this.Pg) {
              var c3 = r5.compare(this.xh);
              0 > c3 * (f3 = f3.compare(this.xh)) && (this.Pg = true);
            }
            this.qF(h4, this.Gf), this.Ck.add(h4);
          }
          for (!this.Pg && 1 < a3 && (c3 = r5.compare(e3), u3 = u3.xc(), (r5.compare(u3) != c3 || u3.compare(e3) != c3 || 0 > u3.compare(this.xh)) && (this.Pg = true)), i5 = (u3 = n5.Xp(i5, a3 - 1)).xc(), e3.rb(i5) || (this.Pg || 0 > (c3 = e3.compare(this.xh)) * (f3 = i5.compare(this.xh)) && (this.Pg = true), this.qF(o3, this.Gf), this.Ck.add(o3)), this.Gf.add(s5), e3 = 0, o3 = this.Gf.size; e3 < o3; e3++)
            i5 = this.Gf.get(e3), n5 = this.Rp(i5), t4.ad.GG(n5) && (this.Nc.wd(n5, -1), this.Rl(i5, -1)), i5 != s5 && this.Rp(i5) != -3 && (this.ph.add(i5), this.Rl(i5, -3));
          this.Gf.clear(false);
        }, r4.prototype.gO = function(t5, i5) {
          this.ae.compare(this.Nc, this.Nc.ka(t5), i5), this.ae.sg && (this.ae.Mr(), this.jF(t5, i5));
        }, r4.prototype.jF = function(i5, s5) {
          this.Yn = true, i5 = this.Nc.ka(i5), s5 = this.Nc.ka(s5);
          var n5 = this.Rd.Ln(this.Th(i5)), h4 = this.Rd.Ln(this.Th(s5)), r5 = this.g.cc(n5);
          r5 == null && (this.je == null && (this.je = new t4.zb()), this.g.fd(n5, this.je), r5 = this.je), (n5 = this.g.cc(h4)) == null && (this.Pm == null && (this.Pm = new t4.zb()), this.g.fd(h4, this.Pm), n5 = this.Pm), this.Ik.Qo(r5), this.Ik.Qo(n5), this.Ik.Fa(this.ra, true) && (this.Pg = true), this.cK(i5, s5, -1, this.Ik), this.Ik.clear();
        }, r4.prototype.BQ = function(i5, s5) {
          this.Yn = true, s5 = this.Nc.ka(s5);
          var n5 = this.Rd.Ln(this.Th(s5)), h4 = this.g.cc(n5);
          h4 == null && (this.je == null && (this.je = new t4.zb()), this.g.fd(n5, this.je), h4 = this.je), n5 = this.wF(i5), this.Ik.Qo(h4), this.g.Xi(n5, this.lo), this.Ik.Fz(this.ra, this.lo, true), this.cK(s5, -1, i5, this.Ik), this.Ik.clear();
        }, r4.prototype.sS = function() {
          if (this.ph.size != 0)
            for (; this.ph.size != 0; ) {
              if (this.ph.size > Math.max(100, this.g.gd)) {
                this.ph.clear(false), this.Pg = true;
                break;
              }
              var t5 = this.ph.Gc();
              this.ph.Jf(), this.Rl(t5, -1), this.RS(t5) != -1 && this.rS(t5), this.Xn = false;
            }
        }, r4.prototype.rS = function(t5) {
          if (this.Xn) {
            var i5 = this.Nc.Bu(this.HH, this.BH, t5, true);
            this.Xn = false;
          } else
            i5 = this.Nc.ED(t5);
          i5 == -1 ? this.PT(this.Nc.ka(this.Nc.AF()), t5) : (this.Rl(t5, i5), this.ae.sg && (this.ae.Mr(), this.jF(this.ae.Fm, i5)));
        }, r4.prototype.RS = function(i5) {
          var s5 = this.qg(i5, 0);
          if (i5 = this.qg(i5, 1), this.Jn(s5, this.Ao), this.Jn(i5, this.Ri), t4.h.zc(this.Ao, this.Ri) <= this.PA)
            return this.Pg = true, -1;
          var n5 = this.Ao.compare(this.xh), h4 = this.Ri.compare(this.xh);
          return 0 >= n5 && 0 < h4 ? i5 : 0 >= h4 && 0 < n5 ? s5 : -1;
        }, r4.prototype.jQ = function() {
          var i5 = new t4.ja(0);
          i5.Jb(this.g.gd);
          for (var s5 = this.g.$q(), n5 = s5.next(); n5 != -1; n5 = s5.next())
            this.g.Qa(n5, this.zh) != -1 && i5.add(n5);
          this.g.nx(i5, i5.size), this.kQ(i5);
        }, r4.prototype.kQ = function(s5) {
          this.df.clear(), this.df.Ee(s5.size), this.df.Xo(new i4(this.g));
          var n5 = new t4.h();
          n5.Sc();
          for (var h4 = -1, r5 = new t4.h(), e3 = 0, o3 = s5.size; e3 < o3; e3++) {
            var a3 = s5.get(e3);
            this.g.Hc(a3, r5), r5.rb(n5) ? (a3 = this.g.Qa(a3, this.zh), this.Zm(h4, a3)) : (h4 = this.Ie(a3), this.g.Hc(a3, n5), a3 = this.df.zn(a3), this.Ft(h4, a3));
          }
        }, r4.prototype.lQ = function() {
          var i5 = new t4.ja(0);
          i5.Jb(this.g.gd);
          for (var s5 = this.df.sc(-1); s5 != -1; s5 = this.df.lb(s5))
            i5.add(this.df.ka(s5));
          this.df.clear(), this.g.nx(i5, i5.size), s5 = 0;
          for (var n5 = i5.size; s5 < n5; s5++) {
            var h4 = i5.get(s5), r5 = this.Ie(h4);
            h4 = this.df.zn(h4), this.Ft(r5, h4);
          }
        }, r4.prototype.qF = function(i5, s5) {
          var n5 = this.kl(i5);
          if (n5 != -1) {
            var h4 = n5;
            do {
              t4.ad.GG(this.Rp(h4)) && s5.add(h4), h4 = this.Tp(h4, i5);
            } while (h4 != n5);
          }
        }, r4.prototype.wK = function(t5, i5) {
          for (t5 = this.nh.sc(this.Ur(t5)); t5 != -1; t5 = this.nh.lb(t5))
            this.g.mf(this.nh.ka(t5), i5);
        }, r4.prototype.cK = function(t5, i5, s5, n5) {
          this.Zu(t5), i5 != -1 && this.Zu(i5), this.NI(0, t5, n5), i5 != -1 && this.NI(1, i5, n5), s5 != -1 && (n5.Cf.D(this.Ao), this.Jn(s5, this.Ri), this.Ri.rb(this.Ao) || this.Ck.add(s5)), s5 = 0;
          for (var h4 = this.Ck.size; s5 < h4; s5++) {
            var r5 = this.Ck.get(s5), e3 = this.Zy(r5);
            e3 != -1 && (this.df.wd(e3, -1), this.Ft(r5, -1));
          }
          for (s5 = this.Th(t5), h4 = i5 != -1 ? this.Th(i5) : -1, this.RD(s5, n5, 0), i5 != -1 && this.RD(h4, n5, 1), this.UE(t5, n5, 0), i5 != -1 && this.UE(i5, n5, 1), this.Rd.eh(s5), this.Wu(t5), i5 != -1 && (this.Rd.eh(h4), this.Wu(i5)), s5 = 0, h4 = this.Ck.size; s5 < h4; s5++)
            (r5 = this.Ck.get(s5)) == this.Lq && (this.Zv = true), (e3 = this.Zy(r5)) == -1 && ((e3 = this.df.ED(this.wF(r5))) == -1 ? (t5 = this.Ie(this.df.ka(this.df.AF())), this.Zm(t5, r5)) : this.Ft(r5, e3));
          this.Ck.clear(false);
        }, r4.prototype.Jn = function(t5, i5) {
          this.g.ZF(this.$y(t5), i5);
        }, r4.prototype.wF = function(t5) {
          return this.nh.Ln(this.Ur(t5));
        }, r4.prototype.eC = function() {
          this.Zv = false, this.Lq = -1, this.ae == null && (this.Nc.Tv = false, this.ae = new n4(this), this.Nc.ao = this.ae);
          var i5 = new t4.ja(0), r5 = null, e3 = null;
          this.BH = this.HH = -1, this.Xn = false;
          for (var o3 = this.df.sc(-1); o3 != -1; ) {
            this.Xn = false;
            var a3 = this.df.ka(o3);
            this.Lq = this.Ie(a3), this.g.Hc(a3, this.xh), this.ae.VJ(this.xh.y, this.xh.x);
            var u3 = this.kl(this.Lq), f3 = u3 == -1;
            if (!f3) {
              a3 = u3;
              do {
                var c3 = this.Rp(a3);
                c3 == -1 ? (this.ph.add(a3), this.Rl(a3, -3)) : c3 != -3 && i5.add(c3), a3 = this.Tp(a3, this.Lq);
              } while (a3 != u3);
            }
            if (0 < i5.size) {
              for (this.Xn = i5.size == 1 && this.ph.size == 1, f3 = 0, u3 = i5.size; f3 < u3; f3++)
                a3 = this.Nc.ka(i5.get(f3)), this.Rl(a3, -2);
              var l3 = -2, p3 = -2;
              for (f3 = 0, u3 = i5.size; f3 < u3; f3++) {
                if (c3 = i5.get(f3), l3 == -2) {
                  var v3 = this.Nc.xe(c3);
                  v3 != -1 ? (a3 = this.Nc.ka(v3), (a3 = this.Rp(a3)) != -2 && (l3 = v3)) : l3 = -1;
                }
                if (p3 == -2 && ((c3 = this.Nc.lb(c3)) != -1 ? (a3 = this.Nc.ka(c3), (a3 = this.Rp(a3)) != -2 && (p3 = c3)) : p3 = -1), l3 != -2 && p3 != -2)
                  break;
              }
              for (f3 = 0, u3 = i5.size; f3 < u3; f3++)
                c3 = i5.get(f3), a3 = this.Nc.ka(c3), this.Nc.wd(c3, -1), this.Rl(a3, -1);
              i5.clear(false), this.HH = l3 != -1 ? l3 : -1, this.BH = p3 != -1 ? p3 : -1, l3 != -1 && p3 != -1 ? this.Xn || this.gO(l3, p3) : l3 == -1 && p3 == -1 && (this.Xn = false);
            } else
              f3 && (r5 == null && (r5 = new h3(this)), r5.Fh(this.xh), this.Nc.pJ(r5), r5.sg && (r5.Mr(), this.BQ(this.Lq, r5.Fm)));
            this.sS(), this.Zv ? (this.Zv = false, e3 == null && (e3 = new s4(this.g)), e3.Fh(this.xh), o3 = this.df.pJ(e3)) : o3 = this.df.lb(o3);
          }
          return this.Yn;
        }, r4.prototype.gr = function(i5) {
          for (this.g = i5, this.zh = this.g.Hd(), this.hb.Ee(i5.gd + 32), this.Ad.Ee(i5.gd), this.nh.Bt(i5.gd), this.nh.hn(i5.gd), this.Rd.Bt(i5.gd + 32), this.Rd.hn(i5.gd + 32), i5 = this.g.md; i5 != -1; i5 = this.g.ve(i5))
            if (t4.ba.Ic(this.g.jc(i5)))
              for (a3 = this.g.Ob(i5); a3 != -1; a3 = this.g.Sb(a3)) {
                var s5 = this.g.Ka(a3), n5 = this.g.Ya(a3), h4 = this.$m(n5), r5 = this.ot(n5);
                for (this.jj(r5, h4), u3 = this.g.V(n5), n5 = 0, s5 -= 2; n5 < s5; n5++) {
                  var e3 = this.g.V(u3), o3 = this.$m(u3);
                  this.jj(r5, o3), r5 = this.ot(u3), this.jj(r5, o3), u3 = e3;
                }
                this.g.ec(a3) ? (o3 = this.$m(u3), this.jj(r5, o3), r5 = this.ot(u3), this.jj(r5, o3), this.jj(r5, h4)) : (o3 = this.$m(u3), this.jj(r5, o3));
              }
            else
              for (var a3 = this.g.Ob(i5); a3 != -1; a3 = this.g.Sb(a3)) {
                var u3 = this.g.Ya(a3);
                for (h4 = 0, s5 = this.g.Ka(a3); h4 < s5; h4++)
                  this.$m(u3), u3 = this.g.V(u3);
              }
          this.jQ();
        }, r4;
      }();
      t4.MC = r3;
    }(Q2 || (Q2 = {})), function(t4) {
      var i4 = function(i5) {
        function s4(n4, h3, r3) {
          var e3 = i5.call(this) || this;
          if (n4 !== void 0)
            if (r3 !== void 0) {
              e3.description = t4.fe.pg();
              var o3 = new t4.Od();
              o3.L(n4, h3, r3), e3.ZB(o3);
            } else if (h3 !== void 0)
              e3.description = t4.fe.pg(), e3.Db(n4, h3);
            else if (n4 instanceof t4.sa)
              e3.description = n4;
            else if (n4 instanceof t4.h)
              e3.description = t4.fe.pg(), e3.Db(n4);
            else {
              if (!(n4 instanceof s4))
                throw t4.i.O();
              e3.description = n4.description, e3.Db(n4.Ng(), n4.kh()), n4.la !== null && (e3.la = n4.la.slice(0));
            }
          else
            e3.description = t4.fe.pg();
          return e3;
        }
        return _2(s4, i5), s4.prototype.D = function(i6) {
          if (i6 === void 0) {
            if (this.Bc())
              throw t4.i.ga("This operation should not be performed on an empty geometry.");
            return (i6 = new t4.h()).na(this.la[0], this.la[1]), i6;
          }
          if (this.Bc())
            throw t4.i.ga("This operation should not be performed on an empty geometry.");
          i6.na(this.la[0], this.la[1]);
        }, s4.prototype.Db = function(t5, i6) {
          typeof t5 == "number" ? (this.wc(), this.la == null && this.wn(), this.la[0] = t5, this.la[1] = i6) : (this.wc(), this.Db(t5.x, t5.y));
        }, s4.prototype.xz = function() {
          if (this.Bc())
            throw t4.i.ga("This operation should not be performed on an empty geometry.");
          var i6 = new t4.Od();
          return i6.x = this.la[0], i6.y = this.la[1], i6.z = this.description.dG() ? this.la[2] : t4.sa.te(1), i6;
        }, s4.prototype.ZB = function(i6) {
          this.wc();
          var s5 = this.hasAttribute(1);
          s5 || t4.sa.yG(1, i6.z) || (this.se(1), s5 = true), this.la == null && this.wn(), this.la[0] = i6.x, this.la[1] = i6.y, s5 && (this.la[2] = i6.z);
        }, s4.prototype.Ng = function() {
          if (this.Bc())
            throw t4.i.ga("This operation should not be performed on an empty geometry.");
          return this.la[0];
        }, s4.prototype.YB = function(t5) {
          this.setAttribute(0, 0, t5);
        }, s4.prototype.kh = function() {
          if (this.Bc())
            throw t4.i.ga("This operation should not be performed on an empty geometry.");
          return this.la[1];
        }, s4.prototype.WJ = function(t5) {
          this.setAttribute(0, 1, t5);
        }, s4.prototype.XR = function() {
          return this.Vc(1, 0);
        }, s4.prototype.sX = function(t5) {
          this.setAttribute(1, 0, t5);
        }, s4.prototype.uR = function() {
          return this.Vc(2, 0);
        }, s4.prototype.cX = function(t5) {
          this.setAttribute(2, 0, t5);
        }, s4.prototype.Fc = function() {
          return this.tF(3, 0);
        }, s4.prototype.GJ = function(t5) {
          this.setAttribute(3, 0, t5);
        }, s4.prototype.Vc = function(i6, s5) {
          var n4 = this.description.Rf(i6);
          return 0 <= n4 ? this.la[this.description.bk(n4) + s5] : t4.sa.te(i6);
        }, s4.prototype.tF = function(i6, s5) {
          var n4 = this.description.Rf(i6);
          return 0 <= n4 ? this.la[this.description.bk(n4) + s5] : t4.sa.te(i6);
        }, s4.prototype.setAttribute = function(t5, i6, s5) {
          this.wc();
          var n4 = this.description.Rf(t5);
          0 > n4 && (this.se(t5), n4 = this.description.Rf(t5)), this.la == null && this.wn(), this.la[this.description.bk(n4) + i6] = s5;
        }, s4.prototype.K = function() {
          return 33;
        }, s4.prototype.Eb = function() {
          return 0;
        }, s4.prototype.Pa = function() {
          this.wc(), this.la != null && (this.la[0] = NaN, this.la[1] = NaN);
        }, s4.prototype.un = function(i6) {
          if (this.la != null) {
            for (var s5 = t4.fe.Kw(i6, this.description), n4 = [], h3 = 0, r3 = 0, e3 = i6.Ba; r3 < e3; r3++) {
              var o3 = i6.ld(r3), a3 = t4.sa.Wa(o3);
              if (s5[r3] == -1) {
                var u3 = t4.sa.te(o3);
                for (o3 = 0; o3 < a3; o3++)
                  n4[h3] = u3, h3++;
              } else
                for (u3 = this.description.bk(s5[r3]), o3 = 0; o3 < a3; o3++)
                  n4[h3] = this.la[u3], h3++, u3++;
            }
            this.la = n4;
          }
          this.description = i6;
        }, s4.prototype.wn = function() {
          this.gJ(this.description.Be.length), s4.YD(this.description.Be, this.la, this.description.Be.length), this.la[0] = NaN, this.la[1] = NaN;
        }, s4.prototype.Pc = function(i6) {
          if (i6 instanceof t4.Ed) {
            if (!this.Bc()) {
              var s5 = this.D();
              i6.Gh(s5, s5), this.Db(s5);
            }
          } else
            this.Bc() || (this.se(1), s5 = this.xz(), this.ZB(i6.hp(s5)));
        }, s4.prototype.copyTo = function(i6) {
          if (i6.K() != 33)
            throw t4.i.O();
          i6.wc(), this.la == null ? (i6.Pa(), i6.la = null, i6.Pf(this.description)) : (i6.Pf(this.description), i6.gJ(this.description.Be.length), s4.YD(this.la, i6.la, this.description.Be.length));
        }, s4.prototype.Ja = function() {
          return new s4(this.description);
        }, s4.prototype.B = function() {
          return this.Bc();
        }, s4.prototype.Bc = function() {
          return this.la == null || isNaN(this.la[0]) || isNaN(this.la[1]);
        }, s4.prototype.dn = function(t5) {
          t5.Pa(), this.description != t5.description && t5.Pf(this.description), t5.$b(this);
        }, s4.prototype.A = function(t5) {
          this.Bc() ? t5.Pa() : (t5.v = this.la[0], t5.G = this.la[1], t5.C = this.la[0], t5.H = this.la[1]);
        }, s4.prototype.So = function(t5) {
          if (this.Bc())
            t5.Pa();
          else {
            var i6 = this.xz();
            t5.v = i6.x, t5.G = i6.y, t5.Xe = i6.z, t5.C = i6.x, t5.H = i6.y, t5.Dg = i6.z;
          }
        }, s4.prototype.Vg = function(i6, s5) {
          var n4 = new t4.Oc();
          return this.Bc() ? (n4.Pa(), n4) : (i6 = this.Vc(i6, s5), n4.pa = i6, n4.wa = i6, n4);
        }, s4.prototype.gJ = function(i6) {
          if (this.la == null)
            this.la = t4.P.mg(i6);
          else if (this.la.length < i6) {
            for (var s5 = this.la.slice(0), n4 = this.la.length; n4 < i6; n4++)
              s5[n4] = 0;
            this.la = s5;
          }
        }, s4.YD = function(t5, i6, s5) {
          if (0 < s5)
            for (s5 = 0; s5 < t5.length; s5++)
              i6[s5] = t5[s5];
        }, s4.prototype.Nb = function(t5) {
          if (t5 == this)
            return true;
          if (!(t5 instanceof s4) || this.description != t5.description)
            return false;
          if (this.Bc())
            return !!t5.Bc();
          for (var i6 = 0, n4 = this.description.Be.length; i6 < n4; i6++)
            if (this.la[i6] != t5.la[i6])
              return false;
          return true;
        }, s4.prototype.dc = function() {
          var i6 = this.description.dc();
          if (!this.Bc())
            for (var s5 = 0, n4 = this.description.Be.length; s5 < n4; s5++) {
              var h3 = this.la[s5];
              h3 = t4.P.truncate(h3 ^ h3 >>> 32), i6 = t4.P.Vh(h3, i6);
            }
          return i6;
        }, s4.prototype.ng = function() {
          return null;
        }, s4;
      }(t4.ba);
      t4.Ta = i4;
    }(Q2 || (Q2 = {})), function(t4) {
      var i4 = function() {
        function t5(t6, i5, s4) {
          t6 !== void 0 && (this.x = t6, this.y = i5, this.z = s4);
        }
        return t5.construct = function(i5, s4, n4) {
          var h3 = new t5();
          return h3.x = i5, h3.y = s4, h3.z = n4, h3;
        }, t5.prototype.L = function(t6, i5, s4) {
          this.x = t6, this.y = i5, this.z = s4;
        }, t5.prototype.lx = function() {
          this.z = this.y = this.x = 0;
        }, t5.prototype.normalize = function() {
          var t6 = this.length();
          t6 == 0 && (this.x /= t6, this.y /= t6, this.z /= t6);
        }, t5.prototype.length = function() {
          return Math.sqrt(this.x * this.x + this.y * this.y + this.z * this.z);
        }, t5.prototype.sub = function(i5) {
          return new t5(this.x - i5.x, this.y - i5.y, this.z - i5.z);
        }, t5.prototype.Bg = function(i5) {
          new t5(this.x * i5, this.y * i5, this.z * i5);
        }, t5.prototype.Sh = function(t6) {
          return this.x * t6.x + this.y * t6.y + this.z * t6.z;
        }, t5;
      }();
      t4.Od = i4;
    }(Q2 || (Q2 = {})), function(t4) {
      var i4 = function() {
        function i5(t5, i6, s4) {
          this.Iw = this.yA = null, this.Zf = i6, this.AT = i6.y - s4, this.zT = i6.y + s4, this.Gw = 0, this.Zz = t5, this.ra = s4, this.MT = s4 * s4, this.$z = s4 != 0, this.Nv = false;
        }
        return i5.prototype.result = function() {
          return this.Gw != 0 ? 1 : 0;
        }, i5.prototype.UM = function(i6) {
          return i6 = i6.ic(i6.ge(this.Zf, false)), t4.h.zc(i6, this.Zf) <= this.MT;
        }, i5.prototype.aF = function(t5) {
          if (!this.$z && (this.Zz && this.Zf.rb(t5.bc()) || this.Zf.rb(t5.xc())))
            this.Nv = true;
          else if (t5.oa == this.Zf.y && t5.oa == t5.ma) {
            if (this.Zz && !this.$z) {
              var i6 = Math.max(t5.ta, t5.qa);
              this.Zf.x > Math.min(t5.ta, t5.qa) && this.Zf.x < i6 && (this.Nv = true);
            }
          } else {
            var s4 = false;
            if (i6 = Math.max(t5.ta, t5.qa), this.Zf.x > i6 ? s4 = true : this.Zf.x >= Math.min(t5.ta, t5.qa) && (s4 = 0 < t5.fq(true, this.Zf.y, this.Iw, null) && this.Iw[0] <= this.Zf.x), s4) {
              if (this.Zf.y == t5.bc().y) {
                if (this.Zf.y < t5.xc().y)
                  return;
              } else if (this.Zf.y == t5.xc().y && this.Zf.y < t5.bc().y)
                return;
              this.Gw = this.Zz ? 1 ^ this.Gw : this.Gw + (t5.bc().y > t5.xc().y ? 1 : -1);
            }
          }
        }, i5.prototype.MI = function(t5) {
          var i6 = t5.Vg(0, 1);
          if (i6.pa > this.zT || i6.wa < this.AT)
            return false;
          if (this.$z && this.UM(t5))
            return true;
          if (i6.pa > this.Zf.y || i6.wa < this.Zf.y)
            return false;
          if (this.yA == null && (this.yA = [null, null, null, null, null]), this.Iw == null && (this.Iw = [0, 0, 0]), 0 < (i6 = t5.$F()))
            for (t5 = 0; t5 < i6; t5++) {
              var s4 = this.yA[t5].get();
              if (this.aF(s4), this.Nv)
                return true;
            }
          else if (this.aF(t5), this.Nv)
            return true;
          return false;
        }, i5.KM = function(t5, s4, n4) {
          for (s4 = new i5(t5.Kn() == 0, s4, n4), t5 = t5.Ha(); t5.ab(); )
            for (; t5.Ia(); )
              if (n4 = t5.ia(), s4.MI(n4))
                return -1;
          return s4.result();
        }, i5.LM = function(s4, n4, h3, r3) {
          var e3 = new t4.l();
          s4.yc(e3), e3.X(r3, r3);
          var o3 = new i5(s4.Kn() == 0, h3, r3);
          s4 = s4.Ha();
          var a3 = new t4.l();
          for (a3.L(e3), a3.C = h3.x + r3, a3.G = h3.y - r3, a3.H = h3.y + r3, r3 = (h3 = n4.HF(a3, r3)).next(); r3 != -1; r3 = h3.next())
            if (s4.Wb(n4.ka(r3)), s4.Ia() && (r3 = s4.ia(), o3.MI(r3)))
              return -1;
          return o3.result();
        }, i5.ym = function(s4, n4, h3) {
          if (s4.B())
            return 0;
          var r3 = new t4.l();
          if (s4.yc(r3), r3.X(h3, h3), !r3.contains(n4))
            return 0;
          if ((r3 = s4.Cb) != null) {
            var e3 = r3.Hk;
            if (e3 != null) {
              if ((e3 = e3.Uo(n4.x, n4.y)) == 1)
                return 1;
              if (e3 == 0)
                return 0;
            }
            if ((r3 = r3.Gb) != null)
              return i5.LM(s4, r3, n4, h3);
          }
          return i5.KM(s4, n4, h3);
        }, i5.XS = function(t5, s4, n4) {
          return s4.B() ? 0 : i5.ym(t5, s4.D(), n4);
        }, i5.Ol = function(t5, i6) {
          return !(16 > (t5 = t5.I())) && 2 * t5 + Math.log(t5) / Math.log(2) * i6 < 1 * t5 * i6;
        }, i5;
      }();
      t4.Fg = i4;
    }(Q2 || (Q2 = {})), function(t4) {
      var i4 = function(t5) {
        function i5(i6) {
          return t5.call(this, true, i6) || this;
        }
        return _2(i5, t5), i5.prototype.Ja = function() {
          return new i5(this.description);
        }, i5.prototype.Eb = function() {
          return 2;
        }, i5.prototype.K = function() {
          return 1736;
        }, i5.prototype.sG = function(t6, i6, s4) {
          this.ES(t6, i6, s4);
        }, i5.prototype.kR = function() {
          this.AR();
        }, i5;
      }(t4.Xk);
      t4.Ea = i4;
    }(Q2 || (Q2 = {})), function(t4) {
      !function(t5) {
        t5[t5.PiPOutside = 0] = "PiPOutside", t5[t5.PiPInside = 1] = "PiPInside", t5[t5.PiPBoundary = 2] = "PiPBoundary";
      }(t4.ML || (t4.ML = {})), t4.jd = function() {
        function i4() {
        }
        return i4.FG = function(i5, s4, n4) {
          return (i5 = t4.Fg.XS(i5, s4, n4)) == 0 ? 0 : i5 == 1 ? 1 : 2;
        }, i4.Zd = function(i5, s4, n4) {
          return (i5 = t4.Fg.ym(i5, s4, n4)) == 0 ? 0 : i5 == 1 ? 1 : 2;
        }, i4.SX = function(s4, n4, h3, r3, e3) {
          if (n4.length < h3 || e3.length < h3)
            throw t4.i.O();
          for (var o3 = 0; o3 < h3; o3++)
            e3[o3] = i4.Zd(s4, n4[o3], r3);
        }, i4.nK = function(s4, n4, h3, r3, e3) {
          if (s4.K() == 1736)
            i4.SX(s4, n4, h3, r3, e3);
          else {
            if (s4.K() != 197)
              throw t4.i.ga("invalid_call");
            var o3 = new t4.l();
            s4.A(o3), i4.VM(o3, n4, h3, r3, e3);
          }
        }, i4.VM = function(i5, s4, n4, h3, r3) {
          if (s4.length < n4 || r3.length < n4)
            throw t4.i.O();
          if (i5.B())
            for (h3 = 0; h3 < n4; h3++)
              r3[h3] = 0;
          else
            for (i5.X(0.5 * -h3, 0.5 * -h3), i5.X(0.5 * h3, 0.5 * h3), h3 = 0; h3 < n4; h3++)
              i5.contains(s4[h3]) ? r3[h3] = 1 : i5.contains(s4[h3]) ? r3[h3] = 2 : r3[h3] = 0;
        }, i4.UX = function(t5, i5, s4, n4, h3) {
          for (var r3 = 0; r3 < s4; r3++)
            h3[r3] = t5.ss(i5[r3], n4) ? 2 : 0;
        }, i4.TX = function(t5, i5, s4, n4, h3) {
          var r3 = t5.Cb, e3 = null;
          r3 != null && (e3 = r3.Hk), r3 = s4;
          for (var o3 = 0; o3 < s4; o3++)
            if (h3[o3] = 1, e3 != null) {
              var a3 = i5[o3];
              e3.Uo(a3.x, a3.y) == 0 && (h3[o3] = 0, r3--);
            }
          if (r3 != 0)
            for (t5 = t5.Ha(); t5.ab() && r3 != 0; )
              for (; t5.Ia() && r3 != 0; )
                for (e3 = t5.ia(), o3 = 0; o3 < s4 && r3 != 0; o3++)
                  h3[o3] == 1 && e3.ss(i5[o3], n4) && (h3[o3] = 2, r3--);
          for (o3 = 0; o3 < s4; o3++)
            h3[o3] == 1 && (h3[o3] = 0);
        }, i4.oK = function(s4, n4, h3, r3, e3) {
          var o3 = s4.K();
          if (o3 == 1607)
            i4.TX(s4, n4, h3, r3, e3);
          else {
            if (!t4.ba.zd(o3))
              throw t4.i.ga("Invalid call.");
            i4.UX(s4, n4, h3, r3, e3);
          }
        }, i4;
      }();
    }(Q2 || (Q2 = {})), function(t4) {
      var i4 = function(t5) {
        function i5(i6, s4) {
          if (arguments.length == 2) {
            var n4 = t5.call(this, false, i6.description) || this;
            n4.nf(i6), n4.lineTo(s4);
          } else
            n4 = t5.call(this, false, i6) || this;
          return n4;
        }
        return _2(i5, t5), i5.prototype.Ja = function() {
          return new i5(this.description);
        }, i5.prototype.Eb = function() {
          return 1;
        }, i5.prototype.K = function() {
          return 1607;
        }, i5.prototype.sG = function(t6, i6, s4) {
          this.FS(t6, i6, s4);
        }, i5;
      }(t4.Xk);
      t4.Ua = i4;
    }(Q2 || (Q2 = {})), function(t4) {
      var i4 = function() {
        function i5() {
        }
        return i5.prototype.progress = function() {
          return true;
        }, i5.Bp = function(i6) {
          if (i6 != null && !i6.progress(-1, -1))
            throw t4.i.RC();
        }, i5;
      }();
      t4.op = i4;
    }(Q2 || (Q2 = {})), function(t4) {
      var i4;
      (i4 = t4.KK || (t4.KK = {}))[i4.clipWithInputHorizon = 1] = "clipWithInputHorizon", i4[i4.clipWithOutputHorizon = 2] = "clipWithOutputHorizon";
      var s4 = function() {
        function t5() {
          this.Mg = 3, this.Xu = this.Lr = NaN;
        }
        return t5.prototype.KW = function(t6) {
          this.LB(1, t6);
        }, t5.prototype.LW = function(t6) {
          this.LB(2, t6);
        }, t5.prototype.cS = function() {
          return this.ks(1);
        }, t5.prototype.dS = function() {
          return this.ks(2);
        }, t5.prototype.LB = function(t6, i5) {
          this.Mg = i5 ? this.Mg | t6 : this.Mg & ~t6;
        }, t5.prototype.ks = function(t6) {
          return (this.Mg & t6) != 0;
        }, t5.prototype.Qf = function() {
          var i5 = new t5();
          return i5.Lr = this.Lr, i5.Xu = this.Xu, i5.Mg = this.Mg, i5;
        }, t5;
      }();
      t4.tC = s4, function(t5) {
        t5[t5.Dont_Geonomalize_Polygon = 2147483648] = "Dont_Geonomalize_Polygon", t5[t5.Dont_Adjust_At_Poles = 1073741824] = "Dont_Adjust_At_Poles";
      }(t4.LK || (t4.LK = {}));
      var n4 = function() {
        function t5() {
          this.Mg = 0;
        }
        return t5.prototype.LB = function(t6, i5) {
          this.Mg = i5 ? this.Mg | t6 : this.Mg & ~t6;
        }, t5.prototype.ks = function(t6) {
          return (this.Mg & t6) != 0;
        }, t5.kg = function(i5) {
          var s5 = new t5();
          return s5.Mg = i5.Mg, s5;
        }, t5.prototype.hM = function(t6) {
          this.Mg = t6.Mg;
        }, t5;
      }();
      t4.wY = n4;
      var h3 = function() {
        function i5(i6, s5, n5) {
          this.ef = i6, this.$f = s5, this.Wf = new t4.l(), this.Wf.L(n5), this.vT = i6.dc() + s5.dc() + this.Wf.dc().toString();
        }
        return i5.prototype.dc = function() {
          return this.vT;
        }, i5.prototype.Nb = function(t5) {
          return this == t5 || this.ef.Nb(t5.ef) && this.$f.Nb(t5.$f) && this.Wf.Nb(t5.Wf);
        }, i5;
      }();
      t4.BY = h3, h3 = function() {
        function i5() {
          this.$f = this.ef = null, this.mH = new s4(), this.nH = new n4(), this.yw = this.Yf = null, this.ow = this.Vn = true;
        }
        return i5.Pr = function(t5, s5, n5, h4) {
          var r3;
          h4 === void 0 && (h4 = null), r3 === void 0 && (r3 = null);
          var e3 = new i5();
          return e3.sp(t5, s5, n5, h4, r3), e3;
        }, i5.prototype.sp = function(i6, s5, n5, h4, r3) {
          if (i6 == null || s5 == null)
            throw t4.i.ga("invalidArgument");
          if (this.ef = i6, this.$f = s5, this.ow = this.Vn = false, h4 != null && (this.mH = h4.Qf()), r3 != null && this.nH.hM(r3), r3 = false, s5.Tb() == 1 && h4 != null && (h4 = h4.Lr, isNaN(h4) || h4 == 0 || (r3 = true)), i6 == s5)
            this.Vn = !r3, this.ow = true;
          else {
            h4 = i6.Tb();
            var e3 = s5.Tb();
            if (h4 == 0 || e3 == 0) {
              if (n5 != null)
                throw t4.i.O();
              i6.Id() != null && s5.Id() != null && (this.Vn = i6.Id().Nb(s5.Id()));
            } else
              h4 == 3 || e3 == 3 ? this.Vn = i6.Nb(s5) : this.ef.fS(this.$f) ? this.Vn = !r3 : this.Vn = false, this.Yf = n5, this.Yf != null && this.Yf.ix(), this.ow = (this.Yf == null || this.Yf.count() == 0) && this.ef.tc().Nb(this.$f.tc());
          }
          this.kY();
        }, i5.prototype.isIdentity = function() {
          return this.Vn;
        }, i5.prototype.iR = function() {
          return this.mH.Qf();
        }, i5.prototype.Nb = function(t5) {
          return t5 == this || !!(t5 instanceof i5 && this.ef.Nb(t5.ef) && this.$f.Nb(t5.$f)) && (this.Yf == t5.Yf || !(this.Yf == null || t5.Yf == null || !this.Yf.Nb(t5.Yf)));
        }, i5.prototype.kY = function() {
          this.yw = new t4.du(this);
        }, i5;
      }(), t4.xr = h3;
    }(Q2 || (Q2 = {})), function(t4) {
      var i4 = function() {
        function i5() {
        }
        return i5.Ep = function(t5) {
          return t5 * i5.jW;
        }, i5.mx = function(t5, s4) {
          return i5.bP(s4 - t5);
        }, i5.cP = function(i6) {
          return -360 <= i6 && 720 > i6 ? (0 > i6 ? i6 += 360 : 360 <= i6 && (i6 -= 360), i6) : (0 > (i6 = t4.mc.MK(i6)) && (i6 += 360), i6);
        }, i5.bP = function(t5) {
          return 180 < (t5 = i5.cP(t5)) && (t5 -= 360), t5;
        }, i5.jW = 57.29577951308232, i5;
      }();
      t4.sr = i4, t4.Jh = function() {
        function s4() {
        }
        return s4.nj = function(i5, s5) {
          var n4 = new t4.l();
          i5.A(n4);
          var h3 = t4.cb.ih(s5), r3 = new t4.l();
          return r3.L(h3), r3.v = n4.v, r3.C = n4.C, r3.X(0.01 * r3.da(), 0), s5 = t4.ua.Xd(s5, n4, false), r3.contains(n4) ? i5 : t4.Vd.clip(i5, r3, s5, 0);
        }, s4.ms = function(i5, n4, h3, r3, e3) {
          if (!t4.cb.Xc(n4))
            throw t4.i.O();
          var o3 = t4.ua.mj(n4, i5, false), a3 = t4.cb.ih(n4), u3 = t4.cb.tc(n4), f3 = u3.Id().ci, c3 = t4.cb.xv(u3);
          u3 = t4.cb.gv(u3), c3 *= 2 - c3;
          var l3 = new t4.Oc();
          a3.en(l3);
          var p3 = [[0, 0], [0, 0]];
          if (t4.Gg.Tb(n4) == 2 ? r3 ? (p3[0][0] = s4.an(e3, l3), p3[0][1] = a3.Lp(), t4.cb.wt(), a3 = p3[0][0] * f3) : (p3[0][0] = a3.ik(), p3[0][1] = e3, t4.cb.wt(), a3 = p3[0][1] * f3) : a3 = e3 * f3, !r3 && a3 != 0)
            throw t4.i.O();
          var v3 = new t4.ha(), y3 = new t4.hd();
          i5 = y3.Ib(i5);
          for (var b3 = [0], d3 = new t4.h(), g3 = new t4.h(), w3 = new t4.h(), x3 = new t4.h(), m3 = new t4.h(), j3 = new t4.h(), M3 = y3.Ob(i5); M3 != -1; M3 = y3.Sb(M3)) {
            var k3 = y3.Ya(M3);
            y3.D(k3, w3);
            for (var z3 = false, A3 = k3 = y3.V(k3); A3 != -1; A3 = y3.V(A3)) {
              if (A3 == k3) {
                if (z3)
                  break;
                z3 = true;
              }
              if (y3.D(A3, x3), r3 && o3 < e3 - w3.x && x3.x - e3 > o3 || o3 < e3 - x3.x && w3.x - e3 > o3 || !r3 && o3 < -w3.y && x3.y > o3 || o3 < -x3.y && w3.y > o3)
                do {
                  if (!(Math.abs(w3.x - x3.x) >= 0.5 * l3.S())) {
                    if (t4.Gg.Tb(n4) == 2 ? (p3[0][0] = s4.an(w3.x, l3), p3[0][1] = w3.y, p3[1][0] = s4.an(x3.x, l3), p3[1][1] = x3.y, t4.cb.ZV(), m3.x = p3[0][0] * f3, m3.y = p3[0][1] * f3, j3.x = p3[1][0] * f3, j3.y = p3[1][1] * f3) : (m3.x = w3.x * f3, m3.y = w3.y * f3, j3.x = x3.x * f3, j3.y = x3.y * f3), j3.x = 6.283185307179586 * (x3.x - w3.x) / l3.S() + m3.x, r3) {
                      if (g3.x = a3, g3.y = s4.Iz(u3, c3, m3, j3, a3, h3), isNaN(g3.y))
                        break;
                    } else {
                      if (g3.x = s4.Gz(u3, c3, m3, j3, h3), isNaN(g3.x))
                        break;
                      g3.y = 0;
                    }
                    t4.kb.xd(u3, c3, m3.x, m3.y, j3.x, j3.y, v3, null, null, h3);
                    var N3 = v3.u;
                    t4.kb.xd(u3, c3, m3.x, m3.y, g3.x, g3.y, v3, null, null, h3);
                    var I3 = v3.u;
                    t4.Gg.Tb(n4) == 2 ? (p3[0][0] = g3.x / f3, p3[0][1] = g3.y / f3, t4.cb.XQ(), r3 ? (d3.y = p3[0][1], d3.x = e3) : (d3.x = s4.qs(p3[0][0], w3.x, x3.x, l3), d3.y = e3)) : r3 ? (d3.x = e3, d3.y = g3.y / f3) : (d3.x = s4.qs(g3.x / f3, w3.x, x3.x, l3), d3.y = e3), b3[0] = 0 < N3 ? t4.P.Tk(I3 / N3, 0, 1) : 0.5, b3[0] != 0 && b3[0] != 1 && (N3 = y3.Na(A3), y3.Wl(N3, b3, 1), y3.Db(y3.V(N3), d3.x, d3.y));
                  }
                } while (0);
              w3.N(x3);
            }
          }
          return y3.Ke(i5);
        }, s4.Hn = function(i5, n4, h3, r3, e3) {
          if (i5.B())
            return i5;
          var o3 = t4.cb.bf(n4);
          return s4.Jp(i5, h3 - 180 * o3, 360 * o3, n4, r3, e3, true);
        }, s4.Iz = function(i5, n4, h3, r3, e3, o3) {
          if (3.141592653589793 <= Math.abs(h3.x - r3.x) || !s4.Un(h3.x, r3.x, e3))
            return NaN;
          if (h3.x > r3.x)
            var a3 = r3;
          else
            a3 = h3, h3 = r3;
          r3 = new t4.ha(0);
          var u3 = new t4.ha(0), f3 = new t4.ha(0);
          t4.kb.xd(i5, n4, a3.x, a3.y, h3.x, h3.y, u3, r3, null, o3);
          var c3 = u3.u, l3 = 0, p3 = 1, v3 = new t4.h();
          for (v3.N(a3); c3 * (p3 - l3) > 1e-12 * i5; ) {
            var y3 = 0.5 * (l3 + p3);
            if (t4.kb.qj(i5, n4, a3.x, a3.y, c3 * y3, r3.u, u3, f3, o3), v3.x = u3.u, v3.y = f3.u, v3.x == e3)
              break;
            if (s4.Un(a3.x, v3.x, e3))
              p3 = y3;
            else {
              if (!s4.Un(h3.x, v3.x, e3))
                return NaN;
              l3 = y3;
            }
          }
          return v3.y;
        }, s4.Un = function(t5, s5, n4) {
          return t5 = i4.Ep(t5), s5 = i4.mx(t5, i4.Ep(s5)), (n4 = i4.mx(t5, i4.Ep(n4))) == 0 || 0 < s5 && 0 < n4 && n4 <= s5 || 0 > s5 && 0 > n4 && n4 >= s5;
        }, s4.an = function(t5, i5) {
          var s5 = i5.wa - i5.pa;
          return i5.Kt(t5 - Math.floor((t5 - i5.pa) / s5) * s5);
        }, s4.qs = function(i5, s5, n4, h3) {
          var r3 = new t4.Oc();
          for (r3.L(s5, n4), n4 = h3.S(), i5 = Math.floor((i5 - s5) / n4) * n4 + i5, r3 = r3.tf(); Math.abs(i5 - r3) > Math.abs(i5 + n4 - r3); )
            i5 += n4;
          return i5;
        }, s4.Gz = function(i5, s5, n4, h3, r3) {
          if (n4.y > h3.y)
            var e3 = h3;
          else
            e3 = n4, n4 = h3;
          if ((h3 = new t4.Oc()).L(e3.y, n4.y), !h3.contains(0) || 3.141592653589793 <= Math.abs(e3.x - n4.x))
            return NaN;
          if (e3.x == n4.x)
            return e3.x;
          var o3 = new t4.ha(0), a3 = new t4.ha(0), u3 = new t4.ha(0);
          t4.kb.xd(i5, s5, e3.x, e3.y, n4.x, n4.y, a3, o3, null, r3);
          var f3 = a3.u, c3 = 0, l3 = 1, p3 = new t4.h();
          for (p3.N(e3); f3 * (l3 - c3) > 1e-12 * i5; ) {
            var v3 = 0.5 * (c3 + l3);
            if (t4.kb.qj(i5, s5, e3.x, e3.y, f3 * v3, o3.u, a3, u3, r3), p3.x = a3.u, p3.y = u3.u, h3.L(e3.y, p3.y), p3.y == 0)
              break;
            if (h3.contains(0))
              l3 = v3;
            else {
              if (h3.L(n4.y, p3.y), !h3.contains(0))
                return NaN;
              c3 = v3;
            }
          }
          return p3.x;
        }, s4.Jp = function(i5, s5, n4, h3, r3, e3, o3) {
          var a3 = new t4.l();
          if (i5.A(a3), a3.B())
            return i5;
          var u3 = new t4.Oc();
          a3.en(u3);
          var f3 = new t4.Oc();
          if (f3.L(s5, s5 + n4), f3.contains(u3) && f3.wa != u3.wa)
            return i5;
          var c3 = new t4.l();
          c3.L(a3);
          var l3 = i5.K();
          if (l3 == 33)
            return ((a3 = (c3 = r3 ? i5 : i5.Qf()).Ng()) < f3.pa || a3 >= f3.wa || o3 && a3 == f3.wa) && (a3 += Math.ceil((f3.pa - a3) / n4) * n4, a3 = f3.Kt(a3), c3.YB(a3)), c3;
          if (l3 == 550) {
            for (h3 = (c3 = r3 ? i5 : i5.Qf()).vb(0), l3 = 2 * c3.I(), i5 = false, r3 = 0; r3 < l3; r3 += 2)
              ((a3 = h3.read(r3)) < f3.pa || a3 >= f3.wa || o3 && a3 == f3.wa) && (i5 = true, a3 += Math.ceil((f3.pa - a3) / n4) * n4, a3 = f3.Kt(a3), h3.write(r3, a3));
            return i5 && c3.Qc(1993), c3;
          }
          if (f3.contains(u3))
            return i5;
          if (l3 == 197)
            return n4 = r3 ? i5 : i5.Qf(), a3.Fa(c3), n4.Zo(a3), n4;
          var p3 = 0.1 * Math.max(a3.da(), a3.S());
          c3.X(0, p3), o3 = i5, f3 = h3.Yd(0), i5 = t4.Ih.local(), r3 = new t4.Ed();
          for (; ; ) {
            var v3 = Math.floor((u3.pa - s5) / n4), y3 = Math.ceil((u3.wa - s5) / n4);
            if (!(3 < y3 - v3))
              break;
            v3 = Math.floor(0.5 * (y3 + v3)), c3.v = a3.v - p3, c3.C = s5 + n4 * v3;
            var b3 = t4.Vd.clip(o3, c3, f3, e3);
            c3.v = c3.C, c3.C = a3.C + p3;
            var d3 = t4.Vd.clip(o3, c3, f3, e3);
            r3.ig((v3 - y3) * n4, 0), d3.Pc(r3), l3 == 1736 ? o3 = i5.W(b3, d3, h3, null) : (o3 = b3).add(d3, false), o3.A(a3), a3.en(u3);
          }
          for (c3.v = s5, c3.C = s5 + n4, (s5 = new t4.l()).L(c3), s5.X(f3, 0), (s5 = Math.floor((a3.v - c3.v) / n4) * n4) != 0 ? (c3.move(s5, 0), r3.ig(-s5, 0)) : r3.MB(), s5 = l3 == 1607 ? new t4.Ua(o3.description) : new t4.Ea(o3.description), e3 = new t4.l(), u3 = new t4.l(); a3.C > c3.v; )
            (p3 = t4.Vd.clip(o3, c3, f3, 0)).A(u3), (l3 == 1607 ? !p3.B() && (u3.S() > f3 || u3.da() > f3) : !p3.B() && (l3 != 1736 || u3.S() > f3)) && (p3.Pc(r3), p3.A(u3), s5.A(e3), e3.X(f3, f3), e3.isIntersecting(u3) && l3 == 1736 ? s5 = i5.W(s5, p3, h3, null) : s5.add(p3, false)), c3.move(n4, 0), r3.shift(-n4, 0);
          return s5;
        }, s4.RI = function(i5, s5, n4, h3) {
          var r3 = new t4.ee(n4.description);
          r3.Gd(n4, 0, -1), r3 = t4.cb.Bh(r3, i5, s5);
          var e3 = n4.I();
          if (h3.Pa(), !t4.cb.Xc(i5) || e3 != r3.I())
            return false;
          var o3 = new t4.l();
          n4.A(o3);
          var a3 = new t4.l();
          if (r3.A(a3), o3 = o3.S(), a3 = a3.S(), o3 != 0 && a3 != 0) {
            if (a3 /= o3, i5 = t4.cb.ih(s5).S() / t4.cb.ih(i5).S(), 1e-10 < Math.abs(a3 / i5 - 1))
              return false;
          } else if (o3 != 0 || a3 != 0)
            return false;
          for (h3.add(n4, false), n4 = 0; n4 < e3; n4++)
            i5 = r3.Oa(n4), h3.Db(n4, i5);
          return true;
        }, s4.Jz = function() {
          throw t4.i.Fe();
        }, s4;
      }();
    }(Q2 || (Q2 = {})), function(t4) {
      var i4, s4, n4;
      (s4 = i4 = t4.ui || (t4.ui = {}))[s4.Clip = 0] = "Clip", s4[s4.DontClip = 1] = "DontClip", s4[s4.PannableFold = 2] = "PannableFold", function(t5) {
        t5[t5.Geodesic = 0] = "Geodesic", t5[t5.Loxodrome = 1] = "Loxodrome", t5[t5.GreatElliptic = 2] = "GreatElliptic", t5[t5.NormalSection = 3] = "NormalSection", t5[t5.ShapePreserving = 4] = "ShapePreserving";
      }(n4 = t4.RK || (t4.RK = {})), t4.Ab = function() {
        function s5() {
        }
        return s5.zv = function(i5, s6, n5) {
          if (n5 || 0 < s6) {
            for (i5 = i5.toString(t4.Tc.PE_STR_NAME_CANON | t4.Tc.PE_STR_AUTH_NONE), s6 = [], n5 = 0; n5 < i5.length; n5++)
              s6[n5] = "a" <= i5[n5] && "z" >= i5[n5] ? s6[n5] = i5[n5].toUpperCase() : i5[n5];
            return s6.join();
          }
          return i5.toString(t4.Tc.PE_STR_AUTH_TOP);
        }, s5.wr = function(i5, s6, n5, h3) {
          var r3 = h3.length, e3 = n5.I();
          if (e3 != 0) {
            var o3 = n5.vb(0), a3 = Math.min(e3, r3), u3 = 0, f3 = i5.gh();
            isNaN(s6) && (s6 = 0);
            for (var c3 = i5.Xc(), l3 = 179 * (i5 = c3 ? i5.tc().Le().S() : 0) / 360; 0 < e3; ) {
              if (o3.pB(u3 << 1, a3, h3), t4.gj.projToGeogCenter(f3, a3, h3, s6), c3)
                for (var p3 = 0; p3 < a3; p3++) {
                  var v3 = h3[p3][0] - s6, y3 = t4.mc.sign(v3), b3 = o3.read(2 * (u3 + p3));
                  0 > y3 * t4.mc.sign(b3) && Math.abs(v3) > l3 && (h3[p3][0] += -y3 * i5);
                }
              o3.pC(u3 << 1, a3, h3), u3 += a3, e3 -= a3, a3 = Math.min(e3, r3);
            }
            n5.Qc(1993);
          }
        }, s5.DL = function(i5, s6, n5, h3) {
          var r3 = 0, e3 = i5.gh();
          isNaN(r3) && (r3 = 0);
          var o3 = i5.Xc(), a3 = i5.bf();
          i5 = 360 * a3, a3 *= 179;
          for (var u3 = h3.length, f3 = 0; f3 < n5; ) {
            for (var c3 = f3; c3 < n5 && s6[c3].isNaN(); ++c3)
              f3++;
            var l3 = Math.min(u3, n5 - f3);
            if (0 < l3) {
              c3 = 1;
              for (var p3 = f3 + 1; c3 < l3; ++c3, ++p3)
                if (s6[p3].isNaN()) {
                  l3 = c3;
                  break;
                }
              if (t4.ua.Ey(h3, s6, f3, l3), t4.gj.projToGeogCenter(e3, l3, h3, r3), o3)
                for (c3 = 0, p3 = f3; c3 < l3; ++c3, ++p3) {
                  var v3 = s6[p3].x, y3 = h3[c3][0] - r3, b3 = t4.mc.sign(y3);
                  0 > b3 * t4.mc.sign(v3) && Math.abs(y3) > a3 && (h3[c3][0] -= b3 * i5);
                }
              t4.ua.Dy(s6, f3, h3, l3), f3 += l3;
            }
          }
        }, s5.Kx = function(i5, s6, n5) {
          var h3 = n5.length, r3 = s6.I();
          if (!(1 > r3)) {
            var e3 = s6.vb(0), o3 = Math.min(r3, h3), a3 = 0, u3 = i5.gh(), f3 = i5.Xc(), c3 = f3 ? i5.Le().S() : 0, l3 = 179 * c3 / 360, p3 = 0;
            for (f3 && (p3 = i5.Bi()); 0 < r3; ) {
              if (e3.pB(a3 << 1, o3, n5), t4.gj.geogToProj(u3, o3, n5), f3)
                for (i5 = 0; i5 < o3; i5++) {
                  var v3 = n5[i5][0], y3 = t4.mc.sign(v3), b3 = e3.read(2 * (a3 + i5)) - p3;
                  0 > y3 * t4.mc.sign(b3) && Math.abs(v3) > l3 && (n5[i5][0] += -y3 * c3);
                }
              e3.pC(a3 << 1, o3, n5), a3 += o3, r3 -= o3, o3 = Math.min(r3, h3);
            }
            s6.Qc(1993);
          }
        }, s5.CL = function(i5, s6, n5, h3) {
          if (n5 != 0) {
            var r3 = i5.gh(), e3 = i5.Xc(), o3 = e3 ? i5.Le().S() : 0, a3 = 179 * o3 / 360, u3 = 0;
            for (e3 && (u3 = i5.Bi()), i5 = 0; i5 < n5; ) {
              for (var f3 = i5; f3 < n5 && s6[f3].isNaN(); ++f3)
                i5++;
              var c3 = Math.min(h3.length, n5 - i5);
              if (0 < c3) {
                f3 = 1;
                for (var l3 = i5 + 1; f3 < c3; ++f3, ++l3)
                  if (s6[l3].isNaN()) {
                    c3 = f3;
                    break;
                  }
                if (t4.ua.Ey(h3, s6, i5, c3), t4.gj.geogToProj(r3, c3, h3), e3)
                  for (f3 = 0, l3 = i5; f3 < c3; f3++) {
                    var p3 = h3[f3][0], v3 = t4.mc.sign(p3);
                    0 > v3 * t4.mc.sign(s6[l3].x - u3) && Math.abs(p3) > a3 && (h3[f3][0] -= v3 * o3);
                  }
                t4.ua.Dy(s6, i5, h3, c3), i5 += c3;
              }
            }
          }
        }, s5.vr = function(i5, s6, n5, h3) {
          var r3 = s6.I();
          if (r3 != 0) {
            var e3 = s6.vb(0), o3 = i5.ef, a3 = i5.$f, u3 = o3.tc().Sp(), f3 = a3.tc().Sp(), c3 = o3.bf(), l3 = a3.bf();
            if ((i5 = i5.Yf) == null || i5.count() == 0) {
              for (n5 = u3 / f3, h3 = (o3.Wp() - a3.Wp()) * l3, f3 = -90 * c3, i5 = 90 * c3, u3 = false, l3 = 1, o3 = 2 * r3; l3 < o3; )
                c3 = e3.get(l3), (a3 = t4.P.Tk(c3, f3, i5)) != c3 && (e3.set(l3, a3), u3 = true), l3 += 2;
              if (h3 != 0 || n5 != 1)
                for (u3 = true, f3 = new t4.h(), l3 = 0; l3 < r3; l3++)
                  e3.uc(2 * l3, f3), f3.x *= n5, f3.x += h3, f3.y *= n5, e3.Vt(2 * l3, f3);
              u3 && s6.Qc(1993);
            } else {
              o3 = h3.length, a3 = Math.min(r3, o3);
              var p3 = t4.P.mg(a3), v3 = null, y3 = 0, b3 = NaN, d3 = NaN, g3 = 360 * l3, w3 = l3 / c3;
              n5 && (d3 = 90 * l3, b3 = 89.9 * c3, v3 = t4.P.mg(a3));
              for (var x3 = true, m3 = 0; r3 != 0; ) {
                for (c3 = false, e3.pB(y3 << 1, a3, h3), l3 = 0; l3 < a3; l3++)
                  p3[l3] = h3[l3][0];
                if (n5)
                  for (l3 = 0; l3 < a3; l3++) {
                    var j3 = Math.abs(h3[l3][1]) - b3;
                    0 < j3 && (c3 = h3[l3][1], h3[l3][1] = t4.mc.En(b3, c3), v3[l3] = t4.mc.En(j3, c3), c3 = true);
                  }
                for (l3 = h3[0][0], i5.transform(h3, a3, u3, f3), x3 && (m3 = h3[0][0] - w3 * l3, x3 = false), l3 = 0; l3 < a3; l3++)
                  j3 = h3[l3][0] - p3[l3] * w3 - m3, 200 < Math.abs(j3) && (h3[l3][0] = 0 < j3 ? h3[l3][0] - g3 : h3[l3][0] + g3);
                if (c3) {
                  for (l3 = 0; l3 < a3; l3++)
                    v3[l3] != 0 && (h3[l3][1] += w3 * v3[l3], h3[l3][1] > d3 ? h3[l3][1] = d3 : h3[l3][1] < -d3 && (h3[l3][1] = -d3));
                  for (c3 = 0; c3 < a3; c3++)
                    v3[c3] = 0;
                }
                e3.pC(y3 << 1, a3, h3), y3 += a3, r3 -= a3, a3 = Math.min(r3, o3);
              }
              s6.Qc(1993);
            }
          }
        }, s5.BL = function(i5, s6, n5, h3) {
          if (i5.ow)
            h3 = 90 * i5.ef.bf(), t4.ua.ZJ(s6, n5, -h3, h3);
          else {
            var r3 = i5.Yf, e3 = i5.ef, o3 = i5.$f;
            i5 = e3.Zr();
            var a3 = o3.Zr(), u3 = e3.bf(), f3 = 90 * u3, c3 = o3.bf();
            if (r3 == null || r3.count() == 0) {
              if (h3 = i5 / a3, r3 = (e3.Wp() - o3.Wp()) * c3, t4.ua.ZJ(s6, n5, -f3, f3), r3 != 0 || h3 != 1)
                for (c3 = 0; c3 < n5; c3++)
                  s6[c3].x *= h3, s6[c3].x += r3, s6[c3].y *= h3;
            } else {
              e3 = Math.min(n5, h3.length), f3 = t4.P.mg(e3), o3 = 360 * c3, u3 = c3 / u3;
              for (var l3 = true, p3 = 0, v3 = 0; n5 != 0; ) {
                for (c3 = 0; c3 < e3; c3++)
                  f3[c3] = s6[c3 + v3].x;
                for (c3 = s6[0].x, t4.ua.Ey(h3, s6, v3, e3), r3.transform(h3, e3, i5, a3), t4.ua.Dy(s6, v3, h3, e3), l3 && (p3 = s6[0].x - u3 * c3, l3 = false), c3 = 0; c3 < e3; c3++) {
                  var y3 = s6[v3 + c3].x - f3[c3] * u3 - p3;
                  200 < Math.abs(y3) && (s6[v3 + c3].x = 0 < y3 ? s6[v3 + c3].x - o3 : s6[v3 + c3].x + o3);
                }
                v3 += e3, n5 -= e3, e3 = Math.min(n5, h3.length);
              }
            }
          }
        }, s5.fv = function(t5, i5) {
          return t5 = t5.ih(), isNaN(i5) || t5.Lu(i5, 0), t5;
        }, s5.PQ = function(i5, n5, h3, r3, e3, o3, a3, u3) {
          for (var f3 = s5.fv(r3, e3), c3 = f3.S(), l3 = c3 / 360, p3 = s5.kE * l3, v3 = i5.vb(0), y3 = n5.Xc(), b3 = y3 ? c3 / n5.Le().S() : 0, d3 = false, g3 = new t4.Ea(h3.description), w3 = 0, x3 = h3.ea(); w3 < x3; ++w3) {
            var m3 = y3, j3 = new t4.Ua(h3.description);
            if (j3.addPath(h3, w3, true), a3 != 0) {
              var M3 = s5.KD(true, j3, f3.H - u3, f3.H, a3);
              (d3 = d3 || M3) && (m3 = false);
            }
            var k3 = -1;
            m3 && (k3 = i5.Ca(w3));
            var z3 = j3.vb(0), A3 = j3.I(), N3 = 0, I3 = z3.read(0), P3 = 0;
            M3 = 3 * r3.Yd(0);
            var C3 = false, B3 = new t4.h();
            B3.Sc();
            var D3 = new t4.h();
            D3.Sc();
            for (var q3 = false, G3 = 1; G3 < A3; ++G3) {
              var F3 = t4.h.construct(z3.gg(2 * G3), z3.gg(2 * G3 + 1)), T3 = F3.x, E3 = T3 + N3, S3 = E3 - I3;
              if (F3.x = E3, Math.abs(S3) > p3) {
                if (m3) {
                  var O3 = k3 + (G3 + 1 < A3 ? G3 : 0), H3 = v3.read(2 * (k3 + G3 - 1));
                  O3 = (v3.read(2 * O3) - H3) * b3, Math.abs(S3 - O3) > 1 * l3 && (m3 = false);
                }
                m3 || (E3 = T3 + (N3 -= t4.mc.En(c3, E3 - I3)), ++P3, q3 = N3 != 0, F3.x = E3);
              } else
                C3 || t4.ua.vG(D3, B3, F3, M3) && (C3 = true);
              q3 && z3.write(2 * G3, E3), I3 = E3, D3.N(B3), B3.N(F3);
            }
            0 < P3 && j3.Qc(1993), m3 = j3.Oa(0), A3 = j3.Oa(A3 - 1), j3 = t4.h.ub(m3, A3) < M3 ? s5.pQ(j3, r3, e3, o3, C3) : s5.qQ(i5, w3, j3, r3, e3), g3.add(j3, false);
          }
          return e3 = r3.Yd(0), h3 = f3.S() / 180, s5.Lt(g3, f3, 0.1 * e3, false), g3 = g3 != (e3 = t4.ti.clip(g3, f3, e3, h3, o3)), i5 = i5.He(), a3 = 0, 0 < (u3 = e3.He()) && 0 > i5 ? a3 = 1 : 0 >= u3 && 0 < i5 && (u3 == 0 ? (u3 = NaN, n5.Tb() == 2 ? u3 = n5.ol().He() : n5.Tb() == 1 && (u3 = n5.Le().rF()), i5 > 0.99 * u3 && (a3 = -1)) : a3 = -1), a3 != 0 && ((n5 = new t4.Ea(e3.description)).vp(f3), (n5 = t4.Zl.local().W(n5, h3, o3)).add(e3, false), g3 = true, e3 = n5), g3 && (e3 = t4.$l.local().W(e3, r3, false, o3)), e3;
        }, s5.qQ = function(i5, n5, h3, r3, e3) {
          var o3 = h3.I(), a3 = h3.Oa(0), u3 = h3.Oa(o3 - 1);
          e3 = (r3 = s5.fv(r3, e3)).S(), a3 = t4.mc.sign(u3.x - a3.x);
          var f3 = new t4.l();
          h3.yc(f3);
          var c3 = r3.ik();
          if (u3 = c3 - e3, c3 += e3, 0 <= a3) {
            var l3 = Math.ceil((u3 - f3.v) / e3);
            for (l3 *= e3; u3 > f3.v + l3; )
              l3 += e3;
            for (; u3 < f3.C + l3; )
              l3 -= e3;
            var p3 = l3;
            720 < f3.S() && (c3 = u3 + 360 * Math.ceil(f3.S() / 360));
          } else {
            for (l3 = Math.ceil((c3 - f3.C) / e3), l3 *= e3; c3 < f3.C + l3; )
              l3 -= e3;
            for (; c3 > f3.v + l3; )
              l3 += e3;
            p3 = l3, 720 < f3.S() && (u3 = c3 - 360 * Math.ceil(f3.S() / 360));
          }
          l3 = a3 * e3;
          var v3 = t4.l.construct(f3.v, f3.G, f3.C, f3.H);
          v3.move(p3, 0);
          var y3 = new t4.Ed();
          y3.ig(p3, 0), h3.Pc(y3), (f3 = new t4.Ua(h3.description)).add(h3, false), p3 = h3.Oa(o3 - 1), e3 = 0;
          for (var b3 = f3.Oa(0).x; 0 < a3 ? v3.C < c3 : v3.v > u3; )
            v3.move(l3, 0), y3.Lb = l3, h3.Pc(y3), b3 += l3, r3.v <= b3 && r3.C >= b3 && (e3 = f3.I() - 1), h3.Db(0, p3), p3 = h3.Oa(o3 - 1), f3.Fr(h3, 0, 0, o3 - 1, false);
          return h3 = new t4.Ea(f3.description), o3 = 0 < i5.Kr(n5), h3.add(f3, false), i5 = f3.Oa(0), u3 = f3.Oa(f3.I() - 1), n5 = h3.ea() - 1, (0 > a3 ? o3 : !o3) ? (a3 = t4.h.construct(u3.x, r3.H), h3.Ei(a3), a3 = t4.h.construct(r3.ik(), r3.H), h3.Ei(a3), r3 = t4.h.construct(i5.x, r3.H)) : (a3 = t4.h.construct(u3.x, r3.G), h3.Ei(a3), a3 = t4.h.construct(r3.ik(), r3.G), h3.Ei(a3), r3 = t4.h.construct(i5.x, r3.G)), h3.Ei(r3), h3.sG(0, n5, 0), h3.fO(e3), h3;
        }, s5.pQ = function(i5, n5, h3, r3, e3) {
          var o3 = new t4.Ea(i5.description);
          o3.add(i5, false), o3.yB(0, o3.I() - 1);
          var a3 = new t4.l();
          o3.yc(a3);
          var u3 = (h3 = s5.fv(n5, h3)).S(), f3 = Math.ceil((h3.v - a3.v) / u3);
          for (f3 *= u3; h3.v > a3.v + f3; )
            f3 += u3;
          for (; h3.v < a3.C + f3; )
            f3 -= u3;
          if ((f3 += u3) != 0) {
            a3.move(f3, 0);
            var c3 = new t4.Ed();
            c3.ig(f3, 0), o3.Pc(c3);
          }
          if (h3.v <= a3.v && h3.C > a3.C)
            return e3 && (e3 = o3.He(), n5 = (o3 = t4.$l.local().W(o3, n5, true, r3)).He(), (n5 = t4.mc.sign(e3) != t4.mc.sign(n5)) && o3.jJ()), o3;
          for ((i5 = new t4.Ea(i5.description)).add(o3, false), e3 = e3 || a3.S() > u3 - n5.Yd(0); a3.v < h3.C; )
            a3.move(u3, 0), (c3 = new t4.Ed()).ig(u3, 0), o3.Pc(c3), i5.add(o3, false);
          return e3 && (e3 = i5.He(), i5.$o(1), n5 = (i5 = t4.$l.local().W(i5, n5, true, r3)).He(), (n5 = t4.mc.sign(e3) != t4.mc.sign(n5)) && i5.jJ()), i5;
        }, s5.KD = function(i5, s6, n5, h3, r3) {
          for (var e3 = s6.vb(0), o3 = s6.I(), a3 = false, u3 = 0; u3 < o3; u3++) {
            var f3 = t4.h.construct(e3.gg(2 * u3), e3.gg(2 * u3 + 1));
            if ((1 & r3) != 0 && f3.y >= n5) {
              a3 = true;
              break;
            }
            if ((2 & r3) != 0 && f3.y <= -n5) {
              a3 = true;
              break;
            }
          }
          if (!a3)
            return false;
          e3 = false, i5 && (e3 = s6.Pn(0)), o3 = (i5 = new t4.hd()).Ib(s6), a3 = i5.Ob(o3);
          var c3 = -1, l3 = true, p3 = new t4.h();
          p3.Sc(), u3 = new t4.Ta();
          for (var v3 = -1, y3 = i5.Ya(a3); y3 != -1; y3 = i5.V(y3)) {
            f3 = i5.Oa(y3);
            var b3 = (1 & r3) != 0 && 90 <= f3.y ? 1 : 0;
            if (b3 |= (2 & r3) != 0 && f3.y <= -n5 ? 2 : 0, 0 < c3 && c3 != b3) {
              if (p3.x != f3.x) {
                p3.x = f3.x, i5.Xi(i5.Na(y3), u3);
                var d3 = i5.yj(a3, y3, u3);
                i5.mf(d3, p3);
              }
              if (e3)
                for (v3 = v3 != -1 ? i5.V(v3) : i5.Ya(a3), d3 = i5.Na(y3); v3 != d3; )
                  v3 = i5.qd(v3, false);
              v3 = -1;
            }
            0 < b3 && (f3.y = t4.mc.En(h3, f3.y), i5.mf(y3, f3), l3 || c3 == b3 || (f3.x != p3.x ? (i5.Xi(y3, u3), d3 = i5.yj(a3, y3, u3), i5.Db(d3, p3.x, f3.y), v3 = d3) : v3 = y3)), c3 = b3, p3 = f3, l3 = false;
          }
          if (e3) {
            if (v3 != -1)
              for (v3 = i5.V(v3); v3 != -1; )
                v3 = i5.qd(v3, false);
            n5 = i5.Ya(a3), i5.hq(n5, i5.tj(a3)) || (i5.Xi(n5, u3), i5.yj(a3, -1, u3));
          }
          return i5.Ke(o3).copyTo(s6), true;
        }, s5.Hz = function(n5, h3, r3, e3) {
          var o3 = n5;
          if (o3.B() || r3 == i4.DontClip)
            return o3;
          var a3 = o3.K();
          if (a3 == 33)
            return o3 = [(e3 = o3).D()], s5.tG(o3, 1, h3, r3), o3[0].isNaN() ? e3.Pa() : e3.Db(o3[0]), n5;
          var u3 = (n5 = h3.tc()).bf(), f3 = 90 * u3, c3 = 180 * u3, l3 = 360 * u3, p3 = h3.Bi(), v3 = 0.5 * u3, y3 = new t4.l();
          o3.A(y3);
          var b3 = h3.Xr(), d3 = h3.KQ(), g3 = b3.K() == 197;
          if (h3 = new t4.l(), b3.A(h3), r3 == i4.PannableFold && (r3 = n5.Le().S(), h3.v = p3 - 0.5 * r3, h3.C = h3.v + r3), y3.G < -f3 || y3.H > f3) {
            if (new t4.l().L(y3.v - u3, -f3, y3.C + u3, f3), (o3 = t4.ti.Pu(o3, h3, n5, NaN, 0, e3)).B())
              return o3;
            o3.A(y3);
          }
          if (d3 && (h3.H < y3.G || h3.G > y3.H))
            return o3.Ja();
          if (y3.S() > l3 && (o3 = s5.Jp(o3, p3 - c3, l3, n5, true, 0, true, e3)).A(y3), (f3 = s5.$N(y3.v, y3.C, h3.v, h3.C, l3)) != 0 && y3.move(f3, 0), y3.C > h3.C || y3.v < h3.v) {
            if (y3.C > h3.C)
              for (; y3.v >= h3.C; )
                y3.move(-l3, 0), f3 -= l3;
            for (; y3.v < h3.C - l3; )
              y3.move(l3, 0), f3 += l3;
          }
          if (r3 = t4.ua.Ju(n5, b3), f3 != 0 && ((u3 = new t4.Ed()).ig(f3, 0), o3.Pc(u3)), d3) {
            if (g3 && h3.contains(y3))
              return o3;
            for (d3 = [null, null], f3 = 0; 2 > f3; f3++) {
              if (g3 ? u3 = t4.ba.Ic(a3) ? t4.ti.clip(o3, h3, r3, v3, e3) : t4.ti.clip(o3, h3, r3, 0, e3) : (u3 = t4.Zj.local().W(o3, b3, n5, e3)) == b3 && (u3 = t4.ba.kg(u3)), h3.v <= y3.v && h3.C >= y3.C || h3.v >= y3.v && h3.C <= y3.C)
                return u3;
              d3[f3] = u3, f3 == 0 && (y3.move(-l3, 0), (u3 = new t4.Ed()).ig(-l3, 0), o3.Pc(u3));
            }
            if (a3 == 550)
              d3[0].Gd(d3[1], 0, -1);
            else if (t4.ba.Ic(a3))
              d3[0].add(d3[1], false);
            else {
              if (a3 != 33)
                throw t4.i.ga("intersect_with_GCS_horizon: unexpected geometry type");
              d3[0].B() && (d3[0] = d3[1]);
            }
            return d3[0];
          }
          if (h3.H < y3.G || h3.G > y3.H)
            return o3;
          for (a3 = 0; !o3.B() && y3.C > h3.v; )
            a3 != 0 && ((u3 = new t4.Ed()).ig(a3, 0), o3.Pc(u3)), t4.fj.local().W(4, o3, b3, n5, e3) || b3 == (o3 = t4.mp.local().W(o3, b3, n5, e3)) && (o3 = t4.ba.kg(o3)), a3 != 0 && ((v3 = new t4.Ed()).ig(-a3, 0), o3.Pc(v3)), a3 -= l3, y3.move(-l3, 0);
          return o3;
        }, s5.tG = function(n5, h3, r3, e3) {
          if (h3 != 0 && e3 != i4.DontClip)
            if (e3 == i4.PannableFold) {
              e3 = r3.CR();
              for (var o3 = h3, a3 = 0; a3 < h3; a3++)
                (n5[a3].y > e3.H || n5[a3].y < e3.G) && (n5[a3].Sc(), o3--);
              o3 != 0 && s5.cv(n5, h3, e3.v, e3.S());
            } else {
              var u3 = 90 * (e3 = r3.bf()), f3 = 180 * e3;
              for (e3 *= 360, o3 = h3, a3 = 0; a3 < h3; a3++)
                (n5[a3].y > u3 || n5[a3].y < -u3) && (n5[a3].Sc(), o3--);
              if (o3 != 0) {
                (o3 = new t4.l()).bx(n5, h3), u3 = r3.Xr();
                var c3 = r3.kv();
                a3 = u3.K() == 197;
                var l3 = new t4.l();
                if (u3.A(l3), !c3 || !(l3.H < o3.G || l3.G > o3.H))
                  if (c3)
                    if (s5.cv(n5, h3, l3.ik() - f3, e3), o3 = h3, a3)
                      for (a3 = 0; a3 < h3; a3++)
                        l3.contains(n5[a3]) || (n5[a3].Sc(), o3--);
                    else
                      for (r3 = t4.ua.Ju(r3.tc(), u3), a3 = 0; a3 < h3; a3++)
                        (f3 = t4.jd.Zd(u3, n5[a3], r3) != 0) || (n5[a3].Sc(), o3--);
                  else
                    for (s5.cv(n5, h3, -f3, e3), o3 = h3, r3 = t4.ua.Ju(r3.tc(), u3), a3 = 0; a3 < h3; a3++)
                      (f3 = n5[a3]).isNaN() && o3--, c3 = s5.oE(f3.x, l3.v, l3.C, e3), f3.x += c3, (f3 = t4.jd.Zd(u3, f3, r3) != 0) && (n5[a3].Sc(), o3--);
              }
            }
        }, s5.Jp = function(i5, s6, n5, h3, r3, e3, o3, a3) {
          var u3 = i5.K(), f3 = s6 + n5;
          if (u3 === 33) {
            var c3 = (h3 = r3 ? i5 : i5.Qf()).Ng();
            return (c3 < s6 || c3 >= f3 || o3 && c3 == f3) && (c3 += Math.ceil((s6 - c3) / n5) * n5, c3 = t4.P.Tk(c3, s6, f3), h3.YB(c3)), h3;
          }
          if (i5.B())
            return i5;
          if (c3 = new t4.l(), i5.A(c3), c3.B())
            return i5;
          var l3 = new t4.Oc();
          c3.en(l3);
          var p3 = new t4.Oc();
          if (p3.L(s6, f3), p3.contains(l3))
            return i5;
          if ((f3 = new t4.l()).L(c3), u3 === 550) {
            for (a3 = (h3 = r3 ? i5 : i5.Qf()).vb(0), u3 = 2 * h3.I(), f3 = false, s6 = 0; s6 < u3; s6 += 2)
              ((c3 = a3.read(s6)) < p3.pa || c3 >= p3.wa || o3 && c3 == p3.wa) && (f3 = true, c3 += Math.ceil((p3.pa - c3) / n5) * n5, c3 = p3.Kt(c3), a3.write(s6, c3));
            return f3 && h3.Qc(1993), h3;
          }
          if (u3 == 197)
            return n5 = r3 ? i5 : i5.Qf(), c3.Fa(f3), n5.Zo(c3), n5;
          var v3 = 0.1 * Math.max(c3.da(), c3.S());
          for (f3.X(0, v3), o3 = i5, p3 = h3.Yd(0), i5 = t4.Ih.local(), r3 = new t4.Ed(); ; ) {
            var y3 = Math.floor((l3.pa - s6) / n5), b3 = Math.ceil((l3.wa - s6) / n5);
            if (!(3 < b3 - y3))
              break;
            y3 = Math.floor(0.5 * (b3 + y3)), f3.v = c3.v - v3, f3.C = s6 + n5 * y3;
            var d3 = t4.ti.clip(o3, f3, p3, e3, a3);
            f3.v = f3.C, f3.C = c3.C + v3;
            var g3 = t4.ti.clip(o3, f3, p3, e3, a3);
            r3.ig((y3 - b3) * n5, 0), g3.Pc(r3), u3 == 1736 ? o3 = i5.W(d3, g3, h3, null) : (o3 = d3).add(g3, false), o3.A(c3), c3.en(l3);
          }
          for (f3.v = s6, f3.C = s6 + n5, (s6 = new t4.l()).L(f3), s6.X(p3, 0), (s6 = Math.floor((c3.v - f3.v) / n5) * n5) != 0 ? (f3.move(s6, 0), r3.ig(-s6, 0)) : r3.MB(), s6 = u3 == 1607 ? new t4.Ua(o3.description) : new t4.Ea(o3.description), e3 = new t4.l(), l3 = new t4.l(); c3.C > f3.v; )
            (v3 = t4.ti.clip(o3, f3, p3, 0, a3)).A(l3), (u3 == 1607 ? !v3.B() && (l3.S() > p3 || l3.da() > p3) : !v3.B() && (u3 != 1736 || l3.S() > p3)) && (v3.Pc(r3), v3.A(l3), s6.A(e3), e3.X(p3, p3), e3.isIntersecting(l3) && u3 == 1736 ? s6 = i5.W(s6, v3, h3, null) : s6.add(v3, false)), f3.move(n5, 0), r3.shift(-n5, 0);
          return s6;
        }, s5.cv = function(i5, s6, n5, h3) {
          for (var r3 = n5 + h3, e3 = 0; e3 < s6; e3++) {
            var o3 = i5[e3].x;
            n5 <= o3 && o3 < r3 || !(o3 < n5 || o3 > r3 || o3 == r3) || (o3 += Math.ceil((n5 - o3) / h3) * h3, o3 = t4.P.Tk(o3, n5, r3), i5[e3].x = o3);
          }
        }, s5.Hn = function(i5, n5, h3, r3, e3, o3) {
          if (!n5.Xc())
            throw t4.i.ga("fold_into_360_degree_range");
          if (i5.B())
            return i5;
          if (n5.Tb() == 2) {
            h3 = n5.rv();
            var a3 = n5.qv() - h3;
          } else {
            var u3 = n5.bf();
            a3 = 360 * u3, h3 -= 180 * u3;
          }
          return s5.Jp(i5, h3, a3, n5, r3, e3, true, o3);
        }, s5.lF = function(t5, i5, n5, h3) {
          if (n5.Tb() == 2)
            h3 = n5.rv(), n5 = n5.qv() - h3;
          else {
            var r3 = n5.bf();
            n5 = 360 * r3, h3 -= 180 * r3;
          }
          s5.cv(t5, i5, h3, n5);
        }, s5.nj = function(i5, s6) {
          var n5 = s6.Le();
          if (i5.K() == 33) {
            var h3 = i5.kh();
            return n5.G <= h3 && h3 <= n5.H ? i5 : i5.Ja();
          }
          h3 = new t4.l(), i5.A(h3);
          var r3 = new t4.l();
          return r3.L(n5), r3.v = h3.v, r3.C = h3.C, r3.X(0.01 * r3.da(), 0), n5 = t4.ua.py(s6, h3), r3.contains(h3) ? i5 : t4.ti.clip(i5, r3, n5, 0, null);
        }, s5.kr = function(t5, i5, s6) {
          return t5 > i5.C && t5 - i5.C < s6 ? i5.C : t5 < i5.v && i5.v - t5 < s6 ? i5.v : t5;
        }, s5.BX = function(t5, i5, n5, h3) {
          h3.x = s5.kr(t5.x, i5, n5), h3.y = t5.y;
        }, s5.AX = function(t5, i5, n5, h3) {
          for (var r3 = 0; r3 < i5; r3++)
            t5[r3].y < n5.G || t5[r3].y > n5.H ? t5[r3].Sc() : t5[r3].x = s5.kr(t5[r3].x, n5, h3);
        }, s5.Lt = function(i5, n5, h3, r3) {
          if (!i5.B()) {
            var e3 = i5.K();
            if (!r3 || e3 != 1736)
              if (t4.ba.zj(e3)) {
                r3 = i5.vb(0), e3 = 0;
                for (var o3 = i5.I(); e3 < o3; e3++) {
                  var a3 = r3.read(2 * e3), u3 = s5.kr(a3, n5, h3);
                  u3 != a3 && r3.write(2 * e3, u3);
                }
                i5.Qc(1993);
              } else if (e3 == 197)
                r3 = new t4.l(), i5.A(r3), r3.v = s5.kr(r3.v, n5, h3), r3.C = s5.kr(r3.C, n5, h3), i5.Zo(r3);
              else {
                if (e3 != 33)
                  throw t4.i.ga("internal error");
                i5.YB(s5.kr(i5.Ng(), n5, h3));
              }
          }
        }, s5.pS = function(i5, n5, h3, r3) {
          var e3 = new t4.hd(), o3 = e3.Ib(i5);
          return i5 = t4.ua.Ju(n5, i5), s5.ms(e3, o3, n5, i5, h3, true, r3), e3.Ke(o3);
        }, s5.ms = function(i5, h3, r3, e3, o3, a3, u3) {
          if (!r3.Xc())
            throw t4.i.O("invalid call");
          var f3 = r3.Le(), c3 = r3.tc(), l3 = c3.gh().getDatum().getSpheroid();
          c3 = c3.Id().ci;
          var p3 = l3.getFlattening();
          l3 = l3.getAxis(), p3 *= 2 - p3;
          var v3 = new t4.Oc();
          f3.en(v3);
          var y3 = null, b3 = [[0, 0], [0, 0]];
          if (r3.Tb() == 2 ? (y3 = r3.gh(), a3 ? (b3[0][0] = s5.an(u3, v3), b3[0][1] = f3.Lp(), t4.gj.projToGeog(y3, 1, b3), f3 = b3[0][0] * c3) : (b3[0][0] = f3.ik(), b3[0][1] = u3, t4.gj.projToGeog(y3, 1, b3), f3 = b3[0][1] * c3)) : f3 = u3 * c3, !a3 && f3 != 0 && o3 != n4.GreatElliptic)
            throw t4.i.ga("invalid argument");
          var d3 = new t4.ha(), g3 = [0], w3 = new t4.h(), x3 = new t4.h(), m3 = new t4.h(), j3 = [null, null], M3 = new t4.h(), k3 = new t4.h(), z3 = new t4.h(), A3 = new t4.h();
          for (h3 = i5.Ob(h3); h3 != -1; h3 = i5.Sb(h3)) {
            var N3 = i5.Ya(h3);
            i5.D(N3, M3);
            for (var I3 = false, P3 = N3 = i5.V(N3); P3 != -1; P3 = i5.V(P3)) {
              if (P3 == N3) {
                if (I3)
                  break;
                I3 = true;
              }
              if (i5.D(P3, k3), a3 && (e3 < u3 - M3.x && k3.x - u3 > e3 || e3 < u3 - k3.x && M3.x - u3 > e3) || !a3 && (u3 != 0 || e3 < -M3.y && k3.y > e3 || e3 < -k3.y && M3.y > e3))
                do {
                  if (!(Math.abs(M3.x - k3.x) >= 0.5 * v3.S())) {
                    if (r3.Tb() == 2 ? (b3[0][0] = s5.an(M3.x, v3), b3[0][1] = M3.y, b3[1][0] = s5.an(k3.x, v3), b3[1][1] = k3.y, t4.gj.projToGeogCenter(y3, 2, b3, 0), z3.x = b3[0][0] * c3, z3.y = b3[0][1] * c3, A3.y = b3[1][1] * c3) : (z3.x = M3.x * c3, z3.y = M3.y * c3, A3.y = k3.y * c3), A3.x = 2 * (k3.x - M3.x) * Math.PI / v3.S() + z3.x, a3) {
                      if (x3.x = f3, x3.y = s5.Iz(l3, p3, z3, A3, f3, o3), isNaN(x3.y))
                        break;
                      j3[0] = x3;
                      var C3 = 1;
                    } else if (o3 == n4.GreatElliptic) {
                      var B3 = [0, 0];
                      if ((C3 = t4.Nx.Jz(p3, z3, A3, f3, B3)) == 0)
                        break;
                      x3.x = B3[0], x3.y = f3, j3[0] = x3, C3 == 2 && (m3.x = B3[1], m3.y = f3, j3[1] = m3);
                    } else {
                      if (x3.x = s5.Gz(l3, p3, z3, A3, o3), isNaN(x3.x))
                        break;
                      x3.y = 0, j3[0] = x3, C3 = 1;
                    }
                    var D3 = -1;
                    for (B3 = 0; B3 < C3; B3++) {
                      t4.kb.xd(l3, p3, z3.x, z3.y, A3.x, A3.y, d3, null, null, o3);
                      var q3 = d3.u;
                      t4.kb.xd(l3, p3, z3.x, z3.y, j3[B3].x, j3[B3].y, d3, null, null, o3);
                      var G3 = d3.u;
                      if (r3.Tb() == 2 ? (b3[0][0] = j3[B3].x / c3, b3[0][1] = j3[B3].y / c3, t4.gj.geogToProj(y3, 1, b3), a3 ? (w3.y = b3[0][1], w3.x = u3) : (w3.x = s5.qs(b3[0][0], M3.x, k3.x, v3), w3.y = u3)) : a3 ? (w3.x = u3, w3.y = j3[B3].y / c3) : (w3.x = s5.qs(j3[B3].x / c3, M3.x, k3.x, v3), w3.y = u3), g3[0] = 0 < q3 ? t4.P.Tk(G3 / q3, 0, 1) : 0.5, g3[0] == 0 || g3[0] == 1)
                        break;
                      D3 > g3[0] || (D3 = i5.Na(P3), i5.Wl(D3, g3, 1), i5.Db(i5.V(D3), w3.x, w3.y), D3 = g3[0]);
                    }
                  }
                } while (0);
              M3.N(k3);
            }
          }
        }, s5.an = function(t5, i5) {
          var s6 = i5.wa - i5.pa;
          return i5.Kt(t5 - Math.floor((t5 - i5.pa) / s6) * s6);
        }, s5.qs = function(i5, s6, n5, h3) {
          var r3 = new t4.Oc();
          for (r3.L(s6, n5), n5 = h3.S(), i5 = Math.floor((i5 - s6) / n5) * n5 + i5, r3 = r3.tf(); Math.abs(i5 - r3) > Math.abs(i5 + n5 - r3); )
            i5 += n5;
          return i5;
        }, s5.Un = function(i5, s6, n5) {
          return i5 = t4.sr.Ep(i5), s6 = t4.sr.mx(i5, t4.sr.Ep(s6)), (n5 = t4.sr.mx(i5, t4.sr.Ep(n5))) == 0 || 0 < s6 && 0 < n5 && n5 <= s6 || 0 > s6 && 0 > n5 && n5 >= s6;
        }, s5.Iz = function(i5, h3, r3, e3, o3, a3) {
          if (a3 == n4.GreatElliptic)
            return t4.Nx.NS(h3, r3, e3, o3);
          if (Math.abs(r3.x - e3.x) >= Math.PI || !s5.Un(r3.x, e3.x, o3))
            return NaN;
          if (r3.x > e3.x)
            var u3 = e3;
          else
            u3 = r3, r3 = e3;
          e3 = new t4.ha();
          var f3 = new t4.ha(), c3 = new t4.ha();
          t4.kb.xd(i5, h3, u3.x, u3.y, r3.x, r3.y, f3, e3, null, a3);
          var l3 = f3.u, p3 = 0, v3 = 1, y3 = new t4.h();
          for (y3.N(u3); l3 * (v3 - p3) > 1e-12 * i5; ) {
            var b3 = 0.5 * (p3 + v3);
            if (t4.kb.qj(i5, h3, u3.x, u3.y, l3 * b3, e3.u, f3, c3, a3), y3.x = f3.u, y3.y = c3.u, y3.x == o3)
              break;
            if (s5.Un(u3.x, y3.x, o3))
              v3 = b3;
            else {
              if (!s5.Un(r3.x, y3.x, o3))
                return NaN;
              p3 = b3;
            }
          }
          return y3.y;
        }, s5.Gz = function(i5, s6, h3, r3, e3) {
          if (e3 == n4.GreatElliptic)
            return i5 = [0, 0], t4.Nx.Jz(s6, h3, r3, 0, i5), i5[0];
          if (h3.y > r3.y)
            var o3 = r3;
          else
            o3 = h3, h3 = r3;
          if ((r3 = new t4.Oc()).L(o3.y, h3.y), !r3.contains(0) || Math.abs(o3.x - h3.x) >= Math.PI)
            return NaN;
          if (o3.x == h3.x)
            return o3.x;
          var a3 = new t4.ha(), u3 = new t4.ha(), f3 = new t4.ha();
          t4.kb.xd(i5, s6, o3.x, o3.y, h3.x, h3.y, u3, a3, null, e3);
          var c3 = u3.u, l3 = 0, p3 = 1, v3 = new t4.h();
          for (v3.N(o3); c3 * (p3 - l3) > 1e-12 * i5; ) {
            var y3 = 0.5 * (l3 + p3);
            if (t4.kb.qj(i5, s6, o3.x, o3.y, c3 * y3, a3.u, u3, f3, e3), v3.x = u3.u, v3.y = f3.u, r3.L(o3.y, v3.y), v3.y == 0)
              break;
            if (r3.contains(0))
              p3 = y3;
            else {
              if (r3.L(h3.y, v3.y), !r3.contains(0))
                return NaN;
              l3 = y3;
            }
          }
          return v3.x;
        }, s5.RI = function(i5, s6, n5, h3) {
          if (!i5.ef.Xc())
            return false;
          var r3 = new t4.ee(s6.description);
          if (r3.Gd(s6, 0, -1), h3 = t4.Gx.local().W(r3, i5, h3), r3 = s6.I(), n5.Pa(), r3 != h3.I())
            return false;
          var e3 = new t4.l();
          s6.A(e3);
          var o3 = new t4.l();
          if (h3.A(o3), e3 = e3.S(), o3 = o3.S(), e3 != 0 && o3 != 0) {
            if (o3 /= e3, i5 = i5.$f.ih().S() / i5.ef.ih().S(), 1e-10 < Math.abs(o3 / i5 - 1))
              return false;
          } else if (e3 != 0 || o3 != 0)
            return false;
          for (n5.add(s6, false), s6 = new t4.h(), i5 = 0; i5 < r3; i5++)
            h3.D(i5, s6), n5.Db(i5, s6);
          return true;
        }, s5.lN = function(t5, i5) {
          return (t5 %= 360 * i5) >= 180 * i5 && (t5 -= 360 * i5), t5;
        }, s5.OI = function(n5, h3, r3, e3) {
          if (r3 == i4.Clip) {
            var o3 = h3.ol();
            o3.K() == 197 ? (r3 = new t4.l(), o3.A(r3), o3 = t4.ua.py(h3, r3), n5 = t4.ti.clip(n5, r3, o3, 5e4 * h3.rm(), e3)) : t4.fj.local().W(1, o3, n5, h3, e3) || (n5 = t4.Zj.local().W(n5, o3, h3, e3)) == o3 && (n5 = t4.Xk.kg(n5));
          } else
            h3.Xc() && (e3 = new t4.l(), n5.yc(e3), h3.Le().contains(e3) || (s5.Lt(n5, h3.Le(), h3.Yd(0), true), r3 == i4.PannableFold && (n5 = s5.nj(n5, h3)), n5 = s5.Hn(n5, h3, 0, true, 1e5 * h3.rm(), null)));
          return n5;
        }, s5.SD = function(i5, s6, n5) {
          var h3 = s6.Yr();
          if (h3 == null)
            return i5;
          var r3 = (s6 = s6.tc()).Le().S(), e3 = new t4.l();
          i5.yc(e3);
          var o3 = new t4.Oc();
          e3.en(o3), e3 = h3.Ha(), h3 = null;
          for (var a3 = new t4.Ed(); e3.ab(); )
            for (; e3.Ia(); ) {
              var u3 = e3.ia(), f3 = u3.Vg(0, 0), c3 = new t4.Oc();
              for (c3.L(f3.pa, f3.wa), f3 = 0; c3.wa > o3.pa; )
                c3.move(-r3), --f3;
              for (; c3.pa <= o3.wa; ) {
                if (c3.isIntersecting(o3)) {
                  h3 == null && (h3 = new t4.Ua());
                  var l3 = t4.zb.YO(u3.bc(), u3.xc());
                  f3 != 0 && (a3.ig(f3 * r3, 0), l3.Pc(a3)), h3.pc(l3, true);
                }
                c3.move(r3), ++f3;
              }
            }
          return h3 != null ? (s6 = t4.ua.bO(s6, h3), s6 = t4.ua.Gr(s6), t4.bu.gP(i5, h3, s6, n5)) : i5;
        }, s5.$N = function(t5, i5, n5, h3, r3) {
          return t5 >= n5 && i5 <= h3 ? 0 : s5.oE(0.5 * (i5 + t5), n5, h3, r3);
        }, s5.oE = function(i5, s6, n5, h3) {
          return t4.mc.round((0.5 * (n5 + s6) - i5) / h3) * h3;
        }, s5.QQ = function(i5, n5, h3, r3, e3, o3, a3, u3) {
          var f3 = s5.fv(r3, e3), c3 = f3.S(), l3 = c3 / 360, p3 = s5.kE * l3, v3 = i5.vb(0), y3 = n5.Xc(), b3 = y3 ? c3 / n5.Le().S() : 0;
          n5 = i5.Ja();
          for (var d3 = 0, g3 = h3.ea(); d3 < g3; ++d3) {
            var w3 = y3, x3 = new t4.Ua(h3.description);
            x3.addPath(h3, d3, true);
            var m3 = h3.ec(d3);
            a3 != 0 && (m3 = s5.KD(m3, x3, f3.H - u3, f3.H, a3)) && (w3 = false);
            var j3 = -1;
            m3 = x3.I();
            var M3 = false;
            w3 && (j3 = i5.Ca(d3), M3 = i5.ec(d3));
            var k3 = x3.vb(0), z3 = 0, A3 = k3.read(0), N3 = 0, I3 = 3 * r3.Yd(0), P3 = false, C3 = new t4.h();
            C3.Sc();
            var B3 = new t4.h();
            B3.Sc();
            for (var D3 = false, q3 = 1; q3 < m3; ++q3) {
              var G3 = t4.h.construct(k3.gg(2 * q3), k3.gg(2 * q3 + 1)), F3 = G3.x, T3 = F3 + z3, E3 = T3 - A3;
              if (G3.x = T3, Math.abs(E3) > p3) {
                if (w3) {
                  var S3 = j3 + q3 - 1, O3 = j3;
                  (!M3 || q3 + 1 < m3) && (O3 += q3), S3 = v3.read(2 * S3), O3 = (v3.read(2 * O3) - S3) * b3, Math.abs(E3 - O3) > 1 * l3 && (y3 = false);
                }
                w3 || (T3 = F3 + (z3 -= t4.mc.En(c3, T3 - A3)), ++N3, D3 = z3 != 0, G3.x = T3);
              } else
                P3 || t4.ua.vG(C3, B3, G3, I3) && (P3 = true);
              D3 && k3.write(2 * q3, T3), A3 = T3, C3.N(B3), B3.N(G3);
            }
            N3 != 0 && x3.Qc(1993), w3 = x3.Oa(0), m3 = x3.Oa(m3 - 1), t4.h.ub(w3, m3), x3 = s5.rQ(x3, r3, isNaN(e3) ? 0 : e3, o3), n5.add(x3, false);
          }
          return i5 = r3.Yd(0), h3 = f3.S() / 180, s5.Lt(n5, f3, 0.1 * i5, false), t4.ti.clip(n5, f3, i5, h3, o3);
        }, s5.rQ = function(t5, i5, n5, h3) {
          return s5.Hn(t5, i5, n5, true, 0, h3);
        }, s5.JS = function(i5, s6, n5, h3) {
          var r3 = i5.K();
          if (r3 == 1736)
            for (s6 = s6 != null ? s6.Yd(0) : 0, r3 = 0; r3 < h3; r3++)
              t4.jd.Zd(i5, n5[r3], s6) != 1 && n5[r3].Sc();
          else {
            if (r3 != 197)
              throw t4.i.O();
            for (r3 = 0; r3 < h3; r3++)
              i5.ZO(n5[r3]) || n5[r3].Sc();
          }
        }, s5.bl = function(i5, s6, n5, h3) {
          if (32 > n5)
            for (var r3 = new t4.Ta(), e3 = 0; e3 < n5; e3++)
              r3.Db(s6[e3]), i5.bl(r3, h3).D(s6[e3]);
          else {
            var o3 = new t4.ee();
            for (o3.se(3), o3.CD(s6, n5), r3 = o3.vb(3), e3 = 0; e3 < n5; e3++)
              r3.write(e3, e3);
            for (e3 = i5.bl(o3, h3), i5 = e3.vb(0), r3 = e3.vb(3), h3 = t4.h.construct(NaN, NaN), o3 = 0; o3 < n5; o3++)
              s6[o3] = h3;
            for (n5 = e3.I(), e3 = 0; e3 < n5; e3++)
              h3 = r3.read(e3), i5.uc(2 * e3, s6[h3]);
          }
        }, s5.al = function(i5, s6, n5, h3) {
          if (32 > n5)
            for (var r3 = new t4.Ta(), e3 = 0; e3 < n5; e3++)
              r3.Db(s6[e3]), i5.al(r3, h3).D(s6[e3]);
          else {
            var o3 = new t4.ee();
            for (o3.se(3), o3.CD(s6, n5), r3 = o3.vb(3), e3 = 0; e3 < n5; e3++)
              r3.write(e3, e3);
            for (e3 = i5.al(o3, h3), i5 = e3.vb(0), r3 = e3.vb(3), h3 = t4.h.construct(NaN, NaN), o3 = 0; o3 < n5; o3++)
              s6[o3] = h3;
            for (n5 = e3.I(), e3 = 0; e3 < n5; e3++)
              h3 = r3.read(e3), i5.uc(2 * e3, s6[h3]);
          }
        }, s5.kE = 210, s5;
      }();
    }(Q2 || (Q2 = {})), function(t4) {
      var i4;
      (i4 = t4.PL || (t4.PL = {}))[i4.rightSide = 1] = "rightSide";
      var s4 = function() {
        function i5(i6, s5, n4) {
          this.Ds = new t4.h(), i6 === void 0 ? this.Ko = -1 : (this.Ds.N(i6), this.Ko = s5, this.La = n4, this.pw = 0);
        }
        return i5.prototype.RJ = function(t5) {
          this.pw = t5 ? 1 | this.pw : -2 & this.pw;
        }, i5.prototype.B = function() {
          return 0 > this.Ko;
        }, i5.prototype.az = function() {
          if (this.B())
            throw t4.i.ga("invalid call");
          return new t4.Ta(this.Ds.x, this.Ds.y);
        }, i5.prototype.Va = function() {
          if (this.B())
            throw t4.i.ga("invalid call");
          return this.Ko;
        }, i5.prototype.cz = function() {
          if (this.B())
            throw t4.i.ga("invalid call");
          return this.La;
        }, i5.prototype.Nz = function() {
          return (1 & this.pw) != 0;
        }, i5.prototype.by = function(t5, i6, s5, n4) {
          this.Ds.x = t5, this.Ds.y = i6, this.Ko = s5, this.La = n4;
        }, i5;
      }();
      t4.bm = s4;
    }(Q2 || (Q2 = {})), function(t4) {
      var i4 = function() {
        function i5() {
        }
        return i5.prototype.Wo = function(i6, s5) {
          this.vh.resize(0), this.Ki.length = 0, this.vk = -1, i6.yc(this.Gk), this.Gk.X(s5, s5), this.Gk.isIntersecting(this.Gb.Da) ? ((this.xs = t4.ba.zd(i6.K())) ? (this.OH = i6.bc(), this.NH = i6.xc(), this.ra = s5) : this.ra = NaN, this.vh.add(this.Gb.kf), this.Ki.push(this.Gb.Da), this.Ss = this.Gb.Wr(this.Gb.kf)) : this.Ss = -1;
        }, i5.prototype.Zi = function(t5, i6) {
          this.vh.resize(0), this.Ki.length = 0, this.vk = -1, this.Gk.L(t5), this.Gk.X(i6, i6), this.ra = NaN, this.Gk.isIntersecting(this.Gb.Da) ? (this.vh.add(this.Gb.kf), this.Ki.push(this.Gb.Da), this.Ss = this.Gb.Wr(this.Gb.kf), this.xs = false) : this.Ss = -1;
        }, i5.prototype.next = function() {
          if (this.vh.size == 0)
            return -1;
          this.vk = this.Ss;
          var i6 = null, n4 = null, h3 = null, r3 = null;
          this.xs && (i6 = new t4.h(), n4 = new t4.h(), h3 = new t4.l());
          for (var e3 = false; !e3; ) {
            for (; this.vk != -1; ) {
              var o3 = this.Gb.Xy(this.Gb.hv(this.vk));
              if (o3.isIntersecting(this.Gk)) {
                if (!this.xs) {
                  e3 = true;
                  break;
                }
                if (i6.N(this.OH), n4.N(this.NH), h3.L(o3), h3.X(this.ra, this.ra), 0 < h3.uy(i6, n4)) {
                  e3 = true;
                  break;
                }
              }
              this.vk = this.Gb.pv(this.vk);
            }
            if (this.vk == -1) {
              o3 = this.vh.Gc();
              var a3 = this.Ki[this.Ki.length - 1];
              for (r3 == null && ((r3 = [])[0] = new t4.l(), r3[1] = new t4.l(), r3[2] = new t4.l(), r3[3] = new t4.l()), s4.zJ(a3, r3), this.vh.Jf(), --this.Ki.length, a3 = 0; 4 > a3; a3++) {
                var u3 = this.Gb.Np(o3, a3);
                if (u3 != -1 && 0 < this.Gb.RR(u3) && r3[a3].isIntersecting(this.Gk))
                  if (this.xs) {
                    if (i6.N(this.OH), n4.N(this.NH), h3.L(r3[a3]), h3.X(this.ra, this.ra), 0 < h3.uy(i6, n4)) {
                      var f3 = new t4.l();
                      f3.L(r3[a3]), this.vh.add(u3), this.Ki.push(f3);
                    }
                  } else
                    (f3 = new t4.l()).L(r3[a3]), this.vh.add(u3), this.Ki.push(f3);
              }
              if (this.vh.size == 0)
                return -1;
              this.vk = this.Gb.Wr(this.vh.get(this.vh.size - 1));
            }
          }
          return this.Ss = this.Gb.pv(this.vk), this.vk;
        }, i5.XO = function(s5, n4, h3) {
          var r3 = new i5();
          return r3.Gb = s5, r3.Gk = new t4.l(), r3.vh = new t4.ja(0), r3.Ki = [], r3.Wo(n4, h3), r3;
        }, i5.WO = function(s5, n4, h3) {
          var r3 = new i5();
          return r3.Gb = s5, r3.Gk = new t4.l(), r3.vh = new t4.ja(0), r3.Ki = [], r3.Zi(n4, h3), r3;
        }, i5.VO = function(s5) {
          var n4 = new i5();
          return n4.Gb = s5, n4.Gk = new t4.l(), n4.vh = new t4.ja(0), n4.Ki = [], n4;
        }, i5;
      }();
      t4.CY = i4;
      var s4 = function() {
        function s5(i5, s6) {
          this.jf = new t4.ad(11), this.ai = new t4.ad(5), this.ys = [], this.iw = new t4.ja(0), this.Da = new t4.l(), this.Pk(i5, s6);
        }
        return s5.prototype.reset = function(t5, i5) {
          this.jf.oj(false), this.ai.oj(false), this.ys.length = 0, this.iw.clear(false), this.Pk(t5, i5);
        }, s5.prototype.xj = function(t5, i5) {
          return this.Bv(t5, i5, 0, this.Da, this.kf, false, -1);
        }, s5.prototype.Ez = function(t5, i5, s6) {
          s6 = s6 == -1 ? this.kf : this.RF(s6);
          var n4 = this.da(s6), h3 = this.jR(s6);
          return this.Bv(t5, i5, n4, h3, s6, false, -1);
        }, s5.prototype.ka = function(t5) {
          return this.eR(t5);
        }, s5.prototype.BF = function(t5) {
          return this.Xy(this.hv(t5));
        }, s5.prototype.da = function(t5) {
          return this.lv(t5);
        }, s5.prototype.jR = function(i5) {
          var s6 = new t4.l();
          s6.L(this.Da);
          var n4 = this.lv(i5);
          i5 = this.LF(i5);
          for (var h3 = 0; h3 < 2 * n4; h3 += 2) {
            var r3 = t4.P.truncate(3 & i5 >> h3);
            r3 == 0 ? (s6.v = 0.5 * (s6.v + s6.C), s6.G = 0.5 * (s6.G + s6.H)) : r3 == 1 ? (s6.C = 0.5 * (s6.v + s6.C), s6.G = 0.5 * (s6.G + s6.H)) : (r3 == 2 ? s6.C = 0.5 * (s6.v + s6.C) : s6.v = 0.5 * (s6.v + s6.C), s6.H = 0.5 * (s6.G + s6.H));
          }
          return s6;
        }, s5.prototype.RR = function(t5) {
          return this.vz(t5);
        }, s5.prototype.qR = function(t5, s6) {
          return i4.XO(this, t5, s6);
        }, s5.prototype.HF = function(t5, s6) {
          return i4.WO(this, t5, s6);
        }, s5.prototype.getIterator = function() {
          return i4.VO(this);
        }, s5.prototype.Pk = function(i5, s6) {
          if (0 > s6 || 32 < 2 * s6)
            throw t4.i.O("invalid height");
          this.wT = s6, this.Da.L(i5), this.kf = this.jf.De(), this.jx(this.kf, 0), this.dx(this.kf, 0), this.IJ(this.kf, 0), this.FJ(this.kf, 0);
        }, s5.prototype.Bv = function(i5, n4, h3, r3, e3, o3, a3) {
          if (!r3.contains(n4))
            return h3 == 0 ? -1 : this.Bv(i5, n4, 0, this.Da, this.kf, o3, a3);
          if (!o3)
            for (var u3 = e3; u3 != -1; u3 = this.DR(u3))
              this.jx(u3, this.vz(u3) + 1);
          (u3 = new t4.l()).L(r3), r3 = e3;
          var f3 = [];
          for (f3[0] = new t4.l(), f3[1] = new t4.l(), f3[2] = new t4.l(), f3[3] = new t4.l(); h3 < this.wT && this.dO(r3); h3++) {
            s5.zJ(u3, f3);
            for (var c3 = false, l3 = 0; 4 > l3; l3++)
              if (f3[l3].contains(n4)) {
                c3 = true;
                var p3 = this.Np(r3, l3);
                p3 == -1 && (p3 = this.mP(r3, l3)), this.jx(p3, this.vz(p3) + 1), r3 = p3, u3.L(f3[l3]);
                break;
              }
            if (!c3)
              break;
          }
          return this.nS(i5, n4, h3, u3, r3, o3, e3, a3);
        }, s5.prototype.nS = function(t5, i5, s6, n4, h3, r3, e3, o3) {
          var a3 = this.IF(h3);
          if (r3) {
            if (h3 == e3)
              return o3;
            this.NP(o3), r3 = o3;
          } else
            r3 = this.oP(), this.IB(r3, t5), this.FW(this.hv(r3), i5);
          return this.hX(r3, h3), a3 != -1 ? (this.hx(r3, a3), this.ex(a3, r3)) : this.BJ(h3, r3), this.NB(h3, r3), this.dx(h3, this.nv(h3) + 1), this.cO(h3) && this.HQ(s6, n4, h3), r3;
        }, s5.prototype.NP = function(t5) {
          var i5 = this.RF(t5), s6 = this.IF(i5), n4 = this.JR(t5), h3 = this.pv(t5);
          this.Wr(i5) == t5 ? (h3 != -1 ? this.hx(h3, -1) : this.NB(i5, -1), this.BJ(i5, h3)) : s6 == t5 ? (this.ex(n4, -1), this.NB(i5, n4)) : (this.hx(h3, n4), this.ex(n4, h3)), this.hx(t5, -1), this.ex(t5, -1), this.dx(i5, this.nv(i5) - 1);
        }, s5.zJ = function(t5, i5) {
          var s6 = 0.5 * (t5.v + t5.C), n4 = 0.5 * (t5.G + t5.H);
          i5[0].L(s6, n4, t5.C, t5.H), i5[1].L(t5.v, n4, s6, t5.H), i5[2].L(t5.v, t5.G, s6, n4), i5[3].L(s6, t5.G, t5.C, n4);
        }, s5.prototype.cO = function(t5) {
          return this.nv(t5) == 8 && !this.bG(t5);
        }, s5.prototype.HQ = function(t5, i5, s6) {
          var n4 = this.Wr(s6);
          do {
            var h3 = this.hv(n4), r3 = this.ai.U(n4, 0);
            h3 = this.Xy(h3), this.Bv(r3, h3, t5, i5, s6, true, n4), n4 = r3 = this.pv(n4);
          } while (n4 != -1);
        }, s5.prototype.dO = function(t5) {
          return 8 <= this.nv(t5) || this.bG(t5);
        }, s5.prototype.bG = function(t5) {
          return this.Np(t5, 0) != -1 || this.Np(t5, 1) != -1 || this.Np(t5, 2) != -1 || this.Np(t5, 3) != -1;
        }, s5.prototype.mP = function(t5, i5) {
          var s6 = this.jf.De();
          return this.JW(t5, i5, s6), this.jx(s6, 0), this.dx(s6, 0), this.Rk(s6, t5), this.FJ(s6, this.lv(t5) + 1), this.IJ(s6, i5 << 2 * this.lv(t5) | this.LF(t5)), s6;
        }, s5.prototype.oP = function() {
          var i5 = this.ai.De();
          if (0 < this.iw.size) {
            var s6 = this.iw.Gc();
            this.iw.Jf();
          } else
            s6 = this.ys.length, this.ys.push(new t4.l());
          return this.GW(i5, s6), i5;
        }, s5.prototype.Np = function(t5, i5) {
          return this.jf.U(t5, i5);
        }, s5.prototype.JW = function(t5, i5, s6) {
          this.jf.T(t5, i5, s6);
        }, s5.prototype.Wr = function(t5) {
          return this.jf.U(t5, 4);
        }, s5.prototype.BJ = function(t5, i5) {
          this.jf.T(t5, 4, i5);
        }, s5.prototype.IF = function(t5) {
          return this.jf.U(t5, 5);
        }, s5.prototype.NB = function(t5, i5) {
          this.jf.T(t5, 5, i5);
        }, s5.prototype.LF = function(t5) {
          return this.jf.U(t5, 6);
        }, s5.prototype.IJ = function(t5, i5) {
          this.jf.T(t5, 6, i5);
        }, s5.prototype.nv = function(t5) {
          return this.jf.U(t5, 7);
        }, s5.prototype.vz = function(t5) {
          return this.jf.U(t5, 8);
        }, s5.prototype.dx = function(t5, i5) {
          this.jf.T(t5, 7, i5);
        }, s5.prototype.jx = function(t5, i5) {
          this.jf.T(t5, 8, i5);
        }, s5.prototype.DR = function(t5) {
          return this.jf.U(t5, 9);
        }, s5.prototype.Rk = function(t5, i5) {
          this.jf.T(t5, 9, i5);
        }, s5.prototype.lv = function(t5) {
          return this.jf.U(t5, 10);
        }, s5.prototype.FJ = function(t5, i5) {
          this.jf.T(t5, 10, i5);
        }, s5.prototype.eR = function(t5) {
          return this.ai.U(t5, 0);
        }, s5.prototype.IB = function(t5, i5) {
          this.ai.T(t5, 0, i5);
        }, s5.prototype.JR = function(t5) {
          return this.ai.U(t5, 1);
        }, s5.prototype.pv = function(t5) {
          return this.ai.U(t5, 2);
        }, s5.prototype.hx = function(t5, i5) {
          this.ai.T(t5, 1, i5);
        }, s5.prototype.ex = function(t5, i5) {
          this.ai.T(t5, 2, i5);
        }, s5.prototype.RF = function(t5) {
          return this.ai.U(t5, 3);
        }, s5.prototype.hX = function(t5, i5) {
          this.ai.T(t5, 3, i5);
        }, s5.prototype.hv = function(t5) {
          return this.ai.U(t5, 4);
        }, s5.prototype.GW = function(t5, i5) {
          this.ai.T(t5, 4, i5);
        }, s5.prototype.Xy = function(t5) {
          return this.ys[t5];
        }, s5.prototype.FW = function(t5, i5) {
          this.ys[t5].L(i5);
        }, s5;
      }();
      t4.fu = s4;
    }(Q2 || (Q2 = {})), function(t4) {
      var i4;
      (i4 = t4.WK || (t4.WK = {}))[i4.Outside = 0] = "Outside", i4[i4.Inside = 1] = "Inside", i4[i4.Border = 2] = "Border";
      var s4 = function() {
        function t5(t6, i5) {
          this.KT = i5, this.Xh = t6;
        }
        return t5.prototype.ax = function(t6, i5) {
          this.dH != i5 && t6.flush(), this.dH = i5;
        }, t5.prototype.bF = function(t6, i5) {
          for (var s5 = 0; s5 < i5; )
            for (var n5 = t6[s5++], h3 = t6[s5++], r3 = t6[s5++] * this.KT; n5 < h3; n5++)
              this.Xh[r3 + (n5 >> 4)] |= this.dH << 2 * (15 & n5);
        }, t5;
      }();
      t4.DY = s4;
      var n4 = function() {
        function i5(t5, i6, s5) {
          this.Xh = null, this.NA = this.Kk = this.YH = this.WH = this.Gs = this.lH = this.Hf = this.Wm = 0, this.Ti = this.Lk = this.xl = null, this.Az(t5, i6, s5);
        }
        return i5.create = function(s5, n5, h3) {
          if (!i5.uE(s5))
            throw t4.i.O();
          return i5.rP(s5, n5, h3);
        }, i5.kW = function(i6) {
          switch (i6) {
            case 0:
              i6 = 1024;
              break;
            case 1:
              i6 = 16384;
              break;
            case 2:
              i6 = 262144;
              break;
            default:
              throw t4.i.ga("Internal Error");
          }
          return i6;
        }, i5.uE = function(t5) {
          return !(t5.B() || t5.K() != 1607 && t5.K() != 1736);
        }, i5.prototype.mQ = function(i6, s5) {
          s5 = s5.Ha();
          for (var n5 = new t4.h(), h3 = new t4.h(); s5.ab(); )
            for (; s5.Ia(); ) {
              var r3 = s5.ia();
              if (r3.K() != 322)
                throw t4.i.ga("Internal Error");
              i6.Gh(r3.bc(), n5), i6.Gh(r3.xc(), h3), this.Ti.fy(n5.x, n5.y, h3.x, h3.y);
            }
          this.Ti.dJ(t4.Ox.Bx);
        }, i5.prototype.nQ = function() {
          throw t4.i.ga("Internal Error");
        }, i5.prototype.My = function(i6, s5) {
          for (var n5 = 1; 4 > n5; n5++)
            i6.fy(s5[n5 - 1].x, s5[n5 - 1].y, s5[n5].x, s5[n5].y);
          i6.fy(s5[3].x, s5[3].y, s5[0].x, s5[0].y), this.Ti.dJ(t4.Ox.Bx);
        }, i5.prototype.mK = function(i6, s5, n5) {
          for (var h3 = [null, null, null, null], r3 = 0; r3 < h3.length; r3++)
            h3[r3] = new t4.h();
          s5 = s5.Ha(), n5 = this.Lk.$X(n5) + 1.5, r3 = new t4.h();
          for (var e3 = new t4.h(), o3 = new t4.h(), a3 = new t4.h(), u3 = new t4.h(), f3 = new t4.l(), c3 = new t4.h(); s5.ab(); ) {
            var l3 = false, p3 = true;
            for (c3.na(0, 0); s5.Ia(); ) {
              var v3 = s5.ia();
              if (a3.x = v3.ta, a3.y = v3.oa, u3.x = v3.qa, u3.y = v3.ma, f3.Pa(), f3.$b(a3.x, a3.y), f3.Nk(u3.x, u3.y), this.xl.CG(f3)) {
                this.Lk.Gh(u3, u3), p3 ? (this.Lk.Gh(a3, a3), c3.N(a3), p3 = false) : a3.N(c3), r3.vc(u3, a3);
                var y3 = 0.5 > (v3 = r3.length());
                v3 == 0 ? r3.na(1, 0) : (y3 || c3.N(u3), r3.scale(n5 / v3), e3.na(-r3.y, r3.x), o3.na(r3.y, -r3.x), a3.sub(r3), u3.add(r3), h3[0].add(a3, e3), h3[1].add(a3, o3), h3[2].add(u3, o3), h3[3].add(u3, e3), y3 ? l3 = true : this.My(i6, h3));
              } else
                l3 && (this.My(i6, h3), l3 = false), p3 = true;
            }
            l3 && this.My(i6, h3);
          }
        }, i5.prototype.nC = function(i6) {
          return t4.P.truncate(i6 * this.lH + this.WH);
        }, i5.prototype.oC = function(i6) {
          return t4.P.truncate(i6 * this.Gs + this.YH);
        }, i5.rP = function(t5, s5, n5) {
          return new i5(t5, s5, n5);
        }, i5.prototype.Az = function(i6, n5, h3) {
          this.Hf = Math.max(t4.P.truncate(2 * Math.sqrt(h3) + 0.5), 64), this.Wm = t4.P.truncate((2 * this.Hf + 31) / 32), this.xl = new t4.l(), this.Kk = n5, h3 = 0;
          for (var r3 = this.Hf, e3 = this.Wm; 8 <= r3; )
            h3 += r3 * e3, r3 = t4.P.truncate(r3 / 2), e3 = t4.P.truncate((2 * r3 + 31) / 32);
          this.Xh = t4.P.mg(h3, 0), this.Ti = new t4.Ox(), h3 = new s4(this.Xh, this.Wm, this), this.Ti.wX(this.Hf, this.Hf, h3), i6.A(this.xl), this.xl.X(n5, n5), r3 = new t4.l();
          var o3 = n5 * (e3 = t4.l.construct(1, 1, this.Hf - 2, this.Hf - 2)).S();
          switch (n5 *= e3.da(), r3.L(this.xl.tf(), Math.max(o3, this.xl.S()), Math.max(n5, this.xl.da())), this.NA = this.Kk, this.Lk = new t4.Ed(), this.Lk.kS(r3, e3), new t4.Ed(), i6.K()) {
            case 550:
              h3.ax(this.Ti, 2), this.nQ();
              break;
            case 1607:
              h3.ax(this.Ti, 2), this.mK(this.Ti, i6, this.NA);
              break;
            case 1736:
              h3.ax(this.Ti, 1), this.mQ(this.Lk, i6), h3.ax(this.Ti, 2), this.mK(this.Ti, i6, this.NA);
          }
          this.lH = this.Lk.eb, this.Gs = this.Lk.bb, this.WH = this.Lk.Lb, this.YH = this.Lk.Qb, this.SN();
        }, i5.prototype.SN = function() {
          this.Ti.flush();
          for (var i6 = 0, s5 = this.Hf * this.Wm, n5 = this.Hf, h3 = t4.P.truncate(this.Hf / 2), r3 = this.Wm, e3 = t4.P.truncate((2 * h3 + 31) / 32); 8 < n5; ) {
            for (n5 = 0; n5 < h3; n5++)
              for (var o3 = 2 * n5, a3 = 2 * n5 + 1, u3 = 0; u3 < h3; u3++) {
                var f3 = 2 * u3, c3 = 2 * u3 + 1, l3 = f3 >> 4;
                f3 = 2 * (15 & f3);
                var p3 = c3 >> 4;
                c3 = 2 * (15 & c3);
                var v3 = this.Xh[i6 + r3 * o3 + l3] >> f3 & 3;
                v3 |= this.Xh[i6 + r3 * o3 + p3] >> c3 & 3, v3 |= this.Xh[i6 + r3 * a3 + l3] >> f3 & 3, v3 |= this.Xh[i6 + r3 * a3 + p3] >> c3 & 3, this.Xh[s5 + e3 * n5 + (u3 >> 4)] |= v3 << 2 * (15 & u3);
              }
            n5 = h3, r3 = e3, i6 = s5, h3 = t4.P.truncate(n5 / 2), e3 = t4.P.truncate((2 * h3 + 31) / 32), s5 = i6 + r3 * n5;
          }
        }, i5.prototype.Uo = function(t5, i6) {
          return this.xl.contains(t5, i6) ? (t5 = this.nC(t5), i6 = this.oC(i6), 0 > t5 || t5 >= this.Hf || 0 > i6 || i6 >= this.Hf || (i6 = this.Xh[this.Wm * i6 + (t5 >> 4)] >> 2 * (15 & t5) & 3) == 0 ? 0 : i6 == 1 ? 1 : 2) : 0;
        }, i5.prototype.To = function(i6) {
          if (!i6.Fa(this.xl))
            return 0;
          var s5 = this.nC(i6.v), n5 = this.nC(i6.C), h3 = this.oC(i6.G);
          if (i6 = this.oC(i6.H), 0 > s5 && (s5 = 0), 0 > h3 && (h3 = 0), n5 >= this.Hf && (n5 = this.Hf - 1), i6 >= this.Hf && (i6 = this.Hf - 1), s5 > n5 || h3 > i6)
            return 0;
          for (var r3 = Math.max(n5 - s5, 1) * Math.max(i6 - h3, 1), e3 = 0, o3 = this.Wm, a3 = this.Hf, u3 = 0; ; ) {
            if (32 > r3 || 16 > a3) {
              for (r3 = h3; r3 <= i6; r3++)
                for (var f3 = s5; f3 <= n5; f3++)
                  if (1 < (u3 = this.Xh[e3 + o3 * r3 + (f3 >> 4)] >> 2 * (15 & f3) & 3))
                    return 2;
              if (u3 == 0)
                return 0;
              if (u3 == 1)
                return 1;
            }
            e3 += o3 * a3, a3 = t4.P.truncate(a3 / 2), o3 = t4.P.truncate((2 * a3 + 31) / 32), s5 = t4.P.truncate(s5 / 2), h3 = t4.P.truncate(h3 / 2), n5 = t4.P.truncate(n5 / 2), i6 = t4.P.truncate(i6 / 2), r3 = Math.max(n5 - s5, 1) * Math.max(i6 - h3, 1);
          }
        }, i5.prototype.MR = function() {
          return this.Hf * this.Wm;
        }, i5;
      }();
      t4.Mx = n4;
    }(Q2 || (Q2 = {})), function(t4) {
      var i4;
      (i4 = t4.QL || (t4.QL = {}))[i4.contains = 1] = "contains", i4[i4.within = 2] = "within", i4[i4.equals = 3] = "equals", i4[i4.disjoint = 4] = "disjoint", i4[i4.touches = 8] = "touches", i4[i4.crosses = 16] = "crosses", i4[i4.overlaps = 32] = "overlaps", i4[i4.unknown = 0] = "unknown", i4[i4.intersects = 1073741824] = "intersects";
      var s4 = function() {
        function t5() {
        }
        return t5.construct = function(i5, s5, n5, h3, r3, e3, o3, a3) {
          var u3 = new t5();
          return u3.rw = i5, u3.Om = s5, u3.Mj = n5, u3.Ui = h3, u3.wH = r3, u3.OY = e3, u3.PY = o3, u3.QY = a3, u3;
        }, t5;
      }();
      t4.Xt = function() {
        function i5() {
        }
        return i5.xD = function(s5, n5, h3) {
          if (i5.ry(s5)) {
            var r3 = t4.ua.mj(n5, s5, false);
            n5 = false, t4.Wk.xE(s5) && (n5 = n5 || s5.nu(r3, h3)), (r3 = s5.K()) != 1736 && r3 != 1607 || !t4.Wk.vE(s5) || h3 == 0 || (n5 = n5 || s5.hj(h3)), r3 != 1736 && r3 != 1607 || !t4.Wk.wE(s5) || h3 == 0 || n5 || s5.cM();
          }
        }, i5.ry = function(i6) {
          return t4.Wk.xE(i6) || t4.Wk.vE(i6) || t4.Wk.wE(i6);
        }, i5;
      }();
      var n4 = function() {
        function i5() {
          this.th = [];
        }
        return i5.uB = function(s5, n5, h3, r3, e3) {
          var o3 = s5.K(), a3 = n5.K();
          if (o3 == 197) {
            if (a3 == 197)
              return i5.oW(s5, n5, h3, r3);
            if (a3 == 33)
              return r3 == 2 ? r3 = 1 : r3 == 1 && (r3 = 2), i5.cJ(n5, s5, h3, r3);
          } else if (o3 == 33) {
            if (a3 == 197)
              return i5.cJ(s5, n5, h3, r3);
            if (a3 == 33)
              return i5.qW(s5, n5, h3, r3);
          }
          if (s5.B() || n5.B())
            return r3 == 4;
          var u3 = new t4.l();
          s5.A(u3);
          var f3 = new t4.l();
          n5.A(f3);
          var c3 = new t4.l();
          if (c3.L(u3), c3.$b(f3), h3 = t4.ua.Xd(h3, c3, false), i5.fk(u3, f3, h3))
            return r3 == 4;
          switch (u3 = false, t4.Xk.zd(o3) && ((o3 = new t4.Ua(s5.description)).pc(s5, true), s5 = o3, o3 = 1607), t4.Xk.zd(a3) && ((a3 = new t4.Ua(n5.description)).pc(n5, true), n5 = a3, a3 = 1607), o3 != 197 && a3 != 197 ? (s5.Eb() < n5.Eb() || o3 == 33 && a3 == 550) && (r3 == 2 ? r3 = 1 : r3 == 1 && (r3 = 2)) : o3 != 1736 && a3 != 197 && (r3 == 2 ? r3 = 1 : r3 == 1 && (r3 = 2)), o3) {
            case 1736:
              switch (a3) {
                case 1736:
                  u3 = i5.st(s5, n5, h3, r3, e3);
                  break;
                case 1607:
                  u3 = i5.bn(s5, n5, h3, r3, e3);
                  break;
                case 33:
                  u3 = i5.rt(s5, n5, h3, r3);
                  break;
                case 550:
                  u3 = i5.qt(s5, n5, h3, r3, e3);
                  break;
                case 197:
                  u3 = i5.BI(s5, n5, h3, r3, e3);
              }
              break;
            case 1607:
              switch (a3) {
                case 1736:
                  u3 = i5.bn(n5, s5, h3, r3, e3);
                  break;
                case 1607:
                  u3 = i5.bB(s5, n5, h3, r3, e3);
                  break;
                case 33:
                  u3 = i5.ut(s5, n5, h3, r3, e3);
                  break;
                case 550:
                  u3 = i5.tt(s5, n5, h3, r3, e3);
                  break;
                case 197:
                  u3 = i5.HI(s5, n5, h3, r3);
              }
              break;
            case 33:
              switch (a3) {
                case 1736:
                  u3 = i5.rt(n5, s5, h3, r3);
                  break;
                case 1607:
                  u3 = i5.ut(n5, s5, h3, r3, e3);
                  break;
                case 550:
                  u3 = i5.mt(n5, s5, h3, r3);
              }
              break;
            case 550:
              switch (a3) {
                case 1736:
                  u3 = i5.qt(n5, s5, h3, r3, e3);
                  break;
                case 1607:
                  u3 = i5.tt(n5, s5, h3, r3, e3);
                  break;
                case 550:
                  u3 = i5.UA(s5, n5, h3, r3, e3);
                  break;
                case 33:
                  u3 = i5.mt(s5, n5, h3, r3);
                  break;
                case 197:
                  u3 = i5.cI(s5, n5, h3, r3);
              }
              break;
            case 197:
              switch (a3) {
                case 1736:
                  u3 = i5.BI(n5, s5, h3, r3, e3);
                  break;
                case 1607:
                  u3 = i5.HI(n5, s5, h3, r3);
                  break;
                case 550:
                  u3 = i5.cI(n5, s5, h3, r3);
              }
          }
          return u3;
        }, i5.oW = function(s5, n5, h3, r3) {
          if (s5.B() || n5.B())
            return r3 == 4;
          var e3 = new t4.l(), o3 = new t4.l(), a3 = new t4.l();
          switch (s5.A(e3), n5.A(o3), a3.L(e3), a3.$b(o3), s5 = t4.ua.Xd(h3, a3, false), r3) {
            case 4:
              return i5.fk(e3, o3, s5);
            case 2:
              return i5.eF(o3, e3, s5);
            case 1:
              return i5.eF(e3, o3, s5);
            case 3:
              return i5.gk(e3, o3, s5);
            case 8:
              return i5.YP(e3, o3, s5);
            case 32:
              return i5.XP(e3, o3, s5);
            case 16:
              return i5.WP(e3, o3, s5);
          }
          return false;
        }, i5.cJ = function(s5, n5, h3, r3) {
          if (s5.B() || n5.B())
            return r3 == 4;
          s5 = s5.D();
          var e3 = new t4.l(), o3 = new t4.l();
          switch (n5.A(e3), o3.L(s5), o3.$b(e3), n5 = t4.ua.Xd(h3, o3, false), r3) {
            case 4:
              return i5.Tw(s5, e3, n5);
            case 2:
              return i5.$A(s5, e3, n5);
            case 1:
              return i5.MU(s5, e3, n5);
            case 3:
              return i5.qI(s5, e3, n5);
            case 8:
              return i5.ZA(s5, e3, n5);
          }
          return false;
        }, i5.qW = function(s5, n5, h3, r3) {
          if (s5.B() || n5.B())
            return r3 == 4;
          s5 = s5.D(), n5 = n5.D();
          var e3 = new t4.l();
          switch (e3.L(s5), e3.$b(n5), h3 = t4.ua.Xd(h3, e3, false), r3) {
            case 4:
              return i5.NU(s5, n5, h3);
            case 2:
              return i5.pI(n5, s5, h3);
            case 1:
              return i5.pI(s5, n5, h3);
            case 3:
              return i5.rI(s5, n5, h3);
          }
          return false;
        }, i5.st = function(t5, s5, n5, h3, r3) {
          switch (h3) {
            case 4:
              return i5.fV(t5, s5, n5);
            case 2:
              return i5.Uw(s5, t5, n5, r3);
            case 1:
              return i5.Uw(t5, s5, n5, r3);
            case 3:
              return i5.iV(t5, s5, n5);
            case 8:
              return i5.qV(t5, s5, n5);
            case 32:
              return i5.lV(t5, s5, n5, r3);
          }
          return false;
        }, i5.bn = function(t5, s5, n5, h3, r3) {
          switch (h3) {
            case 4:
              return i5.gV(t5, s5, n5);
            case 1:
              return i5.aB(t5, s5, n5, r3);
            case 8:
              return i5.rV(t5, s5, n5, r3);
            case 16:
              return i5.bV(t5, s5, n5);
          }
          return false;
        }, i5.rt = function(t5, s5, n5, h3) {
          switch (h3) {
            case 4:
              return i5.eV(t5, s5, n5);
            case 1:
              return i5.ZU(t5, s5, n5);
            case 8:
              return i5.pV(t5, s5, n5);
          }
          return false;
        }, i5.qt = function(t5, s5, n5, h3) {
          switch (h3) {
            case 4:
              return i5.dV(t5, s5, n5);
            case 1:
              return i5.YU(t5, s5, n5);
            case 8:
              return i5.oV(t5, s5, n5);
            case 16:
              return i5.aV(t5, s5, n5);
          }
          return false;
        }, i5.BI = function(t5, s5, n5, h3, r3) {
          if (i5.cV(t5, s5, n5))
            return h3 == 4;
          if (h3 == 4)
            return false;
          switch (h3) {
            case 2:
              return i5.sV(t5, s5, n5);
            case 1:
              return i5.XU(t5, s5, n5);
            case 3:
              return i5.hV(t5, s5, n5);
            case 8:
              return i5.nV(t5, s5, n5, r3);
            case 32:
              return i5.kV(t5, s5, n5, r3);
            case 16:
              return i5.$U(t5, s5, n5, r3);
          }
          return false;
        }, i5.bB = function(t5, s5, n5, h3) {
          switch (h3) {
            case 4:
              return i5.BV(t5, s5, n5);
            case 2:
              return i5.FI(s5, t5, n5);
            case 1:
              return i5.FI(t5, s5, n5);
            case 3:
              return i5.DV(t5, s5, n5);
            case 8:
              return i5.II(t5, s5, n5);
            case 32:
              return i5.HV(t5, s5, n5);
            case 16:
              return i5.GI(t5, s5, n5);
          }
          return false;
        }, i5.ut = function(t5, s5, n5, h3) {
          switch (h3) {
            case 4:
              return i5.AV(t5, s5, n5);
            case 1:
              return i5.vV(t5, s5, n5);
            case 8:
              return i5.LV(t5, s5, n5);
          }
          return false;
        }, i5.tt = function(t5, s5, n5, h3) {
          switch (h3) {
            case 4:
              return i5.zV(t5, s5, n5);
            case 1:
              return i5.uV(t5, s5, n5);
            case 8:
              return i5.KV(t5, s5, n5);
            case 16:
              return i5.xV(t5, s5, n5);
          }
          return false;
        }, i5.HI = function(t5, s5, n5, h3) {
          if (i5.yV(t5, s5, n5))
            return h3 == 4;
          if (h3 == 4)
            return false;
          switch (h3) {
            case 2:
              return i5.MV(t5, s5, n5);
            case 1:
              return i5.tV(t5, s5, n5);
            case 3:
              return i5.CV(t5, s5, n5);
            case 8:
              return i5.JV(t5, s5, n5);
            case 32:
              return i5.GV(t5, s5, n5);
            case 16:
              return i5.wV(t5, s5, n5);
          }
          return false;
        }, i5.UA = function(t5, s5, n5, h3) {
          switch (h3) {
            case 4:
              return i5.bU(t5, s5, n5);
            case 2:
              return i5.$H(s5, t5, n5);
            case 1:
              return i5.$H(t5, s5, n5);
            case 3:
              return i5.dU(t5, s5, n5);
            case 32:
              return i5.jU(t5, s5, n5);
          }
          return false;
        }, i5.mt = function(t5, s5, n5, h3) {
          switch (h3) {
            case 4:
              return i5.aI(t5, s5, n5);
            case 2:
              return i5.nU(t5, s5, n5);
            case 1:
              return i5.ZT(t5, s5, n5);
            case 3:
              return i5.Pw(t5, s5, n5);
          }
          return false;
        }, i5.cI = function(t5, s5, n5, h3) {
          switch (h3) {
            case 4:
              return i5.aU(t5, s5, n5);
            case 2:
              return i5.mU(t5, s5, n5);
            case 1:
              return i5.YT(t5, s5, n5);
            case 3:
              return i5.cU(t5, s5, n5);
            case 8:
              return i5.lU(t5, s5, n5);
            case 16:
              return i5.$T(t5, s5, n5);
          }
          return false;
        }, i5.iV = function(s5, n5, h3) {
          var r3 = new t4.l(), e3 = new t4.l();
          return s5.A(r3), n5.A(e3), !!i5.gk(r3, e3, h3) && ((r3 = i5.rc(s5, n5, false)) != 4 && r3 != 1 && r3 != 2 && (!!i5.ZH(s5, n5, h3) || (r3 = s5.Rb(), e3 = n5.Rb(), !(Math.abs(r3 - e3) > 4 * Math.max(s5.I(), n5.I()) * h3) && i5.Rz(s5, n5, h3, true))));
        }, i5.fV = function(t5, s5, n5) {
          var h3 = i5.rc(t5, s5, true);
          return h3 == 4 || h3 != 1 && h3 != 2 && h3 != 1073741824 && i5.zI(t5, s5, n5);
        }, i5.qV = function(t5, s5, n5) {
          var h3 = i5.rc(t5, s5, false);
          return h3 != 4 && h3 != 1 && h3 != 2 && i5.DI(t5, s5, n5, null);
        }, i5.lV = function(t5, s5, n5, h3) {
          var r3 = i5.rc(t5, s5, false);
          return r3 != 4 && r3 != 1 && r3 != 2 && i5.AI(t5, s5, n5, h3);
        }, i5.Uw = function(s5, n5, h3, r3) {
          var e3 = new t4.l(), o3 = new t4.l();
          return s5.A(e3), n5.A(o3), !!i5.Ac(e3, o3, h3) && ((e3 = i5.rc(s5, n5, false)) != 4 && e3 != 2 && (e3 == 1 || i5.wI(s5, n5, h3, r3)));
        }, i5.gV = function(t5, s5, n5) {
          var h3 = i5.rc(t5, s5, true);
          return h3 == 4 || h3 != 1 && h3 != 1073741824 && i5.zI(t5, s5, n5);
        }, i5.rV = function(t5, s5, n5, h3) {
          var r3 = i5.rc(t5, s5, false);
          return r3 != 4 && r3 != 1 && i5.EI(t5, s5, n5, h3);
        }, i5.bV = function(t5, s5, n5) {
          var h3 = i5.rc(t5, s5, false);
          return h3 != 4 && h3 != 1 && i5.yI(t5, s5, n5, null);
        }, i5.aB = function(s5, n5, h3, r3) {
          var e3 = new t4.l(), o3 = new t4.l();
          return s5.A(e3), n5.A(o3), !!i5.Ac(e3, o3, h3) && ((e3 = i5.rc(s5, n5, false)) != 4 && (e3 == 1 || i5.xI(s5, n5, h3, r3)));
        }, i5.eV = function(i6, s5, n5) {
          return t4.jd.FG(i6, s5, n5) == 0;
        }, i5.pV = function(t5, s5, n5) {
          return s5 = s5.D(), i5.CI(t5, s5, n5);
        }, i5.ZU = function(t5, s5, n5) {
          return s5 = s5.D(), i5.vI(t5, s5, n5);
        }, i5.dV = function(s5, n5, h3) {
          var r3 = i5.rc(s5, n5, false);
          if (r3 == 4)
            return true;
          if (r3 == 1)
            return false;
          r3 = new t4.l(), s5.A(r3), r3.X(h3, h3);
          for (var e3 = new t4.h(), o3 = 0; o3 < n5.I(); o3++)
            if (n5.D(o3, e3), r3.contains(e3)) {
              var a3 = t4.jd.Zd(s5, e3, h3);
              if (a3 == 1 || a3 == 2)
                return false;
            }
          return true;
        }, i5.oV = function(i6, s5, n5) {
          var h3 = this.rc(i6, s5, false);
          if (h3 == 4 || h3 == 1)
            return false;
          h3 = new t4.l(), i6.A(h3), h3.X(n5, n5);
          for (var r3 = false, e3 = i6, o3 = false, a3 = 0; a3 < s5.I(); a3++) {
            var u3 = s5.Oa(a3);
            if (h3.contains(u3)) {
              if ((u3 = t4.jd.Zd(e3, u3, n5)) == 2)
                r3 = true;
              else if (u3 == 1)
                return false;
            }
            o3 || (!t4.Fg.Ol(i6, s5.I() - 1) || i6.Cb != null && i6.Cb.Gb != null ? e3 = i6 : (e3 = new t4.Ea(), i6.copyTo(e3), e3.hj(1)), o3 = true);
          }
          return !!r3;
        }, i5.aV = function(i6, s5, n5) {
          var h3 = this.rc(i6, s5, false);
          if (h3 == 4 || h3 == 1)
            return false;
          var r3 = new t4.l();
          h3 = new t4.l();
          var e3 = new t4.l();
          i6.A(r3), s5.A(e3), h3.L(r3), h3.X(n5, n5), e3 = r3 = false;
          for (var o3 = i6, a3 = false, u3 = 0; u3 < s5.I(); u3++) {
            var f3 = s5.Oa(u3);
            if (h3.contains(f3) ? (f3 = t4.jd.Zd(o3, f3, n5)) == 0 ? e3 = true : f3 == 1 && (r3 = true) : e3 = true, r3 && e3)
              return true;
            a3 || (!t4.Fg.Ol(i6, s5.I() - 1) || i6.Cb != null && i6.Cb.Gb != null ? o3 = i6 : (o3 = new t4.Ea(), i6.copyTo(o3), o3.hj(1)), a3 = true);
          }
          return false;
        }, i5.YU = function(i6, s5, n5) {
          var h3 = new t4.l(), r3 = new t4.l();
          if (i6.A(h3), s5.A(r3), !this.Ac(h3, r3, n5))
            return false;
          if ((r3 = this.rc(i6, s5, false)) == 4)
            return false;
          if (r3 == 1)
            return true;
          r3 = false;
          for (var e3 = i6, o3 = false, a3 = 0; a3 < s5.I(); a3++) {
            var u3 = s5.Oa(a3);
            if (!h3.contains(u3))
              return false;
            if ((u3 = t4.jd.Zd(e3, u3, n5)) == 1)
              r3 = true;
            else if (u3 == 0)
              return false;
            o3 || (!t4.Fg.Ol(i6, s5.I() - 1) || i6.Cb != null && i6.Cb.Gb != null ? e3 = i6 : (e3 = new t4.Ea(), i6.copyTo(e3), e3.hj(1)), o3 = true);
          }
          return r3;
        }, i5.hV = function(s5, n5, h3) {
          var r3 = new t4.l(), e3 = new t4.l();
          return s5.A(r3), n5.A(e3), !!i5.gk(r3, e3, h3) && ((r3 = new t4.Ea()).bd(n5, false), i5.Rz(s5, r3, h3, true));
        }, i5.cV = function(s5, n5, h3) {
          var r3 = i5.rc(s5, n5, false);
          if (r3 == 4)
            return true;
          if (r3 == 1 || r3 == 2)
            return false;
          var e3 = new t4.l();
          if (r3 = new t4.l(), s5.A(e3), n5.A(r3), i5.Ac(r3, e3, h3))
            return false;
          if (e3 = new t4.h(), r3.fn(e3), (n5 = t4.jd.Zd(s5, e3, h3)) != 0)
            return false;
          if (r3.VI(e3), (n5 = t4.jd.Zd(s5, e3, h3)) != 0)
            return false;
          if (r3.gn(e3), (n5 = t4.jd.Zd(s5, e3, h3)) != 0)
            return false;
          if (r3.YI(e3), (n5 = t4.jd.Zd(s5, e3, h3)) != 0)
            return false;
          n5 = s5.vb(0), (e3 = new t4.l()).L(r3), e3.X(h3, h3);
          for (var o3 = 0, a3 = s5.I(); o3 < a3; o3++) {
            var u3 = n5.read(2 * o3), f3 = n5.read(2 * o3 + 1);
            if (e3.contains(u3, f3))
              return false;
          }
          return !i5.NG(s5, r3, h3);
        }, i5.nV = function(s5, n5, h3, r3) {
          var e3 = i5.rc(s5, n5, false);
          if (e3 == 4 || e3 == 1 || e3 == 2)
            return false;
          e3 = new t4.l();
          var o3 = new t4.l();
          return s5.A(e3), n5.A(o3), !i5.Ac(o3, e3, h3) && (o3.S() <= h3 && o3.da() <= h3 ? (n5 = n5.Kp(), i5.CI(s5, n5, h3)) : o3.S() <= h3 || o3.da() <= h3 ? (e3 = new t4.Ua(), o3 = new t4.Ta(), n5.If(0, o3), e3.nf(o3), n5.If(2, o3), e3.lineTo(o3), i5.EI(s5, e3, h3, r3)) : ((e3 = new t4.Ea()).bd(n5, false), i5.DI(s5, e3, h3, r3)));
        }, i5.kV = function(s5, n5, h3, r3) {
          var e3 = i5.rc(s5, n5, false);
          if (e3 == 4 || e3 == 1 || e3 == 2)
            return false;
          e3 = new t4.l();
          var o3 = new t4.l();
          return s5.A(e3), n5.A(o3), !(i5.Ac(o3, e3, h3) || o3.S() <= h3 || o3.da() <= h3) && ((e3 = new t4.Ea()).bd(n5, false), i5.AI(s5, e3, h3, r3));
        }, i5.sV = function(s5, n5, h3) {
          var r3 = new t4.l(), e3 = new t4.l();
          return s5.A(r3), n5.A(e3), i5.Ac(e3, r3, h3);
        }, i5.XU = function(s5, n5, h3) {
          var r3 = new t4.l(), e3 = new t4.l();
          return s5.A(r3), n5.A(e3), !!i5.Ac(r3, e3, h3) && ((r3 = i5.rc(s5, n5, false)) != 4 && r3 != 2 && (r3 == 1 || (e3.S() <= h3 && e3.da() <= h3 ? (n5 = n5.Kp(), i5.vI(s5, n5, h3)) : e3.S() <= h3 || e3.da() <= h3 ? (e3 = new t4.Ua(), r3 = new t4.Ta(), n5.If(0, r3), e3.nf(r3), n5.If(2, r3), e3.lineTo(r3), i5.xI(s5, e3, h3, null)) : ((e3 = new t4.Ea()).bd(n5, false), i5.wI(s5, e3, h3, null)))));
        }, i5.$U = function(s5, n5, h3, r3) {
          var e3 = new t4.l(), o3 = new t4.l();
          return s5.A(e3), n5.A(o3), !(i5.Ac(o3, e3, h3) || o3.da() > h3 && o3.S() > h3 || o3.da() <= h3 && o3.S() <= h3) && (e3 = new t4.Ua(), o3 = new t4.Ta(), n5.If(0, o3), e3.nf(o3), n5.If(2, o3), e3.lineTo(o3), i5.yI(s5, e3, h3, r3));
        }, i5.DV = function(s5, n5, h3) {
          var r3 = new t4.l(), e3 = new t4.l();
          return s5.A(r3), n5.A(e3), !(!i5.gk(r3, e3, h3) || i5.rc(s5, n5, false) == 4) && (!!i5.ZH(s5, n5, h3) || i5.Rz(s5, n5, h3, false));
        }, i5.BV = function(i6, s5, n5) {
          return this.rc(i6, s5, false) == 4 || !!new t4.am(i6, s5, n5, true).next() && !this.OG(i6, s5, n5);
        }, i5.II = function(s5, n5, h3) {
          if (i5.rc(s5, n5, false) == 4)
            return false;
          var r3 = new t4.ce(0);
          if (i5.Sz(s5, n5, h3, r3) != 0)
            return false;
          for (var e3 = new t4.ee(), o3 = 0; o3 < r3.size; o3 += 2) {
            var a3 = r3.read(o3), u3 = r3.read(o3 + 1);
            e3.Du(a3, u3);
          }
          return s5 = s5.ng(), n5 = n5.ng(), s5.Gd(n5, 0, n5.I()), i5.Ow(s5, e3, h3);
        }, i5.GI = function(s5, n5, h3) {
          if (i5.rc(s5, n5, false) == 4)
            return false;
          var r3 = new t4.ce(0);
          if (i5.Sz(s5, n5, h3, r3) != 0)
            return false;
          for (var e3 = new t4.ee(), o3 = 0; o3 < r3.size; o3 += 2) {
            var a3 = r3.read(o3), u3 = r3.read(o3 + 1);
            e3.Du(a3, u3);
          }
          return s5 = s5.ng(), n5 = n5.ng(), s5.Gd(n5, 0, n5.I()), !i5.Ow(s5, e3, h3);
        }, i5.HV = function(t5, s5, n5) {
          return i5.rc(t5, s5, false) != 4 && i5.QG(t5, s5, n5);
        }, i5.FI = function(s5, n5, h3) {
          var r3 = new t4.l(), e3 = new t4.l();
          return s5.A(r3), n5.A(e3), !(!i5.Ac(r3, e3, h3) || i5.rc(s5, n5, false) == 4) && i5.Am(n5, s5, h3, false);
        }, i5.AV = function(t5, s5, n5) {
          return i5.rc(t5, s5, false) == 4 || (s5 = s5.D(), !i5.Tz(t5, s5, n5));
        }, i5.LV = function(t5, s5, n5) {
          return i5.rc(t5, s5, false) != 4 && (s5 = s5.D(), i5.Uz(t5, s5, n5));
        }, i5.vV = function(t5, s5, n5) {
          return i5.rc(t5, s5, false) != 4 && (s5 = s5.D(), i5.MG(t5, s5, n5));
        }, i5.zV = function(t5, s5, n5) {
          return i5.rc(t5, s5, false) == 4 || !i5.PG(t5, s5, n5, false);
        }, i5.KV = function(i6, s5, n5) {
          if (this.rc(i6, s5, false) == 4)
            return false;
          var h3 = i6.Ha(), r3 = new t4.l(), e3 = new t4.l(), o3 = new t4.l();
          i6.A(r3), s5.A(e3), r3.X(n5, n5), e3.X(n5, n5), o3.L(r3), o3.Fa(e3), r3 = null;
          var a3 = i6.Cb;
          if (a3 != null) {
            var u3 = a3.Gb;
            r3 = a3.Bo, u3 == null && (u3 = a3 = t4.ua.lj(i6, o3));
          } else
            u3 = a3 = t4.ua.lj(i6, o3);
          var f3 = u3.getIterator(), c3 = null;
          r3 != null && (c3 = r3.getIterator());
          var l3 = new t4.h(), p3 = new t4.h(), v3 = false, y3 = n5 * n5;
          for (r3 = new t4.rn(s5.I()), a3 = 0; a3 < s5.I(); a3++)
            r3.write(a3, 0);
          for (a3 = 0; a3 < s5.I(); a3++)
            if (s5.D(a3, l3), o3.contains(l3)) {
              if (e3.L(l3.x, l3.y, l3.x, l3.y), c3 != null && (c3.Zi(e3, n5), c3.next() == -1))
                continue;
              f3.Zi(e3, n5);
              for (var b3 = f3.next(); b3 != -1; b3 = f3.next())
                if (h3.Wb(u3.ka(b3)), (b3 = h3.ia()).ic(b3.ge(l3, false), p3), t4.h.zc(l3, p3) <= y3) {
                  r3.write(a3, 1), v3 = true;
                  break;
                }
            }
          if (!v3)
            return false;
          for (i6 = i6.ng(), h3 = new t4.ee(), e3 = new t4.h(), a3 = 0; a3 < s5.I(); a3++)
            r3.read(a3) != 0 && (s5.D(a3, e3), h3.Du(e3.x, e3.y));
          return this.Ow(i6, h3, n5);
        }, i5.xV = function(i6, s5, n5) {
          if (this.rc(i6, s5, false) == 4)
            return false;
          var h3 = i6.Ha(), r3 = new t4.l(), e3 = new t4.l(), o3 = new t4.l();
          i6.A(r3), s5.A(e3), r3.X(n5, n5), e3.X(n5, n5), o3.L(r3), o3.Fa(e3), r3 = null;
          var a3 = i6.Cb;
          if (a3 != null) {
            var u3 = a3.Gb;
            r3 = a3.Bo, u3 == null && (u3 = a3 = t4.ua.lj(i6, o3));
          } else
            u3 = a3 = t4.ua.lj(i6, o3);
          var f3 = u3.getIterator(), c3 = null;
          r3 != null && (c3 = r3.getIterator());
          var l3 = new t4.h(), p3 = new t4.h(), v3 = false, y3 = false, b3 = n5 * n5;
          for (r3 = new t4.rn(s5.I()), a3 = 0; a3 < s5.I(); a3++)
            r3.write(a3, 0);
          for (a3 = 0; a3 < s5.I(); a3++)
            if (s5.D(a3, l3), o3.contains(l3)) {
              if (e3.L(l3.x, l3.y, l3.x, l3.y), c3 != null && (c3.Zi(e3, n5), c3.next() == -1)) {
                y3 = true;
                continue;
              }
              f3.Zi(e3, n5);
              for (var d3 = false, g3 = f3.next(); g3 != -1; g3 = f3.next())
                if (h3.Wb(u3.ka(g3)), (g3 = h3.ia()).ic(g3.ge(l3, false), p3), t4.h.zc(l3, p3) <= b3) {
                  r3.write(a3, 1), d3 = v3 = true;
                  break;
                }
              d3 || (y3 = true);
            } else
              y3 = true;
          if (!v3 || !y3)
            return false;
          for (i6 = i6.ng(), h3 = new t4.ee(), e3 = new t4.h(), a3 = 0; a3 < s5.I(); a3++)
            r3.read(a3) != 0 && (s5.D(a3, e3), h3.Du(e3.x, e3.y));
          return !this.Ow(i6, h3, n5);
        }, i5.uV = function(s5, n5, h3) {
          var r3 = new t4.l(), e3 = new t4.l();
          return s5.A(r3), n5.A(e3), !(!i5.Ac(r3, e3, h3) || i5.rc(s5, n5, false) == 4 || !i5.PG(s5, n5, h3, true)) && (s5 = s5.ng(), !i5.bI(s5, n5, h3));
        }, i5.CV = function(s5, n5, h3) {
          var r3 = new t4.l(), e3 = new t4.l();
          return s5.A(r3), n5.A(e3), !(e3.da() > h3 && e3.S() > h3) && i5.gk(r3, e3, h3);
        }, i5.yV = function(s5, n5, h3) {
          var r3 = new t4.l(), e3 = new t4.l();
          return s5.A(r3), n5.A(e3), !i5.Ac(e3, r3, h3) && !i5.NG(s5, e3, h3);
        }, i5.JV = function(s5, n5, h3) {
          var r3 = new t4.l(), e3 = new t4.l();
          if (s5.A(r3), n5.A(e3), e3.da() <= h3 && e3.S() <= h3)
            return e3 = n5.Kp(), i5.Uz(s5, e3, h3);
          if (e3.da() <= h3 || e3.S() <= h3)
            return e3 = new t4.Ua(), r3 = new t4.Ta(), n5.If(0, r3), e3.nf(r3), n5.If(2, r3), e3.lineTo(r3), i5.II(s5, e3, h3);
          s5 = s5.Ha(), n5 = new t4.l(), r3 = new t4.l(), n5.L(e3), r3.L(e3), n5.X(-h3, -h3), r3.X(h3, h3), e3 = false;
          for (var o3 = new t4.l(), a3 = new t4.l(); s5.ab(); )
            for (; s5.Ia(); ) {
              if (s5.ia().A(o3), a3.L(n5), a3.Fa(o3), !a3.B() && (a3.da() > h3 || a3.S() > h3))
                return false;
              a3.L(r3), a3.Fa(o3), a3.B() || (e3 = true);
            }
          return e3;
        }, i5.GV = function(s5, n5, h3) {
          var r3 = new t4.l(), e3 = new t4.l();
          return s5.A(r3), n5.A(e3), !(i5.Ac(r3, e3, h3) || i5.Ac(e3, r3, h3) || i5.Ac(e3, r3, h3) || e3.da() > h3 && e3.S() > h3 || e3.da() <= h3 && e3.S() <= h3) && (r3 = new t4.Ua(), e3 = new t4.Ta(), n5.If(0, e3), r3.nf(e3), n5.If(2, e3), r3.lineTo(e3), i5.QG(s5, r3, h3));
        }, i5.MV = function(s5, n5, h3) {
          var r3 = new t4.l(), e3 = new t4.l();
          if (s5.A(r3), n5.A(e3), !i5.Ac(e3, r3, h3) || e3.da() <= h3 && e3.S() <= h3)
            return false;
          if (e3.da() <= h3 || e3.S() <= h3)
            return i5.Ac(e3, r3, h3);
          s5 = s5.Ha(), (n5 = new t4.l()).L(e3), n5.X(-h3, -h3), e3 = false, r3 = new t4.l();
          for (var o3 = new t4.l(); s5.ab(); )
            for (; s5.Ia(); )
              s5.ia().A(r3), n5.jm(r3) ? e3 = true : (o3.L(n5), o3.Fa(r3), !o3.B() && (o3.da() > h3 || o3.S() > h3) && (e3 = true));
          return e3;
        }, i5.tV = function(s5, n5, h3) {
          var r3 = new t4.l(), e3 = new t4.l();
          return n5.A(e3), s5.A(r3), !(!i5.Ac(r3, e3, h3) || e3.da() > h3 && e3.S() > h3) && (e3.da() <= h3 && e3.S() <= h3 ? (n5 = n5.Kp(), i5.MG(s5, n5, h3)) : (r3 = new t4.Ua(), e3 = new t4.Ta(), n5.If(0, e3), r3.nf(e3), n5.If(2, e3), r3.lineTo(e3), i5.Am(r3, s5, h3, false)));
        }, i5.wV = function(s5, n5, h3) {
          var r3 = new t4.l(), e3 = new t4.l();
          if (s5.A(r3), n5.A(e3), i5.Ac(e3, r3, h3) || e3.da() <= h3 && e3.S() <= h3)
            return false;
          if (e3.da() <= h3 || e3.S() <= h3)
            return r3 = new t4.Ua(), e3 = new t4.Ta(), n5.If(0, e3), r3.nf(e3), n5.If(2, e3), r3.lineTo(e3), i5.GI(s5, r3, h3);
          s5 = s5.Ha(), n5 = new t4.l(), (r3 = new t4.l()).L(e3), n5.L(e3), r3.X(-h3, -h3), n5.X(h3, h3);
          for (var o3 = e3 = false, a3 = new t4.l(), u3 = new t4.l(); s5.ab(); )
            for (; s5.Ia(); )
              if (s5.ia().A(a3), o3 || n5.contains(a3) || (o3 = true), e3 || (u3.L(r3), u3.Fa(a3), !u3.B() && (u3.da() > h3 || u3.S() > h3) && (e3 = true)), e3 && o3)
                return true;
          return false;
        }, i5.dU = function(s5, n5, h3) {
          var r3 = new t4.l(), e3 = new t4.l();
          return s5.A(r3), n5.A(e3), !!i5.gk(r3, e3, h3) && (!!i5.eU(s5, n5, h3) || i5.TA(s5, n5, h3, false, true, false));
        }, i5.bU = function(t5, s5, n5) {
          return !i5.bI(t5, s5, n5);
        }, i5.jU = function(t5, s5, n5) {
          return i5.TA(t5, s5, n5, false, false, true);
        }, i5.$H = function(s5, n5, h3) {
          var r3 = new t4.l(), e3 = new t4.l();
          return s5.A(r3), n5.A(e3), !!i5.Ac(r3, e3, h3) && i5.TA(n5, s5, h3, true, false, false);
        }, i5.Ow = function(i6, s5, n5) {
          n5 *= n5;
          for (var h3 = new t4.h(), r3 = new t4.h(), e3 = 0; e3 < s5.I(); e3++) {
            s5.D(e3, r3);
            for (var o3 = false, a3 = 0; a3 < i6.I(); a3++)
              if (i6.D(a3, h3), t4.h.zc(h3, r3) <= n5) {
                o3 = true;
                break;
              }
            if (!o3)
              return false;
          }
          return true;
        }, i5.Pw = function(s5, n5, h3) {
          var r3 = new t4.l(), e3 = new t4.l();
          return s5.A(r3), n5.A(e3), i5.gk(r3, e3, h3);
        }, i5.aI = function(t5, s5, n5) {
          return s5 = s5.D(), i5.lt(t5, s5, n5);
        }, i5.nU = function(t5, s5, n5) {
          return i5.Pw(t5, s5, n5);
        }, i5.ZT = function(t5, s5, n5) {
          return !i5.aI(t5, s5, n5);
        }, i5.cU = function(s5, n5, h3) {
          var r3 = new t4.l(), e3 = new t4.l();
          return s5.A(r3), n5.A(e3), !(e3.da() > h3 || e3.S() > h3) && i5.gk(r3, e3, h3);
        }, i5.aU = function(s5, n5, h3) {
          var r3 = new t4.l(), e3 = new t4.l();
          if (s5.A(r3), n5.A(e3), i5.Ac(e3, r3, h3))
            return false;
          for ((n5 = new t4.l()).L(e3), n5.X(h3, h3), h3 = new t4.h(), e3 = 0; e3 < s5.I(); e3++)
            if (s5.D(e3, h3), n5.contains(h3))
              return false;
          return true;
        }, i5.lU = function(i6, s5, n5) {
          var h3 = new t4.l(), r3 = new t4.l(), e3 = new t4.l();
          if (s5.A(h3), h3.da() <= n5 && h3.S() <= n5)
            return false;
          if (h3.da() <= n5 || h3.S() <= n5) {
            s5 = new t4.h();
            var o3 = false;
            r3.L(h3), e3.L(h3), r3.X(n5, n5), h3.da() > n5 ? e3.X(0, -n5) : e3.X(-n5, 0);
            for (var a3 = 0; a3 < i6.I(); a3++)
              if (i6.D(a3, s5), r3.contains(s5)) {
                if (h3.da() > n5) {
                  if (s5.y > e3.G && s5.y < e3.H)
                    return false;
                } else if (s5.x > e3.v && s5.x < e3.C)
                  return false;
                o3 = true;
              }
            return o3;
          }
          for (r3.L(h3), e3.L(h3), r3.X(n5, n5), e3.X(-n5, -n5), s5 = new t4.h(), o3 = false, a3 = 0; a3 < i6.I(); a3++)
            if (i6.D(a3, s5), r3.contains(s5)) {
              if (e3.jm(s5))
                return false;
              o3 = true;
            }
          return o3;
        }, i5.mU = function(s5, n5, h3) {
          var r3 = new t4.l(), e3 = new t4.l();
          if (s5.A(r3), n5.A(e3), !i5.Ac(e3, r3, h3))
            return false;
          if (e3.da() <= h3 && e3.S() <= h3)
            return i5.gk(r3, e3, h3);
          if (e3.da() <= h3 || e3.S() <= h3) {
            n5 = false, r3 = new t4.l();
            var o3 = new t4.l();
            r3.L(e3), o3.L(e3), e3.da() > h3 ? r3.X(0, -h3) : r3.X(-h3, 0), o3.X(h3, h3);
            for (var a3 = new t4.h(), u3 = 0; u3 < s5.I(); u3++) {
              if (s5.D(u3, a3), !o3.contains(a3))
                return false;
              e3.da() > h3 ? a3.y > r3.G && a3.y < r3.H && (n5 = true) : a3.x > r3.v && a3.x < r3.C && (n5 = true);
            }
            return n5;
          }
          for (n5 = false, r3 = new t4.l(), o3 = new t4.l(), r3.L(e3), o3.L(e3), r3.X(-h3, -h3), o3.X(h3, h3), a3 = new t4.h(), u3 = 0; u3 < s5.I(); u3++) {
            if (s5.D(u3, a3), !o3.contains(a3))
              return false;
            r3.jm(a3) && (n5 = true);
          }
          return n5;
        }, i5.YT = function(s5, n5, h3) {
          var r3 = new t4.l(), e3 = new t4.l();
          return s5.A(r3), n5.A(e3), !(!i5.Ac(r3, e3, h3) || e3.da() > h3 || e3.S() > h3) && (n5 = n5.Kp(), !i5.lt(s5, n5, h3));
        }, i5.$T = function(s5, n5, h3) {
          var r3 = new t4.l(), e3 = new t4.l();
          if (s5.A(r3), n5.A(e3), i5.Ac(e3, r3, h3) || e3.da() <= h3 && e3.S() <= h3)
            return false;
          if (e3.da() <= h3 || e3.S() <= h3) {
            n5 = new t4.l(), r3 = new t4.l(), n5.L(e3), e3.da() > h3 ? n5.X(0, -h3) : n5.X(-h3, 0), r3.L(e3), r3.X(h3, h3);
            for (var o3 = new t4.h(), a3 = false, u3 = false, f3 = 0; f3 < s5.I(); f3++)
              if (s5.D(f3, o3), a3 || (e3.da() > h3 ? o3.y > n5.G && o3.y < n5.H && (a3 = true) : o3.x > n5.v && o3.x < n5.C && (a3 = true)), u3 || r3.contains(o3) || (u3 = true), a3 && u3)
                return true;
            return false;
          }
          for (n5 = new t4.l(), r3 = new t4.l(), n5.L(e3), n5.X(-h3, -h3), r3.L(e3), r3.X(h3, h3), o3 = new t4.h(), u3 = a3 = false, f3 = 0; f3 < s5.I(); f3++)
            if (s5.D(f3, o3), !a3 && n5.jm(o3) && (a3 = true), u3 || r3.contains(o3) || (u3 = true), a3 && u3)
              return true;
          return false;
        }, i5.rI = function(i6, s5, n5) {
          return t4.h.zc(i6, s5) <= n5 * n5;
        }, i5.NU = function(i6, s5, n5) {
          return t4.h.zc(i6, s5) > n5 * n5;
        }, i5.pI = function(t5, s5, n5) {
          return i5.rI(t5, s5, n5);
        }, i5.qI = function(s5, n5, h3) {
          var r3 = new t4.l();
          return r3.L(s5), i5.gk(r3, n5, h3);
        }, i5.Tw = function(i6, s5, n5) {
          var h3 = new t4.l();
          return h3.L(s5), h3.X(n5, n5), !h3.contains(i6);
        }, i5.ZA = function(i6, s5, n5) {
          if (s5.da() <= n5 && s5.S() <= n5)
            return false;
          var h3 = new t4.l(), r3 = new t4.l();
          if (h3.L(s5), h3.X(n5, n5), !h3.contains(i6))
            return false;
          if (s5.da() <= n5 || s5.S() <= n5) {
            if (r3.L(s5), s5.da() > n5 ? r3.X(0, -n5) : r3.X(-n5, 0), s5.da() > n5) {
              if (i6.y > r3.G && i6.y < r3.H)
                return false;
            } else if (i6.x > r3.v && i6.x < r3.C)
              return false;
            return true;
          }
          return r3.L(s5), r3.X(-n5, -n5), !r3.jm(i6);
        }, i5.$A = function(i6, s5, n5) {
          if (s5.da() <= n5 && s5.S() <= n5)
            return true;
          if (s5.da() <= n5 || s5.S() <= n5) {
            var h3 = new t4.l();
            h3.L(s5), s5.da() > n5 ? h3.X(0, -n5) : h3.X(-n5, 0);
            var r3 = false;
            return s5.da() > n5 ? i6.y > h3.G && i6.y < h3.H && (r3 = true) : i6.x > h3.v && i6.x < h3.C && (r3 = true), r3;
          }
          return (h3 = new t4.l()).L(s5), h3.X(-n5, -n5), h3.jm(i6);
        }, i5.MU = function(t5, s5, n5) {
          return i5.qI(t5, s5, n5);
        }, i5.gk = function(t5, s5, n5) {
          return i5.Ac(t5, s5, n5) && i5.Ac(s5, t5, n5);
        }, i5.fk = function(i6, s5, n5) {
          var h3 = new t4.l();
          return h3.L(s5), h3.X(n5, n5), !i6.isIntersecting(h3);
        }, i5.YP = function(s5, n5, h3) {
          if (s5.da() <= h3 && s5.S() <= h3) {
            var r3 = s5.tf();
            return i5.ZA(r3, n5, h3);
          }
          if (n5.da() <= h3 && n5.S() <= h3)
            return r3 = n5.tf(), i5.ZA(r3, s5, h3);
          if (s5.da() > h3 && s5.S() > h3 && (n5.da() <= h3 || n5.S() <= h3) ? r3 = n5 : (r3 = s5, s5 = n5), r3.da() <= h3 || r3.S() <= h3) {
            if (s5.da() <= h3 || s5.S() <= h3) {
              n5 = new t4.zb();
              var e3 = new t4.zb(), o3 = [0, 0], a3 = [0, 0], u3 = new t4.h();
              return r3.fn(u3), n5.Ec(u3), r3.gn(u3), n5.Rc(u3), s5.fn(u3), e3.Ec(u3), s5.gn(u3), e3.Rc(u3), n5.Fa(e3, null, o3, a3, h3), n5.Fa(e3, null, null, null, h3) == 1 && (o3[0] == 0 || o3[1] == 1 || a3[0] == 0 || a3[1] == 1);
            }
            return n5 = new t4.l(), e3 = new t4.l(), n5.L(s5), n5.X(-h3, -h3), e3.L(n5), e3.Fa(r3), !(!e3.B() && (e3.da() > h3 || e3.S() > h3));
          }
          return s5.X(h3, h3), (e3 = new t4.l()).L(r3), e3.Fa(s5), !(e3.B() || !e3.B() && e3.da() > h3 && e3.S() > h3);
        }, i5.XP = function(s5, n5, h3) {
          if (i5.Ac(s5, n5, h3) || i5.Ac(n5, s5, h3) || s5.da() <= h3 && s5.S() <= h3 || n5.da() <= h3 && n5.S() <= h3)
            return false;
          if (s5.da() <= h3 || s5.S() <= h3) {
            if (n5.da() > h3 && n5.S() > h3)
              return false;
            var r3 = new t4.zb(), e3 = new t4.zb(), o3 = [0, 0], a3 = [0, 0], u3 = new t4.h();
            return s5.fn(u3), r3.Ec(u3), s5.gn(u3), r3.Rc(u3), n5.fn(u3), e3.Ec(u3), n5.gn(u3), e3.Rc(u3), r3.Fa(e3, null, o3, a3, h3), r3.Fa(e3, null, null, null, h3) == 2 && ((0 < o3[0] || 1 > o3[1]) && (0 < a3[0] || 1 > a3[1]));
          }
          return !(n5.da() <= h3 || n5.S() <= h3) && ((r3 = new t4.l()).L(s5), r3.Fa(n5), !(r3.B() || r3.da() <= h3 || r3.S() <= h3));
        }, i5.eF = function(s5, n5, h3) {
          if (!i5.Ac(s5, n5, h3))
            return false;
          if (s5.da() <= h3 && s5.S() <= h3)
            return s5 = s5.tf(), i5.$A(s5, n5, h3);
          if (n5.da() <= h3 && n5.S() <= h3)
            return n5 = n5.tf(), i5.$A(n5, s5, h3);
          if (s5.da() <= h3 || s5.S() <= h3)
            return i5.Ac(s5, n5, h3);
          if (n5.da() <= h3 || n5.S() <= h3) {
            var r3 = new t4.l();
            return r3.L(s5), r3.X(-h3, -h3), r3.jm(n5) ? true : ((s5 = new t4.l()).L(r3), s5.Fa(n5), !(s5.B() || s5.da() <= h3 && s5.S() <= h3));
          }
          return i5.Ac(s5, n5, h3);
        }, i5.WP = function(s5, n5, h3) {
          if (i5.Ac(s5, n5, h3) || i5.Ac(n5, s5, h3) || s5.da() <= h3 && s5.S() <= h3 || n5.da() <= h3 && n5.S() <= h3 || n5.da() > h3 && n5.S() > h3 && s5.da() > h3 && s5.S() > h3)
            return false;
          if (s5.da() > h3 && s5.S() > h3)
            var r3 = n5;
          else
            r3 = s5, s5 = n5;
          if (s5.da() > h3 && s5.S() > h3) {
            n5 = new t4.l();
            var e3 = new t4.l();
            return e3.L(s5), e3.X(-h3, -h3), n5.L(e3), n5.Fa(r3), !(n5.B() || n5.da() <= h3 && n5.S() <= h3);
          }
          n5 = new t4.zb(), e3 = new t4.zb();
          var o3 = [0, 0], a3 = [0, 0], u3 = new t4.h();
          return r3.fn(u3), n5.Ec(u3), r3.gn(u3), n5.Rc(u3), s5.fn(u3), e3.Ec(u3), s5.gn(u3), e3.Rc(u3), n5.Fa(e3, null, o3, a3, h3), n5.Fa(e3, null, null, null, h3) == 1 && (0 < o3[0] && 1 > o3[1] && 0 < a3[0] && 1 > a3[1]);
        }, i5.zI = function(i6, s5, n5) {
          var h3 = new t4.l(), r3 = new t4.l(), e3 = new t4.am(i6, s5, n5, true);
          if (!e3.next())
            return true;
          if (this.OG(i6, s5, n5))
            return false;
          var o3 = i6, a3 = null;
          s5.K() == 1736 && (a3 = s5);
          var u3 = false, f3 = false;
          do {
            var c3 = e3.pl(), l3 = e3.jl();
            if (l3 = s5.Oa(s5.Ca(l3)), h3.L(e3.oz()), h3.X(n5, n5), h3.contains(l3) && (l3 = t4.jd.Zd(o3, l3, 0)) != 0 || s5.K() == 1736 && (c3 = i6.Oa(i6.Ca(c3)), r3.L(e3.Wy()), r3.X(n5, n5), r3.contains(c3) && (l3 = t4.jd.Zd(a3, c3, 0)) != 0))
              return false;
            u3 || (!t4.Fg.Ol(i6, s5.ea() - 1) || i6.Cb != null && i6.Cb.Gb != null ? o3 = i6 : (o3 = new t4.Ea(), i6.copyTo(o3), o3.hj(1)), u3 = true), s5.K() != 1736 || f3 || (f3 = s5, !t4.Fg.Ol(f3, i6.ea() - 1) || s5.Cb != null && s5.Cb.Gb != null ? a3 = s5 : (a3 = new t4.Ea(), f3.copyTo(a3), a3.hj(1)), f3 = true);
          } while (e3.next());
          return true;
        }, i5.Ac = function(i6, s5, n5) {
          var h3 = new t4.l();
          return h3.L(i6), h3.X(n5, n5), h3.contains(s5);
        }, i5.ns = function(i6, s5, n5) {
          var h3 = new t4.l();
          return h3.L(s5), h3.X(n5, n5), s5 = new t4.h(), i6.fn(s5), !h3.contains(s5) || (i6.VI(s5), !h3.contains(s5) || (i6.YI(s5), !h3.contains(s5) || (i6.gn(s5), !h3.contains(s5))));
        }, i5.ZH = function(i6, s5, n5) {
          if (i6.ea() != s5.ea() || i6.I() != s5.I())
            return false;
          var h3 = new t4.h(), r3 = new t4.h(), e3 = true;
          n5 *= n5;
          for (var o3 = 0; o3 < i6.ea(); o3++) {
            if (i6.Wc(o3) != s5.Wc(o3)) {
              e3 = false;
              break;
            }
            for (var a3 = i6.Ca(o3); a3 < s5.Wc(o3); a3++)
              if (i6.D(a3, h3), s5.D(a3, r3), t4.h.zc(h3, r3) > n5) {
                e3 = false;
                break;
              }
            if (!e3)
              break;
          }
          return !!e3;
        }, i5.eU = function(i6, s5, n5) {
          if (i6.I() != s5.I())
            return false;
          var h3 = new t4.h(), r3 = new t4.h(), e3 = true;
          n5 *= n5;
          for (var o3 = 0; o3 < i6.I(); o3++)
            if (i6.D(o3, h3), s5.D(o3, r3), t4.h.zc(h3, r3) > n5) {
              e3 = false;
              break;
            }
          return !!e3;
        }, i5.TA = function(i6, s5, n5, h3, r3, e3) {
          var o3 = false;
          if (i6.I() > s5.I()) {
            h3 && (h3 = false, o3 = true);
            var a3 = s5;
          } else
            a3 = i6, i6 = s5;
          if (s5 = null, r3 || e3 || o3) {
            s5 = new t4.rn(i6.I());
            for (var u3 = 0; u3 < i6.I(); u3++)
              s5.write(u3, 0);
          }
          u3 = new t4.l();
          var f3 = new t4.l(), c3 = new t4.l();
          a3.A(u3), i6.A(f3), u3.X(n5, n5), f3.X(n5, n5), c3.L(u3), c3.Fa(f3), f3 = new t4.h();
          for (var l3 = new t4.h(), p3 = true, v3 = t4.ua.jE(i6, c3), y3 = v3.getIterator(), b3 = n5 * n5, d3 = 0; d3 < a3.I(); d3++)
            if (a3.D(d3, f3), c3.contains(f3)) {
              var g3 = false;
              u3.L(f3.x, f3.y, f3.x, f3.y), y3.Zi(u3, n5);
              for (var w3 = y3.next(); w3 != -1 && (w3 = v3.ka(w3), i6.D(w3, l3), !(t4.h.zc(f3, l3) <= b3 && ((r3 || e3 || o3) && s5.write(w3, 1), g3 = true, h3))); w3 = y3.next())
                ;
              if (!g3 && (p3 = false, r3 || h3))
                return false;
            } else {
              if (r3 || h3)
                return false;
              p3 = false;
            }
          if (e3 && p3)
            return false;
          if (h3)
            return true;
          for (u3 = 0; u3 < i6.I(); u3++)
            if (s5.read(u3) == 1) {
              if (e3)
                return true;
            } else if (r3 || o3)
              return false;
          return !e3;
        }, i5.bI = function(i6, s5, n5) {
          if (i6.I() > s5.I())
            var h3 = s5;
          else
            h3 = i6, i6 = s5;
          s5 = new t4.l();
          var r3 = new t4.l(), e3 = new t4.l();
          h3.A(s5), i6.A(r3), s5.X(n5, n5), r3.X(n5, n5), e3.L(s5), e3.Fa(r3), r3 = new t4.h();
          for (var o3 = new t4.h(), a3 = n5 * n5, u3 = t4.ua.jE(i6, e3), f3 = u3.getIterator(), c3 = 0; c3 < h3.I(); c3++)
            if (h3.D(c3, r3), e3.contains(r3)) {
              s5.L(r3.x, r3.y, r3.x, r3.y), f3.Zi(s5, n5);
              for (var l3 = f3.next(); l3 != -1; l3 = f3.next())
                if (i6.D(u3.ka(l3), o3), t4.h.zc(r3, o3) <= a3)
                  return true;
            }
          return false;
        }, i5.Rz = function(t5, s5, n5, h3) {
          return i5.Am(t5, s5, n5, h3) && i5.Am(s5, t5, n5, h3);
        }, i5.Am = function(n5, h3, r3, e3) {
          function o3(t5, i6) {
            return v3.LE(t5, i6);
          }
          var a3, u3 = true, f3 = [0, 0], c3 = [0, 0], l3 = 0, p3 = new t4.ja(0), v3 = new i5(), y3 = new t4.l(), b3 = new t4.l(), d3 = new t4.l();
          n5.A(y3), h3.A(b3), y3.X(r3, r3), b3.X(r3, r3), d3.L(y3), d3.Fa(b3), n5 = n5.Ha(), b3 = h3.Ha();
          var g3 = null, w3 = g3 = null, x3 = h3.Cb;
          for (x3 != null ? (g3 = x3.Gb, w3 = x3.Bo, g3 == null && (g3 = t4.ua.lj(h3, d3))) : g3 = t4.ua.lj(h3, d3), h3 = g3.getIterator(), x3 = null, w3 != null && (x3 = w3.getIterator()); n5.ab(); )
            for (; n5.Ia(); ) {
              var m3 = false, j3 = n5.ia();
              if (j3.A(y3), !y3.isIntersecting(d3))
                return false;
              if (x3 != null && (x3.Zi(y3, r3), x3.next() == -1))
                return false;
              for (w3 = j3.Rb(), h3.Wo(j3, r3), a3 = h3.next(); a3 != -1; a3 = h3.next()) {
                b3.Wb(g3.ka(a3)), a3 = b3.ia();
                var M3 = j3.Fa(a3, null, f3, c3, r3);
                if (M3 == 2 && (!e3 || c3[0] <= c3[1])) {
                  M3 = f3[0];
                  var k3 = f3[1], z3 = c3[0], A3 = c3[1];
                  if (M3 * w3 <= r3 && (1 - k3) * w3 <= r3) {
                    m3 = true, l3 = 0, p3.resize(0), v3.th.length = 0;
                    var N3 = n5.xb();
                    for (z3 = true; z3; ) {
                      if (n5.Ia()) {
                        if (w3 = (j3 = n5.ia()).Rb(), (M3 = j3.Fa(a3, null, f3, c3, r3)) == 2 && (!e3 || c3[0] <= c3[1]) && (M3 = f3[0], k3 = f3[1], M3 * w3 <= r3 && (1 - k3) * w3 <= r3)) {
                          N3 = n5.xb();
                          continue;
                        }
                        if (b3.Ia() && (a3 = b3.ia(), (M3 = j3.Fa(a3, null, f3, c3, r3)) == 2 && (!e3 || c3[0] <= c3[1]) && (M3 = f3[0], k3 = f3[1], M3 * w3 <= r3 && (1 - k3) * w3 <= r3))) {
                          N3 = n5.xb();
                          continue;
                        }
                      }
                      z3 = false;
                    }
                    N3 != n5.xb() && (n5.Wb(N3), n5.ia());
                    break;
                  }
                  N3 = n5.xb(), a3 = s4.construct(N3, n5.gb, M3, k3, b3.xb(), b3.gb, z3, A3), v3.th.push(a3), p3.add(p3.size);
                }
              }
              if (!m3) {
                if (l3 == v3.th.length)
                  return false;
                for (1 < p3.size - l3 && p3.Wd(l3, p3.size, o3), m3 = 0; l3 < v3.th.length; l3++)
                  if (!((a3 = v3.th[p3.get(l3)]).Mj < m3 && a3.Ui < m3)) {
                    if (w3 * (a3.Mj - m3) > r3)
                      return false;
                    if (w3 * (1 - (m3 = a3.Ui)) <= r3 || m3 == 1)
                      break;
                  }
                if (w3 * (1 - m3) > r3)
                  return false;
                l3 = 0, p3.resize(0), v3.th.length = 0;
              }
            }
          return u3;
        }, i5.QG = function(s5, n5, h3) {
          if (1 > i5.Sz(s5, n5, h3, null))
            return false;
          var r3 = new t4.l(), e3 = new t4.l();
          s5.A(r3), n5.A(e3);
          var o3 = i5.ns(r3, e3, h3);
          return r3 = i5.ns(e3, r3, h3), !(!o3 || !r3) || (o3 && !r3 ? !i5.Am(n5, s5, h3, false) : r3 && !o3 ? !i5.Am(s5, n5, h3, false) : !i5.Am(s5, n5, h3, false) && !i5.Am(n5, s5, h3, false));
        }, i5.Sz = function(n5, h3, r3, e3) {
          function o3(t5, i6) {
            return y3.LE(t5, i6);
          }
          if (n5.sz() > h3.sz())
            var a3 = h3, u3 = n5;
          else
            a3 = n5, u3 = h3;
          n5 = a3.Ha(), h3 = u3.Ha();
          var f3 = [0, 0], c3 = [0, 0], l3 = -1, p3 = 0, v3 = new t4.ja(0), y3 = new i5(), b3 = new t4.l(), d3 = new t4.l(), g3 = new t4.l();
          a3.A(b3), u3.A(d3), b3.X(r3, r3), d3.X(r3, r3), g3.L(b3), g3.Fa(d3), a3 = null, e3 != null && (a3 = new t4.h());
          var w3 = d3 = d3 = null, x3 = u3.Cb;
          for (x3 != null ? (d3 = x3.Gb, w3 = x3.Bo, d3 == null && (d3 = t4.ua.lj(u3, g3))) : d3 = t4.ua.lj(u3, g3), u3 = d3.getIterator(), x3 = null, w3 != null && (x3 = w3.getIterator()); n5.ab(); )
            for (w3 = 0; n5.Ia(); ) {
              var m3 = n5.ia();
              if (m3.A(b3), b3.isIntersecting(g3)) {
                if (x3 != null && (x3.Zi(b3, r3), x3.next() == -1))
                  continue;
                var j3 = m3.Rb();
                u3.Wo(m3, r3);
                for (var M3 = u3.next(); M3 != -1; M3 = u3.next()) {
                  var k3 = d3.ka(M3);
                  h3.Wb(k3);
                  var z3 = h3.ia(), A3 = z3.Rb(), N3 = m3.Fa(z3, null, f3, c3, r3);
                  if (0 < N3) {
                    M3 = f3[0], l3 = c3[0];
                    var I3 = N3 == 2 ? f3[1] : NaN, P3 = N3 == 2 ? c3[1] : NaN;
                    if (N3 == 2) {
                      if (j3 * (I3 - M3) > r3)
                        return 1;
                      var C3 = j3 * (I3 - M3);
                      if (h3.Ia()) {
                        if (z3 = h3.ia(), (N3 = m3.Fa(z3, null, f3, null, r3)) == 2) {
                          N3 = f3[0];
                          var B3 = f3[1];
                          if (C3 + (N3 = j3 * (B3 - N3)) > r3)
                            return 1;
                        }
                        h3.Wb(k3), h3.ia();
                      }
                      if (!h3.xm()) {
                        if (h3.ni(), z3 = h3.ni(), (N3 = m3.Fa(z3, null, f3, null, r3)) == 2 && (N3 = f3[0], C3 + (N3 = j3 * ((B3 = f3[1]) - N3)) > r3))
                          return 1;
                        h3.Wb(k3), h3.ia();
                      }
                      if (n5.Ia()) {
                        if (k3 = n5.xb(), (N3 = (m3 = n5.ia()).Fa(z3, null, f3, null, r3)) == 2 && (N3 = f3[0], C3 + (N3 = j3 * ((B3 = f3[1]) - N3)) > r3))
                          return 1;
                        n5.Wb(k3), n5.ia();
                      }
                      if (!n5.xm()) {
                        if (k3 = n5.xb(), n5.ni(), (N3 = (m3 = n5.ni()).Fa(z3, null, f3, null, r3)) == 2 && (N3 = f3[0], C3 + (N3 = A3 * ((B3 = f3[1]) - N3)) > r3))
                          return 1;
                        n5.Wb(k3), n5.ia();
                      }
                      z3 = s4.construct(n5.xb(), n5.gb, M3, I3, h3.xb(), h3.gb, l3, P3), y3.th.push(z3), v3.add(v3.size);
                    }
                    l3 = 0, e3 != null && (m3.ic(M3, a3), e3.add(a3.x), e3.add(a3.y));
                  }
                }
                if (p3 < y3.th.length) {
                  for (v3.Wd(p3, v3.size, o3), m3 = 0, M3 = y3.th[v3.get(p3)].Om; p3 < y3.th.length; p3++)
                    if (!((z3 = y3.th[v3.get(p3)]).Mj < m3 && z3.Ui < m3))
                      if (j3 * (z3.Mj - m3) > r3)
                        w3 = j3 * (z3.Ui - z3.Mj), m3 = z3.Ui, M3 = z3.Om;
                      else {
                        if (z3.Om != M3 ? (w3 = j3 * (z3.Ui - z3.Mj), M3 = z3.Om) : w3 += j3 * (z3.Ui - z3.Mj), w3 > r3)
                          return 1;
                        if ((m3 = z3.Ui) == 1)
                          break;
                      }
                  j3 * (1 - m3) > r3 && (w3 = 0), p3 = 0, v3.resize(0), y3.th.length = 0;
                }
              }
            }
          return l3;
        }, i5.OG = function(i6, s5, n5) {
          var h3 = i6.Ha(), r3 = s5.Ha();
          for (i6 = new t4.am(i6, s5, n5, false); i6.next(); ) {
            s5 = i6.pl();
            var e3 = i6.jl();
            if (h3.Wb(s5), r3.Wb(e3), s5 = h3.ia(), 0 < r3.ia().Fa(s5, null, null, null, n5))
              return true;
          }
          return false;
        }, i5.PG = function(i6, s5, n5, h3) {
          var r3 = i6.Ha(), e3 = new t4.l(), o3 = new t4.l(), a3 = new t4.l();
          i6.A(e3), s5.A(o3), e3.X(n5, n5), e3.contains(o3), o3.X(n5, n5), a3.L(e3), a3.Fa(o3), (e3 = i6.Cb) != null ? (e3 = e3.Gb) == null && (e3 = t4.ua.lj(i6, a3)) : e3 = t4.ua.lj(i6, a3), i6 = e3.getIterator();
          for (var u3 = new t4.h(), f3 = new t4.h(), c3 = n5 * n5, l3 = 0; l3 < s5.I(); l3++)
            if (s5.D(l3, u3), a3.contains(u3)) {
              o3.L(u3.x, u3.y, u3.x, u3.y), i6.Zi(o3, n5);
              for (var p3 = false, v3 = i6.next(); v3 != -1; v3 = i6.next())
                if (r3.Wb(e3.ka(v3)), (v3 = r3.ia()).ic(v3.ge(u3, false), f3), t4.h.zc(f3, u3) <= c3) {
                  p3 = true;
                  break;
                }
              if (h3) {
                if (!p3)
                  return false;
              } else if (p3)
                return true;
            }
          return !!h3;
        }, i5.Tz = function(i6, s5, n5) {
          var h3 = new t4.h(), r3 = n5 * n5, e3 = i6.Ha();
          if ((i6 = i6.Cb) != null && (i6 = i6.Gb) != null) {
            var o3 = new t4.l();
            for (o3.L(s5), o3 = (n5 = i6.HF(o3, n5)).next(); o3 != -1; o3 = n5.next())
              if (e3.Wb(i6.ka(o3)), e3.Ia()) {
                var a3 = (o3 = e3.ia()).ge(s5, false);
                if (o3.ic(a3, h3), t4.h.zc(s5, h3) <= r3)
                  return true;
              }
            return false;
          }
          for (i6 = new t4.l(); e3.ab(); )
            for (; e3.Ia(); )
              if ((o3 = e3.ia()).A(i6), i6.X(n5, n5), i6.contains(s5) && (a3 = o3.ge(s5, false), o3.ic(a3, h3), t4.h.zc(s5, h3) <= r3))
                return true;
          return false;
        }, i5.MG = function(t5, s5, n5) {
          return i5.Tz(t5, s5, n5) && !i5.Uz(t5, s5, n5);
        }, i5.Uz = function(t5, s5, n5) {
          return t5 = t5.ng(), !i5.lt(t5, s5, n5);
        }, i5.NG = function(i6, s5, n5) {
          if (i6.vm()) {
            var h3 = new t4.zb(s5.v, s5.G, s5.v, s5.H), r3 = new t4.zb(s5.v, s5.H, s5.C, s5.H), e3 = new t4.zb(s5.C, s5.H, s5.C, s5.G);
            for (s5 = new t4.zb(s5.C, s5.G, s5.v, s5.G), i6 = i6.Ha(); i6.ab(); )
              for (; i6.Ia(); ) {
                var o3 = i6.ia();
                if (o3.isIntersecting(h3, n5) || o3.isIntersecting(r3, n5) || o3.isIntersecting(e3, n5) || o3.isIntersecting(s5, n5))
                  return true;
              }
          } else {
            (h3 = new t4.l()).L(s5), h3.X(n5, n5), n5 = i6.vb(0), r3 = new t4.h(), e3 = new t4.h(), s5 = new t4.h(), o3 = new t4.h();
            for (var a3 = 0, u3 = i6.ea(); a3 < u3; a3++)
              for (var f3 = true, c3 = i6.Ca(a3), l3 = i6.Wc(a3); c3 < l3; c3++)
                if (f3)
                  n5.uc(2 * c3, e3), f3 = false;
                else {
                  if (n5.uc(2 * c3, r3), s5.N(e3), o3.N(r3), h3.uy(s5, o3) != 0)
                    return true;
                  e3.N(r3);
                }
          }
          return false;
        }, i5.rc = function(s5, n5, h3) {
          var r3 = s5.K(), e3 = n5.K();
          if (t4.ba.zj(r3)) {
            var o3 = s5.Cb;
            if (o3 != null && (o3 = o3.Hk) != null)
              if (e3 == 33) {
                var a3 = n5.D();
                if ((a3 = o3.Uo(a3.x, a3.y)) == 1)
                  return 1;
                if (a3 == 0)
                  return 4;
              } else {
                if (a3 = new t4.l(), n5.A(a3), (a3 = o3.To(a3)) == 1)
                  return 1;
                if (a3 == 0)
                  return 4;
                if (h3 && t4.ba.zj(e3) && i5.CE(n5, o3))
                  return 1073741824;
              }
          }
          if (t4.ba.zj(e3) && ((o3 = n5.Cb) != null && (o3 = o3.Hk) != null))
            if (r3 == 33) {
              if (s5 = s5.D(), (a3 = o3.Uo(s5.x, s5.y)) == 1)
                return 2;
              if (a3 == 0)
                return 4;
            } else {
              if (n5 = new t4.l(), s5.A(n5), (a3 = o3.To(n5)) == 1)
                return 2;
              if (a3 == 0)
                return 4;
              if (h3 && t4.ba.zj(r3) && i5.CE(s5, o3))
                return 1073741824;
            }
          return 0;
        }, i5.CE = function(i6, s5) {
          for (var n5 = i6.I(), h3 = new t4.h(), r3 = 0; r3 < n5; r3++)
            if (i6.D(r3, h3), s5.Uo(h3.x, h3.y) == 1)
              return true;
          return false;
        }, i5.DI = function(i6, s5, n5, h3) {
          for (var r3 = 1 <= i6.qm(0) && 1 <= s5.qm(0), e3 = i6.Ha(), o3 = s5.Ha(), a3 = [0, 0], u3 = [0, 0], f3 = new t4.am(i6, s5, n5, false), c3 = false; f3.next(); ) {
            var l3 = f3.pl(), p3 = f3.jl();
            if (e3.Wb(l3), o3.Wb(p3), l3 = e3.ia(), (p3 = o3.ia().Fa(l3, null, u3, a3, n5)) == 2) {
              if (c3 = a3[0], p3 = a3[1], l3 = l3.Rb(), r3 && (p3 - c3) * l3 > n5)
                return false;
              c3 = true;
            } else if (p3 != 0) {
              if (c3 = a3[0], l3 = u3[0], 0 < c3 && 1 > c3 && 0 < l3 && 1 > l3)
                return false;
              c3 = true;
            }
          }
          return !!c3 && (e3 = new t4.l(), o3 = new t4.l(), r3 = new t4.l(), i6.A(e3), s5.A(o3), e3.X(1e3 * n5, 1e3 * n5), o3.X(1e3 * n5, 1e3 * n5), r3.L(e3), r3.Fa(o3), !(10 < i6.I() && (i6 = t4.Vd.clip(i6, r3, n5, 0), i6.B()) || 10 < s5.I() && (s5 = t4.Vd.clip(s5, r3, n5, 0), s5.B())) && t4.cm.st(i6, s5, n5, "F********", h3));
        }, i5.AI = function(s5, n5, h3, r3) {
          var e3 = 1 <= s5.qm(0) && 1 <= n5.qm(0), o3 = new t4.l(), a3 = new t4.l(), u3 = new t4.l();
          s5.A(o3), n5.A(a3);
          for (var f3 = false, c3 = i5.ns(o3, a3, h3), l3 = i5.ns(a3, o3, h3), p3 = s5.Ha(), v3 = n5.Ha(), y3 = [0, 0], b3 = [0, 0], d3 = new t4.am(s5, n5, h3, false); d3.next(); ) {
            var g3 = d3.pl(), w3 = d3.jl();
            if (p3.Wb(g3), v3.Wb(w3), w3 = p3.ia(), (g3 = v3.ia().Fa(w3, null, b3, y3, h3)) == 2) {
              g3 = y3[0];
              var x3 = y3[1];
              if (w3 = w3.Rb(), e3 && (x3 - g3) * w3 > h3 && (f3 = true, c3 && l3))
                return true;
            } else if (g3 != 0 && (g3 = y3[0], w3 = b3[0], 0 < g3 && 1 > g3 && 0 < w3 && 1 > w3))
              return true;
          }
          if (e3 = new t4.l(), p3 = new t4.l(), e3.L(o3), e3.X(1e3 * h3, 1e3 * h3), p3.L(a3), p3.X(1e3 * h3, 1e3 * h3), u3.L(e3), u3.Fa(p3), o3 = "", o3 = f3 ? o3 + "**" : o3 + "T*", c3) {
            if (10 < n5.I() && (n5 = t4.Vd.clip(n5, u3, h3, 0)).B())
              return false;
            o3 += "****";
          } else
            o3 += "T***";
          if (l3) {
            if (10 < s5.I() && (s5 = t4.Vd.clip(s5, u3, h3, 0)).B())
              return false;
            o3 += "***";
          } else
            o3 += "T**";
          return t4.cm.st(s5, n5, h3, o3.toString(), r3);
        }, i5.wI = function(s5, n5, h3, r3) {
          var e3 = [false], o3 = i5.uI(s5, n5, h3, e3);
          return e3[0] ? o3 : (e3 = new t4.l(), n5.A(e3), e3.X(1e3 * h3, 1e3 * h3), !(10 < s5.I() && (s5 = t4.Vd.clip(s5, e3, h3, 0), s5.B())) && t4.cm.Uw(s5, n5, h3, r3));
        }, i5.uI = function(i6, s5, n5, h3) {
          h3[0] = false;
          for (var r3 = i6.Ha(), e3 = s5.Ha(), o3 = [0, 0], a3 = [0, 0], u3 = new t4.am(i6, s5, n5, false), f3 = false; u3.next(); ) {
            var c3 = u3.pl(), l3 = u3.jl();
            if (r3.Wb(c3, -1), e3.Wb(l3, -1), c3 = r3.ia(), (c3 = e3.ia().Fa(c3, null, a3, o3, n5)) != 0 && (f3 = true, c3 == 1 && (c3 = o3[0], l3 = a3[0], 0 < c3 && 1 > c3 && 0 < l3 && 1 > l3)))
              return h3[0] = true, false;
          }
          if (!f3) {
            for (h3[0] = true, o3 = new t4.l(), i6.A(o3), o3.X(n5, n5), u3 = i6, f3 = false, a3 = new t4.l(), h3 = 0, r3 = s5.ea(); h3 < r3; h3++)
              if (0 < s5.Ka(h3)) {
                if (s5.Tj(h3, a3), !o3.isIntersecting(a3))
                  return false;
                if (e3 = s5.Oa(s5.Ca(h3)), (e3 = t4.Fg.ym(u3, e3, 0)) == 0)
                  return false;
                f3 || (!t4.Fg.Ol(i6, s5.ea() - 1) || i6.Cb != null && i6.Cb.Gb != null ? u3 = i6 : (e3 = new t4.Ea(), i6.copyTo(e3), e3.hj(1), u3 = e3), f3 = true);
              }
            if (i6.ea() == 1 || s5.K() == 1607)
              return true;
            for (o3 = new t4.l(), s5.A(o3), o3.X(n5, n5), a3 = s5, u3 = false, n5 = new t4.l(), h3 = 0, r3 = i6.ea(); h3 < r3; h3++)
              if (0 < i6.Ka(h3)) {
                if (i6.Tj(h3, n5), o3.isIntersecting(n5) && (e3 = i6.Oa(i6.Ca(h3)), (e3 = t4.Fg.ym(a3, e3, 0)) == 1))
                  return false;
                u3 || (!t4.Fg.Ol(s5, i6.ea() - 1) || s5.Cb != null && s5.Cb.Gb != null ? a3 = s5 : (e3 = new t4.Ea(), s5.copyTo(e3), e3.hj(1), a3 = e3), u3 = true);
              }
            return true;
          }
          return false;
        }, i5.EI = function(i6, s5, n5, h3) {
          for (var r3 = i6.Ha(), e3 = s5.Ha(), o3 = [0, 0], a3 = [0, 0], u3 = new t4.am(i6, s5, n5, false), f3 = false; u3.next(); ) {
            var c3 = u3.pl(), l3 = u3.jl();
            if (r3.Wb(c3), e3.Wb(l3), c3 = r3.ia(), (c3 = e3.ia().Fa(c3, null, a3, o3, n5)) == 2)
              f3 = true;
            else if (c3 != 0) {
              if (f3 = o3[0], c3 = a3[0], 0 < f3 && 1 > f3 && 0 < c3 && 1 > c3)
                return false;
              f3 = true;
            }
          }
          return !!f3 && (e3 = new t4.l(), o3 = new t4.l(), r3 = new t4.l(), i6.A(e3), s5.A(o3), e3.X(1e3 * n5, 1e3 * n5), o3.X(1e3 * n5, 1e3 * n5), r3.L(e3), r3.Fa(o3), !(10 < i6.I() && (i6 = t4.Vd.clip(i6, r3, n5, 0), i6.B()) || 10 < s5.I() && (s5 = t4.Vd.clip(s5, r3, n5, 0), s5.B())) && t4.cm.bn(i6, s5, n5, "F********", h3));
        }, i5.yI = function(s5, n5, h3, r3) {
          for (var e3 = s5.Ha(), o3 = n5.Ha(), a3 = [0, 0], u3 = [0, 0], f3 = new t4.am(s5, n5, h3, false), c3 = false; f3.next(); ) {
            var l3 = f3.pl(), p3 = f3.jl();
            if (e3.Wb(l3), o3.Wb(p3), l3 = e3.ia(), (l3 = o3.ia().Fa(l3, null, u3, a3, h3)) == 2)
              c3 = true;
            else if (l3 != 0) {
              if (c3 = a3[0], l3 = u3[0], 0 < c3 && 1 > c3 && 0 < l3 && 1 > l3)
                return true;
              c3 = true;
            }
          }
          return !!c3 && (o3 = new t4.l(), a3 = new t4.l(), u3 = new t4.l(), f3 = new t4.l(), e3 = new t4.l(), s5.A(o3), n5.A(a3), i5.ns(a3, o3, h3) ? (u3.L(o3), u3.X(1e3 * h3, 1e3 * h3), f3.L(a3), f3.X(1e3 * h3, 1e3 * h3), e3.L(u3), e3.Fa(f3), !(10 < s5.I() && (s5 = t4.Vd.clip(s5, e3, h3, 0), s5.B()) || 10 < n5.I() && (n5 = t4.Vd.clip(n5, e3, h3, 0), n5.B())) && (h3 = t4.cm.bn(s5, n5, h3, "T********", r3))) : h3 = t4.cm.bn(s5, n5, h3, "T*****T**", r3));
        }, i5.xI = function(s5, n5, h3, r3) {
          var e3 = [false], o3 = i5.uI(s5, n5, h3, e3);
          return e3[0] ? o3 : (e3 = new t4.l(), n5.A(e3), e3.X(1e3 * h3, 1e3 * h3), !(10 < s5.I() && (s5 = t4.Vd.clip(s5, e3, h3, 0), s5.B())) && t4.cm.aB(s5, n5, h3, r3));
        }, i5.vI = function(i6, s5, n5) {
          return t4.jd.Zd(i6, s5, n5) == 1;
        }, i5.CI = function(i6, s5, n5) {
          return t4.jd.Zd(i6, s5, n5) == 2;
        }, i5.lt = function(i6, s5, n5) {
          var h3 = new t4.h();
          n5 *= n5;
          for (var r3 = 0; r3 < i6.I(); r3++)
            if (i6.D(r3, h3), t4.h.zc(h3, s5) <= n5)
              return false;
          return true;
        }, i5.prototype.LE = function(t5, i6) {
          return t5 = this.th[t5], i6 = this.th[i6], t5.Om < i6.Om || t5.Om == i6.Om && (t5.rw < i6.rw || t5.rw == i6.rw && (t5.Mj < i6.Mj || t5.Mj == i6.Mj && (t5.Ui < i6.Ui || t5.Ui == i6.Ui && t5.wH < i6.wH))) ? -1 : 1;
        }, i5;
      }();
      t4.vd = n4;
    }(Q2 || (Q2 = {})), function(t4) {
      var i4, s4, n4;
      (s4 = i4 || (i4 = {}))[s4.InteriorInterior = 0] = "InteriorInterior", s4[s4.InteriorBoundary = 1] = "InteriorBoundary", s4[s4.InteriorExterior = 2] = "InteriorExterior", s4[s4.BoundaryInterior = 3] = "BoundaryInterior", s4[s4.BoundaryBoundary = 4] = "BoundaryBoundary", s4[s4.BoundaryExterior = 5] = "BoundaryExterior", s4[s4.ExteriorInterior = 6] = "ExteriorInterior", s4[s4.ExteriorBoundary = 7] = "ExteriorBoundary", s4[s4.ExteriorExterior = 8] = "ExteriorExterior", function(t5) {
        t5[t5.AreaAreaPredicates = 0] = "AreaAreaPredicates", t5[t5.AreaLinePredicates = 1] = "AreaLinePredicates", t5[t5.LineLinePredicates = 2] = "LineLinePredicates", t5[t5.AreaPointPredicates = 3] = "AreaPointPredicates", t5[t5.LinePointPredicates = 4] = "LinePointPredicates", t5[t5.PointPointPredicates = 5] = "PointPointPredicates";
      }(n4 || (n4 = {})), i4 = function() {
        function i5() {
          this.me = 0, this.j = new t4.ku(), this.J = [0, 0, 0, 0, 0, 0, 0, 0, 0], this.$a = [0, 0, 0, 0, 0, 0, 0, 0, 0], this.fa = [false, false, false, false, false, false, false, false, false], this.Um = this.xw = -1;
        }
        return i5.tB = function(i6, s5, n5, h3, r3) {
          if (h3.length != 9)
            throw t4.i.ga("relation string length has to be 9 characters");
          for (var e3 = 0; 9 > e3; e3++) {
            var o3 = h3.charAt(e3);
            if (o3 != "*" && o3 != "T" && o3 != "F" && o3 != "0" && o3 != "1" && o3 != "2")
              throw t4.i.ga("relation string");
          }
          if ((e3 = this.HR(h3, i6.Eb(), s5.Eb())) != 0)
            return t4.vd.uB(i6, s5, n5, e3, r3);
          e3 = new t4.l(), i6.A(e3), o3 = new t4.l(), s5.A(o3);
          var a3 = new t4.l();
          if (a3.L(e3), a3.$b(o3), n5 = t4.ua.Xd(n5, a3, false), i6 = this.RE(i6, n5), s5 = this.RE(s5, n5), i6.B() || s5.B())
            return this.pW(i6, s5, h3);
          switch (e3 = s5.K(), o3 = false, i6.K()) {
            case 1736:
              switch (e3) {
                case 1736:
                  o3 = this.st(i6, s5, n5, h3, r3);
                  break;
                case 1607:
                  o3 = this.bn(i6, s5, n5, h3, r3);
                  break;
                case 33:
                  o3 = this.rt(i6, s5, n5, h3);
                  break;
                case 550:
                  o3 = this.qt(i6, s5, n5, h3, r3);
              }
              break;
            case 1607:
              switch (e3) {
                case 1736:
                  o3 = this.bn(s5, i6, n5, this.aq(h3), r3);
                  break;
                case 1607:
                  o3 = this.bB(i6, s5, n5, h3, r3);
                  break;
                case 33:
                  o3 = this.ut(i6, s5, n5, h3, r3);
                  break;
                case 550:
                  o3 = this.tt(i6, s5, n5, h3, r3);
              }
              break;
            case 33:
              switch (e3) {
                case 1736:
                  o3 = this.rt(s5, i6, n5, this.aq(h3));
                  break;
                case 1607:
                  o3 = this.ut(s5, i6, n5, this.aq(h3), r3);
                  break;
                case 33:
                  o3 = this.VU(i6, s5, n5, h3);
                  break;
                case 550:
                  o3 = this.mt(s5, i6, n5, this.aq(h3));
              }
              break;
            case 550:
              switch (e3) {
                case 1736:
                  o3 = this.qt(s5, i6, n5, this.aq(h3), r3);
                  break;
                case 1607:
                  o3 = this.tt(s5, i6, n5, this.aq(h3), r3);
                  break;
                case 550:
                  o3 = this.UA(i6, s5, n5, h3, r3);
                  break;
                case 33:
                  o3 = this.mt(i6, s5, n5, h3);
              }
              break;
            default:
              o3 = false;
          }
          return o3;
        }, i5.st = function(s5, n5, h3, r3, e3) {
          var o3 = new i5();
          o3.$i(), o3.dj(r3), o3.sJ();
          var a3 = new t4.l(), u3 = new t4.l();
          return s5.A(a3), n5.A(u3), r3 = false, t4.vd.fk(a3, u3, h3) && (o3.Eu(s5, n5), r3 = true), r3 || ((a3 = t4.vd.rc(s5, n5, false)) == 4 ? (o3.Eu(s5, n5), r3 = true) : a3 == 1 ? (o3.hy(n5), r3 = true) : a3 == 2 && (o3.UD(s5), r3 = true)), r3 || (s5 = (r3 = new t4.hd()).Ib(s5), n5 = r3.Ib(n5), o3.Yo(r3, h3, e3), o3.Dp(s5, n5), o3.j.Wg()), i5.hg(o3.J, o3.Yc);
        }, i5.Uw = function(s5, n5, h3, r3) {
          var e3 = new i5();
          e3.$i(), e3.dj("T*****F**"), e3.sJ();
          var o3 = new t4.l(), a3 = new t4.l();
          s5.A(o3), n5.A(a3);
          var u3 = false;
          return t4.vd.fk(o3, a3, h3) && (e3.Eu(s5, n5), u3 = true), u3 || ((o3 = t4.vd.rc(s5, n5, false)) == 4 ? (e3.Eu(s5, n5), u3 = true) : o3 == 1 ? (e3.hy(n5), u3 = true) : o3 == 2 && (e3.UD(s5), u3 = true)), u3 ? this.hg(e3.J, e3.Yc) : (s5 = (u3 = new t4.hd()).Ib(s5), o3 = u3.Ib(n5), t4.Vk.W(u3, h3, r3, false), h3 = u3.Ke(o3).ng(), u3.Ip(0, true, true), t4.tn.W(u3, s5, -1, false, r3), u3.I(s5) != 0 && (t4.tn.W(u3, o3, -1, false, r3), e3.gr(u3, r3), (n5 = u3.I(o3) == 0) || (e3.Dp(s5, o3), e3.j.Wg(), o3 = this.hg(e3.J, e3.Yc)) ? (s5 = u3.Ke(s5), s5 = (u3 = new t4.hd()).Ib(s5), o3 = u3.Ib(h3), e3.gr(u3, r3), e3.me = 0, e3.$i(), e3.dj(n5 ? "T*****F**" : "******F**"), e3.DB(), e3.Dp(s5, o3), e3.j.Wg(), this.hg(e3.J, e3.Yc)) : o3));
        }, i5.bn = function(s5, n5, h3, r3, e3) {
          var o3 = new i5();
          o3.$i(), o3.dj(r3), o3.DB();
          var a3 = new t4.l(), u3 = new t4.l();
          return s5.A(a3), n5.A(u3), r3 = false, t4.vd.fk(a3, u3, h3) && (o3.Fu(s5, n5), r3 = true), r3 || ((a3 = t4.vd.rc(s5, n5, false)) == 4 ? (o3.Fu(s5, n5), r3 = true) : a3 == 1 && (o3.VD(n5), r3 = true)), r3 || (s5 = (r3 = new t4.hd()).Ib(s5), n5 = r3.Ib(n5), o3.Yo(r3, h3, e3), o3.mh = o3.j.Fp(), i5.Lw(n5, o3.j, o3.mh), o3.Dp(s5, n5), o3.j.Gp(o3.mh), o3.j.Wg()), i5.hg(o3.J, o3.Yc);
        }, i5.aB = function(s5, n5, h3, r3) {
          var e3 = new i5();
          e3.$i(), e3.dj("T*****F**"), e3.DB();
          var o3 = new t4.l(), a3 = new t4.l();
          s5.A(o3), n5.A(a3);
          var u3 = false;
          return t4.vd.fk(o3, a3, h3) && (e3.Fu(s5, n5), u3 = true), u3 || ((o3 = t4.vd.rc(s5, n5, false)) == 4 ? (e3.Fu(s5, n5), u3 = true) : o3 == 1 && (e3.VD(n5), u3 = true)), u3 ? this.hg(e3.J, e3.Yc) : (s5 = (u3 = new t4.hd()).Ib(s5), n5 = u3.Ib(n5), e3.Yo(u3, h3, r3), u3.I(s5) != 0 && (e3.Dp(s5, n5), e3.j.Wg(), this.hg(e3.J, e3.Yc)));
        }, i5.qt = function(s5, n5, h3, r3, e3) {
          var o3 = new i5();
          o3.$i(), o3.dj(r3), o3.tJ();
          var a3 = new t4.l(), u3 = new t4.l();
          return s5.A(a3), n5.A(u3), r3 = false, t4.vd.fk(a3, u3, h3) && (o3.Gu(s5), r3 = true), r3 || ((a3 = t4.vd.rc(s5, n5, false)) == 4 ? (o3.Gu(s5), r3 = true) : a3 == 1 && (o3.uN(), r3 = true)), r3 || (s5 = (r3 = new t4.hd()).Ib(s5), n5 = r3.Ib(n5), o3.Yo(r3, h3, e3), o3.By(s5, n5), o3.j.Wg()), i5.hg(o3.J, o3.Yc);
        }, i5.bB = function(s5, n5, h3, r3, e3) {
          var o3 = new i5();
          o3.$i(), o3.dj(r3), o3.$W(), r3 = new t4.l();
          var a3 = new t4.l();
          s5.A(r3), n5.A(a3);
          var u3 = false;
          return t4.vd.fk(r3, a3, h3) && (o3.KG(s5, n5), u3 = true), u3 || t4.vd.rc(s5, n5, false) != 4 || (o3.KG(s5, n5), u3 = true), u3 || (s5 = (r3 = new t4.hd()).Ib(s5), n5 = r3.Ib(n5), o3.Yo(r3, h3, e3), o3.$h = o3.j.Fp(), o3.mh = o3.j.Fp(), i5.Lw(s5, o3.j, o3.$h), i5.Lw(n5, o3.j, o3.mh), o3.Dp(s5, n5), o3.j.Gp(o3.$h), o3.j.Gp(o3.mh), o3.j.Wg()), i5.hg(o3.J, o3.Yc);
        }, i5.tt = function(s5, n5, h3, r3, e3) {
          var o3 = new i5();
          o3.$i(), o3.dj(r3), o3.HJ(), r3 = new t4.l();
          var a3 = new t4.l();
          s5.A(r3), n5.A(a3);
          var u3 = false;
          return t4.vd.fk(r3, a3, h3) && (o3.Qz(s5), u3 = true), u3 || t4.vd.rc(s5, n5, false) != 4 || (o3.Qz(s5), u3 = true), u3 || (s5 = (r3 = new t4.hd()).Ib(s5), n5 = r3.Ib(n5), o3.Yo(r3, h3, e3), o3.$h = o3.j.Fp(), i5.Lw(s5, o3.j, o3.$h), o3.By(s5, n5), o3.j.Gp(o3.$h), o3.j.Wg()), i5.hg(o3.J, o3.Yc);
        }, i5.UA = function(s5, n5, h3, r3, e3) {
          var o3 = new i5();
          o3.$i(), o3.dj(r3), o3.MJ(), r3 = new t4.l();
          var a3 = new t4.l();
          s5.A(r3), n5.A(a3);
          var u3 = false;
          return t4.vd.fk(r3, a3, h3) && (o3.tI(), u3 = true), u3 || (s5 = (r3 = new t4.hd()).Ib(s5), n5 = r3.Ib(n5), o3.Yo(r3, h3, e3), o3.By(s5, n5), o3.j.Wg()), i5.hg(o3.J, o3.Yc);
        }, i5.rt = function(s5, n5, h3, r3) {
          var e3 = new i5();
          e3.$i(), e3.dj(r3), e3.tJ();
          var o3 = new t4.l();
          s5.A(o3), n5 = n5.D();
          var a3 = false;
          return t4.vd.Tw(n5, o3, h3) && (e3.Gu(s5), a3 = true), a3 || ((h3 = t4.jd.Zd(s5, n5, h3)) == 1 ? (e3.J[0] = 0, e3.J[2] = 2, e3.J[3] = -1, e3.J[5] = 1, e3.J[6] = -1) : h3 == 2 ? (e3.J[6] = -1, s5.He() != 0 ? (e3.J[0] = -1, e3.J[3] = 0, e3.J[2] = 2, e3.J[5] = 1) : (e3.J[0] = 0, e3.J[3] = -1, e3.J[5] = -1, h3 = new t4.l(), s5.A(h3), e3.J[2] = h3.da() == 0 && h3.S() == 0 ? -1 : 1)) : e3.Gu(s5)), this.hg(e3.J, r3);
        }, i5.ut = function(s5, n5, h3, r3, e3) {
          var o3 = new i5();
          o3.$i(), o3.dj(r3), o3.HJ();
          var a3 = new t4.l();
          s5.A(a3), r3 = n5.D();
          var u3 = false;
          if (t4.vd.Tw(r3, a3, h3) && (o3.Qz(s5), u3 = true), !u3) {
            a3 = null;
            var f3 = u3 = false;
            (o3.fa[0] || o3.fa[6]) && (t4.vd.Tz(s5, r3, h3) ? (o3.fa[0] && (a3 = t4.si.im(s5, e3), f3 = !t4.vd.lt(a3, r3, h3), u3 = true, o3.J[0] = f3 ? -1 : 0), o3.J[6] = -1) : (o3.J[0] = -1, o3.J[6] = 0)), o3.fa[3] && (a3 != null && a3.B() ? o3.J[3] = -1 : (u3 || (a3 == null && (a3 = t4.si.im(s5, e3)), f3 = !t4.vd.lt(a3, r3, h3), u3 = true), o3.J[3] = f3 ? 0 : -1)), o3.fa[5] && (a3 != null && a3.B() ? o3.J[5] = -1 : u3 && !f3 ? o3.J[5] = 0 : (a3 == null && (a3 = t4.si.im(s5, e3)), e3 = t4.vd.Pw(a3, n5, h3), o3.J[5] = e3 ? -1 : 0)), o3.fa[2] && (s5.Rb() != 0 ? o3.J[2] = 1 : ((e3 = new t4.ee(s5.description)).Gd(s5, 0, s5.I()), s5 = t4.vd.Pw(e3, n5, h3), o3.J[2] = s5 ? -1 : 0));
          }
          return this.hg(o3.J, o3.Yc);
        }, i5.mt = function(s5, n5, h3, r3) {
          var e3 = new i5();
          e3.$i(), e3.dj(r3), e3.MJ();
          var o3 = new t4.l();
          s5.A(o3), n5 = n5.D();
          var a3 = false;
          if (t4.vd.Tw(n5, o3, h3) && (e3.tI(), a3 = true), !a3) {
            o3 = false, a3 = true, h3 *= h3;
            for (var u3 = 0; u3 < s5.I(); u3++) {
              var f3 = s5.Oa(u3);
              if (t4.h.zc(f3, n5) <= h3 ? o3 = true : a3 = false, o3 && !a3)
                break;
            }
            o3 ? (e3.J[0] = 0, e3.J[2] = a3 ? -1 : 0, e3.J[6] = -1) : (e3.J[0] = -1, e3.J[2] = 0, e3.J[6] = 0);
          }
          return i5.hg(e3.J, r3);
        }, i5.VU = function(s5, n5, h3, r3) {
          s5 = s5.D(), n5 = n5.D();
          for (var e3 = [], o3 = 0; 9 > o3; o3++)
            e3[o3] = -1;
          return t4.h.zc(s5, n5) <= h3 * h3 ? e3[0] = 0 : (e3[2] = 0, e3[6] = 0), e3[8] = 2, i5.hg(e3, r3);
        }, i5.hg = function(t5, i6) {
          for (var s5 = 0; 9 > s5; s5++)
            switch (i6.charAt(s5)) {
              case "T":
                if (t5[s5] == -1)
                  return false;
                break;
              case "F":
                if (t5[s5] != -1)
                  return false;
                break;
              case "0":
                if (t5[s5] != 0)
                  return false;
                break;
              case "1":
                if (t5[s5] != 1)
                  return false;
                break;
              case "2":
                if (t5[s5] != 2)
                  return false;
            }
          return true;
        }, i5.pW = function(i6, s5, n5) {
          var h3 = [-1, -1, -1, -1, -1, -1, -1, -1, -1];
          if (i6.B() && s5.B()) {
            for (var r3 = 0; 9 > r3; r3++)
              h3[r3] = -1;
            return this.hg(h3, n5);
          }
          return r3 = false, i6.B() && (i6 = s5, r3 = true), h3[0] = -1, h3[1] = -1, h3[3] = -1, h3[4] = -1, h3[6] = -1, h3[7] = -1, h3[8] = 2, s5 = i6.K(), t4.ba.Ic(s5) ? s5 == 1736 ? i6.He() != 0 ? (h3[2] = 2, h3[5] = 1) : (h3[5] = -1, s5 = new t4.l(), i6.A(s5), h3[2] = s5.da() == 0 && s5.S() == 0 ? 0 : 1) : (s5 = i6.Rb() != 0, h3[2] = s5 ? 1 : 0, h3[5] = t4.si.cq(i6) ? 0 : -1) : (h3[2] = 0, h3[5] = -1), r3 && this.qK(h3), this.hg(h3, n5);
        }, i5.HR = function(t5, s5, n5) {
          return i5.ZP(t5) ? 3 : i5.PP(t5) ? 4 : i5.ZX(t5, s5, n5) ? 8 : i5.xP(t5, s5, n5) ? 16 : i5.$O(t5) ? 1 : i5.zU(t5, s5, n5) ? 32 : 0;
        }, i5.ZP = function(t5) {
          return t5.charAt(0) == "T" && t5.charAt(1) == "*" && t5.charAt(2) == "F" && t5.charAt(3) == "*" && t5.charAt(4) == "*" && t5.charAt(5) == "F" && t5.charAt(6) == "F" && t5.charAt(7) == "F" && t5.charAt(8) == "*";
        }, i5.PP = function(t5) {
          return t5.charAt(0) == "F" && t5.charAt(1) == "F" && t5.charAt(2) == "*" && t5.charAt(3) == "F" && t5.charAt(4) == "F" && t5.charAt(5) == "*" && t5.charAt(6) == "*" && t5.charAt(7) == "*" && t5.charAt(8) == "*";
        }, i5.ZX = function(t5, i6, s5) {
          return (i6 != 0 || s5 != 0) && ((i6 != 2 || s5 != 2) && (t5.charAt(0) == "F" && t5.charAt(1) == "*" && t5.charAt(2) == "*" && t5.charAt(3) == "T" && t5.charAt(4) == "*" && t5.charAt(5) == "*" && t5.charAt(6) == "*" && t5.charAt(7) == "*" && t5.charAt(8) == "*" || i6 == 1 && s5 == 1 && t5.charAt(0) == "F" && t5.charAt(1) == "T" && t5.charAt(2) == "*" && t5.charAt(3) == "*" && t5.charAt(4) == "*" && t5.charAt(5) == "*" && t5.charAt(6) == "*" && t5.charAt(7) == "*" && t5.charAt(8) == "*") || s5 != 0 && t5.charAt(0) == "F" && t5.charAt(1) == "*" && t5.charAt(2) == "*" && t5.charAt(3) == "*" && t5.charAt(4) == "T" && t5.charAt(5) == "*" && t5.charAt(6) == "*" && t5.charAt(7) == "*" && t5.charAt(8) == "*");
        }, i5.xP = function(t5, i6, s5) {
          return i6 > s5 ? t5.charAt(0) == "T" && t5.charAt(1) == "*" && t5.charAt(2) == "*" && t5.charAt(3) == "*" && t5.charAt(4) == "*" && t5.charAt(5) == "*" && t5.charAt(6) == "T" && t5.charAt(7) == "*" && t5.charAt(8) == "*" : i6 == 1 && s5 == 1 && t5.charAt(0) == "0" && t5.charAt(1) == "*" && t5.charAt(2) == "*" && t5.charAt(3) == "*" && t5.charAt(4) == "*" && t5.charAt(5) == "*" && t5.charAt(6) == "*" && t5.charAt(7) == "*" && t5.charAt(8) == "*";
        }, i5.$O = function(t5) {
          return t5.charAt(0) == "T" && t5.charAt(1) == "*" && t5.charAt(2) == "*" && t5.charAt(3) == "*" && t5.charAt(4) == "*" && t5.charAt(5) == "*" && t5.charAt(6) == "F" && t5.charAt(7) == "F" && t5.charAt(8) == "*";
        }, i5.zU = function(t5, i6, s5) {
          if (i6 == s5) {
            if (i6 != 1)
              return t5.charAt(0) == "T" && t5.charAt(1) == "*" && t5.charAt(2) == "T" && t5.charAt(3) == "*" && t5.charAt(4) == "*" && t5.charAt(5) == "*" && t5.charAt(6) == "T" && t5.charAt(7) == "*" && t5.charAt(8) == "*";
            if (t5.charAt(0) == "1" && t5.charAt(1) == "*" && t5.charAt(2) == "T" && t5.charAt(3) == "*" && t5.charAt(4) == "*" && t5.charAt(5) == "*" && t5.charAt(6) == "T" && t5.charAt(7) == "*" && t5.charAt(8) == "*")
              return true;
          }
          return false;
        }, i5.Lw = function(t5, i6, s5) {
          t5 = i6.Ma(t5);
          for (var n5 = i6.Oe; n5 != -1; n5 = i6.Tf(n5))
            if ((i6.yd(n5) & t5) != 0) {
              var h3 = i6.Je(n5);
              if (h3 == -1)
                i6.pn(n5, s5, 0);
              else {
                var r3 = h3, e3 = 0;
                do {
                  (i6.fh(r3) & t5) != 0 && e3++, r3 = i6.kc(i6.ya(r3));
                } while (r3 != h3);
                i6.pn(n5, s5, e3);
              }
            }
        }, i5.aq = function(t5) {
          var i6 = "" + t5.charAt(0);
          return i6 += t5.charAt(3), i6 += t5.charAt(6), i6 += t5.charAt(1), i6 += t5.charAt(4), i6 += t5.charAt(7), i6 += t5.charAt(2), (i6 += t5.charAt(5)) + t5.charAt(8);
        }, i5.prototype.$i = function() {
          for (var t5 = 0; 9 > t5; t5++)
            this.J[t5] = -2, this.$a[t5] = -2;
        }, i5.qK = function(t5) {
          var i6 = t5[1], s5 = t5[2], n5 = t5[5];
          t5[1] = t5[3], t5[2] = t5[6], t5[5] = t5[7], t5[3] = i6, t5[6] = s5, t5[7] = n5;
        }, i5.prototype.dj = function(t5) {
          for (this.Yc = t5, t5 = 0; 9 > t5; t5++)
            this.Yc.charAt(t5) != "*" ? (this.fa[t5] = true, this.me++) : this.fa[t5] = false;
        }, i5.prototype.PJ = function() {
          for (var t5 = 0; 9 > t5; t5++)
            this.fa[t5] && this.J[t5] == -2 && (this.J[t5] = -1, this.fa[t5] = false);
        }, i5.prototype.qc = function(t5) {
          return this.J[t5] != -2 && (this.J[t5] == -1 ? (this.fa[t5] = false, this.me--, true) : this.Yc.charAt(t5) != "T" && this.Yc.charAt(t5) != "F" ? !(this.J[t5] < this.$a[t5]) && (this.fa[t5] = false, this.me--, true) : (this.fa[t5] = false, this.me--, true));
        }, i5.prototype.sJ = function() {
          this.xw = 0, this.$a[0] = 2, this.$a[1] = 1, this.$a[2] = 2, this.$a[3] = 1, this.$a[4] = 1, this.$a[5] = 1, this.$a[6] = 2, this.$a[7] = 1, this.$a[8] = 2, this.fa[8] && (this.J[8] = 2, this.fa[8] = false, this.me--);
        }, i5.prototype.DB = function() {
          this.xw = 1, this.Um = 3, this.$a[0] = 1, this.$a[1] = 0, this.$a[2] = 2, this.$a[3] = 1, this.$a[4] = 0, this.$a[5] = 1, this.$a[6] = 1, this.$a[7] = 0, this.$a[8] = 2, this.fa[8] && (this.J[8] = 2, this.fa[8] = false, this.me--);
        }, i5.prototype.$W = function() {
          this.xw = 2, this.Um = 4, this.$a[0] = 1, this.$a[1] = 0, this.$a[2] = 1, this.$a[3] = 0, this.$a[4] = 0, this.$a[5] = 0, this.$a[6] = 1, this.$a[7] = 0, this.$a[8] = 2, this.fa[8] && (this.J[8] = 2, this.fa[8] = false, this.me--);
        }, i5.prototype.tJ = function() {
          this.Um = 3, this.$a[0] = 0, this.$a[1] = -1, this.$a[2] = 2, this.$a[3] = 0, this.$a[4] = -1, this.$a[5] = 1, this.$a[6] = 0, this.$a[7] = -1, this.$a[8] = 2, this.fa[1] && (this.J[1] = -1, this.fa[1] = false, this.me--), this.fa[4] && (this.J[4] = -1, this.fa[4] = false, this.me--), this.fa[7] && (this.J[7] = -1, this.fa[7] = false, this.me--), this.fa[8] && (this.J[8] = 2, this.fa[8] = false, this.me--);
        }, i5.prototype.HJ = function() {
          this.Um = 4, this.$a[0] = 0, this.$a[1] = -1, this.$a[2] = 1, this.$a[3] = 0, this.$a[4] = -1, this.$a[5] = 0, this.$a[6] = 0, this.$a[7] = -1, this.$a[8] = 2, this.fa[1] && (this.J[1] = -1, this.fa[1] = false, this.me--), this.fa[4] && (this.J[4] = -1, this.fa[4] = false, this.me--), this.fa[7] && (this.J[7] = -1, this.fa[7] = false, this.me--), this.fa[8] && (this.J[8] = 2, this.fa[8] = false, this.me--);
        }, i5.prototype.MJ = function() {
          this.Um = 5, this.$a[0] = 0, this.$a[1] = -1, this.$a[2] = 0, this.$a[3] = -1, this.$a[4] = -1, this.$a[5] = -1, this.$a[6] = 0, this.$a[7] = -1, this.$a[8] = 2, this.fa[1] && (this.J[1] = -1, this.fa[1] = false, this.me--), this.fa[3] && (this.J[3] = -1, this.fa[3] = false, this.me--), this.fa[4] && (this.J[4] = -1, this.fa[4] = false, this.me--), this.fa[5] && (this.J[5] = -1, this.fa[5] = false, this.me--), this.fa[7] && (this.J[7] = -1, this.fa[7] = false, this.me--), this.fa[8] && (this.J[8] = 2, this.fa[8] = false, this.me--);
        }, i5.prototype.sN = function(t5, i6, s5) {
          var n5 = true;
          return this.fa[0] && (this.xS(t5, i6, s5), n5 = n5 && this.qc(0)), this.fa[1] && (this.nG(t5, i6, 1), n5 = n5 && this.qc(1)), this.fa[2] && (this.oG(t5, i6, s5, 2), n5 = n5 && this.qc(2)), this.fa[3] && (this.nG(t5, s5, 3), n5 = n5 && this.qc(3)), this.fa[4] && (this.wN(t5, i6, s5), n5 = n5 && this.qc(4)), this.fa[5] && (this.$D(t5, s5, 5), n5 = n5 && this.qc(5)), this.fa[6] && (this.oG(t5, s5, i6, 6), n5 = n5 && this.qc(6)), this.fa[7] && (this.$D(t5, i6, 7), n5 = n5 && this.qc(7)), n5;
        }, i5.prototype.Eu = function(t5, i6) {
          this.J[0] = -1, this.J[1] = -1, this.J[3] = -1, this.J[4] = -1, this.Hr(t5, this.fa[2] ? 2 : -1, this.Yc.charAt(2), this.fa[5] ? 5 : -1, this.Yc.charAt(5)), this.Hr(i6, this.fa[6] ? 6 : -1, this.Yc.charAt(6), this.fa[7] ? 7 : -1, this.Yc.charAt(7));
        }, i5.prototype.Hr = function(i6, s5, n5, h3, r3) {
          s5 == -1 && h3 == -1 || ((n5 != "T" && n5 != "F" && s5 != -1 || r3 != "T" && r3 != "F" && h3 != -1) && i6.He() == 0 ? (h3 != -1 && (this.J[h3] = -1), s5 != -1 && (n5 = new t4.l(), i6.A(n5), this.J[s5] = n5.da() == 0 && n5.S() == 0 ? 0 : 1)) : (s5 != -1 && (this.J[s5] = 2), h3 != -1 && (this.J[h3] = 1)));
        }, i5.prototype.hy = function(t5) {
          this.J[2] = 2, this.J[3] = -1, this.J[4] = -1, this.J[5] = 1, this.J[6] = -1, this.J[7] = -1, this.Hr(t5, this.fa[0] ? 0 : -1, this.Yc.charAt(0), this.fa[1] ? 1 : -1, this.Yc.charAt(1));
        }, i5.prototype.UD = function(t5) {
          this.hy(t5), i5.qK(this.J);
        }, i5.prototype.Fu = function(i6, s5) {
          if (this.J[0] = -1, this.J[1] = -1, this.J[3] = -1, this.J[4] = -1, this.fa[6]) {
            var n5 = this.Yc.charAt(6);
            n5 = n5 == "T" || n5 == "F" || s5.Rb() != 0, this.J[6] = n5 ? 1 : 0;
          }
          this.fa[7] && (s5 = t4.si.cq(s5), this.J[7] = s5 ? 0 : -1), this.Hr(i6, this.fa[2] ? 2 : -1, this.Yc.charAt(2), this.fa[5] ? 5 : -1, this.Yc.charAt(5));
        }, i5.prototype.VD = function(i6) {
          if (this.fa[0]) {
            var s5 = this.Yc.charAt(0);
            s5 = s5 == "T" || s5 == "F" || i6.Rb() != 0, this.J[0] = s5 ? 1 : 0;
          }
          this.fa[1] && (i6 = t4.si.cq(i6), this.J[1] = i6 ? 0 : -1), this.J[2] = 2, this.J[3] = -1, this.J[4] = -1, this.J[5] = 1, this.J[6] = -1, this.J[7] = -1;
        }, i5.prototype.Gu = function(t5) {
          this.J[0] = -1, this.J[3] = -1, this.J[6] = 0, this.Hr(t5, this.fa[2] ? 2 : -1, this.Yc.charAt(2), this.fa[5] ? 5 : -1, this.Yc.charAt(5));
        }, i5.prototype.uN = function() {
          this.J[0] = 0, this.J[2] = 2, this.J[3] = -1, this.J[5] = 1, this.J[6] = -1;
        }, i5.prototype.KG = function(i6, s5) {
          if (this.J[0] = -1, this.J[1] = -1, this.J[3] = -1, this.J[4] = -1, this.fa[2]) {
            var n5 = this.Yc.charAt(2);
            n5 = n5 == "T" || n5 == "F" || i6.Rb() != 0, this.J[2] = n5 ? 1 : 0;
          }
          this.fa[5] && (i6 = t4.si.cq(i6), this.J[5] = i6 ? 0 : -1), this.fa[6] && (n5 = (n5 = this.Yc.charAt(6)) == "T" || n5 == "F" || s5.Rb() != 0, this.J[6] = n5 ? 1 : 0), this.fa[7] && (s5 = t4.si.cq(s5), this.J[7] = s5 ? 0 : -1);
        }, i5.prototype.Qz = function(i6) {
          if (this.J[0] = -1, this.J[3] = -1, this.fa[2]) {
            var s5 = this.Yc.charAt(2);
            s5 = s5 == "T" || s5 == "F" || i6.Rb() != 0, this.J[2] = s5 ? 1 : 0;
          }
          this.fa[5] && (i6 = t4.si.cq(i6), this.J[5] = i6 ? 0 : -1), this.J[6] = 0;
        }, i5.prototype.tI = function() {
          this.J[0] = -1, this.J[2] = 0, this.J[6] = 0;
        }, i5.prototype.tN = function(t5, i6, s5) {
          var n5 = true;
          return this.fa[0] && (this.yS(t5, i6), n5 = n5 && this.qc(0)), this.fa[1] && (this.uS(t5, i6, s5, this.mh), n5 = n5 && this.qc(1)), this.fa[2] && (this.vS(t5, i6), n5 = n5 && this.qc(2)), this.fa[3] && (this.AN(t5, i6, s5, this.mh), n5 = n5 && this.qc(3)), this.fa[4] && (this.xN(t5, i6, s5, this.mh), n5 = n5 && this.qc(4)), this.fa[5] && (this.yN(t5, i6, s5), n5 = n5 && this.qc(5)), this.fa[6] && (this.gQ(t5, i6), n5 = n5 && this.qc(6)), this.fa[7] && (this.fQ(t5, i6, s5, this.mh), n5 = n5 && this.qc(7)), n5;
        }, i5.prototype.hT = function(t5, i6, s5) {
          var n5 = true;
          return this.fa[0] && (this.BS(t5, i6, s5, this.$h, this.mh), n5 = n5 && this.qc(0)), this.fa[1] && (this.pG(t5, i6, s5, this.$h, this.mh, 1), n5 = n5 && this.qc(1)), this.fa[2] && (this.qG(t5, i6, s5, 2), n5 = n5 && this.qc(2)), this.fa[3] && (this.pG(t5, s5, i6, this.mh, this.$h, 3), n5 = n5 && this.qc(3)), this.fa[4] && (this.CN(t5, i6, s5, this.$h, this.mh), n5 = n5 && this.qc(4)), this.fa[5] && (this.aE(t5, s5, this.$h, 5), n5 = n5 && this.qc(5)), this.fa[6] && (this.qG(t5, s5, i6, 6), n5 = n5 && this.qc(6)), this.fa[7] && (this.aE(t5, i6, this.mh, 7), n5 = n5 && this.qc(7)), n5;
        }, i5.prototype.WD = function(t5, i6, s5) {
          var n5 = true;
          return this.fa[0] && (this.zS(t5, i6), n5 = n5 && this.qc(0)), this.fa[2] && (this.wS(t5, i6), n5 = n5 && this.qc(2)), this.fa[3] && (this.BN(t5, i6, s5), n5 = n5 && this.qc(3)), this.fa[5] && (this.zN(t5, i6), n5 = n5 && this.qc(5)), this.fa[6] && (this.hQ(t5, i6), n5 = n5 && this.qc(6)), n5;
        }, i5.prototype.LG = function(t5, i6, s5) {
          var n5 = true;
          return this.fa[0] && (this.CS(t5, i6, s5, this.$h), n5 = n5 && this.qc(0)), this.fa[2] && (this.AS(t5, s5), n5 = n5 && this.qc(2)), this.fa[3] && (this.EN(t5, i6, s5, this.$h), n5 = n5 && this.qc(3)), this.fa[5] && (this.DN(t5, i6, s5, this.$h), n5 = n5 && this.qc(5)), this.fa[6] && (this.iQ(t5, i6, s5), n5 = n5 && this.qc(6)), n5;
        }, i5.prototype.UU = function(t5, i6, s5) {
          var n5 = true;
          return this.fa[0] && (this.DS(t5, i6, s5), n5 = n5 && this.qc(0)), this.fa[2] && (this.rG(t5, i6, s5, 2), n5 = n5 && this.qc(2)), this.fa[6] && (this.rG(t5, s5, i6, 6), n5 = n5 && this.qc(6)), n5;
        }, i5.prototype.xS = function(t5, i6, s5) {
          this.J[0] != 2 && (((t5 = this.j.af(t5)) & i6) != 0 && (t5 & s5) != 0 && (this.J[0] = 2));
        }, i5.prototype.nG = function(t5, i6, s5) {
          if (this.J[s5] != 1) {
            var n5 = this.j.af(this.j.ya(t5));
            (this.j.af(t5) & i6) != 0 && (n5 & i6) != 0 && (this.J[s5] = 1);
          }
        }, i5.prototype.oG = function(t5, i6, s5, n5) {
          this.J[n5] != 2 && (((t5 = this.j.af(t5)) & i6) != 0 && (t5 & s5) == 0 && (this.J[n5] = 2));
        }, i5.prototype.wN = function(t5, i6, s5) {
          if (this.J[4] != 1) {
            var n5 = this.j.fh(t5);
            (n5 & i6) != 0 && (n5 & s5) != 0 ? this.J[4] = 1 : this.J[4] != 0 && this.j.Bb(this.j.ue(this.j.ya(t5)), this.Wi) != 1 && (((t5 = this.j.yd(this.j.vf(t5))) & i6) != 0 && (t5 & s5) != 0 && (this.J[4] = 0));
          }
        }, i5.prototype.$D = function(t5, i6, s5) {
          if (this.J[s5] != 1) {
            var n5 = this.j.af(this.j.ya(t5));
            (this.j.af(t5) & i6) == 0 && (n5 & i6) == 0 && (this.J[s5] = 1);
          }
        }, i5.prototype.yS = function(t5, i6) {
          if (this.J[0] != 1) {
            var s5 = this.j.af(this.j.ya(t5));
            (this.j.af(t5) & i6) != 0 && (s5 & i6) != 0 && (this.J[0] = 1);
          }
        }, i5.prototype.uS = function(t5, i6, s5, n5) {
          if (this.J[1] != 0 && this.j.Bb(this.j.ue(this.j.ya(t5)), this.Wi) != 1) {
            var h3 = this.j.vf(t5), r3 = this.j.yd(h3);
            (r3 & i6) == 0 && (this.j.af(t5) & i6) != 0 && (t5 = this.j.og(h3, n5), (r3 & s5) != 0 && t5 % 2 != 0 && (this.J[1] = 0));
          }
        }, i5.prototype.vS = function(t5, i6) {
          this.J[2] != 2 && (this.j.fh(t5) & i6) != 0 && (this.J[2] = 2);
        }, i5.prototype.AN = function(t5, i6, s5, n5) {
          if (this.J[3] != 1) {
            var h3 = this.j.fh(t5);
            (h3 & i6) != 0 && (h3 & s5) != 0 ? this.J[3] = 1 : this.J[3] != 0 && this.j.Bb(this.j.ue(this.j.ya(t5)), this.Wi) != 1 && (h3 = this.j.vf(t5), ((t5 = this.j.yd(h3)) & i6) != 0 && (i6 = this.j.og(h3, n5), (t5 & s5) != 0 && i6 % 2 == 0 && (this.J[3] = 0)));
          }
        }, i5.prototype.xN = function(t5, i6, s5, n5) {
          if (this.J[4] != 0 && this.j.Bb(this.j.ue(this.j.ya(t5)), this.Wi) != 1) {
            var h3 = this.j.vf(t5);
            ((t5 = this.j.yd(h3)) & i6) != 0 && (i6 = this.j.og(h3, n5), (t5 & s5) != 0 && i6 % 2 != 0 && (this.J[4] = 0));
          }
        }, i5.prototype.yN = function(t5, i6, s5) {
          this.J[5] != 1 && (((t5 = this.j.fh(t5)) & i6) != 0 && (t5 & s5) == 0 && (this.J[5] = 1));
        }, i5.prototype.gQ = function(t5, i6) {
          if (this.J[6] != 1) {
            var s5 = this.j.af(this.j.ya(t5));
            (this.j.af(t5) & i6) == 0 && (s5 & i6) == 0 && (this.J[6] = 1);
          }
        }, i5.prototype.fQ = function(t5, i6, s5, n5) {
          if (this.J[7] != 0 && this.j.Bb(this.j.ue(this.j.ya(t5)), this.Wi) != 1) {
            var h3 = this.j.vf(t5), r3 = this.j.yd(h3);
            (r3 & i6) == 0 && (this.j.af(t5) & i6) == 0 && (t5 = this.j.og(h3, n5), (r3 & s5) != 0 && t5 % 2 != 0 && (this.J[7] = 0));
          }
        }, i5.prototype.BS = function(t5, i6, s5, n5, h3) {
          if (this.J[0] != 1) {
            var r3 = this.j.fh(t5);
            (r3 & i6) != 0 && (r3 & s5) != 0 ? this.J[0] = 1 : this.J[0] != 0 && this.j.Bb(this.j.ue(this.j.ya(t5)), this.Wi) != 1 && (t5 = this.j.vf(t5), ((r3 = this.j.yd(t5)) & i6) != 0 && (r3 & s5) != 0 && (i6 = this.j.og(t5, n5), h3 = this.j.og(t5, h3), i6 % 2 == 0 && h3 % 2 == 0 && (this.J[0] = 0)));
          }
        }, i5.prototype.pG = function(t5, i6, s5, n5, h3, r3) {
          if (this.J[r3] != 0 && this.j.Bb(this.j.ue(this.j.ya(t5)), this.Wi) != 1) {
            t5 = this.j.vf(t5);
            var e3 = this.j.yd(t5);
            (e3 & i6) != 0 && (e3 & s5) != 0 && (i6 = this.j.og(t5, n5), h3 = this.j.og(t5, h3), i6 % 2 == 0 && h3 % 2 != 0 && (this.J[r3] = 0));
          }
        }, i5.prototype.qG = function(t5, i6, s5, n5) {
          this.J[n5] != 1 && (((t5 = this.j.fh(t5)) & i6) != 0 && (t5 & s5) == 0 && (this.J[n5] = 1));
        }, i5.prototype.CN = function(t5, i6, s5, n5, h3) {
          if (this.J[4] != 0 && this.j.Bb(this.j.ue(this.j.ya(t5)), this.Wi) != 1) {
            t5 = this.j.vf(t5);
            var r3 = this.j.yd(t5);
            (r3 & i6) != 0 && (r3 & s5) != 0 && (i6 = this.j.og(t5, n5), h3 = this.j.og(t5, h3), i6 % 2 != 0 && h3 % 2 != 0 && (this.J[4] = 0));
          }
        }, i5.prototype.aE = function(t5, i6, s5, n5) {
          this.J[n5] != 0 && this.j.Bb(this.j.ue(this.j.ya(t5)), this.Wi) != 1 && (t5 = this.j.vf(t5), (this.j.yd(t5) & i6) == 0 && this.j.og(t5, s5) % 2 != 0 && (this.J[n5] = 0));
        }, i5.prototype.zS = function(t5, i6) {
          this.J[0] != 0 && (this.j.yd(t5) & i6) == 0 && (this.j.jk(this.j.Yy(t5)) & i6) != 0 && (this.J[0] = 0);
        }, i5.prototype.wS = function(t5, i6) {
          this.J[2] != 2 && (this.j.yd(t5) & i6) != 0 && (this.J[2] = 2);
        }, i5.prototype.BN = function(t5, i6, s5) {
          this.J[3] != 0 && (((t5 = this.j.yd(t5)) & i6) != 0 && (t5 & s5) != 0 && (this.J[3] = 0));
        }, i5.prototype.zN = function(t5, i6) {
          this.J[5] != 1 && (this.j.yd(t5) & i6) != 0 && (this.J[5] = 1);
        }, i5.prototype.hQ = function(t5, i6) {
          this.J[6] != 0 && (this.j.yd(t5) & i6) == 0 && (this.j.jk(this.j.Yy(t5)) & i6) == 0 && (this.J[6] = 0);
        }, i5.prototype.CS = function(t5, i6, s5, n5) {
          if (this.J[0] != 0) {
            var h3 = this.j.yd(t5);
            (h3 & i6) != 0 && (h3 & s5) != 0 && this.j.og(t5, n5) % 2 == 0 && (this.J[0] = 0);
          }
        }, i5.prototype.AS = function(t5, i6) {
          this.J[2] != 1 && (this.j.Je(t5) != -1 ? this.J[2] = 1 : this.J[2] != 0 && (this.j.yd(t5) & i6) == 0 && (this.J[2] = 0));
        }, i5.prototype.EN = function(t5, i6, s5, n5) {
          if (this.J[3] != 0) {
            var h3 = this.j.yd(t5);
            (h3 & i6) != 0 && (h3 & s5) != 0 && this.j.og(t5, n5) % 2 != 0 && (this.J[3] = 0);
          }
        }, i5.prototype.DN = function(t5, i6, s5, n5) {
          if (this.J[5] != 0) {
            var h3 = this.j.yd(t5);
            (h3 & i6) != 0 && (h3 & s5) == 0 && this.j.og(t5, n5) % 2 != 0 && (this.J[5] = 0);
          }
        }, i5.prototype.iQ = function(t5, i6, s5) {
          this.J[6] != 0 && (((t5 = this.j.yd(t5)) & i6) == 0 && (t5 & s5) != 0 && (this.J[6] = 0));
        }, i5.prototype.DS = function(t5, i6, s5) {
          this.J[0] != 0 && (((t5 = this.j.yd(t5)) & i6) != 0 && (t5 & s5) != 0 && (this.J[0] = 0));
        }, i5.prototype.rG = function(t5, i6, s5, n5) {
          this.J[n5] != 0 && (((t5 = this.j.yd(t5)) & i6) != 0 && (t5 & s5) == 0 && (this.J[n5] = 0));
        }, i5.prototype.Dp = function(i6, s5) {
          var n5 = false;
          i6 = this.j.Ma(i6), s5 = this.j.Ma(s5), this.Wi = this.j.bh();
          for (var h3 = this.j.Oe; h3 != -1; h3 = this.j.Tf(h3)) {
            var r3 = this.j.Je(h3);
            if (r3 == -1) {
              if (this.Um != -1)
                switch (this.Um) {
                  case 3:
                    n5 = this.WD(h3, i6, s5);
                    break;
                  case 4:
                    n5 = this.LG(h3, i6, s5);
                    break;
                  default:
                    throw t4.i.ga("internal error");
                }
            } else {
              var e3 = r3;
              do {
                var o3 = e3;
                if (this.j.Bb(o3, this.Wi) != 1)
                  do {
                    switch (this.xw) {
                      case 0:
                        n5 = this.sN(o3, i6, s5);
                        break;
                      case 1:
                        n5 = this.tN(o3, i6, s5);
                        break;
                      case 2:
                        n5 = this.hT(o3, i6, s5);
                        break;
                      default:
                        throw t4.i.ga("internal error");
                    }
                    if (n5)
                      break;
                    this.j.Kb(o3, this.Wi, 1), o3 = this.j.kc(o3);
                  } while (o3 != e3 && !n5);
                if (n5)
                  break;
                e3 = this.j.kc(this.j.ya(o3));
              } while (e3 != r3);
              if (n5)
                break;
            }
          }
          n5 || this.PJ(), this.j.Lg(this.Wi);
        }, i5.prototype.By = function(i6, s5) {
          var n5 = false;
          i6 = this.j.Ma(i6), s5 = this.j.Ma(s5);
          for (var h3 = this.j.Oe; h3 != -1; h3 = this.j.Tf(h3)) {
            switch (this.Um) {
              case 3:
                n5 = this.WD(h3, i6, s5);
                break;
              case 4:
                n5 = this.LG(h3, i6, s5);
                break;
              case 5:
                n5 = this.UU(h3, i6, s5);
                break;
              default:
                throw t4.i.Ra();
            }
            if (n5)
              break;
          }
          n5 || this.PJ();
        }, i5.prototype.gr = function(t5, i6) {
          this.j.fr(t5, i6);
        }, i5.prototype.Yo = function(t5, i6, s5) {
          this.TP(t5, i6, s5), this.gr(t5, s5);
        }, i5.prototype.TP = function(i6, s5, n5) {
          for (t4.Vk.W(i6, s5, n5, false), i6.Ip(0, true, true), s5 = i6.md; s5 != -1; s5 = i6.ve(s5))
            i6.jc(s5) == 1736 && t4.tn.W(i6, s5, -1, false, n5);
        }, i5.RE = function(i6, s5) {
          var n5 = i6.K();
          return t4.ba.zd(n5) ? ((s5 = new t4.Ua(i6.description)).pc(i6, true), s5) : n5 == 197 ? (n5 = new t4.l(), i6.A(n5), n5.da() <= s5 && n5.S() <= s5 ? (s5 = new t4.Ta(i6.description), i6.tf(s5), s5) : n5.da() <= s5 || n5.S() <= s5 ? (s5 = new t4.Ua(i6.description), n5 = new t4.Ta(), i6.If(0, n5), s5.nf(n5), i6.If(2, n5), s5.lineTo(n5), s5) : ((s5 = new t4.Ea(i6.description)).bd(i6, false), s5)) : i6;
        }, i5;
      }(), t4.cm = i4;
    }(Q2 || (Q2 = {})), function(t4) {
      var i4 = function() {
        function i5(i6) {
          this.Gm = new t4.ja(0), this.fw = new t4.ja(0), this.xt = new t4.h(), this.yt = new t4.h(), this.g = i6, this.Js = -1;
        }
        return i5.prototype.cc = function(t5) {
          return this.g.cc(this.uz(t5));
        }, i5.prototype.Dv = function(t5) {
          var i6 = this.dz(t5);
          if (t5 = this.CF(t5), this.g.Na(i6) == t5) {
            var s5 = i6;
            i6 = t5, t5 = s5;
          }
          return this.g.Hc(i6, this.xt), this.g.Hc(t5, this.yt), this.xt.y < this.yt.y;
        }, i5.prototype.uz = function(t5) {
          var i6 = this.dz(t5);
          return t5 = this.CF(t5), this.g.V(i6) == t5 ? i6 : t5;
        }, i5.prototype.dz = function(t5) {
          return this.Gm.get(t5);
        }, i5.prototype.CF = function(t5) {
          return this.fw.get(t5);
        }, i5.prototype.mF = function(t5) {
          this.Gm.set(t5, this.Js), this.Js = t5;
        }, i5.prototype.iI = function(i6) {
          if (this.Js != -1) {
            var s5 = this.Js;
            return this.Js = this.Gm.get(s5), this.Gm.set(s5, i6), this.fw.set(s5, this.g.V(i6)), s5;
          }
          return this.Gm == null && (this.Gm = new t4.ja(0), this.fw = new t4.ja(0)), s5 = this.Gm.size, this.Gm.add(i6), this.fw.add(this.g.V(i6)), s5;
        }, i5.prototype.mz = function(t5) {
          return this.g.cd(this.dz(t5));
        }, i5;
      }();
      t4.uY = i4;
      var s4 = function() {
        function i5(i6) {
          this.Ce = i6, this.je = new t4.zb(), this.Pm = new t4.zb(), this.xH = 0, this.Co = null, this.tA = -1;
        }
        return i5.prototype.compare = function(t5, i6, s5) {
          s5 = t5.ka(s5);
          var n5 = this.Ce.hb;
          if (this.tA == i6)
            var h3 = this.xH;
          else
            this.Co = n5.cc(i6), this.Co == null ? ((t5 = n5.g).fd(n5.uz(i6), this.je), this.Co = this.je, h3 = this.je.Me(this.Ce.Ah, 0)) : h3 = this.Co.Me(this.Ce.Ah, 0), this.xH = h3, this.tA = i6;
          if ((t5 = n5.cc(s5)) == null) {
            (t5 = n5.g).fd(n5.uz(s5), this.Pm), t5 = this.Pm;
            var r3 = this.Pm.Me(this.Ce.Ah, 0);
          } else
            r3 = t5.Me(this.Ce.Ah, 0);
          return h3 == r3 && (i6 = n5.Dv(i6), s5 = n5.Dv(s5), (i6 = 0.5 * ((s5 = Math.min(i6 ? this.Co.ma : this.Co.oa, s5 ? t5.ma : t5.oa)) + this.Ce.Ah)) == this.Ce.Ah && (i6 = s5), h3 = this.Co.Me(i6, 0), r3 = t5.Me(i6, 0)), h3 < r3 ? -1 : h3 > r3 ? 1 : 0;
        }, i5.prototype.reset = function() {
          this.tA = -1;
        }, i5;
      }(), n4 = function() {
        function n5() {
          this.Ym = this.Il = null, this.fb = new t4.$j(), this.fb.MP(), this.ae = new s4(this), this.fb.Xo(this.ae);
        }
        return n5.prototype.CQ = function() {
          var i5 = false;
          if (this.hw && (i5 = this.DQ()), this.g.ea(this.Y) == 1) {
            var s5 = this.g.Ob(this.Y);
            return i5 = this.g.qz(s5), this.g.KB(s5, true), 0 > i5 && (i5 = this.g.Ya(s5), this.g.kJ(i5), this.g.Yg(s5, this.g.Na(i5)), true);
          }
          for (this.Gl = this.g.Fy(), this.yo = this.g.Fy(), s5 = this.g.Ob(this.Y); s5 != -1; s5 = this.g.Sb(s5))
            this.g.ir(s5, this.Gl, 0), this.g.ir(s5, this.yo, -1);
          s5 = new t4.ja(0), this.Ah = NaN;
          var n6 = new t4.h();
          this.ft = this.g.ea(this.Y), this.to = this.g.Hd(), this.Ts = this.g.Hd();
          for (var h3 = this.Il.sc(this.Il.ke); h3 != -1; h3 = this.Il.lb(h3)) {
            var r3 = this.Il.getData(h3);
            if (this.g.Hc(r3, n6), n6.y != this.Ah && s5.size != 0 && (i5 = this.vt(s5) || i5, this.ae.reset(), s5.clear(false)), s5.add(r3), this.Ah = n6.y, this.ft == 0)
              break;
          }
          for (0 < this.ft && (i5 = this.vt(s5) || i5, s5.clear(false)), this.g.Ud(this.to), this.g.Ud(this.Ts), s5 = this.g.Ob(this.Y); s5 != -1; )
            if (this.g.uj(s5, this.Gl) == 3) {
              for (this.g.KB(s5, true), n6 = s5, s5 = this.g.uj(s5, this.yo); s5 != -1; )
                h3 = this.g.uj(s5, this.yo), this.g.UT(this.Y, this.g.Sb(n6), s5), n6 = s5, s5 = h3;
              s5 = this.g.Sb(n6);
            } else
              this.g.KB(s5, false), s5 = this.g.Sb(s5);
          return this.g.xB(this.Gl), this.g.xB(this.yo), i5;
        }, n5.prototype.vt = function(t5) {
          return this.VV(t5);
        }, n5.prototype.VV = function(s5) {
          var n6 = false;
          this.hb == null && (this.hb = new i4(this.g)), this.Ym == null ? (this.Ym = new t4.ja(0), this.Ym.Jb(16)) : this.Ym.clear(false), this.UV(s5);
          for (var h3 = 0, r3 = s5.size; h3 < r3; h3++) {
            var e3 = s5.get(h3);
            e3 != -1 && this.jG(e3, -1);
          }
          for (h3 = 0; h3 < this.Ym.size && 0 < this.ft; h3++)
            if (s5 = this.Ym.get(h3), e3 = this.hb.mz(this.fb.ka(s5)), r3 = -1, this.g.uj(e3, this.Gl) == 0) {
              e3 = this.fb.xe(s5);
              for (var o3, a3 = s5; e3 != -1; ) {
                var u3 = this.fb.ka(e3), f3 = this.hb.mz(u3), c3 = this.g.uj(f3, this.Gl);
                if (c3 != 0) {
                  r3 = f3;
                  break;
                }
                a3 = e3, e3 = this.fb.xe(e3);
              }
              e3 == -1 ? (o3 = true, e3 = a3) : (u3 = this.fb.ka(e3), o3 = this.hb.Dv(u3), e3 = this.fb.lb(e3), o3 = !o3);
              do {
                if (u3 = this.fb.ka(e3), f3 = this.hb.mz(u3), (c3 = this.g.uj(f3, this.Gl)) == 0 && (o3 != this.hb.Dv(u3) && (n6 = this.g.Ya(f3), this.g.kJ(n6), this.g.Yg(f3, this.g.Na(n6)), n6 = true), this.g.ir(f3, this.Gl, o3 ? 3 : 2), o3 || (a3 = this.g.uj(r3, this.yo), this.g.ir(r3, this.yo, f3), this.g.ir(f3, this.yo, a3)), this.ft--, this.ft == 0))
                  return n6;
                r3 = f3, a3 = e3, e3 = this.fb.lb(e3), o3 = !o3;
              } while (a3 != s5);
            }
          return n6;
        }, n5.prototype.UV = function(t5) {
          for (var i5 = 0, s5 = t5.size; i5 < s5; i5++) {
            var n6 = t5.get(i5), h3 = this.g.Qa(n6, this.to), r3 = this.g.Qa(n6, this.Ts);
            if (h3 != -1) {
              var e3 = this.fb.ka(h3);
              this.hb.mF(e3), this.g.Sa(n6, this.to, -1);
            }
            r3 != -1 && (e3 = this.fb.ka(r3), this.hb.mF(e3), this.g.Sa(n6, this.Ts, -1)), e3 = -1, h3 != -1 && r3 != -1 ? (this.fb.wd(h3, -1), this.fb.wd(r3, -1), t5.set(i5, -1)) : e3 = h3 != -1 ? h3 : r3, e3 != -1 && (this.jG(n6, e3) || this.fb.wd(e3, -1), t5.set(i5, -1));
          }
        }, n5.prototype.jG = function(i5, s5) {
          var n6 = new t4.h(), h3 = new t4.h();
          this.g.Hc(i5, n6);
          var r3 = this.g.V(i5);
          this.g.Hc(r3, h3);
          var e3 = false;
          if (n6.y < h3.y) {
            e3 = true;
            var o3 = this.hb.iI(i5);
            if (s5 == -1)
              var a3 = this.fb.addElement(o3, -1);
            else
              a3 = s5, this.fb.Uj(a3, o3);
            (o3 = this.g.Qa(r3, this.to)) == -1 ? this.g.Sa(r3, this.to, a3) : this.g.Sa(r3, this.Ts, a3), r3 = this.g.cd(i5), this.g.uj(r3, this.Gl) == 0 && this.Ym.add(a3);
          }
          return r3 = this.g.Na(i5), this.g.Hc(r3, h3), n6.y < h3.y && (e3 = true, o3 = this.hb.iI(r3), s5 == -1 ? a3 = this.fb.addElement(o3, -1) : (a3 = s5, this.fb.Uj(a3, o3)), (o3 = this.g.Qa(r3, this.to)) == -1 ? this.g.Sa(r3, this.to, a3) : this.g.Sa(r3, this.Ts, a3), r3 = this.g.cd(i5), this.g.uj(r3, this.Gl) == 0 && this.Ym.add(a3)), e3;
        }, n5.W = function(t5, i5, s5, h3) {
          var r3 = new n5();
          return r3.g = t5, r3.Y = i5, r3.Il = s5, r3.hw = h3, r3.CQ();
        }, n5.prototype.DQ = function() {
          var i5 = new t4.ja(0), s5 = new t4.ja(0), n6 = -1, h3 = -1, r3 = new t4.h();
          r3.Sc();
          for (var e3 = -1, o3 = -1, a3 = -1, u3 = new t4.h(), f3 = this.Il.sc(this.Il.ke); f3 != -1; f3 = this.Il.lb(f3)) {
            var c3 = this.Il.getData(f3);
            this.g.Hc(c3, u3);
            var l3 = this.g.cd(c3);
            r3.rb(u3) && o3 == l3 ? (h3 == -1 && (n6 = this.g.Fy(), h3 = this.g.Hd()), a3 == -1 && (a3 = s5.size, this.g.Sa(e3, h3, a3), s5.add(1), this.g.uj(l3, n6) == -1 && (this.g.ir(l3, n6, e3), i5.add(l3))), this.g.Sa(c3, h3, a3), s5.XW(s5.Gc() + 1)) : (a3 = -1, r3.N(u3)), e3 = c3, o3 = l3;
          }
          if (i5.size == 0)
            return false;
          for (r3 = new t4.ja(0), e3 = new t4.ja(0), o3 = 0, a3 = i5.size; o3 < a3; o3++) {
            l3 = i5.get(o3);
            var p3 = this.g.uj(l3, n6);
            for (c3 = this.g.Qa(p3, h3), r3.clear(false), e3.clear(false), r3.add(p3), e3.add(c3), c3 = this.g.V(p3); c3 != p3; c3 = this.g.V(c3)) {
              var v3 = c3;
              if ((u3 = this.g.Qa(v3, h3)) != -1)
                if (e3.size == 0)
                  e3.add(u3), r3.add(v3);
                else if (e3.Gc() == u3) {
                  f3 = r3.Gc();
                  var y3 = this.g.V(f3);
                  p3 = this.g.V(v3), this.g.Cc(f3, p3), this.g.Dc(p3, f3), this.g.Cc(v3, y3), this.g.Dc(y3, v3), v3 = [false], y3 = this.g.iG(this.Y, y3, this.g.Ya(l3), v3), this.g.Sa(c3, h3, -1), v3[0] && this.g.Kf(l3, p3), c3 = this.g.Ka(l3), c3 -= p3 = this.g.Ka(y3), this.g.Xj(l3, c3), s5.set(u3, s5.get(u3) - 1), s5.get(u3) == 1 && (s5.set(u3, 0), e3.Jf(), r3.Jf()), c3 = p3 = f3;
                } else
                  r3.add(c3), e3.add(u3);
            }
          }
          return this.g.xB(n6), this.g.Ud(h3), true;
        }, n5;
      }();
      t4.RL = n4;
    }(Q2 || (Q2 = {})), function(t4) {
      var i4 = function() {
        function i5() {
        }
        return i5.prototype.jg = function() {
          this.KA = this.tb = null;
        }, i5.prototype.get = function() {
          return this.KA;
        }, i5.prototype.set = function(i6) {
          if (this.KA = i6, i6 != null)
            throw i6.K() == 322 && (this.tb = i6), t4.i.Ra();
        }, i5.prototype.create = function(i6) {
          if (i6 != 322)
            throw t4.i.ga("Not Implemented");
          this.Qr();
        }, i5.prototype.Qr = function() {
          this.tb == null && (this.tb = new t4.zb()), this.KA = this.tb;
        }, i5;
      }();
      t4.jg = i4;
    }(Q2 || (Q2 = {})), function(t4) {
      (t4 = t4.SL || (t4.SL = {}))[t4.enumLineSeg = 1] = "enumLineSeg", t4[t4.enumBezierSeg = 2] = "enumBezierSeg", t4[t4.enumArcSeg = 4] = "enumArcSeg", t4[t4.enumNonlinearSegmentMask = 6] = "enumNonlinearSegmentMask", t4[t4.enumSegmentMask = 7] = "enumSegmentMask", t4[t4.enumDensified = 8] = "enumDensified";
    }(Q2 || (Q2 = {})), function(t4) {
      var i4 = function(t5) {
        this.bj = t5, this.lC = this.mC = 1, this.nB = this.mB = this.oB = 0;
      }, s4 = function() {
        function s5() {
          this.Hq = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], this.Dk = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], this.Cf = new t4.Ta(), this.ra = this.Ew = 0, this.oo = [], this.bt = [], this.Aw = [], this.Kq = [], this.HA = [];
        }
        return s5.prototype.rB = function(t5) {
          if (t5 != null) {
            for (var i5 = 0, s6 = t5.length; i5 < s6; i5++)
              this.mW(t5[i5]);
            t5.length = 0;
          }
        }, s5.prototype.mW = function(t5) {
          t5.bj = null, this.Kq.push(t5);
        }, s5.prototype.Qw = function(t5) {
          if (this.Kq.length === 0)
            var s6 = new i4(t5);
          else
            (s6 = this.Kq[this.Kq.length - 1]).bj = t5, --this.Kq.length;
          return s6;
        }, s5.prototype.NR = function(t5, i5) {
          return t5 == 0 ? this.bt[i5] : this.Aw[i5];
        }, s5.prototype.WA = function() {
          this.Ew >= this.HA.length && this.HA.push(new t4.jg());
          var i5 = this.HA[this.Ew];
          return this.Ew++, i5;
        }, s5.prototype.clear = function() {
          this.rB(this.oo), this.rB(this.bt), this.rB(this.Aw), this.Ew = 0;
        }, s5.prototype.Qo = function(t5) {
          this.oo.push(this.Qw(t5));
        }, s5.prototype.ql = function(t5) {
          return t5 == 0 ? this.bt.length : this.Aw.length;
        }, s5.prototype.Xp = function(t5, i5) {
          return this.NR(t5, i5).bj;
        }, s5.prototype.Fa = function(i5, s6) {
          if (this.oo.length != 2)
            throw t4.i.Ra();
          this.ra = i5;
          var n4 = t4.mc.ox(0.01 * i5), h3 = false, r3 = this.oo[0], e3 = this.oo[1];
          if (s6 || (5 & r3.bj.Br(e3.bj, i5, true)) != 0) {
            if (r3.bj.K() == 322) {
              var o3 = r3.bj;
              if (e3.bj.K() == 322) {
                s6 = e3.bj;
                var a3 = t4.zb.Yx(o3, s6, null, this.Hq, this.Dk, i5);
                if (a3 == 0)
                  throw t4.zb.Yx(o3, s6, null, this.Hq, this.Dk, i5), t4.i.Ra();
                i5 = Array(9), t4.P.bv(i5, null);
                for (var u3 = 0; u3 < a3; u3++) {
                  var f3 = this.Hq[u3], c3 = this.Dk[u3], l3 = r3.nB, p3 = 1;
                  f3 == 0 ? (l3 = r3.oB, p3 = r3.mC) : f3 == 1 && (l3 = r3.mB, p3 = r3.lC);
                  var v3 = e3.nB, y3 = 1;
                  c3 == 0 ? (v3 = e3.oB, y3 = e3.mC) : c3 == 1 && (v3 = e3.mB, y3 = e3.lC);
                  var b3 = new t4.h();
                  l3 == v3 ? (l3 = new t4.h(), o3.ic(f3, l3), f3 = new t4.h(), s6.ic(c3, f3), y3 /= c3 = p3 + y3, t4.mc.JG(l3, f3, y3, b3), t4.h.zc(b3, l3) + t4.h.zc(b3, f3) > n4 && (h3 = true)) : l3 > v3 ? (o3.ic(f3, b3), f3 = new t4.h(), s6.ic(c3, f3), t4.h.zc(b3, f3) > n4 && (h3 = true)) : (s6.ic(c3, b3), l3 = new t4.h(), o3.ic(f3, l3), t4.h.zc(b3, l3) > n4 && (h3 = true)), i5[u3] = b3;
                }
                for (r3 = 0, e3 = -1, u3 = 0; u3 <= a3; u3++)
                  (y3 = u3 < a3 ? this.Hq[u3] : 1) != r3 && (n4 = this.WA(), o3.dh(r3, y3, n4), e3 != -1 && n4.get().Ec(i5[e3]), u3 != a3 && n4.get().Rc(i5[u3]), r3 = y3, this.bt.push(this.Qw(n4.get()))), e3 = u3;
                for (o3 = [0, 0, 0, 0, 0, 0, 0, 0, 0], u3 = 0; u3 < a3; u3++)
                  o3[u3] = u3;
                for (1 < a3 && this.Dk[0] > this.Dk[1] && (y3 = this.Dk[0], this.Dk[0] = this.Dk[1], this.Dk[1] = y3, u3 = o3[0], o3[0] = o3[1], o3[1] = u3), r3 = 0, e3 = -1, u3 = 0; u3 <= a3; u3++)
                  (y3 = u3 < a3 ? this.Dk[u3] : 1) != r3 && (n4 = this.WA(), s6.dh(r3, y3, n4), e3 != -1 && (r3 = o3[e3], n4.get().Ec(i5[r3])), u3 != a3 && (r3 = o3[u3], n4.get().Rc(i5[r3])), r3 = y3, this.Aw.push(this.Qw(n4.get()))), e3 = u3;
                return h3;
              }
            }
            throw t4.i.Ra();
          }
          return false;
        }, s5.prototype.Fz = function(i5, s6, n4) {
          if (s6.copyTo(this.Cf), this.oo.length != 1)
            throw t4.i.Ra();
          this.ra = i5;
          var h3 = this.oo[0];
          if (n4 || h3.bj.tu(s6.D(), i5, true)) {
            if (h3.bj.K() != 322)
              throw t4.i.Ra();
            var r3 = (i5 = h3.bj).ge(s6.D(), false);
            this.Hq[0] = r3;
            var e3 = h3.nB;
            for (n4 = 1, r3 == 0 ? (e3 = h3.oB, n4 = h3.mC) : r3 == 1 && (e3 = h3.mB, n4 = h3.lC), h3 = new t4.h(), e3 == 0 ? (e3 = new t4.h(), i5.ic(r3, e3), s6 = s6.D(), t4.mc.JG(e3, s6, 1 / (n4 + 1), h3)) : 0 < e3 ? (h3 = new t4.h(), i5.ic(r3, h3)) : h3 = s6.D(), n4 = 0, r3 = -1, e3 = 0; 1 >= e3; e3++) {
              if ((s6 = 1 > e3 ? this.Hq[e3] : 1) != n4) {
                var o3 = this.WA();
                i5.dh(n4, s6, o3), r3 != -1 && o3.get().Ec(h3), e3 != 1 && o3.get().Rc(h3), n4 = s6, this.bt.push(this.Qw(o3.get()));
              }
              r3 = e3;
            }
            this.Cf.Db(h3);
          }
        }, s5;
      }();
      t4.OC = s4;
    }(Q2 || (Q2 = {})), function(t4) {
      var i4 = function() {
        function i5(i6) {
          this.Fs = this.tk = this.tb = null, this.cg = 0, this.Bm = false, this.Af = -1, this.El = this.Kd = 0, this.gb = -1, this.ib = i6, this.cg = this.Vx(this.El), this.Bm = false, this.tk = null, this.Fs = new t4.h();
        }
        return i5.prototype.wW = function(i6) {
          if (this.ib != i6.ib)
            throw t4.i.Hb();
          this.Af = i6.Af, this.Kd = i6.Kd, this.gb = i6.gb, this.El = i6.El, this.cg = i6.cg, this.Bm = i6.Bm, this.tk = null;
        }, i5.prototype.ia = function() {
          if (this.Af != this.Kd && this.wD(), this.Bm)
            this.Kd = (this.Kd + 1) % this.cg;
          else {
            if (this.Kd == this.cg)
              throw t4.i.de();
            this.Kd++;
          }
          return this.tk;
        }, i5.prototype.ni = function() {
          if (this.Bm)
            this.Kd = (this.cg + this.Kd - 1) % this.cg;
          else {
            if (this.Kd == 0)
              throw t4.i.de();
            this.Kd--;
          }
          return this.Kd != this.Af && this.wD(), this.tk;
        }, i5.prototype.xW = function() {
          this.Af = -1, this.Kd = 0;
        }, i5.prototype.yW = function() {
          this.Kd = this.cg, this.Af = -1;
        }, i5.prototype.Wb = function(t5, i6) {
          if (i6 === void 0 && (i6 = -1), 0 <= this.gb && this.gb < this.ib.ea()) {
            var s4 = this.DM();
            if (t5 >= s4 && t5 < this.ib.Wc(this.gb))
              return this.Af = -1, void (this.Kd = t5 - s4);
          }
          i6 = 0 <= i6 && i6 < this.ib.ea() && t5 >= this.ib.Ca(i6) && t5 < this.ib.Wc(i6) ? i6 : this.ib.nz(t5), this.El = i6 + 1, this.gb = i6, this.Af = -1, this.Kd = t5 - this.ib.Ca(i6), this.cg = this.Vx(i6), this.ib.Ca(this.gb), this.ib.ec(this.gb);
        }, i5.prototype.ab = function() {
          return this.gb = this.El, !(this.gb >= this.ib.ea()) && (this.Af = -1, this.Kd = 0, this.cg = this.Vx(this.gb), this.ib.Ca(this.gb), this.ib.ec(this.gb), this.El++, true);
        }, i5.prototype.aj = function() {
          this.cg = this.Kd = this.Af = -1, this.El = 0, this.gb = -1;
        }, i5.prototype.Vx = function(t5) {
          if (this.ib.Bc())
            return 0;
          var i6 = 1;
          return this.ib.ec(t5) && (i6 = 0), this.ib.Ka(t5) - i6;
        }, i5.prototype.Qn = function() {
          return this.Af == this.cg - 1 && this.ib.ec(this.gb);
        }, i5.prototype.EB = function() {
          this.Bm = true;
        }, i5.prototype.xb = function() {
          return this.ib.nb.o[this.gb] + this.Af;
        }, i5.prototype.DM = function() {
          return this.ib.Ca(this.gb);
        }, i5.prototype.kk = function() {
          return this.Qn() ? this.ib.Ca(this.gb) : this.xb() + 1;
        }, i5.prototype.xm = function() {
          return this.Af == 0;
        }, i5.prototype.Sn = function() {
          return this.Af == this.cg - 1;
        }, i5.prototype.Ia = function() {
          return this.Kd < this.cg;
        }, i5.prototype.zz = function() {
          return 0 < this.Kd;
        }, i5.prototype.Qf = function() {
          var t5 = new i5(this.ib);
          return t5.Af = this.Af, t5.Kd = this.Kd, t5.cg = this.cg, t5.gb = this.gb, t5.El = this.El, t5.ib = this.ib, t5.Bm = this.Bm, t5;
        }, i5.prototype.wD = function() {
          if (0 > this.Kd || this.Kd >= this.cg)
            throw t4.i.de();
          this.Af = this.Kd;
          var i6 = this.xb();
          this.ib.oc();
          var s4 = this.ib.Se, n4 = 1;
          switch (s4 != null && (n4 = 7 & s4.read(i6)), s4 = this.ib.description, n4) {
            case 1:
              this.tb == null && (this.tb = new t4.zb()), this.tk = this.tb;
              break;
            case 2:
              throw t4.i.ga("internal error");
            default:
              throw t4.i.Ra();
          }
          this.tk.Pf(s4), n4 = this.kk(), this.ib.Hc(i6, this.Fs), this.tk.Ec(this.Fs), this.ib.Hc(n4, this.Fs), this.tk.Rc(this.Fs);
          for (var h3 = 1, r3 = s4.Ba; h3 < r3; h3++)
            for (var e3 = s4.ld(h3), o3 = t4.sa.Wa(e3), a3 = 0; a3 < o3; a3++) {
              var u3 = this.ib.Vc(e3, i6, a3);
              this.tk.TB(e3, a3, u3), u3 = this.ib.Vc(e3, n4, a3), this.tk.JB(e3, a3, u3);
            }
        }, i5.prototype.VS = function() {
          return this.gb == this.ib.ea() - 1;
        }, i5.prototype.Rn = function() {
          var t5 = this.ib.QR();
          return t5 != null && (7 & t5.read(this.Af)) != 1;
        }, i5;
      }();
      t4.TL = i4;
    }(Q2 || (Q2 = {})), function(t4) {
      var i4 = function() {
        function i5(i6) {
          i6 instanceof t4.ba ? (this.sH = i6, this.za = -1, this.Gi = 1) : (this.qT = i6.slice(0), this.za = -1, this.Gi = i6.length);
        }
        return i5.prototype.Ma = function() {
          return this.za;
        }, i5.prototype.next = function() {
          return this.za < this.Gi - 1 ? (this.za++, this.sH != null ? this.sH : this.qT[this.za]) : null;
        }, i5.prototype.re = function() {
        }, i5;
      }();
      t4.$c = i4;
    }(Q2 || (Q2 = {})), function(t4) {
      var i4 = function() {
        this.next = null;
      }, s4 = function() {
        function s5() {
          this.Vq = this.Mw = this.Nw = 0, this.fF = false, this.bK = 0, this.jn = this.Lf = this.Yl = this.Lh = null, this.Ql = 0, this.qy = null, this.rl = this.ri = -1;
        }
        return s5.prototype.wX = function(i5, s6, n4) {
          this.ri = i5, this.rl = s6, this.Lh = this.Yl = null, this.Vq = 0, this.qy = n4, this.jn == null && (this.jn = t4.P.mg(384, 0)), this.iK();
        }, s5.prototype.S = function() {
          return this.ri;
        }, s5.prototype.da = function() {
          return this.rl;
        }, s5.prototype.flush = function() {
          0 < this.Ql && (this.qy.bF(this.jn, this.Ql), this.Ql = 0);
        }, s5.prototype.iK = function() {
          if (0 < this.Vq) {
            for (var t5 = 0; t5 < this.rl; t5++) {
              for (var i5 = this.Yl[t5]; i5 != null; ) {
                var s6 = i5;
                i5 = i5.next, s6.next = null;
              }
              this.Yl[t5] = null;
            }
            this.Lh = null;
          }
          this.Nw = this.rl, this.Mw = -1, this.Vq = 0;
        }, s5.prototype.dJ = function(t5) {
          for (this.fF = t5 == s5.Bx, t5 = this.Nw; t5 <= this.Mw; t5++)
            this.nN(), this.gN(t5), this.UP();
          this.iK();
        }, s5.prototype.fy = function(s6, n4, h3, r3) {
          if (n4 != r3) {
            var e3 = 1;
            if (n4 > r3 && (e3 = s6, s6 = h3, h3 = e3, e3 = n4, n4 = r3, r3 = e3, e3 = -1), !(0 > r3 || n4 >= this.rl)) {
              0 > s6 && 0 > h3 ? h3 = s6 = -1 : s6 >= this.ri && h3 >= this.ri && (h3 = s6 = this.ri);
              var o3 = (h3 - s6) / (r3 - n4);
              r3 > this.rl && (h3 = o3 * ((r3 = this.rl) - n4) + s6), 0 > n4 && (s6 = o3 * (0 - n4) + s6, n4 = 0);
              var a3 = Math.max(this.ri + 1, 8388607);
              -8388607 > s6 ? (n4 = (0 - s6) / o3 + n4, s6 = 0) : s6 > a3 && (n4 = (this.ri - s6) / o3 + n4, s6 = this.ri), -8388607 > h3 ? r3 = (0 - s6) / o3 + n4 : h3 > a3 && (r3 = (this.ri - s6) / o3 + n4), (n4 = t4.P.truncate(n4)) != (r3 = t4.P.truncate(r3)) && ((h3 = new i4()).x = t4.P.truncate(4294967296 * s6), h3.y = n4, h3.H = r3, h3.RP = t4.P.truncate(4294967296 * o3), h3.dir = e3, this.Yl == null && (this.Yl = t4.P.mg(this.rl, null)), h3.next = this.Yl[h3.y], this.Yl[h3.y] = h3, h3.y < this.Nw && (this.Nw = h3.y), h3.H > this.Mw && (this.Mw = h3.H), this.Vq++);
            }
          }
        }, s5.prototype.nN = function() {
          if (this.Lh != null) {
            for (var t5 = false, i5 = null, s6 = this.Lh; s6 != null; )
              if (s6.y++, s6.y == s6.H) {
                var n4 = s6;
                s6 = s6.next, i5 != null ? i5.next = s6 : this.Lh = s6, n4.next = null;
              } else
                s6.x += s6.RP, i5 != null && i5.x > s6.x && (t5 = true), i5 = s6, s6 = s6.next;
            t5 && (this.Lh = this.aK(this.Lh));
          }
        }, s5.prototype.gN = function(t5) {
          if (!(t5 >= this.rl)) {
            var i5 = this.Yl[t5];
            if (i5 != null) {
              this.Yl[t5] = null, i5 = this.aK(i5), this.Vq -= this.bK, t5 = this.Lh;
              for (var s6 = true, n4 = i5, h3 = null; t5 != null && n4 != null; )
                t5.x > n4.x ? (s6 && (this.Lh = n4), s6 = n4.next, n4.next = t5, h3 != null && (h3.next = n4), h3 = n4, n4 = s6) : (s6 = t5.next, t5.next = n4, h3 != null && (h3.next = t5), h3 = t5, t5 = s6), s6 = false;
              this.Lh == null && (this.Lh = i5);
            }
          }
        }, s5.$J = function(t5, i5) {
          return 0 > t5 ? 0 : t5 > i5 ? i5 : t5;
        }, s5.prototype.UP = function() {
          if (this.Lh != null) {
            for (var i5 = 0, n4 = this.Lh, h3 = t4.P.truncate(t4.P.SG(n4.x)), r3 = n4.next; r3 != null; r3 = r3.next)
              if (i5 = this.fF ? 1 ^ i5 : i5 + r3.dir, r3.x > n4.x) {
                var e3 = t4.P.truncate(t4.P.SG(r3.x));
                i5 != 0 && (n4 = s5.$J(h3, this.ri), (h3 = s5.$J(e3, this.ri)) > n4 && n4 < this.ri && (this.jn[this.Ql++] = n4, this.jn[this.Ql++] = h3, this.jn[this.Ql++] = r3.y, this.Ql == this.jn.length && (this.qy.bF(this.jn, this.Ql), this.Ql = 0))), n4 = r3, h3 = e3;
              }
          }
        }, s5.prototype.aK = function(i5) {
          for (var n4 = 0, h3 = i5; h3 != null; h3 = h3.next)
            n4++;
          if (this.bK = n4, n4 == 1)
            return i5;
          this.Lf == null ? this.Lf = t4.P.mg(Math.max(n4, 16), null) : this.Lf.length < n4 && (this.Lf = t4.P.mg(Math.max(n4, 2 * this.Lf.length), null));
          var r3 = 0;
          for (h3 = i5; h3 != null; h3 = h3.next)
            this.Lf[r3++] = h3;
          for (n4 == 2 ? this.Lf[0].x > this.Lf[1].x && (i5 = this.Lf[0], this.Lf[0] = this.Lf[1], this.Lf[1] = i5) : s5.vN(this.Lf, n4, function(t5, i6) {
            return t5 == i6 ? 0 : t5.x < i6.x ? -1 : t5.x > i6.x ? 1 : 0;
          }), i5 = this.Lf[0], this.Lf[0] = null, h3 = i5, r3 = 1; r3 < n4; r3++)
            h3.next = this.Lf[r3], h3 = this.Lf[r3], this.Lf[r3] = null;
          return h3.next = null, i5;
        }, s5.vN = function(t5, i5, s6) {
          if (i5 == t5.length)
            t5.sort(s6);
          else {
            var n4 = t5.slice(0, 0), h3 = t5.slice(i5);
            i5 = t5.slice(0, i5).sort(s6), t5.length = 0, t5.push.apply(t5, n4.concat(i5).concat(h3));
          }
        }, s5.Bx = 0, s5;
      }();
      t4.Ox = s4;
    }(Q2 || (Q2 = {})), function(t4) {
      var i4 = function() {
        function i5() {
        }
        return i5.prototype.wi = function(t5, i6) {
          var s4 = this.g.Qa(t5, this.Rq);
          if (this.Fl == s4 && (this.Fl = this.pe.lb(this.Fl)), this.jo == s4 && (this.jo = this.pe.lb(this.jo)), this.pe.kd(this.MA, s4), this.dk(t5), i6 && ((i6 = this.g.cd(t5)) != -1 && this.g.Ya(i6) == t5)) {
            var n4 = this.g.V(t5);
            if (n4 != t5) {
              if ((s4 = this.g.cd(n4)) == i6)
                return void this.g.Kf(i6, n4);
              if ((n4 = this.g.Na(t5)) != t5 && (s4 = this.g.cd(n4)) == i6)
                return void this.g.Kf(i6, n4);
            }
            this.g.Kf(i6, -1), this.g.Yg(i6, -1);
          }
        }, i5.prototype.kD = function() {
          for (var i6 = false, s4 = new t4.h(); ; ) {
            this.Yh == null ? (this.Yh = new t4.ja(0), this.Bs = new t4.ja(0), this.ye = new t4.ja(0)) : (this.Yh.clear(false), this.Bs.clear(false), this.ye.clear(false));
            for (var n4 = this.jo, h3 = 0, r3 = true; n4 != this.Fl; ) {
              var e3 = this.pe.getData(n4), o3 = new t4.h();
              this.g.Hc(e3, o3), r3 && (this.g.Hc(e3, s4), r3 = false), o3 = this.g.Na(e3);
              var a3 = this.g.V(e3);
              this.g.Qa(o3, this.Ag) != -559038737 && (this.Yh.add(o3), this.g.Sa(o3, this.Ag, -559038737), this.Bs.add(e3), this.ye.add(h3++)), this.g.Qa(a3, this.Ag) != -559038737 && (this.Yh.add(a3), this.g.Sa(a3, this.Ag, -559038737), this.Bs.add(e3), this.ye.add(h3++)), n4 = this.pe.lb(n4);
            }
            if (2 > this.Yh.size)
              break;
            var u3 = this;
            for (this.ye.Wd(0, this.ye.size, function(t5, i7) {
              return u3.kM(t5, i7);
            }), n4 = 0, h3 = this.ye.size; n4 < h3; n4++)
              r3 = this.ye.get(n4), r3 = this.Yh.get(r3), this.g.Sa(r3, this.Ag, n4), o3 = new t4.h(), this.g.Hc(r3, o3);
            for (o3 = this.OM(s4), n4 = 0, h3 = this.ye.size; n4 < h3; n4++)
              (r3 = this.ye.get(n4)) != -1 && (r3 = this.Yh.get(r3), this.g.Sa(r3, this.Ag, -1));
            if (!o3)
              break;
            i6 = true;
          }
          return i6;
        }, i5.prototype.OM = function(t5) {
          for (var i6 = false, s4 = true; s4; ) {
            s4 = false;
            var n4 = 0;
            this.ye.get(n4) == -1 && (n4 = this.em(n4));
            for (var h3 = this.em(n4), r3 = 0, e3 = this.ye.size; r3 < e3 && n4 != -1 && h3 != -1 && n4 != h3; r3++) {
              var o3 = this.ye.get(n4);
              h3 = this.ye.get(h3), o3 = this.Yh.get(o3), h3 = this.Yh.get(h3);
              var a3 = this.g.V(o3);
              this.g.Fv(a3, t5) || (a3 = this.g.Na(o3));
              var u3 = this.g.V(h3);
              this.g.Fv(u3, t5) || (u3 = this.g.Na(h3));
              var f3 = this.ru(a3, o3), c3 = this.ru(u3, h3), l3 = f3 ? this.g.Na(a3) : this.g.V(a3), p3 = c3 ? this.g.Na(u3) : this.g.V(u3), v3 = false;
              (this.up(a3) || this.up(u3) || this.up(o3) || this.up(h3) || this.up(l3) || this.up(p3)) && (v3 = true), !v3 && this.g.hq(o3, h3) && (v3 = true, this.oD(f3, c3, a3, o3, u3, h3)), !v3 && this.g.hq(l3, p3) && (v3 = true, this.oD(!f3, !c3, a3, l3, u3, p3)), v3 && (i6 = true), s4 = s4 || v3, n4 = this.em(n4), h3 = this.em(n4);
            }
          }
          if (!i6)
            for (n4 = 0, this.ye.get(n4) == -1 && (n4 = this.em(n4)), h3 = this.em(n4), r3 = 0, e3 = this.ye.size; r3 < e3 && n4 != -1 && h3 != -1 && n4 != h3; r3++)
              o3 = this.ye.get(n4), h3 = this.ye.get(h3), o3 = this.Yh.get(o3), h3 = this.Yh.get(h3), a3 = this.g.V(o3), this.g.Fv(a3, t5) || (a3 = this.g.Na(o3)), u3 = this.g.V(h3), this.g.Fv(u3, t5) || (u3 = this.g.Na(h3)), f3 = this.ru(a3, o3), c3 = this.ru(u3, h3), l3 = f3 ? this.g.Na(a3) : this.g.V(a3), p3 = c3 ? this.g.Na(u3) : this.g.V(u3), this.yM(f3, c3, o3, a3, l3, h3, u3, p3) && (i6 = true), n4 = this.em(n4), h3 = this.em(n4);
          return i6;
        }, i5.prototype.SM = function() {
          this.g.jc(this.Y) == 1736 && this.g.Kn(this.Y) == 1 && new t4.Hg().HU(this.hw, this.g, this.Y, this.od);
          var i6 = false, s4 = true;
          this.Ag = this.Rq = -1;
          var n4 = this.g.I(this.Y), h3 = new t4.ja(0);
          h3.Jb(n4);
          for (var r3 = this.g.Ob(this.Y); r3 != -1; r3 = this.g.Sb(r3))
            for (var e3 = this.g.Ya(r3), o3 = 0, a3 = this.g.Ka(r3); o3 < a3; o3++)
              h3.add(e3), e3 = this.g.V(e3);
          var u3 = this.g.ud.o, f3 = this.g.ud.Mf;
          this.g.wb.oc();
          var c3 = this.g.wb.Aa[0].o;
          for (h3.Wd(0, n4, function(t5, i7) {
            var s5 = u3[f3 * t5], n5 = u3[f3 * i7], h4 = c3[2 * s5];
            s5 = c3[2 * s5 + 1];
            var r4 = c3[2 * n5];
            return (h4 = s5 < (n5 = c3[2 * n5 + 1]) ? -1 : s5 > n5 ? 1 : h4 < r4 ? -1 : h4 > r4 ? 1 : 0) == 0 && (h4 = (t5 = u3[f3 * t5 + 3]) < (i7 = u3[f3 * i7 + 3]) ? -1 : t5 == i7 ? 0 : 1), h4;
          }), this.Rq = this.g.Hd(), this.pe = new t4.lp(), this.MA = this.pe.Rh(0), this.pe.hn(n4), r3 = 0; r3 < n4; r3++)
            e3 = h3.get(r3), o3 = this.pe.addElement(this.MA, e3), this.g.Sa(e3, this.Rq, o3);
          for (this.Ag = this.g.Hd(), this.Fl = -1, this.YC() && (i6 = true); s4; ) {
            s4 = false, n4 = 0, h3 = false;
            do {
              h3 = false, this.jo = -1, a3 = 0, r3 = new t4.h(), o3 = new t4.h();
              for (var l3 = this.pe.sc(this.MA); l3 != -1; )
                e3 = this.pe.getData(l3), this.jo != -1 ? (this.g.Hc(e3, o3), r3.rb(o3) ? a3++ : (r3.N(o3), this.Fl = l3, 0 < a3 && (e3 = this.kD()) && (h3 = true, this.Fl != -1 && (e3 = this.pe.getData(this.Fl), this.g.Hc(e3, r3))), this.jo = l3 = this.Fl, a3 = 0)) : (this.jo = l3, this.g.Hc(this.pe.getData(l3), r3), a3 = 0), l3 != -1 && (l3 = this.pe.lb(l3));
              if (this.Fl = -1, 0 < a3 && (e3 = this.kD()) && (h3 = true), 10 < n4++)
                throw t4.i.Ra();
              h3 && this.BM(), this.YC() && (h3 = true), s4 = s4 || h3 && false, i6 = i6 || h3;
            } while (h3);
          }
          return this.g.Ud(this.Rq), this.g.Ud(this.Ag), t4.RL.W(this.g, this.Y, this.pe, this.hw) || i6;
        }, i5.prototype.ru = function(t5, i6) {
          return this.g.V(i6) != t5;
        }, i5.prototype.yM = function(t5, i6, s4, n4, h3, r3, e3, o3) {
          if (n4 == e3)
            return this.dk(s4), this.dk(r3), false;
          var a3 = this.g.Qa(s4, this.Ag), u3 = this.g.Qa(h3, this.Ag), f3 = this.g.Qa(r3, this.Ag), c3 = this.g.Qa(o3, this.Ag), l3 = [0, 0, 0, 0];
          for ((s4 = [0, 0, 0, 0, 0, 0, 0, 0])[0] = 0, l3[0] = a3, s4[1] = 0, l3[1] = u3, s4[2] = 1, l3[2] = f3, s4[3] = 1, l3[3] = c3, a3 = 1; 4 > a3; a3++) {
            for (u3 = l3[a3], f3 = s4[a3], c3 = a3 - 1; 0 <= c3 && l3[c3] > u3; )
              l3[c3 + 1] = l3[c3], s4[c3 + 1] = s4[c3], c3--;
            l3[c3 + 1] = u3, s4[c3 + 1] = f3;
          }
          return l3 = 0, s4[0] != 0 && (l3 |= 1), s4[1] != 0 && (l3 |= 2), s4[2] != 0 && (l3 |= 4), s4[3] != 0 && (l3 |= 8), (l3 == 5 || l3 == 10) && (t5 == i6 ? t5 ? (this.g.Cc(o3, n4), this.g.Dc(n4, o3), this.g.Cc(h3, e3), this.g.Dc(e3, h3)) : (this.g.Dc(o3, n4), this.g.Cc(n4, o3), this.g.Dc(h3, e3), this.g.Cc(e3, h3)) : t5 ? (this.g.Dc(n4, r3), this.g.Cc(r3, n4), this.g.Dc(e3, h3), this.g.Cc(h3, e3)) : (this.g.Cc(n4, r3), this.g.Dc(r3, n4), this.g.Cc(e3, h3), this.g.Dc(h3, e3)), true);
        }, i5.prototype.oD = function(t5, i6, s4, n4, h3, r3) {
          this.IY ? this.QM() : this.PM(t5, i6, s4, n4, h3, r3);
        }, i5.prototype.QM = function() {
          throw t4.i.ga("not implemented.");
        }, i5.prototype.PM = function(t5, i6, s4, n4, h3, r3) {
          if (t5 != i6)
            t5 ? (this.g.Cc(s4, h3), this.g.Dc(h3, s4), this.g.Cc(r3, n4), this.g.Dc(n4, r3), this.xn(h3, s4), this.wi(h3, true), this.g.oi(h3, true), this.dk(s4), this.xn(r3, n4), this.wi(r3, true), this.g.oi(r3, false)) : (this.g.Cc(h3, s4), this.g.Dc(s4, h3), this.g.Cc(n4, r3), this.g.Dc(r3, n4), this.xn(h3, s4), this.wi(h3, true), this.g.oi(h3, false), this.dk(s4), this.xn(r3, n4), this.wi(r3, true), this.g.oi(r3, true)), this.dk(n4);
          else {
            var e3 = t5 ? s4 : n4, o3 = i6 ? h3 : r3;
            for (t5 = t5 ? n4 : s4, i6 = i6 ? r3 : h3, h3 = false, this.g.Cc(e3, o3), this.g.Cc(o3, e3), this.g.Dc(t5, i6), this.g.Dc(i6, t5), r3 = i6; r3 != o3; )
              s4 = this.g.Na(r3), n4 = this.g.V(r3), this.g.Dc(r3, n4), this.g.Cc(r3, s4), h3 = h3 || r3 == e3, r3 = n4;
            h3 || (s4 = this.g.Na(o3), n4 = this.g.V(o3), this.g.Dc(o3, n4), this.g.Cc(o3, s4)), this.xn(o3, e3), this.wi(o3, true), this.g.oi(o3, false), this.dk(e3), this.xn(i6, t5), this.wi(i6, true), this.g.oi(i6, false), this.dk(t5);
          }
        }, i5.prototype.YC = function() {
          for (var t5 = false, i6 = this.g.Ob(this.Y); i6 != -1; ) {
            for (var s4 = this.g.Ya(i6), n4 = 0, h3 = this.g.Ka(i6); n4 < h3 && 1 < h3; ) {
              var r3 = this.g.Na(s4), e3 = this.g.V(s4);
              this.g.hq(r3, e3) ? (t5 = true, this.wi(s4, false), this.g.qd(s4, true), this.wi(e3, false), this.g.qd(e3, true), s4 = r3, n4 = 0, h3 = this.g.Ka(i6)) : (s4 = e3, n4++);
            }
            if (2 > this.g.Ka(i6)) {
              for (t5 = this.g.Ya(i6), n4 = 0, h3 = this.g.Ka(i6); n4 < h3; n4++)
                this.wi(t5, false), t5 = this.g.V(t5);
              i6 = this.g.ar(i6), t5 = true;
            } else
              i6 = this.g.Sb(i6);
          }
          return t5;
        }, i5.prototype.up = function(t5) {
          for (var i6 = false; ; ) {
            var s4 = this.g.V(t5), n4 = this.g.Na(t5);
            if (s4 == t5)
              return this.wi(t5, true), this.g.oi(t5, false), true;
            if (!this.g.hq(s4, n4))
              break;
            if (i6 = true, this.dk(n4), this.dk(s4), this.wi(t5, true), this.g.oi(t5, false), this.xn(s4, n4), this.wi(s4, true), this.g.oi(s4, true), s4 == n4)
              break;
            t5 = n4;
          }
          return i6;
        }, i5.prototype.BM = function() {
          for (var t5 = 0, i6 = this.pe.sc(this.pe.ke); i6 != -1; i6 = this.pe.lb(i6)) {
            var s4 = this.pe.getData(i6);
            this.g.cj(s4, -1);
          }
          for (var n4 = 0, h3 = this.g.Ob(this.Y); h3 != -1; )
            if ((i6 = this.g.Ya(h3)) == -1 || this.g.cd(i6) != -1)
              s4 = h3, h3 = this.g.Sb(h3), this.g.br(s4);
            else {
              this.g.cj(i6, h3);
              var r3 = 1;
              for (s4 = this.g.V(i6); s4 != i6; s4 = this.g.V(s4))
                this.g.cj(s4, h3), r3++;
              this.g.fp(h3, false), this.g.Xj(h3, r3), this.g.Yg(h3, this.g.Na(i6)), n4 += r3, t5++, h3 = this.g.Sb(h3);
            }
          for (i6 = this.pe.sc(this.pe.ke); i6 != -1; i6 = this.pe.lb(i6))
            s4 = this.pe.getData(i6), this.g.cd(s4) == -1 && (h3 = this.g.iG(this.Y, s4, s4, null), n4 += this.g.Ka(h3), t5++);
          for (this.g.Tl(this.Y, t5), this.g.Vj(this.Y, n4), t5 = 0, n4 = this.g.md; n4 != -1; n4 = this.g.ve(n4))
            t5 += this.g.I(n4);
          this.g.XB(t5);
        }, i5.prototype.em = function(t5) {
          for (var i6 = 0, s4 = this.ye.size - 1; i6 < s4; i6++)
            if (t5 = (t5 + 1) % this.ye.size, this.ye.get(t5) != -1)
              return t5;
          return -1;
        }, i5.prototype.xn = function(t5, i6) {
          var s4 = this.g.Qa(i6, this.Rq), n4 = this.g.Qa(i6, this.Ag);
          this.g.gC(t5, i6), this.g.Sa(i6, this.Rq, s4), this.g.Sa(i6, this.Ag, n4);
        }, i5.prototype.dk = function(t5) {
          var i6 = this.g.Qa(t5, this.Ag);
          i6 != -1 && (this.ye.set(i6, -1), this.g.Sa(t5, this.Ag, -1));
        }, i5.W = function(t5, s4, n4, h3, r3) {
          var e3 = new i5();
          return e3.g = t5, e3.Y = s4, e3.sA = n4, e3.hw = h3, e3.od = r3, e3.SM();
        }, i5.prototype.kM = function(i6, s4) {
          var n4 = this.Yh.get(i6), h3 = new t4.h();
          this.g.Hc(n4, h3), n4 = new t4.h();
          var r3 = this.Yh.get(s4);
          return this.g.Hc(r3, n4), h3.rb(n4) ? 0 : (r3 = this.Bs.get(i6), i6 = new t4.h(), this.g.Hc(r3, i6), r3 = this.Bs.get(s4), s4 = new t4.h(), this.g.Hc(r3, s4), (r3 = new t4.h()).vc(h3, i6), (h3 = new t4.h()).vc(n4, s4), t4.h.pu(r3, h3));
        }, i5;
      }();
      t4.tn = i4;
    }(Q2 || (Q2 = {})), function(t4) {
      var i4;
      (i4 = t4.VL || (t4.VL = {}))[i4.Local = 0] = "Local", i4[i4.Geographic = 1] = "Geographic", i4[i4.Projected = 2] = "Projected", i4[i4.Image = 3] = "Image", i4[i4.Unknown = 4] = "Unknown", function(t5) {
        t5[t5.Integer32 = 0] = "Integer32", t5[t5.Integer64 = 1] = "Integer64", t5[t5.FloatingPoint = 2] = "FloatingPoint";
      }(t4.OL || (t4.OL = {}));
      var s4 = function() {
        function i5() {
          this.hA = null, this.rp = "", this.uu = null, this.fg = 0, this.UH = this.Jo = -1, this.yh = null;
        }
        return i5.prototype.Fc = function() {
          return this.fg;
        }, i5.prototype.QF = function() {
          return 1;
        }, i5.prototype.QW = function(t5) {
          this.hA = t5;
        }, i5.prototype.Yd = function() {
          if (this.hA !== null)
            return this.hA;
          var i6 = 1e-3;
          return this.fg != 0 ? i6 = t4.yr.xQ(this.fg) : this.yh != null && (i6 = t4.SC.yQ(this.yh)), i6;
        }, i5.prototype.wz = function() {
          return this.yh;
        }, i5.prototype.Id = function() {
          return this.fg != 0 ? t4.Uc.ah(t4.yr.Ny(this.fg)) : this.yh != null ? t4.SC.zQ(this.yh) : void 0;
        }, i5.Tb = function(i6) {
          if (i6.fg != 0) {
            if (t4.yr.US(i6.fg) === true)
              return 1;
            if (t4.yr.WS(i6.fg) === true)
              return 2;
          }
          return 4;
        }, i5.prototype.cs = function() {
          var i6 = this.Fc();
          return this.Jo != -1 ? this.Jo : (this.Jo = t4.yr.AK(i6), this.Jo != -1 ? this.Jo : i6);
        }, i5.create = function(s5) {
          if (0 >= s5)
            throw t4.i.O("Invalid or unsupported wkid: " + s5);
          var n4 = new i5();
          return n4.fg = s5, n4;
        }, i5.lP = function(s5) {
          if (s5 == null || s5.length == 0)
            throw t4.i.O("Cannot create SpatialReference from null or empty text.");
          var n4 = new i5();
          return n4.yh = s5, n4;
        }, i5.prototype.Nb = function(t5) {
          return this == t5 || t5 != null && this.constructor == t5.constructor && this.fg == t5.fg && (this.fg != 0 || this.yh === t5.yh);
        }, i5.prototype.toString = function() {
          return "[ tol: " + this.Mn() + "; wkid: " + this.Fc() + "; wkt: " + this.wz() + "]";
        }, i5.prototype.dc = function() {
          if (this.rp !== "")
            return this.rp;
          var t5 = this.toString();
          if (Array.prototype.reduce)
            return this.rp = "S" + t5.split("").reduce(function(t6, i7) {
              return (t6 = (t6 << 5) - t6 + i7.charCodeAt(0)) & t6;
            }, 0);
          var i6 = 0;
          if (t5.length === 0)
            return "";
          for (var s5 = 0; s5 < t5.length; s5++)
            i6 = (i6 << 5) - i6 + t5.charCodeAt(s5), i6 &= i6;
          return this.rp = "S" + i6;
        }, i5.prototype.Mn = function() {
          return this.Yd(0);
        }, i5.prototype.hh = function() {
          return this.uu !== null ? this.uu : this.uu = t4.iu.tP(this);
        }, i5.UN = 2147483645, i5.VN = 9007199254740990, i5;
      }();
      t4.Gg = s4;
    }(Q2 || (Q2 = {})), function(t4) {
      var i4 = function(i5) {
        function s4() {
          var s5 = i5 !== null && i5.apply(this, arguments) || this;
          return s5.Li = null, s5.NT = null, s5.Jq = new t4.UL(), s5.Go = null, s5.lw = null, s5;
        }
        return _2(s4, i5), s4.tP = function(i6) {
          var n4 = new s4();
          if (n4.fg = i6.fg, n4.Jo = i6.Jo, n4.UH = i6.UH, n4.yh = i6.yh, n4.yh !== "" && n4.yh !== null) {
            i6 = s4.fM(n4.yh);
            var h3 = s4.dM(n4.yh);
            n4.Jq.Wx(i6, h3, t4.ju.Integer64), n4.ay(i6), n4.cy(h3), n4.fg = i6.cs();
          } else
            i6 = s4.eM(n4.fg), n4.ay(i6), n4.cy(null), n4.Jq.Wx(i6, null, t4.ju.Integer64);
          return n4;
        }, s4.prototype.Yd = function(t5) {
          return this.Jq.Mn(t5);
        }, s4.dM = function(i6) {
          if (0 >= i6.length)
            throw t4.i.O();
          var n4 = null;
          try {
            n4 = t4.IC.fromString(i6);
          } catch (h3) {
            n4 = null;
          }
          return n4 == null ? null : s4.XC(n4, true);
        }, s4.prototype.ay = function(t5) {
          this.Ld = t5, this.Go = this.Ld.Id();
        }, s4.prototype.cy = function(t5) {
          this.FH = t5, this.NT = this.FH != null ? this.FH.Go : null;
        }, s4.prototype.Xc = function() {
          return this.Tb() != 0 && this.Tb() != 3 && this.Ld.Xc();
        }, s4.prototype.DG = function() {
          return this.Tb() != 0 && (this.Tb() == 3 ? this.Li.hk().Xc() : this.Ld.Xc());
        }, s4.prototype.gh = function() {
          return this.Ld != null ? this.Ld.Re : null;
        }, s4.prototype.rm = function() {
          return this.Ld.rm();
        }, s4.prototype.bf = function() {
          return this.Ld.bf();
        }, s4.prototype.jh = function() {
          return this.Ld != null ? this.Ld.uw : NaN;
        }, s4.prototype.Wp = function() {
          return this.Ld.Wp();
        }, s4.prototype.Yr = function() {
          return this.Ld.Yr();
        }, s4.prototype.mk = function() {
          return this.Ld.mk();
        }, s4.prototype.fS = function(i6) {
          return t4.JC.Ky(this.Ld, i6.Ld);
        }, s4.prototype.ol = function() {
          return this.Ld.ol();
        }, s4.prototype.Xr = function() {
          return this.Ld.Xr();
        }, s4.prototype.Bi = function() {
          return this.Tb() == 3 ? this.Li.hk().Bi() : this.Ld.Bi();
        }, s4.prototype.ih = function() {
          if (!this.Xc())
            throw t4.i.O("!isPannable()");
          var i6 = new t4.l();
          return this.Ld.ih(i6), i6;
        }, s4.prototype.Le = function() {
          if (!this.Xc())
            throw t4.i.O("!isPannable()");
          return this.Ld.uo;
        }, s4.prototype.CR = function() {
          if (!this.Xc())
            throw t4.i.O("!isPannable()");
          var i6 = new t4.l();
          return this.Ld.BR(i6), i6;
        }, s4.prototype.rv = function() {
          if (!this.Xc())
            throw t4.i.O("!isPannable()");
          return this.Ld.rv();
        }, s4.prototype.qv = function() {
          if (!this.Xc())
            throw t4.i.O("!isPannable()");
          return this.Ld.qv();
        }, s4.prototype.Zr = function() {
          return this.Li != null ? this.Li.hk().Zr() : this.Ld.Zr();
        }, s4.prototype.KQ = function() {
          return this.Ld.kv();
        }, s4.prototype.Sp = function() {
          return this.Go.getUnitFactor();
        }, s4.prototype.pz = function(t5) {
          return this.Jq.pz(t5);
        }, s4.prototype.tc = function() {
          var i6 = this.Tb();
          if (i6 == 1)
            return this;
          if (i6 == 3)
            return this.Li.hk().tc();
          if (i6 == 0)
            throw t4.i.ga("invalid call");
          if (i6 === 4)
            throw t4.i.ga("invalid call");
          if (this.lw !== null)
            return this.lw;
          if ((i6 = this.gh().getGeogcs()) == null)
            throw t4.i.Ra();
          return this.lw = s4.XE(i6, this.Jq.QF());
        }, s4.XE = function(i6, n4) {
          if (i6 == null)
            throw t4.i.O("null pointer.");
          var h3 = new s4();
          return i6 = s4.ou(i6, true), h3.Jq.Wx(i6, null, n4), h3.ay(i6), h3.cy(null), h3.fg = i6.cs(), h3;
        }, s4.prototype.Tb = function() {
          var i6 = this.gh();
          if (i6 != null)
            switch (i6.getType()) {
              case t4.Tc.PE_TYPE_GEOGCS:
                return 1;
              case t4.Tc.PE_TYPE_PROJCS:
                return 2;
            }
          return 4;
        }, s4.prototype.kv = function() {
          return this.Ld.kv();
        }, s4.ou = function(i6, n4) {
          var h3 = i6.getCode();
          if (0 >= h3 && 0 < (h3 = t4.qf.getCode(i6))) {
            if ((i6 = t4.qf.coordsys(h3)) == null)
              throw t4.i.O("Text to wkid mapping had failed: " + h3);
            return s4.ou(i6, n4);
          }
          if (n4 && 0 < h3 && (n4 = s4.qx[h3]))
            return n4;
          n4 = t4.Ab.zv(i6, h3, false);
          var r3 = s4.gK[n4];
          return r3 || (i6 = 0 >= h3 ? i6 : t4.qf.coordsys(h3), i6 = new t4.JC(i6), s4.gK[n4] = i6, 0 < h3 && (s4.qx[h3] = i6), i6);
        }, s4.eM = function(i6) {
          if (0 >= i6)
            throw t4.i.O("Invalid or unsupported wkid: " + i6);
          var n4 = s4.qx[i6];
          if (n4 != null)
            return n4;
          if ((n4 = t4.qf.coordsys(i6)) == null)
            throw t4.i.O("Invalid or unsupported wkid: " + i6);
          return (n4 = s4.ou(n4, false)).cs() != i6 && (s4.qx[i6] = n4), n4;
        }, s4.fM = function(i6) {
          if (i6 == null || i6 === void 0 || i6.length == 0)
            throw t4.i.O("Cannot create SpatialReference from null or empty text.");
          var n4 = null;
          try {
            n4 = t4.qf.fromString(t4.Tc.PE_TYPE_COORDSYS, i6);
          } catch (h3) {
            throw t4.i.O("Cannot create SpatialReference from text. " + h3.message);
          }
          if (n4 === null)
            throw t4.i.O("Cannot create SpatialReference from text. ");
          return s4.ou(n4, true);
        }, s4.XC = function(i6, n4) {
          var h3, r3 = i6.getCode();
          if (0 >= r3 && 0 < (r3 = t4.qf.getCode(i6))) {
            if ((r3 = t4.qf.vertcs(r3)) === null)
              throw t4.i.O();
            return s4.XC(r3, n4);
          }
          if (n4 && 0 < r3 && (n4 = s4.fK[r3]))
            return n4;
          if (i6 = t4.Ab.zv(i6, r3, false), n4 = s4.hK[i6])
            return n4;
          if (0 >= r3 || (h3 = t4.qf.vertcs(r3)), h3 === null)
            throw t4.i.O();
          return h3 = new t4.KL(h3), s4.hK[i6] = h3, 0 < r3 && (s4.fK[r3] = h3), h3;
        }, s4.nI = function(i6, s5) {
          if (s5 === null || s5.B())
            return null;
          var n4 = new t4.l();
          if (s5 !== null && i6.Tb() != 1) {
            var h3 = i6.tc(), r3 = h3.gh();
            i6 = t4.xr.Pr(i6, h3, null, null), (s5 = t4.Gx.local().W(s5, i6, null)).A(n4);
          } else
            r3 = i6.gh(), s5.A(n4);
          return s5 = r3.getPrimem().getLongitude(), r3 = r3.getUnit().getUnitFactor(), new t4.GC(n4.v, n4.G, n4.C, n4.H, s5, r3);
        }, s4.gD = function(t5) {
          var i6 = { name: "", steps: [], _pt: null, _entry: null }, s5 = 0;
          for (t5 = t5.getEntries(); s5 < t5.length; s5++) {
            var n4 = t5[s5], h3 = { HY: false, VY: "", UY: -1, geogtran: null };
            n4.getDirection() === 0 ? h3.isInverse = false : h3.isInverse = true;
            var r3 = n4.getGeogtran().getCode();
            -1 < r3 ? h3.wkid = r3 : h3.wkt = n4.getGeogtran().toString(), i6.steps.push(h3);
          }
          return i6;
        }, s4.SR = function(i6, n4, h3, r3) {
          return h3 === void 0 && (h3 = null), h3 = s4.nI(r3, h3), i6 = t4.np.getGTlist(i6.gh(), n4.gh(), 2, t4.np.PE_GTLIST_OPTS_COMMON, h3, 1), n4 = null, i6 && 0 < i6.length && (n4 = this.gD(i6[0]), t4.Lx.destroy(i6)), h3 !== null && h3.destroy(), n4;
        }, s4.TR = function(i6, n4, h3, r3) {
          var e3;
          if (h3 === void 0 && (h3 = null), r3 === void 0 && (r3 = null), e3 === void 0 && (e3 = 30), h3 = s4.nI(r3, h3), i6 = t4.np.getGTlist(i6.gh(), n4.gh(), 2, t4.np.PE_GTLIST_OPTS_COMMON, h3, e3), n4 = [], i6 && 0 < i6.length) {
            for (e3 = 0; e3 < i6.length; e3++)
              n4.push(this.gD(i6[e3]));
            t4.Lx.destroy(i6);
          }
          return h3 !== null && h3.destroy(), n4;
        }, s4.qx = {}, s4.gK = {}, s4.fK = {}, s4.hK = {}, s4;
      }(t4.Gg);
      t4.iu = i4;
    }(Q2 || (Q2 = {})), function(t4) {
      var i4, s4;
      (s4 = i4 = t4.ju || (t4.ju = {}))[s4.Integer32 = 0] = "Integer32", s4[s4.Integer64 = 1] = "Integer64", s4[s4.FloatingPoint = 2] = "FloatingPoint";
      var n4 = function() {
        function s5() {
          this.sp();
        }
        return s5.prototype.assign = function(t5) {
          this.Hm = t5.Hm, this.Im = t5.Im, this.Rj = t5.Rj, this.nA = t5.nA, this.Ho = t5.Ho, this.mA = t5.mA, this.Kk = t5.Kk, this.Oq = t5.Oq, this.Nq = t5.Nq, this.Tm = t5.Tm;
        }, s5.prototype.QF = function() {
          return this.Tm;
        }, s5.prototype.sp = function() {
          this.Im = this.Hm = 0, this.Rj = 1, this.nA = 0, this.Ho = 1, this.mA = 0, this.Nq = this.Oq = this.Kk = 2220446049250313e-29, this.Tm = i4.FloatingPoint;
        }, s5.prototype.Wx = function(s6, n5, h3) {
          if (this.sp(), this.Tm = h3, h3 != i4.FloatingPoint) {
            var r3 = new t4.l();
            s6.cR(r3), this.Hm = r3.v, this.Im = r3.G;
          } else
            this.Im = this.Hm = -17976931348623157e292;
          (r3 = s6.Re.getType()) == t4.Tc.PE_TYPE_GEOGCS ? (r3 = (h3 == i4.Integer64 ? 1e-9 : 1 / 18e5) * s6.bf(), this.Rj = 1 / r3) : r3 == t4.Tc.PE_TYPE_PROJCS && (r3 = (h3 == i4.Integer64 ? 1e-4 : 1e-3) * s6.rm(), this.Rj = 1 / r3), n5 != null ? (r3 = (h3 == i4.Integer32 ? 1e-3 : 1e-4) * n5.DH, this.Ho = 1 / r3) : this.Ho = 1e4, this.TM(), this.Kk = s6.uw, this.Oq = n5 != null ? 1e-3 * n5.DH : 1e-3, this.Nq = 2220446049250313e-29;
        }, s5.prototype.TM = function() {
          if (this.Tm != i4.FloatingPoint) {
            var s6 = this.Tm == i4.Integer64 ? t4.Gg.VN : t4.Gg.UN, n5 = s6 / this.Rj, h3 = this.Hm + n5, r3 = t4.P.truncate((h3 - this.Hm) * this.Rj);
            r3 > s6 && (this.Rj = s6 / (h3 - this.Hm)), n5 = this.Im + n5, (r3 = t4.P.truncate((n5 - this.Im) * this.Rj)) > s6 && (this.Rj = s6 / (n5 - this.Im));
          }
        }, s5.prototype.WB = function(t5) {
          switch (t5) {
            case 0:
              this.Kk = void 0;
            case 1:
              this.Oq = void 0;
            case 2:
              this.Nq = void 0;
          }
        }, s5.prototype.Mn = function(t5) {
          switch (t5) {
            case 0:
              return this.Kk;
            case 1:
              return this.Oq;
            case 2:
              return this.Nq;
          }
          return 0;
        }, s5.prototype.pz = function(t5) {
          if (this.Tm == i4.FloatingPoint)
            return 0;
          switch (t5) {
            case 0:
              return 1 / this.Rj;
            case 1:
            case 2:
              return 1 / this.Ho;
            default:
              return 0;
          }
        }, s5.prototype.toString = function() {
          var t5 = "SRPD [m_toleranceXY: " + this.Kk.toString();
          return (t5 = (t5 = (t5 = (t5 = (t5 = (t5 = (t5 = (t5 = (t5 = t5 + ";m_falseX: " + this.Hm.toString()) + ";m_falseY: " + this.Im.toString()) + ";m_unitsXY: " + this.Rj.toString()) + ";m_falseZ: " + this.nA.toString()) + ";m_unitsZ: " + this.Ho.toString()) + ";m_falseM: " + this.mA.toString()) + ";m_toleranceZ: " + this.Oq.toString()) + ";m_toleranceM: " + this.Nq.toString()) + ";m_precision: " + this.Tm.toString()) + "] ";
        }, s5;
      }();
      t4.UL = n4;
    }(Q2 || (Q2 = {})), function(t4) {
      function i4(t5, i5) {
        return 89.99999 < i5 ? i5 = 89.99999 : -89.99999 > i5 && (i5 = -89.99999), i5 *= 0.017453292519943, [111319.49079327169 * t5, 31890685e-1 * Math.log((1 + Math.sin(i5)) / (1 - Math.sin(i5)))];
      }
      function s4(t5, i5, s5) {
        return t5 = t5 / 6378137 * 57.29577951308232, s5 ? [t5, 57.29577951308232 * (1.5707963267948966 - 2 * Math.atan(Math.exp(-1 * i5 / 6378137)))] : [t5 - 360 * Math.floor((t5 + 180) / 360), 57.29577951308232 * (1.5707963267948966 - 2 * Math.atan(Math.exp(-1 * i5 / 6378137)))];
      }
      function n4(i5, s5, n5) {
        var h4 = i5.Qf();
        if (i5.K() === 33)
          s5 = s5(h4.Ng(), h4.kh()), h4.Db(s5[0], s5[1]);
        else if (i5.K() === 197) {
          var r4 = s5(i5.gs(), i5.js(), n5);
          s5 = s5(i5.fs(), i5.hs(), n5), h4.L(r4[0], r4[1], s5[0], s5[1]);
        } else
          for (r4 = new t4.h(), i5 = 0; i5 < h4.I(); i5++) {
            h4.D(i5, r4);
            var e4 = s5(r4.x, r4.y, n5);
            r4.na(e4[0], e4[1]), h4.Db(i5, r4);
          }
        return h4;
      }
      function h3(t5) {
        return n4(t5, s4, true);
      }
      function r3(t5) {
        return n4(t5, i4, true);
      }
      var e3 = Math.PI / 180;
      t4.PK = function() {
        function i5() {
        }
        return i5.xu = function(i6) {
          var s5 = Math.sqrt(0.006694379990197414), n5 = Math.sin(i6.y * e3);
          return t4.h.construct(6378137 * i6.x * e3, 3.1677196636462314e6 * (n5 / (1 - 0.006694379990197414 * n5 * n5) - 1 / (2 * s5) * Math.log((1 - s5 * n5) / (1 + s5 * n5))));
        }, i5.Ux = function(i6, s5, n5, h4) {
          var r4 = 1 / 298.257223563, o3 = Math.sin(n5);
          n5 = Math.cos(n5);
          var a3 = (1 - r4) * Math.tan(i6), u3 = a3 * (i6 = 1 / Math.sqrt(1 + a3 * a3)), f3 = Math.atan2(a3, n5), c3 = (a3 = i6 * o3) * a3, l3 = 1 - c3, p3 = 27233160610754688e-5 * l3 / 4040829998466145e-2, v3 = 1 + p3 / 16384 * (4096 + p3 * (p3 * (320 - 175 * p3) - 768)), y3 = p3 / 1024 * (256 + p3 * (p3 * (74 - 47 * p3) - 128));
          p3 = h4 / (635675231424518e-8 * v3);
          for (var b3, d3, g3, w3 = 2 * Math.PI; 1e-12 < Math.abs(p3 - w3); )
            g3 = Math.cos(2 * f3 + p3), w3 = p3, p3 = h4 / (635675231424518e-8 * v3) + y3 * (b3 = Math.sin(p3)) * (g3 + y3 / 4 * ((d3 = Math.cos(p3)) * (2 * g3 * g3 - 1) - y3 / 6 * g3 * (4 * b3 * b3 - 3) * (4 * g3 * g3 - 3)));
          return h4 = u3 * b3 - i6 * d3 * n5, l3 = r4 / 16 * l3 * (4 + r4 * (4 - 3 * l3)), t4.h.construct((s5 + (Math.atan2(b3 * o3, i6 * d3 - u3 * b3 * n5) - (1 - l3) * r4 * a3 * (p3 + l3 * b3 * (g3 + l3 * d3 * (2 * g3 * g3 - 1))))) / e3, Math.atan2(u3 * d3 + i6 * b3 * n5, (1 - r4) * Math.sqrt(c3 + h4 * h4)) / e3);
        }, i5.HM = function(t5, i6, s5, n5) {
          var h4 = 1 / 298.257223563, r4 = n5 - i6, e4 = Math.atan((1 - h4) * Math.tan(t5)), o3 = Math.atan((1 - h4) * Math.tan(s5)), a3 = Math.sin(e4);
          e4 = Math.cos(e4);
          var u3 = Math.sin(o3);
          o3 = Math.cos(o3);
          var f3 = r4, c3 = 1e3;
          do {
            var l3 = Math.sin(f3), p3 = Math.cos(f3), v3 = Math.sqrt(o3 * l3 * o3 * l3 + (e4 * u3 - a3 * o3 * p3) * (e4 * u3 - a3 * o3 * p3));
            if (v3 === 0)
              return 0;
            p3 = a3 * u3 + e4 * o3 * p3;
            var y3 = Math.atan2(v3, p3), b3 = e4 * o3 * l3 / v3, d3 = 1 - b3 * b3;
            l3 = p3 - 2 * a3 * u3 / d3, isNaN(l3) && (l3 = 0);
            var g3 = h4 / 16 * d3 * (4 + h4 * (4 - 3 * d3)), w3 = f3;
            f3 = r4 + (1 - g3) * h4 * b3 * (y3 + g3 * v3 * (l3 + g3 * p3 * (2 * l3 * l3 - 1)));
          } while (1e-12 < Math.abs(f3 - w3) && 0 < --c3);
          return c3 === 0 ? (a3 = n5 - i6, { azimuth: Math.atan2(Math.sin(a3) * Math.cos(s5), Math.cos(t5) * Math.sin(s5) - Math.sin(t5) * Math.cos(s5) * Math.cos(a3)), geodesicDistance: 6371008771415059e-9 * Math.acos(Math.sin(t5) * Math.sin(s5) + Math.cos(t5) * Math.cos(s5) * Math.cos(n5 - i6)) }) : (i6 = (t5 = 27233160610754688e-5 * d3 / 4040829998466145e-2) / 1024 * (256 + t5 * (t5 * (74 - 47 * t5) - 128)), { azimuth: Math.atan2(o3 * Math.sin(f3), e4 * u3 - a3 * o3 * Math.cos(f3)), TQ: 635675231424518e-8 * (1 + t5 / 16384 * (4096 + t5 * (t5 * (320 - 175 * t5) - 768))) * (y3 - i6 * v3 * (l3 + i6 / 4 * (p3 * (2 * l3 * l3 - 1) - i6 / 6 * l3 * (4 * v3 * v3 - 3) * (4 * l3 * l3 - 3)))), TY: Math.atan2(e4 * Math.sin(f3), e4 * u3 * Math.cos(f3) - a3 * o3) });
        }, i5.eQ = function(i6) {
          var s5 = i6.hasAttribute(1), n5 = i6.hasAttribute(2), h4 = [], r4 = i6.ea(), e4 = null, o3 = null;
          s5 && (e4 = i6.vb(1)), n5 && (o3 = i6.vb(2));
          for (var a3 = new t4.h(), u3 = 0; u3 < r4; u3++) {
            for (var f3 = i6.Ca(u3), c3 = i6.Ka(u3), l3 = 0, p3 = 0, v3 = NaN, y3 = NaN, b3 = NaN, d3 = NaN, g3 = i6.ec(u3), w3 = [], x3 = f3; x3 < f3 + c3; x3++) {
              i6.D(x3, a3), d3 = b3 = NaN;
              var m3 = [a3.x, a3.y];
              s5 && (b3 = e4.get(x3), m3.push(b3)), n5 && (r4 = o3.get(x3), m3.push(d3)), x3 == f3 && g3 && (l3 = a3.x, p3 = a3.y, v3 = b3, y3 = d3), w3.push(m3);
            }
            !g3 || l3 == a3.x && p3 == a3.y && (!s5 || isNaN(v3) && isNaN(b3) || v3 == b3) && (!n5 || isNaN(y3) && isNaN(d3) || y3 == d3) || w3.push(w3[0].slice(0)), h4.push(w3);
          }
          return h4;
        }, i5.Ry = function(t5, s5) {
          t5 = i5.eQ(t5), 637.100877141506 > s5 && (s5 = 637.100877141506);
          for (var n5, h4 = [], r4 = 0; r4 < t5.length; r4++) {
            var o3, a3, u3 = t5[r4];
            h4.push(n5 = []), n5.push([u3[0][0], u3[0][1]]);
            var f3 = u3[0][0] * e3, c3 = u3[0][1] * e3;
            for (o3 = 0; o3 < u3.length - 1; o3++) {
              var l3 = u3[o3 + 1][0] * e3, p3 = u3[o3 + 1][1] * e3;
              if (f3 !== l3 || c3 !== p3) {
                l3 = (p3 = i5.HM(c3, f3, p3, l3)).azimuth;
                var v3 = (p3 = p3.TQ) / s5;
                if (1 < v3) {
                  for (a3 = 1; a3 <= v3 - 1; a3++) {
                    var y3 = i5.Ux(c3, f3, l3, a3 * s5);
                    n5.push([y3.x, y3.y]);
                  }
                  a3 = i5.Ux(c3, f3, l3, (p3 + Math.floor(v3 - 1) * s5) / 2), n5.push([a3.x, a3.y]);
                }
                c3 = i5.Ux(c3, f3, l3, p3), n5.push([c3.x, c3.y]), f3 = c3.x * e3, c3 = c3.y * e3;
              }
            }
          }
          return { lJ: h4 };
        }, i5.SQ = function(s5) {
          for (var n5 = [], h4 = 0; h4 < s5.length; h4++) {
            var r4 = s5[h4];
            r4 = i5.Ry(r4, 1e4), n5.push(r4);
          }
          s5 = [];
          for (var e4 = 0; e4 < n5.length; e4++) {
            r4 = n5[e4];
            var o3 = 0;
            for (h4 = 0; h4 < r4.lJ.length; h4++) {
              var a3, u3 = r4.lJ[h4], f3 = i5.xu(t4.h.construct(u3[0][0], u3[0][1])), c3 = i5.xu(t4.h.construct(u3[u3.length - 1][0], u3[u3.length - 1][1])), l3 = c3.x * f3.y - f3.x * c3.y;
              for (a3 = 0; a3 < u3.length - 1; a3++)
                f3 = i5.xu(t4.h.construct(u3[a3 + 1][0], u3[a3 + 1][1])), l3 += (c3 = i5.xu(t4.h.construct(u3[a3][0], u3[a3][1]))).x * f3.y - f3.x * c3.y;
              o3 += l3;
            }
            o3 /= 1, s5.push(o3 / -2);
          }
          return s5;
        }, i5;
      }(), t4.cb = function() {
        function i5() {
        }
        return i5.sB = function(t5, s5, n5, h4, r4, e4, o3) {
          i5.bD[t5.dc()] = s5, isNaN(n5) == 0 && (i5.hD[t5.dc()] = n5), isNaN(h4) == 0 && (i5.uD[t5.dc()] = h4), isNaN(r4) == 0 && (i5.WC[t5.dc()] = r4), i5.iD[t5.dc()] = e4, o3 !== null && (i5.jD[t5.dc()] = o3);
        }, i5.Yw = function(t5, s5, n5) {
          i5.nD[t5.dc() + "-" + s5.dc()] = n5;
        }, i5.tc = function(s5) {
          if ((s5 = i5.bD[s5.dc()]) == null)
            throw t4.i.Fe();
          return s5;
        }, i5.bf = function(s5) {
          if ((s5 = i5.hD[s5.dc()]) == null)
            throw t4.i.Fe();
          return s5;
        }, i5.xv = function(s5) {
          if ((s5 = i5.uD[s5.dc()]) == null)
            throw t4.i.Fe();
          return s5;
        }, i5.gv = function(s5) {
          if ((s5 = i5.WC[s5.dc()]) == null)
            throw t4.i.Fe();
          return s5;
        }, i5.ih = function(s5) {
          if ((s5 = i5.jD[s5.dc()]) == null)
            throw t4.i.Fe();
          return t4.l.construct(s5[0], s5[1], s5[2], s5[3]);
        }, i5.Xc = function(s5) {
          if ((s5 = i5.iD[s5.dc()]) == null)
            throw t4.i.Fe();
          return s5;
        }, i5.Bh = function(s5, n5, h4) {
          if (n5.Nb(h4))
            return s5;
          var r4 = i5.nD[n5.dc() + "-" + h4.dc()];
          if (r4 !== void 0)
            return r4(s5, n5, h4);
          throw t4.i.Fe();
        }, i5.wt = function() {
          throw t4.i.Fe();
        }, i5.XQ = function() {
          throw t4.i.Fe();
        }, i5.ZV = function() {
          throw t4.i.Fe();
        }, i5.ol = function() {
          throw t4.i.Fe();
        }, i5.nW = function() {
          var i6 = t4.Gg.create(102100), s5 = t4.Gg.create(3857), n5 = t4.Gg.create(4326);
          t4.cb.sB(i6, n5, NaN, NaN, NaN, false, null), t4.cb.sB(n5, n5, 1, 0.0033528106647474805, 6378137, true, [-180, -90, 180, 90]), t4.cb.sB(s5, n5, NaN, NaN, NaN, false, null), t4.cb.Yw(i6, n5, h3), t4.cb.Yw(n5, i6, r3), t4.cb.Yw(s5, n5, h3), t4.cb.Yw(n5, s5, r3);
        }, i5.bD = [], i5.hD = [], i5.uD = [], i5.WC = [], i5.iD = [], i5.jD = [], i5.nD = [], i5;
      }();
    }(Q2 || (Q2 = {})), Q2.cb.nW(), function(t4) {
      var i4 = function() {
        function i5(t5) {
          this.o = new Int32Array(0), this.ko = -1, this.Jg = this.size = this.Dl = 0, this.Mf = t5;
        }
        return i5.prototype.kd = function(t5) {
          t5 < this.Dl ? (this.o[t5 * this.Mf] = this.ko, this.ko = t5) : this.Dl--, this.size--;
        }, i5.prototype.U = function(t5, i6) {
          return this.o[t5 * this.Mf + i6];
        }, i5.prototype.T = function(t5, i6, s4) {
          this.o[t5 * this.Mf + i6] = s4;
        }, i5.prototype.De = function() {
          var i6 = this.ko;
          if (i6 == -1) {
            if (this.Dl == this.Jg) {
              if (2147483647 < (i6 = this.Jg != 0 ? t4.P.truncate(3 * (this.Jg + 1) / 2) : 1) && (i6 = 2147483647), i6 == this.Jg)
                throw t4.i.de();
              this.yz(i6);
            }
            i6 = this.Dl, this.Dl++;
          } else
            this.ko = this.o[i6 * this.Mf];
          this.size++;
          for (var s4 = i6 * this.Mf; s4 < i6 * this.Mf + this.Mf; s4++)
            this.o[s4] = -1;
          return i6;
        }, i5.prototype.Nl = function(i6) {
          var s4 = this.ko;
          if (s4 == -1) {
            if (this.Dl == this.Jg) {
              if (2147483647 < (s4 = this.Jg != 0 ? t4.P.truncate(3 * (this.Jg + 1) / 2) : 1) && (s4 = 2147483647), s4 == this.Jg)
                throw t4.i.de();
              this.yz(s4);
            }
            s4 = this.Dl, this.Dl++;
          } else
            this.ko = this.o[s4 * this.Mf];
          this.size++;
          for (var n4 = s4 * this.Mf, h3 = 0; h3 < i6.length; h3++)
            this.o[n4 + h3] = i6[h3];
          return s4;
        }, i5.prototype.oj = function(t5) {
          this.ko = -1, this.size = this.Dl = 0, t5 && (this.o = null, this.Jg = 0);
        }, i5.prototype.Ee = function(t5) {
          t5 > this.Jg && this.yz(t5);
        }, i5.prototype.sx = function(t5, i6) {
          t5 *= this.Mf, i6 *= this.Mf;
          for (var s4 = 0; s4 < this.Mf; s4++) {
            var n4 = this.o[i6 + s4];
            this.o[i6 + s4] = this.o[t5 + s4], this.o[t5 + s4] = n4;
          }
        }, i5.prototype.bC = function(t5, i6, s4) {
          var n4 = this.o[this.Mf * i6 + s4];
          this.o[this.Mf * i6 + s4] = this.o[this.Mf * t5 + s4], this.o[this.Mf * t5 + s4] = n4;
        }, i5.GG = function(t5) {
          return 0 <= t5;
        }, i5.prototype.yz = function(t5) {
          this.o == null && (this.o = new Int32Array(0));
          var i6 = new Int32Array(this.Mf * t5);
          i6.set(this.o, 0), this.o = i6, this.Jg = t5;
        }, i5;
      }();
      t4.ad = i4;
    }(Q2 || (Q2 = {})), function(t4) {
      var i4, s4;
      (s4 = i4 || (i4 = {}))[s4.enumInputModeBuildGraph = 0] = "enumInputModeBuildGraph", s4[s4.enumInputModeSimplifyAlternate = 4] = "enumInputModeSimplifyAlternate", s4[s4.enumInputModeSimplifyWinding = 5] = "enumInputModeSimplifyWinding", s4[s4.enumInputModeIsSimplePolygon = 7] = "enumInputModeIsSimplePolygon";
      var n4 = function() {
        function i5(i6) {
          this.Ce = i6, this.Ah = NaN, this.$G = new t4.jg(), this.aH = new t4.jg(), this.os = new t4.Oc(), this.ps = new t4.Oc();
        }
        return i5.prototype.compare = function(t5, i6, s5) {
          if (t5 = t5.ka(s5), this.Ce.kB(i6, this.$G), this.Ce.kB(t5, this.aH), i6 = this.$G.get(), t5 = this.aH.get(), this.os.L(i6.ta, i6.qa), this.ps.L(t5.ta, t5.qa), this.os.wa < this.ps.pa)
            return -1;
          if (this.os.pa > this.ps.wa)
            return 1;
          s5 = i6.oa == i6.ma;
          var n5 = t5.oa == t5.ma;
          if (s5 || n5) {
            if (s5 && n5)
              return 0;
            if (i6.oa == t5.oa && i6.ta == t5.ta)
              return s5 ? 1 : -1;
            if (i6.ma == t5.ma && i6.qa == t5.qa)
              return s5 ? -1 : 1;
          }
          return (s5 = i6.Me(this.Ah, this.os.pa)) == (n5 = t5.Me(this.Ah, this.ps.pa)) && ((n5 = 0.5 * ((s5 = Math.min(i6.ma, t5.ma)) + this.Ah)) == this.Ah && (n5 = s5), s5 = i6.Me(n5, this.os.pa), n5 = t5.Me(n5, this.ps.pa)), s5 < n5 ? -1 : s5 > n5 ? 1 : 0;
        }, i5.prototype.WJ = function(t5) {
          this.Ah = t5;
        }, i5;
      }(), h3 = function() {
        function i5(i6) {
          this.ib = i6, this.RH = new t4.jg(), this.Cf = new t4.h(), this.rA = new t4.Oc();
        }
        return i5.prototype.fX = function(t5) {
          this.Cf.N(t5);
        }, i5.prototype.compare = function(t5, i6) {
          return this.ib.kB(t5.ka(i6), this.RH), t5 = this.RH.get(), this.rA.L(t5.ta, t5.qa), this.Cf.x < this.rA.pa ? -1 : this.Cf.x > this.rA.wa ? 1 : (t5 = t5.Me(this.Cf.y, this.Cf.x), this.Cf.x < t5 ? -1 : this.Cf.x > t5 ? 1 : 0);
        }, i5;
      }();
      i4 = function() {
        function i5() {
          this.cH = this.Fi = this.Ii = this.fA = this.$n = this.ze = this.Lc = this.lh = this.he = null, this.Io = this.yg = -1, this.bH = true, this.kA = false, this.gA = NaN, this.Pi = new t4.Nd(), this.XN = 2147483647, this.WN = t4.P.truncate(-2147483648), this.eg = this.be = this.Jl = this.Eq = this.Em = this.Dq = this.Qs = this.Oe = -1, this.xa = 0;
        }
        return i5.prototype.ty = function(t5) {
          this.gA = t5;
        }, i5.prototype.$m = function() {
          this.he == null && (this.he = new t4.ad(8));
          var i6 = this.he.De();
          return this.he.T(i6, 1, 0), i6;
        }, i5.prototype.qU = function() {
          this.Lc == null && (this.Lc = new t4.ad(8));
          var i6 = this.Lc.De();
          this.Lc.T(i6, 2, 0), this.Lc.T(i6, 3, 0);
          var s5 = this.Lc.De();
          return this.Lc.T(s5, 2, 0), this.Lc.T(s5, 3, 0), this.EJ(i6, s5), this.EJ(s5, i6), i6;
        }, i5.prototype.hI = function() {
          this.ze == null && (this.ze = new t4.ad(8));
          var i6 = this.ze.De();
          return this.ze.T(i6, 2, 0), i6;
        }, i5.prototype.OW = function(t5, i6) {
          this.he.T(t5, 7, i6);
        }, i5.prototype.on = function(t5, i6) {
          this.he.T(t5, 2, i6);
        }, i5.prototype.NW = function(t5, i6) {
          this.he.T(t5, 1, i6);
        }, i5.prototype.gX = function(t5, i6) {
          this.he.T(t5, 3, i6);
        }, i5.prototype.dX = function(t5, i6) {
          this.he.T(t5, 4, i6);
        }, i5.prototype.er = function(t5, i6) {
          this.he.T(t5, 5, i6);
        }, i5.prototype.$Q = function(t5) {
          return this.he.U(t5, 5);
        }, i5.prototype.MW = function(t5, i6) {
          this.he.T(t5, 6, i6);
        }, i5.prototype.YM = function(t5, i6) {
          this.MW(i6, t5);
        }, i5.prototype.DJ = function(t5, i6) {
          this.Lc.T(t5, 1, i6);
        }, i5.prototype.EJ = function(t5, i6) {
          this.Lc.T(t5, 4, i6);
        }, i5.prototype.Vl = function(t5, i6) {
          this.Lc.T(t5, 5, i6);
        }, i5.prototype.Ul = function(t5, i6) {
          this.Lc.T(t5, 6, i6);
        }, i5.prototype.VW = function(t5, i6) {
          this.Lc.T(t5, 2, i6);
        }, i5.prototype.cx = function(t5, i6) {
          this.Lc.T(t5, 3, i6);
        }, i5.prototype.GF = function(t5) {
          return this.Lc.U(t5, 3);
        }, i5.prototype.Ht = function(t5, i6) {
          this.Lc.T(t5, 7, i6);
        }, i5.prototype.zK = function(t5, i6) {
          if (this.om(t5) != -1)
            for (i6 = i6 ? -1 : t5, t5 = this.om(t5); t5 != -1; t5 = this.ls(t5))
              this.g.Sa(this.vj(t5), this.Eq, i6);
        }, i5.prototype.xx = function(t5, i6) {
          t5 != -1 && (this.zK(t5, i6), this.zK(this.ya(t5), i6));
        }, i5.prototype.Et = function(t5, i6) {
          this.ze.T(t5, 1, i6);
        }, i5.prototype.Xg = function(t5, i6) {
          this.ze.T(t5, 2, i6);
        }, i5.prototype.ln = function(t5, i6) {
          this.ze.T(t5, 3, i6), this.IW(t5, this.ZQ(i6)), this.HW(i6, t5);
        }, i5.prototype.HW = function(t5, i6) {
          this.ze.T(t5, 4, i6);
        }, i5.prototype.IW = function(t5, i6) {
          this.ze.T(t5, 5, i6);
        }, i5.prototype.yJ = function(t5, i6) {
          this.ze.T(t5, 6, i6);
        }, i5.prototype.wJ = function(t5, i6) {
          this.ze.T(t5, 7, i6);
        }, i5.prototype.vJ = function(t5, i6) {
          this.$n.write(t5, i6);
        }, i5.prototype.xJ = function(t5, i6) {
          this.fA.write(t5, i6);
        }, i5.prototype.gY = function(i6) {
          var s5 = 0, n5 = 0, h4 = this.vF(i6), r3 = new t4.h(), e3 = new t4.h(), o3 = new t4.h();
          this.$r(h4, r3), e3.N(r3);
          var a3 = h4;
          do {
            this.nm(a3, o3), n5 += t4.h.ub(e3, o3), this.$e(this.ya(a3)) != i6 && (s5 += (o3.x - r3.x - (e3.x - r3.x)) * (o3.y - r3.y + (e3.y - r3.y)) * 0.5), e3.N(o3), a3 = this.kc(a3);
          } while (a3 != h4);
          this.$n.write(i6, s5), this.fA.write(i6, n5);
        }, i5.prototype.KU = function(i6, s5) {
          var r3 = new n4(this), e3 = new t4.$j();
          e3.Ee(t4.P.truncate(this.xa / 2)), e3.Xo(r3);
          for (var o3 = new t4.ja(0), a3 = this.bh(), u3 = null, f3 = 0, c3 = new t4.h(), l3 = this.Oe; l3 != -1; l3 = this.Tf(l3)) {
            if ((255 & ++f3) == 0 && s5 != null && !s5.progress(-1, -1))
              throw t4.i.RC();
            var p3 = this.Je(l3);
            if (p3 != -1) {
              if (o3.Dh(0), !this.cY(e3, a3, o3, p3)) {
                this.D(l3, c3), r3.WJ(c3.y);
                var v3 = p3;
                do {
                  var y3 = this.Bb(v3, a3);
                  y3 != -1 && (e3.wd(y3, -1), this.Kb(v3, a3, -2)), v3 = this.kc(this.ya(v3));
                } while (p3 != v3);
                v3 = p3;
                do {
                  (y3 = this.Bb(v3, a3)) == -1 && (y3 = e3.addElement(v3, -1), o3.add(y3)), v3 = this.kc(this.ya(v3));
                } while (p3 != v3);
              }
              for (p3 = o3.size - 1; 0 <= p3; p3--)
                y3 = o3.get(p3), v3 = e3.ka(y3), this.Kb(this.ya(v3), a3, y3), this.JU(e3, y3, i6);
            } else
              this.Yy(l3) == -1 && (u3 == null && (u3 = new h3(this)), this.D(l3, c3), u3.fX(c3), v3 = e3.DW(u3), p3 = this.Jl, v3 != -1 && (y3 = e3.ka(v3), this.$e(y3) == this.$e(this.ya(y3)) && (y3 = this.JF(e3, v3)), y3 != -1 && (p3 = this.$e(y3))), this.YM(p3, l3));
          }
          this.Lg(a3);
        }, i5.prototype.JU = function(t5, i6, s5) {
          var n5 = t5.ka(i6), h4 = this.$e(n5);
          if (this.In(h4) == -1) {
            var r3 = this.JF(t5, i6), e3 = this.ya(n5), o3 = this.$e(e3);
            this.Mp(h4), this.Mp(o3);
            var a3 = this.In(h4), u3 = this.In(o3);
            if (r3 == -1 && a3 == -1 && (o3 == h4 ? (this.ln(o3, this.Jl), a3 = u3 = this.Jl) : (u3 == -1 && (this.ln(o3, this.Jl), u3 = this.Jl), this.ln(h4, o3), a3 = o3)), r3 != -1) {
              var f3 = this.$e(r3);
              u3 == -1 && (0 >= this.Mp(f3) ? (u3 = this.In(f3), this.ln(o3, u3)) : (this.ln(o3, f3), u3 = f3), o3 == h4 && (a3 = u3));
            }
            a3 == -1 && this.dY(h4, o3), s5 == 0 ? this.eW(t5, i6, n5, r3, h4, o3) : s5 == 5 ? this.fW(t5, i6, n5, e3, h4, o3) : s5 == 4 && this.dW(n5, r3, h4, o3);
          }
        }, i5.prototype.eW = function(t5, i6, s5, n5, h4, r3) {
          var e3 = this.jk(h4);
          if (n5 != -1) {
            var o3 = this.jk(r3), a3 = this.jk(this.$e(n5));
            n5 = e3 & o3 & a3, a3 ^= a3 & this.fh(s5), (a3 |= n5) != 0 && (this.Xg(r3, o3 | a3), this.Xg(h4, a3 | e3), e3 = e3 || a3);
          }
          for (i6 = t5.lb(i6); i6 != -1 && (n5 = t5.ka(i6), s5 = this.$e(this.ya(n5)), h4 = this.jk(s5), r3 = this.fh(n5), o3 = this.$e(n5), n5 = h4 & (a3 = this.jk(o3)) & e3, e3 ^= e3 & r3, (e3 |= n5) != 0); i6 = t5.lb(i6))
            this.Xg(s5, h4 | e3), this.Xg(o3, a3 | e3);
        }, i5.prototype.fW = function(i6, s5, n5, h4, r3, e3) {
          if (r3 != e3) {
            n5 = this.Bb(n5, this.eg), n5 += this.Bb(h4, this.eg), h4 = 0;
            var o3 = new t4.ja(0), a3 = new t4.ja(0);
            a3.add(0);
            for (var u3 = i6.sc(-1); u3 != s5; u3 = i6.lb(u3)) {
              var f3 = i6.ka(u3), c3 = this.ya(f3), l3 = this.$e(f3), p3 = this.$e(c3);
              if (l3 != p3) {
                if (f3 = this.Bb(f3, this.eg), h4 += f3 += this.Bb(c3, this.eg), c3 = false, o3.size != 0 && o3.Gc() == p3 && (a3.Jf(), o3.Jf(), c3 = true), this.In(p3) == -1)
                  throw t4.i.Ra();
                c3 && this.In(p3) == l3 || (a3.add(h4), o3.add(l3));
              }
            }
            h4 += n5, o3.size != 0 && o3.Gc() == e3 && (a3.Jf(), o3.Jf()), h4 != 0 ? a3.Gc() == 0 && (i6 = this.g.md, i6 = this.Ma(i6), this.Xg(r3, i6)) : a3.Gc() != 0 && (i6 = this.g.md, i6 = this.Ma(i6), this.Xg(r3, i6));
          }
        }, i5.prototype.dW = function(t5, i6, s5, n5) {
          var h4 = this.Ma(this.g.md);
          if (i6 == -1)
            this.Xg(n5, this.Io), (1 & (t5 = this.Bb(t5, this.yg))) != 0 ? this.Xg(s5, h4) : this.Xg(s5, this.Io);
          else {
            var r3 = this.jk(n5);
            r3 == 0 ? (r3 = this.jk(this.$e(i6)), this.Xg(n5, r3), (1 & (t5 = this.Bb(t5, this.yg))) != 0 ? this.Xg(s5, r3 == h4 ? this.Io : h4) : this.Xg(s5, r3)) : (1 & (t5 = this.Bb(t5, this.yg))) != 0 ? this.Xg(s5, r3 == h4 ? this.Io : h4) : this.Xg(s5, r3);
          }
        }, i5.prototype.cY = function(t5, i6, s5, n5) {
          var h4 = n5, r3 = -1, e3 = -1, o3 = 0;
          do {
            if (o3 == 2)
              return false;
            var a3 = this.Bb(h4, i6);
            if (a3 != -1) {
              if (r3 != -1)
                return false;
              r3 = a3;
            } else {
              if (e3 != -1)
                return false;
              e3 = h4;
            }
            o3++, h4 = this.kc(this.ya(h4));
          } while (n5 != h4);
          return e3 != -1 && r3 != -1 && (this.Kb(t5.ka(r3), i6, -2), t5.Uj(r3, e3), s5.add(r3), true);
        }, i5.prototype.dY = function(t5, i6) {
          var s5 = this.Mp(t5);
          if (s5 != 0) {
            var n5 = this.Mp(i6);
            0 < s5 && 0 > n5 || 0 > s5 && 0 < n5 ? this.ln(t5, i6) : (i6 = this.In(i6)) != -1 && this.ln(t5, i6);
          }
        }, i5.prototype.qP = function(i6, s5) {
          this.Eq = this.g.Hd();
          for (var n5 = 0, h4 = s5.size; n5 < h4; n5++) {
            var r3 = s5.get(n5), e3 = this.g.Qa(r3, this.Em), o3 = this.g.Sf(this.g.cd(r3)), a3 = this.g.jc(o3);
            if (t4.ba.Ic(a3)) {
              var u3 = this.g.V(r3);
              if (u3 != -1) {
                var f3 = this.g.Qa(u3, this.Em);
                if (e3 != f3) {
                  var c3 = this.qU(), l3 = this.ya(c3), p3 = this.lh.De();
                  this.lh.T(p3, 0, r3), this.lh.T(p3, 1, -1), this.Ht(c3, p3), this.DJ(c3, e3), (p3 = this.Je(e3)) == -1 ? (this.on(e3, c3), this.Vl(c3, l3), this.Ul(l3, c3)) : (e3 = this.ue(p3), this.Vl(p3, l3), this.Ul(l3, p3), this.Ul(e3, c3), this.Vl(c3, e3)), this.DJ(l3, f3), (e3 = this.Je(f3)) == -1 ? (this.on(f3, l3), this.Ul(c3, l3), this.Vl(l3, c3)) : (f3 = this.ue(e3), this.Vl(e3, c3), this.Ul(c3, e3), this.Ul(f3, l3), this.Vl(l3, f3)), o3 = this.Ma(o3), i6 == 0 ? (this.Kb(l3, this.be, 0), this.Kb(c3, this.be, a3 == 1736 ? o3 : 0)) : i6 == 5 ? (f3 = new t4.h(), this.g.D(r3, f3), r3 = new t4.h(), this.g.D(u3, r3), e3 = u3 = 0, 0 > f3.compare(r3) ? u3 = 1 : e3 = -1, this.Kb(l3, this.be, 0), this.Kb(c3, this.be, 0), this.Kb(c3, this.eg, u3), this.Kb(l3, this.eg, e3)) : i6 == 7 ? (this.Kb(l3, this.be, this.Io), this.Kb(c3, this.be, a3 == 1736 ? o3 : 0)) : i6 == 4 && (this.Kb(l3, this.be, 0), this.Kb(c3, this.be, 0), this.Kb(c3, this.yg, 1), this.Kb(l3, this.yg, 1)), a3 = a3 == 1736 ? this.WN : 0, this.cx(c3, o3 | a3), this.cx(l3, o3 | a3);
                }
              }
            }
          }
        }, i5.prototype.QT = function(t5, i6) {
          var s5 = this.om(i6);
          if (s5 != -1) {
            var n5 = this.om(t5);
            this.lh.T(s5, 1, n5), this.Ht(t5, s5), this.Ht(i6, -1);
          }
          t5 = this.ya(t5), i6 = this.ya(i6), (s5 = this.om(i6)) != -1 && (n5 = this.om(t5), this.lh.T(s5, 1, n5), this.Ht(t5, s5), this.Ht(i6, -1));
        }, i5.prototype.EX = function(i6) {
          function s5(t5, i7) {
            return h4.CO(t5, i7);
          }
          var n5 = new t4.ja(0);
          n5.Jb(10);
          for (var h4 = this, r3 = this.Oe; r3 != -1; r3 = this.Tf(r3)) {
            n5.clear(false);
            var e3 = this.Je(r3);
            if (e3 != -1) {
              var o3 = e3;
              do {
                n5.add(o3), o3 = this.kc(this.ya(o3));
              } while (o3 != e3);
              if (1 < n5.size) {
                if (o3 = true, 2 < n5.size)
                  n5.Wd(0, n5.size, s5), n5.add(n5.get(0));
                else if (0 < this.BO(n5.get(0), n5.get(1))) {
                  var a3 = n5.get(0);
                  n5.set(0, n5.get(1)), n5.set(1, a3);
                } else
                  o3 = false;
                for (var u3 = a3 = n5.get(0), f3 = this.vf(u3), c3 = this.ya(u3), l3 = -1, p3 = 1, v3 = n5.size; p3 < v3; p3++) {
                  var y3 = n5.get(p3), b3 = this.ya(y3), d3 = this.lk(b3);
                  if (d3 == f3 && y3 != u3) {
                    if (i6 == 0)
                      l3 = this.GF(u3) | this.GF(y3), this.cx(u3, l3), this.cx(c3, l3), this.Kb(u3, this.be, this.Bb(u3, this.be) | this.Bb(y3, this.be)), this.Kb(c3, this.be, this.Bb(c3, this.be) | this.Bb(b3, this.be));
                    else if (this.eg != -1)
                      l3 = this.Bb(u3, this.eg) + this.Bb(y3, this.eg), b3 = this.Bb(c3, this.eg) + this.Bb(b3, this.eg), this.Kb(u3, this.eg, l3), this.Kb(c3, this.eg, b3);
                    else {
                      if (i6 == 7)
                        return void (this.Pi = new t4.Nd(5, r3, -1));
                      this.yg != -1 && (l3 = this.Bb(u3, this.yg) + this.Bb(y3, this.yg), b3 = this.Bb(c3, this.yg) + this.Bb(b3, this.yg), this.Kb(u3, this.yg, l3), this.Kb(c3, this.yg, b3));
                    }
                    this.QT(u3, y3), this.Gy(y3), l3 = u3, n5.set(p3, -1), y3 == a3 && (n5.set(0, -1), a3 = -1);
                  } else
                    this.xx(l3, false), l3 = -1, u3 = y3, f3 = d3, c3 = b3;
                }
                if (this.xx(l3, false), l3 = -1, o3) {
                  for (a3 = -1, p3 = 0, v3 = n5.size; p3 < v3; p3++)
                    if ((y3 = n5.get(p3)) != -1) {
                      if (a3 == -1)
                        u3 = a3 = y3, f3 = this.vf(u3), c3 = this.ya(u3);
                      else if (y3 != u3 && (b3 = this.ya(y3), d3 = this.lk(b3), this.Ul(c3, y3), this.Vl(y3, c3), u3 = y3, f3 = d3, c3 = b3, i6 == 7 && (this.Bb(y3, this.be) | this.Bb(this.ue(y3), this.be)) == (1 | this.Io)))
                        return void (this.Pi = new t4.Nd(5, r3, -1));
                    }
                  this.on(r3, a3);
                } else {
                  for (a3 = -1, p3 = 0, v3 = n5.size; p3 < v3; p3++)
                    if ((y3 = n5.get(p3)) != -1) {
                      a3 = y3;
                      break;
                    }
                  e3 != a3 && this.on(r3, a3);
                }
              }
            }
          }
        }, i5.prototype.RN = function() {
          for (var i6 = -1, s5 = this.bh(), n5 = this.Oe; n5 != -1; n5 = this.Tf(n5)) {
            var h4 = this.Je(n5);
            if (h4 != -1) {
              var r3 = h4;
              do {
                if (this.Bb(r3, s5) != 1) {
                  var e3 = this.hI();
                  this.Et(e3, r3), this.wJ(e3, i6), i6 != -1 && this.yJ(i6, e3), i6 = e3;
                  var o3 = 0, a3 = r3;
                  do {
                    o3 |= this.Bb(a3, this.be), this.VW(a3, e3), this.Kb(a3, s5, 1), a3 = this.kc(a3);
                  } while (a3 != r3);
                  this.Xg(e3, o3);
                }
                r3 = this.kc(this.ya(r3));
              } while (r3 != h4);
            }
          }
          e3 = this.hI(), this.Et(e3, -1), this.wJ(e3, i6), i6 != -1 && this.yJ(i6, e3), this.Jl = e3, this.$n = t4.ce.rf(this.ze.size, NaN), this.fA = t4.ce.rf(this.ze.size, NaN), this.vJ(this.Jl, 1 / 0), this.xJ(this.Jl, 1 / 0), this.Lg(s5);
        }, i5.prototype.mR = function(t5, i6, s5) {
          if ((i6 = i6 != -1 ? i6 : this.Je(t5)) == -1)
            return -1;
          for (t5 = i6; ; ) {
            if (this.Bb(i6, s5) != 1)
              return i6;
            if ((i6 = this.kc(this.ya(i6))) == t5)
              return -1;
          }
        }, i5.prototype.tW = function() {
          for (var t5 = this.bh(), i6 = this.Oe; i6 != -1; i6 = this.Tf(i6))
            for (var s5 = -1; ; ) {
              var n5 = this.mR(i6, s5, t5);
              if (n5 == -1)
                break;
              s5 = this.kc(this.ya(n5));
              for (var h4 = n5; ; ) {
                var r3 = this.kc(h4), e3 = this.ue(h4), o3 = this.ya(h4);
                if (e3 == o3) {
                  if (this.DP(h4), s5 != h4 && s5 != o3 || (s5 = -1), h4 == n5 || e3 == n5) {
                    if (h4 == (n5 = r3) || e3 == n5)
                      break;
                    h4 = r3;
                    continue;
                  }
                } else
                  this.Kb(h4, t5, 1);
                if ((h4 = r3) == n5)
                  break;
              }
            }
          this.Lg(t5);
        }, i5.prototype.HB = function(i6, s5, n5, h4, r3) {
          this.Wg(), this.bH = r3, this.g = i6, this.Dq = this.g.WE(), (i6 = new t4.ja(0)).Jb(n5 != null ? this.g.I(n5.get(0)) : this.g.gd);
          var e3 = 0, o3 = 1, a3 = n5 != null ? n5.get(0) : this.g.md;
          for (r3 = 1; a3 != -1; ) {
            this.g.CJ(a3, this.Dq, o3), o3 <<= 1;
            for (var u3 = this.g.Ob(a3); u3 != -1; u3 = this.g.Sb(u3))
              for (var f3 = this.g.Ya(u3), c3 = 0, l3 = this.g.Ka(u3); c3 < l3; c3++)
                i6.add(f3), f3 = this.g.V(f3);
            t4.ba.Tn(this.g.jc(a3)) || (e3 += this.g.ea(a3)), n5 != null ? (a3 = r3 < n5.size ? n5.get(r3) : -1, r3++) : a3 = this.g.ve(a3);
          }
          for (this.Io = o3, this.xa = i6.size, this.g.nx(i6, this.xa), this.lh == null && (this.lh = new t4.ad(2), this.he = new t4.ad(8), this.Lc = new t4.ad(8), this.ze = new t4.ad(8)), this.lh.Ee(this.xa), t4.op.Bp(h4), this.he.Ee(this.xa + 10), this.Lc.Ee(2 * this.xa + 32), this.ze.Ee(Math.max(32, e3)), this.Em = this.g.Hd(), n5 = new t4.h(), r3 = 0, e3 = new t4.h(), n5.Sc(), o3 = 0; o3 <= this.xa; o3++)
            if (o3 < this.xa ? (f3 = i6.get(o3), this.g.D(f3, e3)) : e3.Sc(), !n5.rb(e3)) {
              if (r3 < o3) {
                for (f3 = this.$m(), l3 = c3 = -1; r3 < o3; r3++)
                  l3 = i6.get(r3), this.g.Sa(l3, this.Em, f3), a3 = this.lh.De(), this.lh.T(a3, 0, l3), this.lh.T(a3, 1, c3), c3 = a3, u3 = this.g.cd(l3), a3 = this.g.Sf(u3), a3 = this.Ma(a3), this.NW(f3, this.yd(f3) | a3);
                this.OW(f3, c3), this.er(f3, this.g.Va(l3)), this.Qs != -1 && this.dX(this.Qs, f3), this.gX(f3, this.Qs), this.Qs = f3, this.Oe == -1 && (this.Oe = f3);
              }
              r3 = o3, n5.N(e3);
            }
          t4.op.Bp(h4), this.be = this.bh(), s5 == 5 && (this.eg = this.bh()), s5 == 4 && (this.yg = this.bh()), this.qP(s5, i6), this.Pi.Lj == 0 && (this.EX(s5), this.Pi.Lj == 0 && (isNaN(this.gA) || this.sO() ? (this.RN(), this.Pi.Lj == 0 && (this.Lg(this.be), this.be = -1, this.bH && this.KU(s5, h4))) : this.kA = true));
        }, i5.prototype.Gy = function(t5) {
          var i6 = this.kc(t5), s5 = this.ue(t5), n5 = this.ya(t5), h4 = this.kc(n5), r3 = this.ue(n5);
          i6 != n5 && (this.Ul(r3, i6), this.Vl(i6, r3)), s5 != n5 && (this.Ul(s5, h4), this.Vl(h4, s5)), s5 = this.lk(t5), this.Je(s5) == t5 && (h4 != t5 ? this.on(s5, h4) : this.on(s5, -1)), h4 = this.lk(n5), this.Je(h4) == n5 && (i6 != n5 ? this.on(h4, i6) : this.on(h4, -1)), this.Lc.kd(t5), this.Lc.kd(n5);
        }, i5.prototype.JF = function(t5, i6) {
          for (; ; ) {
            if ((i6 = t5.xe(i6)) == -1)
              return -1;
            var s5 = t5.ka(i6);
            if (this.$e(s5) != this.$e(this.ya(s5)))
              return s5;
          }
        }, i5.prototype.fr = function(t5, i6) {
          var s5;
          s5 === void 0 && (s5 = true), this.HB(t5, 0, null, i6, s5);
        }, i5.prototype.qJ = function(i6, s5, n5) {
          var h4 = new t4.ja(0);
          h4.add(s5), this.HB(i6, 4, h4, n5, i6.jc(s5) == 1736);
        }, i5.prototype.rJ = function(i6, s5, n5) {
          var h4 = new t4.ja(0);
          h4.add(s5), this.HB(i6, 5, h4, n5, true);
        }, i5.prototype.Wg = function() {
          this.g != null && (this.Dq != -1 && (this.g.sW(this.Dq), this.Dq = -1), this.Em != -1 && (this.g.Ud(this.Em), this.Em = -1), this.Eq != -1 && (this.g.Ud(this.Eq), this.Eq = -1), this.be != -1 && (this.Lg(this.be), this.be = -1), this.eg != -1 && (this.Lg(this.eg), this.eg = -1), this.yg != -1 && (this.Lg(this.yg), this.yg = -1), this.g = null, this.he.oj(true), this.lh.oj(true), this.Qs = this.Oe = -1, this.Lc != null && this.Lc.oj(true), this.Ii != null && (this.Ii.length = 0), this.Fi != null && (this.Fi.length = 0), this.cH != null && (this.cH.length = 0), this.ze != null && this.ze.oj(true), this.Jl = -1, this.$n = null);
        }, i5.prototype.Je = function(t5) {
          return this.he.U(t5, 2);
        }, i5.prototype.D = function(t5, i6) {
          this.g.ZF(this.$Q(t5), i6);
        }, i5.prototype.yd = function(t5) {
          return this.he.U(t5, 1);
        }, i5.prototype.Tf = function(t5) {
          return this.he.U(t5, 4);
        }, i5.prototype.Yy = function(t5) {
          return this.he.U(t5, 6);
        }, i5.prototype.mm = function(t5) {
          return this.he.U(t5, 7);
        }, i5.prototype.ls = function(t5) {
          return this.lh.U(t5, 1);
        }, i5.prototype.vj = function(t5) {
          return this.lh.U(t5, 0);
        }, i5.prototype.og = function(t5, i6) {
          return (i6 = this.Fi[i6]).size <= t5 ? -1 : i6.read(t5);
        }, i5.prototype.pn = function(t5, i6, s5) {
          (i6 = this.Fi[i6]).size <= t5 && i6.resize(this.he.size, -1), i6.write(t5, s5);
        }, i5.prototype.Fp = function() {
          this.Fi == null && (this.Fi = []);
          for (var i6 = t4.ja.rf(this.he.Jg, -1), s5 = 0, n5 = this.Fi.length; s5 < n5; s5++)
            if (this.Fi[s5] == null)
              return this.Fi[s5] = i6, s5;
          return this.Fi.push(i6), this.Fi.length - 1;
        }, i5.prototype.Gp = function(t5) {
          this.Fi[t5] = null;
        }, i5.prototype.lk = function(t5) {
          return this.Lc.U(t5, 1);
        }, i5.prototype.vf = function(t5) {
          return this.lk(this.ya(t5));
        }, i5.prototype.ya = function(t5) {
          return this.Lc.U(t5, 4);
        }, i5.prototype.ue = function(t5) {
          return this.Lc.U(t5, 5);
        }, i5.prototype.kc = function(t5) {
          return this.Lc.U(t5, 6);
        }, i5.prototype.$e = function(t5) {
          return this.Lc.U(t5, 2);
        }, i5.prototype.af = function(t5) {
          return this.jk(this.Lc.U(t5, 2));
        }, i5.prototype.om = function(t5) {
          return this.Lc.U(t5, 7);
        }, i5.prototype.$r = function(t5, i6) {
          this.D(this.lk(t5), i6);
        }, i5.prototype.nm = function(t5, i6) {
          this.D(this.vf(t5), i6);
        }, i5.prototype.fh = function(t5) {
          return this.Lc.U(t5, 3) & this.XN;
        }, i5.prototype.Bb = function(t5, i6) {
          return (i6 = this.Ii[i6]).size <= t5 ? -1 : i6.read(t5);
        }, i5.prototype.Kb = function(t5, i6, s5) {
          (i6 = this.Ii[i6]).size <= t5 && i6.resize(this.Lc.size, -1), i6.write(t5, s5);
        }, i5.prototype.bh = function() {
          this.Ii == null && (this.Ii = []);
          for (var i6 = t4.ja.rf(this.Lc.Jg, -1), s5 = 0, n5 = this.Ii.length; s5 < n5; s5++)
            if (this.Ii[s5] == null)
              return this.Ii[s5] = i6, s5;
          return this.Ii.push(i6), this.Ii.length - 1;
        }, i5.prototype.Lg = function(t5) {
          this.Ii[t5] = null;
        }, i5.prototype.DP = function(t5) {
          var i6 = this.$e(t5), s5 = this.ya(t5), n5 = this.kc(t5);
          n5 == s5 && ((n5 = this.kc(n5)) == t5 && (n5 = -1));
          var h4 = this.vF(i6);
          h4 !== t5 && h4 != s5 || this.Et(i6, n5), s5 = this.$n.read(i6), isNaN(s5) || (this.vJ(i6, NaN), this.xJ(i6, NaN)), this.xx(t5, true), this.Gy(t5);
        }, i5.prototype.EP = function(t5) {
          for (var i6 = 0, s5 = t5.size; i6 < s5; i6++) {
            var n5 = t5.get(i6), h4 = this.$e(this.ya(n5));
            this.Et(this.$e(n5), -1), this.Et(h4, -1), this.xx(n5, true), this.Gy(n5);
          }
        }, i5.prototype.vF = function(t5) {
          return this.ze.U(t5, 1);
        }, i5.prototype.jk = function(t5) {
          return this.ze.U(t5, 2);
        }, i5.prototype.In = function(t5) {
          return this.ze.U(t5, 3);
        }, i5.prototype.ZQ = function(t5) {
          return this.ze.U(t5, 4);
        }, i5.prototype.Mp = function(t5) {
          var i6 = this.$n.read(t5);
          return isNaN(i6) && (this.gY(t5), i6 = this.$n.read(t5)), i6;
        }, i5.prototype.Ma = function(t5) {
          return this.g.FF(t5, this.Dq);
        }, i5.prototype.Ie = function(t5) {
          return this.g.Qa(t5, this.Em);
        }, i5.prototype.oR = function(t5) {
          return this.g.Qa(t5, this.Eq);
        }, i5.prototype.nR = function(t5, i6) {
          var s5 = this.Je(t5);
          if (s5 == -1)
            return -1;
          var n5 = s5, h4 = -1, r3 = -1;
          do {
            if (this.vf(n5) == i6)
              return n5;
            if (h4 == -1) {
              if ((h4 = this.Je(i6)) == -1)
                break;
              r3 = h4;
            }
            if (this.vf(r3) == t5)
              return this.ya(r3);
            n5 = this.kc(this.ya(n5)), r3 = this.kc(this.ya(r3));
          } while (n5 != s5 && r3 != h4);
          return -1;
        }, i5.prototype.kB = function(i6, s5) {
          s5.Qr(), s5 = s5.get();
          var n5 = new t4.h();
          this.$r(i6, n5), s5.Ec(n5), this.nm(i6, n5), s5.Rc(n5);
        }, i5.prototype.CO = function(i6, s5) {
          if (i6 == s5)
            return 0;
          var n5 = new t4.h();
          this.nm(i6, n5);
          var h4 = new t4.h();
          return this.nm(s5, h4), n5.rb(h4) ? 0 : (s5 = new t4.h(), this.$r(i6, s5), (i6 = new t4.h()).vc(n5, s5), (n5 = new t4.h()).vc(h4, s5), t4.h.pu(i6, n5));
        }, i5.prototype.BO = function(i6, s5) {
          if (i6 == s5)
            return 0;
          var n5 = new t4.h();
          this.nm(i6, n5);
          var h4 = new t4.h();
          return this.nm(s5, h4), n5.rb(h4) ? 0 : (s5 = new t4.h(), this.$r(i6, s5), (i6 = new t4.h()).vc(n5, s5), (n5 = new t4.h()).vc(h4, s5), 0 <= n5.y && 0 < i6.y ? t4.h.pu(i6, n5) : 0);
        }, i5.prototype.sO = function() {
          for (var i6 = t4.mc.ox(this.gA), s5 = new t4.h(), n5 = new t4.h(), h4 = new t4.h(), r3 = new t4.h(), e3 = new t4.h(), o3 = this.Oe; o3 != -1; o3 = this.Tf(o3)) {
            var a3 = this.Je(o3);
            if (a3 != -1) {
              var u3 = a3;
              this.$r(u3, s5), this.nm(u3, n5), e3.vc(n5, s5);
              var f3 = e3.Uk();
              do {
                var c3 = u3;
                if ((u3 = this.kc(this.ya(u3))) != c3) {
                  this.nm(u3, h4), r3.vc(h4, s5), c3 = r3.Uk();
                  var l3 = r3.yi(e3);
                  if (l3 * l3 / (c3 * f3) * Math.min(c3, f3) <= i6)
                    return false;
                  e3.N(r3), f3 = c3, n5.N(h4);
                }
              } while (u3 != a3);
            }
          }
          return true;
        }, i5;
      }(), t4.ku = i4;
    }(Q2 || (Q2 = {})), function(t4) {
      var i4 = function() {
        function i5() {
          this.j = null, this.jH = new t4.h(), this.kH = new t4.h(), this.Ij = null, this.Ov = false, this.vl = -1;
        }
        return i5.prototype.cf = function(t5) {
          return t5 < this.Ij.length && this.Ij[t5];
        }, i5.prototype.fl = function(i6, s4, n4, h3) {
          var r3 = t4.ba.uf(this.j.g.jc(n4));
          if (t4.ba.uf(this.j.g.jc(s4)) != 2 || r3 != 1)
            throw t4.i.Ra();
          this.AP(i6, s4, n4, h3);
        }, i5.prototype.fr = function(i6, s4) {
          this.j == null && (this.j = new t4.ku()), this.j.fr(i6, s4);
        }, i5.prototype.Gt = function(i6, s4, n4) {
          for (t4.Vk.W(i6, s4, n4, true), s4 = i6.md; s4 != -1; s4 = i6.ve(s4))
            i6.jc(s4) == 1736 && t4.tn.W(i6, s4, -1, this.Ov, n4);
          this.fr(i6, n4);
        }, i5.prototype.HE = function(t5, i6, s4, n4, h3) {
          var r3 = this.j.g;
          if (r3.jc(t5) == 1736)
            for (t5 = r3.Ob(t5); t5 != -1; t5 = r3.Sb(t5)) {
              var e3 = r3.Ya(t5);
              this.j.Ie(e3), this.j.Ie(r3.V(e3));
              var o3 = this.j.oR(e3);
              if (o3 != -1) {
                var a3 = this.j.Bb(o3, s4);
                if (a3 != 1 && a3 != 2)
                  if (this.cf(this.j.af(o3))) {
                    this.j.Kb(o3, s4, 1), a3 = r3.wf(i6, -1);
                    var u3 = o3, f3 = this.j.Ie(e3), c3 = 1;
                    do {
                      var l3 = this.um(e3, h3);
                      r3.kj(a3, l3), n4 != -1 && this.j.pn(f3, n4, 1), this.j.Kb(u3, s4, 1), u3 = this.j.kc(u3);
                      do {
                        var p3 = (l3 = c3 == 1 ? r3.V(e3) : r3.Na(e3)) != -1 ? this.j.Ie(l3) : -1;
                      } while (p3 == f3);
                      var v3 = this.j.lk(u3);
                      if (v3 != p3) {
                        do {
                          p3 = (l3 = c3 == 1 ? r3.Na(e3) : r3.V(e3)) != -1 ? this.j.Ie(l3) : -1;
                        } while (p3 == f3);
                        v3 != p3 ? (p3 = v3, l3 = this.j.vj(this.j.mm(p3))) : c3 = -c3;
                      }
                      f3 = p3, e3 = l3;
                    } while (u3 != o3);
                    r3.mn(a3, true);
                  } else
                    this.j.Kb(o3, s4, 2);
              }
            }
        }, i5.prototype.$E = function() {
          for (var i6 = this.j.bh(), s4 = new t4.ja(0), n4 = this.j.Oe; n4 != -1; n4 = this.j.Tf(n4)) {
            var h3 = this.j.Je(n4), r3 = h3;
            if (h3 != -1)
              do {
                if (this.j.Bb(r3, i6) != 1) {
                  var e3 = this.j.ya(r3);
                  this.j.Kb(e3, i6, 1), this.j.Kb(r3, i6, 1), this.cf(this.j.af(r3)) && this.cf(this.j.af(e3)) && s4.add(r3);
                }
                r3 = this.j.kc(this.j.ya(r3));
              } while (r3 != h3);
          }
          this.j.Lg(i6), this.j.EP(s4);
        }, i5.prototype.um = function(t5, i6) {
          return i6 == -1 ? t5 : this.WR(t5, i6);
        }, i5.prototype.WR = function(t5, i6) {
          var s4 = this.j.g, n4 = this.j.mm(this.j.Ie(t5));
          do {
            var h3 = this.j.vj(n4);
            if (s4.Sf(s4.cd(h3)) == i6)
              return h3;
            n4 = this.j.ls(n4);
          } while (n4 != -1);
          return t5;
        }, i5.prototype.Qt = function(i6, s4, n4) {
          this.$E();
          var h3 = this.j.g, r3 = h3.Kg(1736), e3 = this.j.bh();
          return this.pK(i6, s4, r3, n4, e3, -1), this.j.Lg(e3), t4.tn.W(h3, r3, 1, this.Ov, null), r3;
        }, i5.prototype.pK = function(t5, i6, s4, n4, h3, r3) {
          for (this.HE(t5, s4, h3, r3, n4), i6 != -1 && this.HE(i6, s4, h3, r3, n4), t5 = this.j.g, i6 = this.j.Oe; i6 != -1; i6 = this.j.Tf(i6)) {
            var e3 = this.j.Je(i6);
            if (e3 != -1) {
              var o3 = e3;
              do {
                var a3 = this.j.Bb(o3, h3);
                if (a3 != 1 && a3 != 2)
                  if (this.cf(this.j.af(o3))) {
                    a3 = t5.wf(s4, -1);
                    var u3 = o3;
                    do {
                      var f3 = this.j.om(u3);
                      f3 != -1 ? f3 = this.j.vj(f3) : (f3 = this.j.vj(this.j.om(this.j.ya(u3))), f3 = this.j.g.V(f3)), f3 = this.um(f3, n4), t5.kj(a3, f3), this.j.Kb(u3, h3, 1), r3 != -1 && (f3 = this.j.Ie(f3), this.j.pn(f3, r3, 1)), u3 = this.j.kc(u3);
                    } while (u3 != o3);
                    t5.mn(a3, true);
                  } else
                    this.j.Kb(o3, h3, 2);
                o3 = this.j.kc(this.j.ya(o3));
              } while (o3 != e3);
            }
          }
        }, i5.prototype.XX = function(i6, s4, n4) {
          var h3 = this.j.g, r3 = h3.Kg(1736), e3 = h3.Kg(1607), o3 = h3.Kg(550);
          this.$E();
          var a3 = -1, u3 = this.j.bh(), f3 = this.j.Fp();
          for (this.pK(i6, s4, r3, n4, u3, f3), i6 = this.j.Oe; i6 != -1; i6 = this.j.Tf(i6))
            if ((s4 = this.j.Je(i6)) != -1) {
              var c3 = s4;
              do {
                var l3 = this.j.Bb(c3, u3), p3 = this.j.Bb(this.j.ya(c3), u3);
                if ((l3 |= p3) == 2)
                  if (l3 = this.j.fh(c3), this.cf(l3)) {
                    var v3 = h3.wf(e3, -1), y3 = c3;
                    l3 = this.$w(i6, h3), l3 = this.um(l3, n4), h3.kj(v3, l3), this.j.pn(i6, f3, 1);
                    do {
                      if (l3 = this.j.vf(y3), p3 = this.$w(l3, h3), p3 = this.um(p3, n4), h3.kj(v3, p3), this.j.Kb(y3, u3, 1), this.j.Kb(this.j.ya(y3), u3, 1), this.j.pn(l3, f3, 1), y3 = this.j.kc(y3), l3 = this.j.Bb(y3, u3), (l3 |= p3 = this.j.Bb(this.j.ya(y3), u3)) != 2)
                        break;
                      if (l3 = this.j.fh(y3), !this.cf(l3)) {
                        this.j.Kb(y3, u3, 1), this.j.Kb(this.j.ya(y3), u3, 1);
                        break;
                      }
                    } while (y3 != c3);
                  } else
                    this.j.Kb(c3, u3, 1), this.j.Kb(this.j.ya(c3), u3, 1);
                c3 = this.j.kc(this.j.ya(c3));
              } while (c3 != s4);
            }
          for (i6 = this.j.Oe; i6 != -1; i6 = this.j.Tf(i6))
            (l3 = this.j.og(i6, f3)) != 1 && (l3 = this.j.yd(i6), this.cf(l3) && (a3 == -1 && (a3 = h3.wf(o3, -1)), (s4 = this.j.mm(i6)) != -1 && (s4 = this.j.vj(s4), l3 = this.um(s4, n4), h3.kj(a3, l3))));
          return this.j.Gp(f3), this.j.Lg(u3), t4.tn.W(h3, r3, 1, this.Ov, null), (n4 = [])[0] = o3, n4[1] = e3, n4[2] = r3, n4;
        }, i5.prototype.$w = function(t5, i6) {
          var s4 = -1;
          for (t5 = this.j.mm(t5); t5 != -1; t5 = this.j.ls(t5)) {
            var n4 = this.j.vj(t5);
            s4 == -1 && (s4 = n4);
            var h3 = this.j.Ma(i6.Sf(i6.cd(n4)));
            if (this.cf(h3)) {
              s4 = n4;
              break;
            }
          }
          return s4;
        }, i5.prototype.gB = function(i6, s4) {
          for (var n4 = this.ll(s4), h3 = this.j.lk(s4), r3 = this.j.vf(s4), e3 = 0, o3 = 0, a3 = this.j.mm(h3); a3 != -1; a3 = this.j.ls(a3)) {
            var u3 = this.j.vj(a3), f3 = i6.cd(u3), c3 = this.j.Ma(i6.Sf(f3));
            f3 = i6.Ya(f3), (c3 = (c3 & n4) != 0) && f3 == u3 && (this.vl = s4);
            var l3 = i6.V(u3);
            l3 != -1 && this.j.Ie(l3) == r3 ? (e3++, c3 && (this.vl === -1 && f3 == l3 && (u3 = this.j.kc(s4), this.cf(this.ll(u3)) && (this.vl = u3)), o3++)) : (u3 = i6.Na(u3)) != -1 && this.j.Ie(u3) == r3 && (e3--, c3 && (this.vl === -1 && f3 === u3 && (u3 = this.j.kc(s4), this.cf(this.ll(u3)) && (this.vl = u3)), o3--));
          }
          return this.j.D(h3, this.jH), this.j.D(r3, this.kH), (o3 != 0 ? o3 : e3) * (i6 = t4.h.ub(this.jH, this.kH));
        }, i5.prototype.ll = function(t5) {
          return this.j.fh(t5) | this.j.af(t5) | this.j.af(this.j.ya(t5));
        }, i5.prototype.sK = function(t5) {
          for (var i6 = this.j.ya(this.j.ue(t5)), s4 = -1; i6 != t5; ) {
            if (this.cf(this.ll(i6))) {
              if (s4 != -1)
                return -1;
              s4 = i6;
            }
            i6 = this.j.ya(this.j.ue(i6));
          }
          return s4 != -1 ? this.j.ya(s4) : -1;
        }, i5.prototype.tK = function(t5) {
          for (var i6 = this.j.ya(this.j.kc(t5)), s4 = -1; i6 != t5; ) {
            if (this.cf(this.ll(i6))) {
              if (s4 != -1)
                return -1;
              s4 = i6;
            }
            i6 = this.j.ya(this.j.kc(i6));
          }
          return s4 != -1 ? this.j.ya(s4) : -1;
        }, i5.prototype.hJ = function(i6, s4, n4, h3, r3) {
          var e3 = this.j.g, o3 = i6, a3 = this.j.ya(o3);
          this.j.Kb(o3, n4, 1), this.j.Kb(a3, n4, 1), this.vl = -1;
          for (var u3 = this.gB(e3, o3), f3 = o3, c3 = -1, l3 = false, p3 = 1; ; ) {
            var v3 = this.j.ue(o3);
            if (v3 == a3)
              break;
            if (a3 = this.j.kc(a3), this.j.ya(v3) != a3) {
              if ((o3 = this.sK(o3)) == -1) {
                l3 = true;
                break;
              }
              a3 = this.j.ya(o3);
            } else
              o3 = v3;
            if (o3 == i6) {
              c3 = i6;
              break;
            }
            if (v3 = this.ll(o3), !this.cf(v3))
              break;
            this.j.Kb(o3, n4, 1), this.j.Kb(a3, n4, 1), f3 = o3, u3 += this.gB(e3, o3), p3++;
          }
          if (c3 == -1)
            for (o3 = i6, a3 = this.j.ya(o3), c3 = o3; (i6 = this.j.kc(o3)) != a3; ) {
              if (a3 = this.j.ue(a3), this.j.ya(i6) != a3) {
                if ((o3 = this.tK(o3)) == -1) {
                  l3 = true;
                  break;
                }
                a3 = this.j.ya(o3);
              } else
                o3 = i6;
              if (v3 = this.ll(o3), !this.cf(v3))
                break;
              this.j.Kb(o3, n4, 1), this.j.Kb(a3, n4, 1), c3 = o3, u3 += this.gB(e3, o3), p3++;
            }
          else if (this.vl != -1 && (f3 = this.vl, c3 = this.j.ue(this.vl), this.j.ya(c3) != this.j.kc(this.j.ya(f3)) && (c3 = this.sK(f3)) == -1))
            throw t4.i.Ra();
          for (0 <= u3 || (o3 = c3, c3 = this.j.ya(f3), f3 = this.j.ya(o3)), n4 = e3.wf(s4, -1), o3 = f3, f3 = this.j.lk(f3), l3 = this.j.vf(c3) == f3 && l3, u3 = this.$w(f3, e3), u3 = this.um(u3, r3), e3.kj(n4, u3), h3 != -1 && this.j.pn(f3, h3, 1), f3 = 0, p3 = l3 ? t4.P.truncate((p3 + 1) / 2) : -1; i6 = this.j.vf(o3), u3 = this.$w(i6, e3), u3 = this.um(u3, r3), e3.kj(n4, u3), f3++, h3 != -1 && this.j.pn(i6, h3, 1), l3 && f3 == p3 && (n4 = e3.wf(s4, -1), e3.kj(n4, u3)), o3 != c3; )
            if (i6 = this.j.kc(o3), this.j.ue(this.j.ya(o3)) != this.j.ya(i6)) {
              if ((o3 = this.tK(o3)) == -1)
                throw t4.i.Ra();
            } else
              o3 = i6;
        }, i5.prototype.Rt = function(t5) {
          for (var i6 = this.j.g.Kg(1607), s4 = this.j.bh(), n4 = this.j.Oe; n4 != -1; n4 = this.j.Tf(n4)) {
            var h3 = this.j.Je(n4), r3 = h3;
            do {
              this.j.Bb(r3, s4) != 1 && this.cf(this.ll(r3)) && this.hJ(r3, i6, s4, -1, t5), r3 = this.j.kc(this.j.ya(r3));
            } while (r3 != h3);
          }
          return this.j.Lg(s4), i6;
        }, i5.prototype.YX = function(t5) {
          for (var i6 = this.j.g, s4 = i6.Kg(1607), n4 = i6.Kg(550), h3 = this.j.bh(), r3 = this.j.Fp(), e3 = -1, o3 = this.j.Oe; o3 != -1; o3 = this.j.Tf(o3)) {
            var a3 = this.j.Je(o3), u3 = a3;
            do {
              var f3 = this.j.Bb(u3, h3);
              f3 != 1 && (f3 = this.ll(u3), this.cf(f3) && this.hJ(u3, s4, h3, r3, t5)), u3 = this.j.kc(this.j.ya(u3));
            } while (u3 != a3);
          }
          for (o3 = this.j.Oe; o3 != -1; o3 = this.j.Tf(o3))
            (f3 = this.j.og(o3, r3)) != 1 && (f3 = this.j.yd(o3), this.cf(f3) && (e3 == -1 && (e3 = i6.wf(n4, -1)), (a3 = this.j.mm(o3)) != -1 && (a3 = this.j.vj(a3), a3 = this.um(a3, t5), i6.kj(e3, a3))));
          return this.j.Lg(h3), this.j.Gp(r3), (t5 = [])[0] = n4, t5[1] = s4, t5;
        }, i5.prototype.pr = function() {
          for (var t5 = this.j.g, i6 = t5.Kg(550), s4 = t5.wf(i6, -1), n4 = this.j.Oe; n4 != -1; n4 = this.j.Tf(n4))
            if (this.cf(this.j.yd(n4))) {
              for (var h3 = -1, r3 = this.j.mm(n4); r3 != -1; r3 = this.j.ls(r3)) {
                var e3 = this.j.vj(r3);
                h3 == -1 && (h3 = e3);
                var o3 = this.j.Ma(t5.Sf(t5.cd(e3)));
                if (this.cf(o3)) {
                  h3 = e3;
                  break;
                }
              }
              t5.kj(s4, h3);
            }
          return i6;
        }, i5.prototype.eq = function(t5) {
          this.Ij = [];
          for (var i6 = 0; i6 < t5; i6++)
            this.Ij[i6] = false;
        }, i5.WV = function(i6, s4, n4) {
          var h3 = i6.Ja(), r3 = Array(1e3);
          t4.P.bv(r3, null);
          var e3 = t4.P.mg(1e3, 0), o3 = i6.I(), a3 = true, u3 = s4.Eb() == 2;
          if (s4.Eb() != 1 && s4.Eb() != 2)
            throw t4.i.Ra();
          for (var f3 = 0; f3 < o3; ) {
            var c3 = t4.P.truncate(i6.gW(r3, f3) - f3);
            u3 ? t4.jd.nK(s4, r3, c3, n4, e3) : t4.jd.oK(s4, r3, c3, n4, e3);
            for (var l3 = 0, p3 = 0; p3 < c3; p3++)
              e3[p3] == 0 && (a3 && (a3 = false, h3.Gd(i6, 0, f3)), l3 != p3 && h3.Gd(i6, f3 + l3, f3 + p3), l3 = p3 + 1);
            a3 || l3 == c3 || h3.Gd(i6, f3 + l3, f3 + c3), f3 += c3;
          }
          return a3 ? i6 : h3;
        }, i5.uG = function(s4, n4, h3) {
          return s4 instanceof t4.ee ? i5.WV(s4, n4, h3) : n4 instanceof t4.Ta ? s4.B() || n4.B() ? s4.Ja() : t4.Vk.uU(h3, s4, n4) ? t4.Vk.xO(s4, n4) : s4.Ja() : i5.XV(s4, n4, h3);
        }, i5.Cv = function(s4, n4, h3, r3) {
          var e3 = new t4.l();
          s4.A(e3);
          var o3 = new t4.l();
          n4.A(o3);
          var a3 = new t4.l();
          if (a3.L(e3), a3.$b(o3), h3 = t4.ua.Xd(h3, a3, true), (a3 = new t4.l()).L(o3), o3 = t4.ua.Gr(h3), a3.X(o3, o3), !e3.isIntersecting(a3)) {
            if (s4.Eb() <= n4.Eb())
              return i5.mi(i5.Ue(s4.Ja()), s4, "&");
            if (s4.Eb() > n4.Eb())
              return i5.mi(i5.Ue(n4.Ja()), s4, "&");
          }
          return o3 = new i5(), a3 = (e3 = new t4.hd()).Ib(i5.Ue(s4)), n4 = e3.Ib(i5.Ue(n4)), o3.Gt(e3, h3, r3), r3 = o3.Cv(a3, n4), s4 = i5.mi(e3.Ke(r3), s4, "&"), t4.ba.Ic(s4.K()) && (s4.Eh(2, h3), s4.K() == 1736 && s4.hm()), s4;
        }, i5.XV = function(i6, s4, n4) {
          if (i6.B() || s4.B())
            return i6.Ja();
          var h3 = [null], r3 = [0], e3 = s4.Eb() == 2;
          if (s4.Eb() != 1 && s4.Eb() != 2)
            throw t4.i.Ra();
          return h3[0] = i6.D(), e3 ? t4.jd.nK(s4, h3, 1, n4, r3) : t4.jd.oK(s4, h3, 1, n4, r3), r3[0] == 0 ? i6.Ja() : i6;
        }, i5.prototype.GU = function(i6, s4, n4, h3, r3) {
          if (i6.B())
            return i6;
          var e3 = new t4.hd();
          return i6 = e3.Ib(i6), this.Ok(e3, i6, s4, n4, h3, r3);
        }, i5.prototype.IU = function(i6, s4, n4, h3, r3, e3) {
          if (r3 && i6.jc(s4) != 550) {
            var o3 = new t4.MC();
            o3.PX(i6, n4), o3.Pg ? (t4.Vk.W(i6, n4, e3, true), r3 = false) : this.j.ty(n4);
          } else
            t4.Vk.W(i6, n4, e3, true), r3 = false;
          if (h3 && i6.jc(s4) != 550 ? this.j.rJ(i6, s4, e3) : this.j.qJ(i6, s4, e3), this.j.kA)
            return this.j.Wg(), this.j = null, this.Ok(i6, s4, n4, h3, false, e3);
          if (this.j.ty(NaN), e3 = this.j.Ma(s4), this.eq(e3 + 1), this.Ij[e3] = true, i6.jc(s4) == 1736 || h3 && i6.jc(s4) != 550)
            return i6.$o(s4, 0), s4 = this.Qt(s4, -1, -1), (i6 = i6.Ke(s4)).$o(0), r3 ? i6.Eh(1, 0) : (i6.Eh(2, n4), i6.hm()), i6;
          if (i6.jc(s4) == 1607)
            return s4 = this.Rt(-1), i6 = i6.Ke(s4), r3 || i6.Eh(2, n4), i6;
          if (i6.jc(s4) == 550)
            return s4 = this.pr(), i6 = i6.Ke(s4), r3 || i6.Eh(2, n4), i6;
          throw t4.i.Ra();
        }, i5.prototype.Ok = function(i6, s4, n4, h3, r3, e3) {
          this.j = new t4.ku();
          try {
            return this.IU(i6, s4, n4, h3, r3, e3);
          } finally {
            this.j.Wg();
          }
        }, i5.Ok = function(t5, s4, n4, h3, r3) {
          return new i5().GU(t5, s4, n4, h3, r3);
        }, i5.prototype.HU = function(i6, s4, n4, h3) {
          this.Ov = i6, this.j = new t4.ku(), i6 = s4.Kn(n4);
          var r3 = s4.jc(n4);
          if (i6 != 1 || r3 == 550 ? this.j.qJ(s4, n4, h3) : this.j.rJ(s4, n4, h3), !this.j.kA)
            if (this.j.ty(NaN), h3 = this.j.Ma(n4), this.eq(h3 + 1), this.Ij[h3] = true, s4.jc(n4) == 1736 || i6 == 1 && s4.jc(n4) != 550)
              s4.$o(n4, 0), h3 = this.Qt(n4, -1, -1), s4.cC(h3, n4), s4.wB(h3);
            else if (s4.jc(n4) == 1607)
              h3 = this.Rt(-1), s4.cC(h3, n4), s4.wB(h3);
            else {
              if (s4.jc(n4) != 550)
                throw t4.i.ga("internal error");
              h3 = this.pr(), s4.cC(h3, n4), s4.wB(h3);
            }
        }, i5.prototype.km = function(i6, s4) {
          var n4 = t4.ba.uf(this.j.g.jc(i6)), h3 = t4.ba.uf(this.j.g.jc(s4));
          if (n4 > h3)
            return i6;
          var r3 = this.j.Ma(i6), e3 = this.j.Ma(s4);
          if (this.eq(1 + (r3 | e3)), this.Ij[this.j.Ma(i6)] = true, n4 == 2 && h3 == 2)
            return this.Qt(i6, s4, -1);
          if (n4 == 1 && h3 == 2 || n4 == 1 && h3 == 1)
            return this.Rt(-1);
          if (n4 == 0)
            return this.pr();
          throw t4.i.Ra();
        }, i5.prototype.Cv = function(i6, s4) {
          var n4 = t4.ba.uf(this.j.g.jc(i6)), h3 = t4.ba.uf(this.j.g.jc(s4)), r3 = this.j.Ma(i6), e3 = this.j.Ma(s4);
          if (this.eq(1 + (r3 | e3)), this.Ij[this.j.Ma(i6) | this.j.Ma(s4)] = true, r3 = -1, 1 < this.j.g.it.Ba && (r3 = i6), n4 == 2 && h3 == 2)
            return this.Qt(i6, s4, r3);
          if (n4 == 1 && 0 < h3 || h3 == 1 && 0 < n4)
            return this.Rt(r3);
          if (n4 == 0 || h3 == 0)
            return this.pr();
          throw t4.i.Ra();
        }, i5.prototype.Kz = function(i6, s4) {
          var n4 = t4.ba.uf(this.j.g.jc(i6)), h3 = t4.ba.uf(this.j.g.jc(s4)), r3 = this.j.Ma(i6), e3 = this.j.Ma(s4);
          if (this.eq(1 + (r3 | e3)), this.Ij[this.j.Ma(i6) | this.j.Ma(s4)] = true, r3 = -1, 1 < this.j.g.it.Ba && (r3 = i6), n4 == 2 && h3 == 2)
            return this.XX(i6, s4, r3);
          if (n4 == 1 && 0 < h3 || h3 == 1 && 0 < n4)
            return this.YX(r3);
          if (n4 == 0 || h3 == 0)
            return (i6 = [])[0] = this.pr(), i6;
          throw t4.i.Ra();
        }, i5.prototype.gp = function(i6, s4) {
          var n4 = t4.ba.uf(this.j.g.jc(i6)), h3 = t4.ba.uf(this.j.g.jc(s4)), r3 = this.j.Ma(i6), e3 = this.j.Ma(s4);
          if (this.eq(1 + (r3 | e3)), this.Ij[this.j.Ma(i6)] = true, this.Ij[this.j.Ma(s4)] = true, n4 == 2 && h3 == 2)
            return this.Qt(i6, s4, -1);
          if (n4 == 1 && h3 == 1)
            return this.Rt(-1);
          if (n4 == 0 && h3 == 0)
            return this.pr();
          throw t4.i.Ra();
        }, i5.Ue = function(i6) {
          var s4 = i6.K();
          return s4 == 197 ? (s4 = new t4.Ea(i6.description), i6.B() || s4.bd(i6, false), s4) : s4 == 33 ? (s4 = new t4.ee(i6.description), i6.B() || s4.add(i6), s4) : s4 == 322 ? (s4 = new t4.Ua(i6.description), i6.B() || s4.pc(i6, true), s4) : i6;
        }, i5.mi = function(i6, s4, n4) {
          var h3 = i6.K();
          return h3 == 197 ? (s4 = new t4.Ea(i6.description), i6.B() || s4.bd(i6, false), s4) : h3 != 33 || n4 != "|" && n4 != "^" ? h3 == 322 ? (s4 = new t4.Ua(i6.description), i6.B() || s4.pc(i6, true), s4) : h3 == 33 && n4 == "-" && s4.K() == 33 || h3 == 550 && n4 == "&" && s4.K() == 33 ? (s4 = new t4.Ta(i6.description), i6.B() || i6.we(0, s4), s4) : i6 : (s4 = new t4.ee(i6.description), i6.B() || s4.add(i6), s4);
        }, i5.km = function(s4, n4, h3, r3) {
          if (s4.B() || n4.B() || s4.Eb() > n4.Eb())
            return i5.mi(i5.Ue(s4), s4, "-");
          var e3 = new t4.l();
          s4.A(e3);
          var o3 = new t4.l();
          if (n4.A(o3), !e3.isIntersecting(o3))
            return i5.mi(i5.Ue(s4), s4, "-");
          var a3 = new t4.l();
          return a3.L(e3), a3.$b(o3), h3 = t4.ua.Xd(h3, a3, true), o3 = new i5(), a3 = (e3 = new t4.hd()).Ib(i5.Ue(s4)), n4 = e3.Ib(i5.Ue(n4)), o3.Gt(e3, h3, r3), r3 = o3.km(a3, n4), r3 = e3.Ke(r3), s4 = i5.mi(r3, s4, "-"), t4.ba.Ic(s4.K()) && (s4.Eh(2, h3), s4.K() == 1736 && s4.hm()), s4;
        }, i5.QP = function(s4, n4, h3) {
          if (2 > s4.length)
            throw t4.i.O("not enough geometries to dissolve");
          for (var r3 = 0, e3 = 0, o3 = s4.length; e3 < o3; e3++)
            r3 = Math.max(s4[e3].Eb(), r3);
          var a3 = new t4.l();
          a3.Pa();
          var u3 = new t4.hd(), f3 = -1, c3 = 0, l3 = -1;
          for (e3 = 0, o3 = s4.length; e3 < o3; e3++)
            if (s4[e3].Eb() == r3)
              if (s4[e3].B())
                l3 == -1 && (l3 = e3);
              else {
                l3 = e3, f3 == -1 ? f3 = u3.Ib(i5.Ue(s4[e3])) : u3.pN(f3, i5.Ue(s4[e3]));
                var p3 = new t4.l();
                s4[e3].yc(p3), a3.$b(p3), c3++;
              }
          return 2 > c3 ? i5.Ue(s4[l3]) : (s4 = r3 == 2, n4 = t4.ua.Xd(r3 == 0 ? n4 : null, a3, true), new i5().Ok(u3, f3, n4, s4, true, h3));
        }, i5.Kz = function(s4, n4, h3, r3) {
          var e3 = [null, null, null], o3 = new t4.l();
          s4.A(o3);
          var a3 = new t4.l();
          n4.A(a3);
          var u3 = new t4.l();
          if (u3.L(o3), u3.$b(a3), h3 = t4.ua.Xd(h3, u3, true), (u3 = new t4.l()).L(a3), a3 = t4.ua.Gr(h3), u3.X(a3, a3), !o3.isIntersecting(u3)) {
            if (s4.Eb() <= n4.Eb())
              return e3[(s4 = i5.mi(i5.Ue(s4.Ja()), s4, "&")).Eb()] = s4, e3;
            if (s4.Eb() > n4.Eb())
              return e3[(s4 = i5.mi(i5.Ue(n4.Ja()), s4, "&")).Eb()] = s4, e3;
          }
          for (a3 = new i5(), u3 = (o3 = new t4.hd()).Ib(i5.Ue(s4)), n4 = o3.Ib(i5.Ue(n4)), a3.Gt(o3, h3, r3), r3 = a3.Kz(u3, n4), n4 = 0; n4 < r3.length; n4++)
            a3 = i5.mi(o3.Ke(r3[n4]), s4, "&"), t4.ba.Ic(a3.K()) && (a3.Eh(2, h3), a3.K() == 1736 && a3.hm()), e3[a3.Eb()] = a3;
          return e3;
        }, i5.gp = function(s4, n4, h3, r3) {
          if (s4.Eb() > n4.Eb())
            return i5.mi(i5.Ue(s4), s4, "^");
          if (s4.Eb() < n4.Eb() || s4.B())
            return i5.mi(i5.Ue(n4), s4, "^");
          if (n4.B())
            return i5.mi(i5.Ue(s4), s4, "^");
          var e3 = new t4.l();
          s4.A(e3);
          var o3 = new t4.l();
          n4.A(o3);
          var a3 = new t4.l();
          return a3.L(e3), a3.$b(o3), h3 = t4.ua.Xd(h3, a3, true), o3 = new i5(), a3 = (e3 = new t4.hd()).Ib(i5.Ue(s4)), n4 = e3.Ib(i5.Ue(n4)), o3.Gt(e3, h3, r3), r3 = o3.gp(a3, n4), s4 = i5.mi(e3.Ke(r3), s4, "^"), t4.ba.Ic(s4.K()) && (s4.Eh(2, h3), s4.K() == 1736 && s4.hm()), s4;
        }, i5.prototype.GQ = function(t5, i6) {
          var s4 = this.j.g;
          t5 = s4.wf(t5, -1);
          for (var n4 = i6.size, h3 = 0; h3 < n4; h3++) {
            var r3 = i6.get(h3);
            s4.kj(t5, r3);
          }
          s4.mn(t5, true);
        }, i5.prototype.WW = function(t5, i6) {
          for (var s4 = this.j.g, n4 = s4.md; n4 != -1; n4 = s4.ve(n4))
            if (n4 == i6)
              for (var h3 = s4.Ob(n4); h3 != -1; h3 = s4.Sb(h3)) {
                var r3 = s4.Ya(h3);
                if (r3 != -1)
                  for (var e3 = s4.V(r3); e3 != -1; ) {
                    r3 = this.j.Ie(r3);
                    var o3 = this.j.Ie(e3);
                    (r3 = this.j.nR(r3, o3)) != -1 && (o3 = this.j.ya(r3), this.j.Kb(r3, t5, 1), this.j.Kb(o3, t5, 2)), r3 = e3, e3 = s4.V(r3);
                  }
              }
        }, i5.prototype.YV = function(i6, s4, n4, h3) {
          n4 = this.j.Ma(n4), h3 = this.j.Ma(h3);
          var r3 = new t4.ja(0);
          r3.Jb(256);
          for (var e3 = this.j.g, o3 = this.j.bh(), a3 = this.j.Oe; a3 != -1; a3 = this.j.Tf(a3)) {
            var u3 = this.j.Je(a3);
            if (u3 != -1) {
              var f3 = u3;
              do {
                if (this.j.Bb(f3, o3) != 1) {
                  var c3 = f3, l3 = f3, p3 = false, v3 = 0;
                  do {
                    if (this.j.Kb(c3, o3, 1), !p3) {
                      var y3 = this.j.fh(c3);
                      (y3 & h3) != 0 && (this.j.af(c3) & n4) != 0 && (l3 = c3, p3 = true);
                    }
                    p3 && (r3.add(this.j.vj(this.j.mm(this.j.lk(c3)))), i6 != -1 && (((y3 = this.j.fh(c3)) & h3) != 0 && (v3 |= y3 = this.j.Bb(c3, i6)))), c3 = this.j.kc(c3);
                  } while (c3 != l3);
                  p3 && 0 < this.j.Mp(this.j.$e(l3)) && (c3 = e3.Kg(1736), this.GQ(c3, r3), s4 != -1 && e3.CJ(c3, s4, v3)), r3.clear(false);
                }
                f3 = this.j.kc(this.j.ya(f3));
              } while (f3 != u3);
            }
          }
          this.j.Lg(o3);
        }, i5.prototype.AP = function(t5, i6, s4, n4) {
          this.j.tW();
          var h3 = -1;
          t5 != -1 && (h3 = this.j.bh(), this.WW(h3, s4)), this.YV(h3, t5, i6, s4), h3 != -1 && (this.j.Lg(h3), h3 = -1);
          var r3 = this.j.g;
          for (t5 = 0, h3 = r3.md; h3 != -1; h3 = r3.ve(h3))
            h3 != i6 && h3 != s4 && (n4.add(h3), t5++);
          n4.Wd(0, t5, function(t6, i7) {
            return (t6 = r3.qz(r3.Ob(t6))) < (i7 = r3.qz(r3.Ob(i7))) ? -1 : t6 == i7 ? 0 : 1;
          });
        }, i5.prototype.Wg = function() {
          this.j != null && (this.j.Wg(), this.j = null);
        }, i5;
      }();
      t4.Hg = i4;
    }(Q2 || (Q2 = {})), function(t4) {
      var i4 = function() {
        function i5(t5) {
          t5 !== void 0 ? this.Jt(t5) : this.MB();
        }
        return i5.prototype.lx = function() {
          this.Qb = this.Lb = this.qb = this.jb = this.bb = this.eb = 0;
        }, i5.prototype.Nb = function(t5) {
          return this == t5 || t5 instanceof i5 && (this.eb == t5.eb && this.jb == t5.jb && this.Lb == t5.Lb && this.qb == t5.qb && this.bb == t5.bb && this.Qb == t5.Qb);
        }, i5.prototype.dc = function() {
          return t4.P.wj(), t4.P.wj(), t4.P.wj(), t4.P.wj(), t4.P.wj(), t4.P.wj();
        }, i5.prototype.Gh = function(t5, i6) {
          var s4 = this.qb * t5.x + this.bb * t5.y + this.Qb;
          i6.x = this.eb * t5.x + this.jb * t5.y + this.Lb, i6.y = s4;
        }, i5.prototype.aY = function(i6, s4, n4) {
          for (var h3 = 0; h3 < s4; h3++) {
            var r3 = i6[h3].x, e3 = i6[h3].y, o3 = this.eb * r3 + this.jb * e3 + this.Lb;
            r3 = this.qb * r3 + this.bb * e3 + this.Qb, n4[h3] != null ? n4[h3].na(o3, r3) : n4[h3] = t4.h.construct(o3, r3);
          }
        }, i5.prototype.multiply = function(t5) {
          i5.multiply(this, t5, this);
        }, i5.multiply = function(t5, i6, s4) {
          var n4 = t5.eb * i6.eb + t5.qb * i6.jb, h3 = t5.jb * i6.eb + t5.bb * i6.jb, r3 = t5.Lb * i6.eb + t5.Qb * i6.jb + i6.Lb, e3 = t5.eb * i6.qb + t5.qb * i6.bb, o3 = t5.jb * i6.qb + t5.bb * i6.bb;
          t5 = t5.Lb * i6.qb + t5.Qb * i6.bb + i6.Qb, s4.eb = n4, s4.jb = h3, s4.Lb = r3, s4.qb = e3, s4.bb = o3, s4.Qb = t5;
        }, i5.prototype.Qf = function() {
          var t5 = new i5();
          return t5.eb = this.eb, t5.jb = this.jb, t5.Lb = this.Lb, t5.qb = this.qb, t5.bb = this.bb, t5.Qb = this.Qb, t5;
        }, i5.prototype.hC = function(i6) {
          if (!i6.B()) {
            for (var s4 = [], n4 = 0; 4 > n4; n4++)
              s4[n4] = new t4.h();
            i6.iB(s4), this.bY(s4, s4), i6.bx(s4, 4);
          }
        }, i5.prototype.bY = function(i6, s4) {
          for (var n4 = 0; n4 < i6.length; n4++) {
            var h3 = new t4.h(), r3 = i6[n4];
            h3.x = this.eb * r3.x + this.jb * r3.y + this.Lb, h3.y = this.qb * r3.x + this.bb * r3.y + this.Qb, s4[n4] = h3;
          }
        }, i5.prototype.kS = function(t5, i6) {
          t5.B() || i6.B() || t5.S() == 0 || t5.da() == 0 ? this.lx() : (this.jb = this.qb = 0, this.eb = i6.S() / t5.S(), this.bb = i6.da() / t5.da(), this.Lb = i6.v - t5.v * this.eb, this.Qb = i6.G - t5.G * this.bb);
        }, i5.prototype.$X = function(i6) {
          var s4 = new t4.h(), n4 = new t4.h();
          s4.na(this.eb, this.qb), n4.na(this.jb, this.bb), s4.sub(s4);
          var h3 = 0.5 * s4.Uk();
          return s4.na(this.eb, this.qb), n4.na(this.jb, this.bb), s4.add(n4), i6 * (h3 > (s4 = 0.5 * s4.Uk()) ? Math.sqrt(h3) : Math.sqrt(s4));
        }, i5.prototype.MB = function() {
          this.eb = 1, this.qb = this.Lb = this.jb = 0, this.bb = 1, this.Qb = 0;
        }, i5.prototype.isIdentity = function(i6) {
          if (i6 !== void 0) {
            var s4 = t4.h.construct(0, 1);
            return this.Gh(s4, s4), s4.sub(t4.h.construct(0, 1)), s4.Uk() > i6 * i6 ? false : (s4.na(0, 0), this.Gh(s4, s4), !(s4.Uk() > i6 * i6) && (s4.na(1, 0), this.Gh(s4, s4), s4.sub(t4.h.construct(1, 0)), s4.Uk() <= i6 * i6));
          }
          return this.eb == 1 && this.bb == 1 && this.jb == 0 && this.Lb == 0 && this.qb == 0 && this.Qb == 0;
        }, i5.prototype.Di = function(t5) {
          return Math.abs(this.eb * this.bb - this.qb * this.jb) <= 2 * t5 * (Math.abs(this.eb * this.bb) + Math.abs(this.qb * this.jb));
        }, i5.prototype.ig = function(t5, i6) {
          this.eb = 1, this.jb = 0, this.Lb = t5, this.qb = 0, this.bb = 1, this.Qb = i6;
        }, i5.prototype.Jt = function(t5, i6) {
          i6 !== void 0 ? (this.eb = t5, this.qb = this.Lb = this.jb = 0, this.bb = i6, this.Qb = 0) : this.Jt(t5, t5);
        }, i5.prototype.VB = function() {
          this.eb = 0, this.jb = 1, this.Lb = 0, this.qb = 1, this.Qb = this.bb = 0;
        }, i5.prototype.kX = function(t5) {
          this.lX(Math.cos(t5), Math.sin(t5));
        }, i5.prototype.lX = function(t5, i6) {
          this.eb = t5, this.jb = -i6, this.Lb = 0, this.qb = i6, this.bb = t5, this.Qb = 0;
        }, i5.prototype.shift = function(t5, i6) {
          this.Lb += t5, this.Qb += i6;
        }, i5.prototype.scale = function(t5, i6) {
          this.eb *= t5, this.jb *= t5, this.Lb *= t5, this.qb *= i6, this.bb *= i6, this.Qb *= i6;
        }, i5.prototype.flipX = function(t5, i6) {
          this.eb = -this.eb, this.jb = -this.jb, this.Lb = t5 + i6 - this.Lb;
        }, i5.prototype.flipY = function(t5, i6) {
          this.qb = -this.qb, this.bb = -this.bb, this.Qb = t5 + i6 - this.Qb;
        }, i5.prototype.rotate = function(t5) {
          var s4 = new i5();
          s4.kX(t5), this.multiply(s4);
        }, i5.prototype.inverse = function(t5) {
          if (t5 !== void 0) {
            var i6 = this.eb * this.bb - this.jb * this.qb;
            i6 == 0 ? t5.lx() : (i6 = 1 / i6, t5.Lb = (this.jb * this.Qb - this.Lb * this.bb) * i6, t5.Qb = (this.Lb * this.qb - this.eb * this.Qb) * i6, t5.eb = this.bb * i6, t5.jb = -this.jb * i6, t5.qb = -this.qb * i6, t5.bb = this.eb * i6);
          } else
            this.inverse(this);
        }, i5;
      }();
      t4.Ed = i4;
    }(Q2 || (Q2 = {})), function(t4) {
      var i4 = function() {
        function i5() {
        }
        return i5.prototype.lx = function() {
          this.Cg = this.Qb = this.Lb = this.Ze = this.We = this.Ve = this.Ye = this.bb = this.jb = this.pf = this.qb = this.eb = 0;
        }, i5.prototype.Jt = function(t5, i6) {
          this.eb = t5, this.jb = this.pf = this.qb = 0, this.bb = i6, this.We = this.Ve = this.Ye = 0, this.Ze = void 0, this.Cg = this.Qb = this.Lb = 0;
        }, i5.prototype.translate = function(t5, i6, s4) {
          this.Lb += t5, this.Qb += i6, this.Cg += s4;
        }, i5.prototype.hC = function(i6) {
          if (!i6.B()) {
            for (var s4 = new t4.Od[8](), n4 = 0; 8 > n4; n4++)
              s4[n4] = new t4.Od();
            i6.iB(s4), this.transform(s4, 8, s4), i6.bx(s4);
          }
        }, i5.prototype.transform = function(i6, s4, n4) {
          for (var h3 = 0; h3 < s4; h3++) {
            var r3 = new t4.Od(), e3 = i6[h3];
            r3.x = this.eb * e3.x + this.jb * e3.y + this.Ve * e3.z + this.Lb, r3.y = this.qb * e3.x + this.bb * e3.y + this.We * e3.z + this.Qb, r3.z = this.pf * e3.x + this.Ye * e3.y + this.Ze * e3.z + this.Cg, n4[h3] = r3;
          }
        }, i5.prototype.hp = function(i6) {
          var s4 = new t4.Od();
          return s4.x = this.eb * i6.x + this.jb * i6.y + this.Ve * i6.z + this.Lb, s4.y = this.qb * i6.x + this.bb * i6.y + this.We * i6.z + this.Qb, s4.z = this.pf * i6.x + this.Ye * i6.y + this.Ze * i6.z + this.Cg, s4;
        }, i5.prototype.Bg = function(t5) {
          i5.multiply(this, t5, this);
        }, i5.multiply = function(t5, i6, s4) {
          var n4 = t5.eb * i6.eb + t5.qb * i6.jb + t5.pf * i6.Ve, h3 = t5.eb * i6.qb + t5.qb * i6.bb + t5.pf * i6.We, r3 = t5.eb * i6.pf + t5.qb * i6.Ye + t5.pf * i6.Ze, e3 = t5.jb * i6.eb + t5.bb * i6.jb + t5.Ye * i6.Ve, o3 = t5.jb * i6.qb + t5.bb * i6.bb + t5.Ye * i6.We, a3 = t5.jb * i6.pf + t5.bb * i6.Ye + t5.Ye * i6.Ze, u3 = t5.Ve * i6.eb + t5.We * i6.jb + t5.Ze * i6.Ve, f3 = t5.Ve * i6.qb + t5.We * i6.bb + t5.Ze * i6.We, c3 = t5.Ve * i6.pf + t5.We * i6.Ye + t5.Ze * i6.Ze, l3 = t5.Lb * i6.eb + t5.Qb * i6.jb + t5.Cg * i6.Ve + i6.Lb, p3 = t5.Lb * i6.qb + t5.Qb * i6.bb + t5.Cg * i6.We + i6.Qb;
          t5 = t5.Lb * i6.pf + t5.Qb * i6.Ye + t5.Cg * i6.Ze + i6.Cg, s4.eb = n4, s4.qb = h3, s4.pf = r3, s4.jb = e3, s4.bb = o3, s4.Ye = a3, s4.Ve = u3, s4.We = f3, s4.Ze = c3, s4.Lb = l3, s4.Qb = p3, s4.Cg = t5;
        }, i5.inverse = function(i6, s4) {
          var n4 = i6.eb * (i6.bb * i6.Ze - i6.Ye * i6.We) - i6.qb * (i6.jb * i6.Ze - i6.Ye * i6.Ve) + i6.pf * (i6.jb * i6.We - i6.bb * i6.Ve);
          if (n4 == 0)
            throw t4.i.ga("math singularity");
          var h3 = 1 / n4;
          n4 = (i6.bb * i6.Ze - i6.Ye * i6.We) * h3;
          var r3 = -(i6.jb * i6.Ze - i6.Ye * i6.Ve) * h3, e3 = (i6.jb * i6.We - i6.bb * i6.Ve) * h3, o3 = -(i6.qb * i6.Ze - i6.We * i6.pf) * h3, a3 = (i6.eb * i6.Ze - i6.pf * i6.Ve) * h3, u3 = -(i6.eb * i6.We - i6.qb * i6.Ve) * h3, f3 = (i6.qb * i6.Ye - i6.pf * i6.bb) * h3, c3 = -(i6.eb * i6.Ye - i6.pf * i6.jb) * h3;
          h3 *= i6.eb * i6.bb - i6.qb * i6.jb;
          var l3 = -(i6.Lb * n4 + i6.Qb * r3 + i6.Cg * e3), p3 = -(i6.Lb * o3 + i6.Qb * a3 + i6.Cg * u3);
          i6 = -(i6.Lb * f3 + i6.Qb * c3 + i6.Cg * h3), s4.eb = n4, s4.qb = o3, s4.pf = f3, s4.jb = r3, s4.bb = a3, s4.Ye = c3, s4.Ve = e3, s4.We = u3, s4.Ze = h3, s4.Lb = l3, s4.Qb = p3, s4.Cg = i6;
        }, i5.prototype.Qf = function() {
          var t5 = new i5();
          return t5.eb = this.eb, t5.qb = this.qb, t5.pf = this.pf, t5.jb = this.jb, t5.bb = this.bb, t5.Ye = this.Ye, t5.Ve = this.Ve, t5.We = this.We, t5.Ze = this.Ze, t5.Lb = this.Lb, t5.Qb = this.Qb, t5.Cg = this.Cg, t5;
        }, i5;
      }();
      t4.FY = i4;
    }(Q2 || (Q2 = {})), function(t4) {
      var i4 = function(i5) {
        function n4(t5) {
          if (t5 !== void 0)
            t5 = i5.call(this, t5.dc(), t5) || this;
          else {
            (t5 = i5.call(this) || this).dg = [], t5.dg[0] = 0, t5.Ba = 1, t5.wh = [];
            for (var s5 = 0; 10 > s5; s5++)
              t5.wh[s5] = -1;
            t5.wh[t5.dg[0]] = 0;
          }
          return t5.lq = true, t5;
        }
        return _2(n4, i5), n4.prototype.se = function(t5) {
          this.hasAttribute(t5) || (this.wh[t5] = 0, this.eD());
        }, n4.prototype.removeAttribute = function(i6) {
          if (i6 == 0)
            throw t4.i.O("Position attribue cannot be removed");
          this.hasAttribute(i6) && (this.wh[i6] = -1, this.eD());
        }, n4.prototype.reset = function() {
          this.dg[0] = 0, this.Ba = 1;
          for (var t5 = 0; t5 < this.wh.length; t5++)
            this.wh[t5] = -1;
          this.wh[this.dg[0]] = 0, this.lq = true;
        }, n4.prototype.zF = function() {
          return s4.fz().add(this);
        }, n4.pg = function() {
          return s4.fz().VR();
        }, n4.prototype.oM = function() {
          var i6 = this.dc();
          return new t4.sa(i6, this);
        }, n4.prototype.eD = function() {
          for (var t5 = this.Ba = 0, i6 = 0; 10 > t5; t5++)
            0 <= this.wh[t5] && (this.dg[i6] = t5, this.wh[t5] = i6, i6++, this.Ba++);
          this.lq = true;
        }, n4.prototype.dc = function() {
          return this.lq && (this.yl = this.Cn(), this.lq = false), this.yl;
        }, n4.prototype.Nb = function(t5) {
          if (t5 == null)
            return false;
          if (t5 == this)
            return true;
          if (!(t5 instanceof n4) || t5.Ba != this.Ba)
            return false;
          for (var i6 = 0; i6 < this.Ba; i6++)
            if (this.dg[i6] != t5.dg[i6])
              return false;
          return this.lq == t5.lq;
        }, n4.prototype.BG = function(t5) {
          if (t5.Ba != this.Ba)
            return false;
          for (var i6 = 0; i6 < this.Ba; i6++)
            if (this.dg[i6] != t5.dg[i6])
              return false;
          return true;
        }, n4.Kw = function(t5, i6) {
          for (var s5 = [], n5 = 0; n5 < t5.Ba; n5++)
            s5[n5] = -1;
          n5 = 0;
          for (var h3 = t5.Ba; n5 < h3; n5++)
            s5[n5] = i6.Rf(t5.ld(n5));
          return s5;
        }, n4.wR = function(t5, i6) {
          return (t5 = new n4(t5)).se(i6), t5.zF();
        }, n4.xR = function(t5, i6) {
          for (var s5 = null, h3 = 0; 10 > h3; h3++)
            !t5.hasAttribute(h3) && i6.hasAttribute(h3) && (s5 == null && (s5 = new n4(t5)), s5.se(h3));
          return s5 != null ? s5.zF() : t5;
        }, n4;
      }(t4.sa);
      t4.fe = i4;
      var s4 = function() {
        function t5() {
          this.map = [];
          var t6 = new i4();
          this.add(t6), (t6 = new i4()).se(1), this.add(t6);
        }
        return t5.fz = function() {
          return t5.XK;
        }, t5.prototype.VR = function() {
          return t5.gt;
        }, t5.prototype.add = function(i5) {
          var s5 = i5.dc();
          if (t5.gt != null && t5.gt.dc() == s5 && i5.BG(t5.gt))
            return t5.gt;
          if (t5.Fw != null && t5.Fw.dc() == s5 && i5.BG(t5.Fw))
            return t5.Fw;
          var n4 = null;
          return this.map[s5] !== void 0 && (n4 = this.map[s5]), n4 == null && ((n4 = i5.oM()).Ba == 1 ? t5.gt = n4 : n4.Ba == 2 && n4.ld(1) == 1 ? t5.Fw = n4 : this.map[s5] = n4), n4;
        }, t5.XK = new t5(), t5;
      }();
    }(Q2 || (Q2 = {}));
    var rt2 = { feet: 9002, kilometers: 9036, meters: 9001, miles: 9093, "nautical-miles": 9030, yards: 9096 }, et2 = { acres: 109402, ares: 109463, hectares: 109401, "square-feet": 109405, "square-kilometers": 109414, "square-meters": 109404, "square-miles": 109439, "square-yards": 109442 }, ot2 = new (function() {
      function t4() {
        this.MM = 50, this.pp = new Map(), this.ij = [];
      }
      return t4.prototype.clear = function() {
        this.ij.length = 0, this.pp.clear();
      }, t4.prototype.delete = function(t5) {
        return !!this.pp.delete(t5) && (this.ij.splice(this.ij.indexOf(t5), 1), true);
      }, t4.prototype.get = function(t5) {
        var i4 = this.pp.get(t5);
        if (i4 !== void 0)
          return this.ij[0] !== t5 && (this.ij.splice(this.ij.indexOf(t5), 1), this.ij.unshift(t5)), i4;
      }, t4.prototype.has = function(t5) {
        return this.pp.has(t5);
      }, t4.prototype.set = function(t5, i4) {
        return this.get(t5) !== void 0 && this.delete(t5), this.ij.unshift(t5), this.pp.set(t5, i4), this.jM(), this;
      }, t4.prototype.jM = function() {
        for (; this.ij.length && this.ij.length > this.MM; ) {
          var t5 = this.ij.pop();
          this.pp.delete(t5);
        }
      }, t4;
    }())(), at2 = ((Y2 = {}).convertJSONToGeometry = function(t4) {
      return Q2.ac.aP(t4);
    }, Y2.hasM = function(t4) {
      return t4.hasAttribute(Q2.Kh.M);
    }, Y2.hasZ = function(t4) {
      return t4.hasAttribute(Q2.Kh.Z);
    }, Y2.getPointX = function(t4) {
      return t4.Ng();
    }, Y2.getPointY = function(t4) {
      return t4.kh();
    }, Y2.getPointZ = function(t4) {
      return t4.XR();
    }, Y2.getPointM = function(t4) {
      return t4.uR();
    }, Y2.getXMin = function(t4) {
      return t4.gs();
    }, Y2.getYMin = function(t4) {
      return t4.js();
    }, Y2.getXMax = function(t4) {
      return t4.fs();
    }, Y2.getYMax = function(t4) {
      return t4.hs();
    }, Y2.getZExtent = function(t4) {
      return t4.Vg(Q2.Kh.Z, 0);
    }, Y2.getMExtent = function(t4) {
      return t4.Vg(Q2.Kh.M, 0);
    }, Y2.exportPaths = function(t4) {
      var i4 = [], s4 = t4.ea(), n4 = null, h3 = null, r3 = t4.hasAttribute(Q2.Kh.Z), e3 = t4.hasAttribute(Q2.Kh.M);
      r3 && (n4 = t4.vb(Q2.Kh.Z)), e3 && (h3 = t4.vb(Q2.Kh.M));
      for (var o3 = new Q2.h(), a3 = 0; a3 < s4; a3++) {
        for (var u3 = t4.Ca(a3), f3 = t4.Ka(a3), c3 = 0, l3 = 0, p3 = NaN, v3 = NaN, y3 = NaN, b3 = NaN, d3 = t4.ec(a3), g3 = [], w3 = u3; w3 < u3 + f3; w3++) {
          t4.D(w3, o3), b3 = y3 = NaN;
          var x3 = [o3.x, o3.y];
          r3 && (y3 = n4.get(w3), x3.push(y3)), e3 && (b3 = h3.get(w3), x3.push(b3)), w3 == u3 && d3 && (c3 = o3.x, l3 = o3.y, p3 = y3, v3 = b3), g3.push(x3);
        }
        !d3 || c3 == o3.x && l3 == o3.y && (!r3 || isNaN(p3) && isNaN(y3) || p3 == y3) && (!e3 || isNaN(v3) && isNaN(b3) || v3 == b3) || g3.push(g3[0].slice(0)), i4.push(g3);
      }
      return i4;
    }, Y2.exportPathsFlat = function() {
    }, Y2.exportPoints = function(t4) {
      var i4 = t4.hasAttribute(Q2.Kh.Z), s4 = t4.hasAttribute(Q2.Kh.M), n4 = null, h3 = null;
      i4 && (n4 = t4.vb(Q2.Kh.Z)), s4 && (h3 = t4.vb(Q2.Kh.M));
      for (var r3 = new Q2.h(), e3 = t4.I(), o3 = [], a3 = 0; a3 < e3; a3++) {
        t4.D(a3, r3);
        var u3 = [r3.x, r3.y];
        i4 && u3.push(n4.get(a3)), s4 && u3.push(h3.get(a3)), o3.push(u3);
      }
      return o3;
    }, Y2.exportPointsFlat = function() {
    }, Y2), ut2 = new Map();
    return function() {
      function t4() {
      }
      return t4.buffer = I2, t4.clip = a2, t4.contains = f2, t4.convexHull = j2, t4.crosses = c2, t4.cut = u2, t4.densify = F2, t4.difference = M2, t4.disjoint = d2, t4.distance = l2, t4.equals = p2, t4.extendedSpatialReferenceInfo = o2, t4.generalize = G2, t4.geodesicArea = O2, t4.geodesicBuffer = P2, t4.geodesicDensify = T2, t4.geodesicLength = H2, t4.intersect = z2, t4.intersects = v2, t4.isSimple = x2, t4.nearestCoordinate = B2, t4.nearestVertex = D2, t4.nearestVertices = q2, t4.offset = N2, t4.overlaps = g2, t4.planarArea = E2, t4.planarLength = S2, t4.relate = w2, t4.simplify = m2, t4.symmetricDifference = k2, t4.touches = y2, t4.union = A2, t4.within = b2, t4.rotate = Q2.Dx.rotate, t4.flipHorizontal = Q2.Dx.EQ, t4.flipVertical = Q2.Dx.FQ, t4.intersectLinesToPoints = X2, t4.ExtendedParams = Q2.tC, t4.clearDefaultSpatialReferenceTolerance = V2, t4.changeDefaultSpatialReferenceTolerance = W2, t4._enableProjection = J2, t4._project = K2, t4._getTransformation = R2, t4._getTransformationBySuitability = L2, t4;
    }();
  }
  var n2 = s2();
  n2 !== void 0 && (t2.exports = n2);
}(i$q);
const s$e = i$q.exports, n$k = t$f({ __proto__: null, default: s$e }, [i$q.exports]);
var geometryEngineBase = /* @__PURE__ */ Object.freeze({
  __proto__: null,
  [Symbol.toStringTag]: "Module",
  G: s$e,
  g: n$k
});
const r$f = { convertToGEGeometry: s$d, exportPoint: a$d, exportPolygon: c$f, exportPolyline: h$d, exportMultipoint: m$r, exportExtent: x$7 };
function s$d(e2, n2) {
  if (n2 == null)
    return null;
  let t2 = "cache" in n2 ? n2.cache._geVersion : void 0;
  return t2 == null && (t2 = e2.convertJSONToGeometry(n2), "cache" in n2 && (n2.cache._geVersion = t2)), t2;
}
function a$d(e2, n2, o2) {
  const i2 = e2.hasZ(n2), r2 = e2.hasM(n2), s2 = new w$_({ x: e2.getPointX(n2), y: e2.getPointY(n2), spatialReference: o2 });
  return i2 && (s2.z = e2.getPointZ(n2)), r2 && (s2.m = e2.getPointM(n2)), s2.cache._geVersion = n2, s2;
}
function c$f(e2, n2, t2) {
  const i2 = new v$15({ rings: e2.exportPaths(n2), hasZ: e2.hasZ(n2), hasM: e2.hasM(n2), spatialReference: t2 });
  return i2.cache._geVersion = n2, i2;
}
function h$d(e2, n2, t2) {
  const o2 = new m$2i({ paths: e2.exportPaths(n2), hasZ: e2.hasZ(n2), hasM: e2.hasM(n2), spatialReference: t2 });
  return o2.cache._geVersion = n2, o2;
}
function m$r(e2, t2, o2) {
  const i2 = new u$26({ hasZ: e2.hasZ(t2), hasM: e2.hasM(t2), points: e2.exportPoints(t2), spatialReference: o2 });
  return i2.cache._geVersion = t2, i2;
}
function x$7(n2, t2, o2) {
  const i2 = n2.hasZ(t2), r2 = n2.hasM(t2), s2 = new w$Z({ xmin: n2.getXMin(t2), ymin: n2.getYMin(t2), xmax: n2.getXMax(t2), ymax: n2.getYMax(t2), spatialReference: o2 });
  if (i2) {
    const e2 = n2.getZExtent(t2);
    s2.zmin = e2.vmin, s2.zmax = e2.vmax;
  }
  if (r2) {
    const e2 = n2.getMExtent(t2);
    s2.mmin = e2.vmin, s2.mmax = e2.vmax;
  }
  return s2.cache._geVersion = t2, s2;
}
var hydrated = /* @__PURE__ */ Object.freeze({
  __proto__: null,
  [Symbol.toStringTag]: "Module",
  hydratedAdapter: r$f
});
function t$e(n2) {
  return Array.isArray(n2) ? n2[0].spatialReference : n2 && n2.spatialReference;
}
function r$e(e2) {
  return s$e.extendedSpatialReferenceInfo(e2);
}
function u$c(r2, u2) {
  return s$e.clip(r$f, t$e(r2), r2, u2);
}
function i$p(r2, u2) {
  return s$e.cut(r$f, t$e(r2), r2, u2);
}
function c$e(r2, u2) {
  return s$e.contains(r$f, t$e(r2), r2, u2);
}
function o$g(r2, u2) {
  return s$e.crosses(r$f, t$e(r2), r2, u2);
}
function f$d(r2, u2, i2) {
  return s$e.distance(r$f, t$e(r2), r2, u2, i2);
}
function s$c(r2, u2) {
  return s$e.equals(r$f, t$e(r2), r2, u2);
}
function a$c(r2, u2) {
  return s$e.intersects(r$f, t$e(r2), r2, u2);
}
function l$f(r2, u2) {
  return s$e.touches(r$f, t$e(r2), r2, u2);
}
function p$l(r2, u2) {
  return s$e.within(r$f, t$e(r2), r2, u2);
}
function d$8(r2, u2) {
  return s$e.disjoint(r$f, t$e(r2), r2, u2);
}
function m$q(r2, u2) {
  return s$e.overlaps(r$f, t$e(r2), r2, u2);
}
function g$a(r2, u2, i2) {
  return s$e.relate(r$f, t$e(r2), r2, u2, i2);
}
function h$c(r2) {
  return s$e.isSimple(r$f, t$e(r2), r2);
}
function w$6(r2) {
  return s$e.simplify(r$f, t$e(r2), r2);
}
function R$3(r2, u2 = false) {
  return s$e.convexHull(r$f, t$e(r2), r2, u2);
}
function x$6(r2, u2) {
  return s$e.difference(r$f, t$e(r2), r2, u2);
}
function y$7(r2, u2) {
  return s$e.symmetricDifference(r$f, t$e(r2), r2, u2);
}
function S$5(r2, u2) {
  return s$e.intersect(r$f, t$e(r2), r2, u2);
}
function A$5(r2, u2 = null) {
  return s$e.union(r$f, t$e(r2), r2, u2);
}
function D$5(r2, u2, i2, c2, o2, f2) {
  return s$e.offset(r$f, t$e(r2), r2, u2, i2, c2, o2, f2);
}
function j$6(r2, u2, i2, c2 = false) {
  return s$e.buffer(r$f, t$e(r2), r2, u2, i2, c2);
}
function E$8(r2, u2, i2, c2, o2, f2) {
  return s$e.geodesicBuffer(r$f, t$e(r2), r2, u2, i2, c2, o2, f2);
}
function J$7(r2, u2, i2 = true) {
  return s$e.nearestCoordinate(r$f, t$e(r2), r2, u2, i2);
}
function L(r2, u2) {
  return s$e.nearestVertex(r$f, t$e(r2), r2, u2);
}
function N$7(r2, u2, i2, c2) {
  return s$e.nearestVertices(r$f, t$e(r2), r2, u2, i2, c2);
}
function O$5(n2) {
  var _a2, _b2;
  return "xmin" in n2 ? "center" in n2 ? n2.center : null : "x" in n2 ? n2 : "extent" in n2 ? (_b2 = (_a2 = n2.extent) == null ? void 0 : _a2.center) != null ? _b2 : null : null;
}
function T$5(e2, t2, r2) {
  if (e2 == null)
    throw new F$7();
  const u2 = e2.spatialReference;
  if ((r2 = r2 != null ? r2 : O$5(e2)) == null)
    throw new F$7();
  const i2 = e2.constructor.fromJSON(s$e.rotate(e2, t2, r2));
  return i2.spatialReference = u2, i2;
}
function V$4(e2, t2) {
  if (e2 == null)
    throw new F$7();
  const r2 = e2.spatialReference;
  if ((t2 = t2 != null ? t2 : O$5(e2)) == null)
    throw new F$7();
  const u2 = e2.constructor.fromJSON(s$e.flipHorizontal(e2, t2));
  return u2.spatialReference = r2, u2;
}
function v$9(e2, t2) {
  if (e2 == null)
    throw new F$7();
  const r2 = e2.spatialReference;
  if ((t2 = t2 != null ? t2 : O$5(e2)) == null)
    throw new F$7();
  const u2 = e2.constructor.fromJSON(s$e.flipVertical(e2, t2));
  return u2.spatialReference = r2, u2;
}
function z$7(r2, u2, i2, c2) {
  return s$e.generalize(r$f, t$e(r2), r2, u2, i2, c2);
}
function B$5(r2, u2, i2) {
  return s$e.densify(r$f, t$e(r2), r2, u2, i2);
}
function H$3(r2, u2, i2, c2 = 0) {
  return s$e.geodesicDensify(r$f, t$e(r2), r2, u2, i2, c2);
}
function I$6(r2, u2) {
  return s$e.planarArea(r$f, t$e(r2), r2, u2);
}
function b$8(r2, u2) {
  return s$e.planarLength(r$f, t$e(r2), r2, u2);
}
function k$4(r2, u2, i2) {
  return s$e.geodesicArea(r$f, t$e(r2), r2, u2, i2);
}
function q$5(r2, u2, i2) {
  return s$e.geodesicLength(r$f, t$e(r2), r2, u2, i2);
}
function C$5(r2, u2) {
  return s$e.intersectLinesToPoints(r$f, t$e(r2), r2, u2);
}
function G$6(e2, t2) {
  s$e.changeDefaultSpatialReferenceTolerance(e2, t2);
}
function P$5(e2) {
  s$e.clearDefaultSpatialReferenceTolerance(e2);
}
class F$7 extends Error {
  constructor() {
    super("Illegal Argument Exception");
  }
}
var geometryEngine = /* @__PURE__ */ Object.freeze({
  __proto__: null,
  [Symbol.toStringTag]: "Module",
  buffer: j$6,
  changeDefaultSpatialReferenceTolerance: G$6,
  clearDefaultSpatialReferenceTolerance: P$5,
  clip: u$c,
  contains: c$e,
  convexHull: R$3,
  crosses: o$g,
  cut: i$p,
  densify: B$5,
  difference: x$6,
  disjoint: d$8,
  distance: f$d,
  equals: s$c,
  extendedSpatialReferenceInfo: r$e,
  flipHorizontal: V$4,
  flipVertical: v$9,
  generalize: z$7,
  geodesicArea: k$4,
  geodesicBuffer: E$8,
  geodesicDensify: H$3,
  geodesicLength: q$5,
  intersect: S$5,
  intersectLinesToPoints: C$5,
  intersects: a$c,
  isSimple: h$c,
  nearestCoordinate: J$7,
  nearestVertex: L,
  nearestVertices: N$7,
  offset: D$5,
  overlaps: m$q,
  planarArea: I$6,
  planarLength: b$8,
  relate: g$a,
  rotate: T$5,
  simplify: w$6,
  symmetricDifference: y$7,
  touches: l$f,
  union: A$5,
  within: p$l
});
let i$o = class extends m$2q {
  constructor() {
    super(...arguments), this.outSpatialReference = null, this.processExtent = null, this.processSpatialReference = null, this.returnFeatureCollection = false, this.returnM = false, this.returnZ = false;
  }
};
e$2g([y$1I({ type: k$C })], i$o.prototype, "outSpatialReference", void 0), e$2g([y$1I({ type: w$Z })], i$o.prototype, "processExtent", void 0), e$2g([y$1I({ type: k$C })], i$o.prototype, "processSpatialReference", void 0), e$2g([y$1I({ nonNullable: true })], i$o.prototype, "returnFeatureCollection", void 0), e$2g([y$1I({ nonNullable: true })], i$o.prototype, "returnM", void 0), e$2g([y$1I({ nonNullable: true })], i$o.prototype, "returnZ", void 0), i$o = e$2g([n$2P("esri.rest.geoprocessor.GPOptions")], i$o), i$o.from = b$1a(i$o);
const n$j = i$o;
let p$k = class extends l$2B {
  constructor() {
    super(...arguments), this.extent = null, this.height = null, this.href = null, this.opacity = 1, this.rotation = 0, this.scale = null, this.visible = true, this.width = null;
  }
};
e$2g([y$1I({ type: w$Z })], p$k.prototype, "extent", void 0), e$2g([y$1I()], p$k.prototype, "height", void 0), e$2g([y$1I()], p$k.prototype, "href", void 0), e$2g([y$1I()], p$k.prototype, "opacity", void 0), e$2g([y$1I()], p$k.prototype, "rotation", void 0), e$2g([y$1I()], p$k.prototype, "scale", void 0), e$2g([y$1I()], p$k.prototype, "visible", void 0), e$2g([y$1I()], p$k.prototype, "width", void 0), p$k = e$2g([n$2P("esri.layer.support.MapImage")], p$k);
const i$n = p$k;
let e$8 = class extends l$2B {
  constructor(r2) {
    super(r2), this.itemId = null, this.url = null;
  }
};
e$2g([y$1I({ type: String, json: { read: { source: "itemID" }, write: { target: "itemID" } } })], e$8.prototype, "itemId", void 0), e$2g([y$1I({ type: String, json: { write: true } })], e$8.prototype, "url", void 0), e$8 = e$2g([n$2P("esri.rest.support.DataFile")], e$8);
const p$j = e$8;
const i$m = new s$2a({ esriMeters: "meters", esriFeet: "feet", esriKilometers: "kilometers", esriMiles: "miles", esriNauticalMiles: "nautical-miles", esriYards: "yards" }, { ignoreUnknown: false });
let p$i = class extends l$2B {
  constructor(r2) {
    super(r2), this.distance = 0, this.units = null;
  }
};
e$2g([y$1I({ json: { write: true } })], p$i.prototype, "distance", void 0), e$2g([y$1I({ json: { read: i$m.read, write: i$m.write } })], p$i.prototype, "units", void 0), p$i = e$2g([n$2P("esri.rest.support.LinearUnit")], p$i);
const c$d = p$i;
const u$b = new s$2a({ GPBoolean: "boolean", GPDataFile: "data-file", GPDate: "date", GPDouble: "double", GPFeatureRecordSetLayer: "feature-record-set-layer", GPField: "field", GPLinearUnit: "linear-unit", GPLong: "long", GPRasterData: "raster-data", GPRasterDataLayer: "raster-data-layer", GPRecordSet: "record-set", GPString: "string", "GPMultiValue:GPBoolean": "multi-value", "GPMultiValue:GPDataFile": "multi-value", "GPMultiValue:GPDate": "multi-value", "GPMultiValue:GPDouble": "multi-value", "GPMultiValue:GPFeatureRecordSetLayer": "multi-value", "GPMultiValue:GPField": "multi-value", "GPMultiValue:GPLinearUnit": "multi-value", "GPMultiValue:GPLong": "multi-value", "GPMultiValue:GPRasterData": "multi-value", "GPMultiValue:GPRasterDataLayer": "multi-value", "GPMultiValue:GPRecordSet": "multi-value", "GPMultiValue:GPString": "multi-value" });
let o$f = class extends l$2B {
  constructor(e2) {
    super(e2), this.dataType = null, this.value = null;
  }
};
e$2g([y$1I({ json: { read: u$b.read, write: u$b.write } })], o$f.prototype, "dataType", void 0), e$2g([y$1I()], o$f.prototype, "value", void 0), o$f = e$2g([n$2P("esri.rest.support.ParameterValue")], o$f);
const i$l = o$f;
let e$7 = class extends l$2B {
  constructor(r2) {
    super(r2), this.format = null, this.itemId = null, this.url = null;
  }
};
e$2g([y$1I()], e$7.prototype, "format", void 0), e$2g([y$1I({ json: { read: { source: "itemID" }, write: { target: "itemID" } } })], e$7.prototype, "itemId", void 0), e$2g([y$1I()], e$7.prototype, "url", void 0), e$7 = e$2g([n$2P("esri.rest.support.RasterData")], e$7);
const p$h = e$7;
async function m$p(t2, r2, u2, l2, s2) {
  const n2 = {}, i2 = {}, c2 = [];
  return p$g(l2, c2, n2), v$L(c2).then((a2) => {
    const { outSpatialReference: c3, processExtent: m2, processSpatialReference: p2, returnFeatureCollection: f2, returnM: G2, returnZ: v2 } = u2, { path: S2 } = f$19(t2);
    for (const e2 in n2) {
      const t3 = n2[e2];
      i2[e2] = a2.slice(t3[0], t3[1]);
    }
    const y2 = c3 ? c3.wkid || c3 : null, D2 = p2 ? p2.wkid || p2 : null, J2 = r2 === "execute" ? { returnFeatureCollection: f2 || void 0, returnM: G2 || void 0, returnZ: v2 || void 0 } : null, M2 = P$4(__spreadProps(__spreadValues(__spreadValues(__spreadValues({}, m2 ? { context: { extent: m2, outSR: y2, processSR: D2 } } : { "env:outSR": y2, "env:processSR": D2 }), l2), J2), { f: "json" }), null, i2), N2 = __spreadProps(__spreadValues({}, s2), { query: M2 });
    return U$t(`${S2}/${r2}`, N2);
  });
}
function p$g(e2, a2, t2) {
  for (const r2 in e2) {
    const o2 = e2[r2];
    if (o2 && typeof o2 == "object" && o2 instanceof x$A) {
      const { features: e3 } = o2;
      t2[r2] = [a2.length, a2.length + e3.length], e3.forEach((e4) => {
        a2.push(e4.geometry);
      });
    }
  }
}
function f$c(e2) {
  const a2 = e2.dataType, o2 = i$l.fromJSON(e2);
  switch (a2) {
    case "GPBoolean":
    case "GPDouble":
    case "GPLong":
    case "GPString":
    case "GPMultiValue:GPBoolean":
    case "GPMultiValue:GPDouble":
    case "GPMultiValue:GPLong":
    case "GPMultiValue:GPString":
      return o2;
    case "GPDate":
      o2.value = new Date(o2.value);
      break;
    case "GPDataFile":
      o2.value = p$j.fromJSON(o2.value);
      break;
    case "GPLinearUnit":
      o2.value = c$d.fromJSON(o2.value);
      break;
    case "GPFeatureRecordSetLayer":
    case "GPRecordSet": {
      const a3 = e2.value.url;
      o2.value = a3 ? p$j.fromJSON(o2.value) : x$A.fromJSON(o2.value);
      break;
    }
    case "GPRasterData":
    case "GPRasterDataLayer": {
      const a3 = e2.value.mapImage;
      o2.value = a3 ? i$n.fromJSON(a3) : p$h.fromJSON(o2.value);
      break;
    }
    case "GPField":
      o2.value = y$Y.fromJSON(o2.value);
      break;
    case "GPMultiValue:GPDate": {
      const e3 = o2.value;
      o2.value = e3.map((e4) => new Date(e4));
      break;
    }
    case "GPMultiValue:GPDataFile":
      o2.value = o2.value.map((e3) => p$j.fromJSON(e3));
      break;
    case "GPMultiValue:GPLinearUnit":
      o2.value = o2.value.map((e3) => c$d.fromJSON(e3));
      break;
    case "GPMultiValue:GPFeatureRecordSetLayer":
    case "GPMultiValue:GPRecordSet":
      o2.value = o2.value.map((e3) => x$A.fromJSON(e3));
      break;
    case "GPMultiValue:GPRasterData":
    case "GPMultiValue:GPRasterDataLayer":
      o2.value = o2.value.map((e3) => e3 ? i$n.fromJSON(e3) : p$h.fromJSON(o2.value));
      break;
    case "GPMultiValue:GPField":
      o2.value = o2.value.map((e3) => y$Y.fromJSON(e3));
  }
  return o2;
}
function P$4(e2, a2, t2) {
  for (const r2 in e2) {
    const a3 = e2[r2];
    Array.isArray(a3) ? e2[r2] = JSON.stringify(a3.map((e3) => P$4({ item: e3 }, true).item)) : a3 instanceof Date && (e2[r2] = a3.getTime());
  }
  return s$1o(e2, a2, t2);
}
const p$f = new s$2a({ esriJobMessageTypeInformative: "informative", esriJobMessageTypeProcessDefinition: "process-definition", esriJobMessageTypeProcessStart: "process-start", esriJobMessageTypeProcessStop: "process-stop", esriJobMessageTypeWarning: "warning", esriJobMessageTypeError: "error", esriJobMessageTypeEmpty: "empty", esriJobMessageTypeAbort: "abort" });
let i$k = class extends l$2B {
  constructor(e2) {
    super(e2), this.description = null, this.type = null;
  }
};
e$2g([y$1I({ type: String, json: { write: true } })], i$k.prototype, "description", void 0), e$2g([y$1I({ type: String, json: { read: p$f.read, write: p$f.write } })], i$k.prototype, "type", void 0), i$k = e$2g([n$2P("esri.rest.support.GPMessage")], i$k);
const a$b = i$k;
async function o$e(o2, m2, a2, p2) {
  return a2 = n$j.from(a2 || {}), m$p(o2, "execute", a2, m2, p2).then((s2) => {
    const t2 = s2.data.results || [], o3 = s2.data.messages || [];
    return { results: t2.map(f$c), messages: o3.map((s3) => a$b.fromJSON(s3)) };
  });
}
var p$e;
const h$b = new s$2a({ esriJobCancelled: "job-cancelled", esriJobCancelling: "job-cancelling", esriJobDeleted: "job-deleted", esriJobDeleting: "job-deleting", esriJobTimedOut: "job-timed-out", esriJobExecuting: "job-executing", esriJobFailed: "job-failed", esriJobNew: "job-new", esriJobSubmitted: "job-submitted", esriJobSucceeded: "job-succeeded", esriJobWaiting: "job-waiting" });
let m$o = p$e = class extends l$2B {
  constructor(e2) {
    super(e2), this.jobId = null, this.jobStatus = null, this.messages = null, this.requestOptions = null, this.sourceUrl = null, this._timer = null;
  }
  cancelJob(e2) {
    const { jobId: s2, sourceUrl: r2 } = this, { path: o2 } = f$19(r2), i2 = __spreadProps(__spreadValues(__spreadValues({}, this.requestOptions), e2), { query: { f: "json" } });
    this._clearTimer();
    return U$t(`${o2}/jobs/${s2}/cancel`, i2).then((e3) => {
      const t2 = p$e.fromJSON(e3.data);
      return this.messages = t2.messages, this.jobStatus = t2.jobStatus, this;
    });
  }
  destroy() {
    clearInterval(this._timer);
  }
  checkJobStatus(e2) {
    const { path: s2 } = f$19(this.sourceUrl), r2 = __spreadProps(__spreadValues(__spreadValues({}, this.requestOptions), e2), { query: { f: "json" } }), o2 = `${s2}/jobs/${this.jobId}`;
    return U$t(o2, r2).then(({ data: e3 }) => {
      const t2 = p$e.fromJSON(e3);
      return this.messages = t2.messages, this.jobStatus = t2.jobStatus, this;
    });
  }
  fetchResultData(e2, s2, r2) {
    s2 = n$j.from(s2 || {});
    const { returnFeatureCollection: o2, returnM: i2, returnZ: a2, outSpatialReference: c2 } = s2, { path: j2 } = f$19(this.sourceUrl), p2 = P$4({ returnFeatureCollection: o2, returnM: i2, returnZ: a2, outSR: c2, returnType: "data", f: "json" }, null), h2 = __spreadProps(__spreadValues(__spreadValues({}, this.requestOptions), r2), { query: p2 }), m2 = `${j2}/jobs/${this.jobId}/results/${e2}`;
    return U$t(m2, h2).then((e3) => f$c(e3.data));
  }
  fetchResultImage(e2, s2, r2) {
    const { path: o2 } = f$19(this.sourceUrl), i2 = __spreadProps(__spreadValues({}, s2.toJSON()), { f: "json" }), a2 = P$4(i2), c2 = __spreadProps(__spreadValues(__spreadValues({}, this.requestOptions), r2), { query: a2 }), u2 = `${o2}/jobs/${this.jobId}/results/${e2}`;
    return U$t(u2, c2).then((e3) => f$c(e3.data));
  }
  async fetchResultMapImageLayer() {
    const { path: e2 } = f$19(this.sourceUrl), t2 = e2.indexOf("/GPServer/"), s2 = `${e2.substring(0, t2)}/MapServer/jobs/${this.jobId}`;
    return new (await Promise.resolve().then(function() {
      return MapImageLayer;
    })).default({ url: s2 });
  }
  async waitForJobCompletion(e2 = {}) {
    const { interval: t2 = 1e3, signal: s2, statusCallback: r2 } = e2;
    return new Promise((e3, a2) => {
      v$19(s2, () => {
        this._clearTimer(), a2(a$2T());
      }), this._clearTimer();
      const c2 = setInterval(() => {
        this._timer || a2(a$2T()), this.checkJobStatus(this.requestOptions).then((t3) => {
          const { jobStatus: s3 } = t3;
          switch (this.jobStatus = s3, s3) {
            case "job-succeeded":
              this._clearTimer(), e3(this);
              break;
            case "job-submitted":
            case "job-executing":
            case "job-waiting":
            case "job-new":
              r2 && r2(this);
              break;
            case "job-cancelled":
            case "job-cancelling":
            case "job-deleted":
            case "job-deleting":
            case "job-timed-out":
            case "job-failed":
              this._clearTimer(), a2(this);
          }
        });
      }, t2);
      this._timer = c2;
    });
  }
  _clearTimer() {
    this._timer && (clearInterval(this._timer), this._timer = null);
  }
};
e$2g([y$1I()], m$o.prototype, "jobId", void 0), e$2g([y$1I({ json: { read: h$b.read } })], m$o.prototype, "jobStatus", void 0), e$2g([y$1I({ type: [a$b] })], m$o.prototype, "messages", void 0), e$2g([y$1I()], m$o.prototype, "requestOptions", void 0), e$2g([y$1I({ json: { write: true } })], m$o.prototype, "sourceUrl", void 0), m$o = p$e = e$2g([n$2P("esri.rest.support.JobInfo")], m$o);
const d$7 = m$o;
async function s$b(s2, m2, n2, f2) {
  return n2 = n$j.from(n2 || {}), m$p(s2, "submitJob", n2, m2, f2).then((o2) => {
    const r2 = d$7.fromJSON(o2.data);
    return r2.sourceUrl = s2, r2;
  });
}
var geoprocessor = /* @__PURE__ */ Object.freeze({
  __proto__: null,
  [Symbol.toStringTag]: "Module",
  execute: o$e,
  submitJob: s$b
});
class r$d {
  constructor(t2, r2, o2 = "") {
    this.major = t2, this.minor = r2, this._context = o2;
  }
  lessThan(t2, r2) {
    return this.major < t2 || t2 === this.major && this.minor < r2;
  }
  since(t2, r2) {
    return !this.lessThan(t2, r2);
  }
  validate(r2) {
    if (this.major !== r2.major) {
      const o2 = this._context && this._context + ":", s2 = this._context && this._context + " ";
      throw new s$2u(o2 + "unsupported-version", `Required major ${s2}version is '${this.major}', but got '\${version.major}.\${version.minor}'`, { version: r2 });
    }
  }
  clone() {
    return new r$d(this.major, this.minor, this._context);
  }
  static parse(o2, s2 = "") {
    const [e2, i2] = o2.split("."), n2 = /^\s*\d+\s*$/;
    if (!e2 || !e2.match || !e2.match(n2)) {
      throw new s$2u((s2 && s2 + ":") + "invalid-version", "Expected major version to be a number, but got '${version}'", { version: o2 });
    }
    if (!i2 || !i2.match || !i2.match(n2)) {
      throw new s$2u((s2 && s2 + ":") + "invalid-version", "Expected minor version to be a number, but got '${version}'", { version: o2 });
    }
    const a2 = parseInt(e2, 10), h2 = parseInt(i2, 10);
    return new r$d(a2, h2, s2);
  }
}
const y$6 = (y2) => {
  let d2 = class extends y2 {
    constructor() {
      super(...arguments), this.capabilities = void 0, this.copyright = null, this.fullExtent = null, this.legendEnabled = true, this.spatialReference = null, this.version = void 0, this._allLayersAndTablesPromise = null, this._allLayersAndTablesMap = null;
    }
    readCapabilities(e2, r2) {
      var _a2, _b2;
      const s2 = r2.capabilities && r2.capabilities.split(",").map((e3) => e3.toLowerCase().trim());
      if (!s2)
        return { operations: { supportsExportMap: false, supportsExportTiles: false, supportsIdentify: false, supportsQuery: false, supportsTileMap: false }, exportMap: null, exportTiles: null };
      const t2 = this.type, i2 = s2.includes("data"), p2 = s2.includes("query"), a2 = s2.includes("map"), l2 = !!r2.exportTilesAllowed, n2 = s2.includes("tilemap"), u2 = t2 !== "tile" && !!r2.supportsDynamicLayers, c2 = t2 !== "tile" && (!r2.tileInfo || u2), y3 = t2 !== "tile" && (!r2.tileInfo || u2), d3 = t2 !== "tile", m2 = r2.cimVersion && r$d.parse(r2.cimVersion), h2 = (_a2 = m2 == null ? void 0 : m2.since(1, 4)) != null ? _a2 : false, b2 = (_b2 = m2 == null ? void 0 : m2.since(2, 0)) != null ? _b2 : false;
      return { operations: { supportsExportMap: a2, supportsExportTiles: l2, supportsIdentify: p2, supportsQuery: i2, supportsTileMap: n2 }, exportMap: a2 ? { supportsArcadeExpressionForLabeling: h2, supportsSublayersChanges: d3, supportsDynamicLayers: u2, supportsSublayerVisibility: c2, supportsSublayerDefinitionExpression: y3, supportsCIMSymbols: b2 } : null, exportTiles: l2 ? { maxExportTilesCount: +r2.maxExportTilesCount } : null };
    }
    readVersion(e2, r2) {
      let s2 = r2.currentVersion;
      return s2 || (s2 = r2.hasOwnProperty("capabilities") || r2.hasOwnProperty("tables") ? 10 : r2.hasOwnProperty("supportedImageFormatTypes") ? 9.31 : 9.3), s2;
    }
    async fetchSublayerInfo(e2, r2) {
      var _a2;
      return await this.fetchAllLayersAndTables(r2), (_a2 = this._allLayersAndTablesMap) == null ? void 0 : _a2.get(e2);
    }
    async fetchAllLayersAndTables(e2) {
      await this.load(e2), this._allLayersAndTablesPromise || (this._allLayersAndTablesPromise = U$t(j$Q(this.url).path + "/layers", { responseType: "json", query: __spreadProps(__spreadValues({ f: "json" }, this.customParameters), { token: this.apiKey }) }).then((e3) => {
        this._allLayersAndTablesMap = new Map();
        for (const r2 of e3.data.layers)
          this._allLayersAndTablesMap.set(r2.id, r2);
        return { result: e3.data };
      }, (e3) => ({ error: e3 })));
      const o2 = await this._allLayersAndTablesPromise;
      if (f$1V(e2), "result" in o2)
        return o2.result;
      throw o2.error;
    }
  };
  return e$2g([y$1I({ readOnly: true })], d2.prototype, "capabilities", void 0), e$2g([o$29("service", "capabilities", ["capabilities", "exportTilesAllowed", "maxExportTilesCount", "supportsDynamicLayers", "tileInfo"])], d2.prototype, "readCapabilities", null), e$2g([y$1I({ json: { read: { source: "copyrightText" } } })], d2.prototype, "copyright", void 0), e$2g([y$1I({ type: w$Z })], d2.prototype, "fullExtent", void 0), e$2g([y$1I(j$m)], d2.prototype, "id", void 0), e$2g([y$1I({ type: Boolean, json: { origins: { service: { read: { enabled: false } } }, read: { source: "showLegend" }, write: { target: "showLegend" } } })], d2.prototype, "legendEnabled", void 0), e$2g([y$1I(p$1q)], d2.prototype, "popupEnabled", void 0), e$2g([y$1I({ type: k$C })], d2.prototype, "spatialReference", void 0), e$2g([y$1I({ readOnly: true })], d2.prototype, "version", void 0), e$2g([o$29("version", ["currentVersion", "capabilities", "tables", "supportedImageFormatTypes"])], d2.prototype, "readVersion", null), d2 = e$2g([n$2P("esri.layers.mixins.ArcGISMapService")], d2), d2;
};
var $$1;
function J$6(e2) {
  return e2 && e2.type === "esriSMS";
}
function B$4(e2, r2, t2) {
  var _a2;
  const i2 = this.originIdOf(r2) >= t$2e(t2.origin);
  return { ignoreOrigin: true, allowNull: i2, enabled: !!t2 && (((_a2 = t2.layer) == null ? void 0 : _a2.type) === "map-image" && (t2.writeSublayerStructure || i2)) };
}
function Q$4(e2, r2, t2) {
  var _a2;
  return { enabled: !!t2 && (((_a2 = t2.layer) == null ? void 0 : _a2.type) === "tile" && this._isOverridden(r2)) };
}
function G$5(e2, r2, t2) {
  return { ignoreOrigin: true, enabled: t2 && t2.writeSublayerStructure || false };
}
function H$2(e2, r2, t2) {
  return { ignoreOrigin: true, enabled: !!t2 && (t2.writeSublayerStructure || this.originIdOf(r2) >= t$2e(t2.origin)) };
}
let K$3 = 0;
const W$1 = new Set();
W$1.add("layer"), W$1.add("parent"), W$1.add("loaded"), W$1.add("loadStatus"), W$1.add("loadError"), W$1.add("loadWarnings");
let X$2 = $$1 = class extends a$1W(O$k(s$1$(m$1X))) {
  constructor(e2) {
    super(e2), this.capabilities = void 0, this.fields = null, this.fullExtent = null, this.geometryType = null, this.globalIdField = null, this.legendEnabled = true, this.objectIdField = null, this.popupEnabled = true, this.popupTemplate = null, this.sourceJSON = null, this.title = null, this.typeIdField = null, this.types = null;
  }
  async load(e2) {
    return this.addResolvingPromise((async () => {
      var _a2, _b2;
      if (!this.layer && !this.url)
        throw new s$2u("sublayer:missing-layer", "Sublayer can't be loaded without being part of a layer", { sublayer: this });
      let r2 = null;
      if (!this.layer || this.originIdOf("url") > r$1U.SERVICE || ((_a2 = this.source) == null ? void 0 : _a2.type) === "data-layer") {
        r2 = (await U$t(this.url, __spreadValues({ responseType: "json", query: { f: "json" } }, e2))).data;
      } else {
        let t2 = this.id;
        ((_b2 = this.source) == null ? void 0 : _b2.type) === "map-layer" && (t2 = this.source.mapLayerId), r2 = await this.layer.fetchSublayerInfo(t2, e2);
      }
      r2 && (this.sourceJSON = r2, this.read({ layerDefinition: r2 }, { origin: "service" }));
    })()), this;
  }
  readCapabilities(e2, r2) {
    const t2 = (e2 = (r2 = r2.layerDefinition || r2).capabilities || e2) ? e2.toLowerCase().split(",").map((e3) => e3.trim()) : [], i2 = this.url ? m$1a(this.url) : null, o2 = t2.includes(r$1$(i2) && i2.serverType === "MapServer" ? "data" : "query");
    return { exportMap: { supportsModification: !!r2.canModifyLayer }, operations: { supportsQuery: o2 } };
  }
  set definitionExpression(e2) {
    this._setAndNotifyLayer("definitionExpression", e2);
  }
  get fieldsIndex() {
    return new r$W(this.fields || []);
  }
  set floorInfo(e2) {
    this._setAndNotifyLayer("floorInfo", e2);
  }
  readGlobalIdFieldFromService(e2, r2) {
    if ((r2 = r2.layerDefinition || r2).globalIdField)
      return r2.globalIdField;
    if (r2.fields) {
      for (const t2 of r2.fields)
        if (t2.type === "esriFieldTypeGlobalID")
          return t2.name;
    }
  }
  get id() {
    const e2 = this._get("id");
    return e2 != null ? e2 : K$3++;
  }
  set id(e2) {
    this._get("id") !== e2 && (this.get("layer.capabilities.exportMap.supportsDynamicLayers") !== false ? this._set("id", e2) : this._logLockedError("id", "capability not available 'layer.capabilities.exportMap.supportsDynamicLayers'"));
  }
  set labelingInfo(e2) {
    this._setAndNotifyLayer("labelingInfo", e2);
  }
  writeLabelingInfo(e2, r2, t2, i2) {
    e2 && e2.length && (r2.layerDefinition = { drawingInfo: { labelingInfo: e2.map((e3) => e3.write({}, i2)) } });
  }
  set labelsVisible(e2) {
    this._setAndNotifyLayer("labelsVisible", e2);
  }
  set layer(e2) {
    this._set("layer", e2), this.sublayers && this.sublayers.forEach((r2) => r2.layer = e2);
  }
  set listMode(e2) {
    this._set("listMode", e2);
  }
  set minScale(e2) {
    this._setAndNotifyLayer("minScale", e2);
  }
  readMinScale(e2, r2) {
    return r2.minScale || r2.layerDefinition && r2.layerDefinition.minScale || 0;
  }
  set maxScale(e2) {
    this._setAndNotifyLayer("maxScale", e2);
  }
  readMaxScale(e2, r2) {
    return r2.maxScale || r2.layerDefinition && r2.layerDefinition.maxScale || 0;
  }
  get effectiveScaleRange() {
    const { minScale: e2, maxScale: r2 } = this;
    return { minScale: e2, maxScale: r2 };
  }
  readObjectIdFieldFromService(e2, r2) {
    if ((r2 = r2.layerDefinition || r2).objectIdField)
      return r2.objectIdField;
    if (r2.fields) {
      for (const t2 of r2.fields)
        if (t2.type === "esriFieldTypeOID")
          return t2.name;
    }
  }
  set opacity(e2) {
    this._setAndNotifyLayer("opacity", e2);
  }
  readOpacity(e2, r2) {
    const t2 = r2.layerDefinition;
    return 1 - 0.01 * (t2.transparency != null ? t2.transparency : t2.drawingInfo.transparency);
  }
  writeOpacity(e2, r2, t2, i2) {
    r2.layerDefinition = { drawingInfo: { transparency: 100 - 100 * e2 } };
  }
  writeParent(e2, r2) {
    this.parent && this.parent !== this.layer ? r2.parentLayerId = s$2y(this.parent.id) : r2.parentLayerId = -1;
  }
  get defaultPopupTemplate() {
    return this.createPopupTemplate();
  }
  set renderer(e2) {
    if (e2) {
      for (const r2 of e2.getSymbols())
        if (c$2k(r2)) {
          s$2z.getLogger(this.declaredClass).warn("Sublayer renderer should use 2D symbols");
          break;
        }
    }
    this._setAndNotifyLayer("renderer", e2);
  }
  get source() {
    return this._get("source") || new c$1T({ mapLayerId: this.id });
  }
  set source(e2) {
    this._setAndNotifyLayer("source", e2);
  }
  set sublayers(e2) {
    this._handleSublayersChange(e2, this._get("sublayers")), this._set("sublayers", e2);
  }
  castSublayers(e2) {
    return b$1a(j$V.ofType($$1), e2);
  }
  writeSublayers(e2, r2, t2) {
    this.get("sublayers.length") && (r2[t2] = this.sublayers.map((e3) => e3.id).toArray().reverse());
  }
  readTypeIdField(e2, r2) {
    let t2 = (r2 = r2.layerDefinition || r2).typeIdField;
    if (t2 && r2.fields) {
      t2 = t2.toLowerCase();
      const e3 = r2.fields.find((e4) => e4.name.toLowerCase() === t2);
      e3 && (t2 = e3.name);
    }
    return t2;
  }
  get url() {
    var _a2, _b2;
    const e2 = (_b2 = (_a2 = this.layer) == null ? void 0 : _a2.parsedUrl) != null ? _b2 : this._lastParsedUrl, r2 = this.source;
    if (!e2)
      return null;
    if (this._lastParsedUrl = e2, (r2 == null ? void 0 : r2.type) === "map-layer")
      return `${e2.path}/${r2.mapLayerId}`;
    const t2 = { layer: JSON.stringify({ source: this.source }) };
    return `${e2.path}/dynamicLayer?${I$D(t2)}`;
  }
  set url(e2) {
    this._overrideIfSome("url", e2);
  }
  set visible(e2) {
    this._setAndNotifyLayer("visible", e2);
  }
  writeVisible(e2, r2, t2, i2) {
    r2[t2] = this.getAtOrigin("defaultVisibility", "service") || e2;
  }
  clone() {
    const { store: e2 } = e$2a(this), r2 = new $$1();
    return e$2a(r2).store = e2.clone(W$1), this.commitProperty("url"), r2._lastParsedUrl = this._lastParsedUrl, r2;
  }
  createPopupTemplate(e2) {
    return p$1a(this, e2);
  }
  createQuery() {
    return new x$z({ returnGeometry: true, where: this.definitionExpression || "1=1" });
  }
  async createFeatureLayer() {
    var _a2, _b2;
    if (this.hasOwnProperty("sublayers"))
      return null;
    const e2 = (_a2 = this.layer) == null ? void 0 : _a2.parsedUrl, r2 = new (await Promise.resolve().then(function() {
      return FeatureLayer;
    })).default({ url: e2.path });
    return e2 && this.source && (this.source.type === "map-layer" ? r2.layerId = this.source.mapLayerId : r2.dynamicDataSource = this.source), this.layer.refreshInterval != null && (r2.refreshInterval = this.layer.refreshInterval), this.definitionExpression && (r2.definitionExpression = this.definitionExpression), this.floorInfo && (r2.floorInfo = y$1L(this.floorInfo)), this.originIdOf("labelingInfo") > r$1U.SERVICE && (r2.labelingInfo = y$1L(this.labelingInfo)), this.originIdOf("labelsVisible") > r$1U.DEFAULTS && (r2.labelsVisible = this.labelsVisible), this.originIdOf("legendEnabled") > r$1U.DEFAULTS && (r2.legendEnabled = this.legendEnabled), this.originIdOf("visible") > r$1U.DEFAULTS && (r2.visible = this.visible), this.originIdOf("minScale") > r$1U.DEFAULTS && (r2.minScale = this.minScale), this.originIdOf("maxScale") > r$1U.DEFAULTS && (r2.maxScale = this.maxScale), this.originIdOf("opacity") > r$1U.DEFAULTS && (r2.opacity = this.opacity), this.originIdOf("popupTemplate") > r$1U.DEFAULTS && (r2.popupTemplate = y$1L(this.popupTemplate)), this.originIdOf("renderer") > r$1U.SERVICE && (r2.renderer = y$1L(this.renderer)), ((_b2 = this.source) == null ? void 0 : _b2.type) === "data-layer" && (r2.dynamicDataSource = this.source.clone()), this.originIdOf("title") > r$1U.DEFAULTS && (r2.title = this.title), this.layer.type === "map-image" && this.layer.originIdOf("customParameters") > r$1U.DEFAULTS && (r2.customParameters = this.layer.customParameters), this.layer.type === "tile" && this.layer.originIdOf("customParameters") > r$1U.DEFAULTS && (r2.customParameters = this.layer.customParameters), r2;
  }
  getField(e2) {
    return this.fieldsIndex.get(e2);
  }
  getFeatureType(e2) {
    const { typeIdField: r2, types: t2 } = this;
    if (!r2 || !e2)
      return null;
    const i2 = e2.attributes ? e2.attributes[r2] : void 0;
    if (i2 == null)
      return null;
    let o2 = null;
    return t2.some((e3) => {
      const { id: r3 } = e3;
      return r3 != null && (r3.toString() === i2.toString() && (o2 = e3), !!o2);
    }), o2;
  }
  getFieldDomain(e2, r2) {
    const t2 = r2 && r2.feature, i2 = this.getFeatureType(t2);
    if (i2) {
      const r3 = i2.domains && i2.domains[e2];
      if (r3 && r3.type !== "inherited")
        return r3;
    }
    return this._getLayerDomain(e2);
  }
  async queryFeatures(e2 = this.createQuery(), r2) {
    var _a2, _b2, _c2, _d2, _e3, _f2;
    if (await this.load(), !((_b2 = (_a2 = this.capabilities) == null ? void 0 : _a2.operations) == null ? void 0 : _b2.supportsQuery))
      throw new s$2u("Sublayer.queryFeatures", "this layer doesn't support queries.");
    const [{ executeQuery: t2 }, { default: i2 }] = await Promise.all([Promise.resolve().then(function() {
      return query$1;
    }), Promise.resolve().then(function() {
      return FeatureSet;
    })]), o2 = await t2(this.url, x$z.from(e2), (_d2 = (_c2 = this.layer) == null ? void 0 : _c2.spatialReference) != null ? _d2 : null, __spreadProps(__spreadValues({}, r2), { query: __spreadProps(__spreadValues({}, (_e3 = this.layer) == null ? void 0 : _e3.customParameters), { token: (_f2 = this.layer) == null ? void 0 : _f2.apiKey }) })), a2 = i2.fromJSON(o2.data);
    if (a2 == null ? void 0 : a2.features)
      for (const s2 of a2.features)
        s2.sourceLayer = this;
    return a2;
  }
  toExportImageJSON(e2) {
    var _a2;
    const r2 = { id: this.id, source: ((_a2 = this.source) == null ? void 0 : _a2.toJSON()) || { mapLayerId: this.id, type: "mapLayer" } }, t2 = t$14(e2, this.definitionExpression);
    r$1$(t2) && (r2.definitionExpression = t2);
    const i2 = ["renderer", "labelingInfo", "opacity", "labelsVisible"].reduce((e3, r3) => (e3[r3] = this.originIdOf(r3), e3), {}), o2 = Object.keys(i2).some((e3) => i2[e3] > r$1U.SERVICE);
    if (o2) {
      const e3 = r2.drawingInfo = {};
      if (i2.renderer > r$1U.SERVICE && (e3.renderer = this.renderer ? this.renderer.toJSON() : null), i2.labelsVisible > r$1U.SERVICE && (e3.showLabels = this.labelsVisible), this.labelsVisible && i2.labelingInfo > r$1U.SERVICE) {
        !this.loaded && this.labelingInfo.some((e4) => !e4.labelPlacement) && s$2z.getLogger(this.declaredClass).warnOnce(`A Sublayer (title: ${this.title}, id: ${this.id}) has an undefined 'labelPlacement' and so labels cannot be displayed. Either define a valid 'labelPlacement' or call Sublayer.load() to use a default value based on geometry type.`, { sublayer: this });
        let r3 = this.labelingInfo;
        r$1$(this.geometryType) && (r3 = c$16(this.labelingInfo, i$2T.toJSON(this.geometryType))), e3.labelingInfo = r3.filter((e4) => e4.labelPlacement).map((e4) => e4.toJSON({ origin: "service", layer: this.layer })), e3.showLabels = true;
      }
      i2.opacity > r$1U.SERVICE && (e3.transparency = 100 - 100 * this.opacity), this._assignDefaultSymbolColors(e3.renderer);
    }
    return r2;
  }
  _assignDefaultSymbolColors(e2) {
    this._forEachSimpleMarkerSymbols(e2, (e3) => {
      e3.color || e3.style !== "esriSMSX" && e3.style !== "esriSMSCross" || (e3.outline && e3.outline.color ? e3.color = e3.outline.color : e3.color = [0, 0, 0, 0]);
    });
  }
  _forEachSimpleMarkerSymbols(e2, r2) {
    if (e2) {
      const t2 = "uniqueValueInfos" in e2 ? e2.uniqueValueInfos : "classBreakInfos" in e2 ? e2.classBreakInfos : [];
      for (const e3 of t2)
        J$6(e3.symbol) && r2(e3.symbol);
      "symbol" in e2 && J$6(e2.symbol) && r2(e2.symbol), "defaultSymbol" in e2 && J$6(e2.defaultSymbol) && r2(e2.defaultSymbol);
    }
  }
  _setAndNotifyLayer(e2, r2) {
    const t2 = this.layer, i2 = this._get(e2);
    let o2, a2;
    switch (e2) {
      case "definitionExpression":
      case "floorInfo":
        o2 = "supportsSublayerDefinitionExpression";
      case "minScale":
      case "maxScale":
      case "visible":
        o2 = "supportsSublayerVisibility";
        break;
      case "labelingInfo":
      case "labelsVisible":
      case "opacity":
      case "renderer":
      case "source":
        o2 = "supportsDynamicLayers", a2 = "supportsModification";
    }
    const s2 = e$2a(this).getDefaultOrigin();
    if (s2 !== "service") {
      if (o2 && this.get(`layer.capabilities.exportMap.${o2}`) === false)
        return void this._logLockedError(e2, `capability not available 'layer.capabilities.exportMap.${o2}'`);
      if (a2 && this.get(`capabilities.exportMap.${a2}`) === false)
        return void this._logLockedError(e2, `capability not available 'capabilities.exportMap.${a2}'`);
    }
    e2 !== "source" || this.loadStatus === "not-loaded" ? (this._set(e2, r2), s2 !== "service" && i2 !== r2 && t2 && t2.emit && t2.emit("sublayer-update", { propertyName: e2, target: this })) : this._logLockedError(e2, "'source' can't be changed after calling sublayer.load()");
  }
  _handleSublayersChange(e2, r2) {
    r2 && (r2.forEach((e3) => {
      e3.parent = null, e3.layer = null;
    }), this.handles.removeAll()), e2 && (e2.forEach((e3) => {
      e3.parent = this, e3.layer = this.layer;
    }), this.handles.add([e2.on("after-add", ({ item: e3 }) => {
      e3.parent = this, e3.layer = this.layer;
    }), e2.on("after-remove", ({ item: e3 }) => {
      e3.parent = null, e3.layer = null;
    }), e2.on("before-changes", (e3) => {
      const r3 = this.get("layer.capabilities.exportMap.supportsSublayersChanges");
      r3 == null || r3 || (s$2z.getLogger(this.declaredClass).error(new s$2u("sublayer:sublayers-non-modifiable", "Sublayer can't be added, moved, or removed from the layer's sublayers", { sublayer: this, layer: this.layer })), e3.preventDefault());
    })]));
  }
  _logLockedError(e2, r2) {
    s$2z.getLogger(this.declaredClass).error(new s$2u("sublayer:locked", `Property '${String(e2)}' can't be changed on Sublayer from the layer '${this.layer.id}'`, { reason: r2, sublayer: this, layer: this.layer }));
  }
  _getLayerDomain(e2) {
    const r2 = this.fieldsIndex.get(e2);
    return r2 ? r2.domain : null;
  }
};
X$2.test = { isMapImageLayerOverridePolicy: (e2) => e2 === G$5 || e2 === B$4, isTileImageLayerOverridePolicy: (e2) => e2 === Q$4 }, e$2g([y$1I({ readOnly: true })], X$2.prototype, "capabilities", void 0), e$2g([o$29("service", "capabilities", ["layerDefinition.canModifyLayer", "layerDefinition.capabilities"])], X$2.prototype, "readCapabilities", null), e$2g([y$1I({ type: String, value: null, json: { name: "layerDefinition.definitionExpression", write: { allowNull: true, overridePolicy: B$4 } } })], X$2.prototype, "definitionExpression", null), e$2g([y$1I({ type: [y$Y], json: { origins: { service: { read: { source: "layerDefinition.fields" } } } } })], X$2.prototype, "fields", void 0), e$2g([y$1I({ readOnly: true })], X$2.prototype, "fieldsIndex", null), e$2g([y$1I({ type: p$1o, value: null, json: { name: "layerDefinition.floorInfo", read: { source: "layerDefinition.floorInfo" }, write: { target: "layerDefinition.floorInfo", overridePolicy: B$4 }, origins: { "web-scene": { read: false, write: false } } } })], X$2.prototype, "floorInfo", null), e$2g([y$1I({ type: w$Z, json: { read: { source: "layerDefinition.extent" } } })], X$2.prototype, "fullExtent", void 0), e$2g([y$1I({ type: i$2T.apiValues, json: { origins: { service: { name: "layerDefinition.geometryType", read: { reader: i$2T.read } } } } })], X$2.prototype, "geometryType", void 0), e$2g([y$1I({ type: String })], X$2.prototype, "globalIdField", void 0), e$2g([o$29("service", "globalIdField", ["layerDefinition.globalIdField", "layerDefinition.fields"])], X$2.prototype, "readGlobalIdFieldFromService", null), e$2g([y$1I({ type: T$G, json: { write: { ignoreOrigin: true } } })], X$2.prototype, "id", null), e$2g([y$1I({ value: null, type: [j$j], json: { read: { source: "layerDefinition.drawingInfo.labelingInfo" }, write: { target: "layerDefinition.drawingInfo.labelingInfo", overridePolicy: G$5 } } })], X$2.prototype, "labelingInfo", null), e$2g([r$1P("labelingInfo")], X$2.prototype, "writeLabelingInfo", null), e$2g([y$1I({ type: Boolean, value: true, json: { read: { source: "layerDefinition.drawingInfo.showLabels" }, write: { target: "layerDefinition.drawingInfo.showLabels", overridePolicy: G$5 } } })], X$2.prototype, "labelsVisible", null), e$2g([y$1I({ value: null })], X$2.prototype, "layer", null), e$2g([y$1I({ type: Boolean, value: true, json: { origins: { service: { read: { enabled: false } } }, read: { source: "showLegend" }, write: { target: "showLegend", overridePolicy: H$2 } } })], X$2.prototype, "legendEnabled", void 0), e$2g([y$1I({ type: ["show", "hide", "hide-children"], value: "show", json: { read: false, write: false, origins: { "web-scene": { read: true, write: true } } } })], X$2.prototype, "listMode", null), e$2g([y$1I({ type: Number, value: 0, json: { write: { overridePolicy: G$5 } } })], X$2.prototype, "minScale", null), e$2g([o$29("minScale", ["minScale", "layerDefinition.minScale"])], X$2.prototype, "readMinScale", null), e$2g([y$1I({ type: Number, value: 0, json: { write: { overridePolicy: G$5 } } })], X$2.prototype, "maxScale", null), e$2g([o$29("maxScale", ["maxScale", "layerDefinition.maxScale"])], X$2.prototype, "readMaxScale", null), e$2g([y$1I({ readOnly: true })], X$2.prototype, "effectiveScaleRange", null), e$2g([y$1I({ type: String })], X$2.prototype, "objectIdField", void 0), e$2g([o$29("service", "objectIdField", ["layerDefinition.objectIdField", "layerDefinition.fields"])], X$2.prototype, "readObjectIdFieldFromService", null), e$2g([y$1I({ type: Number, value: 1, json: { write: { target: "layerDefinition.drawingInfo.transparency", overridePolicy: G$5 } } })], X$2.prototype, "opacity", null), e$2g([o$29("opacity", ["layerDefinition.drawingInfo.transparency", "layerDefinition.transparency"])], X$2.prototype, "readOpacity", null), e$2g([r$1P("opacity")], X$2.prototype, "writeOpacity", null), e$2g([y$1I({ json: { type: T$G, write: { target: "parentLayerId", writerEnsuresNonNull: true, overridePolicy: G$5 } } })], X$2.prototype, "parent", void 0), e$2g([r$1P("parent")], X$2.prototype, "writeParent", null), e$2g([y$1I({ type: Boolean, value: true, json: { read: { source: "disablePopup", reader: (e2, r2) => !r2.disablePopup }, write: { target: "disablePopup", overridePolicy: H$2, writer(e2, r2, t2) {
  r2[t2] = !e2;
} } } })], X$2.prototype, "popupEnabled", void 0), e$2g([y$1I({ type: k$B, json: { read: { source: "popupInfo" }, write: { target: "popupInfo", overridePolicy: H$2 } } })], X$2.prototype, "popupTemplate", void 0), e$2g([y$1I({ readOnly: true })], X$2.prototype, "defaultPopupTemplate", null), e$2g([y$1I({ types: p$1I, value: null, json: { name: "layerDefinition.drawingInfo.renderer", write: { overridePolicy: G$5 }, origins: { "web-scene": { types: n$1r, name: "layerDefinition.drawingInfo.renderer", write: { overridePolicy: G$5 } } } } })], X$2.prototype, "renderer", null), e$2g([y$1I({ types: { key: "type", base: null, typeMap: { "data-layer": K$c, "map-layer": c$1T } }, cast(e2) {
  if (e2) {
    if ("mapLayerId" in e2)
      return v$1c(c$1T, e2);
    if ("dataSource" in e2)
      return v$1c(K$c, e2);
  }
  return e2;
}, json: { name: "layerDefinition.source", write: { overridePolicy: G$5 } } })], X$2.prototype, "source", null), e$2g([y$1I()], X$2.prototype, "sourceJSON", void 0), e$2g([y$1I({ value: null, json: { type: [T$G], write: { target: "subLayerIds", allowNull: true, overridePolicy: G$5 } } })], X$2.prototype, "sublayers", null), e$2g([s$2i("sublayers")], X$2.prototype, "castSublayers", null), e$2g([r$1P("sublayers")], X$2.prototype, "writeSublayers", null), e$2g([y$1I({ type: String, json: { name: "name", write: { overridePolicy: H$2 } } })], X$2.prototype, "title", void 0), e$2g([y$1I({ type: String })], X$2.prototype, "typeIdField", void 0), e$2g([o$29("typeIdField", ["layerDefinition.typeIdField"])], X$2.prototype, "readTypeIdField", null), e$2g([y$1I({ type: [n$17], json: { origins: { service: { read: { source: "layerDefinition.types" } } } } })], X$2.prototype, "types", void 0), e$2g([y$1I({ type: String, json: { read: { source: "layerUrl" }, write: { target: "layerUrl", overridePolicy: Q$4 } } })], X$2.prototype, "url", null), e$2g([y$1I({ type: Boolean, value: true, json: { read: { source: "defaultVisibility" }, write: { target: "defaultVisibility", overridePolicy: G$5 } } })], X$2.prototype, "visible", null), e$2g([r$1P("visible")], X$2.prototype, "writeVisible", null), X$2 = $$1 = e$2g([n$2P("esri.layers.support.Sublayer")], X$2);
const z$6 = X$2;
const f$b = s$2z.getLogger("esri.layers.TileLayer");
function S$4(e2, r2) {
  const s2 = [], t2 = {};
  return e2 ? (e2.forEach((e3) => {
    const o2 = new z$6();
    if (o2.read(e3, r2), t2[o2.id] = o2, e3.parentLayerId != null && e3.parentLayerId !== -1) {
      const r3 = t2[e3.parentLayerId];
      r3.sublayers || (r3.sublayers = []), r3.sublayers.unshift(o2);
    } else
      s2.unshift(o2);
  }), s2) : s2;
}
const h$a = j$V.ofType(z$6);
function m$n(e2, r2) {
  e2 && e2.forEach((e3) => {
    r2(e3), e3.sublayers && e3.sublayers.length && m$n(e3.sublayers, r2);
  });
}
const E$7 = (o2) => {
  let E2 = class extends o2 {
    constructor(...e2) {
      super(...e2), this.allSublayers = new l$1Q({ getCollections: () => [this.sublayers], getChildrenFunction: (e3) => e3.sublayers }), this.sublayersSourceJSON = { [r$1U.SERVICE]: {}, [r$1U.PORTAL_ITEM]: {}, [r$1U.WEB_SCENE]: {}, [r$1U.WEB_MAP]: {} }, this.addHandles(l$1P(() => this.sublayers, (e3, r2) => this._handleSublayersChange(e3, r2), U$r));
    }
    readSublayers(e2, r2) {
      if (!r2 || !e2)
        return;
      const { sublayersSourceJSON: s2 } = this, t2 = t$2e(r2.origin);
      if (t2 < r$1U.SERVICE)
        return;
      if (s2[t2] = { context: r2, visibleLayers: e2.visibleLayers || s2[t2].visibleLayers, layers: e2.layers || s2[t2].layers }, t2 > r$1U.SERVICE)
        return;
      this._set("serviceSublayers", this.createSublayersForOrigin("service").sublayers);
      const { sublayers: o3, origin: a2 } = this.createSublayersForOrigin("web-document"), l2 = e$2a(this);
      l2.setDefaultOrigin(a2), this._set("sublayers", new h$a(o3)), l2.setDefaultOrigin("user");
    }
    findSublayerById(e2) {
      return this.allSublayers.find((r2) => r2.id === e2);
    }
    createServiceSublayers() {
      return this.createSublayersForOrigin("service").sublayers;
    }
    createSublayersForOrigin(e2) {
      const r2 = t$2e(e2 === "web-document" ? "web-map" : e2);
      let s2 = r$1U.SERVICE, t2 = this.sublayersSourceJSON[r$1U.SERVICE].layers, o3 = this.sublayersSourceJSON[r$1U.SERVICE].context, a2 = null;
      const l2 = [r$1U.PORTAL_ITEM, r$1U.WEB_SCENE, r$1U.WEB_MAP].filter((e3) => e3 <= r2);
      for (const y2 of l2) {
        const e3 = this.sublayersSourceJSON[y2];
        t$s(e3.layers) && (s2 = y2, t2 = e3.layers, o3 = e3.context, e3.visibleLayers && (a2 = { visibleLayers: e3.visibleLayers, context: e3.context }));
      }
      const i2 = [r$1U.PORTAL_ITEM, r$1U.WEB_SCENE, r$1U.WEB_MAP].filter((e3) => e3 > s2 && e3 <= r2);
      let n2 = null;
      for (const y2 of i2) {
        const { layers: e3, visibleLayers: r3, context: s3 } = this.sublayersSourceJSON[y2];
        e3 && (n2 = { layers: e3, context: s3 }), r3 && (a2 = { visibleLayers: r3, context: s3 });
      }
      const u2 = S$4(t2, o3), p2 = new Map(), f2 = new Set();
      if (n2)
        for (const y2 of n2.layers)
          p2.set(y2.id, y2);
      if (a2)
        for (const y2 of a2.visibleLayers)
          f2.add(y2);
      return m$n(u2, (e3) => {
        n2 && e3.read(p2.get(e3.id), n2.context), a2 && e3.read({ defaultVisibility: f2.has(e3.id) }, a2.context);
      }), { origin: n$2N(s2), sublayers: new h$a({ items: u2 }) };
    }
    read(e2, r2) {
      super.read(e2, r2), this.readSublayers(e2, r2);
    }
    _handleSublayersChange(e2, r2) {
      r2 && (r2.forEach((e3) => {
        e3.parent = null, e3.layer = null;
      }), this.handles.remove("sublayers-owner")), e2 && (e2.forEach((e3) => {
        e3.parent = this, e3.layer = this;
      }), this.handles.add([e2.on("after-add", ({ item: e3 }) => {
        e3.parent = this, e3.layer = this;
      }), e2.on("after-remove", ({ item: e3 }) => {
        e3.parent = null, e3.layer = null;
      })], "sublayers-owner"), this.type === "tile" && this.handles.add(e2.on("before-changes", (e3) => {
        f$b.error(new s$2u("tilelayer:sublayers-non-modifiable", "ISublayer can't be added, moved, or removed from the layer's sublayers", { layer: this })), e3.preventDefault();
      }), "sublayers-owner"));
    }
  };
  return e$2g([y$1I({ readOnly: true })], E2.prototype, "allSublayers", void 0), e$2g([y$1I({ readOnly: true, type: j$V.ofType(z$6) })], E2.prototype, "serviceSublayers", void 0), e$2g([y$1I({ value: null, type: h$a, json: { read: false, write: { allowNull: true, ignoreOrigin: true } } })], E2.prototype, "sublayers", void 0), e$2g([y$1I({ readOnly: true })], E2.prototype, "sublayersSourceJSON", void 0), E2 = e$2g([n$2P("esri.layers.mixins.SublayersOwner")], E2), E2;
};
const m$m = { visible: "visibleSublayers", definitionExpression: "layerDefs", labelingInfo: "hasDynamicLayers", labelsVisible: "hasDynamicLayers", opacity: "hasDynamicLayers", minScale: "visibleSublayers", maxScale: "visibleSublayers", renderer: "hasDynamicLayers", source: "hasDynamicLayers" };
let c$c = class extends a$1W(m$2q) {
  constructor(e2) {
    super(e2), this.floors = null, this.scale = 0;
  }
  destroy() {
    this.layer = null;
  }
  get dynamicLayers() {
    if (!this.hasDynamicLayers)
      return null;
    const e2 = this.visibleSublayers.map((e3) => {
      const r2 = n$y(this.floors, e3);
      return e3.toExportImageJSON(r2);
    });
    return e2.length ? JSON.stringify(e2) : null;
  }
  get hasDynamicLayers() {
    return this.layer && i$E(this.visibleSublayers, this.layer.serviceSublayers, this.layer.gdbVersion);
  }
  set layer(e2) {
    this._get("layer") !== e2 && (this._set("layer", e2), this.handles.remove("layer"), e2 && this.handles.add([e2.allSublayers.on("change", () => this.notifyChange("visibleSublayers")), e2.on("sublayer-update", (e3) => this.notifyChange(m$m[e3.propertyName]))], "layer"));
  }
  get layers() {
    const e2 = this.visibleSublayers;
    return e2 ? e2.length ? "show:" + e2.map((e3) => e3.id).join(",") : "show:-1" : null;
  }
  get layerDefs() {
    var _a2;
    const e2 = !!((_a2 = this.floors) == null ? void 0 : _a2.length), r2 = this.visibleSublayers.filter((r3) => r3.definitionExpression != null || e2 && r3.floorInfo != null);
    return r2.length ? JSON.stringify(r2.reduce((e3, r3) => {
      const s2 = n$y(this.floors, r3), o2 = t$14(s2, r3.definitionExpression);
      return r$1$(o2) && (e3[r3.id] = o2), e3;
    }, {})) : null;
  }
  get version() {
    this.commitProperty("layers"), this.commitProperty("layerDefs"), this.commitProperty("dynamicLayers"), this.commitProperty("timeExtent");
    const e2 = this.layer;
    return e2 && (e2.commitProperty("dpi"), e2.commitProperty("imageFormat"), e2.commitProperty("imageTransparency"), e2.commitProperty("gdbVersion")), (this._get("version") || 0) + 1;
  }
  get visibleSublayers() {
    const e2 = [];
    if (!this.layer)
      return e2;
    const r2 = this.layer.sublayers, s2 = (r3) => {
      const t3 = this.scale, i2 = t3 === 0, o2 = r3.minScale === 0 || t3 <= r3.minScale, a2 = r3.maxScale === 0 || t3 >= r3.maxScale;
      r3.visible && (i2 || o2 && a2) && (r3.sublayers ? r3.sublayers.forEach(s2) : e2.unshift(r3));
    };
    r2 && r2.forEach(s2);
    const t2 = this._get("visibleSublayers");
    return !t2 || t2.length !== e2.length || t2.some((r3, s3) => e2[s3] !== r3) ? e2 : t2;
  }
  toJSON() {
    const e2 = this.layer;
    let r2 = { dpi: e2.dpi, format: e2.imageFormat, transparent: e2.imageTransparency, gdbVersion: e2.gdbVersion || null };
    return this.hasDynamicLayers && this.dynamicLayers ? r2.dynamicLayers = this.dynamicLayers : r2 = __spreadProps(__spreadValues({}, r2), { layers: this.layers, layerDefs: this.layerDefs }), r2;
  }
};
e$2g([y$1I({ readOnly: true })], c$c.prototype, "dynamicLayers", null), e$2g([y$1I()], c$c.prototype, "floors", void 0), e$2g([y$1I({ readOnly: true })], c$c.prototype, "hasDynamicLayers", null), e$2g([y$1I()], c$c.prototype, "layer", null), e$2g([y$1I({ readOnly: true })], c$c.prototype, "layers", null), e$2g([y$1I({ readOnly: true })], c$c.prototype, "layerDefs", null), e$2g([y$1I({ type: Number })], c$c.prototype, "scale", void 0), e$2g([y$1I(g$C)], c$c.prototype, "timeExtent", void 0), e$2g([y$1I({ readOnly: true })], c$c.prototype, "version", null), e$2g([y$1I({ readOnly: true })], c$c.prototype, "visibleSublayers", null), c$c = e$2g([n$2P("esri.layers.mixins.ExportImageParameters")], c$c);
let q$4 = class extends n$1l(a$1a(t$X(E$7(y$6(p$1v(c$1d(v$u(O$k(p$1e(i$1s(o$13(a$1W(b$y))))))))))))) {
  constructor(...e2) {
    super(...e2), this.datesInUnknownTimezone = false, this.dpi = 96, this.gdbVersion = null, this.imageFormat = "png24", this.imageMaxHeight = 2048, this.imageMaxWidth = 2048, this.imageTransparency = true, this.isReference = null, this.labelsVisible = false, this.operationalLayerType = "ArcGISMapServiceLayer", this.sourceJSON = null, this.sublayers = null, this.type = "map-image", this.url = null;
  }
  normalizeCtorArgs(e2, r2) {
    return typeof e2 == "string" ? __spreadValues({ url: e2 }, r2) : e2;
  }
  load(e2) {
    const r2 = r$1$(e2) ? e2.signal : null;
    return this.addResolvingPromise(this.loadFromPortal({ supportedTypes: ["Map Service"] }, e2).catch(w$12).then(() => this._fetchService(r2))), Promise.resolve(this);
  }
  readImageFormat(e2, r2) {
    const t2 = r2.supportedImageFormatTypes;
    return t2 && t2.includes("PNG32") ? "png32" : "png24";
  }
  writeSublayers(e2, r2, t2, o2) {
    if (!this.loaded || !e2)
      return;
    const i2 = e2.slice().reverse().flatten(({ sublayers: e3 }) => e3 && e3.toArray().reverse()).toArray();
    let s2 = false;
    if (this.capabilities && this.capabilities.operations.supportsExportMap && this.capabilities.exportMap.supportsDynamicLayers) {
      const e3 = t$2e(o2.origin);
      if (e3 === r$1U.PORTAL_ITEM) {
        const e4 = this.createSublayersForOrigin("service").sublayers;
        s2 = n$x(i2, e4, r$1U.SERVICE);
      } else if (e3 > r$1U.PORTAL_ITEM) {
        const e4 = this.createSublayersForOrigin("portal-item");
        s2 = n$x(i2, e4.sublayers, t$2e(e4.origin));
      }
    }
    const a2 = [], p2 = __spreadValues({ writeSublayerStructure: s2 }, o2);
    let n2 = s2;
    i2.forEach((e3) => {
      const r3 = e3.write({}, p2);
      a2.push(r3), n2 = n2 || e3.originOf("visible") === "user";
    });
    a2.some((e3) => Object.keys(e3).length > 1) && (r2.layers = a2), n2 && (r2.visibleLayers = i2.filter((e3) => e3.visible).map((e3) => e3.id));
  }
  createExportImageParameters(e2, r2, t2, o2) {
    const i2 = o2 && o2.pixelRatio || 1;
    e2 && this.version >= 10 && (e2 = e2.clone().shiftCentralMeridian());
    const s2 = new c$c({ layer: this, floors: o2 == null ? void 0 : o2.floors, scale: i$F({ extent: e2, width: r2 }) * i2 }), a2 = s2.toJSON();
    s2.destroy();
    const p2 = !o2 || !o2.rotation || this.version < 10.3 ? {} : { rotation: -o2.rotation }, n2 = e2 && e2.spatialReference, m2 = n2.wkid || JSON.stringify(n2.toJSON());
    a2.dpi *= i2;
    const l2 = {};
    if (o2 == null ? void 0 : o2.timeExtent) {
      const { start: e3, end: r3 } = o2.timeExtent.toJSON();
      l2.time = e3 && r3 && e3 === r3 ? "" + e3 : `${e3 != null ? e3 : "null"},${r3 != null ? r3 : "null"}`;
    } else
      this.timeInfo && !this.timeInfo.hasLiveData && (l2.time = "null,null");
    return __spreadValues(__spreadValues(__spreadValues({ bbox: e2 && e2.xmin + "," + e2.ymin + "," + e2.xmax + "," + e2.ymax, bboxSR: m2, imageSR: m2, size: r2 + "," + t2 }, a2), p2), l2);
  }
  async fetchImage(e2, r2, t2, o2) {
    return this._fetchImage("image", e2, r2, t2, o2);
  }
  async fetchImageBitmap(e2, r2, t2, o2) {
    const i2 = await this._fetchImage("blob", e2, r2, t2, o2);
    return createImageBitmap(i2);
  }
  async fetchRecomputedExtents(e2 = {}) {
    const o2 = __spreadProps(__spreadValues({}, e2), { query: __spreadProps(__spreadValues({ returnUpdates: true, f: "json" }, this.customParameters), { token: this.apiKey }) }), { data: i2 } = await U$t(this.url, o2), { extent: s2, fullExtent: a2, timeExtent: p2 } = i2, n2 = s2 || a2;
    return { fullExtent: n2 && w$Z.fromJSON(n2), timeExtent: p2 && T$o.fromJSON({ start: p2[0], end: p2[1] }) };
  }
  loadAll() {
    return n$10(this, (e2) => {
      e2(this.allSublayers);
    });
  }
  serviceSupportsSpatialReference(e2) {
    return e$L(this, e2);
  }
  async _fetchImage(e2, t2, i2, s2, a2) {
    var _a2;
    const p2 = { responseType: e2, signal: (_a2 = a2 == null ? void 0 : a2.signal) != null ? _a2 : null, query: __spreadProps(__spreadValues(__spreadValues(__spreadProps(__spreadValues(__spreadValues({}, this.parsedUrl.query), this.createExportImageParameters(t2, i2, s2, a2)), { f: "image" }), this.refreshParameters), this.customParameters), { token: this.apiKey }) }, n2 = this.parsedUrl.path + "/export";
    if (p2.query.dynamicLayers != null && !this.capabilities.exportMap.supportsDynamicLayers)
      throw new s$2u("mapimagelayer:dynamiclayer-not-supported", `service ${this.url} doesn't support dynamic layers, which is required to be able to change the sublayer's order, rendering, labeling or source.`, { query: p2.query });
    try {
      const { data: e3 } = await U$t(n2, p2);
      return e3;
    } catch (l2) {
      if (j$_(l2))
        throw l2;
      throw new s$2u("mapimagelayer:image-fetch-error", `Unable to load image: ${n2}`, { error: l2 });
    }
  }
  async _fetchService(e2) {
    if (this.sourceJSON)
      return void this.read(this.sourceJSON, { origin: "service", url: this.parsedUrl });
    const { data: t2, ssl: o2 } = await U$t(this.parsedUrl.path, { query: __spreadProps(__spreadValues(__spreadValues({ f: "json" }, this.parsedUrl.query), this.customParameters), { token: this.apiKey }), signal: e2 });
    o2 && (this.url = this.url.replace(/^http:/i, "https:")), this.sourceJSON = t2, this.read(t2, { origin: "service", url: this.parsedUrl });
  }
};
e$2g([y$1I({ type: Boolean })], q$4.prototype, "datesInUnknownTimezone", void 0), e$2g([y$1I()], q$4.prototype, "dpi", void 0), e$2g([y$1I()], q$4.prototype, "gdbVersion", void 0), e$2g([y$1I()], q$4.prototype, "imageFormat", void 0), e$2g([o$29("imageFormat", ["supportedImageFormatTypes"])], q$4.prototype, "readImageFormat", null), e$2g([y$1I({ json: { origins: { service: { read: { source: "maxImageHeight" } } } } })], q$4.prototype, "imageMaxHeight", void 0), e$2g([y$1I({ json: { origins: { service: { read: { source: "maxImageWidth" } } } } })], q$4.prototype, "imageMaxWidth", void 0), e$2g([y$1I()], q$4.prototype, "imageTransparency", void 0), e$2g([y$1I({ type: Boolean, json: { read: false, write: { enabled: true, overridePolicy: () => ({ enabled: false }) } } })], q$4.prototype, "isReference", void 0), e$2g([y$1I({ json: { read: false, write: false } })], q$4.prototype, "labelsVisible", void 0), e$2g([y$1I({ type: ["ArcGISMapServiceLayer"] })], q$4.prototype, "operationalLayerType", void 0), e$2g([y$1I({ json: { read: false, write: false } })], q$4.prototype, "popupEnabled", void 0), e$2g([y$1I()], q$4.prototype, "sourceJSON", void 0), e$2g([y$1I({ json: { write: { ignoreOrigin: true } } })], q$4.prototype, "sublayers", void 0), e$2g([r$1P("sublayers", { layers: { type: [z$6] }, visibleLayers: { type: [T$G] } })], q$4.prototype, "writeSublayers", null), e$2g([y$1I({ type: ["show", "hide", "hide-children"] })], q$4.prototype, "listMode", void 0), e$2g([y$1I({ json: { read: false }, readOnly: true, value: "map-image" })], q$4.prototype, "type", void 0), e$2g([y$1I(f$P)], q$4.prototype, "url", void 0), q$4 = e$2g([n$2P("esri.layers.MapImageLayer")], q$4);
const F$6 = q$4;
var MapImageLayer = /* @__PURE__ */ Object.freeze({
  __proto__: null,
  [Symbol.toStringTag]: "Module",
  "default": F$6
});
async function o$d(o2, s2, e2) {
  const a2 = f$19(o2), u2 = __spreadValues(__spreadProps(__spreadValues({}, a2.query), { f: "json" }), s2.toJSON()), f2 = i$1V(u2, e2);
  return U$t(a2.path + "/areasAndLengths", f2).then((t2) => t2.data);
}
async function i$j(i2, n2, m2, p2) {
  const g2 = n2[0].spatialReference, f2 = f$19(i2), a2 = __spreadProps(__spreadValues({}, f2.query), { f: "json", sr: JSON.stringify(g2.toJSON()), polygons: JSON.stringify(r$16(n2).geometries), polylines: JSON.stringify(r$16(m2).geometries) }), y2 = i$1V(a2, p2);
  return U$t(f2.path + "/autoComplete", y2).then(({ data: e2 }) => (e2.geometries || []).map(({ rings: e3 }) => new v$15({ spatialReference: g2, rings: e3 })));
}
async function s$a(s2, n2, i2) {
  const m2 = f$19(s2), a2 = __spreadValues(__spreadProps(__spreadValues({}, m2.query), { f: "json" }), n2.toJSON()), f2 = n2.outSpatialReference || n2.geometries[0].spatialReference, p2 = i$1V(a2, i2);
  return U$t(m2.path + "/buffer", p2).then((e2) => (e2.data.geometries || []).map(({ rings: e3 }) => new v$15({ spatialReference: f2, rings: e3 })));
}
async function i$i(i2, n2, m2) {
  const f2 = n2[0].spatialReference, p2 = f$19(i2), a2 = __spreadProps(__spreadValues({}, p2.query), { f: "json", sr: JSON.stringify(f2.toJSON()), geometries: JSON.stringify(r$16(n2)) }), u2 = i$1V(a2, m2);
  return U$t(p2.path + "/convexHull", u2).then(({ data: t2 }) => v$14(t2.geometry).set({ spatialReference: f2 }));
}
async function o$c(o2, i2, n2) {
  var _a2;
  const m2 = (_a2 = i2.geometries) == null ? void 0 : _a2[0].spatialReference, p2 = f$19(o2), a2 = __spreadValues(__spreadProps(__spreadValues({}, p2.query), { f: "json" }), i2.toJSON()), f2 = i$1V(a2, n2);
  return U$t(p2.path + "/densify", f2).then(({ data: e2 }) => (e2.geometries || []).map((e3) => v$14(e3).set({ spatialReference: m2 })));
}
async function i$h(i2, m2, n2, f2) {
  const p2 = m2[0].spatialReference, y2 = f$19(i2);
  let a2 = { query: __spreadProps(__spreadValues({}, y2.query), { f: "json", sr: JSON.stringify(p2.toJSON()), geometries: JSON.stringify(r$16(m2)), geometry: JSON.stringify({ geometryType: c$32(n2), geometry: n2.toJSON() }) }) };
  return f2 && (a2 = __spreadValues(__spreadValues({}, f2), a2)), U$t(y2.path + "/difference", a2).then(({ data: e2 }) => (e2.geometries || []).map((e3) => v$14(e3).set({ spatialReference: p2 })));
}
async function r$c(r2, s2, e2) {
  const a2 = f$19(r2), i2 = __spreadValues(__spreadProps(__spreadValues({}, a2.query), { f: "json" }), s2.toJSON()), c2 = i$1V(i2, e2);
  return U$t(a2.path + "/distance", c2).then(({ data: t2 }) => t2 && t2.distance);
}
const _$6 = new s$2a({ MGRS: "mgrs", USNG: "usng", UTM: "utm", GeoRef: "geo-ref", GARS: "gars", DMS: "dms", DDM: "ddm", DD: "dd" }), N$6 = { UNIT_METER: 9001, UNIT_GERMAN_METER: 9031, UNIT_FOOT: 9002, UNIT_SURVEY_FOOT: 9003, UNIT_CLARKE_FOOT: 9005, UNIT_FATHOM: 9014, UNIT_NAUTICAL_MILE: 9030, UNIT_SURVEY_CHAIN: 9033, UNIT_SURVEY_LINK: 9034, UNIT_SURVEY_MILE: 9035, UNIT_KILOMETER: 9036, UNIT_CLARKE_YARD: 9037, UNIT_CLARKE_CHAIN: 9038, UNIT_CLARKE_LINK: 9039, UNIT_SEARS_YARD: 9040, UNIT_SEARS_FOOT: 9041, UNIT_SEARS_CHAIN: 9042, UNIT_SEARS_LINK: 9043, UNIT_BENOIT_1895A_YARD: 9050, UNIT_BENOIT_1895A_FOOT: 9051, UNIT_BENOIT_1895A_CHAIN: 9052, UNIT_BENOIT_1895A_LINK: 9053, UNIT_BENOIT_1895B_YARD: 9060, UNIT_BENOIT_1895B_FOOT: 9061, UNIT_BENOIT_1895B_CHAIN: 9062, UNIT_BENOIT_1895B_LINK: 9063, UNIT_INDIAN_FOOT: 9080, UNIT_INDIAN_1937_FOOT: 9081, UNIT_INDIAN_1962_FOOT: 9082, UNIT_INDIAN_1975_FOOT: 9083, UNIT_INDIAN_YARD: 9084, UNIT_INDIAN_1937_YARD: 9085, UNIT_INDIAN_1962_YARD: 9086, UNIT_INDIAN_1975_YARD: 9087, UNIT_FOOT_1865: 9070, UNIT_RADIAN: 9101, UNIT_DEGREE: 9102, UNIT_ARCMINUTE: 9103, UNIT_ARCSECOND: 9104, UNIT_GRAD: 9105, UNIT_GON: 9106, UNIT_MICRORADIAN: 9109, UNIT_ARCMINUTE_CENTESIMAL: 9112, UNIT_ARCSECOND_CENTESIMAL: 9113, UNIT_MIL6400: 9114, UNIT_BRITISH_1936_FOOT: 9095, UNIT_GOLDCOAST_FOOT: 9094, UNIT_INTERNATIONAL_CHAIN: 109003, UNIT_INTERNATIONAL_LINK: 109004, UNIT_INTERNATIONAL_YARD: 109001, UNIT_STATUTE_MILE: 9093, UNIT_SURVEY_YARD: 109002, UNIT_50KILOMETER_LENGTH: 109030, UNIT_150KILOMETER_LENGTH: 109031, UNIT_DECIMETER: 109005, UNIT_CENTIMETER: 109006, UNIT_MILLIMETER: 109007, UNIT_INTERNATIONAL_INCH: 109008, UNIT_US_SURVEY_INCH: 109009, UNIT_INTERNATIONAL_ROD: 109010, UNIT_US_SURVEY_ROD: 109011, UNIT_US_NAUTICAL_MILE: 109012, UNIT_UK_NAUTICAL_MILE: 109013, UNIT_SQUARE_INCHES: "esriSquareInches", UNIT_SQUARE_FEET: "esriSquareFeet", UNIT_SQUARE_YARDS: "esriSquareYards", UNIT_ACRES: "esriAcres", UNIT_SQUARE_MILES: "esriSquareMiles", UNIT_SQUARE_MILLIMETERS: "esriSquareMillimeters", UNIT_SQUARE_CENTIMETERS: "esriSquareCentimeters", UNIT_SQUARE_DECIMETERS: "esriSquareDecimeters", UNIT_SQUARE_METERS: "esriSquareMeters", UNIT_ARES: "esriAres", UNIT_HECTARES: "esriHectares", UNIT_SQUARE_KILOMETERS: "esriSquareKilometers" };
async function t$d(t2, i2, e2) {
  const c2 = {};
  i2.sr != null && typeof i2.sr == "object" ? c2.sr = i2.sr.wkid || JSON.stringify(i2.sr) : c2.sr = i2.sr, c2.strings = JSON.stringify(i2.strings);
  const f2 = i2.conversionType || "mgrs";
  c2.conversionType = _$6.toJSON(f2), c2.conversionMode = i2.conversionMode;
  const m2 = f$19(t2), p2 = __spreadValues(__spreadProps(__spreadValues({}, m2.query), { f: "json" }), c2), u2 = i$1V(p2, e2);
  return U$t(m2.path + "/fromGeoCoordinateString", u2).then(({ data: o2 }) => o2.coordinates);
}
const i$g = new s$2a({ 109006: "centimeters", 9102: "decimal-degrees", 109005: "decimeters", 9002: "feet", 109009: "inches", 9036: "kilometers", 9001: "meters", 9035: "miles", 109007: "millimeters", 109012: "nautical-miles", 9096: "yards" });
function r$b(e2) {
  const { geometries: r2, deviationUnit: s2, maxDeviation: o2 } = e2.toJSON(), n2 = { maxDeviation: o2 };
  return r2 && r2.length && (n2.geometries = JSON.stringify({ geometryType: c$32(r2[0]), geometries: r2 }), n2.sr = JSON.stringify(r2[0].spatialReference)), i$g.write(s2, n2, "deviationUnit"), n2;
}
let m$l = class extends l$2B {
  constructor(r2) {
    super(r2), this.deviationUnit = null, this.geometries = null, this.maxDeviation = null;
  }
};
e$2g([y$1I({ type: String, json: { write: true } })], m$l.prototype, "deviationUnit", void 0), e$2g([y$1I({ json: { read: { reader: (r2) => r2 ? r2.map((r3) => v$14(r3)).filter(r$1$) : null }, write: { writer: (r2, o2) => {
  var _a2;
  o2.geometries = (_a2 = r2 == null ? void 0 : r2.map((r3) => r3.toJSON())) != null ? _a2 : null;
} } } })], m$l.prototype, "geometries", void 0), e$2g([y$1I({ type: Number, json: { write: true } })], m$l.prototype, "maxDeviation", void 0), m$l = e$2g([n$2P("esri.rest.support.GeneralizeParameters")], m$l), m$l.from = b$1a(m$l);
const a$a = m$l;
async function m$k(m2, a2, p2) {
  const n2 = (a2 = a$a.from(a2)).toJSON(), f2 = r$b(a2), j2 = f$19(m2), l2 = __spreadValues(__spreadProps(__spreadValues({}, j2.query), { f: "json" }), f2), u2 = n2.geometries[0].spatialReference, c2 = i$1V(l2, p2);
  return U$t(j2.path + "/generalize", c2).then(({ data: e2 }) => (e2.geometries || []).map((e3) => v$14(e3).set({ spatialReference: u2 })));
}
async function m$j(m2, n2, p2, f2) {
  const y2 = n2[0].spatialReference, a2 = f$19(m2), g2 = __spreadProps(__spreadValues({}, a2.query), { f: "json", sr: JSON.stringify(y2.toJSON()), geometries: JSON.stringify(r$16(n2)), geometry: JSON.stringify({ geometryType: c$32(p2), geometry: p2.toJSON() }) }), u2 = i$1V(g2, f2);
  return U$t(a2.path + "/intersect", u2).then(({ data: e2 }) => (e2.geometries || []).map((e3) => v$14(e3).set({ spatialReference: y2 })));
}
function r$a(r2, i2, n2) {
  const p2 = i2.map((t2) => t2.toJSON()), a2 = i2[0].spatialReference, f2 = f$19(r2), l2 = __spreadProps(__spreadValues({}, f2.query), { f: "json", sr: a2.wkid ? a2.wkid : JSON.stringify(a2.toJSON()), polygons: JSON.stringify(p2) }), m2 = i$1V(l2, n2);
  return U$t(f2.path + "/labelPoints", m2).then(({ data: t2 }) => (t2.labelPoints || []).map((t3) => v$14(t3).set({ spatialReference: a2 })));
}
const n$i = new s$2a({ preserveShape: "preserve-shape" });
function o$b(e2) {
  const { polylines: o2, lengthUnit: t2, geodesic: i2, calculationType: s2 } = e2.toJSON(), r2 = {};
  r2.polylines = JSON.stringify(o2);
  const l2 = e2.polylines[0].spatialReference;
  return r2.sr = l2.wkid ? l2.wkid : JSON.stringify(l2.toJSON()), t2 && (r2.lengthUnit = t2), i2 && (r2.geodesic = i2), s2 && (r2.calculationType = n$i.toJSON(s2)), r2;
}
let l$e = class extends l$2B {
  constructor(o2) {
    super(o2), this.calculationType = null, this.geodesic = null, this.lengthUnit = null, this.polylines = null;
  }
};
e$2g([y$1I({ type: String, json: { write: true } })], l$e.prototype, "calculationType", void 0), e$2g([y$1I({ type: Boolean, json: { write: true } })], l$e.prototype, "geodesic", void 0), e$2g([y$1I({ json: { write: true } })], l$e.prototype, "lengthUnit", void 0), e$2g([y$1I({ type: [m$2i], json: { read: { reader: (o2) => o2 ? o2.map((o3) => v$14(o3)) : null }, write: { writer: (o2, r2) => {
  r2.polylines = o2.map((o3) => o3.toJSON());
} } } })], l$e.prototype, "polylines", void 0), l$e = e$2g([n$2P("esri.rest.support.LengthsParameters")], l$e), l$e.from = b$1a(l$e);
const n$h = l$e;
async function n$g(n2, m2, p2) {
  m2 = n$h.from(m2);
  const a2 = o$b(m2), f2 = f$19(n2), i2 = __spreadValues(__spreadProps(__spreadValues({}, f2.query), { f: "json" }), a2), u2 = i$1V(i2, p2);
  return U$t(f2.path + "/lengths", u2).then(({ data: t2 }) => t2);
}
const o$a = new s$2a({ esriGeometryOffsetBevelled: "bevelled", esriGeometryOffsetMitered: "mitered", esriGeometryOffsetRounded: "rounded" }), s$9 = new s$2a({ 9001: "meters", 9002: "feet", 9036: "kilometers", 9093: "miles", 109012: "nautical-miles", 109001: "yards" });
function r$9(e2) {
  const { geometries: r2, bevelRatio: i2, offsetDistance: f2, offsetHow: n2, offsetUnit: m2 } = e2.toJSON(), l2 = { bevelRatio: i2, offsetDistance: f2 };
  return r2 && r2.length && (l2.geometries = JSON.stringify({ geometryType: c$32(r2[0]), geometries: r2 }), l2.sr = JSON.stringify(r2[0].spatialReference)), n2 && (l2.offsetHow = o$a.toJSON(n2)), m2 && (l2.offsetUnit = s$9.toJSON(m2)), l2;
}
let m$i = class extends l$2B {
  constructor(o2) {
    super(o2), this.bevelRatio = null, this.geometries = null, this.offsetDistance = null, this.offsetHow = null, this.offsetUnit = null;
  }
};
e$2g([y$1I({ type: Number, json: { write: true } })], m$i.prototype, "bevelRatio", void 0), e$2g([y$1I({ json: { read: { reader: (o2) => o2 ? o2.map((o3) => v$14(o3)).filter(r$1$) : null }, write: { writer: (o2, t2) => {
  var _a2;
  t2.geometries = (_a2 = o2 == null ? void 0 : o2.map((o3) => o3.toJSON())) != null ? _a2 : null;
} } } })], m$i.prototype, "geometries", void 0), e$2g([y$1I({ type: Number, json: { write: true } })], m$i.prototype, "offsetDistance", void 0), e$2g([y$1I({ type: String, json: { write: true } })], m$i.prototype, "offsetHow", void 0), e$2g([y$1I({ type: String, json: { write: true } })], m$i.prototype, "offsetUnit", void 0), m$i = e$2g([n$2P("esri.rest.support.OffsetParameters")], m$i), m$i.from = b$1a(m$i);
const f$a = m$i;
async function m$h(m2, p2, i2) {
  var _a2;
  p2 = f$a.from(p2);
  const a2 = r$9(p2), n2 = f$19(m2), j2 = __spreadValues(__spreadProps(__spreadValues({}, n2.query), { f: "json" }), a2), u2 = (_a2 = p2.geometries) == null ? void 0 : _a2[0].spatialReference, c2 = i$1V(j2, i2);
  return U$t(n2.path + "/offset", c2).then(({ data: e2 }) => (e2.geometries || []).map((e3) => v$14(e3).set({ spatialReference: u2 })));
}
let i$f = class extends l$2B {
  constructor(r2) {
    super(r2), this.geometries = null, this.outSpatialReference = null, this.transformation = null, this.transformForward = null;
  }
  toJSON() {
    const r2 = this.geometries.map((r3) => r3.toJSON()), t2 = this.geometries[0], o2 = {};
    return o2.outSR = this.outSpatialReference.wkid || JSON.stringify(this.outSpatialReference.toJSON()), o2.inSR = t2.spatialReference.wkid || JSON.stringify(t2.spatialReference.toJSON()), o2.geometries = JSON.stringify({ geometryType: c$32(t2), geometries: r2 }), this.transformation && (o2.transformation = this.transformation.wkid || JSON.stringify(this.transformation)), this.transformForward != null && (o2.transformForward = this.transformForward), o2;
  }
};
e$2g([y$1I()], i$f.prototype, "geometries", void 0), e$2g([y$1I({ json: { read: { source: "outSR" } } })], i$f.prototype, "outSpatialReference", void 0), e$2g([y$1I()], i$f.prototype, "transformation", void 0), e$2g([y$1I()], i$f.prototype, "transformForward", void 0), i$f = e$2g([n$2P("esri.rest.support.ProjectParameters")], i$f);
const a$9 = i$f;
const i$e = b$1a(a$9);
async function n$f(o2, m2, n2) {
  m2 = i$e(m2);
  const u2 = f$19(o2), c2 = __spreadValues(__spreadProps(__spreadValues({}, u2.query), { f: "json" }), m2.toJSON()), j2 = m2.outSpatialReference, a2 = c$32(m2.geometries[0]), f2 = i$1V(c2, n2);
  return U$t(u2.path + "/project", f2).then(({ data: { geometries: r2 } }) => o$1e(r2, a2, j2));
}
const t$c = new s$2a({ esriGeometryRelationCross: "cross", esriGeometryRelationDisjoint: "disjoint", esriGeometryRelationIn: "in", esriGeometryRelationInteriorIntersection: "interior-intersection", esriGeometryRelationIntersection: "intersection", esriGeometryRelationLineCoincidence: "line-coincidence", esriGeometryRelationLineTouch: "line-touch", esriGeometryRelationOverlap: "overlap", esriGeometryRelationPointTouch: "point-touch", esriGeometryRelationTouch: "touch", esriGeometryRelationWithin: "within", esriGeometryRelationRelation: "relation" });
function o$9(e2) {
  const { geometries1: o2, geometries2: r2, relation: n2, relationParameter: s2 } = e2.toJSON(), a2 = {};
  if (o2 && o2.length) {
    a2.geometries1 = JSON.stringify({ geometryType: c$32(o2[0]), geometries: o2 });
    const e3 = o2[0].spatialReference;
    a2.sr = e3.wkid ? e3.wkid : JSON.stringify(e3);
  }
  return r2 && r2.length > 0 && (a2.geometries2 = JSON.stringify({ geometryType: c$32(r2[0]), geometries: r2 })), n2 && (a2.relation = t$c.toJSON(n2)), s2 && (a2.relationParam = s2), a2;
}
let a$8 = class extends l$2B {
  constructor(r2) {
    super(r2), this.geometries1 = null, this.geometries2 = null, this.relation = null, this.relationParameter = null;
  }
};
e$2g([y$1I({ json: { read: { reader: (r2) => r2 ? r2.map((r3) => v$14(r3)).filter(r$1$) : null }, write: { writer: (r2, e2) => {
  var _a2;
  e2.geometries1 = (_a2 = r2 == null ? void 0 : r2.map((r3) => r3.toJSON())) != null ? _a2 : null;
} } } })], a$8.prototype, "geometries1", void 0), e$2g([y$1I({ json: { read: { reader: (r2) => r2 ? r2.map((r3) => v$14(r3)).filter(r$1$) : null }, write: { writer: (r2, e2) => {
  var _a2;
  e2.geometries2 = (_a2 = r2 == null ? void 0 : r2.map((r3) => r3.toJSON())) != null ? _a2 : null;
} } } })], a$8.prototype, "geometries2", void 0), e$2g([y$1I({ type: String, json: { write: true } })], a$8.prototype, "relation", void 0), e$2g([y$1I({ type: String, json: { write: true } })], a$8.prototype, "relationParameter", void 0), a$8 = e$2g([n$2P("esri.rest.support.RelationParameters")], a$8), a$8.from = b$1a(a$8);
const m$g = a$8;
async function n$e(n2, a2, i2) {
  a2 = m$g.from(a2);
  const m2 = o$9(a2), p2 = f$19(n2), f2 = __spreadValues(__spreadProps(__spreadValues({}, p2.query), { f: "json" }), m2), u2 = i$1V(f2, i2);
  return U$t(p2.path + "/relation", u2).then(({ data: r2 }) => r2.relations);
}
async function i$d(i2, n2, p2, a2) {
  const f2 = n2.spatialReference, m2 = f$19(i2), y2 = __spreadProps(__spreadValues({}, m2.query), { f: "json", sr: JSON.stringify(f2.toJSON()), target: JSON.stringify({ geometryType: c$32(n2), geometry: n2.toJSON() }), reshaper: JSON.stringify(p2.toJSON()) }), g2 = i$1V(y2, a2);
  return U$t(m2.path + "/reshape", g2).then(({ data: e2 }) => v$14(e2.geometry).set({ spatialReference: f2 }));
}
async function t$b(t2, i2, e2) {
  const c2 = {};
  i2.sr != null && typeof i2.sr == "object" ? c2.sr = i2.sr.wkid || JSON.stringify(i2.sr) : c2.sr = i2.sr, c2.coordinates = JSON.stringify(i2.coordinates);
  const d2 = i2.conversionType || "mgrs";
  c2.conversionType = _$6.toJSON(d2), c2.conversionMode = i2.conversionMode, c2.numOfDigits = i2.numOfDigits, c2.rounding = i2.rounding, c2.addSpaces = i2.addSpaces;
  const a2 = f$19(t2), u2 = __spreadValues(__spreadProps(__spreadValues({}, a2.query), { f: "json" }), c2), f2 = i$1V(u2, e2);
  return U$t(a2.path + "/toGeoCoordinateString", f2).then(({ data: o2 }) => o2.strings);
}
const t$a = new s$2a({ 0: "default-curve-extension", 1: "relocate-ends", 2: "keep-end-attributes", 4: "no-end-attributes", 8: "no-extend-at-from", 16: "no-extend-at-to" });
function n$d(e2) {
  const { extendHow: n2, polylines: o2, trimExtendTo: r2 } = e2.toJSON(), i2 = {};
  return i2.extendHow = t$a.toJSON(n2), o2 && o2.length && (i2.polylines = JSON.stringify(o2), i2.sr = JSON.stringify(o2[0].spatialReference)), r2 && (i2.trimExtendTo = JSON.stringify(r2)), i2;
}
let m$f = class extends l$2B {
  constructor(r2) {
    super(r2), this.extendHow = "default-curve-extension", this.polylines = null, this.trimExtendTo = null;
  }
};
e$2g([y$1I({ type: String, json: { write: true } })], m$f.prototype, "extendHow", void 0), e$2g([y$1I({ type: [m$2i], json: { read: { reader: (r2) => r2 ? r2.map((r3) => v$14(r3)) : null }, write: { writer: (r2, o2) => {
  o2.polylines = r2.map((r3) => r3.toJSON());
} } } })], m$f.prototype, "polylines", void 0), e$2g([y$1I({ json: { read: { reader: (r2) => r2 ? v$14(r2) : null }, write: { writer: (r2, o2) => {
  o2.trimExtendTo = r2.toJSON();
} } } })], m$f.prototype, "trimExtendTo", void 0), m$f = e$2g([n$2P("esri.rest.support.TrimExtendParameters")], m$f), m$f.from = b$1a(m$f);
const n$c = m$f;
async function i$c(i2, p2, n2) {
  p2 = n$c.from(p2);
  const a2 = n$d(p2), f2 = f$19(i2), j2 = __spreadValues(__spreadProps(__spreadValues({}, f2.query), { f: "json" }), a2), u2 = p2.sr, y2 = i$1V(j2, n2);
  return U$t(f2.path + "/trimExtend", y2).then(({ data: r2 }) => (r2.geometries || []).map(({ paths: r3 }) => new m$2i({ spatialReference: u2, paths: r3 })));
}
async function i$b(i2, n2, m2) {
  const f2 = n2[0].spatialReference, p2 = f$19(i2), a2 = __spreadProps(__spreadValues({}, p2.query), { f: "json", sr: JSON.stringify(f2.toJSON()), geometries: JSON.stringify(r$16(n2)) }), u2 = i$1V(a2, m2);
  return U$t(p2.path + "/union", u2).then(({ data: t2 }) => v$14(t2.geometry).set({ spatialReference: f2 }));
}
var geometryService = /* @__PURE__ */ Object.freeze({
  __proto__: null,
  [Symbol.toStringTag]: "Module",
  areasAndLengths: o$d,
  autoComplete: i$j,
  buffer: s$a,
  convexHull: i$i,
  cut: o$1f,
  densify: o$c,
  difference: i$h,
  distance: r$c,
  fromGeoCoordinateString: t$d,
  generalize: m$k,
  intersect: m$j,
  labelPoints: r$a,
  lengths: n$g,
  offset: m$h,
  project: n$f,
  relation: n$e,
  reshape: i$d,
  simplify: o$1d,
  toGeoCoordinateString: t$b,
  trimExtend: i$c,
  union: i$b,
  conversionTypeKebabDict: _$6,
  units: N$6
});
const c$b = new s$2a({ 9001: "meters", 9002: "feet", 9036: "kilometers", 9093: "miles", 109012: "nautical-miles", 109001: "yards" });
let u$a = class extends l$2B {
  constructor(e2) {
    super(e2), this.bufferSpatialReference = null, this.distances = null, this.geodesic = false, this.geometries = null, this.outSpatialReference = null, this.unionResults = false, this.unit = null;
  }
  toJSON() {
    const e2 = { unit: c$b.toJSON(this.unit), unionResults: this.unionResults, geodesic: this.geodesic }, t2 = this.distances, o2 = this.outSpatialReference, s2 = this.bufferSpatialReference, r2 = this.geometries;
    if (r2 && r2.length > 0) {
      const t3 = r2.map((e3) => (e3 = e3.type === "extent" ? v$15.fromExtent(e3) : e3).toJSON()), o3 = r2[0].type === "extent" ? "esriGeometryPolygon" : c$32(r2[0]);
      e2.geometries = JSON.stringify({ geometryType: o3, geometries: t3 }), e2.inSR = r2[0].spatialReference.wkid ? r2[0].spatialReference.wkid : JSON.stringify(r2[0].spatialReference.toJSON());
    }
    return t2 && (e2.distances = t2.join(",")), o2 && (e2.outSR = o2.wkid ? o2.wkid : JSON.stringify(o2.toJSON())), s2 && (e2.bufferSR = s2.wkid ? s2.wkid : JSON.stringify(s2.toJSON())), e2;
  }
};
e$2g([y$1I({ type: k$C, json: { write: true } })], u$a.prototype, "bufferSpatialReference", void 0), e$2g([y$1I({ type: [Number], json: { write: true } })], u$a.prototype, "distances", void 0), e$2g([y$1I({ type: Boolean, json: { write: true } })], u$a.prototype, "geodesic", void 0), e$2g([y$1I({ types: [i$2S], json: { write: true } })], u$a.prototype, "geometries", void 0), e$2g([y$1I({ type: k$C, json: { write: true } })], u$a.prototype, "outSpatialReference", void 0), e$2g([y$1I({ type: Boolean, json: { write: true } })], u$a.prototype, "unionResults", void 0), e$2g([y$1I({ type: String, json: { write: true } })], u$a.prototype, "unit", void 0), u$a = e$2g([n$2P("esri.rest.support.BufferParameters")], u$a);
const l$d = u$a;
let p$d = class extends l$2B {
  constructor(e2) {
    super(e2), this.contains = true, this.dynamicLayerInfos = null, this.gdbVersion = null, this.geometryPrecision = null, this.layerDefinitions = null, this.layerIds = null, this.maxAllowableOffset = null, this.outSpatialReference = null, this.returnGeometry = false, this.searchFields = null, this.searchText = null;
  }
};
e$2g([y$1I({ type: Boolean, json: { write: { enabled: true, isRequired: true } } })], p$d.prototype, "contains", void 0), e$2g([y$1I({ type: [Object], json: { read: { source: "dynamicLayers" }, write: { target: "dynamicLayers" } } })], p$d.prototype, "dynamicLayerInfos", void 0), e$2g([y$1I({ type: String, json: { write: true } })], p$d.prototype, "gdbVersion", void 0), e$2g([y$1I({ type: Number, json: { write: true } })], p$d.prototype, "geometryPrecision", void 0), e$2g([y$1I({ type: [Object], json: { write: true } })], p$d.prototype, "layerDefinitions", void 0), e$2g([y$1I({ type: [Number], json: { write: true } })], p$d.prototype, "layerIds", void 0), e$2g([y$1I({ type: Number, json: { write: true } })], p$d.prototype, "maxAllowableOffset", void 0), e$2g([y$1I({ type: k$C, json: { read: { source: "outSR" }, write: { target: "outSR" } } })], p$d.prototype, "outSpatialReference", void 0), e$2g([y$1I({ type: Boolean, json: { write: { enabled: true, isRequired: true } } })], p$d.prototype, "returnGeometry", void 0), e$2g([y$1I({ type: [String], json: { write: true } })], p$d.prototype, "searchFields", void 0), e$2g([y$1I({ type: String, json: { write: true } })], p$d.prototype, "searchText", void 0), p$d = e$2g([n$2P("esri.rest.support.FindParameters")], p$d), p$d.from = b$1a(p$d);
const n$b = p$d;
function i$a(i2) {
  const { contains: s2, dynamicLayers: n2, geometryPrecision: t2, layerDefinitions: r2, layerIds: o2, maxAllowableOffset: l2, outSR: a2, returnGeometry: c2, searchFields: f2, searchText: y2 } = i2.toJSON(), d2 = { contains: s2, returnGeometry: c2, geometryPrecision: t2, maxAllowableOffset: l2, searchText: y2 };
  if (o2 && (d2.layers = o2.join(",")), f2 && (d2.searchFields = f2.join(",")), a2 && (d2.sr = a2.wkid || JSON.stringify(a2)), r2) {
    const i3 = [];
    for (let e2 = 0; e2 < r2.length; e2++) {
      const s3 = r2[e2];
      i3[s3.id] = s3.definitionExpression;
    }
    d2.layerDefs = u$I(i3);
  }
  if (n2 && n2.length) {
    const e2 = [];
    for (let s3 = 0; s3 < n2.length; s3++) {
      const i4 = n2[s3], t3 = i4.id;
      if (!i4.subLayerIds && o2 && o2.includes(t3)) {
        const s4 = { id: t3 };
        s4.source = i4.source;
        let n3 = null;
        if (r2 && r2.length) {
          const e3 = r2.find((e4) => e4.id === t3);
          n3 = e3 && e3.definitionExpression;
        }
        n3 && (s4.definitionExpression = n3), e2.push(s4);
      }
    }
    let i3 = JSON.stringify(e2);
    i3 === "[]" && (i3 = "[{}]"), d2.dynamicLayers = i3;
  }
  return d2;
}
let m$e = class extends l$2B {
  constructor(t2) {
    super(t2), this.displayFieldName = null, this.feature = null, this.foundFieldName = null, this.layerId = null, this.layerName = null, this.value = void 0;
  }
  readFeature(t2, r2) {
    const o2 = { attributes: {} };
    return r2.attributes && (o2.attributes = r2.attributes), r2.geometry && (o2.geometry = r2.geometry), g$10.fromJSON(o2);
  }
  writeFeature(t2, e2) {
    if (!t2)
      return;
    const { attributes: r2, geometry: s2 } = t2;
    r2 && (e2.attributes = __spreadValues({}, r2)), r$1$(s2) && (e2.geometry = s2.toJSON(), e2.geometryType = t$1Y.toJSON(s2.type));
  }
};
e$2g([y$1I({ type: String, json: { write: true } })], m$e.prototype, "displayFieldName", void 0), e$2g([y$1I({ type: g$10 })], m$e.prototype, "feature", void 0), e$2g([o$29("feature", ["attributes", "geometry"])], m$e.prototype, "readFeature", null), e$2g([r$1P("feature")], m$e.prototype, "writeFeature", null), e$2g([y$1I({ type: String, json: { write: true } })], m$e.prototype, "foundFieldName", void 0), e$2g([y$1I({ type: Number, json: { write: true } })], m$e.prototype, "layerId", void 0), e$2g([y$1I({ type: String, json: { write: true } })], m$e.prototype, "layerName", void 0), e$2g([y$1I({ json: { write: true } })], m$e.prototype, "value", void 0), m$e = e$2g([n$2P("esri.rest.support.FindResult")], m$e);
const y$5 = m$e;
async function m$d(u2, m2, i2) {
  m2 = n$b.from(m2);
  const f2 = i$a(m2), a2 = f$19(u2);
  a2.path += "/find";
  const c2 = s$1o(__spreadValues(__spreadProps(__spreadValues({}, a2.query), { f: "json" }), f2)), l2 = i$1V(c2, i2);
  return U$t(a2.path, l2).then(p$c);
}
function p$c(t2) {
  const r2 = t2.data;
  r2.results = r2.results || [];
  const s2 = { results: [] };
  return s2.results = r2.results.map((t3) => y$5.fromJSON(t3)), s2;
}
var find = /* @__PURE__ */ Object.freeze({
  __proto__: null,
  [Symbol.toStringTag]: "Module",
  find: m$d
});
const p$b = new s$2a({ PDF: "pdf", PNG32: "png32", PNG8: "png8", JPG: "jpg", GIF: "gif", EPS: "eps", SVG: "svg", SVGZ: "svgz" });
p$b.fromJSON.bind(p$b);
const g$9 = p$b.toJSON.bind(p$b);
const t$9 = new s$2a({ MAP_ONLY: "map-only", "A3 Landscape": "a3-landscape", "A3 Portrait": "a3-portrait", "A4 Landscape": "a4-landscape", "A4 Portrait": "a4-portrait", "Letter ANSI A Landscape": "letter-ansi-a-landscape", "Letter ANSI A Portrait": "letter-ansi-a-portrait", "Tabloid ANSI B Landscape": "tabloid-ansi-b-landscape", "Tabloid ANSI B Portrait": "tabloid-ansi-b-portrait" });
t$9.fromJSON.bind(t$9);
const o$8 = t$9.toJSON.bind(t$9);
const o$7 = "simple-marker", a$7 = "picture-marker", l$c = "simple-line", s$8 = "simple-fill", u$9 = "shield-label-symbol", f$9 = "text";
function y$4(y2, c2) {
  const { graphic: p2, renderer: m2, symbol: d2 } = c2, g2 = d2.type;
  if (g2 === f$9 || g2 === u$9 || !("visualVariables" in m2) || !m2.visualVariables)
    return;
  const b2 = m2.getVisualVariablesForType("size"), h2 = m2.getVisualVariablesForType("color"), V2 = m2.getVisualVariablesForType("opacity"), w2 = m2.getVisualVariablesForType("rotation"), T2 = b2[0], v2 = h2[0], G2 = V2[0], S2 = w2[0];
  if (T2) {
    const t2 = g2 === o$7 ? d2.style : null, i2 = y$L(T2, p2, { shape: t2 });
    i2 != null && (g2 === o$7 ? y2.size = e$1D(i2) : g2 === a$7 ? (y2.width = e$1D(i2), y2.height = e$1D(i2)) : g2 === l$c ? y2.width = e$1D(i2) : y2.outline && (y2.outline.width = e$1D(i2)));
  }
  if (v2) {
    const e2 = b$C(v2, p2);
    (e2 && g2 === o$7 || g2 === l$c || g2 === s$8) && (y2.color = e2 ? e2.toJSON() : void 0);
  }
  if (G2) {
    const e2 = h$W(G2, p2);
    e2 != null && y2.color && (y2.color[3] = Math.round(255 * e2));
  }
  S2 && (y2.angle = -m$1k(m2, p2));
}
function c$a() {
  return { layerDefinition: { name: "multipointLayer", geometryType: "esriGeometryMultipoint", drawingInfo: { renderer: null } }, featureSet: { geometryType: "esriGeometryMultipoint", features: [] } };
}
function p$a() {
  return { layerDefinition: { name: "polygonLayer", geometryType: "esriGeometryPolygon", drawingInfo: { renderer: null } }, featureSet: { geometryType: "esriGeometryPolygon", features: [] } };
}
function m$c() {
  return { layerDefinition: { name: "pointLayer", geometryType: "esriGeometryPoint", drawingInfo: { renderer: null } }, featureSet: { geometryType: "esriGeometryPoint", features: [] } };
}
function d$6() {
  return { layerDefinition: { name: "polylineLayer", geometryType: "esriGeometryPolyline", drawingInfo: { renderer: null } }, featureSet: { geometryType: "esriGeometryPolyline", features: [] } };
}
function g$8(e2, r2 = 15) {
  const t2 = e2.canvas.width, i2 = e2.canvas.height, n2 = e2.getImageData(0, 0, t2, i2).data;
  let o2, a2, l2, s2, u2, f2;
  e:
    for (a2 = i2; a2--; )
      for (o2 = t2; o2--; )
        if (n2[4 * (t2 * a2 + o2) + 3] > r2) {
          f2 = a2;
          break e;
        }
  if (!f2)
    return null;
  e:
    for (o2 = t2; o2--; )
      for (a2 = f2 + 1; a2--; )
        if (n2[4 * (t2 * a2 + o2) + 3] > r2) {
          u2 = o2;
          break e;
        }
  e:
    for (o2 = 0; o2 <= u2; ++o2)
      for (a2 = f2 + 1; a2--; )
        if (n2[4 * (t2 * a2 + o2) + 3] > r2) {
          l2 = o2;
          break e;
        }
  e:
    for (a2 = 0; a2 <= f2; ++a2)
      for (o2 = l2; o2 <= u2; ++o2)
        if (n2[4 * (t2 * a2 + o2) + 3] > r2) {
          s2 = a2;
          break e;
        }
  return { x: l2, y: s2, width: u2 - l2, height: f2 - s2 };
}
function b$7(e2, r2) {
  const t2 = e2.allLayerViews.items;
  if (r2 === e2.scale)
    return t2.filter((e3) => !e3.suspended);
  const i2 = new Array();
  for (const n2 of t2)
    T$4(n2.parent) && !i2.includes(n2.parent) || !n2.visible || r2 && "isVisibleAtScale" in n2 && !n2.isVisibleAtScale(r2) || i2.push(n2);
  return i2;
}
function h$9(e2) {
  return (e2 == null ? void 0 : e2.type) === "bing-maps";
}
function V$3(e2) {
  return e2 && "blendMode" in e2 && "effect" in e2;
}
function w$5(e2) {
  return (e2 == null ? void 0 : e2.type) === "csv";
}
function T$4(e2) {
  return (e2 == null ? void 0 : e2.declaredClass) === "esri.views.2d.layers.GroupLayerView2D";
}
function v$8(e2) {
  const r2 = e2.layer;
  if (V$3(r2)) {
    const t2 = r2.blendMode;
    if ((!t2 || t2 === "normal") && (r2.effect || "featureEffect" in e2 && e2.featureEffect))
      return true;
  }
  return false;
}
let p$9 = class extends m$2q {
  constructor(t2) {
    super(t2), this.attributionVisible = true, this.exportOptions = { width: 800, height: 1100, dpi: 96 }, this.forceFeatureAttributes = false, this.format = "png32", this.label = null, this.layout = "map-only", this.layoutItem = null, this.layoutOptions = null, this.outScale = 0, this.scalePreserved = true, this.showLabels = true;
  }
};
e$2g([y$1I()], p$9.prototype, "attributionVisible", void 0), e$2g([y$1I()], p$9.prototype, "exportOptions", void 0), e$2g([y$1I()], p$9.prototype, "forceFeatureAttributes", void 0), e$2g([y$1I()], p$9.prototype, "format", void 0), e$2g([y$1I()], p$9.prototype, "label", void 0), e$2g([y$1I()], p$9.prototype, "layout", void 0), e$2g([y$1I({ type: x$o })], p$9.prototype, "layoutItem", void 0), e$2g([y$1I()], p$9.prototype, "layoutOptions", void 0), e$2g([y$1I()], p$9.prototype, "outScale", void 0), e$2g([y$1I()], p$9.prototype, "scalePreserved", void 0), e$2g([y$1I()], p$9.prototype, "showLabels", void 0), p$9 = e$2g([n$2P("esri.rest.support.PrintTemplate")], p$9);
const i$9 = p$9;
const P$3 = { Feet: "ft", Kilometers: "km", Meters: "m", Miles: "mi" }, F$5 = new s$2a({ esriFeet: "Feet", esriKilometers: "Kilometers", esriMeters: "Meters", esriMiles: "Miles" }), R$2 = new s$2a({ esriExecutionTypeSynchronous: "sync", esriExecutionTypeAsynchronous: "async" }), N$5 = new Map();
async function J$5(e2, i2, r2) {
  const a2 = C$4(e2);
  let n2 = N$5.get(a2);
  return Promise.resolve().then(() => n2 ? { data: n2.gpMetadata } : (n2 = { gpServerUrl: a2, is11xService: false, legendLayerNameMap: {}, legendLayers: [] }, U$t(a2, { query: { f: "json" } }))).then((e3) => (n2.gpMetadata = e3.data, n2.cimVersion = n2.gpMetadata.cimVersion, n2.is11xService = !!n2.cimVersion, N$5.set(a2, n2), j$5(i2, n2))).then((t2) => {
    const a3 = ue(n2);
    let s2;
    const o2 = (e3) => a3 === "sync" ? e3.results && e3.results[0] && e3.results[0].value : s2.fetchResultData("Output_File", null, r2).then((e4) => e4.value);
    return a3 === "async" ? s$b(e2, t2, null, r2).then((e3) => (s2 = e3, e3.waitForJobCompletion({ interval: i2.updateDelay }).then(o2))) : o$e(e2, t2, null, r2).then(o2);
  });
}
async function U$2(e2) {
  const t2 = C$4(e2);
  return ue(N$5.get(t2));
}
async function j$5(t2, r2) {
  r2 = r2 || { is11xService: false, legendLayerNameMap: {}, legendLayers: [] };
  const a2 = t2.template || new i$9();
  a2.showLabels == null && (a2.showLabels = true);
  const n2 = a2.exportOptions;
  let s2;
  const o2 = o$8(a2.layout);
  if (n2) {
    if (s2 = { dpi: n2.dpi }, o2.toLowerCase() === "map_only" || o2 === "") {
      const e2 = n2.width, t3 = n2.height;
      s2.outputSize = [e2, t3];
    }
  }
  const l2 = a2.layoutOptions;
  let c2;
  if (l2) {
    let e2, t3;
    l2.scalebarUnit === "Miles" || l2.scalebarUnit === "Kilometers" ? (e2 = "Kilometers", t3 = "Miles") : l2.scalebarUnit !== "Meters" && l2.scalebarUnit !== "Feet" || (e2 = "Meters", t3 = "Feet"), c2 = { titleText: l2.titleText, authorText: l2.authorText, copyrightText: l2.copyrightText, customTextElements: l2.customTextElements, elementOverrides: l2.elementOverrides, scaleBarOptions: { metricUnit: F$5.toJSON(e2), metricLabel: P$3[e2], nonMetricUnit: F$5.toJSON(t3), nonMetricLabel: P$3[t3] } };
  }
  let u2 = null;
  (l2 == null ? void 0 : l2.legendLayers) && (u2 = l2.legendLayers.map((e2) => {
    r2.legendLayerNameMap[e2.layerId] = e2.title;
    const t3 = { id: e2.layerId };
    return e2.subLayerIds && (t3.subLayerIds = e2.subLayerIds), t3;
  }));
  const y2 = await A$4(t2, a2, r2);
  if (y2.operationalLayers) {
    const e2 = new RegExp("[\\u4E00-\\u9FFF\\u0E00-\\u0E7F\\u0900-\\u097F\\u3040-\\u309F\\u30A0-\\u30FF\\u31F0-\\u31FF]"), t3 = /[\u0600-\u06FF]/, a3 = (i2) => {
      const r3 = i2.text, a4 = i2.font, n4 = a4 && a4.family && a4.family.toLowerCase();
      r3 && a4 && (n4 === "arial" || n4 === "arial unicode ms") && (a4.family = e2.test(r3) ? "Arial Unicode MS" : "Arial", a4.style !== "normal" && t3.test(r3) && (a4.family = "Arial Unicode MS"));
    }, n3 = () => {
      throw new s$2u("print:cim-symbol-unsupported", "CIMSymbol is not supported by a print service published from ArcMap");
    };
    y2.operationalLayers.forEach((e3) => {
      var _a2, _b2, _c2;
      ((_a2 = e3.featureCollection) == null ? void 0 : _a2.layers) ? e3.featureCollection.layers.forEach((e4) => {
        var _a3, _b3, _c3, _d2;
        if ((_c3 = (_b3 = (_a3 = e4.layerDefinition) == null ? void 0 : _a3.drawingInfo) == null ? void 0 : _b3.renderer) == null ? void 0 : _c3.symbol) {
          const t4 = e4.layerDefinition.drawingInfo.renderer;
          t4.symbol.type === "esriTS" ? a3(t4.symbol) : t4.symbol.type !== "CIMSymbolReference" || r2.is11xService || n3();
        }
        ((_d2 = e4.featureSet) == null ? void 0 : _d2.features) && e4.featureSet.features.forEach((e5) => {
          e5.symbol && (e5.symbol.type === "esriTS" ? a3(e5.symbol) : e5.symbol.type !== "CIMSymbolReference" || r2.is11xService || n3());
        });
      }) : !r2.is11xService && ((_c2 = (_b2 = e3.layerDefinition) == null ? void 0 : _b2.drawingInfo) == null ? void 0 : _c2.renderer) && JSON.stringify(e3.layerDefinition.drawingInfo.renderer).includes('"type":"CIMSymbolReference"') && n3();
    });
  }
  t2.outSpatialReference && (y2.mapOptions.spatialReference = t2.outSpatialReference.toJSON()), Object.assign(y2, { exportOptions: s2, layoutOptions: c2 || {} }), Object.assign(y2.layoutOptions, { legendOptions: { operationalLayers: u2 != null ? u2 : r2.legendLayers.slice() } }), r2.legendLayers.length = 0, N$5.set(r2.gpServerUrl, r2);
  const m2 = { Web_Map_as_JSON: JSON.stringify(y2), Format: g$9(a2.format), Layout_Template: o2, Layout_Item_ID: void 0 };
  if (a2.layoutItem) {
    delete m2.Layout_Template;
    const t3 = a2.layoutItem;
    await t3.load(), t3.access !== "public" && s$1Q && await s$1Q.getCredential(r2.gpServerUrl), m2.Layout_Item_ID = JSON.stringify({ id: t3.id });
  }
  return t2.extraParameters && Object.assign(m2, t2.extraParameters), m2;
}
async function A$4(e2, t2, i2) {
  const r2 = e2.view;
  let n2 = r2.spatialReference;
  const s2 = { operationalLayers: await k$3(r2, t2, i2) };
  let o2 = i2.ssExtent || e2.extent || r2.extent;
  if (n2 && n2.isWrappable && (o2 = o2.clone()._normalize(true), n2 = o2.spatialReference), s2.mapOptions = { extent: o2 && o2.toJSON(), spatialReference: n2 && n2.toJSON(), showAttribution: t2.attributionVisible }, i2.ssExtent = null, r2.background && (s2.background = r2.background.toJSON()), r2.rotation && (s2.mapOptions.rotation = -r2.rotation), t2.scalePreserved && (s2.mapOptions.scale = t2.outScale || r2.scale), r$1$(r2.timeExtent)) {
    const e3 = r$1$(r2.timeExtent.start) ? r2.timeExtent.start.getTime() : null, t3 = r$1$(r2.timeExtent.end) ? r2.timeExtent.end.getTime() : null;
    s2.mapOptions.time = [e3, t3];
  }
  return s2;
}
function C$4(e2) {
  let t2 = e2;
  const i2 = t2.lastIndexOf("/GPServer/");
  return i2 > 0 && (t2 = t2.slice(0, i2 + 9)), t2;
}
async function k$3(e2, t2, i2) {
  const r2 = [], a2 = { layerView: null, printTemplate: t2, view: e2 };
  let n2 = 0;
  t2.scalePreserved && (n2 = t2.outScale || e2.scale);
  const s2 = b$7(e2, n2);
  for (const o2 of s2) {
    const e3 = o2.layer;
    if (!e3.loaded || (e3 == null ? void 0 : e3.type) === "group")
      continue;
    let t3;
    a2.layerView = o2, t3 = v$8(o2) ? await Z$1(e3, a2, i2) : h$9(e3) ? z$5(e3) : w$5(e3) ? await _$5(e3, a2, i2) : (e3 == null ? void 0 : e3.type) === "feature" ? await q$3(e3, a2, i2) : (e3 == null ? void 0 : e3.type) === "geojson" ? await K$2(e3, a2, i2) : (e3 == null ? void 0 : e3.type) === "graphics" ? await W(e3, a2, i2) : (e3 == null ? void 0 : e3.type) === "imagery" ? B$3(e3, i2) : (e3 == null ? void 0 : e3.type) === "imagery-tile" ? await G$4(e3, a2, i2) : (e3 == null ? void 0 : e3.type) === "kml" ? await Q$3(e3, a2, i2) : (e3 == null ? void 0 : e3.type) === "map-image" ? H$1(e3, a2, i2) : (e3 == null ? void 0 : e3.type) === "map-notes" ? await X$1(a2, i2) : (e3 == null ? void 0 : e3.type) === "open-street-map" ? Y$2() : (e3 == null ? void 0 : e3.type) === "stream" ? await ee$1(e3, a2, i2) : (e3 == null ? void 0 : e3.type) === "tile" ? te$1(e3, i2) : (e3 == null ? void 0 : e3.type) === "vector-tile" ? await ie$1(e3, a2, i2) : (e3 == null ? void 0 : e3.type) === "web-tile" ? re$1(e3) : (e3 == null ? void 0 : e3.type) === "wms" ? ae$1(e3) : (e3 == null ? void 0 : e3.type) === "wmts" ? ne(e3) : await Z$1(e3, a2, i2), t3 && (Array.isArray(t3) ? r2.push(...t3) : (t3.id = e3.id, t3.title = i2.legendLayerNameMap[e3.id] || e3.title, t3.opacity = e3.opacity, t3.minScale = e3.minScale || 0, t3.maxScale = e3.maxScale || 0, V$3(e3) && e3.blendMode && e3.blendMode !== "normal" && (t3.blendMode = e3.blendMode), r2.push(t3)));
  }
  if (n2 && r2.forEach((e3) => {
    e3.minScale = 0, e3.maxScale = 0;
  }), e2.graphics && e2.graphics.length) {
    const a3 = await $(null, e2.graphics, t2, i2);
    a3 && r2.push(a3);
  }
  return r2;
}
function z$5(e2) {
  return { culture: e2.culture, key: e2.key, type: "BingMaps" + (e2.style === "aerial" ? "Aerial" : e2.style === "hybrid" ? "Hybrid" : "Road") };
}
async function _$5(e2, t2, i2) {
  e2.legendEnabled && i2.legendLayers.push({ id: e2.id });
  const r2 = t2.layerView, a2 = t2.printTemplate;
  let n2;
  if (!i2.is11xService || r2.filter) {
    return $(e2, await ce(r2), a2, i2);
  }
  return n2 = { type: "CSV" }, e2.write(n2, { origin: "web-map" }), delete n2.popupInfo, delete n2.layerType, n2.showLabels = a2.showLabels && e2.labelsVisible, n2;
}
async function $(e2, t2, i2, r2) {
  var _a2, _b2;
  let a2;
  const n2 = p$a(), s2 = d$6(), o2 = m$c(), l2 = c$a(), c2 = m$c();
  if (c2.layerDefinition.name = "textLayer", delete c2.layerDefinition.drawingInfo, e2) {
    if (e2.declaredClass === "esri.layers.FeatureLayer" || e2.declaredClass === "esri.layers.StreamLayer" ? n2.layerDefinition.name = s2.layerDefinition.name = o2.layerDefinition.name = l2.layerDefinition.name = r2.legendLayerNameMap[e2.id] || e2.get("arcgisProps.title") || e2.title : e2.declaredClass === "esri.layers.GraphicsLayer" && (t2 = e2.graphics.items), e2.renderer) {
      const t3 = e2.renderer.toJSON();
      n2.layerDefinition.drawingInfo.renderer = t3, s2.layerDefinition.drawingInfo.renderer = t3, o2.layerDefinition.drawingInfo.renderer = t3, l2.layerDefinition.drawingInfo.renderer = t3;
    }
    if (i2.showLabels && e2.labelsVisible && typeof e2.write == "function") {
      const t3 = (_b2 = (_a2 = e2.write({}, { origin: "web-map" }).layerDefinition) == null ? void 0 : _a2.drawingInfo) == null ? void 0 : _b2.labelingInfo;
      t3 && (a2 = true, n2.layerDefinition.drawingInfo.labelingInfo = t3, s2.layerDefinition.drawingInfo.labelingInfo = t3, o2.layerDefinition.drawingInfo.labelingInfo = t3, l2.layerDefinition.drawingInfo.labelingInfo = t3);
    }
  }
  let m2;
  (e2 == null ? void 0 : e2.renderer) || a2 || (delete n2.layerDefinition.drawingInfo, delete s2.layerDefinition.drawingInfo, delete o2.layerDefinition.drawingInfo, delete l2.layerDefinition.drawingInfo);
  const f2 = e2 == null ? void 0 : e2.fieldsIndex, p2 = e2 == null ? void 0 : e2.renderer;
  if (f2) {
    const t3 = new Set();
    a2 && await W$h(t3, e2), p2 && typeof p2.collectRequiredFields == "function" && await p2.collectRequiredFields(t3, f2), m2 = Array.from(t3);
    const i3 = f2.fields.map((e3) => e3.toJSON());
    n2.layerDefinition.fields = i3, s2.layerDefinition.fields = i3, o2.layerDefinition.fields = i3, l2.layerDefinition.fields = i3;
  }
  const d2 = t2 && t2.length;
  let g2;
  for (let y2 = 0; y2 < d2; y2++) {
    const a3 = t2[y2] || t2.getItemAt(y2);
    if (a3.visible === false || !a3.geometry)
      continue;
    if (g2 = a3.toJSON(), g2.hasOwnProperty("popupTemplate") && delete g2.popupTemplate, g2.geometry && g2.geometry.z && delete g2.geometry.z, g2.symbol && g2.symbol.outline && g2.symbol.outline.type === "esriCLS" && !r2.is11xService)
      continue;
    !r2.is11xService && g2.symbol && g2.symbol.outline && g2.symbol.outline.color && g2.symbol.outline.color[3] && (g2.symbol.outline.color[3] = 255);
    const f3 = e2 && e2.renderer && ("valueExpression" in e2.renderer && e2.renderer.valueExpression || "hasVisualVariables" in e2.renderer && e2.renderer.hasVisualVariables());
    if (!g2.symbol && e2 && e2.renderer && f3 && !r2.is11xService) {
      const t3 = e2.renderer, i3 = await t3.getSymbolAsync(a3);
      if (!i3)
        continue;
      g2.symbol = i3.toJSON(), "hasVisualVariables" in t3 && t3.hasVisualVariables() && y$4(g2.symbol, { renderer: t3, graphic: a3, symbol: i3 });
    }
    if (g2.symbol && (g2.symbol.angle || delete g2.symbol.angle, ye(g2.symbol) ? g2.symbol = await oe$1(g2.symbol, r2) : g2.symbol.text && delete g2.attributes), (!i2 || !i2.forceFeatureAttributes) && (m2 == null ? void 0 : m2.length)) {
      const e3 = {};
      m2.forEach((t3) => {
        g2.attributes && g2.attributes.hasOwnProperty(t3) && (e3[t3] = g2.attributes[t3]);
      }), g2.attributes = e3;
    }
    a3.geometry.type === "polygon" ? n2.featureSet.features.push(g2) : a3.geometry.type === "polyline" ? s2.featureSet.features.push(g2) : a3.geometry.type === "point" ? g2.symbol && g2.symbol.text ? c2.featureSet.features.push(g2) : o2.featureSet.features.push(g2) : a3.geometry.type === "multipoint" ? l2.featureSet.features.push(g2) : a3.geometry.type === "extent" && (g2.geometry = v$15.fromExtent(a3.geometry).toJSON(), n2.featureSet.features.push(g2));
  }
  const b2 = [n2, s2, l2, o2, c2].filter((e3) => e3.featureSet.features.length > 0);
  for (const u2 of b2) {
    const e3 = u2.featureSet.features.every((e4) => e4.symbol);
    !e3 || i2 && i2.forceFeatureAttributes || u2.featureSet.features.forEach((e4) => {
      delete e4.attributes;
    }), e3 && delete u2.layerDefinition.drawingInfo, u2.layerDefinition.drawingInfo && u2.layerDefinition.drawingInfo.renderer && await le(u2.layerDefinition.drawingInfo.renderer, r2);
  }
  return b2.length ? { featureCollection: { layers: b2 }, showLabels: a2 } : null;
}
async function q$3(e2, t2, i2) {
  var _a2, _b2, _c2, _d2, _e3, _f2;
  let r2;
  const a2 = e2.renderer, n2 = parseFloat(i2.cimVersion);
  if (((_a2 = e2.featureReduction) == null ? void 0 : _a2.type) === "binning" || ((_b2 = e2.featureReduction) == null ? void 0 : _b2.type) === "cluster" && (!i2.is11xService || n2 < 2.9) || (a2 == null ? void 0 : a2.type) === "pie-chart" || (a2 == null ? void 0 : a2.type) === "dot-density" && (!i2.is11xService || n2 < 2.6))
    return Z$1(e2, t2, i2);
  e2.legendEnabled && i2.legendLayers.push({ id: e2.id });
  const s2 = t2.layerView, { printTemplate: o2, view: l2 } = t2, c2 = a2 && ("valueExpression" in a2 && a2.valueExpression || "hasVisualVariables" in a2 && a2.hasVisualVariables()), u2 = ((_c2 = e2.source) == null ? void 0 : _c2.type) !== "feature-layer" && ((_d2 = e2.source) == null ? void 0 : _d2.type) !== "ogc-feature";
  if (!i2.is11xService && c2 || s2.filter || u2 || !a2 || "field" in a2 && a2.field != null && (typeof a2.field != "string" || !e2.getField(a2.field))) {
    const t3 = await ce(s2);
    r2 = await $(e2, t3, o2, i2);
  } else {
    if (r2 = { id: (y2 = e2.write()).id, title: y2.title, opacity: y2.opacity, minScale: y2.minScale, maxScale: y2.maxScale, url: y2.url, layerType: y2.layerType, customParameters: y2.customParameters, layerDefinition: y2.layerDefinition }, r2.showLabels = o2.showLabels && e2.labelsVisible, se(r2, e2), ((_f2 = (_e3 = r2.layerDefinition) == null ? void 0 : _e3.drawingInfo) == null ? void 0 : _f2.renderer) && (delete r2.layerDefinition.minScale, delete r2.layerDefinition.maxScale, await le(r2.layerDefinition.drawingInfo.renderer, i2), "visualVariables" in a2 && a2.visualVariables && a2.visualVariables[0])) {
      const e3 = a2.visualVariables[0];
      if (e3.type === "size" && e3.maxSize && typeof e3.maxSize != "number" && e3.minSize && typeof e3.minSize != "number") {
        const t4 = k$j(e3, l2.scale);
        r2.layerDefinition.drawingInfo.renderer.visualVariables[0].minSize = t4.minSize, r2.layerDefinition.drawingInfo.renderer.visualVariables[0].maxSize = t4.maxSize;
      }
    }
    const t3 = o$s(s2);
    t3 && (r2.layerDefinition || (r2.layerDefinition = {}), r2.layerDefinition.definitionExpression = r2.layerDefinition.definitionExpression ? `(${r2.layerDefinition.definitionExpression}) AND (${t3})` : t3);
  }
  var y2;
  return r2;
}
async function K$2(e2, t2, i2) {
  var _a2, _b2;
  if (((_a2 = e2.featureReduction) == null ? void 0 : _a2.type) === "binning" || ((_b2 = e2.featureReduction) == null ? void 0 : _b2.type) === "cluster")
    return Z$1(e2, t2, i2);
  e2.legendEnabled && i2.legendLayers.push({ id: e2.id });
  return $(e2, await ce(t2.layerView), t2.printTemplate, i2);
}
async function W(e2, { printTemplate: t2 }, i2) {
  return $(e2, null, t2, i2);
}
function B$3(e2, t2) {
  e2.legendEnabled && t2.legendLayers.push({ id: e2.id });
  const i2 = { layerType: (r2 = e2.write()).layerType, customParameters: r2.customParameters };
  var r2;
  if (i2.bandIds = e2.bandIds, i2.compressionQuality = e2.compressionQuality, i2.format = e2.format, i2.interpolation = e2.interpolation, (e2.mosaicRule || e2.definitionExpression) && (i2.mosaicRule = e2.exportImageServiceParameters.mosaicRule.toJSON()), e2.renderingRule || e2.renderer)
    if (t2.is11xService)
      e2.renderingRule && (i2.renderingRule = e2.renderingRule.toJSON()), e2.renderer && (i2.layerDefinition = i2.layerDefinition || {}, i2.layerDefinition.drawingInfo = i2.layerDefinition.drawingInfo || {}, i2.layerDefinition.drawingInfo.renderer = e2.renderer.toJSON());
    else {
      const t3 = e2.exportImageServiceParameters.combineRendererWithRenderingRule();
      t3 && (i2.renderingRule = t3.toJSON());
    }
  return se(i2, e2), i2;
}
async function G$4(e2, t2, i2) {
  var _a2;
  if (((_a2 = e2.renderer) == null ? void 0 : _a2.type) === "flow")
    return Z$1(e2, t2, i2);
  e2.legendEnabled && i2.legendLayers.push({ id: e2.id });
  const r2 = { bandIds: (a2 = e2.write() || {}).bandIds, customParameters: a2.customParameters, interpolation: a2.interpolation, layerDefinition: a2.layerDefinition };
  var a2;
  return r2.layerType = "ArcGISImageServiceLayer", se(r2, e2), r2;
}
async function Q$3(e2, t2, i2) {
  const r2 = t2.printTemplate;
  if (i2.is11xService) {
    const t3 = { type: "kml" };
    return e2.write(t3, { origin: "web-map" }), delete t3.layerType, t3.url = F$v(e2.url), t3;
  }
  {
    const a2 = [], n2 = t2.layerView;
    n2.allVisibleMapImages.forEach((t3, i3) => {
      const r3 = { id: `${e2.id}_image${i3}`, type: "image", title: e2.id, minScale: e2.minScale || 0, maxScale: e2.maxScale || 0, opacity: e2.opacity, extent: t3.extent };
      t3.href.substr(0, 22) === "data:image/png;base64," ? r3.imageData = t3.href.substr(22) : r3.url = t3.href, a2.push(r3);
    });
    const s2 = [...n2.allVisiblePoints.items, ...n2.allVisiblePolylines.items, ...n2.allVisiblePolygons.items], o2 = __spreadValues({ id: e2.id }, await $(null, s2, r2, i2));
    return a2.push(o2), a2;
  }
}
function H$1(e2, { view: t2 }, i2) {
  let r2;
  const a2 = { id: e2.id, subLayerIds: [] };
  let n2 = [];
  const s2 = t2.scale, o2 = (e3) => {
    const t3 = s2 === 0, i3 = e3.minScale === 0 || s2 <= e3.minScale, r3 = e3.maxScale === 0 || s2 >= e3.maxScale;
    if (e3.visible && (t3 || i3 && r3))
      if (e3.sublayers)
        e3.sublayers.forEach(o2);
      else {
        const t4 = e3.toExportImageJSON(), i4 = { id: e3.id, name: e3.title, layerDefinition: { drawingInfo: t4.drawingInfo, definitionExpression: t4.definitionExpression, source: t4.source } };
        n2.unshift(i4), a2.subLayerIds.push(e3.id);
      }
  };
  var l2;
  return e2.sublayers && e2.sublayers.forEach(o2), n2.length && (n2 = n2.map(({ id: e3, name: t3, layerDefinition: i3 }) => ({ id: e3, name: t3, layerDefinition: i3 })), r2 = { layerType: (l2 = e2.write()).layerType, customParameters: l2.customParameters }, r2.layers = n2, r2.visibleLayers = e2.capabilities.exportMap.supportsDynamicLayers ? void 0 : a2.subLayerIds, se(r2, e2), e2.legendEnabled && i2.legendLayers.push(a2)), r2;
}
async function X$1({ layerView: e2, printTemplate: t2 }, i2) {
  const r2 = [], n2 = e2.layer;
  if (r$1$(n2.featureCollections))
    for (const a2 of n2.featureCollections) {
      const e3 = await $(a2, a2.source, t2, i2);
      e3 && r2.push(...e3.featureCollection.layers);
    }
  else if (r$1$(n2.sublayers))
    for (const a2 of n2.sublayers) {
      const e3 = await $(null, a2.graphics, t2, i2);
      e3 && r2.push(...e3.featureCollection.layers);
    }
  return { featureCollection: { layers: r2 } };
}
function Y$2() {
  return { type: "OpenStreetMap" };
}
async function Z$1(e2, { printTemplate: t2, view: i2 }, r2) {
  const a2 = { type: "image" }, s2 = { format: "png", ignoreBackground: true, layers: [e2], rotation: 0 }, o2 = r2.ssExtent || i2.extent.clone();
  let l2 = 96, u2 = true, y2 = true;
  if (t2.exportOptions) {
    const e3 = t2.exportOptions;
    e3.dpi > 0 && (l2 = e3.dpi), e3.width > 0 && (u2 = e3.width % 2 == i2.width % 2), e3.height > 0 && (y2 = e3.height % 2 == i2.height % 2);
  }
  if (t2.layout === "map-only" && t2.scalePreserved && (!t2.outScale || t2.outScale === i2.scale) && l2 === 96 && (!u2 || !y2) && (s2.area = { x: 0, y: 0, width: i2.width, height: i2.height }, u2 || (s2.area.width -= 1), y2 || (s2.area.height -= 1), !r2.ssExtent)) {
    const e3 = i2.toMap(c$2K(s2.area.width, s2.area.height));
    o2.ymin = e3.y, o2.xmax = e3.x, r2.ssExtent = o2;
  }
  a2.extent = o2.clone()._normalize(true).toJSON();
  const m2 = await i2.takeScreenshot(s2), { data: f2 } = nt$4(m2.dataUrl);
  return a2.imageData = f2, a2;
}
async function ee$1(e2, { layerView: t2, printTemplate: i2 }, r2) {
  e2.legendEnabled && r2.legendLayers.push({ id: e2.id });
  return $(e2, await ce(t2), i2, r2);
}
function te$1(e2, t2) {
  e2.legendEnabled && t2.legendLayers.push({ id: e2.id });
  const i2 = { layerType: (r2 = e2.write()).layerType, customParameters: r2.customParameters };
  var r2;
  return se(i2, e2), i2;
}
async function ie$1(e2, t2, i2) {
  if (i2.is11xService && e2.serviceUrl && e2.styleUrl) {
    const t3 = u$1e(e2.styleUrl, e2.apiKey), r2 = u$1e(e2.serviceUrl, e2.apiKey);
    if (!t3 && !r2 || i2.cimVersion !== "2.1.0") {
      const i3 = { type: "VectorTileLayer" };
      return i3.styleUrl = F$v(e2.styleUrl), i3.token = t3, r2 !== t3 && (i3.additionalTokens = [{ url: e2.serviceUrl, token: r2 }]), i3;
    }
  }
  return Z$1(e2, t2, i2);
}
function re$1(e2) {
  const t2 = { type: "WebTiledLayer", urlTemplate: e2.urlTemplate.replace(/\${/g, "{"), credits: e2.copyright };
  return e2.subDomains && e2.subDomains.length > 0 && (t2.subDomains = e2.subDomains), t2;
}
function ae$1(e2) {
  let t2;
  const i2 = [], r2 = (e3) => {
    e3.visible && (e3.sublayers ? e3.sublayers.forEach(r2) : e3.name && i2.unshift(e3.name));
  };
  return e2.sublayers && e2.sublayers.forEach(r2), i2.length && (t2 = { type: "wms", customLayerParameters: e2.customLayerParameters, customParameters: e2.customParameters, transparentBackground: e2.imageTransparency, visibleLayers: i2, url: F$v(e2.url), version: e2.version }), t2;
}
function ne(e2) {
  const t2 = e2.activeLayer;
  return { type: "wmts", customLayerParameters: e2.customLayerParameters, customParameters: e2.customParameters, format: t2.imageFormat, layer: t2.id, style: t2.styleId, tileMatrixSet: t2.tileMatrixSetId, url: F$v(e2.url) };
}
function se(e2, t2) {
  t2.url && (e2.url = F$v(e2.url || t2.url), e2.token = u$1e(e2.url, t2.apiKey));
}
async function oe$1(e2, i2) {
  var _a2;
  i2.canvas || (i2.canvas = document.createElement("canvas"));
  const r2 = 1024;
  i2.canvas.width = r2, i2.canvas.height = r2;
  const a2 = i2.canvas.getContext("2d");
  let n2, l2;
  if (e2.path) {
    const t2 = new Path2D(e2.path);
    t2.closePath(), a2.fillStyle = Array.isArray(e2.color) ? `rgba(${e2.color[0]},${e2.color[1]},${e2.color[2]},${e2.color[3] / 255})` : "rgb(0,0,0)", a2.fill(t2);
    const i3 = g$8(a2);
    if (!i3)
      return null;
    a2.clearRect(0, 0, r2, r2);
    const o2 = u$1Q(e2.size) / Math.max(i3.width, i3.height);
    a2.scale(o2, o2);
    const c2 = r2 / o2, u2 = c2 / 2 - i3.width / 2 - i3.x, y2 = c2 / 2 - i3.height / 2 - i3.y;
    if (a2.translate(u2, y2), Array.isArray(e2.color) && a2.fill(t2), ((_a2 = e2.outline) == null ? void 0 : _a2.width) && Array.isArray(e2.outline.color)) {
      const r3 = e2.outline;
      a2.lineWidth = u$1Q(r3.width) / o2, a2.lineJoin = "round", a2.strokeStyle = `rgba(${r3.color[0]},${r3.color[1]},${r3.color[2]},${r3.color[3] / 255})`, a2.stroke(t2), i3.width += a2.lineWidth, i3.height += a2.lineWidth;
    }
    i3.width *= o2, i3.height *= o2;
    const m2 = a2.getImageData(r2 / 2 - i3.width / 2, r2 / 2 - i3.height / 2, Math.ceil(i3.width), Math.ceil(i3.height));
    n2 = m2.width, l2 = m2.height, a2.canvas.width = n2, a2.canvas.height = l2, a2.putImageData(m2, 0, 0);
  } else {
    const i3 = e2.contentType === "image/svg+xml" ? "data:image/svg+xml;base64," + e2.imageData : e2.url, r3 = (await U$t(i3, { responseType: "image" })).data;
    n2 = u$1Q(e2.width), l2 = u$1Q(e2.height), a2.canvas.width = n2, a2.canvas.height = l2, a2.drawImage(r3, 0, 0, a2.canvas.width, a2.canvas.height);
  }
  return { type: "esriPMS", imageData: a2.canvas.toDataURL("image/png").substr(22), angle: e2.angle, contentType: "image/png", height: e$1D(l2), width: e$1D(n2), xoffset: e2.xoffset, yoffset: e2.yoffset };
}
async function le(e2, t2) {
  const i2 = e2.type;
  if (i2 === "simple" && ye(e2.symbol))
    e2.symbol = await oe$1(e2.symbol, t2);
  else if (i2 === "uniqueValue" || i2 === "classBreaks") {
    ye(e2.defaultSymbol) && (e2.defaultSymbol = await oe$1(e2.defaultSymbol, t2));
    const r2 = e2[i2 === "uniqueValue" ? "uniqueValueInfos" : "classBreakInfos"];
    if (r2)
      for (const e3 of r2)
        ye(e3.symbol) && (e3.symbol = await oe$1(e3.symbol, t2));
  }
}
async function ce(e2) {
  return e2.queryFeatures(e2.createQuery()).then((e3) => e3.features);
}
function ue(e2) {
  return e2.gpMetadata && e2.gpMetadata.executionType ? R$2.fromJSON(e2.gpMetadata.executionType) : "sync";
}
function ye(e2) {
  return e2 && (e2.path || e2.contentType === "image/svg+xml" || e2.url && e2.url.endsWith(".svg"));
}
var print = /* @__PURE__ */ Object.freeze({
  __proto__: null,
  [Symbol.toStringTag]: "Module",
  execute: J$5,
  getGpPrintParams: j$5,
  getGpServerUrl: C$4,
  getMode: U$2,
  printCacheMap: N$5
});
let s$7 = class extends m$2q {
  constructor(e2) {
    super(e2), this.extent = null, this.extraParameters = null, this.outSpatialReference = null, this.template = null, this.updateDelay = 1e3, this.view = null;
  }
};
e$2g([y$1I()], s$7.prototype, "extent", void 0), e$2g([y$1I()], s$7.prototype, "extraParameters", void 0), e$2g([y$1I()], s$7.prototype, "outSpatialReference", void 0), e$2g([y$1I()], s$7.prototype, "template", void 0), e$2g([y$1I()], s$7.prototype, "updateDelay", void 0), e$2g([y$1I()], s$7.prototype, "view", void 0), s$7 = e$2g([n$2P("esri.rest.support.PrintParameters")], s$7);
const p$8 = s$7;
function E$6(E2) {
  switch (E2) {
    case P$2.SUPPORTED:
      break;
    case P$2.GRAPHICS_LAYER_MISSING:
      return "not owned by a graphics layer";
    case P$2.GEOMETRY_MISSING:
      return "no geometry";
    case P$2.GEOMETRY_TYPE_UNSUPPORTED:
      return "the geometry type is not supported";
    case P$2.ELEVATION_MODE_UNSUPPORTED:
      return "the elevation mode is not supported";
    case P$2.SYMBOL_TYPE_UNSUPPORTED:
      return "the symbol type is not supported";
  }
  return "";
}
var P$2;
!function(E2) {
  E2[E2.SUPPORTED = 0] = "SUPPORTED", E2[E2.GRAPHICS_LAYER_MISSING = 1] = "GRAPHICS_LAYER_MISSING", E2[E2.GEOMETRY_MISSING = 2] = "GEOMETRY_MISSING", E2[E2.GEOMETRY_TYPE_UNSUPPORTED = 3] = "GEOMETRY_TYPE_UNSUPPORTED", E2[E2.ELEVATION_MODE_UNSUPPORTED = 4] = "ELEVATION_MODE_UNSUPPORTED", E2[E2.SYMBOL_TYPE_UNSUPPORTED = 5] = "SYMBOL_TYPE_UNSUPPORTED";
}(P$2 || (P$2 = {}));
function i$8(i2) {
  var _a2;
  if (((_a2 = i2.layer) == null ? void 0 : _a2.type) !== "graphics")
    return P$2.GRAPHICS_LAYER_MISSING;
  if (t$2r(i2.geometry))
    return P$2.GEOMETRY_MISSING;
  switch (i2.geometry.type) {
    case "polygon":
    case "point":
    case "polyline":
    case "mesh":
      break;
    default:
      return P$2.GEOMETRY_TYPE_UNSUPPORTED;
  }
  return l$s(i2) !== "on-the-ground" && c$s(i2) ? P$2.ELEVATION_MODE_UNSUPPORTED : P$2.SUPPORTED;
}
function f$8(e2) {
  if (!e2)
    return null;
  if (o$27(e2) && e2.wkid) {
    const t2 = d$1i[e2.wkid];
    if (t2)
      return t2;
  }
  if (e2.wkt) {
    const t2 = p$7(e2.wkt);
    if (t2)
      return t2;
  }
  return null;
}
function p$7(e2) {
  const t2 = t$1B.exec(e2);
  if (!t2 || t2.length !== 2)
    return null;
  const n2 = t2[1].split(",");
  if (!n2 || n2.length < 3)
    return null;
  const i2 = parseFloat(n2[1]), r2 = parseFloat(n2[2]);
  if (isNaN(i2) || isNaN(r2))
    return null;
  return { a: i2, f: r2 === 0 ? 0 : 1 / r2 };
}
function u$8(e2) {
  const t2 = f$8(e2 != null ? e2 : k$C.WGS84);
  if (m$b(t2))
    return t2;
  const n2 = t2.a * (1 - t2.f);
  return Object.assign(t2, { b: n2, eSq: 1 - (n2 / t2.a) ** 2, radius: (2 * t2.a + n2) / 3, densificationRatio: 1e4 / ((2 * t2.a + n2) / 3) });
}
function m$b(e2) {
  return e2 != null && "b" in e2 && "eSq" in e2 && "radius" in e2;
}
function g$7(e2, t2, i2) {
  const { a: s2, eSq: r2 } = u$8(i2), a2 = Math.sqrt(r2), o2 = Math.sin(t2[1] * i$2a), c2 = s2 * t2[0] * i$2a;
  let h2;
  if (r2 > 0) {
    h2 = s2 * ((1 - r2) * (o2 / (1 - r2 * (o2 * o2)) - 1 / (2 * a2) * Math.log((1 - a2 * o2) / (1 + a2 * o2)))) * 0.5;
  } else
    h2 = s2 * o2;
  return e2[0] = c2, e2[1] = h2, e2;
}
function M$7(e2) {
  return f$8(e2) !== null;
}
function w$4(n2, i2 = "square-meters") {
  if (n2.some((e2) => !M$7(e2.spatialReference)))
    throw new s$2u("geodesic-areas:invalid-spatial-reference", "the input geometries spatial reference is not supported");
  const s2 = [];
  for (let e2 = 0; e2 < n2.length; e2++) {
    const t2 = n2[e2], i3 = t2.spatialReference, { radius: r3, densificationRatio: a3 } = u$8(i3), o3 = r3 * a3;
    s2.push(R$1(t2, o3));
  }
  const r2 = [], a2 = [0, 0], o2 = [0, 0];
  for (let e2 = 0; e2 < s2.length; e2++) {
    const { rings: n3, spatialReference: c2 } = s2[e2];
    let h2 = 0;
    for (let e3 = 0; e3 < n3.length; e3++) {
      const t2 = n3[e3];
      g$7(a2, t2[0], c2), g$7(o2, t2[t2.length - 1], c2);
      let i3 = o2[0] * a2[1] - a2[0] * o2[1];
      for (let e4 = 0; e4 < t2.length - 1; e4++)
        g$7(a2, t2[e4 + 1], c2), g$7(o2, t2[e4], c2), i3 += o2[0] * a2[1] - a2[0] * o2[1];
      h2 += i3;
    }
    h2 = E$E(h2, "square-meters", i2), r2.push(h2 / -2);
  }
  return r2;
}
function y$3(n2, i2 = "meters") {
  if (!n2)
    throw new s$2u("geodesic-lengths:invalid-geometries", "the input geometries type is not supported");
  if (n2.some((e2) => !M$7(e2.spatialReference)))
    throw new s$2u("geodesic-lengths:invalid-spatial-reference", "the input geometries spatial reference is not supported");
  const s2 = [];
  for (let e2 = 0; e2 < n2.length; e2++) {
    const r2 = n2[e2], { spatialReference: a2 } = r2, o2 = r2.type === "polyline" ? r2.paths : r2.rings;
    let c2 = 0;
    for (let e3 = 0; e3 < o2.length; e3++) {
      const t2 = o2[e3];
      let n3 = 0;
      for (let e4 = 1; e4 < t2.length; e4++) {
        const i3 = t2[e4 - 1][0], s3 = t2[e4][0], r3 = t2[e4 - 1][1], o3 = t2[e4][1];
        if (r3 !== o3 || i3 !== s3) {
          const e5 = new v$7();
          b$6(e5, [i3, r3], [s3, o3], a2), n3 += e5.distance;
        }
      }
      c2 += n3;
    }
    c2 = E$E(c2, "meters", i2), s2.push(c2);
  }
  return s2;
}
function R$1(t2, n2) {
  if (t2.type !== "polyline" && t2.type !== "polygon")
    throw new s$2u("geodesic-densify:invalid-geometry", "the input geometry is neither polyline nor polygon");
  const { spatialReference: i2 } = t2;
  if (!M$7(i2))
    throw new s$2u("geodesic-densify:invalid-spatial-reference", "the input geometry spatial reference is not supported");
  const s2 = t2.type === "polyline" ? t2.paths : t2.rings, r2 = [], a2 = [0, 0], h2 = new v$7();
  for (const e2 of s2) {
    const t3 = [];
    r2.push(t3), t3.push([e2[0][0], e2[0][1]]);
    let s3, o2, c2 = e2[0][0], l2 = e2[0][1];
    for (let r3 = 0; r3 < e2.length - 1; r3++) {
      if (s3 = e2[r3 + 1][0], o2 = e2[r3 + 1][1], c2 === s3 && l2 === o2)
        continue;
      const f2 = [c2, l2];
      b$6(h2, [c2, l2], [s3, o2], i2);
      const { azimuth: p2, distance: u2 } = h2, m2 = u2 / n2;
      if (m2 > 1) {
        for (let e3 = 1; e3 <= m2 - 1; e3++) {
          z$4(a2, f2, p2, e3 * n2, i2), t3.push(a2.slice(0));
        }
        z$4(a2, f2, p2, (u2 + Math.floor(m2 - 1) * n2) / 2, i2), t3.push(a2.slice(0));
      }
      z$4(a2, f2, p2, u2, i2), t3.push(a2.slice(0)), c2 = a2[0], l2 = a2[1];
    }
  }
  return t2.type === "polyline" ? new m$2i({ paths: r2, spatialReference: i2 }) : new v$15({ rings: r2, spatialReference: i2 });
}
class v$7 {
  constructor(e2 = 0, t2, n2) {
    this.distance = e2, this.azimuth = t2, this.reverseAzimuth = n2;
  }
}
function z$4(e2, t2, i2, s2, r2) {
  const a2 = t2[0], o2 = t2[1], c2 = a2 * i$2a, h2 = o2 * i$2a, l2 = (i2 != null ? i2 : 0) * i$2a, { a: f2, b: p2, f: m2 } = u$8(r2), d2 = Math.sin(l2), g2 = Math.cos(l2), M2 = (1 - m2) * Math.tan(h2), w2 = 1 / Math.sqrt(1 + M2 * M2), y2 = M2 * w2, R2 = Math.atan2(M2, g2), v2 = w2 * d2, z2 = v2 * v2, b2 = 1 - z2, j2 = b2 * (f2 * f2 - p2 * p2) / (p2 * p2), q2 = 1 + j2 / 16384 * (4096 + j2 * (j2 * (320 - 175 * j2) - 768)), x2 = j2 / 1024 * (256 + j2 * (j2 * (74 - 47 * j2) - 128));
  let A2, N2, S2, k2, P2 = s2 / (p2 * q2), F2 = 2 * Math.PI;
  for (; Math.abs(P2 - F2) > 1e-12; )
    S2 = Math.cos(2 * R2 + P2), A2 = Math.sin(P2), N2 = Math.cos(P2), k2 = x2 * A2 * (S2 + x2 / 4 * (N2 * (2 * S2 * S2 - 1) - x2 / 6 * S2 * (4 * A2 * A2 - 3) * (4 * S2 * S2 - 3))), F2 = P2, P2 = s2 / (p2 * q2) + k2;
  const U2 = y2 * A2 - w2 * N2 * g2, C2 = Math.atan2(y2 * N2 + w2 * A2 * g2, (1 - m2) * Math.sqrt(z2 + U2 * U2)), E2 = Math.atan2(A2 * d2, w2 * N2 - y2 * A2 * g2), G2 = m2 / 16 * b2 * (4 + m2 * (4 - 3 * b2)), I2 = C2 / i$2a, O2 = (c2 + (E2 - (1 - G2) * m2 * v2 * (P2 + G2 * A2 * (S2 + G2 * N2 * (2 * S2 * S2 - 1))))) / i$2a;
  return e2[0] = O2, e2[1] = I2, e2;
}
function b$6(e2, t2, i2, s2) {
  const r2 = t2[0] * i$2a, a2 = t2[1] * i$2a, o2 = i2[0] * i$2a, c2 = i2[1] * i$2a, { a: h2, b: l2, f: f2, radius: p2 } = u$8(s2), m2 = o2 - r2, d2 = Math.atan((1 - f2) * Math.tan(a2)), g2 = Math.atan((1 - f2) * Math.tan(c2)), M2 = Math.sin(d2), w2 = Math.cos(d2), y2 = Math.sin(g2), R2 = Math.cos(g2);
  let v2, z2, b2, j2, q2, x2, A2, N2, S2, k2, P2 = 1e3, F2 = m2;
  do {
    if (A2 = Math.sin(F2), N2 = Math.cos(F2), b2 = Math.sqrt(R2 * A2 * (R2 * A2) + (w2 * y2 - M2 * R2 * N2) * (w2 * y2 - M2 * R2 * N2)), b2 === 0)
      return e2.distance = 0, e2.azimuth = void 0, e2.reverseAzimuth = void 0, e2;
    q2 = M2 * y2 + w2 * R2 * N2, x2 = Math.atan2(b2, q2), S2 = w2 * R2 * A2 / b2, z2 = 1 - S2 * S2, j2 = q2 - 2 * M2 * y2 / z2, isNaN(j2) && (j2 = 0), k2 = f2 / 16 * z2 * (4 + f2 * (4 - 3 * z2)), v2 = F2, F2 = m2 + (1 - k2) * f2 * S2 * (x2 + k2 * b2 * (j2 + k2 * q2 * (2 * j2 * j2 - 1)));
  } while (Math.abs(F2 - v2) > 1e-12 && --P2 > 0);
  if (P2 === 0) {
    const t3 = p2, i3 = Math.acos(Math.sin(a2) * Math.sin(c2) + Math.cos(a2) * Math.cos(c2) * Math.cos(o2 - r2)) * t3, s3 = o2 - r2, h3 = Math.sin(s3) * Math.cos(c2), l3 = Math.cos(a2) * Math.sin(c2) - Math.sin(a2) * Math.cos(c2) * Math.cos(s3), f3 = Math.atan2(h3, l3);
    return e2.azimuth = f3 / i$2a, e2.distance = i3, e2.reverseAzimuth = void 0, e2;
  }
  const U2 = z2 * (h2 * h2 - l2 * l2) / (l2 * l2), C2 = U2 / 1024 * (256 + U2 * (U2 * (74 - 47 * U2) - 128)), E2 = l2 * (1 + U2 / 16384 * (4096 + U2 * (U2 * (320 - 175 * U2) - 768))) * (x2 - C2 * b2 * (j2 + C2 / 4 * (q2 * (2 * j2 * j2 - 1) - C2 / 6 * j2 * (4 * b2 * b2 - 3) * (4 * j2 * j2 - 3)))), G2 = Math.atan2(R2 * Math.sin(F2), w2 * y2 - M2 * R2 * Math.cos(F2)), I2 = Math.atan2(w2 * Math.sin(F2), w2 * y2 * Math.cos(F2) - M2 * R2);
  return e2.azimuth = G2 / i$2a, e2.distance = E2, e2.reverseAzimuth = I2 / i$2a, e2;
}
var d$5;
let h$8 = d$5 = class extends v$15 {
  constructor(...e2) {
    super(...e2), this.center = null, this.geodesic = false, this.numberOfPoints = 60, this.radius = 1e3, this.radiusUnit = "meters";
  }
  normalizeCtorArgs(e2, r2) {
    let t2;
    if (e2 && e2.center)
      t2 = e2;
    else {
      if (e2 && e2.rings)
        return super.normalizeCtorArgs(e2, r2);
      t2 = { center: e2 };
    }
    return __spreadValues(__spreadValues(__spreadValues({}, super.normalizeCtorArgs()), t2), r2);
  }
  initialize() {
    var _a2;
    const e2 = this.center, s2 = this.numberOfPoints;
    if (this.hasZ = (_a2 = e2 == null ? void 0 : e2.hasZ) != null ? _a2 : false, this.rings.length !== 0 || !e2)
      return;
    const i2 = E$E(this.radius, this.radiusUnit, "meters"), o2 = e2.spatialReference;
    let c2, a2 = "geographic";
    if (o2.isWebMercator ? a2 = "webMercator" : ((o2.wkid && r$1O[o2.wkid]) != null || o2.wkt && o2.wkt.indexOf("PROJCS") === 0) && (a2 = "projected"), this.geodesic) {
      let r2;
      switch (a2) {
        case "webMercator":
          r2 = j$X(e2);
          break;
        case "projected":
          console.error("Creating a geodesic circle requires the center to be specified in web mercator or geographic coordinate system");
          break;
        case "geographic":
          r2 = e2;
      }
      c2 = this._createGeodesicCircle(r2, i2, s2), a2 === "webMercator" && (c2 = R$A(c2));
    } else {
      let r2;
      a2 === "webMercator" || a2 === "projected" ? r2 = i2 / this._convert2Meters(1, e2.spatialReference) : a2 === "geographic" && (r2 = Y$c(i2, "meters", u$1q(e2.spatialReference).radius)), c2 = this._createPlanarCircle(e2, r2, s2);
    }
    this.spatialReference = c2.spatialReference, this.addRing(c2.rings[0]);
  }
  clone() {
    const { center: e2, numberOfPoints: r2, radius: t2, radiusUnit: s2, geodesic: i2 } = this;
    return new d$5({ center: e2 == null ? void 0 : e2.clone(), numberOfPoints: r2, radius: t2, radiusUnit: s2, geodesic: i2 });
  }
  _createGeodesicCircle(e2, r2, t2) {
    let s2 = 0;
    const i2 = [];
    for (; s2 < 360; ) {
      const o2 = [0, 0], c2 = [e2.x, e2.y];
      z$4(o2, c2, s2, r2), this.hasZ && o2.push(e2.z), i2.push(o2), s2 += 360 / t2;
    }
    return i2.push(i2[0]), new v$15(i2);
  }
  _createPlanarCircle(e2, r2, t2) {
    const s2 = [], i2 = 2 * Math.PI / t2;
    for (let o2 = 0; o2 < t2; ++o2) {
      const t3 = i2 * o2, c2 = [e2.x + Math.cos(-t3) * r2, e2.y + Math.sin(-t3) * r2];
      this.hasZ && c2.push(e2.z), s2.push(c2);
    }
    return s2.push(s2[0]), new v$15({ spatialReference: e2.spatialReference, rings: [s2] });
  }
  _convert2Meters(e2, r2) {
    let t2;
    if (r2.wkid && r$1O[r2.wkid] != null)
      t2 = r$1O.values[r$1O[r2.wkid]];
    else {
      const e3 = r2.wkt, s2 = e3.lastIndexOf(",") + 1, i2 = e3.lastIndexOf("]]");
      t2 = parseFloat(e3.substring(s2, i2));
    }
    return e2 * t2;
  }
};
e$2g([y$1I({ type: w$_ })], h$8.prototype, "center", void 0), e$2g([y$1I()], h$8.prototype, "geodesic", void 0), e$2g([y$1I()], h$8.prototype, "numberOfPoints", void 0), e$2g([y$1I()], h$8.prototype, "radius", void 0), e$2g([y$1I()], h$8.prototype, "radiusUnit", void 0), h$8 = d$5 = e$2g([n$2P("esri.geometry.Circle")], h$8);
const m$a = h$8;
function l$b(e2) {
  return u$7(e2).result;
}
function m$9(e2) {
  return u$7(e2).geometry;
}
function u$7(l2) {
  var _a2;
  if (((_a2 = l2.layer) == null ? void 0 : _a2.type) !== "graphics")
    return { result: P$2.GRAPHICS_LAYER_MISSING, geometry: null };
  if (t$2r(l2.geometry))
    return { result: P$2.GEOMETRY_MISSING, geometry: null };
  return l$s(l2) !== "on-the-ground" && c$s(l2) ? { result: P$2.ELEVATION_MODE_UNSUPPORTED, geometry: null } : l2.geometry.type !== "point" && l2.geometry.type !== "polyline" && (l2.geometry.type !== "polygon" || l2.geometry instanceof m$a) ? { result: P$2.GEOMETRY_TYPE_UNSUPPORTED, geometry: null } : { result: P$2.SUPPORTED, geometry: l2.geometry };
}
function i$7(i2) {
  var _a2;
  if (((_a2 = i2.layer) == null ? void 0 : _a2.type) !== "graphics")
    return P$2.GRAPHICS_LAYER_MISSING;
  if (t$2r(i2.geometry))
    return P$2.GEOMETRY_MISSING;
  switch (i2.geometry.type) {
    case "point":
      break;
    case "polygon":
    case "polyline":
    case "multipoint":
    case "extent":
    case "mesh":
      return P$2.SUPPORTED;
    default:
      return P$2.GEOMETRY_TYPE_UNSUPPORTED;
  }
  const n2 = r$1$(i2.symbol) && i2.symbol.type === "point-3d" && i2.symbol.symbolLayers;
  if (!(n2 && n2.length > 0 && n2.some((e2) => e2.type === "object")))
    return P$2.SYMBOL_TYPE_UNSUPPORTED;
  return l$s(i2) !== "on-the-ground" && c$s(i2) ? P$2.ELEVATION_MODE_UNSUPPORTED : P$2.SUPPORTED;
}
function e$6(r2, e2, n2) {
  if (!e2 || !r2 || !r2.map)
    return;
  const { map: s2 } = r2, a2 = s2.layers.find((r3) => r3 === e2);
  a2 || s2.add(e2, n2), n2 != null && s2.layers.reorder(a2, n2);
}
function n$a(e2, n2) {
  return e2.allLayerViews.find((e3) => {
    const s2 = e3.layer;
    return s2 === n2 || "sublayers" in s2 && r$1$(s2.sublayers) && s2.sublayers.includes(n2);
  });
}
function a$6(a2, n2) {
  const t2 = l$a[a2.toLowerCase()];
  if (t2 == null)
    throw new Error("Function Not Recognised");
  if (n2.length < t2.minParams || n2.length > t2.maxParams)
    throw new Error(`Invalid Parameter count for call to ${a2.toUpperCase()}`);
  return t2.evaluate(n2);
}
function n$9(a2, n2) {
  const t2 = l$a[a2.toLowerCase()];
  return t2 != null && n2 >= t2.minParams && n2 <= t2.maxParams;
}
const l$a = { min: { minParams: 1, maxParams: 1, evaluate: (a2) => a2[0] == null ? null : Math.min.apply(Math, a2[0]) }, max: { minParams: 1, maxParams: 1, evaluate: (a2) => a2[0] == null ? null : Math.max.apply(Math, a2[0]) }, avg: { minParams: 1, maxParams: 1, evaluate: (a2) => a2[0] == null ? null : t$8(a2[0]) }, sum: { minParams: 1, maxParams: 1, evaluate: (a2) => a2[0] == null ? null : r$8(a2[0]) }, stddev: { minParams: 1, maxParams: 1, evaluate: (a2) => a2[0] == null ? null : Math.sqrt(e$5(a2[0])) }, count: { minParams: 1, maxParams: 1, evaluate: (a2) => a2[0] == null ? null : a2[0].length }, var: { minParams: 1, maxParams: 1, evaluate: (a2) => a2[0] == null ? null : e$5(a2[0]) } };
function t$8(a2) {
  let n2 = 0;
  for (let l2 = 0; l2 < a2.length; l2++)
    n2 += a2[l2];
  return n2 / a2.length;
}
function r$8(a2) {
  let n2 = 0;
  for (let l2 = 0; l2 < a2.length; l2++)
    n2 += a2[l2];
  return n2;
}
function e$5(a2) {
  const n2 = t$8(a2), l2 = a2.length;
  let r2 = 0;
  for (const t2 of a2)
    r2 += (t2 - n2) ** 2;
  return l2 > 1 ? r2 / (l2 - 1) : 0;
}
class e$4 {
  constructor() {
    this.op = "+", this.day = 0, this.second = 0, this.hour = 0, this.month = 0, this.year = 0, this.minute = 0;
  }
  static _fixDefaults(a2) {
    if (a2.precision !== null || a2.secondary !== null)
      throw new Error("Primary and Secondary SqlInterval qualifiers not supported");
  }
  static createFromMilliseconds(a2) {
    const r2 = new e$4();
    return r2.second = a2 / 1e3, r2;
  }
  static createFromValueAndQualifer(a2, r2, t2) {
    let n2 = null;
    const l2 = new e$4();
    if (l2.op = t2 === "-" ? "-" : "+", r2.type === "interval-period") {
      e$4._fixDefaults(r2);
      const t3 = new RegExp("^[0-9]{1,}$");
      if (r2.period === "year" || r2.period === "month")
        throw new Error("Year-Month Intervals not supported");
      if (!t3.test(a2))
        throw new Error("Illegal Interval");
      l2[r2.period] = parseFloat(a2);
    } else {
      if (e$4._fixDefaults(r2.start), e$4._fixDefaults(r2.end), r2.start.period === "year" || r2.start.period === "month")
        throw new Error("Year-Month Intervals not supported");
      if (r2.end.period === "year" || r2.end.period === "month")
        throw new Error("Year-Month Intervals not supported");
      switch (r2.start.period) {
        case "day":
          switch (r2.end.period) {
            case "hour":
              if (n2 = new RegExp("^[0-9]{1,} [0-9]{1,}$"), !n2.test(a2))
                throw new Error("Illegal Interval");
              l2[r2.start.period] = parseFloat(a2.split(" ")[0]), l2[r2.end.period] = parseFloat(a2.split(" ")[1]);
              break;
            case "minute":
              if (n2 = new RegExp("^[0-9]{1,} [0-9]{1,2}:[0-9]{1,}$"), !n2.test(a2))
                throw new Error("Illegal Interval");
              {
                l2[r2.start.period] = parseFloat(a2.split(" ")[0]);
                const e2 = a2.split(" ")[1].split(":");
                l2.hour = parseFloat(e2[0]), l2.minute = parseFloat(e2[1]);
              }
              break;
            case "second":
              if (n2 = new RegExp("^[0-9]{1,} [0-9]{1,2}:[0-9]{1,2}:[0-9]{1,}([.]{1}[0-9]{1,}){0,1}$"), !n2.test(a2))
                throw new Error("Illegal Interval");
              {
                l2[r2.start.period] = parseFloat(a2.split(" ")[0]);
                const e2 = a2.split(" ")[1].split(":");
                l2.hour = parseFloat(e2[0]), l2.minute = parseFloat(e2[1]), l2.second = parseFloat(e2[2]);
              }
              break;
            default:
              throw new Error("Invalid Interval.");
          }
          break;
        case "hour":
          switch (r2.end.period) {
            case "minute":
              if (n2 = new RegExp("^[0-9]{1,}:[0-9]{1,}$"), !n2.test(a2))
                throw new Error("Illegal Interval");
              l2.hour = parseFloat(a2.split(":")[0]), l2.minute = parseFloat(a2.split(":")[1]);
              break;
            case "second":
              if (n2 = new RegExp("^[0-9]{1,}:[0-9]{1,2}:[0-9]{1,}([.]{1}[0-9]{1,}){0,1}$"), !n2.test(a2))
                throw new Error("Illegal Interval");
              {
                const e2 = a2.split(":");
                l2.hour = parseFloat(e2[0]), l2.minute = parseFloat(e2[1]), l2.second = parseFloat(e2[2]);
              }
              break;
            default:
              throw new Error("Invalid Interval.");
          }
          break;
        case "minute":
          if (r2.end.period !== "second")
            throw new Error("Invalid Interval.");
          if (n2 = new RegExp("^[0-9]{1,}:[0-9]{1,}([.]{1}[0-9]{1,}){0,1}$"), !n2.test(a2))
            throw new Error("Illegal Interval");
          {
            const e2 = a2.split(":");
            l2.minute = parseFloat(e2[0]), l2.second = parseFloat(e2[1]);
          }
          break;
        default:
          throw new Error("Invalid Interval.");
      }
    }
    return l2;
  }
  valueInMilliseconds() {
    return (this.op === "-" ? -1 : 1) * (1e3 * this.second + 60 * this.minute * 1e3 + 60 * this.hour * 60 * 1e3 + 24 * this.day * 60 * 60 * 1e3 + this.month * (365 / 12) * 24 * 60 * 60 * 1e3 + 365 * this.year * 24 * 60 * 60 * 1e3);
  }
}
function r$7(a2, e2) {
  const r2 = n$8[a2.toLowerCase()];
  if (r2 == null)
    throw new Error("Function Not Recognised");
  if (e2.length < r2.minParams || e2.length > r2.maxParams)
    throw new Error(`Invalid Parameter count for call to ${a2.toUpperCase()}`);
  return r2.evaluate(e2);
}
function t$7(a2, e2) {
  const r2 = n$8[a2.toLowerCase()];
  return r2 != null && e2 >= r2.minParams && e2 <= r2.maxParams;
}
const n$8 = { extract: { minParams: 2, maxParams: 2, evaluate: ([a2, e2]) => {
  if (e2 == null)
    return null;
  if (e2 instanceof Date)
    switch (a2.toUpperCase()) {
      case "SECOND":
        return e2.getSeconds();
      case "MINUTE":
        return e2.getMinutes();
      case "HOUR":
        return e2.getHours();
      case "DAY":
        return e2.getDate();
      case "MONTH":
        return e2.getMonth() + 1;
      case "YEAR":
        return e2.getFullYear();
    }
  throw new Error("Invalid Parameter for call to EXTRACT");
} }, substring: { minParams: 2, maxParams: 3, evaluate: (a2) => {
  if (a2.length === 2) {
    const [e2, r2] = a2;
    return e2 == null || r2 == null ? null : e2.toString().substring(r2 - 1);
  }
  if (a2.length === 3) {
    const [e2, r2, t2] = a2;
    return e2 == null || r2 == null || t2 == null ? null : t2 <= 0 ? "" : e2.toString().substring(r2 - 1, r2 + t2 - 1);
  }
} }, position: { minParams: 2, maxParams: 2, evaluate: ([a2, e2]) => a2 == null || e2 == null ? null : e2.indexOf(a2) + 1 }, trim: { minParams: 2, maxParams: 3, evaluate: (e2) => {
  const r2 = e2.length === 3, t2 = r2 ? e2[1] : " ", n2 = r2 ? e2[2] : e2[1];
  if (t2 == null || n2 == null)
    return null;
  const l2 = `(${o$2p(t2)})`;
  switch (e2[0]) {
    case "BOTH":
      return n2.replace(new RegExp(`^${l2}*|${l2}*$`, "g"), "");
    case "LEADING":
      return n2.replace(new RegExp(`^${l2}*`, "g"), "");
    case "TRAILING":
      return n2.replace(new RegExp(`${l2}*$`, "g"), "");
  }
  throw new Error("Invalid Parameter for call to TRIM");
} }, abs: { minParams: 1, maxParams: 1, evaluate: (a2) => a2[0] == null ? null : Math.abs(a2[0]) }, ceiling: { minParams: 1, maxParams: 1, evaluate: (a2) => a2[0] == null ? null : Math.ceil(a2[0]) }, floor: { minParams: 1, maxParams: 1, evaluate: (a2) => a2[0] == null ? null : Math.floor(a2[0]) }, log: { minParams: 1, maxParams: 1, evaluate: (a2) => a2[0] == null ? null : Math.log(a2[0]) }, log10: { minParams: 1, maxParams: 1, evaluate: (a2) => a2[0] == null ? null : Math.log(a2[0]) * Math.LOG10E }, sin: { minParams: 1, maxParams: 1, evaluate: (a2) => a2[0] == null ? null : Math.sin(a2[0]) }, cos: { minParams: 1, maxParams: 1, evaluate: (a2) => a2[0] == null ? null : Math.cos(a2[0]) }, tan: { minParams: 1, maxParams: 1, evaluate: (a2) => a2[0] == null ? null : Math.tan(a2[0]) }, asin: { minParams: 1, maxParams: 1, evaluate: (a2) => a2[0] == null ? null : Math.asin(a2[0]) }, acos: { minParams: 1, maxParams: 1, evaluate: (a2) => a2[0] == null ? null : Math.acos(a2[0]) }, atan: { minParams: 1, maxParams: 1, evaluate: (a2) => a2[0] == null ? null : Math.atan(a2[0]) }, sign: { minParams: 1, maxParams: 1, evaluate: (a2) => a2[0] == null ? null : a2[0] > 0 ? 1 : a2[1] < 0 ? -1 : 0 }, power: { minParams: 2, maxParams: 2, evaluate: (a2) => a2[0] == null || a2[1] == null ? null : a2[0] ** a2[1] }, mod: { minParams: 2, maxParams: 2, evaluate: (a2) => a2[0] == null || a2[1] == null ? null : a2[0] % a2[1] }, round: { minParams: 1, maxParams: 2, evaluate: (a2) => {
  const e2 = a2[0], r2 = a2.length === 2 ? 10 ** a2[1] : 1;
  return e2 == null ? null : Math.round(e2 * r2) / r2;
} }, truncate: { minParams: 1, maxParams: 2, evaluate: (a2) => a2[0] == null ? null : a2.length === 1 ? parseInt(a2[0].toFixed(0), 10) : parseFloat(a2[0].toFixed(a2[1])) }, char_length: { minParams: 1, maxParams: 1, evaluate: (a2) => typeof a2[0] == "string" || a2[0] instanceof String ? a2[0].length : 0 }, concat: { minParams: 1, maxParams: 1 / 0, evaluate: (a2) => {
  let e2 = "";
  for (let r2 = 0; r2 < a2.length; r2++) {
    if (a2[r2] == null)
      return null;
    e2 += a2[r2].toString();
  }
  return e2;
} }, lower: { minParams: 1, maxParams: 1, evaluate: (a2) => a2[0] == null ? null : a2[0].toString().toLowerCase() }, upper: { minParams: 1, maxParams: 1, evaluate: (a2) => a2[0] == null ? null : a2[0].toString().toUpperCase() } };
var n$7, t$6, e$3 = { exports: {} };
t$6 = function() {
  function r2(r3, n3) {
    function t3() {
      this.constructor = r3;
    }
    t3.prototype = n3.prototype, r3.prototype = new t3();
  }
  function n2(r3, t3, e3, u2) {
    var o2 = Error.call(this, r3);
    return Object.setPrototypeOf && Object.setPrototypeOf(o2, n2.prototype), o2.expected = t3, o2.found = e3, o2.location = u2, o2.name = "SyntaxError", o2;
  }
  function t2(r3, n3, t3) {
    return t3 = t3 || " ", r3.length > n3 ? r3 : (n3 -= r3.length, r3 + (t3 += t3.repeat(n3)).slice(0, n3));
  }
  function e2(r3, t3) {
    var e3, u2 = {}, o2 = (t3 = t3 !== void 0 ? t3 : {}).grammarSource, i2 = { start: ke2 }, s2 = ke2, a2 = "!", c2 = "=", f2 = ">=", l2 = ">", p2 = "<=", v2 = "<>", d2 = "<", h2 = "!=", y2 = "+", b2 = "-", A2 = "*", g2 = "/", C2 = "@", m2 = "'", E2 = "N'", x2 = "''", L2 = ".", w2 = "null", T2 = "true", N2 = "false", O2 = "in", R2 = "is", F2 = "like", I2 = "escape", S2 = "not", M2 = "and", D2 = "or", H2 = "between", j2 = "from", U2 = "for", P2 = "substring", _2 = "extract", B2 = "trim", z2 = "position", G2 = "timestamp", Z2 = "date", W2 = "leading", Y2 = "trailing", k2 = "both", q2 = "to", K2 = "interval", V2 = "year", X2 = "month", $2 = "day", J2 = "hour", Q2 = "minute", rr = "second", nr = "case", tr = "end", er = "when", ur = "then", or = "else", ir = ",", sr = "(", ar = ")", cr = "`", fr = /^[A-Za-z_\x80-\uFFFF]/, lr = /^[A-Za-z0-9_]/, pr = /^[A-Za-z0-9_.\x80-\uFFFF]/, vr = /^[^']/, dr = /^[0-9]/, hr = /^[eE]/, yr = /^[+\-]/, br = /^[ \t\n\r]/, Ar = /^[^`]/, gr = _e3("!", false), Cr = _e3("=", false), mr = _e3(">=", false), Er = _e3(">", false), xr = _e3("<=", false), Lr = _e3("<>", false), wr = _e3("<", false), Tr = _e3("!=", false), Nr = _e3("+", false), Or = _e3("-", false), Rr = _e3("*", false), Fr = _e3("/", false), Ir = Be2([["A", "Z"], ["a", "z"], "_", ["\x80", "\uFFFF"]], false, false), Sr = Be2([["A", "Z"], ["a", "z"], ["0", "9"], "_"], false, false), Mr = Be2([["A", "Z"], ["a", "z"], ["0", "9"], "_", ".", ["\x80", "\uFFFF"]], false, false), Dr = _e3("@", false), Hr = _e3("'", false), jr = _e3("N'", false), Ur = _e3("''", false), Pr = Be2(["'"], true, false), _r = _e3(".", false), Br = Be2([["0", "9"]], false, false), zr = Be2(["e", "E"], false, false), Gr = Be2(["+", "-"], false, false), Zr = _e3("NULL", true), Wr = _e3("TRUE", true), Yr = _e3("FALSE", true), kr = _e3("IN", true), qr = _e3("IS", true), Kr = _e3("LIKE", true), Vr = _e3("ESCAPE", true), Xr = _e3("NOT", true), $r = _e3("AND", true), Jr = _e3("OR", true), Qr = _e3("BETWEEN", true), rn2 = _e3("FROM", true), nn2 = _e3("FOR", true), tn2 = _e3("SUBSTRING", true), en2 = _e3("EXTRACT", true), un2 = _e3("TRIM", true), on2 = _e3("POSITION", true), sn2 = _e3("TIMESTAMP", true), an = _e3("DATE", true), cn2 = _e3("LEADING", true), fn2 = _e3("TRAILING", true), ln2 = _e3("BOTH", true), pn2 = _e3("TO", true), vn2 = _e3("INTERVAL", true), dn = _e3("YEAR", true), hn2 = _e3("MONTH", true), yn = _e3("DAY", true), bn2 = _e3("HOUR", true), An2 = _e3("MINUTE", true), gn2 = _e3("SECOND", true), Cn = _e3("CASE", true), mn2 = _e3("END", true), En2 = _e3("WHEN", true), xn2 = _e3("THEN", true), Ln2 = _e3("ELSE", true), wn2 = _e3(",", false), Tn2 = _e3("(", false), Nn = _e3(")", false), On = Be2([" ", "	", "\n", "\r"], false, false), Rn = _e3("`", false), Fn = Be2(["`"], true, false), In2 = function(r4) {
      return r4;
    }, Sn = function(r4, n3) {
      var t4 = { type: "expression-list" }, e4 = qo(r4, n3);
      return t4.value = e4, t4;
    }, Mn2 = function(r4, n3) {
      return Ko(r4, n3);
    }, Dn2 = function(r4, n3) {
      return Ko(r4, n3);
    }, Hn2 = function(r4) {
      return Wo("NOT", r4);
    }, jn2 = function(r4, n3) {
      return n3 == "" || n3 == null || n3 == null ? r4 : n3.type == "arithmetic" ? Ko(r4, n3.tail) : Yo(n3.op, r4, n3.right, n3.escape);
    }, Un2 = function(r4) {
      return { type: "arithmetic", tail: r4 };
    }, Pn2 = function(r4, n3) {
      return { op: r4 + "NOT", right: n3 };
    }, _n2 = function(r4, n3) {
      return { op: r4, right: n3 };
    }, Bn2 = function(r4, n3, t4) {
      return { op: "NOT" + r4, right: { type: "expression-list", value: [n3, t4] } };
    }, zn = function(r4, n3, t4) {
      return { op: r4, right: { type: "expression-list", value: [n3, t4] } };
    }, Gn2 = function(r4) {
      return r4[0] + " " + r4[2];
    }, Zn2 = function(r4) {
      return r4[0] + " " + r4[2];
    }, Wn2 = function(r4, n3, t4) {
      return { op: r4, right: n3, escape: t4.value };
    }, Yn2 = function(r4, n3) {
      return { op: r4, right: n3, escape: "" };
    }, kn = function(r4, n3) {
      return { op: r4, right: n3 };
    }, qn = function(r4) {
      return { op: r4, right: { type: "expression-list", value: [] } };
    }, Kn = function(r4, n3) {
      return { op: r4, right: n3 };
    }, Vn2 = function(r4, n3) {
      return Ko(r4, n3);
    }, Xn2 = function(r4, n3) {
      return Ko(r4, n3);
    }, $n2 = function(r4) {
      return r4.paren = true, r4;
    }, Jn2 = function(r4) {
      return /^CURRENT_DATE$/i.test(r4) ? { type: "current-time", mode: "date" } : /^CURRENT_TIMESTAMP$/i.test(r4) ? { type: "current-time", mode: "timestamp" } : { type: "column-reference", table: "", column: r4 };
    }, Qn2 = function(r4) {
      return r4;
    }, rt2 = function(r4, n3) {
      return r4 + n3.join("");
    }, nt2 = function(r4, n3) {
      return r4 + n3.join("");
    }, tt2 = function(r4) {
      return { type: "parameter", value: r4[1] };
    }, et2 = function(r4, n3) {
      return { type: "function", name: "extract", args: { type: "expression-list", value: [{ type: "string", value: r4 }, n3] } };
    }, ut2 = function(r4, n3, t4) {
      return { type: "function", name: "substring", args: { type: "expression-list", value: t4 ? [r4, n3, t4[2]] : [r4, n3] } };
    }, ot2 = function(r4, n3, t4) {
      return { type: "function", name: "trim", args: { type: "expression-list", value: [{ type: "string", value: r4 != null ? r4 : "BOTH" }, n3, t4] } };
    }, it2 = function(r4, n3) {
      return { type: "function", name: "trim", args: { type: "expression-list", value: [{ type: "string", value: r4 != null ? r4 : "BOTH" }, n3] } };
    }, st2 = function(r4, n3) {
      return { type: "function", name: "position", args: { type: "expression-list", value: [r4, n3] } };
    }, at2 = function(r4, n3) {
      return { type: "function", name: r4, args: n3 || { type: "expression-list", value: [] } };
    }, ct2 = function(r4) {
      return { type: "timestamp", value: r4.value };
    }, ft2 = function(r4, n3, t4) {
      return { type: "interval", value: n3, qualifier: t4, op: r4 };
    }, lt2 = function(r4, n3) {
      return { type: "interval", value: r4, qualifier: n3, op: "" };
    }, pt2 = function(r4, n3) {
      return { type: "interval-qualifier", start: r4, end: n3 };
    }, vt2 = function(r4, n3) {
      return { type: "interval-period", period: r4.value, precision: n3, secondary: null };
    }, dt2 = function(r4) {
      return { type: "interval-period", period: r4.value, precision: null, secondary: null };
    }, ht2 = function(r4) {
      return { type: "interval-period", period: r4.value, precision: null, secondary: null };
    }, yt2 = function(r4, n3) {
      return { type: "interval-period", period: "second", precision: r4, secondary: n3 };
    }, bt2 = function(r4) {
      return { type: "interval-period", period: "second", precision: r4, secondary: null };
    }, At2 = function() {
      return { type: "interval-period", period: "second", precision: null, secondary: null };
    }, gt2 = function(r4, n3) {
      return { type: "interval-period", period: r4.value, precision: n3, secondary: null };
    }, Ct2 = function(r4) {
      return { type: "interval-period", period: r4.value, precision: null, secondary: null };
    }, mt2 = function(r4, n3) {
      return { type: "interval-period", period: "second", precision: r4, secondary: n3 };
    }, Et2 = function(r4) {
      return { type: "interval-period", period: "second", precision: r4, secondary: null };
    }, xt2 = function() {
      return { type: "interval-period", period: "second", precision: null, secondary: null };
    }, Lt2 = function() {
      return { type: "string", value: "day" };
    }, wt2 = function() {
      return { type: "string", value: "hour" };
    }, Tt2 = function() {
      return { type: "string", value: "minute" };
    }, Nt2 = function() {
      return { type: "string", value: "month" };
    }, Ot2 = function() {
      return { type: "string", value: "year" };
    }, Rt2 = function(r4) {
      return parseFloat(r4);
    }, Ft2 = function(r4) {
      return parseFloat(r4);
    }, It2 = function(r4) {
      return { type: "date", value: r4.value };
    }, St2 = function() {
      return { type: "null", value: null };
    }, Mt2 = function() {
      return { type: "boolean", value: true };
    }, Dt = function() {
      return { type: "boolean", value: false };
    }, Ht = function() {
      return "'";
    }, jt2 = function(r4) {
      return { type: "string", value: r4.join("") };
    }, Ut2 = function(r4, n3) {
      return { type: "case-expression", format: "simple", operand: r4, clauses: n3, else: null };
    }, Pt2 = function(r4, n3, t4) {
      return { type: "case-expression", format: "simple", operand: r4, clauses: n3, else: t4.value };
    }, _t = function(r4) {
      return { type: "case-expression", format: "searched", clauses: r4, else: null };
    }, Bt2 = function(r4, n3) {
      return { type: "case-expression", format: "searched", clauses: r4, else: n3.value };
    }, zt = function(r4, n3) {
      return { type: "when-clause", operand: r4, value: n3 };
    }, Gt2 = function(r4, n3) {
      return { type: "when-clause", operand: r4, value: n3 };
    }, Zt = function(r4) {
      return { type: "else-clause", value: r4 };
    }, Wt = function(r4) {
      return { type: "number", value: r4 };
    }, Yt = function(r4, n3, t4) {
      return parseFloat(r4 + n3 + t4);
    }, kt2 = function(r4, n3) {
      return parseFloat(r4 + n3);
    }, qt2 = function(r4, n3) {
      return parseFloat(r4 + n3);
    }, Kt = function(r4) {
      return parseFloat(r4);
    }, Vt = function(r4, n3) {
      return r4[0] + n3;
    }, Xt = function(r4) {
      return "." + (r4 != null ? r4 : "");
    }, $t2 = function(r4, n3) {
      return r4 + n3;
    }, Jt2 = function(r4) {
      return r4.join("");
    }, Qt = function(r4, n3) {
      return "e" + (n3 === null ? "" : n3);
    }, re2 = function() {
      return "IN";
    }, ne2 = function() {
      return "IS";
    }, te2 = function() {
      return "LIKE";
    }, ee2 = function() {
      return "ESCAPE";
    }, ue2 = function() {
      return "NOT";
    }, oe2 = function() {
      return "AND";
    }, ie2 = function() {
      return "OR";
    }, se2 = function() {
      return "BETWEEN";
    }, ae2 = function() {
      return "FROM";
    }, ce2 = function() {
      return "FOR";
    }, fe2 = function() {
      return "SUBSTRING";
    }, le2 = function() {
      return "EXTRACT";
    }, pe2 = function() {
      return "TRIM";
    }, ve2 = function() {
      return "POSITION";
    }, de2 = function() {
      return "TIMESTAMP";
    }, he2 = function() {
      return "DATE";
    }, ye2 = function() {
      return "LEADING";
    }, be2 = function() {
      return "TRAILING";
    }, Ae2 = function() {
      return "BOTH";
    }, ge2 = function() {
      return "TO";
    }, Ce2 = function() {
      return "INTERVAL";
    }, me2 = function() {
      return "YEAR";
    }, Ee2 = function() {
      return "MONTH";
    }, xe2 = function() {
      return "DAY";
    }, Le2 = function() {
      return "HOUR";
    }, we2 = function() {
      return "MINUTE";
    }, Te2 = function() {
      return "SECOND";
    }, Ne2 = function() {
      return "CASE";
    }, Oe2 = function() {
      return "END";
    }, Re = function() {
      return "WHEN";
    }, Fe2 = function() {
      return "THEN";
    }, Ie2 = function() {
      return "ELSE";
    }, Se2 = function(r4) {
      return r4;
    }, Me2 = function(r4) {
      return r4.join("");
    }, De = 0, He2 = [{ line: 1, column: 1 }], je2 = 0, Ue2 = [], Pe2 = 0;
    if ("startRule" in t3) {
      if (!(t3.startRule in i2))
        throw new Error(`Can't start parsing from rule "` + t3.startRule + '".');
      s2 = i2[t3.startRule];
    }
    function _e3(r4, n3) {
      return { type: "literal", text: r4, ignoreCase: n3 };
    }
    function Be2(r4, n3, t4) {
      return { type: "class", parts: r4, inverted: n3, ignoreCase: t4 };
    }
    function ze2() {
      return { type: "end" };
    }
    function Ge2(n3) {
      var t4, e4 = He2[n3];
      if (e4)
        return e4;
      for (t4 = n3 - 1; !He2[t4]; )
        t4--;
      for (e4 = { line: (e4 = He2[t4]).line, column: e4.column }; t4 < n3; )
        r3.charCodeAt(t4) === 10 ? (e4.line++, e4.column = 1) : e4.column++, t4++;
      return He2[n3] = e4, e4;
    }
    function Ze2(r4, n3) {
      var t4 = Ge2(r4), e4 = Ge2(n3);
      return { source: o2, start: { offset: r4, line: t4.line, column: t4.column }, end: { offset: n3, line: e4.line, column: e4.column } };
    }
    function We2(r4) {
      De < je2 || (De > je2 && (je2 = De, Ue2 = []), Ue2.push(r4));
    }
    function Ye(r4, t4, e4) {
      return new n2(n2.buildMessage(r4, t4), r4, t4, e4);
    }
    function ke2() {
      var r4, n3;
      return r4 = De, zo(), (n3 = Ke2()) !== u2 ? (zo(), r4 = In2(n3)) : (De = r4, r4 = u2), r4;
    }
    function qe() {
      var r4, n3, t4, e4, o3, i3, s3, a3;
      if (r4 = De, (n3 = Ke2()) !== u2) {
        for (t4 = [], e4 = De, o3 = zo(), (i3 = Po()) !== u2 ? (s3 = zo(), (a3 = Ke2()) !== u2 ? e4 = o3 = [o3, i3, s3, a3] : (De = e4, e4 = u2)) : (De = e4, e4 = u2); e4 !== u2; )
          t4.push(e4), e4 = De, o3 = zo(), (i3 = Po()) !== u2 ? (s3 = zo(), (a3 = Ke2()) !== u2 ? e4 = o3 = [o3, i3, s3, a3] : (De = e4, e4 = u2)) : (De = e4, e4 = u2);
        r4 = Sn(n3, t4);
      } else
        De = r4, r4 = u2;
      return r4;
    }
    function Ke2() {
      var r4, n3, t4, e4, o3, i3, s3, a3;
      if (r4 = De, (n3 = Ve2()) !== u2) {
        for (t4 = [], e4 = De, o3 = zo(), (i3 = lo()) !== u2 ? (s3 = zo(), (a3 = Ve2()) !== u2 ? e4 = o3 = [o3, i3, s3, a3] : (De = e4, e4 = u2)) : (De = e4, e4 = u2); e4 !== u2; )
          t4.push(e4), e4 = De, o3 = zo(), (i3 = lo()) !== u2 ? (s3 = zo(), (a3 = Ve2()) !== u2 ? e4 = o3 = [o3, i3, s3, a3] : (De = e4, e4 = u2)) : (De = e4, e4 = u2);
        r4 = Mn2(n3, t4);
      } else
        De = r4, r4 = u2;
      return r4;
    }
    function Ve2() {
      var r4, n3, t4, e4, o3, i3, s3, a3;
      if (r4 = De, (n3 = Xe()) !== u2) {
        for (t4 = [], e4 = De, o3 = zo(), (i3 = fo()) !== u2 ? (s3 = zo(), (a3 = Xe()) !== u2 ? e4 = o3 = [o3, i3, s3, a3] : (De = e4, e4 = u2)) : (De = e4, e4 = u2); e4 !== u2; )
          t4.push(e4), e4 = De, o3 = zo(), (i3 = fo()) !== u2 ? (s3 = zo(), (a3 = Xe()) !== u2 ? e4 = o3 = [o3, i3, s3, a3] : (De = e4, e4 = u2)) : (De = e4, e4 = u2);
        r4 = Dn2(n3, t4);
      } else
        De = r4, r4 = u2;
      return r4;
    }
    function Xe() {
      var n3, t4, e4, o3, i3;
      return n3 = De, (t4 = co()) === u2 && (t4 = De, r3.charCodeAt(De) === 33 ? (e4 = a2, De++) : (e4 = u2, Pe2 === 0 && We2(gr)), e4 !== u2 ? (o3 = De, Pe2++, r3.charCodeAt(De) === 61 ? (i3 = c2, De++) : (i3 = u2, Pe2 === 0 && We2(Cr)), Pe2--, i3 === u2 ? o3 = void 0 : (De = o3, o3 = u2), o3 !== u2 ? t4 = e4 = [e4, o3] : (De = t4, t4 = u2)) : (De = t4, t4 = u2)), t4 !== u2 ? (e4 = zo(), (o3 = Xe()) !== u2 ? n3 = Hn2(o3) : (De = n3, n3 = u2)) : (De = n3, n3 = u2), n3 === u2 && (n3 = $e2()), n3;
    }
    function $e2() {
      var r4, n3, t4;
      return r4 = De, (n3 = su()) !== u2 ? (zo(), (t4 = Je2()) === u2 && (t4 = null), r4 = jn2(n3, t4)) : (De = r4, r4 = u2), r4;
    }
    function Je2() {
      var r4;
      return (r4 = Qe2()) === u2 && (r4 = iu()) === u2 && (r4 = tu()) === u2 && (r4 = nu()) === u2 && (r4 = ou()), r4;
    }
    function Qe2() {
      var r4, n3, t4, e4, o3, i3;
      if (r4 = [], n3 = De, t4 = zo(), (e4 = ru()) !== u2 ? (o3 = zo(), (i3 = su()) !== u2 ? n3 = t4 = [t4, e4, o3, i3] : (De = n3, n3 = u2)) : (De = n3, n3 = u2), n3 !== u2)
        for (; n3 !== u2; )
          r4.push(n3), n3 = De, t4 = zo(), (e4 = ru()) !== u2 ? (o3 = zo(), (i3 = su()) !== u2 ? n3 = t4 = [t4, e4, o3, i3] : (De = n3, n3 = u2)) : (De = n3, n3 = u2);
      else
        r4 = u2;
      return r4 !== u2 && (r4 = Un2(r4)), r4;
    }
    function ru() {
      var n3;
      return r3.substr(De, 2) === f2 ? (n3 = f2, De += 2) : (n3 = u2, Pe2 === 0 && We2(mr)), n3 === u2 && (r3.charCodeAt(De) === 62 ? (n3 = l2, De++) : (n3 = u2, Pe2 === 0 && We2(Er)), n3 === u2 && (r3.substr(De, 2) === p2 ? (n3 = p2, De += 2) : (n3 = u2, Pe2 === 0 && We2(xr)), n3 === u2 && (r3.substr(De, 2) === v2 ? (n3 = v2, De += 2) : (n3 = u2, Pe2 === 0 && We2(Lr)), n3 === u2 && (r3.charCodeAt(De) === 60 ? (n3 = d2, De++) : (n3 = u2, Pe2 === 0 && We2(wr)), n3 === u2 && (r3.charCodeAt(De) === 61 ? (n3 = c2, De++) : (n3 = u2, Pe2 === 0 && We2(Cr)), n3 === u2 && (r3.substr(De, 2) === h2 ? (n3 = h2, De += 2) : (n3 = u2, Pe2 === 0 && We2(Tr)))))))), n3;
    }
    function nu() {
      var r4, n3, t4, e4;
      return r4 = De, (n3 = io()) !== u2 ? (zo(), (t4 = co()) !== u2 ? (zo(), (e4 = su()) !== u2 ? r4 = Pn2(n3, e4) : (De = r4, r4 = u2)) : (De = r4, r4 = u2)) : (De = r4, r4 = u2), r4 === u2 && (r4 = De, (n3 = io()) !== u2 ? (zo(), (t4 = su()) !== u2 ? r4 = _n2(n3, t4) : (De = r4, r4 = u2)) : (De = r4, r4 = u2)), r4;
    }
    function tu() {
      var r4, n3, t4, e4, o3, i3;
      return r4 = De, (n3 = co()) !== u2 ? (zo(), (t4 = po()) !== u2 ? (zo(), (e4 = su()) !== u2 ? (zo(), (o3 = fo()) !== u2 ? (zo(), (i3 = su()) !== u2 ? r4 = Bn2(t4, e4, i3) : (De = r4, r4 = u2)) : (De = r4, r4 = u2)) : (De = r4, r4 = u2)) : (De = r4, r4 = u2)) : (De = r4, r4 = u2), r4 === u2 && (r4 = De, (n3 = po()) !== u2 ? (zo(), (t4 = su()) !== u2 ? (zo(), (e4 = fo()) !== u2 ? (zo(), (o3 = su()) !== u2 ? r4 = zn(n3, t4, o3) : (De = r4, r4 = u2)) : (De = r4, r4 = u2)) : (De = r4, r4 = u2)) : (De = r4, r4 = u2)), r4;
    }
    function eu() {
      var r4, n3, t4, e4, o3;
      return r4 = De, n3 = De, (t4 = co()) !== u2 ? (e4 = zo(), (o3 = so()) !== u2 ? n3 = t4 = [t4, e4, o3] : (De = n3, n3 = u2)) : (De = n3, n3 = u2), n3 !== u2 && (n3 = Gn2(n3)), (r4 = n3) === u2 && (r4 = so()), r4;
    }
    function uu() {
      var r4, n3, t4, e4, o3;
      return r4 = De, n3 = De, (t4 = co()) !== u2 ? (e4 = zo(), (o3 = oo()) !== u2 ? n3 = t4 = [t4, e4, o3] : (De = n3, n3 = u2)) : (De = n3, n3 = u2), n3 !== u2 && (n3 = Zn2(n3)), (r4 = n3) === u2 && (r4 = oo()), r4;
    }
    function ou() {
      var r4, n3, t4, e4;
      return r4 = De, (n3 = eu()) !== u2 ? (zo(), (t4 = Bu()) !== u2 ? (zo(), ao() !== u2 ? (zo(), (e4 = zu()) !== u2 ? r4 = Wn2(n3, t4, e4) : (De = r4, r4 = u2)) : (De = r4, r4 = u2)) : (De = r4, r4 = u2)) : (De = r4, r4 = u2), r4 === u2 && (r4 = De, (n3 = eu()) !== u2 ? (zo(), (t4 = Bu()) !== u2 ? r4 = Yn2(n3, t4) : (De = r4, r4 = u2)) : (De = r4, r4 = u2)), r4;
    }
    function iu() {
      var r4, n3, t4, e4;
      return r4 = De, (n3 = uu()) !== u2 ? (zo(), (t4 = _o()) !== u2 ? (zo(), (e4 = qe()) !== u2 ? (zo(), Bo() !== u2 ? r4 = kn(n3, e4) : (De = r4, r4 = u2)) : (De = r4, r4 = u2)) : (De = r4, r4 = u2)) : (De = r4, r4 = u2), r4 === u2 && (r4 = De, (n3 = uu()) !== u2 ? (zo(), (t4 = _o()) !== u2 ? (zo(), (e4 = Bo()) !== u2 ? r4 = qn(n3) : (De = r4, r4 = u2)) : (De = r4, r4 = u2)) : (De = r4, r4 = u2), r4 === u2 && (r4 = De, (n3 = uu()) !== u2 ? (zo(), (t4 = gu()) !== u2 ? r4 = Kn(n3, t4) : (De = r4, r4 = u2)) : (De = r4, r4 = u2))), r4;
    }
    function su() {
      var r4, n3, t4, e4, o3, i3, s3, a3;
      if (r4 = De, (n3 = cu()) !== u2) {
        for (t4 = [], e4 = De, o3 = zo(), (i3 = au()) !== u2 ? (s3 = zo(), (a3 = cu()) !== u2 ? e4 = o3 = [o3, i3, s3, a3] : (De = e4, e4 = u2)) : (De = e4, e4 = u2); e4 !== u2; )
          t4.push(e4), e4 = De, o3 = zo(), (i3 = au()) !== u2 ? (s3 = zo(), (a3 = cu()) !== u2 ? e4 = o3 = [o3, i3, s3, a3] : (De = e4, e4 = u2)) : (De = e4, e4 = u2);
        r4 = Vn2(n3, t4);
      } else
        De = r4, r4 = u2;
      return r4;
    }
    function au() {
      var n3;
      return r3.charCodeAt(De) === 43 ? (n3 = y2, De++) : (n3 = u2, Pe2 === 0 && We2(Nr)), n3 === u2 && (r3.charCodeAt(De) === 45 ? (n3 = b2, De++) : (n3 = u2, Pe2 === 0 && We2(Or))), n3;
    }
    function cu() {
      var r4, n3, t4, e4, o3, i3, s3, a3;
      if (r4 = De, (n3 = lu()) !== u2) {
        for (t4 = [], e4 = De, o3 = zo(), (i3 = fu()) !== u2 ? (s3 = zo(), (a3 = lu()) !== u2 ? e4 = o3 = [o3, i3, s3, a3] : (De = e4, e4 = u2)) : (De = e4, e4 = u2); e4 !== u2; )
          t4.push(e4), e4 = De, o3 = zo(), (i3 = fu()) !== u2 ? (s3 = zo(), (a3 = lu()) !== u2 ? e4 = o3 = [o3, i3, s3, a3] : (De = e4, e4 = u2)) : (De = e4, e4 = u2);
        r4 = Xn2(n3, t4);
      } else
        De = r4, r4 = u2;
      return r4;
    }
    function fu() {
      var n3;
      return r3.charCodeAt(De) === 42 ? (n3 = A2, De++) : (n3 = u2, Pe2 === 0 && We2(Rr)), n3 === u2 && (r3.charCodeAt(De) === 47 ? (n3 = g2, De++) : (n3 = u2, Pe2 === 0 && We2(Fr))), n3;
    }
    function lu() {
      var r4, n3;
      return (r4 = Nu()) === u2 && (r4 = Cu()) === u2 && (r4 = mu()) === u2 && (r4 = Eu()) === u2 && (r4 = Lu()) === u2 && (r4 = wu()) === u2 && (r4 = Gu()) === u2 && (r4 = pu()) === u2 && (r4 = gu()) === u2 && (r4 = De, _o() !== u2 ? (zo(), (n3 = Ke2()) !== u2 ? (zo(), Bo() !== u2 ? r4 = $n2(n3) : (De = r4, r4 = u2)) : (De = r4, r4 = u2)) : (De = r4, r4 = u2)), r4;
    }
    function pu() {
      var r4;
      return (r4 = vu()) !== u2 && (r4 = Jn2(r4)), r4;
    }
    function vu() {
      var r4;
      return (r4 = du()) !== u2 && (r4 = Qn2(r4)), r4;
    }
    function du() {
      var r4, n3, t4, e4;
      if (r4 = De, (n3 = yu()) !== u2) {
        for (t4 = [], e4 = Au(); e4 !== u2; )
          t4.push(e4), e4 = Au();
        r4 = rt2(n3, t4);
      } else
        De = r4, r4 = u2;
      return r4;
    }
    function hu() {
      var r4, n3, t4, e4;
      if (r4 = De, (n3 = yu()) !== u2) {
        for (t4 = [], e4 = bu(); e4 !== u2; )
          t4.push(e4), e4 = bu();
        r4 = nt2(n3, t4);
      } else
        De = r4, r4 = u2;
      return r4;
    }
    function yu() {
      var n3;
      return fr.test(r3.charAt(De)) ? (n3 = r3.charAt(De), De++) : (n3 = u2, Pe2 === 0 && We2(Ir)), n3;
    }
    function bu() {
      var n3;
      return lr.test(r3.charAt(De)) ? (n3 = r3.charAt(De), De++) : (n3 = u2, Pe2 === 0 && We2(Sr)), n3;
    }
    function Au() {
      var n3;
      return pr.test(r3.charAt(De)) ? (n3 = r3.charAt(De), De++) : (n3 = u2, Pe2 === 0 && We2(Mr)), n3;
    }
    function gu() {
      var n3, t4, e4;
      return n3 = De, r3.charCodeAt(De) === 64 ? (t4 = C2, De++) : (t4 = u2, Pe2 === 0 && We2(Dr)), t4 !== u2 && (e4 = hu()) !== u2 ? n3 = t4 = [t4, e4] : (De = n3, n3 = u2), n3 !== u2 && (n3 = tt2(n3)), n3;
    }
    function Cu() {
      var r4, n3, t4;
      return r4 = De, bo() !== u2 ? (zo(), _o() !== u2 ? (zo(), (n3 = Tu()) !== u2 ? (zo(), vo() !== u2 ? (zo(), (t4 = Ke2()) !== u2 ? (zo(), Bo() !== u2 ? r4 = et2(n3, t4) : (De = r4, r4 = u2)) : (De = r4, r4 = u2)) : (De = r4, r4 = u2)) : (De = r4, r4 = u2)) : (De = r4, r4 = u2)) : (De = r4, r4 = u2), r4;
    }
    function mu() {
      var r4, n3, t4, e4, o3, i3, s3;
      return r4 = De, yo() !== u2 ? (zo(), _o() !== u2 ? (zo(), (n3 = Ke2()) !== u2 ? (zo(), vo() !== u2 ? (zo(), (t4 = Ke2()) !== u2 ? (zo(), e4 = De, (o3 = ho()) !== u2 ? (i3 = zo(), (s3 = Ke2()) !== u2 ? e4 = o3 = [o3, i3, s3, zo()] : (De = e4, e4 = u2)) : (De = e4, e4 = u2), e4 === u2 && (e4 = null), (o3 = Bo()) !== u2 ? r4 = ut2(n3, t4, e4) : (De = r4, r4 = u2)) : (De = r4, r4 = u2)) : (De = r4, r4 = u2)) : (De = r4, r4 = u2)) : (De = r4, r4 = u2)) : (De = r4, r4 = u2), r4;
    }
    function Eu() {
      var r4, n3, t4, e4;
      return r4 = De, Ao() !== u2 ? (zo(), _o() !== u2 ? (zo(), (n3 = xu()) === u2 && (n3 = null), zo(), (t4 = Ke2()) !== u2 ? (zo(), vo() !== u2 ? (zo(), (e4 = Ke2()) !== u2 ? (zo(), Bo() !== u2 ? r4 = ot2(n3, t4, e4) : (De = r4, r4 = u2)) : (De = r4, r4 = u2)) : (De = r4, r4 = u2)) : (De = r4, r4 = u2)) : (De = r4, r4 = u2)) : (De = r4, r4 = u2), r4 === u2 && (r4 = De, Ao() !== u2 ? (zo(), _o() !== u2 ? (zo(), (n3 = xu()) === u2 && (n3 = null), zo(), (t4 = Ke2()) !== u2 ? (zo(), Bo() !== u2 ? r4 = it2(n3, t4) : (De = r4, r4 = u2)) : (De = r4, r4 = u2)) : (De = r4, r4 = u2)) : (De = r4, r4 = u2)), r4;
    }
    function xu() {
      var r4;
      return (r4 = Eo()) === u2 && (r4 = xo()) === u2 && (r4 = Lo()), r4;
    }
    function Lu() {
      var r4, n3, t4;
      return r4 = De, go() !== u2 ? (zo(), _o() !== u2 ? (zo(), (n3 = Ke2()) !== u2 ? (zo(), oo() !== u2 ? (zo(), (t4 = Ke2()) !== u2 ? (zo(), Bo() !== u2 ? r4 = st2(n3, t4) : (De = r4, r4 = u2)) : (De = r4, r4 = u2)) : (De = r4, r4 = u2)) : (De = r4, r4 = u2)) : (De = r4, r4 = u2)) : (De = r4, r4 = u2), r4;
    }
    function wu() {
      var r4, n3, t4;
      return r4 = De, (n3 = Zo()) !== u2 ? (zo(), _o() !== u2 ? (zo(), (t4 = qe()) === u2 && (t4 = null), zo(), Bo() !== u2 ? r4 = at2(n3, t4) : (De = r4, r4 = u2)) : (De = r4, r4 = u2)) : (De = r4, r4 = u2), r4;
    }
    function Tu() {
      var r4;
      return (r4 = No()) === u2 && (r4 = Oo()) === u2 && (r4 = Ro()) === u2 && (r4 = Fo()) === u2 && (r4 = Io()) === u2 && (r4 = So()), r4;
    }
    function Nu() {
      var r4;
      return (r4 = zu()) === u2 && (r4 = Ku()) === u2 && (r4 = _u()) === u2 && (r4 = Pu()) === u2 && (r4 = Uu()) === u2 && (r4 = Ou()) === u2 && (r4 = Ru()), r4;
    }
    function Ou() {
      var r4, n3;
      return r4 = De, Co() !== u2 ? (zo(), (n3 = Bu()) !== u2 ? r4 = ct2(n3) : (De = r4, r4 = u2)) : (De = r4, r4 = u2), r4;
    }
    function Ru() {
      var n3, t4, e4, o3;
      return n3 = De, To() !== u2 ? (zo(), r3.charCodeAt(De) === 45 ? (t4 = b2, De++) : (t4 = u2, Pe2 === 0 && We2(Or)), t4 === u2 && (r3.charCodeAt(De) === 43 ? (t4 = y2, De++) : (t4 = u2, Pe2 === 0 && We2(Nr))), t4 !== u2 ? (zo(), (e4 = Bu()) !== u2 ? (zo(), (o3 = Fu()) !== u2 ? n3 = ft2(t4, e4, o3) : (De = n3, n3 = u2)) : (De = n3, n3 = u2)) : (De = n3, n3 = u2)) : (De = n3, n3 = u2), n3 === u2 && (n3 = De, To() !== u2 ? (zo(), (t4 = Bu()) !== u2 ? (zo(), (e4 = Fu()) !== u2 ? n3 = lt2(t4, e4) : (De = n3, n3 = u2)) : (De = n3, n3 = u2)) : (De = n3, n3 = u2)), n3;
    }
    function Fu() {
      var r4, n3, t4;
      return r4 = De, (n3 = Iu()) !== u2 ? (zo(), wo() !== u2 ? (zo(), (t4 = Su()) !== u2 ? r4 = pt2(n3, t4) : (De = r4, r4 = u2)) : (De = r4, r4 = u2)) : (De = r4, r4 = u2), r4 === u2 && (r4 = Mu()), r4;
    }
    function Iu() {
      var r4, n3, t4;
      return r4 = De, (n3 = Du()) !== u2 ? (zo(), _o() !== u2 ? (zo(), (t4 = ju()) !== u2 ? (zo(), Bo() !== u2 ? r4 = vt2(n3, t4) : (De = r4, r4 = u2)) : (De = r4, r4 = u2)) : (De = r4, r4 = u2)) : (De = r4, r4 = u2), r4 === u2 && (r4 = De, (n3 = Du()) !== u2 && (n3 = dt2(n3)), r4 = n3), r4;
    }
    function Su() {
      var r4, n3, t4, e4;
      return r4 = De, (n3 = Du()) !== u2 && (n3 = ht2(n3)), (r4 = n3) === u2 && (r4 = De, (n3 = So()) !== u2 ? (zo(), _o() !== u2 ? (zo(), (t4 = ju()) !== u2 ? (zo(), Po() !== u2 ? (zo(), (e4 = Hu()) !== u2 ? (zo(), Bo() !== u2 ? r4 = yt2(t4, e4) : (De = r4, r4 = u2)) : (De = r4, r4 = u2)) : (De = r4, r4 = u2)) : (De = r4, r4 = u2)) : (De = r4, r4 = u2)) : (De = r4, r4 = u2), r4 === u2 && (r4 = De, (n3 = So()) !== u2 ? (zo(), _o() !== u2 ? (zo(), (t4 = ju()) !== u2 ? (zo(), Bo() !== u2 ? r4 = bt2(t4) : (De = r4, r4 = u2)) : (De = r4, r4 = u2)) : (De = r4, r4 = u2)) : (De = r4, r4 = u2), r4 === u2 && (r4 = De, (n3 = So()) !== u2 && (n3 = At2()), r4 = n3))), r4;
    }
    function Mu() {
      var r4, n3, t4, e4;
      return r4 = De, (n3 = Du()) !== u2 ? (zo(), _o() !== u2 ? (zo(), (t4 = Hu()) !== u2 ? (zo(), Bo() !== u2 ? r4 = gt2(n3, t4) : (De = r4, r4 = u2)) : (De = r4, r4 = u2)) : (De = r4, r4 = u2)) : (De = r4, r4 = u2), r4 === u2 && (r4 = De, (n3 = Du()) !== u2 && (n3 = Ct2(n3)), (r4 = n3) === u2 && (r4 = De, (n3 = So()) !== u2 ? (zo(), _o() !== u2 ? (zo(), (t4 = ju()) !== u2 ? (zo(), Po() !== u2 ? (zo(), (e4 = Hu()) !== u2 ? (zo(), Bo() !== u2 ? r4 = mt2(t4, e4) : (De = r4, r4 = u2)) : (De = r4, r4 = u2)) : (De = r4, r4 = u2)) : (De = r4, r4 = u2)) : (De = r4, r4 = u2)) : (De = r4, r4 = u2), r4 === u2 && (r4 = De, (n3 = So()) !== u2 ? (zo(), _o() !== u2 ? (zo(), (t4 = Hu()) !== u2 ? (zo(), Bo() !== u2 ? r4 = Et2(t4) : (De = r4, r4 = u2)) : (De = r4, r4 = u2)) : (De = r4, r4 = u2)) : (De = r4, r4 = u2), r4 === u2 && (r4 = De, (n3 = So()) !== u2 && (n3 = xt2()), r4 = n3)))), r4;
    }
    function Du() {
      var r4, n3;
      return r4 = De, (n3 = Ro()) !== u2 && (n3 = Lt2()), (r4 = n3) === u2 && (r4 = De, (n3 = Fo()) !== u2 && (n3 = wt2()), (r4 = n3) === u2 && (r4 = De, (n3 = Io()) !== u2 && (n3 = Tt2()), (r4 = n3) === u2 && (r4 = De, (n3 = Oo()) !== u2 && (n3 = Nt2()), (r4 = n3) === u2 && (r4 = De, (n3 = No()) !== u2 && (n3 = Ot2()), r4 = n3)))), r4;
    }
    function Hu() {
      var r4;
      return (r4 = Qu()) !== u2 && (r4 = Rt2(r4)), r4;
    }
    function ju() {
      var r4;
      return (r4 = Qu()) !== u2 && (r4 = Ft2(r4)), r4;
    }
    function Uu() {
      var r4, n3;
      return r4 = De, mo() !== u2 ? (zo(), (n3 = Bu()) !== u2 ? r4 = It2(n3) : (De = r4, r4 = u2)) : (De = r4, r4 = u2), r4;
    }
    function Pu() {
      var r4;
      return (r4 = to()) !== u2 && (r4 = St2()), r4;
    }
    function _u() {
      var r4, n3;
      return r4 = De, (n3 = eo()) !== u2 && (n3 = Mt2()), (r4 = n3) === u2 && (r4 = De, (n3 = uo()) !== u2 && (n3 = Dt()), r4 = n3), r4;
    }
    function Bu() {
      var r4;
      return (r4 = zu()) === u2 && (r4 = gu()), r4;
    }
    function zu() {
      var n3, t4, e4, o3, i3;
      if (n3 = De, r3.charCodeAt(De) === 39 ? (t4 = m2, De++) : (t4 = u2, Pe2 === 0 && We2(Hr)), t4 === u2 && (r3.substr(De, 2) === E2 ? (t4 = E2, De += 2) : (t4 = u2, Pe2 === 0 && We2(jr))), t4 !== u2) {
        for (e4 = [], o3 = De, r3.substr(De, 2) === x2 ? (i3 = x2, De += 2) : (i3 = u2, Pe2 === 0 && We2(Ur)), i3 !== u2 && (i3 = Ht()), (o3 = i3) === u2 && (vr.test(r3.charAt(De)) ? (o3 = r3.charAt(De), De++) : (o3 = u2, Pe2 === 0 && We2(Pr))); o3 !== u2; )
          e4.push(o3), o3 = De, r3.substr(De, 2) === x2 ? (i3 = x2, De += 2) : (i3 = u2, Pe2 === 0 && We2(Ur)), i3 !== u2 && (i3 = Ht()), (o3 = i3) === u2 && (vr.test(r3.charAt(De)) ? (o3 = r3.charAt(De), De++) : (o3 = u2, Pe2 === 0 && We2(Pr)));
        r3.charCodeAt(De) === 39 ? (o3 = m2, De++) : (o3 = u2, Pe2 === 0 && We2(Hr)), o3 !== u2 ? n3 = jt2(e4) : (De = n3, n3 = u2);
      } else
        De = n3, n3 = u2;
      return n3;
    }
    function Gu() {
      var r4;
      return (r4 = Zu()) === u2 && (r4 = Wu()), r4;
    }
    function Zu() {
      var r4, n3, t4, e4, o3;
      if (r4 = De, Mo() !== u2)
        if (zo(), (n3 = Ke2()) !== u2) {
          for (zo(), t4 = [], e4 = ku(); e4 !== u2; )
            t4.push(e4), e4 = ku();
          e4 = zo(), (o3 = Do()) !== u2 ? r4 = Ut2(n3, t4) : (De = r4, r4 = u2);
        } else
          De = r4, r4 = u2;
      else
        De = r4, r4 = u2;
      if (r4 === u2)
        if (r4 = De, Mo() !== u2)
          if (zo(), (n3 = Ke2()) !== u2) {
            for (zo(), t4 = [], e4 = ku(); e4 !== u2; )
              t4.push(e4), e4 = ku();
            e4 = zo(), (o3 = qu()) !== u2 ? (zo(), Do() !== u2 ? r4 = Pt2(n3, t4, o3) : (De = r4, r4 = u2)) : (De = r4, r4 = u2);
          } else
            De = r4, r4 = u2;
        else
          De = r4, r4 = u2;
      return r4;
    }
    function Wu() {
      var r4, n3, t4, e4;
      if (r4 = De, Mo() !== u2) {
        for (zo(), n3 = [], t4 = Yu(); t4 !== u2; )
          n3.push(t4), t4 = Yu();
        t4 = zo(), (e4 = Do()) !== u2 ? r4 = _t(n3) : (De = r4, r4 = u2);
      } else
        De = r4, r4 = u2;
      if (r4 === u2)
        if (r4 = De, Mo() !== u2) {
          for (zo(), n3 = [], t4 = Yu(); t4 !== u2; )
            n3.push(t4), t4 = Yu();
          t4 = zo(), (e4 = qu()) !== u2 ? (zo(), Do() !== u2 ? r4 = Bt2(n3, e4) : (De = r4, r4 = u2)) : (De = r4, r4 = u2);
        } else
          De = r4, r4 = u2;
      return r4;
    }
    function Yu() {
      var r4, n3, t4;
      return r4 = De, Ho() !== u2 ? (zo(), (n3 = Ke2()) !== u2 ? (zo(), jo() !== u2 ? (zo(), (t4 = Ke2()) !== u2 ? r4 = zt(n3, t4) : (De = r4, r4 = u2)) : (De = r4, r4 = u2)) : (De = r4, r4 = u2)) : (De = r4, r4 = u2), r4;
    }
    function ku() {
      var r4, n3, t4;
      return r4 = De, Ho() !== u2 ? (zo(), (n3 = Ke2()) !== u2 ? (zo(), jo() !== u2 ? (zo(), (t4 = Ke2()) !== u2 ? r4 = Gt2(n3, t4) : (De = r4, r4 = u2)) : (De = r4, r4 = u2)) : (De = r4, r4 = u2)) : (De = r4, r4 = u2), r4;
    }
    function qu() {
      var r4, n3;
      return r4 = De, Uo() !== u2 ? (zo(), (n3 = Ke2()) !== u2 ? r4 = Zt(n3) : (De = r4, r4 = u2)) : (De = r4, r4 = u2), r4;
    }
    function Ku() {
      var r4, n3, t4, e4;
      return r4 = De, (n3 = Vu()) !== u2 ? (t4 = De, Pe2++, e4 = yu(), Pe2--, e4 === u2 ? t4 = void 0 : (De = t4, t4 = u2), t4 !== u2 ? r4 = Wt(n3) : (De = r4, r4 = u2)) : (De = r4, r4 = u2), r4;
    }
    function Vu() {
      var r4, n3, t4, e4;
      return r4 = De, (n3 = Xu()) !== u2 && (t4 = $u()) !== u2 && (e4 = Ju()) !== u2 ? r4 = Yt(n3, t4, e4) : (De = r4, r4 = u2), r4 === u2 && (r4 = De, (n3 = Xu()) !== u2 && (t4 = $u()) !== u2 ? r4 = kt2(n3, t4) : (De = r4, r4 = u2), r4 === u2 && (r4 = De, (n3 = Xu()) !== u2 && (t4 = Ju()) !== u2 ? r4 = qt2(n3, t4) : (De = r4, r4 = u2), r4 === u2 && (r4 = De, (n3 = Xu()) !== u2 && (n3 = Kt(n3)), r4 = n3))), r4;
    }
    function Xu() {
      var n3, t4, e4;
      return (n3 = Qu()) === u2 && (n3 = De, r3.charCodeAt(De) === 45 ? (t4 = b2, De++) : (t4 = u2, Pe2 === 0 && We2(Or)), t4 === u2 && (r3.charCodeAt(De) === 43 ? (t4 = y2, De++) : (t4 = u2, Pe2 === 0 && We2(Nr))), t4 !== u2 && (e4 = Qu()) !== u2 ? n3 = Vt(t4, e4) : (De = n3, n3 = u2)), n3;
    }
    function $u() {
      var n3, t4, e4;
      return n3 = De, r3.charCodeAt(De) === 46 ? (t4 = L2, De++) : (t4 = u2, Pe2 === 0 && We2(_r)), t4 !== u2 ? ((e4 = Qu()) === u2 && (e4 = null), n3 = Xt(e4)) : (De = n3, n3 = u2), n3;
    }
    function Ju() {
      var r4, n3, t4;
      return r4 = De, (n3 = no()) !== u2 && (t4 = Qu()) !== u2 ? r4 = $t2(n3, t4) : (De = r4, r4 = u2), r4;
    }
    function Qu() {
      var r4, n3;
      if (r4 = [], (n3 = ro()) !== u2)
        for (; n3 !== u2; )
          r4.push(n3), n3 = ro();
      else
        r4 = u2;
      return r4 !== u2 && (r4 = Jt2(r4)), r4;
    }
    function ro() {
      var n3;
      return dr.test(r3.charAt(De)) ? (n3 = r3.charAt(De), De++) : (n3 = u2, Pe2 === 0 && We2(Br)), n3;
    }
    function no() {
      var n3, t4, e4;
      return n3 = De, hr.test(r3.charAt(De)) ? (t4 = r3.charAt(De), De++) : (t4 = u2, Pe2 === 0 && We2(zr)), t4 !== u2 ? (yr.test(r3.charAt(De)) ? (e4 = r3.charAt(De), De++) : (e4 = u2, Pe2 === 0 && We2(Gr)), e4 === u2 && (e4 = null), n3 = Qt(t4, e4)) : (De = n3, n3 = u2), n3;
    }
    function to() {
      var n3, t4, e4, o3;
      return n3 = De, r3.substr(De, 4).toLowerCase() === w2 ? (t4 = r3.substr(De, 4), De += 4) : (t4 = u2, Pe2 === 0 && We2(Zr)), t4 !== u2 ? (e4 = De, Pe2++, o3 = bu(), Pe2--, o3 === u2 ? e4 = void 0 : (De = e4, e4 = u2), e4 !== u2 ? n3 = t4 = [t4, e4] : (De = n3, n3 = u2)) : (De = n3, n3 = u2), n3;
    }
    function eo() {
      var n3, t4, e4, o3;
      return n3 = De, r3.substr(De, 4).toLowerCase() === T2 ? (t4 = r3.substr(De, 4), De += 4) : (t4 = u2, Pe2 === 0 && We2(Wr)), t4 !== u2 ? (e4 = De, Pe2++, o3 = bu(), Pe2--, o3 === u2 ? e4 = void 0 : (De = e4, e4 = u2), e4 !== u2 ? n3 = t4 = [t4, e4] : (De = n3, n3 = u2)) : (De = n3, n3 = u2), n3;
    }
    function uo() {
      var n3, t4, e4, o3;
      return n3 = De, r3.substr(De, 5).toLowerCase() === N2 ? (t4 = r3.substr(De, 5), De += 5) : (t4 = u2, Pe2 === 0 && We2(Yr)), t4 !== u2 ? (e4 = De, Pe2++, o3 = bu(), Pe2--, o3 === u2 ? e4 = void 0 : (De = e4, e4 = u2), e4 !== u2 ? n3 = t4 = [t4, e4] : (De = n3, n3 = u2)) : (De = n3, n3 = u2), n3;
    }
    function oo() {
      var n3, t4, e4, o3;
      return n3 = De, r3.substr(De, 2).toLowerCase() === O2 ? (t4 = r3.substr(De, 2), De += 2) : (t4 = u2, Pe2 === 0 && We2(kr)), t4 !== u2 ? (e4 = De, Pe2++, o3 = bu(), Pe2--, o3 === u2 ? e4 = void 0 : (De = e4, e4 = u2), e4 !== u2 ? n3 = re2() : (De = n3, n3 = u2)) : (De = n3, n3 = u2), n3;
    }
    function io() {
      var n3, t4, e4, o3;
      return n3 = De, r3.substr(De, 2).toLowerCase() === R2 ? (t4 = r3.substr(De, 2), De += 2) : (t4 = u2, Pe2 === 0 && We2(qr)), t4 !== u2 ? (e4 = De, Pe2++, o3 = bu(), Pe2--, o3 === u2 ? e4 = void 0 : (De = e4, e4 = u2), e4 !== u2 ? n3 = ne2() : (De = n3, n3 = u2)) : (De = n3, n3 = u2), n3;
    }
    function so() {
      var n3, t4, e4, o3;
      return n3 = De, r3.substr(De, 4).toLowerCase() === F2 ? (t4 = r3.substr(De, 4), De += 4) : (t4 = u2, Pe2 === 0 && We2(Kr)), t4 !== u2 ? (e4 = De, Pe2++, o3 = bu(), Pe2--, o3 === u2 ? e4 = void 0 : (De = e4, e4 = u2), e4 !== u2 ? n3 = te2() : (De = n3, n3 = u2)) : (De = n3, n3 = u2), n3;
    }
    function ao() {
      var n3, t4, e4, o3;
      return n3 = De, r3.substr(De, 6).toLowerCase() === I2 ? (t4 = r3.substr(De, 6), De += 6) : (t4 = u2, Pe2 === 0 && We2(Vr)), t4 !== u2 ? (e4 = De, Pe2++, o3 = bu(), Pe2--, o3 === u2 ? e4 = void 0 : (De = e4, e4 = u2), e4 !== u2 ? n3 = ee2() : (De = n3, n3 = u2)) : (De = n3, n3 = u2), n3;
    }
    function co() {
      var n3, t4, e4, o3;
      return n3 = De, r3.substr(De, 3).toLowerCase() === S2 ? (t4 = r3.substr(De, 3), De += 3) : (t4 = u2, Pe2 === 0 && We2(Xr)), t4 !== u2 ? (e4 = De, Pe2++, o3 = bu(), Pe2--, o3 === u2 ? e4 = void 0 : (De = e4, e4 = u2), e4 !== u2 ? n3 = ue2() : (De = n3, n3 = u2)) : (De = n3, n3 = u2), n3;
    }
    function fo() {
      var n3, t4, e4, o3;
      return n3 = De, r3.substr(De, 3).toLowerCase() === M2 ? (t4 = r3.substr(De, 3), De += 3) : (t4 = u2, Pe2 === 0 && We2($r)), t4 !== u2 ? (e4 = De, Pe2++, o3 = bu(), Pe2--, o3 === u2 ? e4 = void 0 : (De = e4, e4 = u2), e4 !== u2 ? n3 = oe2() : (De = n3, n3 = u2)) : (De = n3, n3 = u2), n3;
    }
    function lo() {
      var n3, t4, e4, o3;
      return n3 = De, r3.substr(De, 2).toLowerCase() === D2 ? (t4 = r3.substr(De, 2), De += 2) : (t4 = u2, Pe2 === 0 && We2(Jr)), t4 !== u2 ? (e4 = De, Pe2++, o3 = bu(), Pe2--, o3 === u2 ? e4 = void 0 : (De = e4, e4 = u2), e4 !== u2 ? n3 = ie2() : (De = n3, n3 = u2)) : (De = n3, n3 = u2), n3;
    }
    function po() {
      var n3, t4, e4, o3;
      return n3 = De, r3.substr(De, 7).toLowerCase() === H2 ? (t4 = r3.substr(De, 7), De += 7) : (t4 = u2, Pe2 === 0 && We2(Qr)), t4 !== u2 ? (e4 = De, Pe2++, o3 = bu(), Pe2--, o3 === u2 ? e4 = void 0 : (De = e4, e4 = u2), e4 !== u2 ? n3 = se2() : (De = n3, n3 = u2)) : (De = n3, n3 = u2), n3;
    }
    function vo() {
      var n3, t4, e4, o3;
      return n3 = De, r3.substr(De, 4).toLowerCase() === j2 ? (t4 = r3.substr(De, 4), De += 4) : (t4 = u2, Pe2 === 0 && We2(rn2)), t4 !== u2 ? (e4 = De, Pe2++, o3 = bu(), Pe2--, o3 === u2 ? e4 = void 0 : (De = e4, e4 = u2), e4 !== u2 ? n3 = ae2() : (De = n3, n3 = u2)) : (De = n3, n3 = u2), n3;
    }
    function ho() {
      var n3, t4, e4, o3;
      return n3 = De, r3.substr(De, 3).toLowerCase() === U2 ? (t4 = r3.substr(De, 3), De += 3) : (t4 = u2, Pe2 === 0 && We2(nn2)), t4 !== u2 ? (e4 = De, Pe2++, o3 = bu(), Pe2--, o3 === u2 ? e4 = void 0 : (De = e4, e4 = u2), e4 !== u2 ? n3 = ce2() : (De = n3, n3 = u2)) : (De = n3, n3 = u2), n3;
    }
    function yo() {
      var n3, t4, e4, o3;
      return n3 = De, r3.substr(De, 9).toLowerCase() === P2 ? (t4 = r3.substr(De, 9), De += 9) : (t4 = u2, Pe2 === 0 && We2(tn2)), t4 !== u2 ? (e4 = De, Pe2++, o3 = bu(), Pe2--, o3 === u2 ? e4 = void 0 : (De = e4, e4 = u2), e4 !== u2 ? n3 = fe2() : (De = n3, n3 = u2)) : (De = n3, n3 = u2), n3;
    }
    function bo() {
      var n3, t4, e4, o3;
      return n3 = De, r3.substr(De, 7).toLowerCase() === _2 ? (t4 = r3.substr(De, 7), De += 7) : (t4 = u2, Pe2 === 0 && We2(en2)), t4 !== u2 ? (e4 = De, Pe2++, o3 = bu(), Pe2--, o3 === u2 ? e4 = void 0 : (De = e4, e4 = u2), e4 !== u2 ? n3 = le2() : (De = n3, n3 = u2)) : (De = n3, n3 = u2), n3;
    }
    function Ao() {
      var n3, t4, e4, o3;
      return n3 = De, r3.substr(De, 4).toLowerCase() === B2 ? (t4 = r3.substr(De, 4), De += 4) : (t4 = u2, Pe2 === 0 && We2(un2)), t4 !== u2 ? (e4 = De, Pe2++, o3 = bu(), Pe2--, o3 === u2 ? e4 = void 0 : (De = e4, e4 = u2), e4 !== u2 ? n3 = pe2() : (De = n3, n3 = u2)) : (De = n3, n3 = u2), n3;
    }
    function go() {
      var n3, t4, e4, o3;
      return n3 = De, r3.substr(De, 8).toLowerCase() === z2 ? (t4 = r3.substr(De, 8), De += 8) : (t4 = u2, Pe2 === 0 && We2(on2)), t4 !== u2 ? (e4 = De, Pe2++, o3 = bu(), Pe2--, o3 === u2 ? e4 = void 0 : (De = e4, e4 = u2), e4 !== u2 ? n3 = ve2() : (De = n3, n3 = u2)) : (De = n3, n3 = u2), n3;
    }
    function Co() {
      var n3, t4, e4, o3;
      return n3 = De, r3.substr(De, 9).toLowerCase() === G2 ? (t4 = r3.substr(De, 9), De += 9) : (t4 = u2, Pe2 === 0 && We2(sn2)), t4 !== u2 ? (e4 = De, Pe2++, o3 = bu(), Pe2--, o3 === u2 ? e4 = void 0 : (De = e4, e4 = u2), e4 !== u2 ? n3 = de2() : (De = n3, n3 = u2)) : (De = n3, n3 = u2), n3;
    }
    function mo() {
      var n3, t4, e4, o3;
      return n3 = De, r3.substr(De, 4).toLowerCase() === Z2 ? (t4 = r3.substr(De, 4), De += 4) : (t4 = u2, Pe2 === 0 && We2(an)), t4 !== u2 ? (e4 = De, Pe2++, o3 = bu(), Pe2--, o3 === u2 ? e4 = void 0 : (De = e4, e4 = u2), e4 !== u2 ? n3 = he2() : (De = n3, n3 = u2)) : (De = n3, n3 = u2), n3;
    }
    function Eo() {
      var n3, t4, e4, o3;
      return n3 = De, r3.substr(De, 7).toLowerCase() === W2 ? (t4 = r3.substr(De, 7), De += 7) : (t4 = u2, Pe2 === 0 && We2(cn2)), t4 !== u2 ? (e4 = De, Pe2++, o3 = bu(), Pe2--, o3 === u2 ? e4 = void 0 : (De = e4, e4 = u2), e4 !== u2 ? n3 = ye2() : (De = n3, n3 = u2)) : (De = n3, n3 = u2), n3;
    }
    function xo() {
      var n3, t4, e4, o3;
      return n3 = De, r3.substr(De, 8).toLowerCase() === Y2 ? (t4 = r3.substr(De, 8), De += 8) : (t4 = u2, Pe2 === 0 && We2(fn2)), t4 !== u2 ? (e4 = De, Pe2++, o3 = bu(), Pe2--, o3 === u2 ? e4 = void 0 : (De = e4, e4 = u2), e4 !== u2 ? n3 = be2() : (De = n3, n3 = u2)) : (De = n3, n3 = u2), n3;
    }
    function Lo() {
      var n3, t4, e4, o3;
      return n3 = De, r3.substr(De, 4).toLowerCase() === k2 ? (t4 = r3.substr(De, 4), De += 4) : (t4 = u2, Pe2 === 0 && We2(ln2)), t4 !== u2 ? (e4 = De, Pe2++, o3 = bu(), Pe2--, o3 === u2 ? e4 = void 0 : (De = e4, e4 = u2), e4 !== u2 ? n3 = Ae2() : (De = n3, n3 = u2)) : (De = n3, n3 = u2), n3;
    }
    function wo() {
      var n3, t4, e4, o3;
      return n3 = De, r3.substr(De, 2).toLowerCase() === q2 ? (t4 = r3.substr(De, 2), De += 2) : (t4 = u2, Pe2 === 0 && We2(pn2)), t4 !== u2 ? (e4 = De, Pe2++, o3 = bu(), Pe2--, o3 === u2 ? e4 = void 0 : (De = e4, e4 = u2), e4 !== u2 ? n3 = ge2() : (De = n3, n3 = u2)) : (De = n3, n3 = u2), n3;
    }
    function To() {
      var n3, t4, e4, o3;
      return n3 = De, r3.substr(De, 8).toLowerCase() === K2 ? (t4 = r3.substr(De, 8), De += 8) : (t4 = u2, Pe2 === 0 && We2(vn2)), t4 !== u2 ? (e4 = De, Pe2++, o3 = bu(), Pe2--, o3 === u2 ? e4 = void 0 : (De = e4, e4 = u2), e4 !== u2 ? n3 = Ce2() : (De = n3, n3 = u2)) : (De = n3, n3 = u2), n3;
    }
    function No() {
      var n3, t4, e4, o3;
      return n3 = De, r3.substr(De, 4).toLowerCase() === V2 ? (t4 = r3.substr(De, 4), De += 4) : (t4 = u2, Pe2 === 0 && We2(dn)), t4 !== u2 ? (e4 = De, Pe2++, o3 = bu(), Pe2--, o3 === u2 ? e4 = void 0 : (De = e4, e4 = u2), e4 !== u2 ? n3 = me2() : (De = n3, n3 = u2)) : (De = n3, n3 = u2), n3;
    }
    function Oo() {
      var n3, t4, e4, o3;
      return n3 = De, r3.substr(De, 5).toLowerCase() === X2 ? (t4 = r3.substr(De, 5), De += 5) : (t4 = u2, Pe2 === 0 && We2(hn2)), t4 !== u2 ? (e4 = De, Pe2++, o3 = bu(), Pe2--, o3 === u2 ? e4 = void 0 : (De = e4, e4 = u2), e4 !== u2 ? n3 = Ee2() : (De = n3, n3 = u2)) : (De = n3, n3 = u2), n3;
    }
    function Ro() {
      var n3, t4, e4, o3;
      return n3 = De, r3.substr(De, 3).toLowerCase() === $2 ? (t4 = r3.substr(De, 3), De += 3) : (t4 = u2, Pe2 === 0 && We2(yn)), t4 !== u2 ? (e4 = De, Pe2++, o3 = bu(), Pe2--, o3 === u2 ? e4 = void 0 : (De = e4, e4 = u2), e4 !== u2 ? n3 = xe2() : (De = n3, n3 = u2)) : (De = n3, n3 = u2), n3;
    }
    function Fo() {
      var n3, t4, e4, o3;
      return n3 = De, r3.substr(De, 4).toLowerCase() === J2 ? (t4 = r3.substr(De, 4), De += 4) : (t4 = u2, Pe2 === 0 && We2(bn2)), t4 !== u2 ? (e4 = De, Pe2++, o3 = bu(), Pe2--, o3 === u2 ? e4 = void 0 : (De = e4, e4 = u2), e4 !== u2 ? n3 = Le2() : (De = n3, n3 = u2)) : (De = n3, n3 = u2), n3;
    }
    function Io() {
      var n3, t4, e4, o3;
      return n3 = De, r3.substr(De, 6).toLowerCase() === Q2 ? (t4 = r3.substr(De, 6), De += 6) : (t4 = u2, Pe2 === 0 && We2(An2)), t4 !== u2 ? (e4 = De, Pe2++, o3 = bu(), Pe2--, o3 === u2 ? e4 = void 0 : (De = e4, e4 = u2), e4 !== u2 ? n3 = we2() : (De = n3, n3 = u2)) : (De = n3, n3 = u2), n3;
    }
    function So() {
      var n3, t4, e4, o3;
      return n3 = De, r3.substr(De, 6).toLowerCase() === rr ? (t4 = r3.substr(De, 6), De += 6) : (t4 = u2, Pe2 === 0 && We2(gn2)), t4 !== u2 ? (e4 = De, Pe2++, o3 = bu(), Pe2--, o3 === u2 ? e4 = void 0 : (De = e4, e4 = u2), e4 !== u2 ? n3 = Te2() : (De = n3, n3 = u2)) : (De = n3, n3 = u2), n3;
    }
    function Mo() {
      var n3, t4, e4, o3;
      return n3 = De, r3.substr(De, 4).toLowerCase() === nr ? (t4 = r3.substr(De, 4), De += 4) : (t4 = u2, Pe2 === 0 && We2(Cn)), t4 !== u2 ? (e4 = De, Pe2++, o3 = bu(), Pe2--, o3 === u2 ? e4 = void 0 : (De = e4, e4 = u2), e4 !== u2 ? n3 = Ne2() : (De = n3, n3 = u2)) : (De = n3, n3 = u2), n3;
    }
    function Do() {
      var n3, t4, e4, o3;
      return n3 = De, r3.substr(De, 3).toLowerCase() === tr ? (t4 = r3.substr(De, 3), De += 3) : (t4 = u2, Pe2 === 0 && We2(mn2)), t4 !== u2 ? (e4 = De, Pe2++, o3 = bu(), Pe2--, o3 === u2 ? e4 = void 0 : (De = e4, e4 = u2), e4 !== u2 ? n3 = Oe2() : (De = n3, n3 = u2)) : (De = n3, n3 = u2), n3;
    }
    function Ho() {
      var n3, t4, e4, o3;
      return n3 = De, r3.substr(De, 4).toLowerCase() === er ? (t4 = r3.substr(De, 4), De += 4) : (t4 = u2, Pe2 === 0 && We2(En2)), t4 !== u2 ? (e4 = De, Pe2++, o3 = bu(), Pe2--, o3 === u2 ? e4 = void 0 : (De = e4, e4 = u2), e4 !== u2 ? n3 = Re() : (De = n3, n3 = u2)) : (De = n3, n3 = u2), n3;
    }
    function jo() {
      var n3, t4, e4, o3;
      return n3 = De, r3.substr(De, 4).toLowerCase() === ur ? (t4 = r3.substr(De, 4), De += 4) : (t4 = u2, Pe2 === 0 && We2(xn2)), t4 !== u2 ? (e4 = De, Pe2++, o3 = bu(), Pe2--, o3 === u2 ? e4 = void 0 : (De = e4, e4 = u2), e4 !== u2 ? n3 = Fe2() : (De = n3, n3 = u2)) : (De = n3, n3 = u2), n3;
    }
    function Uo() {
      var n3, t4, e4, o3;
      return n3 = De, r3.substr(De, 4).toLowerCase() === or ? (t4 = r3.substr(De, 4), De += 4) : (t4 = u2, Pe2 === 0 && We2(Ln2)), t4 !== u2 ? (e4 = De, Pe2++, o3 = bu(), Pe2--, o3 === u2 ? e4 = void 0 : (De = e4, e4 = u2), e4 !== u2 ? n3 = Ie2() : (De = n3, n3 = u2)) : (De = n3, n3 = u2), n3;
    }
    function Po() {
      var n3;
      return r3.charCodeAt(De) === 44 ? (n3 = ir, De++) : (n3 = u2, Pe2 === 0 && We2(wn2)), n3;
    }
    function _o() {
      var n3;
      return r3.charCodeAt(De) === 40 ? (n3 = sr, De++) : (n3 = u2, Pe2 === 0 && We2(Tn2)), n3;
    }
    function Bo() {
      var n3;
      return r3.charCodeAt(De) === 41 ? (n3 = ar, De++) : (n3 = u2, Pe2 === 0 && We2(Nn)), n3;
    }
    function zo() {
      var r4, n3;
      for (r4 = [], n3 = Go(); n3 !== u2; )
        r4.push(n3), n3 = Go();
      return r4;
    }
    function Go() {
      var n3;
      return br.test(r3.charAt(De)) ? (n3 = r3.charAt(De), De++) : (n3 = u2, Pe2 === 0 && We2(On)), n3;
    }
    function Zo() {
      var n3, t4, e4, o3;
      if (n3 = De, (t4 = hu()) !== u2 && (t4 = Se2(t4)), (n3 = t4) === u2)
        if (n3 = De, r3.charCodeAt(De) === 96 ? (t4 = cr, De++) : (t4 = u2, Pe2 === 0 && We2(Rn)), t4 !== u2) {
          if (e4 = [], Ar.test(r3.charAt(De)) ? (o3 = r3.charAt(De), De++) : (o3 = u2, Pe2 === 0 && We2(Fn)), o3 !== u2)
            for (; o3 !== u2; )
              e4.push(o3), Ar.test(r3.charAt(De)) ? (o3 = r3.charAt(De), De++) : (o3 = u2, Pe2 === 0 && We2(Fn));
          else
            e4 = u2;
          e4 !== u2 ? (r3.charCodeAt(De) === 96 ? (o3 = cr, De++) : (o3 = u2, Pe2 === 0 && We2(Rn)), o3 !== u2 ? n3 = Me2(e4) : (De = n3, n3 = u2)) : (De = n3, n3 = u2);
        } else
          De = n3, n3 = u2;
      return n3;
    }
    function Wo(r4, n3) {
      return { type: "unary-expression", operator: r4, expr: n3 };
    }
    function Yo(r4, n3, t4, e4) {
      var u3 = { type: "binary-expression", operator: r4, left: n3, right: t4 };
      return e4 !== void 0 && (u3.escape = e4), u3;
    }
    function ko(r4, n3) {
      for (var t4 = [r4], e4 = 0; e4 < n3.length; e4++)
        t4.push(n3[e4][3]);
      return t4;
    }
    function qo(r4, n3, t4) {
      return ko(r4, n3);
    }
    function Ko(r4, n3) {
      for (var t4 = r4, e4 = 0; e4 < n3.length; e4++)
        t4 = Yo(n3[e4][1], t4, n3[e4][3]);
      return t4;
    }
    if ((e3 = s2()) !== u2 && De === r3.length)
      return e3;
    throw e3 !== u2 && De < r3.length && We2(ze2()), Ye(Ue2, je2 < r3.length ? r3.charAt(je2) : null, je2 < r3.length ? Ze2(je2, je2 + 1) : Ze2(je2, je2));
  }
  return r2(n2, Error), n2.prototype.format = function(r3) {
    var n3 = "Error: " + this.message;
    if (this.location) {
      var e3, u2 = null;
      for (e3 = 0; e3 < r3.length; e3++)
        if (r3[e3].source === this.location.source) {
          u2 = r3[e3].text.split(/\r\n|\n|\r/g);
          break;
        }
      var o2 = this.location.start, i2 = this.location.source + ":" + o2.line + ":" + o2.column;
      if (u2) {
        var s2 = this.location.end, a2 = t2("", o2.line.toString().length, " "), c2 = u2[o2.line - 1], f2 = (o2.line === s2.line ? s2.column : c2.length + 1) - o2.column || 1;
        n3 += "\n --> " + i2 + "\n" + a2 + " |\n" + o2.line + " | " + c2 + "\n" + a2 + " | " + t2("", o2.column - 1, " ") + t2("", f2, "^");
      } else
        n3 += "\n at " + i2;
    }
    return n3;
  }, n2.buildMessage = function(r3, n3) {
    var t3 = { literal: function(r4) {
      return '"' + u2(r4.text) + '"';
    }, class: function(r4) {
      var n4 = r4.parts.map(function(r5) {
        return Array.isArray(r5) ? o2(r5[0]) + "-" + o2(r5[1]) : o2(r5);
      });
      return "[" + (r4.inverted ? "^" : "") + n4.join("") + "]";
    }, any: function() {
      return "any character";
    }, end: function() {
      return "end of input";
    }, other: function(r4) {
      return r4.description;
    } };
    function e3(r4) {
      return r4.charCodeAt(0).toString(16).toUpperCase();
    }
    function u2(r4) {
      return r4.replace(/\\/g, "\\\\").replace(/"/g, '\\"').replace(/\0/g, "\\0").replace(/\t/g, "\\t").replace(/\n/g, "\\n").replace(/\r/g, "\\r").replace(/[\x00-\x0F]/g, function(r5) {
        return "\\x0" + e3(r5);
      }).replace(/[\x10-\x1F\x7F-\x9F]/g, function(r5) {
        return "\\x" + e3(r5);
      });
    }
    function o2(r4) {
      return r4.replace(/\\/g, "\\\\").replace(/\]/g, "\\]").replace(/\^/g, "\\^").replace(/-/g, "\\-").replace(/\0/g, "\\0").replace(/\t/g, "\\t").replace(/\n/g, "\\n").replace(/\r/g, "\\r").replace(/[\x00-\x0F]/g, function(r5) {
        return "\\x0" + e3(r5);
      }).replace(/[\x10-\x1F\x7F-\x9F]/g, function(r5) {
        return "\\x" + e3(r5);
      });
    }
    function i2(r4) {
      return t3[r4.type](r4);
    }
    function s2(r4) {
      var n4, t4, e4 = r4.map(i2);
      if (e4.sort(), e4.length > 0) {
        for (n4 = 1, t4 = 1; n4 < e4.length; n4++)
          e4[n4 - 1] !== e4[n4] && (e4[t4] = e4[n4], t4++);
        e4.length = t4;
      }
      switch (e4.length) {
        case 1:
          return e4[0];
        case 2:
          return e4[0] + " or " + e4[1];
        default:
          return e4.slice(0, -1).join(", ") + ", or " + e4[e4.length - 1];
      }
    }
    function a2(r4) {
      return r4 ? '"' + u2(r4) + '"' : "end of input";
    }
    return "Expected " + s2(r3) + " but " + a2(n3) + " found.";
  }, { SyntaxError: n2, parse: e2 };
}, (n$7 = e$3).exports && (n$7.exports = t$6());
class u$6 {
  static parse(r2) {
    return e$3.exports.parse(r2);
  }
}
const i$6 = /^(\d{4})-(\d{1,2})-(\d{1,2})$/, l$9 = /^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2}):(\d{1,2}(\.[0-9]+)?)$/, u$5 = /^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2}):(\d{1,2}(\.[0-9]+)?)(\+|\-)(\d{1,2}):(\d{1,2})$/, o$6 = /^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2})(\+|\-)(\d{1,2}):(\d{1,2})$/, c$9 = /^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2})$/, h$7 = new Set(["current_timestamp", "current_date", "current_time"]);
function d$4(e2, t2) {
  return (e2 += "").length >= t2 ? e2 : new Array(t2 - e2.length + 1).join("0") + e2;
}
function p$6(e2, t2, a2 = "0", r2 = "0", s2 = "0", n2 = "0", i2 = "", l2 = "0", u2 = "0") {
  if (i2 === "+" || i2 === "-") {
    const o2 = `${d$4(parseInt(e2, 10), 4)}-${d$4(parseInt(t2, 10), 2)}-${d$4(parseInt(a2, 10), 2)}`;
    let c2 = "";
    parseFloat(n2) < 10 && (c2 = "0");
    const h2 = `${d$4(parseInt(r2, 10), 2)}:${d$4(parseInt(s2, 10), 2)}:${c2 + parseFloat(n2).toString()}`, p2 = `${i2}${d$4(parseInt(l2, 10), 2)}:${d$4(parseInt(u2, 10), 2)}`;
    return new Date(o2 + "T" + h2 + p2);
  }
  return new Date(parseInt(e2, 10), parseInt(t2, 10) - 1, parseInt(a2, 10), parseInt(r2, 10), parseInt(s2, 10), parseFloat(n2));
}
class v$6 {
  static makeBool(e2) {
    return g$6(e2);
  }
  static featureValue(e2, t2, a2, r2) {
    return M$6(e2, t2, a2, r2);
  }
  static equalsNull(e2) {
    return e2 === null;
  }
  static applyLike(e2, t2, a2) {
    return D$4(e2, t2, a2);
  }
  static ensureArray(e2) {
    return _$4(e2);
  }
  static applyIn(e2, t2) {
    return y$2(e2, t2);
  }
  static currentDate() {
    const e2 = new Date();
    return e2.setHours(0, 0, 0, 0), e2;
  }
  static makeSqlInterval(e2, t2, r2) {
    return e$4.createFromValueAndQualifer(e2, t2, r2);
  }
  static convertInterval(e2) {
    return e2 instanceof e$4 ? e2.valueInMilliseconds() : e2;
  }
  static currentTimestamp() {
    return new Date();
  }
  static compare(e2, t2, a2) {
    return E$5(e2, t2, a2);
  }
  static calculate(e2, t2, a2) {
    return x$5(e2, t2, a2);
  }
  static makeComparable(e2) {
    return b$5(e2);
  }
  static evaluateFunction(e2, t2) {
    return r$7(e2, t2);
  }
  static lookup(e2, t2) {
    const a2 = t2[e2];
    return a2 === void 0 ? null : a2;
  }
  static between(e2, t2) {
    return e2 == null || t2[0] == null || t2[1] == null ? null : e2 >= t2[0] && e2 <= t2[1];
  }
  static notbetween(e2, t2) {
    return e2 == null || t2[0] == null || t2[1] == null ? null : e2 < t2[0] || e2 > t2[1];
  }
  static ternaryNot(e2) {
    return T$3(e2);
  }
  static ternaryAnd(e2, t2) {
    return S$3(e2, t2);
  }
  static ternaryOr(e2, t2) {
    return w$3(e2, t2);
  }
}
class f$7 {
  constructor(e2, t2) {
    this.fieldsIndex = t2, this._datefields = {}, this.parameters = {}, this._hasDateFunctions = void 0, this.parseTree = u$6.parse(e2);
    const { isStandardized: a2, isAggregate: r2, referencedFieldNames: s2 } = this._extractExpressionInfo(t2);
    this._referencedFieldNames = s2, this.isStandardized = a2, this.isAggregate = r2;
  }
  static create(e2, t2) {
    return new f$7(e2, t2);
  }
  get fieldNames() {
    return this._referencedFieldNames;
  }
  testSet(e2, t2 = O$4) {
    const a2 = {};
    for (const r2 of this.fieldNames)
      a2[r2] = e2.map((e3) => t2.getAttribute(e3, r2));
    return !!this._evaluateNode(this.parseTree, { attributes: a2 }, O$4);
  }
  calculateValue(e2, t2 = O$4) {
    const r2 = this._evaluateNode(this.parseTree, e2, t2);
    return r2 instanceof e$4 ? r2.valueInMilliseconds() / 864e5 : r2;
  }
  calculateValueCompiled(e2, t2 = O$4) {
    return this.parseTree._compiledVersion != null ? this.parseTree._compiledVersion(e2, this.parameters, t2, this._datefields) : has("esri-csp-restrictions") ? this.calculateValue(e2, t2) : (this._compileMe(), this.parseTree._compiledVersion(e2, this.parameters, t2, this._datefields));
  }
  testFeature(e2, t2 = O$4) {
    return !!this._evaluateNode(this.parseTree, e2, t2);
  }
  testFeatureCompiled(e2, t2 = O$4) {
    return this.parseTree._compiledVersion != null ? !!this.parseTree._compiledVersion(e2, this.parameters, t2, this._datefields) : has("esri-csp-restrictions") ? this.testFeature(e2, t2) : (this._compileMe(), !!this.parseTree._compiledVersion(e2, this.parameters, t2, this._datefields));
  }
  get hasDateFunctions() {
    return this._hasDateFunctions != null || (this._hasDateFunctions = false, this._visitAll(this.parseTree, (e2) => {
      e2.type === "current-time" ? this._hasDateFunctions = true : e2.type === "function" && (this._hasDateFunctions = this._hasDateFunctions || h$7.has(e2.name.toLowerCase()));
    })), this._hasDateFunctions;
  }
  getFunctions() {
    const e2 = new Set();
    return this._visitAll(this.parseTree, (t2) => {
      t2.type === "function" && e2.add(t2.name.toLowerCase());
    }), Array.from(e2);
  }
  getExpressions() {
    const e2 = new Map();
    return this._visitAll(this.parseTree, (t2) => {
      if (t2.type === "function") {
        const a2 = t2.name.toLowerCase(), r2 = t2.args.value[0];
        if (r2.type === "column-reference") {
          const t3 = r2.column, s2 = `${a2}-${t3}`;
          e2.has(s2) || e2.set(s2, { aggregateType: a2, field: t3 });
        }
      }
    }), [...e2.values()];
  }
  getVariables() {
    const e2 = new Set();
    return this._visitAll(this.parseTree, (t2) => {
      t2.type === "parameter" && e2.add(t2.value.toLowerCase());
    }), Array.from(e2);
  }
  _compileMe() {
    const e2 = "return this.convertInterval(" + this.evaluateNodeToJavaScript(this.parseTree) + ")";
    this.parseTree._compiledVersion = new Function("feature", "lookups", "attributeAdapter", "datefields", e2).bind(v$6);
  }
  _extractExpressionInfo(t2) {
    const a2 = [], s2 = new Set();
    let n2 = true, i2 = true;
    return this._visitAll(this.parseTree, (l2) => {
      var _a2;
      switch (l2.type) {
        case "column-reference": {
          const e2 = t2 == null ? void 0 : t2.get(l2.column);
          let r2, n3;
          e2 ? r2 = n3 = (_a2 = e2.name) != null ? _a2 : "" : (n3 = l2.column, r2 = n3.toLowerCase()), e2 && e2.name && (e2.type === "date" || e2.type === "esriFieldTypeDate") && (this._datefields[e2.name] = 1), s2.has(r2) || (s2.add(r2), a2.push(n3)), l2.column = n3;
          break;
        }
        case "function": {
          const { name: t3, args: a3 } = l2, s3 = a3.value.length;
          n2 && (n2 = t$7(t3, s3)), i2 && (i2 = n$9(t3, s3));
          break;
        }
      }
    }), { referencedFieldNames: Array.from(a2), isStandardized: n2, isAggregate: i2 };
  }
  _visitAll(e2, t2) {
    if (e2 != null)
      switch (t2(e2), e2.type) {
        case "when-clause":
          this._visitAll(e2.operand, t2), this._visitAll(e2.value, t2);
          break;
        case "case-expression":
          for (const a2 of e2.clauses)
            this._visitAll(a2, t2);
          e2.format === "simple" && this._visitAll(e2.operand, t2), e2.else !== null && this._visitAll(e2.else, t2);
          break;
        case "expression-list":
          for (const a2 of e2.value)
            this._visitAll(a2, t2);
          break;
        case "unary-expression":
          this._visitAll(e2.expr, t2);
          break;
        case "binary-expression":
          this._visitAll(e2.left, t2), this._visitAll(e2.right, t2);
          break;
        case "function":
          this._visitAll(e2.args, t2);
      }
  }
  evaluateNodeToJavaScript(e2) {
    switch (e2.type) {
      case "interval":
        return "this.makeSqlInterval(" + this.evaluateNodeToJavaScript(e2.value) + ", " + JSON.stringify(e2.qualifier) + "," + JSON.stringify(e2.op) + ")";
      case "case-expression": {
        let t2 = "";
        if (e2.format === "simple") {
          const a2 = "this.makeComparable(" + this.evaluateNodeToJavaScript(e2.operand) + ")";
          t2 = "( ";
          for (let r2 = 0; r2 < e2.clauses.length; r2++)
            t2 += " (" + a2 + " === this.makeComparable(" + this.evaluateNodeToJavaScript(e2.clauses[r2].operand) + ")) ? (" + this.evaluateNodeToJavaScript(e2.clauses[r2].value) + ") : ";
          e2.else !== null ? t2 += this.evaluateNodeToJavaScript(e2.else) : t2 += "null", t2 += " )";
        } else {
          t2 = "( ";
          for (let a2 = 0; a2 < e2.clauses.length; a2++)
            t2 += " this.makeBool(" + this.evaluateNodeToJavaScript(e2.clauses[a2].operand) + ")===true ? (" + this.evaluateNodeToJavaScript(e2.clauses[a2].value) + ") : ";
          e2.else !== null ? t2 += this.evaluateNodeToJavaScript(e2.else) : t2 += "null", t2 += " )";
        }
        return t2;
      }
      case "parameter":
        return "this.lookup(" + JSON.stringify(e2.value.toLowerCase()) + ",lookups)";
      case "expression-list": {
        let t2 = "[";
        for (const a2 of e2.value)
          t2 !== "[" && (t2 += ","), t2 += this.evaluateNodeToJavaScript(a2);
        return t2 += "]", t2;
      }
      case "unary-expression":
        return "this.ternaryNot(" + this.evaluateNodeToJavaScript(e2.expr) + ")";
      case "binary-expression":
        switch (e2.operator) {
          case "AND":
            return "this.ternaryAnd(" + this.evaluateNodeToJavaScript(e2.left) + "," + this.evaluateNodeToJavaScript(e2.right) + " )";
          case "OR":
            return "this.ternaryOr(" + this.evaluateNodeToJavaScript(e2.left) + "," + this.evaluateNodeToJavaScript(e2.right) + " )";
          case "IS":
            if (e2.right.type !== "null")
              throw new Error("Unsupported RHS for IS");
            return "this.equalsNull(" + this.evaluateNodeToJavaScript(e2.left) + ")";
          case "ISNOT":
            if (e2.right.type !== "null")
              throw new Error("Unsupported RHS for IS");
            return "(!(this.equalsNull(" + this.evaluateNodeToJavaScript(e2.left) + ")))";
          case "IN":
            return "this.applyIn(" + this.evaluateNodeToJavaScript(e2.left) + ",this.ensureArray(" + this.evaluateNodeToJavaScript(e2.right) + "))";
          case "NOT IN":
            return "this.ternaryNot(this.applyIn(" + this.evaluateNodeToJavaScript(e2.left) + ",this.ensureArray(" + this.evaluateNodeToJavaScript(e2.right) + ")))";
          case "BETWEEN":
            return "this.between(" + this.evaluateNodeToJavaScript(e2.left) + "," + this.evaluateNodeToJavaScript(e2.right) + ")";
          case "NOTBETWEEN":
            return "this.notbetween(" + this.evaluateNodeToJavaScript(e2.left) + "," + this.evaluateNodeToJavaScript(e2.right) + ")";
          case "LIKE":
            return "this.applyLike(" + this.evaluateNodeToJavaScript(e2.left) + "," + this.evaluateNodeToJavaScript(e2.right) + "," + JSON.stringify(e2.escape) + ")";
          case "NOT LIKE":
            return "this.ternaryNot(this.applyLike(" + this.evaluateNodeToJavaScript(e2.left) + "," + this.evaluateNodeToJavaScript(e2.right) + "," + JSON.stringify(e2.escape) + "))";
          case "<>":
          case "<":
          case ">":
          case ">=":
          case "<=":
          case "=":
            return "this.compare(" + JSON.stringify(e2.operator) + "," + this.evaluateNodeToJavaScript(e2.left) + "," + this.evaluateNodeToJavaScript(e2.right) + ")";
          case "*":
          case "-":
          case "+":
          case "/":
            return "this.calculate(" + JSON.stringify(e2.operator) + "," + this.evaluateNodeToJavaScript(e2.left) + "," + this.evaluateNodeToJavaScript(e2.right) + ")";
        }
        throw new Error("Not Supported Operator " + e2.operator);
      case "null":
      case "boolean":
      case "string":
      case "number":
        return JSON.stringify(e2.value);
      case "date":
        return "(new Date(" + N$4(e2.value).getTime().toString() + "))";
      case "timestamp":
        return "(new Date(" + m$8(e2.value).getTime().toString() + "))";
      case "current-time":
        return e2.mode === "date" ? "this.currentDate()" : "this.currentTimestamp()";
      case "column-reference":
        return "this.featureValue(feature," + JSON.stringify(e2.column) + ",datefields,attributeAdapter)";
      case "function":
        return "this.evaluateFunction(" + JSON.stringify(e2.name) + "," + this.evaluateNodeToJavaScript(e2.args) + ")";
    }
    throw new Error("Unsupported sql syntax " + e2.type);
  }
  _evaluateNode(e2, r2, n2) {
    switch (e2.type) {
      case "interval": {
        const t2 = this._evaluateNode(e2.value, r2, n2);
        return e$4.createFromValueAndQualifer(t2, e2.qualifier, e2.op);
      }
      case "case-expression":
        if (e2.format === "simple") {
          const t2 = b$5(this._evaluateNode(e2.operand, r2, n2));
          for (let a2 = 0; a2 < e2.clauses.length; a2++)
            if (t2 === b$5(this._evaluateNode(e2.clauses[a2].operand, r2, n2)))
              return this._evaluateNode(e2.clauses[a2].value, r2, n2);
          if (e2.else !== null)
            return this._evaluateNode(e2.else, r2, n2);
        } else {
          for (let t2 = 0; t2 < e2.clauses.length; t2++)
            if (g$6(this._evaluateNode(e2.clauses[t2].operand, r2, n2)))
              return this._evaluateNode(e2.clauses[t2].value, r2, n2);
          if (e2.else !== null)
            return this._evaluateNode(e2.else, r2, n2);
        }
        return null;
      case "parameter":
        return this.parameters[e2.value.toLowerCase()];
      case "expression-list": {
        const t2 = [];
        for (const a2 of e2.value)
          t2.push(this._evaluateNode(a2, r2, n2));
        return t2;
      }
      case "unary-expression":
        return T$3(this._evaluateNode(e2.expr, r2, n2));
      case "binary-expression":
        switch (e2.operator) {
          case "AND":
            return S$3(this._evaluateNode(e2.left, r2, n2), this._evaluateNode(e2.right, r2, n2));
          case "OR":
            return w$3(this._evaluateNode(e2.left, r2, n2), this._evaluateNode(e2.right, r2, n2));
          case "IS":
            if (e2.right.type !== "null")
              throw new Error("Unsupported RHS for IS");
            return this._evaluateNode(e2.left, r2, n2) === null;
          case "ISNOT":
            if (e2.right.type !== "null")
              throw new Error("Unsupported RHS for IS");
            return this._evaluateNode(e2.left, r2, n2) !== null;
          case "IN": {
            const t2 = _$4(this._evaluateNode(e2.right, r2, n2));
            return y$2(this._evaluateNode(e2.left, r2, n2), t2);
          }
          case "NOT IN": {
            const t2 = _$4(this._evaluateNode(e2.right, r2, n2));
            return T$3(y$2(this._evaluateNode(e2.left, r2, n2), t2));
          }
          case "BETWEEN": {
            const t2 = this._evaluateNode(e2.left, r2, n2), a2 = this._evaluateNode(e2.right, r2, n2);
            return t2 == null || a2[0] == null || a2[1] == null ? null : t2 >= b$5(a2[0]) && t2 <= b$5(a2[1]);
          }
          case "NOTBETWEEN": {
            const t2 = this._evaluateNode(e2.left, r2, n2), a2 = this._evaluateNode(e2.right, r2, n2);
            return t2 == null || a2[0] == null || a2[1] == null ? null : t2 < b$5(a2[0]) || t2 > b$5(a2[1]);
          }
          case "LIKE":
            return D$4(this._evaluateNode(e2.left, r2, n2), this._evaluateNode(e2.right, r2, n2), e2.escape);
          case "NOT LIKE":
            return T$3(D$4(this._evaluateNode(e2.left, r2, n2), this._evaluateNode(e2.right, r2, n2), e2.escape));
          case "<>":
          case "<":
          case ">":
          case ">=":
          case "<=":
          case "=":
            return E$5(e2.operator, this._evaluateNode(e2.left, r2, n2), this._evaluateNode(e2.right, r2, n2));
          case "-":
          case "+":
          case "*":
          case "/":
            return x$5(e2.operator, this._evaluateNode(e2.left, r2, n2), this._evaluateNode(e2.right, r2, n2));
        }
      case "null":
      case "boolean":
      case "string":
      case "number":
        return e2.value;
      case "date":
        return N$4(e2.value);
      case "timestamp":
        return m$8(e2.value);
      case "current-time": {
        const t2 = new Date();
        return e2.mode === "date" && t2.setHours(0, 0, 0, 0), t2;
      }
      case "column-reference":
        return M$6(r2, e2.column, this._datefields, n2);
      case "function": {
        const a2 = this._evaluateNode(e2.args, r2, n2);
        return this.isAggregate ? a$6(e2.name, a2) : r$7(e2.name, a2);
      }
    }
    throw new Error("Unsupported sql syntax " + e2.type);
  }
}
function m$8(e2) {
  let t2 = l$9.exec(e2);
  if (t2 !== null) {
    const [, e3, a2, r2, s2, n2, i2] = t2;
    return p$6(e3, a2, r2, s2, n2, i2);
  }
  if (t2 = u$5.exec(e2), t2 !== null) {
    const [, e3, a2, r2, s2, n2, i2, l2, u2, o2] = t2;
    return p$6(e3, a2, r2, s2, n2, i2, l2, u2, o2);
  }
  if (t2 = o$6.exec(e2), t2 !== null) {
    const [, e3, a2, r2, s2, n2, i2, l2, u2] = t2;
    return p$6(e3, a2, r2, s2, n2, "0", i2, l2, u2);
  }
  if (t2 = c$9.exec(e2), t2 !== null) {
    const [, e3, a2, r2, s2, n2] = t2;
    return p$6(e3, a2, r2, s2, n2);
  }
  if (t2 = i$6.exec(e2), t2 !== null) {
    const [, e3, a2, r2] = t2;
    return p$6(e3, a2, r2);
  }
  throw new Error("SQL Invalid Timestamp");
}
function N$4(e2) {
  const t2 = i$6.exec(e2);
  if (t2 === null)
    try {
      return m$8(e2);
    } catch {
      throw new Error("SQL Invalid Date");
    }
  const [, a2, r2, s2] = t2;
  return new Date(parseInt(a2, 10), parseInt(r2, 10) - 1, parseInt(s2, 10));
}
function g$6(e2) {
  return e2 === true;
}
function _$4(e2) {
  return Array.isArray(e2) ? e2 : [e2];
}
function T$3(e2) {
  return e2 !== null ? e2 !== true : null;
}
function S$3(e2, t2) {
  return e2 != null && t2 != null ? e2 === true && t2 === true : e2 !== false && t2 !== false && null;
}
function w$3(e2, t2) {
  return e2 != null && t2 != null ? e2 === true || t2 === true : e2 === true || t2 === true || null;
}
function y$2(e2, t2) {
  if (e2 == null)
    return null;
  let a2 = false;
  for (const r2 of t2)
    if (r2 == null)
      a2 = null;
    else if (e2 === r2) {
      a2 = true;
      break;
    }
  return a2;
}
const I$5 = "-[]/{}()*+?.\\^$|";
var J$4;
function A$3(e2, t2) {
  const a2 = t2;
  let r2 = "", s2 = J$4.Normal;
  for (let n2 = 0; n2 < e2.length; n2++) {
    const t3 = e2.charAt(n2);
    switch (s2) {
      case J$4.Normal:
        t3 === a2 ? s2 = J$4.Escaped : I$5.includes(t3) ? r2 += "\\" + t3 : r2 += t3 === "%" ? ".*" : t3 === "_" ? "." : t3;
        break;
      case J$4.Escaped:
        I$5.includes(t3) ? r2 += "\\" + t3 : r2 += t3, s2 = J$4.Normal;
    }
  }
  return new RegExp("^" + r2 + "$", "m");
}
function D$4(e2, t2, a2) {
  if (e2 == null)
    return null;
  return A$3(t2, a2).test(e2);
}
function b$5(e2) {
  return e2 instanceof Date ? e2.valueOf() : e2;
}
function E$5(e2, t2, a2) {
  if (t2 == null || a2 == null)
    return null;
  const r2 = b$5(t2), s2 = b$5(a2);
  switch (e2) {
    case "<>":
      return r2 !== s2;
    case "=":
      return r2 === s2;
    case ">":
      return r2 > s2;
    case "<":
      return r2 < s2;
    case ">=":
      return r2 >= s2;
    case "<=":
      return r2 <= s2;
  }
}
function x$5(e2, t2, r2) {
  if (t2 instanceof e$4)
    if (r2 instanceof Date)
      switch (e2) {
        case "+":
          return new Date(t2.valueInMilliseconds() + r2.getTime());
        case "-":
          return t2.valueInMilliseconds() - r2.getTime();
        case "*":
          return t2.valueInMilliseconds() * r2.getTime();
        case "/":
          return t2.valueInMilliseconds() / r2.getTime();
      }
    else if (r2 instanceof e$4)
      switch (e2) {
        case "+":
          return e$4.createFromMilliseconds(t2.valueInMilliseconds() + r2.valueInMilliseconds());
        case "-":
          return e$4.createFromMilliseconds(t2.valueInMilliseconds() - r2.valueInMilliseconds());
        case "*":
          return t2.valueInMilliseconds() * r2.valueInMilliseconds();
        case "/":
          return t2.valueInMilliseconds() / r2.valueInMilliseconds();
      }
    else
      t2 = t2.valueInMilliseconds();
  else if (r2 instanceof e$4)
    if (t2 instanceof Date)
      switch (e2) {
        case "+":
          return new Date(r2.valueInMilliseconds() + t2.getTime());
        case "-":
          return new Date(t2.getTime() - r2.valueInMilliseconds());
        case "*":
          return t2.getTime() * r2.valueInMilliseconds();
        case "/":
          return t2.getTime() / r2.valueInMilliseconds();
      }
    else
      r2 = r2.valueInMilliseconds();
  else if (t2 instanceof Date && typeof r2 == "number")
    switch (r2 = 24 * r2 * 60 * 60 * 1e3, t2 = t2.getTime(), e2) {
      case "+":
        return new Date(t2 + r2);
      case "-":
        return new Date(t2 - r2);
      case "*":
        return new Date(t2 * r2);
      case "/":
        return new Date(t2 / r2);
    }
  else if (r2 instanceof Date && typeof t2 == "number")
    switch (t2 = 24 * t2 * 60 * 60 * 1e3, r2 = r2.getTime(), e2) {
      case "+":
        return new Date(t2 + r2);
      case "-":
        return new Date(t2 - r2);
      case "*":
        return new Date(t2 * r2);
      case "/":
        return new Date(t2 / r2);
    }
  switch (e2) {
    case "+":
      return t2 + r2;
    case "-":
      return t2 - r2;
    case "*":
      return t2 * r2;
    case "/":
      return t2 / r2;
  }
}
function F$4(e2) {
  return e2 && typeof e2.attributes == "object";
}
function M$6(e2, t2, a2, r2) {
  const s2 = r2.getAttribute(e2, t2);
  return s2 != null && a2[t2] === 1 ? new Date(s2) : s2;
}
!function(e2) {
  e2[e2.Normal = 0] = "Normal", e2[e2.Escaped = 1] = "Escaped";
}(J$4 || (J$4 = {}));
const O$4 = { getAttribute: (e2, t2) => (F$4(e2) ? e2.attributes : e2)[t2] };
var WhereClause = /* @__PURE__ */ Object.freeze({
  __proto__: null,
  [Symbol.toStringTag]: "Module",
  WhereClause: f$7,
  defaultAttributeAdapter: O$4
});
class c$8 {
  constructor(e2, c2) {
    this._cache = new e$17(e2), this._invalidCache = new e$17(c2);
  }
  get(t2, c2) {
    const i2 = `${c2.uid}:${t2}`, r2 = this._cache.get(i2);
    if (r2)
      return r2;
    if (this._invalidCache.get(i2) !== void 0)
      return null;
    try {
      const r3 = f$7.create(t2, c2);
      return this._cache.put(i2, r3), r3;
    } catch {
      return this._invalidCache.put(i2, null), null;
    }
  }
}
const s$6 = new c$8(50, 500), n$6 = "feature-store:unsupported-query", t$5 = " as ", r$6 = new Set(["esriFieldTypeOID", "esriFieldTypeSmallInteger", "esriFieldTypeInteger", "esriFieldTypeSingle", "esriFieldTypeDouble", "esriFieldTypeLong", "esriFieldTypeDate"]);
function o$5(i2, t2) {
  if (!t2)
    return true;
  const r2 = s$6.get(t2, i2);
  if (!r2)
    throw new s$2u(n$6, "invalid SQL expression", { where: t2 });
  if (!r2.isStandardized)
    throw new s$2u(n$6, "where clause is not standard", { where: t2 });
  return c$7(i2, r2.fieldNames, "where clause contains missing fields"), true;
}
function a$5(i2, t2, r2) {
  if (!t2)
    return true;
  const o2 = s$6.get(t2, i2);
  if (!o2)
    throw new s$2u(n$6, "invalid SQL expression", { having: t2 });
  if (!o2.isAggregate)
    throw new s$2u(n$6, "having does not contain a valid aggregate function", { having: t2 });
  const a2 = o2.fieldNames;
  c$7(i2, a2, "having contains missing fields");
  if (!o2.getExpressions().every((e2) => {
    const { aggregateType: s2, field: n2 } = e2, t3 = i2.has(n2) && i2.get(n2).name;
    return r2.some((e3) => {
      const { onStatisticField: n3, statisticType: r3 } = e3;
      return (i2.has(n3) && i2.get(n3).name) === t3 && r3.toLowerCase().trim() === s2;
    });
  }))
    throw new s$2u(n$6, "expressions in having should also exist in outStatistics", { having: t2 });
  return true;
}
function l$8(e2, i2) {
  return e2 ? s$6.get(e2, i2) : null;
}
function c$7(i2, s2, t2, r2 = true) {
  const o2 = [];
  for (const u2 of s2)
    if (u2 !== "*" && !i2.has(u2))
      if (r2) {
        const s3 = d$3(u2);
        try {
          const t3 = l$8(s3, i2);
          if (!t3)
            throw new s$2u(n$6, "invalid SQL expression", { where: s3 });
          if (!t3.isStandardized)
            throw new s$2u(n$6, "expression is not standard", { clause: t3 });
          c$7(i2, t3.fieldNames, "expression contains missing fields");
        } catch (a2) {
          const e2 = a2 && a2.details;
          if (e2 && (e2.clause || e2.where))
            throw a2;
          e2 && e2.missingFields ? o2.push(...e2.missingFields) : o2.push(u2);
        }
      } else
        o2.push(u2);
  if (o2.length)
    throw new s$2u(n$6, t2, { missingFields: o2 });
}
function d$3(e2) {
  return e2.split(t$5)[0];
}
function u$4(e2) {
  return e2.split(t$5)[1];
}
function f$6(e2, i2) {
  const s2 = i2.get(e2);
  return !!s2 && !r$6.has(s2.type);
}
const c$6 = new s$2a({ classBreaksDef: "class-breaks-definition", uniqueValueDef: "unique-value-definition" });
let l$7 = class extends l$2B {
  constructor() {
    super(...arguments), this.baseSymbol = null, this.colorRamp = null, this.type = null;
  }
};
e$2g([y$1I({ type: a$2u, json: { write: true } })], l$7.prototype, "baseSymbol", void 0), e$2g([y$1I({ types: m$1n, json: { read: { reader: p$1$ }, write: true } })], l$7.prototype, "colorRamp", void 0), e$2g([y$1I({ json: { read: c$6.read, write: c$6.write } })], l$7.prototype, "type", void 0), l$7 = e$2g([n$2P("esri.rest.support.ClassificationDefinition")], l$7);
const m$7 = l$7;
const o$4 = new s$2a({ esriClassifyEqualInterval: "equal-interval", esriClassifyManual: "manual", esriClassifyNaturalBreaks: "natural-breaks", esriClassifyQuantile: "quantile", esriClassifyStandardDeviation: "standard-deviation", esriClassifyDefinedInterval: "defined-interval" }), a$4 = new s$2a({ esriNormalizeByLog: "log", esriNormalizeByPercentOfTotal: "percent-of-total", esriNormalizeByField: "field" });
let n$5 = class extends m$7 {
  constructor() {
    super(...arguments), this.breakCount = null, this.classificationField = null, this.classificationMethod = null, this.normalizationField = null, this.normalizationType = null, this.type = "class-breaks-definition";
  }
  set standardDeviationInterval(e2) {
    this.classificationMethod === "standard-deviation" && this._set("standardDeviationInterval", e2);
  }
  set definedInterval(e2) {
    this.classificationMethod === "defined-interval" && this._set("definedInterval", e2);
  }
};
e$2g([y$1I({ json: { write: true } })], n$5.prototype, "breakCount", void 0), e$2g([y$1I({ json: { write: true } })], n$5.prototype, "classificationField", void 0), e$2g([y$1I({ type: String, json: { read: o$4.read, write: o$4.write } })], n$5.prototype, "classificationMethod", void 0), e$2g([y$1I({ json: { write: true } })], n$5.prototype, "normalizationField", void 0), e$2g([y$1I({ json: { read: a$4.read, write: a$4.write } })], n$5.prototype, "normalizationType", void 0), e$2g([y$1I({ value: null, json: { write: true } })], n$5.prototype, "standardDeviationInterval", null), e$2g([y$1I({ value: null, json: { write: true } })], n$5.prototype, "definedInterval", null), e$2g([y$1I()], n$5.prototype, "type", void 0), n$5 = e$2g([n$2P("esri.rest.support.ClassBreaksDefinition")], n$5);
const l$6 = n$5;
const t$4 = s$2z.getLogger("esri.rest.support.generateRendererUtils");
function l$5(e2, t2) {
  return Number(e2.toFixed(t2));
}
function a$3(e2) {
  const { normalizationTotal: t2 } = e2;
  return { classBreaks: u$3(e2), normalizationTotal: t2 };
}
function u$3(e2) {
  const t2 = e2.definition, { classificationMethod: n2, breakCount: a2, normalizationType: u2, definedInterval: i2 } = t2, c2 = [];
  let b2 = e2.values;
  if (b2.length === 0)
    return [];
  b2 = b2.sort((e3, t3) => e3 - t3);
  const V2 = b2[0], p2 = b2[b2.length - 1];
  if (n2 === "equal-interval")
    if (b2.length >= a2) {
      const e3 = (p2 - V2) / a2;
      let t3 = V2;
      for (let n3 = 1; n3 < a2; n3++) {
        const a3 = l$5(V2 + n3 * e3, 6);
        c2.push({ minValue: t3, maxValue: a3, label: s$5(t3, a3, u2) }), t3 = a3;
      }
      c2.push({ minValue: t3, maxValue: p2, label: s$5(t3, p2, u2) });
    } else
      b2.forEach((e3) => {
        c2.push({ minValue: e3, maxValue: e3, label: s$5(e3, e3, u2) });
      });
  else if (n2 === "natural-breaks") {
    const t3 = o$3(b2), n3 = e2.valueFrequency || t3.valueFrequency, i3 = r$5(t3.uniqueValues, n3, a2);
    let f2 = V2;
    for (let e3 = 1; e3 < a2; e3++)
      if (t3.uniqueValues.length > e3) {
        const n4 = l$5(t3.uniqueValues[i3[e3]], 6);
        c2.push({ minValue: f2, maxValue: n4, label: s$5(f2, n4, u2) }), f2 = n4;
      }
    c2.push({ minValue: f2, maxValue: p2, label: s$5(f2, p2, u2) });
  } else if (n2 === "quantile")
    if (b2.length >= a2 && V2 !== p2) {
      let e3 = V2, t3 = Math.ceil(b2.length / a2), l2 = 0;
      for (let n3 = 1; n3 < a2; n3++) {
        let o2 = t3 + l2 - 1;
        o2 > b2.length && (o2 = b2.length - 1), o2 < 0 && (o2 = 0), c2.push({ minValue: e3, maxValue: b2[o2], label: s$5(e3, b2[o2], u2) }), e3 = b2[o2], l2 += t3, t3 = Math.ceil((b2.length - l2) / (a2 - n3));
      }
      c2.push({ minValue: e3, maxValue: p2, label: s$5(e3, p2, u2) });
    } else {
      let e3 = -1;
      for (let t3 = 0; t3 < b2.length; t3++) {
        const l2 = b2[t3];
        l2 !== e3 && (e3 = l2, c2.push({ minValue: e3, maxValue: l2, label: s$5(e3, l2, u2) }), e3 = l2);
      }
    }
  else if (n2 === "standard-deviation") {
    const e3 = h$6(b2), t3 = m$6(b2, e3);
    if (t3 === 0)
      c2.push({ minValue: b2[0], maxValue: b2[0], label: s$5(b2[0], b2[0], u2) });
    else {
      const n3 = f$5(V2, p2, a2, e3, t3) * t3;
      let o2 = 0, r2 = V2;
      for (let t4 = a2; t4 >= 1; t4--) {
        const a3 = l$5(e3 - (t4 - 0.5) * n3, 6);
        c2.push({ minValue: r2, maxValue: a3, label: s$5(r2, a3, u2) }), r2 = a3, o2++;
      }
      let i3 = l$5(e3 + 0.5 * n3, 6);
      c2.push({ minValue: r2, maxValue: i3, label: s$5(r2, i3, u2) }), r2 = i3, o2++;
      for (let t4 = 1; t4 <= a2; t4++)
        i3 = o2 === 2 * a2 ? p2 : l$5(e3 + (t4 + 0.5) * n3, 6), c2.push({ minValue: r2, maxValue: i3, label: s$5(r2, i3, u2) }), r2 = i3, o2++;
    }
  } else if (n2 === "defined-interval") {
    if (!i2)
      return c2;
    const e3 = b2[0], t3 = b2[b2.length - 1], n3 = Math.ceil((t3 - e3) / i2);
    let a3 = e3;
    for (let o2 = 1; o2 < n3; o2++) {
      const t4 = l$5(e3 + o2 * i2, 6);
      c2.push({ minValue: a3, maxValue: t4, label: s$5(a3, t4, u2) }), a3 = t4;
    }
    c2.push({ minValue: a3, maxValue: t3, label: s$5(a3, t3, u2) });
  }
  return c2;
}
function s$5(e2, t2, l2) {
  let n2 = null;
  return n2 = e2 === t2 ? l2 && l2 === "percent-of-total" ? e2 + "%" : e2.toString() : l2 && l2 === "percent-of-total" ? e2 + "% - " + t2 + "%" : e2 + " - " + t2, n2;
}
function o$3(e2) {
  const t2 = [], l2 = [];
  let n2 = Number.MIN_VALUE, a2 = 1, u2 = -1;
  for (let s2 = 0; s2 < e2.length; s2++) {
    const o2 = e2[s2];
    o2 === n2 ? (a2++, l2[u2] = a2) : o2 !== null && (t2.push(o2), n2 = o2, a2 = 1, l2.push(a2), u2++);
  }
  return { uniqueValues: t2, valueFrequency: l2 };
}
function r$5(e2, t2, l2) {
  const n2 = e2.length, a2 = [];
  l2 > n2 && (l2 = n2);
  for (let s2 = 0; s2 < l2; s2++)
    a2.push(Math.round(s2 * n2 / l2 - 1));
  a2.push(n2 - 1);
  let u2 = i$5(a2, e2, t2, l2);
  return c$5(u2.mean, u2.sdcm, a2, e2, t2, l2) && (u2 = i$5(a2, e2, t2, l2)), a2;
}
function i$5(e2, t2, l2, n2) {
  let a2 = [], u2 = [], s2 = [], o2 = 0;
  const r2 = [], i2 = [];
  for (let m2 = 0; m2 < n2; m2++) {
    const n3 = b$4(m2, e2, t2, l2);
    r2.push(n3.sbMean), i2.push(n3.sbSdcm), o2 += i2[m2];
  }
  let c2, f2 = o2, h2 = true;
  for (; h2 || o2 < f2; ) {
    h2 = false, a2 = [];
    for (let t3 = 0; t3 < n2; t3++)
      a2.push(e2[t3]);
    for (let l3 = 0; l3 < n2; l3++)
      for (let a3 = e2[l3] + 1; a3 <= e2[l3 + 1]; a3++)
        if (c2 = t2[a3], l3 > 0 && a3 !== e2[l3 + 1] && Math.abs(c2 - r2[l3]) > Math.abs(c2 - r2[l3 - 1]))
          e2[l3] = a3;
        else if (l3 < n2 - 1 && e2[l3] !== a3 - 1 && Math.abs(c2 - r2[l3]) > Math.abs(c2 - r2[l3 + 1])) {
          e2[l3 + 1] = a3 - 1;
          break;
        }
    f2 = o2, o2 = 0, u2 = [], s2 = [];
    for (let a3 = 0; a3 < n2; a3++) {
      u2.push(r2[a3]), s2.push(i2[a3]);
      const n3 = b$4(a3, e2, t2, l2);
      r2[a3] = n3.sbMean, i2[a3] = n3.sbSdcm, o2 += i2[a3];
    }
  }
  if (o2 > f2) {
    for (let t3 = 0; t3 < n2; t3++)
      e2[t3] = a2[t3], r2[t3] = u2[t3], i2[t3] = s2[t3];
    o2 = f2;
  }
  return { mean: r2, sdcm: i2 };
}
function c$5(e2, t2, l2, n2, a2, u2) {
  let s2 = 0, o2 = 0, r2 = 0, i2 = 0, c2 = true;
  for (let f2 = 0; f2 < 2 && c2; f2++) {
    f2 === 0 && (c2 = false);
    for (let f3 = 0; f3 < u2 - 1; f3++)
      for (; l2[f3 + 1] + 1 !== l2[f3 + 2]; ) {
        l2[f3 + 1] = l2[f3 + 1] + 1;
        const u3 = b$4(f3, l2, n2, a2);
        r2 = u3.sbMean, s2 = u3.sbSdcm;
        const h2 = b$4(f3 + 1, l2, n2, a2);
        if (i2 = h2.sbMean, o2 = h2.sbSdcm, !(s2 + o2 < t2[f3] + t2[f3 + 1])) {
          l2[f3 + 1] = l2[f3 + 1] - 1;
          break;
        }
        t2[f3] = s2, t2[f3 + 1] = o2, e2[f3] = r2, e2[f3 + 1] = i2, c2 = true;
      }
    for (let f3 = u2 - 1; f3 > 0; f3--)
      for (; l2[f3] !== l2[f3 - 1] + 1; ) {
        l2[f3] = l2[f3] - 1;
        const u3 = b$4(f3 - 1, l2, n2, a2);
        r2 = u3.sbMean, s2 = u3.sbSdcm;
        const h2 = b$4(f3, l2, n2, a2);
        if (i2 = h2.sbMean, o2 = h2.sbSdcm, !(s2 + o2 < t2[f3 - 1] + t2[f3])) {
          l2[f3] = l2[f3] + 1;
          break;
        }
        t2[f3 - 1] = s2, t2[f3] = o2, e2[f3 - 1] = r2, e2[f3] = i2, c2 = true;
      }
  }
  return c2;
}
function f$5(e2, t2, l2, n2, a2) {
  let u2 = Math.max(n2 - e2, t2 - n2) / a2 / l2;
  return u2 = u2 >= 1 ? 1 : u2 >= 0.5 ? 0.5 : 0.25, u2;
}
function h$6(e2) {
  let t2 = 0;
  for (let l2 = 0; l2 < e2.length; l2++)
    t2 += e2[l2];
  return t2 /= e2.length, t2;
}
function m$6(e2, t2) {
  let l2 = 0;
  for (let n2 = 0; n2 < e2.length; n2++) {
    const a2 = e2[n2];
    l2 += (a2 - t2) * (a2 - t2);
  }
  l2 /= e2.length;
  return Math.sqrt(l2);
}
function b$4(e2, l2, n2, a2) {
  let u2 = 0, s2 = 0;
  for (let t2 = l2[e2] + 1; t2 <= l2[e2 + 1]; t2++) {
    const e3 = a2[t2];
    u2 += n2[t2] * e3, s2 += e3;
  }
  s2 <= 0 && t$4.warn("Exception in Natural Breaks calculation");
  const o2 = u2 / s2;
  let r2 = 0;
  for (let t2 = l2[e2] + 1; t2 <= l2[e2 + 1]; t2++)
    r2 += a2[t2] * (n2[t2] - o2) ** 2;
  return { sbMean: o2, sbSdcm: r2 };
}
const t$3 = "<Null>", i$4 = "equal-interval", l$4 = 1, a$2 = 5, o$2 = 10, r$4 = /\s*(\+|-)?((\d+(\.\d+)?)|(\.\d+))\s*/gi, u$2 = new Set(["esriFieldTypeInteger", "esriFieldTypeSmallInteger", "esriFieldTypeSingle", "esriFieldTypeDouble"]), s$4 = ["min", "max", "avg", "stddev", "count", "sum", "variance", "nullcount", "median"];
function c$4(n2) {
  return n2 == null || typeof n2 == "string" && !n2 ? t$3 : n2;
}
function m$5(n2) {
  const e2 = n2.normalizationField != null || n2.normalizationType != null, t2 = n2.minValue != null || n2.maxValue != null, i2 = !!n2.sqlExpression && n2.supportsSQLExpression;
  return !e2 && !t2 && !i2;
}
function f$4(n2) {
  const e2 = n2.returnDistinct ? [...new Set(n2.values)] : n2.values, t2 = e2.filter((n3) => n3 != null).length, i2 = { count: t2 };
  return n2.supportsNullCount && (i2.nullcount = e2.length - t2), n2.percentileParams && (i2.median = p$5(e2, n2.percentileParams)), i2;
}
function d$2(n2) {
  const { values: e2, useSampleStdDev: t2, supportsNullCount: i2 } = n2;
  let l2 = Number.POSITIVE_INFINITY, a2 = Number.NEGATIVE_INFINITY, o2 = null, r2 = null, u2 = null, s2 = null, c2 = 0;
  const m2 = n2.minValue == null ? -1 / 0 : n2.minValue, f2 = n2.maxValue == null ? 1 / 0 : n2.maxValue;
  for (const p2 of e2)
    Number.isFinite(p2) ? p2 >= m2 && p2 <= f2 && (o2 += p2, l2 = Math.min(l2, p2), a2 = Math.max(a2, p2), c2++) : typeof p2 == "string" && c2++;
  if (c2 && o2 != null) {
    r2 = o2 / c2;
    let n3 = 0;
    for (const t3 of e2)
      Number.isFinite(t3) && t3 >= m2 && t3 <= f2 && (n3 += (t3 - r2) ** 2);
    s2 = t2 ? c2 > 1 ? n3 / (c2 - 1) : 0 : c2 > 0 ? n3 / c2 : 0, u2 = Math.sqrt(s2);
  } else
    l2 = null, a2 = null;
  const d2 = { avg: r2, count: c2, max: a2, min: l2, stddev: u2, sum: o2, variance: s2 };
  return i2 && (d2.nullcount = e2.length - c2), n2.percentileParams && (d2.median = p$5(e2, n2.percentileParams)), d2;
}
function p$5(n2, e2) {
  const { fieldType: t2, value: i2, orderBy: l2, isDiscrete: a2 } = e2, o2 = v$5(t2, l2 === "desc");
  if ((n2 = [...n2].filter((n3) => n3 != null).sort((n3, e3) => o2(n3, e3))).length === 0)
    return null;
  if (i2 <= 0)
    return n2[0];
  if (i2 >= 1)
    return n2[n2.length - 1];
  const r2 = (n2.length - 1) * i2, u2 = Math.floor(r2), s2 = u2 + 1, c2 = r2 % 1, m2 = n2[u2], f2 = n2[s2];
  return s2 >= n2.length || a2 || typeof m2 == "string" || typeof f2 == "string" ? m2 : m2 * (1 - c2) + f2 * c2;
}
function v$5(n2, e2) {
  const t2 = e2 ? 1 : -1, i2 = h$5(e2), l2 = b$3(e2);
  if (!(!!n2 && ["esriFieldTypeDate", "esriFieldTypeString", "esriFieldTypeGUID", "esriFieldTypeGlobalID", ...u$2].includes(n2)))
    return (n3, e3) => typeof n3 == "number" && typeof e3 == "number" ? i2(n3, e3) : typeof n3 == "string" && typeof e3 == "string" ? l2(n3, e3) : t2;
  if (n2 === "esriFieldTypeDate")
    return (n3, e3) => {
      const l3 = new Date(n3).getTime(), a2 = new Date(e3).getTime();
      return isNaN(l3) || isNaN(a2) ? t2 : i2(l3, a2);
    };
  if (u$2.has(n2))
    return (n3, e3) => i2(n3, e3);
  if (n2 === "esriFieldTypeString")
    return (n3, e3) => l2(n3, e3);
  if (n2 === "esriFieldTypeGUID" || n2 === "esriFieldTypeGlobalID") {
    const n3 = b$3(e2);
    return (e3, t3) => n3(g$5(e3), g$5(t3));
  }
  return e2 ? (n3, e3) => 1 : (n3, e3) => -1;
}
function b$3(n2) {
  return n2 ? (n3, e2) => (n3 = n3 == null ? void 0 : n3.toUpperCase(), e2 = e2 == null ? void 0 : e2.toUpperCase(), n3 > e2 ? -1 : n3 < e2 ? 1 : 0) : (n3, e2) => (n3 = n3 == null ? void 0 : n3.toUpperCase(), e2 = e2 == null ? void 0 : e2.toUpperCase(), n3 < e2 ? -1 : n3 > e2 ? 1 : 0);
}
function h$5(n2) {
  return n2 ? (n3, e2) => e2 - n3 : (n3, e2) => n3 - e2;
}
function g$5(n2) {
  return n2.substr(24, 12) + n2.substr(19, 4) + n2.substr(16, 2) + n2.substr(14, 2) + n2.substr(11, 2) + n2.substr(9, 2) + n2.substr(6, 2) + n2.substr(4, 2) + n2.substr(2, 2) + n2.substr(0, 2);
}
function V$2(n2, e2) {
  let t2;
  for (t2 in n2)
    s$4.includes(t2) && (Number.isFinite(n2[t2]) || (n2[t2] = null));
  return e2 ? (["avg", "stddev", "variance"].forEach((e3) => {
    n2[e3] != null && (n2[e3] = Math.ceil(n2[e3]));
  }), n2) : n2;
}
function T$2(n2) {
  const e2 = {};
  for (let t2 of n2)
    (t2 == null || typeof t2 == "string" && t2.trim() === "") && (t2 = null), e2[t2] == null ? e2[t2] = { count: 1, data: t2 } : e2[t2].count++;
  return { count: e2 };
}
function y$1(n2) {
  return (n2 == null ? void 0 : n2.type) !== "coded-value" ? [] : n2.codedValues.map((n3) => n3.code);
}
function F$3(n2, e2, t2, i2) {
  const l2 = n2.count, a2 = [];
  if (t2 && e2) {
    const n3 = [], t3 = y$1(e2[0]);
    for (const l3 of t3)
      if (e2[1]) {
        const t4 = y$1(e2[1]);
        for (const a3 of t4)
          if (e2[2]) {
            const t5 = y$1(e2[2]);
            for (const e3 of t5)
              n3.push(`${c$4(l3)}${i2}${c$4(a3)}${i2}${c$4(e3)}`);
          } else
            n3.push(`${c$4(l3)}${i2}${c$4(a3)}`);
      } else
        n3.push(l3);
    for (const e3 of n3)
      l2.hasOwnProperty(e3) || (l2[e3] = { data: e3, count: 0 });
  }
  for (const o2 in l2) {
    const n3 = l2[o2];
    a2.push({ value: n3.data, count: n3.count, label: n3.label });
  }
  return { uniqueValueInfos: a2 };
}
function x$4(n2, e2, t2, i2) {
  let l2 = null;
  switch (e2) {
    case "log":
      n2 !== 0 && (l2 = Math.log(n2) * Math.LOG10E);
      break;
    case "percent-of-total":
      Number.isFinite(i2) && i2 !== 0 && (l2 = n2 / i2 * 100);
      break;
    case "field":
      Number.isFinite(t2) && t2 !== 0 && (l2 = n2 / t2);
      break;
    case "natural-log":
      n2 > 0 && (l2 = Math.log(n2));
      break;
    case "square-root":
      n2 > 0 && (l2 = n2 ** 0.5);
  }
  return l2;
}
function D$3(n2, t2) {
  const i2 = I$4({ field: t2.field, normalizationType: t2.normalizationType, normalizationField: t2.normalizationField, classificationMethod: t2.classificationMethod, standardDeviationInterval: t2.standardDeviationInterval, breakCount: t2.numClasses || a$2 });
  return n2 = z$3(n2, t2.minValue, t2.maxValue), a$3({ definition: i2, values: n2, normalizationTotal: t2.normalizationTotal });
}
function z$3(n2, e2, t2) {
  return e2 = e2 != null ? e2 : -1 / 0, t2 = t2 != null ? t2 : 1 / 0, n2.filter((n3) => Number.isFinite(n3) && n3 >= e2 && n3 <= t2);
}
function I$4(e2) {
  const t2 = e2.field, a2 = e2.classificationMethod || i$4, o2 = e2.normalizationType, r2 = e2.normalizationField, u2 = new l$6();
  return u2.classificationField = t2, u2.breakCount = e2.breakCount, u2.classificationMethod = a2, u2.standardDeviationInterval = a2 === "standard-deviation" ? e2.standardDeviationInterval || l$4 : void 0, u2.normalizationType = o2, u2.normalizationField = o2 === "field" ? r2 : void 0, u2;
}
function N$3(n2, e2) {
  let t2 = n2.classBreaks;
  const i2 = t2.length, l2 = t2[0].minValue, a2 = t2[i2 - 1].maxValue, o2 = e2 === "standard-deviation", u2 = r$4;
  return t2 = t2.map((n3) => {
    const e3 = n3.label, t3 = { minValue: n3.minValue, maxValue: n3.maxValue, label: e3 };
    if (o2 && e3) {
      const n4 = e3.match(u2).map((n5) => +n5.trim());
      n4.length === 2 ? (t3.minStdDev = n4[0], t3.maxStdDev = n4[1], n4[0] < 0 && n4[1] > 0 && (t3.hasAvg = true)) : n4.length === 1 && (e3.includes("<") ? (t3.minStdDev = null, t3.maxStdDev = n4[0]) : e3.includes(">") && (t3.minStdDev = n4[0], t3.maxStdDev = null));
    }
    return t3;
  }), { minValue: l2, maxValue: a2, classBreakInfos: t2, normalizationTotal: n2.normalizationTotal };
}
function S$2(n2, e2) {
  const { min: t2, max: i2, intervals: l2 } = M$5(n2, e2), a2 = l2.map((n3, e3) => ({ minValue: l2[e3][0], maxValue: l2[e3][1], count: 0 }));
  for (const o2 of n2)
    if (o2 != null && o2 >= t2 && o2 <= i2) {
      const n3 = C$3(l2, o2);
      n3 > -1 && a2[n3].count++;
    }
  return { bins: a2, minValue: t2, maxValue: i2, normalizationTotal: e2.normalizationTotal };
}
function M$5(n2, e2) {
  const { field: t2, classificationMethod: i2, standardDeviationInterval: l2, normalizationType: a2, normalizationField: r2, normalizationTotal: u2, minValue: s2, maxValue: c2 } = e2, f2 = e2.numBins || o$2;
  let p2 = null, v2 = null, b2 = null;
  if ((!i2 || i2 === "equal-interval") && !a2) {
    if (s2 != null && c2 != null)
      p2 = s2, v2 = c2;
    else {
      const e3 = d$2({ values: n2, minValue: s2, maxValue: c2, useSampleStdDev: !a2, supportsNullCount: m$5({ normalizationType: a2, normalizationField: r2, minValue: s2, maxValue: c2 }) });
      p2 = e3.min, v2 = e3.max;
    }
    b2 = k$2(p2, v2, f2);
  } else {
    const { classBreaks: e3 } = D$3(n2, { field: t2, normalizationType: a2, normalizationField: r2, normalizationTotal: u2, classificationMethod: i2, standardDeviationInterval: l2, minValue: s2, maxValue: c2, numClasses: f2 });
    p2 = e3[0].minValue, v2 = e3[e3.length - 1].maxValue, b2 = e3.map((n3) => [n3.minValue, n3.maxValue]);
  }
  return { min: p2, max: v2, intervals: b2 };
}
function C$3(n2, e2) {
  let t2 = -1;
  for (let i2 = n2.length - 1; i2 >= 0; i2--) {
    if (e2 >= n2[i2][0]) {
      t2 = i2;
      break;
    }
  }
  return t2;
}
function k$2(n2, e2, t2) {
  const i2 = (e2 - n2) / t2, l2 = [];
  let a2, o2 = n2;
  for (let r2 = 1; r2 <= t2; r2++)
    a2 = o2 + i2, a2 = Number(a2.toFixed(16)), l2.push([o2, r2 === t2 ? e2 : a2]), o2 = a2;
  return l2;
}
class r$3 {
  constructor(t2, a2, l2) {
    var _a2;
    this._fieldDataCache = new Map(), this._returnDistinctMap = new Map(), this.returnDistinctValues = (_a2 = t2.returnDistinctValues) != null ? _a2 : false, this.fieldsIndex = l2, this.featureAdapter = a2;
    const r2 = t2.outFields;
    if (r2 && !r2.includes("*")) {
      this.outFields = r2;
      let t3 = 0;
      for (const a3 of r2) {
        const r3 = d$3(a3), n2 = this.fieldsIndex.get(r3), u2 = n2 ? null : l$8(r3, l2), d2 = n2 ? n2.name : u$4(a3) || "FIELD_EXP_" + t3++;
        this._fieldDataCache.set(a3, { alias: d2, clause: u2 });
      }
    }
  }
  countDistinctValues(t2) {
    return this.returnDistinctValues ? (t2.forEach((t3) => this.getAttributes(t3)), this._returnDistinctMap.size) : t2.length;
  }
  getAttributes(t2) {
    const e2 = this._processAttributesForOutFields(t2);
    return this._processAttributesForDistinctValues(e2);
  }
  getFieldValue(t2, e2, s2) {
    const a2 = s2 ? s2.name : e2;
    let l2 = null;
    return this._fieldDataCache.has(a2) ? l2 = this._fieldDataCache.get(a2).clause : s2 || (l2 = l$8(e2, this.fieldsIndex), this._fieldDataCache.set(a2, { alias: a2, clause: l2 })), s2 ? this.featureAdapter.getAttribute(t2, a2) : l2.calculateValue(t2, this.featureAdapter);
  }
  getDataValue(t2, e2) {
    const i2 = e2.normalizationType, s2 = e2.normalizationTotal;
    let r2 = this.getFieldValue(t2, e2.field, this.fieldsIndex.get(e2.field));
    if (e2.field2 && (r2 = `${c$4(r2)}${e2.fieldDelimiter}${c$4(this.getFieldValue(t2, e2.field2, this.fieldsIndex.get(e2.field2)))}`, e2.field3 && (r2 = `${r2}${e2.fieldDelimiter}${c$4(this.getFieldValue(t2, e2.field3, this.fieldsIndex.get(e2.field3)))}`)), i2 && Number.isFinite(r2)) {
      const a2 = i2 === "field" && e2.normalizationField ? this.getFieldValue(t2, e2.normalizationField, this.fieldsIndex.get(e2.normalizationField)) : null;
      r2 = x$4(r2, i2, a2, s2);
    }
    return r2;
  }
  getExpressionValue(t2, e2, i2, s2) {
    const a2 = { attributes: this.featureAdapter.getAttributes(t2), layer: { fields: this.fieldsIndex.fields } }, l2 = s2.createExecContext(a2, i2);
    return s2.executeFunction(e2, l2);
  }
  getExpressionValues(t2, e2, i2, s2) {
    const a2 = { fields: this.fieldsIndex.fields };
    return t2.map((t3) => {
      const l2 = { attributes: this.featureAdapter.getAttributes(t3), layer: a2 }, r2 = s2.createExecContext(l2, i2);
      return s2.executeFunction(e2, r2);
    });
  }
  validateItem(t2, e2) {
    return this._fieldDataCache.has(e2) || this._fieldDataCache.set(e2, { alias: e2, clause: l$8(e2, this.fieldsIndex) }), this._fieldDataCache.get(e2).clause.testFeature(t2, this.featureAdapter);
  }
  validateItems(t2, e2) {
    return this._fieldDataCache.has(e2) || this._fieldDataCache.set(e2, { alias: e2, clause: l$8(e2, this.fieldsIndex) }), this._fieldDataCache.get(e2).clause.testSet(t2, this.featureAdapter);
  }
  _processAttributesForOutFields(t2) {
    const e2 = this.outFields;
    if (!e2 || !e2.length)
      return this.featureAdapter.getAttributes(t2);
    const i2 = {};
    for (const s2 of e2) {
      const { alias: e3, clause: a2 } = this._fieldDataCache.get(s2);
      i2[e3] = a2 ? a2.calculateValue(t2, this.featureAdapter) : this.featureAdapter.getAttribute(t2, e3);
    }
    return i2;
  }
  _processAttributesForDistinctValues(e2) {
    if (t$2r(e2) || !this.returnDistinctValues)
      return e2;
    const i2 = this.outFields, s2 = [];
    if (i2)
      for (const t2 of i2) {
        const { alias: i3 } = this._fieldDataCache.get(t2);
        s2.push(e2[i3]);
      }
    else
      for (const t2 in e2)
        s2.push(e2[t2]);
    const a2 = `${(i2 || ["*"]).join(",")}=${s2.join(",")}`;
    let l2 = this._returnDistinctMap.get(a2) || 0;
    return this._returnDistinctMap.set(a2, ++l2), l2 > 1 ? null : e2;
  }
}
const t$2 = { convertToGEGeometry: s$3, exportPoint: n$4, exportPolygon: o$1, exportPolyline: a$1, exportMultipoint: c$3, exportExtent: m$4 };
function s$3(t2, s2) {
  return s2 == null ? null : t2.convertJSONToGeometry(s2);
}
class i$3 {
  constructor(t2, s2, i2) {
    this.x = t2, this.y = s2, this.spatialReference = i2, this.z = void 0, this.m = void 0;
  }
}
function n$4(t2, s2, n2) {
  const e2 = new i$3(t2.getPointX(s2), t2.getPointY(s2), n2), o2 = t2.hasZ(s2), h2 = t2.hasM(s2);
  return o2 && (e2.z = t2.getPointZ(s2)), h2 && (e2.m = t2.getPointM(s2)), e2;
}
class e$2 {
  constructor(t2, s2, i2, n2) {
    this.rings = t2, this.spatialReference = s2, this.hasZ = void 0, this.hasM = void 0, i2 && (this.hasZ = i2), n2 && (this.hasM = n2);
  }
}
function o$1(t2, s2, i2) {
  return new e$2(t2.exportPaths(s2), i2, t2.hasZ(s2), t2.hasM(s2));
}
class h$4 {
  constructor(t2, s2, i2, n2) {
    this.paths = t2, this.spatialReference = s2, this.hasZ = void 0, this.hasM = void 0, i2 && (this.hasZ = i2), n2 && (this.hasM = n2);
  }
}
function a$1(t2, s2, i2) {
  return new h$4(t2.exportPaths(s2), i2, t2.hasZ(s2), t2.hasM(s2));
}
class r$2 {
  constructor(t2, s2, i2, n2) {
    this.points = t2, this.spatialReference = s2, this.hasZ = void 0, this.hasM = void 0, i2 && (this.hasZ = i2), n2 && (this.hasM = n2);
  }
}
function c$3(t2, s2, i2) {
  return new r$2(t2.exportPoints(s2), i2, t2.hasZ(s2), t2.hasM(s2));
}
class x$3 {
  constructor(t2, s2, i2, n2, e2) {
    this.xmin = t2, this.ymin = s2, this.xmax = i2, this.ymax = n2, this.spatialReference = e2, this.zmin = void 0, this.zmax = void 0, this.mmin = void 0, this.mmax = void 0;
  }
}
function m$4(t2, s2, i2) {
  const n2 = t2.hasZ(s2), e2 = t2.hasM(s2), o2 = new x$3(t2.getXMin(s2), t2.getYMin(s2), t2.getXMax(s2), t2.getYMax(s2), i2);
  if (n2) {
    const i3 = t2.getZExtent(s2);
    o2.zmin = i3.vmin, o2.zmax = i3.vmax;
  }
  if (e2) {
    const i3 = t2.getMExtent(s2);
    o2.mmin = i3.vmin, o2.mmax = i3.vmax;
  }
  return o2;
}
const l$3 = [0, 0];
function h$3(s2, t2) {
  if (!t2)
    return null;
  if ("x" in t2) {
    const e2 = { x: 0, y: 0 };
    return [e2.x, e2.y] = s2(t2.x, t2.y, l$3), t2.z != null && (e2.z = t2.z), t2.m != null && (e2.m = t2.m), e2;
  }
  if ("xmin" in t2) {
    const e2 = { xmin: 0, ymin: 0, xmax: 0, ymax: 0 };
    return [e2.xmin, e2.ymin] = s2(t2.xmin, t2.ymin, l$3), [e2.xmax, e2.ymax] = s2(t2.xmax, t2.ymax, l$3), t2.hasZ && (e2.zmin = t2.zmin, e2.zmax = t2.zmax, e2.hasZ = true), t2.hasM && (e2.mmin = t2.mmin, e2.mmax = t2.mmax, e2.hasM = true), e2;
  }
  return "rings" in t2 ? { rings: c$2(t2.rings, s2), hasM: t2.hasM, hasZ: t2.hasZ } : "paths" in t2 ? { paths: c$2(t2.paths, s2), hasM: t2.hasM, hasZ: t2.hasZ } : "points" in t2 ? { points: p$4(t2.points, s2), hasM: t2.hasM, hasZ: t2.hasZ } : null;
}
function c$2(s2, t2) {
  const e2 = [];
  for (const n2 of s2)
    e2.push(p$4(n2, t2));
  return e2;
}
function p$4(s2, t2) {
  const e2 = [];
  for (const n2 of s2) {
    const s3 = t2(n2[0], n2[1], [0, 0]);
    e2.push(s3), n2.length > 2 && s3.push(n2[2]), n2.length > 3 && s3.push(n2[3]);
  }
  return e2;
}
async function f$3(e2, n2) {
  if (!e2 || !n2)
    return;
  const r2 = Array.isArray(e2) ? e2.map((t2) => r$1$(t2.geometry) ? t2.geometry.spatialReference : null).filter(r$1$) : [e2];
  await _n(r2.map((s2) => ({ source: s2, dest: n2 })));
}
const x$2 = h$3.bind(null, y$1x), y = h$3.bind(null, d$1S);
function g$4(s2, t2, a2, m2) {
  if (!s2)
    return s2;
  if (a2 || (a2 = t2, t2 = s2.spatialReference), !I$K(t2) || !I$K(a2) || E$P(t2, a2))
    return s2;
  if (g$1i(t2, a2)) {
    const t3 = k$D(a2) ? x$2(s2) : y(s2);
    return t3.spatialReference = a2, t3;
  }
  return ln(t$2, [s2], t2, a2, null, m2)[0];
}
class _$3 {
  constructor() {
    this._jobs = [], this._timer = null, this._process = this._process.bind(this);
  }
  async push(s2, t2, e2) {
    if (!s2 || !s2.length || !t2 || !e2 || E$P(t2, e2))
      return s2;
    const n2 = { geometries: s2, inSpatialReference: t2, outSpatialReference: e2, resolve: null };
    return this._jobs.push(n2), new Promise((s3) => {
      n2.resolve = s3, this._timer === null && (this._timer = setTimeout(this._process, 10));
    });
  }
  _process() {
    this._timer = null;
    const s2 = this._jobs.shift();
    if (!s2)
      return;
    const { geometries: t2, inSpatialReference: r2, outSpatialReference: i2, resolve: a2 } = s2;
    g$1i(r2, i2) ? k$D(i2) ? a2(t2.map(x$2)) : a2(t2.map(y)) : a2(ln(t$2, t2, r2, i2, null, null)), this._jobs.length > 0 && (this._timer = setTimeout(this._process, 10));
  }
}
const j$4 = new _$3();
function M$4(s2, t2, e2) {
  return j$4.push(s2, t2, e2);
}
function t$1(t2, e2, r2) {
  return { objectId: t2, target: e2, distance: r2, type: "vertex" };
}
function e$1(t2, e2, r2, n2, d2, a2 = false) {
  return { objectId: t2, target: e2, distance: r2, type: "edge", start: n2, end: d2, draped: a2 };
}
const O$3 = new s$2a({ esriSRUnit_Meter: "meters", esriSRUnit_Kilometer: "kilometers", esriSRUnit_Foot: "feet", esriSRUnit_StatuteMile: "miles", esriSRUnit_NauticalMile: "nautical-miles", esriSRUnit_USNauticalMile: "us-nautical-miles" }), F$2 = Object.freeze({}), N$2 = new t$1f(), _$2 = new t$1f(), G$3 = new t$1f(), P$1 = { esriGeometryPoint: F$m, esriGeometryPolyline: $$9, esriGeometryPolygon: D$i, esriGeometryMultipoint: O$m };
function b$2(e2, i2, r2, n2 = e2.hasZ, o2 = e2.hasM) {
  if (t$2r(i2))
    return null;
  const s2 = e2.hasZ && n2, a2 = e2.hasM && o2;
  if (r2) {
    const t2 = at$2(G$3, i2, e2.hasZ, e2.hasM, "esriGeometryPoint", r2, n2, o2);
    return F$m(t2, s2, a2);
  }
  return F$m(i2, s2, a2);
}
function v$4(e2, r2, n2, o2, s2, a2, l2 = r2, m2 = n2) {
  var _a2, _b2, _c2, _d2, _e3, _f2;
  const f2 = r2 && l2, u2 = n2 && m2, c2 = r$1$(o2) ? "coords" in o2 ? o2 : o2.geometry : null;
  if (t$2r(c2))
    return null;
  if (s2) {
    let t2 = ht$1(_$2, c2, r2, n2, e2, s2, l2, m2);
    return a2 && (t2 = at$2(G$3, t2, f2, u2, e2, a2)), (_b2 = (_a2 = P$1[e2]) == null ? void 0 : _a2.call(P$1, t2, f2, u2)) != null ? _b2 : null;
  }
  if (a2) {
    const t2 = at$2(G$3, c2, r2, n2, e2, a2, l2, m2);
    return (_d2 = (_c2 = P$1[e2]) == null ? void 0 : _c2.call(P$1, t2, f2, u2)) != null ? _d2 : null;
  }
  return It(N$2, c2, r2, n2, l2, m2), (_f2 = (_e3 = P$1[e2]) == null ? void 0 : _e3.call(P$1, N$2, f2, u2)) != null ? _f2 : null;
}
async function z$2(e2, t2, i2) {
  const { outFields: r2, orderByFields: n2, groupByFieldsForStatistics: o2, outStatistics: s2 } = e2;
  if (r2)
    for (let a2 = 0; a2 < r2.length; a2++)
      r2[a2] = r2[a2].trim();
  if (n2)
    for (let a2 = 0; a2 < n2.length; a2++)
      n2[a2] = n2[a2].trim();
  if (o2)
    for (let a2 = 0; a2 < o2.length; a2++)
      o2[a2] = o2[a2].trim();
  if (s2)
    for (let a2 = 0; a2 < s2.length; a2++)
      s2[a2].onStatisticField && (s2[a2].onStatisticField = s2[a2].onStatisticField.trim());
  return e2.geometry && !e2.outSR && (e2.outSR = e2.geometry.spatialReference), J$3(e2, t2, i2);
}
async function J$3(e2, i2, r2) {
  var _a2;
  if (!e2)
    return null;
  let { where: n2 } = e2;
  if (e2.where = n2 = n2 && n2.trim(), (!n2 || /^1 *= *1$/.test(n2) || i2 && i2 === n2) && (e2.where = null), !e2.geometry)
    return e2;
  let a2 = await Z(e2);
  if (e2.distance = 0, e2.units = null, e2.spatialRel === "esriSpatialRelEnvelopeIntersects") {
    const { spatialReference: t2 } = e2.geometry;
    a2 = l$2u(a2), a2.spatialReference = t2;
  }
  if (a2) {
    await f$3(a2.spatialReference, r2), a2 = B$2(a2, r2);
    const i3 = (await v$L(v$14(a2)))[0];
    if (t$2r(i3))
      throw F$2;
    const n3 = "quantizationParameters" in e2 && ((_a2 = e2.quantizationParameters) == null ? void 0 : _a2.tolerance) || "maxAllowableOffset" in e2 && e2.maxAllowableOffset || 0, o2 = n3 && A$2(a2, r2) ? { densificationStep: 8 * n3 } : void 0, l2 = i3.toJSON(), m2 = await g$4(l2, l2.spatialReference, r2, o2);
    if (!m2)
      throw F$2;
    m2.spatialReference = r2, e2.geometry = m2;
  }
  return e2;
}
function A$2(e2, t2) {
  if (!e2)
    return false;
  const i2 = e2.spatialReference;
  return (u$20(e2) || y$1t(e2) || f$1H(e2)) && !E$P(i2, t2) && !An(i2, t2);
}
function B$2(e2, t2) {
  const i2 = e2.spatialReference;
  return A$2(e2, t2) && u$20(e2) ? { spatialReference: i2, rings: [[[e2.xmin, e2.ymin], [e2.xmin, e2.ymax], [e2.xmax, e2.ymax], [e2.xmax, e2.ymin], [e2.xmin, e2.ymin]]] } : e2;
}
async function Z(e2) {
  const { distance: t2, units: i2 } = e2, n2 = e2.geometry;
  if (t2 == null || "vertexAttributes" in n2)
    return n2;
  const o2 = n2.spatialReference, s2 = i2 ? O$3.fromJSON(i2) : X$c(o2), a2 = o2 && (o$27(o2) || k$D(o2)) ? n2 : await f$3(o2, c$3d).then(() => g$4(n2, c$3d));
  return (await q$2())(a2.spatialReference, a2, t2, s2);
}
async function q$2() {
  return (await import("./geometryEngineJSON2.js")).geodesicBuffer;
}
function E$4(e2) {
  return e2 && k$1 in e2 ? JSON.parse(JSON.stringify(e2, C$2)) : e2;
}
const k$1 = "_geVersion", C$2 = (e2, t2) => e2 !== k$1 ? t2 : void 0;
class A$1 {
  constructor(e2, t2, i2) {
    this.items = e2, this.query = t2, this.geometryType = i2.geometryType, this.hasM = i2.hasM, this.hasZ = i2.hasZ, this.fieldsIndex = i2.fieldsIndex, this.objectIdField = i2.objectIdField, this.spatialReference = i2.spatialReference, this.featureAdapter = i2.featureAdapter;
  }
  get size() {
    return this.items.length;
  }
  createQueryResponseForCount() {
    const e2 = new r$3(this.query, this.featureAdapter, this.fieldsIndex);
    if (!this.query.outStatistics)
      return e2.countDistinctValues(this.items);
    const { groupByFieldsForStatistics: t2, having: i2, outStatistics: s2 } = this.query, a2 = t2 == null ? void 0 : t2.length;
    if (!!!a2)
      return 1;
    const r2 = new Map(), n2 = new Map(), o2 = new Set();
    for (const l2 of s2) {
      const { statisticType: s3 } = l2, a3 = s3 !== "exceedslimit" ? l2.onStatisticField : void 0;
      if (!n2.has(a3)) {
        const i3 = [];
        for (const s4 of t2) {
          const t3 = this._getAttributeValues(e2, s4, r2);
          i3.push(t3);
        }
        n2.set(a3, this._calculateUniqueValues(i3, e2.returnDistinctValues));
      }
      const u2 = n2.get(a3);
      for (const t3 in u2) {
        const { data: s4, items: a4 } = u2[t3], r3 = s4.join(",");
        i2 && !e2.validateItems(a4, i2) || o2.add(r3);
      }
    }
    return o2.size;
  }
  async createQueryResponse() {
    let e2;
    if (this.query.outStatistics) {
      e2 = this.query.outStatistics.some((e3) => e3.statisticType === "exceedslimit") ? this._createExceedsLimitQueryResponse(this.query) : await this._createStatisticsQueryResponse(this.query);
    } else
      e2 = this._createFeatureQueryResponse(this.query);
    return this.query.returnQueryGeometry && (I$K(this.query.outSR) && !E$P(this.query.geometry.spatialReference, this.query.outSR) ? e2.queryGeometry = E$4(__spreadValues({ spatialReference: this.query.outSR }, g$4(this.query.geometry, this.query.geometry.spatialReference, this.query.outSR))) : e2.queryGeometry = E$4(__spreadValues({ spatialReference: this.query.outSR }, this.query.geometry))), e2;
  }
  createSnappingResponse(t2, i2) {
    const s2 = this.featureAdapter, a2 = N$1(this.hasZ, this.hasM), { point: r2 } = t2, n2 = typeof t2.distance == "number" ? t2.distance : t2.distance.x, o2 = typeof t2.distance == "number" ? t2.distance : t2.distance.y, l2 = { candidates: [] }, u2 = this.geometryType === "esriGeometryPolygon", c2 = r2.z != null, h2 = r2.m != null, f2 = this._getPointCreator(r2, c2, h2, this.spatialReference, i2), g2 = new D$2(null, 0), p2 = new D$2(null, 0), y2 = { x: 0, y: 0, z: 0 };
    for (const x2 of this.items) {
      const i3 = s2.getGeometry(x2);
      if (t$2r(i3))
        continue;
      const { coords: c3, lengths: h3 } = i3;
      if (g2.coords = c3, p2.coords = c3, t2.types & q$1.EDGE) {
        let e2 = 0;
        for (let t3 = 0; t3 < h3.length; t3++) {
          const i4 = h3[t3];
          for (let t4 = 0; t4 < i4; t4++, e2 += a2) {
            const u3 = g2;
            if (u3.coordsIndex = e2, t4 !== i4 - 1) {
              const t5 = p2;
              t5.coordsIndex = e2 + a2;
              const i5 = y2;
              E$3(y2, r2, u3, t5);
              const c4 = (r2.x - i5.x) / n2, m2 = (r2.y - i5.y) / o2, h4 = c4 * c4 + m2 * m2;
              h4 <= 1 && l2.candidates.push(e$1(s2.getObjectId(x2), f2(i5), Math.sqrt(h4), f2(u3), f2(t5)));
            }
          }
        }
      }
      if (t2.types & q$1.VERTEX) {
        const e2 = u2 ? c3.length - a2 : c3.length;
        for (let t3 = 0; t3 < e2; t3 += a2) {
          const e3 = g2;
          e3.coordsIndex = t3;
          const i4 = (r2.x - e3.x) / n2, a3 = (r2.y - e3.y) / o2, u3 = i4 * i4 + a3 * a3;
          u3 <= 1 && l2.candidates.push(t$1(s2.getObjectId(x2), f2(e3), Math.sqrt(u3)));
        }
      }
    }
    return l2.candidates.sort((e2, t3) => e2.distance - t3.distance), l2;
  }
  _getPointCreator(e2, i2, s2, a2, r2) {
    const n2 = r$1$(r2) && !E$P(a2, r2) ? (e3) => g$4(e3, a2, r2) : (e3) => e3, { hasZ: o2 } = this, u2 = 0, d2 = e2.m;
    return i2 && s2 ? o2 ? ({ x: e3, y: t2, z: i3 }) => n2({ x: e3, y: t2, z: i3, m: d2 }) : ({ x: e3, y: t2 }) => n2({ x: e3, y: t2, z: u2, m: d2 }) : i2 ? o2 ? ({ x: e3, y: t2, z: i3 }) => n2({ x: e3, y: t2, z: i3 }) : ({ x: e3, y: t2 }) => n2({ x: e3, y: t2, z: u2 }) : s2 ? ({ x: e3, y: t2 }) => n2({ x: e3, y: t2, m: d2 }) : ({ x: e3, y: t2 }) => n2({ x: e3, y: t2 });
  }
  async createSummaryStatisticsResponse(e2) {
    const { field: t2, valueExpression: i2, normalizationField: s2, normalizationType: a2, normalizationTotal: r2, minValue: n2, maxValue: o2, scale: l2 } = e2, u2 = this.fieldsIndex.isDateField(t2), c2 = await this._getDataValues({ field: t2, valueExpression: i2, normalizationField: s2, normalizationType: a2, normalizationTotal: r2, scale: l2 }), d2 = m$5({ normalizationType: a2, normalizationField: s2, minValue: n2, maxValue: o2 }), m2 = this.fieldsIndex.get(t2), h2 = { value: 0.5, fieldType: m2 == null ? void 0 : m2.type }, f2 = te$6(m2) ? f$4({ values: c2, supportsNullCount: d2, percentileParams: h2 }) : d$2({ values: c2, minValue: n2, maxValue: o2, useSampleStdDev: !a2, supportsNullCount: d2, percentileParams: h2 });
    return V$2(f2, u2);
  }
  async createUniqueValuesResponse(e2) {
    const { field: t2, valueExpression: i2, domains: s2, returnAllCodedValues: a2, scale: r2 } = e2, n2 = await this._getDataValues({ field: t2, field2: e2.field2, field3: e2.field3, fieldDelimiter: e2.fieldDelimiter, valueExpression: i2, scale: r2 }), o2 = T$2(n2);
    return F$3(o2, s2, a2, e2.fieldDelimiter);
  }
  async createClassBreaksResponse(e2) {
    const { field: t2, valueExpression: i2, normalizationField: s2, normalizationType: a2, normalizationTotal: r2, classificationMethod: n2, standardDeviationInterval: o2, minValue: l2, maxValue: u2, numClasses: c2, scale: d2 } = e2, m2 = await this._getDataValues({ field: t2, valueExpression: i2, normalizationField: s2, normalizationType: a2, normalizationTotal: r2, scale: d2 }), h2 = D$3(m2, { field: t2, normalizationField: s2, normalizationType: a2, normalizationTotal: r2, classificationMethod: n2, standardDeviationInterval: o2, minValue: l2, maxValue: u2, numClasses: c2 });
    return N$3(h2, n2);
  }
  async createHistogramResponse(e2) {
    const { field: t2, valueExpression: i2, normalizationField: s2, normalizationType: a2, normalizationTotal: r2, classificationMethod: n2, standardDeviationInterval: o2, minValue: l2, maxValue: u2, numBins: c2, scale: d2 } = e2, m2 = await this._getDataValues({ field: t2, valueExpression: i2, normalizationField: s2, normalizationType: a2, normalizationTotal: r2, scale: d2 });
    return S$2(m2, { field: t2, normalizationField: s2, normalizationType: a2, normalizationTotal: r2, classificationMethod: n2, standardDeviationInterval: o2, minValue: l2, maxValue: u2, numBins: c2 });
  }
  _sortFeatures(e2, t2, i2) {
    if (e2.length > 1 && t2 && t2.length)
      for (const s2 of t2.reverse()) {
        const t3 = s2.split(" "), a2 = t3[0], r2 = this.fieldsIndex.get(a2), n2 = t3[1] && t3[1].toLowerCase() === "desc", o2 = v$5(r2 == null ? void 0 : r2.type, n2);
        e2.sort((e3, t4) => {
          const s3 = i2(e3, a2, r2), n3 = i2(t4, a2, r2);
          return o2(s3, n3);
        });
      }
  }
  _createFeatureQueryResponse(e2) {
    const t2 = this.items, { geometryType: i2, hasM: s2, hasZ: a2, objectIdField: r2, spatialReference: o2 } = this, { outFields: l2, outSR: u2, quantizationParameters: c2, resultRecordCount: d2, resultOffset: m2, returnZ: f2, returnM: g2 } = e2, p2 = d2 != null && t2.length > (m2 || 0) + d2, y2 = l2 && (l2.includes("*") ? [...this.fieldsIndex.fields] : l2.map((e3) => this.fieldsIndex.get(e3)));
    return { exceededTransferLimit: p2, features: this._createFeatures(e2, t2), fields: y2, geometryType: i2, hasM: s2 && g2, hasZ: a2 && f2, objectIdFieldName: r2, spatialReference: E$4(u2 || o2), transform: c2 && s$v(c2) || null };
  }
  _createFeatures(e2, t2) {
    const i2 = new r$3(e2, this.featureAdapter, this.fieldsIndex), { hasM: s2, hasZ: a2 } = this, { orderByFields: r2, quantizationParameters: o2, returnGeometry: l2, returnCentroid: c2, maxAllowableOffset: d2, resultOffset: m2, resultRecordCount: h2, returnZ: p2 = false, returnM: y2 = false } = e2, x2 = a2 && p2, I2 = s2 && y2;
    let T2 = [], V2 = 0;
    const F2 = [...t2];
    if (this._sortFeatures(F2, r2, (e3, t3, s3) => i2.getFieldValue(e3, t3, s3)), l2 || c2) {
      const e3 = s$v(o2);
      if (l2 && !c2)
        for (const t3 of F2)
          T2[V2++] = { attributes: i2.getAttributes(t3), geometry: v$4(this.geometryType, this.hasZ, this.hasM, this.featureAdapter.getGeometry(t3), d2, e3, x2, I2) };
      else if (!l2 && c2)
        for (const t3 of F2)
          T2[V2++] = { attributes: i2.getAttributes(t3), centroid: b$2(this, this.featureAdapter.getCentroid(t3, this), e3) };
      else
        for (const t3 of F2)
          T2[V2++] = { attributes: i2.getAttributes(t3), centroid: b$2(this, this.featureAdapter.getCentroid(t3, this), e3), geometry: v$4(this.geometryType, this.hasZ, this.hasM, this.featureAdapter.getGeometry(t3), d2, e3, x2, I2) };
    } else
      for (const n2 of F2) {
        const e3 = i2.getAttributes(n2);
        e3 && (T2[V2++] = { attributes: e3 });
      }
    const z2 = m2 || 0;
    if (h2 != null) {
      const e3 = z2 + h2;
      T2 = T2.slice(z2, Math.min(T2.length, e3));
    }
    return T2;
  }
  _createExceedsLimitQueryResponse(e2) {
    let i2 = false, s2 = Number.POSITIVE_INFINITY, a2 = Number.POSITIVE_INFINITY, r2 = Number.POSITIVE_INFINITY;
    for (const t2 of e2.outStatistics)
      if (t2.statisticType === "exceedslimit") {
        s2 = t2.maxPointCount != null ? t2.maxPointCount : Number.POSITIVE_INFINITY, a2 = t2.maxRecordCount != null ? t2.maxRecordCount : Number.POSITIVE_INFINITY, r2 = t2.maxVertexCount != null ? t2.maxVertexCount : Number.POSITIVE_INFINITY;
        break;
      }
    if (this.geometryType === "esriGeometryPoint")
      i2 = this.items.length > s2;
    else if (this.items.length > a2)
      i2 = true;
    else {
      const e3 = N$1(this.hasZ, this.hasM), s3 = this.featureAdapter;
      i2 = this.items.reduce((e4, i3) => {
        const a3 = s3.getGeometry(i3);
        return e4 + (r$1$(a3) && a3.coords.length || 0);
      }, 0) / e3 > r2;
    }
    return { fields: [{ name: "exceedslimit", type: "esriFieldTypeInteger", alias: "exceedslimit", sqlType: "sqlTypeInteger", domain: null, defaultValue: null }], features: [{ attributes: { exceedslimit: Number(i2) } }] };
  }
  async _createStatisticsQueryResponse(e2) {
    const t2 = { attributes: {} }, i2 = [], s2 = new Map(), a2 = new Map(), r2 = new Map(), n2 = new Map(), o2 = new r$3(e2, this.featureAdapter, this.fieldsIndex), l2 = e2.outStatistics, { groupByFieldsForStatistics: c2, having: d2, orderByFields: m2 } = e2, h2 = c2 && c2.length, f2 = !!h2, g2 = f2 && c2[0], p2 = f2 && !this.fieldsIndex.get(g2);
    for (const u2 of l2) {
      const { outStatisticFieldName: e3, statisticType: l3 } = u2, m3 = u2, y3 = l3 !== "exceedslimit" ? u2.onStatisticField : void 0, x2 = l3 === "percentile_disc" || l3 === "percentile_cont", I2 = l3 === "EnvelopeAggregate" || l3 === "CentroidAggregate" || l3 === "ConvexHullAggregate", T2 = f2 && h2 === 1 && (y3 === g2 || p2) && l3 === "count";
      if (f2) {
        if (!r2.has(y3)) {
          const e4 = [];
          for (const t4 of c2) {
            const i3 = this._getAttributeValues(o2, t4, s2);
            e4.push(i3);
          }
          r2.set(y3, this._calculateUniqueValues(e4, !I2 && o2.returnDistinctValues));
        }
        const t3 = r2.get(y3);
        for (const i3 in t3) {
          const { count: a3, data: r3, items: l4, itemPositions: u3 } = t3[i3], h3 = r3.join(",");
          if (!d2 || o2.validateItems(l4, d2)) {
            const t4 = n2.get(h3) || { attributes: {} };
            if (I2) {
              t4.aggregateGeometries || (t4.aggregateGeometries = {});
              const { aggregateGeometries: e4, outStatisticFieldName: i5 } = await this._getAggregateGeometry(m3, l4);
              t4.aggregateGeometries[i5] = e4;
            } else {
              let i5 = null;
              if (T2)
                i5 = a3;
              else {
                const e4 = this._getAttributeValues(o2, y3, s2), t5 = u3.map((t6) => e4[t6]);
                i5 = x2 && "statisticParameters" in m3 ? this._getPercentileValue(m3, t5) : this._getStatisticValue(m3, t5, null, o2.returnDistinctValues);
              }
              t4.attributes[e3] = i5;
            }
            let i4 = 0;
            c2.forEach((e4, s3) => t4.attributes[this.fieldsIndex.get(e4) ? e4 : "EXPR_" + ++i4] = r3[s3]), n2.set(h3, t4);
          }
        }
      } else if (I2) {
        t2.aggregateGeometries || (t2.aggregateGeometries = {});
        const { aggregateGeometries: e4, outStatisticFieldName: i3 } = await this._getAggregateGeometry(m3, this.items);
        t2.aggregateGeometries[i3] = e4;
      } else {
        const i3 = this._getAttributeValues(o2, y3, s2);
        t2.attributes[e3] = x2 && "statisticParameters" in m3 ? this._getPercentileValue(m3, i3) : this._getStatisticValue(m3, i3, a2, o2.returnDistinctValues);
      }
      i2.push({ name: e3, alias: e3, type: "esriFieldTypeDouble" });
    }
    const y2 = f2 ? Array.from(n2.values()) : [t2];
    return this._sortFeatures(y2, m2, (e3, t3) => e3.attributes[t3]), { fields: i2, features: y2 };
  }
  async _getAggregateGeometry(e2, t2) {
    const n2 = await import("./geometryEngineJSON2.js"), { statisticType: o2, outStatisticFieldName: l2 } = e2, { featureAdapter: u2, spatialReference: c2, geometryType: d2, hasZ: m2, hasM: h2 } = this, g2 = t2.map((e3) => v$4(d2, m2, h2, u2.getGeometry(e3))), p2 = n2.convexHull(c2, g2, true)[0], y2 = { aggregateGeometries: null, outStatisticFieldName: null };
    if (o2 === "EnvelopeAggregate") {
      const e3 = p2 ? v$16(p2) : l$2u(n2.union(c2, g2));
      y2.aggregateGeometries = __spreadProps(__spreadValues({}, e3), { spatialReference: c2 }), y2.outStatisticFieldName = l2 || "extent";
    } else if (o2 === "CentroidAggregate") {
      const e3 = p2 ? r$1K(p2) : e$1T(l$2u(n2.union(c2, g2)));
      y2.aggregateGeometries = { x: e3[0], y: e3[1], spatialReference: c2 }, y2.outStatisticFieldName = l2 || "centroid";
    } else
      o2 === "ConvexHullAggregate" && (y2.aggregateGeometries = p2, y2.outStatisticFieldName = l2 || "convexHull");
    return y2;
  }
  _getStatisticValue(e2, t2, i2, s2) {
    const { onStatisticField: a2, statisticType: r2 } = e2;
    let n2 = null;
    n2 = (i2 == null ? void 0 : i2.has(a2)) ? i2.get(a2) : te$6(this.fieldsIndex.get(a2)) ? f$4({ values: t2, returnDistinct: s2 }) : d$2({ values: t2, minValue: null, maxValue: null, useSampleStdDev: true }), i2 && i2.set(a2, n2);
    return n2[r2 === "var" ? "variance" : r2];
  }
  _getPercentileValue(e2, t2) {
    const { onStatisticField: i2, statisticParameters: s2, statisticType: a2 } = e2, { value: r2, orderBy: n2 } = s2, o2 = this.fieldsIndex.get(i2);
    return p$5(t2, { value: r2, orderBy: n2, fieldType: o2 == null ? void 0 : o2.type, isDiscrete: a2 === "percentile_disc" });
  }
  _getAttributeValues(e2, t2, i2) {
    if (i2.has(t2))
      return i2.get(t2);
    const s2 = this.fieldsIndex.get(t2), a2 = this.items.map((i3) => e2.getFieldValue(i3, t2, s2));
    return i2.set(t2, a2), a2;
  }
  _getAttributeDataValues(e2, t2) {
    return this.items.map((i2) => e2.getDataValue(i2, { field: t2.field, field2: t2.field2, field3: t2.field3, fieldDelimiter: t2.fieldDelimiter, normalizationField: t2.normalizationField, normalizationType: t2.normalizationType, normalizationTotal: t2.normalizationTotal }));
  }
  async _getAttributeExpressionValues(e2, t2, i2) {
    const { arcadeUtils: s2 } = await i$2P(), a2 = s2.createFunction(t2), r2 = i2 && s2.getViewInfo(i2);
    return e2.getExpressionValues(this.items, a2, r2, s2);
  }
  _calculateUniqueValues(e2, t2) {
    const i2 = {}, s2 = this.items, a2 = s2.length;
    for (let r2 = 0; r2 < a2; r2++) {
      const a3 = s2[r2], n2 = [];
      for (const t3 of e2)
        n2.push(t3[r2]);
      const o2 = n2.join(",");
      t2 ? i2[o2] == null && (i2[o2] = { count: 1, data: n2, items: [a3], itemPositions: [r2] }) : i2[o2] == null ? i2[o2] = { count: 1, data: n2, items: [a3], itemPositions: [r2] } : (i2[o2].count++, i2[o2].items.push(a3), i2[o2].itemPositions.push(r2));
    }
    return i2;
  }
  async _getDataValues(e2) {
    const t2 = new r$3(this.query, this.featureAdapter, this.fieldsIndex), { valueExpression: i2, field: s2, normalizationField: a2, normalizationType: r2, normalizationTotal: n2, scale: o2 } = e2, l2 = i2 ? { viewingMode: "map", scale: o2, spatialReference: this.query.outSR || this.spatialReference } : null;
    return i2 ? this._getAttributeExpressionValues(t2, i2, l2) : this._getAttributeDataValues(t2, { field: s2, field2: e2.field2, field3: e2.field3, fieldDelimiter: e2.fieldDelimiter, normalizationField: a2, normalizationType: r2, normalizationTotal: n2 });
  }
}
function E$3(e2, t2, i2, s2) {
  const a2 = s2.x - i2.x, r2 = s2.y - i2.y, n2 = a2 * a2 + r2 * r2, o2 = (t2.x - i2.x) * a2 + (t2.y - i2.y) * r2, l2 = Math.min(1, Math.max(0, o2 / n2));
  e2.x = i2.x + a2 * l2, e2.y = i2.y + r2 * l2;
}
function N$1(e2, t2) {
  return e2 ? t2 ? 4 : 3 : t2 ? 3 : 2;
}
var q$1;
!function(e2) {
  e2[e2.NONE = 0] = "NONE", e2[e2.EDGE = 1] = "EDGE", e2[e2.VERTEX = 2] = "VERTEX";
}(q$1 || (q$1 = {}));
class D$2 {
  constructor(e2, t2) {
    this.coords = e2, this.coordsIndex = t2;
  }
  get x() {
    return this.coords[this.coordsIndex];
  }
  get y() {
    return this.coords[this.coordsIndex + 1];
  }
  get z() {
    return this.coords[this.coordsIndex + 2];
  }
}
function Y$1({ start: t2, end: o2, type: c2 }, u2, f2) {
  const i2 = [], a2 = u2, p2 = o$I(D$1, o2, t2), A2 = o$I(T$1, t2, a2), L2 = p$U(p2), h2 = 2 * j$e(p2, A2), d2 = h2 * h2 - 4 * L2 * (p$U(A2) - f2 * f2);
  if (d2 === 0) {
    const n2 = -h2 / (2 * L2);
    (c2 === q.PLANE || n2 >= 0) && i2.push(d$t(r$1B(0, 0, u2[2]), t2, p2, n2));
  } else if (d2 > 0) {
    const n2 = Math.sqrt(d2), s2 = (-h2 + n2) / (2 * L2);
    (c2 === q.PLANE || s2 >= 0) && i2.push(d$t(r$1B(0, 0, u2[2]), t2, p2, s2));
    const r2 = (-h2 - n2) / (2 * L2);
    (c2 === q.PLANE || r2 >= 0) && i2.push(d$t(r$1B(0, 0, u2[2]), t2, p2, r2));
  }
  return i2;
}
function j$3(t2, s2) {
  const e2 = t2.start, c2 = t2.end, p2 = o$I(D$1, c2, e2), A2 = o$1Q(T$1, -p2[1], p2[0], 0), L2 = s2.start, h2 = s2.end, d2 = J$p(B$1, h2, L2), m2 = P$A(d2, A2), y2 = o$1Q(C$1, e2[0], e2[1], 0), E2 = J$p(G$2, y2, L2), N2 = P$A(E2, A2);
  if (Math.abs(m2) < z$1)
    return [];
  const Y2 = q$q(J$2, L2, d2, N2 / m2);
  if (s2.type === b$a.RAY) {
    const t3 = J$p(K$1, Y2, L2);
    if (P$A(t3, d2) < -z$1)
      return [];
  }
  if (t2.type === q.HALF_PLANE) {
    const t3 = C$g(K$1, Y2, e2);
    if (j$e(t3, p2) < -z$1)
      return [];
  }
  return [t$1U(Y2)];
}
function l$2(t2, n2) {
  return x$1(g$3(O$2, n2[2], t2), n2);
}
function I$3(t2, n2) {
  const s2 = 0, r2 = b$1(g$3(O$2, s2, t2), g$3(Q$2, s2, n2)), e2 = [];
  for (const o2 of r2)
    e2.push(t$F(o2));
  return e2;
}
function v$3(t2, n2) {
  return F$1(t2, g$3(O$2, t2[2], n2));
}
function M$3(t2, n2) {
  return H(g$3(O$2, t2[2], n2), t2);
}
function k(t2, n2, s2) {
  const r2 = o$1Q(D$1, t2[0], t2[1], n2[2]), e2 = e$1G(T$1, r2, n2), o2 = s2 / s$1Y(e2);
  return q$q(n$2v(), n2, e2, o2);
}
function F$1(t2, { start: n2, end: s2, type: r2 }) {
  const e2 = J$p(D$1, t2, n2), o2 = J$p(T$1, s2, n2), c2 = P$A(e2, o2) / P$A(o2, o2);
  return q$q(n$2v(), n2, o2, r2 === b$a.RAY ? Math.max(c2, 0) : c2);
}
function H({ start: t2, end: n2, type: s2 }, r2) {
  const e2 = J$p(D$1, r2, t2), o2 = J$p(T$1, n2, t2);
  if (s2 === b$a.RAY && P$A(o2, e2) < -z$1)
    return x$U(t2, r2);
  const c2 = _$K(B$1, o2, e2);
  return Y$g(c2) / Y$g(o2);
}
function _$1({ start: o2, end: c2, type: u2 }, p2, A2) {
  const L2 = [];
  if (g$17(o2[2], p2[2], z$1) && g$17(c2[2], p2[2], z$1)) {
    const t2 = o2, f2 = p2, i2 = o$I(D$1, c2, t2), a2 = o$I(T$1, t2, f2), h2 = p$U(i2), d2 = 2 * j$e(i2, a2), m2 = d2 * d2 - 4 * h2 * (p$U(a2) - A2 * A2);
    if (m2 === 0) {
      const n2 = -d2 / (2 * h2);
      (u2 === b$a.LINE || n2 >= 0) && L2.push(d$t(r$1B(0, 0, p2[2]), t2, i2, n2));
    } else if (m2 > 0) {
      const n2 = Math.sqrt(m2), s2 = (-d2 + n2) / (2 * h2);
      (u2 === b$a.LINE || s2 >= 0) && L2.push(d$t(r$1B(0, 0, p2[2]), t2, i2, s2));
      const r2 = (-d2 - n2) / (2 * h2);
      (u2 === b$a.LINE || r2 >= 0) && L2.push(d$t(r$1B(0, 0, p2[2]), t2, i2, r2));
    }
  } else {
    const n2 = J$p(D$1, c2, o2);
    if (g$17(n2[2], 0, z$1))
      return L2;
    const s2 = (p2[2] - o2[2]) / n2[2], r2 = q$q(T$1, o2, n2, s2);
    if (u2 === b$a.RAY) {
      const t2 = J$p(B$1, r2, o2);
      if (P$A(n2, t2) < -z$1)
        return L2;
    }
    for (const t2 of U$1(p2, A2, r2))
      L2.push(t2);
  }
  return L2;
}
function b$1(n2, s2) {
  const r2 = n2.start, e2 = n2.end, o2 = s2.start, c2 = s2.end, u2 = J$p(D$1, e2, r2), p2 = J$p(T$1, c2, o2), A2 = J$p(B$1, o2, r2), L2 = _$K(C$1, u2, p2), d2 = P$A(A2, L2);
  if (!g$17(d2, 0, z$1))
    return [];
  const y2 = Z$h(L2);
  if (g$17(y2, 0, z$1))
    return [];
  const E2 = _$K(G$2, A2, p2), N2 = P$A(E2, L2) / y2, Y2 = q$q(J$2, r2, u2, N2);
  if (n2.type === b$a.RAY) {
    const t2 = J$p(K$1, Y2, r2);
    if (P$A(u2, t2) < -z$1)
      return [];
  }
  if (s2.type === b$a.RAY) {
    const t2 = J$p(K$1, Y2, o2);
    if (P$A(p2, t2) < -z$1)
      return [];
  }
  return [t$1U(Y2)];
}
function x$1({ start: t2, end: n2, type: s2 }, r2) {
  const e2 = J$p(D$1, r2, t2), o2 = J$p(T$1, n2, t2), c2 = _$K(B$1, o2, e2);
  if (Z$h(c2) / Z$h(o2) < z$1)
    switch (s2) {
      case b$a.LINE:
        return [t$1U(r2)];
      case b$a.RAY:
        return P$A(o2, e2) < -z$1 ? [] : [t$1U(r2)];
    }
  return [];
}
function U$1(n2, s2, r2) {
  return g$17(n2[2], r2[2], z$1) && g$17(p$37(r2, n2), s2 * s2, z$1) ? [t$1U(r2)] : [];
}
function g$3(t2, n2, { start: s2, end: r2, type: e2 }) {
  return o$1Q(t2.start, s2[0], s2[1], n2), o$1Q(t2.end, r2[0], r2[1], n2), t2.type = w$2[e2], t2;
}
var q;
!function(t2) {
  t2[t2.PLANE = 0] = "PLANE", t2[t2.HALF_PLANE = 1] = "HALF_PLANE";
}(q || (q = {}));
const w$2 = { [q.PLANE]: b$a.LINE, [q.HALF_PLANE]: b$a.RAY }, z$1 = 1e-6, D$1 = n$2v(), T$1 = n$2v(), B$1 = n$2v(), C$1 = n$2v(), G$2 = n$2v(), J$2 = n$2v(), K$1 = n$2v(), O$2 = { start: n$2v(), end: n$2v(), type: b$a.LINE }, Q$2 = { start: n$2v(), end: n$2v(), type: b$a.LINE };
class x {
  constructor(t2) {
    this.coordinateHelper = t2;
  }
  intersect(t2) {
    return w$1(this, t2);
  }
}
class j$2 extends x {
  constructor(t2, e2) {
    super(t2), this.point = e2, this.pointXYZ = t2.toXYZ(e2);
  }
  equals(t2) {
    return _(t2) && i$z(this.point, t2.point);
  }
  check(t2) {
    const e2 = this.coordinateHelper.toXYZ(t2, D);
    return p$37(e2, this.pointXYZ) < p$z.pointThreshold;
  }
  closestTo() {
    return this.coordinateHelper.clone(this.point);
  }
}
class O$1 extends x {
  constructor(t2, e2, s2, n2) {
    super(t2), this.start = e2, this.end = s2, this.type = n2, this.startXYZ = t2.toXYZ(e2), this.endXYZ = t2.toXYZ(s2), this.lineLike = { start: this.startXYZ, end: this.endXYZ, type: this.type };
  }
  equals(t2) {
    return S$1(t2) && this.type === t2.type && i$z(this.start, t2.start) && i$z(this.end, t2.end);
  }
  check(t2) {
    const e2 = this.coordinateHelper.toXYZ(t2, D);
    return H(this.lineLike, e2) < p$z.pointOnLineThreshold;
  }
  closestTo(t2) {
    const e2 = this.coordinateHelper, s2 = e2.toXYZ(t2, D), n2 = F$1(s2, this.lineLike);
    return e2.fromXYZ(n2);
  }
}
class A extends O$1 {
  constructor(t2, e2, s2) {
    super(t2, e2, s2, b$a.LINE);
  }
}
class E$2 extends x {
  constructor(t2, e2, s2, n2) {
    super(t2), this.intersection = e2, this.first = s2, this.second = n2;
  }
  equals(t2) {
    return t2 instanceof E$2 && this.first.equals(t2.first) && this.second.equals(t2.second);
  }
  check() {
    return false;
  }
  closestTo() {
    return this.coordinateHelper.clone(this.intersection);
  }
}
class I$2 extends x {
  constructor(t2, e2, s2, n2) {
    super(t2), this.basePoint = e2, this.first = s2, this.second = n2;
  }
  equals(t2) {
    return t2 instanceof I$2 && this.first.equals(t2.first) && this.second.equals(t2.second);
  }
  check() {
    return false;
  }
  closestTo(t2) {
    const e2 = this.basePoint, s2 = this.coordinateHelper, n2 = s2.toXYZ(t2, D), r2 = o$1Q(J$1, e2[0], e2[1], n2[2]);
    return s2.fromXYZ(r2);
  }
}
class P extends x {
  constructor(t2, e2, s2) {
    super(t2), this.center = e2, this.radius = s2, this.centerXYZ = t2.toXYZ(e2);
  }
  equals(t2) {
    return z(t2) && this.center[0] === t2.center[0] && this.center[1] === t2.center[1] && this.radius === t2.radius;
  }
  check() {
    return false;
  }
  closestTo(t2) {
    const e2 = this.coordinateHelper, s2 = e2.toXYZ(t2, D), n2 = k(s2, this.centerXYZ, this.radius);
    return n2[2] = e2.getZ(t2, this.centerXYZ[2]), e2.fromXYZ(n2);
  }
}
class b extends x {
  constructor(t2, e2, s2, n2) {
    super(t2), this.start = e2, this.end = s2, this.type = n2, this.planeLike = { start: e2, end: s2, type: n2 };
  }
  equals(t2) {
    return B(t2) && this.type === t2.type && i$z(this.start, t2.start) && i$z(this.end, t2.end);
  }
  check(t2) {
    const e2 = this.coordinateHelper.toXYZ(t2, D);
    return M$3(e2, this.planeLike) < p$z.pointOnLineThreshold;
  }
  closestTo(t2) {
    const e2 = this.coordinateHelper, s2 = e2.toXYZ(t2, D), n2 = v$3(s2, this.planeLike);
    return e2.fromXYZ(n2);
  }
  closestEndTo(t2) {
    const { start: n2, end: r2 } = this;
    return Math.sign(j$e(o$I(K, r2, n2), o$I(Q$1, t2, n2))) > 0 ? r2 : n2;
  }
}
class v$2 extends b {
  constructor(t2, e2, s2) {
    super(t2, e2, s2, q.HALF_PLANE);
  }
}
class G$1 extends b {
  constructor(t2, e2, s2) {
    super(t2, e2, s2, q.PLANE);
  }
}
class N extends x {
  constructor(t2, e2, s2, n2) {
    super(t2), this.start = e2, this.end = s2, this.getZ = n2, this.planeLike = { start: e2, end: s2, type: q.HALF_PLANE };
  }
  equals(t2) {
    return C(t2) && i$z(this.start, t2.start) && i$z(this.end, t2.end) && this.getZ === t2.getZ;
  }
  check(t2) {
    const e2 = this.coordinateHelper.toXYZ(t2, D), s2 = U(this, e2);
    return p$37(e2, s2) < p$z.pointThreshold;
  }
  closestTo(t2) {
    const e2 = this.coordinateHelper, s2 = U(this, e2.toXYZ(t2, D));
    return e2.fromXYZ(s2);
  }
  addIfOnTheGround(e2, s2) {
    for (const n2 of s2) {
      const s3 = this.getZ(n2[0], n2[1], n2[2]);
      r$1$(s3) && Math.abs(n2[2] - s3) < z$1 && (n2[2] = s3, e2.push(n2));
    }
  }
}
function U(e2, s2) {
  const n2 = v$3(s2, e2.planeLike), r2 = e2.getZ(s2[0], s2[1], s2[2]);
  return r$1$(r2) && (n2[2] = r2), n2;
}
function w$1(t2, e2) {
  let s2 = [];
  if (_(t2)) {
    const { pointXYZ: n2 } = t2;
    S$1(e2) ? s2 = x$1(e2.lineLike, n2) : z(e2) ? s2 = U$1(e2.centerXYZ, e2.radius, n2) : B(e2) ? s2 = l$2(e2.planeLike, n2) : C(e2) && (s2 = F(e2, t2));
  } else if (S$1(t2)) {
    const { lineLike: n2 } = t2;
    _(e2) ? s2 = x$1(n2, e2.pointXYZ) : S$1(e2) ? s2 = b$1(n2, e2.lineLike) : z(e2) ? s2 = _$1(n2, e2.centerXYZ, e2.radius) : B(e2) ? s2 = j$3(e2.planeLike, n2) : C(e2) && (s2 = F(e2, t2));
  } else if (z(t2)) {
    const { centerXYZ: n2, radius: r2 } = t2;
    S$1(e2) ? s2 = _$1(e2.lineLike, n2, r2) : _(e2) ? s2 = U$1(n2, r2, e2.pointXYZ) : B(e2) ? s2 = Y$1(e2.planeLike, n2, r2) : C(e2) && (s2 = F(e2, t2));
  } else if (B(t2)) {
    const { planeLike: n2, coordinateHelper: r2 } = t2;
    if (B(e2))
      return I$3(n2, e2.planeLike).map((s3) => new I$2(r2, r2.fromXYZ(s3), t2, e2));
    _(e2) ? s2 = l$2(n2, e2.pointXYZ) : S$1(e2) ? s2 = j$3(n2, e2.lineLike) : z(e2) ? s2 = Y$1(n2, e2.centerXYZ, e2.radius) : C(e2) && (s2 = F(e2, t2));
  } else
    C(t2) && (s2 = F(t2, e2));
  return M$2(s2, t2, e2);
}
function F(e2, s2) {
  const { planeLike: n2, getZ: r2 } = e2, i2 = [];
  if (_(s2))
    e2.addIfOnTheGround(i2, l$2(n2, s2.pointXYZ));
  else if (S$1(s2))
    e2.addIfOnTheGround(i2, j$3(n2, s2.lineLike));
  else if (z(s2))
    e2.addIfOnTheGround(i2, Y$1(n2, s2.centerXYZ, s2.radius));
  else if (B(s2) || C(s2))
    for (const [c2, a2] of I$3(n2, s2.planeLike)) {
      const e3 = r2(c2, a2, 0);
      r$1$(e3) && i2.push(r$1B(c2, a2, e3));
    }
  return i2;
}
function M$2(t2, e2, s2) {
  const n2 = e2.coordinateHelper;
  return t2.map((t3) => new E$2(n2, n2.fromXYZ(t3), e2, s2));
}
function _(t2) {
  return t2 instanceof j$2;
}
function S$1(t2) {
  return t2 instanceof O$1;
}
function z(t2) {
  return t2 instanceof P;
}
function B(t2) {
  return t2 instanceof b;
}
function C(t2) {
  return t2 instanceof N;
}
const D = n$2v(), J$1 = n$2v(), K = n$S(), Q$1 = n$S();
class t {
  constructor(t2, i2, o2, s2, n2) {
    this.coordinateHelper = t2, this.targetPoint = i2, this.constraint = o2, this.elevationInfo = s2, this.domain = n2;
  }
}
class n$3 extends t {
  constructor({ coordinateHelper: o2, targetPoint: n2, objectId: e2, constraint: r2, elevationInfo: i2 }) {
    super(o2, n2, r2, i2, E$g.FEATURE), this.objectId = e2;
  }
}
class e extends n$3 {
  constructor(n2) {
    super(__spreadProps(__spreadValues({}, n2), { constraint: new A(n2.coordinateHelper, n2.edgeStart, n2.edgeEnd) }));
  }
  get hints() {
    return [new s$r(l$r.REFERENCE, this.constraint.start, this.constraint.end, this.elevationInfo, this.domain)];
  }
}
class n$2 extends t {
  constructor({ coordinateHelper: e2, targetPoint: i2, constraint: r2, previousVertex: o2, otherVertex: n2, otherVertexType: s2, objectId: h2, elevationInfo: p2 }) {
    super(e2, i2, r2, p2, E$g.SELF), this.previousVertex = o2, this.otherVertex = n2, this.otherVertexType = s2, this.objectId = h2;
  }
  get hints() {
    const t2 = this.previousVertex, i2 = this.otherVertexType === s$2.CENTER ? this.otherVertex : this.targetPoint, n2 = this.otherVertexType === s$2.CENTER ? this.targetPoint : this.otherVertex, h2 = this.elevationInfo;
    return [new s$r(l$r.TARGET, i2, n2, h2, this.domain), new s$r(l$r.REFERENCE, t2, i2, h2, this.domain), new s$p(this.previousVertex, i2, n2, h2, this.domain)];
  }
}
var s$2;
!function(t2) {
  t2[t2.NEXT = 0] = "NEXT", t2[t2.CENTER = 1] = "CENTER";
}(s$2 || (s$2 = {}));
function f$2(e2, r2, o2, n2, t2 = n$2v()) {
  const s2 = r2.toXYZ(e2);
  return s2[2] = h$n(n2, s2, r2.spatialReference, o2) || 0, n2.renderCoordsHelper.toRenderCoords(s2, r2.spatialReference, t2), t2;
}
function d$1(e2, r2, o2, n2, t2 = n$2v()) {
  const i2 = r$1z(j$1, e2);
  return i2[2] = h$n(n2, i2, r2, o2) || 0, n2.renderCoordsHelper.toRenderCoords(i2, r2, t2), t2;
}
function l$1(e2, r2, o2, n2) {
  return u$1(r2.toXYZ(e2), r2.spatialReference, o2, n2);
}
function u$1(r2, o2, n2, t2) {
  return t2.type === "2d" ? (R.x = r2[0], R.y = r2[1], R.spatialReference = o2, t2.toScreen(R)) : (d$1(r2, o2, n2, t2, j$1), t2.state.camera.projectToScreen(j$1, v$1), c$2K(v$1[0], v$1[1]));
}
function m$3(e2, r2, o2, n2, t2, s2, c2) {
  if (n2.mode === "absolute-height")
    return f$2(e2, o2, n2, t2, s2), void f$2(r2, o2, n2, t2, c2);
  const i2 = o2.toXYZ(e2), p2 = o2.toXYZ(r2), d2 = h$n(t2, i2, o2.spatialReference, n2), l2 = h$n(t2, p2, o2.spatialReference, n2), u2 = (d2 == null ? l2 : l2 == null ? d2 : Math.min(d2, l2)) || 0;
  i2[2] = u2, p2[2] = u2, t2.renderCoordsHelper.toRenderCoords(i2, o2.spatialReference, s2), t2.renderCoordsHelper.toRenderCoords(p2, o2.spatialReference, c2);
}
const R = new w$_(), j$1 = n$2v(), v$1 = i$2w();
let M$1 = class extends d$18 {
  constructor(e2) {
    super(e2), this.options = null, this._domain = E$g.FEATURE, this._sourceModules = { featureService: { module: null, loader: null }, featureCollection: { module: null, loader: null }, graphics: { module: null, loader: null }, notes: { module: null, loader: null }, scene: { module: null, loader: null } };
  }
  get updating() {
    return n$2V(this.snappingSources, ({ snappingSource: e2 }) => e2.updating) || this.updatingHandles.updating;
  }
  get snappingSources() {
    const e2 = this._get("snappingSources") || new Map(), t2 = new Map();
    if (r$1$(this.options) && r$1$(this.options.featureSources))
      for (const r2 of this.options.featureSources.items) {
        const o2 = r2.layer.uid, s2 = e2.get(o2);
        if (s2) {
          e2.delete(o2), t2.set(o2, s2);
          continue;
        }
        if (!r2.layer.loaded) {
          this.updatingHandles.addPromise(r2.layer.load());
          continue;
        }
        const a2 = this._createSourceInfo(r2);
        r$1$(a2) && t2.set(o2, a2);
      }
    for (const [, r2] of e2)
      r2.destroy();
    return t2;
  }
  initialize() {
    this.updatingHandles.add(() => this.snappingSources, () => this.notifyChange("updating"), U$r), r$1$(this.view) && this.handles.add([this.view.on("layerview-create", (e2) => this._updateLayerView(e2.layer, e2.layerView)), this.view.on("layerview-destroy", (e2) => this._updateLayerView(e2.layer, null))]);
  }
  _updateLayerView(e2, t2) {
    for (const [, r2] of this.snappingSources)
      r2.snappingSource.layerSource.layer === e2 && (r2.layerView = t2);
  }
  destroy() {
    this._set("options", null);
    for (const [, e2] of this.snappingSources)
      e2.destroy();
  }
  async fetchCandidates(e2, t2, r2, o2) {
    if (!(t2 & this._domain) || t$2r(this.options) || !this.options.effectiveFeatureEnabled)
      return [];
    const a2 = [], u2 = this._computeScreeenSizeDistanceParameters(e2, r2), l2 = { distance: u2, point: e2, coordinateHelper: r2.coordinateHelper, types: this._types };
    for (const [, { snappingSource: s2, layerView: i2 }] of this.snappingSources)
      !s2.layerSource.enabled || r$1$(i2) && i2.suspended || a2.push(s2.fetchCandidates(l2, o2).then((e3) => e3.filter((e4) => !this._candidateIsExcluded(s2, e4, r2.excludeFeature))));
    const p2 = (await L$z(a2)).flat();
    return this._addRightAngleCandidates(p2, e2, u2, r2), f$1V(o2), a$m(e2, p2, r2.coordinateHelper), p2;
  }
  _addRightAngleCandidates(e2, t2, r2, o2) {
    var _a2, _b2, _c2, _d2, _e3, _f2, _g2, _h2;
    const s2 = r$1$(o2.vertexHandle) ? (_b2 = (_a2 = o2.vertexHandle.rightEdge) == null ? void 0 : _a2.rightVertex) == null ? void 0 : _b2.pos : r$1$(o2.editGeometryOperations) && o2.editGeometryOperations.data.type === "polygon" ? (_d2 = e$2e((_c2 = o2.editGeometryOperations.data.components[0]) == null ? void 0 : _c2.getFirstVertex())) == null ? void 0 : _d2.pos : null, i2 = r$1$(o2.vertexHandle) ? (_f2 = (_e3 = o2.vertexHandle.leftEdge) == null ? void 0 : _e3.leftVertex) == null ? void 0 : _f2.pos : r$1$(o2.editGeometryOperations) ? (_h2 = e$2e((_g2 = o2.editGeometryOperations.data.components[0]) == null ? void 0 : _g2.getLastVertex())) == null ? void 0 : _h2.pos : null, { view: c2 } = this, u2 = R$a(s2, c2, o2), l2 = R$a(i2, c2, o2), p2 = e2.length;
    for (let n2 = 0; n2 < p2; n2++)
      this._addRightAngleCandidate(e2[n2], l2, t2, r2, o2, e2), this._addRightAngleCandidate(e2[n2], u2, t2, r2, o2, e2);
  }
  _addRightAngleCandidate(e$110, t2, r2, o2, n2, a2) {
    const i2 = e$110 instanceof e, c2 = i2 && k$f(e$110.constraint.start, e$110.constraint.end);
    if (t$2r(t2) || !i2 || c2)
      return;
    const u2 = e$110.constraint.closestTo(t2), l2 = (u2[0] - r2[0]) / o2.x, p2 = (u2[1] - r2[1]) / o2.y;
    if (l2 * l2 + p2 * p2 <= 1) {
      const r3 = n2.coordinateHelper, o3 = new n$2({ coordinateHelper: r3, targetPoint: u2, otherVertex: t2, otherVertexType: s$2.NEXT, previousVertex: e$110.constraint.start, constraint: new v$2(r3, t2, u2), objectId: e$110.objectId, elevationInfo: e$110.elevationInfo });
      a2.push(o3);
    }
  }
  _computeScreeenSizeDistanceParameters(e2, t2) {
    let r2 = r$1$(this.options) ? this.options.distance * (t2.pointer === "touch" ? this.options.touchSensitivityMultiplier : 1) : 0;
    return t$2r(this.view) ? { x: r2, y: r2, z: r2, distance: r2 } : this.view.type === "2d" ? (r2 *= this.view.resolution, { x: r2, y: r2, z: r2, distance: r2 }) : this._computeScreenSizeDistanceParameters3D(e2, r2, this.view, t2);
  }
  _computeScreenSizeDistanceParameters3D(e2, t2, r2, o2) {
    const { coordinateHelper: n2, elevationInfo: s2 } = o2, { spatialReference: a2 } = n2, i2 = n2.hasZ() ? E$f : s2, c2 = n2.toXYZ(e2, E$1);
    c2[2] = h$n(r2, c2, a2, i2, E$f), r2.renderCoordsHelper.toRenderCoords(c2, a2, G);
    const u2 = r2.state.camera.computeScreenPixelSizeAt(G), l2 = u2 * r2.renderCoordsHelper.unitInMeters / r2.mapCoordsHelper.unitInMeters, p2 = t2 * l2, d2 = u$1(c2, a2, E$f, r2), h2 = V$1(d2, c2, l2, 0, 0, r2, o2), g2 = V$1(d2, c2, 0, l2, 0, r2, o2), y2 = V$1(d2, c2, 0, 0, l2, r2, o2);
    return { x: h2 === 0 ? 0 : p2 / h2, y: g2 === 0 ? 0 : p2 / g2, z: y2 === 0 ? 0 : p2 / y2, distance: u2 * t2 };
  }
  get _types() {
    return q$1.EDGE | q$1.VERTEX;
  }
  _candidateIsExcluded(e2, t2, r2) {
    if (t$2r(r2))
      return false;
    const o2 = this._getCandidateObjectId(t2);
    if (t$2r(o2))
      return false;
    const n2 = e2.layerSource.layer;
    return n2.type === "graphics" ? r2.uid === o2 : r2.sourceLayer === n2 && (!(!r2.attributes || !("objectIdField" in n2)) && r2.attributes[n2.objectIdField] === o2);
  }
  _getCandidateObjectId(e2) {
    return e2 instanceof n$3 ? e2.objectId : null;
  }
  _createSourceInfo(e2) {
    const t2 = this._createFeatureSnappingSourceType(e2);
    if (t$2r(t2))
      return null;
    if ("loading" in t2)
      return this.updatingHandles.addPromise(t2.loading.then(() => {
        this.destroyed || this.notifyChange("snappingSources");
      })), null;
    const r2 = r$1$(this.view) ? this.view.allLayerViews.find((t3) => t3.layer === e2.layer) : null;
    return new I$1(t2.source, r2);
  }
  _createFeatureSnappingSourceType(e2) {
    switch (e2.layer.type) {
      case "feature":
      case "geojson":
      case "csv":
      case "oriented-imagery":
      case "subtype-group":
      case "wfs":
        return this._createFeatureSnappingSourceFeatureLayer(e2);
      case "graphics":
        return this._createFeatureSnappingSourceGraphicsLayer(e2);
      case "map-notes":
        return this._createFeatureSnappingSourceMapNotesLayer(e2);
      case "scene":
      case "building-scene":
        return this._createFeatureSnappingSourceSceneLayer(e2);
    }
    return null;
  }
  _createFeatureSnappingSourceSceneLayer(e2) {
    const { view: t2 } = this;
    if (t$2r(t2) || t2.type !== "3d")
      return null;
    const r2 = this._getSourceModule("scene");
    return r$1$(r2.module) ? { source: new r2.module.SceneLayerSnappingSource({ layerSource: e2, view: t2 }) } : { loading: r2.loader };
  }
  _createFeatureSnappingSourceFeatureLayer(e2) {
    switch (e2.layer.source.type) {
      case "feature-layer":
      case "oriented-imagery": {
        const t2 = this._getSourceModule("featureService");
        return r$1$(t2.module) ? { source: new t2.module.FeatureServiceSnappingSource({ spatialReference: this.spatialReference, view: this.view, layerSource: e2 }) } : { loading: t2.loader };
      }
      case "memory":
      case "csv":
      case "geojson":
      case "wfs": {
        if (e2.layer.geometryType === "mesh")
          return null;
        const t2 = this._getSourceModule("featureCollection");
        return r$1$(t2.module) ? { source: new t2.module.FeatureCollectionSnappingSource({ layerSource: e2, view: this.view }) } : { loading: t2.loader };
      }
    }
    return null;
  }
  _createFeatureSnappingSourceGraphicsLayer(e2) {
    const t2 = this._getSourceModule("graphics");
    return r$1$(t2.module) ? { source: new t2.module.GraphicsSnappingSource({ getGraphicsLayers: () => [e2.layer], spatialReference: this.spatialReference, view: this.view, layerSource: e2 }) } : { loading: t2.loader };
  }
  _createFeatureSnappingSourceMapNotesLayer(e2) {
    const t2 = this._getSourceModule("notes");
    return r$1$(t2.module) ? { source: new t2.module.GraphicsSnappingSource({ getGraphicsLayers: () => r$1$(e2.layer.sublayers) ? e2.layer.sublayers.toArray() : [], spatialReference: this.spatialReference, view: this.view, layerSource: e2 }) } : { loading: t2.loader };
  }
  _getSourceModule(e2) {
    const t2 = this._sourceModules[e2];
    if (t$2r(t2.loader)) {
      const r2 = this._loadSourceModule(e2).then((e3) => {
        t2.module = e3;
      });
      return t2.loader = r2, { module: t2.module, loader: r2 };
    }
    return { module: t2.module, loader: t2.loader };
  }
  _loadSourceModule(e2) {
    const t2 = this.updatingHandles;
    switch (e2) {
      case "featureService":
        return t2.addPromise(import("./FeatureServiceSnappingSource.js"));
      case "featureCollection":
        return t2.addPromise(import("./FeatureCollectionSnappingSource.js"));
      case "graphics":
      case "notes":
        return t2.addPromise(import("./GraphicsSnappingSource.js"));
      case "scene":
        return t2.addPromise(import("./SceneLayerSnappingSource.js"));
    }
    return null;
  }
};
e$2g([y$1I({ constructOnly: true })], M$1.prototype, "spatialReference", void 0), e$2g([y$1I({ constructOnly: true })], M$1.prototype, "view", void 0), e$2g([y$1I()], M$1.prototype, "options", void 0), e$2g([y$1I({ readOnly: true })], M$1.prototype, "updating", null), e$2g([y$1I({ readOnly: true })], M$1.prototype, "snappingSources", null), M$1 = e$2g([n$2P("esri.views.interactive.snapping.FeatureSnappingEngine")], M$1);
class I$1 {
  constructor(e2, t2) {
    this.snappingSource = e2, this.layerView = t2, this.handles = new t$2g();
    const o2 = this.snappingSource.layerSource.layer;
    if ("refresh" in o2) {
      const t3 = o2;
      this.handles.add(t3.on("refresh", () => e2.refresh()));
    }
    this.handles.add([l$1P(() => e2.updating, (t3) => e2.layerSource.updating = t3, w$Q), l$1P(() => e2.availability, (t3) => e2.layerSource.availability = t3, w$Q)]);
  }
  destroy() {
    this.snappingSource.destroy(), this.handles.destroy();
  }
}
function V$1(e2, t2, r2, o2, n2, s2, { coordinateHelper: a2 }) {
  const i2 = r$1z(O, t2);
  i2[0] += r2, i2[1] += o2, i2[2] += n2;
  const c2 = u$1(i2, a2.spatialReference, E$f, s2);
  return E$e(c2, e2);
}
const E$1 = n$2v(), G = n$2v(), O = n$2v();
class i$2 {
  constructor(e2, r2) {
    this.view = e2, this.options = r2, this.squaredShortLineThreshold = p$z.shortLineThreshold * p$z.shortLineThreshold;
  }
  snap(t2, r2) {
    return r$1$(r2.vertexHandle) ? r2.vertexHandle.type !== "vertex" ? [] : this.snapExistingVertex(t2, r2) : this.snapNewVertex(t2, r2);
  }
  edgeExceedsShortLineThreshold(e2, t2) {
    return this.exceedsShortLineThreshold(e2.leftVertex.pos, e2.rightVertex.pos, t2);
  }
  exceedsShortLineThreshold(e2, t2, { elevationInfo: i2, editGeometryOperations: o2 }) {
    const h2 = o2.data.coordinateHelper;
    return this.squaredShortLineThreshold === 0 || u$j(l$1(t2, h2, i2, this.view), l$1(e2, h2, i2, this.view)) > this.squaredShortLineThreshold;
  }
  squaredProximityThreshold(e2) {
    return e2 === "touch" ? this._squaredTouchProximityThreshold : this._squaredMouseProximityTreshold;
  }
  get _squaredMouseProximityTreshold() {
    return this.options.distance * this.options.distance;
  }
  get _squaredTouchProximityThreshold() {
    const { distance: e2, touchSensitivityMultiplier: t2 } = this.options, r2 = e2 * t2;
    return r2 * r2;
  }
}
class r$1 extends t {
  constructor({ coordinateHelper: e2, lineStart: r2, lineEnd: s2, targetPoint: a2, elevationInfo: p2 }) {
    super(e2, a2, new G$1(e2, r2, s2), p2, E$g.SELF), this._referenceLineHint = new s$r(l$r.REFERENCE_EXTENSION, r2, s2, p2, this.domain);
  }
  get hints() {
    return [this._referenceLineHint, new s$r(l$r.TARGET, this._lineEndClosestToTarget(), this.targetPoint, this.elevationInfo, this.domain)];
  }
  _lineEndClosestToTarget() {
    return this.constraint.closestEndTo(this.targetPoint);
  }
}
class a extends i$2 {
  snapNewVertex(e2, t2) {
    const r2 = t2.editGeometryOperations.data.components[0], i2 = r2.edges.length, n2 = [];
    if (i2 < 1)
      return n2;
    const d2 = t2.coordinateHelper, h2 = l$1(e2, d2, E$f, this.view), { view: l2 } = this, a2 = r2.edges[i2 - 1];
    let g2 = a2;
    do {
      if (this.edgeExceedsShortLineThreshold(g2, t2)) {
        const o2 = N$a(g2, l2, t2);
        this._processCandidateProposal(o2.left, o2.right, e2, h2, t2, n2);
      }
      g2 = g2.leftVertex.leftEdge;
    } while (g2 && g2 !== a2);
    return n2;
  }
  snapExistingVertex(t2, r2) {
    const n2 = [], d2 = e$2e(r2.vertexHandle), h2 = d2.component;
    if (h2.edges.length < 2)
      return n2;
    const { view: l2 } = this, { coordinateHelper: a2 } = r2, g2 = l$1(t2, a2, E$f, l2), c2 = d2.leftEdge, m2 = d2.rightEdge;
    c2 && m2 && this.edgeExceedsShortLineThreshold(c2, r2) && this.edgeExceedsShortLineThreshold(m2, r2) && this._processCandidateProposal(R$a(c2.leftVertex.pos, l2, r2), R$a(m2.rightVertex.pos, l2, r2), t2, g2, r2, n2);
    const f2 = h2.edges[0];
    let x2 = f2;
    do {
      if (x2 !== d2.leftEdge && x2 !== d2.rightEdge && this.edgeExceedsShortLineThreshold(x2, r2)) {
        const e2 = N$a(x2, l2, r2);
        this._processCandidateProposal(e2.left, e2.right, t2, g2, r2, n2);
      }
      x2 = x2.rightVertex.rightEdge;
    } while (x2 && x2 !== f2);
    return n2;
  }
  _processCandidateProposal(e2, t2, r2, s2, i2, l2) {
    const { coordinateHelper: a2, pointer: x2 } = i2;
    a2.toXYZ(e2, g$2), a2.toXYZ(t2, c$1);
    const E2 = a2.toXYZ(r2, f$1), u2 = F$1(E2, m$2), j2 = a2.fromXYZ(u2);
    u$j(s2, l$1(j2, a2, E$f, this.view)) < this.squaredProximityThreshold(x2) && l2.push(new r$1({ coordinateHelper: a2, lineStart: e2, lineEnd: t2, targetPoint: j2, elevationInfo: a2.hasZ() ? E$f : null }));
  }
}
const g$2 = n$2v(), c$1 = n$2v(), m$2 = { start: g$2, end: c$1, type: b$a.LINE }, f$1 = n$2v();
class h$2 extends t {
  constructor({ coordinateHelper: i2, referenceLine: s2, lineStart: a2, targetPoint: f2, elevationInfo: o2 }) {
    const h2 = i2.toXYZ(a2, d), c2 = i2.toXYZ(s2.left, g$1), m2 = i2.toXYZ(s2.right, p$3);
    e$1G(h2, u$1S(h2, h2, m2), c2), super(i2, f2, new G$1(i2, a2, i2.fromXYZ(h2)), o2, E$g.SELF), this._referenceLines = [{ edge: s2, fadeLeft: true, fadeRight: true }];
  }
  get hints() {
    const e2 = this.elevationInfo;
    return [new s$r(l$r.TARGET, this.constraint.start, this.targetPoint, e2, this.domain), new r$q(this.constraint.start, this.targetPoint, e2, this.domain), ...this._referenceLines.map((t2) => new s$r(l$r.REFERENCE, t2.edge.left, t2.edge.right, e2, this.domain, t2.fadeLeft, t2.fadeRight))];
  }
  addReferenceLine(e2) {
    const t2 = { edge: e2, fadeLeft: true, fadeRight: true }, { coordinateHelper: i2 } = this;
    this._referenceLines.forEach((n2) => {
      i2.equals(e2.right, n2.edge.left) && (n2.fadeLeft = false, t2.fadeRight = false), i2.equals(e2.right, n2.edge.right) && (n2.fadeRight = false, t2.fadeRight = false), i2.equals(e2.left, n2.edge.right) && (n2.fadeRight = false, t2.fadeLeft = false), i2.equals(e2.left, n2.edge.left) && (n2.fadeLeft = false, t2.fadeLeft = false);
    }), this._referenceLines.push(t2);
  }
}
const d = n$2v(), g$1 = n$2v(), p$3 = n$2v();
class p$2 extends i$2 {
  snapNewVertex(e2, t2) {
    const r2 = t2.editGeometryOperations.data.components[0], s2 = r2.edges.length, o2 = r2.vertices.length, a2 = [];
    if (s2 < 2)
      return a2;
    const { view: c2 } = this, d2 = l$1(e2, t2.coordinateHelper, E$f, c2), p2 = R$a(r2.vertices[o2 - 1].pos, c2, t2), g2 = R$a(r2.vertices[0].pos, c2, t2), f2 = r2.edges[s2 - 1];
    let m2 = f2;
    do {
      if (this.edgeExceedsShortLineThreshold(m2, t2)) {
        const r3 = N$a(m2, c2, t2);
        this._checkEdgeForParalleLines(r3, p2, e2, d2, t2, a2), this._checkEdgeForParalleLines(r3, g2, e2, d2, t2, a2);
      }
      m2 = m2.leftVertex.leftEdge;
    } while (m2 && m2 !== f2);
    return a2;
  }
  snapExistingVertex(t2, r2) {
    const s2 = [], o2 = e$2e(r2.vertexHandle), a2 = o2.component;
    if (a2.edges.length < 3)
      return s2;
    const { view: c2 } = this, d2 = l$1(t2, r2.coordinateHelper, E$f, c2), p2 = o2.leftEdge, g2 = o2.rightEdge, f2 = a2.vertices[0], m2 = R$a(f2.pos, c2, r2), u2 = a2.vertices.length, v2 = a2.vertices[u2 - 1], E2 = R$a(v2.pos, c2, r2), L2 = a2.edges[0];
    let x2 = L2;
    do {
      if (x2 !== p2 && x2 !== g2 && this.edgeExceedsShortLineThreshold(x2, r2)) {
        const e2 = N$a(x2, c2, r2);
        p2 && this._checkEdgeForParalleLines(e2, R$a(p2.leftVertex.pos, c2, r2), t2, d2, r2, s2), g2 && this._checkEdgeForParalleLines(e2, R$a(g2.rightVertex.pos, c2, r2), t2, d2, r2, s2), o2 === f2 ? this._checkEdgeForParalleLines(e2, E2, t2, d2, r2, s2) : o2 === v2 && this._checkEdgeForParalleLines(e2, m2, t2, d2, r2, s2);
      }
      x2 = x2.rightVertex.rightEdge;
    } while (x2 && x2 !== L2);
    return s2;
  }
  _checkEdgeForParalleLines(e2, r2, o2, n2, l2, p2) {
    const f2 = e2.left, m2 = e2.right;
    if (L$2(g, r2, f2, m2), b$k(g, r2) < p$z.parallelLineThreshold)
      return;
    L$2(g, o2, f2, m2, r2);
    const { coordinateHelper: u2, pointer: v2 } = l2, E2 = u2.fromXYZ(g, u2.getZ(o2, 0));
    if (u$j(n2, l$1(E2, u2, E$f, this.view)) < this.squaredProximityThreshold(v2)) {
      if (this._parallelToPreviousCandidate(e2, p2))
        return;
      p2.push(new h$2({ coordinateHelper: u2, referenceLine: e2, lineStart: r2, targetPoint: E2, elevationInfo: u2.hasZ() ? E$f : null }));
    }
  }
  _parallelToPreviousCandidate(e2, r2) {
    const i2 = e2.left, o2 = e2.right;
    for (const n2 of r2)
      if (L$2(g, o2, n2.constraint.start, n2.constraint.end, i2), b$k(g, o2) < p$z.parallelLineThreshold)
        return n2.addReferenceLine(e2), true;
    return false;
  }
}
const g = n$S();
class v extends i$2 {
  snapNewVertex(e2, t2) {
    const r2 = t2.editGeometryOperations.data.components[0], i2 = r2.vertices.length, s2 = [];
    if (i2 < 2)
      return s2;
    const { view: o2 } = this, n2 = l$1(e2, t2.coordinateHelper, E$f, o2), h2 = r2.vertices[i2 - 1];
    if (this.edgeExceedsShortLineThreshold(h2.leftEdge, t2)) {
      const r3 = R$a(h2.pos, o2, t2), i3 = N$a(h2.leftEdge, o2, t2);
      this._checkForSnappingCandidate(s2, i3, r3, e2, i3.left, r3, t2, e2, n2);
    }
    const c2 = r2.vertices[0];
    if (this.edgeExceedsShortLineThreshold(c2.rightEdge, t2)) {
      const r3 = R$a(c2.pos, o2, t2), i3 = N$a(c2.rightEdge, o2, t2);
      this._checkForSnappingCandidate(s2, i3, r3, e2, i3.right, r3, t2, e2, n2);
    }
    return s2;
  }
  snapExistingVertex(t2, r2) {
    const i2 = [], s2 = e$2e(r2.vertexHandle), o2 = s2.component, n2 = o2.vertices.length;
    if (n2 < 3)
      return i2;
    const { view: h2 } = this, c2 = l$1(t2, r2.coordinateHelper, E$f, h2), a2 = s2.leftEdge, g2 = s2.rightEdge, l2 = o2.vertices[0], m2 = o2.vertices[n2 - 1];
    if (!a2) {
      const e2 = l2.rightEdge.rightVertex.rightEdge;
      if (this.edgeExceedsShortLineThreshold(e2, r2)) {
        const s3 = N$a(e2, h2, r2), o3 = R$a(l2.rightEdge.rightVertex.pos, h2, r2);
        this._checkForSnappingCandidate(i2, s3, o3, t2, s3.right, o3, r2, t2, c2);
      }
      return i2;
    }
    if (!g2) {
      const e2 = m2.leftEdge.leftVertex.leftEdge;
      if (this.edgeExceedsShortLineThreshold(e2, r2)) {
        const s3 = N$a(e2, h2, r2), o3 = R$a(m2.leftEdge.leftVertex.pos, h2, r2);
        this._checkForSnappingCandidate(i2, s3, o3, t2, s3.left, o3, r2, t2, c2);
      }
      return i2;
    }
    if (a2 && a2.leftVertex.leftEdge) {
      const e2 = a2.leftVertex.leftEdge;
      if (this.edgeExceedsShortLineThreshold(e2, r2)) {
        const s3 = N$a(e2, h2, r2), o3 = R$a(a2.leftVertex.pos, h2, r2);
        this._checkForSnappingCandidate(i2, s3, o3, t2, s3.left, o3, r2, t2, c2);
      }
    }
    if (g2 && g2.rightVertex.rightEdge) {
      const e2 = g2.rightVertex.rightEdge;
      if (this.edgeExceedsShortLineThreshold(e2, r2)) {
        const s3 = N$a(e2, h2, r2), o3 = R$a(g2.rightVertex.pos, h2, r2);
        this._checkForSnappingCandidate(i2, s3, o3, t2, s3.right, o3, r2, t2, c2);
      }
    }
    return i2;
  }
  _checkForSnappingCandidate(e2, o2, c2, a2, p2, f2, v2, k2, C2) {
    const { coordinateHelper: T2, pointer: w2 } = v2;
    o$I(u, o2.right, o2.left);
    const F2 = o$1Q(j, u[1], -u[0], 0), _2 = j$e(F2, o$I(u, a2, c2)) / p$U(F2), L2 = T2.fromXYZ(d$t(u, f2, F2, _2), T2.getZ(k2, 0));
    if (u$j(C2, l$1(L2, T2, E$f, this.view)) < this.squaredProximityThreshold(w2)) {
      const t2 = T2.toXYZ(f2, S), r2 = q$q(V, t2, F2, Math.sign(_2)), i2 = T2.fromXYZ(r2);
      e2.push(new n$2({ coordinateHelper: T2, targetPoint: L2, constraint: new v$2(T2, f2, i2), previousVertex: p2, otherVertex: f2, otherVertexType: s$2.CENTER, elevationInfo: T2.hasZ() ? E$f : null }));
    }
  }
}
const u = n$S(), S = n$2v(), V = n$2v(), j = n$2v();
class m$1 extends t {
  constructor({ coordinateHelper: n2, targetPoint: r2, point1: p2, point2: a2, elevationInfo: e2 }) {
    super(n2, r2, new P(n2, n2.arrayToVector(A$c(h$1, p2, a2, 0.5)), 0.5 * m$T(p2, a2)), e2, E$g.SELF), this._p1 = p2, this._p2 = a2;
  }
  get hints() {
    const t2 = this.elevationInfo;
    return [new s$r(l$r.REFERENCE, this.targetPoint, this._p1, t2, this.domain), new s$r(l$r.REFERENCE, this.targetPoint, this._p2, t2, this.domain), new s$p(this._p1, this.targetPoint, this._p2, t2, this.domain)];
  }
}
const h$1 = n$S();
class m extends i$2 {
  snapNewVertex(e2, t2) {
    const o2 = t2.editGeometryOperations.data.components[0], r2 = [], s2 = o2.vertices.length;
    if (t2.editGeometryOperations.data.type !== "polygon" || s2 < 2)
      return r2;
    const { view: i2 } = this, p2 = o2.vertices[0], a2 = o2.vertices[s2 - 1], d2 = R$a(p2.pos, i2, t2), l2 = R$a(a2.pos, i2, t2);
    return this._processCandidateProposal(d2, l2, e2, t2, r2), r2;
  }
  snapExistingVertex(t2, o2) {
    const r2 = [], s2 = e$2e(o2.vertexHandle), i2 = s2.component;
    if (i2.edges.length < 2)
      return r2;
    if (o2.editGeometryOperations.data.type === "polyline" && (s2.index === 0 || s2.index === i2.vertices.length - 1))
      return r2;
    const { view: p2 } = this, a2 = R$a(s2.leftEdge.leftVertex.pos, p2, o2), d2 = R$a(s2.rightEdge.rightVertex.pos, p2, o2);
    return this._processCandidateProposal(a2, d2, t2, o2, r2), r2;
  }
  _processCandidateProposal(e2, r2, i2, n2, m2) {
    if (!this.exceedsShortLineThreshold(e2, r2, n2))
      return;
    const g2 = A$c(c, e2, r2, 0.5), f2 = 0.5 * m$T(e2, r2), u2 = m$x(h, i2, g2, f2), { coordinateHelper: v2, pointer: x2 } = n2, y2 = v2.fromXYZ(u2, v2.getZ(i2, 0)), j2 = l$1(i2, v2, E$f, this.view);
    u$j(j2, l$1(y2, v2, E$f, this.view)) < this.squaredProximityThreshold(x2) && m2.push(new m$1({ coordinateHelper: v2, targetPoint: y2, point1: e2, point2: r2, elevationInfo: v2.hasZ() ? E$f : null }));
  }
}
const c = n$S(), h = n$S();
let f = class extends m$2q {
  constructor(o2) {
    super(o2), this.updating = false, this._snappers = new j$V(), this._domain = E$g.SELF;
  }
  initialize() {
    this._snappers.push(new p$2(this.view, this.options), new a(this.view, this.options), new v(this.view, this.options), new m(this.view, this.options));
  }
  set options(o2) {
    this._set("options", o2);
    for (const s2 of this._snappers)
      s2.options = o2;
  }
  async fetchCandidates(o2, s2, t2) {
    if (!(s2 & this._domain && this.options.effectiveSelfEnabled))
      return [];
    const i2 = [];
    for (const r2 of this._snappers.items)
      for (const s3 of r2.snap(o2, t2))
        i2.push(s3);
    return a$m(o2, i2, t2.coordinateHelper), i2;
  }
};
e$2g([y$1I({ readOnly: true })], f.prototype, "updating", void 0), e$2g([y$1I({ constructOnly: true })], f.prototype, "view", void 0), e$2g([y$1I()], f.prototype, "options", null), f = e$2g([n$2P("esri.views.interactive.snapping.SelfSnappingEngine")], f);
function i$1(i2, p2) {
  return [new f({ view: i2, options: p2 }), new M$1({ view: i2, options: p2, spatialReference: i2.spatialReference })];
}
let s$1 = class extends m$2q {
  constructor(r2) {
    super(r2), this.layer = null, this.enabled = true, this.updating = false, this.availability = 1;
  }
};
e$2g([y$1I({ constructOnly: true })], s$1.prototype, "layer", void 0), e$2g([y$1I()], s$1.prototype, "enabled", void 0), e$2g([y$1I()], s$1.prototype, "updating", void 0), e$2g([y$1I()], s$1.prototype, "availability", void 0), s$1 = e$2g([n$2P("esri.views.interactive.snapping.FeatureSnappingLayerSource")], s$1);
const p$1 = s$1;
let l = class extends m$2q {
  constructor(e2) {
    super(e2), this.enabled = false, this.enabledToggled = false, this.selfEnabled = true, this.featureEnabled = true, this.featureSources = new j$V(), this.distance = p$z.distance, this.touchSensitivityMultiplier = p$z.touchSensitivityMultiplier;
  }
  get effectiveEnabled() {
    return this.enabledToggled ? !this.enabled : this.enabled;
  }
  get effectiveSelfEnabled() {
    return this.effectiveEnabled && this.selfEnabled;
  }
  get effectiveFeatureEnabled() {
    return this.effectiveEnabled && this.featureEnabled;
  }
};
e$2g([y$1I()], l.prototype, "enabled", void 0), e$2g([y$1I()], l.prototype, "enabledToggled", void 0), e$2g([y$1I()], l.prototype, "selfEnabled", void 0), e$2g([y$1I()], l.prototype, "featureEnabled", void 0), e$2g([y$1I({ type: j$V.ofType(p$1) })], l.prototype, "featureSources", void 0), e$2g([y$1I()], l.prototype, "distance", void 0), e$2g([y$1I()], l.prototype, "touchSensitivityMultiplier", void 0), e$2g([y$1I({ readOnly: true })], l.prototype, "effectiveEnabled", null), e$2g([y$1I({ readOnly: true })], l.prototype, "effectiveSelfEnabled", null), e$2g([y$1I({ readOnly: true })], l.prototype, "effectiveFeatureEnabled", null), l = e$2g([n$2P("esri.views.interactive.snapping.SnappingOptions")], l);
const n$1 = l;
class o extends t {
  constructor(n2, s2, o2, r2, e2) {
    super(n2, s2, new E$2(n2, s2, o2.constraint, r2.constraint), e2, E$g.ALL), this.first = o2, this.second = r2;
  }
  get hints() {
    return this.first.targetPoint = this.targetPoint, this.second.targetPoint = this.targetPoint, [...this.first.hints, ...this.second.hints, new o$m(this.targetPoint, this.elevationInfo, this.domain)];
  }
}
let E = class extends n$2G.EventedMixin(d$18) {
  constructor(t2) {
    super(t2), this.options = new n$1(), this.snappingEnginesFactory = i$1, this._engines = [], this._currentMainCandidate = null, this._currentOtherActiveCandidates = [], this._currentSnappedType = T.MAIN;
  }
  initialize() {
    this.handles.add([l$1P(() => {
      const { effectiveFeatureEnabled: t2, effectiveSelfEnabled: e2, touchSensitivityMultiplier: n2, distance: i2 } = this.options;
      return { effectiveFeatureEnabled: t2, effectiveSelfEnabled: e2, touchSensitivityMultiplier: n2, distance: i2 };
    }, () => {
      this.doneSnapping(), this.emit("changed");
    }, U$r), l$1P(() => this.options, (t2) => {
      for (const e2 of this._engines)
        e2.options = t2;
    }, U$r), l$1P(() => ({ viewReady: this.view.ready, viewSpatialReference: this.view.spatialReference, snappingEnginesFactory: this.snappingEnginesFactory }), ({ viewReady: t2, snappingEnginesFactory: e2 }) => this._recreateEngines(t2, e2), w$Q)]);
  }
  destroy() {
    this._destroyEngines();
  }
  get updating() {
    return this._engines.some((t2) => t2.updating);
  }
  _recreateEngines(t2, e2) {
    if (this._destroyEngines(), !t2)
      return;
    const { view: n2, options: i2 } = this;
    this._engines = e2(n2, i2);
  }
  _destroyEngines() {
    for (const t2 of this._engines)
      t2.destroy();
    this._engines = [];
  }
  get _squaredMouseProximityTreshold() {
    return this.options.distance * this.options.distance;
  }
  get _squaredTouchProximityThreshold() {
    const { distance: t2, touchSensitivityMultiplier: e2 } = this.options, n2 = t2 * e2;
    return n2 * n2;
  }
  async snap(t2) {
    return I(t2) ? this._snapMultiPoint(t2) : this._snapSinglePoint(t2);
  }
  update(t2) {
    const { point: e2, context: n2 } = t2;
    this._removeVisualization();
    const i2 = this._currentMainCandidate;
    if (t$2r(i2))
      return e2;
    const o2 = this._selectUpdateInput(t2);
    if (t$2r(o2))
      return e2;
    const { coordinateHelper: { spatialReference: a2 } } = n2, c2 = rn(this._convertPointElevation(o2, n2), a2);
    if (t$2r(c2))
      return e2;
    const { view: p2 } = this, { coordinateHelper: d2, elevationInfo: h2, visualizer: u2 } = n2, _2 = [], g2 = d2.pointToVector(c2), v2 = i2.constraint.closestTo(g2);
    if (!this._arePointsWithinScreenThreshold(g2, v2, n2))
      return this._resetSnappingState(), e2;
    i2.targetPoint = v2, _2.push(...i2.hints);
    for (const s2 of this._currentOtherActiveCandidates)
      s2.targetPoint = v2, _2.push(...s2.hints);
    r$1$(u2) && this.handles.add(u2.draw(_2, { coordinateHelper: d2, elevationInfo: M(n2), view: p2, selfSnappingZ: n2.selfSnappingZ }), w);
    const S2 = d2.vectorToDehydratedPoint(v2);
    return this._convertPointElevation(S2, n2, E$f, h2);
  }
  doneSnapping() {
    this._removeVisualization(), this._resetSnappingState();
  }
  _selectUpdateInput({ point: t2, scenePoint: e2 }) {
    switch (this._currentSnappedType) {
      case T.MAIN:
        return t2;
      case T.SCENE:
        return e2;
    }
  }
  _resetSnappingState() {
    this._currentMainCandidate = null, this._currentOtherActiveCandidates = [], this._currentSnappedType = T.MAIN;
  }
  _removeVisualization() {
    this.handles.remove(w);
  }
  async _snapSinglePoint({ point: t2, context: e2, signal: n2 }) {
    const { coordinateHelper: i2 } = e2, { view: s2 } = this, r2 = this._convertPointElevation(t2, e2), o2 = i2.pointToVector(r2), a2 = await this._fetchCandidates(o2, E$g.ALL, e2, n2);
    return this._createSnapResult(o2, T.MAIN, a2, s2, e2, n2);
  }
  async _snapMultiPoint({ point: t2, scenePoint: e2, context: n2, signal: i2 }) {
    const { view: s2 } = this, { coordinateHelper: r2 } = n2, { spatialReference: o2 } = r2;
    await _n(e2.spatialReference, o2);
    const a2 = rn(this._convertPointElevation(e2, n2), o2), c2 = r2.pointToVector(a2), p2 = await this._fetchCandidates(c2, E$g.FEATURE, n2, i2);
    if (p2.length > 0) {
      const t3 = await this._fetchCandidates(c2, E$g.SELF, n2, i2);
      return this._createSnapResult(c2, T.SCENE, [...p2, ...t3], s2, n2, i2);
    }
    const d2 = this._convertPointElevation(t2, n2), h2 = r2.pointToVector(d2), f2 = await this._fetchCandidates(h2, E$g.SELF, n2, i2);
    return this._createSnapResult(h2, T.MAIN, f2, s2, n2, i2);
  }
  async _fetchCandidates(t2, e2, n2, i2) {
    return (await Promise.all(this._engines.map((s2) => s2.fetchCandidates(t2, e2, n2, i2)))).flat();
  }
  _createSnapResult(t2, e2, n2, i2, s2, a2) {
    return { get valid() {
      return !p$3D(a2);
    }, apply: () => {
      const { elevationInfo: o2, coordinateHelper: a3 } = s2, { snappedPoint: c2, hints: p2 } = this._processCandidates(t2, e2, n2, s2);
      return this._removeVisualization(), r$1$(s2.visualizer) && this.handles.add(s2.visualizer.draw(p2, { coordinateHelper: a3, elevationInfo: M(s2), view: i2, selfSnappingZ: s2.selfSnappingZ }), w), this._convertPointElevation(c2, s2, E$f, o2);
    } };
  }
  _processCandidates(t2, e2, n2, i2) {
    const { coordinateHelper: s2 } = i2;
    if (n2.length < 1)
      return this.doneSnapping(), { snappedPoint: s2.vectorToDehydratedPoint(t2), hints: [] };
    this._currentSnappedType !== e2 && this._resetSnappingState(), a$m(t2, n2, s2);
    const o$110 = this._currentMainCandidate;
    if (r$1$(o$110)) {
      const s3 = this._findOldConstraintInNewCandidates(o$110, n2);
      if (s3 >= 0) {
        if (!(n2[s3] instanceof o))
          return this._intersectWithOtherCandidates(s3, n2, t2, e2, i2);
        if (this._arePointsWithinScreenThreshold(t2, o$110.targetPoint, i2))
          return this._updateSnappingCandidate(o$110, e2, n2, i2);
      }
    }
    return this._intersectWithOtherCandidates(0, n2, t2, e2, i2);
  }
  _findOldConstraintInNewCandidates(t2, e2) {
    return t2 instanceof o ? this._findOldCandidateIndex(e2, t2.first) >= 0 && this._findOldCandidateIndex(e2, t2.second) >= 0 ? 0 : -1 : this._findOldCandidateIndex(e2, t2);
  }
  _intersectWithOtherCandidates(t2, e2, n2, i2, s2) {
    const { coordinateHelper: r2 } = s2, o$110 = e2[t2], a2 = [];
    for (let c2 = 0; c2 < e2.length; ++c2) {
      if (c2 === t2)
        continue;
      const i3 = e2[c2];
      for (const t3 of o$110.constraint.intersect(i3.constraint)) {
        const e3 = r2.fromXYZ(t3.closestTo(o$110.targetPoint), o$110.targetPoint[2]);
        a2.push([new o(r2, e3, o$110, i3, i3.elevationInfo), this._squaredScreenDistance(n2, e3, r2)]);
      }
    }
    return a2.length > 0 && (a2.sort((t3, e3) => t3[1] - e3[1]), a2[0][1] < this._squaredPointProximityThreshold(s2.pointer)) ? this._updateSnappingCandidate(a2[0][0], i2, e2, s2) : this._updateSnappingCandidate(o$110, i2, e2, s2);
  }
  _updateSnappingCandidate(t2, e2, n2, i2) {
    this.doneSnapping(), this._currentMainCandidate = t2, this._currentSnappedType = e2;
    const s2 = this._currentMainCandidate.targetPoint, r2 = [];
    r2.push(...t2.hints);
    for (const o$110 of n2) {
      if (t2 instanceof o) {
        if (o$110.constraint.equals(t2.first.constraint) || o$110.constraint.equals(t2.second.constraint))
          continue;
      } else if (o$110.constraint.equals(t2.constraint))
        continue;
      o$110.constraint.check(s2) && (o$110.targetPoint = s2, this._currentOtherActiveCandidates.push(o$110), r2.push(...o$110.hints));
    }
    return { snappedPoint: i2.coordinateHelper.vectorToDehydratedPoint(s2), hints: r2 };
  }
  _squaredPointProximityThreshold(t2) {
    return t2 === "touch" ? this._squaredTouchProximityThreshold : this._squaredMouseProximityTreshold;
  }
  _arePointsWithinScreenThreshold(t2, e2, n2) {
    return this._squaredScreenDistance(t2, e2, n2.coordinateHelper) < this._squaredPointProximityThreshold(n2.pointer);
  }
  _squaredScreenDistance(t2, e2, n2) {
    return u$j(this._toScreen(t2, n2), this._toScreen(e2, n2));
  }
  _toScreen(t2, e2) {
    return l$1(t2, e2, E$f, this.view);
  }
  _findOldCandidateIndex(t2, e2) {
    let n2 = -1;
    for (let i2 = 0; i2 < t2.length; ++i2)
      if (e2.constraint.equals(t2[i2].constraint)) {
        n2 = i2;
        break;
      }
    return n2;
  }
  _convertPointElevation(t2, e2, n2 = e2.elevationInfo, s2 = E$f) {
    const { view: o2 } = this;
    if (!(r$1$(t2) && e2.coordinateHelper.hasZ() && r$1$(o2) && o2.type === "3d"))
      return t2;
    const a2 = y$1L(t2);
    return a2.z = g$f(o2, a2, n2, s2), a2;
  }
  get test() {
    return { visualizationsActive: this.handles.has(w), engines: this._engines };
  }
};
var T;
e$2g([y$1I({ constructOnly: true })], E.prototype, "view", void 0), e$2g([y$1I()], E.prototype, "options", void 0), e$2g([y$1I({ readOnly: true })], E.prototype, "updating", null), e$2g([y$1I()], E.prototype, "snappingEnginesFactory", void 0), e$2g([y$1I()], E.prototype, "_engines", void 0), e$2g([y$1I()], E.prototype, "_squaredMouseProximityTreshold", null), e$2g([y$1I()], E.prototype, "_squaredTouchProximityThreshold", null), E = e$2g([n$2P("esri.views.interactive.snapping.SnappingManager")], E), function(t2) {
  t2[t2.MAIN = 0] = "MAIN", t2[t2.SCENE = 1] = "SCENE";
}(T || (T = {}));
const w = "visualization-handle";
function I(t2) {
  return r$1$(t2.scenePoint);
}
function M({ coordinateHelper: t2, elevationInfo: e2 }) {
  return t2.hasZ() ? E$f : e2;
}
function r(n2) {
  return r$1$(n2) && n2.type === "graphic";
}
function s(t2) {
  var _a2;
  return (_a2 = t2.find(r)) != null ? _a2 : null;
}
let p = class extends n$2G.EventedAccessor {
  constructor(e2) {
    super(e2), this.cancelled = false, this.history = { undo: [], redo: [] }, this.type = null;
  }
  get tool() {
    if (!this.activeComponent)
      return null;
    switch (this.activeComponent.type) {
      case "graphic-mover":
      case "move-3d":
        return "move";
      case "box":
      case "transform-3d":
        return "transform";
      case "reshape":
      case "reshape-3d":
        return "reshape";
      case "draw-2d":
      case "draw-3d":
        return this.activeComponent.geometryType;
      default:
        n$1x(this.activeComponent);
    }
    return null;
  }
  addToHistory(e2) {
    this.history.redo = [], this.history.undo.push(e2);
  }
  resetHistory() {
    this.history.redo = [], this.history.undo = [];
  }
  canUndo() {
    return this.history.undo.length > 0;
  }
  canRedo() {
    return this.history.redo.length > 0;
  }
  complete() {
    this._reset(), this.onEnd(), this.emit("complete");
  }
  cancel() {
    this.cancelled = true, this.complete();
  }
  _reset() {
    this.activeComponent.reset();
  }
  refreshComponent() {
    const e2 = this.activeComponent;
    e2 && (e2.type !== "box" && e2.type !== "reshape" && e2.type !== "graphic-mover" || e2.refresh());
  }
  set undo(e2) {
    this._set("undo", () => {
      this.canUndo() && e2();
    });
  }
  set redo(e2) {
    this._set("redo", () => {
      this.canRedo() && e2();
    });
  }
};
e$2g([y$1I()], p.prototype, "activeComponent", void 0), e$2g([y$1I()], p.prototype, "cancelled", void 0), e$2g([y$1I()], p.prototype, "history", void 0), e$2g([y$1I()], p.prototype, "tool", null), e$2g([y$1I()], p.prototype, "type", void 0), e$2g([y$1I()], p.prototype, "canUndo", null), e$2g([y$1I()], p.prototype, "canRedo", null), e$2g([y$1I()], p.prototype, "onEnd", void 0), e$2g([y$1I()], p.prototype, "undo", null), e$2g([y$1I()], p.prototype, "redo", null), e$2g([y$1I()], p.prototype, "toggleTool", void 0), e$2g([y$1I()], p.prototype, "addToSelection", void 0), e$2g([y$1I()], p.prototype, "removeFromSelection", void 0), p = e$2g([n$2P("esri.widgets.Sketch.support.OperationHandle")], p);
let n = class extends p {
};
e$2g([y$1I()], n.prototype, "activeComponent", void 0), n = e$2g([n$2P("esri.widgets.Sketch.support.CreateOperationHandle")], n);
let i = class extends p {
};
e$2g([y$1I()], i.prototype, "activeComponent", void 0), i = e$2g([n$2P("esri.widgets.Sketch.support.UpdateOperationHandle")], i);
const Y = { defaultZ: 0 }, J = { reshapeOptions: { edgeOperation: "split", shapeOperation: "move", vertexOperation: "move" }, enableMoveAllGraphics: true, enableRotation: true, enableScaling: true, multipleSelectionEnabled: true, preserveAspectRatio: false, toggleToolOnClick: true, enableZ: true, tool: "transform" };
let Q = class extends n$2G.EventedAccessor {
  constructor(e2) {
    super(e2), this._numUpdating = 0, this._handles = new t$2g(), this._internalGraphicsLayer = new h$r({ listMode: "hide", internal: true, title: "SVM Internal" }), this._operationHandle = null, this._viewHandles = new t$2g(), this.activeFillSymbol = null, this.activeLineSymbol = null, this.activeVertexSymbol = null, this.allowDeleteKey = true, this.labelOptions = new c$l(), this.layer = null, this.pointSymbol = new y$1f({ style: "circle", size: 6, color: [255, 255, 255], outline: { color: [50, 50, 50], width: 1 } }), this.polygonSymbol = new S$H({ color: [150, 150, 150, 0.2], outline: { color: [50, 50, 50], width: 2 } }), this.polylineSymbol = new m$25({ color: [130, 130, 130, 1], width: 2 }), this._snappingManager = null, this.tooltipOptions = new p$q(), this.updateGraphics = new j$V(), this.updateOnGraphicClick = true, this.updatePointSymbol = new y$1f({ size: 10, color: [0, 200, 255, 0.5], outline: { color: "black", width: 1 } }), this.updatePolygonSymbol = new S$H({ color: [12, 207, 255, 0.2], outline: { join: "round", color: [12, 207, 255], width: 2 } }), this.updatePolylineSymbol = new m$25({ color: [12, 207, 255], width: 2 }), this.vertexSymbol = new y$1f({ style: "circle", size: 6, color: [255, 255, 255], outline: { color: [50, 50, 50], width: 1 } }), this._moduleLoaderAbortController = null, this._viewReadyAbortController = null, this._originalAutoOpenEnabled = null, this.defaultCreateOptions = Y, this.defaultUpdateOptions = J, this.snappingOptions = new n$1();
  }
  initialize() {
    this._handles.add([a$2a(() => {
      var _a2, _b2;
      return (_b2 = (_a2 = this.view) == null ? void 0 : _a2.map) == null ? void 0 : _b2.layers;
    }, "change", (e2) => {
      e2.removed.includes(this.layer) && this.cancel();
    }), a$2a(() => {
      var _a2;
      return (_a2 = this.layer) == null ? void 0 : _a2.graphics;
    }, "change", (e2) => {
      if (r$1$(this._operationHandle))
        for (const t2 of e2.removed)
          this.updateGraphics.includes(t2) && (this.updateGraphics.length > 1 ? this._operationHandle.removeFromSelection(t2) : this._operationHandle.cancel());
    }), l$1P(() => {
      var _a2, _b2;
      return (_b2 = (_a2 = this.layer) == null ? void 0 : _a2.elevationInfo) != null ? _b2 : null;
    }, (e2) => {
      e2 !== this._internalGraphicsLayer.elevationInfo && (this.cancel(), this._internalGraphicsLayer.elevationInfo = e2);
    }, w$Q), l$1P(() => this.view, (e2) => {
      s$2D(this._snappingManager), e2 && (this._snappingManager = new E({ view: e2, options: this.snappingOptions }), e2.type === "2d" ? import("./editingTools.js") : e2.type === "3d" && (import("./editingTools2.js").then(function(n2) {
        return n2.e;
      }), import("./GraphicsLayerView3D.js").then(function(n2) {
        return n2.G;
      })));
    }, w$Q), l$1P(() => {
      var _a2;
      return (_a2 = this.view) == null ? void 0 : _a2.spatialReference;
    }, (e2, t2) => {
      e2 && t2 && !e2.equals(t2) && this.cancel();
    })]);
  }
  destroy() {
    this.cancel(), this._handles = s$2D(this._handles), this._viewHandles = s$2D(this._viewHandles), this._removeDefaultLayer(), this._snappingManager = s$2D(this._snappingManager), this._set("view", null), this.emit("destroy");
  }
  get _defaultUpdateTool() {
    return this.view.type === "3d" ? "move" : "transform";
  }
  get updating() {
    return this._numUpdating > 0;
  }
  get activeTool() {
    return this._operationHandle && this._operationHandle.tool ? this._operationHandle.tool : null;
  }
  get activeComponent() {
    return this._operationHandle ? this._operationHandle.activeComponent : null;
  }
  get createGraphic() {
    return !r$1$(this.activeComponent) || this.activeComponent.type !== "draw-3d" && this.activeComponent.type !== "draw-2d" ? this._get("createGraphic") : e$2e(this.activeComponent.graphic);
  }
  get defaultCreateOptions() {
    return this._get("defaultCreateOptions");
  }
  set defaultCreateOptions(e2) {
    this._set("defaultCreateOptions", __spreadValues(__spreadValues({}, Y), e2));
  }
  get defaultUpdateOptions() {
    return this._get("defaultUpdateOptions");
  }
  set defaultUpdateOptions(e2) {
    this._set("defaultUpdateOptions", __spreadProps(__spreadValues(__spreadValues({}, J), e2), { reshapeOptions: __spreadValues(__spreadValues({}, J.reshapeOptions), e2 == null ? void 0 : e2.reshapeOptions) }));
  }
  set snappingOptions(e2) {
    r$1$(this._snappingManager) && (this._snappingManager.options = e2), this._set("snappingOptions", e2);
  }
  get state() {
    var _a2;
    const e2 = !(!((_a2 = this.view) == null ? void 0 : _a2.ready) || !this.layer), t2 = this._operationHandle;
    return e2 && t2 ? "active" : e2 ? "ready" : "disabled";
  }
  get view() {
    return this._get("view");
  }
  set view(e2) {
    const t2 = this._get("view");
    if (t2) {
      const { container: e3, map: o3 } = t2;
      e3 && (t2.cursor = null), o3 && o3.remove(this._internalGraphicsLayer), this._viewHandles.removeAll(), this.cancel();
    }
    const o2 = "view-ready";
    this._handles.remove(o2), e2 && this._handles.add(f$1o(() => e2.ready, (t3) => {
      this._viewHandles.removeAll(), t3 && this._viewHandles.add(this._generateViewHandles(e2));
    }, w$Q), o2), this._set("view", e2);
  }
  cancel() {
    this._moduleLoaderAbortController = p$3M(this._moduleLoaderAbortController), this._viewReadyAbortController = p$3M(this._viewReadyAbortController), this._operationHandle && this._operationHandle.cancel();
  }
  complete() {
    this._operationHandle && this._operationHandle.complete();
  }
  delete() {
    const { state: e2, updateGraphics: t2 } = this;
    if (e2 === "active" && t2.length) {
      const { activeTool: e3, layer: o2 } = this, i2 = t2.toArray();
      o2.removeMany(i2), this.cancel(), this._emitDeleteEvent({ graphics: i2, tool: e3 });
    }
  }
  async create(e2, t2) {
    if (this.cancel(), await this._waitViewReady(), this.state === "disabled")
      throw this.layer || this._logError("sketch:missing-property", "Property 'layer' is missing on SketchViewModel."), this.view || this._logError("sketch:missing-property", "Property 'view' is missing on SketchViewModel."), a$2T();
    if (r$1$(this.view.activeTool) && (this.view.activeTool = null), !e2)
      return void this._logError("sketch:missing-parameter", "Missing parameter 'tool'.");
    e$6(this.view, this._internalGraphicsLayer);
    const o2 = await this._setupCreateOperation(e2, t2);
    if (t$2r(o2) || this.destroyed)
      return void this.view.map.remove(this._internalGraphicsLayer);
    const i2 = () => {
      if (o2 === this._operationHandle) {
        const t3 = this.createGraphic, i3 = this._operationHandle.cancelled;
        this._operationHandle.destroy(), this._operationHandle = null, this._set("createGraphic", null), this.view && this.view.map && this.view.map.remove(this._internalGraphicsLayer), o2.cancelled || t3 == null || this.layer.add(t3), this.emit("create", { graphic: t3, state: i3 ? "cancel" : "complete", tool: e2, toolEventInfo: null, type: "create" });
      }
    };
    o2.on("complete", i2), this._operationHandle = o2, this.view.ready && this.view.focus();
  }
  async update(e2, t2) {
    this.cancel(), await this._waitViewReady();
    const { layer: o2, view: i2, state: a2 } = this;
    if (a2 === "disabled")
      throw i2 || this._logError("sketch:missing-property", "Property 'view' is missing on SketchViewModel."), o2 || this._logError("sketch:missing-property", "Property 'layer' is missing on SketchViewModel."), a$2T();
    r$1$(this.view.activeTool) && (this.view.activeTool = null);
    const r2 = Array.isArray(e2) ? e2 : [e2];
    if (e2 == null || !r2 || !r2.length)
      return void this._logError("sketch:missing-parameter", "Missing parameter 'graphics'.");
    if (r2.some((e3) => e3.layer !== o2 ? (this._logError("sketch:invalid-parameter", "Parameter 'graphics' contains one or more graphics missing from the supplied GraphicsLayer."), true) : !!t$2r(e3.geometry) && (this._logError("sketch:invalid-parameter", "Parameter 'graphics' contains one or more graphics with an unsupported geometry."), true)))
      return;
    const s2 = await this._setupUpdateOperation(r2, t2);
    this.destroyed || t$2r(s2) || ae(s2) || (e$6(this.view, this._internalGraphicsLayer), this._setUpdateOperationHandle(s2, t2), this.emit("update", { graphics: r2, state: "start", aborted: false, tool: s2.tool, toolEventInfo: null, type: "update" }));
  }
  async _updateSpatialReference(e2) {
    this._beginAsyncOperation(), e2 = Array.isArray(e2) ? e2 : [e2];
    for (const t2 of e2)
      r$1$(t2.geometry) && t2.geometry.type !== "mesh" && !E$P(t2.geometry.spatialReference, this.view.spatialReference) && (An(t2.geometry.spatialReference, this.view.spatialReference) || en() || await tn(), t2.geometry = rn(t2.geometry, this.view.spatialReference));
    this._endAsyncOperation();
  }
  undo() {
    this.canUndo() && this._operationHandle.undo();
  }
  redo() {
    this.canRedo() && this._operationHandle.redo();
  }
  canUndo() {
    return !(!this._operationHandle || !this._operationHandle.canUndo());
  }
  canRedo() {
    return !(!this._operationHandle || !this._operationHandle.canRedo());
  }
  toggleUpdateTool() {
    this._operationHandle && this._operationHandle.toggleTool && this._operationHandle.toggleTool();
  }
  async _getFirstHit(e2) {
    const t2 = this.view;
    if (t2.type === "2d") {
      const t3 = [];
      this.view.map.allLayers.forEach((e3) => {
        e3.type !== "vector-tile" && e3.type !== "imagery" || t3.push(e3);
      });
      const o3 = await this.view.hitTest(e2, { exclude: t3 });
      return s(o3.results);
    }
    const o2 = [this.view.map.ground];
    t2.map.allLayers.forEach((e3) => {
      e3.type === "integrated-mesh" && o2.push(e3);
    });
    const i2 = await t2.hitTest(e2, { exclude: o2 });
    if (i2.results.length > 0) {
      const e3 = i2.results[0];
      if (r$1$(e3) && e3.type === "graphic" && e3.graphic && (!i2.ground.mapPoint || t2.map.ground.opacity < 1 || i2.ground.distance - i$3f(e3.distance, 0) > -Math.min(3 * i2.ground.distance, t2.viewingMode === "global" ? u$1q(t2.renderCoordsHelper.spatialReference).radius / t2.renderCoordsHelper.unitInMeters : Number.POSITIVE_INFINITY)))
        return e3;
    }
    return null;
  }
  _generateViewHandles(e2) {
    return [e2.on("immediate-click", async (t2) => {
      const o2 = this.state === "active" && this._operationHandle.type === "create";
      if (this.state === "disabled" || o2 || !this.updateOnGraphicClick)
        return;
      this._beginAsyncOperation();
      const i2 = await t2.async(() => this._getFirstHit(n$Y(t2)));
      let a2 = null;
      if (r$1$(i2)) {
        const o3 = i2.graphic;
        this.updateGraphics.includes(o3) || o3.layer === this.layer ? (t2.stopPropagation(), a2 = o3) : e2.type !== "2d" || this._isComponentGraphic(o3) || this.state !== "active" || this.cancel();
      } else
        this.state === "active" && this.cancel();
      r$1$(a2) && !this.updateGraphics.includes(a2) && await this.update([a2], __spreadProps(__spreadValues({}, this.defaultUpdateOptions), { reshapeOptions: __spreadValues({}, this.defaultUpdateOptions.reshapeOptions) })), this._endAsyncOperation();
    }, P$h.WIDGET)];
  }
  async _setupCreateOperation(e2, t2) {
    const o2 = __spreadValues(__spreadValues({ hasZ: this.view.type === "3d" }, this.defaultCreateOptions), t2), i2 = await this._setupDrawGraphicTool(e2, this.view, o2);
    return t$2r(i2) ? null : (this.view.tools.add(i2), this.view.activeTool = i2, this._setupCreateOperationHandle(i2));
  }
  async _setupDrawGraphicTool(e2, t2, o2) {
    if (e2 === "multipoint" && t2.type === "3d")
      return this._logError("sketch:create", "Multipoint geometries are not supported in SceneView."), null;
    const i2 = e2 !== "rectangle", a2 = e2 !== "rectangle";
    this.snappingOptions.enabledToggled = false;
    const r2 = __spreadProps(__spreadValues({ view: t2, mode: e2 === "rectangle" || e2 === "circle" ? "hybrid" : "click" }, o2), { snapToScene: false, geometryType: e2, graphicSymbol: this._getGraphicSymbolFromTool(e2), snappingManager: this._snappingManager, forceUniformSize: a2, centered: i2 });
    return this.view.type === "2d" ? this._makeDrawGraphicTool2D(r2) : this._makeDrawGraphicTool3D(r2);
  }
  async _makeDrawGraphicTool2D(e2) {
    const t2 = await this._requireModule(import("./editingTools.js"));
    return ae(t2) || this.destroyed ? null : new t2.module.DrawGraphicTool2D(__spreadProps(__spreadValues({}, e2), { activeVertexSymbol: this.activeVertexSymbol, regularVerticesSymbol: this.vertexSymbol, activeLineSymbol: this.activeLineSymbol, activeFillSymbol: X(e2.geometryType) ? this.activeFillSymbol : null, tooltipOptions: this.tooltipOptions }));
  }
  async _makeDrawGraphicTool3D(e2) {
    const t2 = await this._requireModule(import("./editingTools2.js").then(function(n2) {
      return n2.e;
    }));
    if (ae(t2) || this.destroyed)
      return null;
    const { elevationInfo: o2 } = this.layer;
    return new t2.module.DrawGraphicTool3D(__spreadProps(__spreadValues({}, e2), { elevationInfo: o2, snapToScene: !r$1$(o2) || o2.mode === "absolute-height", labelOptions: this.labelOptions, tooltipOptions: this.tooltipOptions }));
  }
  _setupCreateOperationHandle(e2) {
    let t2 = null;
    const o2 = e2.forceUniformSize, i2 = e2.centered, a2 = [this.view.on("key-down", (t3) => {
      if (t3.key === e$c.pan)
        t3.stopPropagation(), t3.repeat || (e2.enabled = false);
      else if (t3.key === e$c.complete)
        t3.stopPropagation(), e2.completeCreateOperation();
      else if (t3.key !== e$c.vertexAdd || t3.repeat)
        t3.key === e$c.undo ? (t3.stopPropagation(), r2.undo()) : t3.key === e$c.redo ? (t3.stopPropagation(), r2.redo()) : t3.key !== e$c.snappingToggle || e2.geometryType === "rectangle" || e2.geometryType === "circle" || t3.repeat ? t3.key !== e$c.constraint || e2.geometryType !== "rectangle" && e2.geometryType !== "circle" || t3.repeat ? t3.key === e$c.center && (t3.repeat || (e2.centered = !i2, t3.stopPropagation())) : (e2.forceUniformSize = !o2, t3.stopPropagation()) : (this.snappingOptions.enabledToggled = true, t3.stopPropagation());
      else {
        const o3 = e2.drawOperation.geometryType;
        o3 !== "polyline" && o3 !== "polygon" && o3 !== "multipoint" || (t3.stopPropagation(), e2.drawOperation.commitStagedVertex());
      }
    }, P$h.WIDGET), this.view.on("key-up", (t3) => {
      t3.key === e$c.pan ? e2.enabled = true : t3.key === e$c.snappingToggle && e2.geometryType !== "rectangle" && e2.geometryType !== "circle" ? (this.snappingOptions.enabledToggled = false, t3.stopPropagation()) : t3.key !== e$c.constraint || e2.geometryType !== "rectangle" && e2.geometryType !== "circle" ? t3.key === e$c.center && (e2.centered = i2, t3.stopPropagation()) : (e2.forceUniformSize = o2, t3.stopPropagation());
    }, P$h.WIDGET), e2.on("vertex-add", (o3) => {
      switch (t2 = t$2r(t2) ? "start" : "active", o3.operation) {
        case "apply":
          this.emit("create", { graphic: e$2e(e2.graphic), state: t2, tool: this.activeTool, toolEventInfo: o3, type: "create" });
          break;
        case "undo":
          this._emitUndoEvent({ graphics: [e$2e(e2.graphic)], tool: e2.geometryType });
          break;
        case "redo":
          this._emitRedoEvent({ graphics: [e$2e(e2.graphic)], tool: e2.geometryType });
      }
    }), e2.on("cursor-update", (t3) => {
      e2.drawOperation.numCommittedVertices > 0 && this.emit("create", { graphic: e$2e(e2.graphic), state: "active", tool: this.activeTool, toolEventInfo: { coordinates: t3.vertices[0].coordinates, type: "cursor-update" }, type: "create" });
    }), e2.on("vertex-remove", (t3) => {
      switch (t3.operation) {
        case "apply":
          this.emit("create", { graphic: e$2e(e2.graphic), state: "active", tool: this.activeTool, toolEventInfo: t3, type: "create" });
          break;
        case "undo":
          this._emitUndoEvent({ graphics: [e$2e(e2.graphic)], tool: e2.geometryType });
          break;
        case "redo":
          this._emitRedoEvent({ graphics: [e$2e(e2.graphic)], tool: e2.geometryType });
      }
    }), e2.on("complete", (e3) => {
      this._set("createGraphic", e$2e(e3.graphic)), t2 = "complete", e3.aborted ? r2 && r2.cancel() : r2 && r2.complete();
    }), l$1P(() => this._getGraphicSymbolFromTool(e2.geometryType), (t3) => {
      e2.graphicSymbol = t3;
    })], r2 = new n({ activeComponent: e2, tool: e2.geometryType, type: "create", onEnd: () => {
      var _a2;
      a2.forEach((e3) => e3.remove()), a2.length = 0, (_a2 = this.view.tools) == null ? void 0 : _a2.remove(e2);
    }, undo: () => {
      e2.canUndo && e2.undo();
    }, redo: () => {
      e2.canRedo && e2.redo();
    }, canUndo: () => e2.canUndo, canRedo: () => e2.canRedo });
    return r2;
  }
  _getGraphicSymbolFromTool(e2) {
    switch (e2) {
      case "point":
      case "multipoint":
        return this.pointSymbol;
      case "polyline":
        return this.polylineSymbol;
      case "circle":
      case "rectangle":
      case "polygon":
        return this.polygonSymbol;
      default:
        return null;
    }
  }
  async _setupUpdateOperation(e2, t2) {
    const { layer: o2, view: i2 } = this, a2 = __spreadProps(__spreadValues(__spreadValues({ tool: this._defaultUpdateTool }, this.defaultUpdateOptions), t2), { reshapeOptions: __spreadValues(__spreadValues({}, this.defaultUpdateOptions.reshapeOptions), t2 == null ? void 0 : t2.reshapeOptions) });
    let r2 = a2.tool;
    for (const s2 of e2)
      o2.remove(s2), o2.add(s2);
    if (i2.type === "3d") {
      if (e2.length === 0)
        return null;
      switch (r2) {
        case "move":
          return this._setupMove3DOperation(e2, a2, i2, r2);
        case "reshape": {
          if (e2.length > 1)
            return this._logError("sketch:reshape-multiple", "Reshape operation does not support multiple graphics."), null;
          const t3 = l$b(e2[0]);
          return t3 === P$2.SUPPORTED ? this._setupReshape3DOperation(e2[0], a2, i2) : (this._logError("sketch:reshape", `Reshape operation not supported for provided graphic(s) (${E$6(t3)}).`), null);
        }
        case "transform":
          return this._setupGraphicTransform3DOperation(e2, a2, i2);
      }
    }
    switch (r2) {
      case "move":
        return this._setupMove2DOperation(e2, a2, i2);
      case "reshape": {
        if (e2.length > 1)
          return this._logError("sketch:reshape-multiple", "Reshape operation does not support multiple graphics."), null;
        const t3 = l$b(e2[0]);
        return t3 === P$2.SUPPORTED ? this._setupTransformOrReshape2DOperation(e2, r2, a2, i2) : (this._logError("sketch:reshape", `Reshape operation not supported for provided graphic(s) (${E$6(t3)}).`), null);
      }
      case "transform":
        if (e2.length === 1) {
          const t3 = q$u(e2[0].geometry, "type");
          t3 !== "point" && t3 !== "multipoint" || (r2 = "reshape");
        }
        return this._setupTransformOrReshape2DOperation(e2, r2, a2, i2);
    }
  }
  async _setupMove3DOperation(e2, t2, o2, i$110, a2 = false) {
    for (const l2 of e2) {
      const e3 = i$8(l2);
      if (e3 !== P$2.SUPPORTED)
        return this._logError("sketch:move", `Move operation not supported for provided graphic(s) (${E$6(e3)}).`), null;
    }
    const r2 = await this._requireModule(import("./editingTools2.js").then(function(n3) {
      return n3.e;
    }));
    if (ae(r2))
      return r2;
    const s2 = new r2.module.GraphicMoveTool({ view: o2, enableZ: t2.enableZ, snappingManager: this._snappingManager, tooltipOptions: this.tooltipOptions });
    this.view.tools.add(s2), s2.graphics.addMany(e2), a2 || this.updateGraphics.addMany(e2);
    const n2 = [], p2 = new i({ activeComponent: s2, tool: i$110, type: "update", onEnd: () => {
      var _a2;
      n2.forEach((e3) => e3.remove()), n2.length = 0, (_a2 = this.view.tools) == null ? void 0 : _a2.remove(s2), s2.destroyed || s2.destroy();
    }, undo: () => {
      ee(p2, this.updateGraphics.toArray()), this._emitUndoEvent({ graphics: this.updateGraphics.toArray(), tool: i$110 });
    }, redo: () => {
      te(p2, this.updateGraphics.toArray()), this._emitRedoEvent({ graphics: this.updateGraphics.toArray(), tool: i$110 });
    }, addToSelection: (e3) => {
      this.updateGraphics.push(e3), s2.graphics.push(e3), this.emit("update", { graphics: this.updateGraphics.toArray(), state: "active", aborted: false, tool: this.activeTool, toolEventInfo: { added: [e3], removed: [], type: "selection-change" }, type: "update" });
    }, removeFromSelection: (e3) => {
      const t3 = this.updateGraphics.indexOf(e3);
      p2.history.undo.forEach((e4) => e4.updates.splice(t3, 1)), p2.history.redo.forEach((e4) => e4.updates.splice(t3, 1)), this.updateGraphics.remove(e3), this.emit("update", { graphics: this.updateGraphics.toArray(), state: "active", aborted: false, tool: this.activeTool, toolEventInfo: { added: [], removed: [e3], type: "selection-change" }, type: "update" }), this.updateGraphics.length !== 0 ? s2.graphics.remove(e3) : p2.complete();
    }, toggleTool: async () => {
      if (this.updateGraphics.length !== 1 || t2.toggleToolOnClick === false)
        return;
      if (i$110 !== "transform")
        return;
      const e3 = this.updateGraphics.getItemAt(0);
      if (l$b(e3) !== P$2.SUPPORTED)
        return;
      const a3 = await this._setupReshape3DOperation(e3, t2, o2, true);
      ae(a3) || (p2.onEnd(), p2.destroy(), this._setUpdateOperationHandle(a3, t2));
    } });
    return n2.push(...this._getHandlesForComponent(p2, t2), this.view.on("immediate-click", (e3) => this._getCommonUpdateOperationClickHandlers(p2, e3, t2), P$h.WIDGET), o2.on("key-down", (e3) => {
      this._getCommonUpdateOperationKeyDownHandlers(p2, e3), e3.key === e$c.snappingToggle && (this.snappingOptions.enabledToggled = true, e3.stopPropagation());
    }, P$h.WIDGET), o2.on("key-up", (e3) => {
      e3.key === e$c.snappingToggle && (this.snappingOptions.enabledToggled = false, e3.stopPropagation());
    }, P$h.WIDGET)), p2;
  }
  _setupGraphicTransform3DOperation(e2, t2, o2, i2 = false) {
    if (e2.length === 1 && i$7(e2[0]) === P$2.SUPPORTED) {
      const a2 = e2[0], r2 = a2.geometry;
      if (r$1$(r2) && (r2.type === "point" || r2.type === "mesh"))
        return this._setupPointTransform3DOperation(a2, t2, o2);
      if (r$1$(r2) && (r2.type === "polygon" || r2.type === "polyline"))
        return this._setupPolyTransform3DOperation(a2, t2, o2, i2);
    }
    return this._setupMove3DOperation(e2, t2, o2, "transform", i2);
  }
  async _setupPointTransform3DOperation(e2, t2, o2) {
    const i$110 = "transform", { enableRotation: a2, enableScaling: r2, enableZ: s2 } = t2, n2 = await this._requireModule(import("./editingTools2.js").then(function(n3) {
      return n3.e;
    }));
    if (ae(n2))
      return n2;
    const p2 = new n2.module.GraphicTransformTool({ graphic: e2, view: o2, enableRotation: a2, enableScaling: r2, enableZ: s2, snappingManager: this._snappingManager, tooltipOptions: this.tooltipOptions });
    this.view.tools.add(p2), this.updateGraphics.add(e2);
    const l2 = [], h2 = new i({ activeComponent: p2, tool: i$110, type: "update", onEnd: () => {
      var _a2;
      l2.forEach((e3) => e3.remove()), l2.length = 0, (_a2 = this.view.tools) == null ? void 0 : _a2.remove(p2), p2.destroyed || p2.destroy();
    }, undo: () => {
      ee(h2, this.updateGraphics.toArray()), this._emitUndoEvent({ graphics: this.updateGraphics.toArray(), tool: i$110 });
    }, redo: () => {
      te(h2, this.updateGraphics.toArray()), this._emitRedoEvent({ graphics: this.updateGraphics.toArray(), tool: i$110 });
    }, addToSelection: async (e3) => {
      this.updateGraphics.add(e3), this.emit("update", { graphics: this.updateGraphics.toArray(), state: "active", aborted: false, tool: this.activeTool, toolEventInfo: { added: [e3], removed: [], type: "selection-change" }, type: "update" });
      const i2 = await this._setupMove3DOperation(this.updateGraphics.toArray(), t2, o2, "transform", true);
      ae(i2) || (h2.onEnd(), h2.destroy(), this._setUpdateOperationHandle(i2, t2));
    }, removeFromSelection: (e3) => {
      this.updateGraphics.remove(e3), this.emit("update", { graphics: this.updateGraphics.toArray(), state: "active", aborted: false, tool: this.activeTool, toolEventInfo: { added: [], removed: [e3], type: "selection-change" }, type: "update" }), h2.complete();
    }, toggleTool: () => {
    } });
    return l2.push(...this._getHandlesForComponent(h2, t2), this.view.on("immediate-click", (e3) => this._getCommonUpdateOperationClickHandlers(h2, e3, t2), P$h.WIDGET), o2.on("key-down", (e3) => {
      this._getCommonUpdateOperationKeyDownHandlers(h2, e3), e3.key === e$c.snappingToggle && (this.snappingOptions.enabledToggled = true, e3.stopPropagation());
    }, P$h.WIDGET), o2.on("key-up", (e3) => {
      e3.key === e$c.snappingToggle && (this.snappingOptions.enabledToggled = false, e3.stopPropagation());
    }, P$h.WIDGET)), h2;
  }
  async _setupPolyTransform3DOperation(e2, t2, o2, i$110 = false) {
    const a2 = "transform", { enableRotation: r2, enableScaling: s2, enableZ: n2, preserveAspectRatio: p2 } = t2, l2 = await this._requireModule(import("./editingTools2.js").then(function(n3) {
      return n3.e;
    }));
    if (ae(l2))
      return l2;
    const h2 = new l2.module.ExtentTransformTool({ graphic: e2, view: o2, enableRotation: r2, enableScaling: s2, enableZ: n2, preserveAspectRatio: p2, tooltipOptions: this.tooltipOptions });
    this.view.tools.add(h2), i$110 || this.updateGraphics.add(e2);
    const c2 = [], d2 = new i({ activeComponent: h2, tool: a2, type: "update", onEnd: () => {
      var _a2;
      c2.forEach((e3) => e3.remove()), c2.length = 0, (_a2 = this.view.tools) == null ? void 0 : _a2.remove(h2), h2.destroyed || h2.destroy();
    }, canUndo: () => h2.canUndo, undo: () => {
      h2.undo(), this._emitUndoEvent({ graphics: this.updateGraphics.toArray(), tool: a2 });
    }, canRedo: () => h2.canRedo, redo: () => {
      h2.redo(), this._emitRedoEvent({ graphics: this.updateGraphics.toArray(), tool: a2 });
    }, addToSelection: async (e3) => {
      this.updateGraphics.add(e3), this.emit("update", { graphics: this.updateGraphics.toArray(), state: "active", aborted: false, tool: this.activeTool, toolEventInfo: { added: [e3], removed: [], type: "selection-change" }, type: "update" });
      const i2 = await this._setupMove3DOperation(this.updateGraphics.toArray(), t2, o2, "transform", true);
      ae(i2) || (d2.onEnd(), d2.destroy(), this._setUpdateOperationHandle(i2, t2));
    }, removeFromSelection: (e3) => {
      this.updateGraphics.remove(e3), this.emit("update", { graphics: this.updateGraphics.toArray(), state: "active", aborted: false, tool: this.activeTool, toolEventInfo: { added: [], removed: [e3], type: "selection-change" }, type: "update" }), d2.complete();
    }, toggleTool: async () => {
      if (this.updateGraphics.length !== 1 || t2.toggleToolOnClick === false)
        return;
      const e3 = this.updateGraphics.getItemAt(0);
      if (l$b(e3) !== P$2.SUPPORTED)
        return;
      const i2 = await this._setupReshape3DOperation(e3, t2, o2, true);
      ae(i2) || (d2.onEnd(), d2.destroy(), this._setUpdateOperationHandle(i2, t2));
    } });
    return c2.push(...this._getHandlesForComponent(d2, t2), this.view.on("immediate-click", (e3) => this._getCommonUpdateOperationClickHandlers(d2, e3, t2), P$h.WIDGET), this.view.on("key-down", (e3) => this._getCommonUpdateOperationKeyDownHandlers(d2, e3), P$h.WIDGET), this.view.on("key-down", (e3) => {
      e3.key !== e$c.constraint || e3.repeat || (h2.preserveAspectRatio = !h2.preserveAspectRatio, e3.stopPropagation());
    }, P$h.WIDGET), this.view.on("key-up", (e3) => {
      e3.key === e$c.constraint && (h2.preserveAspectRatio = !h2.preserveAspectRatio, e3.stopPropagation());
    }, P$h.WIDGET)), d2;
  }
  async _setupMove2DOperation(e2, t2, o2) {
    const i$110 = "move";
    this.updateGraphics.addMany(e2), await this._updateSpatialReference(e2);
    const a2 = await this._getGraphicMover(e2, t2, o2);
    if (ae(a2))
      return a2;
    const r2 = new i({ activeComponent: a2, tool: i$110, type: "update", onEnd: () => {
      var _a2;
      this._displayDefaultCursor(), p2.forEach((e3) => e3.remove()), n2.forEach((e3) => e3.remove()), p2 = [], n2 = [], a2.destroy(), (_a2 = this._internalGraphicsLayer) == null ? void 0 : _a2.removeMany([...this.updateGraphics.toArray()]);
    }, undo: () => {
      const e3 = this.updateGraphics.toArray();
      ee(r2, e3), r2.refreshComponent(), this._emitUndoEvent({ graphics: e3, tool: i$110 });
    }, redo: () => {
      const e3 = this.updateGraphics.toArray();
      te(r2, e3), r2.refreshComponent(), this._emitRedoEvent({ graphics: e3, tool: i$110 });
    }, addToSelection: async (e3) => {
      await this._updateSpatialReference(e3), this.updateGraphics.push(e3), a2.graphics = this.updateGraphics.toArray(), this.emit("update", { graphics: this.updateGraphics.toArray(), state: "active", aborted: false, tool: this.activeTool, toolEventInfo: { added: [e3], removed: [], type: "selection-change" }, type: "update" });
    }, removeFromSelection: (e3) => {
      const t3 = this.updateGraphics.indexOf(e3);
      r2.history.undo.forEach((e4) => e4.updates.splice(t3, 1)), r2.history.redo.forEach((e4) => e4.updates.splice(t3, 1)), this.updateGraphics.remove(e3);
      const o3 = this.updateGraphics.toArray();
      this.emit("update", { graphics: o3, state: "active", aborted: false, tool: this.activeTool, toolEventInfo: { added: [], removed: [e3], type: "selection-change" }, type: "update" }), this.updateGraphics.length !== 0 ? a2.graphics = o3 : r2.complete();
    } });
    let s2 = false, n2 = [o2.on("immediate-click", (e3) => this._getCommonUpdateOperationClickHandlers(r2, e3, t2), P$h.WIDGET), o2.on("key-down", (e3) => {
      this._getCommonUpdateOperationKeyDownHandlers(r2, e3), e3.key !== e$c.constraint || e3.repeat || (s2 = true, a2.enableMoveAllGraphics = !a2.enableMoveAllGraphics);
    }, P$h.WIDGET), o2.on("key-up", (e3) => {
      e3.key === e$c.constraint && s2 && (s2 = false, a2.enableMoveAllGraphics = !a2.enableMoveAllGraphics);
    }, P$h.WIDGET)], p2 = this._getHandlesForComponent(r2, t2);
    return r2;
  }
  async _setupReshape3DOperation(e2, t2, o2, i$110 = false) {
    const a2 = "reshape", r2 = await this._requireModule(import("./editingTools2.js").then(function(n3) {
      return n3.e;
    }));
    if (ae(r2))
      return r2;
    this.snappingOptions.enabledToggled = false;
    const s2 = new r2.module.GraphicReshapeTool({ view: o2, graphic: e2, enableZVertex: t2.enableZ && t2.reshapeOptions.vertexOperation === "move", enableZShape: t2.enableZ && t2.reshapeOptions.shapeOperation === "move", enableMoveGraphic: t2.reshapeOptions.shapeOperation === "move" || t2.reshapeOptions.shapeOperation === "move-xy", enableMidpoints: t2.reshapeOptions.edgeOperation === "split", enableEdgeOffset: t2.reshapeOptions.edgeOperation === "offset", snappingManager: this._snappingManager, labelOptions: this.labelOptions, tooltipOptions: this.tooltipOptions });
    o2.tools.add(s2), i$110 || this.updateGraphics.add(e2);
    const n2 = [], p2 = new i({ activeComponent: s2, tool: a2, type: "update", onEnd: () => {
      var _a2;
      n2.forEach((e3) => e3.remove()), n2.length = 0, (_a2 = this.view.tools) == null ? void 0 : _a2.remove(s2), s2.destroyed || s2.destroy();
    }, canUndo: () => s2.canUndo, undo: () => {
      s2.undo(), this._emitUndoEvent({ graphics: this.updateGraphics.toArray(), tool: a2 });
    }, canRedo: () => s2.canRedo, redo: () => {
      s2.redo(), this._emitRedoEvent({ graphics: this.updateGraphics.toArray(), tool: a2 });
    }, addToSelection: async (e3) => {
      this.updateGraphics.add(e3), this.emit("update", { graphics: this.updateGraphics.toArray(), state: "active", aborted: false, tool: this.activeTool, toolEventInfo: { added: [e3], removed: [], type: "selection-change" }, type: "update" });
      const i2 = await this._setupMove3DOperation(this.updateGraphics.toArray(), t2, o2, "transform", true);
      ae(i2) || (p2.onEnd(), p2.destroy(), this._setUpdateOperationHandle(i2, t2));
    }, removeFromSelection: (e3) => {
      this.updateGraphics.remove(e3), this.emit("update", { graphics: this.updateGraphics.toArray(), state: "active", aborted: false, tool: this.activeTool, toolEventInfo: { added: [], removed: [e3], type: "selection-change" }, type: "update" }), p2.complete();
    }, toggleTool: async () => {
      if (t2.toggleToolOnClick === false)
        return;
      const e3 = await this._setupGraphicTransform3DOperation(this.updateGraphics.toArray(), t2, o2, true);
      ae(e3) || (p2.onEnd(), p2.destroy(), this._setUpdateOperationHandle(e3, t2));
    } });
    return n2.push(...this._getHandlesForComponent(p2, t2), o2.on("immediate-click", (e3) => this._getCommonUpdateOperationClickHandlers(p2, e3, t2), P$h.WIDGET), o2.on("key-down", (e3) => {
      this._getCommonUpdateOperationKeyDownHandlers(p2, e3), e3.key === e$c.snappingToggle && (this.snappingOptions.enabledToggled = true, e3.stopPropagation());
    }, P$h.WIDGET), o2.on("key-up", (e3) => {
      e3.key === e$c.snappingToggle && (this.snappingOptions.enabledToggled = false, e3.stopPropagation());
    }, P$h.WIDGET)), p2;
  }
  async _setupTransformOrReshape2DOperation(e2, t2, o2, i$110) {
    this.updateGraphics.addMany(e2), await this._updateSpatialReference(e2);
    const a2 = t2 === "transform" ? await this._getBox(e2, o2, i$110) : await this._getReshape(e2, o2, i$110);
    if (ae(a2))
      return a2;
    const r2 = new i({ activeComponent: a2, type: "update", onEnd: () => {
      n2.forEach((e3) => e3.remove()), s2.forEach((e3) => e3.remove()), n2 = [], s2 = [], r2.activeComponent && !r2.activeComponent.destroyed && r2.activeComponent.destroy(), this._internalGraphicsLayer.removeMany(this.updateGraphics.toArray());
    }, undo: () => {
      ee(r2, this.updateGraphics.toArray()), r2.refreshComponent(), this._emitUndoEvent({ graphics: this.updateGraphics.toArray(), tool: r2.tool });
    }, redo: () => {
      te(r2, this.updateGraphics.toArray()), r2.refreshComponent(), this._emitRedoEvent({ graphics: this.updateGraphics.toArray(), tool: r2.tool });
    }, addToSelection: async (e3) => {
      let t3 = r2.activeComponent;
      if (t3.type === "reshape") {
        const t4 = [...this.updateGraphics, e3];
        this.updateGraphics.removeAll();
        const a3 = await this._setupMove2DOperation(t4, o2, i$110);
        if (ae(a3))
          return;
        r2.onEnd(), r2.destroy(), this._setUpdateOperationHandle(a3, o2);
      } else
        this.updateGraphics.add(e3), t3.graphics = this.updateGraphics.toArray(), t3.refresh(), r2.resetHistory();
      this.emit("update", { graphics: this.updateGraphics.toArray(), state: "active", aborted: false, tool: this.activeTool, toolEventInfo: { added: [e3], removed: [], type: "selection-change" }, type: "update" });
    }, removeFromSelection: async (e3) => {
      const t3 = this.updateGraphics.indexOf(e3);
      r2.history.undo.forEach((e4) => e4.updates.splice(t3, 1)), r2.history.redo.forEach((e4) => e4.updates.splice(t3, 1)), this.updateGraphics.remove(e3);
      const o3 = this.updateGraphics.toArray();
      if (o3.length === 0)
        r2.complete();
      else {
        const e4 = o3[0].geometry;
        o3.length !== 1 || !r$1$(e4) || e4.type !== "point" && e4.type !== "multipoint" ? r2.activeComponent.graphics = o3 : r2.toggleTool();
      }
      this.emit("update", { graphics: o3, state: "active", aborted: false, tool: this.activeTool, toolEventInfo: { added: [], removed: [e3], type: "selection-change" }, type: "update" });
    }, toggleTool: async () => {
      if (this.updateGraphics.length > 1)
        return;
      const e3 = this.updateGraphics.getItemAt(0), t3 = e3.geometry;
      if (r$1$(t3) && (r2.tool === "reshape" && (t3.type === "point" || t3.type === "multipoint") || r2.tool === "transform" && t3.type === "extent"))
        return;
      let a3 = null;
      r2.tool === "transform" ? a3 = await this._getReshape([e3], o2, i$110) : r2.tool === "reshape" && (a3 = await this._getBox([e3], o2, i$110)), ae(a3) || (r2.activeComponent.destroy(), r2.activeComponent = a3, r2.activeComponent && (n2.forEach((e4) => e4.remove()), n2 = this._getHandlesForComponent(r2, o2)));
    } });
    let s2 = [i$110.on("immediate-click", (e3) => this._getCommonUpdateOperationClickHandlers(r2, e3, o2), P$h.WIDGET), i$110.on("key-down", (e3) => {
      if (this._getCommonUpdateOperationKeyDownHandlers(r2, e3), e3.key !== e$c.snappingToggle || e3.repeat || (this.snappingOptions.enabledToggled = true, e3.stopPropagation()), e3.key === e$c.constraint && !e3.repeat && r2) {
        const e4 = r2.activeComponent;
        e4 && e4.type === "box" && (e4.preserveAspectRatio = !e4.preserveAspectRatio);
      }
    }, P$h.WIDGET), i$110.on("key-up", (e3) => {
      var _a2;
      if (e3.key === e$c.snappingToggle && ((_a2 = r2 == null ? void 0 : r2.activeComponent) == null ? void 0 : _a2.type) === "reshape" && (this.snappingOptions.enabledToggled = false, e3.stopPropagation()), e3.key === e$c.constraint && r2) {
        const e4 = r2.activeComponent;
        e4 && e4.type === "box" && (e4.preserveAspectRatio = !e4.preserveAspectRatio);
      }
    }, P$h.WIDGET)], n2 = this._getHandlesForComponent(r2, o2);
    return r2;
  }
  async _getGraphicMover(e2, t2, o2) {
    const { enableMoveAllGraphics: i2 } = t2, a2 = await this._requireModule(import("./GraphicMover.js").then(function(n2) {
      return n2.G;
    }));
    return ae(a2) ? a2 : new a2.module.default({ enableMoveAllGraphics: i2, highlightsEnabled: true, indicatorsEnabled: false, graphics: e2, view: o2, callbacks: { onGraphicMoveStart: ({ dx: e3, dy: t3, graphic: o3 }) => {
      this._displayGrabbingCursor(), this.emit("update", { graphics: this.updateGraphics.toArray(), state: "active", aborted: false, tool: this.activeTool, toolEventInfo: { dx: e3, dy: t3, mover: o3, type: "move-start" }, type: "update" });
    }, onGraphicMove: ({ dx: e3, dy: t3, graphic: o3 }) => this.emit("update", { graphics: this.updateGraphics.toArray(), state: "active", aborted: false, tool: this.activeTool, toolEventInfo: { dx: e3, dy: t3, mover: o3, type: "move" }, type: "update" }), onGraphicMoveStop: ({ dx: e3, dy: t3, graphic: o3 }) => {
      this._displayPointerCursor(), this.emit("update", { graphics: this.updateGraphics.toArray(), state: "active", aborted: false, tool: this.activeTool, toolEventInfo: { dx: e3, dy: t3, mover: o3, type: "move-stop" }, type: "update" });
    }, onGraphicPointerOver: () => this._displayPointerCursor(), onGraphicPointerOut: () => this._displayDefaultCursor() } });
  }
  async _getBox(e2, t2, o2) {
    const { enableRotation: i2, enableScaling: a2, preserveAspectRatio: r2 } = t2, s2 = await this._requireModule(import("./Box.js"));
    return ae(s2) ? s2 : new s2.module.default({ graphics: e2, enableRotation: i2, enableScaling: a2, preserveAspectRatio: r2, layer: this._internalGraphicsLayer, view: o2, tooltipOptions: this.tooltipOptions, callbacks: { onMoveStart: (e3) => this.emit("update", { graphics: this.updateGraphics.toArray(), state: "active", aborted: false, tool: this.activeTool, toolEventInfo: __spreadValues({}, e3), type: "update" }), onMove: (e3) => this.emit("update", { graphics: this.updateGraphics.toArray(), state: "active", aborted: false, tool: this.activeTool, toolEventInfo: __spreadValues({}, e3), type: "update" }), onMoveStop: (e3) => this.emit("update", { graphics: this.updateGraphics.toArray(), state: "active", aborted: false, tool: this.activeTool, toolEventInfo: __spreadValues({}, e3), type: "update" }), onScaleStart: (e3) => this.emit("update", { graphics: this.updateGraphics.toArray(), state: "active", aborted: false, tool: this.activeTool, toolEventInfo: __spreadValues({}, e3), type: "update" }), onScale: (e3) => this.emit("update", { graphics: this.updateGraphics.toArray(), state: "active", aborted: false, tool: this.activeTool, toolEventInfo: __spreadValues({}, e3), type: "update" }), onScaleStop: (e3) => this.emit("update", { graphics: this.updateGraphics.toArray(), state: "active", aborted: false, tool: this.activeTool, toolEventInfo: __spreadValues({}, e3), type: "update" }), onRotateStart: (e3) => this.emit("update", { graphics: this.updateGraphics.toArray(), state: "active", aborted: false, tool: this.activeTool, toolEventInfo: __spreadValues({}, e3), type: "update" }), onRotate: (e3) => this.emit("update", { graphics: this.updateGraphics.toArray(), state: "active", aborted: false, tool: this.activeTool, toolEventInfo: __spreadValues({}, e3), type: "update" }), onRotateStop: (e3) => this.emit("update", { graphics: this.updateGraphics.toArray(), state: "active", aborted: false, tool: this.activeTool, toolEventInfo: __spreadValues({}, e3), type: "update" }) } });
  }
  async _getReshape(e2, t2, o2) {
    var _a2, _b2;
    const i2 = ((_a2 = t2.reshapeOptions) == null ? void 0 : _a2.edgeOperation) === "split", a2 = ((_b2 = t2.reshapeOptions) == null ? void 0 : _b2.shapeOperation) === "move", r2 = await this._requireModule(import("./Reshape.js"));
    return ae(r2) ? r2 : new r2.module.default({ enableMidpoints: i2, enableMovement: a2, graphic: e2[0], layer: this._internalGraphicsLayer, snappingManager: this._snappingManager, tooltipOptions: this.tooltipOptions, view: o2, callbacks: { onReshapeStart: (e3) => this.emit("update", { graphics: this.updateGraphics.toArray(), state: "active", aborted: false, tool: this.activeTool, toolEventInfo: __spreadValues({}, e3), type: "update" }), onReshape: (e3) => this.emit("update", { graphics: this.updateGraphics.toArray(), state: "active", aborted: false, tool: this.activeTool, toolEventInfo: __spreadValues({}, e3), type: "update" }), onReshapeStop: ({ mover: e3, type: t3 }) => this.emit("update", { graphics: this.updateGraphics.toArray(), state: "active", aborted: false, tool: this.activeTool, toolEventInfo: { mover: e3, type: t3 }, type: "update" }), onMoveStart: ({ dx: e3, dy: t3, mover: o3, type: i3 }) => this.emit("update", { graphics: this.updateGraphics.toArray(), state: "active", aborted: false, tool: this.activeTool, toolEventInfo: { dx: e3, dy: t3, mover: o3, type: i3 }, type: "update" }), onMove: ({ dx: e3, dy: t3, mover: o3, type: i3 }) => this.emit("update", { graphics: this.updateGraphics.toArray(), state: "active", aborted: false, tool: this.activeTool, toolEventInfo: { dx: e3, dy: t3, mover: o3, type: i3 }, type: "update" }), onMoveStop: ({ dx: e3, dy: t3, mover: o3, type: i3 }) => this.emit("update", { graphics: this.updateGraphics.toArray(), state: "active", aborted: false, tool: this.activeTool, toolEventInfo: { dx: e3, dy: t3, mover: o3, type: i3 }, type: "update" }), onVertexAdd: ({ added: e3, type: t3, vertices: o3 }) => {
      const i3 = e3.map((e4) => r$1L(e4.geometry));
      this.emit("update", { graphics: this.updateGraphics.toArray(), state: "active", aborted: false, tool: this.activeTool, toolEventInfo: { added: i3, vertices: o3, type: t3 }, type: "update" });
    }, onVertexRemove: ({ removed: e3, type: t3, vertices: o3 }) => {
      const i3 = e3.map((e4) => r$1L(e4.geometry));
      this.emit("update", { graphics: this.updateGraphics.toArray(), state: "active", aborted: false, tool: this.activeTool, toolEventInfo: { removed: i3, vertices: o3, type: t3 }, type: "update" });
    } } });
  }
  _getHandlesForComponent(e2, t2) {
    const o2 = e2.activeComponent;
    switch (o2.type) {
      case "graphic-mover":
        return [o2.on("graphic-click", ({ graphic: t3, viewEvent: o3 }) => {
          var _a2;
          ((_a2 = o3.native) == null ? void 0 : _a2.shiftKey) && (o3.stopPropagation(), e2.removeFromSelection(t3));
        }), o2.on("graphic-move-start", (t3) => e2.addToHistory(ie(t3.allGraphics)))];
      case "box":
        return [o2.on("graphic-click", (o3) => this._onTransformOrReshape2DGraphicClick(e2, t2, o3)), o2.on("move-start", (t3) => e2.addToHistory(ie(t3.graphics))), o2.on("rotate-start", (t3) => e2.addToHistory(ie(t3.graphics))), o2.on("scale-start", (t3) => e2.addToHistory(ie(t3.graphics)))];
      case "reshape":
        return [o2.on("graphic-click", (o3) => this._onTransformOrReshape2DGraphicClick(e2, t2, o3)), o2.on("move-start", (t3) => e2.addToHistory(ie([t3.mover]))), o2.on("reshape-start", (t3) => e2.addToHistory(ie([t3.graphic]))), o2.on("vertex-add", (t3) => e2.addToHistory(ie([t3.oldGraphic]))), o2.on("vertex-remove", (t3) => e2.addToHistory(ie([t3.oldGraphic])))];
      case "move-3d":
        return [o2.on("graphic-move-start", (t3) => {
          e2.addToHistory(ie(t3.allGraphics)), this.emit("update", { graphics: this.updateGraphics.toArray(), state: "active", aborted: false, tool: this.activeTool, toolEventInfo: { dx: 0, dy: 0, mover: t3.allGraphics.length > 0 ? t3.allGraphics[0] : null, type: "move-start" }, type: "update" });
        }), o2.on("graphic-move", (e3) => {
          this.emit("update", { graphics: this.updateGraphics.toArray(), state: "active", aborted: false, tool: this.activeTool, toolEventInfo: { dx: e3.dx, dy: e3.dy, mover: e3.allGraphics.length > 0 ? e3.allGraphics[0] : null, type: "move" }, type: "update" });
        }), o2.on("graphic-move-stop", (e3) => {
          this.emit("update", { graphics: this.updateGraphics.toArray(), state: "active", aborted: false, tool: this.activeTool, toolEventInfo: { dx: 0, dy: 0, mover: e3.allGraphics.length > 0 ? e3.allGraphics[0] : null, type: "move-stop" }, type: "update" });
        }), o2.on("immediate-click", (o3) => {
          o3.shiftKey ? this._toggleSelection([o3.graphic], e2, t2) : e2.toggleTool();
        })];
      case "transform-3d":
        return [o2.on("record-undo", ({ record: t3 }) => {
          e2.addToHistory({ updates: [t3] });
        }), o2.on("graphic-translate-start", (e3) => {
          this.emit("update", { graphics: this.updateGraphics.toArray(), state: "active", aborted: false, tool: this.activeTool, toolEventInfo: { mover: e3.graphic, dx: e3.dxScreen, dy: e3.dyScreen, type: "move-start" }, type: "update" });
        }), o2.on("graphic-translate-stop", (e3) => {
          this.emit("update", { graphics: this.updateGraphics.toArray(), state: "active", aborted: false, tool: this.activeTool, toolEventInfo: { mover: e3.graphic, dx: e3.dxScreen, dy: e3.dyScreen, type: "move-stop" }, type: "update" });
        }), o2.on("graphic-rotate-start", (e3) => {
          this.emit("update", { graphics: this.updateGraphics.toArray(), state: "active", aborted: false, tool: this.activeTool, toolEventInfo: { mover: e3.graphic, angle: e3.angle, type: "rotate-start" }, type: "update" });
        }), o2.on("graphic-rotate-stop", (e3) => {
          this.emit("update", { graphics: this.updateGraphics.toArray(), state: "active", aborted: false, tool: this.activeTool, toolEventInfo: { mover: e3.graphic, angle: e3.angle, type: "rotate-stop" }, type: "update" });
        }), o2.on("graphic-scale-start", (e3) => {
          this.emit("update", { graphics: this.updateGraphics.toArray(), state: "active", aborted: false, tool: this.activeTool, toolEventInfo: { mover: e3.graphic, xScale: e3.xScale, yScale: e3.yScale, type: "scale-start" }, type: "update" });
        }), o2.on("graphic-scale-stop", (e3) => {
          this.emit("update", { graphics: this.updateGraphics.toArray(), state: "active", aborted: false, tool: this.activeTool, toolEventInfo: { mover: e3.graphic, xScale: e3.xScale, yScale: e3.yScale, type: "scale-stop" }, type: "update" });
        }), o2.on("graphic-translate", (e3) => {
          this.emit("update", { graphics: this.updateGraphics.toArray(), state: "active", aborted: false, tool: this.activeTool, toolEventInfo: { mover: e3.graphic, dx: e3.dxScreen, dy: e3.dyScreen, type: "move" }, type: "update" });
        }), o2.on("graphic-rotate", (e3) => {
          this.emit("update", { graphics: this.updateGraphics.toArray(), state: "active", aborted: false, tool: this.activeTool, toolEventInfo: { mover: e3.graphic, angle: e3.angle, type: "rotate" }, type: "update" });
        }), o2.on("graphic-scale", (e3) => {
          this.emit("update", { graphics: this.updateGraphics.toArray(), state: "active", aborted: false, tool: this.activeTool, toolEventInfo: { mover: e3.graphic, xScale: e3.xScale, yScale: e3.yScale, type: "scale" }, type: "update" });
        }), o2.on("immediate-click", (o3) => {
          o3.shiftKey ? this._toggleSelection([o3.graphic], e2, t2) : e2.toggleTool();
        })];
      case "reshape-3d":
        return [o2.on("reshape", (e3) => {
          this.emit("update", { graphics: this.updateGraphics.toArray(), state: "active", aborted: false, tool: this.activeTool, toolEventInfo: e3, type: "update" });
        }), o2.on("move", (e3) => {
          this.emit("update", { graphics: this.updateGraphics.toArray(), state: "active", aborted: false, tool: this.activeTool, toolEventInfo: e3, type: "update" });
        }), o2.on("vertex-add", (e3) => {
          this.emit("update", { graphics: this.updateGraphics.toArray(), state: "active", aborted: false, tool: this.activeTool, toolEventInfo: e3, type: "update" });
        }), o2.on("vertex-remove", (e3) => {
          this.emit("update", { graphics: this.updateGraphics.toArray(), state: "active", aborted: false, tool: this.activeTool, toolEventInfo: e3, type: "update" });
        }), o2.on("immediate-click", (o3) => {
          o3.shiftKey ? this._toggleSelection([o3.graphic], e2, t2) : e2.toggleTool();
        })];
      default:
        return;
    }
  }
  _onTransformOrReshape2DGraphicClick(e2, t2, o2) {
    var _a2;
    const { graphic: i2, viewEvent: a2 } = o2;
    return ((_a2 = a2.native) == null ? void 0 : _a2.shiftKey) && i2.layer === this.layer ? (a2.stopPropagation(), e2.removeFromSelection(i2)) : t2.toggleToolOnClick ? (a2.stopPropagation(), e2.toggleTool()) : void 0;
  }
  _setUpdateOperationHandle(e2, t2) {
    this._operationHandle = e2;
    const o2 = this.view.map;
    this._disablePopup(t2);
    const i2 = () => {
      if (e2 === this._operationHandle) {
        const i3 = this.updateGraphics.toArray(), a2 = this._operationHandle.tool;
        this._operationHandle.destroy(), this._operationHandle = null, this._internalGraphicsLayer.removeMany(this.updateGraphics.toArray()), this.updateGraphics.removeAll(), o2 && o2.remove(this._internalGraphicsLayer), this._restorePopup(t2), this.emit("update", { graphics: i3, state: "complete", aborted: e2.cancelled, tool: a2, toolEventInfo: null, type: "update" });
      }
    };
    e2.on("complete", i2);
  }
  async _getCommonUpdateOperationClickHandlers(e2, t2, o2) {
    const i2 = n$Y(t2), a2 = await t2.async(() => this._getFirstHit(i2));
    if (t$2r(a2))
      return void e2.complete();
    if (t2.native.shiftKey && this._toggleSelection([a2.graphic], e2, o2))
      return void t2.stopPropagation();
    this.updateGraphics.includes(a2.graphic) ? t2.stopPropagation() : e2.complete();
  }
  _toggleSelection(e2, t2, o2) {
    const i2 = !!o2.multipleSelectionEnabled;
    return e2.some((e3) => e3 != null && (!(!i2 || e3.layer !== this.layer) && (this.updateGraphics.includes(e3) ? t2.removeFromSelection(e3) : t2.addToSelection(e3), true)));
  }
  _getCommonUpdateOperationKeyDownHandlers(e2, t2) {
    if (!e2)
      return;
    const o2 = t2.key;
    o2 === e$c.undo && e2.canUndo() ? (t2.stopPropagation(), e2.undo()) : o2 === e$c.redo && e2.canRedo() ? (t2.stopPropagation(), e2.redo()) : o2 === e$c.cancel ? (t2.stopPropagation(), e2.cancel()) : this.allowDeleteKey && e$c.delete.includes(o2) && this._onDeleteKey(t2);
  }
  _onDeleteKey(e2) {
    if (!this._operationHandle || this._operationHandle.type !== "update")
      return;
    const t2 = this.activeComponent, o2 = this.updateGraphics.toArray();
    t$2r(t2) || t2.type === "reshape-3d" || (t2.type !== "reshape" || o2.length === 1 && q$u(o2[0].geometry, "type") === "point") && (e2.stopPropagation(), this.delete());
  }
  _removeDefaultLayer() {
    this._internalGraphicsLayer && (this.view && this.view.map && this.view.map.remove(this._internalGraphicsLayer), this._internalGraphicsLayer = s$2D(this._internalGraphicsLayer));
  }
  _isComponentGraphic(e2) {
    const { activeComponent: t2 } = this;
    return !(!e2 || t$2r(t2)) && (e2.attributes && e2.attributes.esriSketchTool || t2.type === "draw-2d" && t2.graphic === e2 || (t2.type === "box" || t2.type === "reshape") && t2.isUIGraphic(e2));
  }
  _displayPointerCursor() {
    this.view && this.view.container && this.view.cursor !== "pointer" && (this.view.cursor = "pointer");
  }
  _displayGrabbingCursor() {
    this.view && this.view.container && this.view.cursor !== "grabbing" && (this.view.cursor = "grabbing");
  }
  _displayDefaultCursor() {
    this.view && this.view.container && this.view.cursor !== null && (this.view.cursor = null);
  }
  _logError(e2, t2, o2) {
    s$2z.getLogger(this.declaredClass).error(new s$2u(e2, t2, o2));
  }
  async _requireModule(e2) {
    const t2 = new AbortController();
    this._moduleLoaderAbortController = t2;
    const o2 = await e2;
    return this._moduleLoaderAbortController !== t2 || t2.signal.aborted ? { requireError: "aborted" } : { module: o2 };
  }
  _emitUndoEvent(e2) {
    this.emit("undo", __spreadProps(__spreadValues({}, e2), { type: "undo" }));
  }
  _emitRedoEvent(e2) {
    this.emit("redo", __spreadProps(__spreadValues({}, e2), { type: "redo" }));
  }
  _emitDeleteEvent(e2) {
    this.emit("delete", __spreadProps(__spreadValues({}, e2), { type: "delete" }));
  }
  get test() {
    return { operationHandle: this._operationHandle, defaultUpdateOptions: J };
  }
  wait() {
    return j$I(() => !this.updating);
  }
  _beginAsyncOperation() {
    this._numUpdating += 1, this.notifyChange("updating");
  }
  _endAsyncOperation() {
    this._numUpdating -= 1, this.notifyChange("updating");
  }
  _disablePopupEnabled(e2) {
    var _a2;
    return ((_a2 = this.view) == null ? void 0 : _a2.type) !== "3d" || this.updateOnGraphicClick || r$1$(e2) && e2.toggleToolOnClick;
  }
  _disablePopup(e2) {
    if (!this._disablePopupEnabled(e2))
      return;
    const t2 = this.view.popup;
    t2 && t$2r(this._originalAutoOpenEnabled) && (this._originalAutoOpenEnabled = t2.autoOpenEnabled, t2.autoOpenEnabled = false);
  }
  _restorePopup(e2) {
    if (!this._disablePopupEnabled(e2))
      return;
    const t2 = this.view.popup;
    t2 && r$1$(this._originalAutoOpenEnabled) && (t2.autoOpenEnabled = this._originalAutoOpenEnabled, this._originalAutoOpenEnabled = null);
  }
  async _waitViewReady() {
    const e2 = this.view;
    e2 && (p$3M(this._viewReadyAbortController), this._viewReadyAbortController = new AbortController(), await y$1C(j$I(() => e2 == null ? void 0 : e2.ready), this._viewReadyAbortController.signal));
  }
};
function X(e2) {
  return e2 === "polygon" || e2 === "rectangle" || e2 === "circle";
}
function ee(e2, t2) {
  oe("undo", e2.history.undo, e2.history.redo, t2);
}
function te(e2, t2) {
  oe("redo", e2.history.redo, e2.history.undo, t2);
}
function oe(e2, t2, o2, i2) {
  const a2 = t2.pop().updates, r2 = [];
  i2.forEach((t3, o3) => {
    const i3 = a2[o3];
    i3 != null && ("geometry" in i3 && r$1$(i3.geometry) && (r2.push({ geometry: t3.geometry }), t3.geometry = i3.geometry), "symbol" in i3 && r$1$(i3.symbol) && (r2.push({ symbol: t3.symbol }), t3.symbol = i3.symbol), "undo" in i3 && (r2.push(i3), i3[e2](t3)));
  }), o2.push({ updates: r2 });
}
function ie(e2) {
  return { updates: e2.map((e3) => ({ geometry: e3.geometry })) };
}
function ae(e2) {
  return "requireError" in e2 && e2.requireError === "aborted";
}
e$2g([y$1I()], Q.prototype, "updating", null), e$2g([y$1I()], Q.prototype, "_operationHandle", void 0), e$2g([y$1I({ readOnly: true })], Q.prototype, "activeTool", null), e$2g([y$1I()], Q.prototype, "activeFillSymbol", void 0), e$2g([y$1I()], Q.prototype, "activeLineSymbol", void 0), e$2g([y$1I()], Q.prototype, "activeVertexSymbol", void 0), e$2g([y$1I()], Q.prototype, "allowDeleteKey", void 0), e$2g([y$1I({ readOnly: true })], Q.prototype, "createGraphic", null), e$2g([y$1I()], Q.prototype, "defaultCreateOptions", null), e$2g([y$1I()], Q.prototype, "defaultUpdateOptions", null), e$2g([y$1I({ type: c$l, nonNullable: true })], Q.prototype, "labelOptions", void 0), e$2g([y$1I()], Q.prototype, "layer", void 0), e$2g([y$1I({ types: j$J })], Q.prototype, "pointSymbol", void 0), e$2g([y$1I({ types: j$J })], Q.prototype, "polygonSymbol", void 0), e$2g([y$1I({ types: j$J })], Q.prototype, "polylineSymbol", void 0), e$2g([y$1I({ type: n$1, nonNullable: true })], Q.prototype, "snappingOptions", null), e$2g([y$1I()], Q.prototype, "_snappingManager", void 0), e$2g([y$1I({ readOnly: true })], Q.prototype, "state", null), e$2g([y$1I({ type: p$q, nonNullable: true })], Q.prototype, "tooltipOptions", void 0), e$2g([y$1I({ readOnly: true })], Q.prototype, "updateGraphics", void 0), e$2g([y$1I()], Q.prototype, "updateOnGraphicClick", void 0), e$2g([y$1I({ types: j$J })], Q.prototype, "updatePointSymbol", void 0), e$2g([y$1I({ types: j$J })], Q.prototype, "updatePolygonSymbol", void 0), e$2g([y$1I({ types: j$J })], Q.prototype, "updatePolylineSymbol", void 0), e$2g([y$1I({ types: j$J })], Q.prototype, "vertexSymbol", void 0), e$2g([y$1I({ value: null })], Q.prototype, "view", null), Q = e$2g([n$2P("esri.widgets.Sketch.SketchViewModel")], Q);
const re = Q;
const ArcMapPlugin = {
  install(app) {
    app.component("ms-arc-map", ArcMap);
  }
};
const MYKitPlugin = {
  install(app) {
    var _a2, _b2;
    (_a2 = ButtonPlugin.install) == null ? void 0 : _a2.call(ButtonPlugin, app);
    (_b2 = ArcMapPlugin.install) == null ? void 0 : _b2.call(ArcMapPlugin, app);
  }
};
export { $$g as $, A$x as A, f$d as B, C$7 as C, m$a as D, a$1W as E, n$2G as F, p$p as G, c$l as H, I$K as I, p$q as J, h$r as K, l$1P as L, o$2s as M, g$f as N, L$p as O, w$Q as P, P$t as Q, R$4 as R, S$6 as S, E$E as T, m$2q as U, w$J as V, g$U as W, D$m as X, h$1a as Y, Z$c as Z, p$2q as _, a$i as a, i$A as a$, x$H as a0, d$1b as a1, y$13 as a2, j$D as a3, F$r as a4, B$l as a5, M$t as a6, $$d as a7, e$1g as a8, M$u as a9, E$b as aA, v$11 as aB, Y$4 as aC, J$9 as aD, w$4 as aE, k$4 as aF, Wn as aG, k$C as aH, s$o as aI, t$1U as aJ, e$1G as aK, s$1Y as aL, _$K as aM, g$19 as aN, a$2v as aO, u$1S as aP, P$A as aQ, r$1z as aR, c$p as aS, p$37 as aT, l$2e as aU, j$B as aV, u$1u as aW, f$1V as aX, a$2a as aY, G$t as aZ, b$k as a_, ue$4 as aa, m$2f as ab, n$1U as ac, f$1g as ad, An as ae, O$v as af, I$A as ag, p$2y as ah, o$27 as ai, M$7 as aj, k$D as ak, E$P as al, ee$5 as am, Z$e as an, jn as ao, x$U as ap, o$1Q as aq, b$6 as ar, q$5 as as, wn as at, v$7 as au, y$3 as av, hn as aw, se$3 as ax, q$q as ay, j$a as az, g$10 as b, u$G as b$, r$O as b0, v$m as b1, l$T as b2, A$c as b3, s$L as b4, n$S as b5, i$2w as b6, d$1 as b7, c$2f as b8, e$g as b9, f$1E as bA, x$L as bB, i$2c as bC, r$p as bD, t$2l as bE, p$z as bF, f$2 as bG, m$3 as bH, l$r as bI, E$g as bJ, e$W as bK, s$1$ as bL, a$2p as bM, v$h as bN, A$u as bO, r$1y as bP, xn as bQ, x$v as bR, p$2S as bS, Y$f as bT, s$s as bU, r$1X as bV, c$k as bW, o$i as bX, u$k as bY, p$32 as bZ, a$T as b_, p$s as ba, m$2a as bb, O$z as bc, z$G as bd, w$V as be, _$a as bf, n$1v as bg, R$8 as bh, r$1B as bi, l$U as bj, a$31 as bk, w$15 as bl, p$u as bm, n$26 as bn, d$f as bo, t$2g as bp, h$l as bq, F$A as br, D$w as bs, a$2w as bt, j$T as bu, o$I as bv, h$1j as bw, r$12 as bx, i$2x as by, M$C as bz, e$2g as c, X$4 as c$, x$R as c0, h$1T as c1, k$7 as c2, Z$3 as c3, d$1G as c4, n$1x as c5, a$O as c6, S$O as c7, q$7 as c8, y$1o as c9, d$c as cA, C$8 as cB, g$c as cC, U$4 as cD, R$s as cE, g$Y as cF, q$k as cG, U$w as cH, b$R as cI, has as cJ, f$1o as cK, P$6 as cL, j$V as cM, u$g as cN, i$8 as cO, P$2 as cP, v$c as cQ, D$7 as cR, e$d as cS, V$7 as cT, P$8 as cU, t$m as cV, A$7 as cW, H$k as cX, d$18 as cY, E$d as cZ, h$1W as c_, pn as ca, F$x as cb, t$I as cc, s$1H as cd, u$1p as ce, u$1q as cf, pe$2 as cg, Xn as ch, r$1o as ci, e$h as cj, i$X as ck, f$h as cl, h$1e as cm, p$r as cn, f$k as co, o$2m as cp, Z$g as cq, w$U as cr, gn as cs, l$2c as ct, t$k as cu, d$h as cv, G$8 as cw, e$e as cx, h$g as cy, M$8 as cz, d$1H as d, r$N as d$, d$13 as d0, o$l as d1, v$1d as d2, t$J as d3, H$5 as d4, m$9 as d5, l$b as d6, U$r as d7, A$A as d8, r$1s as d9, e$24 as dA, e$1_ as dB, r$l as dC, l$p as dD, C$a as dE, l$2F as dF, l$1o as dG, s$2z as dH, R$7 as dI, _$s as dJ, l$m as dK, u$25 as dL, c$37 as dM, o$21 as dN, u$1O as dO, t$17 as dP, e$1I as dQ, l$1M as dR, l$2i as dS, I$E as dT, y$1l as dU, N$r as dV, Zn as dW, i$2P as dX, r$10 as dY, n$1j as dZ, r$x as d_, b$10 as da, f$1i as db, b$d as dc, n$2Z as dd, i$2R as de, y$1O as df, s$2i as dg, l$2B as dh, s$1N as di, a$2_ as dj, i$v as dk, I$y as dl, Q$5 as dm, o$j as dn, t$p as dp, t$o as dq, s$n as dr, c$o as ds, T$z as dt, w$h as du, j$e as dv, f$x as dw, M$h as dx, e$i as dy, m$1G as dz, e$2e as e, _$b as e$, t$2p as e0, ee$4 as e1, H$9 as e2, z$E as e3, a$2q as e4, n$N as e5, A$q as e6, o$1B as e7, E$l as e8, J$p as e9, e$1a as eA, a$28 as eB, f$21 as eC, c$2M as eD, V$m as eE, X$e as eF, o$2r as eG, e$2d as eH, c$2w as eI, v$19 as eJ, a$2T as eK, C$E as eL, G$l as eM, E$L as eN, S$7 as eO, e$f as eP, y$k as eQ, A$9 as eR, O$9 as eS, F$a as eT, x$b as eU, U$5 as eV, z$a as eW, L$3 as eX, n$u as eY, r$j as eZ, G$a as e_, Z$h as ea, X$f as eb, b$11 as ec, f$g as ed, h$1B as ee, Q$e as ef, F$s as eg, l$2f as eh, g$m as ei, k$b as ej, b$13 as ek, n$2K as el, s$2h as em, u$2f as en, i$20 as eo, s$1r as ep, n$2V as eq, I$f as er, n$2J as es, F$g as et, t$N as eu, f$w as ev, s$2u as ew, d$1D as ex, q$n as ey, c$3t as ez, y$1I as f, vn as f$, T$9 as f0, k$a as f1, V$9 as f2, l$s as f3, J$g as f4, rn as f5, u$1Q as f6, v$b as f7, y$9 as f8, x$8 as f9, h$1o as fA, c$1h as fB, b$X as fC, u$S as fD, S$I as fE, a$1f as fF, c$2o as fG, f$1y as fH, e$R as fI, c$2H as fJ, i$1k as fK, O$c as fL, t$1f as fM, s$1l as fN, P$y as fO, V$n as fP, j$_ as fQ, p$3M as fR, u$2o as fS, d$1t as fT, E$H as fU, t$D as fV, l$1U as fW, i$2n as fX, w$T as fY, D$t as fZ, J$c as f_, w$Z as fa, kt$1 as fb, d$1$ as fc, p$2P as fd, m$1_ as fe, R$w as ff, t$2e as fg, K$g as fh, U$u as fi, s$2v as fj, d$1A as fk, n$1_ as fl, G$q as fm, x$O as fn, U$t as fo, d$23 as fp, i$3d as fq, s$2B as fr, a$30 as fs, g$n as ft, j$I as fu, o$J as fv, a$n as fw, N$i as fx, S$r as fy, a$1z as fz, g$e as g, f$f as g$, nt$3 as g0, t$1s as g1, w$e as g2, c$1_ as g3, f$1z as g4, l$24 as g5, M$D as g6, B$s as g7, q$u as g8, t$1 as g9, t$F as gA, _$k as gB, q$e as gC, F$y as gD, u$1N as gE, e$z as gF, b$b as gG, b$1d as gH, D$u as gI, m$24 as gJ, l$2g as gK, r$1A as gL, d$1X as gM, C$G as gN, G$r as gO, o$S as gP, y$o as gQ, E$Q as gR, t$2n as gS, A$B as gT, m$1f as gU, d$R as gV, T$b as gW, Bn as gX, M$e as gY, b$Y as gZ, m$1O as g_, e$1 as ga, g$l as gb, R$x as gc, h$1w as gd, m$1l as ge, g$R as gf, nt$4 as gg, It$1 as gh, b$N as gi, w$12 as gj, o$1Z as gk, j$P as gl, e$1D as gm, Hn as gn, o$E as go, c$2B as gp, p$t as gq, u$z as gr, w$b as gs, p$3D as gt, g$16 as gu, c$2A as gv, F$w as gw, t$1L as gx, c$2O as gy, a$2x as gz, n$2P as h, P$u as h$, f$1p as h0, b$y as h1, C$n as h2, v$18 as h3, S$M as h4, y$1m as h5, h$1x as h6, R$y as h7, b$$ as h8, P$9 as h9, r$1P as hA, o$29 as hB, v$1c as hC, u$2a as hD, P$D as hE, s$2j as hF, c$3b as hG, B$b as hH, Y$e as hI, p$2w as hJ, r$1Z as hK, Q$h as hL, L$z as hM, n$a as hN, e$E as hO, e$6 as hP, n$Y as hQ, s$l as hR, m$25 as hS, S$H as hT, P$h as hU, h$o as hV, r$1L as hW, h$1I as hX, i$t as hY, a$j as hZ, m$w as h_, p$2T as ha, c$$ as hb, x$z as hc, M$L as hd, m$1Y as he, s$2A as hf, j$M as hg, a$9 as hh, n$f as hi, x$16 as hj, b$1c as hk, a$C as hl, x$15 as hm, e$x as hn, c$O as ho, i$T as hp, t$E as hq, i$U as hr, r$d as hs, e$1i as ht, i$2z as hu, q$b as hv, C$d as hw, B$9 as hx, v$i as hy, f$1w as hz, i$3f as i, f$1B as i$, g$1f as i0, f$1L as i1, e$c as i2, c$2K as i3, m$1a as i4, w$u as i5, Ut as i6, j$Q as i7, o$t as i8, b$19 as i9, y$1t as iA, r$1K as iB, O$d as iC, q$o as iD, U$8 as iE, C$r as iF, ht$1 as iG, at$2 as iH, $$9 as iI, i$M as iJ, U$k as iK, E$I as iL, e$1A as iM, c$35 as iN, l$C as iO, s$1U as iP, l$25 as iQ, f$1H as iR, u$20 as iS, f$3 as iT, g$4 as iU, s$29 as iV, l$2t as iW, O$i as iX, j$k as iY, N$g as iZ, r$L as i_, n$1J as ia, d$i as ib, l$M as ic, D$D as id, l$P as ie, f$v as ig, h$B as ih, M$g as ii, e$n as ij, r$1R as ik, m$L as il, i$1J as im, e$1n as io, u$1w as ip, St as iq, nt$2 as ir, Gt as is, $$5 as it, bt as iu, pt as iv, Rt as iw, R$B as ix, c$32 as iy, et$1 as iz, h$1K as j, s$11 as j$, d$14 as j0, n$1O as j1, e$18 as j2, u$12 as j3, e$k as j4, n$w as j5, U$z as j6, O$b as j7, P$b as j8, R$b as j9, C$c as jA, l$v as jB, a$o as jC, u$l as jD, y$e as jE, ne$1 as jF, oe$2 as jG, m$C as jH, ie$2 as jI, c$3r as jJ, i$C as jK, p$3t as jL, r$17 as jM, s$1n as jN, m$2k as jO, i$1U as jP, e$v as jQ, Gt$1 as jR, o$1N as jS, f$E as jT, c$1u as jU, w$v as jV, b$z as jW, p$1J as jX, c$2x as jY, d$Q as jZ, r$_ as j_, k$c as ja, B$8 as jb, A$a as jc, X$7 as jd, o$p as je, Y$6 as jf, t$2q as jg, Z$8 as jh, M$J as ji, s$2c as jj, u$24 as jk, i$2W as jl, G$v as jm, s$2e as jn, K$7 as jo, g$1e as jp, h$G as jq, n$13 as jr, o$T as js, z$i as jt, i$1c as ju, e$H as jv, a$15 as jw, o$1J as jx, U$7 as jy, w$d as jz, w$6 as k, z$D as k$, y$w as k0, e$Y as k1, t$14 as k2, c$16 as k3, m$12 as k4, d$E as k5, rt$1 as k6, v$14 as k7, tt$3 as k8, lt$1 as k9, s$h as kA, s$g as kB, m$s as kC, s$f as kD, m$1X as kE, x$14 as kF, i$1t as kG, T$o as kH, a$g as kI, g$E as kJ, o$2q as kK, l$1a as kL, o$$ as kM, S$m as kN, l$Z as kO, s$2C as kP, Ze as kQ, o$P as kR, x$o as kS, j$X as kT, _n as kU, s$1L as kV, v$T as kW, e$1b as kX, s$1Q as kY, p$3K as kZ, y$1k as k_, ot$2 as ka, e$15 as kb, Mt as kc, pt$1 as kd, A$G as ke, E$S as kf, r$W as kg, b$j as kh, K$b as ki, J$h as kj, s$H as kk, s$W as kl, e$1t as km, s$2a as kn, K$c as ko, n$p as kp, a$1K as kq, x$A as kr, y$1C as ks, n$n as kt, m$u as ku, s$j as kv, d$W as kw, n$l as kx, u$d as ky, a$f as kz, m$2i as l, a$2k as l$, L$r as l0, Z$f as l1, I$D as l2, t$1I as l3, F$v as l4, J$o as l5, t$2o as l6, Bt as l7, n$2k as l8, t$V as l9, D$z as lA, j$U as lB, O$B as lC, z$H as lD, h$1G as lE, w$X as lF, xe$1 as lG, f$L as lH, b$s as lI, g$x as lJ, C$B as lK, j$E as lL, k$B as lM, t$15 as lN, p$1M as lO, t$1J as lP, i$14 as lQ, en as lR, tn as lS, E$C as lT, s$1G as lU, P$r as lV, a$21 as lW, O$s as lX, sn as lY, mt as lZ, N$v as l_, d$N as la, _$I as lb, Ot as lc, p$3y as ld, P$s as le, C$v as lf, B$n as lg, f$1A as lh, c$2C as li, c$3u as lj, t$1z as lk, h$z as ll, y$j as lm, r$G as ln, n$2l as lo, _$G as lp, g$1m as lq, u$1r as lr, l$J as ls, w$t as lt, y$A as lu, g$C as lv, T$C as lw, v$12 as lx, o$s as ly, W$h as lz, m$2z as m, A$1 as m$, f$19 as m0, C$y as m1, f$1K as m2, c$c as m3, f$m as m4, r$v as m5, u$m as m6, n$y as m7, un as m8, c$P as m9, e$Z as mA, o$2p as mB, p$3z as mC, c$4 as mD, x$4 as mE, y$G as mF, m$1g as mG, m$5 as mH, f$4 as mI, d$2 as mJ, V$2 as mK, T$2 as mL, F$3 as mM, D$3 as mN, N$3 as mO, S$2 as mP, s$e as mQ, t$2 as mR, M$H as mS, y$1x as mT, ln as mU, c$3d as mV, gt$1 as mW, h$15 as mX, r$1b as mY, E$4 as mZ, F$2 as m_, s$2g as ma, l$1Q as mb, o$1_ as mc, j$J as md, r$1H as me, r$K as mf, a$1t as mg, e$C as mh, o$12 as mi, d$M as mj, v$L as mk, p$1S as ml, c$2k as mm, p$2G as mn, a$2g as mo, p$1v as mp, c$1d as mq, v$u as mr, O$k as ms, v$A as mt, f$P as mu, m$2y as mv, s$1x as mw, y$1B as mx, y$Y as my, l$2r as mz, n$2U as n, i$2T as n$, q$1 as n0, z$2 as n1, l$8 as n2, M$4 as n3, v$4 as n4, c$7 as n5, o$5 as n6, a$5 as n7, f$6 as n8, o$23 as n9, j$c as nA, t$1e as nB, q$h as nC, c$1R as nD, d$_ as nE, s$v as nF, ft$1 as nG, h$1i as nH, y$F as nI, w$C as nJ, M$n as nK, _$v as nL, o$1c as nM, d$o as nN, ut$1 as nO, e$14 as nP, T$G as nQ, p$1Z as nR, a$1U as nS, s$1D as nT, m$1n as nU, p$1$ as nV, N$9 as nW, o$2f as nX, n$2O as nY, ht$2 as nZ, mt$2 as n_, Z$j as na, r$1M as nb, i$2Y as nc, p$3L as nd, n$2Y as ne, d$16 as nf, x$B as ng, f$17 as nh, a$1M as ni, it$1 as nj, c$1Q as nk, S$w as nl, c$26 as nm, c$2c as nn, v$t as no, i$1W as np, X$9 as nq, p$3s as nr, ie$6 as ns, te$6 as nt, ae$5 as nu, fe$2 as nv, Ie$1 as nw, A$v as nx, N$c as ny, o$1z as nz, y$1L as o, u$2n as o$, t$2c as o0, proxyCustomElement as o1, H$g as o2, h$1b as o3, Build as o4, createEvent as o5, toAriaBoolean as o6, forceUpdate as o7, queryElementRoots as o8, Host as o9, p$2O as oA, n$1l as oB, t$X as oC, l$X as oD, d$w as oE, t$M as oF, y$q as oG, n$10 as oH, e$2a as oI, p$1e as oJ, S$p as oK, y$y as oL, p$1a as oM, n$1r as oN, p$1q as oO, s$Z as oP, t$2j as oQ, i$18 as oR, t$1P as oS, i$1s as oT, b$v as oU, d$H as oV, j$m as oW, y$B as oX, h$O as oY, L$i as oZ, b$w as o_, isPrimaryPointerButton as oa, focusElement as ob, Fragment as oc, getElementDir as od, getAssetPath as oe, closestElementCrossShadowBoundary as of, j$L as og, p$2u as oh, t$Q as oi, y$d as oj, p$10 as ok, E$f as ol, n$3 as om, N as on, s$r as oo, e as op, j$2 as oq, s$q as or, m$A as os, h$m as ot, a$m as ou, B$i as ov, E$c as ow, setRequestedIcon as ox, getSlotted as oy, e$17 as oz, p$3v as p, I$m as p$, f$20 as p0, u$2b as p1, l$2s as p2, on as p3, G$w as p4, c$1l as p5, a$2u as p6, n$2a as p7, c$1b as p8, o$13 as p9, m$1k as pA, _$t as pB, a$1x as pC, a$1H as pD, n$1s as pE, S$o as pF, mn as pG, b$1a as pH, u$2m as pI, m$23 as pJ, I$F as pK, K$h as pL, t$1Y as pM, ft$2 as pN, n$2W as pO, i$2D as pP, Ct as pQ, a$b as pR, l$2N as pS, o$17 as pT, a$1n as pU, t$16 as pV, r$1U as pW, t$11 as pX, p$1j as pY, p$1o as pZ, r$1w as p_, n$1c as pa, p$1t as pb, a$1a as pc, F$B as pd, x$V as pe, m$15 as pf, j$j as pg, i$1e as ph, w$s as pi, p$1I as pj, l$1g as pk, p$1b as pl, n$17 as pm, j$s as pn, s$1o as po, i$1V as pp, i$2S as pq, s$1j as pr, j$11 as ps, e$L as pt, y$K as pu, j$t as pv, n$1z as pw, M$p as px, T$l as py, N$j as pz, i$3e as q, i$9 as q$, v$z as q0, s$2r as q1, M$z as q2, t$1h as q3, y$C as q4, p$1_ as q5, M$j as q6, F$i as q7, x$u as q8, P$k as q9, s$1I as qA, J$3 as qB, K$4 as qC, o$k as qD, r$k as qE, k$5 as qF, it$2 as qG, d$1I as qH, l$1n as qI, f$7 as qJ, x$q as qK, n$1e as qL, m$1t as qM, s$1g as qN, x$t as qO, n$2D as qP, L$x as qQ, S$P as qR, _$r as qS, MYKitPlugin as qT, ButtonPlugin as qU, Button as qV, ArcMapPlugin as qW, ArcMap as qX, re as qY, c$d as qZ, p$8 as q_, L$h as qa, O$j as qb, v$y as qc, E$s as qd, I$l as qe, T$g as qf, j$l as qg, M$k as qh, D$e as qi, G$i as qj, E$7 as qk, y$6 as ql, z$6 as qm, a$2$ as qn, H$j as qo, C$x as qp, a$2j as qq, y$1j as qr, u$1T as qs, u$U as qt, i$F as qu, I$n as qv, S$L as qw, g$1j as qx, O$E as qy, r$1O as qz, r$1$ as r, print as r0, find as r1, n$b as r2, l$d as r3, geometryService as r4, F$6 as r5, geometryEngine as r6, geoprocessor as r7, identify as r8, query as r9, L$c as ra, _e as rb, l$j as rc, request as rd, visualVariableUtils as re, DictionaryLoader as rf, FeatureLayer as rg, MapImageLayer as rh, WhereClause as ri, s$2D as s, n$2v as t, u$26 as u, v$15 as v, w$_ as w, t$2r as x, y$1f as y, y$1v as z };
