var U=Object.defineProperty,z=Object.defineProperties;var B=Object.getOwnPropertyDescriptors;var I=Object.getOwnPropertySymbols;var V=Object.prototype.hasOwnProperty,k=Object.prototype.propertyIsEnumerable;var N=(t,e,r)=>e in t?U(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,F=(t,e)=>{for(var r in e||(e={}))V.call(e,r)&&N(t,r,e[r]);if(I)for(var r of I(e))k.call(e,r)&&N(t,r,e[r]);return t},S=(t,e)=>z(t,B(e));import{aq as o,ar as a,lx as q,ly as G,lz as J,as as v,dC as C,jI as L,lA as K,lB as b,by as E,A as s,x as H,dB as g,bt as c}from"./vendor.f59460b9.js";var y;const j=new WeakMap;let Q=0,h=y=class extends C{constructor(t){super(t),this.wrap="repeat"}get url(){return this._get("url")||null}set url(t){this._set("url",t),t&&this._set("data",null)}get data(){return this._get("data")||null}set data(t){this._set("data",t),t&&this._set("url",null)}writeData(t,e,r,n){if(t instanceof HTMLImageElement){const i={type:"image-element",src:L(t.src,n),crossOrigin:t.crossOrigin};e[r]=i}else if(t instanceof HTMLCanvasElement){const i=t.getContext("2d").getImageData(0,0,t.width,t.height),m={type:"canvas-element",imageData:this._encodeImageData(i)};e[r]=m}else if(t instanceof HTMLVideoElement){const i={type:"video-element",src:L(t.src,n),autoplay:t.autoplay,loop:t.loop,muted:t.muted,crossOrigin:t.crossOrigin,preload:t.preload};e[r]=i}else{const i={type:"image-data",imageData:this._encodeImageData(t)};e[r]=i}}readData(t){switch(t.type){case"image-element":{const e=new Image;return e.src=t.src,e.crossOrigin=t.crossOrigin,e}case"canvas-element":{const e=this._decodeImageData(t.imageData),r=document.createElement("canvas");return r.width=e.width,r.height=e.height,r.getContext("2d").putImageData(e,0,0),r}case"image-data":return this._decodeImageData(t.imageData);case"video-element":{const e=document.createElement("video");return e.src=t.src,e.crossOrigin=t.crossOrigin,e.autoplay=t.autoplay,e.loop=t.loop,e.muted=t.muted,e.preload=t.preload,e}default:return}}get transparent(){const t=this.data,e=this.url;if(t instanceof HTMLCanvasElement)return this._imageDataContainsTransparent(t.getContext("2d").getImageData(0,0,t.width,t.height));if(t instanceof ImageData)return this._imageDataContainsTransparent(t);if(e){const r=e.substr(e.length-4,4).toLowerCase(),n=e.substr(0,15).toLocaleLowerCase();if(r===".png"||n==="data:image/png;")return!0}return!1}set transparent(t){this._overrideIfSome("transparent",t)}get contentHash(){const t=typeof this.wrap=="string"?this.wrap:typeof this.wrap=="object"?`${this.wrap.horizontal}/${this.wrap.vertical}`:"",e=(r="")=>`d:${r},t:${this.transparent},w:${t}`;return this.url!=null?e(this.url):this.data!=null?this.data instanceof HTMLImageElement||this.data instanceof HTMLVideoElement?e(this.data.src):(j.has(this.data)||j.set(this.data,++Q),e(j.get(this.data))):e()}clone(){const t={url:this.url,data:this.data,wrap:this._cloneWrap()};return new y(t)}cloneWithDeduplication(t){const e=t.get(this);if(e)return e;const r=this.clone();return t.set(this,r),r}_cloneWrap(){return typeof this.wrap=="string"?this.wrap:{horizontal:this.wrap.horizontal,vertical:this.wrap.vertical}}_encodeImageData(t){let e="";for(let r=0;r<t.data.length;r++)e+=String.fromCharCode(t.data[r]);return{data:btoa(e),width:t.width,height:t.height}}_decodeImageData(t){const e=atob(t.data),r=new Uint8ClampedArray(e.length);for(let n=0;n<e.length;n++)r[n]=e.charCodeAt(n);return K(r,t.width,t.height)}_imageDataContainsTransparent(t){for(let e=3;e<t.data.length;e+=4)if(t.data[e]!==255)return!0;return!1}static from(t){return typeof t=="string"?new y({url:t}):t instanceof HTMLImageElement||t instanceof HTMLCanvasElement||t instanceof ImageData||t instanceof HTMLVideoElement?new y({data:t}):b(y,t)}};o([a({type:String,json:{write:q}})],h.prototype,"url",null),o([a({json:{write:{overridePolicy(){return{enabled:!this.url}}}}}),a()],h.prototype,"data",null),o([G("data")],h.prototype,"writeData",null),o([J("data")],h.prototype,"readData",null),o([a({type:Boolean,json:{write:{overridePolicy(){return{enabled:this._isOverridden("transparent")}}}}})],h.prototype,"transparent",null),o([a({json:{write:!0}})],h.prototype,"wrap",void 0),o([a({readOnly:!0})],h.prototype,"contentHash",null),h=y=o([v("esri.geometry.support.MeshTexture")],h);const w=h;var M;let p=M=class extends C{constructor(t){super(t),this.color=null,this.colorTexture=null,this.normalTexture=null,this.alphaMode="auto",this.alphaCutoff=.5,this.doubleSided=!0}clone(){return this.cloneWithDeduplication(null,new Map)}cloneWithDeduplication(t,e){const r=s(t)?t.get(this):null;if(r)return r;const n=new M(this.clonePropertiesWithDeduplication(e));return s(t)&&t.set(this,n),n}clonePropertiesWithDeduplication(t){return{color:s(this.color)?this.color.clone():null,colorTexture:s(this.colorTexture)?this.colorTexture.cloneWithDeduplication(t):null,normalTexture:s(this.normalTexture)?this.normalTexture.cloneWithDeduplication(t):null,alphaMode:this.alphaMode,alphaCutoff:this.alphaCutoff,doubleSided:this.doubleSided,colorTextureTransform:s(this.colorTextureTransform)?this.colorTextureTransform:null,normalTextureTransform:s(this.normalTextureTransform)?this.normalTextureTransform:null}}};o([a({type:E,json:{write:!0}})],p.prototype,"color",void 0),o([a({type:w,json:{write:!0}})],p.prototype,"colorTexture",void 0),o([a({type:w,json:{write:!0}})],p.prototype,"normalTexture",void 0),o([a({nonNullable:!0,json:{write:!0}})],p.prototype,"alphaMode",void 0),o([a({nonNullable:!0,json:{write:!0}})],p.prototype,"alphaCutoff",void 0),o([a({nonNullable:!0,json:{write:!0}})],p.prototype,"doubleSided",void 0),o([a()],p.prototype,"colorTextureTransform",void 0),o([a()],p.prototype,"normalTextureTransform",void 0),p=M=o([v("esri.geometry.support.MeshMaterial")],p);const A=p;var W;let l=W=class extends A{constructor(t){super(t),this.emissiveColor=null,this.emissiveTexture=null,this.occlusionTexture=null,this.metallic=1,this.roughness=1,this.metallicRoughnessTexture=null}clone(){return this.cloneWithDeduplication(null,new Map)}cloneWithDeduplication(t,e){const r=s(t)?t.get(this):null;if(r)return r;const n=new W(this.clonePropertiesWithDeduplication(e));return s(t)&&t.set(this,n),n}clonePropertiesWithDeduplication(t){return S(F({},super.clonePropertiesWithDeduplication(t)),{emissiveColor:s(this.emissiveColor)?this.emissiveColor.clone():null,emissiveTexture:s(this.emissiveTexture)?this.emissiveTexture.cloneWithDeduplication(t):null,occlusionTexture:s(this.occlusionTexture)?this.occlusionTexture.cloneWithDeduplication(t):null,metallic:this.metallic,roughness:this.roughness,metallicRoughnessTexture:s(this.metallicRoughnessTexture)?this.metallicRoughnessTexture.cloneWithDeduplication(t):null,occlusionTextureTransform:s(this.occlusionTextureTransform)?this.occlusionTextureTransform:null,emissiveTextureTransform:s(this.emissiveTextureTransform)?this.emissiveTextureTransform:null,metallicRoughnessTextureTransform:s(this.metallicRoughnessTextureTransform)?this.metallicRoughnessTextureTransform:null})}};o([a({type:E,json:{write:!0}})],l.prototype,"emissiveColor",void 0),o([a({type:w,json:{write:!0}})],l.prototype,"emissiveTexture",void 0),o([a({type:w,json:{write:!0}})],l.prototype,"occlusionTexture",void 0),o([a({type:Number,nonNullable:!0,json:{write:!0},range:{min:0,max:1}})],l.prototype,"metallic",void 0),o([a({type:Number,nonNullable:!0,json:{write:!0},range:{min:0,max:1}})],l.prototype,"roughness",void 0),o([a({type:w,json:{write:!0}})],l.prototype,"metallicRoughnessTexture",void 0),o([a()],l.prototype,"occlusionTextureTransform",void 0),o([a()],l.prototype,"emissiveTextureTransform",void 0),o([a()],l.prototype,"metallicRoughnessTextureTransform",void 0),l=W=o([v("esri.geometry.support.MeshMaterialMetallicRoughness")],l);const X=l;var $;const R="esri.geometry.support.MeshVertexAttributes",f=H.getLogger(R);let u=$=class extends C{constructor(t){super(t),this.color=null,this.position=new Float64Array(0),this.uv=null,this.normal=null,this.tangent=null}castColor(t){return T(t,Uint8Array,[Uint8ClampedArray],{loggerTag:".color=",stride:4},f)}castPosition(t){return t&&t instanceof Float32Array&&f.warn(".position=","Setting position attribute from a Float32Array may cause precision problems. Consider storing data in a Float64Array or a regular number array"),T(t,Float64Array,[Float32Array],{loggerTag:".position=",stride:3},f)}castUv(t){return T(t,Float32Array,[Float64Array],{loggerTag:".uv=",stride:2},f)}castNormal(t){return T(t,Float32Array,[Float64Array],{loggerTag:".normal=",stride:3},f)}castTangent(t){return T(t,Float32Array,[Float64Array],{loggerTag:".tangent=",stride:4},f)}clone(){const t={position:c(this.position),uv:c(this.uv),normal:c(this.normal),tangent:c(this.tangent),color:c(this.color)};return new $(t)}clonePositional(){const t={position:c(this.position),normal:c(this.normal),tangent:c(this.tangent),uv:this.uv,color:this.color};return new $(t)}};function _(t,e,r,n){const{loggerTag:i,stride:m}=e;return t.length%m!=0?(n.error(i,`Invalid array length, expected a multiple of ${m}`),new r([])):t}function T(t,e,r,n,i){if(!t)return t;if(t instanceof e)return _(t,n,e,i);for(const m of r)if(t instanceof m)return _(new e(t),n,e,i);if(Array.isArray(t))return _(new e(t),n,e,i);{const m=r.map(P=>`'${P.name}'`);return i.error(`Failed to set property, expected one of ${m}, but got ${t.constructor.name}`),new e([])}}function x(t,e,r){e[r]=Y(t)}function Y(t){const e=new Array(t.length);for(let r=0;r<t.length;r++)e[r]=t[r];return e}o([a({json:{write:x}})],u.prototype,"color",void 0),o([g("color")],u.prototype,"castColor",null),o([a({nonNullable:!0,json:{write:x}})],u.prototype,"position",void 0),o([g("position")],u.prototype,"castPosition",null),o([a({json:{write:x}})],u.prototype,"uv",void 0),o([g("uv")],u.prototype,"castUv",null),o([a({json:{write:x}})],u.prototype,"normal",void 0),o([g("normal")],u.prototype,"castNormal",null),o([a({json:{write:x}})],u.prototype,"tangent",void 0),o([g("tangent")],u.prototype,"castTangent",null),u=$=o([v(R)],u);var D;const O="esri.geometry.support.MeshComponent",Z=H.getLogger(O);let d=D=class extends C{constructor(t){super(t),this.faces=null,this.material=null,this.shading="source",this.trustSourceNormals=!1}static from(t){return b(D,t)}castFaces(t){return T(t,Uint32Array,[Uint16Array],{loggerTag:".faces=",stride:3},Z)}castMaterial(t){return b(t&&typeof t=="object"&&("metallic"in t||"roughness"in t||"metallicRoughnessTexture"in t)?X:A,t)}clone(){return new D({faces:c(this.faces),shading:this.shading,material:c(this.material),trustSourceNormals:this.trustSourceNormals})}cloneWithDeduplication(t,e){const r={faces:c(this.faces),shading:this.shading,material:this.material?this.material.cloneWithDeduplication(t,e):null,trustSourceNormals:this.trustSourceNormals};return new D(r)}};o([a({json:{write:!0}})],d.prototype,"faces",void 0),o([g("faces")],d.prototype,"castFaces",null),o([a({type:A,json:{write:!0}})],d.prototype,"material",void 0),o([g("material")],d.prototype,"castMaterial",null),o([a({type:String,json:{write:!0}})],d.prototype,"shading",void 0),o([a({type:Boolean})],d.prototype,"trustSourceNormals",void 0),d=D=o([v(O)],d);const rt=d;export{X as c,rt as g,w as m,u as p};
