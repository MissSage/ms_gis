import{S as an,gm as j,aV as x,g2 as y,g3 as O,g8 as u,am as P,fX as rn,jF as cn,jG as V,aP as l,fZ as N,g9 as a,g6 as p,ao as M,jH as un,jb as v,hg as gn,fN as bn,aO as m,jI as fn,i2 as ln,jf as pn,g7 as d,jJ as dn,ij as $n,jK as C,g4 as _,ib as hn,gA as E,hu as mn,j5 as In,go as $,jL as jn,hN as Pn,jM as F,gp as G,fY as R,gl as X}from"./vendor.faf54504.js";import{v as Nn,A as Z,M as Mn}from"./lineSegment.63b102f2.js";const Y=an.getLogger("esri.views.3d.support.geometryUtils.boundedPlane");class vn{constructor(){this.plane=j(),this.origin=P(),this.basis1=P(),this.basis2=P()}}function I(n=tn){return{plane:j(n.plane),origin:O(n.origin),basis1:O(n.basis1),basis2:O(n.basis2)}}function An(n,s,i){const e=Hn.get();return e.origin=n,e.basis1=s,e.basis2=i,e.plane=rn(0,0,0,0),w(e),e}function A(n,s=I()){return k(n.origin,n.basis1,n.basis2,s)}function wn(n,s){u(s.origin,n.origin),u(s.basis1,n.basis1),u(s.basis2,n.basis2),cn(s.plane,n.plane)}function k(n,s,i,e=I()){return u(e.origin,n),u(e.basis1,s),u(e.basis2,i),w(e),qn(e,"fromValues()"),e}function w(n){V(n.basis2,n.basis1,n.origin,n.plane)}function J(n,s,i){n!==i&&A(n,i);const e=l(a.get(),f(n),s);return p(i.origin,i.origin,e),i.plane[3]-=s,i}function Sn(n,s,i){return K(s,i),J(i,z(n,n.origin),i),i}function K(n,s=I()){const i=(n[2]-n[0])/2,e=(n[3]-n[1])/2;return M(s.origin,n[0]+i,n[1]+e,0),M(s.basis1,i,0,0),M(s.basis2,0,e,0),un(0,0,1,0,s.plane),s}function L(n,s,i){return!!gn(n.plane,s,i)&&sn(n,i)}function Tn(n,s,i){if(L(n,s,i))return i;const e=W(n,s,a.get());return p(i,s.origin,l(a.get(),s.direction,bn(s.origin,e)/m(s.direction))),i}function W(n,s,i){const e=S.get();on(n,s,e,S.get());let o=Number.POSITIVE_INFINITY;for(const t of U){const r=H(n,t,T.get()),g=a.get();if(fn(e,r,g)){const c=ln(a.get(),s.origin,g),b=Math.abs(pn(d(s.direction,c)));b<o&&(o=b,u(i,g))}}return o===Number.POSITIVE_INFINITY?D(n,s,i):i}function D(n,s,i){if(L(n,s,i))return i;const e=S.get(),o=S.get();on(n,s,e,o);let t=Number.POSITIVE_INFINITY;for(const r of U){const g=H(n,r,T.get()),c=a.get();if(dn(e,g,c)){const b=$n(s,c);if(!C(o,c))continue;b<t&&(t=b,u(i,c))}}return q(n,s.origin)<t&&Q(n,s.origin,i),i}function Q(n,s,i){const e=hn(n.plane,s,a.get()),o=Z(en(n,n.basis1),e,-1,1,a.get()),t=Z(en(n,n.basis2),e,-1,1,a.get());return _(i,p(a.get(),o,t),n.origin),i}function nn(n,s,i){const{origin:e,basis1:o,basis2:t}=n,r=_(a.get(),s,e),g=v(o,r),c=v(t,r),b=v(f(n),r);return M(i,g,c,b)}function q(n,s){const i=nn(n,s,a.get()),{basis1:e,basis2:o}=n,t=m(e),r=m(o),g=Math.max(Math.abs(i[0])-t,0),c=Math.max(Math.abs(i[1])-r,0),b=i[2];return g*g+c*c+b*b}function xn(n,s){return Math.sqrt(q(n,s))}function yn(n,s){let i=Number.NEGATIVE_INFINITY;for(const e of U){const o=H(n,e,T.get()),t=Mn(o,s);t>i&&(i=t)}return Math.sqrt(i)}function On(n,s){return C(n.plane,s)&&sn(n,s)}function Vn(n,s,i,e){return Ln(n,i,e)}function z(n,s){const i=-n.plane[3];return v(f(n),s)-i}function _n(n,s,i,e){const o=z(n,s),t=l(zn,f(n),i-o);return p(e,s,t),e}function En(n,s){return E(n.basis1,s.basis1)&&E(n.basis2,s.basis2)&&E(n.origin,s.origin)}function Fn(n,s,i){return n!==i&&A(n,i),mn(h,s),In(h,h),$(i.basis1,n.basis1,h),$(i.basis2,n.basis2,h),$(N(i.plane),N(n.plane),h),$(i.origin,n.origin,s),jn(i.plane,i.plane,i.origin),i}function Yn(n,s,i,e){return n!==e&&A(n,e),Pn(B,s,i),$(e.basis1,n.basis1,B),$(e.basis2,n.basis2,B),w(e),e}function f(n){return N(n.plane)}function Ln(n,s,i){switch(s){case F.X:u(i,n.basis1),G(i,i);break;case F.Y:u(i,n.basis2),G(i,i);break;case F.Z:u(i,f(n))}return i}function sn(n,s){const i=_(a.get(),s,n.origin),e=R(n.basis1),o=R(n.basis2),t=d(n.basis1,i),r=d(n.basis2,i);return-t-e<0&&t-e<0&&-r-o<0&&r-o<0}function en(n,s){const i=T.get();return u(i.origin,n.origin),u(i.vector,s),i}function H(n,s,i){const{basis1:e,basis2:o,origin:t}=n,r=l(a.get(),e,s.origin[0]),g=l(a.get(),o,s.origin[1]);p(i.origin,r,g),p(i.origin,i.origin,t);const c=l(a.get(),e,s.direction[0]),b=l(a.get(),o,s.direction[1]);return l(i.vector,p(c,c,b),2),i}function qn(n,s){Math.abs(d(n.basis1,n.basis2)/(m(n.basis1)*m(n.basis2)))>1e-6&&Y.warn(s,"Provided basis vectors are not perpendicular"),Math.abs(d(n.basis1,f(n)))>1e-6&&Y.warn(s,"Basis vectors and plane normal are not perpendicular"),Math.abs(-d(f(n),n.origin)-n.plane[3])>1e-6&&Y.warn(s,"Plane offset is not consistent with plane origin")}function on(n,s,i,e){const o=f(n);V(o,s.direction,s.origin,i),V(N(i),o,s.origin,e)}const tn={plane:j(),origin:x(0,0,0),basis1:x(1,0,0),basis2:x(0,1,0)},S=new y(j),T=new y(Nn),zn=P(),Hn=new y(()=>I()),U=[{origin:[-1,-1],direction:[1,0]},{origin:[1,-1],direction:[0,1]},{origin:[1,1],direction:[-1,0]},{origin:[-1,1],direction:[0,-1]}],h=X(),B=X();Object.freeze(Object.defineProperty({__proto__:null,BoundedPlaneClass:vn,create:I,wrap:An,copy:A,copyWithoutVerify:wn,fromValues:k,updateUnboundedPlane:w,elevate:J,setExtent:Sn,fromAABoundingRect:K,intersectRay:L,intersectRayClosestSilhouette:Tn,closestPointOnSilhouette:W,closestPoint:D,projectPoint:Q,projectPointLocal:nn,distance2:q,distance:xn,distanceToSilhouette:yn,extrusionContainsPoint:On,axisAt:Vn,altitudeAt:z,setAltitudeAt:_n,equals:En,transform:Fn,rotate:Yn,normal:f,UP:tn},Symbol.toStringTag,{value:"Module"}));export{I as G,w as H,K as Q,A as X,xn as e};
