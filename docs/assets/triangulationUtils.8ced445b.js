import{x as I}from"./earcut.afc1d357.js";import{f1 as L}from"./vendor.faf54504.js";import{n as m}from"./deduplicate.1d8fe9a7.js";function W(n){const f=O(n.rings,n.hasZ,E.CCW_IS_HOLE),u=new Array;let e=0,o=0;for(const t of f.polygons){const c=t.count,l=t.index,d=new Float64Array(f.position.buffer,3*l*f.position.BYTES_PER_ELEMENT,3*c),p=t.holeIndices.map(h=>h-l),i=new Uint32Array(I(d,p,3));u.push({position:d,faces:i}),e+=d.length,o+=i.length}const s=x(u,e,o),a=m(s.position.buffer,6,{originalIndices:s.faces});return s.position=new Float64Array(a.buffer),s.faces=a.indices,s}function x(n,f,u){if(n.length===1)return n[0];const e=new Float64Array(f),o=new Uint32Array(u);let s=0,a=0,t=0;for(const c of n){for(let l=0;l<c.position.length;l++)e[s++]=c.position[l];for(let l=0;l<c.faces.length;l++)o[a++]=c.faces[l]+t;t=s/3}return{position:e,faces:o}}function O(n,f,u){const e=n.length,o=new Array(e),s=new Array(e),a=new Array(e);let t=0,c=0,l=0,d=0;for(let h=0;h<e;++h)d+=n[h].length;const p=new Float64Array(3*d);let i=0;for(let h=e-1;h>=0;h--){const r=n[h],_=u===E.CCW_IS_HOLE&&N(r);if(_&&e!==1)o[t++]=r;else{let C=r.length;for(let g=0;g<t;++g)C+=o[g].length;const y={index:i,pathLengths:new Array(t+1),count:C,holeIndices:new Array(t)};y.pathLengths[0]=r.length,r.length>0&&(a[l++]={index:i,count:r.length}),i=_?A(r,r.length-1,-1,p,i,r.length,f):A(r,0,1,p,i,r.length,f);for(let g=0;g<t;++g){const w=o[g];y.holeIndices[g]=i,y.pathLengths[g+1]=w.length,w.length>0&&(a[l++]={index:i,count:w.length}),i=A(w,0,1,p,i,w.length,f)}t=0,y.count>0&&(s[c++]=y)}}for(let h=0;h<t;++h){const r=o[h];r.length>0&&(a[l++]={index:i,count:r.length}),i=A(r,0,1,p,i,r.length,f)}return s.length=c,a.length=l,{position:p,polygons:s,outlines:a}}function A(n,f,u,e,o,s,a){o*=3;for(let t=0;t<s;++t){const c=n[f];e[o++]=c[0],e[o++]=c[1],e[o++]=a?c[2]:0,f+=u}return o/3}function N(n){return!L(n,!1,!1)}var E;(function(n){n[n.NONE=0]="NONE",n[n.CCW_IS_HOLE=1]="CCW_IS_HOLE"})(E||(E={}));export{E as c,O as l,W as o};
