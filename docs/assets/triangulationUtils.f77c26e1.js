import{x as I}from"./earcut.afc1d357.js";import{eX as L}from"./vendor.1bde3be2.js";import{n as m}from"./deduplicate.844117a0.js";function H(n){const c=O(n.rings,n.hasZ,E.CCW_IS_HOLE),u=new Array;let t=0,o=0;for(const e of c.polygons){const f=e.count,l=e.index,d=new Float64Array(c.position.buffer,3*l*c.position.BYTES_PER_ELEMENT,3*f),p=e.holeIndices.map(h=>h-l),i=new Uint32Array(I(d,p,3));u.push({position:d,faces:i}),t+=d.length,o+=i.length}const s=x(u,t,o),a=m(s.position.buffer,6,{originalIndices:s.faces});return s.position=new Float64Array(a.buffer),s.faces=a.indices,s}function x(n,c,u){if(n.length===1)return n[0];const t=new Float64Array(c),o=new Uint32Array(u);let s=0,a=0,e=0;for(const f of n){for(let l=0;l<f.position.length;l++)t[s++]=f.position[l];for(let l=0;l<f.faces.length;l++)o[a++]=f.faces[l]+e;e=s/3}return{position:t,faces:o}}function O(n,c,u){const t=n.length,o=new Array(t),s=new Array(t),a=new Array(t);let e=0,f=0,l=0,d=0;for(let h=0;h<t;++h)d+=n[h].length;const p=new Float64Array(3*d);let i=0;for(let h=t-1;h>=0;h--){const r=n[h],_=u===E.CCW_IS_HOLE&&b(r);if(_&&t!==1)o[e++]=r;else{let C=r.length;for(let g=0;g<e;++g)C+=o[g].length;const y={index:i,pathLengths:new Array(e+1),count:C,holeIndices:new Array(e)};y.pathLengths[0]=r.length,r.length>0&&(a[l++]={index:i,count:r.length}),i=_?A(r,r.length-1,-1,p,i,r.length,c):A(r,0,1,p,i,r.length,c);for(let g=0;g<e;++g){const w=o[g];y.holeIndices[g]=i,y.pathLengths[g+1]=w.length,w.length>0&&(a[l++]={index:i,count:w.length}),i=A(w,0,1,p,i,w.length,c)}e=0,y.count>0&&(s[f++]=y)}}for(let h=0;h<e;++h){const r=o[h];r.length>0&&(a[l++]={index:i,count:r.length}),i=A(r,0,1,p,i,r.length,c)}return s.length=f,a.length=l,{position:p,polygons:s,outlines:a}}function A(n,c,u,t,o,s,a){o*=3;for(let e=0;e<s;++e){const f=n[c];t[o++]=f[0],t[o++]=f[1],t[o++]=a?f[2]:0,c+=u}return o/3}function b(n){return!L(n,!1,!1)}var E;(function(n){n[n.NONE=0]="NONE",n[n.CCW_IS_HOLE=1]="CCW_IS_HOLE"})(E||(E={}));export{E as c,O as l,H as o};
