var g=Object.defineProperty;var u=Object.getOwnPropertySymbols;var S=Object.prototype.hasOwnProperty,$=Object.prototype.propertyIsEnumerable;var c=(s,e,t)=>e in s?g(s,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[e]=t,p=(s,e)=>{for(var t in e||(e={}))S.call(e,t)&&c(s,t,e[t]);if(u)for(var t of u(e))$.call(e,t)&&c(s,t,e[t]);return s};import{c$ as f,U as E,ac as V}from"./vendor.ad8aa1ba.js";import{k as a,n as b}from"./Utils.4c2feac4.js";import{D as x}from"./definitions.d3c1cadf.js";import{l as U}from"./visualVariablesUtils.551507c0.js";const _=8388607,v=8388608,A=254,D=255,T=0,m=1,d=s=>(s&v)>>>23,Z=s=>s&_,N=s=>d(s)===m?A:D;function O(s){return d(s)===m}function P(s,e){return((e?v:0)|s)>>>0}const q=(s,e)=>s&&((...t)=>e.warn("DEBUG:",...t))||(()=>null),B=!1;function C(s,e){if(!s||!e)return s;switch(e){case"radius":case"distance":return 2*s;case"diameter":case"width":return s;case"area":return Math.sqrt(s)}return s}function I(s){return{value:s.value,size:f(s.size)}}function r(s){return s.map(e=>I(e))}function y(s){if(typeof s=="string"||typeof s=="number")return f(s);const e=s;return{type:"size",expression:e.expression,stops:r(e.stops)}}const h=s=>{const e=[],t=[],n=r(s),o=n.length;for(let i=0;i<6;i++){const l=n[Math.min(i,o-1)];e.push(l.value),t.push(l.size==null?x:V(l.size))}return{values:new Float32Array(e),sizes:new Float32Array(t)}};function G(s){const e=s&&s.length>0?{}:null,t=e?{}:null;if(!e)return{vvFields:e,vvRanges:t};for(const n of s)if(n.field&&(e[n.type]=n.field),n.type==="size"){t.size||(t.size={});const o=n;switch(U(o)){case a.SIZE_MINMAX_VALUE:t.size.minMaxValue={minDataValue:o.minDataValue,maxDataValue:o.maxDataValue,minSize:y(o.minSize),maxSize:y(o.maxSize)};break;case a.SIZE_SCALE_STOPS:t.size.scaleStops={stops:r(o.stops)};break;case a.SIZE_FIELD_STOPS:if(o.levels){const i={};for(const l in o.levels)i[l]=h(o.levels[l]);t.size.fieldStops={type:"level-dependent",levels:i}}else t.size.fieldStops=p({type:"static"},h(o.stops));break;case a.SIZE_UNIT_VALUE:t.size.unitValue={unit:o.valueUnit,valueRepresentation:o.valueRepresentation}}}else if(n.type==="color")t.color=w(n);else if(n.type==="opacity")t.opacity=M(n);else if(n.type==="rotation"){const o=n;t.rotation={type:o.rotationType}}return{vvFields:e,vvRanges:t}}function M(s){const e={values:[0,0,0,0,0,0,0,0],opacities:[0,0,0,0,0,0,0,0]};if(typeof s.field=="string"){if(!s.stops)return null;{if(s.stops.length>8)return null;const t=s.stops;for(let n=0;n<8;++n){const o=t[Math.min(n,t.length-1)];e.values[n]=o.value,e.opacities[n]=o.opacity}}}else{if(!(s.stops&&s.stops.length>=0))return null;{const t=s.stops&&s.stops.length>=0&&s.stops[0].opacity;for(let n=0;n<8;n++)e.values[n]=1/0,e.opacities[n]=t}}return e}function z(s,e,t){s[4*e+0]=t.r/255,s[4*e+1]=t.g/255,s[4*e+2]=t.b/255,s[4*e+3]=t.a}function w(s){if(E(s)||s.normalizationField)return null;const e={field:null,values:[0,0,0,0,0,0,0,0],colors:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]};if(typeof s.field=="string"){if(!s.stops)return null;{if(s.stops.length>8)return null;e.field=s.field;const t=s.stops;for(let n=0;n<8;++n){const o=t[Math.min(n,t.length-1)];e.values[n]=o.value,z(e.colors,n,o.color)}}}else{if(!(s.stops&&s.stops.length>=0))return null;{const t=s.stops&&s.stops.length>=0&&s.stops[0].color;for(let n=0;n<8;n++)e.values[n]=1/0,z(e.colors,n,t)}}for(let t=0;t<32;t+=4)b(e.colors,t,!0);return e}export{_ as a,G as b,m as c,d as e,Z as f,N as i,B as l,q as n,O as p,C as r,P as s,T as u};
