import{x as an,g3 as P,aC as x,fL as y,fM as O,fR as u,a3 as j,fE as rn,jm as cn,jn as E,aw as l,fG as N,fS as a,fP as p,a5 as M,jo as un,iU as v,gZ as gn,fu as bn,av as m,jp as fn,hL as ln,iY as pn,fQ as d,jq as dn,h$ as hn,jr as B,fN as _,hU as $n,gh as F,hb as mn,iO as In,g5 as h,js as Pn,hu as jn,jt as V,g6 as G,fF as H,g2 as Z}from"./vendor.f59460b9.js";import{v as Nn,A as k,M as Mn}from"./lineSegment.a624e8f3.js";const Y=an.getLogger("esri.views.3d.support.geometryUtils.boundedPlane");class vn{constructor(){this.plane=P(),this.origin=j(),this.basis1=j(),this.basis2=j()}}function I(n=on){return{plane:P(n.plane),origin:O(n.origin),basis1:O(n.basis1),basis2:O(n.basis2)}}function wn(n,s,i){const e=zn.get();return e.origin=n,e.basis1=s,e.basis2=i,e.plane=rn(0,0,0,0),A(e),e}function w(n,s=I()){return Q(n.origin,n.basis1,n.basis2,s)}function An(n,s){u(s.origin,n.origin),u(s.basis1,n.basis1),u(s.basis2,n.basis2),cn(s.plane,n.plane)}function Q(n,s,i,e=I()){return u(e.origin,n),u(e.basis1,s),u(e.basis2,i),A(e),Un(e,"fromValues()"),e}function A(n){E(n.basis2,n.basis1,n.origin,n.plane)}function W(n,s,i){n!==i&&w(n,i);const e=l(a.get(),f(n),s);return p(i.origin,i.origin,e),i.plane[3]-=s,i}function Sn(n,s,i){return X(s,i),W(i,q(n,n.origin),i),i}function X(n,s=I()){const i=(n[2]-n[0])/2,e=(n[3]-n[1])/2;return M(s.origin,n[0]+i,n[1]+e,0),M(s.basis1,i,0,0),M(s.basis2,0,e,0),un(0,0,1,0,s.plane),s}function L(n,s,i){return!!gn(n.plane,s,i)&&sn(n,i)}function Tn(n,s,i){if(L(n,s,i))return i;const e=D(n,s,a.get());return p(i,s.origin,l(a.get(),s.direction,bn(s.origin,e)/m(s.direction))),i}function D(n,s,i){const e=S.get();tn(n,s,e,S.get());let t=Number.POSITIVE_INFINITY;for(const o of C){const r=z(n,o,T.get()),g=a.get();if(fn(e,r,g)){const c=ln(a.get(),s.origin,g),b=Math.abs(pn(d(s.direction,c)));b<t&&(t=b,u(i,g))}}return t===Number.POSITIVE_INFINITY?J(n,s,i):i}function J(n,s,i){if(L(n,s,i))return i;const e=S.get(),t=S.get();tn(n,s,e,t);let o=Number.POSITIVE_INFINITY;for(const r of C){const g=z(n,r,T.get()),c=a.get();if(dn(e,g,c)){const b=hn(s,c);if(!B(t,c))continue;b<o&&(o=b,u(i,c))}}return U(n,s.origin)<o&&K(n,s.origin,i),i}function K(n,s,i){const e=$n(n.plane,s,a.get()),t=k(en(n,n.basis1),e,-1,1,a.get()),o=k(en(n,n.basis2),e,-1,1,a.get());return _(i,p(a.get(),t,o),n.origin),i}function nn(n,s,i){const{origin:e,basis1:t,basis2:o}=n,r=_(a.get(),s,e),g=v(t,r),c=v(o,r),b=v(f(n),r);return M(i,g,c,b)}function U(n,s){const i=nn(n,s,a.get()),{basis1:e,basis2:t}=n,o=m(e),r=m(t),g=Math.max(Math.abs(i[0])-o,0),c=Math.max(Math.abs(i[1])-r,0),b=i[2];return g*g+c*c+b*b}function xn(n,s){return Math.sqrt(U(n,s))}function yn(n,s){let i=Number.NEGATIVE_INFINITY;for(const e of C){const t=z(n,e,T.get()),o=Mn(t,s);o>i&&(i=o)}return Math.sqrt(i)}function On(n,s){return B(n.plane,s)&&sn(n,s)}function En(n,s,i,e){return Ln(n,i,e)}function q(n,s){const i=-n.plane[3];return v(f(n),s)-i}function _n(n,s,i,e){const t=q(n,s),o=l(qn,f(n),i-t);return p(e,s,o),e}function Fn(n,s){return F(n.basis1,s.basis1)&&F(n.basis2,s.basis2)&&F(n.origin,s.origin)}function Vn(n,s,i){return n!==i&&w(n,i),mn($,s),In($,$),h(i.basis1,n.basis1,$),h(i.basis2,n.basis2,$),h(N(i.plane),N(n.plane),$),h(i.origin,n.origin,s),Pn(i.plane,i.plane,i.origin),i}function Yn(n,s,i,e){return n!==e&&w(n,e),jn(R,s,i),h(e.basis1,n.basis1,R),h(e.basis2,n.basis2,R),A(e),e}function f(n){return N(n.plane)}function Ln(n,s,i){switch(s){case V.X:u(i,n.basis1),G(i,i);break;case V.Y:u(i,n.basis2),G(i,i);break;case V.Z:u(i,f(n))}return i}function sn(n,s){const i=_(a.get(),s,n.origin),e=H(n.basis1),t=H(n.basis2),o=d(n.basis1,i),r=d(n.basis2,i);return-o-e<0&&o-e<0&&-r-t<0&&r-t<0}function en(n,s){const i=T.get();return u(i.origin,n.origin),u(i.vector,s),i}function z(n,s,i){const{basis1:e,basis2:t,origin:o}=n,r=l(a.get(),e,s.origin[0]),g=l(a.get(),t,s.origin[1]);p(i.origin,r,g),p(i.origin,i.origin,o);const c=l(a.get(),e,s.direction[0]),b=l(a.get(),t,s.direction[1]);return l(i.vector,p(c,c,b),2),i}function Un(n,s){Math.abs(d(n.basis1,n.basis2)/(m(n.basis1)*m(n.basis2)))>1e-6&&Y.warn(s,"Provided basis vectors are not perpendicular"),Math.abs(d(n.basis1,f(n)))>1e-6&&Y.warn(s,"Basis vectors and plane normal are not perpendicular"),Math.abs(-d(f(n),n.origin)-n.plane[3])>1e-6&&Y.warn(s,"Plane offset is not consistent with plane origin")}function tn(n,s,i,e){const t=f(n);E(t,s.direction,s.origin,i),E(N(i),t,s.origin,e)}const on={plane:P(),origin:x(0,0,0),basis1:x(1,0,0),basis2:x(0,1,0)},S=new y(P),T=new y(Nn),qn=j(),zn=new y(()=>I()),C=[{origin:[-1,-1],direction:[1,0]},{origin:[1,-1],direction:[0,1]},{origin:[1,1],direction:[-1,0]},{origin:[-1,1],direction:[0,-1]}],$=Z(),R=Z();Object.freeze(Object.defineProperty({__proto__:null,BoundedPlaneClass:vn,create:I,wrap:wn,copy:w,copyWithoutVerify:An,fromValues:Q,updateUnboundedPlane:A,elevate:W,setExtent:Sn,fromAABoundingRect:X,intersectRay:L,intersectRayClosestSilhouette:Tn,closestPointOnSilhouette:D,closestPoint:J,projectPoint:K,projectPointLocal:nn,distance2:U,distance:xn,distanceToSilhouette:yn,extrusionContainsPoint:On,axisAt:En,altitudeAt:q,setAltitudeAt:_n,equals:Fn,transform:Vn,rotate:Yn,normal:f,UP:on},Symbol.toStringTag,{value:"Module"}));export{I as G,A as H,X as Q,w as X,xn as e};
