import{K as an,gg as j,aP as x,fY as y,fZ as _,g2 as u,ag as P,fR as rn,jz as cn,jA as E,aJ as l,fT as N,g3 as a,g0 as p,ai as M,jB as un,j5 as v,ha as gn,fH as bn,aI as I,jC as fn,hY as ln,j9 as pn,g1 as d,jD as dn,ic as $n,jE as R,f_ as O,i5 as hn,gu as Y,ho as In,i$ as mn,gi as $,jF as jn,hH as Pn,jG as F,gj as U,fS as G,gf as Z}from"./vendor.1bde3be2.js";import{v as Nn,A as k,M as Mn}from"./lineSegment.54baecae.js";const V=an.getLogger("esri.views.3d.support.geometryUtils.boundedPlane");class vn{constructor(){this.plane=j(),this.origin=P(),this.basis1=P(),this.basis2=P()}}function m(n=tn){return{plane:j(n.plane),origin:_(n.origin),basis1:_(n.basis1),basis2:_(n.basis2)}}function An(n,s,i){const e=Bn.get();return e.origin=n,e.basis1=s,e.basis2=i,e.plane=rn(0,0,0,0),T(e),e}function A(n,s=m()){return D(n.origin,n.basis1,n.basis2,s)}function Tn(n,s){u(s.origin,n.origin),u(s.basis1,n.basis1),u(s.basis2,n.basis2),cn(s.plane,n.plane)}function D(n,s,i,e=m()){return u(e.origin,n),u(e.basis1,s),u(e.basis2,i),T(e),Hn(e,"fromValues()"),e}function T(n){E(n.basis2,n.basis1,n.origin,n.plane)}function J(n,s,i){n!==i&&A(n,i);const e=l(a.get(),f(n),s);return p(i.origin,i.origin,e),i.plane[3]-=s,i}function wn(n,s,i){return K(s,i),J(i,q(n,n.origin),i),i}function K(n,s=m()){const i=(n[2]-n[0])/2,e=(n[3]-n[1])/2;return M(s.origin,n[0]+i,n[1]+e,0),M(s.basis1,i,0,0),M(s.basis2,0,e,0),un(0,0,1,0,s.plane),s}function z(n,s,i){return!!gn(n.plane,s,i)&&sn(n,i)}function Sn(n,s,i){if(z(n,s,i))return i;const e=W(n,s,a.get());return p(i,s.origin,l(a.get(),s.direction,bn(s.origin,e)/I(s.direction))),i}function W(n,s,i){const e=w.get();on(n,s,e,w.get());let o=Number.POSITIVE_INFINITY;for(const t of C){const r=B(n,t,S.get()),g=a.get();if(fn(e,r,g)){const c=ln(a.get(),s.origin,g),b=Math.abs(pn(d(s.direction,c)));b<o&&(o=b,u(i,g))}}return o===Number.POSITIVE_INFINITY?X(n,s,i):i}function X(n,s,i){if(z(n,s,i))return i;const e=w.get(),o=w.get();on(n,s,e,o);let t=Number.POSITIVE_INFINITY;for(const r of C){const g=B(n,r,S.get()),c=a.get();if(dn(e,g,c)){const b=$n(s,c);if(!R(o,c))continue;b<t&&(t=b,u(i,c))}}return H(n,s.origin)<t&&Q(n,s.origin,i),i}function Q(n,s,i){const e=hn(n.plane,s,a.get()),o=k(en(n,n.basis1),e,-1,1,a.get()),t=k(en(n,n.basis2),e,-1,1,a.get());return O(i,p(a.get(),o,t),n.origin),i}function nn(n,s,i){const{origin:e,basis1:o,basis2:t}=n,r=O(a.get(),s,e),g=v(o,r),c=v(t,r),b=v(f(n),r);return M(i,g,c,b)}function H(n,s){const i=nn(n,s,a.get()),{basis1:e,basis2:o}=n,t=I(e),r=I(o),g=Math.max(Math.abs(i[0])-t,0),c=Math.max(Math.abs(i[1])-r,0),b=i[2];return g*g+c*c+b*b}function xn(n,s){return Math.sqrt(H(n,s))}function yn(n,s){let i=Number.NEGATIVE_INFINITY;for(const e of C){const o=B(n,e,S.get()),t=Mn(o,s);t>i&&(i=t)}return Math.sqrt(i)}function _n(n,s){return R(n.plane,s)&&sn(n,s)}function En(n,s,i,e){return zn(n,i,e)}function q(n,s){const i=-n.plane[3];return v(f(n),s)-i}function On(n,s,i,e){const o=q(n,s),t=l(qn,f(n),i-o);return p(e,s,t),e}function Yn(n,s){return Y(n.basis1,s.basis1)&&Y(n.basis2,s.basis2)&&Y(n.origin,s.origin)}function Fn(n,s,i){return n!==i&&A(n,i),In(h,s),mn(h,h),$(i.basis1,n.basis1,h),$(i.basis2,n.basis2,h),$(N(i.plane),N(n.plane),h),$(i.origin,n.origin,s),jn(i.plane,i.plane,i.origin),i}function Vn(n,s,i,e){return n!==e&&A(n,e),Pn(L,s,i),$(e.basis1,n.basis1,L),$(e.basis2,n.basis2,L),T(e),e}function f(n){return N(n.plane)}function zn(n,s,i){switch(s){case F.X:u(i,n.basis1),U(i,i);break;case F.Y:u(i,n.basis2),U(i,i);break;case F.Z:u(i,f(n))}return i}function sn(n,s){const i=O(a.get(),s,n.origin),e=G(n.basis1),o=G(n.basis2),t=d(n.basis1,i),r=d(n.basis2,i);return-t-e<0&&t-e<0&&-r-o<0&&r-o<0}function en(n,s){const i=S.get();return u(i.origin,n.origin),u(i.vector,s),i}function B(n,s,i){const{basis1:e,basis2:o,origin:t}=n,r=l(a.get(),e,s.origin[0]),g=l(a.get(),o,s.origin[1]);p(i.origin,r,g),p(i.origin,i.origin,t);const c=l(a.get(),e,s.direction[0]),b=l(a.get(),o,s.direction[1]);return l(i.vector,p(c,c,b),2),i}function Hn(n,s){Math.abs(d(n.basis1,n.basis2)/(I(n.basis1)*I(n.basis2)))>1e-6&&V.warn(s,"Provided basis vectors are not perpendicular"),Math.abs(d(n.basis1,f(n)))>1e-6&&V.warn(s,"Basis vectors and plane normal are not perpendicular"),Math.abs(-d(f(n),n.origin)-n.plane[3])>1e-6&&V.warn(s,"Plane offset is not consistent with plane origin")}function on(n,s,i,e){const o=f(n);E(o,s.direction,s.origin,i),E(N(i),o,s.origin,e)}const tn={plane:j(),origin:x(0,0,0),basis1:x(1,0,0),basis2:x(0,1,0)},w=new y(j),S=new y(Nn),qn=P(),Bn=new y(()=>m()),C=[{origin:[-1,-1],direction:[1,0]},{origin:[1,-1],direction:[0,1]},{origin:[1,1],direction:[-1,0]},{origin:[-1,1],direction:[0,-1]}],h=Z(),L=Z();Object.freeze(Object.defineProperty({__proto__:null,BoundedPlaneClass:vn,create:m,wrap:An,copy:A,copyWithoutVerify:Tn,fromValues:D,updateUnboundedPlane:T,elevate:J,setExtent:wn,fromAABoundingRect:K,intersectRay:z,intersectRayClosestSilhouette:Sn,closestPointOnSilhouette:W,closestPoint:X,projectPoint:Q,projectPointLocal:nn,distance2:H,distance:xn,distanceToSilhouette:yn,extrusionContainsPoint:_n,axisAt:En,altitudeAt:q,setAltitudeAt:On,equals:Yn,transform:Fn,rotate:Vn,normal:f,UP:tn},Symbol.toStringTag,{value:"Module"}));export{m as G,T as H,K as Q,A as X,xn as e};
