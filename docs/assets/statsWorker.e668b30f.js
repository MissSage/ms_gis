var q=Object.defineProperty,A=Object.defineProperties;var B=Object.getOwnPropertyDescriptors;var b=Object.getOwnPropertySymbols;var O=Object.prototype.hasOwnProperty,k=Object.prototype.propertyIsEnumerable;var D=(e,a,n)=>a in e?q(e,a,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[a]=n,P=(e,a)=>{for(var n in a||(a={}))O.call(a,n)&&D(e,n,a[n]);if(b)for(var n of b(a))k.call(a,n)&&D(e,n,a[n]);return e},g=(e,a)=>A(e,B(a));import{ay as G,M as Y,aX as _,nm as U,aP as X,$ as Z,iF as H,bb as J,nn as M,no as K,np as L,nq as Q,nr as W,ns as aa,nt as ea,nu as na,nv as ia,nw as ta,nx as la,ny as oa,nz as sa}from"./vendor.150443b7.js";let z=null;function ra(e,a,n){return e.x<0?e.x+=a:e.x>n&&(e.x-=a),e}function ua(e,a,n,o){const t=U(n)?X(n):null,s=t?Math.round((t.valid[1]-t.valid[0])/a.scale[0]):null;return e.map(l=>{const i=new G(Y(l.geometry));return _(a,i,i,i.hasZ,i.hasM),l.geometry=t?ra(i,s,o[0]):i,l})}function ma(e,a=18,n,o,t,s){const l=new Float64Array(t*s);a=Math.round(Z(a));let i=Number.POSITIVE_INFINITY,r=Number.NEGATIVE_INFINITY,u=0,f=0,d=0,c=0;const I=L(o,n);for(const{geometry:T,attributes:v}of e){const{x:p,y:m}=T,x=Math.max(0,p-a),V=Math.max(0,m-a),N=Math.min(s,m+a),C=Math.min(t,p+a),S=+I(v);for(let w=V;w<N;w++)for(let F=x;F<C;F++){const E=w*t+F,j=Q(F-p,w-m,a),R=l[E];u=l[E]+=j*S;const $=u-R;f+=$,d+=$*$,u<i&&(i=u),u>r&&(r=u),c++}}if(!c)return{mean:0,stddev:0,min:0,max:0,mid:0,count:0};const y=(r-i)/2;return{mean:f/c,stdDev:Math.sqrt((d-f*f/c)/c),min:i,max:r,mid:y,count:c}}async function h(e,a){if(!a)return[];const{field:n,field2:o,field3:t,fieldDelimiter:s}=e,l=e.valueExpression,i=e.normalizationType,r=e.normalizationField,u=e.normalizationTotal,f=[],d=e.viewInfoParams;let c=null,I=null;if(l){if(!z){const{arcadeUtils:v}=await H();z=v}c=z.createFunction(l),I=d&&z.getViewInfo({viewingMode:d.viewingMode,scale:d.scale,spatialReference:new J(d.spatialReference)})}const y=e.fieldInfos,T=!(a[0]&&"declaredClass"in a[0]&&a[0].declaredClass==="esri.Graphic")&&y?{fields:y}:null;return a.forEach(v=>{const p=v.attributes;let m;if(l){const x=T?g(P({},v),{layer:T}):v,V=z.createExecContext(x,I);m=z.executeFunction(c,V)}else p&&(m=p[n],o&&(m=`${M(m)}${s}${M(p[o])}`,t&&(m=`${m}${s}${M(p[t])}`)));if(i&&typeof m=="number"&&isFinite(m)){const x=p&&parseFloat(p[r]);m=K(m,i,x,u)}f.push(m)}),f}async function ca(e){const{attribute:a,features:n}=e,{normalizationType:o,normalizationField:t,minValue:s,maxValue:l,fieldType:i}=a,r=await h({field:a.field,valueExpression:a.valueExpression,normalizationType:o,normalizationField:t,normalizationTotal:a.normalizationTotal,viewInfoParams:a.viewInfoParams,fieldInfos:a.fieldInfos},n),u=W({normalizationType:o,normalizationField:t,minValue:s,maxValue:l}),f={value:.5,fieldType:i},d=i==="esriFieldTypeString"?aa({values:r,supportsNullCount:u,percentileParams:f}):ea({values:r,minValue:s,maxValue:l,useSampleStdDev:!o,supportsNullCount:u,percentileParams:f});return na(d,i==="esriFieldTypeDate")}async function pa(e){const{attribute:a,features:n}=e,o=await h({field:a.field,field2:a.field2,field3:a.field3,fieldDelimiter:a.fieldDelimiter,valueExpression:a.valueExpression,viewInfoParams:a.viewInfoParams,fieldInfos:a.fieldInfos},n),t=ia(o);return ta(t,a.domains,a.returnAllCodedValues,a.fieldDelimiter)}async function va(e){const{attribute:a,features:n}=e,{field:o,normalizationType:t,normalizationField:s,normalizationTotal:l,classificationMethod:i}=a,r=await h({field:o,valueExpression:a.valueExpression,normalizationType:t,normalizationField:s,normalizationTotal:l,viewInfoParams:a.viewInfoParams,fieldInfos:a.fieldInfos},n),u=la(r,{field:o,normalizationType:t,normalizationField:s,normalizationTotal:l,classificationMethod:i,standardDeviationInterval:a.standardDeviationInterval,numClasses:a.numClasses,minValue:a.minValue,maxValue:a.maxValue});return oa(u,i)}async function Ia(e){const{attribute:a,features:n}=e,{field:o,normalizationType:t,normalizationField:s,normalizationTotal:l,classificationMethod:i}=a,r=await h({field:o,valueExpression:a.valueExpression,normalizationType:t,normalizationField:s,normalizationTotal:l,viewInfoParams:a.viewInfoParams,fieldInfos:a.fieldInfos},n);return sa(r,{field:o,normalizationType:t,normalizationField:s,normalizationTotal:l,classificationMethod:i,standardDeviationInterval:a.standardDeviationInterval,numBins:a.numBins,minValue:a.minValue,maxValue:a.maxValue})}async function ya(e){const{attribute:a,features:n}=e,{field:o,radius:t,fieldOffset:s,transform:l,spatialReference:i,size:r}=a,u=ua(n,l,i,r),{count:f,min:d,max:c,mean:I,stdDev:y}=ma(u,t,s,o,r[0],r[1]);return{count:f,min:d,max:c,avg:I,stddev:y}}export{va as classBreaks,ya as heatmapStatistics,Ia as histogram,ca as summaryStatistics,pa as uniqueValues};
