var zhe=Object.defineProperty,Ghe=Object.defineProperties;var Bhe=Object.getOwnPropertyDescriptors;var xx=Object.getOwnPropertySymbols;var hN=Object.prototype.hasOwnProperty,pN=Object.prototype.propertyIsEnumerable;var dN=(e,t,i)=>t in e?zhe(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i,K=(e,t)=>{for(var i in t||(t={}))hN.call(t,i)&&dN(e,i,t[i]);if(xx)for(var i of xx(t))pN.call(t,i)&&dN(e,i,t[i]);return e},Ce=(e,t)=>Ghe(e,Bhe(t));var Sx=(e,t)=>{var i={};for(var r in e)hN.call(e,r)&&t.indexOf(r)<0&&(i[r]=e[r]);if(e!=null&&xx)for(var r of xx(e))t.indexOf(r)<0&&pN.call(e,r)&&(i[r]=e[r]);return i};function U$(e,t){const i=Object.create(null),r=e.split(",");for(let n=0;n<r.length;n++)i[r[n]]=!0;return t?n=>!!i[n.toLowerCase()]:n=>!!i[n]}function q$(e){if(ti(e)){const t={};for(let i=0;i<e.length;i++){const r=e[i],n=Ln(r)?Whe(r):q$(r);if(n)for(const o in n)t[o]=n[o]}return t}else{if(Ln(e))return e;if(Lr(e))return e}}const Uhe=/;(?![^(]*\))/g,qhe=/:([^]+)/,Hhe=/\/\*.*?\*\//gs;function Whe(e){const t={};return e.replace(Hhe,"").split(Uhe).forEach(i=>{if(i){const r=i.split(qhe);r.length>1&&(t[r[0].trim()]=r[1].trim())}}),t}function H$(e){let t="";if(Ln(e))t=e;else if(ti(e))for(let i=0;i<e.length;i++){const r=H$(e[i]);r&&(t+=r+" ")}else if(Lr(e))for(const i in e)e[i]&&(t+=i+" ");return t.trim()}const Jhe="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",Zhe=U$(Jhe);function fN(e){return!!e||e===""}const mHe=e=>Ln(e)?e:e==null?"":ti(e)||Lr(e)&&(e.toString===vN||!mi(e.toString))?JSON.stringify(e,yN,2):String(e),yN=(e,t)=>t&&t.__v_isRef?yN(e,t.value):Fm(t)?{[`Map(${t.size})`]:[...t.entries()].reduce((i,[r,n])=>(i[`${r} =>`]=n,i),{})}:mN(t)?{[`Set(${t.size})`]:[...t.values()]}:Lr(t)&&!ti(t)&&!bN(t)?String(t):t,Pr={},Rm=[],Wl=()=>{},Khe=()=>!1,Yhe=/^on[^a-z]/,Mx=e=>Yhe.test(e),W$=e=>e.startsWith("onUpdate:"),Os=Object.assign,J$=(e,t)=>{const i=e.indexOf(t);i>-1&&e.splice(i,1)},Xhe=Object.prototype.hasOwnProperty,Di=(e,t)=>Xhe.call(e,t),ti=Array.isArray,Fm=e=>Ix(e)==="[object Map]",mN=e=>Ix(e)==="[object Set]",mi=e=>typeof e=="function",Ln=e=>typeof e=="string",Z$=e=>typeof e=="symbol",Lr=e=>e!==null&&typeof e=="object",gN=e=>Lr(e)&&mi(e.then)&&mi(e.catch),vN=Object.prototype.toString,Ix=e=>vN.call(e),Qhe=e=>Ix(e).slice(8,-1),bN=e=>Ix(e)==="[object Object]",K$=e=>Ln(e)&&e!=="NaN"&&e[0]!=="-"&&""+parseInt(e,10)===e,$x=U$(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),Ex=e=>{const t=Object.create(null);return i=>t[i]||(t[i]=e(i))},epe=/-(\w)/g,Uc=Ex(e=>e.replace(epe,(t,i)=>i?i.toUpperCase():"")),tpe=/\B([A-Z])/g,Nm=Ex(e=>e.replace(tpe,"-$1").toLowerCase()),Tx=Ex(e=>e.charAt(0).toUpperCase()+e.slice(1)),Y$=Ex(e=>e?`on${Tx(e)}`:""),kb=(e,t)=>!Object.is(e,t),X$=(e,t)=>{for(let i=0;i<e.length;i++)e[i](t)},Cx=(e,t,i)=>{Object.defineProperty(e,t,{configurable:!0,enumerable:!1,value:i})},Q$=e=>{const t=parseFloat(e);return isNaN(t)?e:t};let wN;const ipe=()=>wN||(wN=typeof globalThis!="undefined"?globalThis:typeof self!="undefined"?self:typeof window!="undefined"?window:typeof global!="undefined"?global:{});let qc;class rpe{constructor(t=!1){this.detached=t,this.active=!0,this.effects=[],this.cleanups=[],this.parent=qc,!t&&qc&&(this.index=(qc.scopes||(qc.scopes=[])).push(this)-1)}run(t){if(this.active){const i=qc;try{return qc=this,t()}finally{qc=i}}}on(){qc=this}off(){qc=this.parent}stop(t){if(this.active){let i,r;for(i=0,r=this.effects.length;i<r;i++)this.effects[i].stop();for(i=0,r=this.cleanups.length;i<r;i++)this.cleanups[i]();if(this.scopes)for(i=0,r=this.scopes.length;i<r;i++)this.scopes[i].stop(!0);if(!this.detached&&this.parent&&!t){const n=this.parent.scopes.pop();n&&n!==this&&(this.parent.scopes[this.index]=n,n.index=this.index)}this.parent=void 0,this.active=!1}}}function npe(e,t=qc){t&&t.active&&t.effects.push(e)}const eE=e=>{const t=new Set(e);return t.w=0,t.n=0,t},_N=e=>(e.w&Jp)>0,xN=e=>(e.n&Jp)>0,spe=({deps:e})=>{if(e.length)for(let t=0;t<e.length;t++)e[t].w|=Jp},ope=e=>{const{deps:t}=e;if(t.length){let i=0;for(let r=0;r<t.length;r++){const n=t[r];_N(n)&&!xN(n)?n.delete(e):t[i++]=n,n.w&=~Jp,n.n&=~Jp}t.length=i}},tE=new WeakMap;let Ab=0,Jp=1;const iE=30;let Jl;const i0=Symbol(""),rE=Symbol("");class nE{constructor(t,i=null,r){this.fn=t,this.scheduler=i,this.active=!0,this.deps=[],this.parent=void 0,npe(this,r)}run(){if(!this.active)return this.fn();let t=Jl,i=Zp;for(;t;){if(t===this)return;t=t.parent}try{return this.parent=Jl,Jl=this,Zp=!0,Jp=1<<++Ab,Ab<=iE?spe(this):SN(this),this.fn()}finally{Ab<=iE&&ope(this),Jp=1<<--Ab,Jl=this.parent,Zp=i,this.parent=void 0,this.deferStop&&this.stop()}}stop(){Jl===this?this.deferStop=!0:this.active&&(SN(this),this.onStop&&this.onStop(),this.active=!1)}}function SN(e){const{deps:t}=e;if(t.length){for(let i=0;i<t.length;i++)t[i].delete(e);t.length=0}}let Zp=!0;const MN=[];function Dm(){MN.push(Zp),Zp=!1}function jm(){const e=MN.pop();Zp=e===void 0?!0:e}function Ca(e,t,i){if(Zp&&Jl){let r=tE.get(e);r||tE.set(e,r=new Map);let n=r.get(i);n||r.set(i,n=eE()),IN(n)}}function IN(e,t){let i=!1;Ab<=iE?xN(e)||(e.n|=Jp,i=!_N(e)):i=!e.has(Jl),i&&(e.add(Jl),Jl.deps.push(e))}function sh(e,t,i,r,n,o){const c=tE.get(e);if(!c)return;let h=[];if(t==="clear")h=[...c.values()];else if(i==="length"&&ti(e)){const m=Q$(r);c.forEach((b,x)=>{(x==="length"||x>=m)&&h.push(b)})}else switch(i!==void 0&&h.push(c.get(i)),t){case"add":ti(e)?K$(i)&&h.push(c.get("length")):(h.push(c.get(i0)),Fm(e)&&h.push(c.get(rE)));break;case"delete":ti(e)||(h.push(c.get(i0)),Fm(e)&&h.push(c.get(rE)));break;case"set":Fm(e)&&h.push(c.get(i0));break}if(h.length===1)h[0]&&sE(h[0]);else{const m=[];for(const b of h)b&&m.push(...b);sE(eE(m))}}function sE(e,t){const i=ti(e)?e:[...e];for(const r of i)r.computed&&$N(r);for(const r of i)r.computed||$N(r)}function $N(e,t){(e!==Jl||e.allowRecurse)&&(e.scheduler?e.scheduler():e.run())}const ape=U$("__proto__,__v_isRef,__isVue"),EN=new Set(Object.getOwnPropertyNames(Symbol).filter(e=>e!=="arguments"&&e!=="caller").map(e=>Symbol[e]).filter(Z$)),lpe=oE(),cpe=oE(!1,!0),upe=oE(!0),TN=hpe();function hpe(){const e={};return["includes","indexOf","lastIndexOf"].forEach(t=>{e[t]=function(...i){const r=Ji(this);for(let o=0,c=this.length;o<c;o++)Ca(r,"get",o+"");const n=r[t](...i);return n===-1||n===!1?r[t](...i.map(Ji)):n}}),["push","pop","shift","unshift","splice"].forEach(t=>{e[t]=function(...i){Dm();const r=Ji(this)[t].apply(this,i);return jm(),r}}),e}function oE(e=!1,t=!1){return function(r,n,o){if(n==="__v_isReactive")return!e;if(n==="__v_isReadonly")return e;if(n==="__v_isShallow")return t;if(n==="__v_raw"&&o===(e?t?Epe:NN:t?FN:RN).get(r))return r;const c=ti(r);if(!e&&c&&Di(TN,n))return Reflect.get(TN,n,o);const h=Reflect.get(r,n,o);return(Z$(n)?EN.has(n):ape(n))||(e||Ca(r,"get",n),t)?h:Rs(h)?c&&K$(n)?h:h.value:Lr(h)?e?DN(h):Pb(h):h}}const ppe=CN(),dpe=CN(!0);function CN(e=!1){return function(i,r,n,o){let c=i[r];if(zm(c)&&Rs(c)&&!Rs(n))return!1;if(!e&&(!Fx(n)&&!zm(n)&&(c=Ji(c),n=Ji(n)),!ti(i)&&Rs(c)&&!Rs(n)))return c.value=n,!0;const h=ti(i)&&K$(r)?Number(r)<i.length:Di(i,r),m=Reflect.set(i,r,n,o);return i===Ji(o)&&(h?kb(n,c)&&sh(i,"set",r,n):sh(i,"add",r,n)),m}}function fpe(e,t){const i=Di(e,t);e[t];const r=Reflect.deleteProperty(e,t);return r&&i&&sh(e,"delete",t,void 0),r}function ype(e,t){const i=Reflect.has(e,t);return(!Z$(t)||!EN.has(t))&&Ca(e,"has",t),i}function mpe(e){return Ca(e,"iterate",ti(e)?"length":i0),Reflect.ownKeys(e)}const kN={get:lpe,set:ppe,deleteProperty:fpe,has:ype,ownKeys:mpe},gpe={get:upe,set(e,t){return!0},deleteProperty(e,t){return!0}},vpe=Os({},kN,{get:cpe,set:dpe}),aE=e=>e,kx=e=>Reflect.getPrototypeOf(e);function Ax(e,t,i=!1,r=!1){e=e.__v_raw;const n=Ji(e),o=Ji(t);i||(t!==o&&Ca(n,"get",t),Ca(n,"get",o));const{has:c}=kx(n),h=r?aE:i?uE:Lb;if(c.call(n,t))return h(e.get(t));if(c.call(n,o))return h(e.get(o));e!==n&&e.get(t)}function Px(e,t=!1){const i=this.__v_raw,r=Ji(i),n=Ji(e);return t||(e!==n&&Ca(r,"has",e),Ca(r,"has",n)),e===n?i.has(e):i.has(e)||i.has(n)}function Lx(e,t=!1){return e=e.__v_raw,!t&&Ca(Ji(e),"iterate",i0),Reflect.get(e,"size",e)}function AN(e){e=Ji(e);const t=Ji(this);return kx(t).has.call(t,e)||(t.add(e),sh(t,"add",e,e)),this}function PN(e,t){t=Ji(t);const i=Ji(this),{has:r,get:n}=kx(i);let o=r.call(i,e);o||(e=Ji(e),o=r.call(i,e));const c=n.call(i,e);return i.set(e,t),o?kb(t,c)&&sh(i,"set",e,t):sh(i,"add",e,t),this}function LN(e){const t=Ji(this),{has:i,get:r}=kx(t);let n=i.call(t,e);n||(e=Ji(e),n=i.call(t,e)),r&&r.call(t,e);const o=t.delete(e);return n&&sh(t,"delete",e,void 0),o}function ON(){const e=Ji(this),t=e.size!==0,i=e.clear();return t&&sh(e,"clear",void 0,void 0),i}function Ox(e,t){return function(r,n){const o=this,c=o.__v_raw,h=Ji(c),m=t?aE:e?uE:Lb;return!e&&Ca(h,"iterate",i0),c.forEach((b,x)=>r.call(n,m(b),m(x),o))}}function Rx(e,t,i){return function(...r){const n=this.__v_raw,o=Ji(n),c=Fm(o),h=e==="entries"||e===Symbol.iterator&&c,m=e==="keys"&&c,b=n[e](...r),x=i?aE:t?uE:Lb;return!t&&Ca(o,"iterate",m?rE:i0),{next(){const{value:I,done:E}=b.next();return E?{value:I,done:E}:{value:h?[x(I[0]),x(I[1])]:x(I),done:E}},[Symbol.iterator](){return this}}}}function Kp(e){return function(...t){return e==="delete"?!1:this}}function bpe(){const e={get(o){return Ax(this,o)},get size(){return Lx(this)},has:Px,add:AN,set:PN,delete:LN,clear:ON,forEach:Ox(!1,!1)},t={get(o){return Ax(this,o,!1,!0)},get size(){return Lx(this)},has:Px,add:AN,set:PN,delete:LN,clear:ON,forEach:Ox(!1,!0)},i={get(o){return Ax(this,o,!0)},get size(){return Lx(this,!0)},has(o){return Px.call(this,o,!0)},add:Kp("add"),set:Kp("set"),delete:Kp("delete"),clear:Kp("clear"),forEach:Ox(!0,!1)},r={get(o){return Ax(this,o,!0,!0)},get size(){return Lx(this,!0)},has(o){return Px.call(this,o,!0)},add:Kp("add"),set:Kp("set"),delete:Kp("delete"),clear:Kp("clear"),forEach:Ox(!0,!0)};return["keys","values","entries",Symbol.iterator].forEach(o=>{e[o]=Rx(o,!1,!1),i[o]=Rx(o,!0,!1),t[o]=Rx(o,!1,!0),r[o]=Rx(o,!0,!0)}),[e,i,t,r]}const[wpe,_pe,xpe,Spe]=bpe();function lE(e,t){const i=t?e?Spe:xpe:e?_pe:wpe;return(r,n,o)=>n==="__v_isReactive"?!e:n==="__v_isReadonly"?e:n==="__v_raw"?r:Reflect.get(Di(i,n)&&n in r?i:r,n,o)}const Mpe={get:lE(!1,!1)},Ipe={get:lE(!1,!0)},$pe={get:lE(!0,!1)},RN=new WeakMap,FN=new WeakMap,NN=new WeakMap,Epe=new WeakMap;function Tpe(e){switch(e){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function Cpe(e){return e.__v_skip||!Object.isExtensible(e)?0:Tpe(Qhe(e))}function Pb(e){return zm(e)?e:cE(e,!1,kN,Mpe,RN)}function kpe(e){return cE(e,!1,vpe,Ipe,FN)}function DN(e){return cE(e,!0,gpe,$pe,NN)}function cE(e,t,i,r,n){if(!Lr(e)||e.__v_raw&&!(t&&e.__v_isReactive))return e;const o=n.get(e);if(o)return o;const c=Cpe(e);if(c===0)return e;const h=new Proxy(e,c===2?r:i);return n.set(e,h),h}function Vm(e){return zm(e)?Vm(e.__v_raw):!!(e&&e.__v_isReactive)}function zm(e){return!!(e&&e.__v_isReadonly)}function Fx(e){return!!(e&&e.__v_isShallow)}function jN(e){return Vm(e)||zm(e)}function Ji(e){const t=e&&e.__v_raw;return t?Ji(t):e}function VN(e){return Cx(e,"__v_skip",!0),e}const Lb=e=>Lr(e)?Pb(e):e,uE=e=>Lr(e)?DN(e):e;function zN(e){Zp&&Jl&&(e=Ji(e),IN(e.dep||(e.dep=eE())))}function GN(e,t){e=Ji(e),e.dep&&sE(e.dep)}function Rs(e){return!!(e&&e.__v_isRef===!0)}function Ape(e){return BN(e,!1)}function Ppe(e){return BN(e,!0)}function BN(e,t){return Rs(e)?e:new Lpe(e,t)}class Lpe{constructor(t,i){this.__v_isShallow=i,this.dep=void 0,this.__v_isRef=!0,this._rawValue=i?t:Ji(t),this._value=i?t:Lb(t)}get value(){return zN(this),this._value}set value(t){const i=this.__v_isShallow||Fx(t)||zm(t);t=i?t:Ji(t),kb(t,this._rawValue)&&(this._rawValue=t,this._value=i?t:Lb(t),GN(this))}}function Ob(e){return Rs(e)?e.value:e}const Ope={get:(e,t,i)=>Ob(Reflect.get(e,t,i)),set:(e,t,i,r)=>{const n=e[t];return Rs(n)&&!Rs(i)?(n.value=i,!0):Reflect.set(e,t,i,r)}};function UN(e){return Vm(e)?e:new Proxy(e,Ope)}function gHe(e){const t=ti(e)?new Array(e.length):{};for(const i in e)t[i]=Fpe(e,i);return t}class Rpe{constructor(t,i,r){this._object=t,this._key=i,this._defaultValue=r,this.__v_isRef=!0}get value(){const t=this._object[this._key];return t===void 0?this._defaultValue:t}set value(t){this._object[this._key]=t}}function Fpe(e,t,i){const r=e[t];return Rs(r)?r:new Rpe(e,t,i)}var qN;class Npe{constructor(t,i,r,n){this._setter=i,this.dep=void 0,this.__v_isRef=!0,this[qN]=!1,this._dirty=!0,this.effect=new nE(t,()=>{this._dirty||(this._dirty=!0,GN(this))}),this.effect.computed=this,this.effect.active=this._cacheable=!n,this.__v_isReadonly=r}get value(){const t=Ji(this);return zN(t),(t._dirty||!t._cacheable)&&(t._dirty=!1,t._value=t.effect.run()),t._value}set value(t){this._setter(t)}}qN="__v_isReadonly";function Dpe(e,t,i=!1){let r,n;const o=mi(e);return o?(r=e,n=Wl):(r=e.get,n=e.set),new Npe(r,n,o||!n,i)}function Yp(e,t,i,r){let n;try{n=r?e(...r):e()}catch(o){Nx(o,t,i)}return n}function al(e,t,i,r){if(mi(e)){const o=Yp(e,t,i,r);return o&&gN(o)&&o.catch(c=>{Nx(c,t,i)}),o}const n=[];for(let o=0;o<e.length;o++)n.push(al(e[o],t,i,r));return n}function Nx(e,t,i,r=!0){const n=t?t.vnode:null;if(t){let o=t.parent;const c=t.proxy,h=i;for(;o;){const b=o.ec;if(b){for(let x=0;x<b.length;x++)if(b[x](e,c,h)===!1)return}o=o.parent}const m=t.appContext.config.errorHandler;if(m){Yp(m,null,10,[e,c,h]);return}}jpe(e,i,n,r)}function jpe(e,t,i,r=!0){console.error(e)}let Rb=!1,hE=!1;const Qs=[];let Hc=0;const Gm=[];let oh=null,r0=0;const HN=Promise.resolve();let pE=null;function WN(e){const t=pE||HN;return e?t.then(this?e.bind(this):e):t}function Vpe(e){let t=Hc+1,i=Qs.length;for(;t<i;){const r=t+i>>>1;Fb(Qs[r])<e?t=r+1:i=r}return t}function dE(e){(!Qs.length||!Qs.includes(e,Rb&&e.allowRecurse?Hc+1:Hc))&&(e.id==null?Qs.push(e):Qs.splice(Vpe(e.id),0,e),JN())}function JN(){!Rb&&!hE&&(hE=!0,pE=HN.then(YN))}function zpe(e){const t=Qs.indexOf(e);t>Hc&&Qs.splice(t,1)}function Gpe(e){ti(e)?Gm.push(...e):(!oh||!oh.includes(e,e.allowRecurse?r0+1:r0))&&Gm.push(e),JN()}function ZN(e,t=Rb?Hc+1:0){for(;t<Qs.length;t++){const i=Qs[t];i&&i.pre&&(Qs.splice(t,1),t--,i())}}function KN(e){if(Gm.length){const t=[...new Set(Gm)];if(Gm.length=0,oh){oh.push(...t);return}for(oh=t,oh.sort((i,r)=>Fb(i)-Fb(r)),r0=0;r0<oh.length;r0++)oh[r0]();oh=null,r0=0}}const Fb=e=>e.id==null?1/0:e.id,Bpe=(e,t)=>{const i=Fb(e)-Fb(t);if(i===0){if(e.pre&&!t.pre)return-1;if(t.pre&&!e.pre)return 1}return i};function YN(e){hE=!1,Rb=!0,Qs.sort(Bpe);const t=Wl;try{for(Hc=0;Hc<Qs.length;Hc++){const i=Qs[Hc];i&&i.active!==!1&&Yp(i,null,14)}}finally{Hc=0,Qs.length=0,KN(),Rb=!1,pE=null,(Qs.length||Gm.length)&&YN()}}function Upe(e,t,...i){if(e.isUnmounted)return;const r=e.vnode.props||Pr;let n=i;const o=t.startsWith("update:"),c=o&&t.slice(7);if(c&&c in r){const x=`${c==="modelValue"?"model":c}Modifiers`,{number:I,trim:E}=r[x]||Pr;E&&(n=i.map(k=>Ln(k)?k.trim():k)),I&&(n=i.map(Q$))}let h,m=r[h=Y$(t)]||r[h=Y$(Uc(t))];!m&&o&&(m=r[h=Y$(Nm(t))]),m&&al(m,e,6,n);const b=r[h+"Once"];if(b){if(!e.emitted)e.emitted={};else if(e.emitted[h])return;e.emitted[h]=!0,al(b,e,6,n)}}function XN(e,t,i=!1){const r=t.emitsCache,n=r.get(e);if(n!==void 0)return n;const o=e.emits;let c={},h=!1;if(!mi(e)){const m=b=>{const x=XN(b,t,!0);x&&(h=!0,Os(c,x))};!i&&t.mixins.length&&t.mixins.forEach(m),e.extends&&m(e.extends),e.mixins&&e.mixins.forEach(m)}return!o&&!h?(Lr(e)&&r.set(e,null),null):(ti(o)?o.forEach(m=>c[m]=null):Os(c,o),Lr(e)&&r.set(e,c),c)}function Dx(e,t){return!e||!Mx(t)?!1:(t=t.slice(2).replace(/Once$/,""),Di(e,t[0].toLowerCase()+t.slice(1))||Di(e,Nm(t))||Di(e,t))}let Fs=null,QN=null;function jx(e){const t=Fs;return Fs=e,QN=e&&e.type.__scopeId||null,t}function qpe(e,t=Fs,i){if(!t||e._n)return e;const r=(...n)=>{r._d&&kD(-1);const o=jx(t);let c;try{c=e(...n)}finally{jx(o),r._d&&kD(1)}return c};return r._n=!0,r._c=!0,r._d=!0,r}function fE(e){const{type:t,vnode:i,proxy:r,withProxy:n,props:o,propsOptions:[c],slots:h,attrs:m,emit:b,render:x,renderCache:I,data:E,setupState:k,ctx:P,inheritAttrs:F}=e;let N,B;const z=jx(e);try{if(i.shapeFlag&4){const J=n||r;N=Wc(x.call(J,J,I,o,k,E,P)),B=m}else{const J=t;N=Wc(J.length>1?J(o,{attrs:m,slots:h,emit:b}):J(o,null)),B=t.props?m:Hpe(m)}}catch(J){Vb.length=0,Nx(J,e,1),N=Mo(ul)}let q=N;if(B&&F!==!1){const J=Object.keys(B),{shapeFlag:X}=q;J.length&&X&(1|6)&&(c&&J.some(W$)&&(B=Wpe(B,c)),q=Xp(q,B))}return i.dirs&&(q=Xp(q),q.dirs=q.dirs?q.dirs.concat(i.dirs):i.dirs),i.transition&&(q.transition=i.transition),N=q,jx(z),N}const Hpe=e=>{let t;for(const i in e)(i==="class"||i==="style"||Mx(i))&&((t||(t={}))[i]=e[i]);return t},Wpe=(e,t)=>{const i={};for(const r in e)(!W$(r)||!(r.slice(9)in t))&&(i[r]=e[r]);return i};function Jpe(e,t,i){const{props:r,children:n,component:o}=e,{props:c,children:h,patchFlag:m}=t,b=o.emitsOptions;if(t.dirs||t.transition)return!0;if(i&&m>=0){if(m&1024)return!0;if(m&16)return r?eD(r,c,b):!!c;if(m&8){const x=t.dynamicProps;for(let I=0;I<x.length;I++){const E=x[I];if(c[E]!==r[E]&&!Dx(b,E))return!0}}}else return(n||h)&&(!h||!h.$stable)?!0:r===c?!1:r?c?eD(r,c,b):!0:!!c;return!1}function eD(e,t,i){const r=Object.keys(t);if(r.length!==Object.keys(e).length)return!0;for(let n=0;n<r.length;n++){const o=r[n];if(t[o]!==e[o]&&!Dx(i,o))return!0}return!1}function Zpe({vnode:e,parent:t},i){for(;t&&t.subTree===e;)(e=t.vnode).el=i,t=t.parent}const Kpe=e=>e.__isSuspense;function Ype(e,t){t&&t.pendingBranch?ti(e)?t.effects.push(...e):t.effects.push(e):Gpe(e)}function Vx(e,t){if(bs){let i=bs.provides;const r=bs.parent&&bs.parent.provides;r===i&&(i=bs.provides=Object.create(r)),i[e]=t}}function ah(e,t,i=!1){const r=bs||Fs;if(r){const n=r.parent==null?r.vnode.appContext&&r.vnode.appContext.provides:r.parent.provides;if(n&&e in n)return n[e];if(arguments.length>1)return i&&mi(t)?t.call(r.proxy):t}}const zx={};function Gx(e,t,i){return tD(e,t,i)}function tD(e,t,{immediate:i,deep:r,flush:n,onTrack:o,onTrigger:c}=Pr){const h=bs;let m,b=!1,x=!1;if(Rs(e)?(m=()=>e.value,b=Fx(e)):Vm(e)?(m=()=>e,r=!0):ti(e)?(x=!0,b=e.some(q=>Vm(q)||Fx(q)),m=()=>e.map(q=>{if(Rs(q))return q.value;if(Vm(q))return n0(q);if(mi(q))return Yp(q,h,2)})):mi(e)?t?m=()=>Yp(e,h,2):m=()=>{if(!(h&&h.isUnmounted))return I&&I(),al(e,h,3,[E])}:m=Wl,t&&r){const q=m;m=()=>n0(q())}let I,E=q=>{I=B.onStop=()=>{Yp(q,h,4)}},k;if(Gb)if(E=Wl,t?i&&al(t,h,3,[m(),x?[]:void 0,E]):m(),n==="sync"){const q=Jde();k=q.__watcherHandles||(q.__watcherHandles=[])}else return Wl;let P=x?new Array(e.length).fill(zx):zx;const F=()=>{if(!!B.active)if(t){const q=B.run();(r||b||(x?q.some((J,X)=>kb(J,P[X])):kb(q,P)))&&(I&&I(),al(t,h,3,[q,P===zx?void 0:x&&P[0]===zx?[]:P,E]),P=q)}else B.run()};F.allowRecurse=!!t;let N;n==="sync"?N=F:n==="post"?N=()=>Uo(F,h&&h.suspense):(F.pre=!0,h&&(F.id=h.uid),N=()=>dE(F));const B=new nE(m,N);t?i?F():P=B.run():n==="post"?Uo(B.run.bind(B),h&&h.suspense):B.run();const z=()=>{B.stop(),h&&h.scope&&J$(h.scope.effects,B)};return k&&k.push(z),z}function Xpe(e,t,i){const r=this.proxy,n=Ln(e)?e.includes(".")?iD(r,e):()=>r[e]:e.bind(r,r);let o;mi(t)?o=t:(o=t.handler,i=t);const c=bs;Bm(this);const h=tD(n,o.bind(r),i);return c?Bm(c):c0(),h}function iD(e,t){const i=t.split(".");return()=>{let r=e;for(let n=0;n<i.length&&r;n++)r=r[i[n]];return r}}function n0(e,t){if(!Lr(e)||e.__v_skip||(t=t||new Set,t.has(e)))return e;if(t.add(e),Rs(e))n0(e.value,t);else if(ti(e))for(let i=0;i<e.length;i++)n0(e[i],t);else if(mN(e)||Fm(e))e.forEach(i=>{n0(i,t)});else if(bN(e))for(const i in e)n0(e[i],t);return e}function Qpe(){const e={isMounted:!1,isLeaving:!1,isUnmounting:!1,leavingVNodes:new Map};return lD(()=>{e.isMounted=!0}),cD(()=>{e.isUnmounting=!0}),e}const ll=[Function,Array],ede={name:"BaseTransition",props:{mode:String,appear:Boolean,persisted:Boolean,onBeforeEnter:ll,onEnter:ll,onAfterEnter:ll,onEnterCancelled:ll,onBeforeLeave:ll,onLeave:ll,onAfterLeave:ll,onLeaveCancelled:ll,onBeforeAppear:ll,onAppear:ll,onAfterAppear:ll,onAppearCancelled:ll},setup(e,{slots:t}){const i=Vde(),r=Qpe();let n;return()=>{const o=t.default&&oD(t.default(),!0);if(!o||!o.length)return;let c=o[0];if(o.length>1){for(const F of o)if(F.type!==ul){c=F;break}}const h=Ji(e),{mode:m}=h;if(r.isLeaving)return mE(c);const b=sD(c);if(!b)return mE(c);const x=yE(b,h,r,i);gE(b,x);const I=i.subTree,E=I&&sD(I);let k=!1;const{getTransitionKey:P}=b.type;if(P){const F=P();n===void 0?n=F:F!==n&&(n=F,k=!0)}if(E&&E.type!==ul&&(!l0(b,E)||k)){const F=yE(E,h,r,i);if(gE(E,F),m==="out-in")return r.isLeaving=!0,F.afterLeave=()=>{r.isLeaving=!1,i.update.active!==!1&&i.update()},mE(c);m==="in-out"&&b.type!==ul&&(F.delayLeave=(N,B,z)=>{const q=nD(r,E);q[String(E.key)]=E,N._leaveCb=()=>{B(),N._leaveCb=void 0,delete x.delayedLeave},x.delayedLeave=z})}return c}}},rD=ede;function nD(e,t){const{leavingVNodes:i}=e;let r=i.get(t.type);return r||(r=Object.create(null),i.set(t.type,r)),r}function yE(e,t,i,r){const{appear:n,mode:o,persisted:c=!1,onBeforeEnter:h,onEnter:m,onAfterEnter:b,onEnterCancelled:x,onBeforeLeave:I,onLeave:E,onAfterLeave:k,onLeaveCancelled:P,onBeforeAppear:F,onAppear:N,onAfterAppear:B,onAppearCancelled:z}=t,q=String(e.key),J=nD(i,e),X=(he,fe)=>{he&&al(he,r,9,fe)},Y=(he,fe)=>{const ye=fe[1];X(he,fe),ti(he)?he.every(xe=>xe.length<=1)&&ye():he.length<=1&&ye()},ae={mode:o,persisted:c,beforeEnter(he){let fe=h;if(!i.isMounted)if(n)fe=F||h;else return;he._leaveCb&&he._leaveCb(!0);const ye=J[q];ye&&l0(e,ye)&&ye.el._leaveCb&&ye.el._leaveCb(),X(fe,[he])},enter(he){let fe=m,ye=b,xe=x;if(!i.isMounted)if(n)fe=N||m,ye=B||b,xe=z||x;else return;let Se=!1;const Ae=he._enterCb=Oe=>{Se||(Se=!0,Oe?X(xe,[he]):X(ye,[he]),ae.delayedLeave&&ae.delayedLeave(),he._enterCb=void 0)};fe?Y(fe,[he,Ae]):Ae()},leave(he,fe){const ye=String(e.key);if(he._enterCb&&he._enterCb(!0),i.isUnmounting)return fe();X(I,[he]);let xe=!1;const Se=he._leaveCb=Ae=>{xe||(xe=!0,fe(),Ae?X(P,[he]):X(k,[he]),he._leaveCb=void 0,J[ye]===e&&delete J[ye])};J[ye]=e,E?Y(E,[he,Se]):Se()},clone(he){return yE(he,t,i,r)}};return ae}function mE(e){if(Bx(e))return e=Xp(e),e.children=null,e}function sD(e){return Bx(e)?e.children?e.children[0]:void 0:e}function gE(e,t){e.shapeFlag&6&&e.component?gE(e.component.subTree,t):e.shapeFlag&128?(e.ssContent.transition=t.clone(e.ssContent),e.ssFallback.transition=t.clone(e.ssFallback)):e.transition=t}function oD(e,t=!1,i){let r=[],n=0;for(let o=0;o<e.length;o++){let c=e[o];const h=i==null?c.key:String(i)+String(c.key!=null?c.key:o);c.type===cl?(c.patchFlag&128&&n++,r=r.concat(oD(c.children,t,h))):(t||c.type!==ul)&&r.push(h!=null?Xp(c,{key:h}):c)}if(n>1)for(let o=0;o<r.length;o++)r[o].patchFlag=-2;return r}function vE(e){return mi(e)?{setup:e,name:e.name}:e}const Nb=e=>!!e.type.__asyncLoader,Bx=e=>e.type.__isKeepAlive;function tde(e,t){aD(e,"a",t)}function ide(e,t){aD(e,"da",t)}function aD(e,t,i=bs){const r=e.__wdc||(e.__wdc=()=>{let n=i;for(;n;){if(n.isDeactivated)return;n=n.parent}return e()});if(Ux(t,r,i),i){let n=i.parent;for(;n&&n.parent;)Bx(n.parent.vnode)&&rde(r,t,i,n),n=n.parent}}function rde(e,t,i,r){const n=Ux(t,e,r,!0);uD(()=>{J$(r[t],n)},i)}function Ux(e,t,i=bs,r=!1){if(i){const n=i[e]||(i[e]=[]),o=t.__weh||(t.__weh=(...c)=>{if(i.isUnmounted)return;Dm(),Bm(i);const h=al(t,i,e,c);return c0(),jm(),h});return r?n.unshift(o):n.push(o),o}}const lh=e=>(t,i=bs)=>(!Gb||e==="sp")&&Ux(e,(...r)=>t(...r),i),nde=lh("bm"),lD=lh("m"),sde=lh("bu"),ode=lh("u"),cD=lh("bum"),uD=lh("um"),ade=lh("sp"),lde=lh("rtg"),cde=lh("rtc");function ude(e,t=bs){Ux("ec",e,t)}function vHe(e,t){const i=Fs;if(i===null)return e;const r=Xx(i)||i.proxy,n=e.dirs||(e.dirs=[]);for(let o=0;o<t.length;o++){let[c,h,m,b=Pr]=t[o];c&&(mi(c)&&(c={mounted:c,updated:c}),c.deep&&n0(h),n.push({dir:c,instance:r,value:h,oldValue:void 0,arg:m,modifiers:b}))}return e}function s0(e,t,i,r){const n=e.dirs,o=t&&t.dirs;for(let c=0;c<n.length;c++){const h=n[c];o&&(h.oldValue=o[c].value);let m=h.dir[r];m&&(Dm(),al(m,i,8,[e.el,h,e,t]),jm())}}const hD="components";function bHe(e,t){return pde(hD,e,!0,t)||e}const hde=Symbol();function pde(e,t,i=!0,r=!1){const n=Fs||bs;if(n){const o=n.type;if(e===hD){const h=qde(o,!1);if(h&&(h===t||h===Uc(t)||h===Tx(Uc(t))))return o}const c=pD(n[e]||o[e],t)||pD(n.appContext[e],t);return!c&&r?o:c}}function pD(e,t){return e&&(e[t]||e[Uc(t)]||e[Tx(Uc(t))])}function wHe(e,t,i,r){let n;const o=i&&i[r];if(ti(e)||Ln(e)){n=new Array(e.length);for(let c=0,h=e.length;c<h;c++)n[c]=t(e[c],c,void 0,o&&o[c])}else if(typeof e=="number"){n=new Array(e);for(let c=0;c<e;c++)n[c]=t(c+1,c,void 0,o&&o[c])}else if(Lr(e))if(e[Symbol.iterator])n=Array.from(e,(c,h)=>t(c,h,void 0,o&&o[h]));else{const c=Object.keys(e);n=new Array(c.length);for(let h=0,m=c.length;h<m;h++){const b=c[h];n[h]=t(e[b],b,h,o&&o[h])}}else n=[];return i&&(i[r]=n),n}function _He(e,t,i={},r,n){if(Fs.isCE||Fs.parent&&Nb(Fs.parent)&&Fs.parent.isCE)return t!=="default"&&(i.name=t),Mo("slot",i,r&&r());let o=e[t];o&&o._c&&(o._d=!1),CD();const c=o&&dD(o(i)),h=PD(cl,{key:i.key||c&&c.key||`_${t}`},c||(r?r():[]),c&&e._===1?64:-2);return!n&&h.scopeId&&(h.slotScopeIds=[h.scopeId+"-s"]),o&&o._c&&(o._d=!0),h}function dD(e){return e.some(t=>Zx(t)?!(t.type===ul||t.type===cl&&!dD(t.children)):!0)?e:null}const bE=e=>e?RD(e)?Xx(e)||e.proxy:bE(e.parent):null,Db=Os(Object.create(null),{$:e=>e,$el:e=>e.vnode.el,$data:e=>e.data,$props:e=>e.props,$attrs:e=>e.attrs,$slots:e=>e.slots,$refs:e=>e.refs,$parent:e=>bE(e.parent),$root:e=>bE(e.root),$emit:e=>e.emit,$options:e=>xE(e),$forceUpdate:e=>e.f||(e.f=()=>dE(e.update)),$nextTick:e=>e.n||(e.n=WN.bind(e.proxy)),$watch:e=>Xpe.bind(e)}),wE=(e,t)=>e!==Pr&&!e.__isScriptSetup&&Di(e,t),dde={get({_:e},t){const{ctx:i,setupState:r,data:n,props:o,accessCache:c,type:h,appContext:m}=e;let b;if(t[0]!=="$"){const k=c[t];if(k!==void 0)switch(k){case 1:return r[t];case 2:return n[t];case 4:return i[t];case 3:return o[t]}else{if(wE(r,t))return c[t]=1,r[t];if(n!==Pr&&Di(n,t))return c[t]=2,n[t];if((b=e.propsOptions[0])&&Di(b,t))return c[t]=3,o[t];if(i!==Pr&&Di(i,t))return c[t]=4,i[t];_E&&(c[t]=0)}}const x=Db[t];let I,E;if(x)return t==="$attrs"&&Ca(e,"get",t),x(e);if((I=h.__cssModules)&&(I=I[t]))return I;if(i!==Pr&&Di(i,t))return c[t]=4,i[t];if(E=m.config.globalProperties,Di(E,t))return E[t]},set({_:e},t,i){const{data:r,setupState:n,ctx:o}=e;return wE(n,t)?(n[t]=i,!0):r!==Pr&&Di(r,t)?(r[t]=i,!0):Di(e.props,t)||t[0]==="$"&&t.slice(1)in e?!1:(o[t]=i,!0)},has({_:{data:e,setupState:t,accessCache:i,ctx:r,appContext:n,propsOptions:o}},c){let h;return!!i[c]||e!==Pr&&Di(e,c)||wE(t,c)||(h=o[0])&&Di(h,c)||Di(r,c)||Di(Db,c)||Di(n.config.globalProperties,c)},defineProperty(e,t,i){return i.get!=null?e._.accessCache[t]=0:Di(i,"value")&&this.set(e,t,i.value,null),Reflect.defineProperty(e,t,i)}};let _E=!0;function fde(e){const t=xE(e),i=e.proxy,r=e.ctx;_E=!1,t.beforeCreate&&fD(t.beforeCreate,e,"bc");const{data:n,computed:o,methods:c,watch:h,provide:m,inject:b,created:x,beforeMount:I,mounted:E,beforeUpdate:k,updated:P,activated:F,deactivated:N,beforeDestroy:B,beforeUnmount:z,destroyed:q,unmounted:J,render:X,renderTracked:Y,renderTriggered:ae,errorCaptured:he,serverPrefetch:fe,expose:ye,inheritAttrs:xe,components:Se,directives:Ae,filters:Oe}=t;if(b&&yde(b,r,null,e.appContext.config.unwrapInjectedRef),c)for(const et in c){const He=c[et];mi(He)&&(r[et]=He.bind(i))}if(n){const et=n.call(i,i);Lr(et)&&(e.data=Pb(et))}if(_E=!0,o)for(const et in o){const He=o[et],Et=mi(He)?He.bind(i,i):mi(He.get)?He.get.bind(i,i):Wl,Gt=!mi(He)&&mi(He.set)?He.set.bind(i):Wl,pi=Zc({get:Et,set:Gt});Object.defineProperty(r,et,{enumerable:!0,configurable:!0,get:()=>pi.value,set:ei=>pi.value=ei})}if(h)for(const et in h)yD(h[et],r,i,et);if(m){const et=mi(m)?m.call(i):m;Reflect.ownKeys(et).forEach(He=>{Vx(He,et[He])})}x&&fD(x,e,"c");function st(et,He){ti(He)?He.forEach(Et=>et(Et.bind(i))):He&&et(He.bind(i))}if(st(nde,I),st(lD,E),st(sde,k),st(ode,P),st(tde,F),st(ide,N),st(ude,he),st(cde,Y),st(lde,ae),st(cD,z),st(uD,J),st(ade,fe),ti(ye))if(ye.length){const et=e.exposed||(e.exposed={});ye.forEach(He=>{Object.defineProperty(et,He,{get:()=>i[He],set:Et=>i[He]=Et})})}else e.exposed||(e.exposed={});X&&e.render===Wl&&(e.render=X),xe!=null&&(e.inheritAttrs=xe),Se&&(e.components=Se),Ae&&(e.directives=Ae)}function yde(e,t,i=Wl,r=!1){ti(e)&&(e=SE(e));for(const n in e){const o=e[n];let c;Lr(o)?"default"in o?c=ah(o.from||n,o.default,!0):c=ah(o.from||n):c=ah(o),Rs(c)&&r?Object.defineProperty(t,n,{enumerable:!0,configurable:!0,get:()=>c.value,set:h=>c.value=h}):t[n]=c}}function fD(e,t,i){al(ti(e)?e.map(r=>r.bind(t.proxy)):e.bind(t.proxy),t,i)}function yD(e,t,i,r){const n=r.includes(".")?iD(i,r):()=>i[r];if(Ln(e)){const o=t[e];mi(o)&&Gx(n,o)}else if(mi(e))Gx(n,e.bind(i));else if(Lr(e))if(ti(e))e.forEach(o=>yD(o,t,i,r));else{const o=mi(e.handler)?e.handler.bind(i):t[e.handler];mi(o)&&Gx(n,o,e)}}function xE(e){const t=e.type,{mixins:i,extends:r}=t,{mixins:n,optionsCache:o,config:{optionMergeStrategies:c}}=e.appContext,h=o.get(t);let m;return h?m=h:!n.length&&!i&&!r?m=t:(m={},n.length&&n.forEach(b=>qx(m,b,c,!0)),qx(m,t,c)),Lr(t)&&o.set(t,m),m}function qx(e,t,i,r=!1){const{mixins:n,extends:o}=t;o&&qx(e,o,i,!0),n&&n.forEach(c=>qx(e,c,i,!0));for(const c in t)if(!(r&&c==="expose")){const h=mde[c]||i&&i[c];e[c]=h?h(e[c],t[c]):t[c]}return e}const mde={data:mD,props:o0,emits:o0,methods:o0,computed:o0,beforeCreate:So,created:So,beforeMount:So,mounted:So,beforeUpdate:So,updated:So,beforeDestroy:So,beforeUnmount:So,destroyed:So,unmounted:So,activated:So,deactivated:So,errorCaptured:So,serverPrefetch:So,components:o0,directives:o0,watch:vde,provide:mD,inject:gde};function mD(e,t){return t?e?function(){return Os(mi(e)?e.call(this,this):e,mi(t)?t.call(this,this):t)}:t:e}function gde(e,t){return o0(SE(e),SE(t))}function SE(e){if(ti(e)){const t={};for(let i=0;i<e.length;i++)t[e[i]]=e[i];return t}return e}function So(e,t){return e?[...new Set([].concat(e,t))]:t}function o0(e,t){return e?Os(Os(Object.create(null),e),t):t}function vde(e,t){if(!e)return t;if(!t)return e;const i=Os(Object.create(null),e);for(const r in t)i[r]=So(e[r],t[r]);return i}function bde(e,t,i,r=!1){const n={},o={};Cx(o,Kx,1),e.propsDefaults=Object.create(null),gD(e,t,n,o);for(const c in e.propsOptions[0])c in n||(n[c]=void 0);i?e.props=r?n:kpe(n):e.type.props?e.props=n:e.props=o,e.attrs=o}function wde(e,t,i,r){const{props:n,attrs:o,vnode:{patchFlag:c}}=e,h=Ji(n),[m]=e.propsOptions;let b=!1;if((r||c>0)&&!(c&16)){if(c&8){const x=e.vnode.dynamicProps;for(let I=0;I<x.length;I++){let E=x[I];if(Dx(e.emitsOptions,E))continue;const k=t[E];if(m)if(Di(o,E))k!==o[E]&&(o[E]=k,b=!0);else{const P=Uc(E);n[P]=ME(m,h,P,k,e,!1)}else k!==o[E]&&(o[E]=k,b=!0)}}}else{gD(e,t,n,o)&&(b=!0);let x;for(const I in h)(!t||!Di(t,I)&&((x=Nm(I))===I||!Di(t,x)))&&(m?i&&(i[I]!==void 0||i[x]!==void 0)&&(n[I]=ME(m,h,I,void 0,e,!0)):delete n[I]);if(o!==h)for(const I in o)(!t||!Di(t,I)&&!0)&&(delete o[I],b=!0)}b&&sh(e,"set","$attrs")}function gD(e,t,i,r){const[n,o]=e.propsOptions;let c=!1,h;if(t)for(let m in t){if($x(m))continue;const b=t[m];let x;n&&Di(n,x=Uc(m))?!o||!o.includes(x)?i[x]=b:(h||(h={}))[x]=b:Dx(e.emitsOptions,m)||(!(m in r)||b!==r[m])&&(r[m]=b,c=!0)}if(o){const m=Ji(i),b=h||Pr;for(let x=0;x<o.length;x++){const I=o[x];i[I]=ME(n,m,I,b[I],e,!Di(b,I))}}return c}function ME(e,t,i,r,n,o){const c=e[i];if(c!=null){const h=Di(c,"default");if(h&&r===void 0){const m=c.default;if(c.type!==Function&&mi(m)){const{propsDefaults:b}=n;i in b?r=b[i]:(Bm(n),r=b[i]=m.call(null,t),c0())}else r=m}c[0]&&(o&&!h?r=!1:c[1]&&(r===""||r===Nm(i))&&(r=!0))}return r}function vD(e,t,i=!1){const r=t.propsCache,n=r.get(e);if(n)return n;const o=e.props,c={},h=[];let m=!1;if(!mi(e)){const x=I=>{m=!0;const[E,k]=vD(I,t,!0);Os(c,E),k&&h.push(...k)};!i&&t.mixins.length&&t.mixins.forEach(x),e.extends&&x(e.extends),e.mixins&&e.mixins.forEach(x)}if(!o&&!m)return Lr(e)&&r.set(e,Rm),Rm;if(ti(o))for(let x=0;x<o.length;x++){const I=Uc(o[x]);bD(I)&&(c[I]=Pr)}else if(o)for(const x in o){const I=Uc(x);if(bD(I)){const E=o[x],k=c[I]=ti(E)||mi(E)?{type:E}:Object.assign({},E);if(k){const P=xD(Boolean,k.type),F=xD(String,k.type);k[0]=P>-1,k[1]=F<0||P<F,(P>-1||Di(k,"default"))&&h.push(I)}}}const b=[c,h];return Lr(e)&&r.set(e,b),b}function bD(e){return e[0]!=="$"}function wD(e){const t=e&&e.toString().match(/^\s*function (\w+)/);return t?t[1]:e===null?"null":""}function _D(e,t){return wD(e)===wD(t)}function xD(e,t){return ti(t)?t.findIndex(i=>_D(i,e)):mi(t)&&_D(t,e)?0:-1}const SD=e=>e[0]==="_"||e==="$stable",IE=e=>ti(e)?e.map(Wc):[Wc(e)],_de=(e,t,i)=>{if(t._n)return t;const r=qpe((...n)=>IE(t(...n)),i);return r._c=!1,r},MD=(e,t,i)=>{const r=e._ctx;for(const n in e){if(SD(n))continue;const o=e[n];if(mi(o))t[n]=_de(n,o,r);else if(o!=null){const c=IE(o);t[n]=()=>c}}},ID=(e,t)=>{const i=IE(t);e.slots.default=()=>i},xde=(e,t)=>{if(e.vnode.shapeFlag&32){const i=t._;i?(e.slots=Ji(t),Cx(t,"_",i)):MD(t,e.slots={})}else e.slots={},t&&ID(e,t);Cx(e.slots,Kx,1)},Sde=(e,t,i)=>{const{vnode:r,slots:n}=e;let o=!0,c=Pr;if(r.shapeFlag&32){const h=t._;h?i&&h===1?o=!1:(Os(n,t),!i&&h===1&&delete n._):(o=!t.$stable,MD(t,n)),c=t}else t&&(ID(e,t),c={default:1});if(o)for(const h in n)!SD(h)&&!(h in c)&&delete n[h]};function $D(){return{app:null,config:{isNativeTag:Khe,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let Mde=0;function Ide(e,t){return function(r,n=null){mi(r)||(r=Object.assign({},r)),n!=null&&!Lr(n)&&(n=null);const o=$D(),c=new Set;let h=!1;const m=o.app={_uid:Mde++,_component:r,_props:n,_container:null,_context:o,_instance:null,version:Zde,get config(){return o.config},set config(b){},use(b,...x){return c.has(b)||(b&&mi(b.install)?(c.add(b),b.install(m,...x)):mi(b)&&(c.add(b),b(m,...x))),m},mixin(b){return o.mixins.includes(b)||o.mixins.push(b),m},component(b,x){return x?(o.components[b]=x,m):o.components[b]},directive(b,x){return x?(o.directives[b]=x,m):o.directives[b]},mount(b,x,I){if(!h){const E=Mo(r,n);return E.appContext=o,x&&t?t(E,b):e(E,b,I),h=!0,m._container=b,b.__vue_app__=m,Xx(E.component)||E.component.proxy}},unmount(){h&&(e(null,m._container),delete m._container.__vue_app__)},provide(b,x){return o.provides[b]=x,m}};return m}}function $E(e,t,i,r,n=!1){if(ti(e)){e.forEach((E,k)=>$E(E,t&&(ti(t)?t[k]:t),i,r,n));return}if(Nb(r)&&!n)return;const o=r.shapeFlag&4?Xx(r.component)||r.component.proxy:r.el,c=n?null:o,{i:h,r:m}=e,b=t&&t.r,x=h.refs===Pr?h.refs={}:h.refs,I=h.setupState;if(b!=null&&b!==m&&(Ln(b)?(x[b]=null,Di(I,b)&&(I[b]=null)):Rs(b)&&(b.value=null)),mi(m))Yp(m,h,12,[c,x]);else{const E=Ln(m),k=Rs(m);if(E||k){const P=()=>{if(e.f){const F=E?Di(I,m)?I[m]:x[m]:m.value;n?ti(F)&&J$(F,o):ti(F)?F.includes(o)||F.push(o):E?(x[m]=[o],Di(I,m)&&(I[m]=x[m])):(m.value=[o],e.k&&(x[e.k]=m.value))}else E?(x[m]=c,Di(I,m)&&(I[m]=c)):k&&(m.value=c,e.k&&(x[e.k]=c))};c?(P.id=-1,Uo(P,i)):P()}}}const Uo=Ype;function $de(e){return Ede(e)}function Ede(e,t){const i=ipe();i.__VUE__=!0;const{insert:r,remove:n,patchProp:o,createElement:c,createText:h,createComment:m,setText:b,setElementText:x,parentNode:I,nextSibling:E,setScopeId:k=Wl,insertStaticContent:P}=e,F=(pe,be,Le,Ve=null,Ge=null,Be=null,Q=!1,Je=null,Qe=!!be.dynamicChildren)=>{if(pe===be)return;pe&&!l0(pe,be)&&(Ve=rt(pe),ei(pe,Ge,Be,!0),pe=null),be.patchFlag===-2&&(Qe=!1,be.dynamicChildren=null);const{type:Pe,ref:dt,shapeFlag:vt}=be;switch(Pe){case Wx:N(pe,be,Le,Ve);break;case ul:B(pe,be,Le,Ve);break;case Jx:pe==null&&z(be,Le,Ve,Q);break;case cl:Se(pe,be,Le,Ve,Ge,Be,Q,Je,Qe);break;default:vt&1?X(pe,be,Le,Ve,Ge,Be,Q,Je,Qe):vt&6?Ae(pe,be,Le,Ve,Ge,Be,Q,Je,Qe):(vt&64||vt&128)&&Pe.process(pe,be,Le,Ve,Ge,Be,Q,Je,Qe,ni)}dt!=null&&Ge&&$E(dt,pe&&pe.ref,Be,be||pe,!be)},N=(pe,be,Le,Ve)=>{if(pe==null)r(be.el=h(be.children),Le,Ve);else{const Ge=be.el=pe.el;be.children!==pe.children&&b(Ge,be.children)}},B=(pe,be,Le,Ve)=>{pe==null?r(be.el=m(be.children||""),Le,Ve):be.el=pe.el},z=(pe,be,Le,Ve)=>{[pe.el,pe.anchor]=P(pe.children,be,Le,Ve,pe.el,pe.anchor)},q=({el:pe,anchor:be},Le,Ve)=>{let Ge;for(;pe&&pe!==be;)Ge=E(pe),r(pe,Le,Ve),pe=Ge;r(be,Le,Ve)},J=({el:pe,anchor:be})=>{let Le;for(;pe&&pe!==be;)Le=E(pe),n(pe),pe=Le;n(be)},X=(pe,be,Le,Ve,Ge,Be,Q,Je,Qe)=>{Q=Q||be.type==="svg",pe==null?Y(be,Le,Ve,Ge,Be,Q,Je,Qe):fe(pe,be,Ge,Be,Q,Je,Qe)},Y=(pe,be,Le,Ve,Ge,Be,Q,Je)=>{let Qe,Pe;const{type:dt,props:vt,shapeFlag:$t,transition:Ct,dirs:qt}=pe;if(Qe=pe.el=c(pe.type,Be,vt&&vt.is,vt),$t&8?x(Qe,pe.children):$t&16&&he(pe.children,Qe,null,Ve,Ge,Be&&dt!=="foreignObject",Q,Je),qt&&s0(pe,null,Ve,"created"),vt){for(const Si in vt)Si!=="value"&&!$x(Si)&&o(Qe,Si,null,vt[Si],Be,pe.children,Ve,Ge,at);"value"in vt&&o(Qe,"value",null,vt.value),(Pe=vt.onVnodeBeforeMount)&&Jc(Pe,Ve,pe)}ae(Qe,pe,pe.scopeId,Q,Ve),qt&&s0(pe,null,Ve,"beforeMount");const oi=(!Ge||Ge&&!Ge.pendingBranch)&&Ct&&!Ct.persisted;oi&&Ct.beforeEnter(Qe),r(Qe,be,Le),((Pe=vt&&vt.onVnodeMounted)||oi||qt)&&Uo(()=>{Pe&&Jc(Pe,Ve,pe),oi&&Ct.enter(Qe),qt&&s0(pe,null,Ve,"mounted")},Ge)},ae=(pe,be,Le,Ve,Ge)=>{if(Le&&k(pe,Le),Ve)for(let Be=0;Be<Ve.length;Be++)k(pe,Ve[Be]);if(Ge){let Be=Ge.subTree;if(be===Be){const Q=Ge.vnode;ae(pe,Q,Q.scopeId,Q.slotScopeIds,Ge.parent)}}},he=(pe,be,Le,Ve,Ge,Be,Q,Je,Qe=0)=>{for(let Pe=Qe;Pe<pe.length;Pe++){const dt=pe[Pe]=Je?Qp(pe[Pe]):Wc(pe[Pe]);F(null,dt,be,Le,Ve,Ge,Be,Q,Je)}},fe=(pe,be,Le,Ve,Ge,Be,Q)=>{const Je=be.el=pe.el;let{patchFlag:Qe,dynamicChildren:Pe,dirs:dt}=be;Qe|=pe.patchFlag&16;const vt=pe.props||Pr,$t=be.props||Pr;let Ct;Le&&a0(Le,!1),(Ct=$t.onVnodeBeforeUpdate)&&Jc(Ct,Le,be,pe),dt&&s0(be,pe,Le,"beforeUpdate"),Le&&a0(Le,!0);const qt=Ge&&be.type!=="foreignObject";if(Pe?ye(pe.dynamicChildren,Pe,Je,Le,Ve,qt,Be):Q||He(pe,be,Je,null,Le,Ve,qt,Be,!1),Qe>0){if(Qe&16)xe(Je,be,vt,$t,Le,Ve,Ge);else if(Qe&2&&vt.class!==$t.class&&o(Je,"class",null,$t.class,Ge),Qe&4&&o(Je,"style",vt.style,$t.style,Ge),Qe&8){const oi=be.dynamicProps;for(let Si=0;Si<oi.length;Si++){const Bi=oi[Si],Ue=vt[Bi],Ls=$t[Bi];(Ls!==Ue||Bi==="value")&&o(Je,Bi,Ue,Ls,Ge,pe.children,Le,Ve,at)}}Qe&1&&pe.children!==be.children&&x(Je,be.children)}else!Q&&Pe==null&&xe(Je,be,vt,$t,Le,Ve,Ge);((Ct=$t.onVnodeUpdated)||dt)&&Uo(()=>{Ct&&Jc(Ct,Le,be,pe),dt&&s0(be,pe,Le,"updated")},Ve)},ye=(pe,be,Le,Ve,Ge,Be,Q)=>{for(let Je=0;Je<be.length;Je++){const Qe=pe[Je],Pe=be[Je],dt=Qe.el&&(Qe.type===cl||!l0(Qe,Pe)||Qe.shapeFlag&(6|64))?I(Qe.el):Le;F(Qe,Pe,dt,null,Ve,Ge,Be,Q,!0)}},xe=(pe,be,Le,Ve,Ge,Be,Q)=>{if(Le!==Ve){if(Le!==Pr)for(const Je in Le)!$x(Je)&&!(Je in Ve)&&o(pe,Je,Le[Je],null,Q,be.children,Ge,Be,at);for(const Je in Ve){if($x(Je))continue;const Qe=Ve[Je],Pe=Le[Je];Qe!==Pe&&Je!=="value"&&o(pe,Je,Pe,Qe,Q,be.children,Ge,Be,at)}"value"in Ve&&o(pe,"value",Le.value,Ve.value)}},Se=(pe,be,Le,Ve,Ge,Be,Q,Je,Qe)=>{const Pe=be.el=pe?pe.el:h(""),dt=be.anchor=pe?pe.anchor:h("");let{patchFlag:vt,dynamicChildren:$t,slotScopeIds:Ct}=be;Ct&&(Je=Je?Je.concat(Ct):Ct),pe==null?(r(Pe,Le,Ve),r(dt,Le,Ve),he(be.children,Le,dt,Ge,Be,Q,Je,Qe)):vt>0&&vt&64&&$t&&pe.dynamicChildren?(ye(pe.dynamicChildren,$t,Le,Ge,Be,Q,Je),(be.key!=null||Ge&&be===Ge.subTree)&&EE(pe,be,!0)):He(pe,be,Le,dt,Ge,Be,Q,Je,Qe)},Ae=(pe,be,Le,Ve,Ge,Be,Q,Je,Qe)=>{be.slotScopeIds=Je,pe==null?be.shapeFlag&512?Ge.ctx.activate(be,Le,Ve,Q,Qe):Oe(be,Le,Ve,Ge,Be,Q,Qe):bt(pe,be,Qe)},Oe=(pe,be,Le,Ve,Ge,Be,Q)=>{const Je=pe.component=jde(pe,Ve,Ge);if(Bx(pe)&&(Je.ctx.renderer=ni),zde(Je),Je.asyncDep){if(Ge&&Ge.registerDep(Je,st),!pe.el){const Qe=Je.subTree=Mo(ul);B(null,Qe,be,Le)}return}st(Je,pe,be,Le,Ge,Be,Q)},bt=(pe,be,Le)=>{const Ve=be.component=pe.component;if(Jpe(pe,be,Le))if(Ve.asyncDep&&!Ve.asyncResolved){et(Ve,be,Le);return}else Ve.next=be,zpe(Ve.update),Ve.update();else be.el=pe.el,Ve.vnode=be},st=(pe,be,Le,Ve,Ge,Be,Q)=>{const Je=()=>{if(pe.isMounted){let{next:dt,bu:vt,u:$t,parent:Ct,vnode:qt}=pe,oi=dt,Si;a0(pe,!1),dt?(dt.el=qt.el,et(pe,dt,Q)):dt=qt,vt&&X$(vt),(Si=dt.props&&dt.props.onVnodeBeforeUpdate)&&Jc(Si,Ct,dt,qt),a0(pe,!0);const Bi=fE(pe),Ue=pe.subTree;pe.subTree=Bi,F(Ue,Bi,I(Ue.el),rt(Ue),pe,Ge,Be),dt.el=Bi.el,oi===null&&Zpe(pe,Bi.el),$t&&Uo($t,Ge),(Si=dt.props&&dt.props.onVnodeUpdated)&&Uo(()=>Jc(Si,Ct,dt,qt),Ge)}else{let dt;const{el:vt,props:$t}=be,{bm:Ct,m:qt,parent:oi}=pe,Si=Nb(be);if(a0(pe,!1),Ct&&X$(Ct),!Si&&(dt=$t&&$t.onVnodeBeforeMount)&&Jc(dt,oi,be),a0(pe,!0),vt&&Ut){const Bi=()=>{pe.subTree=fE(pe),Ut(vt,pe.subTree,pe,Ge,null)};Si?be.type.__asyncLoader().then(()=>!pe.isUnmounted&&Bi()):Bi()}else{const Bi=pe.subTree=fE(pe);F(null,Bi,Le,Ve,pe,Ge,Be),be.el=Bi.el}if(qt&&Uo(qt,Ge),!Si&&(dt=$t&&$t.onVnodeMounted)){const Bi=be;Uo(()=>Jc(dt,oi,Bi),Ge)}(be.shapeFlag&256||oi&&Nb(oi.vnode)&&oi.vnode.shapeFlag&256)&&pe.a&&Uo(pe.a,Ge),pe.isMounted=!0,be=Le=Ve=null}},Qe=pe.effect=new nE(Je,()=>dE(Pe),pe.scope),Pe=pe.update=()=>Qe.run();Pe.id=pe.uid,a0(pe,!0),Pe()},et=(pe,be,Le)=>{be.component=pe;const Ve=pe.vnode.props;pe.vnode=be,pe.next=null,wde(pe,be.props,Ve,Le),Sde(pe,be.children,Le),Dm(),ZN(),jm()},He=(pe,be,Le,Ve,Ge,Be,Q,Je,Qe=!1)=>{const Pe=pe&&pe.children,dt=pe?pe.shapeFlag:0,vt=be.children,{patchFlag:$t,shapeFlag:Ct}=be;if($t>0){if($t&128){Gt(Pe,vt,Le,Ve,Ge,Be,Q,Je,Qe);return}else if($t&256){Et(Pe,vt,Le,Ve,Ge,Be,Q,Je,Qe);return}}Ct&8?(dt&16&&at(Pe,Ge,Be),vt!==Pe&&x(Le,vt)):dt&16?Ct&16?Gt(Pe,vt,Le,Ve,Ge,Be,Q,Je,Qe):at(Pe,Ge,Be,!0):(dt&8&&x(Le,""),Ct&16&&he(vt,Le,Ve,Ge,Be,Q,Je,Qe))},Et=(pe,be,Le,Ve,Ge,Be,Q,Je,Qe)=>{pe=pe||Rm,be=be||Rm;const Pe=pe.length,dt=be.length,vt=Math.min(Pe,dt);let $t;for($t=0;$t<vt;$t++){const Ct=be[$t]=Qe?Qp(be[$t]):Wc(be[$t]);F(pe[$t],Ct,Le,null,Ge,Be,Q,Je,Qe)}Pe>dt?at(pe,Ge,Be,!0,!1,vt):he(be,Le,Ve,Ge,Be,Q,Je,Qe,vt)},Gt=(pe,be,Le,Ve,Ge,Be,Q,Je,Qe)=>{let Pe=0;const dt=be.length;let vt=pe.length-1,$t=dt-1;for(;Pe<=vt&&Pe<=$t;){const Ct=pe[Pe],qt=be[Pe]=Qe?Qp(be[Pe]):Wc(be[Pe]);if(l0(Ct,qt))F(Ct,qt,Le,null,Ge,Be,Q,Je,Qe);else break;Pe++}for(;Pe<=vt&&Pe<=$t;){const Ct=pe[vt],qt=be[$t]=Qe?Qp(be[$t]):Wc(be[$t]);if(l0(Ct,qt))F(Ct,qt,Le,null,Ge,Be,Q,Je,Qe);else break;vt--,$t--}if(Pe>vt){if(Pe<=$t){const Ct=$t+1,qt=Ct<dt?be[Ct].el:Ve;for(;Pe<=$t;)F(null,be[Pe]=Qe?Qp(be[Pe]):Wc(be[Pe]),Le,qt,Ge,Be,Q,Je,Qe),Pe++}}else if(Pe>$t)for(;Pe<=vt;)ei(pe[Pe],Ge,Be,!0),Pe++;else{const Ct=Pe,qt=Pe,oi=new Map;for(Pe=qt;Pe<=$t;Pe++){const p=be[Pe]=Qe?Qp(be[Pe]):Wc(be[Pe]);p.key!=null&&oi.set(p.key,Pe)}let Si,Bi=0;const Ue=$t-qt+1;let Ls=!1,d=0;const O=new Array(Ue);for(Pe=0;Pe<Ue;Pe++)O[Pe]=0;for(Pe=Ct;Pe<=vt;Pe++){const p=pe[Pe];if(Bi>=Ue){ei(p,Ge,Be,!0);continue}let l;if(p.key!=null)l=oi.get(p.key);else for(Si=qt;Si<=$t;Si++)if(O[Si-qt]===0&&l0(p,be[Si])){l=Si;break}l===void 0?ei(p,Ge,Be,!0):(O[l-qt]=Pe+1,l>=d?d=l:Ls=!0,F(p,be[l],Le,null,Ge,Be,Q,Je,Qe),Bi++)}const S=Ls?Tde(O):Rm;for(Si=S.length-1,Pe=Ue-1;Pe>=0;Pe--){const p=qt+Pe,l=be[p],s=p+1<dt?be[p+1].el:Ve;O[Pe]===0?F(null,l,Le,s,Ge,Be,Q,Je,Qe):Ls&&(Si<0||Pe!==S[Si]?pi(l,Le,s,2):Si--)}}},pi=(pe,be,Le,Ve,Ge=null)=>{const{el:Be,type:Q,transition:Je,children:Qe,shapeFlag:Pe}=pe;if(Pe&6){pi(pe.component.subTree,be,Le,Ve);return}if(Pe&128){pe.suspense.move(be,Le,Ve);return}if(Pe&64){Q.move(pe,be,Le,ni);return}if(Q===cl){r(Be,be,Le);for(let vt=0;vt<Qe.length;vt++)pi(Qe[vt],be,Le,Ve);r(pe.anchor,be,Le);return}if(Q===Jx){q(pe,be,Le);return}if(Ve!==2&&Pe&1&&Je)if(Ve===0)Je.beforeEnter(Be),r(Be,be,Le),Uo(()=>Je.enter(Be),Ge);else{const{leave:vt,delayLeave:$t,afterLeave:Ct}=Je,qt=()=>r(Be,be,Le),oi=()=>{vt(Be,()=>{qt(),Ct&&Ct()})};$t?$t(Be,qt,oi):oi()}else r(Be,be,Le)},ei=(pe,be,Le,Ve=!1,Ge=!1)=>{const{type:Be,props:Q,ref:Je,children:Qe,dynamicChildren:Pe,shapeFlag:dt,patchFlag:vt,dirs:$t}=pe;if(Je!=null&&$E(Je,null,Le,pe,!0),dt&256){be.ctx.deactivate(pe);return}const Ct=dt&1&&$t,qt=!Nb(pe);let oi;if(qt&&(oi=Q&&Q.onVnodeBeforeUnmount)&&Jc(oi,be,pe),dt&6)je(pe.component,Le,Ve);else{if(dt&128){pe.suspense.unmount(Le,Ve);return}Ct&&s0(pe,null,be,"beforeUnmount"),dt&64?pe.type.remove(pe,be,Le,Ge,ni,Ve):Pe&&(Be!==cl||vt>0&&vt&64)?at(Pe,be,Le,!1,!0):(Be===cl&&vt&(128|256)||!Ge&&dt&16)&&at(Qe,be,Le),Ve&&pn(pe)}(qt&&(oi=Q&&Q.onVnodeUnmounted)||Ct)&&Uo(()=>{oi&&Jc(oi,be,pe),Ct&&s0(pe,null,be,"unmounted")},Le)},pn=pe=>{const{type:be,el:Le,anchor:Ve,transition:Ge}=pe;if(be===cl){Sr(Le,Ve);return}if(be===Jx){J(pe);return}const Be=()=>{n(Le),Ge&&!Ge.persisted&&Ge.afterLeave&&Ge.afterLeave()};if(pe.shapeFlag&1&&Ge&&!Ge.persisted){const{leave:Q,delayLeave:Je}=Ge,Qe=()=>Q(Le,Be);Je?Je(pe.el,Be,Qe):Qe()}else Be()},Sr=(pe,be)=>{let Le;for(;pe!==be;)Le=E(pe),n(pe),pe=Le;n(be)},je=(pe,be,Le)=>{const{bum:Ve,scope:Ge,update:Be,subTree:Q,um:Je}=pe;Ve&&X$(Ve),Ge.stop(),Be&&(Be.active=!1,ei(Q,pe,be,Le)),Je&&Uo(Je,be),Uo(()=>{pe.isUnmounted=!0},be),be&&be.pendingBranch&&!be.isUnmounted&&pe.asyncDep&&!pe.asyncResolved&&pe.suspenseId===be.pendingId&&(be.deps--,be.deps===0&&be.resolve())},at=(pe,be,Le,Ve=!1,Ge=!1,Be=0)=>{for(let Q=Be;Q<pe.length;Q++)ei(pe[Q],be,Le,Ve,Ge)},rt=pe=>pe.shapeFlag&6?rt(pe.component.subTree):pe.shapeFlag&128?pe.suspense.next():E(pe.anchor||pe.el),It=(pe,be,Le)=>{pe==null?be._vnode&&ei(be._vnode,null,null,!0):F(be._vnode||null,pe,be,null,null,null,Le),ZN(),KN(),be._vnode=pe},ni={p:F,um:ei,m:pi,r:pn,mt:Oe,mc:he,pc:He,pbc:ye,n:rt,o:e};let Ai,Ut;return t&&([Ai,Ut]=t(ni)),{render:It,hydrate:Ai,createApp:Ide(It,Ai)}}function a0({effect:e,update:t},i){e.allowRecurse=t.allowRecurse=i}function EE(e,t,i=!1){const r=e.children,n=t.children;if(ti(r)&&ti(n))for(let o=0;o<r.length;o++){const c=r[o];let h=n[o];h.shapeFlag&1&&!h.dynamicChildren&&((h.patchFlag<=0||h.patchFlag===32)&&(h=n[o]=Qp(n[o]),h.el=c.el),i||EE(c,h)),h.type===Wx&&(h.el=c.el)}}function Tde(e){const t=e.slice(),i=[0];let r,n,o,c,h;const m=e.length;for(r=0;r<m;r++){const b=e[r];if(b!==0){if(n=i[i.length-1],e[n]<b){t[r]=n,i.push(r);continue}for(o=0,c=i.length-1;o<c;)h=o+c>>1,e[i[h]]<b?o=h+1:c=h;b<e[i[o]]&&(o>0&&(t[r]=i[o-1]),i[o]=r)}}for(o=i.length,c=i[o-1];o-- >0;)i[o]=c,c=t[c];return i}const Cde=e=>e.__isTeleport,jb=e=>e&&(e.disabled||e.disabled===""),ED=e=>typeof SVGElement!="undefined"&&e instanceof SVGElement,TE=(e,t)=>{const i=e&&e.to;return Ln(i)?t?t(i):null:i},kde={__isTeleport:!0,process(e,t,i,r,n,o,c,h,m,b){const{mc:x,pc:I,pbc:E,o:{insert:k,querySelector:P,createText:F,createComment:N}}=b,B=jb(t.props);let{shapeFlag:z,children:q,dynamicChildren:J}=t;if(e==null){const X=t.el=F(""),Y=t.anchor=F("");k(X,i,r),k(Y,i,r);const ae=t.target=TE(t.props,P),he=t.targetAnchor=F("");ae&&(k(he,ae),c=c||ED(ae));const fe=(ye,xe)=>{z&16&&x(q,ye,xe,n,o,c,h,m)};B?fe(i,Y):ae&&fe(ae,he)}else{t.el=e.el;const X=t.anchor=e.anchor,Y=t.target=e.target,ae=t.targetAnchor=e.targetAnchor,he=jb(e.props),fe=he?i:Y,ye=he?X:ae;if(c=c||ED(Y),J?(E(e.dynamicChildren,J,fe,n,o,c,h),EE(e,t,!0)):m||I(e,t,fe,ye,n,o,c,h,!1),B)he||Hx(t,i,X,b,1);else if((t.props&&t.props.to)!==(e.props&&e.props.to)){const xe=t.target=TE(t.props,P);xe&&Hx(t,xe,null,b,0)}else he&&Hx(t,Y,ae,b,1)}TD(t)},remove(e,t,i,r,{um:n,o:{remove:o}},c){const{shapeFlag:h,children:m,anchor:b,targetAnchor:x,target:I,props:E}=e;if(I&&o(x),(c||!jb(E))&&(o(b),h&16))for(let k=0;k<m.length;k++){const P=m[k];n(P,t,i,!0,!!P.dynamicChildren)}},move:Hx,hydrate:Ade};function Hx(e,t,i,{o:{insert:r},m:n},o=2){o===0&&r(e.targetAnchor,t,i);const{el:c,anchor:h,shapeFlag:m,children:b,props:x}=e,I=o===2;if(I&&r(c,t,i),(!I||jb(x))&&m&16)for(let E=0;E<b.length;E++)n(b[E],t,i,2);I&&r(h,t,i)}function Ade(e,t,i,r,n,o,{o:{nextSibling:c,parentNode:h,querySelector:m}},b){const x=t.target=TE(t.props,m);if(x){const I=x._lpa||x.firstChild;if(t.shapeFlag&16)if(jb(t.props))t.anchor=b(c(e),t,h(e),i,r,n,o),t.targetAnchor=I;else{t.anchor=c(e);let E=I;for(;E;)if(E=c(E),E&&E.nodeType===8&&E.data==="teleport anchor"){t.targetAnchor=E,x._lpa=t.targetAnchor&&c(t.targetAnchor);break}b(I,t,x,i,r,n,o)}TD(t)}return t.anchor&&c(t.anchor)}const xHe=kde;function TD(e){const t=e.ctx;if(t&&t.ut){let i=e.children[0].el;for(;i!==e.targetAnchor;)i.nodeType===1&&i.setAttribute("data-v-owner",t.uid),i=i.nextSibling;t.ut()}}const cl=Symbol(void 0),Wx=Symbol(void 0),ul=Symbol(void 0),Jx=Symbol(void 0),Vb=[];let Zl=null;function CD(e=!1){Vb.push(Zl=e?null:[])}function Pde(){Vb.pop(),Zl=Vb[Vb.length-1]||null}let zb=1;function kD(e){zb+=e}function AD(e){return e.dynamicChildren=zb>0?Zl||Rm:null,Pde(),zb>0&&Zl&&Zl.push(e),e}function SHe(e,t,i,r,n,o){return AD(OD(e,t,i,r,n,o,!0))}function PD(e,t,i,r,n){return AD(Mo(e,t,i,r,n,!0))}function Zx(e){return e?e.__v_isVNode===!0:!1}function l0(e,t){return e.type===t.type&&e.key===t.key}const Kx="__vInternal",LD=({key:e})=>e!=null?e:null,Yx=({ref:e,ref_key:t,ref_for:i})=>e!=null?Ln(e)||Rs(e)||mi(e)?{i:Fs,r:e,k:t,f:!!i}:e:null;function OD(e,t=null,i=null,r=0,n=null,o=e===cl?0:1,c=!1,h=!1){const m={__v_isVNode:!0,__v_skip:!0,type:e,props:t,key:t&&LD(t),ref:t&&Yx(t),scopeId:QN,slotScopeIds:null,children:i,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetAnchor:null,staticCount:0,shapeFlag:o,patchFlag:r,dynamicProps:n,dynamicChildren:null,appContext:null,ctx:Fs};return h?(CE(m,i),o&128&&e.normalize(m)):i&&(m.shapeFlag|=Ln(i)?8:16),zb>0&&!c&&Zl&&(m.patchFlag>0||o&6)&&m.patchFlag!==32&&Zl.push(m),m}const Mo=Lde;function Lde(e,t=null,i=null,r=0,n=null,o=!1){if((!e||e===hde)&&(e=ul),Zx(e)){const h=Xp(e,t,!0);return i&&CE(h,i),zb>0&&!o&&Zl&&(h.shapeFlag&6?Zl[Zl.indexOf(e)]=h:Zl.push(h)),h.patchFlag|=-2,h}if(Hde(e)&&(e=e.__vccOpts),t){t=Ode(t);let{class:h,style:m}=t;h&&!Ln(h)&&(t.class=H$(h)),Lr(m)&&(jN(m)&&!ti(m)&&(m=Os({},m)),t.style=q$(m))}const c=Ln(e)?1:Kpe(e)?128:Cde(e)?64:Lr(e)?4:mi(e)?2:0;return OD(e,t,i,r,n,c,o,!0)}function Ode(e){return e?jN(e)||Kx in e?Os({},e):e:null}function Xp(e,t,i=!1){const{props:r,ref:n,patchFlag:o,children:c}=e,h=t?Fde(r||{},t):r;return{__v_isVNode:!0,__v_skip:!0,type:e.type,props:h,key:h&&LD(h),ref:t&&t.ref?i&&n?ti(n)?n.concat(Yx(t)):[n,Yx(t)]:Yx(t):n,scopeId:e.scopeId,slotScopeIds:e.slotScopeIds,children:c,target:e.target,targetAnchor:e.targetAnchor,staticCount:e.staticCount,shapeFlag:e.shapeFlag,patchFlag:t&&e.type!==cl?o===-1?16:o|16:o,dynamicProps:e.dynamicProps,dynamicChildren:e.dynamicChildren,appContext:e.appContext,dirs:e.dirs,transition:e.transition,component:e.component,suspense:e.suspense,ssContent:e.ssContent&&Xp(e.ssContent),ssFallback:e.ssFallback&&Xp(e.ssFallback),el:e.el,anchor:e.anchor,ctx:e.ctx}}function Rde(e=" ",t=0){return Mo(Wx,null,e,t)}function MHe(e,t){const i=Mo(Jx,null,e);return i.staticCount=t,i}function IHe(e="",t=!1){return t?(CD(),PD(ul,null,e)):Mo(ul,null,e)}function Wc(e){return e==null||typeof e=="boolean"?Mo(ul):ti(e)?Mo(cl,null,e.slice()):typeof e=="object"?Qp(e):Mo(Wx,null,String(e))}function Qp(e){return e.el===null&&e.patchFlag!==-1||e.memo?e:Xp(e)}function CE(e,t){let i=0;const{shapeFlag:r}=e;if(t==null)t=null;else if(ti(t))i=16;else if(typeof t=="object")if(r&(1|64)){const n=t.default;n&&(n._c&&(n._d=!1),CE(e,n()),n._c&&(n._d=!0));return}else{i=32;const n=t._;!n&&!(Kx in t)?t._ctx=Fs:n===3&&Fs&&(Fs.slots._===1?t._=1:(t._=2,e.patchFlag|=1024))}else mi(t)?(t={default:t,_ctx:Fs},i=32):(t=String(t),r&64?(i=16,t=[Rde(t)]):i=8);e.children=t,e.shapeFlag|=i}function Fde(...e){const t={};for(let i=0;i<e.length;i++){const r=e[i];for(const n in r)if(n==="class")t.class!==r.class&&(t.class=H$([t.class,r.class]));else if(n==="style")t.style=q$([t.style,r.style]);else if(Mx(n)){const o=t[n],c=r[n];c&&o!==c&&!(ti(o)&&o.includes(c))&&(t[n]=o?[].concat(o,c):c)}else n!==""&&(t[n]=r[n])}return t}function Jc(e,t,i,r=null){al(e,t,7,[i,r])}const Nde=$D();let Dde=0;function jde(e,t,i){const r=e.type,n=(t?t.appContext:e.appContext)||Nde,o={uid:Dde++,vnode:e,type:r,parent:t,appContext:n,root:null,next:null,subTree:null,effect:null,update:null,scope:new rpe(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:t?t.provides:Object.create(n.provides),accessCache:null,renderCache:[],components:null,directives:null,propsOptions:vD(r,n),emitsOptions:XN(r,n),emit:null,emitted:null,propsDefaults:Pr,inheritAttrs:r.inheritAttrs,ctx:Pr,data:Pr,props:Pr,attrs:Pr,slots:Pr,refs:Pr,setupState:Pr,setupContext:null,suspense:i,suspenseId:i?i.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return o.ctx={_:o},o.root=t?t.root:o,o.emit=Upe.bind(null,o),e.ce&&e.ce(o),o}let bs=null;const Vde=()=>bs||Fs,Bm=e=>{bs=e,e.scope.on()},c0=()=>{bs&&bs.scope.off(),bs=null};function RD(e){return e.vnode.shapeFlag&4}let Gb=!1;function zde(e,t=!1){Gb=t;const{props:i,children:r}=e.vnode,n=RD(e);bde(e,i,n,t),xde(e,r);const o=n?Gde(e,t):void 0;return Gb=!1,o}function Gde(e,t){const i=e.type;e.accessCache=Object.create(null),e.proxy=VN(new Proxy(e.ctx,dde));const{setup:r}=i;if(r){const n=e.setupContext=r.length>1?Ude(e):null;Bm(e),Dm();const o=Yp(r,e,0,[e.props,n]);if(jm(),c0(),gN(o)){if(o.then(c0,c0),t)return o.then(c=>{FD(e,c,t)}).catch(c=>{Nx(c,e,0)});e.asyncDep=o}else FD(e,o,t)}else DD(e,t)}function FD(e,t,i){mi(t)?e.type.__ssrInlineRender?e.ssrRender=t:e.render=t:Lr(t)&&(e.setupState=UN(t)),DD(e,i)}let ND;function DD(e,t,i){const r=e.type;if(!e.render){if(!t&&ND&&!r.render){const n=r.template||xE(e).template;if(n){const{isCustomElement:o,compilerOptions:c}=e.appContext.config,{delimiters:h,compilerOptions:m}=r,b=Os(Os({isCustomElement:o,delimiters:h},c),m);r.render=ND(n,b)}}e.render=r.render||Wl}Bm(e),Dm(),fde(e),jm(),c0()}function Bde(e){return new Proxy(e.attrs,{get(t,i){return Ca(e,"get","$attrs"),t[i]}})}function Ude(e){const t=r=>{e.exposed=r||{}};let i;return{get attrs(){return i||(i=Bde(e))},slots:e.slots,emit:e.emit,expose:t}}function Xx(e){if(e.exposed)return e.exposeProxy||(e.exposeProxy=new Proxy(UN(VN(e.exposed)),{get(t,i){if(i in t)return t[i];if(i in Db)return Db[i](e)},has(t,i){return i in t||i in Db}}))}function qde(e,t=!0){return mi(e)?e.displayName||e.name:e.name||t&&e.__name}function Hde(e){return mi(e)&&"__vccOpts"in e}const Zc=(e,t)=>Dpe(e,t,Gb);function Bb(e,t,i){const r=arguments.length;return r===2?Lr(t)&&!ti(t)?Zx(t)?Mo(e,null,[t]):Mo(e,t):Mo(e,null,t):(r>3?i=Array.prototype.slice.call(arguments,2):r===3&&Zx(i)&&(i=[i]),Mo(e,t,i))}const Wde=Symbol(""),Jde=()=>ah(Wde),Zde="3.2.45",Kde="http://www.w3.org/2000/svg",u0=typeof document!="undefined"?document:null,jD=u0&&u0.createElement("template"),Yde={insert:(e,t,i)=>{t.insertBefore(e,i||null)},remove:e=>{const t=e.parentNode;t&&t.removeChild(e)},createElement:(e,t,i,r)=>{const n=t?u0.createElementNS(Kde,e):u0.createElement(e,i?{is:i}:void 0);return e==="select"&&r&&r.multiple!=null&&n.setAttribute("multiple",r.multiple),n},createText:e=>u0.createTextNode(e),createComment:e=>u0.createComment(e),setText:(e,t)=>{e.nodeValue=t},setElementText:(e,t)=>{e.textContent=t},parentNode:e=>e.parentNode,nextSibling:e=>e.nextSibling,querySelector:e=>u0.querySelector(e),setScopeId(e,t){e.setAttribute(t,"")},insertStaticContent(e,t,i,r,n,o){const c=i?i.previousSibling:t.lastChild;if(n&&(n===o||n.nextSibling))for(;t.insertBefore(n.cloneNode(!0),i),!(n===o||!(n=n.nextSibling)););else{jD.innerHTML=r?`<svg>${e}</svg>`:e;const h=jD.content;if(r){const m=h.firstChild;for(;m.firstChild;)h.appendChild(m.firstChild);h.removeChild(m)}t.insertBefore(h,i)}return[c?c.nextSibling:t.firstChild,i?i.previousSibling:t.lastChild]}};function Xde(e,t,i){const r=e._vtc;r&&(t=(t?[t,...r]:[...r]).join(" ")),t==null?e.removeAttribute("class"):i?e.setAttribute("class",t):e.className=t}function Qde(e,t,i){const r=e.style,n=Ln(i);if(i&&!n){for(const o in i)kE(r,o,i[o]);if(t&&!Ln(t))for(const o in t)i[o]==null&&kE(r,o,"")}else{const o=r.display;n?t!==i&&(r.cssText=i):t&&e.removeAttribute("style"),"_vod"in e&&(r.display=o)}}const VD=/\s*!important$/;function kE(e,t,i){if(ti(i))i.forEach(r=>kE(e,t,r));else if(i==null&&(i=""),t.startsWith("--"))e.setProperty(t,i);else{const r=efe(e,t);VD.test(i)?e.setProperty(Nm(r),i.replace(VD,""),"important"):e[r]=i}}const zD=["Webkit","Moz","ms"],AE={};function efe(e,t){const i=AE[t];if(i)return i;let r=Uc(t);if(r!=="filter"&&r in e)return AE[t]=r;r=Tx(r);for(let n=0;n<zD.length;n++){const o=zD[n]+r;if(o in e)return AE[t]=o}return t}const GD="http://www.w3.org/1999/xlink";function tfe(e,t,i,r,n){if(r&&t.startsWith("xlink:"))i==null?e.removeAttributeNS(GD,t.slice(6,t.length)):e.setAttributeNS(GD,t,i);else{const o=Zhe(t);i==null||o&&!fN(i)?e.removeAttribute(t):e.setAttribute(t,o?"":i)}}function ife(e,t,i,r,n,o,c){if(t==="innerHTML"||t==="textContent"){r&&c(r,n,o),e[t]=i==null?"":i;return}if(t==="value"&&e.tagName!=="PROGRESS"&&!e.tagName.includes("-")){e._value=i;const m=i==null?"":i;(e.value!==m||e.tagName==="OPTION")&&(e.value=m),i==null&&e.removeAttribute(t);return}let h=!1;if(i===""||i==null){const m=typeof e[t];m==="boolean"?i=fN(i):i==null&&m==="string"?(i="",h=!0):m==="number"&&(i=0,h=!0)}try{e[t]=i}catch{}h&&e.removeAttribute(t)}function rfe(e,t,i,r){e.addEventListener(t,i,r)}function nfe(e,t,i,r){e.removeEventListener(t,i,r)}function sfe(e,t,i,r,n=null){const o=e._vei||(e._vei={}),c=o[t];if(r&&c)c.value=r;else{const[h,m]=ofe(t);if(r){const b=o[t]=cfe(r,n);rfe(e,h,b,m)}else c&&(nfe(e,h,c,m),o[t]=void 0)}}const BD=/(?:Once|Passive|Capture)$/;function ofe(e){let t;if(BD.test(e)){t={};let r;for(;r=e.match(BD);)e=e.slice(0,e.length-r[0].length),t[r[0].toLowerCase()]=!0}return[e[2]===":"?e.slice(3):Nm(e.slice(2)),t]}let PE=0;const afe=Promise.resolve(),lfe=()=>PE||(afe.then(()=>PE=0),PE=Date.now());function cfe(e,t){const i=r=>{if(!r._vts)r._vts=Date.now();else if(r._vts<=i.attached)return;al(ufe(r,i.value),t,5,[r])};return i.value=e,i.attached=lfe(),i}function ufe(e,t){if(ti(t)){const i=e.stopImmediatePropagation;return e.stopImmediatePropagation=()=>{i.call(e),e._stopped=!0},t.map(r=>n=>!n._stopped&&r&&r(n))}else return t}const UD=/^on[a-z]/,hfe=(e,t,i,r,n=!1,o,c,h,m)=>{t==="class"?Xde(e,r,n):t==="style"?Qde(e,i,r):Mx(t)?W$(t)||sfe(e,t,i,r,c):(t[0]==="."?(t=t.slice(1),!0):t[0]==="^"?(t=t.slice(1),!1):pfe(e,t,r,n))?ife(e,t,r,o,c,h,m):(t==="true-value"?e._trueValue=r:t==="false-value"&&(e._falseValue=r),tfe(e,t,r,n))};function pfe(e,t,i,r){return r?!!(t==="innerHTML"||t==="textContent"||t in e&&UD.test(t)&&mi(i)):t==="spellcheck"||t==="draggable"||t==="translate"||t==="form"||t==="list"&&e.tagName==="INPUT"||t==="type"&&e.tagName==="TEXTAREA"||UD.test(t)&&Ln(i)?!1:t in e}const ed="transition",Ub="animation",qD=(e,{slots:t})=>Bb(rD,dfe(e),t);qD.displayName="Transition";const HD={name:String,type:String,css:{type:Boolean,default:!0},duration:[String,Number,Object],enterFromClass:String,enterActiveClass:String,enterToClass:String,appearFromClass:String,appearActiveClass:String,appearToClass:String,leaveFromClass:String,leaveActiveClass:String,leaveToClass:String};qD.props=Os({},rD.props,HD);const h0=(e,t=[])=>{ti(e)?e.forEach(i=>i(...t)):e&&e(...t)},WD=e=>e?ti(e)?e.some(t=>t.length>1):e.length>1:!1;function dfe(e){const t={};for(const Se in e)Se in HD||(t[Se]=e[Se]);if(e.css===!1)return t;const{name:i="v",type:r,duration:n,enterFromClass:o=`${i}-enter-from`,enterActiveClass:c=`${i}-enter-active`,enterToClass:h=`${i}-enter-to`,appearFromClass:m=o,appearActiveClass:b=c,appearToClass:x=h,leaveFromClass:I=`${i}-leave-from`,leaveActiveClass:E=`${i}-leave-active`,leaveToClass:k=`${i}-leave-to`}=e,P=ffe(n),F=P&&P[0],N=P&&P[1],{onBeforeEnter:B,onEnter:z,onEnterCancelled:q,onLeave:J,onLeaveCancelled:X,onBeforeAppear:Y=B,onAppear:ae=z,onAppearCancelled:he=q}=t,fe=(Se,Ae,Oe)=>{p0(Se,Ae?x:h),p0(Se,Ae?b:c),Oe&&Oe()},ye=(Se,Ae)=>{Se._isLeaving=!1,p0(Se,I),p0(Se,k),p0(Se,E),Ae&&Ae()},xe=Se=>(Ae,Oe)=>{const bt=Se?ae:z,st=()=>fe(Ae,Se,Oe);h0(bt,[Ae,st]),JD(()=>{p0(Ae,Se?m:o),td(Ae,Se?x:h),WD(bt)||ZD(Ae,r,F,st)})};return Os(t,{onBeforeEnter(Se){h0(B,[Se]),td(Se,o),td(Se,c)},onBeforeAppear(Se){h0(Y,[Se]),td(Se,m),td(Se,b)},onEnter:xe(!1),onAppear:xe(!0),onLeave(Se,Ae){Se._isLeaving=!0;const Oe=()=>ye(Se,Ae);td(Se,I),gfe(),td(Se,E),JD(()=>{!Se._isLeaving||(p0(Se,I),td(Se,k),WD(J)||ZD(Se,r,N,Oe))}),h0(J,[Se,Oe])},onEnterCancelled(Se){fe(Se,!1),h0(q,[Se])},onAppearCancelled(Se){fe(Se,!0),h0(he,[Se])},onLeaveCancelled(Se){ye(Se),h0(X,[Se])}})}function ffe(e){if(e==null)return null;if(Lr(e))return[LE(e.enter),LE(e.leave)];{const t=LE(e);return[t,t]}}function LE(e){return Q$(e)}function td(e,t){t.split(/\s+/).forEach(i=>i&&e.classList.add(i)),(e._vtc||(e._vtc=new Set)).add(t)}function p0(e,t){t.split(/\s+/).forEach(r=>r&&e.classList.remove(r));const{_vtc:i}=e;i&&(i.delete(t),i.size||(e._vtc=void 0))}function JD(e){requestAnimationFrame(()=>{requestAnimationFrame(e)})}let yfe=0;function ZD(e,t,i,r){const n=e._endId=++yfe,o=()=>{n===e._endId&&r()};if(i)return setTimeout(o,i);const{type:c,timeout:h,propCount:m}=mfe(e,t);if(!c)return r();const b=c+"end";let x=0;const I=()=>{e.removeEventListener(b,E),o()},E=k=>{k.target===e&&++x>=m&&I()};setTimeout(()=>{x<m&&I()},h+1),e.addEventListener(b,E)}function mfe(e,t){const i=window.getComputedStyle(e),r=P=>(i[P]||"").split(", "),n=r(`${ed}Delay`),o=r(`${ed}Duration`),c=KD(n,o),h=r(`${Ub}Delay`),m=r(`${Ub}Duration`),b=KD(h,m);let x=null,I=0,E=0;t===ed?c>0&&(x=ed,I=c,E=o.length):t===Ub?b>0&&(x=Ub,I=b,E=m.length):(I=Math.max(c,b),x=I>0?c>b?ed:Ub:null,E=x?x===ed?o.length:m.length:0);const k=x===ed&&/\b(transform|all)(,|$)/.test(r(`${ed}Property`).toString());return{type:x,timeout:I,propCount:E,hasTransform:k}}function KD(e,t){for(;e.length<t.length;)e=e.concat(e);return Math.max(...t.map((i,r)=>YD(i)+YD(e[r])))}function YD(e){return Number(e.slice(0,-1).replace(",","."))*1e3}function gfe(){return document.body.offsetHeight}const $He={beforeMount(e,{value:t},{transition:i}){e._vod=e.style.display==="none"?"":e.style.display,i&&t?i.beforeEnter(e):qb(e,t)},mounted(e,{value:t},{transition:i}){i&&t&&i.enter(e)},updated(e,{value:t,oldValue:i},{transition:r}){!t!=!i&&(r?t?(r.beforeEnter(e),qb(e,!0),r.enter(e)):r.leave(e,()=>{qb(e,!1)}):qb(e,t))},beforeUnmount(e,{value:t}){qb(e,t)}};function qb(e,t){e.style.display=t?e._vod:"none"}const vfe=Os({patchProp:hfe},Yde);let XD;function bfe(){return XD||(XD=$de(vfe))}const EHe=(...e)=>{const t=bfe().createApp(...e),{mount:i}=t;return t.mount=r=>{const n=wfe(r);if(!n)return;const o=t._component;!mi(o)&&!o.render&&!o.template&&(o.template=n.innerHTML),n.innerHTML="";const c=i(n,!1,n instanceof SVGElement);return n instanceof Element&&(n.removeAttribute("v-cloak"),n.setAttribute("data-v-app","")),c},t};function wfe(e){return Ln(e)?document.querySelector(e):e}/*!
  * vue-router v4.0.12
  * (c) 2021 Eduardo San Martin Morote
  * @license MIT
  */const QD=typeof Symbol=="function"&&typeof Symbol.toStringTag=="symbol",Um=e=>QD?Symbol(e):"_vr_"+e,_fe=Um("rvlm"),ej=Um("rvd"),OE=Um("r"),tj=Um("rl"),RE=Um("rvl"),qm=typeof window!="undefined";function xfe(e){return e.__esModule||QD&&e[Symbol.toStringTag]==="Module"}const yr=Object.assign;function FE(e,t){const i={};for(const r in t){const n=t[r];i[r]=Array.isArray(n)?n.map(e):e(n)}return i}const Hb=()=>{},Sfe=/\/$/,Mfe=e=>e.replace(Sfe,"");function NE(e,t,i="/"){let r,n={},o="",c="";const h=t.indexOf("?"),m=t.indexOf("#",h>-1?h:0);return h>-1&&(r=t.slice(0,h),o=t.slice(h+1,m>-1?m:t.length),n=e(o)),m>-1&&(r=r||t.slice(0,m),c=t.slice(m,t.length)),r=Tfe(r!=null?r:t,i),{fullPath:r+(o&&"?")+o+c,path:r,query:n,hash:c}}function Ife(e,t){const i=t.query?e(t.query):"";return t.path+(i&&"?")+i+(t.hash||"")}function ij(e,t){return!t||!e.toLowerCase().startsWith(t.toLowerCase())?e:e.slice(t.length)||"/"}function $fe(e,t,i){const r=t.matched.length-1,n=i.matched.length-1;return r>-1&&r===n&&Hm(t.matched[r],i.matched[n])&&rj(t.params,i.params)&&e(t.query)===e(i.query)&&t.hash===i.hash}function Hm(e,t){return(e.aliasOf||e)===(t.aliasOf||t)}function rj(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(const i in e)if(!Efe(e[i],t[i]))return!1;return!0}function Efe(e,t){return Array.isArray(e)?nj(e,t):Array.isArray(t)?nj(t,e):e===t}function nj(e,t){return Array.isArray(t)?e.length===t.length&&e.every((i,r)=>i===t[r]):e.length===1&&e[0]===t}function Tfe(e,t){if(e.startsWith("/"))return e;if(!e)return t;const i=t.split("/"),r=e.split("/");let n=i.length-1,o,c;for(o=0;o<r.length;o++)if(c=r[o],!(n===1||c==="."))if(c==="..")n--;else break;return i.slice(0,n).join("/")+"/"+r.slice(o-(o===r.length?1:0)).join("/")}var Wb;(function(e){e.pop="pop",e.push="push"})(Wb||(Wb={}));var Jb;(function(e){e.back="back",e.forward="forward",e.unknown=""})(Jb||(Jb={}));function Cfe(e){if(!e)if(qm){const t=document.querySelector("base");e=t&&t.getAttribute("href")||"/",e=e.replace(/^\w+:\/\/[^\/]+/,"")}else e="/";return e[0]!=="/"&&e[0]!=="#"&&(e="/"+e),Mfe(e)}const kfe=/^[^#]+#/;function Afe(e,t){return e.replace(kfe,"#")+t}function Pfe(e,t){const i=document.documentElement.getBoundingClientRect(),r=e.getBoundingClientRect();return{behavior:t.behavior,left:r.left-i.left-(t.left||0),top:r.top-i.top-(t.top||0)}}const Qx=()=>({left:window.pageXOffset,top:window.pageYOffset});function Lfe(e){let t;if("el"in e){const i=e.el,r=typeof i=="string"&&i.startsWith("#"),n=typeof i=="string"?r?document.getElementById(i.slice(1)):document.querySelector(i):i;if(!n)return;t=Pfe(n,e)}else t=e;"scrollBehavior"in document.documentElement.style?window.scrollTo(t):window.scrollTo(t.left!=null?t.left:window.pageXOffset,t.top!=null?t.top:window.pageYOffset)}function sj(e,t){return(history.state?history.state.position-t:-1)+e}const DE=new Map;function Ofe(e,t){DE.set(e,t)}function Rfe(e){const t=DE.get(e);return DE.delete(e),t}let Ffe=()=>location.protocol+"//"+location.host;function oj(e,t){const{pathname:i,search:r,hash:n}=t,o=e.indexOf("#");if(o>-1){let h=n.includes(e.slice(o))?e.slice(o).length:1,m=n.slice(h);return m[0]!=="/"&&(m="/"+m),ij(m,"")}return ij(i,e)+r+n}function Nfe(e,t,i,r){let n=[],o=[],c=null;const h=({state:E})=>{const k=oj(e,location),P=i.value,F=t.value;let N=0;if(E){if(i.value=k,t.value=E,c&&c===P){c=null;return}N=F?E.position-F.position:0}else r(k);n.forEach(B=>{B(i.value,P,{delta:N,type:Wb.pop,direction:N?N>0?Jb.forward:Jb.back:Jb.unknown})})};function m(){c=i.value}function b(E){n.push(E);const k=()=>{const P=n.indexOf(E);P>-1&&n.splice(P,1)};return o.push(k),k}function x(){const{history:E}=window;!E.state||E.replaceState(yr({},E.state,{scroll:Qx()}),"")}function I(){for(const E of o)E();o=[],window.removeEventListener("popstate",h),window.removeEventListener("beforeunload",x)}return window.addEventListener("popstate",h),window.addEventListener("beforeunload",x),{pauseListeners:m,listen:b,destroy:I}}function aj(e,t,i,r=!1,n=!1){return{back:e,current:t,forward:i,replaced:r,position:window.history.length,scroll:n?Qx():null}}function Dfe(e){const{history:t,location:i}=window,r={value:oj(e,i)},n={value:t.state};n.value||o(r.value,{back:null,current:r.value,forward:null,position:t.length-1,replaced:!0,scroll:null},!0);function o(m,b,x){const I=e.indexOf("#"),E=I>-1?(i.host&&document.querySelector("base")?e:e.slice(I))+m:Ffe()+e+m;try{t[x?"replaceState":"pushState"](b,"",E),n.value=b}catch(k){console.error(k),i[x?"replace":"assign"](E)}}function c(m,b){const x=yr({},t.state,aj(n.value.back,m,n.value.forward,!0),b,{position:n.value.position});o(m,x,!0),r.value=m}function h(m,b){const x=yr({},n.value,t.state,{forward:m,scroll:Qx()});o(x.current,x,!0);const I=yr({},aj(r.value,m,null),{position:x.position+1},b);o(m,I,!1),r.value=m}return{location:r,state:n,push:h,replace:c}}function jfe(e){e=Cfe(e);const t=Dfe(e),i=Nfe(e,t.state,t.location,t.replace);function r(o,c=!0){c||i.pauseListeners(),history.go(o)}const n=yr({location:"",base:e,go:r,createHref:Afe.bind(null,e)},t,i);return Object.defineProperty(n,"location",{enumerable:!0,get:()=>t.location.value}),Object.defineProperty(n,"state",{enumerable:!0,get:()=>t.state.value}),n}function THe(e){return e=location.host?e||location.pathname+location.search:"",e.includes("#")||(e+="#"),jfe(e)}function Vfe(e){return typeof e=="string"||e&&typeof e=="object"}function lj(e){return typeof e=="string"||typeof e=="symbol"}const id={path:"/",name:void 0,params:{},query:{},hash:"",fullPath:"/",matched:[],meta:{},redirectedFrom:void 0},cj=Um("nf");var uj;(function(e){e[e.aborted=4]="aborted",e[e.cancelled=8]="cancelled",e[e.duplicated=16]="duplicated"})(uj||(uj={}));function Wm(e,t){return yr(new Error,{type:e,[cj]:!0},t)}function d0(e,t){return e instanceof Error&&cj in e&&(t==null||!!(e.type&t))}const hj="[^/]+?",zfe={sensitive:!1,strict:!1,start:!0,end:!0},Gfe=/[.+*?^${}()[\]/\\]/g;function Bfe(e,t){const i=yr({},zfe,t),r=[];let n=i.start?"^":"";const o=[];for(const b of e){const x=b.length?[]:[90];i.strict&&!b.length&&(n+="/");for(let I=0;I<b.length;I++){const E=b[I];let k=40+(i.sensitive?.25:0);if(E.type===0)I||(n+="/"),n+=E.value.replace(Gfe,"\\$&"),k+=40;else if(E.type===1){const{value:P,repeatable:F,optional:N,regexp:B}=E;o.push({name:P,repeatable:F,optional:N});const z=B||hj;if(z!==hj){k+=10;try{new RegExp(`(${z})`)}catch(J){throw new Error(`Invalid custom RegExp for param "${P}" (${z}): `+J.message)}}let q=F?`((?:${z})(?:/(?:${z}))*)`:`(${z})`;I||(q=N&&b.length<2?`(?:/${q})`:"/"+q),N&&(q+="?"),n+=q,k+=20,N&&(k+=-8),F&&(k+=-20),z===".*"&&(k+=-50)}x.push(k)}r.push(x)}if(i.strict&&i.end){const b=r.length-1;r[b][r[b].length-1]+=.7000000000000001}i.strict||(n+="/?"),i.end?n+="$":i.strict&&(n+="(?:/|$)");const c=new RegExp(n,i.sensitive?"":"i");function h(b){const x=b.match(c),I={};if(!x)return null;for(let E=1;E<x.length;E++){const k=x[E]||"",P=o[E-1];I[P.name]=k&&P.repeatable?k.split("/"):k}return I}function m(b){let x="",I=!1;for(const E of e){(!I||!x.endsWith("/"))&&(x+="/"),I=!1;for(const k of E)if(k.type===0)x+=k.value;else if(k.type===1){const{value:P,repeatable:F,optional:N}=k,B=P in b?b[P]:"";if(Array.isArray(B)&&!F)throw new Error(`Provided param "${P}" is an array but it is not repeatable (* or + modifiers)`);const z=Array.isArray(B)?B.join("/"):B;if(!z)if(N)E.length<2&&(x.endsWith("/")?x=x.slice(0,-1):I=!0);else throw new Error(`Missing required param "${P}"`);x+=z}}return x}return{re:c,score:r,keys:o,parse:h,stringify:m}}function Ufe(e,t){let i=0;for(;i<e.length&&i<t.length;){const r=t[i]-e[i];if(r)return r;i++}return e.length<t.length?e.length===1&&e[0]===40+40?-1:1:e.length>t.length?t.length===1&&t[0]===40+40?1:-1:0}function qfe(e,t){let i=0;const r=e.score,n=t.score;for(;i<r.length&&i<n.length;){const o=Ufe(r[i],n[i]);if(o)return o;i++}return n.length-r.length}const Hfe={type:0,value:""},Wfe=/[a-zA-Z0-9_]/;function Jfe(e){if(!e)return[[]];if(e==="/")return[[Hfe]];if(!e.startsWith("/"))throw new Error(`Invalid path "${e}"`);function t(k){throw new Error(`ERR (${i})/"${b}": ${k}`)}let i=0,r=i;const n=[];let o;function c(){o&&n.push(o),o=[]}let h=0,m,b="",x="";function I(){!b||(i===0?o.push({type:0,value:b}):i===1||i===2||i===3?(o.length>1&&(m==="*"||m==="+")&&t(`A repeatable param (${b}) must be alone in its segment. eg: '/:ids+.`),o.push({type:1,value:b,regexp:x,repeatable:m==="*"||m==="+",optional:m==="*"||m==="?"})):t("Invalid state to consume buffer"),b="")}function E(){b+=m}for(;h<e.length;){if(m=e[h++],m==="\\"&&i!==2){r=i,i=4;continue}switch(i){case 0:m==="/"?(b&&I(),c()):m===":"?(I(),i=1):E();break;case 4:E(),i=r;break;case 1:m==="("?i=2:Wfe.test(m)?E():(I(),i=0,m!=="*"&&m!=="?"&&m!=="+"&&h--);break;case 2:m===")"?x[x.length-1]=="\\"?x=x.slice(0,-1)+m:i=3:x+=m;break;case 3:I(),i=0,m!=="*"&&m!=="?"&&m!=="+"&&h--,x="";break;default:t("Unknown state");break}}return i===2&&t(`Unfinished custom RegExp for param "${b}"`),I(),c(),n}function Zfe(e,t,i){const r=Bfe(Jfe(e.path),i),n=yr(r,{record:e,parent:t,children:[],alias:[]});return t&&!n.record.aliasOf==!t.record.aliasOf&&t.children.push(n),n}function Kfe(e,t){const i=[],r=new Map;t=dj({strict:!1,end:!0,sensitive:!1},t);function n(x){return r.get(x)}function o(x,I,E){const k=!E,P=Xfe(x);P.aliasOf=E&&E.record;const F=dj(t,x),N=[P];if("alias"in x){const q=typeof x.alias=="string"?[x.alias]:x.alias;for(const J of q)N.push(yr({},P,{components:E?E.record.components:P.components,path:J,aliasOf:E?E.record:P}))}let B,z;for(const q of N){const{path:J}=q;if(I&&J[0]!=="/"){const X=I.record.path,Y=X[X.length-1]==="/"?"":"/";q.path=I.record.path+(J&&Y+J)}if(B=Zfe(q,I,F),E?E.alias.push(B):(z=z||B,z!==B&&z.alias.push(B),k&&x.name&&!pj(B)&&c(x.name)),"children"in P){const X=P.children;for(let Y=0;Y<X.length;Y++)o(X[Y],B,E&&E.children[Y])}E=E||B,m(B)}return z?()=>{c(z)}:Hb}function c(x){if(lj(x)){const I=r.get(x);I&&(r.delete(x),i.splice(i.indexOf(I),1),I.children.forEach(c),I.alias.forEach(c))}else{const I=i.indexOf(x);I>-1&&(i.splice(I,1),x.record.name&&r.delete(x.record.name),x.children.forEach(c),x.alias.forEach(c))}}function h(){return i}function m(x){let I=0;for(;I<i.length&&qfe(x,i[I])>=0;)I++;i.splice(I,0,x),x.record.name&&!pj(x)&&r.set(x.record.name,x)}function b(x,I){let E,k={},P,F;if("name"in x&&x.name){if(E=r.get(x.name),!E)throw Wm(1,{location:x});F=E.record.name,k=yr(Yfe(I.params,E.keys.filter(z=>!z.optional).map(z=>z.name)),x.params),P=E.stringify(k)}else if("path"in x)P=x.path,E=i.find(z=>z.re.test(P)),E&&(k=E.parse(P),F=E.record.name);else{if(E=I.name?r.get(I.name):i.find(z=>z.re.test(I.path)),!E)throw Wm(1,{location:x,currentLocation:I});F=E.record.name,k=yr({},I.params,x.params),P=E.stringify(k)}const N=[];let B=E;for(;B;)N.unshift(B.record),B=B.parent;return{name:F,path:P,params:k,matched:N,meta:e0e(N)}}return e.forEach(x=>o(x)),{addRoute:o,resolve:b,removeRoute:c,getRoutes:h,getRecordMatcher:n}}function Yfe(e,t){const i={};for(const r of t)r in e&&(i[r]=e[r]);return i}function Xfe(e){return{path:e.path,redirect:e.redirect,name:e.name,meta:e.meta||{},aliasOf:void 0,beforeEnter:e.beforeEnter,props:Qfe(e),children:e.children||[],instances:{},leaveGuards:new Set,updateGuards:new Set,enterCallbacks:{},components:"components"in e?e.components||{}:{default:e.component}}}function Qfe(e){const t={},i=e.props||!1;if("component"in e)t.default=i;else for(const r in e.components)t[r]=typeof i=="boolean"?i:i[r];return t}function pj(e){for(;e;){if(e.record.aliasOf)return!0;e=e.parent}return!1}function e0e(e){return e.reduce((t,i)=>yr(t,i.meta),{})}function dj(e,t){const i={};for(const r in e)i[r]=r in t?t[r]:e[r];return i}const fj=/#/g,t0e=/&/g,i0e=/\//g,r0e=/=/g,n0e=/\?/g,yj=/\+/g,s0e=/%5B/g,o0e=/%5D/g,mj=/%5E/g,a0e=/%60/g,gj=/%7B/g,l0e=/%7C/g,vj=/%7D/g,c0e=/%20/g;function jE(e){return encodeURI(""+e).replace(l0e,"|").replace(s0e,"[").replace(o0e,"]")}function u0e(e){return jE(e).replace(gj,"{").replace(vj,"}").replace(mj,"^")}function VE(e){return jE(e).replace(yj,"%2B").replace(c0e,"+").replace(fj,"%23").replace(t0e,"%26").replace(a0e,"`").replace(gj,"{").replace(vj,"}").replace(mj,"^")}function h0e(e){return VE(e).replace(r0e,"%3D")}function p0e(e){return jE(e).replace(fj,"%23").replace(n0e,"%3F")}function d0e(e){return e==null?"":p0e(e).replace(i0e,"%2F")}function eS(e){try{return decodeURIComponent(""+e)}catch{}return""+e}function f0e(e){const t={};if(e===""||e==="?")return t;const r=(e[0]==="?"?e.slice(1):e).split("&");for(let n=0;n<r.length;++n){const o=r[n].replace(yj," "),c=o.indexOf("="),h=eS(c<0?o:o.slice(0,c)),m=c<0?null:eS(o.slice(c+1));if(h in t){let b=t[h];Array.isArray(b)||(b=t[h]=[b]),b.push(m)}else t[h]=m}return t}function bj(e){let t="";for(let i in e){const r=e[i];if(i=h0e(i),r==null){r!==void 0&&(t+=(t.length?"&":"")+i);continue}(Array.isArray(r)?r.map(o=>o&&VE(o)):[r&&VE(r)]).forEach(o=>{o!==void 0&&(t+=(t.length?"&":"")+i,o!=null&&(t+="="+o))})}return t}function y0e(e){const t={};for(const i in e){const r=e[i];r!==void 0&&(t[i]=Array.isArray(r)?r.map(n=>n==null?null:""+n):r==null?r:""+r)}return t}function Zb(){let e=[];function t(r){return e.push(r),()=>{const n=e.indexOf(r);n>-1&&e.splice(n,1)}}function i(){e=[]}return{add:t,list:()=>e,reset:i}}function rd(e,t,i,r,n){const o=r&&(r.enterCallbacks[n]=r.enterCallbacks[n]||[]);return()=>new Promise((c,h)=>{const m=I=>{I===!1?h(Wm(4,{from:i,to:t})):I instanceof Error?h(I):Vfe(I)?h(Wm(2,{from:t,to:I})):(o&&r.enterCallbacks[n]===o&&typeof I=="function"&&o.push(I),c())},b=e.call(r&&r.instances[n],t,i,m);let x=Promise.resolve(b);e.length<3&&(x=x.then(m)),x.catch(I=>h(I))})}function zE(e,t,i,r){const n=[];for(const o of e)for(const c in o.components){let h=o.components[c];if(!(t!=="beforeRouteEnter"&&!o.instances[c]))if(m0e(h)){const b=(h.__vccOpts||h)[t];b&&n.push(rd(b,i,r,o,c))}else{let m=h();n.push(()=>m.then(b=>{if(!b)return Promise.reject(new Error(`Couldn't resolve component "${c}" at "${o.path}"`));const x=xfe(b)?b.default:b;o.components[c]=x;const E=(x.__vccOpts||x)[t];return E&&rd(E,i,r,o,c)()}))}}return n}function m0e(e){return typeof e=="object"||"displayName"in e||"props"in e||"__vccOpts"in e}function wj(e){const t=ah(OE),i=ah(tj),r=Zc(()=>t.resolve(Ob(e.to))),n=Zc(()=>{const{matched:m}=r.value,{length:b}=m,x=m[b-1],I=i.matched;if(!x||!I.length)return-1;const E=I.findIndex(Hm.bind(null,x));if(E>-1)return E;const k=_j(m[b-2]);return b>1&&_j(x)===k&&I[I.length-1].path!==k?I.findIndex(Hm.bind(null,m[b-2])):E}),o=Zc(()=>n.value>-1&&w0e(i.params,r.value.params)),c=Zc(()=>n.value>-1&&n.value===i.matched.length-1&&rj(i.params,r.value.params));function h(m={}){return b0e(m)?t[Ob(e.replace)?"replace":"push"](Ob(e.to)).catch(Hb):Promise.resolve()}return{route:r,href:Zc(()=>r.value.href),isActive:o,isExactActive:c,navigate:h}}const g0e=vE({name:"RouterLink",props:{to:{type:[String,Object],required:!0},replace:Boolean,activeClass:String,exactActiveClass:String,custom:Boolean,ariaCurrentValue:{type:String,default:"page"}},useLink:wj,setup(e,{slots:t}){const i=Pb(wj(e)),{options:r}=ah(OE),n=Zc(()=>({[xj(e.activeClass,r.linkActiveClass,"router-link-active")]:i.isActive,[xj(e.exactActiveClass,r.linkExactActiveClass,"router-link-exact-active")]:i.isExactActive}));return()=>{const o=t.default&&t.default(i);return e.custom?o:Bb("a",{"aria-current":i.isExactActive?e.ariaCurrentValue:null,href:i.href,onClick:i.navigate,class:n.value},o)}}}),v0e=g0e;function b0e(e){if(!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)&&!e.defaultPrevented&&!(e.button!==void 0&&e.button!==0)){if(e.currentTarget&&e.currentTarget.getAttribute){const t=e.currentTarget.getAttribute("target");if(/\b_blank\b/i.test(t))return}return e.preventDefault&&e.preventDefault(),!0}}function w0e(e,t){for(const i in t){const r=t[i],n=e[i];if(typeof r=="string"){if(r!==n)return!1}else if(!Array.isArray(n)||n.length!==r.length||r.some((o,c)=>o!==n[c]))return!1}return!0}function _j(e){return e?e.aliasOf?e.aliasOf.path:e.path:""}const xj=(e,t,i)=>e!=null?e:t!=null?t:i,_0e=vE({name:"RouterView",inheritAttrs:!1,props:{name:{type:String,default:"default"},route:Object},setup(e,{attrs:t,slots:i}){const r=ah(RE),n=Zc(()=>e.route||r.value),o=ah(ej,0),c=Zc(()=>n.value.matched[o]);Vx(ej,o+1),Vx(_fe,c),Vx(RE,n);const h=Ape();return Gx(()=>[h.value,c.value,e.name],([m,b,x],[I,E,k])=>{b&&(b.instances[x]=m,E&&E!==b&&m&&m===I&&(b.leaveGuards.size||(b.leaveGuards=E.leaveGuards),b.updateGuards.size||(b.updateGuards=E.updateGuards))),m&&b&&(!E||!Hm(b,E)||!I)&&(b.enterCallbacks[x]||[]).forEach(P=>P(m))},{flush:"post"}),()=>{const m=n.value,b=c.value,x=b&&b.components[e.name],I=e.name;if(!x)return Sj(i.default,{Component:x,route:m});const E=b.props[e.name],k=E?E===!0?m.params:typeof E=="function"?E(m):E:null,F=Bb(x,yr({},k,t,{onVnodeUnmounted:N=>{N.component.isUnmounted&&(b.instances[I]=null)},ref:h}));return Sj(i.default,{Component:F,route:m})||F}}});function Sj(e,t){if(!e)return null;const i=e(t);return i.length===1?i[0]:i}const x0e=_0e;function CHe(e){const t=Kfe(e.routes,e),i=e.parseQuery||f0e,r=e.stringifyQuery||bj,n=e.history,o=Zb(),c=Zb(),h=Zb(),m=Ppe(id);let b=id;qm&&e.scrollBehavior&&"scrollRestoration"in history&&(history.scrollRestoration="manual");const x=FE.bind(null,je=>""+je),I=FE.bind(null,d0e),E=FE.bind(null,eS);function k(je,at){let rt,It;return lj(je)?(rt=t.getRecordMatcher(je),It=at):It=je,t.addRoute(It,rt)}function P(je){const at=t.getRecordMatcher(je);at&&t.removeRoute(at)}function F(){return t.getRoutes().map(je=>je.record)}function N(je){return!!t.getRecordMatcher(je)}function B(je,at){if(at=yr({},at||m.value),typeof je=="string"){const pe=NE(i,je,at.path),be=t.resolve({path:pe.path},at),Le=n.createHref(pe.fullPath);return yr(pe,be,{params:E(be.params),hash:eS(pe.hash),redirectedFrom:void 0,href:Le})}let rt;if("path"in je)rt=yr({},je,{path:NE(i,je.path,at.path).path});else{const pe=yr({},je.params);for(const be in pe)pe[be]==null&&delete pe[be];rt=yr({},je,{params:I(je.params)}),at.params=I(at.params)}const It=t.resolve(rt,at),ni=je.hash||"";It.params=x(E(It.params));const Ai=Ife(r,yr({},je,{hash:u0e(ni),path:It.path})),Ut=n.createHref(Ai);return yr({fullPath:Ai,hash:ni,query:r===bj?y0e(je.query):je.query||{}},It,{redirectedFrom:void 0,href:Ut})}function z(je){return typeof je=="string"?NE(i,je,m.value.path):yr({},je)}function q(je,at){if(b!==je)return Wm(8,{from:at,to:je})}function J(je){return ae(je)}function X(je){return J(yr(z(je),{replace:!0}))}function Y(je){const at=je.matched[je.matched.length-1];if(at&&at.redirect){const{redirect:rt}=at;let It=typeof rt=="function"?rt(je):rt;return typeof It=="string"&&(It=It.includes("?")||It.includes("#")?It=z(It):{path:It},It.params={}),yr({query:je.query,hash:je.hash,params:je.params},It)}}function ae(je,at){const rt=b=B(je),It=m.value,ni=je.state,Ai=je.force,Ut=je.replace===!0,pe=Y(rt);if(pe)return ae(yr(z(pe),{state:ni,force:Ai,replace:Ut}),at||rt);const be=rt;be.redirectedFrom=at;let Le;return!Ai&&$fe(r,It,rt)&&(Le=Wm(16,{to:be,from:It}),Gt(It,It,!0,!1)),(Le?Promise.resolve(Le):fe(be,It)).catch(Ve=>d0(Ve)?Ve:et(Ve,be,It)).then(Ve=>{if(Ve){if(d0(Ve,2))return ae(yr(z(Ve.to),{state:ni,force:Ai,replace:Ut}),at||be)}else Ve=xe(be,It,!0,Ut,ni);return ye(be,It,Ve),Ve})}function he(je,at){const rt=q(je,at);return rt?Promise.reject(rt):Promise.resolve()}function fe(je,at){let rt;const[It,ni,Ai]=S0e(je,at);rt=zE(It.reverse(),"beforeRouteLeave",je,at);for(const pe of It)pe.leaveGuards.forEach(be=>{rt.push(rd(be,je,at))});const Ut=he.bind(null,je,at);return rt.push(Ut),Jm(rt).then(()=>{rt=[];for(const pe of o.list())rt.push(rd(pe,je,at));return rt.push(Ut),Jm(rt)}).then(()=>{rt=zE(ni,"beforeRouteUpdate",je,at);for(const pe of ni)pe.updateGuards.forEach(be=>{rt.push(rd(be,je,at))});return rt.push(Ut),Jm(rt)}).then(()=>{rt=[];for(const pe of je.matched)if(pe.beforeEnter&&!at.matched.includes(pe))if(Array.isArray(pe.beforeEnter))for(const be of pe.beforeEnter)rt.push(rd(be,je,at));else rt.push(rd(pe.beforeEnter,je,at));return rt.push(Ut),Jm(rt)}).then(()=>(je.matched.forEach(pe=>pe.enterCallbacks={}),rt=zE(Ai,"beforeRouteEnter",je,at),rt.push(Ut),Jm(rt))).then(()=>{rt=[];for(const pe of c.list())rt.push(rd(pe,je,at));return rt.push(Ut),Jm(rt)}).catch(pe=>d0(pe,8)?pe:Promise.reject(pe))}function ye(je,at,rt){for(const It of h.list())It(je,at,rt)}function xe(je,at,rt,It,ni){const Ai=q(je,at);if(Ai)return Ai;const Ut=at===id,pe=qm?history.state:{};rt&&(It||Ut?n.replace(je.fullPath,yr({scroll:Ut&&pe&&pe.scroll},ni)):n.push(je.fullPath,ni)),m.value=je,Gt(je,at,rt,Ut),Et()}let Se;function Ae(){Se=n.listen((je,at,rt)=>{const It=B(je),ni=Y(It);if(ni){ae(yr(ni,{replace:!0}),It).catch(Hb);return}b=It;const Ai=m.value;qm&&Ofe(sj(Ai.fullPath,rt.delta),Qx()),fe(It,Ai).catch(Ut=>d0(Ut,4|8)?Ut:d0(Ut,2)?(ae(Ut.to,It).then(pe=>{d0(pe,4|16)&&!rt.delta&&rt.type===Wb.pop&&n.go(-1,!1)}).catch(Hb),Promise.reject()):(rt.delta&&n.go(-rt.delta,!1),et(Ut,It,Ai))).then(Ut=>{Ut=Ut||xe(It,Ai,!1),Ut&&(rt.delta?n.go(-rt.delta,!1):rt.type===Wb.pop&&d0(Ut,4|16)&&n.go(-1,!1)),ye(It,Ai,Ut)}).catch(Hb)})}let Oe=Zb(),bt=Zb(),st;function et(je,at,rt){Et(je);const It=bt.list();return It.length?It.forEach(ni=>ni(je,at,rt)):console.error(je),Promise.reject(je)}function He(){return st&&m.value!==id?Promise.resolve():new Promise((je,at)=>{Oe.add([je,at])})}function Et(je){st||(st=!0,Ae(),Oe.list().forEach(([at,rt])=>je?rt(je):at()),Oe.reset())}function Gt(je,at,rt,It){const{scrollBehavior:ni}=e;if(!qm||!ni)return Promise.resolve();const Ai=!rt&&Rfe(sj(je.fullPath,0))||(It||!rt)&&history.state&&history.state.scroll||null;return WN().then(()=>ni(je,at,Ai)).then(Ut=>Ut&&Lfe(Ut)).catch(Ut=>et(Ut,je,at))}const pi=je=>n.go(je);let ei;const pn=new Set;return{currentRoute:m,addRoute:k,removeRoute:P,hasRoute:N,getRoutes:F,resolve:B,options:e,push:J,replace:X,go:pi,back:()=>pi(-1),forward:()=>pi(1),beforeEach:o.add,beforeResolve:c.add,afterEach:h.add,onError:bt.add,isReady:He,install(je){const at=this;je.component("RouterLink",v0e),je.component("RouterView",x0e),je.config.globalProperties.$router=at,Object.defineProperty(je.config.globalProperties,"$route",{enumerable:!0,get:()=>Ob(m)}),qm&&!ei&&m.value===id&&(ei=!0,J(n.location).catch(ni=>{}));const rt={};for(const ni in id)rt[ni]=Zc(()=>m.value[ni]);je.provide(OE,at),je.provide(tj,Pb(rt)),je.provide(RE,m);const It=je.unmount;pn.add(je),je.unmount=function(){pn.delete(je),pn.size<1&&(b=id,Se&&Se(),m.value=id,ei=!1,st=!1),It()}}}}function Jm(e){return e.reduce((t,i)=>t.then(()=>i()),Promise.resolve())}function S0e(e,t){const i=[],r=[],n=[],o=Math.max(t.matched.length,e.matched.length);for(let c=0;c<o;c++){const h=t.matched[c];h&&(e.matched.find(b=>Hm(b,h))?r.push(h):i.push(h));const m=e.matched[c];m&&(t.matched.find(b=>Hm(b,m))||n.push(m))}return[i,r,n]}function g(e,t,i,r){var n,o=arguments.length,c=o<3?t:r===null?r=Object.getOwnPropertyDescriptor(t,i):r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")c=Reflect.decorate(e,t,i,r);else for(var h=e.length-1;h>=0;h--)(n=e[h])&&(c=(o<3?n(c):o>3?n(t,i,c):n(t,i))||c);return o>3&&c&&Object.defineProperty(t,i,c),c}let nd;function Te(e){return typeof nd[e]=="function"?nd[e]=nd[e](globalThis):nd[e]}var xle,Sle,Mle,Ile;nd=((xle=globalThis.dojoConfig)==null?void 0:xle.has)||((Sle=globalThis.esriConfig)==null?void 0:Sle.has)?K(K({},(Mle=globalThis.dojoConfig)==null?void 0:Mle.has),(Ile=globalThis.esriConfig)==null?void 0:Ile.has):{},Te.add=(e,t,i,r)=>((r||nd[e]===void 0)&&(nd[e]=t),i&&Te(e)),Te.cache=nd,Te.add("esri-deprecation-warnings",!0),(()=>{var t;Te.add("host-webworker",globalThis.WorkerGlobalScope!==void 0&&self instanceof globalThis.WorkerGlobalScope);const e=typeof window!="undefined"&&typeof location!="undefined"&&typeof document!="undefined"&&window.location===location&&window.document===document;if(Te.add("host-browser",e),Te.add("host-node",typeof globalThis.process=="object"&&((t=globalThis.process.versions)==null?void 0:t.node)&&globalThis.process.versions.v8),Te.add("dom",e),Te("host-browser")){const i=navigator,r=i.userAgent,n=i.appVersion,o=parseFloat(n);if(Te.add("wp",parseFloat(r.split("Windows Phone")[1])||void 0),Te.add("msapp",parseFloat(r.split("MSAppHost/")[1])||void 0),Te.add("khtml",n.includes("Konqueror")?o:void 0),Te.add("edge",parseFloat(r.split("Edge/")[1])||void 0),Te.add("opr",parseFloat(r.split("OPR/")[1])||void 0),Te.add("webkit",!Te("wp")&&!Te("edge")&&parseFloat(r.split("WebKit/")[1])||void 0),Te.add("chrome",!Te("edge")&&!Te("opr")&&parseFloat(r.split("Chrome/")[1])||void 0),Te.add("android",!Te("wp")&&parseFloat(r.split("Android ")[1])||void 0),Te.add("safari",!n.includes("Safari")||Te("wp")||Te("chrome")||Te("android")||Te("edge")||Te("opr")?void 0:parseFloat(n.split("Version/")[1])),Te.add("mac",n.includes("Macintosh")),!Te("wp")&&r.match(/(iPhone|iPod|iPad)/)){const c=RegExp.$1.replace(/P/,"p"),h=r.match(/OS ([\d_]+)/)?RegExp.$1:"1",m=parseFloat(h.replace(/_/,".").replace(/_/g,""));Te.add(c,m),Te.add("ios",m)}Te.add("trident",parseFloat(n.split("Trident/")[1])||void 0),Te("webkit")||(!r.includes("Gecko")||Te("wp")||Te("khtml")||Te("trident")||Te("edge")||Te.add("mozilla",o),Te("mozilla")&&Te.add("ff",parseFloat(r.split("Firefox/")[1]||r.split("Minefield/")[1])||void 0))}})(),(()=>{if(globalThis.navigator){const e=navigator.userAgent,t=/Android|webOS|iPhone|iPad|iPod|BlackBerry|Opera Mini|IEMobile/i.test(e),i=/iPhone/i.test(e);t&&Te.add("esri-mobile",t),i&&Te.add("esri-iPhone",i),Te.add("esri-geolocation",!!navigator.geolocation)}Te.add("esri-canvas-svg-support",!Te("trident")),Te.add("esri-wasm","WebAssembly"in globalThis),Te.add("esri-shared-array-buffer",()=>{const e="SharedArrayBuffer"in globalThis,t=globalThis.crossOriginIsolated===!1;return e&&!t}),Te.add("wasm-simd",()=>{const e=[0,97,115,109,1,0,0,0,1,5,1,96,0,1,123,3,2,1,0,10,10,1,8,0,65,0,253,15,253,98,11];return WebAssembly.validate(new Uint8Array(e))}),Te.add("esri-atomics","Atomics"in globalThis),Te.add("esri-workers","Worker"in globalThis),Te.add("web-feat:cache","caches"in globalThis),Te.add("esri-workers-arraybuffer-transfer",!Te("safari")||Number(Te("safari"))>=12),Te.add("featurelayer-simplify-thresholds",[.5,.5,.5,.5]),Te.add("featurelayer-simplify-payload-size-factors",[1,1,4]),Te.add("featurelayer-snapshot-enabled",!0),Te.add("featurelayer-snapshot-point-min-threshold",8e4),Te.add("featurelayer-snapshot-point-max-threshold",4e5),Te.add("featurelayer-snapshot-point-coverage",.1),Te.add("featurelayer-advanced-symbols",!1),Te.add("featurelayer-pbf",!0),Te.add("featurelayer-pbf-statistics",!1),Te.add("feature-layers-workers",!0),Te.add("feature-polyline-generalization-factor",1),Te.add("mapview-transitions-duration",200),Te.add("mapview-srswitch-adjust-rotation-scale-threshold",24e6),Te.add("mapserver-pbf-enabled",!1),Te.add("mapimagelayer-popup-identify-max-tolerance",20),Te.add("heatmap-allow-raster-fallback",!0),Te.add("heatmap-force-raster",!1),Te("host-webworker")||Te("host-browser")&&(Te.add("esri-csp-restrictions",()=>{try{new Function}catch{return!0}return!1}),Te.add("esri-image-decode",()=>{if("decode"in new Image){const e=new Image;return e.src='data:image/svg+xml;charset=UTF-8,<svg version="1.1" xmlns="http://www.w3.org/2000/svg"></svg>',void e.decode().then(()=>{Te.add("esri-image-decode",!0,!0,!0)}).catch(()=>{Te.add("esri-image-decode",!1,!0,!0)})}return!1}),Te.add("esri-url-encodes-apostrophe",()=>{const e=window.document.createElement("a");return e.href="?'",e.href.includes("?%27")}))})();const M0e=null;function H(e){return e!=null}function ce(e){return e==null}function ch(e,t){return H(e)?t(e):M0e}function Ht(e){return e}function Yn(e,t){return Zm(e,t),e}function Zm(e,t){if(ce(e))throw new Error(t!=null?t:"value is None")}function ws(e,t){return H(e)?e:typeof t=="function"?t():t}function kHe(e,t){return H(e)?e:t}function li(e){return H(e)&&e.destroy(),null}function AHe(e){return H(e)&&e.dispose(),null}function mr(e){return H(e)&&e.remove(),null}function Kl(e){return H(e)&&e.abort(),null}function PHe(e){return H(e)&&e.release(),null}function Mj(e,t,i){return H(e)&&H(t)?H(i)?i(e,t):e.equals(t):e===t}function I0e(e){return null}function LHe(e,t){const i=new Array;for(const r of e)i.push(Kb(r,null,t));return i}function OHe(e,t){for(const i of e)ch(i,t)}function Kb(e,t,i){return H(e)?i(e):t}function $0e(e){return e.filter(t=>H(t))}function Yb(e,...t){let i=e;for(let r=0;r<t.length&&i;++r)i=i[t[r]];return i}function On(e){return e}class Yl{constructor(t=1){this._seed=t}set seed(t){this._seed=t!=null?t:Math.random()*Yl._m}getInt(){return this._seed=(Yl._a*this._seed+Yl._c)%Yl._m,this._seed}getFloat(){return this.getInt()/(Yl._m-1)}getIntRange(t,i){return Math.round(this.getFloatRange(t,i))}getFloatRange(t,i){const r=i-t;return t+this.getInt()/Yl._m*r}}Yl._m=2147483647,Yl._a=48271,Yl._c=0;function E0e(e,t){return t?e.filter((i,r,n)=>n.findIndex(t.bind(null,i))===r):e.filter((i,r,n)=>n.indexOf(i)===r)}function sd(e,t,i){if(ce(e)&&ce(t))return!0;if(ce(e)||ce(t)||e.length!==t.length)return!1;if(i){for(let r=0;r<e.length;r++)if(!i(e[r],t[r]))return!1}else for(let r=0;r<e.length;r++)if(e[r]!==t[r])return!1;return!0}function RHe(e,t){let i=e.length!==t.length;i&&(e.length=t.length);for(let r=0;r<t.length;++r)e[r]!==t[r]&&(e[r]=t[r],i=!0);return i}function FHe(e,t,i){let r,n;return i?(r=t.filter(o=>!e.some(c=>i(c,o))),n=e.filter(o=>!t.some(c=>i(c,o)))):(r=t.filter(o=>!e.includes(o)),n=e.filter(o=>!t.includes(o))),{added:r,removed:n}}function NHe(e){return e&&typeof e.length=="number"}const T0e=!!Array.prototype.fill;function C0e(e,t){if(T0e)return new Array(e).fill(t);const i=new Array(e);for(let r=0;r<e;r++)i[r]=t;return i}function DHe(e,t){t===void 0&&(t=e,e=0);const i=new Array(t-e);for(let r=e;r<t;r++)i[r-e]=r;return i}class Ij{constructor(){this.last=0}}const $j=new Ij;function GE(e,t,i,r){r=r||$j;const n=Math.max(0,r.last-10);for(let c=n;c<i;++c)if(e[c]===t)return r.last=c,c;const o=Math.min(n,i);for(let c=0;c<o;++c)if(e[c]===t)return r.last=c,c;return-1}function Ej(e,t,i,r){const n=i!=null?i:e.length,o=GE(e,t,n,r);if(o!==-1)return e[o]=e[n-1],i==null&&e.pop(),t}const Xl=new Set;function k0e(e,t,i=e.length,r=t.length,n,o){if(r===0||i===0)return i;Xl.clear();for(let h=0;h<r;++h)Xl.add(t[h]);n=n||$j;const c=Math.max(0,n.last-10);for(let h=c;h<i;++h)if(Xl.has(e[h])&&(o&&o.push(e[h]),Xl.delete(e[h]),e[h]=e[i-1],--i,--h,Xl.size===0||i===0))return Xl.clear(),i;for(let h=0;h<c;++h)if(Xl.has(e[h])&&(o&&o.push(e[h]),Xl.delete(e[h]),e[h]=e[i-1],--i,--h,Xl.size===0||i===0))return Xl.clear(),i;return Xl.clear(),i}new Yl;function Tj(e,t){const i=e.indexOf(t);return i!==-1?(e.splice(i,1),t):null}function jHe(e,t){if(e.forEach)e.forEach(t);else for(let i=0;i<e.length;i++)t(e[i],i,e)}function A0e(e,t,i){if(e.slice)return e.slice(t,i);t===void 0?t=0:(t<0&&(t+=e.length),t=Math.min(e.length,Math.max(0,t))),i===void 0?i=e.length:(i<0&&(i+=e.length),i=Math.min(e.length,Math.max(0,i)));const r=Math.max(0,i-t),n=new e.constructor(r);for(let o=0;o<r;o++)n[o]=e[t+o];return n}function VHe(e){return e instanceof ArrayBuffer||e&&e.constructor&&e.constructor.name==="ArrayBuffer"}function P0e(e){return e instanceof Int8Array||e&&e.constructor&&e.constructor.name==="Int8Array"}function L0e(e){return e instanceof Uint8Array||e&&e.constructor&&e.constructor.name==="Uint8Array"}function O0e(e){return e instanceof Uint8ClampedArray||e&&e.constructor&&e.constructor.name==="Uint8ClampedArray"}function R0e(e){return e instanceof Int16Array||e&&e.constructor&&e.constructor.name==="Int16Array"}function F0e(e){return e instanceof Uint16Array||e&&e.constructor&&e.constructor.name==="Uint16Array"}function N0e(e){return e instanceof Int32Array||e&&e.constructor&&e.constructor.name==="Int32Array"}function D0e(e){return e instanceof Uint32Array||e&&e.constructor&&e.constructor.name==="Uint32Array"}function Cj(e){return e instanceof Float32Array||e&&e.constructor&&e.constructor.name==="Float32Array"}function kj(e){return e instanceof Float64Array||e&&e.constructor&&e.constructor.name==="Float64Array"}function j0e(e){const t=new Array(e.length);for(let i=0;i<e.length;i++)t[i]=e[i];return t}function Aj(e,t){let i;if(t)for(i in e)e.hasOwnProperty(i)&&(e[i]===void 0?delete e[i]:e[i]instanceof Object&&Aj(e[i],!0));else for(i in e)e.hasOwnProperty(i)&&e[i]===void 0&&delete e[i];return e}function _e(e){if(!e||typeof e!="object"||typeof e=="function")return e;const t=Fj(e);if(H(t))return t;if(Pj(e))return e.clone();if(Lj(e))return e.map(_e);if(Oj(e))return e.clone();const i={};for(const r of Object.getOwnPropertyNames(e))i[r]=_e(e[r]);return i}function BE(e){if(!e||typeof e!="object"||typeof e=="function"||"HTMLElement"in globalThis&&e instanceof HTMLElement)return e;const t=Fj(e);if(H(t))return t;if(Lj(e)){let i=!0;const r=e.map(n=>{const o=BE(n);return n!=null&&o==null&&(i=!1),o});return i?r:null}if(Pj(e))return e.clone();if(!Oj(e)){const i=new(Object.getPrototypeOf(e)).constructor;for(const r of Object.getOwnPropertyNames(e)){const n=e[r],o=BE(n);if(n!=null&&o==null)return null;i[r]=o}return i}return null}function Pj(e){return typeof e.clone=="function"}function Lj(e){return typeof e.map=="function"&&typeof e.forEach=="function"}function Oj(e){return typeof e.notifyChange=="function"&&typeof e.watch=="function"}function Rj(e){if(Object.prototype.toString.call(e)!=="[object Object]")return!1;const t=Object.getPrototypeOf(e);return t===null||t===Object.prototype}function Fj(e){if(P0e(e)||L0e(e)||O0e(e)||R0e(e)||F0e(e)||N0e(e)||D0e(e)||Cj(e)||kj(e))return A0e(e);if(e instanceof Date)return new Date(e.getTime());if(e instanceof ArrayBuffer)return e.slice(0,e.byteLength);if(e instanceof Map){const t=new Map;for(const[i,r]of e)t.set(i,_e(r));return t}if(e instanceof Set){const t=new Set;for(const i of e)t.add(_e(i));return t}return null}function UE(e,t){return e===t||typeof e=="number"&&isNaN(e)&&typeof t=="number"&&isNaN(t)||typeof(e||{}).getTime=="function"&&typeof(t||{}).getTime=="function"&&e.getTime()===t.getTime()||!1}function V0e(e,t){return e===t||(e==null||typeof e=="string"?e===t:typeof e=="number"?e===t||typeof t=="number"&&isNaN(e)&&isNaN(t):e instanceof Date?t instanceof Date&&e.getTime()===t.getTime():Array.isArray(e)?Array.isArray(t)&&sd(e,t):e instanceof Set?t instanceof Set&&G0e(e,t):e instanceof Map?t instanceof Map&&B0e(e,t):!!Rj(e)&&Rj(t)&&z0e(e,t))}function z0e(e,t){if(e===null||t===null)return!1;const i=Object.keys(e);if(t===null||Object.keys(t).length!==i.length)return!1;for(const r of i)if(e[r]!==t[r]||!Object.prototype.hasOwnProperty.call(t,r))return!1;return!0}function G0e(e,t){if(e.size!==t.size)return!1;for(const i of e)if(!t.has(i))return!1;return!0}function B0e(e,t){if(e.size!==t.size)return!1;for(const[i,r]of e){const n=t.get(i);if(n!==r||n===void 0&&!t.has(i))return!1}return!0}function Nj(e,t,i=!1){return jj(e,t,i)}function Km(e,t){if(t!=null)return t[e]||Dj(e.split("."),!1,t)}function eo(e,t,i){const r=e.split("."),n=r.pop(),o=Dj(r,!0,i);o&&n&&(o[n]=t)}function Dj(e,t,i){let r=i;for(const n of e){if(r==null)return;if(!(n in r)){if(!t)return;r[n]={}}r=r[n]}return r}function jj(e,t,i){return t?Object.keys(t).reduce((r,n)=>{let o=r[n],c=t[n];return o===c?r:o===void 0?(r[n]=_e(c),r):(Array.isArray(c)||Array.isArray(r)?(o=o?Array.isArray(o)?r[n]=o.concat():r[n]=[o]:r[n]=[],c&&(Array.isArray(c)||(c=[c]),i?c.forEach(h=>{o.includes(h)||o.push(h)}):r[n]=c.concat())):c&&typeof c=="object"?r[n]=jj(o,c,i):r.hasOwnProperty(n)&&!t.hasOwnProperty(n)||(r[n]=c),r)},e||{}):e}var $le;const $i={analysisTheme:{accentColor:[255,128,0],textColor:"white"},apiKey:void 0,applicationUrl:($le=globalThis.location)==null?void 0:$le.href,assetsPath:"",fontsUrl:"https://static.arcgis.com/fonts",geometryServiceUrl:"https://utility.arcgisonline.com/arcgis/rest/services/Geometry/GeometryServer",geoRSSServiceUrl:"https://utility.arcgis.com/sharing/rss",kmlServiceUrl:"https://utility.arcgis.com/sharing/kml",portalUrl:"https://www.arcgis.com",routeServiceUrl:"https://route-api.arcgis.com/arcgis/rest/services/World/Route/NAServer/Route_World",workers:{loaderConfig:{has:{},paths:{},map:{},packages:[]}},request:{crossOriginNoCorsDomains:null,httpsDomains:["arcgis.com","arcgisonline.com","esrikr.com","premiumservices.blackbridge.com","esripremium.accuweather.com","gbm.digitalglobe.com","firstlook.digitalglobe.com","msi.digitalglobe.com"],interceptors:[],maxUrlLength:2e3,priority:"high",proxyRules:[],proxyUrl:null,timeout:6e4,trustedServers:[],useIdentity:!0},log:{interceptors:[],level:null}};if(globalThis.esriConfig&&(Nj($i,globalThis.esriConfig,!0),delete $i.has),!$i.assetsPath){{const e="4.25.5";$i.assetsPath=`https://js.arcgis.com/${e.slice(0,-2)}/@arcgis/core/assets`}$i.defaultAssetsPath=$i.assetsPath}const U0e=/\{([^\}]+)\}/g;function Vj(e){return e!=null?e:""}function Kc(e,t){return e.replace(U0e,typeof t=="object"?(i,r)=>Vj(Km(r,t)):(i,r)=>Vj(t(r)))}function tS(e,t){return e.replace(/([\.$?*|{}\(\)\[\]\\\/\+\-^])/g,i=>t&&t.includes(i)?i:`\\${i}`)}function qE(e){let t=0;for(let i=0;i<e.length;i++)t=(t<<5)-t+e.charCodeAt(i),t|=0;return t}function zHe(e){return new DOMParser().parseFromString(e||"","text/html").body.innerText||""}const zj={info:0,warn:1,error:2,none:3};class $e{constructor(t){this.level=null,this._module="",this._parent=null,this.writer=null,this._loggedMessages={error:new Map,warn:new Map,info:new Map},t.level!=null&&(this.level=t.level),t.writer!=null&&(this.writer=t.writer),this._module=t.module,$e._loggers[this.module]=this;const i=this.module.lastIndexOf(".");i!==-1&&(this._parent=$e.getLogger(this.module.slice(0,i)))}get module(){return this._module}get parent(){return this._parent}error(...t){this._log("error","always",...t)}warn(...t){this._log("warn","always",...t)}info(...t){this._log("info","always",...t)}errorOnce(...t){this._log("error","once",...t)}warnOnce(...t){this._log("warn","once",...t)}infoOnce(...t){this._log("info","once",...t)}errorOncePerTick(...t){this._log("error","oncePerTick",...t)}warnOncePerTick(...t){this._log("warn","oncePerTick",...t)}infoOncePerTick(...t){this._log("info","oncePerTick",...t)}get test(){const t=this;return{loggedMessages:t._loggedMessages,clearLoggedWarnings:()=>t._loggedMessages.warn.clear()}}static get testSingleton(){return{resetLoggers(t={}){const i=$e._loggers;return $e._loggers=t,i},set throttlingDisabled(t){$e._throttlingDisabled=t}}}static getLogger(t){let i=$e._loggers[t];return i||(i=new $e({module:t})),i}_log(t,i,...r){if(!!this._matchLevel(t)){if(i!=="always"&&!$e._throttlingDisabled){const n=this._argsToKey(r),o=this._loggedMessages[t].get(n);if(i==="once"&&o!=null||i==="oncePerTick"&&o&&o>=$e._tickCounter)return;this._loggedMessages[t].set(n,$e._tickCounter),$e._scheduleTickCounterIncrement()}for(const n of $i.log.interceptors)if(n(t,this.module,...r))return;this._inheritedWriter()(t,this.module,...r)}}_parentWithMember(t,i){let r=this;for(;H(r);){const n=r[t];if(H(n))return n;r=r.parent}return i}_inheritedWriter(){return this._parentWithMember("writer",this._consoleWriter)}_consoleWriter(t,i,...r){console[t](`[${i}]`,...r)}_matchLevel(t){const i=$i.log.level?$i.log.level:"warn";return zj[this._parentWithMember("level",i)]<=zj[t]}_argsToKey(...t){const i=(r,n)=>typeof n!="object"||Array.isArray(n)?n:"[Object]";return qE(JSON.stringify(t,i))}static _scheduleTickCounterIncrement(){$e._tickCounterScheduled||($e._tickCounterScheduled=!0,Promise.resolve().then(()=>{$e._tickCounter++,$e._tickCounterScheduled=!1}))}}$e._loggers={},$e._tickCounter=0,$e._tickCounterScheduled=!1,$e._throttlingDisabled=!1;function Xb(e,t){for(const[i,r]of e)if(t(r,i))return!0;return!1}function GHe(e,t){for(const[i,r]of e)if(t(r,i))return r;return null}function Gj(e,t,i){const r=e.get(t);if(r!==void 0)return r;const n=i();return e.set(t,n),n}const Ym=$e.getLogger("esri.core.accessorSupport.ensureTypes");function q0e(e){return e==null?e:new Date(e)}function H0e(e){return e==null?e:!!e}function Qb(e){return e==null?e:e.toString()}function hl(e){return e==null?e:(e=parseFloat(e),isNaN(e)?0:e)}function iS(e){return e==null?e:Math.round(parseFloat(e))}function Bj(e){return e&&e.constructor&&e.constructor.__accessorMetadata__!==void 0}function rS(e,t){return t!=null&&e&&!(t instanceof e)}function Uj(e){return e&&"isCollection"in e}function qj(e){return e&&e.Type?typeof e.Type=="function"?e.Type:e.Type.base:null}function W0e(e,t){if(!t||!t.constructor||!Uj(t.constructor))return HE(e,t)?t:new e(t);const i=qj(e.prototype.itemType),r=qj(t.constructor.prototype.itemType);return i?r?i===r?t:i.prototype.isPrototypeOf(r.prototype)?new e(t):(HE(e,t),t):new e(t):t}function HE(e,t){return!!Bj(t)&&(Ym.error("Accessor#set","Assigning an instance of '"+(t.declaredClass||"unknown")+"' which is not a subclass of '"+nS(e)+"'"),!0)}function Xm(e,t){return t==null?t:Uj(e)?W0e(e,t):rS(e,t)?HE(e,t)?t:new e(t):t}function nS(e){return e&&e.prototype&&e.prototype.declaredClass||"unknown"}const J0e=new WeakMap;function Z0e(e){switch(e){case Number:return hl;case Ri:return iS;case Boolean:return H0e;case String:return Qb;case Date:return q0e;default:return Gj(J0e,e,()=>Xm.bind(null,e))}}function Oi(e,t){const i=Z0e(e);return arguments.length===1?i:i(t)}function ew(e,t,i){return arguments.length===1?ew.bind(null,e):t&&(Array.isArray(t)?t.map(r=>e(r,i)):[e(t,i)])}function K0e(e,t){return arguments.length===1?ew(Oi.bind(null,e)):ew(Oi.bind(null,e),t)}function Hj(e,t,i){return t!==0&&Array.isArray(i)?i.map(r=>Hj(e,t-1,r)):e(i)}function sS(e,t,i){if(arguments.length===2)return sS.bind(null,e,t);if(!i)return i;let r=t,n=i=Hj(e,t,i);for(;r>0&&Array.isArray(n);)r--,n=n[0];if(n!==void 0)for(let o=0;o<r;o++)i=[i];return i}function Y0e(e,t,i){return arguments.length===2?sS(Oi.bind(null,e),t):sS(Oi.bind(null,e),t,i)}function Wj(e){return!!Array.isArray(e)&&!e.some(t=>{const i=typeof t;return!(i==="string"||i==="number"||i==="function"&&e.length>1)})}function WE(e,t){if(arguments.length===2)return WE(e).call(null,t);const i=new Set,r=e.filter(h=>typeof h!="function"),n=e.filter(h=>typeof h=="function");for(const h of e)typeof h!="string"&&typeof h!="number"||i.add(h);let o=null,c=null;return(h,m)=>{if(h==null)return h;const b=typeof h,x=b==="string"||b==="number";return x&&(i.has(h)||n.some(I=>b==="string"&&I===String||b==="number"&&I===Number))||b==="object"&&n.some(I=>!rS(h,I))?h:(x&&r.length?(o||(o=r.map(I=>typeof I=="string"?`'${I}'`:`${I}`).join(", ")),Ym.error("Accessor#set",`'${h}' is not a valid value for this property, only the following values are valid: ${o}`)):typeof h=="object"&&n.length?(c||(c=n.map(I=>nS(I)).join(", ")),Ym.error("Accessor#set",`'${h}' is not a valid value for this property, value must be one of ${c}`)):Ym.error("Accessor#set",`'${h}' is not a valid value for this property`),m&&(m.valid=!1),null)}}function Yc(e,t){if(arguments.length===2)return Yc(e).call(null,t);const i={},r=[],n=[];for(const m in e.typeMap){const b=e.typeMap[m];i[m]=Oi(b),r.push(nS(b)),n.push(m)}const o=()=>`'${r.join("', '")}'`,c=()=>`'${n.join("', '")}'`,h=typeof e.key=="string"?m=>m[e.key]:e.key;return m=>{if(e.base&&!rS(e.base,m)||m==null)return m;const b=h(m)||e.defaultKeyValue,x=i[b];if(!x)return Ym.error("Accessor#set",`Invalid property value, value needs to be one of ${o()}, or a plain object that can autocast (having .type = ${c()})`),null;if(!rS(e.typeMap[b],m))return m;if(typeof e.key=="string"&&!Bj(m)){const I={};for(const E in m)E!==e.key&&(I[E]=m[E]);return x(I)}return x(m)}}class Ri{}const BHe={native:e=>({type:"native",value:e}),array:e=>({type:"array",value:e}),oneOf:e=>({type:"one-of",values:e})};function X0e(e){if(!e||!("type"in e))return!1;switch(e.type){case"native":case"array":case"one-of":return!0}return!1}function Jj(e){switch(e.type){case"native":return Oi(e.value);case"array":return ew(Jj(e.value));case"one-of":return Q0e(e);default:return null}}function Q0e(e){let t=null;return(i,r)=>ZE(i,e)?i:(t==null&&(t=JE(e)),Ym.error("Accessor#set",`Invalid property value, value needs to be of type ${t}`),r&&(r.valid=!1),null)}function JE(e){switch(e.type){case"native":switch(e.value){case Number:return"number";case String:return"string";case Boolean:return"boolean";case Ri:return"integer";case Date:return"date";default:return nS(e.value)}case"array":return`array of ${JE(e.value)}`;case"one-of":{const t=e.values.map(i=>JE(i));return`one of ${t.slice(0,t.length-1)} or ${t[t.length-1]}`}}return"unknown"}function ZE(e,t){if(e==null)return!0;switch(t.type){case"native":switch(t.value){case Number:case Ri:return typeof e=="number";case Boolean:return typeof e=="boolean";case String:return typeof e=="string"}return e instanceof t.value;case"array":return!!Array.isArray(e)&&!e.some(i=>!ZE(i,t.value));case"one-of":return t.values.some(i=>ZE(e,i))}}function od(e){return uh(()=>e.forEach(t=>H(t)&&t.remove()))}function uh(e){return{remove:()=>{e&&(e(),e=void 0)}}}function UHe(e){return uh(()=>{const t=e();H(t)&&t.remove()})}function qHe(e){return uh(H(e)?()=>e.destroy():void 0)}function Rn(e){return e?e.__accessor__?e.__accessor__:e.propertyInvalidated?e:null:null}function eye(e,t){return e!=null&&e.metadatas&&e.metadatas[t]!=null}function oS(e,t,i){return i?aS(e,t,{policy:i,path:""}):aS(e,t,null)}function aS(e,t,i){return t?Object.keys(t).reduce((r,n)=>{let o=null,c="merge";if(i&&(o=i.path?`${i.path}.${n}`:n,c=i.policy(o)),c==="replace")return r[n]=t[n],r;if(r[n]===void 0)return r[n]=_e(t[n]),r;let h=r[n],m=t[n];if(h===m)return r;if(Array.isArray(m)||Array.isArray(r))h=h?Array.isArray(h)?r[n]=h.concat():r[n]=[h]:r[n]=[],m&&(Array.isArray(m)||(m=[m]),m.forEach(b=>{h.includes(b)||h.push(b)}));else if(m&&typeof m=="object")if(i){const b=i.path;i.path=On(o),r[n]=aS(h,m,i),i.path=b}else r[n]=aS(h,m,null);else r.hasOwnProperty(n)&&!t.hasOwnProperty(n)||(r[n]=m);return r},e||{}):e}function Zj(e){return Array.isArray(e)?e:e.split(".")}function Kj(e){return e.includes(",")?e.split(",").map(t=>t.trim()):[e.trim()]}function tye(e){if(Array.isArray(e)){const t=[];for(const i of e)t.push(...Kj(i));return t}return Kj(e)}function Yj(e,t,i,r){const n=tye(t);if(n.length!==1){const o=n.map(c=>r(e,c,i));return od(o)}return r(e,n[0],i)}function Xj(e){let t=!1;return()=>{t||(t=!0,e())}}function Qj(e,t){const i=e[e.length-1]==="?"?e.slice(0,-1):e;if(t.getItemAt!=null||Array.isArray(t)){const n=parseInt(i,10);if(!isNaN(n))return Array.isArray(t)?t[n]:t.getItemAt(n)}const r=Rn(t);return eye(r,i)?r.get(i):t[i]}function eV(e,t,i){if(e==null)return e;const r=Qj(t[i],e);return!r&&i<t.length-1?void 0:i===t.length-1?r:eV(r,t,i+1)}function tw(e,t,i=0){return typeof t!="string"||t.includes(".")?eV(e,Zj(t),i):Qj(t,e)}function lS(e,t){return tw(e,t)}function tV(e,t){return tw(t,e)!==void 0}class iV{constructor(t){this.autoDestroy=!1,this.properties=t}}function iw(e){let t=e.constructor.__accessorMetadata__;const i=Object.prototype.hasOwnProperty.call(e.constructor,"__accessorMetadata__");if(t){if(!i){const r=Object.create(t.properties),n=t.autoDestroy;for(const o in r)r[o]=_e(r[o]);t=new iV(r),t.autoDestroy=n,Object.defineProperty(e.constructor,"__accessorMetadata__",{value:t,enumerable:!1,configurable:!0,writable:!0})}}else t=new iV({}),Object.defineProperty(e.constructor,"__accessorMetadata__",{value:t,enumerable:!1,configurable:!0,writable:!0});return On(e.constructor.__accessorMetadata__)}function iye(e){return iw(e).properties}function cS(e,t){const i=iye(e);let r=i[t];return r||(r=i[t]={}),r}function rye(e,t){return oS(e,t,sye)}const nye=/^(?:[^.]+\.)?(?:value|type|(?:json\.type|json\.origins\.[^.]\.type))$/;function sye(e){return nye.test(e)?"replace":"merge"}function oye(e,t){return e.replace(/\$\{([^\s\:\}]*)(?:\:([^\s\:\}]+))?\}/g,(i,r)=>{if(r==="")return"$";const n=Km(r,t),o=n!=null?n:"";if(o===void 0)throw new Error(`could not find key "${r}" in template`);return o.toString()})}class uS{constructor(t,i,r){var n;this.name=t,this.details=r,this instanceof uS&&(this.message=(n=i&&oye(i,r))!=null?n:"")}toString(){return"["+this.name+"]: "+this.message}}class ue extends uS{constructor(t,i,r){if(super(t,i,r),!(this instanceof ue))return new ue(t,i,r)}toJSON(){if(this.details!=null)try{return{name:this.name,message:this.message,details:JSON.parse(JSON.stringify(this.details,(t,i)=>{if(i&&typeof i=="object"&&typeof i.toJSON=="function")return i;try{return _e(i)}catch{return"[object]"}}))}}catch(t){throw $e.getLogger("esri.core.Error").error(t),t}return{name:this.name,message:this.message,details:this.details}}static fromJSON(t){return new ue(t.name,t.message,t.details)}}ue.prototype.type="error";function hS(e,t,i){if(e&&t)if(typeof t=="object")for(const r of Object.getOwnPropertyNames(t))hS(e,r,t[r]);else{if(t.includes(".")){const n=t.split("."),o=n.splice(n.length-1,1)[0];return void hS(lS(e,n),o,i)}const r=e.__accessor__;r!=null&&aye(t,r),e[t]=i}}function aye(e,t){if(Te("esri-unknown-property-errors")&&!lye(e,t))throw new ue("set:unknown-property",cye(e,t))}function lye(e,t){return t.metadatas[e]!=null}function cye(e,t){return"setting unknown property '"+e+"' on instance of "+t.host.declaredClass}function w(e={}){return(t,i)=>{if(t===Function.prototype)throw new Error(`Inappropriate use of @property() on a static field: ${t.name}.${i}. Accessor does not support static properties.`);const r=Object.getOwnPropertyDescriptor(t,i),n=cS(t,i);r&&(r.get||r.set?(n.get=r.get||n.get,n.set=r.set||n.set):"value"in r&&("value"in e&&$e.getLogger("esri.core.accessorSupport.decorators.property").warn(`@property() will redefine the value of "${i}" on "${t.constructor.name}" already defined in the metadata`,e),n.value=e.value=r.value)),e.readOnly!=null&&(n.readOnly=e.readOnly);const o=e.aliasOf;if(o){const m=typeof o=="string"?o:o.source,b=typeof o=="string"?null:o.overridable===!0;let x;n.dependsOn=[m],n.get=function(){let I=lS(this,m);if(typeof I=="function"){x||(x=m.split(".").slice(0,-1).join("."));const E=lS(this,x);E&&(I=I.bind(E))}return I},n.readOnly||(n.set=b?function(I){this._override(i,I)}:function(I){hS(this,m,I)})}const c=e.type,h=e.types;n.cast||(c?n.cast=uye(c):h&&(Array.isArray(h)?n.cast=ew(Yc(h[0])):n.cast=Yc(h))),rye(n,e),e.range&&(n.cast=hye(n.cast,e.range))}}function rV(e,t,i){const r=cS(e,i);r.json||(r.json={});let n=r.json;return t!==void 0&&(n.origins||(n.origins={}),n.origins[t]||(n.origins[t]={}),n=n.origins[t]),n}function uye(e){let t=0,i=e;if(X0e(e))return Jj(e);for(;Array.isArray(i)&&i.length===1&&typeof i[0]!="string"&&typeof i[0]!="number";)i=i[0],t++;const r=i;if(Wj(r))return t===0?WE(r):sS(WE(r),t);if(t===1)return K0e(r);if(t>1)return Y0e(r,t);const n=e;return n.from?n.from:Oi(n)}function hye(e,t){return i=>{let r=+e(i);return t.step!=null&&(r=Math.round(r/t.step)*t.step),t.min!=null&&(r=Math.max(t.min,r)),t.max!=null&&(r=Math.min(t.max,r)),r}}var hh;(function(e){e[e.INITIALIZING=0]="INITIALIZING",e[e.CONSTRUCTING=1]="CONSTRUCTING",e[e.CONSTRUCTED=2]="CONSTRUCTED"})(hh||(hh={}));var Zi;(function(e){e[e.Dirty=1]="Dirty",e[e.Overriden=2]="Overriden",e[e.Computing=4]="Computing",e[e.NonNullable=8]="NonNullable",e[e.HasDefaultValue=16]="HasDefaultValue",e[e.DepTrackingInitialized=32]="DepTrackingInitialized",e[e.AutoTracked=64]="AutoTracked",e[e.ExplicitlyTracking=128]="ExplicitlyTracking"})(Zi||(Zi={}));const pS={onObservableAccessed:()=>{},onTrackingEnd:()=>{}},rw=[];let nw=pS;function ii(e){nw.onObservableAccessed(e)}let dS=!1,fS=!1;function ph(e,t,i){if(dS)return KE(e,t,i);nV(e);const r=t.call(i);return sV(),r}function pye(e,t){return ph(pS,e,t)}function KE(e,t,i){const r=dS;dS=!0,nV(e);let n=null;try{n=t.call(i)}catch(o){fS&&$e.getLogger("esri.core.accessorSupport.tracking").error(o)}return sV(),dS=r,n}function nV(e){nw=e,rw.push(e)}function sV(){const e=rw.length;if(e>1){const t=rw.pop();nw=rw[e-2],t.onTrackingEnd()}else if(e===1){const t=rw.pop();nw=pS,t.onTrackingEnd()}else nw=pS}function oV(e,t){if(t.flags&Zi.DepTrackingInitialized)return;const i=fS;fS=!1,t.flags&Zi.AutoTracked?KE(t,t.metadata.get,e):aV(e,t),fS=i}const dye=[];function aV(e,t){t.flags&Zi.ExplicitlyTracking||(t.flags|=Zi.ExplicitlyTracking,KE(t,()=>{const i=t.metadata.dependsOn||dye;for(const r of i)if(typeof r!="string"||r.includes(".")){const n=Zj(r);for(let o=0,c=e;o<n.length&&c!=null&&typeof c=="object";++o)c=lV(c,n[o],o!==n.length-1)}else lV(e,r,!1)}),t.flags&=~Zi.ExplicitlyTracking)}function lV(e,t,i){var o;const r=t[t.length-1]==="?"?t.slice(0,-1):t;if(e.getItemAt!=null||Array.isArray(e)){const c=parseInt(r,10);if(!isNaN(c))return Array.isArray(e)?e[c]:e.getItemAt(c)}const n=(o=Rn(e))==null?void 0:o.properties.get(r);return n&&(ii(n),oV(e,n)),i?e[r]:void 0}function fye(e){if(e.json&&e.json.origins){const t=e.json.origins,i={"web-document":["web-scene","web-map"]};for(const r in i)if(t[r]){const n=t[r];i[r].forEach(o=>{t[o]=n}),delete t[r]}}}class Io extends uS{constructor(t,i,r){if(super(t,i,r),!(this instanceof Io))return new Io(t,i,r)}}Io.prototype.type="warning";function cV(e){return!!e&&e.prototype&&e.prototype.declaredClass&&e.prototype.declaredClass.indexOf("esri.core.Collection")===0}const YE=$e.getLogger("esri.core.accessorSupport.extensions.serializableProperty.reader");function uV(e,t,i){var r,n;e&&(!i&&!t.read||((r=t.read)==null?void 0:r.reader)||((n=t.read)==null?void 0:n.enabled)===!1||gye(e)&&eo("read.reader",ad(e),t))}function ad(e){var i,r,n;const t=(i=e.ndimArray)!=null?i:0;if(t>1)return mye(e);if(t===1)return pV(e);if("type"in e&&dV(e.type)){const o=(n=(r=e.type.prototype)==null?void 0:r.itemType)==null?void 0:n.Type,c=pV(typeof o=="function"?{type:o}:{types:o});return(h,m,b)=>{const x=c(h,m,b);return x&&new e.type(x)}}return XE(e)}function XE(e){return"type"in e?yye(e.type):vye(e.types)}function yye(e){return e.prototype.read?(t,i,r)=>{if(t==null)return t;const n=typeof t;if(n!=="object")return void YE.error(`Expected JSON value of type 'object' to deserialize type '${e.prototype.declaredClass}', but got '${n}'`);const o=new e;return o.read(t,r),o}:e.fromJSON}function hV(e,t,i,r){return r!==0&&Array.isArray(t)?t.map(n=>hV(e,n,i,r-1)):e(t,void 0,i)}function mye(e){var n;const t=XE(e),i=hV.bind(null,t),r=(n=e.ndimArray)!=null?n:0;return(o,c,h)=>{if(o==null)return o;o=i(o,h,r);let m=r,b=o;for(;m>0&&Array.isArray(b);)m--,b=b[0];if(b!==void 0)for(let x=0;x<m;x++)o=[o];return o}}function pV(e){const t=XE(e);return(i,r,n)=>{if(i==null)return i;if(Array.isArray(i)){const c=[];for(const h of i){const m=t(h,void 0,n);m!==void 0&&c.push(m)}return c}const o=t(i,void 0,n);return o!==void 0?[o]:void 0}}function dV(e){if(!cV(e))return!1;const t=e.prototype.itemType;return!(!t||!t.Type)&&(typeof t.Type=="function"?QE(t.Type):fV(t.Type))}function gye(e){return"types"in e?fV(e.types):QE(e.type)}function QE(e){return!Array.isArray(e)&&!!e&&e.prototype&&("read"in e.prototype||"fromJSON"in e||dV(e))}function fV(e){for(const t in e.typeMap)if(!QE(e.typeMap[t]))return!1;return!0}function vye(e){var r;let t=null;const i=(r=e.errorContext)!=null?r:"type";return(n,o,c)=>{if(n==null)return n;const h=typeof n;if(h!=="object")return void YE.error(`Expected JSON value of type 'object' to deserialize, but got '${h}'`);t||(t=bye(e));const m=e.key;if(typeof m!="string")return;const b=n[m],x=b?t[b]:e.defaultKeyValue?e.typeMap[e.defaultKeyValue]:void 0;if(!x){const E=`Type '${b||"unknown"}' is not supported`;return c&&c.messages&&n&&c.messages.push(new Io(`${i}:unsupported`,E,{definition:n,context:c})),void YE.error(E)}const I=new x;return I.read(n,c),I}}function bye(e){var i,r;const t={};for(const n in e.typeMap){const o=e.typeMap[n],c=iw(o.prototype);if(typeof e.key=="function")continue;const h=c.properties[e.key];if(!h)continue;((i=h.json)==null?void 0:i.type)&&Array.isArray(h.json.type)&&h.json.type.length===1&&typeof h.json.type[0]=="string"&&(t[h.json.type[0]]=o);const m=(r=h.json)==null?void 0:r.write;if(!m||!m.writer){t[n]=o;continue}const b=m.target,x=typeof b=="string"?b:e.key,I={};m.writer(n,I,x),I[x]&&(t[I[x]]=o)}return t}function wye(e){if(e.json||(e.json={}),mV(e.json),gV(e.json),yV(e.json),e.json.origins)for(const t in e.json.origins)mV(e.json.origins[t]),gV(e.json.origins[t]),yV(e.json.origins[t]);return!0}function yV(e){e.name&&(e.read&&typeof e.read=="object"?e.read.source===void 0&&(e.read.source=e.name):e.read={source:e.name},e.write&&typeof e.write=="object"?e.write.target===void 0&&(e.write.target=e.name):e.write={target:e.name})}function mV(e){typeof e.read=="boolean"?e.read={enabled:e.read}:typeof e.read=="function"?e.read={enabled:!0,reader:e.read}:e.read&&typeof e.read=="object"&&e.read.enabled===void 0&&(e.read.enabled=!0)}function gV(e){typeof e.write=="boolean"?e.write={enabled:e.write}:typeof e.write=="function"?e.write={enabled:!0,writer:e.write}:e.write&&typeof e.write=="object"&&e.write.enabled===void 0&&(e.write.enabled=!0)}function vV(e,t){var r;if(!t.write||t.write.writer||t.write.enabled===!1&&!t.write.overridePolicy)return;const i=(r=e==null?void 0:e.ndimArray)!=null?r:0;e&&(i===1||"type"in e&&cV(e.type))?t.write.writer=Sye:i>1?t.write.writer=Mye(i):t.types?Array.isArray(t.types)?t.write.writer=xye(t.types[0]):t.write.writer=_ye(t.types):t.write.writer=sw}function _ye(e){return(t,i,r,n)=>t?bV(t,e,n)?sw(t,i,r,n):void 0:sw(t,i,r,n)}function bV(e,t,i){var r,n;for(const o in t.typeMap)if(e instanceof t.typeMap[o])return!0;if(i==null?void 0:i.messages){const o=(r=t.errorContext)!=null?r:"type",c=`Values of type '${(n=typeof t.key!="function"?e[t.key]:e.declaredClass)!=null?n:"Unknown"}' cannot be written`;i&&i.messages&&e&&i.messages.push(new ue(`${o}:unsupported`,c,{definition:e,context:i})),$e.getLogger("esri.core.accessorSupport.extensions.serializableProperty.writer").error(c)}return!1}function xye(e){return(t,i,r,n)=>!t||!Array.isArray(t)?sw(t,i,r,n):sw(t.filter(o=>bV(o,e,n)),i,r,n)}function sw(e,t,i,r){eo(i,yS(e,r),t)}function yS(e,t){return e&&typeof e.write=="function"?e.write({},t):e&&typeof e.toJSON=="function"?e.toJSON():typeof e=="number"?mS(e):e}function mS(e){return e===-1/0?-Number.MAX_VALUE:e===1/0?Number.MAX_VALUE:isNaN(e)?null:e}function Sye(e,t,i,r){let n;e===null?n=null:e&&typeof e.map=="function"?(n=e.map(o=>yS(o,r)),typeof n.toArray=="function"&&(n=n.toArray())):n=[yS(e,r)],eo(i,n,t)}function wV(e,t,i){return i!==0&&Array.isArray(e)?e.map(r=>wV(r,t,i-1)):yS(e,t)}function Mye(e){return(t,i,r,n)=>{let o;if(t===null)o=null;else{o=wV(t,n,e);let c=e,h=o;for(;c>0&&Array.isArray(h);)c--,h=h[0];if(h!==void 0)for(let m=0;m<c;m++)o=[o]}eo(r,o,i)}}function eT(e,t){return tT(e,"read",t)}function _V(e,t){return tT(e,"write",t)}function tT(e,t,i){let r=e&&e.json;if(e&&e.json&&e.json.origins&&i){const n=i.origin&&e.json.origins[i.origin];n&&(t==="any"||t in n)&&(r=n)}return r}function Iye(e){const t=$ye(e);if(e.json.origins)for(const i in e.json.origins){const r=e.json.origins[i],n=r.types?Eye(r):t;uV(n,r,!1),r.types&&!r.write&&e.json.write&&e.json.write.enabled&&(r.write=K({},e.json.write)),vV(n,r)}uV(t,e.json,!0),vV(t,e.json)}function $ye(e){return e.json.types?iT(e.json):e.type?xV(e):iT(e)}function Eye(e){return e.type?xV(e):iT(e)}function xV(e){if(!e.type)return;let t=0,i=e.type;for(;Array.isArray(i)&&!Wj(i);)i=i[0],t++;return{type:i,ndimArray:t}}function iT(e){if(!e.types)return;let t=0,i=e.types;for(;Array.isArray(i);)i=i[0],t++;return{types:i,ndimArray:t}}function Tye(e){wye(e)&&(fye(e),Iye(e))}const rT=new Set,nT=new Set;function te(e){return t=>{t.prototype.declaredClass=e,kye(t);const i=[],r=[];let n=t.prototype;for(;n;)n.hasOwnProperty("initialize")&&!rT.has(n.initialize)&&(rT.add(n.initialize),i.push(n.initialize)),n.hasOwnProperty("destroy")&&!nT.has(n.destroy)&&(nT.add(n.destroy),r.push(n.destroy)),n=Object.getPrototypeOf(n);rT.clear(),nT.clear();class o extends t{constructor(...h){if(super(...h),this.constructor===o&&typeof this.postscript=="function"){if(i.length&&Object.defineProperty(this,"initialize",{enumerable:!1,configurable:!0,value(){for(let m=i.length-1;m>=0;m--)i[m].call(this)}}),r.length){let m=!1;Object.defineProperty(this,"destroy",{enumerable:!1,configurable:!0,value(){if(!m){m=!0;for(let b=0;b<r.length;b++)r[b].call(this)}}})}this.postscript(...h)}}}return o.__accessorMetadata__=iw(t.prototype),o.prototype.declaredClass=e,o}}function Cye(e,t){return t.get==null?function(){const i=this.__accessor__.properties.get(e);if(i===void 0)return;ii(i);const r=this.__accessor__.store;return r.has(e)?r.get(e):i.metadata.value}:function(){const i=this.__accessor__.properties.get(e);if(i!==void 0)return i.getComputed()}}function kye(e){const t=e.prototype,i=iw(t).properties,r={};for(const n of Object.getOwnPropertyNames(i)){const o=i[n];Tye(o),r[n]={enumerable:!0,configurable:!0,get:Cye(n,o),set(c){const h=this.__accessor__;if(h!==void 0){if(!Object.isFrozen(this)){if(h.initialized&&o.readOnly)throw new TypeError(`[accessor] cannot assign to read-only property '${n}' of ${this.declaredClass}`);if(h.lifecycle===hh.CONSTRUCTED&&o.constructOnly)throw new TypeError(`[accessor] cannot assign to construct-only property '${n}' of ${this.declaredClass}`);h.set(n,c)}}else Object.defineProperty(this,n,{enumerable:!0,configurable:!0,writable:!0,value:c})}}}Object.defineProperties(e.prototype,r)}function HHe(e){const t=[];return function*(){yield*t;for(const i of e)t.push(i),yield i}}function Aye(e,t){for(const i of e)if(i!=null&&t(i))return i}function gS(e){return e!=null&&typeof e[Symbol.iterator]=="function"}class Ti{constructor(){this._groups=new Map}destroy(){this.removeAll()}get size(){let t=0;return this._groups.forEach(i=>{t+=i.length}),t}add(t,i){if(gS(t)){const r=this._getOrCreateGroup(i);for(const n of t)this._isHandle(n)&&r.push(n)}else this._isHandle(t)&&this._getOrCreateGroup(i).push(t);return this}forEach(t,i){if(typeof t=="function")this._groups.forEach(r=>r.forEach(t));else{const r=this._getGroup(t);r&&i&&r.forEach(i)}}has(t){return this._groups.has(this._ensureGroupKey(t))}remove(t){if(typeof t!="string"&&gS(t)){for(const i of t)this.remove(i);return this}return this.has(t)?(this._removeAllFromGroup(this._getGroup(t)),this._groups.delete(this._ensureGroupKey(t)),this):this}removeAll(){return this._groups.forEach(t=>this._removeAllFromGroup(t)),this._groups.clear(),this}_isHandle(t){return t&&!!t.remove}_getOrCreateGroup(t){if(this.has(t))return this._getGroup(t);const i=[];return this._groups.set(this._ensureGroupKey(t),i),i}_getGroup(t){return On(this._groups.get(this._ensureGroupKey(t)))}_ensureGroupKey(t){return t||"_default_"}_removeAllFromGroup(t){t.forEach(i=>i.remove())}}function Pye(e){return e&&e.release&&typeof e.release=="function"}function Lye(e){return e&&e.acquire&&typeof e.acquire=="function"}class Ql{constructor(t,i,r,n=1,o=0){if(this._ctor=t,this._acquireFunction=i,this._releaseFunction=r,this.allocationSize=n,this._pool=new Array(o),this._initialSize=o,this._ctor)for(let c=0;c<o;c++)this._pool[c]=new this._ctor;this.allocationSize=Math.max(n,1)}destroy(){this.prune(0)}acquire(...t){let i;if(Ql.test.disabled)i=new this._ctor;else{if(this._pool.length===0){const r=this.allocationSize;for(let n=0;n<r;n++)this._pool[n]=new this._ctor}i=this._pool.pop()}return this._acquireFunction?this._acquireFunction(i,...t):Lye(i)&&i.acquire(...t),i}release(t){t&&!Ql.test.disabled&&(this._releaseFunction?this._releaseFunction(t):Pye(t)&&t.release(),this._pool.push(t))}prune(t=this._initialSize){if(!(t>=this._pool.length)){for(let i=t;i<this._pool.length;++i){const r=this._pool[i];this._dispose(r)}this._pool.length=t}}_dispose(t){t.dispose&&typeof t.dispose=="function"&&t.dispose()}}Ql.test={disabled:!1};var ct;(function(e){e[e.DEFAULTS=0]="DEFAULTS",e[e.COMPUTED=1]="COMPUTED",e[e.SERVICE=2]="SERVICE",e[e.PORTAL_ITEM=3]="PORTAL_ITEM",e[e.WEB_SCENE=4]="WEB_SCENE",e[e.WEB_MAP=5]="WEB_MAP",e[e.USER=6]="USER"})(ct||(ct={}));const sT=ct.USER+1;function qo(e){switch(e){case"defaults":return ct.DEFAULTS;case"service":return ct.SERVICE;case"portal-item":return ct.PORTAL_ITEM;case"web-scene":return ct.WEB_SCENE;case"web-map":return ct.WEB_MAP;case"user":return ct.USER;default:return null}}function ow(e){switch(e){case ct.DEFAULTS:return"defaults";case ct.SERVICE:return"service";case ct.PORTAL_ITEM:return"portal-item";case ct.WEB_SCENE:return"web-scene";case ct.WEB_MAP:return"web-map";case ct.USER:return"user"}return On(void 0)}function Oye(e){return ow(e)}class SV{constructor(t,i){this._observers=t,this._observer=i}remove(){Tj(this._observers,this._observer)}}class MV{constructor(t,i,r){this.properties=t,this.propertyName=i,this.metadata=r,this._observers=null,this._accessed=null,this._handles=null,this.flags=Zi.Dirty|(r.nonNullable?Zi.NonNullable:0)|(r.hasOwnProperty("value")?Zi.HasDefaultValue:0)|(r.get===void 0?Zi.DepTrackingInitialized:0)|(r.dependsOn===void 0?Zi.AutoTracked:0)}destroy(){if(this.flags&Zi.Dirty&&this._observers){const t=this._observers.slice();for(const i of t)i.onCommitted()}this._accessed=null,this._observers=null,this._clearObservationHandles()}getComputed(){ii(this);const t=this.properties.store,i=this.propertyName,r=this.flags,n=t.get(i);if(r&Zi.Computing||~r&Zi.Dirty&&t.has(i))return n;this.flags|=Zi.Computing;const o=this.properties.host;let c;r&Zi.AutoTracked?c=ph(this,this.metadata.get,o):(aV(o,this),c=this.metadata.get.call(o)),t.set(i,c,ct.COMPUTED);const h=t.get(i);return h===n?this.flags&=~Zi.Dirty:pye(this.commit,this),this.flags&=~Zi.Computing,h}onObservableAccessed(t){t!==this&&(this._accessed===null&&(this._accessed=[]),this._accessed.includes(t)||this._accessed.push(t))}onTrackingEnd(){this._clearObservationHandles(),this.flags|=Zi.DepTrackingInitialized;const t=this._accessed;if(t===null)return;let i=this._handles;i===null&&(i=this._handles=[]);for(let r=0;r<t.length;++r)i.push(t[r].observe(this));t.length=0}observe(t){return this._observers===null&&(this._observers=[]),this._observers.includes(t)||this._observers.push(t),new SV(this._observers,t)}notifyChange(){this.onInvalidated(),this.onCommitted()}invalidate(){this.onInvalidated()}onInvalidated(){~this.flags&Zi.Overriden&&(this.flags|=Zi.Dirty);const t=this._observers;if(t!==null)for(let i=0;i<t.length;++i)t[i].onInvalidated()}commit(){this.flags&=~Zi.Dirty,this.onCommitted()}onCommitted(){if(this._observers===null)return;const t=this._observers.slice();for(let i=0;i<t.length;++i)t[i].onCommitted()}_clearObservationHandles(){const t=this._handles;if(t!==null){for(let i=0;i<t.length;++i)t[i].remove();t.length=0}}}class oT{constructor(){this._values=new Map,this.multipleOriginsSupported=!1}clone(t){const i=new oT;return this._values.forEach((r,n)=>{t&&t.has(n)||i.set(n,_e(r))}),i}get(t){return this._values.get(t)}originOf(){return ct.USER}keys(){return[...this._values.keys()]}set(t,i){this._values.set(t,i)}delete(t){this._values.delete(t)}has(t){return this._values.has(t)}forEach(t){this._values.forEach(t)}}function vS(e,t,i){return e!==void 0}function IV(e,t,i,r){return e!==void 0&&(!(i==null&&e.flags&Zi.NonNullable)||(r.lifecycle,hh.INITIALIZING,!1))}function Rye(e){return e&&typeof e.destroy=="function"}$e.getLogger("esri.core.accessorSupport.Properties");class Fye{constructor(t){this.host=t,this.properties=new Map,this.ctorArgs=null,this.destroyed=!1,this.lifecycle=hh.INITIALIZING,this.store=new oT,this._origin=ct.USER;const i=this.host.constructor.__accessorMetadata__,r=i.properties;for(const n in r){const o=new MV(this,n,r[n]);this.properties.set(n,o)}this.metadatas=r,this._autoDestroy=i.autoDestroy}initialize(){this.lifecycle=hh.CONSTRUCTING}constructed(){this.lifecycle=hh.CONSTRUCTED}destroy(){if(this.destroyed=!0,this._autoDestroy)for(const[t,i]of this.properties){const r=this.internalGet(t);r&&Rye(r)&&(r.destroy(),~i.flags&Zi.NonNullable&&this._internalSet(i,null)),i.destroy()}else for(const[t,i]of this.properties)i.destroy()}get initialized(){return this.lifecycle!==hh.INITIALIZING}get(t){const i=this.properties.get(t);if(i.metadata.get)return i.getComputed();ii(i);const r=this.store;return r.has(t)?r.get(t):i.metadata.value}originOf(t){const i=this.store.originOf(t);if(i===void 0){const r=this.properties.get(t);if(r!==void 0&&r.flags&Zi.HasDefaultValue)return"defaults"}return ow(i)}has(t){return!!this.properties.has(t)&&this.store.has(t)}keys(){return[...this.properties.keys()]}internalGet(t){const i=this.properties.get(t);if(vS(i))return this.store.has(t)?this.store.get(t):i.metadata.value}internalSet(t,i){const r=this.properties.get(t);vS(r)&&this._internalSet(r,i)}getDependsInfo(t,i,r){const n=this.properties.get(i);if(!vS(n))return"";const o=new Set,c=ph({onObservableAccessed:m=>o.add(m),onTrackingEnd:()=>{}},()=>{var m;return(m=n.metadata.get)==null?void 0:m.call(t)});let h=`${r}${t.declaredClass.split(".").pop()}.${i}: ${c}
`;if(o.size===0)return h;r+="  ";for(const m of o){if(!(m instanceof MV))continue;const b=m.properties.host,x=m.propertyName,I=Rn(b);h+=I?I.getDependsInfo(b,x,r):`${r}${x}: undefined
`}return h}setAtOrigin(t,i,r){const n=this.properties.get(t);if(vS(n))return this._setAtOrigin(n,i,r)}isOverridden(t){const i=this.properties.get(t);return i!==void 0&&!!(i.flags&Zi.Overriden)}clearOverride(t){const i=this.properties.get(t);i!==void 0&&i.flags&Zi.Overriden&&(i.flags&=~Zi.Overriden,i.notifyChange())}override(t,i){const r=this.properties.get(t);if(!IV(r,t,i,this))return;const n=r.metadata.cast;if(n){const o=this._cast(n,i),{valid:c,value:h}=o;if(aT.release(o),!c)return;i=h}r.flags|=Zi.Overriden,this._internalSet(r,i)}set(t,i){const r=this.properties.get(t);if(!IV(r,t,i,this))return;const n=r.metadata.cast;if(n){const c=this._cast(n,i),{valid:h,value:m}=c;if(aT.release(c),!h)return;i=m}const o=r.metadata.set;o?o.call(this.host,i):this._internalSet(r,i)}setDefaultOrigin(t){this._origin=qo(t)}getDefaultOrigin(){return ow(this._origin)}notifyChange(t){const i=this.properties.get(t);i!==void 0&&i.notifyChange()}invalidate(t){const i=this.properties.get(t);i!==void 0&&i.invalidate()}commit(t){const i=this.properties.get(t);i!==void 0&&i.commit()}_internalSet(t,i){const r=this.lifecycle!==hh.INITIALIZING?this._origin:ct.DEFAULTS;this._setAtOrigin(t,i,r)}_setAtOrigin(t,i,r){const n=this.store,o=t.propertyName;n.has(o,r)&&UE(i,n.get(o))&&~t.flags&Zi.Overriden&&r===n.originOf(o)||(t.invalidate(),n.set(o,i,r),t.commit(),oV(this.host,t))}_cast(t,i){const r=aT.acquire();return r.valid=!0,r.value=i,t&&(r.value=t.call(this.host,i,r)),r}}class Nye{constructor(){this.value=null,this.valid=!0}acquire(){this.valid=!0}release(){this.value=null}}const aT=new Ql(Nye);function Dye(e){e.length=0}class $o{constructor(t=50,i=50){this._pool=new Ql(Array,void 0,Dye,i,t)}acquire(){return this._pool.acquire()}release(t){this._pool.release(t)}prune(){this._pool.prune(0)}static acquire(){return lT.acquire()}static release(t){return lT.release(t)}static prune(){lT.prune()}}const lT=new $o(100);class $V extends Ql{constructor(){super(...arguments),this._set=new Set}destroy(){super.destroy(),this._set=I0e(this._set)}acquire(...t){const i=super.acquire(...t);return this._set.delete(i),i}release(t){t&&!this._set.has(t)&&(super.release(t),this._set.add(t))}_dispose(t){this._set.delete(t),super._dispose(t)}}const bS=[];function Qm(e){bS.push(e),bS.length===1&&queueMicrotask(()=>{const t=bS.slice();bS.length=0;for(const i of t)i()})}class aw{constructor(t,i=30){this.name=t,this._counter=0,this._samples=new Array(i)}record(t){H(t)&&(this._samples[++this._counter%this._samples.length]=t)}get median(){return this._samples.slice().sort((t,i)=>t-i)[Math.floor(this._samples.length/2)]}get average(){return this._samples.reduce((t,i)=>t+i,0)/this._samples.length}get last(){return this._samples[this._counter%this._samples.length]}}var cT;(function(e){const t=(o,c,h,m)=>{let b=c,x=c;const I=h>>>1,E=o[b-1];for(;x<=I;){x=b<<1,x<h&&m(o[x-1],o[x])<0&&++x;const k=o[x-1];if(m(k,E)<=0)break;o[b-1]=k,b=x}o[b-1]=E},i=(o,c)=>o<c?-1:o>c?1:0;function r(o,c,h,m){c===void 0&&(c=0),h===void 0&&(h=o.length),m===void 0&&(m=i);for(let x=h>>>1;x>c;x--)t(o,x,h,m);const b=c+1;for(let x=h-1;x>c;x--){const I=o[c];o[c]=o[x],o[x]=I,t(o,b,x,m)}}function*n(o,c,h,m){c===void 0&&(c=0),h===void 0&&(h=o.length),m===void 0&&(m=i);for(let x=h>>>1;x>c;x--)t(o,x,h,m),yield;const b=c+1;for(let x=h-1;x>c;x--){const I=o[c];o[c]=o[x],o[x]=I,t(o,b,x,m),yield}}e.sort=r,e.iterableSort=n})(cT||(cT={}));const EV=cT,jye=1.5,Vye=1.1;class ld{constructor(t){this.data=[],this._length=0,this._allocator=void 0,this._deallocator=()=>null,this._shrink=()=>{},this._hint=new Ij,t&&(t.initialSize&&(this.data=new Array(t.initialSize)),t.allocator&&(this._allocator=t.allocator),t.deallocator!==void 0&&(this._deallocator=t.deallocator),t.shrink&&(this._shrink=()=>TV(this)))}toArray(){return this.data.slice(0,this.length)}filter(t){const i=new Array;for(let r=0;r<this._length;r++){const n=this.data[r];t(n)&&i.push(n)}return i}getItemAt(t){if(!(t<0||t>=this._length))return this.data[t]}includes(t,i){const r=this.data.indexOf(t,i);return r!==-1&&r<this.length}get length(){return this._length}set length(t){if(t>this._length){if(this._allocator){for(;this._length<t;)this.data[this._length++]=this._allocator(this.data[this._length]);return}this._length=t}else{if(this._deallocator)for(let i=t;i<this._length;++i)this.data[i]=this._deallocator(this.data[i]);this._length=t,this._shrink()}}clear(){this.length=0}prune(){this.clear(),this.data=[]}push(t){this.data[this._length++]=t}pushArray(t,i=t.length){for(let r=0;r<i;r++)this.data[this._length++]=t[r]}fill(t,i){for(let r=0;r<i;r++)this.data[this._length++]=t}pushNew(){this._allocator&&(this.data[this.length]=this._allocator(this.data[this.length]));const t=this.data[this._length];return++this._length,t}unshift(t){this.data.unshift(t),this._length++,TV(this)}pop(){if(this.length===0)return;const t=this.data[this.length-1];return this.length=this.length-1,this._shrink(),t}remove(t){const i=GE(this.data,t,this.length,this._hint);if(i!==-1)return this.data.splice(i,1),this.length=this.length-1,t}removeUnordered(t){return this.removeUnorderedIndex(GE(this.data,t,this.length,this._hint))}removeUnorderedIndex(t){if(!(t>=this.length||t<0))return this.swapElements(t,this.length-1),this.pop()}removeUnorderedMany(t,i=t.length,r){this.length=k0e(this.data,t,this.length,i,this._hint,r),this._shrink()}front(){if(this.length!==0)return this.data[0]}back(){if(this.length!==0)return this.data[this.length-1]}swapElements(t,i){if(t>=this.length||i>=this.length||t===i)return;const r=this.data[t];this.data[t]=this.data[i],this.data[i]=r}sort(t){EV.sort(this.data,0,this.length,t)}iterableSort(t){return EV.iterableSort(this.data,0,this.length,t)}some(t,i){for(let r=0;r<this.length;++r)if(t.call(i,this.data[r],r,this.data))return!0;return!1}filterInPlace(t,i){let r=0;for(let n=0;n<this._length;++n){const o=this.data[n];t.call(i,o,n,this.data)&&(this.data[n]=this.data[r],this.data[r]=o,r++)}if(this._deallocator)for(let n=r;n<this._length;n++)this.data[n]=this._deallocator(this.data[n]);return this._length=r,this._shrink(),this}forAll(t,i){const r=this.length,n=this.data;for(let o=0;o<r;++o)t.call(i,n[o],o,n)}forEach(t,i){for(let r=0;r<this.length;++r)t.call(i,this.data[r],r,this.data)}map(t,i){const r=new Array(this.length);for(let n=0;n<this.length;++n)r[n]=t.call(i,this.data[n],n,this.data);return r}reduce(t,i){let r=i;for(let n=0;n<this.length;++n)r=t(r,this.data[n],n,this.data);return r}has(t){const i=this.length,r=this.data;for(let n=0;n<i;++n)if(r[n]===t)return!0;return!1}}function TV(e){e.data.length>jye*e.length&&(e.data.length=Math.floor(e.length*Vye))}function zye(e){return{setTimeout:(t,i)=>{const r=e.setTimeout(t,i);return{remove:()=>e.clearTimeout(r)}}}}const lw=zye(globalThis),CV=new Set;function Gye(e,t,i=!1){i&&CV.has(t)||(i&&CV.add(t),e.warn(`\u{1F6D1} DEPRECATED - ${t}`))}function Bye(e,t,i={}){if(Te("esri-deprecation-warnings")){const{moduleName:r}=i;kV(e,`Property: ${(r?r+"::":"")+t}`,i)}}function kV(e,t,i={}){if(Te("esri-deprecation-warnings")){const{replacement:r,version:n,see:o,warnOnce:c}=i;let h=t;r&&(h+=`
	\u{1F6E0}\uFE0F Replacement: ${r}`),n&&(h+=`
	\u2699\uFE0F Version: ${n}`),o&&(h+=`
	\u{1F517} See ${o} for more details.`),Gye(e,h,c)}}function wS(e){return e&&(typeof e.on=="function"||typeof e.addEventListener=="function")}function cw(e,t,i){if(!wS(e))throw new TypeError("target is not a Evented or EventTarget object");if("on"in e)return e.on(t,i);if(Array.isArray(t)){const r=t.slice();for(const n of r)e.addEventListener(n,i);return{remove(){for(const n of r)e.removeEventListener(n,i)}}}return e.addEventListener(t,i),{remove(){e.removeEventListener(t,i)}}}function AV(e,t,i){if(!wS(e))throw new TypeError("target is not a Evented or EventTarget object");if("once"in e)return e.once(t,i);const r=cw(e,t,n=>{r.remove(),i.call(e,n)});return{remove(){r.remove()}}}const Uye={Win:"Meta",Scroll:"ScrollLock",Spacebar:" ",Down:"ArrowDown",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Del:"Delete",Apps:"ContextMenu",Esc:"Escape",Multiply:"*",Add:"+",Subtract:"-",Decimal:".",Divide:"/"};function to({key:e}){return Uye[e]||e}function Qi(e="Aborted"){return new ue("AbortError",e)}function ur(e,t="Aborted"){if(ka(e))throw Qi(t)}function _S(e){return H(e)?"aborted"in e?e:e.signal:e}function ka(e){const t=_S(e);return H(t)&&t.aborted}function f0(e){if(Xn(e))throw e}function uT(e){if(!Xn(e))throw e}function Ho(e,t){const i=_S(e);if(!ce(i)){if(!i.aborted)return AV(i,"abort",()=>t());t()}}function hT(e,t){const i=_S(e);if(!ce(i))return ur(i),AV(i,"abort",()=>t(Qi()))}function PV(e,t){const i=_S(t);return ce(i)?e:new Promise((r,n)=>{let o=Ho(t,()=>n(Qi()));const c=()=>o=mr(o);e.then(c,c),e.then(r,n)})}function Xn(e){return(e==null?void 0:e.name)==="AbortError"}async function dh(e){try{return await e}catch(t){if(!Xn(t))throw t;return}}function fh(){let e=null;const t=new Promise((i,r)=>{e={promise:void 0,resolve:i,reject:r}});return e.promise=t,e}async function Mr(e){if(!e)return;if(typeof e.forEach!="function"){const i=Object.keys(e),r=i.map(c=>e[c]),n=await Mr(r),o={};return i.map((c,h)=>o[c]=n[h]),o}const t=e;return new Promise(i=>{const r=[];let n=t.length;n===0&&i(r),t.forEach(o=>{const c={promise:o||Promise.resolve(o)};r.push(c),c.promise.then(h=>{c.value=h}).catch(h=>{c.error=h}).then(()=>{--n,n===0&&i(r)})})})}async function LV(e){return(await Mr(e)).filter(t=>!!t.value).map(t=>t.value)}function uw(e,t,i){const r=new AbortController;return Ho(i,()=>r.abort()),new Promise((n,o)=>{let c=setTimeout(()=>{c=0,n(t)},e);Ho(r,()=>{c&&(clearTimeout(c),o(Qi()))})})}function yh(e){return e&&typeof e.then=="function"}function pT(e){return yh(e)?e:Promise.resolve(e)}function hw(e,t=-1){let i,r,n,o,c=null;const h=(...m)=>{if(i){r=m,o&&o.reject(Qi()),o=fh();const E=On(o.promise);if(c){const k=c;c=null,k.abort()}return E}if(n=o||fh(),o=null,t>0){const E=new AbortController;i=pT(e(...m,E.signal));const k=i;uw(t).then(()=>{i===k&&(o?E.abort():c=E)})}else i=1,i=pT(e(...m));const b=()=>{const E=r;r=n=i=c=null,E!=null&&h(...E)},x=i,I=n;return x.then(b,b),x.then(I.resolve,I.reject),On(I.promise)};return h}function dT(){let e,t;const i=new Promise((n,o)=>{e=n,t=o}),r=n=>{e(n)};return r.resolve=n=>e(n),r.reject=n=>t(n),r.timeout=(n,o)=>lw.setTimeout(()=>r.reject(o),n),r.promise=i,r}async function OV(e){await Promise.resolve(),ur(e)}function dn(e){return e}function qye(e){return e}function WHe(e){return qye(.001*e)}class Hye{constructor(t){this.phases=t,this.paused=!1,this.ticks=-1,this.removed=!1}}class Wye{constructor(t){this.callback=t,this.isActive=!0}remove(){this.isActive=!1}}let fT=0;const pw={time:dn(0),deltaTime:dn(0),elapsedFrameTime:dn(0),frameDuration:dn(0)},yT=["prepare","preRender","render","postRender","update","finish"],mT=[],y0=new ld;class Jye{constructor(t){this._task=t}remove(){this._task.removed=!0}pause(){this._task.paused=!0}resume(){this._task.paused=!1}}const xS={frameTasks:y0,willDispatch:!1,clearFrameTasks:Zye,dispatch:NV,executeFrameTasks:Kye};function eg(e){const t=new Wye(e);return mT.push(t),xS.willDispatch||(xS.willDispatch=!0,Qm(NV)),t}function tg(e){const t=new Hye(e);return y0.push(t),SS==null&&(fT=performance.now(),SS=requestAnimationFrame(RV)),new Jye(t)}let SS=null;function Zye(e=!1){y0.forAll(t=>{t.removed=!0}),e&&FV()}function RV(){const e=performance.now();SS=null,SS=y0.length>0?requestAnimationFrame(RV):null,xS.executeFrameTasks(e)}function Kye(e){const t=dn(e-fT);fT=e;const i=1e3/60,r=Math.max(0,t-i);for(let n=0;n<yT.length;n++){const o=performance.now(),c=yT[n];y0.forAll(h=>{var m;h.paused||h.removed||(n===0&&h.ticks++,h.phases[c]&&(pw.time=e,pw.deltaTime=h.ticks===0?dn(0):t,pw.elapsedFrameTime=dn(performance.now()-e),pw.frameDuration=dn(i-r),(m=h.phases[c])==null||m.call(h,pw)))}),Xye[n].record(performance.now()-o)}FV(),Qye.record(performance.now()-e)}const MS=new ld;function FV(){y0.forAll(e=>{e.removed&&MS.push(e)}),y0.removeUnorderedMany(MS.data,MS.length),MS.clear()}function NV(){for(;mT.length;){const e=On(mT.shift());e.isActive&&e.callback()}xS.willDispatch=!1}function Yye(e=1,t){const i=dT(),r=()=>{ka(t)?i.reject(Qi()):e===0?i():(--e,Qm(()=>r()))};return r(),i.promise}const Xye=yT.map(e=>new aw(e)),Qye=new aw("total");function eme(e,t){for(const i of e.entries())if(t(i[0]))return!0;return!1}let tme=0;function ig(){return++tme}class IS{constructor(t){this._notify=t,this._accessed=[],this._handles=[],this._invalidCount=0}destroy(){this._accessed.length=0,this.clear()}onInvalidated(){this._invalidCount++}onCommitted(){const t=this._invalidCount;if(t===1)return this._invalidCount=0,void this._notify();this._invalidCount=t>0?t-1:0}onObservableAccessed(t){this._accessed.includes(t)||this._accessed.push(t)}onTrackingEnd(){const t=this._handles,i=this._accessed;for(let r=0;r<i.length;++r)t.push(i[r].observe(this));i.length=0}clear(){const t=this._handles;for(let i=0;i<t.length;++i)t[i].remove();t.length=0}}let rg=!1;const $S=[];function DV(e,t){let i=new IS(o),r=null,n=!1;function o(){if(!i||n)return;if(rg)return void zV(o);const h=r;i.clear(),rg=!0,n=!0,r=ph(i,e),n=!1,rg=!1,t(r,h),GV()}function c(){i&&(i.destroy(),i=null,r=null)}return n=!0,r=ph(i,e),n=!1,{remove:c}}function jV(e,t){let i=new IS(n),r=null;function n(){t(r,c)}function o(){i&&(i.destroy(),i=null),r=null}function c(){return i?(i.clear(),r=ph(i,e),r):null}return c(),{remove:o}}function VV(e){let t=new IS(r),i=!1;function r(){t&&!i&&(rg?zV(r):(t.clear(),rg=!0,i=!0,ph(t,e),i=!1,rg=!1,GV()))}function n(){t&&(t.destroy(),t=null)}return i=!0,ph(t,e),i=!1,{remove:n}}function zV(e){$S.includes(e)||$S.unshift(e)}function GV(){for(;$S.length;)$S.pop()()}var dw;(function(e){e[e.Untracked=0]="Untracked",e[e.Tracked=1]="Tracked"})(dw||(dw={}));class fw{constructor(){this.uid=ig(),this.removed=!1,this.type=null,this.oldValue=null,this.callback=null,this.getValue=null,this.target=null,this.path=null,this.equals=null}static acquireUntracked(t,i,r,n,o){return this.pool.acquire(dw.Untracked,t,i,r,n,o,UE)}static acquireTracked(t,i,r,n){return this.pool.acquire(dw.Tracked,t,i,r,null,null,n)}notify(t,i){this.type===dw.Untracked?this.callback.call(this.target,t,i,this.path,this.target):this.callback.call(null,t,i)}acquire(t,i,r,n,o,c,h){this.uid=ig(),this.removed=!1,this.type=t,this.oldValue=i,this.callback=r,this.getValue=n,this.target=o,this.path=c,this.equals=h}release(){this.target=this.path=this.oldValue=this.callback=this.getValue=null,this.uid=ig(),this.removed=!0}}fw.pool=new $V(fw);const ES=new $o,mh=new Set;let TS;function CS(e){mh.delete(e),mh.add(e),TS||(TS=eg(nme))}function ime(e){if(e.removed)return;const t=e.oldValue,i=e.getValue();e.equals(t,i)||(e.oldValue=i,e.notify(i,t))}function rme(e){for(const t of mh.values())t.target===e&&(t.removed=!0)}function nme(){let e=10;for(;TS&&e--;){TS=null;const t=sme(),i=ES.acquire();for(const r of t){const n=r.uid;ime(r),n===r.uid&&r.removed&&i.push(r)}for(const r of mh)r.removed&&(i.push(r),mh.delete(r));for(const r of i)fw.pool.release(r);ES.release(i),ES.release(t),gT.forEach(r=>r())}}function sme(){const e=ES.acquire();e.length=mh.size;let t=0;for(const i of mh)e[t]=i,++t;return mh.clear(),e}const gT=new Set;function ome(e){return gT.add(e),{remove(){gT.delete(e)}}}function ame(e,t,i){let r=Yj(e,t,i,(n,o,c)=>{let h,m,b=jV(()=>tw(n,o),(x,I)=>{n.__accessor__.destroyed||h&&h.uid!==m?r.remove():(h||(h=fw.acquireUntracked(x,c,I,n,o),m=h.uid),CS(h))});return{remove:Xj(()=>{b.remove(),h&&(h.uid!==m||h.removed||(h.removed=!0,CS(h)),h=null),r=b=null})}});return r}function lme(e,t,i){const r=Yj(e,t,i,(n,o,c)=>{let h=!1;return DV(()=>tw(n,o),(m,b)=>{n.__accessor__.destroyed?r.remove():h||(h=!0,UE(b,m)||c.call(n,m,b,o,n),h=!1)})});return r}function cme(e,t,i,r=!1){return!e.__accessor__||e.__accessor__.destroyed?{remove(){}}:r?lme(e,t,i):ame(e,t,i)}function ume(e,t,i){let r,n,o=jV(e,(c,h)=>{r&&r.uid!==n?o.remove():(r||(r=fw.acquireTracked(c,t,h,i),n=r.uid),CS(r))});return{remove:Xj(()=>{o.remove(),r&&(r.uid!==n||r.removed||(r.removed=!0,CS(r)),r=null),o=null})}}function hme(e,t,i){let r=!1;return DV(e,(n,o)=>{r||(r=!0,i(o,n)||t(n,o),r=!1)})}function pme(e,t,i=!1,r=V0e){return i?hme(e,t,r):ume(e,t,r)}function BV(e){return eme(mh,t=>t.oldValue===e)}var UV,qV;function dme(e){var t;if(e==null)return{value:e};if(Array.isArray(e))return{type:[e[0]],value:null};switch(typeof e){case"object":return((t=e.constructor)==null?void 0:t.__accessorMetadata__)||e instanceof Date?{type:e.constructor,value:e}:e;case"boolean":return{type:Boolean,value:e};case"string":return{type:String,value:e};case"number":return{type:Number,value:e};case"function":return{type:e,value:null};default:return}}const m0=Symbol("Accessor-Handles"),vT=Symbol("Accessor-Initialized");class Ye{constructor(...t){if(this[UV]=null,this[qV]=!1,this.constructor===Ye)throw new Error("[accessor] cannot instantiate Accessor. This can be fixed by creating a subclass of Accessor");Object.defineProperty(this,"__accessor__",{enumerable:!1,value:new Fye(this)}),t.length>0&&this.normalizeCtorArgs&&(this.__accessor__.ctorArgs=this.normalizeCtorArgs.apply(this,t))}static createSubclass(t={}){if(Array.isArray(t))throw new Error("Multi-inheritance unsupported since 4.16");const{properties:i,declaredClass:r,constructor:n}=t;delete t.declaredClass,delete t.properties,delete t.constructor;const o=this;class c extends o{constructor(...m){super(...m),this.inherited=null,n&&n.apply(this,m)}}iw(c.prototype);for(const h in t){const m=t[h];c.prototype[h]=typeof m=="function"?function(...b){const x=this.inherited;let I;this.inherited=function(...E){if(o.prototype[h])return o.prototype[h].apply(this,E)};try{I=m.apply(this,b)}catch(E){throw this.inherited=x,E}return this.inherited=x,I}:t[h]}for(const h in i){const m=dme(i[h]);w(m)(c.prototype,h)}return te(r)(c)}postscript(t){const i=this.__accessor__,r=i.ctorArgs||t;i.initialize(),r&&(this.set(r),i.ctorArgs=null),i.constructed(),this.initialize(),this[vT]=!0}initialize(){}destroy(){this.destroyed||(this[m0]=li(this[m0]),rme(this),this.__accessor__.destroy())}get constructed(){return this.__accessor__&&this.__accessor__.initialized||!1}get initialized(){return this[vT]}get destroyed(){return this.__accessor__&&this.__accessor__.destroyed||!1}commitProperty(t){this.get(t)}get(t){return lS(this,t)}hasOwnProperty(t){return this.__accessor__?this.__accessor__.has(t):Object.prototype.hasOwnProperty.call(this,t)}keys(){return this.__accessor__?this.__accessor__.keys():[]}set(t,i){return hS(this,t,i),this}watch(t,i,r){return cme(this,t,i,r)}own(t){this.addHandles(t)}addHandles(t,i){let r=this[m0];ce(r)&&(r=this[m0]=new Ti),r.add(t,i)}removeHandles(t){const i=this[m0];ce(i)||i.remove(t)}hasHandles(t){const i=this[m0];return!!H(i)&&i.has(t)}_override(t,i){i===void 0?this.__accessor__.clearOverride(t):this.__accessor__.override(t,i)}_clearOverride(t){return this.__accessor__.clearOverride(t)}_overrideIfSome(t,i){i==null?this.__accessor__.clearOverride(t):this.__accessor__.override(t,i)}_isOverridden(t){return this.__accessor__.isOverridden(t)}notifyChange(t){this.__accessor__.notifyChange(t)}_get(t){return this.__accessor__.internalGet(t)}_set(t,i){return this.__accessor__.internalSet(t,i),this}}UV=m0,qV=vT;class bT{constructor(){this._values=new Map,this.multipleOriginsSupported=!1}clone(t){const i=new bT;return this._values.forEach((r,n)=>{t&&t.has(n)||i.set(n,_e(r.value),r.origin)}),i}get(t,i){i=this._normalizeOrigin(i);const r=this._values.get(t);return i==null||(r==null?void 0:r.origin)===i?r==null?void 0:r.value:void 0}originOf(t){var i,r;return(r=(i=this._values.get(t))==null?void 0:i.origin)!=null?r:ct.USER}keys(t){t=this._normalizeOrigin(t);const i=[...this._values.keys()];return t==null?i:i.filter(r=>{var n;return((n=this._values.get(r))==null?void 0:n.origin)===t})}set(t,i,r){if((r=this._normalizeOrigin(r))===ct.DEFAULTS){const n=this._values.get(t);if(n&&n.origin!=null&&n.origin>r)return}this._values.set(t,new fme(i,r))}delete(t,i){var r;(i=this._normalizeOrigin(i))!=null&&((r=this._values.get(t))==null?void 0:r.origin)!==i||this._values.delete(t)}has(t,i){var r;return(i=this._normalizeOrigin(i))!=null?((r=this._values.get(t))==null?void 0:r.origin)===i:this._values.has(t)}forEach(t){this._values.forEach(({value:i},r)=>t(i,r))}_normalizeOrigin(t){if(t!=null)return t===ct.DEFAULTS?t:ct.USER}}class fme{constructor(t,i){this.value=t,this.origin=i}}function HV(e,t,i){t.keys().forEach(n=>{i.set(n,t.get(n),ct.DEFAULTS)});const r=e.metadatas;Object.keys(r).forEach(n=>{e.internalGet(n)&&i.set(n,e.internalGet(n),ct.DEFAULTS)})}function yme(e,t,i){if(!e||!e.read||e.read.enabled===!1||!e.read.source)return!1;const r=e.read.source;if(typeof r=="string"){if(r===t||r.includes(".")&&r.indexOf(t)===0&&tV(r,i))return!0}else for(const n of r)if(n===t||n.includes(".")&&n.indexOf(t)===0&&tV(n,i))return!0;return!1}function mme(e){return e&&(!e.read||e.read.enabled!==!1&&!e.read.source)}function gme(e,t,i,r,n){let o=eT(t[i],n);mme(o)&&(e[i]=!0);for(const c of Object.getOwnPropertyNames(t))o=eT(t[c],n),yme(o,i,r)&&(e[c]=!0)}function vme(e,t,i,r){const n=i.metadatas,o=tT(n[t],"any",r),c=o&&o.default;if(c===void 0)return;const h=typeof c=="function"?c.call(e,t,r):c;h!==void 0&&i.set(t,h)}const WV={origin:"service"};function JV(e,t,i=WV){if(!t||typeof t!="object")return;const r=Rn(e),n=r.metadatas,o={};for(const c of Object.getOwnPropertyNames(t))gme(o,n,c,t,i);r.setDefaultOrigin(i.origin);for(const c of Object.getOwnPropertyNames(o)){const h=eT(n[c],i).read,m=h&&h.source;let b;b=m&&typeof m=="string"?tw(t,m):t[c],h&&h.reader&&(b=h.reader.call(e,b,t,i)),b!==void 0&&r.set(c,b)}if(!i||!i.ignoreDefaults){r.setDefaultOrigin("defaults");for(const c of Object.getOwnPropertyNames(n))o[c]||vme(e,c,r,i)}r.setDefaultOrigin("user")}function bme(e,t,i,r=WV){var o;const n=Ce(K({},r),{messages:[]});i(n),(o=n.messages)==null||o.forEach(c=>{c.type!=="warning"||e.loaded?r&&r.messages&&r.messages.push(c):e.loadWarnings.push(c)})}function wme(e,t,i,r,n){var c,h;const o={};return(h=(c=t.write)==null?void 0:c.writer)==null||h.call(e,r,o,i,n),o}function ZV(e,t,i,r,n,o){if(!r||!r.write)return!1;const c=e.get(i);if(!n&&r.write.overridePolicy){const h=r.write.overridePolicy.call(e,c,i,o);h!==void 0&&(n=h)}if(n||(n=r.write),!n||n.enabled===!1)return!1;if((c===null&&!n.allowNull&&!n.writerEnsuresNonNull||c===void 0)&&n.isRequired){const h=new ue("web-document-write:property-required",`Missing value for required property '${i}' on '${e.declaredClass}'`,{propertyName:i,target:e});return h&&o&&o.messages?o.messages.push(h):h&&!o&&$e.getLogger("esri.core.accessorSupport.write").error(h.name,h.message),!1}return!(c===void 0||c===null&&!n.allowNull&&!n.writerEnsuresNonNull||(!t.store.multipleOriginsSupported||t.store.originOf(i)===ct.DEFAULTS)&&_me(e,i,o,r,c)||!n.ignoreOrigin&&o&&o.origin&&t.store.multipleOriginsSupported&&t.store.originOf(i)<qo(o.origin))}function _me(e,t,i,r,n){const o=r.default;if(o===void 0)return!1;if(r.defaultEquals!=null)return r.defaultEquals(n);if(typeof o=="function"){if(Array.isArray(n)){const c=o.call(e,t,i);return sd(c,n)}return!1}return o===n}function xme(e,t,i,r){const n=Rn(e),o=n.metadatas,c=_V(o[t],r);return!!c&&ZV(e,n,t,c,i,r)}function KV(e,t,i){var o,c;if(e&&typeof e.toJSON=="function"&&(!e.toJSON.isDefaultToJSON||!e.write))return oS(t,e.toJSON(i));const r=Rn(e),n=r.metadatas;for(const h in n){const m=_V(n[h],i);if(!ZV(e,r,h,m,void 0,i))continue;const b=e.get(h),x=wme(e,m,m.write&&typeof m.write.target=="string"?m.write.target:h,b,i);Object.keys(x).length>0&&(t=oS(t,x),((c=(o=i==null?void 0:i.resources)==null?void 0:o.pendingOperations)==null?void 0:c.length)&&Promise.all(i.resources.pendingOperations).then(()=>oS(t,x)),i&&i.writtenProperties&&i.writtenProperties.push({target:e,propName:h,oldOrigin:Oye(r.store.originOf(h)),newOrigin:i.origin}))}return t}const yw=e=>{let t=class extends e{constructor(...i){super(...i);const r=On(Rn(this)),n=r.store,o=new bT;r.store=o,HV(r,n,o)}read(i,r){JV(this,i,r)}write(i={},r){return KV(this,i,r)}toJSON(i){return this.write({},i)}static fromJSON(i,r){return Sme.call(this,i,r)}};return t=g([te("esri.core.JSONSupport")],t),t.prototype.toJSON.isDefaultToJSON=!0,t};function Sme(e,t){if(!e)return null;if(e.declaredClass)throw new Error("JSON object is already hydrated");const i=new this;return i.read(e,t),i}let ke=class extends yw(Ye){};ke=g([te("esri.core.JSONSupport")],ke);function We(e,t,i){let r,n;return t===void 0||Array.isArray(t)?(n=e,i=t,r=[void 0]):(n=t,r=Array.isArray(e)?e:[e]),(o,c)=>{const h=o.constructor.prototype;r.forEach(m=>{const b=rV(o,m,n);b.read&&typeof b.read=="object"||(b.read={}),b.read.reader=h[c],i&&(b.read.source=(b.read.source||[]).concat(i))})}}function tt(e,t,i){let r,n;return t===void 0?(n=e,r=[void 0]):typeof t!="string"?(n=e,r=[void 0],i=t):(n=t,r=Array.isArray(e)?e:[e]),(o,c)=>{const h=o.constructor.prototype;for(const m of r){const b=rV(o,m,n);b.write&&typeof b.write=="object"||(b.write={}),i&&(b.write.target=i),b.write.writer=h[c]}}}var pl;(function(e){e[e.CGCS2000=4490]="CGCS2000",e[e.GCSMARS2000=104971]="GCSMARS2000",e[e.GCSMARS2000_SPHERE=104905]="GCSMARS2000_SPHERE",e[e.GCSMOON2000=104903]="GCSMOON2000"})(pl||(pl={}));let C;const ne={values:[1,.3048,.3048006096012192,.3047972654,.9143917962,.201166195164,.9143984146160287,.3047994715386762,20.11676512155263,20.11678249437587,.9143985307444408,.91439523,.3047997101815088,20.1168,20.116756,5e4,15e4],units:["Meter","Foot","Foot_US","Foot_Clarke","Yard_Clarke","Link_Clarke","Yard_Sears","Foot_Sears","Chain_Sears","Chain_Benoit_1895_B","Yard_Indian","Yard_Indian_1937","Foot_Gold_Coast","Chain","Chain_Sears_1922_Truncated","50_Kilometers","150_Kilometers"],2066:5,2136:12,2155:2,2157:0,2158:0,2159:12,2160:12,2204:2,2219:0,2220:0,2254:2,2255:2,2256:1,2265:1,2266:1,2267:2,2268:2,2269:1,2270:1,2271:2,2272:2,2273:1,2294:0,2295:0,2314:3,2899:2,2900:2,2901:1,2909:1,2910:1,2911:2,2912:2,2913:1,2914:1,2992:1,2993:0,2994:1,3080:1,3089:2,3090:0,3091:2,3102:2,3141:0,3142:0,3167:14,3359:2,3360:0,3361:1,3362:0,3363:2,3364:0,3365:2,3366:3,3404:2,3405:0,3406:0,3407:3,3439:0,3440:0,3479:1,3480:0,3481:1,3482:0,3483:1,3484:0,3485:2,3486:0,3487:2,3488:0,3489:0,3490:2,3491:0,3492:2,3493:0,3494:2,3495:0,3496:2,3497:0,3498:2,3499:0,3500:2,3501:0,3502:2,3503:0,3504:2,3505:0,3506:2,3507:0,3508:2,3509:0,3510:2,3511:0,3512:2,3513:0,3514:0,3515:2,3516:0,3517:2,3518:0,3519:2,3520:0,3521:2,3522:0,3523:2,3524:0,3525:2,3526:0,3527:2,3528:0,3529:2,3530:0,3531:2,3532:0,3533:2,3534:0,3535:2,3536:0,3537:2,3538:0,3539:2,3540:0,3541:2,3542:0,3543:2,3544:0,3545:2,3546:0,3547:2,3548:0,3549:2,3550:0,3551:2,3552:0,3553:2,3582:2,3583:0,3584:2,3585:0,3586:2,3587:0,3588:1,3589:0,3590:1,3591:0,3592:0,3593:1,3598:2,3599:0,3600:2,3605:1,3606:0,3607:0,3608:2,3609:0,3610:2,3611:0,3612:2,3613:0,3614:2,3615:0,3616:2,3617:0,3618:2,3619:0,3620:2,3621:0,3622:2,3623:0,3624:2,3625:0,3626:2,3627:0,3628:2,3629:0,3630:2,3631:0,3632:2,3633:0,3634:1,3635:0,3636:1,3640:2,3641:0,3642:2,3643:0,3644:1,3645:0,3646:1,3647:0,3648:1,3649:0,3650:2,3651:0,3652:2,3653:0,3654:2,3655:0,3656:1,3657:0,3658:2,3659:0,3660:2,3661:0,3662:2,3663:0,3664:2,3668:2,3669:0,3670:2,3671:0,3672:2,3673:0,3674:2,3675:0,3676:1,3677:2,3678:0,3679:1,3680:2,3681:0,3682:1,3683:2,3684:0,3685:0,3686:2,3687:0,3688:2,3689:0,3690:2,3691:0,3692:2,3696:2,3697:0,3698:2,3699:0,3700:2,3793:0,3794:0,3812:0,3854:0,3857:0,3920:0,3978:0,3979:0,3991:2,3992:2,4026:0,4037:0,4038:0,4071:0,4082:0,4083:0,4087:0,4088:0,4217:2,4414:0,4415:0,4417:0,4434:0,4437:0,4438:2,4439:2,4462:0,4467:0,4471:0,4474:0,4559:0,4647:0,4822:0,4826:0,4839:0,5018:0,5048:0,5167:0,5168:0,5221:0,5223:0,5234:0,5235:0,5243:0,5247:0,5266:0,5316:0,5320:0,5321:0,5325:0,5337:0,5361:0,5362:0,5367:0,5382:0,5383:0,5396:0,5456:0,5457:0,5469:0,5472:4,5490:0,5513:0,5514:0,5523:0,5559:0,5588:1,5589:3,5596:0,5627:0,5629:0,5641:0,5643:0,5644:0,5646:2,5654:2,5655:2,5659:0,5700:0,5825:0,5836:0,5837:0,5839:0,5842:0,5844:0,5858:0,5879:0,5880:0,5887:0,5890:0,6128:1,6129:1,6141:1,6204:0,6210:0,6211:0,6307:0,6312:0,6316:0,6362:0,6391:1,6405:1,6406:0,6407:1,6408:0,6409:1,6410:0,6411:2,6412:0,6413:2,6414:0,6415:0,6416:2,6417:0,6418:2,6419:0,6420:2,6421:0,6422:2,6423:0,6424:2,6425:0,6426:2,6427:0,6428:2,6429:0,6430:2,6431:0,6432:2,6433:0,6434:2,6435:0,6436:2,6437:0,6438:2,6439:0,6440:0,6441:2,6442:0,6443:2,6444:0,6445:2,6446:0,6447:2,6448:0,6449:2,6450:0,6451:2,6452:0,6453:2,6454:0,6455:2,6456:0,6457:2,6458:0,6459:2,6460:0,6461:2,6462:0,6463:2,6464:0,6465:2,6466:0,6467:2,6468:0,6469:2,6470:0,6471:2,6472:0,6473:2,6474:0,6475:2,6476:0,6477:2,6478:0,6479:2,6484:2,6485:0,6486:2,6487:0,6488:2,6489:0,6490:2,6491:0,6492:2,6493:0,6494:1,6495:0,6496:1,6497:0,6498:0,6499:1,6500:0,6501:2,6502:0,6503:2,6504:0,6505:2,6506:0,6507:2,6508:0,6509:0,6510:2,6515:1,6516:0,6518:0,6519:2,6520:0,6521:2,6522:0,6523:2,6524:0,6525:2,6526:0,6527:2,6528:0,6529:2,6530:0,6531:2,6532:0,6533:2,6534:0,6535:2,6536:0,6537:2,6538:0,6539:2,6540:0,6541:2,6542:0,6543:2,6544:0,6545:1,6546:0,6547:1,6548:0,6549:2,6550:0,6551:2,6552:0,6553:2,6554:0,6555:2,6556:0,6557:1,6558:0,6559:1,6560:0,6561:1,6562:0,6563:2,6564:0,6565:2,6566:0,6567:0,6568:2,6569:0,6570:1,6571:0,6572:2,6573:0,6574:2,6575:0,6576:2,6577:0,6578:2,6582:2,6583:0,6584:2,6585:0,6586:2,6587:0,6588:2,6589:0,6590:2,6591:0,6592:0,6593:2,6594:0,6595:2,6596:0,6597:2,6598:0,6599:2,6600:0,6601:2,6602:0,6603:2,6605:2,6606:0,6607:2,6608:0,6609:2,6610:0,6611:0,6612:2,6613:0,6614:2,6615:0,6616:2,6617:0,6618:2,6633:2,6646:0,6703:0,6784:0,6785:1,6786:0,6787:1,6788:0,6789:1,6790:0,6791:1,6792:0,6793:1,6794:0,6795:1,6796:0,6797:1,6798:0,6799:1,6800:0,6801:1,6802:0,6803:1,6804:0,6805:1,6806:0,6807:1,6808:0,6809:1,6810:0,6811:1,6812:0,6813:1,6814:0,6815:1,6816:0,6817:1,6818:0,6819:1,6820:0,6821:1,6822:0,6823:1,6824:0,6825:1,6826:0,6827:1,6828:0,6829:1,6830:0,6831:1,6832:0,6833:1,6834:0,6835:1,6836:0,6837:1,6838:0,6839:1,6840:0,6841:1,6842:0,6843:1,6844:0,6845:1,6846:0,6847:1,6848:0,6849:1,6850:0,6851:1,6852:0,6853:1,6854:0,6855:1,6856:0,6857:1,6858:0,6859:1,6860:0,6861:1,6862:0,6863:1,6867:0,6868:1,6870:0,6875:0,6876:0,6879:0,6880:2,6884:0,6885:1,6886:0,6887:1,6915:0,6922:0,6923:2,6924:0,6925:2,6962:0,6984:0,6991:0,7128:2,7131:0,7132:2,7142:0,7257:0,7258:2,7259:0,7260:2,7261:0,7262:2,7263:0,7264:2,7265:0,7266:2,7267:0,7268:2,7269:0,7270:2,7271:0,7272:2,7273:0,7274:2,7275:0,7276:2,7277:0,7278:2,7279:0,7280:2,7281:0,7282:2,7283:0,7284:2,7285:0,7286:2,7287:0,7288:2,7289:0,7290:2,7291:0,7292:2,7293:0,7294:2,7295:0,7296:2,7297:0,7298:2,7299:0,7300:2,7301:0,7302:2,7303:0,7304:2,7305:0,7306:2,7307:0,7308:2,7309:0,7310:2,7311:0,7312:2,7313:0,7314:2,7315:0,7316:2,7317:0,7318:2,7319:0,7320:2,7321:0,7322:2,7323:0,7324:2,7325:0,7326:2,7327:0,7328:2,7329:0,7330:2,7331:0,7332:2,7333:0,7334:2,7335:0,7336:2,7337:0,7338:2,7339:0,7340:2,7341:0,7342:2,7343:0,7344:2,7345:0,7346:2,7347:0,7348:2,7349:0,7350:2,7351:0,7352:2,7353:0,7354:2,7355:0,7356:2,7357:0,7358:2,7359:0,7360:2,7361:0,7362:2,7363:0,7364:2,7365:0,7366:2,7367:0,7368:2,7369:0,7370:2,7877:0,7878:0,7882:0,7883:0,7887:0,7899:0,7991:0,7992:0,8035:2,8036:2,8058:0,8059:0,8082:0,8083:0,8088:0,8090:0,8091:2,8092:0,8093:2,8095:0,8096:2,8097:0,8098:2,8099:0,8100:2,8101:0,8102:2,8103:0,8104:2,8105:0,8106:2,8107:0,8108:2,8109:0,8110:2,8111:0,8112:2,8113:0,8114:2,8115:0,8116:2,8117:0,8118:2,8119:0,8120:2,8121:0,8122:2,8123:0,8124:2,8125:0,8126:2,8127:0,8128:2,8129:0,8130:2,8131:0,8132:2,8133:0,8134:2,8135:0,8136:2,8137:0,8138:2,8139:0,8140:2,8141:0,8142:2,8143:0,8144:2,8145:0,8146:2,8147:0,8148:2,8149:0,8150:2,8151:0,8152:2,8153:0,8154:2,8155:0,8156:2,8157:0,8158:2,8159:0,8160:2,8161:0,8162:2,8163:0,8164:2,8165:0,8166:2,8167:0,8168:2,8169:0,8170:2,8171:0,8172:2,8173:0,8177:2,8179:0,8180:2,8181:0,8182:2,8184:0,8185:2,8187:0,8189:2,8191:0,8193:2,8196:0,8197:2,8198:0,8200:2,8201:0,8202:2,8203:0,8204:2,8205:0,8206:2,8207:0,8208:2,8209:0,8210:2,8212:0,8213:2,8214:0,8216:2,8218:0,8220:2,8222:0,8224:2,8225:0,8226:2,8311:0,8312:1,8313:0,8314:1,8315:0,8316:1,8317:0,8318:1,8319:0,8320:1,8321:0,8322:1,8323:0,8324:1,8325:0,8326:1,8327:0,8328:1,8329:0,8330:1,8331:0,8332:1,8333:0,8334:1,8335:0,8336:1,8337:0,8338:1,8339:0,8340:1,8341:0,8342:1,8343:0,8344:1,8345:0,8346:1,8347:0,8348:1,8352:0,8353:0,8379:0,8380:2,8381:0,8382:2,8383:0,8384:2,8385:0,8387:2,8391:0,8395:0,8433:0,8441:0,8455:0,8456:0,8531:2,8682:0,8686:0,8687:0,8692:0,8693:0,8826:0,8903:0,8950:0,8951:0,9039:0,9040:0,9141:0,9149:0,9150:0,9191:0,9221:0,9222:0,9249:0,9250:0,9252:0,9254:0,9265:0,9284:0,9285:0,9300:0,9354:0,9367:0,9373:0,9377:0,9387:0,9391:0,9456:0,9473:0,9498:0,9674:0,9678:0,9680:0,9709:0,9712:0,9713:0,9716:0,9741:0,9748:2,9749:2,9761:0,9766:0,20499:0,20538:0,20539:0,20790:0,20791:0,21291:0,21292:0,21500:0,21817:0,21818:0,22032:0,22033:0,22091:0,22092:0,22332:0,22391:0,22392:0,22700:0,22770:0,22780:0,22832:0,23090:0,23095:0,23239:0,23240:0,23433:0,23700:0,24047:0,24048:0,24100:3,24200:0,24305:0,24306:0,24382:10,24383:0,24500:0,24547:0,24548:0,24571:9,24600:0,25e3:0,25231:0,25884:0,25932:0,26237:0,26331:0,26332:0,26432:0,26591:0,26592:0,26632:0,26692:0,27120:0,27200:0,27291:6,27292:6,27429:0,27492:0,27493:0,27500:0,27700:0,28232:0,28600:0,28991:0,28992:0,29100:0,29101:0,29220:0,29221:0,29333:0,29635:0,29636:0,29701:0,29738:0,29739:0,29849:0,29850:0,29871:8,29872:7,29873:0,29874:0,30200:5,30339:0,30340:0,30591:0,30592:0,30791:0,30792:0,30800:0,31028:0,31121:0,31154:0,31170:0,31171:0,31370:0,31528:0,31529:0,31600:0,31700:0,31838:0,31839:0,31900:0,31901:0,32061:0,32062:0,32098:0,32099:2,32100:0,32104:0,32161:0,32766:0,53048:0,53049:0,54090:0,54091:0,65061:2,65062:2,65161:0,65163:0,102041:2,102064:11,102068:15,102069:16,102118:2,102119:1,102120:2,102121:2,102217:2,102218:0,102219:2,102220:2,102378:1,102379:1,102380:0,102381:1,102589:2,102599:2,102600:2,102604:2,102647:0,102704:2,102705:2,102706:0,102759:1,102760:1,102761:2,102762:0,102763:2,102764:0,102765:0,102766:2,102970:1,102974:2,102993:0,102994:0,102995:2,102996:2,103015:0,103016:2,103017:0,103018:2,103025:0,103026:0,103027:2,103028:2,103035:0,103036:0,103037:2,103038:2,103039:0,103040:0,103041:2,103042:2,103043:0,103044:0,103045:2,103046:2,103047:0,103048:0,103049:2,103050:2,103051:0,103052:2,103053:0,103054:2,103055:0,103056:2,103057:0,103058:0,103059:2,103060:2,103061:0,103062:0,103063:2,103064:2,103069:2,103070:0,103071:0,103072:2,103073:2,103086:0,103087:0,103088:2,103089:2,103094:1,103095:0,103096:2,103103:0,103104:2,103105:0,103106:2,103121:0,103122:2,103123:0,103124:0,103125:1,103126:1,103127:0,103128:0,103129:2,103130:2,103131:0,103132:0,103133:2,103134:2,103135:0,103136:0,103137:1,103138:1,103139:0,103140:2,103141:0,103142:2,103143:0,103144:2,103145:0,103146:1,103147:0,103148:0,103149:2,103150:2,103151:0,103152:2,103172:0,103173:2,103174:0,103175:0,103176:2,103177:2,103178:0,103179:0,103180:2,103181:2,103182:0,103183:0,103184:2,103185:2,103228:0,103229:0,103230:2,103231:2,103250:0,103251:2,103252:0,103253:2,103260:0,103261:0,103262:2,103263:2,103270:0,103271:0,103272:2,103273:2,103274:0,103275:0,103276:2,103277:2,103278:0,103279:0,103280:2,103281:2,103282:0,103283:0,103284:2,103285:2,103286:0,103287:2,103288:0,103289:2,103290:0,103291:2,103292:0,103293:0,103294:2,103295:2,103296:0,103297:0,103298:2,103299:2,103376:2,103377:0,103378:0,103379:2,103380:2,103393:0,103394:0,103395:2,103396:2,103472:0,103473:1,103474:0,103475:2,103482:0,103483:2,103484:0,103485:2,103500:0,103501:2,103502:0,103503:0,103504:1,103505:1,103506:0,103507:0,103508:2,103509:2,103510:0,103511:0,103512:2,103513:2,103514:0,103515:2,103516:0,103517:2,103518:0,103519:2,103520:0,103521:1,103522:0,103523:0,103524:2,103525:2,103526:0,103527:2,103561:2,103562:2,103563:0,103564:0,103565:2,103566:2,103567:0,103568:0,103569:2,103570:2,103584:0,103585:2,103586:0,103587:2,103588:1,103589:0,103590:2,103591:1,103592:0,103593:2,103594:1,103695:2};for(C=2e3;C<=2045;C++)ne[C]=0;for(C=2056;C<=2065;C++)ne[C]=0;for(C=2067;C<=2135;C++)ne[C]=0;for(C=2137;C<=2154;C++)ne[C]=0;for(C=2161;C<=2170;C++)ne[C]=0;for(C=2172;C<=2193;C++)ne[C]=0;for(C=2195;C<=2198;C++)ne[C]=0;for(C=2200;C<=2203;C++)ne[C]=0;for(C=2205;C<=2217;C++)ne[C]=0;for(C=2222;C<=2224;C++)ne[C]=1;for(C=2225;C<=2250;C++)ne[C]=2;for(C=2251;C<=2253;C++)ne[C]=1;for(C=2257;C<=2264;C++)ne[C]=2;for(C=2274;C<=2279;C++)ne[C]=2;for(C=2280;C<=2282;C++)ne[C]=1;for(C=2283;C<=2289;C++)ne[C]=2;for(C=2290;C<=2292;C++)ne[C]=0;for(C=2308;C<=2313;C++)ne[C]=0;for(C=2315;C<=2491;C++)ne[C]=0;for(C=2494;C<=2866;C++)ne[C]=0;for(C=2867;C<=2869;C++)ne[C]=1;for(C=2870;C<=2888;C++)ne[C]=2;for(C=2891;C<=2895;C++)ne[C]=2;for(C=2896;C<=2898;C++)ne[C]=1;for(C=2902;C<=2908;C++)ne[C]=2;for(C=2915;C<=2920;C++)ne[C]=2;for(C=2921;C<=2923;C++)ne[C]=1;for(C=2924;C<=2930;C++)ne[C]=2;for(C=2931;C<=2962;C++)ne[C]=0;for(C=2964;C<=2968;C++)ne[C]=2;for(C=2969;C<=2973;C++)ne[C]=0;for(C=2975;C<=2991;C++)ne[C]=0;for(C=2995;C<=3051;C++)ne[C]=0;for(C=3054;C<=3079;C++)ne[C]=0;for(C=3081;C<=3088;C++)ne[C]=0;for(C=3092;C<=3101;C++)ne[C]=0;for(C=3106;C<=3138;C++)ne[C]=0;for(C=3146;C<=3151;C++)ne[C]=0;for(C=3153;C<=3166;C++)ne[C]=0;for(C=3168;C<=3172;C++)ne[C]=0;for(C=3174;C<=3203;C++)ne[C]=0;for(C=3294;C<=3358;C++)ne[C]=0;for(C=3367;C<=3403;C++)ne[C]=0;for(C=3408;C<=3416;C++)ne[C]=0;for(C=3417;C<=3438;C++)ne[C]=2;for(C=3441;C<=3446;C++)ne[C]=2;for(C=3447;C<=3450;C++)ne[C]=0;for(C=3451;C<=3459;C++)ne[C]=2;for(C=3460;C<=3478;C++)ne[C]=0;for(C=3554;C<=3559;C++)ne[C]=0;for(C=3560;C<=3570;C++)ne[C]=2;for(C=3571;C<=3581;C++)ne[C]=0;for(C=3594;C<=3597;C++)ne[C]=0;for(C=3601;C<=3604;C++)ne[C]=0;for(C=3637;C<=3639;C++)ne[C]=0;for(C=3665;C<=3667;C++)ne[C]=0;for(C=3693;C<=3695;C++)ne[C]=0;for(C=3701;C<=3727;C++)ne[C]=0;for(C=3728;C<=3739;C++)ne[C]=2;for(C=3740;C<=3751;C++)ne[C]=0;for(C=3753;C<=3760;C++)ne[C]=2;for(C=3761;C<=3773;C++)ne[C]=0;for(C=3775;C<=3777;C++)ne[C]=0;for(C=3779;C<=3781;C++)ne[C]=0;for(C=3783;C<=3785;C++)ne[C]=0;for(C=3788;C<=3791;C++)ne[C]=0;for(C=3797;C<=3802;C++)ne[C]=0;for(C=3814;C<=3816;C++)ne[C]=0;for(C=3825;C<=3829;C++)ne[C]=0;for(C=3832;C<=3841;C++)ne[C]=0;for(C=3844;C<=3852;C++)ne[C]=0;for(C=3873;C<=3885;C++)ne[C]=0;for(C=3890;C<=3893;C++)ne[C]=0;for(C=3907;C<=3912;C++)ne[C]=0;for(C=3942;C<=3950;C++)ne[C]=0;for(C=3968;C<=3970;C++)ne[C]=0;for(C=3973;C<=3976;C++)ne[C]=0;for(C=3986;C<=3989;C++)ne[C]=0;for(C=3994;C<=3997;C++)ne[C]=0;for(C=4048;C<=4051;C++)ne[C]=0;for(C=4056;C<=4063;C++)ne[C]=0;for(C=4093;C<=4096;C++)ne[C]=0;for(C=4390;C<=4398;C++)ne[C]=0;for(C=4399;C<=4413;C++)ne[C]=2;for(C=4418;C<=4433;C++)ne[C]=2;for(C=4455;C<=4457;C++)ne[C]=2;for(C=4484;C<=4489;C++)ne[C]=0;for(C=4491;C<=4554;C++)ne[C]=0;for(C=4568;C<=4589;C++)ne[C]=0;for(C=4652;C<=4656;C++)ne[C]=0;for(C=4766;C<=4800;C++)ne[C]=0;for(C=5014;C<=5016;C++)ne[C]=0;for(C=5069;C<=5072;C++)ne[C]=0;for(C=5105;C<=5130;C++)ne[C]=0;for(C=5173;C<=5188;C++)ne[C]=0;for(C=5253;C<=5259;C++)ne[C]=0;for(C=5269;C<=5275;C++)ne[C]=0;for(C=5292;C<=5311;C++)ne[C]=0;for(C=5329;C<=5331;C++)ne[C]=0;for(C=5343;C<=5349;C++)ne[C]=0;for(C=5355;C<=5357;C++)ne[C]=0;for(C=5387;C<=5389;C++)ne[C]=0;for(C=5459;C<=5463;C++)ne[C]=0;for(C=5479;C<=5482;C++)ne[C]=0;for(C=5518;C<=5520;C++)ne[C]=0;for(C=5530;C<=5539;C++)ne[C]=0;for(C=5550;C<=5552;C++)ne[C]=0;for(C=5562;C<=5583;C++)ne[C]=0;for(C=5623;C<=5625;C++)ne[C]=2;for(C=5631;C<=5639;C++)ne[C]=0;for(C=5649;C<=5653;C++)ne[C]=0;for(C=5663;C<=5680;C++)ne[C]=0;for(C=5682;C<=5685;C++)ne[C]=0;for(C=5875;C<=5877;C++)ne[C]=0;for(C=5896;C<=5899;C++)ne[C]=0;for(C=5921;C<=5940;C++)ne[C]=0;for(C=6050;C<=6125;C++)ne[C]=0;for(C=6244;C<=6275;C++)ne[C]=0;for(C=6328;C<=6348;C++)ne[C]=0;for(C=6350;C<=6356;C++)ne[C]=0;for(C=6366;C<=6372;C++)ne[C]=0;for(C=6381;C<=6387;C++)ne[C]=0;for(C=6393;C<=6404;C++)ne[C]=0;for(C=6480;C<=6483;C++)ne[C]=0;for(C=6511;C<=6514;C++)ne[C]=0;for(C=6579;C<=6581;C++)ne[C]=0;for(C=6619;C<=6624;C++)ne[C]=0;for(C=6625;C<=6627;C++)ne[C]=2;for(C=6628;C<=6632;C++)ne[C]=0;for(C=6634;C<=6637;C++)ne[C]=0;for(C=6669;C<=6692;C++)ne[C]=0;for(C=6707;C<=6709;C++)ne[C]=0;for(C=6720;C<=6723;C++)ne[C]=0;for(C=6732;C<=6738;C++)ne[C]=0;for(C=6931;C<=6933;C++)ne[C]=0;for(C=6956;C<=6959;C++)ne[C]=0;for(C=7005;C<=7007;C++)ne[C]=0;for(C=7057;C<=7070;C++)ne[C]=2;for(C=7074;C<=7082;C++)ne[C]=0;for(C=7109;C<=7118;C++)ne[C]=0;for(C=7119;C<=7127;C++)ne[C]=1;for(C=7374;C<=7376;C++)ne[C]=0;for(C=7528;C<=7586;C++)ne[C]=0;for(C=7587;C<=7645;C++)ne[C]=2;for(C=7692;C<=7696;C++)ne[C]=0;for(C=7755;C<=7787;C++)ne[C]=0;for(C=7791;C<=7795;C++)ne[C]=0;for(C=7799;C<=7801;C++)ne[C]=0;for(C=7803;C<=7805;C++)ne[C]=0;for(C=7825;C<=7831;C++)ne[C]=0;for(C=7845;C<=7859;C++)ne[C]=0;for(C=8013;C<=8032;C++)ne[C]=0;for(C=8065;C<=8068;C++)ne[C]=1;for(C=8518;C<=8529;C++)ne[C]=2;for(C=8533;C<=8536;C++)ne[C]=2;for(C=8538;C<=8540;C++)ne[C]=2;for(C=8677;C<=8679;C++)ne[C]=0;for(C=8836;C<=8840;C++)ne[C]=0;for(C=8857;C<=8859;C++)ne[C]=0;for(C=8908;C<=8910;C++)ne[C]=0;for(C=9154;C<=9159;C++)ne[C]=0;for(C=9205;C<=9218;C++)ne[C]=0;for(C=9271;C<=9273;C++)ne[C]=0;for(C=9295;C<=9297;C++)ne[C]=0;for(C=9356;C<=9360;C++)ne[C]=0;for(C=9404;C<=9407;C++)ne[C]=0;for(C=9476;C<=9482;C++)ne[C]=0;for(C=9487;C<=9494;C++)ne[C]=0;for(C=9697;C<=9699;C++)ne[C]=0;for(C=20002;C<=20032;C++)ne[C]=0;for(C=20062;C<=20092;C++)ne[C]=0;for(C=20135;C<=20138;C++)ne[C]=0;for(C=20248;C<=20258;C++)ne[C]=0;for(C=20348;C<=20358;C++)ne[C]=0;for(C=20436;C<=20440;C++)ne[C]=0;for(C=20822;C<=20824;C++)ne[C]=0;for(C=20904;C<=20932;C++)ne[C]=0;for(C=20934;C<=20936;C++)ne[C]=0;for(C=21004;C<=21032;C++)ne[C]=0;for(C=21035;C<=21037;C++)ne[C]=0;for(C=21095;C<=21097;C++)ne[C]=0;for(C=21148;C<=21150;C++)ne[C]=0;for(C=21207;C<=21264;C++)ne[C]=0;for(C=21307;C<=21364;C++)ne[C]=0;for(C=21413;C<=21423;C++)ne[C]=0;for(C=21453;C<=21463;C++)ne[C]=0;for(C=21473;C<=21483;C++)ne[C]=0;for(C=21780;C<=21782;C++)ne[C]=0;for(C=21891;C<=21894;C++)ne[C]=0;for(C=21896;C<=21899;C++)ne[C]=0;for(C=22171;C<=22177;C++)ne[C]=0;for(C=22181;C<=22187;C++)ne[C]=0;for(C=22191;C<=22197;C++)ne[C]=0;for(C=22234;C<=22236;C++)ne[C]=0;for(C=22521;C<=22525;C++)ne[C]=0;for(C=22991;C<=22994;C++)ne[C]=0;for(C=23028;C<=23038;C++)ne[C]=0;for(C=23830;C<=23853;C++)ne[C]=0;for(C=23866;C<=23872;C++)ne[C]=0;for(C=23877;C<=23884;C++)ne[C]=0;for(C=23886;C<=23894;C++)ne[C]=0;for(C=23946;C<=23948;C++)ne[C]=0;for(C=24311;C<=24313;C++)ne[C]=0;for(C=24342;C<=24347;C++)ne[C]=0;for(C=24370;C<=24374;C++)ne[C]=10;for(C=24375;C<=24381;C++)ne[C]=0;for(C=24718;C<=24721;C++)ne[C]=0;for(C=24817;C<=24821;C++)ne[C]=0;for(C=24877;C<=24882;C++)ne[C]=0;for(C=24891;C<=24893;C++)ne[C]=0;for(C=25391;C<=25395;C++)ne[C]=0;for(C=25828;C<=25838;C++)ne[C]=0;for(C=26191;C<=26195;C++)ne[C]=0;for(C=26391;C<=26393;C++)ne[C]=0;for(C=26701;C<=26722;C++)ne[C]=0;for(C=26729;C<=26799;C++)ne[C]=2;for(C=26801;C<=26803;C++)ne[C]=2;for(C=26811;C<=26813;C++)ne[C]=2;for(C=26847;C<=26870;C++)ne[C]=2;for(C=26891;C<=26899;C++)ne[C]=0;for(C=26901;C<=26923;C++)ne[C]=0;for(C=26929;C<=26946;C++)ne[C]=0;for(C=26948;C<=26998;C++)ne[C]=0;for(C=27037;C<=27040;C++)ne[C]=0;for(C=27205;C<=27232;C++)ne[C]=0;for(C=27258;C<=27260;C++)ne[C]=0;for(C=27391;C<=27398;C++)ne[C]=0;for(C=27561;C<=27564;C++)ne[C]=0;for(C=27571;C<=27574;C++)ne[C]=0;for(C=27581;C<=27584;C++)ne[C]=0;for(C=27591;C<=27594;C++)ne[C]=0;for(C=28191;C<=28193;C++)ne[C]=0;for(C=28348;C<=28358;C++)ne[C]=0;for(C=28402;C<=28432;C++)ne[C]=0;for(C=28462;C<=28492;C++)ne[C]=0;for(C=29118;C<=29122;C++)ne[C]=0;for(C=29168;C<=29172;C++)ne[C]=0;for(C=29177;C<=29185;C++)ne[C]=0;for(C=29187;C<=29195;C++)ne[C]=0;for(C=29900;C<=29903;C++)ne[C]=0;for(C=30161;C<=30179;C++)ne[C]=0;for(C=30491;C<=30494;C++)ne[C]=0;for(C=30729;C<=30732;C++)ne[C]=0;for(C=31251;C<=31259;C++)ne[C]=0;for(C=31265;C<=31268;C++)ne[C]=0;for(C=31275;C<=31279;C++)ne[C]=0;for(C=31281;C<=31297;C++)ne[C]=0;for(C=31461;C<=31469;C++)ne[C]=0;for(C=31491;C<=31495;C++)ne[C]=0;for(C=31917;C<=31922;C++)ne[C]=0;for(C=31965;C<=32e3;C++)ne[C]=0;for(C=32001;C<=32003;C++)ne[C]=2;for(C=32005;C<=32031;C++)ne[C]=2;for(C=32033;C<=32060;C++)ne[C]=2;for(C=32064;C<=32067;C++)ne[C]=2;for(C=32074;C<=32077;C++)ne[C]=2;for(C=32081;C<=32086;C++)ne[C]=0;for(C=32107;C<=32130;C++)ne[C]=0;for(C=32133;C<=32158;C++)ne[C]=0;for(C=32164;C<=32167;C++)ne[C]=2;for(C=32180;C<=32199;C++)ne[C]=0;for(C=32201;C<=32260;C++)ne[C]=0;for(C=32301;C<=32360;C++)ne[C]=0;for(C=32601;C<=32662;C++)ne[C]=0;for(C=32664;C<=32667;C++)ne[C]=2;for(C=32701;C<=32761;C++)ne[C]=0;for(C=53001;C<=53004;C++)ne[C]=0;for(C=53008;C<=53019;C++)ne[C]=0;for(C=53021;C<=53032;C++)ne[C]=0;for(C=53034;C<=53037;C++)ne[C]=0;for(C=53042;C<=53046;C++)ne[C]=0;for(C=53074;C<=53080;C++)ne[C]=0;for(C=54001;C<=54004;C++)ne[C]=0;for(C=54008;C<=54019;C++)ne[C]=0;for(C=54021;C<=54032;C++)ne[C]=0;for(C=54034;C<=54037;C++)ne[C]=0;for(C=54042;C<=54046;C++)ne[C]=0;for(C=54048;C<=54053;C++)ne[C]=0;for(C=54074;C<=54080;C++)ne[C]=0;for(C=54098;C<=54101;C++)ne[C]=0;for(C=102001;C<=102040;C++)ne[C]=0;for(C=102042;C<=102063;C++)ne[C]=0;for(C=102065;C<=102067;C++)ne[C]=0;for(C=102070;C<=102117;C++)ne[C]=0;for(C=102122;C<=102216;C++)ne[C]=0;for(C=102221;C<=102377;C++)ne[C]=0;for(C=102382;C<=102388;C++)ne[C]=0;for(C=102389;C<=102398;C++)ne[C]=2;for(C=102399;C<=102444;C++)ne[C]=0;for(C=102445;C<=102447;C++)ne[C]=2;for(C=102448;C<=102458;C++)ne[C]=0;for(C=102459;C<=102468;C++)ne[C]=2;for(C=102469;C<=102499;C++)ne[C]=0;for(C=102500;C<=102519;C++)ne[C]=1;for(C=102520;C<=102524;C++)ne[C]=0;for(C=102525;C<=102529;C++)ne[C]=2;for(C=102530;C<=102588;C++)ne[C]=0;for(C=102590;C<=102598;C++)ne[C]=0;for(C=102601;C<=102603;C++)ne[C]=0;for(C=102605;C<=102628;C++)ne[C]=0;for(C=102629;C<=102646;C++)ne[C]=2;for(C=102648;C<=102700;C++)ne[C]=2;for(C=102701;C<=102703;C++)ne[C]=0;for(C=102707;C<=102730;C++)ne[C]=2;for(C=102733;C<=102758;C++)ne[C]=2;for(C=102767;C<=102900;C++)ne[C]=0;for(C=102901;C<=102933;C++)ne[C]=2;for(C=102934;C<=102950;C++)ne[C]=13;for(C=102951;C<=102955;C++)ne[C]=0;for(C=102961;C<=102963;C++)ne[C]=0;for(C=102965;C<=102969;C++)ne[C]=0;for(C=102971;C<=102973;C++)ne[C]=0;for(C=102975;C<=102989;C++)ne[C]=0;for(C=102990;C<=102992;C++)ne[C]=1;for(C=102997;C<=103002;C++)ne[C]=0;for(C=103003;C<=103008;C++)ne[C]=2;for(C=103009;C<=103011;C++)ne[C]=0;for(C=103012;C<=103014;C++)ne[C]=2;for(C=103019;C<=103021;C++)ne[C]=0;for(C=103022;C<=103024;C++)ne[C]=2;for(C=103029;C<=103031;C++)ne[C]=0;for(C=103032;C<=103034;C++)ne[C]=2;for(C=103065;C<=103068;C++)ne[C]=0;for(C=103074;C<=103076;C++)ne[C]=0;for(C=103077;C<=103079;C++)ne[C]=1;for(C=103080;C<=103082;C++)ne[C]=0;for(C=103083;C<=103085;C++)ne[C]=2;for(C=103090;C<=103093;C++)ne[C]=0;for(C=103097;C<=103099;C++)ne[C]=0;for(C=103100;C<=103102;C++)ne[C]=2;for(C=103107;C<=103109;C++)ne[C]=0;for(C=103110;C<=103112;C++)ne[C]=2;for(C=103113;C<=103116;C++)ne[C]=0;for(C=103117;C<=103120;C++)ne[C]=2;for(C=103153;C<=103157;C++)ne[C]=0;for(C=103158;C<=103162;C++)ne[C]=2;for(C=103163;C<=103165;C++)ne[C]=0;for(C=103166;C<=103168;C++)ne[C]=1;for(C=103169;C<=103171;C++)ne[C]=2;for(C=103186;C<=103188;C++)ne[C]=0;for(C=103189;C<=103191;C++)ne[C]=2;for(C=103192;C<=103195;C++)ne[C]=0;for(C=103196;C<=103199;C++)ne[C]=2;for(C=103200;C<=103224;C++)ne[C]=0;for(C=103225;C<=103227;C++)ne[C]=1;for(C=103232;C<=103237;C++)ne[C]=0;for(C=103238;C<=103243;C++)ne[C]=2;for(C=103244;C<=103246;C++)ne[C]=0;for(C=103247;C<=103249;C++)ne[C]=2;for(C=103254;C<=103256;C++)ne[C]=0;for(C=103257;C<=103259;C++)ne[C]=2;for(C=103264;C<=103266;C++)ne[C]=0;for(C=103267;C<=103269;C++)ne[C]=2;for(C=103300;C<=103375;C++)ne[C]=0;for(C=103381;C<=103383;C++)ne[C]=0;for(C=103384;C<=103386;C++)ne[C]=1;for(C=103387;C<=103389;C++)ne[C]=0;for(C=103390;C<=103392;C++)ne[C]=2;for(C=103397;C<=103399;C++)ne[C]=0;for(C=103400;C<=103471;C++)ne[C]=2;for(C=103476;C<=103478;C++)ne[C]=0;for(C=103479;C<=103481;C++)ne[C]=2;for(C=103486;C<=103488;C++)ne[C]=0;for(C=103489;C<=103491;C++)ne[C]=2;for(C=103492;C<=103495;C++)ne[C]=0;for(C=103496;C<=103499;C++)ne[C]=2;for(C=103528;C<=103543;C++)ne[C]=0;for(C=103544;C<=103548;C++)ne[C]=2;for(C=103549;C<=103551;C++)ne[C]=0;for(C=103552;C<=103554;C++)ne[C]=1;for(C=103555;C<=103557;C++)ne[C]=2;for(C=103558;C<=103560;C++)ne[C]=0;for(C=103571;C<=103573;C++)ne[C]=0;for(C=103574;C<=103576;C++)ne[C]=2;for(C=103577;C<=103580;C++)ne[C]=0;for(C=103581;C<=103583;C++)ne[C]=2;for(C=103595;C<=103694;C++)ne[C]=0;for(C=103696;C<=103699;C++)ne[C]=0;for(C=103700;C<=103793;C++)ne[C]=2;for(C=103794;C<=103887;C++)ne[C]=0;for(C=103900;C<=103971;C++)ne[C]=2;const Mme={102113:!0,102100:!0,3857:!0,3785:!0},Ime={4326:!0,3785:!0,3857:!0,102113:!0,102100:!0,104905:!0,104971:!0},YV='PROJCS["WGS_1984_Web_Mercator_Auxiliary_Sphere",GEOGCS["GCS_WGS_1984",DATUM["D_WGS_1984",SPHEROID["WGS_1984",6378137.0,298.257223563]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]],PROJECTION["Mercator_Auxiliary_Sphere"],PARAMETER["False_Easting",0.0],PARAMETER["False_Northing",0.0],PARAMETER["Central_Meridian",{Central_Meridian}],PARAMETER["Standard_Parallel_1",0.0],PARAMETER["Auxiliary_Sphere_Type",0.0],UNIT["Meter",1.0]]',kS=[-20037508342788905e-9,20037508342788905e-9],AS=[-20037508342787e-6,20037508342787e-6],XV={102113:{wkTemplate:'PROJCS["WGS_1984_Web_Mercator",GEOGCS["GCS_WGS_1984_Major_Auxiliary_Sphere",DATUM["D_WGS_1984_Major_Auxiliary_Sphere",SPHEROID["WGS_1984_Major_Auxiliary_Sphere",6378137.0,0.0]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]],PROJECTION["Mercator"],PARAMETER["False_Easting",0.0],PARAMETER["False_Northing",0.0],PARAMETER["Central_Meridian",{Central_Meridian}],PARAMETER["Standard_Parallel_1",0.0],UNIT["Meter",1.0]]',valid:kS,origin:AS,dx:1e-5},102100:{wkTemplate:YV,valid:kS,origin:AS,dx:1e-5},3785:{wkTemplate:'PROJCS["WGS_1984_Web_Mercator",GEOGCS["GCS_WGS_1984_Major_Auxiliary_Sphere",DATUM["D_WGS_1984_Major_Auxiliary_Sphere",SPHEROID["WGS_1984_Major_Auxiliary_Sphere",6378137.0,0.0]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]],PROJECTION["Mercator"],PARAMETER["False_Easting",0.0],PARAMETER["False_Northing",0.0],PARAMETER["Central_Meridian",{Central_Meridian}],PARAMETER["Standard_Parallel_1",0.0],UNIT["Meter",1.0]]',valid:kS,origin:AS,dx:1e-5},3857:{wkTemplate:YV,valid:kS,origin:AS,dx:1e-5},4326:{wkTemplate:'GEOGCS["GCS_WGS_1984",DATUM["D_WGS_1984",SPHEROID["WGS_1984",6378137.0,298.257223563]],PRIMEM["Greenwich",{Central_Meridian}],UNIT["Degree",0.0174532925199433]]',altTemplate:'PROJCS["WGS_1984_Plate_Carree",GEOGCS["GCS_WGS_1984",DATUM["D_WGS_1984",SPHEROID["WGS_1984",6378137.0,298.257223563]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]],PROJECTION["Plate_Carree"],PARAMETER["False_Easting",0.0],PARAMETER["False_Northing",0.0],PARAMETER["Central_Meridian",{Central_Meridian}],UNIT["Degrees",111319.491]]',valid:[-180,180],origin:[-180,90],dx:1e-5},104971:{wkTemplate:'GEOGCS["Mars_2000_(Sphere)",DATUM["Mars_2000_(Sphere)",SPHEROID["Mars_2000_(Sphere)",3396190.0,0.0]],PRIMEM["Reference_Meridian",0.0],UNIT["Degree",0.0174532925199433]]',valid:[-180,180],origin:[-180,90],dx:1e-5},104905:{wkTemplate:'GEOGCS["GCS_Mars_2000",DATUM["D_Mars_2000",SPHEROID["Mars_2000_IAU_IAG",3396190.0,169.8944472236118]],PRIMEM["Reference_Meridian",0.0],UNIT["Degree",0.0174532925199433]]',valid:[-180,180],origin:[-180,90],dx:1e-5}};function hr(e,t){return e===t||!ce(e)&&!ce(t)&&(e.wkid!=null||t.wkid!=null?e.wkid===t.wkid||Xc(e)&&Xc(t)||t.latestWkid!=null&&e.wkid===t.latestWkid||e.latestWkid!=null&&t.wkid===e.latestWkid:!(!e.wkt||!t.wkt)&&e.wkt.toUpperCase()===t.wkt.toUpperCase())}function Wo(e){return Sn(e)&&e.wkid&&XV[e.wkid]||null}function PS(e){return!!Sn(e)&&(e.wkid?ne[e.wkid]==null:!!e.wkt&&!!/^\s*GEOGCS/i.test(e.wkt))}function $me(e){return!(ng(e)||sg(e))}function mw(e){return Sn(e)&&e.wkid===4326}function JHe(e){return Sn(e)&&e.wkid===pl.CGCS2000}function Xc(e){return Sn(e)&&e.wkid!=null&&Mme[e.wkid]===!0}function Eme(e){return Sn(e)&&e.wkid===32662}function wT(e){return e===pl.GCSMARS2000||e===pl.GCSMARS2000_SPHERE}function ng(e){return Sn(e)&&e.wkid!=null&&wT(e.wkid)}function _T(e){return e===pl.GCSMOON2000}function sg(e){return Sn(e)&&e.wkid!=null&&_T(e.wkid)}function Tme(e){return Sn(e)&&e.wkid!=null&&Ime[e.wkid]===!0}function Sn(e){return H(e)&&(e.wkid!=null&&e.wkid>=2e3||e.wkt!=null)}const xT={wkid:4326,wkt:Kc(XV[4326].wkTemplate,{Central_Meridian:"0.0"})},Cme={wkid:102100,latestWkid:3857},kme={wkid:32662};var Qc;let er=Qc=class extends ke{constructor(e){super(e),this.latestWkid=null,this.wkid=null,this.wkt=null,this.vcsWkid=null,this.latestVcsWkid=null,this.imageCoordinateSystem=null}static fromJSON(e){if(!e)return null;if(e.wkid){if(e.wkid===102100)return Qc.WebMercator;if(e.wkid===4326)return Qc.WGS84}const t=new Qc;return t.read(e),t}normalizeCtorArgs(e){return e&&typeof e=="object"?e:{[typeof e=="string"?"wkt":"wkid"]:e}}get isWGS84(){return mw(this)}get isWebMercator(){return Xc(this)}get isGeographic(){return PS(this)}get isWrappable(){return Tme(this)}writeWkt(e,t){this.wkid||(t.wkt=e)}clone(){if(this===Qc.WGS84)return Qc.WGS84;if(this===Qc.WebMercator)return Qc.WebMercator;const e=new Qc;return this.wkid!=null?(e.wkid=this.wkid,this.latestWkid!=null&&(e.latestWkid=this.latestWkid),this.vcsWkid!=null&&(e.vcsWkid=this.vcsWkid),this.latestVcsWkid!=null&&(e.latestVcsWkid=this.latestVcsWkid)):this.wkt!=null&&(e.wkt=this.wkt),this.imageCoordinateSystem&&(e.imageCoordinateSystem=_e(this.imageCoordinateSystem)),e}equals(e){if(e==null)return!1;if(this.imageCoordinateSystem||e.imageCoordinateSystem){if(this.imageCoordinateSystem==null||e.imageCoordinateSystem==null)return!1;const{id:t,referenceServiceName:i}=e.imageCoordinateSystem,{geodataXform:r}=e.imageCoordinateSystem,n=this.imageCoordinateSystem;return t==null||r?JSON.stringify(n)===JSON.stringify(e.imageCoordinateSystem):i?n.id===t&&n.referenceServiceName===i:n.id===t}return hr(this,e)}toJSON(e){return this.write(void 0,e)}};er.GCS_NAD_1927=null,er.WGS84=null,er.WebMercator=null,er.PlateCarree=null,g([w({readOnly:!0})],er.prototype,"isWGS84",null),g([w({readOnly:!0})],er.prototype,"isWebMercator",null),g([w({readOnly:!0})],er.prototype,"isGeographic",null),g([w({readOnly:!0})],er.prototype,"isWrappable",null),g([w({type:Ri,json:{write:!0}})],er.prototype,"latestWkid",void 0),g([w({type:Ri,json:{write:!0,origins:{"web-scene":{write:{overridePolicy(){return{isRequired:this.wkt===null}}}}}}})],er.prototype,"wkid",void 0),g([w({type:String,json:{origins:{"web-scene":{write:{overridePolicy(){return{isRequired:this.wkid===null}}}}}}})],er.prototype,"wkt",void 0),g([tt("wkt"),tt("web-scene","wkt")],er.prototype,"writeWkt",null),g([w({type:Ri,json:{write:!0}})],er.prototype,"vcsWkid",void 0),g([w({type:Ri,json:{write:!0}})],er.prototype,"latestVcsWkid",void 0),g([w()],er.prototype,"imageCoordinateSystem",void 0),er=Qc=g([te("esri.geometry.SpatialReference")],er),er.prototype.toJSON.isDefaultToJSON=!0,er.GCS_NAD_1927=new er({wkid:4267,wkt:'GEOGCS["GCS_North_American_1927",DATUM["D_North_American_1927",SPHEROID["Clarke_1866",6378206.4,294.9786982]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]]'}),er.WGS84=new er(xT),er.WebMercator=new er(Cme),er.PlateCarree=new er(kme),Object.freeze&&(Object.freeze(er.GCS_NAD_1927),Object.freeze(er.WGS84),Object.freeze(er.WebMercator));const Mt=er;let eu=class extends ke{constructor(...e){super(...e),this.type=null,this.hasM=!1,this.hasZ=!1,this.spatialReference=Mt.WGS84}get cache(){return this.commitProperty("spatialReference"),{}}get extent(){return null}readSpatialReference(e,t){if(e instanceof Mt)return e;if(e!=null){const i=new Mt;return i.read(e,t),i}return e}clone(){return console.warn(".clone() is not implemented for "+this.declaredClass),null}clearCache(){this.notifyChange("cache")}getCacheValue(e){return this.cache[e]}setCacheValue(e,t){this.cache[e]=t}};g([w()],eu.prototype,"type",void 0),g([w({readOnly:!0})],eu.prototype,"cache",null),g([w({readOnly:!0})],eu.prototype,"extent",null),g([w({type:Boolean,json:{write:{overridePolicy:e=>({enabled:e})}}})],eu.prototype,"hasM",void 0),g([w({type:Boolean,json:{write:{overridePolicy:e=>({enabled:e})}}})],eu.prototype,"hasZ",void 0),g([w({type:Mt,json:{write:!0}})],eu.prototype,"spatialReference",void 0),g([We("spatialReference")],eu.prototype,"readSpatialReference",null),eu=g([te("esri.geometry.Geometry")],eu);const cd=eu,Ame=Object.prototype.toString;function Pme(e){const t="__accessorMetadata__"in e?Oi(e):e;return function(...i){if(i.push(t),typeof i[2]=="number")throw new Error("Using @cast has parameter decorator is not supported since 4.16");return Lme.apply(this,i)}}function Lme(e,t,i,r){cS(e,t).cast=r}function Ome(e){return(t,i)=>{cS(t,e).cast=t[i]}}function Dt(...e){if(e.length!==3||typeof e[1]!="string")return e.length===1&&Ame.call(e[0])==="[object Function]"?Pme(e[0]):e.length===1&&typeof e[0]=="string"?Ome(e[0]):void 0}function Rme(e,t){const i=e.x-t.x,r=e.y-t.y,n=e.hasZ&&t.hasZ?e.z-t.z:0;return Math.sqrt(i*i+r*r+n*n)}class ST{constructor(t,i,r,n){this.semiMajorAxis=t,this.flattening=i,this.outerAtmosphereRimWidth=r;const o=1-this.flattening;this.semiMinorAxis=this.semiMajorAxis*o,this.halfSemiMajorAxis=this.semiMajorAxis/2,this.halfCircumference=Math.PI*this.semiMajorAxis,this.metersPerDegree=this.halfCircumference/180,this.inverseFlattening=1/(1-this.flattening)-1,this.eccentricitySquared=n||2*this.flattening-this.flattening*this.flattening,this.meanRadiusSemiAxes=(2*this.semiMajorAxis+this.semiMinorAxis)/3}get radius(){return this.semiMajorAxis}}const gr=new ST(6378137,1/298.257223563,3e5,.006694379990137799),gh=new ST(3396190,1/169.8944472236118,23e4),ud=new ST(1737400,0,0),Fme=57.29577951308232,Nme=.017453292519943;function QV(e){return e*Fme}function ez(e){return e*Nme}function tz(e){return e/gr.radius}function iz(e){return Math.PI/2-2*Math.atan(Math.exp(-e/gr.radius))}function MT(e){return e.wkid!=null||e.wkt!=null}const IT=[0,0];function LS(e,t,i,r,n){const o=e,c=n;if(c.spatialReference=i,"x"in o&&"x"in c)[c.x,c.y]=t(o.x,o.y,IT,r);else if("xmin"in o&&"xmin"in c)[c.xmin,c.ymin]=t(o.xmin,o.ymin,IT,r),[c.xmax,c.ymax]=t(o.xmax,o.ymax,IT,r);else if("paths"in o&&"paths"in c||"rings"in o&&"rings"in c){const h="paths"in o?o.paths:o.rings,m=[];let b;for(let x=0;x<h.length;x++){const I=h[x];b=[],m.push(b);for(let E=0;E<I.length;E++)b.push(t(I[E][0],I[E][1],[0,0],r)),I[E].length>2&&b[E].push(I[E][2]),I[E].length>3&&b[E].push(I[E][3])}"paths"in c?c.paths=m:c.rings=m}else if("points"in o&&"points"in c){const h=o.points,m=[];for(let b=0;b<h.length;b++)m[b]=t(h[b][0],h[b][1],[0,0],r),h[b].length>2&&m[b].push(h[b][2]),h[b].length>3&&m[b].push(h[b][3]);c.points=m}return n}function og(e,t){const i=e&&(MT(e)?e:e.spatialReference),r=t&&(MT(t)?t:t.spatialReference);return!(e&&"type"in e&&e.type==="mesh"||t&&"type"in t&&t.type==="mesh"||!i||!r)&&(!!hr(r,i)||Xc(r)&&mw(i)||Xc(i)&&mw(r))}function gw(e,t){if(ce(e))return null;const i=e.spatialReference,r=t&&(MT(t)?t:t.spatialReference);return og(i,r)?hr(i,r)?_e(e):Xc(r)?LS(e,g0,Mt.WebMercator,!1,_e(e)):mw(r)?LS(e,ag,Mt.WGS84,!1,_e(e)):null:null}function g0(e,t,i=[0,0]){t>89.99999?t=89.99999:t<-89.99999&&(t=-89.99999);const r=ez(t);return i[0]=ez(e)*gr.radius,i[1]=gr.halfSemiMajorAxis*Math.log((1+Math.sin(r))/(1-Math.sin(r))),i}function ag(e,t,i=[0,0],r=!1){const n=QV(e/gr.radius);return i[0]=r?n:n-360*Math.floor((n+180)/360),i[1]=QV(Math.PI/2-2*Math.atan(Math.exp(-t/gr.radius))),i}function tu(e,t=!1,i=_e(e)){return LS(e,g0,Mt.WebMercator,t,i)}function v0(e,t=!1,i=_e(e)){return LS(e,ag,Mt.WGS84,t,i)}var OS;const vw=[0,0];function rz(e){return e&&(e.declaredClass==="esri.geometry.SpatialReference"||e.wkid!=null)}let Eo=OS=class extends cd{constructor(...e){super(...e),this.x=0,this.y=0,this.z=void 0,this.m=void 0,this.type="point"}static copy(e,t){t._set("x",e._get("x")),t._set("y",e._get("y")),t._set("z",e._get("z")),t._set("m",e._get("m"));const i=e._get("spatialReference");t._set("spatialReference",Object.isFrozen(i)?i:i.clone())}normalizeCtorArgs(e,t,i,r,n){let o;if(Array.isArray(e))o=e,n=t,e=o[0],t=o[1],i=o[2],r=o[3];else if(e&&typeof e=="object"){if(o=e,e=o.x!=null?o.x:o.longitude,t=o.y!=null?o.y:o.latitude,i=o.z,r=o.m,(n=o.spatialReference)&&n.declaredClass!=="esri.geometry.SpatialReference"&&(n=new Mt(n)),o.longitude!=null||o.latitude!=null){if(o.longitude==null)$e.getLogger(this.declaredClass).warn(".longitude=","Latitude was defined without longitude");else if(o.latitude==null)$e.getLogger(this.declaredClass).warn(".latitude=","Longitude was defined without latitude");else if(!o.declaredClass&&n&&n.isWebMercator){const h=g0(o.longitude,o.latitude,vw);e=h[0],t=h[1]}}}else rz(i)?(n=i,i=null):rz(r)&&(n=r,r=null);const c={x:e,y:t};return c.x==null&&c.y!=null?$e.getLogger(this.declaredClass).warn(".y=","Y coordinate was defined without an X coordinate"):c.y==null&&c.x!=null&&$e.getLogger(this.declaredClass).warn(".x=","X coordinate was defined without a Y coordinate"),n!=null&&(c.spatialReference=n),i!=null&&(c.z=i),r!=null&&(c.m=r),c}get cache(){return this.commitProperty("x"),this.commitProperty("y"),this.commitProperty("z"),this.commitProperty("m"),this.commitProperty("spatialReference"),{}}get hasM(){return this.m!==void 0}set hasM(e){e!==(this._get("m")!==void 0)&&(this._set("m",e?0:void 0),this._set("hasM",e))}get hasZ(){return this.z!==void 0}set hasZ(e){e!==(this._get("z")!==void 0)&&(this._set("z",e?0:void 0),this._set("hasZ",e))}get latitude(){const{spatialReference:e,x:t,y:i}=this;if(e){if(e.isWebMercator)return ag(t,i,vw)[1];if(e.isGeographic)return i}return null}set latitude(e){const{spatialReference:t,x:i}=this;e!=null&&t&&(t.isWebMercator?this._set("y",g0(i,e,vw)[1]):t.isGeographic&&this._set("y",e),this._set("latitude",e))}get longitude(){const{x:e,y:t,spatialReference:i}=this;if(i){if(i.isWebMercator)return ag(e,t,vw)[0];if(i.isGeographic)return e}return null}set longitude(e){const{y:t,spatialReference:i}=this;e!=null&&i&&(i.isWebMercator?this._set("x",g0(e,t,vw)[0]):i.isGeographic&&this._set("x",e),this._set("longitude",e))}writeX(e,t,i){t[i]=isNaN(e)?"NaN":e}readX(e){return typeof e=="string"?NaN:e}clone(){const e=new OS;return e.x=this.x,e.y=this.y,e.z=this.z,e.m=this.m,e.spatialReference=this.spatialReference,e}copy(e){return OS.copy(e,this),this}equals(e){if(ce(e))return!1;const{x:t,y:i,z:r,m:n,spatialReference:o}=this,{z:c,m:h}=e;let{x:m,y:b,spatialReference:x}=e;if(!o.equals(x))if(o.isWebMercator&&x.isWGS84)[m,b]=g0(m,b),x=o;else{if(!o.isWGS84||!x.isWebMercator)return!1;[m,b]=ag(m,b),x=o}return t===m&&i===b&&r===c&&n===h&&o.wkid===x.wkid}offset(e,t,i){var r;return this.x+=e,this.y+=t,i!=null&&(this.z=((r=this.z)!=null?r:0)+i),this}normalize(){if(!this.spatialReference)return this;const e=Wo(this.spatialReference);if(!e)return this;let t=this.x;const[i,r]=e.valid,n=2*r;let o;return t>r?(o=Math.ceil(Math.abs(t-r)/n),t-=o*n):t<i&&(o=Math.ceil(Math.abs(t-i)/n),t+=o*n),this._set("x",t),this}distance(e){return Rme(this,e)}toArray(){const e=this.hasZ,t=this.hasM;return e&&t?[this.x,this.y,this.z,this.m]:e?[this.x,this.y,this.z]:t?[this.x,this.y,this.m]:[this.x,this.y]}toJSON(e){return this.write({},e)}};g([w({readOnly:!0})],Eo.prototype,"cache",null),g([w({type:Boolean,json:{read:!1,write:{enabled:!1,overridePolicy:null}}})],Eo.prototype,"hasM",null),g([w({type:Boolean,json:{read:!1,write:{enabled:!1,overridePolicy:null}}})],Eo.prototype,"hasZ",null),g([w({type:Number})],Eo.prototype,"latitude",null),g([w({type:Number})],Eo.prototype,"longitude",null),g([w({type:Number,json:{type:[Number,String],write:{isRequired:!0,allowNull:!0}}}),Dt(e=>isNaN(e)?e:hl(e))],Eo.prototype,"x",void 0),g([tt("x")],Eo.prototype,"writeX",null),g([We("x")],Eo.prototype,"readX",null),g([w({type:Number,json:{write:!0}})],Eo.prototype,"y",void 0),g([w({type:Number,json:{write:{overridePolicy(){return{enabled:this.hasZ}}}}})],Eo.prototype,"z",void 0),g([w({type:Number,json:{write:{overridePolicy(){return{enabled:this.hasM}}}}})],Eo.prototype,"m",void 0),Eo=OS=g([te("esri.geometry.Point")],Eo),Eo.prototype.toJSON.isDefaultToJSON=!0;const pt=Eo,$T=[0,0];function RS(e,t){return!!H(t)&&To(e,t.x,t.y,t.z)}function ZHe(e,t){if(!t.points||t.points.length)return!1;for(const i of t.points)if(!lg(e,i))return!1;return!0}function Dme(e,t){const{xmin:i,ymin:r,zmin:n,xmax:o,ymax:c,zmax:h}=t;return e.hasZ&&t.hasZ?To(e,i,r,n)&&To(e,i,c,n)&&To(e,o,c,n)&&To(e,o,r,n)&&To(e,i,r,h)&&To(e,i,c,h)&&To(e,o,c,h)&&To(e,o,r,h):To(e,i,r)&&To(e,i,c)&&To(e,o,c)&&To(e,o,r)}function lg(e,t){return To(e,t[0],t[1])}function jme(e,t){return To(e,t[0],t[1],t[2])}function To(e,t,i,r){return t>=e.xmin&&t<=e.xmax&&i>=e.ymin&&i<=e.ymax&&(r==null||!e.hasZ||r>=e.zmin&&r<=e.zmax)}function nz(e,t){return $T[1]=t.y,$T[0]=t.x,Vme(e,$T)}function Vme(e,t){return sz(e.rings,t)}function sz(e,t){if(!e)return!1;if(zme(e))return oz(!1,e,t);let i=!1;for(let r=0,n=e.length;r<n;r++)i=oz(i,e[r],t);return i}function zme(e){return!Array.isArray(e[0][0])}function oz(e,t,i){const[r,n]=i;let o=e,c=0;for(let h=0,m=t.length;h<m;h++){c++,c===m&&(c=0);const[b,x]=t[h],[I,E]=t[c];(x<n&&E>=n||E<n&&x>=n)&&b+(n-x)/(E-x)*(I-b)<r&&(o=!o)}return o}function Gme(e,t){return RS(e,t)}function Bme(e,t){const i=e.hasZ&&t.hasZ;let r,n,o;if(e.xmin<=t.xmin){if(r=t.xmin,e.xmax<r)return!1}else if(r=e.xmin,t.xmax<r)return!1;if(e.ymin<=t.ymin){if(n=t.ymin,e.ymax<n)return!1}else if(n=e.ymin,t.ymax<n)return!1;if(i&&t.hasZ){if(e.zmin<=t.zmin){if(o=t.zmin,e.zmax<o)return!1}else if(o=e.zmin,t.zmax<o)return!1}return!0}function Ume(e,t){const{points:i,hasZ:r}=t,n=r?jme:lg;for(const o of i)if(n(e,o))return!0;return!1}const b0=[0,0],w0=[0,0],_0=[0,0],x0=[0,0],qme=[b0,w0,_0,x0],az=[[_0,b0],[b0,w0],[w0,x0],[x0,_0]];function Hme(e,t){return Wme(e,t.rings)}function Wme(e,t){b0[0]=e.xmin,b0[1]=e.ymax,w0[0]=e.xmax,w0[1]=e.ymax,_0[0]=e.xmin,_0[1]=e.ymin,x0[0]=e.xmax,x0[1]=e.ymin;for(const i of qme)if(sz(t,i))return!0;for(const i of t){if(!i.length)continue;let r=i[0];if(lg(e,r))return!0;for(let n=1;n<i.length;n++){const o=i[n];if(lg(e,o)||lz(r,o,az))return!0;r=o}}return!1}function Jme(e,t){b0[0]=e.xmin,b0[1]=e.ymax,w0[0]=e.xmax,w0[1]=e.ymax,_0[0]=e.xmin,_0[1]=e.ymin,x0[0]=e.xmax,x0[1]=e.ymin;const i=t.paths;for(const r of i){if(!i.length)continue;let n=r[0];if(lg(e,n))return!0;for(let o=1;o<r.length;o++){const c=r[o];if(lg(e,c)||lz(n,c,az))return!0;n=c}}return!1}const _s=[0,0];function Zme(e){for(let t=0;t<e.length;t++){const i=e[t];for(let n=0;n<i.length-1;n++){const o=i[n],c=i[n+1];for(let h=t+1;h<e.length;h++)for(let m=0;m<e[h].length-1;m++){const b=e[h][m],x=e[h][m+1];if(ET(o,c,b,x,_s)&&!(_s[0]===o[0]&&_s[1]===o[1]||_s[0]===b[0]&&_s[1]===b[1]||_s[0]===c[0]&&_s[1]===c[1]||_s[0]===x[0]&&_s[1]===x[1]))return!0}}const r=i.length;if(!(r<=4))for(let n=0;n<r-3;n++){let o=r-1;n===0&&(o=r-2);const c=i[n],h=i[n+1];for(let m=n+2;m<o;m++){const b=i[m],x=i[m+1];if(ET(c,h,b,x,_s)&&!(_s[0]===c[0]&&_s[1]===c[1]||_s[0]===b[0]&&_s[1]===b[1]||_s[0]===h[0]&&_s[1]===h[1]||_s[0]===x[0]&&_s[1]===x[1]))return!0}}}return!1}function lz(e,t,i){for(let r=0;r<i.length;r++)if(ET(e,t,i[r][0],i[r][1]))return!0;return!1}function ET(e,t,i,r,n){const[o,c]=e,[h,m]=t,[b,x]=i,[I,E]=r,k=I-b,P=o-b,F=h-o,N=E-x,B=c-x,z=m-c,q=N*F-k*z;if(q===0)return!1;const J=(k*B-N*P)/q,X=(F*B-z*P)/q;return J>=0&&J<=1&&X>=0&&X<=1&&(n&&(n[0]=o+J*(h-o),n[1]=c+J*(m-c)),!0)}function Kme(e){switch(e){case"esriGeometryEnvelope":case"extent":return Bme;case"esriGeometryMultipoint":case"multipoint":return Ume;case"esriGeometryPoint":case"point":return Gme;case"esriGeometryPolygon":case"polygon":return Hme;case"esriGeometryPolyline":case"polyline":return Jme}}var dl;function Yme(e){return e&&(e.declaredClass==="esri.geometry.SpatialReference"||e.wkid!=null)}function hd(e,t,i){return t==null?i:i==null?t:e(t,i)}let Qn=dl=class extends cd{constructor(...e){super(...e),this.type="extent",this.xmin=0,this.ymin=0,this.mmin=void 0,this.zmin=void 0,this.xmax=0,this.ymax=0,this.mmax=void 0,this.zmax=void 0}normalizeCtorArgs(e,t,i,r,n){return Yme(e)?{spatialReference:e,xmin:0,ymin:0,xmax:0,ymax:0}:typeof e=="object"?(e.spatialReference=e.spatialReference==null?Mt.WGS84:e.spatialReference,e):{xmin:e,ymin:t,xmax:i,ymax:r,spatialReference:n!=null?n:Mt.WGS84}}static fromBounds(e,t){return new dl({xmin:e[0],ymin:e[1],xmax:e[2],ymax:e[3],spatialReference:t})}static fromPoint(e){return new dl({xmin:e.x,ymin:e.y,zmin:e.z,xmax:e.x,ymax:e.y,zmax:e.z,spatialReference:e.spatialReference})}get cache(){return this.commitProperty("xmin"),this.commitProperty("ymin"),this.commitProperty("zmin"),this.commitProperty("mmin"),this.commitProperty("xmax"),this.commitProperty("ymax"),this.commitProperty("zmax"),this.commitProperty("mmax"),this.commitProperty("spatialReference"),{}}get center(){const e=new pt({x:.5*(this.xmin+this.xmax),y:.5*(this.ymin+this.ymax),spatialReference:this.spatialReference});return this.hasZ&&(e.z=.5*(this.zmin+this.zmax)),this.hasM&&(e.m=.5*(this.mmin+this.mmax)),e}get extent(){return this.clone()}get hasM(){return this.mmin!=null&&this.mmax!=null}get hasZ(){return this.zmin!=null&&this.zmax!=null}get height(){return Math.abs(this.ymax-this.ymin)}get width(){return Math.abs(this.xmax-this.xmin)}centerAt(e){const t=this.center;return e.z!=null&&this.hasZ?this.offset(e.x-t.x,e.y-t.y,e.z-t.z):this.offset(e.x-t.x,e.y-t.y)}clone(){const e=new dl;return e.xmin=this.xmin,e.ymin=this.ymin,e.xmax=this.xmax,e.ymax=this.ymax,e.spatialReference=this.spatialReference,this.zmin!=null&&(e.zmin=this.zmin,e.zmax=this.zmax),this.mmin!=null&&(e.mmin=this.mmin,e.mmax=this.mmax),e}contains(e){if(!e)return!1;const t=this.spatialReference,i=e.spatialReference;return t&&i&&!t.equals(i)&&og(t,i)&&(e=t.isWebMercator?tu(e):v0(e,!0)),e.type==="point"?RS(this,e):e.type==="extent"&&Dme(this,e)}equals(e){if(this===e)return!0;if(ce(e))return!1;const t=this.spatialReference,i=e.spatialReference;return t&&i&&!t.equals(i)&&og(t,i)&&(e=t.isWebMercator?tu(e):v0(e,!0)),this.xmin===e.xmin&&this.ymin===e.ymin&&this.zmin===e.zmin&&this.mmin===e.mmin&&this.xmax===e.xmax&&this.ymax===e.ymax&&this.zmax===e.zmax&&this.mmax===e.mmax}expand(e){const t=.5*(1-e),i=this.width*t,r=this.height*t;if(this.xmin+=i,this.ymin+=r,this.xmax-=i,this.ymax-=r,this.hasZ){const n=(this.zmax-this.zmin)*t;this.zmin+=n,this.zmax-=n}if(this.hasM){const n=(this.mmax-this.mmin)*t;this.mmin+=n,this.mmax-=n}return this}intersects(e){if(ce(e))return!1;e.type==="mesh"&&(e=e.extent);const t=this.spatialReference,i=e.spatialReference;return t&&i&&!hr(t,i)&&og(t,i)&&(e=t.isWebMercator?tu(e):v0(e,!0)),Kme(e.type)(this,e)}normalize(){const e=this._normalize(!1,!0);return Array.isArray(e)?e:[e]}offset(e,t,i){return this.xmin+=e,this.ymin+=t,this.xmax+=e,this.ymax+=t,i!=null&&(this.zmin+=i,this.zmax+=i),this}shiftCentralMeridian(){return this._normalize(!0)}union(e){return this===e||(this.xmin=Math.min(this.xmin,e.xmin),this.ymin=Math.min(this.ymin,e.ymin),this.xmax=Math.max(this.xmax,e.xmax),this.ymax=Math.max(this.ymax,e.ymax),(this.hasZ||e.hasZ)&&(this.zmin=hd(Math.min,this.zmin,e.zmin),this.zmax=hd(Math.max,this.zmax,e.zmax)),(this.hasM||e.hasM)&&(this.mmin=hd(Math.min,this.mmin,e.mmin),this.mmax=hd(Math.max,this.mmax,e.mmax))),this}intersection(e){return this===e?this:ce(e)||!this.intersects(e)?null:(this.xmin=Math.max(this.xmin,e.xmin),this.ymin=Math.max(this.ymin,e.ymin),this.xmax=Math.min(this.xmax,e.xmax),this.ymax=Math.min(this.ymax,e.ymax),(this.hasZ||e.hasZ)&&(this.zmin=hd(Math.max,this.zmin,e.zmin),this.zmax=hd(Math.min,this.zmax,e.zmax)),(this.hasM||e.hasM)&&(this.mmin=hd(Math.max,this.mmin,e.mmin),this.mmax=hd(Math.min,this.mmax,e.mmax)),this)}toJSON(e){return this.write({},e)}_shiftCM(e=Wo(this.spatialReference)){var r;if(!e||!this.spatialReference)return this;const t=this.spatialReference,i=this._getCM(e);if(i){const n=t.isWebMercator?v0(i):i;this.xmin-=i.x,this.xmax-=i.x,t.isWebMercator||(n.x=this._normalizeX(n.x,e).x),this.spatialReference=new Mt(Kc((r=t.isWGS84?e.altTemplate:null)!=null?r:e.wkTemplate,{Central_Meridian:n.x}))}return this}_getCM(e){let t=null;const[i,r]=e.valid,n=this.xmin,o=this.xmax;return n>=i&&n<=r&&o>=i&&o<=r||(t=this.center),t}_normalize(e,t,i){const r=this.spatialReference;if(!r)return this;const n=i!=null?i:Wo(r);if(n==null)return this;const o=this._getParts(n).map(m=>m.extent);if(o.length<2)return o[0]||this;if(o.length>2)return e?this._shiftCM(n):this.set({xmin:n.valid[0],xmax:n.valid[1]});if(e)return this._shiftCM(n);if(t)return o;let c=!0,h=!0;return o.forEach(m=>{m.hasZ||(c=!1),m.hasM||(h=!1)}),{rings:o.map(m=>{const b=[[m.xmin,m.ymin],[m.xmin,m.ymax],[m.xmax,m.ymax],[m.xmax,m.ymin],[m.xmin,m.ymin]];if(c){const x=(m.zmax-m.zmin)/2;for(let I=0;I<b.length;I++)b[I].push(x)}if(h){const x=(m.mmax-m.mmin)/2;for(let I=0;I<b.length;I++)b[I].push(x)}return b}),hasZ:c,hasM:h,spatialReference:r}}_getParts(e){let t=this.cache._parts;if(!t){t=[];const{ymin:n,ymax:o,spatialReference:c}=this,h=this.width,m=this.xmin,b=this.xmax;let x;e=e||Wo(c);const[I,E]=e.valid;x=this._normalizeX(this.xmin,e);const k=x.x,P=x.frameId;x=this._normalizeX(this.xmax,e);const F=x.x,N=x.frameId,B=k===F&&h>0;if(h>2*E){const z=new dl(m<b?k:F,n,E,o,c),q=new dl(I,n,m<b?F:k,o,c),J=new dl(0,n,E,o,c),X=new dl(I,n,0,o,c),Y=[],ae=[];z.contains(J)&&Y.push(P),z.contains(X)&&ae.push(P),q.contains(J)&&Y.push(N),q.contains(X)&&ae.push(N);for(let he=P+1;he<N;he++)Y.push(he),ae.push(he);t.push({extent:z,frameIds:[P]},{extent:q,frameIds:[N]},{extent:J,frameIds:Y},{extent:X,frameIds:ae})}else k>F||B?t.push({extent:new dl(k,n,E,o,c),frameIds:[P]},{extent:new dl(I,n,F,o,c),frameIds:[N]}):t.push({extent:new dl(k,n,F,o,c),frameIds:[P]});this.cache._parts=t}const i=this.hasZ,r=this.hasM;if(i||r){const n={};i&&(n.zmin=this.zmin,n.zmax=this.zmax),r&&(n.mmin=this.mmin,n.mmax=this.mmax);for(let o=0;o<t.length;o++)t[o].extent.set(n)}return t}_normalizeX(e,t){const[i,r]=t.valid,n=2*r;let o,c=0;return e>r?(o=Math.ceil(Math.abs(e-r)/n),e-=o*n,c=o):e<i&&(o=Math.ceil(Math.abs(e-i)/n),e+=o*n,c=-o),{x:e,frameId:c}}};g([w({readOnly:!0})],Qn.prototype,"cache",null),g([w({readOnly:!0})],Qn.prototype,"center",null),g([w({readOnly:!0})],Qn.prototype,"extent",null),g([w({readOnly:!0,json:{write:{enabled:!1,overridePolicy:null}}})],Qn.prototype,"hasM",null),g([w({readOnly:!0,json:{write:{enabled:!1,overridePolicy:null}}})],Qn.prototype,"hasZ",null),g([w({readOnly:!0})],Qn.prototype,"height",null),g([w({readOnly:!0})],Qn.prototype,"width",null),g([w({type:Number,json:{type:[Number,String],write:{enabled:!0,allowNull:!0}}})],Qn.prototype,"xmin",void 0),g([w({type:Number,json:{write:!0}})],Qn.prototype,"ymin",void 0),g([w({type:Number,json:{origins:{"web-scene":{write:!1}},write:{overridePolicy(){return{enabled:this.hasM}}}}})],Qn.prototype,"mmin",void 0),g([w({type:Number,json:{origins:{"web-scene":{write:!1}},write:{overridePolicy(){return{enabled:this.hasZ}}}}})],Qn.prototype,"zmin",void 0),g([w({type:Number,json:{write:!0}})],Qn.prototype,"xmax",void 0),g([w({type:Number,json:{write:!0}})],Qn.prototype,"ymax",void 0),g([w({type:Number,json:{origins:{"web-scene":{write:!1}},write:{overridePolicy(){return{enabled:this.hasM}}}}})],Qn.prototype,"mmax",void 0),g([w({type:Number,json:{origins:{"web-scene":{write:!1}},write:{overridePolicy(){return{enabled:this.hasZ}}}}})],Qn.prototype,"zmax",void 0),Qn=dl=g([te("esri.geometry.Extent")],Qn),Qn.prototype.toJSON.isDefaultToJSON=!0;const gi=Qn;function cg(e,t,i=!1){let{hasM:r,hasZ:n}=e;Array.isArray(t)?t.length!==4||r||n?t.length===3&&i&&!r?(n=!0,r=!1):t.length===3&&r&&n&&(r=!1,n=!1):(r=!0,n=!0):(n=!n&&t.hasZ&&(!r||t.hasM),r=!r&&t.hasM&&(!n||t.hasZ)),e.hasZ=n,e.hasM=r}var TT;function cz(e){return(t,i)=>t==null?i:i==null?t:e(t,i)}function Xme(e){return e&&(e.declaredClass==="esri.geometry.SpatialReference"||e.wkid!=null)}let pd=TT=class extends cd{constructor(...e){super(...e),this.points=[],this.type="multipoint"}normalizeCtorArgs(e,t){if(!e&&!t)return{};const i={};Array.isArray(e)?(i.points=e,i.spatialReference=t):Xme(e)?i.spatialReference=e:(e.points&&(i.points=e.points),e.spatialReference&&(i.spatialReference=e.spatialReference),e.hasZ&&(i.hasZ=e.hasZ),e.hasM&&(i.hasM=e.hasM));const r=i.points&&i.points[0];return r&&(i.hasZ===void 0&&i.hasM===void 0?(i.hasZ=r.length>2,i.hasM=!1):i.hasZ===void 0?i.hasZ=r.length>3:i.hasM===void 0&&(i.hasM=r.length>3)),i}get cache(){return this.commitProperty("points"),this.commitProperty("hasZ"),this.commitProperty("hasM"),this.commitProperty("spatialReference"),{}}get extent(){const e=this.points;if(!e.length)return null;const t=new gi,i=this.hasZ,r=this.hasM,n=i?3:2,o=e[0],c=cz(Math.min),h=cz(Math.max);let m,b,x,I,[E,k]=o,[P,F]=o;for(let N=0,B=e.length;N<B;N++){const z=e[N],[q,J]=z;if(E=c(E,q),k=c(k,J),P=h(P,q),F=h(F,J),i&&z.length>2){const X=z[2];m=c(m,X),x=h(x,X)}if(r&&z.length>n){const X=z[n];b=c(b,X),I=h(I,X)}}return t.xmin=E,t.ymin=k,t.xmax=P,t.ymax=F,t.spatialReference=this.spatialReference,i?(t.zmin=m,t.zmax=x):(t.zmin=void 0,t.zmax=void 0),r?(t.mmin=b,t.mmax=I):(t.mmin=void 0,t.mmax=void 0),t}writePoints(e,t){t.points=_e(this.points)}addPoint(e){return cg(this,e),Array.isArray(e)?this.points.push(e):this.points.push(e.toArray()),this.notifyChange("points"),this}clone(){const e={points:_e(this.points),spatialReference:this.spatialReference};return this.hasZ&&(e.hasZ=!0),this.hasM&&(e.hasM=!0),new TT(e)}getPoint(e){if(!this._validateInputs(e))return null;const t=this.points[e],i={x:t[0],y:t[1],spatialReference:this.spatialReference};let r=2;return this.hasZ&&(i.z=t[2],r=3),this.hasM&&(i.m=t[r]),new pt(i)}removePoint(e){if(!this._validateInputs(e))return null;const t=new pt(this.points.splice(e,1)[0],this.spatialReference);return this.notifyChange("points"),t}setPoint(e,t){return this._validateInputs(e)?(cg(this,t),Array.isArray(t)||(t=t.toArray()),this.points[e]=t,this.notifyChange("points"),this):this}toJSON(e){return this.write({},e)}_validateInputs(e){return e!=null&&e>=0&&e<this.points.length}};g([w({readOnly:!0})],pd.prototype,"cache",null),g([w()],pd.prototype,"extent",null),g([w({type:[[Number]],json:{write:{isRequired:!0}}})],pd.prototype,"points",void 0),g([tt("points")],pd.prototype,"writePoints",null),pd=TT=g([te("esri.geometry.Multipoint")],pd),pd.prototype.toJSON.isDefaultToJSON=!0;const bw=pd;function ug(e){if(!e)return null;if(Array.isArray(e))return e;const t=e.hasZ,i=e.hasM;if(e.type==="point")return i&&t?[e.x,e.y,e.z,e.m]:t?[e.x,e.y,e.z]:i?[e.x,e.y,e.m]:[e.x,e.y];if(e.type==="polygon")return e.rings.slice(0);if(e.type==="polyline")return e.paths.slice(0);if(e.type==="multipoint")return e.points.slice(0);if(e.type==="extent"){const r=e.clone().normalize();if(!r)return null;let n=!1,o=!1;return r.forEach(c=>{c.hasZ&&(n=!0),c.hasM&&(o=!0)}),r.map(c=>{const h=[[c.xmin,c.ymin],[c.xmin,c.ymax],[c.xmax,c.ymax],[c.xmax,c.ymin],[c.xmin,c.ymin]];if(n&&c.hasZ){const m=.5*(c.zmax-c.zmin);for(let b=0;b<h.length;b++)h[b].push(m)}if(o&&c.hasM){const m=.5*(c.mmax-c.mmin);for(let b=0;b<h.length;b++)h[b].push(m)}return h})}return null}function CT(e,t){const i=t[0]-e[0],r=t[1]-e[1];if(e.length>2&&t.length>2){const n=e[2]-t[2];return Math.sqrt(i*i+r*r+n*n)}return Math.sqrt(i*i+r*r)}function uz(e,t,i){const r=e[0]+i*(t[0]-e[0]),n=e[1]+i*(t[1]-e[1]);return e.length>2&&t.length>2?[r,n,e[2]+i*(t[2]-e[2])]:[r,n]}function Qme(e,t,i,r){const[n,o]=t,[c,h]=i[r],[m,b]=i[r+1],x=m-c,I=b-h,E=x*x+I*I,k=(n-c)*x+(o-h)*I,P=Math.min(1,Math.max(0,k/E));return e[0]=c+x*P,e[1]=h+I*P,e}function KHe(e,t,i){const r=i.rings;let n,o,c=!1,h=1/0;for(let m=0;m<r.length;m++){const b=r[m];for(let x=0,I=b.length-1;x<b.length;I=x++)n=b[x],o=b[I],n[1]>t!=o[1]>t&&e<(o[0]-n[0])*(t-n[1])/(o[1]-n[1])+n[0]&&(c=!c),h=Math.min(h,ege(e,t,n,o))}return h===0?0:(c?1:-1)*Math.sqrt(h)}function ege(e,t,i,r){let n=i[0],o=i[1],c=r[0]-n,h=r[1]-o;if(c!==0||h!==0){const m=((e-n)*c+(t-o)*h)/(c*c+h*h);m>1?(n=r[0],o=r[1]):m>0&&(n+=c*m,o+=h*m)}return c=e-n,h=t-o,c*c+h*h}function tge(e,t){return uz(e,t,.5)}function YHe(e){const t=e.length;let i=0;for(let r=0;r<t-1;++r)i+=CT(e[r],e[r+1]);return i}function XHe(e,t){if(t<=0)return e[0];const i=e.length;let r=0;for(let n=0;n<i-1;++n){const o=CT(e[n],e[n+1]);if(t-r<o){const c=(t-r)/o;return uz(e[n],e[n+1],c)}r+=o}return e[i-1]}function hz(e,t,i){const r=e.length;let n=0,o=0,c=0;for(let h=0;h<r;h++){const m=e[h],b=e[(h+1)%r];let x=2;n+=m[0]*b[1]-b[0]*m[1],m.length>2&&b.length>2&&i&&(o+=m[0]*b[2]-b[0]*m[2],x=3),m.length>x&&b.length>x&&t&&(c+=m[0]*b[x]-b[0]*m[x])}return n<=0&&o<=0&&c<=0}function ige(e){const t=e.length;return t>2&&sd(e[0],e[t-1])}function QHe(e){var t,i;if("rings"in e&&(rge(e),e.rings.length>0&&!hz(e.rings[0],(t=e.hasM)!=null?t:!1,(i=e.hasZ)!=null?i:!1)))for(const r of e.rings)r.reverse()}function rge(e){if("rings"in e)for(const t of e.rings)ige(t)||t.push(t[0].slice())}function eWe(e){return e.type!=="polygon"&&e.type!=="polyline"||nge(e.type==="polygon"?e.rings:e.paths,e.spatialReference),e}function nge(e,t){const i=Wo(t);if(!i)return;const r=i.valid[0],n=i.valid[1],o=n-r;for(const c of e){let h=1/0,m=-1/0;for(const x of c){const I=sge(x[0],r,n);h=Math.min(h,I),m=Math.max(m,I),x[0]=I}const b=m-h;o-b<b&&c.forEach(x=>{x[0]<0&&(x[0]+=o)})}}function sge(e,t,i){const r=i-t;return e<t?i-(t-e)%r:e>i?t+(e-t)%r:e}function pz(e){if(!e||e.length<3)return 0;let t=0;const i=e.length-1;for(let r=0;r<i;r++)t+=(e[r][0]-e[r+1][0])*(e[r][1]+e[r+1][1]);return t+=(e[i][0]-e[0][0])*(e[i][1]+e[0][1]),-.5*t}function oge(e){return e?e.hasZ?[e.xmax-e.xmin/2,e.ymax-e.ymin/2,e.zmax-e.zmin/2]:[e.xmax-e.xmin/2,e.ymax-e.ymin/2]:null}function dz(e){var t;return e?fz(e.rings,(t=e.hasZ)!=null?t:!1):null}function fz(e,t){if(!e||!e.length)return null;const i=[],r=[],n=t?[1/0,-1/0,1/0,-1/0,1/0,-1/0]:[1/0,-1/0,1/0,-1/0];for(let o=0,c=e.length;o<c;o++){const h=age(e[o],t,n);h&&r.push(h)}if(r.sort((o,c)=>{let h=o[2]-c[2];return h===0&&t&&(h=o[4]-c[4]),h}),r.length&&(i[0]=r[0][0],i[1]=r[0][1],t&&(i[2]=r[0][3]),(i[0]<n[0]||i[0]>n[1]||i[1]<n[2]||i[1]>n[3]||t&&(i[2]<n[4]||i[2]>n[5]))&&(i.length=0)),!i.length){const o=e[0]&&e[0].length?lge(e[0],t):null;if(!o)return null;i[0]=o[0],i[1]=o[1],t&&o.length>2&&(i[2]=o[2])}return i}function age(e,t,i){let r=0,n=0,o=0,c=0,h=0;const m=e.length?e[0][0]:0,b=e.length?e[0][1]:0,x=e.length&&t?e[0][2]:0;for(let E=0;E<e.length;E++){const k=e[E],P=e[(E+1)%e.length],[F,N,B]=k,z=F-m,q=N-b,[J,X,Y]=P,ae=J-m,he=X-b,fe=z*he-ae*q;if(c+=fe,r+=(z+ae)*fe,n+=(q+he)*fe,t&&k.length>2&&P.length>2){const ye=B-x,xe=Y-x,Se=z*xe-ae*ye;o+=(ye+xe)*Se,h+=Se}F<i[0]&&(i[0]=F),F>i[1]&&(i[1]=F),N<i[2]&&(i[2]=N),N>i[3]&&(i[3]=N),t&&(B<i[4]&&(i[4]=B),B>i[5]&&(i[5]=B))}if(c>0&&(c*=-1),h>0&&(h*=-1),!c)return null;c*=.5,h*=.5;const I=[r/(6*c)+m,n/(6*c)+b,c];return t&&(i[4]===i[5]||h===0?(I[3]=(i[4]+i[5])/2,I[4]=0):(I[3]=o/(6*h)+x,I[4]=h)),I}function lge(e,t){const i=t?[0,0,0]:[0,0],r=t?[0,0,0]:[0,0];let n=0,o=0,c=0,h=0;for(let m=0,b=e.length;m<b-1;m++){const x=e[m],I=e[m+1];if(x&&I){i[0]=x[0],i[1]=x[1],r[0]=I[0],r[1]=I[1],t&&x.length>2&&I.length>2&&(i[2]=x[2],r[2]=I[2]);const E=CT(i,r);if(E){n+=E;const k=tge(x,I);o+=E*k[0],c+=E*k[1],t&&k.length>2&&(h+=E*k[2])}}}return n>0?t?[o/n,c/n,h/n]:[o/n,c/n]:e.length?e[0]:null}const cge=1e-6;function tWe(e){if(!e||!e.rings)return null;const{rings:t}=e;let i=0;for(let o=0;o<t.length;o++)i+=pz(t[o]);if(i<cge)return fz(t,!1);const r=[0,0],n=t[0][0];for(let o=0;o<t.length;o++)hge(r,n,t[o]);return r[0]*=1/i,r[1]*=1/i,r[0]+=n[0],r[1]+=n[1],r}const uge=1/3;function hge(e,t,i){if(!e||!i||i.length<3)return null;const r=i[0],n=[0,0],o=[i[1][0]-r[0],i[1][1]-r[1]];let c;for(let b=2;b<i.length;b++)n[0]=i[b][0]-r[0],n[1]=i[b][1]-r[1],c=.5*uge*(n[0]*o[1]-n[1]*o[0]),e[0]+=c*(o[0]+n[0]),e[1]+=c*(o[1]+n[1]),o[0]=n[0],o[1]=n[1];const h=pz(i),m=[r[0],r[1]];return m[0]-=t[0],m[1]-=t[1],m[0]*=h,m[1]*=h,e[0]+=m[0],e[1]+=m[1],e}function yz(e){return e.xmin!==void 0&&e.ymin!==void 0&&e.xmax!==void 0&&e.ymax!==void 0}function mz(e){return e.points!==void 0}function gz(e){return e.x!==void 0&&e.y!==void 0}function vz(e){return e.paths!==void 0}function bz(e){return e.rings!==void 0}function wz(e){function t(i,r){return i==null?r:r==null?i:e(i,r)}return t}const dd=wz(Math.min),fd=wz(Math.max);function iWe(e,t){return vz(t)?yd(e,t.paths,!1,!1):bz(t)?yd(e,t.rings,!1,!1):mz(t)?kT(e,t.points,!1,!1,!1,!1):yz(t)?_z(e,t):(gz(t)&&(e[0]=t.x,e[1]=t.y,e[2]=t.x,e[3]=t.y),e)}function rWe(e,t){return vz(t)?yd(e,t.paths,!0,!1):bz(t)?yd(e,t.rings,!0,!1):mz(t)?kT(e,t.points,!0,!1,!0,!1):yz(t)?_z(e,t,!0,!1,!0,!1):(gz(t)&&(e[0]=t.x,e[1]=t.y,e[2]=t.z,e[3]=t.x,e[4]=t.y,e[5]=t.z),e)}function yd(e,t,i,r){const n=i?3:2;if(!t.length||!t[0].length)return null;let o,c,h,m,[b,x]=t[0][0],[I,E]=t[0][0];for(let k=0;k<t.length;k++){const P=t[k];for(let F=0;F<P.length;F++){const N=P[F],[B,z]=N;if(b=dd(b,B),x=dd(x,z),I=fd(I,B),E=fd(E,z),i&&N.length>2){const q=N[2];o=dd(o,q),c=fd(c,q)}if(r&&N.length>n){const q=N[n];h=dd(o,q),m=fd(c,q)}}}return i?r?(e[0]=b,e[1]=x,e[2]=o,e[3]=h,e[4]=I,e[5]=E,e[6]=c,e[7]=m,e.length=8,e):(e[0]=b,e[1]=x,e[2]=o,e[3]=I,e[4]=E,e[5]=c,e.length=6,e):r?(e[0]=b,e[1]=x,e[2]=h,e[3]=I,e[4]=E,e[5]=m,e.length=6,e):(e[0]=b,e[1]=x,e[2]=I,e[3]=E,e.length=4,e)}function _z(e,t,i,r,n,o){const c=t.xmin,h=t.xmax,m=t.ymin,b=t.ymax;let x=t.zmin,I=t.zmax,E=t.mmin,k=t.mmax;return n?(x=x||0,I=I||0,o?(E=E||0,k=k||0,e[0]=c,e[1]=m,e[2]=x,e[3]=E,e[4]=h,e[5]=b,e[6]=I,e[7]=k,e):(e[0]=c,e[1]=m,e[2]=x,e[3]=h,e[4]=b,e[5]=I,e)):o?(E=E||0,k=k||0,e[0]=c,e[1]=m,e[2]=E,e[3]=h,e[4]=b,e[5]=k,e):(e[0]=c,e[1]=m,e[2]=h,e[3]=b,e)}function kT(e,t,i,r,n,o){const c=i?3:2,h=r&&o,m=i&&n;if(!t.length||!t[0].length)return null;let b,x,I,E,[k,P]=t[0],[F,N]=t[0];for(let B=0;B<t.length;B++){const z=t[B],[q,J]=z;if(k=dd(k,q),P=dd(P,J),F=fd(F,q),N=fd(N,J),m&&z.length>2){const X=z[2];b=dd(b,X),x=fd(x,X)}if(h&&z.length>c){const X=z[c];I=dd(b,X),E=fd(x,X)}}return n?(b=b||0,x=x||0,o?(I=I||0,E=E||0,e[0]=k,e[1]=P,e[2]=b,e[3]=I,e[4]=F,e[5]=N,e[6]=x,e[7]=E,e):(e[0]=k,e[1]=P,e[2]=b,e[3]=F,e[4]=N,e[5]=x,e)):o?(I=I||0,E=E||0,e[0]=k,e[1]=P,e[2]=I,e[3]=F,e[4]=N,e[5]=E,e):(e[0]=k,e[1]=P,e[2]=F,e[3]=N,e)}function pge(e){return e.xmin!==void 0&&e.ymin!==void 0&&e.xmax!==void 0&&e.ymax!==void 0}function dge(e){return e.points!==void 0}function fge(e){return e.x!==void 0&&e.y!==void 0}function yge(e){return e.paths!==void 0}function mge(e){return e.rings!==void 0}const AT=[];function xz(e,t,i,r){return{xmin:e,ymin:t,xmax:i,ymax:r}}function Sz(e,t,i,r,n,o){return{xmin:e,ymin:t,zmin:i,xmax:r,ymax:n,zmax:o}}function Mz(e,t,i,r,n,o){return{xmin:e,ymin:t,mmin:i,xmax:r,ymax:n,mmax:o}}function Iz(e,t,i,r,n,o,c,h){return{xmin:e,ymin:t,zmin:i,mmin:r,xmax:n,ymax:o,zmax:c,mmax:h}}function PT(e,t=!1,i=!1){return t?i?Iz(e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]):Sz(e[0],e[1],e[2],e[3],e[4],e[5]):i?Mz(e[0],e[1],e[2],e[3],e[4],e[5]):xz(e[0],e[1],e[2],e[3])}function LT(e){return e?pge(e)?e:fge(e)?vge(e):mge(e)?OT(e):yge(e)?$z(e):dge(e)?gge(e):null:null}function gge(e){const{hasZ:t,hasM:i,points:r}=e;return PT(kT(AT,r,t!=null?t:!1,i!=null?i:!1),t,i)}function vge(e){const{x:t,y:i,z:r,m:n}=e,o=n!=null;return r!=null?o?Iz(t,i,r,n,t,i,r,n):Sz(t,i,r,t,i,r):o?Mz(t,i,n,t,i,n):xz(t,i,t,i)}function OT(e){const{hasZ:t,hasM:i,rings:r}=e,n=yd(AT,r,t!=null?t:!1,i!=null?i:!1);return n?PT(n,t,i):null}function $z(e){const{hasZ:t,hasM:i,paths:r}=e,n=yd(AT,r,t!=null?t:!1,i!=null?i:!1);return n?PT(n,t,i):null}var FS;function Ez(e){return!Array.isArray(e[0])}let iu=FS=class extends cd{constructor(...e){super(...e),this.rings=[],this.type="polygon"}static fromExtent(e){const t=e.clone().normalize(),i=e.spatialReference;let r=!1,n=!1;for(const c of t)c.hasZ&&(r=!0),c.hasM&&(n=!0);const o={rings:t.map(c=>{const h=[[c.xmin,c.ymin],[c.xmin,c.ymax],[c.xmax,c.ymax],[c.xmax,c.ymin],[c.xmin,c.ymin]];if(r&&c.hasZ){const m=c.zmin+.5*(c.zmax-c.zmin);for(let b=0;b<h.length;b++)h[b].push(m)}if(n&&c.hasM){const m=c.mmin+.5*(c.mmax-c.mmin);for(let b=0;b<h.length;b++)h[b].push(m)}return h}),spatialReference:i};return r&&(o.hasZ=!0),n&&(o.hasM=!0),new FS(o)}normalizeCtorArgs(e,t){let i,r,n=null,o=null;return e&&!Array.isArray(e)?(n=e.rings?e.rings:null,t||(e.spatialReference?t=e.spatialReference:e.rings||(t=e)),i=e.hasZ,r=e.hasM):n=e,n=n||[],t=t||Mt.WGS84,n.length&&n[0]&&n[0][0]!=null&&typeof n[0][0]=="number"&&(n=[n]),o=n[0]&&n[0][0],o&&(i===void 0&&r===void 0?(i=o.length>2,r=o.length>3):i===void 0?i=r?o.length>3:o.length>2:r===void 0&&(r=i?o.length>3:o.length>2)),{rings:n,spatialReference:t,hasZ:i,hasM:r}}get cache(){return this.commitProperty("rings"),this.commitProperty("hasZ"),this.commitProperty("hasM"),this.commitProperty("spatialReference"),{}}get centroid(){const e=dz(this);if(!e||isNaN(e[0])||isNaN(e[1])||this.hasZ&&isNaN(e[2]))return null;const t=new pt;return t.x=e[0],t.y=e[1],t.spatialReference=this.spatialReference,this.hasZ&&(t.z=e[2]),t}get extent(){const{spatialReference:e}=this,t=OT(this);if(!t)return null;const i=new gi(t);return i.spatialReference=e,i}get isSelfIntersecting(){return Zme(this.rings)}writeRings(e,t){t.rings=_e(this.rings)}addRing(e){if(!e)return;const t=this.rings,i=t.length;if(Ez(e)){const r=[];for(let n=0,o=e.length;n<o;n++)r[n]=e[n].toArray();t[i]=r}else t[i]=e.concat();return this.notifyChange("rings"),this}clone(){const e=new FS;return e.spatialReference=this.spatialReference,e.rings=_e(this.rings),e.hasZ=this.hasZ,e.hasM=this.hasM,e}equals(e){if(this===e)return!0;if(ce(e))return!1;const t=this.spatialReference,i=e.spatialReference;if(H(t)!==H(i)||H(t)&&H(i)&&!t.equals(i)||this.rings.length!==e.rings.length)return!1;const r=([n,o,c,h],[m,b,x,I])=>n===m&&o===b&&(c==null&&x==null||c===x)&&(h==null&&I==null||h===I);for(let n=0;n<this.rings.length;n++){const o=this.rings[n],c=e.rings[n];if(!sd(o,c,r))return!1}return!0}contains(e){if(!e)return!1;const t=gw(e,this.spatialReference);return nz(this,H(t)?t:e)}isClockwise(e){let t;return t=Ez(e)?e.map(i=>this.hasZ?this.hasM?[i.x,i.y,i.z,i.m]:[i.x,i.y,i.z]:[i.x,i.y]):e,hz(t,this.hasM,this.hasZ)}getPoint(e,t){if(!this._validateInputs(e,t))return null;const i=this.rings[e][t],r=this.hasZ,n=this.hasM;return r&&!n?new pt(i[0],i[1],i[2],void 0,this.spatialReference):n&&!r?new pt(i[0],i[1],void 0,i[2],this.spatialReference):r&&n?new pt(i[0],i[1],i[2],i[3],this.spatialReference):new pt(i[0],i[1],this.spatialReference)}insertPoint(e,t,i){return this._validateInputs(e,t,!0)?(cg(this,i),Array.isArray(i)||(i=i.toArray()),this.rings[e].splice(t,0,i),this.notifyChange("rings"),this):this}removePoint(e,t){if(!this._validateInputs(e,t))return null;const i=new pt(this.rings[e].splice(t,1)[0],this.spatialReference);return this.notifyChange("rings"),i}removeRing(e){if(!this._validateInputs(e,null))return null;const t=this.rings.splice(e,1)[0],i=this.spatialReference,r=t.map(n=>new pt(n,i));return this.notifyChange("rings"),r}setPoint(e,t,i){return this._validateInputs(e,t)?(cg(this,i),Array.isArray(i)||(i=i.toArray()),this.rings[e][t]=i,this.notifyChange("rings"),this):this}_validateInputs(e,t,i=!1){if(e==null||e<0||e>=this.rings.length)return!1;if(t!=null){const r=this.rings[e];if(i&&(t<0||t>r.length)||!i&&(t<0||t>=r.length))return!1}return!0}toJSON(e){return this.write({},e)}};g([w({readOnly:!0})],iu.prototype,"cache",null),g([w({readOnly:!0})],iu.prototype,"centroid",null),g([w({readOnly:!0})],iu.prototype,"extent",null),g([w({readOnly:!0})],iu.prototype,"isSelfIntersecting",null),g([w({type:[[[Number]]],json:{write:{isRequired:!0}}})],iu.prototype,"rings",void 0),g([tt("rings")],iu.prototype,"writeRings",null),iu=FS=g([te("esri.geometry.Polygon")],iu),iu.prototype.toJSON.isDefaultToJSON=!0;const es=iu;var RT;function bge(e){return!Array.isArray(e[0])}let md=RT=class extends cd{constructor(...e){super(...e),this.paths=[],this.type="polyline"}normalizeCtorArgs(e,t){let i,r,n=null,o=null;return e&&!Array.isArray(e)?(n=e.paths?e.paths:null,t||(e.spatialReference?t=e.spatialReference:e.paths||(t=e)),i=e.hasZ,r=e.hasM):n=e,n=n||[],t=t||Mt.WGS84,n.length&&n[0]&&n[0][0]!=null&&typeof n[0][0]=="number"&&(n=[n]),o=n[0]&&n[0][0],o&&(i===void 0&&r===void 0?(i=o.length>2,r=!1):i===void 0?i=!r&&o.length>3:r===void 0&&(r=!i&&o.length>3)),{paths:n,spatialReference:t,hasZ:i,hasM:r}}get cache(){return this.commitProperty("paths"),this.commitProperty("hasZ"),this.commitProperty("hasM"),this.commitProperty("spatialReference"),{}}get extent(){const{spatialReference:e}=this,t=$z(this);if(!t)return null;const i=new gi(t);return i.spatialReference=e,i}writePaths(e,t){t.paths=_e(this.paths)}addPath(e){if(!e)return;const t=this.paths,i=t.length;if(bge(e)){const r=[];for(let n=0,o=e.length;n<o;n++)r[n]=e[n].toArray();t[i]=r}else t[i]=e.concat();return this.notifyChange("paths"),this}clone(){const e=new RT;return e.spatialReference=this.spatialReference,e.paths=_e(this.paths),e.hasZ=this.hasZ,e.hasM=this.hasM,e}getPoint(e,t){if(!this._validateInputs(e,t))return null;const i=this.paths[e][t],r=this.hasZ,n=this.hasM;return r&&!n?new pt(i[0],i[1],i[2],void 0,this.spatialReference):n&&!r?new pt(i[0],i[1],void 0,i[2],this.spatialReference):r&&n?new pt(i[0],i[1],i[2],i[3],this.spatialReference):new pt(i[0],i[1],this.spatialReference)}insertPoint(e,t,i){return this._validateInputs(e,t,!0)?(cg(this,i),Array.isArray(i)||(i=i.toArray()),this.paths[e].splice(t,0,i),this.notifyChange("paths"),this):this}removePath(e){if(!this._validateInputs(e,null))return null;const t=this.paths.splice(e,1)[0],i=this.spatialReference,r=t.map(n=>new pt(n,i));return this.notifyChange("paths"),r}removePoint(e,t){if(!this._validateInputs(e,t))return null;const i=new pt(this.paths[e].splice(t,1)[0],this.spatialReference);return this.notifyChange("paths"),i}setPoint(e,t,i){return this._validateInputs(e,t)?(cg(this,i),Array.isArray(i)||(i=i.toArray()),this.paths[e][t]=i,this.notifyChange("paths"),this):this}_validateInputs(e,t,i=!1){if(e==null||e<0||e>=this.paths.length)return!1;if(t!=null){const r=this.paths[e];if(i&&(t<0||t>r.length)||!i&&(t<0||t>=r.length))return!1}return!0}toJSON(e){return this.write({},e)}};g([w({readOnly:!0})],md.prototype,"cache",null),g([w({readOnly:!0})],md.prototype,"extent",null),g([w({type:[[[Number]]],json:{write:{isRequired:!0}}})],md.prototype,"paths",void 0),g([tt("paths")],md.prototype,"writePaths",null),md=RT=g([te("esri.geometry.Polyline")],md),md.prototype.toJSON.isDefaultToJSON=!0;const Fn=md;class kt{constructor(t,i={ignoreUnknown:!1,useNumericKeys:!1}){this._jsonToAPI=t,this._options=i,this.apiValues=[],this.jsonValues=[],this._apiToJSON=this._invertMap(t),this.apiValues=this._getKeysSorted(this._apiToJSON),this.jsonValues=this._getKeysSorted(this._jsonToAPI),this.read=r=>this.fromJSON(r),this.write=(r,n,o)=>{const c=this.toJSON(r);c!==void 0&&eo(o,c,n)},this.write.isJSONMapWriter=!0}toJSON(t){if(this._apiToJSON.hasOwnProperty(t)){const i=this._apiToJSON[t];return this._options.useNumericKeys?+i:i}return this._options.ignoreUnknown?void 0:t}fromJSON(t){return this._jsonToAPI.hasOwnProperty(t)?this._jsonToAPI[t]:this._options.ignoreUnknown?void 0:t}_invertMap(t){const i={};for(const r in t)i[t[r]]=r;return i}_getKeysSorted(t){const i=[];for(const r in t)i.push(r);return i.sort(),i}}function Ns(){return function(e,t){return new kt(e,K({ignoreUnknown:!0},t))}}const NS=Ns()({esriGeometryPoint:"point",esriGeometryMultipoint:"multipoint",esriGeometryPolyline:"polyline",esriGeometryPolygon:"polygon"}),DS=Ns()({esriGeometryPoint:"point",esriGeometryMultipoint:"multipoint",esriGeometryPolyline:"polyline",esriGeometryPolygon:"polygon",esriGeometryEnvelope:"extent",mesh:"mesh"});function ww(e){return e.xmin!==void 0&&e.ymin!==void 0&&e.xmax!==void 0&&e.ymax!==void 0}function jS(e){return e.points!==void 0}function VS(e){return e.x!==void 0&&e.y!==void 0}function _w(e){return e.paths!==void 0}function vh(e){return e.rings!==void 0}function xs(e){return ce(e)?null:e instanceof cd?e:VS(e)?pt.fromJSON(e):_w(e)?Fn.fromJSON(e):vh(e)?es.fromJSON(e):jS(e)?bw.fromJSON(e):ww(e)?gi.fromJSON(e):null}function bh(e){return e?VS(e)?"esriGeometryPoint":_w(e)?"esriGeometryPolyline":vh(e)?"esriGeometryPolygon":ww(e)?"esriGeometryEnvelope":jS(e)?"esriGeometryMultipoint":null:null}const wge={esriGeometryPoint:pt,esriGeometryPolyline:Fn,esriGeometryPolygon:es,esriGeometryEnvelope:gi,esriGeometryMultipoint:bw};function _ge(e){return e&&wge[e]||null}const wh={base:cd,key:"type",typeMap:{extent:gi,multipoint:bw,point:pt,polyline:Fn,polygon:es}};Yc(wh);const rn=e=>{let t=class extends e{clone(){var m;const i=Yn(Rn(this),"unable to clone instance of non-accessor class"),r=i.metadatas,n=i.store,o={},c=new Map;for(const b in r){const x=r[b],I=n==null?void 0:n.originOf(b),E=x.clonable;if(x.readOnly||E===!1||I!==ct.USER&&I!==ct.DEFAULTS&&I!==ct.WEB_MAP&&I!==ct.WEB_SCENE)continue;const k=this[b];let P=null;P=typeof E=="function"?E(k):E==="reference"?k:BE(k),k!=null&&P==null||(I===ct.DEFAULTS?c.set(b,P):o[b]=P)}const h=new(Object.getPrototypeOf(this)).constructor(o);if(c.size){const b=(m=Rn(h))==null?void 0:m.store;if(b)for(const[x,I]of c)b.set(x,I,ct.DEFAULTS)}return h}};return t=g([te("esri.core.Clonable")],t),t};let Tz=class extends rn(Ye){};Tz=g([te("esri.core.Clonable")],Tz);class hg{constructor(){this._emitter=new hg.EventEmitter(this)}emit(t,i){return this._emitter.emit(t,i)}on(t,i){return this._emitter.on(t,i)}once(t,i){return this._emitter.once(t,i)}hasEventListener(t){return this._emitter.hasEventListener(t)}}(function(e){class t{constructor(n=null){this._target=n,this._listenersMap=null}clear(){this._listenersMap&&this._listenersMap.clear(),this._listenersMap=null}emit(n,o){const c=this._listenersMap&&this._listenersMap.get(n);if(!c)return!1;const h=this._target||this;return[...c].forEach(m=>{m.call(h,o)}),c.length>0}on(n,o){if(Array.isArray(n)){const h=n.map(m=>this.on(m,o));return od(h)}if(n.includes(","))throw new TypeError("Evented.on() with a comma delimited string of event types is not supported");this._listenersMap||(this._listenersMap=new Map);const c=this._listenersMap.get(n)||[];return c.push(o),this._listenersMap.set(n,c),{remove:()=>{const h=this._listenersMap&&this._listenersMap.get(n)||[],m=h.indexOf(o);m>=0&&h.splice(m,1)}}}once(n,o){const c=this.on(n,h=>{c.remove(),o.call(null,h)});return c}hasEventListener(n){const o=this._listenersMap&&this._listenersMap.get(n);return o!=null&&o.length>0}}e.EventEmitter=t,e.EventedMixin=r=>{let n=class extends r{constructor(){super(...arguments),this._emitter=new t}destroy(){this._emitter.clear()}emit(o,c){return this._emitter.emit(o,c)}on(o,c){return this._emitter.on(o,c)}once(o,c){return this._emitter.once(o,c)}hasEventListener(o){return this._emitter.hasEventListener(o)}};return n=g([te("esri.core.Evented")],n),n};let i=class extends Ye{constructor(){super(...arguments),this._emitter=new hg.EventEmitter(this)}destroy(){this._emitter.clear()}emit(r,n){return this._emitter.emit(r,n)}on(r,n){return this._emitter.on(r,n)}once(r,n){return this._emitter.once(r,n)}hasEventListener(r){return this._emitter.hasEventListener(r)}};i=g([te("esri.core.Evented")],i),e.EventedAccessor=i})(hg||(hg={}));const Or=hg;var qi;(function(e){e[e.ADD=1]="ADD",e[e.REMOVE=2]="REMOVE",e[e.MOVE=4]="MOVE"})(qi||(qi={}));function FT(e){return(t,i)=>{t[i]=e}}class NT{constructor(){this._observers=[]}observe(t){return this._observers.includes(t)||this._observers.push(t),new SV(this._observers,t)}notify(){const t=this._observers.slice();for(let i=0;i<t.length;++i){const r=t[i];r.onInvalidated(),r.onCommitted()}}}var _h;class xge{constructor(){this.target=null,this.cancellable=!1,this.defaultPrevented=!1,this.item=void 0,this.type=void 0}preventDefault(){this.cancellable&&(this.defaultPrevented=!0)}reset(t){this.defaultPrevented=!1,this.item=t}}const fl=new Ql(xge,void 0,e=>{e.item=null,e.target=null,e.defaultPrevented=!1,e.cancellable=!1}),Sge=()=>{};function DT(e){return e?e instanceof S0?e.toArray():e.length?Array.prototype.slice.apply(e):[]:[]}function jT(e){if(e&&e.length)return e[0]}function Mge(e,t,i,r){const n=Math.min(e.length-i,t.length-r);let o=0;for(;o<n&&e[i+o]===t[r+o];)o++;return o}function Cz(e,t,i,r){t&&t.forEach((n,o,c)=>{e.push(n),Cz(e,i.call(r,n,o,c),i,r)})}const gd=new Set,vd=new Set,bd=new Set,VT=new Map;let Ige=0,S0=_h=class extends Or.EventedAccessor{constructor(e){super(e),this._chgListeners=[],this._notifications=null,this._timer=null,this._observable=new NT,this.length=0,this._items=[],Object.defineProperty(this,"uid",{value:Ige++})}static isCollection(e){return e!=null&&e instanceof _h}normalizeCtorArgs(e){return e?Array.isArray(e)||e instanceof _h?{items:e}:e:{}}destroy(){this.removeAll()}*[Symbol.iterator](){yield*this.items}get items(){return ii(this._observable),this._items}set items(e){this._emitBeforeChanges(qi.ADD)||(this._splice(0,this.length,DT(e)),this._emitAfterChanges(qi.ADD))}hasEventListener(e){return e==="change"?this._chgListeners.length>0:this._emitter.hasEventListener(e)}on(e,t){if(e==="change"){const i=this._chgListeners,r={removed:!1,callback:t};return i.push(r),this._notifications&&this._notifications.push({listeners:i.slice(),items:this._items.slice(),changes:[]}),{remove(){this.remove=Sge,r.removed=!0,i.splice(i.indexOf(r),1)}}}return this._emitter.on(e,t)}once(e,t){const i=this.on(e,t);return{remove(){i.remove()}}}add(e,t){if(ii(this._observable),this._emitBeforeChanges(qi.ADD))return this;const i=this.getNextIndex(t!=null?t:null);return this._splice(i,0,[e]),this._emitAfterChanges(qi.ADD),this}addMany(e,t=this._items.length){if(ii(this._observable),!e||!e.length)return this;if(this._emitBeforeChanges(qi.ADD))return this;const i=this.getNextIndex(t);return this._splice(i,0,DT(e)),this._emitAfterChanges(qi.ADD),this}at(e){if(ii(this._observable),(e=Math.trunc(e)||0)<0&&(e+=this.length),!(e<0||e>=this.length))return this._items[e]}removeAll(){if(ii(this._observable),!this.length||this._emitBeforeChanges(qi.REMOVE))return[];const e=this._splice(0,this.length)||[];return this._emitAfterChanges(qi.REMOVE),e}clone(){return ii(this._observable),this._createNewInstance({items:this._items.map(_e)})}concat(...e){ii(this._observable);const t=e.map(DT);return this._createNewInstance({items:this._items.concat(...t)})}drain(e,t){if(ii(this._observable),!this.length||this._emitBeforeChanges(qi.REMOVE))return;const i=On(this._splice(0,this.length)),r=i.length;for(let n=0;n<r;n++)e.call(t,i[n],n,i);this._emitAfterChanges(qi.REMOVE)}every(e,t){return ii(this._observable),this._items.every(e,t)}filter(e,t){let i;return ii(this._observable),i=arguments.length===2?this._items.filter(e,t):this._items.filter(e),this._createNewInstance({items:i})}find(e,t){return ii(this._observable),this._items.find(e,t)}findIndex(e,t){return ii(this._observable),this._items.findIndex(e,t)}flatten(e,t){ii(this._observable);const i=[];return Cz(i,this,e,t),new _h(i)}forEach(e,t){return ii(this._observable),this._items.forEach(e,t)}getItemAt(e){return ii(this._observable),this._items[e]}getNextIndex(e){ii(this._observable);const t=this.length;return(e=e!=null?e:t)<0?e=0:e>t&&(e=t),e}includes(e,t=0){return ii(this._observable),this._items.includes(e,t)}indexOf(e,t=0){return ii(this._observable),this._items.indexOf(e,t)}join(e=","){return ii(this._observable),this._items.join(e)}lastIndexOf(e,t=this.length-1){return ii(this._observable),this._items.lastIndexOf(e,t)}map(e,t){ii(this._observable);const i=this._items.map(e,t);return new _h({items:i})}reorder(e,t=this.length-1){ii(this._observable);const i=this.indexOf(e);if(i!==-1){if(t<0?t=0:t>=this.length&&(t=this.length-1),i!==t){if(this._emitBeforeChanges(qi.MOVE))return e;this._splice(i,1),this._splice(t,0,[e]),this._emitAfterChanges(qi.MOVE)}return e}}pop(){if(ii(this._observable),!this.length||this._emitBeforeChanges(qi.REMOVE))return;const e=jT(this._splice(this.length-1,1));return this._emitAfterChanges(qi.REMOVE),e}push(...e){return ii(this._observable),this._emitBeforeChanges(qi.ADD)||(this._splice(this.length,0,e),this._emitAfterChanges(qi.ADD)),this.length}reduce(e,t){ii(this._observable);const i=this._items;return arguments.length===2?i.reduce(e,t):i.reduce(e)}reduceRight(e,t){ii(this._observable);const i=this._items;return arguments.length===2?i.reduceRight(e,t):i.reduceRight(e)}remove(e){return ii(this._observable),this.removeAt(this.indexOf(e))}removeAt(e){if(ii(this._observable),e<0||e>=this.length||this._emitBeforeChanges(qi.REMOVE))return;const t=jT(this._splice(e,1));return this._emitAfterChanges(qi.REMOVE),t}removeMany(e){if(ii(this._observable),!e||!e.length||this._emitBeforeChanges(qi.REMOVE))return[];const t=e instanceof _h?e.toArray():e,i=this._items,r=[],n=t.length;for(let o=0;o<n;o++){const c=t[o],h=i.indexOf(c);if(h>-1){const m=1+Mge(t,i,o+1,h+1),b=this._splice(h,m);b&&b.length>0&&r.push.apply(r,b),o+=m-1}}return this._emitAfterChanges(qi.REMOVE),r}reverse(){if(ii(this._observable),this._emitBeforeChanges(qi.MOVE))return this;const e=this._splice(0,this.length);return e&&(e.reverse(),this._splice(0,0,e)),this._emitAfterChanges(qi.MOVE),this}shift(){if(ii(this._observable),!this.length||this._emitBeforeChanges(qi.REMOVE))return;const e=jT(this._splice(0,1));return this._emitAfterChanges(qi.REMOVE),e}slice(e=0,t=this.length){return ii(this._observable),this._createNewInstance({items:this._items.slice(e,t)})}some(e,t){return ii(this._observable),this._items.some(e,t)}sort(e){if(ii(this._observable),!this.length||this._emitBeforeChanges(qi.MOVE))return this;const t=On(this._splice(0,this.length));return arguments.length?t.sort(e):t.sort(),this._splice(0,0,t),this._emitAfterChanges(qi.MOVE),this}splice(e,t,...i){ii(this._observable);const r=(t?qi.REMOVE:0)|(i.length?qi.ADD:0);if(this._emitBeforeChanges(r))return[];const n=this._splice(e,t,i)||[];return this._emitAfterChanges(r),n}toArray(){return ii(this._observable),this._items.slice()}toJSON(){return ii(this._observable),this.toArray()}toLocaleString(){return ii(this._observable),this._items.toLocaleString()}toString(){return ii(this._observable),this._items.toString()}unshift(...e){return ii(this._observable),!e.length||this._emitBeforeChanges(qi.ADD)||(this._splice(0,0,e),this._emitAfterChanges(qi.ADD)),this.length}_createNewInstance(e){return new this.constructor(e)}_splice(e,t,i){const r=this._items,n=this.itemType;let o,c;if(!this._notifications&&this.hasEventListener("change")&&(this._notifications=[{listeners:this._chgListeners.slice(),items:this._items.slice(),changes:[]}],this._timer&&this._timer.remove(),this._timer=eg(()=>this._dispatchChange())),t){if(c=r.splice(e,t),this.hasEventListener("before-remove")){const h=fl.acquire();h.target=this,h.cancellable=!0;for(let m=0,b=c.length;m<b;m++)o=c[m],h.reset(o),this.emit("before-remove",h),h.defaultPrevented&&(c.splice(m,1),r.splice(e,0,o),e+=1,m-=1,b-=1);fl.release(h)}if(this.length=this._items.length,this.hasEventListener("after-remove")){const h=fl.acquire();h.target=this,h.cancellable=!1;const m=c.length;for(let b=0;b<m;b++)h.reset(c[b]),this.emit("after-remove",h);fl.release(h)}}if(i&&i.length){if(n){const x=[];for(const I of i){const E=n.ensureType(I);E==null&&I!=null||x.push(E)}i=x}const h=this.hasEventListener("before-add"),m=this.hasEventListener("after-add"),b=e===this.length;if(h||m){const x=fl.acquire();x.target=this,x.cancellable=!0;const I=fl.acquire();I.target=this,I.cancellable=!1;for(const E of i)h?(x.reset(E),this.emit("before-add",x),x.defaultPrevented||(b?r.push(E):r.splice(e++,0,E),this._set("length",r.length),m&&(I.reset(E),this.emit("after-add",I)))):(b?r.push(E):r.splice(e++,0,E),this._set("length",r.length),I.reset(E),this.emit("after-add",I));fl.release(I),fl.release(x)}else{if(b)for(const x of i)r.push(x);else r.splice(e,0,...i);this._set("length",r.length)}}return(i&&i.length||c&&c.length)&&this._notifyChangeEvent(i,c),c}_emitBeforeChanges(e){let t=!1;if(this.hasEventListener("before-changes")){const i=fl.acquire();i.target=this,i.cancellable=!0,i.type=e,this.emit("before-changes",i),t=i.defaultPrevented,fl.release(i)}return t}_emitAfterChanges(e){if(this.hasEventListener("after-changes")){const t=fl.acquire();t.target=this,t.cancellable=!1,t.type=e,this.emit("after-changes",t),fl.release(t)}this._observable.notify()}_notifyChangeEvent(e,t){this.hasEventListener("change")&&this._notifications&&this._notifications[this._notifications.length-1].changes.push({added:e,removed:t})}_dispatchChange(){if(this._timer&&(this._timer.remove(),this._timer=null),!this._notifications)return;const e=this._notifications;this._notifications=null;for(const t of e){const i=t.changes;gd.clear(),vd.clear(),bd.clear();for(const{added:m,removed:b}of i){if(m)if(bd.size===0&&vd.size===0)for(const x of m)gd.add(x);else for(const x of m)vd.has(x)?(bd.add(x),vd.delete(x)):bd.has(x)||gd.add(x);if(b)if(bd.size===0&&gd.size===0)for(const x of b)vd.add(x);else for(const x of b)gd.has(x)?gd.delete(x):(bd.delete(x),vd.add(x))}const r=$o.acquire();gd.forEach(m=>{r.push(m)});const n=$o.acquire();vd.forEach(m=>{n.push(m)});const o=this._items,c=t.items,h=$o.acquire();if(bd.forEach(m=>{c.indexOf(m)!==o.indexOf(m)&&h.push(m)}),t.listeners&&(r.length||n.length||h.length)){const m={target:this,added:r,removed:n,moved:h},b=t.listeners.length;for(let x=0;x<b;x++){const I=t.listeners[x];I.removed||I.callback.call(this,m)}}$o.release(r),$o.release(n),$o.release(h)}gd.clear(),vd.clear(),bd.clear()}};S0.ofType=e=>{if(!e)return _h;if(VT.has(e))return VT.get(e);let t=null;if(typeof e=="function")t=e.prototype.declaredClass;else if(e.base)t=e.base.prototype.declaredClass;else for(const r in e.typeMap){const n=e.typeMap[r].prototype.declaredClass;t?t+=` | ${n}`:t=n}let i=class extends _h{};return g([FT({Type:e,ensureType:typeof e=="function"?Oi(e):Yc(e)})],i.prototype,"itemType",void 0),i=g([te(`esri.core.Collection<${t}>`)],i),VT.set(e,i),i},g([w()],S0.prototype,"length",void 0),g([w()],S0.prototype,"items",null),S0=_h=g([te("esri.core.Collection")],S0);const Xe=S0;var pg;function $ge(e,t){switch(e.type){case"range":{const i="range"in e?e.range[0]:e.minValue,r="range"in e?e.range[1]:e.maxValue;if(i!=null&&+t<i||r!=null&&+t>r)return pg.VALUE_OUT_OF_RANGE;break}case"coded-value":case"codedValue":if(e.codedValues==null||e.codedValues.every(i=>i==null||i.code!==t))return pg.INVALID_CODED_VALUE}return null}(function(e){e.VALUE_OUT_OF_RANGE="domain-validation-error::value-out-of-range",e.INVALID_CODED_VALUE="domain-validation-error::invalid-coded-value"})(pg||(pg={}));const Ege=$e.getLogger("esri.support.arcadeOnDemand");let zT;function ru(){return zT||(zT=(async()=>{const e=await import("./arcadeUtils.821621ce.js").then(function(t){return t.ay});return{arcade:e.arcade,arcadeUtils:e,Dictionary:e.Dictionary,Feature:e.arcadeFeature}})()),zT}const nWe=(e,t,i)=>xw.create(e,t,i,null,["$feature"]),sWe=(e,t,i)=>xw.create(e,t,i,null,["$feature","$view"]),Tge=(e,t,i,r)=>xw.create(e,t,i,r,["$feature","$view"]);class xw{constructor(t,i,r,n,o,c,h,m){this.script=t,this.evaluate=o;const b=Array.isArray(h)?h:h.fields;this.fields=b,this._syntaxTree=n,this._arcade=i,this._arcadeDictionary=r,this._arcadeFeature=c,this._spatialReference=m,this._referencesGeometry=i.scriptTouchesGeometry(this._syntaxTree),this._referencesScale=this._arcade.referencesMember(this._syntaxTree,"scale")}static async create(t,i,r,n,o,c){const{arcade:h,Feature:m,Dictionary:b}=await ru(),x=Mt.fromJSON(i);let I=null;try{I=h.parseScript(t,c)}catch(he){return Ege.error(new ue("arcade-bad-expression","Failed to parse arcade script",{script:t,error:he})),null}const E=o.reduce((he,fe)=>Ce(K({},he),{[fe]:null}),{});let k=null;H(n)&&(k=new b(n),k.immutable=!0,E.$config=null);const P=h.scriptUsesGeometryEngine(I),F=P&&h.enableGeometrySupport(),N=h.scriptUsesFeatureSet(I)&&h.enableFeatureSetSupport(),B=h.scriptIsAsync(I),z=B&&h.enableAsyncSupport(),q={vars:E,spatialReference:x,useAsync:!!z};await Promise.all([F,N,z]);const J=new Set;await h.loadDependentModules(J,I,null,B,P);const X=new b;X.immutable=!1,X.setField("scale",0);const Y=h.compileScript(I,q),ae=he=>("$view"in he&&he.$view&&(X.setField("scale",he.$view.scale),he.$view=X),k&&(he.$config=k),Y({vars:he,spatialReference:x}));return new xw(t,h,b,I,ae,new m,r,x)}repurposeFeature(t){return t.geometry&&!t.geometry.spatialReference&&(t.geometry.spatialReference=this._spatialReference),this._arcadeFeature.repurposeFromGraphicLikeObject(t.geometry,t.attributes,{fields:this.fields}),this._arcadeFeature}createDictionary(){return new this._arcadeDictionary}referencesMember(t){return this._arcade.referencesMember(this._syntaxTree,t)}referencesFunction(t){return this._arcade.referencesFunction(this._syntaxTree,t)}referencesGeometry(){return this._referencesGeometry}referencesScale(){return this._referencesScale}extractFieldLiterals(){return this._arcade.extractExpectedFieldLiterals(this._syntaxTree)}}const Cge=/^([0-9])/,kge=/[^A-Za-z0-9_\u0080-\uffff]/g,Age=/_{2,}/g,Pge=/^_/,Lge=/_$/;function Oge(e){return e?e.trim().replace(kge,"_").replace(Age,"_").replace(Pge,"").replace(Lge,"").replace(Cge,"F$1"):null}const Rge=["field","field2","field3","normalizationField","rotationInfo.field","proportionalSymbolInfo.field","proportionalSymbolInfo.normalizationField","colorInfo.field","colorInfo.normalizationField"],Fge=["field","normalizationField"];function kz(e,t){if(e!=null&&t!=null){for(const i of Array.isArray(e)?e:[e])if(Az(Rge,i,t),"visualVariables"in i&&i.visualVariables)for(const r of i.visualVariables)Az(Fge,r,t)}}function Az(e,t,i){if(e)for(const r of e){const n=Km(r,t),o=n&&typeof n!="function"&&i.get(n);o&&eo(r,o.name,t)}}function Pz(e,t){var i,r,n,o,c;if(e!=null&&((i=t==null?void 0:t.fields)==null?void 0:i.length))if("startField"in e){const h=t.get(e.startField),m=t.get(e.endField);e.startField=(r=h==null?void 0:h.name)!=null?r:null,e.endField=(n=m==null?void 0:m.name)!=null?n:null}else{const h=t.get(e.startTimeField),m=t.get(e.endTimeField);e.startTimeField=(o=h==null?void 0:h.name)!=null?o:null,e.endTimeField=(c=m==null?void 0:m.name)!=null?c:null}}const GT=new Set;function Lz(e,t){return e&&t?(GT.clear(),Sw(GT,e,t),Array.from(GT).sort()):[]}function Sw(e,t,i){var r;if(i)if((r=t==null?void 0:t.fields)==null?void 0:r.length)if(i.includes("*"))for(const{name:n}of t.fields)e.add(n);else for(const n of i)Aa(e,t,n);else{if(i.includes("*"))return e.clear(),void e.add("*");for(const n of i)n!=null&&e.add(n)}}function Aa(e,t,i){if(typeof i=="string")if(t){const r=t.get(i);r&&e.add(r.name)}else e.add(i)}function oWe(e,t){var i;return ce(t)||ce(e)?[]:t.includes("*")?((i=e.fields)!=null?i:[]).map(r=>r.name):t}async function Co(e,t,i){var o;if(!i)return;const{arcadeUtils:r}=await ru(),n=r.extractFieldNames(i,(o=t==null?void 0:t.fields)==null?void 0:o.map(c=>c.name));for(const c of n)Aa(e,t,c)}async function Oz(e,t,i){if(i&&i!=="1=1"){const r=(await Promise.resolve().then(function(){return fre})).WhereClause.create(i,t);if(!r.isStandardized)throw new ue("fieldUtils:collectFilterFields","Where clause is not standardized",{where:i});Sw(e,t,r.fieldNames)}}function Nge({displayField:e,fields:t}){return e||(t&&t.length?BT(t,"name-or-title")||BT(t,"unique-identifier")||BT(t,"type-or-category")||Dge(t):null)}function Dge(e){for(const t of e){if(!t||!t.name)continue;const i=t.name.toLowerCase();if(i.includes("name")||i.includes("title"))return t.name}return null}function BT(e,t){for(const i of e)if(i&&i.valueType&&i.valueType===t)return i.name;return null}async function aWe(e,t){if(!t)return;const i=Km("elevationInfo.featureExpressionInfo",t);return i?i.collectRequiredFields(e,t.fieldsIndex):void 0}function jge(e,t,i){i.onStatisticExpression?Co(e,t,i.onStatisticExpression.expression):e.add(i.onStatisticField)}async function lWe(e,t,i){if(!t||!i||!("fields"in i))return;const r=[],n=i.popupTemplate;r.push(Vge(e,t,n)),i.fields&&r.push(...i.fields.map(async o=>jge(e,t.fieldsIndex,o))),await Promise.all(r)}async function Vge(e,t,i){const r=[];(i==null?void 0:i.expressionInfos)&&r.push(...i.expressionInfos.map(o=>Co(e,t.fieldsIndex,o.expression)));const n=i==null?void 0:i.content;if(Array.isArray(n))for(const o of n)o.type==="expression"&&o.expressionInfo&&r.push(Co(e,t.fieldsIndex,o.expressionInfo.expression));await Promise.all(r)}async function cWe(e,t,i){t&&(t.timeInfo&&H(i)&&i.timeExtent&&Sw(e,t.fieldsIndex,[t.timeInfo.startField,t.timeInfo.endField]),t.floorInfo&&Sw(e,t.fieldsIndex,[t.floorInfo.floorField]),H(i)&&H(i.where)&&await Oz(e,t.fieldsIndex,i.where))}async function uWe(e,t,i){t&&i&&await Promise.all(i.map(r=>zge(e,t,r)))}async function zge(e,t,i){t&&i&&(i.valueExpression?await Co(e,t.fieldsIndex,i.valueExpression):i.field&&Aa(e,t.fieldsIndex,i.field))}function hWe(e){if(!e)return[];const t="editFieldsInfo"in e&&e.editFieldsInfo;return t?Lz(e.fieldsIndex,[t&&t.creatorField,t&&t.creationDateField,t&&t.editorField,t&&t.editDateField]):[]}async function Gge(e,t){const{labelingInfo:i,fieldsIndex:r}=t;i&&i.length&&await Promise.all(i.map(n=>Bge(e,r,n)))}async function Bge(e,t,i){if(!i)return;const r=i.getLabelExpression(),n=i.where;if(r.type==="arcade")await Co(e,t,r.expression);else{const o=r.expression.match(/{[^}]*}/g);o&&o.forEach(c=>{Aa(e,t,c.slice(1,-1))})}await Oz(e,t,n)}function Uge(e){const t=e.defaultValue;return t!==void 0&&Nz(e,t)?t:e.nullable?null:void 0}function Rz(e){return typeof e=="number"&&!isNaN(e)&&isFinite(e)}function qge(e){return e===null||Rz(e)}const UT="isInteger"in Number?Number.isInteger:e=>typeof e=="number"&&isFinite(e)&&Math.floor(e)===e;function Hge(e){return e===null||UT(e)}function Fz(e){return e!=null&&typeof e=="string"}function Wge(e){return e===null||Fz(e)}function Jge(){return!0}function Nz(e,t){let i;switch(e.type){case"date":case"integer":case"long":case"small-integer":case"esriFieldTypeDate":case"esriFieldTypeInteger":case"esriFieldTypeLong":case"esriFieldTypeSmallInteger":i=e.nullable?Hge:UT;break;case"double":case"single":case"esriFieldTypeSingle":case"esriFieldTypeDouble":i=e.nullable?qge:Rz;break;case"string":case"esriFieldTypeString":i=e.nullable?Wge:Fz;break;default:i=Jge}return arguments.length===1?i:i(t)}const Zge=["integer","small-integer","single","double"],Kge=new Set([...Zge,"esriFieldTypeInteger","esriFieldTypeSmallInteger","esriFieldTypeSingle","esriFieldTypeDouble"]);function qT(e){return e!=null&&Kge.has(e.type)}function Dz(e){return e!=null&&(e.type==="string"||e.type==="esriFieldTypeString")}function Yge(e){return e!=null&&(e.type==="date"||e.type==="esriFieldTypeDate")}var zS,GS;function pWe(e){return e==null||typeof e=="number"&&isNaN(e)?null:e}function dWe(e,t){return e.nullable&&t===null?null:qT(e)&&!Xge(e.type,Number(t))?zS.OUT_OF_RANGE:Nz(e,t)?e.domain?$ge(e.domain,t):null:GS.INVALID_TYPE}function Xge(e,t){const i=typeof e=="string"?jz(e):e;if(!i)return!1;const r=i.min,n=i.max;return i.isInteger?UT(t)&&t>=r&&t<=n:t>=r&&t<=n}function jz(e){switch(e){case"esriFieldTypeSmallInteger":case"small-integer":return Qge;case"esriFieldTypeInteger":case"integer":return e1e;case"esriFieldTypeSingle":case"single":return t1e;case"esriFieldTypeDouble":case"double":return i1e}}(function(e){e.OUT_OF_RANGE="numeric-range-validation-error::out-of-range"})(zS||(zS={})),function(e){e.INVALID_TYPE="type-validation-error::invalid-type"}(GS||(GS={}));const Qge={min:-32768,max:32767,isInteger:!0},e1e={min:-2147483648,max:2147483647,isInteger:!0},t1e={min:-34e37,max:12e37,isInteger:!1},i1e={min:-Number.MAX_VALUE,max:Number.MAX_VALUE,isInteger:!1};function fWe(e,t,i){switch(e){case pg.INVALID_CODED_VALUE:return`Value ${i} is not in the coded domain - field: ${t.name}, domain: ${JSON.stringify(t.domain)}`;case pg.VALUE_OUT_OF_RANGE:return`Value ${i} is out of the range of valid values - field: ${t.name}, domain: ${JSON.stringify(t.domain)}`;case GS.INVALID_TYPE:return`Value ${i} is not a valid value for the field type - field: ${t.name}, type: ${t.type}, nullable: ${t.nullable}`;case zS.OUT_OF_RANGE:{const{min:r,max:n}=jz(t.type);return`Value ${i} is out of range for the number type - field: ${t.name}, type: ${t.type}, value range is ${r} to ${n}`}}}function r1e(e,t){return!n1e(e,t,null)}function n1e(e,t,i){if(!t||!t.attributes||!e){if(H(i))for(const o of e!=null?e:[])i.add(o);return!0}const r=t.attributes;let n=!1;for(const o of e)if(!(o in r)){if(n=!0,!H(i))break;i.add(o)}return n}function Vz(e){return["raster.itempixelvalue","raster.servicepixelvalue"].some(t=>e.toLowerCase().startsWith(t))}let BS=class extends ke{constructor(e){super(e),this.type=null}};g([w({type:["attachments","custom","fields","media","text","expression","relationship"],readOnly:!0,json:{read:!1,write:!0}})],BS.prototype,"type",void 0),BS=g([te("esri.popup.content.Content")],BS);const wd=BS;var HT;let M0=HT=class extends wd{constructor(e){super(e),this.description=null,this.displayType="auto",this.title=null,this.type="attachments"}clone(){return new HT({description:this.description,displayType:this.displayType,title:this.title})}};g([w({type:String,json:{write:!0}})],M0.prototype,"description",void 0),g([w({type:["auto","preview","list"],json:{write:!0}})],M0.prototype,"displayType",void 0),g([w({type:String,json:{write:!0}})],M0.prototype,"title",void 0),g([w({type:["attachments"],readOnly:!0,json:{read:!1,write:!0}})],M0.prototype,"type",void 0),M0=HT=g([te("esri.popup.content.AttachmentsContent")],M0);const Mw=M0;var WT;let I0=WT=class extends wd{constructor(e){super(e),this.creator=null,this.destroyer=null,this.outFields=null,this.type="custom"}clone(){return new WT({creator:this.creator,destroyer:this.destroyer,outFields:Array.isArray(this.outFields)?_e(this.outFields):null})}};g([w()],I0.prototype,"creator",void 0),g([w()],I0.prototype,"destroyer",void 0),g([w()],I0.prototype,"outFields",void 0),g([w({type:["custom"],readOnly:!0})],I0.prototype,"type",void 0),I0=WT=g([te("esri.popup.content.CustomContent")],I0);const s1e=I0;var JT;let dg=JT=class extends ke{constructor(e){super(e),this.title=null,this.expression=null,this.returnType="dictionary"}clone(){return new JT({title:this.title,expression:this.expression})}};g([w({type:String,json:{write:!0}})],dg.prototype,"title",void 0),g([w({type:String,json:{write:!0}})],dg.prototype,"expression",void 0),g([w({type:["dictionary"],readOnly:!0,json:{read:!1,write:!0}})],dg.prototype,"returnType",void 0),dg=JT=g([te("esri.popup.ElementExpressionInfo")],dg);const zz=dg;var ZT;let Iw=ZT=class extends wd{constructor(e){super(e),this.expressionInfo=null,this.type="expression"}clone(){var e;return new ZT({expressionInfo:(e=this.expressionInfo)==null?void 0:e.clone()})}};g([w({type:zz,json:{write:!0}})],Iw.prototype,"expressionInfo",void 0),g([w({type:["expression"],readOnly:!0,json:{read:!1,write:!0}})],Iw.prototype,"type",void 0),Iw=ZT=g([te("esri.popup.content.ExpressionContent")],Iw);const KT=Iw;function Pt(e,t={}){var n;const i=e instanceof kt?e:new kt(e,t),r={type:((n=t==null?void 0:t.ignoreUnknown)!=null?n:1)?i.apiValues:String,json:{type:i.jsonValues,read:!(t==null?void 0:t.readOnly)&&{reader:i.read},write:{writer:i.write}}};return(t==null?void 0:t.readOnly)!==void 0&&(r.readOnly=!!t.readOnly),(t==null?void 0:t.default)!==void 0&&(r.json.default=t.default),(t==null?void 0:t.name)!==void 0&&(r.json.name=t.name),w(r)}const $w=Ns()({shortDate:"short-date",shortDateShortTime:"short-date-short-time",shortDateShortTime24:"short-date-short-time-24",shortDateLongTime:"short-date-long-time",shortDateLongTime24:"short-date-long-time-24",shortDateLE:"short-date-le",shortDateLEShortTime:"short-date-le-short-time",shortDateLEShortTime24:"short-date-le-short-time-24",shortDateLELongTime:"short-date-le-long-time",shortDateLELongTime24:"short-date-le-long-time-24",longMonthDayYear:"long-month-day-year",longMonthDayYearShortTime:"long-month-day-year-short-time",longMonthDayYearShortTime24:"long-month-day-year-short-time-24",longMonthDayYearLongTime:"long-month-day-year-long-time",longMonthDayYearLongTime24:"long-month-day-year-long-time-24",dayShortMonthYear:"day-short-month-year",dayShortMonthYearShortTime:"day-short-month-year-short-time",dayShortMonthYearShortTime24:"day-short-month-year-short-time-24",dayShortMonthYearLongTime:"day-short-month-year-long-time",dayShortMonthYearLongTime24:"day-short-month-year-long-time-24",longDate:"long-date",longDateShortTime:"long-date-short-time",longDateShortTime24:"long-date-short-time-24",longDateLongTime:"long-date-long-time",longDateLongTime24:"long-date-long-time-24",longMonthYear:"long-month-year",shortMonthYear:"short-month-year",year:"year"});$w.toJSON.bind($w);$w.fromJSON.bind($w);let Ew;var Ele,Tle,Cle;const YT=(Cle=(Ele=globalThis.esriConfig)==null?void 0:Ele.locale)!=null?Cle:(Tle=globalThis.dojoConfig)==null?void 0:Tle.locale;function Gz(){var e,t;return(t=YT!=null?YT:(e=globalThis.navigator)==null?void 0:e.language)!=null?t:"en"}function io(){return Ew===void 0&&(Ew=Gz()),Ew}function o1e(e=io()){var t;return(t=/^([a-zA-Z]{2,3})(?:[_\-]\w+)*$/.exec(e))==null?void 0:t[1].toLowerCase()}const Tw=[];function US(e){return Tw.push(e),{remove(){Tw.splice(Tw.indexOf(e),1)}}}const XT=[];function QT(e){return XT.push(e),{remove(){Tw.splice(XT.indexOf(e),1)}}}function a1e(){const e=Gz();Ew!==e&&(Ew=e,[...XT].forEach(t=>{t.call(null,e)}),[...Tw].forEach(t=>{t.call(null,e)}))}var kle;(kle=globalThis.addEventListener)==null||kle.call(globalThis,"languagechange",a1e);const nu={year:"numeric",month:"numeric",day:"numeric"},Cw={year:"numeric",month:"long",day:"numeric"},kw={year:"numeric",month:"short",day:"numeric"},Aw={year:"numeric",month:"long",weekday:"long",day:"numeric"},yl={hour:"numeric",minute:"numeric"},ec=Ce(K({},yl),{second:"numeric"}),e6={"short-date":nu,"short-date-short-time":K(K({},nu),yl),"short-date-short-time-24":Ce(K(K({},nu),yl),{hour12:!1}),"short-date-long-time":K(K({},nu),ec),"short-date-long-time-24":Ce(K(K({},nu),ec),{hour12:!1}),"short-date-le":nu,"short-date-le-short-time":K(K({},nu),yl),"short-date-le-short-time-24":Ce(K(K({},nu),yl),{hour12:!1}),"short-date-le-long-time":K(K({},nu),ec),"short-date-le-long-time-24":Ce(K(K({},nu),ec),{hour12:!1}),"long-month-day-year":Cw,"long-month-day-year-short-time":K(K({},Cw),yl),"long-month-day-year-short-time-24":Ce(K(K({},Cw),yl),{hour12:!1}),"long-month-day-year-long-time":K(K({},Cw),ec),"long-month-day-year-long-time-24":Ce(K(K({},Cw),ec),{hour12:!1}),"day-short-month-year":kw,"day-short-month-year-short-time":K(K({},kw),yl),"day-short-month-year-short-time-24":Ce(K(K({},kw),yl),{hour12:!1}),"day-short-month-year-long-time":K(K({},kw),ec),"day-short-month-year-long-time-24":Ce(K(K({},kw),ec),{hour12:!1}),"long-date":Aw,"long-date-short-time":K(K({},Aw),yl),"long-date-short-time-24":Ce(K(K({},Aw),yl),{hour12:!1}),"long-date-long-time":K(K({},Aw),ec),"long-date-long-time-24":Ce(K(K({},Aw),ec),{hour12:!1}),"long-month-year":{month:"long",year:"numeric"},"short-month-year":{month:"short",year:"numeric"},year:{year:"numeric"},"short-time":yl,"long-time":ec},Pw=Ns()({shortDate:"short-date",shortDateShortTime:"short-date-short-time",shortDateShortTime24:"short-date-short-time-24",shortDateLongTime:"short-date-long-time",shortDateLongTime24:"short-date-long-time-24",shortDateLE:"short-date-le",shortDateLEShortTime:"short-date-le-short-time",shortDateLEShortTime24:"short-date-le-short-time-24",shortDateLELongTime:"short-date-le-long-time",shortDateLELongTime24:"short-date-le-long-time-24",longMonthDayYear:"long-month-day-year",longMonthDayYearShortTime:"long-month-day-year-short-time",longMonthDayYearShortTime24:"long-month-day-year-short-time-24",longMonthDayYearLongTime:"long-month-day-year-long-time",longMonthDayYearLongTime24:"long-month-day-year-long-time-24",dayShortMonthYear:"day-short-month-year",dayShortMonthYearShortTime:"day-short-month-year-short-time",dayShortMonthYearShortTime24:"day-short-month-year-short-time-24",dayShortMonthYearLongTime:"day-short-month-year-long-time",dayShortMonthYearLongTime24:"day-short-month-year-long-time-24",longDate:"long-date",longDateShortTime:"long-date-short-time",longDateShortTime24:"long-date-short-time-24",longDateLongTime:"long-date-long-time",longDateLongTime24:"long-date-long-time-24",longMonthYear:"long-month-year",shortMonthYear:"short-month-year",year:"year"});Pw.apiValues;Pw.toJSON.bind(Pw);Pw.fromJSON.bind(Pw);const l1e={ar:"ar-u-nu-latn-ca-gregory"};let t6=new WeakMap,Bz=e6["short-date-short-time"];function c1e(e){const t=e||Bz;let i=t6.get(t);if(!i){const r=io(),n=l1e[io()]||r;i=new Intl.DateTimeFormat(n,t),t6.set(t,i)}return i}function fg(e){return e?e6[e]:null}function Pa(e,t){return c1e(t).format(e)}QT(()=>{t6=new WeakMap,Bz=e6["short-date-short-time"]});const u1e={ar:"ar-u-nu-latn"};let qS=new WeakMap,Uz={};function h1e(e){const t=e||Uz;if(!qS.has(t)){const i=io(),r=u1e[io()]||i;qS.set(t,new Intl.NumberFormat(r,e))}return On(qS.get(t))}function qz(e={}){const t={};return e.digitSeparator!=null&&(t.useGrouping=e.digitSeparator),e.places!=null&&(t.minimumFractionDigits=t.maximumFractionDigits=e.places),t}function Jo(e,t){return e===-0&&(e=0),h1e(t).format(e)}QT(()=>{qS=new WeakMap,Uz={}});var i6;let $0=i6=class extends ke{constructor(e){super(e),this.dateFormat=null,this.dateTimeFormatOptions=null,this.digitSeparator=!1,this.places=null}clone(){return new i6({dateFormat:this.dateFormat,digitSeparator:this.digitSeparator,places:this.places})}format(e){return this.dateFormat?Pa(e,K(K({},fg(this.dateFormat)),this.dateTimeFormatOptions)):Jo(e,qz(this))}formatRasterPixelValue(e){if(e.includes("-"))return e;let t,i;return e.trim().includes(",")?(t=",",i=t+" ",this._formatDelimitedString(e,t,i,this)):e.trim().includes(";")?(t=";",i=t+" ",this._formatDelimitedString(e,t,i,this)):e.trim().includes(" ")?(t=i=" ",this._formatDelimitedString(e,t,i,this)):this.format(Number(e))}_formatDelimitedString(e,t,i,r){return e&&t&&i&&r?e.trim().split(t).map(n=>this.format(Number(n))).join(i):e}};g([Pt($w)],$0.prototype,"dateFormat",void 0),g([w({type:Object,json:{read:!1}})],$0.prototype,"dateTimeFormatOptions",void 0),g([w({type:Boolean,json:{write:!0}})],$0.prototype,"digitSeparator",void 0),g([w({type:Ri,json:{write:!0}})],$0.prototype,"places",void 0),$0=i6=g([te("esri.popup.support.FieldInfoFormat")],$0);const yg=$0;var r6;let tc=r6=class extends ke{constructor(e){super(e),this.fieldName=null,this.format=null,this.isEditable=!1,this.label=null,this.stringFieldOption="text-box",this.statisticType=null,this.tooltip=null,this.visible=!0}clone(){return new r6({fieldName:this.fieldName,format:this.format?_e(this.format):null,isEditable:this.isEditable,label:this.label,stringFieldOption:this.stringFieldOption,statisticType:this.statisticType,tooltip:this.tooltip,visible:this.visible})}};g([w({type:String,json:{write:!0}})],tc.prototype,"fieldName",void 0),g([w({type:yg,json:{write:!0}})],tc.prototype,"format",void 0),g([w({type:Boolean,json:{write:!0,default:!1}})],tc.prototype,"isEditable",void 0),g([w({type:String,json:{write:!0}})],tc.prototype,"label",void 0),g([Pt(new kt({richtext:"rich-text",textarea:"text-area",textbox:"text-box"}),{default:"text-box"})],tc.prototype,"stringFieldOption",void 0),g([w({type:["count","sum","min","max","avg","stddev","var"],json:{write:!0}})],tc.prototype,"statisticType",void 0),g([w({type:String,json:{write:!0}})],tc.prototype,"tooltip",void 0),g([w({type:Boolean,json:{write:!0}})],tc.prototype,"visible",void 0),tc=r6=g([te("esri.popup.FieldInfo")],tc);const Lw=tc;var n6;let xh=n6=class extends wd{constructor(e){super(e),this.attributes=null,this.description=null,this.fieldInfos=null,this.title=null,this.type="fields"}writeFieldInfos(e,t){t.fieldInfos=e&&e.map(i=>i.toJSON())}clone(){return new n6(_e({attributes:this.attributes,description:this.description,fieldInfos:this.fieldInfos,title:this.title}))}};g([w({type:Object,json:{write:!0}})],xh.prototype,"attributes",void 0),g([w({type:String,json:{write:!0}})],xh.prototype,"description",void 0),g([w({type:[Lw]})],xh.prototype,"fieldInfos",void 0),g([tt("fieldInfos")],xh.prototype,"writeFieldInfos",null),g([w({type:String,json:{write:!0}})],xh.prototype,"title",void 0),g([w({type:["fields"],readOnly:!0,json:{read:!1,write:!0}})],xh.prototype,"type",void 0),xh=n6=g([te("esri.popup.content.FieldsContent")],xh);const mg=xh;let E0=class extends ke{constructor(e){super(e),this.altText=null,this.caption="",this.title="",this.type=null}};g([w({type:String,json:{write:!0}})],E0.prototype,"altText",void 0),g([w({type:String,json:{write:!0}})],E0.prototype,"caption",void 0),g([w({type:String,json:{write:!0}})],E0.prototype,"title",void 0),g([w({type:["image","bar-chart","column-chart","line-chart","pie-chart"],readOnly:!0,json:{read:!1,write:!0}})],E0.prototype,"type",void 0),E0=g([te("esri.popup.content.mixins.MediaInfo")],E0);const s6=E0;var o6;let gg=o6=class extends Ye{constructor(e){super(e),this.fieldName=null,this.tooltip=null,this.value=null}clone(){return new o6({fieldName:this.fieldName,tooltip:this.tooltip,value:this.value})}};g([w()],gg.prototype,"fieldName",void 0),g([w()],gg.prototype,"tooltip",void 0),g([w()],gg.prototype,"value",void 0),gg=o6=g([te("esri.popup.content.support.ChartMediaInfoValueSeries")],gg);const Hz=gg;var a6;let T0=a6=class extends ke{constructor(e){super(e),this.fields=[],this.normalizeField=null,this.series=[],this.tooltipField=null}clone(){return new a6({fields:_e(this.fields),normalizeField:this.normalizeField,tooltipField:this.tooltipField})}};g([w({type:[String],json:{write:!0}})],T0.prototype,"fields",void 0),g([w({type:String,json:{write:!0}})],T0.prototype,"normalizeField",void 0),g([w({type:[Hz],json:{read:!1}})],T0.prototype,"series",void 0),g([w({type:String,json:{write:!0}})],T0.prototype,"tooltipField",void 0),T0=a6=g([te("esri.popup.content.support.ChartMediaInfoValue")],T0);const p1e=T0;let Ow=class extends s6{constructor(e){super(e),this.type=null,this.value=null}};g([w({type:["bar-chart","column-chart","line-chart","pie-chart"],readOnly:!0,json:{read:!1,write:!0}})],Ow.prototype,"type",void 0),g([w({type:p1e,json:{write:!0}})],Ow.prototype,"value",void 0),Ow=g([te("esri.popup.content.mixins.ChartMediaInfo")],Ow);const HS=Ow,WS=Ns()({barchart:"bar-chart",columnchart:"column-chart",linechart:"line-chart",piechart:"pie-chart"});var l6;let JS=l6=class extends HS{constructor(e){super(e),this.type="bar-chart"}clone(){return new l6({altText:this.altText,title:this.title,caption:this.caption,value:this.value?this.value.clone():null})}};g([w({type:["bar-chart"],readOnly:!0,json:{type:["barchart"],read:!1,write:WS.write}})],JS.prototype,"type",void 0),JS=l6=g([te("esri.popup.content.BarChartMediaInfo")],JS);const Wz=JS;var c6;let ZS=c6=class extends HS{constructor(e){super(e),this.type="column-chart"}clone(){return new c6({altText:this.altText,title:this.title,caption:this.caption,value:this.value?this.value.clone():null})}};g([w({type:["column-chart"],readOnly:!0,json:{type:["columnchart"],read:!1,write:WS.write}})],ZS.prototype,"type",void 0),ZS=c6=g([te("esri.popup.content.ColumnChartMediaInfo")],ZS);const Jz=ZS;var u6;let Rw=u6=class extends ke{constructor(e){super(e),this.linkURL=null,this.sourceURL=null}clone(){return new u6({linkURL:this.linkURL,sourceURL:this.sourceURL})}};g([w({type:String,json:{write:!0}})],Rw.prototype,"linkURL",void 0),g([w({type:String,json:{write:!0}})],Rw.prototype,"sourceURL",void 0),Rw=u6=g([te("esri.popup.content.support.ImageMediaInfoValue")],Rw);const d1e=Rw;var h6;let vg=h6=class extends s6{constructor(e){super(e),this.refreshInterval=null,this.type="image",this.value=null}clone(){return new h6({altText:this.altText,title:this.title,caption:this.caption,refreshInterval:this.refreshInterval,value:this.value?this.value.clone():null})}};g([w({type:Number,json:{write:!0}})],vg.prototype,"refreshInterval",void 0),g([w({type:["image"],readOnly:!0,json:{read:!1,write:!0}})],vg.prototype,"type",void 0),g([w({type:d1e,json:{write:!0}})],vg.prototype,"value",void 0),vg=h6=g([te("esri.popup.content.ImageMediaInfo")],vg);const Zz=vg;var p6;let KS=p6=class extends HS{constructor(e){super(e),this.type="line-chart"}clone(){return new p6({altText:this.altText,title:this.title,caption:this.caption,value:this.value?this.value.clone():null})}};g([w({type:["line-chart"],readOnly:!0,json:{type:["linechart"],read:!1,write:WS.write}})],KS.prototype,"type",void 0),KS=p6=g([te("esri.popup.content.LineChartMediaInfo")],KS);const Kz=KS;var d6;let YS=d6=class extends HS{constructor(e){super(e),this.type="pie-chart"}clone(){return new d6({altText:this.altText,title:this.title,caption:this.caption,value:this.value?this.value.clone():null})}};g([w({type:["pie-chart"],readOnly:!0,json:{type:["piechart"],read:!1,write:WS.write}})],YS.prototype,"type",void 0),YS=d6=g([te("esri.popup.content.PieChartMediaInfo")],YS);const Yz=YS,Xz={base:s6,key:"type",defaultKeyValue:"image",typeMap:{"bar-chart":Wz,"column-chart":Jz,"line-chart":Kz,"pie-chart":Yz,image:Zz}};var f6;let ic=f6=class extends wd{constructor(e){super(e),this.activeMediaInfoIndex=null,this.attributes=null,this.description=null,this.mediaInfos=null,this.title=null,this.type="media"}readMediaInfos(e){return e&&e.map(t=>t.type==="image"?Zz.fromJSON(t):t.type==="barchart"?Wz.fromJSON(t):t.type==="columnchart"?Jz.fromJSON(t):t.type==="linechart"?Kz.fromJSON(t):t.type==="piechart"?Yz.fromJSON(t):void 0).filter(Boolean)}writeMediaInfos(e,t){t.mediaInfos=e&&e.map(i=>i.toJSON())}clone(){return new f6(_e({activeMediaInfoIndex:this.activeMediaInfoIndex,attributes:this.attributes,description:this.description,mediaInfos:this.mediaInfos,title:this.title}))}};g([w()],ic.prototype,"activeMediaInfoIndex",void 0),g([w({type:Object,json:{write:!0}})],ic.prototype,"attributes",void 0),g([w({type:String,json:{write:!0}})],ic.prototype,"description",void 0),g([w({types:[Xz]})],ic.prototype,"mediaInfos",void 0),g([We("mediaInfos")],ic.prototype,"readMediaInfos",null),g([tt("mediaInfos")],ic.prototype,"writeMediaInfos",null),g([w({type:String,json:{write:!0}})],ic.prototype,"title",void 0),g([w({type:["media"],readOnly:!0,json:{read:!1,write:!0}})],ic.prototype,"type",void 0),ic=f6=g([te("esri.popup.content.MediaContent")],ic);const Fw=ic;var y6;let Nw=y6=class extends ke{constructor(e){super(e),this.field=null,this.order=null}clone(){return new y6({field:this.field,order:this.order})}};g([w({type:String,json:{write:!0}})],Nw.prototype,"field",void 0),g([w({type:["asc","desc"],json:{write:!0}})],Nw.prototype,"order",void 0),Nw=y6=g([te("esri.popup.support.RelatedRecordsInfoFieldOrder")],Nw);const m6=Nw;let su=class extends rn(wd){constructor(e){super(e),this.description=null,this.displayCount=null,this.displayType="list",this.orderByFields=null,this.relationshipId=null,this.title=null,this.type="relationship"}};g([w({type:String,json:{write:!0}})],su.prototype,"description",void 0),g([w({type:Number,json:{type:Ri,write:!0}})],su.prototype,"displayCount",void 0),g([w({type:["list"],json:{write:!0}})],su.prototype,"displayType",void 0),g([w({type:[m6],json:{write:!0}})],su.prototype,"orderByFields",void 0),g([w({type:Number,json:{type:Ri,write:!0}})],su.prototype,"relationshipId",void 0),g([w({type:String,json:{write:!0}})],su.prototype,"title",void 0),g([w({type:["relationship"],readOnly:!0,json:{read:!1,write:!0}})],su.prototype,"type",void 0),su=g([te("esri.popup.content.RelationshipContent")],su);const XS=su;var g6;let Dw=g6=class extends wd{constructor(e){super(e),this.text=null,this.type="text"}clone(){return new g6({text:this.text})}};g([w({type:String,json:{write:!0}})],Dw.prototype,"text",void 0),g([w({type:["text"],readOnly:!0,json:{read:!1,write:!0}})],Dw.prototype,"type",void 0),Dw=g6=g([te("esri.popup.content.TextContent")],Dw);const bg=Dw,f1e={base:null,key:"type",typeMap:{attachment:Mw,media:Fw,text:bg,expression:KT,field:mg,relationship:XS}};var v6;let C0=v6=class extends ke{constructor(e){super(e),this.name=null,this.title=null,this.expression=null,this.returnType=null}clone(){return new v6({name:this.name,title:this.title,expression:this.expression,returnType:this.returnType})}};g([w({type:String,json:{write:!0}})],C0.prototype,"name",void 0),g([w({type:String,json:{write:!0}})],C0.prototype,"title",void 0),g([w({type:String,json:{write:!0}})],C0.prototype,"expression",void 0),g([w({type:["string","number"],json:{write:!0}})],C0.prototype,"returnType",void 0),C0=v6=g([te("esri.popup.ExpressionInfo")],C0);const Qz=C0;var b6;let jw=b6=class extends ke{constructor(e){super(e),this.returnTopmostRaster=null,this.showNoDataRecords=null}clone(){return new b6({showNoDataRecords:this.showNoDataRecords,returnTopmostRaster:this.returnTopmostRaster})}};g([w({type:Boolean,json:{write:!0}})],jw.prototype,"returnTopmostRaster",void 0),g([w({type:Boolean,json:{write:!0}})],jw.prototype,"showNoDataRecords",void 0),jw=b6=g([te("esri.popup.LayerOptions")],jw);const y1e=jw;var w6;let Vw=w6=class extends ke{constructor(e){super(e),this.showRelatedRecords=null,this.orderByFields=null}clone(){return new w6({showRelatedRecords:this.showRelatedRecords,orderByFields:this.orderByFields?_e(this.orderByFields):null})}};g([w({type:Boolean,json:{write:!0}})],Vw.prototype,"showRelatedRecords",void 0),g([w({type:[m6],json:{write:!0}})],Vw.prototype,"orderByFields",void 0),Vw=w6=g([te("esri.popup.RelatedRecordsInfo")],Vw);const m1e=Vw;let eG=0;const rc=e=>{let t=class extends e{constructor(...i){super(...i),Object.defineProperty(this,"uid",{writable:!1,configurable:!1,value:Date.now().toString(16)+"-object-"+eG++})}};return t=g([te("esri.core.Identifiable")],t),t},_6=e=>{let t=class extends e{constructor(...i){super(...i),Object.defineProperty(this,"uid",{writable:!1,configurable:!1,value:eG++})}};return t=g([te("esri.core.NumericIdentifiable")],t),t};let tG=class extends rc(class{}){};tG=g([te("esri.core.Identifiable")],tG);var x6;let nc=x6=class extends rc(Ye){constructor(e){super(e),this.active=!1,this.className=null,this.disabled=!1,this.id=null,this.indicator=!1,this.title=null,this.type=null,this.visible=!0}clone(){return new x6({active:this.active,className:this.className,disabled:this.disabled,id:this.id,indicator:this.indicator,title:this.title,visible:this.visible})}};g([w()],nc.prototype,"active",void 0),g([w()],nc.prototype,"className",void 0),g([w()],nc.prototype,"disabled",void 0),g([w()],nc.prototype,"id",void 0),g([w()],nc.prototype,"indicator",void 0),g([w()],nc.prototype,"title",void 0),g([w()],nc.prototype,"type",void 0),g([w()],nc.prototype,"visible",void 0),nc=x6=g([te("esri.support.actions.ActionBase")],nc);const wg=nc;var S6;let QS=S6=class extends wg{constructor(e){super(e),this.image=null,this.type="button"}clone(){return new S6({active:this.active,className:this.className,disabled:this.disabled,id:this.id,indicator:this.indicator,title:this.title,visible:this.visible,image:this.image})}};g([w()],QS.prototype,"image",void 0),QS=S6=g([te("esri.support.Action.ActionButton")],QS);const k0=QS;var M6;let zw=M6=class extends wg{constructor(e){super(e),this.image=null,this.type="toggle",this.value=!1}clone(){return new M6({active:this.active,className:this.className,disabled:this.disabled,id:this.id,indicator:this.indicator,title:this.title,visible:this.visible,image:this.image,value:this.value})}};g([w()],zw.prototype,"image",void 0),g([w()],zw.prototype,"value",void 0),zw=M6=g([te("esri.support.Action.ActionToggle")],zw);const I6=zw,g1e="esri.PopupTemplate",v1e=$e.getLogger(g1e),Gw="relationships/",iG="expression/",b1e=Xe.ofType({key:"type",defaultKeyValue:"button",base:wg,typeMap:{button:k0,toggle:I6}}),w1e={base:wd,key:"type",typeMap:{media:Fw,custom:s1e,text:bg,attachments:Mw,fields:mg,expression:KT,relationship:XS}},_1e=["attachments","fields","media","text","expression","relationship"];let ts=class extends rn(ke){constructor(){super(...arguments),this.actions=null,this.content="",this.expressionInfos=null,this.fieldInfos=null,this.layerOptions=null,this.lastEditInfoEnabled=!0,this.outFields=null,this.overwriteActions=!1,this.returnGeometry=!1,this.title=""}castContent(e){return Array.isArray(e)?e.map(t=>Yc(w1e,t)):typeof e=="string"||typeof e=="function"||e instanceof HTMLElement||yh(e)?e:(v1e.error("content error","unsupported content value",{value:e}),null)}readContent(e,t){const{popupElements:i}=t;return Array.isArray(i)&&i.length>0?this._readPopupInfoElements(t.description,t.mediaInfos,i):this._readPopupInfo(t)}writeContent(e,t,i,r){typeof e!="string"?Array.isArray(e)&&(t.popupElements=e.filter(n=>_1e.includes(n.type)).map(n=>n&&n.toJSON(r)),t.popupElements.forEach(n=>{n.type==="attachments"?this._writeAttachmentContent(t):n.type==="media"?this._writeMediaContent(n,t):n.type==="text"?this._writeTextContent(n,t):n.type==="relationship"&&this._writeRelationshipContent(n,t)})):t.description=e}writeFieldInfos(e,t,i,r){const{content:n}=this,o=Array.isArray(n)?n:null;if(e){const c=o?o.filter(m=>m.type==="fields"):[],h=c.length&&c.every(m=>{var b;return(b=m.fieldInfos)==null?void 0:b.length});t.fieldInfos=e.filter(Boolean).map(m=>{const b=m.toJSON(r);return h&&(b.visible=!1),b})}if(o)for(const c of o)c.type==="fields"&&this._writeFieldsContent(c,t)}writeLayerOptions(e,t,i,r){t[i]=!e||e.showNoDataRecords===null&&e.returnTopmostRaster===null?null:e.toJSON(r)}writeTitle(e,t){t.title=e||""}async collectRequiredFields(e,t){const i=this.expressionInfos||[];await this._collectExpressionInfoFields(e,t,[...i,...this._getContentExpressionInfos(this.content,i)]),Sw(e,t,[...this.outFields||[],...this._getActionsFields(this.actions),...this._getTitleFields(this.title),...this._getContentFields(this.content)])}async getRequiredFields(e){const t=new Set;return await this.collectRequiredFields(t,e),[...t].sort()}_writeFieldsContent(e,t){if(!Array.isArray(e.fieldInfos)||!e.fieldInfos.length)return;const i=_e(e.fieldInfos);Array.isArray(t.fieldInfos)?i.forEach(r=>{const n=t.fieldInfos.find(o=>o.fieldName.toLowerCase()===r.fieldName.toLowerCase());n?n.visible=!0:t.fieldInfos.push(r)}):t.fieldInfos=i}_writeAttachmentContent(e){e.showAttachments||(e.showAttachments=!0)}_writeRelationshipContent(e,t){var n,o;const i=((n=e.orderByFields)==null?void 0:n.map(c=>this._toFieldOrderJSON(c,e.relationshipId)))||[],r=[...((o=t.relatedRecordsInfo)==null?void 0:o.orderByFields)||[],...i];t.relatedRecordsInfo=K({showRelatedRecords:!0},(r==null?void 0:r.length)&&{orderByFields:r})}_writeTextContent(e,t){!t.description&&e.text&&(t.description=e.text)}_writeMediaContent(e,t){if(!Array.isArray(e.mediaInfos)||!e.mediaInfos.length)return;const i=_e(e.mediaInfos);Array.isArray(t.mediaInfos)?t.mediaInfos=[...t.mediaInfos,...i]:t.mediaInfos=i}_readPopupInfoElements(e,t,i){const r={description:!1,mediaInfos:!1};return i.map(n=>n.type==="media"?(n.mediaInfos||!t||r.mediaInfos||(n.mediaInfos=t,r.mediaInfos=!0),Fw.fromJSON(n)):n.type==="text"?(n.text||!e||r.description||(n.text=e,r.description=!0),bg.fromJSON(n)):n.type==="attachments"?Mw.fromJSON(n):n.type==="fields"?mg.fromJSON(n):n.type==="expression"?KT.fromJSON(n):n.type==="relationship"?XS.fromJSON(n):void 0).filter(Boolean)}_toRelationshipContent(e){const{field:t,order:i}=e;if(!(t==null?void 0:t.startsWith(Gw)))return null;const r=t.replace(Gw,"").split("/");if(r.length!==2)return null;const n=parseInt(r[0],10),o=r[1];return typeof n=="number"&&o?XS.fromJSON({relationshipId:n,orderByFields:[{field:o,order:i}]}):null}_toFieldOrderJSON(e,t){const{order:i,field:r}=e;return{field:`${Gw}${t}/${r}`,order:i}}_readPopupInfo({description:e,mediaInfos:t,showAttachments:i,relatedRecordsInfo:r={showRelatedRecords:!1}}){const n=[];e?n.push(new bg({text:e})):n.push(new mg),Array.isArray(t)&&t.length&&n.push(Fw.fromJSON({mediaInfos:t})),i&&n.push(Mw.fromJSON({displayType:"auto"}));const{showRelatedRecords:o,orderByFields:c}=r;return o&&(c==null?void 0:c.length)&&c.forEach(h=>{const m=this._toRelationshipContent(h);m&&n.push(m)}),n.length?n:e}_getContentElementFields(e){var i;const t=e==null?void 0:e.type;if(t==="attachments")return[...this._extractFieldNames(e.title),...this._extractFieldNames(e.description)];if(t==="custom")return e.outFields||[];if(t==="fields")return[...this._extractFieldNames(e.title),...this._extractFieldNames(e.description),...this._getFieldInfoFields((i=e.fieldInfos)!=null?i:this.fieldInfos)];if(t==="media"){const r=e.mediaInfos||[];return[...this._extractFieldNames(e.title),...this._extractFieldNames(e.description),...r.reduce((n,o)=>[...n,...this._getMediaInfoFields(o)],[])]}return t==="text"?this._extractFieldNames(e.text):[]}_getMediaInfoFields(e){const{caption:t,title:i,value:r}=e,n=r||{},{fields:o,normalizeField:c,tooltipField:h,sourceURL:m,linkURL:b}=n,x=[...this._extractFieldNames(i),...this._extractFieldNames(t),...this._extractFieldNames(m),...this._extractFieldNames(b),...o!=null?o:[]];return c&&x.push(c),h&&x.push(h),x}_getContentExpressionInfos(e,t){return Array.isArray(e)?e.reduce((i,r)=>[...i,...r.type==="expression"&&r.expressionInfo?[r.expressionInfo]:[]],t):[]}_getContentFields(e){return typeof e=="string"?this._extractFieldNames(e):Array.isArray(e)?e.reduce((t,i)=>[...t,...this._getContentElementFields(i)],[]):[]}async _collectExpressionInfoFields(e,t,i){i&&await Promise.all(i.map(r=>Co(e,t,r.expression)))}_getFieldInfoFields(e){return e?e.filter(t=>t.visible===void 0||!!t.visible).map(t=>t.fieldName).filter(t=>!t.startsWith(Gw)&&!t.startsWith(iG)):[]}_getActionsFields(e){return e?e.toArray().reduce((t,i)=>[...t,...this._getActionFields(i)],[]):[]}_getActionFields(e){const{className:t,title:i,type:r}=e,n=r==="button"||r==="toggle"?e.image:"";return[...this._extractFieldNames(i),...this._extractFieldNames(t),...this._extractFieldNames(n)]}_getTitleFields(e){return typeof e=="string"?this._extractFieldNames(e):[]}_extractFieldNames(e){if(!e||typeof e!="string")return[];const t=/{[^}]*}/g,i=e.match(t);if(!i)return[];const r=/\{(\w+):.+\}/,n=i.filter(o=>!(o.indexOf(`{${Gw}`)===0||o.indexOf(`{${iG}`)===0)).map(o=>o.replace(r,"{$1}"));return n?n.map(o=>o.slice(1,-1)):[]}};g([w({type:b1e})],ts.prototype,"actions",void 0),g([w()],ts.prototype,"content",void 0),g([Dt("content")],ts.prototype,"castContent",null),g([We("content",["description","fieldInfos","popupElements","mediaInfos","showAttachments","relatedRecordsInfo"])],ts.prototype,"readContent",null),g([tt("content",{popupElements:{type:Xe.ofType(f1e)},showAttachments:{type:Boolean},mediaInfos:{type:Xe.ofType(Xz)},description:{type:String},relatedRecordsInfo:{type:m1e}})],ts.prototype,"writeContent",null),g([w({type:[Qz],json:{write:!0}})],ts.prototype,"expressionInfos",void 0),g([w({type:[Lw]})],ts.prototype,"fieldInfos",void 0),g([tt("fieldInfos")],ts.prototype,"writeFieldInfos",null),g([w({type:y1e})],ts.prototype,"layerOptions",void 0),g([tt("layerOptions")],ts.prototype,"writeLayerOptions",null),g([w({type:Boolean,json:{read:{source:"showLastEditInfo"},write:{target:"showLastEditInfo"},default:!0}})],ts.prototype,"lastEditInfoEnabled",void 0),g([w()],ts.prototype,"outFields",void 0),g([w()],ts.prototype,"overwriteActions",void 0),g([w()],ts.prototype,"returnGeometry",void 0),g([w({json:{type:String}})],ts.prototype,"title",void 0),g([tt("title")],ts.prototype,"writeTitle",null),ts=g([te("esri.PopupTemplate")],ts);const _d=ts,e5={transparent:[0,0,0,0],black:[0,0,0,1],silver:[192,192,192,1],gray:[128,128,128,1],white:[255,255,255,1],maroon:[128,0,0,1],red:[255,0,0,1],purple:[128,0,128,1],fuchsia:[255,0,255,1],green:[0,128,0,1],lime:[0,255,0,1],olive:[128,128,0,1],yellow:[255,255,0,1],navy:[0,0,128,1],blue:[0,0,255,1],teal:[0,128,128,1],aqua:[0,255,255,1],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],blanchedalmond:[255,235,205,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],oldlace:[253,245,230,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],rebeccapurple:[102,51,153,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],whitesmoke:[245,245,245,1],yellowgreen:[154,205,50,1]};function rG(e){return e5[e]||e5[e.toLowerCase()]}function $6(e){var t;return(t=e5[e])!=null?t:e5[e.toLowerCase()]}function x1e(e){return[...$6(e)]}function E6(e,t,i){i<0&&++i,i>1&&--i;const r=6*i;return r<1?e+(t-e)*r:2*i<1?t:3*i<2?e+(t-e)*(2/3-i)*6:e}function nG(e,t,i,r=1){const n=(e%360+360)%360/360,o=i<=.5?i*(t+1):i+t-i*t,c=2*i-o;return[Math.round(255*E6(c,o,n+1/3)),Math.round(255*E6(c,o,n)),Math.round(255*E6(c,o,n-1/3)),r]}function S1e(e){const t=e.length>5,i=t?8:4,r=(1<<i)-1,n=t?1:17,o=t?e.length===9:e.length===5;let c=Number("0x"+e.substr(1));if(isNaN(c))return null;const h=[0,0,0,1];let m;return o&&(m=c&r,c>>=i,h[3]=n*m/255),m=c&r,c>>=i,h[2]=n*m,m=c&r,c>>=i,h[1]=n*m,m=c&r,c>>=i,h[0]=n*m,h}function it(){return[0,0,0]}function xd(e){return[e[0],e[1],e[2]]}function Mn(e,t,i){return[e,t,i]}function sG(e){const t=it(),i=Math.min(3,e.length);for(let r=0;r<i;++r)t[r]=e[r];return t}function oG(e,t){return new Float64Array(e,t,3)}function aG(){return it()}function lG(){return Mn(1,1,1)}function cG(){return Mn(1,0,0)}function uG(){return Mn(0,1,0)}function hG(){return Mn(0,0,1)}const M1e=aG(),pG=lG(),I1e=cG(),$1e=uG(),E1e=hG();Object.freeze(Object.defineProperty({__proto__:null,create:it,clone:xd,fromValues:Mn,fromArray:sG,createView:oG,zeros:aG,ones:lG,unitX:cG,unitY:uG,unitZ:hG,ZEROS:M1e,ONES:pG,UNIT_X:I1e,UNIT_Y:$1e,UNIT_Z:E1e},Symbol.toStringTag,{value:"Module"}));let T6=1e-6;function Zo(){return T6}function T1e(e){T6=e}const Bw=Math.random,C1e=Math.PI/180,k1e=180/Math.PI;function C6(e){return e*C1e}function A1e(e){return e*k1e}function P1e(e,t){return Math.abs(e-t)<=T6*Math.max(1,Math.abs(e),Math.abs(t))}Object.freeze(Object.defineProperty({__proto__:null,getEpsilon:Zo,setEpsilon:T1e,RANDOM:Bw,toRadian:C6,toDegree:A1e,equals:P1e},Symbol.toStringTag,{value:"Module"}));function ml(e){const t=e[0],i=e[1],r=e[2];return Math.sqrt(t*t+i*i+r*r)}function ko(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e}function Nn(e,t,i,r){return e[0]=t,e[1]=i,e[2]=r,e}function Ko(e,t,i){return e[0]=t[0]+i[0],e[1]=t[1]+i[1],e[2]=t[2]+i[2],e}function fn(e,t,i){return e[0]=t[0]-i[0],e[1]=t[1]-i[1],e[2]=t[2]-i[2],e}function dG(e,t,i){return e[0]=t[0]*i[0],e[1]=t[1]*i[1],e[2]=t[2]*i[2],e}function fG(e,t,i){return e[0]=t[0]/i[0],e[1]=t[1]/i[1],e[2]=t[2]/i[2],e}function L1e(e,t){return e[0]=Math.ceil(t[0]),e[1]=Math.ceil(t[1]),e[2]=Math.ceil(t[2]),e}function O1e(e,t){return e[0]=Math.floor(t[0]),e[1]=Math.floor(t[1]),e[2]=Math.floor(t[2]),e}function R1e(e,t){return e[0]=Math.abs(t[0]),e[1]=Math.abs(t[1]),e[2]=Math.abs(t[2]),e}function F1e(e,t){return e[0]=Math.sign(t[0]),e[1]=Math.sign(t[1]),e[2]=Math.sign(t[2]),e}function N1e(e,t,i){return e[0]=Math.min(t[0],i[0]),e[1]=Math.min(t[1],i[1]),e[2]=Math.min(t[2],i[2]),e}function D1e(e,t,i){return e[0]=Math.max(t[0],i[0]),e[1]=Math.max(t[1],i[1]),e[2]=Math.max(t[2],i[2]),e}function j1e(e,t){return e[0]=Math.round(t[0]),e[1]=Math.round(t[1]),e[2]=Math.round(t[2]),e}function Yo(e,t,i){return e[0]=t[0]*i,e[1]=t[1]*i,e[2]=t[2]*i,e}function A0(e,t,i,r){return e[0]=t[0]+i[0]*r,e[1]=t[1]+i[1]*r,e[2]=t[2]+i[2]*r,e}function _g(e,t){const i=t[0]-e[0],r=t[1]-e[1],n=t[2]-e[2];return Math.sqrt(i*i+r*r+n*n)}function Sd(e,t){const i=t[0]-e[0],r=t[1]-e[1],n=t[2]-e[2];return i*i+r*r+n*n}function k6(e){const t=e[0],i=e[1],r=e[2];return t*t+i*i+r*r}function A6(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e}function V1e(e,t){return e[0]=1/t[0],e[1]=1/t[1],e[2]=1/t[2],e}function Ds(e,t){const i=t[0],r=t[1],n=t[2];let o=i*i+r*r+n*n;return o>0&&(o=1/Math.sqrt(o),e[0]=t[0]*o,e[1]=t[1]*o,e[2]=t[2]*o),e}function Ci(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}function is(e,t,i){const r=t[0],n=t[1],o=t[2],c=i[0],h=i[1],m=i[2];return e[0]=n*m-o*h,e[1]=o*c-r*m,e[2]=r*h-n*c,e}function yG(e,t,i,r){const n=t[0],o=t[1],c=t[2];return e[0]=n+r*(i[0]-n),e[1]=o+r*(i[1]-o),e[2]=c+r*(i[2]-c),e}function z1e(e,t,i,r,n,o){const c=o*o,h=c*(2*o-3)+1,m=c*(o-2)+o,b=c*(o-1),x=c*(3-2*o);return e[0]=t[0]*h+i[0]*m+r[0]*b+n[0]*x,e[1]=t[1]*h+i[1]*m+r[1]*b+n[1]*x,e[2]=t[2]*h+i[2]*m+r[2]*b+n[2]*x,e}function G1e(e,t,i,r,n,o){const c=1-o,h=c*c,m=o*o,b=h*c,x=3*o*h,I=3*m*c,E=m*o;return e[0]=t[0]*b+i[0]*x+r[0]*I+n[0]*E,e[1]=t[1]*b+i[1]*x+r[1]*I+n[1]*E,e[2]=t[2]*b+i[2]*x+r[2]*I+n[2]*E,e}function B1e(e,t){t=t||1;const i=Bw,r=2*i()*Math.PI,n=2*i()-1,o=Math.sqrt(1-n*n)*t;return e[0]=Math.cos(r)*o,e[1]=Math.sin(r)*o,e[2]=n*t,e}function mG(e,t,i){const r=t[0],n=t[1],o=t[2];return e[0]=i[0]*r+i[4]*n+i[8]*o+i[12],e[1]=i[1]*r+i[5]*n+i[9]*o+i[13],e[2]=i[2]*r+i[6]*n+i[10]*o+i[14],e}function U1e(e,t,i){const r=t[0],n=t[1],o=t[2];return e[0]=r*i[0]+n*i[3]+o*i[6],e[1]=r*i[1]+n*i[4]+o*i[7],e[2]=r*i[2]+n*i[5]+o*i[8],e}function P6(e,t,i){const r=i[0],n=i[1],o=i[2],c=i[3],h=t[0],m=t[1],b=t[2];let x=n*b-o*m,I=o*h-r*b,E=r*m-n*h,k=n*E-o*I,P=o*x-r*E,F=r*I-n*x;const N=2*c;return x*=N,I*=N,E*=N,k*=2,P*=2,F*=2,e[0]=h+x+k,e[1]=m+I+P,e[2]=b+E+F,e}function q1e(e,t,i,r){const n=[],o=[];return n[0]=t[0]-i[0],n[1]=t[1]-i[1],n[2]=t[2]-i[2],o[0]=n[0],o[1]=n[1]*Math.cos(r)-n[2]*Math.sin(r),o[2]=n[1]*Math.sin(r)+n[2]*Math.cos(r),e[0]=o[0]+i[0],e[1]=o[1]+i[1],e[2]=o[2]+i[2],e}function H1e(e,t,i,r){const n=[],o=[];return n[0]=t[0]-i[0],n[1]=t[1]-i[1],n[2]=t[2]-i[2],o[0]=n[2]*Math.sin(r)+n[0]*Math.cos(r),o[1]=n[1],o[2]=n[2]*Math.cos(r)-n[0]*Math.sin(r),e[0]=o[0]+i[0],e[1]=o[1]+i[1],e[2]=o[2]+i[2],e}function W1e(e,t,i,r){const n=[],o=[];return n[0]=t[0]-i[0],n[1]=t[1]-i[1],n[2]=t[2]-i[2],o[0]=n[0]*Math.cos(r)-n[1]*Math.sin(r),o[1]=n[0]*Math.sin(r)+n[1]*Math.cos(r),o[2]=n[2],e[0]=o[0]+i[0],e[1]=o[1]+i[1],e[2]=o[2]+i[2],e}function J1e(e,t){ko(t5,e),ko(i5,t),Ds(t5,t5),Ds(i5,i5);const i=Ci(t5,i5);return i>1?0:i<-1?Math.PI:Math.acos(i)}const t5=it(),i5=it();function Z1e(e){return"vec3("+e[0]+", "+e[1]+", "+e[2]+")"}function r5(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]}function n5(e,t){if(e===t)return!0;const i=e[0],r=e[1],n=e[2],o=t[0],c=t[1],h=t[2],m=Zo();return Math.abs(i-o)<=m*Math.max(1,Math.abs(i),Math.abs(o))&&Math.abs(r-c)<=m*Math.max(1,Math.abs(r),Math.abs(c))&&Math.abs(n-h)<=m*Math.max(1,Math.abs(n),Math.abs(h))}function L6(e,t,i){const r=i[0]-t[0],n=i[1]-t[1],o=i[2]-t[2];let c=r*r+n*n+o*o;return c>0?(c=1/Math.sqrt(c),e[0]=r*c,e[1]=n*c,e[2]=o*c,e):(e[0]=0,e[1]=0,e[2]=0,e)}const js=fn,K1e=dG,Y1e=fG,X1e=_g,Q1e=Sd,s5=ml,o5=k6;Object.freeze(Object.defineProperty({__proto__:null,length:ml,copy:ko,set:Nn,add:Ko,subtract:fn,multiply:dG,divide:fG,ceil:L1e,floor:O1e,abs:R1e,sign:F1e,min:N1e,max:D1e,round:j1e,scale:Yo,scaleAndAdd:A0,distance:_g,squaredDistance:Sd,squaredLength:k6,negate:A6,inverse:V1e,normalize:Ds,dot:Ci,cross:is,lerp:yG,hermite:z1e,bezier:G1e,random:B1e,transformMat4:mG,transformMat3:U1e,transformQuat:P6,rotateX:q1e,rotateY:H1e,rotateZ:W1e,angle:J1e,str:Z1e,exactEquals:r5,equals:n5,direction:L6,sub:js,mul:K1e,div:Y1e,dist:X1e,sqrDist:Q1e,len:s5,sqrLen:o5},Symbol.toStringTag,{value:"Module"}));function a5(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e}function gG(e,t,i,r,n){return e[0]=t,e[1]=i,e[2]=r,e[3]=n,e}function vG(e,t,i){return e[0]=t[0]+i[0],e[1]=t[1]+i[1],e[2]=t[2]+i[2],e[3]=t[3]+i[3],e}function bG(e,t,i){return e[0]=t[0]-i[0],e[1]=t[1]-i[1],e[2]=t[2]-i[2],e[3]=t[3]-i[3],e}function wG(e,t,i){return e[0]=t[0]*i[0],e[1]=t[1]*i[1],e[2]=t[2]*i[2],e[3]=t[3]*i[3],e}function _G(e,t,i){return e[0]=t[0]/i[0],e[1]=t[1]/i[1],e[2]=t[2]/i[2],e[3]=t[3]/i[3],e}function eve(e,t){return e[0]=Math.ceil(t[0]),e[1]=Math.ceil(t[1]),e[2]=Math.ceil(t[2]),e[3]=Math.ceil(t[3]),e}function tve(e,t){return e[0]=Math.floor(t[0]),e[1]=Math.floor(t[1]),e[2]=Math.floor(t[2]),e[3]=Math.floor(t[3]),e}function ive(e,t,i){return e[0]=Math.min(t[0],i[0]),e[1]=Math.min(t[1],i[1]),e[2]=Math.min(t[2],i[2]),e[3]=Math.min(t[3],i[3]),e}function rve(e,t,i){return e[0]=Math.max(t[0],i[0]),e[1]=Math.max(t[1],i[1]),e[2]=Math.max(t[2],i[2]),e[3]=Math.max(t[3],i[3]),e}function nve(e,t){return e[0]=Math.round(t[0]),e[1]=Math.round(t[1]),e[2]=Math.round(t[2]),e[3]=Math.round(t[3]),e}function xG(e,t,i){return e[0]=t[0]*i,e[1]=t[1]*i,e[2]=t[2]*i,e[3]=t[3]*i,e}function sve(e,t,i,r){return e[0]=t[0]+i[0]*r,e[1]=t[1]+i[1]*r,e[2]=t[2]+i[2]*r,e[3]=t[3]+i[3]*r,e}function SG(e,t){const i=t[0]-e[0],r=t[1]-e[1],n=t[2]-e[2],o=t[3]-e[3];return Math.sqrt(i*i+r*r+n*n+o*o)}function MG(e,t){const i=t[0]-e[0],r=t[1]-e[1],n=t[2]-e[2],o=t[3]-e[3];return i*i+r*r+n*n+o*o}function O6(e){const t=e[0],i=e[1],r=e[2],n=e[3];return Math.sqrt(t*t+i*i+r*r+n*n)}function R6(e){const t=e[0],i=e[1],r=e[2],n=e[3];return t*t+i*i+r*r+n*n}function ove(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e[3]=-t[3],e}function ave(e,t){return e[0]=1/t[0],e[1]=1/t[1],e[2]=1/t[2],e[3]=1/t[3],e}function IG(e,t){const i=t[0],r=t[1],n=t[2],o=t[3];let c=i*i+r*r+n*n+o*o;return c>0&&(c=1/Math.sqrt(c),e[0]=i*c,e[1]=r*c,e[2]=n*c,e[3]=o*c),e}function $G(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]+e[3]*t[3]}function l5(e,t,i,r){const n=t[0],o=t[1],c=t[2],h=t[3];return e[0]=n+r*(i[0]-n),e[1]=o+r*(i[1]-o),e[2]=c+r*(i[2]-c),e[3]=h+r*(i[3]-h),e}function lve(e,t){const i=Bw;let r,n,o,c,h,m;t=t||1;do r=2*i()-1,n=2*i()-1,h=r*r+n*n;while(h>=1);do o=2*i()-1,c=2*i()-1,m=o*o+c*c;while(m>=1);const b=Math.sqrt((1-h)/m);return e[0]=t*r,e[1]=t*n,e[2]=t*o*b,e[3]=t*c*b,e}function cve(e,t,i){const r=t[0],n=t[1],o=t[2],c=t[3];return e[0]=i[0]*r+i[4]*n+i[8]*o+i[12]*c,e[1]=i[1]*r+i[5]*n+i[9]*o+i[13]*c,e[2]=i[2]*r+i[6]*n+i[10]*o+i[14]*c,e[3]=i[3]*r+i[7]*n+i[11]*o+i[15]*c,e}function uve(e,t,i){const r=t[0],n=t[1],o=t[2],c=i[0],h=i[1],m=i[2],b=i[3],x=b*r+h*o-m*n,I=b*n+m*r-c*o,E=b*o+c*n-h*r,k=-c*r-h*n-m*o;return e[0]=x*b+k*-c+I*-m-E*-h,e[1]=I*b+k*-h+E*-c-x*-m,e[2]=E*b+k*-m+x*-h-I*-c,e[3]=t[3],e}function hve(e){return"vec4("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+")"}function EG(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]}function F6(e,t){const i=e[0],r=e[1],n=e[2],o=e[3],c=t[0],h=t[1],m=t[2],b=t[3],x=Zo();return Math.abs(i-c)<=x*Math.max(1,Math.abs(i),Math.abs(c))&&Math.abs(r-h)<=x*Math.max(1,Math.abs(r),Math.abs(h))&&Math.abs(n-m)<=x*Math.max(1,Math.abs(n),Math.abs(m))&&Math.abs(o-b)<=x*Math.max(1,Math.abs(o),Math.abs(b))}const pve=bG,dve=wG,fve=_G,yve=SG,mve=MG,gve=O6,vve=R6;Object.freeze(Object.defineProperty({__proto__:null,copy:a5,set:gG,add:vG,subtract:bG,multiply:wG,divide:_G,ceil:eve,floor:tve,min:ive,max:rve,round:nve,scale:xG,scaleAndAdd:sve,distance:SG,squaredDistance:MG,length:O6,squaredLength:R6,negate:ove,inverse:ave,normalize:IG,dot:$G,lerp:l5,random:lve,transformMat4:cve,transformQuat:uve,str:hve,exactEquals:EG,equals:F6,sub:pve,mul:dve,div:fve,dist:yve,sqrDist:mve,len:gve,sqrLen:vve},Symbol.toStringTag,{value:"Module"}));const TG=new Float32Array(1);function yWe(e){--e;for(let t=1;t<32;t<<=1)e|=e>>t;return e+1}function Vs(e,t,i){return Math.min(Math.max(e,t),i)}function mWe(e){return(e&e-1)==0}function gWe(e){return e--,e|=e>>1,e|=e>>2,e|=e>>4,e|=e>>8,e|=e>>16,++e}function vWe(e,t,i){return e+(t-e)*i}function xg(e){return e*Math.PI/180}function N6(e){return 180*e/Math.PI}function bWe(e,t=1e-6){return(e<0?-1:1)/Math.max(Math.abs(e),t)}function D6(e){return Math.acos(Vs(e,-1,1))}function CG(e){return Math.asin(Vs(e,-1,1))}function La(e,t,i=1e-6){return e===t?!0:!Number.isFinite(e)||!Number.isFinite(t)?!1:(e>t?e-t:t-e)<=i}const c5=new DataView(new ArrayBuffer(Float64Array.BYTES_PER_ELEMENT));function bve(e){return c5.setFloat64(0,e),c5.getBigInt64(0)}function wve(e){return c5.setBigInt64(0,e),c5.getFloat64(0)}const j6=BigInt("1000000");_ve(1);function _ve(e){const t=bve(e=Math.abs(e)),i=wve(t<=j6?j6:t-j6);return Math.abs(e-i)}function xve(e,t,i=1e-6){if(e===t)return!0;if(!Number.isFinite(e)||!Number.isFinite(t))return!1;const r=Math.abs(e-t),n=Math.abs(e),o=Math.abs(t);if(e===0||t===0||n<1e-12&&o<1e-12){if(r>.01*i)return!1}else if(r/(n+o)>i)return!1;return!0}function Sve(e){return kG(Math.max(-V6,Math.min(e,V6)))}function kG(e){return TG[0]=e,TG[0]}function AG(e,t){const i=ml(e),r=CG(e[2]/i),n=Math.atan2(e[1]/i,e[0]/i);return Nn(t,i,r,n),t}function wWe(e){const t=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],i=e[3]*e[3]+e[4]*e[4]+e[5]*e[5],r=e[6]*e[6]+e[7]*e[7]+e[8]*e[8];return!(La(t,1)&&La(i,1)&&La(r,1))}const V6=kG(34028234663852886e22);function u5(e){return Vs(iS(e),0,255)}function h5(e,t,i){return e=Number(e),isNaN(e)?i:e<t?t:e>i?i:e}class In{constructor(t){this.r=255,this.g=255,this.b=255,this.a=1,t&&this.setColor(t)}static blendColors(t,i,r,n=new In){return n.r=Math.round(t.r+(i.r-t.r)*r),n.g=Math.round(t.g+(i.g-t.g)*r),n.b=Math.round(t.b+(i.b-t.b)*r),n.a=t.a+(i.a-t.a)*r,n._sanitize()}static fromRgb(t,i){const r=t.toLowerCase().match(/^(rgba?|hsla?)\(([\s\.\-,%0-9]+)\)/);if(r){const n=r[2].split(/\s*,\s*/),o=r[1];if(o==="rgb"&&n.length===3||o==="rgba"&&n.length===4){const c=n[0];if(c.charAt(c.length-1)==="%"){const h=n.map(m=>2.56*parseFloat(m));return n.length===4&&(h[3]=parseFloat(n[3])),In.fromArray(h,i)}return In.fromArray(n.map(h=>parseFloat(h)),i)}if(o==="hsl"&&n.length===3||o==="hsla"&&n.length===4)return In.fromArray(nG(parseFloat(n[0]),parseFloat(n[1])/100,parseFloat(n[2])/100,parseFloat(n[3])),i)}return null}static fromHex(t,i=new In){if(t.length!==4&&t.length!==7||t[0]!=="#")return null;const r=t.length===4?4:8,n=(1<<r)-1;let o=Number("0x"+t.substr(1));return isNaN(o)?null:(["b","g","r"].forEach(c=>{const h=o&n;o>>=r,i[c]=r===4?17*h:h}),i.a=1,i)}static fromArray(t,i=new In){return i._set(Number(t[0]),Number(t[1]),Number(t[2]),Number(t[3])),isNaN(i.a)&&(i.a=1),i._sanitize()}static fromString(t,i){const r=rG(t)?$6(t):null;return r&&In.fromArray(r,i)||In.fromRgb(t,i)||In.fromHex(t,i)}static fromJSON(t){return t&&new In([t[0],t[1],t[2],t[3]/255])}static toUnitRGB(t){return H(t)?[t.r/255,t.g/255,t.b/255]:null}static toUnitRGBA(t){return H(t)?[t.r/255,t.g/255,t.b/255,t.a!=null?t.a:1]:null}get isBright(){return .299*this.r+.587*this.g+.114*this.b>=127}setColor(t){var i,r,n,o;return typeof t=="string"?In.fromString(t,this):Array.isArray(t)?In.fromArray(t,this):(this._set((i=t.r)!=null?i:0,(r=t.g)!=null?r:0,(n=t.b)!=null?n:0,(o=t.a)!=null?o:1),t instanceof In||this._sanitize()),this}toRgb(){return[this.r,this.g,this.b]}toRgba(){return[this.r,this.g,this.b,this.a]}toHex(){const t=this.r.toString(16),i=this.g.toString(16),r=this.b.toString(16);return`#${t.length<2?"0"+t:t}${i.length<2?"0"+i:i}${r.length<2?"0"+r:r}`}toCss(t=!1){const i=this.r+", "+this.g+", "+this.b;return t?`rgba(${i}, ${this.a})`:`rgb(${i})`}toString(){return this.toCss(!0)}toJSON(){return this.toArray()}toArray(t=In.AlphaMode.ALWAYS){const i=u5(this.r),r=u5(this.g),n=u5(this.b);return t===In.AlphaMode.ALWAYS||this.a!==1?[i,r,n,u5(255*this.a)]:[i,r,n]}clone(){return new In(this.toRgba())}hash(){return this.r<<24|this.g<<16|this.b<<8|255*this.a}equals(t){return H(t)&&t.r===this.r&&t.g===this.g&&t.b===this.b&&t.a===this.a}_sanitize(){return this.r=Math.round(h5(this.r,0,255)),this.g=Math.round(h5(this.g,0,255)),this.b=Math.round(h5(this.b,0,255)),this.a=h5(this.a,0,1),this}_set(t,i,r,n){this.r=t,this.g=i,this.b=r,this.a=n}}In.prototype.declaredClass="esri.Color",function(e){var t;(t=e.AlphaMode||(e.AlphaMode={}))[t.ALWAYS=0]="ALWAYS",t[t.UNLESS_OPAQUE=1]="UNLESS_OPAQUE"}(In||(In={}));const ut=In,PG=new kt({esriSMS:"simple-marker",esriPMS:"picture-marker",esriSLS:"simple-line",esriSFS:"simple-fill",esriPFS:"picture-fill",esriTS:"text",esriSHD:"shield-label-symbol",PointSymbol3D:"point-3d",LineSymbol3D:"line-3d",PolygonSymbol3D:"polygon-3d",WebStyleSymbol:"web-style",MeshSymbol3D:"mesh-3d",LabelSymbol3D:"label-3d",CIMSymbolReference:"cim"});let Mve=0,Sg=class extends ke{constructor(e){super(e),this.id="sym"+Mve++,this.type=null,this.color=new ut([0,0,0,1])}readColor(e){return e&&e[0]!=null?[e[0],e[1],e[2],e[3]/255]:e}async collectRequiredFields(e,t){}hash(){return JSON.stringify(this.toJSON())}clone(){}};g([w({type:PG.apiValues,readOnly:!0,json:{read:!1,write:{ignoreOrigin:!0,writer:PG.write}}})],Sg.prototype,"type",void 0),g([w({type:ut,json:{write:{allowNull:!0}}})],Sg.prototype,"color",void 0),g([We("color")],Sg.prototype,"readColor",null),Sg=g([te("esri.symbols.Symbol")],Sg);const Ao=Sg;var z6;let Md=z6=class extends Ao{constructor(e){super(e),this.data=null,this.type="cim"}readData(e,t){return t}writeData(e,t){if(e)for(const i in e)t[i]=e[i]}async collectRequiredFields(e,t){var i;if(((i=this.data)==null?void 0:i.type)==="CIMSymbolReference"){const r=this.data.primitiveOverrides;if(r){const n=r.map(o=>{const c=o.valueExpressionInfo;return Co(e,t,c.expression)});await Promise.all(n)}}}clone(){return new z6({data:_e(this.data)})}hash(){return qE(JSON.stringify(this.data)).toString()}};g([w({json:{write:!1}})],Md.prototype,"color",void 0),g([w({json:{write:!0}})],Md.prototype,"data",void 0),g([We("data",["symbol"])],Md.prototype,"readData",null),g([tt("data",{})],Md.prototype,"writeData",null),g([Pt({CIMSymbolReference:"cim"},{readOnly:!0})],Md.prototype,"type",void 0),Md=z6=g([te("esri.symbols.CIMSymbol")],Md);const Id=Md;let Mg=class extends ke{constructor(e){super(e),this.enabled=!0,this.type=null}writeEnabled(e,t,i){e||(t[i]=e)}};g([w({type:Boolean,json:{read:{source:"enable"},write:{target:"enable"}}})],Mg.prototype,"enabled",void 0),g([tt("enabled")],Mg.prototype,"writeEnabled",null),g([w({type:["icon","object","line","path","fill","water","extrude","text"],readOnly:!0})],Mg.prototype,"type",void 0),Mg=g([te("esri.symbols.Symbol3DLayer")],Mg);const ou=Mg,Ive=/^-?(\d+(\.\d+)?)\s*((px)|(pt))?$/i,$ve="screenUtils.toPt: input not recognized!",LG=96;function or(e){return e?e/72*LG:0}function $n(e){return e?72*e/LG:0}function Fi(e){if(typeof e=="string"){const t=e.match(Ive);if(t){const i=Number(t[1]),r=t[3]&&t[3].toLowerCase(),n=e.charAt(0)==="-",o=r==="px"?$n(i):i;return n?-o:o}return console.warn($ve),null}return e}function yn(e=0,t=0){return{x:e,y:t}}function Uw(e=0,t=0){return[e,t]}function _We(e=0,t=0,i=0){return Eve([e,t,i])}function xWe(e){return e}function Eve(e){return e}function SWe(e){return e}function MWe(e,t){return t?(t[0]=e.x,t[1]=e.y,t.length>2&&(t[2]=0),t):[e.x,e.y]}function p5(e){const t=iS(100*(1-e));return Math.max(0,Math.min(t,100))}function qw(e){const t=1-e/100;return Math.max(0,Math.min(t,1))}function Tve(e,t){const i=t.transparency!=null?qw(t.transparency):1,r=t.color;return r&&Array.isArray(r)?new ut([r[0]||0,r[1]||0,r[2]||0,i]):null}function Cve(e,t){t.color=e.toJSON().slice(0,3);const i=p5(e.a);i!==0&&(t.transparency=i)}const $d={type:ut,json:{type:[Ri],default:null,read:{source:["color","transparency"],reader:Tve},write:{target:{color:{type:[Ri]},transparency:{type:Ri}},writer:Cve}}},au={type:Number,cast:Fi,json:{write:!0}};let P0=class extends ke{constructor(e){super(e),this.color=new ut([0,0,0,1]),this.extensionLength=0,this.size=$n(1)}clone(){}cloneProperties(){return{color:_e(this.color),size:this.size,extensionLength:this.extensionLength}}};g([w({type:["solid","sketch"],readOnly:!0,json:{read:!0,write:{ignoreOrigin:!0}}})],P0.prototype,"type",void 0),g([w($d)],P0.prototype,"color",void 0),g([w(Ce(K({},au),{json:{write:{overridePolicy:e=>({enabled:!!e})}}}))],P0.prototype,"extensionLength",void 0),g([w(au)],P0.prototype,"size",void 0),P0=g([te("esri.symbols.edges.Edges3D")],P0);const G6=P0;var B6;let d5=B6=class extends G6{constructor(e){super(e),this.type="sketch"}clone(){return new B6(this.cloneProperties())}};g([Pt({sketch:"sketch"},{readOnly:!0})],d5.prototype,"type",void 0),d5=B6=g([te("esri.symbols.edges.SketchEdges3D")],d5);const kve=d5;var U6;let f5=U6=class extends G6{constructor(e){super(e),this.type="solid"}clone(){return new U6(this.cloneProperties())}};g([Pt({solid:"solid"},{readOnly:!0})],f5.prototype,"type",void 0),f5=U6=g([te("esri.symbols.support.SolidEdges3D")],f5);const Ave=f5,OG={types:{key:"type",base:G6,typeMap:{solid:Ave,sketch:kve}},json:{write:!0}};var q6;let Oa=q6=class extends ke{constructor(e){super(e),this.color=null}clone(){const e={color:H(this.color)?this.color.clone():null};return new q6(e)}};g([w($d)],Oa.prototype,"color",void 0),Oa=q6=g([te("esri.symbols.support.Symbol3DMaterial")],Oa);var H6;let Ed=H6=class extends ou{constructor(e){super(e),this.type="extrude",this.size=1,this.material=null,this.castShadows=!0,this.edges=null}clone(){return new H6({edges:this.edges&&this.edges.clone(),enabled:this.enabled,material:H(this.material)?this.material.clone():null,castShadows:this.castShadows,size:this.size})}};g([Pt({Extrude:"extrude"},{readOnly:!0})],Ed.prototype,"type",void 0),g([w({type:Number,json:{write:{enabled:!0,isRequired:!0}},nonNullable:!0})],Ed.prototype,"size",void 0),g([w({type:Oa,json:{write:!0}})],Ed.prototype,"material",void 0),g([w({type:Boolean,nonNullable:!0,json:{write:!0,default:!0}})],Ed.prototype,"castShadows",void 0),g([w(OG)],Ed.prototype,"edges",void 0),Ed=H6=g([te("esri.symbols.ExtrudeSymbol3DLayer")],Ed);const RG=Ed;let Hw=class extends Ao{constructor(e){super(e),this.type="simple-line",this.width=.75}hash(){return`${this.type}.${this.width}`}};g([Pt({esriSLS:"simple-line"},{readOnly:!0})],Hw.prototype,"type",void 0),g([w({type:Number,cast:Fi,json:{write:!0}})],Hw.prototype,"width",void 0),Hw=g([te("esri.symbols.LineSymbol")],Hw);const Pve=Hw,Lve=["begin","end","begin-end"],FG=["arrow","circle","square","diamond","cross","x"];var W6;let lu=W6=class extends ke{constructor(e){super(e),this.placement="begin-end",this.type="line-marker",this.style="arrow"}writeStyle(e,t,i,r){t[i]=(r==null?void 0:r.origin)==="web-map"?"arrow":e}set color(e){this._set("color",e)}readColor(e){return e&&e[0]!=null?[e[0],e[1],e[2],e[3]/255]:e}writeColor(e,t,i,r){(r==null?void 0:r.origin)==="web-map"||(t[i]=e)}clone(){return new W6({color:_e(this.color),placement:this.placement,style:this.style})}hash(){var e;return`${this.placement}.${(e=this.color)==null?void 0:e.hash()}.${this.style}`}};g([w({type:["begin","end","begin-end"],json:{write:!0}})],lu.prototype,"placement",void 0),g([Pt({"line-marker":"line-marker"},{readOnly:!0}),w({json:{origins:{"web-map":{write:!1}}}})],lu.prototype,"type",void 0),g([w({type:FG})],lu.prototype,"style",void 0),g([tt("style")],lu.prototype,"writeStyle",null),g([w({type:ut,value:null,json:{write:{allowNull:!0}}})],lu.prototype,"color",null),g([We("color")],lu.prototype,"readColor",null),g([tt("color")],lu.prototype,"writeColor",null),lu=W6=g([te("esri.symbols.LineSymbolMarker")],lu);const Ove=lu;var J6;const Z6=new kt({esriSLSSolid:"solid",esriSLSDash:"dash",esriSLSDot:"dot",esriSLSDashDot:"dash-dot",esriSLSDashDotDot:"long-dash-dot-dot",esriSLSNull:"none",esriSLSInsideFrame:"inside-frame",esriSLSShortDash:"short-dash",esriSLSShortDot:"short-dot",esriSLSShortDashDot:"short-dash-dot",esriSLSShortDashDotDot:"short-dash-dot-dot",esriSLSLongDash:"long-dash",esriSLSLongDashDot:"long-dash-dot"});let Sh=J6=class extends Pve{constructor(...e){super(...e),this.type="simple-line",this.style="solid",this.cap="round",this.join="round",this.marker=null,this.miterLimit=2}normalizeCtorArgs(e,t,i,r,n,o){if(e&&typeof e!="string")return e;const c={};return e!=null&&(c.style=e),t!=null&&(c.color=t),i!=null&&(c.width=Fi(i)),r!=null&&(c.cap=r),n!=null&&(c.join=n),o!=null&&(c.miterLimit=Fi(o)),c}clone(){var e;return new J6({color:_e(this.color),style:this.style,width:this.width,cap:this.cap,join:this.join,miterLimit:this.miterLimit,marker:(e=this.marker)==null?void 0:e.clone()})}hash(){var e,t;return`${super.hash()}.${(e=this.color)==null?void 0:e.hash()}.${this.style}.${this.cap}.${this.join}.${this.miterLimit}.${(t=this.marker)==null?void 0:t.hash()}`}};g([Pt({esriSLS:"simple-line"},{readOnly:!0})],Sh.prototype,"type",void 0),g([w({type:Z6.apiValues,json:{read:Z6.read,write:Z6.write}})],Sh.prototype,"style",void 0),g([w({type:["butt","round","square"],json:{write:{overridePolicy:(e,t,i)=>({enabled:e!=="round"&&(i==null||i.origin==null)})}}})],Sh.prototype,"cap",void 0),g([w({type:["miter","round","bevel"],json:{write:{overridePolicy:(e,t,i)=>({enabled:e!=="round"&&(i==null||i.origin==null)})}}})],Sh.prototype,"join",void 0),g([w({types:{key:"type",base:null,defaultKeyValue:"line-marker",typeMap:{"line-marker":Ove}},json:{write:!0,origins:{"web-scene":{write:!1}}}})],Sh.prototype,"marker",void 0),g([w({type:Number,json:{read:!1,write:!1}})],Sh.prototype,"miterLimit",void 0),Sh=J6=g([te("esri.symbols.SimpleLineSymbol")],Sh);const rs=Sh;let Ww=class extends Ao{constructor(e){super(e),this.outline=null,this.type=null}hash(){return`${this.type}.${this.outline&&this.outline.hash()}`}};g([w({types:{key:"type",base:null,defaultKeyValue:"simple-line",typeMap:{"simple-line":rs}},json:{default:null,write:!0}})],Ww.prototype,"outline",void 0),g([w({type:["simple-fill","picture-fill"],readOnly:!0})],Ww.prototype,"type",void 0),Ww=g([te("esri.symbols.FillSymbol")],Ww);const NG=Ww;let y5=class extends ke{constructor(e){super(e)}clone(){}};g([w({type:["style"],readOnly:!0,json:{read:!0,write:{ignoreOrigin:!0}}})],y5.prototype,"type",void 0),y5=g([te("esri.symbols.patterns.LinePattern3D")],y5);const DG=y5,Rve=["dash","dash-dot","dot","long-dash","long-dash-dot","long-dash-dot-dot","none","short-dash","short-dash-dot","short-dash-dot-dot","short-dot","solid"];var K6;const Fve=Ns()({dash:"dash","dash-dot":"dash-dot","dash-dot-dot":"long-dash-dot-dot",dot:"dot","long-dash":"long-dash","long-dash-dot":"long-dash-dot",null:"none","short-dash":"short-dash","short-dash-dot":"short-dash-dot","short-dash-dot-dot":"short-dash-dot-dot","short-dot":"short-dot",solid:"solid"});let Jw=K6=class extends DG{constructor(e){super(e),this.type="style",this.style="solid"}clone(){const e={style:this.style};return new K6(e)}};g([w({type:["style"]})],Jw.prototype,"type",void 0),g([Pt(Fve),w({type:Rve})],Jw.prototype,"style",void 0),Jw=K6=g([te("esri.symbols.patterns.LineStylePattern3D")],Jw);const Y6=Jw;let m5=class extends ke{constructor(e){super(e)}clone(){}};g([w({type:["style"],readOnly:!0,json:{read:!0,write:{ignoreOrigin:!0}}})],m5.prototype,"type",void 0),m5=g([te("esri.symbols.patterns.Pattern3D")],m5);const jG=m5,Nve=["backward-diagonal","cross","diagonal-cross","forward-diagonal","horizontal","none","solid","vertical"];var X6;let Zw=X6=class extends jG{constructor(e){super(e),this.type="style",this.style="solid"}clone(){const e={style:this.style};return new X6(e)}};g([w({type:["style"]})],Zw.prototype,"type",void 0),g([w({type:Nve,json:{read:!0,write:!0}})],Zw.prototype,"style",void 0),Zw=X6=g([te("esri.symbols.patterns.StylePattern3D")],Zw);const VG=Zw,Dve={types:{key:"type",base:jG,typeMap:{style:VG}},json:{write:!0}},zG={types:{key:"type",base:DG,typeMap:{style:Y6}},json:{write:!0}},Kw=new ut("white");new ut("black");const jve=new ut([255,255,255,0]);function Vve(e){return e.r===0&&e.g===0&&e.b===0}var Q6;let Yw=Q6=class extends Oa{constructor(e){super(e),this.colorMixMode=null}clone(){const e={color:H(this.color)?this.color.clone():null,colorMixMode:this.colorMixMode};return new Q6(e)}};g([Pt({multiply:"multiply",replace:"replace",tint:"tint"})],Yw.prototype,"colorMixMode",void 0),Yw=Q6=g([te("esri.symbols.support.Symbol3DFillMaterial")],Yw);function g5(e){return e}function ro(e=Jve){return g5([e[0],e[1],e[2],e[3]])}function IWe(e){return g5([e[0],e[1],e[2],e[3]])}function eC(e,t){return e!==t&&(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3]),e}function $We(e,t,i,r,n=ro()){return n[0]=e,n[1]=t,n[2]=i,n[3]=r,n}function zve(e,t=ro()){return t[0]=e.xmin,t[1]=e.ymin,t[2]=e.xmax,t[3]=e.ymax,t}function EWe(e,t){return new gi({xmin:e[0],ymin:e[1],xmax:e[2],ymax:e[3],spatialReference:t})}function TWe(e,t){t[0]<e[0]&&(e[0]=t[0]),t[0]>e[2]&&(e[2]=t[0]),t[1]<e[1]&&(e[1]=t[1]),t[1]>e[3]&&(e[3]=t[1])}function CWe(e,t,i){if(ce(t))eC(i,e);else if("length"in t)iC(t)?(i[0]=Math.min(e[0],t[0]),i[1]=Math.min(e[1],t[1]),i[2]=Math.max(e[2],t[2]),i[3]=Math.max(e[3],t[3])):t.length!==2&&t.length!==3||(i[0]=Math.min(e[0],t[0]),i[1]=Math.min(e[1],t[1]),i[2]=Math.max(e[2],t[0]),i[3]=Math.max(e[3],t[1]));else switch(t.type){case"extent":i[0]=Math.min(e[0],t.xmin),i[1]=Math.min(e[1],t.ymin),i[2]=Math.max(e[2],t.xmax),i[3]=Math.max(e[3],t.ymax);break;case"point":i[0]=Math.min(e[0],t.x),i[1]=Math.min(e[1],t.y),i[2]=Math.max(e[2],t.x),i[3]=Math.max(e[3],t.y)}}function tC(e,t,i=e){const r=t.length;let n=e[0],o=e[1],c=e[2],h=e[3];for(let m=0;m<r;m++){const b=t[m];n=Math.min(n,b[0]),o=Math.min(o,b[1]),c=Math.max(c,b[0]),h=Math.max(h,b[1])}return i[0]=n,i[1]=o,i[2]=c,i[3]=h,i}function kWe(e){for(let t=0;t<4;t++)if(!isFinite(e[t]))return!1;return!0}function Gve(e){return ce(e)||e[0]>=e[2]?0:e[2]-e[0]}function Bve(e){return e[1]>=e[3]?0:e[3]-e[1]}function AWe(e){return Gve(e)*Bve(e)}function PWe(e,t=[0,0]){return t[0]=(e[0]+e[2])/2,t[1]=(e[1]+e[3])/2,t}function Uve(e,t){return GG(e,t[0],t[1])}function LWe(e,t){return GG(e,t.x,t.y)}function GG(e,t,i){return t>=e[0]&&i>=e[1]&&t<=e[2]&&i<=e[3]}function qve(e,t,i){return t[0]>=e[0]-i&&t[1]>=e[1]-i&&t[0]<=e[2]+i&&t[1]<=e[3]+i}function OWe(e,t){return Math.max(t[0],e[0])<=Math.min(t[2],e[2])&&Math.max(t[1],e[1])<=Math.min(t[3],e[3])}function Hve(e,t){return t[0]>=e[0]&&t[2]<=e[2]&&t[1]>=e[1]&&t[3]<=e[3]}function RWe(e,t,i,r=e){return r[0]=e[0]+t,r[1]=e[1]+i,r[2]=e[2]+t,r[3]=e[3]+i,r}function Wve(e){return e?eC(e,BG):ro(BG)}function iC(e){return e!=null&&e.length===4}function FWe(e,t){return iC(e)&&iC(t)?e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]:e===t}const BG=g5([1/0,1/0,-1/0,-1/0]),Jve=g5([0,0,0,0]);function rC(e){return e}function v5(e=Xve){return rC([e[0],e[1],e[2],e[3],e[4],e[5]])}function nC(e,t,i,r,n,o,c=v5()){return c[0]=e,c[1]=t,c[2]=i,c[3]=r,c[4]=n,c[5]=o,c}function NWe(e,t){const i=isFinite(e[2])||isFinite(e[5]);return new gi(i?{xmin:e[0],xmax:e[3],ymin:e[1],ymax:e[4],zmin:e[2],zmax:e[5],spatialReference:t}:{xmin:e[0],xmax:e[3],ymin:e[1],ymax:e[4],spatialReference:t})}function DWe(e,t){e[0]=Math.min(e[0],t[0]),e[1]=Math.min(e[1],t[1]),e[2]=Math.min(e[2],t[2]),e[3]=Math.max(e[3],t[3]),e[4]=Math.max(e[4],t[4]),e[5]=Math.max(e[5],t[5])}function jWe(e,t){e[0]=Math.min(e[0],t[0]),e[1]=Math.min(e[1],t[1]),e[3]=Math.max(e[3],t[2]),e[4]=Math.max(e[4],t[3])}function VWe(e,t){e[0]=Math.min(e[0],t[0]),e[1]=Math.min(e[1],t[1]),e[2]=Math.min(e[2],t[2]),e[3]=Math.max(e[3],t[0]),e[4]=Math.max(e[4],t[1]),e[5]=Math.max(e[5],t[2])}function zWe(e,t,i=0,r=t.length/3){let n=e[0],o=e[1],c=e[2],h=e[3],m=e[4],b=e[5];for(let x=0;x<r;x++)n=Math.min(n,t[i+3*x]),o=Math.min(o,t[i+3*x+1]),c=Math.min(c,t[i+3*x+2]),h=Math.max(h,t[i+3*x]),m=Math.max(m,t[i+3*x+1]),b=Math.max(b,t[i+3*x+2]);e[0]=n,e[1]=o,e[2]=c,e[3]=h,e[4]=m,e[5]=b}function sC(e,t,i){const r=t.length;let n=e[0],o=e[1],c=e[2],h=e[3],m=e[4],b=e[5];if(i)for(let x=0;x<r;x++){const I=t[x];n=Math.min(n,I[0]),o=Math.min(o,I[1]),c=Math.min(c,I[2]),h=Math.max(h,I[0]),m=Math.max(m,I[1]),b=Math.max(b,I[2])}else for(let x=0;x<r;x++){const I=t[x];n=Math.min(n,I[0]),o=Math.min(o,I[1]),h=Math.max(h,I[0]),m=Math.max(m,I[1])}e[0]=n,e[1]=o,e[2]=c,e[3]=h,e[4]=m,e[5]=b}function GWe(e){for(let t=0;t<6;t++)if(!isFinite(e[t]))return!1;return!0}function Xw(e){return e[0]>=e[3]?0:e[3]-e[0]}function Qw(e){return e[1]>=e[4]?0:e[4]-e[1]}function e_(e){return e[2]>=e[5]?0:e[5]-e[2]}function BWe(e){const t=Xw(e),i=e_(e),r=Qw(e);return Math.sqrt(t*t+i*i+r*r)}function UWe(e,t=[0,0,0]){return t[0]=e[0]+Xw(e)/2,t[1]=e[1]+Qw(e)/2,t[2]=e[2]+e_(e)/2,t}function qWe(e,t=[0,0,0]){return t[0]=Xw(e),t[1]=Qw(e),t[2]=e_(e),t}function HWe(e,t){return t[0]>=e[0]&&t[1]>=e[1]&&t[2]>=e[2]&&t[0]<=e[3]&&t[1]<=e[4]&&t[2]<=e[5]}function Zve(e,t){return Math.max(t[0],e[0])<=Math.min(t[3],e[3])&&Math.max(t[1],e[1])<=Math.min(t[4],e[4])&&Math.max(t[2],e[2])<=Math.min(t[5],e[5])}function WWe(e,t){return!!ce(t)||Zve(e,t)}function JWe(e,t,i,r,n=e){return n[0]=e[0]+t,n[1]=e[1]+i,n[2]=e[2]+r,n[3]=e[3]+t,n[4]=e[4]+i,n[5]=e[5]+r,n}function ZWe(e,t,i=e){const r=e[0]+Xw(e)/2,n=e[1]+Qw(e)/2,o=e[2]+e_(e)/2;return i[0]=r+(e[0]-r)*t,i[1]=n+(e[1]-n)*t,i[2]=o+(e[2]-o)*t,i[3]=r+(e[3]-r)*t,i[4]=n+(e[4]-n)*t,i[5]=o+(e[5]-o)*t,i}function KWe(e,t){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t}function YWe(e,t,i=e){return i[0]=t[0],i[1]=t[1],i[2]=t[2],i!==e&&(i[3]=e[3],i[4]=e[4],i[5]=e[5]),i}function XWe(e,t,i=e){return i[3]=t[0],i[4]=t[1],i[5]=t[2],i!==e&&(i[0]=e[0],i[1]=e[1],i[2]=e[2]),e}function Kve(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e}function Yve(e){return e?Kve(e,qG):v5(qG)}function QWe(e,t){return t||(t=ro()),t[0]=e[0],t[1]=e[1],t[2]=e[3],t[3]=e[4],t}function eJe(e,t){return e[0]=t[0],e[1]=t[1],e[2]=Number.NEGATIVE_INFINITY,e[3]=t[2],e[4]=t[3],e[5]=Number.POSITIVE_INFINITY,e}function UG(e){return e.length===6}function tJe(e){return Xw(e)===0&&Qw(e)===0&&e_(e)===0}function iJe(e,t,i){if(ce(e)||ce(t))return e===t;if(!UG(e)||!UG(t))return!1;if(i){for(let r=0;r<e.length;r++)if(!i(e[r],t[r]))return!1}else for(let r=0;r<e.length;r++)if(e[r]!==t[r])return!1;return!0}const qG=rC([1/0,1/0,1/0,-1/0,-1/0,-1/0]),Xve=rC([0,0,0,0,0,0]);v5();function rJe(e,{isPrimitive:t,width:i,depth:r,height:n}){const o=t?10:1;if(i==null&&n==null&&r==null)return[o*e[0],o*e[1],o*e[2]];const c=Mn(i,r,n);let h;for(let m=0;m<3;m++){const b=c[m];if(b!=null){h=b/e[m];break}}for(let m=0;m<3;m++)c[m]==null&&(c[m]=e[m]*h);return c}const Qve=nC(-.5,-.5,-.5,.5,.5,.5),ebe=nC(-.5,-.5,0,.5,.5,1),tbe=nC(-.5,-.5,0,.5,.5,.5);function nJe(e){switch(e){case"sphere":case"cube":case"diamond":return Qve;case"cylinder":case"cone":case"inverted-cone":return ebe;case"tetrahedron":return tbe;default:return}}const oC=["butt","square","round"],ibe=[...oC,"none"],HG=["miter","bevel","round"];var aC;let L0=aC=class extends ke{constructor(e){super(e),this.color=new ut([0,0,0,1]),this.size=$n(1),this.pattern=null,this.patternCap="butt"}clone(){const e={color:H(this.color)?this.color.clone():null,size:this.size,pattern:H(this.pattern)?this.pattern.clone():null,patternCap:this.patternCap};return new aC(e)}};g([w($d)],L0.prototype,"color",void 0),g([w(au)],L0.prototype,"size",void 0),g([w(zG)],L0.prototype,"pattern",void 0),g([w({type:oC,json:{default:"butt",write:{overridePolicy(){return{enabled:H(this.pattern)}}}}})],L0.prototype,"patternCap",void 0),L0=aC=g([te("esri.symbols.support.Symbol3DOutline")],L0);var b5;let Mh=b5=class extends ou{constructor(e){super(e),this.type="fill",this.material=null,this.pattern=null,this.castShadows=!0,this.outline=null,this.edges=null}clone(){const e={edges:H(this.edges)?this.edges.clone():null,enabled:this.enabled,material:H(this.material)?this.material.clone():null,pattern:H(this.pattern)?this.pattern.clone():null,castShadows:this.castShadows,outline:H(this.outline)?this.outline.clone():null};return new b5(e)}static fromSimpleFillSymbol(e){var r,n,o,c,h,m;const t=e.outline&&e.outline.style&&e.outline.style!=="inside-frame"&&e.outline.style!=="solid"?new Y6({style:e.outline.style}):null,i={size:(n=(r=e.outline)==null?void 0:r.width)!=null?n:0,color:((c=(o=e.outline)==null?void 0:o.color)!=null?c:Kw).clone(),pattern:t};return t&&((h=e.outline)==null?void 0:h.cap)&&(i.patternCap=e.outline.cap),new b5({material:new Yw({color:((m=e.color)!=null?m:jve).clone()}),pattern:e.style&&e.style!=="solid"?new VG({style:e.style}):null,outline:i})}};g([Pt({Fill:"fill"},{readOnly:!0})],Mh.prototype,"type",void 0),g([w({type:Yw,json:{write:!0}})],Mh.prototype,"material",void 0),g([w(Dve)],Mh.prototype,"pattern",void 0),g([w({type:Boolean,nonNullable:!0,json:{write:!0,default:!0}})],Mh.prototype,"castShadows",void 0),g([w({type:L0,json:{write:!0}})],Mh.prototype,"outline",void 0),g([w(OG)],Mh.prototype,"edges",void 0),Mh=b5=g([te("esri.symbols.FillSymbol3DLayer")],Mh);const t_=Mh,rbe=["none","underline","line-through"],nbe=["normal","italic","oblique"],sbe=["normal","lighter","bold","bolder"],WG={type:Number,cast:e=>{const t=hl(e);return t===0?1:Vs(t,.1,4)},nonNullable:!0},obe=["left","right","center"],abe=["baseline","top","middle","bottom"],JG={type:obe,nonNullable:!0},ZG={type:abe,nonNullable:!0};var lC;let Ih=lC=class extends ke{constructor(e){super(e),this.decoration="none",this.family="sans-serif",this.size=9,this.style="normal",this.weight="normal"}castSize(e){return Fi(e)}clone(){return new lC({decoration:this.decoration,family:this.family,size:this.size,style:this.style,weight:this.weight})}hash(){return`${this.decoration}.${this.family}.${this.size}.${this.style}.${this.weight}`}};g([w({type:rbe,json:{default:"none",write:!0}})],Ih.prototype,"decoration",void 0),g([w({type:String,json:{write:!0}})],Ih.prototype,"family",void 0),g([w({type:Number,json:{write:{overridePolicy:(e,t,i)=>({enabled:!i||!i.textSymbol3D})}}})],Ih.prototype,"size",void 0),g([Dt("size")],Ih.prototype,"castSize",null),g([w({type:nbe,json:{default:"normal",write:!0}})],Ih.prototype,"style",void 0),g([w({type:sbe,json:{default:"normal",write:!0}})],Ih.prototype,"weight",void 0),Ih=lC=g([te("esri.symbols.Font")],Ih);const w5=Ih,lbe=$e.getLogger("esri.core.urlUtils"),Ig=$i.request,KG="esri/config: esriConfig.request.proxyUrl is not set.",YG=/^\s*[a-z][a-z0-9-+.]*:(?![0-9])/i,XG=/^\s*http:/i,cbe=/^\s*https:/i,ube=/^\s*file:/i,hbe=/:\d+$/,pbe=/^https?:\/\/[^/]+\.arcgis.com\/sharing(\/|$)/i,dbe=new RegExp("^(([^:/?#]+):)?(//([^/?#]*))?([^?#]*)(\\?([^#]*))?(#(.*))?$"),fbe=new RegExp("^((([^\\[:]+):)?([^@]+)@)?(\\[([^\\]]+)\\]|([^\\[:]*))(:([0-9]+))?$");class $g{constructor(t=""){this.uri=t,this.scheme=null,this.authority=null,this.path=null,this.query=null,this.fragment=null,this.user=null,this.password=null,this.host=null,this.port=null;let i=On(this.uri.match(dbe));this.scheme=i[2]||(i[1]?"":null),this.authority=i[4]||(i[3]?"":null),this.path=i[5],this.query=i[7]||(i[6]?"":null),this.fragment=i[9]||(i[8]?"":null),this.authority!=null&&(i=On(this.authority.match(fbe)),this.user=i[3]||null,this.password=i[4]||null,this.host=i[6]||i[7],this.port=i[9]||null)}toString(){return this.uri}}const _5={},ybe=new $g($i.applicationUrl);let no=ybe;const mbe=gbe();let cC=mbe;const uC=()=>no,sJe=()=>cC;function gbe(){const e=On(no.path),t=e.substring(0,e.lastIndexOf(e.split("/")[e.split("/").length-1]));return`${`${no.scheme}://${no.host}${no.port!=null?`:${no.port}`:""}`}${t}`}function mn(e){if(!e)return null;const t={path:null,query:null},i=new $g(e),r=e.indexOf("?");return i.query===null?t.path=e:(t.path=e.substring(0,r),t.query=QG(i.query)),i.fragment&&(t.hash=i.fragment,i.query===null&&(t.path=t.path.substring(0,t.path.length-(i.fragment.length+1)))),t}function QG(e){const t=e.split("&"),i={};for(const r of t){if(!r)continue;const n=r.indexOf("=");let o,c;n<0?(o=decodeURIComponent(r),c=""):(o=decodeURIComponent(r.slice(0,n)),c=decodeURIComponent(r.slice(n+1)));let h=i[o];typeof h=="string"&&(h=i[o]=[h]),Array.isArray(h)?h.push(c):i[o]=c}return i}function eB(e){return e&&typeof e=="object"&&"toJSON"in e&&typeof e.toJSON=="function"}function Td(e,t){return e?t&&typeof t=="function"?Object.keys(e).map(i=>encodeURIComponent(i)+"="+encodeURIComponent(t(i,e[i]))).join("&"):Object.keys(e).map(i=>{const r=e[i];if(r==null)return"";const n=encodeURIComponent(i)+"=",o=t&&t[i];return o?n+encodeURIComponent(o(r)):Array.isArray(r)?r.map(c=>eB(c)?n+encodeURIComponent(JSON.stringify(c)):n+encodeURIComponent(c)).join("&"):eB(r)?n+encodeURIComponent(JSON.stringify(r)):n+encodeURIComponent(r)}).filter(i=>i).join("&"):""}function vbe(e=!1){let t,i=Ig.proxyUrl;if(typeof e=="string"){t=Mbe(e);const r=x5(e);r&&(i=r.proxyUrl)}else t=!!e;if(!i)throw lbe.warn(KG),new ue("urlutils:proxy-not-set",KG);return t&&gC()&&(i=mC(i)),mn(i)}function tB(e){const t=x5(e);let i,r;if(t){const n=hC(t.proxyUrl);i=n.path,r=n.query?QG(n.query):null}if(i){const n=mn(e);e=i+"?"+n.path;const o=Td(K(K({},r),n.query));o&&(e=`${e}?${o}`)}return e}const i_={path:"",query:""};function hC(e){const t=e.indexOf("?");return t!==-1?(i_.path=e.slice(0,t),i_.query=e.slice(t+1)):(i_.path=e,i_.query=null),i_}function iB(e){return e=(e=M5(e=Cbe(e=hC(e).path),!0)).toLowerCase()}function bbe(e){const t={proxyUrl:e.proxyUrl,urlPrefix:iB(e.urlPrefix)},i=Ig.proxyRules,r=t.urlPrefix;let n=i.length;for(let o=0;o<i.length;o++){const c=i[o].urlPrefix;if(r.indexOf(c)===0){if(r.length===c.length)return-1;n=o;break}c.indexOf(r)===0&&(n=o+1)}return i.splice(n,0,t),n}function x5(e){const t=Ig.proxyRules,i=iB(e);for(let r=0;r<t.length;r++)if(i.indexOf(t[r].urlPrefix)===0)return t[r]}function rB(e,t){return e=nB(e),t=nB(t),M5(e)===M5(t)}function nB(e){const t=(e=zs(e)).indexOf("/sharing");return t>0?e.substring(0,t):e.replace(/\/+$/,"")}function sB(e){const t=r=>r==null||r instanceof RegExp&&r.test(e)||typeof r=="string"&&e.startsWith(r),i=Ig.interceptors;if(i){for(const r of i)if(Array.isArray(r.urls)){if(r.urls.some(t))return r}else if(t(r.urls))return r}return null}function Eg(e,t,i=!1){if(!e||!t)return!1;const r=wC(e),n=wC(t);return!(!i&&r.scheme!==n.scheme)&&r.host!=null&&n.host!=null&&r.host.toLowerCase()===n.host.toLowerCase()&&r.port===n.port}function pC(e){if(typeof e=="string"){if(!Fa(e))return!0;e=wC(e)}if(Eg(e,no))return!0;const t=Ig.trustedServers||[];for(let i=0;i<t.length;i++){const r=wbe(t[i]);for(let n=0;n<r.length;n++)if(Eg(e,r[n]))return!0}return!1}function wbe(e){return _5[e]||(yC(e)||cu(e)?_5[e]=[new $g(Ra(e))]:_5[e]=[new $g(`http://${e}`),new $g(`https://${e}`)]),_5[e]}function Ra(e,t=cC,i){return cu(e)?i&&i.preserveProtocolRelative?e:no.scheme==="http"&&no.authority===sc(e).slice(2)?`http:${e}`:`https:${e}`:yC(e)?e:On(Cd(e[0]==="/"?Tbe(t):t,e))}function dC(e,t=cC,i){if(e==null||!Fa(e))return e;const r=zs(e),n=r.toLowerCase(),o=zs(t).toLowerCase().replace(/\/+$/,""),c=i?zs(i).toLowerCase().replace(/\/+$/,""):null;if(c&&o.indexOf(c)!==0)return e;const h=(I,E,k)=>(k=I.indexOf(E,k))===-1?I.length:k;let m=h(n,"/",n.indexOf("//")+2),b=-1;for(;n.slice(0,m+1)===o.slice(0,m)+"/"&&(b=m+1,m!==n.length);)m=h(n,"/",m+1);if(b===-1||c&&b<c.length)return e;e=r.slice(b);const x=o.slice(b-1).replace(/[^/]+/g,"").length;if(x>0)for(let I=0;I<x;I++)e=`../${e}`;else e=`./${e}`;return e}function zs(e){return e=Pbe(e=Abe(e=kbe(e=Ra(e=e.trim()))))}function Cd(...e){const t=e.filter(H);if(!t||!t.length)return;const i=[];if(Fa(t[0])){const n=t[0],o=n.indexOf("//");o!==-1&&(i.push(n.slice(0,o+1)),$be(t[0])&&(i[0]+="/"),t[0]=n.slice(o+2))}else t[0][0]==="/"&&i.push("");const r=t.reduce((n,o)=>o?n.concat(o.split("/")):n,[]);for(let n=0;n<r.length;n++){const o=r[n];o===".."&&i.length>0&&i[i.length-1]!==".."?i.pop():(!o&&n===r.length-1||o&&(o!=="."||i.length===0))&&i.push(o)}return i.join("/")}function sc(e,t=!1){if(e==null||S5(e)||O0(e))return null;let i=e.indexOf("://");if(i===-1&&cu(e))i=2;else{if(i===-1)return null;i+=3}const r=e.indexOf("/",i);return r!==-1&&(e=e.slice(0,r)),t&&(e=M5(e,!0)),e}function Fa(e){return cu(e)||yC(e)}function S5(e){return e!=null&&e.slice(0,5)==="blob:"}function O0(e){return e!=null&&e.slice(0,5)==="data:"}function oJe(e){const t=fC(e);if(!t||!t.isBase64)return null;const i=atob(t.data),r=new Uint8Array(i.length);for(let n=0;n<i.length;n++)r[n]=i.charCodeAt(n);return r.buffer}function aJe(e){return btoa(String.fromCharCode.apply(null,e)).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}const _be=/^data:(.*?)(;base64)?,(.*)$/;function fC(e){const t=e.match(_be);if(!t)return null;const[,i,r,n]=t;return{mediaType:i,isBase64:!!r,data:n}}function oB(e){return e.isBase64?`data:${e.mediaType};base64,${e.data}`:`data:${e.mediaType},${e.data}`}function lJe(e,t){xbe(e,t)||Sbe(e,t)}function xbe(e,t){if(!e)return!1;const i=document.createElement("a");if(!("download"in i))return!1;const r=URL.createObjectURL(e);return i.download=t,i.href=r,i.style.display="none",document.body.appendChild(i),i.click(),document.body.removeChild(i),URL.revokeObjectURL(r),!0}function Sbe(e,t){return!!window.navigator.msSaveOrOpenBlob&&window.navigator.msSaveOrOpenBlob(e,t)}function cu(e){return e!=null&&e[0]==="/"&&e[1]==="/"}function yC(e){return e!=null&&YG.test(e)}function Mbe(e){return e!=null&&cbe.test(e)||no.scheme==="https"&&cu(e)}function Ibe(e){return e!=null&&XG.test(e)||no.scheme==="http"&&cu(e)}function $be(e){return e!=null&&ube.test(e)}function mC(e){return cu(e)?`https:${e}`:e.replace(XG,"https:")}function Ebe(){return no.scheme==="http"}function gC(){return no.scheme==="https"}function M5(e,t=!1){return cu(e)?e.slice(2):(e=e.replace(YG,""),t&&e.length>1&&e[0]==="/"&&e[1]==="/"&&(e=e.slice(2)),e)}function Tbe(e){const t=e.indexOf("//"),i=e.indexOf("/",t+2);return i===-1?e:e.slice(0,i)}function vC(e){let t=0;if(Fa(e)){const r=e.indexOf("//");r!==-1&&(t=r+2)}const i=e.lastIndexOf("/");return i<t?e:e.slice(0,i+1)}function cJe(e,t){if(!e)return"";const i=mn(e).path.replace(/\/+$/,""),r=i.substring(i.lastIndexOf("/")+1);if(!(t==null?void 0:t.length))return r;const n=new RegExp(`.(${t.join("|")})$`,"ig");return r.replace(n,"")}function Cbe(e){return e&&e[e.length-1]==="/"?e:`${e}/`}function aB(e){return e.replace(/\/+$/,"")}function kbe(e){if(/^https?:\/\//i.test(e)){const t=hC(e);e=(e=t.path.replace(/\/{2,}/g,"/")).replace("/","//"),t.query&&(e+=`?${t.query}`)}return e}function Abe(e){return e.replace(/^(https?:\/\/)(arcgis\.com)/i,"$1www.$2")}function Pbe(e){const t=Ig.httpsDomains;if(!Ibe(e))return e;const i=e.indexOf("/",7);let r;if(r=i===-1?e:e.slice(0,i),r=r.toLowerCase().slice(7),hbe.test(r)){if(!r.endsWith(":80"))return e;r=r.slice(0,-3),e=e.replace(":80","")}return Ebe()&&r===no.authority&&!pbe.test(e)||(gC()&&r===no.authority||t&&t.some(n=>r===n||r.endsWith(`.${n}`))||gC()&&!x5(e))&&(e=mC(e)),e}function bC(e,t,i){if(!(t&&i&&e&&Fa(e)))return e;const r=e.indexOf("//"),n=e.indexOf("/",r+2),o=e.indexOf(":",r+2),c=Math.min(n<0?e.length:n,o<0?e.length:o);return e.slice(r+2,c).toLowerCase()!==t.toLowerCase()?e:`${e.slice(0,r+2)}${i}${e.slice(c)}`}function wC(e){return typeof e=="string"?new $g(Ra(e)):(e.scheme||(e.scheme=no.scheme),e)}function uJe(e){return Lbe.test(e)}function lB(e,t){const i=mn(e),r=Object.keys(i.query||{});return r.length>0&&t&&t.warn("removeQueryParameters()",`Url query parameters are not supported, the following parameters have been removed: ${r.join(", ")}.`),i.path}function cB(e,t,i){const r=mn(e),n=r.query||{};return n[t]=String(i),`${r.path}?${Td(n)}`}function I5(e,t){const i=mn(e),r=i.query||{};for(const o in t)r[o]=t[o];const n=Td(r);return n?`${i.path}?${n}`:i.path}function hJe(e){if(ce(e))return null;const t=e.match(hB);return t?t[2]:null}function uB(e){if(ce(e))return null;const t=e.match(hB);return t?{path:t[1],extension:t[2]}:{path:e,extension:null}}const hB=/([^.]*)\.([^\/]*)$/,Lbe=/(^data:image\/svg|\.svg$)/i;function kd(e,t){const i=t&&t.url&&t.url.path;if(e&&i&&(e=Ra(e,i,{preserveProtocolRelative:!0}),t.portalItem&&t.readResourcePaths)){const r=dC(e,t.portalItem.itemUrl);r!=null&&Obe.test(r)&&t.readResourcePaths.push(t.portalItem.resourceFromPath(r).path)}return xC(e,t&&t.portal)}function r_(e,t,i=n_.YES){if(e==null)return e;!Fa(e)&&t&&t.blockedRelativeUrls&&t.blockedRelativeUrls.push(e);let r=Ra(e);if(t){const n=t.verifyItemRelativeUrls&&t.verifyItemRelativeUrls.rootPath||t.url&&t.url.path;if(n){const o=xC(n,t.portal);r=dC(xC(r,t.portal),o,o),r!=null&&r!==e&&t.verifyItemRelativeUrls&&t.verifyItemRelativeUrls.writtenUrls.push(r)}}return r=dB(r,t==null?void 0:t.portal),Fa(r)&&(r=zs(r)),(t==null?void 0:t.resources)&&(t==null?void 0:t.portalItem)&&!Fa(r)&&!O0(r)&&i===n_.YES&&t.resources.toKeep.push({resource:t.portalItem.resourceFromPath(r),compress:!1}),r}function _C(e,t,i){return kd(e,i)}function R0(e,t,i,r){const n=r_(e,r);n!==void 0&&(t[i]=n)}const pB=/\/items\/([^\/]+)\/resources\/(.*)/,Obe=/^\.\/resources\//;function Rbe(e){var t,i,r;return(r=(i=(t=e==null?void 0:e.match(pB))!=null?t:null)==null?void 0:i[1])!=null?r:null}function Fbe(e){var c;const t=(c=e==null?void 0:e.match(pB))!=null?c:null;if(t==null)return null;const i=t[2],r=i.lastIndexOf("/");if(r===-1){const{path:h,extension:m}=uB(i);return{prefix:null,filename:h,extension:Ht(m)}}const{path:n,extension:o}=uB(i.slice(r+1));return{prefix:i.slice(0,r),filename:n,extension:Ht(o)}}function dB(e,t){return t&&!t.isPortal&&t.urlKey&&t.customBaseUrl?bC(e,`${t.urlKey}.${t.customBaseUrl}`,t.portalHostname):e}function xC(e,t){if(!t||t.isPortal||!t.urlKey||!t.customBaseUrl)return e;const i=`${t.urlKey}.${t.customBaseUrl}`,r=uC();return Eg(r,`${r.scheme}://${i}`)?bC(e,t.portalHostname,i):bC(e,i,t.portalHostname)}var n_;(function(e){e[e.YES=0]="YES",e[e.NO=1]="NO"})(n_||(n_={}));const pJe=Object.freeze(Object.defineProperty({__proto__:null,fromJSON:kd,toJSON:r_,read:_C,write:R0,itemIdFromResourceUrl:Rbe,prefixAndFilenameFromResourceUrl:Fbe,ensureMainOnlineDomain:dB,get MarkKeep(){return n_}},Symbol.toStringTag,{value:"Module"}));var SC;const Nbe=Ns()({circle:"circle",square:"square",cross:"cross",x:"x",kite:"kite",triangle:"triangle"});let F0=SC=class extends ke{constructor(e){super(e)}readHref(e,t,i){return e?kd(e,i):t.dataURI}writeHref(e,t,i,r){e&&(O0(e)?t.dataURI=e:(t.href=r_(e,r),Fa(t.href)&&(t.href=zs(t.href))))}clone(){return new SC({href:this.href,primitive:this.primitive})}};g([w({type:String,json:{write:!0,read:{source:["href","dataURI"]}}})],F0.prototype,"href",void 0),g([We("href")],F0.prototype,"readHref",null),g([tt("href",{href:{type:String},dataURI:{type:String}})],F0.prototype,"writeHref",null),g([Pt(Nbe)],F0.prototype,"primitive",void 0),F0=SC=g([te("esri.symbols.support.IconSymbol3DLayerResource")],F0);const Dbe="circle";var MC;let Tg=MC=class extends Ye{constructor(){super(...arguments),this.x=0,this.y=0}clone(){return new MC({x:this.x,y:this.y})}};g([w({type:Number})],Tg.prototype,"x",void 0),g([w({type:Number})],Tg.prototype,"y",void 0),Tg=MC=g([te("esri.symbols.support.Symbol3DAnchorPosition2D")],Tg);var IC;let s_=IC=class extends ke{constructor(e){super(e),this.color=new ut([0,0,0,1]),this.size=$n(1)}clone(){const e={color:H(this.color)?this.color.clone():null,size:this.size};return new IC(e)}};g([w($d)],s_.prototype,"color",void 0),g([w(au)],s_.prototype,"size",void 0),s_=IC=g([te("esri.symbols.support.Symbol3DIconOutline")],s_);var Cg;const fB="esri.symbols.IconSymbol3DLayer";let uu=Cg=class extends ou{constructor(e){super(e),this.material=null,this.resource=null,this.type="icon",this.size=12,this.anchor="center",this.anchorPosition=null,this.outline=null}clone(){return new Cg({anchor:this.anchor,anchorPosition:this.anchorPosition&&this.anchorPosition.clone(),enabled:this.enabled,material:H(this.material)?this.material.clone():null,outline:H(this.outline)?this.outline.clone():null,resource:this.resource&&this.resource.clone(),size:this.size})}static fromSimpleMarkerSymbol(e){const t=e.color||Kw,i=yB(e),r=e.outline&&e.outline.width>0?{size:e.outline.width,color:(e.outline.color||Kw).clone()}:null;return new Cg({size:e.size,resource:{primitive:Vbe(e.style)},material:{color:t},outline:r,anchor:i?"relative":void 0,anchorPosition:i})}static fromPictureMarkerSymbol(e){const t=!e.color||Vve(e.color)?Kw:e.color,i=yB(e);return new Cg({size:e.width<=e.height?e.height:e.width,resource:{href:e.url},material:{color:t.clone()},anchor:i?"relative":void 0,anchorPosition:i})}static fromCIMSymbol(e){return new Cg({resource:{href:oB({mediaType:"application/json",data:JSON.stringify(e.data)})}})}};function yB(e){const t="width"in e?e.width:e.size,i="height"in e?e.height:e.size,r=mB(e.xoffset),n=mB(e.yoffset);return(r||n)&&t&&i?{x:-r/t,y:n/i}:null}function mB(e){return isFinite(e)?e:0}g([w({type:Oa,json:{write:!0}})],uu.prototype,"material",void 0),g([w({type:F0,json:{write:!0}})],uu.prototype,"resource",void 0),g([Pt({Icon:"icon"},{readOnly:!0})],uu.prototype,"type",void 0),g([w(au)],uu.prototype,"size",void 0),g([Pt({center:"center",left:"left",right:"right",top:"top",bottom:"bottom",topLeft:"top-left",topRight:"top-right",bottomLeft:"bottom-left",bottomRight:"bottom-right",relative:"relative"}),w({json:{default:"center"}})],uu.prototype,"anchor",void 0),g([w({type:Tg,json:{type:[Number],read:{reader:e=>new Tg({x:e[0],y:e[1]})},write:{writer:(e,t)=>{t.anchorPosition=[e.x,e.y]},overridePolicy(){return{enabled:this.anchor==="relative"}}}}})],uu.prototype,"anchorPosition",void 0),g([w({type:s_,json:{write:!0}})],uu.prototype,"outline",void 0),uu=Cg=g([te(fB)],uu);const jbe={circle:"circle",cross:"cross",diamond:"kite",square:"square",x:"x",triangle:"triangle",path:null};function Vbe(e){return jbe[e]||($e.getLogger(fB).warn(`${e} cannot be mapped to Icon symbol. Fallback to "circle"`),"circle")}const N0=uu;function D0(e,t,i=Xe){return t||(t=new i),t===e||(t.removeAll(),zbe(e)?t.addMany(e):e&&t.add(e)),t}function gB(e){return e}function zbe(e){return e&&(Array.isArray(e)||"items"in e&&Array.isArray(e.items))}const vB="20221121",bB="f520630575ed53cf8b49e5f1492799065ee366e5",wB="4.25",Gbe={async request(e,t){var h,m;const{default:i}=await Promise.resolve().then(function(){return lwe}),r=e.options,n=r.responseType;r.signal=t==null?void 0:t.signal,r.responseType=n==="native"||n==="native-request-init"?"native-request-init":n&&["blob","json","text"].includes(n)&&((h=sB(e.url))==null?void 0:h.after)?n:"array-buffer";const o=await i(e.url,r),c={data:o.data,ssl:o.ssl};switch((m=o.requestOptions)==null?void 0:m.responseType){case"native-request-init":return delete c.data.signal,c;case"blob":c.data=await c.data.arrayBuffer();break;case"json":c.data=new TextEncoder().encode(JSON.stringify(c.data)).buffer;break;case"text":c.data=new TextEncoder().encode(c.data).buffer}return{result:c,transferList:[c.data]}}};let tr;function dJe(e){tr=e}function _B(e){const t=tr&&tr.findCredential(e);return t&&t.token?cB(e,"token",t.token):e}Te("host-webworker");const Bbe=/^https:\/\/([a-z\d-]+)(\.maps([^.]*))?\.arcgis\.com/i,Ube={devext:{customBaseUrl:"mapsdevext.arcgis.com",portalHostname:"devext.arcgis.com"},qaext:{customBaseUrl:"mapsqa.arcgis.com",portalHostname:"qaext.arcgis.com"},www:{customBaseUrl:"maps.arcgis.com",portalHostname:"www.arcgis.com"}};function fJe(e){const t=e==null?void 0:e.match(Bbe);if(!t)return null;const[,i,r,n]=t;if(!i)return null;let o=null,c=null,h=null;const{devext:m,qaext:b,www:x}=Ube;if(r)if(o=i,n)switch(n.toLowerCase()){case"devext":({customBaseUrl:c,portalHostname:h}=m);break;case"qa":({customBaseUrl:c,portalHostname:h}=b);break;default:return null}else({customBaseUrl:c,portalHostname:h}=x);else switch(i.toLowerCase()){case"devext":({customBaseUrl:c,portalHostname:h}=m);break;case"qaext":({customBaseUrl:c,portalHostname:h}=b);break;case"www":({customBaseUrl:c,portalHostname:h}=x);break;default:return null}return{customBaseUrl:c,isPortal:!1,portalHostname:h,urlKey:o}}function qbe(e){return/\/(sharing|usrsvcs)\/(appservices|servers)\//i.test(e)}const Hbe=["elevation3d.arcgis.com","js.arcgis.com","jsdev.arcgis.com","jsqa.arcgis.com","static.arcgis.com"];function $C(e){const t=sc(e,!0);return!!t&&t.endsWith(".arcgis.com")&&!Hbe.includes(t)&&!e.endsWith("/sharing/rest/generateToken")}function Wbe(e,t,i=!1,r){return new Promise((n,o)=>{if(ka(r))return void o(xB());let c=()=>{b(),o(new Error(`Unable to load ${t}`))},h=()=>{const x=e;b(),n(x)},m=()=>{if(!e)return;const x=e;b(),x.src="",o(xB())};const b=()=>{Te("esri-image-decode")||(e.removeEventListener("error",c),e.removeEventListener("load",h)),c=null,h=null,e=null,H(r)&&r.removeEventListener("abort",m),m=null,i&&URL.revokeObjectURL(t)};H(r)&&r.addEventListener("abort",m),Te("esri-image-decode")?e.decode().then(h,c):(e.addEventListener("error",c),e.addEventListener("load",h))})}function xB(){try{return new DOMException("Aborted","AbortError")}catch{const e=new Error;return e.name="AbortError",e}}function Jbe(e){var i,r,n;$i.request.crossOriginNoCorsDomains||($i.request.crossOriginNoCorsDomains={});const t=$i.request.crossOriginNoCorsDomains;for(let o of e)o=o.toLowerCase(),/^https?:\/\//.test(o)?t[(i=sc(o))!=null?i:""]=0:(t[(r=sc("http://"+o))!=null?r:""]=0,t[(n=sc("https://"+o))!=null?n:""]=0)}function Zbe(e){const t=$i.request.crossOriginNoCorsDomains;if(t){let i=sc(e);if(i)return i=i.toLowerCase(),!Eg(i,uC())&&t[i]<Date.now()-36e5}return!1}async function Kbe(e){var n;const t=$i.request.crossOriginNoCorsDomains,i=sc(e);t&&i&&(t[i.toLowerCase()]=Date.now());const r=mn(e);e=r.path,((n=r.query)==null?void 0:n.f)==="json"&&(e+="?f=json");try{await fetch(e,{mode:"no-cors",credentials:"include"})}catch{}}async function Nt(e,t){var b;const i=O0(e),r=S5(e);r||i||(e=zs(e));const n={url:e,requestOptions:K({},Ht(t))};let o=sB(e);if(o){const x=await nwe(o,n);if(x!=null)return{data:x,getHeader:EC,requestOptions:n.requestOptions,url:n.url};o.after||o.error||(o=null)}if(e=n.url,(t=n.requestOptions).responseType==="image"){if(Te("host-webworker")||Te("host-node"))throw ac("request:invalid-parameters",new Error("responseType 'image' is not supported in Web Workers or Node environment"),n)}else if(i)throw ac("request:invalid-parameters",new Error("Data URLs are not supported for responseType = "+t.responseType),n);if(t.method==="head"){if(t.body)throw ac("request:invalid-parameters",new Error("body parameter cannot be set when method is 'head'"),n);if(i||r)throw ac("request:invalid-parameters",new Error("data and blob URLs are not supported for method 'head'"),n)}if(await twe(),$5)return $5.execute(e,t);const c=new AbortController;Ho(t,()=>c.abort());const h={controller:c,credential:void 0,credentialToken:void 0,fetchOptions:void 0,hasToken:!1,interceptor:o,params:n,redoRequest:!1,useIdentity:oc.useIdentity,useProxy:!1,useSSL:!1,withCredentials:!1},m=await owe(h);return(b=o==null?void 0:o.after)==null||b.call(o,m),m}let $5;const oc=$i.request,SB="FormData"in globalThis,Ybe=[499,498,403,401],Xbe=["COM_0056","COM_0057","SB_0008"],Qbe=[/\/arcgis\/tokens/i,/\/sharing(\/rest)?\/generatetoken/i,/\/rest\/info/i],EC=()=>null,E5=Symbol();function ewe(e){const t=sc(e);t&&!Nt._corsServers.includes(t)&&Nt._corsServers.push(t)}function MB(e){const t=sc(e);return!t||t.endsWith(".arcgis.com")||Nt._corsServers.includes(t)||pC(t)}function ac(e,t,i,r){let n="Error";const o={url:i.url,requestOptions:i.requestOptions,getHeader:EC,ssl:!1};if(t instanceof ue)return t.details?(t.details=_e(t.details),t.details.url=i.url,t.details.requestOptions=i.requestOptions):t.details=o,t;if(t){const c=r&&(b=>r.headers.get(b)),h=r&&r.status,m=t.message;m&&(n=m),c&&(o.getHeader=c),o.httpStatus=(t.httpCode!=null?t.httpCode:t.code)||h||0,o.subCode=t.subcode,o.messageCode=t.messageCode,typeof t.details=="string"?o.messages=[t.details]:o.messages=t.details,o.raw=E5 in t?t[E5]:t}return Xn(t)?Qi():new ue(e,n,o)}async function twe(){Te("host-webworker")?$5||($5=await import("./request.e2de1cd9.js")):Nt._abortableFetch||(Nt._abortableFetch=globalThis.fetch.bind(globalThis))}async function TC(){tr||await import("./IdentityManager.e107717c.js")}async function iwe(e){var h;const t=e.params.url,i=e.params.requestOptions,r=e.controller.signal,n=i.body;let o=null,c=null;if(SB&&"HTMLFormElement"in globalThis&&(n instanceof FormData?o=n:n instanceof HTMLFormElement&&(o=new FormData(n))),typeof n=="string"&&(c=n),e.fetchOptions={cache:i.cacheBust&&!Nt._abortableFetch.polyfill?"no-cache":"default",credentials:"same-origin",headers:i.headers||{},method:i.method==="head"?"HEAD":"GET",mode:"cors",priority:oc.priority,redirect:"follow",signal:r},(o||c)&&(e.fetchOptions.body=o||c),i.authMode==="anonymous"&&(e.useIdentity=!1),e.hasToken=!!(/token=/i.test(t)||((h=i.query)==null?void 0:h.token)||(o==null?void 0:o.get("token"))),!e.hasToken&&$i.apiKey&&$C(t)&&(i.query||(i.query={}),i.query.token=$i.apiKey,e.hasToken=!0),e.useIdentity&&!e.hasToken&&!e.credentialToken&&!IB(t)&&!ka(r)){let m;i.authMode==="immediate"?(await TC(),m=await tr.getCredential(t,{signal:r}),e.credential=m):i.authMode==="no-prompt"?(await TC(),m=await tr.getCredential(t,{prompt:!1,signal:r}).catch(()=>{}),e.credential=m):tr&&(m=tr.findCredential(t)),m&&(e.credentialToken=m.token,e.useSSL=!!m.ssl)}}function IB(e){return Qbe.some(t=>t.test(e))}async function rwe(e){var E,k;let t=e.params.url;const i=e.params.requestOptions,r=(E=e.fetchOptions)!=null?E:{},n=S5(t)||O0(t),o=i.responseType||"json",c=n?0:i.timeout!=null?i.timeout:oc.timeout;let h=!1;if(!n){e.useSSL&&(t=mC(t)),i.cacheBust&&r.cache==="default"&&(t=cB(t,"request.preventCache",Date.now()));let P=K({},i.query);e.credentialToken&&(P.token=e.credentialToken);let F=Td(P);Te("esri-url-encodes-apostrophe")&&(F=F.replace(/'/g,"%27"));const N=t.length+1+F.length;let B;h=i.method==="delete"||i.method==="post"||i.method==="put"||!!i.body||N>oc.maxUrlLength;const z=i.useProxy||!!x5(t);if(z){const q=vbe(t);B=q.path,!h&&B.length+1+N>oc.maxUrlLength&&(h=!0),q.query&&(P=K(K({},q.query),P))}if(r.method==="HEAD"&&(h||z)){if(h)throw N>oc.maxUrlLength?ac("request:invalid-parameters",new Error("URL exceeds maximum length"),e.params):ac("request:invalid-parameters",new Error("cannot use POST request when method is 'head'"),e.params);if(z)throw ac("request:invalid-parameters",new Error("cannot use proxy when method is 'head'"),e.params)}if(h?(r.method=i.method==="delete"?"DELETE":i.method==="put"?"PUT":"POST",i.body?t=I5(t,P):(r.body=Td(P),r.headers||(r.headers={}),r.headers["Content-Type"]="application/x-www-form-urlencoded")):t=I5(t,P),z&&(e.useProxy=!0,t=`${B}?${t}`),P.token&&SB&&r.body instanceof FormData&&!qbe(t)&&r.body.set("token",P.token),i.hasOwnProperty("withCredentials"))e.withCredentials=i.withCredentials;else if(!Eg(t,uC())){if(pC(t))e.withCredentials=!0;else if(tr){const q=tr.findServerInfo(t);q&&q.webTierAuth&&(e.withCredentials=!0)}}e.withCredentials&&(r.credentials="include",Zbe(t)&&await Kbe(h?I5(t,P):t))}let m,b,x=0,I=!1;c>0&&(x=setTimeout(()=>{I=!0,e.controller.abort()},c));try{if(i.responseType==="native-request-init")b=r,b.url=t;else if(i.responseType!=="image"||r.cache!=="default"||r.method!=="GET"||h||swe(i.headers)||!n&&!e.useProxy&&oc.proxyUrl&&!MB(t)){if(m=await Nt._abortableFetch(t,r),e.useProxy||ewe(t),i.responseType==="native")b=m;else if(r.method!=="HEAD")if(m.ok){switch(o){case"array-buffer":b=await m.arrayBuffer();break;case"blob":case"image":b=await m.blob();break;default:b=await m.text()}if(x&&(clearTimeout(x),x=0),o==="json"||o==="xml"||o==="document")if(b)switch(o){case"json":b=JSON.parse(b);break;case"xml":b=$B(b,"application/xml");break;case"document":b=$B(b,"text/html")}else b=null;if(b){if(o==="array-buffer"||o==="blob"){const P=m.headers.get("Content-Type");if(P&&/application\/json|text\/plain/i.test(P)&&b[o==="blob"?"size":"byteLength"]<=750)try{const F=await new Response(b).json();F.error&&(b=F)}catch{}}o==="image"&&b instanceof Blob&&(b=await EB(URL.createObjectURL(b),e,!0))}}else b=await m.text()}else b=await EB(t,e)}catch(P){if(P.name==="AbortError")throw I?new Error("Timeout exceeded"):Qi("Request canceled");if(!(!m&&P instanceof TypeError&&oc.proxyUrl)||i.body||i.method==="delete"||i.method==="head"||i.method==="post"||i.method==="put"||e.useProxy||MB(t))throw P;e.redoRequest=!0,bbe({proxyUrl:oc.proxyUrl,urlPrefix:(k=sc(t))!=null?k:""})}finally{x&&clearTimeout(x)}return[m,b]}async function nwe(e,t){if(e.responseData!=null)return e.responseData;if(e.headers&&(t.requestOptions.headers=K(K({},t.requestOptions.headers),e.headers)),e.query&&(t.requestOptions.query=K(K({},t.requestOptions.query),e.query)),e.before){let i,r;try{r=await e.before(t)}catch(n){i=ac("request:interceptor",n,t)}if((r instanceof Error||r instanceof ue)&&(i=ac("request:interceptor",r,t)),i)throw e.error&&e.error(i),i;return r}}function swe(e){if(e){for(const t of Object.getOwnPropertyNames(e))if(e[t])return!0}return!1}function $B(e,t){let i;try{i=new DOMParser().parseFromString(e,t)}catch{}if(!i||i.getElementsByTagName("parsererror").length)throw new SyntaxError("XML Parse error");return i}async function owe(e){var o;let t,i;await iwe(e);try{do[t,i]=await rwe(e);while(!await awe(e,t,i))}catch(c){const h=ac("request:server",c,e.params,t);throw h.details.ssl=e.useSSL,e.interceptor&&e.interceptor.error&&e.interceptor.error(h),h}const r=e.params.url;if(i&&/\/sharing\/rest\/(accounts|portals)\/self/i.test(r)){if(!e.hasToken&&!e.credentialToken&&((o=i.user)==null?void 0:o.username)&&!pC(r)){const c=sc(r,!0);c&&oc.trustedServers.push(c)}Array.isArray(i.authorizedCrossOriginNoCorsDomains)&&Jbe(i.authorizedCrossOriginNoCorsDomains)}const n=e.credential;if(n&&tr){const c=tr.findServerInfo(n.server);let h=c&&c.owningSystemUrl;if(h){h=h.replace(/\/?$/,"/sharing");const m=tr.findCredential(h,n.userId);m&&tr._getIdenticalSvcIdx(h,m)===-1&&m.resources.unshift(h)}}return{data:i,getHeader:t?c=>t==null?void 0:t.headers.get(c):EC,requestOptions:e.params.requestOptions,ssl:e.useSSL,url:e.params.url}}async function awe(e,t,i){if(e.redoRequest)return e.redoRequest=!1,!1;const r=e.params.requestOptions;if(!t||r.responseType==="native"||r.responseType==="native-request-init")return!0;let n,o;if(!t.ok)throw n=new Error(`Unable to load ${t.url} status: ${t.status}`),n[E5]=i,n;i&&(i.error?n=i.error:i.status==="error"&&Array.isArray(i.messages)&&(n=K({},i),n[E5]=i,n.details=i.messages));let c,h=null;n&&(o=Number(n.code),h=n.hasOwnProperty("subcode")?Number(n.subcode):null,c=n.messageCode,c=c&&c.toUpperCase());const m=r.authMode;if(o===403&&(h===4||n.message&&n.message.toLowerCase().includes("ssl")&&!n.message.toLowerCase().includes("permission"))){if(!e.useSSL)return e.useSSL=!0,!1}else if(!e.hasToken&&e.useIdentity&&(m!=="no-prompt"||o===498)&&o!==void 0&&Ybe.includes(o)&&!IB(e.params.url)&&(o!==403||c&&!Xbe.includes(c)&&(h==null||h===2&&e.credentialToken))){await TC();try{const b=await tr.getCredential(e.params.url,{error:ac("request:server",n,e.params),prompt:m!=="no-prompt",signal:e.controller.signal,token:e.credentialToken});return e.credential=b,e.credentialToken=b.token,e.useSSL=e.useSSL||b.ssl,!1}catch(b){if(m==="no-prompt")return e.credential=void 0,e.credentialToken=void 0,!1;n=b}}if(n)throw n;return!0}function EB(e,t,i=!1){const r=t.controller.signal,n=new Image;return t.withCredentials?n.crossOrigin="use-credentials":n.crossOrigin="anonymous",n.alt="",n.fetchPriority=oc.priority,n.src=e,Wbe(n,e,i,r)}Nt._abortableFetch=null,Nt._corsServers=["https://server.arcgisonline.com","https://services.arcgisonline.com"];var lwe=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",default:Nt}),Ad;(function(e){e[e.PENDING=0]="PENDING",e[e.RESOLVED=1]="RESOLVED",e[e.REJECTED=2]="REJECTED"})(Ad||(Ad={}));class cwe{constructor(t){this.instance=t,this._resolver=fh(),this._status=Ad.PENDING,this._resolvingPromises=[],this._resolver.promise.then(()=>{this._status=Ad.RESOLVED,this._cleanUp()},()=>{this._status=Ad.REJECTED,this._cleanUp()})}addResolvingPromise(t){this._resolvingPromises.push(t),this._tryResolve()}isResolved(){return this._status===Ad.RESOLVED}isRejected(){return this._status===Ad.REJECTED}isFulfilled(){return this._status!==Ad.PENDING}abort(){this._resolver.reject(Qi())}when(t,i){return this._resolver.promise.then(t,i)}_cleanUp(){this._allPromise=this._resolvingPromises=this._allPromise=null}_tryResolve(){if(this.isFulfilled())return;const t=fh(),i=[...this._resolvingPromises,On(t.promise)],r=this._allPromise=Promise.all(i);r.then(()=>{this.isFulfilled()||this._allPromise!==r||this._resolver.resolve(this.instance)},n=>{this.isFulfilled()||this._allPromise!==r||Xn(n)||this._resolver.reject(n)}),t.resolve()}}const o_=e=>{let t=class extends e{constructor(...i){super(...i),this._promiseProps=new cwe(this),this.addResolvingPromise(Promise.resolve())}isResolved(){return this._promiseProps.isResolved()}isRejected(){return this._promiseProps.isRejected()}isFulfilled(){return this._promiseProps.isFulfilled()}when(i,r){return new Promise((n,o)=>{this._promiseProps.when(n,o)}).then(i,r)}catch(i){return this.when(null,i)}addResolvingPromise(i){i&&!this._promiseProps.isFulfilled()&&this._promiseProps.addResolvingPromise("_promiseProps"in i?i.when():i)}};return t=g([te("esri.core.Promise")],t),t};let T5=class extends o_(Ye){};T5=g([te("esri.core.Promise")],T5);const uwe="not-loaded",hwe="loading",pwe="failed",TB="loaded",CB=e=>{let t=class extends e{constructor(...i){super(...i),this._loadController=null,this.loadError=null,this.loadStatus="not-loaded",this._set("loadWarnings",[]),this.addResolvingPromise(new Promise(r=>{const n=this.load.bind(this);this.load=o=>{const c=new Promise((h,m)=>{const b=hT(o,m);this.destroyed&&m(new ue("load:instance-destroyed",`Instance of '${this.declaredClass||this.constructor.name}' is already destroyed`,{instance:this})),this._promiseProps.when(h,m).finally(()=>{b&&b.remove()})});if(this.loadStatus===uwe){this._set("loadStatus",hwe);const h=this._loadController=new AbortController;n({signal:h.signal}),Ho(h.signal,()=>{this._promiseProps.abort()})}return r(),c}})),this.when(()=>{this._set("loadStatus",TB),this._loadController=null},r=>{this._set("loadStatus",pwe),this._set("loadError",r),this._loadController=null})}get loaded(){return this.loadStatus===TB}get loadWarnings(){return this._get("loadWarnings")}load(){return null}cancelLoad(){var i;return this.isFulfilled()||(this._set("loadError",new ue("load:cancelled","Cancelled")),(i=this._loadController)==null||i.abort()),this}};return g([w({readOnly:!0})],t.prototype,"loaded",null),g([w({readOnly:!0})],t.prototype,"loadError",void 0),g([w({clonable:!1})],t.prototype,"loadStatus",void 0),g([w({type:[Io],readOnly:!0})],t.prototype,"loadWarnings",null),t=g([te("esri.core.Loadable")],t),t};let a_=class extends CB(T5){};a_=g([te("esri.core.Loadable")],a_),function(e){function t(i){return!(!i||!i.load)}e.LoadableMixin=CB,e.isLoadable=t}(a_||(a_={}));const Xo=a_;var CC;const dwe=new kt({avgRating:"avg-rating",numRatings:"num-ratings",numComments:"num-comments",numViews:"num-views"});let gl=CC=class extends Ye{constructor(e){super(e),this.categories=null,this.disableExtraQuery=!1,this.extent=null,this.filter=null,this.num=10,this.query=null,this.sortField=null,this.start=1}get sortOrder(){return this._get("sortOrder")||"asc"}set sortOrder(e){e!=="asc"&&e!=="desc"||this._set("sortOrder",e)}clone(){return new CC({categories:this.categories?_e(this.categories):null,disableExtraQuery:this.disableExtraQuery,extent:this.extent?this.extent.clone():null,filter:this.filter,num:this.num,query:this.query,sortField:this.sortField,sortOrder:this.sortOrder,start:this.start})}toRequestOptions(e,t){let i,r;if(this.categories&&(i=this.categories.map(c=>Array.isArray(c)?JSON.stringify(c):c)),this.extent){const c=gw(this.extent,Mt.WGS84);H(c)&&(r=`${c.xmin},${c.ymin},${c.xmax},${c.ymax}`)}let n=this.query;!this.disableExtraQuery&&e.extraQuery&&(n="("+n+")"+e.extraQuery);const o={categories:i,bbox:r,q:n,filter:this.filter,num:this.num,sortField:null,sortOrder:null,start:this.start};return this.sortField&&(o.sortField=this.sortField.split(",").map(c=>dwe.toJSON(c.trim())).join(","),o.sortOrder=this.sortOrder),{query:K(K({},t),o)}}};g([w()],gl.prototype,"categories",void 0),g([w()],gl.prototype,"disableExtraQuery",void 0),g([w({type:gi})],gl.prototype,"extent",void 0),g([w()],gl.prototype,"filter",void 0),g([w()],gl.prototype,"num",void 0),g([w()],gl.prototype,"query",void 0),g([w()],gl.prototype,"sortField",void 0),g([w()],gl.prototype,"sortOrder",null),g([w()],gl.prototype,"start",void 0),gl=CC=g([te("esri.portal.PortalQueryParams")],gl);const $h=gl;let j0=class extends Ye{constructor(e){super(e),this.nextQueryParams=null,this.queryParams=null,this.results=null,this.total=null}};g([w()],j0.prototype,"nextQueryParams",void 0),g([w()],j0.prototype,"queryParams",void 0),g([w()],j0.prototype,"results",void 0),g([w()],j0.prototype,"total",void 0),j0=g([te("esri.portal.PortalQueryResult")],j0);const fwe=j0;let Eh=class extends ke{constructor(e){super(e),this.created=null,this.id=null,this.portal=null,this.title=null,this.username=null}get url(){const e=this.get("portal.restUrl");return e?`${e}/content/users/${this.username}/${this.id}`:null}toJSON(){throw new ue("internal:not-yet-implemented","PortalFolder.toJSON is not yet implemented")}};g([w({type:Date})],Eh.prototype,"created",void 0),g([w()],Eh.prototype,"id",void 0),g([w()],Eh.prototype,"portal",void 0),g([w()],Eh.prototype,"title",void 0),g([w({readOnly:!0})],Eh.prototype,"url",null),g([w()],Eh.prototype,"username",void 0),Eh=g([te("esri.portal.PortalFolder")],Eh);const ywe=Eh;let ns=class extends ke{constructor(e){super(e),this.access=null,this.created=null,this.description=null,this.id=null,this.isInvitationOnly=!1,this.modified=null,this.owner=null,this.portal=null,this.snippet=null,this.sortField=null,this.sortOrder=null,this.tags=null,this.title=null}get thumbnailUrl(){var i;const e=this.url,t=this.thumbnail;return e&&t&&this.portal?(i=this.portal)==null?void 0:i._normalizeUrl(`${e}/info/${t}?f=json`):null}get url(){const e=this.get("portal.restUrl");return e?e+"/community/groups/"+this.id:null}fetchCategorySchema(e){return Yn(this.portal)._request(this.url+"/categorySchema",e).then(t=>{const i=t.categorySchema||[];return i.some(r=>r.source==="contentCategorySetsGroupQuery.LivingAtlas")?this._fetchCategorySchemaSet("LivingAtlas",e):i})}fetchMembers(e){return Yn(this.portal)._request(this.url+"/users",e)}getThumbnailUrl(e){let t=this.thumbnailUrl;return t&&e&&(t+=`&w=${e}`),t}toJSON(){throw new ue("internal:not-yet-implemented","PortalGroup.toJSON is not yet implemented")}queryItems(e,t){let i=Oi($h,e);const r=Yn(this.portal);return parseFloat(r.currentVersion)>5?(i=i||new $h,r._queryPortal(`/content/groups/${this.id}/search`,i,"PortalItem",t)):(i=i?i.clone():new $h,i.query="group:"+this.id+(i.query?" "+i.query:""),r.queryItems(i,t))}_fetchCategorySchemaSet(e,t){const i=Yn(this.portal);return i._fetchSelf(i.authMode,!0,t).then(r=>{const n=r.contentCategorySetsGroupQuery;if(n){const o=new $h;return o.disableExtraQuery=!0,o.num=1,o.query=n,i.queryGroups(o,t)}throw new ue("portal-group:fetchCategorySchema","contentCategorySetsGroupQuery value not found")}).then(r=>{if(r.total){const n=r.results[0],o=new $h;return o.num=1,o.query=`typekeywords:"${e}"`,n.queryItems(o,t)}throw new ue("portal-group:fetchCategorySchema","contentCategorySetsGroupQuery group not found")}).then(r=>r.total?r.results[0].fetchData("json",t).then(n=>{const o=n&&n.categorySchema;return o&&o.length?o:[]}):[])}};g([w()],ns.prototype,"access",void 0),g([w({type:Date})],ns.prototype,"created",void 0),g([w()],ns.prototype,"description",void 0),g([w()],ns.prototype,"id",void 0),g([w()],ns.prototype,"isInvitationOnly",void 0),g([w({type:Date})],ns.prototype,"modified",void 0),g([w()],ns.prototype,"owner",void 0),g([w()],ns.prototype,"portal",void 0),g([w()],ns.prototype,"snippet",void 0),g([w()],ns.prototype,"sortField",void 0),g([w()],ns.prototype,"sortOrder",void 0),g([w()],ns.prototype,"tags",void 0),g([w()],ns.prototype,"thumbnail",void 0),g([w({readOnly:!0})],ns.prototype,"thumbnailUrl",null),g([w()],ns.prototype,"title",void 0),g([w({readOnly:!0})],ns.prototype,"url",null),ns=g([te("esri.portal.PortalGroup")],ns);const kC=ns;var mwe=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",default:kC}),AC;let Ir=AC=class extends ke{constructor(...e){super(...e),this.access=null,this.created=null,this.culture=null,this.description=null,this.email=null,this.fullName=null,this.modified=null,this.orgId=null,this.portal=null,this.preferredView=null,this.privileges=null,this.region=null,this.role=null,this.roleId=null,this.sourceJSON=null,this.units=null,this.username=null,this.userType=null}get thumbnailUrl(){const e=this.url,t=this.thumbnail;return e&&t?this.portal._normalizeUrl(`${e}/info/${t}?f=json`):null}get userContentUrl(){const e=this.get("portal.restUrl");return e?`${e}/content/users/${this.username}`:null}get url(){const e=this.get("portal.restUrl");return e?`${e}/community/users/${this.username}`:null}addItem(e){const t=e&&e.item,i=e&&e.data,r=e&&e.folder,n={method:"post"};t&&(n.query=t.createPostQuery(),i!=null&&(typeof i=="string"?n.query.text=i:typeof i=="object"&&(n.query.text=JSON.stringify(i))));let o=this.userContentUrl;return r&&(o+="/"+(typeof r=="string"?r:r.id)),this.portal._request(o+"/addItem",n).then(c=>(t.id=c.id,t.portal=this.portal,t.loaded?t.reload():t.load()))}deleteItem(e){let t=this.userContentUrl;return e.ownerFolder&&(t+="/"+e.ownerFolder),this.portal._request(t+`/items/${e.id}/delete`,{method:"post"}).then(()=>{e.id=null,e.portal=null})}deleteItems(e){const t=this.userContentUrl+"/deleteItems",i=e.map(r=>r.id);if(i.length){const r={method:"post",query:{items:i.join(",")}};return this.portal._request(t,r).then(()=>{e.forEach(n=>{n.id=null,n.portal=null})})}return Promise.resolve(void 0)}fetchFolders(){var t;const e={query:{num:1}};return this.portal._request((t=this.userContentUrl)!=null?t:"",e).then(i=>{let r;return r=i&&i.folders?i.folders.map(n=>{const o=ywe.fromJSON(n);return o.portal=this.portal,o}):[],r})}fetchGroups(){var e;return this.portal._request((e=this.url)!=null?e:"").then(t=>{let i;return i=t&&t.groups?t.groups.map(r=>{const n=kC.fromJSON(r);return n.portal=this.portal,n}):[],i})}fetchItems(e){var n;const t=e!=null?e:{};let i,r=(n=this.userContentUrl)!=null?n:"";return t.folder&&(r+="/"+t.folder.id),Promise.resolve().then(function(){return YB}).then(({default:o})=>{i=o;const c={folders:!1,num:t.num||10,start:t.start||1,sortField:t.sortField||"created",sortOrder:t.sortOrder||"asc"};return this.portal._request(r,{query:c})}).then(o=>{let c;return o&&o.items?(c=o.items.map(h=>{const m=i.fromJSON(h);return m.portal=this.portal,m}),Promise.all(c.map(h=>h.load())).catch(h=>h).then(()=>({items:c,nextStart:o.nextStart,total:o.total}))):{items:[],nextStart:-1,total:0}})}fetchTags(){return this.portal._request(this.url+"/tags").then(e=>e.tags)}getThumbnailUrl(e){let t=this.thumbnailUrl;return t&&e&&(t+=`&w=${e}`),t}queryFavorites(e){return this.favGroupId?(this._favGroup||(this._favGroup=new kC({id:this.favGroupId,portal:this.portal})),this._favGroup.queryItems(e)):Promise.reject(new ue("internal:unknown","Unknown internal error",{internalError:"Unknown favGroupId"}))}toJSON(){throw new ue("internal:not-yet-implemented","PortalGroup.toJSON is not yet implemented")}static fromJSON(e){if(!e)return null;if(e.declaredClass)throw new Error("JSON object is already hydrated");const t=new AC;return t.sourceJSON=e,t.read(e),t}};g([w()],Ir.prototype,"access",void 0),g([w({type:Date})],Ir.prototype,"created",void 0),g([w()],Ir.prototype,"culture",void 0),g([w()],Ir.prototype,"description",void 0),g([w()],Ir.prototype,"email",void 0),g([w()],Ir.prototype,"favGroupId",void 0),g([w()],Ir.prototype,"fullName",void 0),g([w({type:Date})],Ir.prototype,"modified",void 0),g([w()],Ir.prototype,"orgId",void 0),g([w()],Ir.prototype,"portal",void 0),g([w()],Ir.prototype,"preferredView",void 0),g([w()],Ir.prototype,"privileges",void 0),g([w()],Ir.prototype,"region",void 0),g([w()],Ir.prototype,"role",void 0),g([w()],Ir.prototype,"roleId",void 0),g([w()],Ir.prototype,"sourceJSON",void 0),g([w()],Ir.prototype,"thumbnail",void 0),g([w({readOnly:!0})],Ir.prototype,"thumbnailUrl",null),g([w()],Ir.prototype,"units",void 0),g([w({readOnly:!0})],Ir.prototype,"userContentUrl",null),g([w({readOnly:!0})],Ir.prototype,"url",null),g([w()],Ir.prototype,"username",void 0),g([w()],Ir.prototype,"userType",void 0),Ir=AC=g([te("esri.portal.PortalUser")],Ir);const PC=Ir;var gwe=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",default:PC}),Na;let LC;const kB={PortalGroup:()=>Promise.resolve().then(function(){return mwe}),PortalItem:()=>Promise.resolve().then(function(){return YB}),PortalUser:()=>Promise.resolve().then(function(){return gwe})};let nt=Na=class extends yw(Xo){constructor(e){super(e),this._esriIdCredentialCreateHandle=null,this.access=null,this.allSSL=!1,this.authMode="auto",this.authorizedCrossOriginDomains=null,this.basemapGalleryGroupQuery=null,this.bingKey=null,this.canListApps=!1,this.canListData=!1,this.canListPreProvisionedItems=!1,this.canProvisionDirectPurchase=!1,this.canSearchPublic=!0,this.canShareBingPublic=!1,this.canSharePublic=!1,this.canSignInArcGIS=!1,this.canSignInIDP=!1,this.colorSetsGroupQuery=null,this.commentsEnabled=!1,this.created=null,this.culture=null,this.customBaseUrl=null,this.defaultBasemap=null,this.defaultDevBasemap=null,this.defaultExtent=null,this.defaultVectorBasemap=null,this.description=null,this.devBasemapGalleryGroupQuery=null,this.eueiEnabled=null,this.featuredGroups=null,this.featuredItemsGroupQuery=null,this.galleryTemplatesGroupQuery=null,this.livingAtlasGroupQuery=null,this.hasCategorySchema=!1,this.helperServices=null,this.homePageFeaturedContent=null,this.homePageFeaturedContentCount=null,this.httpPort=null,this.httpsPort=null,this.id=null,this.ipCntryCode=null,this.isPortal=!1,this.isReadOnly=!1,this.layerTemplatesGroupQuery=null,this.maxTokenExpirationMinutes=null,this.modified=null,this.name=null,this.portalHostname=null,this.portalMode=null,this.portalProperties=null,this.region=null,this.rotatorPanels=null,this.showHomePageDescription=!1,this.sourceJSON=null,this.supportsHostedServices=!1,this.symbolSetsGroupQuery=null,this.templatesGroupQuery=null,this.units=null,this.url=$i.portalUrl,this.urlKey=null,this.user=null,this.useStandardizedQuery=!1,this.useVectorBasemaps=!1,this.vectorBasemapGalleryGroupQuery=null}normalizeCtorArgs(e){return typeof e=="string"?{url:e}:e}destroy(){this._esriIdCredentialCreateHandle=mr(this._esriIdCredentialCreateHandle)}readAuthorizedCrossOriginDomains(e){if(e)for(const t of e)$i.request.trustedServers.includes(t)||$i.request.trustedServers.push(t);return e}readDefaultBasemap(e){return this._readBasemap(e)}readDefaultDevBasemap(e){return this._readBasemap(e)}readDefaultVectorBasemap(e){return this._readBasemap(e)}get extraQuery(){const e=!(this.user&&this.user.orgId)||this.canSearchPublic;return this.id&&!e?` AND orgid:${this.id}`:null}get isOrganization(){return!!this.access}get itemPageUrl(){return this.url?`${this.url}/home/item.html`:null}get restUrl(){let e=this.url;if(e){const t=e.indexOf("/sharing");e=t>0?e.substring(0,t):this.url.replace(/\/+$/,""),e+="/sharing/rest"}return e}get thumbnailUrl(){const e=this.restUrl,t=this.thumbnail;return e&&t?this._normalizeSSL(e+"/portals/self/resources/"+t):null}readUrlKey(e){return e&&e.toLowerCase()}readUser(e){let t=null;return e&&(t=PC.fromJSON(e),t.portal=this),t}load(e){const t=Promise.resolve().then(function(){return s_e}).then(({default:i})=>{ur(e),LC=i}).then(()=>this.sourceJSON?this.sourceJSON:this._fetchSelf(this.authMode,!1,e)).then(i=>{if(tr){const r=tr;this.credential=r.findCredential(this.restUrl),this.credential||this.authMode!==Na.AUTH_MODE_AUTO||(this._esriIdCredentialCreateHandle=r.on("credential-create",()=>{r.findCredential(this.restUrl)&&this._signIn().catch(()=>{})}))}this.sourceJSON=i,this.read(i)});return this.addResolvingPromise(t),Promise.resolve(this)}async createElevationLayers(){await this.load();const e=this._getHelperService("defaultElevationLayers"),t=(await import("./ElevationLayer.72d00de7.js")).default;return e?e.map(i=>new t({id:i.id,url:i.url})):[]}fetchBasemaps(e,t){const i=new $h;return i.query=e||($i.apiKey&&$C(this.url)?this.devBasemapGalleryGroupQuery:this.useVectorBasemaps?this.vectorBasemapGalleryGroupQuery:this.basemapGalleryGroupQuery),i.disableExtraQuery=!0,this.queryGroups(i,t).then(r=>{if(i.num=100,i.query='type:"Web Map" -type:"Web Application"',r.total){const n=r.results[0];return i.sortField=n.sortField||"name",i.sortOrder=n.sortOrder||"desc",n.queryItems(i,t)}return null}).then(r=>{let n;return n=r&&r.total?r.results.filter(o=>o.type==="Web Map").map(o=>new LC({portalItem:o})):[],n})}fetchCategorySchema(e){return this.hasCategorySchema?this._request(this.restUrl+"/portals/self/categorySchema",e).then(t=>t.categorySchema):ka(e)?Promise.reject(Qi()):Promise.resolve([])}fetchFeaturedGroups(e){const t=this.featuredGroups,i=new $h;if(i.num=100,i.sortField="title",t&&t.length){const r=[];for(const n of t)r.push(`(title:"${n.title}" AND owner:${n.owner})`);return i.query=r.join(" OR "),this.queryGroups(i,e).then(n=>n.results)}return ka(e)?Promise.reject(Qi()):Promise.resolve([])}fetchRegions(e){var i;const t=((i=this.user)==null?void 0:i.culture)||this.culture||io();return this._request(this.restUrl+"/portals/regions",Ce(K({},e),{query:{culture:t}}))}fetchSettings(e){var i;const t=((i=this.user)==null?void 0:i.culture)||this.culture||io();return this._request(this.restUrl+"/portals/self/settings",Ce(K({},e),{query:{culture:t}}))}static getDefault(){return Na._default&&!Na._default.destroyed||(Na._default=new Na),Na._default}queryGroups(e,t){return this._queryPortal("/community/groups",e,"PortalGroup",t)}queryItems(e,t){return this._queryPortal("/search",e,"PortalItem",t)}queryUsers(e,t){return e.sortField||(e.sortField="username"),this._queryPortal("/community/users",e,"PortalUser",t)}toJSON(){throw new ue("internal:not-yet-implemented","Portal.toJSON is not yet implemented")}static fromJSON(e){if(!e)return null;if(e.declaredClass)throw new Error("JSON object is already hydrated");return new Na({sourceJSON:e})}_getHelperService(e){const t=this.helperServices&&this.helperServices[e];if(!t)throw new ue("portal:service-not-found",`The \`helperServices\` do not include an entry named "${e}"`);return t}_getHelperServiceUrl(e){const t=this._getHelperService(e);if(!(t==null?void 0:t.url))throw new ue("portal:service-url-not-found",`The \`helperServices\` entry "${e}" does not include a \`url\` value`);return t.url}_fetchSelf(e=this.authMode,t=!1,i){const r=this.restUrl+"/portals/self",n=K({authMode:e,query:{culture:io().toLowerCase()}},i);return n.authMode==="auto"&&(n.authMode="no-prompt"),t&&(n.query.default=!0),this._request(r,n)}_queryPortal(e,t,i,r){const n=Oi($h,t),o=c=>this._request(this.restUrl+e,K(K({},n.toRequestOptions(this)),r)).then(h=>{const m=n.clone();return m.start=h.nextStart,new fwe({nextQueryParams:m,queryParams:n,total:h.total,results:Na._resultsToTypedArray(c,{portal:this},h,r)})}).then(h=>Promise.all(h.results.map(m=>typeof m.when=="function"?m.when():h)).then(()=>h,m=>(f0(m),h)));return i&&kB[i]?kB[i]().then(({default:c})=>(ur(r),o(c))):o()}_signIn(){if(this.authMode===Na.AUTH_MODE_ANONYMOUS)return Promise.reject(new ue("portal:invalid-auth-mode",`Current "authMode"' is "${this.authMode}"`));if(this.loadStatus==="failed")return Promise.reject(this.loadError);const e=t=>Promise.resolve().then(()=>this.loadStatus==="not-loaded"?(t||(this.authMode="immediate"),this.load().then(()=>null)):this.loadStatus==="loading"?this.load().then(()=>this.credential?null:(this.credential=t,this._fetchSelf("immediate"))):this.user&&this.credential===t?null:(this.credential=t,this._fetchSelf("immediate"))).then(i=>{i&&(this.sourceJSON=i,this.read(i))});return tr?tr.getCredential(this.restUrl).then(t=>e(t)):e(this.credential)}_normalizeSSL(e){return e.replace(/^http:/i,"https:").replace(":7080",":7443")}_normalizeUrl(e){const t=this.credential&&this.credential.token;return this._normalizeSSL(t?e+(e.includes("?")?"&":"?")+"token="+t:e)}_requestToTypedArray(e,t,i){return this._request(e,t).then(r=>{const n=Na._resultsToTypedArray(i,{portal:this},r);return Promise.all(n.map(o=>typeof o.when=="function"?o.when():r)).then(()=>n,()=>n)})}_readBasemap(e){if(e){const t=LC.fromJSON(e);return t.portalItem={portal:this},t}return null}_request(e,t={}){const i=K({f:"json"},t.query),{authMode:r=this.authMode===Na.AUTH_MODE_ANONYMOUS?"anonymous":"auto",body:n=null,cacheBust:o=!1,method:c="auto",responseType:h="json",signal:m}=t,b={authMode:r,body:n,cacheBust:o,method:c,query:i,responseType:h,timeout:0,signal:m};return Nt(this._normalizeSSL(e),b).then(x=>x.data)}static _resultsToTypedArray(e,t,i,r){let n;if(i){const o=H(r)?r.signal:null;n=i.listings||i.notifications||i.userInvitations||i.tags||i.items||i.groups||i.comments||i.provisions||i.results||i.relatedItems||i,(e||t)&&(n=n.map(c=>{const h=Object.assign(e?e.fromJSON(c):c,t);return typeof h.load=="function"&&h.load(o),h}))}else n=[];return n}};nt.AUTH_MODE_ANONYMOUS="anonymous",nt.AUTH_MODE_AUTO="auto",nt.AUTH_MODE_IMMEDIATE="immediate",g([w()],nt.prototype,"access",void 0),g([w()],nt.prototype,"allSSL",void 0),g([w()],nt.prototype,"authMode",void 0),g([w()],nt.prototype,"authorizedCrossOriginDomains",void 0),g([We("authorizedCrossOriginDomains")],nt.prototype,"readAuthorizedCrossOriginDomains",null),g([w()],nt.prototype,"basemapGalleryGroupQuery",void 0),g([w()],nt.prototype,"bingKey",void 0),g([w()],nt.prototype,"canListApps",void 0),g([w()],nt.prototype,"canListData",void 0),g([w()],nt.prototype,"canListPreProvisionedItems",void 0),g([w()],nt.prototype,"canProvisionDirectPurchase",void 0),g([w()],nt.prototype,"canSearchPublic",void 0),g([w()],nt.prototype,"canShareBingPublic",void 0),g([w()],nt.prototype,"canSharePublic",void 0),g([w()],nt.prototype,"canSignInArcGIS",void 0),g([w()],nt.prototype,"canSignInIDP",void 0),g([w()],nt.prototype,"colorSetsGroupQuery",void 0),g([w()],nt.prototype,"commentsEnabled",void 0),g([w({type:Date})],nt.prototype,"created",void 0),g([w()],nt.prototype,"credential",void 0),g([w()],nt.prototype,"culture",void 0),g([w()],nt.prototype,"currentVersion",void 0),g([w()],nt.prototype,"customBaseUrl",void 0),g([w()],nt.prototype,"defaultBasemap",void 0),g([We("defaultBasemap")],nt.prototype,"readDefaultBasemap",null),g([w()],nt.prototype,"defaultDevBasemap",void 0),g([We("defaultDevBasemap")],nt.prototype,"readDefaultDevBasemap",null),g([w({type:gi})],nt.prototype,"defaultExtent",void 0),g([w()],nt.prototype,"defaultVectorBasemap",void 0),g([We("defaultVectorBasemap")],nt.prototype,"readDefaultVectorBasemap",null),g([w()],nt.prototype,"description",void 0),g([w()],nt.prototype,"devBasemapGalleryGroupQuery",void 0),g([w()],nt.prototype,"eueiEnabled",void 0),g([w({readOnly:!0})],nt.prototype,"extraQuery",null),g([w()],nt.prototype,"featuredGroups",void 0),g([w()],nt.prototype,"featuredItemsGroupQuery",void 0),g([w()],nt.prototype,"galleryTemplatesGroupQuery",void 0),g([w()],nt.prototype,"livingAtlasGroupQuery",void 0),g([w()],nt.prototype,"hasCategorySchema",void 0),g([w()],nt.prototype,"helpBase",void 0),g([w()],nt.prototype,"helperServices",void 0),g([w()],nt.prototype,"helpMap",void 0),g([w()],nt.prototype,"homePageFeaturedContent",void 0),g([w()],nt.prototype,"homePageFeaturedContentCount",void 0),g([w()],nt.prototype,"httpPort",void 0),g([w()],nt.prototype,"httpsPort",void 0),g([w()],nt.prototype,"id",void 0),g([w()],nt.prototype,"ipCntryCode",void 0),g([w({readOnly:!0})],nt.prototype,"isOrganization",null),g([w()],nt.prototype,"isPortal",void 0),g([w()],nt.prototype,"isReadOnly",void 0),g([w({readOnly:!0})],nt.prototype,"itemPageUrl",null),g([w()],nt.prototype,"layerTemplatesGroupQuery",void 0),g([w()],nt.prototype,"maxTokenExpirationMinutes",void 0),g([w({type:Date})],nt.prototype,"modified",void 0),g([w()],nt.prototype,"name",void 0),g([w()],nt.prototype,"portalHostname",void 0),g([w()],nt.prototype,"portalMode",void 0),g([w()],nt.prototype,"portalProperties",void 0),g([w()],nt.prototype,"region",void 0),g([w({readOnly:!0})],nt.prototype,"restUrl",null),g([w()],nt.prototype,"rotatorPanels",void 0),g([w()],nt.prototype,"showHomePageDescription",void 0),g([w()],nt.prototype,"sourceJSON",void 0),g([w()],nt.prototype,"staticImagesUrl",void 0),g([w({json:{name:"2DStylesGroupQuery"}})],nt.prototype,"stylesGroupQuery2d",void 0),g([w({json:{name:"stylesGroupQuery"}})],nt.prototype,"stylesGroupQuery3d",void 0),g([w()],nt.prototype,"supportsHostedServices",void 0),g([w()],nt.prototype,"symbolSetsGroupQuery",void 0),g([w()],nt.prototype,"templatesGroupQuery",void 0),g([w()],nt.prototype,"thumbnail",void 0),g([w({readOnly:!0})],nt.prototype,"thumbnailUrl",null),g([w()],nt.prototype,"units",void 0),g([w()],nt.prototype,"url",void 0),g([w()],nt.prototype,"urlKey",void 0),g([We("urlKey")],nt.prototype,"readUrlKey",null),g([w()],nt.prototype,"user",void 0),g([We("user")],nt.prototype,"readUser",null),g([w()],nt.prototype,"useStandardizedQuery",void 0),g([w()],nt.prototype,"useVectorBasemaps",void 0),g([w()],nt.prototype,"vectorBasemapGalleryGroupQuery",void 0),nt=Na=g([te("esri.portal.Portal")],nt);const nn=nt;let V0=class extends rn(ke){constructor(e){super(e),this.type="style",this.placement="begin-end",this.style="arrow",this.color=null}equals(e){return H(e)&&e.placement===this.placement&&e.style===this.style&&(ce(this.color)&&ce(e.color)||H(this.color)&&H(e.color)&&this.color.toJSON()===e.color.toJSON())}};g([w({type:["style"],readOnly:!0,json:{read:!0,write:{ignoreOrigin:!0}}})],V0.prototype,"type",void 0),g([w({type:Lve,json:{default:"begin-end",write:!0}})],V0.prototype,"placement",void 0),g([w({type:FG,json:{default:"arrow",write:!0}})],V0.prototype,"style",void 0),g([w({type:ut,json:{type:[Ri],default:null,write:!0}})],V0.prototype,"color",void 0),V0=g([te("esri.symbols.LineStyleMarker3D")],V0);const OC=V0;var C5;let hu=C5=class extends ou{constructor(e){super(e),this.material=null,this.type="line",this.join="miter",this.cap="butt",this.size=$n(1),this.pattern=null,this.marker=null}clone(){const e={enabled:this.enabled,material:H(this.material)?this.material.clone():null,size:this.size,join:this.join,cap:this.cap,pattern:H(this.pattern)?this.pattern.clone():null,marker:H(this.marker)?this.marker.clone():null};return new C5(e)}static fromSimpleLineSymbol(e){var i,r,n;const t={enabled:!0,size:(i=e.width)!=null?i:$n(1),cap:e.cap||"butt",join:e.join||"miter",pattern:e.style&&e.style!=="inside-frame"?new Y6({style:e.style}):null,material:new Oa({color:(e.color||Kw).clone()}),marker:e.marker?new OC({placement:e.marker.placement,style:e.marker.style,color:(n=(r=e.marker.color)==null?void 0:r.clone())!=null?n:null}):null};return new C5(t)}};g([w({type:Oa,json:{write:!0}})],hu.prototype,"material",void 0),g([Pt({Line:"line"},{readOnly:!0})],hu.prototype,"type",void 0),g([w({type:HG,json:{write:!0,default:"miter"}})],hu.prototype,"join",void 0),g([w({type:oC,json:{write:!0,default:"butt"}})],hu.prototype,"cap",void 0),g([w(au)],hu.prototype,"size",void 0),g([w(zG)],hu.prototype,"pattern",void 0),g([w({types:{key:"type",base:OC,typeMap:{style:OC}},json:{write:!0}})],hu.prototype,"marker",void 0),hu=C5=g([te("esri.symbols.LineSymbol3DLayer")],hu);const l_=hu;var RC;const vwe=Ns()({sphere:"sphere",cylinder:"cylinder",cube:"cube",cone:"cone",diamond:"diamond",tetrahedron:"tetrahedron",invertedCone:"inverted-cone"});let c_=RC=class extends ke{clone(){return new RC({href:this.href,primitive:this.primitive})}};g([w({type:String,json:{read:_C,write:R0}})],c_.prototype,"href",void 0),g([Pt(vwe)],c_.prototype,"primitive",void 0),c_=RC=g([te("esri.symbols.support.ObjectSymbol3DLayerResource")],c_);const bwe="sphere";var FC;let z0=FC=class extends Ye{constructor(){super(...arguments),this.x=0,this.y=0,this.z=0}clone(){return new FC({x:this.x,y:this.y,z:this.z})}};g([w({type:Number})],z0.prototype,"x",void 0),g([w({type:Number})],z0.prototype,"y",void 0),g([w({type:Number})],z0.prototype,"z",void 0),z0=FC=g([te("esri.symbols.support.Symbol3DAnchorPosition3D")],z0);var NC;let so=NC=class extends ou{constructor(e){super(e),this.material=null,this.castShadows=!0,this.resource=null,this.type="object",this.width=void 0,this.height=void 0,this.depth=void 0,this.anchor=void 0,this.anchorPosition=void 0,this.heading=void 0,this.tilt=void 0,this.roll=void 0}clone(){return new NC({heading:this.heading,tilt:this.tilt,roll:this.roll,anchor:this.anchor,anchorPosition:this.anchorPosition&&this.anchorPosition.clone(),depth:this.depth,enabled:this.enabled,height:this.height,material:H(this.material)?this.material.clone():null,castShadows:this.castShadows,resource:this.resource&&this.resource.clone(),width:this.width})}get isPrimitive(){return!this.resource||typeof this.resource.href!="string"}};g([w({type:Oa,json:{write:!0}})],so.prototype,"material",void 0),g([w({type:Boolean,nonNullable:!0,json:{write:!0,default:!0}})],so.prototype,"castShadows",void 0),g([w({type:c_,json:{write:!0}})],so.prototype,"resource",void 0),g([Pt({Object:"object"},{readOnly:!0})],so.prototype,"type",void 0),g([w({type:Number,json:{write:!0}})],so.prototype,"width",void 0),g([w({type:Number,json:{write:!0}})],so.prototype,"height",void 0),g([w({type:Number,json:{write:!0}})],so.prototype,"depth",void 0),g([Pt({center:"center",top:"top",bottom:"bottom",origin:"origin",relative:"relative"}),w({json:{default:"origin"}})],so.prototype,"anchor",void 0),g([w({type:z0,json:{type:[Number],read:{reader:e=>new z0({x:e[0],y:e[1],z:e[2]})},write:{writer:(e,t)=>{t.anchorPosition=[e.x,e.y,e.z]},overridePolicy(){return{enabled:this.anchor==="relative"}}}}})],so.prototype,"anchorPosition",void 0),g([w({type:Number,json:{write:!0}})],so.prototype,"heading",void 0),g([w({type:Number,json:{write:!0}})],so.prototype,"tilt",void 0),g([w({type:Number,json:{write:!0}})],so.prototype,"roll",void 0),g([w({readOnly:!0})],so.prototype,"isPrimitive",null),so=NC=g([te("esri.symbols.ObjectSymbol3DLayer")],so);const DC=so;var jC;let Po=jC=class extends ou{constructor(e){super(e),this.material=null,this.castShadows=!0,this.type="path",this.profile="circle",this.join="miter",this.cap="butt",this.width=void 0,this.height=void 0,this.anchor="center",this.profileRotation="all"}readWidth(e,t){return e!=null?e:t.height==null&&t.size!=null?t.size:void 0}readHeight(e,t){return e!=null?e:t.width==null&&t.size!=null?t.size:void 0}clone(){return new jC({enabled:this.enabled,material:H(this.material)?this.material.clone():null,castShadows:this.castShadows,profile:this.profile,join:this.join,cap:this.cap,width:this.width,height:this.height,profileRotation:this.profileRotation,anchor:this.anchor})}};g([w({type:Oa,json:{write:!0}})],Po.prototype,"material",void 0),g([w({type:Boolean,nonNullable:!0,json:{write:!0,default:!0}})],Po.prototype,"castShadows",void 0),g([Pt({Path:"path"},{readOnly:!0})],Po.prototype,"type",void 0),g([w({type:["circle","quad"],json:{write:!0,default:"circle"}})],Po.prototype,"profile",void 0),g([w({type:HG,json:{write:!0,default:"miter"}})],Po.prototype,"join",void 0),g([w({type:ibe,json:{write:!0,default:"butt"}})],Po.prototype,"cap",void 0),g([w({type:Number,json:{write:{enabled:!0,target:{width:{type:Number},size:{type:Number}}}}})],Po.prototype,"width",void 0),g([We("width",["width","size","height"])],Po.prototype,"readWidth",null),g([w({type:Number,json:{write:!0}})],Po.prototype,"height",void 0),g([We("height",["height","size","width"])],Po.prototype,"readHeight",null),g([w({type:["center","bottom","top"],json:{write:!0,default:"center"}})],Po.prototype,"anchor",void 0),g([w({type:["heading","all"],json:{write:!0,default:"all"}})],Po.prototype,"profileRotation",void 0),Po=jC=g([te("esri.symbols.PathSymbol3DLayer")],Po);const VC=Po;var zC;let kg=zC=class extends ke{constructor(){super(...arguments),this.color=new ut([0,0,0,1]),this.size=0}clone(){const e={color:_e(this.color),size:this.size};return new zC(e)}};g([w($d)],kg.prototype,"color",void 0),g([w(au)],kg.prototype,"size",void 0),kg=zC=g([te("esri.symbols.support.Symbol3DHalo")],kg);let u_=class extends rn(ke){constructor(e){super(e),this.color=null}};g([w($d)],u_.prototype,"color",void 0),u_=g([te("esri.symbols.support.Symbol3DTextBackground")],u_);var k5;let Qo=k5=class extends ou{constructor(e){super(e),this._userSize=void 0,this.halo=null,this.horizontalAlignment="center",this.lineHeight=1,this.material=null,this.background=null,this.text=null,this.type="text",this.verticalAlignment="baseline"}get font(){return this._get("font")||null}set font(e){H(e)&&H(this._userSize)&&(e.size=this._userSize),this._set("font",e)}writeFont(e,t,i,r){const n=Ce(K({},r),{textSymbol3D:!0});t.font=e.write({},n),delete t.font.size}get size(){return H(this._userSize)?this._userSize:H(this.font)&&this.font.size!=null?this.font.size:9}set size(e){this._userSize=e,H(this.font)&&(this.font.size=this._userSize),this.notifyChange("size")}clone(){const e=new k5({enabled:this.enabled,font:this.font&&_e(this.font),halo:this.halo&&_e(this.halo),horizontalAlignment:this.horizontalAlignment,lineHeight:this.lineHeight,material:H(this.material)?this.material.clone():null,text:this.text,verticalAlignment:this.verticalAlignment,background:_e(this.background)});return e._userSize=this._userSize,e}static fromTextSymbol(e){return new k5({font:H(e.font)?e.font.clone():new w5,halo:wwe(e.haloColor,e.haloSize),horizontalAlignment:e.horizontalAlignment,lineHeight:e.lineHeight,material:e.color?new Oa({color:e.color.clone()}):null,text:e.text,verticalAlignment:e.verticalAlignment,background:e.backgroundColor?new u_({color:e.backgroundColor.clone()}):null})}};function wwe(e,t){return e&&t!=null&&t>0?new kg({color:_e(e),size:t}):null}g([w({type:w5,json:{write:!0}})],Qo.prototype,"font",null),g([tt("font")],Qo.prototype,"writeFont",null),g([w({type:kg,json:{write:!0}})],Qo.prototype,"halo",void 0),g([w(Ce(K({},JG),{json:{default:"center",write:!0}}))],Qo.prototype,"horizontalAlignment",void 0),g([w(Ce(K({},WG),{json:{default:1,write:!0}}))],Qo.prototype,"lineHeight",void 0),g([w({type:Oa,json:{write:!0}})],Qo.prototype,"material",void 0),g([w({type:u_,json:{write:!0}})],Qo.prototype,"background",void 0),g([w(au)],Qo.prototype,"size",null),g([w({type:String,json:{write:!0}})],Qo.prototype,"text",void 0),g([Pt({Text:"text"},{readOnly:!0})],Qo.prototype,"type",void 0),g([w(Ce(K({},ZG),{json:{default:"baseline",write:!0}}))],Qo.prototype,"verticalAlignment",void 0),Qo=k5=g([te("esri.symbols.TextSymbol3DLayer")],Qo);const Ag=Qo;var GC;let Pd=GC=class extends ou{constructor(e){super(e),this.color=BC.clone(),this.type="water",this.waterbodySize="medium",this.waveDirection=null,this.waveStrength="moderate"}clone(){return new GC({color:_e(this.color),waterbodySize:this.waterbodySize,waveDirection:this.waveDirection,waveStrength:this.waveStrength})}};g([w({type:ut,nonNullable:!0,json:{type:[Ri],write:(e,t,i)=>t[i]=e.toArray(ut.AlphaMode.UNLESS_OPAQUE),default:()=>BC.clone(),defaultEquals:e=>e.toCss(!0)===BC.toCss(!0)}})],Pd.prototype,"color",void 0),g([Pt({Water:"water"},{readOnly:!0})],Pd.prototype,"type",void 0),g([w({type:["small","medium","large"],json:{write:!0,default:"medium"}})],Pd.prototype,"waterbodySize",void 0),g([w({type:Number,json:{write:!0,default:null}})],Pd.prototype,"waveDirection",void 0),g([w({type:["calm","rippled","slight","moderate"],json:{write:!0,default:"moderate"}})],Pd.prototype,"waveStrength",void 0),Pd=GC=g([te("esri.symbols.WaterSymbol3DLayer")],Pd);const BC=new ut([0,119,190]),AB=Pd;var UC;let G0=UC=class extends Ye{constructor(e){super(e),this.name=null,this.styleUrl=null,this.styleName=null,this.portal=null}clone(){return new UC({name:this.name,styleUrl:this.styleUrl,styleName:this.styleName,portal:this.portal})}};g([w({type:String})],G0.prototype,"name",void 0),g([w({type:String})],G0.prototype,"styleUrl",void 0),g([w({type:String})],G0.prototype,"styleName",void 0),g([w({type:nn})],G0.prototype,"portal",void 0),G0=UC=g([te("esri.symbols.support.StyleOrigin")],G0);const h_=G0;var qC;let B0=qC=class extends Ye{constructor(){super(...arguments),this.url=""}clone(){return new qC({url:this.url})}};g([w({type:String})],B0.prototype,"url",void 0),B0=qC=g([te("esri.symbols.support.Thumbnail")],B0);const PB={icon:N0,object:DC,line:l_,path:VC,fill:t_,extrude:RG,text:Ag,water:AB},_we=Xe.ofType({base:ou,key:"type",typeMap:PB,errorContext:"symbol-layer"});let pu=class extends Ao{constructor(e){super(e),this.styleOrigin=null,this.thumbnail=null,this.type=null;const t=this.__accessor__&&this.__accessor__.metadatas&&this.__accessor__.metadatas.symbolLayers,i=t&&t.type||Xe;this._set("symbolLayers",new i)}get color(){return null}set color(e){this.constructed&&$e.getLogger(this.declaredClass).error("Symbol3D does not support colors on the symbol level. Colors may be set on individual symbol layer materials instead.")}set symbolLayers(e){D0(e,this._get("symbolLayers"))}readStyleOrigin(e,t,i){if(e.styleUrl&&e.name){const r=kd(e.styleUrl,i);return new h_({styleUrl:r,name:e.name})}if(e.styleName&&e.name)return new h_({portal:i&&i.portal||nn.getDefault(),styleName:e.styleName,name:e.name});i&&i.messages&&i.messages.push(new Io("symbol3d:incomplete-style-origin","Style origin requires either a 'styleUrl' or 'styleName' and a 'name' property",{context:i,definition:e}))}writeStyleOrigin(e,t,i,r){if(e.styleUrl&&e.name){let n=r_(e.styleUrl,r);Fa(n)&&(n=zs(n)),t.styleOrigin={styleUrl:n,name:e.name}}else e.styleName&&e.name&&(e.portal&&r&&r.portal&&!rB(e.portal.restUrl,r.portal.restUrl)?r&&r.messages&&r.messages.push(new Io("symbol:cross-portal","The symbol style origin cannot be persisted because it refers to an item on a different portal than the one being saved to.",{symbol:this})):t.styleOrigin={styleName:e.styleName,name:e.name})}normalizeCtorArgs(e){return e instanceof ou||e&&PB[e.type]?{symbolLayers:[e]}:Array.isArray(e)?{symbolLayers:e}:e}};g([w({json:{read:!1,write:!1}})],pu.prototype,"color",null),g([w({type:_we,nonNullable:!0,json:{write:!0}}),Dt(gB)],pu.prototype,"symbolLayers",null),g([w({type:h_})],pu.prototype,"styleOrigin",void 0),g([We("styleOrigin")],pu.prototype,"readStyleOrigin",null),g([tt("styleOrigin",{"styleOrigin.styleUrl":{type:String},"styleOrigin.styleName":{type:String},"styleOrigin.name":{type:String}})],pu.prototype,"writeStyleOrigin",null),g([w({type:B0,json:{read:!1}})],pu.prototype,"thumbnail",void 0),g([w({type:["point-3d","line-3d","polygon-3d","mesh-3d","label-3d"],readOnly:!0})],pu.prototype,"type",void 0),pu=g([te("esri.symbols.Symbol3D")],pu);const Pg=pu;let p_=class extends ke{constructor(e){super(e),this.visible=!0}clone(){}};g([w({type:["line"],readOnly:!0,json:{read:!1,write:{ignoreOrigin:!0}}})],p_.prototype,"type",void 0),g([w({readOnly:!0})],p_.prototype,"visible",void 0),p_=g([te("esri.symbols.callouts.Callout3D")],p_);const LB=p_;var HC;let A5=HC=class extends ke{constructor(){super(...arguments),this.color=new ut("white")}clone(){return new HC({color:_e(this.color)})}};g([w($d)],A5.prototype,"color",void 0),A5=HC=g([te("esri.symbols.callouts.LineCallout3DBorder")],A5);const OB=A5;Object.freeze(Object.defineProperty({__proto__:null,default:OB},Symbol.toStringTag,{value:"Module"}));var WC;let Ld=WC=class extends LB{constructor(e){super(e),this.type="line",this.color=new ut([0,0,0,1]),this.size=$n(1),this.border=null}get visible(){return this.size>0&&H(this.color)&&this.color.a>0}clone(){return new WC({color:_e(this.color),size:this.size,border:_e(this.border)})}};g([Pt({line:"line"},{readOnly:!0})],Ld.prototype,"type",void 0),g([w($d)],Ld.prototype,"color",void 0),g([w(au)],Ld.prototype,"size",void 0),g([w({type:OB,json:{write:!0}})],Ld.prototype,"border",void 0),g([w({readOnly:!0})],Ld.prototype,"visible",null),Ld=WC=g([te("esri.symbols.callouts.LineCallout3D")],Ld);const xwe=Ld;function JC(e){if(!e)return!1;const t=e.verticalOffset;return!!t&&!(t.screenLength<=0||H(t.maxWorldLength)&&t.maxWorldLength<=0)}function RB(e){if(!e||!e.supportsCallout||!e.supportsCallout())return!1;const t=e.callout;return!!t&&!!t.visible&&!!JC(e)}function yJe(e){return e.type==="point-3d"||e.type==="label-3d"}function mJe(e){return e.horizontalAlignment==="center"}const FB={types:{key:"type",base:LB,typeMap:{line:xwe}},json:{write:!0}};var ZC;let Lg=ZC=class extends ke{constructor(e){super(e),this.screenLength=0,this.minWorldLength=0,this.maxWorldLength=null}clone(){return new ZC({screenLength:this.screenLength,minWorldLength:this.minWorldLength,maxWorldLength:this.maxWorldLength})}};g([w(au)],Lg.prototype,"screenLength",void 0),g([w({type:Number,nonNullable:!0,json:{write:!0,default:0}})],Lg.prototype,"minWorldLength",void 0),g([w({type:Number,json:{write:!0}})],Lg.prototype,"maxWorldLength",void 0),Lg=ZC=g([te("esri.symbols.support.Symbol3DVerticalOffset")],Lg);const NB=Lg;var P5;const DB=Xe.ofType({base:null,key:"type",typeMap:{text:Ag}});let Od=P5=class extends Pg{constructor(e){super(e),this.verticalOffset=null,this.callout=null,this.styleOrigin=null,this.symbolLayers=new DB,this.type="label-3d"}supportsCallout(){return!0}hasVisibleCallout(){return RB(this)}hasVisibleVerticalOffset(){return JC(this)}clone(){return new P5({styleOrigin:_e(this.styleOrigin),symbolLayers:_e(this.symbolLayers),thumbnail:_e(this.thumbnail),callout:_e(this.callout),verticalOffset:_e(this.verticalOffset)})}static fromTextSymbol(e){return new P5({symbolLayers:[Ag.fromTextSymbol(e)]})}};g([w({type:NB,json:{write:!0}})],Od.prototype,"verticalOffset",void 0),g([w(FB)],Od.prototype,"callout",void 0),g([w({json:{read:!1,write:!1}})],Od.prototype,"styleOrigin",void 0),g([w({type:DB})],Od.prototype,"symbolLayers",void 0),g([Pt({LabelSymbol3D:"label-3d"},{readOnly:!0})],Od.prototype,"type",void 0),Od=P5=g([te("esri.symbols.LabelSymbol3D")],Od);const L5=Od;var O5;const jB=Xe.ofType({base:null,key:"type",typeMap:{line:l_,path:VC}}),Swe=Xe.ofType({base:null,key:"type",typeMap:{line:l_,path:VC}});let d_=O5=class extends Pg{constructor(e){super(e),this.symbolLayers=new jB,this.type="line-3d"}clone(){return new O5({styleOrigin:_e(this.styleOrigin),symbolLayers:_e(this.symbolLayers),thumbnail:_e(this.thumbnail)})}static fromSimpleLineSymbol(e){return new O5({symbolLayers:[l_.fromSimpleLineSymbol(e)]})}};g([w({type:jB,json:{type:Swe}})],d_.prototype,"symbolLayers",void 0),g([Pt({LineSymbol3D:"line-3d"},{readOnly:!0})],d_.prototype,"type",void 0),d_=O5=g([te("esri.symbols.LineSymbol3D")],d_);const R5=d_;let Rd=class extends Ao{constructor(e){super(e),this.angle=0,this.type=null,this.xoffset=0,this.yoffset=0,this.size=9}hash(){return`${this.type}.${this.angle}.${this.size}.${this.xoffset}.${this.yoffset}`}};g([w({type:Number,json:{read:e=>e&&-1*e,write:(e,t)=>t.angle=e&&-1*e}})],Rd.prototype,"angle",void 0),g([w({type:["simple-marker","picture-marker"],readOnly:!0})],Rd.prototype,"type",void 0),g([w({type:Number,cast:Fi,json:{write:!0}})],Rd.prototype,"xoffset",void 0),g([w({type:Number,cast:Fi,json:{write:!0}})],Rd.prototype,"yoffset",void 0),g([w({type:Number,cast:e=>e==="auto"?e:Fi(e),json:{write:!0}})],Rd.prototype,"size",void 0),Rd=g([te("esri.symbols.MarkerSymbol")],Rd);const VB=Rd;var F5;const zB=Xe.ofType({base:null,key:"type",typeMap:{fill:t_}});let f_=F5=class extends Pg{constructor(e){super(e),this.symbolLayers=new zB,this.type="mesh-3d"}clone(){return new F5({styleOrigin:_e(this.styleOrigin),symbolLayers:_e(this.symbolLayers),thumbnail:_e(this.thumbnail)})}static fromSimpleFillSymbol(e){return new F5({symbolLayers:[t_.fromSimpleFillSymbol(e)]})}};g([w({type:zB})],f_.prototype,"symbolLayers",void 0),g([Pt({MeshSymbol3D:"mesh-3d"},{readOnly:!0})],f_.prototype,"type",void 0),f_=F5=g([te("esri.symbols.MeshSymbol3D")],f_);const N5=f_;function Mwe(e,t,i){return t.imageData?oB({mediaType:t.contentType||"image/png",isBase64:!0,data:t.imageData}):GB(t.url,i)}function GB(e,t){var i;return $we(t)&&!Fa(e)&&((i=t==null?void 0:t.layer)==null?void 0:i.parsedUrl)?Cd(t.layer.parsedUrl.path,"images",e):kd(e,t)}function Iwe(e,t,i,r){if(O0(e)){const n=fC(e);if(!n)return;t.contentType=n.mediaType,t.imageData=n.data,i&&i.imageData===t.imageData&&i.url&&R0(i.url,t,"url",r)}else R0(e,t,"url",r)}const BB={json:{read:{source:["imageData","url"],reader:Mwe},write:{writer(e,t,i,r){Iwe(e,t,this.source,r)}}}},UB={readOnly:!0,json:{read:{source:["imageData","url"],reader(e,t,i){const r={};return t.imageData&&(r.imageData=t.imageData),t.contentType&&(r.contentType=t.contentType),t.url&&(r.url=GB(t.url,i)),r}}}};function $we(e){var t,i;return!(e==null||e.origin!=="service"&&e.origin!=="portal-item"||((t=e.layer)==null?void 0:t.type)!=="feature"&&((i=e.layer)==null?void 0:i.type)!=="stream")}var KC;let vl=KC=class extends NG{constructor(...e){super(...e),this.type="picture-fill",this.url=null,this.xscale=1,this.yscale=1,this.width=12,this.height=12,this.xoffset=0,this.yoffset=0,this.source=null}normalizeCtorArgs(e,t,i,r){if(e&&typeof e!="string"&&e.imageData==null)return e;const n={};return e&&(n.url=e),t&&(n.outline=t),i!=null&&(n.width=Fi(i)),r!=null&&(n.height=Fi(r)),n}clone(){const e=new KC({color:_e(this.color),height:this.height,outline:this.outline&&this.outline.clone(),url:this.url,width:this.width,xoffset:this.xoffset,xscale:this.xscale,yoffset:this.yoffset,yscale:this.yscale});return e._set("source",_e(this.source)),e}hash(){var e;return`${super.hash()}.${(e=this.color)==null?void 0:e.hash()}.${this.height}.${this.url}.${this.width}.${this.xoffset}.${this.xscale}.${this.yoffset}.${this.yscale}`}};g([Pt({esriPFS:"picture-fill"},{readOnly:!0})],vl.prototype,"type",void 0),g([w(BB)],vl.prototype,"url",void 0),g([w({type:Number,json:{write:!0}})],vl.prototype,"xscale",void 0),g([w({type:Number,json:{write:!0}})],vl.prototype,"yscale",void 0),g([w({type:Number,cast:Fi,json:{write:!0}})],vl.prototype,"width",void 0),g([w({type:Number,cast:Fi,json:{write:!0}})],vl.prototype,"height",void 0),g([w({type:Number,cast:Fi,json:{write:!0}})],vl.prototype,"xoffset",void 0),g([w({type:Number,cast:Fi,json:{write:!0}})],vl.prototype,"yoffset",void 0),g([w(UB)],vl.prototype,"source",void 0),vl=KC=g([te("esri.symbols.PictureFillSymbol")],vl);const qB=vl;var YC;let lc=YC=class extends VB{constructor(...e){super(...e),this.color=null,this.type="picture-marker",this.url=null,this.source=null,this.height=12,this.width=12,this.size=null}normalizeCtorArgs(e,t,i){if(e&&typeof e!="string"&&e.imageData==null)return e;const r={};return e&&(r.url=e),t!=null&&(r.width=Fi(t)),i!=null&&(r.height=Fi(i)),r}readHeight(e,t){return t.size||e}readWidth(e,t){return t.size||e}clone(){const e=new YC({angle:this.angle,height:this.height,url:this.url,width:this.width,xoffset:this.xoffset,yoffset:this.yoffset});return e._set("source",_e(this.source)),e}hash(){return`${super.hash()}.${this.height}.${this.url}.${this.width}`}};g([w({json:{write:!1}})],lc.prototype,"color",void 0),g([Pt({esriPMS:"picture-marker"},{readOnly:!0})],lc.prototype,"type",void 0),g([w(BB)],lc.prototype,"url",void 0),g([w(UB)],lc.prototype,"source",void 0),g([w({type:Number,cast:Fi,json:{write:!0}})],lc.prototype,"height",void 0),g([We("height",["height","size"])],lc.prototype,"readHeight",null),g([w({type:Number,cast:Fi,json:{write:!0}})],lc.prototype,"width",void 0),g([w({json:{write:!1}})],lc.prototype,"size",void 0),lc=YC=g([te("esri.symbols.PictureMarkerSymbol")],lc);const Og=lc;var U0;const HB=Xe.ofType({base:null,key:"type",typeMap:{icon:N0,object:DC,text:Ag}});let q0=U0=class extends Pg{constructor(e){super(e),this.verticalOffset=null,this.callout=null,this.symbolLayers=new HB,this.type="point-3d"}supportsCallout(){if((this.symbolLayers?this.symbolLayers.length:0)<1)return!1;for(const e of this.symbolLayers.items)switch(e.type){case"icon":case"text":case"object":continue;default:return!1}return!0}hasVisibleCallout(){return RB(this)}hasVisibleVerticalOffset(){return JC(this)}clone(){return new U0({verticalOffset:_e(this.verticalOffset),callout:_e(this.callout),styleOrigin:_e(this.styleOrigin),symbolLayers:_e(this.symbolLayers),thumbnail:_e(this.thumbnail)})}static fromSimpleMarkerSymbol(e){return new U0({symbolLayers:[N0.fromSimpleMarkerSymbol(e)]})}static fromPictureMarkerSymbol(e){return new U0({symbolLayers:[N0.fromPictureMarkerSymbol(e)]})}static fromCIMSymbol(e){var r,n;if(((n=(r=e.data)==null?void 0:r.symbol)==null?void 0:n.type)!=="CIMPointSymbol")return null;const i=e.data.symbol;return new U0((i==null?void 0:i.callout)?{symbolLayers:[N0.fromCIMSymbol(e)],callout:{type:"line",size:.5,color:[0,0,0]},verticalOffset:{screenLength:40}}:{symbolLayers:[N0.fromCIMSymbol(e)]})}static fromTextSymbol(e){return new U0({symbolLayers:[Ag.fromTextSymbol(e)]})}};g([w({type:NB,json:{write:!0}})],q0.prototype,"verticalOffset",void 0),g([w(FB)],q0.prototype,"callout",void 0),g([w({type:HB,json:{origins:{"web-scene":{write:!0}}}})],q0.prototype,"symbolLayers",void 0),g([Pt({PointSymbol3D:"point-3d"},{readOnly:!0})],q0.prototype,"type",void 0),q0=U0=g([te("esri.symbols.PointSymbol3D")],q0);const H0=q0;var y_;const WB=Xe.ofType({base:null,key:"type",typeMap:{extrude:RG,fill:t_,icon:N0,line:l_,object:DC,text:Ag,water:AB}});let m_=y_=class extends Pg{constructor(e){super(e),this.symbolLayers=new WB,this.type="polygon-3d"}clone(){return new y_({styleOrigin:_e(this.styleOrigin),symbolLayers:_e(this.symbolLayers),thumbnail:_e(this.thumbnail)})}static fromJSON(e){const t=new y_;if(t.read(e),t.symbolLayers.length===2&&t.symbolLayers.getItemAt(0).type==="fill"&&t.symbolLayers.getItemAt(1).type==="line"){const i=t.symbolLayers.getItemAt(0),r=t.symbolLayers.getItemAt(1);!r.enabled||e.symbolLayers&&e.symbolLayers[1]&&e.symbolLayers[1].enable===!1||(i.outline={size:r.size,color:H(r.material)?r.material.color:null}),t.symbolLayers.removeAt(1)}return t}static fromSimpleFillSymbol(e){return new y_({symbolLayers:[t_.fromSimpleFillSymbol(e)]})}};g([w({type:WB,json:{write:!0}})],m_.prototype,"symbolLayers",void 0),g([Pt({PolygonSymbol3D:"polygon-3d"},{readOnly:!0})],m_.prototype,"type",void 0),m_=y_=g([te("esri.symbols.PolygonSymbol3D")],m_);const g_=m_;var XC;const QC=new kt({esriSFSSolid:"solid",esriSFSNull:"none",esriSFSHorizontal:"horizontal",esriSFSVertical:"vertical",esriSFSForwardDiagonal:"forward-diagonal",esriSFSBackwardDiagonal:"backward-diagonal",esriSFSCross:"cross",esriSFSDiagonalCross:"diagonal-cross"});let W0=XC=class extends NG{constructor(...e){super(...e),this.color=new ut([0,0,0,.25]),this.outline=new rs,this.type="simple-fill",this.style="solid"}normalizeCtorArgs(e,t,i){if(e&&typeof e!="string")return e;const r={};return e&&(r.style=e),t&&(r.outline=t),i&&(r.color=i),r}clone(){return new XC({color:_e(this.color),outline:this.outline&&this.outline.clone(),style:this.style})}hash(){return`${super.hash()}${this.style}.${this.color&&this.color.hash()}`}};g([w()],W0.prototype,"color",void 0),g([w()],W0.prototype,"outline",void 0),g([Pt({esriSFS:"simple-fill"},{readOnly:!0})],W0.prototype,"type",void 0),g([w({type:QC.apiValues,json:{read:QC.read,write:QC.write}})],W0.prototype,"style",void 0),W0=XC=g([te("esri.symbols.SimpleFillSymbol")],W0);const ea=W0;var ek;const tk=new kt({esriSMSCircle:"circle",esriSMSSquare:"square",esriSMSCross:"cross",esriSMSX:"x",esriSMSDiamond:"diamond",esriSMSTriangle:"triangle",esriSMSPath:"path"});let du=ek=class extends VB{constructor(...e){super(...e),this.color=new ut([255,255,255,.25]),this.type="simple-marker",this.size=12,this.style="circle",this.outline=new rs}normalizeCtorArgs(e,t,i,r){if(e&&typeof e!="string")return e;const n={};return e&&(n.style=e),t!=null&&(n.size=Fi(t)),i&&(n.outline=i),r&&(n.color=r),n}writeColor(e,t){e&&this.style!=="x"&&this.style!=="cross"&&(t.color=e.toJSON()),e===null&&(t.color=null)}set path(e){this.style="path",this._set("path",e)}clone(){return new ek({angle:this.angle,color:_e(this.color),outline:this.outline&&this.outline.clone(),path:this.path,size:this.size,style:this.style,xoffset:this.xoffset,yoffset:this.yoffset})}hash(){var e;return`${super.hash()}.${this.color&&this.color.hash()}.${this.path}.${this.style}.${(e=this.outline)==null?void 0:e.hash()}`}};g([w()],du.prototype,"color",void 0),g([tt("color")],du.prototype,"writeColor",null),g([Pt({esriSMS:"simple-marker"},{readOnly:!0})],du.prototype,"type",void 0),g([w()],du.prototype,"size",void 0),g([w({type:tk.apiValues,json:{read:tk.read,write:tk.write}})],du.prototype,"style",void 0),g([w({type:String,json:{write:!0}})],du.prototype,"path",null),g([w({types:{key:"type",base:null,defaultKeyValue:"simple-line",typeMap:{"simple-line":rs}},json:{default:null,write:!0}})],du.prototype,"outline",void 0),du=ek=g([te("esri.symbols.SimpleMarkerSymbol")],du);const Dn=du;var ik;let Rr=ik=class extends Ao{constructor(...e){super(...e),this.backgroundColor=null,this.borderLineColor=null,this.borderLineSize=null,this.font=new w5,this.horizontalAlignment="center",this.kerning=!0,this.haloColor=null,this.haloSize=null,this.rightToLeft=null,this.rotated=!1,this.text="",this.type="text",this.verticalAlignment="baseline",this.xoffset=0,this.yoffset=0,this.angle=0,this.width=null,this.lineWidth=192,this.lineHeight=1}normalizeCtorArgs(e,t,i){if(e&&typeof e!="string")return e;const r={};return e&&(r.text=e),t&&(r.font=t),i&&(r.color=i),r}writeLineWidth(e,t,i,r){r&&typeof r!="string"?r.origin:t[i]=e}castLineWidth(e){return Fi(e)}writeLineHeight(e,t,i,r){r&&typeof r!="string"?r.origin:t[i]=e}clone(){return new ik({angle:this.angle,backgroundColor:_e(this.backgroundColor),borderLineColor:_e(this.borderLineColor),borderLineSize:this.borderLineSize,color:_e(this.color),font:this.font&&this.font.clone(),haloColor:_e(this.haloColor),haloSize:this.haloSize,horizontalAlignment:this.horizontalAlignment,kerning:this.kerning,lineHeight:this.lineHeight,lineWidth:this.lineWidth,rightToLeft:this.rightToLeft,rotated:this.rotated,text:this.text,verticalAlignment:this.verticalAlignment,width:this.width,xoffset:this.xoffset,yoffset:this.yoffset})}hash(){var e;return`${this.backgroundColor&&this.backgroundColor.hash()}.${this.borderLineColor}.${this.borderLineSize}.${(e=this.color)==null?void 0:e.hash()}.${this.font&&this.font.hash()}.${this.haloColor&&this.haloColor.hash()}.${this.haloSize}.${this.horizontalAlignment}.${this.kerning}.${this.rightToLeft}.${this.rotated}.${this.text}.${this.verticalAlignment}.${this.width}.${this.xoffset}.${this.yoffset}.${this.lineHeight}.${this.lineWidth}.${this.angle}`}};g([w({type:ut,json:{write:!0}})],Rr.prototype,"backgroundColor",void 0),g([w({type:ut,json:{write:!0}})],Rr.prototype,"borderLineColor",void 0),g([w({type:Number,json:{write:!0}})],Rr.prototype,"borderLineSize",void 0),g([w({type:w5,json:{write:!0}})],Rr.prototype,"font",void 0),g([w(Ce(K({},JG),{json:{write:!0}}))],Rr.prototype,"horizontalAlignment",void 0),g([w({type:Boolean,json:{write:!0}})],Rr.prototype,"kerning",void 0),g([w({type:ut,json:{write:!0}})],Rr.prototype,"haloColor",void 0),g([w({type:Number,cast:Fi,json:{write:!0}})],Rr.prototype,"haloSize",void 0),g([w({type:Boolean,json:{write:!0}})],Rr.prototype,"rightToLeft",void 0),g([w({type:Boolean,json:{write:!0}})],Rr.prototype,"rotated",void 0),g([w({type:String,json:{write:!0}})],Rr.prototype,"text",void 0),g([Pt({esriTS:"text"},{readOnly:!0})],Rr.prototype,"type",void 0),g([w(Ce(K({},ZG),{json:{write:!0}}))],Rr.prototype,"verticalAlignment",void 0),g([w({type:Number,cast:Fi,json:{write:!0}})],Rr.prototype,"xoffset",void 0),g([w({type:Number,cast:Fi,json:{write:!0}})],Rr.prototype,"yoffset",void 0),g([w({type:Number,json:{read:e=>e&&-1*e,write:(e,t)=>t.angle=e&&-1*e}})],Rr.prototype,"angle",void 0),g([w({type:Number,json:{write:!0}})],Rr.prototype,"width",void 0),g([w({type:Number})],Rr.prototype,"lineWidth",void 0),g([tt("lineWidth")],Rr.prototype,"writeLineWidth",null),g([Dt("lineWidth")],Rr.prototype,"castLineWidth",null),g([w(WG)],Rr.prototype,"lineHeight",void 0),g([tt("lineHeight")],Rr.prototype,"writeLineHeight",null),Rr=ik=g([te("esri.symbols.TextSymbol")],Rr);const J0=Rr;var rk;let cc=rk=class extends Ao{constructor(e){super(e),this.styleName=null,this.portal=null,this.styleUrl=null,this.thumbnail=null,this.name=null,this.type="web-style"}get _fetchCacheKey(){const e=H(this.portal)?this.portal:nn.getDefault(),t=e.user?e.user.username:null;return`${this.styleName}:${this.styleUrl}:${this.name}:${t}:${e.url}`}read(e,t){this.portal=t?t.portal:void 0,super.read(e,t)}clone(){return new rk({name:this.name,styleUrl:this.styleUrl,styleName:this.styleName,portal:this.portal})}fetchSymbol(e){return this._fetchSymbol("webRef",e)}fetchCIMSymbol(e){return this._fetchSymbol("cimRef",e)}async _fetchSymbol(e,t){const i=H(t)?t.cache:null,r=i?this._fetchCacheKey:null;if(H(i)){const h=r&&i.get(r);if(h)return h.clone()}const n=await Ewe();ur(t);const o=n.resolveWebStyleSymbol(this,{portal:this.portal},e,t);o.catch(h=>{$e.getLogger(this.declaredClass).error("#fetchSymbol()","Failed to create symbol from style",h)});const c=await o;return e==="webRef"&&c.type==="point-3d"||e==="cimRef"&&c.type==="cim"?(H(i)&&i.set(r,c.clone()),c):null}};function Ewe(){return Promise.resolve().then(function(){return $je})}g([w({json:{write:!1}})],cc.prototype,"color",void 0),g([w({type:String,json:{write:!0}})],cc.prototype,"styleName",void 0),g([w({type:nn,json:{write:!1}})],cc.prototype,"portal",void 0),g([w({type:String,json:{read:_C,write:R0}})],cc.prototype,"styleUrl",void 0),g([w({type:B0,json:{read:!1}})],cc.prototype,"thumbnail",void 0),g([w({type:String,json:{write:!0}})],cc.prototype,"name",void 0),g([Pt({styleSymbolReference:"web-style"},{readOnly:!0})],cc.prototype,"type",void 0),g([w()],cc.prototype,"_fetchCacheKey",null),cc=rk=g([te("esri.symbols.WebStyleSymbol")],cc);const Z0=cc;function D5(e){if(!e)return!1;switch(e.type){case"picture-fill":case"picture-marker":case"simple-fill":case"simple-line":case"simple-marker":case"text":case"cim":return!0;default:return!1}}function uc(e){if(!e)return!1;switch(e.type){case"label-3d":case"line-3d":case"mesh-3d":case"point-3d":case"polygon-3d":return!0;default:return!1}}const ta={base:Ao,key:"type",typeMap:{"simple-fill":ea,"picture-fill":qB,"picture-marker":Og,"simple-line":rs,"simple-marker":Dn,text:J0,"label-3d":L5,"line-3d":R5,"mesh-3d":N5,"point-3d":H0,"polygon-3d":g_,"web-style":Z0,cim:Id},errorContext:"symbol"},Twe={base:Ao,key:"type",typeMap:{"picture-marker":Og,"simple-marker":Dn,text:J0,"web-style":Z0,cim:Id},errorContext:"symbol"},Cwe=ad({types:ta}),j5={base:Ao,key:"type",typeMap:{"simple-fill":ea,"picture-fill":qB,"picture-marker":Og,"simple-line":rs,"simple-marker":Dn,text:J0,"line-3d":R5,"mesh-3d":N5,"point-3d":H0,"polygon-3d":g_,"web-style":Z0,cim:Id},errorContext:"symbol"},kwe={base:Ao,key:"type",typeMap:{text:J0,"label-3d":L5},errorContext:"symbol"},JB={base:Ao,key:"type",typeMap:{"line-3d":R5,"mesh-3d":N5,"point-3d":H0,"polygon-3d":g_,"web-style":Z0,cim:Id},errorContext:"symbol"},Awe={base:Ao,key:"type",typeMap:{"label-3d":L5},errorContext:"symbol"},ZB=Yc(ta);function Pwe(e){if(!e)return null;const t={};for(const i in e){const r=xs(e[i]);r&&(t[i]=r)}return Object.keys(t).length!==0?t:null}function Lwe(e){if(!H(e))return null;const t={};for(const i in e){const r=e[i];r&&(t[i]=r.toJSON())}return Object.keys(t).length!==0?t:null}let ia=class extends rn(ke){constructor(...e){super(...e),this.isAggregate=!1,this.layer=null,this.popupTemplate=null,this.sourceLayer=null,Object.defineProperty(this,"uid",{value:ig(),configurable:!0})}normalizeCtorArgs(e,t,i,r){return e&&!e.declaredClass?e:{geometry:e,symbol:t,attributes:i,popupTemplate:r}}set aggregateGeometries(e){const t=this._get("aggregateGeometries");JSON.stringify(t)!==JSON.stringify(e)&&this._set("aggregateGeometries",e)}set attributes(e){const t=this._get("attributes");t!==e&&(this._set("attributes",e),this._notifyLayer("attributes",t,e))}set geometry(e){const t=this._get("geometry");t!==e&&(this._set("geometry",e),this._notifyLayer("geometry",t,e))}set symbol(e){const t=this._get("symbol");t!==e&&(this._set("symbol",e),this._notifyLayer("symbol",t,e))}set visible(e){const t=this._get("visible");t!==e&&(this._set("visible",e),this._notifyLayer("visible",t,e))}getEffectivePopupTemplate(e=!1){if(this.popupTemplate)return this.popupTemplate;for(const t of[this.sourceLayer,this.layer])if(t){if("popupTemplate"in t&&t.popupTemplate)return t.popupTemplate;if(e&&"defaultPopupTemplate"in t&&H(t.defaultPopupTemplate))return t.defaultPopupTemplate}return null}getAttribute(e){var t;return(t=this.attributes)==null?void 0:t[e]}setAttribute(e,t){if(this.attributes){const i=this.getAttribute(e);this.attributes[e]=t,this._notifyLayer("attributes",i,t,e)}else this.attributes={[e]:t},this._notifyLayer("attributes",void 0,t,e)}getObjectId(){return this.sourceLayer&&"objectIdField"in this.sourceLayer&&this.sourceLayer.objectIdField?this.getAttribute(this.sourceLayer.objectIdField):null}toJSON(){return{aggregateGeometries:Lwe(this.aggregateGeometries),geometry:H(this.geometry)?this.geometry.toJSON():null,symbol:H(this.symbol)?this.symbol.toJSON():null,attributes:K({},this.attributes),popupTemplate:this.popupTemplate&&this.popupTemplate.toJSON()}}notifyGeometryChanged(){this._notifyLayer("geometry",this.geometry,this.geometry)}notifyMeshTransformChanged(){H(this.geometry)&&this.geometry.type==="mesh"&&this._notifyLayer("transform",this.geometry.transform,this.geometry.transform)}_notifyLayer(e,t,i,r){if(!this.layer||!("graphicChanged"in this.layer))return;const n={graphic:this,property:e,oldValue:t,newValue:i};e==="attributes"&&(n.attributeName=r),this.layer.graphicChanged(n)}};g([w({value:null,json:{read:Pwe}})],ia.prototype,"aggregateGeometries",null),g([w({value:null})],ia.prototype,"attributes",null),g([w({value:null,types:wh,json:{read:xs}})],ia.prototype,"geometry",null),g([w({type:Boolean})],ia.prototype,"isAggregate",void 0),g([w({clonable:"reference"})],ia.prototype,"layer",void 0),g([w({type:_d})],ia.prototype,"popupTemplate",void 0),g([w({clonable:"reference"})],ia.prototype,"sourceLayer",void 0),g([w({value:null,types:ta})],ia.prototype,"symbol",null),g([w({type:Boolean,value:!0})],ia.prototype,"visible",null),ia=g([te("esri.Graphic")],ia),function(e){e.generateUID=ig}(ia||(ia={}));const Gr=ia;function Owe(e,t,i){return Mr(e.map((r,n)=>t.apply(i,[r,n])))}async function Rwe(e,t,i){return(await Mr(e.map((r,n)=>t.apply(i,[r,n])))).map(r=>r.value)}function nk(e){return{ok:!0,value:e}}function sk(e){return{ok:!1,error:e}}function Fwe(e){return H(e)&&e.ok===!0?e.value:null}function Nwe(e){return H(e)&&e.ok===!1?e.error:null}async function V5(e){if(ce(e))return{ok:!1,error:new Error("no promise provided")};try{return nk(await e)}catch(t){return sk(t)}}async function gJe(e){try{return nk(await e)}catch(t){return f0(t),sk(t)}}function KB(e,t){return new Fd(e,t)}let Fd=class extends Ye{constructor(e,t){super({}),this._result=null,this._abortHandle=null,this.abort=()=>{this._abortController=Kl(this._abortController)},this.remove=this.abort,this._abortController=new AbortController;const{signal:i}=this._abortController;this.promise=e(i),this.promise.then(r=>{this._result=nk(r),this._cleanup()},r=>{this._result=sk(r),this._cleanup()}),this._abortHandle=Ho(t,this.abort)}get value(){return Fwe(this._result)}get error(){return Nwe(this._result)}get finished(){return H(this._result)}normalizeCtorArgs(){return{}}destroy(){this.abort()}_cleanup(){this._abortHandle=mr(this._abortHandle),this._abortController=null}};g([w()],Fd.prototype,"value",null),g([w()],Fd.prototype,"error",null),g([w()],Fd.prototype,"finished",null),g([w()],Fd.prototype,"promise",void 0),g([w()],Fd.prototype,"_result",void 0),Fd=g([te("esri.core.asyncUtils.ReactiveTask")],Fd);async function ok(e,t){return await e.load(),Dwe(e,t)}async function Dwe(e,t){const i=[],r=(...o)=>{for(const c of o)ce(c)||(Array.isArray(c)?r(...c):Xe.isCollection(c)?c.forEach(h=>r(h)):Xo.isLoadable(c)&&i.push(c))};t(r);let n=null;if(await Rwe(i,async o=>{(await V5(jwe(o)?o.loadAll():o.load())).ok!==!1||n||(n=o)}),n)throw n.loadError;return e}function jwe(e){return"loadAll"in e&&typeof e.loadAll=="function"}const Vwe=$e.getLogger("esri.assets");function _i(e){if(!$i.assetsPath)throw Vwe.errorOnce("The API assets location needs to be set using config.assetsPath. More information: https://arcg.is/1OzLe50"),new ue("assets:path-not-set","config.assetsPath is not set");return Cd($i.assetsPath,e)}let Nd=class extends Ye{constructor(e){super(e),this.portalItem=null}normalizeCtorArgs(e){return e&&e.portalItem&&e.path?Ce(K({},e),{path:this._normalizePath(e.path,e.portalItem)}):e}set path(e){H(e)&&Fa(e)?$e.getLogger(this.declaredClass).error("portalitemresource:invalid-path","A portal item resource path must be relative"):this._set("path",e)}_castPath(e){return this._normalizePath(e,this.portalItem)}get url(){return this.portalItem&&this.path?`${this.portalItem.itemUrl}/resources/${this.path}`:null}get itemRelativeUrl(){return this.portalItem&&this.path?`./resources/${this.path}`:null}fetch(e="json",t){const i=this.url;if(ce(i))throw new ue("portal-item-resource:fetch","Portal item resource does not refer to a valid item or path");return this.portalItem.portal._request(i,{responseType:e,query:{token:this.portalItem.apiKey},signal:Yb(t,"signal")})}async update(e,t){return(await import("./resourceUtils.38261f41.js")).addOrUpdateResource(this,"update",e,t)}hasPath(){return H(this.path)}_normalizePath(e,t){return ce(e)?e:(e=e.replace(/^\/+/,""),H(t)&&Fa(e)&&(e=dC(e,t.itemUrl)),e.replace(/^\/+/,"").replace(/^(\.\/)?resources\//,""))}};g([w()],Nd.prototype,"portalItem",void 0),g([w({type:String,value:null})],Nd.prototype,"path",null),g([Dt("path")],Nd.prototype,"_castPath",null),g([w({type:String,readOnly:!0})],Nd.prototype,"url",null),g([w({type:String,readOnly:!0})],Nd.prototype,"itemRelativeUrl",null),Nd=g([te("esri.portal.PortalItemResource")],Nd);const zwe=Nd;let v_=class extends Ye{constructor(e){super(e),this.created=null,this.rating=null}};g([w()],v_.prototype,"created",void 0),g([w()],v_.prototype,"rating",void 0),v_=g([te("esri.portal.PortalRating")],v_);const ak=v_;var Rg;const Gwe=new Set(["Map Service","Feature Service","Feature Collection","Scene Service","Image Service","Stream Service","Vector Tile Service","GeoJson","CSV","KML","WFS","WMTS","WMS","Feed"]),Bwe=new Set(["KML","GeoJson","CSV"]);let si=Rg=class extends yw(Xo){constructor(e){super(e),this.access=null,this.accessInformation=null,this.apiKey=null,this.applicationProxies=null,this.avgRating=null,this.categories=null,this.created=null,this.culture=null,this.description=null,this.extent=null,this.groupCategories=null,this.id=null,this.itemControl=null,this.licenseInfo=null,this.modified=null,this.name=null,this.numComments=null,this.numRatings=null,this.numViews=null,this.owner=null,this.ownerFolder=null,this.portal=null,this.screenshots=null,this.size=null,this.snippet=null,this.sourceJSON=null,this.spatialReference=null,this.tags=null,this.title=null,this.type=null,this.typeKeywords=null,this.url=null}static from(e){return Xm(Rg,e)}destroy(){this.portal=null}get displayName(){const e=this.type,t=this.typeKeywords||[];let i=e;return e==="Feature Service"||e==="Feature Collection"?i=t.includes("Table")?"Table":t.includes("Route Layer")?"Route Layer":t.includes("Markup")?"Markup":"Feature Layer":e==="Image Service"?i=t.includes("Elevation 3D Layer")?"Elevation Layer":t.includes("Tiled Imagery")?"Tiled Imagery Layer":"Imagery Layer":e==="Scene Service"?i="Scene Layer":e==="Video Service"?i="Video Layer":e==="Scene Package"?i="Scene Layer Package":e==="Stream Service"?i="Feature Layer":e==="Geoprocessing Service"&&this.portal&&this.portal.isPortal?i=t.includes("Web Tool")?"Tool":"Geoprocessing Service":e==="Geocoding Service"?i="Locator":e==="Geoenrichment Service"?i="GeoEnrichment Service":e==="Microsoft Powerpoint"?i="Microsoft PowerPoint":e==="GeoJson"?i="GeoJSON":e==="Globe Service"?i="Globe Layer":e==="Vector Tile Service"?i="Tile Layer":e==="netCDF"?i="NetCDF":e==="Map Service"?i=t.includes("Spatiotemporal")||!t.includes("Hosted Service")&&!t.includes("Tiled")||t.includes("Relational")?"Map Image Layer":"Tile Layer":e&&e.toLowerCase().includes("add in")?i=e.replace(/(add in)/gi,"Add-In"):e==="datastore catalog service"?i="Big Data File Share":e==="Compact Tile Package"?i="Tile Package (tpkx)":e==="OGCFeatureServer"?i="OGC Feature Layer":e==="web mapping application"&&t.includes("configurableApp")&&(i="Instant App"),i}readExtent(e){return e&&e.length?new gi(e[0][0],e[0][1],e[1][0],e[1][1]):null}get iconUrl(){const e=this.type&&this.type.toLowerCase()||"",t=this.typeKeywords||[],i="esri/images/portal/",r="16";let n,o=!1,c=!1,h=!1,m=!1,b=!1,x=!1;return e.indexOf("service")>0||e==="feature collection"||e==="kml"||e==="wms"||e==="wmts"||e==="wfs"?(o=t.includes("Hosted Service"),e==="feature service"||e==="feature collection"||e==="kml"||e==="wfs"?(c=t.includes("Table"),h=t.includes("Route Layer"),m=t.includes("Markup"),b=t.includes("Spatiotemporal"),x=t.includes("UtilityNetwork"),n=b&&c?"spatiotemporaltable":c?"table":h?"routelayer":m?"markup":b?"spatiotemporal":o?"featureshosted":x?"utilitynetwork":"features"):n=e==="map service"||e==="wms"||e==="wmts"?o||t.includes("Tiled")||e==="wmts"?"maptiles":"mapimages":e==="scene service"?t.includes("Line")?"sceneweblayerline":t.includes("3DObject")?"sceneweblayermultipatch":t.includes("Point")?"sceneweblayerpoint":t.includes("IntegratedMesh")?"sceneweblayermesh":t.includes("PointCloud")?"sceneweblayerpointcloud":t.includes("Polygon")?"sceneweblayerpolygon":t.includes("Building")?"sceneweblayerbuilding":t.includes("Voxel")?"sceneweblayervoxel":"sceneweblayer":e==="image service"?t.includes("Elevation 3D Layer")?"elevationlayer":t.includes("Tiled Imagery")?"tiledimagerylayer":"imagery":e==="stream service"?"streamlayer":e==="video service"?"mediaservice":e==="vector tile service"?"vectortile":e==="datastore catalog service"?"datastorecollection":e==="geocoding service"?"geocodeservice":e==="geoprocessing service"?t.includes("Web Tool")&&this.portal&&this.portal.isPortal?"tool":"layers":e==="geodata service"?"geodataservice":"layers"):n=e==="web map"||e==="cityengine web scene"?"maps":e==="web scene"?t.includes("ViewingMode-Local")?"webscenelocal":"websceneglobal":e==="web mapping application"&&t.includes("configurableApp")?"instantapps":e==="web mapping application"||e==="mobile application"||e==="application"||e==="operation view"||e==="desktop application"?"apps":e==="map document"||e==="map package"||e==="published map"||e==="scene document"||e==="globe document"||e==="basemap package"||e==="mobile basemap package"||e==="mobile map package"||e==="project package"||e==="project template"||e==="pro map"||e==="layout"||e==="layer"&&t.includes("ArcGIS Pro")||e==="explorer map"&&t.indexOf("Explorer Document")?"mapsgray":e==="service definition"||e==="csv"||e==="shapefile"||e==="cad drawing"||e==="geojson"||e==="360 vr experience"||e==="netcdf"||e==="administrative report"?"datafiles":e==="explorer add in"||e==="desktop add in"||e==="windows viewer add in"||e==="windows viewer configuration"?"appsgray":e==="arcgis pro add in"||e==="arcgis pro configuration"?"addindesktop":e==="rule package"||e==="file geodatabase"||e==="sqlite geodatabase"||e==="csv collection"||e==="kml collection"||e==="windows mobile package"||e==="map template"||e==="desktop application template"||e==="gml"||e==="arcpad package"||e==="code sample"||e==="form"||e==="document link"||e==="earth configuration"||e==="operations dashboard add in"||e==="rules package"||e==="image"||e==="workflow manager package"||e==="explorer map"&&t.includes("Explorer Mapping Application")||t.includes("Document")?"datafilesgray":e==="network analysis service"||e==="geoprocessing service"||e==="geodata service"||e==="geometry service"||e==="geoprocessing package"||e==="locator package"||e==="geoprocessing sample"||e==="workflow manager service"?"toolsgray":e==="layer"||e==="layer package"||e==="explorer layer"?"layersgray":e==="scene package"?"scenepackage":e==="mobile scene package"?"mobilescenepackage":e==="tile package"||e==="compact tile package"?"tilepackage":e==="task file"?"taskfile":e==="report template"?"report-template":e==="statistical data collection"?"statisticaldatacollection":e==="insights workbook"?"workbook":e==="insights model"?"insightsmodel":e==="insights page"?"insightspage":e==="insights theme"?"insightstheme":e==="hub initiative"?"hubinitiative":e==="hubpage"?"hubpage":e==="hub event"?"hubevent":e==="hub site application"?"hubsite":e==="hub project"?"hubproject":e==="relational database connection"?"relationaldatabaseconnection":e==="big data file share"?"datastorecollection":e==="image collection"?"imagecollection":e==="style"?"style":e==="desktop style"?"desktopstyle":e==="dashboard"?"dashboard":e==="raster function template"?"rasterprocessingtemplate":e==="vector tile package"?"vectortilepackage":e==="ortho mapping project"?"orthomappingproject":e==="ortho mapping template"?"orthomappingtemplate":e==="solution"?"solutions":e==="geopackage"?"geopackage":e==="deep learning package"?"deeplearningpackage":e==="real time analytic"?"realtimeanalytics":e==="big data analytic"?"bigdataanalytics":e==="feed"?"feed":e==="excalibur imagery project"?"excaliburimageryproject":e==="notebook"?"notebook":e==="storymap"?"storymap":e==="survey123 add in"?"survey123addin":e==="mission"?"mission":e==="mission report"?"missionreport":e==="quickcapture project"?"quickcaptureproject":e==="pro report"?"proreport":e==="pro report template"?"proreporttemplate":e==="urban model"?"urbanmodel":e==="web experience"?"experiencebuilder":e==="web experience template"?"webexperiencetemplate":e==="experience builder widget"?"experiencebuilderwidget":e==="experience builder widget package"?"experiencebuilderwidgetpackage":e==="workflow"?"workflow":e==="insights script"?"insightsscript":e==="kernel gateway connection"?"kernelgatewayconnection":e==="hub initiative template"?"hubinitiativetemplate":e==="storymap theme"?"storymaptheme":e==="knowledge graph"?"knowledgegraph":e==="native application"?"nativeapp":e==="native application installer"?"nativeappinstaller":e==="link chart"?"linkchart":e==="investigation"?"investigation":e==="ogcfeatureserver"?"features":e==="pro project"?"proproject":e==="insights workbook package"?"insightsworkbookpackage":e==="apache parquet"?"apacheparquet":e==="notebook code snippets"||e==="notebook code snippet library"?"notebookcodesnippets":e==="suitability model"?"suitabilitymodel":e==="esri classifier definition"?"classifierdefinition":e==="esri classification schema"?"classificationschema":e==="insights data engineering workbook"?"dataengineeringworkbook":e==="insights data engineering model"?"dataengineeringmodel":e==="deep learning studio project"?"deeplearningproject":e==="discussion"?"discussion":"maps",n?_i(i+n+r+".png"):null}get isLayer(){return this.type!=null&&Gwe.has(this.type)}get itemPageUrl(){var t;const e=(t=this.portal)==null?void 0:t.itemPageUrl;return e&&this.id?`${e}?id=${this.id}`:null}get itemUrl(){var t;const e=(t=this.portal)==null?void 0:t.restUrl;return e&&this.id?`${e}/content/items/${this.id}`:null}get thumbnailUrl(){var i,r;const e=this.itemUrl,t=this.thumbnail;return e&&t&&(r=(i=this.portal)==null?void 0:i._normalizeUrl(`${e}/info/${t}?f=json`))!=null?r:null}get userItemUrl(){const e=this.get("portal.restUrl");if(!e)return null;const t=this.owner||this.get("portal.user.username");return t?`${e}/content/users/${this.ownerFolder?`${t}/${this.ownerFolder}`:t}/items/${this.id}`:null}load(e){var r;const t=(r=this.portal)!=null?r:this.portal=nn.getDefault(),i=t.load(e).then(()=>this.sourceJSON?this.sourceJSON:this.id&&this.itemUrl?t._request(this.itemUrl,{signal:H(e)?e.signal:null,query:{token:this.apiKey}}):{}).then(n=>{this.sourceJSON=n,this.read(n)});return this.addResolvingPromise(i),Promise.resolve(this)}async addRating(e){const t={method:"post",query:{}};return e instanceof ak&&(e=e.rating),e==null||isNaN(e)||typeof e!="number"||(t.query.rating=e),this.portal?(await this.portal._request(this.itemUrl+"/addRating",t),new ak({rating:e,created:new Date})):null}clone(){const e={access:this.access,accessInformation:this.accessInformation,applicationProxies:_e(this.applicationProxies),avgRating:this.avgRating,categories:_e(this.categories),created:_e(this.created),culture:this.culture,description:this.description,extent:_e(this.extent),groupCategories:_e(this.groupCategories),id:this.id,itemControl:this.itemControl,licenseInfo:this.licenseInfo,modified:_e(this.modified),name:this.name,numComments:this.numComments,numRatings:this.numRatings,numViews:this.numViews,owner:this.owner,ownerFolder:this.ownerFolder,portal:this.portal,screenshots:_e(this.screenshots),size:this.size,snippet:this.snippet,spatialReference:this.spatialReference,tags:_e(this.tags),thumbnail:this.thumbnail,title:this.title,type:this.type,typeKeywords:_e(this.typeKeywords),url:this.url};return this.loaded&&(e.loadStatus="loaded"),new Rg({sourceJSON:this.sourceJSON}).set(e)}createPostQuery(){const e=this.toJSON();for(const i of["tags","typeKeywords","categories"])e[i]&&(e[i]=e[i].join(", "));const{extent:t}=e;return t&&(e.extent=JSON.stringify(t)),e}async deleteRating(){await Yn(this.portal)._request(this.itemUrl+"/deleteRating",{method:"post"})}fetchData(e="json",t){return Yn(this.portal)._request(this.itemUrl+"/data",Ce(K({responseType:e},t),{query:{token:this.apiKey}}))}async fetchRating(e){const t=await Yn(this.portal)._request(this.itemUrl+"/rating",K({query:{token:this.apiKey}},e));return t.rating!=null?(t.created=new Date(t.created),new ak(t)):null}fetchRelatedItems(e,t){return Yn(this.portal)._requestToTypedArray(this.itemUrl+"/relatedItems",K({query:Ce(K({},e),{token:this.apiKey})},t),Rg)}getThumbnailUrl(e){let t=this.thumbnailUrl;return t&&e&&(t+=`&w=${e}`),t}reload(){var e;return Yn(this.portal)._request((e=this.itemUrl)!=null?e:"",{cacheBust:!0,query:{token:this.apiKey}}).then(t=>(this.sourceJSON=t,this.read(t),this))}update(e){return this.id?this.load().then(()=>Yn(this.portal)._signIn()).then(()=>{const t=e&&e.data,i={method:"post"};i.query=this.createPostQuery();for(const r in i.query)i.query[r]===null&&(i.query[r]="");return i.query.clearEmptyFields=!0,t!=null&&(typeof t=="string"?i.query.text=t:typeof t=="object"&&(i.query.text=JSON.stringify(t))),this.portal._request(`${this.userItemUrl}/update`,i).then(()=>this.reload())}):Promise.reject(new ue("portal:item-does-not-exist","The item does not exist yet and cannot be updated"))}updateThumbnail(e){return this.id?this.load().then(()=>this.portal._signIn()).then(()=>{const t=e.thumbnail,i=e.filename,r={method:"post"};if(typeof t=="string")O0(t)?r.query={data:t}:r.query={url:Ra(t)},H(i)&&(r.query.filename=i);else{const n=new FormData;H(i)?n.append("file",t,i):n.append("file",t),r.body=n}return this.portal._request(`${this.userItemUrl}/updateThumbnail`,r).then(()=>this.reload())}):Promise.reject(new ue("portal:item-does-not-exist","The item does not exist yet and cannot be updated"))}async fetchResources(e={},t){return(await import("./resourceUtils.38261f41.js")).fetchResources(this,e,t)}async addResource(e,t,i){const r=await import("./resourceUtils.38261f41.js");return e.portalItem=this,r.addOrUpdateResource(e,"add",t,i)}async removeResource(e,t){const i=await import("./resourceUtils.38261f41.js");if(e.portalItem&&e.portalItem.itemUrl!==this.itemUrl)throw new ue("removeresource:portal-item-mismatch","The portal item associated with the provided resource does not match the item");return i.removeResource(this,e,t)}async removeAllResources(e){return(await import("./resourceUtils.38261f41.js")).removeAllResources(this,e)}resourceFromPath(e){return new zwe({portalItem:this,path:e})}toJSON(){const e=this.extent,t={accessInformation:this.accessInformation,categories:_e(this.categories),created:this.created&&this.created.getTime(),description:this.description,extent:e&&[[e.xmin,e.ymin],[e.xmax,e.ymax]],id:this.id,licenseInfo:this.licenseInfo,modified:this.modified&&this.modified.getTime(),name:this.name,owner:this.owner,ownerFolder:this.ownerFolder,snippet:this.snippet,spatialReference:this.spatialReference,tags:_e(this.tags),thumbnail:this.thumbnail,title:this.title,type:this.type,typeKeywords:_e(this.typeKeywords),url:this.url};return Aj(t)}static fromJSON(e){if(!e)return null;if(e.declaredClass)throw new Error("JSON object is already hydrated");return new Rg({sourceJSON:e})}_getPostQuery(){const e=this.toJSON();for(const t in e)t==="tags"&&e[t]!==null&&(e[t]=e[t].join(", ")),t==="typeKeywords"&&e[t]!==null&&(e[t]=e[t].join(", ")),t==="extent"&&e[t]&&(e[t]=JSON.stringify(e[t]));return e}};g([w({type:["private","shared","org","public"]})],si.prototype,"access",void 0),g([w()],si.prototype,"accessInformation",void 0),g([w({type:String})],si.prototype,"apiKey",void 0),g([w({json:{read:{source:"appProxies"}}})],si.prototype,"applicationProxies",void 0),g([w()],si.prototype,"avgRating",void 0),g([w()],si.prototype,"categories",void 0),g([w({type:Date})],si.prototype,"created",void 0),g([w()],si.prototype,"culture",void 0),g([w()],si.prototype,"description",void 0),g([w({readOnly:!0})],si.prototype,"displayName",null),g([w({type:gi})],si.prototype,"extent",void 0),g([We("extent")],si.prototype,"readExtent",null),g([w()],si.prototype,"groupCategories",void 0),g([w({readOnly:!0})],si.prototype,"iconUrl",null),g([w()],si.prototype,"id",void 0),g([w({readOnly:!0})],si.prototype,"isLayer",null),g([w()],si.prototype,"itemControl",void 0),g([w({readOnly:!0})],si.prototype,"itemPageUrl",null),g([w({readOnly:!0})],si.prototype,"itemUrl",null),g([w()],si.prototype,"licenseInfo",void 0),g([w({type:Date})],si.prototype,"modified",void 0),g([w()],si.prototype,"name",void 0),g([w()],si.prototype,"numComments",void 0),g([w()],si.prototype,"numRatings",void 0),g([w()],si.prototype,"numViews",void 0),g([w()],si.prototype,"owner",void 0),g([w()],si.prototype,"ownerFolder",void 0),g([w({type:nn})],si.prototype,"portal",void 0),g([w()],si.prototype,"screenshots",void 0),g([w()],si.prototype,"size",void 0),g([w()],si.prototype,"snippet",void 0),g([w()],si.prototype,"sourceJSON",void 0),g([w({type:String})],si.prototype,"spatialReference",void 0),g([w()],si.prototype,"tags",void 0),g([w()],si.prototype,"thumbnail",void 0),g([w({readOnly:!0})],si.prototype,"thumbnailUrl",null),g([w()],si.prototype,"title",void 0),g([w()],si.prototype,"type",void 0),g([w()],si.prototype,"typeKeywords",void 0),g([w({type:String,json:{read(e,t){var i;if(Bwe.has(t.type)){const r=(i=this.portal)==null?void 0:i.restUrl;e||(e=r&&this.id?`${r}/content/items/${this.id}/data`:null)}return e}}})],si.prototype,"url",void 0),g([w({readOnly:!0})],si.prototype,"userItemUrl",null),si=Rg=g([te("esri.portal.PortalItem")],si);const b_=si;var YB=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",default:b_});const XB=/^([a-z]{2})(?:[-_]([A-Za-z]{2}))?$/,Uwe={ar:!0,bg:!0,bs:!0,ca:!0,cs:!0,da:!0,de:!0,el:!0,en:!0,es:!0,et:!0,fi:!0,fr:!0,he:!0,hr:!0,hu:!0,id:!0,it:!0,ja:!0,ko:!0,lt:!0,lv:!0,nb:!0,nl:!0,pl:!0,"pt-BR":!0,"pt-PT":!0,ro:!0,ru:!0,sk:!0,sl:!0,sr:!0,sv:!0,th:!0,tr:!0,uk:!0,vi:!0,"zh-CN":!0,"zh-HK":!0,"zh-TW":!0};function QB(e){var t;return(t=Uwe[e])!=null?t:!1}const w_=[],Fg=new Map;function eU(e){for(const t of Fg.keys())tU(e.pattern,t)&&Fg.delete(t)}function qwe(e){return w_.includes(e)||(eU(e),w_.unshift(e)),{remove(){const t=w_.indexOf(e);t>-1&&(w_.splice(t,1),eU(e))}}}async function z5(e){const t=io();Fg.has(e)||Fg.set(e,Wwe(e,t));const i=Fg.get(e);return i&&await Jwe.add(i),i}function Hwe(e){if(!XB.test(e))return null;const t=XB.exec(e);if(t===null)return null;const[,i,r]=t,n=i+(r?"-"+r.toUpperCase():"");return QB(n)?n:QB(i)?i:null}async function Wwe(e,t){const i=[];for(const r of w_)if(tU(r.pattern,e))try{return await r.fetchMessageBundle(e,t)}catch(n){i.push(n)}throw i.length?new ue("intl:message-bundle-error",`Errors occurred while loading "${e}"`,{errors:i}):new ue("intl:no-message-bundle-loader",`No loader found for message bundle "${e}"`)}function tU(e,t){return typeof e=="string"?t.startsWith(e):e.test(t)}QT(()=>{Fg.clear()});const Jwe=new class{constructor(){this._numLoading=0,this._dfd=null}async waitForAll(){this._dfd&&await this._dfd.promise}add(e){return this._increase(),e.then(()=>this._decrease(),()=>this._decrease()),this.waitForAll()}_increase(){this._numLoading++,this._dfd||(this._dfd=fh())}_decrease(){this._numLoading=Math.max(this._numLoading-1,0),this._dfd&&this._numLoading===0&&(this._dfd.resolve(),this._dfd=null)}};async function Zwe(e){if(!e)return;const t=e.includes("-vector")?e.slice(0,e.indexOf("-vector")):e,i=await z5("esri/t9n/basemaps");return i[e]||i[t]}const lk={streets:{id:"streets",classic:!0,deprecated:!0,get thumbnailUrl(){return _i("esri/images/basemap/streets.jpg")},baseMapLayers:[{id:"streets-base-layer",url:"//services.arcgisonline.com/ArcGIS/rest/services/World_Street_Map/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Street Map",showLegend:!1,visibility:!0,opacity:1}]},satellite:{id:"satellite",classic:!0,get thumbnailUrl(){return _i("esri/images/basemap/satellite.jpg")},baseMapLayers:[{id:"satellite-base-layer",url:"//services.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Imagery",showLegend:!1,visibility:!0,opacity:1}]},hybrid:{id:"hybrid",classic:!0,get thumbnailUrl(){return _i("esri/images/basemap/hybrid.jpg")},baseMapLayers:[{id:"hybrid-base-layer",url:"//services.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Imagery",showLegend:!1,visibility:!0,opacity:1},{id:"hybrid-reference-layer",styleUrl:"https://cdn.arcgis.com/sharing/rest/content/items/30d6b8271e1849cd9c3042060001f425/resources/styles/root.json",layerType:"VectorTileLayer",title:"Hybrid Reference Layer",isReference:!0,showLegend:!1,visibility:!0,opacity:1}]},terrain:{id:"terrain",classic:!0,get thumbnailUrl(){return _i("esri/images/basemap/terrain.jpg")},baseMapLayers:[{id:"terrain-base-layer",url:"//services.arcgisonline.com/ArcGIS/rest/services/World_Terrain_Base/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Terrain Base",showLegend:!1,visibility:!0,opacity:1},{id:"terrain-reference-layer",url:"//services.arcgisonline.com/ArcGIS/rest/services/Reference/World_Reference_Overlay/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Reference Overlay",isReference:!0,showLegend:!1,visibility:!0,opacity:1}]},topo:{id:"topo",classic:!0,deprecated:!0,get thumbnailUrl(){return _i("esri/images/basemap/topo.jpg")},baseMapLayers:[{id:"topo-base-layer",url:"//services.arcgisonline.com/ArcGIS/rest/services/World_Topo_Map/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Topo Map",showLegend:!1,visibility:!0,opacity:1}]},gray:{id:"gray",classic:!0,deprecated:!0,get thumbnailUrl(){return _i("esri/images/basemap/gray.jpg")},baseMapLayers:[{id:"gray-base-layer",url:"//services.arcgisonline.com/ArcGIS/rest/services/Canvas/World_Light_Gray_Base/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Light Gray Base",showLegend:!1,visibility:!0,opacity:1},{id:"gray-reference-layer",url:"//services.arcgisonline.com/ArcGIS/rest/services/Canvas/World_Light_Gray_Reference/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Light Gray Reference",isReference:!0,showLegend:!1,visibility:!0,opacity:1}]},"dark-gray":{id:"dark-gray",classic:!0,deprecated:!0,get thumbnailUrl(){return _i("esri/images/basemap/dark-gray.jpg")},baseMapLayers:[{id:"dark-gray-base-layer",url:"//services.arcgisonline.com/ArcGIS/rest/services/Canvas/World_Dark_Gray_Base/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Dark Gray Base",showLegend:!1,visibility:!0,opacity:1},{id:"dark-gray-reference-layer",url:"//services.arcgisonline.com/ArcGIS/rest/services/Canvas/World_Dark_Gray_Reference/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Dark Gray Reference",isReference:!0,showLegend:!1,visibility:!0,opacity:1}]},oceans:{id:"oceans",classic:!0,get thumbnailUrl(){return _i("esri/images/basemap/oceans.jpg")},baseMapLayers:[{id:"oceans-base-layer",url:"//services.arcgisonline.com/arcgis/rest/services/Ocean/World_Ocean_Base/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Ocean Base",showLegend:!1,visibility:!0,opacity:1},{id:"oceans-reference-layer",url:"//services.arcgisonline.com/arcgis/rest/services/Ocean/World_Ocean_Reference/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Ocean Reference",isReference:!0,showLegend:!1,visibility:!0,opacity:1}]},"national-geographic":{id:"national-geographic",classic:!0,deprecated:!0,get thumbnailUrl(){return _i("esri/images/basemap/national-geographic.jpg")},baseMapLayers:[{id:"national-geographic-base-layer",url:"//services.arcgisonline.com/ArcGIS/rest/services/NatGeo_World_Map/MapServer",title:"NatGeo World Map",showLegend:!1,layerType:"ArcGISTiledMapServiceLayer",visibility:!0,opacity:1}]},osm:{id:"osm",classic:!0,get thumbnailUrl(){return _i("esri/images/basemap/osm.jpg")},baseMapLayers:[{id:"osm-base-layer",layerType:"OpenStreetMap",title:"Open Street Map",showLegend:!1,visibility:!0,opacity:1}]},"dark-gray-vector":{id:"dark-gray-vector",classic:!0,get thumbnailUrl(){return _i("esri/images/basemap/dark-gray-vector.jpg")},baseMapLayers:[{id:"dark-gray-base-layer",styleUrl:"https://cdn.arcgis.com/sharing/rest/content/items/5e9b3685f4c24d8781073dd928ebda50/resources/styles/root.json",layerType:"VectorTileLayer",title:"Dark Gray Base",visibility:!0,opacity:1},{id:"dark-gray-reference-layer",styleUrl:"https://cdn.arcgis.com/sharing/rest/content/items/747cb7a5329c478cbe6981076cc879c5/resources/styles/root.json",layerType:"VectorTileLayer",title:"Dark Gray Reference",isReference:!0,visibility:!0,opacity:1}]},"gray-vector":{id:"gray-vector",classic:!0,get thumbnailUrl(){return _i("esri/images/basemap/gray-vector.jpg")},baseMapLayers:[{id:"gray-base-layer",styleUrl:"https://cdn.arcgis.com/sharing/rest/content/items/291da5eab3a0412593b66d384379f89f/resources/styles/root.json",layerType:"VectorTileLayer",title:"Light Gray Base",visibility:!0,opacity:1},{id:"gray-reference-layer",styleUrl:"https://cdn.arcgis.com/sharing/rest/content/items/1768e8369a214dfab4e2167d5c5f2454/resources/styles/root.json",layerType:"VectorTileLayer",title:"Light Gray Reference",isReference:!0,visibility:!0,opacity:1}]},"streets-vector":{id:"streets-vector",classic:!0,get thumbnailUrl(){return _i("esri/images/basemap/streets-vector.jpg")},baseMapLayers:[{id:"streets-vector-base-layer",styleUrl:"//cdn.arcgis.com/sharing/rest/content/items/de26a3cf4cc9451298ea173c4b324736/resources/styles/root.json",layerType:"VectorTileLayer",title:"World Streets",visibility:!0,opacity:1}]},"topo-vector":{id:"topo-vector",classic:!0,get thumbnailUrl(){return _i("esri/images/basemap/topo-vector.jpg")},baseMapLayers:[{id:"world-hillshade-layer",url:"//services.arcgisonline.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Hillshade",showLegend:!1,visibility:!0,opacity:1},{id:"topo-vector-base-layer",styleUrl:"//cdn.arcgis.com/sharing/rest/content/items/7dc6cea0b1764a1f9af2e679f642f0f5/resources/styles/root.json",layerType:"VectorTileLayer",title:"World Topo",visibility:!0,opacity:1}]},"streets-night-vector":{id:"streets-night-vector",classic:!0,get thumbnailUrl(){return _i("esri/images/basemap/streets-night.jpg")},baseMapLayers:[{id:"streets-night-vector-base-layer",styleUrl:"//cdn.arcgis.com/sharing/rest/content/items/86f556a2d1fd468181855a35e344567f/resources/styles/root.json",layerType:"VectorTileLayer",title:"World Streets Night",visibility:!0,opacity:1}]},"streets-relief-vector":{id:"streets-relief-vector",classic:!0,get thumbnailUrl(){return _i("esri/images/basemap/streets-relief.jpg")},baseMapLayers:[{id:"world-hillshade-layer",url:"//services.arcgisonline.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Hillshade",showLegend:!1,visibility:!0,opacity:1},{id:"streets-relief-vector-base-layer",styleUrl:"//www.arcgis.com/sharing/rest/content/items/b266e6d17fc345b498345613930fbd76/resources/styles/root.json",title:"World Streets Relief",layerType:"VectorTileLayer",visibility:!0,opacity:1}]},"streets-navigation-vector":{id:"streets-navigation-vector",classic:!0,get thumbnailUrl(){return _i("esri/images/basemap/streets-navigation.jpg")},baseMapLayers:[{id:"streets-navigation-vector-base-layer",styleUrl:"//cdn.arcgis.com/sharing/rest/content/items/63c47b7177f946b49902c24129b87252/resources/styles/root.json",layerType:"VectorTileLayer",title:"World Streets Navigation",visibility:!0,opacity:1}]},"arcgis-imagery":{get thumbnailUrl(){return _i("esri/images/basemap/hybrid.jpg")},title:"Imagery Hybrid",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Imagery",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/World_Imagery/MapServer"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Imagery:Labels",title:"Hybrid Reference Layer",isReference:!0}]},"arcgis-imagery-standard":{get thumbnailUrl(){return _i("esri/images/basemap/satellite.jpg")},title:"Imagery",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Imagery",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/World_Imagery/MapServer"}]},"arcgis-imagery-labels":{title:"Hybrid [Reference]",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Imagery:Labels",title:"Hybrid Reference Layer",isReference:!0}]},"arcgis-light-gray":{get thumbnailUrl(){return _i("esri/images/basemap/gray-vector.jpg")},title:"Light Gray Canvas",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:LightGray:Base",title:"Light Gray Canvas Base"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:LightGray:Labels",title:"Light Gray Canvas Labels",isReference:!0}]},"arcgis-dark-gray":{get thumbnailUrl(){return _i("esri/images/basemap/dark-gray.jpg")},title:"Dark Gray Canvas",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:DarkGray:Base",title:"Dark Gray Canvas Base"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:DarkGray:Labels",title:"Dark Gray Canvas Labels",isReference:!0}]},"arcgis-navigation":{get thumbnailUrl(){return _i("esri/images/basemap/streets-navigation.jpg")},title:"Navigation",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Navigation",title:"World Navigation Map"}]},"arcgis-navigation-night":{title:"Navigation (Dark Mode)",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:NavigationNight",title:"World Navigation Map (Dark Mode)"}]},"arcgis-streets":{get thumbnailUrl(){return _i("esri/images/basemap/streets-vector.jpg")},title:"Streets",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Streets",title:"World Street Map"}]},"arcgis-streets-night":{get thumbnailUrl(){return _i("esri/images/basemap/streets-night.jpg")},title:"Streets (Night)",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:StreetsNight",title:"World Street Map (Night)"}]},"arcgis-streets-relief":{get thumbnailUrl(){return _i("esri/images/basemap/streets-relief.jpg")},title:"Streets (with Relief)",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Hillshade",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:StreetsRelief:Base",title:"World Street Map (with Relief)"}]},"arcgis-topographic":{get thumbnailUrl(){return _i("esri/images/basemap/topo.jpg")},title:"Topographic",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Hillshade",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Topographic:Base",title:"World Topographic Map"}]},"arcgis-oceans":{get thumbnailUrl(){return _i("esri/images/basemap/oceans.jpg")},title:"Oceans",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Ocean Base",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/Ocean/World_Ocean_Base/MapServer"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Oceans:Labels",title:"World Ocean Reference",isReference:!0}]},"osm-standard":{title:"OpenStreetMap",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/OSM:Standard",title:"OpenStreetMap"}]},"osm-standard-relief":{title:"OpenStreetMap (with relief)",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Hillshade",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer"},{styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/OSM:StandardRelief:Base",layerType:"VectorTileLayer",title:"OpenStreetMap Relief Base"}]},"osm-streets":{title:"OpenStreetMap (Streets)",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/OSM:Streets",title:"OpenStreetMap (Streets)"}]},"osm-streets-relief":{title:"OpenStreetMap (Streets with relief)",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Hillshade",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer"},{styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/OSM:StreetsRelief:Base",layerType:"VectorTileLayer",title:"OpenStreetMap Relief Base"}]},"osm-light-gray":{title:"OpenStreetMap (Light Gray Canvas)",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/OSM:LightGray:Base",title:"OSM (Light Gray Base)"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/OSM:LightGray:Labels",title:"OSM (Light Gray Reference)",isReference:!0}]},"osm-dark-gray":{title:"OpenStreetMap (Dark Gray Canvas)",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/OSM:DarkGray:Base",title:"OSM (Dark Gray Base)"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/OSM:DarkGray:Labels",title:"OSM (Dark Gray Reference)",isReference:!0}]},"arcgis-terrain":{title:"Terrain with Labels",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Hillshade",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Terrain:Base",title:"World Terrain Base"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Terrain:Detail",title:"World Terrain Reference",isReference:!0}]},"arcgis-community":{title:"Community",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Community",title:"Community"}]},"arcgis-charted-territory":{title:"Charted Territory",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Hillshade",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:ChartedTerritory:Base",title:"Charted Territory"}]},"arcgis-colored-pencil":{title:"Colored Pencil",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:ColoredPencil",title:"Colored Pencil"}]},"arcgis-nova":{title:"Nova",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Nova",title:"Nova"}]},"arcgis-modern-antique":{title:"Modern Antique",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Hillshade",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:ModernAntique:Base",title:"Modern Antique"}]},"arcgis-midcentury":{title:"Mid-Century",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Midcentury",title:"Mid-Century"}]},"arcgis-newspaper":{title:"Newspaper",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Newspaper",title:"Newspaper"}]},"arcgis-hillshade-light":{title:"Hillshade",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Hillshade",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer"}]},"arcgis-hillshade-dark":{title:"Hillshade (Dark)",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Hillshade (Dark)",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/Elevation/World_Hillshade_Dark/MapServer"}]},"arcgis-human-geography":{title:"Human Geography",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:HumanGeography:Base",title:"Human Geography Base"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:HumanGeography:Detail",title:"Human Geography Detail",isReference:!0},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:HumanGeography:Label",title:"Human Geography Label",isReference:!0}]},"arcgis-human-geography-dark":{title:"Human Geography (Dark)",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:HumanGeographyDark:Base",title:"Human Geography Dark Base"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:HumanGeographyDark:Detail",title:"Human Geography Dark Detail",isReference:!0},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:HumanGeographyDark:Label",title:"Human Geography Dark Label",isReference:!0}]}};function iU(e){const t=e==null?void 0:e.type;return t==="imagery-tile"||t==="tile"||t==="open-street-map"||t==="vector-tile"||t==="web-tile"||t==="wmts"}function Kwe(e){const t=e==null?void 0:e.type;return t==="base-tile"||t==="tile"||t==="elevation"||t==="imagery-tile"||t==="base-elevation"||t==="open-street-map"||t==="wcs"||t==="web-tile"||t==="wmts"||t==="vector-tile"}function ck(e){var t;return(e==null?void 0:e.type)==="feature"&&!e.url&&((t=e.source)==null?void 0:t.type)==="memory"}function vJe(e){var t;return(e==null?void 0:e.type)==="feature"&&((t=e.source)==null?void 0:t.type)==="feature-layer"}function Ywe(e){if(e.activeLayer){const t=e.activeLayer.tileMatrixSet;if(t)return t;const i=e.activeLayer.tileMatrixSets;if(i)return i}return null}const Xwe=new Set(["bing-maps","imagery","imagery-tile","map-image","open-street-map","tile","unknown","unsupported","vector-tile","web-tile","wms","wmts"]),Qwe=new Set(["csv","feature","geo-rss","geojson","group","imagery","imagery-tile","kml","map-image","map-notes","ogc-feature","route","subtype-group","tile","unknown","unsupported","vector-tile","web-tile","wfs","wms","wmts"]);function e_e(e){return e.layerContainerType==="basemap"?Xwe:e.layerContainerType==="operational-layers"?Qwe:null}function t_e(e,t){if(t.restrictedWebMapWriting){const i=e_e(t);return!H(i)||i.has(e.type)&&!ck(e)}return!0}function i_e(e,t){if(ck(e)){const i=Km("featureCollection.layers",t),r=i&&i[0]&&i[0].layerDefinition;r&&uk(e,r)}else e.type==="stream"?uk(e,t.layerDefinition=t.layerDefinition||{}):e.type!=="group"&&uk(e,t)}function uk(e,t){"maxScale"in e&&(t.maxScale=mS(e.maxScale)),"minScale"in e&&(t.minScale=mS(e.minScale))}function r_e(e,t){if(i_e(e,t),"blendMode"in e&&(t.blendMode=e.blendMode,t.blendMode==="normal"&&delete t.blendMode),t.opacity=mS(e.opacity),t.title=e.title||"Layer",t.visibility=e.visible,"legendEnabled"in e&&e.type!=="wmts")if(ck(e)){const i=t.featureCollection;i&&(i.showLegend=e.legendEnabled)}else t.showLegend=e.legendEnabled}function rU(e,t,i){if(!("write"in e)||!e.write)return i&&i.messages&&i.messages.push(new ue("layer:unsupported",`Layers (${e.title}, ${e.id}) of type '${e.declaredClass}' cannot be persisted`,{layer:e})),null;if(t_e(e,i)){const r={};return e.write(r,i)?r:null}return H(t)&&r_e(e,t=_e(t)),t}var G5;let n_e=0;const nU="esri.Basemap";let bl=G5=class extends yw(Xo){constructor(e){super(e),this.id=null,this.portalItem=null,this.spatialReference=null,this.thumbnailUrl=null,this.title="Basemap",this.id=Date.now().toString(16)+"-basemap-"+n_e++,this.baseLayers=new Xe,this.referenceLayers=new Xe;const t=r=>{r.parent&&r.parent!==this&&"remove"in r.parent&&r.parent.remove(r),r.parent=this,r.type==="elevation"&&$e.getLogger(this.declaredClass).error(`Layer '${r.title}, id:${r.id}' of type '${r.type}' is not supported as a basemap layer and will therefore be ignored.`)},i=r=>{r.parent=null};this.baseLayers.on("after-add",r=>t(r.item)),this.referenceLayers.on("after-add",r=>t(r.item)),this.baseLayers.on("after-remove",r=>i(r.item)),this.referenceLayers.on("after-remove",r=>i(r.item))}initialize(){this.when().catch(e=>{$e.getLogger(this.declaredClass).error("#load()",`Failed to load basemap (title: '${this.title}', id: '${this.id}')`,e)}),this.resourceInfo&&this.read(this.resourceInfo.data,this.resourceInfo.context)}destroy(){var i;const e=this.baseLayers.removeAll();for(const r of e)r.destroy();const t=this.referenceLayers.removeAll();for(const r of t)r.destroy();this.baseLayers.destroy(),this.referenceLayers.destroy(),(i=this.portalItem)==null||i.destroy(),this.portalItem=null}normalizeCtorArgs(e){return e&&"resourceInfo"in e&&(this._set("resourceInfo",e.resourceInfo),delete(e=K({},e)).resourceInfo),e}set baseLayers(e){this._set("baseLayers",D0(e,this._get("baseLayers")))}_writeBaseLayers(e,t,i){const r=[];e&&(i=Ce(K({},i),{layerContainerType:"basemap"}),this.baseLayers.forEach(n=>{const o=rU(n,i.webmap?i.webmap.getLayerJSONFromResourceInfo(n):null,i);H(o)&&r.push(o)}),this.referenceLayers.forEach(n=>{const o=rU(n,i.webmap?i.webmap.getLayerJSONFromResourceInfo(n):null,i);H(o)&&(o.isReference=!0,r.push(o))})),t.baseMapLayers=r}set referenceLayers(e){this._set("referenceLayers",D0(e,this._get("referenceLayers")))}writeTitle(e,t){t.title=e||"Basemap"}load(e){return this.addResolvingPromise(this._loadFromSource(e)),Promise.resolve(this)}loadAll(){return ok(this,e=>{e(this.baseLayers,this.referenceLayers)})}clone(){const e={id:this.id,title:this.title,portalItem:this.portalItem,baseLayers:this.baseLayers.slice(),referenceLayers:this.referenceLayers.slice()};return this.loaded&&(e.loadStatus="loaded"),new G5({resourceInfo:this.resourceInfo}).set(e)}read(e,t){this.resourceInfo||this._set("resourceInfo",{data:e,context:t}),super.read(e,t)}write(e,t){return e=e||{},t&&t.origin||(t=K({origin:"web-map"},t)),super.write(e,t),!this.loaded&&this.resourceInfo&&this.resourceInfo.data.baseMapLayers&&(e.baseMapLayers=this.resourceInfo.data.baseMapLayers.map(i=>{const r=_e(i);return r.url&&cu(r.url)&&(r.url=`https:${r.url}`),r.templateUrl&&cu(r.templateUrl)&&(r.templateUrl=`https:${r.templateUrl}`),r})),e}async _loadFromSource(e){const{resourceInfo:t,portalItem:i}=this;ur(e);const r=[];if(t){const n=t.context?t.context.url:null;if(r.push(this._loadLayersFromJSON(t.data,n,e)),t.data.id&&!t.data.title){const o=t.data.id;r.push(Zwe(o).then(c=>{c&&this.read({title:c},t.context)}))}}else i&&r.push(this._loadFromItem(i,e));await Promise.all(r)}async _loadLayersFromJSON(e,t,i){const r=this.resourceInfo&&this.resourceInfo.context,n=this.portalItem&&this.portalItem.portal||r&&r.portal||null,o=r&&r.origin==="web-scene"?"web-scene":"web-map",{populateOperationalLayers:c}=await import("./layersCreator.04c752a3.js"),h=[];if(ur(i),e.baseMapLayers&&Array.isArray(e.baseMapLayers)){const m={context:{origin:o,url:t,portal:n,layerContainerType:"basemap"},defaultLayerType:"DefaultTileLayer"},b=c(this.baseLayers,e.baseMapLayers.filter(I=>!I.isReference),m);h.push(b);const x=c(this.referenceLayers,e.baseMapLayers.filter(I=>I.isReference),m);h.push(x)}await Mr(h)}async _loadFromItem(e,t){var o,c;const i=await e.load(t),r=await i.fetchData("json",t),n=mn((o=e.itemUrl)!=null?o:"");return this._set("resourceInfo",{data:(c=r.baseMap)!=null?c:{},context:{origin:"web-map",portal:e.portal||nn.getDefault(),url:n}}),this.read(this.resourceInfo.data,this.resourceInfo.context),this.read({spatialReference:r.spatialReference},this.resourceInfo.context),this.read({title:e.title,thumbnailUrl:e.thumbnailUrl},{origin:"portal-item",portal:e.portal||nn.getDefault(),url:n}),this._loadLayersFromJSON(this.resourceInfo.data,n,t)}static fromId(e){const t=lk[e];if(t){if(t.deprecated){let i=null;e==="dark-gray"?i="dark-gray-vector":e==="gray"?i="gray-vector":e==="streets"?i="streets-vector":e==="topo"&&(i="topo-vector"),kV($e.getLogger(nU),`The ${e} basemap has entered mature support and is no longer being updated.`,{replacement:i,see:"https://arcg.is/1iq8aD",warnOnce:!0})}return G5.fromJSON(t)}return null}};g([w({json:{write:{ignoreOrigin:!0,target:"baseMapLayers",writer(e,t,i,r){this._writeBaseLayers(e,t,r)}},origins:{"web-scene":{write:{ignoreOrigin:!0,target:{baseMapLayers:{type:Xe}},writer(e,t,i,r){this._writeBaseLayers(e,t,r)}}}}}})],bl.prototype,"baseLayers",null),g([w({type:String,json:{origins:{"web-scene":{write:!0}}}})],bl.prototype,"id",void 0),g([w({type:b_})],bl.prototype,"portalItem",void 0),g([w()],bl.prototype,"referenceLayers",null),g([w({readOnly:!0})],bl.prototype,"resourceInfo",void 0),g([w({type:Mt})],bl.prototype,"spatialReference",void 0),g([w()],bl.prototype,"thumbnailUrl",void 0),g([w({type:String,json:{origins:{"web-scene":{write:{isRequired:!0}}}}})],bl.prototype,"title",void 0),g([tt("title")],bl.prototype,"writeTitle",null),bl=G5=g([te(nU)],bl);const K0=bl;var s_e=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",default:K0});function sU(e){}function o_e(e){return()=>e}var hk;let B5=hk=class extends ke{constructor(e){super(e),this.type="none"}clone(){return new hk({type:this.type})}};g([Pt({none:"none",stayAbove:"stay-above"})],B5.prototype,"type",void 0),B5=hk=g([te("esri.ground.NavigationConstraint")],B5);let $r=class extends Ye{constructor(){super(...arguments),this.SCENEVIEW_HITTEST_RETURN_INTERSECTOR=!1,this.DECONFLICTOR_SHOW_VISIBLE=!1,this.DECONFLICTOR_SHOW_INVISIBLE=!1,this.DECONFLICTOR_SHOW_GRID=!1,this.LABELS_SHOW_BORDER=!1,this.TEXT_SHOW_BASELINE=!1,this.TEXT_SHOW_BORDER=!1,this.OVERLAY_DRAW_DEBUG_TEXTURE=!1,this.OVERLAY_SHOW_CENTER=!1,this.SHOW_POI=!1,this.TESTS_DISABLE_OPTIMIZATIONS=!1,this.TESTS_DISABLE_FAST_UPDATES=!1,this.DRAW_MESH_GEOMETRY_NORMALS=!1,this.FEATURE_TILE_FETCH_SHOW_TILES=!1,this.FEATURE_TILE_TREE_SHOW_TILES=!1,this.TERRAIN_TILE_TREE_SHOW_TILES=!1,this.I3S_TREE_SHOW_TILES=!1,this.I3S_SHOW_MODIFICATIONS=!1,this.LOD_INSTANCE_RENDERER_DISABLE_UPDATES=!1,this.LOD_INSTANCE_RENDERER_COLORIZE_BY_LEVEL=!1,this.EDGES_SHOW_HIDDEN_TRANSPARENT_EDGES=!1,this.LINE_WIREFRAMES=!1,this.TERRAIN_USE_LEGACY_SHADING=!1}};g([w()],$r.prototype,"SCENEVIEW_HITTEST_RETURN_INTERSECTOR",void 0),g([w()],$r.prototype,"DECONFLICTOR_SHOW_VISIBLE",void 0),g([w()],$r.prototype,"DECONFLICTOR_SHOW_INVISIBLE",void 0),g([w()],$r.prototype,"DECONFLICTOR_SHOW_GRID",void 0),g([w()],$r.prototype,"LABELS_SHOW_BORDER",void 0),g([w()],$r.prototype,"TEXT_SHOW_BASELINE",void 0),g([w()],$r.prototype,"TEXT_SHOW_BORDER",void 0),g([w()],$r.prototype,"OVERLAY_DRAW_DEBUG_TEXTURE",void 0),g([w()],$r.prototype,"OVERLAY_SHOW_CENTER",void 0),g([w()],$r.prototype,"SHOW_POI",void 0),g([w()],$r.prototype,"TESTS_DISABLE_OPTIMIZATIONS",void 0),g([w()],$r.prototype,"TESTS_DISABLE_FAST_UPDATES",void 0),g([w()],$r.prototype,"DRAW_MESH_GEOMETRY_NORMALS",void 0),g([w()],$r.prototype,"FEATURE_TILE_FETCH_SHOW_TILES",void 0),g([w()],$r.prototype,"FEATURE_TILE_TREE_SHOW_TILES",void 0),g([w()],$r.prototype,"TERRAIN_TILE_TREE_SHOW_TILES",void 0),g([w()],$r.prototype,"I3S_TREE_SHOW_TILES",void 0),g([w()],$r.prototype,"I3S_SHOW_MODIFICATIONS",void 0),g([w()],$r.prototype,"LOD_INSTANCE_RENDERER_DISABLE_UPDATES",void 0),g([w()],$r.prototype,"LOD_INSTANCE_RENDERER_COLORIZE_BY_LEVEL",void 0),g([w()],$r.prototype,"EDGES_SHOW_HIDDEN_TRANSPARENT_EDGES",void 0),g([w()],$r.prototype,"LINE_WIREFRAMES",void 0),g([w()],$r.prototype,"TERRAIN_USE_LEGACY_SHADING",void 0),$r=g([te("esri.views.3d.support.DebugFlags")],$r);const a_e=new $r;var pk;let fu=pk=class extends yw(Xo){constructor(e){super(e),this.opacity=1,this.shading=!a_e.TERRAIN_USE_LEGACY_SHADING,this.surfaceColor=null,this.navigationConstraint=null,this.layers=new Xe;const t=r=>{r.parent&&r.parent!==this&&"remove"in r.parent&&r.parent.remove(r),r.parent=this,r.type!=="elevation"&&r.type!=="base-elevation"&&$e.getLogger(this.declaredClass).error(`Layer '${r.title}, id:${r.id}' of type '${r.type}' is not supported as a ground layer and will therefore be ignored. Only layers of type 'elevation' are supported.`)},i=r=>{r.parent=null};this.layers.on("after-add",r=>t(r.item)),this.layers.on("after-remove",r=>i(r.item))}initialize(){this.when().catch(e=>{$e.getLogger(this.declaredClass).error("#load()","Failed to load ground",e)}),this.resourceInfo&&this.read(this.resourceInfo.data,this.resourceInfo.context)}destroy(){const e=this.layers.removeAll();for(const t of e)t.destroy();this.layers.destroy()}normalizeCtorArgs(e){return e&&"resourceInfo"in e&&(this._set("resourceInfo",e.resourceInfo),delete(e=K({},e)).resourceInfo),e}set layers(e){this._set("layers",D0(e,this._get("layers")))}writeLayers(e,t,i,r){const n=[];e&&(r=Ce(K({},r),{layerContainerType:"ground"}),e.forEach(o=>{if("write"in o){const c={};o_e(o)().write(c,r)&&n.push(c)}else r&&r.messages&&r.messages.push(new ue("layer:unsupported",`Layers (${o.title}, ${o.id}) of type '${o.declaredClass}' cannot be persisted in the ground`,{layer:o}))})),t.layers=n}load(e){return this.addResolvingPromise(this._loadFromSource(e)),Promise.resolve(this)}loadAll(){return ok(this,e=>{e(this.layers)})}async queryElevation(e,t){await this.load({signal:t==null?void 0:t.signal});const{ElevationQuery:i}=await import("./ElevationQuery.51f1d008.js");ur(t);const r=new i,n=this.layers.filter(oU).toArray();return r.queryAll(n,e,t)}async createElevationSampler(e,t){await this.load({signal:t==null?void 0:t.signal});const{ElevationQuery:i}=await import("./ElevationQuery.51f1d008.js");ur(t);const r=new i,n=this.layers.filter(oU).toArray();return r.createSamplerAll(n,e,t)}clone(){const e={opacity:this.opacity,surfaceColor:_e(this.surfaceColor),navigationConstraint:_e(this.navigationConstraint),layers:this.layers.slice()};return this.loaded&&(e.loadStatus="loaded"),new pk({resourceInfo:this.resourceInfo}).set(e)}read(e,t){this.resourceInfo||this._set("resourceInfo",{data:e,context:t}),super.read(e,t)}_loadFromSource(e){const t=this.resourceInfo;return t?this._loadLayersFromJSON(t.data,t.context,e):Promise.resolve()}_loadLayersFromJSON(e,t,i){const r=t&&t.origin||"web-scene",n=t&&t.portal||null,o=t&&t.url||null;return import("./layersCreator.04c752a3.js").then(({populateOperationalLayers:c})=>{ur(i);const h=[];if(e.layers&&Array.isArray(e.layers)){const m={context:{origin:r,url:o,portal:n,layerContainerType:"ground"},defaultLayerType:"ArcGISTiledElevationServiceLayer"};h.push(c(this.layers,e.layers,m))}return Mr(h)}).then(()=>{})}};function l_e(e){return e&&"createElevationSampler"in e}function oU(e){return e.type==="elevation"||l_e(e)}g([w({json:{read:!1}})],fu.prototype,"layers",null),g([tt("layers")],fu.prototype,"writeLayers",null),g([w({readOnly:!0})],fu.prototype,"resourceInfo",void 0),g([w({type:Number,nonNullable:!0,range:{min:0,max:1},json:{type:Ri,read:{reader:qw,source:"transparency"},write:{writer:(e,t)=>{t.transparency=p5(e)},target:"transparency"}}})],fu.prototype,"opacity",void 0),g([w({type:Boolean,nonNullable:!0,json:{read:!1}})],fu.prototype,"shading",void 0),g([w({type:ut,json:{type:[Ri],write:(e,t)=>{t.surfaceColor=e.toJSON().slice(0,3)}}})],fu.prototype,"surfaceColor",void 0),g([w({type:B5,json:{write:!0}})],fu.prototype,"navigationConstraint",void 0),fu=pk=g([te("esri.Ground")],fu);const U5=fu;let Ng=class extends Xe{constructor(e){super(e),this.getCollections=null}initialize(){this.own(VV(()=>this._refresh()))}destroy(){this.getCollections=null}_refresh(){const e=H(this.getCollections)?this.getCollections():null;if(ce(e))return void this.removeAll();let t=0;for(const i of e)H(i)&&(t=this._processCollection(t,i));this.splice(t,this.length)}_createNewInstance(e){return new Xe(e)}_processCollection(e,t){if(!t)return e;const i=this.itemFilterFunction?this.itemFilterFunction:r=>!!r;for(const r of t)if(r){if(i(r)){const n=this.indexOf(r,e);n>=0?n!==e&&this.reorder(r,e):this.add(r,e),++e}if(this.getChildrenFunction){const n=this.getChildrenFunction(r);if(Array.isArray(n))for(const o of n)e=this._processCollection(e,o);else e=this._processCollection(e,n)}}return e}};g([w()],Ng.prototype,"getCollections",void 0),g([w()],Ng.prototype,"getChildrenFunction",void 0),g([w()],Ng.prototype,"itemFilterFunction",void 0),Ng=g([te("esri.core.CollectionFlattener")],Ng);const Dg=Ng;function c_e(e){var t;return!!(e&&e.loaded&&"capabilities"in e&&((t=e==null?void 0:e.capabilities)==null?void 0:t.operations)&&"supportsEditing"in e.capabilities.operations&&e.capabilities.operations.supportsEditing===!0)&&!("editingEnabled"in e&&!e.editingEnabled)}const aU=$e.getLogger("esri.support.basemapUtils");function u_e(){return{}}function h_e(e){for(const t in e){const i=e[t];(i==null?void 0:i.destroyed)===!1&&i.destroy(),delete e[t]}}function p_e(e,t){let i;if(typeof e=="string"){if(!(e in lk)){const r=Object.entries(lk).filter(([n,o])=>$i.apiKey&&!o.classic||!$i.apiKey&&o.classic&&!o.deprecated).map(([n])=>`"${n}"`).join(", ");return aU.warn(`Unable to find basemap definition for: ${e}. Try one of these: ${r}`),null}t&&(i=t[e]),i||(i=K0.fromId(e),t&&(t[e]=i))}else i=Oi(K0,e);return(i==null?void 0:i.destroyed)&&(aU.warn("The provided basemap is already destroyed",{basemap:i}),i=null),i}function d_e(e,t){return e===t?!0:v_e(lU(e),lU(t),{mustMatchReferences:!0})==="equal"}function f_e(e,t){var n,o,c;if(ce(t)||ce(e))return{spatialReference:null,updating:!1};if(t.loadStatus==="not-loaded")return t.load(),{spatialReference:null,updating:!0};if(t.spatialReference)return{spatialReference:t.spatialReference,updating:!1};if(t.baseLayers.length===0)return{spatialReference:null,updating:!1};const i=t.baseLayers.getItemAt(0);switch(i.loadStatus){case"not-loaded":i.load();case"loading":return{spatialReference:null,updating:!0};case"failed":return{spatialReference:null,updating:!1}}const r=(("supportedSpatialReferences"in i?i.supportedSpatialReferences:null)||["tileInfo"in i?(n=i.tileInfo)==null?void 0:n.spatialReference:i.spatialReference]).filter(Boolean);return e.spatialReference?{spatialReference:(c=(o=r.find(h=>e.spatialReference.equals(h)))!=null?o:r[0])!=null?c:null,updating:!1}:{spatialReference:r[0],updating:!1}}function lU(e){return e?!e.loaded&&e.resourceInfo?m_e(e.resourceInfo.data):{baseLayers:cU(e.baseLayers),referenceLayers:cU(e.referenceLayers)}:null}function cU(e){return(Xe.isCollection(e)?e.toArray():e).map(y_e)}function y_e(e){var t,i;return{type:e.type,url:pU("urlTemplate"in e&&e.urlTemplate||e.url||"styleUrl"in e&&e.styleUrl),minScale:"minScale"in e&&e.minScale!=null?e.minScale:0,maxScale:"maxScale"in e&&e.maxScale!=null?e.maxScale:0,opacity:e.opacity!=null?e.opacity:1,visible:e.visible==null||!!e.visible,sublayers:e.type!=="map-image"&&e.type!=="wms"||!H(e.sublayers)||(t=e.sublayers)==null?void 0:t.map(r=>({id:r.id,visible:r.visible})),activeLayerId:e.type==="wmts"?(i=e.activeLayer)==null?void 0:i.id:void 0}}function m_e(e){return e?{baseLayers:uU(e.baseMapLayers.filter(t=>!t.isReference)),referenceLayers:uU(e.baseMapLayers.filter(t=>t.isReference))}:null}function uU(e){return e.map(t=>g_e(t))}function g_e(e){let t;switch(e.layerType){case"VectorTileLayer":t="vector-tile";break;case"ArcGISTiledMapServiceLayer":t="tile";break;default:t="unknown"}return{type:t,url:pU(e.templateUrl||e.urlTemplate||e.styleUrl||e.url),minScale:e.minScale!=null?e.minScale:0,maxScale:e.maxScale!=null?e.maxScale:0,opacity:e.opacity!=null?e.opacity:1,visible:e.visibility==null||!!e.visibility,sublayers:void 0,activeLayerId:void 0}}function v_e(e,t,i){return e!=null!=(t!=null)?"not-equal":e?hU(e.baseLayers,t.baseLayers)?hU(e.referenceLayers,t.referenceLayers)?"equal":i.mustMatchReferences?"not-equal":"base-layers-equal":"not-equal":"equal"}function hU(e,t){if(e.length!==t.length)return!1;for(let i=0;i<e.length;i++)if(!b_e(e[i],t[i]))return!1;return!0}function b_e(e,t){if(e.type!==t.type||e.url!==t.url||e.minScale!==t.minScale||e.maxScale!==t.maxScale||e.visible!==t.visible||e.opacity!==t.opacity)return!1;if(H(e.activeLayerId)||H(t.activeLayerId))return e.activeLayerId===t.activeLayerId;if(H(e.sublayers)||H(t.sublayers)){if(ce(e.sublayers)||ce(t.sublayers)||e.sublayers.length!==t.sublayers.length)return!1;for(let i=0;i<e.sublayers.length;i++){const r=e.sublayers.at(i),n=t.sublayers.at(i);if(r.id!==n.id||r.visible!==n.visible)return!1}}return!0}function pU(e){return e?zs(e).replace(/^\s*https?:/i,"").toLowerCase():""}function w_e(e){return new Dg({getCollections:()=>[e.tables,e.layers],getChildrenFunction:t=>{const i=[];return"tables"in t&&i.push(t.tables),"layers"in t&&i.push(t.layers),i},itemFilterFunction:t=>{const i=t.parent;return i&&"tables"in i&&i.tables.includes(t)}})}const dU={"world-elevation":{id:"worldElevation",url:"//elevation3d.arcgis.com/arcgis/rest/services/WorldElevation3D/Terrain3D/ImageServer",layerType:"ArcGISTiledElevationServiceLayer"},"world-topobathymetry":{id:"worldTopoBathymetry",url:"//elevation3d.arcgis.com/arcgis/rest/services/WorldElevation3D/TopoBathy3D/ImageServer",layerType:"ArcGISTiledElevationServiceLayer"}};function __e(e){let t=null;if(typeof e=="string")if(e in dU){const i=dU[e];t=new U5({resourceInfo:{data:{layers:[i]}}})}else $e.getLogger("esri.support.groundUtils").warn(`Unable to find ground definition for: ${e}. Try "world-elevation"`);else t=Oi(U5,e);return t}async function x_e(e){const t="portalItem"in e?e:{portalItem:e},i=await import("./portalLayers.fa45fff9.js");try{return await i.fromItem(t)}catch(r){const n=t&&t.portalItem,o=n&&n.id||"unset",c=n&&n.portal&&n.portal.url||$i.portalUrl;throw $e.getLogger("esri.layers.support.fromPortalItem").error("#fromPortalItem()","Failed to create layer from portal item (portal: '"+c+"', id: '"+o+"')",r),r}}let S_e=0,ss=class extends Or.EventedMixin(rc(Xo)){constructor(){super(...arguments),this.attributionDataUrl=null,this.fullExtent=new gi(-180,-90,180,90,Mt.WGS84),this.id=Date.now().toString(16)+"-layer-"+S_e++,this.legendEnabled=!0,this.listMode="show",this.opacity=1,this.parent=null,this.popupEnabled=!0,this.attributionVisible=!0,this.spatialReference=Mt.WGS84,this.title=null,this.type=null,this.url=null,this.visible=!0}static async fromArcGISServerUrl(e){const t=typeof e=="string"?{url:e}:e;return(await import("./arcgisLayers.64407b3e.js")).fromUrl(t)}static fromPortalItem(e){return x_e(e)}initialize(){this.when().catch(e=>{var t,i;Xn(e)||$e.getLogger(this.declaredClass).error("#load()",`Failed to load layer (title: '${(t=this.title)!=null?t:"no title"}', id: '${(i=this.id)!=null?i:"no id"}')`,{error:e})})}destroy(){if(this.parent){const e=this,t=this.parent;"layers"in t&&t.layers.includes(e)?t.layers.remove(e):"tables"in t&&t.tables.includes(e)?t.tables.remove(e):"baseLayers"in t&&t.baseLayers.includes(e)?t.baseLayers.remove(e):"baseLayers"in t&&t.referenceLayers.includes(e)&&t.referenceLayers.remove(e)}}get hasAttributionData(){return this.attributionDataUrl!=null}get parsedUrl(){return mn(this.url)}async fetchAttributionData(){const e=this.attributionDataUrl;if(this.hasAttributionData&&e)return(await Nt(e,{query:{f:"json"},responseType:"json"})).data;throw new ue("layer:no-attribution-data","Layer does not have attribution data")}};g([w({type:String})],ss.prototype,"attributionDataUrl",void 0),g([w({type:gi})],ss.prototype,"fullExtent",void 0),g([w({readOnly:!0})],ss.prototype,"hasAttributionData",null),g([w({type:String,clonable:!1})],ss.prototype,"id",void 0),g([w({type:Boolean,nonNullable:!0})],ss.prototype,"legendEnabled",void 0),g([w({type:["show","hide","hide-children"]})],ss.prototype,"listMode",void 0),g([w({type:Number,range:{min:0,max:1},nonNullable:!0})],ss.prototype,"opacity",void 0),g([w({clonable:!1})],ss.prototype,"parent",void 0),g([w({readOnly:!0})],ss.prototype,"parsedUrl",null),g([w({type:Boolean})],ss.prototype,"popupEnabled",void 0),g([w({type:Boolean})],ss.prototype,"attributionVisible",void 0),g([w({type:Mt})],ss.prototype,"spatialReference",void 0),g([w({type:String})],ss.prototype,"title",void 0),g([w({readOnly:!0,json:{read:!1}})],ss.prototype,"type",void 0),g([w()],ss.prototype,"url",void 0),g([w({type:Boolean,nonNullable:!0})],ss.prototype,"visible",void 0),ss=g([te("esri.layers.Layer")],ss);const Y0=ss;function dk(e,t,i){let r,n;if(e)for(let o=0,c=e.length;o<c;o++){if(r=e.getItemAt(o),r[t]===i)return r;if((r==null?void 0:r.type)==="group"&&(n=dk(r.layers,t,i),n))return n}}const M_e=e=>{let t=class extends e{constructor(...i){super(...i),this.layers=new Xe;const r=c=>{c.parent&&"remove"in c.parent&&c.parent.remove(c)},n=c=>{c.parent=this,this.layerAdded(c),c.type!=="elevation"&&c.type!=="base-elevation"||$e.getLogger(this.declaredClass).error(`Layer 'title:${c.title}, id:${c.id}' of type '${c.type}' is not supported as an operational layer and will therefore be ignored.`)},o=c=>{c.parent=null,this.layerRemoved(c)};this.layers.on("before-add",c=>r(c.item)),this.layers.on("after-add",c=>n(c.item)),this.layers.on("after-remove",c=>o(c.item))}destroy(){const i=this.layers.removeAll();for(const r of i)this.layerRemoved(r),r.destroy();this.layers.destroy()}set layers(i){this._set("layers",D0(i,this._get("layers")))}add(i,r){const n=this.layers;if(r=n.getNextIndex(r),i instanceof Y0){const o=i;o.parent===this?this.reorder(o,r):n.add(o,r)}else yh(i)?i.then(o=>{this.destroyed||this.add(o,r)}):$e.getLogger(this.declaredClass).error("#add()","The item being added is not a Layer or a Promise that resolves to a Layer.")}addMany(i,r){const n=this.layers;r=n.getNextIndex(r),i.slice().forEach(o=>{o.parent!==this?(n.add(o,r),r+=1):this.reorder(o,r)})}findLayerById(i){return dk(this.layers,"id",i)}findLayerByUid(i){return dk(this.layers,"uid",i)}remove(i){return this.layers.remove(i)}removeMany(i){return this.layers.removeMany(i)}removeAll(){return this.layers.removeAll()}reorder(i,r){return this.layers.reorder(i,r)}layerAdded(i){}layerRemoved(i){}};return g([w()],t.prototype,"layers",null),t=g([te("esri.support.LayersMixin")],t),t};function fk(e,t,i){if(e)for(let r=0,n=e.length;r<n;r++){const o=e.getItemAt(r);if(o[t]===i)return o;if((o==null?void 0:o.type)==="group"){const c=fk(o.tables,t,i);if(c)return c}}}const I_e=e=>{let t=class extends e{constructor(...i){super(...i),this.tables=new Xe,this.tables.on("after-add",r=>{const n=r.item;n.parent&&n.parent!==this&&"tables"in n.parent&&n.parent.tables.remove(n),n.parent=this,n.type!=="feature"&&$e.getLogger(this.declaredClass).error(`Layer 'title:${n.title}, id:${n.id}' of type '${n.type}' is not supported as a table and will therefore be ignored.`)}),this.tables.on("after-remove",r=>{r.item.parent=null})}destroy(){const i=this.tables.removeAll();for(const r of i)r.destroy();this.tables.destroy()}set tables(i){this._set("tables",D0(i,this._get("tables")))}findTableById(i){return fk(this.tables,"id",i)}findTableByUid(i){return fk(this.tables,"uid",i)}};return g([w()],t.prototype,"tables",null),t=g([te("esri.support.TablesMixin")],t),t};let yu=class extends I_e(M_e(Or.EventedMixin(Ye))){constructor(e){super(e),this.allLayers=new Dg({getCollections:()=>{var t,i,r;return[(t=this.basemap)==null?void 0:t.baseLayers,(i=this.ground)==null?void 0:i.layers,this.layers,(r=this.basemap)==null?void 0:r.referenceLayers]},getChildrenFunction:t=>"layers"in t?t.layers:null}),this.allTables=w_e(this),this.basemap=null,this.editableLayers=new Dg({getCollections:()=>[this.allLayers],itemFilterFunction:c_e}),this.ground=new U5,this._basemapCache=u_e()}destroy(){var e,t;this.allLayers.destroy(),this.allTables.destroy(),this.editableLayers.destroy(),(e=this.ground)==null||e.destroy(),(t=this.basemap)==null||t.destroy(),h_e(this._basemapCache),this._basemapCache=null}castBasemap(e){return p_e(e,this._basemapCache)}castGround(e){const t=__e(e);return ce(t)?this._get("ground"):t}findLayerById(e){return this.allLayers.find(t=>t.id===e)}findTableById(e){return this.allTables.find(t=>t.id===e)}};g([w({readOnly:!0,dependsOn:[]})],yu.prototype,"allLayers",void 0),g([w({readOnly:!0})],yu.prototype,"allTables",void 0),g([w({type:K0})],yu.prototype,"basemap",void 0),g([Dt("basemap")],yu.prototype,"castBasemap",null),g([w({readOnly:!0})],yu.prototype,"editableLayers",void 0),g([w({type:U5,nonNullable:!0})],yu.prototype,"ground",void 0),g([Dt("ground")],yu.prototype,"castGround",null),yu=g([te("esri.Map")],yu);const $_e=yu;class yk{constructor(t,i){this.min=t,this.max=i,this.range=i-t}ndiff(t,i=0){return Math.ceil((t-i)/this.range)*this.range+i}_normalize(t,i,r,n=0,o=!1){return(r-=n)<t?r+=this.ndiff(t-r):r>i&&(r-=this.ndiff(r-i)),o&&r===i&&(r=t),r+n}normalize(t,i=0,r=!1){return this._normalize(this.min,this.max,t,i,r)}clamp(t,i=0){return Vs(t-i,this.min,this.max)+i}monotonic(t,i,r){return t<i?i:i+this.ndiff(t-i,r)}minimalMonotonic(t,i,r){return this._normalize(t,t+this.range,i,r)}center(t,i,r){return i=this.monotonic(t,i,r),this.normalize((t+i)/2,r)}diff(t,i,r){return this.monotonic(t,i,r)-t}shortestSignedDiff(t,i){t=this.normalize(t);const r=(i=this.normalize(i))-t,n=i<t?this.minimalMonotonic(t,i)-t:i-this.minimalMonotonic(i,t);return Math.abs(r)<Math.abs(n)?r:n}contains(t,i,r){return i=this.minimalMonotonic(t,i),(r=this.minimalMonotonic(t,r))>t&&r<i}}function mk(e){for(const t in e){const i=e[t];i instanceof Function&&(e[t]=i.bind(e))}return e}mk(new yk(0,2*Math.PI));const bJe=mk(new yk(-Math.PI,Math.PI)),fU=mk(new yk(0,360));let Th=class extends rn(ke){constructor(...e){super(...e),this.position=new pt([0,0,0]),this.heading=0,this.tilt=0,this.fov=55}normalizeCtorArgs(e,t,i,r){if(e&&typeof e=="object"&&("x"in e||Array.isArray(e))){const n={position:e};return t!=null&&(n.heading=t),i!=null&&(n.tilt=i),r!=null&&(n.fov=r),n}return e}writePosition(e,t,i,r){const n=e.clone();n.x=hl(e.x||0),n.y=hl(e.y||0),n.z=e.hasZ?hl(e.z||0):e.z,t[i]=n.write({},r)}readPosition(e,t){const i=new pt;return i.read(e,t),i.x=hl(i.x||0),i.y=hl(i.y||0),i.z=i.hasZ?hl(i.z||0):i.z,i}equals(e){return!ce(e)&&this.tilt===e.tilt&&this.heading===e.heading&&this.fov===e.fov&&this.position.equals(e.position)}};g([w({type:pt,json:{write:{isRequired:!0}}})],Th.prototype,"position",void 0),g([tt("position")],Th.prototype,"writePosition",null),g([We("position")],Th.prototype,"readPosition",null),g([w({type:Number,nonNullable:!0,json:{write:{isRequired:!0}}}),Dt(e=>fU.normalize(hl(e)))],Th.prototype,"heading",void 0),g([w({type:Number,nonNullable:!0,json:{write:{isRequired:!0}}}),Dt(e=>Vs(hl(e),-180,180))],Th.prototype,"tilt",void 0),g([w({type:Number,nonNullable:!0,json:{read:!1,write:!1}})],Th.prototype,"fov",void 0),Th=g([te("esri.Camera")],Th);const E_e=Th;var gk;let Dd=gk=class extends ke{constructor(e){super(e),this.rotation=0,this.scale=0,this.targetGeometry=null,this.camera=null}castRotation(e){return(e%=360)<0&&(e+=360),e}clone(){return new gk({rotation:this.rotation,scale:this.scale,targetGeometry:H(this.targetGeometry)?this.targetGeometry.clone():null,camera:H(this.camera)?this.camera.clone():null})}};function vk(){return{enabled:!this.camera}}g([w({type:Number,json:{write:!0,origins:{"web-map":{default:0,write:!0},"web-scene":{write:{overridePolicy:vk}}}}})],Dd.prototype,"rotation",void 0),g([Dt("rotation")],Dd.prototype,"castRotation",null),g([w({type:Number,json:{write:!0,origins:{"web-map":{default:0,write:!0},"web-scene":{write:{overridePolicy:vk}}}}})],Dd.prototype,"scale",void 0),g([w({types:wh,json:{read:xs,write:!0,origins:{"web-scene":{read:xs,write:{overridePolicy:vk}}}}})],Dd.prototype,"targetGeometry",void 0),g([w({type:E_e,json:{write:!0}})],Dd.prototype,"camera",void 0),Dd=gk=g([te("esri.Viewpoint")],Dd);const ra=Dd;function we(e,t,i={}){return bk(e,t,i,yU)}function os(e,t,i={}){return bk(e,t,i,mU)}function bk(e,t,i={},r){let n=null;const o=i.once?(c,h)=>{r(c)&&(mr(n),t(c,h))}:(c,h)=>{r(c)&&t(c,h)};if(n=pme(e,o,i.sync,i.equals),i.initial){const c=e();o(c,c)}return n}function vr(e,t,i,r={}){let n=null,o=null,c=null;function h(){var x;n&&o&&(o.remove(),(x=r.onListenerRemove)==null||x.call(r,n),n=null,o=null)}function m(x){r.once&&r.once&&mr(c),i(x)}const b=we(e,(x,I)=>{var E;h(),wS(x)&&(n=x,o=cw(x,t,m),(E=r.onListenerAdd)==null||E.call(r,x))},{sync:r.sync,initial:!0});return c=uh(()=>{b.remove(),h()}),c}function Ch(e,t){return T_e(e,mU,t)}function T_e(e,t,i){if(ka(i))return Promise.reject(Qi());const r=e();if(t==null?void 0:t(r))return Promise.resolve(r);let n=null;function o(){n=mr(n)}return new Promise((c,h)=>{n=od([Ho(i,()=>{o(),h(Qi())}),bk(e,m=>{o(),c(m)},{sync:!1,once:!0},t!=null?t:yU)])})}function yU(e){return!0}function mU(e){return!!e}function C_e(e,t,i={}){let r=!1;const n=we(e,(o,c)=>{r||t(o,c)},i);return{remove(){n.remove()},pause(){r=!0},resume(){r=!1}}}const mu={sync:!0},St={initial:!0},Gs={sync:!0,initial:!0};class q5{constructor(t=i=>i.values().next().value){this._peeker=t,this._items=new Set}get length(){return this._items.size}clear(){this._items.clear()}last(){if(this._items.size===0)return;let t;for(t of this._items);return t}peek(){if(this._items.size!==0)return this._peeker(this._items)}push(t){this.contains(t)||this._items.add(t)}contains(t){return this._items.has(t)}pop(){if(this.length===0)return;const t=this.peek();return this._items.delete(On(t)),t}popLast(){if(this.length===0)return;const t=this.last();return this._items.delete(On(t)),t}remove(t){this._items.delete(t)}filter(t){return this._items.forEach(i=>{t(i)||this._items.delete(i)}),this}}var Ss;(function(e){e[e.HANDSHAKE=0]="HANDSHAKE",e[e.OPEN=1]="OPEN",e[e.OPENED=2]="OPENED",e[e.RESPONSE=3]="RESPONSE",e[e.INVOKE=4]="INVOKE",e[e.ABORT=5]="ABORT",e[e.CLOSE=6]="CLOSE",e[e.OPEN_PORT=7]="OPEN_PORT",e[e.ON=8]="ON"})(Ss||(Ss={}));let k_e=0;function gU(){return k_e++}function A_e(e){return e&&typeof e=="object"&&("result"in e||"transferList"in e)}function __(e){return e?typeof e=="string"?JSON.stringify({name:"message",message:e}):e.toJSON?JSON.stringify(e):JSON.stringify({name:e.name,message:e.message,details:e.details||{stack:e.stack}}):null}function wk(e,t,i,r){if(t.type===Ss.OPEN_PORT)return void e.postMessage(t,[t.port]);if(t.type!==Ss.INVOKE&&t.type!==Ss.RESPONSE)return void e.postMessage(t);let n;if(A_e(i)?(n=vU(i.transferList),t.data=i.result):(n=vU(r),t.data=i),n){if(Te("ff")){for(const o of n)if("byteLength"in o&&o.byteLength>267386880){const c="Worker call with large ArrayBuffer would crash Firefox";switch(t.type){case Ss.INVOKE:throw c;case Ss.RESPONSE:return void wk(e,{type:Ss.RESPONSE,jobId:t.jobId,error:__(c)})}}}e.postMessage(t,n)}else e.postMessage(t)}function x_(e){if(!e)return null;const t=e.data;return t?typeof t=="string"?JSON.parse(t):t:null}function vU(e){if(!e||!e.length)return null;if(Te("esri-workers-arraybuffer-transfer"))return e;const t=e.filter(i=>!P_e(i));return t.length?t:null}function P_e(e){return e instanceof ArrayBuffer||e&&e.constructor&&e.constructor.name==="ArrayBuffer"}const L_e={statsWorker:()=>import("./statsWorker.33e552e4.js"),geometryEngineWorker:()=>import("./geometryEngineWorker.5332f391.js"),CSVSourceWorker:()=>import("./CSVSourceWorker.1ddf541d.js"),EdgeProcessingWorker:()=>import("./EdgeProcessingWorker.3ddd2efa.js"),ElevationSamplerWorker:()=>import("./ElevationSamplerWorker.48dbf008.js"),FeatureServiceSnappingSourceWorker:()=>import("./FeatureServiceSnappingSourceWorker.493afcca.js"),GeoJSONSourceWorker:()=>import("./GeoJSONSourceWorker.46136c49.js"),LercWorker:()=>import("./LercWorker.eb9bf484.js"),MemorySourceWorker:()=>import("./MemorySourceWorker.bcd86502.js"),PBFDecoderWorker:()=>import("./PBFDecoderWorker.16f80d7c.js"),Pipeline:()=>import("./Pipeline.a1f0bf21.js"),PointCloudWorker:()=>import("./PointCloudWorker.c12019e0.js"),RasterWorker:()=>import("./RasterWorker.cc01f75d.js"),SceneLayerSnappingSourceWorker:()=>import("./SceneLayerSnappingSourceWorker.097b13ce.js"),SceneLayerWorker:()=>import("./SceneLayerWorker.68763730.js"),WFSSourceWorker:()=>import("./WFSSourceWorker.e0f2fd1f.js"),WorkerTileHandler:()=>import("./WorkerTileHandler.e7cb74a5.js")},{CLOSE:bU,ABORT:wU,INVOKE:_U,RESPONSE:S_,OPEN_PORT:xU,ON:O_e}=Ss,R_e=2;class F_e{constructor(t){this._timer=null,this._cancelledJobIds=new Set,this._invokeMessages=[],this._invoke=t,this._timer=null,this._process=this._process.bind(this)}push(t){t.type===Ss.ABORT?this._cancelledJobIds.add(t.jobId):(this._invokeMessages.push(t),this._timer===null&&(this._timer=setTimeout(this._process,0)))}clear(){this._invokeMessages.length=0,this._cancelledJobIds.clear(),this._timer=null}_process(){this._timer=null;for(const t of this._invokeMessages)this._cancelledJobIds.has(t.jobId)||this._invoke(t);this._cancelledJobIds.clear(),this._invokeMessages.length=0}}class na{constructor(t,i,r){this._port=t,this._getNextJob=r,this._outJobs=new Map,this._inJobs=new Map,this._invokeQueue=new F_e(n=>this._onInvokeMessage(n)),this._client=i.client,this._onMessage=this._onMessage.bind(this),this._channel=i.channel,this._schedule=i.schedule,this._port.addEventListener("message",this._onMessage),this._port.start()}static connect(t){const i=new MessageChannel;let r;r=typeof t=="function"?new t:"default"in t&&typeof t.default=="function"?new t.default:t;const n=new na(i.port1,{channel:i,client:r},()=>null);return typeof r=="object"&&"remoteClient"in r&&(r.remoteClient=n),na.clients.set(n,r),i.port2}static loadWorker(t){const i=L_e[t];return i?i():Promise.resolve(null)}close(){this._post({type:bU}),this._close()}isBusy(){return this._outJobs.size>0}invoke(t,i,r){const n=r&&r.signal,o=r&&r.transferList;if(!this._port)return Promise.reject(new ue("worker:port-closed",`Cannot call invoke('${t}'), port is closed`,{methodName:t,data:i}));const c=gU();return new Promise((h,m)=>{if(ka(n))return this._processWork(),void m(Qi());const b=Ho(n,()=>{const I=this._outJobs.get(c);I&&(this._outJobs.delete(c),this._processWork(),mr(I.abortHandle),this._post({type:wU,jobId:c}),m(Qi()))}),x={resolve:h,reject:m,abortHandle:b,debugInfo:t};this._outJobs.set(c,x),this._post({type:_U,jobId:c,methodName:t,abortable:n!=null},i,o)})}on(t,i){const r=new MessageChannel;function n(o){i(o.data)}return this._port.postMessage({type:Ss.ON,eventType:t,port:r.port2},[r.port2]),r.port1.addEventListener("message",n),r.port1.start(),{remove(){r.port1.postMessage({type:Ss.CLOSE}),r.port1.close(),r.port1.removeEventListener("message",n)}}}jobAdded(){this._processWork()}openPort(){const t=new MessageChannel;return this._post({type:xU,port:t.port2}),t.port1}_processWork(){if(this._outJobs.size>=R_e)return;const t=this._getNextJob();if(!t)return;const{methodName:i,data:r,invokeOptions:n,deferred:o}=t;this.invoke(i,r,n).then(c=>o.resolve(c)).catch(c=>o.reject(c))}_close(){this._channel&&(this._channel=void 0),this._port.removeEventListener("message",this._onMessage),this._port.close(),this._outJobs.forEach(t=>{mr(t.abortHandle),t.reject(Qi(`Worker closing, aborting job calling '${t.debugInfo}'`))}),this._inJobs.clear(),this._outJobs.clear(),this._invokeQueue.clear(),this._port=this._client=this._schedule=null}_onMessage(t){H(this._schedule)?this._schedule(()=>this._processMessage(t)):this._processMessage(t)}_processMessage(t){const i=x_(t);if(i)switch(i.type){case S_:this._onResponseMessage(i);break;case _U:this._invokeQueue.push(i);break;case wU:this._onAbortMessage(i);break;case bU:this._onCloseMessage();break;case xU:this._onOpenPortMessage(i);break;case O_e:this._onOnMessage(i)}}_onAbortMessage(t){const i=this._inJobs,r=t.jobId,n=i.get(r);this._invokeQueue.push(t),n&&(n.controller&&n.controller.abort(),i.delete(r))}_onCloseMessage(){const t=this._client;this._close(),t&&"destroy"in t&&na.clients.get(this)===t&&t.destroy(),na.clients.delete(this),t&&t.remoteClient&&(t.remoteClient=null)}_onInvokeMessage(t){const{methodName:i,jobId:r,data:n,abortable:o}=t,c=o?new AbortController:null,h=this._inJobs;let m,b=this._client,x=b[i];try{if(!x&&i&&i.includes(".")){const I=i.split(".");for(let E=0;E<I.length-1;E++)b=b[I[E]],x=b[I[E+1]]}if(typeof x!="function")throw new TypeError(`${i} is not a function`);m=x.call(b,n,{client:this,signal:c?c.signal:null})}catch(I){return void this._post({type:S_,jobId:r,error:__(I)})}yh(m)?(h.set(r,{controller:c,promise:m}),m.then(I=>{h.has(r)&&(h.delete(r),this._post({type:S_,jobId:r},I))},I=>{h.has(r)&&(h.delete(r),Xn(I)||this._post({type:S_,jobId:r,error:__(I||{message:`Error encountered at method ${i}`})}))})):this._post({type:S_,jobId:r},m)}_onOpenPortMessage(t){new na(t.port,{client:this._client},()=>null)}_onOnMessage(t){const{port:i}=t,r=this._client.on(t.eventType,o=>{i.postMessage(o)}),n=cw(t.port,"message",o=>{var c;((c=x_(o))==null?void 0:c.type)===Ss.CLOSE&&(n.remove(),r.remove(),i.close())})}_onResponseMessage(t){const{jobId:i,error:r,data:n}=t,o=this._outJobs;if(!o.has(i))return;const c=o.get(i);o.delete(i),this._processWork(),mr(c.abortHandle),r?c.reject(ue.fromJSON(JSON.parse(r))):c.resolve(n)}_post(t,i,r){return wk(this._port,t,i,r)}}na.kernelInfo={revision:bB,version:wB,buildDate:vB},na.clients=new Map;class N_e{constructor(){this._inUseClients=new Array,this._clients=new Array,this._clientPromises=new Array,this._ongoingJobsQueue=new q5}destroy(){this.close()}get closed(){return!this._clients||!this._clients.length}open(t,i){return new Promise((r,n)=>{let o=!0;const c=h=>{ur(i.signal),o&&(o=!1,h())};this._clients.length=t.length,this._clientPromises.length=t.length,this._inUseClients.length=t.length;for(let h=0;h<t.length;++h){const m=t[h];yh(m)?this._clientPromises[h]=m.then(b=>(this._clients[h]=new na(b,i,()=>{var x;return(x=this._ongoingJobsQueue.pop())!=null?x:null}),c(r),this._clients[h]),()=>(c(n),null)):(this._clients[h]=new na(m,i,()=>{var b;return(b=this._ongoingJobsQueue.pop())!=null?b:null}),this._clientPromises[h]=Promise.resolve(this._clients[h]),c(r))}})}broadcast(t,i,r){const n=new Array(this._clientPromises.length);for(let o=0;o<this._clientPromises.length;++o){const c=this._clientPromises[o];n[o]=c.then(h=>h==null?void 0:h.invoke(t,i,r))}return n}close(){let t;for(;t=this._ongoingJobsQueue.pop();)t.deferred.reject(Qi(`Worker closing, aborting job calling '${t.methodName}'`));for(const i of this._clientPromises)i.then(r=>r==null?void 0:r.close());this._clients.length=0,this._clientPromises.length=0}invoke(t,i,r){let n;Array.isArray(r)?($e.getLogger("esri.core.workers.Connection").warn("invoke()","The transferList parameter is deprecated, use the options object instead"),n={transferList:r}):n=r;const o=fh();this._ongoingJobsQueue.push({methodName:t,data:i,invokeOptions:n,deferred:o});for(let c=0;c<this._clientPromises.length;c++){const h=this._clients[c];h?h.jobAdded():this._clientPromises[c].then(m=>m==null?void 0:m.jobAdded())}return o.promise}on(t,i){return Promise.all(this._clientPromises).then(()=>od(this._clients.map(r=>r.on(t,i))))}openPorts(){return new Promise(t=>{const i=new Array(this._clientPromises.length);let r=i.length;for(let n=0;n<this._clientPromises.length;++n)this._clientPromises[n].then(o=>{o&&(i[n]=o.openPort()),--r==0&&t(i)})})}get test(){return{numClients:this._clients.length}}}const SU=$e.getLogger("esri.intl.substitute");function oo(e,t,i={}){const{format:r={}}=i;return Kc(e,n=>D_e(n,t,r))}function D_e(e,t,i){var m;let r,n;const o=e.indexOf(":");if(o===-1?r=e.trim():(r=e.slice(0,o).trim(),n=e.slice(o+1).trim()),!r)return"";const c=Km(r,t);if(c==null)return"";const h=(m=n?i==null?void 0:i[n]:null)!=null?m:i==null?void 0:i[r];return h?j_e(c,h):n?V_e(c,n):_k(c)}function j_e(e,t){switch(t.type){case"date":return Pa(e,t.intlOptions);case"number":return Jo(e,t.intlOptions);default:return SU.warn("missing format descriptor for key {key}"),_k(e)}}function V_e(e,t){switch(t.toLowerCase()){case"dateformat":return Pa(e);case"numberformat":return Jo(e);default:return SU.warn(`inline format is unsupported since 4.12: ${t}`),/^(dateformat|datestring)/i.test(t)?Pa(e):/^numberformat/i.test(t)?Jo(e):_k(e)}}function _k(e){switch(typeof e){case"string":return e;case"number":return Jo(e);case"boolean":return""+e;default:return e instanceof Date?Pa(e):""}}async function z_e(e,t,i,r){const n=t.exec(i);if(!n)throw new ue("esri-intl:invalid-bundle",`Bundle id "${i}" is not compatible with the pattern "${t}"`);const o=n[1]?`${n[1]}/`:"",c=n[2],h=Hwe(r),m=`${o}${c}.json`,b=h?`${o}${c}_${h}.json`:m;let x;try{x=await MU(e(b))}catch(I){if(b===m)throw new ue("intl:unknown-bundle",`Bundle "${i}" cannot be loaded`,{error:I});try{x=await MU(e(m))}catch(E){throw new ue("intl:unknown-bundle",`Bundle "${i}" cannot be loaded`,{error:E})}}return x}async function MU(e){if(H(IU.fetchBundleAsset))return IU.fetchBundleAsset(e);const t=await Nt(e,{responseType:"text"});return JSON.parse(t.data)}class G_e{constructor({base:t="",pattern:i,location:r=new URL(window.location.href)}){let n;n=typeof r=="string"?o=>new URL(o,new URL(r,window.location.href)).href:r instanceof URL?o=>new URL(o,r).href:r,this.pattern=typeof i=="string"?new RegExp(`^${i}`):i,this.getAssetUrl=n,t=t?t.endsWith("/")?t:t+"/":"",this.matcher=new RegExp(`^${t}(?:(.*)/)?(.*)$`)}fetchMessageBundle(t,i){return z_e(this.getAssetUrl,this.matcher,t,i)}}function B_e(e){return new G_e(e)}const IU={};qwe(B_e({pattern:"esri/",location:_i}));const $U={};function U_e(e,t){for(const i of e)if(i.name===t.name)return;e.push(t)}function q_e(e){var i;const t={async:e.async,isDebug:e.isDebug,locale:e.locale,baseUrl:e.baseUrl,has:K({},e.has),map:K({},e.map),packages:e.packages&&e.packages.concat()||[],paths:K({},e.paths)};return e.hasOwnProperty("async")||(t.async=!0),e.hasOwnProperty("isDebug")||(t.isDebug=!1),e.baseUrl||(t.baseUrl=$U.baseUrl),(i=$U.packages)==null||i.forEach(r=>{var n;U_e((n=t.packages)!=null?n:[],r)}),t}class H_e{constructor(){const t=document.createDocumentFragment();["addEventListener","dispatchEvent","removeEventListener"].forEach(i=>{this[i]=(...r)=>t[i](...r)})}}class H5{constructor(){this._dispatcher=new H_e,this._workerPostMessage({type:Ss.HANDSHAKE})}terminate(){}get onmessage(){return this._onmessageHandler}set onmessage(t){this._onmessageHandler&&this.removeEventListener("message",this._onmessageHandler),this._onmessageHandler=t,t&&this.addEventListener("message",t)}get onmessageerror(){return this._onmessageerrorHandler}set onmessageerror(t){this._onmessageerrorHandler&&this.removeEventListener("messageerror",this._onmessageerrorHandler),this._onmessageerrorHandler=t,t&&this.addEventListener("messageerror",t)}get onerror(){return this._onerrorHandler}set onerror(t){this._onerrorHandler&&this.removeEventListener("error",this._onerrorHandler),this._onerrorHandler=t,t&&this.addEventListener("error",t)}postMessage(t){Qm(()=>{this._workerMessageHandler(new MessageEvent("message",{data:t}))})}dispatchEvent(t){return this._dispatcher.dispatchEvent(t)}addEventListener(t,i,r){this._dispatcher.addEventListener(t,i,r)}removeEventListener(t,i,r){this._dispatcher.removeEventListener(t,i,r)}_workerPostMessage(t){Qm(()=>{this.dispatchEvent(new MessageEvent("message",{data:t}))})}async _workerMessageHandler(t){const i=x_(t);if(i&&i.type===Ss.OPEN){const{modulePath:r,jobId:n}=i;let o=await na.loadWorker(r);o||(o=await import(r));const c=na.connect(o);this._workerPostMessage({type:Ss.OPENED,jobId:n,data:c})}}}const xk=$e.getLogger("esri.core.workers.workerFactory"),{HANDSHAKE:W_e}=Ss,J_e='let globalId=0;const outgoing=new Map,configuration=JSON.parse("{CONFIGURATION}");self.esriConfig=configuration.esriConfig;const workerPath=self.esriConfig.workers.workerPath,HANDSHAKE=0,OPEN=1,OPENED=2,RESPONSE=3,INVOKE=4,ABORT=5;function createAbortError(){const e=new Error("Aborted");return e.name="AbortError",e}function receiveMessage(e){return e&&e.data?"string"==typeof e.data?JSON.parse(e.data):e.data:null}function invokeStaticMessage(e,o,r){const t=r&&r.signal,n=globalId++;return new Promise(((r,i)=>{if(t){if(t.aborted)return i(createAbortError());t.addEventListener("abort",(()=>{outgoing.get(n)&&(outgoing.delete(n),self.postMessage({type:5,jobId:n}),i(createAbortError()))}))}outgoing.set(n,{resolve:r,reject:i}),self.postMessage({type:4,jobId:n,methodName:e,abortable:null!=t,data:o})}))}let workerRevisionChecked=!1;function checkWorkerRevision(e){if(!workerRevisionChecked&&e.kernelInfo){workerRevisionChecked=!0;const{revision:o,version:r}=configuration.kernelInfo,{revision:t,version:n}=e.kernelInfo;esriConfig.assetsPath!==esriConfig.defaultAssetsPath&&o!==t&&console.warn(`Version mismatch detected between ArcGIS API for JavaScript modules and assets. For more information visit https://bit.ly/3QnsuSo.\\nModules version: ${r}\\nAssets version: ${n}`)}}function messageHandler(e){const o=receiveMessage(e);if(!o)return;const r=o.jobId;switch(o.type){case 1:let n;function t(e){const o=n.connect(e);self.postMessage({type:2,jobId:r,data:o},[o])}"function"==typeof define&&define.amd?require([workerPath],(e=>{n=e.default||e,checkWorkerRevision(n),n.loadWorker(o.modulePath).then((e=>e||new Promise((e=>{require([o.modulePath],e)})))).then(t)})):"System"in self&&"function"==typeof System.import?System.import(workerPath).then((e=>(n=e.default,checkWorkerRevision(n),n.loadWorker(o.modulePath)))).then((e=>e||System.import(o.modulePath))).then(t):esriConfig.workers.useDynamicImport?import(workerPath).then((e=>{n=e.default||e,checkWorkerRevision(n),n.loadWorker(o.modulePath).then((e=>e||import(o.modulePath))).then(t)})):(self.RemoteClient||importScripts(workerPath),n=self.RemoteClient.default||self.RemoteClient,checkWorkerRevision(n),n.loadWorker(o.modulePath).then(t));break;case 3:if(outgoing.has(r)){const i=outgoing.get(r);outgoing.delete(r),o.error?i.reject(JSON.parse(o.error)):i.resolve(o.data)}}}self.dojoConfig=configuration.loaderConfig,esriConfig.workers.loaderUrl&&(self.importScripts(esriConfig.workers.loaderUrl),"function"==typeof require&&"function"==typeof require.config&&require.config(configuration.loaderConfig)),self.addEventListener("message",messageHandler),self.postMessage({type:0});';let W5,J5;const EU="Failed to create Worker. Fallback to execute module in main thread";async function Z_e(){if(!Te("esri-workers")||(Te("mozilla"),0))return TU(new H5);if(!W5&&!J5)try{const t=J_e.split('"{CONFIGURATION}"').join(`'${K_e()}'`);W5=URL.createObjectURL(new Blob([t],{type:"text/javascript"}))}catch(t){J5=t||{}}let e;if(W5)try{e=new Worker(W5,{name:"esri-worker-"+Y_e++})}catch{xk.warn(EU,J5),e=new H5}else xk.warn(EU,J5),e=new H5;return TU(e)}async function TU(e){return new Promise(t=>{function i(n){const o=x_(n);o&&o.type===W_e&&(e.removeEventListener("message",i),e.removeEventListener("error",r),t(e))}function r(n){n.preventDefault(),e.removeEventListener("message",i),e.removeEventListener("error",r),xk.warn("Failed to create Worker. Fallback to execute module in main thread",n),(e=new H5).addEventListener("message",i),e.addEventListener("error",r)}e.addEventListener("message",i),e.addEventListener("error",r)})}function K_e(){let e;if($i.default!=null){const n=K({},$i);delete n.default,e=JSON.parse(JSON.stringify(n))}else e=JSON.parse(JSON.stringify($i));e.assetsPath=Ra(e.assetsPath),e.defaultAssetsPath=e.defaultAssetsPath?Ra(e.defaultAssetsPath):void 0,e.request.interceptors=[],e.log.interceptors=[],e.locale=io(),e.has={"esri-csp-restrictions":Te("esri-csp-restrictions"),"esri-2d-debug":!1,"esri-2d-update-debug":Te("esri-2d-update-debug"),"featurelayer-pbf":Te("featurelayer-pbf"),"featurelayer-simplify-thresholds":Te("featurelayer-simplify-thresholds"),"featurelayer-simplify-payload-size-factors":Te("featurelayer-simplify-payload-size-factors"),"featurelayer-simplify-mobile-factor":Te("featurelayer-simplify-mobile-factor"),"esri-atomics":Te("esri-atomics"),"esri-shared-array-buffer":Te("esri-shared-array-buffer"),"esri-tiles-debug":Te("esri-tiles-debug"),"esri-workers-arraybuffer-transfer":Te("esri-workers-arraybuffer-transfer"),"feature-polyline-generalization-factor":Te("feature-polyline-generalization-factor"),"host-webworker":1,"polylabel-placement-enabled":Te("polylabel-placement-enabled")},e.workers.loaderUrl&&(e.workers.loaderUrl=Ra(e.workers.loaderUrl)),e.workers.workerPath?e.workers.workerPath=Ra(e.workers.workerPath):e.workers.workerPath=Ra(_i("esri/core/workers/RemoteClient.js")),e.workers.useDynamicImport=!1;const t=$i.workers.loaderConfig,i=q_e({baseUrl:t==null?void 0:t.baseUrl,locale:io(),has:K({"csp-restrictions":1,"dojo-test-sniff":0,"host-webworker":1},t==null?void 0:t.has),map:K({},t==null?void 0:t.map),paths:K({},t==null?void 0:t.paths),packages:(t==null?void 0:t.packages)||[]}),r={version:wB,buildDate:vB,revision:bB};return JSON.stringify({esriConfig:e,loaderConfig:i,kernelInfo:r})}let Y_e=0;const{ABORT:CU,INVOKE:X_e,OPEN:Q_e,OPENED:e2e,RESPONSE:M_}=Ss;class Sk{constructor(t,i){this._outJobs=new Map,this._inJobs=new Map,this.worker=t,this.id=i,t.addEventListener("message",this._onMessage.bind(this)),t.addEventListener("error",r=>{r.preventDefault(),$e.getLogger("esri.core.workers.WorkerOwner").error(r)})}static async create(t){const i=await Z_e();return new Sk(i,t)}terminate(){this.worker.terminate()}async open(t,i={}){const{signal:r}=i,n=gU();return new Promise((o,c)=>{const h={resolve:o,reject:c,abortHandle:hT(r,()=>{this._outJobs.delete(n),this._post({type:CU,jobId:n})})};this._outJobs.set(n,h),this._post({type:Q_e,jobId:n,modulePath:t})})}_onMessage(t){const i=x_(t);if(i)switch(i.type){case e2e:this._onOpenedMessage(i);break;case M_:this._onResponseMessage(i);break;case CU:this._onAbortMessage(i);break;case X_e:this._onInvokeMessage(i)}}_onAbortMessage(t){const i=this._inJobs,r=t.jobId,n=i.get(r);n&&(n.controller&&n.controller.abort(),i.delete(r))}_onInvokeMessage(t){const{methodName:i,jobId:r,data:n,abortable:o}=t,c=o?new AbortController:null,h=this._inJobs,m=Gbe[i];let b;try{if(typeof m!="function")throw new TypeError(`${i} is not a function`);b=m.call(null,n,{signal:c?c.signal:null})}catch(x){return void this._post({type:M_,jobId:r,error:__(x)})}yh(b)?(h.set(r,{controller:c,promise:b}),b.then(x=>{h.has(r)&&(h.delete(r),this._post({type:M_,jobId:r},x))},x=>{h.has(r)&&(h.delete(r),x||(x={message:"Error encountered at method"+i}),Xn(x)||this._post({type:M_,jobId:r,error:__(x||{message:`Error encountered at method ${i}`})}))})):this._post({type:M_,jobId:r},b)}_onOpenedMessage(t){const{jobId:i,data:r}=t,n=this._outJobs.get(i);n&&(this._outJobs.delete(i),mr(n.abortHandle),n.resolve(r))}_onResponseMessage(t){const{jobId:i,error:r,data:n}=t,o=this._outJobs.get(i);o&&(this._outJobs.delete(i),mr(o.abortHandle),r?o.reject(ue.fromJSON(JSON.parse(r))):o.resolve(n))}_post(t,i,r){return wk(this.worker,t,i,r)}}let X0=Te("esri-workers-debug")?1:Te("esri-mobile")?Math.min(navigator.hardwareConcurrency-1,3):Te("host-browser")?navigator.hardwareConcurrency-1:0;X0||(X0=Te("safari")&&Te("mac")||Te("trident")?7:2);let kU=0;const Z5=[];function t2e(){AU()}async function K5(e,t){const i=new N_e;return await i.open(e,t),i}async function i2e(e,t={}){if(typeof e!="string")throw new ue("workers:undefined-module","modulePath is missing");let i=t.strategy||"distributed";if(Te("host-webworker")&&!Te("esri-workers")&&(i="local"),i==="local"){let r=await na.loadWorker(e);r||(r=await import(e)),ur(t.signal);const n=t.client||r;return K5([na.connect(r)],Ce(K({},t),{client:n}))}if(await AU(),ur(t.signal),i==="dedicated"){const r=kU++%X0;return K5([await Z5[r].open(e,t)],t)}if(t.maxNumWorkers&&t.maxNumWorkers>0){const r=Math.min(t.maxNumWorkers,X0);if(r<X0){const n=new Array(r);for(let o=0;o<r;++o){const c=kU++%X0;n[o]=Z5[c].open(e,t)}return K5(n,t)}}return K5(Z5.map(r=>r.open(e,t)),t)}let Y5=null;async function AU(){if(Y5)return Y5;new AbortController;const e=[];for(let t=0;t<X0;t++){const i=Sk.create(t).then(r=>(Z5[t]=r,r));e.push(i)}return Y5=Promise.all(e),Y5}function Mk(e){return new Mt({wkt:`GEOCCS["Spherical geocentric",
    DATUM["Not specified",
      SPHEROID["Sphere",${e.radius},0]],
    PRIMEM["Greenwich",0.0,
      AUTHORITY["EPSG","8901"]],
    UNIT["m",1.0],
    AXIS["Geocentric X",OTHER],
    AXIS["Geocentric Y",EAST],
    AXIS["Geocentric Z",NORTH]
  ]`})}const PU=Mk(gr),X5=Mk(gh),Q5=Mk(ud),r2e=new Mt({wkt:`GEOCCS["WGS 84",
  DATUM["WGS_1984",
    SPHEROID["WGS 84",${gr.radius},298.257223563,
      AUTHORITY["EPSG","7030"]],
    AUTHORITY["EPSG","6326"]],
  PRIMEM["Greenwich",0,
    AUTHORITY["EPSG","8901"]],
  UNIT["m",1.0,
    AUTHORITY["EPSG","9001"]],
  AXIS["Geocentric X",OTHER],
  AXIS["Geocentric Y",OTHER],
  AXIS["Geocentric Z",NORTH],
  AUTHORITY["EPSG","4978"]
]`});function wJe(e){return e&&(ng(e)||e===X5)?X5:e&&(sg(e)||e===Q5)?Q5:PU}function Ik(e){return H(e)&&(ng(e)||e===X5)?gh:H(e)&&(sg(e)||e===Q5)?ud:gr}function _Je(e){return wT(e)?gh:_T(e)?ud:gr}const LU=39.37,n2e=gr.radius*Math.PI/200,OU=/UNIT\[([^\]]+)\]\]$/i,Q0=ne,RU=/UNIT\[([^\]]+)\]/i,s2e=new Set([4261,4305,4807,4810,4811,4812,4816,4819,4821,4901,4902,37225,104139,104140]),o2e=Ns()({meter:"meters",foot:"feet",foot_us:"us-feet",foot_clarke:"clarke-feet",yard_clarke:"clarke-yards",link_clarke:"clarke-links",yard_sears:"sears-yards",foot_sears:"sears-feet",chain_sears:"sears-chains",chain_benoit_1895_b:"benoit-1895-b-chains",yard_indian:"indian-yards",yard_indian_1937:"indian-1937-yards",foot_gold_coast:"gold-coast-feet",chain_sears_1922_truncated:"sears-1922-truncated-chains","50_kilometers":"50-kilometers","150_kilometers":"150-kilometers"}),gu=e=>e*e,jd=e=>e*e*e,I_={length:{baseUnit:"meters",units:{millimeters:{inBaseUnits:.001},centimeters:{inBaseUnits:.01},decimeters:{inBaseUnits:.1},meters:{inBaseUnits:1},kilometers:{inBaseUnits:1e3},inches:{inBaseUnits:.0254},feet:{inBaseUnits:.3048},yards:{inBaseUnits:.9144},miles:{inBaseUnits:1609.344},"nautical-miles":{inBaseUnits:1852},"us-feet":{inBaseUnits:1200/3937}}},area:{baseUnit:"square-meters",units:{"square-millimeters":{inBaseUnits:gu(.001)},"square-centimeters":{inBaseUnits:gu(.01)},"square-decimeters":{inBaseUnits:gu(.1)},"square-meters":{inBaseUnits:1},"square-kilometers":{inBaseUnits:gu(1e3)},"square-inches":{inBaseUnits:gu(.0254)},"square-feet":{inBaseUnits:gu(.3048)},"square-yards":{inBaseUnits:gu(.9144)},"square-miles":{inBaseUnits:gu(1609.344)},"square-us-feet":{inBaseUnits:gu(1200/3937)},acres:{inBaseUnits:.0015625*gu(1609.344)},ares:{inBaseUnits:100},hectares:{inBaseUnits:1e4}}},volume:{baseUnit:"liters",units:{liters:{inBaseUnits:1},"cubic-millimeters":{inBaseUnits:1e3*jd(.001)},"cubic-centimeters":{inBaseUnits:1e3*jd(.01)},"cubic-decimeters":{inBaseUnits:1e3*jd(.1)},"cubic-meters":{inBaseUnits:1e3},"cubic-kilometers":{inBaseUnits:1e3*jd(1e3)},"cubic-inches":{inBaseUnits:1e3*jd(.0254)},"cubic-feet":{inBaseUnits:1e3*jd(.3048)},"cubic-yards":{inBaseUnits:1e3*jd(.9144)},"cubic-miles":{inBaseUnits:1e3*jd(1609.344)}}},angle:{baseUnit:"radians",units:{radians:{inBaseUnits:1},degrees:{inBaseUnits:Math.PI/180}}}},a2e=(()=>{const e={};for(const t in I_)for(const i in I_[t].units)e[i]=t;return e})();function l2e(e,t,i){return e*I_[i].units[t].inBaseUnits}function c2e(e,t,i){return e/I_[i].units[t].inBaseUnits}const FU=["metric","imperial","inches","feet","yards","miles","nautical-miles","us-feet","meters","kilometers"],u2e=new Map([["meters","square-meters"],["feet","square-feet"],["us-feet","square-us-feet"]]);function $k(e){const t=a2e[e];if(!t)throw new Error("unknown type");return t}function NU(e,t=null){return t=t||$k(e),I_[t].baseUnit===e}function ji(e,t,i){if(t===i)return e;const r=$k(t);if(r!==$k(i))throw new Error("incompatible units");const n=NU(t,r)?e:l2e(e,t,r);return NU(i,r)?n:c2e(n,i,r)}function DU(e,t){const i=ji(e,t,"meters");return Math.abs(i)<3e3?"meters":"kilometers"}function jU(e,t){const i=ji(e,t,"meters");return Math.abs(i)<1e5?"meters":"kilometers"}function VU(e,t){const i=ji(e,t,"feet");return Math.abs(i)<1e3?"feet":"miles"}function zU(e,t){const i=ji(e,t,"feet");return Math.abs(i)<1e5?"feet":"miles"}function h2e(e,t){const i=ji(e,t,"square-meters");return Math.abs(i)<3e6?"square-meters":"square-kilometers"}function p2e(e,t){const i=ji(e,t,"square-feet");return Math.abs(i)<1e6?"square-feet":"square-miles"}function GU(e,t,i){return ji(e,t,"meters")/(i*Math.PI/180)}function BU(e){return o2e.fromJSON(e.toLowerCase())||null}function jg(e){if(H(e)&&!$me(e))return 1;const t=kh(e);return t>1e5?1:t}function UU(e){return kh(e)>=Ik(e).metersPerDegree?"meters":$_(e)}function kh(e,t=gr.metersPerDegree){return ws(d2e(e,!0),t)}function d2e(e,t=!1){const i=H(e)?e.wkid:null,r=H(e)?e.wkt:null;let n=null;if(i){if(wT(i))return gh.metersPerDegree;if(_T(i))return ud.metersPerDegree;n=Q0.values[Q0[i]],!n&&t&&s2e.has(i)&&(n=n2e)}else r&&(JU(r)?n=qU(OU.exec(r),n):WU(r)&&(n=qU(RU.exec(r),n)));return n}function qU(e,t){return e&&e[1]?HU(e[1]):t}function HU(e){return parseFloat(e.split(",")[1])}function $_(e){const t=H(e)?e.wkid:null,i=H(e)?e.wkt:null;let r=null;if(t)r=Q0.units[Q0[t]];else if(i){const n=JU(i)?OU:WU(i)?RU:null;if(n){const o=n.exec(i);o&&o[1]&&(r=y2e(o[1]))}}return H(r)?BU(r):null}function xJe(e){const t=$_(e);return ce(t)||!FU.includes(t)?null:t}function SJe(e){const t=UU(e);return ce(t)||!FU.includes(t)?null:t}function MJe(e){const t=$_(e);return ce(t)?null:u2e.get(t)}function WU(e){return/^GEOCCS/i.test(e)}function JU(e){return/^PROJCS/i.test(e)}const f2e=1e-7;function y2e(e){const t=/[\\"\\']{1}([^\\"\\']+)/.exec(e);let i=t&&t[1];if(!i||!Q0.units.includes(i)){const r=HU(e);i=null;const n=Q0.values;for(let o=0;o<n.length;++o)if(Math.abs(r-n[o])<f2e){i=Q0.units[o];break}}return i}function m2e(e){const t=$_(e);if(ce(t))return null;switch(t){case"feet":case"us-feet":case"clarke-feet":case"clarke-yards":case"clarke-links":case"sears-yards":case"sears-feet":case"sears-chains":case"benoit-1895-b-chains":case"indian-yards":case"indian-1937-yards":case"gold-coast-feet":case"sears-1922-truncated-chains":return"imperial";case"50-kilometers":case"150-kilometers":case"meters":return"metric"}return null}function IJe(e){var n,o,c;const t="metric";if(ce(e))return t;const i=e.map,r=i&&"portalItem"in i?(n=i.portalItem)==null?void 0:n.portal:null;if(r)switch((c=(o=r==null?void 0:r.user)==null?void 0:o.units)!=null?c:r.units){case t:return t;case"english":return"imperial"}return ws(m2e(e.spatialReference),t)}const ZU={esriAcres:"acres",esriAres:"ares",esriHectares:"hectares",esriSquareCentimeters:"square-centimeters",esriSquareDecimeters:"square-decimeters",esriSquareFeet:"square-feet",esriSquareInches:"square-inches",esriSquareKilometers:"square-kilometers",esriSquareMeters:"square-meters",esriSquareMiles:"square-miles",esriSquareMillimeters:"square-millimeters",esriSquareUsFeet:"square-us-feet",esriSquareYards:"square-yards"},KU={esriCentimeters:"centimeters",esriDecimeters:"decimeters",esriFeet:"feet",esriInches:"inches",esriKilometers:"kilometers",esriMeters:"meters",esriMiles:"miles",esriMillimeters:"millimeters",esriNauticalMiles:"nautical-miles",esriYards:"yards"},g2e=Ns()(ZU),v2e=Ns()(KU);Ns()(K(K({},ZU),KU));function b2e(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function Vd(e,t,i,r,n,o,c,h,m,b,x,I,E,k,P,F,N){return e[0]=t,e[1]=i,e[2]=r,e[3]=n,e[4]=o,e[5]=c,e[6]=h,e[7]=m,e[8]=b,e[9]=x,e[10]=I,e[11]=E,e[12]=k,e[13]=P,e[14]=F,e[15]=N,e}function e9(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function Ah(e,t){if(e===t){const i=t[1],r=t[2],n=t[3],o=t[6],c=t[7],h=t[11];e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=i,e[6]=t[9],e[7]=t[13],e[8]=r,e[9]=o,e[11]=t[14],e[12]=n,e[13]=c,e[14]=h}else e[0]=t[0],e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=t[1],e[5]=t[5],e[6]=t[9],e[7]=t[13],e[8]=t[2],e[9]=t[6],e[10]=t[10],e[11]=t[14],e[12]=t[3],e[13]=t[7],e[14]=t[11],e[15]=t[15];return e}function w2e(e,t){const i=t[0],r=t[1],n=t[2],o=t[3],c=t[4],h=t[5],m=t[6],b=t[7],x=t[8],I=t[9],E=t[10],k=t[11],P=t[12],F=t[13],N=t[14],B=t[15],z=i*h-r*c,q=i*m-n*c,J=i*b-o*c,X=r*m-n*h,Y=r*b-o*h,ae=n*b-o*m,he=x*F-I*P,fe=x*N-E*P,ye=x*B-k*P,xe=I*N-E*F,Se=I*B-k*F,Ae=E*B-k*N;let Oe=z*Ae-q*Se+J*xe+X*ye-Y*fe+ae*he;return Oe?(Oe=1/Oe,e[0]=(h*Ae-m*Se+b*xe)*Oe,e[1]=(n*Se-r*Ae-o*xe)*Oe,e[2]=(F*ae-N*Y+B*X)*Oe,e[3]=(E*Y-I*ae-k*X)*Oe,e[4]=(m*ye-c*Ae-b*fe)*Oe,e[5]=(i*Ae-n*ye+o*fe)*Oe,e[6]=(N*J-P*ae-B*q)*Oe,e[7]=(x*ae-E*J+k*q)*Oe,e[8]=(c*Se-h*ye+b*he)*Oe,e[9]=(r*ye-i*Se-o*he)*Oe,e[10]=(P*Y-F*J+B*z)*Oe,e[11]=(I*J-x*Y-k*z)*Oe,e[12]=(h*fe-c*xe-m*he)*Oe,e[13]=(i*xe-r*fe+n*he)*Oe,e[14]=(F*q-P*X-N*z)*Oe,e[15]=(x*X-I*q+E*z)*Oe,e):null}function _2e(e,t){const i=t[0],r=t[1],n=t[2],o=t[3],c=t[4],h=t[5],m=t[6],b=t[7],x=t[8],I=t[9],E=t[10],k=t[11],P=t[12],F=t[13],N=t[14],B=t[15];return e[0]=h*(E*B-k*N)-I*(m*B-b*N)+F*(m*k-b*E),e[1]=-(r*(E*B-k*N)-I*(n*B-o*N)+F*(n*k-o*E)),e[2]=r*(m*B-b*N)-h*(n*B-o*N)+F*(n*b-o*m),e[3]=-(r*(m*k-b*E)-h*(n*k-o*E)+I*(n*b-o*m)),e[4]=-(c*(E*B-k*N)-x*(m*B-b*N)+P*(m*k-b*E)),e[5]=i*(E*B-k*N)-x*(n*B-o*N)+P*(n*k-o*E),e[6]=-(i*(m*B-b*N)-c*(n*B-o*N)+P*(n*b-o*m)),e[7]=i*(m*k-b*E)-c*(n*k-o*E)+x*(n*b-o*m),e[8]=c*(I*B-k*F)-x*(h*B-b*F)+P*(h*k-b*I),e[9]=-(i*(I*B-k*F)-x*(r*B-o*F)+P*(r*k-o*I)),e[10]=i*(h*B-b*F)-c*(r*B-o*F)+P*(r*b-o*h),e[11]=-(i*(h*k-b*I)-c*(r*k-o*I)+x*(r*b-o*h)),e[12]=-(c*(I*N-E*F)-x*(h*N-m*F)+P*(h*E-m*I)),e[13]=i*(I*N-E*F)-x*(r*N-n*F)+P*(r*E-n*I),e[14]=-(i*(h*N-m*F)-c*(r*N-n*F)+P*(r*m-n*h)),e[15]=i*(h*E-m*I)-c*(r*E-n*I)+x*(r*m-n*h),e}function x2e(e){const t=e[0],i=e[1],r=e[2],n=e[3],o=e[4],c=e[5],h=e[6],m=e[7],b=e[8],x=e[9],I=e[10],E=e[11],k=e[12],P=e[13],F=e[14],N=e[15];return(t*c-i*o)*(I*N-E*F)-(t*h-r*o)*(x*N-E*P)+(t*m-n*o)*(x*F-I*P)+(i*h-r*c)*(b*N-E*k)-(i*m-n*c)*(b*F-I*k)+(r*m-n*h)*(b*P-x*k)}function YU(e,t,i){const r=t[0],n=t[1],o=t[2],c=t[3],h=t[4],m=t[5],b=t[6],x=t[7],I=t[8],E=t[9],k=t[10],P=t[11],F=t[12],N=t[13],B=t[14],z=t[15];let q=i[0],J=i[1],X=i[2],Y=i[3];return e[0]=q*r+J*h+X*I+Y*F,e[1]=q*n+J*m+X*E+Y*N,e[2]=q*o+J*b+X*k+Y*B,e[3]=q*c+J*x+X*P+Y*z,q=i[4],J=i[5],X=i[6],Y=i[7],e[4]=q*r+J*h+X*I+Y*F,e[5]=q*n+J*m+X*E+Y*N,e[6]=q*o+J*b+X*k+Y*B,e[7]=q*c+J*x+X*P+Y*z,q=i[8],J=i[9],X=i[10],Y=i[11],e[8]=q*r+J*h+X*I+Y*F,e[9]=q*n+J*m+X*E+Y*N,e[10]=q*o+J*b+X*k+Y*B,e[11]=q*c+J*x+X*P+Y*z,q=i[12],J=i[13],X=i[14],Y=i[15],e[12]=q*r+J*h+X*I+Y*F,e[13]=q*n+J*m+X*E+Y*N,e[14]=q*o+J*b+X*k+Y*B,e[15]=q*c+J*x+X*P+Y*z,e}function S2e(e,t,i){const r=i[0],n=i[1],o=i[2];if(t===e)e[12]=t[0]*r+t[4]*n+t[8]*o+t[12],e[13]=t[1]*r+t[5]*n+t[9]*o+t[13],e[14]=t[2]*r+t[6]*n+t[10]*o+t[14],e[15]=t[3]*r+t[7]*n+t[11]*o+t[15];else{const c=t[0],h=t[1],m=t[2],b=t[3],x=t[4],I=t[5],E=t[6],k=t[7],P=t[8],F=t[9],N=t[10],B=t[11];e[0]=c,e[1]=h,e[2]=m,e[3]=b,e[4]=x,e[5]=I,e[6]=E,e[7]=k,e[8]=P,e[9]=F,e[10]=N,e[11]=B,e[12]=c*r+x*n+P*o+t[12],e[13]=h*r+I*n+F*o+t[13],e[14]=m*r+E*n+N*o+t[14],e[15]=b*r+k*n+B*o+t[15]}return e}function M2e(e,t,i){const r=i[0],n=i[1],o=i[2];return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e[4]=t[4]*n,e[5]=t[5]*n,e[6]=t[6]*n,e[7]=t[7]*n,e[8]=t[8]*o,e[9]=t[9]*o,e[10]=t[10]*o,e[11]=t[11]*o,e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function I2e(e,t,i,r){let n,o,c,h,m,b,x,I,E,k,P,F,N,B,z,q,J,X,Y,ae,he,fe,ye,xe,Se=r[0],Ae=r[1],Oe=r[2],bt=Math.sqrt(Se*Se+Ae*Ae+Oe*Oe);return bt<Zo()?null:(bt=1/bt,Se*=bt,Ae*=bt,Oe*=bt,n=Math.sin(i),o=Math.cos(i),c=1-o,h=t[0],m=t[1],b=t[2],x=t[3],I=t[4],E=t[5],k=t[6],P=t[7],F=t[8],N=t[9],B=t[10],z=t[11],q=Se*Se*c+o,J=Ae*Se*c+Oe*n,X=Oe*Se*c-Ae*n,Y=Se*Ae*c-Oe*n,ae=Ae*Ae*c+o,he=Oe*Ae*c+Se*n,fe=Se*Oe*c+Ae*n,ye=Ae*Oe*c-Se*n,xe=Oe*Oe*c+o,e[0]=h*q+I*J+F*X,e[1]=m*q+E*J+N*X,e[2]=b*q+k*J+B*X,e[3]=x*q+P*J+z*X,e[4]=h*Y+I*ae+F*he,e[5]=m*Y+E*ae+N*he,e[6]=b*Y+k*ae+B*he,e[7]=x*Y+P*ae+z*he,e[8]=h*fe+I*ye+F*xe,e[9]=m*fe+E*ye+N*xe,e[10]=b*fe+k*ye+B*xe,e[11]=x*fe+P*ye+z*xe,t!==e&&(e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e)}function $2e(e,t,i){const r=Math.sin(i),n=Math.cos(i),o=t[4],c=t[5],h=t[6],m=t[7],b=t[8],x=t[9],I=t[10],E=t[11];return t!==e&&(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[4]=o*n+b*r,e[5]=c*n+x*r,e[6]=h*n+I*r,e[7]=m*n+E*r,e[8]=b*n-o*r,e[9]=x*n-c*r,e[10]=I*n-h*r,e[11]=E*n-m*r,e}function E2e(e,t,i){const r=Math.sin(i),n=Math.cos(i),o=t[0],c=t[1],h=t[2],m=t[3],b=t[8],x=t[9],I=t[10],E=t[11];return t!==e&&(e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=o*n-b*r,e[1]=c*n-x*r,e[2]=h*n-I*r,e[3]=m*n-E*r,e[8]=o*r+b*n,e[9]=c*r+x*n,e[10]=h*r+I*n,e[11]=m*r+E*n,e}function T2e(e,t,i){const r=Math.sin(i),n=Math.cos(i),o=t[0],c=t[1],h=t[2],m=t[3],b=t[4],x=t[5],I=t[6],E=t[7];return t!==e&&(e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=o*n+b*r,e[1]=c*n+x*r,e[2]=h*n+I*r,e[3]=m*n+E*r,e[4]=b*n-o*r,e[5]=x*n-c*r,e[6]=I*n-h*r,e[7]=E*n-m*r,e}function XU(e,t){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=t[0],e[13]=t[1],e[14]=t[2],e[15]=1,e}function C2e(e,t){return e[0]=t[0],e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=t[1],e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=t[2],e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function QU(e,t,i){if(t===0)return e9(e);let r,n,o,c=i[0],h=i[1],m=i[2],b=Math.sqrt(c*c+h*h+m*m);return b<Zo()?null:(b=1/b,c*=b,h*=b,m*=b,r=Math.sin(t),n=Math.cos(t),o=1-n,e[0]=c*c*o+n,e[1]=h*c*o+m*r,e[2]=m*c*o-h*r,e[3]=0,e[4]=c*h*o-m*r,e[5]=h*h*o+n,e[6]=m*h*o+c*r,e[7]=0,e[8]=c*m*o+h*r,e[9]=h*m*o-c*r,e[10]=m*m*o+n,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e)}function k2e(e,t){const i=Math.sin(t),r=Math.cos(t);return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=r,e[6]=i,e[7]=0,e[8]=0,e[9]=-i,e[10]=r,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function A2e(e,t){const i=Math.sin(t),r=Math.cos(t);return e[0]=r,e[1]=0,e[2]=-i,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=i,e[9]=0,e[10]=r,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function P2e(e,t){const i=Math.sin(t),r=Math.cos(t);return e[0]=r,e[1]=i,e[2]=0,e[3]=0,e[4]=-i,e[5]=r,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function eq(e,t,i){const r=t[0],n=t[1],o=t[2],c=t[3],h=r+r,m=n+n,b=o+o,x=r*h,I=r*m,E=r*b,k=n*m,P=n*b,F=o*b,N=c*h,B=c*m,z=c*b;return e[0]=1-(k+F),e[1]=I+z,e[2]=E-B,e[3]=0,e[4]=I-z,e[5]=1-(x+F),e[6]=P+N,e[7]=0,e[8]=E+B,e[9]=P-N,e[10]=1-(x+k),e[11]=0,e[12]=i[0],e[13]=i[1],e[14]=i[2],e[15]=1,e}function L2e(e,t){const i=O2e,r=-t[0],n=-t[1],o=-t[2],c=t[3],h=t[4],m=t[5],b=t[6],x=t[7],I=r*r+n*n+o*o+c*c;return I>0?(i[0]=2*(h*c+x*r+m*o-b*n)/I,i[1]=2*(m*c+x*n+b*r-h*o)/I,i[2]=2*(b*c+x*o+h*n-m*r)/I):(i[0]=2*(h*c+x*r+m*o-b*n),i[1]=2*(m*c+x*n+b*r-h*o),i[2]=2*(b*c+x*o+h*n-m*r)),eq(e,t,i),e}const O2e=it();function R2e(e,t){return e[0]=t[12],e[1]=t[13],e[2]=t[14],e}function F2e(e,t){const i=t[0],r=t[1],n=t[2],o=t[4],c=t[5],h=t[6],m=t[8],b=t[9],x=t[10];return e[0]=Math.sqrt(i*i+r*r+n*n),e[1]=Math.sqrt(o*o+c*c+h*h),e[2]=Math.sqrt(m*m+b*b+x*x),e}function N2e(e,t){const i=t[0]+t[5]+t[10];let r=0;return i>0?(r=2*Math.sqrt(i+1),e[3]=.25*r,e[0]=(t[6]-t[9])/r,e[1]=(t[8]-t[2])/r,e[2]=(t[1]-t[4])/r):t[0]>t[5]&&t[0]>t[10]?(r=2*Math.sqrt(1+t[0]-t[5]-t[10]),e[3]=(t[6]-t[9])/r,e[0]=.25*r,e[1]=(t[1]+t[4])/r,e[2]=(t[8]+t[2])/r):t[5]>t[10]?(r=2*Math.sqrt(1+t[5]-t[0]-t[10]),e[3]=(t[8]-t[2])/r,e[0]=(t[1]+t[4])/r,e[1]=.25*r,e[2]=(t[6]+t[9])/r):(r=2*Math.sqrt(1+t[10]-t[0]-t[5]),e[3]=(t[1]-t[4])/r,e[0]=(t[8]+t[2])/r,e[1]=(t[6]+t[9])/r,e[2]=.25*r),e}function D2e(e,t,i,r){const n=t[0],o=t[1],c=t[2],h=t[3],m=n+n,b=o+o,x=c+c,I=n*m,E=n*b,k=n*x,P=o*b,F=o*x,N=c*x,B=h*m,z=h*b,q=h*x,J=r[0],X=r[1],Y=r[2];return e[0]=(1-(P+N))*J,e[1]=(E+q)*J,e[2]=(k-z)*J,e[3]=0,e[4]=(E-q)*X,e[5]=(1-(I+N))*X,e[6]=(F+B)*X,e[7]=0,e[8]=(k+z)*Y,e[9]=(F-B)*Y,e[10]=(1-(I+P))*Y,e[11]=0,e[12]=i[0],e[13]=i[1],e[14]=i[2],e[15]=1,e}function j2e(e,t,i,r,n){const o=t[0],c=t[1],h=t[2],m=t[3],b=o+o,x=c+c,I=h+h,E=o*b,k=o*x,P=o*I,F=c*x,N=c*I,B=h*I,z=m*b,q=m*x,J=m*I,X=r[0],Y=r[1],ae=r[2],he=n[0],fe=n[1],ye=n[2],xe=(1-(F+B))*X,Se=(k+J)*X,Ae=(P-q)*X,Oe=(k-J)*Y,bt=(1-(E+B))*Y,st=(N+z)*Y,et=(P+q)*ae,He=(N-z)*ae,Et=(1-(E+F))*ae;return e[0]=xe,e[1]=Se,e[2]=Ae,e[3]=0,e[4]=Oe,e[5]=bt,e[6]=st,e[7]=0,e[8]=et,e[9]=He,e[10]=Et,e[11]=0,e[12]=i[0]+he-(xe*he+Oe*fe+et*ye),e[13]=i[1]+fe-(Se*he+bt*fe+He*ye),e[14]=i[2]+ye-(Ae*he+st*fe+Et*ye),e[15]=1,e}function V2e(e,t){const i=t[0],r=t[1],n=t[2],o=t[3],c=i+i,h=r+r,m=n+n,b=i*c,x=r*c,I=r*h,E=n*c,k=n*h,P=n*m,F=o*c,N=o*h,B=o*m;return e[0]=1-I-P,e[1]=x+B,e[2]=E-N,e[3]=0,e[4]=x-B,e[5]=1-b-P,e[6]=k+F,e[7]=0,e[8]=E+N,e[9]=k-F,e[10]=1-b-I,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function z2e(e,t,i,r,n,o,c){const h=1/(i-t),m=1/(n-r),b=1/(o-c);return e[0]=2*o*h,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=2*o*m,e[6]=0,e[7]=0,e[8]=(i+t)*h,e[9]=(n+r)*m,e[10]=(c+o)*b,e[11]=-1,e[12]=0,e[13]=0,e[14]=c*o*2*b,e[15]=0,e}function G2e(e,t,i,r,n){const o=1/Math.tan(t/2);let c;return e[0]=o/i,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=o,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=-1,e[12]=0,e[13]=0,e[15]=0,n!=null&&n!==1/0?(c=1/(r-n),e[10]=(n+r)*c,e[14]=2*n*r*c):(e[10]=-1,e[14]=-2*r),e}function B2e(e,t,i,r){const n=Math.tan(t.upDegrees*Math.PI/180),o=Math.tan(t.downDegrees*Math.PI/180),c=Math.tan(t.leftDegrees*Math.PI/180),h=Math.tan(t.rightDegrees*Math.PI/180),m=2/(c+h),b=2/(n+o);return e[0]=m,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=b,e[6]=0,e[7]=0,e[8]=-(c-h)*m*.5,e[9]=(n-o)*b*.5,e[10]=r/(i-r),e[11]=-1,e[12]=0,e[13]=0,e[14]=r*i/(i-r),e[15]=0,e}function U2e(e,t,i,r,n,o,c){const h=1/(t-i),m=1/(r-n),b=1/(o-c);return e[0]=-2*h,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*m,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=2*b,e[11]=0,e[12]=(t+i)*h,e[13]=(n+r)*m,e[14]=(c+o)*b,e[15]=1,e}function q2e(e,t,i,r){let n,o,c,h,m,b,x,I,E,k;const P=t[0],F=t[1],N=t[2],B=r[0],z=r[1],q=r[2],J=i[0],X=i[1],Y=i[2],ae=Zo();return Math.abs(P-J)<ae&&Math.abs(F-X)<ae&&Math.abs(N-Y)<ae?e9(e):(x=P-J,I=F-X,E=N-Y,k=1/Math.sqrt(x*x+I*I+E*E),x*=k,I*=k,E*=k,n=z*E-q*I,o=q*x-B*E,c=B*I-z*x,k=Math.sqrt(n*n+o*o+c*c),k?(k=1/k,n*=k,o*=k,c*=k):(n=0,o=0,c=0),h=I*c-E*o,m=E*n-x*c,b=x*o-I*n,k=Math.sqrt(h*h+m*m+b*b),k?(k=1/k,h*=k,m*=k,b*=k):(h=0,m=0,b=0),e[0]=n,e[1]=h,e[2]=x,e[3]=0,e[4]=o,e[5]=m,e[6]=I,e[7]=0,e[8]=c,e[9]=b,e[10]=E,e[11]=0,e[12]=-(n*P+o*F+c*N),e[13]=-(h*P+m*F+b*N),e[14]=-(x*P+I*F+E*N),e[15]=1,e)}function H2e(e,t,i,r){const n=t[0],o=t[1],c=t[2],h=r[0],m=r[1],b=r[2];let x=n-i[0],I=o-i[1],E=c-i[2],k=x*x+I*I+E*E;k>0&&(k=1/Math.sqrt(k),x*=k,I*=k,E*=k);let P=m*E-b*I,F=b*x-h*E,N=h*I-m*x;return k=P*P+F*F+N*N,k>0&&(k=1/Math.sqrt(k),P*=k,F*=k,N*=k),e[0]=P,e[1]=F,e[2]=N,e[3]=0,e[4]=I*N-E*F,e[5]=E*P-x*N,e[6]=x*F-I*P,e[7]=0,e[8]=x,e[9]=I,e[10]=E,e[11]=0,e[12]=n,e[13]=o,e[14]=c,e[15]=1,e}function W2e(e){return"mat4("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+", "+e[8]+", "+e[9]+", "+e[10]+", "+e[11]+", "+e[12]+", "+e[13]+", "+e[14]+", "+e[15]+")"}function J2e(e){return Math.sqrt(e[0]**2+e[1]**2+e[2]**2+e[3]**2+e[4]**2+e[5]**2+e[6]**2+e[7]**2+e[8]**2+e[9]**2+e[10]**2+e[11]**2+e[12]**2+e[13]**2+e[14]**2+e[15]**2)}function Z2e(e,t,i){return e[0]=t[0]+i[0],e[1]=t[1]+i[1],e[2]=t[2]+i[2],e[3]=t[3]+i[3],e[4]=t[4]+i[4],e[5]=t[5]+i[5],e[6]=t[6]+i[6],e[7]=t[7]+i[7],e[8]=t[8]+i[8],e[9]=t[9]+i[9],e[10]=t[10]+i[10],e[11]=t[11]+i[11],e[12]=t[12]+i[12],e[13]=t[13]+i[13],e[14]=t[14]+i[14],e[15]=t[15]+i[15],e}function tq(e,t,i){return e[0]=t[0]-i[0],e[1]=t[1]-i[1],e[2]=t[2]-i[2],e[3]=t[3]-i[3],e[4]=t[4]-i[4],e[5]=t[5]-i[5],e[6]=t[6]-i[6],e[7]=t[7]-i[7],e[8]=t[8]-i[8],e[9]=t[9]-i[9],e[10]=t[10]-i[10],e[11]=t[11]-i[11],e[12]=t[12]-i[12],e[13]=t[13]-i[13],e[14]=t[14]-i[14],e[15]=t[15]-i[15],e}function K2e(e,t,i){return e[0]=t[0]*i,e[1]=t[1]*i,e[2]=t[2]*i,e[3]=t[3]*i,e[4]=t[4]*i,e[5]=t[5]*i,e[6]=t[6]*i,e[7]=t[7]*i,e[8]=t[8]*i,e[9]=t[9]*i,e[10]=t[10]*i,e[11]=t[11]*i,e[12]=t[12]*i,e[13]=t[13]*i,e[14]=t[14]*i,e[15]=t[15]*i,e}function Y2e(e,t,i,r){return e[0]=t[0]+i[0]*r,e[1]=t[1]+i[1]*r,e[2]=t[2]+i[2]*r,e[3]=t[3]+i[3]*r,e[4]=t[4]+i[4]*r,e[5]=t[5]+i[5]*r,e[6]=t[6]+i[6]*r,e[7]=t[7]+i[7]*r,e[8]=t[8]+i[8]*r,e[9]=t[9]+i[9]*r,e[10]=t[10]+i[10]*r,e[11]=t[11]+i[11]*r,e[12]=t[12]+i[12]*r,e[13]=t[13]+i[13]*r,e[14]=t[14]+i[14]*r,e[15]=t[15]+i[15]*r,e}function X2e(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]&&e[4]===t[4]&&e[5]===t[5]&&e[6]===t[6]&&e[7]===t[7]&&e[8]===t[8]&&e[9]===t[9]&&e[10]===t[10]&&e[11]===t[11]&&e[12]===t[12]&&e[13]===t[13]&&e[14]===t[14]&&e[15]===t[15]}function Q2e(e,t){if(e===t)return!0;const i=e[0],r=e[1],n=e[2],o=e[3],c=e[4],h=e[5],m=e[6],b=e[7],x=e[8],I=e[9],E=e[10],k=e[11],P=e[12],F=e[13],N=e[14],B=e[15],z=t[0],q=t[1],J=t[2],X=t[3],Y=t[4],ae=t[5],he=t[6],fe=t[7],ye=t[8],xe=t[9],Se=t[10],Ae=t[11],Oe=t[12],bt=t[13],st=t[14],et=t[15],He=Zo();return Math.abs(i-z)<=He*Math.max(1,Math.abs(i),Math.abs(z))&&Math.abs(r-q)<=He*Math.max(1,Math.abs(r),Math.abs(q))&&Math.abs(n-J)<=He*Math.max(1,Math.abs(n),Math.abs(J))&&Math.abs(o-X)<=He*Math.max(1,Math.abs(o),Math.abs(X))&&Math.abs(c-Y)<=He*Math.max(1,Math.abs(c),Math.abs(Y))&&Math.abs(h-ae)<=He*Math.max(1,Math.abs(h),Math.abs(ae))&&Math.abs(m-he)<=He*Math.max(1,Math.abs(m),Math.abs(he))&&Math.abs(b-fe)<=He*Math.max(1,Math.abs(b),Math.abs(fe))&&Math.abs(x-ye)<=He*Math.max(1,Math.abs(x),Math.abs(ye))&&Math.abs(I-xe)<=He*Math.max(1,Math.abs(I),Math.abs(xe))&&Math.abs(E-Se)<=He*Math.max(1,Math.abs(E),Math.abs(Se))&&Math.abs(k-Ae)<=He*Math.max(1,Math.abs(k),Math.abs(Ae))&&Math.abs(P-Oe)<=He*Math.max(1,Math.abs(P),Math.abs(Oe))&&Math.abs(F-bt)<=He*Math.max(1,Math.abs(F),Math.abs(bt))&&Math.abs(N-st)<=He*Math.max(1,Math.abs(N),Math.abs(st))&&Math.abs(B-et)<=He*Math.max(1,Math.abs(B),Math.abs(et))}function e3e(e){const t=Zo(),i=e[0],r=e[1],n=e[2],o=e[4],c=e[5],h=e[6],m=e[8],b=e[9],x=e[10];return Math.abs(1-(i*i+o*o+m*m))<=t&&Math.abs(1-(r*r+c*c+b*b))<=t&&Math.abs(1-(n*n+h*h+x*x))<=t}const t3e=YU,i3e=tq;Object.freeze(Object.defineProperty({__proto__:null,copy:b2e,set:Vd,identity:e9,transpose:Ah,invert:w2e,adjoint:_2e,determinant:x2e,multiply:YU,translate:S2e,scale:M2e,rotate:I2e,rotateX:$2e,rotateY:E2e,rotateZ:T2e,fromTranslation:XU,fromScaling:C2e,fromRotation:QU,fromXRotation:k2e,fromYRotation:A2e,fromZRotation:P2e,fromRotationTranslation:eq,fromQuat2:L2e,getTranslation:R2e,getScaling:F2e,getRotation:N2e,fromRotationTranslationScale:D2e,fromRotationTranslationScaleOrigin:j2e,fromQuat:V2e,frustum:z2e,perspective:G2e,perspectiveFromFieldOfView:B2e,ortho:U2e,lookAt:q2e,targetTo:H2e,str:W2e,frob:J2e,add:Z2e,subtract:tq,multiplyScalar:K2e,multiplyScalarAndAdd:Y2e,exactEquals:X2e,equals:Q2e,isOrthoNormal:e3e,mul:t3e,sub:i3e},Symbol.toStringTag,{value:"Module"}));let Ek,Me=null;function iq(){return!!Me}function r3e(){return!!Te("esri-wasm")}function rq(){return Ek||(Ek=import("./pe-wasm.031781a0.js").then(e=>e.p).then(({default:e})=>e({locateFile:t=>_i(`esri/geometry/support/${t}`)})).then(e=>{sq(e)}),Ek)}var Tk,Er,E_;(function(e){function t(o,c,h){Me.ensureCache.prepare();const m=ty(h),b=h===m,x=Me.ensureFloat64(m),I=Me._pe_geog_to_proj(Me.getPointer(o),c,x);return I&&zd(h,c,x,b),I}function i(o,c,h,m){switch(m){case Er.PE_TRANSFORM_P_TO_G:return r(o,c,h);case Er.PE_TRANSFORM_G_TO_P:return t(o,c,h)}return 0}function r(o,c,h){return n(o,c,h,0)}function n(o,c,h,m){Me.ensureCache.prepare();const b=ty(h),x=h===b,I=Me.ensureFloat64(b),E=Me._pe_proj_to_geog_center(Me.getPointer(o),c,I,m);return E&&zd(h,c,I,x),E}e.geogToProj=t,e.projGeog=i,e.projToGeog=r,e.projToGeogCenter=n})(Tk||(Tk={})),function(e){function t(){e.PE_BUFFER_MAX=Me.PeDefs.prototype.PE_BUFFER_MAX,e.PE_NAME_MAX=Me.PeDefs.prototype.PE_NAME_MAX,e.PE_MGRS_MAX=Me.PeDefs.prototype.PE_MGRS_MAX,e.PE_USNG_MAX=Me.PeDefs.prototype.PE_USNG_MAX,e.PE_DD_MAX=Me.PeDefs.prototype.PE_DD_MAX,e.PE_DDM_MAX=Me.PeDefs.prototype.PE_DDM_MAX,e.PE_DMS_MAX=Me.PeDefs.prototype.PE_DMS_MAX,e.PE_UTM_MAX=Me.PeDefs.prototype.PE_UTM_MAX,e.PE_PARM_MAX=Me.PeDefs.prototype.PE_PARM_MAX,e.PE_TYPE_NONE=Me.PeDefs.prototype.PE_TYPE_NONE,e.PE_TYPE_GEOGCS=Me.PeDefs.prototype.PE_TYPE_GEOGCS,e.PE_TYPE_PROJCS=Me.PeDefs.prototype.PE_TYPE_PROJCS,e.PE_TYPE_GEOGTRAN=Me.PeDefs.prototype.PE_TYPE_GEOGTRAN,e.PE_TYPE_COORDSYS=Me.PeDefs.prototype.PE_TYPE_COORDSYS,e.PE_TYPE_UNIT=Me.PeDefs.prototype.PE_TYPE_UNIT,e.PE_TYPE_LINUNIT=Me.PeDefs.prototype.PE_TYPE_LINUNIT,e.PE_STR_OPTS_NONE=Me.PeDefs.prototype.PE_STR_OPTS_NONE,e.PE_STR_AUTH_NONE=Me.PeDefs.prototype.PE_STR_AUTH_NONE,e.PE_STR_AUTH_TOP=Me.PeDefs.prototype.PE_STR_AUTH_TOP,e.PE_STR_NAME_CANON=Me.PeDefs.prototype.PE_STR_NAME_CANON,e.PE_PARM_X0=Me.PeDefs.prototype.PE_PARM_X0,e.PE_PARM_ND=Me.PeDefs.prototype.PE_PARM_ND,e.PE_TRANSFORM_1_TO_2=Me.PeDefs.prototype.PE_TRANSFORM_1_TO_2,e.PE_TRANSFORM_2_TO_1=Me.PeDefs.prototype.PE_TRANSFORM_2_TO_1,e.PE_TRANSFORM_P_TO_G=Me.PeDefs.prototype.PE_TRANSFORM_P_TO_G,e.PE_TRANSFORM_G_TO_P=Me.PeDefs.prototype.PE_TRANSFORM_G_TO_P,e.PE_HORIZON_RECT=Me.PeDefs.prototype.PE_HORIZON_RECT,e.PE_HORIZON_POLY=Me.PeDefs.prototype.PE_HORIZON_POLY,e.PE_HORIZON_LINE=Me.PeDefs.prototype.PE_HORIZON_LINE,e.PE_HORIZON_DELTA=Me.PeDefs.prototype.PE_HORIZON_DELTA}e.init=t}(Er||(Er={})),function(e){const t={},i={},r=k=>{if(k){const P=k.getType();switch(P){case Er.PE_TYPE_GEOGCS:k=Me.castObject(k,Me.PeGeogcs);break;case Er.PE_TYPE_PROJCS:k=Me.castObject(k,Me.PeProjcs);break;case Er.PE_TYPE_GEOGTRAN:k=Me.castObject(k,Me.PeGeogtran);break;default:P&Er.PE_TYPE_UNIT&&(k=Me.castObject(k,Me.PeUnit))}}return k};function n(){Me.PeFactory.prototype.initialize(null)}function o(k){return c(Er.PE_TYPE_COORDSYS,k)}function c(k,P){let F=null,N=t[k];if(N||(N={},t[k]=N),N.hasOwnProperty(String(P)))F=N[P];else{const B=Me.PeFactory.prototype.factoryByType(k,P);Me.compare(B,Me.NULL)||(F=B,N[P]=F)}return F=r(F),F}function h(k,P){let F=null,N=i[k];if(N||(N={},i[k]=N),N.hasOwnProperty(P))F=N[P];else{const B=Me.PeFactory.prototype.fromString(k,P);Me.compare(B,Me.NULL)||(F=B,N[P]=F)}return F=r(F),F}function m(k){return c(Er.PE_TYPE_GEOGCS,k)}function b(k){return c(Er.PE_TYPE_GEOGTRAN,k)}function x(k){return Me.PeFactory.prototype.getCode(k)}function I(k){return c(Er.PE_TYPE_PROJCS,k)}function E(k){return c(Er.PE_TYPE_UNIT,k)}e.initialize=n,e.coordsys=o,e.factoryByType=c,e.fromString=h,e.geogcs=m,e.geogtran=b,e.getCode=x,e.projcs=I,e.unit=E}(E_||(E_={}));let nq=null;var t9,Ck,kk,ey,sa,T_,Ph,i9,Ak;function sq(e){function t(o,c,h){o[c]=h(o[c])}Me=e,Er.init(),t9.init(),sa.init(),Ph.init(),i9.init(),nq=class extends Me.PeGCSExtent{destroy(){Me.destroy(this)}};const i=[Me.PeDatum,Me.PeGeogcs,Me.PeGeogtran,Me.PeObject,Me.PeParameter,Me.PePrimem,Me.PeProjcs,Me.PeSpheroid,Me.PeUnit];for(const o of i)t(o.prototype,"getName",c=>function(){return c.call(this,new Array(Er.PE_NAME_MAX))});for(const o of[Me.PeGeogtran,Me.PeProjcs])t(o.prototype,"getParameters",c=>function(){const h=new Array(Er.PE_PARM_MAX);let m=c.call(this);for(let b=0;b<h.length;b++){const x=Me.getValue(m,"*");h[b]=x?Me.wrapPointer(x,Me.PeParameter):null,m+=Int32Array.BYTES_PER_ELEMENT}return h});t(Me.PeHorizon.prototype,"getCoord",o=>function(){const c=this.getSize();if(!c)return null;const h=[];return zd(h,c,o.call(this)),h}),t(Me.PeGTlistExtendedEntry.prototype,"getEntries",o=>{const c=Me._pe_getPeGTlistExtendedGTsSize();return function(){let h=null;const m=o.call(this);if(!Me.compare(m,Me.NULL)){h=[m];const b=this.getSteps();if(b>1){const x=Me.getPointer(m);for(let I=1;I<b;I++)h.push(Me.wrapPointer(x+c*I,Me.PeGTlistExtendedGTs))}}return h}});const r=Me._pe_getPeHorizonSize(),n=o=>function(){let c=this._cache;if(c||(c=new Map,this._cache=c),c.has(o))return c.get(o);let h=null;const m=o.call(this);if(!Me.compare(m,Me.NULL)){h=[m];const b=m.getNump();if(b>1){const x=Me.getPointer(m);for(let I=1;I<b;I++)h.push(Me.wrapPointer(x+r*I,Me.PeHorizon))}}return c.set(o,h),h};t(Me.PeProjcs.prototype,"horizonGcsGenerate",n),t(Me.PeProjcs.prototype,"horizonPcsGenerate",n),Me.PeObject.prototype.toString=function(o=Er.PE_STR_OPTS_NONE){Me.ensureCache.prepare();const c=Me.getPointer(this),h=Me.ensureInt8(new Array(Er.PE_BUFFER_MAX));return Me.UTF8ToString(Me._pe_object_to_string_ext(c,o,h))}}function Lh(e){if(!e)return;const t=Me.getClass(e);if(!t)return;const i=Me.getCache(t);if(!i)return;const r=Me.getPointer(e);r&&delete i[r]}function r9(e,t){const i=[],r=new Array(t);for(let n=0;n<e;n++)i.push(Me.ensureInt8(r));return i}function ty(e){let t;return Array.isArray(e[0])?(t=[],e.forEach(i=>{t.push(i[0],i[1])})):t=e,t}function zd(e,t,i,r=!1){if(r)for(let n=0;n<2*t;n++)e[n]=Me.getValue(i+n*Float64Array.BYTES_PER_ELEMENT,"double");else{const n=e.length===0;for(let o=0;o<t;o++)n&&(e[o]=new Array(2)),e[o][0]=Me.getValue(i,"double"),e[o][1]=Me.getValue(i+Float64Array.BYTES_PER_ELEMENT,"double"),i+=2*Float64Array.BYTES_PER_ELEMENT}}(function(e){let t;function i(){e.PE_GTLIST_OPTS_COMMON=Me.PeGTlistExtended.prototype.PE_GTLIST_OPTS_COMMON,t=Me._pe_getPeGTlistExtendedEntrySize()}function r(n,o,c,h,m,b){let x=null;const I=new Me.PeInteger(b);try{const E=Me.PeGTlistExtended.prototype.getGTlist(n,o,c,h,m,I);if((b=I.val)&&(x=[E],b>1)){const k=Me.getPointer(E);for(let P=1;P<b;P++)x.push(Me.wrapPointer(k+t*P,Me.PeGTlistExtendedEntry))}}finally{Me.destroy(I)}return x}e.init=i,e.getGTlist=r})(t9||(t9={})),function(e){function t(i){if(i&&i.length){for(const r of i)Lh(r),r.getEntries().forEach(n=>{Lh(n);const o=n.getGeogtran();Lh(o),o.getParameters().forEach(Lh),[o.getGeogcs1(),o.getGeogcs2()].forEach(c=>{Lh(c);const h=c.getDatum();Lh(h),Lh(h.getSpheroid()),Lh(c.getPrimem()),Lh(c.getUnit())})});Me.PeGTlistExtendedEntry.prototype.Delete(i[0])}}e.destroy=t}(Ck||(Ck={})),function(e){function t(i,r,n,o,c){Me.ensureCache.prepare();const h=ty(n),m=n===h,b=Me.ensureFloat64(h);let x=0;o&&(x=Me.ensureFloat64(o));const I=Me._pe_geog_to_geog(Me.getPointer(i),r,b,x,c);return I&&zd(n,r,b,m),I}e.geogToGeog=t}(kk||(kk={})),function(e){const t=(b,x,I,E,k,P)=>{let F,N;switch(Me.ensureCache.prepare(),b){case"dd":F=Me._pe_geog_to_dd,N=Er.PE_DD_MAX;break;case"ddm":F=Me._pe_geog_to_ddm,N=Er.PE_DDM_MAX;break;case"dms":F=Me._pe_geog_to_dms,N=Er.PE_DMS_MAX}let B=0;x&&(B=Me.getPointer(x));const z=ty(E),q=Me.ensureFloat64(z),J=r9(I,N),X=F(B,I,q,k,Me.ensureInt32(J));if(X)for(let Y=0;Y<I;Y++)P[Y]=Me.UTF8ToString(J[Y]);return X},i=(b,x,I,E,k)=>{let P;switch(Me.ensureCache.prepare(),b){case"dd":P=Me._pe_dd_to_geog;break;case"ddm":P=Me._pe_ddm_to_geog;break;case"dms":P=Me._pe_dms_to_geog}let F=0;x&&(F=Me.getPointer(x));const N=E.map(J=>Me.ensureString(J)),B=Me.ensureInt32(N),z=Me.ensureFloat64(new Array(2*I)),q=P(F,I,B,z);return q&&zd(k,I,z),q};function r(b,x,I,E,k){return t("dms",b,x,I,E,k)}function n(b,x,I,E){return i("dms",b,x,I,E)}function o(b,x,I,E,k){return t("ddm",b,x,I,E,k)}function c(b,x,I,E){return i("ddm",b,x,I,E)}function h(b,x,I,E,k){return t("dd",b,x,I,E,k)}function m(b,x,I,E){return i("dd",b,x,I,E)}e.geogToDms=r,e.dmsToGeog=n,e.geogToDdm=o,e.ddmToGeog=c,e.geogToDd=h,e.ddToGeog=m}(ey||(ey={})),function(e){function t(){e.PE_MGRS_STYLE_NEW=Me.PeNotationMgrs.prototype.PE_MGRS_STYLE_NEW,e.PE_MGRS_STYLE_OLD=Me.PeNotationMgrs.prototype.PE_MGRS_STYLE_OLD,e.PE_MGRS_STYLE_AUTO=Me.PeNotationMgrs.prototype.PE_MGRS_STYLE_AUTO,e.PE_MGRS_180_ZONE_1_PLUS=Me.PeNotationMgrs.prototype.PE_MGRS_180_ZONE_1_PLUS,e.PE_MGRS_ADD_SPACES=Me.PeNotationMgrs.prototype.PE_MGRS_ADD_SPACES}function i(n,o,c,h,m,b,x){Me.ensureCache.prepare();let I=0;n&&(I=Me.getPointer(n));const E=ty(c),k=Me.ensureFloat64(E),P=r9(o,Er.PE_MGRS_MAX),F=Me.ensureInt32(P),N=Me._pe_geog_to_mgrs_extended(I,o,k,h,m,b,F);if(N)for(let B=0;B<o;B++)x[B]=Me.UTF8ToString(P[B]);return N}function r(n,o,c,h,m){Me.ensureCache.prepare();let b=0;n&&(b=Me.getPointer(n));const x=c.map(P=>Me.ensureString(P)),I=Me.ensureInt32(x),E=Me.ensureFloat64(new Array(2*o)),k=Me._pe_mgrs_to_geog_extended(b,o,I,h,E);return k&&zd(m,o,E),k}e.init=t,e.geogToMgrsExtended=i,e.mgrsToGeogExtended=r}(sa||(sa={})),function(e){function t(r,n,o,c,h,m,b){Me.ensureCache.prepare();let x=0;r&&(x=Me.getPointer(r));const I=ty(o),E=Me.ensureFloat64(I),k=r9(n,Er.PE_MGRS_MAX),P=Me.ensureInt32(k),F=Me._pe_geog_to_usng(x,n,E,c,h,m,P);if(F)for(let N=0;N<n;N++)b[N]=Me.UTF8ToString(k[N]);return F}function i(r,n,o,c){Me.ensureCache.prepare();let h=0;r&&(h=Me.getPointer(r));const m=o.map(E=>Me.ensureString(E)),b=Me.ensureInt32(m),x=Me.ensureFloat64(new Array(2*n)),I=Me._pe_usng_to_geog(h,n,b,x);return I&&zd(c,n,x),I}e.geogToUsng=t,e.usngToGeog=i}(T_||(T_={})),function(e){function t(){e.PE_UTM_OPTS_NONE=Me.PeNotationUtm.prototype.PE_UTM_OPTS_NONE,e.PE_UTM_OPTS_ADD_SPACES=Me.PeNotationUtm.prototype.PE_UTM_OPTS_ADD_SPACES,e.PE_UTM_OPTS_NS=Me.PeNotationUtm.prototype.PE_UTM_OPTS_NS}function i(n,o,c,h,m){Me.ensureCache.prepare();let b=0;n&&(b=Me.getPointer(n));const x=ty(c),I=Me.ensureFloat64(x),E=r9(o,Er.PE_UTM_MAX),k=Me.ensureInt32(E),P=Me._pe_geog_to_utm(b,o,I,h,k);if(P)for(let F=0;F<o;F++)m[F]=Me.UTF8ToString(E[F]);return P}function r(n,o,c,h,m){Me.ensureCache.prepare();let b=0;n&&(b=Me.getPointer(n));const x=c.map(P=>Me.ensureString(P)),I=Me.ensureInt32(x),E=Me.ensureFloat64(new Array(2*o)),k=Me._pe_utm_to_geog(b,o,I,h,E);return k&&zd(m,o,E),k}e.init=t,e.geogToUtm=i,e.utmToGeog=r}(Ph||(Ph={})),function(e){const t=new Map;function i(){e.PE_PCSINFO_OPTION_NONE=Me.PePCSInfo.prototype.PE_PCSINFO_OPTION_NONE,e.PE_PCSINFO_OPTION_DOMAIN=Me.PePCSInfo.prototype.PE_PCSINFO_OPTION_DOMAIN,e.PE_POLE_OUTSIDE_BOUNDARY=Me.PePCSInfo.prototype.PE_POLE_OUTSIDE_BOUNDARY,e.PE_POLE_POINT=Me.PePCSInfo.prototype.PE_POLE_POINT}function r(n,o=e.PE_PCSINFO_OPTION_DOMAIN){let c=null,h=null;return t.has(n)&&(h=t.get(n),h[o]&&(c=h[o])),c||(c=Me.PePCSInfo.prototype.generate(n,o),h||(h=[],t.set(n,h)),h[o]=c),c}e.init=i,e.generate=r}(i9||(i9={})),function(e){function t(){return Me.PeVersion.prototype.version_string()}e.versionString=t}(Ak||(Ak={}));const n3e=Object.freeze(Object.defineProperty({__proto__:null,get _pe(){return Me},isLoaded:iq,isSupported:r3e,load:rq,get PeCSTransformations(){return Tk},get PeDefs(){return Er},get PeFactory(){return E_},get PeGCSExtent(){return nq},get PeGTlistExtended(){return t9},get PeGTlistExtendedEntry(){return Ck},get PeGTTransformations(){return kk},get PeNotationDms(){return ey},get PeNotationMgrs(){return sa},get PeNotationUsng(){return T_},get PeNotationUtm(){return Ph},get PePCSInfo(){return i9},get PeVersion(){return Ak},_init:sq},Symbol.toStringTag,{value:"Module"})),oa=Math.PI/180,s3e=/SPHEROID\[([^\]]+)]/i,Gd=gr.radius,hc=gr.eccentricitySquared,o3e={a1:Gd*hc,a2:Gd*hc*Gd*hc,a3:Gd*hc*hc/2,a4:Gd*hc*Gd*hc*2.5,a5:Gd*hc+Gd*hc*hc/2,a6:1-hc},a3e={4267:{a:63782064e-1,f:1/294.9786982},4269:{a:6378137,f:1/298.257222101},4326:{a:gr.radius,f:gr.flattening},104900:{a:2439700,f:0},104901:{a:6051e3,f:0},104902:{a:6051800,f:0},104903:{a:ud.radius,f:ud.flattening},104904:{a:3393400,f:1/192.0430107526882},104905:{a:gh.radius,f:gh.flattening},104906:{a:6200,f:0},104907:{a:11100,f:0},104908:{a:71492e3,f:.06487439154031222},104909:{a:8200,f:0},104910:{a:83500,f:0},104911:{a:1e4,f:0},104912:{a:2409300,f:0},104913:{a:15e3,f:0},104914:{a:4e4,f:0},104915:{a:1562090,f:0},104916:{a:2632345,f:0},104917:{a:85e3,f:0},104918:{a:1821460,f:0},104919:{a:5e3,f:0},104920:{a:12e3,f:0},104921:{a:3e4,f:3},104922:{a:18e3,f:0},104923:{a:14e3,f:0},104924:{a:49300,f:0},104925:{a:60268e3,f:1/10.2079945799458},104926:{a:16e3,f:0},104927:{a:9500,f:0},104928:{a:56e4,f:0},104929:{a:249400,f:0},104930:{a:59500,f:0},104931:{a:16e3,f:0},104932:{a:133e3,f:0},104933:{a:718e3,f:0},104934:{a:888e3,f:0},104935:{a:1986300,f:0},104936:{a:1e4,f:0},104937:{a:41900,f:0},104938:{a:11e4,f:0},104939:{a:50100,f:0},104940:{a:764e3,f:0},104941:{a:11e3,f:0},104942:{a:529800,f:0},104943:{a:2575e3,f:0},104944:{a:25559e3,f:1/43.61604095563141},104945:{a:578900,f:0},104946:{a:33e3,f:0},104947:{a:21e3,f:0},104948:{a:13e3,f:0},104949:{a:31e3,f:0},104950:{a:27e3,f:0},104951:{a:42e3,f:0},104952:{a:235800,f:0},104953:{a:761400,f:0},104954:{a:15e3,f:0},104955:{a:54e3,f:0},104956:{a:77e3,f:0},104957:{a:27e3,f:0},104958:{a:788900,f:0},104959:{a:584700,f:0},104960:{a:24764e3,f:.01708124697141011},104961:{a:74e3,f:0},104962:{a:79e3,f:0},104963:{a:104e3,f:.14423076923076922},104964:{a:29e3,f:0},104965:{a:17e4,f:0},104966:{a:208e3,f:0},104967:{a:4e4,f:0},104968:{a:1352600,f:0},104969:{a:1195e3,f:0},104970:{a:593e3,f:0},104971:{a:gh.radius,f:0},104972:{a:47e4,f:0},104973:{a:255e3,f:0},104974:{a:2439400,f:0}};let n9=0;class Vg{constructor(t){this.uid=n9++,t?(this._wkt=t.wkt!=null?t.wkt:null,this._wkid=t.wkid!=null?t.wkid:-1,this._isInverse=t.isInverse!=null&&t.isInverse===!0):(this._wkt=null,this._wkid=-1,this._isInverse=!1)}static fromGE(t){const i=new Vg;return i._wkt=t.wkt,i._wkid=t.wkid,i._isInverse=t.isInverse,i}get wkt(){return this._wkt}set wkt(t){this._wkt=t,this.uid=n9++}get wkid(){return this._wkid}set wkid(t){this._wkid=t,this.uid=n9++}get isInverse(){return this._isInverse}set isInverse(t){this._isInverse=t,this.uid=n9++}getInverse(){const t=new Vg;return t._wkt=this.wkt,t._wkid=this._wkid,t._isInverse=!this.isInverse,t}}class Bd{constructor(t){if(this.steps=[],this._cachedProjection={},this._chain="",this._gtlistentry=null,t&&t.steps)for(const i of t.steps)i instanceof Vg?this.steps.push(i):this.steps.push(new Vg({wkid:i.wkid,wkt:i.wkt,isInverse:i.isInverse}))}static cacheKey(t,i){return[t.wkid!==void 0&&t.wkid!==null?t.wkid.toString():"-1",t.wkt!==void 0&&t.wkt!==null?t.wkt.toString():"",i.wkid!==void 0&&i.wkid!==null?i.wkid.toString():"-1",i.wkt!==void 0&&i.wkt!==null?i.wkt.toString():""].join(",")}static fromGE(t){const i=new Bd;let r="";for(const n of t.steps){const o=Vg.fromGE(n);i.steps.push(o),r+=o.uid.toString()+","}return i._cachedProjection={},i._gtlistentry=null,i._chain=r,i}getInverse(){const t=new Bd;t.steps=[];for(let i=this.steps.length-1;i>=0;i--){const r=this.steps[i];t.steps.push(r.getInverse())}return t}getGTListEntry(){let t="";for(const i of this.steps)t+=i.uid.toString()+",";return t!==this._chain&&(this._gtlistentry=null,this._cachedProjection={},this._chain=t),this._gtlistentry}assignCachedGe(t,i,r){this._cachedProjection[Bd.cacheKey(t,i)]=r}getCachedGeTransformation(t,i){let r="";for(const o of this.steps)r+=o.uid.toString()+",";r!==this._chain&&(this._gtlistentry=null,this._cachedProjection={},this._chain=r);const n=this._cachedProjection[Bd.cacheKey(t,i)];return n===void 0?null:n}}function Pk(e,t,i){if(ce(t)||ce(i)||i.vcsWkid||hr(t,i))return null;const r=jg(t)/jg(i);if(r===1)return null;switch(e){case"point":case"esriGeometryPoint":return n=>l3e(n,r);case"polyline":case"esriGeometryPolyline":return n=>u3e(n,r);case"polygon":case"esriGeometryPolygon":return n=>c3e(n,r);case"multipoint":case"esriGeometryMultipoint":return n=>h3e(n,r);case"extent":case"esriGeometryExtent":return n=>p3e(n,r);default:return null}}function l3e(e,t){e&&e.z!=null&&(e.z*=t)}function c3e(e,t){if(e)for(const i of e.rings)for(const r of i)r.length>2&&(r[2]*=t)}function u3e(e,t){if(e)for(const i of e.paths)for(const r of i)r.length>2&&(r[2]*=t)}function h3e(e,t){if(e)for(const i of e.points)i.length>2&&(i[2]*=t)}function p3e(e,t){e&&e.zmin!=null&&e.zmax!=null&&(e.zmin*=t,e.zmax*=t)}let Ud=null,C_=null,Lk=null,Ok={};const oq=new NT;function vu(){return!!Ud&&iq()}function bu(e){return ce(Lk)&&(Lk=Promise.all([rq(),Promise.resolve().then(function(){return wUe}).then(t=>t.g),Promise.resolve().then(function(){return EUe})])),Lk.then(([,t,{hydratedAdapter:i}])=>{ur(e),C_=i,Ud=t.default,Ud._enableProjection(n3e),oq.notify()})}function Da(e,t,i=null,r=null){return Array.isArray(e)?e.length===0?[]:s9(C_,e,e[0].spatialReference,t,i,r):s9(C_,[e],e.spatialReference,t,i,r)[0]}function s9(e,t,i,r,n=null,o=null){if(ce(i)||ce(r))return t;if(pc(i,r,n))return t.map(c=>Ht(m3e(c,i,r)));if(ce(n)){const c=Bd.cacheKey(i,r);Ok[c]!==void 0?n=Ok[c]:(n=f3e(i,r,void 0),ce(n)&&(n=new Bd),Ok[c]=n)}if(ce(Ud)||ce(e))throw new Rk;return H(o)?Ud._project(e,t,i,r,n,o):Ud._project(e,t,i,r,n)}function $Je(e,t){const i=d3e([e],t);return H(i.pending)?{pending:i.pending,geometry:null}:H(i.geometries)?{pending:null,geometry:i.geometries[0]}:{pending:null,geometry:null}}function d3e(e,t){if(!vu()){for(const i of e)if(H(i)&&!hr(i.spatialReference,t)&&Sn(i.spatialReference)&&Sn(t)&&!pc(i.spatialReference,t))return ii(oq),{pending:bu(),geometries:null}}return{pending:null,geometries:e.map(i=>ce(i)?null:hr(i.spatialReference,t)?i:Sn(i.spatialReference)&&Sn(t)?y3e(i,t):null)}}function f3e(e,t,i=null){if(ce(e)||ce(t))return null;if(ce(Ud)||ce(C_))throw new Rk;const r=Ud._getTransformation(C_,e,t,i,i==null?void 0:i.spatialReference);return r!==null?Bd.fromGE(r):null}class Rk extends ue{constructor(){super("projection:not-loaded","projection engine not fully loaded yet, please call load()")}}var ve;(function(e){e[e.UNKNOWN=0]="UNKNOWN",e[e.SPHERICAL_ECEF=1]="SPHERICAL_ECEF",e[e.WGS84=2]="WGS84",e[e.WEB_MERCATOR=3]="WEB_MERCATOR",e[e.WGS84_ECEF=4]="WGS84_ECEF",e[e.CGCS2000=5]="CGCS2000",e[e.WGS84_COMPARABLE_LON_LAT=6]="WGS84_COMPARABLE_LON_LAT",e[e.SPHERICAL_MARS_PCPF=7]="SPHERICAL_MARS_PCPF",e[e.GCSMARS2000=8]="GCSMARS2000",e[e.SPHERICAL_MOON_PCPF=9]="SPHERICAL_MOON_PCPF",e[e.GCSMOON2000=10]="GCSMOON2000",e[e.LON_LAT=11]="LON_LAT",e[e.PLATE_CARREE=12]="PLATE_CARREE"})(ve||(ve={}));function y3e(e,t){try{const i=Da(e,t);if(i==null)return null;"xmin"in e&&"xmin"in i&&(i.zmin=e.zmin,i.zmax=e.zmax);const r=Pk(i.type,e.spatialReference,t);return H(r)&&r(i),i}catch(i){if(!(i instanceof Rk))throw i;return null}}function pc(e,t,i){return!i&&(!!hr(e,t)||Sn(e)&&Sn(t)&&!!wq(e,t,_q))}async function aq(e,t,i,r){if(vu())return OV(r);if(Array.isArray(e)){for(const{source:n,dest:o,geographicTransformation:c}of e)if(!pc(n,o,c))return bu(r)}else if(!pc(e,t,i))return bu(r);return OV(r)}function m3e(e,t,i){return e?"x"in e?lq(e,t,new pt,i,0):"xmin"in e?b3e(e,t,new gi,i,0):"rings"in e?cq(e,t,new es,i,0):"paths"in e?v3e(e,t,new Fn,i,0):"points"in e?g3e(e,t,new bw,i,0):null:null}function EJe(e,t,i=t.spatialReference,r=0){return H(i)&&H(e.spatialReference)&&H(lq(e,e.spatialReference,t,i,r))}function lq(e,t,i,r,n){Tr[0]=e.x,Tr[1]=e.y;const o=e.z;return Tr[2]=o!==void 0?o:n,Oh(Tr,t,0,Tr,r,0,1)?(i.x=Tr[0],i.y=Tr[1],i.spatialReference=r,o===void 0?(i.z=void 0,i.hasZ=!1):(i.z=Tr[2],i.hasZ=!0),e.m===void 0?(i.m=void 0,i.hasM=!1):(i.m=e.m,i.hasM=!0),i):null}function g3e(e,t,i,r,n){const{points:o,hasZ:c,hasM:h}=e,m=[],b=o.length,x=[];for(const I of o)x.push(I[0],I[1],c?I[2]:n);if(!Oh(x,t,0,x,r,0,b))return null;for(let I=0;I<b;++I){const E=3*I,k=x[E],P=x[E+1];c&&h?m.push([k,P,x[E+2],o[I][3]]):c?m.push([k,P,x[E+2]]):h?m.push([k,P,o[I][2]]):m.push([k,P])}return i.points=m,i.spatialReference=r,i.hasZ=c,i.hasM=h,i}function v3e(e,t,i,r,n){const{paths:o,hasZ:c,hasM:h}=e,m=[];return hq(o,c!=null?c:!1,h!=null?h:!1,t,m,r,n)?(i.paths=m,i.spatialReference=r,i.hasZ=c,i.hasM=h,i):null}function TJe({hasZ:e,spatialReference:t,paths:i},r,n=0){const o=qd(t,A_),c=Rh[o][ve.WGS84_COMPARABLE_LON_LAT];if(ce(c))return!1;const h=e?m=>m:m=>Nn(Tr,m[0],m[1],n);for(const m of i){const b=[];for(const x of m){const I=[0,0,n];c(h(x),0,I,0),b.push(I)}r.push(b)}return!0}function CJe({hasZ:e,spatialReference:t,rings:i},r,n=0){const o=qd(t,A_),c=Rh[o][ve.WGS84_COMPARABLE_LON_LAT];if(ce(c))return!1;const h=e?m=>m:m=>Nn(Tr,m[0],m[1],n);for(const m of i){const b=[];for(const x of m){const I=[0,0,n];c(h(x),0,I,0),b.push(I)}r.push(b)}return!0}function kJe(e,t,i=t.spatialReference,r=0){return H(e.spatialReference)&&H(i)&&H(cq(e,e.spatialReference,t,i,r))}function cq(e,t,i,r,n){const{rings:o,hasZ:c,hasM:h}=e,m=[];return hq(o,c!=null?c:!1,h!=null?h:!1,t,m,r,n)?(i.rings=m,i.spatialReference=r,i.hasZ=c,i.hasM=h,i):null}function b3e(e,t,i,r,n){const{xmin:o,ymin:c,xmax:h,ymax:m,hasZ:b,hasM:x}=e;return uq(o,c,b?e.zmin:n,t,Tr,r)?(i.xmin=Tr[0],i.ymin=Tr[1],b&&(i.zmin=Tr[2]),uq(h,m,b?e.zmax:n,t,Tr,r)?(i.xmax=Tr[0],i.ymax=Tr[1],b&&(i.zmax=Tr[2]),x&&(i.mmin=e.mmin,i.mmax=e.mmax),i.spatialReference=r,i):null):null}function AJe(e,t,i){return Oh(e,t,0,Tr,i.spatialReference,0,1)?(i.x=Tr[0],i.y=Tr[1],i.z=Tr[2],i):null}function PJe(e,t,i,r=0){Tr[0]=e.x,Tr[1]=e.y;const n=e.z;return Tr[2]=n!==void 0?n:r,Oh(Tr,e.spatialReference,0,t,i,0,1)}function uq(e,t,i,r,n,o){return br[0]=e,br[1]=t,br[2]=i,Oh(br,r,0,n,o,0,1)}function LJe(e,t,i,r){return!(ce(t)||ce(r)||e.length<2)&&(e.length===2&&(br[0]=e[0],br[1]=e[1],br[2]=0,e=br),Oh(e,t,0,i,r,0,1))}function OJe(e,t,i){return w3e(e,t,i)}function w3e(e,t,i){if(ce(t))return!1;const r=qd(t,A_),n=Rh[r][ve.WGS84_COMPARABLE_LON_LAT];return!ce(n)&&(n(e,0,br,0),i!==br&&(i[0]=br[0],i[1]=br[1],i.length>2&&(i[2]=br[2])),!0)}function Oh(e,t,i,r,n,o,c=1){const h=wq(t,n,_q);if(ce(h))return!1;if(h===ar){if(e===r&&i===o)return!0;const b=i+3*c;for(let x=i,I=o;x<b;x++,I++)r[I]=e[x];return!0}const m=i+3*c;for(let b=i,x=o;b<m;b+=3,x+=3)h(e,b,r,x);return!0}function hq(e,t,i,r,n,o,c=0){const h=new Array;for(const b of e)for(const x of b)h.push(x[0],x[1],t?x[2]:c);if(!Oh(h,r,0,h,o,0,h.length/3))return!1;let m=0;n.length=0;for(const b of e){const x=new Array;for(const I of b)t&&i?x.push([h[m++],h[m++],h[m++],I[3]]):t?x.push([h[m++],h[m++],h[m++]]):i?(x.push([h[m++],h[m++],I[2]]),m++):(x.push([h[m++],h[m++]]),m++);n.push(x)}return!0}function RJe(e,t,i,r){return e!=null&&(hr(t,r)?(eC(i,e),!0):(br[0]=e[0],br[1]=e[1],br[2]=0,!!Oh(br,t,0,br,r,0,1)&&(i[0]=br[0],i[1]=br[1],br[0]=e[2],br[1]=e[3],br[2]=0,!!Oh(br,t,0,br,r,0,1)&&(i[2]=br[0],i[3]=br[1],!0))))}function FJe(e,t,i,r){if(ce(e)||ce(r))return!1;const n=qd(e,A_),o=qd(r,N3e);if(n===o&&!pq(o)&&(n!==ve.UNKNOWN||hr(e,r)))return XU(i,t),!0;if(pq(o)){const c=Rh[n][ve.LON_LAT],h=Rh[ve.LON_LAT][o];return!ce(c)&&!ce(h)&&(c(t,0,Hd,0),h(Hd,0,Wd,0),dq(wu*Hd[0],wu*Hd[1],i),i[12]=Wd[0],i[13]=Wd[1],i[14]=Wd[2],!0)}if((o===ve.WEB_MERCATOR||o===ve.PLATE_CARREE)&&(n===ve.WGS84||n===ve.CGCS2000&&o===ve.PLATE_CARREE||n===ve.SPHERICAL_ECEF||n===ve.WEB_MERCATOR)){const c=Rh[n][ve.LON_LAT],h=Rh[ve.LON_LAT][o];return!ce(c)&&!ce(h)&&(c(t,0,Hd,0),h(Hd,0,Wd,0),n===ve.SPHERICAL_ECEF?_3e(wu*Hd[0],wu*Hd[1],i):e9(i),i[12]=Wd[0],i[13]=Wd[1],i[14]=Wd[2],!0)}return!1}function pq(e){return e===ve.SPHERICAL_ECEF||e===ve.SPHERICAL_MARS_PCPF||e===ve.SPHERICAL_MOON_PCPF}function dq(e,t,i){const r=Math.sin(e),n=Math.cos(e),o=Math.sin(t),c=Math.cos(t),h=i;return h[0]=-r,h[4]=-o*n,h[8]=c*n,h[12]=0,h[1]=n,h[5]=-o*r,h[9]=c*r,h[13]=0,h[2]=0,h[6]=c,h[10]=o,h[14]=0,h[3]=0,h[7]=0,h[11]=0,h[15]=1,h}function _3e(e,t,i){return dq(e,t,i),Ah(i,i),i}function qd(e,t){return e?t.spatialReference===e?t.spatialReferenceId:(t.spatialReference=e,"metersPerUnit"in t&&(t.metersPerUnit=kh(e,1)),e.wkt===PU.wkt?t.spatialReferenceId=ve.SPHERICAL_ECEF:mw(e)?t.spatialReferenceId=ve.WGS84:Xc(e)?t.spatialReferenceId=ve.WEB_MERCATOR:Eme(e)?t.spatialReferenceId=ve.PLATE_CARREE:e.wkt===r2e.wkt?t.spatialReferenceId=ve.WGS84_ECEF:e.wkid===pl.CGCS2000?t.spatialReferenceId=ve.CGCS2000:e.wkt===X5.wkt?t.spatialReferenceId=ve.SPHERICAL_MARS_PCPF:e.wkt===Q5.wkt?t.spatialReferenceId=ve.SPHERICAL_MOON_PCPF:ng(e)?t.spatialReferenceId=ve.GCSMARS2000:sg(e)?t.spatialReferenceId=ve.GCSMOON2000:t.spatialReferenceId=ve.UNKNOWN):ve.UNKNOWN}function ar(e,t,i,r){e!==i&&(i[r++]=e[t++],i[r++]=e[t++],i[r]=e[t])}function zg(e,t,i,r){i[r++]=Gg*(e[t++]/gr.radius),i[r++]=Gg*(Math.PI/2-2*Math.atan(Math.exp(-e[t++]/gr.radius))),i[r]=e[t]}function x3e(e,t,i,r){zg(e,t,i,r),ny(i,r,i,r)}function S3e(e,t,i,r){zg(e,t,i,r),oy(i,r,i,r)}function M3e(e,t,i,r,n){const o=.4999999*Math.PI,c=Vs(wu*e[t+1],-o,o),h=Math.sin(c);i[r++]=wu*e[t]*n.radius,i[r++]=n.halfSemiMajorAxis*Math.log((1+h)/(1-h)),i[r]=e[t+2]}function k_(e,t,i,r){M3e(e,t,i,r,gr)}const fq=gr.radius*Math.PI/180,yq=180/(gr.radius*Math.PI);function iy(e,t,i,r){i[r]=e[t]*fq,i[r+1]=e[t+1]*fq,i[r+2]=e[t+2]}function ry(e,t,i,r){i[r]=e[t]*yq,i[r+1]=e[t+1]*yq,i[r+2]=e[t+2]}function I3e(e,t,i,r){zg(e,t,i,r),iy(i,r,i,r)}function $3e(e,t,i,r){ay(e,t,i,r),iy(i,r,i,r)}function E3e(e,t,i,r){sy(e,t,i,r),iy(i,r,i,r)}function T3e(e,t,i,r){ry(e,t,i,r),ny(i,r,i,r)}function C3e(e,t,i,r){ry(e,t,i,r),k_(i,r,i,r)}function k3e(e,t,i,r){ry(e,t,i,r),oy(i,r,i,r)}function Fk(e){if(ce(e))return!1;const t=qd(e,A_);return!!Rh[t][ve.WGS84_COMPARABLE_LON_LAT]}function Nk(e,t,i,r,n){const o=n+e[t+2],c=wu*e[t+1],h=wu*e[t],m=Math.cos(c);i[r++]=Math.cos(h)*m*o,i[r++]=Math.sin(h)*m*o,i[r]=Math.sin(c)*o}function mq(e,t,i,r){Nk(e,t,i,r,ud.radius)}function gq(e,t,i,r){Nk(e,t,i,r,gh.radius)}function ny(e,t,i,r){Nk(e,t,i,r,gr.radius)}function Dk(e,t,i,r,n){const o=e[t],c=e[t+1],h=e[t+2],m=Math.sqrt(o*o+c*c+h*h),b=CG(h/(m===0?1:m)),x=Math.atan2(c,o);i[r++]=Gg*x,i[r++]=Gg*b,i[r]=m-n}function vq(e,t,i,r){Dk(e,t,i,r,ud.radius)}function bq(e,t,i,r){Dk(e,t,i,r,gh.radius)}function sy(e,t,i,r){Dk(e,t,i,r,gr.radius)}function A3e(e,t,i,r){sy(e,t,i,r),k_(i,r,i,r)}function P3e(e,t,i,r){sy(e,t,i,r),oy(i,r,i,r)}function L3e(e,t,i,r,n){const o=wu*e[t],c=wu*e[t+1],h=e[t+2],m=Math.sin(c),b=Math.cos(c),x=n.radius/Math.sqrt(1-n.eccentricitySquared*m*m);i[r++]=(x+h)*b*Math.cos(o),i[r++]=(x+h)*b*Math.sin(o),i[r++]=(x*(1-n.eccentricitySquared)+h)*m}function oy(e,t,i,r){L3e(e,t,i,r,gr)}function ay(e,t,i,r){const n=o3e,o=e[t],c=e[t+1],h=e[t+2];let m,b,x,I,E,k,P,F,N,B,z,q,J,X,Y,ae,he,fe,ye,xe,Se;m=Math.abs(h),b=o*o+c*c,x=Math.sqrt(b),I=b+h*h,E=Math.sqrt(I),xe=Math.atan2(c,o),k=h*h/I,P=b/I,X=n.a2/E,Y=n.a3-n.a4/E,P>.3?(F=m/E*(1+P*(n.a1+X+k*Y)/E),ye=Math.asin(F),B=F*F,N=Math.sqrt(1-B)):(N=x/E*(1-k*(n.a5-X-P*Y)/E),ye=Math.acos(N),B=1-N*N,F=Math.sqrt(B)),z=1-gr.eccentricitySquared*B,q=gr.radius/Math.sqrt(z),J=n.a6*q,X=x-q*N,Y=m-J*F,he=N*X+F*Y,ae=N*Y-F*X,fe=ae/(J/z+he),ye+=fe,Se=he+ae*fe/2,h<0&&(ye=-ye),i[r++]=Gg*xe,i[r++]=Gg*ye,i[r]=Se}function O3e(e,t,i,r){ay(e,t,i,r),ny(i,r,i,r)}function R3e(e,t,i,r){ay(e,t,i,r),k_(i,r,i,r)}const Rh={[ve.WGS84]:{[ve.CGCS2000]:null,[ve.GCSMARS2000]:null,[ve.GCSMOON2000]:null,[ve.LON_LAT]:ar,[ve.WGS84_COMPARABLE_LON_LAT]:ar,[ve.SPHERICAL_ECEF]:ny,[ve.SPHERICAL_MARS_PCPF]:null,[ve.SPHERICAL_MOON_PCPF]:null,[ve.UNKNOWN]:null,[ve.WEB_MERCATOR]:k_,[ve.PLATE_CARREE]:iy,[ve.WGS84]:ar,[ve.WGS84_ECEF]:oy},[ve.CGCS2000]:{[ve.CGCS2000]:ar,[ve.GCSMARS2000]:null,[ve.GCSMOON2000]:null,[ve.LON_LAT]:ar,[ve.WGS84_COMPARABLE_LON_LAT]:ar,[ve.SPHERICAL_ECEF]:ny,[ve.SPHERICAL_MARS_PCPF]:null,[ve.SPHERICAL_MOON_PCPF]:null,[ve.UNKNOWN]:null,[ve.WEB_MERCATOR]:null,[ve.PLATE_CARREE]:iy,[ve.WGS84]:null,[ve.WGS84_ECEF]:oy},[ve.GCSMARS2000]:{[ve.CGCS2000]:null,[ve.GCSMARS2000]:ar,[ve.GCSMOON2000]:null,[ve.LON_LAT]:ar,[ve.WGS84_COMPARABLE_LON_LAT]:null,[ve.SPHERICAL_ECEF]:null,[ve.SPHERICAL_MARS_PCPF]:gq,[ve.SPHERICAL_MOON_PCPF]:null,[ve.UNKNOWN]:null,[ve.WEB_MERCATOR]:null,[ve.PLATE_CARREE]:null,[ve.WGS84]:null,[ve.WGS84_ECEF]:null},[ve.GCSMOON2000]:{[ve.CGCS2000]:null,[ve.GCSMARS2000]:null,[ve.GCSMOON2000]:ar,[ve.LON_LAT]:ar,[ve.WGS84_COMPARABLE_LON_LAT]:null,[ve.SPHERICAL_ECEF]:null,[ve.SPHERICAL_MARS_PCPF]:null,[ve.SPHERICAL_MOON_PCPF]:mq,[ve.UNKNOWN]:null,[ve.WEB_MERCATOR]:null,[ve.PLATE_CARREE]:null,[ve.WGS84]:null,[ve.WGS84_ECEF]:null},[ve.WEB_MERCATOR]:{[ve.CGCS2000]:null,[ve.GCSMARS2000]:null,[ve.GCSMOON2000]:null,[ve.LON_LAT]:zg,[ve.WGS84_COMPARABLE_LON_LAT]:zg,[ve.SPHERICAL_ECEF]:x3e,[ve.SPHERICAL_MARS_PCPF]:null,[ve.SPHERICAL_MOON_PCPF]:null,[ve.UNKNOWN]:null,[ve.WEB_MERCATOR]:ar,[ve.PLATE_CARREE]:I3e,[ve.WGS84]:zg,[ve.WGS84_ECEF]:S3e},[ve.WGS84_ECEF]:{[ve.CGCS2000]:ay,[ve.GCSMARS2000]:null,[ve.GCSMOON2000]:null,[ve.LON_LAT]:ay,[ve.WGS84_COMPARABLE_LON_LAT]:ay,[ve.SPHERICAL_ECEF]:O3e,[ve.SPHERICAL_MARS_PCPF]:null,[ve.SPHERICAL_MOON_PCPF]:null,[ve.UNKNOWN]:null,[ve.WEB_MERCATOR]:R3e,[ve.PLATE_CARREE]:$3e,[ve.WGS84]:ay,[ve.WGS84_ECEF]:ar},[ve.SPHERICAL_ECEF]:{[ve.CGCS2000]:sy,[ve.GCSMARS2000]:null,[ve.GCSMOON2000]:null,[ve.LON_LAT]:sy,[ve.WGS84_COMPARABLE_LON_LAT]:sy,[ve.SPHERICAL_ECEF]:ar,[ve.SPHERICAL_MARS_PCPF]:null,[ve.SPHERICAL_MOON_PCPF]:null,[ve.UNKNOWN]:null,[ve.WEB_MERCATOR]:A3e,[ve.PLATE_CARREE]:E3e,[ve.WGS84]:sy,[ve.WGS84_ECEF]:P3e},[ve.SPHERICAL_MARS_PCPF]:{[ve.CGCS2000]:null,[ve.GCSMARS2000]:bq,[ve.GCSMOON2000]:null,[ve.LON_LAT]:bq,[ve.WGS84_COMPARABLE_LON_LAT]:null,[ve.SPHERICAL_ECEF]:null,[ve.SPHERICAL_MARS_PCPF]:ar,[ve.SPHERICAL_MOON_PCPF]:null,[ve.UNKNOWN]:null,[ve.WEB_MERCATOR]:null,[ve.PLATE_CARREE]:null,[ve.WGS84]:null,[ve.WGS84_ECEF]:null},[ve.SPHERICAL_MOON_PCPF]:{[ve.CGCS2000]:null,[ve.GCSMARS2000]:null,[ve.GCSMOON2000]:vq,[ve.LON_LAT]:vq,[ve.WGS84_COMPARABLE_LON_LAT]:null,[ve.SPHERICAL_ECEF]:null,[ve.SPHERICAL_MARS_PCPF]:null,[ve.SPHERICAL_MOON_PCPF]:ar,[ve.UNKNOWN]:null,[ve.WEB_MERCATOR]:null,[ve.PLATE_CARREE]:null,[ve.WGS84]:null,[ve.WGS84_ECEF]:null},[ve.UNKNOWN]:{[ve.CGCS2000]:null,[ve.GCSMARS2000]:null,[ve.GCSMOON2000]:null,[ve.LON_LAT]:null,[ve.WGS84_COMPARABLE_LON_LAT]:null,[ve.SPHERICAL_ECEF]:null,[ve.SPHERICAL_MARS_PCPF]:null,[ve.SPHERICAL_MOON_PCPF]:null,[ve.UNKNOWN]:ar,[ve.WEB_MERCATOR]:null,[ve.PLATE_CARREE]:null,[ve.WGS84]:null,[ve.WGS84_ECEF]:null},[ve.LON_LAT]:{[ve.CGCS2000]:ar,[ve.GCSMARS2000]:ar,[ve.GCSMOON2000]:ar,[ve.LON_LAT]:ar,[ve.WGS84_COMPARABLE_LON_LAT]:ar,[ve.SPHERICAL_ECEF]:ny,[ve.SPHERICAL_MARS_PCPF]:gq,[ve.SPHERICAL_MOON_PCPF]:mq,[ve.UNKNOWN]:null,[ve.WEB_MERCATOR]:k_,[ve.PLATE_CARREE]:iy,[ve.WGS84]:ar,[ve.WGS84_ECEF]:oy},[ve.WGS84_COMPARABLE_LON_LAT]:{[ve.CGCS2000]:null,[ve.GCSMARS2000]:null,[ve.GCSMOON2000]:null,[ve.LON_LAT]:ar,[ve.WGS84_COMPARABLE_LON_LAT]:ar,[ve.SPHERICAL_ECEF]:ny,[ve.SPHERICAL_MARS_PCPF]:null,[ve.SPHERICAL_MOON_PCPF]:null,[ve.UNKNOWN]:null,[ve.WEB_MERCATOR]:null,[ve.PLATE_CARREE]:iy,[ve.WGS84]:ar,[ve.WGS84_ECEF]:oy},[ve.PLATE_CARREE]:{[ve.CGCS2000]:ry,[ve.GCSMARS2000]:null,[ve.GCSMOON2000]:null,[ve.LON_LAT]:ry,[ve.WGS84_COMPARABLE_LON_LAT]:ry,[ve.SPHERICAL_ECEF]:T3e,[ve.SPHERICAL_MARS_PCPF]:null,[ve.SPHERICAL_MOON_PCPF]:null,[ve.UNKNOWN]:null,[ve.WEB_MERCATOR]:C3e,[ve.PLATE_CARREE]:ar,[ve.WGS84]:ry,[ve.WGS84_ECEF]:k3e}};function wq(e,t,i=jk()){return ce(e)||ce(t)?null:F3e(e,t,i).projector}function F3e(e,t,i){if(ce(e)||ce(t)||i.source.spatialReference===e&&i.dest.spatialReference===t)return i;const r=qd(e,i.source),n=qd(t,i.dest);return r===ve.UNKNOWN&&n===ve.UNKNOWN?hr(e,t)?i.projector=ar:i.projector=null:i.projector=Rh[r][n],i}function jk(){return{source:{spatialReference:null,spatialReferenceId:ve.UNKNOWN,metersPerUnit:1},dest:{spatialReference:null,spatialReferenceId:ve.UNKNOWN,metersPerUnit:1},projector:ar}}const A_={spatialReference:null,spatialReferenceId:ve.UNKNOWN},N3e={spatialReference:null,spatialReferenceId:ve.UNKNOWN},_q=jk();jk();const wu=xg(1),Gg=N6(1),br=it(),Hd=it(),Wd=it(),Tr=it();var Vk;let _u=Vk=class extends ke{constructor(e){super(e),this.cols=null,this.level=0,this.levelValue=null,this.origin=null,this.resolution=0,this.rows=null,this.scale=0}clone(){return new Vk({cols:this.cols,level:this.level,levelValue:this.levelValue,resolution:this.resolution,rows:this.rows,scale:this.scale})}};g([w({json:{write:!0,origins:{"web-document":{read:!1,write:!1},"portal-item":{read:!1,write:!1}}}})],_u.prototype,"cols",void 0),g([w({type:Ri,json:{write:!0}})],_u.prototype,"level",void 0),g([w({type:String,json:{write:!0}})],_u.prototype,"levelValue",void 0),g([w({json:{write:!0,origins:{"web-document":{read:!1,write:!1},"portal-item":{read:!1,write:!1}}}})],_u.prototype,"origin",void 0),g([w({type:Number,json:{write:!0}})],_u.prototype,"resolution",void 0),g([w({json:{write:!0,origins:{"web-document":{read:!1,write:!1},"portal-item":{read:!1,write:!1}}}})],_u.prototype,"rows",void 0),g([w({type:Number,json:{write:!0}})],_u.prototype,"scale",void 0),_u=Vk=g([te("esri.layers.support.LOD")],_u);const zk=_u;class xq{constructor(t,i,r,n,o){this.id=t,this.level=i,this.row=r,this.col=n,this.extent=o}}var Jd;const Sq=new kt({PNG:"png",PNG8:"png8",PNG24:"png24",PNG32:"png32",JPEG:"jpg",JPG:"jpg",DIB:"dib",TIFF:"tiff",EMF:"emf",PS:"ps",PDF:"pdf",GIF:"gif",SVG:"svg",SVGZ:"svgz",Mixed:"mixed",MIXED:"mixed",LERC:"lerc",LERC2D:"lerc2d",RAW:"raw",pbf:"pbf"});let as=Jd=class extends ke{constructor(e){super(e),this.dpi=96,this.format=null,this.origin=null,this.minScale=0,this.maxScale=0,this.size=null,this.spatialReference=null}static create(e={}){const{resolutionFactor:t=1,scales:i,size:r=256,spatialReference:n=Mt.WebMercator,numLODs:o=24}=e;if(!Sn(n)){const I=[];if(i)for(let E=0;E<i.length;E++){const k=i[E];I.push({level:E,scale:k,resolution:k})}else{let E=5e-4;for(let k=o-1;k>=0;k--)I.unshift({level:k,scale:E,resolution:E}),E*=2}return new Jd({dpi:96,lods:I,origin:new pt(0,0,n),size:[r,r],spatialReference:n})}const c=Wo(n),h=e.origin?new pt({x:e.origin.x,y:e.origin.y,spatialReference:n}):new pt(c?{x:c.origin[0],y:c.origin[1],spatialReference:n}:{x:0,y:0,spatialReference:n}),m=96,b=1/(kh(n)*39.37*m),x=[];if(i)for(let I=0;I<i.length;I++){const E=i[I],k=E*b;x.push({level:I,scale:E,resolution:k})}else{let I=PS(n)?512/r*5916575275917094e-7:256/r*591657527591555e-6;const E=Math.ceil(o/t);x.push({level:0,scale:I,resolution:I*b});for(let k=1;k<E;k++){const P=I/2**t,F=P*b;x.push({level:k,scale:P,resolution:F}),I=P}}return new Jd({dpi:m,lods:x,origin:h,size:[r,r],spatialReference:n})}get isWrappable(){const{spatialReference:e,origin:t}=this;if(e&&t){const i=Wo(e);return e.isWrappable&&!!i&&Math.abs(i.origin[0]-t.x)<=i.dx}return!1}readOrigin(e,t){return pt.fromJSON(K({spatialReference:t.spatialReference},e))}set lods(e){let t=0,i=0;const r=[],n=this._levelToLOD={};e&&(t=-1/0,i=1/0,e.forEach(o=>{r.push(o.scale),t=o.scale>t?o.scale:t,i=o.scale<i?o.scale:i,n[o.level]=o})),this._set("scales",r),this._set("minScale",t),this._set("maxScale",i),this._set("lods",e),this._initializeUpsampleLevels()}readSize(e,t){return[t.cols,t.rows]}writeSize(e,t){t.cols=e[0],t.rows=e[1]}zoomToScale(e){const t=this.scales;if(e<=0)return t[0];if(e>=t.length-1)return t[t.length-1];const i=Math.floor(e),r=i+1;return t[i]/(t[i]/t[r])**(e-i)}scaleToZoom(e){const t=this.scales,i=t.length-1;let r=0;for(;r<i;r++){const n=t[r],o=t[r+1];if(n<=e)return r;if(o===e)return r+1;if(n>e&&o<e)return r+Math.log(n/e)/Math.log(n/o)}return r}snapScale(e,t=.95){const i=this.scaleToZoom(e);return i%Math.floor(i)>=t?this.zoomToScale(Math.ceil(i)):this.zoomToScale(Math.floor(i))}tileAt(e,t,i,r){const n=this.lodAt(e);if(!n)return null;let o,c;if(typeof t=="number")o=t,c=i;else if(hr(t.spatialReference,this.spatialReference))o=t.x,c=t.y,r=i;else{const b=gw(t,this.spatialReference);if(ce(b))return null;o=b.x,c=b.y,r=i}const h=n.resolution*this.size[0],m=n.resolution*this.size[1];return r||(r=new xq(null,0,0,0,ro())),r.level=e,r.row=Math.floor((this.origin.y-c)/m+.001),r.col=Math.floor((o-this.origin.x)/h+.001),this.updateTileInfo(r),r}updateTileInfo(e,t=Jd.ExtrapolateOptions.NONE){let i=this.lodAt(e.level);if(!i&&t===Jd.ExtrapolateOptions.POWER_OF_TWO){const c=this.lods[this.lods.length-1];c.level<e.level&&(i=c)}if(!i)return;const r=e.level-i.level,n=i.resolution*this.size[0]/2**r,o=i.resolution*this.size[1]/2**r;e.id=`${e.level}/${e.row}/${e.col}`,e.extent||(e.extent=ro()),e.extent[0]=this.origin.x+e.col*n,e.extent[1]=this.origin.y-(e.row+1)*o,e.extent[2]=e.extent[0]+n,e.extent[3]=e.extent[1]+o}upsampleTile(e){const t=this._upsampleLevels[e.level];return!(!t||t.parentLevel===-1)&&(e.level=t.parentLevel,e.row=Math.floor(e.row/t.factor+.001),e.col=Math.floor(e.col/t.factor+.001),this.updateTileInfo(e),!0)}getTileBounds(e,t){const i=this.lodAt(t.level);if(i==null)return null;const{resolution:r}=i,n=r*this.size[0],o=r*this.size[1];return e[0]=this.origin.x+t.col*n,e[1]=this.origin.y-(t.row+1)*o,e[2]=e[0]+n,e[3]=e[1]+o,e}lodAt(e){var t,i;return(i=(t=this._levelToLOD)==null?void 0:t[e])!=null?i:null}clone(){return Jd.fromJSON(this.write({}))}getOrCreateCompatible(e,t){if(this.size[0]===256&&this.size[1]===256)return e===256?this:null;const i=[],r=this.lods.length;for(let n=0;n<r;n++){const o=this.lods[n],c=o.resolution*t;i.push(new zk({level:o.level,scale:o.scale,resolution:c}))}return new Jd({size:[e,e],dpi:this.dpi,format:this.format,compressionQuality:this.compressionQuality,origin:this.origin,spatialReference:this.spatialReference,lods:i})}_initializeUpsampleLevels(){const e=this.lods;this._upsampleLevels=[];let t=null;for(let i=0;i<e.length;i++){const r=e[i];this._upsampleLevels[r.level]={parentLevel:t?t.level:-1,factor:t?t.resolution/r.resolution:0},t=r}}};g([w({type:Number,json:{write:!0}})],as.prototype,"compressionQuality",void 0),g([w({type:Number,json:{write:!0}})],as.prototype,"dpi",void 0),g([w({type:String,json:{read:Sq.read,write:Sq.write,origins:{"web-scene":{read:!1,write:!1}}}})],as.prototype,"format",void 0),g([w({readOnly:!0})],as.prototype,"isWrappable",null),g([w({type:pt,json:{write:!0}})],as.prototype,"origin",void 0),g([We("origin")],as.prototype,"readOrigin",null),g([w({type:[zk],value:null,json:{write:!0}})],as.prototype,"lods",null),g([w({readOnly:!0})],as.prototype,"minScale",void 0),g([w({readOnly:!0})],as.prototype,"maxScale",void 0),g([w({readOnly:!0})],as.prototype,"scales",void 0),g([w({cast:e=>Array.isArray(e)?e:typeof e=="number"?[e,e]:[256,256]})],as.prototype,"size",void 0),g([We("size",["rows","cols"])],as.prototype,"readSize",null),g([tt("size",{cols:{type:Ri},rows:{type:Ri}})],as.prototype,"writeSize",null),g([w({type:Mt,json:{write:!0}})],as.prototype,"spatialReference",void 0),as=Jd=g([te("esri.layers.support.TileInfo")],as),function(e){var t;(t=e.ExtrapolateOptions||(e.ExtrapolateOptions={}))[t.NONE=0]="NONE",t[t.POWER_OF_TWO=1]="POWER_OF_TWO"}(as||(as={}));const xu=as,o9={widthBreakpoint:{getValue(e){const t=e.viewSize[0],i=e.breakpoints,r=this.values;return t<=i.xsmall?r.xsmall:t<=i.small?r.small:t<=i.medium?r.medium:t<=i.large?r.large:r.xlarge},values:{xsmall:"xsmall",small:"small",medium:"medium",large:"large",xlarge:"xlarge"},valueToClassName:{xsmall:"esri-view-width-xsmall esri-view-width-less-than-small esri-view-width-less-than-medium esri-view-width-less-than-large esri-view-width-less-than-xlarge",small:"esri-view-width-small esri-view-width-greater-than-xsmall esri-view-width-less-than-medium esri-view-width-less-than-large esri-view-width-less-than-xlarge",medium:"esri-view-width-medium esri-view-width-greater-than-xsmall esri-view-width-greater-than-small esri-view-width-less-than-large esri-view-width-less-than-xlarge",large:"esri-view-width-large esri-view-width-greater-than-xsmall esri-view-width-greater-than-small esri-view-width-greater-than-medium esri-view-width-less-than-xlarge",xlarge:"esri-view-width-xlarge esri-view-width-greater-than-xsmall esri-view-width-greater-than-small esri-view-width-greater-than-medium esri-view-width-greater-than-large"}},heightBreakpoint:{getValue(e){const t=e.viewSize[1],i=e.breakpoints,r=this.values;return t<=i.xsmall?r.xsmall:t<=i.small?r.small:t<=i.medium?r.medium:t<=i.large?r.large:r.xlarge},values:{xsmall:"xsmall",small:"small",medium:"medium",large:"large",xlarge:"xlarge"},valueToClassName:{xsmall:"esri-view-height-xsmall esri-view-height-less-than-small esri-view-height-less-than-medium esri-view-height-less-than-large esri-view-height-less-than-xlarge",small:"esri-view-height-small esri-view-height-greater-than-xsmall esri-view-height-less-than-medium esri-view-height-less-than-large esri-view-height-less-than-xlarge",medium:"esri-view-height-medium esri-view-height-greater-than-xsmall esri-view-height-greater-than-small esri-view-height-less-than-large esri-view-height-less-than-xlarge",large:"esri-view-height-large esri-view-height-greater-than-xsmall esri-view-height-greater-than-small esri-view-height-greater-than-medium esri-view-height-less-than-xlarge",xlarge:"esri-view-height-xlarge esri-view-height-greater-than-xsmall esri-view-height-greater-than-small esri-view-height-greater-than-medium esri-view-height-greater-than-large"}},orientation:{getValue(e){const t=e.viewSize,i=t[0],r=t[1],n=this.values;return r>=i?n.portrait:n.landscape},values:{portrait:"portrait",landscape:"landscape"},valueToClassName:{portrait:"esri-view-orientation-portrait",landscape:"esri-view-orientation-landscape"}}},Gk={xsmall:544,small:768,medium:992,large:1200};function D3e(e){const t=e;return t&&t.xsmall<t.small&&t.small<t.medium&&t.medium<t.large}function Bk(e,t){return t?o9[e].valueToClassName[t].split(" "):[]}const j3e=e=>{let t=class extends e{constructor(...i){super(...i),this._breakpointsHandles=new Ti,this.orientation=null,this.widthBreakpoint=null,this.heightBreakpoint=null,this.breakpoints=Gk}initialize(){this._breakpointsHandles.add(we(()=>[this.breakpoints,this.size],()=>this._updateClassNames(),St))}destroy(){this.destroyed||(this._removeActiveClassNames(),this._breakpointsHandles=li(this._breakpointsHandles))}set breakpoints(i){if(i===this._get("breakpoints"))return;const r=D3e(i);if(!r){const n=JSON.stringify(Gk,null,2);console.warn("provided breakpoints are not valid, using defaults:"+n)}i=r?i:Gk,this._set("breakpoints",K({},i))}_updateClassNames(){if(!this.container)return;const i=$o.acquire(),r=$o.acquire();let n,o=!1;for(n in o9){const c=this[n],h=o9[n].getValue({viewSize:this.size,breakpoints:this.breakpoints});c!==h&&(o=!0,this[n]=h,Bk(n,c).forEach(m=>r.push(m)),Bk(n,h).forEach(m=>i.push(m)))}o&&(this._applyClassNameChanges(i,r),$o.release(i),$o.release(r))}_applyClassNameChanges(i,r){const n=this.container;n&&(r.forEach(o=>n.classList.remove(o)),i.forEach(o=>n.classList.add(o)))}_removeActiveClassNames(){const i=this.container;if(!i)return;let r;for(r in o9)Bk(r,this[r]).forEach(n=>i.classList.remove(n))}};return g([w()],t.prototype,"breakpoints",null),g([w()],t.prototype,"orientation",void 0),g([w()],t.prototype,"widthBreakpoint",void 0),g([w()],t.prototype,"heightBreakpoint",void 0),t=g([te("esri.views.BreakpointsOwner")],t),t};function a9(e){return typeof e=="string"?document.getElementById(e):e!=null?e:null}function Mq(e){for(;e.hasChildNodes();)e.removeChild(e.firstChild)}function Iq(e,t){const i=t.parentNode;i&&i.insertBefore(e,t)}function $q(e,t){for(;;){const i=e.firstChild;if(!i)break;t.appendChild(i)}}function V3e(e){e.parentNode&&e.parentNode.removeChild(e)}let Bg=class extends Ye{constructor(){super(...arguments),this.updating=!1,this._handleId=0,this._handles=new Ti,this._scheduleHandleId=0,this._pendingPromises=new Set}destroy(){this.removeAll(),this._handles.destroy()}add(e,t,i={}){return this._installWatch(e,t,i,we)}addWhen(e,t,i={}){return this._installWatch(e,t,i,os)}addOnCollectionChange(e,t,{initial:i=!1,final:r=!1}={}){const n=++this._handleId;return this._handles.add([vr(e,"after-changes",this._createSyncUpdatingCallback(),mu),vr(e,"change",t,{onListenerAdd:i?o=>t({added:o.toArray(),removed:[]}):void 0,onListenerRemove:r?o=>t({added:[],removed:o.toArray()}):void 0})],n),{remove:()=>this._handles.remove(n)}}addPromise(e){if(ce(e))return e;const t=++this._handleId;this._handles.add({remove:()=>{this._pendingPromises.delete(e)&&(this._pendingPromises.size!==0||this._handles.has(l9)||this._set("updating",!1))}},t),this._pendingPromises.add(e),this._set("updating",!0);const i=()=>this._handles.remove(t);return e.then(i,i),e}removeAll(){this._pendingPromises.clear(),this._handles.removeAll(),this._set("updating",!1)}_installWatch(e,t,i={},r){const n=++this._handleId;i.sync||this._installSyncUpdatingWatch(e,n);const o=r(e,t,i);return this._handles.add(o,n),{remove:()=>this._handles.remove(n)}}_installSyncUpdatingWatch(e,t){const i=this._createSyncUpdatingCallback(),r=we(e,i,{sync:!0,equals:()=>!1});return this._handles.add(r,t),r}_createSyncUpdatingCallback(){return()=>{this._handles.remove(l9),++this._scheduleHandleId;const e=this._scheduleHandleId;this._get("updating")||this._set("updating",!0),this._handles.add(eg(()=>{e===this._scheduleHandleId&&(this._set("updating",this._pendingPromises.size>0),this._handles.remove(l9))}),l9)}}};g([w({readOnly:!0})],Bg.prototype,"updating",void 0),Bg=g([te("esri.core.support.WatchUpdatingTracking")],Bg);const l9=-42;/*!
 * @esri/arcgis-html-sanitizer - v3.0.1 - Tue Nov 15 2022 09:46:54 GMT-0800 (Pacific Standard Time)
 * Copyright (c) 2022 - Environmental Systems Research Institute, Inc.
 * Apache-2.0
 * 
 * js-xss
 * Copyright (c) 2012-2018 Zongmin Lei() <leizongmin@gmail.com>
 * http://ucdok.com
 * MIT License, see https://github.com/leizongmin/js-xss/blob/master/LICENSE for details
 */var z3e=function(e){if(typeof e!="object"||e===null||Object.prototype.toString.call(e)!=="[object Object]")return!1;var t=Object.getPrototypeOf(e);if(t===null)return!0;for(;Object.getPrototypeOf(t)!==null;)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t},ly={exports:{}},sn={},P_={exports:{}},cy={};function Eq(){var e={};return e["align-content"]=!1,e["align-items"]=!1,e["align-self"]=!1,e["alignment-adjust"]=!1,e["alignment-baseline"]=!1,e.all=!1,e["anchor-point"]=!1,e.animation=!1,e["animation-delay"]=!1,e["animation-direction"]=!1,e["animation-duration"]=!1,e["animation-fill-mode"]=!1,e["animation-iteration-count"]=!1,e["animation-name"]=!1,e["animation-play-state"]=!1,e["animation-timing-function"]=!1,e.azimuth=!1,e["backface-visibility"]=!1,e.background=!0,e["background-attachment"]=!0,e["background-clip"]=!0,e["background-color"]=!0,e["background-image"]=!0,e["background-origin"]=!0,e["background-position"]=!0,e["background-repeat"]=!0,e["background-size"]=!0,e["baseline-shift"]=!1,e.binding=!1,e.bleed=!1,e["bookmark-label"]=!1,e["bookmark-level"]=!1,e["bookmark-state"]=!1,e.border=!0,e["border-bottom"]=!0,e["border-bottom-color"]=!0,e["border-bottom-left-radius"]=!0,e["border-bottom-right-radius"]=!0,e["border-bottom-style"]=!0,e["border-bottom-width"]=!0,e["border-collapse"]=!0,e["border-color"]=!0,e["border-image"]=!0,e["border-image-outset"]=!0,e["border-image-repeat"]=!0,e["border-image-slice"]=!0,e["border-image-source"]=!0,e["border-image-width"]=!0,e["border-left"]=!0,e["border-left-color"]=!0,e["border-left-style"]=!0,e["border-left-width"]=!0,e["border-radius"]=!0,e["border-right"]=!0,e["border-right-color"]=!0,e["border-right-style"]=!0,e["border-right-width"]=!0,e["border-spacing"]=!0,e["border-style"]=!0,e["border-top"]=!0,e["border-top-color"]=!0,e["border-top-left-radius"]=!0,e["border-top-right-radius"]=!0,e["border-top-style"]=!0,e["border-top-width"]=!0,e["border-width"]=!0,e.bottom=!1,e["box-decoration-break"]=!0,e["box-shadow"]=!0,e["box-sizing"]=!0,e["box-snap"]=!0,e["box-suppress"]=!0,e["break-after"]=!0,e["break-before"]=!0,e["break-inside"]=!0,e["caption-side"]=!1,e.chains=!1,e.clear=!0,e.clip=!1,e["clip-path"]=!1,e["clip-rule"]=!1,e.color=!0,e["color-interpolation-filters"]=!0,e["column-count"]=!1,e["column-fill"]=!1,e["column-gap"]=!1,e["column-rule"]=!1,e["column-rule-color"]=!1,e["column-rule-style"]=!1,e["column-rule-width"]=!1,e["column-span"]=!1,e["column-width"]=!1,e.columns=!1,e.contain=!1,e.content=!1,e["counter-increment"]=!1,e["counter-reset"]=!1,e["counter-set"]=!1,e.crop=!1,e.cue=!1,e["cue-after"]=!1,e["cue-before"]=!1,e.cursor=!1,e.direction=!1,e.display=!0,e["display-inside"]=!0,e["display-list"]=!0,e["display-outside"]=!0,e["dominant-baseline"]=!1,e.elevation=!1,e["empty-cells"]=!1,e.filter=!1,e.flex=!1,e["flex-basis"]=!1,e["flex-direction"]=!1,e["flex-flow"]=!1,e["flex-grow"]=!1,e["flex-shrink"]=!1,e["flex-wrap"]=!1,e.float=!1,e["float-offset"]=!1,e["flood-color"]=!1,e["flood-opacity"]=!1,e["flow-from"]=!1,e["flow-into"]=!1,e.font=!0,e["font-family"]=!0,e["font-feature-settings"]=!0,e["font-kerning"]=!0,e["font-language-override"]=!0,e["font-size"]=!0,e["font-size-adjust"]=!0,e["font-stretch"]=!0,e["font-style"]=!0,e["font-synthesis"]=!0,e["font-variant"]=!0,e["font-variant-alternates"]=!0,e["font-variant-caps"]=!0,e["font-variant-east-asian"]=!0,e["font-variant-ligatures"]=!0,e["font-variant-numeric"]=!0,e["font-variant-position"]=!0,e["font-weight"]=!0,e.grid=!1,e["grid-area"]=!1,e["grid-auto-columns"]=!1,e["grid-auto-flow"]=!1,e["grid-auto-rows"]=!1,e["grid-column"]=!1,e["grid-column-end"]=!1,e["grid-column-start"]=!1,e["grid-row"]=!1,e["grid-row-end"]=!1,e["grid-row-start"]=!1,e["grid-template"]=!1,e["grid-template-areas"]=!1,e["grid-template-columns"]=!1,e["grid-template-rows"]=!1,e["hanging-punctuation"]=!1,e.height=!0,e.hyphens=!1,e.icon=!1,e["image-orientation"]=!1,e["image-resolution"]=!1,e["ime-mode"]=!1,e["initial-letters"]=!1,e["inline-box-align"]=!1,e["justify-content"]=!1,e["justify-items"]=!1,e["justify-self"]=!1,e.left=!1,e["letter-spacing"]=!0,e["lighting-color"]=!0,e["line-box-contain"]=!1,e["line-break"]=!1,e["line-grid"]=!1,e["line-height"]=!1,e["line-snap"]=!1,e["line-stacking"]=!1,e["line-stacking-ruby"]=!1,e["line-stacking-shift"]=!1,e["line-stacking-strategy"]=!1,e["list-style"]=!0,e["list-style-image"]=!0,e["list-style-position"]=!0,e["list-style-type"]=!0,e.margin=!0,e["margin-bottom"]=!0,e["margin-left"]=!0,e["margin-right"]=!0,e["margin-top"]=!0,e["marker-offset"]=!1,e["marker-side"]=!1,e.marks=!1,e.mask=!1,e["mask-box"]=!1,e["mask-box-outset"]=!1,e["mask-box-repeat"]=!1,e["mask-box-slice"]=!1,e["mask-box-source"]=!1,e["mask-box-width"]=!1,e["mask-clip"]=!1,e["mask-image"]=!1,e["mask-origin"]=!1,e["mask-position"]=!1,e["mask-repeat"]=!1,e["mask-size"]=!1,e["mask-source-type"]=!1,e["mask-type"]=!1,e["max-height"]=!0,e["max-lines"]=!1,e["max-width"]=!0,e["min-height"]=!0,e["min-width"]=!0,e["move-to"]=!1,e["nav-down"]=!1,e["nav-index"]=!1,e["nav-left"]=!1,e["nav-right"]=!1,e["nav-up"]=!1,e["object-fit"]=!1,e["object-position"]=!1,e.opacity=!1,e.order=!1,e.orphans=!1,e.outline=!1,e["outline-color"]=!1,e["outline-offset"]=!1,e["outline-style"]=!1,e["outline-width"]=!1,e.overflow=!1,e["overflow-wrap"]=!1,e["overflow-x"]=!1,e["overflow-y"]=!1,e.padding=!0,e["padding-bottom"]=!0,e["padding-left"]=!0,e["padding-right"]=!0,e["padding-top"]=!0,e.page=!1,e["page-break-after"]=!1,e["page-break-before"]=!1,e["page-break-inside"]=!1,e["page-policy"]=!1,e.pause=!1,e["pause-after"]=!1,e["pause-before"]=!1,e.perspective=!1,e["perspective-origin"]=!1,e.pitch=!1,e["pitch-range"]=!1,e["play-during"]=!1,e.position=!1,e["presentation-level"]=!1,e.quotes=!1,e["region-fragment"]=!1,e.resize=!1,e.rest=!1,e["rest-after"]=!1,e["rest-before"]=!1,e.richness=!1,e.right=!1,e.rotation=!1,e["rotation-point"]=!1,e["ruby-align"]=!1,e["ruby-merge"]=!1,e["ruby-position"]=!1,e["shape-image-threshold"]=!1,e["shape-outside"]=!1,e["shape-margin"]=!1,e.size=!1,e.speak=!1,e["speak-as"]=!1,e["speak-header"]=!1,e["speak-numeral"]=!1,e["speak-punctuation"]=!1,e["speech-rate"]=!1,e.stress=!1,e["string-set"]=!1,e["tab-size"]=!1,e["table-layout"]=!1,e["text-align"]=!0,e["text-align-last"]=!0,e["text-combine-upright"]=!0,e["text-decoration"]=!0,e["text-decoration-color"]=!0,e["text-decoration-line"]=!0,e["text-decoration-skip"]=!0,e["text-decoration-style"]=!0,e["text-emphasis"]=!0,e["text-emphasis-color"]=!0,e["text-emphasis-position"]=!0,e["text-emphasis-style"]=!0,e["text-height"]=!0,e["text-indent"]=!0,e["text-justify"]=!0,e["text-orientation"]=!0,e["text-overflow"]=!0,e["text-shadow"]=!0,e["text-space-collapse"]=!0,e["text-transform"]=!0,e["text-underline-position"]=!0,e["text-wrap"]=!0,e.top=!1,e.transform=!1,e["transform-origin"]=!1,e["transform-style"]=!1,e.transition=!1,e["transition-delay"]=!1,e["transition-duration"]=!1,e["transition-property"]=!1,e["transition-timing-function"]=!1,e["unicode-bidi"]=!1,e["vertical-align"]=!1,e.visibility=!1,e["voice-balance"]=!1,e["voice-duration"]=!1,e["voice-family"]=!1,e["voice-pitch"]=!1,e["voice-range"]=!1,e["voice-rate"]=!1,e["voice-stress"]=!1,e["voice-volume"]=!1,e.volume=!1,e["white-space"]=!1,e.widows=!1,e.width=!0,e["will-change"]=!1,e["word-break"]=!0,e["word-spacing"]=!0,e["word-wrap"]=!0,e["wrap-flow"]=!1,e["wrap-through"]=!1,e["writing-mode"]=!1,e["z-index"]=!1,e}function G3e(e,t,i){}function B3e(e,t,i){}var U3e=/javascript\s*\:/img;function q3e(e,t){return U3e.test(t)?"":t}cy.whiteList=Eq();cy.getDefaultWhiteList=Eq;cy.onAttr=G3e;cy.onIgnoreAttr=B3e;cy.safeAttrValue=q3e;var H3e={indexOf:function(e,t){var i,r;if(Array.prototype.indexOf)return e.indexOf(t);for(i=0,r=e.length;i<r;i++)if(e[i]===t)return i;return-1},forEach:function(e,t,i){var r,n;if(Array.prototype.forEach)return e.forEach(t,i);for(r=0,n=e.length;r<n;r++)t.call(i,e[r],r,e)},trim:function(e){return String.prototype.trim?e.trim():e.replace(/(^\s*)|(\s*$)/g,"")},trimRight:function(e){return String.prototype.trimRight?e.trimRight():e.replace(/(\s*$)/g,"")}},L_=H3e;function W3e(e,t){e=L_.trimRight(e),e[e.length-1]!==";"&&(e+=";");var i=e.length,r=!1,n=0,o=0,c="";function h(){if(!r){var x=L_.trim(e.slice(n,o)),I=x.indexOf(":");if(I!==-1){var E=L_.trim(x.slice(0,I)),k=L_.trim(x.slice(I+1));if(E){var P=t(n,c.length,E,k,x);P&&(c+=P+"; ")}}}n=o+1}for(;o<i;o++){var m=e[o];if(m==="/"&&e[o+1]==="*"){var b=e.indexOf("*/",o+2);if(b===-1)break;o=b+1,n=o+1,r=!1}else m==="("?r=!0:m===")"?r=!1:m===";"?r||h():m===`
`&&h()}return L_.trim(c)}var J3e=W3e,c9=cy,Z3e=J3e;function Tq(e){return e==null}function K3e(e){var t={};for(var i in e)t[i]=e[i];return t}function Cq(e){e=K3e(e||{}),e.whiteList=e.whiteList||c9.whiteList,e.onAttr=e.onAttr||c9.onAttr,e.onIgnoreAttr=e.onIgnoreAttr||c9.onIgnoreAttr,e.safeAttrValue=e.safeAttrValue||c9.safeAttrValue,this.options=e}Cq.prototype.process=function(e){if(e=e||"",e=e.toString(),!e)return"";var t=this,i=t.options,r=i.whiteList,n=i.onAttr,o=i.onIgnoreAttr,c=i.safeAttrValue,h=Z3e(e,function(m,b,x,I,E){var k=r[x],P=!1;if(k===!0?P=k:typeof k=="function"?P=k(I):k instanceof RegExp&&(P=k.test(I)),P!==!0&&(P=!1),I=c(x,I),!!I){var F={position:b,sourcePosition:m,source:E,isWhite:P};if(P){var N=n(x,I,F);return Tq(N)?x+":"+I:N}else{var N=o(x,I,F);if(!Tq(N))return N}}});return h};var Y3e=Cq;(function(e,t){var i=cy,r=Y3e;function n(c,h){var m=new r(h);return m.process(c)}t=e.exports=n,t.FilterCSS=r;for(var o in i)t[o]=i[o]})(P_,P_.exports);var Uk={indexOf:function(e,t){var i,r;if(Array.prototype.indexOf)return e.indexOf(t);for(i=0,r=e.length;i<r;i++)if(e[i]===t)return i;return-1},forEach:function(e,t,i){var r,n;if(Array.prototype.forEach)return e.forEach(t,i);for(r=0,n=e.length;r<n;r++)t.call(i,e[r],r,e)},trim:function(e){return String.prototype.trim?e.trim():e.replace(/(^\s*)|(\s*$)/g,"")},spaceIndex:function(e){var t=/\s|\n|\t/,i=t.exec(e);return i?i.index:-1}},X3e=P_.exports.FilterCSS,Q3e=P_.exports.getDefaultWhiteList,u9=Uk;function kq(){return{a:["target","href","title"],abbr:["title"],address:[],area:["shape","coords","href","alt"],article:[],aside:[],audio:["autoplay","controls","crossorigin","loop","muted","preload","src"],b:[],bdi:["dir"],bdo:["dir"],big:[],blockquote:["cite"],br:[],caption:[],center:[],cite:[],code:[],col:["align","valign","span","width"],colgroup:["align","valign","span","width"],dd:[],del:["datetime"],details:["open"],div:[],dl:[],dt:[],em:[],figcaption:[],figure:[],font:["color","size","face"],footer:[],h1:[],h2:[],h3:[],h4:[],h5:[],h6:[],header:[],hr:[],i:[],img:["src","alt","title","width","height"],ins:["datetime"],li:[],mark:[],nav:[],ol:[],p:[],pre:[],s:[],section:[],small:[],span:[],sub:[],summary:[],sup:[],strong:[],strike:[],table:["width","border","align","valign"],tbody:["align","valign"],td:["width","rowspan","colspan","align","valign"],tfoot:["align","valign"],th:["width","rowspan","colspan","align","valign"],thead:["align","valign"],tr:["rowspan","align","valign"],tt:[],u:[],ul:[],video:["autoplay","controls","crossorigin","loop","muted","playsinline","poster","preload","src","height","width"]}}var Aq=new X3e;function exe(e,t,i){}function txe(e,t,i){}function ixe(e,t,i){}function rxe(e,t,i){}function Pq(e){return e.replace(sxe,"&lt;").replace(oxe,"&gt;")}function nxe(e,t,i,r){if(i=Vq(i),t==="href"||t==="src"){if(i=u9.trim(i),i==="#")return"#";if(!(i.substr(0,7)==="http://"||i.substr(0,8)==="https://"||i.substr(0,7)==="mailto:"||i.substr(0,4)==="tel:"||i.substr(0,11)==="data:image/"||i.substr(0,6)==="ftp://"||i.substr(0,2)==="./"||i.substr(0,3)==="../"||i[0]==="#"||i[0]==="/"))return""}else if(t==="background"){if(h9.lastIndex=0,h9.test(i))return""}else if(t==="style"){if(Lq.lastIndex=0,Lq.test(i)||(Oq.lastIndex=0,Oq.test(i)&&(h9.lastIndex=0,h9.test(i))))return"";r!==!1&&(r=r||Aq,i=r.process(i))}return i=zq(i),i}var sxe=/</g,oxe=/>/g,axe=/"/g,lxe=/&quot;/g,cxe=/&#([a-zA-Z0-9]*);?/gim,uxe=/&colon;?/gim,hxe=/&newline;?/gim,h9=/((j\s*a\s*v\s*a|v\s*b|l\s*i\s*v\s*e)\s*s\s*c\s*r\s*i\s*p\s*t\s*|m\s*o\s*c\s*h\s*a):/gi,Lq=/e\s*x\s*p\s*r\s*e\s*s\s*s\s*i\s*o\s*n\s*\(.*/gi,Oq=/u\s*r\s*l\s*\(.*/gi;function Rq(e){return e.replace(axe,"&quot;")}function Fq(e){return e.replace(lxe,'"')}function Nq(e){return e.replace(cxe,function(i,r){return r[0]==="x"||r[0]==="X"?String.fromCharCode(parseInt(r.substr(1),16)):String.fromCharCode(parseInt(r,10))})}function Dq(e){return e.replace(uxe,":").replace(hxe," ")}function jq(e){for(var t="",i=0,r=e.length;i<r;i++)t+=e.charCodeAt(i)<32?" ":e.charAt(i);return u9.trim(t)}function Vq(e){return e=Fq(e),e=Nq(e),e=Dq(e),e=jq(e),e}function zq(e){return e=Rq(e),e=Pq(e),e}function pxe(){return""}function dxe(e,t){typeof t!="function"&&(t=function(){});var i=!Array.isArray(e);function r(c){return i?!0:u9.indexOf(e,c)!==-1}var n=[],o=!1;return{onIgnoreTag:function(c,h,m){if(r(c))if(m.isClosing){var b="[/removed]",x=m.position+b.length;return n.push([o!==!1?o:m.position,x]),o=!1,b}else return o||(o=m.position),"[removed]";else return t(c,h,m)},remove:function(c){var h="",m=0;return u9.forEach(n,function(b){h+=c.slice(m,b[0]),m=b[1]}),h+=c.slice(m),h}}}function fxe(e){for(var t="",i=0;i<e.length;){var r=e.indexOf("<!--",i);if(r===-1){t+=e.slice(i);break}t+=e.slice(i,r);var n=e.indexOf("-->",r);if(n===-1)break;i=n+3}return t}function yxe(e){var t=e.split("");return t=t.filter(function(i){var r=i.charCodeAt(0);return r===127?!1:r<=31?r===10||r===13:!0}),t.join("")}sn.whiteList=kq();sn.getDefaultWhiteList=kq;sn.onTag=exe;sn.onIgnoreTag=txe;sn.onTagAttr=ixe;sn.onIgnoreTagAttr=rxe;sn.safeAttrValue=nxe;sn.escapeHtml=Pq;sn.escapeQuote=Rq;sn.unescapeQuote=Fq;sn.escapeHtmlEntities=Nq;sn.escapeDangerHtml5Entities=Dq;sn.clearNonPrintableCharacter=jq;sn.friendlyAttrValue=Vq;sn.escapeAttrValue=zq;sn.onIgnoreTagStripAll=pxe;sn.StripTagBody=dxe;sn.stripCommentTag=fxe;sn.stripBlankChar=yxe;sn.cssFilter=Aq;sn.getDefaultCSSWhiteList=Q3e;var p9={},Zd=Uk;function mxe(e){var t=Zd.spaceIndex(e),i;return t===-1?i=e.slice(1,-1):i=e.slice(1,t+1),i=Zd.trim(i).toLowerCase(),i.slice(0,1)==="/"&&(i=i.slice(1)),i.slice(-1)==="/"&&(i=i.slice(0,-1)),i}function gxe(e){return e.slice(0,2)==="</"}function vxe(e,t,i){var r="",n=0,o=!1,c=!1,h=0,m=e.length,b="",x="";e:for(h=0;h<m;h++){var I=e.charAt(h);if(o===!1){if(I==="<"){o=h;continue}}else if(c===!1){if(I==="<"){r+=i(e.slice(n,h)),o=h,n=h;continue}if(I===">"){r+=i(e.slice(n,o)),x=e.slice(o,h+1),b=mxe(x),r+=t(o,r.length,b,x,gxe(x)),n=h+1,o=!1;continue}if(I==='"'||I==="'")for(var E=1,k=e.charAt(h-E);k.trim()===""||k==="=";){if(k==="="){c=I;continue e}k=e.charAt(h-++E)}}else if(I===c){c=!1;continue}}return n<e.length&&(r+=i(e.substr(n))),r}var bxe=/[^a-zA-Z0-9\\_:.-]/gim;function wxe(e,t){var i=0,r=0,n=[],o=!1,c=e.length;function h(E,k){if(E=Zd.trim(E),E=E.replace(bxe,"").toLowerCase(),!(E.length<1)){var P=t(E,k||"");P&&n.push(P)}}for(var m=0;m<c;m++){var b=e.charAt(m),x,I;if(o===!1&&b==="="){o=e.slice(i,m),i=m+1,r=e.charAt(i)==='"'||e.charAt(i)==="'"?i:xxe(e,m+1);continue}if(o!==!1&&m===r){if(I=e.indexOf(b,m+1),I===-1)break;x=Zd.trim(e.slice(r+1,I)),h(o,x),o=!1,m=I,i=m+1;continue}if(/\s|\n|\t/.test(b))if(e=e.replace(/\s|\n|\t/g," "),o===!1)if(I=_xe(e,m),I===-1){x=Zd.trim(e.slice(i,m)),h(x),o=!1,i=m+1;continue}else{m=I-1;continue}else if(I=Sxe(e,m-1),I===-1){x=Zd.trim(e.slice(i,m)),x=Gq(x),h(o,x),o=!1,i=m+1;continue}else continue}return i<e.length&&(o===!1?h(e.slice(i)):h(o,Gq(Zd.trim(e.slice(i))))),Zd.trim(n.join(" "))}function _xe(e,t){for(;t<e.length;t++){var i=e[t];if(i!==" ")return i==="="?t:-1}}function xxe(e,t){for(;t<e.length;t++){var i=e[t];if(i!==" ")return i==="'"||i==='"'?t:-1}}function Sxe(e,t){for(;t>0;t--){var i=e[t];if(i!==" ")return i==="="?t:-1}}function Mxe(e){return e[0]==='"'&&e[e.length-1]==='"'||e[0]==="'"&&e[e.length-1]==="'"}function Gq(e){return Mxe(e)?e.substr(1,e.length-2):e}p9.parseTag=vxe;p9.parseAttr=wxe;var Ixe=P_.exports.FilterCSS,dc=sn,Bq=p9,$xe=Bq.parseTag,Exe=Bq.parseAttr,d9=Uk;function f9(e){return e==null}function Txe(e){var t=d9.spaceIndex(e);if(t===-1)return{html:"",closing:e[e.length-2]==="/"};e=d9.trim(e.slice(t+1,-1));var i=e[e.length-1]==="/";return i&&(e=d9.trim(e.slice(0,-1))),{html:e,closing:i}}function Cxe(e){var t={};for(var i in e)t[i]=e[i];return t}function kxe(e){var t={};for(var i in e)Array.isArray(e[i])?t[i.toLowerCase()]=e[i].map(function(r){return r.toLowerCase()}):t[i.toLowerCase()]=e[i];return t}function Uq(e){e=Cxe(e||{}),e.stripIgnoreTag&&(e.onIgnoreTag&&console.error('Notes: cannot use these two options "stripIgnoreTag" and "onIgnoreTag" at the same time'),e.onIgnoreTag=dc.onIgnoreTagStripAll),e.whiteList||e.allowList?e.whiteList=kxe(e.whiteList||e.allowList):e.whiteList=dc.whiteList,e.onTag=e.onTag||dc.onTag,e.onTagAttr=e.onTagAttr||dc.onTagAttr,e.onIgnoreTag=e.onIgnoreTag||dc.onIgnoreTag,e.onIgnoreTagAttr=e.onIgnoreTagAttr||dc.onIgnoreTagAttr,e.safeAttrValue=e.safeAttrValue||dc.safeAttrValue,e.escapeHtml=e.escapeHtml||dc.escapeHtml,this.options=e,e.css===!1?this.cssFilter=!1:(e.css=e.css||{},this.cssFilter=new Ixe(e.css))}Uq.prototype.process=function(e){if(e=e||"",e=e.toString(),!e)return"";var t=this,i=t.options,r=i.whiteList,n=i.onTag,o=i.onIgnoreTag,c=i.onTagAttr,h=i.onIgnoreTagAttr,m=i.safeAttrValue,b=i.escapeHtml,x=t.cssFilter;i.stripBlankChar&&(e=dc.stripBlankChar(e)),i.allowCommentTag||(e=dc.stripCommentTag(e));var I=!1;i.stripIgnoreTagBody&&(I=dc.StripTagBody(i.stripIgnoreTagBody,o),o=I.onIgnoreTag);var E=$xe(e,function(k,P,F,N,B){var z={sourcePosition:k,position:P,isClosing:B,isWhite:Object.prototype.hasOwnProperty.call(r,F)},q=n(F,N,z);if(!f9(q))return q;if(z.isWhite){if(z.isClosing)return"</"+F+">";var J=Txe(N),X=r[F],Y=Exe(J.html,function(ae,he){var fe=d9.indexOf(X,ae)!==-1,ye=c(F,ae,he,fe);return f9(ye)?fe?(he=m(F,ae,he,x),he?ae+'="'+he+'"':ae):(ye=h(F,ae,he,fe),f9(ye)?void 0:ye):ye});return N="<"+F,Y&&(N+=" "+Y),J.closing&&(N+=" /"),N+=">",N}else return q=o(F,N,z),f9(q)?b(N):q},b);return I&&(E=I.remove(E)),E};var Axe=Uq;(function(e,t){var i=sn,r=p9,n=Axe;function o(h,m){var b=new n(m);return b.process(h)}t=e.exports=o,t.filterXSS=o,t.FilterXSS=n,function(){for(var h in i)t[h]=i[h];for(var m in r)t[m]=r[m]}();function c(){return typeof self!="undefined"&&typeof DedicatedWorkerGlobalScope!="undefined"&&self instanceof DedicatedWorkerGlobalScope}c()&&(self.filterXSS=e.exports)})(ly,ly.exports);var Pxe=function(){function e(t,i){var r=this;this.arcgisWhiteList={a:["href","style","target"],abbr:["title"],audio:["autoplay","controls","loop","muted","preload"],b:[],br:[],dd:["style"],div:["align","style"],dl:["style"],dt:["style"],em:[],figcaption:["style"],figure:["style"],font:["color","face","size","style"],h1:["style"],h2:["style"],h3:["style"],h4:["style"],h5:["style"],h6:["style"],hr:[],i:[],img:["alt","border","height","src","style","width"],li:[],ol:[],p:["style"],source:["media","src","type"],span:["style"],strong:[],sub:["style"],sup:["style"],table:["border","cellpadding","cellspacing","height","style","width"],tbody:[],tr:["align","height","style","valign"],td:["align","colspan","height","nowrap","rowspan","style","valign","width"],th:["align","colspan","height","nowrap","rowspan","style","valign","width"],u:[],ul:[],video:["autoplay","controls","height","loop","muted","poster","preload","width"]},this.allowedProtocols=["http","https","mailto","iform","tel","flow","lfmobile","arcgis-navigator","arcgis-appstudio-player","arcgis-survey123","arcgis-collector","arcgis-workforce","arcgis-explorer","arcgis-trek2there","arcgis-quickcapture","mspbi","comgooglemaps","pdfefile","pdfehttp","pdfehttps","boxapp","boxemm","awb","awbs","gropen","radarscope"],this.arcgisFilterOptions={allowCommentTag:!0,safeAttrValue:function(o,c,h,m){return o==="a"&&c==="href"||(o==="img"||o==="source")&&c==="src"?r.sanitizeUrl(h):ly.exports.safeAttrValue(o,c,h,m)}},this._entityMap={"&":"&#x38;","<":"&#x3C;",">":"&#x3E;",'"':"&#x22;","'":"&#x27;","/":"&#x2F;"};var n;t&&!i?n=t:t&&i?(n=Object.create(this.arcgisFilterOptions),Object.keys(t).forEach(function(o){o==="whiteList"?n.whiteList=r._extendObjectOfArrays([r.arcgisWhiteList,t.whiteList||{}]):n[o]=t[o]})):(n=Object.create(this.arcgisFilterOptions),n.whiteList=this.arcgisWhiteList),this.xssFilterOptions=n,this._xssFilter=new ly.exports.FilterXSS(n)}return e.prototype.sanitize=function(t,i){switch(i===void 0&&(i={}),typeof t){case"number":return isNaN(t)||!isFinite(t)?null:t;case"boolean":return t;case"string":return this._xssFilter.process(t);case"object":return this._iterateOverObject(t,i);default:return i.allowUndefined&&typeof t=="undefined"?void 0:null}},e.prototype.sanitizeUrl=function(t,i){var r=(i!=null?i:{}).isProtocolRequired,n=r===void 0?!0:r,o=this._trim(t.substring(0,t.indexOf(":"))),c=t==="/",h=/^#/.test(t),m=o&&this.allowedProtocols.indexOf(o.toLowerCase())>-1;return c||h||m?ly.exports.escapeAttrValue(t):!o&&!n?ly.exports.escapeAttrValue("https://".concat(t)):""},e.prototype.sanitizeHTMLAttribute=function(t,i,r,n){return typeof this.xssFilterOptions.safeAttrValue=="function"?this.xssFilterOptions.safeAttrValue(t,i,r,n):ly.exports.safeAttrValue(t,i,r,n)},e.prototype.validate=function(t,i){i===void 0&&(i={});var r=this.sanitize(t,i);return{isValid:t===r,sanitized:r}},e.prototype.encodeHTML=function(t){var i=this;return String(t).replace(/[&<>"'\/]/g,function(r){return i._entityMap[r]})},e.prototype.encodeAttrValue=function(t){var i=/^[a-zA-Z0-9]$/;return String(t).replace(/[\x00-\xFF]/g,function(r,n){return i.test(r)?r:"&#x".concat(Number(t.charCodeAt(n)).toString(16),";")})},e.prototype._extendObjectOfArrays=function(t){var i={};return t.forEach(function(r){Object.keys(r).forEach(function(n){Array.isArray(r[n])&&Array.isArray(i[n])?i[n]=i[n].concat(r[n]):i[n]=r[n]})}),i},e.prototype._iterateOverObject=function(t,i){var r=this;i===void 0&&(i={});try{var n=!1,o=void 0;if(Array.isArray(t))o=t.reduce(function(h,m){var b=r.validate(m,i);return b.isValid?h.concat([m]):(n=!0,h.concat([b.sanitized]))},[]);else if(z3e(t)){var c=Object.keys(t);o=c.reduce(function(h,m){var b=t[m],x=r.validate(b,i);return x.isValid?h[m]=b:(n=!0,h[m]=x.sanitized),h},{})}else return i.allowUndefined&&typeof t=="undefined"?void 0:null;return n?o:t}catch{return null}},e.prototype._trim=function(t){return String.prototype.trim?t.trim():t.replace(/(^\s*)|(\s*$)/g,"")},e}();const y9=new Map;function qq(){y9.clear()}function Lxe(e){return y9.get(e)}function Oxe(e,t){y9.set(e,t)}function qk(e){y9.delete(e)}var uy,Ug,Rxe=function(e){if("WebkitTransition"in e.style)uy="webkitTransitionEnd",Ug="webkitAnimationEnd";else{if(!("transition"in e.style))throw new Error("Your browser is not supported!");uy="transitionend",Ug="animationend"}},Hq=function(e){uy||Rxe(e)},Fxe=function(e,t){return t===void 0&&(t=e+"-active"),function(i){Hq(i);var r=!1,n=function(o){r||(r=!0,i.removeEventListener(uy,n),i.removeEventListener(Ug,n),i.classList.remove(e),i.classList.remove(t))};i.classList.add(e),i.addEventListener(uy,n),i.addEventListener(Ug,n),requestAnimationFrame(function(){i.classList.add(t)})}},Nxe=function(e,t){return t===void 0&&(t=e+"-active"),function(i,r){Hq(i);var n=!1,o=function(c){n||(n=!0,i.removeEventListener(uy,o),i.removeEventListener(Ug,o),r())};i.classList.add(e),i.addEventListener(uy,o),i.addEventListener(Ug,o),requestAnimationFrame(function(){i.classList.add(t)})}};const Dxe=$e.getLogger("esri.widgets.support.widgetUtils");function qg(e){const t=$o.acquire();for(let r=0;r<arguments.length;r++){const n=arguments[r],o=typeof n;if(o==="string")t.push(n);else if(Array.isArray(n))t.push.apply(t,n);else if(o==="object")for(const c in n)n[c]&&t.push(c)}const i=t.join(" ");return $o.release(t),i}(()=>{const e=new Map,t=new ResizeObserver(i=>{var r;qq();for(const n of i)(r=e.get(n.target))==null||r(n)});return(i,r,n)=>(e.has(i)&&Dxe.error("Already observing element",i),e.set(i,r),t.observe(i,n),uh(()=>{t.unobserve(i),e.delete(i)}))})();function Ms(e){const t=e==null?void 0:e.closest("[dir]");return t!==null&&t instanceof HTMLElement&&t.dir==="rtl"||document.dir==="rtl"}function jxe(e){return Ms(e)?"rtl":"ltr"}function Wq(e){const t="data-node-ref";this[e.getAttribute(t)]=null}function Fh(e){const t="data-node-ref";this[e.getAttribute(t)]=e}function Vxe(e,t){return(e==="enter"?Fxe:Nxe)(t)}const zxe=["dd","dl","dt","h1","h2","h3","h4","h5","h6","sub","sup","animate","animatetransform","circle","clippath","defs","ellipse","g","image","line","lineargradient","marker","mask","path","pattern","polygon","polyline","radialgradient","rect","stop","svg","switch","symbol","text","textpath","tspan","use"],Gxe=zxe.reduce((e,t)=>(e[t]=[],e),{}),Bxe=["align","alink","alt","bgcolor","border","cellpadding","cellspacing","class","color","cols","colspan","coords","d","dir","face","height","hspace","ismap","lang","marginheight","marginwidth","multiple","nohref","noresize","noshade","nowrap","ref","rel","rev","rows","rowspan","scrolling","shape","span","summary","tabindex","title","usemap","valign","value","vlink","vspace","width"],Jq=new Pxe({whiteList:Gxe,onTagAttr:(e,t,i)=>{const r=`${t}="${i}"`;if(Bxe.includes(t))return r},stripIgnoreTag:!0,stripIgnoreTagBody:["script","style"]},!0);function Zq(e,t){const i=e.getBoundingClientRect(),r=t.getBoundingClientRect(),n=i.top+i.height,o=r.top+r.height,c=i.top,h=r.top;(n>o||c<h)&&e.scrollIntoView({block:"end"})}function Hg(e){return e==="Enter"||e===" "}const Kq="http://www.w3.org/",m9=`${Kq}2000/svg`,Yq=`${Kq}1999/xlink`;let g9,Xq=[],Hk=(e,t)=>{let i={};return Object.keys(e).forEach(r=>{i[r]=e[r]}),t&&Object.keys(t).forEach(r=>{i[r]=t[r]}),i},Wk=(e,t)=>e.vnodeSelector===t.vnodeSelector&&(e.properties&&t.properties?e.properties.key===t.properties.key&&e.properties.bind===t.properties.bind:!e.properties&&!t.properties),Qq=e=>{if(typeof e!="string")throw new Error("Style values must be strings")},Uxe=(e,t,i)=>{if(t.vnodeSelector!==""){for(let r=i;r<e.length;r++)if(Wk(e[r],t))return r}return-1},Jk=(e,t,i,r)=>{let n=e[t];if(n.vnodeSelector==="")return;let o=n.properties;if(!(o?o.key===void 0?o.bind:o.key:void 0)){for(let c=0;c<e.length;c++)if(c!==t){let h=e[c];if(Wk(h,n))throw new Error(`${i.vnodeSelector} had a ${n.vnodeSelector} child ${r==="added"?r:"removed"}, but there is now more than one. You must add unique key properties to make them distinguishable.`)}}},qxe=e=>{if(e.properties){let t=e.properties.enterAnimation;t&&t(e.domNode,e.properties)}},Zk=[],Kk=!1,eH=e=>{(e.children||[]).forEach(eH),e.properties&&e.properties.afterRemoved&&e.properties.afterRemoved.apply(e.properties.bind||e.properties,[e.domNode])},tH=()=>{Kk=!1,Zk.forEach(eH),Zk.length=0},iH=e=>{Zk.push(e),Kk||(Kk=!0,typeof window!="undefined"&&"requestIdleCallback"in window?window.requestIdleCallback(tH,{timeout:16}):setTimeout(tH,16))},rH=e=>{let t=e.domNode;if(e.properties){let i=e.properties.exitAnimation;if(i)return t.style.pointerEvents="none",void i(t,()=>{t.parentNode&&(t.parentNode.removeChild(t),iH(e))},e.properties)}t.parentNode&&(t.parentNode.removeChild(t),iH(e))},Hxe=(e,t,i)=>{if(!t)return;let r=i.eventHandlerInterceptor,n=Object.keys(t),o=n.length;for(let c=0;c<o;c++){let h=n[c],m=t[h];if(h==="className")throw new Error('Property "className" is not supported, use "class".');if(h==="class")Yk(e,m,!0);else if(h==="classes"){let b=Object.keys(m),x=b.length;for(let I=0;I<x;I++){let E=b[I];m[E]&&e.classList.add(E)}}else if(h==="styles"){let b=Object.keys(m),x=b.length;for(let I=0;I<x;I++){let E=b[I],k=m[E];k&&(Qq(k),i.styleApplyer(e,E,k))}}else if(h!=="key"&&m!=null){let b=typeof m;b==="function"?(h.lastIndexOf("on",0)===0&&(r&&(m=r(h,m,e,t)),h==="oninput"&&function(){let x=m;m=function(I){x.apply(this,[I]),I.target["oninput-value"]=I.target.value}}()),e[h]=m):i.namespace===m9?h==="href"?e.setAttributeNS(Yq,h,m):e.setAttribute(h,m):b==="string"&&h!=="value"?h==="innerHTML"?e[h]=Jq.sanitize(m):e.setAttribute(h,m):e[h]=m}}},Wxe=(e,t,i)=>{if(t)for(let r of t)Wg(r,e,void 0,i)},nH=(e,t,i)=>{Wxe(e,t.children,i),t.text&&(e.textContent=t.text),Hxe(e,t.properties,i),t.properties&&t.properties.afterCreate&&t.properties.afterCreate.apply(t.properties.bind||t.properties,[e,i,t.vnodeSelector,t.properties,t.children])},Wg=(e,t,i,r)=>{let n,o=0,c=e.vnodeSelector,h=t.ownerDocument;if(c==="")n=e.domNode=h.createTextNode(e.text),i!==void 0?t.insertBefore(n,i):t.appendChild(n);else{for(let m=0;m<=c.length;++m){let b=c.charAt(m);if(m===c.length||b==="."||b==="#"){let x=c.charAt(o-1),I=c.slice(o,m);x==="."?n.classList.add(I):x==="#"?n.id=I:(I==="svg"&&(r=Hk(r,{namespace:m9})),r.namespace!==void 0?n=e.domNode=h.createElementNS(r.namespace,I):(n=e.domNode=e.domNode||h.createElement(I),I==="input"&&e.properties&&e.properties.type!==void 0&&n.setAttribute("type",e.properties.type)),i!==void 0?t.insertBefore(n,i):n.parentNode!==t&&t.appendChild(n)),o=m+1}}nH(n,e,r)}},Yk=(e,t,i)=>{t&&t.split(" ").forEach(r=>{r&&e.classList.toggle(r,i)})},Jxe=(e,t,i,r)=>{if(!i)return;let n=!1,o=Object.keys(i),c=o.length;for(let h=0;h<c;h++){let m=o[h],b=i[m],x=t[m];if(m==="class")x!==b&&(Yk(e,x,!1),Yk(e,b,!0));else if(m==="classes"){let I=e.classList,E=Object.keys(b),k=E.length;for(let P=0;P<k;P++){let F=E[P],N=!!b[F];N!==!!x[F]&&(n=!0,N?I.add(F):I.remove(F))}}else if(m==="styles"){let I=Object.keys(b),E=I.length;for(let k=0;k<E;k++){let P=I[k],F=b[P];F!==x[P]&&(n=!0,F?(Qq(F),r.styleApplyer(e,P,F)):r.styleApplyer(e,P,""))}}else if(b||typeof x!="string"||(b=""),m==="value"){let I=e[m];I!==b&&(e["oninput-value"]?I===e["oninput-value"]:b!==x)&&(e[m]=b,e["oninput-value"]=void 0),b!==x&&(n=!0)}else if(b!==x){let I=typeof b;I==="function"&&r.eventHandlerInterceptor||(r.namespace===m9?m==="href"?e.setAttributeNS(Yq,m,b):e.setAttribute(m,b):I==="string"?m==="innerHTML"?e[m]=Jq.sanitize(b):m==="role"&&b===""?e.removeAttribute(m):e.setAttribute(m,b):e[m]!==b&&(e[m]=b),n=!0)}}return n},Zxe=(e,t,i,r,n)=>{if(i===r)return!1;r=r||Xq;let o,c=(i=i||Xq).length,h=r.length,m=0,b=0,x=!1;for(;b<h;){let I=m<c?i[m]:void 0,E=r[b];if(I!==void 0&&Wk(I,E))x=g9(I,E,n)||x,m++;else{let k=Uxe(i,E,m+1);if(k>=0){for(o=m;o<k;o++)rH(i[o]),Jk(i,o,e,"removed");x=g9(i[k],E,n)||x,m=k+1}else Wg(E,t,m<c?i[m].domNode:void 0,n),qxe(E),Jk(r,b,e,"added")}b++}if(c>m)for(o=m;o<c;o++)rH(i[o]),Jk(i,o,e,"removed");return x};g9=(e,t,i)=>{let r=e.domNode,n=!1;if(e===t)return!1;let o=!1;if(t.vnodeSelector===""){if(t.text!==e.text){let c=r.ownerDocument.createTextNode(t.text);return r.parentNode.replaceChild(c,r),t.domNode=c,n=!0,n}t.domNode=r}else t.vnodeSelector.lastIndexOf("svg",0)===0&&(i=Hk(i,{namespace:m9})),e.text!==t.text&&(o=!0,t.text===void 0?r.removeChild(r.firstChild):r.textContent=t.text),t.domNode=r,o=Zxe(t,r,e.children,t.children,i)||o,o=Jxe(r,e.properties,t.properties,i)||o,t.properties&&t.properties.afterUpdate&&t.properties.afterUpdate.apply(t.properties.bind||t.properties,[r,i,t.vnodeSelector,t.properties,t.children]);return o&&t.properties&&t.properties.updateAnimation&&t.properties.updateAnimation(r,t.properties,e.properties),n};let O_=(e,t)=>({getLastRender:()=>e,update:i=>{if(e.vnodeSelector!==i.vnodeSelector)throw new Error("The selector for the root VNode may not be changed. (consider using dom.merge and add one extra level to the virtual DOM)");let r=e;e=i,g9(r,i,t)},domNode:e.domNode});const Kxe={namespace:void 0,performanceLogger:()=>{},eventHandlerInterceptor:void 0,styleApplyer:(e,t,i)=>{t.charAt(0)==="-"?e.style.setProperty(t,i):e.style[t]=i}};let Jg=e=>Hk(Kxe,e),Kd={create:(e,t)=>(t=Jg(t),Wg(e,document.createElement("div"),void 0,t),O_(e,t)),append:(e,t,i)=>(i=Jg(i),Wg(t,e,void 0,i),O_(t,i)),insertBefore:(e,t,i)=>(i=Jg(i),Wg(t,e.parentNode,e,i),O_(t,i)),merge:(e,t,i)=>(i=Jg(i),t.domNode=e,nH(e,t,i),O_(t,i)),replace:(e,t,i)=>(i=Jg(i),Wg(t,e.parentNode,e,i),e.parentNode.removeChild(e),O_(t,i))},sH,Yxe=(e,t)=>{let i=[];for(;e&&e!==t;)i.push(e),e=e.parentNode;return i};sH=Array.prototype.find?(e,t)=>e.find(t):(e,t)=>e.filter(t)[0];let Xxe=(e,t)=>{let i=e;return t.forEach(r=>{i=i&&i.children?sH(i.children,n=>n.domNode===r):void 0}),i},Qxe=(e,t,i)=>{let r=function(n){i("domEvent",n);let o=t(),c=Yxe(n.currentTarget,o.domNode);c.reverse();let h,m=Xxe(o.getLastRender(),c);return e.scheduleRender(),m&&(h=m.properties[`on${n.type}`].apply(m.properties.bind||this,arguments)),i("domEventProcessed",n),h};return(n,o,c,h)=>r},v9=e=>{let t,i,r=Jg(e),n=r.performanceLogger,o=!0,c=!1,h=[],m=[],b=(I,E,k)=>{let P,F=()=>P;r.eventHandlerInterceptor=Qxe(t,F,n),P=I(E,k(),r),h.push(P),m.push(k)},x=()=>{if(i=void 0,o){o=!1,n("renderStart",void 0);for(let I=0;I<h.length;I++){let E=m[I]();n("rendered",void 0),h[I].update(E),n("patched",void 0)}n("renderDone",void 0),o=!0}};return t={renderNow:x,scheduleRender:()=>{i||c||(i=requestAnimationFrame(x))},stop:()=>{i&&(cancelAnimationFrame(i),i=void 0),c=!0},resume:()=>{c=!1,o=!0,t.scheduleRender()},append:(I,E)=>{b(Kd.append,I,E)},insertBefore:(I,E)=>{b(Kd.insertBefore,I,E)},merge:(I,E)=>{b(Kd.merge,I,E)},replace:(I,E)=>{b(Kd.replace,I,E)},detach:I=>{for(let E=0;E<m.length;E++)if(m[E]===I)return m.splice(E,1),h.splice(E,1)[0];throw new Error("renderFunction was not found")}},t},Yd=class extends Ye{constructor(){super(...arguments),this.items=new Xe,this._watchUpdatingTracking=new Bg,this._callbacks=new Map,this._projector=v9(),this._hiddenProjector=v9()}get needsRender(){return this.items.length>0}get updating(){var e,t;return(t=(e=this._watchUpdatingTracking)==null?void 0:e.updating)!=null?t:!1}initialize(){const e=document.createElement("div");e.className="esri-overlay-surface",this._set("surface",e),this._hiddenSurface=document.createElement("div"),this._hiddenSurface.setAttribute("style","visibility: hidden;"),e.appendChild(this._hiddenSurface),this._watchUpdatingTracking.addOnCollectionChange(()=>this.items,t=>{for(const i of t.added){const r=()=>i.render();this._callbacks.set(i,r),this._projector.append(this.surface,r)}for(const i of t.removed){const r=this._projector.detach(this._callbacks.get(i));this.surface.removeChild(r.domNode),this._callbacks.delete(i)}})}addItem(e){this.items.add(e)}removeItem(e){this.items.remove(e)}destroy(){this.items.removeAll(),this._callbacks.forEach(e=>this._projector.detach(e)),this._callbacks=null,this._projector=null,this._watchUpdatingTracking.destroy()}render(){this._projector.renderNow()}computeBoundingRect(e){const t=this._hiddenSurface,i=this._hiddenProjector;let r=null;const n=()=>(r=e.render(),r);i.append(t,n),i.renderNow();const o={left:0,top:0,right:0,bottom:0};if(r&&r.domNode){const c=r.domNode.getBoundingClientRect();o.left=c.left,o.top=c.top,o.right=c.right,o.bottom=c.bottom}for(i.detach(n);t.firstChild;)t.removeChild(t.firstChild);return o}overlaps(e,t){const i=this.computeBoundingRect(e),r=this.computeBoundingRect(t);return Math.max(i.left,r.left)<=Math.min(i.right,r.right)&&Math.max(i.top,r.top)<=Math.min(i.bottom,r.bottom)}get hasVisibleItems(){return this.items.some(e=>e.visible)}async prepare(){await document.fonts.load(this._fontString()).catch(()=>{})}renderCanvas(e){if(!this.items.some(i=>i.visible))return;const t=e.getContext("2d");t.save(),t.font=this._fontString(),this.items.forEach(i=>{t.save(),i.renderCanvas(t),t.restore()}),t.restore()}_fontString(){return`10px ${getComputedStyle(this.surface).fontFamily}`}};g([w({readOnly:!0})],Yd.prototype,"surface",void 0),g([w({readOnly:!0})],Yd.prototype,"items",void 0),g([w({readOnly:!0})],Yd.prototype,"needsRender",null),g([w({readOnly:!0})],Yd.prototype,"_watchUpdatingTracking",void 0),g([w({readOnly:!0})],Yd.prototype,"updating",null),Yd=g([te("esri.views.overlay.ViewOverlay")],Yd);const oH=Yd;function Zg(e,t,i,r){let n=null,o=1e3;typeof t=="number"?(o=t,r=i):(n=t!=null?t:null,o=i);let c,h=0;const m=()=>{h=0,e.apply(r,c)},b=(...x)=>{n&&n.apply(r,x),c=x,o?h||(h=setTimeout(m,o)):m()};return b.remove=()=>{h&&(clearTimeout(h),h=0)},b.forceUpdate=()=>{h&&(clearTimeout(h),m())},b.hasPendingUpdates=()=>!!h,b}const eSe="randomUUID"in crypto;function tSe(){if(eSe)return crypto.randomUUID();const e=crypto.getRandomValues(new Uint16Array(8));e[3]=4095&e[3]|16384,e[4]=16383&e[4]|32768;const t=i=>e[i].toString(16).padStart(4,"0");return t(0)+t(1)+"-"+t(2)+"-"+t(3)+"-"+t(4)+"-"+t(5)+t(6)+t(7)}const iSe={handleInterceptedEvent:(e,t,i,r)=>(e.scheduleRender(),t.properties[`on${r.type}`].apply(t.properties.bind||i,[r]))},rSe={namespace:void 0,performanceLogger:()=>{},eventHandlerInterceptor:void 0,styleApplyer:(e,t,i)=>{e.style[t]=i}},nSe=e=>K(K({},rSe),e),sSe=(e,t)=>{const i=[];for(;e&&e!==t;)i.push(e),e=e.parentNode;return i},oSe=(e,t)=>e.find(t),aH=(e,t,i=!1)=>{let r=e;return t.forEach((n,o)=>{const c=(r==null?void 0:r.children)?oSe(r.children,h=>h.domNode===n):void 0;i&&!c&&o!==t.length-1||(r=c)}),r},aSe=e=>{let t;const i=K(K({},iSe),e),r=nSe(i),n=r.performanceLogger;let o,c=!0,h=!1;const m=[],b=[],x=(E,k,P)=>{var B;let F;r.eventHandlerInterceptor=(z,q,J,X)=>function(Y){let ae;n("domEvent",Y);const he=sSe(Y.currentTarget,F.domNode),fe=he.some(xe=>{var Se;return customElements.get((Se=xe==null?void 0:xe.tagName)==null?void 0:Se.toLowerCase())});if(Y.eventPhase===Event.CAPTURING_PHASE||!fe)he.reverse(),ae=aH(F.getLastRender(),he);else{const xe=Y.composedPath(),Se=xe.slice(xe.indexOf(Y.currentTarget),xe.indexOf(F.domNode)).filter(Ae=>Ae.getRootNode()===Ae.ownerDocument).reverse();ae=aH(F.getLastRender(),Se,!0)}let ye;return ae&&(ye=i.handleInterceptedEvent(t,ae,this,Y)),n("domEventProcessed",Y),ye},(B=i.postProcessProjectionOptions)==null||B.call(i,r);const N=P();F=E(k,N,r),m.push(F),b.push(P),i.afterFirstVNodeRendered&&i.afterFirstVNodeRendered(F,N)};let I=()=>{if(o=void 0,c){c=!1,n("renderStart",void 0);for(let E=0;E<m.length;E++){const k=b[E]();n("rendered",void 0),m[E].update(k),n("patched",void 0)}n("renderDone",void 0),c=!0}};return i.modifyDoRenderImplementation&&(I=i.modifyDoRenderImplementation(I,m,b)),t={renderNow:I,scheduleRender:()=>{o||h||(o=requestAnimationFrame(I))},stop:()=>{o&&(cancelAnimationFrame(o),o=void 0),h=!0},resume:()=>{h=!1,c=!0,t.scheduleRender()},append:(E,k)=>{x(Kd.append,E,k)},insertBefore:(E,k)=>{x(Kd.insertBefore,E,k)},merge:(E,k)=>{x(Kd.merge,E,k)},replace:(E,k)=>{x(Kd.replace,E,k)},detach:E=>{for(let k=0;k<b.length;k++)if(b[k]===E)return b.splice(k,1),m.splice(k,1)[0];throw new Error("renderFunction was not found")}},t},fi={allRenderFn:!1,cmpDidLoad:!0,cmpDidUnload:!1,cmpDidUpdate:!0,cmpDidRender:!0,cmpWillLoad:!0,cmpWillUpdate:!0,cmpWillRender:!0,connectedCallback:!0,disconnectedCallback:!0,element:!0,event:!0,hasRenderFn:!0,lifecycle:!0,hostListener:!0,hostListenerTargetWindow:!0,hostListenerTargetDocument:!0,hostListenerTargetBody:!0,hostListenerTargetParent:!1,hostListenerTarget:!0,member:!0,method:!0,mode:!0,observeAttribute:!0,prop:!0,propMutable:!0,reflect:!0,scoped:!0,shadowDom:!0,slot:!0,cssAnnotations:!0,state:!0,style:!0,svg:!0,updatable:!0,vdomAttribute:!0,vdomXlink:!0,vdomClass:!0,vdomFunctional:!0,vdomKey:!0,vdomListener:!0,vdomRef:!0,vdomPropOrAttr:!0,vdomRender:!0,vdomStyle:!0,vdomText:!0,watchCallback:!0,taskQueue:!0,hotModuleReplacement:!1,isDebug:!1,isDev:!1,isTesting:!1,hydrateServerSide:!1,hydrateClientSide:!1,lifecycleDOMEvents:!1,lazyLoad:!1,profile:!1,slotRelocation:!0,appendChildSlotFix:!1,cloneNodeFix:!1,hydratedAttribute:!1,hydratedClass:!0,safari10:!1,scriptDataOpts:!1,scopedSlotTextContentFix:!1,shadowDomShim:!1,slotChildNodesFix:!1,invisiblePrehydration:!0,propBoolean:!0,propNumber:!0,propString:!0,cssVarShim:!1,constructableCSS:!0,cmpShouldUpdate:!0,devTools:!1,dynamicImportShim:!1,shadowDelegatesFocus:!0,initializeNextTick:!1,asyncLoading:!1,asyncQueue:!1,transformTagName:!1,attachStyles:!0};let Kg,lH,b9,cH=!1,w9=!1,Xk=!1,ja=!1,uH=null,Qk=!1;const NJe={isDev:!!fi.isDev,isBrowser:!0,isServer:!1,isTesting:!!fi.isTesting},DJe=e=>{const t=new URL(e,Bs.$resourcesUrl$);return t.origin!==e1.location.origin?t.href:t.pathname},lSe=e=>Bs.$resourcesUrl$=e,hy=(e,t="")=>()=>{},hH="http://www.w3.org/1999/xlink",pH={},cSe="http://www.w3.org/2000/svg",uSe="http://www.w3.org/1999/xhtml",hSe=e=>e!=null,e7=e=>(e=typeof e,e==="object"||e==="function"),dH=(e,t,...i)=>{let r=null,n=null,o=null,c=!1,h=!1;const m=[],b=I=>{for(let E=0;E<I.length;E++)r=I[E],Array.isArray(r)?b(r):r!=null&&typeof r!="boolean"&&((c=typeof e!="function"&&!e7(r))&&(r=String(r)),c&&h?m[m.length-1].$text$+=r:m.push(c?_9(null,r):r),h=c)};if(b(i),t&&(fi.isDev&&e==="input"&&ySe(t),fi.vdomKey&&t.key&&(n=t.key),fi.slotRelocation&&t.name&&(o=t.name),fi.vdomClass)){const I=t.className||t.class;I&&(t.class=typeof I!="object"?I:Object.keys(I).filter(E=>I[E]).join(" "))}if(fi.isDev&&m.some(fH)&&BSe(`The <Host> must be the single root component. Make sure:
- You are NOT using hostData() and <Host> in the same component.
- <Host> is used once, and it's the single root component of the render() function.`),fi.vdomFunctional&&typeof e=="function")return e(t===null?{}:t,m,dSe);const x=_9(e,null);return x.$attrs$=t,m.length>0&&(x.$children$=m),fi.vdomKey&&(x.$key$=n),fi.slotRelocation&&(x.$name$=o),x},_9=(e,t)=>{const i={$flags$:0,$tag$:e,$text$:t,$elm$:null,$children$:null};return fi.vdomAttribute&&(i.$attrs$=null),fi.vdomKey&&(i.$key$=null),fi.slotRelocation&&(i.$name$=null),i},pSe={},fH=e=>e&&e.$tag$===pSe,dSe={forEach:(e,t)=>e.map(yH).forEach(t),map:(e,t)=>e.map(yH).map(t).map(fSe)},yH=e=>({vattrs:e.$attrs$,vchildren:e.$children$,vkey:e.$key$,vname:e.$name$,vtag:e.$tag$,vtext:e.$text$}),fSe=e=>{if(typeof e.vtag=="function"){const i=Object.assign({},e.vattrs);return e.vkey&&(i.key=e.vkey),e.vname&&(i.name=e.vname),dH(e.vtag,i,...e.vchildren||[])}const t=_9(e.vtag,e.vtext);return t.$attrs$=e.vattrs,t.$children$=e.vchildren,t.$key$=e.vkey,t.$name$=e.vname,t},ySe=e=>{const t=Object.keys(e),i=t.indexOf("value");if(i===-1)return;const r=t.indexOf("type"),n=t.indexOf("min"),o=t.indexOf("max"),c=t.indexOf("step");(i<r||i<n||i<o||i<c)&&LH('The "value" prop of <input> should be set after "min", "max", "type" and "step"')},mSe=e=>USe.map(t=>t(e)).find(t=>!!t),gSe=(e,t)=>e!=null&&!e7(e)?t&4?e==="false"?!1:e===""||!!e:t&2?parseFloat(e):t&1?String(e):e:e,vSe=e=>fi.lazyLoad?Qg(e).$hostElement$:e,jJe=(e,t,i)=>{const r=vSe(e);return{emit:n=>(fi.isDev&&!r.isConnected&&LH(`The "${t}" event was emitted, but the dispatcher node is no longer connected to the dom.`),bSe(r,t,{bubbles:!!(i&4),composed:!!(i&2),cancelable:!!(i&1),detail:n}))}},bSe=(e,t,i)=>{const r=Bs.ce(t,i);return e.dispatchEvent(r),r},mH=new WeakMap,wSe=(e,t,i)=>{let r=M9.get(e);WSe&&i?(r=r||new CSSStyleSheet,typeof r=="string"?r=t:r.replaceSync(t)):r=t,M9.set(e,r)},_Se=(e,t,i,r)=>{let n=gH(t,i);const o=M9.get(n);if(e=e.nodeType===11?e:yc,o)if(typeof o=="string"){e=e.head||e;let c=mH.get(e),h;c||mH.set(e,c=new Set),c.has(n)||(h=yc.createElement("style"),h.innerHTML=o,e.insertBefore(h,e.querySelector("link")),c&&c.add(n))}else e.adoptedStyleSheets.includes(o)||(e.adoptedStyleSheets=[...e.adoptedStyleSheets,o]);return n},xSe=e=>{const t=e.$cmpMeta$,i=e.$hostElement$,r=t.$flags$,n=hy("attachStyles",t.$tagName$),o=_Se(I9&&i.shadowRoot?i.shadowRoot:i.getRootNode(),t,e.$modeName$);r&10&&(i["s-sc"]=o,i.classList.add(o+"-h"),r&2&&i.classList.add(o+"-s")),n()},gH=(e,t)=>"sc-"+(t&&e.$flags$&32?e.$tagName$+"-"+t:e.$tagName$),vH=(e,t,i,r,n,o)=>{if(i!==r){let c=AH(e,t),h=t.toLowerCase();if(t==="class"){const m=e.classList,b=bH(i),x=bH(r);m.remove(...b.filter(I=>I&&!x.includes(I))),m.add(...x.filter(I=>I&&!b.includes(I)))}else if(t==="style"){for(const m in i)(!r||r[m]==null)&&(m.includes("-")?e.style.removeProperty(m):e.style[m]="");for(const m in r)(!i||r[m]!==i[m])&&(m.includes("-")?e.style.setProperty(m,r[m]):e.style[m]=r[m])}else if(t!=="key")if(t==="ref")r&&r(e);else if(!e.__lookupSetter__(t)&&t[0]==="o"&&t[1]==="n")t[2]==="-"?t=t.slice(3):AH(e1,h)?t=h.slice(2):t=h[2]+t.slice(3),i&&Bs.rel(e,t,i,!1),r&&Bs.ael(e,t,r,!1);else{const m=e7(r);if((c||m&&r!==null)&&!n)try{if(e.tagName.includes("-"))e[t]=r;else{const x=r==null?"":r;t==="list"?c=!1:(i==null||e[t]!=x)&&(e[t]=x)}}catch{}let b=!1;h!==(h=h.replace(/^xlink\:?/,""))&&(t=h,b=!0),r==null||r===!1?(r!==!1||e.getAttribute(t)==="")&&(b?e.removeAttributeNS(hH,t):e.removeAttribute(t)):(!c||o&4||n)&&!m&&(r=r===!0?"":r,b?e.setAttributeNS(hH,t,r):e.setAttribute(t,r))}}},SSe=/\s/,bH=e=>e?e.split(SSe):[],wH=(e,t,i,r)=>{const n=t.$elm$.nodeType===11&&t.$elm$.host?t.$elm$.host:t.$elm$,o=e&&e.$attrs$||pH,c=t.$attrs$||pH;for(r in o)r in c||vH(n,r,o[r],void 0,i,t.$flags$);for(r in c)vH(n,r,o[r],c[r],i,t.$flags$)},x9=(e,t,i,r)=>{const n=t.$children$[i];let o=0,c,h,m;if(cH||(Xk=!0,n.$tag$==="slot"&&(Kg&&r.classList.add(Kg+"-s"),n.$flags$|=n.$children$?2:1)),n.$text$!==null)c=n.$elm$=yc.createTextNode(n.$text$);else if(n.$flags$&1)c=n.$elm$=yc.createTextNode("");else{if(ja||(ja=n.$tag$==="svg"),c=n.$elm$=yc.createElementNS(ja?cSe:uSe,n.$flags$&2?"slot-fb":n.$tag$),ja&&n.$tag$==="foreignObject"&&(ja=!1),wH(null,n,ja),hSe(Kg)&&c["s-si"]!==Kg&&c.classList.add(c["s-si"]=Kg),n.$children$)for(o=0;o<n.$children$.length;++o)h=x9(e,n,o,c),h&&c.appendChild(h);n.$tag$==="svg"?ja=!1:c.tagName==="foreignObject"&&(ja=!0)}return c["s-hn"]=b9,n.$flags$&(2|1)&&(c["s-sr"]=!0,c["s-cr"]=lH,c["s-sn"]=n.$name$||"",m=e&&e.$children$&&e.$children$[i],m&&m.$tag$===n.$tag$&&e.$elm$&&R_(e.$elm$,!1)),c},R_=(e,t)=>{Bs.$flags$|=1;const i=e.childNodes;for(let r=i.length-1;r>=0;r--){const n=i[r];n["s-hn"]!==b9&&n["s-ol"]&&(SH(n).insertBefore(n,t7(n)),n["s-ol"].remove(),n["s-ol"]=void 0,Xk=!0),t&&R_(n,t)}Bs.$flags$&=~1},_H=(e,t,i,r,n,o)=>{let c=e["s-cr"]&&e["s-cr"].parentNode||e,h;for(c.shadowRoot&&c.tagName===b9&&(c=c.shadowRoot);n<=o;++n)r[n]&&(h=x9(null,i,n,e),h&&(r[n].$elm$=h,c.insertBefore(h,t7(t))))},xH=(e,t,i,r,n)=>{for(;t<=i;++t)(r=e[t])&&(n=r.$elm$,EH(r),w9=!0,n["s-ol"]?n["s-ol"].remove():R_(n,!0),n.remove())},MSe=(e,t,i,r)=>{let n=0,o=0,c=0,h=0,m=t.length-1,b=t[0],x=t[m],I=r.length-1,E=r[0],k=r[I],P,F;for(;n<=m&&o<=I;)if(b==null)b=t[++n];else if(x==null)x=t[--m];else if(E==null)E=r[++o];else if(k==null)k=r[--I];else if(S9(b,E))Yg(b,E),b=t[++n],E=r[++o];else if(S9(x,k))Yg(x,k),x=t[--m],k=r[--I];else if(S9(b,k))(b.$tag$==="slot"||k.$tag$==="slot")&&R_(b.$elm$.parentNode,!1),Yg(b,k),e.insertBefore(b.$elm$,x.$elm$.nextSibling),b=t[++n],k=r[--I];else if(S9(x,E))(b.$tag$==="slot"||k.$tag$==="slot")&&R_(x.$elm$.parentNode,!1),Yg(x,E),e.insertBefore(x.$elm$,b.$elm$),x=t[--m],E=r[++o];else{for(c=-1,h=n;h<=m;++h)if(t[h]&&t[h].$key$!==null&&t[h].$key$===E.$key$){c=h;break}c>=0?(F=t[c],F.$tag$!==E.$tag$?P=x9(t&&t[o],i,c,e):(Yg(F,E),t[c]=void 0,P=F.$elm$),E=r[++o]):(P=x9(t&&t[o],i,o,e),E=r[++o]),P&&SH(b.$elm$).insertBefore(P,t7(b.$elm$))}n>m?_H(e,r[I+1]==null?null:r[I+1].$elm$,i,r,o,I):o>I&&xH(t,n,m)},S9=(e,t)=>e.$tag$===t.$tag$?e.$tag$==="slot"?e.$name$===t.$name$:e.$key$===t.$key$:!1,t7=e=>e&&e["s-ol"]||e,SH=e=>(e["s-ol"]?e["s-ol"]:e).parentNode,Yg=(e,t)=>{const i=t.$elm$=e.$elm$,r=e.$children$,n=t.$children$,o=t.$tag$,c=t.$text$;let h;c===null?(ja=o==="svg"?!0:o==="foreignObject"?!1:ja,o==="slot"||wH(e,t,ja),r!==null&&n!==null?MSe(i,r,t,n):n!==null?(e.$text$!==null&&(i.textContent=""),_H(i,null,t,n,0,n.length-1)):r!==null&&xH(r,0,r.length-1),ja&&o==="svg"&&(ja=!1)):(h=i["s-cr"])?h.parentNode.textContent=c:e.$text$!==c&&(i.data=c)},MH=e=>{const t=e.childNodes;let i,r,n,o,c,h;for(r=0,n=t.length;r<n;r++)if(i=t[r],i.nodeType===1){if(i["s-sr"]){for(c=i["s-sn"],i.hidden=!1,o=0;o<n;o++)if(h=t[o].nodeType,t[o]["s-hn"]!==i["s-hn"]||c!==""){if(h===1&&c===t[o].getAttribute("slot")){i.hidden=!0;break}}else if(h===1||h===3&&t[o].textContent.trim()!==""){i.hidden=!0;break}}MH(i)}},fc=[],IH=e=>{let t,i,r,n,o,c,h=0;const m=e.childNodes,b=m.length;for(;h<b;h++){if(t=m[h],t["s-sr"]&&(i=t["s-cr"])&&i.parentNode)for(r=i.parentNode.childNodes,n=t["s-sn"],c=r.length-1;c>=0;c--)i=r[c],!i["s-cn"]&&!i["s-nr"]&&i["s-hn"]!==t["s-hn"]&&($H(i,n)?(o=fc.find(x=>x.$nodeToRelocate$===i),w9=!0,i["s-sn"]=i["s-sn"]||n,o?o.$slotRefNode$=t:fc.push({$slotRefNode$:t,$nodeToRelocate$:i}),i["s-sr"]&&fc.map(x=>{$H(x.$nodeToRelocate$,i["s-sn"])&&(o=fc.find(I=>I.$nodeToRelocate$===i),o&&!x.$slotRefNode$&&(x.$slotRefNode$=o.$slotRefNode$))})):fc.some(x=>x.$nodeToRelocate$===i)||fc.push({$nodeToRelocate$:i}));t.nodeType===1&&IH(t)}},$H=(e,t)=>e.nodeType===1?e.getAttribute("slot")===null&&t===""||e.getAttribute("slot")===t:e["s-sn"]===t?!0:t==="",EH=e=>{e.$attrs$&&e.$attrs$.ref&&e.$attrs$.ref(null),e.$children$&&e.$children$.map(EH)},ISe=(e,t)=>{const i=e.$hostElement$,r=e.$cmpMeta$,n=e.$vnode$||_9(null,null),o=fH(t)?t:dH(null,null,t);b9=i.tagName,r.$attrsToReflect$&&(o.$attrs$=o.$attrs$||{},r.$attrsToReflect$.map(([c,h])=>o.$attrs$[h]=i[c])),o.$tag$=null,o.$flags$|=4,e.$vnode$=o,o.$elm$=n.$elm$=i.shadowRoot||i,Kg=i["s-sc"],lH=i["s-cr"],cH=I9&&(r.$flags$&1)!=0,w9=!1,Yg(n,o);{if(Bs.$flags$|=1,Xk){IH(o.$elm$);let c,h,m,b,x,I,E=0;for(;E<fc.length;E++)c=fc[E],h=c.$nodeToRelocate$,h["s-ol"]||(m=yc.createTextNode(""),m["s-nr"]=h,h.parentNode.insertBefore(h["s-ol"]=m,h));for(E=0;E<fc.length;E++)if(c=fc[E],h=c.$nodeToRelocate$,c.$slotRefNode$){for(b=c.$slotRefNode$.parentNode,x=c.$slotRefNode$.nextSibling,m=h["s-ol"];m=m.previousSibling;)if(I=m["s-nr"],I&&I["s-sn"]===h["s-sn"]&&b===I.parentNode&&(I=I.nextSibling,!I||!I["s-nr"])){x=I;break}(!x&&b!==h.parentNode||h.nextSibling!==x)&&h!==x&&(!h["s-hn"]&&h["s-ol"]&&(h["s-hn"]=h["s-ol"].parentNode.nodeName),b.insertBefore(h,x))}else h.nodeType===1&&(h.hidden=!0)}w9&&MH(o.$elm$),Bs.$flags$&=~1,fc.length=0}},$Se=(e,t)=>{},i7=(e,t)=>{fi.taskQueue&&fi.updatable&&(e.$flags$|=16),$Se(e,e.$ancestorComponent$);const i=()=>ESe(e,t);return fi.taskQueue?KSe(i):i()},ESe=(e,t)=>{const i=e.$hostElement$,r=hy("scheduleUpdate",e.$cmpMeta$.$tagName$),n=i;let o;return t?o=Xg(n,"componentWillLoad"):o=Xg(n,"componentWillUpdate"),o=TH(o,()=>Xg(n,"componentWillRender")),r(),TH(o,()=>TSe(e,n,t))},TSe=async(e,t,i)=>{const r=e.$hostElement$,n=hy("update",e.$cmpMeta$.$tagName$);r["s-rc"],i&&xSe(e);const o=hy("render",e.$cmpMeta$.$tagName$);CSe(e,t,r),o(),n(),kSe(e)},CSe=(e,t,i)=>{const r=!1,n=!1,o=!0,c=!0;try{uH=t,t=(r||t.render)&&t.render(),c&&o&&(e.$flags$&=~16),(c||n)&&(e.$flags$|=2),(fi.hasRenderFn||fi.reflect)&&(fi.vdomRender||fi.reflect)&&(fi.hydrateServerSide||ISe(e,t))}catch(h){F_(h,e.$hostElement$)}return uH=null,null},kSe=e=>{const t=e.$cmpMeta$.$tagName$,i=e.$hostElement$,r=hy("postUpdate",t),n=i;e.$ancestorComponent$,Xg(n,"componentDidRender"),e.$flags$&64?(Xg(n,"componentDidUpdate"),r()):(e.$flags$|=64,Xg(n,"componentDidLoad"),r())},VJe=e=>{if(fi.updatable){const t=Qg(e),i=t.$hostElement$.isConnected;return i&&(t.$flags$&(2|16))==2&&i7(t,!1),i}return!1},Xg=(e,t,i)=>{if(e&&e[t])try{return e[t](i)}catch(r){F_(r)}},TH=(e,t)=>e&&e.then?e.then(t):t(),ASe=(e,t)=>Qg(e).$instanceValues$.get(t),PSe=(e,t,i,r)=>{const n=Qg(e),o=e,c=n.$instanceValues$.get(t),h=n.$flags$,m=o;i=gSe(i,r.$members$[t][0]);const b=Number.isNaN(c)&&Number.isNaN(i);if(i!==c&&!b){n.$instanceValues$.set(t,i);{if(r.$watchers$&&h&128){const I=r.$watchers$[t];I&&I.map(E=>{try{m[E](i,c,t)}catch(k){F_(k,o)}})}if((h&(2|16))==2){if(m.componentShouldUpdate&&m.componentShouldUpdate(i,c,t)===!1)return;i7(n,!1)}}}},LSe=(e,t,i)=>{if(t.$members$){e.watchers&&(t.$watchers$=e.watchers);const r=Object.entries(t.$members$),n=e.prototype;r.map(([o,[c]])=>{(c&31||c&32)&&Object.defineProperty(n,o,{get(){return ASe(this,o)},set(h){PSe(this,o,h,t)},configurable:!0,enumerable:!0})});{const o=new Map;n.attributeChangedCallback=function(c,h,m){Bs.jmp(()=>{const b=o.get(c);if(this.hasOwnProperty(b))m=this[b],delete this[b];else if(n.hasOwnProperty(b)&&typeof this[b]=="number"&&this[b]==m)return;this[b]=m===null&&typeof this[b]=="boolean"?!1:m})},e.observedAttributes=r.filter(([c,h])=>h[0]&15).map(([c,h])=>{const m=h[1]||c;return o.set(m,c),h[0]&512&&t.$attrsToReflect$.push([c,m]),m})}}return e},OSe=async(e,t,i,r,n)=>{if((t.$flags$&32)==0&&(n=e.constructor,t.$flags$|=32,customElements.whenDefined(i.$tagName$).then(()=>t.$flags$|=128),n.style)){let c=n.style;typeof c!="string"&&(c=c[t.$modeName$=mSe(e)]);const h=gH(i,t.$modeName$);if(!M9.has(h)){const m=hy("registerStyles",i.$tagName$);wSe(h,c,!!(i.$flags$&1)),m()}}t.$ancestorComponent$,(()=>i7(t,!0))()},RSe=e=>{},FSe=e=>{if((Bs.$flags$&1)==0){const t=Qg(e),i=t.$cmpMeta$,r=hy("connectedCallback",i.$tagName$);t.$flags$&1?(CH(e,t,i.$listeners$),RSe(t.$lazyInstance$)):(t.$flags$|=1,i.$flags$&(4|8)&&NSe(e),i.$members$&&Object.entries(i.$members$).map(([n,[o]])=>{if(o&31&&e.hasOwnProperty(n)){const c=e[n];delete e[n],e[n]=c}}),OSe(e,t,i)),r()}},NSe=e=>{const t=e["s-cr"]=yc.createComment("");t["s-cn"]=!0,e.insertBefore(t,e.firstChild)},DSe=e=>{if((Bs.$flags$&1)==0){const t=Qg(e);t.$rmListeners$&&(t.$rmListeners$.map(i=>i()),t.$rmListeners$=void 0)}},zJe=(e,t)=>{const i={$flags$:t[0],$tagName$:t[1]};fi.member&&(i.$members$=t[2]),fi.hostListener&&(i.$listeners$=t[3]),fi.watchCallback&&(i.$watchers$=e.$watchers$),fi.reflect&&(i.$attrsToReflect$=[]),fi.shadowDom&&!I9&&i.$flags$&1&&(i.$flags$|=8);const r=e.prototype.connectedCallback,n=e.prototype.disconnectedCallback;return Object.assign(e.prototype,{__registerHost(){GSe(this,i)},connectedCallback(){FSe(this),fi.connectedCallback&&r&&r.call(this)},disconnectedCallback(){DSe(this),fi.disconnectedCallback&&n&&n.call(this)},__attachShadow(){I9?fi.shadowDelegatesFocus?this.attachShadow({mode:"open",delegatesFocus:!!(i.$flags$&16)}):this.attachShadow({mode:"open"}):this.shadowRoot=this}}),e.is=i.$tagName$,LSe(e,i)},GJe=(e,t)=>t,CH=(e,t,i,r)=>{i&&i.map(([n,o,c])=>{const h=VSe(e,n),m=jSe(t,c),b=zSe(n);Bs.ael(h,o,m,b),(t.$rmListeners$=t.$rmListeners$||[]).push(()=>Bs.rel(h,o,m,b))})},jSe=(e,t)=>i=>{try{fi.lazyLoad||e.$hostElement$[t](i)}catch(r){F_(r)}},VSe=(e,t)=>t&4?yc:t&8?e1:t&16?yc.body:e,zSe=e=>qSe?{passive:(e&1)!=0,capture:(e&2)!=0}:(e&2)!=0,kH=new WeakMap,Qg=e=>kH.get(e),GSe=(e,t)=>{const i={$flags$:0,$hostElement$:e,$cmpMeta$:t,$instanceValues$:new Map};return fi.isDev&&(i.$renderCount$=0),fi.method&&fi.lazyLoad&&(i.$onInstancePromise$=new Promise(r=>i.$onInstanceResolve$=r)),fi.asyncLoading&&(i.$onReadyPromise$=new Promise(r=>i.$onReadyResolve$=r),e["s-p"]=[],e["s-rc"]=[]),CH(e,i,t.$listeners$),kH.set(e,i)},AH=(e,t)=>t in e,F_=(e,t)=>(0,console.error)(e,t),PH=fi.isTesting?["STENCIL:"]:["%cstencil","color: white;background:#4c47ff;font-weight: bold; font-size:10px; padding:2px 6px; border-radius: 5px"],BSe=(...e)=>console.error(...PH,...e),LH=(...e)=>console.warn(...PH,...e),M9=new Map,USe=[],e1=typeof window!="undefined"?window:{};fi.cssVarShim&&e1.CSS;const yc=e1.document||{head:{}},BJe=e1.HTMLElement||class{},Bs={$flags$:0,$resourcesUrl$:"",jmp:e=>e(),raf:e=>requestAnimationFrame(e),ael:(e,t,i,r)=>e.addEventListener(t,i,r),rel:(e,t,i,r)=>e.removeEventListener(t,i,r),ce:(e,t)=>new CustomEvent(e,t)},I9=fi.shadowDomShim&&fi.shadowDom?(()=>(yc.head.attachShadow+"").indexOf("[native")>-1)():!0,qSe=(()=>{let e=!1;try{yc.addEventListener("e",null,Object.defineProperty({},"passive",{get(){e=!0}}))}catch{}return e})(),HSe=e=>Promise.resolve(e),WSe=fi.constructableCSS?(()=>{try{return new CSSStyleSheet,typeof new CSSStyleSheet().replaceSync=="function"}catch{}return!1})():!1,OH=[],RH=[],JSe=(e,t)=>i=>{e.push(i),Qk||(Qk=!0,t&&Bs.$flags$&4?ZSe(r7):Bs.raf(r7))},FH=e=>{for(let t=0;t<e.length;t++)try{e[t](performance.now())}catch(i){F_(i)}e.length=0},r7=()=>{FH(OH),FH(RH),(Qk=OH.length>0)&&Bs.raf(r7)},ZSe=e=>HSe().then(e),KSe=JSe(RH,!0);/*!
 * All material copyright ESRI, All Rights Reserved, unless otherwise specified.
 * See https://github.com/Esri/calcite-components/blob/master/LICENSE.md for details.
 * v1.0.0-beta.97
 */function YSe(e){return e.map(t=>{let i="";for(let r=0;r<t;r++)i+=((1+Math.random())*65536|0).toString(16).substring(1);return i}).join("-")}const UJe=()=>YSe([2,1,1,1,3]);/*!
 * All material copyright ESRI, All Rights Reserved, unless otherwise specified.
 * See https://github.com/Esri/calcite-components/blob/master/LICENSE.md for details.
 * v1.0.0-beta.97
 */const NH="calcite-theme-auto",DH="calcite-theme-dark",XSe="calcite-theme-light",qJe={autoTheme:NH,darkTheme:DH,lightTheme:XSe,rtl:"calcite--rtl"},HJe={loading:"Loading"};function WJe(e){const t="dir",i=`[${t}]`,r=QSe(e,i);return r?r.getAttribute(t):"ltr"}function JJe(e,t,i){const r=`[${t}]`,n=e.closest(r);return n?n.getAttribute(t):i}function jH(e){return e.getRootNode()}function VH(e){return e.host||null}function ZJe(e,{selector:t,id:i}){function r(n){if(!n)return null;n.assignedSlot&&(n=n.assignedSlot);const o=jH(n),c=i?"getElementById"in o?o.getElementById(i):null:t?o.querySelector(t):null,h=VH(o);return c||(h?r(h):null)}return r(e)}function QSe(e,t){function i(r){return r?r.closest(t)||i(VH(jH(r))):null}return i(e)}function e5e(e,t){return zH(e,t)}function zH(e,t){if(!e)return;const i=t(e);if(i!==void 0)return i;const{parentNode:r}=e;return zH(r instanceof ShadowRoot?r.host:r,t)}function KJe(e,t){return!!e5e(t,i=>i===e?!0:void 0)}function t5e(e){return typeof(e==null?void 0:e.setFocus)=="function"}async function YJe(e){if(!!e)return t5e(e)?e.setFocus():e.focus()}const N_=":not([slot])";function XJe(e,t,i){t&&!Array.isArray(t)&&typeof t!="string"&&(i=t,t=null);const r=t?Array.isArray(t)?t.map(n=>`[slot="${n}"]`).join(","):`[slot="${t}"]`:N_;return(i==null?void 0:i.all)?i5e(e,r,i):r5e(e,r,i)}function GH(e,t){return e?Array.from(e.children||[]).filter(i=>i==null?void 0:i.matches(t)):[]}function i5e(e,t,i){let r=t===N_?GH(e,N_):Array.from(e.querySelectorAll(t));r=i&&i.direct===!1?r:r.filter(o=>o.parentElement===e),r=(i==null?void 0:i.matches)?r.filter(o=>o==null?void 0:o.matches(i.matches)):r;const n=i==null?void 0:i.selector;return n?r.map(o=>Array.from(o.querySelectorAll(n))).reduce((o,c)=>[...o,...c],[]).filter(o=>!!o):r}function r5e(e,t,i){let r=t===N_?GH(e,N_)[0]||null:e.querySelector(t);r=i&&i.direct===!1||(r==null?void 0:r.parentElement)===e?r:null,r=(i==null?void 0:i.matches)?(r==null?void 0:r.matches(i.matches))?r:null:r;const n=i==null?void 0:i.selector;return n?r==null?void 0:r.querySelector(n):r}function QJe(e,t,i){if(typeof t=="string"&&t!=="")return t;if(t==="")return e[i]}function eZe(e){return Boolean(e).toString()}function tZe(e){return!!(e.isPrimary&&e.button===0)}/*!
 * All material copyright ESRI, All Rights Reserved, unless otherwise specified.
 * See https://github.com/Esri/calcite-components/blob/master/LICENSE.md for details.
 * v1.0.0-beta.97
 */function BH(){const{classList:e}=document.body,t=window.matchMedia("(prefers-color-scheme: dark)").matches,i=()=>e.contains(DH)||e.contains(NH)&&t?"dark":"light",r=c=>document.body.dispatchEvent(new CustomEvent("calciteThemeChange",{bubbles:!0,detail:{theme:c}})),n=c=>{o!==c&&r(c),o=c};let o=i();r(o),window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",c=>n(c.matches?"dark":"light")),new MutationObserver(()=>n(i())).observe(document.body,{attributes:!0,attributeFilter:["class"]})}function n5e(){typeof window!="undefined"&&typeof location!="undefined"&&typeof document!="undefined"&&window.location===location&&window.document===document&&(document.readyState==="interactive"?BH():document.addEventListener("DOMContentLoaded",()=>BH(),{once:!0}))}const s5e=n5e;s5e();let UH;function o5e(){lSe(Ra(_i(UH)))}UH="components/assets";const qH=Symbol("widget"),a5e=[],l5e={},$9=new WeakMap;function HH(e,t){let i=t.children;if(i&&i.length)for(let n=0;n<i.length;++n)i[n]=HH(e,i[n]);else i=a5e;const r=t.vnodeSelector;if(n7(r)){const n=t.properties||l5e,o=n.key||r;return{vnodeSelector:"div",properties:{key:o,afterCreate:c5e,afterUpdate:u5e,afterRemoved:WH,parentWidget:e,widgetConstructor:r,widgetProperties:Ce(K({},n),{key:o,children:i})},children:void 0,text:void 0,domNode:null}}return t}function c5e(e,t,i,{parentWidget:r,widgetConstructor:n,widgetProperties:o}){var h;const c=new n(o);c.container=e,$9.set(e,c),(h=c.afterCreate)==null||h.call(c,c,e),r._internalHandles.add(uh(()=>WH(e)))}function u5e(e,t,i,{widgetProperties:r}){var o;const n=$9.get(e);n&&(n.set(r),(o=n.afterUpdate)==null||o.call(n,n,e))}function WH(e){const t=$9.get(e);t&&(t.destroy(),$9.delete(e))}function n7(e){return typeof e=="function"&&e[qH]}const JH=new Set;function h5e(e){JH.add(e),e.finally(()=>JH.delete(e))}const p5e="esri.widgets.Widget";let d5e=0;const f5e={widgetIcon:"esri-icon-checkbox-unchecked"};function ZH(e,t){for(const i in t)e[i]!=null&&(typeof e[i]=="object"&&typeof t[i]=="object"?ZH(e[i],t==null?void 0:t[i]):e[i]=t[i]);return e}const y5e=aSe({postProcessProjectionOptions(e){const t=e.eventHandlerInterceptor,i=/capture$/i;e.eventHandlerInterceptor=(r,n,o,c)=>{const h=t==null?void 0:t(r,n,o,c),m=i.test(r);if(!((r=r.replace(i,"")).toLowerCase()in o)||m){const b=r[2].toLowerCase()+r.slice(3),x=k=>h==null?void 0:h.call(o,k);o.addEventListener(b,x,m);const I=()=>o.removeEventListener(b,x,m),E=c.afterRemoved;c.afterRemoved=k=>{E==null||E(k),I()}}return h}},handleInterceptedEvent(e,t,i,r){const{eventPhase:n,type:o}=r,c=n===Event.CAPTURING_PHASE;let h=`on${o}${c?"capture":""}`;const m=t.properties;(m&&h in m||(h=`on${o[0].toUpperCase()}${o.slice(1)}${c?"Capture":""}`,m&&h in m))&&(qq(),e.scheduleRender(),m[h].call(m.bind||i,r))}});let s7=!1,jn=class extends o_(Or.EventedAccessor){constructor(e,t){super(e,t),this._attached=!1,this._internalHandles=new Ti,this._projector=y5e,this._readyForTrueRender=!1,this.iconClass=f5e.widgetIcon,this.key=this,this._loadLocale=hw(async()=>{if(this._messageBundleProps&&this._messageBundleProps.length){const o=await Mr(this._messageBundleProps.map(async({bundlePath:c,propertyName:h})=>{let m=await z5(c);this.uiStrings&&Object.keys(this.uiStrings)&&(m=ZH(_e(m),this.uiStrings)),this[h]=m}));for(const c of o)c.error&&$e.getLogger(this.declaredClass).error("widget-intl:locale-error",this.declaredClass,c.error)}await this.loadLocale()}),o5e();const i="esri-widget-uid-"+tSe(),r=this.render.bind(this);this._trackingTarget=new IS(()=>this.scheduleRender());const n=()=>{var x;if(!this._readyForTrueRender||this.destroyed)return null;if(!this.visible)return{vnodeSelector:"div",properties:{key:i,class:"",styles:{display:"none"}},domNode:null,children:void 0,text:void 0};const o=r();let{properties:c}=o;c||(o.properties=c={});let{key:h,styles:m}=c;h||(c.key=i),m||(c.styles=m={}),m.display||(m.display="");let b=0;return(x=o.children)==null||x.forEach(I=>{if(n7(I.vnodeSelector))return;let{properties:E}=I;E||(I.properties=E={}),E.key||(E.key=`${this.id}--${b++}`)}),HH(this,o)};this.render=()=>{var c;if(s7)return n();let o=(c=Lxe(this))!=null?c:null;if(o)return o;this._trackingTarget.clear(),s7=!0;try{o=ph(this._trackingTarget,n)}catch(h){throw console.error(h),h}finally{s7=!1}return o&&Oxe(this,o),o},this.addResolvingPromise(this._resourcesFetch=this.beforeFirstRender().then(()=>{this._readyForTrueRender=!0,this._postInitialize()})),h5e(this._resourcesFetch)}normalizeCtorArgs(e,t){const i=K({},e);return t&&(i.container=t),i}postInitialize(){}beforeFirstRender(){return Promise.all([this.loadDependencies(),this._loadLocale()]).then(()=>{}).catch(uT)}async loadDependencies(){}async loadLocale(){}destroy(){this.destroyed||(li(this._trackingTarget),li(this.viewModel),this._detach(this.container),this._set("container",null),this._internalHandles.destroy(),this._emitter.clear(),this.render=()=>null,this._projector=null,qk(this))}set container(e){this._get("container")||this._set("container",e)}castContainer(e){return a9(e)}get domNode(){return this.container}set domNode(e){this.container=e}get id(){return this._get("id")||this.get("container.id")||Date.now().toString(16)+"-widget-"+d5e++}set id(e){e&&this._set("id",e)}get label(){return this.declaredClass.split(".").pop()}set label(e){this._overrideIfSome("label",e)}get renderable(){return this._resourcesFetch}get visible(){return this._get("visible")}set visible(e){this._set("visible",e)}get test(){return{projector:this._projector}}render(){throw new Error("not implemented")}scheduleRender(){this.destroyed||(qk(this),this._projector.scheduleRender())}classes(...e){return qg.apply(this,e)}renderNow(){qk(this),this._projector.renderNow()}_postInitialize(){var t;if(this.destroyed)return;this.scheduleRender(),((t=this._delegatedEventNames)==null?void 0:t.length)&&this._internalHandles.add(we(()=>this.viewModel,(i,r)=>{r&&this._internalHandles.remove("delegated-events"),i&&wS(i)&&this._internalHandles.add(this._delegatedEventNames.map(n=>cw(i,n,o=>{this.emit(n,o)})),"delegated-events")},St)),this.postInitialize();const e=async()=>{await this._loadLocale().catch(uT),this.scheduleRender()};this._internalHandles.add([US(e),we(()=>this.uiStrings,e),os(()=>this.container,i=>{this.destroyed||this._attach(i)},{initial:!0,once:!0})])}_attach(e){e&&(this._projector.merge(e,this.render),this._attached=!0)}_detach(e){var t;this._attached&&(this._projector.detach(this.render),this._attached=!1),(t=e==null?void 0:e.parentNode)==null||t.removeChild(e)}};jn[qH]=!0,g([w()],jn.prototype,"_readyForTrueRender",void 0),g([w({value:null})],jn.prototype,"container",null),g([Dt("container")],jn.prototype,"castContainer",null),g([w()],jn.prototype,"domNode",null),g([w()],jn.prototype,"iconClass",void 0),g([w()],jn.prototype,"id",null),g([w()],jn.prototype,"label",null),g([w()],jn.prototype,"renderable",null),g([w()],jn.prototype,"uiStrings",void 0),g([w()],jn.prototype,"viewModel",void 0),g([w({value:!0})],jn.prototype,"visible",null),g([w()],jn.prototype,"key",void 0),g([w()],jn.prototype,"children",void 0),g([w()],jn.prototype,"afterCreate",void 0),g([w()],jn.prototype,"afterUpdate",void 0),g([w()],jn.prototype,"afterRemoved",void 0),jn=g([te(p5e)],jn);const ki=jn;function KH(e){return 32+e.length}function YH(e){return 16}function iZe(e){if(!e)return 0;let t=QH;for(const i in e)if(e.hasOwnProperty(i)){const r=e[i];switch(typeof r){case"string":t+=KH(r);break;case"number":t+=YH();break;case"boolean":t+=4}}return t}function m5e(e){if(!e)return 0;if(Array.isArray(e))return g5e(e);let t=QH;for(const i in e)e.hasOwnProperty(i)&&(t+=XH(e[i]));return t}function g5e(e){const t=e.length;if(t===0||typeof e[0]=="number")return 32+8*t;let i=eW;for(let r=0;r<t;r++)i+=XH(e[r]);return i}function XH(e){switch(typeof e){case"object":return m5e(e);case"string":return KH(e);case"number":return YH();case"boolean":return 4;default:return 8}}function rZe(e,t){return eW+e.length*t}const QH=32,eW=32;var t1;(function(e){e[e.KILOBYTES=1024]="KILOBYTES",e[e.MEGABYTES=1048576]="MEGABYTES",e[e.GIGABYTES=1073741824]="GIGABYTES"})(t1||(t1={}));function tW(e,t,i){return e.units[t][i]}function i1(e,t,i,r=2,n="abbr"){return`${Jo(t,{minimumFractionDigits:r,maximumFractionDigits:r,signDisplay:t>0?"never":"exceptZero"})} ${tW(e,i,n)}`}function E9(e,t,i,r=2,n="abbr"){return`${Jo(t,{minimumFractionDigits:r,maximumFractionDigits:r,signDisplay:"exceptZero"})} ${tW(e,i,n)}`}function nZe(e,t,i,r=2,n="abbr"){const o=DU(t,i);return i1(e,ji(t,i,o),o,r,n)}function sZe(e,t,i,r=2,n="abbr"){const o=DU(t,i);return E9(e,ji(t,i,o),o,r,n)}function oZe(e,t,i,r=2,n="abbr"){const o=jU(t,i);return i1(e,ji(t,i,o),o,r,n)}function aZe(e,t,i,r=2,n="abbr"){const o=jU(t,i);return E9(e,ji(t,i,o),o,r,n)}function lZe(e,t,i,r=2,n="abbr"){const o=VU(t,i);return i1(e,ji(t,i,o),o,r,n)}function cZe(e,t,i,r=2,n="abbr"){const o=VU(t,i);return E9(e,ji(t,i,o),o,r,n)}function uZe(e,t,i,r=2,n="abbr"){const o=zU(t,i);return i1(e,ji(t,i,o),o,r,n)}function hZe(e,t,i,r=2,n="abbr"){const o=zU(t,i);return E9(e,ji(t,i,o),o,r,n)}function pZe(e,t,i,r=2,n="abbr"){const o=h2e(t,i);return i1(e,ji(t,i,o),o,r,n)}function dZe(e,t,i,r=2,n="abbr"){const o=p2e(t,i);return i1(e,ji(t,i,o),o,r,n)}function fZe(e,t,i,r,n){n=ws(n,2);let o=fU.normalize(v5e(ji(e,t,"degrees"),i,r),0,!0);const c={style:"unit",unitDisplay:"narrow",unit:"degree",maximumFractionDigits:n,minimumFractionDigits:n,signDisplay:o>0?"never":"exceptZero"};return o=rW(o,c),Jo(o,c)}function yZe(e,t,i,r,n){i!==r&&(e=-e);const o={style:"unit",unitDisplay:"narrow",unit:"degree",maximumFractionDigits:n=ws(n,2),minimumFractionDigits:n,signDisplay:"exceptZero"};let c=ji(e,t,"degrees")%360;return c=rW(c,o),Jo(c,o)}const iW=new Map;function rW(e,t){const i=JSON.stringify(t);let r=iW.get(i);return r||(r=new Intl.NumberFormat("en-US",t),iW.set(i,r)),/\-?\+?360/.test(r.format(e))?0:e}function v5e(e,t,i){if(t===i)return e;switch(i){case"arithmetic":return b5e(e);case"geographic":return w5e(e)}}function b5e(e){return 90-e}function w5e(e){return-e-90}const nW=["B","kB","MB","GB","TB"];function _5e(e,t){let i=t===0?0:Math.floor(Math.log(t)/Math.log(t1.KILOBYTES));i=Vs(i,0,nW.length-1);const r=Jo(t/t1.KILOBYTES**i,{maximumFractionDigits:2});return Kc(e.units.bytes[nW[i]],{fileSize:r})}function x5e(e){const{exifInfo:t,exifName:i,tagName:r}=e;if(!t||!i||!r)return null;const n=t.find(o=>o.name===i);return n?S5e({tagName:r,tags:n.tags}):null}function S5e(e){const{tagName:t,tags:i}=e;if(!i||!t)return null;const r=i.find(n=>n.name===t);return r&&r.value||null}var o7;const M5e={1:{id:1,rotation:0,mirrored:!1},2:{id:2,rotation:0,mirrored:!0},3:{id:3,rotation:180,mirrored:!1},4:{id:4,rotation:180,mirrored:!0},5:{id:5,rotation:-90,mirrored:!0},6:{id:6,rotation:90,mirrored:!1},7:{id:7,rotation:90,mirrored:!0},8:{id:8,rotation:-90,mirrored:!1}};let aa=o7=class extends ke{constructor(e){super(e),this.contentType=null,this.exifInfo=null,this.id=null,this.globalId=null,this.keywords=null,this.name=null,this.parentGlobalId=null,this.parentObjectId=null,this.size=null,this.url=null}get orientationInfo(){const{exifInfo:e}=this,t=x5e({exifName:"Exif IFD0",tagName:"Orientation",exifInfo:e});return M5e[t]||null}clone(){return new o7({contentType:this.contentType,exifInfo:this.exifInfo,id:this.id,globalId:this.globalId,keywords:this.keywords,name:this.name,parentGlobalId:this.parentGlobalId,parentObjectId:this.parentObjectId,size:this.size,url:this.url})}};g([w({type:String})],aa.prototype,"contentType",void 0),g([w()],aa.prototype,"exifInfo",void 0),g([w({readOnly:!0})],aa.prototype,"orientationInfo",null),g([w({type:Ri})],aa.prototype,"id",void 0),g([w({type:String})],aa.prototype,"globalId",void 0),g([w({type:String})],aa.prototype,"keywords",void 0),g([w({type:String})],aa.prototype,"name",void 0),g([w({json:{read:!1}})],aa.prototype,"parentGlobalId",void 0),g([w({json:{read:!1}})],aa.prototype,"parentObjectId",void 0),g([w({type:Ri})],aa.prototype,"size",void 0),g([w({json:{read:!1}})],aa.prototype,"url",void 0),aa=o7=g([te("esri.layers.support.AttachmentInfo")],aa);const sW=aa;var a7;let Is=a7=class extends ke{constructor(e){super(e),this.attachmentTypes=null,this.attachmentsWhere=null,this.cacheHint=void 0,this.keywords=null,this.globalIds=null,this.name=null,this.num=null,this.objectIds=null,this.returnMetadata=!1,this.size=null,this.start=null,this.where=null}writeStart(e,t){t.resultOffset=this.start,t.resultRecordCount=this.num||10}clone(){return new a7(_e({attachmentTypes:this.attachmentTypes,attachmentsWhere:this.attachmentsWhere,cacheHint:this.cacheHint,keywords:this.keywords,where:this.where,globalIds:this.globalIds,name:this.name,num:this.num,objectIds:this.objectIds,returnMetadata:this.returnMetadata,size:this.size,start:this.start}))}};g([w({type:[String],json:{write:!0}})],Is.prototype,"attachmentTypes",void 0),g([w({type:String,json:{read:{source:"attachmentsDefinitionExpression"},write:{target:"attachmentsDefinitionExpression"}}})],Is.prototype,"attachmentsWhere",void 0),g([w({type:Boolean,json:{write:!0}})],Is.prototype,"cacheHint",void 0),g([w({type:[String],json:{write:!0}})],Is.prototype,"keywords",void 0),g([w({type:[Number],json:{write:!0}})],Is.prototype,"globalIds",void 0),g([w({json:{write:!0}})],Is.prototype,"name",void 0),g([w({type:Number,json:{read:{source:"resultRecordCount"}}})],Is.prototype,"num",void 0),g([w({type:[Number],json:{write:!0}})],Is.prototype,"objectIds",void 0),g([w({type:Boolean,json:{default:!1,write:!0}})],Is.prototype,"returnMetadata",void 0),g([w({type:[Number],json:{write:!0}})],Is.prototype,"size",void 0),g([w({type:Number,json:{read:{source:"resultOffset"}}})],Is.prototype,"start",void 0),g([tt("start"),tt("num")],Is.prototype,"writeStart",null),g([w({type:String,json:{read:{source:"definitionExpression"},write:{target:"definitionExpression"}}})],Is.prototype,"where",void 0),Is=a7=g([te("esri.rest.support.AttachmentQuery")],Is),Is.from=Oi(Is);const T9=Is,I5e="esri.widgets.Feature.support.featureUtils",oW=$e.getLogger(I5e),$5e=/href=(""|'')/gi,E5e=/(\{([^\{\r\n]+)\})/g,T5e=/\'/g,aW=/^\s*expression\//i,C5e=/(\n)/gi,k5e=/[\u00A0-\u9999<>\&]/gim,A5e=/href\s*=\s*(?:\"([^\"]+)\"|\'([^\']+)\')/gi,P5e=/^(?:mailto:|tel:)/,lW="relationships/",l7=fg("short-date-short-time");function cW(e){if(!ce(e))return e.get("sourceLayer")||e.get("layer")}async function C9(e,t){return typeof e=="function"?e.call(null,t):e}function uW(e=""){if(e)return!P5e.test(e.trim().toLowerCase())}function c7(e){return!!e&&aW.test(e)}function L5e(e,t){if(!c7(t)||!e)return null;const i=t.replace(aW,"").toLowerCase();let r;return e.some(n=>n.name.toLowerCase()===i&&(r=n,!0)),r}function hW(e,t){const i=L5e(t,e==null?void 0:e.fieldName);return i?i.title||null:e?e.label||e.fieldName:null}function O5e(e,t){const i=t.get(e.toLowerCase());return`{${i&&i.fieldName||e}}`}function R5e(e){return e.replace($5e,"")}function D_(e,t){const i=u7(t,e);return i?i.name:e}function F5e(e,t){return e&&e.map(i=>D_(i,t))}function u7(e,t){return e&&typeof e.getField=="function"?e.getField(t):null}function pW(e){return`${e}`.trim()}function py({attributes:e,globalAttributes:t,layer:i,text:r,expressionAttributes:n,fieldInfoMap:o}){return r?h7({formattedAttributes:t,template:V5e(r,K(K(K({},t),n),e),i),fieldInfoMap:o}):""}function h7({formattedAttributes:e,template:t,fieldInfoMap:i}){return pW(R5e(Kc(Kc(t,r=>O5e(r,i)),e)))}function N5e(e,t,i=!1){const r=t[e];if(typeof r=="string"){const n="%27",o=(i?encodeURIComponent(r):r).replace(T5e,n);t[e]=o}}function D5e(e,t=!1){const i=K({},e);return Object.keys(i).forEach(r=>N5e(r,i,t)),i}function j5e(e,t,i){const r=(t=pW(t))&&t[0]!=="{";return Kc(e,D5e(i,r))}function p7(e,t){return e.replace(E5e,(i,r,n)=>{const o=u7(t,n);return o?`{${o.name}}`:r})}function V5e(e,t,i){const r=p7(e,i);return r&&r.replace(A5e,(n,o,c)=>j5e(n,o||c,t))}function z5e(e,t){if(typeof e=="string"&&t&&t.dateFormat==null&&(t.places!=null||t.digitSeparator!=null)){const i=Number(e);if(!isNaN(i))return i}return e}function G5e(e){return(e==null?void 0:e.type)==="feature"}function dW(e){return!!(e==null?void 0:e.layer)}function B5e(e){return(e==null?void 0:e.type)==="map-image"}function U5e(e,t){var b;const i=t.fieldInfos,r=t.fieldName,n=(b=fW(i,r))==null?void 0:b.clone(),o=t.preventPlacesFormatting,c=t.layer,h=u7(c,r);if(n&&(h==null?void 0:h.type)==="date"){const x=n.format||new yg;x.dateFormat=x.dateFormat||"short-date-short-time",x.dateTimeFormatOptions=!dW(c)&&G5e(c)&&c.datesInUnknownTimezone||dW(c)&&B5e(c.layer)&&c.layer.datesInUnknownTimezone?{timeZone:"UTC"}:null,n.format=x}const m=n&&n.format;return typeof e=="string"&&Vz(r)&&m?m.formatRasterPixelValue(e):typeof(e=z5e(e,m))=="string"||e==null||m==null?j_(e):o?Jo(e,Ce(K({},qz(m)),{minimumFractionDigits:0,maximumFractionDigits:20})):m.format(e)}function fW(e,t){if(!e||!e.length||!t)return;const i=t.toLowerCase();let r;return e.some(n=>!(!n.fieldName||n.fieldName.toLowerCase()!==i)&&(r=n,!0)),r}function q5e({fieldName:e,graphic:t,layer:i}){if(Nh(e)||!i||typeof i.getFeatureType!="function")return null;const{typeIdField:r}=i;if(!r||e!==r)return null;const n=i.getFeatureType(t);return n?n.name:null}function H5e({fieldName:e,value:t,graphic:i,layer:r}){if(Nh(e)||!r||typeof r.getFieldDomain!="function")return null;const n=r.getFieldDomain(e,{feature:i});return n&&n.type==="coded-value"?n.getName(t):null}function W5e(e,t){const{creatorField:i,creationDateField:r,editorField:n,editDateField:o}=e;if(!t)return;const c=t[o];if(typeof c=="number"){const m=t[n];return{type:"edit",date:Pa(c,l7),user:m}}const h=t[r];if(typeof h=="number"){const m=t[i];return{type:"create",date:Pa(h,l7),user:m}}return null}function J5e(e,t){const i=new Map;return e&&e.forEach(r=>{const n=D_(r.fieldName,t);r.fieldName=n,i.set(n.toLowerCase(),r)}),i}function yW(e){const t=[];if(!e)return t;const{fieldInfos:i,content:r}=e;return i&&t.push(...i),r&&Array.isArray(r)&&r.forEach(n=>{if(n.type==="fields"){const o=n&&n.fieldInfos;o&&t.push(...o)}}),t}function d7(e){return e.replace(k5e,t=>`&#${t.charCodeAt(0)};`)}function j_(e){return typeof e=="string"?e.replace(C5e,'<br class="esri-text-new-line" />'):e}function mW(e){const{value:t,fieldName:i,fieldInfos:r,fieldInfoMap:n,layer:o,graphic:c}=e;if(t==null)return"";const h=H5e({fieldName:i,value:t,graphic:c,layer:o});if(h)return h;const m=q5e({fieldName:i,graphic:c,layer:o});if(m)return m;if(n.get(i.toLowerCase()))return U5e(t,{fieldInfos:r||Array.from(n.values()),fieldName:i,layer:o});const b=o&&o.fieldsIndex;return b&&b.isDateField(i)?Pa(t,l7):j_(t)}function f7({fieldInfos:e,attributes:t,layer:i,graphic:r,fieldInfoMap:n,relatedInfos:o}){const c={};return o==null||o.forEach(h=>Q5e({attributes:c,relatedInfo:h,fieldInfoMap:n,fieldInfos:e,layer:i})),Object.keys(t).forEach(h=>{const m=t[h];c[h]=mW({fieldName:h,fieldInfos:e,fieldInfoMap:n,layer:i,value:m,graphic:r})}),c}async function Z5e(e,t){var x,I;const{layer:i,graphic:r,outFields:n,objectIds:o,returnGeometry:c,spatialReference:h}=e,m=o[0];if(typeof m!="number"&&typeof m!="string"){const E="Could not query required fields for the specified feature. The feature's ID is invalid.",k={layer:i,graphic:r,objectId:m,requiredFields:n};return oW.warn(E,k),null}if(!((I=(x=i.capabilities)==null?void 0:x.operations)==null?void 0:I.supportsQuery)){const E="The specified layer cannot be queried. The following fields will not be available.",k={layer:i,graphic:r,requiredFields:n,returnGeometry:c};return oW.warn(E,k),null}const b=i.createQuery();return b.objectIds=o,b.outFields=(n==null?void 0:n.length)?n:[i.objectIdField],b.returnGeometry=!!c,b.returnZ=!!c,b.returnM=!!c,b.outSpatialReference=h,(await i.queryFeatures(b,t)).features[0]}async function K5e(e){var r;if(!((r=e.expressionInfos)==null?void 0:r.length))return!1;const t=await ru(),{arcadeUtils:{hasGeometryFunctions:i}}=t;return i(e)}async function Y5e({graphic:e,popupTemplate:t,layer:i,spatialReference:r},n){if(!i||!t||(typeof i.load=="function"&&await i.load(n),!e.attributes))return;const o=e.attributes[i.objectIdField];if(o==null)return;const c=[o],h=await t.getRequiredFields(i.fieldsIndex),m=r1e(h,e),b=m?[]:h,x=t.returnGeometry||await K5e(t);if(m&&!x)return;const I=await Z5e({layer:i,graphic:e,outFields:b,objectIds:c,returnGeometry:x,spatialReference:r},n);I&&(I.geometry&&(e.geometry=I.geometry),I.attributes&&(e.attributes=K(K({},e.attributes),I.attributes)))}function Nh(e=""){return!!e&&e.includes(lW)}function X5e(e){return e?`${lW}${e.layerId}/${e.fieldName}`:""}function gW({attributes:e,graphic:t,relatedInfo:i,fieldInfos:r,fieldInfoMap:n,layer:o}){e&&t&&i&&Object.keys(t.attributes).forEach(c=>{const h=X5e({layerId:i.relation.id.toString(),fieldName:c}),m=t.attributes[c];e[h]=mW({fieldName:h,fieldInfos:r,fieldInfoMap:n,layer:o,value:m,graphic:t})})}function Q5e({attributes:e,relatedInfo:t,fieldInfoMap:i,fieldInfos:r,layer:n}){e&&t&&(t.relatedFeatures&&t.relatedFeatures&&t.relatedFeatures.forEach(o=>gW({attributes:e,graphic:o,relatedInfo:t,fieldInfoMap:i,fieldInfos:r,layer:n})),t.relatedStatsFeatures&&t.relatedStatsFeatures&&t.relatedStatsFeatures.forEach(o=>gW({attributes:e,graphic:o,relatedInfo:t,fieldInfoMap:i,fieldInfos:r,layer:n})))}const vW=e=>{if(!e)return!1;const t=e.toUpperCase();return t.includes("CURRENT_TIMESTAMP")||t.includes("CURRENT_DATE")||t.includes("CURRENT_TIME")},bW=({layer:e,method:t,query:i,definitionExpression:r})=>{var c,h;if(!((h=(c=e.capabilities)==null?void 0:c.query)==null?void 0:h.supportsCacheHint)||t==="attachments")return;const n=H(i.where)&&i.where,o=H(i.geometry)&&i.geometry;vW(r)||vW(n)||(o==null?void 0:o.type)==="extent"||i.resultType==="tile"||(i.cacheHint=!0)},e9e=({query:e,layer:t,method:i})=>{bW({layer:t,method:i,query:e,definitionExpression:`${t.definitionExpression} ${t.serviceDefinitionExpression}`})},t9e=({queryPayload:e,layer:t,method:i})=>{bW({layer:t,method:i,query:e,definitionExpression:`${t.definitionExpression} ${t.serviceDefinitionExpression}`})};function i9e(e,t,i){return e&&t&&i?wW(e.allLayers,t,i)||wW(e.allTables,t,i):null}function wW(e,t,i){return e.find(r=>r!==t&&r.type==="feature"&&r.url===t.url&&r.layerId===i.relatedTableId)}const _W={editing:!1,operations:{add:!0,update:!0,delete:!0}},xW=Xe.ofType(sW);let la=class extends Ye{constructor(e){super(e),this._getAttachmentsPromise=null,this._attachmentLayer=null,this.abilities=K({},_W),this.activeAttachmentInfo=null,this.activeFileInfo=null,this.attachmentInfos=new xW,this.fileInfos=new Xe,this.graphic=null,this.mode="view",this.filesEnabled=!1,this.addHandles(we(()=>this.graphic,()=>this._graphicChanged(),St))}destroy(){this._attachmentLayer=null,this.graphic=null}castAbilities(e){return K(K({},_W),e)}get state(){return this._getAttachmentsPromise?"loading":this.graphic?"ready":"disabled"}get supportsResizeAttachments(){const{graphic:e}=this;if(!e)return!1;const t=e.layer||e.sourceLayer;return(t==null?void 0:t.loaded)&&"capabilities"in t&&"operations"in t.capabilities&&"supportsResizeAttachments"in t.capabilities.operations&&t.capabilities.operations.supportsResizeAttachments||!1}async getAttachments(){const{_attachmentLayer:e,attachmentInfos:t}=this;if(!e||typeof e.queryAttachments!="function")throw new ue("invalid-layer","getAttachments(): A valid layer is required.");const i=this._getObjectId(),r=new T9({objectIds:[i],returnMetadata:!0}),n=[],o=e.queryAttachments(r).then(h=>h[i]||n).catch(()=>n);this._getAttachmentsPromise=o,this.notifyChange("state");const c=await o;return t.removeAll(),c.length&&t.addMany(c),this._getAttachmentsPromise=null,this.notifyChange("state"),c}async addAttachment(e,t=this.graphic){const{_attachmentLayer:i,attachmentInfos:r,abilities:n}=this;if(!t)throw new ue("invalid-graphic","addAttachment(): A valid graphic is required.",{graphic:t});if(!e)throw new ue("invalid-attachment","addAttachment(): An attachment is required.",{attachment:e});if(!n.operations.add)throw new ue("invalid-abilities","addAttachment(): add abilities are required.");if(!i||typeof i.addAttachment!="function")throw new ue("invalid-layer","addAttachment(): A valid layer is required.");const o=i.addAttachment(t,e).then(h=>this._queryAttachment(h.objectId,t)),c=await o;return r.add(c),c}async deleteAttachment(e){const{_attachmentLayer:t,attachmentInfos:i,graphic:r,abilities:n}=this;if(!e)throw new ue("invalid-attachment-info","deleteAttachment(): An attachmentInfo is required.",{attachmentInfo:e});if(!n.operations.delete)throw new ue("invalid-abilities","deleteAttachment(): delete abilities are required.");if(!t||typeof t.deleteAttachments!="function")throw new ue("invalid-layer","deleteAttachment(): A valid layer is required.");const o=t.deleteAttachments(r,[e.id]).then(()=>e),c=await o;return i.remove(c),c}async updateAttachment(e,t=this.activeAttachmentInfo){const{_attachmentLayer:i,attachmentInfos:r,graphic:n,abilities:o}=this;if(!e)throw new ue("invalid-attachment","updateAttachment(): An attachment is required.",{attachment:e});if(!t)throw new ue("invalid-attachment-info","updateAttachment(): An attachmentInfo is required.",{attachmentInfo:t});if(!o.operations.update)throw new ue("invalid-abilities","updateAttachment(): Update abilities are required.");const c=r.findIndex(b=>b===t);if(!i||typeof i.updateAttachment!="function")throw new ue("invalid-layer","updateAttachment(): A valid layer is required.");const h=i.updateAttachment(n,t.id,e).then(b=>this._queryAttachment(b.objectId)),m=await h;return r.splice(c,1,m),m}async commitFiles(){return await Promise.all(this.fileInfos.items.map(e=>this.addAttachment(e.form))),this.fileInfos.removeAll(),this.getAttachments()}addFile(e,t){if(!e||!t)return null;const i={file:e,form:t};return this.fileInfos.add(i),i}updateFile(e,t,i=this.activeFileInfo){if(!e||!t||!i)return null;const r=this.fileInfos.findIndex(n=>i===n);return r>-1&&this.fileInfos.splice(r,1,{file:e,form:t}),this.fileInfos.items[r]}deleteFile(e){var i;const t=this.fileInfos.find(r=>r.file===e);return(i=this.fileInfos.remove(t))!=null?i:null}async _queryAttachment(e,t){if(!e)throw new ue("invalid-attachment-id","Could not query attachment.");const{_attachmentLayer:i}=this,r=this._getObjectId(t),n=new T9({objectIds:[r],attachmentsWhere:`AttachmentId=${e}`,returnMetadata:!0});return i.queryAttachments(n).then(o=>o[r][0])}_getObjectId(e=this.graphic){var t;return(t=e==null?void 0:e.getObjectId())!=null?t:null}_graphicChanged(){this.graphic&&(this._setAttachmentLayer(),this.getAttachments().catch(()=>{}))}_setAttachmentLayer(){const{graphic:e}=this,t=cW(e);this._attachmentLayer=t?t.type==="scene"&&H(t.associatedLayer)?t.associatedLayer:t:null}};g([w()],la.prototype,"abilities",void 0),g([Dt("abilities")],la.prototype,"castAbilities",null),g([w()],la.prototype,"activeAttachmentInfo",void 0),g([w()],la.prototype,"activeFileInfo",void 0),g([w({readOnly:!0,type:xW})],la.prototype,"attachmentInfos",void 0),g([w()],la.prototype,"fileInfos",void 0),g([w({type:Gr})],la.prototype,"graphic",void 0),g([w()],la.prototype,"mode",void 0),g([w({readOnly:!0})],la.prototype,"state",null),g([w()],la.prototype,"filesEnabled",void 0),g([w({readOnly:!0})],la.prototype,"supportsResizeAttachments",null),la=g([te("esri.widgets.Attachments.AttachmentsViewModel")],la);const y7=la;function SW(e){const t=e.toLowerCase();return t==="image/bmp"||t==="image/emf"||t==="image/exif"||t==="image/gif"||t==="image/x-icon"||t==="image/jpeg"||t==="image/png"||t==="image/tiff"||t==="image/x-wmf"}function r9e(e){const t=_i("esri/themes/base/images/files/");return e?e==="text/plain"?`${t}text-32.svg`:e==="application/pdf"?`${t}pdf-32.svg`:e==="text/csv"?`${t}csv-32.svg`:e==="application/gpx+xml"?`${t}gpx-32.svg`:e==="application/x-dwf"?`${t}cad-32.svg`:e==="application/postscript"||e==="application/json"||e==="text/xml"||e==="model/vrml"?`${t}code-32.svg`:e==="application/x-zip-compressed"||e==="application/x-7z-compressed"||e==="application/x-gzip"||e==="application/x-tar"||e==="application/x-gtar"||e==="application/x-bzip2"||e==="application/gzip"||e==="application/x-compress"||e==="application/x-apple-diskimage"||e==="application/x-rar-compressed"||e==="application/zip"?`${t}zip-32.svg`:e.includes("image/")?`${t}image-32.svg`:e.includes("audio/")?`${t}sound-32.svg`:e.includes("video/")?`${t}video-32.svg`:e.includes("msexcel")||e.includes("ms-excel")||e.includes("spreadsheetml")?`${t}excel-32.svg`:e.includes("msword")||e.includes("ms-word")||e.includes("wordprocessingml")?`${t}word-32.svg`:e.includes("powerpoint")||e.includes("presentationml")?`${t}report-32.svg`:`${t}generic-32.svg`:`${t}generic-32.svg`}function ci(e){return(t,i)=>{t.hasOwnProperty("_messageBundleProps")||(t._messageBundleProps=t._messageBundleProps?t._messageBundleProps.slice():[]),t._messageBundleProps.push({bundlePath:e,propertyName:i})}}var n9e=function(e){return{vnodeSelector:"",properties:void 0,children:void 0,text:e.toString(),domNode:null}},MW=function(e,t){for(var i=0,r=e.length;i<r;i++){var n=e[i];Array.isArray(n)?MW(n,t):n!=null&&n!==!1&&(n.hasOwnProperty("vnodeSelector")||(n=n9e(n)),t.push(n))}},s9e=function(e,t){for(var i=[],r=2;r<arguments.length;r++)i[r-2]=arguments[r];if(i.length===1&&typeof i[0]=="string")return{vnodeSelector:e,properties:t||void 0,children:void 0,text:i[0],domNode:null};var n=[];return MW(i,n),{vnodeSelector:e,properties:t||void 0,children:n,text:void 0,domNode:null}};function j(e,t,...i){return typeof e!="function"||n7(e)?s9e(e,t,...i):e(t,...i)}const IW={addButton:!0,addSubmitButton:!0,cancelAddButton:!0,cancelUpdateButton:!0,deleteButton:!0,errorMessage:!0,progressBar:!0,updateButton:!0},ht={base:"esri-attachments",loaderContainer:"esri-attachments__loader-container",loader:"esri-attachments__loader",fadeIn:"esri-attachments--fade-in",container:"esri-attachments__container",containerList:"esri-attachments__container--list",containerPreview:"esri-attachments__container--preview",actions:"esri-attachments__actions",deleteButton:"esri-attachments__delete-button",addAttachmentButton:"esri-attachments__add-attachment-button",errorMessage:"esri-attachments__error-message",items:"esri-attachments__items",item:"esri-attachments__item",itemButton:"esri-attachments__item-button",itemMask:"esri-attachments__item-mask",itemMaskIcon:"esri-attachments__item-mask--icon",itemImage:"esri-attachments__image",itemImageResizable:"esri-attachments__image--resizable",itemLabel:"esri-attachments__label",itemFilename:"esri-attachments__filename",itemChevronIcon:"esri-attachments__item-chevron-icon",itemLink:"esri-attachments__item-link",itemLinkOverlay:"esri-attachments__item-link-overlay",itemLinkOverlayIcon:"esri-attachments__item-link-overlay-icon",itemEditIcon:"esri-attachments__item-edit-icon",itemAddIcon:"esri-attachments__item-add-icon",itemAddButton:"esri-attachments__item-add-button",formNode:"esri-attachments__form-node",fileFieldset:"esri-attachments__file-fieldset",fileLabel:"esri-attachments__file-label",fileName:"esri-attachments__file-name",fileInput:"esri-attachments__file-input",metadata:"esri-attachments__metadata",metadataFieldset:"esri-attachments__metadata-fieldset",progressBar:"esri-attachments__progress-bar",esriWidget:"esri-widget",esriButton:"esri-button",buttonDisabled:"esri-button--disabled",esriButtonSecondary:"esri-button--secondary",esriButtonTertiary:"esri-button--tertiary",esriButtonThird:"esri-button--third",esriButtonSmall:"esri-button--small",esriButtonHalf:"esri-button--half",empty:"esri-widget__content--empty",iconExternalLink:"esri-icon-link-external",iconEdit:"esri-icon-edit",iconRight:"esri-icon-right",iconLeft:"esri-icon-left",iconPlus:"esri-icon-plus"},m7=window.CSS;let ao=class extends ki{constructor(e,t){super(e,t),this.displayType="auto",this.messages=null,this.messagesUnits=null,this.selectedFile=null,this.submitting=!1,this.viewModel=new y7,this.visibleElements=K({},IW),this._supportsImageOrientation=m7&&m7.supports&&m7.supports("image-orientation","from-image"),this._addAttachmentForm=null,this._updateAttachmentForm=null}initialize(){this.addHandles([vr(()=>{var e;return(e=this.viewModel)==null?void 0:e.attachmentInfos},"change",()=>this.scheduleRender()),vr(()=>{var e;return(e=this.viewModel)==null?void 0:e.fileInfos},"change",()=>this.scheduleRender()),we(()=>{var e;return(e=this.viewModel)==null?void 0:e.mode},()=>this._modeChanged(),St)])}loadDependencies(){return Promise.all([import("./calcite-icon.3e014da3.js")])}get abilities(){return this.viewModel.abilities}set abilities(e){this.viewModel.abilities=e}get effectiveDisplayType(){const{displayType:e}=this;return e&&e!=="auto"?e:this.viewModel.supportsResizeAttachments?"preview":"list"}get graphic(){return this.viewModel.graphic}set graphic(e){this.viewModel.graphic=e}get label(){var e,t;return(t=(e=this.messages)==null?void 0:e.widgetLabel)!=null?t:""}set label(e){this._overrideIfSome("label",e)}castVisibleElements(e){return K(K({},IW),e)}addAttachment(){const{_addAttachmentForm:e,viewModel:t}=this;return this._set("submitting",!0),this._set("error",null),t.addAttachment(e).then(i=>(this._set("submitting",!1),this._set("error",null),t.mode="view",i)).catch(i=>{throw this._set("submitting",!1),this._set("error",new ue("attachments:add-attachment",this.messages.addErrorMessage,i)),i})}deleteAttachment(e){const{viewModel:t}=this;return this._set("submitting",!0),this._set("error",null),t.deleteAttachment(e).then(i=>(this._set("submitting",!1),this._set("error",null),t.mode="view",i)).catch(i=>{throw this._set("submitting",!1),this._set("error",new ue("attachments:delete-attachment",this.messages.deleteErrorMessage,i)),i})}updateAttachment(){const{viewModel:e}=this,{_updateAttachmentForm:t}=this;return this._set("submitting",!0),this._set("error",null),e.updateAttachment(t).then(i=>(this._set("submitting",!1),this._set("error",null),e.mode="view",i)).catch(i=>{throw this._set("submitting",!1),this._set("error",new ue("attachments:update-attachment",this.messages.updateErrorMessage,i)),i})}addFile(){const e=this.viewModel.addFile(this.selectedFile,this._addAttachmentForm);return this.viewModel.mode="view",e}updateFile(){const{viewModel:e}=this,t=e.updateFile(this.selectedFile,this._updateAttachmentForm,e.activeFileInfo);return e.mode="view",t}deleteFile(e){const t=this.viewModel.deleteFile(e||this.viewModel.activeFileInfo.file);return this.viewModel.mode="view",t}render(){const{submitting:e,viewModel:t}=this,{state:i}=t;return j("div",{class:this.classes(ht.base,ht.esriWidget)},e?this.renderProgressBar():null,i==="loading"?this.renderLoading():this.renderAttachments(),this.renderErrorMessage())}renderErrorMessage(){const{error:e,visibleElements:t}=this;return e&&t.errorMessage?j("div",{key:"error-message",class:ht.errorMessage},e.message):null}renderAttachments(){const{activeFileInfo:e,mode:t,activeAttachmentInfo:i}=this.viewModel;return t==="add"?this.renderAddForm():t==="edit"?this.renderDetailsForm(i||e):this.renderAttachmentContainer()}renderLoading(){return j("div",{class:ht.loaderContainer,key:"loader"},j("div",{class:ht.loader}))}renderProgressBar(){return this.visibleElements.progressBar?j("div",{class:ht.progressBar,key:"progress-bar"}):null}renderAddForm(){const{submitting:e,selectedFile:t}=this,i=e||!t,r=this.visibleElements.cancelAddButton?j("button",{type:"button",bind:this,disabled:e,onclick:this._cancelForm,class:this.classes(ht.esriButton,ht.esriButtonTertiary,ht.esriButtonSmall,ht.esriButtonHalf,e&&ht.buttonDisabled)},this.messages.cancel):null,n=this.visibleElements.addSubmitButton?j("button",{type:"submit",disabled:i,class:this.classes(ht.esriButton,ht.esriButtonSecondary,ht.esriButtonSmall,ht.esriButtonHalf,{[ht.buttonDisabled]:i})},this.messages.add):null,o=t?j("span",{key:"file-name",class:ht.fileName},t.name):null,c=j("form",{bind:this,afterCreate:Fh,afterRemoved:Wq,"data-node-ref":"_addAttachmentForm",onsubmit:this._submitAddAttachment},j("fieldset",{class:ht.fileFieldset},o,j("label",{class:this.classes(ht.fileLabel,ht.esriButton,ht.esriButtonSecondary)},t?this.messages.changeFile:this.messages.selectFile,j("input",{class:ht.fileInput,type:"file",name:"attachment",bind:this,onchange:this._handleFileInputChange}))),n,r);return j("div",{key:"add-form-container",class:ht.formNode},c)}renderDetailsForm(e){const{visibleElements:t,viewModel:i,selectedFile:r,submitting:n}=this,{abilities:o}=i,c=n||!r;let h,m,b,x;r?(h=r.type,m=r.name,b=r.size):"file"in e?(h=e.file.type,m=e.file.name,b=e.file.size):(h=e.contentType,m=e.name,b=e.size,x=e.url);const I=o.editing&&o.operations.delete&&t.deleteButton?j("button",{key:"delete-button",type:"button",disabled:n,bind:this,onclick:q=>this._submitDeleteAttachment(q,e),class:this.classes(ht.esriButton,ht.esriButtonSmall,ht.esriButtonTertiary,ht.deleteButton,{[ht.buttonDisabled]:n})},this.messages.delete):void 0,E=o.editing&&o.operations.update&&t.updateButton?j("button",{disabled:c,key:"update-button",type:"submit",class:this.classes(ht.esriButton,ht.esriButtonSmall,ht.esriButtonThird,{[ht.buttonDisabled]:c})},this.messages.update):void 0,k=this.visibleElements.cancelUpdateButton?j("button",{disabled:n,key:"cancel-button",type:"button",bind:this,onclick:this._cancelForm,class:this.classes(ht.esriButton,ht.esriButtonSmall,ht.esriButtonTertiary,ht.esriButtonThird,{[ht.buttonDisabled]:n})},this.messages.cancel):void 0,P=o.editing&&o.operations.update?j("fieldset",{key:"file",class:ht.fileFieldset},j("span",{key:"file-name",class:ht.fileName},m),j("label",{class:this.classes(ht.fileLabel,ht.esriButton,ht.esriButtonSecondary)},this.messages.changeFile,j("input",{class:ht.fileInput,type:"file",name:"attachment",bind:this,onchange:this._handleFileInputChange}))):void 0,F=j("fieldset",{key:"size",class:ht.metadataFieldset},j("label",null,_5e(this.messagesUnits,b))),N=j("fieldset",{key:"content-type",class:ht.metadataFieldset},j("label",null,h)),B=H(x)?j("a",{class:ht.itemLink,href:x,rel:"noreferrer",target:"_blank"},this.renderImageMask(e,400),j("div",{class:ht.itemLinkOverlay},j("span",{class:ht.itemLinkOverlayIcon},j("calcite-icon",{icon:"launch"})))):this.renderImageMask(e,400),z=j("form",{bind:this,afterCreate:Fh,afterRemoved:Wq,"data-node-ref":"_updateAttachmentForm",onsubmit:q=>this._submitUpdateAttachment(q,e)},j("div",{class:ht.metadata},F,N),P,j("div",{class:ht.actions},I,k,E));return j("div",{key:"edit-form-container",class:ht.formNode},B,z)}renderImageMask(e,t){return"file"in e?this.renderGenericImageMask(e.file.name,e.file.type):this.renderImageMaskForAttachment(e,t)}renderGenericImageMask(e,t){const{supportsResizeAttachments:i}=this.viewModel,r=r9e(t),n={[ht.itemImageResizable]:i};return j("div",{class:this.classes(ht.itemMaskIcon,ht.itemMask)},j("img",{title:e,alt:e,src:r,class:this.classes(n,ht.itemImage)}))}renderImageMaskForAttachment(e,t){const{supportsResizeAttachments:i}=this.viewModel,{contentType:r,name:n,url:o}=e;if(!i||!SW(r))return this.renderGenericImageMask(n,r);const c=this._getCSSTransform(e),h=c?{transform:c,"image-orientation":"none"}:{},m=`${o}${o.includes("?")?"&":"?"}w=${t}`,b={[ht.itemImageResizable]:i};return j("div",{class:this.classes(ht.itemMask)},j("img",{styles:h,alt:n,title:n,src:m,class:this.classes(b,ht.itemImage)}))}renderFile(e){const{file:t}=e;return j("li",{class:ht.item,key:t},j("button",{key:"details-button",bind:this,class:ht.itemButton,title:this.messages.attachmentDetails,"aria-label":this.messages.attachmentDetails,onclick:()=>this._startEditFile(e),type:"button"},this.renderImageMask(e),j("label",{class:ht.itemLabel},j("span",{class:ht.itemFilename},t.name||this.messages.noTitle),j("span",{"aria-hidden":"true",class:this.classes(ht.itemChevronIcon,Ms(this.container)?ht.iconLeft:ht.iconRight)}))))}renderAttachmentInfo({attachmentInfo:e,displayType:t}){const{viewModel:i,effectiveDisplayType:r}=this,{abilities:n,supportsResizeAttachments:o}=i,{contentType:c,name:h,url:m}=e,b=this.renderImageMask(e,t==="list"?48:400),x=n.editing?j("span",{"aria-hidden":"true",class:this.classes(ht.itemChevronIcon,Ms(this.container)?ht.iconLeft:ht.iconRight)}):null,I=[b,r==="preview"&&o&&SW(c)?null:j("label",{class:ht.itemLabel},j("span",{class:ht.itemFilename},h||this.messages.noTitle),x)],E=n.editing?j("button",{key:"details-button",bind:this,class:ht.itemButton,title:this.messages.attachmentDetails,"aria-label":this.messages.attachmentDetails,"data-attachment-info-id":e.id,onclick:()=>this._startEditAttachment(e),type:"button"},I):j("a",{key:"details-link",class:ht.itemButton,href:m,target:"_blank"},I);return j("li",{class:ht.item,key:e},E)}renderAttachmentContainer(){const{effectiveDisplayType:e,viewModel:t,visibleElements:i}=this,{attachmentInfos:r,abilities:n,fileInfos:o}=t,c=!!(r==null?void 0:r.length),h=!!(o==null?void 0:o.length),m={[ht.containerList]:e!=="preview",[ht.containerPreview]:e==="preview"},b=n.editing&&n.operations.add&&i.addButton?j("button",{bind:this,onclick:()=>this._startAddAttachment(),class:this.classes(ht.esriButton,ht.esriButtonTertiary,ht.addAttachmentButton),type:"button"},j("span",{"aria-hidden":"true",class:this.classes(ht.itemAddIcon,ht.iconPlus)}),this.messages.add):void 0,x=c?j("ul",{key:"attachments-list",class:ht.items},r.toArray().map(k=>this.renderAttachmentInfo({attachmentInfo:k,displayType:e}))):void 0,I=h?j("ul",{key:"file-list",class:ht.items},o.toArray().map(k=>this.renderFile(k))):void 0,E=h||c?void 0:j("div",{class:ht.empty},this.messages.noAttachments);return j("div",{key:"attachments-container",class:this.classes(ht.container,m)},x,I,E,b)}_modeChanged(){this._set("error",null),this._set("selectedFile",null)}_handleFileInputChange(e){const t=e.target,i=t&&t.files&&t.files.item(0);this._set("selectedFile",i)}_submitDeleteAttachment(e,t){e.preventDefault(),"file"in t?this.deleteFile(t.file):this.deleteAttachment(t)}_submitAddAttachment(e){e.preventDefault(),this.viewModel.filesEnabled?this.addFile():this.addAttachment()}_submitUpdateAttachment(e,t){e.preventDefault(),"file"in t?this.updateFile():this.updateAttachment()}_startEditAttachment(e){const{viewModel:t}=this;t.activeFileInfo=null,t.activeAttachmentInfo=e,t.mode="edit"}_startEditFile(e){const{viewModel:t}=this;t.activeAttachmentInfo=null,t.activeFileInfo=e,t.mode="edit"}_startAddAttachment(){this.viewModel.mode="add"}_cancelForm(e){e.preventDefault(),this.viewModel.mode="view"}_getCSSTransform(e){const{orientationInfo:t}=e;return!this._supportsImageOrientation&&t?[t.rotation?`rotate(${t.rotation}deg)`:"",t.mirrored?"scaleX(-1)":""].join(" "):""}};g([w()],ao.prototype,"abilities",null),g([w()],ao.prototype,"displayType",void 0),g([w({readOnly:!0})],ao.prototype,"effectiveDisplayType",null),g([w()],ao.prototype,"graphic",null),g([w()],ao.prototype,"label",null),g([w(),ci("esri/widgets/Attachments/t9n/Attachments")],ao.prototype,"messages",void 0),g([w(),ci("esri/core/t9n/Units")],ao.prototype,"messagesUnits",void 0),g([w({readOnly:!0})],ao.prototype,"selectedFile",void 0),g([w({readOnly:!0})],ao.prototype,"submitting",void 0),g([w({readOnly:!0})],ao.prototype,"error",void 0),g([w({type:y7})],ao.prototype,"viewModel",void 0),g([w()],ao.prototype,"visibleElements",void 0),g([Dt("visibleElements")],ao.prototype,"castVisibleElements",null),ao=g([te("esri.widgets.Attachments")],ao);const o9e=ao;let V_=class extends y7{constructor(e){super(e),this.description=null,this.title=null}};g([w()],V_.prototype,"description",void 0),g([w()],V_.prototype,"title",void 0),V_=g([te("esri.widgets.Feature.FeatureAttachments.FeatureAttachmentsViewModel")],V_);const g7=V_,a9e={heading:"esri-widget__heading"};function Va(e,t){const i=$W(e.level),r=`h${i}`;return delete e.level,j(r,Ce(K({},e),{class:qg(a9e.heading,e.class),role:"heading","aria-level":String(i)}),t)}function $W(e){return Vs(Math.ceil(e),1,6)}function l9e(e,t=1){return $W(e+t)}const v7={base:"esri-feature-element-info",title:"esri-feature-element-info__title",description:"esri-feature-element-info__description"};let r1=class extends ki{constructor(e,t){super(e,t),this.description=null,this.headingLevel=2,this.title=null}render(){return j("div",{class:v7.base},this.renderTitle(),this.renderDescription())}renderTitle(){const{title:e}=this;return e?j(Va,{level:this.headingLevel,class:v7.title},e):null}renderDescription(){const{description:e}=this;return e?j("div",{key:"description",class:v7.description},e):null}};g([w()],r1.prototype,"description",void 0),g([w()],r1.prototype,"headingLevel",void 0),g([w()],r1.prototype,"title",void 0),r1=g([te("esri.widgets.Feature.support.FeatureElementInfo")],r1);const k9=r1,c9e={base:"esri-feature-attachments"};let Su=class extends ki{constructor(e,t){super(e,t),this._featureElementInfo=null,this.attachmentsWidget=new o9e,this.headingLevel=2,this.viewModel=new g7}initialize(){this._featureElementInfo=new k9,this.addHandles([we(()=>{var e,t;return[(e=this.viewModel)==null?void 0:e.description,(t=this.viewModel)==null?void 0:t.title,this.headingLevel]},()=>this._setupFeatureElementInfo(),St),we(()=>{var e;return(e=this.viewModel)==null?void 0:e.graphic},e=>this.attachmentsWidget.graphic=e,St)])}destroy(){this.attachmentsWidget.destroy(),this._featureElementInfo.destroy()}get description(){return this.viewModel.description}set description(e){this.viewModel.description=e}get displayType(){return this.attachmentsWidget.displayType}set displayType(e){this.attachmentsWidget.displayType=e}get graphic(){return this.viewModel.graphic}set graphic(e){this.viewModel.graphic=e}get title(){return this.viewModel.title}set title(e){this.viewModel.title=e}render(){var t;const{attachmentsWidget:e}=this;return j("div",{class:c9e.base},(t=this._featureElementInfo)==null?void 0:t.render(),e==null?void 0:e.render())}_setupFeatureElementInfo(){const{description:e,title:t,headingLevel:i}=this;this._featureElementInfo.set({description:e,title:t,headingLevel:i})}};g([w({readOnly:!0})],Su.prototype,"attachmentsWidget",void 0),g([w()],Su.prototype,"description",null),g([w()],Su.prototype,"displayType",null),g([w()],Su.prototype,"graphic",null),g([w()],Su.prototype,"headingLevel",void 0),g([w()],Su.prototype,"title",null),g([w({type:g7})],Su.prototype,"viewModel",void 0),Su=g([te("esri.widgets.Feature.FeatureAttachments")],Su);const u9e=Su,ls=e=>{let t=class extends e{destroy(){var i,r;this.destroyed||((i=this._get("handles"))==null||i.destroy(),(r=this._get("updatingHandles"))==null||r.destroy())}get handles(){return this._get("handles")||new Ti}get updatingHandles(){return this._get("updatingHandles")||new Bg}};return g([w({readOnly:!0})],t.prototype,"handles",null),g([w({readOnly:!0})],t.prototype,"updatingHandles",null),t=g([te("esri.core.HandleOwner")],t),t};let dy=class extends ls(Ye){};dy=g([te("esri.core.HandleOwner")],dy);let Xd=class extends ls(Ye){constructor(e){super(e),this._loadingPromise=null,this.created=null,this.creator=null,this.destroyer=null,this.graphic=null,this.handles.add(we(()=>this.creator,t=>{this._destroyContent(),this._createContent(t)},St))}destroy(){this._destroyContent()}get state(){return this._loadingPromise?"loading":"ready"}_destroyContent(){const{created:e,graphic:t,destroyer:i}=this;e&&(C9(i,{graphic:t}).catch(()=>null),this._set("created",null))}async _createContent(e){const{graphic:t}=this,i=C9(e,{graphic:t}).catch(()=>null);this._loadingPromise=i,this.notifyChange("state");const r=await i;i===this._loadingPromise&&(this._loadingPromise=null,this.notifyChange("state"),this._set("created",r))}};g([w({readOnly:!0})],Xd.prototype,"created",void 0),g([w()],Xd.prototype,"creator",void 0),g([w()],Xd.prototype,"destroyer",void 0),g([w({type:Gr})],Xd.prototype,"graphic",void 0),g([w({readOnly:!0})],Xd.prototype,"state",null),Xd=g([te("esri.widgets.Feature.FeatureContent.FeatureContentViewModel")],Xd);const A9=Xd;function Ki(){return function(e,t){if(!e[t])throw new TypeError(`Cannot auto bind undefined function '${t}'`);return{value:p9e(e[t])}}}function h9e(e){const{type:t}=e;return e instanceof KeyboardEvent||t==="keyup"||t==="keydown"||t==="keypress"}function p9e(e){return function(t,...i){h9e(t)?Hg(t.key)&&(t.preventDefault(),t.stopPropagation(),t.target.click()):e.call(this,t,...i)}}function n1(e){return t=>{t.hasOwnProperty("_delegatedEventNames")||(t._delegatedEventNames=t._delegatedEventNames?t._delegatedEventNames.slice():[]);const i=t._delegatedEventNames,r=Array.isArray(e)?e:d9e(e);i.push(...r)}}function d9e(e){return e.split(",").map(t=>t.trim())}const EW="calcite-theme-";function f9e(){return getComputedStyle(document.body).getPropertyValue("--esri-calcite-theme-name").replace(/\s|'|"/g,"")}function z_(){return f9e().startsWith("dark")}function y9e(){return`${EW}${z_()?"dark":"light"}`}function m9e(e){g9e(e),e.classList.add(y9e())}function g9e(e){Array.from(e.classList).forEach(t=>{t.startsWith(EW)&&e.classList.remove(t)})}function s1(e){return e&&typeof e.render=="function"}function TW(e){return e&&typeof e.postMixInProperties=="function"&&typeof e.buildRendering=="function"&&typeof e.postCreate=="function"&&typeof e.startup=="function"}const b7={base:"esri-feature-content",loaderContainer:"esri-feature-content__loader-container",loader:"esri-feature-content__loader"};let o1=class extends ki{constructor(e,t){super(e,t),this.viewModel=null,this._addTargetToAnchors=i=>{Array.from(i.querySelectorAll("a")).forEach(r=>{uW(r.href)&&!r.hasAttribute("target")&&r.setAttribute("target","_blank")})}}get creator(){return this.viewModel.creator}set creator(e){this.viewModel.creator=e}get graphic(){return this.viewModel.graphic}set graphic(e){this.viewModel.graphic=e}renderLoading(){return j("div",{class:b7.loaderContainer,key:"loader"},j("div",{class:b7.loader}))}renderCreated(){var t;const e=(t=this.viewModel)==null?void 0:t.created;return e?e instanceof HTMLElement?j("div",{key:e,bind:e,afterCreate:this._attachToNode}):s1(e)?j("div",{key:e},!e.destroyed&&e.render()):j("div",{key:e,innerHTML:e,afterCreate:this._addTargetToAnchors}):null}render(){var t;const e=(t=this.viewModel)==null?void 0:t.state;return j("div",{class:b7.base},e==="loading"?this.renderLoading():this.renderCreated())}_attachToNode(e){const t=this;e.appendChild(t)}};g([w()],o1.prototype,"creator",null),g([w()],o1.prototype,"graphic",null),g([w({type:A9})],o1.prototype,"viewModel",void 0),o1=g([te("esri.widgets.Feature.FeatureContent")],o1);const P9=o1;let Dh=class extends Ye{constructor(e){super(e),this.attributes=null,this.expressionInfos=null,this.description=null,this.fieldInfos=null,this.title=null}get formattedFieldInfos(){const{expressionInfos:e,fieldInfos:t}=this,i=[];return t==null||t.forEach(r=>{if(!(!r.hasOwnProperty("visible")||r.visible))return;const n=r.clone();n.label=hW(n,e),i.push(n)}),i}};g([w()],Dh.prototype,"attributes",void 0),g([w({type:[Qz]})],Dh.prototype,"expressionInfos",void 0),g([w()],Dh.prototype,"description",void 0),g([w({type:[Lw]})],Dh.prototype,"fieldInfos",void 0),g([w({readOnly:!0})],Dh.prototype,"formattedFieldInfos",null),g([w()],Dh.prototype,"title",void 0),Dh=g([te("esri.widgets.Feature.FeatureFields.FeatureFieldsViewModel")],Dh);const L9=Dh,v9e=[{pattern:/^\s*(https?:\/\/([^\s]+))\s*$/i,target:"_blank",label:"{messages.view}"},{pattern:/^\s*(tel:([^\s]+))\s*$/i,label:"{hierPart}"},{pattern:/^\s*(mailto:([^\s]+))\s*$/i,label:"{hierPart}"},{pattern:/^\s*(arcgis-appstudio-player:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"App Studio Player"},{pattern:/^\s*(arcgis-collector:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Collector"},{pattern:/^\s*(arcgis-explorer:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Explorer"},{pattern:/^\s*(arcgis-navigator:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Navigator"},{pattern:/^\s*(arcgis-survey123:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Survey123"},{pattern:/^\s*(arcgis-trek2there:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Trek2There"},{pattern:/^\s*(arcgis-workforce:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Workforce"},{pattern:/^\s*(iform:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"iForm"},{pattern:/^\s*(flow:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"FlowFinity"},{pattern:/^\s*(lfmobile:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Laserfische"},{pattern:/^\s*(mspbi:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Microsoft Power Bi"}];function b9e(e){let t=null;return v9e.some(i=>(i.pattern.test(e)&&(t=i),!!t)),t}function w9e(e,t){if(typeof t!="string"||!t)return t;const i=b9e(t);if(!i)return t;const r=t.match(i.pattern),n=r&&r[2],o=Kc(Kc(i.label,{messages:e,hierPart:n}),{appName:i.appName}),c=i.target?` target="${i.target}"`:"",h=i.target==="_blank"?' rel="noreferrer"':"";return t.replace(i.pattern,`<a${c} href="$1"${h}>${o}</a>`)}const G_={base:"esri-feature-fields",fieldHeader:"esri-feature-fields__field-header",fieldData:"esri-feature-fields__field-data",fieldDataDate:"esri-feature-fields__field-data--date",esriTable:"esri-widget__table"};let mc=class extends ki{constructor(e,t){super(e,t),this._featureElementInfo=null,this.viewModel=new L9,this.messages=null,this.messagesURIUtils=null}initialize(){this._featureElementInfo=new k9,this.addHandles(we(()=>{var e,t;return[(e=this.viewModel)==null?void 0:e.description,(t=this.viewModel)==null?void 0:t.title]},()=>this._setupFeatureElementInfo(),St))}destroy(){this._featureElementInfo.destroy()}get attributes(){return this.viewModel.attributes}set attributes(e){this.viewModel.attributes=e}get description(){return this.viewModel.description}set description(e){this.viewModel.description=e}get expressionInfos(){return this.viewModel.expressionInfos}set expressionInfos(e){this.viewModel.expressionInfos=e}get fieldInfos(){return this.viewModel.fieldInfos}set fieldInfos(e){this.viewModel.fieldInfos=e}get title(){return this.viewModel.title}set title(e){this.viewModel.title=e}renderFieldInfo(e,t){const{attributes:i}=this.viewModel,r=e.fieldName,n=e.label||r,o=i?i[r]==null?"":i[r]:"",c=!(!e.format||!e.format.dateFormat),h=typeof o=="number"&&!c?this._forceLTR(o):w9e(this.messagesURIUtils,o),m={[G_.fieldDataDate]:c};return j("tr",{key:`fields-element-info-row-${r}-${t}`},j("th",{key:`fields-element-info-row-header-${r}-${t}`,class:G_.fieldHeader,innerHTML:n}),j("td",{key:`fields-element-info-row-data-${r}-${t}`,class:this.classes(G_.fieldData,m),innerHTML:h}))}renderFields(){const{formattedFieldInfos:e}=this.viewModel;return(e==null?void 0:e.length)?j("table",{class:G_.esriTable,summary:this.messages.fieldsSummary},j("tbody",null,e.map((t,i)=>this.renderFieldInfo(t,i)))):null}render(){var e;return j("div",{class:G_.base},(e=this._featureElementInfo)==null?void 0:e.render(),this.renderFields())}_setupFeatureElementInfo(){const{description:e,title:t}=this;this._featureElementInfo.set({description:e,title:t})}_forceLTR(e){return`&lrm;${e}`}};g([w()],mc.prototype,"attributes",null),g([w()],mc.prototype,"description",null),g([w()],mc.prototype,"expressionInfos",null),g([w()],mc.prototype,"fieldInfos",null),g([w()],mc.prototype,"title",null),g([w({type:L9,nonNullable:!0})],mc.prototype,"viewModel",void 0),g([w(),ci("esri/widgets/Feature/t9n/Feature")],mc.prototype,"messages",void 0),g([w(),ci("esri/widgets/support/t9n/uriUtils")],mc.prototype,"messagesURIUtils",void 0),mc=g([te("esri.widgets.Feature.FeatureFields")],mc);const CW=mc,_9e=/^-?(\d+)(\.(\d+))?$/i;function x9e(e,t){return e-t}function S9e(e,t){let i,r;return i=Number(e.toFixed(t)),i<e?r=i+1/10**t:(r=i,i-=1/10**t),i=Number(i.toFixed(t)),r=Number(r.toFixed(t)),[i,r]}function M9e(e,t,i,r,n){const o=R9(e,t,i,r),c=o.previous==null||o.previous<=n,h=o.next==null||o.next<=n;return c&&h||o.previous+o.next<=2*n}function O9(e){const t=String(e),i=t.match(_9e);if(i&&i[1])return{integer:i[1].split("").length,fractional:i[3]?i[3].split("").length:0};if(t.toLowerCase().includes("e")){const r=t.split("e"),n=r[0],o=r[1];if(n&&o){const c=Number(n);let h=Number(o);const m=h>0;m||(h=Math.abs(h));const b=O9(c);return m?(b.integer+=h,h>b.fractional?b.fractional=0:b.fractional-=h):(b.fractional+=h,h>b.integer?b.integer=1:b.integer-=h),b}}return{integer:0,fractional:0}}function R9(e,t,i,r){const n={previous:null,next:null};if(i!=null){const o=e-i,c=t-i-o;n.previous=Math.floor(Math.abs(100*c/o))}if(r!=null){const o=r-e,c=r-t-o;n.next=Math.floor(Math.abs(100*c/o))}return n}function F9(e,t={}){const i=e.slice(0),{tolerance:r=2,strictBounds:n=!1,indexes:o=i.map((c,h)=>h)}=t;o.sort(x9e);for(let c=0;c<o.length;c++){const h=o[c],m=i[h],b=h===0?null:i[h-1],x=h===i.length-1?null:i[h+1],I=O9(m).fractional;if(I){let E,k=0,P=!1;for(;k<=I&&!P;){const F=S9e(m,k);E=n&&c===0?F[1]:F[0],P=M9e(m,E,b,x,r),k++}P&&(i[h]=E)}}return i}const I9e={maximumFractionDigits:20};function $9e(e){return Jo(e,I9e)}var w7;let fy=w7=class extends ke{constructor(e){super(e),this.color=null,this.label=null,this.value=null}writeValue(e,t,i){t[i]=e!=null?e:0}clone(){return new w7({color:this.color&&this.color.clone(),label:this.label,value:this.value})}};g([w({type:ut,json:{type:[Ri],write:!0}})],fy.prototype,"color",void 0),g([w({type:String,json:{write:!0}})],fy.prototype,"label",void 0),g([w({type:Number,json:{write:{writerEnsuresNonNull:!0}}})],fy.prototype,"value",void 0),g([tt("value")],fy.prototype,"writeValue",null),fy=w7=g([te("esri.renderers.visualVariables.support.ColorStop")],fy);const E9e=fy;function N9(){const e=new Float32Array(16);return e[0]=1,e[5]=1,e[10]=1,e[15]=1,e}function T9e(e){const t=new Float32Array(16);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function C9e(e,t,i,r,n,o,c,h,m,b,x,I,E,k,P,F){const N=new Float32Array(16);return N[0]=e,N[1]=t,N[2]=i,N[3]=r,N[4]=n,N[5]=o,N[6]=c,N[7]=h,N[8]=m,N[9]=b,N[10]=x,N[11]=I,N[12]=E,N[13]=k,N[14]=P,N[15]=F,N}function k9e(e,t){return new Float32Array(e,t,16)}const A9e=N9();Object.freeze(Object.defineProperty({__proto__:null,create:N9,clone:T9e,fromValues:C9e,createView:k9e,IDENTITY:A9e},Symbol.toStringTag,{value:"Module"}));const P9e=(e,t)=>{const i=Vd(e,t,0,0,0,0,t,0,0,0,0,t,0,0,0,0,1);return Ah(i,i)},L9e=(e,t)=>{const i=Vd(e,t,0,0,.5-.5*t,0,t,0,.5-.5*t,0,0,t,.5-.5*t,0,0,0,1);return Ah(i,i)},O9e=(e,t)=>{const i=1-t,r=Vd(e,.2126+.7874*i,.7152-.7152*i,.0722-.0722*i,0,.2126-.2126*i,.7152+.2848*i,.0722-.0722*i,0,.2126-.2126*i,.7152-.7152*i,.0722+.9278*i,0,0,0,0,1);return Ah(r,r)},R9e=(e,t)=>{const i=Math.sin(t*Math.PI/180),r=Math.cos(t*Math.PI/180),n=Vd(e,.213+.787*r-.213*i,.715-.715*r-.715*i,.072-.072*r+.928*i,0,.213-.213*r+.143*i,.715+.285*r+.14*i,.072-.072*r-.283*i,0,.213-.213*r-.787*i,.715-.715*r+.715*i,.072+.928*r+.072*i,0,0,0,0,1);return Ah(n,n)},F9e=(e,t)=>{const i=1-2*t,r=Vd(e,i,0,0,t,0,i,0,t,0,0,i,t,0,0,0,1);return Ah(r,r)},N9e=(e,t)=>{const i=Vd(e,.213+.787*t,.715-.715*t,.072-.072*t,0,.213-.213*t,.715+.285*t,.072-.072*t,0,.213-.213*t,.715-.715*t,.072+.928*t,0,0,0,0,1);return Ah(i,i)},D9e=(e,t)=>{const i=1-t,r=Vd(e,.393+.607*i,.769-.769*i,.189-.189*i,0,.349-.349*i,.686+.314*i,.168-.168*i,0,.272-.272*i,.534-.534*i,.131+.869*i,0,0,0,0,1);return Ah(r,r)};class D9{constructor(t,i,r){this.strength=t,this.radius=i,this.threshold=r,this.type="bloom"}interpolate(t,i,r){this.strength=ca(t.strength,i.strength,r),this.radius=ca(t.radius,i.radius,r),this.threshold=ca(t.threshold,i.threshold,r)}clone(){return new D9(this.strength,this.radius,this.threshold)}toJSON(){return{type:"bloom",radius:U_(this.radius),strength:this.strength,threshold:this.threshold}}}class j9{constructor(t){this.radius=t,this.type="blur"}interpolate(t,i,r){this.radius=Math.round(ca(t.radius,i.radius,r))}clone(){return new j9(this.radius)}toJSON(){return{type:"blur",radius:U_(this.radius)}}}class B_{constructor(t,i){this.type=t,this.amount=i,this.type!=="invert"&&this.type!=="grayscale"&&this.type!=="sepia"||(this.amount=Math.min(this.amount,1))}get colorMatrix(){return this._colorMatrix||this._updateMatrix(),this._colorMatrix}interpolate(t,i,r){this.amount=ca(t.amount,i.amount,r),this._updateMatrix()}clone(){return new B_(this.type,this.amount)}toJSON(){return{type:this.type,amount:this.amount}}_updateMatrix(){const t=this._colorMatrix||N9();switch(this.type){case"brightness":this._colorMatrix=P9e(t,this.amount);break;case"contrast":this._colorMatrix=L9e(t,this.amount);break;case"grayscale":this._colorMatrix=O9e(t,this.amount);break;case"invert":this._colorMatrix=F9e(t,this.amount);break;case"saturate":this._colorMatrix=N9e(t,this.amount);break;case"sepia":this._colorMatrix=D9e(t,this.amount)}}}class V9{constructor(t,i,r,n){this.offsetX=t,this.offsetY=i,this.blurRadius=r,this.color=n,this.type="drop-shadow"}interpolate(t,i,r){this.offsetX=ca(t.offsetX,i.offsetX,r),this.offsetY=ca(t.offsetY,i.offsetY,r),this.blurRadius=ca(t.blurRadius,i.blurRadius,r),this.color[0]=Math.round(ca(t.color[0],i.color[0],r)),this.color[1]=Math.round(ca(t.color[1],i.color[1],r)),this.color[2]=Math.round(ca(t.color[2],i.color[2],r)),this.color[3]=ca(t.color[3],i.color[3],r)}clone(){return new V9(this.offsetX,this.offsetY,this.blurRadius,[...this.color])}toJSON(){const t=[...this.color];return t[3]*=255,{type:"drop-shadow",xoffset:U_(this.offsetX),yoffset:U_(this.offsetY),blurRadius:U_(this.blurRadius),color:t}}}class z9{constructor(t){this.angle=t,this.type="hue-rotate"}get colorMatrix(){return this._colorMatrix||this._updateMatrix(),this._colorMatrix}interpolate(t,i,r){this.angle=ca(t.angle,i.angle,r),this._updateMatrix()}clone(){return new z9(this.angle)}toJSON(){return{type:"hue-rotate",angle:this.angle}}_updateMatrix(){const t=this._colorMatrix||N9();this._colorMatrix=R9e(t,this.angle)}}class G9{constructor(t){this.amount=t,this.type="opacity",this.amount=Math.min(this.amount,1)}interpolate(t,i,r){this.amount=ca(t.amount,i.amount,r)}clone(){return new G9(this.amount)}toJSON(){return{type:"opacity",amount:this.amount}}}function ca(e,t,i){return e+(t-e)*i}function U_(e){return Math.round(1e3*$n(e))/1e3}function j9e(e){switch(e.type){case"grayscale":case"sepia":case"invert":return new B_(e.type,0);case"saturate":case"brightness":case"contrast":return new B_(e.type,1);case"opacity":return new G9(1);case"hue-rotate":return new z9(0);case"blur":return new j9(0);case"drop-shadow":return new V9(0,0,0,[...$6("transparent")]);case"bloom":return new D9(0,0,1)}}var mZe=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{};function gZe(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function vZe(e){throw new Error('Could not dynamically require "'+e+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}function kW(e,t){const i=e.length>t.length?e:t;return(e.length>t.length?t:e).every((r,n)=>r.type===i[n].type)}function AW(e,t){const i=e.length>t.length?e:t,r=e.length>t.length?t:e;for(let n=r.length;n<i.length;n++)r.push(j9e(i[n]))}function V9e(e){const t=e[0];return!!t&&"type"in t}var PW,LW,OW={exports:{}};function _7(e){if(!e||e.length===0)return null;if(typeof e=="string"){const i=RW(e);return i&&i.length!==0?i:null}const t=e.map(i=>{if(!Number.isFinite(i.scale)||i.scale<=0)throw new ue("effect:invalid-scale","scale must be finite and greater than 0",{stop:i});return{scale:i.scale,effects:RW(i.value)}});t.sort((i,r)=>r.effects.length-i.effects.length);for(let i=0;i<t.length-1;i++){if(!kW(t[i].effects,t[i+1].effects))throw new ue("effect:interpolation-impossible","Cannot interpolate by scale between 2 lists of mixed effects",{a:t[i].effects,b:t[i+1].effects});AW(t[i].effects,t[i+1].effects)}return t.sort((i,r)=>r.scale-i.scale),t}function RW(e){let t;if(!e)return[];try{t=OW.exports.parse(e)}catch(i){throw new ue("effect:invalid-syntax","Invalid effect syntax",{value:e,error:i})}return t.map(i=>z9e(i))}function z9e(e){try{switch(e.name){case"grayscale":case"sepia":case"saturate":case"invert":case"brightness":case"contrast":return G9e(e);case"opacity":return B9e(e);case"hue-rotate":return U9e(e);case"blur":return q9e(e);case"drop-shadow":return H9e(e);case"bloom":return W9e(e)}}catch(t){throw t.details.filter=e,t}throw new ue("effect:unknown-effect",`Effect '${e.name}' is not supported`,{effect:e})}function G9e(e){let t=1;return a1(e.parameters,1),e.parameters.length===1&&(t=gc(e.parameters[0])),new B_(e.name,t)}function B9e(e){let t=1;return a1(e.parameters,1),e.parameters.length===1&&(t=gc(e.parameters[0])),new G9(t)}function U9e(e){let t=0;return a1(e.parameters,1),e.parameters.length===1&&(t=Q9e(e.parameters[0])),new z9(t)}function q9e(e){let t=0;return a1(e.parameters,1),e.parameters.length===1&&(t=M7(e.parameters[0]),q_(t,e.parameters[0])),new j9(t)}function H9e(e){const t=[];let i=null;for(const r of e.parameters)if(r.type==="color"){if(t.length&&Object.freeze(t),i)throw new ue("effect:type-error","Accepts only one color",{});i=eMe(r)}else{const n=M7(r);if(Object.isFrozen(t))throw new ue("effect:type-error","<length> parameters not consecutive",{lengths:t});t.push(n),t.length===3&&q_(n,r)}if(t.length<2||t.length>3)throw new ue("effect:type-error",`Expected <length>{2,3}, Actual: <length>{${t.length}}`,{lengths:t});return new V9(t[0],t[1],t[2]||0,i||FW("black"))}function W9e(e){let t=1,i=0,r=0;return a1(e.parameters,3),e.parameters[0]&&(t=gc(e.parameters[0])),e.parameters[1]&&(i=M7(e.parameters[1]),q_(i,e.parameters[1])),e.parameters[2]&&(r=gc(e.parameters[2])),new D9(t,i,r)}function a1(e,t){if(e.length>t)throw new ue("effect:type-error",`Function supports up to ${t} parameters, Actual: ${e.length}`,{parameters:e})}function B9(e){if(e.type==="color")return"<color>";if(e.unit){if(S7[e.unit])return"<length>";if(x7[e.unit])return"<angle>";if(e.unit==="%")return"<percentage>"}return"<double>"}function q_(e,t){if(e<0)throw new ue("effect:type-error",`Negative values are not allowed, Actual: ${e}`,{term:t})}function J9e(e){if(e.type!=="quantity"||e.unit!==null)throw new ue("effect:type-error",`Expected <double>, Actual: ${B9(e)}`,{term:e})}function Z9e(e){if(e.type!=="quantity"||e.unit!==null&&e.unit!=="%")throw new ue("effect:type-error",`Expected <double> or <percentage>, Actual: ${B9(e)}`,{term:e})}LW=function(){function e(n,o){function c(){this.constructor=n}c.prototype=o.prototype,n.prototype=new c}function t(n,o,c,h){var m=Error.call(this,n);return Object.setPrototypeOf&&Object.setPrototypeOf(m,t.prototype),m.expected=o,m.found=c,m.location=h,m.name="SyntaxError",m}function i(n,o,c){return c=c||" ",n.length>o?n:(o-=n.length,n+(c+=c.repeat(o)).slice(0,o))}function r(n,o){var c,h={},m=(o=o!==void 0?o:{}).grammarSource,b={start:Vr},x=Vr,I="none",E=")",k=",",P="(",F="%",N="px",B="cm",z="mm",q="in",J="pt",X="pc",Y="deg",ae="rad",he="grad",fe="turn",ye="#",xe=".",Se="e",Ae=/^[ \t\n\r]/,Oe=/^[a-z\-]/,bt=/^[0-9a-fA-F]/,st=/^[+\-]/,et=/^[0-9]/,He=Ze("none"),Et=De("none",!1),Gt=De(")",!1),pi=De(",",!1),ei=Ze("whitespace"),pn=Fe([" ","	",`
`,"\r"],!1,!1),Sr=Ze("function"),je=De("(",!1),at=Ze("identifier"),rt=Fe([["a","z"],"-"],!1,!1),It=Ze("percentage"),ni=De("%",!1),Ai=Ze("length"),Ut=De("px",!1),pe=De("cm",!1),be=De("mm",!1),Le=De("in",!1),Ve=De("pt",!1),Ge=De("pc",!1),Be=Ze("angle"),Q=De("deg",!1),Je=De("rad",!1),Qe=De("grad",!1),Pe=De("turn",!1),dt=Ze("number"),vt=Ze("color"),$t=De("#",!1),Ct=Fe([["0","9"],["a","f"],["A","F"]],!1,!1),qt=Fe(["+","-"],!1,!1),oi=Fe([["0","9"]],!1,!1),Si=De(".",!1),Bi=De("e",!1),Ue=function(){return[]},Ls=function(de,Ne){return{type:"function",name:de,parameters:Ne||[]}},d=function(de,Ne){return Ne.length>0?L$(de,Ne,3):[de]},O=function(de){return{type:"quantity",value:de.value,unit:de.unit}},S=function(de){return{type:"color",colorType:de.type,value:de.value}},p=function(de){return de},l=function(){return Ie()},s=function(de){return{value:de,unit:"%"}},a=function(de){return{value:de,unit:"px"}},u=function(de){return{value:de,unit:"cm"}},f=function(de){return{value:de,unit:"mm"}},y=function(de){return{value:de,unit:"in"}},v=function(de){return{value:de,unit:"pt"}},_=function(de){return{value:de,unit:"pc"}},M=function(de){return{value:de,unit:"deg"}},$=function(de){return{value:de,unit:"rad"}},T=function(de){return{value:de,unit:"grad"}},A=function(de){return{value:de,unit:"turn"}},R=function(de){return{value:de,unit:null}},D=function(){return{type:"hex",value:Ie()}},V=function(de){return{type:"function",value:de}},Z=function(){return{type:"named",value:Ie()}},ee=function(){return parseFloat(Ie())},G=0,re=0,oe=[{line:1,column:1}],se=0,ge=[],me=0;if("startRule"in o){if(!(o.startRule in b))throw new Error(`Can't start parsing from rule "`+o.startRule+'".');x=b[o.startRule]}function Ie(){return n.substring(re,G)}function De(de,Ne){return{type:"literal",text:de,ignoreCase:Ne}}function Fe(de,Ne,Ke){return{type:"class",parts:de,inverted:Ne,ignoreCase:Ke}}function gt(){return{type:"end"}}function Ze(de){return{type:"other",description:de}}function Vt(de){var Ne,Ke=oe[de];if(Ke)return Ke;for(Ne=de-1;!oe[Ne];)Ne--;for(Ke={line:(Ke=oe[Ne]).line,column:Ke.column};Ne<de;)n.charCodeAt(Ne)===10?(Ke.line++,Ke.column=1):Ke.column++,Ne++;return oe[de]=Ke,Ke}function Rt(de,Ne){var Ke=Vt(de),ai=Vt(Ne);return{source:m,start:{offset:de,line:Ke.line,column:Ke.column},end:{offset:Ne,line:ai.line,column:ai.column}}}function lt(de){G<se||(G>se&&(se=G,ge=[]),ge.push(de))}function Ui(de,Ne,Ke){return new t(t.buildMessage(de,Ne),de,Ne,Ke)}function Vr(){var de;return(de=Wi())===h&&(de=Mi()),de}function Wi(){var de,Ne;return me++,de=G,Qt(),n.substr(G,4)===I?(Ne=I,G+=4):(Ne=h,me===0&&lt(Et)),Ne!==h?(Qt(),re=de,de=Ue()):(G=de,de=h),me--,de===h&&me===0&&lt(He),de}function Mi(){var de,Ne;if(de=[],(Ne=Ii())!==h)for(;Ne!==h;)de.push(Ne),Ne=Ii();else de=h;return de}function Ii(){var de,Ne,Ke,ai;return de=G,Qt(),(Ne=tn())!==h?(Qt(),(Ke=ri())===h&&(Ke=null),Qt(),n.charCodeAt(G)===41?(ai=E,G++):(ai=h,me===0&&lt(Gt)),ai!==h?(Qt(),re=de,de=Ls(Ne,Ke)):(G=de,de=h)):(G=de,de=h),de}function ri(){var de,Ne,Ke,ai,Kn,Ar,Bo,Pm;if(de=G,(Ne=sr())!==h){for(Ke=[],ai=G,Kn=Qt(),n.charCodeAt(G)===44?(Ar=k,G++):(Ar=h,me===0&&lt(pi)),Ar===h&&(Ar=null),Bo=Qt(),(Pm=sr())!==h?ai=Kn=[Kn,Ar,Bo,Pm]:(G=ai,ai=h);ai!==h;)Ke.push(ai),ai=G,Kn=Qt(),n.charCodeAt(G)===44?(Ar=k,G++):(Ar=h,me===0&&lt(pi)),Ar===h&&(Ar=null),Bo=Qt(),(Pm=sr())!==h?ai=Kn=[Kn,Ar,Bo,Pm]:(G=ai,ai=h);re=de,de=d(Ne,Ke)}else G=de,de=h;return de}function sr(){var de,Ne;return de=G,(Ne=Zn())===h&&(Ne=Pi())===h&&(Ne=qp())===h&&(Ne=Hp()),Ne!==h&&(re=de,Ne=O(Ne)),(de=Ne)===h&&(de=G,(Ne=Wp())!==h&&(re=de,Ne=S(Ne)),de=Ne),de}function Qt(){var de,Ne;for(me++,de=[],Ae.test(n.charAt(G))?(Ne=n.charAt(G),G++):(Ne=h,me===0&&lt(pn));Ne!==h;)de.push(Ne),Ae.test(n.charAt(G))?(Ne=n.charAt(G),G++):(Ne=h,me===0&&lt(pn));return me--,Ne=h,me===0&&lt(ei),de}function tn(){var de,Ne,Ke;return me++,de=G,(Ne=di())!==h?(n.charCodeAt(G)===40?(Ke=P,G++):(Ke=h,me===0&&lt(je)),Ke!==h?(re=de,de=p(Ne)):(G=de,de=h)):(G=de,de=h),me--,de===h&&(Ne=h,me===0&&lt(Sr)),de}function di(){var de,Ne,Ke;if(me++,de=G,Ne=[],Oe.test(n.charAt(G))?(Ke=n.charAt(G),G++):(Ke=h,me===0&&lt(rt)),Ke!==h)for(;Ke!==h;)Ne.push(Ke),Oe.test(n.charAt(G))?(Ke=n.charAt(G),G++):(Ke=h,me===0&&lt(rt));else Ne=h;return Ne!==h&&(re=de,Ne=l()),me--,(de=Ne)===h&&(Ne=h,me===0&&lt(at)),de}function Zn(){var de,Ne,Ke;return me++,de=G,Qt(),(Ne=vs())!==h?(n.charCodeAt(G)===37?(Ke=F,G++):(Ke=h,me===0&&lt(ni)),Ke!==h?(re=de,de=s(Ne)):(G=de,de=h)):(G=de,de=h),me--,de===h&&me===0&&lt(It),de}function Pi(){var de,Ne,Ke;return me++,de=G,Qt(),(Ne=vs())!==h?(n.substr(G,2)===N?(Ke=N,G+=2):(Ke=h,me===0&&lt(Ut)),Ke!==h?(re=de,de=a(Ne)):(G=de,de=h)):(G=de,de=h),de===h&&(de=G,Qt(),(Ne=vs())!==h?(n.substr(G,2)===B?(Ke=B,G+=2):(Ke=h,me===0&&lt(pe)),Ke!==h?(re=de,de=u(Ne)):(G=de,de=h)):(G=de,de=h),de===h&&(de=G,Qt(),(Ne=vs())!==h?(n.substr(G,2)===z?(Ke=z,G+=2):(Ke=h,me===0&&lt(be)),Ke!==h?(re=de,de=f(Ne)):(G=de,de=h)):(G=de,de=h),de===h&&(de=G,Qt(),(Ne=vs())!==h?(n.substr(G,2)===q?(Ke=q,G+=2):(Ke=h,me===0&&lt(Le)),Ke!==h?(re=de,de=y(Ne)):(G=de,de=h)):(G=de,de=h),de===h&&(de=G,Qt(),(Ne=vs())!==h?(n.substr(G,2)===J?(Ke=J,G+=2):(Ke=h,me===0&&lt(Ve)),Ke!==h?(re=de,de=v(Ne)):(G=de,de=h)):(G=de,de=h),de===h&&(de=G,Qt(),(Ne=vs())!==h?(n.substr(G,2)===X?(Ke=X,G+=2):(Ke=h,me===0&&lt(Ge)),Ke!==h?(re=de,de=_(Ne)):(G=de,de=h)):(G=de,de=h)))))),me--,de===h&&me===0&&lt(Ai),de}function qp(){var de,Ne,Ke;return me++,de=G,(Ne=vs())!==h?(n.substr(G,3)===Y?(Ke=Y,G+=3):(Ke=h,me===0&&lt(Q)),Ke!==h?(re=de,de=M(Ne)):(G=de,de=h)):(G=de,de=h),de===h&&(de=G,(Ne=vs())!==h?(n.substr(G,3)===ae?(Ke=ae,G+=3):(Ke=h,me===0&&lt(Je)),Ke!==h?(re=de,de=$(Ne)):(G=de,de=h)):(G=de,de=h),de===h&&(de=G,(Ne=vs())!==h?(n.substr(G,4)===he?(Ke=he,G+=4):(Ke=h,me===0&&lt(Qe)),Ke!==h?(re=de,de=T(Ne)):(G=de,de=h)):(G=de,de=h),de===h&&(de=G,(Ne=vs())!==h?(n.substr(G,4)===fe?(Ke=fe,G+=4):(Ke=h,me===0&&lt(Pe)),Ke!==h?(re=de,de=A(Ne)):(G=de,de=h)):(G=de,de=h)))),me--,de===h&&(Ne=h,me===0&&lt(Be)),de}function Hp(){var de,Ne;return me++,de=G,Qt(),(Ne=vs())!==h?(re=de,de=R(Ne)):(G=de,de=h),me--,de===h&&me===0&&lt(dt),de}function Wp(){var de,Ne,Ke,ai;if(me++,de=G,n.charCodeAt(G)===35?(Ne=ye,G++):(Ne=h,me===0&&lt($t)),Ne!==h){if(Ke=[],bt.test(n.charAt(G))?(ai=n.charAt(G),G++):(ai=h,me===0&&lt(Ct)),ai!==h)for(;ai!==h;)Ke.push(ai),bt.test(n.charAt(G))?(ai=n.charAt(G),G++):(ai=h,me===0&&lt(Ct));else Ke=h;Ke!==h?(re=de,de=D()):(G=de,de=h)}else G=de,de=h;return de===h&&(de=G,(Ne=Ii())!==h&&(re=de,Ne=V(Ne)),(de=Ne)===h&&(de=G,(Ne=di())!==h&&(re=de,Ne=Z()),de=Ne)),me--,de===h&&(Ne=h,me===0&&lt(vt)),de}function vs(){var de,Ne,Ke,ai,Kn,Ar,Bo;for(de=G,st.test(n.charAt(G))?(n.charAt(G),G++):me===0&&lt(qt),Ne=G,Ke=[],et.test(n.charAt(G))?(ai=n.charAt(G),G++):(ai=h,me===0&&lt(oi));ai!==h;)Ke.push(ai),et.test(n.charAt(G))?(ai=n.charAt(G),G++):(ai=h,me===0&&lt(oi));if(n.charCodeAt(G)===46?(ai=xe,G++):(ai=h,me===0&&lt(Si)),ai!==h){if(Kn=[],et.test(n.charAt(G))?(Ar=n.charAt(G),G++):(Ar=h,me===0&&lt(oi)),Ar!==h)for(;Ar!==h;)Kn.push(Ar),et.test(n.charAt(G))?(Ar=n.charAt(G),G++):(Ar=h,me===0&&lt(oi));else Kn=h;Kn!==h?Ne=Ke=[Ke,ai,Kn]:(G=Ne,Ne=h)}else G=Ne,Ne=h;if(Ne===h)if(Ne=[],et.test(n.charAt(G))?(Ke=n.charAt(G),G++):(Ke=h,me===0&&lt(oi)),Ke!==h)for(;Ke!==h;)Ne.push(Ke),et.test(n.charAt(G))?(Ke=n.charAt(G),G++):(Ke=h,me===0&&lt(oi));else Ne=h;if(Ne!==h){if(Ke=G,n.charCodeAt(G)===101?(ai=Se,G++):(ai=h,me===0&&lt(Bi)),ai!==h){if(st.test(n.charAt(G))?(Kn=n.charAt(G),G++):(Kn=h,me===0&&lt(qt)),Kn===h&&(Kn=null),Ar=[],et.test(n.charAt(G))?(Bo=n.charAt(G),G++):(Bo=h,me===0&&lt(oi)),Bo!==h)for(;Bo!==h;)Ar.push(Bo),et.test(n.charAt(G))?(Bo=n.charAt(G),G++):(Bo=h,me===0&&lt(oi));else Ar=h;Ar!==h?Ke=ai=[ai,Kn,Ar]:(G=Ke,Ke=h)}else G=Ke,Ke=h;Ke===h&&(Ke=null),re=de,de=ee()}else G=de,de=h;return de}function P$(de,Ne){return de.map(function(Ke){return Ke[Ne]})}function L$(de,Ne,Ke){return[de].concat(P$(Ne,Ke))}if((c=x())!==h&&G===n.length)return c;throw c!==h&&G<n.length&&lt(gt()),Ui(ge,se<n.length?n.charAt(se):null,se<n.length?Rt(se,se+1):Rt(se,se))}return e(t,Error),t.prototype.format=function(n){var o="Error: "+this.message;if(this.location){var c,h=null;for(c=0;c<n.length;c++)if(n[c].source===this.location.source){h=n[c].text.split(/\r\n|\n|\r/g);break}var m=this.location.start,b=this.location.source+":"+m.line+":"+m.column;if(h){var x=this.location.end,I=i("",m.line.toString().length," "),E=h[m.line-1],k=(m.line===x.line?x.column:E.length+1)-m.column||1;o+=`
 --> `+b+`
`+I+` |
`+m.line+" | "+E+`
`+I+" | "+i("",m.column-1," ")+i("",k,"^")}else o+=`
 at `+b}return o},t.buildMessage=function(n,o){var c={literal:function(k){return'"'+m(k.text)+'"'},class:function(k){var P=k.parts.map(function(F){return Array.isArray(F)?b(F[0])+"-"+b(F[1]):b(F)});return"["+(k.inverted?"^":"")+P.join("")+"]"},any:function(){return"any character"},end:function(){return"end of input"},other:function(k){return k.description}};function h(k){return k.charCodeAt(0).toString(16).toUpperCase()}function m(k){return k.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(P){return"\\x0"+h(P)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(P){return"\\x"+h(P)})}function b(k){return k.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(P){return"\\x0"+h(P)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(P){return"\\x"+h(P)})}function x(k){return c[k.type](k)}function I(k){var P,F,N=k.map(x);if(N.sort(),N.length>0){for(P=1,F=1;P<N.length;P++)N[P-1]!==N[P]&&(N[F]=N[P],F++);N.length=F}switch(N.length){case 1:return N[0];case 2:return N[0]+" or "+N[1];default:return N.slice(0,-1).join(", ")+", or "+N[N.length-1]}}function E(k){return k?'"'+m(k)+'"':"end of input"}return"Expected "+I(n)+" but "+E(o)+" found."},{SyntaxError:t,parse:r}},(PW=OW).exports&&(PW.exports=LW());const x7={deg:1,grad:.9,rad:180/Math.PI,turn:360};function K9e(e){if(e.type!=="quantity"||!(e.value===0&&e.unit===null||e.unit&&x7[e.unit]!=null))throw new ue("effect:type-error",`Expected <angle>, Actual: ${B9(e)}`,{term:e})}const S7={px:1,cm:96/2.54,mm:96/2.54/10,in:96,pc:16,pt:96/72};function Y9e(e){if(e.type!=="quantity"||!(e.value===0&&e.unit===null||e.unit&&S7[e.unit]!=null))throw new ue("effect:type-error",`Expected <length>, Actual: ${B9(e)}`,{term:e})}function gc(e){Z9e(e);const t=e.value;return q_(t,e),e.unit==="%"?.01*t:t}function X9e(e){return J9e(e),q_(e.value,e),e.value}function Q9e(e){return K9e(e),e.value*x7[e.unit]||0}function M7(e){return Y9e(e),e.value*S7[e.unit]||0}function eMe(e){switch(e.colorType){case"hex":return S1e(e.value);case"named":return FW(e.value);case"function":return rMe(e.value)}}function FW(e){if(!rG(e))throw new ue("effect:unknown-color",`color '${e}' isn't valid`,{namedColor:e});return x1e(e)}const tMe=/^rgba?/i,iMe=/^hsla?/i;function rMe(e){if(a1(e.parameters,4),tMe.test(e.name))return[gc(e.parameters[0]),gc(e.parameters[1]),gc(e.parameters[2]),e.parameters[3]?gc(e.parameters[3]):1];if(iMe.test(e.name))return nG(X9e(e.parameters[0]),gc(e.parameters[1]),gc(e.parameters[2]),e.parameters[3]?gc(e.parameters[3]):1);throw new ue("effect:syntax-error",`Invalid color function '${e.name}'`,{colorFunction:e})}function I7(e,t,i){var r;try{return sMe(e)}catch(n){(r=i==null?void 0:i.messages)==null||r.push(n)}return null}function $7(e,t,i,r){try{const n=nMe(e);eo(i,n,t)}catch(n){r.messages&&r.messages.push(n)}}function nMe(e){const t=_7(e);return t?V9e(t)?t.map(i=>i.toJSON()):t.map(({scale:i,effects:r})=>({scale:i,value:r.map(n=>n.toJSON())})):null}function sMe(e){if(!e||e.length===0)return null;if(oMe(e)){const t=[];for(const i of e)t.push({scale:i.scale,value:U9(i.value)});return t}return U9(e)}function oMe(e){const t=e[0];return!!t&&"scale"in t}function U9(e){if(!e||!e.length)return"";const t=[];for(const i of e){let r=[];switch(i.type){case"grayscale":case"sepia":case"saturate":case"invert":case"brightness":case"contrast":case"opacity":r=[jh(i,"amount")];break;case"blur":r=[jh(i,"radius","pt")];break;case"hue-rotate":r=[jh(i,"angle","deg")];break;case"drop-shadow":r=[jh(i,"xoffset","pt"),jh(i,"yoffset","pt"),jh(i,"blurRadius","pt"),aMe(i,"color")];break;case"bloom":r=[jh(i,"strength"),jh(i,"radius","pt"),jh(i,"threshold")]}const n=`${i.type}(${r.filter(Boolean).join(" ")})`;_7(n),t.push(n)}return t.join(" ")}function jh(e,t,i){if(e[t]==null)throw new ue("effect:missing-parameter",`Missing parameter '${t}' in ${e.type} effect`,{effect:e});return i?e[t]+i:""+e[t]}function aMe(e,t){if(e[t]==null)throw new ue("effect:missing-parameter",`Missing parameter '${t}' in ${e.type} effect`,{effect:e});const i=e[t];return`rgba(${i[0]||0}, ${i[1]||0}, ${i[2]||0}, ${i[3]/255||0})`}const E7=-3;var Qd;(function(e){e[e.ALL=0]="ALL",e[e.SOME=1]="SOME"})(Qd||(Qd={}));class bZe{constructor(t,i,r){this._namespace=t,this._storage=i,this._removeFunc=!1,this._hit=0,this._miss=0,this._storage.register(this),this._namespace+=":",r&&(this._storage.registerRemoveFunc(this._namespace,r),this._removeFunc=!0)}destroy(){this._storage.clear(this._namespace),this._removeFunc&&this._storage.deregisterRemoveFunc(this._namespace),this._storage.deregister(this),this._storage=null}get namespace(){return this._namespace.slice(0,-1)}get hitRate(){return this._hit/(this._hit+this._miss)}get size(){return this._storage.size}get maxSize(){return this._storage.maxSize}resetHitRate(){this._hit=this._miss=0}put(t,i,r,n=0){this._storage.put(this._namespace+t,i,r,n)}get(t){const i=this._storage.get(this._namespace+t);return i===void 0?++this._miss:++this._hit,i}pop(t){const i=this._storage.pop(this._namespace+t);return i===void 0?++this._miss:++this._hit,i}updateSize(t,i,r){this._storage.updateSize(this._namespace+t,i,r)}clear(){this._storage.clear(this._namespace)}clearAll(){this._storage.clearAll()}getStats(){return this._storage.getStats()}resetStats(){this._storage.resetStats()}}class NW{constructor(t=10485760){this._maxSize=t,this._db=new Map,this._size=0,this._hit=0,this._miss=0,this._removeFuncs=new ld,this._users=new ld}destroy(){this.clearAll(),this._removeFuncs.clear(),this._users.clear(),this._db=null}register(t){this._users.push(t)}deregister(t){this._users.removeUnordered(t)}registerRemoveFunc(t,i){this._removeFuncs.push([t,i])}deregisterRemoveFunc(t){this._removeFuncs.filterInPlace(i=>i[0]!==t)}get size(){return this._size}get maxSize(){return this._maxSize}set maxSize(t){this._maxSize=Math.max(t,0),this._checkSizeLimit()}put(t,i,r,n){const o=this._db.get(t);if(o&&(this._size-=o.size,this._db.delete(t),o.entry!==i&&this._notifyRemove(t,o.entry,Qd.ALL)),r>this._maxSize)return void this._notifyRemove(t,i,Qd.ALL);if(i===void 0)return void console.warn("Refusing to cache undefined entry ");if(!r||r<0)return void console.warn("Refusing to cache entry with invalid size "+r);const c=1+Math.max(n,E7)-E7;this._db.set(t,{entry:i,size:r,lifetime:c,lives:c}),this._size+=r,this._checkSizeLimit()}updateSize(t,i,r){const n=this._db.get(t);if(n&&n.entry===i){for(this._size-=n.size;r>this._maxSize;){const o=this._notifyRemove(t,i,Qd.SOME);if(!(H(o)&&o>0))return void this._db.delete(t);r=o}n.size=r,this._size+=r,this._checkSizeLimit()}}pop(t){const i=this._db.get(t);if(i)return this._size-=i.size,this._db.delete(t),++this._hit,i.entry;++this._miss}get(t){const i=this._db.get(t);if(i!==void 0)return this._db.delete(t),i.lives=i.lifetime,this._db.set(t,i),++this._hit,i.entry;++this._miss}getStats(){const t={Size:Math.round(this._size/1048576)+"/"+Math.round(this._maxSize/1048576)+"MB","Hit rate":Math.round(100*this._getHitRate())+"%",Entries:this._db.size.toString()},i={},r=new Array;this._db.forEach((c,h)=>{const m=c.lifetime;r[m]=(r[m]||0)+c.size,this._users.forAll(b=>{const x=b.namespace;if(h.startsWith(x)){const I=i[x]||0;i[x]=I+c.size}})});const n={};this._users.forAll(c=>{const h=c.namespace;if(!isNaN(c.hitRate)&&c.hitRate>0){const m=i[h]||0;i[h]=m,n[h]=Math.round(100*c.hitRate)+"%"}else n[h]="0%"});const o=Object.keys(i);o.sort((c,h)=>i[h]-i[c]),o.forEach(c=>t[c]=Math.round(i[c]/2**20)+"MB / "+n[c]);for(let c=r.length-1;c>=0;--c){const h=r[c];h&&(t["Priority "+(c+E7-1)]=Math.round(h/this.size*100)+"%")}return t}resetStats(){this._hit=this._miss=0,this._users.forAll(t=>t.resetHitRate())}clear(t){this._db.forEach((i,r)=>{r.startsWith(t)&&(this._size-=i.size,this._db.delete(r),this._notifyRemove(r,i.entry,Qd.ALL))})}clearAll(){this._db.forEach((t,i)=>this._notifyRemove(i,t.entry,Qd.ALL)),this._size=0,this._db.clear()}_getHitRate(){return this._hit/(this._hit+this._miss)}_notifyRemove(t,i,r){let n;return this._removeFuncs.some(o=>{if(t.startsWith(o[0])){const c=o[1](i,r);return typeof c=="number"&&(n=c),!0}return!1}),n}_checkSizeLimit(){if(!(this._size<=this._maxSize))for(const[t,i]of this._db){if(this._db.delete(t),i.lives<=1){this._size-=i.size;const r=this._notifyRemove(t,i.entry,Qd.SOME);H(r)&&r>0&&(this._size+=r,i.lives=i.lifetime,i.size=r,this._db.set(t,i))}else--i.lives,this._db.set(t,i);if(this._size<=.9*this.maxSize)return}}}class T7{constructor(t,i){this._storage=new NW,this._storage.maxSize=t,i&&this._storage.registerRemoveFunc("",i)}put(t,i){this._storage.put(t,i,1,1)}pop(t){return this._storage.pop(t)}get(t){return this._storage.get(t)}clear(){this._storage.clearAll()}destroy(){this._storage.destroy()}}function lMe(e){return typeof e=="function"}function wZe(e,t,i,r){return lMe(e)?e(t,i,r):e}function _Ze(e){return[e.r,e.g,e.b,e.a]}const cMe=` /-,
`;function DW(e){let t=e.length;for(;t--;)if(!cMe.includes(e.charAt(t)))return!1;return!0}function uMe(e,t){const i=[];let r=0,n=-1;do if(n=e.indexOf("[",r),n>=r){if(n>r){const o=e.substr(r,n-r);i.push([o,null,DW(o)])}if(r=n+1,n=e.indexOf("]",r),n>=r){if(n>r){const o=t[e.substr(r,n-r)];o&&i.push([null,o,!1])}r=n+1}}while(n!==-1);if(r<e.length-1){const o=e.substr(r);i.push([o,null,DW(o)])}return i}function hMe(e,t,i){let r="",n=null;for(const o of t){const[c,h,m]=o;if(c)m?n=c:(n&&(r+=n,n=null),r+=c);else{const b=e.attributes[h];b&&(n&&(r+=n,n=null),r+=b)}}return pMe(r,i)}function xZe(e,t,i){const r=uMe(t,e);return n=>hMe(n,r,i)}function pMe(e,t){switch(typeof e!="string"&&(e=String(e)),t){case"LowerCase":return e.toLowerCase();case"Allcaps":return e.toUpperCase();default:return e}}function SZe(e,t,i,r,n,o,c=!0){const h=t/n,m=i/o,b=Math.ceil(h/2),x=Math.ceil(m/2);for(let I=0;I<o;I++)for(let E=0;E<n;E++){const k=4*(E+(c?o-I-1:I)*n);let P=0,F=0,N=0,B=0,z=0,q=0,J=0;const X=(I+.5)*m;for(let Y=Math.floor(I*m);Y<(I+1)*m;Y++){const ae=Math.abs(X-(Y+.5))/x,he=(E+.5)*h,fe=ae*ae;for(let ye=Math.floor(E*h);ye<(E+1)*h;ye++){let xe=Math.abs(he-(ye+.5))/b;const Se=Math.sqrt(fe+xe*xe);Se>=-1&&Se<=1&&(P=2*Se*Se*Se-3*Se*Se+1,P>0&&(xe=4*(ye+Y*t),J+=P*e[xe+3],N+=P,e[xe+3]<255&&(P=P*e[xe+3]/250),B+=P*e[xe],z+=P*e[xe+1],q+=P*e[xe+2],F+=P))}}r[k]=B/F,r[k+1]=z/F,r[k+2]=q/F,r[k+3]=J/N}}function dMe(e){return e?{r:e[0],g:e[1],b:e[2],a:e[3]/255}:{r:0,g:0,b:0,a:0}}function jW(e){var t,i;return(i=(t=e.data)==null?void 0:t.symbol)!=null?i:null}function C7(e){return e.type==="CIMVectorMarker"||e.type==="CIMPictureMarker"||e.type==="CIMBarChartMarker"||e.type==="CIMCharacterMarker"||e.type==="CIMPieChartMarker"||e.type==="CIMStackedBarChartMarker"}function k7(e){return e.type==="CIMGradientStroke"||e.type==="CIMPictureStroke"||e.type==="CIMSolidStroke"}function fMe(e){return e.type==="CIMGradientFill"||e.type==="CIMHatchFill"||e.type==="CIMPictureFill"||e.type==="CIMSolidFill"||e.type==="CIMWaterFill"}function q9(e){return e.type==="CIMMarkerPlacementAlongLineRandomSize"||e.type==="CIMMarkerPlacementAlongLineSameSize"||e.type==="CIMMarkerPlacementAlongLineVariableSize"||e.type==="CIMMarkerPlacementAtExtremities"||e.type==="CIMMarkerPlacementAtMeasuredUnits"||e.type==="CIMMarkerPlacementAtRatioPositions"||e.type==="CIMMarkerPlacementOnLine"||e.type==="CIMMarkerPlacementOnVertices"}const MZe=(e,t=0)=>isNaN(e)||e==null?t:e,IZe=e=>{if(!e)return!1;for(const t of e)switch(t.type){case"CIMGeometricEffectBuffer":case"CIMGeometricEffectOffset":return!0}return!1};function $Ze(){return import("./geometryEngineJSON.7fc72f00.js")}function EZe(e){if(!e)return"normal";switch(e.toLowerCase()){case"italic":return"italic";case"oblique":return"oblique";default:return"normal"}}function TZe(e){if(!e)return"normal";switch(e.toLowerCase()){case"bold":return"bold";case"bolder":return"bolder";case"lighter":return"lighter";default:return"normal"}}function CZe(e){let t="",i="";if(e){const r=e.toLowerCase();r.includes("italic")?t="italic":r.includes("oblique")&&(t="oblique"),r.includes("bold")?i="bold":r.includes("light")&&(i="lighter")}return{style:t,weight:i}}function kZe(e){return e.underline?"underline":e.strikethrough?"line-through":"none"}function VW(e){if(!e)return null;switch(e.type){case"CIMPolygonSymbol":if(e.symbolLayers)for(const t of e.symbolLayers){const i=VW(t);if(i!=null)return i}break;case"CIMTextSymbol":return VW(e.symbol);case"CIMSolidFill":return e.color}}function zW(e){if(e)switch(e.type){case"CIMPolygonSymbol":case"CIMLineSymbol":if(e.symbolLayers)for(const t of e.symbolLayers){const i=zW(t);if(i!==void 0)return i}break;case"CIMTextSymbol":return zW(e.symbol);case"CIMSolidStroke":case"CIMSolidFill":return e.color}}function GW(e){if(e)switch(e.type){case"CIMPolygonSymbol":case"CIMLineSymbol":if(e.symbolLayers)for(const t of e.symbolLayers){const i=GW(t);if(i!==void 0)return i}break;case"CIMTextSymbol":return GW(e.symbol);case"CIMSolidStroke":case"CIMGradientStroke":case"CIMPictureStroke":return e.width}}function AZe(e){switch(e){case"Left":default:return"left";case"Right":return"right";case"Center":case"Justify":return"center"}}function PZe(e){switch(e){case"Top":default:return"top";case"Center":return"middle";case"Baseline":return"baseline";case"Bottom":return"bottom"}}function LZe(e){return(e?Object.keys(e):[]).map(t=>({name:t,alias:t,type:typeof e[t]=="string"?"esriFieldTypeString":"esriFieldTypeDouble"}))}const OZe=e=>e.includes("data:image/svg+xml");function RZe(e){if(!e)return null;switch(e.type){case"CIMPointSymbol":case"CIMTextSymbol":return"esriGeometryPoint";case"CIMLineSymbol":return"esriGeometryPolyline";case"CIMPolygonSymbol":return"esriGeometryPolygon";default:return null}}function BW(e,t,i,r){if(e)if(e.type!=="CIMTextSymbol"){if(i&&e.effects)for(const n of e.effects)gMe(n,t);if(e.symbolLayers)for(const n of e.symbolLayers)switch(n.type){case"CIMPictureMarker":case"CIMVectorMarker":yMe(n,t,r);break;case"CIMPictureStroke":case"CIMSolidStroke":!(r==null?void 0:r.preserveOutlineWidth)&&n.width&&(n.width*=t);break;case"CIMPictureFill":n.height&&(n.height*=t),n.offsetX&&(n.offsetX*=t),n.offsetY&&(n.offsetY*=t);break;case"CIMHatchFill":BW(n.lineSymbol,t,!0,Ce(K({},r),{preserveOutlineWidth:!1})),n.offsetX&&(n.offsetX*=t),n.offsetY&&(n.offsetY*=t),n.separation&&(n.separation*=t)}}else e.height!=null&&(e.height*=t)}function yMe(e,t,i){if(e&&(e.markerPlacement&&mMe(e.markerPlacement,t),e.offsetX&&(e.offsetX*=t),e.offsetY&&(e.offsetY*=t),e.anchorPoint&&e.anchorPointUnits==="Absolute"&&(e.anchorPoint={x:e.anchorPoint.x*t,y:e.anchorPoint.y*t}),e.size=e.size!=null?e.size*t:0,e.type==="CIMVectorMarker"&&e.markerGraphics))for(const r of e.markerGraphics)e.scaleSymbolsProportionally||BW(r.symbol,t,!0,i)}function mMe(e,t){switch(q9(e)&&e.offset&&(e.offset*=t),e.type){case"CIMMarkerPlacementAlongLineRandomSize":case"CIMMarkerPlacementAlongLineSameSize":if(e.customEndingOffset&&(e.customEndingOffset*=t),e.offsetAlongLine&&(e.offsetAlongLine*=t),e.placementTemplate&&e.placementTemplate.length){const i=e.placementTemplate.map(r=>r*t);e.placementTemplate=i}break;case"CIMMarkerPlacementAlongLineVariableSize":if(e.maxRandomOffset&&(e.maxRandomOffset*=t),e.placementTemplate&&e.placementTemplate.length){const i=e.placementTemplate.map(r=>r*t);e.placementTemplate=i}break;case"CIMMarkerPlacementOnLine":e.startPointOffset&&(e.startPointOffset*=t);break;case"CIMMarkerPlacementAtExtremities":e.offsetAlongLine&&(e.offsetAlongLine*=t);break;case"CIMMarkerPlacementAtMeasuredUnits":case"CIMMarkerPlacementOnVertices":break;case"CIMMarkerPlacementAtRatioPositions":e.beginPosition&&(e.beginPosition*=t),e.endPosition&&(e.endPosition*=t);break;case"CIMMarkerPlacementPolygonCenter":e.offsetX&&(e.offsetX*=t),e.offsetY&&(e.offsetY*=t);break;case"CIMMarkerPlacementInsidePolygon":e.offsetX&&(e.offsetX*=t),e.offsetY&&(e.offsetY*=t),e.stepX&&(e.stepX*=t),e.stepY&&(e.stepY*=t)}}function gMe(e,t){switch(e.type){case"CIMGeometricEffectArrow":case"CIMGeometricEffectDonut":e.width&&(e.width*=t);break;case"CIMGeometricEffectBuffer":e.size&&(e.size*=t);break;case"CIMGeometricEffectCut":e.beginCut&&(e.beginCut*=t),e.endCut&&(e.endCut*=t),e.middleCut&&(e.middleCut*=t);break;case"CIMGeometricEffectDashes":if(e.customEndingOffset&&(e.customEndingOffset*=t),e.offsetAlongLine&&(e.offsetAlongLine*=t),e.dashTemplate&&e.dashTemplate.length){const i=e.dashTemplate.map(r=>r*t);e.dashTemplate=i}break;case"CIMGeometricEffectExtension":case"CIMGeometricEffectJog":case"CIMGeometricEffectRadial":e.length&&(e.length*=t);break;case"CIMGeometricEffectMove":e.offsetX&&(e.offsetX*=t),e.offsetY&&(e.offsetY*=t);break;case"CIMGeometricEffectOffset":case"CIMGeometricEffectOffsetTangent":e.offset&&(e.offset*=t);break;case"CIMGeometricEffectRegularPolygon":e.radius&&(e.radius*=t);break;case"CIMGeometricEffectTaperedPolygon":e.fromWidth&&(e.fromWidth*=t),e.length&&(e.length*=t),e.toWidth&&(e.toWidth*=t);break;case"CIMGeometricEffectWave":e.amplitude&&(e.amplitude*=t),e.period&&(e.period*=t)}}function vMe(e){const t=[];return A7(jW(e),t),t.length?new ut(dMe(t[0])):null}function A7(e,t){var n;if(!e)return;let i;i=e.type==="CIMTextSymbol"?e.symbol:e;const r=e.type==="CIMPolygonSymbol";if(i==null?void 0:i.symbolLayers){for(const o of i.symbolLayers)if(!(o.colorLocked||r&&(k7(o)||C7(o)&&o.markerPlacement&&q9(o.markerPlacement))))switch(o.type){case"CIMPictureMarker":case"CIMPictureStroke":case"CIMPictureFill":o.tintColor&&UW(t,o.tintColor);break;case"CIMVectorMarker":(n=o.markerGraphics)==null||n.forEach(c=>{A7(c.symbol,t)});break;case"CIMSolidStroke":case"CIMSolidFill":UW(t,o.color);break;case"CIMHatchFill":A7(o.lineSymbol,t)}}}function UW(e,t){for(const i of e)if(i.join(".")===t.join("."))return;e.push(t)}function qW(e,t,i){t instanceof ut||(t=new ut(t));const r=jW(e);r&&P7(r,t,i)}function P7(e,t,i){var o;if(!e)return;let r;r=e.type==="CIMTextSymbol"?e.symbol:e;const n=(r==null?void 0:r.type)==="CIMPolygonSymbol";if(r==null?void 0:r.symbolLayers)for(const c of r.symbolLayers){if(c.colorLocked)continue;if(n){if(i){const{layersToColor:m}=i;if((k7(c)||C7(c)&&c.markerPlacement&&q9(c.markerPlacement))&&m==="fill"||fMe(c)&&m==="outline")continue}else if(k7(c)||C7(c)&&c.markerPlacement&&q9(c.markerPlacement))continue}const h=t.toArray();switch(c.type){case"CIMPictureMarker":case"CIMPictureStroke":case"CIMPictureFill":c.tintColor=h;break;case"CIMVectorMarker":(o=c.markerGraphics)==null||o.forEach(m=>{P7(m.symbol,t,i)});break;case"CIMSolidStroke":case"CIMSolidFill":c.color=h;break;case"CIMHatchFill":P7(c.lineSymbol,t,i)}}}const HW="picture-fill",WW="simple-fill",bMe="simple-line",JW="simple-marker",wMe="text",_Me="cim",L7=new T7(1e3);function xMe(e){const t=e.style;let i=null;if(e)switch(e.type){case JW:t!=="cross"&&t!=="x"&&(i=e.color);break;case WW:t==="solid"?i=e.color:t!=="none"&&(i={type:"pattern",x:0,y:0,src:_i(`esri/symbols/patterns/${t}.png`),width:5,height:5});break;case HW:i={type:"pattern",src:e.url,width:or(e.width)*e.xscale,height:or(e.height)*e.yscale,x:or(e.xoffset),y:or(e.yoffset)};break;case wMe:i=e.color;break;case _Me:i=vMe(e)}return i}function SMe(e,t){const i=e+"-"+t;return L7.get(i)!==void 0?Promise.resolve(L7.get(i)):Nt(e,{responseType:"image"}).then(r=>{const n=r.data,o=n.naturalWidth,c=n.naturalHeight,h=document.createElement("canvas");h.width=o,h.height=c;const m=h.getContext("2d");m.fillStyle=t,m.fillRect(0,0,o,c),m.globalCompositeOperation="destination-in",m.drawImage(n,0,0);const b=h.toDataURL();return L7.put(i,b),b})}function H_(e){if(!e)return null;let t=null;switch(e.type){case WW:case HW:case JW:t=H_(e.outline);break;case bMe:{const i=or(e.width);e.style!=null&&e.style!=="none"&&i!==0&&(t={color:e.color,style:O7(e.style),width:i,cap:e.cap,join:e.join==="miter"?or(e.miterLimit):e.join});break}default:t=null}return t}const O7=(()=>{const e={};return t=>{if(e[t])return e[t];const i=t.replace(/-/g,"");return e[t]=i,i}})(),MMe=new ut([128,128,128]),ZW=/\/resource\/(.*?)\.svg$/,IMe=new ut("white");function $Me(e){const t=e.symbolLayers&&e.symbolLayers.length;if(!t)return;const i=e.symbolLayers.getItemAt(t-1);return"outline"in i?Yb(i,"outline","size"):void 0}function EMe(e){var t;if(!e)return 0;if(uc(e)){const i=$Me(e);return H(i)?i:0}return $n((t=H_(e))==null?void 0:t.width)}function H9(e){if(ce(e)||!("symbolLayers"in e)||ce(e.symbolLayers))return!1;switch(e.type){case"point-3d":return e.symbolLayers.some(t=>t.type==="object");case"line-3d":return e.symbolLayers.some(t=>t.type==="path");case"polygon-3d":return e.symbolLayers.some(t=>t.type==="object"||t.type==="extrude");default:return!1}}function TMe(e,t){const i=Yn(t.resource).href;return!Te("esri-canvas-svg-support")&&e.styleOrigin&&ZW.test(i)?i.replace(ZW,"/resource/png/$1.png"):i}function l1(e,t){if(!e)return null;let i=null;return uc(e)?i=CMe(e):D5(e)&&(i=e.color?new ut(e.color):null),i?W_(i,t):null}function CMe(e){const t=e.symbolLayers;if(!t)return null;let i=null;return t.forEach(r=>{var n;r.type==="object"&&((n=r.resource)==null?void 0:n.href)!=null||(i=r.type==="water"?Ht(r.color):H(r.material)?Ht(r.material.color):null)}),i?new ut(i):null}function W_(e,t){if(t==null||e==null)return e;const i=e.toRgba();return i[3]=i[3]*t,new ut(i)}function kMe(e,t,i){const r=e.symbolLayers;if(!r)return;const n=o=>{var h;const c=H(o)?o:null;return W_(t=(h=t!=null?t:c)!=null?h:i!=null?IMe:null,i)};r.forEach(o=>{var c;if(o.type!=="object"||((c=o.resource)==null?void 0:c.href)==null||t)if(o.type==="water")o.color=n(o.color);else{const h=H(o.material)?o.material.color:null,m=n(h);ce(o.material)?o.material=new Oa({color:m}):o.material.color=m,i!=null&&"outline"in o&&H(o.outline)&&H(o.outline.color)&&(o.outline.color=W_(o.outline.color,i))}})}function AMe(e,t,i){(t=t!=null?t:e.color)&&(e.color=W_(t,i)),i!=null&&"outline"in e&&e.outline&&e.outline.color&&(e.outline.color=W_(e.outline.color,i))}function R7(e,t,i){e&&(t||i!=null)&&(t&&(t=new ut(t)),uc(e)?kMe(e,t,i):D5(e)&&AMe(e,t,i))}async function PMe(e,t){const i=e.symbolLayers;i&&await Owe(i,async r=>LMe(r,t))}async function LMe(e,t){switch(e.type){case"extrude":RMe(e,t);break;case"icon":case"line":case"text":OMe(e,t);break;case"path":NMe(e,t);break;case"object":await FMe(e,t)}}function OMe(e,t){const i=KW(t);H(i)&&(e.size=i)}function KW(e){for(const t of e)if(typeof t=="number")return t;return null}function RMe(e,t){e.size=typeof t[2]=="number"?t[2]:0}async function FMe(e,t){const{resourceSize:i,symbolSize:r}=await DMe(e),n=YW(t,i,r);e.width=J_(t[0],r[0],i[0],n),e.depth=J_(t[1],r[1],i[1],n),e.height=J_(t[2],r[2],i[2],n)}function NMe(e,t){const i=YW(t,pG,[e.width,void 0,e.height]);e.width=J_(t[0],e.width,1,i),e.height=J_(t[2],e.height,1,i)}function YW(e,t,i){for(let r=0;r<3;r++){const n=e[r];switch(n){case"symbol-value":{const o=i[r];return o!=null?o/t[r]:1}case"proportional":break;default:if(n&&t[r])return n/t[r]}}return 1}async function DMe(e){const t=await import("./symbolLayerUtils.3e402cf4.js"),i=await t.computeObjectLayerResourceSize(e,10),{width:r,height:n,depth:o}=e,c=[r,o,n];let h=1;for(let m=0;m<3;m++){const b=c[m];if(b!=null){h=b/i[m];break}}for(let m=0;m<3;m++)c[m]==null&&(c[m]=i[m]*h);return{resourceSize:i,symbolSize:c}}function J_(e,t,i,r){switch(e){case"proportional":return i*r;case"symbol-value":return t!=null?t:i;default:return e}}function jMe(e,t){const i=KW(t);if(!ce(i))switch(e.type){case"simple-marker":e.size=i;break;case"picture-marker":{const r=e.width/e.height;r>1?(e.width=i,e.height=i*r):(e.width=i*r,e.height=i);break}case"simple-line":e.width=i;break;case"text":e.font.size=i}}async function VMe(e,t){if(e&&t)return uc(e)?PMe(e,t):void(D5(e)&&jMe(e,t))}function zMe(e,t,i){if(e&&t!=null)if(uc(e)){const r=e.symbolLayers;r&&r.forEach(n=>{if(n&&n.type==="object")switch(i){case"tilt":n.tilt=t;break;case"roll":n.roll=t;break;default:n.heading=t}})}else D5(e)&&(e.type!=="simple-marker"&&e.type!=="picture-marker"&&e.type!=="text"||(e.angle=t))}function Z_(e){if(!e)return null;const t=e.effects.filter(i=>i.type!=="bloom").map(i=>i.toJSON());return U9(t)}function FZe(e){return H(e)&&e.type==="polygon-3d"&&e.symbolLayers.some(t=>t.type==="extrude")}const XW="<",QW=">",GMe=fg("short-date");function eJ(e,t,i,r){let n="";t===0?n=`${XW} `:t===i&&(n=`${QW} `);let o=null;return o=r?Pa(e,GMe):$9e(e),n+o}const BMe=["data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAAAAAAAAAHqZRakAAAANUlEQVQ4jWPMy8v7z0BFwMLAwMAwcdIkqhiWn5fHwEQVk5DAqIGjBo4aOGrgqIEQwEjtKgAATl0Hu6JrzFUAAAAASUVORK5CYII=","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAAAAAAAAAHqZRakAAAANUlEQVQ4jWPMy8v7z0BFwMLAwMAwaeIkqhiWl5/HwEQVk5DAqIGjBo4aOGrgqIEQwEjtKgAATl0Hu6sKxboAAAAASUVORK5CYII=","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAAAAAAAAAHqZRakAAAANUlEQVQ4jWPMy8v7z0BFwMLAwMAwadJEqhiWl5fPwEQVk5DAqIGjBo4aOGrgqIEQwEjtKgAATl0Hu75+IUcAAAAASUVORK5CYII="];async function F7(e){if(!("visualVariables"in e)||!e.visualVariables)return null;const t=e.visualVariables.find(c=>c.type==="color");if(!t)return null;let i=null,r=null;if(t.stops){if(t.stops.length===1)return t.stops[0].color;i=t.stops[0].value,r=t.stops[t.stops.length-1].value}const n=i+(r-i)/2,{getColor:o}=await Promise.resolve().then(function(){return Ey});return o(t,n)}async function tJ(e,t){const i=e.trailCap,r=e.trailWidth||1,n=t||await F7(e)||e.color;return new rs({cap:i,color:n,width:r})}const UMe=new ut([64,64,64]);function iJ(e,t){const i=[],r=e.length-1;return e.length===5?i.push(0,2,4):i.push(0,r),e.map((n,o)=>i.includes(o)?eJ(n,o,r,t):null)}async function N7(e,t,i){let r=!1,n=[],o=[];if(e.stops){const b=e.stops;n=b.map(x=>x.value),r=b.some(x=>!!x.label),r&&(o=b.map(x=>x.label))}const c=n[0],h=n[n.length-1];if(c==null&&h==null)return null;const m=r?null:iJ(n,i);return(await Promise.all(n.map(async(b,x)=>({value:b,color:e.type==="opacity"?await qMe(b,e,t):(await Promise.resolve().then(function(){return Ey})).getColor(e,b),label:r?o[x]:m[x]})))).reverse()}async function qMe(e,t,i=UMe){const r=new ut(i),n=(await Promise.resolve().then(function(){return Ey})).getOpacity(t,e);return n!=null&&(r.a=n),r}function HMe(e){let t=!1,i=[],r=[];i=e.map(h=>h.value),t=e.some(h=>!!h.label),t&&(r=e.map(h=>h.label));const n=i[0],o=i[i.length-1];if(n==null&&o==null)return null;const c=t?null:iJ(i,!1);return i.map((h,m)=>({value:h,color:rJ(h,e),label:t?r[m]:c[m]})).reverse()}function rJ(e,t){const{startIndex:i,endIndex:r,weight:n}=WMe(e,t);if(i===r)return t[i].color;const o=ut.blendColors(t[i].color,t[r].color,n);return new ut(o)}function WMe(e,t){let i=0,r=t.length-1;return t.some((n,o)=>e<n.value?(r=o,!0):(i=o,!1)),{startIndex:i,endIndex:r,weight:(e-t[i].value)/(t[r].value-t[i].value)}}function JMe(e,t){let i=[];if(e&&e.type==="multipart")e.colorRamps.reverse().forEach((r,n)=>{n===0?i.push({value:t.max,color:new ut(r.toColor),label:"high"}):i.push({value:null,color:new ut(r.toColor),label:""}),n===e.colorRamps.length-1?i.push({value:t.min,color:new ut(r.fromColor),label:"low"}):i.push({value:null,color:new ut(r.fromColor),label:""})});else{let r,n;e&&e.type==="algorithmic"?(r=e.fromColor,n=e.toColor):(r=[0,0,0,1],n=[255,255,255,1]),i=[{value:t.max,color:new ut(n),label:"high"},{value:t.min,color:new ut(r),label:"low"}]}return i}var D7;let K_=D7=class extends ke{constructor(e){super(e),this.color=null,this.ratio=null}clone(){return new D7({color:this.color,ratio:this.ratio})}};g([w({type:ut,json:{type:[Ri],default:null,write:!0}})],K_.prototype,"color",void 0),g([w({type:Number,json:{write:!0}})],K_.prototype,"ratio",void 0),K_=D7=g([te("esri.renderers.support.HeatmapColorStop")],K_);const Y_=K_;function nJ(e){if(!e.colorStops)return[];const t=[...e.colorStops].filter(r=>{var n;return((n=r.color)==null?void 0:n.a)>0});let i=t.length-1;if(t&&t[0]){const r=t[i];r&&r.ratio!==1&&(t.push(new Y_({ratio:1,color:r.color})),i++)}return t.map((r,n)=>{var c,h;let o="";return n===0?o=((c=e.legendOptions)==null?void 0:c.minLabel)||"low":n===i&&(o=((h=e.legendOptions)==null?void 0:h.maxLabel)||"high"),{color:r.color,label:o,ratio:r.ratio}}).reverse()}$e.getLogger("esri.renderers.support.utils");async function za(e,t,i){Gj(e,t,()=>[]).push(...i)}async function ZMe(e){var i,r,n,o;const t=new Map;if(!e)return t;if("visualVariables"in e&&e.visualVariables){const c=e.visualVariables.filter(h=>h.type==="color");for(const h of c){const m=(await N7(h)).map(b=>b.color);await za(t,h.field||h.valueExpression,m)}}if(e.type==="heatmap"){const c=nJ(e).map(h=>h.color);await za(t,e.field||e.valueExpression,c)}else if(e.type==="pie-chart"){for(const c of e.attributes)await za(t,c.field||c.valueExpression,[c.color]);await za(t,"default",[(i=e==null?void 0:e.othersCategory)==null?void 0:i.color,l1(e.backgroundFillSymbol,null)])}else if(e.type==="dot-density"){for(const c of e.attributes)await za(t,c.field||c.valueExpression,[c.color]);await za(t,"default",[e.backgroundColor])}else if(e.type==="unique-value")if(((r=e.authoringInfo)==null?void 0:r.type)==="predominance")for(const c of(n=e.uniqueValueInfos)!=null?n:[])await za(t,c.value.toString(),[l1(c.symbol,null)]);else{const c=((o=e.uniqueValueInfos)!=null?o:[]).map(I=>l1(I.symbol,null)),{field:h,field2:m,field3:b,valueExpression:x}=e;(h||x)&&await za(t,h||x,c),m&&await za(t,m,c),b&&await za(t,b,c)}else if(e.type==="class-breaks"){const c=e.classBreakInfos.map(b=>l1(b.symbol,null)),{field:h,valueExpression:m}=e;await za(t,h!=null?h:m,c)}else e.type==="simple"&&await za(t,"default",[l1(e.symbol,null)]);return"defaultSymbol"in e&&e.defaultSymbol&&await za(t,"default",[l1(e.defaultSymbol,null)]),t.forEach((c,h)=>{const m=E0e(c.filter(Boolean),(b,x)=>JSON.stringify(b)===JSON.stringify(x));t.set(h,m)}),t}var j7;let X_=j7=class extends ke{constructor(e){super(e),this.name=null,this.code=null}clone(){return new j7({name:this.name,code:this.code})}};g([w({type:String,json:{write:!0}})],X_.prototype,"name",void 0),g([w({type:[String,Number],json:{write:!0}})],X_.prototype,"code",void 0),X_=j7=g([te("esri.layers.support.CodedValue")],X_);const KMe=new kt({inherited:"inherited",codedValue:"coded-value",range:"range"});let Q_=class extends ke{constructor(e){super(e),this.name=null,this.type=null}};g([w({type:String,json:{write:!0}})],Q_.prototype,"name",void 0),g([Pt(KMe)],Q_.prototype,"type",void 0),Q_=g([te("esri.layers.support.Domain")],Q_);const W9=Q_;var V7;let e2=V7=class extends W9{constructor(e){super(e),this.codedValues=null,this.type="coded-value"}getName(e){let t=null;if(this.codedValues){const i=String(e);this.codedValues.some(r=>(String(r.code)===i&&(t=r.name),!!t))}return t}clone(){return new V7({codedValues:_e(this.codedValues),name:this.name})}};g([w({type:[X_],json:{write:!0}})],e2.prototype,"codedValues",void 0),g([Pt({codedValue:"coded-value"})],e2.prototype,"type",void 0),e2=V7=g([te("esri.layers.support.CodedValueDomain")],e2);const sJ=e2;var z7;let J9=z7=class extends W9{constructor(e){super(e),this.type="inherited"}clone(){return new z7}};g([Pt({inherited:"inherited"})],J9.prototype,"type",void 0),J9=z7=g([te("esri.layers.support.InheritedDomain")],J9);const oJ=J9;var G7;let c1=G7=class extends W9{constructor(e){super(e),this.maxValue=null,this.minValue=null,this.type="range"}clone(){return new G7({maxValue:this.maxValue,minValue:this.minValue,name:this.name})}};g([w({type:Number,json:{type:[Number],read:{source:"range",reader:(e,t)=>t.range&&t.range[1]},write:{enabled:!1,overridePolicy(){return{enabled:this.maxValue!=null&&this.minValue==null}},target:"range",writer(e,t,i){t[i]=[this.minValue||0,e]}}}})],c1.prototype,"maxValue",void 0),g([w({type:Number,json:{type:[Number],read:{source:"range",reader:(e,t)=>t.range&&t.range[0]},write:{target:"range",writer(e,t,i){t[i]=[e,this.maxValue||0]}}}})],c1.prototype,"minValue",void 0),g([Pt({range:"range"})],c1.prototype,"type",void 0),c1=G7=g([te("esri.layers.support.RangeDomain")],c1);const aJ=c1,lJ={key:"type",base:W9,typeMap:{range:aJ,"coded-value":sJ,inherited:oJ}};function B7(e){if(!e||!e.type)return null;switch(e.type){case"range":return aJ.fromJSON(e);case"codedValue":return sJ.fromJSON(e);case"inherited":return oJ.fromJSON(e)}return null}const YMe=new kt({esriFieldTypeSmallInteger:"small-integer",esriFieldTypeInteger:"integer",esriFieldTypeSingle:"single",esriFieldTypeDouble:"double",esriFieldTypeLong:"long",esriFieldTypeString:"string",esriFieldTypeDate:"date",esriFieldTypeOID:"oid",esriFieldTypeGeometry:"geometry",esriFieldTypeBlob:"blob",esriFieldTypeRaster:"raster",esriFieldTypeGUID:"guid",esriFieldTypeGlobalID:"global-id",esriFieldTypeXML:"xml"});var U7;const XMe=new kt({binary:"binary",coordinate:"coordinate",countOrAmount:"count-or-amount",dateAndTime:"date-and-time",description:"description",locationOrPlaceName:"location-or-place-name",measurement:"measurement",nameOrTitle:"name-or-title",none:"none",orderedOrRanked:"ordered-or-ranked",percentageOrRatio:"percentage-or-ratio",typeOrCategory:"type-or-category",uniqueIdentifier:"unique-identifier"});let lo=U7=class extends ke{constructor(e){super(e),this.alias=null,this.defaultValue=void 0,this.description=null,this.domain=null,this.editable=!0,this.length=-1,this.name=null,this.nullable=!0,this.type=null,this.valueType=null,this.visible=!0}readDescription(e,{description:t}){var r;let i=null;try{i=t?JSON.parse(t):null}catch{}return(r=i==null?void 0:i.value)!=null?r:null}readValueType(e,{description:t}){let i=null;try{i=t?JSON.parse(t):null}catch{}return i?XMe.fromJSON(i.fieldValueType):null}clone(){return new U7({alias:this.alias,defaultValue:this.defaultValue,description:this.description,domain:this.domain&&this.domain.clone()||null,editable:this.editable,length:this.length,name:this.name,nullable:this.nullable,type:this.type,valueType:this.valueType,visible:this.visible})}};g([w({type:String,json:{write:!0}})],lo.prototype,"alias",void 0),g([w({type:[String,Number],json:{write:{allowNull:!0}}})],lo.prototype,"defaultValue",void 0),g([w()],lo.prototype,"description",void 0),g([We("description")],lo.prototype,"readDescription",null),g([w({types:lJ,json:{read:{reader:B7},write:!0}})],lo.prototype,"domain",void 0),g([w({type:Boolean,json:{write:!0}})],lo.prototype,"editable",void 0),g([w({type:Ri,json:{write:!0}})],lo.prototype,"length",void 0),g([w({type:String,json:{write:!0}})],lo.prototype,"name",void 0),g([w({type:Boolean,json:{write:!0}})],lo.prototype,"nullable",void 0),g([Pt(YMe)],lo.prototype,"type",void 0),g([w()],lo.prototype,"valueType",void 0),g([We("valueType",["description"])],lo.prototype,"readValueType",null),g([w({type:Boolean,json:{read:!1}})],lo.prototype,"visible",void 0),lo=U7=g([te("esri.layers.support.Field")],lo);const u1=lo;var q7;let Vh=q7=class extends ke{constructor(e){super(e),this.type="map-layer"}clone(){const{mapLayerId:e,gdbVersion:t}=this;return new q7({mapLayerId:e,gdbVersion:t})}};g([Pt({mapLayer:"map-layer"})],Vh.prototype,"type",void 0),g([w({type:Ri,json:{write:!0}})],Vh.prototype,"mapLayerId",void 0),g([w({type:String,json:{write:!0}})],Vh.prototype,"gdbVersion",void 0),Vh=q7=g([te("esri.layers.support.source.MapLayerSource")],Vh);var H7;let zh=H7=class extends ke{constructor(e){super(e),this.type="query-table"}clone(){var c;const{workspaceId:e,query:t,oidFields:i,spatialReference:r,geometryType:n}=this,o={workspaceId:e,query:t,oidFields:i,spatialReference:(c=r==null?void 0:r.clone())!=null?c:void 0,geometryType:n};return new H7(o)}};g([Pt({queryTable:"query-table"})],zh.prototype,"type",void 0),g([w({type:String,json:{write:!0}})],zh.prototype,"workspaceId",void 0),g([w({type:String,json:{write:!0}})],zh.prototype,"query",void 0),g([w({type:String,json:{write:!0}})],zh.prototype,"oidFields",void 0),g([w({type:Mt,json:{write:!0}})],zh.prototype,"spatialReference",void 0),g([Pt(NS)],zh.prototype,"geometryType",void 0),zh=H7=g([te("esri.layers.support.source.QueryTableDataSource")],zh);var W7;let h1=W7=class extends ke{constructor(e){super(e),this.type="raster"}clone(){const{workspaceId:e,dataSourceName:t}=this;return new W7({workspaceId:e,dataSourceName:t})}};g([Pt({raster:"raster"})],h1.prototype,"type",void 0),g([w({type:String,json:{write:!0}})],h1.prototype,"dataSourceName",void 0),g([w({type:String,json:{write:!0}})],h1.prototype,"workspaceId",void 0),h1=W7=g([te("esri.layers.support.source.RasterDataSource")],h1);var J7;let yy=J7=class extends ke{constructor(e){super(e),this.type="table"}clone(){const{workspaceId:e,gdbVersion:t,dataSourceName:i}=this;return new J7({workspaceId:e,gdbVersion:t,dataSourceName:i})}};g([Pt({table:"table"})],yy.prototype,"type",void 0),g([w({type:String,json:{write:!0}})],yy.prototype,"workspaceId",void 0),g([w({type:String,json:{write:!0}})],yy.prototype,"gdbVersion",void 0),g([w({type:String,json:{write:!0}})],yy.prototype,"dataSourceName",void 0),yy=J7=g([te("esri.layers.support.source.TableDataSource")],yy);var Z7,K7;const QMe=Ns()({esriLeftInnerJoin:"left-inner-join",esriLeftOuterJoin:"left-outer-join"});let Ga=Z7=class extends ke{constructor(e){super(e),this.type="join-table"}readLeftTableSource(e,t,i){return cJ()(e,t,i)}castLeftTableSource(e){return Yc(Q7(),e)}readRightTableSource(e,t,i){return cJ()(e,t,i)}castRightTableSource(e){return Yc(Q7(),e)}clone(){var c,h;const{leftTableKey:e,rightTableKey:t,leftTableSource:i,rightTableSource:r,joinType:n}=this,o={leftTableKey:e,rightTableKey:t,leftTableSource:(c=i==null?void 0:i.clone())!=null?c:void 0,rightTableSource:(h=r==null?void 0:r.clone())!=null?h:void 0,joinType:n};return new Z7(o)}};g([Pt({joinTable:"join-table"})],Ga.prototype,"type",void 0),g([w({type:String,json:{write:!0}})],Ga.prototype,"leftTableKey",void 0),g([w({type:String,json:{write:!0}})],Ga.prototype,"rightTableKey",void 0),g([w({json:{write:!0}})],Ga.prototype,"leftTableSource",void 0),g([We("leftTableSource")],Ga.prototype,"readLeftTableSource",null),g([Dt("leftTableSource")],Ga.prototype,"castLeftTableSource",null),g([w({json:{write:!0}})],Ga.prototype,"rightTableSource",void 0),g([We("rightTableSource")],Ga.prototype,"readRightTableSource",null),g([Dt("rightTableSource")],Ga.prototype,"castRightTableSource",null),g([Pt(QMe)],Ga.prototype,"joinType",void 0),Ga=Z7=g([te("esri.layers.support.source.JoinTableDataSource")],Ga);let Y7=null;function cJ(){return Y7||(Y7=ad({types:Q7()})),Y7}let X7=null;function Q7(){return X7||(X7={key:"type",base:null,typeMap:{"data-layer":Ba,"map-layer":Vh}}),X7}const eIe={key:"type",base:null,typeMap:{"join-table":Ga,"query-table":zh,raster:h1,table:yy}};let Ba=K7=class extends ke{constructor(e){super(e),this.type="data-layer"}clone(){const{fields:e,dataSource:t}=this;return new K7({fields:e,dataSource:t})}};g([Pt({dataLayer:"data-layer"})],Ba.prototype,"type",void 0),g([w({type:[u1],json:{write:!0}})],Ba.prototype,"fields",void 0),g([w({types:eIe,json:{write:!0}})],Ba.prototype,"dataSource",void 0),Ba=K7=g([te("esri.layers.support.source.DataLayerSource")],Ba),Ba.from=Oi(Ba);function t2(e,t){return t?Ce(K({},t),{query:K(K({},e),t.query)}):{query:e}}function Br(e){return typeof e=="string"?mn(e):_e(e)}function p1(e,t,i){const r={};for(const n in e){if(n==="declaredClass")continue;const o=e[n];if(o!=null&&typeof o!="function")if(Array.isArray(o)){r[n]=[];for(let c=0;c<o.length;c++)r[n][c]=p1(o[c])}else if(typeof o=="object")if(o.toJSON){const c=o.toJSON(i&&i[n]);r[n]=t?c:JSON.stringify(c)}else r[n]=t?o:JSON.stringify(o);else r[n]=o}return r}function Z9(e,t){var i;return $C(e)&&(t||$i.apiKey)?t||$i.apiKey:(i=tr==null?void 0:tr.findCredential(e))==null?void 0:i.token}const K9={102100:{maxX:20037508342788905e-9,minX:-20037508342788905e-9,plus180Line:new Fn({paths:[[[20037508342788905e-9,-20037508342788905e-9],[20037508342788905e-9,20037508342788905e-9]]],spatialReference:Mt.WebMercator}),minus180Line:new Fn({paths:[[[-20037508342788905e-9,-20037508342788905e-9],[-20037508342788905e-9,20037508342788905e-9]]],spatialReference:Mt.WebMercator})},4326:{maxX:180,minX:-180,plus180Line:new Fn({paths:[[[180,-180],[180,180]]],spatialReference:Mt.WGS84}),minus180Line:new Fn({paths:[[[-180,-180],[-180,180]]],spatialReference:Mt.WGS84})}};function my(e,t){return Math.ceil((e-t)/(2*t))}function uJ(e,t){const i=i2(e);for(const r of i)for(const n of r)n[0]+=t;return e}function i2(e){return vh(e)?e.rings:e.paths}async function tIe(e,t,i,r){const n=Br(e),o=t[0].spatialReference,c=Ce(K({},r),{query:Ce(K({},n.query),{f:"json",sr:JSON.stringify(o),target:JSON.stringify({geometryType:bh(t[0]),geometries:t}),cutter:JSON.stringify(i)})}),h=await Nt(n.path+"/cut",c),{cutIndexes:m,geometries:b=[]}=h.data;return{cutIndexes:m,geometries:b.map(x=>{const I=xs(x);return I.spatialReference=o,I})}}function iIe(e){return{geometryType:bh(e[0]),geometries:e.map(t=>t.toJSON())}}function hJ(e,t,i){const r=_ge(t);return e.map(n=>{const o=r.fromJSON(n);return o.spatialReference=i,o})}async function rIe(e,t,i){const r=typeof e=="string"?mn(e):e,n=t[0].spatialReference,o=bh(t[0]),c=Ce(K({},i),{query:Ce(K({},r.query),{f:"json",sr:n.wkid?n.wkid:JSON.stringify(n),geometries:JSON.stringify(iIe(t))})}),{data:h}=await Nt(r.path+"/simplify",c);return hJ(h.geometries,o,n)}const pJ=$e.getLogger("esri.geometry.support.normalizeUtils");function nIe(e){return e.type==="polygon"}function sIe(e){return e[0].type==="polygon"}function oIe(e){return e[0].type==="polyline"}function dJ(e,t){if(!(e instanceof Fn||e instanceof es)){const n="straightLineDensify: the input geometry is neither polyline nor polygon";throw pJ.error(n),new ue(n)}const i=i2(e),r=[];for(const n of i){const o=[];r.push(o),o.push([n[0][0],n[0][1]]);for(let c=0;c<n.length-1;c++){const h=n[c][0],m=n[c][1],b=n[c+1][0],x=n[c+1][1],I=Math.sqrt((b-h)*(b-h)+(x-m)*(x-m)),E=(x-m)/I,k=(b-h)/I,P=I/t;if(P>1){for(let z=1;z<=P-1;z++){const q=z*t,J=k*q+h,X=E*q+m;o.push([J,X])}const F=(I+Math.floor(P-1)*t)/2,N=k*F+h,B=E*F+m;o.push([N,B])}o.push([b,x])}}return nIe(e)?new es({rings:r,spatialReference:e.spatialReference}):new Fn({paths:r,spatialReference:e.spatialReference})}function fJ(e,t,i){if(t){const r=dJ(e,1e6);e=v0(r,!0)}return i&&(e=uJ(e,i)),e}function yJ(e,t,i){if(Array.isArray(e)){const r=e[0];if(r>t){const n=my(r,t);e[0]=r+n*(-2*t)}else if(r<i){const n=my(r,i);e[0]=r+n*(-2*i)}}else{const r=e.x;if(r>t){const n=my(r,t);e=e.clone().offset(n*(-2*t),0)}else if(r<i){const n=my(r,i);e=e.clone().offset(n*(-2*i),0)}}return e}function aIe(e,t){let i=-1;for(let r=0;r<t.cutIndexes.length;r++){const n=t.cutIndexes[r],o=t.geometries[r],c=i2(o);for(let h=0;h<c.length;h++){const m=c[h];m.some(b=>{if(b[0]<180)return!0;{let x=0;for(let E=0;E<m.length;E++){const k=m[E][0];x=k>x?k:x}x=Number(x.toFixed(9));const I=-360*my(x,180);for(let E=0;E<m.length;E++){const k=o.getPoint(h,E);o.setPoint(h,E,k.clone().offset(I,0))}return!0}})}if(n===i){if(sIe(e))for(const h of i2(o))e[n]=e[n].addRing(h);else if(oIe(e))for(const h of i2(o))e[n]=e[n].addPath(h)}else i=n,e[n]=o}return e}async function d1(e,t,i){var J;if(!Array.isArray(e))return d1([e],t);t&&typeof t!="string"&&pJ.warn("normalizeCentralMeridian()","The url object is deprecated, use the url string instead");const r=typeof t=="string"?t:(J=t==null?void 0:t.url)!=null?J:$i.geometryServiceUrl;let n,o,c,h,m,b,x,I,E=0;const k=[],P=[];for(const X of e)if(ce(X))P.push(X);else if(n||(n=X.spatialReference,o=Wo(n),c=n.isWebMercator,b=c?102100:4326,h=K9[b].maxX,m=K9[b].minX,x=K9[b].plus180Line,I=K9[b].minus180Line),o)if(X.type==="mesh")P.push(X);else if(X.type==="point")P.push(yJ(X.clone(),h,m));else if(X.type==="multipoint"){const Y=X.clone();Y.points=Y.points.map(ae=>yJ(ae,h,m)),P.push(Y)}else if(X.type==="extent"){const Y=X.clone()._normalize(!1,!1,o);P.push(Y.rings?new es(Y):Y)}else if(X.extent){const Y=X.extent,ae=my(Y.xmin,m)*(2*h);let he=ae===0?X.clone():uJ(X.clone(),ae);Y.offset(ae,0),Y.intersects(x)&&Y.xmax!==h?(E=Y.xmax>E?Y.xmax:E,he=fJ(he,c),k.push(he),P.push("cut")):Y.intersects(I)&&Y.xmin!==m?(E=Y.xmax*(2*h)>E?Y.xmax*(2*h):E,he=fJ(he,c,360),k.push(he),P.push("cut")):P.push(he)}else P.push(X.clone());else P.push(X);let F=my(E,h),N=-90;const B=F,z=new Fn;for(;F>0;){const X=360*F-180;z.addPath([[X,N],[X,-1*N]]),N*=-1,F--}if(k.length>0&&B>0){const X=aIe(k,await tIe(r,k,z,i)),Y=[],ae=[];for(let ye=0;ye<P.length;ye++){const xe=P[ye];if(xe!=="cut")ae.push(xe);else{const Se=X.shift(),Ae=e[ye];H(Ae)&&Ae.type==="polygon"&&Ae.rings&&Ae.rings.length>1&&Se.rings.length>=Ae.rings.length?(Y.push(Se),ae.push("simplify")):ae.push(c?tu(Se):Se)}}if(!Y.length)return ae;const he=await rIe(r,Y,i),fe=[];for(let ye=0;ye<ae.length;ye++){const xe=ae[ye];xe!=="simplify"?fe.push(xe):fe.push(c?tu(he.shift()):he.shift())}return fe}const q=[];for(let X=0;X<P.length;X++){const Y=P[X];if(Y!=="cut")q.push(Y);else{const ae=k.shift();q.push(c===!0?tu(ae):ae)}}return q}function NZe(e,t){const i=Wo(t);if(i){const[r,n]=i.valid,o=n-r;if(e<r)for(;e<r;)e+=o;if(e>n)for(;e>n;)e-=o}return e}function r2(e){const t={};for(const i in e){if(i==="declaredClass")continue;const r=e[i];if(r!=null&&typeof r!="function")if(Array.isArray(r)){t[i]=[];for(let n=0;n<r.length;n++)t[i][n]=r2(r[n])}else typeof r=="object"?r.toJSON&&(t[i]=JSON.stringify(r)):t[i]=r}return t}var ef;(function(e){e[e.varint=0]="varint",e[e.fixed64=1]="fixed64",e[e.delimited=2]="delimited",e[e.fixed32=5]="fixed32",e[e.unknown=99]="unknown"})(ef||(ef={}));const mJ=4294967296,lIe=new TextDecoder("utf-8"),cIe=Te("safari")||Te("ios")?6:Te("ff")?12:32;class gy{constructor(t,i,r=0,n=t?t.byteLength:0){this._tag=0,this._dataType=ef.unknown,this._init(t,i,r,n)}_init(t,i,r,n){this._data=t,this._dataView=i,this._pos=r,this._end=n}asUnsafe(){return this}clone(){return new gy(this._data,this._dataView,this._pos,this._end)}pos(){return this._pos}move(t){this._pos=t}nextTag(t){for(;;){if(this._pos===this._end)return!1;const i=this._decodeVarint();if(this._tag=i>>3,this._dataType=7&i,!t||t===this._tag)break;this.skip()}return!0}next(){if(this._pos===this._end)return!1;const t=this._decodeVarint();return this._tag=t>>3,this._dataType=7&t,!0}empty(){return this._pos>=this._end}tag(){return this._tag}getInt32(){return this._decodeVarint()}getInt64(){return this._decodeVarint()}getUInt32(){let t=4294967295;return t=(127&this._data[this._pos])>>>0,this._data[this._pos++]<128?t:(t=(t|(127&this._data[this._pos])<<7)>>>0,this._data[this._pos++]<128?t:(t=(t|(127&this._data[this._pos])<<14)>>>0,this._data[this._pos++]<128?t:(t=(t|(127&this._data[this._pos])<<21)>>>0,this._data[this._pos++]<128?t:(t=(t|(15&this._data[this._pos])<<28)>>>0,this._data[this._pos++]<128?t:void 0))))}getUInt64(){return this._decodeVarint()}getSInt32(){const t=this.getUInt32();if(t!==void 0)return t>>>1^-(1&t)|0}getSInt64(){return this._decodeSVarint()}getBool(){const t=this._data[this._pos]!==0;return this._skip(1),t}getEnum(){return this._decodeVarint()}getFixed64(){const t=this._dataView,i=this._pos,r=t.getUint32(i,!0)+t.getUint32(i+4,!0)*mJ;return this._skip(8),r}getSFixed64(){const t=this._dataView,i=this._pos,r=t.getUint32(i,!0)+t.getInt32(i+4,!0)*mJ;return this._skip(8),r}getDouble(){const t=this._dataView.getFloat64(this._pos,!0);return this._skip(8),t}getFixed32(){const t=this._dataView.getUint32(this._pos,!0);return this._skip(4),t}getSFixed32(){const t=this._dataView.getInt32(this._pos,!0);return this._skip(4),t}getFloat(){const t=this._dataView.getFloat32(this._pos,!0);return this._skip(4),t}getString(){const t=this._getLength(),i=this._pos,r=this._toString(this._data,i,i+t);return this._skip(t),r}getBytes(){const t=this._getLength(),i=this._pos,r=this._toBytes(this._data,i,i+t);return this._skip(t),r}getLength(){return this._getLengthUnsafe()}processMessageWithArgs(t,i,r,n){const o=this.getMessage(),c=t(o,i,r,n);return o.release(),c}processMessage(t){const i=this.getMessage(),r=t(i);return i.release(),r}getMessage(){const t=this._getLength(),i=gy.pool.acquire();return i._init(this._data,this._dataView,this._pos,this._pos+t),this._skip(t),i}release(){gy.pool.release(this)}dataType(){return this._dataType}skip(){switch(this._dataType){case ef.varint:this._decodeVarint();break;case ef.fixed64:this._skip(8);break;case ef.delimited:this._skip(this._getLength());break;case ef.fixed32:this._skip(4);break;default:throw new Error("Invalid data type!")}}skipLen(t){this._skip(t)}_skip(t){if(this._pos+t>this._end)throw new Error("Attempt to skip past the end of buffer!");this._pos+=t}_decodeVarint(){const t=this._data;let i=this._pos,r=0,n=0;if(this._end-i>=10)do{if(n=t[i++],r|=127&n,(128&n)==0||(n=t[i++],r|=(127&n)<<7,(128&n)==0)||(n=t[i++],r|=(127&n)<<14,(128&n)==0)||(n=t[i++],r|=(127&n)<<21,(128&n)==0)||(n=t[i++],r+=268435456*(127&n),(128&n)==0)||(n=t[i++],r+=34359738368*(127&n),(128&n)==0)||(n=t[i++],r+=4398046511104*(127&n),(128&n)==0)||(n=t[i++],r+=562949953421312*(127&n),(128&n)==0)||(n=t[i++],r+=72057594037927940*(127&n),(128&n)==0)||(n=t[i++],r+=9223372036854776e3*(127&n),(128&n)==0))break;throw new Error("Varint too long!")}while(0);else{let o=1;for(;i!==this._end&&(n=t[i],(128&n)!=0);)++i,r+=(127&n)*o,o*=128;if(i===this._end)throw new Error("Varint overrun!");++i,r+=n*o}return this._pos=i,r}_decodeSVarint(){const t=this._data;let i=this._pos,r=0,n=0;const o=1&t[i];if(this._end-i>=10)do{if(n=t[i++],r|=127&n,(128&n)==0||(n=t[i++],r|=(127&n)<<7,(128&n)==0)||(n=t[i++],r|=(127&n)<<14,(128&n)==0)||(n=t[i++],r|=(127&n)<<21,(128&n)==0)||(n=t[i++],r+=268435456*(127&n),(128&n)==0)||(n=t[i++],r+=34359738368*(127&n),(128&n)==0)||(n=t[i++],r+=4398046511104*(127&n),(128&n)==0)||(n=t[i++],r+=562949953421312*(127&n),(128&n)==0)||(n=t[i++],r+=72057594037927940*(127&n),(128&n)==0)||(n=t[i++],r+=9223372036854776e3*(127&n),(128&n)==0))break;throw new Error("Varint too long!")}while(0);else{let c=1;for(;i!==this._end&&(n=t[i],(128&n)!=0);)++i,r+=(127&n)*c,c*=128;if(i===this._end)throw new Error("Varint overrun!");++i,r+=n*c}return this._pos=i,o?-(r+1)/2:r/2}_getLength(){if(this._dataType!==ef.delimited)throw new Error("Not a delimited data type!");return this._decodeVarint()}_getLengthUnsafe(){return this.getUInt32()}_toString(t,i,r){if((r=Math.min(this._end,r))-i>cIe){const c=t.subarray(i,r);return lIe.decode(c)}let n="",o="";for(let c=i;c<r;++c){const h=t[c];128&h?o+="%"+h.toString(16):(n+=decodeURIComponent(o)+String.fromCharCode(h),o="")}return o.length&&(n+=decodeURIComponent(o)),n}_toBytes(t,i,r){return r=Math.min(this._end,r),new Uint8Array(t.buffer,i,r-i)}}gy.pool=new Ql(gy,void 0,e=>{e._data=null,e._dataView=null});class $s{constructor(t=[],i=[],r=!1){this.lengths=t!=null?t:[],this.coords=i!=null?i:[],this.hasIndeterminateRingOrder=r}static fromRect(t){const[i,r,n,o]=t,c=n-i,h=o-r;return new $s([5],[i,r,c,0,0,h,-c,0,0,-h])}get isPoint(){return this.lengths.length===0}get maxLength(){return Math.max(...this.lengths)}get size(){return this.lengths.reduce((t,i)=>t+i)}forEachVertex(t){let i=0;this.lengths.length||t(this.coords[0],this.coords[1]);for(let r=0;r<this.lengths.length;r++){const n=this.lengths[r];for(let o=0;o<n;o++)t(this.coords[2*(o+i)],this.coords[2*(o+i)+1]);i+=n}}clone(t){return t?(t.set(this.coords),new $s(this.lengths.slice(),t,this.hasIndeterminateRingOrder)):new $s(this.lengths.slice(),this.coords.slice(),this.hasIndeterminateRingOrder)}}class Mu{constructor(t=null,i={},r,n){this.geometry=t,this.attributes=i,this.centroid=r,this.objectId=n,this.displayId=0,this.geohashX=0,this.geohashY=0}weakClone(){const t=new Mu(this.geometry,this.attributes,this.centroid,this.objectId);return t.displayId=this.displayId,t.geohashX=this.geohashX,t.geohashY=this.geohashY,t}}function uIe(e){return!(ce(e.geometry)||!e.geometry.coords||!e.geometry.coords.length)}class DZe extends Mu{}class Y9{constructor(){this.objectIdFieldName=null,this.globalIdFieldName=null,this.geohashFieldName=null,this.geometryProperties=null,this.geometryType=null,this.spatialReference=null,this.hasZ=!1,this.hasM=!1,this.features=[],this.fields=[],this.transform=null,this.exceededTransferLimit=!1,this.uniqueIdField=null,this.queryGeometryType=null,this.queryGeometry=null}weakClone(){const t=new Y9;return t.objectIdFieldName=this.objectIdFieldName,t.globalIdFieldName=this.globalIdFieldName,t.geohashFieldName=this.geohashFieldName,t.geometryProperties=this.geometryProperties,t.geometryType=this.geometryType,t.spatialReference=this.spatialReference,t.hasZ=this.hasZ,t.hasM=this.hasM,t.features=this.features,t.fields=this.fields,t.transform=this.transform,t.exceededTransferLimit=this.exceededTransferLimit,t.uniqueIdField=this.uniqueIdField,t.queryGeometry=this.queryGeometry,t.queryGeometryType=this.queryGeometryType,t}}const gJ=["esriGeometryPoint","esriGeometryMultipoint","esriGeometryPolyline","esriGeometryPolygon"];class jZe{constructor(t){this._options=t,this.geometryTypes=gJ,this._coordinatePtr=0,this._vertexDimension=0}createFeatureResult(){return new Y9}prepareFeatures(t){this._vertexDimension=2,t.hasZ&&this._vertexDimension++,t.hasM&&this._vertexDimension++}finishFeatureResult(t){if(!t||!t.features||!t.hasZ||!this._options.sourceSpatialReference||!t.spatialReference||hr(t.spatialReference,this._options.sourceSpatialReference)||t.spatialReference.vcsWkid)return;const i=jg(this._options.sourceSpatialReference)/jg(t.spatialReference);if(i!==1)for(const r of t.features){if(!uIe(r))continue;const n=r.geometry.coords;for(let o=2;o<n.length;o+=3)n[o]*=i}}addFeature(t,i){t.features.push(i)}createFeature(){return new Mu}createSpatialReference(){return{wkid:0}}createGeometry(){return new $s}addField(t,i){t.fields.push(i)}allocateCoordinates(t){t.coords.length=t.lengths.reduce((i,r)=>i+r,0)*this._vertexDimension,this._coordinatePtr=0}addCoordinate(t,i){t.coords[this._coordinatePtr++]=i}addCoordinatePoint(t,i){t.coords.push(i)}addLength(t,i){t.lengths.push(i)}addQueryGeometry(t,i){t.queryGeometry=i.queryGeometry,t.queryGeometryType=i.queryGeometryType}createPointGeometry(){return new $s}}const vJ=["esriFieldTypeSmallInteger","esriFieldTypeInteger","esriFieldTypeSingle","esriFieldTypeDouble","esriFieldTypeString","esriFieldTypeDate","esriFieldTypeOID","esriFieldTypeGeometry","esriFieldTypeBlob","esriFieldTypeRaster","esriFieldTypeGUID","esriFieldTypeGlobalID","esriFieldTypeXML"],bJ=["sqlTypeBigInt","sqlTypeBinary","sqlTypeBit","sqlTypeChar","sqlTypeDate","sqlTypeDecimal","sqlTypeDouble","sqlTypeFloat","sqlTypeGeometry","sqlTypeGUID","sqlTypeInteger","sqlTypeLongNVarchar","sqlTypeLongVarbinary","sqlTypeLongVarchar","sqlTypeNChar","sqlTypeNVarchar","sqlTypeOther","sqlTypeReal","sqlTypeSmallInt","sqlTypeSqlXml","sqlTypeTime","sqlTypeTimestamp","sqlTypeTimestamp2","sqlTypeTinyInt","sqlTypeVarbinary","sqlTypeVarchar"],wJ=["upperLeft","lowerLeft"];function _J(e){return e>=vJ.length?null:vJ[e]}function hIe(e){return e>=bJ.length?null:bJ[e]}function xJ(e){return e>=wJ.length?null:wJ[e]}function SJ(e,t){return t>=e.geometryTypes.length?null:e.geometryTypes[t]}function pIe(e,t,i){const r=3,n=e.asUnsafe(),o=t.createPointGeometry(i);for(;n.next();)switch(n.tag()){case r:{const c=n.getUInt32(),h=n.pos()+c;let m=0;for(;n.pos()<h;)t.addCoordinatePoint(o,n.getSInt64(),m++);break}default:n.skip()}return o}function dIe(e,t,i){const r=2,n=3,o=e.asUnsafe(),c=t.createGeometry(i),h=2+(i.hasZ?1:0)+(i.hasM?1:0);for(;o.next();)switch(o.tag()){case r:{const m=o.getUInt32(),b=o.pos()+m;let x=0;for(;o.pos()<b;)t.addLength(c,o.getUInt32(),x++);break}case n:{const m=o.getUInt32(),b=o.pos()+m;let x=0;for(t.allocateCoordinates(c);o.pos()<b;)t.addCoordinate(c,o.getSInt64(),x),x++,x===h&&(x=0);break}default:o.skip()}return c}function fIe(e){const t=1,i=2,r=3,n=e.asUnsafe(),o=new $s;let c="esriGeometryPoint";for(;n.next();)switch(n.tag()){case i:{const h=n.getUInt32(),m=n.pos()+h;for(;n.pos()<m;)o.lengths.push(n.getUInt32());break}case r:{const h=n.getUInt32(),m=n.pos()+h;for(;n.pos()<m;)o.coords.push(n.getSInt64());break}case t:c=gJ[n.getEnum()];break;default:n.skip()}return{queryGeometry:o,queryGeometryType:c}}function yIe(e){const t=1,i=2,r=3,n=4,o=5,c=6,h=7,m=8,b=9,x=e.asUnsafe();for(;x.next();)switch(x.tag()){case t:return x.getString();case i:return x.getFloat();case r:return x.getDouble();case n:return x.getSInt32();case o:return x.getUInt32();case c:return x.getInt64();case h:return x.getUInt64();case m:return x.getSInt64();case b:return x.getBool();default:return x.skip(),null}return null}function mIe(e){const t=1,i=2,r=3,n=4,o=5,c=6,h=e.asUnsafe(),m={type:_J(0)};for(;h.next();)switch(h.tag()){case t:m.name=h.getString();break;case i:m.type=_J(h.getEnum());break;case r:m.alias=h.getString();break;case n:m.sqlType=hIe(h.getEnum());break;case o:h.skip();break;case c:m.defaultValue=h.getString();break;default:h.skip()}return m}function gIe(e){const t=1,i=2,r={},n=e.asUnsafe();for(;n.next();)switch(n.tag()){case t:r.name=n.getString();break;case i:r.isSystemMaintained=n.getBool();break;default:n.skip()}return r}function vIe(e,t,i,r){const n=1,o=2,c=4,h=t.createFeature(i);let m=0;for(;e.next();)switch(e.tag()){case n:{const b=r[m++].name;h.attributes[b]=e.processMessage(yIe);break}case o:h.geometry=e.processMessageWithArgs(dIe,t,i);break;case c:h.centroid=e.processMessageWithArgs(pIe,t,i);break;default:e.skip()}return h}function bIe(e){const t=1,i=2,r=3,n=4,o=[1,1,1,1],c=e.asUnsafe();for(;c.next();)switch(c.tag()){case t:o[0]=c.getDouble();break;case i:o[1]=c.getDouble();break;case n:o[2]=c.getDouble();break;case r:o[3]=c.getDouble();break;default:c.skip()}return o}function wIe(e){const t=1,i=2,r=3,n=4,o=[0,0,0,0],c=e.asUnsafe();for(;c.next();)switch(c.tag()){case t:o[0]=c.getDouble();break;case i:o[1]=c.getDouble();break;case n:o[2]=c.getDouble();break;case r:o[3]=c.getDouble();break;default:c.skip()}return o}function _Ie(e){const t=1,i=2,r=3,n={originPosition:xJ(0)},o=e.asUnsafe();for(;o.next();)switch(o.tag()){case t:n.originPosition=xJ(o.getEnum());break;case i:n.scale=o.processMessage(bIe);break;case r:n.translate=o.processMessage(wIe);break;default:o.skip()}return n}function xIe(e){const t=1,i=2,r=3,n={},o=e.asUnsafe();for(;o.next();)switch(o.tag()){case t:n.shapeAreaFieldName=o.getString();break;case i:n.shapeLengthFieldName=o.getString();break;case r:n.units=o.getString();break;default:o.skip()}return n}function SIe(e,t){const i=1,r=2,n=3,o=4,c=5,h=t.createSpatialReference();for(;e.next();)switch(e.tag()){case i:h.wkid=e.getUInt32();break;case c:h.wkt=e.getString();break;case r:h.latestWkid=e.getUInt32();break;case n:h.vcsWkid=e.getUInt32();break;case o:h.latestVcsWkid=e.getUInt32();break;default:e.skip()}return h}function MIe(e,t){const i=1,r=2,n=3,o=4,c=5,h=7,m=8,b=9,x=10,I=11,E=12,k=13,P=15,F=t.createFeatureResult(),N=e.asUnsafe();F.geometryType=SJ(t,0);let B=!1;for(;N.next();)switch(N.tag()){case i:F.objectIdFieldName=N.getString();break;case n:F.globalIdFieldName=N.getString();break;case o:F.geohashFieldName=N.getString();break;case c:F.geometryProperties=N.processMessage(xIe);break;case h:F.geometryType=SJ(t,N.getEnum());break;case m:F.spatialReference=N.processMessageWithArgs(SIe,t);break;case x:F.hasZ=N.getBool();break;case I:F.hasM=N.getBool();break;case E:F.transform=N.processMessage(_Ie);break;case b:{const z=N.getBool();F.exceededTransferLimit=z;break}case k:t.addField(F,N.processMessage(mIe));break;case P:B||(t.prepareFeatures(F),B=!0),t.addFeature(F,N.processMessageWithArgs(vIe,t,F,F.fields));break;case r:F.uniqueIdField=N.processMessage(gIe);break;default:N.skip()}return t.finishFeatureResult(F),F}function IIe(e,t){const i=1,r=4,n={};let o=null;for(;e.next();)switch(e.tag()){case r:o=e.processMessageWithArgs(fIe);break;case i:n.featureResult=e.processMessageWithArgs(MIe,t);break;default:e.skip()}return H(o)&&n.featureResult&&t.addQueryGeometry(n,o),n}function $Ie(e,t){try{const i=2,r=new gy(new Uint8Array(e),new DataView(e)),n={};for(;r.next();)r.tag()===i?n.queryResult=r.processMessageWithArgs(IIe,t):r.skip();return n}catch(i){throw new ue("query:parsing-pbf","Error while parsing FeatureSet PBF payload",{error:i})}}function EIe(e,t){const i=$Ie(e,t),r=i.queryResult.featureResult,n=i.queryResult.queryGeometry,o=i.queryResult.queryGeometryType;if(r&&r.features&&r.features.length&&r.objectIdFieldName){const c=r.objectIdFieldName;for(const h of r.features)h.attributes&&(h.objectId=h.attributes[c])}return r&&(r.queryGeometry=n,r.queryGeometryType=o),r}function X9(e,t,i){if(!i||!i.features||!i.hasZ)return;const r=Pk(i.geometryType,t,e.outSpatialReference);if(!ce(r))for(const n of i.features)r(n.geometry)}const MJ="Layer does not support extent calculation.";function IJ(e,t){if(t&&e.type==="extent")return`${e.xmin},${e.ymin},${e.xmax},${e.ymax}`;if(t&&e.type==="point")return`${e.x},${e.y}`;const i=e.toJSON();return delete i.spatialReference,JSON.stringify(i)}function $J(e,t){const i=e.geometry,r=e.toJSON();delete r.compactGeometryEnabled,delete r.defaultSpatialReferenceEnabled;const n=r;let o,c,h;if(H(i)&&(c=i.spatialReference,h=i.spatialReference.wkid||JSON.stringify(i.spatialReference),n.geometryType=bh(i),n.geometry=IJ(i,e.compactGeometryEnabled),n.inSR=h),r.groupByFieldsForStatistics&&(n.groupByFieldsForStatistics=r.groupByFieldsForStatistics.join(",")),r.objectIds&&(n.objectIds=r.objectIds.join(",")),r.orderByFields&&(n.orderByFields=r.orderByFields.join(",")),!r.outFields||!r.returnDistinctValues&&((t==null?void 0:t.returnCountOnly)||(t==null?void 0:t.returnExtentOnly)||(t==null?void 0:t.returnIdsOnly))?delete n.outFields:r.outFields.includes("*")?n.outFields="*":n.outFields=r.outFields.join(","),r.outSR?(n.outSR=r.outSR.wkid||JSON.stringify(r.outSR),o=e.outSpatialReference):i&&(r.returnGeometry||r.returnCentroid)&&(n.outSR=n.inSR,o=c),r.returnGeometry&&delete r.returnGeometry,r.outStatistics&&(n.outStatistics=JSON.stringify(r.outStatistics)),r.fullText&&(n.fullText=JSON.stringify(r.fullText)),r.pixelSize&&(n.pixelSize=JSON.stringify(r.pixelSize)),r.quantizationParameters&&(e.defaultSpatialReferenceEnabled&&H(c)&&H(e.quantizationParameters)&&H(e.quantizationParameters.extent)&&c.equals(e.quantizationParameters.extent.spatialReference)&&delete r.quantizationParameters.extent.spatialReference,n.quantizationParameters=JSON.stringify(r.quantizationParameters)),r.parameterValues&&(n.parameterValues=JSON.stringify(r.parameterValues)),r.rangeValues&&(n.rangeValues=JSON.stringify(r.rangeValues)),r.dynamicDataSource&&(n.layer=JSON.stringify({source:r.dynamicDataSource}),delete r.dynamicDataSource),r.timeExtent){const m=r.timeExtent,{start:b,end:x}=m;b==null&&x==null||(n.time=b===x?b:`${b!=null?b:"null"},${x!=null?x:"null"}`),delete r.timeExtent}return e.defaultSpatialReferenceEnabled&&H(c)&&H(o)&&c.equals(o)&&(n.defaultSR=n.inSR,delete n.inSR,delete n.outSR),n}async function EJ(e,t,i,r){const n=H(t.timeExtent)&&t.timeExtent.isEmpty?{data:{features:[]}}:await f1(e,t,"json",r);return X9(t,i,n.data),n}async function TJ(e,t,i,r){if(H(t.timeExtent)&&t.timeExtent.isEmpty)return{data:i.createFeatureResult()};const n=await CJ(e,t,r),o=n;return o.data=EIe(n.data,i),o}function CJ(e,t,i){return f1(e,t,"pbf",i)}function kJ(e,t,i){return H(t.timeExtent)&&t.timeExtent.isEmpty?Promise.resolve({data:{objectIds:[]}}):f1(e,t,"json",i,{returnIdsOnly:!0})}function AJ(e,t,i){return H(t.timeExtent)&&t.timeExtent.isEmpty?Promise.resolve({data:{count:0}}):f1(e,t,"json",i,{returnIdsOnly:!0,returnCountOnly:!0})}function PJ(e,t,i){return H(t.timeExtent)&&t.timeExtent.isEmpty?Promise.resolve({data:{count:0,extent:null}}):f1(e,t,"json",i,{returnExtentOnly:!0,returnCountOnly:!0}).then(r=>{const n=r.data;if(n.hasOwnProperty("extent"))return r;if(n.features)throw new Error(MJ);if(n.hasOwnProperty("count"))throw new Error(MJ);return r})}function f1(e,t,i,r={},n={}){const o=typeof e=="string"?mn(e):e,c=t.geometry?[t.geometry]:[];return r.responseType=i==="pbf"?"array-buffer":"json",d1(c,null,r).then(h=>{const m=h&&h[0];H(m)&&((t=t.clone()).geometry=m);const b=r2(K(K(Ce(K({},o.query),{f:i}),n),$J(t,n)));return Nt(Cd(o.path,"query"),Ce(K({},r),{query:K(K({},b),r.query)}))})}var TIe=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",encodeGeometry:IJ,executeQuery:EJ,executeQueryForCount:AJ,executeQueryForExtent:PJ,executeQueryForIds:kJ,executeQueryPBF:TJ,executeQueryPBFBuffer:CJ,queryToQueryStringParameters:$J,runQuery:f1}),eA;const tA=new kt({esriGeometryPoint:"point",esriGeometryMultipoint:"multipoint",esriGeometryPolyline:"polyline",esriGeometryPolygon:"polygon",esriGeometryEnvelope:"extent",mesh:"mesh","":null});let Es=eA=class extends ke{constructor(e){super(e),this.displayFieldName=null,this.exceededTransferLimit=!1,this.features=[],this.fields=null,this.geometryType=null,this.hasM=!1,this.hasZ=!1,this.queryGeometry=null,this.spatialReference=null}readFeatures(e,t){var n;const i=Mt.fromJSON(t.spatialReference),r=[];for(let o=0;o<e.length;o++){const c=e[o],h=Gr.fromJSON(c),m=c.geometry&&c.geometry.spatialReference;H(h.geometry)&&!m&&(h.geometry.spatialReference=i);const b=c.aggregateGeometries,x=h.aggregateGeometries;if(b&&H(x))for(const I in x){const E=x[I],k=(n=b[I])==null?void 0:n.spatialReference;H(E)&&!k&&(E.spatialReference=i)}r.push(h)}return r}writeGeometryType(e,t,i,r){if(e)return void tA.write(e,t,i,r);const{features:n}=this;if(n){for(const o of n)if(o&&H(o.geometry))return void tA.write(o.geometry.type,t,i,r)}}readQueryGeometry(e,t){if(!e)return null;const i=!!e.spatialReference,r=xs(e);return r&&!i&&t.spatialReference&&(r.spatialReference=Mt.fromJSON(t.spatialReference)),r}writeSpatialReference(e,t){if(e)return void(t.spatialReference=e.toJSON());const{features:i}=this;if(i){for(const r of i)if(r&&H(r.geometry)&&r.geometry.spatialReference)return void(t.spatialReference=r.geometry.spatialReference.toJSON())}}clone(){return new eA(this.cloneProperties())}cloneProperties(){return _e({displayFieldName:this.displayFieldName,exceededTransferLimit:this.exceededTransferLimit,features:this.features,fields:this.fields,geometryType:this.geometryType,hasM:this.hasM,hasZ:this.hasZ,queryGeometry:this.queryGeometry,spatialReference:this.spatialReference,transform:this.transform})}toJSON(e){const t=this.write();if(t.features&&Array.isArray(e)&&e.length>0)for(let i=0;i<t.features.length;i++){const r=t.features[i];if(r.geometry){const n=e&&e[i];r.geometry=n&&n.toJSON()||r.geometry}}return t}quantize(e){const{scale:[t,i],translate:[r,n]}=e,o=b=>Math.round((b-r)/t),c=b=>Math.round((n-b)/i),h=this.features,m=this._getQuantizationFunction(this.geometryType,o,c);for(let b=0,x=h.length;b<x;b++)(m==null?void 0:m(Ht(h[b].geometry)))||(h.splice(b,1),b--,x--);return this.transform=e,this}unquantize(){const{geometryType:e,features:t,transform:i}=this;if(!i)return this;const{translate:[r,n],scale:[o,c]}=i,h=x=>x*o+r,m=x=>n-x*c,b=this._getHydrationFunction(e,h,m);for(const{geometry:x}of t)H(x)&&b&&b(x);return this.transform=null,this}_quantizePoints(e,t,i){let r,n;const o=[];for(let c=0,h=e.length;c<h;c++){const m=e[c];if(c>0){const b=t(m[0]),x=i(m[1]);b===r&&x===n||(o.push([b-r,x-n]),r=b,n=x)}else r=t(m[0]),n=i(m[1]),o.push([r,n])}return o.length>0?o:null}_getQuantizationFunction(e,t,i){return e==="point"?r=>(r.x=t(r.x),r.y=i(r.y),r):e==="polyline"||e==="polygon"?r=>{const n=vh(r)?r.rings:r.paths,o=[];for(let c=0,h=n.length;c<h;c++){const m=n[c],b=this._quantizePoints(m,t,i);b&&o.push(b)}return o.length>0?(vh(r)?r.rings=o:r.paths=o,r):null}:e==="multipoint"?r=>{const n=this._quantizePoints(r.points,t,i);return n&&n.length>0?(r.points=n,r):null}:e==="extent"?r=>r:null}_getHydrationFunction(e,t,i){return e==="point"?r=>{r.x=t(r.x),r.y=i(r.y)}:e==="polyline"||e==="polygon"?r=>{const n=vh(r)?r.rings:r.paths;let o,c;for(let h=0,m=n.length;h<m;h++){const b=n[h];for(let x=0,I=b.length;x<I;x++){const E=b[x];x>0?(o+=E[0],c+=E[1]):(o=E[0],c=E[1]),E[0]=t(o),E[1]=i(c)}}}:e==="extent"?r=>{r.xmin=t(r.xmin),r.ymin=i(r.ymin),r.xmax=t(r.xmax),r.ymax=i(r.ymax)}:e==="multipoint"?r=>{const n=r.points;let o,c;for(let h=0,m=n.length;h<m;h++){const b=n[h];h>0?(o+=b[0],c+=b[1]):(o=b[0],c=b[1]),b[0]=t(o),b[1]=i(c)}}:null}};g([w({type:String,json:{write:!0}})],Es.prototype,"displayFieldName",void 0),g([w({type:Boolean,json:{write:{overridePolicy:e=>({enabled:e})}}})],Es.prototype,"exceededTransferLimit",void 0),g([w({type:[Gr],json:{write:!0}})],Es.prototype,"features",void 0),g([We("features")],Es.prototype,"readFeatures",null),g([w({type:[u1],json:{write:!0}})],Es.prototype,"fields",void 0),g([w({type:["point","multipoint","polyline","polygon","extent","mesh"],json:{read:{reader:tA.read}}})],Es.prototype,"geometryType",void 0),g([tt("geometryType")],Es.prototype,"writeGeometryType",null),g([w({type:Boolean,json:{write:{overridePolicy:e=>({enabled:e})}}})],Es.prototype,"hasM",void 0),g([w({type:Boolean,json:{write:{overridePolicy:e=>({enabled:e})}}})],Es.prototype,"hasZ",void 0),g([w({types:wh,json:{write:!0}})],Es.prototype,"queryGeometry",void 0),g([We("queryGeometry")],Es.prototype,"readQueryGeometry",null),g([w({type:Mt,json:{write:!0}})],Es.prototype,"spatialReference",void 0),g([tt("spatialReference")],Es.prototype,"writeSpatialReference",null),g([w({json:{write:!0}})],Es.prototype,"transform",void 0),Es=eA=g([te("esri.rest.support.FeatureSet")],Es),Es.prototype.toJSON.isDefaultToJSON=!0;const Gh=Es;var CIe=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",default:Gh});const LJ={milliseconds:1,seconds:1e3,minutes:6e4,hours:36e5,days:864e5,weeks:6048e5,months:26784e5,years:31536e6,decades:31536e7,centuries:31536e8},kIe={milliseconds:{getter:"getMilliseconds",setter:"setMilliseconds",multiplier:1},seconds:{getter:"getSeconds",setter:"setSeconds",multiplier:1},minutes:{getter:"getMinutes",setter:"setMinutes",multiplier:1},hours:{getter:"getHours",setter:"setHours",multiplier:1},days:{getter:"getDate",setter:"setDate",multiplier:1},weeks:{getter:"getDate",setter:"setDate",multiplier:7},months:{getter:"getMonth",setter:"setMonth",multiplier:1},years:{getter:"getFullYear",setter:"setFullYear",multiplier:1},decades:{getter:"getFullYear",setter:"setFullYear",multiplier:10},centuries:{getter:"getFullYear",setter:"setFullYear",multiplier:100}};function AIe(e,t){const i=new Date(e,t+1,1);return i.setDate(0),i.getDate()}function vy(e,t,i){const r=new Date(e.getTime());if(t&&i){const n=kIe[i],{getter:o,setter:c,multiplier:h}=n;if(i==="months"){const m=AIe(r.getFullYear(),r.getMonth()+t);r.getDate()>m&&r.setDate(m)}r[c](r[o]()+t*h)}return r}function OJ(e,t){switch(t){case"milliseconds":return new Date(e.getTime());case"seconds":return new Date(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds());case"minutes":return new Date(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes());case"hours":return new Date(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours());case"days":return new Date(e.getFullYear(),e.getMonth(),e.getDate());case"weeks":return new Date(e.getFullYear(),e.getMonth(),e.getDate()-e.getDay());case"months":return new Date(e.getFullYear(),e.getMonth(),1);case"years":return new Date(e.getFullYear(),0,1);case"decades":return new Date(e.getFullYear()-e.getFullYear()%10,0,1);case"centuries":return new Date(e.getFullYear()-e.getFullYear()%100,0,1);default:return new Date}}function PIe(e,t,i){return e===0?0:e*LJ[t]/LJ[i]}var vc;let Ua=vc=class extends ke{constructor(e){super(e),this.end=null,this.start=null}static get allTime(){return RJ}static get empty(){return LIe}readEnd(e,t){return t.end!=null?new Date(t.end):null}writeEnd(e,t){t.end=e?e.getTime():null}get isAllTime(){return this.equals(vc.allTime)}get isEmpty(){return this.equals(vc.empty)}readStart(e,t){return t.start!=null?new Date(t.start):null}writeStart(e,t){t.start=e?e.getTime():null}clone(){return new vc({end:this.end,start:this.start})}equals(e){if(!e)return!1;const t=H(this.start)?this.start.getTime():this.start,i=H(this.end)?this.end.getTime():this.end,r=H(e.start)?e.start.getTime():e.start,n=H(e.end)?e.end.getTime():e.end;return t===r&&i===n}expandTo(e){if(this.isEmpty||this.isAllTime)return this.clone();const t=ch(this.start,r=>OJ(r,e)),i=ch(this.end,r=>{const n=OJ(r,e);return r.getTime()===n.getTime()?n:vy(n,1,e)});return new vc({start:t,end:i})}intersection(e){if(!e)return this.clone();if(this.isEmpty||e.isEmpty)return vc.empty;if(this.isAllTime)return e.clone();if(e.isAllTime)return this.clone();const t=Kb(this.start,-1/0,h=>h.getTime()),i=Kb(this.end,1/0,h=>h.getTime()),r=Kb(e.start,-1/0,h=>h.getTime()),n=Kb(e.end,1/0,h=>h.getTime());let o,c;if(r>=t&&r<=i?o=r:t>=r&&t<=n&&(o=t),i>=r&&i<=n?c=i:n>=t&&n<=i&&(c=n),o!=null&&c!=null&&!isNaN(o)&&!isNaN(c)){const h=new vc;return h.start=o===-1/0?null:new Date(o),h.end=c===1/0?null:new Date(c),h}return vc.empty}offset(e,t){if(this.isEmpty||this.isAllTime)return this.clone();const i=new vc,{start:r,end:n}=this;return H(r)&&(i.start=vy(r,e,t)),H(n)&&(i.end=vy(n,e,t)),i}union(e){if(!e||e.isEmpty)return this.clone();if(this.isEmpty)return e.clone();if(this.isAllTime||e.isAllTime)return RJ.clone();const t=H(this.start)&&H(e.start)?new Date(Math.min(this.start.getTime(),e.start.getTime())):null,i=H(this.end)&&H(e.end)?new Date(Math.max(this.end.getTime(),e.end.getTime())):null;return new vc({start:t,end:i})}};g([w({type:Date,json:{write:{allowNull:!0}}})],Ua.prototype,"end",void 0),g([We("end")],Ua.prototype,"readEnd",null),g([tt("end")],Ua.prototype,"writeEnd",null),g([w({readOnly:!0,json:{read:!1}})],Ua.prototype,"isAllTime",null),g([w({readOnly:!0,json:{read:!1}})],Ua.prototype,"isEmpty",null),g([w({type:Date,json:{write:{allowNull:!0}}})],Ua.prototype,"start",void 0),g([We("start")],Ua.prototype,"readStart",null),g([tt("start")],Ua.prototype,"writeStart",null),Ua=vc=g([te("esri.TimeExtent")],Ua);const RJ=new Ua,LIe=new Ua({start:void 0,end:void 0}),qa=Ua;let by=class extends rn(ke){constructor(e){super(e),this.onFields=null,this.operator=null,this.searchTerm=null,this.searchType=null}};g([w({type:[String],json:{write:{enabled:!0,overridePolicy(){return{enabled:H(this.onFields)&&this.onFields.length>0}}}}})],by.prototype,"onFields",void 0),g([w({type:String,json:{write:!0}})],by.prototype,"operator",void 0),g([w({type:String,json:{write:!0}})],by.prototype,"searchTerm",void 0),g([w({type:String,json:{write:!0}})],by.prototype,"searchType",void 0),by=g([te("esri.rest.support.FullTextSearch")],by);const FJ=by;var iA;const NJ=new kt({upperLeft:"upper-left",lowerLeft:"lower-left"});let wy=iA=class extends ke{constructor(e){super(e),this.extent=null,this.mode="view",this.originPosition="upper-left",this.tolerance=1}clone(){return new iA(_e({extent:this.extent,mode:this.mode,originPosition:this.originPosition,tolerance:this.tolerance}))}};g([w({type:gi,json:{write:{overridePolicy(){return{enabled:this.mode==="view"}}}}})],wy.prototype,"extent",void 0),g([w({type:["view","edit"],json:{write:!0}})],wy.prototype,"mode",void 0),g([w({type:String,json:{read:NJ.read,write:NJ.write}})],wy.prototype,"originPosition",void 0),g([w({type:Number,json:{write:{overridePolicy(){return{enabled:this.mode==="view"}}}}})],wy.prototype,"tolerance",void 0),wy=iA=g([te("esri.rest.support.QuantizationParameters")],wy);const DJ=wy;var rA;const jJ=new kt({count:"count",sum:"sum",min:"min",max:"max",avg:"avg",stddev:"stddev",var:"var",exceedslimit:"exceedslimit",percentile_cont:"percentile-continuous",percentile_disc:"percentile-discrete",EnvelopeAggregate:"envelope-aggregate",CentroidAggregate:"centroid-aggregate",ConvexHullAggregate:"convex-hull-aggregate"});let bc=rA=class extends ke{constructor(e){super(e),this.maxPointCount=void 0,this.maxRecordCount=void 0,this.maxVertexCount=void 0,this.onStatisticField=null,this.outStatisticFieldName=null,this.statisticType=null,this.statisticParameters=null}writeStatisticParameters(e,t){this.statisticType!=="percentile-continuous"&&this.statisticType!=="percentile-discrete"||(t.statisticParameters=_e(e))}clone(){return new rA({maxPointCount:this.maxPointCount,maxRecordCount:this.maxRecordCount,maxVertexCount:this.maxVertexCount,onStatisticField:this.onStatisticField,outStatisticFieldName:this.outStatisticFieldName,statisticType:this.statisticType,statisticParameters:_e(this.statisticParameters)})}};g([w({type:Number,json:{write:!0}})],bc.prototype,"maxPointCount",void 0),g([w({type:Number,json:{write:!0}})],bc.prototype,"maxRecordCount",void 0),g([w({type:Number,json:{write:!0}})],bc.prototype,"maxVertexCount",void 0),g([w({type:String,json:{write:!0}})],bc.prototype,"onStatisticField",void 0),g([w({type:String,json:{write:!0}})],bc.prototype,"outStatisticFieldName",void 0),g([w({type:String,json:{read:{source:"statisticType",reader:jJ.read},write:{target:"statisticType",writer:jJ.write}}})],bc.prototype,"statisticType",void 0),g([w({type:Object})],bc.prototype,"statisticParameters",void 0),g([tt("statisticParameters")],bc.prototype,"writeStatisticParameters",null),bc=rA=g([te("esri.rest.support.StatisticDefinition")],bc);const VJ=bc;var y1;const OIe=new kt({esriSpatialRelIntersects:"intersects",esriSpatialRelContains:"contains",esriSpatialRelCrosses:"crosses",esriSpatialRelDisjoint:"disjoint",esriSpatialRelEnvelopeIntersects:"envelope-intersects",esriSpatialRelIndexIntersects:"index-intersects",esriSpatialRelOverlaps:"overlaps",esriSpatialRelTouches:"touches",esriSpatialRelWithin:"within",esriSpatialRelRelation:"relation"}),RIe=new kt({esriSRUnit_Meter:"meters",esriSRUnit_Kilometer:"kilometers",esriSRUnit_Foot:"feet",esriSRUnit_StatuteMile:"miles",esriSRUnit_NauticalMile:"nautical-miles",esriSRUnit_USNauticalMile:"us-nautical-miles"});let jt=y1=class extends ke{constructor(e){super(e),this.aggregateIds=null,this.cacheHint=void 0,this.compactGeometryEnabled=!1,this.datumTransformation=null,this.defaultSpatialReferenceEnabled=!1,this.distance=void 0,this.dynamicDataSource=void 0,this.formatOf3DObjects=null,this.fullText=null,this.gdbVersion=null,this.geometry=null,this.geometryPrecision=void 0,this.groupByFieldsForStatistics=null,this.having=null,this.historicMoment=null,this.maxAllowableOffset=void 0,this.maxRecordCountFactor=1,this.multipatchOption=null,this.num=void 0,this.objectIds=null,this.orderByFields=null,this.outFields=null,this.outSpatialReference=null,this.outStatistics=null,this.parameterValues=null,this.pixelSize=null,this.quantizationParameters=null,this.rangeValues=null,this.relationParameter=null,this.resultType=null,this.returnCentroid=!1,this.returnDistinctValues=!1,this.returnExceededLimitFeatures=!0,this.returnGeometry=!1,this.returnQueryGeometry=!1,this.returnM=void 0,this.returnZ=void 0,this.sourceSpatialReference=null,this.spatialRelationship="intersects",this.start=void 0,this.sqlFormat=null,this.text=null,this.timeExtent=null,this.timeReferenceUnknownClient=!1,this.units=null,this.where=null}static from(e){return Xm(y1,e)}castDatumTransformation(e){return typeof e=="number"||typeof e=="object"?e:null}writeHistoricMoment(e,t){t.historicMoment=e&&e.getTime()}writeParameterValues(e,t){if(e){const i={};for(const r in e){const n=e[r];Array.isArray(n)?i[r]=n.map(o=>o instanceof Date?o.getTime():o):n instanceof Date?i[r]=n.getTime():i[r]=n}t.parameterValues=i}}writeStart(e,t){t.resultOffset=this.start,t.resultRecordCount=this.num||10,t.where="1=1"}writeWhere(e,t){t.where=e||"1=1"}clone(){return new y1(_e({aggregateIds:this.aggregateIds,cacheHint:this.cacheHint,compactGeometryEnabled:this.compactGeometryEnabled,datumTransformation:this.datumTransformation,defaultSpatialReferenceEnabled:this.defaultSpatialReferenceEnabled,distance:this.distance,fullText:this.fullText,gdbVersion:this.gdbVersion,geometry:this.geometry,geometryPrecision:this.geometryPrecision,groupByFieldsForStatistics:this.groupByFieldsForStatistics,having:this.having,historicMoment:H(this.historicMoment)?new Date(this.historicMoment.getTime()):null,maxAllowableOffset:this.maxAllowableOffset,maxRecordCountFactor:this.maxRecordCountFactor,multipatchOption:this.multipatchOption,num:this.num,objectIds:this.objectIds,orderByFields:this.orderByFields,outFields:this.outFields,outSpatialReference:this.outSpatialReference,outStatistics:this.outStatistics,parameterValues:this.parameterValues,pixelSize:this.pixelSize,quantizationParameters:this.quantizationParameters,rangeValues:this.rangeValues,relationParameter:this.relationParameter,resultType:this.resultType,returnDistinctValues:this.returnDistinctValues,returnGeometry:this.returnGeometry,returnCentroid:this.returnCentroid,returnExceededLimitFeatures:this.returnExceededLimitFeatures,returnQueryGeometry:this.returnQueryGeometry,returnM:this.returnM,returnZ:this.returnZ,dynamicDataSource:this.dynamicDataSource,sourceSpatialReference:this.sourceSpatialReference,spatialRelationship:this.spatialRelationship,start:this.start,sqlFormat:this.sqlFormat,text:this.text,timeExtent:this.timeExtent,timeReferenceUnknownClient:this.timeReferenceUnknownClient,units:this.units,where:this.where}))}};jt.MAX_MAX_RECORD_COUNT_FACTOR=5,g([w({json:{write:!0}})],jt.prototype,"aggregateIds",void 0),g([w({type:Boolean,json:{write:!0}})],jt.prototype,"cacheHint",void 0),g([w({type:Boolean,json:{default:!1,write:!0}})],jt.prototype,"compactGeometryEnabled",void 0),g([w({json:{write:!0}})],jt.prototype,"datumTransformation",void 0),g([Dt("datumTransformation")],jt.prototype,"castDatumTransformation",null),g([w({type:Boolean,json:{default:!1,write:!0}})],jt.prototype,"defaultSpatialReferenceEnabled",void 0),g([w({type:Number,json:{write:{overridePolicy:e=>({enabled:e>0})}}})],jt.prototype,"distance",void 0),g([w({type:Ba,json:{write:!0}})],jt.prototype,"dynamicDataSource",void 0),g([w({type:String,json:{write:!0}})],jt.prototype,"formatOf3DObjects",void 0),g([w({type:[FJ],json:{write:{enabled:!0,overridePolicy(){return{enabled:H(this.fullText)&&this.fullText.length>0}}}}})],jt.prototype,"fullText",void 0),g([w({type:String,json:{write:!0}})],jt.prototype,"gdbVersion",void 0),g([w({types:wh,json:{read:xs,write:!0}})],jt.prototype,"geometry",void 0),g([w({type:Number,json:{write:!0}})],jt.prototype,"geometryPrecision",void 0),g([w({type:[String],json:{write:!0}})],jt.prototype,"groupByFieldsForStatistics",void 0),g([w({type:String,json:{write:!0}})],jt.prototype,"having",void 0),g([w({type:Date})],jt.prototype,"historicMoment",void 0),g([tt("historicMoment")],jt.prototype,"writeHistoricMoment",null),g([w({type:Number,json:{write:!0}})],jt.prototype,"maxAllowableOffset",void 0),g([w({type:Number,cast:e=>e<1?1:e>y1.MAX_MAX_RECORD_COUNT_FACTOR?y1.MAX_MAX_RECORD_COUNT_FACTOR:e,json:{write:{overridePolicy:e=>({enabled:e>1})}}})],jt.prototype,"maxRecordCountFactor",void 0),g([w({type:["xyFootprint"],json:{write:!0}})],jt.prototype,"multipatchOption",void 0),g([w({type:Number,json:{read:{source:"resultRecordCount"}}})],jt.prototype,"num",void 0),g([w({json:{write:!0}})],jt.prototype,"objectIds",void 0),g([w({type:[String],json:{write:!0}})],jt.prototype,"orderByFields",void 0),g([w({type:[String],json:{write:!0}})],jt.prototype,"outFields",void 0),g([w({type:Mt,json:{name:"outSR",write:!0}})],jt.prototype,"outSpatialReference",void 0),g([w({type:[VJ],json:{write:{enabled:!0,overridePolicy(){return{enabled:H(this.outStatistics)&&this.outStatistics.length>0}}}}})],jt.prototype,"outStatistics",void 0),g([w({json:{write:!0}})],jt.prototype,"parameterValues",void 0),g([tt("parameterValues")],jt.prototype,"writeParameterValues",null),g([w({type:pt,json:{write:!0}})],jt.prototype,"pixelSize",void 0),g([w({type:DJ,json:{write:!0}})],jt.prototype,"quantizationParameters",void 0),g([w({type:[Object],json:{write:!0}})],jt.prototype,"rangeValues",void 0),g([w({type:String,json:{read:{source:"relationParam"},write:{target:"relationParam",overridePolicy(){return{enabled:this.spatialRelationship==="relation"}}}}})],jt.prototype,"relationParameter",void 0),g([w({type:String,json:{write:!0}})],jt.prototype,"resultType",void 0),g([w({type:Boolean,json:{default:!1,write:!0}})],jt.prototype,"returnCentroid",void 0),g([w({type:Boolean,json:{default:!1,write:!0}})],jt.prototype,"returnDistinctValues",void 0),g([w({type:Boolean,json:{default:!0,write:!0}})],jt.prototype,"returnExceededLimitFeatures",void 0),g([w({type:Boolean,json:{write:!0}})],jt.prototype,"returnGeometry",void 0),g([w({type:Boolean,json:{default:!1,write:!0}})],jt.prototype,"returnQueryGeometry",void 0),g([w({type:Boolean,json:{default:!1,write:!0}})],jt.prototype,"returnM",void 0),g([w({type:Boolean,json:{write:{overridePolicy:e=>({enabled:e})}}})],jt.prototype,"returnZ",void 0),g([w({type:Mt,json:{write:!0}})],jt.prototype,"sourceSpatialReference",void 0),g([Pt(OIe,{ignoreUnknown:!1,name:"spatialRel"})],jt.prototype,"spatialRelationship",void 0),g([w({type:Number,json:{read:{source:"resultOffset"}}})],jt.prototype,"start",void 0),g([tt("start"),tt("num")],jt.prototype,"writeStart",null),g([w({type:String,json:{write:!0}})],jt.prototype,"sqlFormat",void 0),g([w({type:String,json:{write:!0}})],jt.prototype,"text",void 0),g([w({type:qa,json:{write:!0}})],jt.prototype,"timeExtent",void 0),g([w({type:Boolean,json:{default:!1,write:!0}})],jt.prototype,"timeReferenceUnknownClient",void 0),g([Pt(RIe,{ignoreUnknown:!1}),w({json:{write:{overridePolicy(e){return{enabled:!!e&&this.distance!=null&&this.distance>0}}}}})],jt.prototype,"units",void 0),g([w({type:String,json:{write:{overridePolicy(e){return{enabled:e!=null||this.start!=null&&this.start>0}}}}})],jt.prototype,"where",void 0),g([tt("where")],jt.prototype,"writeWhere",null),jt=y1=g([te("esri.rest.support.Query")],jt);const co=jt;async function nA(e,t,i){const r=await FIe(e,t,i);return Gh.fromJSON(r)}async function FIe(e,t,i){const r=Br(e),n=K({},i),o=co.from(t),{data:c}=await EJ(r,o,o.sourceSpatialReference,n);return c}function Us(e,t){return e?t?4:3:t?3:2}const m1=$e.getLogger("esri.layers.graphics.featureConversionUtils"),zJ={esriGeometryPoint:0,esriGeometryPolyline:2,esriGeometryPolygon:3,esriGeometryMultipoint:0},NIe=(e,t,i,r,n,o)=>{e[i]=n,e[i+1]=o},GJ=(e,t,i,r,n,o)=>{e[i]=n,e[i+1]=o,e[i+2]=t[r+2]},DIe=(e,t,i,r,n,o)=>{e[i]=n,e[i+1]=o,e[i+2]=t[r+3]},jIe=(e,t,i,r,n,o)=>{e[i]=n,e[i+1]=o,e[i+2]=t[r+2],e[i+3]=t[r+3]};function sA(e,t,i,r){if(e){if(i)return t&&r?jIe:GJ;if(t&&r)return DIe}else if(t&&r)return GJ;return NIe}function oA({scale:e,translate:t},i){return Math.round((i-t[0])/e[0])}function aA({scale:e,translate:t},i){return Math.round((t[1]-i)/e[1])}function lA({scale:e,translate:t},i,r){return i*e[r]+t[r]}function cA(e,t,i){return e?t?i?pA(e):uA(e):i?hA(e):Q9(e):null}function Q9(e){const t=e.coords;return{x:t[0],y:t[1]}}function BJ(e,t){return e.coords[0]=t.x,e.coords[1]=t.y,e}function uA(e){const t=e.coords;return{x:t[0],y:t[1],z:t[2]}}function VIe(e,t){return e.coords[0]=t.x,e.coords[1]=t.y,e.coords[2]=t.z,e}function hA(e){const t=e.coords;return{x:t[0],y:t[1],m:t[2]}}function zIe(e,t){return e.coords[0]=t.x,e.coords[1]=t.y,e.coords[2]=t.m,e}function pA(e){const t=e.coords;return{x:t[0],y:t[1],z:t[2],m:t[3]}}function GIe(e,t){return e.coords[0]=t.x,e.coords[1]=t.y,e.coords[2]=t.z,e.coords[3]=t.m,e}function BIe(e,t,i,r){let n=Q9;i&&r?n=pA:i?n=uA:r&&(n=hA);for(const o of t){const{geometry:c,attributes:h}=o,m=H(c)?n(c):null;e.push({attributes:h,geometry:m})}return e}function dA(e,t){return e&&t?GIe:e?VIe:t?zIe:BJ}function UJ(e,t,i,r,n){const o=dA(i,r);for(const{geometry:c,attributes:h}of t){const m=H(c)?o(new $s,c):null;e.push(new Mu(m,h,null,n?h[n]:void 0))}return e}function VZe(e,t,i=dA(t.z!=null,t.m!=null)){return i(e,t)}function UIe(e,t,i,r){for(const{geometry:n,attributes:o}of t)e.push({attributes:o,geometry:H(n)?fA(n,i,r):null});return e}function fA(e,t,i){if(ce(e))return null;const r=Us(t,i),n=[];for(let o=0;o<e.coords.length;o+=r){const c=[];for(let h=0;h<r;h++)c.push(e.coords[o+h]);n.push(c)}return t?i?{points:n,hasZ:t,hasM:i}:{points:n,hasZ:t}:i?{points:n,hasM:i}:{points:n}}function qJ(e,t,i,r,n){const o=Us(i,r);for(const{geometry:c,attributes:h}of t){const m=H(c)?HJ(new $s,c,o):null;e.push(new Mu(m,h,null,n?h[n]:void 0))}return e}function HJ(e,t,i=Us(t.hasZ,t.hasM)){e.lengths[0]=t.points.length;const r=e.coords;let n=0;for(const o of t.points)for(let c=0;c<i;c++)r[n++]=o[c];return e}function qIe(e,t,i,r){for(const{geometry:n,attributes:o}of t)e.push({attributes:o,geometry:H(n)?yA(n,i,r):null});return e}function yA(e,t,i){if(!e)return null;const r=Us(t,i),{coords:n,lengths:o}=e,c=[];let h=0;for(const m of o){const b=[];for(let x=0;x<m;x++){const I=[];for(let E=0;E<r;E++)I.push(n[h++]);b.push(I)}c.push(b)}return t?i?{paths:c,hasZ:t,hasM:i}:{paths:c,hasZ:t}:i?{paths:c,hasM:i}:{paths:c}}function WJ(e,t,i,r,n){const o=Us(i,r);for(const{geometry:c,attributes:h}of t){const m=H(c)?JJ(new $s,c,o):null;e.push(new Mu(m,h,null,n?h[n]:void 0))}return e}function JJ(e,t,i=Us(t.hasZ,t.hasM)){const{lengths:r,coords:n}=e;let o=0;for(const c of t.paths){for(const h of c)for(let m=0;m<i;m++)n[o++]=h[m];r.push(c.length)}return e}function HIe(e,t,i,r){for(const{geometry:n,attributes:o,centroid:c}of t){const h=H(n)?mA(n,i,r):null;if(H(c)){const m=Q9(c);e.push({attributes:o,centroid:m,geometry:h})}else e.push({attributes:o,geometry:h})}return e}function mA(e,t,i){if(!e)return null;const r=Us(t,i),{coords:n,lengths:o}=e,c=[];let h=0;for(const m of o){const b=[];for(let x=0;x<m;x++){const I=[];for(let E=0;E<r;E++)I.push(n[h++]);b.push(I)}c.push(b)}return t?i?{rings:c,hasZ:t,hasM:i}:{rings:c,hasZ:t}:i?{rings:c,hasM:i}:{rings:c}}function ZJ(e,t,i,r,n){for(const{geometry:o,centroid:c,attributes:h}of t){const m=H(o)?KJ(new $s,o,i,r):null,b=n?h[n]:void 0;H(c)?e.push(new Mu(m,h,BJ(new $s,c),b)):e.push(new Mu(m,h,null,b))}return e}function KJ(e,t,i=t.hasZ,r=t.hasM){return WIe(e,t.rings,i,r),e}function WIe(e,t,i,r){const n=Us(i,r),{lengths:o,coords:c}=e;let h=0;Bh(e);for(const m of t){for(const b of m)for(let x=0;x<n;x++)c[h++]=b[x];o.push(m.length)}return e}const g1=[],n2=[];function zZe(e,t,i,r,n){g1[0]=e;const[o]=YJ(n2,g1,t,i,r,n);return wc(g1),wc(n2),o}function YJ(e,t,i,r,n,o){if(wc(e),!i){for(const c of t){const h=o?c.attributes[o]:void 0;e.push(new Mu(null,c.attributes,null,h))}return e}switch(i){case"esriGeometryPoint":return UJ(e,t,r,n,o);case"esriGeometryMultipoint":return qJ(e,t,r,n,o);case"esriGeometryPolyline":return WJ(e,t,r,n,o);case"esriGeometryPolygon":return ZJ(e,t,r,n,o);default:m1.error("convertToFeatureSet:unknown-geometry",new ue(`Unable to parse unknown geometry type '${i}'`)),wc(e)}return e}function GZe(e,t,i,r,n,o){const c=e.length;switch(i){case"esriGeometryPoint":UJ(e,t,r,n,o);break;case"esriGeometryMultipoint":qJ(e,t,r,n,o);break;case"esriGeometryPolyline":WJ(e,t,r,n,o);break;case"esriGeometryPolygon":ZJ(e,t,r,n,o);break;default:m1.error("convertToFeatureSet:unknown-geometry",new ue(`Unable to parse unknown geometry type '${i}'`))}for(let h=0;h<t.length;h++)e[h+c].geometryType=i,e[h+c].insertAfter=t[h].insertAfter,e[h+c].groupId=t[h].groupId;return e}function BZe(e,t,i,r){n2[0]=e,QJ(g1,n2,t,i,r);const n=g1[0];return wc(g1),wc(n2),n}function UZe(e,t,i){if(ce(e))return null;const r=new $s;return"hasZ"in e&&t==null&&(t=e.hasZ),"hasM"in e&&i==null&&(i=e.hasM),VS(e)?dA(t!=null?t:e.z!=null,i!=null?i:e.m!=null)(r,e):vh(e)?KJ(r,e,t,i):_w(e)?JJ(r,e,Us(t,i)):jS(e)?HJ(r,e,Us(t,i)):void m1.error("convertFromGeometry:unknown-geometry",new ue(`Unable to parse unknown geometry type '${e}'`))}function XJ(e,t,i,r){const n=e&&("coords"in e?e:e.geometry);if(ce(n))return null;switch(t){case"esriGeometryPoint":{let o=Q9;return i&&r?o=pA:i?o=uA:r&&(o=hA),o(n)}case"esriGeometryMultipoint":return fA(n,i,r);case"esriGeometryPolyline":return yA(n,i,r);case"esriGeometryPolygon":return mA(n,i,r);default:return m1.error("convertToGeometry:unknown-geometry",new ue(`Unable to parse unknown geometry type '${t}'`)),null}}function JIe(e,t){for(const i of t)e.push({attributes:i.attributes});return e}function QJ(e,t,i,r,n){if(wc(e),ce(i))return JIe(e,t);switch(i){case"esriGeometryPoint":return BIe(e,t,r,n);case"esriGeometryMultipoint":return UIe(e,t,r,n);case"esriGeometryPolyline":return qIe(e,t,r,n);case"esriGeometryPolygon":return HIe(e,t,r,n);default:m1.error("convertToFeatureSet:unknown-geometry",new ue(`Unable to parse unknown geometry type '${i}'`))}return e}function qZe(e){const{objectIdFieldName:t,spatialReference:i,transform:r,fields:n,hasM:o,hasZ:c,features:h,geometryType:m,exceededTransferLimit:b,uniqueIdField:x,queryGeometry:I,queryGeometryType:E}=e,k={features:QJ([],h,m,c,o),fields:n,geometryType:m,objectIdFieldName:t,spatialReference:i,uniqueIdField:x,queryGeometry:XJ(I,E,!1,!1)};return r&&(k.transform=r),b&&(k.exceededTransferLimit=b),o&&(k.hasM=o),c&&(k.hasZ=c),k}function HZe(e,t){var E;const i=new Y9,{hasM:r,hasZ:n,features:o,objectIdFieldName:c,spatialReference:h,geometryType:m,exceededTransferLimit:b,transform:x,fields:I}=e;return I&&(i.fields=I),i.geometryType=m!=null?m:null,i.objectIdFieldName=(E=c!=null?c:t)!=null?E:null,i.spatialReference=h!=null?h:null,i.objectIdFieldName?(o&&YJ(i.features,o,m,n,r,i.objectIdFieldName),b&&(i.exceededTransferLimit=b),r&&(i.hasM=r),n&&(i.hasZ=n),x&&(i.transform=x),i):(m1.error(new ue("optimized-features:invalid-objectIdFieldName","objectIdFieldName is missing")),i)}function WZe(e){const{transform:t,features:i,hasM:r,hasZ:n}=e;if(!t)return e;for(const o of i)H(o.geometry)&&vA(o.geometry,o.geometry,r,n,t),H(o.centroid)&&vA(o.centroid,o.centroid,r,n,t);return e.transform=null,e}function JZe(e,t){const{geometryType:i,features:r,hasM:n,hasZ:o}=t;if(!e)return t;for(let c=0;c<r.length;c++){const h=r[c],m=h.weakClone();m.geometry=new $s,s2(m.geometry,h.geometry,n,o,i,e),h.centroid&&(m.centroid=new $s,s2(m.centroid,h.centroid,n,o,"esriGeometryPoint",e)),r[c]=m}return t.transform=e,t}function s2(e,t,i,r,n,o,c=i,h=r){if(Bh(e),ce(t)||!t.coords.length)return null;const m=zJ[n],{coords:b,lengths:x}=t,I=Us(i,r),E=Us(i&&c,r&&h),k=sA(i,r,c,h);if(!x.length)return k(e.coords,b,0,0,oA(o,b[0]),aA(o,b[1])),Bh(e,I,0),e;let P,F,N,B,z=0,q=0,J=q;for(const X of x){if(X<m)continue;let Y=0;q=J,N=P=oA(o,b[z]),B=F=aA(o,b[z+1]),k(e.coords,b,q,z,N,B),Y++,z+=I,q+=E;for(let ae=1;ae<X;ae++,z+=I)N=oA(o,b[z]),B=aA(o,b[z+1]),N===P&&B===F||(k(e.coords,b,q,z,N-P,B-F),q+=E,Y++,P=N,F=B);Y>=m&&(e.lengths.push(Y),J=q)}return wc(e.coords,J),e.coords.length?e:null}function ZIe(e,t,i,r,n,o,c=i,h=r){if(Bh(e),!t||!t.coords.length)return null;const m=zJ[n],{coords:b,lengths:x}=t,I=Us(i,r),E=Us(i&&c,r&&h),k=sA(i,r,c,h);if(!x.length)return k(e.coords,b,0,0,b[0],b[1]),Bh(e,I,0),e;let P=0;const F=o*o;for(const N of x){if(N<m){P+=N*I;continue}const B=e.coords.length/E,z=P,q=P+(N-1)*I;k(e.coords,b,e.coords.length,z,b[z],b[z+1]),gA(e.coords,b,I,F,k,z,q),k(e.coords,b,e.coords.length,q,b[q],b[q+1]);const J=e.coords.length/E-B;J>=m?e.lengths.push(J):wc(e.coords,B*E),P+=N*I}return e.coords.length?e:null}function KIe(e,t,i,r){const n=e[t],o=e[t+1],c=e[i],h=e[i+1],m=e[r],b=e[r+1];let x=c,I=h,E=m-x,k=b-I;if(E!==0||k!==0){const P=((n-x)*E+(o-I)*k)/(E*E+k*k);P>1?(x=m,I=b):P>0&&(x+=E*P,I+=k*P)}return E=n-x,k=o-I,E*E+k*k}function gA(e,t,i,r,n,o,c){let h,m=r,b=0;for(let x=o+i;x<c;x+=i)h=KIe(t,x,o,c),h>m&&(b=x,m=h);m>r&&(b-o>i&&gA(e,t,i,r,n,o,b),n(e,t,e.length,b,t[b],t[b+1]),c-b>i&&gA(e,t,i,r,n,b,c))}function ZZe(e,t,i,r){if(ce(t)||!t.coords||!t.coords.length)return null;const n=Us(i,r);let o=Number.POSITIVE_INFINITY,c=Number.POSITIVE_INFINITY,h=Number.NEGATIVE_INFINITY,m=Number.NEGATIVE_INFINITY;if(t&&t.coords){const b=t.coords;for(let x=0;x<b.length;x+=n){const I=b[x],E=b[x+1];o=Math.min(o,I),h=Math.max(h,I),c=Math.min(c,E),m=Math.max(m,E)}}return e[0]=o,e[1]=c,e[2]=h,e[3]=m,e}function vA(e,t,i,r,n){var F,N,B,z,q,J,X,Y;const{coords:o,lengths:c}=t,h=Us(i,r);if(!o.length)return e!==t&&Bh(e),e;Zm(n);const{originPosition:m,scale:b,translate:x}=n,I=QIe;I.originPosition=m;const E=I.scale;E[0]=(F=b[0])!=null?F:1,E[1]=-((N=b[1])!=null?N:1),E[2]=(B=b[2])!=null?B:1,E[3]=(z=b[3])!=null?z:1;const k=I.translate;if(k[0]=(q=x[0])!=null?q:0,k[1]=(J=x[1])!=null?J:0,k[2]=(X=x[2])!=null?X:0,k[3]=(Y=x[3])!=null?Y:0,!c.length){for(let ae=0;ae<h;++ae)e.coords[ae]=lA(I,o[ae],ae);return e!==t&&Bh(e,h,0),e}let P=0;for(let ae=0;ae<c.length;ae++){const he=c[ae];e.lengths[ae]=he;for(let xe=0;xe<h;++xe)e.coords[P+xe]=lA(I,o[P+xe],xe);let fe=e.coords[P],ye=e.coords[P+1];P+=h;for(let xe=1;xe<he;xe++,P+=h){fe+=o[P]*E[0],ye+=o[P+1]*E[1],e.coords[P]=fe,e.coords[P+1]=ye;for(let Se=2;Se<h;++Se)e.coords[P+Se]=lA(I,o[P+Se],Se)}}return e!==t&&Bh(e,o.length,c.length),e}function YIe(e,t,i,r,n,o){if(Bh(e),e.lengths.push(...t.lengths),i===n&&r===o)for(let c=0;c<t.coords.length;c++)e.coords.push(t.coords[c]);else{const c=Us(i,r),h=sA(i,r,n,o),m=t.coords;for(let b=0;b<m.length;b+=c)h(e.coords,m,e.coords.length,b,m[b],m[b+1])}return e}function XIe(e,t,i,r){let n=0,o=e[r*t],c=e[r*(t+1)];for(let h=1;h<i;h++){const m=o+e[r*(t+h)],b=c+e[r*(t+h)+1],x=(m-o)*(b+c);o=m,c=b,n+=x}return .5*n}function KZe(e,t){const{coords:i,lengths:r}=e;let n=0,o=0;for(let c=0;c<r.length;c++){const h=r[c];o+=XIe(i,n,h,t),n+=h}return Math.abs(o)}function YZe(e,t){if(ce(e))return null;const i=e.clone(),r=e.coords,n=e.lengths;let o=0;for(let c=0;c<n.length;c++){const h=n[c];let m=r[t*o],b=r[t*o+1];for(let x=1;x<h;x++){const I=m+r[t*(o+x)],E=b+r[t*(o+x)+1];i.coords[t*(o+x)]=I,i.coords[t*(o+x)+1]=E,m=I,b=E}o+=h}return i}function Bh(e,t=0,i=0){wc(e.lengths,i),wc(e.coords,t)}function wc(e,t=0){e.length!==t&&(e.length=t)}const QIe={originPosition:"lowerLeft",scale:[1,1,1,1],translate:[0,0,0,0]};var bA;let Ur=bA=class extends ke{constructor(e){super(e),this.cacheHint=void 0,this.dynamicDataSource=void 0,this.gdbVersion=null,this.geometryPrecision=void 0,this.historicMoment=null,this.maxAllowableOffset=void 0,this.objectIds=null,this.orderByFields=null,this.outFields=null,this.outSpatialReference=null,this.relationshipId=void 0,this.start=void 0,this.num=void 0,this.returnGeometry=!1,this.returnM=void 0,this.returnZ=void 0,this.where=null}_writeHistoricMoment(e,t){t.historicMoment=e&&e.getTime()}writeStart(e,t){t.resultOffset=this.start,t.resultRecordCount=this.num||10,this.start>0&&this.where==null&&(t.definitionExpression="1=1")}clone(){return new bA(_e({cacheHint:this.cacheHint,dynamicDataSource:this.dynamicDataSource,gdbVersion:this.gdbVersion,geometryPrecision:this.geometryPrecision,historicMoment:this.historicMoment&&new Date(this.historicMoment.getTime()),maxAllowableOffset:this.maxAllowableOffset,objectIds:this.objectIds,orderByFields:this.orderByFields,outFields:this.outFields,outSpatialReference:this.outSpatialReference,relationshipId:this.relationshipId,start:this.start,num:this.num,returnGeometry:this.returnGeometry,where:this.where,returnZ:this.returnZ,returnM:this.returnM}))}};g([w({type:Boolean,json:{write:!0}})],Ur.prototype,"cacheHint",void 0),g([w({type:Ba,json:{write:!0}})],Ur.prototype,"dynamicDataSource",void 0),g([w({type:String,json:{write:!0}})],Ur.prototype,"gdbVersion",void 0),g([w({type:Number,json:{write:!0}})],Ur.prototype,"geometryPrecision",void 0),g([w({type:Date})],Ur.prototype,"historicMoment",void 0),g([tt("historicMoment")],Ur.prototype,"_writeHistoricMoment",null),g([w({type:Number,json:{write:!0}})],Ur.prototype,"maxAllowableOffset",void 0),g([w({type:[Number],json:{write:!0}})],Ur.prototype,"objectIds",void 0),g([w({type:[String],json:{write:!0}})],Ur.prototype,"orderByFields",void 0),g([w({type:[String],json:{write:!0}})],Ur.prototype,"outFields",void 0),g([w({type:Mt,json:{read:{source:"outSR"},write:{target:"outSR"}}})],Ur.prototype,"outSpatialReference",void 0),g([w({json:{write:!0}})],Ur.prototype,"relationshipId",void 0),g([w({type:Number,json:{read:{source:"resultOffset"}}})],Ur.prototype,"start",void 0),g([tt("start"),tt("num")],Ur.prototype,"writeStart",null),g([w({type:Number,json:{read:{source:"resultRecordCount"}}})],Ur.prototype,"num",void 0),g([w({json:{write:!0}})],Ur.prototype,"returnGeometry",void 0),g([w({type:Boolean,json:{write:{overridePolicy:e=>({enabled:e})}}})],Ur.prototype,"returnM",void 0),g([w({type:Boolean,json:{write:{overridePolicy:e=>({enabled:e})}}})],Ur.prototype,"returnZ",void 0),g([w({type:String,json:{read:{source:"definitionExpression"},write:{target:"definitionExpression"}}})],Ur.prototype,"where",void 0),Ur=bA=g([te("esri.rest.support.RelationshipQuery")],Ur),Ur.from=Oi(Ur);const _y=Ur;var wA;let v1=wA=class extends ke{constructor(e){super(e),this.groupByFields=void 0,this.topCount=void 0,this.orderByFields=void 0}clone(){return new wA({groupByFields:this.groupByFields,topCount:this.topCount,orderByFields:this.orderByFields})}};g([w({type:[String],json:{write:!0}})],v1.prototype,"groupByFields",void 0),g([w({type:Number,json:{write:!0}})],v1.prototype,"topCount",void 0),g([w({type:[String],json:{write:!0}})],v1.prototype,"orderByFields",void 0),v1=wA=g([te("esri.rest.support.TopFilter")],v1);const e4e=v1;var _A;const eZ=new kt({esriSpatialRelIntersects:"intersects",esriSpatialRelContains:"contains",esriSpatialRelCrosses:"crosses",esriSpatialRelDisjoint:"disjoint",esriSpatialRelEnvelopeIntersects:"envelope-intersects",esriSpatialRelIndexIntersects:"index-intersects",esriSpatialRelOverlaps:"overlaps",esriSpatialRelTouches:"touches",esriSpatialRelWithin:"within",esriSpatialRelRelation:"relation"}),tZ=new kt({esriSRUnit_Meter:"meters",esriSRUnit_Kilometer:"kilometers",esriSRUnit_Foot:"feet",esriSRUnit_StatuteMile:"miles",esriSRUnit_NauticalMile:"nautical-miles",esriSRUnit_USNauticalMile:"us-nautical-miles"});let Cr=_A=class extends ke{constructor(e){super(e),this.cacheHint=void 0,this.distance=void 0,this.geometry=null,this.geometryPrecision=void 0,this.maxAllowableOffset=void 0,this.num=void 0,this.objectIds=null,this.orderByFields=null,this.outFields=null,this.outSpatialReference=null,this.resultType=null,this.returnGeometry=!1,this.returnM=void 0,this.returnZ=void 0,this.start=void 0,this.spatialRelationship="intersects",this.timeExtent=null,this.topFilter=void 0,this.units=null,this.where="1=1"}writeStart(e,t){t.resultOffset=this.start,t.resultRecordCount=this.num||10}clone(){return new _A(_e({cacheHint:this.cacheHint,distance:this.distance,geometry:this.geometry,geometryPrecision:this.geometryPrecision,maxAllowableOffset:this.maxAllowableOffset,num:this.num,objectIds:this.objectIds,orderByFields:this.orderByFields,outFields:this.outFields,outSpatialReference:this.outSpatialReference,resultType:this.resultType,returnGeometry:this.returnGeometry,returnZ:this.returnZ,returnM:this.returnM,start:this.start,spatialRelationship:this.spatialRelationship,timeExtent:this.timeExtent,topFilter:this.topFilter,units:this.units,where:this.where}))}};g([w({type:Boolean,json:{write:!0}})],Cr.prototype,"cacheHint",void 0),g([w({type:Number,json:{write:{overridePolicy:e=>({enabled:e>0})}}})],Cr.prototype,"distance",void 0),g([w({types:wh,json:{read:xs,write:!0}})],Cr.prototype,"geometry",void 0),g([w({type:Number,json:{write:!0}})],Cr.prototype,"geometryPrecision",void 0),g([w({type:Number,json:{write:!0}})],Cr.prototype,"maxAllowableOffset",void 0),g([w({type:Number,json:{read:{source:"resultRecordCount"}}})],Cr.prototype,"num",void 0),g([w({json:{write:!0}})],Cr.prototype,"objectIds",void 0),g([w({type:[String],json:{write:!0}})],Cr.prototype,"orderByFields",void 0),g([w({type:[String],json:{write:!0}})],Cr.prototype,"outFields",void 0),g([w({type:Mt,json:{read:{source:"outSR"},write:{target:"outSR"}}})],Cr.prototype,"outSpatialReference",void 0),g([w({type:String,json:{write:!0}})],Cr.prototype,"resultType",void 0),g([w({json:{write:!0}})],Cr.prototype,"returnGeometry",void 0),g([w({type:Boolean,json:{write:{overridePolicy:e=>({enabled:e})}}})],Cr.prototype,"returnM",void 0),g([w({type:Boolean,json:{write:{overridePolicy:e=>({enabled:e})}}})],Cr.prototype,"returnZ",void 0),g([w({type:Number,json:{read:{source:"resultOffset"}}})],Cr.prototype,"start",void 0),g([tt("start"),tt("num")],Cr.prototype,"writeStart",null),g([w({type:String,json:{read:{source:"spatialRel",reader:eZ.read},write:{target:"spatialRel",writer:eZ.write}}})],Cr.prototype,"spatialRelationship",void 0),g([w({type:qa,json:{write:!0}})],Cr.prototype,"timeExtent",void 0),g([w({type:e4e,json:{write:!0}})],Cr.prototype,"topFilter",void 0),g([w({type:String,json:{read:tZ.read,write:{writer:tZ.write,overridePolicy(e){return{enabled:H(e)&&H(this.distance)&&this.distance>0}}}}})],Cr.prototype,"units",void 0),g([w({type:String,json:{write:!0}})],Cr.prototype,"where",void 0),Cr=_A=g([te("esri.rest.support.TopFeaturesQuery")],Cr),Cr.from=Oi(Cr);const tf=Cr,t4e="esri.widgets.Feature.support.relatedFeatureUtils",iZ=$e.getLogger(t4e),rZ=new Map;function xA(e){if(!Nh(e))return null;const[t,i]=e.split("/").slice(1);return{layerId:t,fieldName:i}}function i4e(e,t){if(!t.relationships)return null;let i=null;const{relationships:r}=t;return r.some(n=>n.id===parseInt(e,10)&&(i=n,!0)),i}function r4e({originRelationship:e,relationships:t,layerId:i}){let r;return t&&t.some(n=>(`${n.relatedTableId}`===i&&n.id===e.id&&(r=n),!!r)),r}function n4e(e,t){const i=t.toLowerCase();for(const r in e)if(r.toLowerCase()===i)return e[r];return null}function s4e(e,t){const i=i4e(e,t);if(!!i)return{url:`${t.url}/${i.relatedTableId}`,sourceSpatialReference:t.spatialReference,relation:i,relatedFields:[],outStatistics:[]}}function o4e(e,t){if(!t||!e)return;const{features:i,statsFeatures:r}=e,n=i&&i.value;t.relatedFeatures=n?n.features:[];const o=r&&r.value;t.relatedStatsFeatures=o?o.features:[]}function a4e(e,t,i,r){const n=new _y;return n.outFields=["*"],n.relationshipId=typeof t.id=="number"?t.id:parseInt(t.id,10),n.objectIds=[e.attributes[i.objectIdField]],i.queryRelatedFeatures(n,r)}function l4e(e,t,i){let r=0;const n=[];for(;r<t.length;)n.push(`${e} IN (${t.slice(r,i+r)})`),r+=i;return n.join(" OR ")}async function c4e(e,t,i,r){const n=i.layerId.toString(),{layerInfo:o,relation:c,relatedFields:h,outStatistics:m,url:b,sourceSpatialReference:x}=t,I=r4e({originRelationship:c,relationships:o.relationships,layerId:n});if(I.relationshipTableId&&I.keyFieldInRelationshipTable){const k=(await a4e(e,I,i,r))[e.attributes[i.objectIdField]];if(!k)return null;const P=k.features.map(F=>F.attributes[o.objectIdField]);if((m==null?void 0:m.length)>0&&o.supportsStatistics){const F=new co;F.where=l4e(o.objectIdField,P,1e3),F.outFields=h,F.outStatistics=m,F.sourceSpatialReference=x;const N={features:Promise.resolve(k),statsFeatures:nA(b,F)};return Mr(N)}}const E=I==null?void 0:I.keyField;if(E){const k=qT(f4e(o.fields,E)),P=n4e(e.attributes,c.keyField),F=k?`${E}=${P}`:`${E}='${P}'`,N=nA(b,new co({where:F,outFields:t.relatedFields,sourceSpatialReference:x}),r),B=t.outStatistics&&t.outStatistics.length>0&&o.supportsStatistics?nA(b,new co({where:F,outFields:t.relatedFields,outStatistics:t.outStatistics,sourceSpatialReference:x}),r):null,z={features:N};return B&&(z.statsFeatures=B),Mr(z)}return null}function u4e(e,t){return Nt(e,{query:{f:"json"},signal:t&&t.signal})}function h4e({relatedInfos:e,layer:t},i){const r={};return e.forEach((n,o)=>{const{relation:c}=n;if(!c){const I=new ue("relation-required","A relation is required on a layer to retrieve related records.");throw iZ.error(I),I}const{relatedTableId:h}=c;if(typeof h!="number"){const I=new ue("A related table ID is required on a layer to retrieve related records.");throw iZ.error(I),I}const m=`${t.url}/${h}`,b=rZ.get(m),x=b||u4e(m,i);b||rZ.set(m,x),r[o]=x}),Mr(r)}function p4e({graphic:e,relatedInfos:t,layer:i},r){const n={};return t.forEach((o,c)=>{o.layerInfo&&(n[c]=c4e(e,o,i,r))}),Mr(n)}function d4e({relatedInfo:e,fieldName:t,fieldInfo:i}){if(e.relatedFields.push(t),i.statisticType){const r=new VJ({statisticType:i.statisticType,onStatisticField:t,outStatisticFieldName:t});e.outStatistics.push(r)}}function f4e(e,t){if(e!=null){t=t.toLowerCase();for(const i of e)if(i&&i.name.toLowerCase()===t)return i}return null}const nZ={chartAnimation:!0};let cs=class extends Ye{constructor(e){super(e),this.abilities=K({},nZ),this.activeMediaInfoIndex=0,this.attributes=null,this.description=null,this.fieldInfoMap=null,this.formattedAttributes=null,this.expressionAttributes=null,this.layer=null,this.mediaInfos=null,this.popupTemplate=null,this.relatedInfos=null,this.title=null}castAbilities(e){return K(K({},nZ),e)}get activeMediaInfo(){return this.formattedMediaInfos[this.activeMediaInfoIndex]||null}get formattedMediaInfos(){return this._formatMediaInfos()||[]}get formattedMediaInfoCount(){return this.formattedMediaInfos.length}setActiveMedia(e){this._setContentElementMedia(e)}next(){this._pageContentElementMedia(1)}previous(){this._pageContentElementMedia(-1)}_setContentElementMedia(e){const{formattedMediaInfoCount:t}=this,i=(e+t)%t;this.activeMediaInfoIndex=i}_pageContentElementMedia(e){const{activeMediaInfoIndex:t}=this,i=t+e;this._setContentElementMedia(i)}_formatMediaInfos(){const{attributes:e,mediaInfos:t,formattedAttributes:i,expressionAttributes:r,fieldInfoMap:n,layer:o}=this;return t==null?void 0:t.map(c=>{const h=c==null?void 0:c.clone();if(!h)return null;if(h.title=py({attributes:e,fieldInfoMap:n,globalAttributes:i,expressionAttributes:r,layer:o,text:h.title}),h.caption=py({attributes:e,fieldInfoMap:n,globalAttributes:i,expressionAttributes:r,layer:o,text:h.caption}),h.altText=py({attributes:e,fieldInfoMap:n,globalAttributes:i,expressionAttributes:r,layer:o,text:h.altText}),h.type==="image"){const{value:m}=h;return this._setImageValue({value:m,formattedAttributes:i,layer:o}),h.value.sourceURL?h:void 0}if(h.type==="pie-chart"||h.type==="line-chart"||h.type==="column-chart"||h.type==="bar-chart"){const{value:m}=h;return this._setChartValue({value:m,chartType:h.type,attributes:e,formattedAttributes:i,layer:o,expressionAttributes:r}),h}return null}).filter(Boolean)}_setImageValue(e){const{fieldInfoMap:t}=this,{value:i,formattedAttributes:r,layer:n}=e,{linkURL:o,sourceURL:c}=i;if(c){const h=p7(c,n);i.sourceURL=h7({formattedAttributes:r,template:h,fieldInfoMap:t})}if(o){const h=p7(o,n);i.linkURL=h7({formattedAttributes:r,template:h,fieldInfoMap:t})}}_setChartValue(e){const{value:t,attributes:i,formattedAttributes:r,chartType:n,layer:o,expressionAttributes:c}=e,{popupTemplate:h,relatedInfos:m}=this,{fields:b,normalizeField:x}=t;if(t.fields=F5e(b,o),x&&(t.normalizeField=D_(x,o)),!b.some(E=>!!(r[E]!=null||Nh(E)&&m.size)))return;const I=h==null?void 0:h.fieldInfos;b.forEach(E=>{if(Nh(E))return void(t.series=[...t.series,...this._getRelatedChartInfos({fieldInfos:I,fieldName:E,formattedAttributes:r,chartType:n,value:t})]);const k=this._getChartOption({value:t,attributes:i,chartType:n,formattedAttributes:r,expressionAttributes:c,fieldName:E,fieldInfos:I});t.series.push(k)})}_getRelatedChartInfos(e){var P;const{fieldInfos:t,fieldName:i,formattedAttributes:r,chartType:n,value:o}=e,c=[],h=xA(i),{layerId:m,fieldName:b}=h,x=(P=this.relatedInfos)==null?void 0:P.get(m.toString());if(!x)return c;const{relatedFeatures:I,relation:E}=x;if(!E||!I)return c;const{cardinality:k}=E;return I.forEach(F=>{const{attributes:N}=F;N&&Object.keys(N).forEach(B=>{B===b&&c.push(this._getChartOption({value:o,attributes:N,formattedAttributes:r,fieldName:i,chartType:n,relatedFieldName:B,fieldInfos:t}))})}),k==="one-to-many"||k==="many-to-many"?c:[c[0]]}_getTooltip({label:e,value:t,chartType:i}){return i==="pie-chart"?`${e}`:`${e}: ${t}`}_getChartOption(e){var J,X,Y,ae,he,fe;const{value:t,attributes:i,formattedAttributes:r,expressionAttributes:n,fieldName:o,relatedFieldName:c,fieldInfos:h,chartType:m}=e,{layer:b,fieldInfoMap:x}=this,{normalizeField:I,tooltipField:E}=t,k=I?Nh(I)?i[xA(I).fieldName]:i[I]:null,P=c7(o)&&n&&n[o]!==void 0?n[o]:c&&i[c]!==void 0?i[c]:i[o]!==void 0?i[o]:r[o],F=new Hz({fieldName:o,value:P===void 0?null:P&&k?P/k:P});if(Nh(o)){const ye=x.get(o.toLowerCase()),xe=x.get(E.toLowerCase()),Se=(J=ye==null?void 0:ye.fieldName)!=null?J:o,Ae=(he=(ae=(Y=r[(X=xe==null?void 0:xe.fieldName)!=null?X:E])!=null?Y:ye==null?void 0:ye.label)!=null?ae:ye==null?void 0:ye.fieldName)!=null?he:c,Oe=r[Se];return F.tooltip=this._getTooltip({label:Ae,value:Oe,chartType:m}),F}const N=fW(h,o),B=D_(o,b),z=E&&r[E]!==void 0?r[E]:hW(N||new Lw({fieldName:B}),(fe=this.popupTemplate)==null?void 0:fe.expressionInfos),q=r[B];return F.tooltip=this._getTooltip({label:z,value:q,chartType:m}),F}};g([w()],cs.prototype,"abilities",void 0),g([Dt("abilities")],cs.prototype,"castAbilities",null),g([w()],cs.prototype,"activeMediaInfoIndex",void 0),g([w({readOnly:!0})],cs.prototype,"activeMediaInfo",null),g([w()],cs.prototype,"attributes",void 0),g([w()],cs.prototype,"description",void 0),g([w()],cs.prototype,"fieldInfoMap",void 0),g([w()],cs.prototype,"formattedAttributes",void 0),g([w()],cs.prototype,"expressionAttributes",void 0),g([w({readOnly:!0})],cs.prototype,"formattedMediaInfos",null),g([w()],cs.prototype,"layer",void 0),g([w({readOnly:!0})],cs.prototype,"formattedMediaInfoCount",null),g([w()],cs.prototype,"mediaInfos",void 0),g([w()],cs.prototype,"popupTemplate",void 0),g([w()],cs.prototype,"relatedInfos",void 0),g([w()],cs.prototype,"title",void 0),cs=g([te("esri.widgets.Feature.FeatureMedia.FeatureMediaViewModel")],cs);const xy=cs;var sZ=["#ffffff","#858585","#ffbebe","#ffebbe","#ffebaf","#ffffbe","#e9ffbe","#d3ffbe","#beffe8","#bee8ff","#bed2ff","#e8beff","#ffbee8","#ebebeb","#707070","#ff7f7f","#ffa77f","#ffd37f","#ffff73","#d1ff73","#a3ff73","#73ffdf","#73dfff","#73b2ff","#df73ff","#ff73df","#d6d6d6","#5c5c5c","#ff0000","#ff5500","#ffaa00","#ffff00","#aaff00","#55ff00","#00ffc5","#00c5ff","#0070ff","#c500ff","#ff00c5","#c2c2c2","#474747","#e60000","#e64c00","#e69800","#e6e600","#98e600","#4ce600","#00e6a9","#00a9e6","#005ce6","#a900e6","#e600a9","#adadad","#242424","#a80000","#a83800","#a87000","#a8a800","#70a800","#38a800","#00a884","#0084a8","#004da8","#8400a8","#a80084","#999999","#1a1a1a","#730000","#732600","#734c00","#737300","#4c7300","#267300","#00734c","#004c73","#002673","#4c0073","#73004"],y4e=[].concat(sZ.slice(30,39),sZ.slice(28,30).reverse()),m4e=[{name:"default",colors:y4e},{name:"cat-dark",colors:["#ed5151","#149ece","#a7c636","#9e559c","#fc921f","#ffde3e","#f789d8","#b7814a","#3caf99","#6b6bd6","#b54779","#7f7f7f"]},{name:"tropical-bliss",colors:["#fce138","#ff9399","#fcd27e","#f1983c","#a553b7","#b1a9d0","#6ecffc","#4c81cd","#fc6f84","#fc3e5a","#6af689","#48885c"]},{name:"desert-blooms",colors:["#102432","#144d59","#ffc730","#ed9310","#a64f1b","#661510","#d9351a","#b31515","#4a0932","#8c213f","#18382e","#2c6954"]},{name:"under-the-sea",colors:["#bf9727","#607100","#00734c","#704489","#01acca","#024e76","#f09100","#ea311f","#c6004b","#7570b3","#666666","#333333"]},{name:"vibrant-rainbow",colors:["#fffb00","#f5cb11","#9fd40c","#46e39c","#32b8a6","#7ff2fa","#ac08cc","#dd33ff","#eb7200","#e8a784","#bf2e2e","#6c7000"]},{name:"ocean-bay",colors:["#191921","#11495c","#78b1c2","#454f4b","#8f8f82","#9be0c0","#87b051","#f7ec88","#ebdcc1","#dbb658","#c43541","#75351e"]},{name:"prairie-summer",colors:["#332424","#751555","#d47013","#d68989","#211173","#82aad6","#7bfaeb","#6ec9a8","#6b6408","#eada40","#ccc54a","#1fc235"]},{name:"pastel-chalk",colors:["#fffd99","#f5e6a4","#c1d48c","#b8e3d0","#a0b8b5","#cbf7fa","#d791f2","#dfc1eb","#f2b983","#e8c4b2","#bf8e8e","#94995c"]},{name:"seq-yellow-orange-red-bright",colors:["#910000","#b1260b","#c0370f","#e05919","#ef6a1d","#ff7b22","#ffa143","#ffb454","#ffda74","#ffed85"]},{name:"seq-reds-bright",colors:["#57453b","#7b4238","#9f4036","#c23d33","#d7483c","#ec5244","#f3696c","#f9816c","#ffc4ae","#fff0dc"]},{name:"seq-purples-bright",colors:["#4e465c","#5a4a78","#695291","#775baa","#8663c3","#946bdc","#aa89e8","#c1a6f3","#d7c4ff","#e6e1ff"]},{name:"seq-blues-bright",colors:["#404d54","#435c6c","#48799d","#4b88b6","#4d96ce","#50a5e7","#74bbed","#98d0f3","#bce6f9","#e6faff"]},{name:"seq-greens-bright",colors:["#39544c","#386757","#368165","#359b73","#33b581","#4bc392","#64d2a2","#7ce0b3","#cbf6d9","#f4ffea"]},{name:"seq-browns-bright",colors:["#524834","#715b38","#8f6e3c","#ae8140","#cc9444","#eba748","#eeb664","#f0c47f","#f9e0b7","#fff8eb"]}];const oZ="en-us",SA=new Map([["ar",()=>import("./ar.879b710c.js").then(e=>e.a)],["bg-bg",()=>import("./bg_BG.fe9ea4c3.js").then(e=>e.b)],["bs-ba",()=>import("./bs_BA.e7f84418.js").then(e=>e.b)],["ca-es",()=>import("./ca_ES.387db45a.js").then(e=>e.c)],["cs-cz",()=>import("./cs_CZ.5ade5c0d.js").then(e=>e.c)],["da-dk",()=>import("./da_DK.2152686f.js").then(e=>e.d)],["de-de",()=>import("./de_DE.76855abe.js").then(e=>e.d)],["de-ch",()=>import("./de_CH.96b4e092.js").then(e=>e.d)],["el-gr",()=>import("./el_GR.a096939c.js").then(e=>e.e)],["en-us",()=>import("./en_US.88b02d0f.js").then(e=>e.e)],["en-ca",()=>import("./en_CA.194cf406.js").then(e=>e.e)],["es-es",()=>import("./es_ES.38df73d9.js").then(e=>e.e)],["et-ee",()=>import("./et_EE.02f760d6.js").then(e=>e.e)],["fi-fi",()=>import("./fi_FI.43a6efc4.js").then(e=>e.f)],["fr-fr",()=>import("./fr_FR.12ab81e0.js").then(e=>e.f)],["he-il",()=>import("./he_IL.884a9c3e.js").then(e=>e.h)],["hr-hr",()=>import("./hr_HR.47bc706e.js").then(e=>e.h)],["hu-hu",()=>import("./hu_HU.22c22c5b.js").then(e=>e.h)],["id-id",()=>import("./id_ID.20827ee4.js").then(e=>e.i)],["it-it",()=>import("./it_IT.0165168b.js").then(e=>e.i)],["ja-jp",()=>import("./ja_JP.aabf55bf.js").then(e=>e.j)],["ko-kr",()=>import("./ko_KR.f8a8a66d.js").then(e=>e.k)],["lt-lt",()=>import("./lt_LT.35ba8ba4.js").then(e=>e.l)],["lv-lv",()=>import("./lv_LV.c4d6c40a.js").then(e=>e.l)],["nb-no",()=>import("./nb_NO.6984c72f.js").then(e=>e.n)],["nl-nl",()=>import("./nl_NL.79ee27fd.js").then(e=>e.n)],["pl-pl",()=>import("./pl_PL.789ba43f.js").then(e=>e.p)],["pt-br",()=>import("./pt_BR.7ebf3b04.js").then(e=>e.p)],["pt-pt",()=>import("./pt_PT.03ca4426.js").then(e=>e.p)],["ro-ro",()=>import("./ro_RO.53de53b9.js").then(e=>e.r)],["ru-ru",()=>import("./ru_RU.376762a0.js").then(e=>e.r)],["sk-sk",()=>import("./sk_SK.0749b050.js").then(e=>e.s)],["sl-sl",()=>import("./sl_SL.b6cbb55d.js").then(e=>e.s)],["sr-rs",()=>import("./sr_RS.4cc13306.js").then(e=>e.s)],["sv-se",()=>import("./sv_SE.12d55371.js").then(e=>e.s)],["th-th",()=>import("./th_TH.6bead009.js").then(e=>e.t)],["tr-tr",()=>import("./tr_TR.4593c509.js").then(e=>e.t)],["uk-ua",()=>import("./uk_UA.ec94d425.js").then(e=>e.u)],["vi-vn",()=>import("./vi_VN.0caf960b.js").then(e=>e.v)],["zh-cn",()=>import("./zh_Hans.0cd46130.js").then(e=>e.z)],["zh-hk",()=>import("./zh_Hant.b6776671.js").then(e=>e.z)],["zh-tw",()=>import("./zh_Hant.b6776671.js").then(e=>e.z)]]);function g4e(e){const t=e.split("-")[0].toLowerCase();let i=null;for(const r of SA.keys())if(r.startsWith(t)){i=r;break}return i}function v4e(e){return e?SA.has(e.toLowerCase())?e.toLowerCase():g4e(e)||oZ:oZ}let b1,o2;async function b4e(e=io()){if(e=v4e(e),b1&&e===o2)return b1;b1=import("./index.5d7f09e8.js").then(t=>t.i),o2=e;try{const[t,i]=await Promise.all([b1,SA.get(o2)()]);o2===e&&(t.am4core.options.defaultLocale=i.default),t.am4core.options.suppressWarnings=!0,t.am4core.options.autoDispose=!0}catch{return b1=null,o2=null,null}return b1}function w4e(e,t="default"){const i=m4e.find(r=>r.name===t);return i?i.colors.map(r=>e.color(r)):null}const on={base:"esri-feature-media",mediaContainer:"esri-feature-media__container",mediaItemContainer:"esri-feature-media__item-container",mediaItem:"esri-feature-media__item",mediaItemTitle:"esri-feature-media__item-title",mediaItemCaption:"esri-feature-media__item-caption",mediaPrevious:"esri-feature-media__previous",mediaPreviousIconLTR:"esri-feature-media__previous-icon",mediaPreviousIconRTL:"esri-feature-media__previous-icon--rtl",mediaNext:"esri-feature-media__next",mediaNextIconLTR:"esri-feature-media__next-icon",mediaNextIconRTL:"esri-feature-media__next-icon--rtl",mediaChart:"esri-feature-media__chart",mediaButton:"esri-feature-media__button",mediaIcon:"esri-feature-media__icon",iconLeftTriangleArrow:"esri-icon-left-triangle-arrow",iconRightTriangleArrow:"esri-icon-right-triangle-arrow"},MA=.05,IA=.95,$A=15,Uh="color",rf="tooltip",a2="value",aZ="default-line-value";let ua=class extends ki{constructor(e,t){super(e,t),this._refreshTimer=null,this._refreshIntervalInfo=null,this._featureElementInfo=null,this.viewModel=new xy,this.messages=null,this._getChartDependencies=async i=>{const r=await b4e(),{destroyed:n,viewModel:o}=this;if(n||!o||!i)return;const{activeMediaInfo:c}=o,h=await this._getRendererColors(r);this._renderChart({chartDiv:i,mediaInfo:c,chartsModule:r,colorMap:h})}}initialize(){this._featureElementInfo=new k9,this.addHandles([we(()=>{var e,t;return[(e=this.viewModel)==null?void 0:e.activeMediaInfo,(t=this.viewModel)==null?void 0:t.activeMediaInfoIndex]},()=>this._setupMediaRefreshTimer(),St),we(()=>{var e,t;return[(e=this.viewModel)==null?void 0:e.description,(t=this.viewModel)==null?void 0:t.title]},()=>this._setupFeatureElementInfo(),St)])}destroy(){this._clearMediaRefreshTimer(),this._featureElementInfo.destroy()}get attributes(){return this.viewModel.attributes}set attributes(e){this.viewModel.attributes=e}get activeMediaInfoIndex(){return this.viewModel.activeMediaInfoIndex}set activeMediaInfoIndex(e){this.viewModel.activeMediaInfoIndex=e}get description(){return this.viewModel.description}set description(e){this.viewModel.description=e}get fieldInfoMap(){return this.viewModel.fieldInfoMap}set fieldInfoMap(e){this.viewModel.fieldInfoMap=e}get layer(){return this.viewModel.layer}set layer(e){this.viewModel.layer=e}get mediaInfos(){return this.viewModel.mediaInfos}set mediaInfos(e){this.viewModel.mediaInfos=e}get popupTemplate(){return this.viewModel.popupTemplate}set popupTemplate(e){this.viewModel.popupTemplate=e}get relatedInfos(){return this.viewModel.relatedInfos}set relatedInfos(e){this.viewModel.relatedInfos=e}get title(){return this.viewModel.title}set title(e){this.viewModel.title=e}render(){var e;return j("div",{bind:this,class:on.base,onkeyup:this._handleMediaKeyup},(e=this._featureElementInfo)==null?void 0:e.render(),this.renderMedia())}renderMedia(){const{formattedMediaInfoCount:e}=this.viewModel;return e?j("div",{key:"media-element-container",class:on.mediaContainer},this.renderMediaPageButton("previous"),this.renderMediaInfo(),this.renderMediaPageButton("next")):null}renderImageMediaInfo(e){const{_refreshIntervalInfo:t}=this,{activeMediaInfoIndex:i,formattedMediaInfoCount:r}=this.viewModel,{value:n,refreshInterval:o,altText:c,title:h,type:m}=e,{sourceURL:b,linkURL:x}=n,I=uW(x)?"_blank":"_self",E=I==="_blank"?"noreferrer":"",k=o?t:null,P=k?k.timestamp:0,F=k?k.sourceURL:b,N=j("img",{alt:c||h,key:`media-${m}-${i}-${r}-${P}`,src:F});return(x?j("a",{title:h,href:x,rel:E,target:I},N):null)||N}renderChartMediaInfo(e){const{activeMediaInfoIndex:t,formattedMediaInfoCount:i}=this.viewModel;return j("div",{key:`media-${e.type}-${t}-${i}`,bind:this,class:on.mediaChart,afterCreate:this._getChartDependencies})}renderMediaInfoType(){const{activeMediaInfo:e}=this.viewModel;return e?e.type==="image"?this.renderImageMediaInfo(e):e.type.includes("chart")?this.renderChartMediaInfo(e):null:null}renderMediaInfo(){const{activeMediaInfo:e}=this.viewModel;if(!e)return null;const t=e.title?j("div",{key:"media-title",class:on.mediaItemTitle,innerHTML:e.title}):null,i=e.caption?j("div",{key:"media-caption",class:on.mediaItemCaption,innerHTML:e.caption}):null;return j("div",{key:"media-container",class:on.mediaItemContainer},j("div",{key:"media-item-container",class:on.mediaItem},this.renderMediaInfoType()),t,i)}renderMediaPageButton(e){if(this.viewModel.formattedMediaInfoCount<2)return null;const t=e==="previous",i=t?this.messages.previous:this.messages.next,r=t?this.classes(on.mediaButton,on.mediaPrevious):this.classes(on.mediaButton,on.mediaNext),n=t?this.classes(on.mediaIcon,on.mediaPreviousIconLTR,on.iconLeftTriangleArrow):this.classes(on.mediaIcon,on.mediaNextIconLTR,on.iconRightTriangleArrow),o=t?this.classes(on.mediaIcon,on.mediaPreviousIconRTL,on.iconRightTriangleArrow):this.classes(on.mediaIcon,on.mediaNextIconRTL,on.iconLeftTriangleArrow),c=t?"media-previous":"media-next",h=t?this._previous:this._next;return j("button",{type:"button",key:c,title:i,"aria-label":i,tabIndex:0,class:r,bind:this,onclick:h},j("span",{"aria-hidden":"true",class:n}),j("span",{"aria-hidden":"true",class:o}))}_setupFeatureElementInfo(){const{description:e,title:t}=this;this._featureElementInfo.set({description:e,title:t})}_next(){this.viewModel.next()}_previous(){this.viewModel.previous()}async _getRendererColors(e){var c,h;const{am4core:t}=e,i=new Map,r=(h=(c=this.viewModel)==null?void 0:c.layer)==null?void 0:h.renderer,n="default";if(!r)return i;const o=await ZMe(r);return o.delete(n),Array.from(o.values()).every(m=>(m==null?void 0:m.length)===1)&&(i.set(aZ,t.color({r:50,g:50,b:50,a:1})),Array.from(o.keys()).forEach(m=>{m&&i.set(m,t.color(o.get(m)[0].toCss(!0)))})),i}_handleMediaKeyup(e){const t=to(e);t==="ArrowLeft"&&(e.stopPropagation(),this.viewModel.previous()),t==="ArrowRight"&&(e.stopPropagation(),this.viewModel.next())}_renderChart(e){const{abilities:t}=this.viewModel,{chartsModule:i,chartDiv:r,mediaInfo:n,colorMap:o}=e,{value:c,type:h}=n,{am4core:m}=i,b=w4e(m);function x(k){k instanceof m.ColorSet&&b&&(k.list=b)}z_()&&m.useTheme(i.am4themes_dark);const I=window.matchMedia("(prefers-reduced-motion: reduce)");t.chartAnimation&&!I.matches?m.useTheme(i.am4themes_animated):m.unuseTheme(i.am4themes_animated),m.useTheme(x);const E=h==="pie-chart"?this._createPieChart(e):this._createXYChart(e);r.setAttribute("aria-label",n.altText||n.title),E.data=c.series.map(k=>({[rf]:k.tooltip,[a2]:k.value,[Uh]:o.get(k.fieldName)})).filter(k=>h!=="pie-chart"||k.value>0)}_customizeChartTooltip(e,t){e.label.wrap=!0,e.label.maxWidth=200,e.autoTextColor=!1,e.getFillFromObject=!1,e.label.fill=t.color("#ffffff"),e.background.fill=t.color({r:0,g:0,b:0,a:.7})}_createPieChart(e){const{chartDiv:t,chartsModule:i}=e,{am4core:r,am4charts:n}=i,o=r.create(t,n.PieChart);o.rtl=Ms(this.container);const c=o.series.push(new n.PieSeries);return c.labels.template.disabled=!0,c.ticks.template.disabled=!0,c.dataFields.value=a2,c.dataFields.category=rf,this._customizeChartTooltip(c.tooltip,r),c.slices.template.propertyFields.fill=Uh,c.slices.template.propertyFields.stroke=Uh,o}_getMinSeriesValue(e){let t=0;return e.forEach(i=>t=Math.min(i.value,t)),t}_createColumnChart(e,t){const{chartsModule:i,mediaInfo:r}=t,{value:n}=r,{am4core:o,am4charts:c}=i,h=e.xAxes.push(new c.CategoryAxis);h.dataFields.category=rf,h.renderer.labels.template.disabled=!0,this._customizeChartTooltip(h.tooltip,o),h.tooltip.events.on("sizechanged",()=>{h.tooltip.dy=-h.tooltip.contentHeight});const m=e.yAxes.push(new c.ValueAxis),b=m.renderer.labels.template;m.renderer.minLabelPosition=MA,m.renderer.maxLabelPosition=IA,m.min=this._getMinSeriesValue(n.series),this._customizeChartTooltip(m.tooltip,o),b.wrap=!0;const x=e.series.push(new c.ColumnSeries);x.dataFields.valueY=a2,x.dataFields.categoryX=rf,x.columns.template.propertyFields.fill=Uh,x.columns.template.propertyFields.stroke=Uh,e.cursor=new c.XYCursor,n.series.length>$A&&(e.scrollbarX=new o.Scrollbar)}_createBarChart(e,t){const{chartsModule:i,mediaInfo:r}=t,{value:n}=r,{am4core:o,am4charts:c}=i,h=e.yAxes.push(new c.CategoryAxis);h.dataFields.category=rf,h.renderer.inversed=!0,h.renderer.labels.template.disabled=!0,this._customizeChartTooltip(h.tooltip,o),h.tooltip.events.on("sizechanged",()=>{h.tooltip.dx=h.tooltip.contentWidth});const m=e.xAxes.push(new c.ValueAxis),b=m.renderer.labels.template;m.renderer.minLabelPosition=MA,m.renderer.maxLabelPosition=IA,m.min=this._getMinSeriesValue(n.series),this._customizeChartTooltip(m.tooltip,o),b.wrap=!0;const x=e.series.push(new c.ColumnSeries);x.dataFields.valueX=a2,x.dataFields.categoryY=rf,x.columns.template.propertyFields.fill=Uh,x.columns.template.propertyFields.stroke=Uh,e.cursor=new c.XYCursor,n.series.length>$A&&(e.scrollbarY=new o.Scrollbar)}_createLineChart(e,t){const{chartsModule:i,mediaInfo:r,colorMap:n}=t,{value:o}=r,{am4core:c,am4charts:h}=i,m=e.xAxes.push(new h.CategoryAxis);m.dataFields.category=rf,m.renderer.labels.template.disabled=!0,this._customizeChartTooltip(m.tooltip,c),m.tooltip.events.on("sizechanged",()=>{m.tooltip.dy=-m.tooltip.contentHeight});const b=e.yAxes.push(new h.ValueAxis),x=b.renderer.labels.template;b.renderer.minLabelPosition=MA,b.renderer.maxLabelPosition=IA,b.min=this._getMinSeriesValue(o.series),this._customizeChartTooltip(b.tooltip,c),x.wrap=!0;const I=e.series.push(new h.LineSeries);I.dataFields.categoryX=rf,I.dataFields.valueY=a2,I.strokeWidth=1;const E=n.get(aZ);E&&(I.stroke=E);const k=I.bullets.push(new h.CircleBullet);k.propertyFields.fill=Uh,k.propertyFields.stroke=Uh,e.cursor=new h.XYCursor,o.series.length>$A&&(e.scrollbarX=new c.Scrollbar)}_createXYChart(e){const{chartDiv:t,chartsModule:i,mediaInfo:r}=e,{type:n}=r,{am4core:o,am4charts:c}=i,h=o.create(t,c.XYChart);return h.rtl=Ms(this.container),n==="column-chart"&&this._createColumnChart(h,e),n==="bar-chart"&&this._createBarChart(h,e),n==="line-chart"&&this._createLineChart(h,e),h}_clearMediaRefreshTimer(){const{_refreshTimer:e}=this;e&&(clearTimeout(e),this._refreshTimer=null)}_updateMediaInfoTimestamp(e){const t=Date.now();this._refreshIntervalInfo={timestamp:t,sourceURL:this._getImageSource(e,t)},this.scheduleRender()}_setupMediaRefreshTimer(){this._clearMediaRefreshTimer();const{activeMediaInfo:e}=this.viewModel;e&&e.type==="image"&&e.refreshInterval&&this._setRefreshTimeout(e)}_setRefreshTimeout(e){const{refreshInterval:t,value:i}=e;if(!t)return;const r=6e4*t;this._updateMediaInfoTimestamp(i.sourceURL);const n=setInterval(()=>{this._updateMediaInfoTimestamp(i.sourceURL)},r);this._refreshTimer=n}_getImageSource(e,t){const i=e.includes("?")?"&":"?",[r,n=""]=e.split("#");return`${r}${i}timestamp=${t}${n?"#":""}${n}`}};g([w()],ua.prototype,"attributes",null),g([w()],ua.prototype,"activeMediaInfoIndex",null),g([w()],ua.prototype,"description",null),g([w()],ua.prototype,"fieldInfoMap",null),g([w()],ua.prototype,"layer",null),g([w()],ua.prototype,"mediaInfos",null),g([w()],ua.prototype,"popupTemplate",null),g([w()],ua.prototype,"relatedInfos",null),g([w()],ua.prototype,"title",null),g([w({type:xy})],ua.prototype,"viewModel",void 0),g([w(),ci("esri/widgets/Feature/t9n/Feature")],ua.prototype,"messages",void 0),ua=g([te("esri.widgets.Feature.FeatureMedia")],ua);const lZ=ua;var EA;let l2=EA=class extends ke{constructor(e){super(e),this.minValue=0,this.maxValue=0}clone(){return new EA({minValue:this.minValue,maxValue:this.maxValue})}};g([w({type:Number,json:{write:!0}})],l2.prototype,"minValue",void 0),g([w({type:Number,json:{write:!0}})],l2.prototype,"maxValue",void 0),l2=EA=g([te("esri.renderer.support.AuthoringInfoClassBreakInfo")],l2);var TA;let nf=TA=class extends ke{constructor(e){super(e),this.field="",this.normalizationField="",this.label="",this.classBreakInfos=[]}clone(){return new TA({field:this.field,normalizationField:this.normalizationField,label:this.label,classBreakInfos:_e(this.classBreakInfos)})}};g([w({type:String,json:{write:!0}})],nf.prototype,"field",void 0),g([w({type:String,json:{write:!0}})],nf.prototype,"normalizationField",void 0),g([w({type:String,json:{write:!0}})],nf.prototype,"label",void 0),g([w({type:[l2],json:{write:!0}})],nf.prototype,"classBreakInfos",void 0),nf=TA=g([te("esri.renderers.support.AuthoringInfoFieldInfo")],nf);var CA;const eM=new kt({percentTotal:"percent-of-total",ratio:"ratio",percent:"percent"}),tM=new kt({sizeInfo:"size",colorInfo:"color",transparencyInfo:"opacity",rotationInfo:"rotation"}),cZ={key:e=>typeof e=="number"?"number":"string",typeMap:{number:Number,string:String},base:null},uZ=["high-to-low","above-and-below","centered-on","extremes"],hZ=[...new Set(["high-to-low","above-and-below","centered-on","extremes","90-10","above","below","high-to-low","above-and-below","90-10","above","below"])],pZ=["seconds","minutes","hours","days","months","years"];let ha=CA=class extends ke{constructor(e){super(e),this.endTime=null,this.field=null,this.maxSliderValue=null,this.minSliderValue=null,this.startTime=null,this.type=null,this.units=null}castEndTime(e){return typeof e=="string"||typeof e=="number"?e:null}castStartTime(e){return typeof e=="string"||typeof e=="number"?e:null}get style(){return this.type==="color"?this._get("style"):null}set style(e){this._set("style",e)}get theme(){return this.type==="color"||this.type==="size"?this._get("theme")||"high-to-low":null}set theme(e){this._set("theme",e)}clone(){return new CA({endTime:this.endTime,field:this.field,maxSliderValue:this.maxSliderValue,minSliderValue:this.minSliderValue,startTime:this.startTime,style:this.style,theme:this.theme,type:this.type,units:this.units})}};g([w({types:cZ,json:{write:!0}})],ha.prototype,"endTime",void 0),g([Dt("endTime")],ha.prototype,"castEndTime",null),g([w({type:String,json:{write:!0}})],ha.prototype,"field",void 0),g([w({type:Number,json:{write:!0}})],ha.prototype,"maxSliderValue",void 0),g([w({type:Number,json:{write:!0}})],ha.prototype,"minSliderValue",void 0),g([w({types:cZ,json:{write:!0}})],ha.prototype,"startTime",void 0),g([Dt("startTime")],ha.prototype,"castStartTime",null),g([w({type:eM.apiValues,value:null,json:{type:eM.jsonValues,read:eM.read,write:eM.write}})],ha.prototype,"style",null),g([w({type:hZ,value:null,json:{type:hZ,origins:{"web-scene":{type:uZ,write:{writer:(e,t)=>{uZ.includes(e)&&(t.theme=e)}}}},write:!0}})],ha.prototype,"theme",null),g([w({type:tM.apiValues,json:{type:tM.jsonValues,read:tM.read,write:tM.write}})],ha.prototype,"type",void 0),g([w({type:pZ,json:{type:pZ,write:!0}})],ha.prototype,"units",void 0),ha=CA=g([te("esri.renderers.support.AuthoringInfoVisualVariable")],ha);const _4e=ha;let iM=class extends ke{constructor(e){super(e),this.type=null}};g([w({readOnly:!0,json:{read:!1,write:!0}})],iM.prototype,"type",void 0),iM=g([te("esri.rest.support.ColorRamp")],iM);const kA=iM;var AA;let Sy=AA=class extends kA{constructor(e){super(e),this.algorithm=null,this.fromColor=null,this.toColor=null,this.type="algorithmic"}clone(){return new AA({fromColor:_e(this.fromColor),toColor:_e(this.toColor),algorithm:this.algorithm})}};g([Pt({esriCIELabAlgorithm:"cie-lab",esriHSVAlgorithm:"hsv",esriLabLChAlgorithm:"lab-lch"})],Sy.prototype,"algorithm",void 0),g([w({type:ut,json:{type:[Ri],write:!0}})],Sy.prototype,"fromColor",void 0),g([w({type:ut,json:{type:[Ri],write:!0}})],Sy.prototype,"toColor",void 0),g([w({type:["algorithmic"]})],Sy.prototype,"type",void 0),Sy=AA=g([te("esri.rest.support.AlgorithmicColorRamp")],Sy);const PA=Sy;var LA;let c2=LA=class extends kA{constructor(e){super(e),this.colorRamps=null,this.type="multipart"}clone(){return new LA({colorRamps:_e(this.colorRamps)})}};g([w({type:[PA],json:{write:!0}})],c2.prototype,"colorRamps",void 0),g([w({type:["multipart"]})],c2.prototype,"type",void 0),c2=LA=g([te("esri.rest.support.MultipartColorRamp")],c2);const dZ=c2,fZ={key:"type",base:kA,typeMap:{algorithmic:PA,multipart:dZ}};function yZ(e){return e&&e.type?e.type==="algorithmic"?PA.fromJSON(e):e.type==="multipart"?dZ.fromJSON(e):null:null}var OA;const My=new kt({esriClassifyDefinedInterval:"defined-interval",esriClassifyEqualInterval:"equal-interval",esriClassifyManual:"manual",esriClassifyNaturalBreaks:"natural-breaks",esriClassifyQuantile:"quantile",esriClassifyStandardDeviation:"standard-deviation"}),rM=new kt({pieChart:"pie-chart",classedSize:"class-breaks-size",classedColor:"class-breaks-color",univariateColorSize:"univariate-color-size",relationship:"relationship",predominance:"predominance",dotDensity:"dot-density",flow:"flow"}),mZ=new kt({classedSize:"class-breaks-size",classedColor:"class-breaks-color",univariateColorSize:"univariate-color-size",relationship:"relationship",predominance:"predominance",dotDensity:"dot-density"}),gZ=["inches","feet","yards","miles","nautical-miles","millimeters","centimeters","decimeters","meters","kilometers","decimal-degrees"],x4e=["high-to-low","above-and-below","above","below","90-10"],S4e=["flow-line","wave-front"],M4e=["caret","circle-caret","arrow","circle-arrow","plus-minus","circle-plus-minus","square","circle","triangle","happy-sad","thumb","custom"];let an=OA=class extends ke{constructor(e){super(e),this.colorRamp=null,this.fadeRatio=null,this.isAutoGenerated=!1,this.lengthUnit=null,this.maxSliderValue=null,this.minSliderValue=null,this.visualVariables=null}get classificationMethod(){const e=this._get("classificationMethod"),t=this.type;return t&&t!=="relationship"?t==="class-breaks-size"||t==="class-breaks-color"?e||"manual":null:e}set classificationMethod(e){this._set("classificationMethod",e)}readColorRamp(e){return e?yZ(e):void 0}get fields(){return this.type&&this.type!=="predominance"?null:this._get("fields")}set fields(e){this._set("fields",e)}get field1(){return this.type&&this.type!=="relationship"?null:this._get("field1")}set field1(e){this._set("field1",e)}get field2(){return this.type&&this.type!=="relationship"?null:this._get("field2")}set field2(e){this._set("field2",e)}get flowTheme(){return this.type==="flow"?this._get("flowTheme"):null}set flowTheme(e){this._set("flowTheme",e)}get focus(){return this.type&&this.type!=="relationship"?null:this._get("focus")}set focus(e){this._set("focus",e)}get numClasses(){return this.type&&this.type!=="relationship"?null:this._get("numClasses")}set numClasses(e){this._set("numClasses",e)}get statistics(){return this.type==="univariate-color-size"&&this.univariateTheme==="above-and-below"?this._get("statistics"):null}set statistics(e){this._set("statistics",e)}get standardDeviationInterval(){const e=this.type;return e&&e!=="relationship"&&e!=="class-breaks-size"&&e!=="class-breaks-color"||this.classificationMethod&&this.classificationMethod!=="standard-deviation"?null:this._get("standardDeviationInterval")}set standardDeviationInterval(e){this._set("standardDeviationInterval",e)}get type(){return this._get("type")}set type(e){let t=e;e==="classed-size"?t="class-breaks-size":e==="classed-color"&&(t="class-breaks-color"),this._set("type",t)}get univariateSymbolStyle(){return this.type==="univariate-color-size"&&this.univariateTheme==="above-and-below"?this._get("univariateSymbolStyle"):null}set univariateSymbolStyle(e){this._set("univariateSymbolStyle",e)}get univariateTheme(){return this.type==="univariate-color-size"?this._get("univariateTheme"):null}set univariateTheme(e){this._set("univariateTheme",e)}clone(){return new OA({classificationMethod:this.classificationMethod,colorRamp:_e(this.colorRamp),fadeRatio:_e(this.fadeRatio),fields:this.fields&&this.fields.slice(0),field1:_e(this.field1),field2:_e(this.field2),isAutoGenerated:this.isAutoGenerated,focus:this.focus,numClasses:this.numClasses,maxSliderValue:this.maxSliderValue,minSliderValue:this.minSliderValue,lengthUnit:this.lengthUnit,statistics:this.statistics,standardDeviationInterval:this.standardDeviationInterval,type:this.type,visualVariables:this.visualVariables&&this.visualVariables.map(e=>e.clone()),univariateSymbolStyle:this.univariateSymbolStyle,univariateTheme:this.univariateTheme,flowTheme:this.flowTheme})}};g([w({type:My.apiValues,value:null,json:{type:My.jsonValues,read:My.read,write:My.write,origins:{"web-document":{default:"manual",type:My.jsonValues,read:My.read,write:My.write}}}})],an.prototype,"classificationMethod",null),g([w({types:fZ,json:{write:!0}})],an.prototype,"colorRamp",void 0),g([We("colorRamp")],an.prototype,"readColorRamp",null),g([w({json:{write:!0,origins:{"web-scene":{write:!1,read:!1}}}})],an.prototype,"fadeRatio",void 0),g([w({type:[String],value:null,json:{write:!0}})],an.prototype,"fields",null),g([w({type:nf,value:null,json:{write:!0}})],an.prototype,"field1",null),g([w({type:nf,value:null,json:{write:!0}})],an.prototype,"field2",null),g([w({type:S4e,value:null,json:{write:!0,origins:{"web-scene":{write:!1}}}})],an.prototype,"flowTheme",null),g([w({type:["HH","HL","LH","LL"],value:null,json:{write:!0}})],an.prototype,"focus",null),g([w({type:Boolean,json:{write:!0,default:!1,origins:{"web-scene":{write:!1}}}})],an.prototype,"isAutoGenerated",void 0),g([w({type:Number,value:null,json:{type:Ri,write:!0}})],an.prototype,"numClasses",null),g([w({type:gZ,json:{type:gZ,read:!1,write:!1,origins:{"web-scene":{read:!0,write:!0}}}})],an.prototype,"lengthUnit",void 0),g([w({type:Number,json:{write:!0,origins:{"web-scene":{write:!1,read:!1}}}})],an.prototype,"maxSliderValue",void 0),g([w({type:Number,json:{write:!0,origins:{"web-scene":{write:!1,read:!1}}}})],an.prototype,"minSliderValue",void 0),g([w({type:Object,value:null,json:{write:!0,origins:{"web-scene":{write:!1,read:!1}}}})],an.prototype,"statistics",null),g([w({type:[.25,.33,.5,1],value:null,json:{type:[.25,.33,.5,1],write:!0}})],an.prototype,"standardDeviationInterval",null),g([w({type:rM.apiValues,value:null,json:{type:rM.jsonValues,read:rM.read,write:rM.write,origins:{"web-scene":{type:mZ.jsonValues,write:{writer:mZ.write,overridePolicy:e=>({enabled:e!=="flow"})}}}}})],an.prototype,"type",null),g([w({type:[_4e],json:{write:!0}})],an.prototype,"visualVariables",void 0),g([w({type:M4e,value:null,json:{write:!0,origins:{"web-scene":{write:!1}}}})],an.prototype,"univariateSymbolStyle",null),g([w({type:x4e,value:null,json:{write:!0,origins:{"web-scene":{write:!1}}}})],an.prototype,"univariateTheme",null),an=OA=g([te("esri.renderers.support.AuthoringInfo")],an);const RA=an,FA=new kt({simple:"simple",uniqueValue:"unique-value",classBreaks:"class-breaks",heatmap:"heatmap",dotDensity:"dot-density",dictionary:"dictionary",pieChart:"pie-chart"},{ignoreUnknown:!0});let u2=class extends ke{constructor(e){super(e),this.authoringInfo=null,this.type=null}async getRequiredFields(e){if(!this.collectRequiredFields)return[];const t=new Set;return await this.collectRequiredFields(t,e),Array.from(t).sort()}getSymbol(e,t){}async getSymbolAsync(e,t){}getSymbols(){return[]}getAttributeHash(){return JSON.stringify(this)}getMeshHash(){return JSON.stringify(this)}};g([w({type:RA,json:{write:!0}})],u2.prototype,"authoringInfo",void 0),g([w({type:FA.apiValues,readOnly:!0,json:{type:FA.jsonValues,read:!1,write:{writer:FA.write,ignoreOrigin:!0}}})],u2.prototype,"type",void 0),u2=g([te("esri.renderers.Renderer")],u2);const qh=u2;function I4e(e){var t,i,r;return(r=(i=(t=e.match($4e))==null?void 0:t[1])==null?void 0:i.replace(/\\'/g,"'"))!=null?r:null}const $4e=/^hash\(\$feature\['((\\'|[^'])+)'\]\) \* 8\.381e-8$/;var NA;let w1=NA=class extends ke{constructor(){super(...arguments),this.title=null}clone(){return new NA({title:this.title})}};g([w({type:String,json:{write:!0}})],w1.prototype,"title",void 0),w1=NA=g([te("esri.renderers.support.LegendOptions")],w1);var DA;let nM=DA=class extends w1{constructor(){super(...arguments),this.showLegend=null}clone(){return new DA({title:this.title,showLegend:this.showLegend})}};g([w({type:Boolean,json:{write:!0}})],nM.prototype,"showLegend",void 0),nM=DA=g([te("esri.renderers.visualVariables.support.VisualVariableLegendOptions")],nM);const vZ=nM,jA=new kt({colorInfo:"color",transparencyInfo:"opacity",rotationInfo:"rotation",sizeInfo:"size"});let _c=class extends ke{constructor(e){super(e),this.index=null,this.type=null,this.field=null,this.valueExpression=null,this.valueExpressionTitle=null,this.legendOptions=null}castField(e){return e==null?e:typeof e=="function"?($e.getLogger(this.declaredClass).error(".field: field must be a string value"),null):Qb(e)}get arcadeRequired(){return!!this.valueExpression}clone(){}getAttributeHash(){return`${this.type}-${this.field}-${this.valueExpression}`}};g([w()],_c.prototype,"index",void 0),g([w({type:jA.apiValues,readOnly:!0,json:{read:jA.read,write:jA.write}})],_c.prototype,"type",void 0),g([w({type:String,json:{write:!0}})],_c.prototype,"field",void 0),g([Dt("field")],_c.prototype,"castField",null),g([w({type:String,json:{write:!0}})],_c.prototype,"valueExpression",void 0),g([w({type:String,json:{write:!0}})],_c.prototype,"valueExpressionTitle",void 0),g([w({readOnly:!0})],_c.prototype,"arcadeRequired",null),g([w({type:vZ,json:{write:!0}})],_c.prototype,"legendOptions",void 0),_c=g([te("esri.renderers.visualVariables.VisualVariable")],_c);const h2=_c;var VA;let Iy=VA=class extends h2{constructor(e){super(e),this.type="color",this.normalizationField=null}get cache(){return{ipData:this._interpolateData(),hasExpression:!!this.valueExpression,compiledFunc:null}}set stops(e){e&&Array.isArray(e)&&(e=e.filter(t=>!!t)).sort((t,i)=>t.value-i.value),this._set("stops",e)}clone(){return new VA({field:this.field,normalizationField:this.normalizationField,valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle,stops:this.stops&&this.stops.map(e=>e.clone()),legendOptions:this.legendOptions&&this.legendOptions.clone()})}getAttributeHash(){return`${super.getAttributeHash()}-${this.normalizationField}`}_interpolateData(){return this.stops&&this.stops.map(e=>e.value||0)}};g([w({readOnly:!0})],Iy.prototype,"cache",null),g([w({type:["color"],json:{type:["colorInfo"]}})],Iy.prototype,"type",void 0),g([w({type:String,json:{write:!0}})],Iy.prototype,"normalizationField",void 0),g([w({type:[E9e],json:{write:!0}})],Iy.prototype,"stops",null),Iy=VA=g([te("esri.renderers.visualVariables.ColorVariable")],Iy);const bZ=Iy;var zA;let sf=zA=class extends ke{constructor(e){super(e),this.label=null,this.opacity=null,this.value=null}readOpacity(e,t){return qw(t.transparency)}writeOpacity(e,t,i){t[i]=p5(e)}clone(){return new zA({label:this.label,opacity:this.opacity,value:this.value})}};g([w({type:String,json:{write:!0}})],sf.prototype,"label",void 0),g([w({type:Number,json:{type:Ri,write:{target:"transparency"}}})],sf.prototype,"opacity",void 0),g([We("opacity",["transparency"])],sf.prototype,"readOpacity",null),g([tt("opacity")],sf.prototype,"writeOpacity",null),g([w({type:Number,json:{write:!0}})],sf.prototype,"value",void 0),sf=zA=g([te("esri.renderers.visualVariables.support.OpacityStop")],sf);const E4e=sf;var GA;let $y=GA=class extends h2{constructor(e){super(e),this.type="opacity",this.normalizationField=null}get cache(){return{ipData:this._interpolateData(),hasExpression:!!this.valueExpression,compiledFunc:null}}set stops(e){e&&Array.isArray(e)&&(e=e.filter(t=>!!t)).sort((t,i)=>t.value-i.value),this._set("stops",e)}clone(){return new GA({field:this.field,normalizationField:this.normalizationField,valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle,stops:this.stops&&this.stops.map(e=>e.clone()),legendOptions:this.legendOptions&&this.legendOptions.clone()})}getAttributeHash(){return`${super.getAttributeHash()}-${this.normalizationField}`}_interpolateData(){return this.stops&&this.stops.map(e=>e.value||0)}};g([w({readOnly:!0})],$y.prototype,"cache",null),g([w({type:["opacity"],json:{type:["transparencyInfo"]}})],$y.prototype,"type",void 0),g([w({type:String,json:{write:!0}})],$y.prototype,"normalizationField",void 0),g([w({type:[E4e],json:{write:!0}})],$y.prototype,"stops",null),$y=GA=g([te("esri.renderers.visualVariables.OpacityVariable")],$y);const wZ=$y;var BA;let Hh=BA=class extends h2{constructor(e){super(e),this.axis=null,this.type="rotation",this.rotationType="geographic",this.valueExpressionTitle=null}get cache(){return{hasExpression:!!this.valueExpression,compiledFunc:null}}writeValueExpressionTitleWebScene(e,t,i,r){if(r&&r.messages){const n=`visualVariables[${this.index}]`;r.messages.push(new ue("property:unsupported",this.type+"VisualVariable.valueExpressionTitle is not supported in Web Scene. Please remove this property to save the Web Scene.",{instance:this,propertyName:n+".valueExpressionTitle",context:r}))}}clone(){return new BA({axis:this.axis,rotationType:this.rotationType,field:this.field,valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle,legendOptions:this.legendOptions&&this.legendOptions.clone()})}};g([w({readOnly:!0})],Hh.prototype,"cache",null),g([w({type:["heading","tilt","roll"],json:{origins:{"web-scene":{default:"heading",write:!0}}}})],Hh.prototype,"axis",void 0),g([w({type:["rotation"],json:{type:["rotationInfo"]}})],Hh.prototype,"type",void 0),g([w({type:["geographic","arithmetic"],json:{write:!0,origins:{"web-document":{write:!0,default:"geographic"}}}})],Hh.prototype,"rotationType",void 0),g([w({type:String,json:{write:!0}})],Hh.prototype,"valueExpressionTitle",void 0),g([tt("web-scene","valueExpressionTitle")],Hh.prototype,"writeValueExpressionTitleWebScene",null),Hh=BA=g([te("esri.renderers.visualVariables.RotationVariable")],Hh);const _Z=Hh;var UA;let _1=UA=class extends ke{constructor(e){super(e),this.label=null,this.size=null,this.value=null}clone(){return new UA({label:this.label,size:this.size,value:this.value})}};g([w({type:String,json:{write:!0}})],_1.prototype,"label",void 0),g([w({type:Number,cast:Fi,json:{write:!0}})],_1.prototype,"size",void 0),g([w({type:Number,json:{write:!0}})],_1.prototype,"value",void 0),_1=UA=g([te("esri.renderers.visualVariables.support.SizeStop")],_1);const x1=_1;var qA;let sM=qA=class extends vZ{constructor(){super(...arguments),this.customValues=null}clone(){return new qA({title:this.title,showLegend:this.showLegend,customValues:this.customValues&&this.customValues.slice(0)})}};g([w({type:[Number],json:{write:!0}})],sM.prototype,"customValues",void 0),sM=qA=g([te("esri.renderers.visualVariables.support.SizeVariableLegendOptions")],sM);const xZ=sM;var Wh,us;function of(e){return e&&e.declaredClass==="esri.renderers.visualVariables.SizeVariable"}function p2(e){return e!=null&&!isNaN(e)&&isFinite(e)}function SZ(e){return e.valueExpression?Wh.Expression:e.field&&typeof e.field=="string"?Wh.Field:Wh.Unknown}function T4e(e,t){const i=t||SZ(e),r=e.valueUnit||"unknown";return i===Wh.Unknown?us.Constant:e.stops?us.Stops:e.minSize!=null&&e.maxSize!=null&&e.minDataValue!=null&&e.maxDataValue!=null?us.ClampedLinear:r==="unknown"?e.minSize!=null&&e.minDataValue!=null?e.minSize&&e.minDataValue?us.Proportional:us.Additive:us.Identity:us.RealWorldSize}(function(e){e.Unknown="unknown",e.Expression="expression",e.Field="field"})(Wh||(Wh={})),function(e){e.Unknown="unknown",e.Stops="stops",e.ClampedLinear="clamped-linear",e.Proportional="proportional",e.Additive="additive",e.Constant="constant",e.Identity="identity",e.RealWorldSize="real-world-size"}(us||(us={}));const oM={inches:ji(1,"meters","inches"),feet:ji(1,"meters","feet"),"us-feet":ji(1,"meters","us-feet"),yards:ji(1,"meters","yards"),miles:ji(1,"meters","miles"),"nautical-miles":ji(1,"meters","nautical-miles"),millimeters:ji(1,"meters","millimeters"),centimeters:ji(1,"meters","centimeters"),decimeters:ji(1,"meters","decimeters"),meters:ji(1,"meters","meters"),kilometers:ji(1,"meters","kilometers"),"decimal-degrees":1/GU(1,"meters",gr.radius)},af=$e.getLogger("esri.renderers.visualVariables.support.visualVariableUtils"),MZ=new Gr,aM=Math.PI,IZ=/^\s*(return\s+)?\$view\.scale\s*(;)?\s*$/i;function HA(e,t,i){const r="visualVariables"in e&&e.visualVariables?e.visualVariables.find(P=>P.type==="color"):e;if(!r)return;if(r.declaredClass!=="esri.renderers.visualVariables.ColorVariable")return void af.warn("The visualVariable should be an instance of esri.renderers.visualVariables.ColorVariable");const n=typeof t=="number",o=n?null:t,c=o&&o.attributes;let h=n?t:null;const m=r.field,{ipData:b,hasExpression:x}=r.cache;let I=r.cache.compiledFunc;if(!m&&!x){const P=r.stops;return P&&P[0]&&P[0].color}if(typeof h!="number")if(x){if(ce(i)||ce(i.arcade))return void af.error("Use of arcade expressions requires an arcade context");const P={viewingMode:i.viewingMode,scale:i.scale,spatialReference:i.spatialReference},F=i.arcade.arcadeUtils,N=F.getViewInfo(P),B=F.createExecContext(o,N);if(!I){const z=F.createSyntaxTree(r.valueExpression);I=F.createFunction(z),r.cache.compiledFunc=I}h=F.executeFunction(I,B)}else c&&(h=c[m]);const E=r.normalizationField,k=c!=null&&E!=null?parseFloat(c[E]):void 0;if(h!=null&&(!E||n||!isNaN(k)&&k!==0)){isNaN(k)||n||(h/=k);const P=ZA(h,b);if(P){const F=P[0],N=P[1],B=F===N?r.stops[F].color:ut.blendColors(r.stops[F].color,r.stops[N].color,P[2],H(i)?i.color:void 0);return new ut(B)}}}function WA(e,t,i){const r="visualVariables"in e&&e.visualVariables?e.visualVariables.find(P=>P.type==="opacity"):e;if(!r)return;if(r.declaredClass!=="esri.renderers.visualVariables.OpacityVariable")return void af.warn("The visualVariable should be an instance of esri.renderers.visualVariables.OpacityVariable");const n=typeof t=="number",o=n?null:t,c=o&&o.attributes;let h=n?t:null;const m=r.field,{ipData:b,hasExpression:x}=r.cache;let I=r.cache.compiledFunc;if(!m&&!x){const P=r.stops;return P&&P[0]&&P[0].opacity}if(typeof h!="number")if(x){if(ce(i)||ce(i.arcade))return void af.error("Use of arcade expressions requires an arcade context");const P={viewingMode:i.viewingMode,scale:i.scale,spatialReference:i.spatialReference},F=i.arcade.arcadeUtils,N=F.getViewInfo(P),B=F.createExecContext(o,N);if(!I){const z=F.createSyntaxTree(r.valueExpression);I=F.createFunction(z),r.cache.compiledFunc=I}h=F.executeFunction(I,B)}else c&&(h=c[m]);const E=r.normalizationField,k=c!=null&&E!=null?parseFloat(c[E]):void 0;if(h!=null&&(!E||n||!isNaN(k)&&k!==0)){isNaN(k)||n||(h/=k);const P=ZA(h,b);if(P){const F=P[0],N=P[1];if(F===N)return r.stops[F].opacity;{const B=r.stops[F].opacity;return B+(r.stops[N].opacity-B)*P[2]}}}}function JA(e,t,i){const r="visualVariables"in e&&e.visualVariables?e.visualVariables.find(k=>k.type==="rotation"):e;if(!r)return;if(r.declaredClass!=="esri.renderers.visualVariables.RotationVariable")return void af.warn("The visualVariable should be an instance of esri.renderers.visualVariables.RotationVariable");const n=r.axis||"heading",o=n==="heading"&&r.rotationType==="arithmetic"?90:0,c=n==="heading"&&r.rotationType==="arithmetic"?-1:1,h=typeof t=="number"?null:t,m=h&&h.attributes,b=r.field,{hasExpression:x}=r.cache;let I=r.cache.compiledFunc,E=0;if(!b&&!x)return E;if(x){if(ce(i)||ce(i.arcade))return void af.error("Use of arcade expressions requires an arcade context");const k={viewingMode:i.viewingMode,scale:i.scale,spatialReference:i.spatialReference},P=i.arcade.arcadeUtils,F=P.getViewInfo(k),N=P.createExecContext(h,F);if(!I){const B=P.createSyntaxTree(r.valueExpression);I=P.createFunction(B),r.cache.compiledFunc=I}E=P.executeFunction(I,N)}else m&&(E=m[b]||0);return E=typeof E!="number"||isNaN(E)?null:o+c*E,E}function C4e(e,t,i){const r=typeof t=="number",n=r?null:t,o=n&&n.attributes;let c=r?t:null;const{isScaleDriven:h}=e.cache;let m=e.cache.compiledFunc;if(h){const x=H(i)?i.scale:void 0,I=H(i)?i.view:void 0;c=x==null||I==="3d"?k4e(e):x}else if(!r)switch(e.inputValueType){case Wh.Expression:{if(ce(i)||ce(i.arcade))return void af.error("Use of arcade expressions requires an arcade context");const x={viewingMode:i.viewingMode,scale:i.scale,spatialReference:i.spatialReference},I=i.arcade.arcadeUtils,E=I.getViewInfo(x),k=I.createExecContext(n,E);if(!m){const P=I.createSyntaxTree(e.valueExpression);m=I.createFunction(P),e.cache.compiledFunc=m}c=I.executeFunction(m,k);break}case Wh.Field:o&&(c=o[e.field]);break;case Wh.Unknown:c=null}if(!p2(c))return null;if(r||!e.normalizationField)return c;const b=o?parseFloat(o[e.normalizationField]):null;return p2(b)&&b!==0?c/b:null}function k4e(e){let t=null,i=null;const r=e.stops;return r?(t=r[0].value,i=r[r.length-1].value):(t=e.minDataValue||0,i=e.maxDataValue||0),(t+i)/2}function d2(e,t,i){const r="visualVariables"in e&&e.visualVariables?e.visualVariables.find(o=>o.type==="size"):e;if(!r)return;if(r.declaredClass!=="esri.renderers.visualVariables.SizeVariable")return void af.warn("The visualVariable should be an instance of esri.renderers.visualVariables.SizeVariable");const n=EZ(C4e(r,t,i),r,t,i,r.cache.ipData);return n==null||isNaN(n)?0:n}function pa(e,t,i){return e==null?null:of(e)?d2(e,t,i):p2(e)?e:null}function $Z(e,t,i){return p2(i)&&e>i?i:p2(t)&&e<t?t:e}function A4e(e,t,i,r){var n;return e+((n=pa(t.minSize,i,r)||t.minDataValue)!=null?n:0)}function P4e(e,t,i){const r=e.stops;let n=r&&r.length&&r[0].size;return n==null&&(n=e.minSize),pa(n,t,i)}function L4e(e,t,i,r){const n=(e-t.minDataValue)/(t.maxDataValue-t.minDataValue),o=pa(t.minSize,i,r),c=pa(t.maxSize,i,r),h=H(r)?r.shape:void 0;if(e<=t.minDataValue)return o;if(e>=t.maxDataValue)return c;if(o==null||c==null)return null;if(t.scaleBy==="area"&&h){const m=h==="circle",b=m?aM*(o/2)**2:o*o,x=b+n*((m?aM*(c/2)**2:c*c)-b);return m?2*Math.sqrt(x/aM):Math.sqrt(x)}return o+n*(c-o)}function O4e(e,t,i,r){const n=H(r)?r.shape:void 0,o=e/t.minDataValue,c=pa(t.minSize,i,r),h=pa(t.maxSize,i,r);let m=null;return m=n==="circle"?2*Math.sqrt(o*(c/2)**2):n==="square"||n==="diamond"||n==="image"?Math.sqrt(o*c**2):o*c,$Z(m,c,h)}function R4e(e,t,i,r,n){var m,b,x;const[o,c,h]=ZA(e,n);if(o===c)return pa((m=t.stops)==null?void 0:m[o].size,i,r);{const I=pa((b=t.stops)==null?void 0:b[o].size,i,r);return I+(pa((x=t.stops)==null?void 0:x[c].size,i,r)-I)*h}}function F4e(e,t,i,r){const n=(H(r)&&r.resolution?r.resolution:1)*oM[t.valueUnit],o=pa(t.minSize,i,r),c=pa(t.maxSize,i,r),{valueRepresentation:h}=t;let m=null;return m=h==="area"?2*Math.sqrt(e/aM)/n:h==="radius"||h==="distance"?2*e/n:e/n,$Z(m,o,c)}function N4e(e){return e}function EZ(e,t,i,r,n){switch(t.transformationType){case us.Additive:return A4e(e,t,i,r);case us.Constant:return P4e(t,i,r);case us.ClampedLinear:return L4e(e,t,i,r);case us.Proportional:return O4e(e,t,i,r);case us.Stops:return R4e(e,t,i,r,n);case us.RealWorldSize:return F4e(e,t,i,r);case us.Identity:return N4e(e);case us.Unknown:return null}}function TZ(e,t,i){const{isScaleDriven:r}=e.cache;if(!(r&&i==="3d"||t))return null;const n={scale:t,view:i};let o=pa(e.minSize,MZ,n),c=pa(e.maxSize,MZ,n);if(o!=null||c!=null){if(o>c){const h=c;c=o,o=h}return{minSize:o,maxSize:c}}}function D4e(e,t,i){if(!e.visualVariables)return;const r=[],n=[],o=[],c=[],h=[];for(const m of e.visualVariables)switch(m.type){case"color":n.push(m);break;case"opacity":o.push(m);break;case"rotation":h.push(m);break;case"size":c.push(m)}return n.forEach(m=>{const b=HA(m,t,i);r.push({variable:m,value:b})}),o.forEach(m=>{const b=WA(m,t,i);r.push({variable:m,value:b})}),h.forEach(m=>{const b=JA(m,t,i);r.push({variable:m,value:b})}),c.forEach(m=>{const b=d2(m,t,i);r.push({variable:m,value:b})}),r.filter(m=>m.value!=null)}function ZA(e,t){if(!t)return;let i=0,r=t.length-1;return t.some((n,o)=>e<n?(r=o,!0):(i=o,!1)),[i,r,(e-t[i])/(t[r]-t[i])]}function j4e(e,t,i){const r=["proportional","proportional","proportional"];for(const n of e){const o=n.useSymbolValue?"symbol-value":d2(n,t,i);switch(n.axis){case"width":r[0]=o;break;case"depth":r[1]=o;break;case"height":r[2]=o;break;case"width-and-depth":r[0]=o,r[1]=o;break;case"all":case void 0:case null:r[0]=o,r[1]=o,r[2]=o;break;default:sU(n.axis)}}return r}var Ey=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",getAllSizes:j4e,getColor:HA,getOpacity:WA,getRotationAngle:JA,getSize:d2,getSizeForValue:EZ,getSizeFromNumberOrVariable:pa,getSizeRangeAtScale:TZ,getVisualVariableValues:D4e,viewScaleRE:IZ}),KA;const lM=new kt({width:"width",depth:"depth",height:"height",widthAndDepth:"width-and-depth",all:"all"}),YA=new kt({unknown:"unknown",inch:"inches",foot:"feet",yard:"yards",mile:"miles","nautical-mile":"nautical-miles",millimeter:"millimeters",centimeter:"centimeters",decimeter:"decimeters",meter:"meters",kilometer:"kilometers","decimal-degree":"decimal-degrees"});function CZ(e){if(e!=null)return typeof e=="string"||typeof e=="number"?Fi(e):e.type==="size"?of(e)?e:(delete(e=K({},e)).type,new Vi(e)):void 0}function kZ(e,t,i){if(typeof e!="object")return e;const r=new Vi;return r.read(e,i),r}let Vi=KA=class extends h2{constructor(e){super(e),this.axis=null,this.legendOptions=null,this.normalizationField=null,this.scaleBy=null,this.target=null,this.type="size",this.useSymbolValue=null,this.valueExpression=null,this.valueRepresentation=null,this.valueUnit=null}get cache(){return{ipData:this._interpolateData(),hasExpression:!!this.valueExpression,compiledFunc:null,isScaleDriven:this.valueExpression!=null&&IZ.test(this.valueExpression)}}set expression(e){$e.getLogger(this.declaredClass).warn("'expression' is deprecated since version 4.2. Use 'valueExpression' instead. The only supported expression is 'view.scale'."),e==="view.scale"?(this.valueExpression="$view.scale",this._set("expression",e)):this._set("expression",null)}set index(e){of(this.maxSize)&&(this.maxSize.index=`visualVariables[${e}].maxSize`),of(this.minSize)&&(this.minSize.index=`visualVariables[${e}].minSize`),this._set("index",e)}get inputValueType(){return SZ(this)}set maxDataValue(e){e&&this.stops&&($e.getLogger(this.declaredClass).warn("cannot set maxDataValue when stops is not null."),e=null),this._set("maxDataValue",e)}set maxSize(e){e&&this.stops&&($e.getLogger(this.declaredClass).warn("cannot set maxSize when stops is not null."),e=null),this._set("maxSize",e)}castMaxSize(e){return CZ(e)}readMaxSize(e,t,i){return kZ(e,t,i)}set minDataValue(e){e&&this.stops&&($e.getLogger(this.declaredClass).warn("cannot set minDataValue when stops is not null."),e=null),this._set("minDataValue",e)}set minSize(e){e&&this.stops&&($e.getLogger(this.declaredClass).warn("cannot set minSize when stops is not null."),e=null),this._set("minSize",e)}castMinSize(e){return CZ(e)}readMinSize(e,t,i){return kZ(e,t,i)}get arcadeRequired(){return!!this.valueExpression||this.minSize!=null&&typeof this.minSize=="object"&&this.minSize.arcadeRequired||this.maxSize!=null&&typeof this.maxSize=="object"&&this.maxSize.arcadeRequired}set stops(e){this.minDataValue==null&&this.maxDataValue==null&&this.minSize==null&&this.maxSize==null?e&&Array.isArray(e)&&(e=e.filter(t=>!!t)).sort((t,i)=>t.value-i.value):e&&($e.getLogger(this.declaredClass).warn("cannot set stops when one of minDataValue, maxDataValue, minSize or maxSize is not null."),e=null),this._set("stops",e)}get transformationType(){return T4e(this,this.inputValueType)}readValueExpression(e,t){return e||t.expression&&"$view.scale"}writeValueExpressionWebScene(e,t,i,r){if(e==="$view.scale"){if(r&&r.messages){const n=this.index,o=typeof n=="string"?n:`visualVariables[${n}]`;r.messages.push(new ue("property:unsupported",this.type+"VisualVariable.valueExpression = '$view.scale' is not supported in Web Scene. Please remove this property to save the Web Scene.",{instance:this,propertyName:o+".valueExpression",context:r}))}}else t[i]=e}readValueUnit(e){return e?YA.read(e):null}clone(){return new KA({axis:this.axis,field:this.field,valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle,maxDataValue:this.maxDataValue,maxSize:of(this.maxSize)?this.maxSize.clone():this.maxSize,minDataValue:this.minDataValue,minSize:of(this.minSize)?this.minSize.clone():this.minSize,normalizationField:this.normalizationField,stops:this.stops&&this.stops.map(e=>e.clone()),target:this.target,useSymbolValue:this.useSymbolValue,valueRepresentation:this.valueRepresentation,valueUnit:this.valueUnit,legendOptions:this.legendOptions&&this.legendOptions.clone()})}flipSizes(){if(this.transformationType===us.ClampedLinear){const{minSize:e,maxSize:t}=this;return this.minSize=t,this.maxSize=e,this}if(this.transformationType===us.Stops){const e=this.stops;if(!e)return this;const t=e.map(r=>r.size).reverse(),i=e.length;for(let r=0;r<i;r++)e[r].size=t[r];return this}return this}getAttributeHash(){return`${super.getAttributeHash()}-${this.target}-${this.normalizationField}`}_interpolateData(){return this.stops&&this.stops.map(e=>e.value||0)}};g([w({readOnly:!0})],Vi.prototype,"cache",null),g([w({type:lM.apiValues,json:{type:lM.jsonValues,origins:{"web-map":{read:!1}},read:lM.read,write:lM.write}})],Vi.prototype,"axis",void 0),g([w({type:String,value:null,json:{read:!1}})],Vi.prototype,"expression",null),g([w()],Vi.prototype,"index",null),g([w({type:String,readOnly:!0})],Vi.prototype,"inputValueType",null),g([w({type:xZ,json:{write:!0}})],Vi.prototype,"legendOptions",void 0),g([w({type:Number,value:null,json:{write:!0}})],Vi.prototype,"maxDataValue",null),g([w({type:Number,value:null,json:{write:!0}})],Vi.prototype,"maxSize",null),g([Dt("maxSize")],Vi.prototype,"castMaxSize",null),g([We("maxSize")],Vi.prototype,"readMaxSize",null),g([w({type:Number,value:null,json:{write:!0}})],Vi.prototype,"minDataValue",null),g([w({type:Number,value:null,json:{write:!0}})],Vi.prototype,"minSize",null),g([Dt("minSize")],Vi.prototype,"castMinSize",null),g([We("minSize")],Vi.prototype,"readMinSize",null),g([w({type:String,json:{write:!0}})],Vi.prototype,"normalizationField",void 0),g([w({readOnly:!0})],Vi.prototype,"arcadeRequired",null),g([w({type:String})],Vi.prototype,"scaleBy",void 0),g([w({type:[x1],value:null,json:{write:!0}})],Vi.prototype,"stops",null),g([w({type:["outline"],json:{write:!0}})],Vi.prototype,"target",void 0),g([w({type:String,readOnly:!0})],Vi.prototype,"transformationType",null),g([w({type:["size"],json:{type:["sizeInfo"]}})],Vi.prototype,"type",void 0),g([w({type:Boolean,json:{write:!0,origins:{"web-map":{read:!1}}}})],Vi.prototype,"useSymbolValue",void 0),g([w({type:String,json:{write:!0}})],Vi.prototype,"valueExpression",void 0),g([We("valueExpression",["valueExpression","expression"])],Vi.prototype,"readValueExpression",null),g([tt("web-scene","valueExpression")],Vi.prototype,"writeValueExpressionWebScene",null),g([w({type:["radius","diameter","area","width","distance"],json:{write:!0}})],Vi.prototype,"valueRepresentation",void 0),g([w({type:YA.apiValues,json:{write:YA.write,origins:{"web-map":{read:!1},"web-scene":{write:!0}}}})],Vi.prototype,"valueUnit",void 0),g([We("valueUnit")],Vi.prototype,"readValueUnit",null),Vi=KA=g([te("esri.renderers.visualVariables.SizeVariable")],Vi);const f2=Vi,V4e={color:bZ,size:f2,opacity:wZ,rotation:_Z},z4e=new kt({colorInfo:"color",transparencyInfo:"opacity",rotationInfo:"rotation",sizeInfo:"size"}),G4e=/^\[([^\]]+)\]$/i;let cM=class extends Ye{constructor(){super(...arguments),this.colorVariables=null,this.opacityVariables=null,this.rotationVariables=null,this.sizeVariables=null}set visualVariables(e){if(this._resetVariables(),(e=e&&e.filter(t=>!!t))&&e.length){for(const t of e)switch(t.type){case"color":this.colorVariables.push(t);break;case"opacity":this.opacityVariables.push(t);break;case"rotation":this.rotationVariables.push(t);break;case"size":this.sizeVariables.push(t)}this.sizeVariables.length&&this.sizeVariables.some(t=>!!t.target)&&e.sort((t,i)=>{let r=null;return r=t.target===i.target?0:t.target?1:-1,r});for(let t=0;t<e.length;t++)e[t].index=t;this._set("visualVariables",e)}else this._set("visualVariables",e)}readVariables(e,t,i){const{rotationExpression:r,rotationType:n}=t,o=r&&r.match(G4e),c=o&&o[1];if(c&&(e||(e=[]),e.push({type:"rotationInfo",rotationType:n,field:c})),e)return e.map(h=>{const m=z4e.read(h.type),b=V4e[m];b||($e.getLogger(this.declaredClass).warn(`Unknown variable type: ${m}`),i&&i.messages&&i.messages.push(new Io("visual-variable:unsupported",`visualVariable of type '${m}' is not supported`,{definition:h,context:i})));const x=new b;return x.read(h,i),x})}writeVariables(e,t){const i=[];for(const r of e){const n=r.toJSON(t);n&&i.push(n)}return i}_resetVariables(){this.colorVariables=[],this.opacityVariables=[],this.rotationVariables=[],this.sizeVariables=[]}};g([w()],cM.prototype,"visualVariables",null),cM=g([te("esri.renderers.visualVariables.VisualVariableFactory")],cM);const B4e=cM,U4e={base:h2,key:"type",typeMap:{opacity:wZ,color:bZ,rotation:_Z,size:f2}},S1=e=>{let t=class extends e{constructor(){super(...arguments),this._vvFactory=new B4e}set visualVariables(i){this._vvFactory.visualVariables=i,this._set("visualVariables",this._vvFactory.visualVariables)}readVisualVariables(i,r,n){return this._vvFactory.readVariables(i,r,n)}writeVisualVariables(i,r,n,o){r[n]=this._vvFactory.writeVariables(i,o)}get arcadeRequiredForVisualVariables(){if(!this.visualVariables)return!1;for(const i of this.visualVariables)if(i.arcadeRequired)return!0;return!1}hasVisualVariables(i,r){return i?this.getVisualVariablesForType(i,r).length>0:this.getVisualVariablesForType("size",r).length>0||this.getVisualVariablesForType("color",r).length>0||this.getVisualVariablesForType("opacity",r).length>0||this.getVisualVariablesForType("rotation",r).length>0}getVisualVariablesForType(i,r){const n=this.visualVariables;return n?n.filter(o=>o.type===i&&(typeof r=="string"?o.target===r:r!==!1||!o.target)):[]}async collectVVRequiredFields(i,r){let n=[];this.visualVariables&&(n=n.concat(this.visualVariables));for(const o of n)o&&(o.field&&Aa(i,r,o.field),o.normalizationField&&Aa(i,r,o.normalizationField),o.valueExpression&&(q4e(o.valueExpression,i,r)||await Co(i,r,o.valueExpression)))}};return g([w({types:[U4e],value:null,json:{write:!0}})],t.prototype,"visualVariables",null),g([We("visualVariables",["visualVariables","rotationType","rotationExpression"])],t.prototype,"readVisualVariables",null),g([tt("visualVariables")],t.prototype,"writeVisualVariables",null),t=g([te("esri.renderers.mixins.VisualVariablesMixin")],t),t};function q4e(e,t,i){const r=I4e(e);return!!H(r)&&(Aa(t,i,r),!0)}const M1={retainId:!1,ignoreDrivers:!1,hasLabelingContext:!0};function I1(e,t=M1){var h,m;if(!e)return{symbol:null};const{retainId:i=M1.retainId,ignoreDrivers:r=M1.ignoreDrivers,hasLabelingContext:n=M1.hasLabelingContext,retainCIM:o=M1.retainCIM}=t;let c=null;if(uc(e)||e instanceof Z0)c=e.clone();else if(e.type==="cim"){const b=(m=(h=e.data)==null?void 0:h.symbol)==null?void 0:m.type;if(b!=="CIMPointSymbol")return{error:new ue("symbol-conversion:unsupported-cim-symbol",`CIM symbol of type '${b||"unknown"}' is unsupported in 3D`,{symbol:e})};c=o?e.clone():H0.fromCIMSymbol(e)}else if(e instanceof rs)c=R5.fromSimpleLineSymbol(e);else if(e instanceof Dn)c=H0.fromSimpleMarkerSymbol(e);else if(e instanceof Og)c=H0.fromPictureMarkerSymbol(e);else if(e instanceof ea)c=t.geometryType&&t.geometryType==="mesh"?N5.fromSimpleFillSymbol(e):g_.fromSimpleFillSymbol(e);else{if(!(e instanceof J0))return{error:new ue("symbol-conversion:unsupported-2d-symbol",`2D symbol of type '${e.type||e.declaredClass}' is unsupported in 3D`,{symbol:e})};c=n?L5.fromTextSymbol(e):H0.fromTextSymbol(e)}if(i&&c&&c.type!=="cim"&&(c.id=e.id),r&&uc(c))for(let b=0;b<c.symbolLayers.length;++b)c.symbolLayers.getItemAt(b)._ignoreDrivers=!0;return{symbol:c}}const H4e=["building-scene","integrated-mesh","point-cloud","scene"];function uM(e,t,i,r){const n=LZ(e,{},{context:r,isLabelSymbol:!1});H(n)&&(t[i]=n)}function AZ(e,t,i,r){const n=LZ(e,{},{context:r,isLabelSymbol:!0});H(n)&&(t[i]=n)}function PZ(e){return e instanceof Pg||e instanceof Z0}function LZ(e,t,i){var m;if(ce(e))return null;const{context:r,isLabelSymbol:n}=i,o=r==null?void 0:r.origin,c=r==null?void 0:r.messages;if(o==="web-scene"&&!PZ(e)){const b=I1(e,{retainCIM:!0,hasLabelingContext:n});return H(b.symbol)?b.symbol.write(t,r):(c==null||c.push(new ue("symbol:unsupported",`Symbols of type '${e.declaredClass}' are not supported in scenes. Use 3D symbology instead when working with WebScene and SceneView`,{symbol:e,context:r,error:b.error})),null)}const h=(m=r==null?void 0:r.layer)==null?void 0:m.type;return o!=="web-map"&&(o!=="portal-item"||h&&H4e.includes(h))||!PZ(e)?e.write(t,r):(c==null||c.push(new ue("symbol:unsupported",`Symbols of type '${e.declaredClass}' are not supported in web maps and portal items. Use 2D symbology and CIMSymbol instead when working with MapView`,{symbol:e,context:r})),null)}function OZ(e,t){return Cwe(e,null,t)}const $1={types:j5,json:{write:{writer:uM},origins:{"web-scene":{types:JB,write:{writer:uM},read:{reader:ad({types:JB})}}}}},RZ={types:{base:Ao,key:"type",typeMap:{"simple-fill":ta.typeMap["simple-fill"],"picture-fill":ta.typeMap["picture-fill"],"polygon-3d":ta.typeMap["polygon-3d"]}},json:{write:{writer:uM},origins:{"web-scene":{type:g_,write:{writer:uM}}}}},hM={cast:e=>e==null||typeof e=="string"||typeof e=="number"?e:`${e}`,json:{type:String,write:{writer:(e,t)=>{t.value=e==null?void 0:e.toString()}}}};var XA;let lf=XA=class extends ke{constructor(e){super(e),this.description=null,this.label=null,this.minValue=null,this.maxValue=0,this.symbol=null}clone(){return new XA({description:this.description,label:this.label,minValue:this.minValue,maxValue:this.maxValue,symbol:this.symbol?this.symbol.clone():null})}getMeshHash(){const e=JSON.stringify(this.symbol);return`${this.minValue}.${this.maxValue}.${e}`}};g([w({type:String,json:{write:!0}})],lf.prototype,"description",void 0),g([w({type:String,json:{write:!0}})],lf.prototype,"label",void 0),g([w({type:Number,json:{read:{source:"classMinValue"},write:{target:"classMinValue"}}})],lf.prototype,"minValue",void 0),g([w({type:Number,json:{read:{source:"classMaxValue"},write:{target:"classMaxValue"}}})],lf.prototype,"maxValue",void 0),g([w($1)],lf.prototype,"symbol",void 0),lf=XA=g([te("esri.renderers.support.ClassBreakInfo")],lf);const pM=lf;var QA;const FZ="log",dM="percent-of-total",fM="field",yM=new kt({esriNormalizeByLog:FZ,esriNormalizeByPercentOfTotal:dM,esriNormalizeByField:fM}),W4e=Oi(pM);let Vn=QA=class extends S1(qh){constructor(e){super(e),this._compiledValueExpression={valueExpression:null,compiledFunction:null},this.backgroundFillSymbol=null,this.classBreakInfos=null,this.defaultLabel=null,this.defaultSymbol=null,this.field=null,this.isMaxInclusive=!0,this.legendOptions=null,this.normalizationField=null,this.normalizationTotal=null,this.type="class-breaks",this.valueExpression=null,this.valueExpressionTitle=null,this._set("classBreakInfos",[])}readClassBreakInfos(e,t,i){if(!Array.isArray(e))return;let r=t.minValue;return e.map(n=>{const o=new pM;return o.read(n,i),o.minValue==null&&(o.minValue=r),o.maxValue==null&&(o.maxValue=o.minValue),r=o.maxValue,o})}writeClassBreakInfos(e,t,i,r){const n=e.map(o=>o.write({},r));this._areClassBreaksConsecutive()&&n.forEach(o=>delete o.classMinValue),t[i]=n}castField(e){return e==null?e:typeof e=="function"?($e.getLogger(this.declaredClass).error(".field: field must be a string value"),null):Qb(e)}get minValue(){return this.classBreakInfos&&this.classBreakInfos[0]&&this.classBreakInfos[0].minValue||0}get normalizationType(){let e=this._get("normalizationType");const t=!!this.normalizationField,i=this.normalizationTotal!=null;return t||i?(e=t&&fM||i&&dM||null,t&&i&&$e.getLogger(this.declaredClass).warn("warning: both normalizationField and normalizationTotal are set!")):e!==fM&&e!==dM||(e=null),e}set normalizationType(e){this._set("normalizationType",e)}addClassBreakInfo(e,t,i){let r=null;r=typeof e=="number"?new pM({minValue:e,maxValue:t,symbol:ZB(i)}):W4e(_e(e)),this.classBreakInfos.push(r),this.classBreakInfos.length===1&&this.notifyChange("minValue")}removeClassBreakInfo(e,t){const i=this.classBreakInfos.length;for(let r=0;r<i;r++){const n=[this.classBreakInfos[r].minValue,this.classBreakInfos[r].maxValue];if(n[0]===e&&n[1]===t){this.classBreakInfos.splice(r,1);break}}}getBreakIndex(e,t){return this.valueExpression&&(ce(t)||ce(t.arcade))&&$e.getLogger(this.declaredClass).warn(""),this.valueExpression?this._getBreakIndexForExpression(e,t):this._getBreakIndexForField(e)}async getClassBreakInfo(e,t){let i=t;this.valueExpression&&(ce(t)||ce(t.arcade))&&(i=Ce(K({},i),{arcade:await ru()}));const r=this.getBreakIndex(e,i);return r!==-1?this.classBreakInfos[r]:null}getSymbol(e,t){if(this.valueExpression&&(ce(t)||ce(t.arcade)))return void $e.getLogger(this.declaredClass).error("#getSymbol()","Please use getSymbolAsync if valueExpression is used");const i=this.getBreakIndex(e,t);return i>-1?this.classBreakInfos[i].symbol:this.defaultSymbol}async getSymbolAsync(e,t){let i=t;if(this.valueExpression&&(ce(t)||ce(t.arcade))){const n=await ru(),{arcadeUtils:o}=n;o.hasGeometryOperations(this.valueExpression)&&await o.enableGeometryOperations(),i=Ce(K({},i),{arcade:n})}const r=this.getBreakIndex(e,i);return r>-1?this.classBreakInfos[r].symbol:this.defaultSymbol}getSymbols(){const e=[];return this.classBreakInfos.forEach(t=>{t.symbol&&e.push(t.symbol)}),this.defaultSymbol&&e.push(this.defaultSymbol),e}getAttributeHash(){return this.visualVariables&&this.visualVariables.reduce((e,t)=>e+t.getAttributeHash(),"")}getMeshHash(){const e=JSON.stringify(this.backgroundFillSymbol),t=JSON.stringify(this.defaultSymbol),i=`${this.normalizationField}.${this.normalizationType}.${this.normalizationTotal}`;return`${e}.${t}.${this.classBreakInfos.reduce((r,n)=>r+n.getMeshHash(),"")}.${i}.${this.field}.${this.valueExpression}`}get arcadeRequired(){return this.arcadeRequiredForVisualVariables||!!this.valueExpression}clone(){return new QA({field:this.field,backgroundFillSymbol:this.backgroundFillSymbol&&this.backgroundFillSymbol.clone(),defaultLabel:this.defaultLabel,defaultSymbol:this.defaultSymbol&&this.defaultSymbol.clone(),valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle,classBreakInfos:_e(this.classBreakInfos),isMaxInclusive:this.isMaxInclusive,normalizationField:this.normalizationField,normalizationTotal:this.normalizationTotal,normalizationType:this.normalizationType,visualVariables:_e(this.visualVariables),legendOptions:_e(this.legendOptions),authoringInfo:this.authoringInfo&&this.authoringInfo.clone()})}async collectRequiredFields(e,t){const i=[this.collectVVRequiredFields(e,t),this.collectSymbolFields(e,t)];await Promise.all(i)}async collectSymbolFields(e,t){const i=[...this.getSymbols().map(r=>r.collectRequiredFields(e,t)),Co(e,t,this.valueExpression)];Aa(e,t,this.field),Aa(e,t,this.normalizationField),await Promise.all(i)}_getBreakIndexForExpression(e,t){const{viewingMode:i,scale:r,spatialReference:n,arcade:o}=ws(t,{}),{valueExpression:c}=this;let h=this._compiledValueExpression.valueExpression===c?this._compiledValueExpression.compiledFunction:null;const m=Ht(o).arcadeUtils;if(!h){const x=m.createSyntaxTree(c);h=m.createFunction(x),this._compiledValueExpression.compiledFunction=h}this._compiledValueExpression.valueExpression=c;const b=m.executeFunction(h,m.createExecContext(e,m.getViewInfo({viewingMode:i,scale:r,spatialReference:n})));return this._getBreakIndexfromInfos(b)}_getBreakIndexForField(e){const t=this.field,i=e.attributes,r=this.normalizationType;let n=parseFloat(i[t]);if(r){const o=this.normalizationTotal,c=parseFloat(this.normalizationField?i[this.normalizationField]:void 0);if(r===FZ)n=Math.log(n)*Math.LOG10E;else if(r!==dM||o==null||isNaN(o)){if(r===fM&&!isNaN(c)){if(isNaN(n)||isNaN(c))return-1;n/=c}}else n=n/o*100}return this._getBreakIndexfromInfos(n)}_getBreakIndexfromInfos(e){const t=this.isMaxInclusive;if(e!=null&&typeof e=="number"&&!isNaN(e))for(let i=0;i<this.classBreakInfos.length;i++){const r=[this.classBreakInfos[i].minValue,this.classBreakInfos[i].maxValue];if(r[0]<=e&&(t?e<=r[1]:e<r[1]))return i}return-1}_areClassBreaksConsecutive(){const e=this.classBreakInfos,t=e.length;for(let i=1;i<t;i++)if(e[i-1].maxValue!==e[i].minValue)return!1;return!0}};g([w(RZ)],Vn.prototype,"backgroundFillSymbol",void 0),g([w({type:[pM]})],Vn.prototype,"classBreakInfos",void 0),g([We("classBreakInfos")],Vn.prototype,"readClassBreakInfos",null),g([tt("classBreakInfos")],Vn.prototype,"writeClassBreakInfos",null),g([w({type:String,json:{write:!0}})],Vn.prototype,"defaultLabel",void 0),g([w($1)],Vn.prototype,"defaultSymbol",void 0),g([w({type:String,json:{write:!0}})],Vn.prototype,"field",void 0),g([Dt("field")],Vn.prototype,"castField",null),g([w({type:Boolean})],Vn.prototype,"isMaxInclusive",void 0),g([w({type:w1,json:{write:!0}})],Vn.prototype,"legendOptions",void 0),g([w({type:Number,readOnly:!0,value:null,json:{read:!1,write:{overridePolicy(){return this.classBreakInfos.length!==0&&this._areClassBreaksConsecutive()?{enabled:!0}:{enabled:!1}}}}})],Vn.prototype,"minValue",null),g([w({type:String,json:{write:!0}})],Vn.prototype,"normalizationField",void 0),g([w({type:Number,cast:e=>hl(e),json:{write:!0}})],Vn.prototype,"normalizationTotal",void 0),g([w({type:yM.apiValues,value:null,json:{type:yM.jsonValues,read:yM.read,write:yM.write}})],Vn.prototype,"normalizationType",null),g([Pt({classBreaks:"class-breaks"})],Vn.prototype,"type",void 0),g([w({type:String,json:{write:!0}})],Vn.prototype,"valueExpression",void 0),g([w({type:String,json:{write:!0}})],Vn.prototype,"valueExpressionTitle",void 0),Vn=QA=g([te("esri.renderers.ClassBreaksRenderer")],Vn);const NZ=Vn;class DZ{constructor(t,i){this._storage=new NW,this._storage.maxSize=t,i&&this._storage.registerRemoveFunc("",i)}put(t,i,r){this._storage.put(t,i,r,1)}pop(t){return this._storage.pop(t)}get(t){return this._storage.get(t)}clear(){this._storage.clearAll()}destroy(){this._storage.destroy()}get maxSize(){return this._storage.maxSize}set maxSize(t){this._storage.maxSize=t}}const jZ="esri.renderers.support.DictionaryLoader",J4e={type:"CIMSimpleLineCallout",lineSymbol:{type:"CIMLineSymbol",symbolLayers:[{type:"CIMSolidStroke",width:.5,color:[0,0,0,255]}]}};class e8{constructor(t,i,r){this.config=null,this.fieldMap=null,this.url=null,this._ongoingRequests=new Map,this._symbolCache=new DZ(100),this._dictionaryPromise=null,this.url=t,this.config=i,this.fieldMap=r}getSymbolFields(){return this._symbolFields}async getSymbolAsync(t,i){let r;this._dictionaryPromise||(this._dictionaryPromise=this.fetchResources(i));try{r=await this._dictionaryPromise}catch(k){if(Xn(k))return this._dictionaryPromise=null,null}const n={};if(this.fieldMap)for(const k of this._symbolFields){const P=this.fieldMap[k];if(P&&t.attributes[P]!=null){const F=""+t.attributes[P];n[k]=F}else n[k]=""}const o=r==null?void 0:r(n,i);if(!o||typeof o!="string")return null;const c=qE(o).toString(),h=this._symbolCache.get(c);if(h)return h.catch(()=>{this._symbolCache.pop(c)}),h;const m=o.split(";"),b=[],x=[];for(const k of m)if(k)if(k.includes("po:")){const P=k.substr(3).split("|");if(P.length===3){const F=P[0],N=P[1];let B=P[2];if(N==="DashTemplate")B=B.split(" ").map(z=>Number(z));else if(N==="Color"){const z=new ut(B).toRgba();B=[z[0],z[1],z[2],255*z[3]]}else B=Number(B);x.push({primitiveName:F,propertyName:N,value:B})}}else if(k.includes("|")){for(const P of k.split("|"))if(this._itemNames.has(P)){b.push(P);break}}else this._itemNames.has(k)&&b.push(k);const I=!H(t.geometry)||!t.geometry.hasZ&&t.geometry.type==="point",E=this._cimPartsToCIMSymbol(b,x,I,i);return this._symbolCache.put(c,E,1),E}async fetchResources(t){if(this._dictionaryPromise)return this._dictionaryPromise;if(!this.url)return void $e.getLogger(jZ).error("no valid URL!");const i=Nt(this.url+"/resources/styles/dictionary-info.json",{responseType:"json",query:{f:"json"},signal:H(t)?t.signal:null}),[{data:r}]=await Promise.all([i,ru()]);if(!r)throw this._dictionaryPromise=null,new ue("esri.renderers.DictionaryRenderer","Bad dictionary data!");const n=r.expression,o=r.authoringInfo;this._refSymbolUrlTemplate=this.url+"/"+r.cimRefTemplateUrl,this._itemNames=new Set(r.itemsNames),this._symbolFields=o.symbol;const c={};if(this.config){const b=this.config;for(const x in b)c[x]=b[x]}if(o.configuration)for(const b of o.configuration)c.hasOwnProperty(b.name)||(c[b.name]=b.value);const h=[];if(H(t)&&t.fields&&this.fieldMap)for(const b of this._symbolFields){const x=this.fieldMap[b],I=t.fields.filter(E=>E.name===x);I.length>0&&h.push(Ce(K({},I[0]),{name:b}))}const m=Tge(n,H(t)?t.spatialReference:null,h,c).then(b=>{const x={scale:0};return(I,E)=>{if(ce(b))return null;const k=b.repurposeFeature({geometry:null,attributes:I});return x.scale=H(E)?E.scale:void 0,b.evaluate({$feature:k,$view:x})}}).catch(b=>($e.getLogger(jZ).error("Creating dictinoary expression failed:",b),null));return this._dictionaryPromise=m,m}async _cimPartsToCIMSymbol(t,i,r,n){const o=new Array(t.length);for(let m=0;m<t.length;m++)o[m]=this._getSymbolPart(t[m],n);const c=await Promise.all(o),h=this.fieldMap;if(h)for(const m of c)VZ(m,h);return new Id({data:this._combineSymbolParts(c,i,r)})}async _getSymbolPart(t,i){if(this._ongoingRequests.has(t))return this._ongoingRequests.get(t).then(o=>o.data);const r=this._refSymbolUrlTemplate.replace(/\{itemName\}/gi,t),n=Nt(r,K({responseType:"json",query:{f:"json"}},i));this._ongoingRequests.set(t,n);try{return(await n).data}catch(o){throw this._ongoingRequests.delete(t),o}}_combineSymbolParts(t,i,r){if(!t||t.length===0)return null;const n=K({},t[0]);if(t.length>1){n.symbolLayers=[];for(const o of t){const c=o;n.symbolLayers.unshift(...c.symbolLayers)}}return r&&(n.callout=J4e),{type:"CIMSymbolReference",symbol:n,primitiveOverrides:i}}}function VZ(e,t){if(!e)return;const i=e.symbolLayers;if(!i)return;let r=i.length;for(;r--;){const n=i[r];n&&n.enable!==!1&&n.type==="CIMVectorMarker"&&Z4e(n,t)}}function Z4e(e,t){const i=e.markerGraphics;if(i)for(const r of i){if(!r)continue;const n=r.symbol;if(n)switch(n.type){case"CIMPointSymbol":case"CIMLineSymbol":case"CIMPolygonSymbol":VZ(n,t);break;case"CIMTextSymbol":n.fieldMap=t}}}var XZe=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",DictionaryLoader:e8}),t8;let xc=t8=class extends S1(qh){constructor(e){super(e),this.config=null,this.fieldMap=null,this.scaleExpression=null,this.scaleExpressionTitle=null,this.url=null,this.type="dictionary"}get _loader(){return new e8(this.url,this.config,this.fieldMap)}writeData(e,t){e&&(t.scalingExpressionInfo={expression:e,returnType:"number"})}writeVisualVariables(e,t,i,r){(r==null?void 0:r.origin)||super.writeVisualVariables(e,t,i,r)}clone(){return new t8({config:_e(this.config),scaleExpression:this.scaleExpression,scaleExpressionTitle:this.scaleExpressionTitle,fieldMap:_e(this.fieldMap),url:_e(this.url),visualVariables:_e(this.visualVariables)})}async getSymbolAsync(e,t){return this._loader.getSymbolAsync(e,t)}async collectRequiredFields(e,t){await this.collectVVRequiredFields(e,t),this.scaleExpression&&await Co(e,t,this.scaleExpression);for(const i in this.fieldMap){const r=this.fieldMap[i];t.has(r)&&e.add(r)}}get arcadeRequired(){return!0}getSymbol(){return null}getSymbols(){return[]}getAttributeHash(){return this.visualVariables&&this.visualVariables.reduce((e,t)=>e+t.getAttributeHash(),"")}getMeshHash(){return`${this.url}-${JSON.stringify(this.fieldMap)}`}getSymbolFields(){return this._loader.getSymbolFields()}};g([w({type:e8})],xc.prototype,"_loader",null),g([w({type:Object,json:{read:{source:"configuration"},write:{target:"configuration"}}})],xc.prototype,"config",void 0),g([w({type:Object,json:{write:!0}})],xc.prototype,"fieldMap",void 0),g([w({type:String,json:{read:{source:"scalingExpressionInfo.expression"},write:!0}})],xc.prototype,"scaleExpression",void 0),g([tt("scaleExpression")],xc.prototype,"writeData",null),g([w({type:String,json:{read:{source:"scalingExpressionInfo.title"},write:{target:"scalingExpressionInfo.title",overridePolicy(e){return{enabled:!!e&&!!this.scaleExpression}}}}})],xc.prototype,"scaleExpressionTitle",void 0),g([w({type:String,json:{write:!0}})],xc.prototype,"url",void 0),g([tt("visualVariables")],xc.prototype,"writeVisualVariables",null),xc=t8=g([te("esri.renderers.DictionaryRenderer")],xc);const K4e=xc;var i8;let Jh=i8=class extends ke{constructor(e){super(e),this.color=null,this.field=null,this.label=null,this.valueExpression=null,this.valueExpressionTitle=null}castField(e){return e==null?e:typeof e=="function"?($e.getLogger(this.declaredClass).error(".field: field must be a string value"),null):Qb(e)}getAttributeHash(){return`${this.field}-${this.valueExpression}`}clone(){return new i8({color:this.color&&this.color.clone(),field:this.field,label:this.label,valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle})}};g([w({type:ut,json:{type:[Number],write:!0}})],Jh.prototype,"color",void 0),g([w({type:String,json:{write:!0}})],Jh.prototype,"field",void 0),g([Dt("field")],Jh.prototype,"castField",null),g([w({type:String,json:{write:!0}})],Jh.prototype,"label",void 0),g([w({type:String,json:{write:!0}})],Jh.prototype,"valueExpression",void 0),g([w({type:String,json:{write:!0}})],Jh.prototype,"valueExpressionTitle",void 0),Jh=i8=g([te("esri.renderers.support.AttributeColorInfo")],Jh);const zZ=Jh;var r8;let mM=r8=class extends ke{constructor(){super(...arguments),this.unit=null}clone(){return new r8({unit:this.unit})}};g([w({type:String,json:{write:!0}})],mM.prototype,"unit",void 0),mM=r8=g([te("esri.renderers.support.DotDensityLegendOptions")],mM);const Y4e=mM;var n8;let da=n8=class extends S1(qh){constructor(e){super(e),this.attributes=null,this.backgroundColor=new ut([0,0,0,0]),this.dotBlendingEnabled=!0,this.dotShape="square",this.dotSize=1,this.legendOptions=null,this.outline=new rs,this.dotValue=null,this.referenceScale=null,this.seed=1,this.type="dot-density"}calculateDotValue(e){if(this.referenceScale==null)return this.dotValue;const t=e/this.referenceScale*this.dotValue;return t<1?1:t}getSymbol(){return new ea({outline:this.outline})}async getSymbolAsync(){return this.getSymbol()}getSymbols(){return[this.getSymbol()]}getAttributeHash(){var e,t;return(t=(e=this.attributes)==null?void 0:e.reduce((i,r)=>i+r.getAttributeHash(),""))!=null?t:""}getMeshHash(){return JSON.stringify(this.outline)}clone(){return new n8({attributes:_e(this.attributes),backgroundColor:_e(this.backgroundColor),dotBlendingEnabled:_e(this.dotBlendingEnabled),dotShape:_e(this.dotShape),dotSize:_e(this.dotSize),dotValue:_e(this.dotValue),legendOptions:_e(this.legendOptions),outline:_e(this.outline),referenceScale:_e(this.referenceScale),visualVariables:_e(this.visualVariables),authoringInfo:this.authoringInfo&&this.authoringInfo.clone()})}getControllerHash(){var t;return`${(t=this.attributes)==null?void 0:t.map(i=>i.field||i.valueExpression||"")}-${this.outline&&JSON.stringify(this.outline.toJSON())||""}`}async collectRequiredFields(e,t){var i;await this.collectVVRequiredFields(e,t);for(const r of(i=this.attributes)!=null?i:[])r.valueExpression&&await Co(e,t,r.valueExpression),r.field&&e.add(r.field)}};g([w({type:[zZ],json:{write:!0}})],da.prototype,"attributes",void 0),g([w({type:ut,json:{write:!0}})],da.prototype,"backgroundColor",void 0),g([w({type:Boolean,json:{write:!0}})],da.prototype,"dotBlendingEnabled",void 0),g([w({type:String,json:{write:!1}})],da.prototype,"dotShape",void 0),g([w({type:Number,json:{write:!0}})],da.prototype,"dotSize",void 0),g([w({type:Y4e,json:{write:!0}})],da.prototype,"legendOptions",void 0),g([w({type:rs,json:{default:null,write:!0}})],da.prototype,"outline",void 0),g([w({type:Number,json:{write:!0}})],da.prototype,"dotValue",void 0),g([w({type:Number,json:{write:!0}})],da.prototype,"referenceScale",void 0),g([w({type:Number,json:{write:!0}})],da.prototype,"seed",void 0),g([Pt({dotDensity:"dot-density"})],da.prototype,"type",void 0),da=n8=g([te("esri.renderers.DotDensityRenderer")],da);const X4e=da;let E1=class extends rn(ke){constructor(){super(...arguments),this.minLabel=null,this.maxLabel=null,this.title=null}};g([w({type:String,json:{write:!0}})],E1.prototype,"minLabel",void 0),g([w({type:String,json:{write:!0}})],E1.prototype,"maxLabel",void 0),g([w({type:String,json:{write:!0}})],E1.prototype,"title",void 0),E1=g([te("esri.renderers.support.HeatmapLegendOptions")],E1);function T1(){return[0,0,0,0]}function Q4e(e){return[e[0],e[1],e[2],e[3]]}function Sc(e,t,i,r){return[e,t,i,r]}function GZ(e){const t=T1(),i=Math.min(4,e.length);for(let r=0;r<i;++r)t[r]=e[r];return t}function BZ(e,t){return new Float64Array(e,t,4)}function UZ(){return T1()}function qZ(){return Sc(1,1,1,1)}function HZ(){return Sc(1,0,0,0)}function WZ(){return Sc(0,1,0,0)}function JZ(){return Sc(0,0,1,0)}function ZZ(){return Sc(0,0,0,1)}const e$e=UZ(),t$e=qZ(),i$e=HZ(),r$e=WZ(),n$e=JZ(),s$e=ZZ();Object.freeze(Object.defineProperty({__proto__:null,create:T1,clone:Q4e,fromValues:Sc,fromArray:GZ,createView:BZ,zeros:UZ,ones:qZ,unitX:HZ,unitY:WZ,unitZ:JZ,unitW:ZZ,ZEROS:e$e,ONES:t$e,UNIT_X:i$e,UNIT_Y:r$e,UNIT_Z:n$e,UNIT_W:s$e},Symbol.toStringTag,{value:"Module"}));const s8=2.4;function o$e(e){return $n(e*s8)}function a$e(e){return or(e)/s8}function l$e(e,t,i,r){let{color:n,ratio:o}=t,{color:c,ratio:h}=i;if(h===o){const b=1e-6;h===1?o-=b:h+=b}const m=Vs((r-o)/(h-o),0,1);l5(e,n.toArray(),c.toArray(),m)}function QZe(e){const t=512,i=new Uint8ClampedArray(4*t);if(e=e.filter(({ratio:h})=>h>=0&&h<=1).sort((h,m)=>h.ratio-m.ratio).map(({color:h,ratio:m})=>({color:h,ratio:Math.max(m,.001)})),e.length<1)return i;let r=e[0],n=e[0],o=1;const c=T1();for(let h=0;h<t;h++){const m=(h+.5)/t;for(;m>n.ratio&&o<e.length;)r=n,n=e[o++];l$e(c,r,n,m),i.set(c,4*h)}return i}function eKe(e,t,i,r){const{radius:n,fieldOffset:o,field:c}=t,h=Math.round(or(n)),m=new Float64Array(i*r);let b,x=Number.NEGATIVE_INFINITY;const I=h$e(c,o),E=new Set;for(const k of e){const P=k.getCursor();for(;P.next();){const F=P.getObjectId();if(E.has(F))continue;E.add(F);const N=P.readLegacyPointGeometry(),B=128;if(N.x<-B||N.x>=i+B||N.y<-B||N.y>r+B)continue;const z=+I(P),q=Math.max(0,Math.round(N.x)-h),J=Math.max(0,Math.round(N.y)-h),X=Math.min(r,Math.round(N.y)+h),Y=Math.min(i,Math.round(N.x)+h);for(let ae=J;ae<X;ae++)for(let he=q;he<Y;he++){const fe=ae*i+he,ye=u$e(N.x-he,N.y-ae,h);b=m[fe]+=ye*z,b>x&&(x=b)}}}return{matrix:m.buffer,max:x}}function tKe(e,t,i,r,n,o){e.canvas.width=e.canvas.height=t,e.clearRect(0,0,t,t);const c=e.getImageData(0,0,t,t);i&&r&&c.data.set(new Uint8ClampedArray(c$e(t,i,r,n,o))),e.putImageData(c,0,0)}function c$e(e,t,i,r,n){const o=new Uint32Array(e*e),c="buffer"in t?t:new Float64Array(t),h="buffer"in i?new Uint32Array(i.buffer):new Uint32Array(new Uint8Array(i).buffer),m=h.length/(n-r);for(let b=0;b<c.length;b++){const x=c[b],I=Math.floor((x-r)*m);o[b]=h[Vs(I,0,h.length-1)]}return o.buffer}function u$e(e,t,i){const r=Math.sqrt(e**2+t**2)/i;return r>1?0:3/(Math.PI*i**2)*(1-r**2)**2}function iKe(e,t){return typeof e=="function"?e:e?typeof t=="string"?i=>-1*+i[e]:i=>+i[e]+t:()=>1}function h$e(e,t){return e!=null?typeof t=="string"?i=>-1*+i.readAttribute(e):i=>+i.readAttribute(e)+t:i=>1}var o8;const KZ="esri.renderers.HeatmapRenderer",p$e=$e.getLogger(KZ);function YZ(e){if(e!=null){const{maxDensity:i,minDensity:r,radius:n}=e;if(i!=null||r!=null||n!=null){const t=e,{blurRadius:o,maxPixelIntensity:c,minPixelIntensity:h}=t;return Sx(t,["blurRadius","maxPixelIntensity","minPixelIntensity"])}}return e}let hs=o8=class extends qh{constructor(e){super(e),this.authoringInfo=null,this.colorStops=[new Y_({ratio:0,color:new ut("rgba(255, 140, 0, 0)")}),new Y_({ratio:.75,color:new ut("rgba(255, 140, 0, 1)")}),new Y_({ratio:.9,color:new ut("rgba(255, 0,   0, 1)")})],this.field=null,this.fieldOffset=0,this.legendOptions=null,this.maxDensity=.04,this.minDensity=0,this.radius=18,this.referenceScale=0,this.type="heatmap",this.valueExpression=null,this.valueExpressionTitle=null,this._warnedProps={blurRadius:!1,maxPixelIntensity:!1,minPixelIntensity:!1}}normalizeCtorArgs(e){return YZ(e)}get blurRadius(){return a$e(this.radius)}set blurRadius(e){const t=this.maxPixelIntensity,i=this.minPixelIntensity;this._set("radius",o$e(e)),this._warnAboutDeprecatedGaussianBlurProp("blurRadius","radius"),this._set("maxDensity",t*this._pixelIntensityToDensity),this._set("minDensity",i*this._pixelIntensityToDensity)}get maxPixelIntensity(){return this.maxDensity/this._pixelIntensityToDensity}set maxPixelIntensity(e){this._set("maxDensity",e*this._pixelIntensityToDensity),this._warnAboutDeprecatedGaussianBlurProp("maxPixelIntensity","maxDensity")}get minPixelIntensity(){return this.minDensity/this._pixelIntensityToDensity}set minPixelIntensity(e){this._set("minDensity",e*this._pixelIntensityToDensity),this._warnAboutDeprecatedGaussianBlurProp("minPixelIntensity","minDensity")}get _pixelIntensityToDensity(){return 24/(s8**2*this.blurRadius**4)}_warnAboutDeprecatedGaussianBlurProp(e,t){this._warnedProps[e]||Rn(this).getDefaultOrigin()==="user"&&(this._warnedProps[e]=!0,eg(()=>{Bye(p$e,e,{replacement:`${String(t)} (suggested value: ${this._get(t)})`,version:"4.24"})}))}read(e,t){e=YZ(e),super.read(e,t)}getSymbol(){return new Dn}async getSymbolAsync(){return this.getSymbol()}getSymbols(){return[this.getSymbol()]}async collectRequiredFields(e,t){const i=this.field,r=this.valueExpression;i&&typeof i=="string"&&await Aa(e,t,i),r&&typeof r=="string"&&await Co(e,t,r)}getAttributeHash(){return null}getMeshHash(){return`${JSON.stringify(this.colorStops)}.${this.blurRadius}.${this.field}`}clone(){return new o8({authoringInfo:this.authoringInfo&&this.authoringInfo.clone(),colorStops:_e(this.colorStops),field:this.field,legendOptions:_e(this.legendOptions),maxDensity:this.maxDensity,minDensity:this.minDensity,radius:this.radius,referenceScale:this.referenceScale,valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle})}};g([w({type:RA,json:{write:!0,origins:{"web-scene":{write:!1,read:!1}}}})],hs.prototype,"authoringInfo",void 0),g([w({type:Number,json:{origins:{"portal-item":{write:!0},"web-map":{write:!0}}}})],hs.prototype,"blurRadius",null),g([w({type:[Y_],json:{write:!0}})],hs.prototype,"colorStops",void 0),g([w({type:String,json:{write:!0}})],hs.prototype,"field",void 0),g([w({type:Number,json:{write:{overridePolicy:(e,t,i)=>({enabled:i==null})},origins:{"web-scene":{write:!1}}}})],hs.prototype,"fieldOffset",void 0),g([w({type:E1,json:{write:!0}})],hs.prototype,"legendOptions",void 0),g([w({type:Number,json:{write:!0}})],hs.prototype,"maxDensity",void 0),g([w({type:Number,json:{origins:{"portal-item":{write:!0},"web-map":{write:!0}}}})],hs.prototype,"maxPixelIntensity",null),g([w({type:Number,json:{write:!0}})],hs.prototype,"minDensity",void 0),g([w({type:Number,json:{origins:{"portal-item":{write:!0},"web-map":{write:!0}}}})],hs.prototype,"minPixelIntensity",null),g([w({type:Number,cast:Fi,json:{write:!0}})],hs.prototype,"radius",void 0),g([w({type:Number,range:{min:0},json:{default:0,write:!0}})],hs.prototype,"referenceScale",void 0),g([Pt({heatmap:"heatmap"})],hs.prototype,"type",void 0),g([w({type:String,json:{write:!0,origins:{"web-document":{write:!1},"portal-item":{write:!1}}}})],hs.prototype,"valueExpression",void 0),g([w({type:String})],hs.prototype,"valueExpressionTitle",void 0),g([w({readOnly:!0})],hs.prototype,"_pixelIntensityToDensity",null),hs=o8=g([te(KZ)],hs);const XZ=hs;let Ty=class extends rn(ke){constructor(){super(...arguments),this.color=new ut([0,0,0,0]),this.label=null,this.threshold=0}};g([w({type:ut,json:{write:!0}})],Ty.prototype,"color",void 0),g([w({type:String,json:{write:!0}})],Ty.prototype,"label",void 0),g([w({type:Number,range:{min:0,max:1},json:{write:!0}})],Ty.prototype,"threshold",void 0),Ty=g([te("esri.renderers.support.OthersCategory")],Ty);let gM=class extends rn(ke){constructor(){super(...arguments),this.title=null}};g([w({type:String,json:{write:!0}})],gM.prototype,"title",void 0),gM=g([te("esri.renderers.support.PieChartLegendOptions")],gM);let Ha=class extends S1(rn(qh)){constructor(e){super(e),this.attributes=null,this.backgroundFillSymbol=null,this.defaultColor=new ut([0,0,0,0]),this.defaultLabel=null,this.holePercentage=0,this.othersCategory=new Ty,this.legendOptions=null,this.outline=null,this.size=12,this.type="pie-chart"}getSymbol(){var e;return new Dn({size:this.size?this.size/2+(((e=this.outline)==null?void 0:e.width)||0):0})}async getSymbolAsync(){return this.getSymbol()}getSymbols(){return[this.getSymbol(),this.backgroundFillSymbol].filter(H)}getAttributeHash(){return this.visualVariables&&this.visualVariables.reduce((e,t)=>e+t.getAttributeHash(),"")}getMeshHash(){return this.getSymbols().reduce((e,t)=>e+JSON.stringify(t),"")}async collectRequiredFields(e,t){await this.collectVVRequiredFields(e,t);for(const i of this.attributes)i.valueExpression&&await Co(e,t,i.valueExpression),i.field&&e.add(i.field)}};g([w({type:[zZ],json:{write:!0}})],Ha.prototype,"attributes",void 0),g([w({type:ea,json:{default:null,write:!0}})],Ha.prototype,"backgroundFillSymbol",void 0),g([w({type:ut,json:{write:!0}})],Ha.prototype,"defaultColor",void 0),g([w({type:String,json:{write:!0}})],Ha.prototype,"defaultLabel",void 0),g([w({type:Number,range:{min:0,max:1},json:{write:!0}})],Ha.prototype,"holePercentage",void 0),g([w({type:Ty,json:{write:!0}})],Ha.prototype,"othersCategory",void 0),g([w({type:gM,json:{write:!0}})],Ha.prototype,"legendOptions",void 0),g([w({type:rs,json:{default:null,write:!0}})],Ha.prototype,"outline",void 0),g([w({type:Number,cast:Fi,json:{write:!0}})],Ha.prototype,"size",void 0),g([Pt({pieChart:"pie-chart"})],Ha.prototype,"type",void 0),Ha=g([te("esri.renderers.PieChartRenderer")],Ha);const d$e=Ha;var a8;let Cy=a8=class extends S1(qh){constructor(e){super(e),this.description=null,this.label=null,this.symbol=null,this.type="simple"}async collectRequiredFields(e,t){await Promise.all([this.collectSymbolFields(e,t),this.collectVVRequiredFields(e,t)])}async collectSymbolFields(e,t){await Promise.all(this.getSymbols().map(i=>i.collectRequiredFields(e,t)))}getSymbol(e,t){return this.symbol}async getSymbolAsync(e,t){return this.symbol}getSymbols(){return this.symbol?[this.symbol]:[]}getAttributeHash(){return this.visualVariables&&this.visualVariables.reduce((e,t)=>e+t.getAttributeHash(),"")}getMeshHash(){return this.getSymbols().reduce((e,t)=>e+JSON.stringify(t),"")}get arcadeRequired(){return this.arcadeRequiredForVisualVariables}clone(){return new a8({description:this.description,label:this.label,symbol:this.symbol&&this.symbol.clone(),visualVariables:_e(this.visualVariables),authoringInfo:this.authoringInfo&&this.authoringInfo.clone()})}};g([w({type:String,json:{write:!0}})],Cy.prototype,"description",void 0),g([w({type:String,json:{write:!0}})],Cy.prototype,"label",void 0),g([w($1)],Cy.prototype,"symbol",void 0),g([Pt({simple:"simple"})],Cy.prototype,"type",void 0),Cy=a8=g([te("esri.renderers.SimpleRenderer")],Cy);const C1=Cy,f$e=["esri.Color","esri.portal.Portal","esri.symbols.support.Symbol3DAnchorPosition2D","esri.symbols.support.Symbol3DAnchorPosition3D"];function l8(e){return e instanceof Ye}function QZ(e){return e instanceof Xe?Object.keys(e.items):l8(e)?Rn(e).keys():e?Object.keys(e):[]}function vM(e,t){return e instanceof Xe?e.items[t]:e[t]}function y$e(e,t){return!(!Array.isArray(e)||!Array.isArray(t))&&e.length!==t.length}function y2(e){return e?e.declaredClass:null}function eK(e,t){const i=e.diff;if(i&&typeof i=="function")return i(e,t);const r=QZ(e),n=QZ(t);if(r.length===0&&n.length===0)return;if(!r.length||!n.length||y$e(e,t))return{type:"complete",oldValue:e,newValue:t};const o=n.filter(I=>!r.includes(I)),c=r.filter(I=>!n.includes(I)),h=r.filter(I=>n.includes(I)&&vM(e,I)!==vM(t,I)).concat(o,c).sort(),m=y2(e);if(m&&f$e.includes(m)&&h.length)return{type:"complete",oldValue:e,newValue:t};let b;const x=l8(e)&&l8(t);for(const I of h){const E=vM(e,I),k=vM(t,I);let P;if((x||typeof E!="function"&&typeof k!="function")&&E!==k&&(E!=null||k!=null)){if(i&&i[I]&&typeof i[I]=="function")P=i[I](E,k);else if(E instanceof Date&&k instanceof Date){if(E.getTime()===k.getTime())continue;P={type:"complete",oldValue:E,newValue:k}}else P=typeof E=="object"&&typeof k=="object"&&y2(E)===y2(k)?eK(E,k):{type:"complete",oldValue:E,newValue:k};H(P)&&(H(b)?b.diff[I]=P:b={type:"partial",diff:{[I]:P}})}}return b}function m$e(e,t){if(ce(e))return!1;const i=t.split(".");let r=e;for(const n of i){if(r.type==="complete")return!0;if(r.type!=="partial")return!1;{const o=r.diff[n];if(!o)return!1;r=o}}return!0}function rKe(e,t){for(const i of t)if(m$e(e,i))return!0;return!1}function g$e(e,t){if(!(typeof e=="function"||typeof t=="function"||ce(e)&&ce(t)))return ce(e)||ce(t)||typeof e=="object"&&typeof t=="object"&&y2(e)!==y2(t)?{type:"complete",oldValue:e,newValue:t}:eK(e,t)}function bM(e){if(ce(e))return!0;switch(e.type){case"complete":return!1;case"collection":{const t=e;for(const i of t.added)if(!bM(i))return!1;for(const i of t.removed)if(!bM(i))return!1;for(const i of t.changed)if(!bM(i))return!1;return!0}case"partial":for(const t in e.diff)if(!bM(e.diff[t]))return!1;return!0}}let k1=class extends rn(ke){constructor(e){super(e),this.value=null,this.value2=null,this.value3=null}};g([w(hM)],k1.prototype,"value",void 0),g([w(hM)],k1.prototype,"value2",void 0),g([w(hM)],k1.prototype,"value3",void 0),k1=g([te("esri.renderers.support.UniqueValue")],k1);const A1=k1;let cf=class extends rn(ke){constructor(e){super(e),this.description=null,this.label=null,this.symbol=null,this.values=null}castValues(e){if(e==null)return null;const t=typeof(e=Array.isArray(e)?e:[e])[0];return t==="string"||t==="number"?e.map(i=>new A1({value:i})):t==="object"?e[0]instanceof A1?e:e.map(i=>new A1(i)):null}};g([w({type:String,json:{write:!0}})],cf.prototype,"description",void 0),g([w({type:String,json:{write:!0}})],cf.prototype,"label",void 0),g([w($1)],cf.prototype,"symbol",void 0),g([w({type:[A1],json:{type:[[String]],read:{reader:e=>e?e.map(t=>new A1({value:t[0],value2:t[1],value3:t[2]})):null},write:{writer:(e,t)=>{const i=[];for(const r of e){const n=[r.value,r.value2,r.value3].filter(H).map(o=>o.toString());i.push(n)}t.values=i}}}})],cf.prototype,"values",void 0),g([Dt("values")],cf.prototype,"castValues",null),cf=g([te("esri.renderers.support.UniqueValueClass")],cf);const tK=cf;let m2=class extends rn(ke){constructor(e){super(e),this.heading=null,this.classes=null}};g([w({type:String,json:{write:!0}})],m2.prototype,"heading",void 0),g([w({type:[tK],json:{write:!0}})],m2.prototype,"classes",void 0),m2=g([te("esri.renderers.support.UniqueValueGroup")],m2);const c8=m2;var u8;let ky=u8=class extends ke{constructor(e){super(e),this.description=null,this.label=null,this.symbol=null,this.value=null}clone(){return new u8({value:this.value,description:this.description,label:this.label,symbol:this.symbol?this.symbol.clone():null})}getMeshHash(){const e=JSON.stringify(this.symbol&&this.symbol.toJSON());return`${this.value}.${e}`}};g([w({type:String,json:{write:!0}})],ky.prototype,"description",void 0),g([w({type:String,json:{write:!0}})],ky.prototype,"label",void 0),g([w($1)],ky.prototype,"symbol",void 0),g([w(hM)],ky.prototype,"value",void 0),ky=u8=g([te("esri.renderers.support.UniqueValueInfo")],ky);const g2=ky,v$e=()=>!!Te("enable-feature:force-wosr"),nKe=()=>!!Te("enable-feature:SceneLayer-editing"),h8={};async function b$e(e,t){try{return{data:(await p8(e,t)).data,baseUrl:vC(e),styleUrl:e}}catch(i){return f0(i),null}}function w$e(e,t,i){const r=H(t.portal)?t.portal:nn.getDefault();let n;const o=`${r.url} - ${r.user&&r.user.username} - ${e}`;return h8[o]||(h8[o]=_$e(e,r,i).then(c=>(n=c,c.fetchData())).then(c=>{var h;return{data:c,baseUrl:(h=n.itemUrl)!=null?h:"",styleName:e}})),h8[o]}function _$e(e,t,i){return t.load(i).then(()=>{const r=new $h({disableExtraQuery:!0,query:`owner:${nK} AND type:${sK} AND typekeywords:"${e}"`});return t.queryItems(r,i)}).then(({results:r})=>{var c;let n=null;const o=e.toLowerCase();if(r&&Array.isArray(r)){for(const h of r)if(((c=h.typeKeywords)==null?void 0:c.some(b=>b.toLowerCase()===o))&&h.type===sK&&h.owner===nK){n=h;break}}if(!n)throw new ue("symbolstyleutils:style-not-found",`The style '${e}' could not be found`,{styleName:e});return n.load(i)})}function iK(e,t,i){return e&&H(e.styleUrl)?b$e(e.styleUrl,i):e&&H(e.styleName)?w$e(e.styleName,t,i):Promise.reject(new ue("symbolstyleutils:style-url-and-name-missing","Either styleUrl or styleName is required to resolve a style"))}function rK(e){return e===null||e.type==="CIMSymbolReference"?e:{type:"CIMSymbolReference",symbol:e}}function x$e(e,t){if(t==="cimRef")return e.cimRef;if(e.formatInfos&&!v$e()){for(const i of e.formatInfos)if(i.type==="gltf")return i.href}return e.webRef}function p8(e,t){const i=K({responseType:"json",query:{f:"json"}},t);return Nt(zs(e),i)}const nK="esri_en",sK="Style",S$e="https://cdn.arcgis.com/sharing/rest/content/items/220936cc6ed342c9937abd8f180e7d1e/resources/styles/cim/{SymbolName}.json?f=json";var v2;const oK="esri.renderers.UniqueValueRenderer",uf=$e.getLogger(oK),aK="uvInfos-watcher",lK="uvGroups-watcher",M$e=",",I$e=Oi(g2);function $$e(e){const{field1:t,field2:i,field3:r,fieldDelimiter:n,uniqueValueInfos:o,valueExpression:c}=e,h=!(!t||!i);return[{classes:(o!=null?o:[]).map(m=>{var B;const{symbol:b,label:x,value:I,description:E}=m,[k,P,F]=h?((B=I==null?void 0:I.toString())==null?void 0:B.split(n||""))||[]:[I],N=[];return(t||c)&&N.push(k),i&&N.push(P),r&&N.push(F),{symbol:b,label:x,values:[N],description:E}})}]}let qr=v2=class extends S1(qh){constructor(e){super(e),this._valueInfoMap={},this._isDefaultSymbolDerived=!1,this._isInfosSource=null,this.type="unique-value",this.backgroundFillSymbol=null,this.valueExpressionTitle=null,this.legendOptions=null,this.defaultLabel=null,this.portal=null,this.styleOrigin=null,this.diff={uniqueValueInfos(t,i){if(!t&&!i)return;if(!t||!i)return{type:"complete",oldValue:t,newValue:i};let r=!1;const n={type:"collection",added:[],removed:[],changed:[],unchanged:[]};for(let o=0;o<i.length;o++){const c=t.find(h=>h.value===i[o].value);c?g$e(c,i[o])?(n.changed.push({type:"complete",oldValue:c,newValue:i[o]}),r=!0):n.unchanged.push({oldValue:c,newValue:i[o]}):(n.added.push(i[o]),r=!0)}for(let o=0;o<t.length;o++)i.find(c=>c.value===t[o].value)||(n.removed.push(t[o]),r=!0);return r?n:void 0}},this._set("uniqueValueInfos",[]),this._set("uniqueValueGroups",[])}get _cache(){return{compiledFunc:null}}set field(e){this._set("field",e),this._updateFieldDelimiter(),this._updateUniqueValues()}castField(e){return e==null||typeof e=="function"?e:Qb(e)}writeField(e,t,i,r){typeof e=="string"?t[i]=e:r&&r.messages?r.messages.push(new ue("property:unsupported","UniqueValueRenderer.field set to a function cannot be written to JSON")):uf.error(".field: cannot write field to JSON since it's not a string value")}set field2(e){this._set("field2",e),this._updateFieldDelimiter(),this._updateUniqueValues()}set field3(e){this._set("field3",e),this._updateUniqueValues()}set valueExpression(e){this._set("valueExpression",e),this._updateUniqueValues()}set defaultSymbol(e){this._isDefaultSymbolDerived=!1,this._set("defaultSymbol",e)}set fieldDelimiter(e){this._set("fieldDelimiter",e),this._updateUniqueValues()}readPortal(e,t,i){return i.portal||nn.getDefault()}readStyleOrigin(e,t,i){if(t.styleName)return Object.freeze({styleName:t.styleName});if(t.styleUrl){const r=kd(t.styleUrl,i);return Object.freeze({styleUrl:r})}}writeStyleOrigin(e,t,i,r){e.styleName?t.styleName=e.styleName:e.styleUrl&&(t.styleUrl=r_(e.styleUrl,r))}set uniqueValueGroups(e){this.styleOrigin?uf.error("#uniqueValueGroups=","Cannot modify unique value groups of a UniqueValueRenderer created from a web style"):(this._set("uniqueValueGroups",e),this._updateInfosFromGroups(),this._isInfosSource=!1,this._watchUniqueValueGroups())}set uniqueValueInfos(e){this.styleOrigin?uf.error("#uniqueValueInfos=","Cannot modify unique value infos of a UniqueValueRenderer created from a web style"):(this._set("uniqueValueInfos",e),this._updateValueInfoMap(),this._updateGroupsFromInfos(),this._isInfosSource=!0,this._watchUniqueValueInfos())}addUniqueValueInfo(e,t){var r;if(this.styleOrigin)return void uf.error("#addUniqueValueInfo()","Cannot modify unique value infos of a UniqueValueRenderer created from a web style");let i;i=typeof e=="object"?I$e(e):new g2({value:e,symbol:ZB(t)}),(r=this.uniqueValueInfos)==null||r.push(i),this._valueInfoMap[i.value]=i,this._updateGroupsFromInfos(),this._isInfosSource=!0,this._watchUniqueValueInfos()}removeUniqueValueInfo(e){if(this.styleOrigin)return void uf.error("#removeUniqueValueInfo()","Cannot modify unique value infos of a UniqueValueRenderer created from a web style");const t=this.uniqueValueInfos;if(t){for(let i=0;i<t.length;i++)if(t[i].value===e+""){delete this._valueInfoMap[e],t.splice(i,1);break}}this._updateGroupsFromInfos(),this._isInfosSource=!0,this._watchUniqueValueInfos()}async getUniqueValueInfo(e,t){let i=t;return this.valueExpression&&(ce(t)||ce(t.arcade))&&(i=Ce(K({},i),{arcade:await ru()})),this._getUniqueValueInfo(e,i)}getSymbol(e,t){if(this.valueExpression&&(ce(t)||ce(t.arcade)))return void uf.error("#getSymbol()","Please use getSymbolAsync if valueExpression is used");const i=this._getUniqueValueInfo(e,t);return i&&i.symbol||this.defaultSymbol}async getSymbolAsync(e,t){let i=t;if(this.valueExpression&&(ce(i)||ce(i.arcade))){const n=await ru(),{arcadeUtils:o}=n;o.hasGeometryOperations(this.valueExpression)&&await o.enableGeometryOperations(),i=Ce(K({},i),{arcade:n})}const r=this._getUniqueValueInfo(e,i);return r&&r.symbol||this.defaultSymbol}getSymbols(){var t;const e=[];for(const i of(t=this.uniqueValueInfos)!=null?t:[])i.symbol&&e.push(i.symbol);return this.defaultSymbol&&e.push(this.defaultSymbol),e}getAttributeHash(){return this.visualVariables&&this.visualVariables.reduce((e,t)=>e+t.getAttributeHash(),"")}getMeshHash(){var r;const e=JSON.stringify(this.backgroundFillSymbol),t=JSON.stringify(this.defaultSymbol),i=(r=this.uniqueValueInfos)==null?void 0:r.reduce((n,o)=>n+o.getMeshHash(),"");return`${e}.${t}.${i}.${`${this.field}.${this.field2}.${this.field3}.${this.fieldDelimiter}`}.${this.valueExpression}`}clone(){const e=new v2({field:this.field,field2:this.field2,field3:this.field3,defaultLabel:this.defaultLabel,defaultSymbol:_e(this.defaultSymbol),valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle,fieldDelimiter:this.fieldDelimiter,visualVariables:_e(this.visualVariables),legendOptions:_e(this.legendOptions),authoringInfo:this.authoringInfo&&this.authoringInfo.clone(),backgroundFillSymbol:_e(this.backgroundFillSymbol)});this._isDefaultSymbolDerived&&(e._isDefaultSymbolDerived=!0),e._set("portal",this.portal);const t=_e(this.uniqueValueInfos),i=_e(this.uniqueValueGroups);return this.styleOrigin&&(e._set("styleOrigin",Object.freeze(_e(this.styleOrigin))),Object.freeze(t),Object.freeze(i)),e._set("uniqueValueInfos",t),e._updateValueInfoMap(),e._set("uniqueValueGroups",i),e._isInfosSource=this._isInfosSource,e._watchUniqueValueInfosAndGroups(),e}get arcadeRequired(){return this.arcadeRequiredForVisualVariables||!!this.valueExpression}async collectRequiredFields(e,t){const i=[this.collectVVRequiredFields(e,t),this.collectSymbolFields(e,t)];await Promise.all(i)}async collectSymbolFields(e,t){const i=[...this.getSymbols().map(r=>r.collectRequiredFields(e,t)),Co(e,t,this.valueExpression)];Aa(e,t,this.field),Aa(e,t,this.field2),Aa(e,t,this.field3),await Promise.all(i)}populateFromStyle(){return iK(this.styleOrigin,{portal:this.portal}).then(e=>{var i;const t=[];return this._valueInfoMap={},e&&e.data&&Array.isArray(e.data.items)&&e.data.items.forEach(r=>{const n=new Z0({styleUrl:e.styleUrl,styleName:e.styleName,portal:this.portal,name:r.name});this.defaultSymbol||r.name!==e.data.defaultItem||(this.defaultSymbol=n,this._isDefaultSymbolDerived=!0);const o=new g2({value:r.name,symbol:n});t.push(o),this._valueInfoMap[r.name]=o}),this._set("uniqueValueInfos",Object.freeze(t)),this._updateGroupsFromInfos(!0),this._isInfosSource=null,this._watchUniqueValueInfos(),!this.defaultSymbol&&((i=this.uniqueValueInfos)==null?void 0:i.length)&&(this.defaultSymbol=this.uniqueValueInfos[0].symbol,this._isDefaultSymbolDerived=!0),this})}_updateFieldDelimiter(){this.field&&this.field2&&!this.fieldDelimiter&&this._set("fieldDelimiter",M$e)}_updateUniqueValues(){this._isInfosSource!=null&&(this._isInfosSource?this._updateGroupsFromInfos():this._updateInfosFromGroups())}_updateValueInfoMap(){this._valueInfoMap={};const{uniqueValueInfos:e}=this;if(e)for(const t of e)this._valueInfoMap[t.value+""]=t}_watchUniqueValueInfosAndGroups(){this._watchUniqueValueInfos(),this._watchUniqueValueGroups()}_watchUniqueValueInfos(){this.removeHandles(aK);const{uniqueValueInfos:e}=this;if(e){const t=[];for(const i of e)t.push(we(()=>({symbol:i.symbol,value:i.value,label:i.label,description:i.description}),(r,n)=>{r!==n&&(this._updateGroupsFromInfos(),this._isInfosSource=!0)},{sync:!0}));this.addHandles(t,aK)}}_watchUniqueValueGroups(){this.removeHandles(lK);const{uniqueValueGroups:e}=this;if(e){const t=[];for(const i of e){t.push(we(()=>({classes:i.classes}),(r,n)=>{r!==n&&(this._updateInfosFromGroups(),this._isInfosSource=!1)},{sync:!0}));for(const r of i.classes)t.push(we(()=>({symbol:r.symbol,values:r.values,label:r.label,description:r.description}),(n,o)=>{n!==o&&(this._updateInfosFromGroups(),this._isInfosSource=!1)},{sync:!0}))}this.addHandles(t,lK)}}_updateInfosFromGroups(){var m;if(!this.uniqueValueGroups)return this._set("uniqueValueInfos",null),this._updateValueInfoMap(),void this._watchUniqueValueInfos();const e=[],{field:t,field2:i,field3:r,fieldDelimiter:n,uniqueValueGroups:o,valueExpression:c}=this;if(!t&&!c)return this._set("uniqueValueInfos",e),this._updateValueInfoMap(),void this._watchUniqueValueInfos();const h=!(!t||!i);for(const b of o)for(const x of(m=b.classes)!=null?m:[]){const{symbol:I,label:E,values:k,description:P}=x;for(const F of k!=null?k:[]){const{value:N,value2:B,value3:z}=F,q=[N];i&&q.push(B),r&&q.push(z);const J=h?q.join(n||""):q[0];e.push(new g2({symbol:I,label:E,value:J,description:P}))}}this._set("uniqueValueInfos",e),this._updateValueInfoMap(),this._watchUniqueValueInfos()}_updateGroupsFromInfos(e=!1){if(!this.uniqueValueInfos)return this._set("uniqueValueGroups",null),void this._watchUniqueValueGroups();const{field:t,field2:i,valueExpression:r,fieldDelimiter:n,uniqueValueInfos:o}=this;if(!t&&!r||!o.length)return this._set("uniqueValueGroups",[]),void this._watchUniqueValueGroups();const c=!(!t||!i),h=o.map(b=>{var B;const{symbol:x,label:I,value:E,description:k}=b,[P,F,N]=c?((B=E==null?void 0:E.toString())==null?void 0:B.split(n||""))||[]:[E];return new tK({symbol:x,label:I,description:k,values:[new A1({value:P,value2:F,value3:N})]})}),m=[new c8({classes:h})];e&&Object.freeze(m),this._set("uniqueValueGroups",m),this._watchUniqueValueGroups()}_getUniqueValueInfo(e,t){return this.valueExpression?this._getUnqiueValueInfoForExpression(e,t):this._getUnqiueValueInfoForFields(e)}_getUnqiueValueInfoForExpression(e,t){const{viewingMode:i,scale:r,spatialReference:n,arcade:o}=ws(t,{});let c=this._cache.compiledFunc;const h=Ht(o).arcadeUtils;if(!c){const b=h.createSyntaxTree(this.valueExpression);c=h.createFunction(b),this._cache.compiledFunc=c}const m=h.executeFunction(c,h.createExecContext(e,h.getViewInfo({viewingMode:i,scale:r,spatialReference:n})));return this._valueInfoMap[m+""]}_getUnqiueValueInfoForFields(e){const t=this.field,i=e.attributes;let r;if(typeof t!="function"&&this.field2){const n=this.field2,o=this.field3,c=[];t&&c.push(i[t]),n&&c.push(i[n]),o&&c.push(i[o]),r=c.join(this.fieldDelimiter||"")}else typeof t=="function"?r=t(e):t&&(r=i[t]);return this._valueInfoMap[r+""]}static fromPortalStyle(e,t){const i=new v2(t&&t.properties);i._set("styleOrigin",Object.freeze({styleName:e})),i._set("portal",t&&t.portal||nn.getDefault());const r=i.populateFromStyle();return r.catch(n=>{uf.error(`#fromPortalStyle('${e}'[, ...])`,"Failed to create unique value renderer from style name",n)}),r}static fromStyleUrl(e,t){const i=new v2(t&&t.properties);i._set("styleOrigin",Object.freeze({styleUrl:e}));const r=i.populateFromStyle();return r.catch(n=>{uf.error(`#fromStyleUrl('${e}'[, ...])`,"Failed to create unique value renderer from style URL",n)}),r}};g([w({readOnly:!0})],qr.prototype,"_cache",null),g([Pt({uniqueValue:"unique-value"})],qr.prototype,"type",void 0),g([w(RZ)],qr.prototype,"backgroundFillSymbol",void 0),g([w({value:null,json:{type:String,read:{source:"field1"},write:{target:"field1"}}})],qr.prototype,"field",null),g([Dt("field")],qr.prototype,"castField",null),g([tt("field")],qr.prototype,"writeField",null),g([w({type:String,value:null,json:{write:!0}})],qr.prototype,"field2",null),g([w({type:String,value:null,json:{write:!0}})],qr.prototype,"field3",null),g([w({type:String,value:null,json:{write:!0}})],qr.prototype,"valueExpression",null),g([w({type:String,json:{write:!0}})],qr.prototype,"valueExpressionTitle",void 0),g([w({type:w1,json:{write:!0}})],qr.prototype,"legendOptions",void 0),g([w({type:String,json:{write:!0}})],qr.prototype,"defaultLabel",void 0),g([w(Nj(K({},$1),{json:{write:{overridePolicy(){return{enabled:!this._isDefaultSymbolDerived}}},origins:{"web-scene":{write:{overridePolicy(){return{enabled:!this._isDefaultSymbolDerived}}}}}}}))],qr.prototype,"defaultSymbol",null),g([w({type:String,value:null,json:{write:!0}})],qr.prototype,"fieldDelimiter",null),g([w({type:nn,readOnly:!0})],qr.prototype,"portal",void 0),g([We("portal",["styleName"])],qr.prototype,"readPortal",null),g([w({readOnly:!0,json:{write:{enabled:!1,overridePolicy:()=>({enabled:!0})}}})],qr.prototype,"styleOrigin",void 0),g([We("styleOrigin",["styleName","styleUrl"])],qr.prototype,"readStyleOrigin",null),g([tt("styleOrigin",{styleName:{type:String},styleUrl:{type:String}})],qr.prototype,"writeStyleOrigin",null),g([w({type:[c8],json:{read:{source:["uniqueValueGroups","uniqueValueInfos"],reader:(e,t,i)=>(t.uniqueValueGroups||$$e(t)).map(r=>c8.fromJSON(r,i))},write:{overridePolicy(){return this.styleOrigin?{enabled:!1}:{enabled:!0}}}}})],qr.prototype,"uniqueValueGroups",null),g([w({type:[g2],json:{read:!1,write:{overridePolicy(){return this.styleOrigin?{enabled:!1}:{enabled:!0}}}}})],qr.prototype,"uniqueValueInfos",null),qr=v2=g([te(oK)],qr);const b2=qr,w2={key:"type",base:qh,typeMap:{heatmap:XZ,simple:C1,"unique-value":b2,"class-breaks":NZ,"dot-density":X4e,dictionary:K4e,"pie-chart":d$e},errorContext:"renderer"},cK={key:"type",base:qh,typeMap:{simple:C1,"unique-value":b2,"class-breaks":NZ,heatmap:XZ},errorContext:"renderer"};function E$e(e,t){return _2(e,null,t)}const T$e=ad({types:w2});function _2(e,t,i){return e?e&&(e.styleName||e.styleUrl)&&e.type!=="uniqueValue"?(i&&i.messages&&i.messages.push(new Io("renderer:unsupported","Only UniqueValueRenderer can be referenced from a web style, but found '"+e.type+"'",{definition:e,context:i})),null):T$e(e,t,i):null}class d8{constructor(){this._propertyOriginMap=new Map,this._originStores=new Array(sT),this._values=new Map,this.multipleOriginsSupported=!0}clone(t){const i=new d8,r=this._originStores[ct.DEFAULTS];r&&r.forEach((n,o)=>{i.set(o,_e(n),ct.DEFAULTS)});for(let n=ct.SERVICE;n<sT;n++){const o=this._originStores[n];o&&o.forEach((c,h)=>{t&&t.has(h)||i.set(h,_e(c),n)})}return i}get(t,i){const r=i===void 0?this._values:this._originStores[i];return r?r.get(t):void 0}keys(t){const i=t==null?this._values:this._originStores[t];return i?[...i.keys()]:[]}set(t,i,r=ct.USER){let n=this._originStores[r];if(n||(n=new Map,this._originStores[r]=n),n.set(t,i),!this._values.has(t)||On(this._propertyOriginMap.get(t))<=r){const o=this._values.get(t);return this._values.set(t,i),this._propertyOriginMap.set(t,r),o!==i}return!1}delete(t,i=ct.USER){const r=this._originStores[i];if(!r)return;const n=r.get(t);if(r.delete(t),this._values.has(t)&&this._propertyOriginMap.get(t)===i){this._values.delete(t);for(let o=i-1;o>=0;o--){const c=this._originStores[o];if(c&&c.has(t)){this._values.set(t,c.get(t)),this._propertyOriginMap.set(t,o);break}}}return n}has(t,i){const r=i===void 0?this._values:this._originStores[i];return!!r&&r.has(t)}revert(t,i){for(;i>0&&!this.has(t,i);)--i;const r=this._originStores[i],n=r&&r.get(t),o=this._values.get(t);return this._values.set(t,n),this._propertyOriginMap.set(t,i),o!==n}originOf(t){return this._propertyOriginMap.get(t)||ct.DEFAULTS}forEach(t){this._values.forEach(t)}}const uK=e=>{let t=class extends e{constructor(...i){super(...i);const r=On(Rn(this)),n=r.store,o=new d8;r.store=o,HV(r,n,o)}read(i,r){JV(this,i,r)}getAtOrigin(i,r){const n=f8(this),o=qo(r);if(typeof i=="string")return n.get(i,o);const c={};return i.forEach(h=>{c[h]=n.get(h,o)}),c}originOf(i){return ow(this.originIdOf(i))}originIdOf(i){return f8(this).originOf(i)}revert(i,r){const n=f8(this),o=qo(r),c=Rn(this);let h;h=typeof i=="string"?i==="*"?n.keys(o):[i]:i,h.forEach(m=>{c.invalidate(m),n.revert(m,o),c.commit(m)})}};return t=g([te("esri.core.ReadOnlyMultiOriginJSONSupport")],t),t};function f8(e){return Rn(e).store}let hK=class extends uK(Ye){};hK=g([te("esri.core.ReadOnlyMultiOriginJSONSupport")],hK);const C$e=e=>{let t=class extends e{constructor(...i){super(...i)}clear(i,r="user"){return y8(this).delete(i,qo(r))}write(i={},r){return KV(this,i=i||{},r),i}setAtOrigin(i,r,n){Rn(this).setAtOrigin(i,r,qo(n))}removeOrigin(i){const r=y8(this),n=qo(i),o=r.keys(n);for(const c of o)r.originOf(c)===n&&r.set(c,r.get(c,n),ct.USER)}updateOrigin(i,r){const n=y8(this),o=qo(r),c=this.get(i);for(let h=o+1;h<sT;++h)n.delete(i,h);n.set(i,c,o)}toJSON(i){return this.write({},i)}};return t=g([te("esri.core.WriteableMultiOriginJSONSupport")],t),t.prototype.toJSON.isDefaultToJSON=!0,t};function y8(e){return Rn(e).store}const x2=e=>{let t=class extends C$e(uK(e)){constructor(...i){super(...i)}};return t=g([te("esri.core.MultiOriginJSONSupport")],t),t};let pK=class extends x2(Ye){};pK=g([te("esri.core.MultiOriginJSONSupport")],pK);async function k$e(e,t){const{WhereClause:i}=await Promise.resolve().then(function(){return fre});return i.create(e,t)}function wM(e,t){return H(e)?H(t)?`(${e}) AND (${t})`:e:t}var m8;let Ay=m8=class extends ke{constructor(e){super(e),this.expression=null,this.name=null,this.returnType="boolean",this.title=null}clone(){return new m8({name:this.name,title:this.title,expression:this.expression,returnType:this.returnType})}};g([w({type:String,json:{write:!0}})],Ay.prototype,"expression",void 0),g([w({type:String,json:{write:!0}})],Ay.prototype,"name",void 0),g([w({type:["boolean","date","number","string"],json:{write:!0}})],Ay.prototype,"returnType",void 0),g([w({type:String,json:{write:!0}})],Ay.prototype,"title",void 0),Ay=m8=g([te("esri.form.ExpressionInfo")],Ay);const A$e=Ay;let Py=class extends ke{constructor(e){super(e),this.description=null,this.label=null,this.type=null,this.visibilityExpression=null}};g([w({type:String,json:{write:!0}})],Py.prototype,"description",void 0),g([w({type:String,json:{write:!0}})],Py.prototype,"label",void 0),g([w()],Py.prototype,"type",void 0),g([w({type:String,json:{write:!0}})],Py.prototype,"visibilityExpression",void 0),Py=g([te("esri.form.elements.Element")],Py);const P1=Py;var g8;let _M=g8=class extends ke{constructor(e){super(e),this.type=null}clone(){return new g8({type:this.type})}};g([w({type:["attachment","audio","document","image","signature","video"],json:{write:!0}})],_M.prototype,"type",void 0),_M=g8=g([te("esri.form.elements.inputs.AttachmentInput")],_M);const P$e=_M;var v8;let Ly=v8=class extends P1{constructor(e){super(e),this.attachmentKeyword=null,this.editable=!0,this.input=null,this.type="attachment"}clone(){return new v8({attachmentKeyword:this.attachmentKeyword,description:this.description,editable:this.editable,input:this.input,label:this.label,visibilityExpression:this.visibilityExpression})}};g([w({type:String,json:{write:!0}})],Ly.prototype,"attachmentKeyword",void 0),g([w({type:Boolean,json:{write:!0}})],Ly.prototype,"editable",void 0),g([w({type:P$e,json:{read:{source:"inputType"},write:{target:"inputType"}}})],Ly.prototype,"input",void 0),g([w({type:["attachment"],json:{read:!1,write:!0}})],Ly.prototype,"type",void 0),Ly=v8=g([te("esri.form.elements.AttachmentElement")],Ly);const dK=Ly;let xM=class extends ke{constructor(e){super(e),this.type=null}};g([w()],xM.prototype,"type",void 0),xM=g([te("esri.form.elements.inputs.Input")],xM);const L1=xM;let S2=class extends L1{constructor(e){super(e),this.maxLength=null,this.minLength=0}};g([w({type:Number,json:{write:!0}})],S2.prototype,"maxLength",void 0),g([w({type:Number,json:{write:!0}})],S2.prototype,"minLength",void 0),S2=g([te("esri.form.elements.inputs.TextInput")],S2);const b8=S2;var w8;let SM=w8=class extends b8{constructor(e){super(e),this.type="barcode-scanner"}clone(){return new w8({maxLength:this.maxLength,minLength:this.minLength})}};g([w({type:["barcode-scanner"],json:{read:!1,write:!0}})],SM.prototype,"type",void 0),SM=w8=g([te("esri.form.elements.inputs.BarcodeScannerInput")],SM);const L$e=SM;var _8;let O1=_8=class extends L1{constructor(e){super(e),this.noValueOptionLabel=null,this.showNoValueOption=!0,this.type="combo-box"}clone(){return new _8({showNoValueOption:this.showNoValueOption,noValueOptionLabel:this.noValueOptionLabel})}};g([w({type:String,json:{write:!0}})],O1.prototype,"noValueOptionLabel",void 0),g([w({type:Boolean,json:{write:!0}})],O1.prototype,"showNoValueOption",void 0),g([w({type:["combo-box"],json:{read:!1,write:!0}})],O1.prototype,"type",void 0),O1=_8=g([te("esri.form.elements.inputs.ComboBoxInput")],O1);const O$e=O1;var x8;function fK(e){return e!=null?new Date(e):null}function yK(e){return e?e.getTime():null}let Mc=x8=class extends L1{constructor(e){super(e),this.includeTime=!1,this.max=null,this.min=null,this.type="datetime-picker"}readMax(e,t){return fK(t.max)}writeMax(e,t){t.max=yK(e)}readMin(e,t){return fK(t.min)}writeMin(e,t){t.min=yK(e)}clone(){return new x8({includeTime:this.includeTime,max:this.max,min:this.min,type:this.type})}};g([w({type:Boolean,json:{write:!0}})],Mc.prototype,"includeTime",void 0),g([w({type:Date,json:{type:Number,write:!0}})],Mc.prototype,"max",void 0),g([We("max")],Mc.prototype,"readMax",null),g([tt("max")],Mc.prototype,"writeMax",null),g([w({type:Date,json:{type:Number,write:!0}})],Mc.prototype,"min",void 0),g([We("min")],Mc.prototype,"readMin",null),g([tt("min")],Mc.prototype,"writeMin",null),g([w({type:["datetime-picker"],json:{read:!1,write:!0}})],Mc.prototype,"type",void 0),Mc=x8=g([te("esri.form.elements.inputs.DateTimePickerInput")],Mc);const R$e=Mc;var S8;let R1=S8=class extends L1{constructor(e){super(e),this.noValueOptionLabel=null,this.showNoValueOption=!0,this.type="radio-buttons"}clone(){return new S8({noValueOptionLabel:this.noValueOptionLabel,showNoValueOption:this.showNoValueOption})}};g([w({type:String,json:{write:!0}})],R1.prototype,"noValueOptionLabel",void 0),g([w({type:Boolean,json:{write:!0}})],R1.prototype,"showNoValueOption",void 0),g([w({type:["radio-buttons"],json:{read:!1,write:!0}})],R1.prototype,"type",void 0),R1=S8=g([te("esri.form.elements.inputs.RadioButtonsInput")],R1);const F$e=R1;var M8;let F1=M8=class extends L1{constructor(e){super(e),this.offValue=null,this.onValue=null,this.type="switch"}clone(){return new M8({offValue:this.offValue,onValue:this.onValue})}};g([w({type:[String,Number],json:{write:!0}})],F1.prototype,"offValue",void 0),g([w({type:[String,Number],json:{write:!0}})],F1.prototype,"onValue",void 0),g([w({type:["switch"],json:{read:!1,write:!0}})],F1.prototype,"type",void 0),F1=M8=g([te("esri.form.elements.inputs.SwitchInput")],F1);const N$e=F1;var I8;let MM=I8=class extends b8{constructor(e){super(e),this.type="text-area"}clone(){return new I8({maxLength:this.maxLength,minLength:this.minLength})}};g([w({type:["text-area"],json:{read:!1,write:!0}})],MM.prototype,"type",void 0),MM=I8=g([te("esri.form.elements.inputs.TextAreaInput")],MM);const D$e=MM;var $8;let IM=$8=class extends b8{constructor(e){super(e),this.type="text-box"}clone(){return new $8({maxLength:this.maxLength,minLength:this.minLength})}};g([w({type:["text-box"],json:{read:!1,write:!0}})],IM.prototype,"type",void 0),IM=$8=g([te("esri.form.elements.inputs.TextBoxInput")],IM);const j$e=IM,V$e={base:L1,key:"type",typeMap:{"barcode-scanner":L$e,"combo-box":O$e,"datetime-picker":R$e,"radio-buttons":F$e,switch:N$e,"text-area":D$e,"text-box":j$e}};var E8;let wl=E8=class extends P1{constructor(e){super(e),this.domain=null,this.editable=!0,this.editableExpression=null,this.fieldName=null,this.hint=null,this.input=null,this.requiredExpression=null,this.type="field",this.valueExpression=null}clone(){return new E8({description:this.description,domain:this.domain,editable:this.editable,editableExpression:this.editableExpression,fieldName:this.fieldName,hint:this.hint,input:this.input,label:this.label,requiredExpression:this.requiredExpression,valueExpression:this.valueExpression,visibilityExpression:this.visibilityExpression})}};g([w({types:lJ,json:{read:{reader:B7},write:!0}})],wl.prototype,"domain",void 0),g([w({type:Boolean,json:{write:!0}})],wl.prototype,"editable",void 0),g([w({type:String,json:{write:!0}})],wl.prototype,"editableExpression",void 0),g([w({type:String,json:{write:!0}})],wl.prototype,"fieldName",void 0),g([w({type:String,json:{write:!0}})],wl.prototype,"hint",void 0),g([w({types:V$e,json:{read:{source:"inputType"},write:{target:"inputType"}}})],wl.prototype,"input",void 0),g([w({type:String,json:{write:!0}})],wl.prototype,"requiredExpression",void 0),g([w({type:String,json:{read:!1,write:!0}})],wl.prototype,"type",void 0),g([w({type:String,json:{write:!0}})],wl.prototype,"valueExpression",void 0),wl=E8=g([te("esri.form.elements.FieldElement")],wl);const mK=wl;var T8;let Zh=T8=class extends P1{constructor(e){super(e),this.displayCount=null,this.displayType="list",this.editable=!0,this.orderByFields=null,this.relationshipId=null,this.type="relationship"}clone(){return new T8({description:this.description,displayCount:this.displayCount,displayType:this.displayType,editable:this.editable,label:this.label,orderByFields:_e(this.orderByFields),relationshipId:this.relationshipId,visibilityExpression:this.visibilityExpression})}};g([w({type:Number,json:{write:!0}})],Zh.prototype,"displayCount",void 0),g([w({type:["list"],json:{write:!0}})],Zh.prototype,"displayType",void 0),g([w({type:Boolean,json:{write:!0}})],Zh.prototype,"editable",void 0),g([w({type:[m6],json:{write:!0}})],Zh.prototype,"orderByFields",void 0),g([w({type:Number,json:{write:!0}})],Zh.prototype,"relationshipId",void 0),g([w({type:["relationship"],json:{read:!1,write:!0}})],Zh.prototype,"type",void 0),Zh=T8=g([te("esri.form.elements.RelationshipElement")],Zh);const gK=Zh;function vK(e){return{typesWithGroup:{base:P1,key:"type",typeMap:{attachment:dK,field:mK,group:e,relationship:gK}},typesWithoutGroup:{base:P1,key:"type",typeMap:{attachment:dK,field:mK,relationship:gK}}}}function bK(e,t,i=!0){if(!e)return null;const r=i?t.typesWithGroup.typeMap:t.typesWithoutGroup.typeMap;return e.filter(n=>r[n.type]).map(n=>r[n.type].fromJSON(n))}function wK(e,t,i=!0){if(!e)return null;const r=i?t.typesWithGroup.typeMap:t.typesWithoutGroup.typeMap;return e.filter(n=>r[n.type]).map(n=>n.toJSON())}function _K(e,t,i=!0){return e?e.map(r=>Yc(i?t.typesWithGroup:t.typesWithoutGroup,r)):null}var C8;let Iu=C8=class extends P1{constructor(e){super(e),this.elements=null,this.initialState="expanded",this.type="group"}castElements(e){return _K(e,k8,!1)}readElements(e,t){return bK(t.formElements,k8,!1)}writeElements(e,t){t.formElements=wK(e,k8,!1)}clone(){return new C8({description:this.description,elements:_e(this.elements),initialState:this.initialState,label:this.label,visibilityExpression:this.visibilityExpression})}};g([w({json:{write:!0}})],Iu.prototype,"elements",void 0),g([Dt("elements")],Iu.prototype,"castElements",null),g([We("elements",["formElements"])],Iu.prototype,"readElements",null),g([tt("elements")],Iu.prototype,"writeElements",null),g([w({type:["collapsed","expanded"],json:{write:!0}})],Iu.prototype,"initialState",void 0),g([w({type:String,json:{read:!1,write:!0}})],Iu.prototype,"type",void 0),Iu=C8=g([te("esri.form.elements.GroupElement")],Iu);const k8=vK(Iu),z$e=Iu;var A8;const P8=vK(z$e);let Ic=A8=class extends ke{constructor(e){super(e),this.description=null,this.elements=null,this.expressionInfos=null,this.preserveFieldValuesWhenHidden=!1,this.title=null}castElements(e){return _K(e,P8)}readElements(e,t){return bK(t.formElements,P8)}writeElements(e,t){t.formElements=wK(e,P8)}clone(){return new A8({description:this.description,expressionInfos:_e(this.expressionInfos),elements:_e(this.elements),title:this.title,preserveFieldValuesWhenHidden:this.preserveFieldValuesWhenHidden})}};g([w({type:String,json:{write:!0}})],Ic.prototype,"description",void 0),g([w({json:{write:!0}})],Ic.prototype,"elements",void 0),g([Dt("elements")],Ic.prototype,"castElements",null),g([We("elements",["formElements"])],Ic.prototype,"readElements",null),g([tt("elements")],Ic.prototype,"writeElements",null),g([w({type:[A$e],json:{write:!0}})],Ic.prototype,"expressionInfos",void 0),g([w({type:Boolean,json:{default:!1,write:!0}})],Ic.prototype,"preserveFieldValuesWhenHidden",void 0),g([w({type:String,json:{write:!0}})],Ic.prototype,"title",void 0),Ic=A8=g([te("esri.form.FormTemplate")],Ic);const G$e=Ic;function xK(e,t,i){if(e.hasM==null||e.hasZ)for(const r of t)for(const n of r)n.length>2&&(n[2]*=i)}function B$e(e,t,i){if(!e&&!t||!i)return;const r=jg(i);SK(e,i,r),SK(t,i,r)}function SK(e,t,i){if(e)for(const r of e)U$e(r.geometry,t,i)}function U$e(e,t,i){if(ce(e)||!e.spatialReference||hr(e.spatialReference,t))return;const r=jg(e.spatialReference)/i;if(r!==1){if("x"in e)e.z!=null&&(e.z*=r);else if("rings"in e)xK(e,e.rings,r);else if("paths"in e)xK(e,e.paths,r);else if("points"in e&&(e.hasM==null||e.hasZ))for(const n of e.points)n.length>2&&(n[2]*=r)}}let q$e=0;const MK="esri.layers.graphics.sources.MemorySource",L8=$e.getLogger(MK);let Kh=class extends Xo.LoadableMixin(o_(ls(Xe))){constructor(e){super(e),this._idToClientGraphic=null,this.type="memory"}load(e){const t=H(e)?e.signal:null;return this.addResolvingPromise(this._startWorker(t)),Promise.resolve(this)}destroy(){var e;(e=this._connection)==null||e.close(),this._connection=null}get _workerGeometryType(){var t;const e=(t=this.layer)==null?void 0:t.geometryType;return e?this._geometryTypeRequiresClientGraphicMapping(e)?"polygon":e:null}applyEdits(e){return this.load().then(()=>this._applyEdits(e))}openPorts(){return this.load().then(()=>this._connection.openPorts())}async queryFeatures(e,t={}){await this.load(t);const i=await this._connection.invoke("queryFeatures",e?e.toJSON():null,t);X9(e,this.layer.spatialReference,i);const r=Gh.fromJSON(i);if(!this._requiresClientGraphicMapping())return r;const n=this.layer.objectIdField;for(const o of r.features){const c=o.attributes[n],h=this._idToClientGraphic.get(c);h&&(o.geometry=h.geometry)}return r.geometryType=this.layer.geometryType,r}async queryFeaturesJSON(e,t={}){if(this._requiresClientGraphicMapping())throw new ue("query-features-json:unsupported","Cannot query in JSON format for client only geometry types (mesh and extent)");await this.load(t);const i=await this._connection.invoke("queryFeatures",e?e.toJSON():null,t);return X9(e,this.layer.spatialReference,i),i}queryFeatureCount(e,t={}){return this.load(t).then(()=>this._connection.invoke("queryFeatureCount",e?e.toJSON():null,t))}queryObjectIds(e,t={}){return this.load(t).then(()=>this._connection.invoke("queryObjectIds",e?e.toJSON():null,t))}queryExtent(e,t={}){return this.load(t).then(()=>this._connection.invoke("queryExtent",e?e.toJSON():null,t)).then(i=>({count:i.count,extent:gi.fromJSON(i.extent)}))}querySnapping(e,t={}){return this.load(t).then(()=>this._connection.invoke("querySnapping",e,t))}async _applyEdits(e){if(!this._connection)throw new ue("feature-layer-source:edit-failure","Memory source not loaded");const t=this.layer.objectIdField;let i=null;const r=[],n=[];await Promise.all([this._prepareClientMapping(e.addFeatures,null),this._prepareClientMapping(e.updateFeatures,null)]);const o=b=>"objectId"in b&&b.objectId!=null?b.objectId:"attributes"in b&&b.attributes[t]!=null?b.attributes[t]:null;if(e.addFeatures&&(i=this._prepareAddFeatures(e.addFeatures)),e.deleteFeatures)for(const b of e.deleteFeatures){const x=o(b);x!=null&&r.push(x)}const c=e.updateFeatures&&this._idToClientGraphic?new Map:null;if(e.updateFeatures){for(const b of e.updateFeatures)if(n.push(this._serializeFeature(b)),c){const x=o(b);x!=null&&c.set(x,b)}}B$e(i?i.features:null,n,this.layer.spatialReference);const{fullExtent:h,featureEditResults:m}=await this._connection.invoke("applyEdits",{adds:i?i.features:[],updates:n,deletes:r});return this.fullExtent=h,i&&i.finish(m.uidToObjectId),this._updateClientGraphicIds(c,m),this._createEditsResult(m)}async _prepareClientMapping(e,t){if(this._layerOrSourceGeometryType!=="mesh"||ce(e))return;const i=[];for(const{geometry:r}of e)!H(r)||r.type!=="mesh"||r.hasExtent||r.loaded||i.push(r.load({signal:t}));i.length&&await Promise.all(i)}_updateClientGraphicIds(e,t){if(this._idToClientGraphic){if(e)for(const i of t.updateResults){if(!i.success)continue;const r=e.get(i.objectId);r!=null&&this._addIdToClientGraphic(r)}for(const i of t.deleteResults)i.success&&this._idToClientGraphic.delete(i.objectId)}}_createEditsResult(e){return{addFeatureResults:e.addResults?e.addResults.map(this._createFeatureEditResult,this):[],updateFeatureResults:e.updateResults?e.updateResults.map(this._createFeatureEditResult,this):[],deleteFeatureResults:e.deleteResults?e.deleteResults.map(this._createFeatureEditResult,this):[],addAttachmentResults:[],updateAttachmentResults:[],deleteAttachmentResults:[]}}_createFeatureEditResult(e){const t=e.success===!0?null:e.error||{code:void 0,description:void 0};return{objectId:e.objectId,globalId:e.globalId,error:t?new ue("feature-layer-source:edit-failure",t.description,{code:t.code}):null}}_prepareAddFeatures(e){const t=new Map,i=new Array(e.length);let r=null;for(let o=0;o<e.length;o++){const c=e[o],h=this._serializeFeature(c);!r&&H(c.geometry)&&(r=c.geometry.type),i[o]=h,t.set(`${h.uid}`,c)}const n=this;return{features:i,inferredGeometryType:r,finish(o){const c=n.sourceJSON.objectIdField;for(const h in o){const m=o[h],b=t.get(h);b&&(b.attributes||(b.attributes={}),m===-1?delete b.attributes[c]:b.attributes[c]=m,n._addIdToClientGraphic(b))}}}}_addIdToClientGraphic(e){if(!this._idToClientGraphic)return;const t=this.sourceJSON.objectIdField,i=e.attributes&&e.attributes[t];i!=null&&this._idToClientGraphic.set(i,e)}get _layerOrSourceGeometryType(){var e,t,i;return(i=(e=this.layer)==null?void 0:e.geometryType)!=null?i:(t=this.sourceJSON)==null?void 0:t.geometryType}_requiresClientGraphicMapping(){return this._geometryTypeRequiresClientGraphicMapping(this._layerOrSourceGeometryType)}_geometryRequiresClientGraphicMapping(e){return this._geometryTypeRequiresClientGraphicMapping(e.type)}_geometryTypeRequiresClientGraphicMapping(e){return e==="mesh"||e==="multipatch"||e==="extent"}_serializeFeature(e){const{attributes:t}=e,i=this._geometryForSerialization(e),r=(q$e++).toString();return i?{uid:r,geometry:i.toJSON(),attributes:t}:{uid:r,attributes:t}}_geometryForSerialization(e){const{geometry:t}=e;return ce(t)?null:this._geometryRequiresClientGraphicMapping(t)?t.extent?es.fromExtent(t.extent):null:t}async _startWorker(e){this._connection=await i2e("MemorySourceWorker",{strategy:Te("feature-layers-workers")?"dedicated":"local",signal:e});const{fields:t,spatialReference:i,objectIdField:r,hasM:n,hasZ:o,timeInfo:c}=this.layer,h=this.layer.originOf("spatialReference")==="defaults";await this._prepareClientMapping(this.items,e);const m=this._prepareAddFeatures(this.items);this.handles.add(this.on("before-changes",E=>{L8.error("Source modifications will not propagate after layer has been loaded. Please use .applyEdits() instead"),E.preventDefault()}));const b={features:m.features,fields:t&&t.map(E=>E.toJSON()),geometryType:DS.toJSON(this._workerGeometryType),hasM:this._layerOrSourceGeometryType!=="mesh"&&n,hasZ:this._layerOrSourceGeometryType==="mesh"||o,objectIdField:r,spatialReference:h?null:i&&i.toJSON(),timeInfo:c?c.toJSON():null},x=await this._connection.invoke("load",b,{signal:e});for(const E of x.warnings)L8.warn(E.message,{layer:this.layer,warning:E});x.featureErrors.length&&L8.warn(`Encountered ${x.featureErrors.length} validation errors while loading features`,x.featureErrors);const I=x.layerDefinition;this._geometryTypeRequiresClientGraphicMapping(m.inferredGeometryType)&&(I.geometryType=DS.toJSON(m.inferredGeometryType)),this.sourceJSON=I,this._requiresClientGraphicMapping()&&(this._idToClientGraphic=new Map),m.finish(x.assignedObjectIds)}};g([FT({Type:Gr,ensureType:Oi(Gr)})],Kh.prototype,"itemType",void 0),g([w()],Kh.prototype,"type",void 0),g([w({constructOnly:!0})],Kh.prototype,"layer",void 0),g([w({readOnly:!0})],Kh.prototype,"_workerGeometryType",null),g([w()],Kh.prototype,"sourceJSON",void 0),Kh=g([te(MK)],Kh);function H$e(e){return"portalItem"in e}const O8=e=>{let t=class extends e{get apiKey(){var i;return this._isOverridden("apiKey")?this._get("apiKey"):H$e(this)?(i=this.portalItem)==null?void 0:i.apiKey:null}set apiKey(i){i!=null?this._override("apiKey",i):(this._clearOverride("apiKey"),this.clear("apiKey","user"))}};return g([w({type:String})],t.prototype,"apiKey",null),t=g([te("esri.layers.mixins.APIKeyMixin")],t),t},IK={mapserver:"MapServer",imageserver:"ImageServer",featureserver:"FeatureServer",sceneserver:"SceneServer",streamserver:"StreamServer",vectortileserver:"VectorTileServer"},$K=Object.values(IK),EK=new RegExp(`^((?:https?:)?\\/\\/\\S+?\\/rest\\/services\\/(.+?)\\/(${$K.join("|")}))(?:\\/(?:layers\\/)?(\\d+))?`,"i"),W$e=new RegExp(`^((?:https?:)?\\/\\/\\S+?\\/([^\\/\\n]+)\\/(${$K.join("|")}))(?:\\/(?:layers\\/)?(\\d+))?`,"i"),J$e=/(.*?)\/(?:layers\/)?(\d+)\/?$/i;function Z$e(e){return!!EK.test(e)}function hf(e){if(ce(e))return null;const t=mn(e),i=t.path.match(EK)||t.path.match(W$e);if(!i)return null;const[,r,n,o,c]=i,h=n.indexOf("/");return{title:R8(h!==-1?n.slice(h+1):n),serverType:IK[o.toLowerCase()],sublayer:c!=null&&c!==""?parseInt(c,10):null,url:{path:r}}}function K$e(e){const t=mn(e).path.match(J$e);return t?{serviceUrl:t[1],sublayerId:Number(t[2])}:null}function R8(e){return(e=e.replace(/\s*[/_]+\s*/g," "))[0].toUpperCase()+e.slice(1)}function Y$e(e,t){const i=[];if(e){const r=hf(e);H(r)&&r.title&&i.push(r.title)}if(t){const r=R8(t);i.push(r)}if(i.length===2){if(i[0].toLowerCase().includes(i[1].toLowerCase()))return i[0];if(i[1].toLowerCase().includes(i[0].toLowerCase()))return i[1]}return i.join(" - ")}function F8(e){if(!e)return!1;const t=".arcgis.com/",i="//services",r="//tiles",n="//features",o=(e=e.toLowerCase()).includes(t),c=e.includes(i)||e.includes(r)||e.includes(n);return o&&c}function X$e(e,t){return e&&aB(lB(e,t))}function Q$e(e){let{url:t}=e;if(!t)return{url:t};t=lB(t,e.logger);const i=mn(t),r=hf(i.path);let n;if(H(r))r.sublayer!=null&&e.layer.layerId==null&&(n=r.sublayer),t=r.url.path;else if(e.nonStandardUrlAllowed){const o=K$e(i.path);H(o)&&(t=o.serviceUrl,n=o.sublayerId)}return{url:aB(t),layerId:n}}function eEe(e,t,i,r,n){R0(t,r,"url",n),r.url&&e.layerId!=null&&(r.url=Cd(r.url,i,e.layerId.toString()))}function sKe(e){if(!e)return!1;const t=e.toLowerCase(),i=t.includes("/services/"),r=t.includes("/mapserver/wmsserver"),n=t.includes("/imageserver/wmsserver"),o=t.includes("/wmsserver");return i&&(r||n||o)}const N8=e=>{let t=class extends e{get title(){if(this._get("title")&&this.originOf("title")!=="defaults")return this._get("title");if(this.url){const i=hf(this.url);if(H(i)&&i.title)return i.title}return this._get("title")||""}set title(i){this._set("title",i)}set url(i){this._set("url",X$e(i,$e.getLogger(this.declaredClass)))}};return g([w()],t.prototype,"title",null),g([w({type:String})],t.prototype,"url",null),t=g([te("esri.layers.mixins.ArcGISService")],t),t},TK={read:{reader:I7},write:{allowNull:!0,writer:$7}},$M=e=>{let t=class extends e{constructor(){super(...arguments),this.blendMode="normal",this.effect=null}};return g([w({type:["average","color-burn","color-dodge","color","darken","destination-atop","destination-in","destination-out","destination-over","difference","exclusion","hard-light","hue","invert","lighten","lighter","luminosity","minus","multiply","normal","overlay","plus","reflect","saturation","screen","soft-light","source-atop","source-in","source-out","vivid-light","xor"],nonNullable:!0,json:{read:!1,write:!1,origins:{"web-map":{read:!0,write:!0},"portal-item":{read:!0,write:!0}}}})],t.prototype,"blendMode",void 0),g([w({json:{read:!1,write:!1,origins:{"web-map":TK,"portal-item":TK}}})],t.prototype,"effect",void 0),t=g([te("esri.layers.mixins.BlendLayer")],t),t},D8=e=>{let t=class extends e{constructor(){super(...arguments),this.customParameters=null}};return g([w({type:Object,json:{write:{overridePolicy:i=>({enabled:!!(i&&Object.keys(i).length>0)})}}})],t.prototype,"customParameters",void 0),t=g([te("esri.layers.mixins.CustomParametersMixin")],t),t},tEe=new Or.EventEmitter,CK="esri.layers.mixins.EditBusLayer",kK=Symbol(CK);function oKe(e){return e!=null&&typeof e=="object"&&kK in e}const iEe=e=>{var t;let i=class extends e{constructor(...r){super(...r),this[t]=!0,this.when().then(()=>{this.own([tEe.on("edits",n=>{var x,I,E;const o="layer"in n?n.layer:null,c="layer"in n?(x=n.layer)==null?void 0:x.url:n.serviceUrl,h="layer"in n?(I=n.layer)==null?void 0:I.layerId:n.layerId,m=n.event;if(o===this||c!==this.url)return;if(h!=null&&this.layerId!=null&&h===this.layerId)return void this.emit("edits",_e(m));const b=(E=m.editedFeatures)==null?void 0:E.find(({layerId:k})=>k===this.layerId);if(b){const{adds:k,updates:P,deletes:F}=b.editedFeatures,N={edits:null,addedAttachments:[],deletedAttachments:[],updatedAttachments:[],addedFeatures:k?k.map(({attributes:B})=>({objectId:this.objectIdField&&B[this.objectIdField],globalId:this.globalIdField&&B[this.globalIdField]})):[],deletedFeatures:F?F.map(({attributes:B})=>({objectId:this.objectIdField&&B[this.objectIdField],globalId:this.globalIdField&&B[this.globalIdField]})):[],updatedFeatures:P?P.map(({current:{attributes:B}})=>({objectId:this.objectIdField&&B[this.objectIdField],globalId:this.globalIdField&&B[this.globalIdField]})):[],editedFeatures:_e(m.editedFeatures)};this.emit("edits",N)}})])},()=>{})}};return t=kK,i=g([te(CK)],i),i};var j8;const V8=new kt({esriSpatialRelIntersects:"intersects",esriSpatialRelContains:"contains",esriSpatialRelCrosses:"crosses",esriSpatialRelDisjoint:"disjoint",esriSpatialRelEnvelopeIntersects:"envelope-intersects",esriSpatialRelIndexIntersects:"index-intersects",esriSpatialRelOverlaps:"overlaps",esriSpatialRelTouches:"touches",esriSpatialRelWithin:"within",esriSpatialRelRelation:"relation"}),z8=new kt({esriSRUnit_Meter:"meters",esriSRUnit_Kilometer:"kilometers",esriSRUnit_Foot:"feet",esriSRUnit_StatuteMile:"miles",esriSRUnit_NauticalMile:"nautical-miles",esriSRUnit_USNauticalMile:"us-nautical-miles"});let $u=j8=class extends ke{constructor(e){super(e),this.where=null,this.geometry=null,this.spatialRelationship="intersects",this.distance=void 0,this.objectIds=null,this.units=null,this.timeExtent=null}createQuery(e={}){const{where:t,geometry:i,spatialRelationship:r,timeExtent:n,objectIds:o,units:c,distance:h}=this;return new co(K({geometry:_e(i),objectIds:_e(o),spatialRelationship:r,timeExtent:_e(n),where:t,units:c,distance:h},e))}clone(){const{where:e,geometry:t,spatialRelationship:i,timeExtent:r,objectIds:n,units:o,distance:c}=this;return new j8({geometry:_e(t),objectIds:_e(n),spatialRelationship:i,timeExtent:_e(r),where:e,units:o,distance:c})}};g([w({type:String,json:{write:!0}})],$u.prototype,"where",void 0),g([w({types:wh,json:{write:!0}})],$u.prototype,"geometry",void 0),g([w({type:V8.apiValues,json:{name:"spatialRel",read:{reader:V8.read},write:{allowNull:!1,writer:V8.write,overridePolicy(){return{enabled:H(this.geometry)}}}}})],$u.prototype,"spatialRelationship",void 0),g([w({type:Number,json:{write:{overridePolicy(e){return{enabled:e!=null&&this.geometry!=null}}}}})],$u.prototype,"distance",void 0),g([w({type:[Number],json:{write:!0}})],$u.prototype,"objectIds",void 0),g([w({type:z8.apiValues,json:{read:z8.read,write:{writer:z8.write,overridePolicy(e){return{enabled:e!=null&&this.geometry!=null}}}}})],$u.prototype,"units",void 0),g([w({type:qa,json:{write:!0}})],$u.prototype,"timeExtent",void 0),$u=j8=g([te("esri.layers.support.FeatureFilter")],$u);const rEe=$u;var G8;const AK={read:{reader:I7},write:{writer:$7,overridePolicy(){return{allowNull:this.excludedEffect!=null,isRequired:this.excludedEffect==null}}}},PK={read:{reader:I7},write:{writer:$7,overridePolicy(){return{allowNull:this.includedEffect!=null,isRequired:this.includedEffect==null}}}},LK={name:"showExcludedLabels",default:!0};let Oy=G8=class extends ke{constructor(e){super(e),this.filter=null,this.includedEffect=null,this.excludedEffect=null,this.excludedLabelsVisible=!1}write(e,t){var r,n;const i=super.write(e,t);if(t==null?void 0:t.origin){if(i.filter){const o=Object.keys(i.filter);if(o.length>1||o[0]!=="where")return(r=t.messages)==null||r.push(new ue("web-document-write:unsupported-feature-effect","Invalid feature effect 'filter'. A filter can only contain a 'where' property",{layer:t.layer,effect:this})),null}if("showExcludedLabels"in i)return(n=t.messages)==null||n.push(new ue("web-document-write:unsupported-feature-effect","Invalid value for property 'excludedLabelsVisible' which should always be 'true'",{layer:t.layer,effect:this})),null}return i}clone(){return new G8({filter:H(this.filter)?this.filter.clone():null,includedEffect:this.includedEffect,excludedEffect:this.excludedEffect,excludedLabelsVisible:this.excludedLabelsVisible})}};g([w({type:rEe,json:{write:{allowNull:!0,writer(e,t,i,r){const n=e==null?void 0:e.write({},r);n&&Object.keys(n).length!==0?eo(i,n,t):eo(i,null,t)}}}})],Oy.prototype,"filter",void 0),g([w({json:{write:!0,origins:{"web-map":AK,"portal-item":AK}}})],Oy.prototype,"includedEffect",void 0),g([w({json:{write:!0,origins:{"web-map":PK,"portal-item":PK}}})],Oy.prototype,"excludedEffect",void 0),g([w({type:Boolean,json:{write:!0,name:"showExcludedLabels",origins:{"web-map":LK,"portal-item":LK}}})],Oy.prototype,"excludedLabelsVisible",void 0),Oy=G8=g([te("esri.layers.support.FeatureEffect")],Oy);const nEe=Oy,OK={write:{allowNull:!0}},sEe=e=>{let t=class extends e{constructor(){super(...arguments),this.featureEffect=null}};return g([w({type:nEe,json:{origins:{"web-map":OK,"portal-item":OK}}})],t.prototype,"featureEffect",void 0),t=g([te("esri.layers.mixins.FeatureEffectLayer")],t),t};var M2;const EM=Ns()({orthometric:"gravity-related-height",gravity_related_height:"gravity-related-height",ellipsoidal:"ellipsoidal"}),RK=EM.jsonValues.slice();Ej(RK,"orthometric");const I2=Ns()({meter:"meters",foot:"feet","us-foot":"us-feet","clarke-foot":"clarke-feet","clarke-yard":"clarke-yards","clarke-link":"clarke-links","sears-yard":"sears-yards","sears-foot":"sears-feet","sears-chain":"sears-chains","benoit-1895-b-chain":"benoit-1895-b-chains","indian-yard":"indian-yards","indian-1937-yard":"indian-1937-yards","gold-coast-foot":"gold-coast-feet","sears-1922-truncated-chain":"sears-1922-truncated-chains","50-kilometers":"50-kilometers","150-kilometers":"150-kilometers"});let $c=M2=class extends ke{constructor(e){super(e),this.heightModel="gravity-related-height",this.heightUnit="meters",this.vertCRS=null}writeHeightModel(e,t,i){return EM.write(e,t,i)}readHeightModel(e,t,i){return EM.read(e)||(i&&i.messages&&i.messages.push(oEe(e,{context:i})),null)}readHeightUnit(e,t,i){return I2.read(e)||(i&&i.messages&&i.messages.push(FK(e,{context:i})),null)}readHeightUnitService(e,t,i){return BU(e)||I2.read(e)||(i&&i.messages&&i.messages.push(FK(e,{context:i})),null)}readVertCRS(e,t){return t.vertCRS||t.ellipsoid||t.geoid}clone(){return new M2({heightModel:this.heightModel,heightUnit:this.heightUnit,vertCRS:this.vertCRS})}equals(e){return!!e&&(this===e||this.heightModel===e.heightModel&&this.heightUnit===e.heightUnit&&this.vertCRS===e.vertCRS)}static deriveUnitFromSR(e,t){const i=UU(t);return new M2({heightModel:e.heightModel,heightUnit:i,vertCRS:e.vertCRS})}write(e,t){return t=K({origin:"web-scene"},t),super.write(e,t)}static fromJSON(e){if(!e)return null;const t=new M2;return t.read(e,{origin:"web-scene"}),t}};function FK(e,t){return new Io("height-unit:unsupported",`Height unit of value '${e}' is not supported`,t)}function oEe(e,t){return new Io("height-model:unsupported",`Height model of value '${e}' is not supported`,t)}g([w({type:EM.apiValues,constructOnly:!0,json:{origins:{"web-scene":{type:RK,default:"ellipsoidal"}}}})],$c.prototype,"heightModel",void 0),g([tt("web-scene","heightModel")],$c.prototype,"writeHeightModel",null),g([We(["web-scene","service"],"heightModel")],$c.prototype,"readHeightModel",null),g([w({type:I2.apiValues,constructOnly:!0,json:{origins:{"web-scene":{type:I2.jsonValues,write:I2.write}}}})],$c.prototype,"heightUnit",void 0),g([We("web-scene","heightUnit")],$c.prototype,"readHeightUnit",null),g([We("service","heightUnit")],$c.prototype,"readHeightUnitService",null),g([w({type:String,constructOnly:!0,json:{origins:{"web-scene":{write:!0}}}})],$c.prototype,"vertCRS",void 0),g([We("service","vertCRS",["vertCRS","ellipsoid","geoid"])],$c.prototype,"readVertCRS",null),$c=M2=g([te("esri.geometry.HeightModelInfo")],$c);const $2=$c;function aEe(e){if(!e)return e;const{start:t,end:i}=e;return new qa({start:H(t)?vy(t,-t.getTimezoneOffset(),"minutes"):t,end:H(i)?vy(i,-i.getTimezoneOffset(),"minutes"):i})}function lEe(e){if(!e)return e;const{start:t,end:i}=e;return new qa({start:H(t)?vy(t,t.getTimezoneOffset(),"minutes"):t,end:H(i)?vy(i,i.getTimezoneOffset(),"minutes"):i})}var B8;let E2=B8=class extends ke{constructor(e){super(e)}async collectRequiredFields(e,t){return Co(e,t,this.expression)}clone(){return new B8({expression:this.expression,title:this.title})}equals(e){return this.expression===e.expression&&this.title===e.title}};g([w({type:String,json:{write:!0}})],E2.prototype,"expression",void 0),g([w({type:String,json:{write:!0}})],E2.prototype,"title",void 0),E2=B8=g([te("esri.layers.support.FeatureExpressionInfo")],E2);const NK=E2;function aKe(e){return oM[e]!=null}function cEe(e){return 1/(oM[e]||1)}function uEe(){const e=Object.keys(oM);return e.sort(),e}const hEe=uEe();var U8;const TM=Ns()({onTheGround:"on-the-ground",relativeToGround:"relative-to-ground",relativeToScene:"relative-to-scene",absoluteHeight:"absolute-height"}),DK=new kt({foot:"feet",kilometer:"kilometers",meter:"meters",mile:"miles","us-foot":"us-feet",yard:"yards"});let Yh=U8=class extends ke{constructor(e){super(e),this.offset=null}readFeatureExpressionInfo(e,t){return e!=null?e:t.featureExpression&&t.featureExpression.value===0?{expression:"0"}:void 0}writeFeatureExpressionInfo(e,t,i,r){t[i]=e.write({},r),e.expression==="0"&&(t.featureExpression={value:0})}get mode(){const{offset:e,featureExpressionInfo:t}=this;return this._isOverridden("mode")?this._get("mode"):H(e)||t?"relative-to-ground":"on-the-ground"}set mode(e){this._override("mode",e)}set unit(e){this._set("unit",e)}write(e,t){return this.offset||this.mode||this.featureExpressionInfo||this.unit?super.write(e,t):null}clone(){return new U8({mode:this.mode,offset:this.offset,featureExpressionInfo:this.featureExpressionInfo?this.featureExpressionInfo.clone():void 0,unit:this.unit})}equals(e){return this.mode===e.mode&&this.offset===e.offset&&this.unit===e.unit&&Mj(this.featureExpressionInfo,e.featureExpressionInfo)}};g([w({type:NK,json:{write:!0}})],Yh.prototype,"featureExpressionInfo",void 0),g([We("featureExpressionInfo",["featureExpressionInfo","featureExpression"])],Yh.prototype,"readFeatureExpressionInfo",null),g([tt("featureExpressionInfo",{featureExpressionInfo:{type:NK},"featureExpression.value":{type:[0]}})],Yh.prototype,"writeFeatureExpressionInfo",null),g([w({type:TM.apiValues,nonNullable:!0,json:{type:TM.jsonValues,read:TM.read,write:{writer:TM.write,isRequired:!0}}})],Yh.prototype,"mode",null),g([w({type:Number,json:{write:!0}})],Yh.prototype,"offset",void 0),g([w({type:hEe,json:{type:String,read:DK.read,write:DK.write}})],Yh.prototype,"unit",null),Yh=U8=g([te("esri.layers.support.ElevationInfo")],Yh);const jK=Yh,pEe={type:Boolean,value:!0,json:{origins:{service:{read:!1,write:!1},"web-map":{read:!1,write:!1}},name:"screenSizePerspective",write:!0}},CM={type:Boolean,value:!0,json:{name:"disablePopup",read:{reader:(e,t)=>!t.disablePopup},write:{enabled:!0,writer(e,t,i){t[i]=!e}}}},q8={type:Boolean,value:!0,nonNullable:!0,json:{name:"showLabels",write:!0}},H8={type:String,json:{origins:{"portal-item":{write:!1}},write:{isRequired:!0,ignoreOrigin:!0,writer:R0}}},dEe={type:Boolean,value:!0,nonNullable:!0,json:{origins:{service:{read:{enabled:!1}}},name:"showLegend",write:!0}},fEe={value:null,type:jK,json:{origins:{service:{name:"elevationInfo",write:!0}},name:"layerDefinition.elevationInfo",write:!0}};function lKe(e){return{type:e,readOnly:!0,json:{origins:{service:{read:!0}},read:!1}}}const kM={type:Number,json:{origins:{"web-document":{write:!0,read:!0},"portal-item":{write:!0}}}},yEe=Ce(K({},kM),{json:Ce(K({},kM.json),{origins:{"web-document":Ce(K({},kM.json.origins["web-document"]),{write:{enabled:!0,target:{opacity:{type:Number},"layerDefinition.drawingInfo.transparency":{type:Number}}}})},read:{source:["layerDefinition.drawingInfo.transparency","drawingInfo.transparency"],reader:(e,t,i)=>i&&i.origin!=="service"||!t.drawingInfo||t.drawingInfo.transparency===void 0?t.layerDefinition&&t.layerDefinition.drawingInfo&&t.layerDefinition.drawingInfo.transparency!==void 0?qw(t.layerDefinition.drawingInfo.transparency):void 0:qw(t.drawingInfo.transparency)}})}),mEe={type:qa,readOnly:!0,get(){var h,m;if(!((h=this.layer)==null?void 0:h.timeInfo))return null;const{datesInUnknownTimezone:e,timeOffset:t,useViewTime:i}=this.layer,r=(m=this.view)==null?void 0:m.timeExtent;let n=this.layer.timeExtent;e&&(n=lEe(n));let o=i?r&&n?r.intersection(n):r||n:n;if(!o||o.isEmpty||o.isAllTime)return o;t&&(o=o.offset(-t.value,t.unit)),e&&(o=aEe(o));const c=this._get("timeExtent");return o.equals(c)?c:o}},cKe={type:gi,readOnly:!0,json:{origins:{service:{read:{source:["fullExtent","spatialReference"],reader:(e,t)=>{const i=gi.fromJSON(e);return t.spatialReference!=null&&typeof t.spatialReference=="object"&&(i.spatialReference=Mt.fromJSON(t.spatialReference)),i}}}},read:!1}},VK={type:String,json:{origins:{service:{read:!1},"portal-item":{read:!1}}}},gEe={type:Number,json:{origins:{service:{write:{enabled:!1}}},read:{source:"layerDefinition.minScale"},write:{target:"layerDefinition.minScale"}}},vEe={type:Number,json:{origins:{service:{write:{enabled:!1}}},read:{source:"layerDefinition.maxScale"},write:{target:"layerDefinition.maxScale"}}},zK={json:{write:{ignoreOrigin:!0},origins:{"web-map":{read:!1,write:!1}}}};let Eu=class extends rn(ke){constructor(e){super(e)}};g([w({constructOnly:!0,json:{write:!0}})],Eu.prototype,"name",void 0),g([w({constructOnly:!0,json:{write:!0}})],Eu.prototype,"fields",void 0),g([w({constructOnly:!0,json:{write:!0}})],Eu.prototype,"isAscending",void 0),g([w({constructOnly:!0,json:{write:!0}})],Eu.prototype,"indexType",void 0),g([w({constructOnly:!0,json:{write:!0}})],Eu.prototype,"isUnique",void 0),g([w({constructOnly:!0,json:{write:!0}})],Eu.prototype,"description",void 0),Eu=g([te("esri.layers.support.FeatureIndex")],Eu);const W8=new kt({esriGeometryPoint:"point",esriGeometryMultipoint:"multipoint",esriGeometryPolyline:"polyline",esriGeometryPolygon:"polygon",esriGeometryMultiPatch:"multipatch"}),bEe={name:"supportsName",size:"supportsSize",contentType:"supportsContentType",keywords:"supportsKeywords",exifInfo:"supportsExifInfo"};function Wt(e,t,i){return!!(e&&e.hasOwnProperty(t)?e[t]:i)}function AM(e,t,i){return e&&e.hasOwnProperty(t)?e[t]:i}function wEe(e){var i;const t=(i=e==null?void 0:e.supportedSpatialAggregationStatistics)==null?void 0:i.map(r=>r.toLowerCase());return{envelope:!!(t==null?void 0:t.includes("envelopeaggregate")),centroid:!!(t==null?void 0:t.includes("centroidaggregate")),convexHull:!!(t==null?void 0:t.includes("convexhullaggregate"))}}function T2(e,t){var r;const i=(r=e==null?void 0:e.supportedOperationsWithCacheHint)==null?void 0:r.map(n=>n.toLowerCase());return!!(i==null?void 0:i.includes(t.toLowerCase()))}function GK(e,t,i){return{analytics:_Ee(t),attachment:xEe(t),data:SEe(t),metadata:MEe(t),operations:IEe(t.capabilities||e,t,i),query:$Ee(t,i),queryRelated:EEe(t),queryTopFeatures:TEe(t),editing:CEe(t)}}function _Ee(e){return{supportsCacheHint:T2(e.advancedQueryCapabilities,"queryAnalytics")}}function xEe(e){const t=e.attachmentProperties,i={supportsName:!1,supportsSize:!1,supportsContentType:!1,supportsKeywords:!1,supportsExifInfo:!1,supportsCacheHint:T2(e.advancedQueryCapabilities,"queryAttachments"),supportsResize:Wt(e,"supportsAttachmentsResizing",!1)};return t&&Array.isArray(t)&&t.forEach(r=>{const n=bEe[r.name];n&&(i[n]=!!r.isEnabled)}),i}function SEe(e){return{isVersioned:Wt(e,"isDataVersioned",!1),supportsAttachment:Wt(e,"hasAttachments",!1),supportsM:Wt(e,"hasM",!1),supportsZ:Wt(e,"hasZ",!1)}}function MEe(e){return{supportsAdvancedFieldProperties:Wt(e,"supportsFieldDescriptionProperty",!1)}}function IEe(e,t,i){const r=e?e.toLowerCase().split(",").map(E=>E.trim()):[],n=i?hf(i):null,o=r.includes(H(n)&&n.serverType==="MapServer"?"data":"query"),c=r.includes("editing")&&!t.datesInUnknownTimezone;let h=c&&r.includes("create"),m=c&&r.includes("delete"),b=c&&r.includes("update");const x=r.includes("changetracking"),I=t.advancedQueryCapabilities;return c&&!(h||m||b)&&(h=m=b=!0),{supportsCalculate:Wt(t,"supportsCalculate",!1),supportsTruncate:Wt(t,"supportsTruncate",!1),supportsValidateSql:Wt(t,"supportsValidateSql",!1),supportsAdd:h,supportsDelete:m,supportsEditing:c,supportsChangeTracking:x,supportsQuery:o,supportsQueryAnalytics:Wt(I,"supportsQueryAnalytic",!1),supportsQueryAttachments:Wt(I,"supportsQueryAttachments",!1),supportsQueryTopFeatures:Wt(I,"supportsTopFeaturesQuery",!1),supportsResizeAttachments:Wt(t,"supportsAttachmentsResizing",!1),supportsSync:r.includes("sync"),supportsUpdate:b,supportsExceedsLimitStatistics:Wt(t,"supportsExceedsLimitStatistics",!1)}}function $Ee(e,t){const i=e.advancedQueryCapabilities,r=e.ownershipBasedAccessControlForFeatures,n=e.archivingInfo,o=qK(e),c=t==null?void 0:t.includes("MapServer"),h=!Te("mapserver-pbf-enabled")&&c&&(o!=null?o:0)<10.81,m=F8(t),b=(e.supportedQueryFormats||"").split(",").reduce((x,I)=>{const E=I.toLowerCase().trim();return E&&x.add(E),x},new Set);return{supportsStatistics:Wt(i,"supportsStatistics",e.supportsStatistics),supportsPercentileStatistics:Wt(i,"supportsPercentileStatistics",!1),supportsSpatialAggregationStatistics:Wt(i,"supportsSpatialAggregationStatistics",!1),supportedSpatialAggregationStatistics:wEe(i),supportsCentroid:Wt(i,"supportsReturningGeometryCentroid",!1),supportsDistance:Wt(i,"supportsQueryWithDistance",!1),supportsDistinct:Wt(i,"supportsDistinct",e.supportsAdvancedQueries),supportsExtent:Wt(i,"supportsReturningQueryExtent",!1),supportsGeometryProperties:Wt(i,"supportsReturningGeometryProperties",!1),supportsHavingClause:Wt(i,"supportsHavingClause",!1),supportsOrderBy:Wt(i,"supportsOrderBy",e.supportsAdvancedQueries),supportsPagination:Wt(i,"supportsPagination",!1),supportsQuantization:Wt(e,"supportsCoordinatesQuantization",!1),supportsQuantizationEditMode:Wt(e,"supportsQuantizationEditMode",!1),supportsQueryGeometry:Wt(e,"supportsReturningQueryGeometry",!1),supportsResultType:Wt(i,"supportsQueryWithResultType",!1),supportsMaxRecordCountFactor:Wt(i,"supportsMaxRecordCountFactor",!1),supportsSqlExpression:Wt(i,"supportsSqlExpression",!1),supportsStandardizedQueriesOnly:Wt(e,"useStandardizedQueries",!1),supportsTopFeaturesQuery:Wt(i,"supportsTopFeaturesQuery",!1),supportsQueryByOthers:Wt(r,"allowOthersToQuery",!0),supportsHistoricMoment:Wt(n,"supportsQueryWithHistoricMoment",!1),supportsFormatPBF:!h&&b.has("pbf"),supportsDisjointSpatialRelationship:Wt(i,"supportsDisjointSpatialRel",!1),supportsCacheHint:Wt(i,"supportsQueryWithCacheHint",!1)||T2(i,"query"),supportsDefaultSpatialReference:Wt(i,"supportsDefaultSR",!1),supportsCompactGeometry:m,supportsFullTextSearch:Wt(i,"supportsFullTextSearch",!1),maxRecordCountFactor:AM(e,"maxRecordCountFactor",void 0),maxRecordCount:AM(e,"maxRecordCount",void 0),standardMaxRecordCount:AM(e,"standardMaxRecordCount",void 0),tileMaxRecordCount:AM(e,"tileMaxRecordCount",void 0)}}function EEe(e){const t=e.advancedQueryCapabilities,i=Wt(t,"supportsAdvancedQueryRelated",!1);return{supportsPagination:Wt(t,"supportsQueryRelatedPagination",!1),supportsCount:i,supportsOrderBy:i,supportsCacheHint:T2(t,"queryRelated")}}function TEe(e){return{supportsCacheHint:T2(e.advancedQueryCapabilities,"queryTopFilter")}}function CEe(e){const t=e.ownershipBasedAccessControlForFeatures;return{supportsGeometryUpdate:Wt(e,"allowGeometryUpdates",!0),supportsGlobalId:Wt(e,"supportsApplyEditsWithGlobalIds",!1),supportsReturnServiceEditsInSourceSpatialReference:Wt(e,"supportsReturnServiceEditsInSourceSR",!1),supportsRollbackOnFailure:Wt(e,"supportsRollbackOnFailureParameter",!1),supportsUpdateWithoutM:Wt(e,"allowUpdateWithoutMValues",!1),supportsUploadWithItemId:Wt(e,"supportsAttachmentsByUploadId",!1),supportsDeleteByAnonymous:Wt(t,"allowAnonymousToDelete",!0),supportsDeleteByOthers:Wt(t,"allowOthersToDelete",!0),supportsUpdateByAnonymous:Wt(t,"allowAnonymousToUpdate",!0),supportsUpdateByOthers:Wt(t,"allowOthersToUpdate",!0)}}async function kEe(e,t,i,r){const{source:n}=await e.load();if(await J8(e,t,r),!n.addAttachment)throw new ue(r,"Layer source does not support addAttachment capability");return n.addAttachment(t,i)}function J8(e,t,i){const{attributes:r}=t,{objectIdField:n}=e;return e.get("capabilities.data.supportsAttachment")?t?r?n&&r[n]?Promise.resolve():Promise.reject(new ue(i,`feature is missing the identifying attribute ${n}`)):Promise.reject(new ue(i,"'attributes' are required on a feature to query attachments")):Promise.reject(new ue(i,"A feature is required to add/delete/update attachments")):Promise.reject(new ue(i,"this layer doesn't support attachments"))}async function AEe(e,t,i,r,n){const{source:o}=await e.load();if(await J8(e,t,n),!o.updateAttachment)throw new ue(n,"Layer source does not support updateAttachment capability");return o.updateAttachment(t,i,r)}async function PEe(e,t,i){const r=await import("./editingSupport.f13d783c.js"),n=await e.load();return r.applyEdits(n,n.source,t,i)}async function LEe(e,t,i,r){const{source:n}=await e.load();if(await J8(e,t,r),!n.deleteAttachments)throw new ue(r,"Layer source does not support deleteAttachments capability");return n.deleteAttachments(t,i)}async function OEe(e,t,i){const{source:r}=await e.load({signal:t==null?void 0:t.signal});if(!r.fetchRecomputedExtents)throw new ue(i,"Layer source does not support fetchUpdates capability");return r.fetchRecomputedExtents(t)}async function REe(e,t,i,r){var k,P;t=T9.from(t);const{source:n,capabilities:o}=await e.load();if(!((k=o==null?void 0:o.data)==null?void 0:k.supportsAttachment))throw new ue(r,"this layer doesn't support attachments");const{attachmentTypes:c,objectIds:h,globalIds:m,num:b,size:x,start:I,where:E}=t;if(!((P=o==null?void 0:o.operations)==null?void 0:P.supportsQueryAttachments)){const F=h&&h.length>1,N=c&&c.length,B=m&&m.length,z=x&&x.length;if(F||N||B||z||b||I||E)throw new ue(r,"when 'supportsQueryAttachments' is false, only objectIds of length 1 are supported",t)}if(!(h==null?void 0:h.length)&&!E)throw new ue(r,"'objectIds' or 'where' are required to perform attachment query",t);if(!n.queryAttachments)throw new ue(r,"Layer source does not support queryAttachments capability",t);return n.queryAttachments(t)}async function FEe(e,t,i,r){var o;const{source:n}=await e.load();if(!n.queryObjectIds)throw new ue(r,"Layer source does not support queryObjectIds capability");return n.queryObjectIds((o=co.from(t))!=null?o:e.createQuery(),i)}async function NEe(e,t,i,r){var o;const{source:n}=await e.load();if(!n.queryFeatureCount)throw new ue(r,"Layer source does not support queryFeatureCount capability");return n.queryFeatureCount((o=co.from(t))!=null?o:e.createQuery(),i)}async function DEe(e,t,i,r){var o;const{source:n}=await e.load();if(!n.queryExtent)throw new ue(r,"Layer source does not support queryExtent capability");return n.queryExtent((o=co.from(t))!=null?o:e.createQuery(),i)}async function jEe(e,t,i,r){const{source:n}=await e.load();if(!n.queryRelatedFeatures)throw new ue(r,"Layer source does not support queryRelatedFeatures capability");return n.queryRelatedFeatures(_y.from(t),i)}async function VEe(e,t,i,r){const{source:n}=await e.load();if(!n.queryRelatedFeaturesCount)throw new ue(r,"Layer source does not support queryRelatedFeaturesCount capability");return n.queryRelatedFeaturesCount(_y.from(t),i)}async function zEe(e){const t=e.source;if(t==null?void 0:t.refresh)try{const{dataChanged:i,updates:r}=await t.refresh();if(H(r)&&(e.sourceJSON=K(K({},e.sourceJSON),r),e.read(r,{origin:"service",url:e.parsedUrl})),i)return!0}catch{}if(e.definitionExpression)try{return(await k$e(e.definitionExpression,e.fieldsIndex)).hasDateFunctions}catch{}return!1}function GEe(e){const t=new co,i=e.get("capabilities.data"),r=e.get("capabilities.query");t.historicMoment=e.historicMoment,t.gdbVersion=e.gdbVersion,t.returnGeometry=!0,r&&(t.compactGeometryEnabled=r.supportsCompactGeometry,t.defaultSpatialReferenceEnabled=r.supportsDefaultSpatialReference),i&&(i.supportsZ&&e.returnZ!=null&&(t.returnZ=e.returnZ),i.supportsM&&e.returnM!=null&&(t.returnM=e.returnM)),t.outFields=["*"];const{timeOffset:n,timeExtent:o}=e;return t.timeExtent=n!=null&&o!=null?o.offset(-n.value,n.unit):o||null,t.multipatchOption=e.geometryType==="multipatch"?"xyFootprint":null,t}function BK(e){const{globalIdField:t,fields:i}=e;if(t)return t;if(i){for(const r of i)if(r.type==="esriFieldTypeGlobalID")return r.name}}function UK(e){const{objectIdField:t,fields:i}=e;if(t)return t;if(i){for(const r of i)if(r.type==="esriFieldTypeOID")return r.name}}function qK(e){return e.currentVersion?e.currentVersion:e.hasOwnProperty("capabilities")||e.hasOwnProperty("drawingInfo")||e.hasOwnProperty("hasAttachments")||e.hasOwnProperty("htmlPopupType")||e.hasOwnProperty("relationships")||e.hasOwnProperty("timeInfo")||e.hasOwnProperty("typeIdField")||e.hasOwnProperty("types")?10:9.3}let N1=class extends rn(ke){constructor(e){super(e),this.shapeAreaField=null,this.shapeLengthField=null,this.units=null}};g([w({type:String,json:{read:{source:"shapeAreaFieldName"}}})],N1.prototype,"shapeAreaField",void 0),g([w({type:String,json:{read:{source:"shapeLengthFieldName"}}})],N1.prototype,"shapeLengthField",void 0),g([w({type:String,json:{read:e=>g2e.read(e)||v2e.read(e)}})],N1.prototype,"units",void 0),N1=g([te("esri.layers.support.GeometryFieldsInfo")],N1);const BEe=N1;var Z8;let D1=Z8=class extends ke{constructor(e){super(e),this.floorField=null,this.viewAllMode=!1,this.viewAllLevelIds=new Xe}clone(){return new Z8({floorField:this.floorField,viewAllMode:this.viewAllMode,viewAllLevelIds:this.viewAllLevelIds})}};g([w({type:String,json:{write:!0}})],D1.prototype,"floorField",void 0),g([w({json:{read:!1,write:!1}})],D1.prototype,"viewAllMode",void 0),g([w({json:{read:!1,write:!1}})],D1.prototype,"viewAllLevelIds",void 0),D1=Z8=g([te("esri.layers.support.LayerFloorInfo")],D1);const HK=D1,WK=new kt({esriRelCardinalityOneToOne:"one-to-one",esriRelCardinalityOneToMany:"one-to-many",esriRelCardinalityManyToMany:"many-to-many"}),JK=new kt({esriRelRoleOrigin:"origin",esriRelRoleDestination:"destination"});let _l=class extends rn(ke){constructor(e){super(e),this.cardinality=null,this.composite=null,this.id=null,this.keyField=null,this.keyFieldInRelationshipTable=null,this.name=null,this.relatedTableId=null,this.relationshipTableId=null,this.role=null}};g([w({json:{read:WK.read,write:WK.write}})],_l.prototype,"cardinality",void 0),g([w({json:{read:!0,write:!0}})],_l.prototype,"composite",void 0),g([w({json:{read:!0,write:!0}})],_l.prototype,"id",void 0),g([w({json:{read:!0,write:!0}})],_l.prototype,"keyField",void 0),g([w({json:{read:!0,write:!0}})],_l.prototype,"keyFieldInRelationshipTable",void 0),g([w({json:{read:!0,write:!0}})],_l.prototype,"name",void 0),g([w({json:{read:!0,write:!0}})],_l.prototype,"relatedTableId",void 0),g([w({json:{read:!0,write:!0}})],_l.prototype,"relationshipTableId",void 0),g([w({json:{read:JK.read,write:JK.write}})],_l.prototype,"role",void 0),_l=g([te("esri.layers.support.Relationship")],_l);const UEe=_l,qEe=e=>{let t=class extends e{constructor(){super(...arguments),this.capabilities=null,this.copyright=null,this.datesInUnknownTimezone=!1,this.displayField=null,this.definitionExpression=null,this.editFieldsInfo=null,this.editingInfo=null,this.elevationInfo=null,this.floorInfo=null,this.fullExtent=null,this.gdbVersion=null,this.geometryFieldsInfo=null,this.geometryType=null,this.hasM=void 0,this.hasZ=void 0,this.heightModelInfo=null,this.historicMoment=null,this.isTable=!1,this.layerId=void 0,this.minScale=0,this.maxScale=0,this.globalIdField=null,this.objectIdField=null,this.relationships=null,this.sourceJSON=null,this.returnM=void 0,this.returnZ=void 0,this.serviceDefinitionExpression=null,this.spatialReference=Mt.WGS84,this.subtypeField=null,this.trackIdField=null,this.indexes=new(Xe.ofType(Eu)),this.userIsAdmin=!1,this.version=void 0}readCapabilitiesFromService(i,r){return GK(i,r,this.url)}readEditingInfo(i,r){const{editingInfo:n}=r;return n?{lastEditDate:n.lastEditDate!=null?new Date(n.lastEditDate):null}:null}readIsTableFromService(i,r){return r.type==="Table"}readMinScale(i,r){return r.effectiveMinScale||i||0}readMaxScale(i,r){return r.effectiveMaxScale||i||0}readGlobalIdFieldFromService(i,r){return BK(r)}readObjectIdFieldFromService(i,r){return UK(r)}readServiceDefinitionExpression(i,r){return r.definitionQuery||r.definitionExpression}set url(i){const r=Q$e({layer:this,url:i,nonStandardUrlAllowed:!0,logger:$e.getLogger(this.declaredClass)});this._set("url",r.url),r.layerId!=null&&this._set("layerId",r.layerId)}writeUrl(i,r,n,o){eEe(this,i,null,r,o)}readVersion(i,r){return qK(r)}};return g([w({readOnly:!0,json:{read:!1,origins:{service:{read:{source:["advancedQueryCapabilities","allowGeometryUpdates","allowUpdateWithoutMValues","archivingInfo","capabilities","datesInUnknownTimezone","hasAttachments","hasM","hasZ","maxRecordCount","maxRecordCountFactor","ownershipBasedAccessControlForFeatures","standardMaxRecordCount","supportedQueryFormats","supportsAdvancedQueries","supportsApplyEditsWithGlobalIds","supportsAttachmentsByUploadId","supportsAttachmentsResizing","supportsCalculate","supportsCoordinatesQuantization","supportsExceedsLimitStatistics","supportsFieldDescriptionProperty","supportsQuantizationEditMode","supportsRollbackOnFailureParameter","supportsStatistics","supportsTruncate","supportsValidateSql","tileMaxRecordCount","useStandardizedQueries"]}}}}})],t.prototype,"capabilities",void 0),g([We("service","capabilities")],t.prototype,"readCapabilitiesFromService",null),g([w({type:String,json:{origins:{service:{read:{source:"copyrightText"}}}}})],t.prototype,"copyright",void 0),g([w({type:Boolean})],t.prototype,"datesInUnknownTimezone",void 0),g([w({type:String,json:{origins:{service:{read:{source:"displayField"}}}}})],t.prototype,"displayField",void 0),g([w({type:String,json:{origins:{service:{read:!1,write:!1}},name:"layerDefinition.definitionExpression",write:{enabled:!0,allowNull:!0}}})],t.prototype,"definitionExpression",void 0),g([w({readOnly:!0})],t.prototype,"editFieldsInfo",void 0),g([w({readOnly:!0})],t.prototype,"editingInfo",void 0),g([We("editingInfo")],t.prototype,"readEditingInfo",null),g([w((()=>{const i=_e(fEe),r=i.json.origins;return r["web-map"]={read:!1,write:!1},r["portal-item"]={read:!1,write:!1},i})())],t.prototype,"elevationInfo",void 0),g([w({type:HK,json:{read:{source:"layerDefinition.floorInfo"},write:{target:"layerDefinition.floorInfo"}}})],t.prototype,"floorInfo",void 0),g([w({type:gi,json:{origins:{service:{read:{source:"extent"}}}}})],t.prototype,"fullExtent",void 0),g([w()],t.prototype,"gdbVersion",void 0),g([w({readOnly:!0,type:BEe,json:{read:{source:"geometryProperties"}}})],t.prototype,"geometryFieldsInfo",void 0),g([w({type:["point","polygon","polyline","multipoint","multipatch","mesh"],json:{origins:{service:{read:W8.read}}}})],t.prototype,"geometryType",void 0),g([w({type:Boolean,json:{origins:{service:{read:!0}}}})],t.prototype,"hasM",void 0),g([w({type:Boolean,json:{origins:{service:{read:!0}}}})],t.prototype,"hasZ",void 0),g([w({readOnly:!0,type:$2})],t.prototype,"heightModelInfo",void 0),g([w({type:Date})],t.prototype,"historicMoment",void 0),g([w({readOnly:!0})],t.prototype,"isTable",void 0),g([We("service","isTable",["type"])],t.prototype,"readIsTableFromService",null),g([w({type:Number,json:{origins:{service:{read:{source:"id"}},"portal-item":{read:!1,write:{target:"id"}}},read:!1}})],t.prototype,"layerId",void 0),g([w(gEe)],t.prototype,"minScale",void 0),g([We("service","minScale",["minScale","effectiveMinScale"])],t.prototype,"readMinScale",null),g([w(vEe)],t.prototype,"maxScale",void 0),g([We("service","maxScale",["maxScale","effectiveMaxScale"])],t.prototype,"readMaxScale",null),g([w({type:String})],t.prototype,"globalIdField",void 0),g([We("service","globalIdField",["globalIdField","fields"])],t.prototype,"readGlobalIdFieldFromService",null),g([w({type:String})],t.prototype,"objectIdField",void 0),g([We("service","objectIdField",["objectIdField","fields"])],t.prototype,"readObjectIdFieldFromService",null),g([w({type:[UEe],readOnly:!0})],t.prototype,"relationships",void 0),g([w()],t.prototype,"sourceJSON",void 0),g([w({type:Boolean})],t.prototype,"returnM",void 0),g([w({type:Boolean})],t.prototype,"returnZ",void 0),g([w({readOnly:!0})],t.prototype,"serviceDefinitionExpression",void 0),g([We("service","serviceDefinitionExpression",["definitionQuery","definitionExpression"])],t.prototype,"readServiceDefinitionExpression",null),g([w({type:Mt,json:{origins:{service:{read:{source:"extent.spatialReference"}}}}})],t.prototype,"spatialReference",void 0),g([w({type:String,readOnly:!0,json:{origins:{service:{read:!0}}}})],t.prototype,"subtypeField",void 0),g([w({type:String,json:{read:{source:"timeInfo.trackIdField"}}})],t.prototype,"trackIdField",void 0),g([w({readOnly:!0,json:{write:!1}})],t.prototype,"serverGens",void 0),g([w({type:Xe.ofType(Eu),readOnly:!0})],t.prototype,"indexes",void 0),g([w(H8)],t.prototype,"url",null),g([tt("url")],t.prototype,"writeUrl",null),g([w({readOnly:!0})],t.prototype,"userIsAdmin",void 0),g([w({json:{origins:{service:{read:!0}},read:!1}})],t.prototype,"version",void 0),g([We("service","version",["currentVersion","capabilities","drawingInfo","hasAttachments","htmlPopupType","relationships","timeInfo","typeIdField","types"])],t.prototype,"readVersion",null),t=g([te("esri.layers.mixins.FeatureLayerBase")],t),t};let j1=class extends rn(ke){constructor(e){super(e),this.expression=null,this.title=null,this.returnType=null}};g([w({type:String,json:{write:!0}})],j1.prototype,"expression",void 0),g([w({type:String,json:{write:!0}})],j1.prototype,"title",void 0),g([w({type:String,json:{write:!0}})],j1.prototype,"returnType",void 0),j1=g([te("esri.layers.support.ExpressionInfo")],j1);const K8=j1;var Y8;let Xh=Y8=class extends ke{constructor(e){super(e),this.isAutoGenerated=!1,this.name=null,this.alias=null,this.onStatisticField=null,this.onStatisticExpression=null,this.statisticType=null}clone(){return new Y8({name:this.name,alias:this.alias,isAutoGenerated:this.isAutoGenerated,onStatisticExpression:_e(this.onStatisticExpression),onStatisticField:this.onStatisticField,statisticType:this.statisticType})}};g([w({type:Boolean,json:{write:!0}})],Xh.prototype,"isAutoGenerated",void 0),g([w({type:String,json:{write:!0}})],Xh.prototype,"name",void 0),g([w({type:String,json:{write:!0}})],Xh.prototype,"alias",void 0),g([w({type:String,json:{write:!0}})],Xh.prototype,"onStatisticField",void 0),g([w({type:K8,json:{write:!0}})],Xh.prototype,"onStatisticExpression",void 0),g([w({type:String,json:{write:!0}})],Xh.prototype,"statisticType",void 0),Xh=Y8=g([te("esri.layers.support.AggregateField")],Xh);const Ry=Xh;let pf=class extends ke{constructor(){super(...arguments),this.type=null}};g([w({type:["selection","cluster","binning"],readOnly:!0,json:{read:!1,write:!0}})],pf.prototype,"type",void 0),pf=g([te("esri.layers.support.FeatureReduction")],pf);const X8="__begin__",Q8="__end__",HEe=new RegExp(X8,"ig"),WEe=new RegExp(Q8,"ig"),ZK=new RegExp("^"+X8,"i"),KK=new RegExp(Q8+"$","i"),PM='"',JEe=PM+" + ",ZEe=" + "+PM;function KEe(e){return e.replace(new RegExp("\\[","g"),"{").replace(new RegExp("\\]","g"),"}")}function YEe(e){return e.replace(new RegExp("\\{","g"),"[").replace(new RegExp("\\}","g"),"]")}function eP(e){const t={expression:"",type:"none"};return e.labelExpressionInfo?e.labelExpressionInfo.value?(t.expression=e.labelExpressionInfo.value,t.type="conventional"):e.labelExpressionInfo.expression&&(t.expression=e.labelExpressionInfo.expression,t.type="arcade"):e.labelExpression!=null&&(t.expression=KEe(e.labelExpression),t.type="conventional"),t}function XEe(e){const t=eP(e);if(!t)return null;switch(t.type){case"conventional":return tP(t.expression);case"arcade":return t.expression}return null}function QEe(e){const t=eP(e);if(!t)return null;switch(t.type){case"conventional":return tTe(t.expression);case"arcade":return YK(t.expression)}return null}function tP(e){let t;return e?(t=Kc(e,i=>X8+'$feature["'+i+'"]'+Q8),t=ZK.test(t)?t.replace(ZK,""):PM+t,t=KK.test(t)?t.replace(KK,""):t+PM,t=t.replace(HEe,JEe).replace(WEe,ZEe)):t='""',t}const eTe=/^\s*\{([^}]+)\}\s*$/i;function tTe(e){const t=e.match(eTe);return t&&t[1].trim()||null}const iTe=/^\s*(?:(?:\$feature\.(\w+))|(?:\$feature\[(["'])([\w\s]+)(\2)\]));?\s*$/i,rTe=/^\s*(?:(?:\$feature\.(\w+))|(?:\$feature\[(["'])([\w\s]+)(\2)\]));?\s*(?:DomainName\(\s*\$feature\s*,\s*(["'])(\1|\3)(\5)\s*\));?\s*$/i,nTe=/^\s*(?:DomainName\(\s*\$feature\s*,\s*(["'])([\w\s]+)(\1)\s*\));?\s*$/i;function YK(e){if(!e)return null;let t=iTe.exec(e)||rTe.exec(e);return t?t[1]||t[3]:(t=nTe.exec(e),t?t[2]:null)}var iP;let df=iP=class extends ke{constructor(){super(...arguments),this.expression=null,this.title=null,this.value=null}readExpression(e,t){return t.value?tP(t.value):e}writeExpression(e,t,i){this.value!=null&&(e=tP(this.value)),e!=null&&(t[i]=e)}clone(){return new iP({expression:this.expression,title:this.title,value:this.value})}};g([w({type:String,json:{write:{writerEnsuresNonNull:!0}}})],df.prototype,"expression",void 0),g([We("expression",["expression","value"])],df.prototype,"readExpression",null),g([tt("expression")],df.prototype,"writeExpression",null),g([w({type:String,json:{write:!0,origins:{"web-scene":{write:!1}}}})],df.prototype,"title",void 0),g([w({json:{read:!1,write:!1}})],df.prototype,"value",void 0),df=iP=g([te("esri.layers.support.LabelExpressionInfo")],df);const XK=df,QK=[252,146,31,255],uKe=[153,153,153,255],sTe={type:"esriSMS",style:"esriSMSCircle",size:6,color:QK,outline:{type:"esriSLS",style:"esriSLSSolid",width:.75,color:[153,153,153,255]}},oTe={type:"esriSLS",style:"esriSLSSolid",width:.75,color:QK},aTe={type:"esriSFS",style:"esriSFSSolid",color:[252,146,31,196],outline:{type:"esriSLS",style:"esriSLSSolid",width:.75,color:[255,255,255,191]}},lTe={type:"esriTS",color:[255,255,255,255],font:{family:"arial-unicode-ms",size:10,weight:"bold"},horizontalAlignment:"center",kerning:!0,haloColor:[0,0,0,255],haloSize:1,rotated:!1,text:"",xoffset:0,yoffset:0,angle:0},cTe={type:"esriSMS",style:"esriSMSCircle",color:[0,0,0,255],outline:null,size:10.5},uTe={type:"esriSLS",style:"esriSLSSolid",color:[0,0,0,255],width:1.5},hTe={type:"esriSFS",style:"esriSFSSolid",color:[0,0,0,255],outline:null},pTe=Dn.fromJSON(sTe),dTe=rs.fromJSON(oTe),fTe=ea.fromJSON(aTe),yTe=J0.fromJSON(lTe);function hKe(e){if(ce(e))return null;switch(e.type){case"mesh":return null;case"point":case"multipoint":return pTe;case"polyline":return dTe;case"polygon":case"extent":return fTe}return null}const pKe=Dn.fromJSON(cTe),dKe=rs.fromJSON(uTe),fKe=ea.fromJSON(hTe);var rP;const LM=new kt({esriServerPointLabelPlacementAboveCenter:"above-center",esriServerPointLabelPlacementAboveLeft:"above-left",esriServerPointLabelPlacementAboveRight:"above-right",esriServerPointLabelPlacementBelowCenter:"below-center",esriServerPointLabelPlacementBelowLeft:"below-left",esriServerPointLabelPlacementBelowRight:"below-right",esriServerPointLabelPlacementCenterCenter:"center-center",esriServerPointLabelPlacementCenterLeft:"center-left",esriServerPointLabelPlacementCenterRight:"center-right",esriServerLinePlacementAboveAfter:"above-after",esriServerLinePlacementAboveAlong:"above-along",esriServerLinePlacementAboveBefore:"above-before",esriServerLinePlacementAboveStart:"above-start",esriServerLinePlacementAboveEnd:"above-end",esriServerLinePlacementBelowAfter:"below-after",esriServerLinePlacementBelowAlong:"below-along",esriServerLinePlacementBelowBefore:"below-before",esriServerLinePlacementBelowStart:"below-start",esriServerLinePlacementBelowEnd:"below-end",esriServerLinePlacementCenterAfter:"center-after",esriServerLinePlacementCenterAlong:"center-along",esriServerLinePlacementCenterBefore:"center-before",esriServerLinePlacementCenterStart:"center-start",esriServerLinePlacementCenterEnd:"center-end",esriServerPolygonPlacementAlwaysHorizontal:"always-horizontal"},{ignoreUnknown:!0});function eY(e){var t;return!e||e.origin!=="service"&&((t=e.layer)==null?void 0:t.type)!=="map-image"}function mTe(e){return(e==null?void 0:e.type)==="map-image"}function tY(e){var t,i;return!!mTe(e)&&!!((i=(t=e.capabilities)==null?void 0:t.exportMap)==null?void 0:i.supportsArcadeExpressionForLabeling)}function gTe(e){return eY(e)||tY(e.layer)}let gn=rP=class extends ke{constructor(e){super(e),this.type="label",this.name=null,this.allowOverrun=!1,this.deconflictionStrategy="static",this.labelExpression=null,this.labelExpressionInfo=null,this.labelPlacement=null,this.labelPosition="curved",this.maxScale=0,this.minScale=0,this.repeatLabel=!0,this.repeatLabelDistance=null,this.symbol=yTe,this.useCodedValues=void 0,this.where=null}static evaluateWhere(e,t){const i=(r,n,o)=>{switch(n){case"=":return r==o;case"<>":return r!=o;case">":return r>o;case">=":return r>=o;case"<":return r<o;case"<=":return r<=o}return!1};try{if(e==null)return!0;const r=e.split(" ");if(r.length===3)return i(t[r[0]],r[1],r[2]);if(r.length===7){const n=i(t[r[0]],r[1],r[2]),o=r[3],c=i(t[r[4]],r[5],r[6]);switch(o){case"AND":return n&&c;case"OR":return n||c}}return!1}catch{console.log("Error.: can't parse = "+e)}}readLabelExpression(e,t){const i=t.labelExpressionInfo;if(!i||!i.value&&!i.expression)return e}writeLabelExpression(e,t,i){if(this.labelExpressionInfo){if(this.labelExpressionInfo.value!=null)e=YEe(this.labelExpressionInfo.value);else if(this.labelExpressionInfo.expression!=null){const r=YK(this.labelExpressionInfo.expression);r&&(e="["+r+"]")}}e!=null&&(t[i]=e)}writeLabelExpressionInfo(e,t,i,r){if(e==null&&this.labelExpression!=null&&eY(r))e=new XK({expression:this.getLabelExpressionArcade()});else if(!e)return;const n=e.toJSON(r);n.expression&&(t[i]=n)}writeMaxScale(e,t){(e||this.minScale)&&(t.maxScale=e)}writeMinScale(e,t){(e||this.maxScale)&&(t.minScale=e)}getLabelExpression(){return eP(this)}getLabelExpressionArcade(){return XEe(this)}getLabelExpressionSingleField(){return QEe(this)}hash(){return JSON.stringify(this)}clone(){return new rP({allowOverrun:this.allowOverrun,deconflictionStrategy:this.deconflictionStrategy,labelExpression:this.labelExpression,labelExpressionInfo:_e(this.labelExpressionInfo),labelPosition:this.labelPosition,labelPlacement:this.labelPlacement,maxScale:this.maxScale,minScale:this.minScale,name:this.name,repeatLabel:this.repeatLabel,repeatLabelDistance:this.repeatLabelDistance,symbol:_e(this.symbol),where:this.where,useCodedValues:this.useCodedValues})}};g([w({type:String,json:{write:!0}})],gn.prototype,"name",void 0),g([w({type:Boolean,json:{write:!0,default:!1,origins:{"web-scene":{write:!1}}}})],gn.prototype,"allowOverrun",void 0),g([w({type:String,json:{write:!0,default:"static",origins:{"web-scene":{write:!1}}}})],gn.prototype,"deconflictionStrategy",void 0),g([w({type:String,json:{write:{overridePolicy(e,t,i){return this.labelExpressionInfo&&(i==null?void 0:i.origin)==="service"&&tY(i.layer)?{enabled:!1}:{allowNull:!0}}}}})],gn.prototype,"labelExpression",void 0),g([We("labelExpression")],gn.prototype,"readLabelExpression",null),g([tt("labelExpression")],gn.prototype,"writeLabelExpression",null),g([w({type:XK,json:{write:{overridePolicy:(e,t,i)=>gTe(i)?{allowNull:!0}:{enabled:!1}}}})],gn.prototype,"labelExpressionInfo",void 0),g([tt("labelExpressionInfo")],gn.prototype,"writeLabelExpressionInfo",null),g([w({type:LM.apiValues,json:{type:LM.jsonValues,read:LM.read,write:LM.write}})],gn.prototype,"labelPlacement",void 0),g([w({type:["curved","parallel"],json:{write:!0,origins:{"web-map":{write:!1},"web-scene":{write:!1},"portal-item":{write:!1}}}})],gn.prototype,"labelPosition",void 0),g([w({type:Number})],gn.prototype,"maxScale",void 0),g([tt("maxScale")],gn.prototype,"writeMaxScale",null),g([w({type:Number})],gn.prototype,"minScale",void 0),g([tt("minScale")],gn.prototype,"writeMinScale",null),g([w({type:Boolean,json:{write:!0,origins:{"web-scene":{write:!1},"portal-item":{write:!1}}}})],gn.prototype,"repeatLabel",void 0),g([w({type:Number,cast:Fi,json:{write:!0,origins:{"web-scene":{write:!1}}}})],gn.prototype,"repeatLabelDistance",void 0),g([w({types:kwe,json:{origins:{"web-scene":{types:Awe,write:AZ,default:null}},write:AZ,default:null}})],gn.prototype,"symbol",void 0),g([w({type:Boolean,json:{write:!0}})],gn.prototype,"useCodedValues",void 0),g([w({type:String,json:{write:!0}})],gn.prototype,"where",void 0),gn=rP=g([te("esri.layers.support.LabelClass")],gn);const C2=gn;var nP;const sP=ad({types:j5}),vTe="esri.layers.support.FeatureReductionBinning";let fa=nP=class extends pf{constructor(e){super(e),this.type="binning",this.binType="geohash",this.fixedBinLevel=3,this.labelingInfo=null,this.labelsVisible=!0,this.popupEnabled=!0,this.popupTemplate=null,this.fields=[],this.renderer=null}writeFields(e,t,i){const r=e.filter(n=>n.statisticType!=="avg_angle").map(n=>n.toJSON());eo(i,r,t)}readRenderer(e,t,i){var n,o;const r=(n=t.drawingInfo)==null?void 0:n.renderer;return r?(o=_2(r,t,i))!=null?o:void 0:t.defaultSymbol?t.types&&t.types.length?new b2({defaultSymbol:sP(t.defaultSymbol,t,i),field:t.typeIdField,uniqueValueInfos:t.types.map(c=>({id:c.id,symbol:sP(c.symbol,c,i)}))}):new C1({symbol:sP(t.defaultSymbol,t,i)}):null}clone(){return new nP({fields:_e(this.fields),fixedBinLevel:this.fixedBinLevel,labelingInfo:_e(this.labelingInfo),labelsVisible:this.labelsVisible,popupEnabled:this.popupEnabled,popupTemplate:_e(this.popupTemplate),renderer:_e(this.renderer)})}};g([Pt({binning:"binning"})],fa.prototype,"type",void 0),g([Pt({geohash:"geohash"})],fa.prototype,"binType",void 0),g([w({type:Number,range:{min:1,max:9},json:{write:!0}})],fa.prototype,"fixedBinLevel",void 0),g([w({type:[C2],json:{read:{source:"drawingInfo.labelingInfo"},write:{target:"drawingInfo.labelingInfo"}}})],fa.prototype,"labelingInfo",void 0),g([w(q8)],fa.prototype,"labelsVisible",void 0),g([w(CM)],fa.prototype,"popupEnabled",void 0),g([w({type:_d,json:{name:"popupInfo",write:!0}})],fa.prototype,"popupTemplate",void 0),g([w({type:[Ry],json:{write:!0}})],fa.prototype,"fields",void 0),g([tt("fields")],fa.prototype,"writeFields",null),g([w({types:w2,json:{write:{target:"drawingInfo.renderer"}}})],fa.prototype,"renderer",void 0),g([We("renderer",["drawingInfo.renderer"])],fa.prototype,"readRenderer",null),fa=nP=g([te(vTe)],fa);const iY=fa;var oP;const aP=ad({types:j5}),bTe="esri.layers.support.FeatureReductionCluster";function rY(e){var t;return e.type==="simple"&&!((t=e.visualVariables)==null?void 0:t.length)}let ps=oP=class extends ke{constructor(e){super(e),this.type="cluster",this.clusterRadius=Fi("80px"),this.clusterMinSize=Fi("12px"),this.clusterMaxSize=Fi("50px"),this.popupEnabled=!0,this.popupTemplate=null,this.renderer=null,this.symbol=null,this.labelingInfo=null,this.labelsVisible=!0,this.fields=null}readRenderer(e,t,i){var n,o,c;const r=(n=t.drawingInfo)==null?void 0:n.renderer;return((o=r==null?void 0:r.authoringInfo)==null?void 0:o.isAutoGenerated)?null:r?rY(r)?null:(c=_2(r,t,i))!=null?c:void 0:t.defaultSymbol?t.types&&t.types.length?new b2({defaultSymbol:aP(t.defaultSymbol,t,i),field:t.typeIdField,uniqueValueInfos:t.types.map(h=>({id:h.id,symbol:aP(h.symbol,h,i)}))}):new C1({symbol:aP(t.defaultSymbol,t,i)}):null}readSymbol(e,t,i){var n,o,c;const r=(n=t.drawingInfo)==null?void 0:n.renderer;return((o=r==null?void 0:r.authoringInfo)==null?void 0:o.isAutoGenerated)?null:r&&rY(r)?(c=_2(r,t,i))==null?void 0:c.symbol:null}writeSymbol(e,t,i,r){var o,c;const n=(c=(o=this.renderer)==null?void 0:o.authoringInfo)==null?void 0:c.isAutoGenerated;if(!this.renderer||n){const h=new C1({symbol:e});t.drawingInfo={renderer:h.write({},r)}}}writeFields(e,t,i){const r=e.filter(n=>n.statisticType!=="avg_angle").map(n=>n.toJSON());eo(i,r,t)}readFields(e,t,i){return e.filter(r=>!r.isAutoGenerated).map(r=>Ry.fromJSON(r))}clone(){return new oP({clusterRadius:this.clusterRadius,clusterMinSize:this.clusterMinSize,clusterMaxSize:this.clusterMaxSize,labelingInfo:_e(this.labelingInfo),labelsVisible:this.labelsVisible,fields:_e(this.fields),renderer:_e(this.renderer),symbol:_e(this.symbol),popupEnabled:this.popupEnabled,popupTemplate:_e(this.popupTemplate)})}};g([w({type:["cluster"],readOnly:!0,json:{write:!0}})],ps.prototype,"type",void 0),g([w({type:Number,cast:e=>e==="auto"?e:Fi(e),json:{write:!0}})],ps.prototype,"clusterRadius",void 0),g([w({type:Number,cast:Fi,json:{write:!0}})],ps.prototype,"clusterMinSize",void 0),g([w({type:Number,cast:Fi,json:{write:!0}})],ps.prototype,"clusterMaxSize",void 0),g([w(CM)],ps.prototype,"popupEnabled",void 0),g([w({type:_d,json:{read:{source:"popupInfo"},write:{target:"popupInfo"}}})],ps.prototype,"popupTemplate",void 0),g([w({types:w2,json:{write:{target:"drawingInfo.renderer"}}})],ps.prototype,"renderer",void 0),g([We("renderer",["drawingInfo.renderer"])],ps.prototype,"readRenderer",null),g([w({types:Twe})],ps.prototype,"symbol",void 0),g([We("symbol",["drawingInfo.renderer"])],ps.prototype,"readSymbol",null),g([tt("symbol")],ps.prototype,"writeSymbol",null),g([w({type:[C2],json:{read:{source:"drawingInfo.labelingInfo"},write:{target:"drawingInfo.labelingInfo"}}})],ps.prototype,"labelingInfo",void 0),g([w(q8)],ps.prototype,"labelsVisible",void 0),g([w({type:[Ry],json:{write:!0}})],ps.prototype,"fields",void 0),g([tt("fields")],ps.prototype,"writeFields",null),g([We("fields")],ps.prototype,"readFields",null),ps=oP=g([te(bTe)],ps);const nY=ps;var lP;let OM=lP=class extends pf{constructor(e){super(e),this.type="selection"}clone(){return new lP}};g([w({type:["selection"]})],OM.prototype,"type",void 0),OM=lP=g([te("esri.layers.support.FeatureReductionSelection")],OM);const sY=OM,oY={key:"type",base:pf,typeMap:{cluster:nY,binning:iY}},wTe={types:{key:"type",base:pf,typeMap:{selection:sY,cluster:nY,binning:iY}},json:{name:"layerDefinition.featureReduction",write:{allowNull:!0},origins:{"web-map":{types:oY},"portal-item":{types:oY},"web-scene":{types:{key:"type",base:pf,typeMap:{selection:sY}}}}}},V1={Base64:0,Hex:1,String:2,Raw:3},z1=8,aY=(1<<z1)-1;function ff(e,t){const i=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(i>>16)<<16|65535&i}function _Te(e){const t=[];for(let i=0,r=e.length*z1;i<r;i+=z1)t[i>>5]|=(e.charCodeAt(i/z1)&aY)<<i%32;return t}function xTe(e){const t=[];for(let i=0,r=32*e.length;i<r;i+=z1)t.push(String.fromCharCode(e[i>>5]>>>i%32&aY));return t.join("")}function STe(e){const t="0123456789abcdef",i=[];for(let r=0,n=4*e.length;r<n;r++)i.push(t.charAt(e[r>>2]>>r%4*8+4&15)+t.charAt(e[r>>2]>>r%4*8&15));return i.join("")}function MTe(e){const t="=",i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",r=[];for(let n=0,o=4*e.length;n<o;n+=3){const c=(e[n>>2]>>n%4*8&255)<<16|(e[n+1>>2]>>(n+1)%4*8&255)<<8|e[n+2>>2]>>(n+2)%4*8&255;for(let h=0;h<4;h++)8*n+6*h>32*e.length?r.push(t):r.push(i.charAt(c>>6*(3-h)&63))}return r.join("")}function ITe(e,t){return e<<t|e>>>32-t}function RM(e,t,i,r,n,o){return ff(ITe(ff(ff(t,e),ff(r,o)),n),i)}function uo(e,t,i,r,n,o,c){return RM(t&i|~t&r,e,t,n,o,c)}function ho(e,t,i,r,n,o,c){return RM(t&r|i&~r,e,t,n,o,c)}function po(e,t,i,r,n,o,c){return RM(t^i^r,e,t,n,o,c)}function fo(e,t,i,r,n,o,c){return RM(i^(t|~r),e,t,n,o,c)}function $Te(e,t){e[t>>5]|=128<<t%32,e[14+(t+64>>>9<<4)]=t;let i=1732584193,r=-271733879,n=-1732584194,o=271733878;for(let c=0;c<e.length;c+=16){const h=i,m=r,b=n,x=o;i=uo(i,r,n,o,e[c+0],7,-680876936),o=uo(o,i,r,n,e[c+1],12,-389564586),n=uo(n,o,i,r,e[c+2],17,606105819),r=uo(r,n,o,i,e[c+3],22,-1044525330),i=uo(i,r,n,o,e[c+4],7,-176418897),o=uo(o,i,r,n,e[c+5],12,1200080426),n=uo(n,o,i,r,e[c+6],17,-1473231341),r=uo(r,n,o,i,e[c+7],22,-45705983),i=uo(i,r,n,o,e[c+8],7,1770035416),o=uo(o,i,r,n,e[c+9],12,-1958414417),n=uo(n,o,i,r,e[c+10],17,-42063),r=uo(r,n,o,i,e[c+11],22,-1990404162),i=uo(i,r,n,o,e[c+12],7,1804603682),o=uo(o,i,r,n,e[c+13],12,-40341101),n=uo(n,o,i,r,e[c+14],17,-1502002290),r=uo(r,n,o,i,e[c+15],22,1236535329),i=ho(i,r,n,o,e[c+1],5,-165796510),o=ho(o,i,r,n,e[c+6],9,-1069501632),n=ho(n,o,i,r,e[c+11],14,643717713),r=ho(r,n,o,i,e[c+0],20,-373897302),i=ho(i,r,n,o,e[c+5],5,-701558691),o=ho(o,i,r,n,e[c+10],9,38016083),n=ho(n,o,i,r,e[c+15],14,-660478335),r=ho(r,n,o,i,e[c+4],20,-405537848),i=ho(i,r,n,o,e[c+9],5,568446438),o=ho(o,i,r,n,e[c+14],9,-1019803690),n=ho(n,o,i,r,e[c+3],14,-187363961),r=ho(r,n,o,i,e[c+8],20,1163531501),i=ho(i,r,n,o,e[c+13],5,-1444681467),o=ho(o,i,r,n,e[c+2],9,-51403784),n=ho(n,o,i,r,e[c+7],14,1735328473),r=ho(r,n,o,i,e[c+12],20,-1926607734),i=po(i,r,n,o,e[c+5],4,-378558),o=po(o,i,r,n,e[c+8],11,-2022574463),n=po(n,o,i,r,e[c+11],16,1839030562),r=po(r,n,o,i,e[c+14],23,-35309556),i=po(i,r,n,o,e[c+1],4,-1530992060),o=po(o,i,r,n,e[c+4],11,1272893353),n=po(n,o,i,r,e[c+7],16,-155497632),r=po(r,n,o,i,e[c+10],23,-1094730640),i=po(i,r,n,o,e[c+13],4,681279174),o=po(o,i,r,n,e[c+0],11,-358537222),n=po(n,o,i,r,e[c+3],16,-722521979),r=po(r,n,o,i,e[c+6],23,76029189),i=po(i,r,n,o,e[c+9],4,-640364487),o=po(o,i,r,n,e[c+12],11,-421815835),n=po(n,o,i,r,e[c+15],16,530742520),r=po(r,n,o,i,e[c+2],23,-995338651),i=fo(i,r,n,o,e[c+0],6,-198630844),o=fo(o,i,r,n,e[c+7],10,1126891415),n=fo(n,o,i,r,e[c+14],15,-1416354905),r=fo(r,n,o,i,e[c+5],21,-57434055),i=fo(i,r,n,o,e[c+12],6,1700485571),o=fo(o,i,r,n,e[c+3],10,-1894986606),n=fo(n,o,i,r,e[c+10],15,-1051523),r=fo(r,n,o,i,e[c+1],21,-2054922799),i=fo(i,r,n,o,e[c+8],6,1873313359),o=fo(o,i,r,n,e[c+15],10,-30611744),n=fo(n,o,i,r,e[c+6],15,-1560198380),r=fo(r,n,o,i,e[c+13],21,1309151649),i=fo(i,r,n,o,e[c+4],6,-145523070),o=fo(o,i,r,n,e[c+11],10,-1120210379),n=fo(n,o,i,r,e[c+2],15,718787259),r=fo(r,n,o,i,e[c+9],21,-343485551),i=ff(i,h),r=ff(r,m),n=ff(n,b),o=ff(o,x)}return[i,r,n,o]}function lY(e,t=V1.Hex){const i=t||V1.Base64,r=$Te(_Te(e),e.length*z1);switch(i){case V1.Raw:return r;case V1.Hex:return STe(r);case V1.String:return xTe(r);case V1.Base64:return MTe(r)}}var cP;let k2=cP=class extends f2{writeLevels(e,t,i){for(const r in e){const n=this.levels[r];return void(t.stops=n)}}clone(){return new cP({axis:this.axis,field:this.field,valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle,maxDataValue:this.maxDataValue,maxSize:of(this.maxSize)?this.maxSize.clone():this.maxSize,minDataValue:this.minDataValue,minSize:of(this.minSize)?this.minSize.clone():this.minSize,normalizationField:this.normalizationField,stops:this.stops&&this.stops.map(e=>e.clone()),target:this.target,useSymbolValue:this.useSymbolValue,valueRepresentation:this.valueRepresentation,valueUnit:this.valueUnit,legendOptions:this.legendOptions&&this.legendOptions.clone(),levels:_e(this.levels)})}};g([w()],k2.prototype,"levels",void 0),g([tt("levels")],k2.prototype,"writeLevels",null),k2=cP=g([te("esri.views.2d.engine.LevelDependentSizeVariable")],k2);const ETe=$e.getLogger("esri.views.2d.layers.support.clusterUtils");Te.add("esri-cluster-arcade-enabled",!0);const TTe=Te("esri-cluster-arcade-enabled"),CTe=(e,t,i,r,n)=>{const o=t.clone();if(!ATe(o))return o;if(o.authoringInfo||(o.authoringInfo=new RA),o.authoringInfo.isAutoGenerated=!0,"visualVariables"in o){const c=(o.visualVariables||[]).filter(m=>m.valueExpression!=="$view.scale"),h=cY(c);c.forEach(m=>{m.type==="rotation"?m.field?m.field=Fy(e,m.field,"avg_angle","number"):m.valueExpression&&(m.field=A2(e,m.valueExpression,"avg_angle","number"),m.valueExpression=null):m.normalizationField?(m.field=Fy(e,m.field,"avg_norm","number",m.normalizationField),m.normalizationField=null):m.field?m.field=Fy(e,m.field,"avg","number"):m.valueExpression&&(m.field=A2(e,m.valueExpression,"avg","number"),m.valueExpression=null)}),ce(h)&&!kTe(c)&&n&&(c.push(uY(i,r)),o.dynamicClusterSize=!0),o.visualVariables=c}switch(o.type){case"simple":break;case"pie-chart":for(const c of o.attributes)c.field?c.field=Fy(e,c.field,"sum","number"):c.valueExpression&&(c.field=A2(e,c.valueExpression,"sum","number"),c.valueExpression=null);break;case"unique-value":o.field?o.field=Fy(e,o.field,"mode","string"):o.valueExpression&&(o.field=A2(e,o.valueExpression,"mode","string"),o.valueExpression=null);break;case"class-breaks":o.normalizationField?(o.field=Fy(e,o.field,"avg_norm","number",o.normalizationField),o.normalizationField=null):o.field?o.field=Fy(e,o.field,"avg","number"):o.valueExpression&&(o.field=A2(e,o.valueExpression,"avg","number"),o.valueExpression=null)}return o},cY=e=>{for(const t of e)if(t.type==="size")return t;return null};function yKe(e,t,i){const r=e.clone();let n=!1;if("visualVariables"in r){const o=(r.visualVariables||[]).filter(h=>h.valueExpression!=="$view.scale"),c=cY(o);ce(c)&&(r.visualVariables||(r.visualVariables=[]),r.visualVariables.push(uY(t,i)),r.dynamicClusterSize=!0,n=!0)}return{renderer:r,didInject:n}}const kTe=e=>{for(const t of e)if(t.field==="cluster_count")return!0;return!1},uY=(e,t)=>{const i=[new x1({value:0,size:0}),new x1({value:1})];if(ce(t))return new f2({field:"cluster_count",stops:[...i,new x1({value:2,size:0})]});const r=Object.keys(t).reduce((n,o)=>Ce(K({},n),{[o]:[...i,new x1({value:Math.max(2,t[o].minValue),size:e.clusterMinSize}),new x1({value:Math.max(3,t[o].maxValue),size:e.clusterMaxSize})]}),{});return new k2({field:"cluster_count",levels:r})},ATe=e=>{const t=i=>ETe.error(new ue("Unsupported-renderer",i,{renderer:e}));switch(e.type){case"unique-value":if(e.field2||e.field3)return t("FeatureReductionCluster does not support multi-field UniqueValueRenderers"),!1;break;case"class-breaks":if(e.normalizationField){const i=e.normalizationType;if(i!=="field")return t(`FeatureReductionCluster does not support a normalizationType of ${i}`),!1;break}case"simple":case"pie-chart":break;default:return t(`FeatureReductionCluster does not support renderers of type ${e.type}`),!1}if(!TTe){if("valueExpression"in e&&e.valueExpression)return t("FeatureReductionCluster does not currently support renderer.valueExpression. Support will be added in a future release"),!1;if(("visualVariables"in e&&e.visualVariables||[]).some(i=>!(!("valueExpression"in i)||!i.valueExpression)))return t("FeatureReductionCluster does not currently support visualVariables with a valueExpression. Support will be added in a future release"),!1}return!0};function PTe(e,t,i){switch(e){case"sum":return`cluster_sum_${t}`;case"avg":case"avg_angle":return`cluster_avg_${t}`;case"mode":return`cluster_type_${t}`;case"avg_norm":{const r=i,n="field",o=t.toLowerCase()+",norm:"+n+","+r.toLowerCase();return"cluster_avg_"+lY(o)}}}function A2(e,t,i,r){const n=lY(t),o=i==="mode"?`cluster_type_${n}`:i==="sum"?`cluster_sum_${n}`:`cluster_avg_${n}`;return e.some(c=>c.name===o)||e.push(new Ry({name:o,isAutoGenerated:!0,onStatisticExpression:new K8({expression:t,returnType:r}),statisticType:i})),o}function Fy(e,t,i,r,n){if(t==="cluster_count"||e.some(c=>c.name===t))return t;const o=PTe(i,t,n);return e.some(c=>c.name===o)||(i==="avg_norm"?e.push(new Ry({name:o,isAutoGenerated:!0,onStatisticExpression:new K8({expression:`$feature.${t} / $feature.${n}`,returnType:r}),statisticType:"avg"})):e.push(new Ry({name:o,isAutoGenerated:!0,onStatisticField:t,statisticType:i}))),o}const LTe=e=>{let t=class extends e{constructor(...i){super(...i),this.own(this.watch("renderer",()=>{if(this.featureReduction){const r=this._normalizeFeatureReduction(this.featureReduction);this._set("featureReduction",r)}},!0))}set featureReduction(i){const r=this._normalizeFeatureReduction(i);this._set("featureReduction",r)}set renderer(i){}_normalizeFeatureReduction(i){var h,m;if((i==null?void 0:i.type)!=="cluster")return i;const r=i.clone(),n=[new Ry({name:"cluster_count",isAutoGenerated:!0,statisticType:"count"})],o=((h=r.fields)!=null?h:[]).filter(b=>!b.isAutoGenerated);if(i.renderer&&!((m=i.renderer.authoringInfo)==null?void 0:m.isAutoGenerated))return r.fields=[...n,...o],r;if(i.symbol)return r.fields=[...n,...o],r.renderer=null,r;if(!this.renderer)return i;const c=CTe(n,this.renderer,i,null,!1);return r.fields=[...n,...o],r.renderer=c,r}};return g([w(wTe)],t.prototype,"featureReduction",null),t=g([te("esri.layers.mixins.FeatureReductionLayer")],t),t},OTe={"web-scene/operational-layers":{ArcGISDimensionLayer:!0,ArcGISFeatureLayer:!0,ArcGISImageServiceLayer:!0,ArcGISMapServiceLayer:!0,ArcGISSceneServiceLayer:!0,ArcGISTiledElevationServiceLayer:!0,ArcGISTiledImageServiceLayer:!0,ArcGISTiledMapServiceLayer:!0,BuildingSceneLayer:!0,GroupLayer:!0,IntegratedMeshLayer:!0,OGCFeatureLayer:!0,PointCloudLayer:!0,WebTiledLayer:!0,CSV:!0,GeoJSON:!0,VectorTileLayer:!0,WFS:!0,WMS:!0,KML:!0,RasterDataLayer:!0,Voxel:!0,LineOfSightLayer:!0},"web-scene/basemap":{ArcGISTiledImageServiceLayer:!0,ArcGISTiledMapServiceLayer:!0,WebTiledLayer:!0,OpenStreetMap:!0,VectorTileLayer:!0,ArcGISImageServiceLayer:!0,WMS:!0,ArcGISMapServiceLayer:!0},"web-scene/ground":{ArcGISTiledElevationServiceLayer:!0,RasterDataElevationLayer:!0},"web-map/operational-layers":{ArcGISAnnotationLayer:!0,ArcGISDimensionLayer:!0,ArcGISFeatureLayer:!0,ArcGISImageServiceLayer:!0,ArcGISImageServiceVectorLayer:!0,ArcGISMapServiceLayer:!0,ArcGISStreamLayer:!0,ArcGISTiledImageServiceLayer:!0,ArcGISTiledMapServiceLayer:!0,BingMapsAerial:!0,BingMapsHybrid:!0,BingMapsRoad:!0,CSV:!0,GeoRSS:!0,GeoJSON:!0,GroupLayer:!0,KML:!0,OGCFeatureLayer:!0,OrientedImageryLayer:!0,SubtypeGroupLayer:!0,VectorTileLayer:!0,WFS:!0,WMS:!0,WebTiledLayer:!0},"web-map/basemap":{ArcGISImageServiceLayer:!0,ArcGISImageServiceVectorLayer:!0,ArcGISMapServiceLayer:!0,ArcGISTiledImageServiceLayer:!0,ArcGISTiledMapServiceLayer:!0,OpenStreetMap:!0,VectorTileLayer:!0,WMS:!0,WebTiledLayer:!0,BingMapsAerial:!0,BingMapsRoad:!0,BingMapsHybrid:!0},"web-map/tables":{ArcGISFeatureLayer:!0},"portal-item/operational-layers":{ArcGISFeatureLayer:!0,ArcGISSceneServiceLayer:!0,PointCloudLayer:!0,BuildingSceneLayer:!0,IntegratedMeshLayer:!0,OrientedImageryLayer:!0}},uP=e=>{let t=class extends e{constructor(){super(...arguments),this.title=null}writeListMode(i,r,n,o){(o&&o.layerContainerType==="ground"||i&&xme(this,n,{},o))&&(r[n]=i)}writeOperationalLayerType(i,r,n,o){!i||o&&o.layerContainerType==="tables"||(r.layerType=i)}writeTitle(i,r){r.title=i!=null?i:"Layer"}read(i,r){r&&(r.layer=this),bme(this,i,n=>super.read(i,n),r)}write(i,r){var c,h;if(r==null?void 0:r.origin){const m=`${r.origin}/${r.layerContainerType||"operational-layers"}`,b=OTe[m];let x=b&&b[this.operationalLayerType];if(this.operationalLayerType==="ArcGISTiledElevationServiceLayer"&&m==="web-scene/operational-layers"&&(x=!1),this.operationalLayerType==="ArcGISDimensionLayer"&&m==="web-map/operational-layers"&&(x=!1),!x)return(c=r.messages)==null||c.push(new ue("layer:unsupported",`Layers (${this.title}, ${this.id}) of type '${this.declaredClass}' are not supported in the context of '${m}'`,{layer:this})),null}const n=super.write(i,Ce(K({},r),{layer:this})),o=!!r&&!!r.messages&&!!r.messages.filter(m=>m instanceof ue&&m.name==="web-document-write:property-required").length;return S5(n==null?void 0:n.url)?((h=r==null?void 0:r.messages)==null||h.push(new ue("layer:invalid-url",`Layer (${this.title}, ${this.id}) of type '${this.declaredClass}' using a Blob URL cannot be written to web scenes and web maps`,{layer:this})),null):!this.url&&o?null:n}beforeSave(){}};return g([w({type:String,json:{write:{ignoreOrigin:!0},origins:{"web-scene":{write:{isRequired:!0,ignoreOrigin:!0}},"portal-item":{write:!1}}}})],t.prototype,"id",void 0),g([w(zK)],t.prototype,"listMode",void 0),g([tt("listMode")],t.prototype,"writeListMode",null),g([w({type:String,readOnly:!0,json:{read:!1,write:{target:"layerType",ignoreOrigin:!0},origins:{"portal-item":{write:!1}}}})],t.prototype,"operationalLayerType",void 0),g([tt("operationalLayerType")],t.prototype,"writeOperationalLayerType",null),g([w(kM)],t.prototype,"opacity",void 0),g([w({type:String,json:{write:{ignoreOrigin:!0,writerEnsuresNonNull:!0},origins:{"web-scene":{write:{isRequired:!0,ignoreOrigin:!0,writerEnsuresNonNull:!0}},"portal-item":{write:!1}}},value:"Layer"})],t.prototype,"title",void 0),g([tt("title"),tt(["web-scene"],"title")],t.prototype,"writeTitle",null),g([w({type:Boolean,json:{name:"visibility"}})],t.prototype,"visible",void 0),t=g([te("esri.layers.mixins.OperationalLayer")],t),t};var hP;const pP=new kt({asc:"ascending",desc:"descending"});let G1=hP=class extends ke{constructor(e){super(e),this.field=null,this.valueExpression=null,this.order="ascending"}clone(){return new hP({field:this.field,valueExpression:this.valueExpression,order:this.order})}};g([w({type:String,json:{write:!0}})],G1.prototype,"field",void 0),g([w({type:String,json:{write:!0}})],G1.prototype,"valueExpression",void 0),g([w({type:pP.apiValues,json:{read:pP.read,write:pP.write}})],G1.prototype,"order",void 0),G1=hP=g([te("esri.layers.support.OrderByInfo")],G1);const hY=G1;function RTe(e,t,i){if(!e)return null;const r=e.find(o=>!!o.field);if(!r)return null;const n=new hY;return n.read(r,i),[n]}function FTe(e,t,i,r){const n=e.find(o=>!!o.field);n&&eo(i,[n.toJSON()],t)}const NTe=e=>{let t=class extends e{constructor(){super(...arguments),this.orderBy=null}};return g([w({type:[hY],json:{origins:{"web-scene":{write:!1,read:!1}},read:{source:"layerDefinition.orderBy",reader:RTe},write:{target:"layerDefinition.orderBy",writer:FTe}}})],t.prototype,"orderBy",void 0),t=g([te("esri.layers.mixins.OrderedLayer")],t),t},dP=e=>{let t=class extends e{constructor(){super(...arguments),this.resourceReferences={portalItem:null,paths:[]},this.userHasEditingPrivileges=!0}destroy(){this.portalItem=li(this.portalItem)}set portalItem(i){i!==this._get("portalItem")&&(this.removeOrigin("portal-item"),this._set("portalItem",i))}readPortalItem(i,r,n){if(r.itemId)return new b_({id:r.itemId,portal:n&&n.portal})}writePortalItem(i,r){i&&i.id&&(r.itemId=i.id)}async loadFromPortal(i,r){if(this.portalItem&&this.portalItem.id)try{const n=await import("./layersLoader.a4a07382.js").then(function(o){return o.l});return ur(r),await n.load({instance:this,supportedTypes:i.supportedTypes,validateItem:i.validateItem,supportsData:i.supportsData,layerModuleTypeMap:i.layerModuleTypeMap},r)}catch(n){throw Xn(n)||$e.getLogger(this.declaredClass).warn(`Failed to load layer (${this.title}, ${this.id}) portal item (${this.portalItem.id})
  ${n}`),n}}async finishLoadEditablePortalLayer(i){this._set("userHasEditingPrivileges",await this._fetchUserHasEditingPrivileges(i).catch(r=>(f0(r),!0)))}async _fetchUserHasEditingPrivileges(i){const r=this.url?tr==null?void 0:tr.findCredential(this.url):null;if(!r)return!0;const n=FM.credential===r?FM.user:await this._fetchEditingUser(i);return FM.credential=r,FM.user=n,ce(n)||n.privileges==null||n.privileges.includes("features:user:edit")}async _fetchEditingUser(i){var x,I,E;const r=(I=(x=this.portalItem)==null?void 0:x.portal)==null?void 0:I.user;if(r)return r;const n=tr.findServerInfo((E=this.url)!=null?E:"");if(!(n==null?void 0:n.owningSystemUrl))return null;const o=`${n.owningSystemUrl}/sharing/rest`,c=nn.getDefault();if(c&&c.loaded&&zs(c.restUrl)===zs(o))return c.user;const h=`${o}/community/self`,m=H(i)?i.signal:null,b=await V5(Nt(h,{authMode:"no-prompt",query:{f:"json"},signal:m}));return b.ok?PC.fromJSON(b.value.data):null}read(i,r){r&&(r.layer=this),super.read(i,r)}write(i,r){const n=r&&r.portal,o=this.portalItem&&this.portalItem.id&&(this.portalItem.portal||nn.getDefault());return n&&o&&!rB(o.restUrl,n.restUrl)?(r.messages&&r.messages.push(new ue("layer:cross-portal",`The layer '${this.title} (${this.id})' cannot be persisted because it refers to an item on a different portal than the one being saved to. To save, set layer.portalItem to null or save to the same portal as the item associated with the layer`,{layer:this})),null):super.write(i,Ce(K({},r),{layer:this}))}};return g([w({type:b_})],t.prototype,"portalItem",null),g([We("web-document","portalItem",["itemId"])],t.prototype,"readPortalItem",null),g([tt("web-document","portalItem",{itemId:{type:String}})],t.prototype,"writePortalItem",null),g([w({clonable:!1})],t.prototype,"resourceReferences",void 0),g([w({readOnly:!0})],t.prototype,"userHasEditingPrivileges",void 0),t=g([te("esri.layers.mixins.PortalLayer")],t),t},FM={credential:null,user:null};let P2=class extends Ye{constructor(){super(...arguments),this.updating=!1,this.status="unknown"}};g([w()],P2.prototype,"updating",void 0),g([w()],P2.prototype,"status",void 0),P2=g([te("esri.layers.support.PublishingInfo")],P2);const DTe=P2,jTe="esri.layers.mixins.PublishableLayer",VTe=e=>{let t=class extends e{get publishingInfo(){if(this.destroyed)return null;const i=this._get("publishingInfo");if(i)return i;const r=new DTe;return this._checkPublishingStatus(r),r}_checkPublishingStatus(i){const r=250,n=125;let o=0;const c=async m=>{let b;i.updating=!0;try{b=await this.fetchPublishingStatus()}catch{b="unavailable"}b!=="published"&&b!=="unavailable"||(i.status==="publishing"&&this.refresh(),h.remove()),i.status=b,i.updating=!1,h.removed||(o=setTimeout(c,m,m+n))},h={removed:!1,remove(){this.removed=!0,clearTimeout(o)}};this.when().catch(()=>h.remove()),c(r),this.own(h)}};return g([w({readOnly:!0,clonable:!1})],t.prototype,"publishingInfo",null),t=g([te(jTe)],t),t},L2=new Xe,O2=new WeakMap;function zTe(e){pY(e)&&L2.push(e)}function GTe(e){pY(e)&&L2.includes(e)&&L2.remove(e)}function pY(e){return e!=null&&typeof e=="object"&&"refreshInterval"in e&&"refresh"in e}function dY(e,t){return Number.isFinite(e)&&Number.isFinite(t)?t<=0?e:dY(t,e%t):0}let fP=0,NM=0;function BTe(){var t;const e=Date.now();for(const i of L2)i.refreshInterval&&e-((t=O2.get(i))!=null?t:0)+5>=6e4*i.refreshInterval&&(O2.set(i,e),i.refresh(e))}VV(()=>{const e=Date.now();let t=0;for(const i of L2)t=dY(Math.round(6e4*i.refreshInterval),t),i.refreshInterval?O2.get(i)||O2.set(i,e):O2.delete(i);if(t!==NM){if(NM=t,clearInterval(fP),NM===0)return void(fP=0);fP=setInterval(BTe,NM)}});const yP=e=>{let t=class extends e{constructor(...i){super(...i),this.refreshInterval=0,this.refreshTimestamp=0,this._debounceHasDataChanged=hw(()=>this.hasDataChanged()),this.when().then(()=>{zTe(this)},()=>{})}destroy(){GTe(this)}get refreshParameters(){return{_ts:this.refreshTimestamp||null}}refresh(i=Date.now()){dh(this._debounceHasDataChanged()).then(r=>{r&&this._set("refreshTimestamp",i),this.emit("refresh",{dataChanged:r})},r=>{$e.getLogger(this.declaredClass).error(r),this.emit("refresh",{dataChanged:!1,error:r})})}async hasDataChanged(){return!0}};return g([w({type:Number,cast:i=>i>=.1?i:i<=0?0:.1,json:{write:!0}})],t.prototype,"refreshInterval",void 0),g([w({readOnly:!0})],t.prototype,"refreshTimestamp",void 0),g([w()],t.prototype,"refreshParameters",null),t=g([te("esri.layers.mixins.RefreshableLayer")],t),t},DM=e=>{let t=class extends e{constructor(){super(...arguments),this.minScale=0,this.maxScale=0}get effectiveScaleRange(){const i={minScale:this.minScale,maxScale:this.maxScale},r=this.parent;r&&"effectiveScaleRange"in r&&UTe(i,r.effectiveScaleRange);const n=this._get("effectiveScaleRange");return n&&n.minScale===i.minScale&&n.maxScale===i.maxScale?n:i}};return g([w({type:Number,nonNullable:!0,json:{write:!0}})],t.prototype,"minScale",void 0),g([w({type:Number,nonNullable:!0,json:{write:!0}})],t.prototype,"maxScale",void 0),g([w({readOnly:!0})],t.prototype,"effectiveScaleRange",null),t=g([te("esri.layers.mixins.ScaleRangeLayer")],t),t};function UTe(e,t){return e.minScale=e.minScale>0?t.minScale>0?Math.min(e.minScale,t.minScale):e.minScale:t.minScale,e.maxScale=e.maxScale>0?t.maxScale>0?Math.max(e.maxScale,t.maxScale):e.maxScale:t.maxScale,e}const Ny=Ns()({esriTimeUnitsMilliseconds:"milliseconds",esriTimeUnitsSeconds:"seconds",esriTimeUnitsMinutes:"minutes",esriTimeUnitsHours:"hours",esriTimeUnitsDays:"days",esriTimeUnitsWeeks:"weeks",esriTimeUnitsMonths:"months",esriTimeUnitsYears:"years",esriTimeUnitsDecades:"decades",esriTimeUnitsCenturies:"centuries",esriTimeUnitsUnknown:void 0});var mP;let R2=mP=class extends ke{constructor(e){super(e),this.value=0,this.unit="milliseconds"}toMilliseconds(){return PIe(this.value,this.unit,"milliseconds")}clone(){return new mP({value:this.value,unit:this.unit})}};g([w({type:Number,json:{write:!0},nonNullable:!0})],R2.prototype,"value",void 0),g([w({type:Ny.apiValues,json:{type:Ny.jsonValues,read:Ny.read,write:Ny.write},nonNullable:!0})],R2.prototype,"unit",void 0),R2=mP=g([te("esri.TimeInterval")],R2);const F2=R2;var gP;let B1=gP=class extends ke{constructor(e){super(e),this.respectsDaylightSaving=!1,this.timezone=null}readRespectsDaylightSaving(e,t){return t.respectsDaylightSaving!==void 0?t.respectsDaylightSaving:t.respectDaylightSaving!==void 0&&t.respectDaylightSaving}clone(){const{respectsDaylightSaving:e,timezone:t}=this;return new gP({respectsDaylightSaving:e,timezone:t})}};g([w({type:Boolean,json:{write:!0}})],B1.prototype,"respectsDaylightSaving",void 0),g([We("respectsDaylightSaving",["respectsDaylightSaving","respectDaylightSaving"])],B1.prototype,"readRespectsDaylightSaving",null),g([w({type:String,json:{read:{source:"timeZone"},write:{target:"timeZone"}}})],B1.prototype,"timezone",void 0),B1=gP=g([te("esri.layers.support.TimeReference")],B1);const qTe=B1;var vP;let yo=vP=class extends ke{constructor(e){super(e),this.cumulative=!1,this.endField=null,this.fullTimeExtent=null,this.hasLiveData=!1,this.interval=null,this.startField=null,this.timeReference=null,this.trackIdField=null,this.useTime=!0}readFullTimeExtent(e,t){if(!t.timeExtent||!Array.isArray(t.timeExtent)||t.timeExtent.length!==2)return null;const i=new Date(t.timeExtent[0]),r=new Date(t.timeExtent[1]);return new qa({start:i,end:r})}writeFullTimeExtent(e,t){e&&H(e.start)&&H(e.end)?t.timeExtent=[e.start.getTime(),e.end.getTime()]:t.timeExtent=null}readInterval(e,t){return t.timeInterval&&t.timeIntervalUnits?new F2({value:t.timeInterval,unit:Ny.fromJSON(t.timeIntervalUnits)}):t.defaultTimeInterval&&t.defaultTimeIntervalUnits?new F2({value:t.defaultTimeInterval,unit:Ny.fromJSON(t.defaultTimeIntervalUnits)}):null}writeInterval(e,t){if(e){const i=e.toJSON();t.timeInterval=i.value,t.timeIntervalUnits=i.unit}else t.timeInterval=null,t.timeIntervalUnits=null}clone(){const{cumulative:e,endField:t,hasLiveData:i,interval:r,startField:n,timeReference:o,fullTimeExtent:c,trackIdField:h,useTime:m}=this;return new vP({cumulative:e,endField:t,hasLiveData:i,interval:r,startField:n,timeReference:_e(o),fullTimeExtent:_e(c),trackIdField:h,useTime:m})}};g([w({type:Boolean,json:{read:{source:"exportOptions.timeDataCumulative"},write:{target:"exportOptions.timeDataCumulative"}}})],yo.prototype,"cumulative",void 0),g([w({type:String,json:{read:{source:"endTimeField"},write:{target:"endTimeField",allowNull:!0}}})],yo.prototype,"endField",void 0),g([w({type:qa,json:{write:{enabled:!0,allowNull:!0}}})],yo.prototype,"fullTimeExtent",void 0),g([We("fullTimeExtent",["timeExtent"])],yo.prototype,"readFullTimeExtent",null),g([tt("fullTimeExtent")],yo.prototype,"writeFullTimeExtent",null),g([w({type:Boolean,json:{write:!0}})],yo.prototype,"hasLiveData",void 0),g([w({type:F2,json:{write:{enabled:!0,allowNull:!0}}})],yo.prototype,"interval",void 0),g([We("interval",["timeInterval","timeIntervalUnits","defaultTimeInterval","defaultTimeIntervalUnits"])],yo.prototype,"readInterval",null),g([tt("interval")],yo.prototype,"writeInterval",null),g([w({type:String,json:{read:{source:"startTimeField"},write:{target:"startTimeField",allowNull:!0}}})],yo.prototype,"startField",void 0),g([w({type:qTe,json:{write:{enabled:!0,allowNull:!0}}})],yo.prototype,"timeReference",void 0),g([w({type:String,json:{write:{enabled:!0,allowNull:!0}}})],yo.prototype,"trackIdField",void 0),g([w({type:Boolean,json:{read:{source:"exportOptions.useTime"},write:{target:"exportOptions.useTime"}}})],yo.prototype,"useTime",void 0),yo=vP=g([te("esri.layers.support.TimeInfo")],yo);const fY=yo,yY=e=>{let t=class extends e{constructor(){super(...arguments),this.timeExtent=null,this.timeOffset=null,this.useViewTime=!0}readOffset(i,r){const n=r.timeInfo.exportOptions;if(!n)return null;const o=n.timeOffset,c=Ny.fromJSON(n.timeOffsetUnits);return o&&c?new F2({value:o,unit:c}):null}set timeInfo(i){Pz(i,this.fieldsIndex),this._set("timeInfo",i)}};return g([w({type:qa,json:{write:!1}})],t.prototype,"timeExtent",void 0),g([w({type:F2})],t.prototype,"timeOffset",void 0),g([We("service","timeOffset",["timeInfo.exportOptions"])],t.prototype,"readOffset",null),g([w({value:null,type:fY,json:{write:!0,origins:{"web-document":{read:!1,write:!1},"portal-item":{read:!1,write:!1}}}})],t.prototype,"timeInfo",null),g([w({type:Boolean,json:{read:{source:"timeAnimation"},write:{target:"timeAnimation"},origins:{"web-scene":{read:!1,write:!1}}}})],t.prototype,"useViewTime",void 0),t=g([te("esri.layers.mixins.TemporalLayer")],t),t},mY=new kt({esriFeatureEditToolAutoCompletePolygon:"auto-complete-polygon",esriFeatureEditToolCircle:"circle",esriFeatureEditToolEllipse:"ellipse",esriFeatureEditToolFreehand:"freehand",esriFeatureEditToolLine:"line",esriFeatureEditToolNone:"none",esriFeatureEditToolPoint:"point",esriFeatureEditToolPolygon:"polygon",esriFeatureEditToolRectangle:"rectangle",esriFeatureEditToolArrow:"arrow",esriFeatureEditToolTriangle:"triangle",esriFeatureEditToolLeftArrow:"left-arrow",esriFeatureEditToolRightArrow:"right-arrow",esriFeatureEditToolUpArrow:"up-arrow",esriFeatureEditToolDownArrow:"down-arrow"});let yf=class extends rn(ke){constructor(e){super(e),this.name=null,this.description=null,this.drawingTool=null,this.prototype=null,this.thumbnail=null}};g([w({json:{write:!0}})],yf.prototype,"name",void 0),g([w({json:{write:!0}})],yf.prototype,"description",void 0),g([w({json:{read:mY.read,write:mY.write}})],yf.prototype,"drawingTool",void 0),g([w({json:{write:!0}})],yf.prototype,"prototype",void 0),g([w({json:{write:!0}})],yf.prototype,"thumbnail",void 0),yf=g([te("esri.layers.support.FeatureTemplate")],yf);const bP=yf;let Qh=class extends rn(ke){constructor(e){super(e),this.id=null,this.name=null,this.domains=null,this.templates=null}readDomains(e){const t={};for(const i of Object.keys(e))t[i]=B7(e[i]);return t}writeDomains(e,t){var r;const i={};for(const n of Object.keys(e))e[n]&&(i[n]=(r=e[n])==null?void 0:r.toJSON());t.domains=i}};g([w({json:{write:!0}})],Qh.prototype,"id",void 0),g([w({json:{write:!0}})],Qh.prototype,"name",void 0),g([w({json:{write:!0}})],Qh.prototype,"domains",void 0),g([We("domains")],Qh.prototype,"readDomains",null),g([tt("domains")],Qh.prototype,"writeDomains",null),g([w({type:[bP],json:{write:!0}})],Qh.prototype,"templates",void 0),Qh=g([te("esri.layers.support.FeatureType")],Qh);const wP=Qh;function HTe(e){return e.type==="date"||e.type==="esriFieldTypeDate"}function gY(e){return e.type==="oid"||e.type==="esriFieldTypeOID"}function vY(e){return e.type==="global-id"||e.type==="esriFieldTypeGlobalID"}class bY{constructor(t=[]){if(this.fields=[],this._fieldsMap=new Map,this._normalizedFieldsMap=new Map,this._dateFieldsSet=new Set,this._numericFieldsSet=new Set,this.dateFields=[],this.numericFields=[],this._requiredFields=null,!t)return;this.fields=t;const i=[];for(const r of t){const n=r&&r.name;if(n){const o=wY(n),c=_Y(n);this._fieldsMap.set(n,r),this._fieldsMap.set(o,r),this._normalizedFieldsMap.set(c,r),i.push(o),HTe(r)?(this.dateFields.push(r),this._dateFieldsSet.add(r)):qT(r)&&(this._numericFieldsSet.add(r),this.numericFields.push(r)),gY(r)||vY(r)||(r.editable=r.editable==null||!!r.editable,r.nullable=r.nullable==null||!!r.nullable)}}i.sort(),this.uid=i.join(",")}destroy(){this._fieldsMap.clear()}get requiredFields(){if(!this._requiredFields){this._requiredFields=[];for(const t of this.fields)gY(t)||vY(t)||t.nullable||Uge(t)!==void 0||this._requiredFields.push(t)}return this._requiredFields}has(t){return this.get(t)!=null}get(t){var r;if(!t)return;let i=this._fieldsMap.get(t);return i||(i=(r=this._fieldsMap.get(wY(t)))!=null?r:this._normalizedFieldsMap.get(_Y(t)),i&&this._fieldsMap.set(t,i),i)}isDateField(t){return this._dateFieldsSet.has(this.get(t))}isNumericField(t){return this._numericFieldsSet.has(this.get(t))}normalizeFieldName(t){var r;const i=this.get(t);if(i)return(r=i.name)!=null?r:void 0}}function wY(e){return e.trim().toLowerCase()}function _Y(e){return Oge(e).toLowerCase()}function WTe(){return{fields:{type:[u1],value:null},fieldsIndex:{readOnly:!0,get(){return new bY(this.fields||[])}},outFields:{type:[String],json:{read:!1},set:function(e){this._userOutFields=e,this.notifyChange("outFields")},get:function(){var t;const e=this._userOutFields;if(!e||!e.length)return null;if(e.includes("*"))return["*"];if(!this.fields)return e;for(const i of e)((t=this.fieldsIndex)==null?void 0:t.has(i))||$e.getLogger("esri.layers.support.fieldProperties").error("field-attributes-layer:invalid-field",`Invalid field ${i} found in outFields`,{layer:this,outFields:e});return Lz(this.fieldsIndex,e)}}}}const _P=$e.getLogger("esri.layers.support.labelingInfo"),JTe=/\[([^\[\]]+)\]/gi;function xY(e,t,i){return e?e.map(r=>{const n=new C2;if(n.read(r,i),n.labelExpression){const o=t.fields||t.layerDefinition&&t.layerDefinition.fields||this.fields;n.labelExpression=n.labelExpression.replace(JTe,(c,h)=>`[${ZTe(h,o)}]`)}return n}):null}function ZTe(e,t){if(!t)return e;const i=e.toLowerCase();for(let r=0;r<t.length;r++){const n=t[r].name;if(n.toLowerCase()===i)return n}return e}const KTe={esriGeometryPoint:["above-right","above-center","above-left","center-center","center-left","center-right","below-center","below-left","below-right"],esriGeometryPolygon:["always-horizontal"],esriGeometryPolyline:["center-along"],esriGeometryMultipoint:null};function YTe(e,t){const i=_e(e);return i.some(r=>XTe(r,t))?[]:i}function XTe(e,t){const i=e.labelPlacement,r=KTe[t];if(!e.symbol)return _P.warn("No ILabelClass symbol specified."),!0;if(!r)return _P.error(new ue("labeling:unsupported-geometry-type",`Unable to create labels for layer, geometry type '${t}' is not supported`)),!0;if(!r.includes(i)){const n=r[0];i&&_P.warn(`Found invalid label placement type ${i} for ${t}. Defaulting to ${n}`),e.labelPlacement=n}return!1}const Ec=[];function SY(e,t){var r,n;if(F8((r=e.url)!=null?r:""))return!0;const{wkid:i}=t;for(const o of Ec){if(((n=e.version)!=null?n:0)>=o[0])return!0;if(typeof o[1]=="function"&&(o[1]=o[1]()),o[1].has(i))return!1}return!0}Ec.push([10.91,()=>{const e=new Set([9709,9716,9741,9761,9766]);for(let t=9712;t<=9713;t++)e.add(t);for(let t=9748;t<=9749;t++)e.add(t);for(let t=20904;t<=20932;t++)e.add(t);for(let t=21004;t<=21032;t++)e.add(t);for(let t=21207;t<=21264;t++)e.add(t);for(let t=21307;t<=21364;t++)e.add(t);for(let t=102759;t<=102760;t++)e.add(t);for(let t=102901;t<=102955;t++)e.add(t);return e}]),Ec.push([10.9,()=>{const e=new Set([9300,9354,9364,9367,9373,9377,9387,9456,9473,9498,9678,9680,29874,103599,103872,104028]);for(let t=9356;t<=9360;t++)e.add(t);for(let t=9404;t<=9407;t++)e.add(t);for(let t=9476;t<=9482;t++)e.add(t);for(let t=9487;t<=9494;t++)e.add(t);for(let t=9697;t<=9699;t++)e.add(t);return e}]),Ec.push([10.81,()=>{const e=new Set([9265,9333,103598,103699]);for(let t=9248;t<=9254;t++)e.add(t);for(let t=9271;t<=9273;t++)e.add(t);for(let t=9284;t<=9285;t++)e.add(t);for(let t=21453;t<=21463;t++)e.add(t);return e}]),Ec.push([10.8,()=>{const e=new Set([8088,8395,8428,8433,8531,8687,8692,8694,8699,8900,9003,9006,9009,9012,9017,9191]);for(let t=8035;t<=8036;t++)e.add(t);for(let t=8455;t<=8456;t++)e.add(t);for(let t=8518;t<=8529;t++)e.add(t);for(let t=8533;t<=8536;t++)e.add(t);for(let t=8538;t<=8540;t++)e.add(t);for(let t=8677;t<=8679;t++)e.add(t);for(let t=8902;t<=8903;t++)e.add(t);for(let t=8907;t<=8910;t++)e.add(t);for(let t=8949;t<=8951;t++)e.add(t);for(let t=8972;t<=8987;t++)e.add(t);for(let t=9039;t<=9040;t++)e.add(t);for(let t=9068;t<=9069;t++)e.add(t);for(let t=9140;t<=9141;t++)e.add(t);for(let t=9148;t<=9150;t++)e.add(t);for(let t=9153;t<=9159;t++)e.add(t);for(let t=9205;t<=9218;t++)e.add(t);for(let t=9221;t<=9222;t++)e.add(t);for(let t=54098;t<=54101;t++)e.add(t);return e}]),Ec.push([10.71,()=>{const e=new Set([6316]);for(let t=8351;t<=8353;t++)e.add(t);for(let t=9294;t<=9297;t++)e.add(t);for(let t=103586;t<=103594;t++)e.add(t);for(let t=103696;t<=103698;t++)e.add(t);return e}]),Ec.push([10.7,()=>{const e=new Set([8387,8391,8427,8545,8682,8685,8818,31370,104022,104024,104975]);for(let t=8065;t<=8068;t++)e.add(t);for(let t=8082;t<=8083;t++)e.add(t);for(let t=8379;t<=8385;t++)e.add(t);for(let t=8836;t<=8840;t++)e.add(t);for(let t=8857;t<=8860;t++)e.add(t);for(let t=53035;t<=53037;t++)e.add(t);for(let t=54090;t<=54091;t++)e.add(t);for(let t=102498;t<=102499;t++)e.add(t);return e}]),Ec.push([10.61,()=>new Set([102497])]),Ec.push([10.6,()=>{const e=new Set([7803,7805,7887,8086,8232,8237,8240,8246,8249,8252,8255,9019,9391]);for(let t=7755;t<=7787;t++)e.add(t);for(let t=7791;t<=7795;t++)e.add(t);for(let t=7799;t<=7801;t++)e.add(t);for(let t=7825;t<=7831;t++)e.add(t);for(let t=7877;t<=7878;t++)e.add(t);for(let t=7882;t<=7883;t++)e.add(t);for(let t=7991;t<=7992;t++)e.add(t);for(let t=8042;t<=8043;t++)e.add(t);for(let t=8058;t<=8059;t++)e.add(t);for(let t=8311;t<=8348;t++)e.add(t);for(let t=9060;t<=9067;t++)e.add(t);for(let t=102562;t<=102568;t++)e.add(t);for(let t=102799;t<=102900;t++)e.add(t);return e}]),Ec.push([10.51,()=>{const e=new Set([7683,7881,7886,7899,8888,9e3]);for(let t=8013;t<=8032;t++)e.add(t);for(let t=9053;t<=9057;t++)e.add(t);for(let t=104017;t<=104018;t++)e.add(t);for(let t=104971;t<=104974;t++)e.add(t);return e}]),Ec.push([10.5,()=>{const e=new Set([6962,7035,7037,7039,7041,7084,7086,7133,7798,102399]);for(let t=4087;t<=4088;t++)e.add(t);for(let t=5896;t<=5899;t++)e.add(t);for(let t=7005;t<=7007;t++)e.add(t);for(let t=7057;t<=7070;t++)e.add(t);for(let t=7073;t<=7082;t++)e.add(t);for(let t=7109;t<=7128;t++)e.add(t);for(let t=7844;t<=7859;t++)e.add(t);return e}]);async function QTe(e,t,i){const r=e&&e.getAtOrigin&&e.getAtOrigin("renderer",t.origin);if(r&&r.type==="unique-value"&&r.styleOrigin){const n=await V5(r.populateFromStyle());if(ur(i),n.ok===!1){const o=n.error;t&&t.messages&&t.messages.push(new Io("renderer:style-reference",`Failed to create unique value renderer from style reference: ${o.message}`,{error:o,context:t})),e.clear("renderer",t==null?void 0:t.origin)}}}const e6e=["oid","global-id"],t6e=["oid","global-id","guid"];function MY({displayField:e,editFieldsInfo:t,fields:i,objectIdField:r,title:n},o){if(!i)return null;const c=a6e({editFieldsInfo:t,fields:i,objectIdField:r},o);if(!c.length)return null;const h=u6e({titleBase:n,fields:i,displayField:e}),m=c6e();return new _d({title:h,content:m,fieldInfos:c})}const i6e=[/^fnode_$/i,/^tnode_$/i,/^lpoly_$/i,/^rpoly_$/i,/^poly_$/i,/^subclass$/i,/^subclass_$/i,/^rings_ok$/i,/^rings_nok$/i,/shape/i,/perimeter/i,/objectid/i,/_i$/i],r6e=(e,{editFieldsInfo:t,objectIdField:i,visibleFieldNames:r})=>r?r.has(e.name):!IY(e.name,t)&&(!i||e.name!==i)&&!e6e.includes(e.type)&&!i6e.some(n=>n.test(e.name));function n6e(e,t){const i=e;return t&&(e=e.filter(r=>!t.includes(r.type))),e===i&&(e=e.slice()),e.sort(s6e),e}function s6e(e,t){return e.type==="oid"?-1:t.type==="oid"?1:$Y(e)?-1:$Y(t)?1:(e.alias||e.name).toLocaleLowerCase().localeCompare((t.alias||t.name).toLocaleLowerCase())}function IY(e,t){if(!e||!t)return!1;const{creationDateField:i,creatorField:r,editDateField:n,editorField:o}=t;return[i&&i.toLowerCase(),r&&r.toLowerCase(),n&&n.toLowerCase(),o&&o.toLowerCase()].includes(e.toLowerCase())}function o6e(e,t){return e.editable&&!t6e.includes(e.type)&&!IY(e.name,t)}function a6e({editFieldsInfo:e,fields:t,objectIdField:i},r){return n6e(t!=null?t:[],(r==null?void 0:r.ignoreFieldTypes)||h6e).map(n=>new Lw({fieldName:n.name,isEditable:o6e(n,e),label:n.alias,format:l6e(n),visible:r6e(n,{editFieldsInfo:e,objectIdField:i,visibleFieldNames:r==null?void 0:r.visibleFieldNames})}))}function l6e(e){switch(e.type){case"small-integer":case"integer":case"single":return new yg({digitSeparator:!0,places:0});case"double":return new yg({digitSeparator:!0,places:2});case"date":return new yg({dateFormat:"long-month-day-year"});default:return e.type==="string"&&Vz(e.name)?new yg({digitSeparator:!0,places:0}):null}}function c6e(){return[new mg,new Mw]}function u6e(e){const t=Nge(e),{titleBase:i}=e;return t?`${i}: {${t.trim()}}`:i!=null?i:""}function $Y(e){return(e.name&&e.name.toLowerCase())==="name"?!0:(e.alias&&e.alias.toLowerCase())==="name"}const h6e=["geometry","blob","raster","guid","xml"],Lo="FeatureLayer",EY="esri.layers.FeatureLayer",p6e=$e.getLogger(EY);function jM(e,t){return new ue("layer:unsupported",`Layer (${e.title}, ${e.id}) of type '${e.declaredClass}' ${t}`,{layer:e})}function TY(e){return e&&e instanceof Xe}const xP=WTe();function SP(e,t,i){const r=!!(i==null?void 0:i.writeLayerSchema);return{enabled:r,ignoreOrigin:r}}let Tt=class extends qEe(LTe(sEe(VTe(iEe($M(NTe(yY(DM(yP(N8(uP(dP(x2(D8(O8(rn(Y0))))))))))))))))){constructor(...e){super(...e),this._handles=new Ti,this.charts=null,this.copyright=null,this.displayField=null,this.dynamicDataSource=null,this.fields=null,this.fieldsIndex=null,this.formTemplate=null,this.fullExtent=null,this.geometryType=null,this.hasM=void 0,this.hasZ=void 0,this.infoFor3D=null,this.isTable=!1,this.labelsVisible=!0,this.labelingInfo=null,this.legendEnabled=!0,this.objectIdField=null,this.outFields=null,this.path=null,this.popupEnabled=!0,this.popupTemplate=null,this.screenSizePerspectiveEnabled=!0,this.spatialReference=Mt.WGS84,this.subtypeCode=null,this.templates=null,this.timeInfo=null,this.title=null,this.sublayerTitleMode="item-title",this.type="feature",this.typeIdField=null,this.types=null,this.visible=!0}destroy(){var e;(e=this.source)==null||e.destroy(),this._handles=li(this._handles)}normalizeCtorArgs(e,t){return typeof e=="string"?K({url:e},t):e}load(e){var r;const t=H(e)?e.signal:null;if(((r=this.portalItem)==null?void 0:r.loaded)&&this.source)return this.addResolvingPromise(this.createGraphicsSource(t).then(n=>this.initLayerProperties(n))),Promise.resolve(this);const i=this.loadFromPortal({supportedTypes:["Feature Service","Feature Collection"]},e).catch(f0).then(async()=>{if(this.url&&this.layerId==null&&/FeatureServer|MapServer\/*$/i.test(this.url)){const n=await this._fetchFirstLayerId(t);n!=null&&(this.layerId=n)}if(!this.url&&!this._hasMemorySource())throw new ue("feature-layer:missing-url-or-source","Feature layer must be created with either a url or a source");return this.initLayerProperties(await this.createGraphicsSource(t))}).then(()=>this.finishLoadEditablePortalLayer(e));return this.addResolvingPromise(i),Promise.resolve(this)}readCapabilities(e,t){return t=t.layerDefinition||t,GK(e,t,this.url)}get createQueryVersion(){var e;return this.commitProperty("definitionExpression"),this.commitProperty("dynamicDataSource"),this.commitProperty("timeExtent"),this.commitProperty("timeOffset"),this.commitProperty("geometryType"),this.commitProperty("gdbVersion"),this.commitProperty("historicMoment"),this.commitProperty("returnZ"),this.commitProperty("capabilities"),this.commitProperty("returnM"),((e=this._get("createQueryVersion"))!=null?e:0)+1}get editingEnabled(){var e;return!(this.loaded&&!((e=this.capabilities)==null?void 0:e.operations.supportsEditing))&&(this._isOverridden("editingEnabled")?this._get("editingEnabled"):this._hasMemorySource()||this.userHasEditingPrivileges)}set editingEnabled(e){this._overrideIfSome("editingEnabled",e)}readEditingEnabled(e,t){return this._readEditingEnabled(t,!1)}readEditingEnabledFromWebMap(e,t,i){return this._readEditingEnabled(t,!0,i)}writeEditingEnabled(e,t){this._writeEditingEnabled(e,t,!1)}writeEditingEnabledToWebMap(e,t,i,r){this._writeEditingEnabled(e,t,!0,r)}readIsTable(e,t){var i;return(t=(i=t==null?void 0:t.layerDefinition)!=null?i:t).type==="Table"||!t.geometryType}writeIsTable(e,t,i,r){(r==null?void 0:r.writeLayerSchema)&&eo(i,e?"Table":"Feature Layer",t)}readGlobalIdField(e,t){return BK(t.layerDefinition||t)}readObjectIdField(e,t){return UK(t.layerDefinition||t)}get parsedUrl(){const e=mn(this.url);return e!=null&&(this.dynamicDataSource!=null?e.path=Cd(e.path,"dynamicLayer"):this.layerId!=null&&(e.path=Cd(e.path,this.layerId.toString()))),e}get defaultPopupTemplate(){return this.createPopupTemplate()}set renderer(e){kz(e,this.fieldsIndex),this._set("renderer",e)}readRenderer(e,t,i){var n,o;const r=(n=(t=t.layerDefinition||t).drawingInfo)==null?void 0:n.renderer;if(r){const c=(o=_2(r,t,i))!=null?o:void 0;return c||p6e.error("Failed to create renderer",{rendererDefinition:t.drawingInfo.renderer,layer:this,context:i}),c}if(t.defaultSymbol)return t.types&&t.types.length?new b2({defaultSymbol:MP(t.defaultSymbol,t,i),field:t.typeIdField,uniqueValueInfos:t.types.map(c=>({id:c.id,symbol:MP(c.symbol,c,i)}))}):new C1({symbol:MP(t.defaultSymbol,t,i)})}set source(e){const t=this._get("source");t!==e&&(TY(t)&&this._resetMemorySource(t),TY(e)&&this._initMemorySource(e),this._set("source",e))}castSource(e){return e?Array.isArray(e)||e instanceof Xe?new Kh({layer:this,items:e}):e:null}readSource(e,t){var r;const i=Gh.fromJSON(t.featureSet);return new Kh({layer:this,items:(r=i==null?void 0:i.features)!=null?r:[]})}readTemplates(e,t){const i=t.editFieldsInfo,r=i&&i.creatorField,n=i&&i.editorField;return e=e&&e.map(o=>bP.fromJSON(o)),this._fixTemplates(e,r),this._fixTemplates(e,n),e}readTitle(e,t){var n,o;const i=(o=(n=t.layerDefinition)==null?void 0:n.name)!=null?o:t.name,r=t.title||t.layerDefinition&&t.layerDefinition.title;if(i){const c=this.portalItem&&this.portalItem.title;if(this.sublayerTitleMode==="item-title")return this.url?Y$e(this.url,i):i;let h=i;if(!h&&this.url){const m=hf(this.url);H(m)&&(h=m.title)}return h?(this.sublayerTitleMode==="item-title-and-service-name"&&c&&c!==h&&(h=c+" - "+h),R8(h)):void 0}if(this.sublayerTitleMode==="item-title"&&r)return r}readTitleFromWebMap(e,t){return t.title||t.layerDefinition&&t.layerDefinition.name}readTypeIdField(e,t){let i=(t=t.layerDefinition||t).typeIdField;if(i&&t.fields){i=i.toLowerCase();const r=t.fields.find(n=>n.name.toLowerCase()===i);r&&(i=r.name)}return i}readTypes(e,t){e=(t=t.layerDefinition||t).types;const i=t.editFieldsInfo,r=i&&i.creatorField,n=i&&i.editorField;return e&&e.map(o=>(o=wP.fromJSON(o),this._fixTemplates(o.templates,r),this._fixTemplates(o.templates,n),o))}readVisible(e,t){return t.layerDefinition&&t.layerDefinition.defaultVisibility!=null?!!t.layerDefinition.defaultVisibility:t.visibility!=null?!!t.visibility:void 0}async addAttachment(e,t){return kEe(this,e,t,Lo)}async updateAttachment(e,t,i){return AEe(this,e,t,i,Lo)}async applyEdits(e,t){return PEe(this,e,t)}on(e,t){return super.on(e,t)}createPopupTemplate(e){return MY(this,e)}async createGraphicsSource(e){if(this._hasMemorySource()&&this.source)return this.source.load({signal:e});const{default:t}=await PV(import("./FeatureLayerSource.7e1c2aa9.js"),e);return new t({layer:this}).load({signal:e})}createQuery(){const e=GEe(this);e.dynamicDataSource=this.dynamicDataSource;const t=H(this.subtypeCode)?`${this.subtypeField} = ${this.subtypeCode}`:null,i=wM(this.definitionExpression,t);return e.where=i||"1=1",e}async deleteAttachments(e,t){return LEe(this,e,t,Lo)}async fetchRecomputedExtents(e){return OEe(this,e,Lo)}getFeatureType(e){const{typeIdField:t,types:i}=this;if(!t||!e)return null;const r=e.attributes?e.attributes[t]:void 0;if(r==null)return null;let n=null;return i==null||i.some(o=>{const{id:c}=o;return c!=null&&(c.toString()===r.toString()&&(n=o),!!n)}),n}getFieldDomain(e,t){const i=t&&t.feature,r=this.getFeatureType(i);if(r){const n=r.domains&&r.domains[e];if(n&&n.type!=="inherited")return n}return this._getLayerDomain(e)}getField(e){return this.fieldsIndex.get(e)}async queryAttachments(e,t){return REe(this,e,t,Lo)}async queryFeatures(e,t){var n;const i=await this.load(),r=await i.source.queryFeatures((n=co.from(e))!=null?n:i.createQuery(),t);if(r==null?void 0:r.features)for(const o of r.features)o.layer=o.sourceLayer=i;return r}async queryObjectIds(e,t){return FEe(this,e,t,Lo)}async queryFeatureCount(e,t){return NEe(this,e,t,Lo)}async queryExtent(e,t){return DEe(this,e,t,Lo)}async queryRelatedFeatures(e,t){return jEe(this,e,t,Lo)}async queryRelatedFeaturesCount(e,t){return VEe(this,e,t,Lo)}async queryTopFeatures(e,t){var o;const{source:i,capabilities:r}=await this.load();if(!i.queryTopFeatures||!((o=r==null?void 0:r.query)==null?void 0:o.supportsTopFeaturesQuery))throw new ue(Lo,"Layer source does not support queryTopFeatures capability");const n=await i.queryTopFeatures(tf.from(e),t);if(n==null?void 0:n.features)for(const c of n.features)c.layer=c.sourceLayer=this;return n}async queryTopObjectIds(e,t){const{source:i,capabilities:r}=await this.load();if(!i.queryTopObjectIds||!(r==null?void 0:r.query.supportsTopFeaturesQuery))throw new ue(Lo,"Layer source does not support queryTopObjectIds capability");return i.queryTopObjectIds(tf.from(e),t)}async queryTopFeaturesExtent(e,t){var n;const{source:i,capabilities:r}=await this.load();if(!i.queryTopExtents||!((n=r==null?void 0:r.query)==null?void 0:n.supportsTopFeaturesQuery))throw new ue(Lo,"Layer source does not support queryTopExtents capability");return i.queryTopExtents(tf.from(e),t)}async queryTopFeatureCount(e,t){var n;const{source:i,capabilities:r}=await this.load();if(!i.queryTopCount||!((n=r==null?void 0:r.query)==null?void 0:n.supportsTopFeaturesQuery))throw new ue(Lo,"Layer source does not support queryFeatureCount capability");return i.queryTopCount(tf.from(e),t)}read(e,t){const i=e.featureCollection;if(i){const r=i.layers;r&&r.length===1&&(super.read(r[0],t),i.showLegend!=null&&super.read({showLegend:i.showLegend},t))}super.read(e,t),t&&t.origin==="service"&&this.revert(["objectIdField","fields","timeInfo","spatialReference"],"service")}write(e,t){var o,c;t=Ce(K({},t),{origin:(o=t==null?void 0:t.origin)!=null?o:void 0,writeLayerSchema:(c=t==null?void 0:t.writeLayerSchema)!=null?c:this._hasMemorySource()});const{origin:i,layerContainerType:r,messages:n}=t;if(this.dynamicDataSource)return n==null||n.push(jM(this,"using a dynamic data source cannot be written to web scenes, web maps and feature service items")),null;if(this.isTable){if(i==="web-scene"||i==="web-map"&&r!=="tables")return n==null||n.push(jM(this,"using a table source cannot be written to web scenes and web maps")),null;if(this._hasMemorySource())return n==null||n.push(jM(this,"using an in-memory table source cannot be written to web scenes and web maps")),null}else if(this.loaded&&i==="web-map"&&r==="tables")return n==null||n.push(jM(this,"using a non-table source cannot be written to tables in web maps")),null;return super.write(e,t)}clone(){if(this._hasMemorySource())throw new ue(Lo,`FeatureLayer (title: ${this.title}, id: ${this.id}) created using in-memory source cannot be cloned`);return super.clone()}serviceSupportsSpatialReference(e){var t;return!!this.loaded&&(((t=this.source)==null?void 0:t.type)==="memory"||SY(this,e))}async save(e){return(await import("./featureLayerUtils.917cc5fc.js")).save(this,e)}async saveAs(e,t){return(await import("./featureLayerUtils.917cc5fc.js")).saveAs(this,e,t)}_readEditingEnabled(e,t,i){var n;let r=(n=e.layerDefinition)==null?void 0:n.capabilities;return r?this._hasEditingCapability(r):(r=e.capabilities,t&&(i==null?void 0:i.origin)==="web-map"&&!this._hasMemorySource()&&r?this._hasEditingCapability(r):void 0)}_hasEditingCapability(e){return e.toLowerCase().split(",").map(t=>t.trim()).includes("editing")}_writeEditingEnabled(e,t,i,r){var n,o;if(!e){const c=((o=(n=this.capabilities)==null?void 0:n.operations)==null?void 0:o.supportsSync)?"Query,Sync":"Query";eo("layerDefinition.capabilities",c,t),i&&!(r==null?void 0:r.writeLayerSchema)&&(t.capabilities=c)}}_getLayerDomain(e){const t=this.fieldsIndex.get(e);return t?t.domain:null}_fetchFirstLayerId(e){return Nt(this.url,{query:Ce(K({f:"json"},this.customParameters),{token:this.apiKey}),responseType:"json",signal:e}).then(t=>{const i=t.data;if(i)return Array.isArray(i.layers)&&i.layers.length>0?i.layers[0].id:Array.isArray(i.tables)&&i.tables.length>0?i.tables[0].id:void 0})}async initLayerProperties(e){return this._set("source",e),e.sourceJSON&&(this.sourceJSON=e.sourceJSON,this.read(e.sourceJSON,{origin:"service",url:this.parsedUrl})),this._verifySource(),this._verifyFields(),kz(this.renderer,this.fieldsIndex),Pz(this.timeInfo,this.fieldsIndex),QTe(this,{origin:"service"})}async hasDataChanged(){return zEe(this)}async fetchPublishingStatus(){const e=this.source;return(e==null?void 0:e.fetchPublishingStatus)?e.fetchPublishingStatus():"unavailable"}_verifyFields(){var t,i,r;const e=(i=(t=this.parsedUrl)==null?void 0:t.path)!=null?i:"undefined";this.objectIdField||console.log("FeatureLayer: 'objectIdField' property is not defined (url: "+e+")"),this.isTable||this._hasMemorySource()||e.search(/\/FeatureServer\//i)!==-1||((r=this.fields)==null?void 0:r.some(n=>n.type==="geometry"))||console.log("FeatureLayer: unable to find field of type 'geometry' in the layer 'fields' list. If you are using a map service layer, features will not have geometry (url: "+e+")")}_fixTemplates(e,t){e&&e.forEach(i=>{const r=i.prototype&&i.prototype.attributes;r&&t&&delete r[t]})}_verifySource(){if(this._hasMemorySource()){if(this.url)throw new ue("feature-layer:mixed-source-and-url","FeatureLayer cannot be created with both an in-memory source and a url")}else if(!this.url)throw new ue("feature-layer:source-or-url-required","FeatureLayer requires either a url, a valid portal item or a source")}_initMemorySource(e){e.forEach(t=>{t.layer=this,t.sourceLayer=this}),this._handles.add([e.on("after-add",t=>{t.item.layer=this,t.item.sourceLayer=this}),e.on("after-remove",t=>{t.item.layer=null,t.item.sourceLayer=null})],"fl-source")}_resetMemorySource(e){e.forEach(t=>{t.layer=null,t.sourceLayer=null}),this._handles.remove("fl-source")}_hasMemorySource(){return!(this.url||!this.source)}};g([We("service","capabilities")],Tt.prototype,"readCapabilities",null),g([w({json:{origins:{"portal-item":{write:!0},"web-map":{write:!0}}}})],Tt.prototype,"charts",void 0),g([w({readOnly:!0})],Tt.prototype,"createQueryVersion",null),g([w({json:{read:{source:"layerDefinition.copyrightText"}}})],Tt.prototype,"copyright",void 0),g([w({json:{read:{source:"layerDefinition.displayField"}}})],Tt.prototype,"displayField",void 0),g([w({types:ta,readOnly:!0})],Tt.prototype,"defaultSymbol",void 0),g([w({type:Ba})],Tt.prototype,"dynamicDataSource",void 0),g([w({type:Boolean})],Tt.prototype,"editingEnabled",null),g([We(["portal-item","web-scene"],"editingEnabled",["layerDefinition.capabilities"])],Tt.prototype,"readEditingEnabled",null),g([We("web-map","editingEnabled",["capabilities","layerDefinition.capabilities"])],Tt.prototype,"readEditingEnabledFromWebMap",null),g([tt(["portal-item","web-scene"],"editingEnabled",{"layerDefinition.capabilities":{type:String}})],Tt.prototype,"writeEditingEnabled",null),g([tt("web-map","editingEnabled",{capabilities:{type:String},"layerDefinition.capabilities":{type:String}})],Tt.prototype,"writeEditingEnabledToWebMap",null),g([w(Ce(K({},xP.fields),{json:{read:{source:"layerDefinition.fields"},origins:{service:{name:"fields"},"web-map":{write:{target:"layerDefinition.fields",overridePolicy:SP}}}}}))],Tt.prototype,"fields",void 0),g([w(xP.fieldsIndex)],Tt.prototype,"fieldsIndex",void 0),g([w({type:G$e,json:{name:"formInfo",write:!0,origins:{"web-scene":{read:!1,write:!1}}}})],Tt.prototype,"formTemplate",void 0),g([w({json:{read:{source:"layerDefinition.extent"}}})],Tt.prototype,"fullExtent",void 0),g([w({json:{origins:{"web-map":{write:{target:"layerDefinition.geometryType",overridePolicy:SP,writer(e,t,i){const r=e?W8.toJSON(e):null;r&&eo(i,r,t)}}}},read:{source:"layerDefinition.geometryType",reader:W8.read}}})],Tt.prototype,"geometryType",void 0),g([w({json:{read:{source:"layerDefinition.hasM"}}})],Tt.prototype,"hasM",void 0),g([w({json:{read:{source:"layerDefinition.hasZ"}}})],Tt.prototype,"hasZ",void 0),g([w(VK)],Tt.prototype,"id",void 0),g([w({readOnly:!0,json:{origins:{service:{read:!0}},read:!1}})],Tt.prototype,"infoFor3D",void 0),g([w({json:{origins:{"web-map":{write:{target:"layerDefinition.type"}}}}})],Tt.prototype,"isTable",void 0),g([We("service","isTable",["type","geometryType"]),We("isTable",["layerDefinition.type","layerDefinition.geometryType"])],Tt.prototype,"readIsTable",null),g([tt("web-map","isTable")],Tt.prototype,"writeIsTable",null),g([w(q8)],Tt.prototype,"labelsVisible",void 0),g([w({type:[C2],json:{origins:{service:{read:{source:"drawingInfo.labelingInfo",reader:xY},write:{target:"drawingInfo.labelingInfo",enabled:!1}}},read:{source:"layerDefinition.drawingInfo.labelingInfo",reader:xY},write:{target:"layerDefinition.drawingInfo.labelingInfo"}}})],Tt.prototype,"labelingInfo",void 0),g([w((()=>{const e=_e(yEe);return e.json.origins["portal-item"]={write:{target:"layerDefinition.drawingInfo.transparency",writer(t,i,r){eo(r,p5(t),i)}}},e})())],Tt.prototype,"opacity",void 0),g([w(dEe)],Tt.prototype,"legendEnabled",void 0),g([w({type:["show","hide"],json:(()=>{const e=_e(zK.json);return e.origins["portal-item"]={read:!1,write:!1},e})()})],Tt.prototype,"listMode",void 0),g([We("globalIdField",["layerDefinition.globalIdField","layerDefinition.fields"])],Tt.prototype,"readGlobalIdField",null),g([w({json:{origins:{"web-map":{write:{target:"layerDefinition.objectIdField",overridePolicy:SP}}}}})],Tt.prototype,"objectIdField",void 0),g([We("objectIdField",["layerDefinition.objectIdField","layerDefinition.fields"])],Tt.prototype,"readObjectIdField",null),g([w({value:"ArcGISFeatureLayer",type:["ArcGISFeatureLayer"]})],Tt.prototype,"operationalLayerType",void 0),g([w(xP.outFields)],Tt.prototype,"outFields",void 0),g([w({readOnly:!0})],Tt.prototype,"parsedUrl",null),g([w({type:String,json:{origins:{"web-scene":{read:!0,write:!0}},read:!1}})],Tt.prototype,"path",void 0),g([w(CM)],Tt.prototype,"popupEnabled",void 0),g([w({type:_d,json:{name:"popupInfo",write:!0}})],Tt.prototype,"popupTemplate",void 0),g([w({readOnly:!0})],Tt.prototype,"defaultPopupTemplate",null),g([w({types:w2,json:{origins:{service:{write:{target:"drawingInfo.renderer",enabled:!1}},"web-scene":{types:cK,name:"layerDefinition.drawingInfo.renderer",write:{overridePolicy:(e,t,i)=>({ignoreOrigin:i==null?void 0:i.writeLayerSchema})}}},write:{target:"layerDefinition.drawingInfo.renderer",overridePolicy:(e,t,i)=>({ignoreOrigin:i==null?void 0:i.writeLayerSchema})}}})],Tt.prototype,"renderer",null),g([We("service","renderer",["drawingInfo.renderer","defaultSymbol"]),We("renderer",["layerDefinition.drawingInfo.renderer","layerDefinition.defaultSymbol"])],Tt.prototype,"readRenderer",null),g([w((()=>{const e=_e(pEe);return e.json.origins["portal-item"]={read:!1,write:!1},e})())],Tt.prototype,"screenSizePerspectiveEnabled",void 0),g([w({clonable:!1})],Tt.prototype,"source",null),g([Dt("source")],Tt.prototype,"castSource",null),g([We("portal-item","source",["featureSet"]),We("web-map","source",["featureSet"])],Tt.prototype,"readSource",null),g([w({json:{read:{source:"layerDefinition.extent.spatialReference"}}})],Tt.prototype,"spatialReference",void 0),g([w({type:Number})],Tt.prototype,"subtypeCode",void 0),g([w({type:[bP]})],Tt.prototype,"templates",void 0),g([We("templates",["editFieldsInfo","creatorField","editorField","templates"])],Tt.prototype,"readTemplates",null),g([w({type:fY})],Tt.prototype,"timeInfo",void 0),g([w()],Tt.prototype,"title",void 0),g([We("service","title",["name"]),We("portal-item","title",["layerDefinition.title","layerDefinition.name","title"])],Tt.prototype,"readTitle",null),g([We("web-map","title",["layerDefinition.name","title"])],Tt.prototype,"readTitleFromWebMap",null),g([w({type:String})],Tt.prototype,"sublayerTitleMode",void 0),g([w({json:{read:!1}})],Tt.prototype,"type",void 0),g([w({type:String})],Tt.prototype,"typeIdField",void 0),g([We("service","typeIdField"),We("typeIdField",["layerDefinition.typeIdField"])],Tt.prototype,"readTypeIdField",null),g([w({type:[wP]})],Tt.prototype,"types",void 0),g([We("service","types",["types"]),We("types",["layerDefinition.types"])],Tt.prototype,"readTypes",null),g([w({type:Boolean,json:{origins:{"portal-item":{write:{target:"layerDefinition.defaultVisibility"}}}}})],Tt.prototype,"visible",void 0),g([We("portal-item","visible",["visibility","layerDefinition.defaultVisibility"])],Tt.prototype,"readVisible",null),Tt=g([te(EY)],Tt);const MP=ad({types:j5}),CY=Tt;var d6e=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",default:CY});const f6e=["$datastore","$map","$layer","$aggregatedfeatures"],y6e="esri.widgets.Feature.support.arcadeFeatureUtils",m6e=$e.getLogger(y6e);function g6e(e){return typeof e=="string"?j_(d7(e)):Array.isArray(e)?v6e(e):(e==null?void 0:e.declaredClass)==="esri.arcade.Dictionary"?b6e(e):e}function v6e(e){return`<ul class="esri-widget__list">${e.map(t=>`<li>${typeof t=="string"?j_(d7(t)):t}</li>`).join("")}</ul>`}function b6e(e){return`<table class="esri-widget__table">${e.keys().map(t=>{const i=e.field(t);return`<tr><th>${t}</th><td>${typeof i=="string"?j_(d7(i)):i}</td></tr>`}).join("")}</table>`}function w6e({aggregatedFeatures:e,arcadeUtils:t,featureSetVars:i,context:r,viewInfo:n,map:o,graphic:c,interceptor:h}){i.forEach(m=>{const b=m.toLowerCase(),x={map:o,spatialReference:n.sr,interceptor:h};if(b==="$map"&&(r.vars[b]=t.convertMapToFeatureSetCollection(x)),b==="$layer"&&(r.vars[b]=t.convertFeatureLayerToFeatureSet({layer:c.sourceLayer,spatialReference:n.sr,interceptor:h})),b==="$datastore"&&(r.vars[b]=t.convertServiceUrlToWorkspace({url:c.sourceLayer.url,spatialReference:n.sr,interceptor:h})),b==="$aggregatedfeatures"){const I=c.layer,{fields:E,objectIdField:k,geometryType:P,spatialReference:F,displayField:N}=I,B=new CY(Ce(K({fields:E,objectIdField:k,geometryType:P,spatialReference:F,displayField:N},I.type==="feature"?{templates:I.templates,typeIdField:I.typeIdField,types:I.types}:null),{source:e}));r.vars[b]=t.convertFeatureLayerToFeatureSet({layer:B,spatialReference:n.sr,interceptor:h})}})}function kY(){return import("./arcadeUtils.821621ce.js").then(function(e){return e.ay})}function _6e(e){return"createQuery"in e&&"queryFeatures"in e}async function x6e({graphic:e,view:t}){const{isAggregate:i,layer:r}=e;if(!i||!r||(t==null?void 0:t.type)!=="2d")return[];const n=await t.whenLayerView(r);if(!_6e(n))return[];const o=n.createQuery();o.aggregateIds=[e.getObjectId()];const{features:c}=await n.queryFeatures(o);return c}async function AY({expressionInfo:e,arcadeUtils:t,interceptor:i,spatialReference:r,map:n,graphic:o,view:c}){if(!e||!e.expression)return null;const h=t.createSyntaxTree(e.expression),m=f6e.filter(k=>t.hasVariable(h,k)),[b]=await Promise.all([x6e({graphic:o,view:c}),t.loadScriptDependencies(h,!0,m)]),x=t.getViewInfo({spatialReference:r}),I=t.createExecContext(o,x);I.interceptor=i,I.useAsync=!0,w6e({aggregatedFeatures:b,arcadeUtils:t,featureSetVars:m,context:I,viewInfo:x,map:n,graphic:o,interceptor:i});const E=t.createFunction(h,I);return t.executeAsyncFunction(E,I).catch(k=>m6e.error("arcade-execution-error",{error:k,graphic:o,expressionInfo:e}))}async function S6e({expressionInfos:e,spatialReference:t,graphic:i,interceptor:r,map:n,view:o}){if(!e||!e.length)return{};const c=await kY(),h={};for(const x of e)h[`expression/${x.name}`]=AY({expressionInfo:x,arcadeUtils:c,interceptor:r,spatialReference:t,map:n,graphic:i,view:o});const m=await Mr(h),b={};for(const x in m)b[x]=g6e(m[x].value);return b}const M6e=1;let Wa=class extends ls(Ye){constructor(e){super(e),this._abortController=null,this.expressionInfo=null,this.graphic=null,this.contentElement=null,this.contentElementViewModel=null,this.interceptor=null,this.view=null,this._cancelQuery=()=>{const{_abortController:t}=this;t&&t.abort(),this._abortController=null},this._createVM=()=>{var r,n;const t=(r=this.contentElement)==null?void 0:r.type;(n=this.contentElementViewModel)==null||n.destroy();const i=t==="fields"?new L9:t==="media"?new xy:t==="text"?new A9:null;this._set("contentElementViewModel",i)},this._compile=async()=>{this._cancelQuery();const t=new AbortController;this._abortController=t,await this._compileExpression(),this._abortController===t&&(this._abortController=null)},this._compileThrottled=Zg(this._compile,M6e,this),this._compileExpression=async()=>{const{expressionInfo:t,graphic:i,interceptor:r,spatialReference:n,map:o,view:c,_abortController:h}=this;if(!(t&&i&&n&&o))return void this._set("contentElement",null);const m=await kY();if(h!==this._abortController)return;const b=await AY({arcadeUtils:m,expressionInfo:t,graphic:i,interceptor:r,map:o,spatialReference:n,view:c});if(!b||b.declaredClass!=="esri.arcade.Dictionary")return void this._set("contentElement",null);const x=await b.castAsJsonAsync(h.signal),I=x==null?void 0:x.type,E=I==="media"?Fw.fromJSON(x):I==="text"?bg.fromJSON(x):I==="fields"?mg.fromJSON(x):null;this._set("contentElement",E)},this.handles.add([we(()=>[this.expressionInfo,this.graphic,this.map,this.spatialReference,this.view],()=>this._compileThrottled(),St),we(()=>[this.contentElement],()=>this._createVM(),St)])}destroy(){var e;this._cancelQuery(),(e=this.contentElementViewModel)==null||e.destroy(),this._set("contentElementViewModel",null),this._set("contentElement",null)}get spatialReference(){var e,t;return(t=(e=this.view)==null?void 0:e.spatialReference)!=null?t:null}set spatialReference(e){this._override("spatialReference",e)}get state(){const{_abortController:e,contentElement:t,contentElementViewModel:i}=this;return e?"loading":t||i?"ready":"disabled"}get map(){var e,t;return(t=(e=this.view)==null?void 0:e.map)!=null?t:null}set map(e){this._override("map",e)}};g([w()],Wa.prototype,"_abortController",void 0),g([w({type:zz})],Wa.prototype,"expressionInfo",void 0),g([w({type:Gr})],Wa.prototype,"graphic",void 0),g([w({readOnly:!0})],Wa.prototype,"contentElement",void 0),g([w({readOnly:!0})],Wa.prototype,"contentElementViewModel",void 0),g([w()],Wa.prototype,"interceptor",void 0),g([w()],Wa.prototype,"spatialReference",null),g([w({readOnly:!0})],Wa.prototype,"state",null),g([w()],Wa.prototype,"map",null),g([w()],Wa.prototype,"view",void 0),Wa=g([te("esri.widgets.Feature.FeatureExpression.FeatureExpressionViewModel")],Wa);const IP=Wa,VM={iconLoading:"esri-icon-loading-indicator esri-rotating",base:"esri-feature-expression",loadingSpinnerContainer:"esri-feature__loading-container",spinner:"esri-feature__loading-spinner"};let zM=class extends ki{constructor(e,t){super(e,t),this.viewModel=new IP}initialize(){this.addHandles(we(()=>{var e;return(e=this.viewModel)==null?void 0:e.contentElementViewModel},()=>this._setupExpressionWidget(),St))}destroy(){this._destroyContentWidget()}renderLoading(){return j("div",{key:"loading-container",class:VM.loadingSpinnerContainer},j("span",{class:this.classes(VM.iconLoading,VM.spinner)}))}render(){var t;const{state:e}=this.viewModel;return j("div",{class:VM.base},e==="loading"?this.renderLoading():e==="disabled"?null:(t=this._contentWidget)==null?void 0:t.render())}_destroyContentWidget(){const{_contentWidget:e}=this;e&&(e.viewModel=null,e.destroy()),this._contentWidget=null}_setupExpressionWidget(){const{contentElementViewModel:e,contentElement:t}=this.viewModel,i=t==null?void 0:t.type;this._destroyContentWidget();const r=e?i==="fields"?new CW({viewModel:e}):i==="media"?new lZ({viewModel:e}):i==="text"?new P9({viewModel:e}):null:null;this._contentWidget=r,this.scheduleRender()}};g([w({type:IP})],zM.prototype,"viewModel",void 0),zM=g([te("esri.widgets.Feature.FeatureExpression")],zM);const I6e=zM,$P=100;let wr=class extends rn(rc(ls(Ye))){constructor(e){super(e),this._queryAbortController=null,this._queryPageAbortController=null,this._queryFeatureCountAbortController=null,this.featuresPerPage=10,this.description=null,this.graphic=null,this.layer=null,this.map=null,this.orderByFields=null,this.featureCount=0,this.relationshipId=null,this.showAllEnabled=!1,this.title=null,this._cancelQuery=()=>{const{_queryAbortController:t}=this;t&&t.abort(),this._queryAbortController=null},this._cancelQueryFeatureCount=()=>{const{_queryFeatureCountAbortController:t}=this;t&&t.abort(),this._queryFeatureCountAbortController=null},this._cancelQueryPage=()=>{const{_queryPageAbortController:t}=this;t&&t.abort(),this._queryPageAbortController=null},this._queryController=async()=>{this._cancelQuery();const t=new AbortController;this._queryAbortController=t,await dh(this._query()),this._queryAbortController===t&&(this._queryAbortController=null)},this._queryFeatureCountController=async()=>{this._cancelQueryFeatureCount();const t=new AbortController;this._queryFeatureCountAbortController=t,await dh(this._queryFeatureCount()),this._queryFeatureCountAbortController===t&&(this._queryFeatureCountAbortController=null)},this._queryPageController=async()=>{const t=new AbortController;this._queryPageAbortController=t,await dh(this._queryPage()),this._queryPageAbortController===t&&(this._queryPageAbortController=null)},this._queryThrottled=Zg(this._queryController,$P,this),this._queryFeatureCountThrottled=Zg(this._queryFeatureCountController,$P,this),this._queryPageThrottled=Zg(this._queryPageController,$P,this),this._query=async()=>{const{_queryAbortController:t,relatedFeatures:i}=this;this._destroyRelatedFeatureViewModels(),this.featurePage=1,i.removeAll(),i.addMany(this._sliceFeatures(await this._queryRelatedFeatures({signal:t==null?void 0:t.signal})))},this.handles.add([we(()=>[this.displayCount,this.graphic,this.layer,this.map,this.orderByFieldsFixedCasing,this.relationshipId,this.featuresPerPage,this.showAllEnabled],()=>this._queryThrottled(),St),we(()=>[this.featurePage,this.showAllEnabled],()=>this._queryPageThrottled()),we(()=>[this.layer,this.relationshipId,this.objectId],()=>this._queryFeatureCountThrottled())])}destroy(){this._destroyRelatedFeatureViewModels(),this.relatedFeatures.removeAll(),this._cancelQuery(),this._cancelQueryFeatureCount(),this._cancelQueryPage()}set featurePage(e){const{featuresPerPage:t,featureCount:i}=this,r=1,n=Math.ceil(i/t)||1;this._set("featurePage",Math.min(Math.max(e,r),n))}get featurePage(){return this._get("featurePage")}get orderByFieldsFixedCasing(){const{orderByFields:e,relatedLayer:t}=this;return e&&(t==null?void 0:t.loaded)?e.map(i=>{const r=i.clone(),n=D_(i.field,t);return r.field=n,r}):e}get itemDescriptionFieldName(){var e,t;return((t=(e=this.orderByFieldsFixedCasing)==null?void 0:e[0])==null?void 0:t.field)||null}set displayCount(e){const t=0,i=10;this._set("displayCount",Math.min(Math.max(e,t),i))}get displayCount(){return this._get("displayCount")}get objectId(){var e,t,i;return(i=(t=(e=this.graphic)==null?void 0:e.attributes)==null?void 0:t[this.objectIdField])!=null?i:null}get objectIdField(){var e;return((e=this.layer)==null?void 0:e.objectIdField)||null}get relatedFeatures(){return this._get("relatedFeatures")||new Xe}get relatedLayer(){const{layer:e,map:t,relationship:i}=this;return(e==null?void 0:e.loaded)?i9e(t,e,i):null}get relationship(){var i,r;const{relationshipId:e,layer:t}=this;return typeof e=="number"&&(r=(i=t==null?void 0:t.relationships)==null?void 0:i.find(({id:n})=>n===e))!=null?r:null}get relatedFeatureViewModels(){return this._get("relatedFeatureViewModels")||new Xe}get state(){const{_queryAbortController:e,_queryFeatureCountAbortController:t,_queryPageAbortController:i,graphic:r,relatedLayer:n}=this;return t?"loading":e||i?"querying":r&&n?"ready":"disabled"}_destroyRelatedFeatureViewModels(){var e;(e=this.relatedFeatureViewModels)==null||e.forEach(t=>!t.destroyed&&t.destroy()),this.relatedFeatureViewModels.removeAll()}async _queryFeatureCount(){var b,x,I,E,k;const{layer:e,relatedLayer:t,relationshipId:i,objectId:r,_queryFeatureCountAbortController:n}=this;if(await(e==null?void 0:e.load()),!t||typeof r!="number"||!((x=(b=e==null?void 0:e.capabilities)==null?void 0:b.queryRelated)==null?void 0:x.supportsCount))return void this._set("featureCount",0);await t.load();const o=t.createQuery(),c=(k=(E=(I=e.capabilities)==null?void 0:I.queryRelated)==null?void 0:E.supportsCacheHint)!=null?k:!1,h=new _y({cacheHint:c,relationshipId:i,returnGeometry:!1,objectIds:[r],where:o.where}),m=await e.queryRelatedFeaturesCount(h,{signal:n==null?void 0:n.signal});this._set("featureCount",m[r]||0)}_sliceFeatures(e){const{showAllEnabled:t,displayCount:i}=this;return t?e:i?e.slice(0,i):[]}async _queryPage(){const{relatedFeatures:e,featurePage:t,showAllEnabled:i,_queryPageAbortController:r}=this;!i||t<2||e.addMany(await this._queryRelatedFeatures({signal:r==null?void 0:r.signal}))}async _queryRelatedFeatures(e){var X,Y,ae,he,fe;const{orderByFieldsFixedCasing:t,showAllEnabled:i,featuresPerPage:r,displayCount:n,layer:o,relationshipId:c,featurePage:h,featureCount:m,relatedLayer:b}=this;await(o==null?void 0:o.load());const{relationship:x,objectId:I}=this;if(!x||typeof I!="number"||!((Y=(X=o==null?void 0:o.capabilities)==null?void 0:X.queryRelated)==null?void 0:Y.supportsPagination))return[];const E=i?((h-1)*r+m)%m:0,k=i?r:n;if(!b)return[];await b.load();const P=b.objectIdField,F=[...t==null?void 0:t.map(ye=>ye.field),P],N=t==null?void 0:t.map(ye=>`${ye.field} ${ye.order}`),B=((he=(ae=o.capabilities)==null?void 0:ae.queryRelated)==null?void 0:he.supportsCacheHint)||!1,z=b.createQuery(),q=new _y({orderByFields:N,start:E,num:k,outFields:F,cacheHint:B,relationshipId:c,returnGeometry:!1,objectIds:[I],where:z.where}),J=((fe=(await o.queryRelatedFeatures(q,{signal:e==null?void 0:e.signal}))[I])==null?void 0:fe.features)||[];return J.forEach(ye=>ye.sourceLayer=b),J}};g([w()],wr.prototype,"_queryAbortController",void 0),g([w()],wr.prototype,"_queryPageAbortController",void 0),g([w()],wr.prototype,"_queryFeatureCountAbortController",void 0),g([w({value:1})],wr.prototype,"featurePage",null),g([w()],wr.prototype,"featuresPerPage",void 0),g([w({readOnly:!0})],wr.prototype,"orderByFieldsFixedCasing",null),g([w()],wr.prototype,"description",void 0),g([w({readOnly:!0})],wr.prototype,"itemDescriptionFieldName",null),g([w({value:3})],wr.prototype,"displayCount",null),g([w({type:Gr})],wr.prototype,"graphic",void 0),g([w()],wr.prototype,"layer",void 0),g([w()],wr.prototype,"map",void 0),g([w({readOnly:!0})],wr.prototype,"objectId",null),g([w({readOnly:!0})],wr.prototype,"objectIdField",null),g([w()],wr.prototype,"orderByFields",void 0),g([w({readOnly:!0})],wr.prototype,"relatedFeatures",null),g([w({readOnly:!0})],wr.prototype,"relatedLayer",null),g([w({readOnly:!0})],wr.prototype,"relationship",null),g([w({readOnly:!0})],wr.prototype,"featureCount",void 0),g([w({readOnly:!0})],wr.prototype,"relatedFeatureViewModels",null),g([w()],wr.prototype,"relationshipId",void 0),g([w()],wr.prototype,"showAllEnabled",void 0),g([w({readOnly:!0})],wr.prototype,"state",null),g([w()],wr.prototype,"title",void 0),wr=g([te("esri.widgets.Feature.FeatureRelationship.FeatureRelationshipViewModel")],wr);const EP=wr,ep={base:"esri-feature-relationship",esriWidget:"esri-widget",listContainer:"esri-feature-relationship__list",listContainerQuerying:"esri-feature-relationship__list--querying",featureObserver:"esri-feature__feature-observer",stickySpinnerContainer:"esri-feature__sticky-loading-container",loadingSpinnerContainer:"esri-feature__loading-container",spinner:"esri-feature__loading-spinner",iconLoading:"esri-icon-loading-indicator esri-rotating"},PY={title:!0,description:!0};let Oo=class extends ki{constructor(e,t){super(e,t),this._featureElementInfo=null,this._relatedFeatureIntersectionObserver=new IntersectionObserver(([i])=>{(i==null?void 0:i.isIntersecting)&&this._increaseFeaturePage()},{root:window.document}),this.headingLevel=2,this.viewModel=new EP,this.messages=null,this.messagesCommon=null,this.visibleElements=K({},PY),this._increaseFeaturePage=()=>{const{state:i,showAllEnabled:r,relatedFeatures:n,featuresPerPage:o,featurePage:c}=this.viewModel;i==="ready"&&r&&n.length>=o*c&&this.viewModel.featurePage++}}initialize(){this._featureElementInfo=new k9,this.addHandles([we(()=>[this.viewModel.description,this.viewModel.title,this.headingLevel],()=>this._setupFeatureElementInfo(),St),we(()=>[this.viewModel.state,this.viewModel.showAllEnabled,this._relatedFeatureIntersectionObserverNode],()=>this._handleRelatedFeatureObserverChange()),vr(()=>this.viewModel.relatedFeatureViewModels,"change",()=>this._setupRelatedFeatureViewModels())])}loadDependencies(){return Promise.all([import("./calcite-list.5aff1680.js"),import("./calcite-list-item.b2ac20d5.js"),import("./calcite-icon.3e014da3.js"),import("./calcite-notice.c23c51a9.js")])}destroy(){this._unobserveRelatedFeatureObserver(),this._featureElementInfo=li(this._featureElementInfo)}get displayShowAllButton(){const{showAllEnabled:e,featureCount:t,displayCount:i}=this.viewModel;return!e&&(t>i||i===0)}get displayListItems(){return this.displayShowAllButton||this.viewModel.relatedFeatureViewModels.length>0}get description(){return this.viewModel.description}set description(e){this.viewModel.description=e}get featureCountDescription(){const{messages:e}=this,{featureCount:t}=this.viewModel;return oo(t===1?e==null?void 0:e.numberRecord:e==null?void 0:e.numberRecords,{number:t})}get title(){return this.viewModel.title}set title(e){this.viewModel.title=e}castVisibleElements(e){return K(K({},PY),e)}renderStickyLoading(){return this.viewModel.state==="querying"?j("div",{key:"sticky-loader",class:ep.stickySpinnerContainer},this.renderLoadingIcon()):null}renderLoadingIcon(){return j("span",{class:this.classes(ep.iconLoading,ep.spinner)})}renderLoading(){return j("div",{key:"loading-container",class:ep.loadingSpinnerContainer},this.renderLoadingIcon())}renderShowAllIconNode(){return j("calcite-icon",{scale:"s",icon:"list",slot:"content-end"})}renderChevronIconNode(){const e=Ms(this.container)?"chevron-left":"chevron-right";return j("calcite-icon",{scale:"s",icon:e,slot:"content-end"})}renderRelatedFeature(e){var n,o;const{itemDescriptionFieldName:t}=this.viewModel,i=e.title;e.description=t&&((n=e.formattedAttributes)==null?void 0:n.global[t]);const r=e.state==="loading";return j("calcite-list-item",{key:e.uid,label:r?`${(o=this.messagesCommon)==null?void 0:o.loading}\u2026`:i,description:r?"\u2026":e.description,onclick:()=>this.emit("select-record",{featureViewModel:e})},this.renderChevronIconNode())}renderShowAllListItem(){var e;return this.displayShowAllButton?j("calcite-list-item",{key:"show-all-item",label:(e=this.messages)==null?void 0:e.showAll,description:this.featureCountDescription,onclick:()=>this.emit("show-all-records")},this.renderShowAllIconNode()):null}renderNoRelatedFeaturesMessage(){var e;return j("calcite-notice",{key:"no-related-features-message",icon:"information",open:!0,color:"blue",scale:"s",width:"full"},j("div",{slot:"message"},(e=this.messages)==null?void 0:e.noRelatedFeatures))}renderFeatureObserver(){return j("div",{key:"feature-observer",class:ep.featureObserver,bind:this,afterCreate:this._relatedFeatureIntersectionObserverCreated})}renderList(){const{relatedFeatureViewModels:e}=this.viewModel;return j("calcite-list",null,e.toArray().map(t=>this.renderRelatedFeature(t)),this.renderShowAllListItem())}renderRelatedFeatures(){const{displayListItems:e}=this,{state:t}=this.viewModel;return j("div",{key:"list-container",class:this.classes(ep.listContainer,{[ep.listContainerQuerying]:t==="querying"})},e?this.renderList():t==="ready"?this.renderNoRelatedFeaturesMessage():null,this.renderStickyLoading(),this.renderFeatureObserver())}renderRelationshipNotFound(){var e;return j("calcite-notice",{key:"relationship-not-found",icon:"exclamation-mark-triangle",open:!0,color:"red",scale:"s",width:"full"},j("div",{slot:"message"},(e=this.messages)==null?void 0:e.relationshipNotFound))}render(){var t;const{state:e}=this.viewModel;return j("div",{class:this.classes(ep.base,ep.esriWidget)},(t=this._featureElementInfo)==null?void 0:t.render(),e==="loading"?this.renderLoading():e==="disabled"?this.renderRelationshipNotFound():this.renderRelatedFeatures())}_setupRelatedFeatureViewModels(){const{relatedFeatureViewModels:e}=this.viewModel,t="related-feature-viewmodels";this.removeHandles(t),e==null||e.forEach(i=>{this.addHandles(we(()=>[i.title,i.state],()=>this.scheduleRender(),St),t)}),this.scheduleRender()}_setupFeatureElementInfo(){const{headingLevel:e,visibleElements:t}=this,i=t.description&&this.description,r=t.title&&this.title;this._featureElementInfo.set({description:i,title:r,headingLevel:e})}async _handleRelatedFeatureObserverChange(){this._unobserveRelatedFeatureObserver();const{state:e,showAllEnabled:t}=this.viewModel;await uw(0),this._relatedFeatureIntersectionObserverNode&&e==="ready"&&t&&this._relatedFeatureIntersectionObserver.observe(this._relatedFeatureIntersectionObserverNode)}_relatedFeatureIntersectionObserverCreated(e){this._relatedFeatureIntersectionObserverNode=e}_unobserveRelatedFeatureObserver(){this._relatedFeatureIntersectionObserverNode&&this._relatedFeatureIntersectionObserver.unobserve(this._relatedFeatureIntersectionObserverNode)}};g([w()],Oo.prototype,"_relatedFeatureIntersectionObserverNode",void 0),g([w({readOnly:!0})],Oo.prototype,"displayShowAllButton",null),g([w({readOnly:!0})],Oo.prototype,"displayListItems",null),g([w()],Oo.prototype,"description",null),g([w({readOnly:!0})],Oo.prototype,"featureCountDescription",null),g([w()],Oo.prototype,"headingLevel",void 0),g([w()],Oo.prototype,"title",null),g([w({type:EP})],Oo.prototype,"viewModel",void 0),g([w(),ci("esri/widgets/Feature/t9n/Feature")],Oo.prototype,"messages",void 0),g([w(),ci("esri/t9n/common")],Oo.prototype,"messagesCommon",void 0),g([w()],Oo.prototype,"visibleElements",void 0),g([Dt("visibleElements")],Oo.prototype,"castVisibleElements",null),Oo=g([te("esri.widgets.Feature.FeatureRelationship")],Oo);const LY=Oo;class $6e{constructor(t,i){this.preLayerQueryCallback=t,this.preRequestCallback=i,this.preLayerQueryCallback||(this.preLayerQueryCallback=r=>{}),this.preRequestCallback||(this.preLayerQueryCallback=r=>{})}}var N2;const E6e=1,OY="content-view-models",RY="relationship-view-models",FY={attachmentsContent:!0,chartAnimation:!0,customContent:!0,expressionContent:!0,fieldsContent:!0,mediaContent:!0,textContent:!0,relationshipContent:!0};let Fr=N2=class extends rc(Ye){constructor(e){super(e),this._handles=new Ti,this._error=null,this._featureAbortController=null,this._graphicChangedThrottled=Zg(this._graphicChanged,E6e,this),this._expressionAttributes=null,this._graphicExpressionAttributes=null,this.abilities=K({},FY),this.content=null,this.contentViewModels=[],this.description=null,this.defaultPopupTemplateEnabled=!1,this.formattedAttributes=null,this.lastEditInfo=null,this.relatedInfos=new Map,this.title="",this.view=null,this._isAllowedContentType=t=>{const{abilities:i}=this;return t.type==="attachments"&&i.attachmentsContent||t.type==="custom"&&i.customContent||t.type==="fields"&&i.fieldsContent||t.type==="media"&&i.mediaContent||t.type==="text"&&i.textContent||t.type==="expression"&&i.expressionContent||t.type==="relationship"&&i.relationshipContent},this._handles.add(we(()=>[this.graphic,this._effectivePopupTemplate,this.abilities],()=>this._graphicChangedThrottled(),St))}destroy(){this._clear(),this._cancelFeatureQuery(),this._error=null,this._handles.destroy(),this._handles=null,this.graphic=null,this._destroyContentViewModels(),this.relatedInfos.clear()}get _effectivePopupTemplate(){return H(this.graphic)?this.graphic.getEffectivePopupTemplate(this.defaultPopupTemplateEnabled):null}get _fieldInfoMap(){return J5e(yW(this._effectivePopupTemplate),this._sourceLayer)}get _sourceLayer(){return cW(this.graphic)}castAbilities(e){return K(K({},FY),e)}get state(){return this.graphic?this._error?"error":this.waitingForContent?"loading":"ready":"disabled"}set graphic(e){this._set("graphic",e?e.clone():null)}get spatialReference(){var e,t;return(t=(e=this.view)==null?void 0:e.spatialReference)!=null?t:null}set spatialReference(e){this._override("spatialReference",e)}get map(){var e;return((e=this.view)==null?void 0:e.map)||null}set map(e){this._override("map",e)}get waitingForContent(){return!!this._featureAbortController}setActiveMedia(e,t){const i=this.contentViewModels[e];i instanceof xy&&i.setActiveMedia(t)}nextMedia(e){const t=this.contentViewModels[e];t instanceof xy&&t.next()}previousMedia(e){const t=this.contentViewModels[e];t instanceof xy&&t.previous()}_clear(){this._set("title",""),this._set("content",null),this._set("formattedAttributes",null)}async _graphicChanged(){this._cancelFeatureQuery(),this._error=null,this._clear();const{graphic:e}=this;if(!e)return;const t=new AbortController;this._featureAbortController=t;try{await this._queryFeature({signal:t.signal})}catch(i){Xn(i)||(this._error=i,$e.getLogger(this.declaredClass).error("error","The popupTemplate could not be displayed for this feature.",{error:i,graphic:e,popupTemplate:this._effectivePopupTemplate}))}this._featureAbortController===t&&(this._featureAbortController=null)}_cancelFeatureQuery(){const{_featureAbortController:e}=this;e&&e.abort(),this._featureAbortController=null}_compileContentElement(e,t){return e.type==="attachments"?this._compileAttachments(e,t):e.type==="custom"?this._compileCustom(e,t):e.type==="fields"?this._compileFields(e,t):e.type==="media"?this._compileMedia(e,t):e.type==="text"?this._compileText(e,t):e.type==="expression"?this._compileExpression(e,t):e.type==="relationship"?this._compileRelationship(e,t):void 0}_compileContent(e){if(this._destroyContentViewModels(),this.graphic)return Array.isArray(e)?e.filter(this._isAllowedContentType).map((t,i)=>this._compileContentElement(t,i)):typeof e=="string"?this._compileText(new bg({text:e}),0).text:e}_destroyContentViewModels(){var e,t;(e=this._handles)==null||e.remove(RY),(t=this._handles)==null||t.remove(OY),this.contentViewModels.forEach(i=>i&&!i.destroyed&&i.destroy()),this._set("contentViewModels",[])}_matchesFeature(e,t){var n;const i=(n=e==null?void 0:e.graphic)==null?void 0:n.getObjectId(),r=t==null?void 0:t.getObjectId();return H(i)&&H(r)&&i===r}_setRelatedFeaturesViewModels({relatedFeatureViewModels:e,relatedFeatures:t,map:i}){t==null||t.filter(Boolean).forEach(r=>{e.find(n=>this._matchesFeature(n,r))||e.add(new N2({abilities:{relationshipContent:!1},map:i,graphic:r}))}),e.forEach(r=>{(t==null?void 0:t.find(o=>this._matchesFeature(r,o)))||e.remove(r)})}_setExpressionContentVM(e,t){const{formattedAttributes:i}=this,{contentElement:r,contentElementViewModel:n}=e,o=r==null?void 0:r.type;n&&o&&(o==="fields"&&(this._createFieldsFormattedAttributes({contentElement:r,contentElementIndex:t,formattedAttributes:i}),n.set(this._createFieldsVMParams(r,t))),o==="media"&&(this._createMediaFormattedAttributes({contentElement:r,contentElementIndex:t,formattedAttributes:i}),n.set(this._createMediaVMParams(r,t))),o==="text"&&n.set(this._createTextVMParams(r)))}_compileRelationship(e,t){const{displayCount:i,orderByFields:r,relationshipId:n,title:o,description:c}=e,{_sourceLayer:h,graphic:m,map:b}=this,x=new EP(K({displayCount:i,graphic:m,orderByFields:r,relationshipId:n,layer:h,map:b},this._compileTitleAndDesc({title:o,description:c})));return this.contentViewModels[t]=x,this._handles.add(vr(()=>x.relatedFeatures,"change",()=>this._setRelatedFeaturesViewModels(x)),RY),e}_compileExpression(e,t){const{expressionInfo:i}=e,{graphic:r,map:n,spatialReference:o,view:c}=this,h=new IP({expressionInfo:i,graphic:r,interceptor:N2.interceptor,map:n,spatialReference:o,view:c});return this.contentViewModels[t]=h,this._handles.add(we(()=>h.contentElementViewModel,()=>this._setExpressionContentVM(h,t),St),OY),e}_compileAttachments(e,t){const{graphic:i}=this,{description:r,title:n}=e;return this.contentViewModels[t]=new g7(K({graphic:i},this._compileTitleAndDesc({title:n,description:r}))),e}_compileCustom(e,t){const{graphic:i}=this,{creator:r,destroyer:n}=e;return this.contentViewModels[t]=new A9({graphic:i,creator:r,destroyer:n}),e}_compileTitleAndDesc({title:e,description:t}){const{_fieldInfoMap:i,_sourceLayer:r,graphic:n,formattedAttributes:o,_expressionAttributes:c}=this,{attributes:h}=n,m=o.global;return{title:py({attributes:h,fieldInfoMap:i,globalAttributes:m,expressionAttributes:c,layer:r,text:e}),description:py({attributes:h,fieldInfoMap:i,globalAttributes:m,expressionAttributes:c,layer:r,text:t})}}_createFieldsVMParams(e,t){var b;const{_effectivePopupTemplate:i,formattedAttributes:r}=this,n=K(K({},r.global),r.content[t]),o=(b=(e==null?void 0:e.fieldInfos)||(i==null?void 0:i.fieldInfos))==null?void 0:b.filter(({fieldName:x})=>c7(x)||Nh(x)||n.hasOwnProperty(x)),c=i==null?void 0:i.expressionInfos,{description:h,title:m}=e;return K({attributes:n,expressionInfos:c,fieldInfos:o},this._compileTitleAndDesc({title:m,description:h}))}_compileFields(e,t){const i=e.clone(),r=new L9(this._createFieldsVMParams(e,t));return this.contentViewModels[t]=r,i.fieldInfos=r.formattedFieldInfos.slice(0),i}_createMediaVMParams(e,t){const{abilities:i,graphic:r,_fieldInfoMap:n,formattedAttributes:o,_effectivePopupTemplate:c,relatedInfos:h,_sourceLayer:m,_expressionAttributes:b}=this,{attributes:x}=r,{description:I,mediaInfos:E,title:k}=e;return K({abilities:{chartAnimation:i.chartAnimation},activeMediaInfoIndex:e.activeMediaInfoIndex||0,attributes:x,layer:m,fieldInfoMap:n,formattedAttributes:K(K({},o.global),o.content[t]),expressionAttributes:b,mediaInfos:E,popupTemplate:c,relatedInfos:h},this._compileTitleAndDesc({title:k,description:I}))}_compileMedia(e,t){const i=e.clone(),r=new xy(this._createMediaVMParams(e,t));return i.mediaInfos=r.formattedMediaInfos.slice(0),this.contentViewModels[t]=r,i}_createTextVMParams(e){const{graphic:t,_fieldInfoMap:i,_sourceLayer:r,_expressionAttributes:n}=this;if(e&&e.text){const{attributes:o}=t,c=this.formattedAttributes.global;e.text=py({attributes:o,fieldInfoMap:i,globalAttributes:c,expressionAttributes:n,layer:r,text:e.text})}return{graphic:t,creator:e.text}}_compileText(e,t){const i=e.clone();return this.contentViewModels[t]=new A9(this._createTextVMParams(i)),i}_compileLastEditInfo(){const{_effectivePopupTemplate:e,_sourceLayer:t,graphic:i}=this;if(!e)return;const{lastEditInfoEnabled:r}=e,n=t==null?void 0:t.editFieldsInfo;return r&&n?W5e(n,i.attributes):void 0}_compileTitle(e){const{_fieldInfoMap:t,_sourceLayer:i,graphic:r,_expressionAttributes:n}=this,{attributes:o}=r,c=this.formattedAttributes.global;return py({attributes:o,fieldInfoMap:t,globalAttributes:c,expressionAttributes:n,layer:i,text:e})}async _getTitle(){const{_effectivePopupTemplate:e,graphic:t}=this,i=e==null?void 0:e.title;return C9(i,{graphic:t})}async _getContent(){const{_effectivePopupTemplate:e,graphic:t}=this,i=e==null?void 0:e.content;return C9(i,{graphic:t})}async _queryFeature(e){const{_featureAbortController:t,_sourceLayer:i,graphic:r,_effectivePopupTemplate:n,spatialReference:o,map:c,view:h}=this;if(t!==this._featureAbortController||!r)return;await Y5e({graphic:r,popupTemplate:n,layer:i,spatialReference:o},e);const{content:{value:m},title:{value:b}}=await Mr({content:this._getContent(),title:this._getTitle()}),{expressionAttributes:{value:x}}=await Mr({checkForRelatedFeatures:this._checkForRelatedFeatures(e),expressionAttributes:S6e({expressionInfos:n==null?void 0:n.expressionInfos,spatialReference:o,graphic:r,map:c,interceptor:N2.interceptor,view:h})});t===this._featureAbortController&&r&&(this._expressionAttributes=x,this._graphicExpressionAttributes=K(K({},r.attributes),x),this._set("formattedAttributes",this._createFormattedAttributes(m)),this._set("title",this._compileTitle(b)),this._set("lastEditInfo",this._compileLastEditInfo()||null),this._set("content",this._compileContent(m)||null))}_createMediaFormattedAttributes({contentElement:e,contentElementIndex:t,formattedAttributes:i}){const{_effectivePopupTemplate:r,graphic:n,relatedInfos:o,_sourceLayer:c,_fieldInfoMap:h,_graphicExpressionAttributes:m}=this;i.content[t]=f7({fieldInfos:r==null?void 0:r.fieldInfos,graphic:n,attributes:K(K({},m),e.attributes),layer:c,fieldInfoMap:h,relatedInfos:o})}_createFieldsFormattedAttributes({contentElement:e,contentElementIndex:t,formattedAttributes:i}){if(e.fieldInfos){const{graphic:r,relatedInfos:n,_sourceLayer:o,_fieldInfoMap:c,_graphicExpressionAttributes:h}=this;i.content[t]=f7({fieldInfos:e.fieldInfos,graphic:r,attributes:K(K({},h),e.attributes),layer:o,fieldInfoMap:c,relatedInfos:n})}}_createFormattedAttributes(e){const{_effectivePopupTemplate:t,graphic:i,relatedInfos:r,_sourceLayer:n,_fieldInfoMap:o,_graphicExpressionAttributes:c}=this,h=t==null?void 0:t.fieldInfos,m={global:f7({fieldInfos:h,graphic:i,attributes:c,layer:n,fieldInfoMap:o,relatedInfos:r}),content:[]};return Array.isArray(e)&&e.forEach((b,x)=>{b.type==="fields"&&this._createFieldsFormattedAttributes({contentElement:b,contentElementIndex:x,formattedAttributes:m}),b.type==="media"&&this._createMediaFormattedAttributes({contentElement:b,contentElementIndex:x,formattedAttributes:m})}),m}_checkForRelatedFeatures(e){const{graphic:t,_effectivePopupTemplate:i}=this;return this._queryRelatedInfos(t,yW(i),e)}async _queryRelatedInfos(e,t,i){const{relatedInfos:r,_sourceLayer:n}=this;r.clear();const o=H(n.associatedLayer)?await n.associatedLayer.load(i):n;if(!o)return;const c=t.filter(b=>b&&Nh(b.fieldName));if(!c||!c.length)return;t.forEach(b=>this._configureRelatedInfo(b,o));const h=await h4e({relatedInfos:r,layer:o},i);Object.keys(h).forEach(b=>{var E;const x=r.get(b.toString()),I=(E=h[b])==null?void 0:E.value;x&&I&&(x.layerInfo=I.data)});const m=await p4e({graphic:e,relatedInfos:r,layer:o},i);Object.keys(m).forEach(b=>{var x;o4e((x=m[b])==null?void 0:x.value,r.get(b.toString()))})}_configureRelatedInfo(e,t){const{relatedInfos:i}=this,r=xA(e.fieldName);if(!r)return;const{layerId:n,fieldName:o}=r;if(!n)return;const c=i.get(n.toString())||s4e(n,t);c&&(d4e({relatedInfo:c,fieldName:o,fieldInfo:e}),this.relatedInfos.set(n,c))}};Fr.interceptor=new $6e(e9e,t9e),g([w()],Fr.prototype,"_error",void 0),g([w()],Fr.prototype,"_featureAbortController",void 0),g([w({readOnly:!0})],Fr.prototype,"_effectivePopupTemplate",null),g([w({readOnly:!0})],Fr.prototype,"_fieldInfoMap",null),g([w({readOnly:!0})],Fr.prototype,"_sourceLayer",null),g([w()],Fr.prototype,"abilities",void 0),g([Dt("abilities")],Fr.prototype,"castAbilities",null),g([w({readOnly:!0})],Fr.prototype,"content",void 0),g([w({readOnly:!0})],Fr.prototype,"contentViewModels",void 0),g([w()],Fr.prototype,"description",void 0),g([w({type:Boolean})],Fr.prototype,"defaultPopupTemplateEnabled",void 0),g([w({readOnly:!0})],Fr.prototype,"state",null),g([w({readOnly:!0})],Fr.prototype,"formattedAttributes",void 0),g([w({type:Gr,value:null})],Fr.prototype,"graphic",null),g([w({readOnly:!0})],Fr.prototype,"lastEditInfo",void 0),g([w({readOnly:!0})],Fr.prototype,"relatedInfos",void 0),g([w()],Fr.prototype,"spatialReference",null),g([w({readOnly:!0})],Fr.prototype,"title",void 0),g([w()],Fr.prototype,"map",null),g([w({readOnly:!0})],Fr.prototype,"waitingForContent",null),g([w()],Fr.prototype,"view",void 0),Fr=N2=g([te("esri.widgets.FeatureViewModel")],Fr);const TP=Fr,Hr={iconText:"esri-icon-font-fallback-text",iconLoading:"esri-icon-loading-indicator esri-rotating",esriTable:"esri-widget__table",esriWidget:"esri-widget",base:"esri-feature",container:"esri-feature__size-container",title:"esri-feature__title",main:"esri-feature__main-container",btn:"esri-feature__button",icon:"esri-feature__icon",content:"esri-feature__content",contentNode:"esri-feature__content-node",contentElement:"esri-feature__content-element",text:"esri-feature__text",lastEditedInfo:"esri-feature__last-edited-info",fields:"esri-feature__fields",fieldHeader:"esri-feature__field-header",fieldData:"esri-feature__field-data",fieldDataDate:"esri-feature__field-data--date",loadingSpinnerContainer:"esri-feature__loading-container",spinner:"esri-feature__loading-spinner"},NY=e=>{let t=class extends e{constructor(){super(...arguments),this.renderNodeContent=i=>s1(i)&&!i.destroyed?j("div",{class:Hr.contentNode,key:i},i.render()):i instanceof HTMLElement?j("div",{class:Hr.contentNode,key:i,bind:i,afterCreate:this._attachToNode}):TW(i)?j("div",{class:Hr.contentNode,key:i,bind:i.domNode,afterCreate:this._attachToNode}):null}_attachToNode(i){const r=this;i.appendChild(r)}};return t=g([te("esri.widgets.Feature.ContentMixin")],t),t};var CP;const DY={title:!0,content:!0,lastEditedInfo:!0},jY="relationship-handles";let Ts=CP=class extends NY(ki){constructor(e,t){super(e,t),this._contentWidgets=[],this.flowItems=null,this.headingLevel=2,this.messages=null,this.messagesCommon=null,this.messagesURIUtils=null,this.visibleElements=K({},DY),this.viewModel=new TP}initialize(){this.addHandles(we(()=>{var e;return(e=this.viewModel)==null?void 0:e.contentViewModels},()=>this._setupContentWidgets(),St))}loadDependencies(){return import("./calcite-notice.c23c51a9.js")}destroy(){this._destroyContentWidgets()}get graphic(){return this.viewModel.graphic}set graphic(e){this.viewModel.graphic=e}get defaultPopupTemplateEnabled(){return this.viewModel.defaultPopupTemplateEnabled}set defaultPopupTemplateEnabled(e){this.viewModel.defaultPopupTemplateEnabled=e}get label(){var e,t;return(t=(e=this.messages)==null?void 0:e.widgetLabel)!=null?t:""}set label(e){this._overrideIfSome("label",e)}get spatialReference(){return this.viewModel.spatialReference}set spatialReference(e){this.viewModel.spatialReference=e}get title(){return this.viewModel.title}castVisibleElements(e){return K(K({},DY),e)}get map(){return this.viewModel.map}set map(e){this.viewModel.map=e}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}render(){const{state:e}=this.viewModel,t=j("div",{class:Hr.container,key:"container"},this.renderTitle(),e==="error"?this.renderError():e==="loading"?this.renderLoading():this.renderContentContainer());return j("div",{class:this.classes(Hr.base,Hr.esriWidget)},t)}setActiveMedia(e,t){return this.viewModel.setActiveMedia(e,t)}nextMedia(e){return this.viewModel.nextMedia(e)}previousMedia(e){return this.viewModel.previousMedia(e)}renderError(){const{messagesCommon:e,messages:t,visibleElements:i}=this;return j("calcite-notice",{active:!0,color:"red",icon:"exclamation-mark-circle",scale:"s"},i.title?j("div",{key:"error-title",slot:"title"},e.errorMessage):null,j("div",{key:"error-message",slot:"message"},t.loadingError))}renderLoading(){return j("div",{key:"loading-container",class:Hr.loadingSpinnerContainer},j("span",{class:this.classes(Hr.iconLoading,Hr.spinner)}))}renderContentContainer(){const{visibleElements:e}=this;return e.content?j("div",{class:Hr.main},[this.renderContent(),this.renderLastEditInfo()]):null}renderTitle(){const{visibleElements:e,title:t}=this;return e.title?j(Va,{level:this.headingLevel,class:Hr.title,innerHTML:t}):null}renderContent(){const e=this.viewModel.content,t="content";if(!e)return null;if(Array.isArray(e))return e.length?j("div",{class:Hr.contentNode,key:`${t}-content-elements`},e.map(this.renderContentElement,this)):null;if(typeof e=="string"){const i=this._contentWidgets[0];return!i||i.destroyed?null:j("div",{class:Hr.contentNode,key:`${t}-content`},i.render())}return this.renderNodeContent(e)}renderContentElement(e,t){const{visibleElements:i}=this;if(typeof i.content!="boolean"&&!i.content[e.type])return null;switch(e.type){case"attachments":return this.renderAttachments(t);case"custom":return this.renderCustom(e,t);case"fields":return this.renderFields(t);case"media":return this.renderMedia(t);case"text":return this.renderText(e,t);case"expression":return this.renderExpression(t);case"relationship":return this.renderRelationship(t);default:return null}}renderAttachments(e){const t=this._contentWidgets[e];if(!t||t.destroyed)return null;const{state:i,attachmentInfos:r}=t.viewModel;return i==="loading"||r.length>0?j("div",{key:this._buildKey("attachments-element",e),class:this.classes(Hr.contentElement)},t.render()):null}renderRelationship(e){const t=this._contentWidgets[e];return t&&!t.destroyed&&this.flowItems?j("div",{key:this._buildKey("relationship-element",e),class:Hr.contentElement},t.render()):null}renderExpression(e){const t=this._contentWidgets[e];return!t||t.destroyed?null:j("div",{key:this._buildKey("expression-element",e),class:Hr.contentElement},t.render())}renderCustom(e,t){const{creator:i}=e,r=this._contentWidgets[t];return!r||r.destroyed?null:i?j("div",{key:this._buildKey("custom-element",t),class:Hr.contentElement},r.render()):null}renderFields(e){const t=this._contentWidgets[e];return!t||t.destroyed?null:j("div",{key:this._buildKey("fields-element",e),class:Hr.contentElement},t.render())}renderMedia(e){const t=this._contentWidgets[e];return!t||t.destroyed?null:j("div",{key:this._buildKey("media-element",e),class:Hr.contentElement},t.render())}renderLastEditInfo(){const{visibleElements:e,messages:t}=this,{lastEditInfo:i}=this.viewModel;if(!i||!e.lastEditedInfo)return null;const{date:r,user:n}=i,o=i.type==="edit"?n?t.lastEditedByUser:t.lastEdited:n?t.lastCreatedByUser:t.lastCreated,c=oo(o,{date:r,user:n});return j("div",{key:"edit-info-element",class:this.classes(Hr.lastEditedInfo,Hr.contentElement)},c)}renderText(e,t){const i=e.text,r=this._contentWidgets[t];return!r||r.destroyed?null:i?j("div",{key:this._buildKey("text-element",t),class:this.classes(Hr.contentElement,Hr.text)},r.render()):null}_buildKey(e,...t){return`${e}__${this.get("viewModel.graphic.uid")||"0"}-${t.join("-")}`}_destroyContentWidget(e){e&&(e.viewModel=null,!e.destroyed&&e.destroy())}_destroyContentWidgets(){this.removeHandles(jY),this._contentWidgets.forEach(e=>this._destroyContentWidget(e)),this._contentWidgets=[]}_addFeatureRelationshipHandles(e){const{flowItems:t,visibleElements:i}=this;this.addHandles([vr(()=>e,"select-record",({featureViewModel:r})=>{t&&(r.abilities={relationshipContent:!0},t.push(new CP({flowItems:t,viewModel:r,visibleElements:i})))}),vr(()=>e,"show-all-records",()=>{if(!t)return;const{viewModel:r}=e;r.showAllEnabled=!0;const n=new LY({visibleElements:{title:!1,description:!1},viewModel:r});this._addFeatureRelationshipHandles(n),t.push(n)})],jY)}_setupContentWidgets(){this._destroyContentWidgets();const{headingLevel:e,visibleElements:t}=this,i=this.get("viewModel.content"),{contentViewModels:r}=this.viewModel;if(Array.isArray(i))i.forEach((n,o)=>{if(n.type==="attachments"&&(this._contentWidgets[o]=new u9e({displayType:n.displayType,headingLevel:t.title?e+1:e,viewModel:r[o]})),n.type==="fields"&&(this._contentWidgets[o]=new CW({viewModel:r[o]})),n.type==="media"&&(this._contentWidgets[o]=new lZ({viewModel:r[o]})),n.type==="text"&&(this._contentWidgets[o]=new P9({viewModel:r[o]})),n.type==="custom"&&(this._contentWidgets[o]=new P9({viewModel:r[o]})),n.type==="expression"&&(this._contentWidgets[o]=new I6e({viewModel:r[o]})),n.type==="relationship"){const c=new LY({viewModel:r[o]});this._addFeatureRelationshipHandles(c),this._contentWidgets[o]=c}},this);else{const n=r[0];n&&!n.destroyed&&(this._contentWidgets[0]=new P9({viewModel:n}))}this.scheduleRender()}};g([w()],Ts.prototype,"graphic",null),g([w()],Ts.prototype,"defaultPopupTemplateEnabled",null),g([w()],Ts.prototype,"flowItems",void 0),g([w()],Ts.prototype,"headingLevel",void 0),g([w()],Ts.prototype,"label",null),g([w(),ci("esri/widgets/Feature/t9n/Feature")],Ts.prototype,"messages",void 0),g([w(),ci("esri/t9n/common")],Ts.prototype,"messagesCommon",void 0),g([w(),ci("esri/widgets/support/t9n/uriUtils")],Ts.prototype,"messagesURIUtils",void 0),g([w()],Ts.prototype,"spatialReference",null),g([w({readOnly:!0})],Ts.prototype,"title",null),g([w()],Ts.prototype,"visibleElements",void 0),g([Dt("visibleElements")],Ts.prototype,"castVisibleElements",null),g([w()],Ts.prototype,"map",null),g([w()],Ts.prototype,"view",null),g([w({type:TP})],Ts.prototype,"viewModel",void 0),Ts=CP=g([te("esri.widgets.Feature")],Ts);const T6e=Ts;var VY;const GM=Symbol("anchorHandles");let Dy=class extends Or.EventedAccessor{constructor(e){super(e),this[VY]=new Ti,this.location=null,this.screenLocationEnabled=!1,this.view=null,this[GM].add([os(()=>ch(this.screenLocationEnabled?this.view:null,t=>[t.size,t.type==="3d"?t.camera:t.viewpoint]),()=>this.notifyChange("screenLocation")),we(()=>this.screenLocation,(t,i)=>{H(t)&&H(i)&&this.emit("view-change")})])}destroy(){this.view=null,this[GM]=li(this[GM])}get screenLocation(){const{location:e,view:t,screenLocationEnabled:i}=this;return i&&H(e)&&H(t)&&t.ready?t.toScreen(e):null}};VY=GM,g([w()],Dy.prototype,"location",void 0),g([w()],Dy.prototype,"screenLocation",null),g([w()],Dy.prototype,"screenLocationEnabled",void 0),g([w()],Dy.prototype,"view",void 0),Dy=g([te("esri.widgets.support.AnchorElementViewModel")],Dy);const zY=Dy,C6e="esri.widgets.CompassViewModel";let BM=class extends zY{constructor(e){super(e),this.visible=!1}};g([w()],BM.prototype,"visible",void 0),BM=g([te(C6e)],BM);const GY=BM,kP={base:"esri-spinner",spinnerStart:"esri-spinner--start",spinnerFinish:"esri-spinner--finish"};let jy=class extends ki{constructor(e,t){super(e,t),this._animationDelay=500,this._animationPromise=null,this.viewModel=new GY}initialize(){this.addHandles(we(()=>this.visible,e=>this._visibleChange(e)))}destroy(){this._animationPromise=null}get location(){return this.viewModel.location}set location(e){this.viewModel.location=e}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}get visible(){return this.viewModel.visible}set visible(e){this.viewModel.visible=e}show(e){const{location:t,promise:i}=e;t&&(this.viewModel.location=t),this.visible=!0;const r=()=>this.hide();i&&i.catch(()=>{}).then(r)}hide(){this.visible=!1}render(){const{visible:e}=this,{screenLocation:t}=this.viewModel,i=!!t,r=e&&i,n=!e&&i,o={[kP.spinnerStart]:r,[kP.spinnerFinish]:n},c=this._getPositionStyles();return j("div",{class:this.classes(kP.base,o),styles:c})}_visibleChange(e){if(e)return void(this.viewModel.screenLocationEnabled=!0);const t=uw(this._animationDelay);this._animationPromise=t,t.catch(()=>{}).then(()=>{this._animationPromise===t&&(this.viewModel.screenLocationEnabled=!1,this._animationPromise=null)})}_getPositionStyles(){const{screenLocation:e,view:t}=this.viewModel;if(ce(t)||ce(e))return{};const{padding:i}=t;return{left:e.x-i.left+"px",top:e.y-i.top+"px"}}};g([w()],jy.prototype,"location",null),g([w()],jy.prototype,"view",null),g([w({type:GY})],jy.prototype,"viewModel",void 0),g([w()],jy.prototype,"visible",null),jy=g([te("esri.widgets.Spinner")],jy);const k6e=jy,A6e="OBJECTID";var zn;(function(e){e[e.size=22]="size",e[e.lineWidth=50]="lineWidth",e[e.maxSize=120]="maxSize",e[e.maxOutlineSize=80]="maxOutlineSize",e[e.tallSymbolWidth=20]="tallSymbolWidth"})(zn||(zn={}));const AP={fill:[{type:"path",path:"M -10,-10 L 10,0 L 10,10 L -10,10 L -10,-10 Z"}],squareFill:[{type:"path",path:"M -10,-10 L 10,-10 L 10,10 L -10,10 L -10,-10 Z"}],pathSymbol3DLayer:[{type:"path",path:"M 3,12 L 12,0 L 11,-2 L -4,5 L -1,5 L 1,7 L 3,10 L 3,12 Z"},{type:"circle",cx:-2,cy:10,r:5}],extrudeSymbol3DLayer:[{type:"path",path:"M -7,-5 L -2,0 L -2,7 L -7,3 L -7,-5 Z"},{type:"path",path:"M -2,0 L -2,7 L 10,-3 L 10,-10 L -2,0 Z"},{type:"path",path:"M -7,-5 L -2,0 L 10,-10 L -2,-10 L -7,-5 Z"}],cone:[{type:"path",path:"M 0,-10 L -8,5 L -4,6.5 L 0,7 L 4,6.5 L 8,5 Z"}],tallCone:[{type:"path",path:"M 0,-9 L -3.5,7 L -1.5,7.8 L 0,8 L 1.5,7.8 L 3.5,7 L 0,-9 Z"}],invertedCone:[{type:"path",path:"M 0,7 L -8,-8 L 8,-8 Z"},{type:"path",path:"M -8,-8 L -4,-9.5 L 0,-10 L 4,-9.5 L 8,-8 L 4,-6.5 L 0,-6 L -4,-6.5 Z"}],cube:[{type:"path",path:"M -10,-7 L 0,-12 L 10,-7 L 0,-2 L -10,-7 Z"},{type:"path",path:"M -10,-7 L 0,-2 L 0,12 L -10,7 L -10,-7 Z"},{type:"path",path:"M 0,-2 L 10,-7 L 10,7 L 0,12 L 0,-2 Z"}],tallCube:[{type:"path",path:"M -3.5,-8.5 L 0,-9.5 L 3.5,-8.5 L 0,-7.5 L -3.5,-8.5 Z"},{type:"path",path:"M -3.5,-8.5 L 0,-7.5 L 0,9 L -3.5,8 L -3.5,-8.5 Z"},{type:"path",path:"M 0,-7.5 L 3.5,-8.5 L 3.5,8 L 0,9 L 0,-7.5 Z"}],cylinder:[{type:"path",path:"M -8,-9 L -8,7 L -4,8.5 L 0,9 L 4,8.5 L 8,7 L 8,-9 Z"},{type:"ellipse",cx:0,cy:-9,rx:8,ry:2}],tallCylinder:[{type:"path",path:"M -3.5,-9 L -3.5,7 L -1.5,7.8 L 0,8 L 1.5,7.8 L 3.5,7 L 3.5,-9 Z"},{type:"ellipse",cx:0,cy:-9,rx:3.5,ry:1}],diamond:[{type:"path",path:"M 0,-10 L 10,-1 L -1,1 L 0,-10 Z"},{type:"path",path:"M 0,-10 L -1,1 L -8,-1 L 0,-10 Z"},{type:"path",path:"M -1,1 L 0,10 L -8,-1 L -1,1 Z"},{type:"path",path:"M -1,0 L 0,10 L 10,-1 L -1,1 Z"}],tetrahedron:[{type:"path",path:"M 0,-10 L 10,7 L 0,0 L 0,-10 Z"},{type:"path",path:"M 0,-10 L 0,0 L -8,7 L 0,-10 Z"},{type:"path",path:"M 10,7 L 0,0 L -8,7 L 10,7 Z"}]};function P6e(e,t,i){const r=zn.size;let n=r,o=r;e<1?n*=.75:e>1&&(o*=1.25);const c=0,h=0;let m=r,b=r;return t&&i&&(n=o=m=b=0),[{type:"path",path:[{command:"M",values:[m,c]},{command:"L",values:[i?m:.875*m,c]},{command:"L",values:[i?n-.5*m:h,o-.5*b]},{command:"L",values:[n-.5*m,o-.5*b]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[m,c]},{command:"L",values:[m,t?c:.125*b]},{command:"L",values:[n-.5*m,t?o-.5*b:b]},{command:"L",values:[n-.5*m,o-.5*b]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[n-.5*m,o-.5*b]},{command:"L",values:[i?n-.5*m:h,o-.5*b]},{command:"L",values:[i?n-.5*m:h,t?o-.5*b:b]},{command:"L",values:[n-.5*m,t?o-.5*b:b]},{command:"Z",values:[]}]}]}function L6e(e){const t=zn.size,i=.5*e,r=0,n=0;return[{type:"path",path:[{command:"M",values:[n,.7*t*.5]},{command:"L",values:[.3*t,.7*t]},{command:"L",values:[.3*t,.7*t+i]},{command:"L",values:[n,.7*t+i-.7*t*.5]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[.3*t,.7*t]},{command:"L",values:[.3*t,.7*t+i]},{command:"L",values:[t,i]},{command:"L",values:[t,r]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[.3*t,r]},{command:"L",values:[t,r]},{command:"L",values:[.3*t,.7*t]},{command:"L",values:[n,.7*t*.5]},{command:"Z",values:[]}]}]}function O6e(){return[{type:"path",path:"M80,80.2v-27c-1.5,0.7-2.8,1.6-3.9,2.8c-1.8,2.1-4.4,3.3-7.1,3.5c-2.7-0.1-5.3-1.4-7.1-3.4c-2.2-2.3-4.7-3.6-7.4-3.6s-5.1,1.3-7.3,3.6c-1.8,2.1-4.4,3.3-7.2,3.4c-2.7-0.1-5.3-1.4-7.1-3.4c-2.2-2.3-4.7-3.6-7.4-3.6s-5.1,1.3-7.4,3.6c-1.8,2.1-4.4,3.3-7.2,3.4C8.3,59.3,5.7,58,3.9,56c-1.1-1.2-2.4-2.1-3.9-2.8v27"},{type:"path",path:"M11,59.4c2.7-0.1,5.3-1.4,7.1-3.4c2.2-2.3,4.7-3.6,7.4-3.6s5.1,1.3,7.4,3.6c1.8,2,4.4,3.3,7.2,3.4c2.7-0.1,5.3-1.4,7.1-3.4c2.2-2.3,4.7-3.6,7.3-3.6s5.1,1.3,7.4,3.6c1.8,2.1,4.4,3.3,7.2,3.4c2.7-0.1,5.3-1.4,7.1-3.4c1.1-1.2,2.4-2.1,3.9-2.8v-24c-1.5,0.7-2.8,1.6-3.9,2.8c-1.8,2.1-4.4,3.3-7.1,3.5c-2.7-0.1-5.3-1.4-7.1-3.4c-2.2-2.3-4.7-3.6-7.4-3.6s-5.1,1.3-7.3,3.6c-1.8,2.1-4.4,3.3-7.2,3.4c-2.7-0.1-5.3-1.4-7.1-3.4c-2.2-2.3-4.7-3.6-7.4-3.6s-5.1,1.3-7.4,3.6c-1.8,2.1-4.4,3.3-7.2,3.4c-2.7-0.1-5.3-1.4-7.1-3.4c-1.1-1.2-2.4-2.1-3.9-2.8v24c1.5,0.7,2.8,1.6,3.9,2.8C5.7,58,8.3,59.3,11,59.4z"},{type:"path",path:"M11,35.4c2.7-0.1,5.3-1.4,7.1-3.4c2.2-2.3,4.7-3.6,7.4-3.6s5.1,1.3,7.4,3.6c1.8,2,4.4,3.3,7.2,3.4c2.7-0.1,5.3-1.4,7.1-3.4c2.2-2.3,4.7-3.6,7.3-3.6s5.1,1.3,7.4,3.6c1.8,2.1,4.4,3.3,7.2,3.4c2.7-0.1,5.3-1.4,7.1-3.4c1.1-1.2,2.4-2.1,3.9-2.8V3.6c-1.5,0.7-2.8,1.6-3.9,2.8c-2.2,2.1-4.6,3.4-7.1,3.4s-5-1.3-7.1-3.4s-4.7-3.6-7.4-3.6s-5.1,1.3-7.3,3.6S42.5,9.9,40,9.9s-5-1.3-7.1-3.4s-4.7-3.6-7.4-3.6s-5.1,1.3-7.3,3.6c-1.8,2.1-4.4,3.3-7.2,3.4c-2.5,0-5-1.3-7.1-3.4C2.8,5.3,1.4,4.3,0,3.6v25.6c1.5,0.7,2.8,1.6,3.9,2.8C5.7,34.1,8.3,35.3,11,35.4z"}]}function R6e(e,t){let i=t?zn.tallSymbolWidth:e;const r=e,n=t?4:6;i<=zn.size?i-=.5*n:i-=n;const o=0,c=0,h=t?.35*i:.5*i;return[{type:"path",path:[{command:"M",values:[.5*i,o]},{command:"L",values:[i,.5*h]},{command:"L",values:[.5*i,h]},{command:"L",values:[c,.5*h]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[o,.5*h]},{command:"L",values:[.5*i,h]},{command:"L",values:[.5*i,r]},{command:"L",values:[c,r-.5*h]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[.5*i,h]},{command:"L",values:[.5*i,r]},{command:"L",values:[i,r-.5*h]},{command:"L",values:[i,.5*h]},{command:"Z",values:[]}]}]}function F6e(e,t){let i=t?zn.tallSymbolWidth:e;const r=e,n=t?4:6;i<=zn.size?i-=.5*n:i-=n;const o=.5*i,c=.15*i,h=0,m=r-c;return[{type:"ellipse",cx:.5*i,cy:m,rx:o,ry:c},{type:"path",path:[{command:"M",values:[h,c]},{command:"L",values:[h,m]},{command:"L",values:[i,m]},{command:"L",values:[i,c]},{command:"Z",values:[]}]},{type:"ellipse",cx:.5*i,cy:c,rx:o,ry:c}]}function N6e(e,t){let i=t?zn.tallSymbolWidth:e;const r=e,n=t?4:6;i<=zn.size?i-=.5*n:i-=n;const o=.15*i,c=r-o;return[{type:"ellipse",cx:.5*i,cy:c,rx:.5*i,ry:o},{type:"path",path:[{command:"M",values:[.5*i,0]},{command:"L",values:[i,c]},{command:"L",values:[0,c]},{command:"Z",values:[]}]}]}function D6e(e){let t=e;const i=e,r=6;t<zn.size?t-=.5*r:t-=r;const n=.15*t,o=0;return[{type:"path",path:[{command:"M",values:[0,o]},{command:"L",values:[t,o]},{command:"L",values:[.5*t,i-n]},{command:"Z",values:[]}]},{type:"ellipse",cx:.5*t,cy:o,rx:.5*t,ry:n}]}function j6e(e){let t=e;const i=e,r=4;t<zn.size?t-=.5*r:t-=r;const n=0,o=0,c=t,h=i,m=Math.floor(e/10)-1||1;return[{type:"path",path:[{command:"M",values:[.45*c,n]},{command:"L",values:[c,.5*h-m]},{command:"L",values:[.45*c-m,.5*h+m]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[.45*c,n]},{command:"L",values:[.45*c-m,.5*h+m]},{command:"L",values:[o,.5*h-m]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[o,.5*h-m]},{command:"L",values:[.45*c-m,.5*h+m]},{command:"L",values:[.45*c,i]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[.45*c,i]},{command:"L",values:[c,.5*h-m]},{command:"L",values:[.45*c-m,.5*h+m]},{command:"Z",values:[]}]}]}function V6e(e){const t=e,i=2;let r=e;r<zn.size?r-=.5*i:r-=i;const n=0,o=0;return[{type:"path",path:[{command:"M",values:[.45*t,n]},{command:"L",values:[t,r]},{command:"L",values:[.45*t,.6*r]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[.45*t,n]},{command:"L",values:[.45*t,.6*r]},{command:"L",values:[o,r]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[o,r]},{command:"L",values:[.45*t,.6*r]},{command:"L",values:[t,r]},{command:"Z",values:[]}]}]}function mf(e,t){const i=.75;return Math.round(Math.min(Math.max(e+255*t*i,0),255))}function mKe(e,t){if(e==null)return new ut;if("type"in e&&(e.type==="linear"||e.type==="pattern"))return e;const i=new ut(e);return new ut([mf(i.r,t),mf(i.g,t),mf(i.b,t),i.a])}function z6e(e){return"r"in e&&"g"in e&&"b"in e}function BY(e){return"h"in e&&"s"in e&&"v"in e}function UY(e){return"l"in e&&"a"in e&&"b"in e}function qY(e){return"l"in e&&"c"in e&&"h"in e}function G6e(e){return"x"in e&&"y"in e&&"z"in e}const B6e=[[.4124,.3576,.1805],[.2126,.7152,.0722],[.0193,.1192,.9505]],U6e=[[3.2406,-1.5372,-.4986],[-.9689,1.8758,.0415],[.0557,-.204,1.057]];function HY(e,t){const i=[];let r,n;if(e[0].length!==t.length)throw"dimensions do not match";const o=e.length,c=e[0].length;let h=0;for(r=0;r<o;r++){for(h=0,n=0;n<c;n++)h+=e[r][n]*t[n];i.push(h)}return i}function WY(e){const t=[e.r/255,e.g/255,e.b/255].map(r=>r<=.04045?r/12.92:((r+.055)/1.055)**2.4),i=HY(B6e,t);return{x:100*i[0],y:100*i[1],z:100*i[2]}}function PP(e){const t=HY(U6e,[e.x/100,e.y/100,e.z/100]).map(i=>{const r=i<=.0031308?12.92*i:1.055*i**(1/2.4)-.055;return Math.min(1,Math.max(r,0))});return{r:Math.round(255*t[0]),g:Math.round(255*t[1]),b:Math.round(255*t[2])}}function JY(e){const t=[e.x/95.047,e.y/100,e.z/108.883].map(i=>i>(6/29)**3?i**(1/3):1/3*(29/6)**2*i+4/29);return{l:116*t[1]-16,a:500*(t[0]-t[1]),b:200*(t[1]-t[2])}}function ZY(e){const t=e.l,i=[(t+16)/116+e.a/500,(t+16)/116,(t+16)/116-e.b/200].map(r=>r>6/29?r**3:3*(6/29)**2*(r-4/29));return{x:95.047*i[0],y:100*i[1],z:108.883*i[2]}}function q6e(e){const t=e.l,i=e.a,r=e.b,n=Math.sqrt(i*i+r*r);let o=Math.atan2(r,i);return o=o>0?o:o+2*Math.PI,{l:t,c:n,h:o}}function H6e(e){const t=e.l,i=e.c,r=e.h;return{l:t,a:i*Math.cos(r),b:i*Math.sin(r)}}function KY(e){return JY(WY(e))}function YY(e){return PP(ZY(e))}function W6e(e){return q6e(JY(WY(e)))}function J6e(e){return PP(ZY(H6e(e)))}function Z6e(e){const t=e.r,i=e.g,r=e.b,n=Math.max(t,i,r),o=n-Math.min(t,i,r);let c=n,h=o===0?0:n===t?(i-r)/o%6:n===i?(r-t)/o+2:(t-i)/o+4,m=o===0?0:o/c;return h<0&&(h+=6),h*=60,m*=100,c*=100/255,{h,s:m,v:c}}function K6e(e){const t=(e.h+360)%360/60,i=e.s/100,r=e.v/100*255,n=r*i,o=n*(1-Math.abs(t%2-1));let c;switch(Math.floor(t)){case 0:c={r:n,g:o,b:0};break;case 1:c={r:o,g:n,b:0};break;case 2:c={r:0,g:n,b:o};break;case 3:c={r:0,g:o,b:n};break;case 4:c={r:o,g:0,b:n};break;case 5:case 6:c={r:n,g:0,b:o};break;default:c={r:0,g:0,b:0}}return c.r=Math.round(c.r+r-n),c.g=Math.round(c.g+r-n),c.b=Math.round(c.b+r-n),c}function D2(e){return z6e(e)?e:qY(e)?J6e(e):UY(e)?YY(e):G6e(e)?PP(e):BY(e)?K6e(e):e}function LP(e){return BY(e)?e:Z6e(D2(e))}function gKe(e){return UY(e)?e:KY(D2(e))}function vKe(e){return qY(e)?e:W6e(D2(e))}function bKe(e,t){const i=KY(e);return i.l*=1-t,YY(i)}function UM(){const e=new Float32Array(6);return e[0]=1,e[3]=1,e}function Y6e(e){const t=new Float32Array(6);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t}function X6e(e,t,i,r,n,o){const c=new Float32Array(6);return c[0]=e,c[1]=t,c[2]=i,c[3]=r,c[4]=n,c[5]=o,c}function Q6e(e,t){return new Float32Array(e,t,6)}function XY(e,t,i,r){const n=t[r],o=t[r+1];e[r]=i[0]*n+i[2]*o+i[4],e[r+1]=i[1]*n+i[3]*o+i[5]}function eCe(e,t,i,r=0,n=0,o=2){const c=n||t.length/o;for(let h=r;h<c;h++)XY(e,t,i,h*o)}Object.freeze(Object.defineProperty({__proto__:null,create:UM,clone:Y6e,fromValues:X6e,createView:Q6e,transform:XY,transformMany:eCe},Symbol.toStringTag,{value:"Module"}));function tCe(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e}function qM(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=1,e[4]=0,e[5]=0,e}function iCe(e,t,i,r,n,o,c){return e[0]=t,e[1]=i,e[2]=r,e[3]=n,e[4]=o,e[5]=c,e}function HM(e,t){const i=t[0],r=t[1],n=t[2],o=t[3],c=t[4],h=t[5];let m=i*o-r*n;return m?(m=1/m,e[0]=o*m,e[1]=-r*m,e[2]=-n*m,e[3]=i*m,e[4]=(n*h-o*c)*m,e[5]=(r*c-i*h)*m,e):null}function rCe(e){return e[0]*e[3]-e[1]*e[2]}function Vy(e,t,i){const r=t[0],n=t[1],o=t[2],c=t[3],h=t[4],m=t[5],b=i[0],x=i[1],I=i[2],E=i[3],k=i[4],P=i[5];return e[0]=r*b+o*x,e[1]=n*b+c*x,e[2]=r*I+o*E,e[3]=n*I+c*E,e[4]=r*k+o*P+h,e[5]=n*k+c*P+m,e}function j2(e,t,i){const r=t[0],n=t[1],o=t[2],c=t[3],h=t[4],m=t[5],b=Math.sin(i),x=Math.cos(i);return e[0]=r*x+o*b,e[1]=n*x+c*b,e[2]=r*-b+o*x,e[3]=n*-b+c*x,e[4]=h,e[5]=m,e}function WM(e,t,i){const r=t[0],n=t[1],o=t[2],c=t[3],h=t[4],m=t[5],b=i[0],x=i[1];return e[0]=r*b,e[1]=n*b,e[2]=o*x,e[3]=c*x,e[4]=h,e[5]=m,e}function U1(e,t,i){const r=t[0],n=t[1],o=t[2],c=t[3],h=t[4],m=t[5],b=i[0],x=i[1];return e[0]=r,e[1]=n,e[2]=o,e[3]=c,e[4]=r*b+o*x+h,e[5]=n*b+c*x+m,e}function QY(e,t){const i=Math.sin(t),r=Math.cos(t);return e[0]=r,e[1]=i,e[2]=-i,e[3]=r,e[4]=0,e[5]=0,e}function eX(e,t){return e[0]=t[0],e[1]=0,e[2]=0,e[3]=t[1],e[4]=0,e[5]=0,e}function OP(e,t){return e[0]=1,e[1]=0,e[2]=0,e[3]=1,e[4]=t[0],e[5]=t[1],e}function nCe(e){return"mat2d("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+")"}function sCe(e){return Math.sqrt(e[0]**2+e[1]**2+e[2]**2+e[3]**2+e[4]**2+e[5]**2+1)}function oCe(e,t,i){return e[0]=t[0]+i[0],e[1]=t[1]+i[1],e[2]=t[2]+i[2],e[3]=t[3]+i[3],e[4]=t[4]+i[4],e[5]=t[5]+i[5],e}function tX(e,t,i){return e[0]=t[0]-i[0],e[1]=t[1]-i[1],e[2]=t[2]-i[2],e[3]=t[3]-i[3],e[4]=t[4]-i[4],e[5]=t[5]-i[5],e}function aCe(e,t,i){return e[0]=t[0]*i,e[1]=t[1]*i,e[2]=t[2]*i,e[3]=t[3]*i,e[4]=t[4]*i,e[5]=t[5]*i,e}function lCe(e,t,i,r){return e[0]=t[0]+i[0]*r,e[1]=t[1]+i[1]*r,e[2]=t[2]+i[2]*r,e[3]=t[3]+i[3]*r,e[4]=t[4]+i[4]*r,e[5]=t[5]+i[5]*r,e}function cCe(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]&&e[4]===t[4]&&e[5]===t[5]}function uCe(e,t){const i=e[0],r=e[1],n=e[2],o=e[3],c=e[4],h=e[5],m=t[0],b=t[1],x=t[2],I=t[3],E=t[4],k=t[5],P=Zo();return Math.abs(i-m)<=P*Math.max(1,Math.abs(i),Math.abs(m))&&Math.abs(r-b)<=P*Math.max(1,Math.abs(r),Math.abs(b))&&Math.abs(n-x)<=P*Math.max(1,Math.abs(n),Math.abs(x))&&Math.abs(o-I)<=P*Math.max(1,Math.abs(o),Math.abs(I))&&Math.abs(c-E)<=P*Math.max(1,Math.abs(c),Math.abs(E))&&Math.abs(h-k)<=P*Math.max(1,Math.abs(h),Math.abs(k))}const hCe=Vy,pCe=tX;Object.freeze(Object.defineProperty({__proto__:null,copy:tCe,identity:qM,set:iCe,invert:HM,determinant:rCe,multiply:Vy,rotate:j2,scale:WM,translate:U1,fromRotation:QY,fromScaling:eX,fromTranslation:OP,str:nCe,frob:sCe,add:oCe,subtract:tX,multiplyScalar:aCe,multiplyScalarAndAdd:lCe,exactEquals:cCe,equals:uCe,mul:hCe,sub:pCe},Symbol.toStringTag,{value:"Module"}));const dCe="http://www.w3.org/2000/svg";let fCe=0,yCe=0;const iX=Te("android"),mCe=Te("chrome")||iX&&iX>=4?"auto":"optimizeLegibility",gCe={m:2,l:2,h:1,v:1,c:6,s:4,q:4,t:2,a:7,z:0},vCe=/([A-DF-Za-df-z])|([-+]?\d*[.]?\d+(?:[eE][-+]?\d+)?)/g;let Wr={},Hi={};const rX={solid:"none",shortdash:[4,1],shortdot:[1,1],shortdashdot:[4,1,1,1],shortdashdotdot:[4,1,1,1,1,1],dot:[1,3],dash:[4,3],longdash:[8,3],dashdot:[4,3,1,3],longdashdot:[8,3,1,3],longdashdotdot:[8,3,1,3,1,3]},bCe=Math.PI;let wCe=1;function q1(e,t){const i=e*(bCe/180);return Math.abs(t*Math.sin(i))+Math.abs(t*Math.cos(i))}function nX(e){return e.map(t=>`${t.command} ${t.values.join(" ")}`).join(" ").trim()}function RP(e,t,i,r){if(e){if(e.type==="circle")return j("circle",{fill:t,"fill-rule":"evenodd",stroke:i.color,"stroke-width":i.width,"stroke-linecap":i.cap,"stroke-linejoin":i.join,"stroke-dasharray":i.dashArray,"stroke-dashoffset":i.dashOffset,"stroke-miterlimit":"4",cx:e.cx,cy:e.cy,r:e.r});if(e.type==="ellipse")return j("ellipse",{fill:t,"fill-rule":"evenodd",stroke:i.color,"stroke-width":i.width,"stroke-linecap":i.cap,"stroke-linejoin":i.join,"stroke-dasharray":i.dashArray,"stroke-miterlimit":"4",cx:e.cx,cy:e.cy,rx:e.rx,ry:e.ry});if(e.type==="rect")return j("rect",{fill:t,"fill-rule":"evenodd",stroke:i.color,"stroke-width":i.width,"stroke-linecap":i.cap,"stroke-linejoin":i.join,"stroke-dasharray":i.dashArray,"stroke-miterlimit":"4",x:e.x,y:e.y,width:e.width,height:e.height});if(e.type==="image")return j("image",{href:e.src,x:e.x,y:e.y,width:e.width,height:e.height,preserveAspectRatio:"none"});if(e.type==="path"){const n=typeof e.path!="string"?nX(e.path):e.path;return j("path",{fill:t,"fill-rule":"evenodd",stroke:i.color,"stroke-width":i.width,"stroke-linecap":i.cap,"stroke-linejoin":i.join,"stroke-dasharray":i.dashArray,"stroke-miterlimit":"4",d:n})}if(e.type==="text")return Zm(r),j("text",{"dominant-baseline":r.dominantBaseline,fill:t,"fill-rule":"evenodd",stroke:i.color,"stroke-width":i.width,"stroke-linecap":i.cap,"stroke-linejoin":i.join,"stroke-dasharray":i.dashArray,"stroke-miterlimit":"4","text-anchor":r.align,"text-decoration":r.decoration,kerning:r.kerning,rotate:r.rotate,"text-rendering":mCe,"font-style":r.font.style,"font-variant":r.font.variant,"font-weight":r.font.weight,"font-size":r.font.size,"font-family":r.font.family,x:e.x,y:e.y},e.text)}return null}function FP(e){const t={fill:"none",pattern:null,linearGradient:null};if(e){if("type"in e&&e.type==="pattern"){const i="patternId-"+ ++fCe;t.fill=`url(#${i})`,t.pattern={id:i,x:e.x,y:e.y,width:e.width,height:e.height,image:{x:0,y:0,width:e.width,height:e.height,href:e.src}}}else if("type"in e&&e.type==="linear"){const i="linearGradientId-"+ ++yCe;t.fill=`url(#${i})`,t.linearGradient={id:i,x1:e.x1,y1:e.y1,x2:e.x2,y2:e.y2,stops:e.colors.map(r=>({offset:r.offset,color:r.color&&new ut(r.color).toString()}))}}else if(e){const i=new ut(e);t.fill=i.toString()}}return t}function NP(e){var i;const t={color:"none",width:1,cap:"butt",join:"4",dashArray:"none",dashOffset:"0"};if(e&&(e.width!=null&&(t.width=e.width),e.cap&&(t.cap=e.cap),e.join&&(t.join=e.join.toString()),e.color&&(t.color=new ut(e.color).toString()),e.dashArray&&(t.dashArray=e.dashArray),e.dashArray&&(t.dashOffset=e.dashoffset),e.style)){let r=null;if(e.style in rX&&(r=rX[e.style]),Array.isArray(r)){r=r.slice(0);const n=(i=e.width)!=null?i:0;for(let o=0;o<r.length;++o)r[o]*=n;if(e.cap!=="butt"){for(let o=0;o<r.length;o+=2)r[o]-=n,r[o]<1&&(r[o]=1);for(let o=1;o<r.length;o+=2)r[o]+=n}r=r.join(",")}t.dashArray=r}return t}function sX(e,t){const i={align:null,decoration:null,kerning:null,rotate:null,font:{style:null,variant:null,weight:null,size:null,family:null}};if(e){const r=e.alignBaseline,n=r==="baseline"?"auto":r==="top"?"text-top":r==="bottom"?"hanging":r;i.align=e.align,i.dominantBaseline=n,i.decoration=e.decoration,i.kerning=e.kerning?"auto":"0",i.rotate=e.rotated?"90":"0",Zm(t),i.font.style=t.style||"normal",i.font.variant=t.variant||"normal",i.font.weight=t.weight||"normal",i.font.size=t.size&&t.size.toString()||"10pt",i.font.family=t.family||"serif"}return i}function oX(e){const{pattern:t,linearGradient:i}=e;if(t)return j("pattern",{id:t.id,patternUnits:"userSpaceOnUse",x:t.x,y:t.y,width:t.width,height:t.height},j("image",{x:t.image.x,y:t.image.y,width:t.image.width,height:t.image.height,href:t.image.href}));if(i){const r=i.stops.map((n,o)=>j("stop",{key:`${o}-stop`,offset:n.offset,"stop-color":n.color}));return j("linearGradient",{id:i.id,gradientUnits:"userSpaceOnUse",x1:i.x1,y1:i.y1,x2:i.x2,y2:i.y2},r)}return null}function _Ce(e,t){if(!e)return null;const i=[];for(const r of e){const{shape:n,fill:o,stroke:c,font:h}=r,m=FP(o),b=NP(c),x=n.type==="text"?sX(n,h):null,I=RP(n,m.fill,b,x);I&&i.push(I)}return j("mask",{id:t,maskUnits:"userSpaceOnUse"},j("g",null,i))}function aX(e,t,i){return U1(e,qM(e),[t,i])}function lX(e,t,i,r,n){return WM(e,qM(e),[t,i]),e[4]=e[4]*t-r*t+r,e[5]=e[5]*i-n*i+n,e}function xCe(e,t,i,r){const n=t%360*Math.PI/180;j2(e,qM(e),n);const o=Math.cos(n),c=Math.sin(n),h=e[4],m=e[5];return e[4]=h*o-m*c+r*c-i*o+i,e[5]=m*o+h*c-i*c-r*o+r,e}function Ro(e,t){Wr&&"left"in Wr?(Wr.left!=null&&Wr.left>e&&(Wr.left=e),(Wr.right==null||Wr.right<e)&&(Wr.right=e),(Wr.top==null||Wr.top>t)&&(Wr.top=t),(Wr.bottom==null||Wr.bottom<t)&&(Wr.bottom=t)):Wr={left:e,bottom:t,right:e,top:t}}function cX(e){const t=e.args,i=t.length;let r;switch(e.action){case"M":case"L":case"C":case"S":case"Q":case"T":for(r=0;r<i;r+=2)Ro(t[r],t[r+1]);Hi.x=t[i-2],Hi.y=t[i-1];break;case"H":for(r=0;r<i;++r)Ro(t[r],Hi.y);Hi.x=t[i-1];break;case"V":for(r=0;r<i;++r)Ro(Hi.x,t[r]);Hi.y=t[i-1];break;case"m":{let n=0;for(("x"in Hi)||(Ro(Hi.x=t[0],Hi.y=t[1]),n=2),r=n;r<i;r+=2)Ro(Hi.x+=t[r],Hi.y+=t[r+1]);break}case"l":case"t":for(r=0;r<i;r+=2)Ro(Hi.x+=t[r],Hi.y+=t[r+1]);break;case"h":for(r=0;r<i;++r)Ro(Hi.x+=t[r],Hi.y);break;case"v":for(r=0;r<i;++r)Ro(Hi.x,Hi.y+=t[r]);break;case"c":for(r=0;r<i;r+=6)Ro(Hi.x+t[r],Hi.y+t[r+1]),Ro(Hi.x+t[r+2],Hi.y+t[r+3]),Ro(Hi.x+=t[r+4],Hi.y+=t[r+5]);break;case"s":case"q":for(r=0;r<i;r+=4)Ro(Hi.x+t[r],Hi.y+t[r+1]),Ro(Hi.x+=t[r+2],Hi.y+=t[r+3]);break;case"A":for(r=0;r<i;r+=7)Ro(t[r+5],t[r+6]);Hi.x=t[i-2],Hi.y=t[i-1];break;case"a":for(r=0;r<i;r+=7)Ro(Hi.x+=t[r+5],Hi.y+=t[r+6])}}function uX(e,t,i){const r=gCe[e.toLowerCase()];let n;typeof r=="number"&&(r?t.length>=r&&(n={action:e,args:t.slice(0,t.length-t.length%r)},i.push(n),cX(n)):(n={action:e,args:[]},i.push(n),cX(n)))}function SCe(e){const t=(typeof e.path!="string"?nX(e.path):e.path).match(vCe),i=[];if(Wr={},Hi={},!t)return null;let r="",n=[];const o=t.length;for(let h=0;h<o;++h){const m=t[h],b=parseFloat(m);isNaN(b)?(r&&uX(r,n,i),n=[],r=m):n.push(b)}uX(r,n,i);const c={x:0,y:0,width:0,height:0};return Wr&&"left"in Wr&&(c.x=Wr.left,c.y=Wr.top,c.width=Wr.right-Wr.left,c.height=Wr.bottom-Wr.top),c}function hX(e){const t={x:0,y:0,width:0,height:0};if(e.type==="circle")t.x=e.cx-e.r,t.y=e.cy-e.r,t.width=2*e.r,t.height=2*e.r;else if(e.type==="ellipse")t.x=e.cx-e.rx,t.y=e.cy-e.ry,t.width=2*e.rx,t.height=2*e.ry;else if(e.type==="image"||e.type==="rect")t.x=e.x,t.y=e.y,t.width=e.width,t.height=e.height;else if(e.type==="path"){const i=Yn(SCe(e));t.x=i.x,t.y=i.y,t.width=i.width,t.height=i.height}return t}function pX(e){const t={x:0,y:0,width:0,height:0};let i=null,r=Number.NEGATIVE_INFINITY,n=Number.NEGATIVE_INFINITY;for(const o of e)i?(i.x=Math.min(i.x,o.x),i.y=Math.min(i.y,o.y),r=Math.max(r,o.x+o.width),n=Math.max(n,o.y+o.height)):(i=t,i.x=o.x,i.y=o.y,r=o.x+o.width,n=o.y+o.height);return i&&(i.width=r-i.x,i.height=n-i.y),i}function DP(e,t,i,r,n,o,c,h,m){let b=(c&&o?q1(o,t):t)/2,x=(c&&o?q1(o,i):i)/2;if(m){const z=m[0],q=m[1];b=(c&&o?q1(o,z):z)/2,x=(c&&o?q1(o,q):q)/2}const I=e.width+r,E=e.height+r,k=UM(),P=UM();let F=!1;if(n&&I!==0&&E!==0){const z=t!==i?t/i:I/E,q=t>i?t:i;let J=1,X=1;isNaN(q)||(z>1?(J=q/I,X=q/z/E):(X=q/E,J=q*z/I)),Vy(P,P,lX(k,J,X,b,x)),F=!0}const N=e.x+(I-r)/2,B=e.y+(E-r)/2;if(Vy(P,P,aX(k,b-N,x-B)),!F&&(I>t||E>i)){const z=I/t>E/i,q=(z?t:i)/(z?I:E);Vy(P,P,lX(k,q,q,N,B))}return o&&Vy(P,P,xCe(k,o,N,B)),h&&Vy(P,P,aX(k,h[0],h[1])),`matrix(${P[0]},${P[1]},${P[2]},${P[3]},${P[4]},${P[5]})`}function MCe(e,t,i){const r=e==null?void 0:e.effects.find(b=>b.type==="bloom");if(!r)return null;const{strength:n,radius:o}=r,c=n>0?o:0,h=(n+c)*t,m=4*n+1;return j("filter",{id:`bloom${i}`,x:"-100%",y:"-100%",width:"300%",height:"300%",filterUnits:"userSpaceOnUse"},j("feMorphology",{operator:"dilate",radius:(n+.5*c)*(5**(t/100)*(.4+t/100)),in:"SourceGraphic",result:"dilate"}),j("feGaussianBlur",{in:"dilate",stdDeviation:h/25,result:"blur"}),j("feGaussianBlur",{in:"blur",stdDeviation:h/50,result:"intensityBlur"}),j("feComponentTransfer",{in:"SourceGraphic",result:"intensityBrightness"},j("feFuncR",{type:"linear",slope:m}),j("feFuncG",{type:"linear",slope:m}),j("feFuncB",{type:"linear",slope:m})),j("feMerge",null,j("feMergeNode",{in:"intensityBlur"}),j("feMergeNode",{in:"intensityBrightness"}),j("feGaussianBlur",{stdDeviation:n/10})))}function dX(e,t,i,r={}){var b,x,I;const n=[],o=[],c=++wCe,h=MCe(r.effectView,t,c);let m=null;if(h){const E=(b=r.effectView)==null?void 0:b.effects.find(N=>N.type==="bloom"),k=(E.strength?E.strength+E.radius/2:0)/3,P=t+t*k,F=i+i*k;m=[Math.max(P,10),Math.max(F,10)]}for(let E=0;E<e.length;E++){const k=e[E],P=[],F=[];let N=0,B=0,z=0;for(const X of k){const{shape:Y,fill:ae,stroke:he,font:fe,offset:ye}=X;r.ignoreStrokeWidth||(N+=he&&he.width||0);const xe=FP(ae),Se=NP(he),Ae=Y.type==="text"?sX(Y,fe):null;n.push(oX(xe)),P.push(RP(Y,xe.fill,Se,Ae)),F.push(hX(Y)),ye&&(B+=ye[0],z+=ye[1])}const q=DP(Yn(pX(F)),t,i,N,(x=r.scale)!=null?x:!1,r.rotation,(I=r.useRotationSize)!=null?I:!1,[B,z],m);let J=null;if(r.masking){const X=`mask-${E}`,Y=r.masking[E];n.push(_Ce(Y,X)),J=`url(#${X})`}o.push(J?j("g",{mask:J},j("g",{transform:q},P)):j("g",{transform:q},P))}return r.useRotationSize&&r.rotation&&(t=q1(r.rotation,t),i=q1(r.rotation,i)),h&&(Zm(m),t=m[0],i=m[1]),j("svg",{xmlns:dCe,width:t,height:i,style:"display: block;"},h,j("defs",null,n),h?j("g",{filter:`url(#bloom${c})`},o):o)}const ICe=v9();function V2(e,t,i){const r=Math.ceil(t[0]),n=Math.ceil(t[1]);if(!e.some(c=>!!c.length))return null;const o=i&&i.node||document.createElement("div");return i.opacity!=null&&(o.style.opacity=i.opacity.toString()),i.effectView!=null&&(o.style.filter=Z_(i.effectView)),ICe.append(o,dX.bind(null,e,r,n,i)),o}function $Ce(e,t){e=Math.ceil(e),t=Math.ceil(t);const i=document.createElement("canvas");i.width=e,i.height=t,i.style.width=e+"px",i.style.height=t+"px";const r=i.getContext("2d");return r.clearRect(0,0,e,t),r}function ECe(e,t,i){return e?Nt(e,{responseType:"image"}).then(r=>{const n=r.data,o=n.width,c=n.height,h=o/c;let m=t;if(i){const b=Math.max(o,c);m=Math.min(m,b)}return{image:n,width:h<=1?Math.ceil(m*h):m,height:h<=1?m:Math.ceil(m/h)}}):Promise.reject(new ue("renderUtils: imageDataSize","href not provided."))}function TCe(e,t){return!(!e||t==="ignore")&&(t!=="multiply"||e.r!==255||e.g!==255||e.b!==255||e.a!==1)}function CCe(e,t,i,r,n){switch(n){case"multiply":e[t+0]*=i[0],e[t+1]*=i[1],e[t+2]*=i[2],e[t+3]*=i[3];break;default:{const o=LP({r:e[t+0],g:e[t+1],b:e[t+2]});o.h=r.h,o.s=r.s,o.v=o.v/100*r.v;const c=D2(o);e[t+0]=c.r,e[t+1]=c.g,e[t+2]=c.b,e[t+3]*=i[3];break}}}function kCe(e,t,i,r,n){return ECe(e,t,n).then(o=>{const c=o.width?o.width:t,h=o.height?o.height:t;if(o.image&&TCe(i,r)){let m=o.image.width,b=o.image.height;Te("edge")&&/\.svg$/i.test(e)&&(m-=1,b-=1);const x=$Ce(c,h);x.drawImage(o.image,0,0,m,b,0,0,c,h);const I=x.getImageData(0,0,c,h),E=[i.r/255,i.g/255,i.b/255,i.a],k=LP(i);for(let P=0;P<I.data.length;P+=4)CCe(I.data,P,E,k,r);x.putImageData(I,0,0),e=x.canvas.toDataURL("image/png")}else{const m=tr&&tr.findCredential(e);if(m&&m.token){const b=e.includes("?")?"&":"?";e=`${e}${b}token=${m.token}`}}return{url:e,width:c,height:h}}).catch(()=>({url:e,width:t,height:t}))}let H1=null;const fX=[255,255,255];function yX(e,t){return Math.floor(Math.random()*(t-e+1)+e)}function ACe(e,t,i){const{backgroundColor:r,outline:n,dotSize:o}=e,c=i&&i.swatchSize||zn.size,h=.8,m=Math.round(c*c/o**2*h),b=window.devicePixelRatio,x=document.createElement("canvas"),I=c*b;x.width=I,x.height=I,x.style.width=x.width/b+"px",x.style.height=x.height/b+"px";const E=x.getContext("2d");if(r&&(E.fillStyle=r.toCss(!0),E.fillRect(0,0,I,I),E.fill()),E.fillStyle=t.toCss(!0),H1&&H1.length/2===m)for(let P=0;P<2*m;P+=2){const F=H1[P],N=H1[P+1];E.fillRect(F,N,o*b,o*b),E.fill()}else{H1=[];for(let P=0;P<2*m;P+=2){const F=yX(0,I),N=yX(0,I);H1.push(F,N),E.fillRect(F,N,o*b,o*b),E.fill()}}n&&(n.color&&(E.strokeStyle=n.color.toCss(!0)),E.lineWidth=n.width,E.strokeRect(0,0,I,I));const k=new Image(c,c);return k.src=x.toDataURL(),k}function PCe(e,t={}){const i=t.radius||40,r=2*Math.PI*i,n=e.length,o=r/n,c=[],h=H_(t.outline);(h==null?void 0:h.width)!=null&&(h.width*=2),(h||t.backgroundColor)&&c.push({shape:{type:"circle",cx:i,cy:i,r:i},fill:t.backgroundColor,stroke:h,offset:[0,0]});const m=t.values,b=m&&m.length===n&&m.reduce((P,F)=>P+F,0)===100,x=[0];for(let P=0;P<n;P++){let F=null;b&&(F=m[P]*r/100,x.push(F+x[P])),c.push({shape:{type:"circle",cx:i,cy:i,r:i/2},fill:[0,0,0,0],stroke:{width:i,dashArray:`${(F!=null?F:o)/2} ${r}`,dashoffset:"-"+(b?x[P]/2:P*(o/2)),color:e[P]},offset:[0,0]})}let I=null;const E=2*i+((h==null?void 0:h.width)||0),k=t.holePercentage;if(k){h&&c.push({shape:{type:"circle",cx:i,cy:i,r:i*k},fill:null,stroke:h,offset:[0,0]});const P=E/2;I=[[{shape:{type:"circle",cx:P,cy:P,r:P},fill:fX,stroke:h?Ce(K({},h),{color:fX}):null,offset:[0,0]},{shape:{type:"circle",cx:P,cy:P,r:i*k},fill:[0,0,0],stroke:null,offset:[0,0]}]]}return V2([c],[E,E],{effectView:t.effectList,ignoreStrokeWidth:!0,masking:I,rotation:-90})}function zy(e,t={}){const i=24,r=75,n=t.align==="horizontal",o=n?r:i,c=n?i:r,{width:h=o,height:m=c,gradient:b=!0}=t,x=window.devicePixelRatio,I=h*x,E=m*x,k=document.createElement("canvas");k.width=I,k.height=E,k.style.width=`${h}px`,k.style.height=`${m}px`;const P=k.getContext("2d"),F=n?I:0,N=n?0:E;if(b){const z=P.createLinearGradient(0,0,F,N),q=e.length,J=q===1?0:1/(q-1);e.forEach((X,Y)=>z.addColorStop(Y*J,X.toString())),P.fillStyle=z,P.fillRect(0,0,I,E)}else{const z=n?I/e.length:I,q=n?E:E/e.length;let J=0,X=0;for(const Y of e)P.fillStyle=Y.toString(),P.fillRect(J,X,z,q),J=n?J+z:0,X=n?0:X+q}const B=document.createElement("div");return B.style.width=`${h}px`,B.style.height=`${m}px`,LCe(B,t==null?void 0:t.effectList),B.appendChild(k),B}function LCe(e,t){if(!t)return;e.style.filter=Z_(t);const i=t.effects;if(i){for(const r of i)if((r==null?void 0:r.type)==="drop-shadow"){r.offsetX<0?e.style.marginLeft=`${Math.abs(r.offsetX)}px`:e.style.marginRight=`${r.offsetX}px`;break}}}async function mX(e,t){switch(e.type){case"web-style":{const{previewWebStyleSymbol:i}=await import("./previewWebStyleSymbol.94fbf4d0.js");return i(e,mX,t)}case"label-3d":case"line-3d":case"mesh-3d":case"point-3d":case"polygon-3d":{const{previewSymbol3D:i}=await Promise.resolve().then(function(){return Rje});return i(e,t)}case"simple-marker":case"simple-line":case"simple-fill":case"picture-marker":case"picture-fill":case"text":{const{previewSymbol2D:i}=await import("./previewSymbol2D.127e906e.js");return i(e,t)}case"cim":{const{previewCIMSymbol:i}=await import("./previewCIMSymbol.7290f861.js");return i(e,t)}default:return}}function gX(e){return e&&"opacity"in e?e.opacity*gX(e.parent):1}async function OCe(e,t){var N,B;if(!e)return;const i=e.sourceLayer,r=(N=H(t)&&t.useSourceLayer?i:e.layer)!=null?N:i,n=gX(r);if(H(e.symbol)&&(!H(t)||t.ignoreGraphicSymbol!==!0)){const z=e.symbol.type==="web-style"?await e.symbol.fetchSymbol(Ce(K({},t),{cache:H(t)?t.webStyleCache:null})):e.symbol.clone();return R7(z,null,n),z}const o=(B=H(t)?t.renderer:null)!=null?B:r&&"renderer"in r?r.renderer:null;let c=o&&"getSymbolAsync"in o?await o.getSymbolAsync(e,t):null;if(!c)return;if(c=c.type==="web-style"?await c.fetchSymbol(Ce(K({},t),{cache:H(t)?t.webStyleCache:null})):c.clone(),!(o&&"visualVariables"in o&&o.visualVariables&&o.visualVariables.length))return R7(c,null,n),c;if("arcadeRequiredForVisualVariables"in o&&o.arcadeRequiredForVisualVariables&&(ce(t)||ce(t.arcade))){const z=K({},Ht(t));z.arcade=await ru(),t=z}const h=await Promise.resolve().then(function(){return Ey}),m=[],b=[],x=[],I=[];for(const z of o.visualVariables)switch(z.type){case"color":m.push(z);break;case"opacity":b.push(z);break;case"rotation":I.push(z);break;case"size":z.target||x.push(z)}const E=!!m.length&&m[m.length-1],k=E?h.getColor(E,e,t):null,P=!!b.length&&b[b.length-1];let F=P?h.getOpacity(P,e,t):null;if(n!=null&&(F=F!=null?F*n:n),R7(c,k,F),x.length){const z=h.getAllSizes(x,e,t);await VMe(c,z)}for(const z of I)zMe(c,h.getRotationAngle(z,e,t),z.axis);return c}class RCe{constructor(t,i){this._owner=i,this._properties={},this._afterDispatchHandle=null;for(const r in t){const n=t[r],o=new $V(n,void 0,void 0,2,2);this._properties[r]={pool:o,acquired:[]}}this._afterDispatchHandle=ome(()=>this._release())}destroy(){this._afterDispatchHandle&&(this._afterDispatchHandle.remove(),this._afterDispatchHandle=null);for(const t in this._properties){const i=this._properties[t];for(const r of i.acquired)BV(r)||i.pool.release(r);i.pool.destroy(),i.pool=null,i.acquired=null}this._properties=null,this._owner=null}get(t){const i=this._owner._get(t),r=this._properties[t];let n=r.pool.acquire();for(r.acquired.push(n);n===i;)r.acquired.push(n),n=r.pool.acquire();return n}_release(){for(const t in this._properties){const i=this._properties[t];let r=0;for(const n of i.acquired)BV(n)?i.acquired[r++]=n:i.pool.release(n);i.acquired.length=r}}}const FCe=Te("mac")?"Meta":"Ctrl",JM={8:"Backspace",9:"Tab",13:"Enter",27:"Escape",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete"};for(let e=48;e<58;e++)JM[e]=String.fromCharCode(e);for(let e=1;e<25;e++)JM[111+e]=`F${e}`;for(let e=65;e<91;e++)JM[e]=[String.fromCharCode(e+32),String.fromCharCode(e)];function NCe(e){if(e.key!==void 0)return to(e);const t=JM[e.keyCode];return Array.isArray(t)?e.shiftKey?t[1]:t[0]:t}function DCe(e){switch(e){case"Ctrl":case"Alt":case"Shift":case"Meta":case"Primary":return!0}return!1}class jCe{constructor(t,i=[]){this.eventType=t,this.keyModifiers=i}matches(t){if(t.type!==this.eventType)return!1;if(this.keyModifiers.length===0)return!0;const i=t.modifiers;for(const r of this.keyModifiers)if(!i.has(r))return!1;return!0}}const vX=$e.getLogger("esri.views.input.InputHandler");class ds{constructor(t){this._manager=null,this._incoming={},this._outgoing={},this._incomingEventMatches=null,this._incomingEventTypes=null,this._outgoingEventTypes=null,this._hasSideEffects=t}get incomingEventMatches(){if(!this._incomingEventMatches){this._incomingEventMatches=[];for(const t in this._incoming){const i=this._incoming[t];for(const r of i)this._incomingEventMatches.push(r.match)}}return this._incomingEventMatches}get incomingEventTypes(){return this._incomingEventTypes||(this._incomingEventTypes=this.incomingEventMatches.map(t=>t.eventType)),this._incomingEventTypes}get outgoingEventTypes(){return this._outgoingEventTypes||(this._outgoingEventTypes=Object.keys(this._outgoing)),this._outgoingEventTypes}get hasSideEffects(){return this._hasSideEffects}get hasPendingInputs(){return!1}onInstall(t){this._manager?vX.error("This InputHandler has already been registered with an InputManager"):(t.setEventCallback(i=>this._handleEvent(i)),t.setUninstallCallback(()=>this._onUninstall()),this._manager=t)}onUninstall(){}registerIncoming(t,i,r){let n;typeof i=="function"?(r=i,n=[]):n=i||[];const o=typeof t=="string"?new jCe(t,n):t,c=()=>{this._incomingEventTypes=null,this._incomingEventMatches=null},h=x=>{const I=this._incoming[x.match.eventType];if(I){const E=I.indexOf(x);I.splice(E,1),c(),this._manager&&this._manager.updateDependencies()}},m=new VCe(o,r,{onPause:h,onRemove:h,onResume:x=>{const I=this._incoming[x.match.eventType];I&&!I.includes(x)&&(I.push(x),c(),this._manager&&this._manager.updateDependencies())}});let b=this._incoming[o.eventType];return b||(b=[],this._incoming[o.eventType]=b),b.push(m),c(),this._manager&&this._manager.updateDependencies(),m}registerOutgoing(t){if(this._outgoing[t])throw new Error("There is already a callback registered for this outgoing InputEvent: "+t);const i=new zCe(t,{onEmit:(r,n,o,c)=>{var h;(h=this._manager)==null||h.emit(r.eventType,n,o,c)},onRemove:r=>{var n;delete this._outgoing[r.eventType],(n=this._manager)==null||n.updateDependencies()}});return this._outgoing[t]=i,this._outgoingEventTypes=null,this._manager&&this._manager.updateDependencies(),i}startCapturingPointer(t){var i;(i=this._manager)==null||i.setPointerCapture(t,!0)}stopCapturingPointer(t){var i;(i=this._manager)==null||i.setPointerCapture(t,!1)}refreshHasPendingInputs(){var t;(t=this._manager)==null||t.refreshHasPendingInputs()}_onUninstall(){this._manager?(this.onUninstall(),this._manager=null):vX.error("This InputHandler is not registered with an InputManager")}_handleEvent(t){var r;const i=this._incoming[t.type];if(i){for(const n of i)if(n.match.matches(t)&&((r=n.callback)==null||r.call(n,t),t.shouldStopPropagation()))break}}}class VCe{constructor(t,i,r){this.match=t,this._callback=i,this._handler=r}pause(){this._handler.onPause(this)}resume(){this._handler.onResume(this)}remove(){this._handler.onRemove(this)}get callback(){return this._callback}}class zCe{constructor(t,i){this.eventType=t,this._removed=!1,this._handler=i}emit(t,i,r){this._removed||this._handler.onEmit(this,t,i,r)}remove(){this._removed=!0,this._handler.onRemove(this)}}class GCe extends ds{constructor(t){super(!0),this._onChange=t,this._value="mouse",this._x=null,this._y=null,this.registerIncoming("pointer-move",i=>{this._update(i.data)})}_update(t){const i=t.native.pointerType==="touch"?"touch":"mouse",{x:r,y:n}=t;i===this._value&&this._x===r&&this._y===n||(this._value=i,this._x=r,this._y=n,this._onChange(i,r,n))}}class ZM{constructor(t){this._observable=new NT,this._value=t}get(){return ii(this._observable),this._value}set(t){t!==this._value&&(this._value=t,this._observable.notify())}}class BCe extends ds{constructor(){super(!0),this._activeTouchPointerIds=new Set,this._multiTouchActive=new ZM(!1),this._onPointerAdd=({data:t})=>{t.pointerType==="touch"&&(this._activeTouchPointerIds.add(t.native.pointerId),this._update())},this._onPointerRemove=({data:t})=>{t.pointerType==="touch"&&(this._activeTouchPointerIds.delete(t.native.pointerId),this._update())},this.registerIncoming("pointer-down",this._onPointerAdd),this.registerIncoming("pointer-up",this._onPointerRemove),this.registerIncoming("pointer-capture-lost",this._onPointerRemove),this.registerIncoming("pointer-cancel",this._onPointerRemove)}get multiTouchActive(){return this._multiTouchActive.get()}_update(){this._multiTouchActive.set(this._activeTouchPointerIds.size>1)}}let Tu=class extends Ye{constructor(e){super(e),this._pointerCaptures=new Map,this._nameToGroup={},this._handlers=[],this._handlersPriority=[],this._currentPropagation=null,this._updateDependenciesAfterPropagation=!1,this._sourceEvents=new Set,this._keyModifiers=new Set,this._activeKeyModifiers=new Set,this._stoppedPropagationEventIds=new Set,this.primaryKey=FCe,this._latestPointerType="mouse",this._propertiesPool=new RCe({latestPointerLocation:qCe},this),this.latestPointerLocation=null,this.test={timestamp:void 0,hasCurrentPropagation:()=>!!this._currentPropagation}}initialize(){this.eventSource.onEventReceived=this._onEventReceived.bind(this),this._installRecognizers()}destroy(){const e=Object.keys(this._nameToGroup);for(const t of e)this.uninstallHandlers(t);this.eventSource.destroy(),this._currentPropagation=null,this._propertiesPool.destroy()}get hasPendingInputs(){return this._handlers.some(e=>e.handler.hasPendingInputs)}get latestPointerType(){return this._latestPointerType}get multiTouchActive(){return this._multiTouchHandler.multiTouchActive}installHandlers(e,t,i=ft.INTERNAL){if(this._nameToGroup[e])return void $e.getLogger(this.declaredClass).error("There is already an InputHandler group registered under the name `"+e+"`");if(t.length===0)return void $e.getLogger(this.declaredClass).error("Can't register a group of zero handlers");const r={name:e,handlers:t.map(n=>({handler:n,active:!0,removed:!1,priorityIndex:0,groupPriority:i,eventCallback:null,uninstallCallback:null}))};this._nameToGroup[e]=r;for(let n=r.handlers.length-1;n>=0;n--){const o=r.handlers[n];this._handlers.push(o),o.handler.onInstall({updateDependencies:()=>{this.updateDependencies()},emit:(c,h,m,b,x)=>{this._emitInputEvent(o.priorityIndex+1,c,h,m,x,b)},setPointerCapture:(c,h)=>{this._setPointerCapture(r,o,c,h)},setEventCallback:c=>{o.eventCallback=c},setUninstallCallback:c=>{o.uninstallCallback=c},refreshHasPendingInputs:()=>{this.notifyChange("hasPendingInputs")}})}this.updateDependencies()}uninstallHandlers(e){const t=this._nameToGroup[e];t?(t.handlers.forEach(i=>{var r;i.removed=!0,(r=i.uninstallCallback)==null||r.call(i)}),delete this._nameToGroup[e],this._currentPropagation?this._currentPropagation.needsHandlerGarbageCollect=!0:this._garbageCollectRemovedHandlers()):$e.getLogger(this.declaredClass).error("There is no InputHandler group registered under the name `"+e+"`")}hasHandlers(e){return this._nameToGroup[e]!==void 0}updateDependencies(){if(this._currentPropagation)return void(this._updateDependenciesAfterPropagation=!0);this._updateDependenciesAfterPropagation=!1;const e=new Set,t=new Set;this._handlersPriority=[];for(let i=this._handlers.length-1;i>=0;i--){const r=this._handlers[i];r.priorityIndex=i,this._handlersPriority.push(r)}this._handlersPriority=this._sortHandlersPriority(this._handlersPriority);for(let i=this._handlersPriority.length-1;i>=0;i--){const r=this._handlersPriority[i];r.priorityIndex=i;let n=r.handler.hasSideEffects;if(!n){for(const o of r.handler.outgoingEventTypes)if(e.has(o)){n=!0;break}}if(n)for(const o of r.handler.incomingEventMatches){e.add(o.eventType);for(const c of o.keyModifiers)DCe(c)||t.add(c)}r.active=n}this._sourceEvents=e,this._keyModifiers=t,this._pointerCaptures.size>0&&this._sourceEvents.add("pointer-capture-lost"),this._keyModifiers.size>0&&(this._sourceEvents.add("key-down"),this._sourceEvents.add("key-up")),this.eventSource&&(this.eventSource.activeEvents=this._sourceEvents)}_setLatestPointer(e,t,i){this._latestPointerType=e;const r=this._get("latestPointerLocation");if(ce(r)||r.x!==t||r.y!==i){const n=this._propertiesPool.get("latestPointerLocation");n.x=t,n.y=i,this._set("latestPointerLocation",n)}}_onEventReceived(e,t){if(e==="pointer-capture-lost"){const n=t;this._pointerCaptures.delete(n.native.pointerId)}this._updateKeyModifiers(e,t);const i=this.test.timestamp!=null?this.test.timestamp:t.native?t.native.timestamp:void 0,r=t.native?t.native.cancelable:void 0;this._emitInputEventFromSource(e,t,i,r)}_updateKeyModifiers(e,t){if(!t)return;let i=!1;const r=()=>{if(!i){const c=new Set;this._activeKeyModifiers.forEach(h=>{c.add(h)}),this._activeKeyModifiers=c,i=!0}},n=(c,h)=>{h&&!this._activeKeyModifiers.has(c)?(r(),this._activeKeyModifiers.add(c)):!h&&this._activeKeyModifiers.has(c)&&(r(),this._activeKeyModifiers.delete(c))};if(e==="key-down"||e==="key-up"){const c=t.key;this._keyModifiers.has(c)&&n(c,e==="key-down")}const o=t.native;n("Alt",!(!o||!o.altKey)),n("Ctrl",!(!o||!o.ctrlKey)),n("Shift",!(!o||!o.shiftKey)),n("Meta",!(!o||!o.metaKey)),n("Primary",this._activeKeyModifiers.has(this.primaryKey))}_installRecognizers(){this._latestPointerHandler=new GCe((e,t,i)=>this._setLatestPointer(e,t,i)),this._multiTouchHandler=new BCe,this.installHandlers("input-manager-logic",[this._latestPointerHandler,this._multiTouchHandler],ft.ALWAYS),this.recognizers.length>0&&this.installHandlers("default",this.recognizers,ft.INTERNAL)}_setPointerCapture(e,t,i,r){const n=e.name+"-"+t.priorityIndex,o=this._pointerCaptures.get(i.pointerId)||new Set;this._pointerCaptures.set(i.pointerId,o),r?(o.add(n),o.size===1&&this.eventSource&&this.eventSource.setPointerCapture(i,!0)):o.has(n)&&(o.delete(n),o.size===0&&(this._pointerCaptures.delete(i.pointerId),this.eventSource&&this.eventSource.setPointerCapture(i,!1)))}_garbageCollectRemovedHandlers(){this._handlers=this._handlers.filter(e=>!e.removed),this.updateDependencies()}_emitInputEventFromSource(e,t,i,r){this._emitInputEvent(0,e,t,i,r)}_emitInputEvent(e,t,i,r,n,o){const c=r!==void 0?r:this._currentPropagation?this._currentPropagation.timestamp:performance.now(),h=n!==void 0&&n,m={event:new UCe(t,i,c,o||this._activeKeyModifiers,h),priorityIndex:e};this._currentPropagation?this._currentPropagation.events.push(m):this._doNewPropagation(m)}_doNewPropagation(e){this._currentPropagation={events:new q5,currentHandler:null,needsHandlerGarbageCollect:!1,timestamp:e.event.timestamp},this._currentPropagation.events.push(e),this._continuePropagation()}_continuePropagation(){var t,i;const e=Yn(this._currentPropagation);for(;e.events.length>0;){const{event:r,priorityIndex:n}=e.events.pop(),o=r.data&&r.data.eventId;if(!(o!=null&&this._stoppedPropagationEventIds.has(o)))for(e.currentHandler=this._handlersPriority[n];e.currentHandler;){if(e.currentHandler.removed)e.needsHandlerGarbageCollect=!0;else{if(e.currentHandler.active&&!r.shouldStopPropagation()&&((i=(t=e.currentHandler).eventCallback)==null||i.call(t,r)),r.shouldStopPropagation()){o!=null&&this._stoppedPropagationEventIds.add(o);break}if(r.shouldPausePropagation(()=>this._continuePropagation()))return void this._pausePropagation({event:r,priorityIndex:e.currentHandler.priorityIndex+1})}e.currentHandler=this._handlersPriority[e.currentHandler.priorityIndex+1]}}e.needsHandlerGarbageCollect&&this._garbageCollectRemovedHandlers(),this.hasPendingInputs||this._stoppedPropagationEventIds.clear(),this._currentPropagation=null,this._updateDependenciesAfterPropagation&&this.updateDependencies()}_pausePropagation(e){const t=new q5;t.push(e);const i=this._currentPropagation;if(i){for(;i.events.length;)t.push(i.events.pop());i.events=t,i.currentHandler=null}}_compareHandlerPriority(e,t){if(e.handler.hasSideEffects!==t.handler.hasSideEffects)return e.handler.hasSideEffects?1:-1;if(e.groupPriority!==t.groupPriority)return e.groupPriority>t.groupPriority?-1:1;for(const i of e.handler.incomingEventMatches)for(const r of t.handler.incomingEventMatches){if(i.eventType!==r.eventType)continue;const n=i.keyModifiers.filter(o=>r.keyModifiers.includes(o));if(n.length===i.keyModifiers.length!=(n.length===r.keyModifiers.length))return i.keyModifiers.length>r.keyModifiers.length?-1:1}return e.priorityIndex>t.priorityIndex?-1:1}_sortHandlersPriority(e){const t=[];for(const i of e){let r=0;for(;r<t.length&&this._compareHandlerPriority(i,t[r])>=0;)r++;t.splice(r,0,i)}return t}get debug(){const e=t=>{const i=this._setPointerCapture;this._setPointerCapture=()=>{},t(),this._setPointerCapture=i};return{injectEvent:(t,i)=>{e(()=>{this._onEventReceived(t,i)})},disablePointerCapture:e}}};g([w({readOnly:!0})],Tu.prototype,"hasPendingInputs",null),g([w({constructOnly:!0})],Tu.prototype,"eventSource",void 0),g([w({constructOnly:!0})],Tu.prototype,"recognizers",void 0),g([w()],Tu.prototype,"_latestPointerType",void 0),g([w()],Tu.prototype,"latestPointerType",null),g([w()],Tu.prototype,"multiTouchActive",null),g([w({readOnly:!0})],Tu.prototype,"latestPointerLocation",void 0),Tu=g([te("esri.views.input.InputManager")],Tu);class UCe{constructor(t,i,r,n,o){this.type=t,this.data=i,this.timestamp=r,this.modifiers=n,this.cancelable=o,this._propagationState=gf.NONE,this._resumeCallback=null}stopPropagation(){this._propagationState|=gf.STOPPED}shouldStopPropagation(){return(this._propagationState&gf.STOPPED)!=0}async(t){this._propagationState|=gf.PAUSED;const i=(r,n)=>{this._propagationState&=~gf.PAUSED;const o=this._resumeCallback;if(this._resumeCallback=null,o&&o(),n)throw r;return r};return(typeof t=="function"?t():t).then(r=>i(r,!1),r=>i(r,!0))}shouldPausePropagation(t){return!!(this._propagationState&gf.PAUSED)&&(this._resumeCallback=t,!0)}preventDefault(){this.data.native.preventDefault()}}var gf;(function(e){e[e.NONE=0]="NONE",e[e.STOPPED=1]="STOPPED",e[e.PAUSED=2]="PAUSED"})(gf||(gf={}));const ft={ALWAYS:1,DEFAULT:0,TOOL:-1,WIDGET:-2,INTERNAL:-3};class qCe{}function jP(e){return e&&typeof e.highlight=="function"}function wKe(e,t,i){return ce(e)||e>i&&(t===0||e<t)}const KM={iconZoom:"esri-icon-zoom-in-magnifying-glass",iconTrash:"esri-icon-trash",iconBrowseClusteredFeatures:"esri-icon-table"},Gy=new k0({id:"zoom-to-feature",title:"{messages.zoom}",className:KM.iconZoom}),bX=new k0({id:"remove-selected-feature",title:"{messages.remove}",className:KM.iconTrash}),W1=new k0({id:"zoom-to-clustered-features",title:"{messages.zoom}",className:KM.iconZoom}),J1=new k0({id:"browse-clustered-features",title:"{messages.browseClusteredFeatures}",className:KM.iconBrowseClusteredFeatures}),HCe="esri.widgets.Popup.PopupViewModel",YM=$e.getLogger(HCe),WCe=e=>{const{event:t,view:i}=e,{action:r}=t,n=i&&i.popup;if(!r)return Promise.reject(new ue("trigger-action:missing-arguments","Event has no action"));if(!n)return Promise.reject(new ue("trigger-action:missing-arguments","view.popup is missing"));const{disabled:o,id:c}=r;if(!c)return Promise.reject(new ue("trigger-action:invalid-action","action.id is missing"));if(o)return Promise.reject(new ue("trigger-action:invalid-action","Action is disabled"));if(c===Gy.id)return ZCe(n.viewModel).catch(uT);if(c===W1.id)return KCe(n.viewModel);if(c===J1.id)return n.featureMenuOpen=!n.featureMenuOpen,n.viewModel.browseClusterEnabled=!n.viewModel.browseClusterEnabled,Promise.resolve();if(n.viewModel.browseClusterEnabled=!1,c===bX.id){n.close();const{selectedFeature:h}=n;if(!h)return Promise.reject(new ue(`trigger-action:${bX.id}`,"selectedFeature is required",{selectedFeature:h}));const{sourceLayer:m}=h;return m?m.remove(h):i.graphics.remove(h),Promise.resolve()}return Promise.resolve()};function wX(e){const{selectedFeature:t,location:i,view:r}=e;return r?r.type==="3d"?t||i:e.get("selectedFeature.geometry")||i:null}function By(e){var t,i;return(e==null?void 0:e.isAggregate)&&((i=(t=e==null?void 0:e.sourceLayer)==null?void 0:t.featureReduction)==null?void 0:i.type)==="cluster"}async function JCe(e,t){if((t==null?void 0:t.type)!=="3d"||!e||e.declaredClass!=="esri.Graphic")return!0;const i=t.getViewForGraphic(e);if(i&&"whenGraphicBounds"in i){let r;try{r=await i.whenGraphicBounds(e,{useViewElevation:!0})}catch{}return!r||!r.boundingBox||r.boundingBox[0]===r.boundingBox[3]&&r.boundingBox[1]===r.boundingBox[4]&&r.boundingBox[2]===r.boundingBox[5]}return!0}async function ZCe(e){const{location:t,selectedFeature:i,view:r,zoomFactor:n}=e,o=wX(e);if(!o){const b=new ue("zoom-to:invalid-target-or-view","Cannot zoom to location without a target and view.",{target:o,view:r});throw YM.error(b),b}const c=r.scale/n,h=e.get("selectedFeature.geometry")||t,m=h&&h.type==="point"&&await JCe(i,r);Gy.active=!0,Gy.disabled=!0;try{await e.zoomTo({target:{target:o,scale:m?c:void 0}})}catch{const x=new ue("zoom-to:invalid-graphic","Could not zoom to the location of the graphic.",{graphic:i});YM.error(x)}finally{Gy.active=!1,Gy.disabled=!1,e.zoomToLocation=null,m&&(e.location=h)}}async function KCe(e){const{selectedFeature:t,view:i}=e;if((i==null?void 0:i.type)!=="2d"){const h=new ue("zoomToCluster:invalid-view","View must be 2d MapView.",{view:i});throw YM.error(h),h}if(!By(t)){const h=new ue("zoomToCluster:invalid-selectedFeature","Selected feature must represent an aggregate/cluster graphic.",{selectedFeature:t});throw YM.error(h),h}const r=t.sourceLayer,n=await i.whenLayerView(r),o=n.createQuery();o.aggregateIds=[t.getObjectId()],W1.active=!0,W1.disabled=!0;const{extent:c}=await n.queryExtent(o);await e.zoomTo({target:c}),W1.active=!1,W1.disabled=!1}async function YCe(e){const{selectedFeature:t,view:i}=e,r=t.sourceLayer,n=await i.whenLayerView(r),o=n.createQuery();o.aggregateIds=[t.getObjectId()];const{extent:c}=await n.queryExtent(o);e.selectedClusterBoundaryFeature.geometry=c,i.graphics.add(e.selectedClusterBoundaryFeature)}async function XCe(e){const{selectedFeature:t,view:i}=e,r=t.sourceLayer,n=await i.whenLayerView(r),o=n.createQuery();o.aggregateIds=[t.getObjectId()],J1.active=!0,J1.disabled=!0;const{features:c}=await n.queryFeatures(o);J1.active=!1,J1.disabled=!1,i.popup.open({features:[t].concat(c),featureMenuOpen:!0})}function QCe(e){const t=e.features.filter(i=>By(i));t.length&&(e.features=t)}const Z1=e=>{let t=class extends e{constructor(...i){super(...i),this.goToOverride=null,this.view=null}callGoTo(i){const{view:r}=this;return this.goToOverride?this.goToOverride(r,i):r.goTo(i.target,i.options)}};return g([w()],t.prototype,"goToOverride",void 0),g([w()],t.prototype,"view",void 0),t=g([te("esri.widgets.support.GoTo")],t),t},z2=Xe.ofType({key:"type",defaultKeyValue:"button",base:wg,typeMap:{button:k0,toggle:I6}}),eke=()=>[Gy.clone()],tke=()=>[W1.clone(),J1.clone()];let xi=class extends Z1(zY){constructor(e){super(e),this._handles=new Ti,this._pendingPromises=new Set,this._fetchFeaturesController=null,this._selectedClusterFeature=null,this.featurePage=null,this.actions=new z2,this.activeFeature=null,this.defaultPopupTemplateEnabled=!1,this.autoCloseEnabled=!1,this.autoOpenEnabled=!0,this.browseClusterEnabled=!1,this.content=null,this.featuresPerPage=20,this.featureViewModelAbilities=null,this.featureViewModels=[],this.highlightEnabled=!0,this.includeDefaultActions=!0,this.selectedClusterBoundaryFeature=new Gr({symbol:new ea({outline:{width:1.5,color:"cyan"},style:"none"})}),this.title=null,this.updateLocationEnabled=!1,this.view=null,this.visible=!1,this.zoomFactor=4,this.zoomToLocation=null}get isLoadingFeature(){return this.featureViewModels.some(e=>e.waitingForContent)}initialize(){this._handles.add([we(()=>[this.autoOpenEnabled,this.view],()=>this._autoOpenEnabledChange()),this.on("view-change",()=>this._autoClose()),we(()=>[this.highlightEnabled,this.selectedFeature,this.visible,this.view],()=>this._highlightSelectedFeature()),we(()=>[this.highlightEnabled,this.activeFeature,this.visible,this.view],()=>this._highlightActiveFeature()),we(()=>{var e,t;return(t=(e=this.view)==null?void 0:e.animation)==null?void 0:t.state},e=>this._animationStateChange(e)),we(()=>this.location,e=>this._locationChange(e)),we(()=>this.selectedFeature,e=>this._selectedFeatureChange(e)),we(()=>[this.selectedFeatureIndex,this.featureCount,this.featuresPerPage],()=>this._selectedFeatureIndexChange()),we(()=>[this.featurePage,this.selectedFeatureIndex,this.featureCount,this.featuresPerPage,this.featureViewModels],()=>this._setGraphicOnFeatureViewModels()),we(()=>this.featureViewModels,()=>this._featureViewModelsChange()),this.on("trigger-action",e=>WCe({event:e,view:this.view})),os(()=>!this.waitingForResult,()=>this._waitingForResultChange(),mu),we(()=>{var e,t;return[this.features,(e=this.view)==null?void 0:e.map,(t=this.view)==null?void 0:t.spatialReference]},()=>this._updateFeatureVMs()),we(()=>{var e;return(e=this.view)==null?void 0:e.scale},()=>this._viewScaleChange()),os(()=>!this.visible,()=>this.browseClusterEnabled=!1),we(()=>this.browseClusterEnabled,e=>e?this.enableClusterBrowsing():this.disableClusterBrowsing())])}destroy(){this._cancelFetchingFeatures(),this._handles.destroy(),this._handles=null,this._pendingPromises.clear(),this.browseClusterEnabled=!1,this.view=null}get active(){return!(!this.visible||this.waitingForResult)}get allActions(){const e=this._get("allActions")||new z2;e.removeAll();const{actions:t,defaultActions:i,defaultPopupTemplateEnabled:r,includeDefaultActions:n,selectedFeature:o}=this,c=n?i.concat(t):t,h=o&&(typeof o.getEffectivePopupTemplate=="function"&&o.getEffectivePopupTemplate(r)||o.popupTemplate),m=h&&h.actions,b=h&&h.overwriteActions?m:m?m.concat(c):c;return b&&b.filter(Boolean).forEach(x=>e.add(x)),e}get defaultActions(){const e=this._get("defaultActions")||new z2;return e.removeAll(),e.addMany(By(this.selectedFeature)?tke():eke()),e}get featureCount(){return this.features.length}get features(){return this._get("features")||[]}set features(e){const t=e||[];this._set("features",t);const{pendingPromisesCount:i,promiseCount:r,selectedFeatureIndex:n}=this,o=r&&t.length;o&&i&&n===-1?this.selectedFeatureIndex=0:o&&n!==-1||(this.selectedFeatureIndex=t.length?0:-1)}get location(){return this._get("location")||null}set location(e){const t=this.get("view.spatialReference.isWebMercator");e&&e.get("spatialReference.isWGS84")&&t&&(e=tu(e)),this._set("location",e)}get pendingPromisesCount(){return this._pendingPromises.size}get waitingForResult(){return!(!(!!this._fetchFeaturesController||this.pendingPromisesCount>0)||this.featureCount!==0)}get promiseCount(){return this.promises.length}get promises(){return this._get("promises")||[]}set promises(e){if(this._pendingPromises.clear(),this.features=[],!Array.isArray(e)||!e.length)return this._set("promises",[]),void this.notifyChange("pendingPromisesCount");this._set("promises",e),(e=e.slice(0)).forEach(t=>{this._pendingPromises.add(t);const i=n=>{this._pendingPromises.has(t)&&this._updateFeatures(n),this._updatePendingPromises(t)},r=()=>this._updatePendingPromises(t);t.then(i,r)}),this.notifyChange("pendingPromisesCount")}get selectedFeature(){const{features:e,selectedFeatureIndex:t}=this;return t===-1?null:e[t]||null}get selectedFeatureIndex(){const e=this._get("selectedFeatureIndex");return typeof e=="number"?e:-1}set selectedFeatureIndex(e){const{featureCount:t}=this;e=isNaN(e)||e<-1||!t?-1:(e+t)%t,this.activeFeature=null,this._set("selectedFeatureIndex",e)}get selectedFeatureViewModel(){return this.featureViewModels[this.selectedFeatureIndex]||null}get state(){return this.get("view.ready")?"ready":"disabled"}centerAtLocation(){const{view:e}=this,t=wX(this);return t?this.callGoTo({target:{target:t,scale:e.scale}}):Promise.reject(new ue("center-at-location:invalid-target-or-view","Cannot center at a location without a target and view.",{target:t,view:e}))}zoomTo(e){return this.callGoTo(e)}clear(){this.set({promises:[],features:[],content:null,title:null,location:null,activeFeature:null})}fetchFeatures(e,t){const{view:i}=this;if(!i||!e)throw new ue("fetch-features:invalid-screenpoint-or-view","Cannot fetch features without a screenPoint and view.",{screenPoint:e,view:i});return i.fetchPopupFeatures(e,{event:t&&t.event,defaultPopupTemplateEnabled:this.defaultPopupTemplateEnabled,signal:t&&t.signal})}open(e){const t=Ce(K({updateLocationEnabled:!1,promises:[],fetchFeatures:!1},e),{visible:!0}),{fetchFeatures:i}=t;delete t.fetchFeatures,i&&this._setFetchFeaturesPromises(t.location);const r=["actionsMenuOpen","collapsed","featureMenuOpen"];for(const n of r)delete t[n];this.set(t)}triggerAction(e){const t=this.allActions.getItemAt(e);t&&!t.disabled&&this.emit("trigger-action",{action:t})}next(){return this.selectedFeatureIndex=this.selectedFeatureIndex+1,this}previous(){return this.selectedFeatureIndex=this.selectedFeatureIndex-1,this}disableClusterBrowsing(){QCe(this),this._clearBrowsedClusterGraphics()}async enableClusterBrowsing(){const{view:e,selectedFeature:t}=this;(e==null?void 0:e.type)==="2d"?By(t)?(await YCe(this),await XCe(this)):$e.getLogger(this.declaredClass).warn("enableClusterBrowsing:invalid-selectedFeature: Selected feature must represent an aggregate/cluster graphic.",t):$e.getLogger(this.declaredClass).warn("enableClusterBrowsing:invalid-view: View must be 2d MapView.",t)}_animationStateChange(e){this.zoomToLocation||(Gy.disabled=e==="waiting-for-target")}_clearBrowsedClusterGraphics(){var t;const e=(t=this.view)==null?void 0:t.graphics;e&&(e.remove(this.selectedClusterBoundaryFeature),e.remove(this._selectedClusterFeature)),this._selectedClusterFeature=null,this.selectedClusterBoundaryFeature.geometry=null}_viewScaleChange(){if(By(this.selectedFeature))return this.browseClusterEnabled=!1,this.visible=!1,void this.clear();this.browseClusterEnabled&&(this.features=[this.selectedFeature])}_locationChange(e){const{selectedFeature:t,updateLocationEnabled:i}=this;i&&e&&(!t||t.geometry)&&this.centerAtLocation()}_selectedFeatureIndexChange(){this.featurePage=this.featureCount>1?Math.floor(this.selectedFeatureIndex/this.featuresPerPage)+1:null}_featureViewModelsChange(){this.featurePage=this.featureCount>1?1:null}_setGraphicOnFeatureViewModels(){const{features:e,featureCount:t,featurePage:i,featuresPerPage:r,featureViewModels:n}=this;if(i===null)return;const o=((i-1)*r+t)%t,c=o+r;n.slice(o,c).forEach((h,m)=>{h&&!h.graphic&&(h.graphic=e[o+m])})}async _selectedFeatureChange(e){if(!e)return;const{location:t,updateLocationEnabled:i,view:r}=this;if(this.browseClusterEnabled)return this._selectedClusterFeature&&(r.graphics.remove(this._selectedClusterFeature),this._selectedClusterFeature=null),By(e)?void 0:(e.symbol=await OCe(e),this._selectedClusterFeature=e,void r.graphics.add(this._selectedClusterFeature));!i&&t||!e.geometry?i&&!e.geometry&&this.centerAtLocation().then(()=>{this.location=r.center.clone()}):this.location=Ht(this._getPointFromGeometry(e.geometry))}_waitingForResultChange(){!this.featureCount&&this.promises&&(this.visible=!1)}_setFetchFeaturesPromises(e){return this._fetchFeaturesWithController(this._getScreenPoint(e||this.location)).then(t=>{const{clientOnlyGraphics:i,promisesPerLayerView:r}=t,n=Promise.resolve(i),o=r.map(c=>c.promise);this.promises=[n,...o]})}_destroyFeatureVMs(){this.featureViewModels.forEach(e=>e&&!e.destroyed&&e.destroy()),this._set("featureViewModels",[])}_updateFeatureVMs(){const{selectedFeature:e,features:t,featureViewModels:i}=this;if(By(e)||(this.browseClusterEnabled=!1),this._destroyFeatureVMs(),!t||!t.length)return;const r=i.slice(0),n=[];t.forEach((o,c)=>{var m,b;if(!o)return;let h=null;if(r.some((x,I)=>(x&&x.graphic===o&&(h=x,r.splice(I,1)),!!h)),h)n[c]=h;else{const x=new TP({abilities:this.featureViewModelAbilities,defaultPopupTemplateEnabled:this.defaultPopupTemplateEnabled,spatialReference:(m=this.view)==null?void 0:m.spatialReference,graphic:o===e?o:null,map:(b=this.view)==null?void 0:b.map,view:this.view});n[c]=x}}),r.forEach(o=>o&&!o.destroyed&&o.destroy()),this._set("featureViewModels",n)}_getScreenPoint(e){const{view:t}=this;return t&&e&&typeof t.toScreen=="function"?t.toScreen(e):null}_autoOpenEnabledChange(){const e="auto-fetch-features",{_handles:t,autoOpenEnabled:i}=this;if(t.remove(e),i&&this.view){const r=this.view.on("click",n=>{n.pointerType==="mouse"&&n.button!==0||this._fetchFeaturesAndOpen(n)},ft.WIDGET);t.add(r,e)}}_cancelFetchingFeatures(){const e=this._fetchFeaturesController;e&&e.abort(),this._fetchFeaturesController=null,this.notifyChange("waitingForResult")}_fetchFeaturesWithController(e,t){this._cancelFetchingFeatures();const i=new AbortController,{signal:r}=i;this._fetchFeaturesController=i,this.notifyChange("waitingForResult");const n=this.fetchFeatures(e,{signal:r,event:t});return n.catch(()=>{}).then(()=>{this._fetchFeaturesController=null,this.notifyChange("waitingForResult")}),n}_fetchFeaturesAndOpen(e){const{screenPoint:t,mapPoint:i}=e,{view:r}=this;this._fetchFeaturesWithController(t,e).then(n=>{const{clientOnlyGraphics:o,promisesPerLayerView:c,location:h}=n,m=[Promise.resolve(o),...c.map(b=>b.promise)];return r.popup.open({location:h||i,promises:m}),n})}_updatePendingPromises(e){e&&this._pendingPromises.has(e)&&(this._pendingPromises.delete(e),this.notifyChange("pendingPromisesCount"))}_autoClose(){this.autoCloseEnabled&&(this.visible=!1)}_getPointFromGeometry(e){var t;return ce(e)?null:e.type==="point"?e:e.type==="extent"?e.center:e.type==="polygon"?e.centroid:e.type==="multipoint"||e.type==="polyline"?(t=e.extent)==null?void 0:t.center:null}async _getLayerView(e,t){return await e.when(),e.whenLayerView(t)}_getHighlightLayer(e){const{layer:t,sourceLayer:i}=e;return i&&"layer"in i&&i.layer?i.layer:(i==null?void 0:i.type)==="map-notes"||(i==null?void 0:i.type)==="subtype-group"?i:t}_getHighlightTarget(e,t){const i=t.type==="imagery"?void 0:"objectIdField"in t?t.objectIdField||A6e:null,r=e.attributes;return r&&i&&r[i]||e}async _highlightActiveFeature(){const e="highlight-active-feature";this._handles.remove(e);const{highlightEnabled:t,view:i,activeFeature:r,visible:n}=this;if(!(r&&i&&t&&n))return;const o=this._getHighlightLayer(r);if(!(o&&o instanceof Y0))return;const c=this._getLayerView(i,o);this._highlightActiveFeaturePromise=c;const h=await c;if(!(h&&jP(h)&&this._highlightActiveFeaturePromise===c&&this.activeFeature&&this.highlightEnabled))return;const m=h.highlight(this._getHighlightTarget(r,o));this._handles.add(m,e)}async _highlightSelectedFeature(){const e="highlight-selected-feature";this._handles.remove(e);const{selectedFeature:t,highlightEnabled:i,view:r,visible:n}=this;if(!(t&&r&&i&&n))return;const o=this._getHighlightLayer(t);if(!(o&&o instanceof Y0))return;const c=this._getLayerView(r,o);this._highlightSelectedFeaturePromise=c;const h=await c;if(!(h&&jP(h)&&this._highlightSelectedFeaturePromise===c&&this.selectedFeature&&this.highlightEnabled&&this.visible))return;const m=h.highlight(this._getHighlightTarget(t,o));this._handles.add(m,e)}_updateFeatures(e){const{features:t}=this;if(!e||!e.length)return;if(!t.length)return void(this.features=e);const i=e.filter(r=>!t.includes(r));this.features=t.concat(i)}};g([w()],xi.prototype,"featurePage",void 0),g([w()],xi.prototype,"isLoadingFeature",null),g([w({type:z2})],xi.prototype,"actions",void 0),g([w({readOnly:!0})],xi.prototype,"active",null),g([w()],xi.prototype,"activeFeature",void 0),g([w({readOnly:!0})],xi.prototype,"allActions",null),g([w({type:Boolean})],xi.prototype,"defaultPopupTemplateEnabled",void 0),g([w()],xi.prototype,"autoCloseEnabled",void 0),g([w()],xi.prototype,"autoOpenEnabled",void 0),g([w()],xi.prototype,"browseClusterEnabled",void 0),g([w()],xi.prototype,"content",void 0),g([w({type:z2,readOnly:!0})],xi.prototype,"defaultActions",null),g([w({readOnly:!0})],xi.prototype,"featureCount",null),g([w()],xi.prototype,"features",null),g([w()],xi.prototype,"featuresPerPage",void 0),g([w()],xi.prototype,"featureViewModelAbilities",void 0),g([w({readOnly:!0})],xi.prototype,"featureViewModels",void 0),g([w()],xi.prototype,"highlightEnabled",void 0),g([w()],xi.prototype,"includeDefaultActions",void 0),g([w({type:pt})],xi.prototype,"location",null),g([w({readOnly:!0})],xi.prototype,"pendingPromisesCount",null),g([w({readOnly:!0})],xi.prototype,"selectedClusterBoundaryFeature",void 0),g([w({readOnly:!0})],xi.prototype,"waitingForResult",null),g([w({readOnly:!0})],xi.prototype,"promiseCount",null),g([w()],xi.prototype,"promises",null),g([w({value:null,readOnly:!0})],xi.prototype,"selectedFeature",null),g([w({value:-1})],xi.prototype,"selectedFeatureIndex",null),g([w({readOnly:!0})],xi.prototype,"selectedFeatureViewModel",null),g([w({readOnly:!0})],xi.prototype,"state",null),g([w()],xi.prototype,"title",void 0),g([w()],xi.prototype,"updateLocationEnabled",void 0),g([w()],xi.prototype,"view",void 0),g([w()],xi.prototype,"visible",void 0),g([w()],xi.prototype,"zoomFactor",void 0),g([w()],xi.prototype,"zoomToLocation",void 0),g([w()],xi.prototype,"centerAtLocation",null),xi=g([te("esri.widgets.Popup.PopupViewModel")],xi);const _X=xi,xX="selected-index",ike=0,SX="popup-spinner",qe={calciteThemeLight:"calcite-theme-light",calciteThemeDark:"calcite-theme-dark",iconLeftTriangleArrow:"esri-icon-left-triangle-arrow",iconRightTriangleArrow:"esri-icon-right-triangle-arrow",iconDockToTop:"esri-icon-maximize",iconDockToBottom:"esri-icon-dock-bottom",iconDockToLeft:"esri-icon-dock-left",iconDockToRight:"esri-icon-dock-right",iconClose:"esri-icon-close",iconUndock:"esri-icon-minimize",iconCheckMark:"esri-icon-check-mark",iconLoading:"esri-icon-loading-indicator",iconDefaultAction:"esri-icon-default-action",iconActionsMenu:"esri-icon-handle-horizontal",rotating:"esri-rotating",base:"esri-popup",widget:"esri-widget",main:"esri-popup__main-container",loadingContainer:"esri-popup__loading-container",isCollapsible:"esri-popup--is-collapsible",isCollapsed:"esri-popup--is-collapsed",shadow:"esri-popup--shadow",isDocked:"esri-popup--is-docked",isDockedTopLeft:"esri-popup--is-docked-top-left",isDockedTopCenter:"esri-popup--is-docked-top-center",isDockedTopRight:"esri-popup--is-docked-top-right",isDockedBottomLeft:"esri-popup--is-docked-bottom-left",isDockedBottomCenter:"esri-popup--is-docked-bottom-center",isDockedBottomRight:"esri-popup--is-docked-bottom-right",alignTopCenter:"esri-popup--aligned-top-center",alignBottomCenter:"esri-popup--aligned-bottom-center",alignTopLeft:"esri-popup--aligned-top-left",alignBottomLeft:"esri-popup--aligned-bottom-left",alignTopRight:"esri-popup--aligned-top-right",alignBottomRight:"esri-popup--aligned-bottom-right",isFeatureMenuOpen:"esri-popup--feature-menu-open",isActionsMenuOpen:"esri-popup--actions-menu-open",hasFeatureUpdated:"esri-popup--feature-updated",header:"esri-popup__header",headerButtons:"esri-popup__header-buttons",headerContainer:"esri-popup__header-container",headerContainerButton:"esri-popup__header-container--button",headerTitle:"esri-popup__header-title",content:"esri-popup__content",contentHasFlows:"esri-content--has-flows",contentFlowItem:"esri-content__flow-item",footer:"esri-popup__footer",footerHasPagination:"esri-popup__footer--has-pagination",footerHasActions:"esri-popup__footer--has-actions",footerHasActionsMenu:"esri-popup__footer--has-actions-menu",button:"esri-popup__button",buttonDisabled:"esri-popup__button--disabled",buttonDock:"esri-popup__button--dock",icon:"esri-popup__icon",iconDock:"esri-popup__icon--dock-icon",inlineActionsContainer:"esri-popup__inline-actions-container",actionsMenuButton:"esri-popup__actions-menu-button",actions:"esri-popup__actions",action:"esri-popup__action",actionImage:"esri-popup__action-image",actionText:"esri-popup__action-text",actionToggle:"esri-popup__action-toggle",actionToggleOn:"esri-popup__action-toggle--on",actionExit:"esri-popup__action--exit",pointer:"esri-popup__pointer",pointerDirection:"esri-popup__pointer-direction",navigation:"esri-popup__navigation",paginationPrevious:"esri-popup__pagination-previous",paginationNext:"esri-popup__pagination-next",paginationPreviousIconLTR:"esri-popup__pagination-previous-icon",paginationPreviousIconRTL:"esri-popup__pagination-previous-icon--rtl",paginationNextIconLTR:"esri-popup__pagination-next-icon",paginationNextIconRTL:"esri-popup__pagination-next-icon--rtl",featureMenu:"esri-popup__feature-menu",featureMenuList:"esri-popup__feature-menu-list",featureMenuItem:"esri-popup__feature-menu-item",featureMenuViewport:"esri-popup__feature-menu-viewport",featureMenuHeader:"esri-popup__feature-menu-header",featureMenuNote:"esri-popup__feature-menu-note",featureMenuSelected:"esri-popup__feature-menu-item--selected",featureMenuButton:"esri-popup__feature-menu-button",featureMenuTitle:"esri-popup__feature-menu-title",featureMenuObserver:"esri-popup__feature-menu-observer",featureMenuLoader:"esri-popup__feature-menu-loader",collapseButton:"esri-popup__collapse-button",collapseIcon:"esri-popup__collapse-icon"},MX={buttonEnabled:!0,position:"auto",breakpoint:{width:544}},IX="esri-popup";function tp(e,t){return t===void 0?`${IX}__${e}`:`${IX}__${e}-${t}`}const $X={closeButton:!0,featureNavigation:!0};let Lt=class extends NY(ki){constructor(e,t){super(e,t),this._blurClose=!1,this._blurContainer=!1,this._containerNode=null,this._mainContainerNode=null,this._featureMenuNode=null,this._actionsMenuNode=null,this._focusClose=!1,this._focusContainer=!1,this._focusDockButton=!1,this._focusFeatureMenuButton=!1,this._focusActionsMenuButton=!1,this._focusFirstFeature=!1,this._focusFirstAction=!1,this._handles=new Ti,this._pointerOffsetInPx=16,this._spinner=null,this._feature=null,this._featureMenuIntersectionObserverCallback=([i])=>{(i==null?void 0:i.isIntersecting)&&this.viewModel.featurePage++},this._featureMenuIntersectionObserver=new IntersectionObserver(this._featureMenuIntersectionObserverCallback,{root:window.document}),this._displaySpinnerThrottled=Zg(()=>this._displaySpinner(),ike),this._exitRelatedRecordsActions=new WeakMap,this._flowItems=new Xe,this.alignment="auto",this.collapsed=!1,this.collapseEnabled=!0,this.dockEnabled=!1,this.featureMenuOpen=!1,this.headingLevel=2,this.maxInlineActions=3,this.messages=null,this.messagesCommon=null,this.spinnerEnabled=!0,this.viewModel=new _X,this.visibleElements=K({},$X),this._addSelectedFeatureIndexHandle(),this.addHandles([we(()=>{var i;return(i=this.viewModel)==null?void 0:i.screenLocation},()=>this._positionContainer()),we(()=>{var i;return[(i=this.viewModel)==null?void 0:i.active,this.dockEnabled]},()=>this._toggleScreenLocationEnabled()),we(()=>{var i;return(i=this.viewModel)==null?void 0:i.screenLocation},(i,r)=>{!!i!=!!r&&this.reposition()}),we(()=>{var i,r,n,o,c,h;return[(r=(i=this.viewModel)==null?void 0:i.view)==null?void 0:r.padding,(o=(n=this.viewModel)==null?void 0:n.view)==null?void 0:o.size,(c=this.viewModel)==null?void 0:c.active,(h=this.viewModel)==null?void 0:h.location,this.alignment]},()=>this.reposition()),we(()=>this.spinnerEnabled,i=>this._spinnerEnabledChange(i)),we(()=>{var i,r;return(r=(i=this.viewModel)==null?void 0:i.view)==null?void 0:r.size},(i,r)=>this._updateDockEnabledForViewSize(i,r)),we(()=>{var i;return(i=this.viewModel)==null?void 0:i.view},(i,r)=>this._viewChange(i,r)),we(()=>{var i,r;return(r=(i=this.viewModel)==null?void 0:i.view)==null?void 0:r.ready},(i,r)=>this._viewReadyChange(i,r)),we(()=>{var i,r;return[(i=this.viewModel)==null?void 0:i.waitingForResult,(r=this.viewModel)==null?void 0:r.location]},()=>{this._hideSpinner(),this._displaySpinnerThrottled()}),we(()=>this.selectedFeatureWidget,()=>this._destroyFlowItemWidgets()),we(()=>{var i,r,n,o;return[(r=(i=this.selectedFeatureWidget)==null?void 0:i.viewModel)==null?void 0:r.title,(o=(n=this.selectedFeatureWidget)==null?void 0:n.viewModel)==null?void 0:o.state]},()=>this._setTitleFromFeatureWidget()),we(()=>{var i,r,n,o;return[(r=(i=this.selectedFeatureWidget)==null?void 0:i.viewModel)==null?void 0:r.content,(o=(n=this.selectedFeatureWidget)==null?void 0:n.viewModel)==null?void 0:o.state]},()=>this._setContentFromFeatureWidget()),os(()=>!this.collapsed,()=>{var i,r;((r=(i=this.viewModel)==null?void 0:i.view)==null?void 0:r.widthBreakpoint)==="xsmall"&&this.viewModel.active&&this.collapseEnabled&&this.viewModel.centerAtLocation()}),vr(()=>{var i;return(i=this.viewModel)==null?void 0:i.allActions},"change",()=>this._watchActions()),we(()=>{var i;return(i=this.viewModel)==null?void 0:i.allActions},()=>this._watchActions(),St),we(()=>{var i;return(i=this.viewModel)==null?void 0:i.featureViewModels},()=>this._featureMenuViewportScrollTop()),vr(()=>this._flowItems,"change",()=>{this.notifyChange("_activeFlowItemWidget"),this.scheduleRender()}),we(()=>{var i,r,n,o;return[(r=(i=this._activeFlowItemWidget)==null?void 0:i.viewModel)==null?void 0:r.state,(o=(n=this._activeFlowItemWidget)==null?void 0:n.viewModel)==null?void 0:o.title]},()=>this.scheduleRender())])}loadDependencies(){return Promise.all([import("./calcite-flow.a33e5468.js"),import("./calcite-flow-item.29c64843.js"),import("./calcite-action.fe807edf.js"),import("./calcite-tooltip.0077a311.js"),import("./calcite-icon.3e014da3.js")])}destroy(){var e,t;this._destroyFlowItemWidgets(),this._destroySelectedFeatureWidget(),this._destroySpinner(),(e=this._handles)==null||e.destroy(),this._unobserveFeatureMenuObserver(),(t=this._featureMenuIntersectionObserver)==null||t.disconnect(),this._handles=null}get actionsMenuId(){return`${this.id}-actions-menu`}get actionsMenuButtonId(){return`${this.id}-actions-menu-button`}get featureMenuId(){return`${this.id}-feature-menu`}get titleId(){return`${this.id}-popup-title`}get contentId(){return`${this.id}-popup-content`}get hasContent(){const{selectedFeatureWidget:e,viewModel:t}=this;if(!e)return!!(t==null?void 0:t.content);const i=e.viewModel;if((i==null?void 0:i.waitingForContent)||(i==null?void 0:i.state)==="error")return!0;const r=i==null?void 0:i.content;return Array.isArray(r)?!!r.length:!!r}get featureNavigationVisible(){return this.viewModel.active&&this.viewModel.featureCount>1&&this.visibleElements.featureNavigation}get collapsible(){return!!(this.collapseEnabled&&this.viewModel.title&&this.hasContent)}get featureMenuVisible(){return this.featureNavigationVisible&&this.featureMenuOpen}get contentCollapsed(){return this.collapsible&&!this.featureMenuVisible&&this.collapsed}get dividedActions(){return this._divideActions()}get _activeFlowItemWidget(){const{_flowItems:e}=this;return e.getItemAt(e.length-1)||null}get actions(){return this.viewModel.actions}set actions(e){this.viewModel.actions=e}set actionsMenuOpen(e){this._set("actionsMenuOpen",!!e)}get actionsMenuOpen(){return!!this.viewModel.active&&this._get("actionsMenuOpen")}get autoCloseEnabled(){return this.viewModel.autoCloseEnabled}set autoCloseEnabled(e){this.viewModel.autoCloseEnabled=e}get autoOpenEnabled(){return this.viewModel.autoOpenEnabled}set autoOpenEnabled(e){this.viewModel.autoOpenEnabled=e}get defaultPopupTemplateEnabled(){return this.viewModel.defaultPopupTemplateEnabled}set defaultPopupTemplateEnabled(e){this.viewModel.defaultPopupTemplateEnabled=e}get content(){return this.viewModel.content}set content(e){this.viewModel.content=e}get currentAlignment(){return this._getCurrentAlignment()}get currentDockPosition(){return this._getCurrentDockPosition()}get dockOptions(){return this._get("dockOptions")||MX}set dockOptions(e){const t=K({},MX),i=this.get("viewModel.view.breakpoints"),r={};i&&(r.width=i.xsmall,r.height=i.xsmall);const n=K(K({},t),e),o=K(K({},t.breakpoint),r),{breakpoint:c}=n;c===!0?n.breakpoint=o:typeof c=="object"&&(n.breakpoint=K(K({},o),c)),this._set("dockOptions",n),this._setCurrentDockPosition(),this.reposition()}get featureCount(){return this.viewModel.featureCount}get features(){return this.viewModel.features}set features(e){this.viewModel.features=e}get goToOverride(){return this.viewModel.goToOverride}set goToOverride(e){this.viewModel.goToOverride=e}get highlightEnabled(){return this.viewModel.highlightEnabled}set highlightEnabled(e){this.viewModel.highlightEnabled=e}get location(){return this.viewModel.location}set location(e){this.viewModel.location=e}get label(){var e,t;return(t=(e=this.messages)==null?void 0:e.widgetLabel)!=null?t:""}set label(e){this._overrideIfSome("label",e)}get promises(){return this.viewModel.promises}set promises(e){this.viewModel.promises=e}get selectedFeature(){return this.viewModel.selectedFeature}get selectedFeatureIndex(){return this.viewModel.selectedFeatureIndex}set selectedFeatureIndex(e){this.viewModel.selectedFeatureIndex=e}get selectedFeatureWidget(){const{_feature:e,visibleElements:t,headingLevel:i,_flowItems:r}=this,{selectedFeatureViewModel:n}=this.viewModel,o=Ce(K({},t),{title:!1});return n?(e?(e.viewModel=n,e.visibleElements=o):this._feature=new T6e({flowItems:r,headingLevel:i+1,viewModel:n,visibleElements:o}),this._feature):null}get title(){return this.viewModel.title}set title(e){this.viewModel.title=e}get updateLocationEnabled(){return this.viewModel.updateLocationEnabled}set updateLocationEnabled(e){this.viewModel.updateLocationEnabled=e}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}get visible(){return this.viewModel.visible}set visible(e){this.viewModel.visible=e}castVisibleElements(e){return K(K({},$X),e)}blur(){const{active:e}=this.viewModel;e||$e.getLogger(this.declaredClass).warn("Popup can only be blurred when currently active."),this.visibleElements.closeButton?this._blurClose=!0:this._blurContainer=!0,this.scheduleRender()}clear(){return this.viewModel.clear()}close(){this.visible=!1}fetchFeatures(e,t){return this.viewModel.fetchFeatures(e,t)}focus(){const{active:e}=this.viewModel;e||$e.getLogger(this.declaredClass).warn("Popup can only be focused when currently active."),this.visibleElements.closeButton?this._focusClose=!0:this._focusContainer=!0,this.scheduleRender()}next(){return this.viewModel.next()}open(e){var n,o;this._handles.remove(xX);const t=!!e&&!!e.featureMenuOpen,i=!!e&&!!e.actionsMenuOpen,r={collapsed:!!e&&!!e.collapsed,actionsMenuOpen:i,featureMenuOpen:t};((o=(n=this.viewModel)==null?void 0:n.view)==null?void 0:o.widthBreakpoint)==="xsmall"&&(r.collapsed=!0),this.set(r),this.viewModel.open(e),this._shouldFocus(e),this._addSelectedFeatureIndexHandle()}previous(){return this.viewModel.previous()}reposition(){this.renderNow(),this._positionContainer(),this._setCurrentAlignment()}triggerAction(e){return this.viewModel.triggerAction(e)}render(){var P,F,N,B;const{actionsMenuOpen:e,dockEnabled:t,featureMenuVisible:i,dividedActions:r,currentAlignment:n,currentDockPosition:o}=this,{active:c}=this.viewModel,{menuActions:h}=r,m=c&&h.length>1&&e,b=c&&t,x=c&&!t,I=(F=(P=this.selectedFeature)==null?void 0:P.layer)==null?void 0:F.title,E=(B=(N=this.selectedFeature)==null?void 0:N.layer)==null?void 0:B.id,k={[qe.alignTopCenter]:n==="top-center",[qe.alignBottomCenter]:n==="bottom-center",[qe.alignTopLeft]:n==="top-left",[qe.alignBottomLeft]:n==="bottom-left",[qe.alignTopRight]:n==="top-right",[qe.alignBottomRight]:n==="bottom-right",[qe.isDocked]:b,[qe.shadow]:x,[qe.isDockedTopLeft]:o==="top-left",[qe.isDockedTopCenter]:o==="top-center",[qe.isDockedTopRight]:o==="top-right",[qe.isDockedBottomLeft]:o==="bottom-left",[qe.isDockedBottomCenter]:o==="bottom-center",[qe.isDockedBottomRight]:o==="bottom-right",[qe.isFeatureMenuOpen]:i,[qe.isActionsMenuOpen]:m};return j("div",{class:this.classes(qe.base,k),role:"presentation","data-layer-title":I,"data-layer-id":E,bind:this,afterCreate:this._positionContainer,afterUpdate:this._positionContainer},c?[this.renderMainContainer(),this.renderPointer()]:null)}renderLoadingIcon(){return j("span",{"aria-hidden":"true",class:this.classes(qe.icon,qe.iconLoading,qe.rotating)})}renderNavigationLoading(){const{messagesCommon:e}=this;return this.viewModel.pendingPromisesCount?j("div",{key:tp("loading-container"),role:"presentation",class:qe.loadingContainer,"aria-label":e.loading,title:e.loading},this.renderLoadingIcon()):null}renderPreviousIcon(){const e=Ms(this.container),t={[qe.iconRightTriangleArrow]:e,[qe.paginationPreviousIconRTL]:e,[qe.iconLeftTriangleArrow]:!e,[qe.paginationPreviousIconLTR]:!e};return j("span",{"aria-hidden":"true",class:this.classes(qe.icon,t)})}renderPreviousButton(){const{messages:e}=this;return j("div",{role:"button",tabIndex:0,bind:this,onclick:this._previous,onkeydown:this._previous,class:this.classes(qe.button,qe.paginationPrevious),"aria-label":e.previous,title:e.previous},this.renderPreviousIcon())}renderNextIcon(){const e=Ms(this.container),t={[qe.iconLeftTriangleArrow]:e,[qe.paginationNextIconRTL]:e,[qe.iconRightTriangleArrow]:!e,[qe.paginationNextIconLTR]:!e};return j("span",{"aria-hidden":"true",class:this.classes(qe.icon,t)})}renderNextButton(){const{messages:e}=this;return j("div",{role:"button",tabIndex:0,bind:this,onclick:this._next,onkeydown:this._next,class:this.classes(qe.button,qe.paginationNext),"aria-label":e.next,title:e.next},this.renderNextIcon())}renderFeatureMenuButton(){const{featureMenuOpen:e,featureMenuId:t,messagesCommon:i}=this,{featureCount:r,selectedFeatureIndex:n}=this.viewModel;return j("div",{role:"button",tabIndex:0,bind:this,onclick:this._toggleFeatureMenu,onkeydown:this._toggleFeatureMenu,afterCreate:this._focusFeatureMenuButtonNode,afterUpdate:this._focusFeatureMenuButtonNode,class:this.classes(qe.button,qe.featureMenuButton),"aria-haspopup":"true","aria-controls":t,"aria-expanded":e.toString(),"aria-label":i.menu,title:i.menu},this._getPageText(r,n))}renderNavigationButtons(){return this.featureNavigationVisible?[this.renderPreviousButton(),this.renderNavigationLoading()||this.renderFeatureMenuButton(),this.renderNextButton()]:null}renderDockIcon(){const{dockEnabled:e}=this,t=this._wouldDockTo(),i={[qe.iconUndock]:e,[qe.iconDock]:!e,[qe.iconDockToRight]:!e&&(t==="top-right"||t==="bottom-right"),[qe.iconDockToLeft]:!e&&(t==="top-left"||t==="bottom-left"),[qe.iconDockToTop]:!e&&t==="top-center",[qe.iconDockToBottom]:!e&&t==="bottom-center"};return j("span",{"aria-hidden":"true",class:this.classes(i,qe.icon)})}renderDockButton(){var n,o,c;const{dockEnabled:e,messages:t}=this,i=(o=(n=this.viewModel)==null?void 0:n.view)==null?void 0:o.widthBreakpoint,r=e?t.undock:t.dock;return i!=="xsmall"&&((c=this.dockOptions)==null?void 0:c.buttonEnabled)?j("div",{role:"button","aria-label":r,title:r,tabIndex:0,bind:this,onclick:this._toggleDockEnabled,onkeydown:this._toggleDockEnabled,afterCreate:this._focusDockButtonNode,afterUpdate:this._focusDockButtonNode,class:this.classes(qe.button,qe.buttonDock)},this.renderDockIcon()):null}renderTitle(){const{title:e}=this.viewModel,{titleId:t,collapsible:i,contentCollapsed:r,messagesCommon:n}=this,o={[qe.headerContainerButton]:i},c=j(Va,{level:this.headingLevel,class:qe.headerTitle,innerHTML:e}),h=i?j("button",{key:`${e}--collapsible`,id:t,title:r?n.expand:n.collapse,bind:this,enterAnimation:this._createFeatureUpdatedAnimation(),class:this.classes(qe.headerContainer,o),"aria-expanded":r?"false":"true",onclick:this._toggleCollapsed,type:"button"},c,j("calcite-icon",{class:qe.collapseIcon,key:"collapse-icon",icon:r?"chevron-down":"chevron-up",scale:"m"})):j("div",{key:e,id:t,bind:this,enterAnimation:this._createFeatureUpdatedAnimation(),class:this.classes(qe.headerContainer,o)},c);return e?h:null}renderCloseIcon(){return j("span",{"aria-hidden":"true",class:this.classes(qe.icon,qe.iconClose)})}renderCloseButton(){const{visibleElements:e,messagesCommon:t}=this;return e.closeButton?j("div",{role:"button",tabIndex:0,bind:this,onclick:this._close,onkeydown:this._close,class:qe.button,"aria-label":t.close,title:t.close,afterCreate:this._closeButtonNodeUpdated,afterUpdate:this._closeButtonNodeUpdated},this.renderCloseIcon()):null}renderHeader(){return j("header",{class:qe.header},this.renderTitle(),j("div",{class:qe.headerButtons},this.renderDockButton(),this.renderCloseButton()))}renderContentContainer(){const{contentId:e,hasContent:t,contentCollapsed:i,_flowItems:r,messagesCommon:n}=this,{content:o}=this.viewModel,c=r.toArray(),h={[qe.contentHasFlows]:!!c.length};return t&&!i?j("div",{key:o,enterAnimation:this._createFeatureUpdatedAnimation(),id:e,class:this.classes(qe.content,h)},j("calcite-flow",{bind:this,onCalciteFlowItemBack:this._handleBackClick},j("calcite-flow-item",{bind:this,"data-node-ref":"_rootFlowItemNode","intl-back":n.back,afterCreate:Fh,key:"root-flow-item"},this.renderContent()),c.map(m=>this.renderFlowItem(m))),c.map(m=>this.renderFlowItemTooltip(m))):null}renderFlowItem(e){const{messages:t,messagesCommon:i}=this,r=z_();return j("calcite-flow-item",{class:this.classes({[qe.calciteThemeDark]:!r,[qe.calciteThemeLight]:r}),heading:e.title,"intl-back":i.back,description:this._getFlowItemDescription(e),key:`flow-item-${e.viewModel.uid}`},j("calcite-action",{class:qe.actionExit,icon:"move-up",label:t==null?void 0:t.exitRelatedRecords,text:t==null?void 0:t.exitRelatedRecords,slot:"header-actions-start",bind:this,afterCreate:n=>this._storeExitRelatedRecordsAction(e,n),onclick:this._destroyFlowItemWidgets}),j("div",{class:this.classes(qe.contentFlowItem,{[qe.calciteThemeDark]:r,[qe.calciteThemeLight]:!r})},e.render()))}renderFlowItemTooltip(e){const{messages:t,_exitRelatedRecordsActions:i}=this,r=z_();return j("calcite-tooltip",{class:this.classes({[qe.calciteThemeDark]:!r,[qe.calciteThemeLight]:r}),key:`exit-related-records-tooltip-${e.viewModel.uid}`,label:t==null?void 0:t.exitRelatedRecords,overlayPositioning:"fixed",referenceElement:i.get(e),placement:"top"},t==null?void 0:t.exitRelatedRecords)}renderActionsMenuButton(){const{actionsMenuId:e,actionsMenuButtonId:t,actionsMenuOpen:i,dividedActions:r,messagesCommon:n}=this,o=i?n.close:n.open,{menuActions:c}=r;return c.length?j("div",{key:tp("actions-menu-button"),class:this.classes(qe.button,qe.actionsMenuButton),role:"button",id:t,"aria-haspopup":"true","aria-controls":i?e:null,tabIndex:0,bind:this,onclick:this._toggleActionsMenu,onkeydown:this._toggleActionsMenu,afterCreate:this._focusActionsMenuButtonNode,afterUpdate:this._focusActionsMenuButtonNode,"aria-label":o,title:o},j("span",{"aria-hidden":"true",class:qe.iconActionsMenu})):null}renderMenuActions(){const{actionsMenuId:e,actionsMenuButtonId:t,actionsMenuOpen:i,dividedActions:r}=this,{menuActions:n}=r;return n.length&&i?j("ul",{id:e,role:"menu","aria-labelledby":t,key:tp("actions"),class:qe.actions,bind:this,onkeyup:this._handleActionMenuKeyup,afterCreate:this._actionsMenuNodeUpdated,afterUpdate:this._actionsMenuNodeUpdated},n.toArray().map(o=>this.renderAction({action:o,type:"menu-item"}))):null}renderInlineActions(){const{inlineActions:e}=this.dividedActions;return!!e.length&&e.toArray().map(t=>this.renderAction({action:t,type:"inline"}))}renderInlineActionsContainer(){const{inlineActions:e,menuActions:t}=this.dividedActions,i=!!e.length,r=!!t.length;return i||r?j("div",{key:"inline-actions-container","data-inline-actions":i.toString(),"data-menu-actions":r.toString(),class:qe.inlineActionsContainer},this.renderInlineActions(),this.renderActionsMenuButton(),this.renderMenuActions()):null}renderNavigation(){return this.featureNavigationVisible?j("section",{key:tp("navigation"),class:this.classes(qe.navigation)},this.renderNavigationButtons()):null}renderFooter(){const{featureNavigationVisible:e,dividedActions:t}=this,{inlineActions:i,menuActions:r}=t,n=!!i.length,o=!!r.length,c={[qe.footerHasPagination]:e,[qe.footerHasActions]:n,[qe.footerHasActionsMenu]:o};return e||n?j("div",{key:tp("feature-buttons"),class:this.classes(qe.footer,c)},this.renderInlineActionsContainer(),this.renderNavigation()):null}renderFeatureMenuContainer(){const{messages:e}=this,{featureViewModels:t,isLoadingFeature:i}=this.viewModel,r=oo(e.selectedFeatures,{total:t.length});return j("section",{key:tp("menu"),class:qe.featureMenu},j("strong",{class:qe.featureMenuHeader},r),j("nav",{bind:this,class:qe.featureMenuViewport,"data-node-ref":"_featureMenuViewportNode",afterCreate:Fh},this.renderFeatureMenu(),j("div",{class:qe.featureMenuObserver,bind:this,afterCreate:this._featureMenuIntersectionObserverCreated}),i?j("div",{class:qe.featureMenuLoader},this.renderLoadingIcon()):null))}renderPointer(){return this.dockEnabled?null:j("div",{key:tp("pointer"),class:qe.pointer,role:"presentation"},j("div",{class:this.classes(qe.pointerDirection,qe.shadow)}))}renderMainContainer(){const{dockEnabled:e,currentAlignment:t,currentDockPosition:i,titleId:r,contentId:n,collapsible:o,hasContent:c,contentCollapsed:h,visibleElements:m}=this,{title:b}=this.viewModel,x=t==="bottom-left"||t==="bottom-center"||t==="bottom-right"||i==="top-left"||i==="top-center"||i==="top-right",I=t==="top-left"||t==="top-center"||t==="top-right"||i==="bottom-left"||i==="bottom-center"||i==="bottom-right",E={[qe.shadow]:e,[qe.isCollapsible]:o,[qe.isCollapsed]:h};return j("div",{class:this.classes(qe.main,qe.widget,E),tabIndex:m.closeButton?null:-1,role:"dialog","aria-labelledby":b?r:"","aria-describedby":c&&!h?n:"",bind:this,onkeyup:this._handleMainKeyup,afterCreate:this._mainContainerNodeUpdated,afterUpdate:this._mainContainerNodeUpdated},x?this.renderFooter():null,x?this.renderFeatureMenuContainer():null,this.renderHeader(),this.renderContentContainer(),I?this.renderFooter():null,I?this.renderFeatureMenuContainer():null)}renderContent(){var t;const e=(t=this.viewModel)==null?void 0:t.content;return e?typeof e=="string"?j("div",{class:Hr.contentNode,key:e,innerHTML:e}):this.renderNodeContent(e):null}renderActionText(e){return j("span",{key:"text",class:qe.actionText},e)}renderActionIcon(e){const t=this._getActionClass(e),i=this._getActionImage(e),r={[qe.iconLoading]:e.active,[qe.rotating]:e.active,[qe.icon]:!!t,[qe.actionImage]:!e.active&&!!i};return t&&(r[t]=!e.active),j("span",{key:"icon","aria-hidden":"true",class:this.classes(qe.icon,r),styles:this._getIconStyles(i)})}renderAction(e){const{action:t,type:i}=e,r=this._getActionTitle(t),n={[qe.action]:t.type!=="toggle",[qe.actionToggle]:t.type==="toggle",[qe.actionToggleOn]:t.type==="toggle"&&t.value,[qe.buttonDisabled]:t.disabled},o=[this.renderActionIcon(t),this.renderActionText(r)],c=i==="menu-item"?j("li",{key:t.uid,role:"menuitem",tabIndex:0,title:r,"aria-label":r,class:this.classes(qe.button,n),onkeyup:this._handleActionMenuItemKeyup,bind:this,"data-action-uid":t.uid,onclick:this._triggerAction,onkeydown:this._triggerAction},o):j("div",{key:t.uid,role:"button",tabIndex:0,title:r,"aria-label":r,class:this.classes(qe.button,n),onkeyup:this._handleActionMenuItemKeyup,bind:this,"data-action-uid":t.uid,onclick:this._triggerAction,onkeydown:this._triggerAction},o);return t.visible?c:null}renderFeatureMenuItem(e,t){const{messages:i,messagesCommon:r}=this,{selectedFeatureIndex:n,selectedFeatureViewModel:o}=this.viewModel,c=e===o,h={[qe.featureMenuSelected]:c},m=c?j("span",{key:tp(`feature-menu-selected-feature-${n}`),title:i.selectedFeature,"aria-label":i.selectedFeature,class:qe.iconCheckMark}):null,b=j("span",{innerHTML:e.title||r.untitled});return j("li",{role:"menuitem",tabIndex:-1,key:tp(`feature-menu-feature-${n}`),class:this.classes(h,qe.featureMenuItem),bind:this,"data-feature-index":t,onblur:this._removeActiveFeature,onfocus:this._setActiveFeature,onkeyup:this._handleFeatureMenuItemKeyup,onclick:this._selectFeature,onkeydown:this._selectFeature,onmouseover:this._setActiveFeature,onmouseleave:this._removeActiveFeature},j("span",{class:qe.featureMenuTitle},b,m))}renderFeatureMenu(){const{featureMenuId:e}=this,{featureViewModels:t}=this.viewModel;return t.length>1?j("ol",{class:qe.featureMenuList,id:e,bind:this,afterCreate:this._featureMenuNodeUpdated,afterUpdate:this._featureMenuNodeUpdated,onkeyup:this._handleFeatureMenuKeyup,role:"menu"},t.filter(i=>!!i.graphic).map((i,r)=>this.renderFeatureMenuItem(i,r))):null}_storeExitRelatedRecordsAction(e,t){this._exitRelatedRecordsActions.set(e,t),this.scheduleRender()}_getFlowItemDescription(e){return"featureCountDescription"in e?e.featureCountDescription:e.viewModel.description}_destroyFlowItemWidgets(){this._flowItems.removeAll().forEach(e=>{"showAllEnabled"in e.viewModel&&(e.viewModel.showAllEnabled=!1),e.viewModel=null,e.destroy()})}_handleBackClick(){const e=this._flowItems.pop();this._exitRelatedRecordsActions.delete(e),"showAllEnabled"in e.viewModel&&(e.viewModel.showAllEnabled=!1),e&&(e.viewModel=null,e.destroy())}_getActionTitle(e){const{messages:t,selectedFeature:i,messagesCommon:r}=this,{id:n}=e,o=i==null?void 0:i.attributes,c=n==="zoom-to-feature"?oo(e.title,{messages:t}):n==="remove-selected-feature"?oo(e.title,{messages:r}):n==="zoom-to-clustered-features"||n==="browse-clustered-features"?oo(e.title,{messages:t}):e.title;return c&&o?oo(c,o):c}_getActionClass(e){const{selectedFeature:t}=this,i=t==null?void 0:t.attributes,{className:r,image:n}=e,o=n||r?r:qe.iconDefaultAction;return o&&i?oo(o,i):o}_getActionImage(e){const{selectedFeature:t}=this,i=t==null?void 0:t.attributes,{image:r}=e;return r&&i?oo(r,i):r}_createFeatureUpdatedAnimation(){return Vxe("enter",qe.hasFeatureUpdated)}_getInlineActionCount(){const{maxInlineActions:e,featureNavigationVisible:t}=this;if(typeof e!="number")return null;const i=Math.round(e);return Math.max(t?i-1:i,0)}_watchActions(){const{allActions:e}=this.viewModel;this.notifyChange("dividedActions");const t="actions";this._handles.remove(t),e&&e.forEach(i=>{this._handles.add(we(()=>[i.uid,i.active,i.className,i.disabled,i.id,i.title,i.image,i.visible],()=>this.scheduleRender()),t)})}_divideActions(){const{allActions:e}=this.viewModel,t=e.filter(o=>o.visible),i=this._getInlineActionCount(),r=i===null,n=i===0;return{inlineActions:r?t.slice(0):n?new Xe:t.slice(0,i),menuActions:r?new Xe:n?t.slice(0):t.slice(i)}}_featureMenuOpenChanged(e){e?this._focusFirstFeature=!0:this._focusFeatureMenuButton=!0}_actionsMenuOpenChanged(e){e?this._focusFirstAction=!0:this._focusActionsMenuButton=!0}_setTitleFromFeatureWidget(){var i,r;const{selectedFeatureWidget:e,messagesCommon:t}=this;e&&(this.viewModel.title=((i=e.viewModel)==null?void 0:i.state)==="error"?t.errorMessage:((r=e.viewModel)==null?void 0:r.title)||"")}_setContentFromFeatureWidget(){const{selectedFeatureWidget:e}=this;e&&(this.viewModel.content=e)}_unobserveFeatureMenuObserver(){this._featureMenuIntersectionObserverNode&&this._featureMenuIntersectionObserver.unobserve(this._featureMenuIntersectionObserverNode)}_featureMenuIntersectionObserverCreated(e){this._unobserveFeatureMenuObserver(),this._featureMenuIntersectionObserver.observe(e),this._featureMenuIntersectionObserverNode=e}_handleFeatureMenuKeyup(e){to(e)==="Escape"&&(e.stopPropagation(),this._focusFeatureMenuButton=!0,this.featureMenuOpen=!1,this.scheduleRender())}_handleActionMenuKeyup(e){to(e)==="Escape"&&(e.stopPropagation(),this._focusActionsMenuButton=!0,this.actionsMenuOpen=!1,this.scheduleRender())}_setActiveFeature(e){const{viewModel:t}=this,i=e.currentTarget["data-feature-index"];t.activeFeature=t.features[i]||null}_removeActiveFeature(){this.viewModel.activeFeature=null}_handleFeatureMenuItemKeyup(e){const t=to(e),{_featureMenuNode:i}=this,r=e.currentTarget["data-feature-index"];if(!i)return;const n=i.querySelectorAll("li"),o=n.length;t!=="ArrowUp"?t!=="ArrowDown"?t!=="Home"?t!=="End"||(e.stopPropagation(),n[n.length-1].focus()):(e.stopPropagation(),n[0].focus()):(e.stopPropagation(),n[(r+1+o)%o].focus()):(e.stopPropagation(),n[(r-1+o)%o].focus())}_handleActionMenuItemKeyup(e){const t=to(e),{_actionsMenuNode:i}=this,r=e.currentTarget.dataset.actionUid,{menuActions:n}=this.dividedActions,o=n.findIndex(m=>m.uid===r);if(!i)return;const c=i.querySelectorAll("li"),h=c.length;t!=="ArrowUp"?t!=="ArrowDown"?t!=="Home"?t!=="End"||(e.stopPropagation(),c[c.length-1].focus()):(e.stopPropagation(),c[0].focus()):(e.stopPropagation(),c[(o+1+h)%h].focus()):(e.stopPropagation(),c[(o-1+h)%h].focus())}_handleMainKeyup(e){const t=to(e);t==="ArrowLeft"&&(e.stopPropagation(),this.previous()),t==="ArrowRight"&&(e.stopPropagation(),this.next())}_spinnerEnabledChange(e){if(this._destroySpinner(),!e)return;const t=this.get("viewModel.view");this._createSpinner(t)}_hideSpinner(){const{_spinner:e}=this;e&&(e.location=null,e.hide())}_displaySpinner(){const{_spinner:e}=this;if(!e)return;const{location:t,waitingForResult:i}=this.viewModel;i?e.show({location:t}):e.hide()}_getIconStyles(e){return{"background-image":e?`url(${e})`:""}}async _shouldFocus(e){e.shouldFocus&&(await Ch(()=>{var t;return((t=this.viewModel)==null?void 0:t.active)===!0}),this.focus())}_addSelectedFeatureIndexHandle(){const e=we(()=>{var t;return(t=this.viewModel)==null?void 0:t.selectedFeatureIndex},(t,i)=>this._selectedFeatureIndexUpdated(t,i));this._handles.add(e,xX)}_selectedFeatureIndexUpdated(e,t){const{featureCount:i}=this;i&&e!==t&&e!==-1&&(this._destroyFlowItemWidgets(),this.actionsMenuOpen=!1,this.featureMenuOpen=!1,this._mainContainerNode&&(this._mainContainerNode.scrollTop=0),this._rootFlowItemNode&&this._rootFlowItemNode.scrollContentTo({top:0}))}_destroySelectedFeatureWidget(){const{_feature:e}=this;e&&(e.viewModel=null,e&&!e.destroyed&&e.destroy()),this._feature=null}_isScreenLocationWithinView(e,t){return e.x>-1&&e.y>-1&&e.x<=t.width&&e.y<=t.height}_isOutsideView(e){const{popupHeight:t,popupWidth:i,screenLocation:r,side:n,view:o}=e;if(isNaN(i)||isNaN(t)||!o||!r)return!1;const c=o.padding;return n==="right"&&r.x+i/2>o.width-c.right||n==="left"&&r.x-i/2<c.left||n==="top"&&r.y-t<c.top||n==="bottom"&&r.y+t>o.height-c.bottom}_calculateAutoAlignment(e){if(e!=="auto")return e;const{_pointerOffsetInPx:t,_containerNode:i,_mainContainerNode:r,viewModel:n}=this,{screenLocation:o,view:c}=n;if(ce(o)||!c||!i)return"top-center";if(!this._isScreenLocationWithinView(o,c))return this._get("currentAlignment")||"top-center";function h(q){return parseInt(q.replace(/[^-\d\.]/g,""),10)}const m=r?window.getComputedStyle(r,null):null,b=m?h(m.getPropertyValue("max-height")):0,x=m?h(m.getPropertyValue("height")):0,{height:I,width:E}=i.getBoundingClientRect(),k=E+t,P=Math.max(I,b,x)+t,F=this._isOutsideView({popupHeight:P,popupWidth:k,screenLocation:o,side:"right",view:c}),N=this._isOutsideView({popupHeight:P,popupWidth:k,screenLocation:o,side:"left",view:c}),B=this._isOutsideView({popupHeight:P,popupWidth:k,screenLocation:o,side:"top",view:c}),z=this._isOutsideView({popupHeight:P,popupWidth:k,screenLocation:o,side:"bottom",view:c});return N?B?"bottom-right":"top-right":F?B?"bottom-left":"top-left":B?z?"top-center":"bottom-center":"top-center"}_callCurrentAlignment(e){return typeof e=="function"?e.call(this):e}_getCurrentAlignment(){const{alignment:e,dockEnabled:t}=this;return t||!this.viewModel.active?null:this._calculatePositionResult(this._calculateAutoAlignment(this._callCurrentAlignment(e)))}_setCurrentAlignment(){this._set("currentAlignment",this._getCurrentAlignment())}_setCurrentDockPosition(){this._set("currentDockPosition",this._getCurrentDockPosition())}_calculatePositionResult(e){const t=["left","right"];return Ms(this.container)&&t.reverse(),e.replace(/leading/gi,t[0]).replace(/trailing/gi,t[1])}_callDockPosition(e){return typeof e=="function"?e.call(this):e}_getDockPosition(){var e;return this._calculatePositionResult(this._calculateAutoDockPosition(this._callDockPosition((e=this.dockOptions)==null?void 0:e.position)))}_getCurrentDockPosition(){return this.dockEnabled&&this.viewModel.active?this._getDockPosition():null}_wouldDockTo(){return this.dockEnabled?null:this._getDockPosition()}_calculateAutoDockPosition(e){var c;if(e!=="auto")return e;const t=(c=this.viewModel)==null?void 0:c.view,i=Ms(this.container)?"top-left":"top-right";if(!t)return i;const r=t.padding||{left:0,right:0,top:0,bottom:0},n=t.width-r.left-r.right,{breakpoints:o}=t;return o&&n<=o.xsmall?"bottom-center":i}_positionContainer(e=this._containerNode){if(e&&(this._containerNode=e),!e)return;const{screenLocation:t}=this.viewModel,{width:i}=e.getBoundingClientRect(),r=this._calculatePositionStyle(t,i);r&&(e.style.top=r.top,e.style.left=r.left,e.style.bottom=r.bottom,e.style.right=r.right)}_calculateFullWidth(e){const{currentAlignment:t,_pointerOffsetInPx:i}=this;return t==="top-left"||t==="bottom-left"||t==="top-right"||t==="bottom-right"?e+i:e}_calculateAlignmentPosition(e,t,i,r){const{currentAlignment:n,_pointerOffsetInPx:o}=this,c=r/2,h=i.height-t,m=i.width-e,{padding:b}=this.view;return n==="bottom-center"?{top:t+o-b.top,left:e-c-b.left}:n==="top-left"?{bottom:h+o-b.bottom,right:m+o-b.right}:n==="bottom-left"?{top:t+o-b.top,right:m+o-b.right}:n==="top-right"?{bottom:h+o-b.bottom,left:e+o-b.left}:n==="bottom-right"?{top:t+o-b.top,left:e+o-b.left}:n==="top-center"?{bottom:h+o-b.bottom,left:e-c-b.left}:void 0}_calculatePositionStyle(e,t){const{dockEnabled:i,view:r}=this;if(!r)return;if(i)return{left:"",top:"",right:"",bottom:""};if(ce(e)||!t)return;const n=this._calculateFullWidth(t),o=this._calculateAlignmentPosition(e.x,e.y,r,n);return o?{top:o.top!==void 0?`${o.top}px`:"auto",left:o.left!==void 0?`${o.left}px`:"auto",bottom:o.bottom!==void 0?`${o.bottom}px`:"auto",right:o.right!==void 0?`${o.right}px`:"auto"}:void 0}_viewChange(e,t){e&&t&&(this.close(),this.clear())}_viewReadyChange(e,t){if(e){const i=this.get("viewModel.view");this._wireUpView(i)}else t&&(this.close(),this.clear())}_wireUpView(e){if(this._destroySpinner(),!e)return;const{spinnerEnabled:t}=this;t&&this._createSpinner(e),this._setDockEnabledForViewSize(this.dockOptions)}_dockingThresholdCrossed(e,t,i){const[r,n]=e,[o,c]=t,{width:h,height:m}=i;return r<=h&&o>h||r>h&&o<=h||n<=m&&c>m||n>m&&c<=m}_updateDockEnabledForViewSize(e,t){if(!e||!t)return;const i=this.get("viewModel.view.padding")||{left:0,right:0,top:0,bottom:0},r=i.left+i.right,n=i.top+i.bottom,o=[],c=[];o[0]=e[0]-r,o[1]=e[1]-n,c[0]=t[0]-r,c[1]=t[1]-n;const{dockOptions:h}=this,m=h.breakpoint;this._dockingThresholdCrossed(o,c,m)&&this._setDockEnabledForViewSize(h),this._setCurrentDockPosition()}_focusDockButtonNode(e){this._focusDockButton&&(this._focusDockButton=!1,e.focus())}_closeButtonNodeUpdated(e){return this._focusClose?(this._focusClose=!1,void e.focus()):this._blurClose?(this._blurClose=!1,void e.blur()):void 0}_mainContainerNodeUpdated(e){return this._mainContainerNode=e,this._focusContainer?(this._focusContainer=!1,void e.focus()):this._blurContainer?(this._blurContainer=!1,void e.blur()):void 0}_featureMenuNodeUpdated(e){if(this._featureMenuNode=e,!e||!this._focusFirstFeature)return;this._focusFirstFeature=!1;const t=e.querySelectorAll("li");t.length&&t[0].focus()}_actionsMenuNodeUpdated(e){if(this._actionsMenuNode=e,!e||!this._focusFirstAction)return;this._focusFirstAction=!1;const t=e.querySelectorAll("li");t.length&&t[0].focus()}_focusFeatureMenuButtonNode(e){this._focusFeatureMenuButton&&(this._focusFeatureMenuButton=!1,e.focus())}_focusActionsMenuButtonNode(e){this._focusActionsMenuButton&&(this._focusActionsMenuButton=!1,e.focus())}_featureMenuViewportScrollTop(){this._featureMenuViewportNode&&(this._featureMenuViewportNode.scrollTop=0)}_toggleScreenLocationEnabled(){const{dockEnabled:e,viewModel:t}=this;if(!t)return;const i=t.active&&!e;t.screenLocationEnabled=i}_shouldDockAtCurrentViewSize(e){var h,m;const t=e.breakpoint,i=(m=(h=this.viewModel)==null?void 0:h.view)==null?void 0:m.ui;if(!i)return!1;const{width:r,height:n}=i;if(isNaN(r)||isNaN(n))return!1;const o=t.hasOwnProperty("width")&&r<=t.width,c=t.hasOwnProperty("height")&&n<=t.height;return o||c}_setDockEnabledForViewSize(e){e.breakpoint&&(this.dockEnabled=this._shouldDockAtCurrentViewSize(e))}_getPageText(e,t){return this.featureNavigationVisible?oo(this.messages.pageText,{index:t+1,total:e}):null}_destroySpinner(){const{_spinner:e,view:t}=this;e&&(t&&t.ui&&t.ui.remove(this._spinner,SX),e.destroy(),this._spinner=null)}_createSpinner(e){e&&(this._spinner=new k6e({view:e}),e.ui.add(this._spinner,{key:SX,position:"manual"}))}_toggleCollapsed(){this.collapsed=!this.collapsed}_close(){this.close(),this.view&&this.view.focus()}_toggleDockEnabled(){this.dockEnabled=!this.dockEnabled,this._focusDockButton=!0,this.scheduleRender()}_toggleFeatureMenu(){const e=!this.featureMenuOpen;this._featureMenuOpenChanged(e),this.actionsMenuOpen=!1,this.featureMenuOpen=e}_toggleActionsMenu(){const e=!this.actionsMenuOpen;this._actionsMenuOpenChanged(e),this.featureMenuOpen=!1,this.actionsMenuOpen=e}_triggerAction(e){const t=e.currentTarget.dataset.actionUid,{allActions:i}=this.viewModel,r=i.findIndex(o=>o.uid===t),n=i.getItemAt(r);n&&n.type==="toggle"&&(n.value=!n.value),this.actionsMenuOpen=!1,this.viewModel.triggerAction(r)}_selectFeature(e){const t=e.currentTarget["data-feature-index"];isNaN(t)||(this.viewModel.selectedFeatureIndex=t),this.featureMenuOpen=!1,this._focusFeatureMenuButton=!0,this.scheduleRender()}_next(){this.next()}_previous(){this.previous()}};g([w({readOnly:!0})],Lt.prototype,"actionsMenuId",null),g([w({readOnly:!0})],Lt.prototype,"actionsMenuButtonId",null),g([w({readOnly:!0})],Lt.prototype,"featureMenuId",null),g([w({readOnly:!0})],Lt.prototype,"titleId",null),g([w({readOnly:!0})],Lt.prototype,"contentId",null),g([w({readOnly:!0})],Lt.prototype,"hasContent",null),g([w({readOnly:!0})],Lt.prototype,"featureNavigationVisible",null),g([w({readOnly:!0})],Lt.prototype,"collapsible",null),g([w({readOnly:!0})],Lt.prototype,"featureMenuVisible",null),g([w({readOnly:!0})],Lt.prototype,"contentCollapsed",null),g([w({readOnly:!0})],Lt.prototype,"dividedActions",null),g([w({readOnly:!0,dependsOn:["_flowItems.length"]})],Lt.prototype,"_activeFlowItemWidget",null),g([w()],Lt.prototype,"actions",null),g([w()],Lt.prototype,"actionsMenuOpen",null),g([w()],Lt.prototype,"alignment",void 0),g([w()],Lt.prototype,"autoCloseEnabled",null),g([w()],Lt.prototype,"autoOpenEnabled",null),g([w()],Lt.prototype,"defaultPopupTemplateEnabled",null),g([w()],Lt.prototype,"content",null),g([w()],Lt.prototype,"collapsed",void 0),g([w()],Lt.prototype,"collapseEnabled",void 0),g([w({readOnly:!0})],Lt.prototype,"currentAlignment",null),g([w({readOnly:!0})],Lt.prototype,"currentDockPosition",null),g([w()],Lt.prototype,"dockOptions",null),g([w()],Lt.prototype,"dockEnabled",void 0),g([w({readOnly:!0})],Lt.prototype,"featureCount",null),g([w()],Lt.prototype,"featureMenuOpen",void 0),g([w()],Lt.prototype,"features",null),g([w()],Lt.prototype,"goToOverride",null),g([w()],Lt.prototype,"headingLevel",void 0),g([w()],Lt.prototype,"highlightEnabled",null),g([w()],Lt.prototype,"location",null),g([w()],Lt.prototype,"label",null),g([w()],Lt.prototype,"maxInlineActions",void 0),g([w(),ci("esri/widgets/Popup/t9n/Popup")],Lt.prototype,"messages",void 0),g([w(),ci("esri/t9n/common")],Lt.prototype,"messagesCommon",void 0),g([w()],Lt.prototype,"promises",null),g([w({readOnly:!0})],Lt.prototype,"selectedFeature",null),g([w()],Lt.prototype,"selectedFeatureIndex",null),g([w({readOnly:!0})],Lt.prototype,"selectedFeatureWidget",null),g([w()],Lt.prototype,"spinnerEnabled",void 0),g([w()],Lt.prototype,"title",null),g([w()],Lt.prototype,"updateLocationEnabled",null),g([w()],Lt.prototype,"view",null),g([w({type:_X}),n1(["triggerAction","trigger-action"])],Lt.prototype,"viewModel",void 0),g([w()],Lt.prototype,"visible",null),g([w()],Lt.prototype,"visibleElements",void 0),g([Dt("visibleElements")],Lt.prototype,"castVisibleElements",null),g([Ki()],Lt.prototype,"_close",null),g([Ki()],Lt.prototype,"_toggleDockEnabled",null),g([Ki()],Lt.prototype,"_toggleFeatureMenu",null),g([Ki()],Lt.prototype,"_toggleActionsMenu",null),g([Ki()],Lt.prototype,"_triggerAction",null),g([Ki()],Lt.prototype,"_selectFeature",null),g([Ki()],Lt.prototype,"_next",null),g([Ki()],Lt.prototype,"_previous",null),Lt=g([te("esri.widgets.Popup")],Lt);const EX=Lt,VP=[0,0];function rke(e){var r,n;const t=(e.ownerDocument||window.document).defaultView,i=e.getBoundingClientRect();return VP[0]=i.left+((r=t==null?void 0:t.pageXOffset)!=null?r:0),VP[1]=i.top+((n=t==null?void 0:t.pageYOffset)!=null?n:0),VP}function TX(e){e&&(Mq(e),e.parentNode&&e.parentNode.removeChild(e))}function nke(e){const t=document.createElement("div");return e.appendChild(t),t}const G2=16,XM=750,ske=512,oke=2,ake=e=>{let t=class extends e{constructor(...i){var r;super(...i),this._freqInfo={freq:G2,time:XM},this._overlayRenderTaskHandle=null,this.height=0,this.overlay=null,this.position=null,this.resizing=!1,this.root=null,this.surface=null,this.suspended=!0,this.ui=null,this.userContent=null,this.width=0,this.widthBreakpoint=null,i.length!==0&&((r=i[0])==null?void 0:r.popup)!==void 0||(this.popup=new EX({view:this})),this.handles.add([we(()=>this.cursor,n=>{const{surface:o}=this;o&&o.setAttribute("data-cursor",n)}),we(()=>this.interacting,n=>{const{surface:o}=this;o&&o.setAttribute("data-interacting",n.toString())})])}initialize(){this.handles.add(we(()=>this.ui,(i,r)=>this._handleUIChange(i,r))),this._wireUI(this.ui),this.handles.add([this.on("focus",()=>this.notifyChange("focused")),this.on("blur",()=>this.notifyChange("focused"))])}destroy(){this.destroyed||(this.ui=li(this.ui),this.popup&&!this.popup.destroyed&&this.popup.destroy(),this.container=null)}get container(){var i;return(i=this._get("container"))!=null?i:null}set container(i){const r=this._get("container"),n=a9(i),o=n instanceof HTMLDivElement?n:null;if(o||typeof i!="string"||$e.getLogger(this.declaredClass).error("#container",`element with id '${i}' not found`),r===o)return;const c="dom-size";if(this.handles.remove(c),this._stopMeasuring(),r&&(r.classList.remove("esri-view"),this._overlayRenderTaskHandle&&(this._overlayRenderTaskHandle.remove(),this._overlayRenderTaskHandle=null),this.overlay&&(this.overlay.destroy(),this._set("overlay",null)),this.root&&(TX(this.root),this._set("root",null)),this.userContent&&($q(this.userContent,r),TX(this.userContent),this._set("userContent",null))),!o)return this._set("width",0),this._set("height",0),this._set("position",null),this._set("suspended",!0),this._set("surface",null),void this._set("container",null);o.classList.add("esri-view");const h=document.createElement("div");h.className="esri-view-user-storage",$q(o,h),o.appendChild(h),this._set("userContent",h);const m=document.createElement("div");m.className="esri-view-root",o.insertBefore(m,o.firstChild),this._set("root",m);const b=document.createElement("div");b.className="esri-view-surface",b.setAttribute("role","application"),b.tabIndex=0,m.appendChild(b),this._set("surface",b);const x=new oH;m.appendChild(x.surface),this._set("overlay",x),we(()=>x.needsRender,I=>{I&&!this._overlayRenderTaskHandle?this._overlayRenderTaskHandle=tg({render:()=>{var E;return(E=this.overlay)==null?void 0:E.render()}}):this._overlayRenderTaskHandle=mr(this._overlayRenderTaskHandle)}),this.forceDOMReadyCycle(),this.handles.add(we(()=>this.size,I=>{const[E,k]=I,P="esri-view-surface--inset-outline";E>=document.body.clientWidth||k>=document.body.clientHeight?b.classList.add(P):b.classList.remove(P)},St),c),this._set("container",o),this._startMeasuring()}get focused(){const i=document.activeElement===this.surface;return document.hasFocus()&&i}set popup(i){const r=this._get("popup");r&&r!==i&&r.destroy(),this._set("popup",i)}get size(){return[this.width,this.height]}blur(){this.surface&&this.surface.blur()}focus(){this.surface&&this.surface.focus()}pageToContainer(i,r,n){const o=this.position;return i-=o?o[0]:0,r-=o?o[1]:0,n?(n[0]=i,n[1]=r):n=[i,r],n}containerToPage(i,r,n){const o=this.position;return i+=o?o[0]:0,r+=o?o[1]:0,n?(n[0]=i,n[1]=r):n=[i,r],n}_handleUIChange(i,r){r&&(this.handles.remove("ui"),r.destroy()),i&&this._wireUI(i),this._set("ui",i)}_wireUI(i){this.handles.remove("ui"),i&&(i.view=this,this.handles.add([we(()=>this.root,r=>{i.container=r?nke(r):null},St),we(()=>this.popup,(r,n)=>{const o="popup",c="manual";n&&i.remove(n,o),r&&(r.view=i.view,i.add(r,{key:o,position:c}))},St)],"ui"))}_stopMeasuring(){this.handles.remove("measuring"),this._get("resizing")&&this._set("resizing",!1)}_startMeasuring(){const i=this._freqInfo;i.freq=G2,i.time=XM,this.handles.add([(()=>{const r=()=>{i.freq=G2,i.time=XM};return window.addEventListener("resize",r),{remove(){window.removeEventListener("resize",r)}}})(),tg({prepare:r=>{const n=this._measure(),o=this._freqInfo;if(o.time+=r.deltaTime,n&&(o.freq=G2,this._get("resizing")||this._set("resizing",!0)),o.time<o.freq)return;o.time=0;const c=this._position();o.freq=c||n?G2:Math.min(XM,o.freq*oke),!n&&o.freq>=ske&&this._get("resizing")&&this._set("resizing",!1)}})],"measuring"),this._measure(),this._position()}_measure(){const i=this.container,r=i?i.clientWidth:0,n=i?i.clientHeight:0;if(r===0||n===0)return this.suspended||this._set("suspended",!0),!1;const o=this.width,c=this.height;return r===o&&n===c?(this.suspended&&this._set("suspended",!1),!1):(this._set("width",r),this._set("height",n),this.suspended&&this._set("suspended",!1),this.emit("resize",{oldWidth:o,oldHeight:c,width:r,height:n}),!0)}_position(){const i=this.container,r=this.position,n=i&&rke(i);return!!n&&(!r||n[0]!==r[0]||n[1]!==r[1])&&(this._set("position",[n[0],n[1]]),!0)}forceDOMReadyCycle(){}};return g([w()],t.prototype,"container",null),g([w({readOnly:!0})],t.prototype,"focused",null),g([w({readOnly:!0})],t.prototype,"height",void 0),g([w({type:EX})],t.prototype,"popup",null),g([w({type:oH})],t.prototype,"overlay",void 0),g([w({readOnly:!0})],t.prototype,"position",void 0),g([w({readOnly:!0})],t.prototype,"resizing",void 0),g([w({readOnly:!0})],t.prototype,"root",void 0),g([w({value:null,readOnly:!0})],t.prototype,"size",null),g([w({readOnly:!0})],t.prototype,"surface",void 0),g([w({readOnly:!0})],t.prototype,"suspended",void 0),g([w()],t.prototype,"ui",void 0),g([w({readOnly:!0})],t.prototype,"userContent",void 0),g([w({readOnly:!0})],t.prototype,"width",void 0),g([w()],t.prototype,"widthBreakpoint",void 0),t=g([te("esri.views.DOMContainer")],t),t},lke=e=>{let t=class extends e{async fetchPopupFeatures(i,r){await this.when();const{location:n,queryArea:o,layerViewsAndGraphics:c,clientOnlyGraphics:h}=await this._prepareFetchPopupFeatures(i,r),m=Promise.resolve(h),b=this._queryLayerPopupFeatures(o,c,r),x=b.map(I=>I.promise);return{location:n,clientOnlyGraphics:h,allGraphicsPromise:LV([m,...x]).then(I=>Array.from(new Set(I.flat()))),promisesPerLayerView:b}}_queryLayerPopupFeatures(i,r,n){return r.map(({layerView:o,graphics:c})=>{const h={clientGraphics:c,event:H(n)?n.event:null,signal:H(n)?n.signal:null,defaultPopupTemplateEnabled:!!H(n)&&!!n.defaultPopupTemplateEnabled},m=o.fetchPopupFeatures(i,h);return{layerView:o,promise:m}})}_isValidPopupGraphic(i,r){return i&&!!i.getEffectivePopupTemplate(H(r)&&r.defaultPopupTemplateEnabled)}async _prepareFetchPopupFeatures(i,r){const{clientGraphics:n,queryArea:o,location:c}=await this._popupHitTestGraphics(i,r),h=this._getFetchPopupLayerViews(),{layerViewsAndGraphics:m,clientOnlyGraphics:b}=this._graphicsPerFetchPopupLayerView(n,h);return{clientOnlyGraphics:b,layerViewsAndGraphics:m,queryArea:o,location:c}}async _popupHitTestGraphics(i,r){const{results:n,mapPoint:o}=await this.popupHitTest(i),c=n.filter(m=>m.type==="graphic"&&this._isValidPopupGraphic(m.graphic,r)),h=c.length?c[0].mapPoint:null;return{clientGraphics:c.map(m=>m.graphic),queryArea:o,location:o||h}}_getFetchPopupLayerViews(){const i=[];return this.allLayerViews.forEach(r=>{this._isValidPopupLayerView(r)&&i.push(r)}),H(this.graphicsView)&&this._isValidPopupLayerView(this.graphicsView)&&i.push(this.graphicsView),i.reverse()}_isValidPopupLayerView(i){return H(i)&&(!("layer"in i)||!i.suspended)&&"fetchPopupFeatures"in i}_graphicsPerFetchPopupLayerView(i,r){const n=[],o=new Map,c=r.map(h=>{const m=[];return"layer"in h?o.set(h.layer,m):o.set(h.graphics,m),{layerView:h,graphics:m}});for(const h of i){const m=o.get(h.layer)||o.get(h.sourceLayer)||null;m?m.push(h):n.push(h)}return{layerViewsAndGraphics:c,clientOnlyGraphics:n}}};return t=g([te("esri.views.PopupView")],t),t};let B2=class extends ls(Xe){constructor(e){super(e),this.handles.add([this.on("before-add",t=>{ce(t.item)&&t.preventDefault()}),this.on("after-add",t=>this._own(t.item)),this.on("after-remove",t=>this._release(t.item))])}get owner(){return this._get("owner")}set owner(e){e!==this._get("owner")&&(this._releaseAll(),this._set("owner",e),this._ownAll())}_ownAll(){for(const e of this.items)this._own(e)}_releaseAll(){for(const e of this.items)this._release(e)}_createNewInstance(e){return this.itemType?new(Xe.ofType(this.itemType.Type))(e):new Xe(e)}};function zP(e,t){return{type:e,cast:gB,set(i){const r=D0(i,this._get(t),e);r.owner=this,this._set(t,r)}}}g([w()],B2.prototype,"owner",null),B2=g([te("esri.core.support.OwningCollection")],B2);let QM=class extends B2{constructor(e){super(e),this.handles.add(this.on("before-add",t=>{ce(t.item)||t.item.parent===this.owner&&($e.getLogger(this.declaredClass).warn("Analysis inside the collection must be unique. Not adding this element again."),t.preventDefault())}))}_own(e){e.parent=this.owner}_release(e){e.parent=null}};QM=g([te("esri.support.AnalysesCollection")],QM);let Uy=class extends B2{_own(e){e.layer&&"remove"in e.layer&&e.layer!==this.owner&&e.layer.remove(e),e.layer=this.owner}_release(e){e.layer===this.owner&&(e.layer=null)}};g([FT({Type:Gr,ensureType:Oi(Gr)})],Uy.prototype,"itemType",void 0),Uy=g([te("esri.support.GraphicsCollection")],Uy);let vf=class extends Ye{constructor(e){super(e),this.view=null,this.baseLayerViews=new Xe,this.referenceLayerViews=new Xe,this._loadingHandle=we(()=>{var t,i;return(i=(t=this.view)==null?void 0:t.map)==null?void 0:i.basemap},t=>{t&&t.load().catch(()=>{})},St)}destroy(){this._set("view",null),this._loadingHandle&&(this._loadingHandle.remove(),this._loadingHandle=null)}get suspended(){return!this.view||this.view.suspended}get updating(){var t,i;if(this.view&&this.view.suspended)return!1;const e=(i=(t=this.view)==null?void 0:t.map)==null?void 0:i.basemap;return!!e&&!!e.loaded&&(this.baseLayerViews.some(r=>r.updating)||this.referenceLayerViews.some(r=>r.updating))}};g([w({constructOnly:!0})],vf.prototype,"view",void 0),g([w({readOnly:!0})],vf.prototype,"baseLayerViews",void 0),g([w({readOnly:!0})],vf.prototype,"referenceLayerViews",void 0),g([w({readOnly:!0})],vf.prototype,"suspended",null),g([w({type:Boolean,readOnly:!0})],vf.prototype,"updating",null),vf=g([te("esri.views.BasemapView")],vf);class cke{constructor(t,i,r){this.layer=t,this.view=i,this.layerViewImporter=r,this._controller=new AbortController,this._deferred=fh(),this._started=!1,this.done=!1,Ho(this._controller.signal,()=>{const n=new ue("cancelled:layerview-create","layerview creation cancelled",{layer:t});this._deferred.reject(n)})}get promise(){return this._deferred.promise}destroy(){this._controller.abort();const{layerView:t}=this;if(!t)return;const{layer:i,view:r}=this;i.emit("layerview-destroy",{view:r,layerView:t}),r.emit("layerview-destroy",{layer:i,layerView:t}),this.done=!0,this.layer=null,this.layerView=null,this.view=null,this.layerViewImporter=null}async start(){var n,o;if(this._started)return;this._started=!0;const{_controller:{signal:t},layer:i,view:r}=this;this._map=r.map;try{let c,h;if(await i.load({signal:t}),"prefetchResources"in i&&await i.prefetchResources({signal:t}),i.createLayerView)c=await i.createLayerView(r,{signal:t});else{if(!this.layerViewImporter.hasLayerViewModule(i))throw new ue("layer:view-not-supported","No layerview implementation was found");const x=await this.layerViewImporter.importLayerView(i);ur(t),c="default"in x?new x.default({layer:i,view:r}):new x({layer:i,view:r})}const m=()=>{h=mr(h),c.destroyed||c.destroy(),c.layer=null,c.parent=null,c.view=null,this.done=!0};h=Ho(t,m),ur(t);try{await c.when()}catch(x){throw m(),x}if(!((o=(n=this._map)==null?void 0:n.allLayers)==null?void 0:o.includes(i)))return m(),void this._deferred.reject(new ue("view:no-layerview-for-layer","The layer has been removed from the map",{layer:i}));this.layerView=c,i.emit("layerview-create",{view:r,layerView:c}),r.emit("layerview-create",{layer:i,layerView:c}),this.done=!0,this._deferred.resolve(c)}catch(c){i.emit("layerview-create-error",{view:r,error:c}),r.emit("layerview-create-error",{layer:i,error:c}),this.done=!0,this._deferred.reject(new ue("layerview:create-error","layerview creation failed",{layer:i,error:c}))}}}let xl=class extends Ye{constructor(e){super(e),this._layerLayerViewInfoMap=new Map,this._watchUpdatingTracking=new Bg,this.supportsGround=!0,this._preloadLayerViewModules=()=>{var i;const t=(i=this.view.map)==null?void 0:i.allLayers;if(t)for(const r of t)this.layerViewImporter.hasLayerViewModule(r)&&this.layerViewImporter.importLayerView(r)},this._reschedule=()=>(ce(this._workPromise)&&(this._workPromise=fh(),this._workPromise.promise.catch(()=>{})),this.removeHandles("reschedule"),this.addHandles(eg(this._doWork),"reschedule"),this._workPromise.promise),this._doWork=()=>{var c,h,m;const t=this.view.map;if(this._map!==t&&(this.clear(),this._map=t),ce(this._workPromise))return void this.notifyChange("updating");this.removeHandles("reschedule"),this.removeHandles("collection-change");const i=[],r=b=>{if(!ce(b))for(const x of b)x&&(i.push(x),this._createLayerView(x),"layers"in x&&x.layers&&r(x.layers))};for(const b of this._rootCollectionNames)r(this.get(b));this._refreshCollections();for(const[b,x]of this._layerLayerViewInfoMap)i.includes(b)||(this._layerLayerViewInfoMap.delete(x.layer),x.destroy());const n=i.filter(b=>b.type==="group").map(b=>b.layers),o=[(c=t==null?void 0:t.ground)==null?void 0:c.layers,(h=t==null?void 0:t.basemap)==null?void 0:h.baseLayers,(m=t==null?void 0:t.basemap)==null?void 0:m.referenceLayers,t==null?void 0:t.layers,...n].filter(b=>!!b);this.addHandles(o.map(b=>this._watchUpdatingTracking.addOnCollectionChange(()=>b,this._reschedule)),"collection-change"),this._workPromise.resolve(),this._workPromise=null}}initialize(){this.own([vr(()=>{var e,t;return(t=(e=this.view)==null?void 0:e.map)==null?void 0:t.allLayers},"change",this._preloadLayerViewModules,{onListenerAdd:this._preloadLayerViewModules}),we(()=>{const e=this.view,t=e==null?void 0:e.map;return[t==null?void 0:t.basemap,t==null?void 0:t.ground,t==null?void 0:t.layers,e==null?void 0:e.ready]},()=>this._reschedule(),Gs)]),this._preloadLayerViewModules(),this._reschedule()}destroy(){this.clear(),this._watchUpdatingTracking.destroy(),this._map=null,H(this._workPromise)&&(this._workPromise.reject(Qi()),this._workPromise=null)}get _layersToLayerViews(){const e=[["view.map.basemap.baseLayers","view.basemapView.baseLayerViews"],["view.map.layers","view.layerViews"],["view.map.basemap.referenceLayers","view.basemapView.referenceLayerViews"]];return this.supportsGround&&e.push(["view.map.ground.layers","view.groundView.layerViews"]),new Map(e)}get _rootCollectionNames(){return Array.from(this._layersToLayerViews.keys())}get updating(){return H(this._workPromise)||this._watchUpdatingTracking.updating||Xb(this._layerLayerViewInfoMap,e=>!e.done)}get updatingRemaining(){let e=0;for(const t of this._layerLayerViewInfoMap.values())t.done||++e;return e}clear(){if(!this.destroyed){for(const e of this._layerLayerViewInfoMap.values())e.destroy();this._layerLayerViewInfoMap.clear(),this._refreshCollections()}}async whenLayerView(e){if(await this._reschedule(),!this._layerLayerViewInfoMap.has(e))throw new ue("view:no-layerview-for-layer","No layerview has been found for the layer",{layer:e});return this._layerLayerViewInfoMap.get(e).promise}_refreshCollections(){for(const[e,t]of this._layersToLayerViews)this._populateLayerViewsOwners(this.get(e),this.get(t),this.view);this.notifyChange("updating"),this.notifyChange("updatingRemaining")}_populateLayerViewsOwners(e,t,i){if(!e||!t)return void(t&&t.removeAll());let r=0;for(const n of e){const o=this._layerLayerViewInfoMap.get(n);if(!o||!o.layerView)continue;const c=o.layerView;c.layer=n,c.parent=i,t.getItemAt(r)!==c&&t.splice(r,0,c),n.layers&&this._populateLayerViewsOwners(n.layers,c.layerViews,c),r+=1}r<t.length&&t.splice(r,t.length)}_createLayerView(e){if(this._layerLayerViewInfoMap.has(e))return this.view.ready&&this._layerLayerViewInfoMap.get(e).start(),this.notifyChange("updating"),void this.notifyChange("updatingRemaining");e.load().catch(()=>{}),this.layerViewImporter.hasLayerViewModule(e)&&this.layerViewImporter.importLayerView(e);const t=new cke(e,this.view,this.layerViewImporter);t.promise.then(()=>this._refreshCollections(),i=>{var r,n;i&&(Xn(i)||i.name==="cancelled:layerview-create")||$e.getLogger(this.declaredClass).error(`Failed to create layerview for layer title:'${(r=e.title)!=null?r:"no title"}', id:'${(n=e.id)!=null?n:"no id"}' of type '${e.type}'.`,{layer:e,error:i}),this._refreshCollections()}),this._layerLayerViewInfoMap.set(e,t),this.view.ready&&t.start(),this.notifyChange("updating"),this.notifyChange("updatingRemaining")}};g([w()],xl.prototype,"_workPromise",void 0),g([w({readOnly:!0})],xl.prototype,"_watchUpdatingTracking",void 0),g([w({readOnly:!0})],xl.prototype,"_layersToLayerViews",null),g([w({readOnly:!0})],xl.prototype,"_rootCollectionNames",null),g([w()],xl.prototype,"layerViewImporter",void 0),g([w()],xl.prototype,"supportsGround",void 0),g([w({readOnly:!0})],xl.prototype,"updating",null),g([w({readOnly:!0})],xl.prototype,"updatingRemaining",null),g([w({constructOnly:!0})],xl.prototype,"view",void 0),xl=g([te("esri.views.LayerViewManager")],xl);const uke=xl;let Ja=class extends Ye{constructor(e){super(e),this.factor=1.5,this.offset=yn(0,0),this.position=null,this.size=120,this.maskUrl=null,this.maskEnabled=!0,this.overlayUrl=null,this.overlayEnabled=!0,this.visible=!0}get version(){return this.commitProperty("factor"),this.commitProperty("offset"),this.commitProperty("position"),this.commitProperty("visible"),this.commitProperty("size"),this.commitProperty("maskUrl"),this.commitProperty("maskEnabled"),this.commitProperty("overlayUrl"),this.commitProperty("overlayEnabled"),(this._get("version")||0)+1}};g([w({type:Number})],Ja.prototype,"factor",void 0),g([w({nonNullable:!0})],Ja.prototype,"offset",void 0),g([w()],Ja.prototype,"position",void 0),g([w({type:Number,range:{min:0}})],Ja.prototype,"size",void 0),g([w()],Ja.prototype,"maskUrl",void 0),g([w()],Ja.prototype,"maskEnabled",void 0),g([w()],Ja.prototype,"overlayUrl",void 0),g([w()],Ja.prototype,"overlayEnabled",void 0),g([w({readOnly:!0})],Ja.prototype,"version",null),g([w({type:Boolean})],Ja.prototype,"visible",void 0),Ja=g([te("esri.views.Magnifier")],Ja);const CX=Ja;class hke{constructor(){this._tasks=new Array,this._running=new ZM(!1)}get length(){return this._tasks.length}get running(){return this._running.get()}destroy(){this.cancelAll()}runTask(t){for(;!t.done&&this._process(t);)t.madeProgress()}push(t,i,r){return this._running.set(!0),new Promise((n,o)=>this._tasks.push(new kX(n,o,t,i,r)))}unshift(t,i,r){return this._running.set(!0),new Promise((n,o)=>this._tasks.unshift(new kX(n,o,t,i,r)))}_process(t){var r;if(this._tasks.length===0)return!1;const i=this._tasks.shift();try{const n=ka(i.signal);if(n&&!i.abortCallback)i.reject(Qi());else{const o=n?(r=i.abortCallback)==null?void 0:r.call(i,Qi()):i.callback(t);yh(o)?o.then(i.resolve,i.reject):i.resolve(o)}}catch(n){i.reject(n)}return this._running.set(this._tasks.length>0),!0}cancelAll(){const t=Qi();for(const i of this._tasks)if(i.abortCallback){const r=i.abortCallback(t);i.resolve(r)}else i.reject(t);this._tasks.length=0,this._running.set(!1)}}class kX{constructor(t,i,r,n,o){this.resolve=t,this.reject=i,this.callback=r,this.signal=n,this.abortCallback=o}}let U2=class extends Ye{constructor(){super(...arguments),this.SCHEDULER_LOG_SLOW_TASKS=!1,this.FEATURE_SERVICE_SNAPPING_SOURCE_TILE_TREE_SHOW_TILES=!1}};g([w()],U2.prototype,"SCHEDULER_LOG_SLOW_TASKS",void 0),g([w()],U2.prototype,"FEATURE_SERVICE_SNAPPING_SOURCE_TILE_TREE_SHOW_TILES",void 0),U2=g([te("esri.views.support.DebugFlags")],U2);const pke=new U2;var Za;(function(e){e[e.ANIMATING=0]="ANIMATING",e[e.INTERACTING=1]="INTERACTING",e[e.IDLE=2]="IDLE"})(Za||(Za={}));var vi;(function(e){e.RESOURCE_CONTROLLER="schedule",e.SLIDE="slide",e.STREAM_DATA_LOADER="stream loader",e.ELEVATION_QUERY="elevation query",e.TERRAIN_SURFACE="terrain",e.SURFACE_GEOMETRY_UPDATES="surface geometry updates",e.GRAPHICS_CORE="Graphics3D",e.I3S_CONTROLLER="I3S",e.POINT_CLOUD_LAYER="point cloud",e.FEATURE_TILE_FETCHER="feature fetcher",e.OVERLAY="overlay",e.STAGE="stage",e.GRAPHICS_DECONFLICTOR="graphics deconflictor",e.FILTER_VISIBILITY="Graphics3D filter visibility",e.SCALE_VISIBILITY="Graphics3D scale visibility",e.FRUSTUM_VISIBILITY="Graphics3D frustum visibility",e.POINT_OF_INTEREST_FREQUENT="POI frequent",e.POINT_OF_INTEREST_INFREQUENT="POI infrequent",e.LABELER="labeler",e.FEATURE_QUERY_ENGINE="feature query",e.FEATURE_TILE_TREE="feature tile tree",e.FEATURE_TILE_TREE_ACTIVE="fast feature tile tree",e.ELEVATION_ALIGNMENT="elevation alignment",e.TEXT_TEXTURE_ATLAS="text texture atlas",e.TEXTURE_UNLOAD="texture unload",e.LINE_OF_SIGHT_TOOL="line of sight tool",e.LINE_OF_SIGHT_TOOL_INTERACTIVE="interactive line of sight tool",e.ELEVATION_PROFILE="elevation profile",e.SNAPPING="snapping",e.SHADOW_ACCUMULATOR="shadow accumulator",e.CLOUDS_GENERATOR="cloud generator",e[e.TEST_PRIO=1]="TEST_PRIO"})(vi||(vi={}));const Cu=0,AX=new Map([[vi.RESOURCE_CONTROLLER,Cu],[vi.SLIDE,Cu],[vi.STREAM_DATA_LOADER,Cu],[vi.ELEVATION_QUERY,Cu],[vi.TERRAIN_SURFACE,1],[vi.SURFACE_GEOMETRY_UPDATES,1],[vi.GRAPHICS_CORE,2],[vi.I3S_CONTROLLER,2],[vi.POINT_CLOUD_LAYER,2],[vi.FEATURE_TILE_FETCHER,2],[vi.OVERLAY,4],[vi.STAGE,4],[vi.GRAPHICS_DECONFLICTOR,4],[vi.FILTER_VISIBILITY,4],[vi.SCALE_VISIBILITY,4],[vi.FRUSTUM_VISIBILITY,4],[vi.CLOUDS_GENERATOR,4],[vi.POINT_OF_INTEREST_FREQUENT,6],[vi.POINT_OF_INTEREST_INFREQUENT,30],[vi.LABELER,8],[vi.FEATURE_QUERY_ENGINE,8],[vi.FEATURE_TILE_TREE,16],[vi.FEATURE_TILE_TREE_ACTIVE,Cu],[vi.ELEVATION_ALIGNMENT,12],[vi.TEXT_TEXTURE_ATLAS,12],[vi.TEXTURE_UNLOAD,12],[vi.LINE_OF_SIGHT_TOOL,16],[vi.LINE_OF_SIGHT_TOOL_INTERACTIVE,Cu],[vi.SNAPPING,Cu],[vi.SHADOW_ACCUMULATOR,30]]),GP=32;function PX(e){return AX.has(e)?AX.get(e):typeof e=="number"?e:1}const LX=dn(6.5),OX=dn(1),dke=dn(30),RX=dn(1e3/30),FX=dn(100),NX=.9;var BP,qy;(function(e){class t{constructor(){this._updating=new ZM(!0),this._microTaskQueued=!1,this._frameNumber=0,this.performanceInfo={total:new aw("total"),tasks:new Map},this._frameTaskTimes=new Map,this._budget=new r,this._state=Za.INTERACTING,this._tasks=new ld,this._runQueue=new ld,this._load=0,this._idleStateCallbacks=new ld,this._idleUpdatesStartFired=!1,this._maxReschedule=GP,this._forceTask=!1,this._debug=!1,this._debugHandle=we(()=>pke.SCHEDULER_LOG_SLOW_TASKS,c=>this._debug=c,St);for(const c of Object.keys(vi))this.performanceInfo.tasks.set(vi[c],new aw(vi[c]));const o=this;this._test={FRAME_SAFETY_BUDGET:LX,INTERACTING_BUDGET:RX,IDLE_BUDGET:FX,get availableBudget(){return o._budget.budget},usedBudget:0,getBudget:()=>o._budget,setBudget:c=>o._budget=c,updateTask:c=>this._updateTask(c),getState:c=>this._getState(c),getRuntime:c=>this._getRuntime(c),frameTaskTimes:this._frameTaskTimes,resetRuntimes:()=>this._resetRuntimes(),getRunning:()=>this._getRunning()}}get updating(){return this._updating.get()}set updating(o){this._updating.set(o)}destroy(){this._tasks.toArray().forEach(o=>o.remove()),this._tasks.clear(),mr(this._debugHandle),this._microTaskQueued=!1,this._updating.set(!1)}activate(){this._budget.done||this._microTaskQueued||(this._microTaskQueued=!0,queueMicrotask(()=>{this._microTaskQueued&&(this._microTaskQueued=!1,this._budget.done||(this._maxReschedule=GP,this._schedule(),this.frame()))}))}registerTask(o,c){const h=PX(o),m=new i(this,o,c,h);return this._tasks.push(m),this.performanceInfo.tasks.has(o)||this.performanceInfo.tasks.set(o,new aw(o)),m}registerIdleStateCallbacks(o,c){const h={idleBegin:o,idleEnd:c};this._idleStateCallbacks.push(h),this.state===Za.IDLE&&this._idleUpdatesStartFired&&h.idleBegin();const m=this;return{remove:()=>this._removeIdleStateCallbacks(h),set idleBegin(b){m._idleUpdatesStartFired&&(h.idleEnd(),m._state===Za.IDLE&&b()),h.idleBegin=b},set idleEnd(b){h.idleEnd=b}}}get load(){return this._load}set state(o){this._state!==o&&(this._state=o,this.state!==Za.IDLE&&this._idleUpdatesStartFired&&(this._idleUpdatesStartFired=!1,this._idleStateCallbacks.forAll(c=>c.idleEnd())))}get state(){return this._state}updateBudget(o){this._test.usedBudget=0,++this._frameNumber;let c=LX,h=o.frameDuration,m=OX;switch(this.state){case Za.IDLE:c=dn(0),h=dn(Math.max(FX,o.frameDuration)),m=dke;break;case Za.INTERACTING:h=dn(Math.max(RX,o.frameDuration));case Za.ANIMATING:}return h=dn(h-o.elapsedFrameTime-c),this.state!==Za.IDLE&&h<OX&&!this._forceTask?(this._forceTask=!0,!1):(h=dn(Math.max(h,m)),this._budget.reset(h,this.state),this._maxReschedule=GP,this._updateLoad(),this._schedule())}frame(){switch(this._forceTask=!1,this._microTaskQueued=!1,this.state){case Za.IDLE:this._idleUpdatesStartFired||(this._idleUpdatesStartFired=!0,this._idleStateCallbacks.forAll(o=>o.idleBegin())),this._runIdle();break;case Za.INTERACTING:this._runInteracting();break;default:this._runAnimating()}this._test.usedBudget=this._budget.elapsed}stopFrame(){this._budget.reset(dn(0),this._state),this._budget.madeProgress()}_removeIdleStateCallbacks(o){this._idleUpdatesStartFired&&o.idleEnd(),this._idleStateCallbacks.removeUnordered(o)}removeTask(o){this._tasks.removeUnordered(o),this._runQueue.removeUnordered(o)}_updateTask(o){this._tasks.forAll(c=>{c.name===o&&c.setPriority(o)})}_getState(o){if(this._runQueue.some(h=>h.name===o))return qy.SCHEDULED;let c=qy.IDLE;return this._tasks.forAll(h=>{h.name===o&&h.needsUpdate&&(h.schedulePriority<=1?c=qy.READY:c!==qy.READY&&(c=qy.WAITING))}),c}_getRuntime(o){let c=0;return this._tasks.forAll(h=>{h.name===o&&(c+=h.runtime)}),c}_resetRuntimes(){this._tasks.forAll(o=>o.runtime=0)}_getRunning(){const o=new Map;if(this._tasks.forAll(h=>{h.needsUpdate&&o.set(h.name,(o.get(h.name)||0)+1)}),o.size===0)return null;let c="";return o.forEach((h,m)=>{c+=h>1?` ${h}x ${m}`:` ${m}`}),c}_runIdle(){this._run()}_runInteracting(){this._run()}_runAnimating(){this._run()}_updateLoad(){const o=this._tasks.reduce((c,h)=>h.needsUpdate?++c:c,0);this._load=this._load*NX+o*(1-NX)}_schedule(){if(this._maxReschedule<=0)return!1;for(this._runQueue.filterInPlace(o=>!!o.needsUpdate||(o.schedulePriority=o.basePriority,!1)),this._tasks.forAll(o=>{o.basePriority===Cu&&o.needsUpdate&&!this._runQueue.includes(o)&&this._runQueue.unshift(o)});this._runQueue.length===0;){let o=!1,c=0;if(this._tasks.forAll(h=>{h.needsUpdate&&h.schedulePriority!==0&&h.basePriority!==Cu&&(!h.task.runOncePerFrame||h.lastFrameRun!==this._frameNumber)&&(o=!0,c=Math.max(c,h.basePriority),h.schedulePriority===1?(h.schedulePriority=0,this._runQueue.push(h)):--h.schedulePriority)}),!o)return this._updating.set(!1),!1;--this._maxReschedule}return this._updating.set(!0),!0}_run(){const o=this._budget.now();this._startFrameTaskTimes();do for(;this._runQueue.length>0;){const c=this._budget.now(),h=this._runQueue.pop();this._budget.resetProgress();try{h.task.runTask(this._budget)}catch(b){$e.getLogger("esri.views.support.Scheduler").error(`Exception in task "${h.name}"`,b)}h.schedulePriority=h.basePriority,h.lastFrameRun=this._frameNumber;const m=this._budget.now()-c;if(h.runtime+=m,this._frameTaskTimes.set(h.priority,this._frameTaskTimes.get(h.priority)+m),this._debug&&this._budget.elapsed>2*this._budget.budget&&console.log("Task",h.name,"used",this._budget.elapsed,"of max",this._budget.budget,"ms"),this._budget.remaining<=0)return this._updating.set(this._tasks.some(b=>b.needsUpdate)),void this._recordFrameTaskTimes(this._budget.now()-o)}while(this._schedule());this._updating.set(this._tasks.some(c=>c.needsUpdate)),this._recordFrameTaskTimes(this._budget.now()-o)}_startFrameTaskTimes(){for(const o of Object.keys(vi))this._frameTaskTimes.set(vi[o],0)}_recordFrameTaskTimes(o){this._frameTaskTimes.forEach((c,h)=>this.performanceInfo.tasks.get(h).record(c)),this.performanceInfo.total.record(o)}get test(){return this._test}}e.Scheduler=t;class i{constructor(o,c,h,m){this._scheduler=o,this.name=c,this._basePriority=m,this.lastFrameRun=0,this.runtime=0,this._queue=new hke,this._handles=new Ti,this.schedulePriority=this._basePriority,this._task=new ZM(H(h)?h:this._queue),this._handles.add(os(()=>this.task.running,()=>o.activate()))}get task(){return this._task.get()}get updating(){return this._queue.running}remove(){this.processQueue(DX),this._scheduler.removeTask(this),this.schedule=q2.schedule,this.reschedule=q2.reschedule,this._handles.destroy()}get basePriority(){return this._basePriority}setPriority(o){this.name=o;const c=PX(o);this._basePriority!==Cu&&this.schedulePriority===0||(this.schedulePriority=c),this._basePriority=c}get priority(){return this.name}set priority(o){this.setPriority(o)}get needsUpdate(){return this.updating||this.task.running}schedule(o,c,h){return this._queue.push(o,c,h)}reschedule(o,c,h){return this._queue.unshift(o,c,h)}processQueue(o){this._queue.runTask(o)}}class r{constructor(){this._begin=typeof performance!="undefined"?performance.now():0,this._budget=0,this._state=Za.IDLE,this._done=!1,this._enabled=!0}run(o){return!this.done&&(o()===!0&&this.madeProgress(),!0)}get done(){return this._done}get budget(){return this._budget}madeProgress(){this._done=this.elapsed>=this._budget&&this._enabled}get state(){return this._state}get enabled(){return this._enabled}set enabled(o){this._enabled=o}reset(o,c){this._begin=this.now(),this._budget=o,this._state=c,this._done=!1}get remaining(){return Math.max(this._budget-this.elapsed,0)}now(){return performance.now()}get elapsed(){return performance.now()-this._begin}resetProgress(){this._done=!1}get hasProgressed(){return this._done}}e.Budget=r})(BP||(BP={})),function(e){e.SCHEDULED="s",e.READY="r",e.WAITING="w",e.IDLE="i"}(qy||(qy={}));const DX=(()=>{const e=new BP.Budget;return e.enabled=!1,e})();class fke{remove(){}processQueue(){}schedule(t,i,r){try{if(ka(i)){const n=Qi();return r?Promise.resolve(r(n)):Promise.reject(n)}return pT(t(DX))}catch(n){return Promise.reject(n)}}reschedule(t,i,r){return this.schedule(t,i,r)}}const q2=new fke;let H2=class extends Ye{constructor(e,t){var i;super({}),this._stage=e,this._textureRequests=new Map,this._frameTask=(i=t==null?void 0:t.registerTask(vi.TEXTURE_UNLOAD))!=null?i:q2}normalizeCtorArgs(){return{}}destroy(){super.destroy(),this._frameTask.remove(),this._textureRequests.forEach(e=>this._releaseTextureRequest(e)),this._textureRequests.clear()}get updating(){return this._frameTask.updating}fromData(e,t,i){const r=this.makeUid(e);let n=this._textureRequests.get(r);return n||(n={referenceCount:0,texture:t(),textureAsync:null,abortController:null,onRemove:i},this._stage&&(this._stage.add(n.texture),this._stage.loadImmediate(n.texture)),this._textureRequests.set(r,n)),n.referenceCount++,{uid:r,texture:n.texture,release:()=>this._release(r)}}_release(e){const t=this._textureRequests.get(e);t?(t.referenceCount<1&&console.warn("TextureCollection: reference count is < 1 for "+e),t.referenceCount--,t.referenceCount<1&&this._frameTask.schedule(()=>this._releaseNow(e))):console.warn(`TextureCollection: texture doesn't exist: '${e}'`)}get test(){return{textureRequests:this._textureRequests}}_releaseNow(e){if(!this._textureRequests)return;const t=this._textureRequests.get(e);!t||t.referenceCount>0||(this._releaseTextureRequest(t),this._textureRequests.delete(e))}_releaseTextureRequest(e){var t;e.onRemove&&e.onRemove(),e.texture?(t=this._stage)==null||t.remove(e.texture):e.abortController&&(e.abortController.abort(),e.abortController=null)}makeUid(e,t=null){return H(t)?`${e}.${t}px`:e}};g([w()],H2.prototype,"_frameTask",void 0),g([w()],H2.prototype,"updating",null),H2=g([te("esri.views.3d.support.TextureCollection")],H2);var jX;(function(e){e[e.Left=0]="Left",e[e.Middle=1]="Middle",e[e.Right=2]="Right"})(jX||(jX={}));const VX=["click","double-click","immediate-click","immediate-double-click","hold","drag","key-down","key-up","pointer-down","pointer-move","pointer-up","pointer-drag","mouse-wheel","pointer-enter","pointer-leave","gamepad","focus","blur"],zX={};function GX(e){return!!zX[e]}function yke(e){for(const t of e)if(!GX(t))return!1;return!0}VX.forEach(e=>{zX[e]=!0});class mke{constructor(t){this._handlers=new Map,this._counter=0,this._handlerCounts=new Map,this.view=t,this.inputManager=null}connect(t){t&&this.disconnect(),this.inputManager=t,this._handlers.forEach(({handler:i,priority:r},n)=>this.inputManager.installHandlers(n,[i],r))}disconnect(){this.inputManager&&this._handlers.forEach((t,i)=>this.inputManager.uninstallHandlers(i)),this.inputManager=null}destroy(){this.disconnect(),this._handlers.clear(),this.view=null}on(t,i,r,n){const o=Array.isArray(t)?t:t.split(",");if(!yke(o))return o.some(GX)&&console.error("Error: registering input events and other events on the view at the same time is not supported."),null;let c,h;Array.isArray(i)?h=i:(c=i,h=[]),typeof r=="function"?c=r:n=r,n=n!=null?n:ft.DEFAULT;const m=this._createUniqueGroupName(),b=new gke(this.view,o,h,c);this._handlers.set(m,{handler:b,priority:n});for(const x of o){const I=this._handlerCounts.get(x)||0;this._handlerCounts.set(x,I+1)}return this.inputManager&&this.inputManager.installHandlers(m,[b],n),{remove:()=>this._removeHandler(m,o)}}hasHandler(t){return!!this._handlerCounts.get(t)}_removeHandler(t,i){if(this._handlers.has(t)){this._handlers.delete(t);for(const r of i){const n=this._handlerCounts.get(r);n===void 0?console.error("Trying to remove handler for event that has no handlers registered: ",r):n===1?this._handlerCounts.delete(r):this._handlerCounts.set(r,n-1)}}this.inputManager&&this.inputManager.uninstallHandlers(t)}_createUniqueGroupName(){return this._counter+=1,`viewEvents_${this._counter}`}}class gke extends ds{constructor(t,i,r,n){super(!0),this.view=t;for(const o of i)switch(o){case"click":this.registerIncoming("click",r,c=>n(this._wrapClick(c)));break;case"double-click":this.registerIncoming("double-click",r,c=>n(this._wrapDoubleClick(c)));break;case"immediate-click":this.registerIncoming("immediate-click",r,c=>n(this._wrapImmediateClick(c)));break;case"immediate-double-click":this.registerIncoming("immediate-double-click",r,c=>n(this._wrapImmediateDoubleClick(c)));break;case"hold":this.registerIncoming("hold",r,c=>n(this._wrapHold(c)));break;case"drag":this.registerIncoming("drag",r,c=>{const h=this._wrapDrag(c);h&&n(h)});break;case"key-down":this.registerIncoming("key-down",r,c=>n(this._wrapKeyDown(c)));break;case"key-up":this.registerIncoming("key-up",r,c=>n(this._wrapKeyUp(c)));break;case"pointer-down":this.registerIncoming("pointer-down",r,c=>n(this._wrapPointer(c,"pointer-down")));break;case"pointer-move":this.registerIncoming("pointer-move",r,c=>n(this._wrapPointer(c,"pointer-move")));break;case"pointer-up":this.registerIncoming("pointer-up",r,c=>n(this._wrapPointer(c,"pointer-up")));break;case"pointer-drag":this.registerIncoming("pointer-drag",r,c=>n(this._wrapPointerDrag(c)));break;case"mouse-wheel":this.registerIncoming("mouse-wheel",r,c=>n(this._wrapMouseWheel(c)));break;case"pointer-enter":this.registerIncoming("pointer-enter",r,c=>n(this._wrapPointer(c,"pointer-enter")));break;case"pointer-leave":this.registerIncoming("pointer-leave",r,c=>n(this._wrapPointer(c,"pointer-leave")));break;case"gamepad":this.registerIncoming("gamepad",r,c=>{n(this._wrapGamepad(c))});break;case"focus":this.registerIncoming("focus",r,c=>{n(this._wrapFocus(c))});break;case"blur":this.registerIncoming("blur",r,c=>{n(this._wrapBlur(c))})}}_wrapFocus(t){return{type:"focus",timestamp:t.timestamp,native:t.data.native,cancelable:t.cancelable,stopPropagation:()=>t.stopPropagation(),async:i=>t.async(i),preventDefault:()=>t.preventDefault()}}_wrapBlur(t){return{type:"blur",timestamp:t.timestamp,native:t.data.native,cancelable:t.cancelable,stopPropagation:()=>t.stopPropagation(),async:i=>t.async(i),preventDefault:()=>t.preventDefault()}}_wrapClick(t){const{pointerType:i,button:r,buttons:n,x:o,y:c,native:h,eventId:m}=t.data,{cancelable:b,timestamp:x}=t;return{type:"click",pointerType:i,button:r,buttons:n,x:o,y:c,native:h,timestamp:x,screenPoint:yn(o,c),mapPoint:this._getMapPoint(o,c),eventId:m,cancelable:b,stopPropagation:()=>t.stopPropagation(),async:I=>t.async(I),preventDefault:()=>t.preventDefault()}}_wrapDoubleClick(t){const{pointerType:i,button:r,buttons:n,x:o,y:c,native:h,eventId:m}=t.data,{cancelable:b,timestamp:x}=t;return{type:"double-click",pointerType:i,button:r,buttons:n,x:o,y:c,native:h,timestamp:x,mapPoint:this._getMapPoint(o,c),eventId:m,cancelable:b,stopPropagation:()=>t.stopPropagation(),async:I=>t.async(I),preventDefault:()=>t.preventDefault()}}_wrapImmediateClick(t){const{pointerType:i,button:r,buttons:n,x:o,y:c,native:h,eventId:m}=t.data,b=h.pointerId,{cancelable:x,timestamp:I}=t;return{type:"immediate-click",pointerId:b,pointerType:i,button:r,buttons:n,x:o,y:c,native:h,timestamp:I,mapPoint:this._getMapPoint(o,c),eventId:m,cancelable:x,stopPropagation:()=>t.stopPropagation(),async:E=>t.async(E),preventDefault:()=>t.preventDefault()}}_wrapImmediateDoubleClick(t){const{pointerType:i,button:r,buttons:n,x:o,y:c,native:h,eventId:m}=t.data,b=h.pointerId,{cancelable:x,timestamp:I}=t;return{type:"immediate-double-click",pointerId:b,pointerType:i,button:r,buttons:n,x:o,y:c,native:h,timestamp:I,mapPoint:this._getMapPoint(o,c),eventId:m,cancelable:x,stopPropagation:()=>t.stopPropagation(),async:E=>t.async(E),preventDefault:()=>t.preventDefault()}}_wrapHold(t){const{pointerType:i,button:r,buttons:n,x:o,y:c,native:h}=t.data,{cancelable:m,timestamp:b}=t;return{type:"hold",pointerType:i,button:r,buttons:n,x:o,y:c,native:h,timestamp:b,mapPoint:this._getMapPoint(o,c),cancelable:m,stopPropagation:()=>t.stopPropagation(),async:x=>t.async(x),preventDefault:()=>t.preventDefault()}}_getMapPoint(t,i){return this.view.toMap(yn(t,i),{exclude:[]})}_wrapDrag(t){const i=t.data,{x:r,y:n}=i.center,{action:o,pointerType:c,button:h}=i;if(o==="start"&&(this._latestDragStart=i),!this._latestDragStart)return;const m=i.pointer.native,b=i.buttons,{cancelable:x,timestamp:I}=t,E={x:this._latestDragStart.center.x,y:this._latestDragStart.center.y};return o==="end"&&(this._latestDragStart=void 0),{type:"drag",action:o,x:r,y:n,origin:E,pointerType:c,button:h,buttons:b,radius:i.radius,angle:N6(i.angle),native:m,timestamp:I,cancelable:x,stopPropagation:()=>t.stopPropagation(),async:k=>t.async(k),preventDefault:()=>t.preventDefault()}}_wrapKeyDown(t){const{key:i,repeat:r,native:n}=t.data,{cancelable:o,timestamp:c}=t;return{type:"key-down",key:i,repeat:r,native:n,timestamp:c,cancelable:o,stopPropagation:()=>t.stopPropagation(),async:h=>t.async(h),preventDefault:()=>t.preventDefault()}}_wrapKeyUp(t){const{key:i,native:r}=t.data,{cancelable:n,timestamp:o}=t;return{type:"key-up",key:i,native:r,timestamp:o,cancelable:n,stopPropagation:()=>t.stopPropagation(),async:c=>t.async(c),preventDefault:()=>t.preventDefault()}}_wrapPointer(t,i){const{x:r,y:n,button:o,buttons:c,native:h,eventId:m}=t.data,b=h.pointerId,x=h.pointerType,{cancelable:I,timestamp:E}=t;return{type:i,x:r,y:n,pointerId:b,pointerType:x,button:o,buttons:c,native:h,timestamp:E,eventId:m,cancelable:I,stopPropagation:()=>t.stopPropagation(),async:k=>t.async(k),preventDefault:()=>t.preventDefault()}}_wrapPointerDrag(t){const{x:i,y:r,buttons:n,native:o,eventId:c}=t.data.currentEvent,{button:h}=t.data.startEvent,m=t.data.startEvent.native.pointerId,b=t.data.startEvent.native.pointerType,x=t.data.action,I={x:t.data.startEvent.x,y:t.data.startEvent.y},{cancelable:E,timestamp:k}=t;return{type:"pointer-drag",x:i,y:r,pointerId:m,pointerType:b,button:h,buttons:n,action:x,origin:I,native:o,timestamp:k,eventId:c,cancelable:E,stopPropagation:()=>t.stopPropagation(),async:P=>t.async(P),preventDefault:()=>t.preventDefault()}}_wrapMouseWheel(t){const{cancelable:i,data:r,timestamp:n}=t,{x:o,y:c,deltaY:h,native:m}=r;return{type:"mouse-wheel",x:o,y:c,deltaY:h,native:m,timestamp:n,cancelable:i,stopPropagation:()=>t.stopPropagation(),async:b=>t.async(b),preventDefault:()=>t.preventDefault()}}_wrapGamepad(t){const{action:i,state:r,device:n}=t.data,{cancelable:o,timestamp:c}=t,{buttons:h,axes:m}=r;return{type:"gamepad",device:n,timestamp:c,action:i,buttons:h,axes:m,cancelable:o,stopPropagation:()=>t.stopPropagation(),async:b=>t.async(b),preventDefault:()=>t.preventDefault()}}}var Sl,BX,UX;(function(e){e[e.USER=0]="USER",e[e.MANAGER=1]="MANAGER"})(Sl||(Sl={})),function(e){e[e.None=0]="None",e[e.Unfocused=1]="Unfocused",e[e.Focused=2]="Focused",e[e.Unselected=4]="Unselected",e[e.Selected=8]="Selected",e[e.All=15]="All"}(BX||(BX={})),function(e){e[e.None=0]="None",e[e.Custom1=16]="Custom1",e[e.Custom2=32]="Custom2",e[e.Custom3=64]="Custom3",e[e.Custom4=128]="Custom4",e[e.Custom5=256]="Custom5",e[e.Custom6=512]="Custom6",e[e.Custom7=1024]="Custom7",e[e.Custom8=2048]="Custom8",e[e.Custom9=4096]="Custom9",e[e.Custom10=8192]="Custom10",e[e.Custom11=16384]="Custom11",e[e.Custom12=32768]="Custom12",e[e.All=65520]="All"}(UX||(UX={}));function vke(e){return[e.on("before-add",t=>{const i=t.item;if(i==null||e.includes(i))return $e.getLogger("esri.views.interactive.interactiveToolUtils").warn("Tool is either already in the list of tools or tool is `null`. Not adding tool."),void t.preventDefault();i.onAdd()}),e.on("after-remove",t=>{const i=t.item;i.active&&(i.view.activeTool=null),i.destroy()})]}function UP(e){return e.visible&&e.getEditableFlag(Sl.USER)&&e.getEditableFlag(Sl.MANAGER)}function pr(e){return yn(e.x,e.y)}function qX(e,t){const i=(e instanceof HTMLElement?e:e.surface).getBoundingClientRect();return yn(t.clientX-i.left,t.clientY-i.top)}function HX(e,t){return t instanceof Event?qX(e,t):pr(t)}function WX(e){if(e instanceof Event)return!0;if(typeof e=="object"&&"type"in e)switch(e.type){case"click":case"double-click":case"pointer-down":case"pointer-drag":case"pointer-enter":case"pointer-leave":case"pointer-up":case"pointer-move":case"immediate-click":case"immediate-double-click":case"hold":case"drag":case"mouse-wheel":return!0;default:return!1}return!1}class bke{constructor(){this._pointerLocations=new Map,this._hoveredManipulators=new Map,this._grabbedManipulators=new Map,this._draggedManipulators=new Map,this._stopDrag=!1,this._revertToNullActiveTool=!1,this._cursor=null}get cursor(){return this._cursor}handleInputEvent(t,i){const r=()=>t.stopPropagation();switch(t.type){case"pointer-move":JX(t.pointerType)&&this._pointerLocations.set(t.pointerId,{x:t.x,y:t.y,pointerType:t.pointerType});break;case"drag":this._grabbedManipulators.size>0&&(this._stopDrag=!0),this._stopDrag&&(r(),t.action==="end"&&(this._stopDrag=!1));break;case"pointer-down":{if(!ZX(t))break;const n=pr(t),o=this._intersect(n,t.pointerType,i.forEachTool);if(ce(o))break;const c=o.manipulator,h=o.tool;!(H(c)&&H(h)&&c.interactive)||c.grabbable&&c.grabbableForEvent(t)||!c.grabbing||c.dragging||this._ungrabManipulatorBeforeDragging(c,t,i),H(c)&&H(h)&&c.interactive&&c.grabbable&&c.grabbableForEvent(t)&&!c.grabbing&&(this._grabbedManipulators.set(t.pointerId,{manipulator:c,tool:h,start:n,pointerType:t.pointerType}),this._grabbedManipulators.size===1&&ce(i.activeTool)&&(this._revertToNullActiveTool=!0,i.setActiveTool(o.tool)),c.grabbing=!0,c.events.emit("grab-changed",{action:"start",pointerType:t.pointerType,screenPoint:n}),r());break}case"pointer-up":this._draggedManipulators.has(t.pointerId)||this._handlePointerEnd(t,i);break;case"pointer-drag":{if(!ZX(t))break;const n=this._grabbedManipulators.get(t.pointerId),o=ch(n,({manipulator:x})=>x),c=ch(n,({tool:x})=>x);if(ce(o)||ce(c))break;const h=pr(t);h.x=Vs(h.x,0,i.view.width),h.y=Vs(h.y,0,i.view.height);const m=Ht(n).start,b=this._draggedManipulators.get(t.pointerId);switch(t.action){case"start":case"update":t.action!=="update"&&this._grabbedManipulators.size!==1||(o.dragging=!0,b?o.events.emit("drag",{action:"update",start:m,screenPoint:h}):o.events.emit("drag",{action:"start",start:m,screenPoint:h,pointerType:t.pointerType}),this._draggedManipulators.set(t.pointerId,{tool:c,manipulator:o,start:m}));break;case"end":o.dragging=!1,b&&o.events.emit("drag",{action:"end",start:m,screenPoint:h}),this._draggedManipulators.delete(t.pointerId),this._handlePointerEnd(t,i)}r();break}case"immediate-click":{const n=pr(t),o=this._intersect(n,t.pointerType,i.forEachTool);if(wke(t)||i.forEachTool(b=>{if((!H(o)||o.tool!==b||b.automaticManipulatorSelection)&&b.manipulators){let x=!1;b.manipulators.forEach(({manipulator:I})=>{I.selected&&(I.selected=!1,x=!0)}),x&&b.onManipulatorSelectionChanged&&b.onManipulatorSelectionChanged()}}),ce(o))break;const{manipulator:c,tool:h}=o;if(!c.interactive)break;c.selectable&&h.automaticManipulatorSelection&&(c.selected=!c.selected,h.onManipulatorSelectionChanged&&h.onManipulatorSelectionChanged());const m=t.native.shiftKey;c.events.emit("immediate-click",{screenPoint:n,button:t.button,pointerType:t.pointerType,shiftKey:m,stopPropagation:r});break}case"click":{const n=pr(t),o=this._intersect(n,t.pointerType,i.forEachTool),c=H(o)?o.manipulator:null;if(ce(c)||!c.interactive)break;const h=t.native.shiftKey;c.events.emit(t.type,{screenPoint:n,button:t.button,pointerType:t.pointerType,shiftKey:h}),r();break}case"double-click":{const n=pr(t),o=this._intersect(n,t.pointerType,i.forEachTool),c=H(o)?o.manipulator:null;if(ce(c)||!c.interactive)break;const h=t.native.shiftKey;c.events.emit("double-click",{screenPoint:n,button:t.button,pointerType:t.pointerType,shiftKey:h,stopPropagation:r});break}case"immediate-double-click":{const n=pr(t),o=this._intersect(n,t.pointerType,i.forEachTool),c=H(o)?o.manipulator:null;if(ce(c)||!c.interactive)break;const h=t.native.shiftKey;c.events.emit("immediate-double-click",{screenPoint:n,button:t.button,pointerType:t.pointerType,shiftKey:h,stopPropagation:r});break}}this._onFocusChange(i.forEachTool)}_ungrabManipulatorBeforeDragging(t,i,r){t.grabbing=!1,t.events.emit("grab-changed",{action:"end",pointerType:i.pointerType,screenPoint:pr(i)}),this._grabbedManipulators.forEach(({manipulator:n},o)=>{n===t&&this._grabbedManipulators.delete(o)}),this._afterManipulatorUngrab(r.setActiveTool)}_handlePointerEnd(t,i){const r=ch(this._grabbedManipulators.get(t.pointerId),({manipulator:n})=>n);ce(r)||r.grabbing&&(r.grabbing=!1,r.events.emit("grab-changed",{action:"end",pointerType:t.pointerType,screenPoint:pr(t)}),this._grabbedManipulators.delete(t.pointerId),this._afterManipulatorUngrab(i.setActiveTool))}_cursorFromMap(t){let i=null;return Xb(t,({manipulator:r})=>!(ce(r)||!r.interactive)&&(r.grabbing&&r.grabCursor?(i=r.grabCursor,!0):!!r.cursor&&(i=r.cursor,!0))),i}_onFocusChange(t){this._updateCursor(),this._updateFocusedManipulatorTools(t)}_updateCursor(){this._grabbedManipulators.size>0?this._cursor=this._cursorFromMap(this._grabbedManipulators)||"grabbing":this._hoveredManipulators.size>0?this._cursor=this._cursorFromMap(this._hoveredManipulators)||"pointer":this._cursor=null}_updateFocusedManipulatorTools(t){const i=new Set,r=new Set;this._grabbedManipulators.forEach(({tool:n})=>{i.add(n)}),this._hoveredManipulators.forEach(({tool:n})=>{r.add(n)}),t(n=>{n.hasGrabbedManipulators=i.has(n),n.hasHoveredManipulators=r.has(n);const o=this._grabbedManipulators.values(),c=Aye(o,({tool:h})=>h===n);n.firstGrabbedManipulator=H(c)?c.manipulator:null})}clearPointers(t,{forEachTool:i,setActiveTool:r},n=!0,o){const c=(h,m)=>h===t&&(ce(o)||o===m);this._grabbedManipulators.forEach(({tool:h,manipulator:m,pointerType:b},x)=>{c(h,m)&&(this._grabbedManipulators.delete(x),m.grabbing=!1,m.events.emit("grab-changed",{action:"end",screenPoint:null,pointerType:b}))}),this._draggedManipulators.forEach(({tool:h,manipulator:m},b)=>{c(h,m)&&(this._draggedManipulators.delete(b),m.dragging=!1,m.events.emit("drag",{action:"cancel"}))}),n&&this._hoveredManipulators.forEach(({tool:h,manipulator:m},b)=>{c(h,m)&&(this._hoveredManipulators.delete(b),m.hovering=!1)}),this._afterManipulatorUngrab(r),this._onFocusChange(i)}_intersect(t,i,r){let n=null;return r(o=>{if(o.manipulators==null||!UP(o))return!1;const c=o.manipulators.intersect(t,i);return!ce(c)&&(n={tool:o,manipulator:c},!0)}),n}updateHoveredStateFromKnownPointers(t){this._pointerLocations.forEach((i,r)=>{this._updateHoveredStateForPointerAtScreenPosition(yn(i.x,i.y),r,i.pointerType,t)})}handleHoverEvent(t,i){t.type!=="pointer-up"&&t.type!=="immediate-click"&&t.type!=="pointer-move"||!JX(t.pointerType)||this._updateHoveredStateForPointerAtScreenPosition(pr(t),t.pointerId,t.pointerType,i)}_updateHoveredStateForPointerAtScreenPosition(t,i,r,n){let o=this._intersect(t,r,n);const c=ch(this._hoveredManipulators.get(i),({manipulator:h})=>h);H(o)&&!o.manipulator.interactive&&(o=null),H(o)&&c===o.manipulator||(H(c)&&(c.hovering=!1),H(o)?(o.manipulator.hovering=!0,this._hoveredManipulators.set(i,o)):this._hoveredManipulators.delete(i),this._onFocusChange(n))}_afterManipulatorUngrab(t){this._grabbedManipulators.size===0&&this._revertToNullActiveTool&&(t(null),this._revertToNullActiveTool=!1)}}function JX(e){return e==="mouse"}function ZX(e){return e.pointerType!=="mouse"||e.button===0}function wke(e){return!!e.native.shiftKey}const KX="attached",qP="tools";let ip=class extends dy{constructor(e){super(e),this._manipulatorState=new bke,this.tools=new Xe,this.cursor=null,this._forEachTool=t=>{for(const i of this.tools.items)if(t(i))return}}initialize(){this.handles.add([this.view.on(VX,e=>{this._handleInputEvent(e)},ft.TOOL),...vke(this.tools),this.tools.on("before-add",({item:e})=>{this._updateToolEditableFlag(e)}),this.tools.on("before-remove",({item:e})=>{this._manipulatorState.clearPointers(e,this._manipulatorStateEventArgs),this._updateCursor()}),this.tools.on("change",()=>{this._refreshToolWatchers()})])}destroy(){this.detach(),this.handles.removeAll()}get _manipulatorStateEventArgs(){return{forEachTool:this._forEachTool,activeTool:this.activeTool,setActiveTool:e=>{this.activeTool=e},view:this.view}}set activeTool(e){if(H(e)&&!this.view.ready)return void $e.getLogger(this.declaredClass).error("Cannot set active tool while view is not ready.");if(e===this.activeTool)return;const t=this.activeTool;this._set("activeTool",e),H(t)&&t.deactivate(),H(e)&&e.activate(),this._removeIncompleteTools(e);for(const i of this.tools){this._updateToolEditableFlag(i);const r=UP(i);!ce(this.activeTool)&&r||this._manipulatorState.clearPointers(i,this._manipulatorStateEventArgs,!r)}this._updateCursor()}get updating(){var e,t;return this.updatingHandles.updating||this.tools.some(i=>i.updating)||((t=(e=this.textures)==null?void 0:e.updating)!=null?t:!1)}attach(){this.view.type==="3d"?(this._set("textures",new H2(this.view._stage,this.view.resourceController.scheduler)),this.handles.add([we(()=>{const{state:e}=this.view;return"camera"in e&&e.camera},()=>{this._forEachManipulator(e=>{e.onViewChange!=null&&e.onViewChange()})}),this.view.elevationProvider.on("elevation-change",e=>{this._forEachManipulator(t=>{t.onElevationChange!=null&&t.onElevationChange(e)})}),uh(()=>this._set("textures",li(this.textures)))],KX)):this.handles.add(we(()=>this.view.extent,()=>{this._forEachManipulator(e=>{e.onViewChange!=null&&e.onViewChange()})}))}detach(){H(this.activeTool)&&(this.activeTool=null),this.tools.removeAll(),this.handles.remove(KX)}_forEachManipulator(e){this._forEachTool(t=>{t.manipulators&&t.manipulators.forEach(({manipulator:i})=>e(i,t))})}_handleInputEvent(e){let t=!1;const i=Ce(K({},e),{stopPropagation:()=>{t=!0,e.stopPropagation()}});H(this.activeTool)?this.activeTool.handleInputEvent&&this.activeTool.handleInputEvent(i):this._forEachTool(r=>{!t&&r.visible&&r.handleInputEvent(i)}),!t&&e.type==="key-down"&&e.key==="Escape"&&this.activeTool&&(e.stopPropagation(),this.activeTool=null),this._manipulatorState.handleInputEvent(i,this._manipulatorStateEventArgs),!t&&H(this.activeTool)&&this.activeTool.handleInputEventAfter(i),this._manipulatorState.handleHoverEvent(i,this._forEachTool),this._updateCursor()}_refreshToolWatchers(){this.handles.remove(qP),this._forEachTool(e=>{if(e instanceof Ye){const t=we(()=>[e.cursor,e.visible,e.editable],()=>{UP(e)||this._manipulatorState.clearPointers(e,this._manipulatorStateEventArgs),this._updateCursor()});this.handles.add(t,qP)}e.manipulators&&this.handles.add([e.manipulators.on("after-remove",t=>{this._manipulatorState.clearPointers(e,this._manipulatorStateEventArgs,!0,t.item.manipulator)}),e.manipulators.on("change",()=>{this._manipulatorState.updateHoveredStateFromKnownPointers(this._forEachTool),this._updateCursor()})],qP)}),this._manipulatorState.updateHoveredStateFromKnownPointers(this._forEachTool),this._updateCursor()}_updateToolEditableFlag(e){e.setEditableFlag(Sl.MANAGER,ce(this.activeTool)||e===this.activeTool)}_updateCursor(){let e=this._manipulatorState.cursor;ce(e)&&this._forEachTool(t=>!(!H(t.cursor)||!t.visible)&&(e=t.cursor,!0)),this._get("cursor")!==e&&this._set("cursor",e)}_removeIncompleteTools(e){this.tools.filter(t=>(ce(e)||t!==e)&&!t.created&&t.removeIncompleteOnCancel).forEach(t=>{this.tools.remove(t)})}};g([w({constructOnly:!0,nonNullable:!0})],ip.prototype,"view",void 0),g([w({readOnly:!0,nonNullable:!0})],ip.prototype,"textures",void 0),g([w({value:null})],ip.prototype,"activeTool",null),g([w({readOnly:!0,type:Xe})],ip.prototype,"tools",void 0),g([w({readOnly:!0})],ip.prototype,"cursor",void 0),g([w({readOnly:!0})],ip.prototype,"updating",null),ip=g([te("esri.views.ToolViewManager")],ip);const _ke=ip;let K1=class extends Ye{constructor(e){super(),this.nativeIndex=null,this._detectedDeviceType="unknown",e.mapping==="standard"?this._detectedDeviceType="standard":xke.test(e.id)?this._detectedDeviceType="spacemouse":this._detectedDeviceType="unknown",this.nativeIndex=e.index}get native(){const e=navigator.getGamepads?navigator.getGamepads():[];return this.nativeIndex!=null&&this.nativeIndex<e.length?e[this.nativeIndex]:null}get deviceType(){return this._detectedDeviceType}get axisThreshold(){return Ske[this.deviceType]}};g([w({nonNullable:!0,readOnly:!0})],K1.prototype,"nativeIndex",void 0),g([w({type:String,readOnly:!0})],K1.prototype,"deviceType",null),g([w({type:Number,readOnly:!0})],K1.prototype,"axisThreshold",null),K1=g([te("esri.views.input.gamepad.GamepadInputDevice")],K1);const xke=new RegExp("^(3dconnexion|space(mouse|navigator|pilot|explorer))","i"),Ske={standard:.15,spacemouse:.025,unknown:0},HP=K1;let W2=class extends Ye{constructor(...e){super(...e),this.devices=new Xe,this.enabledFocusMode="document"}};g([w({type:Xe.ofType(HP),readOnly:!0})],W2.prototype,"devices",void 0),g([w({type:["document","view","none"]})],W2.prototype,"enabledFocusMode",void 0),W2=g([te("esri.views.input.gamepad.GamepadSettings")],W2);const Mke=W2;let eI=class extends Ye{constructor(){super(...arguments),this.gamepad=new Mke}};g([w({readOnly:!0})],eI.prototype,"gamepad",void 0),eI=g([te("esri.views.input.Input")],eI);const Ike=eI;let bf=class extends Ye{constructor(e){super(e),this.enabled=!0,this.device=null,this.mode="pan",this.tiltDirection="forward-down",this.velocityFactor=1}};g([w({type:Boolean,nonNullable:!0})],bf.prototype,"enabled",void 0),g([w({type:HP})],bf.prototype,"device",void 0),g([w({type:["pan","zoom"],nonNullable:!0})],bf.prototype,"mode",void 0),g([w({type:["forward-down","forward-up"],nonNullable:!0})],bf.prototype,"tiltDirection",void 0),g([w({type:Number,nonNullable:!0})],bf.prototype,"velocityFactor",void 0),bf=g([te("esri.views.navigation.gamepad.GamepadSettings")],bf);const YX=bf;let Hy=class extends Ye{constructor(e){super(e),this.browserTouchPanEnabled=!0,this.gamepad=new YX,this.momentumEnabled=!0,this.mouseWheelZoomEnabled=!0}};g([w({type:Boolean})],Hy.prototype,"browserTouchPanEnabled",void 0),g([w({type:YX,nonNullable:!0})],Hy.prototype,"gamepad",void 0),g([w({type:Boolean})],Hy.prototype,"momentumEnabled",void 0),g([w({type:Boolean})],Hy.prototype,"mouseWheelZoomEnabled",void 0),Hy=g([te("esri.views.navigation.Navigation")],Hy);const XX=Hy;function _Ke(e,t,i){const r=eQ(e),n=t,o=$ke(r,n,i);if(r){const c=$2.deriveUnitFromSR(r,e.spatialReference).heightUnit;if(!i&&c!==r.heightUnit){const h=new ue("layerview:unmatched-height-unit",`The vertical units of the layer must match the horizontal units (${c})`,{horizontalUnit:c});return new ue("layerview:unsupported-height-model-info","The vertical coordinate system of the layer is not supported",{heightModelInfo:r,error:h})}}if(!Eke(e)||o===ya.Unsupported)return new ue("layerview:unsupported-height-model-info","The vertical coordinate system of the layer is not supported",{heightModelInfo:r});switch(o){case ya.Units:{const c=(r==null?void 0:r.heightUnit)||"unknown",h=(n==null?void 0:n.heightUnit)||"unknown",m=new ue("layerview:incompatible-height-unit",`The vertical units of the layer (${c}) must match the vertical units of the scene (${h})`,{layerUnit:c,sceneUnit:h});return new ue("layerview:incompatible-height-model-info","The vertical coordinate system of the layer is incompatible with the scene",{layerHeightModelInfo:r,sceneHeightModelInfo:n,error:m})}case ya.HeightModel:{const c=(r==null?void 0:r.heightModel)||"unknown",h=(n==null?void 0:n.heightModel)||"unknown",m=new ue("layerview:incompatible-height-model",`The height model of the layer (${c}) must match the height model of the scene (${h})`,{layerHeightModel:c,sceneHeightModel:h});return new ue("layerview:incompatible-height-model-info","The vertical coordinate system of the layer is incompatible with the scene",{layerHeightModelInfo:r,sceneHeightModelInfo:n,error:m})}case ya.CRS:{const c=(r==null?void 0:r.vertCRS)||"unknown",h=(n==null?void 0:n.vertCRS)||"unknown",m=new ue("layerview:incompatible-vertical-datum",`The vertical datum of the layer (${c}) must match the vertical datum of the scene (${h})`,{layerDatum:c,sceneDatum:h});return new ue("layerview:incompatible-height-model-info","The vertical coordinate system of the layer is incompatible with the scene",{layerHeightModelInfo:r,sceneHeightModelInfo:n,error:m})}}return null}function $ke(e,t,i){if(!QX(e)||!QX(t))return ya.Unsupported;if(e==null||t==null)return ya.Ok;if(!i&&e.heightUnit!==t.heightUnit)return ya.Units;if(e.heightModel!==t.heightModel)return ya.HeightModel;switch(e.heightModel){case"gravity-related-height":return ya.Ok;case"ellipsoidal":return e.vertCRS===t.vertCRS?ya.Ok:ya.CRS;default:return ya.Unsupported}}var ya;function QX(e){return e==null||e.heightModel!=null&&e.heightUnit!=null}function Eke(e){return"heightModelInfo"in e&&e.heightModelInfo!=null||e.spatialReference!=null||!rQ(e)}function eQ(e){var r;const t=e.url?hf(e.url):void 0;return!(((r=e.spatialReference)==null?void 0:r.vcsWkid)==null&&H(t)&&t.serverType==="ImageServer")&&tQ(e)&&e.heightModelInfo?e.heightModelInfo:rQ(e)?$2.deriveUnitFromSR(Cke,e.spatialReference):null}function tQ(e){return"heightModelInfo"in e}function iQ(e){if(e.type==="unknown"||!("capabilities"in e))return!1;switch(e.type){case"csv":case"feature":case"geojson":case"subtype-group":case"ogc-feature":case"oriented-imagery":case"wfs":return!0;default:return!1}}function rQ(e){return iQ(e)?!!(e.capabilities&&e.capabilities.data&&e.capabilities.data.supportsZ):nQ(e)}function Tke(e){return e.layers!=null||nQ(e)||iQ(e)||tQ(e)}function nQ(e){switch(e.type){case"building-scene":case"elevation":case"integrated-mesh":case"point-cloud":case"scene":case"voxel":return!0;case"base-dynamic":case"base-elevation":case"base-tile":case"bing-maps":case"csv":case"dimension":case"geojson":case"feature":case"subtype-group":case"geo-rss":case"graphics":case"group":case"imagery":case"imagery-tile":case"kml":case"line-of-sight":case"map-image":case"map-notes":case"media":case"ogc-feature":case"open-street-map":case"oriented-imagery":case"route":case"stream":case"tile":case"unknown":case"unsupported":case"vector-tile":case"wcs":case"web-tile":case"wfs":case"wms":case"wmts":case null:return!1}return!1}(function(e){e[e.Ok=0]="Ok",e[e.Units=1]="Units",e[e.HeightModel=2]="HeightModel",e[e.CRS=3]="CRS",e[e.Unsupported=4]="Unsupported"})(ya||(ya={}));const Cke=new $2({heightModel:"gravity-related-height"});var ma;function sQ(e){return e===ma.Global?"global":"local"}(function(e){e[e.Global=1]="Global",e[e.Local=2]="Local"})(ma||(ma={}));let WP,JP=null;async function kke(e){JP||(JP=import("./geometryServiceUtils.848ce334.js").then(t=>WP=t)),await JP,ur(e)}async function oQ(e,t,i,r){if(!e)return null;const n=e.spatialReference;return vu()||pc(n,t)?Da(e,t):WP?WP.projectGeometry(e,t,i,r):(await Promise.race([kke(r),bu(r)]),oQ(e,t,i,r))}let lr=class extends Ye{constructor(e){super(e),this.required={tileInfo:!1,heightModelInfo:!1,extent:!1},this.defaultSpatialReference=null,this.userSpatialReference=null,this.sourcePreloadCount=10,this.priorityCollection=null,this.requiresExtentInSpatialReference=!0,this.suspended=!1,this._projectExtentTask={task:null,input:null,output:null,spatialReference:null}}destroy(){this._projectExtentTask.task&&(this._projectExtentTask.task=Kl(this._projectExtentTask.task)),this._set("map",null)}get ready(){return!this._spatialReferenceTask.updating&&!this._tileInfoTask.updating&&!this._extentTask.updating}get heightModelInfoReady(){return!this._heightModelInfoTask.updating}get spatialReference(){return H(this.userSpatialReference)?this.userSpatialReference:Ht(this._spatialReferenceTask.spatialReference)}get extent(){return Ht(this._extentTask.extent)}get heightModelInfo(){return Ht(this._heightModelInfoTask.heightModelInfo)}get vcsWkid(){return Ht(this._heightModelInfoTask.vcsWkid)}get latestVcsWkid(){return Ht(this._heightModelInfoTask.latestVcsWkid)}get viewingMode(){return ce(this.userSpatialReference)||this.userSpatialReference.equals(Ht(this._spatialReferenceTask.spatialReference))?Ht(this._spatialReferenceTask.viewingMode):null}get tileInfo(){return Ht(this._tileInfoTask.tileInfo)}get mapCollections(){var i,r,n,o;const e=(i=this.map)==null?void 0:i.call(this),t=[];return H(this.priorityCollection)&&t.push(this.priorityCollection),t.push({parent:e==null?void 0:e.basemap,layers:(r=e==null?void 0:e.basemap)==null?void 0:r.baseLayers},{layers:e==null?void 0:e.layers},{parent:e==null?void 0:e.ground,layers:(n=e==null?void 0:e.ground)==null?void 0:n.layers},{parent:e==null?void 0:e.basemap,layers:(o=e==null?void 0:e.basemap)==null?void 0:o.referenceLayers}),t}get _allLayers(){return this._collectLayers(this.mapCollections)}get _spatialReferenceTask(){var n;if(this.suspended)return(n=this._get("_spatialReferenceTask"))!=null?n:{updating:!1};const{layers:e,updating:t}=this._allLayers;let i=null;for(const o of e){const c=this._getSupportedSpatialReferences(o);if(c.length>0){const h=this._narrowDownSpatialReferenceCandidates(i,c);H(h)&&(i=h)}if(H(i)&&i.length===1)break}if(t&&(ce(i)||i.length!==1))return{updating:!0};const r=this._pickSpatialReferenceCandidate(i);return{spatialReference:H(r)?r.spatialReference:null,viewingMode:H(r)?r.viewingMode:null,updating:!1}}get _tileInfoTask(){var i,r,n,o,c,h,m,b;if(!this.required.tileInfo)return(i=this._get("_tileInfoTask"))!=null?i:{updating:!1};if(!this.spatialReference)return{updating:this._spatialReferenceTask.updating};const{layers:e,updating:t}=this._collectLayers([{parent:(n=(r=this.map)==null?void 0:r.call(this))==null?void 0:n.basemap,layers:(h=(c=(o=this.map)==null?void 0:o.call(this))==null?void 0:c.basemap)==null?void 0:h.baseLayers},{layers:(b=(m=this.map)==null?void 0:m.call(this))==null?void 0:b.layers}]);if(e&&e.length>0&&"tileInfo"in e[0]){const x=e[0].tileInfo;return{tileInfo:x&&x.spatialReference.equals(this.spatialReference)?x:null,updating:!1}}return{updating:t}}get _heightModelInfoTask(){var i,r,n,o;if(!this.required.heightModelInfo||this.suspended&&((i=this._get("_heightModelInfoTask"))==null?void 0:i.heightModelInfo))return(r=this._get("_heightModelInfoTask"))!=null?r:{updating:!1};const{layers:e,updating:t}=this._allLayers;for(const c of e)if(Tke(c)){const h=eQ(c);if(h)return{heightModelInfo:h,vcsWkid:(n=c.spatialReference)==null?void 0:n.vcsWkid,latestVcsWkid:(o=c.spatialReference)==null?void 0:o.latestVcsWkid,updating:!1}}return{updating:t}}get _extentCandidatesTask(){var r,n;if(this.suspended||!this.required.extent)return(r=this._get("_extentCandidatesTask"))!=null?r:{updating:!1};if(!this.spatialReference)return{updating:this._spatialReferenceTask.updating};const e=this._allLayers,t=e.updating,i=[];for(const o of e.layers){const c="fullExtents"in o&&o.fullExtents||(H(o.fullExtent)?[o.fullExtent]:[]),h=this.requiresExtentInSpatialReference?null:c[0],m=(n=c.find(b=>b.spatialReference.equals(this.spatialReference)))!=null?n:h;if(m)return{candidates:[{extent:m,layer:o}],updating:!1};if(this._getSupportedSpatialReferences(o).length>0)for(const b of c)i.push({extent:b,layer:o})}return{candidates:i,updating:t}}get _extentTask(){const{candidates:e,updating:t}=this._extentCandidatesTask;if(t)return{updating:t};if(ce(e)||e.length===0)return{updating:!1};if(!this.spatialReference)return{updating:this._spatialReferenceTask.updating};const i=this._pickExtentCandidate(e),r=this.spatialReference;return i.extent.equals(this._projectExtentTask.input)&&r.equals(this._projectExtentTask.spatialReference)?{extent:this._projectExtentTask.output,updating:H(this._projectExtentTask.task)&&!this._projectExtentTask.task.finished}:(H(this._projectExtentTask.task)&&(this._projectExtentTask.task=Kl(this._projectExtentTask.task)),this._projectExtentTask={input:i.extent.clone(),output:null,spatialReference:r.clone(),task:KB(async n=>{try{const o=await oQ(i.extent,r,i.layer.portalItem,n);this._projectExtentTask=Ce(K({},this._projectExtentTask),{task:null,output:o})}catch{if(ka(n))return;this._projectExtentTask=Ce(K({},this._projectExtentTask),{task:null})}})},{updating:!0})}_narrowDownSpatialReferenceCandidates(e,t){if(ce(e))return t;const i=[],r=(n,o)=>H(n)?H(o)?n===o&&n:n:o;for(const n of e)for(const o of t){if(!n.spatialReference.equals(o.spatialReference))continue;const c=r(n.viewingMode,o.viewingMode);if(c!==!1){i.push({spatialReference:n.spatialReference,viewingMode:c});break}}return i.length>0?i:null}_pickSpatialReferenceCandidate(e){const t=this.defaultSpatialReference;return ce(e)||e.length<1?H(t)?{spatialReference:t,viewingMode:null}:null:(H(t)&&e.length>1&&e.some(({spatialReference:i})=>i.equals(t))&&(e=e.filter(({spatialReference:i})=>i.equals(t))),e.length>1&&e.some(({viewingMode:i})=>i!==ma.Local)&&(e=e.filter(({viewingMode:i})=>i!==ma.Local)),e[0])}_getSupportedSpatialReferences(e){const t="supportedSpatialReferences"in e&&e.supportedSpatialReferences||(e.spatialReference?[e.spatialReference]:[]);if(t.length===0)return[];const i=[];for(const r of t){const n=this.getSpatialReferenceSupport({spatialReference:r,layer:e});if(H(n)){const o=H(n.constraints)?n.constraints:[{spatialReference:r,viewingMode:null}];for(const{spatialReference:c,viewingMode:h}of o)(!this.requiresExtentInSpatialReference||ce(this.userSpatialReference)||c.equals(this.userSpatialReference))&&i.push({spatialReference:c,viewingMode:h})}}return i}_pickExtentCandidate(e){const t=this.spatialReference;return e.find(({extent:i})=>t.equals(i.spatialReference))||e[0]}_collectLayers(e){var i;if(this._loadMaybe((i=this.map)==null?void 0:i.call(this))!=="loaded")return{layers:[],updating:!0};const t={layers:[],preloading:-1,updating:!1};for(const r of e)if(this._collectCollection(r,t),t.preloading===this.sourcePreloadCount)break;return{layers:t.layers,updating:t.updating}}_collectCollection(e,t){if(e.layers){switch(this._loadMaybe(e.parent)){case"loading":return t.updating=!0,void++t.preloading;case"failed":return}for(const i of e.layers){switch(this._loadMaybe(i)){case"failed":continue;case"loading":t.updating=!0,++t.preloading;break;case"loaded":t.updating||t.layers.push(i),"layers"in i&&this._collectCollection({layers:i.layers},t)}if(t.preloading===this.sourcePreloadCount)break}}}_loadMaybe(e){return e&&"loadStatus"in e?e.loadStatus==="not-loaded"?(e.load().catch(()=>{}),"loading"):e.loadStatus:"loaded"}};g([w()],lr.prototype,"required",void 0),g([w({constructOnly:!0})],lr.prototype,"map",void 0),g([w({constructOnly:!0})],lr.prototype,"getSpatialReferenceSupport",void 0),g([w()],lr.prototype,"defaultSpatialReference",void 0),g([w()],lr.prototype,"userSpatialReference",void 0),g([w()],lr.prototype,"sourcePreloadCount",void 0),g([w()],lr.prototype,"priorityCollection",void 0),g([w()],lr.prototype,"requiresExtentInSpatialReference",void 0),g([w()],lr.prototype,"suspended",void 0),g([w({readOnly:!0})],lr.prototype,"ready",null),g([w({readOnly:!0})],lr.prototype,"heightModelInfoReady",null),g([w({readOnly:!0})],lr.prototype,"spatialReference",null),g([w({readOnly:!0})],lr.prototype,"extent",null),g([w({readOnly:!0})],lr.prototype,"heightModelInfo",null),g([w({readOnly:!0})],lr.prototype,"vcsWkid",null),g([w({readOnly:!0})],lr.prototype,"latestVcsWkid",null),g([w({readOnly:!0})],lr.prototype,"viewingMode",null),g([w({readOnly:!0})],lr.prototype,"tileInfo",null),g([w({readOnly:!0})],lr.prototype,"mapCollections",null),g([w({readOnly:!0})],lr.prototype,"_allLayers",null),g([w({readOnly:!0})],lr.prototype,"_spatialReferenceTask",null),g([w({readOnly:!0})],lr.prototype,"_tileInfoTask",null),g([w({readOnly:!0})],lr.prototype,"_heightModelInfoTask",null),g([w({readOnly:!0})],lr.prototype,"_extentCandidatesTask",null),g([w()],lr.prototype,"_extentTask",null),g([w()],lr.prototype,"_projectExtentTask",void 0),lr=g([te("esri.views.support.DefaultsFromMap")],lr);var tI;let Bt=tI=class extends ls(Or.EventedMixin(o_(Ye))){constructor(e){super(e),this._userSpatialReference=null,this._cursor=null,this.allLayerViews=new Dg({getCollections:()=>{var t,i,r;return[(t=this.basemapView)==null?void 0:t.baseLayerViews,(i=this.groundView)==null?void 0:i.layerViews,this.layerViews,(r=this.basemapView)==null?void 0:r.referenceLayerViews]},getChildrenFunction:t=>t.layerViews}),this.groundView=null,this.basemapView=null,this.fatalError=null,this.graphics=new Uy,this.analyses=new QM,this.typeSpecificPreconditionsReady=!0,this.layerViews=new Xe,this.magnifier=new CX,this.padding={left:0,top:0,right:0,bottom:0},this.ready=!1,this.spatialReferenceWarningDelay=1e3,this.supportsGround=!0,this.timeExtent=null,this.type=null,this.scale=null,this.updating=!1,this.initialExtentRequired=!0,this.input=new Ike,this.navigation=new XX,this.layerViewManager=null,this.analysisViewManager=null,this.isHeightModelInfoRequired=!1,this.width=null,this.height=null,this.resizing=!1,this.suspended=!1,this.viewEvents=new mke(this),this.persistableViewModels=new Xe,this._isValid=!1,this._readyCycleForced=!1,this.handles.add(we(()=>this.preconditionsReady,t=>{var i,r;t?(this._currentSpatialReference=this.spatialReference,tI.views.add(this)):(this._currentSpatialReference=null,tI.views.remove(this)),this.notifyChange("spatialReference"),!t&&this.ready?((i=this.toolViewManager)==null||i.detach(),H(this.analysisViewManager)&&this.analysisViewManager.detach(),(r=this.layerViewManager)==null||r.clear(),this._teardown()):t&&!this.ready&&(this._startup(),H(this.analysisViewManager)&&this.analysisViewManager.attach(),this.toolViewManager.attach())},mu))}initialize(){this.addResolvingPromise(this.validate().then(()=>(this._isValid=!0,Ch(()=>this.ready)))),this.basemapView=new vf({view:this}),this.layerViewManager=new uke({view:this,layerViewImporter:{importLayerView:e=>this.importLayerView(e),hasLayerViewModule:e=>this.hasLayerViewModule(e)},supportsGround:this.supportsGround}),this.toolViewManager=new _ke({view:this}),this._setupSpatialReferenceLogger(),this.handles.add([we(()=>this.initialExtentRequired,e=>this.defaultsFromMap.required=Ce(K({},this.defaultsFromMap.required),{extent:e}),{sync:!0,initial:!0}),we(()=>this.ready,e=>{this.defaultsFromMap&&(this.defaultsFromMap.suspended=e,this.defaultsFromMap.userSpatialReference=e?this.spatialReference:this._userSpatialReference)},{sync:!0}),we(()=>this._userSpatialReference,e=>{this.defaultsFromMap&&(this.defaultsFromMap.userSpatialReference=e)},{sync:!0,initial:!0})])}_setupSpatialReferenceLogger(){let e=null;this.handles.add([we(()=>{var t;return(t=this.defaultsFromMap)==null?void 0:t.ready},t=>{var r;const i=((r=this.map)==null?void 0:r.allLayers.length)>0;if(t&&!this.spatialReference&&i){if(H(e))return;const n=uh(()=>e=Kl(e));e=KB(async o=>{try{await uw(this.spatialReferenceWarningDelay,null,o)}catch{return}finally{e=null}$e.getLogger(this.declaredClass).warn("#spatialReference","no spatial reference could be derived from the currently added map layers")}),this.handles.add(n,"spatial-reference-logger-task")}else this.handles.remove("spatial-reference-logger-task")},{sync:!0})])}destroy(){if(this.destroyed)return;this.viewEvents.destroy(),this.allLayerViews.destroy(),this.navigation&&(this.navigation.destroy(),this._set("navigation",null)),this.graphics=li(this.graphics),this.analyses=li(this.analyses),this.handles.remove("defaultsFromMap"),this.defaultsFromMap.destroy(),this._set("defaultsFromMap",null),li(this.analysisViewManager),this.toolViewManager=li(this.toolViewManager),this.layerViewManager=li(this.layerViewManager),this.basemapView=li(this.basemapView),this.invalidate(),this._emitter.clear(),this.handles.removeAll();const e=this.map;this.map=null,e==null||e.destroy()}_startup(){this._set("ready",!0)}_teardown(){this._set("ready",!1)}whenReady(){return Promise.resolve(this)}toMap(){return $e.getLogger(this.declaredClass).error("#toMap()","Not implemented on this instance of View"),null}get activeTool(){var e;return(e=this.toolViewManager)==null?void 0:e.activeTool}set activeTool(e){this.toolViewManager&&(this.toolViewManager.activeTool=e)}get animation(){return this._get("animation")}set animation(e){this._set("animation",e)}get _defaultsFromMapSettings(){return{}}get defaultsFromMap(){return new lr(K({required:{tileInfo:!1,heightModelInfo:!1,extent:!1},map:()=>this.map,getSpatialReferenceSupport:e=>this.getSpatialReferenceSupport(e)},this._defaultsFromMapSettings))}get extent(){return this._get("extent")}set extent(e){this._set("extent",e)}get heightModelInfo(){return this.getDefaultHeightModelInfo()}get interacting(){return this.navigating}get navigating(){return!1}get preconditionsReady(){var e;return!(this.fatalError||!this._isValid||this._readyCycleForced||!this.map||Xo.isLoadable(this.map)&&!this.map.loaded||this.width===0||this.height===0||!this.spatialReference||!this._validateSpatialReference(this.spatialReference)||!this._currentSpatialReference&&!((e=this.defaultsFromMap)==null?void 0:e.ready)||!this.typeSpecificPreconditionsReady)}set map(e){e!==this._get("map")&&((e==null?void 0:e.destroyed)&&($e.getLogger(this.declaredClass).warn("#map","The provided map is already destroyed",{map:e}),e=null),Xo.isLoadable(e)&&e.load().catch(()=>{}),this.constructed&&(this.forceReadyCycle(),this._currentSpatialReference=null),this._set("map",e))}get spatialReference(){var t,i;let e=this._userSpatialReference||this._currentSpatialReference||this.getDefaultSpatialReference()||null;return e&&((i=(t=this.defaultsFromMap)==null?void 0:t.required)==null?void 0:i.heightModelInfo)&&(e=e.clone(),e.vcsWkid=this.defaultsFromMap.vcsWkid,e.latestVcsWkid=this.defaultsFromMap.latestVcsWkid),e}set spatialReference(e){const t=!hr(e,this._get("spatialReference"));this._set("_userSpatialReference",e),t&&(this._set("spatialReference",e),this._spatialReferenceChanged(e))}_spatialReferenceChanged(e){}get stationary(){return!this.animation&&!this.navigating&&!this.resizing}get tools(){var e;return(e=this.toolViewManager)==null?void 0:e.tools}get initialExtent(){var e;return(e=this.defaultsFromMap)==null?void 0:e.extent}get cursor(){const e=this.toolViewManager?this.toolViewManager.cursor:null;return H(e)?e:this._cursor||"default"}set cursor(e){this._cursor=e,this.notifyChange("cursor")}get size(){return[this.width,this.height]}whenLayerView(e){return this.layerViewManager.whenLayerView(e)}getDefaultSpatialReference(){var e;return(e=this.defaultsFromMap)==null?void 0:e.spatialReference}getDefaultHeightModelInfo(){var e,t,i;return(i=(t=this.map&&"heightModelInfo"in this.map?this.map.heightModelInfo:void 0)!=null?t:(e=this.defaultsFromMap)==null?void 0:e.heightModelInfo)!=null?i:null}importLayerView(e){throw new ue("importLayerView() not implemented")}hasLayerViewModule(e){return!1}async validate(){}invalidate(){this._isValid=!1}getSpatialReferenceSupport(){return{constraints:null}}_validateSpatialReference(e){return H(this.getSpatialReferenceSupport({spatialReference:e}))}when(e,t){return this.isResolved()&&!this.ready&&$e.getLogger(this.declaredClass).warn("#when()","Calling view.when() while the view is no longer ready but was already resolved once will resolve immediately. Use reactiveUtils.whenOnce(() => view.ready).then(...) instead."),super.when(e,t)}forceReadyCycle(){this.ready&&(os(()=>this.preconditionsReady===!1,()=>this._readyCycleForced=!1,{once:!0}),this._readyCycleForced=!0)}addAndActivateTool(e){this.toolViewManager.tools.add(e),this.activeTool=e}tryFatalErrorRecovery(){this.fatalError=null}};Bt.views=new Xe,g([w()],Bt.prototype,"_userSpatialReference",void 0),g([w()],Bt.prototype,"activeTool",null),g([w({readOnly:!0})],Bt.prototype,"allLayerViews",void 0),g([w()],Bt.prototype,"groundView",void 0),g([w()],Bt.prototype,"animation",null),g([w()],Bt.prototype,"basemapView",void 0),g([w({readOnly:!0})],Bt.prototype,"_defaultsFromMapSettings",null),g([w()],Bt.prototype,"defaultsFromMap",null),g([w()],Bt.prototype,"fatalError",void 0),g([w({type:gi})],Bt.prototype,"extent",null),g([w(zP(Uy,"graphics"))],Bt.prototype,"graphics",void 0),g([w(zP(QM,"analyses"))],Bt.prototype,"analyses",void 0),g([w({readOnly:!0,type:$2})],Bt.prototype,"heightModelInfo",null),g([w({readOnly:!0})],Bt.prototype,"interacting",null),g([w({readOnly:!0})],Bt.prototype,"navigating",null),g([w({readOnly:!0,dependsOn:["fatalError","_isValid","_readyCycleForced","map","map.loaded?","width","height","spatialReference","_currentSpatialReference","defaultsFromMap.ready","typeSpecificPreconditionsReady"]})],Bt.prototype,"preconditionsReady",null),g([w({readOnly:!0})],Bt.prototype,"typeSpecificPreconditionsReady",void 0),g([w({type:Xe,readOnly:!0})],Bt.prototype,"layerViews",void 0),g([w({type:CX})],Bt.prototype,"magnifier",void 0),g([w({value:null,type:$_e})],Bt.prototype,"map",null),g([w()],Bt.prototype,"padding",void 0),g([w({readOnly:!0})],Bt.prototype,"ready",void 0),g([w({type:Mt})],Bt.prototype,"spatialReference",null),g([w()],Bt.prototype,"spatialReferenceWarningDelay",void 0),g([w()],Bt.prototype,"stationary",null),g([w({readOnly:!0})],Bt.prototype,"supportsGround",void 0),g([w({type:qa})],Bt.prototype,"timeExtent",void 0),g([w()],Bt.prototype,"tools",null),g([w()],Bt.prototype,"toolViewManager",void 0),g([w({readOnly:!0})],Bt.prototype,"type",void 0),g([w({type:Number})],Bt.prototype,"scale",void 0),g([w({readOnly:!0})],Bt.prototype,"updating",void 0),g([w({readOnly:!0})],Bt.prototype,"initialExtentRequired",void 0),g([w({readOnly:!0})],Bt.prototype,"initialExtent",null),g([w()],Bt.prototype,"cursor",null),g([w({readOnly:!0})],Bt.prototype,"input",void 0),g([w({type:XX,nonNullable:!0})],Bt.prototype,"navigation",void 0),g([w()],Bt.prototype,"layerViewManager",void 0),g([w()],Bt.prototype,"analysisViewManager",void 0),g([w()],Bt.prototype,"width",void 0),g([w()],Bt.prototype,"height",void 0),g([w({readOnly:!0})],Bt.prototype,"resizing",void 0),g([w({value:null,readOnly:!0})],Bt.prototype,"size",null),g([w({readOnly:!0})],Bt.prototype,"suspended",void 0),g([w({readOnly:!0})],Bt.prototype,"viewEvents",void 0),g([w({readOnly:!0})],Bt.prototype,"persistableViewModels",void 0),g([w()],Bt.prototype,"_isValid",void 0),g([w()],Bt.prototype,"_readyCycleForced",void 0),g([w()],Bt.prototype,"_currentSpatialReference",void 0),Bt=tI=g([te("esri.views.View")],Bt);const Ake=Bt;let wf=class extends T5{constructor(e){super(e),this.state="running",this.target=null,this._dfd=null}initialize(){this.addResolvingPromise(new Promise((e,t)=>this._dfd={resolve:e,reject:t}))}get done(){return this.state==="finished"||this.state==="stopped"}stop(){var e;this.state!=="stopped"&&this.state!=="finished"&&(this._set("state","stopped"),(e=this._dfd)==null||e.reject(new ue("ViewAnimation stopped")))}finish(){var e;this.state!=="stopped"&&this.state!=="finished"&&(this._set("state","finished"),(e=this._dfd)==null||e.resolve())}update(e,t){t||(t=yh(e)?"waiting-for-target":"running"),this._set("target",e),this._set("state",t)}};g([w({readOnly:!0})],wf.prototype,"done",null),g([w({readOnly:!0,type:String})],wf.prototype,"state",void 0),g([w()],wf.prototype,"target",void 0),wf=g([te("esri.views.ViewAnimation")],wf),function(e){e.State={RUNNING:"running",STOPPED:"stopped",FINISHED:"finished",WAITING_FOR_TARGET:"waiting-for-target"}}(wf||(wf={}));const ZP=wf;function Wy(e,t,i,r){const n=3*e,o=3*(i-e)-n,c=1-n-o,h=3*t,m=3*(r-t)-h,b=1-h-m;function x(P){return((c*P+o)*P+n)*P}function I(P){return((b*P+m)*P+h)*P}function E(P){return(3*c*P+2*o)*P+n}function k(P,F){let N,B,z,q,J,X;for(z=P,X=0;X<8;X++){if(q=x(z)-P,Math.abs(q)<F)return z;if(J=E(z),Math.abs(J)<1e-6)break;z-=q/J}if(N=0,B=1,z=P,z<N)return N;if(z>B)return B;for(;N<B;){if(q=x(z),Math.abs(q-P)<F)return z;P>q?N=z:B=z,z=.5*(B-N)+N}return z}return function(P,F=1e-6){return I(k(P,F))}}const Pke=/^cubic-bezier\((.*)\)/,Ml={};function Lke(e){let t=Ml[e]||null;if(!t){const i=Pke.exec(e);if(i){const r=i[1].split(",").map(n=>parseFloat(n.trim()));r.length!==4||r.some(n=>isNaN(n))||(t=Wy.apply(Wy,r))}}return t}Ml.ease=Wy(.25,.1,.25,1),Ml.linear=Wy(0,0,1,1),Ml.easeIn=Ml["ease-in"]=Wy(.42,0,1,1),Ml.easeOut=Ml["ease-out"]=Wy(0,0,.58,1),Ml.easeInOut=Ml["ease-in-out"]=Wy(.42,0,.58,1);function ku(){return[1,0,0,1,0,0]}function aQ(e){return[e[0],e[1],e[2],e[3],e[4],e[5]]}function Oke(e,t,i,r,n,o){return[e,t,i,r,n,o]}function Rke(e,t){return new Float64Array(e,t,6)}Object.freeze(Object.defineProperty({__proto__:null,create:ku,clone:aQ,fromValues:Oke,createView:Rke},Symbol.toStringTag,{value:"Module"}));function Y1(e,t){return e[0]=t[0],e[1]=t[1],e}function Cs(e,t,i){return e[0]=t,e[1]=i,e}function KP(e,t,i){return e[0]=t[0]+i[0],e[1]=t[1]+i[1],e}function Jr(e,t,i){return e[0]=t[0]-i[0],e[1]=t[1]-i[1],e}function lQ(e,t,i){return e[0]=t[0]*i[0],e[1]=t[1]*i[1],e}function cQ(e,t,i){return e[0]=t[0]/i[0],e[1]=t[1]/i[1],e}function Fke(e,t){return e[0]=Math.ceil(t[0]),e[1]=Math.ceil(t[1]),e}function Nke(e,t){return e[0]=Math.floor(t[0]),e[1]=Math.floor(t[1]),e}function Dke(e,t,i){return e[0]=Math.min(t[0],i[0]),e[1]=Math.min(t[1],i[1]),e}function jke(e,t,i){return e[0]=Math.max(t[0],i[0]),e[1]=Math.max(t[1],i[1]),e}function Vke(e,t){return e[0]=Math.round(t[0]),e[1]=Math.round(t[1]),e}function X1(e,t,i){return e[0]=t[0]*i,e[1]=t[1]*i,e}function Tc(e,t,i,r){return e[0]=t[0]+i[0]*r,e[1]=t[1]+i[1]*r,e}function rp(e,t){const i=t[0]-e[0],r=t[1]-e[1];return Math.sqrt(i*i+r*r)}function Q1(e,t){const i=t[0]-e[0],r=t[1]-e[1];return i*i+r*r}function J2(e){const t=e[0],i=e[1];return Math.sqrt(t*t+i*i)}function _f(e){const t=e[0],i=e[1];return t*t+i*i}function uQ(e,t){return e[0]=-t[0],e[1]=-t[1],e}function zke(e,t){return e[0]=1/t[0],e[1]=1/t[1],e}function iI(e,t){const i=t[0],r=t[1];let n=i*i+r*r;return n>0&&(n=1/Math.sqrt(n),e[0]=t[0]*n,e[1]=t[1]*n),e}function np(e,t){return e[0]*t[0]+e[1]*t[1]}function YP(e,t,i){const r=t[0]*i[1]-t[1]*i[0];return e[0]=e[1]=0,e[2]=r,e}function rI(e,t,i,r){const n=t[0],o=t[1];return e[0]=n+r*(i[0]-n),e[1]=o+r*(i[1]-o),e}function Gke(e,t){t=t||1;const i=2*Bw()*Math.PI;return e[0]=Math.cos(i)*t,e[1]=Math.sin(i)*t,e}function Bke(e,t,i){const r=t[0],n=t[1];return e[0]=i[0]*r+i[2]*n,e[1]=i[1]*r+i[3]*n,e}function Au(e,t,i){const r=t[0],n=t[1];return e[0]=i[0]*r+i[2]*n+i[4],e[1]=i[1]*r+i[3]*n+i[5],e}function Uke(e,t,i){const r=t[0],n=t[1];return e[0]=i[0]*r+i[3]*n+i[6],e[1]=i[1]*r+i[4]*n+i[7],e}function qke(e,t,i){const r=t[0],n=t[1];return e[0]=i[0]*r+i[4]*n+i[12],e[1]=i[1]*r+i[5]*n+i[13],e}function hQ(e,t,i,r){const n=t[0]-i[0],o=t[1]-i[1],c=Math.sin(r),h=Math.cos(r);return e[0]=n*h-o*c+i[0],e[1]=n*c+o*h+i[1],e}function Hke(e,t){const i=e[0],r=e[1],n=t[0],o=t[1];let c=i*i+r*r;c>0&&(c=1/Math.sqrt(c));let h=n*n+o*o;h>0&&(h=1/Math.sqrt(h));const m=(i*n+r*o)*c*h;return m>1?0:m<-1?Math.PI:Math.acos(m)}function Wke(e){return"vec2("+e[0]+", "+e[1]+")"}function Jke(e,t){return e[0]===t[0]&&e[1]===t[1]}function XP(e,t){const i=e[0],r=e[1],n=t[0],o=t[1],c=Zo();return Math.abs(i-n)<=c*Math.max(1,Math.abs(i),Math.abs(n))&&Math.abs(r-o)<=c*Math.max(1,Math.abs(r),Math.abs(o))}function QP(e,t,i,r,n){let o=t[0]-i[0],c=t[1]-i[1];const h=(r[0]*o+r[1]*c)*(n-1);return o=r[0]*h,c=r[1]*h,e[0]=t[0]+o,e[1]=t[1]+c,e}const Zke=J2,nI=Jr,Kke=lQ,Yke=cQ,Xke=rp,Qke=Q1,e7e=_f;Object.freeze(Object.defineProperty({__proto__:null,copy:Y1,set:Cs,add:KP,subtract:Jr,multiply:lQ,divide:cQ,ceil:Fke,floor:Nke,min:Dke,max:jke,round:Vke,scale:X1,scaleAndAdd:Tc,distance:rp,squaredDistance:Q1,length:J2,squaredLength:_f,negate:uQ,inverse:zke,normalize:iI,dot:np,cross:YP,lerp:rI,random:Gke,transformMat2:Bke,transformMat2d:Au,transformMat3:Uke,transformMat4:qke,rotate:hQ,angle:Hke,str:Wke,exactEquals:Jke,equals:XP,projectAndScale:QP,len:Zke,sub:nI,mul:Kke,div:Yke,dist:Xke,sqrDist:Qke,sqrLen:e7e},Symbol.toStringTag,{value:"Module"}));function ui(){return[0,0]}function pQ(e){return[e[0],e[1]]}function sp(e,t){return[e,t]}function dQ(e){const t=ui(),i=Math.min(2,e.length);for(let r=0;r<i;++r)t[r]=e[r];return t}function fQ(e,t){return new Float64Array(e,t,2)}function yQ(){return ui()}function mQ(){return sp(1,1)}function gQ(){return sp(1,0)}function vQ(){return sp(0,1)}const t7e=yQ(),i7e=mQ(),r7e=gQ(),n7e=vQ();Object.freeze(Object.defineProperty({__proto__:null,create:ui,clone:pQ,fromValues:sp,fromArray:dQ,createView:fQ,zeros:yQ,ones:mQ,unitX:gQ,unitY:vQ,ZEROS:t7e,ONES:i7e,UNIT_X:r7e,UNIT_Y:n7e},Symbol.toStringTag,{value:"Module"}));const bQ=96,wQ=39.37,s7e=180/Math.PI;function _Q(e){return e.wkid?e:e.spatialReference||Mt.WGS84}function eL(e,t){return t.type?Cs(e,t.x,t.y):Y1(e,t)}function xQ(e){return kh(e)}function Z2(e,t){const i=Math.max(1,t[0]),r=Math.max(1,t[1]);return Math.max(e.width/i,e.height/r)*f7e(e.spatialReference)}async function K2(e,t,i,r){let n,o;if(!e||Array.isArray(e)&&!e.length)return null;if(Xe.isCollection(e)&&(e=e.toArray()),Array.isArray(e)&&e.length&&typeof e[0]=="object"){const h=e.every(x=>"attributes"in x),m=e.some(x=>!x.geometry);let b=e;if(h&&m&&t&&t.allLayerViews){const x=new Map;for(const P of e){const F=P.layer,N=x.get(F)||[],B=P.attributes[F.objectIdField];B!=null&&N.push(B),x.set(F,N)}const I=[];x.forEach((P,F)=>{const N=t.allLayerViews.find(B=>B.layer.id===F.id);if("queryFeatures"in N){const B=F.createQuery();B.objectIds=P,B.returnGeometry=!0,I.push(N.queryFeatures(B))}});const E=await Promise.all(I),k=[];for(const P of E)if(P&&P.features&&P.features.length)for(const F of P.features)H(F.geometry)&&k.push(F.geometry);b=k}for(const x of b)r=await K2(x,t,i,r);return r}if(Array.isArray(e)&&e.length===2&&typeof e[0]=="number"&&typeof e[1]=="number")n=new pt(e);else if(e instanceof cd)n=e;else if("geometry"in e){if(e.geometry)n=e.geometry;else if(e.layer){const h=e.layer,m=t.allLayerViews.find(b=>b.layer.id===h.id);if("queryFeatures"in m){const b=h.createQuery();b.objectIds=[e.attributes[h.objectIdField]],b.returnGeometry=!0;const x=await m.queryFeatures(b);n=Yb(x,"features",0,"geometry")}}}if(ce(n)||(o=n.type==="point"?new gi({xmin:n.x,ymin:n.y,xmax:n.x,ymax:n.y,spatialReference:n.spatialReference}):n.extent,!o))return null;vu()||pc(o.spatialReference,i)||await bu();const c=Da(o,i);return c?r=r?r.union(c):c:null}function o7e(e){if(e&&(!Array.isArray(e)||typeof e[0]!="number")&&(typeof e=="object"||Array.isArray(e)&&typeof e[0]=="object")){if("layer"in e&&e.layer&&e.layer.minScale&&e.layer.maxScale){const t=e.layer;return{min:t.minScale,max:t.maxScale}}if(Array.isArray(e)&&e.length&&e.every(t=>"layer"in t)){let t=0,i=0;for(const r of e){const n=r.layer;n&&n.minScale&&n.maxScale&&(t=n.minScale<t?n.minScale:t,i=n.maxScale>i?n.maxScale:i)}return t&&i?{min:t,max:i}:null}}}function tL(e,t){return hr(_Q(e),t)?e:Da(e,t)}async function a7e(e,t){if(!e||!t)return new ra({targetGeometry:new pt,scale:0,rotation:0});let i=t.spatialReference;const{constraints:r,padding:n,viewpoint:o,size:c}=t,h=[n?c[0]-n.left-n.right:c[0],n?c[1]-n.top-n.bottom:c[1]];let m=null;e instanceof ra?m=e:e.viewpoint?m=e.viewpoint:e.target&&e.target.declaredClass==="esri.Viewpoint"&&(m=e.target);let b=null;m&&m.targetGeometry?b=m.targetGeometry:e instanceof gi?b=e:(e||e&&("center"in e||"extent"in e||"target"in e))&&(b=await K2(e.center,t,i)||await K2(e.extent,t,i)||await K2(e.target,t,i)||await K2(e,t,i)),!b&&o&&o.targetGeometry?b=o.targetGeometry:!b&&t.extent&&(b=t.extent),i||(i=_Q(t.spatialReference||t.extent||b)),vu()||hr(b.spatialReference,i)||pc(b,i)||await bu();const x=tL(b.center?b.center:b,i);let I=null;if(m&&H(m.targetGeometry)&&m.targetGeometry.type==="point")I=m.scale;else if("scale"in e&&e.scale)I=e.scale;else if("zoom"in e&&e.zoom!==-1&&r&&r.effectiveLODs)I=r.zoomToScale(e.zoom);else if(Array.isArray(b)||b.type==="point"||b.type==="extent"&&b.width===0&&b.height===0){const F=tL(t.extent,i);I=H(F)?Z2(F,h):t.extent?Z2(t.extent,h):o.scale}else I=Z2(tL(b.extent,i),h);const E=o7e(e);E&&(E.min&&E.min>I?I=E.min:E.max&&E.max<I&&(I=E.max));let k=0;m?k=m.rotation:e.hasOwnProperty("rotation")?k=e.rotation:o&&(k=o.rotation);let P=new ra({targetGeometry:x,scale:I,rotation:k});return r&&(P=r.fit(P),r.constrainByGeometry(P),r.rotationEnabled||(P.rotation=k)),P}function Cc(e,t){const i=e.targetGeometry,r=t.targetGeometry;return i.x=r.x,i.y=r.y,i.spatialReference=r.spatialReference,e.scale=t.scale,e.rotation=t.rotation,e}function l7e(e,t,i){return i?Cs(e,.5*(t[0]-i.right+i.left),.5*(t[1]-i.bottom+i.top)):X1(e,t,.5)}const c7e=function(){const e=ui();return function(t,i,r){const n=i.targetGeometry;eL(e,n);const o=.5*ev(i);return t.xmin=e[0]-o*r[0],t.ymin=e[1]-o*r[1],t.xmax=e[0]+o*r[0],t.ymax=e[1]+o*r[1],t.spatialReference=n.spatialReference,t}}();function u7e(e,t,i,r,n){return sL(e,t,i.center),e.scale=Z2(i,r),n&&n.constraints&&n.constraints.constrain(e),e}function h7e(e,t,i,r){return nL(e,t,i,r),HM(e,e)}const SQ=function(){const e=ui();return function(t,i,r){return nI(t,y7e(t,i),l7e(e,i,r))}}(),p7e=function(){const e=ku(),t=ui();return function(i,r,n,o){const c=ev(r),h=iL(r);return Cs(t,c,c),eX(e,t),j2(e,e,h),U1(e,e,SQ(t,n,o)),U1(e,e,[0,o.top-o.bottom]),Cs(i,e[4],e[5])}}();function ev(e){return e.scale*d7e(e.targetGeometry)}function d7e(e){return H(e)&&Sn(e.spatialReference)?1/(xQ(e.spatialReference)*wQ*bQ):1}function iL(e){return C6(e.rotation)||0}function f7e(e){return Sn(e)?xQ(e)*wQ*bQ:1}function y7e(e,t){return X1(e,t,.5)}const rL=function(){const e=ui(),t=ui(),i=ui();return function(r,n,o,c,h,m){return uQ(e,n),X1(t,o,.5*m),Cs(i,1/c*m,-1/c*m),OP(r,t),h&&j2(r,r,h),WM(r,r,i),U1(r,r,e),r}}(),nL=function(){const e=ui();return function(t,i,r,n){const o=ev(i),c=iL(i);return eL(e,i.targetGeometry),rL(t,e,r,o,c,n)}}(),m7e=function(){const e=ui();return function(t,i,r,n){const o=ev(i);return eL(e,i.targetGeometry),rL(t,e,r,o,0,n)}}();function g7e(e){const t=Wo(e);return t?t.valid[1]-t.valid[0]:0}function v7e(e,t){return Math.round(g7e(e)/t)}const b7e=function(){const e=ui(),t=ui(),i=[0,0,0];return function(r,n,o){Jr(e,r,n),iI(e,e),Jr(t,r,o),iI(t,t),YP(i,e,t);let c=Math.acos(np(e,t)/(J2(e)*J2(t)))*s7e;return i[2]<0&&(c=-c),isNaN(c)&&(c=0),c}}(),w7e=function(){const e=ui();return function(t,i,r,n){const o=t.targetGeometry;return Cc(t,i),p7e(e,i,r,n),o.x+=e[0],o.y+=e[1],t}}(),sL=function(e,t,i){Cc(e,t);const r=e.targetGeometry;return r.x=i.x,r.y=i.y,r.spatialReference=i.spatialReference,e},_7e=function(){const e=ui();return function(t,i,r,n,o){o||(o="center"),nI(e,r,n),X1(e,e,.5);const c=e[0],h=e[1];switch(o){case"center":Cs(e,0,0);break;case"left":Cs(e,-c,0);break;case"top":Cs(e,0,h);break;case"right":Cs(e,c,0);break;case"bottom":Cs(e,0,-h);break;case"top-left":Cs(e,-c,h);break;case"bottom-left":Cs(e,-c,-h);break;case"top-right":Cs(e,c,h);break;case"bottom-right":Cs(e,c,-h)}return sI(t,i,e),t}}();function xKe(e,t,i){return Cc(e,t),e.rotation+=i,e}function x7e(e,t,i){return Cc(e,t),e.rotation=i,e}const S7e=function(){const e=ui();return function(t,i,r,n,o){return Cc(t,i),isNaN(r)||r===0||($Q(e,n,i,o),t.scale=i.scale*r,EQ(e,e,t,o),sI(t,t,Cs(e,e[0]-n[0],n[1]-e[1]))),t}}();function MQ(e,t,i){return Cc(e,t),e.scale=i,e}const IQ=function(){const e=ui();return function(t,i,r,n,o,c){return Cc(t,i),isNaN(r)||r===0||($Q(e,o,i,c),t.scale=i.scale*r,t.rotation+=n,EQ(e,e,t,c),sI(t,t,Cs(e,e[0]-o[0],o[1]-e[1]))),t}}(),SKe=function(){const e=ui(),t=ui();return function(i,r,n,o,c,h,m){return SQ(t,h,m),KP(e,c,t),o?IQ(i,r,n,o,e,h):S7e(i,r,n,e,h)}}(),$Q=function(){const e=ku();return function(t,i,r,n){return Au(t,i,h7e(e,r,n,1))}}(),EQ=function(){const e=ku();return function(t,i,r,n){return Au(t,i,nL(e,r,n,1))}}(),sI=function(){const e=ui(),t=ku();return function(i,r,n){Cc(i,r);const o=ev(r),c=i.targetGeometry;return QY(t,iL(r)),WM(t,t,sp(o,o)),Au(e,n,t),c.x+=e[0],c.y+=e[1],i}}();class M7e{constructor(t,i,r,n){const o=t.targetGeometry,c=i.targetGeometry;n?typeof n=="string"&&(n=Lke(n)||Ml.ease):n=Ml.ease,this.easing=n,this.duration=r,this.sCenterX=o.x,this.sCenterY=o.y,this.sScale=t.scale,this.sRotation=t.rotation,this.tCenterX=c.x,this.tCenterY=c.y,this.tScale=i.scale,this.tRotation=i.rotation,this.dCenterX=this.tCenterX-this.sCenterX,this.dCenterY=this.tCenterY-this.sCenterY,this.dScale=this.tScale-this.sScale,this.dRotation=this.tRotation-this.sRotation,this.dRotation>180?this.dRotation-=360:this.dRotation<-180&&(this.dRotation+=360)}applyRatio(t,i){const r=this.easing(i);let n,o,c,h;i>=1?(n=this.tCenterX,o=this.tCenterY,c=this.tRotation,h=this.tScale):(n=this.sCenterX+r*this.dCenterX,o=this.sCenterY+r*this.dCenterY,c=this.sRotation+r*this.dRotation,h=this.sScale+r*this.dScale),t.targetGeometry.x=n,t.targetGeometry.y=o,t.scale=h,t.rotation=c}}let op=class extends Ye{constructor(e){super(e),this.duration=200,this.transition=null,this.easing=Ml.ease,this.view=null,this.viewpoint=null,this.viewpoint=new ra({targetGeometry:new pt,scale:0,rotation:0}),this._updateTask=tg({postRender:this._postRender.bind(this)}),this._updateTask.pause()}destroy(){this._updateTask.remove(),this._updateTask=null}animate(e,t,i){this.stop();const r=this.viewpoint;Cc(r,t),this.transition=new M7e(this.viewpoint,e.target,i&&i.duration||this.duration,i&&i.easing||this.easing);const n=()=>{this.animation===e&&this._updateTask&&(e.state==="finished"&&(this.transition.applyRatio(this.viewpoint,1),this.view.state&&(this.view.state.viewpoint=this.viewpoint.clone())),this.animation=null,this.updateFunction=null)};return e.when(n,n),this._startTime=performance.now(),this._updateTask.resume(),this.animation=e,e}animateContinous(e,t){this.stop(),this.updateFunction=t,this.viewpoint=e;const i=new ZP({target:e.clone()}),r=()=>{this.animation===i&&this._updateTask&&(this.animation=null,this.updateFunction=null)};return i.when(r,r),this._startTime=performance.now(),this._updateTask.resume(),this.animation=i,i}stop(){this.animation&&(this.animation.stop(),this.animation=null,this.updateFunction=null)}_postRender(e){const t=this.animation;if(t&&t.state!==ZP.State.STOPPED){if(this.updateFunction)this.updateFunction(this.viewpoint,e.deltaTime);else{const i=(performance.now()-this._startTime)/this.transition.duration,r=i>=1;this.transition.applyRatio(this.viewpoint,i),r&&this.animation.finish()}this.view.state&&(this.view.state.viewpoint=this.viewpoint.clone())}else this._updateTask.pause()}};g([w()],op.prototype,"animation",void 0),g([w()],op.prototype,"duration",void 0),g([w()],op.prototype,"transition",void 0),g([w()],op.prototype,"easing",void 0),g([w()],op.prototype,"view",void 0),g([w()],op.prototype,"viewpoint",void 0),op=g([te("esri.views.2d.AnimationManager")],op);const I7e=op;class $7e{constructor(t){this.view=t,this._frameTaskHandle=null,this._updateRequested=!1,this.stationary=!0,this.animationInProgress=!1,this.prepare=()=>{this._updateParameters.state=this.view.state,this._updateParameters.stationary=this.view.stationary,this._updateParameters.pixelRatio=window.devicePixelRatio,this._updateParameters.renderingOptions=this.view.renderingOptions},this.update=()=>{this._updateRequested=!1;const{basemapView:i,graphicsView:r,labelManager:n,layerViews:o,state:{id:c}}=this.view;i.baseLayerViews.forEach(this._updateLayerView,this),o.forEach(this._updateLayerView,this),i.referenceLayerViews.forEach(this._updateLayerView,this),H(n)&&(n.lastUpdateId!==c&&(n.viewChange(),n.lastUpdateId=c),n.updateRequested&&n.processUpdate(this._updateParameters)),H(r)&&(r.lastUpdateId!==c&&(r.viewChange(),r.lastUpdateId=c),r.updateRequested&&r.processUpdate(this._updateParameters)),this.view.graphicsTileStore.setViewState(this._updateParameters.state),this.animationInProgress||this._updateRequested||this._frameTaskHandle.pause()}}destroy(){this.stop()}start(){if(this._frameTaskHandle)return;const t=this.view;this.stationary=t.stationary,this._updateParameters={state:t.state,pixelRatio:window.devicePixelRatio,stationary:this.stationary,renderingOptions:t.renderingOptions},this._stationaryHandle=we(()=>t.stationary,i=>{this.stationary=i,this.requestFrame()}),this._frameTaskHandle=tg(this),this.requestUpdate()}stop(){this._frameTaskHandle&&(this._updateRequested=!1,this._stationaryHandle.remove(),this._frameTaskHandle.remove(),this._updateParameters=this._stationaryHandle=this._frameTaskHandle=null,this.stationary=!0,this.animationInProgress=!1)}requestUpdate(){this._updateRequested||(this._updateRequested=!0,this.requestFrame())}requestFrame(){this._frameTaskHandle&&this._frameTaskHandle.resume()}_updateLayerView(t){const i=this.view.state,r=t.lastUpdateId;r!=null&&(this.stationary||t.moving)||(t.moving=!0,t.moveStart()),r!==i.id&&t.viewChange(),this.stationary&&t.moving&&(t.moving=!1,t.moveEnd()),t.lastUpdateId=i.id,t.updateRequested&&t.processUpdate(this._updateParameters),"layerViews"in t&&t.layerViews.forEach(this._updateLayerView,this)}}function Gn(){return Promise.all([import("./webglDeps.9ae9abe1.js"),import("./mapViewDeps.8acf05a2.js")])}const Y2=()=>Gn().then(()=>import("./TileLayerView2D.d8fea94a.js")),X2=()=>Gn().then(()=>import("./FeatureLayerView2D.3354b6cc.js")),TQ={"base-dynamic":()=>Gn().then(()=>import("./BaseDynamicLayerView2D.ededee94.js")),"base-tile":Y2,"bing-maps":Y2,csv:X2,"geo-rss":()=>Gn().then(()=>import("./GeoRSSLayerView2D.4918557f.js")),feature:X2,geojson:X2,graphics:()=>Gn().then(()=>import("./GraphicsLayerView2D.02aff08d.js")),group:()=>Gn().then(()=>import("./GroupLayerView2D.9368fb6b.js")),imagery:()=>Gn().then(()=>import("./ImageryLayerView2D.7fb03a62.js")),"imagery-tile":()=>Gn().then(()=>import("./ImageryTileLayerView2D.4f606f06.js")),kml:()=>Gn().then(()=>import("./KMLLayerView2D.4d375dae.js")),"map-image":()=>Gn().then(()=>import("./MapImageLayerView2D.cd464e85.js")),"map-notes":()=>Gn().then(()=>import("./MapNotesLayerView2D.ebb74a27.js")),media:()=>Gn().then(()=>import("./MediaLayerView2D.3297a2c6.js")),"ogc-feature":()=>Gn().then(()=>import("./OGCFeatureLayerView2D.7bfb32ef.js")),"open-street-map":Y2,"oriented-imagery":X2,route:()=>Gn().then(()=>import("./RouteLayerView2D.363e1a3e.js")),stream:()=>Gn().then(()=>import("./StreamLayerView2D.d97cc0e7.js")),"subtype-group":()=>Gn().then(()=>import("./SubtypeGroupLayerView2D.13426a66.js")),tile:Y2,"vector-tile":()=>Gn().then(()=>import("./VectorTileLayerView2D.1bb7c308.js")),wcs:()=>Gn().then(()=>import("./ImageryTileLayerView2D.4f606f06.js")),"web-tile":Y2,wfs:X2,wms:()=>Gn().then(()=>import("./WMSLayerView2D.9f98be8e.js")),wmts:()=>Gn().then(()=>import("./WMTSLayerView2D.6ebe9e63.js")),"line-of-sight":null,"base-elevation":null,"building-scene":null,dimension:null,elevation:null,"integrated-mesh":null,"point-cloud":null,voxel:null,scene:null,unknown:null,unsupported:null};function E7e(e){const t=e.declaredClass?e.declaredClass.slice(e.declaredClass.lastIndexOf(".")+1):"Unknown",i=t.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase();return new ue(`${i}:view-not-supported`,`${t} is not supported in 2D`)}const CQ={hasLayerViewModule:e=>H(TQ[e.type]),importLayerView:e=>{const t=TQ[e.type];if(ce(t))throw E7e(e);return t(e)}};function T7e(e,t){const{spatialReference:i}=t,r=[t.x,t.y];let n=Number.POSITIVE_INFINITY,o=0,c=0;const h=[0,0],m=e.type==="extent"?[[[e.xmin,e.ymin],[e.xmin,e.ymax],[e.xmax,e.ymax],[e.xmax,e.ymin],[e.xmin,e.ymin]]]:e.rings;for(const b of m)for(let x=0;x<b.length-1;x++){Qme(h,r,b,x);const I=rp(r,h);I<n&&(n=I,o=h[0],c=h[1])}return{coordinate:new pt({x:o,y:c,spatialReference:i}),distance:n}}var oL;let Jy=oL=class extends _6(Ye){constructor(e){super(e),this.geometry=null,this.spatialReference=null}get normalizedGeometry(){if(ce(this.geometry)||!this.spatialReference)return null;if(!this.spatialReference.equals(this.geometry.spatialReference))try{return Da(this.geometry,this.spatialReference)}catch(e){return $e.getLogger(this.declaredClass).error("#constraints.geometry","could not project the geometry to the view's spatial reference",{geometry:this.geometry,spatialReference:this.spatialReference,error:e}),null}return this.geometry}constrain(e,t){if(ce(this.normalizedGeometry))return e;const i=e.targetGeometry;if(this.normalizedGeometry.type==="extent"?RS(this.normalizedGeometry,i):nz(this.normalizedGeometry,i))return e;const{coordinate:r}=T7e(this.normalizedGeometry,i);return r&&(e.targetGeometry=r),e}clone(){var e,t;return new oL({geometry:(e=this.geometry)==null?void 0:e.clone(),spatialReference:(t=this.spatialReference)==null?void 0:t.clone()})}};g([w({constructOnly:!0})],Jy.prototype,"geometry",void 0),g([w({readOnly:!0})],Jy.prototype,"normalizedGeometry",null),g([w({constructOnly:!0})],Jy.prototype,"spatialReference",void 0),Jy=oL=g([te("esri.views.2d.constraints.GeometryConstraint")],Jy);var aL;let Q2=aL=class extends _6(Ye){constructor(){super(...arguments),this.enabled=!0,this.rotationEnabled=!0}constrain(e,t){return this.enabled&&t&&(this.rotationEnabled||(e.rotation=t.rotation)),e}clone(){return new aL({enabled:this.enabled,rotationEnabled:this.rotationEnabled})}};g([w()],Q2.prototype,"enabled",void 0),g([w()],Q2.prototype,"rotationEnabled",void 0),Q2=aL=g([te("esri.views.2d.constraints.RotationConstraint")],Q2);const kQ=Q2;var lL;let ga=lL=class extends _6(Ye){constructor(e){super(e),this._lodByScale={},this._scales=[],this.effectiveLODs=null,this.effectiveMinZoom=-1,this.effectiveMaxZoom=-1,this.effectiveMinScale=0,this.effectiveMaxScale=0,this.lods=null,this.minZoom=-1,this.maxZoom=-1,this.minScale=0,this.maxScale=0,this.snapToZoom=!0}initialize(){let e,{lods:t,minScale:i,maxScale:r,minZoom:n,maxZoom:o}=this,c=-1,h=-1,m=!1,b=!1;if(i!==0&&r!==0&&i<r&&([i,r]=[r,i]),!t||!t.length)return this._set("effectiveMinScale",i),void this._set("effectiveMaxScale",r);t=t.map(x=>x.clone()),t.sort((x,I)=>I.scale-x.scale),t.forEach((x,I)=>x.level=I);for(const x of t)!m&&i>0&&i>=x.scale&&(c=x.level,m=!0),!b&&r>0&&r>=x.scale&&(h=e?e.level:-1,b=!0),e=x;n===-1&&(n=i===0?0:c),o===-1&&(o=r===0?t.length-1:h),n=Math.max(n,0),n=Math.min(n,t.length-1),o=Math.max(o,0),o=Math.min(o,t.length-1),n>o&&([n,o]=[o,n]),i=t[n].scale,r=t[o].scale,t.splice(0,n),t.splice(o-n+1,t.length),t.forEach((x,I)=>{this._lodByScale[x.scale]=x,this._scales[I]=x.scale}),this._set("effectiveLODs",t),this._set("effectiveMinZoom",n),this._set("effectiveMaxZoom",o),this._set("effectiveMinScale",i),this._set("effectiveMaxScale",r)}constrain(e,t){if(t&&e.scale===t.scale)return e;const i=this.effectiveMinScale,r=this.effectiveMaxScale,n=e.targetGeometry,o=t&&t.targetGeometry,c=r!==0&&e.scale<r,h=i!==0&&e.scale>i;if(c||h){const m=h?i:r;if(t&&o){const b=(m-t.scale)/(e.scale-t.scale);n.x=o.x+(n.x-o.x)*b,n.y=o.y+(n.y-o.y)*b}e.scale=m}return this.snapToZoom&&this.effectiveLODs&&(e.scale=this._getClosestScale(e.scale)),e}fit(e){if(!this.effectiveLODs||!this.snapToZoom)return this.constrain(e,null);const t=this.scaleToZoom(e.scale),i=Math.abs(t-Math.floor(t));return e.scale=this.zoomToScale(i>.99?Math.round(t):Math.floor(t)),e}zoomToScale(e){if(!this.effectiveLODs)return 0;e-=this.effectiveMinZoom,e=Math.max(0,e);const t=this._scales;if(e<=0)return t[0];if(e>=t.length)return t[t.length-1];const i=Math.round(e-.5),r=Math.round(e);return t[r]+(r-e)*(t[i]-t[r])}scaleToZoom(e){if(!this.effectiveLODs)return-1;const t=this._scales;let i,r;if(e>=t[0])return this.effectiveMinZoom;if(e<=t[t.length-1])return this.effectiveMaxZoom;for(let n=0;n<t.length-1;n++){if(i=t[n],r=t[n+1],r===e)return n+this.effectiveMinZoom+1;if(i>e&&r<e)return n+this.effectiveMinZoom+1-(e-r)/(i-r)}return-1}snapToClosestScale(e){if(!this.effectiveLODs)return e;const t=this.scaleToZoom(e);return this.zoomToScale(Math.round(t))}snapToNextScale(e,t=.5){if(!this.effectiveLODs)return e*t;const i=Math.round(this.scaleToZoom(e));return this.zoomToScale(i+1)}snapToPreviousScale(e,t=2){if(!this.effectiveLODs)return e*t;const i=Math.round(this.scaleToZoom(e));return this.zoomToScale(i-1)}clone(){return new lL({lods:this.lods,minZoom:this.minZoom,maxZoom:this.maxZoom,minScale:this.minScale,maxScale:this.maxScale})}_getClosestScale(e){return this._lodByScale[e]||(e=this._scales.reduce((t,i)=>Math.abs(i-e)<=Math.abs(t-e)?i:t,this._scales[0])),this._lodByScale[e].scale}};g([w({readOnly:!0})],ga.prototype,"effectiveLODs",void 0),g([w({readOnly:!0})],ga.prototype,"effectiveMinZoom",void 0),g([w({readOnly:!0})],ga.prototype,"effectiveMaxZoom",void 0),g([w({readOnly:!0})],ga.prototype,"effectiveMinScale",void 0),g([w({readOnly:!0})],ga.prototype,"effectiveMaxScale",void 0),g([w()],ga.prototype,"lods",void 0),g([w()],ga.prototype,"minZoom",void 0),g([w()],ga.prototype,"maxZoom",void 0),g([w()],ga.prototype,"minScale",void 0),g([w()],ga.prototype,"maxScale",void 0),g([w()],ga.prototype,"snapToZoom",void 0),ga=lL=g([te("esri.views.2d.constraints.ZoomConstraint")],ga);const AQ=ga,C7e={base:null,key:"type",typeMap:{extent:gi,polygon:es}};let vn=class extends Ye{constructor(e){super(e),this.lods=null,this.minScale=0,this.maxScale=0,this.minZoom=-1,this.maxZoom=-1,this.rotationEnabled=!0,this.snapToZoom=!0}destroy(){this.view=null}get effectiveLODs(){return this._zoom.effectiveLODs}get effectiveMinScale(){return this._zoom.effectiveMinScale}get effectiveMaxScale(){return this._zoom.effectiveMaxScale}get effectiveMinZoom(){return this._zoom.effectiveMinZoom}get effectiveMaxZoom(){return this._zoom.effectiveMaxZoom}set geometry(e){e?this._set("geometry",e):this._set("geometry",null)}get version(){var e,t,i;return`${(e=this._zoom)==null?void 0:e.uid}/${(t=this._rotation)==null?void 0:t.uid}/${(i=this._geometry)==null?void 0:i.uid}`}get _defaultLODs(){var i,r,n;const e=(r=(i=this.view)==null?void 0:i.defaultsFromMap)==null?void 0:r.tileInfo,t=(n=this.view)==null?void 0:n.spatialReference;return e&&t&&e.spatialReference.equals(t)?e.lods:null}get _geometry(){var e;return new Jy({geometry:this.geometry,spatialReference:(e=this.view)==null?void 0:e.spatialReference})}get _rotation(){return new kQ({rotationEnabled:this.rotationEnabled})}get _zoom(){const e=this._get("_zoom"),t=this.lods||this._defaultLODs,i=this.minZoom,r=this.maxZoom,n=this.minScale,o=this.maxScale,c=this.snapToZoom;return e&&e.lods===t&&e.minZoom===i&&e.maxZoom===r&&e.minScale===n&&e.maxScale===o&&e.snapToZoom===c?e:new AQ({lods:t,minZoom:i,maxZoom:r,minScale:n,maxScale:o,snapToZoom:c})}canZoomInTo(e){const t=this.effectiveMaxScale;return t===0||e>=t}canZoomOutTo(e){const t=this.effectiveMinScale;return t===0||e<=t}constrain(e,t){return this._zoom.constrain(e,t),this._rotation.constrain(e,t),this._geometry.constrain(e,t),e}constrainByGeometry(e){return this._geometry.constrain(e)}fit(e){return this._zoom.fit(e)}zoomToScale(e){return this._zoom.zoomToScale(e)}scaleToZoom(e){return this._zoom.scaleToZoom(e)}snapScale(e){return this._zoom.snapToClosestScale(e)}snapToNextScale(e){return this._zoom.snapToNextScale(e)}snapToPreviousScale(e){return this._zoom.snapToPreviousScale(e)}};g([w({readOnly:!0})],vn.prototype,"effectiveLODs",null),g([w({readOnly:!0})],vn.prototype,"effectiveMinScale",null),g([w({readOnly:!0})],vn.prototype,"effectiveMaxScale",null),g([w({readOnly:!0})],vn.prototype,"effectiveMinZoom",null),g([w({readOnly:!0})],vn.prototype,"effectiveMaxZoom",null),g([w({types:C7e,value:null})],vn.prototype,"geometry",null),g([w({type:[zk]})],vn.prototype,"lods",void 0),g([w()],vn.prototype,"minScale",void 0),g([w()],vn.prototype,"maxScale",void 0),g([w()],vn.prototype,"minZoom",void 0),g([w()],vn.prototype,"maxZoom",void 0),g([w()],vn.prototype,"rotationEnabled",void 0),g([w()],vn.prototype,"snapToZoom",void 0),g([w()],vn.prototype,"view",void 0),g([w({readOnly:!0})],vn.prototype,"version",null),g([w()],vn.prototype,"_defaultLODs",null),g([w({type:Jy})],vn.prototype,"_geometry",null),g([w({type:kQ})],vn.prototype,"_rotation",null),g([w({readOnly:!0,type:AQ})],vn.prototype,"_zoom",null),vn=g([te("esri.views.2d.MapViewConstraints")],vn);const PQ=vn;function k7e(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[4],e[4]=t[5],e[5]=t[6],e[6]=t[8],e[7]=t[9],e[8]=t[10],e}function A7e(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e}function LQ(e,t,i,r,n,o,c,h,m,b){return e[0]=t,e[1]=i,e[2]=r,e[3]=n,e[4]=o,e[5]=c,e[6]=h,e[7]=m,e[8]=b,e}function OQ(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e}function P7e(e,t){if(e===t){const i=t[1],r=t[2],n=t[5];e[1]=t[3],e[2]=t[6],e[3]=i,e[5]=t[7],e[6]=r,e[7]=n}else e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8];return e}function L7e(e,t){const i=t[0],r=t[1],n=t[2],o=t[3],c=t[4],h=t[5],m=t[6],b=t[7],x=t[8],I=x*c-h*b,E=-x*o+h*m,k=b*o-c*m;let P=i*I+r*E+n*k;return P?(P=1/P,e[0]=I*P,e[1]=(-x*r+n*b)*P,e[2]=(h*r-n*c)*P,e[3]=E*P,e[4]=(x*i-n*m)*P,e[5]=(-h*i+n*o)*P,e[6]=k*P,e[7]=(-b*i+r*m)*P,e[8]=(c*i-r*o)*P,e):null}function O7e(e,t){const i=t[0],r=t[1],n=t[2],o=t[3],c=t[4],h=t[5],m=t[6],b=t[7],x=t[8];return e[0]=c*x-h*b,e[1]=n*b-r*x,e[2]=r*h-n*c,e[3]=h*m-o*x,e[4]=i*x-n*m,e[5]=n*o-i*h,e[6]=o*b-c*m,e[7]=r*m-i*b,e[8]=i*c-r*o,e}function R7e(e){const t=e[0],i=e[1],r=e[2],n=e[3],o=e[4],c=e[5],h=e[6],m=e[7],b=e[8];return t*(b*o-c*m)+i*(-b*n+c*h)+r*(m*n-o*h)}function cL(e,t,i){const r=t[0],n=t[1],o=t[2],c=t[3],h=t[4],m=t[5],b=t[6],x=t[7],I=t[8],E=i[0],k=i[1],P=i[2],F=i[3],N=i[4],B=i[5],z=i[6],q=i[7],J=i[8];return e[0]=E*r+k*c+P*b,e[1]=E*n+k*h+P*x,e[2]=E*o+k*m+P*I,e[3]=F*r+N*c+B*b,e[4]=F*n+N*h+B*x,e[5]=F*o+N*m+B*I,e[6]=z*r+q*c+J*b,e[7]=z*n+q*h+J*x,e[8]=z*o+q*m+J*I,e}function uL(e,t,i){const r=t[0],n=t[1],o=t[2],c=t[3],h=t[4],m=t[5],b=t[6],x=t[7],I=t[8],E=i[0],k=i[1];return e[0]=r,e[1]=n,e[2]=o,e[3]=c,e[4]=h,e[5]=m,e[6]=E*r+k*c+b,e[7]=E*n+k*h+x,e[8]=E*o+k*m+I,e}function RQ(e,t,i){const r=t[0],n=t[1],o=t[2],c=t[3],h=t[4],m=t[5],b=t[6],x=t[7],I=t[8],E=Math.sin(i),k=Math.cos(i);return e[0]=k*r+E*c,e[1]=k*n+E*h,e[2]=k*o+E*m,e[3]=k*c-E*r,e[4]=k*h-E*n,e[5]=k*m-E*o,e[6]=b,e[7]=x,e[8]=I,e}function F7e(e,t,i){const r=i[0],n=i[1],o=i[2];return e[0]=r*t[0],e[1]=r*t[1],e[2]=r*t[2],e[3]=n*t[3],e[4]=n*t[4],e[5]=n*t[5],e[6]=o*t[6],e[7]=o*t[7],e[8]=o*t[8],e}function N7e(e,t,i){const r=i[0],n=i[1];return e[0]=r*t[0],e[1]=r*t[1],e[2]=r*t[2],e[3]=n*t[3],e[4]=n*t[4],e[5]=n*t[5],e}function D7e(e,t){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=t[0],e[7]=t[1],e[8]=1,e}function j7e(e,t){const i=Math.sin(t),r=Math.cos(t);return e[0]=r,e[1]=i,e[2]=0,e[3]=-i,e[4]=r,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e}function V7e(e,t){return e[0]=t[0],e[1]=0,e[2]=0,e[3]=0,e[4]=t[1],e[5]=0,e[6]=0,e[7]=0,e[8]=1,e}function z7e(e,t){return e[0]=t[0],e[1]=t[1],e[2]=0,e[3]=t[2],e[4]=t[3],e[5]=0,e[6]=t[4],e[7]=t[5],e[8]=1,e}function G7e(e,t){const i=t[0],r=t[1],n=t[2],o=t[3],c=i+i,h=r+r,m=n+n,b=i*c,x=r*c,I=r*h,E=n*c,k=n*h,P=n*m,F=o*c,N=o*h,B=o*m;return e[0]=1-I-P,e[3]=x-B,e[6]=E+N,e[1]=x+B,e[4]=1-b-P,e[7]=k-F,e[2]=E-N,e[5]=k+F,e[8]=1-b-I,e}function B7e(e,t){const i=t[0],r=t[1],n=t[2],o=t[4],c=t[5],h=t[6],m=t[8],b=t[9],x=t[10],I=x*c-h*b,E=-x*o+h*m,k=b*o-c*m,P=i*I+r*E+n*k;if(!P)return null;const F=1/P;return e[0]=I*F,e[1]=(-x*r+n*b)*F,e[2]=(h*r-n*c)*F,e[3]=E*F,e[4]=(x*i-n*m)*F,e[5]=(-h*i+n*o)*F,e[6]=k*F,e[7]=(-b*i+r*m)*F,e[8]=(c*i-r*o)*F,e}function U7e(e,t){const i=t[0],r=t[1],n=t[2],o=t[3],c=t[4],h=t[5],m=t[6],b=t[7],x=t[8],I=t[9],E=t[10],k=t[11],P=t[12],F=t[13],N=t[14],B=t[15],z=i*h-r*c,q=i*m-n*c,J=i*b-o*c,X=r*m-n*h,Y=r*b-o*h,ae=n*b-o*m,he=x*F-I*P,fe=x*N-E*P,ye=x*B-k*P,xe=I*N-E*F,Se=I*B-k*F,Ae=E*B-k*N;let Oe=z*Ae-q*Se+J*xe+X*ye-Y*fe+ae*he;return Oe?(Oe=1/Oe,e[0]=(h*Ae-m*Se+b*xe)*Oe,e[1]=(m*ye-c*Ae-b*fe)*Oe,e[2]=(c*Se-h*ye+b*he)*Oe,e[3]=(n*Se-r*Ae-o*xe)*Oe,e[4]=(i*Ae-n*ye+o*fe)*Oe,e[5]=(r*ye-i*Se-o*he)*Oe,e[6]=(F*ae-N*Y+B*X)*Oe,e[7]=(N*J-P*ae-B*q)*Oe,e[8]=(P*Y-F*J+B*z)*Oe,e):null}function q7e(e,t,i){return e[0]=2/t,e[1]=0,e[2]=0,e[3]=0,e[4]=-2/i,e[5]=0,e[6]=-1,e[7]=1,e[8]=1,e}function H7e(e){return"mat3("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+", "+e[8]+")"}function W7e(e){return Math.sqrt(e[0]**2+e[1]**2+e[2]**2+e[3]**2+e[4]**2+e[5]**2+e[6]**2+e[7]**2+e[8]**2)}function J7e(e,t,i){return e[0]=t[0]+i[0],e[1]=t[1]+i[1],e[2]=t[2]+i[2],e[3]=t[3]+i[3],e[4]=t[4]+i[4],e[5]=t[5]+i[5],e[6]=t[6]+i[6],e[7]=t[7]+i[7],e[8]=t[8]+i[8],e}function FQ(e,t,i){return e[0]=t[0]-i[0],e[1]=t[1]-i[1],e[2]=t[2]-i[2],e[3]=t[3]-i[3],e[4]=t[4]-i[4],e[5]=t[5]-i[5],e[6]=t[6]-i[6],e[7]=t[7]-i[7],e[8]=t[8]-i[8],e}function Z7e(e,t,i){return e[0]=t[0]*i,e[1]=t[1]*i,e[2]=t[2]*i,e[3]=t[3]*i,e[4]=t[4]*i,e[5]=t[5]*i,e[6]=t[6]*i,e[7]=t[7]*i,e[8]=t[8]*i,e}function K7e(e,t,i,r){return e[0]=t[0]+i[0]*r,e[1]=t[1]+i[1]*r,e[2]=t[2]+i[2]*r,e[3]=t[3]+i[3]*r,e[4]=t[4]+i[4]*r,e[5]=t[5]+i[5]*r,e[6]=t[6]+i[6]*r,e[7]=t[7]+i[7]*r,e[8]=t[8]+i[8]*r,e}function Y7e(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]&&e[4]===t[4]&&e[5]===t[5]&&e[6]===t[6]&&e[7]===t[7]&&e[8]===t[8]}function X7e(e,t){const i=e[0],r=e[1],n=e[2],o=e[3],c=e[4],h=e[5],m=e[6],b=e[7],x=e[8],I=t[0],E=t[1],k=t[2],P=t[3],F=t[4],N=t[5],B=t[6],z=t[7],q=t[8],J=Zo();return Math.abs(i-I)<=J*Math.max(1,Math.abs(i),Math.abs(I))&&Math.abs(r-E)<=J*Math.max(1,Math.abs(r),Math.abs(E))&&Math.abs(n-k)<=J*Math.max(1,Math.abs(n),Math.abs(k))&&Math.abs(o-P)<=J*Math.max(1,Math.abs(o),Math.abs(P))&&Math.abs(c-F)<=J*Math.max(1,Math.abs(c),Math.abs(F))&&Math.abs(h-N)<=J*Math.max(1,Math.abs(h),Math.abs(N))&&Math.abs(m-B)<=J*Math.max(1,Math.abs(m),Math.abs(B))&&Math.abs(b-z)<=J*Math.max(1,Math.abs(b),Math.abs(z))&&Math.abs(x-q)<=J*Math.max(1,Math.abs(x),Math.abs(q))}function Q7e(e){const t=Zo(),i=e[0],r=e[1],n=e[2],o=e[3],c=e[4],h=e[5],m=e[6],b=e[7],x=e[8];return Math.abs(1-(i*i+o*o+m*m))<=t&&Math.abs(1-(r*r+c*c+b*b))<=t&&Math.abs(1-(n*n+h*h+x*x))<=t}const eAe=cL,tAe=FQ;Object.freeze(Object.defineProperty({__proto__:null,fromMat4:k7e,copy:A7e,set:LQ,identity:OQ,transpose:P7e,invert:L7e,adjoint:O7e,determinant:R7e,multiply:cL,translate:uL,rotate:RQ,scale:F7e,scaleByVec2:N7e,fromTranslation:D7e,fromRotation:j7e,fromScaling:V7e,fromMat2d:z7e,fromQuat:G7e,normalFromMat4Legacy:B7e,normalFromMat4:U7e,projection:q7e,str:H7e,frob:W7e,add:J7e,subtract:FQ,multiplyScalar:Z7e,multiplyScalarAndAdd:K7e,exactEquals:Y7e,equals:X7e,isOrthoNormal:Q7e,mul:eAe,sub:tAe},Symbol.toStringTag,{value:"Module"}));function oI(){const e=new Float32Array(9);return e[0]=1,e[4]=1,e[8]=1,e}function iAe(e){const t=new Float32Array(9);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t}function rAe(e,t,i,r,n,o,c,h,m){const b=new Float32Array(9);return b[0]=e,b[1]=t,b[2]=i,b[3]=r,b[4]=n,b[5]=o,b[6]=c,b[7]=h,b[8]=m,b}function nAe(e,t){return new Float32Array(e,t,9)}Object.freeze(Object.defineProperty({__proto__:null,create:oI,clone:iAe,fromValues:rAe,createView:nAe},Symbol.toStringTag,{value:"Module"}));function NQ(){return new Float32Array(2)}function sAe(e){const t=new Float32Array(2);return t[0]=e[0],t[1]=e[1],t}function tv(e,t){const i=new Float32Array(2);return i[0]=e,i[1]=t,i}function oAe(e,t){return new Float32Array(e,t,2)}function DQ(){return NQ()}function jQ(){return tv(1,1)}function VQ(){return tv(1,0)}function zQ(){return tv(0,1)}const aAe=DQ(),lAe=jQ(),cAe=VQ(),uAe=zQ();Object.freeze(Object.defineProperty({__proto__:null,create:NQ,clone:sAe,fromValues:tv,createView:oAe,zeros:DQ,ones:jQ,unitX:VQ,unitY:zQ,ZEROS:aAe,ONES:lAe,UNIT_X:cAe,UNIT_Y:uAe},Symbol.toStringTag,{value:"Module"}));function hAe(e){return e instanceof Float32Array&&e.length>=2}function pAe(e){return Array.isArray(e)&&e.length>=2}function hL(e){return hAe(e)||pAe(e)}var pL;const ap=[0,0];let xf=pL=class extends ke{constructor(e){super(e),this._viewpoint2D={center:ui(),rotation:0,scale:0,spatialReference:null},this.center=[0,0],this.extent=new gi,this.id=0,this.inverseTransform=ku(),this.resolution=0,this.rotation=0,this.scale=0,this.transform=ku(),this.transformNoRotation=ku(),this.displayMat3=oI(),this.displayViewMat3=oI(),this.viewMat3=oI(),this.viewMat2d=UM(),this.worldScreenWidth=0,this.size=[0,0]}set pixelRatio(e){this._set("pixelRatio",e),this._update()}set size(e){this._set("size",e),this._update()}set viewpoint(e){if(e){const t=this._viewpoint2D,i=e.targetGeometry;t.center[0]=i.x,t.center[1]=i.y,t.rotation=e.rotation,t.scale=e.scale,t.spatialReference=i.spatialReference}this._update()}copy(e){const t=this.size,i=this.viewpoint;return i&&t?(this.viewpoint=Cc(i,e.viewpoint),this._set("size",Y1(t,e.size))):(this.viewpoint=e.viewpoint.clone(),this._set("size",[e.size[0],e.size[1]])),this._set("pixelRatio",e.pixelRatio),this}clone(){return new pL({size:this.size,viewpoint:this.viewpoint.clone(),pixelRatio:this.pixelRatio})}toMap(e,t,i){return hL(t)?Au(e,t,this.inverseTransform):(ap[0]=t,ap[1]=i,Au(e,ap,this.inverseTransform))}toScreen(e,t,i){return hL(t)?Au(e,t,this.transform):(ap[0]=t,ap[1]=i,Au(e,ap,this.transform))}toScreenNoRotation(e,t,i){return hL(t)?Au(e,t,this.transformNoRotation):(ap[0]=t,ap[1]=i,Au(e,ap,this.transformNoRotation))}getScreenTransform(e,t){const{center:i}=this._viewpoint2D,r=this._get("pixelRatio")||1,n=this._get("size");return rL(e,i,n,t,0,r),e}_update(){const{center:e,spatialReference:t,scale:i,rotation:r}=this._viewpoint2D,n=this._get("pixelRatio")||1,o=this._get("size"),c=new ra({targetGeometry:new pt(e[0],e[1],t),scale:i,rotation:r});if(this._set("viewpoint",c),!o||!t||!i)return;this.resolution=ev(c),this.rotation=r,this.scale=i,this.spatialReference=t,Y1(this.center,e);const h=o[0]!==0?2/o[0]:0,m=o[1]!==0?-2/o[1]:0;LQ(this.displayMat3,h,0,0,0,m,0,-1,1,1);const b=OQ(this.viewMat3),x=tv(o[0]/2,o[1]/2),I=tv(-o[0]/2,-o[1]/2),E=C6(r);uL(b,b,x),RQ(b,b,E),uL(b,b,I),cL(this.displayViewMat3,this.displayMat3,b);const k=OP(this.viewMat2d,x);return j2(k,k,E),U1(k,k,I),c7e(this.extent,c,o),nL(this.transform,c,o,n),HM(this.inverseTransform,this.transform),m7e(this.transformNoRotation,c,o,n),this.worldScreenWidth=v7e(this.spatialReference,this.resolution),this._set("id",this.id+1),this}};g([w({readOnly:!0})],xf.prototype,"id",void 0),g([w({value:1,json:{write:!0}})],xf.prototype,"pixelRatio",null),g([w({json:{write:!0}})],xf.prototype,"size",null),g([w()],xf.prototype,"spatialReference",void 0),g([w({type:ra,json:{write:!0}})],xf.prototype,"viewpoint",null),xf=pL=g([te("esri.views.2d.ViewState")],xf);const GQ=xf;var dL,fL;let lp=dL=class extends Ye{constructor(){super(...arguments),this.left=0,this.top=0,this.right=0,this.bottom=0}clone(){return new dL({left:this.left,top:this.top,right:this.right,bottom:this.bottom})}};g([w()],lp.prototype,"left",void 0),g([w()],lp.prototype,"top",void 0),g([w()],lp.prototype,"right",void 0),g([w()],lp.prototype,"bottom",void 0),lp=dL=g([te("esri.views.2d.PaddedViewState.Padding")],lp);let iv=fL=class extends GQ{constructor(...e){super(...e),this.paddedViewState=new GQ,this._updateContent=(()=>{const t=ui();return()=>{const i=this._get("size"),r=this._get("padding");if(!i||!r)return;const n=this.paddedViewState;Cs(t,r.left+r.right,r.top+r.bottom),Jr(t,i,t),Y1(n.size,t);const o=n.viewpoint;o&&(this.viewpoint=o)}})(),this.addHandles(we(()=>[this.size,this.padding],()=>this._updateContent(),mu)),this.padding=new lp,this.size=[0,0]}set padding(e){this._set("padding",e||new lp)}set viewpoint(e){if(e){const t=e.clone();this.paddedViewState.viewpoint=e,w7e(t,e,this._get("size"),this._get("padding"));const i=this._viewpoint2D,r=t.targetGeometry;i.center[0]=r.x,i.center[1]=r.y,i.rotation=t.rotation,i.scale=t.scale,i.spatialReference=r.spatialReference,this._update()}}clone(){return new fL({padding:this.padding.clone(),size:this.size.slice(),viewpoint:this.paddedViewState.viewpoint.clone(),pixelRatio:this.pixelRatio})}};g([w()],iv.prototype,"paddedViewState",void 0),g([w({type:lp})],iv.prototype,"padding",null),g([w()],iv.prototype,"viewpoint",null),iv=fL=g([te("esri.views.2d.PaddedViewState")],iv);const dAe=iv;class fAe{constructor(t,i){this.item=t,this.controller=i,this.promise=null}}class BQ{constructor(t){this._deferreds=new Map,this._controllers=new Map,this._processingItems=new Map,this._isPaused=!1,this._schedule=null,this._task=null,this.concurrency=1,t.concurrency&&(this.concurrency=t.concurrency),this._queue=new q5(t.peeker),this.process=t.process;const i=t.scheduler;t.priority&&H(i)&&(this._task=i.registerTask(t.priority,this))}destroy(){this.clear(),this._schedule&&(this._schedule.remove(),this._schedule=null),this._task&&(this._task.remove(),this._task=null)}get length(){return this._processingItems.size+this._queue.length}abort(t){const i=this._controllers.get(t);i&&i.abort()}clear(){this._queue.clear();const t=[];this._controllers.forEach(i=>t.push(i)),this._controllers.clear(),t.forEach(i=>i.abort()),this._processingItems.clear(),this._cancelNext()}forEach(t){this._deferreds.forEach((i,r)=>t(r))}get(t){const i=this._deferreds.get(t);return i?i.promise:void 0}isOngoing(t){return this._processingItems.has(t)}has(t){return this._deferreds.has(t)}pause(){this._isPaused||(this._isPaused=!0,this._cancelNext())}push(t,i){const r=this.get(t);if(r)return r;const n=new AbortController;let o=null;i&&(o=Ho(i,()=>n.abort()));const c=()=>{const x=this._processingItems.get(t);x&&x.controller.abort(),h(),b.reject(Qi())},h=()=>{m.remove(),H(o)&&o.remove(),this._deferreds.delete(t),this._controllers.delete(t),this._queue.remove(t),this._processingItems.delete(t),this._scheduleNext()},m=hT(n.signal,c),b=fh();return this._deferreds.set(t,b),this._controllers.set(t,n),b.promise.then(h,h),this._queue.push(t),this._scheduleNext(),b.promise}last(){return this._queue.last()}peek(){return this._queue.peek()}popLast(){return this._queue.popLast()}reset(){const t=[];this._processingItems.forEach(i=>t.push(i)),this._processingItems.clear();for(const i of t)this._queue.push(i.item),i.controller.abort();this._scheduleNext()}resume(){this._isPaused&&(this._isPaused=!1,this._scheduleNext())}takeAll(){const t=[];for(;this._queue.length;)t.push(this._queue.pop());return this.clear(),t}get running(){return!this._isPaused&&this._queue.length>0&&this._processingItems.size<this.concurrency}runTask(t){for(;!t.done&&this._queue.length>0&&this._processingItems.size<this.concurrency;)this._process(this._queue.pop()),t.madeProgress()}_scheduleNext(){this._task||this._isPaused||this._schedule||(this._schedule=eg(()=>{this._schedule=null,this._next()}))}_next(){for(;this._queue.length>0&&this._processingItems.size<this.concurrency;)this._process(this._queue.pop())}_cancelNext(){this._schedule&&(this._schedule.remove(),this._schedule=null)}_processResult(t,i){this._canProcessFulfillment(t)&&(this._scheduleNext(),this._deferreds.get(t.item).resolve(i))}_processError(t,i){this._canProcessFulfillment(t)&&(this._scheduleNext(),this._deferreds.get(t.item).reject(i))}_canProcessFulfillment(t){return!!this._deferreds.get(t.item)&&this._processingItems.get(t.item)===t}_process(t){if(ce(t))return;let i;const r=new AbortController,n=new fAe(t,r);this._processingItems.set(t,n);try{i=this.process(t,r.signal)}catch(o){this._processError(n,o)}yh(i)?(n.promise=i,i.then(o=>this._processResult(n,o),o=>this._processError(n,o))):this._processResult(n,i)}get test(){return{update:t=>this.runTask(t)}}}function yAe(e,t){return e.length=0,t.forEach(i=>e.push(i)),e}const yL=new Set,aI=[],rv=new Map,UQ=[0,0];let Sf=class extends Ye{constructor(e){super(e),this._keyToItem=new Map,this.concurrency=6,this.strategy="scale-first",this.tileInfoView=null}initialize(){const{concurrency:e,process:t}=this;this._queue=new BQ({concurrency:e,process:(i,r)=>{const n=this._keyToItem.get(i);return t(n,{signal:r})},peeker:i=>i.values().next().value})}destroy(){this.clear(),this._queue=li(this._queue)}get length(){return this._queue?this._queue.length:0}get onGoingCount(){return this._keyToItem.size}get updating(){return this.length>0||this.onGoingCount>0}abort(e){const t=typeof e=="string"?e:e.id;this._queue.abort(t)}clear(){this._queue.clear(),this._keyToItem.clear(),this.notifyChange("updating")}has(e){return typeof e=="string"?this._keyToItem.has(e):this._keyToItem.has(e.id)}isOngoing(e){const t=typeof e=="string"?e:e.id;return this.has(t)&&this._queue.isOngoing(t)}pause(){this._queue.pause()}push(e,t){const i=e.key.id+"-"+t;if(this.has(i))return this.get(i);const r=this._queue.push(i),n=()=>{this._keyToItem.delete(i),this.notifyChange("updating")};return this._keyToItem.set(i,e),r.then(n,n),this.notifyChange("updating"),r}reset(){this._queue.reset(),this.notifyChange("updating")}resume(){this._queue.resume()}_peekByScaleFirst(e){if(!this.state)return e.values().next().value;const t=this.tileInfoView;let i=Number.NEGATIVE_INFINITY,r=Number.POSITIVE_INFINITY;e.forEach(b=>{const x=this._keyToItem.get(b),I=this.tileInfoView.getTileScale(x.key);rv.has(I)||(rv.set(I,[]),i=Math.max(I,i),r=Math.min(I,r)),rv.get(I).push(x.key),yL.add(I)});let n=this.state.scale;rv.has(n)||(yAe(aI,yL),aI.sort((b,x)=>b-x),n=aI.reduce((b,x)=>Math.abs(x-n)<Math.abs(b-n)?x:b,aI[0])),n=Math.min(n,i),n=Math.max(n,r);const o=rv.get(n),c=t.getClosestInfoForScale(n),h=c.getColumnForX(this.state.center[0]),m=c.getRowForY(this.state.center[1]);return o.sort((b,x)=>{const I=c.denormalizeCol(b.col,b.world),E=c.denormalizeCol(x.col,x.world);return Math.sqrt((h-I)*(h-I)+(m-b.row)*(m-b.row))-Math.sqrt((h-E)*(h-E)+(m-x.row)*(m-x.row))}),yL.clear(),rv.clear(),o[0].id}_peekByCenterFirst(e){if(!this.state)return e.values().next().value;const t=this.tileInfoView,i=this.state.center;let r,n=Number.POSITIVE_INFINITY;return e.forEach(o=>{const c=this._keyToItem.get(o);t.getTileCoords(UQ,c.key);const h=rp(UQ,i);h<n&&(n=h,r=c.key)}),r.id}};g([w({constructOnly:!0})],Sf.prototype,"concurrency",void 0),g([w({constructOnly:!0})],Sf.prototype,"process",void 0),g([w()],Sf.prototype,"state",void 0),g([w({constructOnly:!0})],Sf.prototype,"strategy",void 0),g([w({constructOnly:!0})],Sf.prototype,"tileInfoView",void 0),g([w({readOnly:!0})],Sf.prototype,"updating",null),Sf=g([te("esri.views.2d.tiling.PagedTileQueue")],Sf);class va{constructor(t,i,r,n){this.set(t,i,r,n)}static getId(t,i,r,n){return typeof t=="object"?`${t.level}/${t.row}/${t.col}/${t.world}`:`${t}/${i}/${r}/${n}`}get key(){return this}get id(){return this.toString()}set id(t){this.set(t)}get hash(){const t=4095&this.row,i=4095&this.col,r=63&this.level;return(3&this.world)<<30|i<<22|t<<8|r}acquire(t,i,r,n){this.set(t,i,r,n)}contains(t){const i=t.level-this.level;return i>=0&&this.row===t.row>>i&&this.col===t.col>>i&&this.world===t.world}equals(t){return this.level===t.level&&this.row===t.row&&this.col===t.col&&this.world===t.world}clone(){return new va(this)}release(){this.level=0,this.row=0,this.col=0,this.world=0}set(t,i,r,n){if(t==null)this.level=0,this.row=0,this.col=0,this.world=0;else if(typeof t=="object")this.level=t.level||0,this.row=t.row||0,this.col=t.col||0,this.world=t.world||0;else if(typeof t=="string"){const[o,c,h,m]=t.split("/");this.level=parseFloat(o),this.row=parseFloat(c),this.col=parseFloat(h),this.world=parseFloat(m)}else this.level=+t,this.row=+i,this.col=+r,this.world=+n||0;return this}toString(){return`${this.level}/${this.row}/${this.col}/${this.world}`}getParentKey(){return this.level<=0?null:new va(this.level-1,this.row>>1,this.col>>1,this.world)}getChildKeys(){const t=this.level+1,i=this.row<<1,r=this.col<<1,n=this.world;return[new va(t,i,r,n),new va(t,i,r+1,n),new va(t,i+1,r,n),new va(t,i+1,r+1,n)]}compareRowMajor(t){return this.row<t.row?-1:this.row>t.row?1:this.col<t.col?-1:this.col>t.col?1:0}}va.pool=new Ql(va,null,null,25,50);function Mf(e,t){return[e,t]}function Zy(e,t,i){return e[0]=t,e[1]=i,e}function mAe(e,t,i,r,n){return e[0]=t,e[1]=i,e[2]=r,e[3]=n,e}const kc=new va("0/0/0/0");class mL{constructor(t,i,r,n,o,c,h,m,b,x,I,E){this.level=t,this.resolution=i,this.scale=r,this.origin=n,this.first=o,this.last=c,this.size=h,this.norm=m,this.worldStart=b,this.worldEnd=x,this.worldSize=I,this.wrap=E}static create(t,i,r=null){const n=Wo(t.spatialReference),o=i.origin||Mf(t.origin.x,t.origin.y),c=Mf(t.size[0]*i.resolution,t.size[1]*i.resolution),h=Mf(-1/0,-1/0),m=Mf(1/0,1/0),b=Mf(1/0,1/0);H(r)&&(Zy(h,Math.max(0,Math.floor((r.xmin-o[0])/c[0])),Math.max(0,Math.floor((o[1]-r.ymax)/c[1]))),Zy(m,Math.max(0,Math.floor((r.xmax-o[0])/c[0])),Math.max(0,Math.floor((o[1]-r.ymin)/c[1]))),Zy(b,m[0]-h[0]+1,m[1]-h[1]+1));const{cols:x,rows:I}=i;let E,k,P,F;return!r&&x&&I&&(Zy(h,x[0],I[0]),Zy(m,x[1],I[1]),Zy(b,x[1]-x[0]+1,I[1]-I[0]+1)),t.isWrappable?(E=Mf(Math.ceil(Math.round((n.valid[1]-n.valid[0])/i.resolution)/t.size[0]),b[1]),k=Mf(Math.floor((n.origin[0]-o[0])/c[0]),h[1]),P=Mf(E[0]+k[0]-1,m[1]),F=!0):(k=h,P=m,E=b,F=!1),new mL(i.level,i.resolution,i.scale,o,h,m,b,c,k,P,E,F)}normalizeCol(t){if(!this.wrap)return t;const i=this.worldSize[0];return t<0?i-1-Math.abs((t+1)%i):t%i}denormalizeCol(t,i){return this.wrap?this.worldSize[0]*i+t:t}getWorldForColumn(t){return this.wrap?Math.floor(t/this.worldSize[0]):0}getFirstColumnForWorld(t){return t*this.worldSize[0]+this.first[0]}getLastColumnForWorld(t){return t*this.worldSize[0]+this.first[0]+this.size[0]-1}getColumnForX(t){return(t-this.origin[0])/this.norm[0]}getXForColumn(t){return this.origin[0]+t*this.norm[0]}getRowForY(t){return(this.origin[1]-t)/this.norm[1]}getYForRow(t){return this.origin[1]-t*this.norm[1]}getTileBounds(t,i,r=!1){kc.set(i);const n=r?kc.col:this.denormalizeCol(kc.col,kc.world),o=kc.row;return mAe(t,this.getXForColumn(n),this.getYForRow(o+1),this.getXForColumn(n+1),this.getYForRow(o)),t}getTileCoords(t,i,r=!1){kc.set(i);const n=r?kc.col:this.denormalizeCol(kc.col,kc.world);return Array.isArray(t)?Zy(t,this.getXForColumn(n),this.getYForRow(kc.row)):(t.x=this.getXForColumn(n),t.y=this.getYForRow(kc.row)),t}}class nv{constructor(){this.spans=[]}acquire(t){this.lodInfo=t}release(){this.lodInfo=null,this.spans.length=0}forEach(t,i){const{spans:r,lodInfo:n}=this,{level:o}=n;if(r.length!==0)for(const{row:c,colFrom:h,colTo:m}of r)for(let b=h;b<=m;b++)t.call(i,o,c,n.normalizeCol(b),n.getWorldForColumn(b))}}nv.pool=new Ql(nv);class gL{constructor(t,i,r){this.row=t,this.colFrom=i,this.colTo=r}}const Nr=new va("0/0/0/0");class vL{constructor(t,i,r,n,o,c,h,m){this.x=t,this.ymin=i,this.ymax=r,this.invM=n,this.leftAdjust=o,this.rightAdjust=c,this.leftBound=h,this.rightBound=m}static create(t,i){t[1]>i[1]&&([t,i]=[i,t]);const[r,n]=t,[o,c]=i,h=o-r,m=c-n,b=m!==0?h/m:0,x=(Math.ceil(n)-n)*b,I=(Math.floor(n)-n)*b;return new vL(r,Math.floor(n),Math.ceil(c),b,h<0?x:I,h<0?I:x,h<0?o:r,h<0?r:o)}incrRow(){this.x+=this.invM}getLeftCol(){return Math.max(this.x+this.leftAdjust,this.leftBound)}getRightCol(){return Math.min(this.x+this.rightAdjust,this.rightBound)}}const Ka=[[0,0],[0,0],[0,0],[0,0]],gAe=1e-6;class vAe{constructor(t,i=null){this.tileInfo=t,this.fullExtent=i,this.scales=[],this._infoByScale={},this._infoByLevel={};const r=t.lods.slice();r.sort((o,c)=>c.scale-o.scale);const n=this._lodInfos=r.map(o=>mL.create(t,o,i));r.forEach((o,c)=>{this._infoByLevel[o.level]=n[c],this._infoByScale[o.scale]=n[c],this.scales[c]=o.scale},this),this._wrap=t.isWrappable}get spatialReference(){return this.tileInfo.spatialReference}getLODInfoAt(t){return this._infoByLevel[typeof t=="number"?t:t.level]}getTileBounds(t,i,r=!1){Nr.set(i);const n=this._infoByLevel[Nr.level];return n?n.getTileBounds(t,Nr,r):t}getTileCoords(t,i,r=!1){Nr.set(i);const n=this._infoByLevel[Nr.level];return n?n.getTileCoords(t,Nr,r):t}getTileCoverage(t,i=192,r="closest"){const n=r==="closest"?this.getClosestInfoForScale(t.scale):this.getSmallestInfoForScale(t.scale),o=nv.pool.acquire(n),c=this._wrap;let h,m,b,x=1/0,I=-1/0;const E=o.spans;Ka[0][0]=Ka[0][1]=Ka[1][1]=Ka[3][0]=-i,Ka[1][0]=Ka[2][0]=t.size[0]+i,Ka[2][1]=Ka[3][1]=t.size[1]+i;for(const N of Ka)t.toMap(N,N),N[0]=n.getColumnForX(N[0]),N[1]=n.getRowForY(N[1]);const k=[];let P=3;for(let N=0;N<4;N++){if(Ka[N][1]===Ka[P][1]){P=N;continue}const B=vL.create(Ka[N],Ka[P]);x=Math.min(B.ymin,x),I=Math.max(B.ymax,I),k[B.ymin]===void 0&&(k[B.ymin]=[]),k[B.ymin].push(B),P=N}if(x==null||I==null||I-x>100)return null;let F=[];for(h=x;h<I;){k[h]!=null&&(F=F.concat(k[h])),m=1/0,b=-1/0;for(let N=F.length-1;N>=0;N--){const B=F[N];m=Math.min(m,B.getLeftCol()),b=Math.max(b,B.getRightCol())}if(m=Math.floor(m),b=Math.floor(b),h>=n.first[1]&&h<=n.last[1])if(c)if(n.size[0]<n.worldSize[0]){const N=Math.floor(b/n.worldSize[0]);for(let B=Math.floor(m/n.worldSize[0]);B<=N;B++)E.push(new gL(h,Math.max(n.getFirstColumnForWorld(B),m),Math.min(n.getLastColumnForWorld(B),b)))}else E.push(new gL(h,m,b));else m>n.last[0]||b<n.first[0]||(m=Math.max(m,n.first[0]),b=Math.min(b,n.last[0]),E.push(new gL(h,m,b)));h+=1;for(let N=F.length-1;N>=0;N--){const B=F[N];B.ymax>=h?B.incrRow():F.splice(N,1)}}return o}getTileParentId(t){Nr.set(t);const i=this._infoByLevel[Nr.level],r=this._lodInfos.indexOf(i)-1;return r<0?null:(this._getTileIdAtLOD(Nr,this._lodInfos[r],Nr),Nr.id)}getTileResolution(t){const i=this._infoByLevel[typeof t=="object"?t.level:t];return i?i.resolution:-1}getTileScale(t){const i=this._infoByLevel[t.level];return i?i.scale:-1}intersects(t,i){Nr.set(i);const r=this._infoByLevel[Nr.level],n=t.lodInfo;if(n.resolution>r.resolution){this._getTileIdAtLOD(Nr,n,Nr);const c=n.denormalizeCol(Nr.col,Nr.world);for(const h of t.spans)if(h.row===Nr.row&&h.colFrom<=c&&h.colTo>=c)return!0}if(n.resolution<r.resolution){const[c,h,m,b]=t.spans.reduce((F,N)=>(F[0]=Math.min(F[0],N.row),F[1]=Math.max(F[1],N.row),F[2]=Math.min(F[2],N.colFrom),F[3]=Math.max(F[3],N.colTo),F),[1/0,-1/0,1/0,-1/0]),x=r.denormalizeCol(Nr.col,Nr.world),I=n.getColumnForX(r.getXForColumn(x)),E=n.getRowForY(r.getYForRow(Nr.row)),k=n.getColumnForX(r.getXForColumn(x+1))-1,P=n.getRowForY(r.getYForRow(Nr.row+1))-1;return!(I>b||k<m||E>h||P<c)}const o=n.denormalizeCol(Nr.col,Nr.world);return t.spans.some(c=>c.row===Nr.row&&c.colFrom<=o&&c.colTo>=o)}normalizeBounds(t,i,r){if(t[0]=i[0],t[1]=i[1],t[2]=i[2],t[3]=i[3],this._wrap){const n=Wo(this.tileInfo.spatialReference),o=-r*(n.valid[1]-n.valid[0]);t[0]+=o,t[2]+=o}return t}getSmallestInfoForScale(t){const i=this.scales;if(this._infoByScale[t])return this._infoByScale[t];if(t>i[0])return this._infoByScale[i[0]];for(let r=1;r<i.length-1;r++)if(t>i[r]+gAe)return this._infoByScale[i[r-1]];return this._infoByScale[i[i.length-1]]}getClosestInfoForScale(t){const i=this.scales;return this._infoByScale[t]||(t=i.reduce((r,n)=>Math.abs(n-t)<Math.abs(r-t)?n:r,i[0])),this._infoByScale[t]}scaleToLevel(t){const i=this.scales;if(this._infoByScale[t])return this._infoByScale[t].level;for(let r=i.length-1;r>=0;r--)if(t<i[r])return r===i.length-1?this._infoByScale[i[i.length-1]].level:this._infoByScale[i[r]].level+(i[r]-t)/(i[r]-i[r+1]);return this._infoByScale[i[0]].level}scaleToZoom(t){return this.tileInfo.scaleToZoom(t)}_getTileIdAtLOD(t,i,r){const n=this._infoByLevel[r.level];return t.set(r),i.resolution<n.resolution?null:(i.resolution===n.resolution||(t.level=i.level,t.col=Math.floor(r.col*n.resolution/i.resolution+.01),t.row=Math.floor(r.row*n.resolution/i.resolution+.01)),t)}}function bAe(e,t){return e.length=0,t.forEach(i=>e.push(i)),e}const bL=new Set,lI=[],sv=new Map,qQ=[0,0];let cp=class extends Ye{constructor(e){super(e),this._keyToItem=new Map,this.concurrency=6,this.strategy="scale-first",this.tileInfoView=null}initialize(){const{concurrency:e,process:t,strategy:i}=this;this._queue=new BQ({concurrency:e,process:(r,n)=>{const o=this._keyToItem.get(r);return t(o,{signal:n})},peeker:i==="scale-first"?r=>this._peekByScaleFirst(r):r=>this._peekByCenterFirst(r)})}destroy(){this.clear(),this._queue=li(this._queue)}get length(){return this._queue?this._queue.length:0}get onGoingCount(){return this._keyToItem.size}get updating(){return this.length>0||this.onGoingCount>0}abort(e){const t=typeof e=="string"?e:e.id;this._queue.abort(t)}clear(){this._queue.clear(),this._keyToItem.clear(),this.notifyChange("updating")}has(e){return typeof e=="string"?this._keyToItem.has(e):this._keyToItem.has(e.id)}isOngoing(e){const t=typeof e=="string"?e:e.id;return this.has(t)&&this._queue.isOngoing(t)}pause(){this._queue.pause()}push(e){const t=e.key.id;if(this._queue.has(t))return this._queue.get(t);const i=this._queue.push(t),r=()=>{this._keyToItem.delete(t),this.notifyChange("updating")};return this._keyToItem.set(t,e),i.then(r,r),this.notifyChange("updating"),i}reset(){this._queue.reset()}resume(){this._queue.resume()}_peekByScaleFirst(e){if(!this.state)return e.values().next().value;const t=this.tileInfoView;let i=Number.NEGATIVE_INFINITY,r=Number.POSITIVE_INFINITY;e.forEach(b=>{const x=this._keyToItem.get(b),I=this.tileInfoView.getTileScale(x.key);sv.has(I)||(sv.set(I,[]),i=Math.max(I,i),r=Math.min(I,r)),sv.get(I).push(x.key),bL.add(I)});let n=this.state.scale;sv.has(n)||(bAe(lI,bL),lI.sort((b,x)=>b-x),n=lI.reduce((b,x)=>Math.abs(x-n)<Math.abs(b-n)?x:b,lI[0])),n=Math.min(n,i),n=Math.max(n,r);const o=sv.get(n),c=t.getClosestInfoForScale(n),h=c.getColumnForX(this.state.center[0]),m=c.getRowForY(this.state.center[1]);return o.sort((b,x)=>{const I=c.denormalizeCol(b.col,b.world),E=c.denormalizeCol(x.col,x.world);return Math.sqrt((h-I)*(h-I)+(m-b.row)*(m-b.row))-Math.sqrt((h-E)*(h-E)+(m-x.row)*(m-x.row))}),bL.clear(),sv.clear(),o[0].id}_peekByCenterFirst(e){if(!this.state)return e.values().next().value;const t=this.tileInfoView,i=this.state.center;let r,n=Number.POSITIVE_INFINITY;return e.forEach(o=>{const c=this._keyToItem.get(o);t.getTileCoords(qQ,c.key);const h=rp(qQ,i);h<n&&(n=h,r=c.key)}),r.id}};g([w({constructOnly:!0})],cp.prototype,"concurrency",void 0),g([w({constructOnly:!0})],cp.prototype,"process",void 0),g([w()],cp.prototype,"state",void 0),g([w({constructOnly:!0})],cp.prototype,"strategy",void 0),g([w({constructOnly:!0})],cp.prototype,"tileInfoView",void 0),g([w({readOnly:!0})],cp.prototype,"updating",null),cp=g([te("esri.views.2d.tiling.TileQueue")],cp);const MKe=cp;class wAe{constructor(t,i,r){this.maxSize=t,this._tileInfoView=i,this._removedFunc=r,this._tilePerId=new Map,this._tileKeysPerLevel=[]}has(t){return this._tilePerId.has(t)}get(t){return this._tilePerId.get(t)}pop(t){const i=this._tilePerId.get(t);if(!i)return;const r=i.key.level,n=this._tileKeysPerLevel[r];HQ(this._tilePerId,t);for(let o=0;o<n.length;o++)if(n[o].id===t){n.splice(o,1);break}return i.visible=!0,i}add(t){t.visible=!1;const i=t.key,r=i.id;if(this._tilePerId.has(r))return;this._tilePerId.set(r,t);const n=i.level;this._tileKeysPerLevel[n]||(this._tileKeysPerLevel[n]=[]),this._tileKeysPerLevel[n].push(i)}prune(t,i,r){let n=this._tilePerId.size;if(n<=this.maxSize)return;let o=this._tileKeysPerLevel.length-1;for(;n>this.maxSize&&o>=0;)o!==t&&(n=this._pruneAroundCenterTile(n,i,r,o)),o--;n>this.maxSize&&(n=this._pruneAroundCenterTile(n,i,r,t))}_pruneAroundCenterTile(t,i,r,n){const o=this._tileKeysPerLevel[n];if(!o||o.length===0)return t;const{size:c,origin:h}=this._tileInfoView.tileInfo,m=r*c[0],b=r*c[1],x=[0,0],I=[0,0];for(o.sort((E,k)=>(x[0]=h.x+m*(E.col+.5),x[1]=h.y-b*(E.row+.5),I[0]=h.x+m*(k.col+.5),I[1]=h.y-b*(k.row+.5),Q1(x,i)-Q1(I,i)));o.length>0;){const E=o.pop();if(this._removeTile(E.id),--t===this.maxSize)break}return t}_removeTile(t){const i=this._tilePerId.get(t);this._removedFunc&&i&&this._removedFunc(i),HQ(this._tilePerId,t)}}function HQ(e,t){e.delete(t)}const Ky=new va(0,0,0,0),Il=new Map,ov=[],cI=[];class IKe{constructor(t){this._previousScale=Number.POSITIVE_INFINITY,this.cachePolicy="keep",this.coveragePolicy="closest",this.resampling=!0,this.tileIndex=new Map,this.tiles=[],this.buffer=192,this.acquireTile=t.acquireTile,this.releaseTile=t.releaseTile,this.tileInfoView=t.tileInfoView,this.resampling=t.resampling==null||!!t.resampling,t.cachePolicy&&(this.cachePolicy=t.cachePolicy),t.coveragePolicy&&(this.coveragePolicy=t.coveragePolicy),t.buffer!=null&&(this.buffer=t.buffer),t.cacheSize&&(this._tileCache=new wAe(t.cacheSize,this.tileInfoView,i=>{this.releaseTile(i)}))}destroy(){this.tileIndex.clear()}update(t){const{resampling:i,tileIndex:r}=this,n=this.tileInfoView.getTileCoverage(t.state,this.buffer,this.coveragePolicy);if(cI.length=0,ov.length=0,Il.clear(),!n)return;const{minScale:o,maxScale:c}=this.tileInfoView.tileInfo,{spans:h,lodInfo:m}=n,{level:b}=m,{scale:x,center:I,resolution:E}=t.state,k=!t.stationary&&x>this._previousScale;if(this._previousScale=x,this.tiles.length=0,!i&&(x>o||x<c))return this.tiles.length=0,Il.clear(),r.forEach(B=>{this.releaseTile(B)}),r.clear(),cI.length=0,ov.length=0,Il.clear(),nv.pool.release(n),!0;r.forEach(B=>B.visible=!0);let P=0,F=0;if(h.length>0)for(const{row:B,colFrom:z,colTo:q}of h)for(let J=z;J<=q;J++){P++;const X=Ky.set(b,B,m.normalizeCol(J),m.getWorldForColumn(J)).id;if(r.has(X)){const Y=r.get(X);Y.isReady?(Il.set(X,Y),F++):k||this._addParentTile(X,Il)}else{let Y;if(this._tileCache&&this._tileCache.has(X)){if(Y=this._tileCache.pop(X),this.tileIndex.set(X,Y),Y.isReady){Il.set(X,Y),F++;continue}}else Y=this.acquireTile(Ky),this.tileIndex.set(X,Y);k||this._addParentTile(X,Il)}}const N=F===P;r.forEach((B,z)=>{if(Ky.set(z),Il.has(z))return;const q=this.tileInfoView.intersects(n,Ky),J=this.cachePolicy==="purge"?Ky.level!==b:Ky.level>b;!q||!k&&N?!J&&q||ov.push(z):B.isReady?J&&this.cachePolicy==="purge"&&this._hasReadyAncestor(Ky,b)?ov.push(z):cI.push(z):J&&ov.push(z)});for(const B of cI){const z=r.get(B);z&&z.isReady&&Il.set(B,z)}for(const B of ov){const z=r.get(B);this._tileCache?this._tileCache.add(z):this.releaseTile(z),r.delete(B)}return Il.forEach(B=>this.tiles.push(B)),r.forEach(B=>{Il.has(B.key.id)||(B.visible=!1)}),this._tileCache&&this._tileCache.prune(b,I,E),nv.pool.release(n),Il.clear(),N}clear(t=!0){const{tileIndex:i}=this;t&&i.forEach(r=>{this.releaseTile(r)}),i.clear()}updateCacheSize(t){this._tileCache&&(this._tileCache.maxSize=t)}_addParentTile(t,i){let r=t,n=null;for(;r=this.tileInfoView.getTileParentId(r),r;)if(this.tileIndex.has(r)){if(n=this.tileIndex.get(r),n&&n.isReady){i.has(n.key.id)||i.set(n.key.id,n);break}}else if(this._tileCache&&this._tileCache.has(r)&&(n=this._tileCache.pop(r),this.tileIndex.set(r,n),n&&n.isReady)){i.has(n.key.id)||i.set(n.key.id,n);break}}_hasReadyAncestor(t,i){const r=ro();this.tileInfoView.getTileBounds(r,t,!0);for(const n of this.tileIndex.values())if(n.isReady&&n.key.level>=i&&n.key.level<t.level){const o=ro();if(this.tileInfoView.getTileBounds(o,n.key,!0),Hve(o,r))return!0}return!1}}function wL(e,t){switch(t){case"primary":return e.pointerType==="touch"||e.button===0;case"secondary":return e.pointerType!=="touch"&&e.button===2;case"tertiary":return e.pointerType!=="touch"&&e.button===1}}class WQ extends ds{constructor(t,i){super(!0),this._view=t,this.registerIncoming("double-click",i,r=>this._handleDoubleClick(r,i))}_handleDoubleClick(t,i){wL(t.data,"primary")&&(t.stopPropagation(),i?this._view.mapViewNavigation.zoomOut([t.data.x,t.data.y]):this._view.mapViewNavigation.zoomIn([t.data.x,t.data.y]))}}class _Ae extends ds{constructor(t,i,r){super(!0),this.view=t,this.pointerType=i,this.registerIncoming("double-tap-drag",r,n=>this._handleDoubleTapDrag(n))}_handleDoubleTapDrag(t){const{data:i}=t,{pointerType:r}=i;if(r!==this.pointerType)return;t.stopPropagation();const{action:n,delta:o}=i,{view:c}=this,{mapViewNavigation:h}=c;switch(n){case"begin":{const{scale:m}=c;this._startScale=m,this._currentScale=m,this._previousDelta=o,h.begin();break}case"update":{if(this._previousDelta.y===o.y)return;this._previousDelta=o;const m=1.015**o.y,b=this._startScale*m,x=b/this._currentScale;h.setViewpointImmediate(x),this._currentScale=b;break}case"end":{const{constraints:m}=c,{effectiveLODs:b,snapToZoom:x}=m;if(!x||!b)return void h.end();const I=m.snapScale(this._currentScale),E=(o.y>0?Math.max(I,m.snapToPreviousScale(this._startScale)):Math.min(I,m.snapToNextScale(this._startScale)))/this._currentScale;h.zoom(E);break}}}}class uI{constructor(t){this._callbacks=t,this._currentCount=0,this._callbacks.condition||(this._callbacks.condition=()=>!0)}handle(t){const i=t.data,r=i.pointers.size;switch(i.action){case"start":this._currentCount=r,this._emitStart(t);break;case"added":this._emitEnd(this._previousEvent),this._currentCount=r,this._emitStart(t);break;case"update":this._emitUpdate(t);break;case"removed":this._startEvent&&this._emitEnd(this._previousEvent),this._currentCount=r,this._emitStart(t);break;case"end":this._emitEnd(t),this._currentCount=0}this._previousEvent=t}_emitStart(t){var i,r;this._startEvent=t,((r=(i=this._callbacks).condition)==null?void 0:r.call(i,this._currentCount,t))&&this._callbacks.start(this._currentCount,t,this._startEvent)}_emitUpdate(t){var i,r;((r=(i=this._callbacks).condition)==null?void 0:r.call(i,this._currentCount,t))&&this._callbacks.update(this._currentCount,t,this._startEvent)}_emitEnd(t){var i,r;((r=(i=this._callbacks).condition)==null?void 0:r.call(i,this._currentCount,t))&&this._callbacks.end(this._currentCount,t,this._startEvent),this._startEvent=null}}class xAe extends ds{constructor(t,i,r){super(!0),this.view=t,this.pointerAction=i,this.registerIncoming("drag",r,n=>this._handleDrag(n)),this.registerIncoming("pointer-down",()=>this.stopMomentumNavigation())}onInstall(t){super.onInstall(t),this._dragEventSeparator=new uI({start:(i,r)=>{this.view.mapViewNavigation.pan.begin(this.view,r.data),r.stopPropagation()},update:(i,r)=>{this.view.mapViewNavigation.pan.update(this.view,r.data),r.stopPropagation()},end:(i,r)=>{this.view.mapViewNavigation.pan.end(this.view,r.data),r.stopPropagation()},condition:(i,r)=>i===1&&wL(r.data,this.pointerAction)})}_handleDrag(t){const i=this.view.mapViewNavigation;i.pinch.zoomMomentum||i.pinch.rotateMomentum?this.stopMomentumNavigation():this._dragEventSeparator.handle(t)}stopMomentumNavigation(){this.view.mapViewNavigation.pan.stopMomentumNavigation()}}class SAe extends ds{constructor(t,i,r){super(!0),this._view=t,this.pointerAction=i;const n=this._view.mapViewNavigation;this._dragEventSeparator=new uI({start:(o,c)=>{n.rotate.begin(this._view,c.data),c.stopPropagation()},update:(o,c)=>{n.rotate.update(this._view,c.data),c.stopPropagation()},end:(o,c)=>{n.rotate.end(),c.stopPropagation()},condition:(o,c)=>o===1&&wL(c.data,this.pointerAction)}),this.registerIncoming("drag",r,o=>this._dragEventSeparator.handle(o))}}function Ac(e){let t=e*e;return e<0&&(t*=-1),t}function MAe(e){return e.translation[0]=0,e.translation[1]=0,e.translation[2]=0,e.heading=0,e.tilt=0,e}function IAe(e,t,i){const r=i,n=e.state,o=e.device,c=t.tiltDirection==="forward-down"?1:-1,h=1;return o.deviceType==="standard"?(r.translation[0]=Ac(n.axes[0]),r.translation[1]=Ac(n.axes[1]),r.translation[2]=Ac(n.buttons[7])-Ac(n.buttons[6]),r.heading=Ac(n.axes[2]),r.tilt=Ac(n.axes[3])):o.deviceType==="spacemouse"&&(r.translation[0]=1.2*Ac(n.axes[0]),r.translation[1]=1.2*Ac(n.axes[1]),r.translation[2]=2*-Ac(n.axes[2]),r.heading=1.2*Ac(n.axes[5]),r.tilt=1.2*Ac(n.axes[3])),r.tilt*=c,Yo(r.translation,r.translation,h),r}function $Ae(e){return e.translation[0]===0&&e.translation[1]===0&&e.translation[2]===0&&e.heading===0&&e.tilt===0&&e.zoom===0}class EAe extends ds{constructor(t){super(!0),this._view=t,this._frameTask=null,this._watchHandles=new Ti,this._currentDevice=null,this._transformation={translation:[0,0,0],heading:0,tilt:0,zoom:0},this._handle=this.registerIncoming("gamepad",i=>this._handleGamePadEvent(i)),this._handle.pause()}onInstall(t){super.onInstall(t),this._watchHandles.add([we(()=>{var i;return(i=this._view.navigation.gamepad)==null?void 0:i.enabled},i=>{i?(this._handle.resume(),this._frameTask||(this._frameTask=tg({update:r=>this._frameUpdate(r.deltaTime)}))):(this._handle.pause(),this._frameTask&&(this._frameTask.remove(),this._frameTask=null))},St)])}onUninstall(){this._watchHandles.removeAll(),this._frameTask&&(this._frameTask.remove(),this._frameTask=null),super.onUninstall()}_handleGamePadEvent(t){const i=this._view.navigation.gamepad.device;i&&t.data.device!==i||this._currentDevice&&this._currentDevice!==t.data.device||(t.data.action==="end"?(this._currentDevice=null,MAe(this._transformation)):(this._currentDevice=t.data.device,IAe(t.data,this._view.navigation.gamepad,this._transformation)))}_frameUpdate(t){const i=this._transformation;if($Ae(i))return;const r=this._view.viewpoint.clone(),n=this._view.navigation.gamepad.velocityFactor,o=CAe*n*t;sI(r,r,[i.translation[0]*o,-i.translation[1]*o]);const c=1+i.translation[2]*kAe*t,h=this._view.constraints.rotationEnabled?-i.heading*TAe*t:0,m=this._view.size,b=[m[0]/2,m[1]];IQ(r,r,c,h,b,m);const x=this._view.constraints.constrain(r,this._view.viewpoint);this._view.viewpoint=x}}const TAe=.06,CAe=.7,kAe=6e-4;class AAe extends ds{constructor(t,i,r){super(!0),this.view=t,this.keys=i,this._pressed=!1,this._keyMap={[i.left]:"left",[i.right]:"right",[i.up]:"up",[i.down]:"down"},this.registerIncoming("key-down",r,n=>this._handleKeyDown(n)),this.registerIncoming("key-up",r,n=>this._handleKeyUp(n)),this.registerIncoming("blur",r,()=>this._handleBlur())}_handleKeyDown(t){t.data.repeat||this._handleKey(t,!0)}_handleKeyUp(t){this._handleKey(t,!1)}_handleBlur(){this._pressed&&(this._pressed=!1,this.view.mapViewNavigation.stop())}_handleKey(t,i){const r=this._keyMap[t.data.key];if(this._pressed=r!=null,this._pressed){if(i)switch(this.view.mapViewNavigation.begin(),r){case"left":this.view.mapViewNavigation.continousPanLeft();break;case"right":this.view.mapViewNavigation.continousPanRight();break;case"up":this.view.mapViewNavigation.continousPanUp();break;case"down":this.view.mapViewNavigation.continousPanDown()}else this._pressed=!1,this.view.mapViewNavigation.stop();t.stopPropagation()}}}class PAe extends ds{constructor(t,i,r){super(!0),this.view=t,this.keys=i,this._pressed=!1,this._keyToDirection={[i.clockwiseOption1]:"clockwise",[i.clockwiseOption2]:"clockwise",[i.counterClockwiseOption1]:"counterClockwise",[i.counterClockwiseOption2]:"counterClockwise",[i.resetOption1]:"reset",[i.resetOption2]:"reset"},this.registerIncoming("key-down",r,n=>this._handleKeyDown(n)),this.registerIncoming("key-up",r,n=>this._handleKeyUp(n)),this.registerIncoming("blur",r,()=>this._handleBlur())}_handleKeyDown(t){t.data.repeat||this._handleKey(t,!0)}_handleKeyUp(t){this._handleKey(t,!1)}_handleBlur(){this._pressed&&(this._pressed=!1,this.view.mapViewNavigation.stop())}_handleKey(t,i){const r=t.modifiers;if(r.size>0&&!r.has("Shift")||!this.view.constraints.rotationEnabled)return;const n=this._keyToDirection[t.data.key];if(this._pressed=n!=null,this._pressed){if(i)switch(this.view.mapViewNavigation.begin(),n){case"clockwise":this.view.mapViewNavigation.continousRotateClockwise();break;case"counterClockwise":this.view.mapViewNavigation.continousRotateCounterclockwise();break;case"reset":this.view.mapViewNavigation.resetRotation()}else this._pressed=!1,this.view.mapViewNavigation.stop();t.stopPropagation()}}}var av;(function(e){e[e.IN=0]="IN",e[e.OUT=1]="OUT"})(av||(av={}));class LAe extends ds{constructor(t,i,r){super(!0),this.view=t,this.keys=i,this._keysToZoomAction={},this.registerIncoming("key-down",r,n=>this._handleKeyDown(n)),i.zoomIn.forEach(n=>this._keysToZoomAction[n]=av.IN),i.zoomOut.forEach(n=>this._keysToZoomAction[n]=av.OUT)}_handleKeyDown(t){this._handleKey(t)}_handleKey(t){const i=t.modifiers;if(i.size>0&&!i.has("Shift"))return;const{key:r}=t.data;if(!(r in this._keysToZoomAction))return;const n=this._keysToZoomAction[r],{mapViewNavigation:o}=this.view;let c=null;switch(n){case av.IN:c=o.zoomIn();break;case av.OUT:c=o.zoomOut();break;default:return}o.begin(),c.then(()=>o.end()),t.stopPropagation()}}const OAe=.6;class RAe extends ds{constructor(t,i){super(!0),this._view=t,this._canZoom=!0,this.registerIncoming("mouse-wheel",i,r=>this._handleMouseWheel(r))}_handleMouseWheel(t){if(!this._view.navigation.mouseWheelZoomEnabled||(t.preventDefault(),t.stopPropagation(),!this._canZoom))return;const i=this._view.mapViewNavigation,{x:r,y:n,deltaY:o}=t.data,c=1/OAe**(1/60*o),h=i.zoom(c,[r,n]);h&&(this._canZoom=!1,h.catch(()=>{}).then(()=>{this._canZoom=!0,i.end()}))}}class FAe extends ds{constructor(t){super(!0),this.view=t,this.registerIncoming("drag",r=>this._handleDrag(r)),this.registerIncoming("pointer-down",()=>this._stopMomentumNavigation());const i=this.view.mapViewNavigation;this._dragEventSeparator=new uI({start:(r,n)=>{i.pinch.begin(this.view,n.data),n.stopPropagation()},update:(r,n)=>{i.pinch.update(this.view,n.data),n.stopPropagation()},end:(r,n)=>{i.pinch.end(this.view),n.stopPropagation()},condition:r=>r>=2})}_handleDrag(t){this._dragEventSeparator.handle(t)}_stopMomentumNavigation(){this.view.mapViewNavigation.pinch.stopMomentumNavigation()}}function JQ(e){const t=e.native;return t?{buttons:t.buttons.map(i=>i.pressed?i.value?i.value:1:0),axes:t.axes.map(i=>jAe(i,e.axisThreshold))}:{buttons:[],axes:[]}}function NAe(e,t){if(e.axes.length!==t.axes.length||e.buttons.length!==t.buttons.length)return!1;for(let i=0;i<e.axes.length;i++)if(e.axes[i]!==t.axes[i])return!1;for(let i=0;i<e.buttons.length;i++)if(e.buttons[i]!==t.buttons[i])return!1;return!0}function DAe(e){for(let t=0;t<e.axes.length;t++)if(e.axes[t]!==0)return!1;for(let t=0;t<e.buttons.length;t++)if(e.buttons[t]!==0)return!1;return!0}function jAe(e,t){const i=Math.abs(e);return i<t?0:Math.sign(e)*(i-t)/(1-t)}class VAe{constructor(t,i){this._element=t,this._input=i,this._hasEventListeners=!1,this._onConnectGamepad=o=>{this._connectGamepad(o.gamepad)},this._onDisconnectGamepad=o=>{const c=o.gamepad,h=c.index,m=this._inputDevices[h];m&&(this._emitGamepadEvent(c,JQ(m),!1),this._inputDevices.splice(h,1),this._latestUpdate.splice(h,1),this._input.gamepad.devices.remove(m),this.ensurePollingState())},this._frameTask=null,this._latestUpdate=new Array,this._inputDevices=new Array,this._callback=null;const r="getGamepads"in window.navigator,n=window.isSecureContext;this.supported=r&&n,this.supported&&(this._forEachGamepad(o=>this._connectGamepad(o)),window.addEventListener("gamepadconnected",this._onConnectGamepad),window.addEventListener("gamepaddisconnected",this._onDisconnectGamepad),this.ensurePollingState())}destroy(){this.hasEventListeners=!1,this.supported&&(window.removeEventListener("gamepadconnected",this._onConnectGamepad),window.removeEventListener("gamepaddisconnected",this._onDisconnectGamepad))}set hasEventListeners(t){this._hasEventListeners!==t&&(this._hasEventListeners=t,this.ensurePollingState())}get _eventsEnabled(){return this.supported&&this._inputDevices.length>0&&this._hasEventListeners}set onEvent(t){this._callback=t}_connectGamepad(t){const i=new HP(t);i.deviceType!=="unknown"&&(this._inputDevices[t.index]=i,this._input.gamepad.devices.add(i)),this.ensurePollingState()}ensurePollingState(){this._eventsEnabled?this._startPolling():this._stopPolling()}_startPolling(){this._frameTask==null&&(this._frameTask=tg({update:()=>this._readGamepadState()}))}_stopPolling(){this._frameTask!=null&&(this._frameTask.remove(),this._frameTask=null,this._latestUpdate=new Array)}_readGamepadState(){const t=document.hasFocus(),i=this._element.contains(document.activeElement),r=this._input.gamepad.enabledFocusMode==="document"&&!t||this._input.gamepad.enabledFocusMode==="view"&&!i;this._forEachGamepad(n=>{const o=this._inputDevices[n.index];if(!o)return;const c=this._latestUpdate[n.index],h=JQ(o),m=r||DAe(h);c&&(c.timestamp===n.timestamp||!c.active&&m||NAe(c.state,h))||this._emitGamepadEvent(n,h,!m)})}_forEachGamepad(t){const i=window.navigator.getGamepads();for(let r=0;r<i.length;r++){const n=i[r];this._validate(n)&&t(n)}}_emitGamepadEvent(t,i,r){const n=this._latestUpdate[t.index],o=n&&n.active;if(!o&&!r)return;const c=!o&&r?"start":o&&r?"update":"end";this._latestUpdate[t.index]={timestamp:t.timestamp,state:i,active:r},this._callback&&this._callback({device:this._inputDevices[t.index],state:i,action:c})}_validate(t){if(!t||!t.connected)return!1;for(let i=0;i<t.axes.length;i++)if(isNaN(t.axes[i]))return!1;return!0}}const ZQ=Te("trident"),KQ=Te("edge"),zAe=Te("chrome"),GAe=Te("ff"),BAe=Te("safari"),lv={touchNone:"esri-view-surface--touch-none",touchPan:"esri-view-surface--touch-pan"};class hI{constructor(t,i){this._input=i,this._active={},this._activePointerCaptures=new Set,this._keyDownState=new Set,this._eventId=1,this._browserTouchPanningEnabled=!1,this._element=t,t.getAttribute("tabindex")||t.setAttribute("tabindex","0"),this._eventHandlers={"key-down":this._handleKey,"key-up":this._handleKey,"pointer-down":this._handlePointer,"pointer-move":this._handlePointerPreventDefault,"pointer-up":this._handlePointerPreventDefault,"pointer-enter":this._handlePointer,"pointer-leave":this._handlePointer,"pointer-cancel":this._handlePointer,"mouse-wheel":this._handleMouseWheel,"pointer-capture-lost":this._handlePointerCaptureLost},this._updateTouchAction(),this._element.addEventListener("keydown",this._preventAltKeyDefault),this._gamepadSource=new VAe(t,this._input),this._gamepadSource.onEvent=r=>this._callback("gamepad",r)}destroy(){this._callback=null,this.activeEvents=null,this._activePointerCaptures.forEach(t=>{this._releasePointerCaptureSafe(t)}),this._gamepadSource=li(this._gamepadSource),this._activePointerCaptures=null,this._removeTouchAction(),this._element.removeEventListener("keydown",this._preventAltKeyDefault)}get browserTouchPanningEnabled(){return this._browserTouchPanningEnabled}set browserTouchPanningEnabled(t){this._browserTouchPanningEnabled=t,this._updateTouchAction(),this._updateTouchEventHandling()}set onEventReceived(t){this._callback=t}set activeEvents(t){for(const i in this._active)if(!t||!t.has(i)){const r=this._active[i];this._element.removeEventListener(_L[i],r),delete this._active[i]}t&&t.forEach(i=>{if(!this._active[i]&&_L[i]){const r=(this._eventHandlers[i]||this._handleDefault).bind(this,i);this._element.addEventListener(_L[i],r),this._active[i]=r}}),this._gamepadSource.hasEventListeners=t&&t.has("gamepad")}setPointerCapture(t,i){i?(this._element.setPointerCapture(t.pointerId),this._activePointerCaptures.add(t.pointerId)):(this._releasePointerCaptureSafe(t.pointerId),this._activePointerCaptures.delete(t.pointerId))}_updateTouchAction(){this._element.classList.remove(this._browserTouchPanningEnabled?lv.touchNone:lv.touchPan),this._element.classList.add(this._browserTouchPanningEnabled?lv.touchPan:lv.touchNone)}_updateTouchEventHandling(){this._browserTouchPanningEnabled?this._element.addEventListener("touchmove",this._preventMultiTouchPanning):this._element.removeEventListener("touchmove",this._preventMultiTouchPanning)}_removeTouchAction(){this._element.classList.remove(lv.touchNone),this._element.classList.remove(lv.touchPan),this._element.removeEventListener("touchmove",this._preventMultiTouchPanning)}_releasePointerCaptureSafe(t){try{if(this._element.hasPointerCapture&&!this._element.hasPointerCapture(t))return;this._element.releasePointerCapture(t)}catch{}}_updateNormalizedPointerLikeEvent(t,i){const r=qX(this._element,t);return hI.test.disableSubpixelCoordinates&&(r.x=Math.round(r.x),r.y=Math.round(r.y)),i.x=r.x,i.y=r.y,i}_handleKey(t,i){const r=NCe(i);r&&t==="key-up"&&this._keyDownState.delete(r);const n={native:i,key:r,repeat:r&&this._keyDownState.has(r)};r&&t==="key-down"&&this._keyDownState.add(n.key),this._callback(t,n)}_handlePointer(t,i){const r=this._updateNormalizedPointerLikeEvent(i,{native:i,x:0,y:0,pointerType:i.pointerType,button:i.button,buttons:i.buttons,eventId:this._eventId++});this._callback(t,r)}_handlePointerPreventDefault(t,i){const r=this._updateNormalizedPointerLikeEvent(i,{native:i,x:0,y:0,pointerType:i.pointerType,button:i.button,buttons:i.buttons,eventId:this._eventId++});i.preventDefault(),this._callback(t,r)}_handleMouseWheel(t,i){let r=i.deltaY;switch(i.deltaMode){case 0:(ZQ||KQ)&&(r=r/document.documentElement.clientHeight*600);break;case 1:r*=30;break;case 2:r*=900}ZQ||KQ?r*=.7:zAe||BAe?r*=.6:GAe&&(r*=1.375);const n=100,o=Math.abs(r);if(o>n){const h=.02;r=r/o*200/(1+Math.exp(-h*(o-n)))}const c=this._updateNormalizedPointerLikeEvent(i,{native:i,x:0,y:0,deltaY:r});this._callback(t,c)}_handlePointerCaptureLost(t,i){this._activePointerCaptures.delete(i.pointerId),this._handleDefault(t,i)}_handleDefault(t,i){const r={native:i};i.preventDefault(),this._callback(t,r)}_preventAltKeyDefault(t){t.key==="Alt"&&t.preventDefault()}_preventMultiTouchPanning(t){t.touches.length>1&&t.preventDefault()}}hI.test={disableSubpixelCoordinates:!1};const _L={"key-down":"keydown","key-up":"keyup","pointer-down":"pointerdown","pointer-up":"pointerup","pointer-move":"pointermove","mouse-wheel":"wheel","pointer-capture-got":"gotpointercapture","pointer-capture-lost":"lostpointercapture","context-menu":"contextmenu","pointer-enter":"pointerenter","pointer-leave":"pointerleave","pointer-cancel":"pointercancel",focus:"focus",blur:"blur"};class UAe extends ds{constructor(){super(!0),this.registerIncoming("context-menu",t=>{t.data.native.preventDefault()})}}function xL(e,t){return Math.abs(t.x-e.x)+Math.abs(t.y-e.y)}function qAe(e,t){const i=t.x-e.x,r=t.y-e.y;return Math.sqrt(i*i+r*r)}function HAe(e,t){if(t?(t.radius=0,t.center.x=0,t.center.y=0):t={radius:0,center:yn()},e.length===0)return t;if(e.length===1)return t.center.x=e[0].x,t.center.y=e[0].y,t;if(e.length===2){const[q,J]=e,[X,Y]=[J.x-q.x,J.y-q.y];return t.radius=Math.sqrt(X*X+Y*Y)/2,t.center.x=(q.x+J.x)/2,t.center.y=(q.y+J.y)/2,t}let i=0,r=0;for(let q=0;q<e.length;q++)i+=e[q].x,r+=e[q].y;i/=e.length,r/=e.length;const n=e.map(q=>q.x-i),o=e.map(q=>q.y-r);let c=0,h=0,m=0,b=0,x=0,I=0,E=0;for(let q=0;q<n.length;q++){const J=n[q],X=o[q],Y=J*J,ae=X*X;c+=Y,h+=ae,m+=J*X,b+=Y*J,x+=ae*X,I+=J*ae,E+=X*Y}const k=.5*(b+I),P=.5*(x+E),F=c*h-m*m,N=(k*h-P*m)/F,B=(c*P-m*k)/F,z=yn(N+i,B+r);return{radius:Math.sqrt(N*N+B*B+(c+h)/e.length),center:z}}function Yy(e){const{native:t}=e,{pointerId:i,button:r,pointerType:n}=t;return n==="mouse"?`${i}:${r}`:`${n}`}const $l={maximumDoubleClickDelay:250,maximumDoubleClickDistance:10,maximumDoubleTouchDelay:350,maximumDoubleTouchDistance:35};class WAe extends ds{constructor(t=$l.maximumDoubleClickDelay,i=$l.maximumDoubleClickDistance,r=$l.maximumDoubleTouchDelay,n=$l.maximumDoubleTouchDistance,o=lw){super(!1),this._maximumDoubleClickDelay=t,this._maximumDoubleClickDistance=i,this._maximumDoubleTouchDelay=r,this._maximumDoubleTouchDistance=n,this._clock=o,this._pointerState=new Map,this._click=this.registerOutgoing("click"),this._doubleClick=this.registerOutgoing("double-click"),this.registerIncoming("immediate-click",this._handleImmediateClick.bind(this)),this.registerIncoming("pointer-down",this._handlePointerDown.bind(this))}onUninstall(){this._pointerState.forEach(t=>t.doubleClickTimer=mr(t.doubleClickTimer))}get hasPendingInputs(){return Xb(this._pointerState,t=>t.doubleClickTimer!=null)}_clearDoubleClickTimer(t,i){const r=this._pointerState.get(t);r&&(r.doubleClickTimer=mr(r.doubleClickTimer),i&&this._click.emit(r.event.data,void 0,r.event.modifiers),this._pointerState.delete(t),this.refreshHasPendingInputs())}_doubleClickTimeoutExceeded(t){const i=this._pointerState.get(t);i.pointerDownCount===1&&this._click.emit(i.event.data,void 0,i.event.modifiers),i.doubleClickTimer=null,this._pointerState.delete(t),this.refreshHasPendingInputs()}_getPointerId(t){const{pointerId:i,pointerType:r,button:n}=t.native;return r==="mouse"?`${i}:${n}`:`${r}`}_handleImmediateClick(t){const i=t.data,{pointerType:r}=i.native,n=this._getPointerId(i);if(!this._pointerState.has(n))return void this._startClick(t);const o=this._pointerState.get(n),{data:c,modifiers:h}=o.event,m=r==="touch"?this._maximumDoubleTouchDistance:this._maximumDoubleClickDistance;xL(c,i)>m?(this._clearDoubleClickTimer(n,!0),this._startClick(t)):(this._clearDoubleClickTimer(n,!1),o.pointerDownCount===2&&this._doubleClick.emit(c,void 0,h))}_handlePointerDown(t){const i=Yy(t.data),r=this._pointerState.get(i);r&&(r.pointerDownCount+=1)}_startClick(t){const{data:i}=t,{native:{pointerType:r}}=i,n=Yy(i),o=r==="touch"?this._maximumDoubleTouchDelay:this._maximumDoubleClickDelay,c=this._clock.setTimeout(()=>this._doubleClickTimeoutExceeded(n),o),h=1;this._pointerState.set(n,{event:t,doubleClickTimer:c,pointerDownCount:h}),this.refreshHasPendingInputs()}}class JAe extends ds{constructor(t=$l.maximumDoubleClickDelay,i=$l.maximumDoubleClickDistance,r=$l.maximumDoubleTouchDelay,n=$l.maximumDoubleTouchDistance,o=lw){super(!1),this._maximumDoubleClickDelay=t,this._maximumDoubleClickDistance=i,this._maximumDoubleTouchDelay=r,this._maximumDoubleTouchDistance=n,this._clock=o,this._doubleTapDragReady=!1,this._doubleTapDragActive=!1,this._dragStartCenter=yn(0,0),this._pointerState=new Map,this._doubleTapDrag=this.registerOutgoing("double-tap-drag"),this._dragEventSeparator=new uI({start:(c,h)=>this._dragStart(c,h),update:(c,h)=>this._dragUpdate(h),end:(c,h)=>this._dragEnd(h)}),this.registerIncoming("drag",c=>this._dragEventSeparator.handle(c)),this.registerIncoming("pointer-down",c=>this._handlePointerDown(c)),this.registerIncoming("pointer-up",()=>this._handlePointerUp())}onUninstall(){this._pointerState.forEach(t=>{t.doubleTapTimeout=mr(t.doubleTapTimeout)})}get hasPendingInputs(){return Xb(this._pointerState,t=>t.doubleTapTimeout!=null)}_clearPointerDown(t){const i=this._pointerState.get(t);i&&(i.doubleTapTimeout=mr(i.doubleTapTimeout),this._pointerState.delete(t),this.refreshHasPendingInputs())}_createDoubleTapDragData(t,i,r){const{button:n,buttons:o,pointer:c,pointers:h,pointerType:m,timestamp:b}=r;return{action:t,delta:i,button:n,buttons:o,pointer:c,pointers:h,pointerType:m,timestamp:b}}_dragStart(t,i){if(!this._doubleTapDragReady||t!==1)return;this._doubleTapDragReady=!1,this._doubleTapDragActive=!0;const{data:r,modifiers:n}=i,{center:o}=r;this._dragStartCenter=o;const c=this._createDoubleTapDragData("begin",yn(0,0),r);this._doubleTapDrag.emit(c,void 0,n),i.stopPropagation()}_dragUpdate(t){if(!this._doubleTapDragActive)return;const{data:i,modifiers:r}=t,{center:n}=i,o=yn(n.x-this._dragStartCenter.x,n.y-this._dragStartCenter.y),c=this._createDoubleTapDragData("update",o,i);this._doubleTapDrag.emit(c,void 0,r),t.stopPropagation()}_dragEnd(t){if(!this._doubleTapDragActive)return;const{data:i,modifiers:r}=t,{center:n}=i,o=yn(n.x-this._dragStartCenter.x,n.y-this._dragStartCenter.y),c=this._createDoubleTapDragData("end",o,i);this._doubleTapDrag.emit(c,void 0,r),this._doubleTapDragActive=!1,t.stopPropagation()}_handlePointerDown(t){const{data:i}=t,r=Yy(i),n=this._pointerState.get(r),{pointerType:o}=i.native;if(n){const c=o==="touch"?this._maximumDoubleTouchDistance:this._maximumDoubleClickDistance;this._clearPointerDown(r),xL(n.event.data,i)>c?this._storePointerDown(t):this._doubleTapDragReady=!0}else this._storePointerDown(t)}_handlePointerUp(){this._doubleTapDragReady=!1}_storePointerDown(t){const{data:i}=t,{pointerType:r}=i.native,n=Yy(i),o=r==="touch"?this._maximumDoubleTouchDelay:this._maximumDoubleClickDelay,c=this._clock.setTimeout(()=>this._clearPointerDown(n),o);this._pointerState.set(n,{event:t,doubleTapTimeout:c}),this.refreshHasPendingInputs()}}class ZAe extends ds{constructor(t){super(!1),this._navigationTouch=t,this._startStateModifiers=new Set,this._activePointerMap=new Map,this._isDragging=!1,this._isCurrentDragSuppressed=!1,this._drag=this.registerOutgoing("drag"),this.registerIncoming("pointer-drag",this._handlePointerDrag.bind(this)),this.registerIncoming("pointer-up",this._handlePointerUpAndPointerLost.bind(this)),this.registerIncoming("pointer-capture-lost",this._handlePointerUpAndPointerLost.bind(this)),this.registerIncoming("pointer-cancel",this._handlePointerUpAndPointerLost.bind(this))}_createPayload(t,i,r,n){return{action:t,pointerType:this._pointerType,button:this._mouseButton,buttons:i.buttons,timestamp:n,pointers:KAe(this._activePointerMap),pointer:i,angle:r.angle,radius:r.radius,center:r.center}}_addPointer(t){const i=t.native.pointerId,r=pI(this._activePointerMap).angle,n={event:t,initialAngle:0,lastAngle:0};this._activePointerMap.set(i,n);const o=dI(n,YQ(this._activePointerMap));n.initialAngle=o,n.lastAngle=o,this._updatePointerAngles(r)}_updatePointer(t){if(t&&t.x==null&&t.y==null)return;const i=t.native.pointerId,r=this._activePointerMap.get(i);r?r.event=t:this._addPointer(t)}_removePointer(t){const i=pI(this._activePointerMap).angle;this._activePointerMap.delete(t),this._updatePointerAngles(i)}_updatePointerAngles(t){const i=pI(this._activePointerMap);this._activePointerMap.forEach(r=>{r.initialAngle=dI(r,i)-t,r.lastAngle=dI(r,i)-t})}_emitEvent(t,i,r){const n=pI(this._activePointerMap);this._drag.emit(this._createPayload(t,i,n,r),void 0,this._startStateModifiers)}_handlePointerUpAndPointerLost(t){const i=t.data.native.pointerId,r=dn(t.timestamp);this._activePointerMap.get(i)&&(this._activePointerMap.size===1?(this._updatePointer(t.data),!this._isCurrentDragSuppressed&&this._emitEvent("end",t.data,r),this._isDragging=!1,this._isCurrentDragSuppressed=!1,this._removePointer(i)):(this._removePointer(i),this._emitEvent("removed",t.data,dn(t.timestamp))))}_handlePointerDrag(t){const i=t.data,r=i.currentEvent,n=dn(t.timestamp);switch(i.action){case"start":case"update":this._isDragging?this._activePointerMap.has(r.native.pointerId)?(this._updatePointer(r),!this._isCurrentDragSuppressed&&this._emitEvent("update",r,n)):(this._addPointer(r),this._emitEvent("added",r,n),this._isCurrentDragSuppressed=this._isSuppressed):(this._updatePointer(r),this._pointerType=t.data.startEvent.pointerType,this._mouseButton=t.data.startEvent.button,this._startStateModifiers=t.modifiers,this._isDragging=!0,this._isCurrentDragSuppressed=this._isSuppressed,!this._isCurrentDragSuppressed&&this._emitEvent("start",r,n))}}get _isSuppressed(){return!!this._navigationTouch&&!this._navigationTouch.browserTouchPanEnabled&&this._pointerType==="touch"&&this._activePointerMap.size===1}}function YQ(e){const t=[];return e.forEach(i=>{t.push(yn(i.event.x,i.event.y))}),HAe(t)}function pI(e){const t=YQ(e);let i=0;return e.forEach(r=>{let n=dI(r,t),o=n-r.lastAngle;for(;o>Math.PI;)o-=2*Math.PI;for(;o<-Math.PI;)o+=2*Math.PI;n=r.lastAngle+o,r.lastAngle=n,i+=n-r.initialAngle}),i/=e.size||1,{angle:i,radius:t.radius,center:t.center}}function KAe(e){const t=new Map;return e.forEach((i,r)=>t.set(r,i.event)),t}function dI(e,t){const i=e.event,r=i.x-t.center.x,n=i.y-t.center.y;return Math.atan2(n,r)}var XQ;(function(e){e[e.Left=0]="Left",e[e.Middle=1]="Middle",e[e.Right=2]="Right",e[e.Back=3]="Back",e[e.Forward=4]="Forward",e[e.Undefined=-1]="Undefined"})(XQ||(XQ={}));class YAe extends ds{constructor(t=$l.maximumDoubleClickDelay,i=$l.maximumDoubleClickDistance,r=$l.maximumDoubleTouchDelay,n=$l.maximumDoubleTouchDistance,o=lw){super(!1),this._maximumDoubleClickDelay=t,this._maximumDoubleClickDistance=i,this._maximumDoubleTouchDelay=r,this._maximumDoubleTouchDistance=n,this._clock=o,this._pointerState=new Map,this._immediateDoubleClick=this.registerOutgoing("immediate-double-click"),this.registerIncoming("pointer-down",this._handlePointerDown.bind(this)),this.registerIncoming("pointer-up",this._handlePointerUp.bind(this))}onUninstall(){this._pointerState.forEach(t=>{t.immediateDoubleClick&&t.immediateDoubleClick.timeoutHandle.remove()}),super.onUninstall()}_handlePointerDown(t){const i=t.data,r=Yy(i);if(!this._pointerState.has(r)){const n={downButton:i.native.button,immediateDoubleClick:null};this._pointerState.set(r,n),this.startCapturingPointer(i.native)}}_handlePointerUp(t){const i=t.data,r=Yy(i),n=this._pointerState.get(r);if(n&&n.downButton===i.native.button){const o=n.immediateDoubleClick;if(o){o.timeoutHandle.remove();const c=t.data.native.pointerType==="touch"?this._maximumDoubleTouchDistance:this._maximumDoubleClickDistance;xL(o,t.data)>c?this._startImmediateDoubleClick(t,n):(this._immediateDoubleClick.emit(t.data,void 0,o.modifiers),this._removeState(i))}else this._startImmediateDoubleClick(t,n)}}_startImmediateDoubleClick(t,i){const r=t.data.native.pointerType==="touch"?this._maximumDoubleTouchDelay:this._maximumDoubleClickDelay;i.immediateDoubleClick={x:t.data.x,y:t.data.y,modifiers:t.modifiers,timeoutHandle:this._clock.setTimeout(()=>this._removeState(t.data),r)}}_removeState(t){const i=Yy(t);this._pointerState.delete(i),this.stopCapturingPointer(t.native),this.refreshHasPendingInputs()}}const e3={maximumClickDelay:300,movementUntilMouseDrag:1.5,movementUntilPenDrag:6,movementUntilTouchDrag:6,holdDelay:500};class XAe extends ds{constructor(t=e3.maximumClickDelay,i=e3.movementUntilMouseDrag,r=e3.movementUntilPenDrag,n=e3.movementUntilTouchDrag,o=e3.holdDelay,c=lw){super(!1),this._maximumClickDelay=t,this._movementUntilMouseDrag=i,this._movementUntilPenDrag=r,this._movementUntilTouchDrag=n,this._holdDelay=o,this._clock=c,this._pointerState=new Map,this._pointerDrag=this.registerOutgoing("pointer-drag"),this._immediateClick=this.registerOutgoing("immediate-click"),this._pointerHold=this.registerOutgoing("hold"),this.registerIncoming("pointer-down",this._handlePointerDown.bind(this)),this.registerIncoming("pointer-up",h=>{this._handlePointerLoss(h,"pointer-up")}),this.registerIncoming("pointer-capture-lost",h=>{this._handlePointerLoss(h,"pointer-capture-lost")}),this.registerIncoming("pointer-cancel",h=>{this._handlePointerLoss(h,"pointer-cancel")}),this._moveHandle=this.registerIncoming("pointer-move",this._handlePointerMove.bind(this)),this._moveHandle.pause()}onUninstall(){this._pointerState.forEach(t=>{t.holdTimeout=mr(t.holdTimeout)}),super.onUninstall()}_handlePointerDown(t){const i=t.data,r=i.native.pointerId;let n=null;this._pointerState.size===0&&(n=this._clock.setTimeout(()=>{const c=this._pointerState.get(r);if(c){if(!c.isDragging){const h=c.previousEvent;this._pointerHold.emit(h,void 0,t.modifiers),c.holdEmitted=!0}c.holdTimeout=null}},this._holdDelay));const o={startEvent:i,previousEvent:i,startTimestamp:t.timestamp,isDragging:!1,downButton:i.native.button,holdTimeout:n,modifiers:new Set};this._pointerState.set(r,o),this.startCapturingPointer(i.native),this._moveHandle.resume(),this._pointerState.size>1&&this._startDragging(t)}_createPointerDragData(t,i,r){return{action:t,startEvent:i.startEvent,previousEvent:i.previousEvent,currentEvent:r}}_handlePointerMove(t){const i=t.data,r=i.native.pointerId,n=this._pointerState.get(r);n&&(n.isDragging?this._pointerDrag.emit(this._createPointerDragData("update",n,i),void 0,n.modifiers):qAe(i,n.startEvent)>this._getDragThreshold(i.native.pointerType)&&this._startDragging(t),n.previousEvent=i)}_getDragThreshold(t){switch(t){case"touch":return this._movementUntilTouchDrag;case"pen":return this._movementUntilPenDrag;default:return this._movementUntilMouseDrag}}_startDragging(t){const i=t.data,r=i.native.pointerId;this._pointerState.forEach(n=>{n.holdTimeout!=null&&(n.holdTimeout.remove(),n.holdTimeout=null),n.isDragging||(n.modifiers=t.modifiers,n.isDragging=!0,r===n.startEvent.native.pointerId?this._pointerDrag.emit(this._createPointerDragData("start",n,i)):this._pointerDrag.emit(this._createPointerDragData("start",n,n.previousEvent),t.timestamp))})}_handlePointerLoss(t,i){const r=t.data,n=r.native.pointerId,o=this._pointerState.get(n);o&&(o.holdTimeout!=null&&(o.holdTimeout.remove(),o.holdTimeout=null),o.isDragging?this._pointerDrag.emit(this._createPointerDragData("end",o,i==="pointer-up"?r:o.previousEvent),void 0,o.modifiers):i==="pointer-up"&&o.downButton===r.native.button&&t.timestamp-o.startTimestamp<=this._maximumClickDelay&&!o.holdEmitted&&this._immediateClick.emit(r),this._pointerState.delete(n),this.stopCapturingPointer(r.native),this._pointerState.size===0&&this._moveHandle.pause())}}const fI={counter:"Ctrl",pan:{left:"ArrowLeft",right:"ArrowRight",up:"ArrowUp",down:"ArrowDown"},zoom:{zoomIn:["=","+"],zoomOut:["-","_"]},rotate:{clockwiseOption1:"a",clockwiseOption2:"A",counterClockwiseOption1:"d",counterClockwiseOption2:"D",resetOption1:"n",resetOption2:"N"}};let Xy=class extends Ye{constructor(){super(...arguments),this._handles=new Ti}initialize(){const e=()=>{var t;return(t=this.view)==null?void 0:t.ready};this._handles.add([os(()=>!e(),()=>this._disconnect()),os(e,()=>this._connect())])}destroy(){this._handles&&(this._handles.removeAll(),this._handles=null),this._disconnect()}get latestPointerType(){var e;return(e=this._inputManager)==null?void 0:e.latestPointerType}get latestPointerLocation(){var e;return(e=this._inputManager)==null?void 0:e.latestPointerLocation}get multiTouchActive(){var e,t;return(t=(e=this._inputManager)==null?void 0:e.multiTouchActive)!=null?t:!1}_disconnect(){this.view.viewEvents.disconnect(),this._inputManager=li(this._inputManager)}_connect(){const e=this.view.surface,t=new hI(e,this.view.input),i=[new YAe,new XAe,new WAe,new ZAe(this.view.navigation),new JAe],r=new Tu({eventSource:t,recognizers:i});r.installHandlers("prevent-context-menu",[new UAe],ft.INTERNAL),r.installHandlers("navigation",[new FAe(this.view),new EAe(this.view),new RAe(this.view),new WQ(this.view),new WQ(this.view,[fI.counter]),new xAe(this.view,"primary"),new AAe(this.view,fI.pan),new LAe(this.view,fI.zoom),new PAe(this.view,fI.rotate),new SAe(this.view,"secondary"),new _Ae(this.view,"touch")],ft.INTERNAL),this.view.viewEvents.connect(r),this._source=t,this._inputManager=r,we(()=>{var n,o;return(o=(n=this.view)==null?void 0:n.navigation)==null?void 0:o.browserTouchPanEnabled},n=>{this._source&&(this._source.browserTouchPanningEnabled=!n)},St)}get test(){return{inputManager:this._inputManager}}};g([w()],Xy.prototype,"view",void 0),g([w()],Xy.prototype,"latestPointerType",null),g([w()],Xy.prototype,"latestPointerLocation",null),g([w()],Xy.prototype,"multiTouchActive",null),Xy=g([te("esri.views.2d.input.MapViewInputManager")],Xy);const QAe=Xy;var QQ,eee,tee,iee={exports:{}};QQ=iee,eee=function(){function e(n,o,c,h,m){t(n,o,c||0,h||n.length-1,m||r)}function t(n,o,c,h,m){for(;h>c;){if(h-c>600){var b=h-c+1,x=o-c+1,I=Math.log(b),E=.5*Math.exp(2*I/3),k=.5*Math.sqrt(I*E*(b-E)/b)*(x-b/2<0?-1:1);t(n,o,Math.max(c,Math.floor(o-x*E/b+k)),Math.min(h,Math.floor(o+(b-x)*E/b+k)),m)}var P=n[o],F=c,N=h;for(i(n,c,o),m(n[h],P)>0&&i(n,c,h);F<N;){for(i(n,F,N),F++,N--;m(n[F],P)<0;)F++;for(;m(n[N],P)>0;)N--}m(n[c],P)===0?i(n,c,N):i(n,++N,h),N<=o&&(c=N+1),o<=N&&(h=N-1)}}function i(n,o,c){var h=n[o];n[o]=n[c],n[c]=h}function r(n,o){return n<o?-1:n>o?1:0}return e},(tee=eee())!==void 0&&(QQ.exports=tee);const e8e=iee.exports;function yI(e,t){if(!(this instanceof yI))return new yI(e,t);this._maxEntries=Math.max(4,e||9),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),t&&(typeof t=="function"?this.toBBox=t:this._initFormat(t)),this.clear()}function t8e(e,t,i){if(!i)return t.indexOf(e);for(var r=0;r<t.length;r++)if(i(e,t[r]))return r;return-1}function cv(e,t){t3(e,0,e.children.length,t,e)}function t3(e,t,i,r,n){n||(n=uv(null)),n.minX=1/0,n.minY=1/0,n.maxX=-1/0,n.maxY=-1/0;for(var o,c=t;c<i;c++)o=e.children[c],i3(n,e.leaf?r(o):o);return n}function i3(e,t){return e.minX=Math.min(e.minX,t.minX),e.minY=Math.min(e.minY,t.minY),e.maxX=Math.max(e.maxX,t.maxX),e.maxY=Math.max(e.maxY,t.maxY),e}function ree(e,t){return e.minX-t.minX}function nee(e,t){return e.minY-t.minY}function SL(e){return(e.maxX-e.minX)*(e.maxY-e.minY)}function mI(e){return e.maxX-e.minX+(e.maxY-e.minY)}function i8e(e,t){return(Math.max(t.maxX,e.maxX)-Math.min(t.minX,e.minX))*(Math.max(t.maxY,e.maxY)-Math.min(t.minY,e.minY))}function r8e(e,t){var i=Math.max(e.minX,t.minX),r=Math.max(e.minY,t.minY),n=Math.min(e.maxX,t.maxX),o=Math.min(e.maxY,t.maxY);return Math.max(0,n-i)*Math.max(0,o-r)}function ML(e,t){return e.minX<=t.minX&&e.minY<=t.minY&&t.maxX<=e.maxX&&t.maxY<=e.maxY}function gI(e,t){return t.minX<=e.maxX&&t.minY<=e.maxY&&t.maxX>=e.minX&&t.maxY>=e.minY}function uv(e){return{children:e,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function see(e,t,i,r,n){for(var o,c=[t,i];c.length;)(i=c.pop())-(t=c.pop())<=r||(o=t+Math.ceil((i-t)/r/2)*r,e8e(e,o,t,i,n),c.push(t,o,o,i))}yI.prototype={all:function(){return this._all(this.data,[])},search:function(e){var t=this.data,i=[],r=this.toBBox;if(!gI(e,t))return i;for(var n,o,c,h,m=[];t;){for(n=0,o=t.children.length;n<o;n++)c=t.children[n],gI(e,h=t.leaf?r(c):c)&&(t.leaf?i.push(c):ML(e,h)?this._all(c,i):m.push(c));t=m.pop()}return i},collides:function(e){var t=this.data,i=this.toBBox;if(!gI(e,t))return!1;for(var r,n,o,c,h=[];t;){for(r=0,n=t.children.length;r<n;r++)if(o=t.children[r],gI(e,c=t.leaf?i(o):o)){if(t.leaf||ML(e,c))return!0;h.push(o)}t=h.pop()}return!1},load:function(e){if(!e||!e.length)return this;if(e.length<this._minEntries){for(var t=0,i=e.length;t<i;t++)this.insert(e[t]);return this}var r=this._build(e.slice(),0,e.length-1,0);if(this.data.children.length)if(this.data.height===r.height)this._splitRoot(this.data,r);else{if(this.data.height<r.height){var n=this.data;this.data=r,r=n}this._insert(r,this.data.height-r.height-1,!0)}else this.data=r;return this},insert:function(e){return e&&this._insert(e,this.data.height-1),this},clear:function(){return this.data=uv([]),this},remove:function(e,t){if(!e)return this;for(var i,r,n,o,c=this.data,h=this.toBBox(e),m=[],b=[];c||m.length;){if(c||(c=m.pop(),r=m[m.length-1],i=b.pop(),o=!0),c.leaf&&(n=t8e(e,c.children,t))!==-1)return c.children.splice(n,1),m.push(c),this._condense(m),this;o||c.leaf||!ML(c,h)?r?(i++,c=r.children[i],o=!1):c=null:(m.push(c),b.push(i),i=0,r=c,c=c.children[0])}return this},toBBox:function(e){return e},compareMinX:ree,compareMinY:nee,toJSON:function(){return this.data},fromJSON:function(e){return this.data=e,this},_all:function(e,t){for(var i=[];e;)e.leaf?t.push.apply(t,e.children):i.push.apply(i,e.children),e=i.pop();return t},_build:function(e,t,i,r){var n,o=i-t+1,c=this._maxEntries;if(o<=c)return cv(n=uv(e.slice(t,i+1)),this.toBBox),n;r||(r=Math.ceil(Math.log(o)/Math.log(c)),c=Math.ceil(o/Math.pow(c,r-1))),(n=uv([])).leaf=!1,n.height=r;var h,m,b,x,I=Math.ceil(o/c),E=I*Math.ceil(Math.sqrt(c));for(see(e,t,i,E,this.compareMinX),h=t;h<=i;h+=E)for(see(e,h,b=Math.min(h+E-1,i),I,this.compareMinY),m=h;m<=b;m+=I)x=Math.min(m+I-1,b),n.children.push(this._build(e,m,x,r-1));return cv(n,this.toBBox),n},_chooseSubtree:function(e,t,i,r){for(var n,o,c,h,m,b,x,I;r.push(t),!t.leaf&&r.length-1!==i;){for(x=I=1/0,n=0,o=t.children.length;n<o;n++)m=SL(c=t.children[n]),(b=i8e(e,c)-m)<I?(I=b,x=m<x?m:x,h=c):b===I&&m<x&&(x=m,h=c);t=h||t.children[0]}return t},_insert:function(e,t,i){var r=this.toBBox,n=i?e:r(e),o=[],c=this._chooseSubtree(n,this.data,t,o);for(c.children.push(e),i3(c,n);t>=0&&o[t].children.length>this._maxEntries;)this._split(o,t),t--;this._adjustParentBBoxes(n,o,t)},_split:function(e,t){var i=e[t],r=i.children.length,n=this._minEntries;this._chooseSplitAxis(i,n,r);var o=this._chooseSplitIndex(i,n,r),c=uv(i.children.splice(o,i.children.length-o));c.height=i.height,c.leaf=i.leaf,cv(i,this.toBBox),cv(c,this.toBBox),t?e[t-1].children.push(c):this._splitRoot(i,c)},_splitRoot:function(e,t){this.data=uv([e,t]),this.data.height=e.height+1,this.data.leaf=!1,cv(this.data,this.toBBox)},_chooseSplitIndex:function(e,t,i){var r,n,o,c,h,m,b,x;for(m=b=1/0,r=t;r<=i-t;r++)c=r8e(n=t3(e,0,r,this.toBBox),o=t3(e,r,i,this.toBBox)),h=SL(n)+SL(o),c<m?(m=c,x=r,b=h<b?h:b):c===m&&h<b&&(b=h,x=r);return x},_chooseSplitAxis:function(e,t,i){var r=e.leaf?this.compareMinX:ree,n=e.leaf?this.compareMinY:nee;this._allDistMargin(e,t,i,r)<this._allDistMargin(e,t,i,n)&&e.children.sort(r)},_allDistMargin:function(e,t,i,r){e.children.sort(r);var n,o,c=this.toBBox,h=t3(e,0,t,c),m=t3(e,i-t,i,c),b=mI(h)+mI(m);for(n=t;n<i-t;n++)o=e.children[n],i3(h,e.leaf?c(o):o),b+=mI(h);for(n=i-t-1;n>=t;n--)o=e.children[n],i3(m,e.leaf?c(o):o),b+=mI(m);return b},_adjustParentBBoxes:function(e,t,i){for(var r=i;r>=0;r--)i3(t[r],e)},_condense:function(e){for(var t,i=e.length-1;i>=0;i--)e[i].children.length===0?i>0?(t=e[i-1].children).splice(t.indexOf(e[i]),1):this.clear():cv(e[i],this.toBBox)},_initFormat:function(e){var t=["return a"," - b",";"];this.compareMinX=new Function("a","b",t.join(e[0])),this.compareMinY=new Function("a","b",t.join(e[1])),this.toBBox=new Function("a","return {minX: a"+e[0]+", minY: a"+e[1]+", maxX: a"+e[2]+", maxY: a"+e[3]+"};")}};class vI{constructor(t,i){this.key=new va(0,0,0,0),this.bounds=ro(),this.objectIds=new Set,this.key.set(i);const r=t.getLODInfoAt(this.key);this.tileInfoView=t,this.tileInfoView.getTileBounds(this.bounds,this.key,!0),this.resolution=r.resolution,this.scale=r.scale,this.level=r.level}get id(){return this.key.id}get extent(){return gi.fromBounds(this.bounds,this.tileInfoView.tileInfo.spatialReference)}get transform(){return{originPosition:"upperLeft",scale:[this.resolution,this.resolution],translate:[this.bounds[0],this.bounds[3]]}}createChildTiles(){const t=this.key.getChildKeys(),i=$o.acquire();for(let r=0;r<t.length;r++)i[r]=new vI(this.tileInfoView,t[r]);return i}getQuantizationParameters(){return DJ.fromJSON({mode:"view",originPosition:"upperLeft",tolerance:this.resolution,extent:{xmin:this.bounds[0],ymin:this.bounds[1],xmax:this.bounds[2],ymax:this.bounds[3],spatialReference:this.tileInfoView.tileInfo.spatialReference}})}}const Qy={added:[],removed:[]},IL=new Set,n8e=new va(0,0,0,0);class s8e extends Or{constructor(t){super(),this._tiles=new Map,this._index=yI(9,Te("esri-csp-restrictions")?i=>({minX:i.bounds[0],minY:i.bounds[1],maxX:i.bounds[2],maxY:i.bounds[3]}):[".bounds[0]",".bounds[1]",".bounds[2]",".bounds[3]"]),this.tiles=[],this.tileScheme=t}destroy(){this.clear()}clear(){this.tiles.length=0,this._tiles.clear(),this._index.clear()}has(t){return this._tiles.has(t)}get(t){return this._tiles.get(t)}boundsIntersections(t){return this._index.search({minX:t[0],minY:t[1],maxX:t[2],maxY:t[3]})}updateTiles(t){const i={added:[],removed:[]};for(const r of t.added)if(!this.has(r)){const n=new vI(this.tileScheme,r);this._tiles.set(r,n),this._index.insert(n),i.added.push(n)}for(const r of t.removed)if(this.has(r)){const n=this.get(r);this._tiles.delete(r),this._index.remove(n),i.removed.push(n)}this.tiles.length=0,this._tiles.forEach(r=>this.tiles.push(r)),(i.added.length||i.removed.length)&&this.emit("update",i)}setViewState(t){const i=this.tileScheme.getTileCoverage(t,0);if(!i)return;const{spans:r,lodInfo:n}=i,{level:o}=n;if(r.length>0)for(const{row:c,colFrom:h,colTo:m}of r)for(let b=h;b<=m;b++){const x=n8e.set(o,c,n.normalizeCol(b),n.getWorldForColumn(b)).id;if(IL.add(x),!this.has(x)){const I=new vI(this.tileScheme,x);this._tiles.set(x,I),this._index.insert(I),this.tiles.push(I),Qy.added.push(I)}}for(let c=this.tiles.length-1;c>=0;c--){const h=this.tiles[c];IL.has(h.id)||(this._tiles.delete(h.id),this.tiles.splice(c,1),this._index.remove(h),Qy.removed.push(h))}(Qy.added.length||Qy.removed.length)&&this.emit("update",Qy),nv.pool.release(i),IL.clear(),Qy.added.length=0,Qy.removed.length=0}}let o8e=0,If=class extends Ye{constructor(){super(...arguments),this.color=new ut([0,255,255]),this.haloOpacity=1,this.fillOpacity=.25}get version(){return o8e++}};g([w({readOnly:!0})],If.prototype,"version",null),g([w({type:ut})],If.prototype,"color",void 0),g([w({type:ut})],If.prototype,"haloColor",void 0),g([w()],If.prototype,"haloOpacity",void 0),g([w()],If.prototype,"fillOpacity",void 0),If=g([te("esri.views.2d.support.HighlightOptions")],If);const oee=If,a8e=e=>e.includes("Brush");class aee{constructor(){this._names=new Map}begin(t){this._names.has(t)||(this._names.set(t,!1),a8e(t)&&this.record("Esri.FirstDraw"),performance.mark(`Esri.${t}.Start`))}end(t){this._names.has(t)&&!this._names.get(t)&&(this._names.set(t,!0),performance.mark(`Esri.${t}.End`))}record(t){this._names.has(t)||(this._names.set(t,!0),performance.mark(`Esri.${t}`))}}function l8e(e,t,i,r,n,o,c,h){let m;e.ignorePadding&&(r={left:0,right:0,top:0,bottom:0}),e.width!=null&&e.height!=null?m=[e.width,e.height]:e.width==null&&e.height!=null?m=[e.height,e.height]:e.width!=null&&e.height==null?m=[e.width,e.width]:e.width==null&&e.height==null&&(m=null);const b=i[0]-(r.left+r.right),x=i[1]-(r.top+r.bottom);let I,E,k=e.area||{x:0,y:0,width:b,height:x};if(m){const P=b/x,F=m[0]/m[1];if(F>P){const N=k.width/F;k={x:k.x,y:Math.round(k.y+(k.height-N)/2),width:k.width,height:Math.round(N)}}else{const N=k.height*F;k={x:Math.round(k.x+(k.width-N)/2),y:k.y,width:Math.round(N),height:k.height}}}else m=[k.width,k.height];return m[0]>k.width?(I=Math.min(m[0]/k.width,t),E=m[0]/k.width/I):(I=1,E=m[0]/k.width),{resolutionScale:I,cropArea:{x:Math.round((k.x+r.left)*I),y:Math.round((k.y+r.top)*I),width:Math.round(k.width*I),height:Math.round(k.height*I)},outputScale:E,format:n,quality:o,children:c,rotation:h}}let r3=null,bI=!0;function $Ke(e,t,i){if(!e||!t)throw new Error("Cannot construct image data without dimensions");if(bI)try{return new ImageData(e,t)}catch{bI=!1}return lee(e,t,i)}function EKe(e,t,i,r){if(!t||!i)throw new Error("Cannot construct image data without dimensions");if(bI)try{return new ImageData(e,t,i)}catch{bI=!1}const n=lee(t,i,r);return n.data.set(e,0),n}function c8e(){return r3||(r3=document.createElement("canvas"),r3.width=1,r3.height=1),r3}function lee(e,t,i){return i||(i=c8e()),i.getContext("2d").createImageData(e,t)}function u8e(e,t,i){const{ctx:r,canvas:n}=cee(e,i),o=r.getImageData(0,0,e.width,e.height),c=d8e(n,t);return uee(n),{dataUrl:c,data:o}}function h8e(e,t){const{ctx:i,canvas:r}=cee(e,t),n=i.getImageData(0,0,e.width,e.height);return uee(r),n}function cee(e,t){const i=p8e();t.premultipliedAlpha&&v8e(e),i.width=e.width,i.height=e.height;const r=i.getContext("2d");return r.putImageData(e,0,0),t.flipY&&g8e(r),{ctx:r,canvas:i}}function uee(e){e.width=0,e.height=0}function p8e(){return ce($L)&&($L=document.createElement("canvas")),$L}let $L=null;function d8e(e,t){const i=b8e[t.format],r=t.quality/100;return e.toDataURL(i,r)}function f8e(e,t){const i=m8e(e),r=_8e[i];return{format:i,quality:Vs(t!=null?t:r,0,100)}}function y8e(e,t){return t/Math.max(e[0],e[1])}function TKe(e,t,i,r=0,n=0,o=e.width-r,c=e.height-n,h=!1){const{data:m}=e,{width:b,height:x,data:I}=t,E=o/b,k=c/x,P=Math.ceil(E/2),F=Math.ceil(k/2),N=e.width;for(let B=0;B<x;B++)for(let z=0;z<b;z++){const q=4*(z+(h?x-B-1:B)*b);let J=0,X=0,Y=0,ae=0,he=0,fe=0;const ye=(B+.5)*k;for(let xe=Math.floor(B*k);xe<(B+1)*k;xe++){const Se=Math.abs(ye-(xe+.5))/F,Ae=(z+.5)*E,Oe=Se*Se;for(let bt=Math.floor(z*E);bt<(z+1)*E;bt++){const st=Math.abs(Ae-(bt+.5))/P,et=Math.sqrt(Oe+st*st);if(et>=1)continue;let He=2*et*et*et-3*et*et+1;const Et=4*(r+bt+(n+xe)*N);fe+=He*m[Et+3],X+=He,!i&&m[Et+3]<255&&(He=He*m[Et+3]/255),Y+=He*m[Et],ae+=He*m[Et+1],he+=He*m[Et+2],J+=He}}I[q]=Y/J,I[q+1]=ae/J,I[q+2]=he/J,I[q+3]=fe/X}return t}function m8e(e){switch(e){case"png":case"jpg":case"jpeg":return e;default:return w8e}}function g8e(e){e.save(),e.globalCompositeOperation="copy",e.scale(1,-1),e.translate(0,-e.canvas.height),e.drawImage(e.canvas,0,0),e.restore()}function v8e(e){const t=e.data,i=t.length;for(let r=0;r<i;r+=4){const n=t[r+3];if(n!==255&&n>0){const o=255/n;t[r+0]=t[r+0]*o,t[r+1]=t[r+1]*o,t[r+2]=t[r+2]*o}}}const b8e={png:"image/png",jpg:"image/jpeg",jpeg:"image/jpeg"},hee=98,w8e="png",_8e={png:100,jpg:hee,jpeg:hee};var En;function CKe(e,t,i={}){const r=pee(e);for(;r.length>1;){const n=wI(t,r.shift(),i);if(H(n))return n}return x8e(t,r.shift(),i)}function pee(e){const t=Te("esri-force-webgl");if(t===En.WEBGL1||t===En.WEBGL2)return[t];switch(e){case"2d":return Te("mac")&&Te("chrome")?[En.WEBGL1,En.WEBGL2]:[En.WEBGL2,En.WEBGL1];case"3d":return[En.WEBGL2,En.WEBGL1]}}function x8e(e,t,i={}){if(!window.WebGLRenderingContext)return dee(e,S8e),null;const r=wI(e,t,i);return ce(r)&&dee(e,M8e),r}function wI(e,t,i={}){const r=t===En.WEBGL1?["webgl","experimental-webgl","webkit-3d","moz-webgl"]:["webgl2"];let n=null;for(const o of r){try{n=e.getContext(o,i)}catch{}if(n)break}return n}function dee(e,t){const i=e.parentNode;i&&(i.innerHTML='<table style="background-color: #8CE; width: 100%; height: 100%;"><tr><td align="center"><div style="display: table-cell; vertical-align: middle;"><div style="">'+t+"</div></div></td></tr></table>")}(function(e){e[e.WEBGL1=1]="WEBGL1",e[e.WEBGL2=2]="WEBGL2"})(En||(En={}));const S8e='This page requires a browser that supports WebGL.<br/><a href="http://get.webgl.org">Click here to upgrade your browser.</a>',M8e=`It doesn't appear your computer can support WebGL.<br/><a href="http://get.webgl.org/troubleshooting/">Click here for more information.</a>`;let EL,TL;function I8e(e){const t=pee(e);for(;t.length>1;){const i=fee(t.shift());if(i.available)return i}return fee(t.shift())}function fee(e){switch(e){case En.WEBGL1:return $8e();case En.WEBGL2:return E8e()}}function $8e(){return EL||(EL=k8e()),EL}function E8e(){return TL||(TL=A8e()),TL}class yee{constructor(){this.available=!1,this.majorPerformanceCaveat=!1,this.maxTextureSize=0,this.supportsVertexShaderSamplers=!1,this.supportsHighPrecisionFragment=!1,this.supportsElementIndexUint=!1,this.supportsStandardDerivatives=!1,this.supportsInstancedArrays=!1,this.supportsTextureFloat=!1,this.supportsTextureHalfFloat=!1,this.supportsColorBufferFloat=!1,this.supportsColorBufferFloatBlend=!1,this.supportsColorBufferHalfFloat=!1}}class T8e extends yee{constructor(){super(...arguments),this.type=En.WEBGL1}}class C8e extends yee{constructor(){super(...arguments),this.type=En.WEBGL2,this.supportsElementIndexUint=!0,this.supportsStandardDerivatives=!0,this.supportsInstancedArrays=!0,this.supportsTextureFloat=!0,this.supportsTextureHalfFloat=!0}}function mee(e,t){var o;if(e===En.WEBGL1&&typeof WebGLRenderingContext=="undefined"||e===En.WEBGL2&&typeof WebGL2RenderingContext=="undefined")return null;const i=document.createElement("canvas");if(!i)return null;let r=wI(i,e,{failIfMajorPerformanceCaveat:!0});if(ce(r)&&(r=wI(i,e),H(r)&&(t.majorPerformanceCaveat=!0)),ce(r))return r;if(e===En.WEBGL1){const c=(o=r.getParameter(r.VERSION))==null?void 0:o.match(/^WebGL\s+([\d.]*)/);if(c){const h=parseFloat(c[1]);t.available=h>=.94}}else t.available=!0;t.maxTextureSize=r.getParameter(r.MAX_TEXTURE_SIZE),t.supportsVertexShaderSamplers=r.getParameter(r.MAX_VERTEX_TEXTURE_IMAGE_UNITS)>0;const n=r.getShaderPrecisionFormat(r.FRAGMENT_SHADER,r.HIGH_FLOAT);return n&&(t.supportsHighPrecisionFragment=n.precision>0),r}function k8e(){const e=new T8e,t=mee(En.WEBGL1,e);return ce(t)||(e.supportsElementIndexUint=t.getExtension("OES_element_index_uint")!==null,e.supportsStandardDerivatives=t.getExtension("OES_standard_derivatives")!==null,e.supportsInstancedArrays=t.getExtension("ANGLE_instanced_arrays")!==null,e.supportsTextureFloat=t.getExtension("OES_texture_float")!==null,e.supportsTextureHalfFloat=t.getExtension("OES_texture_half_float")!==null,e.supportsColorBufferFloat=t.getExtension("WEBGL_color_buffer_float")!==null,e.supportsColorBufferFloatBlend=t.getExtension("EXT_float_blend")!==null,e.supportsColorBufferHalfFloat=t.getExtension("EXT_color_buffer_half_float")!==null),e}function A8e(){const e=new C8e,t=mee(En.WEBGL2,e);return ce(t)||(e.supportsColorBufferFloat=t.getExtension("EXT_color_buffer_float")!==null,e.supportsColorBufferFloatBlend=t.getExtension("EXT_float_blend")!==null,e.supportsColorBufferHalfFloat=e.supportsColorBufferFloat||t.getExtension("EXT_color_buffer_half_float")!==null),e}function P8e(e){const t=I8e(e);if(!t.available)return new ue("webgl:required","WebGL is required but not supported.");if(e==="3d"&&t.majorPerformanceCaveat)return new ue("webgl:major-performance-caveat-detected","Your WebGL implementation doesn't seem to support hardware accelerated rendering. Check your browser settings or if your GPU is in a blocklist.");if(!t.supportsHighPrecisionFragment)return new ue("webgl:high-precision-fragment-required","WebGL support for high precision fragment shaders is required but not supported.");if(!t.supportsVertexShaderSamplers)return new ue("webgl:vertex-shader-samplers-required","WebGL support for vertex shader samplers is required but not supported.");if(t.type===En.WEBGL1){if(!t.supportsElementIndexUint)return new ue("webgl:element-index-uint-required","WebGL support for uint vertex indices is required but not supported.");if(!t.supportsStandardDerivatives)return new ue("webgl:standard-derivatives-required","WebGL support for standard derivatives is required but not supported.");if(!t.supportsInstancedArrays)return new ue("webgl:instanced-arrays-required","WebGL support for instanced rendering is required but not supported.")}return null}function L8e(e){return e&&"nodeType"in e}function O8e(e){return e&&typeof e.render=="function"}const gee={component:"esri-component"};let em=class extends Ye{constructor(){super(...arguments),this.widget=null}destroy(){this.widget&&this.widget.destroy(),this.node=null}get id(){return this.get("widget.id")||this.get("node.id")}set node(e){const t=this._get("node");e!==t&&(e&&e.classList.add(gee.component),t&&t.classList.remove(gee.component),this._set("node",e))}castNode(e){return e?typeof e=="string"||L8e(e)?(this._set("widget",null),a9(e)):(O8e(e)&&!e.domNode&&(e.domNode=document.createElement("div")),this._set("widget",e),e.domNode):(this._set("widget",null),null)}};g([w({dependsOn:[]})],em.prototype,"id",null),g([w()],em.prototype,"node",null),g([Dt("node")],em.prototype,"castNode",null),g([w({readOnly:!0})],em.prototype,"widget",void 0),em=g([te("esri.views.ui.Component")],em);const _I=em,R8e={left:0,top:0,bottom:0,right:0},vee={bottom:30,top:15,right:15,left:15},CL="manual",Fo={ui:"esri-ui",corner:"esri-ui-corner",innerContainer:"esri-ui-inner-container",manualContainer:"esri-ui-manual-container",cornerContainer:"esri-ui-corner-container",topLeft:"esri-ui-top-left",topRight:"esri-ui-top-right",bottomLeft:"esri-ui-bottom-left",bottomRight:"esri-ui-bottom-right"};function F8e(e){return e&&!e._started&&typeof e.postMixInProperties=="function"&&typeof e.buildRendering=="function"&&typeof e.postCreate=="function"&&typeof e.startup=="function"}function kL(e){const t=e,i=typeof t=="object"&&t!==null&&Object.getPrototypeOf(t);return(i===null||i===Object.prototype)&&("component"in t||"index"in t||"position"in t)?e:null}function AL(e,{top:t,bottom:i,left:r,right:n}){e.style.top=t,e.style.bottom=i,e.style.left=r,e.style.right=n}let up=class extends Or.EventedAccessor{constructor(e){super(e),this._cornerNameToContainerLookup={},this._positionNameToContainerLookup={},this._components=new Array,this._componentToKey=new Map,this._handles=new Ti,this.view=null,this._applyViewPadding=()=>{const t=this.container;t&&AL(t,this._toPxPosition(this._getViewPadding()))},this._applyUIPadding=()=>{const t=this._innerContainer;t&&AL(t,this._toPxPosition(this.padding))},this._initContainers()}initialize(){this._handles.add([we(()=>{var e;return[(e=this.view)==null?void 0:e.padding,this.container]},this._applyViewPadding,St),we(()=>this.padding,this._applyUIPadding,St)])}destroy(){this.container=null;for(const e of this._components)e.destroy();this._components.length=0,this._handles.destroy(),this._componentToKey.clear()}set container(e){const t=this._get("container");e!==t&&(e&&(e.classList.add(Fo.ui),m9e(e),this._attachContainers(e)),t&&(t.classList.remove(Fo.ui),AL(t,{top:"",bottom:"",left:"",right:""}),Mq(t)),this._set("container",e))}get height(){const e=this.get("view.height")||0;if(e===0)return e;const t=this._getViewPadding(),i=t.top+t.bottom;return Math.max(e-i,0)}get padding(){return this._get("padding")}set padding(e){this._overrideIfSome("padding",e)}castPadding(e){return typeof e=="number"?{bottom:e,top:e,right:e,left:e}:K(K({},vee),e)}get width(){const e=this.get("view.width")||0;if(e===0)return e;const t=this._getViewPadding(),i=t.left+t.right;return Math.max(e-i,0)}add(e,t){let i,r;if(Array.isArray(e))return void e.forEach(o=>this.add(o,t));const n=kL(e);n&&({index:i,position:t,component:e,key:r}=n),t&&typeof t=="object"&&({index:i,key:r,position:t}=t),!e||t&&!this._isValidPosition(t)||this._add(e,t,i,r)}remove(e,t){if(!e)return;if(Array.isArray(e))return e.map(r=>this.remove(r,t));const i=this._find(e);if(i){const r=this._componentToKey;if(r.has(e)&&r.get(e)!==t)return;const n=this._components.indexOf(i);return i.node.parentNode&&i.node.parentNode.removeChild(i.node),this._componentToKey.delete(e),this._components.splice(n,1)[0]}}empty(e){return Array.isArray(e)?e.map(t=>this.empty(t)).reduce((t,i)=>t.concat(i)):(e=e||CL)===CL?Array.prototype.slice.call(this._manualContainer.children).filter(t=>!t.classList.contains(Fo.corner)).map(t=>this.remove(t)):this._isValidPosition(e)?Array.prototype.slice.call(this._cornerNameToContainerLookup[e].children).map(this.remove,this):null}move(e,t){if(Array.isArray(e)&&e.forEach(o=>this.move(o,t)),!e)return;let i;const r=kL(e)||kL(t);if(r&&(i=r.index,t=r.position,e=r.component||e),t&&!this._isValidPosition(t))return;const n=this.remove(e);n&&this.add(n,{position:t,index:i})}find(e){if(!e)return null;const t=this._findById(e);return t&&(t.widget||t.node)}getPosition(e){for(const t in this._positionNameToContainerLookup)if(this._positionNameToContainerLookup[t].contains(e))return t;return null}_add(e,t,i,r){e instanceof _I||(e=new _I({node:e})),this._place({component:e,position:t,index:i}),this._components.push(e),r&&this._componentToKey.set(e,r)}_find(e){return e?e instanceof _I?this._findByComponent(e):typeof e=="string"?this._findById(e):this._findByNode(e.domNode||e):null}_getViewPadding(){return this.get("view.padding")||R8e}_attachContainers(e){e.appendChild(this._innerContainer),e.appendChild(this._manualContainer)}_initContainers(){const e=document.createElement("div");e.classList.add(Fo.innerContainer),e.classList.add(Fo.cornerContainer);const t=document.createElement("div");t.classList.add(Fo.innerContainer),t.classList.add(Fo.manualContainer);const i=document.createElement("div");i.classList.add(Fo.topLeft),i.classList.add(Fo.corner),e.appendChild(i);const r=document.createElement("div");r.classList.add(Fo.topRight),r.classList.add(Fo.corner),e.appendChild(r);const n=document.createElement("div");n.classList.add(Fo.bottomLeft),n.classList.add(Fo.corner),e.appendChild(n);const o=document.createElement("div");o.classList.add(Fo.bottomRight),o.classList.add(Fo.corner),e.appendChild(o),this._innerContainer=e,this._manualContainer=t;const c=Ms();this._cornerNameToContainerLookup={"top-left":i,"top-right":r,"bottom-left":n,"bottom-right":o,"top-leading":c?r:i,"top-trailing":c?i:r,"bottom-leading":c?o:n,"bottom-trailing":c?n:o},this._positionNameToContainerLookup=K({manual:t},this._cornerNameToContainerLookup)}_isValidPosition(e){return!!this._positionNameToContainerLookup[e]}_place(e){const t=e.component,i=e.position||CL,r=e.index,n=this._positionNameToContainerLookup[i],o=r>-1;if(F8e(t.widget)&&t.widget.startup(),!o)return void n.appendChild(t.node);const c=Array.prototype.slice.call(n.children);if(r===0)return void(n.firstChild?Iq(t.node,n.firstChild):n.appendChild(t.node));r>=c.length?n.appendChild(t.node):Iq(t.node,c[r])}_toPxPosition(e){return{top:this._toPxUnit(e.top),left:this._toPxUnit(e.left),right:this._toPxUnit(e.right),bottom:this._toPxUnit(e.bottom)}}_toPxUnit(e){return e===0?"0":e+"px"}_findByComponent(e){let t,i=null;return this._components.some(r=>(t=r===e,t&&(i=r),t)),i}_findById(e){let t,i=null;return this._components.some(r=>(t=r.id===e,t&&(i=r),t)),i}_findByNode(e){let t,i=null;return this._components.some(r=>(t=r.node===e,t&&(i=r),t)),i}};g([w()],up.prototype,"container",null),g([w()],up.prototype,"height",null),g([w({value:vee})],up.prototype,"padding",null),g([Dt("padding")],up.prototype,"castPadding",null),g([w()],up.prototype,"view",void 0),g([w()],up.prototype,"width",null),up=g([te("esri.views.ui.UI")],up);const N8e=up;function bee(e,t){return e&&"copyright"in e&&(!t||typeof e.originOf=="function"&&e.originOf("copyright")==="user")}function D8e(e,t){return e.length!==t.length||e.some((i,r)=>i.text!==t[r].text)}function xI(e,t,i){!i||!t||e.find(r=>r.layerView===t&&r.text===i)||e.push({text:i,layerView:t})}function j8e(e){return e.type==="bing-maps"}const $f=[];let hv=class extends dy{constructor(e){super(e),this._clear=()=>{this._fetchedAttributionData.clear(),this._pendingAttributions.clear(),this.handles.remove("suspension"),this.notifyChange("state")},this._pendingAttributions=new Set,this._fetchedAttributionData=new Map,this.items=new Xe,this.view=null,this._allLayerViewsChange=t=>{this.handles.remove("suspension");const i=this.get("view.allLayerViews");i&&this.handles.add(i.map(r=>we(()=>{var n;return[r.suspended,(n=r.layer)==null?void 0:n.attributionVisible]},()=>this._updateAttributionItems())),"suspension"),t&&t.removed&&t.removed.forEach(r=>{this._pendingAttributions.delete(r),this._fetchedAttributionData.delete(r)}),this._updateAttributionItems()},this.handles.add([vr(()=>{var t;return(t=this.view)==null?void 0:t.allLayerViews},"change",t=>this._allLayerViewsChange(t),{onListenerAdd:()=>this._allLayerViewsChange(),onListenerRemove:this._clear}),os(()=>{var t;return((t=this.view)==null?void 0:t.stationary)===!0},()=>this._updateAttributionItems())])}destroy(){this.view=null,this._fetchedAttributionData.clear(),this._pendingAttributions.clear(),this.items.removeAll()}get state(){return this.get("view.ready")?this._pendingAttributions.size>0?"loading":"ready":"disabled"}_updateAttributionItems(){const e=this.get("view.allLayerViews");$f.length=0,e?(e.forEach(t=>{var n;if(t.suspended||!((n=t.layer)==null?void 0:n.attributionVisible))return;const i=t.layer;if(bee(i,"user"))return void xI($f,t,i.copyright);if(i.hasAttributionData){if(this._fetchedAttributionData.has(t)){const o=this._fetchedAttributionData.get(t);return void(o?xI($f,t,this._getDynamicAttribution(o,this.view,i)):bee(i)&&xI($f,t,i.copyright))}return void this._fetchAttributionData(t)}const r=i.get("portalItem.accessInformation");xI($f,t,r||i.copyright)}),D8e(this.items,$f)&&(this.items.removeAll(),this.items.addMany($f)),$f.length=0,this.notifyChange("state")):this._clear()}async _fetchAttributionData(e){if(this._pendingAttributions.has(e))return;this._pendingAttributions.add(e);const t=await V5(e.layer.fetchAttributionData());if(this._pendingAttributions.has(e)){const i=t.ok?this._createContributionIndex(t.value,j8e(e.layer)):null;this._pendingAttributions.delete(e),this._fetchedAttributionData.set(e,i)}this._updateAttributionItems()}_createContributionIndex(e,t){const i=e.contributors,r={};if(!i)return r;for(let n=0;n<i.length;n++){const o=i[n],c=o.coverageAreas;if(!c)return;for(const h of c){const m=h.bbox,b=h.zoomMin-(t&&h.zoomMin?1:0),x=h.zoomMax-(t&&h.zoomMax?1:0),I={xmin:m[1],ymin:m[0],xmax:m[3],ymax:m[2],spatialReference:Mt.WGS84},E={extent:tu(I),attribution:o.attribution||"",score:h.score!=null?h.score:100,id:n};for(let k=b;k<=x;k++)r[k]=r[k]||[],r[k].push(E)}}return r.maxKey=Math.max.apply(null,Object.keys(r)),r}_getDynamicAttribution(e,t,i){const{extent:r,scale:n}=t;let o=i.tileInfo.scaleToZoom(n);if(o=Math.min(e.maxKey,Math.round(o)),!r||o==null||o<=-1)return"";const c=e[o],h=gw(r.center.clone().normalize(),t.spatialReference),m={};return c?c.filter(b=>{const x=!m[b.id]&&h&&RS(b.extent,h);return x&&(m[b.id]=!0),x}).sort((b,x)=>x.score-b.score||b.objectId-x.objectId).map(b=>b.attribution).join(", "):""}};g([w({readOnly:!0,type:Xe})],hv.prototype,"items",void 0),g([w({readOnly:!0})],hv.prototype,"state",null),g([w()],hv.prototype,"view",void 0),hv=g([te("esri.widgets.Attribution.AttributionViewModel")],hv);const wee=hv,Ef={base:"esri-attribution esri-widget",poweredBy:"esri-attribution__powered-by",sources:"esri-attribution__sources",open:"esri-attribution--open",sourcesOpen:"esri-attribution__sources--open",link:"esri-attribution__link",widgetIcon:"esri-icon-description",interactive:"esri-interactive"};let No=class extends ki{constructor(e,t){super(e,t),this._isOpen=!1,this._attributionTextOverflowed=!1,this._prevSourceNodeHeight=0,this._resizeObserver=new ResizeObserver(i=>i.forEach(({target:r})=>this._checkSourceTextOverflow(r))),this.iconClass=Ef.widgetIcon,this.itemDelimiter=" | ",this.messages=null,this.viewModel=new wee}initialize(){this.addHandles(vr(()=>{var e;return(e=this.viewModel)==null?void 0:e.items},"change",()=>this.scheduleRender()))}destroy(){var e;(e=this._resizeObserver)==null||e.disconnect()}get _isInteractive(){return this._isOpen||this._attributionTextOverflowed}get attributionText(){return this.viewModel.items.reduce((e,t)=>(e.includes(t.text)||e.push(t.text),e),[]).join(this.itemDelimiter)}get label(){var e,t;return(t=(e=this.messages)==null?void 0:e.widgetLabel)!=null?t:""}set label(e){this._overrideIfSome("label",e)}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}render(){const e={[Ef.open]:this._isOpen};return j("div",{bind:this,class:this.classes(Ef.base,e),dir:"ltr",onclick:this._toggleState,onkeydown:this._toggleState},this.renderSourcesNode(),this.renderPoweredBy())}renderPoweredBy(){return j("div",{class:Ef.poweredBy},"Powered by"," ",j("a",{class:Ef.link,href:"http://www.esri.com/",target:"_blank",rel:"noreferrer"},"Esri"))}renderSourcesNode(){const e=this._isOpen,t=this._isInteractive,i=t?"0":"",{attributionText:r}=this,n={[Ef.sourcesOpen]:e,[Ef.interactive]:t};return j("div",{afterCreate:this._afterSourcesNodeCreate,bind:this,class:this.classes(Ef.sources,n),innerHTML:r,tabindex:i})}_afterSourcesNodeCreate(e){this._prevSourceNodeHeight=e.clientWidth,this._resizeObserver.observe(e)}_checkSourceTextOverflow(e){let t=!1;const{clientHeight:i,clientWidth:r,scrollWidth:n}=e,o=n>r,c=this._attributionTextOverflowed!==o;if(this._attributionTextOverflowed=o,c&&(t=!0),this._isOpen){const h=i<this._prevSourceNodeHeight;this._prevSourceNodeHeight=i,h&&(this._isOpen=!1,t=!0)}t&&this.scheduleRender()}_toggleState(){this._isInteractive&&(this._isOpen=!this._isOpen)}};g([w()],No.prototype,"_isOpen",void 0),g([w()],No.prototype,"_isInteractive",null),g([w()],No.prototype,"_attributionTextOverflowed",void 0),g([w()],No.prototype,"_prevSourceNodeHeight",void 0),g([w({readOnly:!0,dependsOn:["viewModel.items.length","itemDelimiter"]})],No.prototype,"attributionText",null),g([w()],No.prototype,"iconClass",void 0),g([w()],No.prototype,"itemDelimiter",void 0),g([w()],No.prototype,"label",null),g([w(),ci("esri/widgets/Attribution/t9n/Attribution")],No.prototype,"messages",void 0),g([w()],No.prototype,"view",null),g([w({type:wee})],No.prototype,"viewModel",void 0),g([Ki()],No.prototype,"_toggleState",null),No=g([te("esri.widgets.Attribution")],No);const V8e=No,z8e="esri.widgets.CompassViewModel";let tm=class extends Z1(Ye){constructor(e){super(e),this._handles=new Ti,this.orientation={x:0,y:0,z:0},this.view=null,this._updateForCamera=this._updateForCamera.bind(this),this._updateForRotation=this._updateForRotation.bind(this),this._updateRotationWatcher=this._updateRotationWatcher.bind(this)}initialize(){this._handles.add(we(()=>this.view,this._updateRotationWatcher,St))}destroy(){this._handles=mr(this._handles),this.view=null}get canShowNorth(){const e=this.get("view.spatialReference");return!(!e||!e.isWebMercator&&!e.isGeographic)}get state(){return this.get("view.ready")?this.canShowNorth?"compass":"rotation":"disabled"}reset(){if(!this.get("view.ready"))return;const e={};this.view.type==="2d"?e.rotation=0:e.heading=0,this.callGoTo({target:e})}_updateForRotation(e){e!=null&&(this.orientation={z:e})}_updateForCamera(e){if(!e)return;const t=-e.heading;this.orientation={x:0,y:0,z:t}}_updateRotationWatcher(e){this._handles.removeAll(),e&&this._handles.add(e.type==="2d"?we(()=>e==null?void 0:e.rotation,this._updateForRotation,St):we(()=>e==null?void 0:e.camera,this._updateForCamera,St))}};g([w({readOnly:!0})],tm.prototype,"canShowNorth",null),g([w()],tm.prototype,"orientation",void 0),g([w({readOnly:!0})],tm.prototype,"state",null),g([w()],tm.prototype,"view",void 0),tm=g([te(z8e)],tm);const _ee=tm,Tf={base:"esri-compass esri-widget--button esri-widget",text:"esri-icon-font-fallback-text",icon:"esri-compass__icon",rotationIcon:"esri-icon-dial",northIcon:"esri-icon-compass",widgetIcon:"esri-icon-locate-circled",interactive:"esri-interactive",disabled:"esri-disabled"};let Pu=class extends ki{constructor(e,t){super(e,t),this.iconClass=Tf.widgetIcon,this.messages=null,this.viewModel=new _ee}get goToOverride(){return this.viewModel.goToOverride}set goToOverride(e){this.viewModel.goToOverride=e}get label(){var e,t;return(t=(e=this.messages)==null?void 0:e.widgetLabel)!=null?t:""}set label(e){this._overrideIfSome("label",e)}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}reset(){return this.viewModel.reset()}render(){const{orientation:e,state:t}=this.viewModel,i=t==="disabled",r=(t==="rotation"?"rotation":"compass")=="compass",n=i?-1:0,o={[Tf.disabled]:i,[Tf.interactive]:!i},c={[Tf.northIcon]:r,[Tf.rotationIcon]:!r},{messages:h}=this;return j("div",{bind:this,class:this.classes(Tf.base,o),onclick:this._reset,onkeydown:this._reset,role:"button",tabIndex:n,"aria-label":h.reset,title:h.reset},j("span",{"aria-hidden":"true",class:this.classes(Tf.icon,c),styles:this._toRotationTransform(e)}),j("span",{class:Tf.text},h.reset))}_reset(){this.viewModel.reset()}_toRotationTransform(e){return{transform:`rotateZ(${e.z}deg)`}}};g([w()],Pu.prototype,"goToOverride",null),g([w()],Pu.prototype,"iconClass",void 0),g([w()],Pu.prototype,"label",null),g([w(),ci("esri/widgets/Compass/t9n/Compass")],Pu.prototype,"messages",void 0),g([w()],Pu.prototype,"view",null),g([w({type:_ee})],Pu.prototype,"viewModel",void 0),g([Ki()],Pu.prototype,"_reset",null),Pu=g([te("esri.widgets.Compass")],Pu);const G8e=Pu;let pv=class extends Ye{constructor(e){super(e),this.navigationMode="pan",this.view=null}initialize(){this.own(os(()=>{var e;return(e=this.view)==null?void 0:e.inputManager},()=>this._setNavigationMode()))}destroy(){this.view=null}get state(){return this.get("view.ready")&&this.view.type==="3d"?"ready":"disabled"}toggle(){this.state!=="disabled"&&(this.navigationMode=this.navigationMode!=="pan"?"pan":"rotate",this._setNavigationMode())}_setNavigationMode(){this.get("view.inputManager").primaryDragAction=this.navigationMode==="pan"?"pan":"rotate"}};g([w({readOnly:!0})],pv.prototype,"state",null),g([w()],pv.prototype,"navigationMode",void 0),g([w()],pv.prototype,"view",void 0),pv=g([te("esri.widgets.NavigationToggleViewModel")],pv);const xee=pv,El={base:"esri-navigation-toggle esri-widget",button:"esri-navigation-toggle__button esri-widget--button",activeButton:"esri-navigation-toggle__button--active",panButton:"esri-navigation-toggle__button--pan",rotateButton:"esri-navigation-toggle__button--rotate",isLayoutHorizontal:"esri-navigation-toggle--horizontal",rotationIcon:"esri-icon-rotate",panIcon:"esri-icon-pan",widgetIcon:"esri-icon-pan2",disabled:"esri-disabled"};let Lu=class extends ki{constructor(e,t){super(e,t),this.iconClass=El.widgetIcon,this.messages=null,this.viewModel=new xee}get label(){var e,t;return(t=(e=this.messages)==null?void 0:e.widgetLabel)!=null?t:""}set label(e){this._overrideIfSome("label",e)}set layout(e){e!=="horizontal"&&(e="vertical"),this._set("layout",e)}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}toggle(){return this.viewModel.toggle()}render(){const e=this.get("viewModel.state")==="disabled",t=this.get("viewModel.navigationMode")==="pan",i={[El.disabled]:e,[El.isLayoutHorizontal]:this.layout==="horizontal"},r={[El.activeButton]:t},n={[El.activeButton]:!t},o=e?-1:0,c=this.messages.toggle;return j("div",{bind:this,class:this.classes(El.base,i),onclick:this._toggle,onkeydown:this._toggle,tabIndex:o,"aria-label":c,title:c},j("div",{class:this.classes(El.button,El.panButton,r)},j("span",{class:El.panIcon})),j("div",{class:this.classes(El.button,El.rotateButton,n)},j("span",{class:El.rotationIcon})))}_toggle(){this.toggle()}};g([w()],Lu.prototype,"iconClass",void 0),g([w()],Lu.prototype,"label",null),g([w({value:"vertical"})],Lu.prototype,"layout",null),g([w(),ci("esri/widgets/NavigationToggle/t9n/NavigationToggle")],Lu.prototype,"messages",void 0),g([w()],Lu.prototype,"view",null),g([w({type:xee})],Lu.prototype,"viewModel",void 0),g([Ki()],Lu.prototype,"_toggle",null),Lu=g([te("esri.widgets.NavigationToggle")],Lu);const B8e=Lu,n3={button:"esri-widget--button esri-widget",disabled:"esri-disabled",interactive:"esri-interactive",iconText:"esri-icon-font-fallback-text",icon:"esri-icon"};let Cf=class extends ki{constructor(){super(...arguments),this.enabled=!0,this.iconClass="",this.title=""}render(){const e=this.enabled?0:-1,t={[n3.disabled]:!this.enabled,[n3.interactive]:this.enabled},i={[this.iconClass]:!!this.iconClass};return j("div",{bind:this,class:this.classes(n3.button,t),onclick:this._triggerAction,onkeydown:this._triggerAction,role:"button",tabIndex:e,title:this.title},j("span",{"aria-hidden":"true",role:"presentation",class:this.classes(n3.icon,i)}),j("span",{class:n3.iconText},this.title))}_triggerAction(){this.action.call(this)}};g([w()],Cf.prototype,"action",void 0),g([w()],Cf.prototype,"enabled",void 0),g([w()],Cf.prototype,"iconClass",void 0),g([w()],Cf.prototype,"title",void 0),g([Ki()],Cf.prototype,"_triggerAction",null),Cf=g([te("esri.widgets.IconButton")],Cf);const See=Cf;let dv=class extends Ye{get canZoomIn(){if(!this.get("view.ready"))return!1;const e=this.get("view.animation.target.scale")||this.get("view.scale"),t=this.get("view.constraints.effectiveMaxScale");return t===0||e>t}get canZoomOut(){if(!this.get("view.ready"))return!1;const e=this.get("view.animation.target.scale")||this.get("view.scale"),t=this.get("view.constraints.effectiveMinScale");return t===0||e<t}};g([w({readOnly:!0})],dv.prototype,"canZoomIn",null),g([w({readOnly:!0})],dv.prototype,"canZoomOut",null),g([w()],dv.prototype,"view",void 0),dv=g([te("esri.widgets.Zoom.ZoomConditions2D")],dv);const U8e=dv;let fv=class extends Ye{get canZoomIn(){return!!this.view.ready}get canZoomOut(){return!!this.view.ready}};g([w({readOnly:!0})],fv.prototype,"canZoomIn",null),g([w({readOnly:!0})],fv.prototype,"canZoomOut",null),g([w()],fv.prototype,"view",void 0),fv=g([te("esri.widgets.Zoom.ZoomConditions3D")],fv);const q8e=fv;let kf=class extends Ye{constructor(e){super(e)}destroy(){this.view=null}get canZoomIn(){return H(this._zoomConditions)&&this._zoomConditions.canZoomIn}get canZoomOut(){var e;return H(this._zoomConditions)&&((e=this._zoomConditions)==null?void 0:e.canZoomOut)}get state(){var e;return((e=this.view)==null?void 0:e.ready)?"ready":"disabled"}set view(e){e?e.type==="2d"?this._zoomConditions=new U8e({view:e}):e.type==="3d"&&(this._zoomConditions=new q8e({view:e})):this._zoomConditions=null,this._set("view",e)}zoomIn(){if(!this.canZoomIn)return;const e=this.view;e.type==="2d"?e.mapViewNavigation.zoomIn():dh(e.goTo({zoomFactor:2}))}zoomOut(){if(!this.canZoomOut)return;const e=this.view;e.type==="2d"?e.mapViewNavigation.zoomOut():dh(e.goTo({zoomFactor:.5}))}};g([w()],kf.prototype,"_zoomConditions",void 0),g([w()],kf.prototype,"canZoomIn",null),g([w()],kf.prototype,"canZoomOut",null),g([w({readOnly:!0})],kf.prototype,"state",null),g([w()],kf.prototype,"view",null),kf=g([te("esri.widgets.Zoom.ZoomViewModel")],kf);const Mee=kf,s3={base:"esri-zoom esri-widget",horizontalLayout:"esri-zoom--horizontal",zoomInIcon:"esri-icon-plus",zoomOutIcon:"esri-icon-minus",widgetIcon:"esri-icon-zoom-in-magnifying-glass"};let hp=class extends ki{constructor(e,t){super(e,t),this.iconClass=s3.widgetIcon,this.messages=null,this.viewModel=new Mee}initialize(){this._zoomInButton=new See({action:this.zoomIn.bind(this),iconClass:s3.zoomInIcon}),this._zoomOutButton=new See({action:this.zoomOut.bind(this),iconClass:s3.zoomOutIcon})}destroy(){this._zoomInButton=li(this._zoomInButton),this._zoomOutButton=li(this._zoomOutButton)}get label(){var e,t;return(t=(e=this.messages)==null?void 0:e.widgetLabel)!=null?t:""}set label(e){this._overrideIfSome("label",e)}set layout(e){e!=="horizontal"&&(e="vertical"),this._set("layout",e)}set view(e){this.viewModel.view=e}get view(){return this.viewModel.view}render(){const e=this.viewModel,t={[s3.horizontalLayout]:this.layout==="horizontal"},{canZoomIn:i,canZoomOut:r}=e;this._zoomInButton.enabled=i,this._zoomOutButton.enabled=r;const{zoomIn:n,zoomOut:o}=this.messages;return this._zoomInButton.title=n,this._zoomOutButton.title=o,j("div",{class:this.classes(s3.base,t)},this._zoomInButton.render(),this._zoomOutButton.render())}zoomIn(){return this.viewModel.zoomIn()}zoomOut(){return this.viewModel.zoomOut()}};g([w()],hp.prototype,"iconClass",void 0),g([w()],hp.prototype,"label",null),g([w({value:"vertical"})],hp.prototype,"layout",null),g([w(),ci("esri/widgets/Zoom/t9n/Zoom")],hp.prototype,"messages",void 0),g([w()],hp.prototype,"view",null),g([w({type:Mee})],hp.prototype,"viewModel",void 0),hp=g([te("esri.widgets.Zoom")],hp);const H8e=hp;function W8e(e){return e&&e.view!==void 0}let SI=class extends N8e{constructor(e){super(e),this._defaultPositionLookup={attribution:"manual",compass:"top-left","navigation-toggle":"top-left",zoom:"top-left"},this.components=[]}initialize(){this._handles.add([we(()=>this.components,this._componentsWatcher.bind(this),St),we(()=>this.view,this._updateViewAwareWidgets.bind(this),St)])}_add(e,t,i,r){if(typeof e=="string"&&this._defaultPositionLookup[e]){if(this._find(e))return;e=this._createComponent(e)}super._add(e,t,i,r)}_removeComponents(e){e.forEach(t=>{const i=this._find(t);i&&(this.remove(i),i.destroy())})}_updateViewAwareWidgets(e){this.components.forEach(t=>{const i=this._find(t),r=i&&i.widget;W8e(r)&&(r.view=e)})}_componentsWatcher(e,t){this._removeComponents(t),this._addComponents(e),this._adjustPadding(e)}_adjustPadding(e){if(!e.includes("attribution")&&!this._isOverridden("padding")){const{top:t}=this.padding;this.padding=t}}_addComponents(e){this.constructed&&e.forEach(t=>this.add(this._createComponent(t),this._defaultPositionLookup[t]))}_createComponent(e){const t=this._createWidget(e);if(t)return new _I({id:e,node:t})}_createWidget(e){return e==="attribution"?this._createAttribution():e==="compass"?this._createCompass():e==="navigation-toggle"?this._createNavigationToggle():e==="zoom"?this._createZoom():void 0}_createAttribution(){return new V8e({view:this.view})}_createCompass(){return new G8e({view:this.view})}_createNavigationToggle(){return new B8e({view:this.view})}_createZoom(){return new H8e({view:this.view})}};g([w()],SI.prototype,"components",void 0),SI=g([te("esri.views.ui.DefaultUI")],SI);const J8e=SI;let MI=class extends J8e{constructor(e){super(e),this.components=["attribution","zoom"]}};g([w()],MI.prototype,"components",void 0),MI=g([te("esri.views.ui.2d.DefaultUI2D")],MI);const Iee=MI;var PL;let II=PL=class extends ke{constructor(e){super(e),this.color=new ut([0,0,0,1])}clone(){return new PL(_e({color:this.color}))}};g([w({type:ut,json:{write:!0}})],II.prototype,"color",void 0),II=PL=g([te("esri.webmap.background.ColorBackground")],II);const Z8e=II;let $ee,Eee,Tee,Cee,kee,Aee;async function K8e(){const[,{GraphicsView2D:e,GraphicContainer:t,LabelManager:i,MapViewNavigation:r,MagnifierView2D:n,Stage:o}]=await Promise.all([import("./webglDeps.9ae9abe1.js"),import("./mapViewDeps.8acf05a2.js")]);Eee=e,Tee=t,Cee=i,kee=r,Aee=n,$ee=o}const Pee=160;function Y8e(e){return e&&e.declaredClass==="esri.Viewpoint"}let Zt=class extends j3e(ake(lke(Ake))){constructor(e){super(e),this._magnifierView=null,this._stage=null,this._resolveWhenReady=[],this.rootLayerViews=new Dg({getCollections:()=>{var t,i;return[(t=this.basemapView)==null?void 0:t.baseLayerViews,this.layerViews,(i=this.basemapView)==null?void 0:i.referenceLayerViews]},getChildrenFunction:()=>null}),this.featuresTilingScheme=null,this.fullOpacity=1,this.graphicsView=null,this.labelManager=null,this.mapViewNavigation=null,this.renderingOptions={samplingMode:"dynamic",edgeLabelsVisible:!0,labelsAnimationTime:125,labelCollisionsEnabled:!0},this.rendering=!1,this.supersampleScreenshotsEnabled=!1,this.supportsGround=!1,this._stationaryTimer=null,this.frameTask=new $7e(this),this._pePromise=null,this.floors=new Xe,this.highlightOptions=new oee,this.inputManager=new QAe({view:this}),this.map=null,this.resizeAlign="center",this.spatialReferenceLocked=!1,this.timeline=new aee,this.type="2d",this.ui=new Iee,this._pixelFormat={flipY:!0,premultipliedAlpha:!0},this.constraints=new PQ,this.padding={top:0,right:0,bottom:0,left:0},this.handles.add([we(()=>this.viewpoint,()=>{this._lastStationaryEventTimestamp=performance.now(),this._flipStationary(Pee)},mu),this.on("resize",t=>this._resizeHandler(t)),we(()=>{var t;return(t=this.animationManager)==null?void 0:t.animation},t=>{this.animation=t})]),t2e()}destroy(){this._set("preconditionsReady",!1),this._gotoTask=this.frameTask=null,this.rootLayerViews.destroy(),this.inputManager.destroy(),this._set("inputManager",null)}get graphicsTileStore(){return new s8e(this.featuresTilingScheme)}get initialExtentRequired(){var c;const{scale:e,constraints:t,center:i,viewpoint:r,extent:n}=this;let o=this.zoom;return!(this.map&&"initialViewProperties"in this.map&&((c=this.map.initialViewProperties)==null?void 0:c.viewpoint))&&!n&&((t==null?void 0:t.effectiveLODs)||(o=-1),(!i||e===0&&o===-1)&&(!r||!H(r.targetGeometry)||r.targetGeometry.type!=="extent"&&!r.scale))}get resourceManager(){return this._stage.resourceManager}get textureManager(){return this._stage.painter.textureManager}get _defaultsFromMapSettings(){return{required:{tileInfo:!0,heightModelInfo:!1,extent:!1},requiresExtentInSpatialReference:this.spatialReferenceLocked}}get _projectionEngineLoaded(){return!!vu()||(this._pePromise||(this._pePromise=bu().finally(()=>{this._pePromise=null})),!1)}get typeSpecificPreconditionsReady(){const e=this._getDefaultViewpoint();if(!e)return!1;const t=this.spatialReference,i=Ht(e.targetGeometry);return!!pc(i.spatialReference,t)||this._projectionEngineLoaded}set animation(e){const t=this._get("animation");if(e===t)return;if(t&&t.stop(),!e||e.isFulfilled())return void this._set("animation",null);this._set("animation",e),this.frameTask.animationInProgress=!0;const i=()=>{var r;e===this._get("animation")&&(this._set("animation",null),(r=this.frameTask)==null||r.requestFrame()),this.frameTask&&(this.frameTask.animationInProgress=!1)};e.when(i,i)}get background(){return X8e(this.map)?this.map.initialViewProperties.background:null}set background(e){this._override("background",e)}get center(){if(!this.ready)return this._get("center");const{center:e,spatialReference:t}=this.state.paddedViewState;return new pt({x:e[0],y:e[1],spatialReference:t})}set center(e){if(e==null)return;if(!this.ready)return this._set("center",e),void this.notifyChange("initialExtentRequired");let t;try{t=this._project(e,this.spatialReference)}catch(r){return void $e.getLogger(this.declaredClass).error(new ue("mapview:invalid-center","could not project the value in the view's spatial reference",{input:e,error:r}))}const i=this.viewpoint;sL(i,i,t),this.viewpoint=i}set constraints(e){const t=this._get("constraints");t&&(this.handles.remove("map-view-constraints"),t.destroy()),this._set("constraints",e),e&&(e.view=this,this.ready&&(this.state.viewpoint=e.fit(this.state.paddedViewState.viewpoint)),this.handles.add(we(()=>e.version,()=>{this.ready&&this.state&&(this.state.viewpoint=e.fit(this.state.paddedViewState.viewpoint))},mu),"map-view-constraints"))}get extent(){return this.ready?this.state.paddedViewState.extent.clone():this._get("extent")}set extent(e){if(e==null)return;if(!e.width||!e.height)return void $e.getLogger(this.declaredClass).error(new ue("mapview:invalid-extent","invalid extent size"));if(!this.ready)return this._set("extent",e),this._set("center",null),this._set("viewpoint",null),this._set("scale",0),this._set("zoom",-1),void this.notifyChange("initialExtentRequired");let t;try{t=this._project(e,this.spatialReference)}catch(r){return void $e.getLogger(this.declaredClass).error(new ue("mapview:invalid-extent","could not project the value in the view's spatial reference",{error:r}))}const i=this.viewpoint;u7e(i,i,t,this.size,{constraints:this.constraints}),this.viewpoint=i}get padding(){return this.ready?this.state.padding:this._get("padding")}set padding(e){this.ready?(this.state.padding=e,this._set("padding",this.state.padding)):this._set("padding",e)}get resolution(){return this.state?this.state.resolution:0}get rotation(){return this.ready?this.state.rotation:this._get("rotation")}set rotation(e){if(isNaN(e))return;if(!this.ready)return void this._set("rotation",e);const t=this.viewpoint;x7e(t,t,e),this.viewpoint=t}get scale(){return this.ready?this.state.scale:this._get("scale")}set scale(e){if(!e||isNaN(e))return;if(!this.ready){this._set("scale",e),this._set("zoom",-1);const i=this._get("extent");return i&&(this._set("extent",null),this._set("center",i.center)),void this.notifyChange("initialExtentRequired")}const t=this.viewpoint;MQ(t,t,e),this.viewpoint=t}get stationary(){return!(this.animation||this.navigating||this.resizing||this._stationaryTimer)}get updating(){var t,i,r;const e=!this.destroyed&&(!this.layerViewManager||!this.labelManager||!this.graphicsView||this.layerViewManager.updating===!0||this.labelManager.updating===!0||this.graphicsView.updating===!0||this.allLayerViews.some(n=>!n.destroyed&&!("layerViews"in n)&&n.updating===!0));if(Te("esri-2d-log-updating")){const n=this.allLayerViews.reduce((o,c)=>Ce(K({},o),{[c.layer.id]:!c.destroyed&&!("layerViews"in c)&&c.updating}),{});console.log(`Updating MapView: ${e}
-> Null LayerViewManager: ${!this.layerViewManager}
-> Null LabelManager: ${!this.labelManager}
-> Null GraphicsView: ${!this.graphicsView}
-> layerViewManager.updating: ${(t=this.layerViewManager)==null?void 0:t.updating}
-> labelManager.updating: ${(i=this.labelManager)==null?void 0:i.updating}
-> graphicsView.updating: ${(r=this.graphicsView)==null?void 0:r.updating}
-> allLayerViews: ${JSON.stringify(n)}
`)}return e}get viewpoint(){if(!this.ready)return this._get("viewpoint");const e=this.state.paddedViewState;return e&&e.viewpoint.clone()}set viewpoint(e){if(e==null)return;if(!this.ready)return this._set("viewpoint",e),this._set("extent",null),this._set("center",null),this._set("zoom",-1),this._set("scale",0),void this.notifyChange("initialExtentRequired");let t,i;try{t=this._project(e,this.spatialReference),!e.scale||isNaN(e.scale)?i=new ue("mapview:invalid-viewpoint",`invalid scale value of ${e.scale}`):ce(e.targetGeometry)&&(i=new ue("mapview:invalid-viewpoint","geometry not defined"))}catch(n){i=new ue("mapview:invalid-viewpoint","could not project the value in the view's spatial reference",{error:n})}if(i)return void $e.getLogger(this.declaredClass).error(i);this._scaleBeforeChangingSpatialReference=null;const r=new ra({targetGeometry:new pt,scale:0,rotation:0});Cc(r,t),this.constraints.constrain(r,this.state.paddedViewState.viewpoint),this.state.viewpoint=r,this.frameTask.requestFrame(),this._set("viewpoint",r)}get zoom(){return this.ready?this.constraints.scaleToZoom(this.scale):this._get("zoom")}set zoom(e){if(e==null)return;if(!this.ready){this._set("zoom",e),this._set("scale",0);const i=this._get("extent");return i&&(this._set("extent",null),this._set("center",i.center)),void this.notifyChange("initialExtentRequired")}if(!this.constraints.effectiveLODs)return void this._set("zoom",-1);const t=this.viewpoint;MQ(t,t,this.constraints.zoomToScale(e)),this.viewpoint=t,this._set("zoom",this.constraints.scaleToZoom(this.scale))}get navigating(){return!(!this.mapViewNavigation||!this.mapViewNavigation.interacting)}goTo(e,t){if(e)return this.animation&&(this.animation=null),this._createAnimation(),Ch(()=>this.ready,t).then(()=>{const i=K({animate:!0},t),r=a7e(e,this);return this.animation.update(r),this._gotoTask={},i.animate?this._gotoAnimated(r,i):this._gotoImmediate(r,i)});$e.getLogger(this.declaredClass).error("#goTo()","target cannot be null or undefined")}async hitTest(e,t){const i=WX(e)?HX(this,e):e;if(!this.ready||isNaN(i.x)||isNaN(i.y))return{screenPoint:i,results:[]};let r=new Set,n=!1,o=null,c=null;(t==null?void 0:t.include)?Oee(t.include,Lee(this,x=>r.add(x),x=>{o||(o=new Set),o.add(x)},x=>r.add(x),()=>n=!0)):(n=!0,r=new Set(this.allLayerViews)),(t==null?void 0:t.exclude)&&Oee(t.exclude,Lee(this,x=>r.delete(x),x=>{c||(c=new Set),c.add(x)}));const h=this.allLayerViews.filter(x=>!x.suspended&&r.has(x)).reverse(),m=this.toMap(i);let b=[...n?this.graphicsView.hitTest(m).map(x=>({type:"graphic",graphic:x,layer:null,mapPoint:m})):[],...await Promise.all(h.map(x=>x.hitTest(m,i)).toArray())].filter(H).flat().filter(H);return o&&(b=b.filter(x=>!("graphic"in x)||!x.graphic||o.has(LL(x.graphic)))),c&&(b=b.filter(x=>!("graphic"in x)||!x.graphic||c.has(LL(x.graphic)))),{screenPoint:i,results:b}}async takeScreenshot(e){const t=this._createScreenshotPlan(e),i=await this._stage.takeScreenshot(t);return u8e(i,{format:t.format,quality:t.quality,rotation:0,disableDecorations:!1},this._pixelFormat)}async _takeScreenshot(e){const t=this._createScreenshotPlan(e),i=await this._stage.takeScreenshot(t);return h8e(i,this._pixelFormat)}_createScreenshotPlan(e){e=e||{};const t=this.supersampleScreenshotsEnabled?Math.min(4,y8e(this.size,Math.min(4096,this._stage.context.parameters.maxTextureSize))):1;let i;e.layers?(i=[],e.layers.forEach(o=>{const c=this.allLayerViews.find(h=>h.layer.id===o.id);c&&"container"in c&&c.container&&i.push(c.container)})):i=this._stage.children;const{format:r,quality:n}=f8e(e.format,e.quality);return l8e(e,t,this.size,this.padding,r,n,i,e.rotation)}get test(){return{takeScreenshot:e=>this._takeScreenshot(e)}}toMap(e){if(!this.ready)return null;const t=WX(e)?HX(this,e):e,i=[0,0],[r,n]=this.state.toMap(i,[t.x,t.y]),o=this.spatialReference;return new pt({x:r,y:n,spatialReference:o})}toScreen(e){if(!this.ready)return null;const t=this._project(e,this.spatialReference),i=[t.x,t.y];return this.state.toScreen(i,i),yn(i[0],i[1])}on(e,t,i,r){return this.inputManager&&this.viewEvents.on(e,t,i,r)||super.on(e,t)}hasEventListener(e){return super.hasEventListener(e)||this.viewEvents.hasHandler(e)}whenLayerView(e){return super.whenLayerView(e)}graphicChanged(e){this.graphicsView&&this.graphicsView.graphicUpdateHandler(e)}whenReady(){return new Promise(e=>{this.ready?e(this):this._resolveWhenReady.push(e)})}forceDOMReadyCycle(){this.forceReadyCycle()}getDefaultSpatialReference(){var e,t,i;return this.map&&"initialViewProperties"in this.map&&((t=(e=this.map)==null?void 0:e.initialViewProperties)==null?void 0:t.spatialReference)||((i=this.defaultsFromMap)==null?void 0:i.spatialReference)||null}hasLayerViewModule(e){return CQ.hasLayerViewModule(e)}importLayerView(e){return CQ.importLayerView(e)}pixelSizeAt(){return this.ready?this.state.resolution:($e.getLogger(this.declaredClass).error("#pixelSizeAt()","Map view cannot be used before it is ready"),null)}popupHitTest(e){return this.hitTest(e).then(t=>Ce(K({},t),{mapPoint:this.toMap(e)}))}requestUpdate(){this.ready&&this.frameTask.requestUpdate()}validate(){let e=P8e(this.type);return Te("safari")&&Te("safari")<9&&(e=new ue("mapview:browser-not-supported","This browser is not supported by MapView (Safari < 9)",{type:"safari",requiredVersion:9,detectedVersion:Te("safari")})),H(e)?($e.getLogger(this.declaredClass).warn("#validate()",e.message),Promise.reject(e)):K8e()}_createAnimation(){return this.animation&&!this.animation.done||(this.animation=new ZP),this.animation}_cancellableGoTo(e,t,i){const r=()=>e===this._gotoTask,n=i.then(()=>{r()&&(this.animation=null)}).catch(c=>{throw r()&&(this.animation=null,t.done||(t.stop(),this.frameTask.animationInProgress=!1)),c}),o=new Promise(c=>c(n));return t.when().catch(()=>{r()&&o.cancel&&o.cancel()}),o}_gotoImmediate(e,t){const i=this._gotoTask,r=this.animation,n=e.then(o=>{if(ur(t),i!==this._gotoTask)throw new ue("view:goto-interrupted","Goto was interrupted");this.viewpoint=r.target=o,r.finish()});return this._cancellableGoTo(i,r,n)}_flipStationary(e){return this._stationaryTimer!==null||(this._stationaryTimer=setTimeout(()=>{this._stationaryTimer=null;const t=performance.now()-this._lastStationaryEventTimestamp;t<Pee&&(this._stationaryTimer=this._flipStationary(t))},e)),this._stationaryTimer}_getDefaultViewpoint(){var N,B,z,q;const{constraints:e,initialExtent:t,map:i,padding:r,size:n}=this;if(!e)return null;const o=i&&"initialViewProperties"in i&&i.initialViewProperties,c={zoom:this._get("zoom"),scale:this._get("scale"),center:this._get("center"),extent:this._get("extent"),rotation:this._get("rotation"),viewpoint:this._get("viewpoint"),spatialReference:this._userSpatialReference};e.effectiveLODs?c.zoom!==-1&&(c.scale=e.zoomToScale(c.zoom)):c.zoom=-1;let h=null,m=null,b=0;const x=c.viewpoint&&c.viewpoint.rotation,I=c.viewpoint&&c.viewpoint.targetGeometry;H(I)&&(I.type==="extent"?h=I:I.type==="point"&&(m=I,b=c.viewpoint.scale));const E=c.extent||h||((B=Ht((N=o==null?void 0:o.viewpoint)==null?void 0:N.targetGeometry))==null?void 0:B.extent)||t,k=c.center||m||(E==null?void 0:E.center),P=c.scale||b||((z=o==null?void 0:o.viewpoint)==null?void 0:z.scale)||E&&Z2(E,[n[0]-r.left-r.right,n[1]-r.top-r.bottom]),F=c.rotation||x||((q=o==null?void 0:o.viewpoint)==null?void 0:q.rotation)||0;return k&&P?new ra({targetGeometry:k,scale:P,rotation:F}):null}_gotoAnimated(e,t){const i=this._gotoTask,r=this.animation,n=e.then(o=>{if(ur(t),i!==this._gotoTask)throw new ue("view:goto-interrupted","Goto was interrupted");return r.update(o),this.animationManager.animate(r,this.viewpoint,t),r.when().then(()=>{},()=>{})});return this._cancellableGoTo(i,r,n)}_project(e,t){var n;const i=e&&e.targetGeometry||e;if(!t)return e;if(!i)return null;if(t.imageCoordinateSystem||((n=i.spatialReference)==null?void 0:n.imageCoordinateSystem)||hr(t,i.spatialReference))return e;const r=Da(i,t);if(!r)throw new ue("mapview:projection-not-possible","projecting input geometry to target spatial reference returned a null value",{geometry:i,spatialReference:t});return Y8e(e)?(e.targetGeometry=r,e):r}_resizeHandler(e){if(!this.ready)return;const t=this.state;let i=this.state.paddedViewState.viewpoint;const r=this.state.paddedViewState.size.concat();t.size=[e.width,e.height],_7e(i,i,r,this.state.paddedViewState.size,this.resizeAlign),i=this.constraints.constrain(i,null),this.state.viewpoint=i}_startup(){var h,m;this.timeline.begin("MapView Startup");const e=this._getDefaultViewpoint(),t=e.targetGeometry;try{this._project(e,this.spatialReference)}catch(b){$e.getLogger(this.declaredClass).warn(new Io("mapview:startup-projection-error","projection of initial viewpoint to the view's spatial reference, defaulting to the initial viewpoint.",{center:t.toJSON(),spatialReference:this.spatialReference,error:b})),e.targetGeometry=((h=this.defaultsFromMap.extent)==null?void 0:h.center)||new pt({x:0,y:0,spatialReference:this.spatialReference})}(m=this.constraints)==null||m.fit(e),this._set("state",new dAe({padding:this._get("padding"),size:this.size,viewpoint:e})),this.graphics.owner=this;const i=new $ee(this.surface,{canvas:this.renderCanvas,supersampleScreenshots:this.supersampleScreenshotsEnabled,contextOptions:{disabledExtensions:this.deactivatedWebGLExtensions,debugWebGLExtensions:this.debugWebGLExtensions},renderingOptions:this.renderingOptions,timeline:this.timeline});this._stage=i,this._magnifierView=new Aee,this._magnifierView.magnifier=this.magnifier;const r=new Cee({view:this});this._set("labelManager",r);const n=new I7e({view:this});this._set("animationManager",n);const o=new kee({view:this,animationManager:n});this._set("mapViewNavigation",o),this._setupSpatialReferenceDependentProperties(),this.handles.add([this.rootLayerViews.on("change",()=>this._updateStageChildren()),i.on("post-render",()=>this._set("rendering",i.renderRequested)),i.on("will-render",()=>this._set("rendering",i.renderRequested)),i.on("webgl-error",b=>this.fatalError=b.error),we(()=>this.stationary,b=>i.stationary=b,Gs),we(()=>this.background,b=>{i.background=b,this._magnifierView.background=b},Gs),we(()=>this.magnifier,b=>this._magnifierView.magnifier=b,Gs),we(()=>this.renderingOptions,b=>i.renderingOptions=b,Gs),we(()=>this.highlightOptions,b=>i.highlightOptions=b,Gs),we(()=>this.state.id,()=>i.state=this.state,Gs)],"map-view"),this._updateStageChildren();const c=this._resolveWhenReady;this._resolveWhenReady=[],c.forEach(b=>b(this)),this.timeline.end("MapView Startup"),this.frameTask&&this.frameTask.start(),this._set("ready",!0)}_teardown(){this._destroySpatialReferenceDependentProperties(),this.handles.remove("map-view"),this.mapViewNavigation.destroy(),this._set("mapViewNavigation",null),this.animationManager.destroy(),this._set("animationManager",null),this.layerViewManager.clear(),this.labelManager.destroy(),this._magnifierView.destroy(),this._stage.destroy(),this._stage=null,this._set("graphicsView",null),this._magnifierView=null,this._set("labelManager",null),this._set("mapViewNavigation",null),this.graphics.owner=null,this.frameTask&&this.frameTask.stop(),this._stationaryTimer&&(clearTimeout(this._stationaryTimer),this._stationaryTimer=null),this._set("ready",!1);const{center:[e,t],spatialReference:i,rotation:r,scale:n}=this.state.paddedViewState,o=new pt({x:e,y:t,spatialReference:i});this._set("viewpoint",null),this._set("extent",null),this._set("center",o),this._set("zoom",-1),this._set("rotation",r),this._set("scale",n),this._set("spatialReference",i),this._set("state",null),this.animation=null}_updateStageChildren(){this._stage.removeAllChildren(),this.rootLayerViews.forEach(t=>{this._stage.addChild(t.container)});const e=this.graphicsView;this._stage.addChild(e.container),this._stage.addChild(this._magnifierView)}_setupSpatialReferenceDependentProperties(){const e=new vAe(xu.create({spatialReference:this.spatialReference,size:512,numLODs:36}));this._set("featuresTilingScheme",e);const t=new Eee({view:this,graphics:this.graphics,requestUpdateCallback:()=>this.requestUpdate(),container:new Tee(e)});this.frameTask.graphicsView=t,this._set("graphicsView",t)}_destroySpatialReferenceDependentProperties(){const e=this.graphicsView;this._set("graphicsView",null),this.frameTask.graphicsView=null,e.destroy(),this._set("featuresTilingScheme",null)}_spatialReferenceChanged(e){if(!this.ready)return;this.frameTask.stop();for(const h of this.allLayerViews)h.processDetach();this._destroySpatialReferenceDependentProperties();const t=this.state.paddedViewState.clone();if(ce(this._scaleBeforeChangingSpatialReference))this._scaleBeforeChangingSpatialReference=t.scale;else{const h=t.viewpoint.clone();h.scale=this._scaleBeforeChangingSpatialReference,t.viewpoint=h}const i=t.clone(),[r,n]=t.center;let o=null;try{o=this._project(new pt({x:r,y:n,spatialReference:t.spatialReference}),e)}catch(h){vu()||$e.getLogger(this.declaredClass).warn(new Io("mapview:spatial-reference-change","could not project the view's center to the new spatial reference",{center:o.toJSON(),spatialReference:e,error:h}))}o||(o=new pt({x:0,y:0,spatialReference:e}));const c=sL(new ra({targetGeometry:new pt,scale:0,rotation:0}),t.viewpoint,o);i.viewpoint=c;try{const h=20,m=[t.size[0]/2,t.size[1]/2],b=[m[0]+h,m[1]],x=t.toMap([0,0],b),{x:I,y:E}=this._project(new pt({x:x[0],y:x[1],spatialReference:t.spatialReference}),e);x[0]=I,x[1]=E,i.toScreen(x,x);const k=b7e(m,x,b),P=Math.hypot(x[0]-m[0],x[1]-m[1])/h;!Number.isFinite(P)||Math.abs(P)>4?(c.rotation=0,c.targetGeometry=new pt({x:0,y:0,spatialReference:e})):(c.scale*=P,c.scale>Te("mapview-srswitch-adjust-rotation-scale-threshold")?c.rotation=0:c.rotation+=Number.isFinite(k)?k:0)}catch{}this._get("constraints").constrain(c,null),this._get("state").viewpoint=c,this._stage.state=this.state,this._setupSpatialReferenceDependentProperties();for(const h of this.allLayerViews)h.processAttach();this.frameTask.requestFrame(),this.frameTask.start(),this._updateStageChildren()}};Zt.type="2d",g([w({readOnly:!0})],Zt.prototype,"animationManager",void 0),g([w({constructOnly:!0})],Zt.prototype,"deactivatedWebGLExtensions",void 0),g([w({constructOnly:!0})],Zt.prototype,"debugWebGLExtensions",void 0),g([w({readOnly:!0})],Zt.prototype,"featuresTilingScheme",void 0),g([w({readOnly:!0})],Zt.prototype,"fullOpacity",void 0),g([w({readOnly:!0})],Zt.prototype,"graphicsTileStore",null),g([w()],Zt.prototype,"graphicsView",void 0),g([w({readOnly:!0})],Zt.prototype,"state",void 0),g([w()],Zt.prototype,"initialExtentRequired",null),g([w()],Zt.prototype,"labelManager",void 0),g([w({readOnly:!0})],Zt.prototype,"resourceManager",null),g([w({readOnly:!0})],Zt.prototype,"textureManager",null),g([w({readOnly:!0})],Zt.prototype,"mapViewNavigation",void 0),g([w({constructOnly:!0})],Zt.prototype,"renderCanvas",void 0),g([w()],Zt.prototype,"renderingOptions",void 0),g([w({readOnly:!0})],Zt.prototype,"rendering",void 0),g([w({constructOnly:!0})],Zt.prototype,"supersampleScreenshotsEnabled",void 0),g([w({readOnly:!0})],Zt.prototype,"supportsGround",void 0),g([w()],Zt.prototype,"_stationaryTimer",void 0),g([w()],Zt.prototype,"_defaultsFromMapSettings",null),g([w()],Zt.prototype,"_pePromise",void 0),g([w({readOnly:!0})],Zt.prototype,"typeSpecificPreconditionsReady",null),g([w()],Zt.prototype,"animation",null),g([w({type:Z8e})],Zt.prototype,"background",null),g([w({value:null,type:pt,dependsOn:["state.id","ready"]})],Zt.prototype,"center",null),g([w({type:PQ})],Zt.prototype,"constraints",null),g([w({value:null,type:gi,dependsOn:["state.id","ready"]})],Zt.prototype,"extent",null),g([w()],Zt.prototype,"floors",void 0),g([w({type:oee})],Zt.prototype,"highlightOptions",void 0),g([w({readOnly:!0})],Zt.prototype,"inputManager",void 0),g([w()],Zt.prototype,"map",void 0),g([w({value:{top:0,right:0,bottom:0,left:0},cast:e=>K({top:0,right:0,bottom:0,left:0},e)})],Zt.prototype,"padding",null),g([w()],Zt.prototype,"resizeAlign",void 0),g([w({readOnly:!0,dependsOn:["state.id"]})],Zt.prototype,"resolution",null),g([w({value:0,type:Number,dependsOn:["state.id","ready"]})],Zt.prototype,"rotation",null),g([w({value:0,type:Number,dependsOn:["state.id","ready"]})],Zt.prototype,"scale",null),g([w({constructOnly:!0})],Zt.prototype,"spatialReferenceLocked",void 0),g([w()],Zt.prototype,"stationary",null),g([w({type:aee,readOnly:!0})],Zt.prototype,"timeline",void 0),g([w({readOnly:!0})],Zt.prototype,"type",void 0),g([w({readOnly:!0})],Zt.prototype,"updating",null),g([w({value:null,type:ra,dependsOn:["state.id","ready"]})],Zt.prototype,"viewpoint",null),g([w({value:-1,dependsOn:["state.id","ready"]})],Zt.prototype,"zoom",null),g([w({readOnly:!0})],Zt.prototype,"navigating",null),g([w({type:Iee})],Zt.prototype,"ui",void 0),Zt=g([te("esri.views.MapView")],Zt);const kKe=Zt;function LL(e){var i,r,n,o;const t=e.getObjectId();return t?`${(o=(n=(i=e.layer)==null?void 0:i.uid)!=null?n:(r=e.sourceLayer)==null?void 0:r.uid)!=null?o:"MapView"}/${t}`:`"MapView/${e.uid}`}function Lee(e,t,i,r,n){return o=>{if(o instanceof Gr){if(o.layer===e)n==null||n();else{const c=e.allLayerViews.find(h=>h.layer===o.layer);c&&(r==null||r(c))}i(LL(o))}else{const c=e.allLayerViews.find(h=>h.layer===o);c&&t(c)}}}function Oee(e,t){if(e)if(gS(e))for(const i of e)if(gS(i))for(const r of i)t(r);else t(i);else t(e)}function X8e(e){return(e==null?void 0:e.declaredClass)==="esri.WebMap"}var OL;let ln=OL=class extends ke{constructor(e){super(e),this.dpi=96,this.floors=null,this.gdbVersion=null,this.geometry=null,this.geometryPrecision=null,this.height=400,this.layerIds=null,this.layerOption="top",this.mapExtent=null,this.maxAllowableOffset=null,this.returnFieldName=!0,this.returnGeometry=!1,this.returnM=!1,this.returnUnformattedValues=!0,this.returnZ=!1,this.spatialReference=null,this.sublayers=null,this.timeExtent=null,this.tolerance=null,this.width=400}static from(e){return Xm(OL,e)}};g([w({type:Number,json:{write:!0}})],ln.prototype,"dpi",void 0),g([w()],ln.prototype,"floors",void 0),g([w({type:String,json:{write:!0}})],ln.prototype,"gdbVersion",void 0),g([w({types:wh,json:{read:xs,write:!0}})],ln.prototype,"geometry",void 0),g([w({type:Number,json:{write:!0}})],ln.prototype,"geometryPrecision",void 0),g([w({type:Number,json:{write:!0}})],ln.prototype,"height",void 0),g([w({type:[Number],json:{write:!0}})],ln.prototype,"layerIds",void 0),g([w({type:["top","visible","all","popup"],json:{write:!0}})],ln.prototype,"layerOption",void 0),g([w({type:gi,json:{write:!0}})],ln.prototype,"mapExtent",void 0),g([w({type:Number,json:{write:!0}})],ln.prototype,"maxAllowableOffset",void 0),g([w({type:Boolean,json:{write:!0}})],ln.prototype,"returnFieldName",void 0),g([w({type:Boolean,json:{write:!0}})],ln.prototype,"returnGeometry",void 0),g([w({type:Boolean,json:{write:!0}})],ln.prototype,"returnM",void 0),g([w({type:Boolean,json:{write:!0}})],ln.prototype,"returnUnformattedValues",void 0),g([w({type:Boolean,json:{write:!0}})],ln.prototype,"returnZ",void 0),g([w({type:Mt,json:{write:!0}})],ln.prototype,"spatialReference",void 0),g([w()],ln.prototype,"sublayers",void 0),g([w({type:qa,json:{write:!0}})],ln.prototype,"timeExtent",void 0),g([w({type:Number,json:{write:!0}})],ln.prototype,"tolerance",void 0),g([w({type:Number,json:{write:!0}})],ln.prototype,"width",void 0),ln=OL=g([te("esri.rest.support.IdentifyParameters")],ln);const Q8e=ln;let pp=class extends $M(DM(Y0)){constructor(e){super(e),this.elevationInfo=null,this.graphics=new Uy,this.screenSizePerspectiveEnabled=!0,this.type="graphics",this.internal=!1}destroy(){this.removeAll(),this.graphics.destroy()}add(e){return this.graphics.add(e),this}addMany(e){return this.graphics.addMany(e),this}removeAll(){return this.graphics.removeAll(),this}remove(e){this.graphics.remove(e)}removeMany(e){this.graphics.removeMany(e)}on(e,t){return super.on(e,t)}graphicChanged(e){this.emit("graphic-update",e)}};g([w({type:jK})],pp.prototype,"elevationInfo",void 0),g([w(zP(Uy,"graphics"))],pp.prototype,"graphics",void 0),g([w({type:["show","hide"]})],pp.prototype,"listMode",void 0),g([w()],pp.prototype,"screenSizePerspectiveEnabled",void 0),g([w({readOnly:!0})],pp.prototype,"type",void 0),g([w({constructOnly:!0})],pp.prototype,"internal",void 0),pp=g([te("esri.layers.GraphicsLayer")],pp);const RL=pp,yv=(e,t,i)=>[t,i],Tl=(e,t,i)=>[t,i,e[2]],mv=(e,t,i)=>[t,i,e[2],e[3]];function Ree(e){return e?{originPosition:e.originPosition==="upper-left"?"upperLeft":e.originPosition==="lower-left"?"lowerLeft":e.originPosition,scale:e.tolerance?[e.tolerance,e.tolerance]:[1,1],translate:H(e.extent)?[e.extent.xmin,e.extent.ymax]:[0,0]}:null}function o3({scale:e,translate:t},i){return Math.round((i-t[0])/e[0])}function a3({scale:e,translate:t},i){return Math.round((t[1]-i)/e[1])}function FL(e,t,i){const r=[];let n,o,c,h;for(let m=0;m<i.length;m++){const b=i[m];m>0?(c=o3(e,b[0]),h=a3(e,b[1]),c===n&&h===o||(r.push(t(b,c-n,h-o)),n=c,o=h)):(n=o3(e,b[0]),o=a3(e,b[1]),r.push(t(b,n,o)))}return r.length>0?r:null}function ePe(e,t,i,r){return FL(e,i?r?mv:Tl:r?Tl:yv,t)}function tPe(e,t,i,r){const n=[],o=i?r?mv:Tl:r?Tl:yv;for(let c=0;c<t.length;c++){const h=FL(e,o,t[c]);h&&h.length>=3&&n.push(h)}return n.length?n:null}function iPe(e,t,i,r){const n=[],o=i?r?mv:Tl:r?Tl:yv;for(let c=0;c<t.length;c++){const h=FL(e,o,t[c]);h&&h.length>=2&&n.push(h)}return n.length?n:null}function Fee({scale:e,translate:t},i){return i*e[0]+t[0]}function Nee({scale:e,translate:t},i){return t[1]-i*e[1]}function Dee(e,t,i){const r=new Array(i.length);if(!i.length)return r;const[n,o]=e.scale;let c=Fee(e,i[0][0]),h=Nee(e,i[0][1]);r[0]=t(i[0],c,h);for(let m=1;m<i.length;m++){const b=i[m];c+=b[0]*n,h-=b[1]*o,r[m]=t(b,c,h)}return r}function jee(e,t,i){const r=new Array(i.length);for(let n=0;n<i.length;n++)r[n]=Dee(e,t,i[n]);return r}function rPe(e,t,i,r){return Dee(e,i?r?mv:Tl:r?Tl:yv,t)}function nPe(e,t,i,r){return jee(e,i?r?mv:Tl:r?Tl:yv,t)}function sPe(e,t,i,r){return jee(e,i?r?mv:Tl:r?Tl:yv,t)}function oPe(e,t,i,r,n){return t.xmin=o3(e,i.xmin),t.ymin=a3(e,i.ymin),t.xmax=o3(e,i.xmax),t.ymax=a3(e,i.ymax),t!==i&&(r&&(t.zmin=i.zmin,t.zmax=i.zmax),n&&(t.mmin=i.mmin,t.mmax=i.mmax)),t}function aPe(e,t,i,r,n){var o;return t.points=(o=ePe(e,i.points,r,n))!=null?o:[],t}function lPe(e,t,i,r,n){return t.x=o3(e,i.x),t.y=a3(e,i.y),t!==i&&(r&&(t.z=i.z),n&&(t.m=i.m)),t}function cPe(e,t,i,r,n){const o=tPe(e,i.rings,r,n);return o?(t.rings=o,t):null}function uPe(e,t,i,r,n){const o=iPe(e,i.paths,r,n);return o?(t.paths=o,t):null}function AKe(e,t){return e&&t?VS(t)?lPe(e,{},t,!1,!1):_w(t)?uPe(e,{},t,!1,!1):vh(t)?cPe(e,{},t,!1,!1):jS(t)?aPe(e,{},t,!1,!1):ww(t)?oPe(e,{},t,!1,!1):null:null}function PKe(e,t,i,r,n){return H(i)&&(t.points=rPe(e,i.points,r,n)),t}function LKe(e,t,i,r,n){return ce(i)||(t.x=Fee(e,i.x),t.y=Nee(e,i.y),t!==i&&(r&&(t.z=i.z),n&&(t.m=i.m))),t}function OKe(e,t,i,r,n){return H(i)&&(t.rings=sPe(e,i.rings,r,n)),t}function RKe(e,t,i,r,n){return H(i)&&(t.paths=nPe(e,i.paths,r,n)),t}function NL(e,t){return e===t||H(e)&&H(t)&&hr(e.spatialReference,t.spatialReference)&&e.x===t.x&&e.y===t.y&&e.z===t.z&&e.m===t.m}class FKe{constructor(t,i,r){this.uid=t,this.geometry=i,this.attributes=r,this.visible=!0,this.objectId=null,this.centroid=null}}function NKe(e){return H(e.geometry)}class DKe{constructor(){this.exceededTransferLimit=!1,this.features=[],this.fields=[],this.hasM=!1,this.hasZ=!1,this.geometryType=null,this.objectIdFieldName=null,this.globalIdFieldName=null,this.geometryProperties=null,this.geohashFieldName=null,this.spatialReference=null,this.transform=null}}function $I(e,t,i,r){return{x:e,y:t,z:i,hasZ:i!=null,hasM:!1,spatialReference:r,type:"point"}}function jKe(e){if(ce(e))return 0;switch(e.type){case"point":return 1;case"polyline":{let t=0;for(const i of e.paths)t+=i.length;return t}case"polygon":{let t=0;for(const i of e.rings)t+=i.length;return t}case"multipoint":return e.points.length;case"extent":return 2;case"mesh":{const t=e.vertexAttributes&&e.vertexAttributes.position;return t?t.length/3:0}default:return}}function VKe(e,t){switch(Yve(t),e.type==="mesh"&&(e=e.extent),e.type){case"point":t[0]=t[3]=e.x,t[1]=t[4]=e.y,e.hasZ&&(t[2]=t[5]=e.z);break;case"polyline":for(let i=0;i<e.paths.length;i++)sC(t,e.paths[i],e.hasZ);break;case"polygon":for(let i=0;i<e.rings.length;i++)sC(t,e.rings[i],e.hasZ);break;case"multipoint":sC(t,e.points,e.hasZ);break;case"extent":t[0]=e.xmin,t[1]=e.ymin,t[3]=e.xmax,t[4]=e.ymax,e.zmin!=null&&(t[2]=e.zmin),e.zmax!=null&&(t[5]=e.zmax)}}function zKe(e,t){switch(Wve(t),e.type==="mesh"&&(e=e.extent),e.type){case"point":t[0]=t[2]=e.x,t[1]=t[3]=e.y;break;case"polyline":for(let i=0;i<e.paths.length;i++)tC(t,e.paths[i]);break;case"polygon":for(let i=0;i<e.rings.length;i++)tC(t,e.rings[i]);break;case"multipoint":tC(t,e.points);break;case"extent":t[0]=e.xmin,t[1]=e.ymin,t[2]=e.xmax,t[3]=e.ymax}}function GKe(e,t){return e.objectId!=null?e.objectId:e.attributes&&t?e.attributes[t]:null}v5();ro();var Vee,zee,Gee,Bee,Uee,qee,Hee,Wee,Jee,Zee,Kee,Yee,Xee,Qee,ete,tte,ite,rte,nte,ste,ote,ate,lte,cte,ute,hte,pte,dte,fte,yte,mte,gte,vte,bte,wte,DL,_te,xte,Ste,jL,Mte,Ite,$te,Ete,Tte,Cte,kte,Ate,Pte,Lte,Ote,Rte,Fte,Nte,Dte,jte,Vte,zte,Gte,Bte,Ute;(function(e){e[e.BUTT=0]="BUTT",e[e.ROUND=1]="ROUND",e[e.SQUARE=2]="SQUARE",e[e.UNKNOWN=4]="UNKNOWN"})(Vee||(Vee={})),function(e){e[e.BEVEL=0]="BEVEL",e[e.ROUND=1]="ROUND",e[e.MITER=2]="MITER",e[e.UNKNOWN=4]="UNKNOWN"}(zee||(zee={})),function(e){e[e.SCREEN=0]="SCREEN",e[e.MAP=1]="MAP"}(Gee||(Gee={})),function(e){e[e.Tint=0]="Tint",e[e.Ignore=1]="Ignore",e[e.Multiply=99]="Multiply"}(Bee||(Bee={})),function(e){e.Both="Both",e.JustBegin="JustBegin",e.JustEnd="JustEnd",e.None="None"}(Uee||(Uee={})),function(e){e[e.Mosaic=0]="Mosaic",e[e.Centered=1]="Centered"}(qee||(qee={})),function(e){e[e.Normal=0]="Normal",e[e.Superscript=1]="Superscript",e[e.Subscript=2]="Subscript"}(Hee||(Hee={})),function(e){e[e.MSSymbol=0]="MSSymbol",e[e.Unicode=1]="Unicode"}(Wee||(Wee={})),function(e){e[e.Unspecified=0]="Unspecified",e[e.TrueType=1]="TrueType",e[e.PSOpenType=2]="PSOpenType",e[e.TTOpenType=3]="TTOpenType",e[e.Type1=4]="Type1"}(Jee||(Jee={})),function(e){e[e.Display=0]="Display",e[e.Map=1]="Map"}(Zee||(Zee={})),function(e){e.None="None",e.Loop="Loop",e.Oscillate="Oscillate"}(Kee||(Kee={})),function(e){e[e.Z=0]="Z",e[e.X=1]="X",e[e.Y=2]="Y"}(Yee||(Yee={})),function(e){e[e.XYZ=0]="XYZ",e[e.ZXY=1]="ZXY",e[e.YXZ=2]="YXZ"}(Xee||(Xee={})),function(e){e[e.Rectangle=0]="Rectangle",e[e.RoundedRectangle=1]="RoundedRectangle",e[e.Oval=2]="Oval"}(Qee||(Qee={})),function(e){e[e.None=0]="None",e[e.Alpha=1]="Alpha",e[e.Screen=2]="Screen",e[e.Multiply=3]="Multiply",e[e.Add=4]="Add"}(ete||(ete={})),function(e){e[e.TTB=0]="TTB",e[e.RTL=1]="RTL",e[e.BTT=2]="BTT"}(tte||(tte={})),function(e){e[e.None=0]="None",e[e.SignPost=1]="SignPost",e[e.FaceNearPlane=2]="FaceNearPlane"}(ite||(ite={})),function(e){e[e.Float=0]="Float",e[e.String=1]="String",e[e.Boolean=2]="Boolean"}(rte||(rte={})),function(e){e[e.Intersect=0]="Intersect",e[e.Subtract=1]="Subtract"}(nte||(nte={})),function(e){e.OpenEnded="OpenEnded",e.Block="Block",e.Crossed="Crossed"}(ste||(ste={})),function(e){e.FullGeometry="FullGeometry",e.PerpendicularFromFirstSegment="PerpendicularFromFirstSegment",e.ReversedFirstSegment="ReversedFirstSegment",e.PerpendicularToSecondSegment="PerpendicularToSecondSegment",e.SecondSegmentWithTicks="SecondSegmentWithTicks",e.DoublePerpendicular="DoublePerpendicular",e.OppositeToFirstSegment="OppositeToFirstSegment",e.TriplePerpendicular="TriplePerpendicular",e.HalfCircleFirstSegment="HalfCircleFirstSegment",e.HalfCircleSecondSegment="HalfCircleSecondSegment",e.HalfCircleExtended="HalfCircleExtended",e.OpenCircle="OpenCircle",e.CoverageEdgesWithTicks="CoverageEdgesWithTicks",e.GapExtentWithDoubleTicks="GapExtentWithDoubleTicks",e.GapExtentMidline="GapExtentMidline",e.Chevron="Chevron",e.PerpendicularWithArc="PerpendicularWithArc",e.ClosedHalfCircle="ClosedHalfCircle",e.TripleParallelExtended="TripleParallelExtended",e.ParallelWithTicks="ParallelWithTicks",e.Parallel="Parallel",e.PerpendicularToFirstSegment="PerpendicularToFirstSegment",e.ParallelOffset="ParallelOffset",e.OffsetOpposite="OffsetOpposite",e.OffsetSame="OffsetSame",e.CircleWithArc="CircleWithArc",e.DoubleJog="DoubleJog",e.PerpendicularOffset="PerpendicularOffset",e.LineExcludingLastSegment="LineExcludingLastSegment",e.MultivertexArrow="MultivertexArrow",e.CrossedArrow="CrossedArrow",e.ChevronArrow="ChevronArrow",e.ChevronArrowOffset="ChevronArrowOffset",e.PartialFirstSegment="PartialFirstSegment",e.Arch="Arch",e.CurvedParallelTicks="CurvedParallelTicks",e.Arc90Degrees="Arc90Degrees"}(ote||(ote={})),function(e){e.Mitered="Mitered",e.Bevelled="Bevelled",e.Rounded="Rounded",e.Square="Square",e.TrueBuffer="TrueBuffer"}(ate||(ate={})),function(e){e.ClosePath="ClosePath",e.ConvexHull="ConvexHull",e.RectangularBox="RectangularBox"}(lte||(lte={})),function(e){e.BeginningOfLine="BeginningOfLine",e.EndOfLine="EndOfLine"}(cte||(cte={})),function(e){e.Mitered="Mitered",e.Bevelled="Bevelled",e.Rounded="Rounded",e.Square="Square"}(ute||(ute={})),function(e){e.Fast="Fast",e.Accurate="Accurate"}(hte||(hte={})),function(e){e.BeginningOfLine="BeginningOfLine",e.EndOfLine="EndOfLine"}(pte||(pte={})),function(e){e.Sinus="Sinus",e.Square="Square",e.Triangle="Triangle",e.Random="Random"}(dte||(dte={})),function(e){e[e.None=0]="None",e[e.Default=1]="Default",e[e.Force=2]="Force"}(fte||(fte={})),function(e){e[e.Buffered=0]="Buffered",e[e.Left=1]="Left",e[e.Right=2]="Right",e[e.AlongLine=3]="AlongLine"}(yte||(yte={})),function(e){e[e.Linear=0]="Linear",e[e.Rectangular=1]="Rectangular",e[e.Circular=2]="Circular",e[e.Buffered=3]="Buffered"}(mte||(mte={})),function(e){e[e.Discrete=0]="Discrete",e[e.Continuous=1]="Continuous"}(gte||(gte={})),function(e){e[e.AcrossLine=0]="AcrossLine",e[e.AloneLine=1]="AloneLine"}(vte||(vte={})),function(e){e[e.Left=0]="Left",e[e.Right=1]="Right",e[e.Center=2]="Center",e[e.Justify=3]="Justify"}(bte||(bte={})),function(e){e[e.Base=0]="Base",e[e.MidPoint=1]="MidPoint",e[e.ThreePoint=2]="ThreePoint",e[e.FourPoint=3]="FourPoint",e[e.Underline=4]="Underline",e[e.CircularCW=5]="CircularCW",e[e.CircularCCW=6]="CircularCCW"}(wte||(wte={})),function(e){e.Butt="Butt",e.Round="Round",e.Square="Square"}(DL||(DL={})),function(e){e.NoConstraint="NoConstraint",e.HalfPattern="HalfPattern",e.HalfGap="HalfGap",e.FullPattern="FullPattern",e.FullGap="FullGap",e.Custom="Custom"}(_te||(_te={})),function(e){e[e.None=-1]="None",e[e.Custom=0]="Custom",e[e.Circle=1]="Circle",e[e.OpenArrow=2]="OpenArrow",e[e.ClosedArrow=3]="ClosedArrow",e[e.Diamond=4]="Diamond"}(xte||(xte={})),function(e){e[e.ExtraLeading=0]="ExtraLeading",e[e.Multiple=1]="Multiple",e[e.Exact=2]="Exact"}(Ste||(Ste={})),function(e){e.Bevel="Bevel",e.Round="Round",e.Miter="Miter"}(jL||(jL={})),function(e){e[e.Default=0]="Default",e[e.String=1]="String",e[e.Numeric=2]="Numeric"}(Mte||(Mte={})),function(e){e[e.InsidePolygon=0]="InsidePolygon",e[e.PolygonCenter=1]="PolygonCenter",e[e.RandomlyInsidePolygon=2]="RandomlyInsidePolygon"}(Ite||(Ite={})),function(e){e[e.Tint=0]="Tint",e[e.Replace=1]="Replace",e[e.Multiply=2]="Multiply"}($te||($te={})),function(e){e[e.ClipAtBoundary=0]="ClipAtBoundary",e[e.RemoveIfCenterOutsideBoundary=1]="RemoveIfCenterOutsideBoundary",e[e.DoNotTouchBoundary=2]="DoNotTouchBoundary",e[e.DoNotClip=3]="DoNotClip"}(Ete||(Ete={})),function(e){e.NoConstraint="NoConstraint",e.WithMarkers="WithMarkers",e.WithFullGap="WithFullGap",e.WithHalfGap="WithHalfGap",e.Custom="Custom"}(Tte||(Tte={})),function(e){e.Fixed="Fixed",e.Random="Random",e.RandomFixedQuantity="RandomFixedQuantity"}(Cte||(Cte={})),function(e){e.LineMiddle="LineMiddle",e.LineBeginning="LineBeginning",e.LineEnd="LineEnd",e.SegmentMidpoint="SegmentMidpoint"}(kte||(kte={})),function(e){e.OnPolygon="OnPolygon",e.CenterOfMass="CenterOfMass",e.BoundingBoxCenter="BoundingBoxCenter"}(Ate||(Ate={})),function(e){e[e.Low=0]="Low",e[e.Medium=1]="Medium",e[e.High=2]="High"}(Pte||(Pte={})),function(e){e[e.MarkerCenter=0]="MarkerCenter",e[e.MarkerBounds=1]="MarkerBounds"}(Lte||(Lte={})),function(e){e[e.None=0]="None",e[e.PropUniform=1]="PropUniform",e[e.PropNonuniform=2]="PropNonuniform",e[e.DifUniform=3]="DifUniform",e[e.DifNonuniform=4]="DifNonuniform"}(Ote||(Ote={})),function(e){e.Tube="Tube",e.Strip="Strip",e.Wall="Wall"}(Rte||(Rte={})),function(e){e[e.Random=0]="Random",e[e.Increasing=1]="Increasing",e[e.Decreasing=2]="Decreasing",e[e.IncreasingThenDecreasing=3]="IncreasingThenDecreasing"}(Fte||(Fte={})),function(e){e[e.Relative=0]="Relative",e[e.Absolute=1]="Absolute"}(Nte||(Nte={})),function(e){e[e.Normal=0]="Normal",e[e.LowerCase=1]="LowerCase",e[e.Allcaps=2]="Allcaps"}(Dte||(Dte={})),function(e){e[e.LTR=0]="LTR",e[e.RTL=1]="RTL"}(jte||(jte={})),function(e){e.Draft="Draft",e.Picture="Picture",e.Text="Text"}(Vte||(Vte={})),function(e){e[e.Top=0]="Top",e[e.Center=1]="Center",e[e.Baseline=2]="Baseline",e[e.Bottom=3]="Bottom"}(zte||(zte={})),function(e){e[e.Right=0]="Right",e[e.Upright=1]="Upright"}(Gte||(Gte={})),function(e){e[e.Small=0]="Small",e[e.Medium=1]="Medium",e[e.Large=2]="Large"}(Bte||(Bte={})),function(e){e[e.Calm=0]="Calm",e[e.Rippled=1]="Rippled",e[e.Slight=2]="Slight",e[e.Moderate=3]="Moderate"}(Ute||(Ute={}));const Zr={main:new ut([255,127,0]),selected:new ut([255,255,255]),outline:new ut([0,0,0,.5]),selectedOutline:new ut([255,255,255]),hoverOutline:new ut([255,255,255]),secondary:new ut([255,255,255]),secondaryOutline:new ut([100,100,100]),transparent:new ut([0,0,0,0])};function gv(e,t){if(t)for(const i in t)e[i]=t[i]}class l3{constructor(t){this.size=8,this.hoverSize=10,this.color=Zr.main,this.hoverColor=Zr.main,this.outlineColor=Zr.outline,this.hoverOutlineColor=Zr.hoverOutline,gv(this,t)}}class hPe{constructor(t){this.color=Zr.secondary,this.hoverColor=Zr.main,gv(this,t)}}class pPe{constructor(t){this.color=Zr.transparent,this.hoverColor=Zr.transparent,this.outlineColor=Zr.main,this.hoverOutlineColor=Zr.main,this.stagedColor=Zr.transparent,this.stagedOutlineColor=Zr.secondary,gv(this,t)}}class dPe{constructor(t){this.vertex=new l3,this.midpoint=new l3({color:Zr.secondary,outlineColor:Zr.secondaryOutline,size:6}),this.selected=new l3({color:Zr.selected,hoverColor:Zr.selected,hoverOutlineColor:Zr.hoverOutline}),gv(this,t)}}class fPe{constructor(t){this.center=new l3({color:Zr.secondaryOutline}),this.fill=new pPe,this.line=new hPe,this.vertex=new l3({color:Zr.selected,outlineColor:Zr.main,hoverColor:Zr.selected,hoverOutlineColor:Zr.secondaryOutline}),gv(this,t)}}class yPe{constructor(t){this.reshapeGraphics=new dPe,this.transformGraphics=new fPe,gv(this,t)}}const BKe=new yPe;let Pc=class extends ke{constructor(){super(...arguments),this.enabled=!0}};g([w({type:Boolean})],Pc.prototype,"enabled",void 0),Pc=g([te("esri.views.interactive.snapping.Settings.DefaultSnappingAlgorithm")],Pc);let cn=class extends ke{constructor(e){super(e),this.lineSnapper=new Pc,this.parallelLineSnapper=new Pc,this.rightAngleSnapper=new Pc,this.rightAngleTriangleSnapper=new Pc,this.shortLineThreshold=15,this.distance=5,this.pointThreshold=1e-6,this.intersectionParallelLineThreshold=1e-6,this.parallelLineThreshold=1e-6,this.touchSensitivityMultiplier=1.5,this.pointOnLineThreshold=1e-6,this.orange=new ut([255,127,0]),this.lineHintWidthReference=3,this.lineHintWidthTarget=3,this.lineHintFadedExtensions=.3,this.parallelLineHintWidth=2,this.parallelLineHintLength=24,this.parallelLineHintOffset=1.5,this.rightAngleHintSize=24,this.rightAngleHintOutlineSize=1.5}};g([w({type:Pc,constructOnly:!0,nonNullable:!0,json:{write:!0}})],cn.prototype,"lineSnapper",void 0),g([w({type:Pc,constructOnly:!0,nonNullable:!0,json:{write:!0}})],cn.prototype,"parallelLineSnapper",void 0),g([w({type:Pc,constructOnly:!0,nonNullable:!0,json:{write:!0}})],cn.prototype,"rightAngleSnapper",void 0),g([w({type:Pc,constructOnly:!0,nonNullable:!0,json:{write:!0}})],cn.prototype,"rightAngleTriangleSnapper",void 0),g([w({type:Number,nonNullable:!0,range:{min:-1,max:50,step:1},json:{write:!0}})],cn.prototype,"shortLineThreshold",void 0),g([w({type:Number,nonNullable:!0,range:{min:-1,max:50,step:1},json:{write:!0}})],cn.prototype,"distance",void 0),g([w({type:Number,nonNullable:!0,range:{min:0,max:1e-5},json:{write:!0}})],cn.prototype,"pointThreshold",void 0),g([w({type:Number,nonNullable:!0,range:{min:0,max:1e-5},json:{write:!0}})],cn.prototype,"intersectionParallelLineThreshold",void 0),g([w({type:Number,nonNullable:!0,range:{min:0,max:1e-5},json:{write:!0}})],cn.prototype,"parallelLineThreshold",void 0),g([w({type:Number,nonNullable:!0,range:{min:0,max:10},json:{write:!0}})],cn.prototype,"touchSensitivityMultiplier",void 0),g([w({type:Number,nonNullable:!0,range:{min:0,max:1e-5},json:{write:!0}})],cn.prototype,"pointOnLineThreshold",void 0),g([w({type:ut,nonNullable:!0})],cn.prototype,"orange",void 0),g([w({type:Number,nonNullable:!0,range:{min:0,max:10},json:{write:!0}})],cn.prototype,"lineHintWidthReference",void 0),g([w({type:Number,nonNullable:!0,range:{min:0,max:10},json:{write:!0}})],cn.prototype,"lineHintWidthTarget",void 0),g([w({type:Number,nonNullable:!0,range:{min:0,max:1},json:{write:!0}})],cn.prototype,"lineHintFadedExtensions",void 0),g([w({type:Number,nonNullable:!0,range:{min:0,max:10},json:{write:!0}})],cn.prototype,"parallelLineHintWidth",void 0),g([w({type:Number,nonNullable:!0,range:{min:0,max:50},json:{write:!0}})],cn.prototype,"parallelLineHintLength",void 0),g([w({type:Number,nonNullable:!0,range:{min:0,max:5},json:{write:!0}})],cn.prototype,"parallelLineHintOffset",void 0),g([w({type:Number,nonNullable:!0,range:{min:0,max:46},json:{write:!0}})],cn.prototype,"rightAngleHintSize",void 0),g([w({type:Number,nonNullable:!0,range:{min:0,max:6},json:{write:!0}})],cn.prototype,"rightAngleHintOutlineSize",void 0),cn=g([te("esri.views.interactive.snapping.Settings.Defaults")],cn);const Ya=new cn;var ks;(function(e){e[e.FEATURE=1]="FEATURE",e[e.SELF=2]="SELF",e[e.ALL=3]="ALL"})(ks||(ks={}));function qte(e){return e?kr:bPe}function mPe(e,t){return ce(t)||!t.mode?qte(e).mode:t.mode}function VL(e,t){return H(t)?t:qte(e)}function Hte(e,t){return mPe(!!H(e)&&e.hasZ,t)}function UKe(e,t){return VL(!!H(e)&&e.hasZ,t)}function EI(e){const t=GL(e);return Hte(e.geometry,t)}function qKe(e){const t=GL(e),i=Hte(e.geometry,t);return{mode:i,offset:H(t)&&i!=="on-the-ground"?ws(t.offset,0)*cEe(ws(t.unit,"meters")):0}}function zL(e){if(EI(e)==="on-the-ground")return!1;const t=GL(e),i=H(t)&&t.featureExpressionInfo?t.featureExpressionInfo.expression:null;return!(!i||i==="0")}function GL(e){return e.layer&&"elevationInfo"in e.layer?e.layer.elevationInfo:null}function BL(e,t,i){if(ce(i)||!i.mode)return;const r=e.hasZ?e.z:0,n=H(i.offset)?i.offset:0;switch(i.mode){case"absolute-height":return r-n;case"on-the-ground":return 0;case"relative-to-ground":return r-(ws(t.elevationProvider.getElevation(e.x,e.y,e.z,e.spatialReference,"ground"),0)+n);case"relative-to-scene":return r-(ws(t.elevationProvider.getElevation(e.x,e.y,e.z,e.spatialReference,"scene"),0)+n)}}function UL(e,t,i,r=null){return Wte(e,t.x,t.y,t.hasZ?t.z:0,t.spatialReference,i,r)}function vv(e,t,i,r,n=null){return Wte(e,t[0],t[1],t.length>2?t[2]:0,i,r,n)}function Wte(e,t,i,r,n,o,c=null){if(ce(o))return;const h=H(c)?c.mode:"absolute-height";if(h==="on-the-ground")return 0;const{absoluteZ:m}=gPe(t,i,r,n,e,o);return vPe(m,t,i,r,n,e,c,h)}function gPe(e,t,i,r,n,o){const c=H(o.offset)?o.offset:0;switch(o.mode){case"absolute-height":return{absoluteZ:i+c,elevation:0};case"on-the-ground":{const h=ws(n.elevationProvider.getElevation(e,t,0,r,"ground"),0);return{absoluteZ:h,elevation:h}}case"relative-to-ground":{const h=ws(n.elevationProvider.getElevation(e,t,i,r,"ground"),0);return{absoluteZ:i+h+c,elevation:h}}case"relative-to-scene":{const h=ws(n.elevationProvider.getElevation(e,t,i,r,"scene"),0);return{absoluteZ:i+h+c,elevation:h}}}}function vPe(e,t,i,r,n,o,c,h){const m=H(c)&&H(c.offset)?c.offset:0;switch(h){case"absolute-height":return e-m;case"relative-to-ground":return e-(ws(o.elevationProvider.getElevation(t,i,r,n,"ground"),0)+m);case"relative-to-scene":return e-(ws(o.elevationProvider.getElevation(t,i,r,n,"scene"),0)+m)}}function HKe(e,t){if(ce(t))return!1;const{mode:i}=t;return H(i)&&(e==="scene"&&i==="relative-to-scene"||e==="ground"&&i!=="absolute-height")}const kr={mode:"absolute-height",offset:0},bPe={mode:"on-the-ground",offset:null};function wPe(e,t){return e===t||H(e)&&H(t)&&e.mode===t.mode&&e.offset===t.offset}function mo(e,t){const i=e.length===t.length&&e[0]===t[0]&&e[1]===t[1];switch(e.length){case 2:return i;case 3:return i&&e[2]===t[2];case 4:return i&&e[2]===t[2]&&e[3]===t[3]}return!1}function im(e,t){const i=e.x-t.x,r=e.y-t.y;return i*i+r*r}function _Pe(e,t){return Math.sqrt(im(e,t))}function qL(e,t,i){const r=i.toXYZ(e,xPe);t.sort((n,o)=>{const c=i.toXYZ(n.targetPoint,Jte),h=Sd(c,r),m=i.toXYZ(o.targetPoint,Jte);return h-Sd(m,r)})}const xPe=it(),Jte=it();var Lc;function WKe(e,t){return{point:e.coordinateHelper.vectorToPoint(e.point).toJSON(),distance:e.distance,types:e.types,query:H(t)?t.toJSON():{where:"1=1"}}}function bn(e,t,i,r){const{coordinateHelper:n,elevationInfo:o}=i;if(!n.hasZ()||ce(t)||t.type!=="3d"||ce(e)||wPe(o,r))return e;const c=vv(t,e,n.spatialReference,o,r),h=n.clone(e);return h[2]=c,h}function Ou(e,t,i,r=kr){return{left:bn(e.leftVertex.pos,t,i,r),right:bn(e.rightVertex.pos,t,i,r)}}function JKe(e){return e.createQuery()}(function(e){e[e.TARGET=0]="TARGET",e[e.REFERENCE=1]="REFERENCE",e[e.REFERENCE_EXTENSION=2]="REFERENCE_EXTENSION"})(Lc||(Lc={}));class c3{constructor(t,i){this.elevationInfo=t,this.domain=i}}class TI extends c3{constructor(t,i,r=ks.ALL){super(i,r),this.intersectionPoint=t}equals(t){return t instanceof TI&&mo(this.intersectionPoint,t.intersectionPoint)}}class Cl extends c3{constructor(t,i,r,n,o=ks.ALL,c=!0,h=!0){super(n,o),this.type=t,this.lineStart=i,this.lineEnd=r,this.fadeLeft=c,this.fadeRight=h}equals(t){return t instanceof Cl&&this.type===t.type&&mo(this.lineStart,t.lineStart)&&mo(this.lineEnd,t.lineEnd)&&this.fadeLeft===t.fadeLeft&&this.fadeRight===t.fadeRight}}class CI extends c3{constructor(t,i,r,n=ks.ALL){super(r,n),this.lineStart=t,this.lineEnd=i}equals(t){return t instanceof CI&&mo(this.lineStart,t.lineStart)&&mo(this.lineEnd,t.lineEnd)}}class HL extends c3{constructor(t,i,r){super(i,r),this.point=t}equals(t){return t instanceof HL&&mo(this.point,t.point)}}class u3 extends c3{constructor(t,i,r,n,o=ks.ALL){super(n,o),this.previousVertex=t,this.centerVertex=i,this.nextVertex=r}equals(t){return t instanceof u3&&mo(this.previousVertex,t.previousVertex)&&mo(this.centerVertex,t.centerVertex)&&mo(this.nextVertex,t.nextVertex)}}class SPe{draw(t,i){const r=this._getUniqueHints(t),n=[];for(const o of r)o instanceof TI&&n.push(this.visualizeIntersectionPoint(o,i)),o instanceof Cl&&n.push(this.visualizeLine(o,i)),o instanceof CI&&n.push(this.visualizeParallelSign(o,i)),o instanceof u3&&n.push(this.visualizeRightAngleQuad(o,i)),o instanceof HL&&n.push(this.visualizePoint(o,i));return od(n)}_getUniqueHints(t){const i=[];for(const r of t){let n=!0;for(const o of i)if(r.equals(o)){n=!1;break}n&&i.push(r)}return i}}class MPe extends SPe{constructor(t){super(),this._graphicsLayer=t}visualizeIntersectionPoint(t,i){return this._visualizeSnappingIndicator(new pt({x:t.intersectionPoint[0],y:t.intersectionPoint[1],spatialReference:i.coordinateHelper.spatialReference}),$Pe)}visualizePoint(t,i){return this._visualizeSnappingIndicator(new pt({x:t.point[0],y:t.point[1],spatialReference:i.coordinateHelper.spatialReference}),EPe)}visualizeLine(t,i){return this._visualizeSnappingIndicator(new Fn({paths:[[t.lineStart,t.lineEnd]],spatialReference:i.coordinateHelper.spatialReference}),TPe)}visualizeParallelSign(t,i){return this._visualizeSnappingIndicator(new Fn({paths:[[t.lineStart,t.lineEnd]],spatialReference:i.coordinateHelper.spatialReference}),CPe)}visualizeRightAngleQuad(t,i){return this._visualizeSnappingIndicator(new Fn({paths:[[t.previousVertex,t.centerVertex,t.nextVertex]],spatialReference:i.coordinateHelper.spatialReference}),PPe(t))}_visualizeSnappingIndicator(t,i){const r=new Gr({geometry:t,symbol:i});return this._graphicsLayer.add(r),uh(()=>{this._graphicsLayer.remove(r)})}}const bv=Zr.main.toArray(),IPe=[...Zr.main.toRgb(),100],$Pe=new Dn({outline:new rs({width:1.5,color:bv}),size:15,color:[0,0,0,0]}),EPe=new Dn({outline:{width:.5,color:[0,0,0,1]},size:10,color:bv}),TPe=new Id({data:{type:"CIMSymbolReference",symbol:{type:"CIMLineSymbol",symbolLayers:[{type:"CIMSolidStroke",enable:!0,capStyle:DL.Butt,joinStyle:jL.Round,miterLimit:10,width:$n(Ya.lineHintWidthTarget),color:bv}]}}}),CPe=new Id({data:{type:"CIMSymbolReference",symbol:{type:"CIMLineSymbol",symbolLayers:[{type:"CIMVectorMarker",enable:!0,anchorPoint:{x:0,y:-1,z:0},anchorPointUnits:"Relative",size:5,markerPlacement:{type:"CIMMarkerPlacementOnLine",placePerPart:!0,angleToLine:!0,relativeTo:"LineMiddle"},frame:{xmin:-5,ymin:-1.5,xmax:5,ymax:1.5},markerGraphics:[{type:"CIMMarkerGraphic",geometry:{rings:[[[7,0],[-7,0],[-7,1.5],[7,1.5]]]},symbol:{type:"CIMPolygonSymbol",symbolLayers:[{type:"CIMSolidFill",enable:!0,color:bv}]}}],scaleSymbolsProportionally:!0,respectFrame:!0},{type:"CIMVectorMarker",enable:!0,anchorPoint:{x:0,y:1,z:0},anchorPointUnits:"Relative",size:5,markerPlacement:{type:"CIMMarkerPlacementOnLine",placePerPart:!0,angleToLine:!0,relativeTo:"LineMiddle"},frame:{xmin:-5,ymin:-1.5,xmax:5,ymax:1.5},markerGraphics:[{type:"CIMMarkerGraphic",geometry:{rings:[[[7,0],[-7,0],[-7,-1.5],[7,-1.5]]]},symbol:{type:"CIMPolygonSymbol",symbolLayers:[{type:"CIMSolidFill",enable:!0,color:bv}]}}],scaleSymbolsProportionally:!0,respectFrame:!0}]}}}),Zte=e=>new Id({data:{type:"CIMSymbolReference",symbol:{type:"CIMLineSymbol",symbolLayers:[{type:"CIMVectorMarker",enable:!0,anchorPoint:{x:.5,y:.5,z:0},anchorPointUnits:"Relative",size:$n(Ya.rightAngleHintSize),rotation:e,markerPlacement:{type:"CIMMarkerPlacementOnVertices",placePerPart:!0,angleToLine:!0,placeOnEndPoints:!1},frame:{xmin:-5,ymin:-5,xmax:5,ymax:5},markerGraphics:[{type:"CIMMarkerGraphic",geometry:{paths:[[[5,-5],[-5,-5],[-5,5],[5,5],[5,-5]]]},symbol:{type:"CIMLineSymbol",symbolLayers:[{type:"CIMSolidStroke",enable:!0,capStyle:"Butt",joinStyle:"Round",miterLimit:10,width:$n(Ya.rightAngleHintOutlineSize),color:bv},{type:"CIMSolidFill",enable:!0,color:IPe}]}}],scaleSymbolsProportionally:!0,respectFrame:!0}]}}}),kPe=Zte(45),APe=Zte(225),PPe=(()=>{const e=ui(),t=ui(),i=it();return r=>(Jr(e,r.centerVertex,r.previousVertex),Jr(t,r.nextVertex,r.previousVertex),YP(i,e,t),i[2]<0?kPe:APe)})();var Bn;(function(e){e[e.Z=0]="Z",e[e.M=1]="M"})(Bn||(Bn={}));class LPe{constructor(t){this.spatialReference=t}createVector(){return this._tag(ui())}pointToVector(t){return this._tag(sp(t.x,t.y))}arrayToVector(t){return this._tag(sp(t[0],t[1]))}vectorToArray(t){return[t[0],t[1]]}pointToArray(t){return[t.x,t.y]}vectorToPoint(t,i=new pt){return i.x=t[0],i.y=t[1],i.z=void 0,i.m=void 0,i.spatialReference=this.spatialReference,i}arrayToPoint(t,i=new pt){return i.x=t[0],i.y=t[1],i.z=void 0,i.m=void 0,i.spatialReference=this.spatialReference,i}vectorToDehydratedPoint(t,i={x:void 0,y:void 0,z:void 0,m:void 0,hasZ:void 0,hasM:void 0,spatialReference:void 0,type:"point"}){return i.x=t[0],i.y=t[1],i.z=void 0,i.m=void 0,i.hasZ=!1,i.hasM=!1,i.spatialReference=this.spatialReference,i}lerp(t,i,r,n){return rI(n,t,i,r)}addDelta(t,i,r){t[0]+=i,t[1]+=r}distance(t,i){return rp(t,i)}getZ(t,i){return i}hasZ(){return!1}getM(t,i){return i}hasM(){return!1}clone(t){return this._tag(dQ(t))}copy(t,i){return Y1(i,t)}fromXYZ(t){return this._tag(sp(t[0],t[1]))}toXYZ(t,i=it()){return Nn(i,t[0],t[1],0)}equals(t,i){return XP(t,i)}_tag(t){return t}}class Kte{constructor(t,i){this._valueType=t,this.spatialReference=i}createVector(){return this._tag(it())}pointToVector(t){return this._tag(Mn(t.x,t.y,this._valueType===Bn.Z?t.z:t.m))}arrayToVector(t){return this._tag(Mn(t[0],t[1],t[2]||0))}vectorToArray(t){return[t[0],t[1],t[2]]}pointToArray(t){return this._valueType===Bn.Z?[t.x,t.y,t.z]:[t.x,t.y,t.m]}vectorToPoint(t,i=new pt){return i.x=t[0],i.y=t[1],i.z=this._valueType===Bn.Z?t[2]:void 0,i.m=this._valueType===Bn.M?t[2]:void 0,i.spatialReference=this.spatialReference,i}arrayToPoint(t,i=new pt){return i.x=t[0],i.y=t[1],i.z=this._valueType===Bn.Z?t[2]:void 0,i.m=this._valueType===Bn.M?t[2]:void 0,i.spatialReference=this.spatialReference,i}vectorToDehydratedPoint(t,i={x:void 0,y:void 0,z:void 0,m:void 0,hasZ:void 0,hasM:void 0,spatialReference:void 0,type:"point"}){const r=this._valueType===Bn.Z,n=this._valueType===Bn.M;return i.x=t[0],i.y=t[1],i.z=r?t[2]:void 0,i.m=n?t[2]:void 0,i.hasZ=r,i.hasM=n,i.spatialReference=this.spatialReference,i}lerp(t,i,r,n){return yG(n,t,i,r)}addDelta(t,i,r,n){t[0]+=i,t[1]+=r,this._valueType===Bn.Z&&(t[2]+=n)}distance(t,i){return this._valueType===Bn.Z?_g(t,i):rp(t,i)}getZ(t,i){return this._valueType===Bn.Z?t[2]:i}hasZ(){return this._valueType===Bn.Z}getM(t,i){return this._valueType===Bn.M?t[2]:i}hasM(){return this._valueType===Bn.M}clone(t){return this._tag(sG(t))}copy(t,i){return ko(i,t)}fromXYZ(t,i=0,r=0){return this._tag(Mn(t[0],t[1],this._valueType===Bn.Z?t.length>2?t[2]:i:r))}toXYZ(t,i=it()){return Nn(i,t[0],t[1],this._valueType===Bn.Z?t[2]:0)}equals(t,i){return n5(t,i)}_tag(t){return t}}class OPe{constructor(t){this.spatialReference=t}createVector(){return this._tag(T1())}pointToVector(t){return this._tag(Sc(t.x,t.y,t.z,t.m))}arrayToVector(t){return this._tag(Sc(t[0],t[1],t[2]||0,t[3]||0))}vectorToArray(t){return[t[0],t[1],t[2],t[3]]}pointToArray(t){return[t.x,t.y,t.z,t.m]}vectorToPoint(t,i=new pt){return i.x=t[0],i.y=t[1],i.z=t[2],i.m=t[3],i.spatialReference=this.spatialReference,i}arrayToPoint(t,i=new pt){return i.x=t[0],i.y=t[1],i.z=t[2],i.m=t[3],i.spatialReference=this.spatialReference,i}vectorToDehydratedPoint(t,i={x:void 0,y:void 0,z:void 0,m:void 0,hasZ:void 0,hasM:void 0,spatialReference:void 0,type:"point"}){return i.x=t[0],i.y=t[1],i.z=t[2],i.m=t[3],i.hasZ=!0,i.hasM=!0,i.spatialReference=this.spatialReference,i}lerp(t,i,r,n){return l5(n,t,i,r)}addDelta(t,i,r,n){t[0]+=i,t[1]+=r,t[2]+=n}distance(t,i){return _g(t,i)}getZ(t){return t[2]}hasZ(){return!0}getM(t){return t[3]}hasM(){return!0}clone(t){return this._tag(GZ(t))}copy(t,i){return a5(i,t)}fromXYZ(t,i=0,r=0){return this._tag(Sc(t[0],t[1],t.length>2?t[2]:i,r))}toXYZ(t,i=it()){return Nn(i,t[0],t[1],t[2])}equals(t,i){return F6(t,i)}_tag(t){return t}}function WL(e,t,i){return e&&t?new OPe(i):t?new Kte(Bn.M,i):e?new Kte(Bn.Z,i):new LPe(i)}function RPe(e,t){if(!t.supported)return;let i=1/0,r=-1/0;const n=t.upperBoundX-t.lowerBoundX;e.forEach(c=>{let h=c.pos[0];for(;h<t.lowerBoundX;)h+=n;for(;h>t.upperBoundX;)h-=n;i=Math.min(i,h),r=Math.max(r,h),c.pos[0]=h});const o=r-i;n-o<o&&e.forEach(c=>{c.pos[0]<0&&(c.pos[0]+=n)})}function FPe(e,t){const i=Wo(e);return t===ma.Global&&i?{supported:!0,lowerBoundX:i.valid[0],upperBoundX:i.valid[1]}:{supported:!1,lowerBoundX:null,upperBoundX:null}}class h3{constructor(t){this.component=t,this.leftEdge=null,this.rightEdge=null,this.type="vertex",this.index=null}get pos(){return this._pos}set pos(t){this._pos=t,this.component.unnormalizeVertexPositions()}}class dp{constructor(t,i,r){this.component=t,this.leftVertex=i,this.rightVertex=r,this.type="edge",i.rightEdge=this,r.leftEdge=this}}class wv{constructor(t,i){this._spatialReference=t,this._viewingMode=i,this.vertices=[],this.edges=[]}unnormalizeVertexPositions(){this.vertices.length<=1||RPe(this.vertices,FPe(this._spatialReference,this._viewingMode))}updateVertexIndex(t,i){if(this.vertices.length===0)return;const r=this.vertices[0];let n=null,o=t,c=i;do n=o,n.index=c++,o=n.rightEdge?n.rightEdge.rightVertex:null;while(o!=null&&o!==r);n.leftEdge&&n!==this.vertices[this.vertices.length-1]&&this.swapVertices(this.vertices.indexOf(n),this.vertices.length-1)}getFirstVertex(){return this.vertices.length===0?null:this.vertices[0]}getLastVertex(){return this.vertices.length===0?null:this.vertices[this.vertices.length-1]}isClosed(){return this.vertices.length>2&&this.vertices[0].leftEdge!==null}swapVertices(t,i){const r=this.vertices[t];this.vertices[t]=this.vertices[i],this.vertices[i]=r}iterateVertices(t){if(this.vertices.length===0)return;const i=this.vertices[0];let r=i;do t(r,r.index),r=H(r.rightEdge)?r.rightEdge.rightVertex:null;while(r!==i&&r!=null)}}class _v extends Or{constructor(t,i){super(),this.type=t,this.coordinateHelper=i,this._geometry=null,this._dirty=!0,this.components=[]}get geometry(){if(this._dirty){switch(this.type){case"point":this._geometry=this._toPoint();break;case"polyline":this._geometry=this._toPolyline();break;case"polygon":this._geometry=this._toPolygon()}this._dirty=!1}return this._geometry}get spatialReference(){return this.coordinateHelper.spatialReference}notifyChanges(t){this._dirty=!0,this.emit("change",t)}_toPoint(){return this.components.length===0||this.components[0].vertices.length===0?null:this.coordinateHelper.vectorToPoint(this.components[0].vertices[0].pos)}_toPolyline(){const t=[],i=this.coordinateHelper.vectorToArray;for(const r of this.components){if(r.vertices.length<1)continue;const n=[];let o=r.vertices.find(h=>h.leftEdge==null);const c=o;do n.push(i(o.pos)),o=o.rightEdge?o.rightEdge.rightVertex:null;while(o&&o!==c);t.push(n)}return new Fn({paths:t,spatialReference:this.spatialReference,hasZ:this.coordinateHelper.hasZ(),hasM:this.coordinateHelper.hasM()})}_toPolygon(){const t=[],i=this.coordinateHelper.vectorToArray;for(const r of this.components){if(r.vertices.length<1)continue;const n=[],o=r.vertices[0];let c=o;const h=c;do n.push(i(c.pos)),c=H(c.rightEdge)?c.rightEdge.rightVertex:null;while(c&&c!==h);r.isClosed()&&n.push(i(o.pos)),t.push(n)}return new es({rings:t,spatialReference:this.spatialReference,hasZ:this.coordinateHelper.hasZ(),hasM:this.coordinateHelper.hasM()})}static fromGeometry(t,i){const r=t.spatialReference,n=WL(t.hasZ,t.hasM,r),o=new _v(t.type,n);switch(t.type){case"polygon":{const c=t.rings;for(let h=0;h<c.length;++h){const m=c[h],b=new wv(r,i),x=m.length>2&&sd(m[0],m[m.length-1]),I=x?m.length-1:m.length;for(let k=0;k<I;++k){const P=n.arrayToVector(m[k]),F=new h3(b);b.vertices.push(F),F.pos=P,F.index=k}const E=b.vertices.length-1;for(let k=0;k<E;++k){const P=b.vertices[k],F=b.vertices[k+1],N=new dp(b,P,F);b.edges.push(N)}if(x){const k=new dp(b,b.vertices[b.vertices.length-1],b.vertices[0]);b.edges.push(k)}o.components.push(b)}break}case"polyline":for(const c of t.paths){const h=new wv(r,i),m=c.length;for(let x=0;x<m;++x){const I=n.arrayToVector(c[x]),E=new h3(h);h.vertices.push(E),E.pos=I,E.index=x}const b=h.vertices.length-1;for(let x=0;x<b;++x){const I=h.vertices[x],E=h.vertices[x+1],k=new dp(h,I,E);h.edges.push(k)}o.components.push(h)}break;case"point":{const c=new wv(r,i),h=new h3(c);h.index=0,h.pos=n.pointToVector(t),c.vertices.push(h),o.components.push(c);break}}return o}}var fp;(function(e){e[e.NEW_STEP=0]="NEW_STEP",e[e.ACCUMULATE_STEPS=1]="ACCUMULATE_STEPS"})(fp||(fp={}));class NPe{constructor(t,i,r){this._editGeometry=t,this._component=i,this._pos=r,this._addedVertex=null,this._originalEdge=null,this._left=null,this._right=null}apply(){let t="redo";ce(this._addedVertex)&&(t="apply",this._addedVertex=new h3(this._component));const i=this._component.getLastVertex();if(ce(i))this._component.vertices.push(this._addedVertex),this._addedVertex.pos=this._pos,this._addedVertex.index=0;else{let r=null;i.rightEdge&&(this._originalEdge=i.rightEdge,r=this._originalEdge.rightVertex,this._component.edges.splice(this._component.edges.indexOf(this._originalEdge),1)),this._component.vertices.push(this._addedVertex),this._addedVertex.pos=this._pos,ce(this._left)&&(this._left=new dp(this._component,i,this._addedVertex)),this._component.edges.push(this._left),i.rightEdge=this._left,H(this._originalEdge)&&H(r)&&(ce(this._right)&&(this._right=new dp(this._component,this._addedVertex,r)),this._component.edges.push(this._right),r.leftEdge=this._right),this._component.updateVertexIndex(this._addedVertex,i.index+1)}this._editGeometry.notifyChanges({operation:t,addedVertices:[this._addedVertex]})}undo(){ce(this._addedVertex)||(this._component.vertices.splice(this._component.vertices.indexOf(this._addedVertex),1),H(this._left)&&(this._component.edges.splice(this._component.edges.indexOf(this._left),1),this._left.leftVertex.rightEdge=null),H(this._right)&&(this._component.edges.splice(this._component.edges.indexOf(this._right),1),this._right.rightVertex.leftEdge=null),H(this._originalEdge)&&(this._component.edges.push(this._originalEdge),this._originalEdge.leftVertex.rightEdge=this._originalEdge,this._originalEdge.rightVertex.leftEdge=this._originalEdge),H(this._left)?this._component.updateVertexIndex(this._left.leftVertex,this._left.leftVertex.index):this._component.updateVertexIndex(this._addedVertex,0),this._editGeometry.notifyChanges({operation:"undo",removedVertices:[this._addedVertex]}))}accumulate(){return!1}}class JL{constructor(t,i,r){this._editGeometry=t,this._vertices=i,this.operation=r,this._undone=!1}apply(){this._vertices.forEach(t=>this.operation.apply(t)),this._editGeometry.components.forEach(t=>t.unnormalizeVertexPositions()),this._editGeometry.notifyChanges({operation:this._undone?"redo":"apply",updatedVertices:this._vertices})}undo(){this._vertices.forEach(t=>this.operation.undo(t)),this._editGeometry.notifyChanges({operation:"undo",updatedVertices:this._vertices}),this._undone=!0}canAccumulate(t){if(this._undone||t._vertices.length!==this._vertices.length)return!1;for(let i=0;i<t._vertices.length;++i)if(t._vertices[i]!==this._vertices[i])return!1;return this.operation.canAccumulate(t.operation)}accumulate(t){return!!(t instanceof JL&&this.canAccumulate(t))&&(this._vertices.forEach(i=>this.operation.accumulate(i,t.operation)),this.operation.accumulateParams(t.operation),this._editGeometry.components.forEach(i=>i.unnormalizeVertexPositions()),this._editGeometry.notifyChanges({operation:"apply",updatedVertices:this._vertices}),!0)}}var Ru;(function(e){e[e.CUMULATIVE=0]="CUMULATIVE",e[e.REPLACE=1]="REPLACE"})(Ru||(Ru={}));class DPe{constructor(t,i,r=0){this._editGeometry=t,this._vertices=i,this._minNumberOfVertices=r,this.removedVertices=null}apply(){let t="redo";if(this.removedVertices==null){const i=this.removedVertices=[];this._vertices.forEach(r=>{const n=this._removeVertex(r);H(n)&&i.push(n)}),t="apply"}else this.removedVertices.forEach(i=>{this._removeVertex(i.removedVertex)});this._editGeometry.notifyChanges({operation:t,removedVertices:this._vertices})}undo(){var t;(t=this.removedVertices)==null||t.forEach(i=>{this._undoRemoveVertex(i)}),this._editGeometry.notifyChanges({operation:"undo",addedVertices:this._vertices})}accumulate(){return!1}_removeVertex(t){const i=t.component;if(i.vertices.length<=this._minNumberOfVertices)return null;const r={removedVertex:t,createdEdge:null},n=t.leftEdge,o=t.rightEdge;return i.vertices.splice(i.vertices.indexOf(t),1),n&&(i.edges.splice(i.edges.indexOf(n),1),n.leftVertex.rightEdge=null),o&&(i.edges.splice(i.edges.indexOf(o),1),o.rightVertex.leftEdge=null),t.index===0&&o&&this._vertices.length>0&&i.swapVertices(i.vertices.indexOf(o.rightVertex),0),n&&o&&(r.createdEdge=new dp(i,n.leftVertex,o.rightVertex),i.edges.push(r.createdEdge)),o&&i.updateVertexIndex(o.rightVertex,o.rightVertex.index-1),r}_undoRemoveVertex(t){const i=t.removedVertex,r=t.removedVertex.component,n=i.leftEdge,o=i.rightEdge;t.createdEdge&&r.edges.splice(r.edges.indexOf(t.createdEdge),1),r.vertices.push(i),n&&(r.edges.push(n),n.leftVertex.rightEdge=n),o&&(r.edges.push(o),o.rightVertex.leftEdge=o),r.updateVertexIndex(i,i.index)}}class jPe{constructor(t,i,r){this._editGeometry=t,this._edge=i,this._t=r,this.createdVertex=null,this._left=null,this._right=null}apply(){let t="redo";const i=this._edge,r=i.component,n=i.leftVertex,o=i.rightVertex;r.edges.splice(r.edges.indexOf(i),1),ce(this.createdVertex)&&(t="apply",this.createdVertex=new h3(i.component)),r.vertices.push(this.createdVertex),this.createdVertex.pos=this._editGeometry.coordinateHelper.lerp(i.leftVertex.pos,i.rightVertex.pos,this._t,this._editGeometry.coordinateHelper.createVector()),ce(this._left)&&(this._left=new dp(r,n,this.createdVertex)),this._left.leftVertex.leftEdge?r.edges.push(this._left):r.edges.unshift(this._left),n.rightEdge=this._left,ce(this._right)&&(this._right=new dp(r,this.createdVertex,o)),r.edges.push(this._right),o.leftEdge=this._right,r.updateVertexIndex(this.createdVertex,n.index+1),this._editGeometry.notifyChanges({operation:t,addedVertices:[this.createdVertex]})}undo(){if(ce(this.createdVertex)||ce(this._left)||ce(this._right))return null;const t=this._edge,i=t.component,r=this.createdVertex.leftEdge,n=this.createdVertex.rightEdge,o=r==null?void 0:r.leftVertex,c=n==null?void 0:n.rightVertex;i.vertices.splice(i.vertices.indexOf(this.createdVertex),1),i.edges.splice(i.edges.indexOf(this._left),1),i.edges.splice(i.edges.indexOf(this._right),1),this._edge.leftVertex.leftEdge?i.edges.push(this._edge):i.edges.unshift(this._edge),o&&(o.rightEdge=t),c&&(c.leftEdge=t),o&&i.updateVertexIndex(o,o.index),this._editGeometry.notifyChanges({operation:"undo",removedVertices:[this.createdVertex]})}accumulate(){return!1}}class ZL{constructor(t,i,r){this._editGeometry=t,this._vertex=i,this._pos=r}apply(){const t=ce(this._originalPosition);t&&(this._originalPosition=this._vertex.pos),this._apply(t?"apply":"redo")}undo(){this._vertex.pos=Ht(this._originalPosition),this._editGeometry.notifyChanges({operation:"undo",updatedVertices:[this._vertex]})}accumulate(t){return t instanceof ZL&&t._vertex===this._vertex&&(this._pos=t._pos,this._apply("apply"),!0)}_apply(t){this._vertex.pos=this._pos,this._editGeometry.components.forEach(i=>i.unnormalizeVertexPositions()),this._editGeometry.notifyChanges({operation:t,updatedVertices:[this._vertex]})}}class VPe{constructor(t,i){this._editGeometry=t,this._component=i,this._createdEdge=null}apply(){let t="redo";if(ce(this._createdEdge)){t="apply";const i=this._component.getFirstVertex(),r=this._component.getLastVertex();if(this._component.isClosed()||this._component.vertices.length<3||ce(i)||ce(r))return;this._createdEdge=new dp(this._component,r,i)}this._createdEdge.leftVertex.rightEdge=this._createdEdge,this._createdEdge.rightVertex.leftEdge=this._createdEdge,this._component.edges.push(this._createdEdge),this._editGeometry.notifyChanges({operation:t})}undo(){ce(this._createdEdge)||(Tj(this._component.edges,this._createdEdge),this._createdEdge.leftVertex.rightEdge=null,this._createdEdge.rightVertex.leftEdge=null,this._editGeometry.notifyChanges({operation:"undo"}))}accumulate(){return!1}}class KL{constructor(t,i,r,n){this._helper=t,this.dx=i,this.dy=r,this.dz=n}_move(t,i,r,n){this._helper.addDelta(t.pos,i,r,n)}apply(t){this._move(t,this.dx,this.dy,this.dz)}undo(t){this._move(t,-this.dx,-this.dy,-this.dz)}canAccumulate(t){return t instanceof KL}accumulate(t,i){this._move(t,i.dx,i.dy,i.dz)}accumulateParams(t){this.dx+=t.dx,this.dy+=t.dy,this.dz+=t.dz}}var yp;(function(e){e[e.X=0]="X",e[e.Y=1]="Y",e[e.Z=2]="Z"})(yp||(yp={}));class zPe{constructor(t){this._allocator=t,this._items=[],this._itemsPtr=0,this._grow()}get(){return this._itemsPtr===0&&Qm(()=>this._reset()),this._itemsPtr===this._items.length&&this._grow(),this._items[this._itemsPtr++]}_reset(){const t=Math.min(3*Math.max(8,this._itemsPtr),this._itemsPtr+3*Yte);this._items.length=Math.min(t,this._items.length),this._itemsPtr=0}_grow(){for(let t=0;t<Math.max(8,Math.min(this._items.length,Yte));t++)this._items.push(this._allocator())}}const Yte=1024;function Xte(){return[1,0,0,0,1,0,0,0,1]}function GPe(e){return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8]]}function BPe(e,t,i,r,n,o,c,h,m){return[e,t,i,r,n,o,c,h,m]}function Qte(e,t){return new Float64Array(e,t,9)}Object.freeze(Object.defineProperty({__proto__:null,create:Xte,clone:GPe,fromValues:BPe,createView:Qte},Symbol.toStringTag,{value:"Module"}));function eie(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function UPe(e){return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8],e[9],e[10],e[11],e[12],e[13],e[14],e[15]]}function qPe(e,t,i,r,n,o,c,h,m,b,x,I,E,k,P,F){return[e,t,i,r,n,o,c,h,m,b,x,I,E,k,P,F]}function tie(e,t){return new Float64Array(e,t,16)}const HPe=eie();Object.freeze(Object.defineProperty({__proto__:null,create:eie,clone:UPe,fromValues:qPe,createView:tie,IDENTITY:HPe},Symbol.toStringTag,{value:"Module"}));function xv(){return[0,0,0,1]}function WPe(e){return[e[0],e[1],e[2],e[3]]}function JPe(e,t,i,r){return[e,t,i,r]}function iie(e,t){return new Float64Array(e,t,4)}const ZPe=xv();Object.freeze(Object.defineProperty({__proto__:null,create:xv,clone:WPe,fromValues:JPe,createView:iie,IDENTITY:ZPe},Symbol.toStringTag,{value:"Module"}));class Xa{constructor(t,i,r){this._itemByteSize=t,this._itemCreate=i,this._buffers=new Array,this._items=new Array,this._itemsPtr=0,this._itemsPerBuffer=Math.ceil(r/this._itemByteSize)}get(){this._itemsPtr===0&&Qm(()=>this._reset());const t=Math.floor(this._itemsPtr/this._itemsPerBuffer);for(;this._buffers.length<=t;){const i=new ArrayBuffer(this._itemsPerBuffer*this._itemByteSize);for(let r=0;r<this._itemsPerBuffer;++r)this._items.push(this._itemCreate(i,r*this._itemByteSize));this._buffers.push(i)}return this._items[this._itemsPtr++]}_reset(){const t=2*(Math.floor(this._itemsPtr/this._itemsPerBuffer)+1);for(;this._buffers.length>t;)this._buffers.pop(),this._items.length=this._buffers.length*this._itemsPerBuffer;this._itemsPtr=0}static createVec2f64(t=Sv){return new Xa(16,fQ,t)}static createVec3f64(t=Sv){return new Xa(24,oG,t)}static createVec4f64(t=Sv){return new Xa(32,BZ,t)}static createMat3f64(t=Sv){return new Xa(72,Qte,t)}static createMat4f64(t=Sv){return new Xa(128,tie,t)}static createQuatf64(t=Sv){return new Xa(32,iie,t)}get test(){return{size:this._buffers.length*this._itemsPerBuffer*this._itemByteSize}}}const Sv=4*t1.KILOBYTES,ZKe=Xa.createVec2f64(),As=Xa.createVec3f64(),KPe=Xa.createVec4f64();Xa.createMat3f64();const YPe=Xa.createMat4f64(),KKe=Xa.createQuatf64();function kI(e){return e?rie(xd(e.origin),xd(e.direction)):rie(it(),it())}function rie(e,t){return{origin:e,direction:t}}function YKe(e,t){const i=eLe.get();return i.origin=e,i.direction=t,i}function XKe(e,t=kI()){return XPe(e.origin,e.direction,t)}function QKe(e,t,i=kI()){return ko(i.origin,e),fn(i.direction,t,e),i}function XPe(e,t,i=kI()){return ko(i.origin,e),ko(i.direction,t),i}function eYe(e,t){const i=is(As.get(),Ds(As.get(),e.direction),fn(As.get(),t,e.origin));return Ci(i,i)}function QPe(e,t,i){const r=Ci(e.direction,fn(i,t,e.origin));return Ko(i,e.origin,Yo(i,e.direction,r)),i}const eLe=new zPe(()=>kI());function tYe(e,t,i){const r=Ci(e,t)/Ci(e,e);return Yo(i,e,r)}function p3(e,t){return Ci(e,t)/ml(e)}function nie(e,t){const i=Ci(e,t)/(ml(e)*ml(t));return-D6(i)}function iYe(e,t,i){Ds(AI,e),Ds(YL,t);const r=Ci(AI,YL),n=D6(r),o=is(AI,AI,YL);return Ci(o,i)<0?2*Math.PI-n:n}const AI=it(),YL=it();function XL(){return T1()}function sie(e,t=XL()){return a5(t,e)}function tLe(e,t){return Sc(e[0],e[1],e[2],t)}function iLe(e){return e}function rLe(e){e[0]=e[1]=e[2]=e[3]=0}function nLe(e,t){return e[0]=e[1]=e[2]=0,e[3]=t,e}function PI(e){return e[3]}function mp(e){return e}function sLe(e,t,i,r){return Sc(e,t,i,r)}function oLe(e,t,i){return e!==i&&ko(i,e),i[3]=e[3]+t,i}function aLe(e,t,i){return $e.getLogger("esri.geometry.support.sphere").error("sphere.setExtent is not yet supported"),e===i?i:sie(e,i)}function LI(e,t,i){if(ce(t))return!1;const{origin:r,direction:n}=t,o=lLe;o[0]=r[0]-e[0],o[1]=r[1]-e[1],o[2]=r[2]-e[2];const c=n[0]*n[0]+n[1]*n[1]+n[2]*n[2];if(c===0)return!1;const h=2*(n[0]*o[0]+n[1]*o[1]+n[2]*o[2]),m=h*h-4*c*(o[0]*o[0]+o[1]*o[1]+o[2]*o[2]-e[3]*e[3]);if(m<0)return!1;const b=Math.sqrt(m);let x=(-h-b)/(2*c);const I=(-h+b)/(2*c);return(x<0||I<x&&I>0)&&(x=I),!(x<0)&&(i&&(i[0]=r[0]+n[0]*x,i[1]=r[1]+n[1]*x,i[2]=r[2]+n[2]*x),!0)}const lLe=it();function cLe(e,t){return LI(e,t,null)}function uLe(e,t,i){if(LI(e,t,i))return i;const r=oie(e,t,As.get());return Ko(i,t.origin,Yo(As.get(),t.direction,_g(t.origin,r)/ml(t.direction))),i}function oie(e,t,i){const r=As.get(),n=YPe.get();is(r,t.origin,t.direction);const o=PI(e);is(i,r,t.origin),Yo(i,i,1/ml(i)*o);const c=lie(e,t.origin),h=nie(t.origin,i);return QU(n,h+c,r),mG(i,i,n),i}function hLe(e,t,i){return LI(e,t,i)?i:(QPe(t,mp(e),i),aie(e,i,i))}function aie(e,t,i){const r=fn(As.get(),t,mp(e)),n=Yo(As.get(),r,e[3]/ml(r));return Ko(i,n,mp(e))}function pLe(e,t){const i=fn(As.get(),t,mp(e)),r=k6(i),n=e[3]*e[3];return Math.sqrt(Math.abs(r-n))}function lie(e,t){const i=fn(As.get(),t,mp(e)),r=ml(i),n=PI(e),o=n+Math.abs(n-r);return D6(n/o)}const QL=it();function cie(e,t,i,r){const n=fn(QL,t,mp(e));switch(i){case yp.X:{const o=AG(n,QL)[2];return Nn(r,-Math.sin(o),Math.cos(o),0)}case yp.Y:{const o=AG(n,QL),c=o[1],h=o[2],m=Math.sin(c);return Nn(r,-m*Math.cos(h),-m*Math.sin(h),Math.cos(c))}case yp.Z:return Ds(r,n);default:return}}function uie(e,t){const i=fn(eO,t,mp(e));return ml(i)-e[3]}function dLe(e,t,i,r){const n=uie(e,t),o=cie(e,t,yp.Z,eO),c=Yo(eO,o,i-n);return Ko(r,t,c)}function fLe(e,t){const i=Sd(mp(e),t),r=PI(e);return i<=r*r}const eO=it(),yLe=XL();Object.freeze(Object.defineProperty({__proto__:null,create:XL,copy:sie,fromCenterAndRadius:tLe,wrap:iLe,clear:rLe,fromRadius:nLe,getRadius:PI,getCenter:mp,fromValues:sLe,elevate:oLe,setExtent:aLe,intersectRay:LI,intersectsRay:cLe,intersectRayClosestSilhouette:uLe,closestPointOnSilhouette:oie,closestPoint:hLe,projectPoint:aie,distanceToSilhouette:pLe,angleToSilhouette:lie,axisAt:cie,altitudeAt:uie,setAltitudeAt:dLe,containsPoint:fLe,tmpSphere:yLe},Symbol.toStringTag,{value:"Module"}));function rYe(e){const t=e[0]*e[0]+e[4]*e[4]+e[8]*e[8],i=e[1]*e[1]+e[5]*e[5]+e[9]*e[9],r=e[2]*e[2]+e[6]*e[6]+e[10]*e[10];return Math.sqrt(Math.max(t,i,r))}function nYe(e,t){const i=Math.sqrt(t[0]*t[0]+t[4]*t[4]+t[8]*t[8]),r=Math.sqrt(t[1]*t[1]+t[5]*t[5]+t[9]*t[9]),n=Math.sqrt(t[2]*t[2]+t[6]*t[6]+t[10]*t[10]);return Nn(e,i,r,n),e}function mLe(e,t,i){Math.abs(e[0])>Math.abs(e[1])?Nn(t,0,1,0):Nn(t,1,0,0),is(i,e,t),Ds(t,t),is(t,i,e),Ds(i,i)}function OI(e=f3){return[e[0],e[1],e[2],e[3]]}function sYe(e=f3[0],t=f3[1],i=f3[2],r=f3[3]){return hie(e,t,i,r,KPe.get())}function RI(e,t){return hie(t[0],t[1],t[2],t[3],e)}function hie(e,t,i,r,n=OI()){return n[0]=e,n[1]=t,n[2]=i,n[3]=r,n}function pie(e,t,i){const r=t[0]*t[0]+t[1]*t[1]+t[2]*t[2],n=Math.abs(r-1)>1e-5&&r>1e-12?1/Math.sqrt(r):1;return i[0]=t[0]*n,i[1]=t[1]*n,i[2]=t[2]*n,i[3]=-(i[0]*e[0]+i[1]*e[1]+i[2]*e[2]),i}function gLe(e,t,i,r=OI()){const n=i[0]-t[0],o=i[1]-t[1],c=i[2]-t[2],h=e[0]-t[0],m=e[1]-t[1],b=e[2]-t[2],x=o*b-c*m,I=c*h-n*b,E=n*m-o*h,k=x*x+I*I+E*E,P=Math.abs(k-1)>1e-5&&k>1e-12?1/Math.sqrt(k):1;return r[0]=x*P,r[1]=I*P,r[2]=E*P,r[3]=-(r[0]*e[0]+r[1]*e[1]+r[2]*e[2]),r}function vLe(e,t,i,r,n){if(e.count<3)return!1;e.getVec(i,d3);let o=r,c=!1;for(;o<e.count-1&&!c;)e.getVec(o,Mv),o++,c=!r5(d3,Mv);if(!c)return!1;for(o=Math.max(o,n),c=!1;o<e.count&&!c;)e.getVec(o,rm),o++,fn(FI,d3,Mv),Ds(FI,FI),fn(NI,Mv,rm),Ds(NI,NI),c=!r5(d3,rm)&&!r5(Mv,rm)&&Math.abs(Ci(FI,NI))<bLe;return c?(gLe(d3,Mv,rm,t),!0):(i!==0||r!==1||n!==2)&&vLe(e,t,0,1,2)}const bLe=.99619469809,d3=it(),Mv=it(),rm=it(),FI=it(),NI=it();function oYe(e,t,i){return t!==e&&RI(e,t),e[3]=-Ci(kl(e),i),e}function aYe(e,t){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=-e[3],t}function lYe(e,t,i,r){return is(rm,t,e),pie(i,rm,r)}function wLe(e,t,i,r){return DI(e,t,fn(As.get(),i,t),SLe,r)}function cYe(e,t,i){return!!H(t)&&DI(e,t.origin,t.direction,MLe,i)}function uYe(e,t,i){return DI(e,t.origin,t.vector,Fu.NONE,i)}function hYe(e,t,i){return DI(e,t.origin,t.vector,Fu.CLAMP,i)}function _Le(e,t){return Iv(e,t)>=0}function pYe(e,t){const i=Ci(kl(e),t.ray.direction),r=-Iv(e,t.ray.origin);if(i>-1e-6&&i<1e-6)return r>0;const n=r/i;return i>0?n<t.c1&&(t.c1=n):n>t.c0&&(t.c0=n),t.c0<=t.c1}function dYe(e,t,i){const r=Yo(As.get(),kl(e),-e[3]),n=xLe(e,fn(As.get(),t,r),As.get());return Ko(i,n,r),i}function fYe(e,t,i,r){const n=kl(e),o=As.get(),c=As.get();mLe(n,o,c);const h=fn(As.get(),i,t),m=p3(o,h),b=p3(c,h),x=p3(n,h);return Nn(r,m,b,x)}function xLe(e,t,i){const r=Yo(As.get(),kl(e),Ci(kl(e),t));return fn(i,t,r),i}function Iv(e,t){return Ci(kl(e),t)+e[3]}function DI(e,t,i,r,n){const o=Ci(kl(e),i);if(o===0)return!1;let c=-(Ci(kl(e),t)+e[3])/o;return r&Fu.CLAMP&&(c=Vs(c,0,1)),!(!(r&Fu.INFINITE_MIN)&&c<0||!(r&Fu.INFINITE_MAX)&&c>1)&&(Ko(n,t,Yo(n,i,c)),!0)}function kl(e){return e}const f3=[0,0,1,0];var Fu;(function(e){e[e.NONE=0]="NONE",e[e.CLAMP=1]="CLAMP",e[e.INFINITE_MIN=4]="INFINITE_MIN",e[e.INFINITE_MAX=8]="INFINITE_MAX"})(Fu||(Fu={}));const SLe=Fu.INFINITE_MIN|Fu.INFINITE_MAX,MLe=Fu.INFINITE_MAX;function tO(e,t){return e[0]*t[1]-e[1]*t[0]}function ILe(e,t,i){const r=np(i,t)/_f(i);return X1(e,i,r)}function iO(e,t,i,r,n=i){return Jr($v,r,i),Jr(rO,t,n),ILe(jI,rO,$v),KP(e,n,jI)}function $Le(e,t,i,r){Jr($v,t,i);const n=r/J2($v);return Tc(e,i,$v,n)}function ELe(e,t){const i=e.start,r=e.end,n=t.start,o=t.end,c=Jr($v,r,i),h=Jr(CLe,o,n),m=tO(c,h);if(Math.abs(m)<=TLe)return[];const b=Jr(rO,i,n),x=tO(h,b)/m,I=tO(c,b)/m;if(x>=0){if(I>=0||t.type===Kr.LINE)return[Tc(jI,i,c,x)]}else if(e.type===Kr.LINE&&(I>=0||t.type===Kr.LINE))return[Tc(jI,i,c,x)];return[]}var Kr;(function(e){e[e.RAY=0]="RAY",e[e.LINE=1]="LINE"})(Kr||(Kr={}));const TLe=1e-6,$v=ui(),CLe=ui(),rO=ui(),jI=ui();class VI{constructor(t,i,r,n=0,o=y3.IMMEDIATE){this._helper=t,this._planeType=i,this._edge=r,this.distance=n,this._plane=OI(),this._offsetPlane=OI(),this._minDistance=-1/0,this._maxDistance=1/0,this._selectedArrow=1,o===y3.IMMEDIATE&&this._initialize()}get plane(){return this._plane}get requiresSplitEdgeLeft(){return!this._left.isOriginalDirection}get requiresSplitEdgeRight(){return!this._right.isOriginalDirection}get edgeDirection(){return this._edgeDirection}_initialize(){this._initializeNeighbors(),this._initializePlane(),this._initializeDistanceConstraints()}_initializeNeighbors(){var o,c,h,m;const t=this._toXYZ(this._edge.leftVertex.pos),i=this._toXYZ((c=(o=this._edge.leftVertex.leftEdge)==null?void 0:o.leftVertex)==null?void 0:c.pos),r=this._toXYZ(this._edge.rightVertex.pos),n=this._toXYZ((m=(h=this._edge.rightVertex.rightEdge)==null?void 0:h.rightVertex)==null?void 0:m.pos);this._edgeDirection=L6(it(),t,r),this._left=this._computeNeighbor(t,i,this._edgeDirection),this._right=this._computeNeighbor(r,n,this._edgeDirection)}_toXYZ(t){return H(t)?this._helper.toXYZ(t):null}_pointToXYZ(t){return this._toXYZ(this._helper.pointToVector(t))}_computeNeighbor(t,i,r){if(ce(i))return{start:t,end:i,direction:Mn(-r[1],r[0],0),isOriginalDirection:!0};const n=L6(it(),t,i),o=!this._passesBisectingAngleThreshold(n,r);return{start:t,end:i,direction:o?this._bisectVectorsPerpendicular(r,n):n,isOriginalDirection:!o}}_passesBisectingAngleThreshold(t,i){const r=Math.abs(nie(i,t));return r>=die&&r<=Math.PI-die}_bisectVectorsPerpendicular(t,i){const r=Ci(t,i)<0?t:A6(it(),t),n=Math.abs(Ci(r,i));if(!(n<fie||n>1-fie))return this._bisectDirection(r,i);const o=is(it(),r,[0,0,1]);return Ds(o,o)}_bisectDirection(t,i){const r=Ko(it(),t,i);return Ds(r,r)}_initializePlane(){const t=this._computeNormalDirection(this._left),i=this._computeNormalDirection(this._right);Ci(t,i)<0&&A6(i,i),pie(this._left.start,this._bisectDirection(t,i),this._plane)}_computeNormalDirection(t){const i=is(it(),t.direction,this._edgeDirection);Ds(i,i);const r=is(it(),this._edgeDirection,i);return this._planeType===nO.XY&&(r[2]=0),Ds(r,r)}_initializeDistanceConstraints(){H(this._left.end)&&!this.requiresSplitEdgeLeft&&this._updateDistanceConstraint(Iv(this._plane,this._left.end)),H(this._right.end)&&!this.requiresSplitEdgeRight&&this._updateDistanceConstraint(Iv(this._plane,this._right.end)),this._updateIntersectDistanceConstraint(this._plane)}_updateDistanceConstraint(t){t<=0&&(this._minDistance=Math.max(this._minDistance,t)),t>=0&&(this._maxDistance=Math.min(this._maxDistance,t))}_updateIntersectDistanceConstraint(t){const i=kl(t),r=this._edgeDirection,n=Ko(it(),this._left.start,this._left.direction),o=Ko(it(),this._right.start,this._right.direction),c=this._pointInBasis2D(ui(),i,r,this._left.start),h=this._pointInBasis2D(ui(),i,r,n),m=this._pointInBasis2D(ui(),i,r,this._right.start),b=this._pointInBasis2D(ui(),i,r,o),[x]=ELe({start:h,end:c,type:Kr.LINE},{start:b,end:m,type:Kr.LINE});if(!x)return;const I=Jr(ui(),c,h);iI(I,I);const E=Jr(ui(),x,h),k=np(I,E),P=Ko(it(),n,Yo(it(),this._left.direction,-k)),F=Iv(t,P);this._updateDistanceConstraint(F)}_pointInBasis2D(t,i,r,n){return t[0]=p3(i,n),t[1]=p3(r,n),t}_offset(t,i){Number.isFinite(this._minDistance)&&(i=Math.max(this._minDistance,i)),Number.isFinite(this._maxDistance)&&(i=Math.min(this._maxDistance,i)),RI(this._offsetPlane,this._plane),this._offsetPlane[3]-=i;const r=(o,c,h)=>H(c)&&wLe(this._offsetPlane,o,Ko(it(),o,c),h),n=it();(t===this._edge.leftVertex?r(this._left.start,this._left.direction,n):r(this._right.start,this._right.direction,n))&&this._helper.copy(this._helper.fromXYZ(n,void 0,this._helper.getM(t.pos)),t.pos)}selectArrowFromStartPoint(t){this._selectedArrow=_Le(this.plane,this._pointToXYZ(t))?1:-1}get selectedArrow(){return this._selectedArrow}signedDistanceToPoint(t){return Iv(this.plane,this._pointToXYZ(t))}apply(t){this._offset(t,this.distance)}undo(t){this._offset(t,0)}canAccumulate(t){return t instanceof VI&&this._edge.leftVertex.index===t._edge.leftVertex.index&&this._edge.rightVertex.index===t._edge.rightVertex.index&&this._edge.component===t._edge.component&&this._maybeEqualsVec3(this._left.direction,t._left.direction)&&this._maybeEqualsVec3(this._right.direction,t._right.direction)&&n5(kl(this._plane),kl(t._plane))}accumulate(t,i){const r=this._plane[3]-i._plane[3]+i.distance;this._offset(t,r)}accumulateParams(t){const i=t.distance-t._plane[3];this.distance=i+this._plane[3]}clone(){const t=new VI(this._helper,this._planeType,this._edge,this.distance,y3.DEFERRED);return RI(t._plane,this._plane),RI(t._offsetPlane,this._offsetPlane),t._maxDistance=this._maxDistance,t._minDistance=this._minDistance,t._left=this._cloneNeighbor(this._left),t._right=this._cloneNeighbor(this._right),t._edgeDirection=ko(it(),this._edgeDirection),t}_maybeEqualsVec3(t,i){return ce(t)&&ce(i)||H(t)&&H(i)&&n5(t,i)}_cloneNeighbor({start:t,end:i,direction:r,isOriginalDirection:n}){return{start:ko(it(),t),end:H(i)?ko(it(),i):null,direction:ko(it(),r),isOriginalDirection:n}}}const die=xg(15),fie=.001;var nO,y3;(function(e){e[e.XYZ=0]="XYZ",e[e.XY=1]="XY"})(nO||(nO={})),function(e){e[e.IMMEDIATE=0]="IMMEDIATE",e[e.DEFERRED=1]="DEFERRED"}(y3||(y3={}));class sO{constructor(t,i,r=Ru.CUMULATIVE){this.origin=t,this.angle=i,this._accumulationType=r}_rotate(t,i){hQ(t.pos,t.pos,this.origin,i)}apply(t){this._rotate(t,this.angle)}undo(t){this._rotate(t,-this.angle)}canAccumulate(t){return t instanceof sO&&sd(this.origin,t.origin)}accumulate(t,i){const r=i._accumulationType===Ru.REPLACE;this._rotate(t,r?i.angle-this.angle:i.angle)}accumulateParams(t){const i=t._accumulationType===Ru.REPLACE;this.angle=i?t.angle:this.angle+t.angle}}class oO{constructor(t,i,r,n,o=Ru.CUMULATIVE){this.origin=t,this.axis1=i,this.factor1=r,this.factor2=n,this._accumulationType=o,this.axis2=sp(i[1],-i[0])}_scale(t,i,r){QP(t.pos,t.pos,this.origin,this.axis1,i),QP(t.pos,t.pos,this.origin,this.axis2,r)}apply(t){this._scale(t,this.factor1,this.factor2)}undo(t){this._scale(t,1/this.factor1,1/this.factor2)}canAccumulate(t){return t instanceof oO&&sd(this.origin,t.origin)&&sd(this.axis1,t.axis1)}accumulate(t,i){i._accumulationType===Ru.REPLACE?this._scale(t,i.factor1/this.factor1,i.factor2/this.factor2):this._scale(t,i.factor1,i.factor2)}accumulateParams(t){const i=t._accumulationType===Ru.REPLACE;this.factor1=i?t.factor1:this.factor1*t.factor1,this.factor2=i?t.factor2:this.factor2*t.factor2}}class kLe{constructor(){this._operations=[],this._closed=!1}close(){this._closed=!0}apply(){for(const t of this._operations)t.apply()}undo(){for(let t=this._operations.length-1;t>=0;t--)this._operations[t].undo()}accumulate(t){if(this._closed)return!1;const i=this._operations.length?this._operations[this._operations.length-1]:null;return i&&i.accumulate(t)||(this._operations.push(t),t.apply()),!0}}class m3 extends Or{constructor(t){super(),this.data=t,this._undoStack=[],this._redoStack=[],this._listener=this.data.on("change",i=>{i.addedVertices&&this.emit("vertex-add",{type:"vertex-add",vertices:i.addedVertices,operation:i.operation}),i.removedVertices&&this.emit("vertex-remove",{type:"vertex-remove",vertices:i.removedVertices,operation:i.operation}),i.updatedVertices&&this.emit("vertex-update",{type:"vertex-update",vertices:i.updatedVertices,operation:i.operation})})}destroy(){this._listener.remove()}splitEdge(t,i){return this._apply(new jPe(this.data,t,i))}updateVertices(t,i,r=fp.ACCUMULATE_STEPS){return this._apply(new JL(this.data,t,i),r)}moveVertices(t,i,r,n,o=fp.ACCUMULATE_STEPS){return this.updateVertices(t,new KL(this.data.coordinateHelper,i,r,n),o)}scaleVertices(t,i,r,n,o,c=fp.ACCUMULATE_STEPS,h=Ru.CUMULATIVE){return this.updateVertices(t,new oO(i,r,n,o,h),c)}rotateVertices(t,i,r,n=fp.ACCUMULATE_STEPS,o=Ru.CUMULATIVE){return this.updateVertices(t,new sO(i,r,o),n)}removeVertices(t){return this._apply(new DPe(this.data,t,this._minNumVerticesPerType))}appendVertex(t){return this.data.components.length===0?null:this._apply(new NPe(this.data,this.data.components[0],t))}setVertexPosition(t,i){return this._apply(new ZL(this.data,t,i))}offsetEdge(t,i,r,n=fp.ACCUMULATE_STEPS){return this.updateVertices([i.leftVertex,i.rightVertex],new VI(this.data.coordinateHelper,t,i,r),n)}closeComponent(t){return this.data.components.includes(t)?this._apply(new VPe(this.data,t)):null}canRemoveVertex(){return this.data.components[0].vertices.length>this._minNumVerticesPerType}createUndoGroup(){const t=new kLe;return this._apply(t),{remove:()=>t.close()}}undo(){if(this._undoStack.length>0){const t=this._undoStack.pop();return t.undo(),this._redoStack.push(t),t}return null}redo(){if(this._redoStack.length>0){const t=this._redoStack.pop();return t.apply(),this._undoStack.push(t),t}return null}get canUndo(){return this._undoStack.length>0}get canRedo(){return this._redoStack.length>0}get lastOperation(){return this._undoStack.length>0?this._undoStack[this._undoStack.length-1]:null}get _minNumVerticesPerType(){switch(this.data.type){case"point":return 1;case"polyline":return 2;case"polygon":return 3;default:return 0}}_apply(t,i=fp.ACCUMULATE_STEPS){return i!==fp.NEW_STEP&&!ce(this.lastOperation)&&this.lastOperation.accumulate(t)||(t.apply(),this._undoStack.push(t),this._redoStack=[]),t}static fromGeometry(t,i){return new m3(_v.fromGeometry(t,i))}}class zI{constructor(t){this.vertexHandle=null,this.excludeFeature=null,this.visualizer=null,this.selfSnappingZ=null,this.editGeometryOperations=t.editGeometryOperations,this.elevationInfo=t.elevationInfo,this.pointer=t.pointer,this.vertexHandle=t.vertexHandle,this.excludeFeature=t.excludeFeature,this.visualizer=t.visualizer,this.selfSnappingZ=t.selfSnappingZ}get coordinateHelper(){return this.editGeometryOperations.data.coordinateHelper}}let Af=class extends Ye{constructor(e){super(e),this.constrainResult=t=>t,this._snapPoints=null,this._abortController=null,this._stagedPoint=null,this._snap=hw(async(t,i,r,n)=>{const o=await this._frameTask.schedule(()=>i.snap(Ce(K({},t),{context:r,signal:n})),n);o.valid&&await this._frameTask.schedule(()=>{this.stagedPoint=o.apply(),t!==this._snapPoints&&H(this._snapPoints)&&(this.stagedPoint=i.update(Ce(K({},this._snapPoints),{context:r})))},n)})}get stagedPoint(){return this._stagedPoint}set stagedPoint(e){this._stagedPoint=this.constrainResult(e)}initialize(){var t,i;const e=this.view.type==="3d"?(i=(t=this.view)==null?void 0:t.resourceController)==null?void 0:i.scheduler:null;this._frameTask=H(e)?e.registerTask(vi.SNAPPING):q2}destroy(){this._abortController=Kl(this._abortController),this._frameTask=mr(this._frameTask)}async snap(e,t,i){const{point:r,scenePoint:n}=e;return this.stagedPoint=t.update({point:r,scenePoint:n,context:i}),this._snapPoints=e,ce(this._abortController)&&(this._abortController=new AbortController),this._snap(e,t,i,this._abortController.signal)}abort(){this._abortController=Kl(this._abortController)}};g([w({constructOnly:!0})],Af.prototype,"view",void 0),g([w()],Af.prototype,"stagedPoint",null),g([w()],Af.prototype,"constrainResult",void 0),g([w()],Af.prototype,"_stagedPoint",void 0),Af=g([te("esri.views.interactive.snapping.SnappingOperation")],Af);var aO;let Do=aO=class extends Or.EventedAccessor{constructor(e){var t;super(e),this._hasZ=null,this._cursorScreenPoint=null,this._activePointerId=null,this._stagedVertexUnsnapped=null,this._lastVertexUnsnapped=null,this._handles=new Ti,this._viewHandlesKey="view-handles",this._undoRedoHandlesKey="undo-redo-handles",this._drawToolHandlesKey="draw-tool",this._nativeEventHistory={undoStack:[],redoStack:[]},this.interactiveUndoDisabled=!1,this.history=[],this.redoHistory=[],this.snapToScene=!1,this.view=null,this.elevationInfo=null,this.defaultZ=0,this._coordinateHelper=WL(e.hasZ,!1,e.view.spatialReference),this._snappingManager=e.snappingManager,this._editGeometryOperations=new m3(new _v((t=e.editGeometryType)!=null?t:"polygon",this._coordinateHelper)),this._snappingGraphicsLayer=new RL({id:aO.SNAPPING_GRAPHICS_LAYER_ID,listMode:"hide",internal:!0}),this._snappingContext=new zI({editGeometryOperations:this._editGeometryOperations,elevationInfo:{mode:"on-the-ground",offset:0},pointer:"mouse",visualizer:new MPe(this._snappingGraphicsLayer)}),this._activeComponent=new wv(e.view.spatialReference,ma.Local),this._editGeometryOperations.data.components.push(this._activeComponent)}normalizeCtorArgs(e){const t=K({},e);return delete t.editGeometryType,t}initialize(){this._snappingOperation=new Af({view:this.view}),this.view.type==="2d"&&this.view.map.layers.add(this._snappingGraphicsLayer)}destroy(){this._handles.destroy(),this.view.map.layers.remove(this._snappingGraphicsLayer),this._snappingGraphicsLayer.destroy(),H(this._snappingManager)&&this._snappingManager.doneSnapping(),this._snappingOperation=li(this._snappingOperation),this._editGeometryOperations.destroy()}get _committedVertices(){return this._editGeometryOperations.data.components[0].vertices.map(e=>e.pos)}get vertices(){return H(this._stagedVertex)?[...this._committedVertices,this._coordinateHelper.pointToArray(this._stagedVertex)]:this._committedVertices}get hasZ(){return H(this._hasZ)?this._hasZ:this.view.type==="3d"}set hasZ(e){this._hasZ=e,this.notifyChange("hasZ")}get _stagedVertex(){return this._snappingOperation.stagedPoint}set _stagedVertex(e){this._snappingOperation.stagedPoint=_e(e)}canUndo(){return this._editGeometryOperations.canUndo}canRedo(){return this._editGeometryOperations.canRedo}undo(){this.canUndo&&this._editGeometryOperations.undo()}redo(){this.canRedo&&this._editGeometryOperations.redo()}getCoordsFromScreenPoint(e){const t=this.screenToMap(e);return ce(t)?null:t.hasZ?[t.x,t.y,t.z]:[t.x,t.y]}getCoordsAndPointFromScreenPoint(e){const t=this.screenToMap(e);return ce(t)?null:t.hasZ?{vertex:[t.x,t.y,t.z],mapPoint:t}:{vertex:[t.x,t.y],mapPoint:t}}screenToMap(e){let t=null;if(this.view.type==="3d")if(this.hasZ){const i=ws(this.elevationInfo,ALe);t=this.view.sceneIntersectionHelper.intersectElevationFromScreen(Uw(e.x,e.y),i,this._getGeometryZValue())}else{const i=ws(this.elevationInfo,PLe);t=this.view.sceneIntersectionHelper.intersectElevationFromScreen(Uw(e.x,e.y),i,0),H(t)&&(t.z=void 0)}else t=this.view.toMap(e),H(t)&&(t.z=this.hasZ?this._getGeometryZValue():void 0);return t}_pushCursorVertex(e,t){const i=$I(e[0],e[1],null,this.view.spatialReference);this._stagedVertexUnsnapped=i;const r=this._snappingManager;if(ce(r))return this._stagedVertex=i,void t();dh(this._snappingOperation.snap({point:i},r,this._snappingContext)).then(()=>{t()})}_popCursorVertex(){this._stagedVertexUnsnapped=null,this._stagedVertex=null}_getGeometryZValue(){return this.defaultZ}_abortSnapping(){this._snappingOperation.abort()}_isDuplicateOfLastVertex(e){const t=this._editGeometryOperations.data.components[0].getLastVertex();if(H(t)&&e[0]===t[0]&&e[1]===t[1])return!0;const{x:i,y:r}=this._coordinateHelper.vectorToDehydratedPoint(e);return!(!H(this._lastVertexUnsnapped)||i!==this._lastVertexUnsnapped.x||r!==this._lastVertexUnsnapped.y)}_shouldHandlePointerEvent(e){return this._isPrimaryPointerAction(e)&&(ce(this._activePointerId)||this._activePointerId===e.pointerId)}_vertexAddHandler(e){const t=H(this._stagedVertex)?this._coordinateHelper.pointToArray(this._stagedVertex):this.getCoordsFromScreenPoint(this._cursorScreenPoint);H(t)&&this._addVertex(t,e.native)}_drawCompleteHandler(e){this._completeDrawing(e.native)}_isPrimaryPointerAction(e){return e.pointerType!=="mouse"||e.button===0}};Do.SNAPPING_GRAPHICS_LAYER_ID="DrawAction-snapping-graphics-layer",g([w({readOnly:!0})],Do.prototype,"vertices",null),g([w({type:Boolean,nonNullable:!0})],Do.prototype,"interactiveUndoDisabled",void 0),g([w({readOnly:!0})],Do.prototype,"history",void 0),g([w({readOnly:!0})],Do.prototype,"redoHistory",void 0),g([w()],Do.prototype,"snapToScene",void 0),g([w()],Do.prototype,"view",void 0),g([w()],Do.prototype,"elevationInfo",void 0),g([w({nonNullable:!0})],Do.prototype,"defaultZ",void 0),g([w()],Do.prototype,"hasZ",null),g([w()],Do.prototype,"_snappingOperation",void 0),g([w()],Do.prototype,"_stagedVertex",null),Do=aO=g([te("esri.views.draw.DrawAction")],Do);const ALe={mode:"absolute-height",offset:0},PLe={mode:"on-the-ground",offset:0},g3=Do;class Nu{constructor(t,i,r,n){this.view=t,this.native=i,this.vertexIndex=r,this.vertices=n,this.defaultPrevented=!1,this.type="vertex-add"}preventDefault(){this.defaultPrevented=!0}}class lO{constructor(t,i,r,n){this.view=t,this.native=i,this.vertexIndex=r,this.vertices=n,this.defaultPrevented=!1,this.type="vertex-remove"}preventDefault(){this.defaultPrevented=!0}}class gp{constructor(t,i,r,n,o=null){this.view=t,this.native=i,this.vertexIndex=r,this.vertices=n,this.mapPoint=o,this.coordinates=null,this.defaultPrevented=!1,this.type="cursor-update",this.coordinates=n.length===1?n[0]:null}preventDefault(){this.defaultPrevented=!0}}class vp{constructor(t,i){this.native=t,this.vertices=i,this.coordinates=null,this.defaultPrevented=!1,this.type="draw-complete",this.coordinates=i.length===1?i[0]:null}preventDefault(){this.defaultPrevented=!0}}const zt={redo:"r",undo:"z",center:"Alt",constraint:"Shift",snappingToggle:"Control",cancel:"Escape",delete:["Backspace","Delete"],complete:"Enter",vertexAdd:"f",pan:" "};let cO=class extends g3{constructor(e){super(e),this._popVertexOnPointerMove=!1,this._addVertexOnPointerUp=!1}initialize(){this._addViewHandles(),this._addUndoRedoHandles()}destroy(){this._removeViewHandles(),this._removeUndoRedoHandles(),this.emit("destroy")}undo(){super.undo(),this.notifyChange("vertices")}redo(){super.redo(),this.notifyChange("vertices")}complete(){this._completeDrawing()}_addViewHandles(){this._removeViewHandles(),this._handles.add([this.view.on("click",e=>{e.stopPropagation()},ft.TOOL),this.view.on("pointer-down",e=>{this._shouldHandlePointerEvent(e)&&(this._abortSnapping(),this._activePointerId=e.pointerId,this._addVertexOnPointerUp=!0,this._cursorScreenPoint=pr(e),e.pointerType==="touch"&&this._updateCursor(e.native))},ft.TOOL),this.view.on("pointer-move",e=>{this._popVertexOnPointerMove&&(this.undo(),this._popVertexOnPointerMove=!1),this._abortSnapping(),this._cursorScreenPoint=pr(e),e.pointerType!=="touch"&&this._updateCursor(e.native)},ft.TOOL),this.view.on("pointer-drag",e=>{this._shouldHandlePointerEvent(e)&&(this._abortSnapping(),this._addVertexOnPointerUp=!1)},ft.TOOL),this.view.on("pointer-up",e=>{if(this._shouldHandlePointerEvent(e))if(this._abortSnapping(),this._activePointerId=null,this._addVertexOnPointerUp)this._vertexAddHandler(e);else{const t=e.pointerType==="touch";this._updateCursor(e.native,t)}},ft.TOOL),this.view.on("drag",["Shift"],e=>{e.stopPropagation()},ft.TOOL),this.view.on("double-click",e=>{e.stopPropagation(),this._drawCompleteHandler(e)},ft.TOOL),this.view.on("double-click",["Control"],e=>{e.stopPropagation(),this._drawCompleteHandler(e)},ft.TOOL),this.view.on("key-down",e=>{const{key:t,repeat:i}=e;t===zt.vertexAdd&&!i&&this._cursorScreenPoint?(e.stopPropagation(),this._abortSnapping(),this._vertexAddHandler(e)):t!==zt.complete||i?t!==zt.undo||this.interactiveUndoDisabled||i?t!==zt.redo||this.interactiveUndoDisabled||i?t!==zt.pan||i||e.stopPropagation():(e.stopPropagation(),this.redo()):(e.stopPropagation(),this.undo()):(e.stopPropagation(),this._drawCompleteHandler(e))},ft.TOOL),this.view.on("key-up",e=>{e.key===zt.pan&&e.stopPropagation()},ft.TOOL)],this._viewHandlesKey)}_addUndoRedoHandles(){this._removeUndoRedoHandles(),this._handles.add([this._editGeometryOperations.on("vertex-remove",e=>{if(this.notifyChange("vertices"),e.operation==="undo"){const t=this._nativeEventHistory.undoStack.pop();this._nativeEventHistory.redoStack.push(t);const i=[...this._committedVertices];H(this._stagedVertex)&&i.push(this._coordinateHelper.pointToArray(this._stagedVertex)),this.emit("undo",new lO(this.view,t,e.vertices[0].index,i))}}),this._editGeometryOperations.on("vertex-add",e=>{if(this.notifyChange("vertices"),e.operation==="apply"){const t=this._nativeEventHistory.undoStack[this._nativeEventHistory.undoStack.length],i=this._committedVertices.length-1,r=new Nu(this.view,t,i,this.vertices);this.emit("vertex-add",r),r.defaultPrevented&&(this._popVertexOnPointerMove=!0)}else if(e.operation==="redo"){const t=this._nativeEventHistory.redoStack.pop();this._nativeEventHistory.undoStack.push(t);const i=[...this._committedVertices];H(this._stagedVertex)&&i.push(this._coordinateHelper.pointToArray(this._stagedVertex)),this.emit("redo",new Nu(this.view,t,e.vertices[0].index,i))}})],this._undoRedoHandlesKey)}_removeViewHandles(){this._handles.remove(this._viewHandlesKey)}_removeUndoRedoHandles(){this._handles.remove(this._undoRedoHandlesKey)}_addVertex(e,t){const i=this._coordinateHelper.arrayToVector(e);if(this._isDuplicateOfLastVertex(i))return;this._lastVertexUnsnapped=this._stagedVertexUnsnapped,this._popCursorVertex(),this._editGeometryOperations.appendVertex(i);const r=t||new Event("placeholder");this._nativeEventHistory.undoStack.push(r)}_updateCursor(e,t=!1){if(this._popCursorVertex(),!this._cursorScreenPoint)return;const i=this.getCoordsAndPointFromScreenPoint(this._cursorScreenPoint);H(i)&&!t&&this._pushCursorVertex(i.vertex,()=>this.emit("cursor-update",new gp(this.view,e,this._activeComponent.vertices.length,this.vertices,H(this._stagedVertex)?new pt(this._stagedVertex):null)))}_completeDrawing(e){if(this._activePointerId=null,this._popCursorVertex(),this._abortSnapping(),H(this._snappingManager)&&this._snappingManager.doneSnapping(),this.vertices.length<1)return;const t=new vp(e,this.vertices);this.emit("draw-complete",t),t.defaultPrevented||this._removeViewHandles()}};cO=g([te("esri.views.draw.MultipointDrawAction")],cO);const yie=["freehand","hybrid","click"],GI="click";class LLe{constructor({grabbableForEvent:t}){this.events=new Or,this.interactive=!0,this.selectable=!1,this.cursor=null,this.grabbable=!0,this.grabbableForEvent=t}intersectionDistance(t,i){return 0}attach(){}detach(){}}function OLe(e){return"declaredClass"in e}function mie(e){return"declaredClass"in e}function RLe(e){return"declaredClass"in e}function yYe(e,t){if(!e)return null;if(RLe(e))return e;const i=new Gr({layer:t,sourceLayer:t});return i.visible=e.visible,i.symbol=_e(e.symbol),i.attributes=_e(e.attributes),i.geometry=FLe(e.geometry),i}function FLe(e){return ce(e)?null:OLe(e)?e:xs(NLe(e))}function NLe(e){const{wkid:t,wkt:i,latestWkid:r}=e.spatialReference,n={wkid:t,wkt:i,latestWkid:r};switch(e.type){case"point":{const{x:o,y:c,z:h,m}=e;return{x:o,y:c,z:h,m,spatialReference:n}}case"polygon":{const{rings:o,hasZ:c,hasM:h}=e;return{rings:gie(o),hasZ:c,hasM:h,spatialReference:n}}case"polyline":{const{paths:o,hasZ:c,hasM:h}=e;return{paths:gie(o),hasZ:c,hasM:h,spatialReference:n}}case"extent":{const{xmin:o,xmax:c,ymin:h,ymax:m,zmin:b,zmax:x,mmin:I,mmax:E,hasZ:k,hasM:P}=e;return{xmin:o,xmax:c,ymin:h,ymax:m,zmin:b,zmax:x,mmin:I,mmax:E,hasZ:k,hasM:P,spatialReference:n}}case"multipoint":{const{points:o,hasZ:c,hasM:h}=e;return{points:bie(o)?vie(o):o,hasZ:c,hasM:h,spatialReference:n}}default:return}}function gie(e){return DLe(e)?e.map(t=>vie(t)):e}function vie(e){return e.map(t=>j0e(t))}function DLe(e){for(const t of e)if(t.length!==0)return bie(t);return!1}function bie(e){return e.length&&(Cj(e[0])||kj(e[0]))}function uO(e,t){if(!e)return null;let i;if(mie(e)){if(t==null)return e.clone();if(mie(t))return t.copy(e)}return t!=null?(i=t,i.x=e.x,i.y=e.y,i.spatialReference=e.spatialReference,e.hasZ?(i.z=e.z,i.hasZ=e.hasZ):(i.z=null,i.hasZ=!1),e.hasM?(i.m=e.m,i.hasM=!0):(i.m=null,i.hasM=!1)):(i=$I(e.x,e.y,e.z,e.spatialReference),e.hasM&&(i.m=e.m,i.hasM=!0)),i}function jLe(e){const{wkid:t,wkt:i,latestWkid:r}=e,n={wkid:t,wkt:i,latestWkid:r};return Mt.fromJSON(n)}function Ev(e,t,i,r){if(r==null||e.hasZ||(r=void 0),e.type==="point")return e.x+=t,e.y+=i,e.hasZ&&r!=null&&(e.z+=r),e;if(e.type==="multipoint"){const c=e.points;for(let h=0;h<c.length;h++)c[h]=wie(c[h],t,i,r);return e}if(e.type==="extent")return e.xmin+=t,e.xmax+=t,e.ymin+=i,e.ymax+=i,r!=null&&(e.zmin+=r,e.zmax+=r),e;const n=ug(e),o=e.type==="polyline"?e.paths:e.rings;for(let c=0;c<n.length;c++){const h=n[c];for(let m=0;m<h.length;m++)h[m]=wie(h[m],t,i,r)}return"paths"in e?e.paths=o:e.rings=o,e}function mYe(e,t,i,r,n){const o=e.clone(),c=r.resolution;if(o.type==="point"){if(n)Ev(o,t*c,-i*c);else{const h=r.state.transform,m=r.state.inverseTransform,b=h[0]*o.x+h[2]*o.y+h[4],x=h[1]*o.x+h[3]*o.y+h[5];o.x=m[0]*(b+t)+m[2]*(x+i)+m[4],o.y=m[1]*(b+t)+m[3]*(x+i)+m[5]}return o}if(o.type==="multipoint"){if(n)Ev(o,t*c,-i*c);else{const h=o.points,m=r.state.transform,b=r.state.inverseTransform;for(let x=0;x<h.length;x++){const I=h[x],E=m[0]*I[0]+m[2]*I[1]+m[4],k=m[1]*I[0]+m[3]*I[1]+m[5],P=b[0]*(E+t)+b[2]*(k+i)+b[4],F=b[1]*(E+t)+b[3]*(k+i)+b[5];h[x]=v3(I,P,F,void 0)}}return o}if(o.type==="extent"){if(n)Ev(o,t*c,-i*c);else{const h=r.state.transform,m=r.state.inverseTransform,b=h[0]*o.xmin+h[2]*o.ymin+h[4],x=h[1]*o.xmin+h[3]*o.ymin+h[5],I=h[0]*o.xmax+h[2]*o.ymax+h[4],E=h[1]*o.xmax+h[3]*o.ymax+h[5];o.xmin=m[0]*(b+t)+m[2]*(x+i)+m[4],o.ymin=m[1]*(b+t)+m[3]*(x+i)+m[5],o.xmax=m[0]*(I+t)+m[2]*(E+i)+m[4],o.ymax=m[1]*(I+t)+m[3]*(E+i)+m[5]}return o}if(n)Ev(o,t*c,-i*c);else{const h=ug(o),m=o.type==="polyline"?o.paths:o.rings,b=r.state.transform,x=r.state.inverseTransform;for(let I=0;I<h.length;I++){const E=h[I];for(let k=0;k<E.length;k++){const P=E[k],F=b[0]*P[0]+b[2]*P[1]+b[4],N=b[1]*P[0]+b[3]*P[1]+b[5],B=x[0]*(F+t)+x[2]*(N+i)+x[4],z=x[1]*(F+t)+x[3]*(N+i)+x[5];E[k]=v3(P,B,z,void 0)}}"paths"in o?o.paths=m:o.rings=m}return o}function gYe(e,t,i,r){if(e.type==="point"){const{x:P,y:F}=e,N=r?r[0]:P,B=r?r[1]:F,z=e.clone(),q=(P-N)*t+N,J=(F-B)*i+B;return z.x=q,z.y=J,z}if(e.type==="multipoint"){const P=ug(e),F=ro(),[N,B,z,q]=yd(F,[P]),J=r?r[0]:(N+z)/2,X=r?r[1]:(q+B)/2,Y=e.clone(),ae=Y.points;for(let he=0;he<ae.length;he++){const fe=ae[he],[ye,xe]=fe,Se=(ye-J)*t+J,Ae=(xe-X)*i+X;ae[he]=v3(fe,Se,Ae,void 0)}return Y}if(e.type==="extent"){const{xmin:P,xmax:F,ymin:N,ymax:B}=e,z=r?r[0]:(P+F)/2,q=r?r[1]:(B+N)/2,J=e.clone();if(J.xmin=(P-z)*t+z,J.ymax=(B-q)*i+q,J.xmax=(F-z)*t+z,J.ymin=(N-q)*i+q,J.xmin>J.xmax){const X=J.xmin,Y=J.xmax;J.xmin=Y,J.xmax=X}if(J.ymin>J.ymax){const X=J.ymin,Y=J.ymax;J.ymin=Y,J.ymax=X}return J}const n=ug(e),o=ro(),[c,h,m,b]=yd(o,n),x=r?r[0]:(c+m)/2,I=r?r[1]:(b+h)/2,E=e.clone(),k=E.type==="polyline"?E.paths:E.rings;for(let P=0;P<n.length;P++){const F=n[P];for(let N=0;N<F.length;N++){const B=F[N],[z,q]=B,J=(z-x)*t+x,X=(q-I)*i+I;k[P][N]=v3(B,J,X,void 0)}}return"paths"in E?E.paths=k:E.rings=k,E}function vYe(e,t,i,r,n,o){const c=Math.sqrt((i-e)*(i-e)+(r-t)*(r-t));return Math.sqrt((n-e)*(n-e)+(o-t)*(o-t))/c}function bYe(e,t,i){const r=Math.atan2(t.y-i.y,t.x-i.x)-Math.atan2(e.y-i.y,e.x-i.x),n=Math.atan2(Math.sin(r),Math.cos(r));return N6(n)}function wie(e,t,i,r){return v3(e,e[0]+t,e[1]+i,e[2]!=null&&r!=null?e[2]+r:void 0)}function v3(e,t,i,r){const n=[t,i];return e.length>2&&n.push(r!=null?r:e[2]),e.length>3&&n.push(e[3]),n}function VLe(e,t){let i=null,r=null;return n=>{if(n.action==="cancel")return void(H(r)&&(r.execute({action:"cancel"}),i=null,r=null));const o={action:n.action,screenStart:n.start,screenEnd:n.screenPoint};n.action==="start"&&ce(i)&&(i=new Tv,r=new Tv,t(e,i,r,n.pointerType,o)),H(i)&&i.execute(o),n.action==="end"&&H(i)&&(i=null,r=null)}}function hO(e,t){return e.events.on("drag",VLe(e,t))}function wYe(e,t){const i=[e.x,e.y,e.z],r=t,n=[Math.cos(r),Math.sin(r)],o=Math.sqrt(n[0]*n[0]+n[1]*n[1]);if(o===0)return null;n[0]/=o,n[1]/=o;const c=h=>{const m=(h.x-i[0])*n[0]+(h.y-i[1])*n[1];h.x=i[0]+m*n[0],h.y=i[1]+m*n[1]};return h=>(c(h.mapStart),c(h.mapEnd),Ce(K({},h),{axis:n}))}function zLe(e,t){let i=null;return r=>{if(r.action==="start"&&(i=GLe(e,r.mapStart.spatialReference,t)),ce(i))return null;const n=r.mapEnd.x-r.mapStart.x,o=r.mapEnd.y-r.mapStart.y,c=r.mapEnd.z-r.mapStart.z;return i.move(n,o,c),Ce(K({},r),{translationX:n,translationY:o,translationZ:c})}}function _ie(e,t){return ce(e)?null:e.spatialReference.equals(t)?e.clone():Da(e,t)}function GLe(e,t,i){const r=e.geometry,n=jLe(t);if(ce(r))return null;if(r.type==="mesh")return BLe(e,r,n,i);const o=_ie(r,n),c=r.spatialReference;return ce(o)?null:{move:(h,m,b)=>{const x=Ev(o.clone(),h,m,b);x.spatialReference.equals(c)?e.geometry=x:e.geometry=Da(x,c)}}}function BLe(e,t,i,r){if(H(t.transform))return ULe(e,t,t.transform,i);if(!t.spatialReference.equals(i))return null;let n=0,o=0,c=0;return{move:(h,m,b)=>{const x=h-n,I=m-o,E=b-c;if(x||I||E){const k=new pt(t.origin.x+x,t.origin.y+I,t.origin.z+E,t.origin.spatialReference);t.centerAt(k,{geographic:r===ma.Global}),e.notifyGeometryChanged(),n=h,o=m,c=b}}}}function ULe(e,t,i,r){const n=_ie(i.getOriginPoint(t.spatialReference),r),o=t.spatialReference;return ce(n)?null:{move:(c,h,m)=>{const b=Ev(n.clone(),c,h,m);if(b.spatialReference.equals(o))i.origin=Mn(b.x,b.y,b.z);else{const x=Da(b,o);H(x)&&(i.origin=Mn(x.x,x.y,x.z))}e.notifyMeshTransformChanged(),e.notifyGeometryChanged()}}}function _Ye(e,t){const i=e.map(r=>Ht(zLe(r,t))).filter(r=>H(r));return r=>{const n=r.mapEnd.x-r.mapStart.x,o=r.mapEnd.y-r.mapStart.y,c=r.mapEnd.z-r.mapStart.z;return i.forEach(h=>h(r)),Ce(K({},r),{translationX:n,translationY:o,translationZ:c})}}function qLe(e,t){const i=new Map;for(const r of t)i.set(r,_e(e[r]));return r=>(i.forEach((n,o)=>{e[o]=n}),r)}function HLe(e){return H(e.geometry)&&e.geometry.type==="mesh"?WLe(e,e.geometry):qLe(e,["geometry"])}function WLe(e,t){const i=H(t.transform)?t.transform.clone():null,r=t.vertexAttributes.clonePositional();return n=>(t.transform=i,t.vertexAttributes=r,e.notifyGeometryChanged(),n)}function xYe(e){const t=e.map(i=>Ht(HLe(i))).filter(i=>H(i));return i=>(t.forEach(r=>r(i)),i)}function SYe(){let e=0,t=0,i=0;return r=>{r.action==="start"&&(e=r.mapStart.x,t=r.mapStart.y,i=r.mapStart.z);const n=r.mapEnd.x-e,o=r.mapEnd.y-t,c=r.mapEnd.z-i;return e=r.mapEnd.x,t=r.mapEnd.y,i=r.mapEnd.z,Ce(K({},r),{mapDeltaX:n,mapDeltaY:o,mapDeltaZ:c,mapDeltaSpatialReference:r.mapStart.spatialReference})}}function MYe(){let e=0,t=0;return i=>{i.action==="start"&&(e=i.screenStart.x,t=i.screenStart.y);const r=i.screenEnd.x-e,n=i.screenEnd.y-t;return e=i.screenEnd.x,t=i.screenEnd.y,Ce(K({},i),{screenDeltaX:r,screenDeltaY:n})}}function IYe(e,t){let i=null,r=0,n=0;return o=>{if(o.action==="start"&&(i=e.toScreen(t),i.x<0||i.x>e.width||i.y<0||i.y>e.height?i=null:(r=o.screenStart.x-i.x,n=o.screenStart.y-i.y)),i==null)return null;const c=Vs(o.screenEnd.x-r,0,e.width),h=Vs(o.screenEnd.y-n,0,e.height),m=yn(c,h);return o.screenStart=i,o.screenEnd=m,o}}class Tv{constructor(){this.execute=()=>{}}next(t,i=new Tv){return H(t)&&(this.execute=r=>{const n=t(r);H(n)&&i.execute(n)}),i}}function JLe(e,t,i=[]){if(e.type==="2d")return n=>n;let r=null;return n=>{n.action==="start"&&(r=e.toMap(n.screenStart,{exclude:i}),H(r)&&(r.z=BL(r,e,t)));const o=e.toMap(n.screenEnd,{exclude:i});H(o)&&(o.z=BL(o,e,t));const c=H(r)&&H(o)?{sceneStart:r,sceneEnd:o}:null;return Ce(K({},n),{scenePoints:c})}}let BI=class extends Ye{constructor(e){super(e),this.enabled=!1}};g([w({type:Boolean,nonNullable:!0})],BI.prototype,"enabled",void 0),BI=g([te("esri.views.interactive.sketch.SketchLabelOptions")],BI);const UI=BI;let b3=class extends Ye{constructor(e){super(e),this.mode="absolute-height"}toJSON(){return{mode:this.mode}}};g([w({type:String,nonNullable:!0})],b3.prototype,"mode",void 0),b3=g([te("esri.widgets.Sketch.SketchTooltipOptions.ElevationOptions")],b3);let Qa=class extends Ye{constructor(){super(...arguments),this.distance=!0,this.elevation=!0,this.size=!0,this.scale=!0,this.rotation=!0,this.orientation=!0,this.totalLength=!0,this.area=!0,this.radius=!0}toJSON(){return{distance:this.distance,size:this.size,scale:this.scale,rotation:this.rotation,orientation:this.orientation,totalLength:this.totalLength,area:this.area,radius:this.radius}}};g([w({type:Boolean,nonNullable:!0})],Qa.prototype,"distance",void 0),g([w({type:Boolean,nonNullable:!0})],Qa.prototype,"elevation",void 0),g([w({type:Boolean,nonNullable:!0})],Qa.prototype,"size",void 0),g([w({type:Boolean,nonNullable:!0})],Qa.prototype,"scale",void 0),g([w({type:Boolean,nonNullable:!0})],Qa.prototype,"rotation",void 0),g([w({type:Boolean,nonNullable:!0})],Qa.prototype,"orientation",void 0),g([w({type:Boolean,nonNullable:!0})],Qa.prototype,"totalLength",void 0),g([w({type:Boolean,nonNullable:!0})],Qa.prototype,"area",void 0),g([w({type:Boolean,nonNullable:!0})],Qa.prototype,"radius",void 0),Qa=g([te("esri.widgets.Sketch.SketchTooltipOptions.VisibleElements")],Qa);let nm=class extends Ye{constructor(e){super(e),this.enabled=!1,this.elevation=new b3,this.visibleElements=new Qa,this.visualVariables=null}toJSON(){return{enabled:this.enabled,elevation:this.elevation,visibleElements:this.visibleElements}}};g([w({type:Boolean,nonNullable:!0})],nm.prototype,"enabled",void 0),g([w({type:b3,nonNullable:!0})],nm.prototype,"elevation",void 0),g([w({type:Qa,nonNullable:!0})],nm.prototype,"visibleElements",void 0),g([w()],nm.prototype,"visualVariables",void 0),nm=g([te("esri.widgets.Sketch.SketchTooltipOptions")],nm);const qI=nm;class ZLe{constructor(){this.next=new Tv}createSnapDragEventPipelineStep({predicate:t=()=>!0,cancel:i,snappingManager:r,snappingContext:n,updatingHandles:o,useZ:c=!0}){if(ce(r))return P=>P;let h=null,m=null;const b=()=>{h=Kl(h),r.doneSnapping(),H(m)&&m.frameTask.remove(),m=null};i.next(P=>(b(),P)),this.next=new Tv;const x=this._createSnapFunction(r,c);let I=null,E=null,k=null;return P=>{if(!t(P))return P;if(P.action==="start"){const F=this._createFrameTask(r.view);if(m=this._createSnappingInfo(n,P,F),m.context.selfSnappingZ=null,!c&&H(P.info)){const N=this._extractSelfSnappingZ(n.coordinateHelper,P.info.handle.component);H(N)&&(m.context.selfSnappingZ={value:N,elevationInfo:n.elevationInfo})}}if(H(m)){const{context:F,originalScenePos:N,originalPos:B}=m,{mapEnd:z,mapStart:q,action:J,scenePoints:X}=P,Y=this._updatePosition(B,this._computeMapDelta(z,q)),ae=this._computeMapDelta(q,B),he=Ce(K({},P),{action:"update"}),fe=m.context,ye=this._updateScenePosition(N,X),xe=r.update({point:Y,scenePoint:ye,context:F});if(k=xe,this._applySnappedUpdate(z,xe,ae,c),I=Y,E=ye,J!=="end"){const{frameTask:Se}=m;ce(h)&&(h=new AbortController),o.addPromise(dh(x({frameTask:Se,event:he,context:fe,point:Y,scenePoint:ye,delta:ae,lastPos:I,lastScenePos:E,lastUpdate:k},h.signal)))}}return P.action==="end"&&b(),P}}_createSnapFunction(t,i){return hw(async({frameTask:r,point:n,scenePoint:o,context:c,event:h,delta:m,lastPos:b,lastScenePos:x,lastUpdate:I},E)=>{const k=await r.schedule(()=>t.snap({point:n,scenePoint:o,context:c,signal:E}),E);if(k.valid){let P=await r.schedule(()=>k.apply(),E);n!==b&&H(b)&&(P=t.update({point:b,scenePoint:x,context:c})),NL(P,I)||(this._applySnappedUpdate(h.mapEnd,P,m,i),this.next.execute(h))}})}_createFrameTask(t){return t.type==="3d"?t.resourceController.scheduler.registerTask(vi.SNAPPING):q2}_createSnappingInfo(t,i,r){return{context:new zI({editGeometryOperations:t.editGeometryOperations,elevationInfo:t.elevationInfo,pointer:t.pointer,vertexHandle:H(i.info)?i.info.handle:null,excludeFeature:t.excludeFeature,visualizer:t.visualizer}),originalPos:H(i.snapOrigin)?t.coordinateHelper.vectorToDehydratedPoint(i.snapOrigin):i.mapStart,originalScenePos:H(i.scenePoints)?i.scenePoints.sceneStart:null,frameTask:r}}_updatePosition(t,[i,r,n]){const o=uO(t);return o.x+=i,o.y+=r,o.hasZ&&(o.z+=n),o}_updateScenePosition(t,i){return ce(t)||ce(i)?null:this._updatePosition(t,this._computeMapDelta(i.sceneEnd,i.sceneStart))}_computeMapDelta(t,i){const r=t.hasZ&&i.hasZ?t.z-i.z:0;return[t.x-i.x,t.y-i.y,r]}_applySnappedUpdate(t,i,[r,n,o],c){t.x=i.x+r,t.y=i.y+n,c&&t.hasZ&&i.hasZ&&(t.z=i.z+o)}_extractSelfSnappingZ(t,i){if(!t.hasZ())return null;const r=i.vertices;let n=null;for(const o of r){const c=t.getZ(o.pos);if(H(n)&&Math.abs(c-n)>1e-6)return null;ce(n)&&(n=c)}return n}}let Dr=class extends Or.EventedMixin(dy){constructor(e){super(e),this._createOperationCompleted=!1,this._pointerDownStates=new Set,this._snappingPipeline=new ZLe,this.isDraped=!0,this.labelOptions=new UI,this.tooltipOptions=new qI,this.snapToSceneEnabled=null,this.lastVertex=null,ce(e.elevationInfo)&&(this.elevationInfo=VL(e.hasZ))}initialize(){const{geometryType:e,view:t}=this,{spatialReference:i}=t,r="viewingMode"in t.state?t.state.viewingMode:ma.Local,n=e==="segment"||e==="multipoint"?"polyline":e;this.coordinateHelper=WL(this.hasZ,this.hasM,i),this._editGeometryOperations=new m3(new _v(n,this.coordinateHelper)),this._snappingOperation=new Af({view:t,constrainResult:c=>ce(c)?c:this._getEffectiveDrawSurface().constrainZ(c)}),this.handles.add(we(()=>this.stagedVertex,c=>{ce(c)||this.emit("cursor-update",{updated:null,vertices:[{componentIndex:0,vertexIndex:this._activeComponent.vertices.length,coordinates:this.coordinateHelper.pointToArray(c)}],operation:"apply",type:"vertex-update"})},{sync:!0,equals:(c,h)=>Mj(c,h,NL)})),this._activeComponent=new wv(i,r),this._editGeometryOperations.data.components.push(this._activeComponent);const o=this.segmentLabels;H(o)&&(o.context={view:t,editGeometryOperations:this._editGeometryOperations,elevationInfo:this.elevationInfo,labelOptions:this.labelOptions},this.handles.add([we(()=>this.labelOptions.enabled,c=>{o.visible=c},Gs),this.on("cursor-update",()=>{const c=this.stagedVertex;o.stagedVertex=H(c)?this.coordinateHelper.pointToVector(c):null})])),this.handles.add(this._editGeometryOperations.on(["vertex-add","vertex-update","vertex-remove"],c=>{const h=c.vertices.map(I=>({componentIndex:0,vertexIndex:I.index,coordinates:this.coordinateHelper.vectorToArray(I.pos)})),m=h.map(I=>I.coordinates);switch(c.type){case"vertex-add":this.emit(c.type,Ce(K({},c),{added:m,vertices:h}));break;case"vertex-update":this.emit(c.type,Ce(K({},c),{updated:m,vertices:h}));break;case"vertex-remove":this.emit(c.type,Ce(K({},c),{removed:m,vertices:h}))}const b=this._activeComponent.getLastVertex(),x=H(b)?this.coordinateHelper.vectorToDehydratedPoint(b.pos):null;(ce(x)||ce(this.lastVertex)||!NL(this.lastVertex,x))&&(this.lastVertex=x)})),this._manipulator=new LLe({grabbableForEvent:c=>this.drawingMode!=="click"||c.pointerType==="touch"&&this._snappingEnabled&&this._pointerDownStates.size===1}),this.manipulators.add(this._manipulator),this._manipulator.grabbable=e!=="point",this.handles.add([this._createManipulatorDragPipeline(this._manipulator),this._manipulator.events.on("immediate-click",c=>this._onImmediateClick(c)),this._manipulator.events.on("immediate-double-click",c=>this._onImmediateDoubleClick(c))])}destroy(){li(this.segmentLabels),li(this._snappingOperation),this._editGeometryOperations=li(this._editGeometryOperations)}get _snappingEnabled(){return H(this.snappingManager)&&this.snappingManager.options.effectiveEnabled}get _requiresScenePoint(){const e=this._getEffectiveDrawSurface();return this.view.type==="3d"&&this.drawSurface!==e}get canRedo(){return this._editGeometryOperations.canRedo}get canUndo(){return this._editGeometryOperations.canUndo}get committedVertices(){return this._activeComponent.vertices.map(e=>this.coordinateHelper.vectorToArray(e.pos))}set drawingMode(e){this._set("drawingMode",e!=null?e:GI)}get interactive(){return this._manipulator.interactive}set interactive(e){this._manipulator.interactive=e}get isCompleted(){return this._createOperationCompleted}get numCommittedVertices(){return this._activeComponent.vertices.length}get numVertices(){return H(this.stagedVertex)?this._activeComponent.vertices.length+1:this._activeComponent.vertices.length}get stagedVertex(){return this._snappingOperation.stagedPoint}set stagedVertex(e){this._snappingOperation.stagedPoint=_e(e)}get updating(){return this.updatingHandles.updating}get vertices(){const e=this.committedVertices;return H(this.stagedVertex)&&e.push(this.coordinateHelper.pointToArray(this.stagedVertex)),e}cancel(){this.complete({aborted:!0})}commitStagedVertex(){if(this._snappingOperation.abort(),H(this.stagedVertex)){const{stagedVertex:e}=this;this.stagedVertex=null,this._editGeometryOperations.appendVertex(this.coordinateHelper.pointToVector(e))}}complete(e){const t=e&&e.aborted||!1;this._snappingOperation.abort(),H(this.snappingManager)&&this.snappingManager.doneSnapping(),this.geometryType==="segment"||this.geometryType==="point"?this.commitStagedVertex():this.stagedVertex=null;const i=this.geometryType==="multipoint"&&this.numVertices===0||this.geometryType==="polyline"&&this.numVertices<2||this.geometryType==="polygon"&&this.numVertices<3;this._createOperationCompleted=!i,(this.isCompleted||t)&&this.emit("complete",{vertices:this.vertices.map((r,n)=>({componentIndex:0,vertexIndex:n,coordinates:r})),aborted:t,type:"complete"})}onInputEvent(e){switch(e.type){case"pointer-down":this._pointerDownStates.add(e.pointerId);break;case"pointer-up":this._pointerDownStates.delete(e.pointerId)}switch(e.type){case"pointer-move":return this._onPointerMove(e);case"hold":return this._onHold(e)}}redo(){this._editGeometryOperations.redo()}undo(){H(this.snappingManager)&&this.snappingManager.doneSnapping(),this._editGeometryOperations.undo()}_closeOnClickVertexIndex(e){const t=this._activeComponent;if(this.geometryType==="polygon"&&t.vertices.length>2){if(this._vertexWithinPointerDistance(t.vertices[0].pos,e))return 0;if(this._vertexWithinPointerDistance(t.vertices[t.vertices.length-1].pos,e))return t.vertices.length-1}return null}_createManipulatorDragPipeline(e){switch(Ht(this.drawingMode)){case"click":return this._createManipulatorDragPipelineClick(e);case"freehand":return this._createManipulatorDragPipelineFreehand(e);case"hybrid":return this._createManipulatorDragPipelineHybrid(e)}}_createManipulatorDragPipelineClick(e){return hO(e,(t,i,r,n)=>{const o=n==="touch"&&this._snappingEnabled;!this.isCompleted&&o&&(r=r.next(c=>(o&&H(this.snappingManager)&&this.snappingManager.doneSnapping(),c)),i.next(this._screenToMapDragEventStep()).next(c=>(c.action==="start"&&(this.stagedVertex=c.mapStart,(this.geometryType==="segment"||o&&this.numVertices===0)&&this.commitStagedVertex()),c)).next(JLe(this.view,this.elevationInfo)).next(this._snappingPipeline.createSnapDragEventPipelineStep({predicate:()=>o,cancel:r,snappingManager:this.snappingManager,snappingContext:new zI({editGeometryOperations:this._editGeometryOperations,elevationInfo:this.elevationInfo,pointer:n,visualizer:this.snappingVisualizer}),updatingHandles:this.updatingHandles,useZ:!this._requiresScenePoint}),this._snappingPipeline.next).next(c=>(o&&(this.stagedVertex=c.mapEnd,c.action==="end"&&this.commitStagedVertex()),c)).next(c=>(c.action==="end"&&(this.geometryType!=="segment"&&this.geometryType!=="point"||this.complete()),c)))})}_createManipulatorDragPipelineFreehand(e){return hO(e,(t,i)=>{this.isCompleted||i.next(this._screenToMapDragEventStep()).next(r=>(r.action==="start"&&(ce(this.stagedVertex)&&(this.stagedVertex=r.mapStart),this.geometryType==="segment"&&this.commitStagedVertex()),r)).next(r=>{switch(r.action){case"start":case"update":this.stagedVertex=r.mapEnd,this.geometryType!=="polygon"&&this.geometryType!=="polyline"||this.commitStagedVertex();break;case"end":this.complete()}return r})})}_createManipulatorDragPipelineHybrid(e){return hO(e,(t,i)=>{this.isCompleted||i.next(this._screenToMapDragEventStep()).next(r=>(r.action==="start"&&(ce(this.stagedVertex)&&(this.stagedVertex=r.mapStart),this.commitStagedVertex()),r)).next(r=>{switch(r.action){case"start":case"update":this.stagedVertex=r.mapEnd,this.geometryType!=="polygon"&&this.geometryType!=="polyline"||this.commitStagedVertex();break;case"end":this.geometryType!=="segment"&&this.geometryType!=="point"||this.complete()}return r})})}get _drawAtFixedElevation(){return(this.geometryType==="segment"||this.geometryType==="polygon")&&this.numCommittedVertices>0}_getEffectiveDrawSurface(){if(ce(this.elevationDrawSurface))return this.drawSurface;if(!this.coordinateHelper.hasZ())return this.elevationDrawSurface.defaultZ=null,this.elevationDrawSurface;let e=this.defaultZ,t=!1;return H(this.elevationInfo)&&this.elevationInfo.mode==="absolute-height"&&(t=!0),H(this.snapToSceneEnabled)&&(t=this.snapToSceneEnabled),H(this.elevationInfo)&&this.elevationInfo.mode==="on-the-ground"&&(t=!1),this._drawAtFixedElevation&&(e=this.coordinateHelper.getZ(this._activeComponent.vertices[0].pos),t=!1),t?this.drawSurface:(this.elevationDrawSurface.defaultZ=e,this.elevationDrawSurface)}_mapToScreen(e){return this._getEffectiveDrawSurface().mapToScreen(e)}_onHold(e){this._snappingOperation.abort(),this.drawingMode==="click"&&e.pointerType==="touch"&&this._snappingEnabled&&(this.stagedVertex=e.mapPoint),e.stopPropagation()}_onImmediateClick(e){if(e.pointerType==="mouse"&&e.button===2||this._manipulator.dragging)return;const t=this._activeComponent,i=this._closeOnClickVertexIndex(e.screenPoint);if(H(i))return e.stopPropagation(),void this.complete();const r=this._screenToMap(e.screenPoint);if(H(r))switch(this.drawingMode){case"freehand":this.geometryType==="point"&&(H(this.stagedVertex)?this.commitStagedVertex():this._editGeometryOperations.appendVertex(this.coordinateHelper.pointToVector(r)),this.complete());break;case"click":case"hybrid":this._snappingOperation.abort(),H(this.stagedVertex)?this.commitStagedVertex():this._editGeometryOperations.appendVertex(this.coordinateHelper.pointToVector(r)),(this.geometryType==="point"||this.geometryType==="segment"&&t.vertices.length===2||this.geometryType==="segment"&&this.drawingMode==="hybrid"&&t.vertices.length===1)&&this.complete()}e.stopPropagation()}_onImmediateDoubleClick(e){this._manipulator.dragging||this.geometryType==="point"||(this.complete(),e.stopPropagation())}_onPointerMove(e){const t=yn(e.x,e.y),i=this._snappingOperation;if(this._manipulator.dragging||this._pointerDownStates.has(e.pointerId)||this._manipulator.grabbing||!this._manipulator.interactive)return void i.abort();e.stopPropagation();const r=this._closeOnClickVertexIndex(t);if(H(r))return this._closeOnVertex(r),void i.abort();const n=this._screenToMap(t),o=this._requiresScenePoint?this.drawSurface.screenToMap(t):null;if(this._manipulator.cursor=H(n)?"crosshair":null,ce(n))return void i.abort();const c=this.snappingManager;if(ce(c))return this.stagedVertex=n,void i.abort();const h=this._drawAtFixedElevation?ch(this.elevationDrawSurface,({defaultZ:b})=>b):null,m=new zI({editGeometryOperations:this._editGeometryOperations,elevationInfo:this.elevationInfo,pointer:e.pointerType,visualizer:this.snappingVisualizer,selfSnappingZ:H(h)?{value:h,elevationInfo:this.elevationInfo}:null});this.updatingHandles.addPromise(dh(i.snap({point:n,scenePoint:o},c,m)))}_closeOnVertex(e){this.stagedVertex=null;const t={componentIndex:0,vertexIndex:e,coordinates:this.coordinateHelper.vectorToArray(this._activeComponent.vertices[e].pos)};this.emit("cursor-update",{updated:null,vertices:[t],operation:"apply",type:"vertex-update"})}_screenToMap(e){return this._getEffectiveDrawSurface().screenToMap(e)}_screenToMapDragEventStep(){let e=null;return t=>{if(t.action==="start"&&(e=this._screenToMap(t.screenStart)),ce(e))return null;const i=this._screenToMap(t.screenEnd);return H(i)?Ce(K({},t),{mapStart:e,mapEnd:i}):null}}_vertexWithinPointerDistance(e,t){const i=25,r=this._mapToScreen(this.coordinateHelper.vectorToDehydratedPoint(e));return!!H(r)&&KLe(r,t,i)}};function KLe(e,t,i){const r=e.x-t.x,n=e.y-t.y;return r*r+n*n<=i}g([w()],Dr.prototype,"_snappingEnabled",null),g([w()],Dr.prototype,"defaultZ",void 0),g([w()],Dr.prototype,"isDraped",void 0),g([w({value:GI})],Dr.prototype,"drawingMode",null),g([w({constructOnly:!0})],Dr.prototype,"elevationDrawSurface",void 0),g([w({constructOnly:!0})],Dr.prototype,"elevationInfo",void 0),g([w({constructOnly:!0,type:UI})],Dr.prototype,"labelOptions",void 0),g([w({constructOnly:!0,type:qI})],Dr.prototype,"tooltipOptions",void 0),g([w({constructOnly:!0})],Dr.prototype,"geometryType",void 0),g([w({constructOnly:!0})],Dr.prototype,"hasM",void 0),g([w({constructOnly:!0})],Dr.prototype,"hasZ",void 0),g([w({constructOnly:!0})],Dr.prototype,"manipulators",void 0),g([w({constructOnly:!0})],Dr.prototype,"drawSurface",void 0),g([w({constructOnly:!0})],Dr.prototype,"segmentLabels",void 0),g([w({constructOnly:!0})],Dr.prototype,"snappingManager",void 0),g([w({constructOnly:!0})],Dr.prototype,"snappingVisualizer",void 0),g([w()],Dr.prototype,"snapToSceneEnabled",void 0),g([w()],Dr.prototype,"_snappingOperation",void 0),g([w()],Dr.prototype,"stagedVertex",null),g([w()],Dr.prototype,"lastVertex",void 0),g([w()],Dr.prototype,"updating",null),g([w({constructOnly:!0})],Dr.prototype,"view",void 0),Dr=g([te("esri.views.draw.DrawOperation")],Dr);class YLe{constructor(t,i,r,n=null){this._elevationInfo=t,this.defaultZ=i,this._view=r,this._excludeGraphics=n}screenToMap(t){if(H(this.defaultZ))return this._view.sceneIntersectionHelper.intersectElevationFromScreen(Uw(t.x,t.y),this._elevationInfo,this.defaultZ,this._excludeGraphics);const i=this._view.sceneIntersectionHelper.intersectElevationFromScreen(Uw(t.x,t.y),this._elevationInfo,0,this._excludeGraphics);return H(i)&&(i.z=void 0),i}mapToScreen(t){const i=$I(t.x,t.y,UL(this._view,t,this._elevationInfo),t.spatialReference);return this._view.toScreen(i)}constrainZ(t){const{defaultZ:i}=this;return H(i)&&t.z!==i&&((t=uO(t)).z=i),t}}class XLe{constructor(t,i,r=[]){this.view=t,this.elevationInfo=i,this.exclude=r}screenToMap(t){const i=this.view.toMap(t,{exclude:this.exclude});return H(i)&&(i.z=BL(i,this.view,this.elevationInfo)),i}mapToScreen(t){let i=t;return H(this.elevationInfo)&&(i=$I(t.x,t.y,UL(this.view,t,this.elevationInfo),t.spatialReference)),this.view.toScreen(i)}constrainZ(t){return t}}class $Ye{constructor(t,i=!1,r=0){this.view=t,this.hasZ=i,this.defaultZ=r,this.mapToScreen=n=>t.toScreen(n),this.screenToMap=i?n=>{const o=t.toMap(n);return o.z=r,o}:n=>t.toMap(n)}constrainZ(t){const{defaultZ:i}=this;return this.hasZ&&t.z!==i&&((t=uO(t)).z=i),t}}var sm;(function(e){e[e.WhenToolEditable=0]="WhenToolEditable",e[e.WhenToolNotEditable=1]="WhenToolNotEditable",e[e.Always=2]="Always"})(sm||(sm={}));class QLe{constructor(){this._isToolEditable=!0,this._manipulators=new Xe,this._resourceContexts={manipulator3D:{}},this._attached=!1}set isToolEditable(t){this._isToolEditable=t}get length(){return this._manipulators.length}add(t,i=sm.WhenToolEditable){this.addMany([t],i)}addMany(t,i=sm.WhenToolEditable){for(const r of t){const n={manipulator:r,visibilityPredicate:i,attached:!1};this._manipulators.add(n),this._attached&&this._updateManipulatorAttachment(n)}}remove(t){for(let i=0;i<this._manipulators.length;i++)if(this._manipulators.getItemAt(i).manipulator===t){const r=this._manipulators.splice(i,1)[0];this._detachManipulator(r);break}}removeAll(){this._manipulators.forEach(t=>{this._detachManipulator(t)}),this._manipulators.removeAll()}attach(){this._manipulators.forEach(t=>{this._updateManipulatorAttachment(t)}),this._attached=!0}detach(){this._manipulators.forEach(t=>{this._detachManipulator(t)}),this._attached=!1}destroy(){this.detach(),this._manipulators.forEach(({manipulator:t})=>{t.destroy&&t.destroy()}),this._manipulators.destroy(),this._resourceContexts=null}on(t,i){return this._manipulators.on(t,r=>{i(r)})}forEach(t){for(const i of this._manipulators.items)t(i)}some(t){return this._manipulators.items.some(t)}toArray(){const t=[];return this.forEach(i=>t.push(i.manipulator)),t}intersect(t,i){let r=null,n=Number.MAX_VALUE;return this._manipulators.forEach(({manipulator:o,attached:c})=>{if(!c||!o.interactive)return;const h=o.intersectionDistance(t,i);H(h)&&h<n&&(n=h,r=o)}),r}_updateManipulatorAttachment(t){this._isManipulatorItemVisible(t)?this._attachManipulator(t):this._detachManipulator(t)}_attachManipulator(t){t.attached||(t.manipulator.attach&&t.manipulator.attach(this._resourceContexts),t.attached=!0)}_detachManipulator(t){if(!t.attached)return;const i=t.manipulator;i.grabbing=!1,i.dragging=!1,i.hovering=!1,i.selected=!1,i.detach&&i.detach(this._resourceContexts),t.attached=!1}_isManipulatorItemVisible(t){return t.visibilityPredicate===sm.Always||(this._isToolEditable?t.visibilityPredicate===sm.WhenToolEditable:t.visibilityPredicate===sm.WhenToolNotEditable)}}let qs=class extends Ye{constructor(e){super(e),this.manipulators=new QLe,this.automaticManipulatorSelection=!0,this.hasGrabbedManipulators=!1,this.hasHoveredManipulators=!1,this.firstGrabbedManipulator=null,this.created=!1,this.removeIncompleteOnCancel=!0,this._editableFlags=new Map([[Sl.MANAGER,!0],[Sl.USER,!0]]),this._creationFinishedResolver=dT()}get active(){return this.view!=null&&this.view.activeTool===this}set visible(e){this._get("visible")!==e&&(this._set("visible",e),this._syncVisible())}get editable(){return this.getEditableFlag(Sl.USER)}set editable(e){this.setEditableFlag(Sl.USER,e)}get updating(){return!1}get cursor(){return null}get hasFocusedManipulators(){return this.hasGrabbedManipulators||this.hasHoveredManipulators}destroy(){this.manipulators.destroy(),this._set("view",null)}onAdd(){this._syncVisible()}activate(){ce(this.view)?$e.getLogger(this.declaredClass).error("Can't activate tool if view is not defined."):(this.view.focus(),this.onActivate())}deactivate(){this.onDeactivate()}handleInputEvent(e){this.onInputEvent(e)}handleInputEventAfter(e){this.onInputEventAfter(e)}setEditableFlag(e,t){this._editableFlags.set(e,t),this.manipulators.isToolEditable=this.internallyEditable,this._updateManipulatorAttachment(),e===Sl.USER&&this.notifyChange("editable"),this.onEditableChange(),this.onManipulatorSelectionChanged()}getEditableFlag(e){return this._editableFlags.get(e)}whenCreated(){return this._creationFinishedResolver.promise}onManipulatorSelectionChanged(){}onActivate(){}onDeactivate(){}onShow(){}onHide(){}onEditableChange(){}onInputEvent(e){}onInputEventAfter(e){}get internallyEditable(){return this.getEditableFlag(Sl.USER)&&this.getEditableFlag(Sl.MANAGER)}finishToolCreation(){this.created||this._creationFinishedResolver.resolve(this),this._set("created",!0)}_syncVisible(){if(this.initialized){if(this.visible)this._show();else if(this._hide(),this.active)return void(this.view.activeTool=null)}}_show(){this._updateManipulatorAttachment(),this.onShow()}_hide(){this._updateManipulatorAttachment(),this.onHide()}_updateManipulatorAttachment(){this.visible?this.manipulators.attach():this.manipulators.detach()}};g([w({constructOnly:!0})],qs.prototype,"view",void 0),g([w({readOnly:!0})],qs.prototype,"active",null),g([w({value:!0})],qs.prototype,"visible",null),g([w({value:!0})],qs.prototype,"editable",null),g([w({readOnly:!0})],qs.prototype,"manipulators",void 0),g([w({readOnly:!0})],qs.prototype,"updating",null),g([w()],qs.prototype,"cursor",null),g([w({readOnly:!0})],qs.prototype,"automaticManipulatorSelection",void 0),g([w()],qs.prototype,"hasFocusedManipulators",null),g([w()],qs.prototype,"hasGrabbedManipulators",void 0),g([w()],qs.prototype,"hasHoveredManipulators",void 0),g([w()],qs.prototype,"firstGrabbedManipulator",void 0),g([w({readOnly:!0})],qs.prototype,"created",void 0),g([w({readOnly:!0})],qs.prototype,"removeIncompleteOnCancel",void 0),qs=g([te("esri.views.interactive.InteractiveToolBase")],qs);let Hs=class extends ls(Or.EventedMixin(qs)){constructor(e){super(e),this.defaultZ=0,this.elevationInfo=null,this.hasZ=!0,this.mode=null,this.snapToScene=null,this.type="draw-3d"}initialize(){const e=this.view,t=VL(this.hasZ,this.elevationInfo);this.drawOperation=new Dr({view:e,manipulators:this.manipulators,geometryType:this.geometryType,drawingMode:this.mode,hasZ:this.hasZ,defaultZ:this.defaultZ,snapToSceneEnabled:this.snapToScene,drawSurface:e.type==="3d"?new XLe(e,t):null,elevationDrawSurface:e.type==="3d"?new YLe(t,this.defaultZ,e):null,hasM:!1,elevationInfo:t}),this.handles.add([this.drawOperation.on("vertex-add",i=>this.onVertexAdd(i)),this.drawOperation.on("vertex-remove",i=>this.onVertexRemove(i)),this.drawOperation.on("vertex-update",i=>this.onVertexUpdate(i)),this.drawOperation.on("cursor-update",i=>this.onCursorUpdate(i)),this.drawOperation.on("complete",i=>this.onComplete(i))]),this.finishToolCreation()}destroy(){this.drawOperation=li(this.drawOperation),this._set("view",null)}get canRedo(){return this.drawOperation.canRedo}get canUndo(){return this.drawOperation.canUndo}set enabled(e){this.drawOperation.interactive=e,this._set("enabled",e)}get updating(){var e,t;return(t=(e=this.drawOperation)==null?void 0:e.updating)!=null?t:!1}completeCreateOperation(){this.drawOperation.complete()}onDeactivate(){this.drawOperation.isCompleted||this.drawOperation.cancel()}getVertexCoords(){return this.drawOperation.vertices}onInputEvent(e){this.drawOperation.onInputEvent(e)}redo(){this.drawOperation.redo()}reset(){}undo(){this.drawOperation.undo()}onComplete(e){this.emit("complete",e)}onCursorUpdate(e){this.emit("cursor-update",e)}onVertexAdd(e){this.emit("vertex-add",e)}onVertexRemove(e){this.emit("vertex-remove",e)}onVertexUpdate(e){this.emit("vertex-update",e)}};g([w({constructOnly:!0,nonNullable:!0})],Hs.prototype,"defaultZ",void 0),g([w()],Hs.prototype,"drawOperation",void 0),g([w({constructOnly:!0})],Hs.prototype,"elevationInfo",void 0),g([w({value:!0})],Hs.prototype,"enabled",null),g([w({constructOnly:!0})],Hs.prototype,"geometryType",void 0),g([w({constructOnly:!0})],Hs.prototype,"hasZ",void 0),g([w({constructOnly:!0})],Hs.prototype,"mode",void 0),g([w()],Hs.prototype,"snapToScene",void 0),g([w({readOnly:!0})],Hs.prototype,"type",void 0),g([w({readOnly:!0})],Hs.prototype,"updating",null),g([w({constructOnly:!0,nonNullable:!0})],Hs.prototype,"view",void 0),Hs=g([te("esri.views.draw.DrawTool")],Hs);let pO=class extends g3{constructor(e){super(e),this._addVertexOnPointerUp=!1}initialize(){this.view.type==="2d"?this._addViewHandles():this._addDrawTool()}destroy(){this.view.type==="2d"?this._removeViewHandles():this._removeDrawTool(),this.emit("destroy")}complete(){this.view.type==="2d"?this._cursorScreenPoint&&this._completeDrawing():this._drawTool.completeCreateOperation()}_addViewHandles(){this._removeViewHandles(),this._handles.add([this.view.on("pointer-down",e=>{this._shouldHandlePointerEvent(e)&&(this._abortSnapping(),this._activePointerId=e.pointerId,this._addVertexOnPointerUp=!0,this._cursorScreenPoint=pr(e),e.pointerType==="touch"&&this._updateCursor(e.native))},ft.TOOL),this.view.on("pointer-move",e=>{this._abortSnapping(),this._cursorScreenPoint=pr(e),e.pointerType!=="touch"&&this._updateCursor(e.native)},ft.TOOL),this.view.on("pointer-drag",e=>{this._shouldHandlePointerEvent(e)&&(this._abortSnapping(),this._addVertexOnPointerUp=!1)},ft.TOOL),this.view.on("pointer-up",e=>{if(this._shouldHandlePointerEvent(e))if(this._abortSnapping(),this._activePointerId=null,this._addVertexOnPointerUp)e.stopPropagation(),this._vertexAddHandler(e);else{const t=e.pointerType==="touch";this._updateCursor(e.native,t)}},ft.TOOL),this.view.on("drag",["Shift"],e=>{e.stopPropagation()},ft.TOOL),this.view.on("key-down",e=>{e.key===zt.complete&&this._cursorScreenPoint&&(this._abortSnapping(),this._vertexAddHandler(e))},ft.TOOL)],this._viewHandlesKey)}_removeViewHandles(){this._handles.remove(this._viewHandlesKey)}_addDrawTool(){this._drawTool=new Hs({view:this.view,elevationInfo:this.elevationInfo,hasZ:this.hasZ,geometryType:"point",mode:"click"}),this.view.addAndActivateTool(this._drawTool),this._handles.add([this._drawTool.on("cursor-update",e=>{e.vertices.length===1&&this.emit("cursor-update",new gp(this.view,null,e.vertices[0].vertexIndex,this._drawTool.getVertexCoords()))}),this._drawTool.on("complete",e=>{this.emit("draw-complete",new vp(null,this._drawTool.getVertexCoords())),this._removeDrawTool()})],this._drawToolHandlesKey)}_removeDrawTool(){this._handles.remove(this._drawToolHandlesKey),this.view.tools.remove(this._drawTool),this._drawTool=li(this._drawTool)}_addVertex(e){const t=this._coordinateHelper.arrayToVector(e);this._isDuplicateOfLastVertex(t)||(this._lastVertexUnsnapped=this._stagedVertexUnsnapped,this._popCursorVertex(),this._editGeometryOperations.appendVertex(t),this.notifyChange("vertices"),this._completeDrawing())}_updateCursor(e,t=!1){if(this._popCursorVertex(),!this._cursorScreenPoint)return;const i=this.getCoordsAndPointFromScreenPoint(this._cursorScreenPoint);H(i)&&!t&&this._pushCursorVertex(i.vertex,()=>this.emit("cursor-update",new gp(this.view,e,this._activeComponent.vertices.length,this.vertices,H(this._stagedVertex)?new pt(this._stagedVertex):null)))}_completeDrawing(e){this._activePointerId=null,this._popCursorVertex(),this._abortSnapping(),H(this._snappingManager)&&this._snappingManager.doneSnapping();const t=new vp(e,this.vertices);this.emit("draw-complete",t),t.defaultPrevented||this._removeViewHandles()}};pO=g([te("esri.views.draw.PointDrawAction")],pO);let Cv=class extends g3{constructor(e){super(e),this._panEnabled=!1,this._popVertexOnPointerMove=!1,this._addVertexOnPointerUp=!1,this.mode=GI}initialize(){this.view.type==="2d"?(this._addViewHandles(),this._addUndoRedoHandles()):this._addDrawTool()}destroy(){this.view.type==="2d"?(this._removeViewHandles(),this._removeUndoRedoHandles()):this._removeDrawTool(),this.emit("destroy")}get _dragEnabled(){return this.mode==="freehand"||this.mode==="hybrid"}get _clickEnabled(){return this.mode==="click"||this.mode==="hybrid"}undo(){super.undo(),this.notifyChange("vertices")}redo(){super.redo(),this.notifyChange("vertices")}complete(){this.view.type==="2d"?this._completeDrawing():this._drawTool.completeCreateOperation()}_getGeometryZValue(){return this.hasZ&&this.vertices.length>0?this.vertices[0][2]:this.defaultZ}_addViewHandles(){this._removeViewHandles(),this._handles.add([this.view.on("click",e=>{e.stopPropagation()},ft.TOOL),this.view.on("pointer-down",e=>{this._shouldHandlePointerEvent(e)&&(this._abortSnapping(),this._activePointerId=e.pointerId,this._addVertexOnPointerUp=!0,this._cursorScreenPoint=pr(e),e.pointerType==="touch"&&this._updateCursor(e.native))},ft.TOOL),this.view.on("pointer-move",e=>{this._abortSnapping(),this._popVertexOnPointerMove&&(this.undo(),this._popVertexOnPointerMove=!1),this._cursorScreenPoint=pr(e),e.pointerType!=="touch"&&this._updateCursor(e.native)},ft.TOOL),this.view.on("pointer-drag",e=>{this._shouldHandlePointerEvent(e)&&(this._abortSnapping(),this._cursorScreenPoint=pr(e),this._dragEnabled&&!this._panEnabled?this._vertexAddHandler(e):this._addVertexOnPointerUp=!1)},ft.TOOL),this.view.on("pointer-up",e=>{if(this._shouldHandlePointerEvent(e))if(this._abortSnapping(),this._activePointerId=null,this._addVertexOnPointerUp){if(!this._clickEnabled)return this.vertices.length===1&&this.vertices.pop(),void this._drawCompleteHandler(e);this._vertexAddHandler(e)}else{const t=e.pointerType==="touch";this._updateCursor(e.native,t)}},ft.TOOL),this.view.on("drag",e=>{this._dragEnabled&&H(this._activePointerId)&&!this._panEnabled&&e.stopPropagation()},ft.TOOL),this.view.on("drag",["Shift"],e=>{e.stopPropagation()},ft.TOOL),this.view.on("double-click",e=>{e.stopPropagation(),this._drawCompleteHandler(e)},ft.TOOL),this.view.on("double-click",["Control"],e=>{e.stopPropagation(),this._drawCompleteHandler(e)},ft.TOOL),this.view.on("key-down",e=>{const{key:t,repeat:i}=e;t===zt.vertexAdd&&!i&&this._cursorScreenPoint?(e.stopPropagation(),this._abortSnapping(),this._vertexAddHandler(e)):t!==zt.complete||i?t!==zt.undo||this.interactiveUndoDisabled||i?t!==zt.redo||this.interactiveUndoDisabled||i?t!==zt.pan||i||(e.stopPropagation(),this._panEnabled=!0):(e.stopPropagation(),this.redo()):(e.stopPropagation(),this.undo()):(e.stopPropagation(),this._drawCompleteHandler(e))},ft.TOOL),this.view.on("key-up",e=>{e.key===zt.pan&&(e.stopPropagation(),this._panEnabled=!1)},ft.TOOL)],this._viewHandlesKey)}_addUndoRedoHandles(){this._removeUndoRedoHandles(),this._handles.add([this._editGeometryOperations.on("vertex-remove",e=>{if(this.notifyChange("vertices"),e.operation==="undo"){const t=this._nativeEventHistory.undoStack.pop();this._nativeEventHistory.redoStack.push(t);const i=[...this._committedVertices];H(this._stagedVertex)&&i.push(this._coordinateHelper.pointToArray(this._stagedVertex)),this.emit("undo",new lO(this.view,t,e.vertices[0].index,i))}}),this._editGeometryOperations.on("vertex-add",e=>{if(this.notifyChange("vertices"),e.operation==="apply"){const t=this._nativeEventHistory.undoStack[this._nativeEventHistory.undoStack.length],i=this._committedVertices.length-1,r=new Nu(this.view,t,i,this.vertices);this.emit("vertex-add",r),r.defaultPrevented&&(this._popVertexOnPointerMove=!0)}else if(e.operation==="redo"){const t=this._nativeEventHistory.redoStack.pop();this._nativeEventHistory.undoStack.push(t);const i=[...this._committedVertices];H(this._stagedVertex)&&i.push(this._coordinateHelper.pointToArray(this._stagedVertex)),this.emit("redo",new Nu(this.view,t,e.vertices[0].index,i))}})],this._undoRedoHandlesKey)}_removeViewHandles(){this._handles.remove(this._viewHandlesKey)}_removeUndoRedoHandles(){this._handles.remove(this._undoRedoHandlesKey)}_addDrawTool(){this._drawTool=new Hs({view:this.view,elevationInfo:this.elevationInfo,hasZ:this.hasZ,geometryType:"polygon",mode:this.mode}),this.view.addAndActivateTool(this._drawTool),this._drawTool.on("vertex-add",e=>{e.vertices.length===1&&this.emit("vertex-add",new Nu(this.view,null,e.vertices[0].vertexIndex,this._drawTool.getVertexCoords()))}),this._drawTool.on("cursor-update",e=>{e.vertices.length===1&&this.emit("cursor-update",new gp(this.view,null,e.vertices[0].vertexIndex,this._drawTool.getVertexCoords()))}),this._drawTool.on("complete",e=>{this.emit("draw-complete",new vp(null,this._drawTool.getVertexCoords())),this._removeDrawTool()})}_removeDrawTool(){this._handles.remove(this._drawToolHandlesKey),this.view.tools.remove(this._drawTool),this._drawTool=li(this._drawTool)}_addVertex(e,t){const i=this._coordinateHelper.arrayToVector(e);if(this._isDuplicateOfLastVertex(i))return;this._lastVertexUnsnapped=this._stagedVertexUnsnapped,this._popCursorVertex(),this._editGeometryOperations.appendVertex(i);const r=t||new Event("placeholder");this._nativeEventHistory.undoStack.push(r)}_updateCursor(e,t=!1){if(this._popCursorVertex(),!this._cursorScreenPoint)return;const i=this.getCoordsAndPointFromScreenPoint(this._cursorScreenPoint);H(i)&&!t&&this._pushCursorVertex(i.vertex,()=>this.emit("cursor-update",new gp(this.view,e,this._activeComponent.vertices.length,this.vertices,H(this._stagedVertex)?new pt(this._stagedVertex):null)))}_completeDrawing(e){if(this._activePointerId=null,this._popCursorVertex(),this._committedVertices.length<3)return;this._abortSnapping(),H(this._snappingManager)&&this._snappingManager.doneSnapping();const t=new vp(e,this.vertices);this.emit("draw-complete",t),t.defaultPrevented||this._removeViewHandles()}};g([w()],Cv.prototype,"_dragEnabled",null),g([w()],Cv.prototype,"_clickEnabled",null),g([w({type:yie})],Cv.prototype,"mode",void 0),Cv=g([te("esri.views.draw.PolygonDrawAction")],Cv);let kv=class extends g3{constructor(e){super(e),this._panEnabled=!1,this._popVertexOnPointerMove=!1,this._addVertexOnPointerUp=!1,this.mode=GI}initialize(){this.view.type==="2d"?(this._addViewHandles(),this._addUndoRedoHandles()):this._addDrawTool()}destroy(){this.view.type==="2d"?(this._removeViewHandles(),this._removeUndoRedoHandles()):this._removeDrawTool(),this.emit("destroy")}get _clickEnabled(){return this.mode==="click"||this.mode==="hybrid"}get _dragEnabled(){return this.mode==="freehand"||this.mode==="hybrid"}undo(){super.undo(),this.notifyChange("vertices")}redo(){super.redo(),this.notifyChange("vertices")}complete(){this.view.type==="2d"?this._completeDrawing():this._drawTool.completeCreateOperation()}_addViewHandles(){this._removeViewHandles(),this._handles.add([this.view.on("click",e=>{e.stopPropagation()},ft.TOOL),this.view.on("pointer-down",e=>{this._shouldHandlePointerEvent(e)&&!this._panEnabled&&(this._abortSnapping(),this._activePointerId=e.pointerId,this._addVertexOnPointerUp=!0,this._cursorScreenPoint=pr(e),e.pointerType==="touch"&&this._updateCursor(e.native))},ft.TOOL),this.view.on("pointer-move",e=>{this._popVertexOnPointerMove&&(this.undo(),this._popVertexOnPointerMove=!1),this._abortSnapping(),this._cursorScreenPoint=pr(e),e.pointerType!=="touch"&&this._updateCursor(e.native)},ft.TOOL),this.view.on("pointer-drag",e=>{this._shouldHandlePointerEvent(e)&&(this._abortSnapping(),this._cursorScreenPoint=pr(e),this._dragEnabled&&!this._panEnabled?this._vertexAddHandler(e):this._addVertexOnPointerUp=!1)},ft.TOOL),this.view.on("pointer-up",e=>{if(this._shouldHandlePointerEvent(e))if(this._abortSnapping(),this._activePointerId=null,this._addVertexOnPointerUp){if(!this._clickEnabled)return this.vertices.length===1&&this.vertices.pop(),void this._drawCompleteHandler(e);this._vertexAddHandler(e)}else{const t=e.pointerType==="touch";this._updateCursor(e.native,t)}},ft.TOOL),this.view.on("drag",e=>{this._dragEnabled&&H(this._activePointerId)&&!this._panEnabled&&e.stopPropagation()},ft.TOOL),this.view.on("drag",["Shift"],e=>{e.stopPropagation()},ft.TOOL),this.view.on("double-click",e=>{e.stopPropagation(),this._drawCompleteHandler(e)},ft.TOOL),this.view.on("double-click",["Control"],e=>{e.stopPropagation(),this._drawCompleteHandler(e)},ft.TOOL),this.view.on("key-down",e=>{const{key:t,repeat:i}=e;t===zt.vertexAdd&&!i&&this._cursorScreenPoint?(e.stopPropagation(),this._abortSnapping(),this._vertexAddHandler(e)):t!==zt.complete||i?t!==zt.undo||this.interactiveUndoDisabled||i?t!==zt.redo||this.interactiveUndoDisabled||i?t!==zt.pan||i||(e.stopPropagation(),this._panEnabled=!0):(e.stopPropagation(),this.redo()):(e.stopPropagation(),this.undo()):(e.stopPropagation(),this._drawCompleteHandler(e))},ft.TOOL),this.view.on("key-up",e=>{e.key===zt.pan&&(e.stopPropagation(),this._panEnabled=!1)},ft.TOOL)],this._viewHandlesKey)}_addUndoRedoHandles(){this._removeUndoRedoHandles(),this._handles.add([this._editGeometryOperations.on("vertex-remove",e=>{if(this.notifyChange("vertices"),e.operation==="undo"){const t=this._nativeEventHistory.undoStack.pop();this._nativeEventHistory.redoStack.push(t);const i=[...this._committedVertices];H(this._stagedVertex)&&i.push(this._coordinateHelper.pointToArray(this._stagedVertex)),this.emit("undo",new lO(this.view,t,e.vertices[0].index,i))}}),this._editGeometryOperations.on("vertex-add",e=>{if(this.notifyChange("vertices"),e.operation==="apply"){const t=this._nativeEventHistory.undoStack[this._nativeEventHistory.undoStack.length],i=this._committedVertices.length-1,r=new Nu(this.view,t,i,this.vertices);this.emit("vertex-add",r),r.defaultPrevented&&(this._popVertexOnPointerMove=!0)}else if(e.operation==="redo"){const t=this._nativeEventHistory.redoStack.pop();this._nativeEventHistory.undoStack.push(t);const i=[...this._committedVertices];H(this._stagedVertex)&&i.push(this._coordinateHelper.pointToArray(this._stagedVertex)),this.emit("redo",new Nu(this.view,t,e.vertices[0].index,i))}})],this._undoRedoHandlesKey)}_removeViewHandles(){this._handles.remove(this._viewHandlesKey)}_removeUndoRedoHandles(){this._handles.remove(this._undoRedoHandlesKey)}_addDrawTool(){this._drawTool=new Hs({view:this.view,elevationInfo:this.elevationInfo,hasZ:this.hasZ,geometryType:"polyline",mode:this.mode}),this.view.addAndActivateTool(this._drawTool),this._handles.add([this._drawTool.on("vertex-add",e=>{e.vertices.length===1&&this.emit("vertex-add",new Nu(this.view,null,e.vertices[0].vertexIndex,this._drawTool.getVertexCoords()))}),this._drawTool.on("cursor-update",e=>{e.vertices.length===1&&this.emit("cursor-update",new gp(this.view,null,e.vertices[0].vertexIndex,this._drawTool.getVertexCoords()))}),this._drawTool.on("complete",e=>{this.emit("draw-complete",new vp(null,this._drawTool.getVertexCoords())),this._removeDrawTool()})],this._drawToolHandlesKey)}_removeDrawTool(){this._handles.remove(this._drawToolHandlesKey),this.view.tools.remove(this._drawTool),this._drawTool=li(this._drawTool)}_addVertex(e,t){const i=this._coordinateHelper.arrayToVector(e);if(this._isDuplicateOfLastVertex(i))return;this._lastVertexUnsnapped=this._stagedVertexUnsnapped,this._popCursorVertex(),this._editGeometryOperations.appendVertex(i);const r=t||new Event("placeholder");this._nativeEventHistory.undoStack.push(r)}_updateCursor(e,t=!1){if(this._popCursorVertex(),!this._cursorScreenPoint)return;const i=this.getCoordsAndPointFromScreenPoint(this._cursorScreenPoint);H(i)&&!t&&this._pushCursorVertex(i.vertex,()=>this.emit("cursor-update",new gp(this.view,e,this._activeComponent.vertices.length,this.vertices,H(this._stagedVertex)?new pt(this._stagedVertex):null)))}_completeDrawing(e){if(this._activePointerId=null,this._popCursorVertex(),this._committedVertices.length<2)return;this._abortSnapping(),H(this._snappingManager)&&this._snappingManager.doneSnapping();const t=new vp(e,this.vertices);this.emit("draw-complete",t),t.defaultPrevented||this._removeViewHandles()}};g([w()],kv.prototype,"_clickEnabled",null),g([w()],kv.prototype,"_dragEnabled",null),g([w({type:yie})],kv.prototype,"mode",void 0),kv=g([te("esri.views.draw.PolylineDrawAction")],kv);function eOe(e){return e[0]=0,e[1]=0,e[2]=0,e[3]=1,e}function xie(e,t,i){i*=.5;const r=Math.sin(i);return e[0]=r*t[0],e[1]=r*t[1],e[2]=r*t[2],e[3]=Math.cos(i),e}function tOe(e,t){const i=2*Math.acos(t[3]),r=Math.sin(i/2);return r>Zo()?(e[0]=t[0]/r,e[1]=t[1]/r,e[2]=t[2]/r):(e[0]=1,e[1]=0,e[2]=0),i}function Sie(e,t,i){const r=t[0],n=t[1],o=t[2],c=t[3],h=i[0],m=i[1],b=i[2],x=i[3];return e[0]=r*x+c*h+n*b-o*m,e[1]=n*x+c*m+o*h-r*b,e[2]=o*x+c*b+r*m-n*h,e[3]=c*x-r*h-n*m-o*b,e}function iOe(e,t,i){i*=.5;const r=t[0],n=t[1],o=t[2],c=t[3],h=Math.sin(i),m=Math.cos(i);return e[0]=r*m+c*h,e[1]=n*m+o*h,e[2]=o*m-n*h,e[3]=c*m-r*h,e}function rOe(e,t,i){i*=.5;const r=t[0],n=t[1],o=t[2],c=t[3],h=Math.sin(i),m=Math.cos(i);return e[0]=r*m-o*h,e[1]=n*m+c*h,e[2]=o*m+r*h,e[3]=c*m-n*h,e}function nOe(e,t,i){i*=.5;const r=t[0],n=t[1],o=t[2],c=t[3],h=Math.sin(i),m=Math.cos(i);return e[0]=r*m+n*h,e[1]=n*m-r*h,e[2]=o*m+c*h,e[3]=c*m-o*h,e}function sOe(e,t){const i=t[0],r=t[1],n=t[2];return e[0]=i,e[1]=r,e[2]=n,e[3]=Math.sqrt(Math.abs(1-i*i-r*r-n*n)),e}function HI(e,t,i,r){const n=t[0],o=t[1],c=t[2],h=t[3];let m,b,x,I,E,k=i[0],P=i[1],F=i[2],N=i[3];return b=n*k+o*P+c*F+h*N,b<0&&(b=-b,k=-k,P=-P,F=-F,N=-N),1-b>Zo()?(m=Math.acos(b),x=Math.sin(m),I=Math.sin((1-r)*m)/x,E=Math.sin(r*m)/x):(I=1-r,E=r),e[0]=I*n+E*k,e[1]=I*o+E*P,e[2]=I*c+E*F,e[3]=I*h+E*N,e}function oOe(e){const t=Bw,i=t(),r=t(),n=t(),o=Math.sqrt(1-i),c=Math.sqrt(i);return e[0]=o*Math.sin(2*Math.PI*r),e[1]=o*Math.cos(2*Math.PI*r),e[2]=c*Math.sin(2*Math.PI*n),e[3]=c*Math.cos(2*Math.PI*n),e}function Mie(e,t){const i=t[0],r=t[1],n=t[2],o=t[3],c=i*i+r*r+n*n+o*o,h=c?1/c:0;return e[0]=-i*h,e[1]=-r*h,e[2]=-n*h,e[3]=o*h,e}function aOe(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e[3]=t[3],e}function Iie(e,t){const i=t[0]+t[4]+t[8];let r;if(i>0)r=Math.sqrt(i+1),e[3]=.5*r,r=.5/r,e[0]=(t[5]-t[7])*r,e[1]=(t[6]-t[2])*r,e[2]=(t[1]-t[3])*r;else{let n=0;t[4]>t[0]&&(n=1),t[8]>t[3*n+n]&&(n=2);const o=(n+1)%3,c=(n+2)%3;r=Math.sqrt(t[3*n+n]-t[3*o+o]-t[3*c+c]+1),e[n]=.5*r,r=.5/r,e[3]=(t[3*o+c]-t[3*c+o])*r,e[o]=(t[3*o+n]+t[3*n+o])*r,e[c]=(t[3*c+n]+t[3*n+c])*r}return e}function lOe(e,t,i,r){const n=.5*Math.PI/180;t*=n,i*=n,r*=n;const o=Math.sin(t),c=Math.cos(t),h=Math.sin(i),m=Math.cos(i),b=Math.sin(r),x=Math.cos(r);return e[0]=o*m*x-c*h*b,e[1]=c*h*x+o*m*b,e[2]=c*m*b-o*h*x,e[3]=c*m*x+o*h*b,e}function cOe(e){return"quat("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+")"}const uOe=a5,hOe=gG,pOe=vG,dOe=Sie,fOe=xG,yOe=$G,mOe=l5,$ie=O6,gOe=$ie,Eie=R6,vOe=Eie,dO=IG,bOe=EG,wOe=F6;function Tie(e,t,i){const r=Ci(t,i);return r<-.999999?(is(Du,_Oe,t),s5(Du)<1e-6&&is(Du,xOe,t),Ds(Du,Du),xie(e,Du,Math.PI),e):r>.999999?(e[0]=0,e[1]=0,e[2]=0,e[3]=1,e):(is(Du,t,i),e[0]=Du[0],e[1]=Du[1],e[2]=Du[2],e[3]=1+r,dO(e,e))}const Du=it(),_Oe=Mn(1,0,0),xOe=Mn(0,1,0);function SOe(e,t,i,r,n,o){return HI(Cie,t,n,o),HI(kie,i,r,o),HI(e,Cie,kie,2*o*(1-o)),e}const Cie=xv(),kie=xv();function MOe(e,t,i,r){const n=IOe;return n[0]=i[0],n[3]=i[1],n[6]=i[2],n[1]=r[0],n[4]=r[1],n[7]=r[2],n[2]=-t[0],n[5]=-t[1],n[8]=-t[2],dO(e,Iie(e,n))}const IOe=Xte();Object.freeze(Object.defineProperty({__proto__:null,identity:eOe,setAxisAngle:xie,getAxisAngle:tOe,multiply:Sie,rotateX:iOe,rotateY:rOe,rotateZ:nOe,calculateW:sOe,slerp:HI,random:oOe,invert:Mie,conjugate:aOe,fromMat3:Iie,fromEuler:lOe,str:cOe,copy:uOe,set:hOe,add:pOe,mul:dOe,scale:fOe,dot:yOe,lerp:mOe,length:$ie,len:gOe,squaredLength:Eie,sqrLen:vOe,normalize:dO,exactEquals:bOe,equals:wOe,rotationTo:Tie,sqlerp:SOe,setAxes:MOe},Symbol.toStringTag,{value:"Module"}));function WI(e,t,i=null){return H(i)?[e,t,i]:[e,t]}function Aie(e,t,i=null){return H(i)?{x:e,y:t,z:i}:{x:e,y:t}}class Pie{constructor(t){this.spatialReference=t}mapToLocalMultiple(t){return $0e(t.map(i=>this.mapToLocal(i)))}get doUnnormalization(){return!1}}class $Oe extends Pie{constructor(t,i,r=null){super(i),this._defaultZ=r,this.transform=ku(),this.transformInv=ku(),this.transform=aQ(t),HM(this.transformInv,this.transform)}makeMapPoint(t,i){return WI(t,i,this._defaultZ)}mapToLocal(t){return Aie(this.transform[0]*t[0]+this.transform[2]*t[1]+this.transform[4],this.transform[1]*t[0]+this.transform[3]*t[1]+this.transform[5])}localToMap(t){return WI(this.transformInv[0]*t.x+this.transformInv[2]*t.y+this.transformInv[4],this.transformInv[1]*t.x+this.transformInv[3]*t.y+this.transformInv[5],this._defaultZ)}}class EOe extends Pie{constructor(t,i){super(t.spatialReference),this.view=t,this.defaultZ=null,this.pWS=it(),this.tangentFrameUpWS=it(),this.tangentFrameRightWS=it(),this.tangentFrameForwardWS=it(),this.localFrameRightWS=it(),this.localFrameUpWS=it(),this.worldToLocalTransform=xv(),this.localToWorldTransform=xv(),this.scale=1,this.scale=t.resolution,this.referenceMapPoint=i,this.defaultZ=i.hasZ?i.z:null;const r=t.state.camera.viewRight;this.view.renderCoordsHelper.toRenderCoords(this.referenceMapPoint,this.pWS),this.view.renderCoordsHelper.worldBasisAtPosition(this.pWS,yp.X,this.tangentFrameRightWS),this.view.renderCoordsHelper.worldBasisAtPosition(this.pWS,yp.Y,this.tangentFrameUpWS),this.view.renderCoordsHelper.worldBasisAtPosition(this.pWS,yp.Z,this.tangentFrameForwardWS);const n=it();Yo(n,this.tangentFrameForwardWS,Ci(r,this.tangentFrameForwardWS)),fn(this.localFrameRightWS,r,n),Ds(this.localFrameRightWS,this.localFrameRightWS),is(this.localFrameUpWS,this.tangentFrameForwardWS,this.localFrameRightWS),Tie(this.worldToLocalTransform,this.localFrameRightWS,this.tangentFrameRightWS),Mie(this.localToWorldTransform,this.worldToLocalTransform)}get doUnnormalization(){return this.view.viewingMode==="global"}makeMapPoint(t,i){return WI(t,i,this.defaultZ)}mapToLocal(t){const i=it();this.view.renderCoordsHelper.toRenderCoords(new pt({x:t[0],y:t[1],spatialReference:this.spatialReference}),i),P6(i,i,this.worldToLocalTransform);const r=this.view.renderCoordsHelper.fromRenderCoords(i,this.view.spatialReference);return H(r)?Aie(r.x/this.scale,r.y/this.scale):null}localToMap(t){const i=it();this.view.renderCoordsHelper.toRenderCoords(new pt({x:t.x*this.scale,y:t.y*this.scale,spatialReference:this.spatialReference}),i),P6(i,i,this.localToWorldTransform);const r=this.view.renderCoordsHelper.fromRenderCoords(i,this.view.spatialReference);return H(r)?WI(r.x,r.y,this.defaultZ):null}}function TOe(e,t){if(e.type==="2d")return new $Oe(e.state.transform,e.spatialReference,t.length>2?t[2]:null);if(e.type==="3d"){const i=t.length>2?new pt({x:t[0],y:t[1],z:t[2],spatialReference:e.spatialReference}):new pt({x:t[0],y:t[1],spatialReference:e.spatialReference});return new EOe(e,i)}return null}const COe=["freehand","click"];let JI=class extends g3{constructor(e){super(e),this._isDragging=!1,this._panEnabled=!1,this._addVertexOnPointerUp=!1,this.viewAlignedCoordinateSystem=null,this.mode="freehand"}initialize(){this.view.type==="2d"?this._addViewHandles():this._addDrawTool()}destroy(){this.view.type==="2d"?this._removeViewHandles():this._removeDrawTool(),this.emit("destroy")}complete(){this.view.type==="2d"?this._completeDrawing():this._drawTool.completeCreateOperation()}_getGeometryZValue(){return this.hasZ&&this.vertices.length>0?this.vertices[0][2]:this.defaultZ}_addViewHandles(){this._removeViewHandles(),this.mode==="click"?this._handles.add(this._getClickModeViewHandles(),this._viewHandlesKey):this._handles.add(this._getDragModeViewHandles(),this._viewHandlesKey)}_getDragModeViewHandles(){return[this.view.on("immediate-click",e=>{if(e.stopPropagation(),e.mapPoint&&!this._panEnabled){const t=this.getCoordsFromScreenPoint(pr(e));H(t)&&(this._vertexAddHandler(e),this._drawCompleteHandler(e))}},ft.TOOL),this.view.on("pointer-down",e=>{this._shouldHandlePointerEvent(e)&&(this._abortSnapping(),this._panEnabled||(this._resetGeometry(),this._addVertexOnPointerUp=!0,this._cursorScreenPoint=pr(e),this._activePointerId=e.pointerId,this._vertexAddHandler(e),this._isDragging=!1,e.pointerType==="touch"&&this._updateCursor(e.native)))},ft.TOOL),this.view.on("pointer-move",e=>{this._abortSnapping(),ce(this._activePointerId)&&e.pointerType!=="touch"&&(this._cursorScreenPoint=pr(e),this._updateCursor(e.native))},ft.TOOL),this.view.on("pointer-drag",e=>{this._shouldHandlePointerEvent(e)&&(this._abortSnapping(),this._isDragging=!0,this._cursorScreenPoint=pr(e),this._updateCursor(e.native))},ft.TOOL),this.view.on("pointer-up",e=>{this._shouldHandlePointerEvent(e)&&this._addVertexOnPointerUp&&(this._abortSnapping(),this._activePointerId=null,this._isDragging&&this._vertexAddHandler(e),this._committedVertices.length===2&&this._drawCompleteHandler(e),this._isDragging=!1)},ft.TOOL),this.view.on("key-down",e=>{e.key===zt.complete&&this._cursorScreenPoint?(this._abortSnapping(),this._vertexAddHandler(e),this._drawCompleteHandler(e)):e.key===zt.pan&&(this._panEnabled=!0)},ft.TOOL),this.view.on("key-up",e=>{e.key===zt.pan&&(this._panEnabled=!1)},ft.TOOL),this.view.on("drag",e=>{H(this._activePointerId)&&e.stopPropagation()},ft.TOOL),this.view.on("drag",["Shift"],e=>{e.stopPropagation()},ft.TOOL)]}_getClickModeViewHandles(){return[this.view.on("pointer-down",e=>{this._abortSnapping(),this._cursorScreenPoint=pr(e),this._activePointerId=e.pointerId,this._isDragging=!1,e.pointerType==="touch"&&this._updateCursor(e.native)},ft.TOOL),this.view.on("pointer-move",e=>{this._abortSnapping(),this._cursorScreenPoint=pr(e),ce(this._activePointerId)&&e.pointerType!=="touch"&&this._updateCursor(e.native)},ft.TOOL),this.view.on("pointer-drag",e=>{this._shouldHandlePointerEvent(e)&&(this._abortSnapping(),this._isDragging=!0)},ft.TOOL),this.view.on("pointer-up",e=>{this._shouldHandlePointerEvent(e)&&(this._abortSnapping(),this._activePointerId=null,e.stopPropagation(),this._isDragging||this._vertexAddHandler(e),this.vertices.length!==2||this._isDragging||this._drawCompleteHandler(e),this._isDragging=!1)},ft.TOOL),this.view.on("key-down",e=>{e.key===zt.vertexAdd&&this._cursorScreenPoint&&(this._vertexAddHandler(e),this.vertices.length===2&&this._drawCompleteHandler(e)),e.key===zt.complete&&this._cursorScreenPoint&&this.vertices.length===2&&(this._vertexAddHandler(e),this._drawCompleteHandler(e))},ft.TOOL)]}_removeViewHandles(){this._handles.remove(this._viewHandlesKey)}_addDrawTool(){this._drawTool=new Hs({view:this.view,elevationInfo:this.elevationInfo,hasZ:this.hasZ,geometryType:"segment",mode:this.mode}),this.view.addAndActivateTool(this._drawTool),this._handles.add([this._drawTool.on("vertex-add",e=>{e.vertices.length===1&&this.emit("vertex-add",new Nu(this.view,null,e.vertices[0].vertexIndex,this._drawTool.getVertexCoords()))}),this._drawTool.on("cursor-update",e=>{e.vertices.length===1&&this.emit("cursor-update",new gp(this.view,null,e.vertices[0].vertexIndex,this._drawTool.getVertexCoords()))}),this._drawTool.on("complete",e=>{this.emit("draw-complete",new vp(null,this._drawTool.getVertexCoords())),this._removeDrawTool()})],this._drawToolHandlesKey)}_removeDrawTool(){this._handles.remove(this._drawToolHandlesKey),this.view.tools.remove(this._drawTool),this._drawTool=li(this._drawTool)}_addVertex(e,t){const i=this._coordinateHelper.arrayToVector(e);if(this._isDuplicateOfLastVertex(i))return;this._lastVertexUnsnapped=this._stagedVertexUnsnapped,this._popCursorVertex(),this._editGeometryOperations.appendVertex(i),this._committedVertices.length===1&&(this.viewAlignedCoordinateSystem=TOe(this.view,this._committedVertices[0]));const r=this._committedVertices.length-1,n=new Nu(this.view,t,r,this.vertices);this.emit("vertex-add",n)}_updateCursor(e){if(this._popCursorVertex(),!this._cursorScreenPoint)return;const t=this.getCoordsAndPointFromScreenPoint(this._cursorScreenPoint);H(t)&&this._pushCursorVertex(t.vertex,()=>this.emit("cursor-update",new gp(this.view,e,this._activeComponent.vertices.length,this.vertices,H(this._stagedVertex)?new pt(this._stagedVertex):null)))}_completeDrawing(e){if(this._activePointerId=null,this._popCursorVertex(),this._cursorScreenPoint=null,this._isDragging=!1,this._abortSnapping(),H(this._snappingManager)&&this._snappingManager.doneSnapping(),this.vertices.length<1)return;const t=new vp(e,this.vertices);this.emit("draw-complete",t),t.defaultPrevented||this._removeViewHandles()}_resetGeometry(){this._editGeometryOperations.destroy(),this._editGeometryOperations=new m3(new _v("polygon",this._coordinateHelper)),this._activeComponent=new wv(this._coordinateHelper.spatialReference,ma.Local),this._editGeometryOperations.data.components.push(this._activeComponent)}};g([w({type:COe})],JI.prototype,"mode",void 0),JI=g([te("esri/views/2d/engine/markup/SegmentDrawAction")],JI);let w3=class extends Ye{constructor(){super(...arguments),this.activeAction=null,this.type="draw",this.view=null}destroy(){this.activeAction&&(this.activeAction.destroy(),this.activeAction=null)}create(e,t){this.reset();const i=K({view:this.view},t);switch(e){case"point":i.editGeometryType="point",this.activeAction=new pO(i);break;case"polyline":i.editGeometryType="polyline",this.activeAction=new kv(i);break;case"multipoint":i.editGeometryType="polygon",this.activeAction=new cO(i);break;case"polygon":i.editGeometryType="polygon",this.activeAction=new Cv(i);break;case"rectangle":case"circle":case"ellipse":case"triangle":i.editGeometryType="polygon",this.activeAction=new JI(i)}return this.activeAction}complete(){this.activeAction&&this.activeAction.complete(),this.activeAction=null}reset(){this.activeAction&&this.activeAction.destroy(),this.activeAction=null}};g([w()],w3.prototype,"activeAction",void 0),g([w({readOnly:!0})],w3.prototype,"type",void 0),g([w()],w3.prototype,"view",void 0),w3=g([te("esri.views.draw.Draw")],w3);const Lie=96;function Oie(e,t){const i=t||e.extent,r=e.width,n=kh(i&&i.spatialReference);return i&&r?i.width/r*n*LU*Lie:0}function kOe(e,t){return e/(kh(t)*LU*Lie)}function AOe(e,t){const i=e.extent,r=e.width-(e.padding?e.padding.left+e.padding.right:0),n=kOe(t,i.spatialReference);return i.clone().expand(n*r/i.width)}class ZI{constructor(t,i,r=""){this.major=t,this.minor=i,this._context=r}lessThan(t,i){return this.major<t||t===this.major&&this.minor<i}since(t,i){return!this.lessThan(t,i)}validate(t){if(this.major!==t.major){const i=this._context&&this._context+":",r=this._context&&this._context+" ";throw new ue(i+"unsupported-version",`Required major ${r}version is '${this.major}', but got '\${version.major}.\${version.minor}'`,{version:t})}}clone(){return new ZI(this.major,this.minor,this._context)}static parse(t,i=""){const[r,n]=t.split("."),o=/^\s*\d+\s*$/;if(!r||!r.match||!r.match(o))throw new ue((i&&i+":")+"invalid-version","Expected major version to be a number, but got '${version}'",{version:t});if(!n||!n.match||!n.match(o))throw new ue((i&&i+":")+"invalid-version","Expected minor version to be a number, but got '${version}'",{version:t});const c=parseInt(r,10),h=parseInt(n,10);return new ZI(c,h,i)}}const Rie=e=>{let t=class extends e{constructor(){super(...arguments),this.capabilities=void 0,this.copyright=null,this.fullExtent=null,this.legendEnabled=!0,this.spatialReference=null,this.version=void 0,this._allLayersAndTablesPromise=null,this._allLayersAndTablesMap=null}readCapabilities(i,r){var z,q;const n=r.capabilities&&r.capabilities.split(",").map(J=>J.toLowerCase().trim());if(!n)return{operations:{supportsExportMap:!1,supportsExportTiles:!1,supportsIdentify:!1,supportsQuery:!1,supportsTileMap:!1},exportMap:null,exportTiles:null};const o=this.type,c=n.includes("data"),h=n.includes("query"),m=n.includes("map"),b=!!r.exportTilesAllowed,x=n.includes("tilemap"),I=o!=="tile"&&!!r.supportsDynamicLayers,E=o!=="tile"&&(!r.tileInfo||I),k=o!=="tile"&&(!r.tileInfo||I),P=o!=="tile",F=r.cimVersion&&ZI.parse(r.cimVersion),N=(z=F==null?void 0:F.since(1,4))!=null?z:!1,B=(q=F==null?void 0:F.since(2,0))!=null?q:!1;return{operations:{supportsExportMap:m,supportsExportTiles:b,supportsIdentify:h,supportsQuery:c,supportsTileMap:x},exportMap:m?{supportsArcadeExpressionForLabeling:N,supportsSublayersChanges:P,supportsDynamicLayers:I,supportsSublayerVisibility:E,supportsSublayerDefinitionExpression:k,supportsCIMSymbols:B}:null,exportTiles:b?{maxExportTilesCount:+r.maxExportTilesCount}:null}}readVersion(i,r){let n=r.currentVersion;return n||(n=r.hasOwnProperty("capabilities")||r.hasOwnProperty("tables")?10:r.hasOwnProperty("supportedImageFormatTypes")?9.31:9.3),n}async fetchSublayerInfo(i,r){var n;return await this.fetchAllLayersAndTables(r),(n=this._allLayersAndTablesMap)==null?void 0:n.get(i)}async fetchAllLayersAndTables(i){await this.load(i),this._allLayersAndTablesPromise||(this._allLayersAndTablesPromise=Nt(mn(this.url).path+"/layers",{responseType:"json",query:Ce(K({f:"json"},this.customParameters),{token:this.apiKey})}).then(n=>{this._allLayersAndTablesMap=new Map;for(const o of n.data.layers)this._allLayersAndTablesMap.set(o.id,o);return{result:n.data}},n=>({error:n})));const r=await this._allLayersAndTablesPromise;if(ur(i),"result"in r)return r.result;throw r.error}};return g([w({readOnly:!0})],t.prototype,"capabilities",void 0),g([We("service","capabilities",["capabilities","exportTilesAllowed","maxExportTilesCount","supportsDynamicLayers","tileInfo"])],t.prototype,"readCapabilities",null),g([w({json:{read:{source:"copyrightText"}}})],t.prototype,"copyright",void 0),g([w({type:gi})],t.prototype,"fullExtent",void 0),g([w(VK)],t.prototype,"id",void 0),g([w({type:Boolean,json:{origins:{service:{read:{enabled:!1}}},read:{source:"showLegend"},write:{target:"showLegend"}}})],t.prototype,"legendEnabled",void 0),g([w(CM)],t.prototype,"popupEnabled",void 0),g([w({type:Mt})],t.prototype,"spatialReference",void 0),g([w({readOnly:!0})],t.prototype,"version",void 0),g([We("version",["currentVersion","capabilities","tables","supportedImageFormatTypes"])],t.prototype,"readVersion",null),t=g([te("esri.layers.mixins.ArcGISMapService")],t),t};var KI;function fO(e){return e&&e.type==="esriSMS"}function yO(e,t,i){var n;const r=this.originIdOf(t)>=qo(i.origin);return{ignoreOrigin:!0,allowNull:r,enabled:!!i&&((n=i.layer)==null?void 0:n.type)==="map-image"&&(i.writeSublayerStructure||r)}}function Fie(e,t,i){var r;return{enabled:!!i&&((r=i.layer)==null?void 0:r.type)==="tile"&&this._isOverridden(t)}}function Al(e,t,i){return{ignoreOrigin:!0,enabled:i&&i.writeSublayerStructure||!1}}function YI(e,t,i){return{ignoreOrigin:!0,enabled:!!i&&(i.writeSublayerStructure||this.originIdOf(t)>=qo(i.origin))}}let POe=0;const om=new Set;om.add("layer"),om.add("parent"),om.add("loaded"),om.add("loadStatus"),om.add("loadError"),om.add("loadWarnings");let Kt=KI=class extends ls(x2(rc(Xo))){constructor(e){super(e),this.capabilities=void 0,this.fields=null,this.fullExtent=null,this.geometryType=null,this.globalIdField=null,this.legendEnabled=!0,this.objectIdField=null,this.popupEnabled=!0,this.popupTemplate=null,this.sourceJSON=null,this.title=null,this.typeIdField=null,this.types=null}async load(e){return this.addResolvingPromise((async()=>{var i,r;if(!this.layer&&!this.url)throw new ue("sublayer:missing-layer","Sublayer can't be loaded without being part of a layer",{sublayer:this});let t=null;if(!this.layer||this.originIdOf("url")>ct.SERVICE||((i=this.source)==null?void 0:i.type)==="data-layer")t=(await Nt(this.url,K({responseType:"json",query:{f:"json"}},e))).data;else{let n=this.id;((r=this.source)==null?void 0:r.type)==="map-layer"&&(n=this.source.mapLayerId),t=await this.layer.fetchSublayerInfo(n,e)}t&&(this.sourceJSON=t,this.read({layerDefinition:t},{origin:"service"}))})()),this}readCapabilities(e,t){const i=(e=(t=t.layerDefinition||t).capabilities||e)?e.toLowerCase().split(",").map(o=>o.trim()):[],r=this.url?hf(this.url):null,n=i.includes(H(r)&&r.serverType==="MapServer"?"data":"query");return{exportMap:{supportsModification:!!t.canModifyLayer},operations:{supportsQuery:n}}}set definitionExpression(e){this._setAndNotifyLayer("definitionExpression",e)}get fieldsIndex(){return new bY(this.fields||[])}set floorInfo(e){this._setAndNotifyLayer("floorInfo",e)}readGlobalIdFieldFromService(e,t){if((t=t.layerDefinition||t).globalIdField)return t.globalIdField;if(t.fields){for(const i of t.fields)if(i.type==="esriFieldTypeGlobalID")return i.name}}get id(){const e=this._get("id");return e!=null?e:POe++}set id(e){this._get("id")!==e&&(this.get("layer.capabilities.exportMap.supportsDynamicLayers")!==!1?this._set("id",e):this._logLockedError("id","capability not available 'layer.capabilities.exportMap.supportsDynamicLayers'"))}set labelingInfo(e){this._setAndNotifyLayer("labelingInfo",e)}writeLabelingInfo(e,t,i,r){e&&e.length&&(t.layerDefinition={drawingInfo:{labelingInfo:e.map(n=>n.write({},r))}})}set labelsVisible(e){this._setAndNotifyLayer("labelsVisible",e)}set layer(e){this._set("layer",e),this.sublayers&&this.sublayers.forEach(t=>t.layer=e)}set listMode(e){this._set("listMode",e)}set minScale(e){this._setAndNotifyLayer("minScale",e)}readMinScale(e,t){return t.minScale||t.layerDefinition&&t.layerDefinition.minScale||0}set maxScale(e){this._setAndNotifyLayer("maxScale",e)}readMaxScale(e,t){return t.maxScale||t.layerDefinition&&t.layerDefinition.maxScale||0}get effectiveScaleRange(){const{minScale:e,maxScale:t}=this;return{minScale:e,maxScale:t}}readObjectIdFieldFromService(e,t){if((t=t.layerDefinition||t).objectIdField)return t.objectIdField;if(t.fields){for(const i of t.fields)if(i.type==="esriFieldTypeOID")return i.name}}set opacity(e){this._setAndNotifyLayer("opacity",e)}readOpacity(e,t){const i=t.layerDefinition;return 1-.01*(i.transparency!=null?i.transparency:i.drawingInfo.transparency)}writeOpacity(e,t,i,r){t.layerDefinition={drawingInfo:{transparency:100-100*e}}}writeParent(e,t){this.parent&&this.parent!==this.layer?t.parentLayerId=iS(this.parent.id):t.parentLayerId=-1}get defaultPopupTemplate(){return this.createPopupTemplate()}set renderer(e){if(e){for(const t of e.getSymbols())if(uc(t)){$e.getLogger(this.declaredClass).warn("Sublayer renderer should use 2D symbols");break}}this._setAndNotifyLayer("renderer",e)}get source(){return this._get("source")||new Vh({mapLayerId:this.id})}set source(e){this._setAndNotifyLayer("source",e)}set sublayers(e){this._handleSublayersChange(e,this._get("sublayers")),this._set("sublayers",e)}castSublayers(e){return Oi(Xe.ofType(KI),e)}writeSublayers(e,t,i){this.get("sublayers.length")&&(t[i]=this.sublayers.map(r=>r.id).toArray().reverse())}readTypeIdField(e,t){let i=(t=t.layerDefinition||t).typeIdField;if(i&&t.fields){i=i.toLowerCase();const r=t.fields.find(n=>n.name.toLowerCase()===i);r&&(i=r.name)}return i}get url(){var r,n;const e=(n=(r=this.layer)==null?void 0:r.parsedUrl)!=null?n:this._lastParsedUrl,t=this.source;if(!e)return null;if(this._lastParsedUrl=e,(t==null?void 0:t.type)==="map-layer")return`${e.path}/${t.mapLayerId}`;const i={layer:JSON.stringify({source:this.source})};return`${e.path}/dynamicLayer?${Td(i)}`}set url(e){this._overrideIfSome("url",e)}set visible(e){this._setAndNotifyLayer("visible",e)}writeVisible(e,t,i,r){t[i]=this.getAtOrigin("defaultVisibility","service")||e}clone(){const{store:e}=Rn(this),t=new KI;return Rn(t).store=e.clone(om),this.commitProperty("url"),t._lastParsedUrl=this._lastParsedUrl,t}createPopupTemplate(e){return MY(this,e)}createQuery(){return new co({returnGeometry:!0,where:this.definitionExpression||"1=1"})}async createFeatureLayer(){var i,r;if(this.hasOwnProperty("sublayers"))return null;const e=(i=this.layer)==null?void 0:i.parsedUrl,t=new(await Promise.resolve().then(function(){return d6e})).default({url:e.path});return e&&this.source&&(this.source.type==="map-layer"?t.layerId=this.source.mapLayerId:t.dynamicDataSource=this.source),this.layer.refreshInterval!=null&&(t.refreshInterval=this.layer.refreshInterval),this.definitionExpression&&(t.definitionExpression=this.definitionExpression),this.floorInfo&&(t.floorInfo=_e(this.floorInfo)),this.originIdOf("labelingInfo")>ct.SERVICE&&(t.labelingInfo=_e(this.labelingInfo)),this.originIdOf("labelsVisible")>ct.DEFAULTS&&(t.labelsVisible=this.labelsVisible),this.originIdOf("legendEnabled")>ct.DEFAULTS&&(t.legendEnabled=this.legendEnabled),this.originIdOf("visible")>ct.DEFAULTS&&(t.visible=this.visible),this.originIdOf("minScale")>ct.DEFAULTS&&(t.minScale=this.minScale),this.originIdOf("maxScale")>ct.DEFAULTS&&(t.maxScale=this.maxScale),this.originIdOf("opacity")>ct.DEFAULTS&&(t.opacity=this.opacity),this.originIdOf("popupTemplate")>ct.DEFAULTS&&(t.popupTemplate=_e(this.popupTemplate)),this.originIdOf("renderer")>ct.SERVICE&&(t.renderer=_e(this.renderer)),((r=this.source)==null?void 0:r.type)==="data-layer"&&(t.dynamicDataSource=this.source.clone()),this.originIdOf("title")>ct.DEFAULTS&&(t.title=this.title),this.layer.type==="map-image"&&this.layer.originIdOf("customParameters")>ct.DEFAULTS&&(t.customParameters=this.layer.customParameters),this.layer.type==="tile"&&this.layer.originIdOf("customParameters")>ct.DEFAULTS&&(t.customParameters=this.layer.customParameters),t}getField(e){return this.fieldsIndex.get(e)}getFeatureType(e){const{typeIdField:t,types:i}=this;if(!t||!e)return null;const r=e.attributes?e.attributes[t]:void 0;if(r==null)return null;let n=null;return i.some(o=>{const{id:c}=o;return c!=null&&(c.toString()===r.toString()&&(n=o),!!n)}),n}getFieldDomain(e,t){const i=t&&t.feature,r=this.getFeatureType(i);if(r){const n=r.domains&&r.domains[e];if(n&&n.type!=="inherited")return n}return this._getLayerDomain(e)}async queryFeatures(e=this.createQuery(),t){var c,h,m,b,x,I;if(await this.load(),!((h=(c=this.capabilities)==null?void 0:c.operations)==null?void 0:h.supportsQuery))throw new ue("Sublayer.queryFeatures","this layer doesn't support queries.");const[{executeQuery:i},{default:r}]=await Promise.all([Promise.resolve().then(function(){return TIe}),Promise.resolve().then(function(){return CIe})]),n=await i(this.url,co.from(e),(b=(m=this.layer)==null?void 0:m.spatialReference)!=null?b:null,Ce(K({},t),{query:Ce(K({},(x=this.layer)==null?void 0:x.customParameters),{token:(I=this.layer)==null?void 0:I.apiKey})})),o=r.fromJSON(n.data);if(o==null?void 0:o.features)for(const E of o.features)E.sourceLayer=this;return o}toExportImageJSON(e){var o;const t={id:this.id,source:((o=this.source)==null?void 0:o.toJSON())||{mapLayerId:this.id,type:"mapLayer"}},i=wM(e,this.definitionExpression);H(i)&&(t.definitionExpression=i);const r=["renderer","labelingInfo","opacity","labelsVisible"].reduce((c,h)=>(c[h]=this.originIdOf(h),c),{});if(Object.keys(r).some(c=>r[c]>ct.SERVICE)){const c=t.drawingInfo={};if(r.renderer>ct.SERVICE&&(c.renderer=this.renderer?this.renderer.toJSON():null),r.labelsVisible>ct.SERVICE&&(c.showLabels=this.labelsVisible),this.labelsVisible&&r.labelingInfo>ct.SERVICE){!this.loaded&&this.labelingInfo.some(m=>!m.labelPlacement)&&$e.getLogger(this.declaredClass).warnOnce(`A Sublayer (title: ${this.title}, id: ${this.id}) has an undefined 'labelPlacement' and so labels cannot be displayed. Either define a valid 'labelPlacement' or call Sublayer.load() to use a default value based on geometry type.`,{sublayer:this});let h=this.labelingInfo;H(this.geometryType)&&(h=YTe(this.labelingInfo,NS.toJSON(this.geometryType))),c.labelingInfo=h.filter(m=>m.labelPlacement).map(m=>m.toJSON({origin:"service",layer:this.layer})),c.showLabels=!0}r.opacity>ct.SERVICE&&(c.transparency=100-100*this.opacity),this._assignDefaultSymbolColors(c.renderer)}return t}_assignDefaultSymbolColors(e){this._forEachSimpleMarkerSymbols(e,t=>{t.color||t.style!=="esriSMSX"&&t.style!=="esriSMSCross"||(t.outline&&t.outline.color?t.color=t.outline.color:t.color=[0,0,0,0])})}_forEachSimpleMarkerSymbols(e,t){if(e){const i="uniqueValueInfos"in e?e.uniqueValueInfos:"classBreakInfos"in e?e.classBreakInfos:[];for(const r of i)fO(r.symbol)&&t(r.symbol);"symbol"in e&&fO(e.symbol)&&t(e.symbol),"defaultSymbol"in e&&fO(e.defaultSymbol)&&t(e.defaultSymbol)}}_setAndNotifyLayer(e,t){const i=this.layer,r=this._get(e);let n,o;switch(e){case"definitionExpression":case"floorInfo":n="supportsSublayerDefinitionExpression";case"minScale":case"maxScale":case"visible":n="supportsSublayerVisibility";break;case"labelingInfo":case"labelsVisible":case"opacity":case"renderer":case"source":n="supportsDynamicLayers",o="supportsModification"}const c=Rn(this).getDefaultOrigin();if(c!=="service"){if(n&&this.get(`layer.capabilities.exportMap.${n}`)===!1)return void this._logLockedError(e,`capability not available 'layer.capabilities.exportMap.${n}'`);if(o&&this.get(`capabilities.exportMap.${o}`)===!1)return void this._logLockedError(e,`capability not available 'capabilities.exportMap.${o}'`)}e!=="source"||this.loadStatus==="not-loaded"?(this._set(e,t),c!=="service"&&r!==t&&i&&i.emit&&i.emit("sublayer-update",{propertyName:e,target:this})):this._logLockedError(e,"'source' can't be changed after calling sublayer.load()")}_handleSublayersChange(e,t){t&&(t.forEach(i=>{i.parent=null,i.layer=null}),this.handles.removeAll()),e&&(e.forEach(i=>{i.parent=this,i.layer=this.layer}),this.handles.add([e.on("after-add",({item:i})=>{i.parent=this,i.layer=this.layer}),e.on("after-remove",({item:i})=>{i.parent=null,i.layer=null}),e.on("before-changes",i=>{const r=this.get("layer.capabilities.exportMap.supportsSublayersChanges");r==null||r||($e.getLogger(this.declaredClass).error(new ue("sublayer:sublayers-non-modifiable","Sublayer can't be added, moved, or removed from the layer's sublayers",{sublayer:this,layer:this.layer})),i.preventDefault())})]))}_logLockedError(e,t){$e.getLogger(this.declaredClass).error(new ue("sublayer:locked",`Property '${String(e)}' can't be changed on Sublayer from the layer '${this.layer.id}'`,{reason:t,sublayer:this,layer:this.layer}))}_getLayerDomain(e){const t=this.fieldsIndex.get(e);return t?t.domain:null}};Kt.test={isMapImageLayerOverridePolicy:e=>e===Al||e===yO,isTileImageLayerOverridePolicy:e=>e===Fie},g([w({readOnly:!0})],Kt.prototype,"capabilities",void 0),g([We("service","capabilities",["layerDefinition.canModifyLayer","layerDefinition.capabilities"])],Kt.prototype,"readCapabilities",null),g([w({type:String,value:null,json:{name:"layerDefinition.definitionExpression",write:{allowNull:!0,overridePolicy:yO}}})],Kt.prototype,"definitionExpression",null),g([w({type:[u1],json:{origins:{service:{read:{source:"layerDefinition.fields"}}}}})],Kt.prototype,"fields",void 0),g([w({readOnly:!0})],Kt.prototype,"fieldsIndex",null),g([w({type:HK,value:null,json:{name:"layerDefinition.floorInfo",read:{source:"layerDefinition.floorInfo"},write:{target:"layerDefinition.floorInfo",overridePolicy:yO},origins:{"web-scene":{read:!1,write:!1}}}})],Kt.prototype,"floorInfo",null),g([w({type:gi,json:{read:{source:"layerDefinition.extent"}}})],Kt.prototype,"fullExtent",void 0),g([w({type:NS.apiValues,json:{origins:{service:{name:"layerDefinition.geometryType",read:{reader:NS.read}}}}})],Kt.prototype,"geometryType",void 0),g([w({type:String})],Kt.prototype,"globalIdField",void 0),g([We("service","globalIdField",["layerDefinition.globalIdField","layerDefinition.fields"])],Kt.prototype,"readGlobalIdFieldFromService",null),g([w({type:Ri,json:{write:{ignoreOrigin:!0}}})],Kt.prototype,"id",null),g([w({value:null,type:[C2],json:{read:{source:"layerDefinition.drawingInfo.labelingInfo"},write:{target:"layerDefinition.drawingInfo.labelingInfo",overridePolicy:Al}}})],Kt.prototype,"labelingInfo",null),g([tt("labelingInfo")],Kt.prototype,"writeLabelingInfo",null),g([w({type:Boolean,value:!0,json:{read:{source:"layerDefinition.drawingInfo.showLabels"},write:{target:"layerDefinition.drawingInfo.showLabels",overridePolicy:Al}}})],Kt.prototype,"labelsVisible",null),g([w({value:null})],Kt.prototype,"layer",null),g([w({type:Boolean,value:!0,json:{origins:{service:{read:{enabled:!1}}},read:{source:"showLegend"},write:{target:"showLegend",overridePolicy:YI}}})],Kt.prototype,"legendEnabled",void 0),g([w({type:["show","hide","hide-children"],value:"show",json:{read:!1,write:!1,origins:{"web-scene":{read:!0,write:!0}}}})],Kt.prototype,"listMode",null),g([w({type:Number,value:0,json:{write:{overridePolicy:Al}}})],Kt.prototype,"minScale",null),g([We("minScale",["minScale","layerDefinition.minScale"])],Kt.prototype,"readMinScale",null),g([w({type:Number,value:0,json:{write:{overridePolicy:Al}}})],Kt.prototype,"maxScale",null),g([We("maxScale",["maxScale","layerDefinition.maxScale"])],Kt.prototype,"readMaxScale",null),g([w({readOnly:!0})],Kt.prototype,"effectiveScaleRange",null),g([w({type:String})],Kt.prototype,"objectIdField",void 0),g([We("service","objectIdField",["layerDefinition.objectIdField","layerDefinition.fields"])],Kt.prototype,"readObjectIdFieldFromService",null),g([w({type:Number,value:1,json:{write:{target:"layerDefinition.drawingInfo.transparency",overridePolicy:Al}}})],Kt.prototype,"opacity",null),g([We("opacity",["layerDefinition.drawingInfo.transparency","layerDefinition.transparency"])],Kt.prototype,"readOpacity",null),g([tt("opacity")],Kt.prototype,"writeOpacity",null),g([w({json:{type:Ri,write:{target:"parentLayerId",writerEnsuresNonNull:!0,overridePolicy:Al}}})],Kt.prototype,"parent",void 0),g([tt("parent")],Kt.prototype,"writeParent",null),g([w({type:Boolean,value:!0,json:{read:{source:"disablePopup",reader:(e,t)=>!t.disablePopup},write:{target:"disablePopup",overridePolicy:YI,writer(e,t,i){t[i]=!e}}}})],Kt.prototype,"popupEnabled",void 0),g([w({type:_d,json:{read:{source:"popupInfo"},write:{target:"popupInfo",overridePolicy:YI}}})],Kt.prototype,"popupTemplate",void 0),g([w({readOnly:!0})],Kt.prototype,"defaultPopupTemplate",null),g([w({types:w2,value:null,json:{name:"layerDefinition.drawingInfo.renderer",write:{overridePolicy:Al},origins:{"web-scene":{types:cK,name:"layerDefinition.drawingInfo.renderer",write:{overridePolicy:Al}}}}})],Kt.prototype,"renderer",null),g([w({types:{key:"type",base:null,typeMap:{"data-layer":Ba,"map-layer":Vh}},cast(e){if(e){if("mapLayerId"in e)return Xm(Vh,e);if("dataSource"in e)return Xm(Ba,e)}return e},json:{name:"layerDefinition.source",write:{overridePolicy:Al}}})],Kt.prototype,"source",null),g([w()],Kt.prototype,"sourceJSON",void 0),g([w({value:null,json:{type:[Ri],write:{target:"subLayerIds",allowNull:!0,overridePolicy:Al}}})],Kt.prototype,"sublayers",null),g([Dt("sublayers")],Kt.prototype,"castSublayers",null),g([tt("sublayers")],Kt.prototype,"writeSublayers",null),g([w({type:String,json:{name:"name",write:{overridePolicy:YI}}})],Kt.prototype,"title",void 0),g([w({type:String})],Kt.prototype,"typeIdField",void 0),g([We("typeIdField",["layerDefinition.typeIdField"])],Kt.prototype,"readTypeIdField",null),g([w({type:[wP],json:{origins:{service:{read:{source:"layerDefinition.types"}}}}})],Kt.prototype,"types",void 0),g([w({type:String,json:{read:{source:"layerUrl"},write:{target:"layerUrl",overridePolicy:Fie}}})],Kt.prototype,"url",null),g([w({type:Boolean,value:!0,json:{read:{source:"defaultVisibility"},write:{target:"defaultVisibility",overridePolicy:Al}}})],Kt.prototype,"visible",null),g([tt("visible")],Kt.prototype,"writeVisible",null),Kt=KI=g([te("esri.layers.support.Sublayer")],Kt);const _3=Kt;function Nie(e,t,i){return t.flatten(({sublayers:n})=>n).length!==e.length?!0:!!e.some(n=>n.originIdOf("minScale")>i||n.originIdOf("maxScale")>i||n.originIdOf("renderer")>i||n.originIdOf("labelingInfo")>i||n.originIdOf("opacity")>i||n.originIdOf("labelsVisible")>i||n.originIdOf("source")>i)||!jie(e,t)}function Die(e,t,i){return!!e.some(r=>{const n=r.source;return!(!n||n.type==="map-layer"&&n.mapLayerId===r.id&&(ce(n.gdbVersion)||n.gdbVersion===i))||r.originIdOf("renderer")>ct.SERVICE||r.originIdOf("labelingInfo")>ct.SERVICE||r.originIdOf("opacity")>ct.SERVICE||r.originIdOf("labelsVisible")>ct.SERVICE})||!jie(e,t)}function jie(e,t){if(!e||!e.length||ce(t))return!0;const i=t.slice().reverse().flatten(({sublayers:o})=>o&&o.toArray().reverse()).map(o=>o.id).toArray();if(e.length>i.length)return!1;let r=0;const n=i.length;for(const{id:o}of e){for(;r<n&&i[r]!==o;)r++;if(r>=n)return!1}return!0}function LOe(e){return!!e&&e.some(t=>t.minScale!=null||t.layerDefinition&&t.layerDefinition.minScale!=null)}const OOe=$e.getLogger("esri.layers.TileLayer");function ROe(e,t){const i=[],r={};return e&&e.forEach(n=>{const o=new _3;if(o.read(n,t),r[o.id]=o,n.parentLayerId!=null&&n.parentLayerId!==-1){const c=r[n.parentLayerId];c.sublayers||(c.sublayers=[]),c.sublayers.unshift(o)}else i.unshift(o)}),i}const mO=Xe.ofType(_3);function Vie(e,t){e&&e.forEach(i=>{t(i),i.sublayers&&i.sublayers.length&&Vie(i.sublayers,t)})}const zie=e=>{let t=class extends e{constructor(...i){super(...i),this.allSublayers=new Dg({getCollections:()=>[this.sublayers],getChildrenFunction:r=>r.sublayers}),this.sublayersSourceJSON={[ct.SERVICE]:{},[ct.PORTAL_ITEM]:{},[ct.WEB_SCENE]:{},[ct.WEB_MAP]:{}},this.addHandles(we(()=>this.sublayers,(r,n)=>this._handleSublayersChange(r,n),mu))}readSublayers(i,r){if(!r||!i)return;const{sublayersSourceJSON:n}=this,o=qo(r.origin);if(o<ct.SERVICE||(n[o]={context:r,visibleLayers:i.visibleLayers||n[o].visibleLayers,layers:i.layers||n[o].layers},o>ct.SERVICE))return;this._set("serviceSublayers",this.createSublayersForOrigin("service").sublayers);const{sublayers:c,origin:h}=this.createSublayersForOrigin("web-document"),m=Rn(this);m.setDefaultOrigin(h),this._set("sublayers",new mO(c)),m.setDefaultOrigin("user")}findSublayerById(i){return this.allSublayers.find(r=>r.id===i)}createServiceSublayers(){return this.createSublayersForOrigin("service").sublayers}createSublayersForOrigin(i){const r=qo(i==="web-document"?"web-map":i);let n=ct.SERVICE,o=this.sublayersSourceJSON[ct.SERVICE].layers,c=this.sublayersSourceJSON[ct.SERVICE].context,h=null;const m=[ct.PORTAL_ITEM,ct.WEB_SCENE,ct.WEB_MAP].filter(P=>P<=r);for(const P of m){const F=this.sublayersSourceJSON[P];LOe(F.layers)&&(n=P,o=F.layers,c=F.context,F.visibleLayers&&(h={visibleLayers:F.visibleLayers,context:F.context}))}const b=[ct.PORTAL_ITEM,ct.WEB_SCENE,ct.WEB_MAP].filter(P=>P>n&&P<=r);let x=null;for(const P of b){const{layers:F,visibleLayers:N,context:B}=this.sublayersSourceJSON[P];F&&(x={layers:F,context:B}),N&&(h={visibleLayers:N,context:B})}const I=ROe(o,c),E=new Map,k=new Set;if(x)for(const P of x.layers)E.set(P.id,P);if(h)for(const P of h.visibleLayers)k.add(P);return Vie(I,P=>{x&&P.read(E.get(P.id),x.context),h&&P.read({defaultVisibility:k.has(P.id)},h.context)}),{origin:ow(n),sublayers:new mO({items:I})}}read(i,r){super.read(i,r),this.readSublayers(i,r)}_handleSublayersChange(i,r){r&&(r.forEach(n=>{n.parent=null,n.layer=null}),this.handles.remove("sublayers-owner")),i&&(i.forEach(n=>{n.parent=this,n.layer=this}),this.handles.add([i.on("after-add",({item:n})=>{n.parent=this,n.layer=this}),i.on("after-remove",({item:n})=>{n.parent=null,n.layer=null})],"sublayers-owner"),this.type==="tile"&&this.handles.add(i.on("before-changes",n=>{OOe.error(new ue("tilelayer:sublayers-non-modifiable","ISublayer can't be added, moved, or removed from the layer's sublayers",{layer:this})),n.preventDefault()}),"sublayers-owner"))}};return g([w({readOnly:!0})],t.prototype,"allSublayers",void 0),g([w({readOnly:!0,type:Xe.ofType(_3)})],t.prototype,"serviceSublayers",void 0),g([w({value:null,type:mO,json:{read:!1,write:{allowNull:!0,ignoreOrigin:!0}}})],t.prototype,"sublayers",void 0),g([w({readOnly:!0})],t.prototype,"sublayersSourceJSON",void 0),t=g([te("esri.layers.mixins.SublayersOwner")],t),t};function FOe(e){var i;const t=e.layer;return"floorInfo"in t&&((i=t.floorInfo)==null?void 0:i.floorField)&&"floors"in e.view?Gie(e.view.floors,t.floorInfo.floorField):null}function XI(e,t){var i;return"floorInfo"in t&&((i=t.floorInfo)==null?void 0:i.floorField)?Gie(e,t.floorInfo.floorField):null}function Gie(e,t){if(!(e==null?void 0:e.length))return null;const i=e.filter(r=>r!=="").map(r=>`'${r}'`);return i.push("''"),`${t} IN (${i.join(",")}) OR ${t} IS NULL`}const NOe={visible:"visibleSublayers",definitionExpression:"layerDefs",labelingInfo:"hasDynamicLayers",labelsVisible:"hasDynamicLayers",opacity:"hasDynamicLayers",minScale:"visibleSublayers",maxScale:"visibleSublayers",renderer:"hasDynamicLayers",source:"hasDynamicLayers"};let ba=class extends ls(Ye){constructor(e){super(e),this.floors=null,this.scale=0}destroy(){this.layer=null}get dynamicLayers(){if(!this.hasDynamicLayers)return null;const e=this.visibleSublayers.map(t=>{const i=XI(this.floors,t);return t.toExportImageJSON(i)});return e.length?JSON.stringify(e):null}get hasDynamicLayers(){return this.layer&&Die(this.visibleSublayers,this.layer.serviceSublayers,this.layer.gdbVersion)}set layer(e){this._get("layer")!==e&&(this._set("layer",e),this.handles.remove("layer"),e&&this.handles.add([e.allSublayers.on("change",()=>this.notifyChange("visibleSublayers")),e.on("sublayer-update",t=>this.notifyChange(NOe[t.propertyName]))],"layer"))}get layers(){const e=this.visibleSublayers;return e?e.length?"show:"+e.map(t=>t.id).join(","):"show:-1":null}get layerDefs(){var i;const e=!!((i=this.floors)==null?void 0:i.length),t=this.visibleSublayers.filter(r=>r.definitionExpression!=null||e&&r.floorInfo!=null);return t.length?JSON.stringify(t.reduce((r,n)=>{const o=XI(this.floors,n),c=wM(o,n.definitionExpression);return H(c)&&(r[n.id]=c),r},{})):null}get version(){this.commitProperty("layers"),this.commitProperty("layerDefs"),this.commitProperty("dynamicLayers"),this.commitProperty("timeExtent");const e=this.layer;return e&&(e.commitProperty("dpi"),e.commitProperty("imageFormat"),e.commitProperty("imageTransparency"),e.commitProperty("gdbVersion")),(this._get("version")||0)+1}get visibleSublayers(){const e=[];if(!this.layer)return e;const t=this.layer.sublayers,i=n=>{const o=this.scale,c=o===0,h=n.minScale===0||o<=n.minScale,m=n.maxScale===0||o>=n.maxScale;n.visible&&(c||h&&m)&&(n.sublayers?n.sublayers.forEach(i):e.unshift(n))};t&&t.forEach(i);const r=this._get("visibleSublayers");return!r||r.length!==e.length||r.some((n,o)=>e[o]!==n)?e:r}toJSON(){const e=this.layer;let t={dpi:e.dpi,format:e.imageFormat,transparent:e.imageTransparency,gdbVersion:e.gdbVersion||null};return this.hasDynamicLayers&&this.dynamicLayers?t.dynamicLayers=this.dynamicLayers:t=Ce(K({},t),{layers:this.layers,layerDefs:this.layerDefs}),t}};g([w({readOnly:!0})],ba.prototype,"dynamicLayers",null),g([w()],ba.prototype,"floors",void 0),g([w({readOnly:!0})],ba.prototype,"hasDynamicLayers",null),g([w()],ba.prototype,"layer",null),g([w({readOnly:!0})],ba.prototype,"layers",null),g([w({readOnly:!0})],ba.prototype,"layerDefs",null),g([w({type:Number})],ba.prototype,"scale",void 0),g([w(mEe)],ba.prototype,"timeExtent",void 0),g([w({readOnly:!0})],ba.prototype,"version",null),g([w({readOnly:!0})],ba.prototype,"visibleSublayers",null),ba=g([te("esri.layers.mixins.ExportImageParameters")],ba);let Tn=class extends $M(yY(DM(zie(Rie(N8(uP(dP(x2(yP(O8(D8(ls(Y0))))))))))))){constructor(...e){super(...e),this.datesInUnknownTimezone=!1,this.dpi=96,this.gdbVersion=null,this.imageFormat="png24",this.imageMaxHeight=2048,this.imageMaxWidth=2048,this.imageTransparency=!0,this.isReference=null,this.labelsVisible=!1,this.operationalLayerType="ArcGISMapServiceLayer",this.sourceJSON=null,this.sublayers=null,this.type="map-image",this.url=null}normalizeCtorArgs(e,t){return typeof e=="string"?K({url:e},t):e}load(e){const t=H(e)?e.signal:null;return this.addResolvingPromise(this.loadFromPortal({supportedTypes:["Map Service"]},e).catch(f0).then(()=>this._fetchService(t))),Promise.resolve(this)}readImageFormat(e,t){const i=t.supportedImageFormatTypes;return i&&i.includes("PNG32")?"png32":"png24"}writeSublayers(e,t,i,r){if(!this.loaded||!e)return;const n=e.slice().reverse().flatten(({sublayers:b})=>b&&b.toArray().reverse()).toArray();let o=!1;if(this.capabilities&&this.capabilities.operations.supportsExportMap&&this.capabilities.exportMap.supportsDynamicLayers){const b=qo(r.origin);if(b===ct.PORTAL_ITEM){const x=this.createSublayersForOrigin("service").sublayers;o=Nie(n,x,ct.SERVICE)}else if(b>ct.PORTAL_ITEM){const x=this.createSublayersForOrigin("portal-item");o=Nie(n,x.sublayers,qo(x.origin))}}const c=[],h=K({writeSublayerStructure:o},r);let m=o;n.forEach(b=>{const x=b.write({},h);c.push(x),m=m||b.originOf("visible")==="user"}),c.some(b=>Object.keys(b).length>1)&&(t.layers=c),m&&(t.visibleLayers=n.filter(b=>b.visible).map(b=>b.id))}createExportImageParameters(e,t,i,r){const n=r&&r.pixelRatio||1;e&&this.version>=10&&(e=e.clone().shiftCentralMeridian());const o=new ba({layer:this,floors:r==null?void 0:r.floors,scale:Oie({extent:e,width:t})*n}),c=o.toJSON();o.destroy();const h=!r||!r.rotation||this.version<10.3?{}:{rotation:-r.rotation},m=e&&e.spatialReference,b=m.wkid||JSON.stringify(m.toJSON());c.dpi*=n;const x={};if(r==null?void 0:r.timeExtent){const{start:I,end:E}=r.timeExtent.toJSON();x.time=I&&E&&I===E?""+I:`${I!=null?I:"null"},${E!=null?E:"null"}`}else this.timeInfo&&!this.timeInfo.hasLiveData&&(x.time="null,null");return K(K(K({bbox:e&&e.xmin+","+e.ymin+","+e.xmax+","+e.ymax,bboxSR:b,imageSR:b,size:t+","+i},c),h),x)}async fetchImage(e,t,i,r){return this._fetchImage("image",e,t,i,r)}async fetchImageBitmap(e,t,i,r){const n=await this._fetchImage("blob",e,t,i,r);return createImageBitmap(n)}async fetchRecomputedExtents(e={}){const t=Ce(K({},e),{query:Ce(K({returnUpdates:!0,f:"json"},this.customParameters),{token:this.apiKey})}),{data:i}=await Nt(this.url,t),{extent:r,fullExtent:n,timeExtent:o}=i,c=r||n;return{fullExtent:c&&gi.fromJSON(c),timeExtent:o&&qa.fromJSON({start:o[0],end:o[1]})}}loadAll(){return ok(this,e=>{e(this.allSublayers)})}serviceSupportsSpatialReference(e){return SY(this,e)}async _fetchImage(e,t,i,r,n){var h;const o={responseType:e,signal:(h=n==null?void 0:n.signal)!=null?h:null,query:Ce(K(K(Ce(K(K({},this.parsedUrl.query),this.createExportImageParameters(t,i,r,n)),{f:"image"}),this.refreshParameters),this.customParameters),{token:this.apiKey})},c=this.parsedUrl.path+"/export";if(o.query.dynamicLayers!=null&&!this.capabilities.exportMap.supportsDynamicLayers)throw new ue("mapimagelayer:dynamiclayer-not-supported",`service ${this.url} doesn't support dynamic layers, which is required to be able to change the sublayer's order, rendering, labeling or source.`,{query:o.query});try{const{data:m}=await Nt(c,o);return m}catch(m){throw Xn(m)?m:new ue("mapimagelayer:image-fetch-error",`Unable to load image: ${c}`,{error:m})}}async _fetchService(e){if(this.sourceJSON)return void this.read(this.sourceJSON,{origin:"service",url:this.parsedUrl});const{data:t,ssl:i}=await Nt(this.parsedUrl.path,{query:Ce(K(K({f:"json"},this.parsedUrl.query),this.customParameters),{token:this.apiKey}),signal:e});i&&(this.url=this.url.replace(/^http:/i,"https:")),this.sourceJSON=t,this.read(t,{origin:"service",url:this.parsedUrl})}};g([w({type:Boolean})],Tn.prototype,"datesInUnknownTimezone",void 0),g([w()],Tn.prototype,"dpi",void 0),g([w()],Tn.prototype,"gdbVersion",void 0),g([w()],Tn.prototype,"imageFormat",void 0),g([We("imageFormat",["supportedImageFormatTypes"])],Tn.prototype,"readImageFormat",null),g([w({json:{origins:{service:{read:{source:"maxImageHeight"}}}}})],Tn.prototype,"imageMaxHeight",void 0),g([w({json:{origins:{service:{read:{source:"maxImageWidth"}}}}})],Tn.prototype,"imageMaxWidth",void 0),g([w()],Tn.prototype,"imageTransparency",void 0),g([w({type:Boolean,json:{read:!1,write:{enabled:!0,overridePolicy:()=>({enabled:!1})}}})],Tn.prototype,"isReference",void 0),g([w({json:{read:!1,write:!1}})],Tn.prototype,"labelsVisible",void 0),g([w({type:["ArcGISMapServiceLayer"]})],Tn.prototype,"operationalLayerType",void 0),g([w({json:{read:!1,write:!1}})],Tn.prototype,"popupEnabled",void 0),g([w()],Tn.prototype,"sourceJSON",void 0),g([w({json:{write:{ignoreOrigin:!0}}})],Tn.prototype,"sublayers",void 0),g([tt("sublayers",{layers:{type:[_3]},visibleLayers:{type:[Ri]}})],Tn.prototype,"writeSublayers",null),g([w({type:["show","hide","hide-children"]})],Tn.prototype,"listMode",void 0),g([w({json:{read:!1},readOnly:!0,value:"map-image"})],Tn.prototype,"type",void 0),g([w(H8)],Tn.prototype,"url",void 0),Tn=g([te("esri.layers.MapImageLayer")],Tn);const DOe=Tn;var jOe=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",default:DOe});const VOe=new kt({9001:"meters",9002:"feet",9036:"kilometers",9093:"miles",109012:"nautical-miles",109001:"yards"});let bp=class extends ke{constructor(e){super(e),this.bufferSpatialReference=null,this.distances=null,this.geodesic=!1,this.geometries=null,this.outSpatialReference=null,this.unionResults=!1,this.unit=null}toJSON(){const e={unit:VOe.toJSON(this.unit),unionResults:this.unionResults,geodesic:this.geodesic},t=this.distances,i=this.outSpatialReference,r=this.bufferSpatialReference,n=this.geometries;if(n&&n.length>0){const o=n.map(h=>(h=h.type==="extent"?es.fromExtent(h):h).toJSON()),c=n[0].type==="extent"?"esriGeometryPolygon":bh(n[0]);e.geometries=JSON.stringify({geometryType:c,geometries:o}),e.inSR=n[0].spatialReference.wkid?n[0].spatialReference.wkid:JSON.stringify(n[0].spatialReference.toJSON())}return t&&(e.distances=t.join(",")),i&&(e.outSR=i.wkid?i.wkid:JSON.stringify(i.toJSON())),r&&(e.bufferSR=r.wkid?r.wkid:JSON.stringify(r.toJSON())),e}};g([w({type:Mt,json:{write:!0}})],bp.prototype,"bufferSpatialReference",void 0),g([w({type:[Number],json:{write:!0}})],bp.prototype,"distances",void 0),g([w({type:Boolean,json:{write:!0}})],bp.prototype,"geodesic",void 0),g([w({types:[wh],json:{write:!0}})],bp.prototype,"geometries",void 0),g([w({type:Mt,json:{write:!0}})],bp.prototype,"outSpatialReference",void 0),g([w({type:Boolean,json:{write:!0}})],bp.prototype,"unionResults",void 0),g([w({type:String,json:{write:!0}})],bp.prototype,"unit",void 0),bp=g([te("esri.rest.support.BufferParameters")],bp);let jo=class extends ke{constructor(e){super(e),this.contains=!0,this.dynamicLayerInfos=null,this.gdbVersion=null,this.geometryPrecision=null,this.layerDefinitions=null,this.layerIds=null,this.maxAllowableOffset=null,this.outSpatialReference=null,this.returnGeometry=!1,this.searchFields=null,this.searchText=null}};g([w({type:Boolean,json:{write:{enabled:!0,isRequired:!0}}})],jo.prototype,"contains",void 0),g([w({type:[Object],json:{read:{source:"dynamicLayers"},write:{target:"dynamicLayers"}}})],jo.prototype,"dynamicLayerInfos",void 0),g([w({type:String,json:{write:!0}})],jo.prototype,"gdbVersion",void 0),g([w({type:Number,json:{write:!0}})],jo.prototype,"geometryPrecision",void 0),g([w({type:[Object],json:{write:!0}})],jo.prototype,"layerDefinitions",void 0),g([w({type:[Number],json:{write:!0}})],jo.prototype,"layerIds",void 0),g([w({type:Number,json:{write:!0}})],jo.prototype,"maxAllowableOffset",void 0),g([w({type:Mt,json:{read:{source:"outSR"},write:{target:"outSR"}}})],jo.prototype,"outSpatialReference",void 0),g([w({type:Boolean,json:{write:{enabled:!0,isRequired:!0}}})],jo.prototype,"returnGeometry",void 0),g([w({type:[String],json:{write:!0}})],jo.prototype,"searchFields",void 0),g([w({type:String,json:{write:!0}})],jo.prototype,"searchText",void 0),jo=g([te("esri.rest.support.FindParameters")],jo),jo.from=Oi(jo);let wa=class extends Ye{constructor(e){super(e),this.attributionVisible=!0,this.exportOptions={width:800,height:1100,dpi:96},this.forceFeatureAttributes=!1,this.format="png32",this.label=null,this.layout="map-only",this.layoutItem=null,this.layoutOptions=null,this.outScale=0,this.scalePreserved=!0,this.showLabels=!0}};g([w()],wa.prototype,"attributionVisible",void 0),g([w()],wa.prototype,"exportOptions",void 0),g([w()],wa.prototype,"forceFeatureAttributes",void 0),g([w()],wa.prototype,"format",void 0),g([w()],wa.prototype,"label",void 0),g([w()],wa.prototype,"layout",void 0),g([w({type:b_})],wa.prototype,"layoutItem",void 0),g([w()],wa.prototype,"layoutOptions",void 0),g([w()],wa.prototype,"outScale",void 0),g([w()],wa.prototype,"scalePreserved",void 0),g([w()],wa.prototype,"showLabels",void 0),wa=g([te("esri.rest.support.PrintTemplate")],wa);const Bie=wa;let wp=class extends Ye{constructor(e){super(e),this.extent=null,this.extraParameters=null,this.outSpatialReference=null,this.template=null,this.updateDelay=1e3,this.view=null}};g([w()],wp.prototype,"extent",void 0),g([w()],wp.prototype,"extraParameters",void 0),g([w()],wp.prototype,"outSpatialReference",void 0),g([w()],wp.prototype,"template",void 0),g([w()],wp.prototype,"updateDelay",void 0),g([w()],wp.prototype,"view",void 0),wp=g([te("esri.rest.support.PrintParameters")],wp);const zOe=wp,Uie=new kt({esriMeters:"meters",esriFeet:"feet",esriKilometers:"kilometers",esriMiles:"miles",esriNauticalMiles:"nautical-miles",esriYards:"yards"},{ignoreUnknown:!1});let x3=class extends ke{constructor(e){super(e),this.distance=0,this.units=null}};g([w({json:{write:!0}})],x3.prototype,"distance",void 0),g([w({json:{read:Uie.read,write:Uie.write}})],x3.prototype,"units",void 0),x3=g([te("esri.rest.support.LinearUnit")],x3);const qie=x3;function gO(e){switch(e){case Yi.SUPPORTED:break;case Yi.GRAPHICS_LAYER_MISSING:return"not owned by a graphics layer";case Yi.GEOMETRY_MISSING:return"no geometry";case Yi.GEOMETRY_TYPE_UNSUPPORTED:return"the geometry type is not supported";case Yi.ELEVATION_MODE_UNSUPPORTED:return"the elevation mode is not supported";case Yi.SYMBOL_TYPE_UNSUPPORTED:return"the symbol type is not supported"}return""}var Yi;(function(e){e[e.SUPPORTED=0]="SUPPORTED",e[e.GRAPHICS_LAYER_MISSING=1]="GRAPHICS_LAYER_MISSING",e[e.GEOMETRY_MISSING=2]="GEOMETRY_MISSING",e[e.GEOMETRY_TYPE_UNSUPPORTED=3]="GEOMETRY_TYPE_UNSUPPORTED",e[e.ELEVATION_MODE_UNSUPPORTED=4]="ELEVATION_MODE_UNSUPPORTED",e[e.SYMBOL_TYPE_UNSUPPORTED=5]="SYMBOL_TYPE_UNSUPPORTED"})(Yi||(Yi={}));function GOe(e){var t;if(((t=e.layer)==null?void 0:t.type)!=="graphics")return Yi.GRAPHICS_LAYER_MISSING;if(ce(e.geometry))return Yi.GEOMETRY_MISSING;switch(e.geometry.type){case"polygon":case"point":case"polyline":case"mesh":break;default:return Yi.GEOMETRY_TYPE_UNSUPPORTED}return EI(e)!=="on-the-ground"&&zL(e)?Yi.ELEVATION_MODE_UNSUPPORTED:Yi.SUPPORTED}function Hie(e){if(!e)return null;if(PS(e)&&e.wkid){const t=a3e[e.wkid];if(t)return t}if(e.wkt){const t=BOe(e.wkt);if(t)return t}return null}function BOe(e){const t=s3e.exec(e);if(!t||t.length!==2)return null;const i=t[1].split(",");if(!i||i.length<3)return null;const r=parseFloat(i[1]),n=parseFloat(i[2]);return isNaN(r)||isNaN(n)?null:{a:r,f:n===0?0:1/n}}function QI(e){const t=Hie(e!=null?e:Mt.WGS84);if(UOe(t))return t;const i=t.a*(1-t.f);return Object.assign(t,{b:i,eSq:1-(i/t.a)**2,radius:(2*t.a+i)/3,densificationRatio:1e4/((2*t.a+i)/3)})}function UOe(e){return e!=null&&"b"in e&&"eSq"in e&&"radius"in e}function e4(e,t,i){const{a:r,eSq:n}=QI(i),o=Math.sqrt(n),c=Math.sin(t[1]*oa),h=r*t[0]*oa;let m;return n>0?m=r*((1-n)*(c/(1-n*(c*c))-1/(2*o)*Math.log((1-o*c)/(1+o*c))))*.5:m=r*c,e[0]=h,e[1]=m,e}function t4(e){return Hie(e)!==null}function EYe(e,t="square-meters"){if(e.some(c=>!t4(c.spatialReference)))throw new ue("geodesic-areas:invalid-spatial-reference","the input geometries spatial reference is not supported");const i=[];for(let c=0;c<e.length;c++){const h=e[c],m=h.spatialReference,{radius:b,densificationRatio:x}=QI(m),I=b*x;i.push(HOe(h,I))}const r=[],n=[0,0],o=[0,0];for(let c=0;c<i.length;c++){const{rings:h,spatialReference:m}=i[c];let b=0;for(let x=0;x<h.length;x++){const I=h[x];e4(n,I[0],m),e4(o,I[I.length-1],m);let E=o[0]*n[1]-n[0]*o[1];for(let k=0;k<I.length-1;k++)e4(n,I[k+1],m),e4(o,I[k],m),E+=o[0]*n[1]-n[0]*o[1];b+=E}b=ji(b,"square-meters",t),r.push(b/-2)}return r}function qOe(e,t="meters"){if(!e)throw new ue("geodesic-lengths:invalid-geometries","the input geometries type is not supported");if(e.some(r=>!t4(r.spatialReference)))throw new ue("geodesic-lengths:invalid-spatial-reference","the input geometries spatial reference is not supported");const i=[];for(let r=0;r<e.length;r++){const n=e[r],{spatialReference:o}=n,c=n.type==="polyline"?n.paths:n.rings;let h=0;for(let m=0;m<c.length;m++){const b=c[m];let x=0;for(let I=1;I<b.length;I++){const E=b[I-1][0],k=b[I][0],P=b[I-1][1],F=b[I][1];if(P!==F||E!==k){const N=new Wie;Jie(N,[E,P],[k,F],o),x+=N.distance}}h+=x}h=ji(h,"meters",t),i.push(h)}return i}function HOe(e,t){if(e.type!=="polyline"&&e.type!=="polygon")throw new ue("geodesic-densify:invalid-geometry","the input geometry is neither polyline nor polygon");const{spatialReference:i}=e;if(!t4(i))throw new ue("geodesic-densify:invalid-spatial-reference","the input geometry spatial reference is not supported");const r=e.type==="polyline"?e.paths:e.rings,n=[],o=[0,0],c=new Wie;for(const h of r){const m=[];n.push(m),m.push([h[0][0],h[0][1]]);let b,x,I=h[0][0],E=h[0][1];for(let k=0;k<h.length-1;k++){if(b=h[k+1][0],x=h[k+1][1],I===b&&E===x)continue;const P=[I,E];Jie(c,[I,E],[b,x],i);const{azimuth:F,distance:N}=c,B=N/t;if(B>1){for(let z=1;z<=B-1;z++)i4(o,P,F,z*t,i),m.push(o.slice(0));i4(o,P,F,(N+Math.floor(B-1)*t)/2,i),m.push(o.slice(0))}i4(o,P,F,N,i),m.push(o.slice(0)),I=o[0],E=o[1]}}return e.type==="polyline"?new Fn({paths:n,spatialReference:i}):new es({rings:n,spatialReference:i})}class Wie{constructor(t=0,i,r){this.distance=t,this.azimuth=i,this.reverseAzimuth=r}}function i4(e,t,i,r,n){const o=t[0],c=t[1],h=o*oa,m=c*oa,b=(i!=null?i:0)*oa,{a:x,b:I,f:E}=QI(n),k=Math.sin(b),P=Math.cos(b),F=(1-E)*Math.tan(m),N=1/Math.sqrt(1+F*F),B=F*N,z=Math.atan2(F,P),q=N*k,J=q*q,X=1-J,Y=X*(x*x-I*I)/(I*I),ae=1+Y/16384*(4096+Y*(Y*(320-175*Y)-768)),he=Y/1024*(256+Y*(Y*(74-47*Y)-128));let fe,ye,xe,Se,Ae=r/(I*ae),Oe=2*Math.PI;for(;Math.abs(Ae-Oe)>1e-12;)xe=Math.cos(2*z+Ae),fe=Math.sin(Ae),ye=Math.cos(Ae),Se=he*fe*(xe+he/4*(ye*(2*xe*xe-1)-he/6*xe*(4*fe*fe-3)*(4*xe*xe-3))),Oe=Ae,Ae=r/(I*ae)+Se;const bt=B*fe-N*ye*P,st=Math.atan2(B*ye+N*fe*P,(1-E)*Math.sqrt(J+bt*bt)),et=Math.atan2(fe*k,N*ye-B*fe*P),He=E/16*X*(4+E*(4-3*X)),Et=st/oa,Gt=(h+(et-(1-He)*E*q*(Ae+He*fe*(xe+He*ye*(2*xe*xe-1)))))/oa;return e[0]=Gt,e[1]=Et,e}function Jie(e,t,i,r){const n=t[0]*oa,o=t[1]*oa,c=i[0]*oa,h=i[1]*oa,{a:m,b,f:x,radius:I}=QI(r),E=c-n,k=Math.atan((1-x)*Math.tan(o)),P=Math.atan((1-x)*Math.tan(h)),F=Math.sin(k),N=Math.cos(k),B=Math.sin(P),z=Math.cos(P);let q,J,X,Y,ae,he,fe,ye,xe,Se,Ae=1e3,Oe=E;do{if(fe=Math.sin(Oe),ye=Math.cos(Oe),X=Math.sqrt(z*fe*(z*fe)+(N*B-F*z*ye)*(N*B-F*z*ye)),X===0)return e.distance=0,e.azimuth=void 0,e.reverseAzimuth=void 0,e;ae=F*B+N*z*ye,he=Math.atan2(X,ae),xe=N*z*fe/X,J=1-xe*xe,Y=ae-2*F*B/J,isNaN(Y)&&(Y=0),Se=x/16*J*(4+x*(4-3*J)),q=Oe,Oe=E+(1-Se)*x*xe*(he+Se*X*(Y+Se*ae*(2*Y*Y-1)))}while(Math.abs(Oe-q)>1e-12&&--Ae>0);if(Ae===0){const Gt=I,pi=Math.acos(Math.sin(o)*Math.sin(h)+Math.cos(o)*Math.cos(h)*Math.cos(c-n))*Gt,ei=c-n,pn=Math.sin(ei)*Math.cos(h),Sr=Math.cos(o)*Math.sin(h)-Math.sin(o)*Math.cos(h)*Math.cos(ei),je=Math.atan2(pn,Sr);return e.azimuth=je/oa,e.distance=pi,e.reverseAzimuth=void 0,e}const bt=J*(m*m-b*b)/(b*b),st=bt/1024*(256+bt*(bt*(74-47*bt)-128)),et=b*(1+bt/16384*(4096+bt*(bt*(320-175*bt)-768)))*(he-st*X*(Y+st/4*(ae*(2*Y*Y-1)-st/6*Y*(4*X*X-3)*(4*Y*Y-3)))),He=Math.atan2(z*Math.sin(Oe),N*B-F*z*Math.cos(Oe)),Et=Math.atan2(N*Math.sin(Oe),N*B*Math.cos(Oe)-F*z);return e.azimuth=He/oa,e.distance=et,e.reverseAzimuth=Et/oa,e}var vO;let Pf=vO=class extends es{constructor(...e){super(...e),this.center=null,this.geodesic=!1,this.numberOfPoints=60,this.radius=1e3,this.radiusUnit="meters"}normalizeCtorArgs(e,t){let i;if(e&&e.center)i=e;else{if(e&&e.rings)return super.normalizeCtorArgs(e,t);i={center:e}}return K(K(K({},super.normalizeCtorArgs()),i),t)}initialize(){var c;const e=this.center,t=this.numberOfPoints;if(this.hasZ=(c=e==null?void 0:e.hasZ)!=null?c:!1,this.rings.length!==0||!e)return;const i=ji(this.radius,this.radiusUnit,"meters"),r=e.spatialReference;let n,o="geographic";if(r.isWebMercator?o="webMercator":((r.wkid&&ne[r.wkid])!=null||r.wkt&&r.wkt.indexOf("PROJCS")===0)&&(o="projected"),this.geodesic){let h;switch(o){case"webMercator":h=v0(e);break;case"projected":console.error("Creating a geodesic circle requires the center to be specified in web mercator or geographic coordinate system");break;case"geographic":h=e}n=this._createGeodesicCircle(h,i,t),o==="webMercator"&&(n=tu(n))}else{let h;o==="webMercator"||o==="projected"?h=i/this._convert2Meters(1,e.spatialReference):o==="geographic"&&(h=GU(i,"meters",Ik(e.spatialReference).radius)),n=this._createPlanarCircle(e,h,t)}this.spatialReference=n.spatialReference,this.addRing(n.rings[0])}clone(){const{center:e,numberOfPoints:t,radius:i,radiusUnit:r,geodesic:n}=this;return new vO({center:e==null?void 0:e.clone(),numberOfPoints:t,radius:i,radiusUnit:r,geodesic:n})}_createGeodesicCircle(e,t,i){let r=0;const n=[];for(;r<360;){const o=[0,0],c=[e.x,e.y];i4(o,c,r,t),this.hasZ&&o.push(e.z),n.push(o),r+=360/i}return n.push(n[0]),new es(n)}_createPlanarCircle(e,t,i){const r=[],n=2*Math.PI/i;for(let o=0;o<i;++o){const c=n*o,h=[e.x+Math.cos(-c)*t,e.y+Math.sin(-c)*t];this.hasZ&&h.push(e.z),r.push(h)}return r.push(r[0]),new es({spatialReference:e.spatialReference,rings:[r]})}_convert2Meters(e,t){let i;if(t.wkid&&ne[t.wkid]!=null)i=ne.values[ne[t.wkid]];else{const r=t.wkt,n=r.lastIndexOf(",")+1,o=r.lastIndexOf("]]");i=parseFloat(r.substring(n,o))}return e*i}};g([w({type:pt})],Pf.prototype,"center",void 0),g([w()],Pf.prototype,"geodesic",void 0),g([w()],Pf.prototype,"numberOfPoints",void 0),g([w()],Pf.prototype,"radius",void 0),g([w()],Pf.prototype,"radiusUnit",void 0),Pf=vO=g([te("esri.geometry.Circle")],Pf);const WOe=Pf;function r4(e){return Zie(e).result}function TYe(e){return Zie(e).geometry}function Zie(e){var t;return((t=e.layer)==null?void 0:t.type)!=="graphics"?{result:Yi.GRAPHICS_LAYER_MISSING,geometry:null}:ce(e.geometry)?{result:Yi.GEOMETRY_MISSING,geometry:null}:EI(e)!=="on-the-ground"&&zL(e)?{result:Yi.ELEVATION_MODE_UNSUPPORTED,geometry:null}:e.geometry.type!=="point"&&e.geometry.type!=="polyline"&&(e.geometry.type!=="polygon"||e.geometry instanceof WOe)?{result:Yi.GEOMETRY_TYPE_UNSUPPORTED,geometry:null}:{result:Yi.SUPPORTED,geometry:e.geometry}}function JOe(e){var i;if(((i=e.layer)==null?void 0:i.type)!=="graphics")return Yi.GRAPHICS_LAYER_MISSING;if(ce(e.geometry))return Yi.GEOMETRY_MISSING;switch(e.geometry.type){case"point":break;case"polygon":case"polyline":case"multipoint":case"extent":case"mesh":return Yi.SUPPORTED;default:return Yi.GEOMETRY_TYPE_UNSUPPORTED}const t=H(e.symbol)&&e.symbol.type==="point-3d"&&e.symbol.symbolLayers;return t&&t.length>0&&t.some(r=>r.type==="object")?EI(e)!=="on-the-ground"&&zL(e)?Yi.ELEVATION_MODE_UNSUPPORTED:Yi.SUPPORTED:Yi.SYMBOL_TYPE_UNSUPPORTED}function Kie(e,t,i){if(!t||!e||!e.map)return;const{map:r}=e,n=r.layers.find(o=>o===t);n||r.add(t,i),i!=null&&r.layers.reorder(n,i)}function CYe(e,t){return e.allLayerViews.find(i=>{const r=i.layer;return r===t||"sublayers"in r&&H(r.sublayers)&&r.sublayers.includes(t)})}function ZOe(e,t){const i=Yie[e.toLowerCase()];if(i==null)throw new Error("Function Not Recognised");if(t.length<i.minParams||t.length>i.maxParams)throw new Error(`Invalid Parameter count for call to ${e.toUpperCase()}`);return i.evaluate(t)}function KOe(e,t){const i=Yie[e.toLowerCase()];return i!=null&&t>=i.minParams&&t<=i.maxParams}const Yie={min:{minParams:1,maxParams:1,evaluate:e=>e[0]==null?null:Math.min.apply(Math,e[0])},max:{minParams:1,maxParams:1,evaluate:e=>e[0]==null?null:Math.max.apply(Math,e[0])},avg:{minParams:1,maxParams:1,evaluate:e=>e[0]==null?null:Xie(e[0])},sum:{minParams:1,maxParams:1,evaluate:e=>e[0]==null?null:YOe(e[0])},stddev:{minParams:1,maxParams:1,evaluate:e=>e[0]==null?null:Math.sqrt(Qie(e[0]))},count:{minParams:1,maxParams:1,evaluate:e=>e[0]==null?null:e[0].length},var:{minParams:1,maxParams:1,evaluate:e=>e[0]==null?null:Qie(e[0])}};function Xie(e){let t=0;for(let i=0;i<e.length;i++)t+=e[i];return t/e.length}function YOe(e){let t=0;for(let i=0;i<e.length;i++)t+=e[i];return t}function Qie(e){const t=Xie(e),i=e.length;let r=0;for(const n of e)r+=(n-t)**2;return i>1?r/(i-1):0}class Vo{constructor(){this.op="+",this.day=0,this.second=0,this.hour=0,this.month=0,this.year=0,this.minute=0}static _fixDefaults(t){if(t.precision!==null||t.secondary!==null)throw new Error("Primary and Secondary SqlInterval qualifiers not supported")}static createFromMilliseconds(t){const i=new Vo;return i.second=t/1e3,i}static createFromValueAndQualifer(t,i,r){let n=null;const o=new Vo;if(o.op=r==="-"?"-":"+",i.type==="interval-period"){Vo._fixDefaults(i);const c=new RegExp("^[0-9]{1,}$");if(i.period==="year"||i.period==="month")throw new Error("Year-Month Intervals not supported");if(!c.test(t))throw new Error("Illegal Interval");o[i.period]=parseFloat(t)}else{if(Vo._fixDefaults(i.start),Vo._fixDefaults(i.end),i.start.period==="year"||i.start.period==="month")throw new Error("Year-Month Intervals not supported");if(i.end.period==="year"||i.end.period==="month")throw new Error("Year-Month Intervals not supported");switch(i.start.period){case"day":switch(i.end.period){case"hour":if(n=new RegExp("^[0-9]{1,} [0-9]{1,}$"),!n.test(t))throw new Error("Illegal Interval");o[i.start.period]=parseFloat(t.split(" ")[0]),o[i.end.period]=parseFloat(t.split(" ")[1]);break;case"minute":if(n=new RegExp("^[0-9]{1,} [0-9]{1,2}:[0-9]{1,}$"),!n.test(t))throw new Error("Illegal Interval");{o[i.start.period]=parseFloat(t.split(" ")[0]);const c=t.split(" ")[1].split(":");o.hour=parseFloat(c[0]),o.minute=parseFloat(c[1])}break;case"second":if(n=new RegExp("^[0-9]{1,} [0-9]{1,2}:[0-9]{1,2}:[0-9]{1,}([.]{1}[0-9]{1,}){0,1}$"),!n.test(t))throw new Error("Illegal Interval");{o[i.start.period]=parseFloat(t.split(" ")[0]);const c=t.split(" ")[1].split(":");o.hour=parseFloat(c[0]),o.minute=parseFloat(c[1]),o.second=parseFloat(c[2])}break;default:throw new Error("Invalid Interval.")}break;case"hour":switch(i.end.period){case"minute":if(n=new RegExp("^[0-9]{1,}:[0-9]{1,}$"),!n.test(t))throw new Error("Illegal Interval");o.hour=parseFloat(t.split(":")[0]),o.minute=parseFloat(t.split(":")[1]);break;case"second":if(n=new RegExp("^[0-9]{1,}:[0-9]{1,2}:[0-9]{1,}([.]{1}[0-9]{1,}){0,1}$"),!n.test(t))throw new Error("Illegal Interval");{const c=t.split(":");o.hour=parseFloat(c[0]),o.minute=parseFloat(c[1]),o.second=parseFloat(c[2])}break;default:throw new Error("Invalid Interval.")}break;case"minute":if(i.end.period!=="second")throw new Error("Invalid Interval.");if(n=new RegExp("^[0-9]{1,}:[0-9]{1,}([.]{1}[0-9]{1,}){0,1}$"),!n.test(t))throw new Error("Illegal Interval");{const c=t.split(":");o.minute=parseFloat(c[0]),o.second=parseFloat(c[1])}break;default:throw new Error("Invalid Interval.")}}return o}valueInMilliseconds(){return(this.op==="-"?-1:1)*(1e3*this.second+60*this.minute*1e3+60*this.hour*60*1e3+24*this.day*60*60*1e3+this.month*(365/12)*24*60*60*1e3+365*this.year*24*60*60*1e3)}}function ere(e,t){const i=tre[e.toLowerCase()];if(i==null)throw new Error("Function Not Recognised");if(t.length<i.minParams||t.length>i.maxParams)throw new Error(`Invalid Parameter count for call to ${e.toUpperCase()}`);return i.evaluate(t)}function XOe(e,t){const i=tre[e.toLowerCase()];return i!=null&&t>=i.minParams&&t<=i.maxParams}const tre={extract:{minParams:2,maxParams:2,evaluate:([e,t])=>{if(t==null)return null;if(t instanceof Date)switch(e.toUpperCase()){case"SECOND":return t.getSeconds();case"MINUTE":return t.getMinutes();case"HOUR":return t.getHours();case"DAY":return t.getDate();case"MONTH":return t.getMonth()+1;case"YEAR":return t.getFullYear()}throw new Error("Invalid Parameter for call to EXTRACT")}},substring:{minParams:2,maxParams:3,evaluate:e=>{if(e.length===2){const[t,i]=e;return t==null||i==null?null:t.toString().substring(i-1)}if(e.length===3){const[t,i,r]=e;return t==null||i==null||r==null?null:r<=0?"":t.toString().substring(i-1,i+r-1)}}},position:{minParams:2,maxParams:2,evaluate:([e,t])=>e==null||t==null?null:t.indexOf(e)+1},trim:{minParams:2,maxParams:3,evaluate:e=>{const t=e.length===3,i=t?e[1]:" ",r=t?e[2]:e[1];if(i==null||r==null)return null;const n=`(${tS(i)})`;switch(e[0]){case"BOTH":return r.replace(new RegExp(`^${n}*|${n}*$`,"g"),"");case"LEADING":return r.replace(new RegExp(`^${n}*`,"g"),"");case"TRAILING":return r.replace(new RegExp(`${n}*$`,"g"),"")}throw new Error("Invalid Parameter for call to TRIM")}},abs:{minParams:1,maxParams:1,evaluate:e=>e[0]==null?null:Math.abs(e[0])},ceiling:{minParams:1,maxParams:1,evaluate:e=>e[0]==null?null:Math.ceil(e[0])},floor:{minParams:1,maxParams:1,evaluate:e=>e[0]==null?null:Math.floor(e[0])},log:{minParams:1,maxParams:1,evaluate:e=>e[0]==null?null:Math.log(e[0])},log10:{minParams:1,maxParams:1,evaluate:e=>e[0]==null?null:Math.log(e[0])*Math.LOG10E},sin:{minParams:1,maxParams:1,evaluate:e=>e[0]==null?null:Math.sin(e[0])},cos:{minParams:1,maxParams:1,evaluate:e=>e[0]==null?null:Math.cos(e[0])},tan:{minParams:1,maxParams:1,evaluate:e=>e[0]==null?null:Math.tan(e[0])},asin:{minParams:1,maxParams:1,evaluate:e=>e[0]==null?null:Math.asin(e[0])},acos:{minParams:1,maxParams:1,evaluate:e=>e[0]==null?null:Math.acos(e[0])},atan:{minParams:1,maxParams:1,evaluate:e=>e[0]==null?null:Math.atan(e[0])},sign:{minParams:1,maxParams:1,evaluate:e=>e[0]==null?null:e[0]>0?1:e[1]<0?-1:0},power:{minParams:2,maxParams:2,evaluate:e=>e[0]==null||e[1]==null?null:e[0]**e[1]},mod:{minParams:2,maxParams:2,evaluate:e=>e[0]==null||e[1]==null?null:e[0]%e[1]},round:{minParams:1,maxParams:2,evaluate:e=>{const t=e[0],i=e.length===2?10**e[1]:1;return t==null?null:Math.round(t*i)/i}},truncate:{minParams:1,maxParams:2,evaluate:e=>e[0]==null?null:e.length===1?parseInt(e[0].toFixed(0),10):parseFloat(e[0].toFixed(e[1]))},char_length:{minParams:1,maxParams:1,evaluate:e=>typeof e[0]=="string"||e[0]instanceof String?e[0].length:0},concat:{minParams:1,maxParams:1/0,evaluate:e=>{let t="";for(let i=0;i<e.length;i++){if(e[i]==null)return null;t+=e[i].toString()}return t}},lower:{minParams:1,maxParams:1,evaluate:e=>e[0]==null?null:e[0].toString().toLowerCase()},upper:{minParams:1,maxParams:1,evaluate:e=>e[0]==null?null:e[0].toString().toUpperCase()}};var ire,rre,nre={exports:{}};rre=function(){function e(n,o){function c(){this.constructor=n}c.prototype=o.prototype,n.prototype=new c}function t(n,o,c,h){var m=Error.call(this,n);return Object.setPrototypeOf&&Object.setPrototypeOf(m,t.prototype),m.expected=o,m.found=c,m.location=h,m.name="SyntaxError",m}function i(n,o,c){return c=c||" ",n.length>o?n:(o-=n.length,n+(c+=c.repeat(o)).slice(0,o))}function r(n,o){var c,h={},m=(o=o!==void 0?o:{}).grammarSource,b={start:FF},x=FF,I="!",E="=",k=">=",P=">",F="<=",N="<>",B="<",z="!=",q="+",J="-",X="*",Y="/",ae="@",he="'",fe="N'",ye="''",xe=".",Se="null",Ae="true",Oe="false",bt="in",st="is",et="like",He="escape",Et="not",Gt="and",pi="or",ei="between",pn="from",Sr="for",je="substring",at="extract",rt="trim",It="position",ni="timestamp",Ai="date",Ut="leading",pe="trailing",be="both",Le="to",Ve="interval",Ge="year",Be="month",Q="day",Je="hour",Qe="minute",Pe="second",dt="case",vt="end",$t="when",Ct="then",qt="else",oi=",",Si="(",Bi=")",Ue="`",Ls=/^[A-Za-z_\x80-\uFFFF]/,d=/^[A-Za-z0-9_]/,O=/^[A-Za-z0-9_.\x80-\uFFFF]/,S=/^[^']/,p=/^[0-9]/,l=/^[eE]/,s=/^[+\-]/,a=/^[ \t\n\r]/,u=/^[^`]/,f=Ft("!",!1),y=Ft("=",!1),v=Ft(">=",!1),_=Ft(">",!1),M=Ft("<=",!1),$=Ft("<>",!1),T=Ft("<",!1),A=Ft("!=",!1),R=Ft("+",!1),D=Ft("-",!1),V=Ft("*",!1),Z=Ft("/",!1),ee=rh([["A","Z"],["a","z"],"_",["\x80","\uFFFF"]],!1,!1),G=rh([["A","Z"],["a","z"],["0","9"],"_"],!1,!1),re=rh([["A","Z"],["a","z"],["0","9"],"_",".",["\x80","\uFFFF"]],!1,!1),oe=Ft("@",!1),se=Ft("'",!1),ge=Ft("N'",!1),me=Ft("''",!1),Ie=rh(["'"],!0,!1),De=Ft(".",!1),Fe=rh([["0","9"]],!1,!1),gt=rh(["e","E"],!1,!1),Ze=rh(["+","-"],!1,!1),Vt=Ft("NULL",!0),Rt=Ft("TRUE",!0),lt=Ft("FALSE",!0),Ui=Ft("IN",!0),Vr=Ft("IS",!0),Wi=Ft("LIKE",!0),Mi=Ft("ESCAPE",!0),Ii=Ft("NOT",!0),ri=Ft("AND",!0),sr=Ft("OR",!0),Qt=Ft("BETWEEN",!0),tn=Ft("FROM",!0),di=Ft("FOR",!0),Zn=Ft("SUBSTRING",!0),Pi=Ft("EXTRACT",!0),qp=Ft("TRIM",!0),Hp=Ft("POSITION",!0),Wp=Ft("TIMESTAMP",!0),vs=Ft("DATE",!0),P$=Ft("LEADING",!0),L$=Ft("TRAILING",!0),de=Ft("BOTH",!0),Ne=Ft("TO",!0),Ke=Ft("INTERVAL",!0),ai=Ft("YEAR",!0),Kn=Ft("MONTH",!0),Ar=Ft("DAY",!0),Bo=Ft("HOUR",!0),Pm=Ft("MINUTE",!0),Ale=Ft("SECOND",!0),Ple=Ft("CASE",!0),Lle=Ft("END",!0),Ole=Ft("WHEN",!0),Rle=Ft("THEN",!0),Fle=Ft("ELSE",!0),Nle=Ft(",",!1),Dle=Ft("(",!1),jle=Ft(")",!1),Vle=rh([" ","	",`
`,"\r"],!1,!1),AF=Ft("`",!1),PF=rh(["`"],!0,!1),zle=function(L){return L},Gle=function(L,W){var ie={type:"expression-list"},le=Vhe(L,W);return ie.value=le,ie},Ble=function(L,W){return Cb(L,W)},Ule=function(L,W){return Cb(L,W)},qle=function(L){return Dhe("NOT",L)},Hle=function(L,W){return W==""||W==null||W==null?L:W.type=="arithmetic"?Cb(L,W.tail):uN(W.op,L,W.right,W.escape)},Wle=function(L){return{type:"arithmetic",tail:L}},Jle=function(L,W){return{op:L+"NOT",right:W}},Zle=function(L,W){return{op:L,right:W}},Kle=function(L,W,ie){return{op:"NOT"+L,right:{type:"expression-list",value:[W,ie]}}},Yle=function(L,W,ie){return{op:L,right:{type:"expression-list",value:[W,ie]}}},Xle=function(L){return L[0]+" "+L[2]},Qle=function(L){return L[0]+" "+L[2]},ece=function(L,W,ie){return{op:L,right:W,escape:ie.value}},tce=function(L,W){return{op:L,right:W,escape:""}},ice=function(L,W){return{op:L,right:W}},rce=function(L){return{op:L,right:{type:"expression-list",value:[]}}},nce=function(L,W){return{op:L,right:W}},sce=function(L,W){return Cb(L,W)},oce=function(L,W){return Cb(L,W)},ace=function(L){return L.paren=!0,L},lce=function(L){return/^CURRENT_DATE$/i.test(L)?{type:"current-time",mode:"date"}:/^CURRENT_TIMESTAMP$/i.test(L)?{type:"current-time",mode:"timestamp"}:{type:"column-reference",table:"",column:L}},cce=function(L){return L},uce=function(L,W){return L+W.join("")},hce=function(L,W){return L+W.join("")},pce=function(L){return{type:"parameter",value:L[1]}},dce=function(L,W){return{type:"function",name:"extract",args:{type:"expression-list",value:[{type:"string",value:L},W]}}},fce=function(L,W,ie){return{type:"function",name:"substring",args:{type:"expression-list",value:ie?[L,W,ie[2]]:[L,W]}}},yce=function(L,W,ie){return{type:"function",name:"trim",args:{type:"expression-list",value:[{type:"string",value:L!=null?L:"BOTH"},W,ie]}}},mce=function(L,W){return{type:"function",name:"trim",args:{type:"expression-list",value:[{type:"string",value:L!=null?L:"BOTH"},W]}}},gce=function(L,W){return{type:"function",name:"position",args:{type:"expression-list",value:[L,W]}}},vce=function(L,W){return{type:"function",name:L,args:W||{type:"expression-list",value:[]}}},bce=function(L){return{type:"timestamp",value:L.value}},wce=function(L,W,ie){return{type:"interval",value:W,qualifier:ie,op:L}},_ce=function(L,W){return{type:"interval",value:L,qualifier:W,op:""}},xce=function(L,W){return{type:"interval-qualifier",start:L,end:W}},Sce=function(L,W){return{type:"interval-period",period:L.value,precision:W,secondary:null}},Mce=function(L){return{type:"interval-period",period:L.value,precision:null,secondary:null}},Ice=function(L){return{type:"interval-period",period:L.value,precision:null,secondary:null}},$ce=function(L,W){return{type:"interval-period",period:"second",precision:L,secondary:W}},Ece=function(L){return{type:"interval-period",period:"second",precision:L,secondary:null}},Tce=function(){return{type:"interval-period",period:"second",precision:null,secondary:null}},Cce=function(L,W){return{type:"interval-period",period:L.value,precision:W,secondary:null}},kce=function(L){return{type:"interval-period",period:L.value,precision:null,secondary:null}},Ace=function(L,W){return{type:"interval-period",period:"second",precision:L,secondary:W}},Pce=function(L){return{type:"interval-period",period:"second",precision:L,secondary:null}},Lce=function(){return{type:"interval-period",period:"second",precision:null,secondary:null}},Oce=function(){return{type:"string",value:"day"}},Rce=function(){return{type:"string",value:"hour"}},Fce=function(){return{type:"string",value:"minute"}},Nce=function(){return{type:"string",value:"month"}},Dce=function(){return{type:"string",value:"year"}},jce=function(L){return parseFloat(L)},Vce=function(L){return parseFloat(L)},zce=function(L){return{type:"date",value:L.value}},Gce=function(){return{type:"null",value:null}},Bce=function(){return{type:"boolean",value:!0}},Uce=function(){return{type:"boolean",value:!1}},LF=function(){return"'"},qce=function(L){return{type:"string",value:L.join("")}},Hce=function(L,W){return{type:"case-expression",format:"simple",operand:L,clauses:W,else:null}},Wce=function(L,W,ie){return{type:"case-expression",format:"simple",operand:L,clauses:W,else:ie.value}},Jce=function(L){return{type:"case-expression",format:"searched",clauses:L,else:null}},Zce=function(L,W){return{type:"case-expression",format:"searched",clauses:L,else:W.value}},Kce=function(L,W){return{type:"when-clause",operand:L,value:W}},Yce=function(L,W){return{type:"when-clause",operand:L,value:W}},Xce=function(L){return{type:"else-clause",value:L}},Qce=function(L){return{type:"number",value:L}},eue=function(L,W,ie){return parseFloat(L+W+ie)},tue=function(L,W){return parseFloat(L+W)},iue=function(L,W){return parseFloat(L+W)},rue=function(L){return parseFloat(L)},nue=function(L,W){return L[0]+W},sue=function(L){return"."+(L!=null?L:"")},oue=function(L,W){return L+W},aue=function(L){return L.join("")},lue=function(L,W){return"e"+(W===null?"":W)},cue=function(){return"IN"},uue=function(){return"IS"},hue=function(){return"LIKE"},pue=function(){return"ESCAPE"},due=function(){return"NOT"},fue=function(){return"AND"},yue=function(){return"OR"},mue=function(){return"BETWEEN"},gue=function(){return"FROM"},vue=function(){return"FOR"},bue=function(){return"SUBSTRING"},wue=function(){return"EXTRACT"},_ue=function(){return"TRIM"},xue=function(){return"POSITION"},Sue=function(){return"TIMESTAMP"},Mue=function(){return"DATE"},Iue=function(){return"LEADING"},$ue=function(){return"TRAILING"},Eue=function(){return"BOTH"},Tue=function(){return"TO"},Cue=function(){return"INTERVAL"},kue=function(){return"YEAR"},Aue=function(){return"MONTH"},Pue=function(){return"DAY"},Lue=function(){return"HOUR"},Oue=function(){return"MINUTE"},Rue=function(){return"SECOND"},Fue=function(){return"CASE"},Nue=function(){return"END"},Due=function(){return"WHEN"},jue=function(){return"THEN"},Vue=function(){return"ELSE"},zue=function(L){return L},Gue=function(L){return L.join("")},U=0,hx=[{line:1,column:1}],Bc=0,O$=[],Ee=0;if("startRule"in o){if(!(o.startRule in b))throw new Error(`Can't start parsing from rule "`+o.startRule+'".');x=b[o.startRule]}function Ft(L,W){return{type:"literal",text:L,ignoreCase:W}}function rh(L,W,ie){return{type:"class",parts:L,inverted:W,ignoreCase:ie}}function Bue(){return{type:"end"}}function OF(L){var W,ie=hx[L];if(ie)return ie;for(W=L-1;!hx[W];)W--;for(ie={line:(ie=hx[W]).line,column:ie.column};W<L;)n.charCodeAt(W)===10?(ie.line++,ie.column=1):ie.column++,W++;return hx[L]=ie,ie}function RF(L,W){var ie=OF(L),le=OF(W);return{source:m,start:{offset:L,line:ie.line,column:ie.column},end:{offset:W,line:le.line,column:le.column}}}function wt(L){U<Bc||(U>Bc&&(Bc=U,O$=[]),O$.push(L))}function Uue(L,W,ie){return new t(t.buildMessage(L,W),L,W,ie)}function FF(){var L,W;return L=U,Re(),(W=xn())!==h?(Re(),L=zle(W)):(U=L,L=h),L}function NF(){var L,W,ie,le,_t,Li,fr,zr;if(L=U,(W=xn())!==h){for(ie=[],le=U,_t=Re(),(Li=_x())!==h?(fr=Re(),(zr=xn())!==h?le=_t=[_t,Li,fr,zr]:(U=le,le=h)):(U=le,le=h);le!==h;)ie.push(le),le=U,_t=Re(),(Li=_x())!==h?(fr=Re(),(zr=xn())!==h?le=_t=[_t,Li,fr,zr]:(U=le,le=h)):(U=le,le=h);L=Gle(W,ie)}else U=L,L=h;return L}function xn(){var L,W,ie,le,_t,Li,fr,zr;if(L=U,(W=R$())!==h){for(ie=[],le=U,_t=Re(),(Li=XF())!==h?(fr=Re(),(zr=R$())!==h?le=_t=[_t,Li,fr,zr]:(U=le,le=h)):(U=le,le=h);le!==h;)ie.push(le),le=U,_t=Re(),(Li=XF())!==h?(fr=Re(),(zr=R$())!==h?le=_t=[_t,Li,fr,zr]:(U=le,le=h)):(U=le,le=h);L=Ble(W,ie)}else U=L,L=h;return L}function R$(){var L,W,ie,le,_t,Li,fr,zr;if(L=U,(W=px())!==h){for(ie=[],le=U,_t=Re(),(Li=vx())!==h?(fr=Re(),(zr=px())!==h?le=_t=[_t,Li,fr,zr]:(U=le,le=h)):(U=le,le=h);le!==h;)ie.push(le),le=U,_t=Re(),(Li=vx())!==h?(fr=Re(),(zr=px())!==h?le=_t=[_t,Li,fr,zr]:(U=le,le=h)):(U=le,le=h);L=Ule(W,ie)}else U=L,L=h;return L}function px(){var L,W,ie,le,_t;return L=U,(W=Tb())===h&&(W=U,n.charCodeAt(U)===33?(ie=I,U++):(ie=h,Ee===0&&wt(f)),ie!==h?(le=U,Ee++,n.charCodeAt(U)===61?(_t=E,U++):(_t=h,Ee===0&&wt(y)),Ee--,_t===h?le=void 0:(U=le,le=h),le!==h?W=ie=[ie,le]:(U=W,W=h)):(U=W,W=h)),W!==h?(ie=Re(),(le=px())!==h?L=qle(le):(U=L,L=h)):(U=L,L=h),L===h&&(L=que()),L}function que(){var L,W,ie;return L=U,(W=nh())!==h?(Re(),(ie=Hue())===h&&(ie=null),L=Hle(W,ie)):(U=L,L=h),L}function Hue(){var L;return(L=Wue())===h&&(L=Yue())===h&&(L=Zue())===h&&(L=Jue())===h&&(L=Kue()),L}function Wue(){var L,W,ie,le,_t,Li;if(L=[],W=U,ie=Re(),(le=DF())!==h?(_t=Re(),(Li=nh())!==h?W=ie=[ie,le,_t,Li]:(U=W,W=h)):(U=W,W=h),W!==h)for(;W!==h;)L.push(W),W=U,ie=Re(),(le=DF())!==h?(_t=Re(),(Li=nh())!==h?W=ie=[ie,le,_t,Li]:(U=W,W=h)):(U=W,W=h);else L=h;return L!==h&&(L=Wle(L)),L}function DF(){var L;return n.substr(U,2)===k?(L=k,U+=2):(L=h,Ee===0&&wt(v)),L===h&&(n.charCodeAt(U)===62?(L=P,U++):(L=h,Ee===0&&wt(_)),L===h&&(n.substr(U,2)===F?(L=F,U+=2):(L=h,Ee===0&&wt(M)),L===h&&(n.substr(U,2)===N?(L=N,U+=2):(L=h,Ee===0&&wt($)),L===h&&(n.charCodeAt(U)===60?(L=B,U++):(L=h,Ee===0&&wt(T)),L===h&&(n.charCodeAt(U)===61?(L=E,U++):(L=h,Ee===0&&wt(y)),L===h&&(n.substr(U,2)===z?(L=z,U+=2):(L=h,Ee===0&&wt(A)))))))),L}function Jue(){var L,W,ie,le;return L=U,(W=KF())!==h?(Re(),(ie=Tb())!==h?(Re(),(le=nh())!==h?L=Jle(W,le):(U=L,L=h)):(U=L,L=h)):(U=L,L=h),L===h&&(L=U,(W=KF())!==h?(Re(),(ie=nh())!==h?L=Zle(W,ie):(U=L,L=h)):(U=L,L=h)),L}function Zue(){var L,W,ie,le,_t,Li;return L=U,(W=Tb())!==h?(Re(),(ie=QF())!==h?(Re(),(le=nh())!==h?(Re(),(_t=vx())!==h?(Re(),(Li=nh())!==h?L=Kle(ie,le,Li):(U=L,L=h)):(U=L,L=h)):(U=L,L=h)):(U=L,L=h)):(U=L,L=h),L===h&&(L=U,(W=QF())!==h?(Re(),(ie=nh())!==h?(Re(),(le=vx())!==h?(Re(),(_t=nh())!==h?L=Yle(W,ie,_t):(U=L,L=h)):(U=L,L=h)):(U=L,L=h)):(U=L,L=h)),L}function jF(){var L,W,ie,le,_t;return L=U,W=U,(ie=Tb())!==h?(le=Re(),(_t=YF())!==h?W=ie=[ie,le,_t]:(U=W,W=h)):(U=W,W=h),W!==h&&(W=Xle(W)),(L=W)===h&&(L=YF()),L}function F$(){var L,W,ie,le,_t;return L=U,W=U,(ie=Tb())!==h?(le=Re(),(_t=G$())!==h?W=ie=[ie,le,_t]:(U=W,W=h)):(U=W,W=h),W!==h&&(W=Qle(W)),(L=W)===h&&(L=G$()),L}function Kue(){var L,W,ie,le;return L=U,(W=jF())!==h?(Re(),(ie=Lm())!==h?(Re(),Ihe()!==h?(Re(),(le=z$())!==h?L=ece(W,ie,le):(U=L,L=h)):(U=L,L=h)):(U=L,L=h)):(U=L,L=h),L===h&&(L=U,(W=jF())!==h?(Re(),(ie=Lm())!==h?L=tce(W,ie):(U=L,L=h)):(U=L,L=h)),L}function Yue(){var L,W,ie,le;return L=U,(W=F$())!==h?(Re(),(ie=_o())!==h?(Re(),(le=NF())!==h?(Re(),xo()!==h?L=ice(W,le):(U=L,L=h)):(U=L,L=h)):(U=L,L=h)):(U=L,L=h),L===h&&(L=U,(W=F$())!==h?(Re(),(ie=_o())!==h?(Re(),(le=xo())!==h?L=rce(W):(U=L,L=h)):(U=L,L=h)):(U=L,L=h),L===h&&(L=U,(W=F$())!==h?(Re(),(ie=V$())!==h?L=nce(W,ie):(U=L,L=h)):(U=L,L=h))),L}function nh(){var L,W,ie,le,_t,Li,fr,zr;if(L=U,(W=N$())!==h){for(ie=[],le=U,_t=Re(),(Li=VF())!==h?(fr=Re(),(zr=N$())!==h?le=_t=[_t,Li,fr,zr]:(U=le,le=h)):(U=le,le=h);le!==h;)ie.push(le),le=U,_t=Re(),(Li=VF())!==h?(fr=Re(),(zr=N$())!==h?le=_t=[_t,Li,fr,zr]:(U=le,le=h)):(U=le,le=h);L=sce(W,ie)}else U=L,L=h;return L}function VF(){var L;return n.charCodeAt(U)===43?(L=q,U++):(L=h,Ee===0&&wt(R)),L===h&&(n.charCodeAt(U)===45?(L=J,U++):(L=h,Ee===0&&wt(D))),L}function N$(){var L,W,ie,le,_t,Li,fr,zr;if(L=U,(W=D$())!==h){for(ie=[],le=U,_t=Re(),(Li=zF())!==h?(fr=Re(),(zr=D$())!==h?le=_t=[_t,Li,fr,zr]:(U=le,le=h)):(U=le,le=h);le!==h;)ie.push(le),le=U,_t=Re(),(Li=zF())!==h?(fr=Re(),(zr=D$())!==h?le=_t=[_t,Li,fr,zr]:(U=le,le=h)):(U=le,le=h);L=oce(W,ie)}else U=L,L=h;return L}function zF(){var L;return n.charCodeAt(U)===42?(L=X,U++):(L=h,Ee===0&&wt(V)),L===h&&(n.charCodeAt(U)===47?(L=Y,U++):(L=h,Ee===0&&wt(Z))),L}function D$(){var L,W;return(L=ahe())===h&&(L=the())===h&&(L=ihe())===h&&(L=rhe())===h&&(L=nhe())===h&&(L=she())===h&&(L=mhe())===h&&(L=Xue())===h&&(L=V$())===h&&(L=U,_o()!==h?(Re(),(W=xn())!==h?(Re(),xo()!==h?L=ace(W):(U=L,L=h)):(U=L,L=h)):(U=L,L=h)),L}function Xue(){var L;return(L=Que())!==h&&(L=lce(L)),L}function Que(){var L;return(L=ehe())!==h&&(L=cce(L)),L}function ehe(){var L,W,ie,le;if(L=U,(W=j$())!==h){for(ie=[],le=BF();le!==h;)ie.push(le),le=BF();L=uce(W,ie)}else U=L,L=h;return L}function GF(){var L,W,ie,le;if(L=U,(W=j$())!==h){for(ie=[],le=Ei();le!==h;)ie.push(le),le=Ei();L=hce(W,ie)}else U=L,L=h;return L}function j$(){var L;return Ls.test(n.charAt(U))?(L=n.charAt(U),U++):(L=h,Ee===0&&wt(ee)),L}function Ei(){var L;return d.test(n.charAt(U))?(L=n.charAt(U),U++):(L=h,Ee===0&&wt(G)),L}function BF(){var L;return O.test(n.charAt(U))?(L=n.charAt(U),U++):(L=h,Ee===0&&wt(re)),L}function V$(){var L,W,ie;return L=U,n.charCodeAt(U)===64?(W=ae,U++):(W=h,Ee===0&&wt(oe)),W!==h&&(ie=GF())!==h?L=W=[W,ie]:(U=L,L=h),L!==h&&(L=pce(L)),L}function the(){var L,W,ie;return L=U,The()!==h?(Re(),_o()!==h?(Re(),(W=ohe())!==h?(Re(),B$()!==h?(Re(),(ie=xn())!==h?(Re(),xo()!==h?L=dce(W,ie):(U=L,L=h)):(U=L,L=h)):(U=L,L=h)):(U=L,L=h)):(U=L,L=h)):(U=L,L=h),L}function ihe(){var L,W,ie,le,_t,Li,fr;return L=U,Ehe()!==h?(Re(),_o()!==h?(Re(),(W=xn())!==h?(Re(),B$()!==h?(Re(),(ie=xn())!==h?(Re(),le=U,(_t=$he())!==h?(Li=Re(),(fr=xn())!==h?le=_t=[_t,Li,fr,Re()]:(U=le,le=h)):(U=le,le=h),le===h&&(le=null),(_t=xo())!==h?L=fce(W,ie,le):(U=L,L=h)):(U=L,L=h)):(U=L,L=h)):(U=L,L=h)):(U=L,L=h)):(U=L,L=h),L}function rhe(){var L,W,ie,le;return L=U,eN()!==h?(Re(),_o()!==h?(Re(),(W=UF())===h&&(W=null),Re(),(ie=xn())!==h?(Re(),B$()!==h?(Re(),(le=xn())!==h?(Re(),xo()!==h?L=yce(W,ie,le):(U=L,L=h)):(U=L,L=h)):(U=L,L=h)):(U=L,L=h)):(U=L,L=h)):(U=L,L=h),L===h&&(L=U,eN()!==h?(Re(),_o()!==h?(Re(),(W=UF())===h&&(W=null),Re(),(ie=xn())!==h?(Re(),xo()!==h?L=mce(W,ie):(U=L,L=h)):(U=L,L=h)):(U=L,L=h)):(U=L,L=h)),L}function UF(){var L;return(L=Phe())===h&&(L=Lhe())===h&&(L=Ohe()),L}function nhe(){var L,W,ie;return L=U,Che()!==h?(Re(),_o()!==h?(Re(),(W=xn())!==h?(Re(),G$()!==h?(Re(),(ie=xn())!==h?(Re(),xo()!==h?L=gce(W,ie):(U=L,L=h)):(U=L,L=h)):(U=L,L=h)):(U=L,L=h)):(U=L,L=h)):(U=L,L=h),L}function she(){var L,W,ie;return L=U,(W=Nhe())!==h?(Re(),_o()!==h?(Re(),(ie=NF())===h&&(ie=null),Re(),xo()!==h?L=vce(W,ie):(U=L,L=h)):(U=L,L=h)):(U=L,L=h),L}function ohe(){var L;return(L=iN())===h&&(L=rN())===h&&(L=nN())===h&&(L=sN())===h&&(L=oN())===h&&(L=t0()),L}function ahe(){var L;return(L=z$())===h&&(L=bhe())===h&&(L=yhe())===h&&(L=fhe())===h&&(L=dhe())===h&&(L=lhe())===h&&(L=che()),L}function lhe(){var L,W;return L=U,khe()!==h?(Re(),(W=Lm())!==h?L=bce(W):(U=L,L=h)):(U=L,L=h),L}function che(){var L,W,ie,le;return L=U,tN()!==h?(Re(),n.charCodeAt(U)===45?(W=J,U++):(W=h,Ee===0&&wt(D)),W===h&&(n.charCodeAt(U)===43?(W=q,U++):(W=h,Ee===0&&wt(R))),W!==h?(Re(),(ie=Lm())!==h?(Re(),(le=qF())!==h?L=wce(W,ie,le):(U=L,L=h)):(U=L,L=h)):(U=L,L=h)):(U=L,L=h),L===h&&(L=U,tN()!==h?(Re(),(W=Lm())!==h?(Re(),(ie=qF())!==h?L=_ce(W,ie):(U=L,L=h)):(U=L,L=h)):(U=L,L=h)),L}function qF(){var L,W,ie;return L=U,(W=uhe())!==h?(Re(),Rhe()!==h?(Re(),(ie=hhe())!==h?L=xce(W,ie):(U=L,L=h)):(U=L,L=h)):(U=L,L=h),L===h&&(L=phe()),L}function uhe(){var L,W,ie;return L=U,(W=Eb())!==h?(Re(),_o()!==h?(Re(),(ie=fx())!==h?(Re(),xo()!==h?L=Sce(W,ie):(U=L,L=h)):(U=L,L=h)):(U=L,L=h)):(U=L,L=h),L===h&&(L=U,(W=Eb())!==h&&(W=Mce(W)),L=W),L}function hhe(){var L,W,ie,le;return L=U,(W=Eb())!==h&&(W=Ice(W)),(L=W)===h&&(L=U,(W=t0())!==h?(Re(),_o()!==h?(Re(),(ie=fx())!==h?(Re(),_x()!==h?(Re(),(le=dx())!==h?(Re(),xo()!==h?L=$ce(ie,le):(U=L,L=h)):(U=L,L=h)):(U=L,L=h)):(U=L,L=h)):(U=L,L=h)):(U=L,L=h),L===h&&(L=U,(W=t0())!==h?(Re(),_o()!==h?(Re(),(ie=fx())!==h?(Re(),xo()!==h?L=Ece(ie):(U=L,L=h)):(U=L,L=h)):(U=L,L=h)):(U=L,L=h),L===h&&(L=U,(W=t0())!==h&&(W=Tce()),L=W))),L}function phe(){var L,W,ie,le;return L=U,(W=Eb())!==h?(Re(),_o()!==h?(Re(),(ie=dx())!==h?(Re(),xo()!==h?L=Cce(W,ie):(U=L,L=h)):(U=L,L=h)):(U=L,L=h)):(U=L,L=h),L===h&&(L=U,(W=Eb())!==h&&(W=kce(W)),(L=W)===h&&(L=U,(W=t0())!==h?(Re(),_o()!==h?(Re(),(ie=fx())!==h?(Re(),_x()!==h?(Re(),(le=dx())!==h?(Re(),xo()!==h?L=Ace(ie,le):(U=L,L=h)):(U=L,L=h)):(U=L,L=h)):(U=L,L=h)):(U=L,L=h)):(U=L,L=h),L===h&&(L=U,(W=t0())!==h?(Re(),_o()!==h?(Re(),(ie=dx())!==h?(Re(),xo()!==h?L=Pce(ie):(U=L,L=h)):(U=L,L=h)):(U=L,L=h)):(U=L,L=h),L===h&&(L=U,(W=t0())!==h&&(W=Lce()),L=W)))),L}function Eb(){var L,W;return L=U,(W=nN())!==h&&(W=Oce()),(L=W)===h&&(L=U,(W=sN())!==h&&(W=Rce()),(L=W)===h&&(L=U,(W=oN())!==h&&(W=Fce()),(L=W)===h&&(L=U,(W=rN())!==h&&(W=Nce()),(L=W)===h&&(L=U,(W=iN())!==h&&(W=Dce()),L=W)))),L}function dx(){var L;return(L=Om())!==h&&(L=jce(L)),L}function fx(){var L;return(L=Om())!==h&&(L=Vce(L)),L}function dhe(){var L,W;return L=U,Ahe()!==h?(Re(),(W=Lm())!==h?L=zce(W):(U=L,L=h)):(U=L,L=h),L}function fhe(){var L;return(L=xhe())!==h&&(L=Gce()),L}function yhe(){var L,W;return L=U,(W=She())!==h&&(W=Bce()),(L=W)===h&&(L=U,(W=Mhe())!==h&&(W=Uce()),L=W),L}function Lm(){var L;return(L=z$())===h&&(L=V$()),L}function z$(){var L,W,ie,le,_t;if(L=U,n.charCodeAt(U)===39?(W=he,U++):(W=h,Ee===0&&wt(se)),W===h&&(n.substr(U,2)===fe?(W=fe,U+=2):(W=h,Ee===0&&wt(ge))),W!==h){for(ie=[],le=U,n.substr(U,2)===ye?(_t=ye,U+=2):(_t=h,Ee===0&&wt(me)),_t!==h&&(_t=LF()),(le=_t)===h&&(S.test(n.charAt(U))?(le=n.charAt(U),U++):(le=h,Ee===0&&wt(Ie)));le!==h;)ie.push(le),le=U,n.substr(U,2)===ye?(_t=ye,U+=2):(_t=h,Ee===0&&wt(me)),_t!==h&&(_t=LF()),(le=_t)===h&&(S.test(n.charAt(U))?(le=n.charAt(U),U++):(le=h,Ee===0&&wt(Ie)));n.charCodeAt(U)===39?(le=he,U++):(le=h,Ee===0&&wt(se)),le!==h?L=qce(ie):(U=L,L=h)}else U=L,L=h;return L}function mhe(){var L;return(L=ghe())===h&&(L=vhe()),L}function ghe(){var L,W,ie,le,_t;if(L=U,bx()!==h)if(Re(),(W=xn())!==h){for(Re(),ie=[],le=mx();le!==h;)ie.push(le),le=mx();le=Re(),(_t=wx())!==h?L=Hce(W,ie):(U=L,L=h)}else U=L,L=h;else U=L,L=h;if(L===h)if(L=U,bx()!==h)if(Re(),(W=xn())!==h){for(Re(),ie=[],le=mx();le!==h;)ie.push(le),le=mx();le=Re(),(_t=HF())!==h?(Re(),wx()!==h?L=Wce(W,ie,_t):(U=L,L=h)):(U=L,L=h)}else U=L,L=h;else U=L,L=h;return L}function vhe(){var L,W,ie,le;if(L=U,bx()!==h){for(Re(),W=[],ie=yx();ie!==h;)W.push(ie),ie=yx();ie=Re(),(le=wx())!==h?L=Jce(W):(U=L,L=h)}else U=L,L=h;if(L===h)if(L=U,bx()!==h){for(Re(),W=[],ie=yx();ie!==h;)W.push(ie),ie=yx();ie=Re(),(le=HF())!==h?(Re(),wx()!==h?L=Zce(W,le):(U=L,L=h)):(U=L,L=h)}else U=L,L=h;return L}function yx(){var L,W,ie;return L=U,aN()!==h?(Re(),(W=xn())!==h?(Re(),lN()!==h?(Re(),(ie=xn())!==h?L=Kce(W,ie):(U=L,L=h)):(U=L,L=h)):(U=L,L=h)):(U=L,L=h),L}function mx(){var L,W,ie;return L=U,aN()!==h?(Re(),(W=xn())!==h?(Re(),lN()!==h?(Re(),(ie=xn())!==h?L=Yce(W,ie):(U=L,L=h)):(U=L,L=h)):(U=L,L=h)):(U=L,L=h),L}function HF(){var L,W;return L=U,Fhe()!==h?(Re(),(W=xn())!==h?L=Xce(W):(U=L,L=h)):(U=L,L=h),L}function bhe(){var L,W,ie,le;return L=U,(W=whe())!==h?(ie=U,Ee++,le=j$(),Ee--,le===h?ie=void 0:(U=ie,ie=h),ie!==h?L=Qce(W):(U=L,L=h)):(U=L,L=h),L}function whe(){var L,W,ie,le;return L=U,(W=gx())!==h&&(ie=WF())!==h&&(le=JF())!==h?L=eue(W,ie,le):(U=L,L=h),L===h&&(L=U,(W=gx())!==h&&(ie=WF())!==h?L=tue(W,ie):(U=L,L=h),L===h&&(L=U,(W=gx())!==h&&(ie=JF())!==h?L=iue(W,ie):(U=L,L=h),L===h&&(L=U,(W=gx())!==h&&(W=rue(W)),L=W))),L}function gx(){var L,W,ie;return(L=Om())===h&&(L=U,n.charCodeAt(U)===45?(W=J,U++):(W=h,Ee===0&&wt(D)),W===h&&(n.charCodeAt(U)===43?(W=q,U++):(W=h,Ee===0&&wt(R))),W!==h&&(ie=Om())!==h?L=nue(W,ie):(U=L,L=h)),L}function WF(){var L,W,ie;return L=U,n.charCodeAt(U)===46?(W=xe,U++):(W=h,Ee===0&&wt(De)),W!==h?((ie=Om())===h&&(ie=null),L=sue(ie)):(U=L,L=h),L}function JF(){var L,W,ie;return L=U,(W=_he())!==h&&(ie=Om())!==h?L=oue(W,ie):(U=L,L=h),L}function Om(){var L,W;if(L=[],(W=ZF())!==h)for(;W!==h;)L.push(W),W=ZF();else L=h;return L!==h&&(L=aue(L)),L}function ZF(){var L;return p.test(n.charAt(U))?(L=n.charAt(U),U++):(L=h,Ee===0&&wt(Fe)),L}function _he(){var L,W,ie;return L=U,l.test(n.charAt(U))?(W=n.charAt(U),U++):(W=h,Ee===0&&wt(gt)),W!==h?(s.test(n.charAt(U))?(ie=n.charAt(U),U++):(ie=h,Ee===0&&wt(Ze)),ie===h&&(ie=null),L=lue(W,ie)):(U=L,L=h),L}function xhe(){var L,W,ie,le;return L=U,n.substr(U,4).toLowerCase()===Se?(W=n.substr(U,4),U+=4):(W=h,Ee===0&&wt(Vt)),W!==h?(ie=U,Ee++,le=Ei(),Ee--,le===h?ie=void 0:(U=ie,ie=h),ie!==h?L=W=[W,ie]:(U=L,L=h)):(U=L,L=h),L}function She(){var L,W,ie,le;return L=U,n.substr(U,4).toLowerCase()===Ae?(W=n.substr(U,4),U+=4):(W=h,Ee===0&&wt(Rt)),W!==h?(ie=U,Ee++,le=Ei(),Ee--,le===h?ie=void 0:(U=ie,ie=h),ie!==h?L=W=[W,ie]:(U=L,L=h)):(U=L,L=h),L}function Mhe(){var L,W,ie,le;return L=U,n.substr(U,5).toLowerCase()===Oe?(W=n.substr(U,5),U+=5):(W=h,Ee===0&&wt(lt)),W!==h?(ie=U,Ee++,le=Ei(),Ee--,le===h?ie=void 0:(U=ie,ie=h),ie!==h?L=W=[W,ie]:(U=L,L=h)):(U=L,L=h),L}function G$(){var L,W,ie,le;return L=U,n.substr(U,2).toLowerCase()===bt?(W=n.substr(U,2),U+=2):(W=h,Ee===0&&wt(Ui)),W!==h?(ie=U,Ee++,le=Ei(),Ee--,le===h?ie=void 0:(U=ie,ie=h),ie!==h?L=cue():(U=L,L=h)):(U=L,L=h),L}function KF(){var L,W,ie,le;return L=U,n.substr(U,2).toLowerCase()===st?(W=n.substr(U,2),U+=2):(W=h,Ee===0&&wt(Vr)),W!==h?(ie=U,Ee++,le=Ei(),Ee--,le===h?ie=void 0:(U=ie,ie=h),ie!==h?L=uue():(U=L,L=h)):(U=L,L=h),L}function YF(){var L,W,ie,le;return L=U,n.substr(U,4).toLowerCase()===et?(W=n.substr(U,4),U+=4):(W=h,Ee===0&&wt(Wi)),W!==h?(ie=U,Ee++,le=Ei(),Ee--,le===h?ie=void 0:(U=ie,ie=h),ie!==h?L=hue():(U=L,L=h)):(U=L,L=h),L}function Ihe(){var L,W,ie,le;return L=U,n.substr(U,6).toLowerCase()===He?(W=n.substr(U,6),U+=6):(W=h,Ee===0&&wt(Mi)),W!==h?(ie=U,Ee++,le=Ei(),Ee--,le===h?ie=void 0:(U=ie,ie=h),ie!==h?L=pue():(U=L,L=h)):(U=L,L=h),L}function Tb(){var L,W,ie,le;return L=U,n.substr(U,3).toLowerCase()===Et?(W=n.substr(U,3),U+=3):(W=h,Ee===0&&wt(Ii)),W!==h?(ie=U,Ee++,le=Ei(),Ee--,le===h?ie=void 0:(U=ie,ie=h),ie!==h?L=due():(U=L,L=h)):(U=L,L=h),L}function vx(){var L,W,ie,le;return L=U,n.substr(U,3).toLowerCase()===Gt?(W=n.substr(U,3),U+=3):(W=h,Ee===0&&wt(ri)),W!==h?(ie=U,Ee++,le=Ei(),Ee--,le===h?ie=void 0:(U=ie,ie=h),ie!==h?L=fue():(U=L,L=h)):(U=L,L=h),L}function XF(){var L,W,ie,le;return L=U,n.substr(U,2).toLowerCase()===pi?(W=n.substr(U,2),U+=2):(W=h,Ee===0&&wt(sr)),W!==h?(ie=U,Ee++,le=Ei(),Ee--,le===h?ie=void 0:(U=ie,ie=h),ie!==h?L=yue():(U=L,L=h)):(U=L,L=h),L}function QF(){var L,W,ie,le;return L=U,n.substr(U,7).toLowerCase()===ei?(W=n.substr(U,7),U+=7):(W=h,Ee===0&&wt(Qt)),W!==h?(ie=U,Ee++,le=Ei(),Ee--,le===h?ie=void 0:(U=ie,ie=h),ie!==h?L=mue():(U=L,L=h)):(U=L,L=h),L}function B$(){var L,W,ie,le;return L=U,n.substr(U,4).toLowerCase()===pn?(W=n.substr(U,4),U+=4):(W=h,Ee===0&&wt(tn)),W!==h?(ie=U,Ee++,le=Ei(),Ee--,le===h?ie=void 0:(U=ie,ie=h),ie!==h?L=gue():(U=L,L=h)):(U=L,L=h),L}function $he(){var L,W,ie,le;return L=U,n.substr(U,3).toLowerCase()===Sr?(W=n.substr(U,3),U+=3):(W=h,Ee===0&&wt(di)),W!==h?(ie=U,Ee++,le=Ei(),Ee--,le===h?ie=void 0:(U=ie,ie=h),ie!==h?L=vue():(U=L,L=h)):(U=L,L=h),L}function Ehe(){var L,W,ie,le;return L=U,n.substr(U,9).toLowerCase()===je?(W=n.substr(U,9),U+=9):(W=h,Ee===0&&wt(Zn)),W!==h?(ie=U,Ee++,le=Ei(),Ee--,le===h?ie=void 0:(U=ie,ie=h),ie!==h?L=bue():(U=L,L=h)):(U=L,L=h),L}function The(){var L,W,ie,le;return L=U,n.substr(U,7).toLowerCase()===at?(W=n.substr(U,7),U+=7):(W=h,Ee===0&&wt(Pi)),W!==h?(ie=U,Ee++,le=Ei(),Ee--,le===h?ie=void 0:(U=ie,ie=h),ie!==h?L=wue():(U=L,L=h)):(U=L,L=h),L}function eN(){var L,W,ie,le;return L=U,n.substr(U,4).toLowerCase()===rt?(W=n.substr(U,4),U+=4):(W=h,Ee===0&&wt(qp)),W!==h?(ie=U,Ee++,le=Ei(),Ee--,le===h?ie=void 0:(U=ie,ie=h),ie!==h?L=_ue():(U=L,L=h)):(U=L,L=h),L}function Che(){var L,W,ie,le;return L=U,n.substr(U,8).toLowerCase()===It?(W=n.substr(U,8),U+=8):(W=h,Ee===0&&wt(Hp)),W!==h?(ie=U,Ee++,le=Ei(),Ee--,le===h?ie=void 0:(U=ie,ie=h),ie!==h?L=xue():(U=L,L=h)):(U=L,L=h),L}function khe(){var L,W,ie,le;return L=U,n.substr(U,9).toLowerCase()===ni?(W=n.substr(U,9),U+=9):(W=h,Ee===0&&wt(Wp)),W!==h?(ie=U,Ee++,le=Ei(),Ee--,le===h?ie=void 0:(U=ie,ie=h),ie!==h?L=Sue():(U=L,L=h)):(U=L,L=h),L}function Ahe(){var L,W,ie,le;return L=U,n.substr(U,4).toLowerCase()===Ai?(W=n.substr(U,4),U+=4):(W=h,Ee===0&&wt(vs)),W!==h?(ie=U,Ee++,le=Ei(),Ee--,le===h?ie=void 0:(U=ie,ie=h),ie!==h?L=Mue():(U=L,L=h)):(U=L,L=h),L}function Phe(){var L,W,ie,le;return L=U,n.substr(U,7).toLowerCase()===Ut?(W=n.substr(U,7),U+=7):(W=h,Ee===0&&wt(P$)),W!==h?(ie=U,Ee++,le=Ei(),Ee--,le===h?ie=void 0:(U=ie,ie=h),ie!==h?L=Iue():(U=L,L=h)):(U=L,L=h),L}function Lhe(){var L,W,ie,le;return L=U,n.substr(U,8).toLowerCase()===pe?(W=n.substr(U,8),U+=8):(W=h,Ee===0&&wt(L$)),W!==h?(ie=U,Ee++,le=Ei(),Ee--,le===h?ie=void 0:(U=ie,ie=h),ie!==h?L=$ue():(U=L,L=h)):(U=L,L=h),L}function Ohe(){var L,W,ie,le;return L=U,n.substr(U,4).toLowerCase()===be?(W=n.substr(U,4),U+=4):(W=h,Ee===0&&wt(de)),W!==h?(ie=U,Ee++,le=Ei(),Ee--,le===h?ie=void 0:(U=ie,ie=h),ie!==h?L=Eue():(U=L,L=h)):(U=L,L=h),L}function Rhe(){var L,W,ie,le;return L=U,n.substr(U,2).toLowerCase()===Le?(W=n.substr(U,2),U+=2):(W=h,Ee===0&&wt(Ne)),W!==h?(ie=U,Ee++,le=Ei(),Ee--,le===h?ie=void 0:(U=ie,ie=h),ie!==h?L=Tue():(U=L,L=h)):(U=L,L=h),L}function tN(){var L,W,ie,le;return L=U,n.substr(U,8).toLowerCase()===Ve?(W=n.substr(U,8),U+=8):(W=h,Ee===0&&wt(Ke)),W!==h?(ie=U,Ee++,le=Ei(),Ee--,le===h?ie=void 0:(U=ie,ie=h),ie!==h?L=Cue():(U=L,L=h)):(U=L,L=h),L}function iN(){var L,W,ie,le;return L=U,n.substr(U,4).toLowerCase()===Ge?(W=n.substr(U,4),U+=4):(W=h,Ee===0&&wt(ai)),W!==h?(ie=U,Ee++,le=Ei(),Ee--,le===h?ie=void 0:(U=ie,ie=h),ie!==h?L=kue():(U=L,L=h)):(U=L,L=h),L}function rN(){var L,W,ie,le;return L=U,n.substr(U,5).toLowerCase()===Be?(W=n.substr(U,5),U+=5):(W=h,Ee===0&&wt(Kn)),W!==h?(ie=U,Ee++,le=Ei(),Ee--,le===h?ie=void 0:(U=ie,ie=h),ie!==h?L=Aue():(U=L,L=h)):(U=L,L=h),L}function nN(){var L,W,ie,le;return L=U,n.substr(U,3).toLowerCase()===Q?(W=n.substr(U,3),U+=3):(W=h,Ee===0&&wt(Ar)),W!==h?(ie=U,Ee++,le=Ei(),Ee--,le===h?ie=void 0:(U=ie,ie=h),ie!==h?L=Pue():(U=L,L=h)):(U=L,L=h),L}function sN(){var L,W,ie,le;return L=U,n.substr(U,4).toLowerCase()===Je?(W=n.substr(U,4),U+=4):(W=h,Ee===0&&wt(Bo)),W!==h?(ie=U,Ee++,le=Ei(),Ee--,le===h?ie=void 0:(U=ie,ie=h),ie!==h?L=Lue():(U=L,L=h)):(U=L,L=h),L}function oN(){var L,W,ie,le;return L=U,n.substr(U,6).toLowerCase()===Qe?(W=n.substr(U,6),U+=6):(W=h,Ee===0&&wt(Pm)),W!==h?(ie=U,Ee++,le=Ei(),Ee--,le===h?ie=void 0:(U=ie,ie=h),ie!==h?L=Oue():(U=L,L=h)):(U=L,L=h),L}function t0(){var L,W,ie,le;return L=U,n.substr(U,6).toLowerCase()===Pe?(W=n.substr(U,6),U+=6):(W=h,Ee===0&&wt(Ale)),W!==h?(ie=U,Ee++,le=Ei(),Ee--,le===h?ie=void 0:(U=ie,ie=h),ie!==h?L=Rue():(U=L,L=h)):(U=L,L=h),L}function bx(){var L,W,ie,le;return L=U,n.substr(U,4).toLowerCase()===dt?(W=n.substr(U,4),U+=4):(W=h,Ee===0&&wt(Ple)),W!==h?(ie=U,Ee++,le=Ei(),Ee--,le===h?ie=void 0:(U=ie,ie=h),ie!==h?L=Fue():(U=L,L=h)):(U=L,L=h),L}function wx(){var L,W,ie,le;return L=U,n.substr(U,3).toLowerCase()===vt?(W=n.substr(U,3),U+=3):(W=h,Ee===0&&wt(Lle)),W!==h?(ie=U,Ee++,le=Ei(),Ee--,le===h?ie=void 0:(U=ie,ie=h),ie!==h?L=Nue():(U=L,L=h)):(U=L,L=h),L}function aN(){var L,W,ie,le;return L=U,n.substr(U,4).toLowerCase()===$t?(W=n.substr(U,4),U+=4):(W=h,Ee===0&&wt(Ole)),W!==h?(ie=U,Ee++,le=Ei(),Ee--,le===h?ie=void 0:(U=ie,ie=h),ie!==h?L=Due():(U=L,L=h)):(U=L,L=h),L}function lN(){var L,W,ie,le;return L=U,n.substr(U,4).toLowerCase()===Ct?(W=n.substr(U,4),U+=4):(W=h,Ee===0&&wt(Rle)),W!==h?(ie=U,Ee++,le=Ei(),Ee--,le===h?ie=void 0:(U=ie,ie=h),ie!==h?L=jue():(U=L,L=h)):(U=L,L=h),L}function Fhe(){var L,W,ie,le;return L=U,n.substr(U,4).toLowerCase()===qt?(W=n.substr(U,4),U+=4):(W=h,Ee===0&&wt(Fle)),W!==h?(ie=U,Ee++,le=Ei(),Ee--,le===h?ie=void 0:(U=ie,ie=h),ie!==h?L=Vue():(U=L,L=h)):(U=L,L=h),L}function _x(){var L;return n.charCodeAt(U)===44?(L=oi,U++):(L=h,Ee===0&&wt(Nle)),L}function _o(){var L;return n.charCodeAt(U)===40?(L=Si,U++):(L=h,Ee===0&&wt(Dle)),L}function xo(){var L;return n.charCodeAt(U)===41?(L=Bi,U++):(L=h,Ee===0&&wt(jle)),L}function Re(){var L,W;for(L=[],W=cN();W!==h;)L.push(W),W=cN();return L}function cN(){var L;return a.test(n.charAt(U))?(L=n.charAt(U),U++):(L=h,Ee===0&&wt(Vle)),L}function Nhe(){var L,W,ie,le;if(L=U,(W=GF())!==h&&(W=zue(W)),(L=W)===h)if(L=U,n.charCodeAt(U)===96?(W=Ue,U++):(W=h,Ee===0&&wt(AF)),W!==h){if(ie=[],u.test(n.charAt(U))?(le=n.charAt(U),U++):(le=h,Ee===0&&wt(PF)),le!==h)for(;le!==h;)ie.push(le),u.test(n.charAt(U))?(le=n.charAt(U),U++):(le=h,Ee===0&&wt(PF));else ie=h;ie!==h?(n.charCodeAt(U)===96?(le=Ue,U++):(le=h,Ee===0&&wt(AF)),le!==h?L=Gue(ie):(U=L,L=h)):(U=L,L=h)}else U=L,L=h;return L}function Dhe(L,W){return{type:"unary-expression",operator:L,expr:W}}function uN(L,W,ie,le){var _t={type:"binary-expression",operator:L,left:W,right:ie};return le!==void 0&&(_t.escape=le),_t}function jhe(L,W){for(var ie=[L],le=0;le<W.length;le++)ie.push(W[le][3]);return ie}function Vhe(L,W,ie){return jhe(L,W)}function Cb(L,W){for(var ie=L,le=0;le<W.length;le++)ie=uN(W[le][1],ie,W[le][3]);return ie}if((c=x())!==h&&U===n.length)return c;throw c!==h&&U<n.length&&wt(Bue()),Uue(O$,Bc<n.length?n.charAt(Bc):null,Bc<n.length?RF(Bc,Bc+1):RF(Bc,Bc))}return e(t,Error),t.prototype.format=function(n){var o="Error: "+this.message;if(this.location){var c,h=null;for(c=0;c<n.length;c++)if(n[c].source===this.location.source){h=n[c].text.split(/\r\n|\n|\r/g);break}var m=this.location.start,b=this.location.source+":"+m.line+":"+m.column;if(h){var x=this.location.end,I=i("",m.line.toString().length," "),E=h[m.line-1],k=(m.line===x.line?x.column:E.length+1)-m.column||1;o+=`
 --> `+b+`
`+I+` |
`+m.line+" | "+E+`
`+I+" | "+i("",m.column-1," ")+i("",k,"^")}else o+=`
 at `+b}return o},t.buildMessage=function(n,o){var c={literal:function(k){return'"'+m(k.text)+'"'},class:function(k){var P=k.parts.map(function(F){return Array.isArray(F)?b(F[0])+"-"+b(F[1]):b(F)});return"["+(k.inverted?"^":"")+P.join("")+"]"},any:function(){return"any character"},end:function(){return"end of input"},other:function(k){return k.description}};function h(k){return k.charCodeAt(0).toString(16).toUpperCase()}function m(k){return k.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(P){return"\\x0"+h(P)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(P){return"\\x"+h(P)})}function b(k){return k.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(P){return"\\x0"+h(P)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(P){return"\\x"+h(P)})}function x(k){return c[k.type](k)}function I(k){var P,F,N=k.map(x);if(N.sort(),N.length>0){for(P=1,F=1;P<N.length;P++)N[P-1]!==N[P]&&(N[F]=N[P],F++);N.length=F}switch(N.length){case 1:return N[0];case 2:return N[0]+" or "+N[1];default:return N.slice(0,-1).join(", ")+", or "+N[N.length-1]}}function E(k){return k?'"'+m(k)+'"':"end of input"}return"Expected "+I(n)+" but "+E(o)+" found."},{SyntaxError:t,parse:r}},(ire=nre).exports&&(ire.exports=rre());class QOe{static parse(t){return nre.exports.parse(t)}}const sre=/^(\d{4})-(\d{1,2})-(\d{1,2})$/,eRe=/^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2}):(\d{1,2}(\.[0-9]+)?)$/,tRe=/^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2}):(\d{1,2}(\.[0-9]+)?)(\+|\-)(\d{1,2}):(\d{1,2})$/,iRe=/^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2})(\+|\-)(\d{1,2}):(\d{1,2})$/,rRe=/^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2})$/,nRe=new Set(["current_timestamp","current_date","current_time"]);function am(e,t){return(e+="").length>=t?e:new Array(t-e.length+1).join("0")+e}function S3(e,t,i="0",r="0",n="0",o="0",c="",h="0",m="0"){if(c==="+"||c==="-"){const b=`${am(parseInt(e,10),4)}-${am(parseInt(t,10),2)}-${am(parseInt(i,10),2)}`;let x="";parseFloat(o)<10&&(x="0");const I=`${am(parseInt(r,10),2)}:${am(parseInt(n,10),2)}:${x+parseFloat(o).toString()}`,E=`${c}${am(parseInt(h,10),2)}:${am(parseInt(m,10),2)}`;return new Date(b+"T"+I+E)}return new Date(parseInt(e,10),parseInt(t,10)-1,parseInt(i,10),parseInt(r,10),parseInt(n,10),parseFloat(o))}class sRe{static makeBool(t){return are(t)}static featureValue(t,i,r,n){return dre(t,i,r,n)}static equalsNull(t){return t===null}static applyLike(t,i,r){return xO(t,i,r)}static ensureArray(t){return wO(t)}static applyIn(t,i){return _O(t,i)}static currentDate(){const t=new Date;return t.setHours(0,0,0,0),t}static makeSqlInterval(t,i,r){return Vo.createFromValueAndQualifer(t,i,r)}static convertInterval(t){return t instanceof Vo?t.valueInMilliseconds():t}static currentTimestamp(){return new Date}static compare(t,i,r){return hre(t,i,r)}static calculate(t,i,r){return pre(t,i,r)}static makeComparable(t){return _p(t)}static evaluateFunction(t,i){return ere(t,i)}static lookup(t,i){const r=i[t];return r===void 0?null:r}static between(t,i){return t==null||i[0]==null||i[1]==null?null:t>=i[0]&&t<=i[1]}static notbetween(t,i){return t==null||i[0]==null||i[1]==null?null:t<i[0]||t>i[1]}static ternaryNot(t){return s4(t)}static ternaryAnd(t,i){return lre(t,i)}static ternaryOr(t,i){return cre(t,i)}}class n4{constructor(t,i){this.fieldsIndex=i,this._datefields={},this.parameters={},this._hasDateFunctions=void 0,this.parseTree=QOe.parse(t);const{isStandardized:r,isAggregate:n,referencedFieldNames:o}=this._extractExpressionInfo(i);this._referencedFieldNames=o,this.isStandardized=r,this.isAggregate=n}static create(t,i){return new n4(t,i)}get fieldNames(){return this._referencedFieldNames}testSet(t,i=cm){const r={};for(const n of this.fieldNames)r[n]=t.map(o=>i.getAttribute(o,n));return!!this._evaluateNode(this.parseTree,{attributes:r},cm)}calculateValue(t,i=cm){const r=this._evaluateNode(this.parseTree,t,i);return r instanceof Vo?r.valueInMilliseconds()/864e5:r}calculateValueCompiled(t,i=cm){return this.parseTree._compiledVersion!=null?this.parseTree._compiledVersion(t,this.parameters,i,this._datefields):Te("esri-csp-restrictions")?this.calculateValue(t,i):(this._compileMe(),this.parseTree._compiledVersion(t,this.parameters,i,this._datefields))}testFeature(t,i=cm){return!!this._evaluateNode(this.parseTree,t,i)}testFeatureCompiled(t,i=cm){return this.parseTree._compiledVersion!=null?!!this.parseTree._compiledVersion(t,this.parameters,i,this._datefields):Te("esri-csp-restrictions")?this.testFeature(t,i):(this._compileMe(),!!this.parseTree._compiledVersion(t,this.parameters,i,this._datefields))}get hasDateFunctions(){return this._hasDateFunctions!=null||(this._hasDateFunctions=!1,this._visitAll(this.parseTree,t=>{t.type==="current-time"?this._hasDateFunctions=!0:t.type==="function"&&(this._hasDateFunctions=this._hasDateFunctions||nRe.has(t.name.toLowerCase()))})),this._hasDateFunctions}getFunctions(){const t=new Set;return this._visitAll(this.parseTree,i=>{i.type==="function"&&t.add(i.name.toLowerCase())}),Array.from(t)}getExpressions(){const t=new Map;return this._visitAll(this.parseTree,i=>{if(i.type==="function"){const r=i.name.toLowerCase(),n=i.args.value[0];if(n.type==="column-reference"){const o=n.column,c=`${r}-${o}`;t.has(c)||t.set(c,{aggregateType:r,field:o})}}}),[...t.values()]}getVariables(){const t=new Set;return this._visitAll(this.parseTree,i=>{i.type==="parameter"&&t.add(i.value.toLowerCase())}),Array.from(t)}_compileMe(){const t="return this.convertInterval("+this.evaluateNodeToJavaScript(this.parseTree)+")";this.parseTree._compiledVersion=new Function("feature","lookups","attributeAdapter","datefields",t).bind(sRe)}_extractExpressionInfo(t){const i=[],r=new Set;let n=!0,o=!0;return this._visitAll(this.parseTree,c=>{var h;switch(c.type){case"column-reference":{const m=t==null?void 0:t.get(c.column);let b,x;m?b=x=(h=m.name)!=null?h:"":(x=c.column,b=x.toLowerCase()),m&&m.name&&(m.type==="date"||m.type==="esriFieldTypeDate")&&(this._datefields[m.name]=1),r.has(b)||(r.add(b),i.push(x)),c.column=x;break}case"function":{const{name:m,args:b}=c,x=b.value.length;n&&(n=XOe(m,x)),o&&(o=KOe(m,x));break}}}),{referencedFieldNames:Array.from(i),isStandardized:n,isAggregate:o}}_visitAll(t,i){if(t!=null)switch(i(t),t.type){case"when-clause":this._visitAll(t.operand,i),this._visitAll(t.value,i);break;case"case-expression":for(const r of t.clauses)this._visitAll(r,i);t.format==="simple"&&this._visitAll(t.operand,i),t.else!==null&&this._visitAll(t.else,i);break;case"expression-list":for(const r of t.value)this._visitAll(r,i);break;case"unary-expression":this._visitAll(t.expr,i);break;case"binary-expression":this._visitAll(t.left,i),this._visitAll(t.right,i);break;case"function":this._visitAll(t.args,i)}}evaluateNodeToJavaScript(t){switch(t.type){case"interval":return"this.makeSqlInterval("+this.evaluateNodeToJavaScript(t.value)+", "+JSON.stringify(t.qualifier)+","+JSON.stringify(t.op)+")";case"case-expression":{let i="";if(t.format==="simple"){const r="this.makeComparable("+this.evaluateNodeToJavaScript(t.operand)+")";i="( ";for(let n=0;n<t.clauses.length;n++)i+=" ("+r+" === this.makeComparable("+this.evaluateNodeToJavaScript(t.clauses[n].operand)+")) ? ("+this.evaluateNodeToJavaScript(t.clauses[n].value)+") : ";t.else!==null?i+=this.evaluateNodeToJavaScript(t.else):i+="null",i+=" )"}else{i="( ";for(let r=0;r<t.clauses.length;r++)i+=" this.makeBool("+this.evaluateNodeToJavaScript(t.clauses[r].operand)+")===true ? ("+this.evaluateNodeToJavaScript(t.clauses[r].value)+") : ";t.else!==null?i+=this.evaluateNodeToJavaScript(t.else):i+="null",i+=" )"}return i}case"parameter":return"this.lookup("+JSON.stringify(t.value.toLowerCase())+",lookups)";case"expression-list":{let i="[";for(const r of t.value)i!=="["&&(i+=","),i+=this.evaluateNodeToJavaScript(r);return i+="]",i}case"unary-expression":return"this.ternaryNot("+this.evaluateNodeToJavaScript(t.expr)+")";case"binary-expression":switch(t.operator){case"AND":return"this.ternaryAnd("+this.evaluateNodeToJavaScript(t.left)+","+this.evaluateNodeToJavaScript(t.right)+" )";case"OR":return"this.ternaryOr("+this.evaluateNodeToJavaScript(t.left)+","+this.evaluateNodeToJavaScript(t.right)+" )";case"IS":if(t.right.type!=="null")throw new Error("Unsupported RHS for IS");return"this.equalsNull("+this.evaluateNodeToJavaScript(t.left)+")";case"ISNOT":if(t.right.type!=="null")throw new Error("Unsupported RHS for IS");return"(!(this.equalsNull("+this.evaluateNodeToJavaScript(t.left)+")))";case"IN":return"this.applyIn("+this.evaluateNodeToJavaScript(t.left)+",this.ensureArray("+this.evaluateNodeToJavaScript(t.right)+"))";case"NOT IN":return"this.ternaryNot(this.applyIn("+this.evaluateNodeToJavaScript(t.left)+",this.ensureArray("+this.evaluateNodeToJavaScript(t.right)+")))";case"BETWEEN":return"this.between("+this.evaluateNodeToJavaScript(t.left)+","+this.evaluateNodeToJavaScript(t.right)+")";case"NOTBETWEEN":return"this.notbetween("+this.evaluateNodeToJavaScript(t.left)+","+this.evaluateNodeToJavaScript(t.right)+")";case"LIKE":return"this.applyLike("+this.evaluateNodeToJavaScript(t.left)+","+this.evaluateNodeToJavaScript(t.right)+","+JSON.stringify(t.escape)+")";case"NOT LIKE":return"this.ternaryNot(this.applyLike("+this.evaluateNodeToJavaScript(t.left)+","+this.evaluateNodeToJavaScript(t.right)+","+JSON.stringify(t.escape)+"))";case"<>":case"<":case">":case">=":case"<=":case"=":return"this.compare("+JSON.stringify(t.operator)+","+this.evaluateNodeToJavaScript(t.left)+","+this.evaluateNodeToJavaScript(t.right)+")";case"*":case"-":case"+":case"/":return"this.calculate("+JSON.stringify(t.operator)+","+this.evaluateNodeToJavaScript(t.left)+","+this.evaluateNodeToJavaScript(t.right)+")"}throw new Error("Not Supported Operator "+t.operator);case"null":case"boolean":case"string":case"number":return JSON.stringify(t.value);case"date":return"(new Date("+ore(t.value).getTime().toString()+"))";case"timestamp":return"(new Date("+bO(t.value).getTime().toString()+"))";case"current-time":return t.mode==="date"?"this.currentDate()":"this.currentTimestamp()";case"column-reference":return"this.featureValue(feature,"+JSON.stringify(t.column)+",datefields,attributeAdapter)";case"function":return"this.evaluateFunction("+JSON.stringify(t.name)+","+this.evaluateNodeToJavaScript(t.args)+")"}throw new Error("Unsupported sql syntax "+t.type)}_evaluateNode(t,i,r){switch(t.type){case"interval":{const n=this._evaluateNode(t.value,i,r);return Vo.createFromValueAndQualifer(n,t.qualifier,t.op)}case"case-expression":if(t.format==="simple"){const n=_p(this._evaluateNode(t.operand,i,r));for(let o=0;o<t.clauses.length;o++)if(n===_p(this._evaluateNode(t.clauses[o].operand,i,r)))return this._evaluateNode(t.clauses[o].value,i,r);if(t.else!==null)return this._evaluateNode(t.else,i,r)}else{for(let n=0;n<t.clauses.length;n++)if(are(this._evaluateNode(t.clauses[n].operand,i,r)))return this._evaluateNode(t.clauses[n].value,i,r);if(t.else!==null)return this._evaluateNode(t.else,i,r)}return null;case"parameter":return this.parameters[t.value.toLowerCase()];case"expression-list":{const n=[];for(const o of t.value)n.push(this._evaluateNode(o,i,r));return n}case"unary-expression":return s4(this._evaluateNode(t.expr,i,r));case"binary-expression":switch(t.operator){case"AND":return lre(this._evaluateNode(t.left,i,r),this._evaluateNode(t.right,i,r));case"OR":return cre(this._evaluateNode(t.left,i,r),this._evaluateNode(t.right,i,r));case"IS":if(t.right.type!=="null")throw new Error("Unsupported RHS for IS");return this._evaluateNode(t.left,i,r)===null;case"ISNOT":if(t.right.type!=="null")throw new Error("Unsupported RHS for IS");return this._evaluateNode(t.left,i,r)!==null;case"IN":{const n=wO(this._evaluateNode(t.right,i,r));return _O(this._evaluateNode(t.left,i,r),n)}case"NOT IN":{const n=wO(this._evaluateNode(t.right,i,r));return s4(_O(this._evaluateNode(t.left,i,r),n))}case"BETWEEN":{const n=this._evaluateNode(t.left,i,r),o=this._evaluateNode(t.right,i,r);return n==null||o[0]==null||o[1]==null?null:n>=_p(o[0])&&n<=_p(o[1])}case"NOTBETWEEN":{const n=this._evaluateNode(t.left,i,r),o=this._evaluateNode(t.right,i,r);return n==null||o[0]==null||o[1]==null?null:n<_p(o[0])||n>_p(o[1])}case"LIKE":return xO(this._evaluateNode(t.left,i,r),this._evaluateNode(t.right,i,r),t.escape);case"NOT LIKE":return s4(xO(this._evaluateNode(t.left,i,r),this._evaluateNode(t.right,i,r),t.escape));case"<>":case"<":case">":case">=":case"<=":case"=":return hre(t.operator,this._evaluateNode(t.left,i,r),this._evaluateNode(t.right,i,r));case"-":case"+":case"*":case"/":return pre(t.operator,this._evaluateNode(t.left,i,r),this._evaluateNode(t.right,i,r))}case"null":case"boolean":case"string":case"number":return t.value;case"date":return ore(t.value);case"timestamp":return bO(t.value);case"current-time":{const n=new Date;return t.mode==="date"&&n.setHours(0,0,0,0),n}case"column-reference":return dre(i,t.column,this._datefields,r);case"function":{const n=this._evaluateNode(t.args,i,r);return this.isAggregate?ZOe(t.name,n):ere(t.name,n)}}throw new Error("Unsupported sql syntax "+t.type)}}function bO(e){let t=eRe.exec(e);if(t!==null){const[,i,r,n,o,c,h]=t;return S3(i,r,n,o,c,h)}if(t=tRe.exec(e),t!==null){const[,i,r,n,o,c,h,m,b,x]=t;return S3(i,r,n,o,c,h,m,b,x)}if(t=iRe.exec(e),t!==null){const[,i,r,n,o,c,h,m,b]=t;return S3(i,r,n,o,c,"0",h,m,b)}if(t=rRe.exec(e),t!==null){const[,i,r,n,o,c]=t;return S3(i,r,n,o,c)}if(t=sre.exec(e),t!==null){const[,i,r,n]=t;return S3(i,r,n)}throw new Error("SQL Invalid Timestamp")}function ore(e){const t=sre.exec(e);if(t===null)try{return bO(e)}catch{throw new Error("SQL Invalid Date")}const[,i,r,n]=t;return new Date(parseInt(i,10),parseInt(r,10)-1,parseInt(n,10))}function are(e){return e===!0}function wO(e){return Array.isArray(e)?e:[e]}function s4(e){return e!==null?e!==!0:null}function lre(e,t){return e!=null&&t!=null?e===!0&&t===!0:e!==!1&&t!==!1&&null}function cre(e,t){return e!=null&&t!=null?e===!0||t===!0:e===!0||t===!0||null}function _O(e,t){if(e==null)return null;let i=!1;for(const r of t)if(r==null)i=null;else if(e===r){i=!0;break}return i}const ure="-[]/{}()*+?.\\^$|";var lm;function oRe(e,t){const i=t;let r="",n=lm.Normal;for(let o=0;o<e.length;o++){const c=e.charAt(o);switch(n){case lm.Normal:c===i?n=lm.Escaped:ure.includes(c)?r+="\\"+c:r+=c==="%"?".*":c==="_"?".":c;break;case lm.Escaped:ure.includes(c)?r+="\\"+c:r+=c,n=lm.Normal}}return new RegExp("^"+r+"$","m")}function xO(e,t,i){return e==null?null:oRe(t,i).test(e)}function _p(e){return e instanceof Date?e.valueOf():e}function hre(e,t,i){if(t==null||i==null)return null;const r=_p(t),n=_p(i);switch(e){case"<>":return r!==n;case"=":return r===n;case">":return r>n;case"<":return r<n;case">=":return r>=n;case"<=":return r<=n}}function pre(e,t,i){if(t instanceof Vo)if(i instanceof Date)switch(e){case"+":return new Date(t.valueInMilliseconds()+i.getTime());case"-":return t.valueInMilliseconds()-i.getTime();case"*":return t.valueInMilliseconds()*i.getTime();case"/":return t.valueInMilliseconds()/i.getTime()}else if(i instanceof Vo)switch(e){case"+":return Vo.createFromMilliseconds(t.valueInMilliseconds()+i.valueInMilliseconds());case"-":return Vo.createFromMilliseconds(t.valueInMilliseconds()-i.valueInMilliseconds());case"*":return t.valueInMilliseconds()*i.valueInMilliseconds();case"/":return t.valueInMilliseconds()/i.valueInMilliseconds()}else t=t.valueInMilliseconds();else if(i instanceof Vo)if(t instanceof Date)switch(e){case"+":return new Date(i.valueInMilliseconds()+t.getTime());case"-":return new Date(t.getTime()-i.valueInMilliseconds());case"*":return t.getTime()*i.valueInMilliseconds();case"/":return t.getTime()/i.valueInMilliseconds()}else i=i.valueInMilliseconds();else if(t instanceof Date&&typeof i=="number")switch(i=24*i*60*60*1e3,t=t.getTime(),e){case"+":return new Date(t+i);case"-":return new Date(t-i);case"*":return new Date(t*i);case"/":return new Date(t/i)}else if(i instanceof Date&&typeof t=="number")switch(t=24*t*60*60*1e3,i=i.getTime(),e){case"+":return new Date(t+i);case"-":return new Date(t-i);case"*":return new Date(t*i);case"/":return new Date(t/i)}switch(e){case"+":return t+i;case"-":return t-i;case"*":return t*i;case"/":return t/i}}function aRe(e){return e&&typeof e.attributes=="object"}function dre(e,t,i,r){const n=r.getAttribute(e,t);return n!=null&&i[t]===1?new Date(n):n}(function(e){e[e.Normal=0]="Normal",e[e.Escaped=1]="Escaped"})(lm||(lm={}));const cm={getAttribute:(e,t)=>(aRe(e)?e.attributes:e)[t]};var fre=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",WhereClause:n4,defaultAttributeAdapter:cm});class lRe{constructor(t,i){this._cache=new T7(t),this._invalidCache=new T7(i)}get(t,i){const r=`${i.uid}:${t}`,n=this._cache.get(r);if(n)return n;if(this._invalidCache.get(r)!==void 0)return null;try{const o=n4.create(t,i);return this._cache.put(r,o),o}catch{return this._invalidCache.put(r,null),null}}}const SO=new lRe(50,500),Lf="feature-store:unsupported-query",yre=" as ",cRe=new Set(["esriFieldTypeOID","esriFieldTypeSmallInteger","esriFieldTypeInteger","esriFieldTypeSingle","esriFieldTypeDouble","esriFieldTypeLong","esriFieldTypeDate"]);function kYe(e,t){if(!t)return!0;const i=SO.get(t,e);if(!i)throw new ue(Lf,"invalid SQL expression",{where:t});if(!i.isStandardized)throw new ue(Lf,"where clause is not standard",{where:t});return MO(e,i.fieldNames,"where clause contains missing fields"),!0}function AYe(e,t,i){if(!t)return!0;const r=SO.get(t,e);if(!r)throw new ue(Lf,"invalid SQL expression",{having:t});if(!r.isAggregate)throw new ue(Lf,"having does not contain a valid aggregate function",{having:t});const n=r.fieldNames;if(MO(e,n,"having contains missing fields"),!r.getExpressions().every(o=>{const{aggregateType:c,field:h}=o,m=e.has(h)&&e.get(h).name;return i.some(b=>{const{onStatisticField:x,statisticType:I}=b;return(e.has(x)&&e.get(x).name)===m&&I.toLowerCase().trim()===c})}))throw new ue(Lf,"expressions in having should also exist in outStatistics",{having:t});return!0}function M3(e,t){return e?SO.get(e,t):null}function MO(e,t,i,r=!0){const n=[];for(const o of t)if(o!=="*"&&!e.has(o))if(r){const c=mre(o);try{const h=M3(c,e);if(!h)throw new ue(Lf,"invalid SQL expression",{where:c});if(!h.isStandardized)throw new ue(Lf,"expression is not standard",{clause:h});MO(e,h.fieldNames,"expression contains missing fields")}catch(h){const m=h&&h.details;if(m&&(m.clause||m.where))throw h;m&&m.missingFields?n.push(...m.missingFields):n.push(o)}}else n.push(o);if(n.length)throw new ue(Lf,i,{missingFields:n})}function mre(e){return e.split(yre)[0]}function uRe(e){return e.split(yre)[1]}function PYe(e,t){const i=t.get(e);return!!i&&!cRe.has(i.type)}const gre=new kt({classBreaksDef:"class-breaks-definition",uniqueValueDef:"unique-value-definition"});let Av=class extends ke{constructor(){super(...arguments),this.baseSymbol=null,this.colorRamp=null,this.type=null}};g([w({type:Ao,json:{write:!0}})],Av.prototype,"baseSymbol",void 0),g([w({types:fZ,json:{read:{reader:yZ},write:!0}})],Av.prototype,"colorRamp",void 0),g([w({json:{read:gre.read,write:gre.write}})],Av.prototype,"type",void 0),Av=g([te("esri.rest.support.ClassificationDefinition")],Av);const hRe=Av,vre=new kt({esriClassifyEqualInterval:"equal-interval",esriClassifyManual:"manual",esriClassifyNaturalBreaks:"natural-breaks",esriClassifyQuantile:"quantile",esriClassifyStandardDeviation:"standard-deviation",esriClassifyDefinedInterval:"defined-interval"}),bre=new kt({esriNormalizeByLog:"log",esriNormalizeByPercentOfTotal:"percent-of-total",esriNormalizeByField:"field"});let Oc=class extends hRe{constructor(){super(...arguments),this.breakCount=null,this.classificationField=null,this.classificationMethod=null,this.normalizationField=null,this.normalizationType=null,this.type="class-breaks-definition"}set standardDeviationInterval(e){this.classificationMethod==="standard-deviation"&&this._set("standardDeviationInterval",e)}set definedInterval(e){this.classificationMethod==="defined-interval"&&this._set("definedInterval",e)}};g([w({json:{write:!0}})],Oc.prototype,"breakCount",void 0),g([w({json:{write:!0}})],Oc.prototype,"classificationField",void 0),g([w({type:String,json:{read:vre.read,write:vre.write}})],Oc.prototype,"classificationMethod",void 0),g([w({json:{write:!0}})],Oc.prototype,"normalizationField",void 0),g([w({json:{read:bre.read,write:bre.write}})],Oc.prototype,"normalizationType",void 0),g([w({value:null,json:{write:!0}})],Oc.prototype,"standardDeviationInterval",null),g([w({value:null,json:{write:!0}})],Oc.prototype,"definedInterval",null),g([w()],Oc.prototype,"type",void 0),Oc=g([te("esri.rest.support.ClassBreaksDefinition")],Oc);const pRe=Oc,dRe=$e.getLogger("esri.rest.support.generateRendererUtils");function Pv(e,t){return Number(e.toFixed(t))}function fRe(e){const{normalizationTotal:t}=e;return{classBreaks:yRe(e),normalizationTotal:t}}function yRe(e){const t=e.definition,{classificationMethod:i,breakCount:r,normalizationType:n,definedInterval:o}=t,c=[];let h=e.values;if(h.length===0)return[];h=h.sort((x,I)=>x-I);const m=h[0],b=h[h.length-1];if(i==="equal-interval")if(h.length>=r){const x=(b-m)/r;let I=m;for(let E=1;E<r;E++){const k=Pv(m+E*x,6);c.push({minValue:I,maxValue:k,label:_a(I,k,n)}),I=k}c.push({minValue:I,maxValue:b,label:_a(I,b,n)})}else h.forEach(x=>{c.push({minValue:x,maxValue:x,label:_a(x,x,n)})});else if(i==="natural-breaks"){const x=mRe(h),I=e.valueFrequency||x.valueFrequency,E=gRe(x.uniqueValues,I,r);let k=m;for(let P=1;P<r;P++)if(x.uniqueValues.length>P){const F=Pv(x.uniqueValues[E[P]],6);c.push({minValue:k,maxValue:F,label:_a(k,F,n)}),k=F}c.push({minValue:k,maxValue:b,label:_a(k,b,n)})}else if(i==="quantile")if(h.length>=r&&m!==b){let x=m,I=Math.ceil(h.length/r),E=0;for(let k=1;k<r;k++){let P=I+E-1;P>h.length&&(P=h.length-1),P<0&&(P=0),c.push({minValue:x,maxValue:h[P],label:_a(x,h[P],n)}),x=h[P],E+=I,I=Math.ceil((h.length-E)/(r-k))}c.push({minValue:x,maxValue:b,label:_a(x,b,n)})}else{let x=-1;for(let I=0;I<h.length;I++){const E=h[I];E!==x&&(x=E,c.push({minValue:x,maxValue:E,label:_a(x,E,n)}),x=E)}}else if(i==="standard-deviation"){const x=wRe(h),I=_Re(h,x);if(I===0)c.push({minValue:h[0],maxValue:h[0],label:_a(h[0],h[0],n)});else{const E=bRe(m,b,r,x,I)*I;let k=0,P=m;for(let N=r;N>=1;N--){const B=Pv(x-(N-.5)*E,6);c.push({minValue:P,maxValue:B,label:_a(P,B,n)}),P=B,k++}let F=Pv(x+.5*E,6);c.push({minValue:P,maxValue:F,label:_a(P,F,n)}),P=F,k++;for(let N=1;N<=r;N++)F=k===2*r?b:Pv(x+(N+.5)*E,6),c.push({minValue:P,maxValue:F,label:_a(P,F,n)}),P=F,k++}}else if(i==="defined-interval"){if(!o)return c;const x=h[0],I=h[h.length-1],E=Math.ceil((I-x)/o);let k=x;for(let P=1;P<E;P++){const F=Pv(x+P*o,6);c.push({minValue:k,maxValue:F,label:_a(k,F,n)}),k=F}c.push({minValue:k,maxValue:I,label:_a(k,I,n)})}return c}function _a(e,t,i){let r=null;return r=e===t?i&&i==="percent-of-total"?e+"%":e.toString():i&&i==="percent-of-total"?e+"% - "+t+"%":e+" - "+t,r}function mRe(e){const t=[],i=[];let r=Number.MIN_VALUE,n=1,o=-1;for(let c=0;c<e.length;c++){const h=e[c];h===r?(n++,i[o]=n):h!==null&&(t.push(h),r=h,n=1,i.push(n),o++)}return{uniqueValues:t,valueFrequency:i}}function gRe(e,t,i){const r=e.length,n=[];i>r&&(i=r);for(let c=0;c<i;c++)n.push(Math.round(c*r/i-1));n.push(r-1);let o=wre(n,e,t,i);return vRe(o.mean,o.sdcm,n,e,t,i)&&(o=wre(n,e,t,i)),n}function wre(e,t,i,r){let n=[],o=[],c=[],h=0;const m=[],b=[];for(let k=0;k<r;k++){const P=Lv(k,e,t,i);m.push(P.sbMean),b.push(P.sbSdcm),h+=b[k]}let x,I=h,E=!0;for(;E||h<I;){E=!1,n=[];for(let k=0;k<r;k++)n.push(e[k]);for(let k=0;k<r;k++)for(let P=e[k]+1;P<=e[k+1];P++)if(x=t[P],k>0&&P!==e[k+1]&&Math.abs(x-m[k])>Math.abs(x-m[k-1]))e[k]=P;else if(k<r-1&&e[k]!==P-1&&Math.abs(x-m[k])>Math.abs(x-m[k+1])){e[k+1]=P-1;break}I=h,h=0,o=[],c=[];for(let k=0;k<r;k++){o.push(m[k]),c.push(b[k]);const P=Lv(k,e,t,i);m[k]=P.sbMean,b[k]=P.sbSdcm,h+=b[k]}}if(h>I){for(let k=0;k<r;k++)e[k]=n[k],m[k]=o[k],b[k]=c[k];h=I}return{mean:m,sdcm:b}}function vRe(e,t,i,r,n,o){let c=0,h=0,m=0,b=0,x=!0;for(let I=0;I<2&&x;I++){I===0&&(x=!1);for(let E=0;E<o-1;E++)for(;i[E+1]+1!==i[E+2];){i[E+1]=i[E+1]+1;const k=Lv(E,i,r,n);m=k.sbMean,c=k.sbSdcm;const P=Lv(E+1,i,r,n);if(b=P.sbMean,h=P.sbSdcm,!(c+h<t[E]+t[E+1])){i[E+1]=i[E+1]-1;break}t[E]=c,t[E+1]=h,e[E]=m,e[E+1]=b,x=!0}for(let E=o-1;E>0;E--)for(;i[E]!==i[E-1]+1;){i[E]=i[E]-1;const k=Lv(E-1,i,r,n);m=k.sbMean,c=k.sbSdcm;const P=Lv(E,i,r,n);if(b=P.sbMean,h=P.sbSdcm,!(c+h<t[E-1]+t[E])){i[E]=i[E]+1;break}t[E-1]=c,t[E]=h,e[E-1]=m,e[E]=b,x=!0}}return x}function bRe(e,t,i,r,n){let o=Math.max(r-e,t-r)/n/i;return o=o>=1?1:o>=.5?.5:.25,o}function wRe(e){let t=0;for(let i=0;i<e.length;i++)t+=e[i];return t/=e.length,t}function _Re(e,t){let i=0;for(let r=0;r<e.length;r++){const n=e[r];i+=(n-t)*(n-t)}return i/=e.length,Math.sqrt(i)}function Lv(e,t,i,r){let n=0,o=0;for(let m=t[e]+1;m<=t[e+1];m++){const b=r[m];n+=i[m]*b,o+=b}o<=0&&dRe.warn("Exception in Natural Breaks calculation");const c=n/o;let h=0;for(let m=t[e]+1;m<=t[e+1];m++)h+=r[m]*(i[m]-c)**2;return{sbMean:c,sbSdcm:h}}const xRe="<Null>",SRe="equal-interval",MRe=1,IRe=5,$Re=10,ERe=/\s*(\+|-)?((\d+(\.\d+)?)|(\.\d+))\s*/gi,_re=new Set(["esriFieldTypeInteger","esriFieldTypeSmallInteger","esriFieldTypeSingle","esriFieldTypeDouble"]),TRe=["min","max","avg","stddev","count","sum","variance","nullcount","median"];function Of(e){return e==null||typeof e=="string"&&!e?xRe:e}function xre(e){const t=e.normalizationField!=null||e.normalizationType!=null,i=e.minValue!=null||e.maxValue!=null,r=!!e.sqlExpression&&e.supportsSQLExpression;return!t&&!i&&!r}function Sre(e){const t=e.returnDistinct?[...new Set(e.values)]:e.values,i=t.filter(n=>n!=null).length,r={count:i};return e.supportsNullCount&&(r.nullcount=t.length-i),e.percentileParams&&(r.median=$O(t,e.percentileParams)),r}function IO(e){const{values:t,useSampleStdDev:i,supportsNullCount:r}=e;let n=Number.POSITIVE_INFINITY,o=Number.NEGATIVE_INFINITY,c=null,h=null,m=null,b=null,x=0;const I=e.minValue==null?-1/0:e.minValue,E=e.maxValue==null?1/0:e.maxValue;for(const P of t)Number.isFinite(P)?P>=I&&P<=E&&(c+=P,n=Math.min(n,P),o=Math.max(o,P),x++):typeof P=="string"&&x++;if(x&&c!=null){h=c/x;let P=0;for(const F of t)Number.isFinite(F)&&F>=I&&F<=E&&(P+=(F-h)**2);b=i?x>1?P/(x-1):0:x>0?P/x:0,m=Math.sqrt(b)}else n=null,o=null;const k={avg:h,count:x,max:o,min:n,stddev:m,sum:c,variance:b};return r&&(k.nullcount=t.length-x),e.percentileParams&&(k.median=$O(t,e.percentileParams)),k}function $O(e,t){const{fieldType:i,value:r,orderBy:n,isDiscrete:o}=t,c=Mre(i,n==="desc");if((e=[...e].filter(k=>k!=null).sort((k,P)=>c(k,P))).length===0)return null;if(r<=0)return e[0];if(r>=1)return e[e.length-1];const h=(e.length-1)*r,m=Math.floor(h),b=m+1,x=h%1,I=e[m],E=e[b];return b>=e.length||o||typeof I=="string"||typeof E=="string"?I:I*(1-x)+E*x}function Mre(e,t){const i=t?1:-1,r=CRe(t),n=Ire(t);if(!(!!e&&["esriFieldTypeDate","esriFieldTypeString","esriFieldTypeGUID","esriFieldTypeGlobalID",..._re].includes(e)))return(o,c)=>typeof o=="number"&&typeof c=="number"?r(o,c):typeof o=="string"&&typeof c=="string"?n(o,c):i;if(e==="esriFieldTypeDate")return(o,c)=>{const h=new Date(o).getTime(),m=new Date(c).getTime();return isNaN(h)||isNaN(m)?i:r(h,m)};if(_re.has(e))return(o,c)=>r(o,c);if(e==="esriFieldTypeString")return(o,c)=>n(o,c);if(e==="esriFieldTypeGUID"||e==="esriFieldTypeGlobalID"){const o=Ire(t);return(c,h)=>o($re(c),$re(h))}return t?(o,c)=>1:(o,c)=>-1}function Ire(e){return e?(t,i)=>(t=t==null?void 0:t.toUpperCase(),i=i==null?void 0:i.toUpperCase(),t>i?-1:t<i?1:0):(t,i)=>(t=t==null?void 0:t.toUpperCase(),i=i==null?void 0:i.toUpperCase(),t<i?-1:t>i?1:0)}function CRe(e){return e?(t,i)=>i-t:(t,i)=>t-i}function $re(e){return e.substr(24,12)+e.substr(19,4)+e.substr(16,2)+e.substr(14,2)+e.substr(11,2)+e.substr(9,2)+e.substr(6,2)+e.substr(4,2)+e.substr(2,2)+e.substr(0,2)}function kRe(e,t){let i;for(i in e)TRe.includes(i)&&(Number.isFinite(e[i])||(e[i]=null));return t&&["avg","stddev","variance"].forEach(r=>{e[r]!=null&&(e[r]=Math.ceil(e[r]))}),e}function ARe(e){const t={};for(let i of e)(i==null||typeof i=="string"&&i.trim()==="")&&(i=null),t[i]==null?t[i]={count:1,data:i}:t[i].count++;return{count:t}}function EO(e){return(e==null?void 0:e.type)!=="coded-value"?[]:e.codedValues.map(t=>t.code)}function PRe(e,t,i,r){const n=e.count,o=[];if(i&&t){const c=[],h=EO(t[0]);for(const m of h)if(t[1]){const b=EO(t[1]);for(const x of b)if(t[2]){const I=EO(t[2]);for(const E of I)c.push(`${Of(m)}${r}${Of(x)}${r}${Of(E)}`)}else c.push(`${Of(m)}${r}${Of(x)}`)}else c.push(m);for(const m of c)n.hasOwnProperty(m)||(n[m]={data:m,count:0})}for(const c in n){const h=n[c];o.push({value:h.data,count:h.count,label:h.label})}return{uniqueValueInfos:o}}function LRe(e,t,i,r){let n=null;switch(t){case"log":e!==0&&(n=Math.log(e)*Math.LOG10E);break;case"percent-of-total":Number.isFinite(r)&&r!==0&&(n=e/r*100);break;case"field":Number.isFinite(i)&&i!==0&&(n=e/i);break;case"natural-log":e>0&&(n=Math.log(e));break;case"square-root":e>0&&(n=e**.5)}return n}function Ere(e,t){const i=RRe({field:t.field,normalizationType:t.normalizationType,normalizationField:t.normalizationField,classificationMethod:t.classificationMethod,standardDeviationInterval:t.standardDeviationInterval,breakCount:t.numClasses||IRe});return e=ORe(e,t.minValue,t.maxValue),fRe({definition:i,values:e,normalizationTotal:t.normalizationTotal})}function ORe(e,t,i){return t=t!=null?t:-1/0,i=i!=null?i:1/0,e.filter(r=>Number.isFinite(r)&&r>=t&&r<=i)}function RRe(e){const t=e.field,i=e.classificationMethod||SRe,r=e.normalizationType,n=e.normalizationField,o=new pRe;return o.classificationField=t,o.breakCount=e.breakCount,o.classificationMethod=i,o.standardDeviationInterval=i==="standard-deviation"?e.standardDeviationInterval||MRe:void 0,o.normalizationType=r,o.normalizationField=r==="field"?n:void 0,o}function FRe(e,t){let i=e.classBreaks;const r=i.length,n=i[0].minValue,o=i[r-1].maxValue,c=t==="standard-deviation",h=ERe;return i=i.map(m=>{const b=m.label,x={minValue:m.minValue,maxValue:m.maxValue,label:b};if(c&&b){const I=b.match(h).map(E=>+E.trim());I.length===2?(x.minStdDev=I[0],x.maxStdDev=I[1],I[0]<0&&I[1]>0&&(x.hasAvg=!0)):I.length===1&&(b.includes("<")?(x.minStdDev=null,x.maxStdDev=I[0]):b.includes(">")&&(x.minStdDev=I[0],x.maxStdDev=null))}return x}),{minValue:n,maxValue:o,classBreakInfos:i,normalizationTotal:e.normalizationTotal}}function NRe(e,t){const{min:i,max:r,intervals:n}=DRe(e,t),o=n.map((c,h)=>({minValue:n[h][0],maxValue:n[h][1],count:0}));for(const c of e)if(c!=null&&c>=i&&c<=r){const h=jRe(n,c);h>-1&&o[h].count++}return{bins:o,minValue:i,maxValue:r,normalizationTotal:t.normalizationTotal}}function DRe(e,t){const{field:i,classificationMethod:r,standardDeviationInterval:n,normalizationType:o,normalizationField:c,normalizationTotal:h,minValue:m,maxValue:b}=t,x=t.numBins||$Re;let I=null,E=null,k=null;if((!r||r==="equal-interval")&&!o){if(m!=null&&b!=null)I=m,E=b;else{const P=IO({values:e,minValue:m,maxValue:b,useSampleStdDev:!o,supportsNullCount:xre({normalizationType:o,normalizationField:c,minValue:m,maxValue:b})});I=P.min,E=P.max}k=VRe(I,E,x)}else{const{classBreaks:P}=Ere(e,{field:i,normalizationType:o,normalizationField:c,normalizationTotal:h,classificationMethod:r,standardDeviationInterval:n,minValue:m,maxValue:b,numClasses:x});I=P[0].minValue,E=P[P.length-1].maxValue,k=P.map(F=>[F.minValue,F.maxValue])}return{min:I,max:E,intervals:k}}function jRe(e,t){let i=-1;for(let r=e.length-1;r>=0;r--)if(t>=e[r][0]){i=r;break}return i}function VRe(e,t,i){const r=(t-e)/i,n=[];let o,c=e;for(let h=1;h<=i;h++)o=c+r,o=Number(o.toFixed(16)),n.push([c,h===i?t:o]),c=o;return n}class o4{constructor(t,i,r){var o;this._fieldDataCache=new Map,this._returnDistinctMap=new Map,this.returnDistinctValues=(o=t.returnDistinctValues)!=null?o:!1,this.fieldsIndex=r,this.featureAdapter=i;const n=t.outFields;if(n&&!n.includes("*")){this.outFields=n;let c=0;for(const h of n){const m=mre(h),b=this.fieldsIndex.get(m),x=b?null:M3(m,r),I=b?b.name:uRe(h)||"FIELD_EXP_"+c++;this._fieldDataCache.set(h,{alias:I,clause:x})}}}countDistinctValues(t){return this.returnDistinctValues?(t.forEach(i=>this.getAttributes(i)),this._returnDistinctMap.size):t.length}getAttributes(t){const i=this._processAttributesForOutFields(t);return this._processAttributesForDistinctValues(i)}getFieldValue(t,i,r){const n=r?r.name:i;let o=null;return this._fieldDataCache.has(n)?o=this._fieldDataCache.get(n).clause:r||(o=M3(i,this.fieldsIndex),this._fieldDataCache.set(n,{alias:n,clause:o})),r?this.featureAdapter.getAttribute(t,n):o.calculateValue(t,this.featureAdapter)}getDataValue(t,i){const r=i.normalizationType,n=i.normalizationTotal;let o=this.getFieldValue(t,i.field,this.fieldsIndex.get(i.field));if(i.field2&&(o=`${Of(o)}${i.fieldDelimiter}${Of(this.getFieldValue(t,i.field2,this.fieldsIndex.get(i.field2)))}`,i.field3&&(o=`${o}${i.fieldDelimiter}${Of(this.getFieldValue(t,i.field3,this.fieldsIndex.get(i.field3)))}`)),r&&Number.isFinite(o)){const c=r==="field"&&i.normalizationField?this.getFieldValue(t,i.normalizationField,this.fieldsIndex.get(i.normalizationField)):null;o=LRe(o,r,c,n)}return o}getExpressionValue(t,i,r,n){const o={attributes:this.featureAdapter.getAttributes(t),layer:{fields:this.fieldsIndex.fields}},c=n.createExecContext(o,r);return n.executeFunction(i,c)}getExpressionValues(t,i,r,n){const o={fields:this.fieldsIndex.fields};return t.map(c=>{const h={attributes:this.featureAdapter.getAttributes(c),layer:o},m=n.createExecContext(h,r);return n.executeFunction(i,m)})}validateItem(t,i){return this._fieldDataCache.has(i)||this._fieldDataCache.set(i,{alias:i,clause:M3(i,this.fieldsIndex)}),this._fieldDataCache.get(i).clause.testFeature(t,this.featureAdapter)}validateItems(t,i){return this._fieldDataCache.has(i)||this._fieldDataCache.set(i,{alias:i,clause:M3(i,this.fieldsIndex)}),this._fieldDataCache.get(i).clause.testSet(t,this.featureAdapter)}_processAttributesForOutFields(t){const i=this.outFields;if(!i||!i.length)return this.featureAdapter.getAttributes(t);const r={};for(const n of i){const{alias:o,clause:c}=this._fieldDataCache.get(n);r[o]=c?c.calculateValue(t,this.featureAdapter):this.featureAdapter.getAttribute(t,o)}return r}_processAttributesForDistinctValues(t){if(ce(t)||!this.returnDistinctValues)return t;const i=this.outFields,r=[];if(i)for(const c of i){const{alias:h}=this._fieldDataCache.get(c);r.push(t[h])}else for(const c in t)r.push(t[c]);const n=`${(i||["*"]).join(",")}=${r.join(",")}`;let o=this._returnDistinctMap.get(n)||0;return this._returnDistinctMap.set(n,++o),o>1?null:t}}const Tre={convertToGEGeometry:zRe,exportPoint:BRe,exportPolygon:qRe,exportPolyline:WRe,exportMultipoint:ZRe,exportExtent:YRe};function zRe(e,t){return t==null?null:e.convertJSONToGeometry(t)}class GRe{constructor(t,i,r){this.x=t,this.y=i,this.spatialReference=r,this.z=void 0,this.m=void 0}}function BRe(e,t,i){const r=new GRe(e.getPointX(t),e.getPointY(t),i),n=e.hasZ(t),o=e.hasM(t);return n&&(r.z=e.getPointZ(t)),o&&(r.m=e.getPointM(t)),r}class URe{constructor(t,i,r,n){this.rings=t,this.spatialReference=i,this.hasZ=void 0,this.hasM=void 0,r&&(this.hasZ=r),n&&(this.hasM=n)}}function qRe(e,t,i){return new URe(e.exportPaths(t),i,e.hasZ(t),e.hasM(t))}class HRe{constructor(t,i,r,n){this.paths=t,this.spatialReference=i,this.hasZ=void 0,this.hasM=void 0,r&&(this.hasZ=r),n&&(this.hasM=n)}}function WRe(e,t,i){return new HRe(e.exportPaths(t),i,e.hasZ(t),e.hasM(t))}class JRe{constructor(t,i,r,n){this.points=t,this.spatialReference=i,this.hasZ=void 0,this.hasM=void 0,r&&(this.hasZ=r),n&&(this.hasM=n)}}function ZRe(e,t,i){return new JRe(e.exportPoints(t),i,e.hasZ(t),e.hasM(t))}class KRe{constructor(t,i,r,n,o){this.xmin=t,this.ymin=i,this.xmax=r,this.ymax=n,this.spatialReference=o,this.zmin=void 0,this.zmax=void 0,this.mmin=void 0,this.mmax=void 0}}function YRe(e,t,i){const r=e.hasZ(t),n=e.hasM(t),o=new KRe(e.getXMin(t),e.getYMin(t),e.getXMax(t),e.getYMax(t),i);if(r){const c=e.getZExtent(t);o.zmin=c.vmin,o.zmax=c.vmax}if(n){const c=e.getMExtent(t);o.mmin=c.vmin,o.mmax=c.vmax}return o}const TO=[0,0];function Cre(e,t){if(!t)return null;if("x"in t){const i={x:0,y:0};return[i.x,i.y]=e(t.x,t.y,TO),t.z!=null&&(i.z=t.z),t.m!=null&&(i.m=t.m),i}if("xmin"in t){const i={xmin:0,ymin:0,xmax:0,ymax:0};return[i.xmin,i.ymin]=e(t.xmin,t.ymin,TO),[i.xmax,i.ymax]=e(t.xmax,t.ymax,TO),t.hasZ&&(i.zmin=t.zmin,i.zmax=t.zmax,i.hasZ=!0),t.hasM&&(i.mmin=t.mmin,i.mmax=t.mmax,i.hasM=!0),i}return"rings"in t?{rings:kre(t.rings,e),hasM:t.hasM,hasZ:t.hasZ}:"paths"in t?{paths:kre(t.paths,e),hasM:t.hasM,hasZ:t.hasZ}:"points"in t?{points:Are(t.points,e),hasM:t.hasM,hasZ:t.hasZ}:null}function kre(e,t){const i=[];for(const r of e)i.push(Are(r,t));return i}function Are(e,t){const i=[];for(const r of e){const n=t(r[0],r[1],[0,0]);i.push(n),r.length>2&&n.push(r[2]),r.length>3&&n.push(r[3])}return i}async function Pre(e,t){if(!e||!t)return;const i=Array.isArray(e)?e.map(r=>H(r.geometry)?r.geometry.spatialReference:null).filter(H):[e];await aq(i.map(r=>({source:r,dest:t})))}const Lre=Cre.bind(null,g0),Ore=Cre.bind(null,ag);function a4(e,t,i,r){if(!e||(i||(i=t,t=e.spatialReference),!Sn(t)||!Sn(i)||hr(t,i)))return e;if(og(t,i)){const n=Xc(i)?Lre(e):Ore(e);return n.spatialReference=i,n}return s9(Tre,[e],t,i,null,r)[0]}class XRe{constructor(){this._jobs=[],this._timer=null,this._process=this._process.bind(this)}async push(t,i,r){if(!t||!t.length||!i||!r||hr(i,r))return t;const n={geometries:t,inSpatialReference:i,outSpatialReference:r,resolve:null};return this._jobs.push(n),new Promise(o=>{n.resolve=o,this._timer===null&&(this._timer=setTimeout(this._process,10))})}_process(){this._timer=null;const t=this._jobs.shift();if(!t)return;const{geometries:i,inSpatialReference:r,outSpatialReference:n,resolve:o}=t;og(r,n)?Xc(n)?o(i.map(Lre)):o(i.map(Ore)):o(s9(Tre,i,r,n,null,null)),this._jobs.length>0&&(this._timer=setTimeout(this._process,10))}}const QRe=new XRe;function LYe(e,t,i){return QRe.push(e,t,i)}function eFe(e,t,i){return{objectId:e,target:t,distance:i,type:"vertex"}}function tFe(e,t,i,r,n,o=!1){return{objectId:e,target:t,distance:i,type:"edge",start:r,end:n,draped:o}}const iFe=new kt({esriSRUnit_Meter:"meters",esriSRUnit_Kilometer:"kilometers",esriSRUnit_Foot:"feet",esriSRUnit_StatuteMile:"miles",esriSRUnit_NauticalMile:"nautical-miles",esriSRUnit_USNauticalMile:"us-nautical-miles"}),Rre=Object.freeze({}),Fre=new $s,rFe=new $s,CO=new $s,xp={esriGeometryPoint:cA,esriGeometryPolyline:yA,esriGeometryPolygon:mA,esriGeometryMultipoint:fA};function Nre(e,t,i,r=e.hasZ,n=e.hasM){if(ce(t))return null;const o=e.hasZ&&r,c=e.hasM&&n;if(i){const h=s2(CO,t,e.hasZ,e.hasM,"esriGeometryPoint",i,r,n);return cA(h,o,c)}return cA(t,o,c)}function kO(e,t,i,r,n,o,c=t,h=i){var I,E,k,P,F,N;const m=t&&c,b=i&&h,x=H(r)?"coords"in r?r:r.geometry:null;if(ce(x))return null;if(n){let B=ZIe(rFe,x,t,i,e,n,c,h);return o&&(B=s2(CO,B,m,b,e,o)),(E=(I=xp[e])==null?void 0:I.call(xp,B,m,b))!=null?E:null}if(o){const B=s2(CO,x,t,i,e,o,c,h);return(P=(k=xp[e])==null?void 0:k.call(xp,B,m,b))!=null?P:null}return YIe(Fre,x,t,i,c,h),(N=(F=xp[e])==null?void 0:F.call(xp,Fre,m,b))!=null?N:null}async function OYe(e,t,i){const{outFields:r,orderByFields:n,groupByFieldsForStatistics:o,outStatistics:c}=e;if(r)for(let h=0;h<r.length;h++)r[h]=r[h].trim();if(n)for(let h=0;h<n.length;h++)n[h]=n[h].trim();if(o)for(let h=0;h<o.length;h++)o[h]=o[h].trim();if(c)for(let h=0;h<c.length;h++)c[h].onStatisticField&&(c[h].onStatisticField=c[h].onStatisticField.trim());return e.geometry&&!e.outSR&&(e.outSR=e.geometry.spatialReference),nFe(e,t,i)}async function nFe(e,t,i){var o;if(!e)return null;let{where:r}=e;if(e.where=r=r&&r.trim(),(!r||/^1 *= *1$/.test(r)||t&&t===r)&&(e.where=null),!e.geometry)return e;let n=await oFe(e);if(e.distance=0,e.units=null,e.spatialRel==="esriSpatialRelEnvelopeIntersects"){const{spatialReference:c}=e.geometry;n=LT(n),n.spatialReference=c}if(n){await Pre(n.spatialReference,i),n=sFe(n,i);const c=(await d1(xs(n)))[0];if(ce(c))throw Rre;const h="quantizationParameters"in e&&((o=e.quantizationParameters)==null?void 0:o.tolerance)||"maxAllowableOffset"in e&&e.maxAllowableOffset||0,m=h&&Dre(n,i)?{densificationStep:8*h}:void 0,b=c.toJSON(),x=await a4(b,b.spatialReference,i,m);if(!x)throw Rre;x.spatialReference=i,e.geometry=x}return e}function Dre(e,t){if(!e)return!1;const i=e.spatialReference;return(ww(e)||vh(e)||_w(e))&&!hr(i,t)&&!pc(i,t)}function sFe(e,t){const i=e.spatialReference;return Dre(e,t)&&ww(e)?{spatialReference:i,rings:[[[e.xmin,e.ymin],[e.xmin,e.ymax],[e.xmax,e.ymax],[e.xmax,e.ymin],[e.xmin,e.ymin]]]}:e}async function oFe(e){const{distance:t,units:i}=e,r=e.geometry;if(t==null||"vertexAttributes"in r)return r;const n=r.spatialReference,o=i?iFe.fromJSON(i):$_(n),c=n&&(PS(n)||Xc(n))?r:await Pre(n,xT).then(()=>a4(r,xT));return(await aFe())(c.spatialReference,c,t,o)}async function aFe(){return(await import("./geometryEngineJSON.7fc72f00.js")).geodesicBuffer}function AO(e){return e&&jre in e?JSON.parse(JSON.stringify(e,lFe)):e}const jre="_geVersion",lFe=(e,t)=>e!==jre?t:void 0;class RYe{constructor(t,i,r){this.items=t,this.query=i,this.geometryType=r.geometryType,this.hasM=r.hasM,this.hasZ=r.hasZ,this.fieldsIndex=r.fieldsIndex,this.objectIdField=r.objectIdField,this.spatialReference=r.spatialReference,this.featureAdapter=r.featureAdapter}get size(){return this.items.length}createQueryResponseForCount(){const t=new o4(this.query,this.featureAdapter,this.fieldsIndex);if(!this.query.outStatistics)return t.countDistinctValues(this.items);const{groupByFieldsForStatistics:i,having:r,outStatistics:n}=this.query;if(!(i==null?void 0:i.length))return 1;const c=new Map,h=new Map,m=new Set;for(const b of n){const{statisticType:x}=b,I=x!=="exceedslimit"?b.onStatisticField:void 0;if(!h.has(I)){const k=[];for(const P of i){const F=this._getAttributeValues(t,P,c);k.push(F)}h.set(I,this._calculateUniqueValues(k,t.returnDistinctValues))}const E=h.get(I);for(const k in E){const{data:P,items:F}=E[k],N=P.join(",");r&&!t.validateItems(F,r)||m.add(N)}}return m.size}async createQueryResponse(){let t;return this.query.outStatistics?t=this.query.outStatistics.some(i=>i.statisticType==="exceedslimit")?this._createExceedsLimitQueryResponse(this.query):await this._createStatisticsQueryResponse(this.query):t=this._createFeatureQueryResponse(this.query),this.query.returnQueryGeometry&&(Sn(this.query.outSR)&&!hr(this.query.geometry.spatialReference,this.query.outSR)?t.queryGeometry=AO(K({spatialReference:this.query.outSR},a4(this.query.geometry,this.query.geometry.spatialReference,this.query.outSR))):t.queryGeometry=AO(K({spatialReference:this.query.outSR},this.query.geometry))),t}createSnappingResponse(t,i){const r=this.featureAdapter,n=Vre(this.hasZ,this.hasM),{point:o}=t,c=typeof t.distance=="number"?t.distance:t.distance.x,h=typeof t.distance=="number"?t.distance:t.distance.y,m={candidates:[]},b=this.geometryType==="esriGeometryPolygon",x=o.z!=null,I=o.m!=null,E=this._getPointCreator(o,x,I,this.spatialReference,i),k=new zre(null,0),P=new zre(null,0),F={x:0,y:0,z:0};for(const N of this.items){const B=r.getGeometry(N);if(ce(B))continue;const{coords:z,lengths:q}=B;if(k.coords=z,P.coords=z,t.types&Ov.EDGE){let J=0;for(let X=0;X<q.length;X++){const Y=q[X];for(let ae=0;ae<Y;ae++,J+=n){const he=k;if(he.coordsIndex=J,ae!==Y-1){const fe=P;fe.coordsIndex=J+n;const ye=F;cFe(F,o,he,fe);const xe=(o.x-ye.x)/c,Se=(o.y-ye.y)/h,Ae=xe*xe+Se*Se;Ae<=1&&m.candidates.push(tFe(r.getObjectId(N),E(ye),Math.sqrt(Ae),E(he),E(fe)))}}}}if(t.types&Ov.VERTEX){const J=b?z.length-n:z.length;for(let X=0;X<J;X+=n){const Y=k;Y.coordsIndex=X;const ae=(o.x-Y.x)/c,he=(o.y-Y.y)/h,fe=ae*ae+he*he;fe<=1&&m.candidates.push(eFe(r.getObjectId(N),E(Y),Math.sqrt(fe)))}}}return m.candidates.sort((N,B)=>N.distance-B.distance),m}_getPointCreator(t,i,r,n,o){const c=H(o)&&!hr(n,o)?x=>a4(x,n,o):x=>x,{hasZ:h}=this,m=0,b=t.m;return i&&r?h?({x,y:I,z:E})=>c({x,y:I,z:E,m:b}):({x,y:I})=>c({x,y:I,z:m,m:b}):i?h?({x,y:I,z:E})=>c({x,y:I,z:E}):({x,y:I})=>c({x,y:I,z:m}):r?({x,y:I})=>c({x,y:I,m:b}):({x,y:I})=>c({x,y:I})}async createSummaryStatisticsResponse(t){const{field:i,valueExpression:r,normalizationField:n,normalizationType:o,normalizationTotal:c,minValue:h,maxValue:m,scale:b}=t,x=this.fieldsIndex.isDateField(i),I=await this._getDataValues({field:i,valueExpression:r,normalizationField:n,normalizationType:o,normalizationTotal:c,scale:b}),E=xre({normalizationType:o,normalizationField:n,minValue:h,maxValue:m}),k=this.fieldsIndex.get(i),P={value:.5,fieldType:k==null?void 0:k.type},F=Dz(k)?Sre({values:I,supportsNullCount:E,percentileParams:P}):IO({values:I,minValue:h,maxValue:m,useSampleStdDev:!o,supportsNullCount:E,percentileParams:P});return kRe(F,x)}async createUniqueValuesResponse(t){const{field:i,valueExpression:r,domains:n,returnAllCodedValues:o,scale:c}=t,h=await this._getDataValues({field:i,field2:t.field2,field3:t.field3,fieldDelimiter:t.fieldDelimiter,valueExpression:r,scale:c}),m=ARe(h);return PRe(m,n,o,t.fieldDelimiter)}async createClassBreaksResponse(t){const{field:i,valueExpression:r,normalizationField:n,normalizationType:o,normalizationTotal:c,classificationMethod:h,standardDeviationInterval:m,minValue:b,maxValue:x,numClasses:I,scale:E}=t,k=await this._getDataValues({field:i,valueExpression:r,normalizationField:n,normalizationType:o,normalizationTotal:c,scale:E}),P=Ere(k,{field:i,normalizationField:n,normalizationType:o,normalizationTotal:c,classificationMethod:h,standardDeviationInterval:m,minValue:b,maxValue:x,numClasses:I});return FRe(P,h)}async createHistogramResponse(t){const{field:i,valueExpression:r,normalizationField:n,normalizationType:o,normalizationTotal:c,classificationMethod:h,standardDeviationInterval:m,minValue:b,maxValue:x,numBins:I,scale:E}=t,k=await this._getDataValues({field:i,valueExpression:r,normalizationField:n,normalizationType:o,normalizationTotal:c,scale:E});return NRe(k,{field:i,normalizationField:n,normalizationType:o,normalizationTotal:c,classificationMethod:h,standardDeviationInterval:m,minValue:b,maxValue:x,numBins:I})}_sortFeatures(t,i,r){if(t.length>1&&i&&i.length)for(const n of i.reverse()){const o=n.split(" "),c=o[0],h=this.fieldsIndex.get(c),m=o[1]&&o[1].toLowerCase()==="desc",b=Mre(h==null?void 0:h.type,m);t.sort((x,I)=>{const E=r(x,c,h),k=r(I,c,h);return b(E,k)})}}_createFeatureQueryResponse(t){const i=this.items,{geometryType:r,hasM:n,hasZ:o,objectIdField:c,spatialReference:h}=this,{outFields:m,outSR:b,quantizationParameters:x,resultRecordCount:I,resultOffset:E,returnZ:k,returnM:P}=t,F=I!=null&&i.length>(E||0)+I,N=m&&(m.includes("*")?[...this.fieldsIndex.fields]:m.map(B=>this.fieldsIndex.get(B)));return{exceededTransferLimit:F,features:this._createFeatures(t,i),fields:N,geometryType:r,hasM:n&&P,hasZ:o&&k,objectIdFieldName:c,spatialReference:AO(b||h),transform:x&&Ree(x)||null}}_createFeatures(t,i){const r=new o4(t,this.featureAdapter,this.fieldsIndex),{hasM:n,hasZ:o}=this,{orderByFields:c,quantizationParameters:h,returnGeometry:m,returnCentroid:b,maxAllowableOffset:x,resultOffset:I,resultRecordCount:E,returnZ:k=!1,returnM:P=!1}=t,F=o&&k,N=n&&P;let B=[],z=0;const q=[...i];if(this._sortFeatures(q,c,(X,Y,ae)=>r.getFieldValue(X,Y,ae)),m||b){const X=Ree(h);if(m&&!b)for(const Y of q)B[z++]={attributes:r.getAttributes(Y),geometry:kO(this.geometryType,this.hasZ,this.hasM,this.featureAdapter.getGeometry(Y),x,X,F,N)};else if(!m&&b)for(const Y of q)B[z++]={attributes:r.getAttributes(Y),centroid:Nre(this,this.featureAdapter.getCentroid(Y,this),X)};else for(const Y of q)B[z++]={attributes:r.getAttributes(Y),centroid:Nre(this,this.featureAdapter.getCentroid(Y,this),X),geometry:kO(this.geometryType,this.hasZ,this.hasM,this.featureAdapter.getGeometry(Y),x,X,F,N)}}else for(const X of q){const Y=r.getAttributes(X);Y&&(B[z++]={attributes:Y})}const J=I||0;if(E!=null){const X=J+E;B=B.slice(J,Math.min(B.length,X))}return B}_createExceedsLimitQueryResponse(t){let i=!1,r=Number.POSITIVE_INFINITY,n=Number.POSITIVE_INFINITY,o=Number.POSITIVE_INFINITY;for(const c of t.outStatistics)if(c.statisticType==="exceedslimit"){r=c.maxPointCount!=null?c.maxPointCount:Number.POSITIVE_INFINITY,n=c.maxRecordCount!=null?c.maxRecordCount:Number.POSITIVE_INFINITY,o=c.maxVertexCount!=null?c.maxVertexCount:Number.POSITIVE_INFINITY;break}if(this.geometryType==="esriGeometryPoint")i=this.items.length>r;else if(this.items.length>n)i=!0;else{const c=Vre(this.hasZ,this.hasM),h=this.featureAdapter;i=this.items.reduce((m,b)=>{const x=h.getGeometry(b);return m+(H(x)&&x.coords.length||0)},0)/c>o}return{fields:[{name:"exceedslimit",type:"esriFieldTypeInteger",alias:"exceedslimit",sqlType:"sqlTypeInteger",domain:null,defaultValue:null}],features:[{attributes:{exceedslimit:Number(i)}}]}}async _createStatisticsQueryResponse(t){const i={attributes:{}},r=[],n=new Map,o=new Map,c=new Map,h=new Map,m=new o4(t,this.featureAdapter,this.fieldsIndex),b=t.outStatistics,{groupByFieldsForStatistics:x,having:I,orderByFields:E}=t,k=x&&x.length,P=!!k,F=P&&x[0],N=P&&!this.fieldsIndex.get(F);for(const z of b){const{outStatisticFieldName:q,statisticType:J}=z,X=z,Y=J!=="exceedslimit"?z.onStatisticField:void 0,ae=J==="percentile_disc"||J==="percentile_cont",he=J==="EnvelopeAggregate"||J==="CentroidAggregate"||J==="ConvexHullAggregate",fe=P&&k===1&&(Y===F||N)&&J==="count";if(P){if(!c.has(Y)){const xe=[];for(const Se of x){const Ae=this._getAttributeValues(m,Se,n);xe.push(Ae)}c.set(Y,this._calculateUniqueValues(xe,!he&&m.returnDistinctValues))}const ye=c.get(Y);for(const xe in ye){const{count:Se,data:Ae,items:Oe,itemPositions:bt}=ye[xe],st=Ae.join(",");if(!I||m.validateItems(Oe,I)){const et=h.get(st)||{attributes:{}};if(he){et.aggregateGeometries||(et.aggregateGeometries={});const{aggregateGeometries:Et,outStatisticFieldName:Gt}=await this._getAggregateGeometry(X,Oe);et.aggregateGeometries[Gt]=Et}else{let Et=null;if(fe)Et=Se;else{const Gt=this._getAttributeValues(m,Y,n),pi=bt.map(ei=>Gt[ei]);Et=ae&&"statisticParameters"in X?this._getPercentileValue(X,pi):this._getStatisticValue(X,pi,null,m.returnDistinctValues)}et.attributes[q]=Et}let He=0;x.forEach((Et,Gt)=>et.attributes[this.fieldsIndex.get(Et)?Et:"EXPR_"+ ++He]=Ae[Gt]),h.set(st,et)}}}else if(he){i.aggregateGeometries||(i.aggregateGeometries={});const{aggregateGeometries:ye,outStatisticFieldName:xe}=await this._getAggregateGeometry(X,this.items);i.aggregateGeometries[xe]=ye}else{const ye=this._getAttributeValues(m,Y,n);i.attributes[q]=ae&&"statisticParameters"in X?this._getPercentileValue(X,ye):this._getStatisticValue(X,ye,o,m.returnDistinctValues)}r.push({name:q,alias:q,type:"esriFieldTypeDouble"})}const B=P?Array.from(h.values()):[i];return this._sortFeatures(B,E,(z,q)=>z.attributes[q]),{fields:r,features:B}}async _getAggregateGeometry(t,i){const r=await import("./geometryEngineJSON.7fc72f00.js"),{statisticType:n,outStatisticFieldName:o}=t,{featureAdapter:c,spatialReference:h,geometryType:m,hasZ:b,hasM:x}=this,I=i.map(P=>kO(m,b,x,c.getGeometry(P))),E=r.convexHull(h,I,!0)[0],k={aggregateGeometries:null,outStatisticFieldName:null};if(n==="EnvelopeAggregate"){const P=E?OT(E):LT(r.union(h,I));k.aggregateGeometries=Ce(K({},P),{spatialReference:h}),k.outStatisticFieldName=o||"extent"}else if(n==="CentroidAggregate"){const P=E?dz(E):oge(LT(r.union(h,I)));k.aggregateGeometries={x:P[0],y:P[1],spatialReference:h},k.outStatisticFieldName=o||"centroid"}else n==="ConvexHullAggregate"&&(k.aggregateGeometries=E,k.outStatisticFieldName=o||"convexHull");return k}_getStatisticValue(t,i,r,n){const{onStatisticField:o,statisticType:c}=t;let h=null;return h=(r==null?void 0:r.has(o))?r.get(o):Dz(this.fieldsIndex.get(o))?Sre({values:i,returnDistinct:n}):IO({values:i,minValue:null,maxValue:null,useSampleStdDev:!0}),r&&r.set(o,h),h[c==="var"?"variance":c]}_getPercentileValue(t,i){const{onStatisticField:r,statisticParameters:n,statisticType:o}=t,{value:c,orderBy:h}=n,m=this.fieldsIndex.get(r);return $O(i,{value:c,orderBy:h,fieldType:m==null?void 0:m.type,isDiscrete:o==="percentile_disc"})}_getAttributeValues(t,i,r){if(r.has(i))return r.get(i);const n=this.fieldsIndex.get(i),o=this.items.map(c=>t.getFieldValue(c,i,n));return r.set(i,o),o}_getAttributeDataValues(t,i){return this.items.map(r=>t.getDataValue(r,{field:i.field,field2:i.field2,field3:i.field3,fieldDelimiter:i.fieldDelimiter,normalizationField:i.normalizationField,normalizationType:i.normalizationType,normalizationTotal:i.normalizationTotal}))}async _getAttributeExpressionValues(t,i,r){const{arcadeUtils:n}=await ru(),o=n.createFunction(i),c=r&&n.getViewInfo(r);return t.getExpressionValues(this.items,o,c,n)}_calculateUniqueValues(t,i){const r={},n=this.items,o=n.length;for(let c=0;c<o;c++){const h=n[c],m=[];for(const x of t)m.push(x[c]);const b=m.join(",");i?r[b]==null&&(r[b]={count:1,data:m,items:[h],itemPositions:[c]}):r[b]==null?r[b]={count:1,data:m,items:[h],itemPositions:[c]}:(r[b].count++,r[b].items.push(h),r[b].itemPositions.push(c))}return r}async _getDataValues(t){const i=new o4(this.query,this.featureAdapter,this.fieldsIndex),{valueExpression:r,field:n,normalizationField:o,normalizationType:c,normalizationTotal:h,scale:m}=t,b=r?{viewingMode:"map",scale:m,spatialReference:this.query.outSR||this.spatialReference}:null;return r?this._getAttributeExpressionValues(i,r,b):this._getAttributeDataValues(i,{field:n,field2:t.field2,field3:t.field3,fieldDelimiter:t.fieldDelimiter,normalizationField:o,normalizationType:c,normalizationTotal:h})}}function cFe(e,t,i,r){const n=r.x-i.x,o=r.y-i.y,c=n*n+o*o,h=(t.x-i.x)*n+(t.y-i.y)*o,m=Math.min(1,Math.max(0,h/c));e.x=i.x+n*m,e.y=i.y+o*m}function Vre(e,t){return e?t?4:3:t?3:2}var Ov;(function(e){e[e.NONE=0]="NONE",e[e.EDGE=1]="EDGE",e[e.VERTEX=2]="VERTEX"})(Ov||(Ov={}));class zre{constructor(t,i){this.coords=t,this.coordsIndex=i}get x(){return this.coords[this.coordsIndex]}get y(){return this.coords[this.coordsIndex+1]}get z(){return this.coords[this.coordsIndex+2]}}function PO({start:e,end:t,type:i},r,n){const o=[],c=r,h=Jr(Sp,t,e),m=Jr(Mp,e,c),b=_f(h),x=2*np(h,m),I=x*x-4*b*(_f(m)-n*n);if(I===0){const E=-x/(2*b);(i===Rc.PLANE||E>=0)&&o.push(Tc(Mn(0,0,r[2]),e,h,E))}else if(I>0){const E=Math.sqrt(I),k=(-x+E)/(2*b);(i===Rc.PLANE||k>=0)&&o.push(Tc(Mn(0,0,r[2]),e,h,k));const P=(-x-E)/(2*b);(i===Rc.PLANE||P>=0)&&o.push(Tc(Mn(0,0,r[2]),e,h,P))}return o}function LO(e,t){const i=e.start,r=e.end,n=Jr(Sp,r,i),o=Nn(Mp,-n[1],n[0],0),c=t.start,h=t.end,m=js($3,h,c),b=Ci(m,o),x=Nn(Wre,i[0],i[1],0),I=js(Jre,x,c),E=Ci(I,o);if(Math.abs(b)<Ws)return[];const k=A0(Zre,c,m,E/b);if(t.type===Kr.RAY){const P=js(l4,k,c);if(Ci(P,m)<-Ws)return[]}if(e.type===Rc.HALF_PLANE){const P=nI(l4,k,i);if(np(P,n)<-Ws)return[]}return[xd(k)]}function OO(e,t){return FO(I3(c4,t[2],e),t)}function Gre(e,t){const i=0,r=Hre(I3(c4,i,e),I3(dFe,i,t)),n=[];for(const o of r)n.push(pQ(o));return n}function Bre(e,t){return RO(e,I3(c4,e[2],t))}function uFe(e,t){return Ure(I3(c4,e[2],t),e)}function hFe(e,t,i){const r=Nn(Sp,e[0],e[1],t[2]),n=fn(Mp,r,t),o=i/ml(n);return A0(it(),t,n,o)}function RO(e,{start:t,end:i,type:r}){const n=js(Sp,e,t),o=js(Mp,i,t),c=Ci(n,o)/Ci(o,o);return A0(it(),t,o,r===Kr.RAY?Math.max(c,0):c)}function Ure({start:e,end:t,type:i},r){const n=js(Sp,r,e),o=js(Mp,t,e);if(i===Kr.RAY&&Ci(o,n)<-Ws)return _g(e,r);const c=is($3,o,n);return s5(c)/s5(o)}function qre({start:e,end:t,type:i},r,n){const o=[];if(La(e[2],r[2],Ws)&&La(t[2],r[2],Ws)){const c=e,h=r,m=Jr(Sp,t,c),b=Jr(Mp,c,h),x=_f(m),I=2*np(m,b),E=I*I-4*x*(_f(b)-n*n);if(E===0){const k=-I/(2*x);(i===Kr.LINE||k>=0)&&o.push(Tc(Mn(0,0,r[2]),c,m,k))}else if(E>0){const k=Math.sqrt(E),P=(-I+k)/(2*x);(i===Kr.LINE||P>=0)&&o.push(Tc(Mn(0,0,r[2]),c,m,P));const F=(-I-k)/(2*x);(i===Kr.LINE||F>=0)&&o.push(Tc(Mn(0,0,r[2]),c,m,F))}}else{const c=js(Sp,t,e);if(La(c[2],0,Ws))return o;const h=(r[2]-e[2])/c[2],m=A0(Mp,e,c,h);if(i===Kr.RAY){const b=js($3,m,e);if(Ci(c,b)<-Ws)return o}for(const b of NO(r,n,m))o.push(b)}return o}function Hre(e,t){const i=e.start,r=e.end,n=t.start,o=t.end,c=js(Sp,r,i),h=js(Mp,o,n),m=js($3,n,i),b=is(Wre,c,h),x=Ci(m,b);if(!La(x,0,Ws))return[];const I=o5(b);if(La(I,0,Ws))return[];const E=is(Jre,m,h),k=Ci(E,b)/I,P=A0(Zre,i,c,k);if(e.type===Kr.RAY){const F=js(l4,P,i);if(Ci(c,F)<-Ws)return[]}if(t.type===Kr.RAY){const F=js(l4,P,n);if(Ci(h,F)<-Ws)return[]}return[xd(P)]}function FO({start:e,end:t,type:i},r){const n=js(Sp,r,e),o=js(Mp,t,e),c=is($3,o,n);if(o5(c)/o5(o)<Ws)switch(i){case Kr.LINE:return[xd(r)];case Kr.RAY:return Ci(o,n)<-Ws?[]:[xd(r)]}return[]}function NO(e,t,i){return La(e[2],i[2],Ws)&&La(Sd(i,e),t*t,Ws)?[xd(i)]:[]}function I3(e,t,{start:i,end:r,type:n}){return Nn(e.start,i[0],i[1],t),Nn(e.end,r[0],r[1],t),e.type=pFe[n],e}var Rc;(function(e){e[e.PLANE=0]="PLANE",e[e.HALF_PLANE=1]="HALF_PLANE"})(Rc||(Rc={}));const pFe={[Rc.PLANE]:Kr.LINE,[Rc.HALF_PLANE]:Kr.RAY},Ws=1e-6,Sp=it(),Mp=it(),$3=it(),Wre=it(),Jre=it(),Zre=it(),l4=it(),c4={start:it(),end:it(),type:Kr.LINE},dFe={start:it(),end:it(),type:Kr.LINE};class um{constructor(t){this.coordinateHelper=t}intersect(t){return gFe(this,t)}}class fFe extends um{constructor(t,i){super(t),this.point=i,this.pointXYZ=t.toXYZ(i)}equals(t){return Rv(t)&&mo(this.point,t.point)}check(t){const i=this.coordinateHelper.toXYZ(t,Ip);return Sd(i,this.pointXYZ)<Ya.pointThreshold}closestTo(){return this.coordinateHelper.clone(this.point)}}class Kre extends um{constructor(t,i,r,n){super(t),this.start=i,this.end=r,this.type=n,this.startXYZ=t.toXYZ(i),this.endXYZ=t.toXYZ(r),this.lineLike={start:this.startXYZ,end:this.endXYZ,type:this.type}}equals(t){return hm(t)&&this.type===t.type&&mo(this.start,t.start)&&mo(this.end,t.end)}check(t){const i=this.coordinateHelper.toXYZ(t,Ip);return Ure(this.lineLike,i)<Ya.pointOnLineThreshold}closestTo(t){const i=this.coordinateHelper,r=i.toXYZ(t,Ip),n=RO(r,this.lineLike);return i.fromXYZ(n)}}class yFe extends Kre{constructor(t,i,r){super(t,i,r,Kr.LINE)}}class u4 extends um{constructor(t,i,r,n){super(t),this.intersection=i,this.first=r,this.second=n}equals(t){return t instanceof u4&&this.first.equals(t.first)&&this.second.equals(t.second)}check(){return!1}closestTo(){return this.coordinateHelper.clone(this.intersection)}}class DO extends um{constructor(t,i,r,n){super(t),this.basePoint=i,this.first=r,this.second=n}equals(t){return t instanceof DO&&this.first.equals(t.first)&&this.second.equals(t.second)}check(){return!1}closestTo(t){const i=this.basePoint,r=this.coordinateHelper,n=r.toXYZ(t,Ip),o=Nn(bFe,i[0],i[1],n[2]);return r.fromXYZ(o)}}class Yre extends um{constructor(t,i,r){super(t),this.center=i,this.radius=r,this.centerXYZ=t.toXYZ(i)}equals(t){return Fv(t)&&this.center[0]===t.center[0]&&this.center[1]===t.center[1]&&this.radius===t.radius}check(){return!1}closestTo(t){const i=this.coordinateHelper,r=i.toXYZ(t,Ip),n=hFe(r,this.centerXYZ,this.radius);return n[2]=i.getZ(t,this.centerXYZ[2]),i.fromXYZ(n)}}class jO extends um{constructor(t,i,r,n){super(t),this.start=i,this.end=r,this.type=n,this.planeLike={start:i,end:r,type:n}}equals(t){return pm(t)&&this.type===t.type&&mo(this.start,t.start)&&mo(this.end,t.end)}check(t){const i=this.coordinateHelper.toXYZ(t,Ip);return uFe(i,this.planeLike)<Ya.pointOnLineThreshold}closestTo(t){const i=this.coordinateHelper,r=i.toXYZ(t,Ip),n=Bre(r,this.planeLike);return i.fromXYZ(n)}closestEndTo(t){const{start:i,end:r}=this;return Math.sign(np(Jr(wFe,r,i),Jr(_Fe,t,i)))>0?r:i}}class Xre extends jO{constructor(t,i,r){super(t,i,r,Rc.HALF_PLANE)}}class Qre extends jO{constructor(t,i,r){super(t,i,r,Rc.PLANE)}}class mFe extends um{constructor(t,i,r,n){super(t),this.start=i,this.end=r,this.getZ=n,this.planeLike={start:i,end:r,type:Rc.HALF_PLANE}}equals(t){return dm(t)&&mo(this.start,t.start)&&mo(this.end,t.end)&&this.getZ===t.getZ}check(t){const i=this.coordinateHelper.toXYZ(t,Ip),r=ene(this,i);return Sd(i,r)<Ya.pointThreshold}closestTo(t){const i=this.coordinateHelper,r=ene(this,i.toXYZ(t,Ip));return i.fromXYZ(r)}addIfOnTheGround(t,i){for(const r of i){const n=this.getZ(r[0],r[1],r[2]);H(n)&&Math.abs(r[2]-n)<Ws&&(r[2]=n,t.push(r))}}}function ene(e,t){const i=Bre(t,e.planeLike),r=e.getZ(t[0],t[1],t[2]);return H(r)&&(i[2]=r),i}function gFe(e,t){let i=[];if(Rv(e)){const{pointXYZ:r}=e;hm(t)?i=FO(t.lineLike,r):Fv(t)?i=NO(t.centerXYZ,t.radius,r):pm(t)?i=OO(t.planeLike,r):dm(t)&&(i=E3(t,e))}else if(hm(e)){const{lineLike:r}=e;Rv(t)?i=FO(r,t.pointXYZ):hm(t)?i=Hre(r,t.lineLike):Fv(t)?i=qre(r,t.centerXYZ,t.radius):pm(t)?i=LO(t.planeLike,r):dm(t)&&(i=E3(t,e))}else if(Fv(e)){const{centerXYZ:r,radius:n}=e;hm(t)?i=qre(t.lineLike,r,n):Rv(t)?i=NO(r,n,t.pointXYZ):pm(t)?i=PO(t.planeLike,r,n):dm(t)&&(i=E3(t,e))}else if(pm(e)){const{planeLike:r,coordinateHelper:n}=e;if(pm(t))return Gre(r,t.planeLike).map(o=>new DO(n,n.fromXYZ(o),e,t));Rv(t)?i=OO(r,t.pointXYZ):hm(t)?i=LO(r,t.lineLike):Fv(t)?i=PO(r,t.centerXYZ,t.radius):dm(t)&&(i=E3(t,e))}else dm(e)&&(i=E3(e,t));return vFe(i,e,t)}function E3(e,t){const{planeLike:i,getZ:r}=e,n=[];if(Rv(t))e.addIfOnTheGround(n,OO(i,t.pointXYZ));else if(hm(t))e.addIfOnTheGround(n,LO(i,t.lineLike));else if(Fv(t))e.addIfOnTheGround(n,PO(i,t.centerXYZ,t.radius));else if(pm(t)||dm(t))for(const[o,c]of Gre(i,t.planeLike)){const h=r(o,c,0);H(h)&&n.push(Mn(o,c,h))}return n}function vFe(e,t,i){const r=t.coordinateHelper;return e.map(n=>new u4(r,r.fromXYZ(n),t,i))}function Rv(e){return e instanceof fFe}function hm(e){return e instanceof Kre}function Fv(e){return e instanceof Yre}function pm(e){return e instanceof jO}function dm(e){return e instanceof mFe}const Ip=it(),bFe=it(),wFe=ui(),_Fe=ui();class Nv{constructor(t,i,r,n,o){this.coordinateHelper=t,this.targetPoint=i,this.constraint=r,this.elevationInfo=n,this.domain=o}}class tne extends Nv{constructor({coordinateHelper:t,targetPoint:i,objectId:r,constraint:n,elevationInfo:o}){super(t,i,n,o,ks.FEATURE),this.objectId=r}}class xFe extends tne{constructor(t){super(Ce(K({},t),{constraint:new yFe(t.coordinateHelper,t.edgeStart,t.edgeEnd)}))}get hints(){return[new Cl(Lc.REFERENCE,this.constraint.start,this.constraint.end,this.elevationInfo,this.domain)]}}class ine extends Nv{constructor({coordinateHelper:t,targetPoint:i,constraint:r,previousVertex:n,otherVertex:o,otherVertexType:c,objectId:h,elevationInfo:m}){super(t,i,r,m,ks.SELF),this.previousVertex=n,this.otherVertex=o,this.otherVertexType=c,this.objectId=h}get hints(){const t=this.previousVertex,i=this.otherVertexType===Dv.CENTER?this.otherVertex:this.targetPoint,r=this.otherVertexType===Dv.CENTER?this.targetPoint:this.otherVertex,n=this.elevationInfo;return[new Cl(Lc.TARGET,i,r,n,this.domain),new Cl(Lc.REFERENCE,t,i,n,this.domain),new u3(this.previousVertex,i,r,n,this.domain)]}}var Dv;(function(e){e[e.NEXT=0]="NEXT",e[e.CENTER=1]="CENTER"})(Dv||(Dv={}));function rne(e,t,i,r,n=it()){const o=t.toXYZ(e);return o[2]=vv(r,o,t.spatialReference,i)||0,r.renderCoordsHelper.toRenderCoords(o,t.spatialReference,n),n}function SFe(e,t,i,r,n=it()){const o=ko(zO,e);return o[2]=vv(r,o,t,i)||0,r.renderCoordsHelper.toRenderCoords(o,t,n),n}function xa(e,t,i,r){return VO(t.toXYZ(e),t.spatialReference,i,r)}function VO(e,t,i,r){return r.type==="2d"?(h4.x=e[0],h4.y=e[1],h4.spatialReference=t,r.toScreen(h4)):(SFe(e,t,i,r,zO),r.state.camera.projectToScreen(zO,GO),yn(GO[0],GO[1]))}function FYe(e,t,i,r,n,o,c){if(r.mode==="absolute-height")return rne(e,i,r,n,o),void rne(t,i,r,n,c);const h=i.toXYZ(e),m=i.toXYZ(t),b=vv(n,h,i.spatialReference,r),x=vv(n,m,i.spatialReference,r),I=(b==null?x:x==null?b:Math.min(b,x))||0;h[2]=I,m[2]=I,n.renderCoordsHelper.toRenderCoords(h,i.spatialReference,o),n.renderCoordsHelper.toRenderCoords(m,i.spatialReference,c)}const h4=new pt,zO=it(),GO=Uw();let Rf=class extends dy{constructor(e){super(e),this.options=null,this._domain=ks.FEATURE,this._sourceModules={featureService:{module:null,loader:null},featureCollection:{module:null,loader:null},graphics:{module:null,loader:null},notes:{module:null,loader:null},scene:{module:null,loader:null}}}get updating(){return Xb(this.snappingSources,({snappingSource:e})=>e.updating)||this.updatingHandles.updating}get snappingSources(){const e=this._get("snappingSources")||new Map,t=new Map;if(H(this.options)&&H(this.options.featureSources))for(const i of this.options.featureSources.items){const r=i.layer.uid,n=e.get(r);if(n){e.delete(r),t.set(r,n);continue}if(!i.layer.loaded){this.updatingHandles.addPromise(i.layer.load());continue}const o=this._createSourceInfo(i);H(o)&&t.set(r,o)}for(const[,i]of e)i.destroy();return t}initialize(){this.updatingHandles.add(()=>this.snappingSources,()=>this.notifyChange("updating"),mu),H(this.view)&&this.handles.add([this.view.on("layerview-create",e=>this._updateLayerView(e.layer,e.layerView)),this.view.on("layerview-destroy",e=>this._updateLayerView(e.layer,null))])}_updateLayerView(e,t){for(const[,i]of this.snappingSources)i.snappingSource.layerSource.layer===e&&(i.layerView=t)}destroy(){this._set("options",null);for(const[,e]of this.snappingSources)e.destroy()}async fetchCandidates(e,t,i,r){if(!(t&this._domain)||ce(this.options)||!this.options.effectiveFeatureEnabled)return[];const n=[],o=this._computeScreeenSizeDistanceParameters(e,i),c={distance:o,point:e,coordinateHelper:i.coordinateHelper,types:this._types};for(const[,{snappingSource:m,layerView:b}]of this.snappingSources)!m.layerSource.enabled||H(b)&&b.suspended||n.push(m.fetchCandidates(c,r).then(x=>x.filter(I=>!this._candidateIsExcluded(m,I,i.excludeFeature))));const h=(await LV(n)).flat();return this._addRightAngleCandidates(h,e,o,i),ur(r),qL(e,h,i.coordinateHelper),h}_addRightAngleCandidates(e,t,i,r){var x,I,E,k,P,F,N,B;const n=H(r.vertexHandle)?(I=(x=r.vertexHandle.rightEdge)==null?void 0:x.rightVertex)==null?void 0:I.pos:H(r.editGeometryOperations)&&r.editGeometryOperations.data.type==="polygon"?(k=Ht((E=r.editGeometryOperations.data.components[0])==null?void 0:E.getFirstVertex()))==null?void 0:k.pos:null,o=H(r.vertexHandle)?(F=(P=r.vertexHandle.leftEdge)==null?void 0:P.leftVertex)==null?void 0:F.pos:H(r.editGeometryOperations)?(B=Ht((N=r.editGeometryOperations.data.components[0])==null?void 0:N.getLastVertex()))==null?void 0:B.pos:null,{view:c}=this,h=bn(n,c,r),m=bn(o,c,r),b=e.length;for(let z=0;z<b;z++)this._addRightAngleCandidate(e[z],m,t,i,r,e),this._addRightAngleCandidate(e[z],h,t,i,r,e)}_addRightAngleCandidate(e,t,i,r,n,o){const c=e instanceof xFe,h=c&&XP(e.constraint.start,e.constraint.end);if(ce(t)||!c||h)return;const m=e.constraint.closestTo(t),b=(m[0]-i[0])/r.x,x=(m[1]-i[1])/r.y;if(b*b+x*x<=1){const I=n.coordinateHelper,E=new ine({coordinateHelper:I,targetPoint:m,otherVertex:t,otherVertexType:Dv.NEXT,previousVertex:e.constraint.start,constraint:new Xre(I,t,m),objectId:e.objectId,elevationInfo:e.elevationInfo});o.push(E)}}_computeScreeenSizeDistanceParameters(e,t){let i=H(this.options)?this.options.distance*(t.pointer==="touch"?this.options.touchSensitivityMultiplier:1):0;return ce(this.view)?{x:i,y:i,z:i,distance:i}:this.view.type==="2d"?(i*=this.view.resolution,{x:i,y:i,z:i,distance:i}):this._computeScreenSizeDistanceParameters3D(e,i,this.view,t)}_computeScreenSizeDistanceParameters3D(e,t,i,r){const{coordinateHelper:n,elevationInfo:o}=r,{spatialReference:c}=n,h=n.hasZ()?kr:o,m=n.toXYZ(e,IFe);m[2]=vv(i,m,c,h,kr),i.renderCoordsHelper.toRenderCoords(m,c,nne);const b=i.state.camera.computeScreenPixelSizeAt(nne),x=b*i.renderCoordsHelper.unitInMeters/i.mapCoordsHelper.unitInMeters,I=t*x,E=VO(m,c,kr,i),k=BO(E,m,x,0,0,i,r),P=BO(E,m,0,x,0,i,r),F=BO(E,m,0,0,x,i,r);return{x:k===0?0:I/k,y:P===0?0:I/P,z:F===0?0:I/F,distance:b*t}}get _types(){return Ov.EDGE|Ov.VERTEX}_candidateIsExcluded(e,t,i){if(ce(i))return!1;const r=this._getCandidateObjectId(t);if(ce(r))return!1;const n=e.layerSource.layer;return n.type==="graphics"?i.uid===r:i.sourceLayer===n&&!(!i.attributes||!("objectIdField"in n))&&i.attributes[n.objectIdField]===r}_getCandidateObjectId(e){return e instanceof tne?e.objectId:null}_createSourceInfo(e){const t=this._createFeatureSnappingSourceType(e);if(ce(t))return null;if("loading"in t)return this.updatingHandles.addPromise(t.loading.then(()=>{this.destroyed||this.notifyChange("snappingSources")})),null;const i=H(this.view)?this.view.allLayerViews.find(r=>r.layer===e.layer):null;return new MFe(t.source,i)}_createFeatureSnappingSourceType(e){switch(e.layer.type){case"feature":case"geojson":case"csv":case"oriented-imagery":case"subtype-group":case"wfs":return this._createFeatureSnappingSourceFeatureLayer(e);case"graphics":return this._createFeatureSnappingSourceGraphicsLayer(e);case"map-notes":return this._createFeatureSnappingSourceMapNotesLayer(e);case"scene":case"building-scene":return this._createFeatureSnappingSourceSceneLayer(e)}return null}_createFeatureSnappingSourceSceneLayer(e){const{view:t}=this;if(ce(t)||t.type!=="3d")return null;const i=this._getSourceModule("scene");return H(i.module)?{source:new i.module.SceneLayerSnappingSource({layerSource:e,view:t})}:{loading:i.loader}}_createFeatureSnappingSourceFeatureLayer(e){switch(e.layer.source.type){case"feature-layer":case"oriented-imagery":{const t=this._getSourceModule("featureService");return H(t.module)?{source:new t.module.FeatureServiceSnappingSource({spatialReference:this.spatialReference,view:this.view,layerSource:e})}:{loading:t.loader}}case"memory":case"csv":case"geojson":case"wfs":{if(e.layer.geometryType==="mesh")return null;const t=this._getSourceModule("featureCollection");return H(t.module)?{source:new t.module.FeatureCollectionSnappingSource({layerSource:e,view:this.view})}:{loading:t.loader}}}return null}_createFeatureSnappingSourceGraphicsLayer(e){const t=this._getSourceModule("graphics");return H(t.module)?{source:new t.module.GraphicsSnappingSource({getGraphicsLayers:()=>[e.layer],spatialReference:this.spatialReference,view:this.view,layerSource:e})}:{loading:t.loader}}_createFeatureSnappingSourceMapNotesLayer(e){const t=this._getSourceModule("notes");return H(t.module)?{source:new t.module.GraphicsSnappingSource({getGraphicsLayers:()=>H(e.layer.sublayers)?e.layer.sublayers.toArray():[],spatialReference:this.spatialReference,view:this.view,layerSource:e})}:{loading:t.loader}}_getSourceModule(e){const t=this._sourceModules[e];if(ce(t.loader)){const i=this._loadSourceModule(e).then(r=>{t.module=r});return t.loader=i,{module:t.module,loader:i}}return{module:t.module,loader:t.loader}}_loadSourceModule(e){const t=this.updatingHandles;switch(e){case"featureService":return t.addPromise(import("./FeatureServiceSnappingSource.4e36296c.js"));case"featureCollection":return t.addPromise(import("./FeatureCollectionSnappingSource.2490f88c.js"));case"graphics":case"notes":return t.addPromise(import("./GraphicsSnappingSource.640a9021.js"));case"scene":return t.addPromise(import("./SceneLayerSnappingSource.d78e44a8.js"))}return null}};g([w({constructOnly:!0})],Rf.prototype,"spatialReference",void 0),g([w({constructOnly:!0})],Rf.prototype,"view",void 0),g([w()],Rf.prototype,"options",void 0),g([w({readOnly:!0})],Rf.prototype,"updating",null),g([w({readOnly:!0})],Rf.prototype,"snappingSources",null),Rf=g([te("esri.views.interactive.snapping.FeatureSnappingEngine")],Rf);class MFe{constructor(t,i){this.snappingSource=t,this.layerView=i,this.handles=new Ti;const r=this.snappingSource.layerSource.layer;if("refresh"in r){const n=r;this.handles.add(n.on("refresh",()=>t.refresh()))}this.handles.add([we(()=>t.updating,n=>t.layerSource.updating=n,Gs),we(()=>t.availability,n=>t.layerSource.availability=n,Gs)])}destroy(){this.snappingSource.destroy(),this.handles.destroy()}}function BO(e,t,i,r,n,o,{coordinateHelper:c}){const h=ko($Fe,t);h[0]+=i,h[1]+=r,h[2]+=n;const m=VO(h,c.spatialReference,kr,o);return _Pe(m,e)}const IFe=it(),nne=it(),$Fe=it();class p4{constructor(t,i){this.view=t,this.options=i,this.squaredShortLineThreshold=Ya.shortLineThreshold*Ya.shortLineThreshold}snap(t,i){return H(i.vertexHandle)?i.vertexHandle.type!=="vertex"?[]:this.snapExistingVertex(t,i):this.snapNewVertex(t,i)}edgeExceedsShortLineThreshold(t,i){return this.exceedsShortLineThreshold(t.leftVertex.pos,t.rightVertex.pos,i)}exceedsShortLineThreshold(t,i,{elevationInfo:r,editGeometryOperations:n}){const o=n.data.coordinateHelper;return this.squaredShortLineThreshold===0||im(xa(i,o,r,this.view),xa(t,o,r,this.view))>this.squaredShortLineThreshold}squaredProximityThreshold(t){return t==="touch"?this._squaredTouchProximityThreshold:this._squaredMouseProximityTreshold}get _squaredMouseProximityTreshold(){return this.options.distance*this.options.distance}get _squaredTouchProximityThreshold(){const{distance:t,touchSensitivityMultiplier:i}=this.options,r=t*i;return r*r}}class EFe extends Nv{constructor({coordinateHelper:t,lineStart:i,lineEnd:r,targetPoint:n,elevationInfo:o}){super(t,n,new Qre(t,i,r),o,ks.SELF),this._referenceLineHint=new Cl(Lc.REFERENCE_EXTENSION,i,r,o,this.domain)}get hints(){return[this._referenceLineHint,new Cl(Lc.TARGET,this._lineEndClosestToTarget(),this.targetPoint,this.elevationInfo,this.domain)]}_lineEndClosestToTarget(){return this.constraint.closestEndTo(this.targetPoint)}}class TFe extends p4{snapNewVertex(t,i){const r=i.editGeometryOperations.data.components[0],n=r.edges.length,o=[];if(n<1)return o;const c=i.coordinateHelper,h=xa(t,c,kr,this.view),{view:m}=this,b=r.edges[n-1];let x=b;do{if(this.edgeExceedsShortLineThreshold(x,i)){const I=Ou(x,m,i);this._processCandidateProposal(I.left,I.right,t,h,i,o)}x=x.leftVertex.leftEdge}while(x&&x!==b);return o}snapExistingVertex(t,i){const r=[],n=Ht(i.vertexHandle),o=n.component;if(o.edges.length<2)return r;const{view:c}=this,{coordinateHelper:h}=i,m=xa(t,h,kr,c),b=n.leftEdge,x=n.rightEdge;b&&x&&this.edgeExceedsShortLineThreshold(b,i)&&this.edgeExceedsShortLineThreshold(x,i)&&this._processCandidateProposal(bn(b.leftVertex.pos,c,i),bn(x.rightVertex.pos,c,i),t,m,i,r);const I=o.edges[0];let E=I;do{if(E!==n.leftEdge&&E!==n.rightEdge&&this.edgeExceedsShortLineThreshold(E,i)){const k=Ou(E,c,i);this._processCandidateProposal(k.left,k.right,t,m,i,r)}E=E.rightVertex.rightEdge}while(E&&E!==I);return r}_processCandidateProposal(t,i,r,n,o,c){const{coordinateHelper:h,pointer:m}=o;h.toXYZ(t,sne),h.toXYZ(i,one);const b=h.toXYZ(r,kFe),x=RO(b,CFe),I=h.fromXYZ(x);im(n,xa(I,h,kr,this.view))<this.squaredProximityThreshold(m)&&c.push(new EFe({coordinateHelper:h,lineStart:t,lineEnd:i,targetPoint:I,elevationInfo:h.hasZ()?kr:null}))}}const sne=it(),one=it(),CFe={start:sne,end:one,type:Kr.LINE},kFe=it();class AFe extends Nv{constructor({coordinateHelper:t,referenceLine:i,lineStart:r,targetPoint:n,elevationInfo:o}){const c=t.toXYZ(r,PFe),h=t.toXYZ(i.left,LFe),m=t.toXYZ(i.right,OFe);fn(c,Ko(c,c,m),h),super(t,n,new Qre(t,r,t.fromXYZ(c)),o,ks.SELF),this._referenceLines=[{edge:i,fadeLeft:!0,fadeRight:!0}]}get hints(){const t=this.elevationInfo;return[new Cl(Lc.TARGET,this.constraint.start,this.targetPoint,t,this.domain),new CI(this.constraint.start,this.targetPoint,t,this.domain),...this._referenceLines.map(i=>new Cl(Lc.REFERENCE,i.edge.left,i.edge.right,t,this.domain,i.fadeLeft,i.fadeRight))]}addReferenceLine(t){const i={edge:t,fadeLeft:!0,fadeRight:!0},{coordinateHelper:r}=this;this._referenceLines.forEach(n=>{r.equals(t.right,n.edge.left)&&(n.fadeLeft=!1,i.fadeRight=!1),r.equals(t.right,n.edge.right)&&(n.fadeRight=!1,i.fadeRight=!1),r.equals(t.left,n.edge.right)&&(n.fadeRight=!1,i.fadeLeft=!1),r.equals(t.left,n.edge.left)&&(n.fadeLeft=!1,i.fadeLeft=!1)}),this._referenceLines.push(i)}}const PFe=it(),LFe=it(),OFe=it();class RFe extends p4{snapNewVertex(t,i){const r=i.editGeometryOperations.data.components[0],n=r.edges.length,o=r.vertices.length,c=[];if(n<2)return c;const{view:h}=this,m=xa(t,i.coordinateHelper,kr,h),b=bn(r.vertices[o-1].pos,h,i),x=bn(r.vertices[0].pos,h,i),I=r.edges[n-1];let E=I;do{if(this.edgeExceedsShortLineThreshold(E,i)){const k=Ou(E,h,i);this._checkEdgeForParalleLines(k,b,t,m,i,c),this._checkEdgeForParalleLines(k,x,t,m,i,c)}E=E.leftVertex.leftEdge}while(E&&E!==I);return c}snapExistingVertex(t,i){const r=[],n=Ht(i.vertexHandle),o=n.component;if(o.edges.length<3)return r;const{view:c}=this,h=xa(t,i.coordinateHelper,kr,c),m=n.leftEdge,b=n.rightEdge,x=o.vertices[0],I=bn(x.pos,c,i),E=o.vertices.length,k=o.vertices[E-1],P=bn(k.pos,c,i),F=o.edges[0];let N=F;do{if(N!==m&&N!==b&&this.edgeExceedsShortLineThreshold(N,i)){const B=Ou(N,c,i);m&&this._checkEdgeForParalleLines(B,bn(m.leftVertex.pos,c,i),t,h,i,r),b&&this._checkEdgeForParalleLines(B,bn(b.rightVertex.pos,c,i),t,h,i,r),n===x?this._checkEdgeForParalleLines(B,P,t,h,i,r):n===k&&this._checkEdgeForParalleLines(B,I,t,h,i,r)}N=N.rightVertex.rightEdge}while(N&&N!==F);return r}_checkEdgeForParalleLines(t,i,r,n,o,c){const h=t.left,m=t.right;if(iO(jv,i,h,m),Q1(jv,i)<Ya.parallelLineThreshold)return;iO(jv,r,h,m,i);const{coordinateHelper:b,pointer:x}=o,I=b.fromXYZ(jv,b.getZ(r,0));if(im(n,xa(I,b,kr,this.view))<this.squaredProximityThreshold(x)){if(this._parallelToPreviousCandidate(t,c))return;c.push(new AFe({coordinateHelper:b,referenceLine:t,lineStart:i,targetPoint:I,elevationInfo:b.hasZ()?kr:null}))}}_parallelToPreviousCandidate(t,i){const r=t.left,n=t.right;for(const o of i)if(iO(jv,n,o.constraint.start,o.constraint.end,r),Q1(jv,n)<Ya.parallelLineThreshold)return o.addReferenceLine(t),!0;return!1}}const jv=ui();class FFe extends p4{snapNewVertex(t,i){const r=i.editGeometryOperations.data.components[0],n=r.vertices.length,o=[];if(n<2)return o;const{view:c}=this,h=xa(t,i.coordinateHelper,kr,c),m=r.vertices[n-1];if(this.edgeExceedsShortLineThreshold(m.leftEdge,i)){const x=bn(m.pos,c,i),I=Ou(m.leftEdge,c,i);this._checkForSnappingCandidate(o,I,x,t,I.left,x,i,t,h)}const b=r.vertices[0];if(this.edgeExceedsShortLineThreshold(b.rightEdge,i)){const x=bn(b.pos,c,i),I=Ou(b.rightEdge,c,i);this._checkForSnappingCandidate(o,I,x,t,I.right,x,i,t,h)}return o}snapExistingVertex(t,i){const r=[],n=Ht(i.vertexHandle),o=n.component,c=o.vertices.length;if(c<3)return r;const{view:h}=this,m=xa(t,i.coordinateHelper,kr,h),b=n.leftEdge,x=n.rightEdge,I=o.vertices[0],E=o.vertices[c-1];if(!b){const k=I.rightEdge.rightVertex.rightEdge;if(this.edgeExceedsShortLineThreshold(k,i)){const P=Ou(k,h,i),F=bn(I.rightEdge.rightVertex.pos,h,i);this._checkForSnappingCandidate(r,P,F,t,P.right,F,i,t,m)}return r}if(!x){const k=E.leftEdge.leftVertex.leftEdge;if(this.edgeExceedsShortLineThreshold(k,i)){const P=Ou(k,h,i),F=bn(E.leftEdge.leftVertex.pos,h,i);this._checkForSnappingCandidate(r,P,F,t,P.left,F,i,t,m)}return r}if(b&&b.leftVertex.leftEdge){const k=b.leftVertex.leftEdge;if(this.edgeExceedsShortLineThreshold(k,i)){const P=Ou(k,h,i),F=bn(b.leftVertex.pos,h,i);this._checkForSnappingCandidate(r,P,F,t,P.left,F,i,t,m)}}if(x&&x.rightVertex.rightEdge){const k=x.rightVertex.rightEdge;if(this.edgeExceedsShortLineThreshold(k,i)){const P=Ou(k,h,i),F=bn(x.rightVertex.pos,h,i);this._checkForSnappingCandidate(r,P,F,t,P.right,F,i,t,m)}}return r}_checkForSnappingCandidate(t,i,r,n,o,c,h,m,b){const{coordinateHelper:x,pointer:I}=h;Jr(T3,i.right,i.left);const E=Nn(jFe,T3[1],-T3[0],0),k=np(E,Jr(T3,n,r))/_f(E),P=x.fromXYZ(Tc(T3,c,E,k),x.getZ(m,0));if(im(b,xa(P,x,kr,this.view))<this.squaredProximityThreshold(I)){const F=x.toXYZ(c,NFe),N=A0(DFe,F,E,Math.sign(k)),B=x.fromXYZ(N);t.push(new ine({coordinateHelper:x,targetPoint:P,constraint:new Xre(x,c,B),previousVertex:o,otherVertex:c,otherVertexType:Dv.CENTER,elevationInfo:x.hasZ()?kr:null}))}}}const T3=ui(),NFe=it(),DFe=it(),jFe=it();class VFe extends Nv{constructor({coordinateHelper:t,targetPoint:i,point1:r,point2:n,elevationInfo:o}){super(t,i,new Yre(t,t.arrayToVector(rI(zFe,r,n,.5)),.5*rp(r,n)),o,ks.SELF),this._p1=r,this._p2=n}get hints(){const t=this.elevationInfo;return[new Cl(Lc.REFERENCE,this.targetPoint,this._p1,t,this.domain),new Cl(Lc.REFERENCE,this.targetPoint,this._p2,t,this.domain),new u3(this._p1,this.targetPoint,this._p2,t,this.domain)]}}const zFe=ui();class GFe extends p4{snapNewVertex(t,i){const r=i.editGeometryOperations.data.components[0],n=[],o=r.vertices.length;if(i.editGeometryOperations.data.type!=="polygon"||o<2)return n;const{view:c}=this,h=r.vertices[0],m=r.vertices[o-1],b=bn(h.pos,c,i),x=bn(m.pos,c,i);return this._processCandidateProposal(b,x,t,i,n),n}snapExistingVertex(t,i){const r=[],n=Ht(i.vertexHandle),o=n.component;if(o.edges.length<2||i.editGeometryOperations.data.type==="polyline"&&(n.index===0||n.index===o.vertices.length-1))return r;const{view:c}=this,h=bn(n.leftEdge.leftVertex.pos,c,i),m=bn(n.rightEdge.rightVertex.pos,c,i);return this._processCandidateProposal(h,m,t,i,r),r}_processCandidateProposal(t,i,r,n,o){if(!this.exceedsShortLineThreshold(t,i,n))return;const c=rI(BFe,t,i,.5),h=.5*rp(t,i),m=$Le(UFe,r,c,h),{coordinateHelper:b,pointer:x}=n,I=b.fromXYZ(m,b.getZ(r,0)),E=xa(r,b,kr,this.view);im(E,xa(I,b,kr,this.view))<this.squaredProximityThreshold(x)&&o.push(new VFe({coordinateHelper:b,targetPoint:I,point1:t,point2:i,elevationInfo:b.hasZ()?kr:null}))}}const BFe=ui(),UFe=ui();let Vv=class extends Ye{constructor(e){super(e),this.updating=!1,this._snappers=new Xe,this._domain=ks.SELF}initialize(){this._snappers.push(new RFe(this.view,this.options),new TFe(this.view,this.options),new FFe(this.view,this.options),new GFe(this.view,this.options))}set options(e){this._set("options",e);for(const t of this._snappers)t.options=e}async fetchCandidates(e,t,i){if(!(t&this._domain&&this.options.effectiveSelfEnabled))return[];const r=[];for(const n of this._snappers.items)for(const o of n.snap(e,i))r.push(o);return qL(e,r,i.coordinateHelper),r}};g([w({readOnly:!0})],Vv.prototype,"updating",void 0),g([w({constructOnly:!0})],Vv.prototype,"view",void 0),g([w()],Vv.prototype,"options",null),Vv=g([te("esri.views.interactive.snapping.SelfSnappingEngine")],Vv);function qFe(e,t){return[new Vv({view:e,options:t}),new Rf({view:e,options:t,spatialReference:e.spatialReference})]}let fm=class extends Ye{constructor(e){super(e),this.layer=null,this.enabled=!0,this.updating=!1,this.availability=1}};g([w({constructOnly:!0})],fm.prototype,"layer",void 0),g([w()],fm.prototype,"enabled",void 0),g([w()],fm.prototype,"updating",void 0),g([w()],fm.prototype,"availability",void 0),fm=g([te("esri.views.interactive.snapping.FeatureSnappingLayerSource")],fm);const ane=fm;let el=class extends Ye{constructor(e){super(e),this.enabled=!1,this.enabledToggled=!1,this.selfEnabled=!0,this.featureEnabled=!0,this.featureSources=new Xe,this.distance=Ya.distance,this.touchSensitivityMultiplier=Ya.touchSensitivityMultiplier}get effectiveEnabled(){return this.enabledToggled?!this.enabled:this.enabled}get effectiveSelfEnabled(){return this.effectiveEnabled&&this.selfEnabled}get effectiveFeatureEnabled(){return this.effectiveEnabled&&this.featureEnabled}};g([w()],el.prototype,"enabled",void 0),g([w()],el.prototype,"enabledToggled",void 0),g([w()],el.prototype,"selfEnabled",void 0),g([w()],el.prototype,"featureEnabled",void 0),g([w({type:Xe.ofType(ane)})],el.prototype,"featureSources",void 0),g([w()],el.prototype,"distance",void 0),g([w()],el.prototype,"touchSensitivityMultiplier",void 0),g([w({readOnly:!0})],el.prototype,"effectiveEnabled",null),g([w({readOnly:!0})],el.prototype,"effectiveSelfEnabled",null),g([w({readOnly:!0})],el.prototype,"effectiveFeatureEnabled",null),el=g([te("esri.views.interactive.snapping.SnappingOptions")],el);const UO=el;class d4 extends Nv{constructor(t,i,r,n,o){super(t,i,new u4(t,i,r.constraint,n.constraint),o,ks.ALL),this.first=r,this.second=n}get hints(){return this.first.targetPoint=this.targetPoint,this.second.targetPoint=this.targetPoint,[...this.first.hints,...this.second.hints,new TI(this.targetPoint,this.elevationInfo,this.domain)]}}let ju=class extends Or.EventedMixin(dy){constructor(e){super(e),this.options=new UO,this.snappingEnginesFactory=qFe,this._engines=[],this._currentMainCandidate=null,this._currentOtherActiveCandidates=[],this._currentSnappedType=$p.MAIN}initialize(){this.handles.add([we(()=>{const{effectiveFeatureEnabled:e,effectiveSelfEnabled:t,touchSensitivityMultiplier:i,distance:r}=this.options;return{effectiveFeatureEnabled:e,effectiveSelfEnabled:t,touchSensitivityMultiplier:i,distance:r}},()=>{this.doneSnapping(),this.emit("changed")},mu),we(()=>this.options,e=>{for(const t of this._engines)t.options=e},mu),we(()=>({viewReady:this.view.ready,viewSpatialReference:this.view.spatialReference,snappingEnginesFactory:this.snappingEnginesFactory}),({viewReady:e,snappingEnginesFactory:t})=>this._recreateEngines(e,t),Gs)])}destroy(){this._destroyEngines()}get updating(){return this._engines.some(e=>e.updating)}_recreateEngines(e,t){if(this._destroyEngines(),!e)return;const{view:i,options:r}=this;this._engines=t(i,r)}_destroyEngines(){for(const e of this._engines)e.destroy();this._engines=[]}get _squaredMouseProximityTreshold(){return this.options.distance*this.options.distance}get _squaredTouchProximityThreshold(){const{distance:e,touchSensitivityMultiplier:t}=this.options,i=e*t;return i*i}async snap(e){return HFe(e)?this._snapMultiPoint(e):this._snapSinglePoint(e)}update(e){const{point:t,context:i}=e;this._removeVisualization();const r=this._currentMainCandidate;if(ce(r))return t;const n=this._selectUpdateInput(e);if(ce(n))return t;const{coordinateHelper:{spatialReference:o}}=i,c=Da(this._convertPointElevation(n,i),o);if(ce(c))return t;const{view:h}=this,{coordinateHelper:m,elevationInfo:b,visualizer:x}=i,I=[],E=m.pointToVector(c),k=r.constraint.closestTo(E);if(!this._arePointsWithinScreenThreshold(E,k,i))return this._resetSnappingState(),t;r.targetPoint=k,I.push(...r.hints);for(const F of this._currentOtherActiveCandidates)F.targetPoint=k,I.push(...F.hints);H(x)&&this.handles.add(x.draw(I,{coordinateHelper:m,elevationInfo:lne(i),view:h,selfSnappingZ:i.selfSnappingZ}),f4);const P=m.vectorToDehydratedPoint(k);return this._convertPointElevation(P,i,kr,b)}doneSnapping(){this._removeVisualization(),this._resetSnappingState()}_selectUpdateInput({point:e,scenePoint:t}){switch(this._currentSnappedType){case $p.MAIN:return e;case $p.SCENE:return t}}_resetSnappingState(){this._currentMainCandidate=null,this._currentOtherActiveCandidates=[],this._currentSnappedType=$p.MAIN}_removeVisualization(){this.handles.remove(f4)}async _snapSinglePoint({point:e,context:t,signal:i}){const{coordinateHelper:r}=t,{view:n}=this,o=this._convertPointElevation(e,t),c=r.pointToVector(o),h=await this._fetchCandidates(c,ks.ALL,t,i);return this._createSnapResult(c,$p.MAIN,h,n,t,i)}async _snapMultiPoint({point:e,scenePoint:t,context:i,signal:r}){const{view:n}=this,{coordinateHelper:o}=i,{spatialReference:c}=o;await aq(t.spatialReference,c);const h=Da(this._convertPointElevation(t,i),c),m=o.pointToVector(h),b=await this._fetchCandidates(m,ks.FEATURE,i,r);if(b.length>0){const k=await this._fetchCandidates(m,ks.SELF,i,r);return this._createSnapResult(m,$p.SCENE,[...b,...k],n,i,r)}const x=this._convertPointElevation(e,i),I=o.pointToVector(x),E=await this._fetchCandidates(I,ks.SELF,i,r);return this._createSnapResult(I,$p.MAIN,E,n,i,r)}async _fetchCandidates(e,t,i,r){return(await Promise.all(this._engines.map(n=>n.fetchCandidates(e,t,i,r)))).flat()}_createSnapResult(e,t,i,r,n,o){return{get valid(){return!ka(o)},apply:()=>{const{elevationInfo:c,coordinateHelper:h}=n,{snappedPoint:m,hints:b}=this._processCandidates(e,t,i,n);return this._removeVisualization(),H(n.visualizer)&&this.handles.add(n.visualizer.draw(b,{coordinateHelper:h,elevationInfo:lne(n),view:r,selfSnappingZ:n.selfSnappingZ}),f4),this._convertPointElevation(m,n,kr,c)}}}_processCandidates(e,t,i,r){const{coordinateHelper:n}=r;if(i.length<1)return this.doneSnapping(),{snappedPoint:n.vectorToDehydratedPoint(e),hints:[]};this._currentSnappedType!==t&&this._resetSnappingState(),qL(e,i,n);const o=this._currentMainCandidate;if(H(o)){const c=this._findOldConstraintInNewCandidates(o,i);if(c>=0){if(!(i[c]instanceof d4))return this._intersectWithOtherCandidates(c,i,e,t,r);if(this._arePointsWithinScreenThreshold(e,o.targetPoint,r))return this._updateSnappingCandidate(o,t,i,r)}}return this._intersectWithOtherCandidates(0,i,e,t,r)}_findOldConstraintInNewCandidates(e,t){return e instanceof d4?this._findOldCandidateIndex(t,e.first)>=0&&this._findOldCandidateIndex(t,e.second)>=0?0:-1:this._findOldCandidateIndex(t,e)}_intersectWithOtherCandidates(e,t,i,r,n){const{coordinateHelper:o}=n,c=t[e],h=[];for(let m=0;m<t.length;++m){if(m===e)continue;const b=t[m];for(const x of c.constraint.intersect(b.constraint)){const I=o.fromXYZ(x.closestTo(c.targetPoint),c.targetPoint[2]);h.push([new d4(o,I,c,b,b.elevationInfo),this._squaredScreenDistance(i,I,o)])}}return h.length>0&&(h.sort((m,b)=>m[1]-b[1]),h[0][1]<this._squaredPointProximityThreshold(n.pointer))?this._updateSnappingCandidate(h[0][0],r,t,n):this._updateSnappingCandidate(c,r,t,n)}_updateSnappingCandidate(e,t,i,r){this.doneSnapping(),this._currentMainCandidate=e,this._currentSnappedType=t;const n=this._currentMainCandidate.targetPoint,o=[];o.push(...e.hints);for(const c of i){if(e instanceof d4){if(c.constraint.equals(e.first.constraint)||c.constraint.equals(e.second.constraint))continue}else if(c.constraint.equals(e.constraint))continue;c.constraint.check(n)&&(c.targetPoint=n,this._currentOtherActiveCandidates.push(c),o.push(...c.hints))}return{snappedPoint:r.coordinateHelper.vectorToDehydratedPoint(n),hints:o}}_squaredPointProximityThreshold(e){return e==="touch"?this._squaredTouchProximityThreshold:this._squaredMouseProximityTreshold}_arePointsWithinScreenThreshold(e,t,i){return this._squaredScreenDistance(e,t,i.coordinateHelper)<this._squaredPointProximityThreshold(i.pointer)}_squaredScreenDistance(e,t,i){return im(this._toScreen(e,i),this._toScreen(t,i))}_toScreen(e,t){return xa(e,t,kr,this.view)}_findOldCandidateIndex(e,t){let i=-1;for(let r=0;r<e.length;++r)if(t.constraint.equals(e[r].constraint)){i=r;break}return i}_convertPointElevation(e,t,i=t.elevationInfo,r=kr){const{view:n}=this;if(!(H(e)&&t.coordinateHelper.hasZ()&&H(n)&&n.type==="3d"))return e;const o=_e(e);return o.z=UL(n,o,i,r),o}get test(){return{visualizationsActive:this.handles.has(f4),engines:this._engines}}};var $p;g([w({constructOnly:!0})],ju.prototype,"view",void 0),g([w()],ju.prototype,"options",void 0),g([w({readOnly:!0})],ju.prototype,"updating",null),g([w()],ju.prototype,"snappingEnginesFactory",void 0),g([w()],ju.prototype,"_engines",void 0),g([w()],ju.prototype,"_squaredMouseProximityTreshold",null),g([w()],ju.prototype,"_squaredTouchProximityThreshold",null),ju=g([te("esri.views.interactive.snapping.SnappingManager")],ju),function(e){e[e.MAIN=0]="MAIN",e[e.SCENE=1]="SCENE"}($p||($p={}));const f4="visualization-handle";function HFe(e){return H(e.scenePoint)}function lne({coordinateHelper:e,elevationInfo:t}){return e.hasZ()?kr:t}function WFe(e){return H(e)&&e.type==="graphic"}function JFe(e){var t;return(t=e.find(WFe))!=null?t:null}let Js=class extends Or.EventedAccessor{constructor(e){super(e),this.cancelled=!1,this.history={undo:[],redo:[]},this.type=null}get tool(){if(!this.activeComponent)return null;switch(this.activeComponent.type){case"graphic-mover":case"move-3d":return"move";case"box":case"transform-3d":return"transform";case"reshape":case"reshape-3d":return"reshape";case"draw-2d":case"draw-3d":return this.activeComponent.geometryType;default:sU(this.activeComponent)}return null}addToHistory(e){this.history.redo=[],this.history.undo.push(e)}resetHistory(){this.history.redo=[],this.history.undo=[]}canUndo(){return this.history.undo.length>0}canRedo(){return this.history.redo.length>0}complete(){this._reset(),this.onEnd(),this.emit("complete")}cancel(){this.cancelled=!0,this.complete()}_reset(){this.activeComponent.reset()}refreshComponent(){const e=this.activeComponent;e&&(e.type!=="box"&&e.type!=="reshape"&&e.type!=="graphic-mover"||e.refresh())}set undo(e){this._set("undo",()=>{this.canUndo()&&e()})}set redo(e){this._set("redo",()=>{this.canRedo()&&e()})}};g([w()],Js.prototype,"activeComponent",void 0),g([w()],Js.prototype,"cancelled",void 0),g([w()],Js.prototype,"history",void 0),g([w()],Js.prototype,"tool",null),g([w()],Js.prototype,"type",void 0),g([w()],Js.prototype,"canUndo",null),g([w()],Js.prototype,"canRedo",null),g([w()],Js.prototype,"onEnd",void 0),g([w()],Js.prototype,"undo",null),g([w()],Js.prototype,"redo",null),g([w()],Js.prototype,"toggleTool",void 0),g([w()],Js.prototype,"addToSelection",void 0),g([w()],Js.prototype,"removeFromSelection",void 0),Js=g([te("esri.widgets.Sketch.support.OperationHandle")],Js);let y4=class extends Js{};g([w()],y4.prototype,"activeComponent",void 0),y4=g([te("esri.widgets.Sketch.support.CreateOperationHandle")],y4);let Ep=class extends Js{};g([w()],Ep.prototype,"activeComponent",void 0),Ep=g([te("esri.widgets.Sketch.support.UpdateOperationHandle")],Ep);const cne={defaultZ:0},m4={reshapeOptions:{edgeOperation:"split",shapeOperation:"move",vertexOperation:"move"},enableMoveAllGraphics:!0,enableRotation:!0,enableScaling:!0,multipleSelectionEnabled:!0,preserveAspectRatio:!1,toggleToolOnClick:!0,enableZ:!0,tool:"transform"};let cr=class extends Or.EventedAccessor{constructor(e){super(e),this._numUpdating=0,this._handles=new Ti,this._internalGraphicsLayer=new RL({listMode:"hide",internal:!0,title:"SVM Internal"}),this._operationHandle=null,this._viewHandles=new Ti,this.activeFillSymbol=null,this.activeLineSymbol=null,this.activeVertexSymbol=null,this.allowDeleteKey=!0,this.labelOptions=new UI,this.layer=null,this.pointSymbol=new Dn({style:"circle",size:6,color:[255,255,255],outline:{color:[50,50,50],width:1}}),this.polygonSymbol=new ea({color:[150,150,150,.2],outline:{color:[50,50,50],width:2}}),this.polylineSymbol=new rs({color:[130,130,130,1],width:2}),this._snappingManager=null,this.tooltipOptions=new qI,this.updateGraphics=new Xe,this.updateOnGraphicClick=!0,this.updatePointSymbol=new Dn({size:10,color:[0,200,255,.5],outline:{color:"black",width:1}}),this.updatePolygonSymbol=new ea({color:[12,207,255,.2],outline:{join:"round",color:[12,207,255],width:2}}),this.updatePolylineSymbol=new rs({color:[12,207,255],width:2}),this.vertexSymbol=new Dn({style:"circle",size:6,color:[255,255,255],outline:{color:[50,50,50],width:1}}),this._moduleLoaderAbortController=null,this._viewReadyAbortController=null,this._originalAutoOpenEnabled=null,this.defaultCreateOptions=cne,this.defaultUpdateOptions=m4,this.snappingOptions=new UO}initialize(){this._handles.add([vr(()=>{var e,t;return(t=(e=this.view)==null?void 0:e.map)==null?void 0:t.layers},"change",e=>{e.removed.includes(this.layer)&&this.cancel()}),vr(()=>{var e;return(e=this.layer)==null?void 0:e.graphics},"change",e=>{if(H(this._operationHandle))for(const t of e.removed)this.updateGraphics.includes(t)&&(this.updateGraphics.length>1?this._operationHandle.removeFromSelection(t):this._operationHandle.cancel())}),we(()=>{var e,t;return(t=(e=this.layer)==null?void 0:e.elevationInfo)!=null?t:null},e=>{e!==this._internalGraphicsLayer.elevationInfo&&(this.cancel(),this._internalGraphicsLayer.elevationInfo=e)},Gs),we(()=>this.view,e=>{li(this._snappingManager),e&&(this._snappingManager=new ju({view:e,options:this.snappingOptions}),e.type==="2d"?import("./editingTools.121b7f82.js"):e.type==="3d"&&(import("./editingTools.060270b4.js").then(function(t){return t.e}),import("./GraphicsLayerView3D.629f4d9f.js").then(function(t){return t.G})))},Gs),we(()=>{var e;return(e=this.view)==null?void 0:e.spatialReference},(e,t)=>{e&&t&&!e.equals(t)&&this.cancel()})])}destroy(){this.cancel(),this._handles=li(this._handles),this._viewHandles=li(this._viewHandles),this._removeDefaultLayer(),this._snappingManager=li(this._snappingManager),this._set("view",null),this.emit("destroy")}get _defaultUpdateTool(){return this.view.type==="3d"?"move":"transform"}get updating(){return this._numUpdating>0}get activeTool(){return this._operationHandle&&this._operationHandle.tool?this._operationHandle.tool:null}get activeComponent(){return this._operationHandle?this._operationHandle.activeComponent:null}get createGraphic(){return!H(this.activeComponent)||this.activeComponent.type!=="draw-3d"&&this.activeComponent.type!=="draw-2d"?this._get("createGraphic"):Ht(this.activeComponent.graphic)}get defaultCreateOptions(){return this._get("defaultCreateOptions")}set defaultCreateOptions(e){this._set("defaultCreateOptions",K(K({},cne),e))}get defaultUpdateOptions(){return this._get("defaultUpdateOptions")}set defaultUpdateOptions(e){this._set("defaultUpdateOptions",Ce(K(K({},m4),e),{reshapeOptions:K(K({},m4.reshapeOptions),e==null?void 0:e.reshapeOptions)}))}set snappingOptions(e){H(this._snappingManager)&&(this._snappingManager.options=e),this._set("snappingOptions",e)}get state(){var i;const e=!(!((i=this.view)==null?void 0:i.ready)||!this.layer),t=this._operationHandle;return e&&t?"active":e?"ready":"disabled"}get view(){return this._get("view")}set view(e){const t=this._get("view");if(t){const{container:r,map:n}=t;r&&(t.cursor=null),n&&n.remove(this._internalGraphicsLayer),this._viewHandles.removeAll(),this.cancel()}const i="view-ready";this._handles.remove(i),e&&this._handles.add(os(()=>e.ready,r=>{this._viewHandles.removeAll(),r&&this._viewHandles.add(this._generateViewHandles(e))},Gs),i),this._set("view",e)}cancel(){this._moduleLoaderAbortController=Kl(this._moduleLoaderAbortController),this._viewReadyAbortController=Kl(this._viewReadyAbortController),this._operationHandle&&this._operationHandle.cancel()}complete(){this._operationHandle&&this._operationHandle.complete()}delete(){const{state:e,updateGraphics:t}=this;if(e==="active"&&t.length){const{activeTool:i,layer:r}=this,n=t.toArray();r.removeMany(n),this.cancel(),this._emitDeleteEvent({graphics:n,tool:i})}}async create(e,t){if(this.cancel(),await this._waitViewReady(),this.state==="disabled")throw this.layer||this._logError("sketch:missing-property","Property 'layer' is missing on SketchViewModel."),this.view||this._logError("sketch:missing-property","Property 'view' is missing on SketchViewModel."),Qi();if(H(this.view.activeTool)&&(this.view.activeTool=null),!e)return void this._logError("sketch:missing-parameter","Missing parameter 'tool'.");Kie(this.view,this._internalGraphicsLayer);const i=await this._setupCreateOperation(e,t);if(ce(i)||this.destroyed)return void this.view.map.remove(this._internalGraphicsLayer);const r=()=>{if(i===this._operationHandle){const n=this.createGraphic,o=this._operationHandle.cancelled;this._operationHandle.destroy(),this._operationHandle=null,this._set("createGraphic",null),this.view&&this.view.map&&this.view.map.remove(this._internalGraphicsLayer),i.cancelled||n==null||this.layer.add(n),this.emit("create",{graphic:n,state:o?"cancel":"complete",tool:e,toolEventInfo:null,type:"create"})}};i.on("complete",r),this._operationHandle=i,this.view.ready&&this.view.focus()}async update(e,t){this.cancel(),await this._waitViewReady();const{layer:i,view:r,state:n}=this;if(n==="disabled")throw r||this._logError("sketch:missing-property","Property 'view' is missing on SketchViewModel."),i||this._logError("sketch:missing-property","Property 'layer' is missing on SketchViewModel."),Qi();H(this.view.activeTool)&&(this.view.activeTool=null);const o=Array.isArray(e)?e:[e];if(e==null||!o||!o.length)return void this._logError("sketch:missing-parameter","Missing parameter 'graphics'.");if(o.some(h=>h.layer!==i?(this._logError("sketch:invalid-parameter","Parameter 'graphics' contains one or more graphics missing from the supplied GraphicsLayer."),!0):!!ce(h.geometry)&&(this._logError("sketch:invalid-parameter","Parameter 'graphics' contains one or more graphics with an unsupported geometry."),!0)))return;const c=await this._setupUpdateOperation(o,t);this.destroyed||ce(c)||Un(c)||(Kie(this.view,this._internalGraphicsLayer),this._setUpdateOperationHandle(c,t),this.emit("update",{graphics:o,state:"start",aborted:!1,tool:c.tool,toolEventInfo:null,type:"update"}))}async _updateSpatialReference(e){this._beginAsyncOperation(),e=Array.isArray(e)?e:[e];for(const t of e)H(t.geometry)&&t.geometry.type!=="mesh"&&!hr(t.geometry.spatialReference,this.view.spatialReference)&&(pc(t.geometry.spatialReference,this.view.spatialReference)||vu()||await bu(),t.geometry=Da(t.geometry,this.view.spatialReference));this._endAsyncOperation()}undo(){this.canUndo()&&this._operationHandle.undo()}redo(){this.canRedo()&&this._operationHandle.redo()}canUndo(){return!(!this._operationHandle||!this._operationHandle.canUndo())}canRedo(){return!(!this._operationHandle||!this._operationHandle.canRedo())}toggleUpdateTool(){this._operationHandle&&this._operationHandle.toggleTool&&this._operationHandle.toggleTool()}async _getFirstHit(e){const t=this.view;if(t.type==="2d"){const n=[];this.view.map.allLayers.forEach(c=>{c.type!=="vector-tile"&&c.type!=="imagery"||n.push(c)});const o=await this.view.hitTest(e,{exclude:n});return JFe(o.results)}const i=[this.view.map.ground];t.map.allLayers.forEach(n=>{n.type==="integrated-mesh"&&i.push(n)});const r=await t.hitTest(e,{exclude:i});if(r.results.length>0){const n=r.results[0];if(H(n)&&n.type==="graphic"&&n.graphic&&(!r.ground.mapPoint||t.map.ground.opacity<1||r.ground.distance-ws(n.distance,0)>-Math.min(3*r.ground.distance,t.viewingMode==="global"?Ik(t.renderCoordsHelper.spatialReference).radius/t.renderCoordsHelper.unitInMeters:Number.POSITIVE_INFINITY)))return n}return null}_generateViewHandles(e){return[e.on("immediate-click",async t=>{const i=this.state==="active"&&this._operationHandle.type==="create";if(this.state==="disabled"||i||!this.updateOnGraphicClick)return;this._beginAsyncOperation();const r=await t.async(()=>this._getFirstHit(pr(t)));let n=null;if(H(r)){const o=r.graphic;this.updateGraphics.includes(o)||o.layer===this.layer?(t.stopPropagation(),n=o):e.type!=="2d"||this._isComponentGraphic(o)||this.state!=="active"||this.cancel()}else this.state==="active"&&this.cancel();H(n)&&!this.updateGraphics.includes(n)&&await this.update([n],Ce(K({},this.defaultUpdateOptions),{reshapeOptions:K({},this.defaultUpdateOptions.reshapeOptions)})),this._endAsyncOperation()},ft.WIDGET)]}async _setupCreateOperation(e,t){const i=K(K({hasZ:this.view.type==="3d"},this.defaultCreateOptions),t),r=await this._setupDrawGraphicTool(e,this.view,i);return ce(r)?null:(this.view.tools.add(r),this.view.activeTool=r,this._setupCreateOperationHandle(r))}async _setupDrawGraphicTool(e,t,i){if(e==="multipoint"&&t.type==="3d")return this._logError("sketch:create","Multipoint geometries are not supported in SceneView."),null;const r=e!=="rectangle",n=e!=="rectangle";this.snappingOptions.enabledToggled=!1;const o=Ce(K({view:t,mode:e==="rectangle"||e==="circle"?"hybrid":"click"},i),{snapToScene:!1,geometryType:e,graphicSymbol:this._getGraphicSymbolFromTool(e),snappingManager:this._snappingManager,forceUniformSize:n,centered:r});return this.view.type==="2d"?this._makeDrawGraphicTool2D(o):this._makeDrawGraphicTool3D(o)}async _makeDrawGraphicTool2D(e){const t=await this._requireModule(import("./editingTools.121b7f82.js"));return Un(t)||this.destroyed?null:new t.module.DrawGraphicTool2D(Ce(K({},e),{activeVertexSymbol:this.activeVertexSymbol,regularVerticesSymbol:this.vertexSymbol,activeLineSymbol:this.activeLineSymbol,activeFillSymbol:ZFe(e.geometryType)?this.activeFillSymbol:null,tooltipOptions:this.tooltipOptions}))}async _makeDrawGraphicTool3D(e){const t=await this._requireModule(import("./editingTools.060270b4.js").then(function(r){return r.e}));if(Un(t)||this.destroyed)return null;const{elevationInfo:i}=this.layer;return new t.module.DrawGraphicTool3D(Ce(K({},e),{elevationInfo:i,snapToScene:!H(i)||i.mode==="absolute-height",labelOptions:this.labelOptions,tooltipOptions:this.tooltipOptions}))}_setupCreateOperationHandle(e){let t=null;const i=e.forceUniformSize,r=e.centered,n=[this.view.on("key-down",c=>{if(c.key===zt.pan)c.stopPropagation(),c.repeat||(e.enabled=!1);else if(c.key===zt.complete)c.stopPropagation(),e.completeCreateOperation();else if(c.key!==zt.vertexAdd||c.repeat)c.key===zt.undo?(c.stopPropagation(),o.undo()):c.key===zt.redo?(c.stopPropagation(),o.redo()):c.key!==zt.snappingToggle||e.geometryType==="rectangle"||e.geometryType==="circle"||c.repeat?c.key!==zt.constraint||e.geometryType!=="rectangle"&&e.geometryType!=="circle"||c.repeat?c.key===zt.center&&(c.repeat||(e.centered=!r,c.stopPropagation())):(e.forceUniformSize=!i,c.stopPropagation()):(this.snappingOptions.enabledToggled=!0,c.stopPropagation());else{const h=e.drawOperation.geometryType;h!=="polyline"&&h!=="polygon"&&h!=="multipoint"||(c.stopPropagation(),e.drawOperation.commitStagedVertex())}},ft.WIDGET),this.view.on("key-up",c=>{c.key===zt.pan?e.enabled=!0:c.key===zt.snappingToggle&&e.geometryType!=="rectangle"&&e.geometryType!=="circle"?(this.snappingOptions.enabledToggled=!1,c.stopPropagation()):c.key!==zt.constraint||e.geometryType!=="rectangle"&&e.geometryType!=="circle"?c.key===zt.center&&(e.centered=r,c.stopPropagation()):(e.forceUniformSize=i,c.stopPropagation())},ft.WIDGET),e.on("vertex-add",c=>{switch(t=ce(t)?"start":"active",c.operation){case"apply":this.emit("create",{graphic:Ht(e.graphic),state:t,tool:this.activeTool,toolEventInfo:c,type:"create"});break;case"undo":this._emitUndoEvent({graphics:[Ht(e.graphic)],tool:e.geometryType});break;case"redo":this._emitRedoEvent({graphics:[Ht(e.graphic)],tool:e.geometryType})}}),e.on("cursor-update",c=>{e.drawOperation.numCommittedVertices>0&&this.emit("create",{graphic:Ht(e.graphic),state:"active",tool:this.activeTool,toolEventInfo:{coordinates:c.vertices[0].coordinates,type:"cursor-update"},type:"create"})}),e.on("vertex-remove",c=>{switch(c.operation){case"apply":this.emit("create",{graphic:Ht(e.graphic),state:"active",tool:this.activeTool,toolEventInfo:c,type:"create"});break;case"undo":this._emitUndoEvent({graphics:[Ht(e.graphic)],tool:e.geometryType});break;case"redo":this._emitRedoEvent({graphics:[Ht(e.graphic)],tool:e.geometryType})}}),e.on("complete",c=>{this._set("createGraphic",Ht(c.graphic)),t="complete",c.aborted?o&&o.cancel():o&&o.complete()}),we(()=>this._getGraphicSymbolFromTool(e.geometryType),c=>{e.graphicSymbol=c})],o=new y4({activeComponent:e,tool:e.geometryType,type:"create",onEnd:()=>{var c;n.forEach(h=>h.remove()),n.length=0,(c=this.view.tools)==null||c.remove(e)},undo:()=>{e.canUndo&&e.undo()},redo:()=>{e.canRedo&&e.redo()},canUndo:()=>e.canUndo,canRedo:()=>e.canRedo});return o}_getGraphicSymbolFromTool(e){switch(e){case"point":case"multipoint":return this.pointSymbol;case"polyline":return this.polylineSymbol;case"circle":case"rectangle":case"polygon":return this.polygonSymbol;default:return null}}async _setupUpdateOperation(e,t){const{layer:i,view:r}=this,n=Ce(K(K({tool:this._defaultUpdateTool},this.defaultUpdateOptions),t),{reshapeOptions:K(K({},this.defaultUpdateOptions.reshapeOptions),t==null?void 0:t.reshapeOptions)});let o=n.tool;for(const c of e)i.remove(c),i.add(c);if(r.type==="3d"){if(e.length===0)return null;switch(o){case"move":return this._setupMove3DOperation(e,n,r,o);case"reshape":{if(e.length>1)return this._logError("sketch:reshape-multiple","Reshape operation does not support multiple graphics."),null;const c=r4(e[0]);return c===Yi.SUPPORTED?this._setupReshape3DOperation(e[0],n,r):(this._logError("sketch:reshape",`Reshape operation not supported for provided graphic(s) (${gO(c)}).`),null)}case"transform":return this._setupGraphicTransform3DOperation(e,n,r)}}switch(o){case"move":return this._setupMove2DOperation(e,n,r);case"reshape":{if(e.length>1)return this._logError("sketch:reshape-multiple","Reshape operation does not support multiple graphics."),null;const c=r4(e[0]);return c===Yi.SUPPORTED?this._setupTransformOrReshape2DOperation(e,o,n,r):(this._logError("sketch:reshape",`Reshape operation not supported for provided graphic(s) (${gO(c)}).`),null)}case"transform":if(e.length===1){const c=Yb(e[0].geometry,"type");c!=="point"&&c!=="multipoint"||(o="reshape")}return this._setupTransformOrReshape2DOperation(e,o,n,r)}}async _setupMove3DOperation(e,t,i,r,n=!1){for(const b of e){const x=GOe(b);if(x!==Yi.SUPPORTED)return this._logError("sketch:move",`Move operation not supported for provided graphic(s) (${gO(x)}).`),null}const o=await this._requireModule(import("./editingTools.060270b4.js").then(function(b){return b.e}));if(Un(o))return o;const c=new o.module.GraphicMoveTool({view:i,enableZ:t.enableZ,snappingManager:this._snappingManager,tooltipOptions:this.tooltipOptions});this.view.tools.add(c),c.graphics.addMany(e),n||this.updateGraphics.addMany(e);const h=[],m=new Ep({activeComponent:c,tool:r,type:"update",onEnd:()=>{var b;h.forEach(x=>x.remove()),h.length=0,(b=this.view.tools)==null||b.remove(c),c.destroyed||c.destroy()},undo:()=>{g4(m,this.updateGraphics.toArray()),this._emitUndoEvent({graphics:this.updateGraphics.toArray(),tool:r})},redo:()=>{v4(m,this.updateGraphics.toArray()),this._emitRedoEvent({graphics:this.updateGraphics.toArray(),tool:r})},addToSelection:b=>{this.updateGraphics.push(b),c.graphics.push(b),this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[b],removed:[],type:"selection-change"},type:"update"})},removeFromSelection:b=>{const x=this.updateGraphics.indexOf(b);m.history.undo.forEach(I=>I.updates.splice(x,1)),m.history.redo.forEach(I=>I.updates.splice(x,1)),this.updateGraphics.remove(b),this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[],removed:[b],type:"selection-change"},type:"update"}),this.updateGraphics.length!==0?c.graphics.remove(b):m.complete()},toggleTool:async()=>{if(this.updateGraphics.length!==1||t.toggleToolOnClick===!1||r!=="transform")return;const b=this.updateGraphics.getItemAt(0);if(r4(b)!==Yi.SUPPORTED)return;const x=await this._setupReshape3DOperation(b,t,i,!0);Un(x)||(m.onEnd(),m.destroy(),this._setUpdateOperationHandle(x,t))}});return h.push(...this._getHandlesForComponent(m,t),this.view.on("immediate-click",b=>this._getCommonUpdateOperationClickHandlers(m,b,t),ft.WIDGET),i.on("key-down",b=>{this._getCommonUpdateOperationKeyDownHandlers(m,b),b.key===zt.snappingToggle&&(this.snappingOptions.enabledToggled=!0,b.stopPropagation())},ft.WIDGET),i.on("key-up",b=>{b.key===zt.snappingToggle&&(this.snappingOptions.enabledToggled=!1,b.stopPropagation())},ft.WIDGET)),m}_setupGraphicTransform3DOperation(e,t,i,r=!1){if(e.length===1&&JOe(e[0])===Yi.SUPPORTED){const n=e[0],o=n.geometry;if(H(o)&&(o.type==="point"||o.type==="mesh"))return this._setupPointTransform3DOperation(n,t,i);if(H(o)&&(o.type==="polygon"||o.type==="polyline"))return this._setupPolyTransform3DOperation(n,t,i,r)}return this._setupMove3DOperation(e,t,i,"transform",r)}async _setupPointTransform3DOperation(e,t,i){const r="transform",{enableRotation:n,enableScaling:o,enableZ:c}=t,h=await this._requireModule(import("./editingTools.060270b4.js").then(function(I){return I.e}));if(Un(h))return h;const m=new h.module.GraphicTransformTool({graphic:e,view:i,enableRotation:n,enableScaling:o,enableZ:c,snappingManager:this._snappingManager,tooltipOptions:this.tooltipOptions});this.view.tools.add(m),this.updateGraphics.add(e);const b=[],x=new Ep({activeComponent:m,tool:r,type:"update",onEnd:()=>{var I;b.forEach(E=>E.remove()),b.length=0,(I=this.view.tools)==null||I.remove(m),m.destroyed||m.destroy()},undo:()=>{g4(x,this.updateGraphics.toArray()),this._emitUndoEvent({graphics:this.updateGraphics.toArray(),tool:r})},redo:()=>{v4(x,this.updateGraphics.toArray()),this._emitRedoEvent({graphics:this.updateGraphics.toArray(),tool:r})},addToSelection:async I=>{this.updateGraphics.add(I),this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[I],removed:[],type:"selection-change"},type:"update"});const E=await this._setupMove3DOperation(this.updateGraphics.toArray(),t,i,"transform",!0);Un(E)||(x.onEnd(),x.destroy(),this._setUpdateOperationHandle(E,t))},removeFromSelection:I=>{this.updateGraphics.remove(I),this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[],removed:[I],type:"selection-change"},type:"update"}),x.complete()},toggleTool:()=>{}});return b.push(...this._getHandlesForComponent(x,t),this.view.on("immediate-click",I=>this._getCommonUpdateOperationClickHandlers(x,I,t),ft.WIDGET),i.on("key-down",I=>{this._getCommonUpdateOperationKeyDownHandlers(x,I),I.key===zt.snappingToggle&&(this.snappingOptions.enabledToggled=!0,I.stopPropagation())},ft.WIDGET),i.on("key-up",I=>{I.key===zt.snappingToggle&&(this.snappingOptions.enabledToggled=!1,I.stopPropagation())},ft.WIDGET)),x}async _setupPolyTransform3DOperation(e,t,i,r=!1){const n="transform",{enableRotation:o,enableScaling:c,enableZ:h,preserveAspectRatio:m}=t,b=await this._requireModule(import("./editingTools.060270b4.js").then(function(k){return k.e}));if(Un(b))return b;const x=new b.module.ExtentTransformTool({graphic:e,view:i,enableRotation:o,enableScaling:c,enableZ:h,preserveAspectRatio:m,tooltipOptions:this.tooltipOptions});this.view.tools.add(x),r||this.updateGraphics.add(e);const I=[],E=new Ep({activeComponent:x,tool:n,type:"update",onEnd:()=>{var k;I.forEach(P=>P.remove()),I.length=0,(k=this.view.tools)==null||k.remove(x),x.destroyed||x.destroy()},canUndo:()=>x.canUndo,undo:()=>{x.undo(),this._emitUndoEvent({graphics:this.updateGraphics.toArray(),tool:n})},canRedo:()=>x.canRedo,redo:()=>{x.redo(),this._emitRedoEvent({graphics:this.updateGraphics.toArray(),tool:n})},addToSelection:async k=>{this.updateGraphics.add(k),this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[k],removed:[],type:"selection-change"},type:"update"});const P=await this._setupMove3DOperation(this.updateGraphics.toArray(),t,i,"transform",!0);Un(P)||(E.onEnd(),E.destroy(),this._setUpdateOperationHandle(P,t))},removeFromSelection:k=>{this.updateGraphics.remove(k),this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[],removed:[k],type:"selection-change"},type:"update"}),E.complete()},toggleTool:async()=>{if(this.updateGraphics.length!==1||t.toggleToolOnClick===!1)return;const k=this.updateGraphics.getItemAt(0);if(r4(k)!==Yi.SUPPORTED)return;const P=await this._setupReshape3DOperation(k,t,i,!0);Un(P)||(E.onEnd(),E.destroy(),this._setUpdateOperationHandle(P,t))}});return I.push(...this._getHandlesForComponent(E,t),this.view.on("immediate-click",k=>this._getCommonUpdateOperationClickHandlers(E,k,t),ft.WIDGET),this.view.on("key-down",k=>this._getCommonUpdateOperationKeyDownHandlers(E,k),ft.WIDGET),this.view.on("key-down",k=>{k.key!==zt.constraint||k.repeat||(x.preserveAspectRatio=!x.preserveAspectRatio,k.stopPropagation())},ft.WIDGET),this.view.on("key-up",k=>{k.key===zt.constraint&&(x.preserveAspectRatio=!x.preserveAspectRatio,k.stopPropagation())},ft.WIDGET)),E}async _setupMove2DOperation(e,t,i){const r="move";this.updateGraphics.addMany(e),await this._updateSpatialReference(e);const n=await this._getGraphicMover(e,t,i);if(Un(n))return n;const o=new Ep({activeComponent:n,tool:r,type:"update",onEnd:()=>{var b;this._displayDefaultCursor(),m.forEach(x=>x.remove()),h.forEach(x=>x.remove()),m=[],h=[],n.destroy(),(b=this._internalGraphicsLayer)==null||b.removeMany([...this.updateGraphics.toArray()])},undo:()=>{const b=this.updateGraphics.toArray();g4(o,b),o.refreshComponent(),this._emitUndoEvent({graphics:b,tool:r})},redo:()=>{const b=this.updateGraphics.toArray();v4(o,b),o.refreshComponent(),this._emitRedoEvent({graphics:b,tool:r})},addToSelection:async b=>{await this._updateSpatialReference(b),this.updateGraphics.push(b),n.graphics=this.updateGraphics.toArray(),this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[b],removed:[],type:"selection-change"},type:"update"})},removeFromSelection:b=>{const x=this.updateGraphics.indexOf(b);o.history.undo.forEach(E=>E.updates.splice(x,1)),o.history.redo.forEach(E=>E.updates.splice(x,1)),this.updateGraphics.remove(b);const I=this.updateGraphics.toArray();this.emit("update",{graphics:I,state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[],removed:[b],type:"selection-change"},type:"update"}),this.updateGraphics.length!==0?n.graphics=I:o.complete()}});let c=!1,h=[i.on("immediate-click",b=>this._getCommonUpdateOperationClickHandlers(o,b,t),ft.WIDGET),i.on("key-down",b=>{this._getCommonUpdateOperationKeyDownHandlers(o,b),b.key!==zt.constraint||b.repeat||(c=!0,n.enableMoveAllGraphics=!n.enableMoveAllGraphics)},ft.WIDGET),i.on("key-up",b=>{b.key===zt.constraint&&c&&(c=!1,n.enableMoveAllGraphics=!n.enableMoveAllGraphics)},ft.WIDGET)],m=this._getHandlesForComponent(o,t);return o}async _setupReshape3DOperation(e,t,i,r=!1){const n="reshape",o=await this._requireModule(import("./editingTools.060270b4.js").then(function(b){return b.e}));if(Un(o))return o;this.snappingOptions.enabledToggled=!1;const c=new o.module.GraphicReshapeTool({view:i,graphic:e,enableZVertex:t.enableZ&&t.reshapeOptions.vertexOperation==="move",enableZShape:t.enableZ&&t.reshapeOptions.shapeOperation==="move",enableMoveGraphic:t.reshapeOptions.shapeOperation==="move"||t.reshapeOptions.shapeOperation==="move-xy",enableMidpoints:t.reshapeOptions.edgeOperation==="split",enableEdgeOffset:t.reshapeOptions.edgeOperation==="offset",snappingManager:this._snappingManager,labelOptions:this.labelOptions,tooltipOptions:this.tooltipOptions});i.tools.add(c),r||this.updateGraphics.add(e);const h=[],m=new Ep({activeComponent:c,tool:n,type:"update",onEnd:()=>{var b;h.forEach(x=>x.remove()),h.length=0,(b=this.view.tools)==null||b.remove(c),c.destroyed||c.destroy()},canUndo:()=>c.canUndo,undo:()=>{c.undo(),this._emitUndoEvent({graphics:this.updateGraphics.toArray(),tool:n})},canRedo:()=>c.canRedo,redo:()=>{c.redo(),this._emitRedoEvent({graphics:this.updateGraphics.toArray(),tool:n})},addToSelection:async b=>{this.updateGraphics.add(b),this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[b],removed:[],type:"selection-change"},type:"update"});const x=await this._setupMove3DOperation(this.updateGraphics.toArray(),t,i,"transform",!0);Un(x)||(m.onEnd(),m.destroy(),this._setUpdateOperationHandle(x,t))},removeFromSelection:b=>{this.updateGraphics.remove(b),this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[],removed:[b],type:"selection-change"},type:"update"}),m.complete()},toggleTool:async()=>{if(t.toggleToolOnClick===!1)return;const b=await this._setupGraphicTransform3DOperation(this.updateGraphics.toArray(),t,i,!0);Un(b)||(m.onEnd(),m.destroy(),this._setUpdateOperationHandle(b,t))}});return h.push(...this._getHandlesForComponent(m,t),i.on("immediate-click",b=>this._getCommonUpdateOperationClickHandlers(m,b,t),ft.WIDGET),i.on("key-down",b=>{this._getCommonUpdateOperationKeyDownHandlers(m,b),b.key===zt.snappingToggle&&(this.snappingOptions.enabledToggled=!0,b.stopPropagation())},ft.WIDGET),i.on("key-up",b=>{b.key===zt.snappingToggle&&(this.snappingOptions.enabledToggled=!1,b.stopPropagation())},ft.WIDGET)),m}async _setupTransformOrReshape2DOperation(e,t,i,r){this.updateGraphics.addMany(e),await this._updateSpatialReference(e);const n=t==="transform"?await this._getBox(e,i,r):await this._getReshape(e,i,r);if(Un(n))return n;const o=new Ep({activeComponent:n,type:"update",onEnd:()=>{h.forEach(m=>m.remove()),c.forEach(m=>m.remove()),h=[],c=[],o.activeComponent&&!o.activeComponent.destroyed&&o.activeComponent.destroy(),this._internalGraphicsLayer.removeMany(this.updateGraphics.toArray())},undo:()=>{g4(o,this.updateGraphics.toArray()),o.refreshComponent(),this._emitUndoEvent({graphics:this.updateGraphics.toArray(),tool:o.tool})},redo:()=>{v4(o,this.updateGraphics.toArray()),o.refreshComponent(),this._emitRedoEvent({graphics:this.updateGraphics.toArray(),tool:o.tool})},addToSelection:async m=>{let b=o.activeComponent;if(b.type==="reshape"){const x=[...this.updateGraphics,m];this.updateGraphics.removeAll();const I=await this._setupMove2DOperation(x,i,r);if(Un(I))return;o.onEnd(),o.destroy(),this._setUpdateOperationHandle(I,i)}else this.updateGraphics.add(m),b.graphics=this.updateGraphics.toArray(),b.refresh(),o.resetHistory();this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[m],removed:[],type:"selection-change"},type:"update"})},removeFromSelection:async m=>{const b=this.updateGraphics.indexOf(m);o.history.undo.forEach(I=>I.updates.splice(b,1)),o.history.redo.forEach(I=>I.updates.splice(b,1)),this.updateGraphics.remove(m);const x=this.updateGraphics.toArray();if(x.length===0)o.complete();else{const I=x[0].geometry;x.length!==1||!H(I)||I.type!=="point"&&I.type!=="multipoint"?o.activeComponent.graphics=x:o.toggleTool()}this.emit("update",{graphics:x,state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[],removed:[m],type:"selection-change"},type:"update"})},toggleTool:async()=>{if(this.updateGraphics.length>1)return;const m=this.updateGraphics.getItemAt(0),b=m.geometry;if(H(b)&&(o.tool==="reshape"&&(b.type==="point"||b.type==="multipoint")||o.tool==="transform"&&b.type==="extent"))return;let x=null;o.tool==="transform"?x=await this._getReshape([m],i,r):o.tool==="reshape"&&(x=await this._getBox([m],i,r)),Un(x)||(o.activeComponent.destroy(),o.activeComponent=x,o.activeComponent&&(h.forEach(I=>I.remove()),h=this._getHandlesForComponent(o,i)))}});let c=[r.on("immediate-click",m=>this._getCommonUpdateOperationClickHandlers(o,m,i),ft.WIDGET),r.on("key-down",m=>{if(this._getCommonUpdateOperationKeyDownHandlers(o,m),m.key!==zt.snappingToggle||m.repeat||(this.snappingOptions.enabledToggled=!0,m.stopPropagation()),m.key===zt.constraint&&!m.repeat&&o){const b=o.activeComponent;b&&b.type==="box"&&(b.preserveAspectRatio=!b.preserveAspectRatio)}},ft.WIDGET),r.on("key-up",m=>{var b;if(m.key===zt.snappingToggle&&((b=o==null?void 0:o.activeComponent)==null?void 0:b.type)==="reshape"&&(this.snappingOptions.enabledToggled=!1,m.stopPropagation()),m.key===zt.constraint&&o){const x=o.activeComponent;x&&x.type==="box"&&(x.preserveAspectRatio=!x.preserveAspectRatio)}},ft.WIDGET)],h=this._getHandlesForComponent(o,i);return o}async _getGraphicMover(e,t,i){const{enableMoveAllGraphics:r}=t,n=await this._requireModule(import("./GraphicMover.4ba29629.js").then(function(o){return o.G}));return Un(n)?n:new n.module.default({enableMoveAllGraphics:r,highlightsEnabled:!0,indicatorsEnabled:!1,graphics:e,view:i,callbacks:{onGraphicMoveStart:({dx:o,dy:c,graphic:h})=>{this._displayGrabbingCursor(),this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:o,dy:c,mover:h,type:"move-start"},type:"update"})},onGraphicMove:({dx:o,dy:c,graphic:h})=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:o,dy:c,mover:h,type:"move"},type:"update"}),onGraphicMoveStop:({dx:o,dy:c,graphic:h})=>{this._displayPointerCursor(),this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:o,dy:c,mover:h,type:"move-stop"},type:"update"})},onGraphicPointerOver:()=>this._displayPointerCursor(),onGraphicPointerOut:()=>this._displayDefaultCursor()}})}async _getBox(e,t,i){const{enableRotation:r,enableScaling:n,preserveAspectRatio:o}=t,c=await this._requireModule(import("./Box.6fc7ce34.js"));return Un(c)?c:new c.module.default({graphics:e,enableRotation:r,enableScaling:n,preserveAspectRatio:o,layer:this._internalGraphicsLayer,view:i,tooltipOptions:this.tooltipOptions,callbacks:{onMoveStart:h=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:K({},h),type:"update"}),onMove:h=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:K({},h),type:"update"}),onMoveStop:h=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:K({},h),type:"update"}),onScaleStart:h=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:K({},h),type:"update"}),onScale:h=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:K({},h),type:"update"}),onScaleStop:h=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:K({},h),type:"update"}),onRotateStart:h=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:K({},h),type:"update"}),onRotate:h=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:K({},h),type:"update"}),onRotateStop:h=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:K({},h),type:"update"})}})}async _getReshape(e,t,i){var c,h;const r=((c=t.reshapeOptions)==null?void 0:c.edgeOperation)==="split",n=((h=t.reshapeOptions)==null?void 0:h.shapeOperation)==="move",o=await this._requireModule(import("./Reshape.a1762128.js"));return Un(o)?o:new o.module.default({enableMidpoints:r,enableMovement:n,graphic:e[0],layer:this._internalGraphicsLayer,snappingManager:this._snappingManager,tooltipOptions:this.tooltipOptions,view:i,callbacks:{onReshapeStart:m=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:K({},m),type:"update"}),onReshape:m=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:K({},m),type:"update"}),onReshapeStop:({mover:m,type:b})=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:m,type:b},type:"update"}),onMoveStart:({dx:m,dy:b,mover:x,type:I})=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:m,dy:b,mover:x,type:I},type:"update"}),onMove:({dx:m,dy:b,mover:x,type:I})=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:m,dy:b,mover:x,type:I},type:"update"}),onMoveStop:({dx:m,dy:b,mover:x,type:I})=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:m,dy:b,mover:x,type:I},type:"update"}),onVertexAdd:({added:m,type:b,vertices:x})=>{const I=m.map(E=>ug(E.geometry));this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:I,vertices:x,type:b},type:"update"})},onVertexRemove:({removed:m,type:b,vertices:x})=>{const I=m.map(E=>ug(E.geometry));this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{removed:I,vertices:x,type:b},type:"update"})}}})}_getHandlesForComponent(e,t){const i=e.activeComponent;switch(i.type){case"graphic-mover":return[i.on("graphic-click",({graphic:r,viewEvent:n})=>{var o;((o=n.native)==null?void 0:o.shiftKey)&&(n.stopPropagation(),e.removeFromSelection(r))}),i.on("graphic-move-start",r=>e.addToHistory(Tp(r.allGraphics)))];case"box":return[i.on("graphic-click",r=>this._onTransformOrReshape2DGraphicClick(e,t,r)),i.on("move-start",r=>e.addToHistory(Tp(r.graphics))),i.on("rotate-start",r=>e.addToHistory(Tp(r.graphics))),i.on("scale-start",r=>e.addToHistory(Tp(r.graphics)))];case"reshape":return[i.on("graphic-click",r=>this._onTransformOrReshape2DGraphicClick(e,t,r)),i.on("move-start",r=>e.addToHistory(Tp([r.mover]))),i.on("reshape-start",r=>e.addToHistory(Tp([r.graphic]))),i.on("vertex-add",r=>e.addToHistory(Tp([r.oldGraphic]))),i.on("vertex-remove",r=>e.addToHistory(Tp([r.oldGraphic])))];case"move-3d":return[i.on("graphic-move-start",r=>{e.addToHistory(Tp(r.allGraphics)),this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:0,dy:0,mover:r.allGraphics.length>0?r.allGraphics[0]:null,type:"move-start"},type:"update"})}),i.on("graphic-move",r=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:r.dx,dy:r.dy,mover:r.allGraphics.length>0?r.allGraphics[0]:null,type:"move"},type:"update"})}),i.on("graphic-move-stop",r=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:0,dy:0,mover:r.allGraphics.length>0?r.allGraphics[0]:null,type:"move-stop"},type:"update"})}),i.on("immediate-click",r=>{r.shiftKey?this._toggleSelection([r.graphic],e,t):e.toggleTool()})];case"transform-3d":return[i.on("record-undo",({record:r})=>{e.addToHistory({updates:[r]})}),i.on("graphic-translate-start",r=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:r.graphic,dx:r.dxScreen,dy:r.dyScreen,type:"move-start"},type:"update"})}),i.on("graphic-translate-stop",r=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:r.graphic,dx:r.dxScreen,dy:r.dyScreen,type:"move-stop"},type:"update"})}),i.on("graphic-rotate-start",r=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:r.graphic,angle:r.angle,type:"rotate-start"},type:"update"})}),i.on("graphic-rotate-stop",r=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:r.graphic,angle:r.angle,type:"rotate-stop"},type:"update"})}),i.on("graphic-scale-start",r=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:r.graphic,xScale:r.xScale,yScale:r.yScale,type:"scale-start"},type:"update"})}),i.on("graphic-scale-stop",r=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:r.graphic,xScale:r.xScale,yScale:r.yScale,type:"scale-stop"},type:"update"})}),i.on("graphic-translate",r=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:r.graphic,dx:r.dxScreen,dy:r.dyScreen,type:"move"},type:"update"})}),i.on("graphic-rotate",r=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:r.graphic,angle:r.angle,type:"rotate"},type:"update"})}),i.on("graphic-scale",r=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:r.graphic,xScale:r.xScale,yScale:r.yScale,type:"scale"},type:"update"})}),i.on("immediate-click",r=>{r.shiftKey?this._toggleSelection([r.graphic],e,t):e.toggleTool()})];case"reshape-3d":return[i.on("reshape",r=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:r,type:"update"})}),i.on("move",r=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:r,type:"update"})}),i.on("vertex-add",r=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:r,type:"update"})}),i.on("vertex-remove",r=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:r,type:"update"})}),i.on("immediate-click",r=>{r.shiftKey?this._toggleSelection([r.graphic],e,t):e.toggleTool()})];default:return}}_onTransformOrReshape2DGraphicClick(e,t,i){var o;const{graphic:r,viewEvent:n}=i;return((o=n.native)==null?void 0:o.shiftKey)&&r.layer===this.layer?(n.stopPropagation(),e.removeFromSelection(r)):t.toggleToolOnClick?(n.stopPropagation(),e.toggleTool()):void 0}_setUpdateOperationHandle(e,t){this._operationHandle=e;const i=this.view.map;this._disablePopup(t);const r=()=>{if(e===this._operationHandle){const n=this.updateGraphics.toArray(),o=this._operationHandle.tool;this._operationHandle.destroy(),this._operationHandle=null,this._internalGraphicsLayer.removeMany(this.updateGraphics.toArray()),this.updateGraphics.removeAll(),i&&i.remove(this._internalGraphicsLayer),this._restorePopup(t),this.emit("update",{graphics:n,state:"complete",aborted:e.cancelled,tool:o,toolEventInfo:null,type:"update"})}};e.on("complete",r)}async _getCommonUpdateOperationClickHandlers(e,t,i){const r=pr(t),n=await t.async(()=>this._getFirstHit(r));if(ce(n))return void e.complete();if(t.native.shiftKey&&this._toggleSelection([n.graphic],e,i))return void t.stopPropagation();this.updateGraphics.includes(n.graphic)?t.stopPropagation():e.complete()}_toggleSelection(e,t,i){const r=!!i.multipleSelectionEnabled;return e.some(n=>n!=null&&!(!r||n.layer!==this.layer)&&(this.updateGraphics.includes(n)?t.removeFromSelection(n):t.addToSelection(n),!0))}_getCommonUpdateOperationKeyDownHandlers(e,t){if(!e)return;const i=t.key;i===zt.undo&&e.canUndo()?(t.stopPropagation(),e.undo()):i===zt.redo&&e.canRedo()?(t.stopPropagation(),e.redo()):i===zt.cancel?(t.stopPropagation(),e.cancel()):this.allowDeleteKey&&zt.delete.includes(i)&&this._onDeleteKey(t)}_onDeleteKey(e){if(!this._operationHandle||this._operationHandle.type!=="update")return;const t=this.activeComponent,i=this.updateGraphics.toArray();ce(t)||t.type==="reshape-3d"||(t.type!=="reshape"||i.length===1&&Yb(i[0].geometry,"type")==="point")&&(e.stopPropagation(),this.delete())}_removeDefaultLayer(){this._internalGraphicsLayer&&(this.view&&this.view.map&&this.view.map.remove(this._internalGraphicsLayer),this._internalGraphicsLayer=li(this._internalGraphicsLayer))}_isComponentGraphic(e){const{activeComponent:t}=this;return!(!e||ce(t))&&(e.attributes&&e.attributes.esriSketchTool||t.type==="draw-2d"&&t.graphic===e||(t.type==="box"||t.type==="reshape")&&t.isUIGraphic(e))}_displayPointerCursor(){this.view&&this.view.container&&this.view.cursor!=="pointer"&&(this.view.cursor="pointer")}_displayGrabbingCursor(){this.view&&this.view.container&&this.view.cursor!=="grabbing"&&(this.view.cursor="grabbing")}_displayDefaultCursor(){this.view&&this.view.container&&this.view.cursor!==null&&(this.view.cursor=null)}_logError(e,t,i){$e.getLogger(this.declaredClass).error(new ue(e,t,i))}async _requireModule(e){const t=new AbortController;this._moduleLoaderAbortController=t;const i=await e;return this._moduleLoaderAbortController!==t||t.signal.aborted?{requireError:"aborted"}:{module:i}}_emitUndoEvent(e){this.emit("undo",Ce(K({},e),{type:"undo"}))}_emitRedoEvent(e){this.emit("redo",Ce(K({},e),{type:"redo"}))}_emitDeleteEvent(e){this.emit("delete",Ce(K({},e),{type:"delete"}))}get test(){return{operationHandle:this._operationHandle,defaultUpdateOptions:m4}}wait(){return Ch(()=>!this.updating)}_beginAsyncOperation(){this._numUpdating+=1,this.notifyChange("updating")}_endAsyncOperation(){this._numUpdating-=1,this.notifyChange("updating")}_disablePopupEnabled(e){var t;return((t=this.view)==null?void 0:t.type)!=="3d"||this.updateOnGraphicClick||H(e)&&e.toggleToolOnClick}_disablePopup(e){if(!this._disablePopupEnabled(e))return;const t=this.view.popup;t&&ce(this._originalAutoOpenEnabled)&&(this._originalAutoOpenEnabled=t.autoOpenEnabled,t.autoOpenEnabled=!1)}_restorePopup(e){if(!this._disablePopupEnabled(e))return;const t=this.view.popup;t&&H(this._originalAutoOpenEnabled)&&(t.autoOpenEnabled=this._originalAutoOpenEnabled,this._originalAutoOpenEnabled=null)}async _waitViewReady(){const e=this.view;e&&(Kl(this._viewReadyAbortController),this._viewReadyAbortController=new AbortController,await PV(Ch(()=>e==null?void 0:e.ready),this._viewReadyAbortController.signal))}};function ZFe(e){return e==="polygon"||e==="rectangle"||e==="circle"}function g4(e,t){une("undo",e.history.undo,e.history.redo,t)}function v4(e,t){une("redo",e.history.redo,e.history.undo,t)}function une(e,t,i,r){const n=t.pop().updates,o=[];r.forEach((c,h)=>{const m=n[h];m!=null&&("geometry"in m&&H(m.geometry)&&(o.push({geometry:c.geometry}),c.geometry=m.geometry),"symbol"in m&&H(m.symbol)&&(o.push({symbol:c.symbol}),c.symbol=m.symbol),"undo"in m&&(o.push(m),m[e](c)))}),i.push({updates:o})}function Tp(e){return{updates:e.map(t=>({geometry:t.geometry}))}}function Un(e){return"requireError"in e&&e.requireError==="aborted"}g([w()],cr.prototype,"updating",null),g([w()],cr.prototype,"_operationHandle",void 0),g([w({readOnly:!0})],cr.prototype,"activeTool",null),g([w()],cr.prototype,"activeFillSymbol",void 0),g([w()],cr.prototype,"activeLineSymbol",void 0),g([w()],cr.prototype,"activeVertexSymbol",void 0),g([w()],cr.prototype,"allowDeleteKey",void 0),g([w({readOnly:!0})],cr.prototype,"createGraphic",null),g([w()],cr.prototype,"defaultCreateOptions",null),g([w()],cr.prototype,"defaultUpdateOptions",null),g([w({type:UI,nonNullable:!0})],cr.prototype,"labelOptions",void 0),g([w()],cr.prototype,"layer",void 0),g([w({types:ta})],cr.prototype,"pointSymbol",void 0),g([w({types:ta})],cr.prototype,"polygonSymbol",void 0),g([w({types:ta})],cr.prototype,"polylineSymbol",void 0),g([w({type:UO,nonNullable:!0})],cr.prototype,"snappingOptions",null),g([w()],cr.prototype,"_snappingManager",void 0),g([w({readOnly:!0})],cr.prototype,"state",null),g([w({type:qI,nonNullable:!0})],cr.prototype,"tooltipOptions",void 0),g([w({readOnly:!0})],cr.prototype,"updateGraphics",void 0),g([w()],cr.prototype,"updateOnGraphicClick",void 0),g([w({types:ta})],cr.prototype,"updatePointSymbol",void 0),g([w({types:ta})],cr.prototype,"updatePolygonSymbol",void 0),g([w({types:ta})],cr.prototype,"updatePolylineSymbol",void 0),g([w({types:ta})],cr.prototype,"vertexSymbol",void 0),g([w({value:null})],cr.prototype,"view",null),cr=g([te("esri.widgets.Sketch.SketchViewModel")],cr);const hne=cr;let Ff=class extends Ye{constructor(e){super(e),this._viewpointHandle=null,this._handles=new Ti,this.group=null}initialize(){this._handles.add(vr(()=>{var e;return(e=this.view)==null?void 0:e.ui},"expand",e=>{const{target:t}=e;t&&t!==this&&t.expanded&&t.group&&t.group===this.group&&this._collapse()}))}destroy(){this._viewpointHandle=null,this.view=null,this._handles.destroy(),this._handles=null}set autoCollapse(e){this._set("autoCollapse",e),this._watchViewpoint()}set expanded(e){const t=!!e;this._set("expanded",t);const i=this.get("view.ui");i&&i.emit("expand",{target:this}),this._viewpointHandleChange(t)}get state(){return this.get("view.ready")?"ready":"disabled"}set view(e){this._get("view")!==e&&(this._set("view",e),e&&os(()=>e.ready,()=>{this.view===e&&this._watchViewpoint()},{once:!0,initial:!0}))}_viewpointHandleChange(e){this._viewpointHandle&&(e?os(()=>this.view.stationary,()=>this._viewpointHandle.resume(),{once:!0,initial:!0}):this._viewpointHandle.pause())}_watchViewpoint(){const e="viewpoint";this._handles.remove(e),this._viewpointHandle=null;const{autoCollapse:t,view:i}=this;if(i&&t){const r=C_e(()=>i.type==="3d"?i.camera:i.viewpoint,()=>this._collapse());this._handles.add(r,e),this._viewpointHandle=r}}_collapse(){this.expanded=!1}};g([w({value:!1})],Ff.prototype,"autoCollapse",null),g([w({value:!1})],Ff.prototype,"expanded",null),g([w()],Ff.prototype,"group",void 0),g([w({readOnly:!0})],Ff.prototype,"state",null),g([w({value:null})],Ff.prototype,"view",null),Ff=g([te("esri.widgets.Expand.ExpandViewModel")],Ff);const pne=Ff,qn={base:"esri-expand esri-widget",modeAuto:"esri-expand--auto",modeDrawer:"esri-expand--drawer",modeFloating:"esri-expand--floating",container:"esri-expand__container",containerExpanded:"esri-expand__container--expanded",panel:"esri-expand__panel",button:"esri-widget--button",text:"esri-icon-font-fallback-text",icon:"esri-collapse__icon",iconExpanded:"esri-expand__icon--expanded",iconNumber:"esri-expand__icon-number",iconNumberExpanded:"esri-expand__icon-number--expanded",expandIcon:"esri-icon-expand",collapseIcon:"esri-icon-collapse",content:"esri-expand__content",contentExpanded:"esri-expand__content--expanded",expandMask:"esri-expand__mask",expandMaskExpanded:"esri-expand__mask--expanded"};let Cn=class extends ki{constructor(e,t){super(e,t),this.closeOnEsc=!0,this.collapseTooltip="",this.content="",this.expandTooltip="",this.iconNumber=0,this.messages=null,this.messagesCommon=null,this.mode="auto",this.viewModel=new pne,this._handleKeyDown=i=>{const{closeOnEsc:r,_toggleButtonEl:n,expanded:o}=this;!o||!r||i.target===n||i.key!=="Escape"||(typeof r=="function"?r(i):r)&&(this.expanded=!1,n==null||n.focus())}}get contentId(){return`${this.id}_controls_content`}get expandTitle(){const{expanded:e,messagesCommon:t,collapseTooltip:i,expandTooltip:r}=this;return e?i||t.collapse:r||t.expand}get autoCollapse(){return this.viewModel.autoCollapse}set autoCollapse(e){this.viewModel.autoCollapse=e}get collapseIconClass(){return qn.collapseIcon}set collapseIconClass(e){this._overrideIfSome("collapseIconClass",e)}get expanded(){return this.viewModel.expanded}set expanded(e){this.viewModel.expanded=e}get expandIconClass(){return s1(this.content)?this.content.iconClass:qn.expandIcon}set expandIconClass(e){this._overrideIfSome("expandIconClass",e)}get group(){return this.viewModel.group}set group(e){this.viewModel.group=e}get label(){var e,t;return(t=(e=this.messages)==null?void 0:e.widgetLabel)!=null?t:""}set label(e){this._overrideIfSome("label",e)}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}expand(){this.viewModel.expanded=!0}collapse(){this.viewModel.expanded=!1}toggle(){this.viewModel.expanded=!this.viewModel.expanded}render(){const{mode:e}=this,t={[qn.modeAuto]:e==="auto",[qn.modeDrawer]:e==="drawer",[qn.modeFloating]:e==="floating"};return j("div",{class:this.classes(qn.base,t),onkeydown:this._handleKeyDown},this.renderMask(),this.renderContainer())}renderContainer(){const{expanded:e}=this,t={[qn.containerExpanded]:e};return j("div",{class:this.classes(qn.container,t)},this.renderPanel(),this.renderContent())}renderMask(){const{expanded:e}=this,t={[qn.expandMaskExpanded]:e};return j("div",{bind:this,onclick:this._toggle,class:this.classes(qn.expandMask,t)})}renderBadgeNumber(){const{expanded:e,iconNumber:t}=this;return t&&!e?j("span",{key:"expand__icon-number",class:qn.iconNumber},t):null}renderPanelNumber(){const{iconNumber:e,expanded:t}=this;return e&&t?j("span",{key:"expand__expand-icon-number",class:this.classes(qn.iconNumber,qn.iconNumberExpanded)},e):null}renderIcon(){const{collapseIconClass:e,expandIconClass:t,expanded:i}=this,r={[qn.iconExpanded]:i,[e]:i,[t]:!i};return e===t&&(r[e]=!0),j("span",{"aria-hidden":"true",class:this.classes(qn.icon,r)})}renderTitle(){return j("span",{class:qn.text},this.expandTitle)}renderExpandButton(){const{expanded:e,expandTitle:t,contentId:i}=this;return j("div",{afterCreate:this._storeToggleButtonEl,"aria-controls":i,"aria-expanded":e?"true":"false",bind:this,class:qn.button,onclick:this._toggle,onkeydown:this._toggle,role:"button",tabindex:"0",title:t},this.renderBadgeNumber(),this.renderIcon(),this.renderTitle())}renderPanel(){return j("div",{class:qn.panel},this.renderExpandButton(),this.renderPanelNumber())}renderContent(){const{expanded:e,contentId:t,content:i}=this,r={[qn.contentExpanded]:e},n={id:t,role:"region",class:this.classes(qn.content,r)};return typeof i=="string"?j("div",K({key:"content__string",innerHTML:i},n)):s1(i)?j("div",K({key:"content__widget"},n),i.render()):i instanceof HTMLElement?j("div",K({key:"content__html-element",bind:i,afterCreate:this._attachToNode},n)):TW(i)?j("div",K({key:"content__node",bind:i.domNode,afterCreate:this._attachToNode},n)):null}_toggle(){this.toggle()}_attachToNode(e){const t=this;e.appendChild(t)}_storeToggleButtonEl(e){this._toggleButtonEl=e}};g([w({readOnly:!0})],Cn.prototype,"contentId",null),g([w({readOnly:!0})],Cn.prototype,"expandTitle",null),g([w()],Cn.prototype,"autoCollapse",null),g([w()],Cn.prototype,"closeOnEsc",void 0),g([w()],Cn.prototype,"collapseIconClass",null),g([w()],Cn.prototype,"collapseTooltip",void 0),g([w()],Cn.prototype,"content",void 0),g([w()],Cn.prototype,"expanded",null),g([w()],Cn.prototype,"expandIconClass",null),g([w()],Cn.prototype,"expandTooltip",void 0),g([w()],Cn.prototype,"group",null),g([w()],Cn.prototype,"iconNumber",void 0),g([w()],Cn.prototype,"label",null),g([w(),ci("esri/widgets/Expand/t9n/Expand")],Cn.prototype,"messages",void 0),g([w(),ci("esri/t9n/common")],Cn.prototype,"messagesCommon",void 0),g([w()],Cn.prototype,"mode",void 0),g([w()],Cn.prototype,"view",null),g([w({type:pne})],Cn.prototype,"viewModel",void 0),g([Ki()],Cn.prototype,"_toggle",null),Cn=g([te("esri.widgets.Expand")],Cn);class KFe{constructor(t){this.message=t}toString(){return`AssertException: ${this.message}`}}function dne(e,t){if(!e)throw t=t||"assert",console.log(new Error(t).stack),new KFe(t)}function NYe(e,t){e||(t=t||"",console.warn("Verify failed: "+t+`
`+new Error("verify").stack))}function DYe(e,t,i,r){let n,o=(i[0]-e[0])/t[0],c=(r[0]-e[0])/t[0];o>c&&(n=o,o=c,c=n);let h=(i[1]-e[1])/t[1],m=(r[1]-e[1])/t[1];if(h>m&&(n=h,h=m,m=n),o>m||h>c)return!1;h>o&&(o=h),m<c&&(c=m);let b=(i[2]-e[2])/t[2],x=(r[2]-e[2])/t[2];return b>x&&(n=b,b=x,x=n),!(o>x||b>c)&&(x<c&&(c=x),!(c<0))}function jYe(e,t,i,r,n,o=ui()){const c=(r[n]-i[n])*(t[0]-e[0])-(r[0]-i[0])*(t[n]-e[n]),h=(r[0]-i[0])*(e[n]-i[n])-(r[n]-i[n])*(e[0]-i[0]);if(c===0)return!1;const m=h/c;return o[0]=e[0]+m*(t[0]-e[0]),o[1]=e[n]+m*(t[n]-e[n]),!0}function VYe(e,t){return Math.log(e)/Math.log(t)}function zYe(e,t,i,r){e[12]=t,e[13]=i,e[14]=r}function GYe(e){return e[0]===1&&e[1]===0&&e[2]===0&&e[3]===0&&e[4]===0&&e[5]===1&&e[6]===0&&e[7]===0&&e[8]===0&&e[9]===0&&e[10]===1&&e[11]===0&&e[15]===1}function BYe(e,t,i){return 2*Math.atan(Math.sqrt(t*t+i*i)*Math.tan(.5*e)/t)}function UYe(e,t,i){return 2*Math.atan(Math.sqrt(t*t+i*i)*Math.tan(.5*e)/i)}function qYe(e,t,i){return 2*Math.atan(t*Math.tan(.5*e)/Math.sqrt(t*t+i*i))}function HYe(e,t,i){return 2*Math.atan(i*Math.tan(.5*e)/Math.sqrt(t*t+i*i))}class YFe{constructor(t){this.client=t,this._cancelled=!1,this.size=0,this.duration=0}}class XFe{constructor(t){this.typeWorkerQuota=t,this.tasks=new Array,this.numWorkers=0,this.statistics=new QFe}}class QFe{constructor(){this.requests=0,this.size=0,this.duration=0,this.speed=0}}class eNe{constructor(t,i,r,n){this._workerFunc=t,this._callbackFunc=i,this._maxTotalNumWorkers=r,this._totalNumWorkers=0,this._clients=n.map(o=>new XFe(o))}destroy(){this._clients.length=0}hasQuota(t){const i=this._clients[t];return!!i&&(this._totalNumWorkers<this._maxTotalNumWorkers||i.numWorkers+i.tasks.length<i.typeWorkerQuota)}push(t){const i=this._clients[t.client];i&&(this._totalNumWorkers<this._maxTotalNumWorkers?(i.numWorkers++,this._totalNumWorkers++,this._workerFunc(t,(r,n)=>this._taskCallback(r,n))):i.tasks.push(t))}cancel(t){this._taskFinished(t),t._cancelled=!0}_taskFinished(t){const i=this._clients[t.client];this._totalNumWorkers--,i.numWorkers--,i.statistics.requests++,i.statistics.size+=t.size||0,i.statistics.duration+=t.duration||0,i.statistics.speed=i.statistics.duration>0?i.statistics.size/i.statistics.duration:0,dne(i.numWorkers>=0),this._next()}_next(){for(const t of this._clients)if(t&&t.numWorkers<t.typeWorkerQuota&&this._processQueue(t))return;for(const t of this._clients)if(t&&this._processQueue(t))return}_processQueue(t){for(;t.tasks.length>0;)if(this._workerFunc(t.tasks.shift(),(i,r)=>this._taskCallback(i,r)))return t.numWorkers++,this._totalNumWorkers++,!0;return!1}_taskCallback(t,i){t._cancelled||(this._callbackFunc(t,i),this._taskFinished(t))}getStatsForType(t){const i=this._clients[t];return i?{quota:i.typeWorkerQuota,workers:i.numWorkers,queueSize:i.tasks.length,requestStats:i.statistics}:null}get test(){const t=this;return{set workerFunc(i){t._workerFunc=i}}}}let qO=class extends Ye{constructor(){super(...arguments),this._tasks=new Map,this._onLoadQueue=new Array,this._doneQueue=new Array,this.updating=!1}setup(e,t,i){this._loadQueue=new eNe((r,n)=>this._startLoading(r,n),(r,n)=>this._doneLoadingCB(r,n),e,t),i&&(this._frameTask=i.registerTask(vi.STREAM_DATA_LOADER,this))}destroy(){this._frameTask=mr(this._frameTask),this._tasks.forEach(e=>Kl(e.abortController)),this._loadQueue=li(this._loadQueue),this._onLoadQueue=null,this._doneQueue=null,this._tasks=null}hasDownloadSlots(e){return this._loadQueue.hasQuota(e)}request(e,t,i,r={}){const n=dT();n.__signal=H(r)?r.signal:null;const o=this._createOrUpdateTask(e,t,i,r,n);return Ho(r,()=>this._cancelRequest(o,n)),n.promise}_createTask(e,t,i,r,n,o){const c=new nNe(e,t,i,r,n);return this._updateTask(c,o),this._tasks.set(n,c),this._tasks.size===1&&this._set("updating",!0),this._loadQueue.push(c),c}_cancelRequest(e,t){var i;Ej(e.resolvers,t),t.reject(Qi()),e.resolvers.length===0&&(e.status===Pl.DOWNLOADING&&(e.status=Pl.CANCELLED,this._loadQueue.cancel(e),(i=e.abortController)==null||i.abort(),e.request=null,e.abortController=null),e.status=Pl.CANCELLED,this._tasks.delete(e.key),this._tasks.size===0&&this._set("updating",!1))}_updateTask(e,t){e.resolvers.push(t)}_createOrUpdateTask(e,t,i,r,n){const o=sNe(H(r)&&r.uid||e,t,i),c=this._tasks.get(o);return c?(this._updateTask(c,n),c):this._createTask(e,r,t,i,o,n)}_doneLoadingCB(e,t){this._loadQueue&&(dne(e.status===Pl.DOWNLOADING),e.status=Pl.DOWNLOADED,this._frameTask?this._doneQueue.push({task:e,err:t}):this._doneLoading(e,t))}get running(){return this._doneQueue.length>0||this._onLoadQueue.length>0}runTask(e){for(;!e.done&&this._onLoadQueue.length>0;){const t=this._onLoadQueue.shift();ur(t.task.abortController),t.task.abortController=null,t.callback(t.task),e.madeProgress()}for(;!e.done&&this._doneQueue.length>0;){const t=this._doneQueue.shift();t.task.status!==Pl.DOWNLOADED&&(t.err=t.err||Qi()),this._doneLoading(t.task,t.err),e.madeProgress()}}_doneLoading(e,t){if(t&&!Xn(t)&&e.numRetries>0)return--e.numRetries,void this._loadQueue.push(e);let i=e.result instanceof HTMLImageElement?0:e.resolvers.length;for(const r of e.resolvers)if(t)Xn(t)?r.reject(t):r.reject(new ue("stream-data-loader:request-error",`Failed to request resource at '${e.url}'. ${t}`,{url:e.url,error:t}));else{--i;const n=i<=0?e.result:_e(e.result);r.resolve(n)}this._tasks.delete(e.key),this._tasks.size===0&&this._set("updating",!1)}_startLoading(e,t){if(e.status===Pl.CANCELLED)return!1;let i,r;switch(e.startTime=performance.now(),e.status=Pl.DOWNLOADING,e.docType){case"binary":r="array-buffer",i=0;break;case"image":r="image";break;case"image+type":r="array-buffer";break;default:r="json"}e.abortController=new AbortController;const n=e.abortController.signal;e.request=Nt(e.url,Ce(K({},e.options),{responseType:r,timeout:i,signal:n}));let o=()=>{};const c=m=>{e.duration=performance.now()-e.startTime,e.size=m instanceof ArrayBuffer?m.byteLength:e.size||0,e.result=m,this._frameTask?this._onLoadQueue.push({callback:t,task:e}):(e.abortController=null,t(e))},h=m=>{e.status===Pl.DOWNLOADING&&t(e,m),o()};return e.docType!=="image+type"?(e.request.then(m=>c(m.data),h),!0):(e.request.then(m=>{const b=m.data,x=iNe(b);if(r="image",e.size=b.byteLength,x==="unknown")return e.request=Nt(e.url,{responseType:r,timeout:i,signal:n}),void e.request.then(k=>c(k.data),h);const I=new Blob([b],{type:x}),E=window.URL.createObjectURL(I);o=()=>window.URL.revokeObjectURL(E),e.request=Nt(E,{responseType:r,timeout:i,signal:n}),e.request.then(k=>c(new rNe(k.data,x,o)),h)},h),!0)}get test(){return{loadQueue:this._loadQueue}}};g([w({readOnly:!0})],qO.prototype,"updating",void 0),qO=g([te("esri.views.3d.support.StreamDataLoader")],qO);const tNe={numRetries:0};function iNe(e){if(e.byteLength<2)return"unknown";const t=new Uint8Array(e,0,e.byteLength);return t[0]===137&&t[1]===80?"image/png":t[0]===71&&t[1]===73?"image/gif":t[0]===66&&t[1]===77?"image/bmp":t[0]===255&&t[1]===216?"image/jpeg":"unknown"}class rNe{constructor(t,i,r){this.image=t,this.type=i,this.release=r}get isOpaque(){return this.type==="image/jpeg"}}class nNe extends YFe{constructor(t,i,r,n,o){super(n),this.url=t,this.options=i,this.docType=r,this.key=o,this.result=null,this.status=Pl.QUEUED,this.request=null,this.abortController=null,this.resolvers=new Array,this.startTime=0,this.numRetries=tNe.numRetries}}function sNe(e,t,i){return`${e}:${t}:${i}`}var Pl;(function(e){e[e.QUEUED=1]="QUEUED",e[e.DOWNLOADING=2]="DOWNLOADING",e[e.DOWNLOADED=3]="DOWNLOADED",e[e.CANCELLED=4]="CANCELLED"})(Pl||(Pl={}));var fne,yne,Vu,mne,gne,vne,bne;(function(e){e[e.INNER=0]="INNER",e[e.OUTER=1]="OUTER"})(fne||(fne={})),function(e){e[e.REGULAR=0]="REGULAR",e[e.HAS_NORTH_POLE=1]="HAS_NORTH_POLE",e[e.HAS_SOUTH_POLE=2]="HAS_SOUTH_POLE",e[e.HAS_BOTH_POLES=3]="HAS_BOTH_POLES"}(yne||(yne={})),function(e){e[e.NORTH=0]="NORTH",e[e.NORTH_EAST=1]="NORTH_EAST",e[e.EAST=2]="EAST",e[e.SOUTH_EAST=3]="SOUTH_EAST",e[e.SOUTH=4]="SOUTH",e[e.SOUTH_WEST=5]="SOUTH_WEST",e[e.WEST=6]="WEST",e[e.NORTH_WEST=7]="NORTH_WEST"}(Vu||(Vu={})),function(e){e[e.OFF=0]="OFF",e[e.ON=1]="ON"}(mne||(mne={})),function(e){e[e.Color=0]="Color",e[e.ColorNoRasterImage=1]="ColorNoRasterImage",e[e.Highlight=2]="Highlight",e[e.Water=3]="Water",e[e.Occluded=4]="Occluded",e[e.ObjectAndLayerIdColor=5]="ObjectAndLayerIdColor"}(gne||(gne={})),function(e){e[e.FADING=0]="FADING",e[e.IMMEDIATE=1]="IMMEDIATE",e[e.UNFADED=2]="UNFADED"}(vne||(vne={})),function(e){e[e.INSIDE=0]="INSIDE",e[e.INTERSECTS=1]="INTERSECTS",e[e.OUTSIDE=2]="OUTSIDE"}(bne||(bne={}));const oNe=12;class Yr{constructor(t){const i=Yr.checkUnsupported(t);if(H(i))throw i;const r=Ht(t);this.spatialReference=r.spatialReference,this._isWebMercator=this.spatialReference.isWebMercator,this._isGCS=Fk(this.spatialReference)||ng(this.spatialReference)||sg(this.spatialReference),this.origin=[r.origin.x,r.origin.y],this.pixelSize=r.size[0],this.dpi=r.dpi;const n=r.lods.reduce((b,x,I)=>(x.level<b.min&&(b.min=x.level,b.minIndex=I),b.max=Math.max(b.max,x.level),b),{min:1/0,minIndex:0,max:-1/0}),o=r.lods[n.minIndex],c=2**o.level;let h=o.resolution*c,m=o.scale*c;this.levels=new Array(n.max+1);for(let b=0;b<this.levels.length;b++)this.levels[b]={resolution:h,scale:m,tileSize:[h*r.size[0],h*r.size[1]]},h/=2,m/=2}clone(){return new Yr(this.toTileInfo())}toTileInfo(){return new xu({dpi:this.dpi,origin:{x:this.origin[0],y:this.origin[1],spatialReference:this.spatialReference},size:[this.pixelSize,this.pixelSize],spatialReference:this.spatialReference,lods:this.levels.map((t,i)=>({level:i,scale:t.scale,resolution:t.resolution}))})}getExtent(t,i,r,n){const o=this.levels[t],c=o.tileSize[0],h=o.tileSize[1];n[0]=this.origin[0]+r*c,n[2]=this.origin[0]+(r+1)*c,n[3]=this.origin[1]-i*h,n[1]=this.origin[1]-(i+1)*h}convertExtentToRadians(t,i){this._isWebMercator?(i[0]=tz(t[0]),i[1]=iz(t[1]),i[2]=tz(t[2]),i[3]=iz(t[3])):this._isGCS&&(i[0]=xg(t[0]),i[1]=xg(t[1]),i[2]=xg(t[2]),i[3]=xg(t[3]))}getExtentGeometry(t,i,r,n=new gi){return this.getExtent(t,i,r,zu),n.spatialReference=this.spatialReference,n.xmin=zu[0],n.ymin=zu[1],n.xmax=zu[2],n.ymax=zu[3],n.zmin=void 0,n.zmax=void 0,n}ensureMaxLod(t){if(t==null)return!1;let i=!1;for(;this.levels.length<=t;){const r=this.levels[this.levels.length-1],n=r.resolution/2;this.levels.push({resolution:n,scale:r.scale/2,tileSize:[n*this.pixelSize,n*this.pixelSize]}),i=!0}return i}capMaxLod(t){this.levels.length>t+1&&(this.levels.length=t+1)}getMaxLod(){return this.levels.length-1}scaleAtLevel(t){return this.levels[0].scale/2**t}levelAtScale(t){const i=this.levels[0].scale;return t>=i?0:Math.log(i/t)*Math.LOG2E}resolutionAtLevel(t){return this.levels[0].resolution/2**t}compatibleWith(t){if(!(t instanceof Yr)){if(Yr.checkUnsupported(t))return!1;t=new Yr(t)}if(!t.spatialReference.equals(this.spatialReference)||t.pixelSize!==this.pixelSize)return!1;const i=Math.min(this.levels.length,t.levels.length)-1,r=this.levels[i].resolution;let n=.5*r;return!La(t.origin[0],this.origin[0],n)||!La(t.origin[1],this.origin[1],n)?!1:(n=.5*r/2**i/this.pixelSize*oNe,La(r,t.levels[i].resolution,n))}rootTilesInExtent(t,i=null,r=1/0){const n=new Array,o=this.levels[0].tileSize;if(ce(t)||o[0]===0||o[1]===0)return n;Yr.computeRowColExtent(t,o,this.origin,zu);let c=zu[1],h=zu[3],m=zu[0],b=zu[2];const x=b-m,I=h-c;if(x*I>r){const E=Math.floor(Math.sqrt(r));I>E&&(c=c+Math.floor(.5*I)-Math.floor(.5*E),h=c+E),x>E&&(m=m+Math.floor(.5*x)-Math.floor(.5*E),b=m+E)}for(let E=c;E<h;E++)for(let k=m;k<b;k++)n.push([0,E,k]);return H(i)&&(i[0]=this.origin[0]+m*o[0],i[1]=this.origin[1]-h*o[1],i[2]=this.origin[0]+b*o[0],i[3]=this.origin[1]-c*o[1]),n}static computeRowColExtent(t,i,r,n){const o=.001*(t[2]-t[0]+(t[3]-t[1]));n[0]=Math.max(0,Math.floor((t[0]+o-r[0])/i[0])),n[2]=Math.max(0,Math.ceil((t[2]-o-r[0])/i[0])),n[1]=Math.max(0,Math.floor((r[1]-t[3]+o)/i[1])),n[3]=Math.max(0,Math.ceil((r[1]-t[1]-o)/i[1]))}static isPowerOfTwo(t){const i=t.lods,r=i[0].resolution*2**i[0].level;return!i.some(n=>!xve(n.resolution,r/2**n.level))}static hasGapInLevels(t){const i=t.lods.map(r=>r.level);i.sort((r,n)=>r-n);for(let r=1;r<i.length;r++)if(i[r]!==i[0]+r)return!0;return!1}static tileSizeSupported(t){const i=t.size[1];return i===t.size[0]&&(i&i-1)==0&&i>=128&&i<=512}static hasOriginPerLODs(t){const i=t.origin;return t.lods.some(r=>r.origin!=null&&(r.origin[0]!==i.x||r.origin[1]!==i.y))}static getMissingTileInfoError(){return new ue("tilingscheme:tile-info-missing","Tiling scheme must have tiling information")}static checkUnsupported(t){return ce(t)?HO():t.lods.length<1?new ue("tilingscheme:generic","Tiling scheme must have at least one level"):Yr.isPowerOfTwo(t)?Yr.hasGapInLevels(t)?new ue("tilingscheme:gaps","Tiling scheme levels must not have gaps between min and max level"):Yr.tileSizeSupported(t)?Yr.hasOriginPerLODs(t)?new ue("tilingscheme:multiple-origin","Tiling scheme levels must not have their own origin"):null:new ue("tilingscheme:tile-size","Tiles must be square and size must be one of [128, 256, 512]"):new ue("tilingscheme:power-of-two","Tiling scheme must be power of two")}static fromExtent(t,i){const r=t[2]-t[0],n=t[3]-t[1],o=kh(i),c=1.2*Math.max(r,n),h=256,m=96,b=.0254,x=new Yr(new xu({size:[h,h],origin:{x:t[0]-.5*(c-r),y:t[3]+.5*(c-n)},lods:[{level:0,resolution:c/h,scale:1/(h/m*b/(c*o))}],spatialReference:i}));return x.ensureMaxLod(20),x}static makeWebMercatorAuxiliarySphere(t){const i=new Yr(Yr.WebMercatorAuxiliarySphereTileInfo);return i.ensureMaxLod(t),i}static makeGCSWithTileSize(t,i=256,r=16){const n=256/i,o=new Yr(new xu({size:[i,i],origin:{x:-180,y:90,spatialReference:t},spatialReference:t,lods:[{level:0,resolution:.703125*n,scale:295497598570834e-6*n}]}));return o.ensureMaxLod(r),o}get test(){return{isWebMercator:this._isWebMercator,isGCS:this._isGCS}}}function HO(){return new ue("tilingscheme:tile-info-missing","Tiling scheme must have tiling information")}Yr.WebMercatorAuxiliarySphereTileInfo=new xu({size:[256,256],origin:{x:-20037508342787e-6,y:20037508342787e-6,spatialReference:Mt.WebMercator},spatialReference:Mt.WebMercator,lods:[{level:0,resolution:156543.03392800014,scale:591657527591555e-6}]}),Yr.WebMercatorAuxiliarySphere=Yr.makeWebMercatorAuxiliarySphere(19);const zu=ro(),wne=64;Sve(V6/10);const aNe=ro();Yr.WebMercatorAuxiliarySphere.getExtent(0,0,0,aNe);ro([-180,-90,180,90]);const zv=it(),lNe=it(),Cp=it(),kp=it();function cNe(e,t,i=0){const r=e.extent;if(ce(r))return!1;if(i===0)return Uve(r,t);const n=Math.min(r[2]-r[0],r[3]-r[1]);return qve(r,t,i*n)}function b4(e,t,i,r){ko(zv,i),zv[r]=t[r];const n=fn(zv,zv,t),o=fn(lNe,e,t),c=Ci(o,n),h=Ci(n,n);let m;m=c<=0?t:h<=c?i:Ko(zv,t,Yo(n,n,c/h));const b=fn(zv,e,m);return Math.PI/2-Math.atan(b[2]/Math.sqrt(b[0]*b[0]+b[1]*b[1]))}function uNe(e,t,i){const r=e.extent;if(ce(r))return 0;Cp[0]=r[0],Cp[1]=r[1],Cp[2]=i,kp[0]=r[2],kp[1]=r[3],kp[2]=i;let n=1/0,o=1/0;return t[0]<Cp[0]?n=b4(t,Cp,kp,0):t[0]>kp[0]&&(n=b4(t,kp,Cp,0)),t[1]<Cp[1]?o=b4(t,Cp,kp,1):t[1]>kp[1]&&(o=b4(t,kp,Cp,1)),Math.min(n,o)}function hNe(e,t,i){if(ce(e))return HO();if(e.spatialReference.isGeographic&&!Fk(e.spatialReference))return new ue("tilingscheme:local-unsupported-spatial-reference","The tiling scheme spatial reference is not supported in local scenes");const r=Yr.checkUnsupported(e);if(H(r))return r;if(ce(i))return new ue("tilingscheme:extent-not-exist","The layer does not provide a layer extent.");const n=pNe(e,i);if(n)return n;const o=e.spatialReference;return H(t)&&!(o.equals(t)||t.isWGS84&&o.isWebMercator)?new ue("tilingscheme:spatial-reference-mismatch","The tiling scheme does not match the spatial reference of the local scene"):null}function pNe(e,t){const i=e.lods,r=i[0].resolution*2**i[0].level,n=[r*e.size[0],r*e.size[1]],o=[e.origin.x,e.origin.y],c=zve(t),h=ro();Yr.computeRowColExtent(c,n,o,h);const m=(h[2]-h[0])*(h[3]-h[1]);if(m>wne){const b=i[0].scale*2**i[0].level;let x=Math.max((c[3]-c[1])/e.size[1],(c[2]-c[0])/e.size[0])*b/r;const I=Math.floor(Math.log(x)/Math.log(10));return x=Math.ceil(x/10**I)*10**I,new ue("tilingscheme:too-many-root-tiles","Scale of level 0 of the tiling scheme (1:"+Math.floor(b).toLocaleString()+") is too large for the layer's extent. Suggested scale: 1:"+x.toLocaleString()+".",{level0Scale:b,suggestedLevel0Scale:x,requiredNumRootTiles:m,allowedNumRootTiles:wne})}return null}const dNe=Object.freeze(Object.defineProperty({__proto__:null,isInsideExtent:cNe,tiltToExtentEdge:uNe,checkIfTileInfoSupportedForViewSR:hNe},Symbol.toStringTag,{value:"Module"}));function fNe(){return!0}function yNe(){return 0}function mNe(e,t){if(ce(e))return HO();const i=e.lods.length-1,r=e.spatialReference,n=Fk(r)||ng(r)||sg(r);if(r.isWebMercator){if(!Yr.makeWebMercatorAuxiliarySphere(i).compatibleWith(e))return new ue("tilingscheme:incompatible-global-web-mercator","The tiling scheme is not compatible with the ArcGIS Online Web Mercator tiling scheme")}else{if(!n)return new ue("tilingscheme:global-unsupported-spatial-reference","The tiling scheme spatial reference is not supported in global scenes");if(!Yr.makeGCSWithTileSize(e.spatialReference,e.size[0],i).compatibleWith(e))return e.spatialReference.isWGS84?new ue("tilingscheme:incompatible-global-wgs84","The tiling scheme is not compatible with the ArcGIS Online WGS84 tiling scheme"):new ue("tilingscheme:incompatible-global","The tiling scheme is not compatible with the ArcGIS Online tiling scheme")}return H(t)&&!e.spatialReference.equals(t)?new ue("tilingscheme:spatial-reference-mismatch","The tiling scheme does not match the spatial reference of the global scene"):void 0}const gNe=Object.freeze(Object.defineProperty({__proto__:null,isInsideExtent:fNe,tiltToExtentEdge:yNe,checkIfTileInfoSupportedForViewSR:mNe},Symbol.toStringTag,{value:"Module"})),vNe={[ma.Global]:gNe,[ma.Local]:dNe};function WO(e,t,i,r){return vNe[r].checkIfTileInfoSupportedForViewSR(e,i,t)}function bNe(e,t,i){const r=Ywe(e);if(H(r)){if(!Xe.isCollection(r))return{tileInfo:r.tileInfo,fullExtent:r.fullExtent};{const n=r.find(o=>WO(o.tileInfo,o.fullExtent,t,i)==null);if(n)return{tileInfo:n.tileInfo,fullExtent:n.fullExtent}}}return{tileInfo:null,fullExtent:null}}Vu.NORTH,Vu.EAST,Vu.SOUTH,Vu.WEST;Vu.NORTH_EAST,Vu.SOUTH_EAST,Vu.SOUTH_WEST,Vu.NORTH_WEST;function wNe(e,t){return e!=null&&(t==null||(t===ma.Local?!e.isGeographic||e.isWGS84||e.wkid===pl.CGCS2000:e.isWebMercator||e.isWGS84||e.wkid===pl.CGCS2000||e.wkid===pl.GCSMARS2000||e.wkid===pl.GCSMARS2000_SPHERE||e.wkid===pl.GCSMOON2000))}async function _Ne(e,t={}){await SNe(e,t),ur(t)}async function xNe(e,t={}){const{basemap:i,view:r}=e;if(ur(t),"spatialReferenceLocked"in r&&!r.spatialReferenceLocked||(await i.load(t),ur(t),i.baseLayers.length===0))return;const n=i.baseLayers.getItemAt(0);if(!Kwe(n))return;if(i.spatialReference){if(r.spatialReference.equals(i.spatialReference))return;_ne()}await n.load(t),ur(t);const o=(("supportedSpatialReferences"in n?n.supportedSpatialReferences:null)||["tileInfo"in n?n.tileInfo.spatialReference:null]).filter(Boolean);o.length!==0&&o.every(c=>!r.spatialReference.equals(c))&&_ne()}function _ne(){throw new ue("basemap-compatibility:incompatible-spatial-reference","Basemap spatial reference is not compatible with the view")}async function SNe(e,t){const{basemap:i,view:r}=e;if(await i.load(t),i.baseLayers.length===0)return;const n=i.baseLayers.concat(i.referenceLayers).toArray().filter(c=>!iU(c)).map(c=>new ue("basemap-compatibility:unsupported-basemap-layer-type","Unsupported basemap layer type ${operationalLayerType}",{layer:c,operationalLayerType:c.operationalLayerType||"unknown"}));if(n.length)throw n[0];const o=i.baseLayers.getItemAt(0);if(iU(o)){try{await o.load(t)}catch(c){const h="basemap-compatibility:unknown-error",m="Unknown basemap compatibility error",{name:b=h,message:x=m,details:I}=c;throw new ue(b,x,I)}MNe(o,r)}}function MNe(e,t){const i=t.state.viewingMode;if(!i)return;let r,n;if((e==null?void 0:e.type)==="wmts"){const m=bNe(e,t.spatialReference,i);if(ce(m.tileInfo))throw new ue("basemapgalleryitem:tiling-scheme-incompatible","Basemap tiling scheme is incompatible with the view");r=m.tileInfo,n=m.fullExtent}else r=e.tileInfo,n=e.fullExtent;if(ce(r))return;if(!wNe(r.spatialReference,i))throw new ue(`basemapgalleryitem:spatial-reference-unsupported-${sQ(i)}`,`Basemap spatial reference is unsupported in ${sQ(i)} mode`);const o=r.spatialReference.isGeographic,c=(e==null?void 0:e.type)==="vector-tile"?r.getOrCreateCompatible(256,o?1:2):null;if(i===ma.Global){let m=WO(r,n,null,i);if(m&&(e==null?void 0:e.type)==="vector-tile"&&H(n)&&c&&!WO(c,n,null,i)&&(m=null),m){const b=r.spatialReference.isWebMercator?"web-mercator":"wgs84";throw new ue(`basemapgalleryitem:tiling-scheme-unsupported-${b}-global`,"Basemap tiling scheme is unsupported in global mode",{error:m})}}else if(Yr.checkUnsupported(r))throw new ue("basemapgalleryitem:tiling-scheme-unsupported-local","Basemap tiling scheme is unsupported in local mode");const h=t.get("basemapTerrain.tilingScheme");if(h&&!h.compatibleWith(r)&&((e==null?void 0:e.type)!=="vector-tile"||!c||!h.compatibleWith(c)))throw new ue("basemapgalleryitem:tiling-scheme-incompatible","Basemap tiling scheme is incompatible with the view")}let Gu=class extends rc(ls(Ye)){constructor(e){super(e),this.compatibilityFunction=null,this.error=null,this.state="loading",this.view=null}initialize(){const e=()=>this.refresh();this.handles.add([we(()=>{var t;return(t=this.basemap)==null?void 0:t.loadStatus},e),we(()=>this.compatibilityFunction,e),we(()=>{var t;return this.view&&"basemapTerrain"in this.view&&((t=this.view.basemapTerrain)==null?void 0:t.tilingScheme)},e),we(()=>{var t;return(t=this.view)==null?void 0:t.ready},e),we(()=>{var t;return(t=this.view)==null?void 0:t.spatialReference},e)]),this.refresh()}destroy(){this._cancelRefresh(),this.basemap=null,this.compatibilityFunction=null,this.view=null}get _spatialReferenceTask(){return f_e(this.view,this.basemap)}set basemap(e){const t=this._get("basemap");t&&t.cancelLoad(),e&&e.load().catch(()=>{}),this._set("basemap",e)}get spatialReference(){return this._spatialReferenceTask.spatialReference}refresh(){var r;this._cancelRefresh(),this._set("state","loading");const e=(r=this.basemap)==null?void 0:r.loadStatus;if(e!=="loaded"&&e!=="failed")return;if(!this.compatibilityFunction)return void(e==="loaded"?(this._set("state","ready"),this._set("error",null)):(this._set("state","error"),this._set("error",this.basemap.loadError)));const t=new AbortController,{signal:i}=t;this.compatibilityFunction(this,{signal:i}).then(()=>Ch(()=>!this._spatialReferenceTask.updating,i)).then(()=>{this._set("state","ready"),this._set("error",null)}).catch(n=>{Xn(n)||(this._set("state","error"),this._set("error",n))}),this._refreshController=t}_cancelRefresh(){this._refreshController&&(this._refreshController.abort(),this._refreshController=null)}};g([w({readOnly:!0})],Gu.prototype,"_spatialReferenceTask",null),g([w()],Gu.prototype,"basemap",null),g([w()],Gu.prototype,"compatibilityFunction",void 0),g([w({readOnly:!0})],Gu.prototype,"error",void 0),g([w({readOnly:!0})],Gu.prototype,"spatialReference",null),g([w({readOnly:!0})],Gu.prototype,"state",void 0),g([w()],Gu.prototype,"view",void 0),Gu=g([te("esri.widgets.BasemapGallery.support.BasemapGalleryItem")],Gu);const xne=Gu,Sne=Xe.ofType(K0);let C3=class extends Ye{constructor(e){super(e),this.basemaps=new Sne}get state(){return"ready"}refresh(){}};g([w({type:Sne})],C3.prototype,"basemaps",void 0),g([w({readOnly:!0})],C3.prototype,"state",null),C3=g([te("esri.widgets.BasemapGallery.support.LocalBasemapsSource")],C3);const Mne=C3,Ine=Xe.ofType(K0);let Ap=class extends Xo.LoadableMixin(o_(Mne)){constructor(e){super(e),this._handles=new Ti,this.basemaps=new Ine,this.filterFunction=null,this.portal=nn.getDefault(),this.query=null,this.updateBasemapsCallback=null}initialize(){this._handles.add([we(()=>{var e,t;return[this.filterFunction,this.loadStatus,(e=this.portal)==null?void 0:e.basemapGalleryGroupQuery,(t=this.portal)==null?void 0:t.user,this.query,this.updateBasemapsCallback]},()=>this.refresh(),St)])}destroy(){this._handles.destroy(),this._handles=null,this.filterFunction=null,this.portal=null}get state(){return this.loadStatus==="not-loaded"?"not-loaded":this.loadStatus==="loading"||this._lastPortalBasemapFetchController?"loading":"ready"}load(e){return this.addResolvingPromise(this.portal.load(e)),this.notifyChange("state"),Promise.resolve(this)}async refresh(){if(this.state!=="ready")return;this._lastPortalBasemapFetchController&&(this._lastPortalBasemapFetchController.abort(),this._lastPortalBasemapFetchController=null);const e=this.portal,t=new AbortController;this._lastPortalBasemapFetchController=t,this.notifyChange("state");try{const i=await e.fetchBasemaps(this._toQueryString(this.query),t);this._updateBasemaps(i)}catch(i){if(Xn(i))throw i;$e.getLogger(this.declaredClass).warn(new ue("basemap-source:fetch-basemaps-error","Could not fetch basemaps from portal.",{error:i})),this._updateBasemaps()}this._lastPortalBasemapFetchController=null,this.notifyChange("state")}_toQueryString(e){return e&&typeof e!="string"?Object.keys(e).map(t=>`${t}:${e[t]}`).join(" AND "):e}_updateBasemaps(e=[]){let t=this.filterFunction?e.filter(this.filterFunction):e;t=this.updateBasemapsCallback?this.updateBasemapsCallback(t):t,this.basemaps.removeAll(),this.basemaps.addMany(t)}};g([w({readOnly:!0,type:Ine})],Ap.prototype,"basemaps",void 0),g([w()],Ap.prototype,"filterFunction",void 0),g([w({type:nn})],Ap.prototype,"portal",void 0),g([w()],Ap.prototype,"query",void 0),g([w({readOnly:!0})],Ap.prototype,"state",null),g([w()],Ap.prototype,"updateBasemapsCallback",void 0),Ap=g([te("esri.widgets.BasemapGallery.support.PortalBasemapsSource")],Ap);const w4=Ap,$ne=Xe.ofType(xne);function INe(e){return e&&e.declaredClass==="esri.portal.Portal"}function $Ne(e){return e&&!(e instanceof w4)&&(!!e.portal||!!e.query)}function ENe(e){return e&&"basemaps"in e&&"state"in e&&"refresh"in e}let Ll=class extends ls(Xo){constructor(e){super(e),this._loadingProjectionEngine=!1,this.items=new $ne,this.source=new w4,this.view=null}initialize(){const e=()=>this._recreateItems();this.handles.add([we(()=>this.state==="ready"?this.compatibilityFunction:null,()=>this._updateItems()),vr(()=>{var t;return(t=this.source)==null?void 0:t.basemaps},"change",e,{onListenerAdd:e})])}get activeBasemap(){var e,t,i;return(i=(t=(e=this.view)==null?void 0:e.map)==null?void 0:t.basemap)!=null?i:null}set activeBasemap(e){var r,n;if(!this.view.map)return;const t=typeof e=="string"?K0.fromId(e):e;if(!t||!this.view.ready)return this.view.map.basemap=t,void this._clearOverride("activeBasemap");const i=t.spatialReference||((n=(r=this.items)==null?void 0:r.find(o=>this.basemapEquals(t,o.basemap)))==null?void 0:n.spatialReference);if(i&&"spatialReferenceLocked"in this.view&&!this.view.spatialReferenceLocked){const o=this.view.spatialReference;if(H(i)&&!hr(o,i)&&!pc(this.view.spatialReference,i)&&!vu())return this._override("activeBasemap",t),this._loadingProjectionEngine=!0,void bu().then(()=>{this._get("activeBasemap")===e&&(this.view.map.basemap=e,this.view.spatialReference=i,this._clearOverride("activeBasemap"))},()=>{}).then(()=>{this._loadingProjectionEngine=!1});this.view.map.basemap=t,this._clearOverride("activeBasemap"),H(i)&&!hr(this.view.spatialReference,i)&&(this.view.spatialReference=i)}else this.view.map.basemap=t,this._clearOverride("activeBasemap")}get activeBasemapIndex(){const{state:e,items:t,activeBasemap:i}=this;if(e!=="ready")return-1;const r=t.findIndex(n=>n.basemap===i);return r===-1?t.findIndex(n=>this.basemapEquals(n.basemap,i)):r}get compatibilityFunction(){var e;return((e=this.view)==null?void 0:e.type)==="3d"?_Ne:xNe}set compatibilityFunction(e){this._overrideIfSome("compatibilityFunction",e)}castSource(e){return Array.isArray(e)||Xe.isCollection(e)?new Mne({basemaps:e}):INe(e)?new w4({portal:e}):$Ne(e)?new w4(e):ENe(e)?e:null}get state(){var e;return((e=this.view)==null?void 0:e.ready)&&this.source?this._loadingProjectionEngine?"loading":"ready":"disabled"}basemapEquals(e,t){return d_e(e,t)}refresh(){this._recreateItems()}load(e){return this.addResolvingPromise(Xo.isLoadable(this.source)?this.source.load(e):null),Promise.resolve(this)}_recreateItems(){var r;const e=(r=this.source)==null?void 0:r.basemaps,{view:t,compatibilityFunction:i}=this;this.items.removeAll().forEach(n=>n.destroy()),e&&this.items.addMany(e.map(n=>new xne({basemap:n,compatibilityFunction:i,view:t})))}_updateItems(){for(const e of this.items)e.compatibilityFunction=this.compatibilityFunction,e.view=this.view}};g([w()],Ll.prototype,"_loadingProjectionEngine",void 0),g([w()],Ll.prototype,"activeBasemap",null),g([w({readOnly:!0})],Ll.prototype,"activeBasemapIndex",null),g([w()],Ll.prototype,"compatibilityFunction",null),g([w({readOnly:!0,type:$ne})],Ll.prototype,"items",void 0),g([w()],Ll.prototype,"source",void 0),g([Dt("source")],Ll.prototype,"castSource",null),g([w({readOnly:!0})],Ll.prototype,"state",null),g([w()],Ll.prototype,"view",void 0),Ll=g([te("esri.widgets.BasemapGallery.BasemapGalleryViewModel")],Ll);const TNe=Ll,tl={base:"esri-basemap-gallery esri-widget esri-widget--panel-height-only",sourceLoading:"esri-basemap-gallery--source-loading",loader:"esri-basemap-gallery__loader",item:"esri-basemap-gallery__item",itemContainer:"esri-basemap-gallery__item-container",itemTitle:"esri-basemap-gallery__item-title",itemThumbnail:"esri-basemap-gallery__item-thumbnail",selectedItem:"esri-basemap-gallery__item--selected",itemError:"esri-basemap-gallery__item--error",emptyMessage:"esri-widget__content--empty",widgetIcon:"esri-icon-basemap",disabled:"esri-disabled",loaderAnimation:"esri-widget__loader-animation"};let Ol=class extends ki{constructor(e,t){super(e,t),this._handles=new Ti,this._focusBasemapItemEnabled=!1,this.disabled=!1,this.headingLevel=2,this.iconClass=tl.widgetIcon,this.messages=null,this.viewModel=new TNe}initialize(){const e=this._handles;this.addHandles([vr(()=>this.viewModel.items,"change",t=>{const i="basemap-gallery-item-changes",{added:r,moved:n}=t;e.remove(i),e.add([...r,...n].map(o=>we(()=>o.state,()=>this.scheduleRender())),i),this.scheduleRender()}),os(()=>this.source,()=>this.viewModel.load(),{initial:!0,once:!0})])}destroy(){this._handles.destroy()}loadDependencies(){return import("./calcite-scrim.de834e85.js")}get activeBasemap(){return this.viewModel.activeBasemap}set activeBasemap(e){this.viewModel.activeBasemap=e}get label(){var e,t;return(t=(e=this.messages)==null?void 0:e.widgetLabel)!=null?t:""}set label(e){this._overrideIfSome("label",e)}get source(){return this.viewModel.source}set source(e){this.viewModel.source=e}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}render(){const e=this.source.state==="loading",t=this.disabled||this.viewModel.state==="disabled",i=this.viewModel.items.map((c,h)=>this._renderBasemapGalleryItem(c,h)).toArray(),r={[tl.sourceLoading]:e,[tl.disabled]:t},n=e?j("div",{class:tl.loader,key:"esri-basemap-gallery__loader"}):null,o=e?null:i.length>0?j("ul",{bind:this,"aria-disabled":this.disabled,"aria-label":this.label,class:tl.itemContainer,key:"esri-basemap-gallery__item-container",onkeydown:this._handleKeyDown,role:"radiogroup"},i):j("div",{class:tl.emptyMessage,key:"esri-basemap-gallery__empty-message"},j(Va,{level:this.headingLevel},this.messages.noBasemaps));return j("div",{class:this.classes(tl.base,r)},n,o)}_getRoundRobinIndex(e,t){return(e+t)%t}_handleKeyDown(e){const{key:t}=e;if(!["ArrowUp","ArrowDown","ArrowRight","ArrowLeft"].includes(t))return;e.preventDefault();const{items:i,activeBasemapIndex:r}=this.viewModel,n=t==="ArrowUp"||t==="ArrowLeft"?this._getRoundRobinIndex(Math.max(r-1,-1),i.length):this._getRoundRobinIndex(r+1,i.length),o=i.getItemAt(n);(o==null?void 0:o.state)==="ready"&&(this.viewModel.activeBasemap=o.basemap),this._focusBasemapItemEnabled=!0}_focusBasemapItem(e){this._focusBasemapItemEnabled&&e.tabIndex===0&&(e.focus(),this._focusBasemapItemEnabled=!1)}_handleClick(e){const t=e.currentTarget["data-item"];t.state==="ready"&&(this.viewModel.activeBasemap=t.basemap)}_renderBasemapGalleryItem(e,t){var P,F;const i=e.basemap.thumbnailUrl||_i("esri/themes/base/images/basemap-toggle-64.svg"),r=e.basemap.title,n=(P=e.basemap.portalItem)==null?void 0:P.snippet,o=((F=e.error)==null?void 0:F.message)||n||r,{viewModel:{state:c,activeBasemapIndex:h}}=this,m=this.disabled||c==="disabled",b=h===t,x=b||h===-1&&t===0?0:-1,I=c==="loading",E={[tl.selectedItem]:b,[tl.itemError]:e.state==="error"},k=`basemapgallery-item-${e.uid}`;return j("li",{"aria-checked":b.toString(),"aria-disabled":m.toString(),"aria-labelledby":k,bind:this,class:this.classes(tl.item,E),"data-item":e,onkeydown:this._handleClick,onclick:this._handleClick,role:"radio",tabIndex:x,afterUpdate:this._focusBasemapItem,title:o},j("img",{alt:"",class:tl.itemThumbnail,src:i}),j("div",{id:k,class:tl.itemTitle},r),e.state==="loading"||b&&I?j("calcite-scrim",null,j("span",{"aria-hidden":"true",role:"presentation",class:tl.loaderAnimation})):null)}};g([w()],Ol.prototype,"activeBasemap",null),g([w()],Ol.prototype,"disabled",void 0),g([w()],Ol.prototype,"headingLevel",void 0),g([w()],Ol.prototype,"iconClass",void 0),g([w()],Ol.prototype,"label",null),g([w(),ci("esri/widgets/BasemapGallery/t9n/BasemapGallery")],Ol.prototype,"messages",void 0),g([w()],Ol.prototype,"source",null),g([w()],Ol.prototype,"view",null),g([w()],Ol.prototype,"viewModel",void 0),g([Ki()],Ol.prototype,"_handleClick",null),Ol=g([te("esri.widgets.BasemapGallery")],Ol);var JO;let Pp=JO=class extends ke{constructor(){super(...arguments),this.url=""}destroy(){this.url=""}clone(){return new JO({url:this.url})}};g([w({type:String,json:{write:{isRequired:!0}}})],Pp.prototype,"url",void 0),Pp=JO=g([te("esri.webdoc.support.SlideThumbnail")],Pp);let Nf=class extends Ye{constructor(e){super(e)}get editedBookmark(){const{bookmark:e}=this;return e?this._get("editedBookmark")||e.clone():null}get state(){return this._get("state")}set state(e){this.validationState=void 0,this.loading=void 0,this._set("state",e)}};g([w()],Nf.prototype,"bookmark",void 0),g([w({readOnly:!0})],Nf.prototype,"editedBookmark",null),g([w()],Nf.prototype,"state",null),g([w()],Nf.prototype,"validationState",void 0),g([w()],Nf.prototype,"loading",void 0),Nf=g([te("esri.widgets.Bookmarks.UserState")],Nf);const ZO=Nf;var KO;let Bu=KO=class extends rc(ke){constructor(e){super(e),this.name=null,this.thumbnail=new Pp,this.timeExtent=null}castThumbnail(e){return typeof e=="string"?new Pp({url:e}):Oi(Pp,e)}set viewpoint(e){const{targetGeometry:t,scale:i}=e;H(t)&&t.type==="point"&&ce(i)&&$e.getLogger(this.declaredClass).warn("Bookmark.viewpoint should include 'scale' when its targetGeometry is a point.",e),this._set("viewpoint",e)}readViewpoint(e,t){const{extent:i,viewpoint:r}=t;return ra.fromJSON(r||{targetGeometry:i})}writeViewpoint(e,t,i,r){if(!e)return;const{targetGeometry:n}=e;if(H(n)&&n.type!=="extent"){const o="Bookmark.viewpoint cannot be written to JSON when the viewpoint's targetGeometry is not an extent.";(r==null?void 0:r.messages)?r.messages.push(new ue("property:unsupported",o)):$e.getLogger(this.declaredClass).error(o)}else H(n)&&(t.extent=n.toJSON()),t[i]=e.toJSON()}clone(){return new KO(_e({name:this.name,thumbnail:this.thumbnail,timeExtent:this.timeExtent,viewpoint:this.viewpoint}))}};g([w({type:String,nonNullable:!0,json:{write:{isRequired:!0}}})],Bu.prototype,"name",void 0),g([w({type:Pp,json:{write:{overridePolicy:e=>({enabled:!(!e||!e.url)})}}})],Bu.prototype,"thumbnail",void 0),g([Dt("thumbnail")],Bu.prototype,"castThumbnail",null),g([w({type:qa,json:{write:!0}})],Bu.prototype,"timeExtent",void 0),g([w({type:ra,nonNullable:!0,json:{write:!0}})],Bu.prototype,"viewpoint",null),g([We("viewpoint",["extent","viewpoint"])],Bu.prototype,"readViewpoint",null),g([tt("viewpoint")],Bu.prototype,"writeViewpoint",null),Bu=KO=g([te("esri.webmap.Bookmark")],Bu);const Ene=Bu,Tne=Xe.ofType(Ene),CNe={width:128,height:128,format:"png"},_4={takeScreenshot:!0,captureViewpoint:!0,captureRotation:!0,captureScale:!0,captureTimeExtent:!0},Cne={time:!0};let Fc=class extends Z1(Or.EventedAccessor){constructor(e){super(e),this.abilities=K({},Cne),this.activeBookmark=null,this.view=null}destroy(){this.view=null,this._set("activeBookmark",null)}castAbilities(e){return K(K({},Cne),e)}get bookmarks(){var e,t,i;return(i=(t=(e=this.view)==null?void 0:e.map)==null?void 0:t.bookmarks)!=null?i:new Tne}set bookmarks(e){this._overrideIfSome("bookmarks",e)}set defaultCreateOptions(e){this._set("defaultCreateOptions",K(K({},_4),e))}get defaultCreateOptions(){return _4}set defaultEditOptions(e){this._set("defaultEditOptions",K(K({},_4),e))}get defaultEditOptions(){return _4}get state(){const e=this.get("view");return e&&!e.ready?"loading":"ready"}async createBookmark(e){const{view:t,defaultCreateOptions:i,abilities:r}=this;if(!t)throw new ue("create-bookmark:invalid-view","Cannot create a bookmark without a view.");const{takeScreenshot:n,screenshotSettings:o,captureViewpoint:c,captureRotation:h,captureScale:m,captureTimeExtent:b}=K(K({},i),e),x=n?await this._createThumbnail(o):void 0,I=r.time&&b&&H(t.timeExtent)?t.timeExtent.clone():void 0;return new Ene(K(K(K({},x&&{thumbnail:x}),b&&{timeExtent:I}),c&&{viewpoint:this._createViewpoint({view:t,captureScale:m,captureRotation:h})}))}async editBookmark(e,t){const{view:i,defaultEditOptions:r}=this;if(!i)throw new ue("edit-bookmark:invalid-view","Cannot edit a bookmark without a view.");const{takeScreenshot:n,screenshotSettings:o,captureViewpoint:c,captureRotation:h,captureScale:m,captureTimeExtent:b}=K(K({},r),t),x=n?await this._createThumbnail(o):void 0;return x&&(e.thumbnail=x),c&&(e.viewpoint=this._createViewpoint({view:i,captureScale:m,captureRotation:h})),b&&H(i.timeExtent)&&(e.timeExtent=i.timeExtent.clone()),this.emit("bookmark-edit",{bookmark:e}),e}goTo(e){const{abilities:t,view:i}=this;if(!i)throw new ue("go-to:invalid-view","Cannot go to a bookmark without a view");const r=e==null?void 0:e.viewpoint;if(!r)throw new ue("go-to:invalid-bookmark","Cannot go to a bookmark that does not contain a 'viewpoint'.",{bookmark:e});this._set("activeBookmark",e);const n={target:r},o=this.callGoTo(n),c=e==null?void 0:e.timeExtent;return t.time&&c&&(i.timeExtent=c),this.emit("bookmark-select",{bookmark:e}),o.catch(()=>{}).then(()=>this._set("activeBookmark",null)),o}async _createThumbnail(e){const t=await this.view.takeScreenshot(K(K({},CNe),e));return new Pp({url:t.dataUrl})}_createViewpoint({view:e,captureRotation:t,captureScale:i}){var n,o;const r=(n=e.viewpoint)==null?void 0:n.clone();return new ra({targetGeometry:(o=e.extent)==null?void 0:o.clone(),rotation:t&&(r==null?void 0:r.rotation)||0,scale:i&&(r==null?void 0:r.scale)||0})}};g([w()],Fc.prototype,"abilities",void 0),g([Dt("abilities")],Fc.prototype,"castAbilities",null),g([w({readOnly:!0})],Fc.prototype,"activeBookmark",void 0),g([w({type:Tne})],Fc.prototype,"bookmarks",null),g([w()],Fc.prototype,"defaultCreateOptions",null),g([w()],Fc.prototype,"defaultEditOptions",null),g([w({readOnly:!0})],Fc.prototype,"state",null),g([w()],Fc.prototype,"view",void 0),Fc=g([te("esri.widgets.Bookmarks.BookmarksViewModel")],Fc);const kne=Fc;var x4;let Rl=x4=class extends Ye{constructor(e){super(e),this.autoCloseMenu=!1,this.iconClass=null,this.items=null,this.label=null,this.open=!1,this.selected=!1,this.selectionEnabled=!1,this.clickFunction=null}castItems(e){return e?e.map(t=>t instanceof x4?t:new x4(t)):null}};g([w()],Rl.prototype,"autoCloseMenu",void 0),g([w()],Rl.prototype,"iconClass",void 0),g([w()],Rl.prototype,"items",void 0),g([Dt("items")],Rl.prototype,"castItems",null),g([w()],Rl.prototype,"label",void 0),g([w()],Rl.prototype,"open",void 0),g([w()],Rl.prototype,"selected",void 0),g([w()],Rl.prototype,"selectionEnabled",void 0),g([w()],Rl.prototype,"clickFunction",void 0),Rl=x4=g([te("esri.widgets.FeatureTable.Grid.support.ButtonMenuItem")],Rl);const k3=Rl;let Gv=class extends Ye{constructor(e){super(e),this.items=null,this.open=!1}castItems(e){return e?e.map(t=>t instanceof k3?t:new k3(t)):null}};g([w()],Gv.prototype,"items",void 0),g([Dt("items")],Gv.prototype,"castItems",null),g([w()],Gv.prototype,"open",void 0),Gv=g([te("esri.widgets.FeatureTable.Grid.support.ButtonMenuViewModel")],Gv);const kNe=Gv;function Fl(e){if(e==null)return window;if(e.toString()!=="[object Window]"){var t=e.ownerDocument;return t&&t.defaultView||window}return e}function ym(e){var t=Fl(e).Element;return e instanceof t||e instanceof Element}function Nl(e){var t=Fl(e).HTMLElement;return e instanceof t||e instanceof HTMLElement}function YO(e){if(typeof ShadowRoot=="undefined")return!1;var t=Fl(e).ShadowRoot;return e instanceof t||e instanceof ShadowRoot}var mm=Math.max,S4=Math.min,Bv=Math.round;function XO(){var e=navigator.userAgentData;return e!=null&&e.brands?e.brands.map(function(t){return t.brand+"/"+t.version}).join(" "):navigator.userAgent}function Ane(){return!/^((?!chrome|android).)*safari/i.test(XO())}function Uv(e,t,i){t===void 0&&(t=!1),i===void 0&&(i=!1);var r=e.getBoundingClientRect(),n=1,o=1;t&&Nl(e)&&(n=e.offsetWidth>0&&Bv(r.width)/e.offsetWidth||1,o=e.offsetHeight>0&&Bv(r.height)/e.offsetHeight||1);var c=ym(e)?Fl(e):window,h=c.visualViewport,m=!Ane()&&i,b=(r.left+(m&&h?h.offsetLeft:0))/n,x=(r.top+(m&&h?h.offsetTop:0))/o,I=r.width/n,E=r.height/o;return{width:I,height:E,top:x,right:b+I,bottom:x+E,left:b,x:b,y:x}}function QO(e){var t=Fl(e),i=t.pageXOffset,r=t.pageYOffset;return{scrollLeft:i,scrollTop:r}}function ANe(e){return{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}}function PNe(e){return e===Fl(e)||!Nl(e)?QO(e):ANe(e)}function Uu(e){return e?(e.nodeName||"").toLowerCase():null}function Df(e){return((ym(e)?e.ownerDocument:e.document)||window.document).documentElement}function eR(e){return Uv(Df(e)).left+QO(e).scrollLeft}function Lp(e){return Fl(e).getComputedStyle(e)}function tR(e){var t=Lp(e),i=t.overflow,r=t.overflowX,n=t.overflowY;return/auto|scroll|overlay|hidden/.test(i+n+r)}function LNe(e){var t=e.getBoundingClientRect(),i=Bv(t.width)/e.offsetWidth||1,r=Bv(t.height)/e.offsetHeight||1;return i!==1||r!==1}function ONe(e,t,i){i===void 0&&(i=!1);var r=Nl(t),n=Nl(t)&&LNe(t),o=Df(t),c=Uv(e,n,i),h={scrollLeft:0,scrollTop:0},m={x:0,y:0};return(r||!r&&!i)&&((Uu(t)!=="body"||tR(o))&&(h=PNe(t)),Nl(t)?(m=Uv(t,!0),m.x+=t.clientLeft,m.y+=t.clientTop):o&&(m.x=eR(o))),{x:c.left+h.scrollLeft-m.x,y:c.top+h.scrollTop-m.y,width:c.width,height:c.height}}function iR(e){var t=Uv(e),i=e.offsetWidth,r=e.offsetHeight;return Math.abs(t.width-i)<=1&&(i=t.width),Math.abs(t.height-r)<=1&&(r=t.height),{x:e.offsetLeft,y:e.offsetTop,width:i,height:r}}function M4(e){return Uu(e)==="html"?e:e.assignedSlot||e.parentNode||(YO(e)?e.host:null)||Df(e)}function Pne(e){return["html","body","#document"].indexOf(Uu(e))>=0?e.ownerDocument.body:Nl(e)&&tR(e)?e:Pne(M4(e))}function A3(e,t){var i;t===void 0&&(t=[]);var r=Pne(e),n=r===((i=e.ownerDocument)==null?void 0:i.body),o=Fl(r),c=n?[o].concat(o.visualViewport||[],tR(r)?r:[]):r,h=t.concat(c);return n?h:h.concat(A3(M4(c)))}function RNe(e){return["table","td","th"].indexOf(Uu(e))>=0}function Lne(e){return!Nl(e)||Lp(e).position==="fixed"?null:e.offsetParent}function FNe(e){var t=/firefox/i.test(XO()),i=/Trident/i.test(XO());if(i&&Nl(e)){var r=Lp(e);if(r.position==="fixed")return null}var n=M4(e);for(YO(n)&&(n=n.host);Nl(n)&&["html","body"].indexOf(Uu(n))<0;){var o=Lp(n);if(o.transform!=="none"||o.perspective!=="none"||o.contain==="paint"||["transform","perspective"].indexOf(o.willChange)!==-1||t&&o.willChange==="filter"||t&&o.filter&&o.filter!=="none")return n;n=n.parentNode}return null}function P3(e){for(var t=Fl(e),i=Lne(e);i&&RNe(i)&&Lp(i).position==="static";)i=Lne(i);return i&&(Uu(i)==="html"||Uu(i)==="body"&&Lp(i).position==="static")?t:i||FNe(e)||t}var Sa="top",Dl="bottom",jl="right",Ma="left",rR="auto",L3=[Sa,Dl,jl,Ma],qv="start",O3="end",NNe="clippingParents",One="viewport",R3="popper",DNe="reference",Rne=L3.reduce(function(e,t){return e.concat([t+"-"+qv,t+"-"+O3])},[]),Fne=[].concat(L3,[rR]).reduce(function(e,t){return e.concat([t,t+"-"+qv,t+"-"+O3])},[]),jNe="beforeRead",VNe="read",zNe="afterRead",GNe="beforeMain",BNe="main",UNe="afterMain",qNe="beforeWrite",HNe="write",WNe="afterWrite",JNe=[jNe,VNe,zNe,GNe,BNe,UNe,qNe,HNe,WNe];function ZNe(e){var t=new Map,i=new Set,r=[];e.forEach(function(o){t.set(o.name,o)});function n(o){i.add(o.name);var c=[].concat(o.requires||[],o.requiresIfExists||[]);c.forEach(function(h){if(!i.has(h)){var m=t.get(h);m&&n(m)}}),r.push(o)}return e.forEach(function(o){i.has(o.name)||n(o)}),r}function KNe(e){var t=ZNe(e);return JNe.reduce(function(i,r){return i.concat(t.filter(function(n){return n.phase===r}))},[])}function YNe(e){var t;return function(){return t||(t=new Promise(function(i){Promise.resolve().then(function(){t=void 0,i(e())})})),t}}function qu(e){return e.split("-")[0]}function XNe(e){var t=e.reduce(function(i,r){var n=i[r.name];return i[r.name]=n?Object.assign({},n,r,{options:Object.assign({},n.options,r.options),data:Object.assign({},n.data,r.data)}):r,i},{});return Object.keys(t).map(function(i){return t[i]})}function QNe(e,t){var i=Fl(e),r=Df(e),n=i.visualViewport,o=r.clientWidth,c=r.clientHeight,h=0,m=0;if(n){o=n.width,c=n.height;var b=Ane();(b||!b&&t==="fixed")&&(h=n.offsetLeft,m=n.offsetTop)}return{width:o,height:c,x:h+eR(e),y:m}}function eDe(e){var t,i=Df(e),r=QO(e),n=(t=e.ownerDocument)==null?void 0:t.body,o=mm(i.scrollWidth,i.clientWidth,n?n.scrollWidth:0,n?n.clientWidth:0),c=mm(i.scrollHeight,i.clientHeight,n?n.scrollHeight:0,n?n.clientHeight:0),h=-r.scrollLeft+eR(e),m=-r.scrollTop;return Lp(n||i).direction==="rtl"&&(h+=mm(i.clientWidth,n?n.clientWidth:0)-o),{width:o,height:c,x:h,y:m}}function Nne(e,t){var i=t.getRootNode&&t.getRootNode();if(e.contains(t))return!0;if(i&&YO(i)){var r=t;do{if(r&&e.isSameNode(r))return!0;r=r.parentNode||r.host}while(r)}return!1}function nR(e){return Object.assign({},e,{left:e.x,top:e.y,right:e.x+e.width,bottom:e.y+e.height})}function tDe(e,t){var i=Uv(e,!1,t==="fixed");return i.top=i.top+e.clientTop,i.left=i.left+e.clientLeft,i.bottom=i.top+e.clientHeight,i.right=i.left+e.clientWidth,i.width=e.clientWidth,i.height=e.clientHeight,i.x=i.left,i.y=i.top,i}function Dne(e,t,i){return t===One?nR(QNe(e,i)):ym(t)?tDe(t,i):nR(eDe(Df(e)))}function iDe(e){var t=A3(M4(e)),i=["absolute","fixed"].indexOf(Lp(e).position)>=0,r=i&&Nl(e)?P3(e):e;return ym(r)?t.filter(function(n){return ym(n)&&Nne(n,r)&&Uu(n)!=="body"}):[]}function rDe(e,t,i,r){var n=t==="clippingParents"?iDe(e):[].concat(t),o=[].concat(n,[i]),c=o[0],h=o.reduce(function(m,b){var x=Dne(e,b,r);return m.top=mm(x.top,m.top),m.right=S4(x.right,m.right),m.bottom=S4(x.bottom,m.bottom),m.left=mm(x.left,m.left),m},Dne(e,c,r));return h.width=h.right-h.left,h.height=h.bottom-h.top,h.x=h.left,h.y=h.top,h}function Hv(e){return e.split("-")[1]}function sR(e){return["top","bottom"].indexOf(e)>=0?"x":"y"}function jne(e){var t=e.reference,i=e.element,r=e.placement,n=r?qu(r):null,o=r?Hv(r):null,c=t.x+t.width/2-i.width/2,h=t.y+t.height/2-i.height/2,m;switch(n){case Sa:m={x:c,y:t.y-i.height};break;case Dl:m={x:c,y:t.y+t.height};break;case jl:m={x:t.x+t.width,y:h};break;case Ma:m={x:t.x-i.width,y:h};break;default:m={x:t.x,y:t.y}}var b=n?sR(n):null;if(b!=null){var x=b==="y"?"height":"width";switch(o){case qv:m[b]=m[b]-(t[x]/2-i[x]/2);break;case O3:m[b]=m[b]+(t[x]/2-i[x]/2);break}}return m}function Vne(){return{top:0,right:0,bottom:0,left:0}}function zne(e){return Object.assign({},Vne(),e)}function Gne(e,t){return t.reduce(function(i,r){return i[r]=e,i},{})}function F3(e,t){t===void 0&&(t={});var i=t,r=i.placement,n=r===void 0?e.placement:r,o=i.strategy,c=o===void 0?e.strategy:o,h=i.boundary,m=h===void 0?NNe:h,b=i.rootBoundary,x=b===void 0?One:b,I=i.elementContext,E=I===void 0?R3:I,k=i.altBoundary,P=k===void 0?!1:k,F=i.padding,N=F===void 0?0:F,B=zne(typeof N!="number"?N:Gne(N,L3)),z=E===R3?DNe:R3,q=e.rects.popper,J=e.elements[P?z:E],X=rDe(ym(J)?J:J.contextElement||Df(e.elements.popper),m,x,c),Y=Uv(e.elements.reference),ae=jne({reference:Y,element:q,strategy:"absolute",placement:n}),he=nR(Object.assign({},q,ae)),fe=E===R3?he:Y,ye={top:X.top-fe.top+B.top,bottom:fe.bottom-X.bottom+B.bottom,left:X.left-fe.left+B.left,right:fe.right-X.right+B.right},xe=e.modifiersData.offset;if(E===R3&&xe){var Se=xe[n];Object.keys(ye).forEach(function(Ae){var Oe=[jl,Dl].indexOf(Ae)>=0?1:-1,bt=[Sa,Dl].indexOf(Ae)>=0?"y":"x";ye[Ae]+=Se[bt]*Oe})}return ye}var Bne={placement:"bottom",modifiers:[],strategy:"absolute"};function Une(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return!t.some(function(r){return!(r&&typeof r.getBoundingClientRect=="function")})}function nDe(e){e===void 0&&(e={});var t=e,i=t.defaultModifiers,r=i===void 0?[]:i,n=t.defaultOptions,o=n===void 0?Bne:n;return function(h,m,b){b===void 0&&(b=o);var x={placement:"bottom",orderedModifiers:[],options:Object.assign({},Bne,o),modifiersData:{},elements:{reference:h,popper:m},attributes:{},styles:{}},I=[],E=!1,k={state:x,setOptions:function(B){var z=typeof B=="function"?B(x.options):B;F(),x.options=Object.assign({},o,x.options,z),x.scrollParents={reference:ym(h)?A3(h):h.contextElement?A3(h.contextElement):[],popper:A3(m)};var q=KNe(XNe([].concat(r,x.options.modifiers)));return x.orderedModifiers=q.filter(function(J){return J.enabled}),P(),k.update()},forceUpdate:function(){if(!E){var B=x.elements,z=B.reference,q=B.popper;if(!!Une(z,q)){x.rects={reference:ONe(z,P3(q),x.options.strategy==="fixed"),popper:iR(q)},x.reset=!1,x.placement=x.options.placement,x.orderedModifiers.forEach(function(ye){return x.modifiersData[ye.name]=Object.assign({},ye.data)});for(var J=0;J<x.orderedModifiers.length;J++){if(x.reset===!0){x.reset=!1,J=-1;continue}var X=x.orderedModifiers[J],Y=X.fn,ae=X.options,he=ae===void 0?{}:ae,fe=X.name;typeof Y=="function"&&(x=Y({state:x,options:he,name:fe,instance:k})||x)}}}},update:YNe(function(){return new Promise(function(N){k.forceUpdate(),N(x)})}),destroy:function(){F(),E=!0}};if(!Une(h,m))return k;k.setOptions(b).then(function(N){!E&&b.onFirstUpdate&&b.onFirstUpdate(N)});function P(){x.orderedModifiers.forEach(function(N){var B=N.name,z=N.options,q=z===void 0?{}:z,J=N.effect;if(typeof J=="function"){var X=J({state:x,name:B,instance:k,options:q}),Y=function(){};I.push(X||Y)}})}function F(){I.forEach(function(N){return N()}),I=[]}return k}}var I4={passive:!0};function sDe(e){var t=e.state,i=e.instance,r=e.options,n=r.scroll,o=n===void 0?!0:n,c=r.resize,h=c===void 0?!0:c,m=Fl(t.elements.popper),b=[].concat(t.scrollParents.reference,t.scrollParents.popper);return o&&b.forEach(function(x){x.addEventListener("scroll",i.update,I4)}),h&&m.addEventListener("resize",i.update,I4),function(){o&&b.forEach(function(x){x.removeEventListener("scroll",i.update,I4)}),h&&m.removeEventListener("resize",i.update,I4)}}var oDe={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:sDe,data:{}};function aDe(e){var t=e.state,i=e.name;t.modifiersData[i]=jne({reference:t.rects.reference,element:t.rects.popper,strategy:"absolute",placement:t.placement})}var lDe={name:"popperOffsets",enabled:!0,phase:"read",fn:aDe,data:{}},cDe={top:"auto",right:"auto",bottom:"auto",left:"auto"};function uDe(e){var t=e.x,i=e.y,r=window,n=r.devicePixelRatio||1;return{x:Bv(t*n)/n||0,y:Bv(i*n)/n||0}}function qne(e){var t,i=e.popper,r=e.popperRect,n=e.placement,o=e.variation,c=e.offsets,h=e.position,m=e.gpuAcceleration,b=e.adaptive,x=e.roundOffsets,I=e.isFixed,E=c.x,k=E===void 0?0:E,P=c.y,F=P===void 0?0:P,N=typeof x=="function"?x({x:k,y:F}):{x:k,y:F};k=N.x,F=N.y;var B=c.hasOwnProperty("x"),z=c.hasOwnProperty("y"),q=Ma,J=Sa,X=window;if(b){var Y=P3(i),ae="clientHeight",he="clientWidth";if(Y===Fl(i)&&(Y=Df(i),Lp(Y).position!=="static"&&h==="absolute"&&(ae="scrollHeight",he="scrollWidth")),Y=Y,n===Sa||(n===Ma||n===jl)&&o===O3){J=Dl;var fe=I&&Y===X&&X.visualViewport?X.visualViewport.height:Y[ae];F-=fe-r.height,F*=m?1:-1}if(n===Ma||(n===Sa||n===Dl)&&o===O3){q=jl;var ye=I&&Y===X&&X.visualViewport?X.visualViewport.width:Y[he];k-=ye-r.width,k*=m?1:-1}}var xe=Object.assign({position:h},b&&cDe),Se=x===!0?uDe({x:k,y:F}):{x:k,y:F};if(k=Se.x,F=Se.y,m){var Ae;return Object.assign({},xe,(Ae={},Ae[J]=z?"0":"",Ae[q]=B?"0":"",Ae.transform=(X.devicePixelRatio||1)<=1?"translate("+k+"px, "+F+"px)":"translate3d("+k+"px, "+F+"px, 0)",Ae))}return Object.assign({},xe,(t={},t[J]=z?F+"px":"",t[q]=B?k+"px":"",t.transform="",t))}function hDe(e){var t=e.state,i=e.options,r=i.gpuAcceleration,n=r===void 0?!0:r,o=i.adaptive,c=o===void 0?!0:o,h=i.roundOffsets,m=h===void 0?!0:h,b={placement:qu(t.placement),variation:Hv(t.placement),popper:t.elements.popper,popperRect:t.rects.popper,gpuAcceleration:n,isFixed:t.options.strategy==="fixed"};t.modifiersData.popperOffsets!=null&&(t.styles.popper=Object.assign({},t.styles.popper,qne(Object.assign({},b,{offsets:t.modifiersData.popperOffsets,position:t.options.strategy,adaptive:c,roundOffsets:m})))),t.modifiersData.arrow!=null&&(t.styles.arrow=Object.assign({},t.styles.arrow,qne(Object.assign({},b,{offsets:t.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:m})))),t.attributes.popper=Object.assign({},t.attributes.popper,{"data-popper-placement":t.placement})}var pDe={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:hDe,data:{}};function dDe(e){var t=e.state;Object.keys(t.elements).forEach(function(i){var r=t.styles[i]||{},n=t.attributes[i]||{},o=t.elements[i];!Nl(o)||!Uu(o)||(Object.assign(o.style,r),Object.keys(n).forEach(function(c){var h=n[c];h===!1?o.removeAttribute(c):o.setAttribute(c,h===!0?"":h)}))})}function fDe(e){var t=e.state,i={popper:{position:t.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(t.elements.popper.style,i.popper),t.styles=i,t.elements.arrow&&Object.assign(t.elements.arrow.style,i.arrow),function(){Object.keys(t.elements).forEach(function(r){var n=t.elements[r],o=t.attributes[r]||{},c=Object.keys(t.styles.hasOwnProperty(r)?t.styles[r]:i[r]),h=c.reduce(function(m,b){return m[b]="",m},{});!Nl(n)||!Uu(n)||(Object.assign(n.style,h),Object.keys(o).forEach(function(m){n.removeAttribute(m)}))})}}var yDe={name:"applyStyles",enabled:!0,phase:"write",fn:dDe,effect:fDe,requires:["computeStyles"]};function mDe(e,t,i){var r=qu(e),n=[Ma,Sa].indexOf(r)>=0?-1:1,o=typeof i=="function"?i(Object.assign({},t,{placement:e})):i,c=o[0],h=o[1];return c=c||0,h=(h||0)*n,[Ma,jl].indexOf(r)>=0?{x:h,y:c}:{x:c,y:h}}function gDe(e){var t=e.state,i=e.options,r=e.name,n=i.offset,o=n===void 0?[0,0]:n,c=Fne.reduce(function(x,I){return x[I]=mDe(I,t.rects,o),x},{}),h=c[t.placement],m=h.x,b=h.y;t.modifiersData.popperOffsets!=null&&(t.modifiersData.popperOffsets.x+=m,t.modifiersData.popperOffsets.y+=b),t.modifiersData[r]=c}var vDe={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:gDe},bDe={left:"right",right:"left",bottom:"top",top:"bottom"};function $4(e){return e.replace(/left|right|bottom|top/g,function(t){return bDe[t]})}var wDe={start:"end",end:"start"};function Hne(e){return e.replace(/start|end/g,function(t){return wDe[t]})}function _De(e,t){t===void 0&&(t={});var i=t,r=i.placement,n=i.boundary,o=i.rootBoundary,c=i.padding,h=i.flipVariations,m=i.allowedAutoPlacements,b=m===void 0?Fne:m,x=Hv(r),I=x?h?Rne:Rne.filter(function(P){return Hv(P)===x}):L3,E=I.filter(function(P){return b.indexOf(P)>=0});E.length===0&&(E=I);var k=E.reduce(function(P,F){return P[F]=F3(e,{placement:F,boundary:n,rootBoundary:o,padding:c})[qu(F)],P},{});return Object.keys(k).sort(function(P,F){return k[P]-k[F]})}function xDe(e){if(qu(e)===rR)return[];var t=$4(e);return[Hne(e),t,Hne(t)]}function SDe(e){var t=e.state,i=e.options,r=e.name;if(!t.modifiersData[r]._skip){for(var n=i.mainAxis,o=n===void 0?!0:n,c=i.altAxis,h=c===void 0?!0:c,m=i.fallbackPlacements,b=i.padding,x=i.boundary,I=i.rootBoundary,E=i.altBoundary,k=i.flipVariations,P=k===void 0?!0:k,F=i.allowedAutoPlacements,N=t.options.placement,B=qu(N),z=B===N,q=m||(z||!P?[$4(N)]:xDe(N)),J=[N].concat(q).reduce(function(Sr,je){return Sr.concat(qu(je)===rR?_De(t,{placement:je,boundary:x,rootBoundary:I,padding:b,flipVariations:P,allowedAutoPlacements:F}):je)},[]),X=t.rects.reference,Y=t.rects.popper,ae=new Map,he=!0,fe=J[0],ye=0;ye<J.length;ye++){var xe=J[ye],Se=qu(xe),Ae=Hv(xe)===qv,Oe=[Sa,Dl].indexOf(Se)>=0,bt=Oe?"width":"height",st=F3(t,{placement:xe,boundary:x,rootBoundary:I,altBoundary:E,padding:b}),et=Oe?Ae?jl:Ma:Ae?Dl:Sa;X[bt]>Y[bt]&&(et=$4(et));var He=$4(et),Et=[];if(o&&Et.push(st[Se]<=0),h&&Et.push(st[et]<=0,st[He]<=0),Et.every(function(Sr){return Sr})){fe=xe,he=!1;break}ae.set(xe,Et)}if(he)for(var Gt=P?3:1,pi=function(je){var at=J.find(function(rt){var It=ae.get(rt);if(It)return It.slice(0,je).every(function(ni){return ni})});if(at)return fe=at,"break"},ei=Gt;ei>0;ei--){var pn=pi(ei);if(pn==="break")break}t.placement!==fe&&(t.modifiersData[r]._skip=!0,t.placement=fe,t.reset=!0)}}var MDe={name:"flip",enabled:!0,phase:"main",fn:SDe,requiresIfExists:["offset"],data:{_skip:!1}};function IDe(e){return e==="x"?"y":"x"}function N3(e,t,i){return mm(e,S4(t,i))}function $De(e,t,i){var r=N3(e,t,i);return r>i?i:r}function EDe(e){var t=e.state,i=e.options,r=e.name,n=i.mainAxis,o=n===void 0?!0:n,c=i.altAxis,h=c===void 0?!1:c,m=i.boundary,b=i.rootBoundary,x=i.altBoundary,I=i.padding,E=i.tether,k=E===void 0?!0:E,P=i.tetherOffset,F=P===void 0?0:P,N=F3(t,{boundary:m,rootBoundary:b,padding:I,altBoundary:x}),B=qu(t.placement),z=Hv(t.placement),q=!z,J=sR(B),X=IDe(J),Y=t.modifiersData.popperOffsets,ae=t.rects.reference,he=t.rects.popper,fe=typeof F=="function"?F(Object.assign({},t.rects,{placement:t.placement})):F,ye=typeof fe=="number"?{mainAxis:fe,altAxis:fe}:Object.assign({mainAxis:0,altAxis:0},fe),xe=t.modifiersData.offset?t.modifiersData.offset[t.placement]:null,Se={x:0,y:0};if(!!Y){if(o){var Ae,Oe=J==="y"?Sa:Ma,bt=J==="y"?Dl:jl,st=J==="y"?"height":"width",et=Y[J],He=et+N[Oe],Et=et-N[bt],Gt=k?-he[st]/2:0,pi=z===qv?ae[st]:he[st],ei=z===qv?-he[st]:-ae[st],pn=t.elements.arrow,Sr=k&&pn?iR(pn):{width:0,height:0},je=t.modifiersData["arrow#persistent"]?t.modifiersData["arrow#persistent"].padding:Vne(),at=je[Oe],rt=je[bt],It=N3(0,ae[st],Sr[st]),ni=q?ae[st]/2-Gt-It-at-ye.mainAxis:pi-It-at-ye.mainAxis,Ai=q?-ae[st]/2+Gt+It+rt+ye.mainAxis:ei+It+rt+ye.mainAxis,Ut=t.elements.arrow&&P3(t.elements.arrow),pe=Ut?J==="y"?Ut.clientTop||0:Ut.clientLeft||0:0,be=(Ae=xe==null?void 0:xe[J])!=null?Ae:0,Le=et+ni-be-pe,Ve=et+Ai-be,Ge=N3(k?S4(He,Le):He,et,k?mm(Et,Ve):Et);Y[J]=Ge,Se[J]=Ge-et}if(h){var Be,Q=J==="x"?Sa:Ma,Je=J==="x"?Dl:jl,Qe=Y[X],Pe=X==="y"?"height":"width",dt=Qe+N[Q],vt=Qe-N[Je],$t=[Sa,Ma].indexOf(B)!==-1,Ct=(Be=xe==null?void 0:xe[X])!=null?Be:0,qt=$t?dt:Qe-ae[Pe]-he[Pe]-Ct+ye.altAxis,oi=$t?Qe+ae[Pe]+he[Pe]-Ct-ye.altAxis:vt,Si=k&&$t?$De(qt,Qe,oi):N3(k?qt:dt,Qe,k?oi:vt);Y[X]=Si,Se[X]=Si-Qe}t.modifiersData[r]=Se}}var TDe={name:"preventOverflow",enabled:!0,phase:"main",fn:EDe,requiresIfExists:["offset"]},CDe=function(t,i){return t=typeof t=="function"?t(Object.assign({},i.rects,{placement:i.placement})):t,zne(typeof t!="number"?t:Gne(t,L3))};function kDe(e){var t,i=e.state,r=e.name,n=e.options,o=i.elements.arrow,c=i.modifiersData.popperOffsets,h=qu(i.placement),m=sR(h),b=[Ma,jl].indexOf(h)>=0,x=b?"height":"width";if(!(!o||!c)){var I=CDe(n.padding,i),E=iR(o),k=m==="y"?Sa:Ma,P=m==="y"?Dl:jl,F=i.rects.reference[x]+i.rects.reference[m]-c[m]-i.rects.popper[x],N=c[m]-i.rects.reference[m],B=P3(o),z=B?m==="y"?B.clientHeight||0:B.clientWidth||0:0,q=F/2-N/2,J=I[k],X=z-E[x]-I[P],Y=z/2-E[x]/2+q,ae=N3(J,Y,X),he=m;i.modifiersData[r]=(t={},t[he]=ae,t.centerOffset=ae-Y,t)}}function ADe(e){var t=e.state,i=e.options,r=i.element,n=r===void 0?"[data-popper-arrow]":r;n!=null&&(typeof n=="string"&&(n=t.elements.popper.querySelector(n),!n)||!Nne(t.elements.popper,n)||(t.elements.arrow=n))}var PDe={name:"arrow",enabled:!0,phase:"main",fn:kDe,effect:ADe,requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function Wne(e,t,i){return i===void 0&&(i={x:0,y:0}),{top:e.top-t.height-i.y,right:e.right-t.width+i.x,bottom:e.bottom-t.height+i.y,left:e.left-t.width-i.x}}function Jne(e){return[Sa,jl,Dl,Ma].some(function(t){return e[t]>=0})}function LDe(e){var t=e.state,i=e.name,r=t.rects.reference,n=t.rects.popper,o=t.modifiersData.preventOverflow,c=F3(t,{elementContext:"reference"}),h=F3(t,{altBoundary:!0}),m=Wne(c,r),b=Wne(h,n,o),x=Jne(m),I=Jne(b);t.modifiersData[i]={referenceClippingOffsets:m,popperEscapeOffsets:b,isReferenceHidden:x,hasPopperEscaped:I},t.attributes.popper=Object.assign({},t.attributes.popper,{"data-popper-reference-hidden":x,"data-popper-escaped":I})}var ODe={name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:LDe},RDe=[oDe,lDe,pDe,yDe,vDe,MDe,TDe,PDe,ODe],FDe=nDe({defaultModifiers:RDe});const NDe=["bottom","bottom-start","bottom-end","left","left-start","left-end","right","right-start","right-end","top","top-start","top-end"],Zne={base:"esri-popover",open:"esri-popover--open"},DDe={position:"fixed","z-index":"1000"};let Hu=class extends ki{constructor(e,t){super(e,t),this._popper=null,this._contentNode=null,this._renderAttached=!1,this._rootNode=null,this.anchorElement=null,this.offset=[0,0],this.open=!1,this.renderContentFunction=null,this._afterRootCreate=i=>{this._rootNode=i},this._afterContentCreate=i=>{this._contentNode=i},this._updatePosition=()=>{H(this._popper)&&this._popper.update()}}initialize(){this.when(()=>{this.destroyed||(this._projector.append(document.body,this.render),this._renderAttached=!0)}),this.addHandles([we(()=>[this.open,this.anchorElement],()=>this._buildPopper(),St),we(()=>[this.placement,this.offset],()=>this._setPopperOptions(),St)])}destroy(){this.owner=null,this.anchorElement=null,this.renderContentFunction=null,this._renderAttached&&(this._projector.detach(this.render),this._renderAttached=!1),H(this._rootNode)&&(V3e(this._rootNode),this._rootNode=null),this._contentNode=null,H(this._popper)&&(this._popper.destroy(),this._popper=null)}set container(e){}set owner(e){this._set("owner",e)}get placement(){return"top"}set placement(e){NDe.includes(e)?this._override("placement",e):this._clearOverride("placement")}render(){var r;const{open:e,owner:t,renderContentFunction:i}=this;return j("div",{afterCreate:this._afterRootCreate,class:this.classes(Zne.base,e?Zne.open:null),styles:DDe},j("div",{dir:jxe((r=this.owner)==null?void 0:r.container),afterCreate:this._afterContentCreate,afterUpdate:this._updatePosition},e&&(i==null?void 0:i.call(t))))}_buildPopper(){H(this._popper)&&(this._popper.destroy(),this._popper=null);const e=this._contentNode;if(ce(e)||!this.open||!this.renderContentFunction)return;const t=this._getAnchor();t&&(this._popper=FDe(t,e),this._setPopperOptions())}_setPopperOptions(){const{placement:e,offset:t,_popper:i}=this;ce(i)||(i.setOptions({placement:e,modifiers:[{name:"offset",options:{offset:t}}]}),i.forceUpdate())}_getAnchor(){const{anchorElement:e}=this;return a9(typeof e=="function"?e():e)}};g([w()],Hu.prototype,"anchorElement",void 0),g([w()],Hu.prototype,"container",null),g([w()],Hu.prototype,"offset",void 0),g([w()],Hu.prototype,"open",void 0),g([w()],Hu.prototype,"owner",null),g([w()],Hu.prototype,"placement",null),g([w()],Hu.prototype,"renderContentFunction",void 0),Hu=g([te("esri.widgets.support.Popover")],Hu);const Kne=Hu,go={base:"esri-button-menu",content:"esri-button-menu__content",contentWrapper:"esri-button-menu__content-wrapper",itemWrapper:"esri-button-menu__item-wrapper",label:"esri-button-menu__label",icon:"esri-button-menu__icon",item:"esri-button-menu__item",itemLabel:"esri-button-menu__item-label",itemLabelContent:"esri-button-menu__item-label-content",selectableMenuItem:"esri-button-menu__item--selectable",selectedMenuItem:"esri-button-menu__item--selected",checkbox:"esri-button-menu__checkbox",embeddedContentWrapper:"esri-button-menu__embedded-content-wrapper",button:"esri-button-menu__button",buttonSelected:"esri-button-menu__button--selected",defaultIconClass:"esri-icon-menu",widget:"esri-widget"};let jf=class extends ls(ki){constructor(e,t){super(e,t),this._menuContentNode=null,this._popover=null,this._rootNode=null,this.disabled=!1,this.iconClass="",this.viewModel=new kNe,this._handleOutsideClick=this._handleOutsideClick.bind(this)}postInitialize(){this._popover=new Kne({owner:this,open:!!this.open,placement:Ms(this.container)?"bottom-start":"bottom-end",renderContentFunction:this.renderMenuContent,anchorElement:this._rootNode}),this.handles.add(we(()=>this.open,e=>{var t;return(t=this._popover)==null?void 0:t.set("open",e)})),document.addEventListener("click",this._handleOutsideClick)}destroy(){var e;(e=this._popover)==null||e.destroy(),this._popover=null,document.removeEventListener("click",this._handleOutsideClick)}_handleOutsideClick(e){var i,r;if(!this.open||!this._rootNode||!this._menuContentNode)return;const t=e.target;((i=this._menuContentNode)==null?void 0:i.contains(t))||((r=this._rootNode)==null?void 0:r.contains(t))||(this.open=!1)}get items(){return this.viewModel.items}set items(e){this.viewModel.items=e}get open(){return this.viewModel.open}set open(e){this.viewModel.open=e}render(){return j("div",{afterCreate:this._afterRootNodeCreate,bind:this,"data-node-ref":"_rootNode",class:this.classes(go.base,go.widget),key:"menu"},this.renderMenuButton())}renderMenuButton(){const{iconClass:e,id:t,label:i,open:r}=this,n=this.classes(go.button,e!=null?e:go.defaultIconClass,r?go.buttonSelected:null);return j("button",{"aria-pressed":r.toString(),"aria-controls":`${t}-menu`,"aria-expanded":r.toString(),"aria-haspopup":"true","aria-label":i,bind:this,class:n,disabled:this.disabled,id:`${t}-button`,title:i!=null?i:"",selected:r,onclick:this._toggleOpen,tabindex:this.disabled?-1:0,type:"button"})}renderMenuContent(){var i;const{id:e,open:t}=this;return j("div",{afterCreate:this._afterMenuContentNodeCreate,bind:this,class:go.content,"data-node-ref":"_menuContentNode",key:"esri-button-menu-content",hidden:!t},j("ul",{"aria-labelledby":`${e}-button`,bind:this,class:go.itemWrapper,id:`${e}-menu`,role:"menu"},((i=this.items)==null?void 0:i.length)&&this.renderItems()))}renderItems(){var e;return(e=this.items)==null?void 0:e.map((t,i)=>this.renderItem(t,i))}renderItem(e,t,i){var c;const r=H(i)?`${this.id}-menu-item-${t}-${i}`:`${this.id}-menu-item-${t}`,n=`${r}-label`,o=this.classes(go.item,e.selectionEnabled?go.selectableMenuItem:null,e.selectionEnabled&&e.selected?go.selectedMenuItem:null);return j("li",{afterCreate:this._afterMenuItemCreate,bind:this,class:o,"data-item-index":t,"data-item-subIndex":i,for:r,key:r,onkeydown:h=>this._handleMenuItemKeydown(h,e),onclick:h=>this._handleMenuItemInteraction(h,e),role:"menuitem",tabindex:this.disabled?-1:0},j("input",{disabled:!0,checked:e.selected,class:go.checkbox,id:r,name:r,tabindex:"-1",type:"checkbox"}),j("label",{bind:this,class:this.classes(go.button,go.itemLabel),for:r,id:n},j("span",{class:this.classes(go.icon,e.iconClass),"aria-hidden":"true"}),j("span",{class:go.itemLabelContent},e.label)),j("ul",{"aria-labelledby":n,class:go.embeddedContentWrapper,id:`${this.id}-submenu`,role:"menu"},(c=e==null?void 0:e.items)==null?void 0:c.map((h,m)=>this.renderItem(h,t,m))))}_afterRootNodeCreate(e){var t;this._rootNode=e,(t=this._popover)==null||t.set("anchorElement",()=>e)}_handleMenuItemInteraction(e,t){t.selected=!t.selected,t.open=!(!t.selected||!t.items),t.autoCloseMenu&&this.set("open",!1),t.clickFunction&&t.clickFunction({event:e,item:t}),e.stopPropagation()}_handleMenuItemKeydown(e,t){const i=to(e);Hg(i)&&this._handleMenuItemInteraction(e,t),i==="Escape"&&(this.open=!1,e.preventDefault(),e.stopPropagation())}_afterMenuContentNodeCreate(e){this._menuContentNode=e,e.focus()}_toggleOpen(){this.open=!this.open}_afterMenuItemCreate(e){e["data-item-index"]===0&&e.focus()}};g([w()],jf.prototype,"disabled",void 0),g([w()],jf.prototype,"iconClass",void 0),g([w()],jf.prototype,"items",null),g([w()],jf.prototype,"open",null),g([w()],jf.prototype,"viewModel",void 0),jf=g([te("esri.widgets.FeatureTable.Grid.support.ButtonMenu")],jf);const jDe=jf;/**!
 * Sortable 1.15.0
 * @author	RubaXa   <trash@rubaxa.org>
 * @author	owenm    <owen23355@gmail.com>
 * @license MIT
 */function Yne(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),i.push.apply(i,r)}return i}function Wu(e){for(var t=1;t<arguments.length;t++){var i=arguments[t]!=null?arguments[t]:{};t%2?Yne(Object(i),!0).forEach(function(r){VDe(e,r,i[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):Yne(Object(i)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(i,r))})}return e}function E4(e){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?E4=function(t){return typeof t}:E4=function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},E4(e)}function VDe(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function Op(){return Op=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(e[r]=i[r])}return e},Op.apply(this,arguments)}function zDe(e,t){if(e==null)return{};var i={},r=Object.keys(e),n,o;for(o=0;o<r.length;o++)n=r[o],!(t.indexOf(n)>=0)&&(i[n]=e[n]);return i}function GDe(e,t){if(e==null)return{};var i=zDe(e,t),r,n;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)r=o[n],!(t.indexOf(r)>=0)&&(!Object.prototype.propertyIsEnumerable.call(e,r)||(i[r]=e[r]))}return i}var BDe="1.15.0";function Rp(e){if(typeof window!="undefined"&&window.navigator)return!!navigator.userAgent.match(e)}var Fp=Rp(/(?:Trident.*rv[ :]?11\.|msie|iemobile|Windows Phone)/i),D3=Rp(/Edge/i),Xne=Rp(/firefox/i),j3=Rp(/safari/i)&&!Rp(/chrome/i)&&!Rp(/android/i),Qne=Rp(/iP(ad|od|hone)/i),ese=Rp(/chrome/i)&&Rp(/android/i),tse={capture:!1,passive:!1};function Xi(e,t,i){e.addEventListener(t,i,!Fp&&tse)}function zi(e,t,i){e.removeEventListener(t,i,!Fp&&tse)}function T4(e,t){if(!!t){if(t[0]===">"&&(t=t.substring(1)),e)try{if(e.matches)return e.matches(t);if(e.msMatchesSelector)return e.msMatchesSelector(t);if(e.webkitMatchesSelector)return e.webkitMatchesSelector(t)}catch{return!1}return!1}}function UDe(e){return e.host&&e!==document&&e.host.nodeType?e.host:e.parentNode}function Ju(e,t,i,r){if(e){i=i||document;do{if(t!=null&&(t[0]===">"?e.parentNode===i&&T4(e,t):T4(e,t))||r&&e===i)return e;if(e===i)break}while(e=UDe(e))}return null}var ise=/\s+/g;function il(e,t,i){if(e&&t)if(e.classList)e.classList[i?"add":"remove"](t);else{var r=(" "+e.className+" ").replace(ise," ").replace(" "+t+" "," ");e.className=(r+(i?" "+t:"")).replace(ise," ")}}function Xt(e,t,i){var r=e&&e.style;if(r){if(i===void 0)return document.defaultView&&document.defaultView.getComputedStyle?i=document.defaultView.getComputedStyle(e,""):e.currentStyle&&(i=e.currentStyle),t===void 0?i:i[t];!(t in r)&&t.indexOf("webkit")===-1&&(t="-webkit-"+t),r[t]=i+(typeof i=="string"?"":"px")}}function Wv(e,t){var i="";if(typeof e=="string")i=e;else do{var r=Xt(e,"transform");r&&r!=="none"&&(i=r+" "+i)}while(!t&&(e=e.parentNode));var n=window.DOMMatrix||window.WebKitCSSMatrix||window.CSSMatrix||window.MSCSSMatrix;return n&&new n(i)}function rse(e,t,i){if(e){var r=e.getElementsByTagName(t),n=0,o=r.length;if(i)for(;n<o;n++)i(r[n],n);return r}return[]}function Zu(){var e=document.scrollingElement;return e||document.documentElement}function fs(e,t,i,r,n){if(!(!e.getBoundingClientRect&&e!==window)){var o,c,h,m,b,x,I;if(e!==window&&e.parentNode&&e!==Zu()?(o=e.getBoundingClientRect(),c=o.top,h=o.left,m=o.bottom,b=o.right,x=o.height,I=o.width):(c=0,h=0,m=window.innerHeight,b=window.innerWidth,x=window.innerHeight,I=window.innerWidth),(t||i)&&e!==window&&(n=n||e.parentNode,!Fp))do if(n&&n.getBoundingClientRect&&(Xt(n,"transform")!=="none"||i&&Xt(n,"position")!=="static")){var E=n.getBoundingClientRect();c-=E.top+parseInt(Xt(n,"border-top-width")),h-=E.left+parseInt(Xt(n,"border-left-width")),m=c+o.height,b=h+o.width;break}while(n=n.parentNode);if(r&&e!==window){var k=Wv(n||e),P=k&&k.a,F=k&&k.d;k&&(c/=F,h/=P,I/=P,x/=F,m=c+x,b=h+I)}return{top:c,left:h,bottom:m,right:b,width:I,height:x}}}function nse(e,t,i){for(var r=Vf(e,!0),n=fs(e)[t];r;){var o=fs(r)[i],c=void 0;if(i==="top"||i==="left"?c=n>=o:c=n<=o,!c)return r;if(r===Zu())break;r=Vf(r,!1)}return!1}function Jv(e,t,i,r){for(var n=0,o=0,c=e.children;o<c.length;){if(c[o].style.display!=="none"&&c[o]!==Yt.ghost&&(r||c[o]!==Yt.dragged)&&Ju(c[o],i.draggable,e,!1)){if(n===t)return c[o];n++}o++}return null}function oR(e,t){for(var i=e.lastElementChild;i&&(i===Yt.ghost||Xt(i,"display")==="none"||t&&!T4(i,t));)i=i.previousElementSibling;return i||null}function Vl(e,t){var i=0;if(!e||!e.parentNode)return-1;for(;e=e.previousElementSibling;)e.nodeName.toUpperCase()!=="TEMPLATE"&&e!==Yt.clone&&(!t||T4(e,t))&&i++;return i}function sse(e){var t=0,i=0,r=Zu();if(e)do{var n=Wv(e),o=n.a,c=n.d;t+=e.scrollLeft*o,i+=e.scrollTop*c}while(e!==r&&(e=e.parentNode));return[t,i]}function qDe(e,t){for(var i in e)if(!!e.hasOwnProperty(i)){for(var r in t)if(t.hasOwnProperty(r)&&t[r]===e[i][r])return Number(i)}return-1}function Vf(e,t){if(!e||!e.getBoundingClientRect)return Zu();var i=e,r=!1;do if(i.clientWidth<i.scrollWidth||i.clientHeight<i.scrollHeight){var n=Xt(i);if(i.clientWidth<i.scrollWidth&&(n.overflowX=="auto"||n.overflowX=="scroll")||i.clientHeight<i.scrollHeight&&(n.overflowY=="auto"||n.overflowY=="scroll")){if(!i.getBoundingClientRect||i===document.body)return Zu();if(r||t)return i;r=!0}}while(i=i.parentNode);return Zu()}function HDe(e,t){if(e&&t)for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);return e}function aR(e,t){return Math.round(e.top)===Math.round(t.top)&&Math.round(e.left)===Math.round(t.left)&&Math.round(e.height)===Math.round(t.height)&&Math.round(e.width)===Math.round(t.width)}var V3;function ose(e,t){return function(){if(!V3){var i=arguments,r=this;i.length===1?e.call(r,i[0]):e.apply(r,i),V3=setTimeout(function(){V3=void 0},t)}}}function WDe(){clearTimeout(V3),V3=void 0}function ase(e,t,i){e.scrollLeft+=t,e.scrollTop+=i}function lse(e){var t=window.Polymer,i=window.jQuery||window.Zepto;return t&&t.dom?t.dom(e).cloneNode(!0):i?i(e).clone(!0)[0]:e.cloneNode(!0)}var rl="Sortable"+new Date().getTime();function JDe(){var e=[],t;return{captureAnimationState:function(){if(e=[],!!this.options.animation){var r=[].slice.call(this.el.children);r.forEach(function(n){if(!(Xt(n,"display")==="none"||n===Yt.ghost)){e.push({target:n,rect:fs(n)});var o=Wu({},e[e.length-1].rect);if(n.thisAnimationDuration){var c=Wv(n,!0);c&&(o.top-=c.f,o.left-=c.e)}n.fromRect=o}})}},addAnimationState:function(r){e.push(r)},removeAnimationState:function(r){e.splice(qDe(e,{target:r}),1)},animateAll:function(r){var n=this;if(!this.options.animation){clearTimeout(t),typeof r=="function"&&r();return}var o=!1,c=0;e.forEach(function(h){var m=0,b=h.target,x=b.fromRect,I=fs(b),E=b.prevFromRect,k=b.prevToRect,P=h.rect,F=Wv(b,!0);F&&(I.top-=F.f,I.left-=F.e),b.toRect=I,b.thisAnimationDuration&&aR(E,I)&&!aR(x,I)&&(P.top-I.top)/(P.left-I.left)==(x.top-I.top)/(x.left-I.left)&&(m=KDe(P,E,k,n.options)),aR(I,x)||(b.prevFromRect=x,b.prevToRect=I,m||(m=n.options.animation),n.animate(b,P,I,m)),m&&(o=!0,c=Math.max(c,m),clearTimeout(b.animationResetTimer),b.animationResetTimer=setTimeout(function(){b.animationTime=0,b.prevFromRect=null,b.fromRect=null,b.prevToRect=null,b.thisAnimationDuration=null},m),b.thisAnimationDuration=m)}),clearTimeout(t),o?t=setTimeout(function(){typeof r=="function"&&r()},c):typeof r=="function"&&r(),e=[]},animate:function(r,n,o,c){if(c){Xt(r,"transition",""),Xt(r,"transform","");var h=Wv(this.el),m=h&&h.a,b=h&&h.d,x=(n.left-o.left)/(m||1),I=(n.top-o.top)/(b||1);r.animatingX=!!x,r.animatingY=!!I,Xt(r,"transform","translate3d("+x+"px,"+I+"px,0)"),this.forRepaintDummy=ZDe(r),Xt(r,"transition","transform "+c+"ms"+(this.options.easing?" "+this.options.easing:"")),Xt(r,"transform","translate3d(0,0,0)"),typeof r.animated=="number"&&clearTimeout(r.animated),r.animated=setTimeout(function(){Xt(r,"transition",""),Xt(r,"transform",""),r.animated=!1,r.animatingX=!1,r.animatingY=!1},c)}}}}function ZDe(e){return e.offsetWidth}function KDe(e,t,i,r){return Math.sqrt(Math.pow(t.top-e.top,2)+Math.pow(t.left-e.left,2))/Math.sqrt(Math.pow(t.top-i.top,2)+Math.pow(t.left-i.left,2))*r.animation}var Zv=[],lR={initializeByDefault:!0},z3={mount:function(t){for(var i in lR)lR.hasOwnProperty(i)&&!(i in t)&&(t[i]=lR[i]);Zv.forEach(function(r){if(r.pluginName===t.pluginName)throw"Sortable: Cannot mount plugin ".concat(t.pluginName," more than once")}),Zv.push(t)},pluginEvent:function(t,i,r){var n=this;this.eventCanceled=!1,r.cancel=function(){n.eventCanceled=!0};var o=t+"Global";Zv.forEach(function(c){!i[c.pluginName]||(i[c.pluginName][o]&&i[c.pluginName][o](Wu({sortable:i},r)),i.options[c.pluginName]&&i[c.pluginName][t]&&i[c.pluginName][t](Wu({sortable:i},r)))})},initializePlugins:function(t,i,r,n){Zv.forEach(function(h){var m=h.pluginName;if(!(!t.options[m]&&!h.initializeByDefault)){var b=new h(t,i,t.options);b.sortable=t,b.options=t.options,t[m]=b,Op(r,b.defaults)}});for(var o in t.options)if(!!t.options.hasOwnProperty(o)){var c=this.modifyOption(t,o,t.options[o]);typeof c!="undefined"&&(t.options[o]=c)}},getEventProperties:function(t,i){var r={};return Zv.forEach(function(n){typeof n.eventProperties=="function"&&Op(r,n.eventProperties.call(i[n.pluginName],t))}),r},modifyOption:function(t,i,r){var n;return Zv.forEach(function(o){!t[o.pluginName]||o.optionListeners&&typeof o.optionListeners[i]=="function"&&(n=o.optionListeners[i].call(t[o.pluginName],r))}),n}};function YDe(e){var t=e.sortable,i=e.rootEl,r=e.name,n=e.targetEl,o=e.cloneEl,c=e.toEl,h=e.fromEl,m=e.oldIndex,b=e.newIndex,x=e.oldDraggableIndex,I=e.newDraggableIndex,E=e.originalEvent,k=e.putSortable,P=e.extraEventProperties;if(t=t||i&&i[rl],!!t){var F,N=t.options,B="on"+r.charAt(0).toUpperCase()+r.substr(1);window.CustomEvent&&!Fp&&!D3?F=new CustomEvent(r,{bubbles:!0,cancelable:!0}):(F=document.createEvent("Event"),F.initEvent(r,!0,!0)),F.to=c||i,F.from=h||i,F.item=n||i,F.clone=o,F.oldIndex=m,F.newIndex=b,F.oldDraggableIndex=x,F.newDraggableIndex=I,F.originalEvent=E,F.pullMode=k?k.lastPutMode:void 0;var z=Wu(Wu({},P),z3.getEventProperties(r,t));for(var q in z)F[q]=z[q];i&&i.dispatchEvent(F),N[B]&&N[B].call(t,F)}}var XDe=["evt"],Ia=function(t,i){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},n=r.evt,o=GDe(r,XDe);z3.pluginEvent.bind(Yt)(t,i,Wu({dragEl:yt,parentEl:wn,ghostEl:yi,rootEl:Xr,nextEl:gm,lastDownEl:C4,cloneEl:un,cloneHidden:zf,dragStarted:B3,putSortable:Zs,activeSortable:Yt.active,originalEvent:n,oldIndex:Kv,oldDraggableIndex:G3,newIndex:nl,newDraggableIndex:Gf,hideGhostForTarget:yse,unhideGhostForTarget:mse,cloneNowHidden:function(){zf=!0},cloneNowShown:function(){zf=!1},dispatchSortableEvent:function(h){zo({sortable:i,name:h,originalEvent:n})}},o))};function zo(e){YDe(Wu({putSortable:Zs,cloneEl:un,targetEl:yt,rootEl:Xr,oldIndex:Kv,oldDraggableIndex:G3,newIndex:nl,newDraggableIndex:Gf},e))}var yt,wn,yi,Xr,gm,C4,un,zf,Kv,nl,G3,Gf,k4,Zs,Yv=!1,A4=!1,P4=[],vm,Nc,cR,uR,cse,use,B3,Xv,U3,q3=!1,L4=!1,O4,vo,hR=[],pR=!1,R4=[],F4=typeof document!="undefined",N4=Qne,hse=D3||Fp?"cssFloat":"float",QDe=F4&&!ese&&!Qne&&"draggable"in document.createElement("div"),pse=function(){if(!!F4){if(Fp)return!1;var e=document.createElement("x");return e.style.cssText="pointer-events:auto",e.style.pointerEvents==="auto"}}(),dse=function(t,i){var r=Xt(t),n=parseInt(r.width)-parseInt(r.paddingLeft)-parseInt(r.paddingRight)-parseInt(r.borderLeftWidth)-parseInt(r.borderRightWidth),o=Jv(t,0,i),c=Jv(t,1,i),h=o&&Xt(o),m=c&&Xt(c),b=h&&parseInt(h.marginLeft)+parseInt(h.marginRight)+fs(o).width,x=m&&parseInt(m.marginLeft)+parseInt(m.marginRight)+fs(c).width;if(r.display==="flex")return r.flexDirection==="column"||r.flexDirection==="column-reverse"?"vertical":"horizontal";if(r.display==="grid")return r.gridTemplateColumns.split(" ").length<=1?"vertical":"horizontal";if(o&&h.float&&h.float!=="none"){var I=h.float==="left"?"left":"right";return c&&(m.clear==="both"||m.clear===I)?"vertical":"horizontal"}return o&&(h.display==="block"||h.display==="flex"||h.display==="table"||h.display==="grid"||b>=n&&r[hse]==="none"||c&&r[hse]==="none"&&b+x>n)?"vertical":"horizontal"},eje=function(t,i,r){var n=r?t.left:t.top,o=r?t.right:t.bottom,c=r?t.width:t.height,h=r?i.left:i.top,m=r?i.right:i.bottom,b=r?i.width:i.height;return n===h||o===m||n+c/2===h+b/2},tje=function(t,i){var r;return P4.some(function(n){var o=n[rl].options.emptyInsertThreshold;if(!(!o||oR(n))){var c=fs(n),h=t>=c.left-o&&t<=c.right+o,m=i>=c.top-o&&i<=c.bottom+o;if(h&&m)return r=n}}),r},fse=function(t){function i(o,c){return function(h,m,b,x){var I=h.options.group.name&&m.options.group.name&&h.options.group.name===m.options.group.name;if(o==null&&(c||I))return!0;if(o==null||o===!1)return!1;if(c&&o==="clone")return o;if(typeof o=="function")return i(o(h,m,b,x),c)(h,m,b,x);var E=(c?h:m).options.group.name;return o===!0||typeof o=="string"&&o===E||o.join&&o.indexOf(E)>-1}}var r={},n=t.group;(!n||E4(n)!="object")&&(n={name:n}),r.name=n.name,r.checkPull=i(n.pull,!0),r.checkPut=i(n.put),r.revertClone=n.revertClone,t.group=r},yse=function(){!pse&&yi&&Xt(yi,"display","none")},mse=function(){!pse&&yi&&Xt(yi,"display","")};F4&&!ese&&document.addEventListener("click",function(e){if(A4)return e.preventDefault(),e.stopPropagation&&e.stopPropagation(),e.stopImmediatePropagation&&e.stopImmediatePropagation(),A4=!1,!1},!0);var bm=function(t){if(yt){t=t.touches?t.touches[0]:t;var i=tje(t.clientX,t.clientY);if(i){var r={};for(var n in t)t.hasOwnProperty(n)&&(r[n]=t[n]);r.target=r.rootEl=i,r.preventDefault=void 0,r.stopPropagation=void 0,i[rl]._onDragOver(r)}}},ije=function(t){yt&&yt.parentNode[rl]._isOutsideThisEl(t.target)};function Yt(e,t){if(!(e&&e.nodeType&&e.nodeType===1))throw"Sortable: `el` must be an HTMLElement, not ".concat({}.toString.call(e));this.el=e,this.options=t=Op({},t),e[rl]=this;var i={group:null,sort:!0,disabled:!1,store:null,handle:null,draggable:/^[uo]l$/i.test(e.nodeName)?">li":">*",swapThreshold:1,invertSwap:!1,invertedSwapThreshold:null,removeCloneOnHide:!0,direction:function(){return dse(e,this.options)},ghostClass:"sortable-ghost",chosenClass:"sortable-chosen",dragClass:"sortable-drag",ignore:"a, img",filter:null,preventOnFilter:!0,animation:0,easing:null,setData:function(c,h){c.setData("Text",h.textContent)},dropBubble:!1,dragoverBubble:!1,dataIdAttr:"data-id",delay:0,delayOnTouchOnly:!1,touchStartThreshold:(Number.parseInt?Number:window).parseInt(window.devicePixelRatio,10)||1,forceFallback:!1,fallbackClass:"sortable-fallback",fallbackOnBody:!1,fallbackTolerance:0,fallbackOffset:{x:0,y:0},supportPointer:Yt.supportPointer!==!1&&"PointerEvent"in window&&!j3,emptyInsertThreshold:5};z3.initializePlugins(this,e,i);for(var r in i)!(r in t)&&(t[r]=i[r]);fse(t);for(var n in this)n.charAt(0)==="_"&&typeof this[n]=="function"&&(this[n]=this[n].bind(this));this.nativeDraggable=t.forceFallback?!1:QDe,this.nativeDraggable&&(this.options.touchStartThreshold=1),t.supportPointer?Xi(e,"pointerdown",this._onTapStart):(Xi(e,"mousedown",this._onTapStart),Xi(e,"touchstart",this._onTapStart)),this.nativeDraggable&&(Xi(e,"dragover",this),Xi(e,"dragenter",this)),P4.push(this.el),t.store&&t.store.get&&this.sort(t.store.get(this)||[]),Op(this,JDe())}Yt.prototype={constructor:Yt,_isOutsideThisEl:function(t){!this.el.contains(t)&&t!==this.el&&(Xv=null)},_getDirection:function(t,i){return typeof this.options.direction=="function"?this.options.direction.call(this,t,i,yt):this.options.direction},_onTapStart:function(t){if(!!t.cancelable){var i=this,r=this.el,n=this.options,o=n.preventOnFilter,c=t.type,h=t.touches&&t.touches[0]||t.pointerType&&t.pointerType==="touch"&&t,m=(h||t).target,b=t.target.shadowRoot&&(t.path&&t.path[0]||t.composedPath&&t.composedPath()[0])||m,x=n.filter;if(uje(r),!yt&&!(/mousedown|pointerdown/.test(c)&&t.button!==0||n.disabled)&&!b.isContentEditable&&!(!this.nativeDraggable&&j3&&m&&m.tagName.toUpperCase()==="SELECT")&&(m=Ju(m,n.draggable,r,!1),!(m&&m.animated)&&C4!==m)){if(Kv=Vl(m),G3=Vl(m,n.draggable),typeof x=="function"){if(x.call(this,t,m,this)){zo({sortable:i,rootEl:b,name:"filter",targetEl:m,toEl:r,fromEl:r}),Ia("filter",i,{evt:t}),o&&t.cancelable&&t.preventDefault();return}}else if(x&&(x=x.split(",").some(function(I){if(I=Ju(b,I.trim(),r,!1),I)return zo({sortable:i,rootEl:I,name:"filter",targetEl:m,fromEl:r,toEl:r}),Ia("filter",i,{evt:t}),!0}),x)){o&&t.cancelable&&t.preventDefault();return}n.handle&&!Ju(b,n.handle,r,!1)||this._prepareDragStart(t,h,m)}}},_prepareDragStart:function(t,i,r){var n=this,o=n.el,c=n.options,h=o.ownerDocument,m;if(r&&!yt&&r.parentNode===o){var b=fs(r);if(Xr=o,yt=r,wn=yt.parentNode,gm=yt.nextSibling,C4=r,k4=c.group,Yt.dragged=yt,vm={target:yt,clientX:(i||t).clientX,clientY:(i||t).clientY},cse=vm.clientX-b.left,use=vm.clientY-b.top,this._lastX=(i||t).clientX,this._lastY=(i||t).clientY,yt.style["will-change"]="all",m=function(){if(Ia("delayEnded",n,{evt:t}),Yt.eventCanceled){n._onDrop();return}n._disableDelayedDragEvents(),!Xne&&n.nativeDraggable&&(yt.draggable=!0),n._triggerDragStart(t,i),zo({sortable:n,name:"choose",originalEvent:t}),il(yt,c.chosenClass,!0)},c.ignore.split(",").forEach(function(x){rse(yt,x.trim(),dR)}),Xi(h,"dragover",bm),Xi(h,"mousemove",bm),Xi(h,"touchmove",bm),Xi(h,"mouseup",n._onDrop),Xi(h,"touchend",n._onDrop),Xi(h,"touchcancel",n._onDrop),Xne&&this.nativeDraggable&&(this.options.touchStartThreshold=4,yt.draggable=!0),Ia("delayStart",this,{evt:t}),c.delay&&(!c.delayOnTouchOnly||i)&&(!this.nativeDraggable||!(D3||Fp))){if(Yt.eventCanceled){this._onDrop();return}Xi(h,"mouseup",n._disableDelayedDrag),Xi(h,"touchend",n._disableDelayedDrag),Xi(h,"touchcancel",n._disableDelayedDrag),Xi(h,"mousemove",n._delayedDragTouchMoveHandler),Xi(h,"touchmove",n._delayedDragTouchMoveHandler),c.supportPointer&&Xi(h,"pointermove",n._delayedDragTouchMoveHandler),n._dragStartTimer=setTimeout(m,c.delay)}else m()}},_delayedDragTouchMoveHandler:function(t){var i=t.touches?t.touches[0]:t;Math.max(Math.abs(i.clientX-this._lastX),Math.abs(i.clientY-this._lastY))>=Math.floor(this.options.touchStartThreshold/(this.nativeDraggable&&window.devicePixelRatio||1))&&this._disableDelayedDrag()},_disableDelayedDrag:function(){yt&&dR(yt),clearTimeout(this._dragStartTimer),this._disableDelayedDragEvents()},_disableDelayedDragEvents:function(){var t=this.el.ownerDocument;zi(t,"mouseup",this._disableDelayedDrag),zi(t,"touchend",this._disableDelayedDrag),zi(t,"touchcancel",this._disableDelayedDrag),zi(t,"mousemove",this._delayedDragTouchMoveHandler),zi(t,"touchmove",this._delayedDragTouchMoveHandler),zi(t,"pointermove",this._delayedDragTouchMoveHandler)},_triggerDragStart:function(t,i){i=i||t.pointerType=="touch"&&t,!this.nativeDraggable||i?this.options.supportPointer?Xi(document,"pointermove",this._onTouchMove):i?Xi(document,"touchmove",this._onTouchMove):Xi(document,"mousemove",this._onTouchMove):(Xi(yt,"dragend",this),Xi(Xr,"dragstart",this._onDragStart));try{document.selection?j4(function(){document.selection.empty()}):window.getSelection().removeAllRanges()}catch{}},_dragStarted:function(t,i){if(Yv=!1,Xr&&yt){Ia("dragStarted",this,{evt:i}),this.nativeDraggable&&Xi(document,"dragover",ije);var r=this.options;!t&&il(yt,r.dragClass,!1),il(yt,r.ghostClass,!0),Yt.active=this,t&&this._appendGhost(),zo({sortable:this,name:"start",originalEvent:i})}else this._nulling()},_emulateDragOver:function(){if(Nc){this._lastX=Nc.clientX,this._lastY=Nc.clientY,yse();for(var t=document.elementFromPoint(Nc.clientX,Nc.clientY),i=t;t&&t.shadowRoot&&(t=t.shadowRoot.elementFromPoint(Nc.clientX,Nc.clientY),t!==i);)i=t;if(yt.parentNode[rl]._isOutsideThisEl(t),i)do{if(i[rl]){var r=void 0;if(r=i[rl]._onDragOver({clientX:Nc.clientX,clientY:Nc.clientY,target:t,rootEl:i}),r&&!this.options.dragoverBubble)break}t=i}while(i=i.parentNode);mse()}},_onTouchMove:function(t){if(vm){var i=this.options,r=i.fallbackTolerance,n=i.fallbackOffset,o=t.touches?t.touches[0]:t,c=yi&&Wv(yi,!0),h=yi&&c&&c.a,m=yi&&c&&c.d,b=N4&&vo&&sse(vo),x=(o.clientX-vm.clientX+n.x)/(h||1)+(b?b[0]-hR[0]:0)/(h||1),I=(o.clientY-vm.clientY+n.y)/(m||1)+(b?b[1]-hR[1]:0)/(m||1);if(!Yt.active&&!Yv){if(r&&Math.max(Math.abs(o.clientX-this._lastX),Math.abs(o.clientY-this._lastY))<r)return;this._onDragStart(t,!0)}if(yi){c?(c.e+=x-(cR||0),c.f+=I-(uR||0)):c={a:1,b:0,c:0,d:1,e:x,f:I};var E="matrix(".concat(c.a,",").concat(c.b,",").concat(c.c,",").concat(c.d,",").concat(c.e,",").concat(c.f,")");Xt(yi,"webkitTransform",E),Xt(yi,"mozTransform",E),Xt(yi,"msTransform",E),Xt(yi,"transform",E),cR=x,uR=I,Nc=o}t.cancelable&&t.preventDefault()}},_appendGhost:function(){if(!yi){var t=this.options.fallbackOnBody?document.body:Xr,i=fs(yt,!0,N4,!0,t),r=this.options;if(N4){for(vo=t;Xt(vo,"position")==="static"&&Xt(vo,"transform")==="none"&&vo!==document;)vo=vo.parentNode;vo!==document.body&&vo!==document.documentElement?(vo===document&&(vo=Zu()),i.top+=vo.scrollTop,i.left+=vo.scrollLeft):vo=Zu(),hR=sse(vo)}yi=yt.cloneNode(!0),il(yi,r.ghostClass,!1),il(yi,r.fallbackClass,!0),il(yi,r.dragClass,!0),Xt(yi,"transition",""),Xt(yi,"transform",""),Xt(yi,"box-sizing","border-box"),Xt(yi,"margin",0),Xt(yi,"top",i.top),Xt(yi,"left",i.left),Xt(yi,"width",i.width),Xt(yi,"height",i.height),Xt(yi,"opacity","0.8"),Xt(yi,"position",N4?"absolute":"fixed"),Xt(yi,"zIndex","100000"),Xt(yi,"pointerEvents","none"),Yt.ghost=yi,t.appendChild(yi),Xt(yi,"transform-origin",cse/parseInt(yi.style.width)*100+"% "+use/parseInt(yi.style.height)*100+"%")}},_onDragStart:function(t,i){var r=this,n=t.dataTransfer,o=r.options;if(Ia("dragStart",this,{evt:t}),Yt.eventCanceled){this._onDrop();return}Ia("setupClone",this),Yt.eventCanceled||(un=lse(yt),un.removeAttribute("id"),un.draggable=!1,un.style["will-change"]="",this._hideClone(),il(un,this.options.chosenClass,!1),Yt.clone=un),r.cloneId=j4(function(){Ia("clone",r),!Yt.eventCanceled&&(r.options.removeCloneOnHide||Xr.insertBefore(un,yt),r._hideClone(),zo({sortable:r,name:"clone"}))}),!i&&il(yt,o.dragClass,!0),i?(A4=!0,r._loopId=setInterval(r._emulateDragOver,50)):(zi(document,"mouseup",r._onDrop),zi(document,"touchend",r._onDrop),zi(document,"touchcancel",r._onDrop),n&&(n.effectAllowed="move",o.setData&&o.setData.call(r,n,yt)),Xi(document,"drop",r),Xt(yt,"transform","translateZ(0)")),Yv=!0,r._dragStartId=j4(r._dragStarted.bind(r,i,t)),Xi(document,"selectstart",r),B3=!0,j3&&Xt(document.body,"user-select","none")},_onDragOver:function(t){var i=this.el,r=t.target,n,o,c,h=this.options,m=h.group,b=Yt.active,x=k4===m,I=h.sort,E=Zs||b,k,P=this,F=!1;if(pR)return;function N(He,Et){Ia(He,P,Wu({evt:t,isOwner:x,axis:k?"vertical":"horizontal",revert:c,dragRect:n,targetRect:o,canSort:I,fromSortable:E,target:r,completed:z,onMove:function(pi,ei){return D4(Xr,i,yt,n,pi,fs(pi),t,ei)},changed:q},Et))}function B(){N("dragOverAnimationCapture"),P.captureAnimationState(),P!==E&&E.captureAnimationState()}function z(He){return N("dragOverCompleted",{insertion:He}),He&&(x?b._hideClone():b._showClone(P),P!==E&&(il(yt,Zs?Zs.options.ghostClass:b.options.ghostClass,!1),il(yt,h.ghostClass,!0)),Zs!==P&&P!==Yt.active?Zs=P:P===Yt.active&&Zs&&(Zs=null),E===P&&(P._ignoreWhileAnimating=r),P.animateAll(function(){N("dragOverAnimationComplete"),P._ignoreWhileAnimating=null}),P!==E&&(E.animateAll(),E._ignoreWhileAnimating=null)),(r===yt&&!yt.animated||r===i&&!r.animated)&&(Xv=null),!h.dragoverBubble&&!t.rootEl&&r!==document&&(yt.parentNode[rl]._isOutsideThisEl(t.target),!He&&bm(t)),!h.dragoverBubble&&t.stopPropagation&&t.stopPropagation(),F=!0}function q(){nl=Vl(yt),Gf=Vl(yt,h.draggable),zo({sortable:P,name:"change",toEl:i,newIndex:nl,newDraggableIndex:Gf,originalEvent:t})}if(t.preventDefault!==void 0&&t.cancelable&&t.preventDefault(),r=Ju(r,h.draggable,i,!0),N("dragOver"),Yt.eventCanceled)return F;if(yt.contains(t.target)||r.animated&&r.animatingX&&r.animatingY||P._ignoreWhileAnimating===r)return z(!1);if(A4=!1,b&&!h.disabled&&(x?I||(c=wn!==Xr):Zs===this||(this.lastPutMode=k4.checkPull(this,b,yt,t))&&m.checkPut(this,b,yt,t))){if(k=this._getDirection(t,r)==="vertical",n=fs(yt),N("dragOverValid"),Yt.eventCanceled)return F;if(c)return wn=Xr,B(),this._hideClone(),N("revert"),Yt.eventCanceled||(gm?Xr.insertBefore(yt,gm):Xr.appendChild(yt)),z(!0);var J=oR(i,h.draggable);if(!J||oje(t,k,this)&&!J.animated){if(J===yt)return z(!1);if(J&&i===t.target&&(r=J),r&&(o=fs(r)),D4(Xr,i,yt,n,r,o,t,!!r)!==!1)return B(),J&&J.nextSibling?i.insertBefore(yt,J.nextSibling):i.appendChild(yt),wn=i,q(),z(!0)}else if(J&&sje(t,k,this)){var X=Jv(i,0,h,!0);if(X===yt)return z(!1);if(r=X,o=fs(r),D4(Xr,i,yt,n,r,o,t,!1)!==!1)return B(),i.insertBefore(yt,X),wn=i,q(),z(!0)}else if(r.parentNode===i){o=fs(r);var Y=0,ae,he=yt.parentNode!==i,fe=!eje(yt.animated&&yt.toRect||n,r.animated&&r.toRect||o,k),ye=k?"top":"left",xe=nse(r,"top","top")||nse(yt,"top","top"),Se=xe?xe.scrollTop:void 0;Xv!==r&&(ae=o[ye],q3=!1,L4=!fe&&h.invertSwap||he),Y=aje(t,r,o,k,fe?1:h.swapThreshold,h.invertedSwapThreshold==null?h.swapThreshold:h.invertedSwapThreshold,L4,Xv===r);var Ae;if(Y!==0){var Oe=Vl(yt);do Oe-=Y,Ae=wn.children[Oe];while(Ae&&(Xt(Ae,"display")==="none"||Ae===yi))}if(Y===0||Ae===r)return z(!1);Xv=r,U3=Y;var bt=r.nextElementSibling,st=!1;st=Y===1;var et=D4(Xr,i,yt,n,r,o,t,st);if(et!==!1)return(et===1||et===-1)&&(st=et===1),pR=!0,setTimeout(nje,30),B(),st&&!bt?i.appendChild(yt):r.parentNode.insertBefore(yt,st?bt:r),xe&&ase(xe,0,Se-xe.scrollTop),wn=yt.parentNode,ae!==void 0&&!L4&&(O4=Math.abs(ae-fs(r)[ye])),q(),z(!0)}if(i.contains(yt))return z(!1)}return!1},_ignoreWhileAnimating:null,_offMoveEvents:function(){zi(document,"mousemove",this._onTouchMove),zi(document,"touchmove",this._onTouchMove),zi(document,"pointermove",this._onTouchMove),zi(document,"dragover",bm),zi(document,"mousemove",bm),zi(document,"touchmove",bm)},_offUpEvents:function(){var t=this.el.ownerDocument;zi(t,"mouseup",this._onDrop),zi(t,"touchend",this._onDrop),zi(t,"pointerup",this._onDrop),zi(t,"touchcancel",this._onDrop),zi(document,"selectstart",this)},_onDrop:function(t){var i=this.el,r=this.options;if(nl=Vl(yt),Gf=Vl(yt,r.draggable),Ia("drop",this,{evt:t}),wn=yt&&yt.parentNode,nl=Vl(yt),Gf=Vl(yt,r.draggable),Yt.eventCanceled){this._nulling();return}Yv=!1,L4=!1,q3=!1,clearInterval(this._loopId),clearTimeout(this._dragStartTimer),fR(this.cloneId),fR(this._dragStartId),this.nativeDraggable&&(zi(document,"drop",this),zi(i,"dragstart",this._onDragStart)),this._offMoveEvents(),this._offUpEvents(),j3&&Xt(document.body,"user-select",""),Xt(yt,"transform",""),t&&(B3&&(t.cancelable&&t.preventDefault(),!r.dropBubble&&t.stopPropagation()),yi&&yi.parentNode&&yi.parentNode.removeChild(yi),(Xr===wn||Zs&&Zs.lastPutMode!=="clone")&&un&&un.parentNode&&un.parentNode.removeChild(un),yt&&(this.nativeDraggable&&zi(yt,"dragend",this),dR(yt),yt.style["will-change"]="",B3&&!Yv&&il(yt,Zs?Zs.options.ghostClass:this.options.ghostClass,!1),il(yt,this.options.chosenClass,!1),zo({sortable:this,name:"unchoose",toEl:wn,newIndex:null,newDraggableIndex:null,originalEvent:t}),Xr!==wn?(nl>=0&&(zo({rootEl:wn,name:"add",toEl:wn,fromEl:Xr,originalEvent:t}),zo({sortable:this,name:"remove",toEl:wn,originalEvent:t}),zo({rootEl:wn,name:"sort",toEl:wn,fromEl:Xr,originalEvent:t}),zo({sortable:this,name:"sort",toEl:wn,originalEvent:t})),Zs&&Zs.save()):nl!==Kv&&nl>=0&&(zo({sortable:this,name:"update",toEl:wn,originalEvent:t}),zo({sortable:this,name:"sort",toEl:wn,originalEvent:t})),Yt.active&&((nl==null||nl===-1)&&(nl=Kv,Gf=G3),zo({sortable:this,name:"end",toEl:wn,originalEvent:t}),this.save()))),this._nulling()},_nulling:function(){Ia("nulling",this),Xr=yt=wn=yi=gm=un=C4=zf=vm=Nc=B3=nl=Gf=Kv=G3=Xv=U3=Zs=k4=Yt.dragged=Yt.ghost=Yt.clone=Yt.active=null,R4.forEach(function(t){t.checked=!0}),R4.length=cR=uR=0},handleEvent:function(t){switch(t.type){case"drop":case"dragend":this._onDrop(t);break;case"dragenter":case"dragover":yt&&(this._onDragOver(t),rje(t));break;case"selectstart":t.preventDefault();break}},toArray:function(){for(var t=[],i,r=this.el.children,n=0,o=r.length,c=this.options;n<o;n++)i=r[n],Ju(i,c.draggable,this.el,!1)&&t.push(i.getAttribute(c.dataIdAttr)||cje(i));return t},sort:function(t,i){var r={},n=this.el;this.toArray().forEach(function(o,c){var h=n.children[c];Ju(h,this.options.draggable,n,!1)&&(r[o]=h)},this),i&&this.captureAnimationState(),t.forEach(function(o){r[o]&&(n.removeChild(r[o]),n.appendChild(r[o]))}),i&&this.animateAll()},save:function(){var t=this.options.store;t&&t.set&&t.set(this)},closest:function(t,i){return Ju(t,i||this.options.draggable,this.el,!1)},option:function(t,i){var r=this.options;if(i===void 0)return r[t];var n=z3.modifyOption(this,t,i);typeof n!="undefined"?r[t]=n:r[t]=i,t==="group"&&fse(r)},destroy:function(){Ia("destroy",this);var t=this.el;t[rl]=null,zi(t,"mousedown",this._onTapStart),zi(t,"touchstart",this._onTapStart),zi(t,"pointerdown",this._onTapStart),this.nativeDraggable&&(zi(t,"dragover",this),zi(t,"dragenter",this)),Array.prototype.forEach.call(t.querySelectorAll("[draggable]"),function(i){i.removeAttribute("draggable")}),this._onDrop(),this._disableDelayedDragEvents(),P4.splice(P4.indexOf(this.el),1),this.el=t=null},_hideClone:function(){if(!zf){if(Ia("hideClone",this),Yt.eventCanceled)return;Xt(un,"display","none"),this.options.removeCloneOnHide&&un.parentNode&&un.parentNode.removeChild(un),zf=!0}},_showClone:function(t){if(t.lastPutMode!=="clone"){this._hideClone();return}if(zf){if(Ia("showClone",this),Yt.eventCanceled)return;yt.parentNode==Xr&&!this.options.group.revertClone?Xr.insertBefore(un,yt):gm?Xr.insertBefore(un,gm):Xr.appendChild(un),this.options.group.revertClone&&this.animate(yt,un),Xt(un,"display",""),zf=!1}}};function rje(e){e.dataTransfer&&(e.dataTransfer.dropEffect="move"),e.cancelable&&e.preventDefault()}function D4(e,t,i,r,n,o,c,h){var m,b=e[rl],x=b.options.onMove,I;return window.CustomEvent&&!Fp&&!D3?m=new CustomEvent("move",{bubbles:!0,cancelable:!0}):(m=document.createEvent("Event"),m.initEvent("move",!0,!0)),m.to=t,m.from=e,m.dragged=i,m.draggedRect=r,m.related=n||t,m.relatedRect=o||fs(t),m.willInsertAfter=h,m.originalEvent=c,e.dispatchEvent(m),x&&(I=x.call(b,m,c)),I}function dR(e){e.draggable=!1}function nje(){pR=!1}function sje(e,t,i){var r=fs(Jv(i.el,0,i.options,!0)),n=10;return t?e.clientX<r.left-n||e.clientY<r.top&&e.clientX<r.right:e.clientY<r.top-n||e.clientY<r.bottom&&e.clientX<r.left}function oje(e,t,i){var r=fs(oR(i.el,i.options.draggable)),n=10;return t?e.clientX>r.right+n||e.clientX<=r.right&&e.clientY>r.bottom&&e.clientX>=r.left:e.clientX>r.right&&e.clientY>r.top||e.clientX<=r.right&&e.clientY>r.bottom+n}function aje(e,t,i,r,n,o,c,h){var m=r?e.clientY:e.clientX,b=r?i.height:i.width,x=r?i.top:i.left,I=r?i.bottom:i.right,E=!1;if(!c){if(h&&O4<b*n){if(!q3&&(U3===1?m>x+b*o/2:m<I-b*o/2)&&(q3=!0),q3)E=!0;else if(U3===1?m<x+O4:m>I-O4)return-U3}else if(m>x+b*(1-n)/2&&m<I-b*(1-n)/2)return lje(t)}return E=E||c,E&&(m<x+b*o/2||m>I-b*o/2)?m>x+b/2?1:-1:0}function lje(e){return Vl(yt)<Vl(e)?1:-1}function cje(e){for(var t=e.tagName+e.className+e.src+e.href+e.textContent,i=t.length,r=0;i--;)r+=t.charCodeAt(i);return r.toString(36)}function uje(e){R4.length=0;for(var t=e.getElementsByTagName("input"),i=t.length;i--;){var r=t[i];r.checked&&R4.push(r)}}function j4(e){return setTimeout(e,0)}function fR(e){return clearTimeout(e)}F4&&Xi(document,"touchmove",function(e){(Yt.active||Yv)&&e.cancelable&&e.preventDefault()});Yt.utils={on:Xi,off:zi,css:Xt,find:rse,is:function(t,i){return!!Ju(t,i,t,!1)},extend:HDe,throttle:ose,closest:Ju,toggleClass:il,clone:lse,index:Vl,nextTick:j4,cancelNextTick:fR,detectDirection:dse,getChild:Jv};Yt.get=function(e){return e[rl]};Yt.mount=function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];t[0].constructor===Array&&(t=t[0]),t.forEach(function(r){if(!r.prototype||!r.prototype.constructor)throw"Sortable: Mounted plugin must be a constructor function, not ".concat({}.toString.call(r));r.utils&&(Yt.utils=Wu(Wu({},Yt.utils),r.utils)),z3.mount(r)})};Yt.create=function(e,t){return new Yt(e,t)};Yt.version=BDe;var Hn=[],H3,yR,mR=!1,gR,vR,V4,W3;function hje(){function e(){this.defaults={scroll:!0,forceAutoScrollFallback:!1,scrollSensitivity:30,scrollSpeed:10,bubbleScroll:!0};for(var t in this)t.charAt(0)==="_"&&typeof this[t]=="function"&&(this[t]=this[t].bind(this))}return e.prototype={dragStarted:function(i){var r=i.originalEvent;this.sortable.nativeDraggable?Xi(document,"dragover",this._handleAutoScroll):this.options.supportPointer?Xi(document,"pointermove",this._handleFallbackAutoScroll):r.touches?Xi(document,"touchmove",this._handleFallbackAutoScroll):Xi(document,"mousemove",this._handleFallbackAutoScroll)},dragOverCompleted:function(i){var r=i.originalEvent;!this.options.dragOverBubble&&!r.rootEl&&this._handleAutoScroll(r)},drop:function(){this.sortable.nativeDraggable?zi(document,"dragover",this._handleAutoScroll):(zi(document,"pointermove",this._handleFallbackAutoScroll),zi(document,"touchmove",this._handleFallbackAutoScroll),zi(document,"mousemove",this._handleFallbackAutoScroll)),gse(),z4(),WDe()},nulling:function(){V4=yR=H3=mR=W3=gR=vR=null,Hn.length=0},_handleFallbackAutoScroll:function(i){this._handleAutoScroll(i,!0)},_handleAutoScroll:function(i,r){var n=this,o=(i.touches?i.touches[0]:i).clientX,c=(i.touches?i.touches[0]:i).clientY,h=document.elementFromPoint(o,c);if(V4=i,r||this.options.forceAutoScrollFallback||D3||Fp||j3){bR(i,this.options,h,r);var m=Vf(h,!0);mR&&(!W3||o!==gR||c!==vR)&&(W3&&gse(),W3=setInterval(function(){var b=Vf(document.elementFromPoint(o,c),!0);b!==m&&(m=b,z4()),bR(i,n.options,b,r)},10),gR=o,vR=c)}else{if(!this.options.bubbleScroll||Vf(h,!0)===Zu()){z4();return}bR(i,this.options,Vf(h,!1),!1)}}},Op(e,{pluginName:"scroll",initializeByDefault:!0})}function z4(){Hn.forEach(function(e){clearInterval(e.pid)}),Hn=[]}function gse(){clearInterval(W3)}var bR=ose(function(e,t,i,r){if(!!t.scroll){var n=(e.touches?e.touches[0]:e).clientX,o=(e.touches?e.touches[0]:e).clientY,c=t.scrollSensitivity,h=t.scrollSpeed,m=Zu(),b=!1,x;yR!==i&&(yR=i,z4(),H3=t.scroll,x=t.scrollFn,H3===!0&&(H3=Vf(i,!0)));var I=0,E=H3;do{var k=E,P=fs(k),F=P.top,N=P.bottom,B=P.left,z=P.right,q=P.width,J=P.height,X=void 0,Y=void 0,ae=k.scrollWidth,he=k.scrollHeight,fe=Xt(k),ye=k.scrollLeft,xe=k.scrollTop;k===m?(X=q<ae&&(fe.overflowX==="auto"||fe.overflowX==="scroll"||fe.overflowX==="visible"),Y=J<he&&(fe.overflowY==="auto"||fe.overflowY==="scroll"||fe.overflowY==="visible")):(X=q<ae&&(fe.overflowX==="auto"||fe.overflowX==="scroll"),Y=J<he&&(fe.overflowY==="auto"||fe.overflowY==="scroll"));var Se=X&&(Math.abs(z-n)<=c&&ye+q<ae)-(Math.abs(B-n)<=c&&!!ye),Ae=Y&&(Math.abs(N-o)<=c&&xe+J<he)-(Math.abs(F-o)<=c&&!!xe);if(!Hn[I])for(var Oe=0;Oe<=I;Oe++)Hn[Oe]||(Hn[Oe]={});(Hn[I].vx!=Se||Hn[I].vy!=Ae||Hn[I].el!==k)&&(Hn[I].el=k,Hn[I].vx=Se,Hn[I].vy=Ae,clearInterval(Hn[I].pid),(Se!=0||Ae!=0)&&(b=!0,Hn[I].pid=setInterval(function(){r&&this.layer===0&&Yt.active._onTouchMove(V4);var bt=Hn[this.layer].vy?Hn[this.layer].vy*h:0,st=Hn[this.layer].vx?Hn[this.layer].vx*h:0;typeof x=="function"&&x.call(Yt.dragged.parentNode[rl],st,bt,e,V4,Hn[this.layer].el)!=="continue"||ase(Hn[this.layer].el,st,bt)}.bind({layer:I}),24))),I++}while(t.bubbleScroll&&E!==m&&(E=Vf(E,!1)));mR=b}},30),vse=function(t){var i=t.originalEvent,r=t.putSortable,n=t.dragEl,o=t.activeSortable,c=t.dispatchSortableEvent,h=t.hideGhostForTarget,m=t.unhideGhostForTarget;if(!!i){var b=r||o;h();var x=i.changedTouches&&i.changedTouches.length?i.changedTouches[0]:i,I=document.elementFromPoint(x.clientX,x.clientY);m(),b&&!b.el.contains(I)&&(c("spill"),this.onSpill({dragEl:n,putSortable:r}))}};function wR(){}wR.prototype={startIndex:null,dragStart:function(t){var i=t.oldDraggableIndex;this.startIndex=i},onSpill:function(t){var i=t.dragEl,r=t.putSortable;this.sortable.captureAnimationState(),r&&r.captureAnimationState();var n=Jv(this.sortable.el,this.startIndex,this.options);n?this.sortable.el.insertBefore(i,n):this.sortable.el.appendChild(i),this.sortable.animateAll(),r&&r.animateAll()},drop:vse};Op(wR,{pluginName:"revertOnSpill"});function _R(){}_R.prototype={onSpill:function(t){var i=t.dragEl,r=t.putSortable,n=r||this.sortable;n.captureAnimationState(),i.parentNode&&i.parentNode.removeChild(i),n.animateAll()},drop:vse};Op(_R,{pluginName:"removeOnSpill"});Yt.mount(new hje);Yt.mount(_R,wR);function pje(e,t,i){e.splice(i,0,e.splice(t,1)[0])}const dje="bookmarks",wm="data-bookmark-uid",ot={base:"esri-bookmarks esri-widget--panel",loaderContainer:"esri-bookmarks__loader-container",loader:"esri-bookmarks__loader",fadeIn:"esri-bookmarks--fade-in",bookmarkList:"esri-bookmarks__list",bookmarkListSortable:"esri-bookmarks__list--sortable",bookmark:"esri-bookmarks__bookmark",bookmarkButton:"esri-bookmarks__bookmark-button",bookmarkImageContainer:"esri-bookmarks__bookmark-image-container",bookmarkEditButtonContainer:"esri-bookmarks__bookmark-edit-button-container",bookmarkEditButton:"esri-bookmarks__bookmark-edit-button",bookmarkDragHandle:"esri-bookmarks_bookmark-drag-handle",bookmarkDragHandleIcon:"esri-bookmarks_bookmark-drag-handle-icon",bookmarkIcon:"esri-bookmarks__bookmark-icon",bookmarkImage:"esri-bookmarks__image",bookmarkLabel:"esri-bookmarks__bookmark-label",bookmarkName:"esri-bookmarks__bookmark-name",bookmarkTimeExtent:"esri-bookmarks__bookmark-time-extent",bookmarkActive:"esri-bookmarks__bookmark--active",noBookmarksContainer:"esri-widget__content--empty",noBookmarksHeader:"esri-bookmarks__no-bookmarks-heading",noBookmarksIcon:"esri-widget__no-bookmark-icon",noBookmarksDescription:"esri-bookmarks__no-bookmarks-description",addingBookmark:"esri-bookmarks__adding-bookmark",addBookmark:"esri-bookmarks__add-bookmark",addBookmarkButton:"esri-bookmarks__add-bookmark-button",addBookmarkIcon:"esri-bookmarks__add-bookmark-icon",authoringCard:"esri-bookmarks__authoring-card",authoringContainer:"esri-bookmarks__authoring-container",authoringForm:"esri-bookmarks__authoring-form",authoringLabel:"esri-bookmarks__authoring-label",authoringActions:"esri-bookmarks__authoring-actions",authoringInputInvalid:"esri-bookmarks__authoring-input--invalid",authoringDeleteButton:"esri-bookmarks__authoring-delete-button",authoringCancelButton:"esri-bookmarks__authoring-cancel-button",timeExtentContainer:"esri-bookmarks__time-extent-container",timeExtent:"esri-bookmarks__time-extent",timeExtentGroup:"esri-bookmarks__time-extent-group",timeExtentDate:"esri-bookmarks__time-extent-date",timeExtentTime:"esri-bookmarks__time-extent-time",esriWidget:"esri-widget",esriWidgetDisabled:"esri-widget--disabled",esriButton:"esri-button",esriButtonTertiary:"esri-button--tertiary",esriInput:"esri-input",iconHandle:"esri-icon-handle-vertical",iconPlus:"esri-icon-plus",iconEdit:"esri-icon-edit",iconHandleHorizontal:"esri-icon-handle-horizontal",iconRefresh:"esri-icon-refresh",iconLink:"esri-icon-link",iconRemove:"esri-icon-erase",widgetIcon:"esri-icon-bookmark",header:"esri-widget__heading",loading:"esri-icon-loading-indicator",rotating:"esri-rotating"},bse={addBookmark:!0,thumbnail:!0,time:!0},xR=/^https:\/\/.*/i,fje="esri.widgets.Bookmarks";let jr=class extends ki{constructor(e,t){super(e,t),this._handles=new Ti,this._addInputNode=null,this._editInputNode=null,this._urlEditInputNode=null,this._addBookmarkButtonNode=null,this._focusAddBookmarkButton=!1,this._focusEditInputBox=!1,this._focusAddInputBox=!1,this._focusUrlEditInputBox=!1,this._sortable=null,this._sortableNode=null,this._focusSortUid=null,this._selectedSortUid=null,this._sortableSavedItems=null,this._editIncludeTimeExtent=null,this._userState=null,this.disabled=!1,this.editingEnabled=!1,this.headingLevel=2,this.iconClass=ot.widgetIcon,this.messages=null,this.messagesCommon=null,this.messagesUnits=null,this.viewModel=new kne,this.visibleElements=K({},bse)}initialize(){this.addHandles([we(()=>{var e;return(e=this.viewModel)==null?void 0:e.bookmarks},()=>this._bookmarksInitialized(),St),we(()=>this.editingEnabled,()=>this._toggleSorting(),St)])}destroy(){this._destroySortable(),this._handles.destroy(),this._handles=null,this._editMenu.destroy()}loadDependencies(){return Promise.all([import("./calcite-label.c8cfa339.js"),import("./calcite-switch.5ee08c13.js")])}get _editMenuItems(){var r,n;const{messages:e,_userState:t}=this,i=(n=(r=t==null?void 0:t.editedBookmark)==null?void 0:r.thumbnail)==null?void 0:n.url;return[new k3({label:e==null?void 0:e.menu.refreshThumbnail,iconClass:ot.iconRefresh,clickFunction:()=>this._refreshThumbnail()}),new k3({label:xR.test(i)?e==null?void 0:e.menu.editImageUrl:e==null?void 0:e.menu.useImageUrl,iconClass:ot.iconLink,clickFunction:()=>this._startUseImageUrl()}),i?new k3({label:e==null?void 0:e.menu.removeThumbnail,iconClass:ot.iconRemove,clickFunction:()=>this._removeThumbnail()}):null].filter(Boolean)}get _editMenu(){const{_editMenuItems:e,messages:t,disabled:i}=this,r=this._get("_editMenu");r&&r.destroy();const n=new jDe({disabled:i,iconClass:ot.iconHandleHorizontal,label:t==null?void 0:t.menu.label});return n.items=e,n}get defaultCreateOptions(){return this.viewModel.defaultCreateOptions}set defaultCreateOptions(e){this.viewModel.defaultCreateOptions=e}get defaultEditOptions(){return this.viewModel.defaultEditOptions}set defaultEditOptions(e){this.viewModel.defaultEditOptions=e}get bookmarks(){return this.viewModel.bookmarks}set bookmarks(e){this.viewModel.bookmarks=e}get goToOverride(){return this.viewModel.goToOverride}set goToOverride(e){this.viewModel.goToOverride=e}get label(){var e,t;return(t=(e=this.messages)==null?void 0:e.widgetLabel)!=null?t:""}set label(e){this._overrideIfSome("label",e)}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}castVisibleElements(e){return K(K({},bse),e)}endAddBookmark(){this._userState=null}goTo(e){return this.viewModel.goTo(e)}render(){const{state:e}=this.viewModel,t=e==="loading"?this.renderLoading():this.renderBookmarks();return j("div",{class:this.classes(ot.base,ot.esriWidget,{[ot.esriWidgetDisabled]:this.disabled})},t)}startAddBookmark(){this._userState=new ZO({state:"add"}),this._focusAddInputBox=!0,this.scheduleRender()}renderLoading(){return j("div",{class:ot.loaderContainer,key:"loader",tabIndex:this.disabled?-1:null},j("div",{class:ot.loader}))}renderNoBookmarksContainer(){const{messages:e,disabled:t}=this;return j("div",{class:ot.noBookmarksContainer,key:"no-bookmarks",tabIndex:t?-1:null},j("span",{"aria-hidden":"true",class:this.classes(ot.noBookmarksIcon,ot.widgetIcon)}),j(Va,{level:this.headingLevel,class:this.classes(ot.header,ot.noBookmarksHeader)},e==null?void 0:e.noBookmarksHeading),j("p",{class:ot.noBookmarksDescription},e==null?void 0:e.noBookmarksDescription))}renderAddBookmarkLoading(){var e;return j("div",{key:"adding-bookmark",class:ot.addingBookmark},j("span",{"aria-hidden":"true",class:this.classes(ot.loading,ot.rotating)}),(e=this.messages)==null?void 0:e.addingBookmark)}renderBookmarkItems(e){if(!e)return null;const{_userState:t,editingEnabled:i}=this;return e.map(r=>i&&r&&t&&(t.state==="edit"||t.state==="edit-thumbnail")&&t.bookmark===r?t.state==="edit-thumbnail"?this.renderEditingBookmarkUrl(t.editedBookmark):this.renderEditingBookmark(t.editedBookmark):this.renderBookmark(r)).toArray()}renderBookmarksContainer(e){var h;const{_userState:t,editingEnabled:i,disabled:r}=this,n=(t==null?void 0:t.state)==="add",o=i&&!n?this.renderAddBookmarkButton():null,c=i?n&&t.loading?this.renderAddBookmarkLoading():(t==null?void 0:t.state)==="add"?this.renderAddingBookmark():null:null;return[j("ul",{key:"bookmark-list","aria-label":(h=this.messages)==null?void 0:h.widgetLabel,class:this.classes(ot.bookmarkList,{[ot.bookmarkListSortable]:this.editingEnabled}),afterCreate:this._sortNodeCreated,afterRemoved:this._destroySortable,"data-node-ref":"_sortableNode",bind:this,tabIndex:r?-1:null},this.renderBookmarkItems(e)),o,c]}renderAddBookmarkButton(){var e;return this.visibleElements.addBookmark?j("div",{key:"add-bookmark-item",class:ot.addBookmark},j("button",{class:this.classes(ot.esriButton,ot.esriButtonTertiary,ot.addBookmarkButton),disabled:this.disabled,onclick:this.startAddBookmark,afterCreate:this._storeAddBookmarkButton,afterUpdate:this._storeAddBookmarkButton,"data-node-ref":"_addBookmarkButtonNode",bind:this,type:"button"},j("span",{"aria-hidden":"true",class:this.classes(ot.addBookmarkIcon,ot.iconPlus)}),(e=this.messages)==null?void 0:e.addBookmark)):null}renderBookmarks(){const{bookmarks:e}=this.viewModel,t=e&&e.filter(Boolean),i=t&&t.length,r=i||this.editingEnabled?this.renderBookmarksContainer(t):null;return[i?null:this.renderNoBookmarksContainer(),r]}renderEditContainer(e){const{messagesCommon:t,disabled:i}=this,r=this._getBookmarkTitle(e);return j("div",{class:ot.bookmarkEditButtonContainer,key:"edit-container"},j("button",{disabled:i,title:`${t==null?void 0:t.edit} ${r}`,"aria-label":`${t==null?void 0:t.edit} ${r}`,"data-bookmark":e,onclick:this._showEditBookmarkForm,bind:this,class:ot.bookmarkEditButton,type:"button"},j("span",{"aria-hidden":"true",class:ot.iconEdit})))}renderDragHandle(e){const{messagesCommon:t,disabled:i}=this,r=this._getBookmarkTitle(e),n={[wm]:e.uid};return j("div",K({role:"button",tabIndex:i?-1:0,key:"drag-handle",bind:this,class:ot.bookmarkDragHandle,onkeydown:this._dragHandleKeydown,afterCreate:this._focusDragHandle,afterUpdate:this._focusDragHandle,onblur:this._dragHandleBlur,"aria-pressed":this._selectedSortUid===e.uid?"true":"false","aria-label":`${t==null?void 0:t.dragHandleTitle} ${r}`,title:`${t==null?void 0:t.dragHandleTitle} ${r}`},n),j("span",{"aria-hidden":"true",class:this.classes(ot.bookmarkDragHandleIcon,ot.iconHandle)}))}renderBookmarkImageIcon(){return j("span",{"aria-hidden":"true",class:this.classes(ot.bookmarkIcon,ot.widgetIcon)})}renderBookmarkImage(e){const{visibleElements:t}=this,{thumbnail:i}=e,r=i&&i.url||"";return t.thumbnail&&r?j("img",{src:r,alt:"",class:ot.bookmarkImage}):null}renderBookmarkTimeSwitch(e){const{messages:t,disabled:i}=this,{timeExtent:r}=e,{view:n}=this.viewModel;return n.timeExtent||r?j("calcite-label",{layout:"inline-space-between","disable-spacing":"true"},t.includeTimeExtent,j("calcite-switch",{scale:"s",disabled:i,checked:!!r,onCalciteSwitchChange:o=>this._editIncludeTimeExtent=!!o.detail.switched})):null}renderBookmarkTimeExtent(e){const{visibleElements:t}=this,{timeExtent:i}=e;return i?j("span",{class:ot.timeExtent},[H(i.start)&&j("span",{key:"start-date-group",class:ot.timeExtentGroup},j("span",{key:"start-date",class:ot.timeExtentDate},this._formatDate(i.start)),t.time&&j("span",{key:"start-time",class:ot.timeExtentTime},this._formatTime(i.start))),H(i.end)&&(ce(i.start)||i.start.getTime()!==i.end.getTime())&&j("span",{key:"end-date-group",class:ot.timeExtentGroup},j("span",{key:"end-date",class:ot.timeExtentDate},this._formatDate(i.end)),t.time&&j("span",{key:"end-time",class:ot.timeExtentTime},this._formatTime(i.end)))]):null}renderBookmarkButton(e){const{disabled:t}=this,{timeExtent:i}=e,{abilities:r}=this.viewModel,n=this._getBookmarkTitle(e),o=j("div",{class:ot.bookmarkImageContainer},this.renderBookmarkImage(e)||this.renderBookmarkImageIcon()),c=r.time&&i?j("span",{key:"time-extent",class:ot.bookmarkTimeExtent},this.renderBookmarkTimeExtent(e)):null;return j("button",{disabled:t,key:"bookmark-button",class:ot.bookmarkButton,bind:this,"data-bookmark":e,onclick:this._goToBookmark,type:"button"},o,j("div",{class:ot.bookmarkLabel},j("span",{key:"bookmark-title",class:ot.bookmarkName},n),c))}renderBookmark(e){const{activeBookmark:t}=this.viewModel,i={[ot.bookmarkActive]:t===e},r=this.editingEnabled?this.renderEditContainer(e):null,n={[wm]:e.uid},o=this.editingEnabled?this.renderDragHandle(e):null;return j("li",K({key:e,class:this.classes(ot.bookmark,i)},n),o,this.renderBookmarkButton(e),r)}renderEditingBookmarkName(e){const{messages:t,_userState:i,disabled:r}=this,n=i.validationState==="name-required";return j("label",{class:ot.authoringLabel},t==null?void 0:t.title,n?j("strong",null,t==null?void 0:t.invalidTitle):null,j("input",{required:!0,disabled:r,bind:this,class:this.classes(ot.esriInput,n?ot.authoringInputInvalid:null),type:"text",value:e.name,afterCreate:this._storeEditInput,afterUpdate:this._focusEditInput,"data-bookmark":e,"data-node-ref":"_editInputNode",placeholder:t==null?void 0:t.titlePlaceholder}))}renderEditingBookmarkUrlActions(){const{messagesCommon:e,disabled:t}=this;return j("div",{class:ot.authoringActions},j("input",{type:"button",disabled:t,value:e==null?void 0:e.back,class:this.classes(ot.esriButton,ot.esriButtonTertiary),onclick:this._closeUrlEditBookmarkForm,bind:this}),j("input",{class:ot.esriButton,disabled:t,type:"submit",value:e==null?void 0:e.add}))}renderEditingBookmarkActions(){const{messagesCommon:e,disabled:t}=this,{bookmark:i}=this._userState;return j("div",{class:ot.authoringActions},j("input",{type:"button",disabled:t,value:e==null?void 0:e.delete,class:this.classes(ot.esriButton,ot.esriButtonTertiary,ot.authoringDeleteButton),"data-bookmark":i,onclick:this._deleteBookmark,bind:this}),j("input",{disabled:t,type:"button",value:e==null?void 0:e.cancel,class:this.classes(ot.esriButton,ot.esriButtonTertiary),onclick:this._closeEditBookmarkForm,bind:this}),j("input",{class:ot.esriButton,disabled:t,type:"submit",value:e==null?void 0:e.save}))}renderEditingBookmarkUrlInput(e){var h;const{messages:t,_userState:i,disabled:r}=this,n=(h=e.thumbnail)==null?void 0:h.url,o=xR.test(n)?n:null,c=i.validationState==="absolute-url-required";return j("label",{class:ot.authoringLabel},c?j("strong",null,t==null?void 0:t.invalidImageUrl):null,j("input",{required:!0,disabled:r,bind:this,class:this.classes(ot.esriInput,c?ot.authoringInputInvalid:null),type:"text",value:o,afterCreate:this._storeUrlEditInput,afterUpdate:this._focusUrlEditInput,"data-bookmark":e,"data-node-ref":"_urlEditInputNode",title:t==null?void 0:t.imageUrlTooltip,placeholder:t&&`https://<${t.imageUrlPlaceholder}>`}))}renderEditingBookmarkUrl(e){const t={[wm]:e.uid};return j("li",K({key:"edit-bookmark-url-form",class:ot.authoringCard},t),j("form",{class:ot.authoringForm,disabled:this.disabled,onsubmit:this._editBookmarkUrlSubmit,bind:this},this.renderEditingBookmarkUrlInput(e),this.renderEditingBookmarkUrlActions()))}renderEditingBookmark(e){const t={[wm]:e.uid},{abilities:i}=this.viewModel,r=i.time?j("div",{key:"edit-bookmark-time-container",class:ot.timeExtentContainer},this.renderBookmarkTimeSwitch(e),this._editIncludeTimeExtent&&this.renderBookmarkTimeExtent(e)):null;return j("li",K({key:"edit-bookmark-form",class:ot.authoringCard},t),j("form",{class:ot.authoringForm,disabled:this.disabled,onsubmit:this._editBookmarkSubmit,bind:this},j("div",{class:ot.authoringContainer},j("div",{class:ot.bookmarkImageContainer},this.renderBookmarkImage(e),this._editMenu.render()),this.renderEditingBookmarkName(e)),r,this.renderEditingBookmarkActions()))}renderAddingBookmarkName(){const{_userState:e,messages:t,disabled:i}=this,r=e.validationState==="name-required";return j("label",{class:ot.authoringLabel},t==null?void 0:t.title,r?j("strong",null,t==null?void 0:t.invalidTitle):null,j("input",{required:!0,disabled:i,bind:this,class:this.classes(ot.esriInput,r?ot.authoringInputInvalid:null),type:"text",afterCreate:this._storeAddInput,afterUpdate:this._focusAddInput,"data-node-ref":"_addInputNode",value:"",placeholder:t==null?void 0:t.titlePlaceholder}))}renderAddingBookmarkActions(){const{messagesCommon:e,disabled:t}=this;return j("div",{class:this.classes(ot.authoringActions)},j("input",{type:"button",disabled:t,value:e==null?void 0:e.cancel,class:this.classes(ot.esriButton,ot.esriButtonTertiary,ot.authoringCancelButton),onclick:this._endAddBookmark.bind(this),bind:this}),j("input",{class:ot.esriButton,disabled:t,type:"submit",value:e==null?void 0:e.add}))}renderAddingBookmark(){return j("div",{key:"add-bookmark-form",class:ot.authoringCard},j("form",{class:ot.authoringForm,onsubmit:this._addBookmarkSubmit,bind:this},this.renderAddingBookmarkName(),this.renderAddingBookmarkActions()))}_getBookmarkTitle(e){var t;return e.name||((t=this.messagesCommon)==null?void 0:t.untitled)}_formatDate(e){return e?Pa(e,fg("short-date")):null}_formatTime(e){return e?Pa(e,fg("long-time")):null}_dragHandleBlur(){this._selectedSortUid=null,this.scheduleRender()}_dragHandleKeydown(e){const{_sortableSavedItems:t}=this,i=["ArrowDown","ArrowUp","Escape","Tab"," ","Enter"],r=to(e);if(!i.includes(r))return;const{_sortable:n,_selectedSortUid:o}=this,c=n.toArray(),h=e.target.getAttribute(wm),m=c.indexOf(h);if(Hg(r)){const x=o&&o===h;return this._selectedSortUid=x?null:h,this._sortableSavedItems=x?null:this._sortable.toArray(),void this.scheduleRender()}if(r==="Tab")return this._selectedSortUid=null,void this.scheduleRender();if(r==="Escape"&&t)return e.stopPropagation(),this._selectedSortUid=null,this._updateSortItems(t,n,h),void this.scheduleRender();if(m===-1||!o)return;const b=r==="ArrowUp"?m-1:m+1;b>=c.length||b<=-1||(pje(c,m,b),this._updateSortItems(c,n,h))}_updateSortItems(e,t,i){t.sort(e),this._sortBookmarks(t),this._focusSortUid=i,this._selectedSortUid=i}_focusDragHandle(e){const{_focusSortUid:t}=this;!e||!t||e.getAttribute(wm)===t&&(e.focus(),this._focusSortUid=null)}_toggleSorting(){const{_sortable:e,_sortableNode:t,editingEnabled:i,disabled:r}=this;if(t)if(e)e.option("disabled",r||!i);else{const n=Yt.create(t,{dataIdAttr:wm,handle:`.${ot.bookmarkDragHandle}`,group:dje,disabled:r||!i,onSort:()=>this._sortBookmarks(n)});this._sortable=n}}_sortNodeCreated(e){this._sortableNode=e,this._toggleSorting()}_sortBookmarks(e){const{bookmarks:t}=this.viewModel;if(!t)return;const i=e.toArray();t.sort((r,n)=>{const o=i.indexOf(r.uid),c=i.indexOf(n.uid);return o>c?1:o<c?-1:0})}_destroySortable(){const{_sortable:e}=this;e&&e.destroy(),this._sortable=null}_endAddBookmark(){this._focusAddBookmarkButton=!0,this.endAddBookmark()}_bookmarksInitialized(){const e="bookmarks-init",{_handles:t}=this;t.remove(e),t.add(vr(()=>{var i;return(i=this.viewModel)==null?void 0:i.bookmarks},"change",()=>this._bookmarksChanged()),e)}_bookmarksChanged(){const e="bookmarks-change",{bookmarks:t}=this.viewModel,{_handles:i}=this;i.remove(e);const r=t.map(n=>we(()=>{var o;return[n==null?void 0:n.name,(o=n==null?void 0:n.thumbnail)==null?void 0:o.url]},()=>this.scheduleRender()));i.add(r,e),this.scheduleRender()}_showEditBookmarkForm(e){const t=e.currentTarget["data-bookmark"];this._editIncludeTimeExtent=!!t.timeExtent,this._focusEditInputBox=!0,this._userState=new ZO({bookmark:t,state:"edit"}),this.viewModel.goTo(t),this.scheduleRender()}_closeUrlEditBookmarkForm(){this._focusEditInputBox=!0,this._userState.state="edit"}_closeEditBookmarkForm(){this._userState=null}_addBookmarkSubmit(e){e.preventDefault();const{_addInputNode:t,_userState:i}=this,r=t&&t.value.trim();r?(i.loading=!0,this.viewModel.createBookmark().then(n=>{n.name=r,this.viewModel.bookmarks.add(n),this._endAddBookmark()})):i.validationState="name-required"}async _editBookmarkAndClose(e,t){const{viewModel:i}=this;await i.editBookmark(e,K(K({},i.defaultEditOptions),t)),this._closeEditBookmarkForm()}_editBookmarkSubmit(e){e.preventDefault();const{_editInputNode:t,_userState:i,_editIncludeTimeExtent:r}=this,n=t&&t.value.trim();n?(i.bookmark.name=n,i.bookmark.thumbnail=i.editedBookmark.thumbnail,r||(i.bookmark.timeExtent=null),this._editBookmarkAndClose(i.bookmark,{takeScreenshot:!1,captureTimeExtent:r})):i.validationState="name-required"}_storeAddBookmarkButton(e){this._addBookmarkButtonNode=e,this._focusAddBookmark()}_storeEditInput(e){this._editInputNode=e,this._focusEditInput()}_storeAddInput(e){this._addInputNode=e,this._focusAddInput()}_storeUrlEditInput(e){this._urlEditInputNode=e,this._focusUrlEditInput()}_focusUrlEditInput(){this._urlEditInputNode&&this._focusUrlEditInputBox&&(this._focusUrlEditInputBox=!1,this._urlEditInputNode.focus())}_focusAddInput(){this._addInputNode&&this._focusAddInputBox&&(this._focusAddInputBox=!1,this._addInputNode.focus())}_focusAddBookmark(){this._addBookmarkButtonNode&&this._focusAddBookmarkButton&&(this._focusAddBookmarkButton=!1,this._addBookmarkButtonNode.focus())}_focusEditInput(){this._editInputNode&&this._focusEditInputBox&&(this._focusEditInputBox=!1,this._editInputNode.focus())}_deleteBookmark(e){const t=e.currentTarget["data-bookmark"];this.viewModel.bookmarks.remove(t)}_goToBookmark(e){const t=e.currentTarget["data-bookmark"];this.endAddBookmark(),this._closeEditBookmarkForm(),this.viewModel.goTo(t)}async _refreshThumbnail(){const{_userState:e,_editMenu:t,viewModel:i}=this;e.validationState=void 0,await i.editBookmark(this._userState.editedBookmark,{takeScreenshot:!0,captureViewpoint:!1,captureRotation:!1,captureScale:!1,captureTimeExtent:!1}),t.open=!1,this._focusEditInputBox=!0,this.scheduleRender()}_removeThumbnail(){const{_userState:e,_editMenu:t}=this;e.editedBookmark.thumbnail=null,e.validationState=void 0,t.open=!1,this._focusEditInputBox=!0,this.scheduleRender()}_startUseImageUrl(){this._userState.state="edit-thumbnail",this._editMenu.open=!1,this._focusUrlEditInputBox=!0,this.scheduleRender()}_editBookmarkUrlSubmit(e){e.preventDefault();const{_urlEditInputNode:t,_userState:i}=this,r=t.value;xR.test(r)?(r&&(i.editedBookmark.thumbnail=new Pp({url:r})),this._closeUrlEditBookmarkForm()):i.validationState="absolute-url-required"}};g([w()],jr.prototype,"_editIncludeTimeExtent",void 0),g([w({type:ZO})],jr.prototype,"_userState",void 0),g([w({readOnly:!0})],jr.prototype,"_editMenuItems",null),g([w({readOnly:!0})],jr.prototype,"_editMenu",null),g([w()],jr.prototype,"defaultCreateOptions",null),g([w()],jr.prototype,"defaultEditOptions",null),g([w()],jr.prototype,"bookmarks",null),g([w()],jr.prototype,"disabled",void 0),g([w()],jr.prototype,"editingEnabled",void 0),g([w()],jr.prototype,"headingLevel",void 0),g([w()],jr.prototype,"goToOverride",null),g([w()],jr.prototype,"iconClass",void 0),g([w()],jr.prototype,"label",null),g([w(),ci("esri/widgets/Bookmarks/t9n/Bookmarks")],jr.prototype,"messages",void 0),g([w(),ci("esri/t9n/common")],jr.prototype,"messagesCommon",void 0),g([w(),ci("esri/core/t9n/Units")],jr.prototype,"messagesUnits",void 0),g([w()],jr.prototype,"uiStrings",void 0),g([w()],jr.prototype,"view",null),g([w({type:kne}),n1(["select-bookmark","bookmark-edit","bookmark-select"])],jr.prototype,"viewModel",void 0),g([w()],jr.prototype,"visibleElements",void 0),g([Dt("visibleElements")],jr.prototype,"castVisibleElements",null),g([w()],jr.prototype,"endAddBookmark",null),g([w()],jr.prototype,"startAddBookmark",null),jr=g([te(fje)],jr);const J3=-1;let Ku=class extends Ye{constructor(e){super(e),this._from=null,this._to=null,this._final=null,this._current=[],this._time=0,this.duration=Te("mapview-transitions-duration"),this.effects=[]}set effect(e){if(this._get("effect")!==(e=e||"")){this._set("effect",e);try{this._transitionTo(wse(e))}catch(t){this._transitionTo([]),$e.getLogger(this.declaredClass).warn("Invalid Effect",{effect:e,error:t})}}}get hasEffects(){return this.transitioning||!!this.effects.length}set scale(e){this._updateForScale(e)}get transitioning(){return this._to!==null}canTransitionTo(e){try{return this.scale>0&&_se(this._current,wse(e),this.scale)}catch{return!1}}transitionStep(e,t){this._applyTimeTransition(e),this._updateForScale(t)}endTransitions(){this._applyTimeTransition(this.duration)}_transitionTo(e){this.scale>0&&_se(this._current,e,this.scale)?(this._final=e,this._to=_e(e),yje(this._current,this._to,this.scale),this._from=_e(this._current),this._time=0):(this._from=this._to=this._final=null,this._current=e),this._set("effects",this._current[0]?_e(this._current[0].effects):[])}_applyTimeTransition(e){if(!(this._to&&this._from&&this._current&&this._final))return;this._time+=e;const t=Math.min(1,this._time/this.duration);for(let i=0;i<this._current.length;i++){const r=this._current[i],n=this._from[i],o=this._to[i];r.scale=mje(n.scale,o.scale,t);for(let c=0;c<r.effects.length;c++){const h=r.effects[c],m=n.effects[c],b=o.effects[c];h.interpolate(m,b,t)}}t===1&&(this._current=this._final,this._set("effects",this._current[0]?_e(this._current[0].effects):[]),this._from=this._to=this._final=null)}_updateForScale(e){if(this._set("scale",e),this._current.length===0)return;const t=this._current,i=this._current.length-1;let r,n,o=1;if(t.length===1||e>=t[0].scale)n=r=t[0].effects;else if(e<=t[i].scale)n=r=t[i].effects;else for(let c=0;c<i;c++){const h=t[c],m=t[c+1];if(h.scale>=e&&m.scale<=e){o=(e-h.scale)/(m.scale-h.scale),r=h.effects,n=m.effects;break}}for(let c=0;c<this.effects.length;c++)this.effects[c].interpolate(r[c],n[c],o)}};function wse(e){const t=_7(e)||[];return gje(t)?[{scale:J3,effects:t}]:t}function _se(e,t,i){var r,n,o,c;return!((r=e[0])==null?void 0:r.effects)||!((n=t[0])==null?void 0:n.effects)?!0:!((((o=e[0])==null?void 0:o.scale)===J3||((c=t[0])==null?void 0:c.scale)===J3)&&(e.length>1||t.length>1)&&i<=0)&&kW(e[0].effects,t[0].effects)}function yje(e,t,i){var m,b;const r=e.length>t.length?e:t,n=e.length>t.length?t:e,o=n[n.length-1],c=(m=o==null?void 0:o.scale)!=null?m:i,h=(b=o==null?void 0:o.effects)!=null?b:[];for(let x=n.length;x<r.length;x++)n.push({scale:c,effects:[...h]});for(let x=0;x<r.length;x++)n[x].scale=n[x].scale===J3?i:n[x].scale,r[x].scale=r[x].scale===J3?i:r[x].scale,AW(n[x].effects,r[x].effects)}function mje(e,t,i){return e+(t-e)*i}function gje(e){const t=e[0];return!!t&&"type"in t}g([w()],Ku.prototype,"_to",void 0),g([w()],Ku.prototype,"duration",void 0),g([w({value:""})],Ku.prototype,"effect",null),g([w({readOnly:!0})],Ku.prototype,"effects",void 0),g([w({readOnly:!0})],Ku.prototype,"hasEffects",null),g([w({value:0})],Ku.prototype,"scale",null),g([w({readOnly:!0})],Ku.prototype,"transitioning",null),Ku=g([te("esri.layers.effects.EffectView")],Ku);function xse(e){return ce(e)||e.type==="simple"||e.type==="unique-value"||e.type==="class-breaks"||e.type==="dictionary"||e.type==="heatmap"}function WYe(e,t){if(ce(e))return null;if(!xse(e))return new ue("renderer-conversion-3d:unsupported-renderer",`Unsupported renderer of type '${e.type||e.declaredClass}'`,{renderer:e});switch(e.type){case"simple":return vje(e);case"unique-value":return bje(e,t);case"class-breaks":return wje(e);case"dictionary":case"heatmap":return null}return null}function SR(e,t){if(!t)return null;let i;if(i=Array.isArray(t)?t:[t],i.length>0){const r=i.map(o=>o.details.symbol.type||o.details.symbol.declaredClass).filter(o=>!!o);r.sort();const n=[];return r.forEach((o,c)=>{c!==0&&o===r[c-1]||n.push(o)}),new ue("renderer-conversion-3d:unsupported-symbols",`Renderer contains symbols (${n.join(", ")}) which are not supported in 3D`,{renderer:e,symbolErrors:i})}return null}function vje(e){return SR(e,I1(e.symbol).error)}function bje(e,t){var o;const i=K(K({},M1),t),r=(o=e.uniqueValueInfos)==null?void 0:o.map(c=>I1(c.symbol,i).error).filter(H),n=I1(e.defaultSymbol,i);return n.error&&(r==null||r.unshift(n.error)),SR(e,r)}function wje(e){const t=e.classBreakInfos.map(r=>I1(r.symbol).error).filter(H),i=I1(e.defaultSymbol);return i.error&&t.unshift(i.error),SR(e,t)}const _je=(e,t)=>{const i=e.featuresTilingScheme.getClosestInfoForScale(e.scale).level;return(t==null?void 0:t.levels)?t.levels[i]:null};function xje(e,t){if(!e||!("visualVariables"in e)||!e.visualVariables)return null;const i=e.visualVariables.find(n=>n.type==="size"),r=_je(t,i);return r?new f2({field:i.field,minSize:r[2].size,minDataValue:r[2].value,maxSize:r[3].size,maxDataValue:r[3].value}):null}function Sje(e){return e=e||globalThis.location.hostname,Mje.some(t=>(e==null?void 0:e.match(t))!=null)}function Sse(e,t){return e&&(t=t||globalThis.location.hostname)?t.match(Mse)!=null||t.match($se)!=null?e.replace("static.arcgis.com","staticdev.arcgis.com"):t.match(Ise)!=null||t.match(Ese)!=null?e.replace("static.arcgis.com","staticqa.arcgis.com"):e:e}const Mse=/^devext.arcgis.com$/,Ise=/^qaext.arcgis.com$/,$se=/^[\w-]*\.mapsdevext.arcgis.com$/,Ese=/^[\w-]*\.mapsqa.arcgis.com$/,Mje=[/^([\w-]*\.)?[\w-]*\.zrh-dev-local.esri.com$/,Mse,Ise,/^jsapps.esri.com$/,$se,Ese];function Tse(e,t,i,r){return e.name?e.styleName&&e.styleName==="Esri2DPointSymbolsStyle"?Ije(e,t,r):iK(e,t,r).then(n=>Cse(Yn(n),e.name,t,i,r)):Promise.reject(new ue("symbolstyleutils:style-symbol-reference-name-missing","Missing name in style symbol reference"))}function Cse(e,t,i,r,n){var k,P,F;const o=e.data,c=i&&H(i.portal)?i.portal:nn.getDefault(),h={portal:c,url:mn(e.baseUrl),origin:"portal-item"},m=o.items.find(N=>N.name===t);if(!m){const N=`The symbol name '${t}' could not be found`;return Promise.reject(new ue("symbolstyleutils:symbol-name-not-found",N,{symbolName:t}))}let b=kd(x$e(m,r),h),x=(P=(k=m.thumbnail)==null?void 0:k.href)!=null?P:null;const I=m.thumbnail&&m.thumbnail.imageData;Sje()&&(b=(F=Sse(b))!=null?F:"",x=Sse(x));const E={portal:c,url:mn(vC(b)),origin:"portal-item"};return p8(b,n).then(N=>{const B=r==="cimRef"?rK(N.data):N.data,z=OZ(B,E);if(z&&uc(z)){if(x){const q=kd(x,h);z.thumbnail=new B0({url:q})}else I&&(z.thumbnail=new B0({url:`data:image/png;base64,${I}`}));e.styleUrl?z.styleOrigin=new h_({portal:i.portal,styleUrl:e.styleUrl,name:t}):e.styleName&&(z.styleOrigin=new h_({portal:i.portal,styleName:e.styleName,name:t}))}return z})}function Ije(e,t,i){const r=S$e.replace(/\{SymbolName\}/gi,e.name),n=H(t.portal)?t.portal:nn.getDefault();return p8(r,i).then(o=>{const c=rK(o.data);return OZ(c,{portal:n,url:mn(vC(r)),origin:"portal-item"})})}var $je=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",fetchSymbolFromStyle:Cse,resolveWebStyleSymbol:Tse});const _m=zn.size,G4=zn.maxSize,MR=zn.maxOutlineSize,kse=zn.lineWidth,IR=zn.tallSymbolWidth;function Qv(e){const t=e.outline,i=H(e.material)?e.material.color:null,r=H(i)?i.toHex():null;if(ce(t)||"pattern"in t&&H(t.pattern)&&t.pattern.type==="style"&&t.pattern.style==="none")return e.type==="fill"&&r==="#ffffff"?{color:"#bdc3c7",width:.75}:null;const n=or(t.size)||0;return{color:"rgba("+(H(t.color)?t.color.toRgba():"255,255,255,1")+")",width:Math.min(n,MR),style:"pattern"in t&&H(t.pattern)&&t.pattern.type==="style"?O7(t.pattern.style):null,join:"butt",cap:"patternCap"in t?t.patternCap:"butt"}}function Eje(e,t){const i=t&&t.resource,r=i&&i.href;if(e.thumbnail&&e.thumbnail.url)return Promise.resolve(e.thumbnail.url);if(r&&t.type!=="object")return Promise.resolve(TMe(e,t));const n=_i("esri/images/Legend/legend3dsymboldefault.png");return e.styleOrigin&&(e.styleOrigin.styleName||e.styleOrigin.styleUrl)?Tse(e.styleOrigin,{portal:e.styleOrigin.portal},"webRef").catch(o=>o).then(o=>{var c;return((c=o==null?void 0:o.thumbnail)==null?void 0:c.url)||n}):Promise.resolve(n)}function $R(e,t=1){const i=e.a,r=LP(e),n=r.h,o=r.s/t,c=100-(100-r.v)/t,{r:h,g:m,b}=D2({h:n,s:o,v:c});return[h,m,b,i]}function B4(e){return e.type==="water"?ce(e.color)?null:e.color:ce(e.material)||ce(e.material.color)?null:e.material.color}function ir(e,t=0){const i=B4(e);if(!i){if(e.type==="fill")return null;const n=MMe.r,o=mf(n,t);return[o,o,o,100]}const r=i.toRgba();for(let n=0;n<3;n++)r[n]=mf(r[n],t);return r}async function Ase(e,t){const i=e.style;return i==="none"?null:{type:"pattern",x:0,y:0,src:await SMe(_i(`esri/symbols/patterns/${i}.png`),t.toCss(!0)),width:5,height:5}}function Pse(e){return e.outline?Qv(e):{color:"rgba(0, 0, 0, 1)",width:1.5}}function Lse(e,t){const i=B4(e);if(!i)return null;let r="rgba(";return r+=mf(i.r,t)+",",r+=mf(i.g,t)+",",r+=mf(i.b,t)+",",r+i.a+");"}function ER(e,t){const i=Lse(e,t);return i?"pattern"in e&&H(e.pattern)&&e.pattern.type==="style"&&e.pattern.style==="none"?null:{color:i,width:Math.min(e.size?or(e.size):.75,MR),style:"pattern"in e&&H(e.pattern)&&e.pattern.type==="style"?O7(e.pattern.style):null,cap:"cap"in e?e.cap:null,join:"join"in e?e.join==="miter"?or(2):e.join:null}:{}}function U4(e,t,i){const r=i!=null?.75*i:0;return{type:"linear",x1:r?.25*r:0,y1:r?.5*r:0,x2:r||4,y2:r?.5*r:4,colors:[{color:e,offset:0},{color:t,offset:1}]}}function Tje(e){const t=e.depth,i=e.height,r=e.width;return r!==0&&t!==0&&i!==0&&r===t&&r!=null&&i!=null&&r<i}function Cje(e,t,i){const r=[];if(!e)return r;switch(e.type){case"icon":{const n=0,o=0,c=t,h=t;switch(e.resource&&e.resource.primitive||Dbe){case"circle":r.push({shape:{type:"circle",cx:0,cy:0,r:.5*t},fill:ir(e,0),stroke:Qv(e)});break;case"square":r.push({shape:{type:"path",path:[{command:"M",values:[n,h]},{command:"L",values:[n,o]},{command:"L",values:[c,o]},{command:"L",values:[c,h]},{command:"Z",values:[]}]},fill:ir(e,0),stroke:Qv(e)});break;case"triangle":r.push({shape:{type:"path",path:[{command:"M",values:[n,h]},{command:"L",values:[.5*c,o]},{command:"L",values:[c,h]},{command:"Z",values:[]}]},fill:ir(e,0),stroke:Qv(e)});break;case"cross":r.push({shape:{type:"path",path:[{command:"M",values:[.5*c,o]},{command:"L",values:[.5*c,h]},{command:"M",values:[n,.5*h]},{command:"L",values:[c,.5*h]}]},stroke:Pse(e)});break;case"x":r.push({shape:{type:"path",path:[{command:"M",values:[n,o]},{command:"L",values:[c,h]},{command:"M",values:[c,o]},{command:"L",values:[n,h]}]},stroke:Pse(e)});break;case"kite":r.push({shape:{type:"path",path:[{command:"M",values:[n,.5*h]},{command:"L",values:[.5*c,o]},{command:"L",values:[c,.5*h]},{command:"L",values:[.5*c,h]},{command:"Z",values:[]}]},fill:ir(e,0),stroke:Qv(e)})}break}case"object":switch(e.resource&&e.resource.primitive||bwe){case"cone":{const n=U4(ir(e,0),ir(e,-.6),i?IR:t),o=N6e(t,i);r.push({shape:o[0],fill:n}),r.push({shape:o[1],fill:n});break}case"inverted-cone":{const n=ir(e,0),o=U4(n,ir(e,-.6),t),c=D6e(t);r.push({shape:c[0],fill:o}),r.push({shape:c[1],fill:n});break}case"cube":{const n=R6e(t,i);r.push({shape:n[0],fill:ir(e,0)}),r.push({shape:n[1],fill:ir(e,-.3)}),r.push({shape:n[2],fill:ir(e,-.5)});break}case"cylinder":{const n=U4(ir(e,0),ir(e,-.6),i?IR:t),o=F6e(t,i);r.push({shape:o[0],fill:n}),r.push({shape:o[1],fill:n}),r.push({shape:o[2],fill:ir(e,0)});break}case"diamond":{const n=j6e(t);r.push({shape:n[0],fill:ir(e,-.3)}),r.push({shape:n[1],fill:ir(e,0)}),r.push({shape:n[2],fill:ir(e,-.3)}),r.push({shape:n[3],fill:ir(e,-.7)});break}case"sphere":{const n=U4(ir(e,0),ir(e,-.6));n.x1=0,n.y1=0,n.x2=.25*t,n.y2=.25*t,r.push({shape:{type:"circle",cx:0,cy:0,r:.5*t},fill:n});break}case"tetrahedron":{const n=V6e(t);r.push({shape:n[0],fill:ir(e,-.3)}),r.push({shape:n[1],fill:ir(e,0)}),r.push({shape:n[2],fill:ir(e,-.6)});break}}break}return r}function q4(e){const t=typeof(e==null?void 0:e.size)=="number"?e==null?void 0:e.size:null;return t?or(t):null}function kje(e){return e.type==="icon"?"multiply":"tint"}function Aje(e,t){var I;const i=q4(t),r=(t==null?void 0:t.maxSize)?or(t.maxSize):null,n=(I=t==null?void 0:t.disableUpsampling)!=null?I:!1,o=e.symbolLayers,c=[];let h=0,m=0;const b=o.getItemAt(o.length-1);let x;return b&&b.type==="icon"&&(x=b.size&&or(b.size)),o.forEach(E=>{var F;if(E.type!=="icon"&&E.type!=="object")return;const k=E.type==="icon"?E.size&&or(E.size):0,P=i||k?Math.ceil(Math.min(i||k,r||G4)):_m;if(E&&E.resource&&E.resource.href){const N=Eje(e,E).then(B=>{const z=E.get("material.color"),q=kje(E);return kCe(B,P,z,q,n)}).then(B=>{const z=B.width,q=B.height;return h=Math.max(h,z),m=Math.max(m,q),[{shape:{type:"image",x:0,y:0,width:z,height:q,src:B.url},fill:null,stroke:null}]});c.push(N)}else{let N=P;E.type==="icon"&&x&&i&&(N=P*(k/x));const B=(t==null?void 0:t.symbolConfig)==="tall"||((F=t==null?void 0:t.symbolConfig)==null?void 0:F.isTall)||E.type==="object"&&Tje(E);h=Math.max(h,B?IR:N),m=Math.max(m,N),c.push(Promise.resolve(Cje(E,N,B)))}}),Mr(c).then(E=>{const k=[];return E.forEach(P=>{P.value?k.push(P.value):P.error&&$e.getLogger("esri.symbols.support.previewSymbol3D").warn("error while building swatchInfo!",P.error)}),V2(k,[h,m],{node:t&&t.node,scale:!1,opacity:t&&t.opacity})})}function Pje(e,t){const i=e.symbolLayers,r=[],n=H9(e),o=q4(t),c=(t&&t.maxSize?or(t.maxSize):null)||MR;let h,m=0,b=0;return i.forEach((x,I)=>{if(!x||x.type!=="line"&&x.type!=="path")return;const E=[];switch(x.type){case"line":{const k=ER(x,0);if(ce(k))break;const P=k&&k.width||0;I===0&&(h=P);const F=Math.min(o||P,c),N=I===0?F:o?F*(P/h):F,B=N>kse/2?2*N:kse;b=Math.max(b,N),m=Math.max(m,B),k.width=N,E.push({shape:{type:"path",path:[{command:"M",values:[0,.5*b]},{command:"L",values:[m,.5*b]}]},stroke:k});break}case"path":{const k=Math.min(o||_m,c),P=ir(x,0),F=ir(x,-.2),N=Lse(x,-.4),B=N?{color:N,width:1}:{};if(x.profile==="quad"){const z=x.width,q=x.height,J=P6e(z&&q?z/q:1,q===0,z===0),X=Ce(K({},B),{join:"bevel"});E.push({shape:J[0],fill:F,stroke:X}),E.push({shape:J[1],fill:F,stroke:X}),E.push({shape:J[2],fill:P,stroke:X})}else E.push({shape:AP.pathSymbol3DLayer[0],fill:F,stroke:B}),E.push({shape:AP.pathSymbol3DLayer[1],fill:P,stroke:B});b=Math.max(b,k),m=b}}r.push(E)}),Promise.resolve(V2(r,[m,b],{node:t&&t.node,scale:n,opacity:t&&t.opacity}))}async function Lje(e,t){const i=e.type==="mesh-3d",r=e.symbolLayers,n=q4(t),o=t&&t.maxSize?or(t.maxSize):null,c=n||_m,h=[];let m=0,b=0,x=!1;for(let I=0;I<r.length;I++){const E=r.getItemAt(I),k=[];if(i&&E.type!=="fill")continue;const P=AP.fill[0];switch(E.type){case"fill":{const F=Qv(E),N=Math.min(c,o||G4);m=Math.max(m,N),b=Math.max(b,N),x=!0;let B=ir(E,0);const z="pattern"in E?E.pattern:null,q=B4(E);!i&&H(z)&&z.type==="style"&&z.style!=="solid"&&q&&(B=await Ase(z,q)),k.push({shape:P,fill:B,stroke:F});break}case"line":{const F=ER(E,0);if(ce(F))break;const N={stroke:F,shape:P};m=Math.max(m,_m),b=Math.max(b,_m),k.push(N);break}case"extrude":{const F=K({join:"round",width:1},ER(E,-.4)),N=ir(E,0),B=ir(E,-.2),z=Math.min(c,o||G4),q=L6e(z);F.width=1,k.push({shape:q[0],fill:B,stroke:F}),k.push({shape:q[1],fill:B,stroke:F}),k.push({shape:q[2],fill:N,stroke:F});const J=_m,X=.7*_m+.5*z;m=Math.max(m,J),b=Math.max(b,X);break}case"water":{const F=Yn(B4(E)),N=$R(F),B=$R(F,2),z=$R(F,3),q=O6e();x=!0,k.push({shape:q[0],fill:N}),k.push({shape:q[1],fill:B}),k.push({shape:q[2],fill:z});const J=Math.min(c,o||G4);m=Math.max(m,J),b=Math.max(b,J);break}}h.push(k)}return V2(h,[m,b],{node:t&&t.node,scale:x,opacity:t&&t.opacity})}function Oje(e,t){if(e.symbolLayers.length===0)return Promise.reject(new ue("symbolPreview: renderPreviewHTML3D","No symbolLayers in the symbol."));switch(e.type){case"point-3d":return Aje(e,t);case"line-3d":return Pje(e,t);case"polygon-3d":case"mesh-3d":return Lje(e,t)}return Promise.reject(new ue("symbolPreview: swatchInfo3D","symbol not supported."))}var Rje=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",getPatternDescriptor:Ase,getSizeFromOptions:q4,getSymbolLayerFill:ir,previewSymbol3D:Oje});const Ose={HH:315,HL:45,LL:135,LH:225},Fje={2:[["HL","HH"],["LL","LH"]],3:[["HL","HM","HH"],["ML","MM","MH"],["LL","LM","LH"]],4:[["HL","HM1","HM2","HH"],["M2L","M2M1","M2M2","M2H"],["M1L","M1M1","M1M2","M1H"],["LL","LM1","LM2","LH"]]};function Nje(e){if(!e)return;const{type:t}=e;if(t.includes("3d"))return ir(e.symbolLayers.getItemAt(0));if(t==="simple-line"){const i=H_(e);return i&&i.color}if(e.type==="simple-marker"&&(e.style==="x"||e.style==="cross")){const i=H_(e);return i&&i.color}return xMe(e)}function Dje(e,t){const i=t.HH.label,r=t.LL.label,n=t.HL.label,o=t.LH.label;switch(e){case"HH":default:return{top:i,bottom:r,left:n,right:o};case"HL":return{top:n,bottom:o,left:r,right:i};case"LL":return{top:r,bottom:i,left:o,right:n};case"LH":return{top:o,bottom:n,left:i,right:r}}}function jje(e){const{focus:t,infos:i,numClasses:r}=e,n=Fje[r],o={};i.forEach(h=>{o[h.value]={label:h.label,fill:Nje(h.symbol)}});const c=[];for(let h=0;h<r;h++){const m=[];for(let b=0;b<r;b++){const x=o[n[h][b]];m.push(x.fill)}c.push(m)}return{type:"relationship-ramp",numClasses:r,focus:t,colors:c,labels:Dje(t,o),rotation:Rse(t)}}function Rse(e){let t=Ose[e];return e&&t==null&&(t=Ose.HH),t||0}const TR=30,CR=12,Fse=[255,255,255],Nse=[200,200,200],eb=[128,128,128],Vje=20,zje=5;function Gje(e){return e.declaredClass==="esri.symbols.SimpleMarkerSymbol"}function Bje(e){return e.declaredClass==="esri.symbols.PictureMarkerSymbol"}function Uje(e){return e.declaredClass==="esri.symbols.SimpleLineSymbol"}function qje(e){return e.declaredClass==="esri.symbols.TextSymbol"}function Hje(e,t){const i=e.length-1;return e.map((r,n)=>eJ(r,n,i,t))}async function Wje(e,t,i,r,n,o,c){const h=t.legendOptions,m=h&&h.customValues,b=c||await Kje(e,i),x=!!b,I=!!m,E=t.minSize!=null&&t.maxSize!=null,k=t.stops&&t.stops.length>1,P=!!t.target;if(!x||!I&&!(E||k&&!P))return;const F=H9(b);let N=null,B=null,z=null;B=F&&!k?F9([t.minDataValue,t.maxDataValue]):m||await Xje(t,b,r,n);const q=e==null?void 0:e.authoringInfo,J=(q==null?void 0:q.type)==="univariate-color-size",X=J&&(q==null?void 0:q.univariateTheme)==="above-and-below";if(!B&&k&&(B=t.stops.map(fe=>fe.value),N=t.stops.some(fe=>!!fe.label),e.type==="flow"&&(B=F9(B)),N&&(z=t.stops.map(fe=>fe.label))),F&&(B==null?void 0:B.length)>2&&!X&&(B=[B[0],B[B.length-1]]),!B)return null;J&&(B==null?void 0:B.length)!==5&&(B=Vse({minSize:B[0],maxSize:B[B.length-1]}));const Y=F?Jje(e,B):null,ae=EMe(b),he=N?null:Hje(B,o);return(await Promise.all(B.map(async(fe,ye)=>{const xe=F?Y[ye]:await tb(t,b,fe,r,n);return{value:fe,symbol:tVe(X&&e.type==="class-breaks"?Zje(e,ye):b,xe),label:N?z[ye]:he[ye],size:xe,outlineSize:ae}}))).reverse()}function Jje(e,t){const i=e==null?void 0:e.authoringInfo,r=(i==null?void 0:i.type)==="univariate-color-size";let n=[CR,TR];if(r){const o=t[0],c=t[t.length-1],h=CR,m=TR;n=t.map(b=>h+(b-o)/(c-o)*(m-h))}return r&&(i==null?void 0:i.univariateTheme)==="below"&&n.reverse(),n}function Zje(e,t){const i=e.classBreakInfos,r=i.length,n=r<2||!(t>=2)?i[0].symbol.clone():i[r-1].symbol.clone();return e.visualVariables.some(o=>o.type==="color")&&(n.type.includes("3d")?Dse(n):jse(n)),n}async function Kje(e,t){var n;if(e.type==="flow")return tJ(e,t);if(e.type==="pie-chart")return new Dn({color:null,outline:((n=e.outline)==null?void 0:n.width)?e.outline:new rs});let i=null,r=null;if(e.type==="simple")i=e.symbol;else if(e.type==="class-breaks"){const o=e.classBreakInfos;i=o&&o[0]&&o[0].symbol,r=o.length>1}else if(e.type==="unique-value"){const o=e.uniqueValueInfos;i=o&&o[0]&&o[0].symbol,r=o.length>1}return!i||Yje(i)?null:(i=i.clone(),(t||r)&&(i.type.includes("3d")?Dse(i):jse(i)),i)}function Yje(e){return e?uc(e)?!!e.symbolLayers&&e.symbolLayers.some(t=>t&&t.type==="fill"):e.type.includes("fill"):!1}function Dse(e){e.type==="line-3d"?e.symbolLayers.forEach(t=>{t.material={color:eb}}):e.symbolLayers.forEach(t=>{t.type!=="icon"||t.resource&&t.resource.href?t.material={color:Nse}:(t.material={color:Fse},t.outline={color:eb,size:1.5})})}function jse(e){var i,r;const t=z_();e.type==="cim"?qW(e,new ut(Nse)):e.type.includes("line")?e.color=eb:(e.color=t?eb:Fse,e.type==="simple-marker"&&(e.outline?((r=(i=e.outline)==null?void 0:i.color)==null?void 0:r.toHex())==="#ffffff"&&(e.outline.color=eb):e.outline={color:eb,width:1.5}))}async function Xje(e,t,i,r){const n=(await Promise.resolve().then(function(){return Ey})).getSizeRangeAtScale(e,i,r),o=n&&Vse(n);if(!n&&!o)return;let c=o.map(h=>Qje(h,e,n));c=F9(c);for(let h=1;h<c.length-1;h++){const m=await eVe(e,t,c[h],c[h-1],i,r);m&&(c[h]=m[0],o[h]=m[1])}return c}function Vse(e){const t=e.minSize,i=e.maxSize,r=zje,n=(i-t)/(r-1),o=[];for(let c=0;c<r;c++)o.push(t+n*c);return o}function Qje(e,t,i){const r=i.minSize,n=i.maxSize,o=t.minDataValue,c=t.maxDataValue;let h=null;return e<=r?h=o:e>=n?h=c:h=(e-r)/(n-r)*(c-o)+o,h}async function eVe(e,t,i,r,n,o){const c=await tb(e,t,i,n,o),h=await tb(e,t,r,n,o),m=O9(i),b=m.fractional,x=Vje;let I=m.integer,E=null,k=null;i>0&&i<1&&(E=10**b,I=O9(i*=E).integer);for(let P=I-1;P>=0;P--){const F=10**P;let N=Math.floor(i/F)*F,B=Math.ceil(i/F)*F;E!=null&&(N/=E,B/=E);let z=(N+B)/2;[,z]=F9([N,z,B],{indexes:[1]});const q=await tb(e,t,N,n,o),J=await tb(e,t,B,n,o),X=await tb(e,t,z,n,o),Y=R9(c,q,h,null),ae=R9(c,J,h,null),he=R9(c,X,h,null);let fe=Y.previous<=x,ye=ae.previous<=x;if(fe&&ye&&(Y.previous<=ae.previous?(fe=!0,ye=!1):(ye=!0,fe=!1)),fe?k=[N,q]:ye?k=[B,J]:he.previous<=x&&(k=[z,X]),k)break}return k}async function tb(e,t,i,r,n){const{getSize:o}=await Promise.resolve().then(function(){return Ey});return o(e,i,{scale:r,view:n,shape:t.type==="simple-marker"?t.style:null})}function tVe(e,t){const i=e.clone();if(uc(i))H9(i)||i.symbolLayers.forEach(r=>{r.type!=="fill"&&(r.size=t)});else if(Gje(i))i.size=t;else if(Bje(i)){const r=i.width,n=i.height;i.height=t,i.width=t*(r/n)}else Uje(i)?i.width=t:qje(i)&&i.font&&(i.font.size=t);return i}function iVe(e){const t=2,i=Math.floor(Math.log10(Math.abs(e)))+1,r=i<4||i>6?4:i,n=1e6,o=Math.abs(e)>=n?"compact":"standard";return Jo(e,{notation:o,minimumSignificantDigits:t,maximumSignificantDigits:r})}const rVe="https://utility.arcgis.com/sharing/tools/legend",nVe="esri.layers.ImageryLayer",sVe="esri.layers.ImageryTileLayer",oVe="esri.layers.WCSLayer",H4=/^\s*(return\s+)?\$view\.scale\s*(;)?\s*$/i,aVe=new kt({esriGeometryPoint:"point",esriGeometryMultipoint:"multipoint",esriGeometryPolyline:"polyline",esriGeometryPolygon:"polygon",esriGeometryMultiPatch:"multipatch"}),zse={u1:[0,1],u2:[0,3],u4:[0,15],u8:[0,255],s8:[-128,127],u16:[0,65535],s16:[-32768,32767],u32:[0,4294967295],s32:[-2147483648,2147483647],f32:[-34e38,34e38],f64:[-Number.MAX_VALUE,Number.MAX_VALUE]},W4=new Dn({size:6,outline:{color:[128,128,128,.5],width:.5}}),lVe=new ea({style:"solid"});function kR(e){return e.type==="flow"}function Gse(e){return e.type==="vector-field"}function Bse(e){return e.type==="raster-colormap"}function Use(e){return e.type==="raster-stretch"}function qse(e){return e.type==="raster-shaded-relief"}function ib(e){return e.declaredClass==="esri.renderers.SimpleRenderer"}function rb(e){return e.declaredClass==="esri.renderers.ClassBreaksRenderer"}function J4(e){return e.declaredClass==="esri.renderers.UniqueValueRenderer"}function Hse(e){return e.declaredClass==="esri.renderers.HeatmapRenderer"}function cVe(e){return AR(e)||PR(e)||LR(e)||uVe(e)}function uVe(e){return e.declaredClass==="esri.renderers.PointCloudRGBRenderer"}function AR(e){return e.declaredClass==="esri.renderers.PointCloudClassBreaksRenderer"}function PR(e){return e.declaredClass==="esri.renderers.PointCloudStretchRenderer"}function LR(e){return e.declaredClass==="esri.renderers.PointCloudUniqueValueRenderer"}function Wse(e){return e.declaredClass==="esri.renderers.DotDensityRenderer"}function Jse(e){return e.declaredClass==="esri.renderers.PieChartRenderer"}function hVe(e,t){return ib(e)||rb(e)||J4(e)||Hse(e)||Wse(e)||Jse(e)?t.type==="2d"||xse(e):Use(e)||Bse(e)||qse(e)||AR(e)||PR(e)||LR(e)||Gse(e)||kR(e)}function pVe(e){return e.declaredClass==="esri.layers.BuildingSceneLayer"}function Zse(e){return e.declaredClass==="esri.layers.SubtypeGroupLayer"}function dVe(e){return e.declaredClass==="esri.layers.VoxelLayer"}function fVe(e){return e.declaredClass==="esri.layers.WMSLayer"}function yVe(e){return e.declaredClass==="esri.layers.WMTSLayer"}function Kse(e){return e.declaredClass==="esri.layers.MapImageLayer"}function mVe(e){return e.declaredClass==="esri.layers.TileLayer"}function gVe(e){return e.declaredClass==="esri.layers.FeatureLayer"}function nb(e){return e.declaredClass===nVe}function Z4(e){return e.declaredClass===sVe}function vVe(e){return e.declaredClass===oVe}function bVe(e){return e.type==="stretch-ramp"}function wVe(e){var t;return((t="authoringInfo"in e&&(e==null?void 0:e.authoringInfo))==null?void 0:t.type)==="univariate-color-size"}function _Ve(e){const t="authoringInfo"in e&&(e==null?void 0:e.authoringInfo);return(t==null?void 0:t.type)==="univariate-color-size"&&(t==null?void 0:t.univariateTheme)==="above-and-below"}const xVe=new Dn({style:"path",path:"M10,5 L5,0 0,5 M5,0 L5,15",size:15,outline:{width:1,color:[85,85,85,1]}});let sb={},Wn=class extends Ye{constructor(e){super(e),this._handles=new Ti,this._hasColorRamp=!1,this._hasOpacityRamp=!1,this._hasSizeRamp=!1,this._webStyleSymbolCache=new Map,this._dotDensityUrlCache=new Map,this._scaleDrivenSizeVariable=null,this._hasClusterSizeVariable=!1,this.children=new Xe,this.layerView=null,this.layer=null,this.legendElements=[],this.parent=null,this.hideLayersNotInCurrentView=!1,this.keepCacheOnDestroy=!1,this.respectLayerVisibility=!0,this.sublayerIds=[],this.title=null,this.view=null}initialize(){const e=()=>this.notifyChange("ready");this._handles.add([vr(()=>this.children,"change",t=>{const{added:i,removed:r}=t,n=this._handles;i.forEach(o=>{const c=`activeLayerInfo-ready-watcher-${o.layer.uid}`;n.add(we(()=>o.ready,e,St),c)}),r.forEach(o=>n.remove(o.layer.uid)),e()})]),this.keepCacheOnDestroy||(sb={})}destroy(){this._handles.destroy(),this._handles=null,this._webStyleSymbolCache=null,this._dotDensityUrlCache=null,this._scaleDrivenSizeVariable=null,this.keepCacheOnDestroy||(sb=null)}get effectList(){const e=this.layer;let t=null;return"effect"in e&&e.effect&&(t=new Ku,t.effect=e.effect,t.endTransitions(),t.scale=this.scale),t}get opacity(){var n;const e=this.layer.opacity,t=(n=this.parent)==null?void 0:n.opacity,i=this.layer.parent,r=i&&"uid"in i?this._getParentLayerOpacity(i):null;return t!=null?t*e:r!=null?r*e:e}get ready(){return this.layer===null||(this.children.length>0?this._isGroupActive():this.legendElements.length>0)}get scale(){return this.view&&this.view.scale}get isScaleDriven(){const e=this.layer;if(e===null)return!1;if("effect"in e&&e.effect&&Array.isArray(e.effect))return!0;if("featureReduction"in e&&e.featureReduction){if(e.featureReduction.type==="cluster")return!0;if(e.featureReduction.type==="binning"&&"renderer"in e.featureReduction&&e.featureReduction.renderer)return this._isRendererScaleDriven(e.featureReduction.renderer)}return"renderer"in e&&e.renderer?this._isRendererScaleDriven(e.renderer):this._isLayerScaleDriven(this.layer)}get version(){return this._get("version")+1}async buildLegendElementsForFeatureCollections(e){if(!(!this.hideLayersNotInCurrentView||await this._isLayerInCurrentView()))return this.legendElements=[],void this.notifyChange("ready");const t=Array.from(e,i=>{if(gVe(i))return this._getRendererLegendElements(i.renderer,{title:i.title});if(i.featureSet&&i.featureSet.features.length){const r=i.layerDefinition,n=r&&r.drawingInfo,o=n&&E$e(n.renderer),c=aVe.read(r.geometryType);return o?this._getRendererLegendElements(o,{title:i.name,geometryType:c}):($e.getLogger(this.declaredClass).warn("drawingInfo not available!"),null)}return null});try{const i=[];await Mr(t).then(r=>{r.forEach(({value:n})=>n&&i.push(...n))}),this.legendElements=i,this.notifyChange("ready")}catch(i){$e.getLogger(this.declaredClass).warn("error while building legend for layer!",i)}}async buildLegendElementsForRenderer(e){try{const t=!this.hideLayersNotInCurrentView||await this._isLayerInCurrentView();this.legendElements=t?await this._getRendererLegendElements(e):[],this.notifyChange("ready")}catch(t){$e.getLogger(this.declaredClass).warn("error while building legend for layer!",t)}}async buildLegendElementsForFeatureReduction(e){try{const t=!this.hideLayersNotInCurrentView||await this._isLayerInCurrentView();this.legendElements=t?await this._getLegendElementsForFeatureReduction(e):[],this.notifyChange("ready")}catch(t){$e.getLogger(this.declaredClass).warn("error while building legend for layer!",t)}}async buildLegendElementsForTools(){var t,i;const e=this.layer;if(dVe(e))this._constructLegendElementsForVoxellayer();else if(yVe(e))this._constructLegendElementsForWMTSlayer();else if(fVe(e))await this._constructLegendElementsForWMSSublayers();else if(pVe(e))await this._constructLegendElementsForBuildingSceneLayer();else if(Kse(e)||mVe(e)||Zse(e))await this._constructLegendElementsForSublayers();else{this._handles.remove("imageryLayers-watcher");let r="default";nb(e)&&(r=(((t=e==null?void 0:e.renderingRule)==null?void 0:t.functionName)||"default")+"_"+(((i=e.bandIds)==null?void 0:i.length)?e.bandIds.join(""):"###")),await this._getLegendLayers(`${e.uid}-${r}`).then(async n=>{this.legendElements=[],this.notifyChange("ready");const o=n.map(async c=>{if(nb(e)||Z4(e)){const m=we(()=>["renderingRule"in e&&e.renderingRule,e.bandIds],()=>hw(async()=>{sb.default=null,e.renderer?await this.buildLegendElementsForRenderer(e.renderer):await this.buildLegendElementsForTools()})());this._handles.add(m,"imageryLayers-watcher")}const h=this._generateSymbolTableElementForLegendLayer(c);h&&h.infos.length&&(nb(e)&&(h.title=e.title),this.legendElements.push(h)),this.notifyChange("ready")});await Mr(o)}).catch(n=>{$e.getLogger(this.declaredClass).warn("Request to server for legend has failed!",n)})}}async _isLayerInCurrentView(){const e=this.layer,t=this.layerView,i=t&&"createQuery"in t&&"queryFeatureCount"in t;if(!i&&!(t&&"createQuery"in e&&"queryFeatureCount"in e))return!0;await Ch(()=>!t.updating);const r=i?"createQuery"in t&&t.createQuery():"createQuery"in e&&e.createQuery();return r.geometry=this.view.extent,(i?"queryFeatureCount"in t&&await t.queryFeatureCount(r):"queryFeatureCount"in e&&await e.queryFeatureCount(r))!==0}_getParentLayerOpacity(e){let t=1;const i=e.parent;return i&&"uid"in i&&(t=this._getParentLayerOpacity(i)),e.opacity*t}_isGroupActive(){const e=this.children;return!!e.length&&e.some(t=>t.ready)}_isRendererScaleDriven(e){if(e.type==="dot-density")return!0;const t="valueExpression"in e&&e.valueExpression;if(H4.test(t))return!0;const i="visualVariables"in e&&e.visualVariables;return!!i&&i.some(r=>this._isScaleDrivenSizeVariable(r))}_isScaleDrivenSizeVariable(e){if(e&&e.type!=="size")return!1;const t=e,i=t.minSize,r=t.maxSize;return typeof i=="object"&&i?this._isScaleDrivenSizeVariable(i):typeof r=="object"&&r?this._isScaleDrivenSizeVariable(r):!!t.expression||H4.test(t.valueExpression)}_isLayerScaleDriven(e){if("minScale"in e&&e.minScale>0||"maxScale"in e&&e.maxScale>0)return!0;if("sublayers"in e&&e.sublayers)return e.sublayers.some(i=>this._isLayerScaleDriven(i));const t=e.parent;if(e.loaded===!1&&t&&Kse(t)&&"source"in e&&e.source&&e.source.type==="map-layer"){for(const i of t.sourceJSON.layers)if(i.id===e.source.mapLayerId&&(i.minScale>0||i.maxScale>0))return!0}return!1}async _constructLegendElementsForVoxellayer(){var o;this.legendElements=[],this._handles.remove("voxel-style-watcher"),this._handles.remove("voxel-current-variable");const e=this.layer;this._handles.add(we(()=>e.currentVariableId,()=>this._constructLegendElementsForVoxellayer()),"voxel-current-variable"),this._handles.add(we(()=>e.getVariableStyles(),()=>this._constructLegendElementsForVoxellayer()),"voxel-style-watcher");const t=Ht(e.getVariableStyle(null)),i=[];if(t){if((o=t.uniqueValues)==null?void 0:o.length){const c=[];t.uniqueValues.forEach(h=>{h.enabled&&c.push({label:h.label||`${h.value}`,value:h.value,symbol:new ea({color:h.color,outline:null})})}),c.length&&i.push({type:"symbol-table",title:t.label,infos:c})}else if(t.transferFunction){const{colorStops:c,stretchRange:h}=t.transferFunction,m=c.toArray().reverse(),b=h.map((I,E)=>`${E===0?XW:QW} ${iVe(I)}`).reverse(),x=m.map(I=>({color:I.color,value:null,label:null}));x[0].label=b[0],x[x.length-1].label=b[1],i.push({type:"color-ramp",title:t.label,infos:x,preview:zy(m.map(I=>I.color))})}}const r=e.opacity,n=i.reduce((c,h)=>c.concat(this._getAllInfos(h)),[]).filter(c=>!!(c==null?void 0:c.symbol)).map(c=>this._getSymbolPreview(c,r));await Mr(n),this.legendElements=i,this.notifyChange("ready")}_constructLegendElementsForWMTSlayer(){this.legendElements=[],this._handles.remove("wmts-activeLayer-watcher");const e=this.layer.activeLayer;if(this._handles.add(we(()=>{const{layer:t}=this;return t&&"activeLayer"in t&&t.activeLayer},()=>this._constructLegendElementsForWMTSlayer()),"wmts-activeLayer-watcher"),e.styleId&&e.styles){let t=null;e.styles.some(i=>e.styleId===i.id&&(t=i.legendUrl,!0)),t&&(this.legendElements=[{type:"symbol-table",title:e.title,infos:[{src:t,opacity:this.opacity}]}])}this.notifyChange("ready")}async _constructLegendElementsForWMSSublayers(){this.legendElements=[],this._handles.remove("wms-sublayers-watcher");const e=this.layer;let t=null;(e.customParameters||e.customLayerParameters)&&(t=K(K({},e.customParameters),e.customLayerParameters)),this._handles.add(we(()=>{const{layer:i}=this;return i&&"sublayers"in i&&i.sublayers},()=>this._constructLegendElementsForWMSSublayers()),"wms-sublayers-watcher"),this.legendElements=await this._generateLegendElementsForWMSSublayers(e.sublayers,t),this.notifyChange("ready")}async _generateLegendElementsForWMSSublayers(e,t){const i=[];this._handles.add(e.on("change",()=>this._constructLegendElementsForWMSSublayers()),"wms-sublayers-watcher");const r=e.toArray();for(const n of r){const o=we(()=>[n.title,n.visible,n.legendEnabled],()=>this._constructLegendElementsForWMSSublayers());if(this._handles.add(o,"wms-sublayers-watcher"),!this.respectLayerVisibility||n.visible&&n.legendEnabled){const c=await this._generateSymbolTableElementForWMSSublayer(n,t);c&&c.infos.length&&i.unshift(c)}}return i}async _generateSymbolTableElementForWMSSublayer(e,t){if(!e.legendUrl&&e.sublayers){const i=(await this._generateLegendElementsForWMSSublayers(e.sublayers,t)).filter(r=>r);return{type:"symbol-table",title:e.title,infos:i}}return this._generateSymbolTableElementForLegendUrl(e,t)}async _generateSymbolTableElementForLegendUrl(e,t){var c;let i=e.legendUrl;if(!i)return;const r={type:"symbol-table",title:e.title||e.name||e.id&&e.id+"",infos:[]};t&&(i=I5(i,t));let n=null;const o=(c=e.layer)==null?void 0:c.opacity;try{n=(await Nt(i,{responseType:"image"})).data,n&&(n.style.opacity=o)}catch{}return r.infos.push({src:i,preview:n,opacity:o}),r}_getLegendLayers(e,t){const i=sb&&sb[e];return i?Promise.resolve(i):this._legendRequest(t).then(r=>{const n=r.layers;return sb[e]=n,n})}_legendRequest(e){const t=this.layer;let i={f:"json",dynamicLayers:e};if(nb(t)){const n=t.exportImageServiceParameters.renderingRule;if(n&&(i.renderingRule=JSON.stringify(n.rasterFunctionDefinition||n.toJSON())),t.bandIds&&(i.bandIds=t.bandIds.join()),t.raster||t.viewId||t.customParameters){const{raster:o,viewId:c,customParameters:h}=t;i=K(K({raster:o,viewId:c},i),h)}}let r=t.url.replace(/(\/)+$/,"");if("version"in t&&t.version>=10.01){const n=r.indexOf("?");n>-1?r=r.substring(0,n)+"/legend"+r.substring(n):r+="/legend"}else{const n=r.toLowerCase().indexOf("/rest/"),o=r.substring(0,n)+r.substring(n+5,r.length);r=rVe+"?soapUrl="+encodeURI(o)+"&returnbytes=true"}return Nt(r,{query:i}).then(n=>n.data)}async _constructLegendElementsForBuildingSceneLayer(){this.legendElements=[],this._handles.remove("sublayers-watcher");const e=this.layer;this._handles.add(we(()=>e.sublayers,()=>this._constructLegendElementsForBuildingSceneLayer()),"sublayers-watcher");try{this.legendElements=await this._generateLegendElementsForBuildingSublayers(e.sublayers,this.opacity),this.notifyChange("ready")}catch(t){$e.getLogger(this.declaredClass).warn("Request to server for legend has failed!",t)}}async _generateLegendElementsForBuildingSublayers(e,t){let i=[];this._handles.add(e.on("change",()=>this._constructLegendElementsForBuildingSceneLayer()),"sublayers-watcher");const r=e.toArray();for(const n of r){const o=we(()=>["renderer"in n&&n.renderer,n.opacity,n.title,n.visible],()=>this._constructLegendElementsForBuildingSceneLayer());if(this._handles.add(o,"sublayers-watcher"),!this.respectLayerVisibility||n.visible){const c=n&&n.opacity!=null?n.opacity:null,h=c!=null?c*t:t;if(n.type==="building-group"){const m={type:"symbol-table",title:n.title,infos:[]},b=await this._generateLegendElementsForBuildingSublayers(n.sublayers,h);m.infos.push(...b),i=[m,...i]}else n.renderer&&(i=[...await this._getRendererLegendElements(n.renderer,{title:n.title,opacity:h,sublayer:n}),...i])}}return i.filter(n=>!!n&&(!("infos"in n)||n.infos.length>0))}async _constructLegendElementsForSublayers(){this.legendElements=[],this._handles.remove("sublayers-watcher");const e=this.layer;this._handles.add(we(()=>e.sublayers,()=>this._constructLegendElementsForSublayers),"sublayers-watcher");try{this.legendElements=await this._generateLegendElementsForSublayers(e.sublayers,this.opacity),this.notifyChange("ready")}catch(t){$e.getLogger(this.declaredClass).warn("Request to server for legend has failed!",t)}}async _generateLegendElementsForSublayers(e,t,i){const r=this.layer;let n=[];this._handles.add(e.on("change",()=>this._constructLegendElementsForSublayers()),"sublayers-watcher");let o=e.toArray();!i&&this.sublayerIds&&this.sublayerIds.length&&(o=this.sublayerIds.map(c=>r.findSublayerById(c)).filter(Boolean));for(const c of o){const h=we(()=>[c.renderer,c.opacity,c.title,c.visible,c.legendEnabled],()=>this._constructLegendElementsForSublayers());if(this._handles.add(h,"sublayers-watcher"),!this.respectLayerVisibility||c.visible&&c.legendEnabled&&this._isSublayerInScale(c)){const m=c&&c.opacity!=null?c.opacity:null,b=m!=null?m*t:t,x=!!Zse(r)||c.originIdOf("renderer")>ct.SERVICE;if(c.renderer&&!c.sublayers&&x)await c.load(),n=[...await this._getRendererLegendElements(c.renderer,{title:c.title,opacity:b,sublayer:c}),...n];else{const I=await this._generateSymbolTableElementForSublayer(c,b,i);I&&n.unshift(I)}}}return n.filter(c=>!!c&&(!("infos"in c)||c.infos.length>0))}async _generateSymbolTableElementForSublayer(e,t,i){if(!i){i=new Map;const n=this.layer,o=e.source;let c=null;if(!(!o||o.type==="map-layer"&&o.mapLayerId===e.id&&(!o.gdbVersion||o.gdbVersion===("gdbVersion"in n&&n.gdbVersion)))||e.originIdOf("renderer")>ct.SERVICE||e.originIdOf("labelingInfo")>ct.SERVICE||e.originIdOf("labelsVisible")>ct.SERVICE){const m=new ba({layer:this.layer});c=m.hasDynamicLayers?m.dynamicLayers:null,m.destroy()}const h=c||`${n.uid}-default`;(await this._getLegendLayers(h,c)).forEach(m=>i.set(m.layerId,m))}const r=i.get(e.id);if((!r||(r==null?void 0:r.subLayerIds)&&r.defaultVisibility)&&e.sublayers){const n=await this._generateLegendElementsForSublayers(e.sublayers,t,i);return{type:"symbol-table",title:e.title,infos:n}}return this._generateSymbolTableElementForLegendLayer(r,e,t)}_generateSymbolTableElementForLegendLayer(e,t,i){var h;if(!e||!e.legend||this.respectLayerVisibility&&!this._isLegendLayerInScale(e,t))return null;const r=t==null?void 0:t.renderer;let n=(t==null?void 0:t.title)||e.layerName;if(r&&(!t||(t==null?void 0:t.originIdOf("renderer"))>ct.SERVICE)){const m=(t==null?void 0:t.title)||this._getRendererTitle(r,t);m&&(n&&typeof m!="string"&&"title"in m&&(m.title=n),n=m)}const o={type:"symbol-table",title:n,legendType:e.legendType?e.legendType:null,infos:[]},c=t?this._sanitizeLegendForSublayer(e.legend.slice(),t):e.legend;return((h=e.legendGroups)==null?void 0:h.length)>0?e.legendGroups.forEach(m=>{var x;const b={type:"symbol-table",title:m.heading,legendType:e.legendType?e.legendType:null,infos:this._generateSymbolTableElementInfosForLegendLayer(c.filter(I=>I.groupId===m.id),e.layerId,i)};((x=b.infos)==null?void 0:x.length)>0&&o.infos.push(b)}):o.infos=this._generateSymbolTableElementInfosForLegendLayer(c,e.layerId,i),o.infos.length>0?o:null}_generateSymbolTableElementInfosForLegendLayer(e,t,i){return e.map(r=>{let n=r.url;if(r.imageData&&r.imageData.length>0)n=`data:image/png;base64,${r.imageData}`;else{if(n.indexOf("http")===0)return null;n=_B(`${this.layer.url}/${t}/images/${n}`)}return{label:r.label,src:n,opacity:i!=null?i:this.opacity,width:r.width,height:r.height}}).filter(r=>!!r)}_isSublayerInScale(e){const t=e.minScale||0,i=e.maxScale||0;return!(t>0&&t<this.scale||i>this.scale)}_isLegendLayerInScale(e,t){const i=t||this.layer;let r=null,n=null,o=!0;return!i.minScale&&i.minScale!==0||!i.maxScale&&i.maxScale!==0?(e.minScale===0&&i.tileInfo&&(r=i.tileInfo.lods[0].scale),e.maxScale===0&&i.tileInfo&&(n=i.tileInfo.lods[i.tileInfo.lods.length-1].scale)):(r=Math.min(i.minScale,e.minScale)||i.minScale||e.minScale,n=Math.max(i.maxScale,e.maxScale)),(r>0&&r<this.scale||n>this.scale)&&(o=!1),o}_sanitizeLegendForSublayer(e,t){if("version"in this.layer&&this.layer.version<10.1||e.length===0)return e;const i=t.renderer,r=e.some(c=>c.values);let n=null,o=null;return r&&e.some((c,h)=>(c.values||(n=h,o=c,o.label||(o.label="others")),o!=null)),i?i.type==="unique-value"?o&&(e.splice(n,1),e.push(o)):i.type==="class-breaks"&&(o&&e.splice(n,1),e.reverse(),o&&e.push(o)):o&&(e.splice(n,1),e.push(o)),e}async _getRendererLegendElements(e,t={}){if(!hVe(e,this.view))return $e.getLogger(this.declaredClass).warn(`Renderer of type '${e.type}' not supported!`),[];if(cVe(e))return this._constructPointCloudRendererLegendElements(e,t);if(Wse(e))return this._constructDotDensityRendererLegendElements(e);const i=await this._loadRenderer(e);return Jse(i)?this._constructPieChartRendererLegendElements(i):this._constructRendererLegendElements(i,t)}async _getLegendElementsForFeatureReduction(e){let t=null;return e.type==="binning"?t=e.renderer:e.type==="cluster"&&(t=this._getClusterRenderer(e)),t?this._getRendererLegendElements(t):[]}_getPointCloudRendererTitle(e){return e.legendOptions&&e.legendOptions.title||e.field}_constructPointCloudRendererLegendElements(e,t={}){const i=t.title,r=[];let n=null,o=null;if(AR(e))n={type:"symbol-table",title:i||this._getPointCloudRendererTitle(e),infos:[]},e.colorClassBreakInfos.forEach(h=>{n.infos.unshift({label:h.label||h.minValue+" - "+h.maxValue,value:[h.minValue,h.maxValue],symbol:this._getAppliedCloneSymbol(W4,h.color)})});else if(PR(e)){const h=e.stops;let m=null;if(h.length&&(h.length===1&&(m=h[0].color),!m)){const x=h[0].value,I=h[h.length-1].value;x!=null&&I!=null&&(m=rJ(x+(I-x)/2,h))}n={type:"symbol-table",title:null,infos:[{label:null,value:null,symbol:this._getAppliedCloneSymbol(W4,m||W4.color)}]};const b=HMe(e.stops);o={type:"color-ramp",title:i||this._getPointCloudRendererTitle(e),infos:b,preview:zy(b.map(x=>x.color))}}else LR(e)&&(n={type:"symbol-table",title:i||this._getPointCloudRendererTitle(e),infos:[]},e.colorUniqueValueInfos.forEach(h=>{n.infos.push({label:h.label||h.values.join(", "),value:h.values.join(", "),symbol:this._getAppliedCloneSymbol(W4,h.color)})}));n&&n.infos.length&&r.push(n),o&&o.infos.length&&r.push(o);const c=r.reduce((h,m)=>h.concat(m.infos),[]).filter(h=>!!h.symbol).map(h=>this._getSymbolPreview(h,this.opacity,{symbolConfig:{applyColorModulation:!!e.colorModulation}}));return Mr(c).then(()=>r)}_getElementInfoForDotDensity(e,t){var E;const{backgroundColor:i,outline:r,dotSize:n}=e,o=(E=this.effectList)==null?void 0:E.effects.map(k=>k.toJSON()),c=U9(o),h=n+"-"+t+"-"+i+"-"+(r&&JSON.stringify(r.toJSON()))+"-"+c,m=this._dotDensityUrlCache,b=m.has(h)?m.get(h):ACe(e,t);m.set(h,b);const x={shape:{type:"image",x:0,y:0,width:b.width,height:b.height,src:b.src},fill:null,stroke:null,offset:[0,0]},I=V2([[x]],[b.width,b.height],{effectView:this.effectList});return{opacity:1,src:b.src,preview:I,width:b.width,height:b.height}}_constructDotDensityRendererLegendElements(e){const t=e.calculateDotValue(this.view.scale),i=e.legendOptions&&e.legendOptions.unit,r={type:"symbol-table",title:{value:t&&Math.round(t),unit:i||""},infos:[]};return e.attributes.forEach(n=>{const o=this._getElementInfoForDotDensity(e,n.color);o.label=n.label||n.valueExpressionTitle||n.field,r.infos.push(o)}),Promise.resolve([r])}async _constructPieChartRendererLegendElements(e){var m,b,x,I;const t=this.layer.opacity,i=[],r="Others",n=e.outline;e.attributes.forEach(E=>{const k=new Dn({color:E.color,outline:n}),P=E.label||E.valueExpressionTitle||E.field;i.push({label:P,symbol:k})});const o=i.length?[...i]:[];if(((m=e.othersCategory)==null?void 0:m.color)&&((b=e.othersCategory)==null?void 0:b.threshold)!==0){const E=new Dn({color:e.othersCategory.color,outline:n});i.push({label:e.othersCategory.label||r,symbol:E})}if((x=e.defaultColor)==null?void 0:x.a){const E=new Dn({color:e.defaultColor,outline:n});i.push({label:e.defaultLabel,symbol:E})}const c=await this._getVisualVariableLegendElements(e,this.layer)||[];if(i.length){c.unshift({type:"symbol-table",title:null,infos:i});const E=o.filter(P=>P.label!==r).map(P=>P.symbol.color).filter(Boolean),k=PCe(E,{holePercentage:e.holePercentage,backgroundColor:(I=e.backgroundFillSymbol)==null?void 0:I.color,effectList:this.effectList,outline:n});c.unshift({type:"pie-chart-ramp",title:this._getRendererTitle(e,this.layer),infos:i,preview:k})}const h=c.reduce((E,k)=>E.concat(this._getAllInfos(k)),[]).filter(E=>!!(E==null?void 0:E.symbol)&&!(E==null?void 0:E.preview)).map(E=>this._getSymbolPreview(E,t,{effectList:this.effectList}));return await Mr(h),c}async _constructRendererLegendElements(e,t={}){const{title:i,sublayer:r}=t,n=r||this.layer;this._hasColorRamp=!1,this._hasOpacityRamp=!1,this._hasSizeRamp=!1,this._scaleDrivenSizeVariable=null;const o=await this._getVisualVariableLegendElements(e,n)||[],c={type:"symbol-table",title:i||this._getRendererTitle(e,n),infos:[]};let h=null,m=!1;const b=new Set;if(kR(e)&&!this._hasSizeRamp){const F=await tJ(e);c.infos.push({label:null,symbol:F})}else if(wVe(e)){let F=i;const N=_Ve(e)?"univariate-above-and-below-ramp":"univariate-color-size-ramp",B=o.findIndex(Y=>Y.type==="color-ramp"),z=B!==-1?o.splice(B,1)[0]:null,q=o.findIndex(Y=>Y.type==="size-ramp"),J=q!==-1?o.splice(q,1)[0]:null,X=[];z&&(F=z.title,X.push(z)),J&&(F=J.title,X.push(J)),X.length>0&&o.push({type:N,title:F,infos:X})}else if(Hse(e)){const F=nJ(e);o.push({type:"heatmap-ramp",title:i||this._getRendererTitle(e,n),infos:F,preview:zy(F.map(N=>N.color),{effectList:this.effectList})})}else if(J4(e)){const F=e&&e.authoringInfo;if(F&&F.type==="relationship"){const{focus:N,numClasses:B,field1:z,field2:q}=F;if(B&&z&&q){const J=[z,q];let X=Rse(N)||0;for(const ae of J){const{field:he,normalizationField:fe,label:ye}=ae,xe=ye||{field:this._getFieldAlias(he,n),normField:fe&&this._getFieldAlias(fe,n)},Se=xVe.clone();Se.angle=X,c.infos.push({label:xe,symbol:Se}),b.add(Se),X+=90}const Y=jje({focus:N,numClasses:B,infos:e.uniqueValueInfos});o.unshift(Y)}}else if(nb(this.layer)||Z4(this.layer))e.uniqueValueInfos.forEach(N=>{N.symbol&&c.infos.push({label:N.label||N.value,value:N.value,symbol:N.symbol})});else{const{field:N,field2:B,field3:z,fieldDelimiter:q,valueExpression:J}=e,X=!(!N&&!J||!B&&!z),Y=[];if(e.uniqueValueGroups.forEach(ae=>{const he={type:"symbol-table",title:ae.heading,infos:[]};ae.classes.forEach(fe=>{const{symbol:ye,values:xe}=fe;if(ye){const Se=[],Ae=[];for(const st of xe){const{value:et,value2:He,value3:Et}=st,Gt=[],pi=[];(N||J)&&(Gt.push(et),pi.push(this._getDomainName(N,et,n))),B&&(Gt.push(He),pi.push(this._getDomainName(B,He,n))),z&&(Gt.push(Et),pi.push(this._getDomainName(z,Et,n))),Se.push(X?Gt.join(q||""):Gt[0]),Ae.push(pi.join(" - "))}const Oe=Se.join(", ");let bt=fe.label;if(!bt){const st=Ae.filter(Boolean);bt=st.length?st.join(", "):Oe}he.infos.push({label:bt,value:Oe,symbol:ye})}}),he.infos.length&&Y.push(he)}),Y.length){const ae=Y[0];Y.length===1&&"title"in ae&&!ae.title?c.infos.push(...ae.infos):c.infos.push(...Y)}}e.defaultSymbol&&(c.infos.push({label:e.defaultLabel||"others",symbol:e.defaultSymbol}),m=!0)}else if(rb(e))h=this._isUnclassedRenderer(e),(!h||!this._hasSizeRamp)&&(e.classBreakInfos.forEach(F=>{F.symbol&&c.infos.unshift({label:F.label||(h?null:F.minValue+" - "+F.maxValue),value:[F.minValue,F.maxValue],symbol:F.symbol})}),h&&(c.title=null),this._updateInfosforClassedSizeRenderer(e,c.infos)),e.defaultSymbol&&!h&&(c.infos.push({label:e.defaultLabel||"others",symbol:e.defaultSymbol}),m=!0);else if(Use(e))if(Z4(this.layer)||vVe(this.layer)){const F=this._constructTileImageryStretchRendererElements(e);bVe(F)?o.push(F):c.infos=F}else{const F=this.layer;let N,B;e.statistics&&e.statistics.length&&(N=e.statistics[0].min!=null?e.statistics[0].min:e.statistics[0][0],B=e.statistics[0].max!=null?e.statistics[0].max:e.statistics[0][1]);let z=[];const q=Ht(F.renderingRule?await F.generateRasterInfo(F.renderingRule):F.serviceRasterInfo),J=q.keyProperties.BandProperties,X=zse[F.rasterInfo.pixelType.toLowerCase()];q.bandCount===1||F.bandIds&&F.bandIds.length===1?(N=N!=null?N:q.statistics?q.statistics[F.bandIds[0]].min:X[0],B=B!=null?B:q.statistics?q.statistics[F.bandIds[0]].max:X[1],N||B?o.push(this._getStretchLegendElements(e,{min:N,max:B})):this._getServerSideLegend()):q.bandCount>=3?J&&J.length>=q.bandCount?F.bandIds&&F.bandIds.length===3?(z=F.bandIds.map(Y=>J[Y].BandName),c.infos=this._createSymbolTableElementMultiBand(z)):F.format==="lerc"?(z=[0,1,2].map(Y=>J[Y].BandName),c.infos=this._createSymbolTableElementMultiBand(z)):this._getServerSideLegend():F.format==="lerc"?(z=["band1","band2","band3"],c.infos=this._createSymbolTableElementMultiBand(z)):this._getServerSideLegend():this._getServerSideLegend()}else if(Bse(e))e.colormapInfos.forEach(F=>{c.infos.push({label:F.label,value:F.value,symbol:this._getAppliedCloneSymbol(lVe,F.color)})});else if(ib(e)){let F=e.symbol;switch(t.geometryType){case"point":F="pointSymbol"in n&&n.pointSymbol;break;case"polyline":F="lineSymbol"in n&&n.lineSymbol;break;case"polygon":F="polygonSymbol"in n&&n.polygonSymbol}const N=this._hasClusterSizeVariable&&this._getClusterSymbol()||!this._hasSizeRamp;e.symbol&&N&&c.infos.push({label:e.label,symbol:F})}else if(Gse(e)){e.outputUnit&&(this.title="("+e.toJSON().outputUnit+")"),c.title=e.attributeField;const F=e.getClassBreakInfos();(F==null?void 0:F.length)?F.forEach(N=>{c.infos.push({label:N.minValue+" - "+N.maxValue,symbol:N.symbol})}):c.infos.push({label:e.attributeField,symbol:e.getDefaultSymbol()})}else qse(e)&&o.push(this._getStretchLegendElements(e,{min:0,max:255}));const x=e.defaultSymbol;!x||m||ib(e)||h&&!this._hasColorRamp&&!this._hasSizeRamp&&!this._hasOpacityRamp||o.push({type:"symbol-table",infos:[{label:e.defaultLabel||"others",symbol:x}]}),c.infos.length&&o.unshift(c);const I=t.opacity==null?this.opacity:t.opacity,E=this._isTallSymbol("visualVariables"in e&&e.visualVariables),k=nb(this.layer)||Z4(this.layer),P=o.reduce((F,N)=>F.concat(this._getAllInfos(N)),[]).filter(F=>!!(F==null?void 0:F.symbol)).map(F=>this._getSymbolPreview(F,I,{isDefault:F.symbol===x,applyScaleDrivenSize:!b.has(F.symbol),symbolConfig:{isTall:E,isSquareFill:k},effectList:b.has(F.symbol)?null:this.effectList}));return e=null,await Mr(P),o}_getServerSideLegend(){setTimeout(()=>this.buildLegendElementsForTools(),0)}_getAllInfos(e){const t=e==null?void 0:e.infos;return t?t.reduce((i,r)=>i.concat(this._getAllInfos(r)),[]):[e]}_constructTileImageryStretchRendererElements(e){var x,I;const t=this.layer,i=t.rasterInfo,r=i.bandCount||e.statistics.length;let n,o,c=[];const h=i.keyProperties&&i.keyProperties.BandProperties,m=((x=e==null?void 0:e.statistics)==null?void 0:x.length)?e.statistics:i==null?void 0:i.statistics;if(m)n=m[0].min!==void 0?m[0].min:m[0][0],o=m[0].max||m[0][1];else{const E=zse[t.rasterInfo.pixelType.toLowerCase()];n=E[0],o=E[1]}if(t.hasStandardTime()&&(n=t.getStandardTimeValue(n),o=t.getStandardTimeValue(o)),i.bandCount===1||((I=t.bandIds)==null?void 0:I.length)===1)return this._getStretchLegendElements(e,{min:n,max:o});function b(E){var P;const k=(((P=t==null?void 0:t.bandIds)==null?void 0:P.length)?t.bandIds:Array.from(Array(Math.min(i.bandCount,3)).keys())).map(F=>E&&E[F]&&E[F].BandName||"band"+(F+1));return k.length<3?k.push(k[1]):k.length>3&&k.splice(3),k}return c=h&&h.length>=r?b(h):b(),this._createSymbolTableElementMultiBand(c)}_getStretchLegendElements(e,t){const i=e.colorRamp,r=JMe(i,t);return{type:"stretch-ramp",title:"",infos:r,preview:zy(r.map(n=>n.color))}}_getClusterSymbol(){var r;const e=this.layer,t="featureReduction"in e&&e.featureReduction,i=t&&"symbol"in t&&t.renderer;return i&&((r=i==null?void 0:i.authoringInfo)==null?void 0:r.isAutoGenerated)!==!0?null:t&&"symbol"in t&&t.symbol}async _getSizeLegendElement(e,t,i,r){return{type:"size-ramp",title:this._hasClusterSizeVariable?this._getClusterTitle(t):e,infos:await Wje(i,t,await F7(i),this.scale,this.view.type,r,this._hasClusterSizeVariable?this._getClusterSymbol():null)}}_createSymbolTableElementMultiBand(e){const t=[],i=["red","green","blue"];return e.forEach((r,n)=>{var o;t.push({label:{colorName:i[n],bandName:r},src:BMe[n],opacity:(o=this.opacity)!=null?o:1})}),t}_updateInfosforClassedSizeRenderer(e,t){const i=e.authoringInfo&&e.authoringInfo.type==="class-breaks-size",r=e.classBreakInfos.some(n=>H9(n.symbol));if(i&&r){const n=TR,o=CR,c=e.classBreakInfos.length,h=(n-o)/(c>1?c-1:c);t.forEach((m,b)=>{m.size=n-h*b})}}_isTallSymbol(e){let t=!1,i=!1;if(e)for(let r=0;r<e.length&&(!t||!i);r++){const n=e[r];n.type==="size"&&(n.axis==="height"&&(t=!0),n.axis==="width-and-depth"&&(i=!0))}return t&&i}async _getSymbolPreview(e,t,i){let r=!(i==null?void 0:i.isDefault)&&e.size==null&&this._hasSizeRamp?$n(zn.size):e.size;if(this._scaleDrivenSizeVariable&&(i==null?void 0:i.applyScaleDrivenSize)){const{getSize:n}=await Promise.resolve().then(function(){return Ey});r=n(this._scaleDrivenSizeVariable,null,{view:this.view.type,scale:this.scale,shape:e.symbol.type==="simple-marker"?e.symbol.style:null})}return mX(e.symbol,{size:r,opacity:t,scale:!1,symbolConfig:i==null?void 0:i.symbolConfig,effectView:i==null?void 0:i.effectList}).then(n=>(e.preview=n,e)).catch(()=>(e.preview=null,e))}_getClusterRenderer(e){var n,o;this._hasClusterSizeVariable=!1;const t="renderer"in this.layer&&this.layer.renderer,i=((n=e.renderer)==null?void 0:n.clone())||(t==null?void 0:t.clone()),r=Ht(xje(this.layerView._effectiveRenderer,this.view));if(r&&"visualVariables"in i&&!((o=i.visualVariables)==null?void 0:o.some(h=>h.type==="size"&&h.target!=="outline"&&!H4.test(h.valueExpression)))){if("clusterMinSize"in e&&"clusterMaxSize"in e){const{clusterMinSize:m,clusterMaxSize:b}=e;r.legendOptions=new xZ({showLegend:m!==b})}const h=i.visualVariables||[];i.visualVariables=h.concat([r]),this._hasClusterSizeVariable=!0}return i}async _loadRenderer(e){const t=[],i=e.clone(),r=await F7(i);if(rb(i)||J4(i)){const n=(i.classBreakInfos||i.uniqueValueInfos).map(o=>this._fetchSymbol(o.symbol,r).then(c=>{o.symbol=c}).catch(()=>{o.symbol=null}));Array.prototype.push.apply(t,n)}return t.push(this._fetchSymbol(i.symbol||i.defaultSymbol,i.defaultSymbol?null:r).then(n=>{this._applySymbolToRenderer(i,n,ib(i))}).catch(()=>{this._applySymbolToRenderer(i,null,ib(i))})),Mr(t).then(()=>i)}_applySymbolToRenderer(e,t,i){i?e.symbol=t:e.defaultSymbol=t}async _fetchSymbol(e,t){if(!e)throw new Error;if(e.type==="web-style"){const i=this._webStyleSymbolCache;try{const r=await(this.view.type==="2d"?e.fetchCIMSymbol({cache:i}):e.fetchSymbol({cache:i}));return this._getAppliedCloneSymbol(r,t)}catch{throw $e.getLogger(this.declaredClass).warn("Fetching web-style failed!"),new Error}}return this._getAppliedCloneSymbol(e,t)}_getAppliedCloneSymbol(e,t){if(!e||!t)return e;const i=e.clone(),r=t&&t.toRgba();return i.type.includes("3d")?this._applyColorTo3dSymbol(i,r):i.type==="cim"?qW(i,t):i.color&&(i.color=new ut(r||i.color)),i}_applyColorTo3dSymbol(e,t){t&&e.symbolLayers.forEach(i=>{i&&(i.material||(i.material={}),i.material.color=new ut(t))})}async _getVisualVariableLegendElements(e,t){if(!("visualVariables"in e)||!e.visualVariables||e.type==="vector-field")return null;const i=e.visualVariables,r=[],n=[],o=[];for(const x of i)x.type==="color"?r.push(x):x.type==="size"?n.push(x):x.type==="opacity"&&o.push(x);const c=[...r,...n,...o];let h,m;if(r.length===0&&rb(e)&&e.classBreakInfos&&e.classBreakInfos.length===1){const x=e.classBreakInfos[0];h=x&&x.symbol}if(r.length===0&&ib(e)&&(h=e.symbol),h)if(h.type.includes("3d")){const x=h.symbolLayers.getItemAt(0);x.type==="water"?H(x.color)&&(m=x.color):H(x.material)&&H(x.material.color)&&(m=x.material.color)}else h.url||(m=h.color);const b=this.effectList;return(await Promise.all(c.map(async x=>{if(!x.legendOptions||x.legendOptions.showLegend!==!1){const I=kR(e)?x.field:this._getRampTitle(x,t);let E=null;const k="getField"in t&&t.getField&&t.getField(x.field),P=k&&Yge(k);if(x.type==="color"){const F=await N7(x,null,P);E={type:"color-ramp",title:I,infos:F,preview:zy(F.map(N=>N.color),{effectList:b})},this._hasColorRamp||(this._hasColorRamp=!(E.infos==null||!E.infos.length))}else if(x.type==="size"&&x.target!=="outline")H4.test(x.valueExpression)?this._hasClusterSizeVariable||(this._scaleDrivenSizeVariable=x):(E=await this._getSizeLegendElement(I,x,e,P),this._hasSizeRamp||(this._hasSizeRamp=!(E.infos==null||!E.infos.length)));else if(x.type==="opacity"){const F=await N7(x,m,P);E={type:"opacity-ramp",title:I,infos:F,preview:zy(F.map(N=>N.color),{effectList:b})},this._hasOpacityRamp||(this._hasOpacityRamp=!(E.infos==null||!E.infos.length))}return E&&E.infos?E:null}}))).filter(x=>!!x)}_getDomainName(e,t,i){if(e&&typeof e!="function"){const r="getField"in i&&i.getField&&i.getField(e),n=r&&"getFieldDomain"in i&&i.getFieldDomain?i.getFieldDomain(r.name):null;return n&&n.type==="coded-value"?n.getName(t):null}return null}_getClusterTitle(e){const t=this.layer,i=e.field;if("featureReduction"in t&&t.featureReduction&&t.featureReduction.type==="cluster"){const r=t.featureReduction,n="popupTemplate"in r&&r.popupTemplate,o=n&&n.fieldInfos;if(o){for(const c of o)if(c.fieldName===i)return i==="cluster_count"?c.label||{showCount:!0}:c.label}}return{showCount:!0}}_getRampTitle(e,t){let i=e.field,r=e.normalizationField,n=!1,o=!1,c=!1,h=null;i=typeof i=="function"?null:i,r=typeof r=="function"?null:r;const m=e.legendOptions&&e.legendOptions.title;if(m!=null)h=m;else if(e.valueExpressionTitle)h=e.valueExpressionTitle;else{if("renderer"in t&&t.renderer&&"authoringInfo"in t.renderer&&t.renderer.authoringInfo&&t.renderer.authoringInfo.visualVariables){const b=t.renderer.authoringInfo.visualVariables;for(let x=0;x<b.length;x++){const I=b[x];if(I.type==="color"){if(I.style==="ratio"){n=!0;break}if(I.style==="percent"){o=!0;break}if(I.style==="percent-of-total"){c=!0;break}}}}h={field:i&&this._getFieldAlias(i,t),normField:r&&this._getFieldAlias(r,t),ratio:n,ratioPercent:o,ratioPercentTotal:c}}return h}_getRendererTitle(e,t){const i=e;if(i.legendOptions&&i.legendOptions.title)return i.legendOptions.title;if(i.valueExpressionTitle)return i.valueExpressionTitle;let r=i.field,n=null,o=null;if(rb(i)&&(n=i.normalizationField,o=i.normalizationType==="percent-of-total"),r=typeof r=="function"?null:r,n=typeof n=="function"?null:n,J4(i)){const{field2:h,field3:m,fieldDelimiter:b}=i;let x=r&&this._getFieldAlias(r,t);return h&&(x=`<${x}>${b}<${this._getFieldAlias(h,t)}>`,m&&(x=`${x}${b}<${this._getFieldAlias(m,t)}>`)),x}let c=null;return(r||n)&&(c={field:r&&this._getFieldAlias(r,t),normField:n&&this._getFieldAlias(n,t),normByPct:o}),c}_getFieldAlias(e,t){const i="popupTemplate"in t&&t.popupTemplate,r=i&&i.fieldInfos;let n=null;r&&r.some(x=>e===x.fieldName&&(n=x,!0));let o=null;"getField"in t&&t.getField?o=t.getField(e):"fieldsIndex"in t&&t.fieldsIndex&&(o=t.fieldsIndex.get(e));let c=null;const h="featureReduction"in t&&t.featureReduction;h&&(!n&&"popupTemplate"in h&&h.popupTemplate&&h.popupTemplate.fieldInfos&&h.popupTemplate.fieldInfos.some(x=>{var I;return(e==null?void 0:e.toLowerCase())===((I=x.fieldName)==null?void 0:I.toLowerCase())&&(n=x,!0)}),"fields"in h&&h.fields&&(c=h.fields.find(x=>{var I;return((I=x.name)==null?void 0:I.toLowerCase())===(e==null?void 0:e.toLowerCase())})));const m=n||o||c;let b=null;return m&&(b=(n==null?void 0:n.label)||(o==null?void 0:o.alias)||(c==null?void 0:c.alias)||"name"in m&&m.name||"fieldName"in m&&m.fieldName),b}_isUnclassedRenderer(e){const t=e.visualVariables;let i=!1;return rb(e)&&e.classBreakInfos&&e.classBreakInfos.length===1&&t&&(i=e.field?t.some(r=>!(!r||e.field!==r.field||(e.normalizationField||r.normalizationField)&&e.normalizationField!==r.normalizationField)):!!t.length),i}};g([w()],Wn.prototype,"children",void 0),g([w({readOnly:!0})],Wn.prototype,"effectList",null),g([w()],Wn.prototype,"layerView",void 0),g([w()],Wn.prototype,"layer",void 0),g([w()],Wn.prototype,"legendElements",void 0),g([w({readOnly:!0})],Wn.prototype,"opacity",null),g([w()],Wn.prototype,"parent",void 0),g([w({readOnly:!0,dependsOn:[]})],Wn.prototype,"ready",null),g([w()],Wn.prototype,"hideLayersNotInCurrentView",void 0),g([w()],Wn.prototype,"keepCacheOnDestroy",void 0),g([w()],Wn.prototype,"respectLayerVisibility",void 0),g([w({readOnly:!0})],Wn.prototype,"scale",null),g([w()],Wn.prototype,"sublayerIds",void 0),g([w({readOnly:!0})],Wn.prototype,"isScaleDriven",null),g([w()],Wn.prototype,"title",void 0),g([w({readOnly:!0,dependsOn:["ready"],value:0})],Wn.prototype,"version",null),g([w()],Wn.prototype,"view",void 0),Wn=g([te("esri.widgets.Legend.support.ActiveLayerInfo")],Wn);const Yse=Wn,xm={state:"state",view:"view",allLayerViews:"all-layer-views",legendProperties:"legend-properties"},Xse=Xe.ofType(Yse),SVe=["esri.layers.BuildingSceneLayer","esri.layers.CSVLayer","esri.layers.FeatureLayer","esri.layers.GeoJSONLayer","esri.layers.GeoRSSLayer","esri.layers.GroupLayer","esri.layers.HeatmapLayer","esri.layers.ImageryLayer","esri.layers.ImageryTileLayer","esri.layers.MapImageLayer","esri.layers.OGCFeatureLayer","esri.layers.PointCloudLayer","esri.layers.StreamLayer","esri.layers.SceneLayer","esri.layers.SubtypeGroupLayer","esri.layers.TileLayer","esri.layers.VoxelLayer","esri.layers.WFSLayer","esri.layers.WMSLayer","esri.layers.WMTSLayer","esri.layers.WCSLayer"],Qse="view.basemapView.baseLayerViews",eoe="view.groundView.layerViews",toe="view.basemapView.referenceLayerViews",MVe=[Qse,eoe,"view.layerViews",toe];let zl=class extends Ye{constructor(e){super(e),this._handles=new Ti,this._layerViewByLayerId={},this._layerInfosByLayerViewId={},this._activeLayerInfosByLayerViewId={},this._activeLayerInfosWithNoParent=new Xe,this.activeLayerInfos=new Xse,this.basemapLegendVisible=!1,this.groundLegendVisible=!1,this.hideLayersNotInCurrentView=!1,this.keepCacheOnDestroy=!1,this.respectLayerVisibility=!0,this.layerInfos=[],this.view=null}initialize(){this._handles.add(we(()=>this.view,()=>this._viewHandles(),St),xm.view),this._handles.add(US(()=>this._refresh()))}destroy(){this._destroyViewActiveLayerInfos(),this._handles.destroy(),this._handles=null,this.view=null}get state(){return this.get("view.ready")?"ready":"disabled"}_viewHandles(){this._handles.remove(xm.state),this.view&&this._handles.add(we(()=>this.state,()=>this._stateHandles(),St),xm.state)}_stateHandles(){this._resetAll(),this.state==="ready"&&this._watchPropertiesAndAllLayerViews()}_resetAll(){this._handles.remove([xm.allLayerViews,xm.legendProperties]),this._destroyViewActiveLayerInfos(),this.activeLayerInfos.removeAll()}_destroyViewActiveLayerInfos(){Object.keys(this._activeLayerInfosByLayerViewId).forEach(this._destroyViewActiveLayerInfo,this)}_destroyViewActiveLayerInfo(e){this._handles.remove(e);const t=this._activeLayerInfosByLayerViewId[e];delete this._activeLayerInfosByLayerViewId[e],t&&t.parent&&t.parent.children.remove(t)}_watchPropertiesAndAllLayerViews(){const{allLayerViews:e}=this.view;e.length&&this._refresh(),this._handles.add(e.on("change",t=>this._allLayerViewsChangeHandle(t)),xm.allLayerViews),this._handles.add(we(()=>[this.layerInfos,this.basemapLegendVisible,this.groundLegendVisible],()=>this._propertiesChangeHandle()),xm.legendProperties)}_allLayerViewsChangeHandle(e){e.removed.forEach(t=>this._destroyViewActiveLayerInfo(t.uid)),this._refresh()}_propertiesChangeHandle(){this._destroyViewActiveLayerInfos(),this._refresh()}_refresh(){this._layerInfosByLayerViewId={},this.activeLayerInfos.removeAll(),this._generateLayerViews().filter(this._filterLayerViewsByLayerInfos,this).filter(this._isLayerViewSupported,this).forEach(this._generateActiveLayerInfo,this),this._sortActiveLayerInfos(this.activeLayerInfos)}_sortActiveLayerInfos(e){if(e.length<2)return;const t=[];e.forEach(r=>{if(!r.parent){const n=r.layer.parent,o=n&&"uid"in n&&this._layerViewByLayerId[n.uid],c=o&&this._activeLayerInfosByLayerViewId[o.uid];c&&e.includes(c)&&(t.push(r),r.parent=c,c.children.add(r),this._sortActiveLayerInfos(c.children))}}),e.removeMany(t);const i={};this.view.allLayerViews.forEach((r,n)=>i[r.layer.uid]=n),e.sort((r,n)=>{const o=i[r.layer.uid]||0;return(i[n.layer.uid]||0)-o})}_generateLayerViews(){const e=[];return MVe.filter(this._filterLayerViews,this).map(this.get,this).filter(t=>t!=null).forEach(this._collectLayerViews("layerViews",e)),e}_filterLayerViews(e){const t=!this.basemapLegendVisible&&(e===Qse||e===toe),i=!this.groundLegendVisible&&e===eoe;return!t&&!i}_collectLayerViews(e,t){const i=r=>(r&&r.forEach(n=>{t.push(n),i(n[e])}),t);return i}_filterLayerViewsByLayerInfos(e){const t=this.layerInfos;return!t||!t.length||t.some(i=>this._hasLayerInfo(i,e))}_hasLayerInfo(e,t){const i=this._isLayerUIDMatching(e.layer,t.layer.uid);return i&&(this._layerInfosByLayerViewId[t.uid]=e),i}_isLayerUIDMatching(e,t){return e&&(e.uid===t||this._hasLayerUID(e.layers,t))}_hasLayerUID(e,t){return e&&e.some(i=>this._isLayerUIDMatching(i,t))}_isLayerViewSupported(e){return!!SVe.includes(e.layer.declaredClass)&&(this._layerViewByLayerId[e.layer.uid]=e,!0)}_generateActiveLayerInfo(e){this._isLayerActive(e)?this._buildActiveLayerInfo(e):(this._handles.remove(e.uid),this._handles.add(we(()=>{var t;return[e.legendEnabled,(t=e.layer)==null?void 0:t.legendEnabled]},()=>this._layerActiveHandle(e)),e.uid))}_layerActiveHandle(e){this._isLayerActive(e)&&(this._handles.remove(e.uid),this._buildActiveLayerInfo(e))}_isLayerActive(e){return!this.respectLayerVisibility||e.legendEnabled&&e.get("layer.legendEnabled")}_buildActiveLayerInfo(e){var c;const t=e.layer,i=e.uid,r=this._layerInfosByLayerViewId[i];let n=this._activeLayerInfosByLayerViewId[i];if(!n){const h=r&&r.title!==void 0&&r.layer.uid===t.uid;n=new Yse({layer:t,layerView:e,title:h?r.title:t.title,view:this.view,respectLayerVisibility:this.respectLayerVisibility,hideLayersNotInCurrentView:this.hideLayersNotInCurrentView,keepCacheOnDestroy:this.keepCacheOnDestroy,sublayerIds:r&&r.sublayerIds||[]}),this._activeLayerInfosByLayerViewId[i]=n}const o=t.parent&&"uid"in t.parent&&this._layerViewByLayerId[(c=t.parent)==null?void 0:c.uid];if(n.parent=this._activeLayerInfosByLayerViewId[o==null?void 0:o.uid],!this._handles.has(i)){const h=[we(()=>t.title,m=>this._titleHandle(m,n)),we(()=>[t.opacity,"renderer"in t&&t.renderer,"pointSymbol"in t&&t.pointSymbol,"lineSymbol"in t&&t.lineSymbol,"polygonSymbol"in t&&t.polygonSymbol],()=>this._constructLegendElements(n)),os(()=>{var m;return((m=this.view)==null?void 0:m.stationary)===!0},()=>this._scaleHandle(n),St),we(()=>e._effectiveRenderer,()=>this._constructLegendElements(n)),we(()=>"effect"in t&&t.effect,()=>this._constructLegendElements(n))];if(this.respectLayerVisibility){const m=we(()=>e.legendEnabled,x=>this._legendEnabledHandle(x,n)),b=we(()=>t.legendEnabled,x=>this._legendEnabledHandle(x,n));h.push(m,b)}this._handles.add(h,i)}n.isScaleDriven||this._constructLegendElements(n),this._addActiveLayerInfo(n)}_titleHandle(e,t){t.title=e,this._constructLegendElements(t)}_legendEnabledHandle(e,t){e?this._addActiveLayerInfo(t):this._removeActiveLayerInfo(t)}_scaleHandle(e){(e.isScaleDriven||e.hideLayersNotInCurrentView)&&this._constructLegendElements(e)}_addActiveLayerInfo(e){var r;const{layerView:t,layer:i}=e;if(this._isLayerActive(t)&&!this.activeLayerInfos.includes(e)){const n=e.parent;if(n)n.children.includes(e)||n.children.push(e),this._sortActiveLayerInfos(n.children);else{const o=(r=this.layerInfos)==null?void 0:r.some(c=>c.layer.uid===i.uid);i.parent&&"uid"in i.parent&&!o?this._activeLayerInfosWithNoParent.add(e):(this.activeLayerInfos.add(e),this._sortActiveLayerInfos(this.activeLayerInfos))}if(this._activeLayerInfosWithNoParent.length){const o=[];this._activeLayerInfosWithNoParent.forEach(c=>{const h=c.layer.parent,m=h&&"uid"in h&&this._layerViewByLayerId[h==null?void 0:h.uid],b=this._activeLayerInfosByLayerViewId[m==null?void 0:m.uid];b&&(o.push(c),c.parent=b)}),o.length&&(this._activeLayerInfosWithNoParent.removeMany(o),o.forEach(c=>this._addActiveLayerInfo(c)))}}}_removeActiveLayerInfo(e){const t=e.parent;t?t.children.remove(e):this.activeLayerInfos.remove(e)}_constructLegendElements(e){const t=e.layer;"featureCollections"in t&&t.featureCollections?e.buildLegendElementsForFeatureCollections(t.featureCollections):"featureReduction"in t&&t.featureReduction&&"renderer"in t.featureReduction&&(t.featureReduction.type==="binning"||t.featureReduction.type==="cluster")?e.buildLegendElementsForFeatureReduction(t.featureReduction):"renderer"in t&&t.renderer&&!("sublayers"in t)?e.buildLegendElementsForRenderer(t.renderer):"url"in t&&t.url?e.buildLegendElementsForTools():e.children.forEach(i=>this._constructLegendElements(i))}};g([w({type:Xse})],zl.prototype,"activeLayerInfos",void 0),g([w()],zl.prototype,"basemapLegendVisible",void 0),g([w()],zl.prototype,"groundLegendVisible",void 0),g([w()],zl.prototype,"hideLayersNotInCurrentView",void 0),g([w()],zl.prototype,"keepCacheOnDestroy",void 0),g([w()],zl.prototype,"respectLayerVisibility",void 0),g([w()],zl.prototype,"layerInfos",void 0),g([w({readOnly:!0})],zl.prototype,"state",null),g([w()],zl.prototype,"view",void 0),zl=g([te("esri.widgets.Legend.LegendViewModel")],zl);const IVe=zl,$Ve="http://www.w3.org/2000/svg",dr={diamondContainer:"esri-relationship-ramp--diamond__container",diamondLeftCol:"esri-relationship-ramp--diamond__left-column",diamondRightCol:"esri-relationship-ramp--diamond__right-column",diamondMidCol:"esri-relationship-ramp--diamond__middle-column",diamondMidColLabel:"esri-relationship-ramp--diamond__middle-column--label",diamondMidColRamp:"esri-relationship-ramp--diamond__middle-column--ramp",squareTable:"esri-relationship-ramp--square__table",squareTableRow:"esri-relationship-ramp--square__table-row",squareTableCell:"esri-relationship-ramp--square__table-cell",squareTableLabel:"esri-relationship-ramp--square__table-label",squareTableLabelLeftBottom:"esri-relationship-ramp--square__table-label--left-bottom",squareTableLabelRightBottom:"esri-relationship-ramp--square__table-label--right-bottom",squareTableLabelLeftTop:"esri-relationship-ramp--square__table-label--left-top",squareTableLabelRightTop:"esri-relationship-ramp--square__table-label--right-top"};function ioe(e,t,i,r){const{focus:n,labels:o}=e,c=!!n,h=EVe(e,t,i,r),m={justifyContent:"center"},b=Ms();return c?j("div",{class:dr.diamondContainer,styles:m},j("div",{class:dr.diamondLeftCol},b?o.right:o.left),j("div",{class:dr.diamondMidCol},j("div",{class:dr.diamondMidColLabel},o.top),h,j("div",{class:dr.diamondMidColLabel},o.bottom)),j("div",{class:dr.diamondRightCol},b?o.left:o.right)):j("div",{class:dr.squareTable},j("div",{class:dr.squareTableRow},j("div",{class:qg(dr.squareTableCell,dr.squareTableLabel,dr.squareTableLabelRightBottom)},b?o.top:o.left),j("div",{class:dr.squareTableCell}),j("div",{class:qg(dr.squareTableCell,dr.squareTableLabel,dr.squareTableLabelLeftBottom)},b?o.left:o.top)),j("div",{class:dr.squareTableRow},j("div",{class:dr.squareTableCell}),h,j("div",{class:dr.squareTableCell})),j("div",{class:dr.squareTableRow},j("div",{class:qg(dr.squareTableCell,dr.squareTableLabel,dr.squareTableLabelRightTop)},b?o.right:o.bottom),j("div",{class:dr.squareTableCell}),j("div",{class:qg(dr.squareTableCell,dr.squareTableLabel,dr.squareTableLabelLeftTop)},b?o.bottom:o.right)))}function roe(e,t,i){const r=`${i}_arrowStart`,n=`${i}_arrowEnd`,o=e==="left",c={markerStart:null,markerEnd:null};switch(t){case"HL":o?c.markerStart=`url(#${n})`:c.markerEnd=`url(#${r})`;break;case"LL":c.markerStart=`url(#${n})`;break;case"LH":o?c.markerEnd=`url(#${r})`:c.markerStart=`url(#${n})`;break;default:c.markerEnd=`url(#${r})`}return c}function EVe(e,t,i,r,n=60){const{focus:o,numClasses:c,colors:h,rotation:m}=e,b=!!o,x=Math.sqrt(n**2+n**2)+(b?0:5),I=[],E=[],k=[],P=(n||75)/c;for(let ye=0;ye<c;ye++){const xe=ye*P;for(let Se=0;Se<c;Se++){const Ae=Se*P,Oe=FP(h[ye][Se]),bt=NP(null),st={type:"rect",x:Ae,y:xe,width:P,height:P};I.push(oX(Oe)),E.push(RP(st,Oe.fill,bt,null)),k.push(hX(st))}}const F=10,N=15,B=15,z=10;let q=null;b||(q="margin: -15px -15px -18px -15px");const J=roe("left",o,t),X=roe("right",o,t),Y=pX(k),ae=DP(Y,x,x,0,!1,m,!1),he=DP(Y,x,x,0,!1,b?-45:null,!1),fe={filter:Z_(r),opacity:i==null?null:`${i}`};return j("div",{styles:fe,class:b?dr.diamondMidColRamp:dr.squareTableCell},j("svg",{xmlns:$Ve,width:x,height:x,style:q},j("defs",null,j("marker",{id:`${t}_arrowStart`,markerWidth:"10",markerHeight:"10",refX:"5",refY:"5",markerUnits:"strokeWidth",orient:"auto"},j("polyline",{points:"0,0 5,5 0,10",fill:"none",stroke:"#555555","stroke-width":"1"})),j("marker",{id:`${t}_arrowEnd`,markerWidth:"10",markerHeight:"10",refX:"0",refY:"5",markerUnits:"strokeWidth",orient:"auto"},j("polyline",{points:"5,0 0,5 5,10",fill:"none",stroke:"#555555","stroke-width":"1"})),I),j("g",{transform:ae},E),j("g",{transform:he},j("line",{fill:"none",stroke:"#555555","stroke-width":"1","marker-start":J.markerStart,"marker-end":J.markerEnd,x1:-F,y1:n-N,x2:-F,y2:N}),j("line",{fill:"none",stroke:"#555555","stroke-width":"1","marker-start":X.markerStart,"marker-end":X.markerEnd,x1:B,y1:n+z,x2:n-B,y2:n+z}))))}const TVe=v9(),noe=10,OR=20,K4=10,RR=20,FR={univariateAboveAndBelowSymbol:"esri-univariate-above-and-below-ramp__symbol",colorRamp:"esri-legend__color-ramp"};function CVe(e="vertical"){const t="stroke:rgb(200, 200, 200);stroke-width:1";return e==="vertical"?j("svg",{height:"4",width:"10"},j("line",{x1:"0",y1:"2",x2:"10",y2:"2",style:t})):j("svg",{height:"10",width:"10"},j("line",{x1:"5",y1:"0",x2:"5",y2:"10",style:t}))}function kVe(e,t="vertical"){const i=document.createElement("div");return i.style.height=`${OR}px`,i.className=FR.univariateAboveAndBelowSymbol,e!=null&&(i.style.opacity=e.toString()),TVe.append(i,CVe.bind(null,t)),i}function soe(e,t,i="vertical",r){e.infos.forEach((n,o)=>{if(r&&o===2)n.preview=kVe(t,i);else{const c=or(n.size)+(i==="horizontal"?RR:K4),h=n.preview.tagName.toLowerCase()==="div",m=h?n.preview:document.createElement("div");m.className=FR.univariateAboveAndBelowSymbol,i==="horizontal"?m.style.width=`${c}px`:m.style.height=`${c}px`,h||m.appendChild(n.preview),n.preview=m}})}function Y4(e,t="classic"){const i=e.infos;return t==="classic"?(or(i[0].size)+K4)/2:(or(i[0].size)-or(i[i.length-1].size))/2}function ob(e,t){if(!e)return null;const i=e.infos.map(n=>n.color),r=zy(t.type==="full"?i:t.type==="above"?i.slice(0,3):i.slice(2,5),{width:t.width,height:t.height,align:t.rampAlignment,effectList:t.effectList});return r.className=FR.colorRamp,t.opacity!=null&&(r.style.opacity=t.opacity.toString()),r}function NR(e,t,i,r="vertical"){let n=0;const o=e.infos,c=Math.floor(o.length/2),h=t==="full"||t==="above"?0:c,m=t==="full"||t==="below"?o.length-1:c;for(let b=h;b<=m;b++)i&&b===c?n+=r==="horizontal"?noe:OR:n+=or(o[b].size)+(r==="horizontal"?RR:K4);return Math.round(n)}function ab(e,t,i,r="vertical"){const n=NR(e,t,i,r),o=e.infos,c=Math.floor(o.length/2),h=t==="full"||t==="above"?0:c,m=t==="full"||t==="below"?o.length-1:c,b=t==="full"?o[h].size+o[m].size:t==="above"?o[h].size:o[m].size,x=i?r==="vertical"?OR:noe:0,I=r==="vertical"?K4*(t==="full"?2:1):RR*(t==="full"?2:1);return Math.round(n-(or(b)/2+x/2+I/2))}function ooe(e,t,i="vertical"){const r=e.infos;let n=r.find(({type:c})=>c==="size-ramp"),o=r.find(({type:c})=>c==="color-ramp");return n&&(n=K({},n),n.infos=[...n.infos],soe(n,t,i,!0)),o&&(o=K({},o),o.infos=[...o.infos]),i==="horizontal"&&(n==null||n.infos.reverse(),o==null||o.infos.reverse()),{sizeRampElement:n,colorRampElement:o}}function aoe(e,t="vertical"){const i=e.infos;let r=i.find(({type:o})=>o==="size-ramp"),n=i.find(({type:o})=>o==="color-ramp");return r&&(r=K({},r),r.infos=[...r.infos],soe(r,null,t,!1)),n&&(n=K({},n),n.infos=[...n.infos]),t==="horizontal"&&(r==null||r.infos.reverse(),n==null||n.infos.reverse()),{sizeRampElement:r,colorRampElement:n}}function AVe(e,t){return t}function ys(e){const t=this;e.appendChild(t)}function lb(e,t,i){if(!t)return;if(typeof t=="string"||typeof t=="number")return t;if("value"in t||"unit"in t)return oo(e.dotValue,t);if("colorName"in t||"bandName"in t)return e[t.colorName]+": "+(e[t.bandName]||t.bandName);if("showCount"in t)return t.showCount?e.clusterCountTitle:null;let r=null;return AVe(t,i)?r=t.ratioPercentTotal?"showRatioPercentTotal":t.ratioPercent?"showRatioPercent":t.ratio?"showRatio":t.normField?"showNormField":t.field?"showField":null:loe(t,i)&&(r=t.normField?"showNormField":t.normByPct?"showNormPct":t.field?"showField":null),r?oo(r==="showField"?"{field}":e[r],{field:t.field,normField:t.normField}):null}function loe(e,t){return!t}function coe(e,t){return!!(t&&t==="Stretched"&&e.version>=10.3&&e.declaredClass==="esri.layers.ImageryLayer")}const At={activated:"esri-legend--card__carousel-indicator--activated",base:"esri-legend--card",stacked:"esri-legend--stacked",carouselTitle:"esri-legend--card__carousel-title",indicator:"esri-legend--card__carousel-indicator",intervalSeparator:"esri-legend--card__interval-separator",imageryLayerStretchedImage:"esri-legend--card__imagery-layer-image--stretched",imageLabel:"esri-legend--card__image-label",layerCaption:"esri-legend--card__layer-caption",labelElement:"esri-legend--card__label-element",layerRow:"esri-legend--card__layer-row",labelCell:"esri-legend--card__label-cell",message:"esri-legend--card__message",rampLabel:"esri-legend--card__ramp-label",section:"esri-legend--card__section",relationshipSection:"esri-legend--card__relationship-section",serviceCaptionText:"esri-legend--card__service-caption-text",serviceContent:"esri-legend--card__service-content",service:"esri-legend--card__service",groupLayer:"esri-legend--card__group-layer",groupLayerChild:"esri-legend--card__group-layer-child",symbol:"esri-legend--card__symbol",sizeRampRow:"esri-legend--card__size-ramp-row",symbolRow:"esri-legend--card__symbol-row",symbolCell:"esri-legend--card__symbol-cell",indicatorContainer:"esri-legend--card__carousel-indicator-container",intervalSeparatorsContainer:"esri-legend--card__interval-separators-container",relationshipLabelContainer:"esri-legend--card__relationship-label-container",labelContainer:"esri-legend--card__label-container",serviceCaptionContainer:"esri-legend--card__service-caption-container",symbolContainer:"esri-legend--card__symbol-container",sizeRampContainer:"esri-legend--card__size-ramp-container",sizeRampPreview:"esri-legend--card__size-ramp-preview",pieChartRampPreview:"esri-legend--card__pie-chart-ramp-preview",rampContainer:"esri-legend__ramps",sizeRampHorizontal:"esri-legend__size-ramp--horizontal",rampLabelsContainer:"esri-legend__ramp-labels",layerInfo:"esri-legend__layer-cell esri-legend__layer-cell--info",univariateAboveAndBelowColorRamp:"esri-univariate-above-and-below-ramp__color--card",hidden:"esri-hidden"},PVe=25,LVe=25,OVe=768,RVe=100;var Z3;(function(e){e.Auto="auto",e.Stack="stack",e.SideBySide="side-by-side"})(Z3||(Z3={}));const FVe="#ddd",cb=window.devicePixelRatio;function NVe(e){if(e){if(e.type.includes("3d")){const t=e.symbolLayers&&e.symbolLayers.length;if(!t)return;const i=e.symbolLayers.getItemAt(t-1),r=i.resource&&i.resource.primitive;return r==="circle"||r==="cross"||r==="kite"||r==="sphere"||r==="cube"||r==="diamond"}{const t=e.style;return t==="circle"||t==="diamond"||t==="cross"}}}function DVe(e){if(e){if(e.type.includes("3d")){const t=e.symbolLayers&&e.symbolLayers.length;if(!t)return;const i=e.symbolLayers.getItemAt(t-1).get("resource.primitive");return i==="triangle"||i==="cone"||i==="tetrahedron"}return e.style==="triangle"}}let Dc=class extends ki{constructor(e,t){super(e,t),this._handles=new Ti,this._hasIndicators=!1,this._selectedSectionName=null,this._sectionNames=[],this._sectionMap=new Map,this.activeLayerInfos=null,this.headingLevel=3,this.layout=Z3.Stack,this.messages=null,this.messagesCommon=null,this.type="card",this.view=null}initialize(){this.addHandles(we(()=>this.activeLayerInfos,e=>{this._handles.removeAll(),this._watchForSectionChanges(e)}))}destroy(){this._handles.destroy(),this._handles=null}render(){this._hasIndicators=this.layout===Z3.Auto&&this.view.container.clientWidth<=OVe||this.layout===Z3.Stack;const e=this.activeLayerInfos,t=e&&e.toArray().map(h=>this._renderLegendForLayer(h)).filter(h=>!!h);this._hasIndicators?this._selectedSectionName&&this._sectionNames.includes(this._selectedSectionName)||(this._selectedSectionName=this._sectionNames&&this._sectionNames[0]):this._selectedSectionName=null;const i=this._sectionNames.length,r=this._sectionNames.map((h,m)=>{const b=oo(this.messagesCommon.pagination.pageText,{index:m+1,total:i});return j("div",{key:h,role:"tab",id:h,"aria-label":b,"aria-controls":`${h}-panel`,"aria-selected":(this._selectedSectionName===h).toString(),tabIndex:this._selectedSectionName===h?0:-1,title:b,onclick:this._selectSection,onkeydown:this._focusSection,bind:this,class:this.classes(At.indicator,{[At.activated]:this._selectedSectionName===h}),"data-section-name":h})}),n=this._hasIndicators&&i>1?j("div",{class:At.indicatorContainer,key:"carousel-navigation",role:"tablist"},r):null,o=this._hasIndicators?this._sectionMap.get(this._selectedSectionName):t&&t.length?t:null,c={[At.stacked]:this._hasIndicators};return j("div",{class:this.classes(At.base,c)},o||j("div",{class:At.message},this.messages.noLegend),n)}_selectSection(e){const t=e.target.getAttribute("data-section-name");t&&(this._selectedSectionName=t)}_focusSection(e){switch(e.key){case"ArrowLeft":case"ArrowRight":this._switchSectionOnArrowPress(e);break;case"Enter":case" ":this._selectSection(e)}}_switchSectionOnArrowPress(e){const t=e.key,i=t==="ArrowLeft"?-1:1,r=e.target.getAttribute("data-section-name"),n=this._sectionNames.indexOf(r),o=this._sectionNames;let c=null;n!==-1&&(o[n+i]?c=document.getElementById(o[n+i]):t==="ArrowLeft"?c=document.getElementById(o[o.length-1]):t==="ArrowRight"&&(c=document.getElementById(o[0])),c&&c.focus())}_watchForSectionChanges(e){if(this._generateSectionNames(),e){e.forEach(i=>{const r=`activeLayerInfo-${i.layer.uid}-version-change`;this._handles.remove(r),this._watchForSectionChanges(i.children),this._handles.add(we(()=>i.version,()=>this._generateSectionNames()),r)});const t="activeLayerInfos-collection-change";this._handles.remove(t),this._handles.add(e.on("change",()=>this._watchForSectionChanges(e)),t)}}_generateSectionNames(){this._sectionNames.length=0,this._selectedSectionName=null,this.activeLayerInfos&&this.activeLayerInfos.forEach(this._generateSectionNamesForActiveLayerInfo,this)}_getSectionName(e,t,i){return`${this.id}${e.uid}-type-${t.type}-${i}`}_generateSectionNamesForActiveLayerInfo(e){e.children.forEach(this._generateSectionNamesForActiveLayerInfo,this),e.legendElements&&e.legendElements.forEach((t,i)=>{this._sectionNames.push(this._getSectionName(e.layer,t,i))})}_renderLegendForLayer(e){if(!e.ready)return null;if(e.children.length){const t=e.children.map(i=>this._renderLegendForLayer(i)).toArray();return j("div",{key:e.layer.uid,class:this.classes(At.service,At.groupLayer)},j("div",{class:At.serviceCaptionContainer},e.title),t)}{const t=e.legendElements;if(t&&!t.length)return null;const i=t.some(o=>o.type==="relationship-ramp"),r=t.map((o,c)=>this._renderLegendForElement(o,e,c,i)).filter(o=>!!o);if(!r.length)return null;const n={[At.groupLayerChild]:!!e.parent};return j("div",{key:e.layer.uid,class:this.classes(At.service,n)},j("div",{class:At.serviceCaptionContainer},j("div",{class:At.serviceCaptionText},e.title)),j("div",{class:At.serviceContent},r))}}_renderLegendForElement(e,t,i,r=!1,n=!1){const o=e.type==="color-ramp",c=e.type==="opacity-ramp",h=e.type==="size-ramp",m=t.layer;let b=null;if(typeof e.title=="string")b=e.title;else if(e.title){const F=e.title,N=lb(this.messages,F,o||c);b=F.title?`${F.title} (${N})`:N}const x=this._getSectionName(m,e,i),I=this._hasIndicators&&!n?j("div",null,j(Va,{level:this.headingLevel,class:At.carouselTitle},t.title),j(Va,{level:l9e(this.headingLevel),class:At.layerCaption},b)):b?j(Va,{level:this.headingLevel,class:At.layerCaption},b):null,E=t.effectList;let k=null;if(e.type==="symbol-table"){const F=e.infos.map((N,B)=>this._renderLegendForElementInfo(N,t,e.legendType,B)).filter(N=>!!N);if(F.length){const N=F[0].properties.classes&&F[0].properties.classes[At.symbolRow],B={[At.labelContainer]:!N&&!r,[At.relationshipLabelContainer]:r};k=j("div",{class:this.classes(B)},F)}}else e.type==="color-ramp"||e.type==="opacity-ramp"||e.type==="heatmap-ramp"?k=this._renderLegendForRamp(e,m.opacity,E):h?k=this._renderSizeRamp(e,m.opacity):e.type==="pie-chart-ramp"?k=this._renderPieChartRamp(e):e.type==="relationship-ramp"?k=ioe(e,this.id,m.opacity,E):e.type==="univariate-above-and-below-ramp"?k=this._renderUnivariateAboveAndBelowRamp(e,m.opacity,E):e.type==="univariate-color-size-ramp"&&(k=this._renderUnivariateColorSizeRamp(e,m.opacity,E));if(!k)return null;const P=j("div",{key:x,class:At.section,id:`${x}-panel`,role:"tabpanel","aria-labelledby":x,tabIndex:0},[I,k]);return n||this._sectionMap.set(x,P),P}_renderPieChartRamp(e){return j("div",{class:At.pieChartRampPreview,bind:e.preview,afterCreate:ys})}_renderUnivariateAboveAndBelowRamp(e,t,i){const{sizeRampElement:r,colorRampElement:n}=ooe(e,t,"horizontal");if(!r)return null;const o=NR(r,"full",!0,"horizontal"),c=ab(r,"above",!0,"horizontal"),h=ab(r,"below",!0,"horizontal"),m=12,b=ob(n,{width:c,height:m,rampAlignment:"horizontal",opacity:t,type:"above",effectList:i}),x=ob(n,{width:h,height:m,rampAlignment:"horizontal",opacity:t,type:"below",effectList:i}),I=Y4(r,"card"),E=r.infos.map(q=>q.label),k=E.length-1,P=E.map((q,J)=>J===0||J===k?j("div",{key:J},q):null),F={display:"flex",flexDirection:"column"},N={display:"flex",flexDirection:"row"},B={marginTop:"3px",display:"flex"};Ms(this.container)?B.marginRight=`${I}px`:B.marginLeft=`${I}px`;const z={width:`${o}px`,display:"flex",flexDirection:"row",justifyContent:"space-between"};return j("div",{class:At.layerRow,key:"size-ramp-preview",styles:F},j("div",{class:this.classes(At.symbolContainer,At.sizeRampHorizontal),styles:N},r.infos.map((q,J)=>j("div",{key:J,class:At.symbol,bind:q.preview,afterCreate:ys}))),b?j("div",{class:At.univariateAboveAndBelowColorRamp,styles:B,key:"color-ramp-preview"},j("div",{bind:b,afterCreate:ys}),j("div",{bind:x,afterCreate:ys})):null,j("div",{class:At.layerInfo},j("div",{class:At.rampLabelsContainer,styles:z},P)))}_renderUnivariateColorSizeRamp(e,t,i){const{sizeRampElement:r,colorRampElement:n}=aoe(e,"horizontal");if(!r)return null;const o=NR(r,"full",!1,"horizontal"),c=ab(r,"full",!1,"horizontal"),h=ob(n,{width:c,height:12,rampAlignment:"horizontal",opacity:t,type:"full",effectList:i}),m=Y4(r,"card"),b=r.infos.length-1,x=r.infos.map((F,N)=>N===0||N===b?j("div",{key:N},F.label):null),I={display:"flex",flexDirection:"column"},E={display:"flex",flexDirection:"row"},k={marginTop:"3px",display:"flex"};Ms(this.container)?k.marginRight=`${m}px`:k.marginLeft=`${m}px`;const P={width:`${o}px`,display:"flex",flexDirection:"row",justifyContent:"space-between"};return j("div",{class:At.layerRow,key:"size-ramp-preview",styles:I},j("div",{class:this.classes(At.symbolContainer,At.sizeRampHorizontal),styles:E},r.infos.map((F,N)=>j("div",{key:N,class:At.symbol,bind:F.preview,afterCreate:ys}))),j("div",{class:At.univariateAboveAndBelowColorRamp,styles:k,key:"color-ramp-preview"},j("div",{bind:h,afterCreate:ys})),j("div",{class:At.layerInfo},j("div",{class:At.rampLabelsContainer,styles:P},x)))}_renderLegendForElementInfo(e,t,i,r){var c,h;const n=t.layer;if(e.type)return this._renderLegendForElement(e,t,r,!1,!0);const o=coe(n,i);if(e.preview){if(!e.symbol||!e.symbol.type.includes("simple-fill")){if(!e.label)return j("div",{key:r,bind:e.preview,afterCreate:ys});const X={[At.symbolCell]:this._hasIndicators};return j("div",{key:r,class:this.classes(At.layerRow,{[At.symbolRow]:this._hasIndicators})},j("div",{class:this.classes(X),bind:e.preview,afterCreate:ys}),j("div",{class:this.classes(At.imageLabel,{[At.labelCell]:this._hasIndicators})},lb(this.messages,e.label,!1)||""))}let m=255,b=255,x=255,I=0,E=255,k=255,P=255,F=0;const N=e.symbol.color&&e.symbol.color.a,B=e.symbol.outline&&e.symbol.outline.color&&e.symbol.outline.color.a;N&&(m=e.symbol.color.r,b=e.symbol.color.g,x=e.symbol.color.b,I=e.symbol.color.a*n.opacity),B&&(E=e.symbol.outline.color.r,k=e.symbol.outline.color.g,P=e.symbol.outline.color.b,F=e.symbol.outline.color.a*n.opacity);const z=(h=(c=e.symbol.color)==null?void 0:c.isBright)!=null?h:!0,q=z?"rgba(255, 255, 255, .6)":"rgba(0, 0, 0, .6)",J={background:N?`rgba(${m}, ${b}, ${x}, ${I})`:"none",color:z?"black":"white",textShadow:`-1px -1px 0 ${q},
                                              1px -1px 0 ${q},
                                              -1px 1px 0 ${q},
                                              1px 1px 0 ${q}`,border:B?`1px solid rgba(${E}, ${k}, ${P}, ${F})`:"none",filter:Z_(t.effectList)};return j("div",{key:r,class:At.layerRow},j("div",{class:At.labelElement,styles:J}," ",e.label," "))}if(e.src){const m=this._renderImage(e,n,o);return j("div",{key:r,class:At.layerRow},m,j("div",{class:At.imageLabel},e.label||""))}}_renderImage(e,t,i){const{label:r,src:n,opacity:o}=e,c={[At.imageryLayerStretchedImage]:i,[At.symbol]:!i},h={opacity:`${o!=null?o:t.opacity}`};return j("img",{alt:lb(this.messages,r,!1),src:n,border:0,width:e.width,height:e.height,class:this.classes(c),styles:h})}_renderSizeRampLines(e){const t=e.infos,i=t[0],r=t[t.length-1],n=i.symbol,o=this._hasIndicators,c=or(i.size+i.outlineSize)*cb,h=or(r.size+r.outlineSize)*cb,m=o?c:c+50*cb,b=o?c/2+50*cb:c,x=DVe(n),I=NVe(n),E=document.createElement("canvas");E.width=m,E.height=b,E.style.width=E.width/cb+"px",E.style.height=E.height/cb+"px";const k=E.getContext("2d");if(o){k.beginPath();const P=0,F=0,N=m/2-h/2,B=b;k.moveTo(P,F),k.lineTo(N,B);const z=m,q=0,J=m/2+h/2,X=b;k.moveTo(z,q),k.lineTo(J,X)}else{k.beginPath();const P=0,F=b/2-h/2,N=m,B=0;k.moveTo(P,F),k.lineTo(N,B);const z=0,q=b/2+h/2,J=m,X=b;k.moveTo(z,q),k.lineTo(J,X)}return k.strokeStyle=FVe,k.stroke(),j("div",{bind:E,afterCreate:ys,styles:o?{display:"flex",marginTop:`-${x?0:I?c/2:0}px`,marginBottom:`-${x?h:I?h/2:0}px`}:{display:"flex",marginRight:`-${x?0:I?c/2:0}px`,marginLeft:`-${x?0:I?h/2:0}px`}})}_renderSizeRamp(e,t){const i=e.infos,r=i[0].label,n=i[i.length-1].label;let o=i[0].preview,c=i[i.length-1].preview;const h=this._hasIndicators,m={"flex-direction":h?"column":"row-reverse"};o&&(o=o.cloneNode(!0),o.style.display="flex"),c&&(c=c.cloneNode(!0),c.style.display="flex");const b={opacity:t!=null?`${t}`:""};return j("div",{class:this.classes(At.layerRow,{[At.sizeRampRow]:h})},j("div",{class:At.rampLabel},h?r:n),j("div",{class:At.sizeRampContainer,styles:m},j("div",{bind:o,afterCreate:ys,class:At.sizeRampPreview,styles:b}),this._renderSizeRampLines(e),j("div",{bind:c,afterCreate:ys,class:At.sizeRampContainer,styles:b})),j("div",{class:At.rampLabel},h?n:r))}_renderLegendForRamp(e,t,i){const r=e.infos,n=e.type==="heatmap-ramp",o=r.length-1,c=LVe,h=o>2&&!n?PVe*o:RVe,m=h+20,b=10,x=r.slice(0).reverse();x.forEach((X,Y)=>{X.offset=n?X.ratio:Y/o});const I=x.length-1,E=x.length%2!=0&&x[x.length/2|0],k=E&&j("div",{class:At.intervalSeparatorsContainer},j("div",{class:At.intervalSeparator},"|"),j("div",{class:At.rampLabel},E.label)),P=r[r.length-1].label,F=r[0].label,N=[[{shape:{type:"path",path:`M0 ${c/2} L${b} 0 L${b} ${c} Z`},fill:x[0].color,stroke:{width:0}},{shape:{type:"rect",x:b,y:0,width:h,height:c},fill:{type:"linear",x1:b,y1:0,x2:h+b,y2:0,colors:x},stroke:{width:0}},{shape:{type:"path",path:`M${h+b} 0 L${m} ${c/2} L${h+b} ${c} Z`},fill:x[I].color,stroke:{width:0}}]],B=dX(N,m,c),{messages:z}=this,q={filter:Z_(i),opacity:t==null?null:`${t}`},J={justifyContent:"center"};return j("div",{class:At.layerRow,styles:J},j("div",{class:At.rampLabel},n?z[P]:P),j("div",{class:At.symbolContainer},j("div",{styles:q},B),k),j("div",{class:At.rampLabel},n?z[F]:F))}};g([w()],Dc.prototype,"activeLayerInfos",void 0),g([w()],Dc.prototype,"headingLevel",void 0),g([w()],Dc.prototype,"layout",void 0),g([w(),ci("esri/widgets/Legend/t9n/Legend")],Dc.prototype,"messages",void 0),g([w(),ci("esri/t9n/common")],Dc.prototype,"messagesCommon",void 0),g([w({readOnly:!0})],Dc.prototype,"type",void 0),g([w()],Dc.prototype,"view",void 0),g([Ki()],Dc.prototype,"_selectSection",null),Dc=g([te("esri.widgets.Legend.styles.Card")],Dc);const DR=Dc,Jt={service:"esri-legend__service",label:"esri-legend__service-label",layer:"esri-legend__layer",groupLayer:"esri-legend__group-layer",groupLayerChild:"esri-legend__group-layer-child",layerTable:"esri-legend__layer-table",layerTableSizeRamp:"esri-legend__layer-table--size-ramp",layerChildTable:"esri-legend__layer-child-table",layerCaption:"esri-legend__layer-caption",layerBody:"esri-legend__layer-body",layerRow:"esri-legend__layer-row",layerCell:"esri-legend__layer-cell",layerInfo:"esri-legend__layer-cell esri-legend__layer-cell--info",imageryLayerStretchedImage:"esri-legend__imagery-layer-image--stretched",imageryLayerCellStretched:"esri-legend__imagery-layer-cell--stretched",imageryLayerInfoStretched:"esri-legend__imagery-layer-info--stretched",symbolContainer:"esri-legend__layer-cell esri-legend__layer-cell--symbols",symbol:"esri-legend__symbol",rampContainer:"esri-legend__ramps",sizeRamp:"esri-legend__size-ramp",colorRamp:"esri-legend__color-ramp",opacityRamp:"esri-legend__opacity-ramp",borderlessRamp:"esri-legend__borderless-ramp",rampTick:"esri-legend__ramp-tick",rampFirstTick:"esri-legend__ramp-tick-first",rampLastTick:"esri-legend__ramp-tick-last",rampLabelsContainer:"esri-legend__ramp-labels",rampLabel:"esri-legend__ramp-label",univariateAboveAndBelowSymbol:"esri-univariate-above-and-below-ramp__symbol",univariateAboveAndBelowLabel:"esri-univariate-above-and-below-ramp__label",message:"esri-legend__message",header:"esri-widget__heading",hidden:"esri-hidden"},jVe="esri-legend__",VVe=24,uoe={display:"flex",alignItems:"flex-start"},jR={marginLeft:"3px"},ub={display:"table-cell",verticalAlign:"middle"};let Sm=class extends ki{constructor(e,t){super(e,t),this.activeLayerInfos=null,this.headingLevel=3,this.messages=null,this.type="classic"}render(){const e=this.activeLayerInfos,t=e&&e.toArray().map(i=>this._renderLegendForLayer(i)).filter(i=>!!i);return j("div",null,t&&t.length?t:j("div",{class:Jt.message},this.messages.noLegend))}_renderLegendForLayer(e){if(!e.ready)return null;const t=!!e.children.length,i=`${jVe}${e.layer.uid}-version-${e.version}`,r=e.title?Va({level:this.headingLevel,class:this.classes(Jt.header,Jt.label)},e.title):null;if(t){const n=e.children.map(o=>this._renderLegendForLayer(o)).toArray();return j("div",{key:i,class:this.classes(Jt.service,Jt.groupLayer)},r,n)}{const n=e.legendElements;if(n&&!n.length)return null;const o=n.map(h=>this._renderLegendForElement(h,e.layer,e.effectList)).filter(h=>!!h);if(!o.length)return null;const c={[Jt.groupLayerChild]:!!e.parent};return j("div",{key:i,class:this.classes(Jt.service,c),tabIndex:0},r,j("div",{class:Jt.layer},o))}}_renderLegendForElement(e,t,i,r){const n=e.type==="color-ramp",o=e.type==="opacity-ramp",c=e.type==="size-ramp";let h=null;if(e.type==="symbol-table"||c){const k=e.infos.map(P=>this._renderLegendForElementInfo(P,t,i,c,e.legendType)).filter(P=>!!P);k.length&&(h=j("div",{class:Jt.layerBody},k))}else e.type==="color-ramp"||e.type==="opacity-ramp"||e.type==="heatmap-ramp"||e.type==="stretch-ramp"?h=this._renderLegendForRamp(e,t.opacity):e.type==="relationship-ramp"?h=ioe(e,this.id,t.opacity,i):e.type==="pie-chart-ramp"?h=this._renderPieChartRamp(e):e.type==="univariate-above-and-below-ramp"?h=this._renderUnivariateAboveAndBelowRamp(e,t.opacity,i):e.type==="univariate-color-size-ramp"&&(h=this._renderUnivariateColorSizeRamp(e,t.opacity,i));if(!h)return null;const m=e.title;let b=null;if(typeof m=="string")b=m;else if(m){const k=lb(this.messages,m,n||o);b=loe(m,n||o)&&m.title?`${m.title} (${k})`:k}const x=r?Jt.layerChildTable:Jt.layerTable,I=b?j("div",{class:Jt.layerCaption},b):null,E={[Jt.layerTableSizeRamp]:c||!r};return j("div",{class:this.classes(x,E)},I,h)}_renderPieChartRamp(e){return j("div",{bind:e.preview,afterCreate:ys})}_renderUnivariateAboveAndBelowRamp(e,t,i){const{sizeRampElement:r,colorRampElement:n}=ooe(e,t);if(!r)return null;const o=ab(r,"above",!0),c=ab(r,"below",!0),h=12,m=ob(n,{width:h,height:o,rampAlignment:"vertical",opacity:t,type:"above",effectList:i}),b=ob(n,{width:h,height:c,rampAlignment:"vertical",opacity:t,type:"below",effectList:i}),x=Y4(r),I=r.infos.map(J=>J.label),E=I.map((J,X)=>X===0?j("div",{key:X,class:J?m?Jt.univariateAboveAndBelowLabel:Jt.rampLabel:null},J):X===2?j("div",null):null),k=I.length-1,P=Math.floor(I.length/2),F=I.map((J,X)=>X===P||X===k?j("div",{key:X,class:J?m?Jt.univariateAboveAndBelowLabel:Jt.rampLabel:null},J):null),N={display:"table-cell",verticalAlign:"middle"},B={marginTop:`${x}px`},z={height:`${o}px`},q={height:`${c}px`};return j("div",{key:"univariate-above-and-below-ramp-preview",styles:uoe},j("div",{class:Jt.layerBody},r.infos.map((J,X)=>j("div",{class:this.classes(Jt.layerRow,Jt.sizeRamp)},j("div",{class:Jt.symbol,styles:N,bind:J.preview,afterCreate:ys}),m||X%2!=0?null:j("div",{class:Jt.layerInfo},I[X])))),m?j("div",{styles:B,key:"color-ramp-preview"},j("div",{styles:jR},j("div",{styles:ub},j("div",{class:Jt.rampContainer,bind:m,afterCreate:ys})),j("div",{styles:ub},j("div",{class:Jt.rampLabelsContainer,styles:z},E))),j("div",{styles:jR},j("div",{styles:ub},j("div",{class:Jt.rampContainer,bind:b,afterCreate:ys})),j("div",{styles:ub},j("div",{class:Jt.rampLabelsContainer,styles:q},F)))):null)}_renderUnivariateColorSizeRamp(e,t,i){const{sizeRampElement:r,colorRampElement:n}=aoe(e);if(!r)return null;const o=Y4(r),c=12,h=ab(r,"full",!1),m=ob(n,{width:c,height:h,rampAlignment:"vertical",opacity:t,type:"full",effectList:i}),b=r.infos.length-1,x=r.infos.map((P,F)=>F===0||F===b?j("div",{key:F,class:P.label?n?Jt.univariateAboveAndBelowLabel:Jt.rampLabel:null},P.label):null),I={display:"table-cell",verticalAlign:"middle"},E={marginTop:`${o}px`},k={height:`${h}px`};return j("div",{key:"univariate-above-and-below-ramp-preview",styles:uoe},j("div",{class:Jt.layerBody},r.infos.map(P=>j("div",{class:this.classes(Jt.layerRow,Jt.sizeRamp)},j("div",{class:Jt.symbol,styles:I,bind:P.preview,afterCreate:ys})))),j("div",{styles:E,key:"color-ramp-preview"},j("div",{styles:jR},j("div",{styles:ub},j("div",{class:Jt.rampContainer,bind:m,afterCreate:ys})),j("div",{styles:ub},j("div",{class:Jt.rampLabelsContainer,styles:k},x)))))}_renderLegendForRamp(e,t){const i=e.infos,r=e.type==="opacity-ramp",n=e.type==="heatmap-ramp",o=e.type==="stretch-ramp",c=e.preview,h=r?Jt.opacityRamp:"";c.className=`${Jt.colorRamp} ${h}`,t!=null&&(c.style.opacity=t.toString());const m=i.map(I=>j("div",{class:I.label?Jt.rampLabel:null},n?this.messages[I.label]||I.label:o?this._getStretchStopLabel(I):I.label)),b={width:`${VVe}px`},x={height:c.style.height};return j("div",{class:Jt.layerRow},j("div",{class:Jt.symbolContainer,styles:b},j("div",{class:Jt.rampContainer,bind:c,afterCreate:ys})),j("div",{class:Jt.layerInfo},j("div",{class:Jt.rampLabelsContainer,styles:x},m)))}_getStretchStopLabel(e){return e.label?this.messages[e.label]+": "+(typeof e.value=="string"?e.value:Jo(e.value,{style:"decimal",notation:e.value.toString().includes("e")?"scientific":"standard"})):""}_renderLegendForElementInfo(e,t,i,r,n){if(e.type)return this._renderLegendForElement(e,t,i,!0);let o=null;const c=coe(t,n);if(e.preview?o=j("div",{class:Jt.symbol,bind:e.preview,afterCreate:ys}):e.src&&(o=this._renderImage(e,t,c)),!o)return null;const h={[Jt.imageryLayerInfoStretched]:c},m={[Jt.imageryLayerInfoStretched]:c,[Jt.sizeRamp]:!c&&r};return j("div",{class:Jt.layerRow},j("div",{class:this.classes(Jt.symbolContainer,m)},o),j("div",{class:this.classes(Jt.layerInfo,h)},lb(this.messages,e.label,!1)||""))}_renderImage(e,t,i){const{label:r,src:n,opacity:o}=e,c={[Jt.imageryLayerStretchedImage]:i,[Jt.symbol]:!i},h={opacity:`${o!=null?o:t.opacity}`};return j("img",{alt:lb(this.messages,r,!1),src:n,border:0,width:e.width,height:e.height,class:this.classes(c),styles:h})}};g([w()],Sm.prototype,"activeLayerInfos",void 0),g([w()],Sm.prototype,"headingLevel",void 0),g([w(),ci("esri/widgets/Legend/t9n/Legend")],Sm.prototype,"messages",void 0),g([w({readOnly:!0})],Sm.prototype,"type",void 0),Sm=g([te("esri.widgets.Legend.styles.Classic")],Sm);const hb=Sm,X4={base:"esri-legend",widget:"esri-widget",panel:"esri-widget--panel",widgetIcon:"esri-icon-layer-list"};let Ps=class extends ki{constructor(e,t){super(e,t),this._handles=new Ti,this.headingLevel=3,this.iconClass=X4.widgetIcon,this.messages=null,this.style=new hb,this.viewModel=new IVe}initialize(){this.addHandles([vr(()=>this.view,"resize",()=>this.scheduleRender()),vr(()=>this.activeLayerInfos,"change",()=>this._refreshActiveLayerInfos(this.activeLayerInfos)),we(()=>this.headingLevel,e=>{const{style:t}=this;t&&(t.headingLevel=e)}),we(()=>this.style,(e,t)=>{t&&e!==t&&t.destroy(),e&&(e.activeLayerInfos=this.activeLayerInfos,e.type==="card"&&(e.view=this.view),e.headingLevel=this.headingLevel)},St)])}destroy(){this._handles=li(this._handles)}get activeLayerInfos(){return this.viewModel.activeLayerInfos}set activeLayerInfos(e){this.viewModel.activeLayerInfos=e}get basemapLegendVisible(){return this.viewModel.basemapLegendVisible}set basemapLegendVisible(e){this.viewModel.basemapLegendVisible=e}get groundLegendVisible(){return this.viewModel.groundLegendVisible}set groundLegendVisible(e){this.viewModel.groundLegendVisible=e}get hideLayersNotInCurrentView(){return this.viewModel.hideLayersNotInCurrentView}set hideLayersNotInCurrentView(e){this.viewModel.hideLayersNotInCurrentView=e}get keepCacheOnDestroy(){return this.viewModel.keepCacheOnDestroy}set keepCacheOnDestroy(e){this.viewModel.keepCacheOnDestroy=e}get respectLayerVisibility(){return this.viewModel.respectLayerVisibility}set respectLayerVisibility(e){this.viewModel.respectLayerVisibility=e}get label(){var e,t;return(t=(e=this.messages)==null?void 0:e.widgetLabel)!=null?t:""}set label(e){this._overrideIfSome("label",e)}get layerInfos(){return this.viewModel.layerInfos}set layerInfos(e){this.viewModel.layerInfos=e}castStyle(e){if(e instanceof DR||e instanceof hb)return e;if(typeof e=="string")return e==="card"?new DR:new hb;if(e&&typeof e.type=="string"){const t=K({},e);return delete t.type,new(e.type==="card"?DR:hb)(t)}return new hb}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}render(){return j("div",{class:this.classes(X4.base,X4.widget,this.style instanceof hb?X4.panel:null)},this.style.render())}_refreshActiveLayerInfos(e){this._handles.removeAll(),e.forEach(t=>this._renderOnActiveLayerInfoChange(t)),this.scheduleRender()}_renderOnActiveLayerInfoChange(e){const t=we(()=>e.version,()=>this.scheduleRender());this._handles.add(t,`version_${e.layer.uid}`);const i=vr(()=>e.children,"change",()=>e.children.forEach(r=>this._renderOnActiveLayerInfoChange(r)),St);this._handles.add(i,`children_${e.layer.uid}`),e.children.forEach(r=>this._renderOnActiveLayerInfoChange(r))}};g([w()],Ps.prototype,"activeLayerInfos",null),g([w()],Ps.prototype,"basemapLegendVisible",null),g([w()],Ps.prototype,"groundLegendVisible",null),g([w()],Ps.prototype,"headingLevel",void 0),g([w()],Ps.prototype,"hideLayersNotInCurrentView",null),g([w()],Ps.prototype,"keepCacheOnDestroy",null),g([w()],Ps.prototype,"respectLayerVisibility",null),g([w()],Ps.prototype,"iconClass",void 0),g([w()],Ps.prototype,"label",null),g([w()],Ps.prototype,"layerInfos",null),g([w(),ci("esri/widgets/Legend/t9n/Legend")],Ps.prototype,"messages",void 0),g([w()],Ps.prototype,"style",void 0),g([Dt("style")],Ps.prototype,"castStyle",null),g([w()],Ps.prototype,"view",null),g([w()],Ps.prototype,"viewModel",void 0),Ps=g([te("esri.widgets.Legend")],Ps);const zVe=Ps;var GVe=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",default:zVe}),VR;let Bf=VR=class extends wg{constructor(e){super(e),this.displayValueEnabled=!1,this.max=1,this.min=0,this.step=.1,this.type="slider",this.value=null}clone(){return new VR({active:this.active,className:this.className,disabled:this.disabled,id:this.id,indicator:this.indicator,title:this.title,visible:this.visible,displayValueEnabled:this.displayValueEnabled,max:this.max,min:this.min,step:this.step,value:this.value})}};g([w()],Bf.prototype,"displayValueEnabled",void 0),g([w()],Bf.prototype,"max",void 0),g([w()],Bf.prototype,"min",void 0),g([w()],Bf.prototype,"step",void 0),g([w()],Bf.prototype,"value",void 0),Bf=VR=g([te("esri.support.Action.ActionSlider")],Bf);const BVe=Bf,hoe={hide:"hide",hideChildren:"hide-children"};function Q4(e){if(e)return e.listMode!=null?e.listMode:void 0}function UVe(e){if(e)return e.minScale!=null?e.minScale:void 0}function qVe(e){if(e)return e.maxScale!=null?e.maxScale:void 0}function HVe(e){if(!e)return"inherited";const t=e.get("layer.capabilities.exportMap.supportsSublayerVisibility");if(typeof t=="boolean")return t?"independent":"inherited";const i=e.get("capabilities.exportMap.supportsSublayerVisibility");return typeof i=="boolean"?i?"independent":"inherited":e.visibilityMode!=null?e.visibilityMode:"independent"}function zR(e){if(!!e){if(!("type"in e))return"sublayers";if(!(e.listMode===hoe.hideChildren||e.type==="wmts"))return e.type==="group"?"layers":"sublayers"}}function WVe(e){const t=e&&(e.get("layer.layer")||e.layer);if(!t)return!1;const i=t.get("capabilities.exportMap.supportsDynamicLayers");return typeof i!="boolean"||i}function GR(e){return Q4(e)!==hoe.hide}function JVe(e,t){if(!e||isNaN(t))return!1;const i=UVe(e),r=qVe(e),n=!isNaN(i)&&i>0&&t>i,o=!isNaN(r)&&r>0&&t<r;return n||o}function poe(e,t){e&&e.sort((i,r)=>{const n=t.indexOf(i.uid),o=t.indexOf(r.uid);return n>o?-1:n<o?1:0})}function ZVe(e,t){const i=e==null?void 0:e.layer;if(!i)return;const r=zR(i);!r||poe(i.get(r),t)}function doe(e){const t=e==null?void 0:e.layer;return t&&t.type==="group"?t.layers:null}function BR(e,t){var r;const i=(r=e.layer)==null?void 0:r.uid;return i&&t.find(n=>{var o;return((o=n.layer)==null?void 0:o.uid)===i})}function KVe(e){const t=YVe(e)?e:null,i=e==null?void 0:e.parent,r=(i==null?void 0:i.type)==="map-image"&&t.source,n="";return r&&i?{layer:i,title:n,sublayerIds:[r.mapLayerId]}:{layer:e,title:n}}function YVe(e){return!!(e==null?void 0:e.layer)}const Np={base:"esri-layer-list-panel",content:"esri-layer-list-panel__content",contentLegend:"esri-layer-list-panel__content--legend",contentString:"esri-layer-list-panel__content--string",contentElement:"esri-layer-list-panel__content--html-element",contentWidget:"esri-layer-list-panel__content--widget"},XVe="legends";let Gl=class extends rc(ki){constructor(e,t){super(e,t),this._legend=null,this._handles=new Ti,this.content=null,this.image=null,this.listItem=null,this.open=!1,this.visible=!0}initialize(){this.addHandles(we(()=>this.content,e=>this._createLegend(e),St))}destroy(){const{_legend:e}=this;e&&e.destroy(),this._legend=null}get className(){const{image:e}=this,t=this._getFirstWidget();return this._get("className")||!e&&t?t.iconClass:""}set className(e){this._override("className",e)}get disabled(){var r;const{listItem:e,_legend:t,content:i}=this;return!e||!(Array.isArray(i)&&i.length>1)&&!!t&&(!((r=t.activeLayerInfos)==null?void 0:r.length)||!e.visibleAtCurrentScale)}set disabled(e){this._overrideIfSome("disabled",e)}get title(){const e=this._getFirstWidget();return this._get("title")||e?e.label:""}set title(e){this._override("title",e)}render(){return j("div",{class:Np.base},this._renderContents())}_renderContent(e){const{_legend:t,disabled:i}=this;return!e||i?null:e==="legend"&&t?j("div",{class:this.classes(Np.content,Np.contentLegend),key:t},t.render()):typeof e=="string"?j("div",{class:this.classes(Np.content,Np.contentString),key:e,innerHTML:e}):s1(e)?j("div",{class:this.classes(Np.content,Np.contentWidget),key:e},e.render()):e instanceof HTMLElement?j("div",{class:this.classes(Np.content,Np.contentElement),key:e,bind:e,afterCreate:this._attachToNode}):null}_renderContents(){const{content:e}=this;return Array.isArray(e)?e.map(t=>this._renderContent(t)):this._renderContent(e)}_getLegendOptions(){const{listItem:e}=this;if(!e)return{};const{layer:t,view:i}=e;return t&&i?{view:i,layerInfos:[KVe(t)]}:{}}_createLegend(e){this._hasLegend(e)&&!this._legend&&Promise.resolve().then(function(){return GVe}).then(({default:t})=>{const{_handles:i,listItem:r}=this,n=new t(this._getLegendOptions());this._legend=n,this.notifyChange("className"),this.notifyChange("title");const o=we(()=>{var c,h;return[r==null?void 0:r.view,r==null?void 0:r.layer,(c=r==null?void 0:r.layer)==null?void 0:c.source,(h=r==null?void 0:r.layer)==null?void 0:h.parent]},()=>this._updateLegend(n),St);i.add(o,XVe),this.scheduleRender()})}_hasLegend(e){const t="legend";return e===t||!!Array.isArray(e)&&e.includes(t)}_attachToNode(e){e.appendChild(this)}_updateLegend(e){e.set(this._getLegendOptions()),this.scheduleRender()}_getWidget(e){return e==="legend"?this._legend:s1(e)?e:null}_getFirstWidget(){const{content:e}=this;if(Array.isArray(e)){let t=null;return e.some(i=>{const r=this._getWidget(i);return r&&(t=r),!!r}),t}return this._getWidget(e)}};g([w()],Gl.prototype,"_legend",void 0),g([w()],Gl.prototype,"className",null),g([w()],Gl.prototype,"content",void 0),g([w()],Gl.prototype,"disabled",null),g([w()],Gl.prototype,"image",void 0),g([w()],Gl.prototype,"listItem",void 0),g([w()],Gl.prototype,"title",null),g([w()],Gl.prototype,"open",void 0),g([w()],Gl.prototype,"visible",void 0),Gl=g([te("esri.widgets.LayerList.ListItemPanel")],Gl);const foe=Gl;var K3;const QVe=Xe.ofType({key:"type",defaultKeyValue:"button",base:wg,typeMap:{button:k0,toggle:I6,slider:BVe}}),yoe=Xe.ofType(QVe),e$="layer",UR="child-list-mode",eze="hide",tze="esri.widgets.LayerList.ListItem";let _r=K3=class extends rc(ls(Ye)){constructor(e){super(e),this.actionsSections=new yoe,this.actionsOpen=!1,this.checkPublishStatusEnabled=!1,this.children=new(Xe.ofType(K3)),this.childrenSortable=!0,this.hidden=!1,this.layer=null,this.layerView=null,this.listItemCreatedFunction=null,this.open=!1,this.panel=null,this.parent=null,this.sortable=!0,this.view=null}initialize(){if(this.handles.add([we(()=>this.layer,e=>this._watchLayerProperties(e),St),we(()=>this.checkPublishStatusEnabled,e=>this._updateChildrenPublishing(e),St),we(()=>this.view,e=>this._updateChildrenView(e),St),we(()=>this.panel,e=>this._setListItemOnPanel(e),St),we(()=>[this.layer,this.view],()=>this._getLayerView(),St)]),typeof this.listItemCreatedFunction=="function"){const e={item:this};this.listItemCreatedFunction.call(null,e)}}destroy(){this.view=null}get connectionStatus(){const{layerView:e,publishing:t}=this;if(!t&&e&&"connectionStatus"in e)return e.connectionStatus}get error(){var e;return(e=this.layer)==null?void 0:e.loadError}get incompatible(){const{layerView:e}=this;return!(!e||!("spatialReferenceSupported"in e))&&!e.spatialReferenceSupported}castPanel(e){return this.get("panel.open")&&!e.hasOwnProperty("open")&&(e.open=!0),e?new foe(e):null}get title(){const e=this.get("layer.layer");return(!e||e&&this.get("layer.layer.loaded"))&&this.get("layer.title")||this.get("layer.attributes.title")||""}set title(e){this._override("title",e)}get publishing(){const{layer:e,checkPublishStatusEnabled:t}=this;return t&&e&&"publishingInfo"in e&&e.publishingInfo.status==="publishing"}get updating(){const{layerView:e,connectionStatus:t,layer:i,publishing:r}=this;return!r&&!t&&(e?e.updating:(i==null?void 0:i.loadStatus)==="loading"||!1)}get visible(){var e;return(e=this.layer)==null?void 0:e.visible}set visible(e){const t=this.layer;t&&(t.visible=e)}get visibleAtCurrentScale(){return!JVe(this.layer,this.get("view.scale"))}get visibilityMode(){return HVe(this.layer)}clone(){return new K3({actionsSections:this.actionsSections.clone(),actionsOpen:this.actionsOpen,checkPublishStatusEnabled:this.checkPublishStatusEnabled,children:this.children.clone(),layer:this.layer,listItemCreatedFunction:this.listItemCreatedFunction,open:this.open,panel:this.panel,title:this.title,view:this.view,visible:this.visible})}_setListItemOnPanel(e){e&&(e.listItem=this)}_updateChildrenPublishing(e){const t=this.children;t&&t.forEach(i=>i.checkPublishStatusEnabled=e)}_updateChildrenView(e){const t=this.children;t&&t.forEach(i=>i.view=e)}_addChildren(e){if(this.handles.remove(UR),this.children.removeAll(),!e)return;e.forEach(i=>{this.handles.add(we(()=>i.listMode,()=>this._addChildren(e)),UR)});const t=e.filter(i=>Q4(i)!==eze);this.children.addMany(this._makeChildren(t))}_watchSublayerChanges(e){e&&this.handles.add(e.on("change",()=>{this._addChildren(e)}),e$)}_initializeChildLayers(e){this._addChildren(e),this._watchSublayerChanges(e)}_makeChildren(e){return e.map(t=>GR(t)?new K3({layer:t,checkPublishStatusEnabled:this.checkPublishStatusEnabled,listItemCreatedFunction:this.listItemCreatedFunction,parent:this,view:this.view}):null).reverse()}_watchLayerProperties(e){if(!this.handles||(this.handles.remove(e$),this.handles.remove(UR),!e))return;if(this.handles.add(we(()=>e.listMode,()=>this._watchLayerProperties(e)),e$),Q4(e)==="hide-children")return void this.children.removeAll();const t=zR(e);t&&this.handles.add(we(()=>e[t],()=>{e.hasOwnProperty(t)&&this._initializeChildLayers(e[t])},St),e$)}async _getLayerView(){const{layer:e,view:t}=this;if(e&&t)try{const i=await t.whenLayerView(e);if(i.layer!==this.layer)return;this._set("layerView",i)}catch{}}};g([w({type:yoe})],_r.prototype,"actionsSections",void 0),g([w()],_r.prototype,"actionsOpen",void 0),g([w()],_r.prototype,"checkPublishStatusEnabled",void 0),g([w({type:Xe})],_r.prototype,"children",void 0),g([w()],_r.prototype,"childrenSortable",void 0),g([w({readOnly:!0})],_r.prototype,"connectionStatus",null),g([w({readOnly:!0})],_r.prototype,"error",null),g([w()],_r.prototype,"hidden",void 0),g([w({readOnly:!0})],_r.prototype,"incompatible",null),g([w()],_r.prototype,"layer",void 0),g([w({readOnly:!0})],_r.prototype,"layerView",void 0),g([w()],_r.prototype,"listItemCreatedFunction",void 0),g([w()],_r.prototype,"open",void 0),g([w({type:foe})],_r.prototype,"panel",void 0),g([Dt("panel")],_r.prototype,"castPanel",null),g([w()],_r.prototype,"parent",void 0),g([w()],_r.prototype,"sortable",void 0),g([w()],_r.prototype,"title",null),g([w({readOnly:!0})],_r.prototype,"publishing",null),g([w({readOnly:!0})],_r.prototype,"updating",null),g([w()],_r.prototype,"view",void 0),g([w()],_r.prototype,"visible",null),g([w({readOnly:!0})],_r.prototype,"visibleAtCurrentScale",null),g([w({readOnly:!0})],_r.prototype,"visibilityMode",null),_r=K3=g([te(tze)],_r);const t$=_r,sl={view:"view",viewLayers:"view-layers",mapLayers:"map-layers",layerViews:"layer-views",layerListMode:"layer-list-mode",children:"children"},ize="hide",moe=Xe.ofType(t$);let Uf=class extends Or.EventedAccessor{constructor(e){super(e),this._handles=new Ti,this.checkPublishStatusEnabled=!1,this.listItemCreatedFunction=null,this.operationalItems=new moe,this.view=null}initialize(){this._handles.add([we(()=>{var e;return[this.view,(e=this.view)==null?void 0:e.ready]},()=>this._viewHandles(),St),we(()=>[this.listItemCreatedFunction,this.checkPublishStatusEnabled],()=>this._recompileList())],sl.view)}destroy(){this._handles.destroy(),this._handles=null,this.view=null,this.operationalItems.removeAll()}get state(){const e=this.get("view");return this.get("view.ready")?"ready":e?"loading":"disabled"}triggerAction(e,t){e&&!e.disabled&&this.emit("trigger-action",{action:e,item:t})}moveListItem(e,t,i,r){var E,k;const n=e==null?void 0:e.layer;if(!n)return;const o=(k=(E=this.view)==null?void 0:E.map)==null?void 0:k.layers,c=t?doe(t):o,h=i?doe(i):o;if(!c||!h)return;const{operationalItems:m}=this,b=(t==null?void 0:t.children)||m,x=(i==null?void 0:i.children)||m,I=h.length-r;e.parent=i||null,b.includes(e)&&b.remove(e),c.includes(n)&&c.remove(n),x.includes(e)||x.add(e,I),h.includes(n)||h.add(n,I)}_createLayerViewHandles(e){const{_handles:t}=this;t.remove(sl.layerViews),this._compileList(),e&&t.add(e.on("change",()=>this._compileList()),sl.layerViews)}_createMapLayerHandles(e){const{_handles:t}=this;t.remove(sl.mapLayers),this._compileList(),e&&t.add(e.on("change",()=>this._compileList()),sl.mapLayers)}_createListItem(e){const{view:t,listItemCreatedFunction:i,checkPublishStatusEnabled:r}=this;return new t$({checkPublishStatusEnabled:r,layer:e,listItemCreatedFunction:i,view:t})}_removeAllItems(){const{_handles:e,operationalItems:t}=this;t.forEach(i=>{e.remove(`${sl.children}-${i.uid}`)}),t.removeAll()}_getViewableLayers(e){if(e)return e.filter(t=>Q4(t)!==ize)}_watchLayersListMode(e){const{_handles:t}=this;t.remove(sl.layerListMode),e&&e.forEach(i=>{"listMode"in i&&t.add(we(()=>i.listMode,()=>this._compileList()),sl.layerListMode)})}_compileList(){const e=this.get("view.map.layers");this._watchLayersListMode(e);const t=this._getViewableLayers(e);t&&t.length?(this._createNewItems(t),this._removeItems(t),this._sortItems(t)):this._removeAllItems()}_createNewItems(e){const{operationalItems:t}=this;e.forEach(i=>{t.find(r=>r.layer===i)||t.add(this._createListItem(i))})}_removeItems(e){const{_handles:t,operationalItems:i}=this,r=[];i.forEach(n=>{n&&e&&e.includes(n.layer)||(t.remove(`${sl.children}-${n.uid}`),r.push(n))}),i.removeMany(r)}_sortItems(e){const{operationalItems:t}=this;t.sort((i,r)=>{const n=e.indexOf(i.layer),o=e.indexOf(r.layer);return n>o?-1:n<o?1:0})}_recompileList(){this._removeAllItems(),this._compileList()}_viewHandles(){const{_handles:e,view:t}=this;e.remove([sl.mapLayers,sl.layerViews,sl.viewLayers]),this._compileList(),t&&t.ready&&e.add([we(()=>{var i,r;return(r=(i=this.view)==null?void 0:i.map)==null?void 0:r.allLayers},i=>this._createMapLayerHandles(i),St),we(()=>{var i;return(i=this.view)==null?void 0:i.allLayerViews},i=>this._createLayerViewHandles(i),St)],sl.viewLayers)}};g([w()],Uf.prototype,"checkPublishStatusEnabled",void 0),g([w()],Uf.prototype,"listItemCreatedFunction",void 0),g([w({type:moe})],Uf.prototype,"operationalItems",void 0),g([w({readOnly:!0})],Uf.prototype,"state",null),g([w()],Uf.prototype,"view",void 0),Uf=g([te("esri.widgets.LayerList.LayerListViewModel")],Uf);const qR=Uf;function goe(e,t,i){e.splice(i,0,e.splice(t,1)[0])}const rze="esri-layerlist-new-ui",nze=Xe.ofType(t$),voe="data-sort-filter",boe="data-layer-uid",sze="layerUid",xt={base:"esri-layer-list esri-widget esri-widget--panel",newUI:"esri-layer-list--new-ui",noItems:"esri-layer-list__no-items",list:"esri-layer-list__list",listRoot:"esri-layer-list__list--root",listExclusive:"esri-layer-list__list--exclusive",listInherited:"esri-layer-list__list--inherited",listIndependent:"esri-layer-list__list--independent",item:"esri-layer-list__item",itemContent:"esri-layer-list__item-content",itemMessage:"esri-layer-list__item--has-message",itemInvisible:"esri-layer-list__item--invisible",itemInvisibleAtScale:"esri-layer-list__item--invisible-at-scale",itemChildren:"esri-layer-list__item--has-children",itemSelectable:"esri-layer-list__item--selectable",itemContainer:"esri-layer-list__item-container",actionsMenu:"esri-layer-list__item-actions-menu",actionsMenuItem:"esri-layer-list__item-actions-menu-item",actionsMenuItemActive:"esri-layer-list__item-actions-menu-item--active",actions:"esri-layer-list__item-actions",actionsList:"esri-layer-list__item-actions-list",action:"esri-layer-list__item-action",actionIcon:"esri-layer-list__item-action-icon",actionImage:"esri-layer-list__item-action-image",actionTitle:"esri-layer-list__item-action-title",actionToggle:"esri-layer-list__action-toggle",actionToggleOn:"esri-layer-list__action-toggle--on",label:"esri-layer-list__item-label",message:"esri-layer-list__item-message",title:"esri-layer-list__item-title",statusIndicator:"esri-layer-list__status-indicator",publishing:"esri-layer-list__publishing",updating:"esri-layer-list__updating",connectionStatus:"esri-layer-list__connection-status",connectionStatusConnected:"esri-layer-list__connection-status--connected",toggleVisible:"esri-layer-list__item-toggle",toggleVisibleIcon:"esri-layer-list__item-toggle-icon",toggleIcon:"esri-layer-list__item-toggle-icon",radioIcon:"esri-layer-list__item-radio-icon",childToggle:"esri-layer-list__child-toggle",childToggleOpen:"esri-layer-list__child-toggle--open",childOpened:"esri-layer-list__child-toggle-icon--opened",childClosed:"esri-layer-list__child-toggle-icon--closed",childClosed_RTL:"esri-layer-list__child-toggle-icon--closed-rtl",sortableChosen:"esri-layer-list--chosen",disabled:"esri-disabled",disabledElement:"esri-disabled-element",hidden:"esri-hidden",rotating:"esri-rotating",iconEllipses:"esri-icon-handle-horizontal",iconVisible:"esri-icon-visible",iconInvisible:"esri-icon-non-visible",iconRadioSelected:"esri-icon-radio-checked",iconRadioUnselected:"esri-icon-radio-unchecked",iconNoticeTriangle:"esri-icon-notice-triangle",iconChildrenOpen:"esri-icon-down-arrow",iconDownArrow:"esri-icon-down-arrow",iconRightArrow:"esri-icon-right-triangle-arrow",iconLeftArrow:"esri-icon-left-triangle-arrow",iconLoading:"esri-icon-loading-indicator",iconDefaultAction:"esri-icon-default-action",widgetIcon:"esri-icon-layers"},HR={actions:"actions",actionSection:"action-section",items:"items"},Y3={exclusive:"exclusive",inherited:"inherited",independent:"independent"};function woe(e){const{actionsOpen:t,children:i}=e;t&&(e.actionsOpen=!1),i.forEach(r=>woe(r))}const WR="root",_oe={statusIndicators:!0,errors:!1};let Qr=class extends ki{constructor(e,t){super(e,t),this._handles=new Ti,this._sortableNodes=new Map,this._sortableMap=new Map,this._focusSortUid=null,this._newUI=Te(rze),this._tooltipReferenceMap=new Map,this.visibleItems=null,this.iconClass=xt.widgetIcon,this.listItemCanGiveFunction=null,this.listItemCanReceiveFunction=null,this.messages=null,this.messagesCommon=null,this.multipleSelectionEnabled=!1,this.selectionEnabled=!1,this.selectedItems=new nze,this.viewModel=new qR,this.visibleElements=K({},_oe),this._onSortableSort=({to:i,from:r,item:n,newIndex:o})=>{r&&i&&(r===i?this._sortLayers(this._sortableMap.get(r.dataset.group)):this._moveLayerFromChildList({to:i,from:r,item:n,newIndex:o}))},this._sortableCanSort=(i,r)=>!(!i.el.dataset.group||!r.el.dataset.group),this._sortableCanPull=(i,r,n)=>{const{listItemCanGiveFunction:o}=this,c={selected:n["data-item"],from:r.el["data-item"],to:i.el["data-item"]};return!this._sortableCanSort(i,r)||typeof o!="function"||o.call(null,c)},this._sortableCanPut=(i,r,n)=>{const{listItemCanReceiveFunction:o}=this,c={selected:n["data-item"],from:r.el["data-item"],to:i.el["data-item"]};return!this._sortableCanSort(i,r)||typeof o!="function"||o.call(null,c)},this._onSortableEnd=({oldIndex:i,from:r,to:n,item:o})=>{r!==n&&r.insertBefore(o,r.children[i])}}initialize(){const e=this.operationalItems;this._setVisibleItems(e),this.addHandles([vr(()=>this.operationalItems,"change",()=>this._itemsChanged(e)),we(()=>this.visibleElements,()=>this._itemsChanged(e)),we(()=>this.selectionEnabled,()=>this._toggleAllSorting(),St)])}loadDependencies(){return Promise.all([import("./calcite-icon.3e014da3.js"),import("./calcite-tooltip.0077a311.js")])}destroy(){this._destroySortables(),this._tooltipReferenceMap.clear(),this._handles.destroy(),this._handles=null}get label(){var e,t;return(t=(e=this.messages)==null?void 0:e.widgetLabel)!=null?t:""}set label(e){this._overrideIfSome("label",e)}get listItemCreatedFunction(){return this.viewModel.listItemCreatedFunction}set listItemCreatedFunction(e){this.viewModel.listItemCreatedFunction=e}get operationalItems(){return this.viewModel.operationalItems}set operationalItems(e){this.viewModel.operationalItems=e}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}castVisibleElements(e){return K(K({},_oe),e)}triggerAction(e,t){return this.viewModel.triggerAction(e,t)}render(){var c;const{visibleItems:e,_newUI:t}=this,i=(c=this.viewModel)==null?void 0:c.state,r={[xt.newUI]:t,[xt.hidden]:i==="loading",[xt.disabled]:i==="disabled"},n=this.renderItemTooltips(),o=this.renderItems();return j("div",{class:this.classes(xt.base,r)},(e==null?void 0:e.length)?[n,o]:this.renderNoItems())}renderItemTooltip(e){const{_tooltipReferenceMap:t,messages:i}=this;return e?j("calcite-tooltip",{label:i.layerIncompatible,referenceElement:t.get(e.uid)},i.layerIncompatibleTooltip):null}renderItemTooltipNodes(e){const{incompatible:t,children:i}=e;return[t?this.renderItemTooltip(e):null,...t?[]:i==null?void 0:i.toArray().map(r=>this.renderItemTooltipNodes(r))]}renderItemTooltips(){return this.visibleItems.toArray().map(e=>this.renderItemTooltipNodes(e))}renderNoItems(){return j("div",{class:xt.noItems},this.messages.noItemsToDisplay)}renderItems(){const{visibleItems:e,selectionEnabled:t,messages:i}=this;return j("ul",{"aria-label":i.widgetLabel,role:t?"listbox":void 0,afterCreate:this._sortNodeCreated,afterUpdate:this._sortNodeCreated,afterRemoved:this._sortNodeRemoved,"data-group":WR,bind:this,class:this.classes(xt.list,xt.listRoot,xt.listIndependent)},e==null?void 0:e.map(r=>this.renderItem(r,null)).toArray())}renderActionsMenuIcon(e,t){const{messagesCommon:i}=this,r={[xt.actionsMenuItemActive]:e.actionsOpen};return j("div",{key:"actions-menu-toggle","data-item":e,bind:this,onclick:this._toggleActionsOpen,onkeydown:this._toggleActionsOpen,class:this.classes(xt.actionsMenuItem,r),tabindex:"0",role:"button","aria-controls":t,"aria-label":i.options,title:i.options},j("span",{"aria-hidden":"true",class:xt.iconEllipses}))}renderActionsMenu(e,t,i,r){const{panel:n}=e,o=n&&n.visible?this.renderPanelButton(n):null,c=i===1&&this._getSingleActionButton(t),h=c?this.renderAction({item:e,action:c,singleAction:!0}):null,m=!c&&i?this.renderActionsMenuIcon(e,r):null;return m||o||c?j("div",{key:"actions-menu",class:xt.actionsMenu},o,h,m):null}renderChildList(e,t){var x;const{selectionEnabled:i}=this,{visibilityMode:r,children:n}=e,o=this._hasChildren(e),c=!o&&i&&((x=e.layer)==null?void 0:x.type)==="group",{exclusive:h,inherited:m}=Y3,b={[xt.listExclusive]:r===h,[xt.listInherited]:r===m,[xt.listIndependent]:r!==m&&r!==h};return o||c?j("ul",{bind:this,key:"list-items",id:t,"data-group":e.uid,"data-item":e,afterCreate:this._sortNodeCreated,afterUpdate:this._sortNodeCreated,afterRemoved:this._sortNodeRemoved,class:this.classes(xt.list,b),"aria-expanded":e.open?"true":"false",role:i?"listbox":r===h?"radiogroup":"group",hidden:!e.open&&!c||null},n==null?void 0:n.map(I=>this.renderItem(I,e)).toArray()):null}renderChildrenToggle(e,t){const{messagesCommon:i}=this,r=this._hasChildren(e),n={[xt.childToggleOpen]:e.open},o=e.open?i.collapse:i.expand;return r?j("span",{onclick:this._toggleChildrenClick,onkeydown:this._toggleChildrenClick,"data-item":e,key:"toggle-children",class:this.classes(xt.childToggle,n),tabindex:"0",role:"button","aria-controls":t,"aria-label":o,title:o},j("span",{"aria-hidden":"true",class:this.classes(xt.childClosed,xt.iconRightArrow)}),j("span",{"aria-hidden":"true",class:this.classes(xt.childOpened,xt.iconDownArrow)}),j("span",{"aria-hidden":"true",class:this.classes(xt.childClosed_RTL,xt.iconLeftArrow)})):null}renderItemMessage(e){return e.error?j("div",{key:"esri-layer-list__error",class:xt.message,role:"alert"},j("span",{"aria-hidden":"true",class:xt.iconNoticeTriangle}),this.messages.layerError):e.incompatible?j("div",{key:"esri-layer-list__incompatible",class:xt.message,role:"alert"},j("span",{bind:this,tabIndex:0,"aria-hidden":"true",class:xt.iconNoticeTriangle,afterCreate:t=>this._setTooltipReference(t,e)}),this.messages.layerIncompatible):null}renderItemContent(e,t,i){const{id:r}=this,n=`${r}_${e.uid}`,o=`${n}_actions`,c=`${n}__list`,{panel:h}=e,m=this._filterActions(e.actionsSections),b=this._countActions(m);return[j("div",{key:"list-item-container",class:xt.itemContainer},this.renderChildrenToggle(e,c),this.renderLabel(e,t,i),this.renderActionsMenu(e,m,b,o)),this.renderItemMessage(e),b?this.renderActionsSections(e,m,o):null,h&&h.open&&!h.disabled?h.render():null,this.renderChildList(e,c)]}renderItem(e,t){var x;const{_newUI:i,id:r,selectionEnabled:n,selectedItems:o}=this,c=`${`${r}_${e.uid}`}__title`,h=this._hasMessage(e),m=this._hasChildren(e),b={[xt.itemChildren]:m,[xt.itemMessage]:!!h,[xt.itemInvisible]:i&&!e.visible,[xt.itemInvisibleAtScale]:!e.visibleAtCurrentScale,[xt.itemSelectable]:n};if(n){const I={[boe]:(x=e.layer)==null?void 0:x.uid,[voe]:(!e.sortable).toString()};return j("li",K({key:`item-with-selection-${e.uid}`,bind:this,afterCreate:this._focusListItem,afterUpdate:this._focusListItem,class:this.classes(xt.item,b),"aria-labelledby":c,onclick:this._toggleSelection,onkeydown:this._selectionKeydown,"data-item":e,"data-group":t?t.uid:WR,tabIndex:0,"aria-selected":BR(e,o)?"true":"false",role:"option"},I),this.renderItemContent(e,t,c))}return j("li",{key:`item-no-selection-${e.uid}`,bind:this,afterCreate:this._focusListItem,afterUpdate:this._focusListItem,class:this.classes(xt.item,b),"aria-labelledby":c},this.renderItemContent(e,t,c))}renderConnectionIcon(e){const{connectionStatus:t}=e;return H(t)?j("calcite-icon",{icon:t==="connected"?"check-circle":"offline",scale:"s"}):null}renderItemStatus(e,t){const{visibleElements:i}=this;if(!i.statusIndicators)return null;const{connectionStatus:r,publishing:n,updating:o}=e,c=o&&!t,h=!!r;return j("span",{class:this.classes({[xt.statusIndicator]:!0,[xt.publishing]:n,[xt.updating]:c,[xt.connectionStatus]:h,[xt.connectionStatusConnected]:h&&r==="connected"}),key:"layer-item-status"},this.renderConnectionIcon(e))}renderItemTitle(e,t){const{messages:i}=this;if(!e)return null;const r=e.title||i.untitledLayer,n=e.visibleAtCurrentScale?r:`${r} (${i.layerInvisibleAtScale})`;return j("span",{key:"layer-title-container",id:t,title:n,"aria-label":n,class:xt.title},r)}renderItemToggleIcon(e,t){const{_newUI:i}=this,{exclusive:r}=Y3,n=t&&t.visibilityMode,o={[xt.toggleVisibleIcon]:i,[xt.toggleIcon]:i&&n!==r,[xt.radioIcon]:i&&n===r,[xt.iconRadioSelected]:n===r&&e.visible,[xt.iconRadioUnselected]:n===r&&!e.visible,[xt.iconVisible]:n!==r&&e.visible,[xt.iconInvisible]:n!==r&&!e.visible};return j("span",{key:"item-toggle-icon",class:this.classes(o),"aria-hidden":"true"})}renderItemToggle(e,t,i){const{selectionEnabled:r,messages:n}=this,{exclusive:o}=Y3,c=t&&t.visibilityMode,h=c===o?"radio":"switch";return j("span",r?{key:"item-toggle-selection-enabled",class:xt.toggleVisible,bind:this,onclick:this._toggleVisibility,onkeydown:this._toggleVisibility,"data-item":e,"data-parent-visibility":c,tabIndex:0,title:e.visible?n.hideLayer:n.showLayer,"aria-checked":e.visible?"true":"false",role:h,"aria-labelledby":i}:{key:"item-toggle",class:xt.toggleVisible},this.renderItemToggleIcon(e,t))}renderLabel(e,t,i){const{selectionEnabled:r,_newUI:n,messages:o}=this,{inherited:c,exclusive:h}=Y3,m=t==null?void 0:t.visibilityMode,b=m===h?"radio":"switch",x=n?[this.renderItemTitle(e,i),this.renderItemStatus(e,t),this.renderItemToggle(e,t,i)]:[this.renderItemToggle(e,t,i),this.renderItemTitle(e,i),this.renderItemStatus(e,t)],I=j("div",r?{key:`item-label-no-selection-${e.uid}`,class:xt.label}:{key:`item-label-with-selection-${e.uid}`,class:xt.label,bind:this,onclick:this._toggleVisibility,onkeydown:this._toggleVisibility,"data-item":e,"data-parent-visibility":m,tabIndex:0,"aria-checked":e.visible?"true":"false",title:e.visible?o.hideLayer:o.showLayer,role:b,"aria-labelledby":i},x);return m===c||e.error?j("div",{key:`item-label-container-${e.uid}`,class:xt.label},this.renderItemTitle(e,i),this.renderItemStatus(e,t)):I}renderPanelButton(e){const{className:t,open:i,title:r,image:n}=e,o=n||t?t:xt.iconDefaultAction,c=this._getIconImageStyles(e),h={[xt.actionsMenuItemActive]:i},m={[xt.actionImage]:!!c["background-image"],[xt.disabledElement]:e.disabled};return o&&(m[o]=!!o),j("div",{"aria-disabled":e.disabled.toString(),key:`panel-${e.uid}`,bind:this,"data-panel":e,onclick:this._triggerPanel,onkeydown:this._triggerPanel,class:this.classes(xt.actionsMenuItem,h),role:"button",tabindex:e.disabled?null:0,title:r,"aria-label":r},j("span",{class:this.classes(m),styles:c}))}renderActionsSections(e,t,i){const r=t.toArray().map((n,o)=>j("ul",{key:`${e}-action-section-${o}`,class:xt.actionsList},this.renderActionSection(e,n)));return j("div",{role:"group","aria-expanded":e.actionsOpen?"true":"false",key:"actions-section",id:i,class:xt.actions,hidden:!e.actionsOpen||null},r)}renderActionSection(e,t){return(t&&t.toArray()).map(i=>this.renderAction({item:e,action:i}))}renderActionIcon(e){const{active:t,className:i}=e,r=this._getIconImageStyles(e),n=e.type!=="button"||e.image||i?i:xt.iconDefaultAction,o={[xt.actionImage]:!t&&!!r["background-image"],[xt.iconLoading]:t,[xt.rotating]:t};return n&&!t&&(o[n]=!0),j("span",{key:"action-icon","aria-hidden":"true",class:this.classes(xt.actionIcon,o),styles:r})}renderActionTitle(e,t){return t?null:j("span",{key:"action-title",class:xt.actionTitle},e)}renderAction(e){const{item:t,action:i,singleAction:r}=e,{active:n,disabled:o,title:c}=i,h={[xt.actionsMenuItem]:r&&i.type==="button",[xt.action]:n||!r&&i.type!=="toggle",[xt.actionToggle]:!n&&i.type==="toggle",[xt.actionToggleOn]:!n&&i.type==="toggle"&&i.value,[xt.disabledElement]:o},m=[this.renderActionIcon(i),this.renderActionTitle(c,r)];return r?j("div",{bind:this,"data-item":t,"data-action":i,role:"button",key:`single-action-${i.uid}`,onclick:this._triggerAction,onkeydown:this._triggerAction,classes:h,tabindex:"0",title:c,"aria-label":c},m):j("li",{bind:this,"data-item":t,"data-action":i,key:`action-${i.uid}`,onclick:this._triggerAction,onkeydown:this._triggerAction,classes:h,tabindex:"0",role:"button",title:c,"aria-label":c},m)}_setTooltipReference(e,t){this._tooltipReferenceMap.set(t.uid,e),this.scheduleRender()}_hasMessage(e){return!!e.error||e.incompatible}_hasChildren(e){return!!e.children.length&&!this._hasMessage(e)}_sortNodeRemoved(e){const{_sortableMap:t}=this,i=e.dataset.group,r=t.get(i);r&&r.destroy(),t.delete(i)}_destroySortables(){const{_sortableMap:e,_sortableNodes:t}=this;e.forEach(i=>i&&i.destroy()),e.clear(),t.clear()}_moveLayerFromChildList({to:e,from:t,item:i,newIndex:r}){const n=i["data-item"],o=e["data-item"],c=t["data-item"];this.viewModel.moveListItem(n,c,o,r)}_sortLayers(e){var r,n;if(!e)return;const t=e.el["data-item"],i=e.toArray();t?ZVe(t,i):poe((n=(r=this.view)==null?void 0:r.map)==null?void 0:n.layers,i)}_toggleSorting(e,t){const{_sortableMap:i,selectionEnabled:r}=this,n=i.get(t),o=e["data-item"],c=(t===WR||o.childrenSortable&&WVe(o))&&r;if(n)n.option("disabled",!c);else if(c){const h=Yt.create(e,{dataIdAttr:boe,group:{name:t,pull:this._sortableCanPull,put:this._sortableCanPut},filter:`[${voe}="true"]`,fallbackTolerance:4,onSort:this._onSortableSort,onEnd:this._onSortableEnd,disabled:!c,chosenClass:xt.sortableChosen});i.set(t,h)}}_toggleAllSorting(){this._sortableNodes.forEach((e,t)=>this._toggleSorting(e,t))}_sortNodeCreated(e){const t=e.dataset.group;t&&(this._sortableNodes.set(t,e),this._toggleSorting(e,t))}_setVisibleItems(e){this.visibleItems=e==null?void 0:e.filter(t=>!t.hidden&&(this.visibleElements.errors||!t.error))}_getSingleActionButton(e){return e.reduce(t=>t).filter(t=>t&&t.type==="button").getItemAt(0)}_focusListItem(e){var i;const{_focusSortUid:t}=this;!e||!t||((i=e["data-item"].layer)==null?void 0:i.uid)===t&&(e.focus(),this._focusSortUid=null)}_watchActionSectionChanges(e,t){const i=HR.actionSection+t;this._handles.add(e.on("change",this.scheduleRender.bind(this)),i),e.forEach(r=>this._renderOnActionChanges(r,t))}_renderOnActionChanges(e,t){const i=HR.actions+t;e.type!=="toggle"?e.type!=="slider"?this._handles.add(we(()=>[e==null?void 0:e.className,e==null?void 0:e.image,e==null?void 0:e.id,e==null?void 0:e.title,e==null?void 0:e.visible],()=>this.scheduleRender(),St),i):this._handles.add(we(()=>[e==null?void 0:e.className,e==null?void 0:e.id,e==null?void 0:e.title,e==null?void 0:e.visible,e==null?void 0:e.value,e==null?void 0:e.displayValueEnabled,e==null?void 0:e.max,e==null?void 0:e.min,e==null?void 0:e.step],()=>this.scheduleRender(),St),i):this._handles.add(we(()=>[e==null?void 0:e.className,e==null?void 0:e.image,e==null?void 0:e.id,e==null?void 0:e.title,e==null?void 0:e.visible,e==null?void 0:e.value],()=>this.scheduleRender(),St),i)}_renderOnItemChanges(e){const t=e.uid,i=HR.items+t;this._handles.add([we(()=>{var r,n,o;return[e==null?void 0:e.actionsOpen,e==null?void 0:e.visible,e==null?void 0:e.open,e==null?void 0:e.updating,e==null?void 0:e.connectionStatus,e==null?void 0:e.publishing,e==null?void 0:e.title,e==null?void 0:e.visibleAtCurrentScale,e==null?void 0:e.error,e==null?void 0:e.visibilityMode,e==null?void 0:e.panel,(r=e==null?void 0:e.panel)==null?void 0:r.title,(n=e==null?void 0:e.panel)==null?void 0:n.content,(o=e==null?void 0:e.panel)==null?void 0:o.className,e==null?void 0:e.sortable,e==null?void 0:e.childrenSortable]},()=>this.scheduleRender(),Gs),we(()=>[e==null?void 0:e.hidden,e==null?void 0:e.error],()=>this._setVisibleItems(this.operationalItems)),e.actionsSections.on("change",()=>this.scheduleRender()),e.children.on("change",()=>this.scheduleRender())],i),e.children.forEach(r=>this._renderOnItemChanges(r)),e.actionsSections.forEach(r=>this._watchActionSectionChanges(r,t))}_itemsChanged(e){this._handles.removeAll(),e.forEach(t=>this._renderOnItemChanges(t)),this._tooltipReferenceMap.clear(),this._setVisibleItems(e),this.scheduleRender()}_filterActions(e){return e.map(t=>t.filter(i=>i.visible))}_countActions(e){return e.reduce((t,i)=>t+i.length,0)}_getIconImageStyles(e){const t=e.declaredClass==="esri.widgets.LayerList.ListItemPanel"||e.declaredClass==="esri.support.Action.ActionButton"||e.declaredClass==="esri.support.Action.ActionToggle"?e.image:null;return{"background-image":t?`url("${t}")`:null}}_selectionKeydown(e){var k,P,F,N;const t=["ArrowDown","ArrowUp"],i=to(e);if(!t.includes(i))return void this._toggleSelection(e);e.stopPropagation();const r=e.currentTarget,n=r["data-item"],{_sortableMap:o,selectedItems:c}=this,h=r.dataset.group,m=o.get(h);if(!m)return;const b=BR(n,c),x=m.toArray(),I=e.target,E=x.indexOf(I.dataset[sze]);if(E!==-1){if(i==="ArrowDown"){const B=E+1;if(B>=x.length)return;b?(goe(x,E,B),m.sort(x),this._sortLayers(m),this._focusSortUid=(k=n.layer)==null?void 0:k.uid):(this._focusSortUid=(P=n.layer)==null?void 0:P.uid,this.scheduleRender())}if(i==="ArrowUp"){const B=E-1;if(B<=-1)return;b?(goe(x,E,B),m.sort(x),this._sortLayers(m),this._focusSortUid=(F=n.layer)==null?void 0:F.uid):(this._focusSortUid=(N=n.layer)==null?void 0:N.uid,this.scheduleRender())}}}_toggleActionsOpen(e){const t=e.currentTarget["data-item"],{actionsOpen:i}=t,r=!i;r&&this.operationalItems.forEach(n=>woe(n)),t.actionsOpen=r,e.stopPropagation()}_triggerPanel(e){const t=e.currentTarget["data-panel"];e.stopPropagation(),t&&!t.disabled&&(t.open=!t.open)}_triggerAction(e){const t=e.currentTarget,i=t["data-action"],r=t["data-item"];i.type==="toggle"&&(i.value=!i.value),this.triggerAction(i,r),e.stopPropagation()}_toggleVisibility(e){const t=e.currentTarget,i=t.getAttribute("data-parent-visibility"),r=t["data-item"];i===Y3.exclusive&&r.visible||(r.visible=!r.visible),e.stopPropagation()}_toggleChildrenClick(e){const t=e.currentTarget["data-item"];t.open=!t.open,e.stopPropagation()}_toggleSelection(e){var c,h;e.stopPropagation();const{multipleSelectionEnabled:t,selectedItems:i}=this,r=e.currentTarget["data-item"],n=BR(r,i),{length:o}=i;if(!t)return o&&!(n&&o===1)?(i.removeAll(),void i.add(r)):void(n?(c=i.remove)==null?void 0:c.call(i,n):i.add(r));n?(h=i.remove)==null||h.call(i,n):i.add(r)}};g([w()],Qr.prototype,"visibleItems",void 0),g([w()],Qr.prototype,"iconClass",void 0),g([w()],Qr.prototype,"label",null),g([w()],Qr.prototype,"listItemCanGiveFunction",void 0),g([w()],Qr.prototype,"listItemCanReceiveFunction",void 0),g([w()],Qr.prototype,"listItemCreatedFunction",null),g([w(),ci("esri/widgets/LayerList/t9n/LayerList")],Qr.prototype,"messages",void 0),g([w(),ci("esri/t9n/common")],Qr.prototype,"messagesCommon",void 0),g([w()],Qr.prototype,"multipleSelectionEnabled",void 0),g([w()],Qr.prototype,"operationalItems",null),g([w()],Qr.prototype,"selectionEnabled",void 0),g([w()],Qr.prototype,"selectedItems",void 0),g([w()],Qr.prototype,"view",null),g([n1("trigger-action"),w({type:qR})],Qr.prototype,"viewModel",void 0),g([w()],Qr.prototype,"visibleElements",void 0),g([Dt("visibleElements")],Qr.prototype,"castVisibleElements",null),g([Ki()],Qr.prototype,"_toggleActionsOpen",null),g([Ki()],Qr.prototype,"_triggerPanel",null),g([Ki()],Qr.prototype,"_triggerAction",null),g([Ki()],Qr.prototype,"_toggleVisibility",null),g([Ki()],Qr.prototype,"_toggleChildrenClick",null),g([Ki()],Qr.prototype,"_toggleSelection",null),Qr=g([te("esri.widgets.LayerList")],Qr);let pb=class extends Ye{constructor(e){super(e),this.format=null,this.position={coordinate:null,location:null}}get displayCoordinate(){const e=this.get("format");return e&&e.getDisplayCoordinate(this.get("position.coordinate"))}};g([w({readOnly:!0})],pb.prototype,"displayCoordinate",null),g([w()],pb.prototype,"format",void 0),g([w()],pb.prototype,"position",void 0),pb=g([te("esri.widgets.CoordinateConversion.support.Conversion")],pb);const db=pb;function oze(e,t){const i=xoe(t);return[e[0].toFixed(i),e[1].toFixed(i)]}function xoe(e){return e>=500?6:e<500&&e>=50?7:e<50&&e>=5?8:9}function aze(e,t){const i=e.includes(",")?",":" ",[r,n,o]=e.split(i).map(h=>{const m=h.trim();return m?Number(m):null});if(!i$(r)||!i$(n))return null;const c=new pt({x:r,y:n,spatialReference:t||Mt.WGS84});return o&&(c.z=o,c.hasZ=!0),c}function i$(e){return typeof e=="number"&&isFinite(e)}function JR(e){return e&&i$(e.x)&&i$(e.y)}function Soe(e,t){if(e.spatialReference.isGeographic&&t){const[i,r]=oze([e.x,e.y],t);return`${i}, ${r}`}return`${e.x.toFixed(3)}, ${e.y.toFixed(3)}`}function lze(e){return e==="dd"||e==="dms"||e==="ddm"||e==="mgrs"||e==="usng"||e==="utm"}const ZR={ar:[".",","],bg:[",","\xA0"],bs:[",","."],ca:[",","."],cs:[",","\xA0"],da:[",","."],de:[",","."],"de-ch":[".","\u2019"],el:[",","."],en:[".",","],"en-au":[".",","],es:[",","."],"es-mx":[".",","],et:[",","\xA0"],fi:[",","\xA0"],fr:[",","\u202F"],"fr-ch":[",","\u202F"],he:[".",","],hi:[".",",","#,##,##0.###"],hr:[",","."],hu:[",","\xA0"],id:[",","."],it:[",","."],"it-ch":[".","\u2019"],ja:[".",","],ko:[".",","],lt:[",","\xA0"],lv:[",","\xA0"],mk:[",","."],nb:[",","\xA0"],nl:[",","."],pl:[",","\xA0"],pt:[",","."],"pt-pt":[",","\xA0"],ro:[",","."],ru:[",","\xA0"],sk:[",","\xA0"],sl:[",","."],sr:[",","."],sv:[",","\xA0"],th:[".",","],tr:[",","."],uk:[",","\xA0"],vi:[",","."],zh:[".",","]};function r$(e){e||(e=io());let t=e in ZR;if(!t){const o=e.split("-");o.length>1&&o[0]in ZR&&(e=o[0],t=!0),t||(e="en")}const[i,r,n="#,##0.###"]=ZR[e];return{decimal:i,group:r,pattern:n}}function cze(e,t){const i=r$((t=K({},t)).locale);t.customs=i;const r=t.pattern||i.pattern;return isNaN(e)||Math.abs(e)===1/0?null:uze(e,r,t)}const Moe=/[#0,]*[#0](?:\.0*#*)?/;function uze(e,t,i){const r=(i=i||{}).customs.group,n=i.customs.decimal,o=t.split(";"),c=o[0];if((t=o[e<0?1:0]||"-"+c).includes("%"))e*=100;else if(t.includes("\u2030"))e*=1e3;else{if(t.includes("\xA4"))throw new Error("currency notation not supported");if(t.includes("E"))throw new Error("exponential notation not supported")}const h=Moe,m=c.match(h);if(!m)throw new Error("unable to find a number expression in pattern: "+t);return i.fractional===!1&&(i.places=0),t.replace(h,hze(e,m[0],{decimal:n,group:r,places:i.places,round:i.round}))}function hze(e,t,i){(i=i||{}).places===!0&&(i.places=0),i.places===1/0&&(i.places=6);const r=t.split("."),n=typeof i.places=="string"&&i.places.indexOf(",");let o=i.places;n?o=i.places.substring(n+1):o>=0||(o=(r[1]||[]).length),i.round<0||(e=Number(e.toFixed(Number(o))));const c=String(Math.abs(e)).split("."),h=c[1]||"";if(r[1]||i.places){n&&(i.places=i.places.substring(0,n));const P=i.places!==void 0?i.places:r[1]&&r[1].lastIndexOf("0")+1;P>h.length&&(c[1]=h.padEnd(Number(P),"0")),o<h.length&&(c[1]=h.substr(0,Number(o)))}else c[1]&&c.pop();const m=r[0].replace(",","");let b=m.indexOf("0");b!==-1&&(b=m.length-b,b>c[0].length&&(c[0]=c[0].padStart(b,"0")),m.includes("#")||(c[0]=c[0].substr(c[0].length-b)));let x,I,E=r[0].lastIndexOf(",");if(E!==-1){x=r[0].length-E-1;const P=r[0].substr(0,E);E=P.lastIndexOf(","),E!==-1&&(I=P.length-E-1)}const k=[];for(let P=c[0];P;){const F=P.length-x;k.push(F>0?P.substr(F):P),P=F>0?P.slice(0,F):"",I&&(x=I,I=void 0)}return c[0]=k.reverse().join(i.group||","),c.join(i.decimal||".")}function pze(e){const t=r$((e=e||{}).locale),i=e.pattern||t.pattern,r=t.group,n=t.decimal;let o=1;if(i.includes("%"))o/=100;else if(i.includes("\u2030"))o/=1e3;else if(i.includes("\xA4"))throw new Error("currency notation not supported");const c=i.split(";");return c.length===1&&c.push("-"+c[0]),{regexp:X3(c,m=>(m="(?:"+tS(m,".")+")").replace(Moe,b=>{const x={signed:!1,separator:e.strict?r:[r,""],fractional:e.fractional,decimal:n,exponent:!1},I=b.split(".");let E=e.places;I.length===1&&o!==1&&(I[1]="###"),I.length===1||E===0?x.fractional=!1:(E===void 0&&(E=e.pattern?I[1].lastIndexOf("0")+1:1/0),E&&e.fractional==null&&(x.fractional=!0),!e.places&&E<I[1].length&&(E+=","+I[1].length),x.places=E);const k=I[0].split(",");return k.length>1&&(x.groupSize=k.pop().length,k.length>1&&(x.groupSize2=k.pop().length)),"("+fze(x)+")"}),!0).replace(/[\xa0 ]/g,"[\\s\\xa0]"),group:r,decimal:n,factor:o}}function dze(e,t){const i=pze(t),r=new RegExp("^"+i.regexp+"$").exec(e);if(!r)return NaN;let n=r[1];if(!r[1]){if(!r[2])return NaN;n=r[2],i.factor*=-1}return n=n.replace(new RegExp("["+i.group+"\\s\\xa0]","g"),"").replace(i.decimal,"."),Number(n)*i.factor}function fze(e){"places"in(e=e||{})||(e.places=1/0),typeof e.decimal!="string"&&(e.decimal="."),"fractional"in e&&!/^0/.test(String(e.places))||(e.fractional=[!0,!1]),"exponent"in e||(e.exponent=[!0,!1]),"eSigned"in e||(e.eSigned=[!0,!1]);const t=Ioe(e),i=X3(e.fractional,n=>{let o="";return n&&e.places!==0&&(o="\\"+e.decimal,e.places===1/0?o="(?:"+o+"\\d+)?":o+="\\d{"+e.places+"}"),o},!0);let r=t+i;return i&&(r="(?:(?:"+r+")|(?:"+i+"))"),r+X3(e.exponent,n=>n?"([eE]"+Ioe({signed:e.eSigned})+")":"")}function Ioe(e){return"signed"in(e=e||{})||(e.signed=[!0,!1]),"separator"in e?"groupSize"in e||(e.groupSize=3):e.separator="",X3(e.signed,t=>t?"[-+]":"",!0)+X3(e.separator,t=>{if(!t)return"(?:\\d+)";(t=tS(t))===" "?t="\\s":t==="\xA0"&&(t="\\s\\xa0");const i=e.groupSize,r=e.groupSize2;if(r){const n="(?:0|[1-9]\\d{0,"+(r-1)+"}(?:["+t+"]\\d{"+r+"})*["+t+"]\\d{"+i+"})";return i-r>0?"(?:"+n+"|(?:0|[1-9]\\d{0,"+(i-1)+"}))":n}return"(?:0|[1-9]\\d{0,"+(i-1)+"}(?:["+t+"]\\d{"+i+"})*)"},!0)}const X3=(e,t,i)=>{if(!(e instanceof Array))return t(e);const r=[];for(let n=0;n<e.length;n++)r.push(t(e[n]));return yze(r.join("|"),Boolean(i))},yze=(e,t)=>"("+(t?"?:":"")+e+")";function mze(e,t){const i=[];e=(e=(e=e.replace(/[\u00B0\u00BA]/g,"^")).replace(/\u2032/g,"'")).replace(/\u2033/g,'"');const r=qf(t);return ey.dmsToGeog(r,1,[e],i)?new pt(i[0][0],i[0][1],t||Mt.WGS84):null}function gze(e,t,i){const r=[],n=$oe(i);if(n===-1)return console.warn(`invalid conversionMode: ${i}`),null;const o=qf(t);return sa.mgrsToGeogExtended(o,1,[e],n,r)?new pt(r[0][0],r[0][1],t||Mt.WGS84):null}function vze(e,t){const i=[];!t&&/\(.+27/.test(e)&&(t=Mt.GCS_NAD_1927);const r=qf(t);return T_.usngToGeog(r,1,[e],i)?new pt(i[0][0],i[0][1],t||Mt.WGS84):null}function bze(e,t,i){const r=[],n=Eoe(i);if(n===-1)return console.warn(`invalid conversionMode: ${i}`),null;const o=qf(t);return Ph.utmToGeog(o,1,[e],n,r)?new pt(r[0][0],r[0][1],t||Mt.WGS84):null}function wze(e,t,i=0){const r=[[e.x,e.y]],n=[],o=qf(e.spatialReference);let c=0;switch(t){case"dd":c=ey.geogToDd(o,1,r,i,n);break;case"ddm":c=ey.geogToDdm(o,1,r,i,n);break;case"dms":c=ey.geogToDms(o,1,r,i,n);break;default:return console.warn(`invalid format: ${t}`),null}return c?n[0]:null}function _ze(e,t,i=0,r=!1){const n=[[e.x,e.y]],o=[],c=qf(e.spatialReference);let h=$oe(t);return h===-1?(console.warn(`invalid conversionMode: ${t}`),null):(r&&(h|=sa.PE_MGRS_ADD_SPACES),sa.geogToMgrsExtended(c,1,n,i,!1,h,o)?o[0]:null)}function xze(e,t=0,i=!1){const r=[[e.x,e.y]],n=[],o=qf(e.spatialReference);return T_.geogToUsng(o,1,r,t,!1,i,n)?n[0]:null}function Sze(e,t,i=!1){const r=[[e.x,e.y]],n=[],o=qf(e.spatialReference);let c=Eoe(t);return c===-1?(console.warn(`invalid conversionMode: ${t}`),null):(i&&(c|=Ph.PE_UTM_OPTS_ADD_SPACES),Ph.geogToUtm(o,1,r,c,n)?n[0]:null)}function qf(e){let t=null;if(e||(e=Mt.WGS84),e.wkid){if(t=E_.geogcs(e.wkid),!t)throw new ue("coordinate-formatter:invalid-spatial-reference","wkid is not valid")}else{if(!e.wkt)throw new ue("coordinate-formatter:invalid-spatial-reference","wkid and wkt are missing");if(t=E_.fromString(Er.PE_TYPE_GEOGCS,e.wkt),!t)throw new ue("coordinate-formatter:invalid-spatial-reference","wkt is not valid")}return t}function $oe(e){let t=-1;switch(e){case"automatic":t=sa.PE_MGRS_STYLE_AUTO;break;case"new-180-in-zone-01":t=sa.PE_MGRS_STYLE_NEW|sa.PE_MGRS_180_ZONE_1_PLUS;break;case"new-180-in-zone-60":t=sa.PE_MGRS_STYLE_NEW;break;case"old-180-in-zone-01":t=sa.PE_MGRS_STYLE_OLD|sa.PE_MGRS_180_ZONE_1_PLUS;break;case"old-180-in-zone-60":t=sa.PE_MGRS_STYLE_OLD}return t}function Eoe(e){let t=-1;switch(e){case"latitude-band-indicators":t=Ph.PE_UTM_OPTS_NONE;break;case"north-south-indicators":t=Ph.PE_UTM_OPTS_NS}return t}let $a=class extends Ye{constructor(e){super(e),this.conversionInfo=null,this.coordinateSegments=null,this.defaultPattern=null,this.name=null,this.viewModel=null}get currentPattern(){return this._get("currentPattern")||this._get("defaultPattern")}set currentPattern(e){this._set("currentPattern",e)}get label(){var e;return(e=this.name)!=null?e:""}set label(e){this._overrideIfSome("label",e)}get hasDisplayProperties(){return!(!this.defaultPattern||!this.coordinateSegments)}get spatialReference(){var e,t;return this.name==="basemap"?this._viewSpatialReference:(t=(e=this.conversionInfo)==null?void 0:e.spatialReference)!=null?t:Mt.WGS84}set spatialReference(e){this._overrideIfSome("spatialReference",e)}get _viewSpatialReference(){return this.get("viewModel.view.spatialReference")||Mt.WGS84}get _additionalCharactersPattern(){const e=this.get("coordinateSegments");if(!e)return null;const t=e.map(r=>r.alias),i=this.currentPattern.replace(new RegExp(`["nsew${t.join()}]`,"gi"),"").replace(/\ /g,"");return new RegExp(`[${i}]`,"g")}get test(){return{additionalCharactersPattern:this._additionalCharactersPattern}}convert(e){if(!JR(e))return Promise.reject(new ue("format:invalid-point","Could not convert invalid point.",{point:e}));const t=this.get("conversionInfo.convert");return t?Promise.resolve().then(()=>t(e)):this._project(e,this.spatialReference).then(i=>this._getCoordinate(i).then(r=>({location:i,coordinate:r})))}getConversionStrategy(){const e=this._viewSpatialReference;return this.get("conversionInfo.convert")||this.get("viewModel.formatterAvailable")||this.name==="xy"&&(e.isWebMercator||e.isWGS84)||this.name==="basemap"?"client":"server"}getDisplayCoordinate(e){if(!e)return null;if(!this.coordinateSegments||!this.currentPattern)return e;let t=this.currentPattern;const i=this._getSegmentMatches(e,!1);for(let r=this.coordinateSegments.length-1;r>=0;r--){const n=this.coordinateSegments[r];t=t.replace(n.alias,i[r])}return t}parseUserInput(e){let t=this.defaultPattern.replace(this._additionalCharactersPattern,"");e=e.replace(this._additionalCharactersPattern,"");const i=this._getSegmentMatches(e,!0);for(let r=this.coordinateSegments.length-1;r>=0;r--){const n=this.coordinateSegments[r];t=t.replace(n.alias,i[r])}return t}_getSegmentMatches(e,t){const i=[];for(let r=0;r<this.coordinateSegments.length;r++){const n=this.coordinateSegments[r],o=e.match(n.searchPattern);if(!o){i.push("");continue}let c=o[0];if(e=e.replace(c,"").trim(),n.substitution){const h=t?n.substitution.input(c):n.substitution.output(c);h&&(c=`${h}`)}i.push(c)}return i}reverseConvert(e){const t=this.parseUserInput(e),i=this.get("conversionInfo.reverseConvert");let r;if(i)r=i(t);else if(this.name==="xy"||this.name==="basemap")r=aze(t,this.spatialReference);else if(this.viewModel.formatterAvailable)switch(this.name){case"dd":case"ddm":case"dms":r=mze(t,this.spatialReference);break;case"mgrs":{const n="automatic";r=gze(t,this.spatialReference,n);break}case"utm":{const n="latitude-band-indicators";r=bze(t,this.spatialReference,n);break}case"usng":r=vze(t,this.spatialReference);break;default:r=null}return r?this._project(r,this._viewSpatialReference):Promise.reject(new ue("format:invalid-input","Could not parse input into point.",{userInput:e}))}_getCoordinate(e){const t=this.get("viewModel.view.scale");if(!JR(e))return Promise.reject(new ue("format:invalid-point","Could not transform invalid point into coordinate.",{point:e}));if(this.get("viewModel.formatterAvailable")||this.name==="basemap"||this.name==="xy")switch(this.name){case"dd":case"ddm":case"dms":{const i=xoe(t);return Promise.resolve(wze(e,this.name,i))}case"mgrs":{const i=!1,r=5,n="automatic";return Promise.resolve(_ze(e,n,r,i))}case"usng":{const i=!1,r=5;return Promise.resolve(xze(e,r,i))}case"utm":{const i=!0,r="latitude-band-indicators";return Promise.resolve(Sze(e,r,i))}default:return Promise.resolve(Soe(e,t))}return Promise.resolve(Soe(e,t))}_project(e,t){var i,r;if(hr(e.spatialReference,t)||!t)return Promise.resolve(e);if(((i=this.viewModel)==null?void 0:i.formatterAvailable)&&vu())return Promise.resolve(Da(e,t));if(!((r=this.viewModel)==null?void 0:r.formatterAvailable)){const n=gw(e,t);if(H(n))return Promise.resolve(n)}return null}};g([w()],$a.prototype,"conversionInfo",void 0),g([w()],$a.prototype,"coordinateSegments",void 0),g([w()],$a.prototype,"currentPattern",null),g([w()],$a.prototype,"label",null),g([w()],$a.prototype,"defaultPattern",void 0),g([w({readOnly:!0})],$a.prototype,"hasDisplayProperties",null),g([w()],$a.prototype,"name",void 0),g([w({type:Mt})],$a.prototype,"spatialReference",null),g([w()],$a.prototype,"viewModel",void 0),g([w({readOnly:!0})],$a.prototype,"_viewSpatialReference",null),g([w({readOnly:!0})],$a.prototype,"_additionalCharactersPattern",null),$a=g([te("esri.widgets.CoordinateConversion.support.Format")],$a);const Hf=$a,Mm=r$().decimal,fb={N:"north",S:"south",E:"east",W:"west"},en="\xB0\u200E",n$=new RegExp(`-?\\d+[\\.|\\${Mm}]?\\d*`),Mze=/^[\\0]+(?=\d)/;function Toe(e,t){const i=io()==="ar",r=e.abbreviatedDirections.north,n=e.abbreviatedDirections.south,o=e.abbreviatedDirections.east,c=e.abbreviatedDirections.west,h=r$().decimal,m={};m[r]="N",m[n]="S",m[o]="E",m[c]="W";const b=new RegExp(`-?\\d+[\\.|\\${h}]?\\d*`),x=new RegExp(`N|S|${r}|${n}`,"i"),I=new RegExp(`E|W|${o}|${c}`,"i"),E={ddm:`Y${en} A'${e.abbreviatedDirections.north}, X${en} B'${e.abbreviatedDirections.east}`,dms:`Y${en} A' B"${e.abbreviatedDirections.north}, X${en} C' D"${e.abbreviatedDirections.east}`,dd:`Y${en}${e.abbreviatedDirections.north}, X${en}${e.abbreviatedDirections.east}`,xy:`X${en}, Y${en}`,basemap:"X, Y"},k={ddm:`${e.abbreviatedDirections.north}${en}Y 'A ,${e.abbreviatedDirections.east}${en}X 'B`,dms:`${e.abbreviatedDirections.north}${en}Y 'A "B ,${e.abbreviatedDirections.east}${en}X 'C "D`,dd:`${e.abbreviatedDirections.north}${en}Y ,${e.abbreviatedDirections.east}${en}X`,xy:`X${en} ,Y${en}`,basemap:"X ,Y"},P=new RegExp(`\\d{1,2}[\\.|\\${h}]?\\d*`,"i"),F=new RegExp(`\\d{1,3}[\\.|\\${h}]?\\d*`,"i");t.forEach(N=>{const{name:B}=N;if(B==="dd"?N.coordinateSegments=[{alias:"Y",description:"degrees latitude",searchPattern:P,substitution:{input:z=>nr(z),output:z=>rr(z)}},{alias:e.abbreviatedDirections.north,description:"north/south indicator",searchPattern:x,substitution:{input:z=>m[z],output:z=>e.abbreviatedDirections[fb[z]]}},{alias:"X",description:"degrees longitude",searchPattern:F,substitution:{input:z=>nr(z),output:z=>rr(z)}},{alias:e.abbreviatedDirections.east,description:"east/west indicator",searchPattern:I,substitution:{input:z=>m[z],output:z=>e.abbreviatedDirections[fb[z]]}}]:B==="ddm"?N.coordinateSegments=[{alias:"Y",description:"degrees latitude",searchPattern:P,substitution:{input:z=>nr(z),output:z=>rr(z)}},{alias:"A",description:"minutes latitude",searchPattern:P,substitution:{input:z=>nr(z),output:z=>rr(z)}},{alias:e.abbreviatedDirections.north,description:"north/south indicator",searchPattern:x,substitution:{input:z=>m[z],output:z=>e.abbreviatedDirections[fb[z]]}},{alias:"X",description:"degrees longitude",searchPattern:F,substitution:{input:z=>nr(z),output:z=>rr(z)}},{alias:"B",description:"minutes longitude",searchPattern:P,substitution:{input:z=>nr(z),output:z=>rr(z)}},{alias:e.abbreviatedDirections.east,description:"east/west indicator",searchPattern:I,substitution:{input:z=>m[z],output:z=>e.abbreviatedDirections[fb[z]]}}]:B==="dms"?N.coordinateSegments=[{alias:"Y",description:"degrees latitude",searchPattern:P,substitution:{input:z=>nr(z),output:z=>rr(z)}},{alias:"A",description:"minutes latitude",searchPattern:P,substitution:{input:z=>nr(z),output:z=>rr(z)}},{alias:"B",description:"seconds latitude",searchPattern:P,substitution:{input:z=>nr(z),output:z=>rr(z)}},{alias:e.abbreviatedDirections.north,description:"north/south indicator",searchPattern:x,substitution:{input:z=>m[z],output:z=>e.abbreviatedDirections[fb[z]]}},{alias:"X",description:"degrees longitude",searchPattern:F,substitution:{input:z=>nr(z),output:z=>rr(z)}},{alias:"C",description:"minutes longitude",searchPattern:P,substitution:{input:z=>nr(z),output:z=>rr(z)}},{alias:"D",description:"seconds longitude",searchPattern:P,substitution:{input:z=>nr(z),output:z=>rr(z)}},{alias:e.abbreviatedDirections.east,description:"east/west indicator",searchPattern:I,substitution:{input:z=>m[z],output:z=>e.abbreviatedDirections[fb[z]]}}]:(N.name==="xy"||N.name==="basemap")&&(N.coordinateSegments=[{alias:"X",description:"easting",searchPattern:b,substitution:{input:z=>nr(z),output:z=>rr(z)}},{alias:"Y",description:"northing",searchPattern:b,substitution:{input:z=>nr(z),output:z=>rr(z)}}]),E[B]){const z=i?k[B]:E[B];N.defaultPattern=z,N.currentPattern=z}})}function Ize(){const e=new RegExp("N|S","i"),t=new RegExp("E|W","i");return[new Hf({name:"basemap",coordinateSegments:[{alias:"X",description:"easting",searchPattern:n$,substitution:{input:i=>nr(i),output:i=>rr(i)}},{alias:"Y",description:"northing",searchPattern:n$,substitution:{input:i=>nr(i),output:i=>rr(i)}}],defaultPattern:"X, Y",viewModel:null}),new Hf({name:"dd",coordinateSegments:[{alias:"Y",description:"degrees latitude",searchPattern:new RegExp(`\\d{1,2}[\\.|\\${Mm}]?\\d*(?=\\D*?[N|S])`,"i"),substitution:{input:i=>nr(i),output:i=>rr(i)}},{alias:"N",description:"north/south indicator",searchPattern:e},{alias:"X",description:"degrees longitude",searchPattern:new RegExp(`\\d{1,3}[\\.|\\${Mm}]?\\d*(?=\\D*?[E|W|])`,"i"),substitution:{input:i=>nr(i),output:i=>rr(i)}},{alias:"E",description:"east/west indicator",searchPattern:t}],defaultPattern:`Y${en}N, X${en}E`,viewModel:null}),new Hf({name:"ddm",coordinateSegments:[{alias:"Y",description:"degrees latitude",searchPattern:new RegExp("\\d{1,2}(?=.*?\\s+.*?[N|S])","i"),substitution:{input:i=>nr(i),output:i=>rr(i)}},{alias:"A",description:"minutes latitude",searchPattern:new RegExp(`\\d{1,2}[\\.\\${Mm}]?\\d*(?=.*?[N|S])`,"i"),substitution:{input:i=>nr(i),output:i=>rr(i)}},{alias:"N",description:"north/south indicator",searchPattern:e},{alias:"X",description:"degrees longitude",searchPattern:new RegExp("\\d{1,3}(?=\\D*?\\s+.*?[E|W])","i"),substitution:{input:i=>nr(i),output:i=>rr(i)}},{alias:"B",description:"minutes longitude",searchPattern:new RegExp(`\\d{1,2}[\\.|\\|${Mm}]?\\d*(?=.*?[E|W])`,"i"),substitution:{input:i=>nr(i),output:i=>rr(i)}},{alias:"E",description:"east/west indicator",searchPattern:t}],defaultPattern:`Y${en} A'N, X${en} B'E`,viewModel:null}),new Hf({name:"dms",coordinateSegments:[{alias:"Y",description:"degrees latitude",searchPattern:new RegExp("\\d{1,2}(?=.*?\\s+.*?[N|S])","i"),substitution:{input:i=>nr(i),output:i=>rr(i)}},{alias:"A",description:"minutes latitude",searchPattern:new RegExp("\\d{1,2}(?=.*?[N|S])","i"),substitution:{input:i=>nr(i),output:i=>rr(i)}},{alias:"B",description:"seconds latitude",searchPattern:new RegExp(`\\d{1,2}[\\.|\\${Mm}]?\\d*(?=.*?[N|S])`,"i"),substitution:{input:i=>nr(i),output:i=>rr(i)}},{alias:"N",description:"north/south indicator",searchPattern:e},{alias:"X",description:"degrees longitude",searchPattern:new RegExp("\\d{1,3}(?=.*?\\s+.*?[E|W])","i"),substitution:{input:i=>nr(i),output:i=>rr(i)}},{alias:"C",description:"minutes longitude",searchPattern:new RegExp("\\d{1,2}(?=.*?[E|W])","i"),substitution:{input:i=>nr(i),output:i=>rr(i)}},{alias:"D",description:"seconds longitude",searchPattern:new RegExp(`\\d{1,2}[\\.|\\${Mm}]?\\d*(?=.*?[E|W])`,"i"),substitution:{input:i=>nr(i),output:i=>rr(i)}},{alias:"E",description:"east/west indicator",searchPattern:t}],defaultPattern:`Y${en} A' B"N, X${en} C' D"E`,viewModel:null}),new Hf({name:"xy",coordinateSegments:[{alias:"X",description:"longitude",searchPattern:n$,substitution:{input:i=>nr(i),output:i=>rr(i)}},{alias:"Y",description:"latitude",searchPattern:n$,substitution:{input:i=>nr(i),output:i=>rr(i)}}],defaultPattern:`X${en}, Y${en}`,viewModel:null}),new Hf({name:"mgrs",coordinateSegments:[{alias:"Z",description:"grid zone",searchPattern:/\d{1,2}\w|[abyz]/i},{alias:"S",description:"grid square",searchPattern:/\w{2}/},{alias:"X",description:"easting",searchPattern:/^\d{5}(?=.?\d{5}$)|^\d{4}(?=.?\d{4}$)|^\d{3}(?=.?\d{3}$)|^\d{2}(?=.?\d{2}$)|^\d(?=.?\d$)/},{alias:"Y",description:"northing",searchPattern:/^\d{1,5}/}],defaultPattern:"Z S X Y",viewModel:null}),new Hf({name:"usng",coordinateSegments:[{alias:"Z",description:"grid zone",searchPattern:/\d{1,2}\w|[abyz]/i},{alias:"S",description:"grid square",searchPattern:/\w{2}/},{alias:"X",description:"easting",searchPattern:/^\d{5}(?=.?\d{5}$)|^\d{4}(?=.?\d{4}$)|^\d{3}(?=.?\d{3}$)|^\d{2}(?=.?\d{2}$)|^\d(?=.?\d$)/},{alias:"Y",description:"northing",searchPattern:/^\d{1,5}/}],defaultPattern:"Z S X Y",viewModel:null}),new Hf({name:"utm",coordinateSegments:[{alias:"Z",description:"zone number",searchPattern:/\d{1,2}|[abyz]/i},{alias:"B",description:"latitude band",searchPattern:/^\D/},{alias:"X",description:"easting",searchPattern:/\d{1,7}(?=\s*\d{7}$)/},{alias:"Y",description:"northing",searchPattern:/\d{1,7}/}],defaultPattern:"ZB X Y",viewModel:null})]}function rr(e){const t=e.match(Mze),i=t?t[0]:"",r=e.includes(".")?e.split(".")[1].length:0;return i+cze(Number(e),{pattern:"###0.###",places:r,round:-1})}function nr(e){return dze(e)}const s$={default:"default",crosshair:"crosshair"},$ze=new pt([0,0,500]),Eze="xy",Tze=["mgrs","utm","usng","dd","dms","ddm"],Coe="esri__coordinateConversionWidgetState",Yu={conversions:"conversions",formats:"formats",view:"view",viewChange:"view-change"},Cze="esri/images/search/search-symbol-32.png";let Ks=class extends Z1(Or.EventedAccessor){constructor(e){super(e),this._conversionPromise=null,this._handles=new Ti,this._locationGraphic=null,this._pointerCount=0,this.conversions=new Xe,this.formats=new Xe,this.formatterAvailable=!1,this.messages=null,this.filteredFormats=new Xe,this.locationSymbol=new Og({url:_i(Cze),width:24,height:24}),this.storageEnabled=!0,this.storageType="session",this.view=null,this._saveWidgetState=this._saveWidgetState.bind(this),this._handleFormatChange=this._handleFormatChange.bind(this),this._handleConversionChange=this._handleConversionChange.bind(this),this._handleViewChange=this._handleViewChange.bind(this),this._onClick=this._onClick.bind(this),this._onPointerMove=this._onPointerMove.bind(this),this._onPointerDown=this._onPointerDown.bind(this),this._onPointerUp=this._onPointerUp.bind(this)}initialize(){const e=async()=>this.messages=await z5("esri/widgets/CoordinateConversion/t9n/CoordinateConversion");this.formats.addMany(Ize()),e().then(()=>{if(!this.destroyed&&(Toe(this.messages,this.formats),this.storageEnabled&&this._loadWidgetState(),this.formats.forEach(t=>{t.viewModel=this,this._handles.add(we(()=>t.currentPattern,this._saveWidgetState),t.name)}),this._handles.add(this.conversions.on("change",this._handleConversionChange),Yu.conversions),this._handles.add(this.formats.on("change",this._handleFormatChange),Yu.formats),this._handles.add(US(()=>{e().then(()=>{Toe(this.messages,this.formats)})})),bu().then(()=>{this.formatterAvailable=!0}).catch(t=>{$e.getLogger(this.declaredClass).error(new ue("coordinate-conversion:projection-load-failed","Failed to load the projection module.",{error:t})),this.formatterAvailable=!1,this._filterFormatsAndConversions()}).then(()=>this._handles.add(we(()=>this.view,this._handleViewChange,St),Yu.viewChange)),this.conversions.length===0)){const t=this.formats.find(i=>i.name===Eze)||this.formats.getItemAt(0);this.conversions.add(new db({format:t}))}})}destroy(){this._handles.removeAll(),this._cleanUpView(this.view),this.view=null}castConversions(e){return this._castToConversions(e)}set currentLocation(e){this._set("currentLocation",e),this._updateConversions()}get currentLocation(){return this._get("currentLocation")||null}set mode(e){switch(e){case"capture":this.currentLocation=null,this._startCaptureMode(),this._set("mode",e);break;case"live":this._startLiveMode(),this._set("mode",e)}}get mode(){return this._get("mode")||"live"}get state(){const{messages:e,view:t}=this,i=t==null?void 0:t.ready;return e?i?"ready":t?"loading":"disabled":"disabled"}get storage(){const{storageType:e}=this;return e==="session"?sessionStorage:localStorage}get waitingForConversions(){return this._conversionPromise!=null}setLocation(e){if(this.view.graphics.remove(this._locationGraphic),e){const t=e.clone();t.hasZ&&(t.z=void 0),this._locationGraphic=new Gr({geometry:t,symbol:this.get("locationSymbol")}),this.view.graphics.add(this._locationGraphic)}}convert(e,t){return JR(t)?Promise.resolve().then(()=>e.convert(t)):Promise.reject(new ue("coordinate-conversion:invalid-point","Invalid point cannot be converted.",{point:t}))}goToLocation(e){var n,o,c;const t=this.view,i=t.type==="3d"?t.clippingArea:null,r=(o=(n=t.map)==null?void 0:n.basemap)==null?void 0:o.baseLayers;if(i||(r==null?void 0:r.length)>0){const h=i!=null?i:(c=r.getItemAt(0))==null?void 0:c.fullExtent;if(H(h)&&!h.contains(e))return Promise.reject(new ue("coordinate-conversion:go-to-failed","Point outside basemap extent.",{point:e}))}return this.callGoTo({target:e})}pause(){this.currentLocation=null,this._handles.remove(Yu.view),this.view&&(this.view.cursor=s$.default,this.view.graphics.remove(this._locationGraphic))}previewConversion(e,t=this.currentLocation||$ze){return this._convertMany([e],t).then(()=>e.displayCoordinate)}resume(){this.mode==="capture"?this._startCaptureMode():this._startLiveMode()}reverseConvert(e,t){return t.reverseConvert(e)}async updateConversions(e,t){if(!t||!t.type||t.type!=="point")throw this._clearConversions(this.conversions),new ue("coordinate-conversion:invalid-input-point","Point is invalid, conversions cannot be updated.",{point:t});return this._convertMany(e,t)}_castToConversions(e){const t=new Xe;return e.forEach(i=>{let r;if(i instanceof db)r=i;else if(typeof i=="string"){const n=this.formats.find(o=>o.name===i);n&&(r=new db({format:n}))}r&&t.add(r)}),t}_cleanUpView(e){e&&(e.graphics.remove(this._locationGraphic),this._handles.remove(Yu.view),e.cursor=s$.default)}_clearConversions(e){e.forEach(t=>{t.position={location:null,coordinate:null}})}_convertMany(e,t){return Promise.all(e.map(i=>i.format.convert(t).then(r=>(i.position=r,i)).catch(()=>{i.position=null}))).then(()=>e)}_handleConversionChange(e){e.added.forEach(t=>{const i=t.format;i.viewModel=this,this.currentLocation&&(this._set("waitingForConversions",!0),this.convert(i,this.currentLocation).then(r=>{t.position=r,this._set("waitingForConversions",!1)}))}),this._saveWidgetState()}_handleFormatChange(e){e.added.forEach(t=>{this._handles.add(we(()=>t.currentPattern,this._saveWidgetState),t.name),t.viewModel=this}),e.removed.forEach(t=>{t.viewModel=null;const i=this.conversions.filter(r=>r.format===t);this.conversions.removeMany(i),this._handles.remove(t.name)})}_loadWidgetState(){try{const e=JSON.parse(this.storage.getItem(Coe));e&&this._setWidgetState(e)}catch(e){$e.getLogger(this.declaredClass).error(new ue("coordinate-conversion:invalid-session-storage-json","Could not read from storage.",{error:e}))}}_startCaptureMode(){this._handles.remove(Yu.view),this.view&&(this.view.cursor=s$.crosshair,this.currentLocation&&this.setLocation(this.currentLocation),this._handles.add(this.view.on("click",this._onClick),Yu.view))}_startLiveMode(){this._pointerCount=0,this._handles.remove(Yu.view),this.view&&(this.view.cursor=s$.default,this.view.graphics.remove(this._locationGraphic),this._handles.add([this.view.on("pointer-down",this._onPointerDown),this.view.on("pointer-up",this._onPointerUp),this.view.on("pointer-move",this._onPointerMove)],Yu.view))}_handleViewChange(e,t){t&&t!==e&&this._cleanUpView(t),e&&(this.mode==="capture"?this._startCaptureMode():this._startLiveMode(),t&&this._filterFormatsAndConversions())}_onClick(e){if(e.button===0){const t=this.view.toMap(e),i=t&&t.normalize();this.setLocation(i),this.currentLocation=i}}_onPointerDown(e){const{pointerType:t}=e;if(this._pointerCount++,(t==="touch"||t==="pen")&&this._pointerCount===1){const i=this.view.toMap(e);this.currentLocation=i&&i.normalize()}}_onPointerMove(e){const{pointerType:t}=e;if(t==="mouse"||this._pointerCount===1){const i=this.view.toMap(e);this.currentLocation=i&&i.normalize()}}_onPointerUp(){this._pointerCount--}_setWidgetState(e){try{e.formats.forEach(t=>{const i=this.formats.find(r=>r.name===t.name);i&&e.locale===io()&&t.currentPattern&&(i.currentPattern=t.currentPattern),i&&t.index>=0&&this.conversions.add(new db({format:i}))})}catch(t){$e.getLogger(this.declaredClass).warn(new ue("coordinate-conversion:session-storage-read-error","Could not get widget state from stored JSON.",{error:t}))}}_saveWidgetState(){if(!this.storageEnabled)return;const e=this._toJSON();try{this.storage.setItem(Coe,JSON.stringify({formats:e,locale:io()}))}catch(t){$e.getLogger(this.declaredClass).error(new ue("coordinate-conversion:local-storage-write-error","Could not write to localStorage.",{error:t}))}}async _updateConversions(){try{await this.updateConversions(this.conversions.toArray(),this.currentLocation)}catch{}}_toJSON(){return this.formats.filter(e=>{const t=e.name;return t==="xy"||t==="basemap"||lze(t)}).map(e=>({name:e.name,currentPattern:e.currentPattern,defaultPattern:e.defaultPattern,index:this.conversions.findIndex(t=>t.format===e)})).sort((e,t)=>e.index-t.index).toArray()}_filterFormatsAndConversions(){const{formatterAvailable:e,conversions:t,formats:i}=this;e||this._handles.add(os(()=>this.view.spatialReference,r=>{const n=r.isWebMercator||r.isWGS84,o=i.filter(m=>{const{name:b}=m;return!!Tze.includes(b)||b==="xy"&&!n}),c=this.filteredFormats.filter(m=>m.name==="xy"&&n&&!this.formats.includes(m)),h=t.filter(m=>o.includes(m.format));i.removeMany(o),t.removeMany(h),this.filteredFormats.addMany(o.filter(m=>!this.filteredFormats.includes(m))),i.addMany(c)},{once:!0,initial:!0}),Yu.view)}};g([w()],Ks.prototype,"conversions",void 0),g([Dt("conversions")],Ks.prototype,"castConversions",null),g([w({type:pt})],Ks.prototype,"currentLocation",null),g([w()],Ks.prototype,"formats",void 0),g([w()],Ks.prototype,"messages",void 0),g([w()],Ks.prototype,"mode",null),g([w()],Ks.prototype,"filteredFormats",void 0),g([w({readOnly:!0})],Ks.prototype,"state",null),g([w()],Ks.prototype,"locationSymbol",void 0),g([w({readOnly:!0,dependsOn:["storageType"]})],Ks.prototype,"storage",null),g([w()],Ks.prototype,"storageEnabled",void 0),g([w()],Ks.prototype,"storageType",void 0),g([w({readOnly:!0})],Ks.prototype,"waitingForConversions",null),g([w()],Ks.prototype,"view",void 0),Ks=g([te("esri.widgets.CoordinateConversion.CoordinateConversionViewModel")],Ks);const koe=Ks,mt={base:"esri-coordinate-conversion esri-widget",captureMode:"esri-coordinate-conversion--capture-mode",noBasemap:"esri-coordinate-conversion--no-basemap",popup:"esri-coordinate-conversion__popup",clipboardPopup:"esri-coordinate-conversion__clipboard-popup",conversionList:"esri-coordinate-conversion__conversion-list",conversionRow:"esri-coordinate-conversion__row",coordDisplay:"esri-coordinate-conversion__display",expanded:"esri-coordinate-conversion__conversions-view--expanded",expandDown:"esri-coordinate-conversion__conversions-view--expand-down",expandUp:"esri-coordinate-conversion__conversions-view--expand-up",conversionsView:"esri-coordinate-conversion__conversions-view",primarySelect:"esri-coordinate-conversion__select-primary",rowSelect:"esri-coordinate-conversion__select-row",toolDisplay:"esri-coordinate-conversion__tools",modeToggle:"esri-coordinate-conversion__mode-toggle",rowButton:"esri-coordinate-conversion__row-button",backButton:"esri-coordinate-conversion__back-button",convertButton:"esri-coordinate-conversion__button",convertButtonSpan:"esri-coordinate-conversion__convert-button-span",coordinateInput:"esri-coordinate-conversion__input-coordinate",inputForm:"esri-coordinate-conversion__input-form",inputFormGroup:"esri-coordinate-conversion__input-group",rejectInput:"esri-coordinate-conversion__input-coordinate--rejected",sectionHeading:"esri-coordinate-conversion__heading",patternInput:"esri-coordinate-conversion__pattern-input",settings:"esri-coordinate__settings",settingsFormGroup:"esri-coordinate-conversion__settings-group",settingsFormGroupHorizontal:"esri-coordinate-conversion__settings-group-horizontal",previewCoordinate:"esri-coordinate-conversion__preview-coordinate",disabled:"esri-disabled",input:"esri-input",button:"esri-button",header:"esri-widget__heading",widgetButton:"esri-widget--button",leftArrow:"esri-icon-left-arrow",rightArrow:"esri-icon-right-arrow",captureButton:"esri-icon-map-pin",collapseButton:"esri-icon-up",copyButton:"esri-icon-duplicate",editButton:"esri-icon-edit",esriSelect:"esri-select",expandButton:"esri-icon-down",goToButton:"esri-icon-locate",refresh:"esri-icon-refresh",removeConversion:"esri-icon-close",settingsButton:"esri-icon-settings2"},Aoe={settingsButton:!0,inputButton:!0,captureButton:!0,expandButton:!0},kze=750,Aze=2500;let xr=class extends ki{constructor(e,t){super(e,t),this._popupMessage=null,this._popupTimeoutId=null,this._clipboardPopupTimeoutId=null,this._coordinateInput=null,this._badInput=!1,this._goToEnabled=!1,this._conversionFormat=null,this._settingsFormat=null,this._previewConversion=null,this._expanded=!1,this._clipboardPopupVisible=!1,this._popupVisible=!1,this._settingsVisible=!1,this._inputVisible=!1,this.headingLevel=4,this.messages=null,this.messagesCommon=null,this.orientation="auto",this.viewModel=new koe,this.visibleElements=K({},Aoe)}get conversions(){return this.viewModel.conversions}set conversions(e){this.viewModel.conversions=e}get currentLocation(){return this.viewModel.currentLocation}set currentLocation(e){this.viewModel.currentLocation=e}get formats(){return this.viewModel.formats}set formats(e){this.viewModel.formats=e}get goToOverride(){return this.viewModel.goToOverride}set goToOverride(e){this.viewModel.goToOverride=e}get label(){var e,t;return(t=(e=this.messages)==null?void 0:e.widgetLabel)!=null?t:""}set label(e){this._overrideIfSome("label",e)}get mode(){return this.viewModel.mode}set mode(e){this.viewModel.mode=e}set multipleConversions(e){e===!1&&(this._expanded=!1,this.conversions.splice(1,this.conversions.length-1)),this._set("multipleConversions",e)}get multipleConversions(){const e=this._get("multipleConversions");return typeof e!="boolean"||e}get locationSymbol(){return this.viewModel.locationSymbol}set locationSymbol(e){this.viewModel.locationSymbol=e}get storageEnabled(){return this.viewModel.storageEnabled}set storageEnabled(e){this.viewModel.storageEnabled=e}get storageType(){return this.viewModel.storageType}set storageType(e){this.viewModel.storageType=e}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}castVisibleElements(e){return K(K({},Aoe),e)}reverseConvert(e,t){return this.viewModel.reverseConvert(e,t)}render(){const e=this.get("viewModel.state"),t=e==="disabled"?j("div",{key:"esri-coordinate__no-basemap"},this.messages.noBasemap):null,i=!t&&this._inputVisible?this._renderInputForm():null,r=!t&&this._settingsVisible?this._renderSettings():null,n=t||i||r?null:this._renderConversionsView(),o=this._popupVisible?this._renderPopup():null,c={[mt.captureMode]:this.mode==="capture",[mt.disabled]:e==="loading",[mt.noBasemap]:e==="disabled"};return j("div",{class:this.classes(mt.base,c)},o,t,n,r,i)}_addConversion(e){const t=e.target,i=t.options[t.options.selectedIndex]["data-format"],r=t["data-index"],n=new db({format:i});t.options.selectedIndex=0,r>=0&&this.conversions.removeAt(r),this.conversions.add(n,r)}_findSettingsFormat(){return this._settingsFormat||this.conversions.reduceRight((e,t)=>{const i=t.format;return i.get("hasDisplayProperties")?i:e},null)||this.formats.find(e=>e.hasDisplayProperties)}_hidePopup(){this._popupTimeoutId&&(clearTimeout(this._popupTimeoutId),this._popupTimeoutId=null),this._popupVisible=!1,this._popupMessage=null,this.scheduleRender()}_hideClipboardPopup(){this._clipboardPopupTimeoutId&&(clearTimeout(this._clipboardPopupTimeoutId),this._clipboardPopupTimeoutId=null),this._clipboardPopupVisible=!1,this.scheduleRender()}_onConvertComplete(){this._inputVisible=!1,this._coordinateInput.value=""}_onCopy(e){const t=e.currentTarget["data-conversion"].displayCoordinate;e.clipboardData.setData("text/plain",t),this._showClipboardPopup(),e.preventDefault()}_processUserInput(e){const t=to(e),i=this.viewModel;if(t!=="Enter"&&t)this._badInput&&(this._badInput=!1);else{const r=this._coordinateInput["data-format"],n=this._coordinateInput.value;this._reverseConvert(n,r).then(o=>{this.mode==="capture"?i.resume():this.mode="capture",this.currentLocation=o,i.setLocation(o),this._onConvertComplete()}).catch(o=>{$e.getLogger(this.declaredClass).error(o),this._showPopup(this.messages.invalidCoordinate),this._badInput=!0})}}_reverseConvert(e,t){const i=this.viewModel;return t.reverseConvert(e).then(r=>(this._goToEnabled&&i.goToLocation(r).catch(n=>{$e.getLogger(this.declaredClass).warn(n),this._showPopup(this.messages.locationOffBasemap)}),r))}_setInputFormat(e){const t=e.target,i=t[t.options.selectedIndex]["data-format"];this._conversionFormat=i}_setPreviewConversion(){const e=this._findSettingsFormat(),t=this.viewModel;if(e){const i=this.conversions.find(r=>r.format===e);this._previewConversion=new db({format:e,position:{location:this.currentLocation,coordinate:i&&i.position.coordinate}}),this._previewConversion.position.coordinate||t.previewConversion(this._previewConversion)}}_setSettingsFormat(e){const t=e.target,i=t[t.options.selectedIndex]["data-format"];this._settingsFormat=i,this._setPreviewConversion()}_showClipboardPopup(){this._clipboardPopupVisible?clearTimeout(this._clipboardPopupTimeoutId):this._clipboardPopupVisible=!0,this.scheduleRender(),this._popupTimeoutId=setTimeout(()=>{this._popupTimeoutId=null,this._hideClipboardPopup()},kze)}_showPopup(e,t=Aze){this._popupMessage=e,this._popupVisible?clearTimeout(this._popupTimeoutId):this._popupVisible=!0,this.scheduleRender(),this._popupTimeoutId=setTimeout(()=>{this._popupTimeoutId=null,this._hidePopup()},t)}_toggleGoTo(){this._goToEnabled=!this._goToEnabled}_updateCurrentPattern(e){e.stopPropagation();const t=e.target,i=this._findSettingsFormat();i&&(i.currentPattern=t.value)}_renderConversion(e,t){const{messages:i}=this,r=`${this.id}__list-item-${t}`,n=`${e.format.label} ${i.conversionOutputSuffix}`,o=t===0,c=o||this._expanded,h=o?this._renderFirstConversion(e):this._renderTools(t,e,r),m=o&&!e.displayCoordinate?i.noLocation:e.displayCoordinate,b=j("div",{"aria-label":m,class:mt.coordDisplay,"data-conversion":e,role:"listitem",tabindex:"0",title:m},m),x=this._renderOptions(this.formats.filter(I=>I!==e.format));return c?j("li",{"aria-label":n,class:mt.conversionRow,id:r,key:e,role:"group",title:n,tabindex:"0"},j("select",{"aria-controls":r,"aria-label":i.selectFormat,class:this.classes(mt.esriSelect,mt.rowSelect),bind:this,"data-index":t,onchange:this._addConversion,title:i.selectFormat},j("option",{"aria-label":e.format.label,selected:!0,title:e.format.label},e.format.label.toUpperCase()),x),b,h):null}_renderCopyButton(e){const t=this._clipboardPopupVisible&&this._renderClipboardPopup();return j("li",{"aria-label":this.messagesCommon.copy,bind:this,class:this.classes(mt.widgetButton,mt.rowButton),"data-conversion":e,onclick:this._copyCoordinateOutput,onkeydown:this._copyCoordinateOutput,oncopy:this._onCopy,role:"button",tabindex:"0",title:this.messagesCommon.copy},t,j("span",{"aria-hidden":"true",class:mt.copyButton}))}_renderFirstConversion(e){const t=this.id,i={[mt.expandButton]:!this._expanded,[mt.collapseButton]:this._expanded},{messages:r,messagesCommon:n,multipleConversions:o,visibleElements:c}=this,h=this.mode==="live"?r.captureMode:r.liveMode,m=this._expanded?n.collapse:n.expand,b=e.displayCoordinate&&this.mode==="capture"?this._renderCopyButton(e):null,x=o&&c.expandButton&&j("li",{"aria-controls":`${t}__${mt.conversionList}`,"aria-label":m,bind:this,class:mt.widgetButton,key:"esri-coordinate-conversion__expand-button",onclick:this._toggleExpand,onkeydown:this._toggleExpand,role:"button",tabindex:"0",title:m},j("span",{"aria-hidden":"true",class:this.classes(i)})),I=!o&&c.captureButton&&j("li",{"aria-label":h,bind:this,class:this.classes(mt.widgetButton,mt.modeToggle),key:"esri-coordinate-conversion__mode-toggle",onclick:this._toggleMode,onkeydown:this._toggleMode,role:"button",tabindex:"0",title:h},j("span",{"aria-hidden":"true",class:mt.captureButton}));return j("ul",{class:mt.toolDisplay},b,x,I)}_renderInputForm(){const e=this._conversionFormat||this.conversions.getItemAt(0).format,t=this.formats.findIndex(x=>x.name===e.name),i=this.id,r=`${i}__${mt.coordinateInput}`,n=`${i}__${mt.coordinateInput}__header`,o=this._renderOptions(this.formats,!0,t),c={[mt.rejectInput]:this._badInput},{messages:h,messagesCommon:m,headingLevel:b}=this;return j("div",{"aria-labelledby":n,class:mt.inputForm,key:"esri-coordinate-conversion__input-form",role:"search"},j("div",{class:mt.sectionHeading},j("div",{"aria-label":m.back,bind:this,class:this.classes(mt.widgetButton,mt.backButton),onclick:this._toggleInputVisibility,onkeydown:this._toggleInputVisibility,role:"button",tabindex:"0",title:m.back},this._renderBackIcon()),j(Va,{level:b,class:mt.header,id:n},h.inputCoordTitle)),j("div",{class:mt.inputFormGroup},j("select",{"aria-controls":r,"aria-label":h.selectFormat,bind:this,class:this.classes(mt.esriSelect,mt.rowSelect),onchange:this._setInputFormat,title:h.selectFormat},o),j("input",{afterCreate:Fh,"aria-labelledby":n,"aria-required":"true",bind:this,class:this.classes(mt.coordinateInput,mt.input,c),"data-format":e,"data-node-ref":"_coordinateInput",id:r,onkeydown:this._processUserInput,placeholder:h.inputCoordTitle,role:"textbox",spellcheck:!1,title:h.inputCoordTitle,type:"text"})),j("div",{class:mt.inputFormGroup},j("label",{"aria-label":h.goTo},j("input",{bind:this,checked:this._goToEnabled,onclick:this._toggleGoTo,title:h.goTo,type:"checkbox"}),h.goTo),j("button",{"aria-label":h.convert,bind:this,class:this.classes(mt.convertButton,mt.button),onclick:this._processUserInput,title:h.convert,type:"button"},j("span",{class:mt.convertButtonSpan},h.convert))))}_renderConversionsView(){const e=`${this.id}__${mt.conversionList}`,t=this._renderPrimaryTools(),i=this._renderOptions(this.formats),r=this.conversions.map((h,m)=>this._renderConversion(h,m)).toArray(),{messages:n}=this,o=this._expanded?j("div",{class:mt.conversionRow},j("select",{"aria-controls":e,"aria-label":n.addConversion,bind:this,class:this.classes(mt.esriSelect,mt.primarySelect),onchange:this._addConversion,title:n.addConversion},j("option",{disabled:!0,selected:!0,value:""},n.addConversion),i),t):null,c={[mt.expanded]:this._expanded,[mt.expandUp]:this.orientation==="expand-up",[mt.expandDown]:this.orientation==="expand-down"};return j("div",{class:this.classes(mt.conversionsView,c),key:"esri-coordinate-conversion__main-view"},j("ul",{"aria-expanded":this._expanded?"true":"false",class:mt.conversionList,id:e},r),o)}_renderOptions(e,t,i){const r=this.conversions.getItemAt(0);return e.map((n,o)=>{const c=!(t||!r)&&(r.format.name===n.name||this.conversions.map(h=>h.format.name).includes(n.name));return j("option",{"aria-label":n.label,"data-format":n,disabled:c,key:n.name,selected:o===i,value:n.label},n.label.toUpperCase())}).toArray()}_renderPopup(){return j("div",{class:mt.popup,role:"alert"},this._popupMessage)}_renderClipboardPopup(){return j("div",{class:this.classes(mt.popup,mt.clipboardPopup),role:"alert"},this.messages.copySuccessMessage)}_renderPrimaryTools(){const{messages:e,visibleElements:t}=this,i=this.mode==="live"?e.captureMode:e.liveMode,r=t.inputButton&&j("li",{bind:this,class:mt.widgetButton,onclick:this._toggleInputVisibility,onkeydown:this._toggleInputVisibility,role:"button",tabindex:"0",title:e.inputCoordTitle},j("span",{"aria-hidden":"true",class:mt.editButton})),n=t.captureButton&&j("li",{bind:this,class:this.classes(mt.widgetButton,mt.modeToggle),onclick:this._toggleMode,onkeydown:this._toggleMode,role:"button",tabindex:"0",title:i},j("span",{"aria-hidden":"true",class:mt.captureButton})),o=t.settingsButton&&j("li",{bind:this,class:mt.widgetButton,onclick:this._toggleSettingsVisibility,onkeydown:this._toggleSettingsVisibility,role:"button",tabindex:"0",title:e.settingsTitle},j("span",{"aria-hidden":"true",class:mt.settingsButton}));return j("ul",{class:mt.toolDisplay},r,n,o)}_renderSettings(){const e=this.id,t=`${e}__${mt.patternInput}`,i=`${e}__${mt.patternInput}__header`,r=`${e}__${mt.previewCoordinate}`,n=this.formats.filter(E=>E.hasDisplayProperties),o=this._findSettingsFormat(),c=n.indexOf(o),h=this._renderOptions(n,!0,c),m=o.get("currentPattern"),{messages:b,messagesCommon:x,headingLevel:I}=this;return j("div",{"aria-labelledby":i,class:mt.settings,key:"esri-coordinate-conversion__settings"},j("div",{class:mt.sectionHeading},j("div",{bind:this,class:this.classes(mt.widgetButton,mt.backButton),onclick:this._toggleSettingsVisibility,onkeydown:this._toggleSettingsVisibility,role:"button",tabindex:"0",title:x.back},this._renderBackIcon()),j(Va,{level:I,class:mt.header,id:i},b.settingsTitle)),j("div",{class:mt.settingsFormGroup},j("label",{for:t},b.changeCoordinateDisplay),j("select",{"aria-label":b.selectFormat,class:mt.esriSelect,bind:this,onchange:this._setSettingsFormat,title:b.selectFormat},h),j("div",{class:mt.settingsFormGroupHorizontal},j("input",{"aria-controls":r,bind:this,class:this.classes(mt.patternInput,mt.input),id:t,oninput:this._updateCurrentPattern,spellcheck:!1,title:b.changeCoordinateDisplay,type:"text",value:m}),j("div",{"aria-controls":t,bind:this,class:mt.widgetButton,onclick:this._setDefaultPattern,onkeydown:this._setDefaultPattern,role:"button",tabindex:"0",title:b.defaultPattern},j("span",{"aria-hidden":"true",class:mt.refresh})))),j("div",{class:mt.settingsFormGroup},j("label",null,x.preview,j("div",{class:mt.previewCoordinate,id:r,tabindex:"0"},this._previewConversion.displayCoordinate))))}_renderBackIcon(){return j("span",{"aria-hidden":"true",class:Ms(this.container)?mt.rightArrow:mt.leftArrow})}_renderTools(e,t,i){const r=t.displayCoordinate&&this.mode==="capture"?this._renderCopyButton(t):null,{messages:n}=this;return j("ul",{class:mt.toolDisplay,role:"listitem"},r,j("li",{"aria-controls":i,"aria-label":n.removeConversion,bind:this,class:this.classes(mt.widgetButton,mt.rowButton),"data-index":e,key:`${i}__${mt.widgetButton}`,onclick:this._removeConversion,onkeydown:this._removeConversion,tabindex:"0",role:"button",title:n.removeConversion},j("span",{"aria-hidden":"true",class:mt.removeConversion})))}_copyCoordinateOutput(e){const t=e.target;if(!("createTextRange"in document.body)){const i=window.getSelection(),r=document.createRange();r.selectNodeContents(t),i.removeAllRanges(),i.addRange(r)}document.execCommand("copy")}_removeConversion(e){const t=e.currentTarget["data-index"];this.conversions.removeAt(t)}_setDefaultPattern(e){e.stopPropagation();const t=this._findSettingsFormat();t&&(t.currentPattern=t.get("defaultPattern"))}_toggleExpand(){this._expanded=!this._expanded}_toggleInputVisibility(){this._inputVisible=!this._inputVisible,this._popupVisible&&this._hidePopup(),this._inputVisible?this.viewModel.pause():this.viewModel.resume()}_toggleMode(){this.mode=this.mode==="live"?"capture":"live"}_toggleSettingsVisibility(){this._settingsVisible=!this._settingsVisible,this._popupVisible&&this._hidePopup(),this._settingsVisible?(this._setPreviewConversion(),this.viewModel.pause()):this.viewModel.resume()}};g([w()],xr.prototype,"conversions",null),g([w()],xr.prototype,"currentLocation",null),g([w()],xr.prototype,"formats",null),g([w()],xr.prototype,"goToOverride",null),g([w()],xr.prototype,"headingLevel",void 0),g([w()],xr.prototype,"label",null),g([w(),ci("esri/widgets/CoordinateConversion/t9n/CoordinateConversion")],xr.prototype,"messages",void 0),g([w(),ci("esri/t9n/common")],xr.prototype,"messagesCommon",void 0),g([w()],xr.prototype,"mode",null),g([w()],xr.prototype,"orientation",void 0),g([w()],xr.prototype,"multipleConversions",null),g([w()],xr.prototype,"locationSymbol",null),g([w()],xr.prototype,"storageEnabled",null),g([w()],xr.prototype,"storageType",null),g([w()],xr.prototype,"view",null),g([w({type:koe})],xr.prototype,"viewModel",void 0),g([w()],xr.prototype,"visibleElements",void 0),g([Dt("visibleElements")],xr.prototype,"castVisibleElements",null),g([Ki()],xr.prototype,"_copyCoordinateOutput",null),g([Ki()],xr.prototype,"_removeConversion",null),g([Ki()],xr.prototype,"_setDefaultPattern",null),g([Ki()],xr.prototype,"_toggleExpand",null),g([Ki()],xr.prototype,"_toggleInputVisibility",null),g([Ki()],xr.prototype,"_toggleMode",null),g([Ki()],xr.prototype,"_toggleSettingsVisibility",null),xr=g([te("esri.widgets.CoordinateConversion")],xr);let kn=class extends rc(ke){constructor(e){super(e),this.autoNavigate=null,this.filter=null,this.getResults=null,this.getSuggestions=null,this.maxResults=null,this.maxSuggestions=null,this.minSuggestCharacters=null,this.outFields=null,this.placeholder="",this.popupEnabled=null,this.popupTemplate=null,this.prefix="",this.resultGraphicEnabled=null,this.resultSymbol=null,this.suggestionsEnabled=null,this.suffix="",this.withinViewEnabled=!1,this.zoomScale=null}};g([w()],kn.prototype,"autoNavigate",void 0),g([w()],kn.prototype,"filter",void 0),g([w()],kn.prototype,"getResults",void 0),g([w()],kn.prototype,"getSuggestions",void 0),g([w()],kn.prototype,"maxResults",void 0),g([w()],kn.prototype,"maxSuggestions",void 0),g([w()],kn.prototype,"minSuggestCharacters",void 0),g([w()],kn.prototype,"outFields",void 0),g([w()],kn.prototype,"placeholder",void 0),g([w()],kn.prototype,"popupEnabled",void 0),g([w()],kn.prototype,"popupTemplate",void 0),g([w()],kn.prototype,"prefix",void 0),g([w()],kn.prototype,"resultGraphicEnabled",void 0),g([w()],kn.prototype,"resultSymbol",void 0),g([w()],kn.prototype,"suggestionsEnabled",void 0),g([w()],kn.prototype,"suffix",void 0),g([w()],kn.prototype,"withinViewEnabled",void 0),g([w()],kn.prototype,"zoomScale",void 0),kn=g([te("esri.widgets.Search.SearchSource")],kn);const KR=kn,Poe=$e.getLogger("esri.widgets.Search.support.geometryUtils");function Pze(e,t){var r,n;if(!t)return Poe.error("missing-parameter: view is missing."),Promise.reject(new ue("searchgeometryutils:missing-parameter","view is missing."));if(!e)return Poe.error("missing-parameter: point is missing."),Promise.reject(new ue("searchgeometryutils:missing-parameter","point is missing."));if(e.hasZ||t.type==="2d")return Promise.resolve(e);const i=(r=t==null?void 0:t.map)==null?void 0:r.ground;return i&&i.layers.length?i.queryElevation(e,{cache:(n=t.basemapTerrain)==null?void 0:n.elevationQueryCache}).then(o=>o.geometry):Promise.resolve(e)}function Loe(e){if(ce(e))return null;switch(e.type){case"point":return e;case"extent":return e.center;case"polygon":return e.centroid;case"multipoint":return e.getPoint(0);case"polyline":return e.getPoint(0,0)}return null}function YR(e,t,i){return ce(e)?null:e.type==="extent"?e:e.type==="multipoint"||e.type==="polygon"||e.type==="polyline"?e.extent:e.type==="point"?Ooe(e,t,i):void 0}function XR(e,t,i){return ce(e)||ce(t)?null:Ooe(e.center,t,i)}function Ooe(e,t,i){const r=e.hasZ?e.z:void 0;return t&&t.map?(i?AOe(t,i):t.extent).clone().centerAt(e).set({zmax:r,zmin:r}):new gi({xmin:e.x-.25,ymin:e.y-.25,xmax:e.x+.25,ymax:e.y+.25,spatialReference:e.spatialReference,zmin:r,zmax:r})}const Lze=/https?:\/\/services.*\.arcgis\.com/i,Oze=/(?:\{([^}]+)\})/g,yb=$e.getLogger("esri.widgets.Search.support.layerSearchUtils");function Rze(e,t){const{exactMatch:i=!1,location:r,maxResults:n,spatialReference:o,source:c,sourceIndex:h,suggestResult:m,view:b}=e,{layer:x,filter:I,zoomScale:E}=c,k=b&&b.scale,P=Roe(c,b),F=t&&t.signal;return Noe(x).then(()=>{const N=x.popupTemplate;return N?N.getRequiredFields(x.fieldsIndex):null}).then(N=>{var xe,Se,Ae;const{objectIdField:B,returnZ:z}=x,q=Boe(c);if(!QR(x,q))throw yb.error("invalid-field: displayField is invalid."),new ue("getResults():invalid-field","displayField is invalid.");const J=N&&N.length?N:[q],X=c.outFields||J,Y=Foe(X);if(X.includes(B)||Y||X.push(B),((xe=x.floorInfo)==null?void 0:xe.floorField)&&X.push(x.floorInfo.floorField),!(Y||o$(x,X)))throw yb.error("invalid-field: outField is invalid."),new ue("getResults():invalid-field","outField is invalid.");const ae=x.createQuery(),{orderByFields:he}=c;if(he&&(ae.orderByFields=he),o){ae.outSpatialReference=o;const Oe=1/kh(o);Oe&&(ae.maxAllowableOffset=Oe)}const fe=x.geometryType==="mesh"||x.geometryType==="multipatch",ye=((Ae=(Se=x.capabilities)==null?void 0:Se.data)==null?void 0:Ae.supportsZ)&&!fe;if(ae.returnZ=ye&&z!==!1,ae.returnGeometry=!0,ae.multipatchOption=fe?"xyFootprint":null,X&&(ae.outFields=X),r)ae.geometry=r;else if(m.key)ae.objectIds=[m.key];else{const Oe=c.searchFields||[q];if(!o$(x,Oe))throw yb.error("invalid-field: search field is invalid."),new ue("getResults():invalid-field","search field is invalid.");if(Goe(x)&&(ae.num=n),P&&(ae.geometry=P),!m.text.trim())return[];const bt=m.text,{prefix:st="",suffix:et=""}=c,He=Uoe(`${st}${bt}${et}`);zoe(x)&&joe(x,Oe)&&!i&&bt&&(ae.fullText=Voe({text:bt,searchFields:Oe}));const Et=qoe({searchTerm:He,layer:x,searchFields:Oe,filter:I,exactMatch:i,query:ae,type:"search"});if(ae.where=Et,!Doe(ae))return[]}return x.queryFeatures(ae,{signal:F}).then(Oe=>Wze(Oe,b,c,h,q,k,E))})}function Fze(e,t){const{source:i,spatialReference:r,view:n,suggestTerm:o,maxSuggestions:c,sourceIndex:h,exactMatch:m}=e,{layer:b,filter:x}=i,I=t&&t.signal,E=Roe(i,n);return Noe(b).then(()=>{if(!Goe(b))return[];const k=Boe(i),P=i.searchFields||[k],F=[];i.suggestionTemplate?i.suggestionTemplate.replace(Oze,(ye,xe)=>(F.push(xe),ye)):F.push(k);const N=Foe(F);F.includes(b.objectIdField)||N||F.push(b.objectIdField);const B=QR(b,k),z=N||o$(b,F),q=o$(b,P);if(!B)throw yb.error("invalid-field: displayField is invalid."),new ue("getSuggestions():invalid-field","displayField is invalid.");if(!z)throw yb.error("invalid-field: outField is invalid."),new ue("getSuggestions():invalid-field","outField is invalid.");if(!q)throw yb.error("invalid-field: search field is invalid."),new ue("getSuggestions():invalid-field","search field is invalid.");const J=b.createQuery(),{orderByFields:X}=i;if(X&&(J.orderByFields=X),J.outSpatialReference=r,J.returnGeometry=!1,J.num=c,J.outFields=F,E&&(J.geometry=E),!o.trim())return[];const{prefix:Y="",suffix:ae=""}=i,he=Uoe(`${Y}${o}${ae}`);zoe(b)&&joe(b,P)&&!m&&o&&(J.fullText=Voe({text:o,searchFields:P}));const fe=qoe({searchTerm:he,layer:b,searchFields:P,filter:x,exactMatch:m,query:J,type:"suggest"});return J.where=fe,Doe(J)?b.queryFeatures(J,{signal:I}).then(ye=>qze(ye,i,h,k)):[]})}function Roe(e,t){const{filter:i,withinViewEnabled:r}=e,n=t&&t.extent;return i&&i.geometry||(r&&n?n:void 0)}function Foe(e){return e&&e.includes("*")}async function Noe(e){e&&await e.load()}function Doe(e){return!(!e.fullText&&!e.where)}function joe(e,t){const i=e==null?void 0:e.indexes;return!i||!(t==null?void 0:t.length)?!1:i.filter(r=>r.indexType==="FullText").some(r=>{var o;const n=((o=r.fields)==null?void 0:o.split(",").map(c=>c.trim().toLowerCase()))||[];return t.every(c=>n.includes(c.toLowerCase()))})}function Voe({text:e,searchFields:t}){return e.trim().split(" ").filter(i=>!!i.trim()).map(i=>new FJ({onFields:t,searchTerm:i,searchType:"prefix"}))}function zoe(e){var t,i,r;return(r=(i=(t=e==null?void 0:e.capabilities)==null?void 0:t.query)==null?void 0:i.supportsFullTextSearch)!=null?r:!1}function Goe(e){var t,i,r;return(r=(i=(t=e==null?void 0:e.capabilities)==null?void 0:t.query)==null?void 0:i.supportsPagination)!=null?r:!1}function Nze(e){var t,i,r,n;return(n=(r=(i=(t=e==null?void 0:e.fieldsIndex)==null?void 0:t.fields)==null?void 0:i.find(o=>o.type==="string"))==null?void 0:r.name)!=null?n:""}function Boe(e){return e.displayField||e.layer.displayField||Nze(e.layer)}function o$(e,t){return!(!e||!(t==null?void 0:t.length))&&t.every(i=>QR(e,i))}function QR(e,t){return!!e.getField(t)}function Dze(e){for(let t=0;t<e.length;t++)if(e.charCodeAt(t)>255)return!0;return!1}function jze(e,t,i){let r=null;const{codedValues:n}=e;return n&&n.some(o=>{const c=o.name,h=i?c:c.toLowerCase();return(i?t:t.toLowerCase())===h&&(r=o.code.toString(),!0)}),r}function Uoe(e){return e.replace(/\'/g,"''")}function Q3(e,t){const i=t&&t.where;return i?`(${e}) AND (${i})`:e}function Vze({currentTerm:e,field:t,filter:i,exactMatch:r,url:n,type:o}){const c=t.type,h=t.name;if(c==="string"||c==="date"||c==="global-id"){const m=Lze.test(n),b=m&&Dze(e)?"N":"";return Q3(r&&o==="search"?`${h} = ${b}'${e}'`:m?`${h} LIKE ${b}${`'${e}%'`}`:`${`LOWER(${h})`} LIKE ${b}${`'${e.toLowerCase()}%'`}`,i)}if(c==="oid"||c==="small-integer"||c==="integer"||c==="single"||c==="double"){const m=Number(e);return isNaN(m)?null:Q3(`${h} = ${m}`,i)}return Q3(`${h} = ${e}`,i)}function zze(e,t){return e?` OR (${t})`:`(${t})`}function qoe({searchTerm:e,layer:t,searchFields:i,filter:r,exactMatch:n,query:o,type:c}){const{definitionExpression:h,url:m}=t;let b="";return!o.fullText&&e&&i&&i.forEach(x=>{const I=t.getField(x),E=typeof t.getFieldDomain=="function"&&t.getFieldDomain(x),k=(E&&E.type==="coded-value"?jze(E,e,n):null)||e||null;if(k!==null){const P=Vze({currentTerm:k,field:I,filter:r,exactMatch:n,url:m,type:c});P&&(b+=zze(b,P))}}),h&&b?`(${h}) AND (${b})`:h||b}function Gze(e,t){let i=null;const{codedValues:r}=e;return r&&r.length&&r.some(n=>n.code===t&&(i=n.name,!0)),i}function Bze(e,t){return e[Object.keys(e).find(i=>i.toLowerCase()===t.toLowerCase())]}function Hoe(e,t,i){const r=e.sourceLayer,{attributes:n}=e,o=typeof r.getFieldDomain=="function"&&r.getFieldDomain(i);if(t)return oo(t,n);if(i&&n){const c=r.getField(i),h=Bze(n,i);return h==null?"":o&&o.type==="coded-value"?Gze(o,h):(c==null?void 0:c.type)==="date"?Pa(new Date(h)):typeof h=="number"?h.toString():typeof h!="string"?"":h.trim()}return""}function Uze(e,t,i,r){const n=e.sourceLayer,{attributes:o}=e,{objectIdField:c}=n,h=o[c];return{text:Hoe(e,t.suggestionTemplate,r),key:h,sourceIndex:i}}function qze(e,t,i,r){return e.features.map(n=>Uze(n,t,i,r))}function Hze(e,t,i,r,n,o,c){const h=e.clone(),m=e.sourceLayer,b=m&&m.objectIdField,x=b&&e.attributes[b],I=Hoe(e,i.searchTemplate,n),E=YR(h.geometry,t,o),k=typeof c=="number"?XR(_e(E),t,c):E,P=e.clone();return H(k)&&(P.geometry=es.fromExtent(k)),{extent:k,target:P,feature:h,key:x,name:I,sourceIndex:r}}function Wze(e,t,i,r,n,o,c){return e.features.map(h=>Hze(h,t,i,r,n,o,c))}var eF;let jc=eF=class extends KR{constructor(e){super(e),this.displayField=null,this.exactMatch=null,this.orderByFields=null,this.searchFields=null,this.searchTemplate=null,this.suggestionTemplate=null,this.getResults=(t,i)=>Rze(K({source:this},t),i),this.getSuggestions=(t,i)=>Fze(K({source:this},t),i)}set layer(e){this._set("layer",e),e&&e.load().catch(()=>{})}get name(){var e;return(e=this._getLayerTitle())!=null?e:""}set name(e){this._overrideIfSome("name",e)}clone(){return new eF({autoNavigate:this.autoNavigate,filter:this.filter,maxResults:this.maxResults,maxSuggestions:this.maxSuggestions,minSuggestCharacters:this.minSuggestCharacters,outFields:this.outFields?_e(this.outFields):null,placeholder:this.placeholder,popupEnabled:this.popupEnabled,prefix:this.prefix,resultGraphicEnabled:this.resultGraphicEnabled,resultSymbol:this.resultSymbol?this.resultSymbol.clone():null,suggestionsEnabled:this.suggestionsEnabled,suffix:this.suffix,withinViewEnabled:this.withinViewEnabled,displayField:this.displayField,exactMatch:this.exactMatch,layer:this.layer,searchFields:this.searchFields?_e(this.searchFields):null,suggestionTemplate:this.suggestionTemplate,zoomScale:this.zoomScale})}_getFirstStringField(){var e,t;return(t=(e=this.layer.fieldsIndex.fields.find(i=>i.type==="string"))==null?void 0:e.name)!=null?t:""}_getDisplayField(){return this.displayField||this.layer.displayField||this._getFirstStringField()}_getSearchFieldsString(){const{layer:e,searchFields:t}=this;return e.loaded?`: ${(t||[this._getDisplayField()]).map(i=>{const r=e.getField(i);return r&&r.alias||i}).join(", ")}`:""}_getLayerTitle(){const{layer:e}=this;if(!e)return;const{title:t}=e;return t?`${t}${this._getSearchFieldsString()}`:void 0}};g([w({json:{read:{source:"field.name"},write:{target:"field.name"}}})],jc.prototype,"displayField",void 0),g([w({json:{read:{source:"field.exactMatch"},write:{target:"field.exactMatch"}}})],jc.prototype,"exactMatch",void 0),g([w({value:null})],jc.prototype,"layer",null),g([w()],jc.prototype,"name",null),g([w({type:[String],json:{write:!0}})],jc.prototype,"orderByFields",void 0),g([w()],jc.prototype,"searchFields",void 0),g([w()],jc.prototype,"searchTemplate",void 0),g([w()],jc.prototype,"suggestionTemplate",void 0),jc=eF=g([te("esri.widgets.Search.LayerSearchSource")],jc);const mb=jc;function Jze(e){return e&&typeof e.x=="number"&&typeof e.y=="number"}function Zze(e){return e&&typeof e.xmin=="number"&&typeof e.ymin=="number"&&typeof e.xmax=="number"&&typeof e.ymax=="number"}let Wf=class extends ke{constructor(e){super(e),this.address=null,this.attributes=null,this.extent=null,this.location=null,this.score=null}};g([w({type:String,json:{write:!0}})],Wf.prototype,"address",void 0),g([w({type:Object,json:{write:!0}})],Wf.prototype,"attributes",void 0),g([w({type:gi,json:{write:!0}})],Wf.prototype,"extent",void 0),g([w({type:pt,json:{write:!0}})],Wf.prototype,"location",void 0),g([w({type:Number,json:{write:!0}})],Wf.prototype,"score",void 0),Wf=g([te("esri.rest.support.AddressCandidate")],Wf);const Woe=Wf,tF={type:String,json:{read:{source:"token"},write:{target:"token"}}};let Ys=class extends ke{constructor(e){super(e),this.address=null,this.apiKey=null,this.categories=null,this.countryCode=null,this.forStorage=null,this.location=null,this.locationType=null,this.magicKey=null,this.maxLocations=null,this.outFields=null,this.outSpatialReference=null,this.searchExtent=null}};g([w({type:Object,json:{write:!0}})],Ys.prototype,"address",void 0),g([w(tF)],Ys.prototype,"apiKey",void 0),g([w({type:[String],json:{read:{source:"category",reader:e=>e?e.split(","):null},write:{target:"category",writer:(e,t)=>{t.category=e?e.join(","):null}}}})],Ys.prototype,"categories",void 0),g([w({type:String,json:{write:!0}})],Ys.prototype,"countryCode",void 0),g([w({type:Boolean,json:{write:!0}})],Ys.prototype,"forStorage",void 0),g([w({type:pt,json:{write:{writer:(e,t)=>{t.location=e?e.clone().normalize():null}}}})],Ys.prototype,"location",void 0),g([w({type:String,json:{write:!0}})],Ys.prototype,"locationType",void 0),g([w({type:String,json:{write:!0}})],Ys.prototype,"magicKey",void 0),g([w({type:Number,json:{write:!0}})],Ys.prototype,"maxLocations",void 0),g([w({type:[String],json:{write:{writer:(e,t)=>{t.outFields=e?e.join(","):null}}}})],Ys.prototype,"outFields",void 0),g([w({type:Mt,json:{read:{source:"outSR"},write:{target:"outSR"}}})],Ys.prototype,"outSpatialReference",void 0),g([w({type:gi,json:{write:{writer:(e,t)=>{const i=e?e.shiftCentralMeridian():null;t.searchExtent=i}}}})],Ys.prototype,"searchExtent",void 0),Ys=g([te("esri.rest.support.AddressToLocationsParameters")],Ys),Ys.from=Oi(Ys);const Joe=Ys;async function Kze(e,t,i){t=Joe.from(t);const r=Br(e),x=t.toJSON(),{address:n}=x,o=Sx(x,["address"]),c=Ce(K(K({},n),o),{f:"json"}),h=p1(K(K({},r.query),c)),m=t2(h,i),b=`${r.path}/findAddressCandidates`;return Nt(b,m).then(Yze)}function Yze({data:e}){if(!e)return[];const{candidates:t,spatialReference:i}=e;return t?t.map(r=>{if(!r)return;const{extent:n,location:o}=r,c=!n||Zze(n);return Jze(o)&&c?(n&&(n.spatialReference=i),o.spatialReference=i,Woe.fromJSON(r)):void 0}):[]}let Dp=class extends ke{constructor(e){super(e),this.apiKey=null,this.location=null,this.locationType=null,this.outSpatialReference=null}};g([w(tF)],Dp.prototype,"apiKey",void 0),g([w({type:pt,json:{write:{writer:(e,t)=>{const i=e?e.clone().normalize():null,r=i!==void 0;t.location=r?i:null}}}})],Dp.prototype,"location",void 0),g([w({type:String,json:{write:!0}})],Dp.prototype,"locationType",void 0),g([w({type:Mt,json:{read:{source:"outSR"},write:{target:"outSR"}}})],Dp.prototype,"outSpatialReference",void 0),Dp=g([te("esri.rest.support.LocationToAddressParameters")],Dp),Dp.from=Oi(Dp);const Zoe=Dp;async function Xze(e,t,i){t=Zoe.from(t);const r=Br(e),n=Ce(K({},t.toJSON()),{f:"json"}),o=p1(K(K({},r.query),n)),c=t2(o,i),h=`${r.path}/reverseGeocode`;return Nt(h,c).then(Qze)}function Qze({data:e}){if(!e)return;const{address:t,location:i}=e,r=t&&t.Match_addr||"";return Woe.fromJSON({address:r,attributes:t||{},location:i,score:100})}let gb=class extends ke{constructor(e){super(e),this.isCollection=null,this.magicKey=null,this.text=null}};g([w({type:Boolean,json:{write:!0}})],gb.prototype,"isCollection",void 0),g([w({type:String,json:{write:!0}})],gb.prototype,"magicKey",void 0),g([w({type:String,json:{write:!0}})],gb.prototype,"text",void 0),gb=g([te("esri.rest.support.SuggestionCandidate")],gb);const eGe=gb;let ol=class extends ke{constructor(e){super(e),this.apiKey=null,this.categories=null,this.countryCode=null,this.location=null,this.maxSuggestions=null,this.outSpatialReference=null,this.searchExtent=null,this.text=null}};g([w(tF)],ol.prototype,"apiKey",void 0),g([w({type:[String],json:{read:{source:"category",reader:e=>e?e.split(","):null},write:{target:"category",writer:(e,t)=>{t.category=e?e.join(","):null}}}})],ol.prototype,"categories",void 0),g([w({type:String,json:{write:!0}})],ol.prototype,"countryCode",void 0),g([w({type:pt,json:{write:{writer:(e,t)=>{t.location=e?e.clone().normalize():null}}}})],ol.prototype,"location",void 0),g([w({type:Number,json:{write:!0}})],ol.prototype,"maxSuggestions",void 0),g([w({type:Mt,json:{read:{source:"outSR"},write:{target:"outSR"}}})],ol.prototype,"outSpatialReference",void 0),g([w({type:gi,json:{write:{writer:(e,t)=>{const i=e?e.shiftCentralMeridian():null;t.searchExtent=JSON.stringify(i)}}}})],ol.prototype,"searchExtent",void 0),g([w({type:String,json:{write:!0}})],ol.prototype,"text",void 0),ol=g([te("esri.rest.support.SuggestLocationsParameters")],ol),ol.from=Oi(ol);const Koe=ol;async function tGe(e,t,i){const r=Br(e),n=Ce(K({},(t=Koe.from(t)).toJSON()),{f:"json"}),o=p1(K(K({},r.query),n)),c=t2(o,i),h=`${r.path}/suggest`;return Nt(h,c).then(iGe)}function iGe(e){const{data:t}=e;if(!t)return[];const{suggestions:i}=t;return i?i.map(r=>new eGe(r)):[]}const rGe="Single Line Input",nGe=3e5;function sGe(e,t){return e.location?uGe(e,t):hGe(e,t)}function Yoe(e,t){if(t.localSearchDisabled)return null;const i=e==null?void 0:e.scale;return typeof i=="number"&&i<=nGe?e.get("extent.center"):null}function oGe(e,t){const{source:i,spatialReference:r,view:n,suggestTerm:o,maxSuggestions:c,sourceIndex:h}=e,m=new Koe,{apiKey:b,url:x}=i,I=Qoe(i,n),E=t&&t.signal;if(!x)return Promise.resolve(null);b&&(m.apiKey=b),i.categories&&(m.categories=i.categories),r&&(m.outSpatialReference=r);const k=Yoe(n,i);if(k&&(m.location=k),!o.trim())return Promise.resolve(null);const{prefix:P="",suffix:F=""}=i,N=`${P}${o}${F}`;return m.text=N,I&&(m.searchExtent=Ht(I)),m.maxSuggestions=c,i.countryCode&&(m.countryCode=i.countryCode),tGe(x,m,{signal:E}).then(B=>dGe(B,h))}function aGe(e){return!!e&&/(?:geocode\-api\.arcgis\.com\/arcgis\/rest\/services\/world\/geocodeserver).*/i.test(e)}function lGe(e){return!!e&&/(?:\/servers\/[\da-z\.-]+\/rest\/services\/world\/geocodeserver).*/i.test(e)}function Xoe(e){return!!e&&/(?:arcgis\.com\/arcgis\/rest\/services\/world\/geocodeserver).*/i.test(e)}const cGe="https://geocode-api.arcgis.com/arcgis/rest/services/World/GeocodeServer";function uGe(e,t){const{source:i,spatialReference:r,location:n,sourceIndex:o,view:c}=e,{apiKey:h,url:m,zoomScale:b,defaultZoomScale:x}=i,I=c&&c.scale,E=t&&t.signal,k=new Zoe;return k.location=n,h&&(k.apiKey=h),r&&(k.outSpatialReference=r),Xze(m,k,{signal:E}).then(P=>eae([P],{sourceIndex:o,scale:I,view:c,zoomScale:b,defaultZoomScale:x})).catch(()=>[])}function Qoe(e,t){const{filter:i,withinViewEnabled:r}=e,n=t&&t.scale,o=t&&t.extent,c=i&&i.geometry;return YR(c,t,n)||(r&&o?o:void 0)}function hGe(e,t){const{source:i,suggestResult:r,spatialReference:n,view:o,maxResults:c,sourceIndex:h}=e,m=i&&i.zoomScale,b=i&&i.defaultZoomScale;if(!r.text.trim())return Promise.resolve(null);const x=!r.key&&i.prefix?i.prefix:"",I=!r.key&&i.suffix?i.suffix:"",E=`${x}${r.text}${I}`,k=new Joe,{apiKey:P,url:F}=i,N=o&&o.scale,B=Qoe(i,o),z=t&&t.signal;if(P&&(k.apiKey=P),!F)return Promise.resolve(null);i.categories&&(k.categories=i.categories),i.locationType&&(k.locationType=i.locationType),n&&(k.outSpatialReference=n);const q=Yoe(o,i);q&&(k.location=q),k.maxLocations=c,B&&(k.searchExtent=Ht(B)),i.countryCode&&(k.countryCode=i.countryCode);const{key:J}=r,X=`${J}`;return J&&(k.magicKey=X),k.address={},k.address[i.singleLineFieldName||rGe]=E,i.outFields&&(k.outFields=i.outFields),Kze(F,k,{signal:z}).then(Y=>eae(Y,{key:X,scale:N,sourceIndex:h,view:o,zoomScale:m,defaultZoomScale:b}))}function pGe(e,t){return{text:e.text,key:e.magicKey,sourceIndex:t}}function dGe(e,t){return e.map(i=>pGe(i,t))}function fGe(e,t){const{key:i,scale:r,sourceIndex:n,view:o,zoomScale:c,defaultZoomScale:h}=t,{attributes:m,extent:b,location:x,address:I}=e,E=new Gr({geometry:x,attributes:m}),k=b||x,P=YR(k,o,r),F=typeof c=="number"?XR(P,o,c):typeof h=="number"&&k.type==="point"?XR(P,o,h):P,N=x?`${x.x},${x.y}`:"",B=I||N,z=E.clone();return H(F)&&(z.geometry=es.fromExtent(F)),{extent:F,feature:E,target:z,key:i,name:B,sourceIndex:n}}function eae(e,t){return e.filter(Boolean).map(i=>fGe(i,t))}var iF;const yGe="esri.widgets.Search.LocatorSearchSource";let bo=iF=class extends KR{constructor(e){super(e),this.apiKey=null,this.categories=null,this.countryCode=null,this.defaultZoomScale=null,this.localSearchDisabled=!1,this.locationType=null,this.name="",this.placeholder="",this.searchTemplate="",this.singleLineFieldName=null,this.suggestionsEnabled=null,this.url=null,this.zoomScale=null,this.getResults=(t,i)=>sGe(K({source:this},t),i),this.getSuggestions=(t,i)=>oGe(K({source:this},t),i)}clone(){return new iF({apiKey:this.apiKey,autoNavigate:this.autoNavigate,filter:this.filter,maxResults:this.maxResults,maxSuggestions:this.maxSuggestions,minSuggestCharacters:this.minSuggestCharacters,outFields:this.outFields?_e(this.outFields):null,placeholder:this.placeholder,popupEnabled:this.popupEnabled,prefix:this.prefix,resultGraphicEnabled:this.resultGraphicEnabled,resultSymbol:this.resultSymbol?this.resultSymbol.clone():null,suggestionsEnabled:this.suggestionsEnabled,suffix:this.suffix,withinViewEnabled:this.withinViewEnabled,categories:this.categories?_e(this.categories):null,countryCode:this.countryCode,locationType:this.locationType,searchTemplate:this.searchTemplate,singleLineFieldName:this.singleLineFieldName,zoomScale:this.zoomScale})}};g([w()],bo.prototype,"apiKey",void 0),g([w()],bo.prototype,"categories",void 0),g([w()],bo.prototype,"countryCode",void 0),g([w({json:{write:!0}})],bo.prototype,"defaultZoomScale",void 0),g([w()],bo.prototype,"localSearchDisabled",void 0),g([w()],bo.prototype,"locationType",void 0),g([w({json:{write:!0}})],bo.prototype,"name",void 0),g([w({json:{write:!0}})],bo.prototype,"placeholder",void 0),g([w()],bo.prototype,"searchTemplate",void 0),g([w({json:{write:!0}})],bo.prototype,"singleLineFieldName",void 0),g([w({json:{read:{source:"suggest"},write:{target:"suggest"}}})],bo.prototype,"suggestionsEnabled",void 0),g([w({json:{write:!0}})],bo.prototype,"url",void 0),g([w({json:{write:!0}})],bo.prototype,"zoomScale",void 0),bo=iF=g([te(yGe)],bo);const tae=bo;new kt({MGRS:"mgrs",USNG:"usng",UTM:"utm",GeoRef:"geo-ref",GARS:"gars",DMS:"dms",DDM:"ddm",DD:"dd"});new kt({109006:"centimeters",9102:"decimal-degrees",109005:"decimeters",9002:"feet",109009:"inches",9036:"kilometers",9001:"meters",9035:"miles",109007:"millimeters",109012:"nautical-miles",9096:"yards"});let Im=class extends ke{constructor(e){super(e),this.deviationUnit=null,this.geometries=null,this.maxDeviation=null}};g([w({type:String,json:{write:!0}})],Im.prototype,"deviationUnit",void 0),g([w({json:{read:{reader:e=>e?e.map(t=>xs(t)).filter(H):null},write:{writer:(e,t)=>{var i;t.geometries=(i=e==null?void 0:e.map(r=>r.toJSON()))!=null?i:null}}}})],Im.prototype,"geometries",void 0),g([w({type:Number,json:{write:!0}})],Im.prototype,"maxDeviation",void 0),Im=g([te("esri.rest.support.GeneralizeParameters")],Im),Im.from=Oi(Im);new kt({preserveShape:"preserve-shape"});let Jf=class extends ke{constructor(e){super(e),this.calculationType=null,this.geodesic=null,this.lengthUnit=null,this.polylines=null}};g([w({type:String,json:{write:!0}})],Jf.prototype,"calculationType",void 0),g([w({type:Boolean,json:{write:!0}})],Jf.prototype,"geodesic",void 0),g([w({json:{write:!0}})],Jf.prototype,"lengthUnit",void 0),g([w({type:[Fn],json:{read:{reader:e=>e?e.map(t=>xs(t)):null},write:{writer:(e,t)=>{t.polylines=e.map(i=>i.toJSON())}}}})],Jf.prototype,"polylines",void 0),Jf=g([te("esri.rest.support.LengthsParameters")],Jf),Jf.from=Oi(Jf);new kt({esriGeometryOffsetBevelled:"bevelled",esriGeometryOffsetMitered:"mitered",esriGeometryOffsetRounded:"rounded"});new kt({9001:"meters",9002:"feet",9036:"kilometers",9093:"miles",109012:"nautical-miles",109001:"yards"});let jp=class extends ke{constructor(e){super(e),this.bevelRatio=null,this.geometries=null,this.offsetDistance=null,this.offsetHow=null,this.offsetUnit=null}};g([w({type:Number,json:{write:!0}})],jp.prototype,"bevelRatio",void 0),g([w({json:{read:{reader:e=>e?e.map(t=>xs(t)).filter(H):null},write:{writer:(e,t)=>{var i;t.geometries=(i=e==null?void 0:e.map(r=>r.toJSON()))!=null?i:null}}}})],jp.prototype,"geometries",void 0),g([w({type:Number,json:{write:!0}})],jp.prototype,"offsetDistance",void 0),g([w({type:String,json:{write:!0}})],jp.prototype,"offsetHow",void 0),g([w({type:String,json:{write:!0}})],jp.prototype,"offsetUnit",void 0),jp=g([te("esri.rest.support.OffsetParameters")],jp),jp.from=Oi(jp);let $m=class extends ke{constructor(e){super(e),this.geometries=null,this.outSpatialReference=null,this.transformation=null,this.transformForward=null}toJSON(){const e=this.geometries.map(r=>r.toJSON()),t=this.geometries[0],i={};return i.outSR=this.outSpatialReference.wkid||JSON.stringify(this.outSpatialReference.toJSON()),i.inSR=t.spatialReference.wkid||JSON.stringify(t.spatialReference.toJSON()),i.geometries=JSON.stringify({geometryType:bh(t),geometries:e}),this.transformation&&(i.transformation=this.transformation.wkid||JSON.stringify(this.transformation)),this.transformForward!=null&&(i.transformForward=this.transformForward),i}};g([w()],$m.prototype,"geometries",void 0),g([w({json:{read:{source:"outSR"}}})],$m.prototype,"outSpatialReference",void 0),g([w()],$m.prototype,"transformation",void 0),g([w()],$m.prototype,"transformForward",void 0),$m=g([te("esri.rest.support.ProjectParameters")],$m);const iae=$m,mGe=Oi(iae);async function gGe(e,t,i){t=mGe(t);const r=Br(e),n=K(Ce(K({},r.query),{f:"json"}),t.toJSON()),o=t.outSpatialReference,c=bh(t.geometries[0]),h=t2(n,i);return Nt(r.path+"/project",h).then(({data:{geometries:m}})=>hJ(m,c,o))}new kt({esriGeometryRelationCross:"cross",esriGeometryRelationDisjoint:"disjoint",esriGeometryRelationIn:"in",esriGeometryRelationInteriorIntersection:"interior-intersection",esriGeometryRelationIntersection:"intersection",esriGeometryRelationLineCoincidence:"line-coincidence",esriGeometryRelationLineTouch:"line-touch",esriGeometryRelationOverlap:"overlap",esriGeometryRelationPointTouch:"point-touch",esriGeometryRelationTouch:"touch",esriGeometryRelationWithin:"within",esriGeometryRelationRelation:"relation"});let Zf=class extends ke{constructor(e){super(e),this.geometries1=null,this.geometries2=null,this.relation=null,this.relationParameter=null}};g([w({json:{read:{reader:e=>e?e.map(t=>xs(t)).filter(H):null},write:{writer:(e,t)=>{var i;t.geometries1=(i=e==null?void 0:e.map(r=>r.toJSON()))!=null?i:null}}}})],Zf.prototype,"geometries1",void 0),g([w({json:{read:{reader:e=>e?e.map(t=>xs(t)).filter(H):null},write:{writer:(e,t)=>{var i;t.geometries2=(i=e==null?void 0:e.map(r=>r.toJSON()))!=null?i:null}}}})],Zf.prototype,"geometries2",void 0),g([w({type:String,json:{write:!0}})],Zf.prototype,"relation",void 0),g([w({type:String,json:{write:!0}})],Zf.prototype,"relationParameter",void 0),Zf=g([te("esri.rest.support.RelationParameters")],Zf),Zf.from=Oi(Zf);new kt({0:"default-curve-extension",1:"relocate-ends",2:"keep-end-attributes",4:"no-end-attributes",8:"no-extend-at-from",16:"no-extend-at-to"});let Em=class extends ke{constructor(e){super(e),this.extendHow="default-curve-extension",this.polylines=null,this.trimExtendTo=null}};g([w({type:String,json:{write:!0}})],Em.prototype,"extendHow",void 0),g([w({type:[Fn],json:{read:{reader:e=>e?e.map(t=>xs(t)):null},write:{writer:(e,t)=>{t.polylines=e.map(i=>i.toJSON())}}}})],Em.prototype,"polylines",void 0),g([w({json:{read:{reader:e=>e?xs(e):null},write:{writer:(e,t)=>{t.trimExtendTo=e.toJSON()}}}})],Em.prototype,"trimExtendTo",void 0),Em=g([te("esri.rest.support.TrimExtendParameters")],Em),Em.from=Oi(Em);const rae=$e.getLogger("esri.widgets.support.geolocationUtils"),vGe={maximumAge:0,timeout:15e3,enableHighAccuracy:!0};function bGe(){const e=Te("esri-geolocation");return e||rae.warn("geolocation-unsupported","Geolocation unsupported."),e}function wGe(){const e=window.isSecureContext;return e||rae.warn("insecure-context","Geolocation requires a secure origin."),e}function nae(){return bGe()&&wGe()}function _Ge(e){const t=15e3;return e||(e=vGe),new Promise((i,r)=>{setTimeout(()=>r(new ue("geolocation:timeout","getting the current geolocation position timed out")),t),navigator.geolocation.getCurrentPosition(i,r,e)})}function xGe(e,t){const{position:i,view:r}=e;return IGe(MGe(SGe(i)),r,t)}function SGe(e){const t=e&&e.coords||{},i={accuracy:t.accuracy,altitude:t.altitude,altitudeAccuracy:t.altitudeAccuracy,heading:t.heading,latitude:t.latitude,longitude:t.longitude,speed:t.speed};return e&&{coords:i,timestamp:e.timestamp}}function MGe(e){const t=e&&e.coords;return t?new pt({longitude:t.longitude,latitude:t.latitude,z:t.altitude||null,spatialReference:{wkid:4326}}):null}function IGe(e,t,i){if(!t)return Promise.resolve(e);const r=t.spatialReference;return r.isWGS84?Promise.resolve(e):r.isWebMercator?Promise.resolve(tu(e)):$Ge(i).then(n=>{if(!n)throw new ue("geometry-service:missing-url","Geometry service URL is missing");const o=new iae({geometries:[e],outSpatialReference:r});return gGe(n,o,i).then(c=>c[0])})}function $Ge(e){if($i.geometryServiceUrl)return Promise.resolve($i.geometryServiceUrl);const t=nn.getDefault();return t.load(e).catch(()=>{}).then(()=>t.get("helperServices.geometry.url"))}function wo(e,t){return e.hasOwnProperty(t)&&e[t]!=null&&e[t]!==""}const EGe=()=>z5("esri/widgets/Search/t9n/Search"),sae="esri.widgets.Search.SearchViewModel",Vp=$e.getLogger(sae),oae="highlight",a$=Xe.ofType({key:e=>e.layer?"layer":"locator",base:KR,typeMap:{layer:mb,locator:tae}}),aae=Mt.WGS84,TGe="esri/images/search/search-symbol-32.png",CGe=/<(?:.|\s)*?>/g,vb=-1;let hi=class extends Z1(Or.EventedMixin(Ye)){constructor(e){super(e),this._handles=new Ti,this._gotoController=null,this._searching=null,this._createdFeatureLayers=[],this.autoNavigate=!0,this.autoSelect=!0,this.defaultPopupTemplate=null,this.defaultSources=new a$,this.defaultSymbols={point:new Og({url:_i(TGe),size:24,width:24,height:24}),polyline:new rs({color:[130,130,130,1],width:2}),polygon:new ea({color:[235,235,235,.4],outline:{color:[130,130,130,1],width:2}})},this.includeDefaultSources=!0,this.maxInputLength=128,this.maxResults=6,this.maxSuggestions=6,this.messages=null,this.minSuggestCharacters=3,this.popupEnabled=!0,this.popupTemplate=null,this.portal=nn.getDefault(),this.resultCount=null,this.resultGraphicEnabled=!0,this.resultGraphic=null,this.results=null,this.selectedSuggestion=null,this.searchAllEnabled=!0,this.selectedResult=null,this.sources=new a$,this.suggestionDelay=350,this.suggestionCount=null,this.suggestions=null,this.suggestionsEnabled=!0,this.view=null}initialize(){const e=async()=>{const t=await EGe();this.messages=t,this.defaultPopupTemplate=new _d({title:t.searchResult,content:"{Match_addr}"})};e(),this._handles.add([we(()=>[this.includeDefaultSources,this.view,this.portal],()=>this._update(),St),US(e)])}destroy(){this._destroyFeatureLayers(),this._abortGoTo(),this.clearGraphics(),this._handles.destroy(),this._handles=null}get activeSource(){var e;return(e=this.allSources.at(this.activeSourceIndex))!=null?e:null}get activeSourceIndex(){return this.allSources.length===1||!this.searchAllEnabled?0:vb}set activeSourceIndex(e){this._overrideIfSome("activeSourceIndex",e)}get allPlaceholder(){var e;return(e=this.messages)==null?void 0:e.allPlaceholder}set allPlaceholder(e){this._overrideIfSome("allPlaceholder",e)}get allSources(){const{sources:e,defaultSources:t,includeDefaultSources:i}=this,r=typeof i=="function"?i.call(null,{sources:e,defaultSources:t}):i?t.concat(e):e,n=this._get("allSources")||new a$;return n.removeAll(),n.addMany(r.filter(Boolean)),n}get locationEnabled(){return this._get("locationEnabled")||nae()}set locationEnabled(e){if(e===void 0)return void this._clearOverride("locationEnabled");const t=nae();if(e&&!t){const i=new ue("locationEnabled:geolocation-unsupported","Geolocation API is unsupported.",{geolocation:navigator.geolocation});Vp.error(i)}this._override("locationEnabled",!!e&&t)}get placeholder(){const{allSources:e,activeSourceIndex:t,allPlaceholder:i}=this;if(t===vb)return i;const r=e.at(t);return r?r.placeholder:""}set searchTerm(e){this._set("searchTerm",e||""),this.clearGraphics(),this.selectedSuggestion&&this.selectedSuggestion.text!==e&&this._set("selectedSuggestion",null),e===""&&this._clear()}get searchTerm(){return this._get("searchTerm")||""}get state(){return this._searching?"searching":this.updating?"loading":this.allSources.length===0?"disabled":"ready"}get updating(){return this._updatingPromise!=null}clear(){this.searchTerm=""}clearGraphics(){this._removeHighlight(),this._closePopup(),this.view&&this.view.graphics.remove(this.resultGraphic),this._set("resultGraphic",null)}search(e,t){this.emit("search-start"),this.clearGraphics();const i=this._createSuggestionForSearch(e),r=this.when().then(()=>this._getResultsFromSources(i,t).then(n=>{var m;if((m=Ht(t==null?void 0:t.signal))==null?void 0:m.aborted)return null;const o={activeSourceIndex:this.activeSourceIndex,searchTerm:i.text,numResults:0,numErrors:0,errors:[],results:[]};this._formatResponse(o,n,i);const c=this._getFirstResult(o.results),h=(i.location&&c?c.name:i.text).replace(CGe,"");return this._set("searchTerm",h),(i.key&&typeof i.sourceIndex=="number"||i.location)&&this._set("selectedSuggestion",i),this._set("results",o.results),this._set("resultCount",o.results.reduce((b,x)=>b+x.results.length,0)),this.emit("search-complete",o),this._selectFirstResult(c).then(()=>o)})).then(n=>(this._clearSearching(),n),n=>{throw this._clearSearching(),n});return this._searching=r,r}searchNearby(e){if(!this.locationEnabled){const i=new ue("searchNearby:geolocation-unsupported","Geolocation API is unsupported.",{geolocation:navigator.geolocation});return Vp.error(i),Promise.reject(i)}const t=_Ge().then(i=>xGe({position:i,view:this.view},e)).then(i=>this.search(i,e));return this._searching=t,t.catch(()=>{}).then(()=>this._clearSearching()),t}select(e){if(this.clearGraphics(),!e){const B=new ue("select:missing-parameter","Cannot select without a searchResult.",{searchResult:e});return Vp.error(B),Promise.reject(B)}const{view:t}=this,i=wo(e,"sourceIndex")?e.sourceIndex:this._getSourceIndexOfResult(e),r=this.allSources.at(i);if(!r){const B=new ue("select:missing-source","Cannot select without a source.",{source:r});return Vp.error(B),Promise.reject(B)}const n=r instanceof mb?this._getLayerSourcePopupTemplate(r):r.popupTemplate,o=r.resultSymbol||this._getDefaultSymbol(e),c=wo(r,"resultGraphicEnabled")?r.resultGraphicEnabled:this.resultGraphicEnabled,h=wo(r,"autoNavigate")?r.autoNavigate:this.autoNavigate,m=wo(r,"popupEnabled")?r.popupEnabled:this.popupEnabled,b=m?n||this.popupTemplate||this.defaultPopupTemplate:null,{feature:x}=e;if(!x){const B=new ue("select:missing-feature","Cannot select without a feature.",{feature:x});return Vp.error(B),Promise.reject(B)}const{attributes:I,geometry:E,layer:k,sourceLayer:P}=x,F=Loe(E),N={layerViewQuery:this._getLayerView(x),elevationQuery:t&&H(F)?Pze(F,t).catch(()=>F):Promise.resolve(F)};return Mr(N).then(B=>{const z=B.layerViewQuery.value,q=B.elevationQuery.value;o instanceof J0&&(o.text=e.name);const J=t&&h?e.target||e.extent:null;return(H(J)?this._goToSearchResult(J):Promise.resolve()).then(()=>{var he;const X=z?x:new Gr({geometry:E,symbol:o,attributes:I,layer:k,sourceLayer:P,popupTemplate:b}),Y=m&&((he=this.view)==null?void 0:he.popup),ae=Y&&X.getEffectivePopupTemplate(Y.defaultPopupTemplateEnabled);return ae&&t.popup.open({features:[X],location:q}),z&&jP(z)&&!ae&&this._highlightFeature({graphic:X,layerView:z}),!z&&c&&t&&t.graphics.push(X),this._setResultFloor(e),this._set("selectedResult",e),this._set("resultGraphic",X),this.emit("select-result",{result:e,source:r,sourceIndex:i}),e})})}suggest(e,t,i){const r=e||this.searchTerm;return this.emit("suggest-start",{searchTerm:r}),this._suggestTimer(t,i).then(()=>this._suggestImmediate(r,i).then(n=>(this._set("suggestions",n.results),this._set("suggestionCount",n.results.reduce((o,c)=>o+c.results.length,0)),this.emit("suggest-complete",n),n)))}async when(){await Ch(()=>!this.updating)}async _update(){const{portal:e,view:t}=this;if(this.includeDefaultSources){const i=this._updatingPromise=Mr([e==null?void 0:e.load(),t==null?void 0:t.when()]);if(this.destroyed||(await i,i!==this._updatingPromise))return}await Ch(()=>this.messages),this.destroyed||this._updateDefaultSources(),this._updatingPromise=null}_clearSearching(){this._searching=null}_convertHelperServices(){var t,i;const e=(i=(t=this.portal)==null?void 0:t.helperServices)==null?void 0:i.geocode;return e?e.map(r=>{if(r.placefinding===!1)return;const n=$i.apiKey&&Xoe(r.url)?{url:cGe}:null,o=tae.fromJSON(K(K({},r),n)),c=o.url;if(Xoe(c)||lGe(c)||aGe(c)){const h=o.outFields||["Addr_type","Match_addr","StAddr","City"],m=o.placeholder||this.messages.placeholder,b=typeof o.defaultZoomScale=="number"?o.defaultZoomScale:2500;o.set({singleLineFieldName:"SingleLine",outFields:h,placeholder:m,defaultZoomScale:b})}return o.singleLineFieldName?o:void 0}).filter(Boolean):[]}_destroyFeatureLayers(){this._createdFeatureLayers.forEach(e=>e==null?void 0:e.destroy()),this._createdFeatureLayers=[]}_getLayerSources(e,t){var r;const i=(r=this.view)==null?void 0:r.map;return e.map(n=>{const o=i.findLayerById(n.id);if(!o)return;const c=this._getLayerJSON(n),h=mb.fromJSON(c);return h.placeholder=t,this._getLayer(o,c).then(m=>{h.layer=m}),h}).filter(Boolean).toArray()}_getTableSources(e,t){var r;const i=(r=this.view)==null?void 0:r.map;return e.map(n=>{const o=i.findTableById(n.id);if(!o)return;const c=this._getLayerJSON(n),h=mb.fromJSON(c);return h.placeholder=t,this._getLayer(o,c).then(m=>{h.layer=m}),h}).filter(Boolean).toArray()}_convertApplicationProperties(){var c,h,m;const e=(c=this.view)==null?void 0:c.map,t=(m=(h=e==null?void 0:e.applicationProperties)==null?void 0:h.viewing)==null?void 0:m.search;if(!t)return[];const{enabled:i,hintText:r,layers:n,tables:o}=t;return i?[...this._getLayerSources(n,r),...this._getTableSources(o,r)]:[]}async _getSubLayer(e,t){if(await e.load(),!e.allSublayers)throw new Error;const i=e.allSublayers.find(n=>n.id===t.subLayer);if(!i)throw new Error;const r=await i.createFeatureLayer();return this._createdFeatureLayers.push(r),r}async _getBuildingSubLayer(e,t){await e.load();const i=e.allSublayers.find(r=>r.id===t.subLayer);if((i==null?void 0:i.type)!=="building-component")throw new Error;if(await i.load(),i.associatedLayer==null)throw new Error;return await i.associatedLayer.load(),i}_getLayer(e,t){return e.type==="feature"||e.type==="scene"||e.type==="csv"||e.type==="geojson"||e.type==="ogc-feature"?Promise.resolve(e):e.type==="map-image"?this._getSubLayer(e,t).catch(()=>{const i=new ue("search:create-featurelayer","Could not create a FeatureLayer from the MapImageLayer",{layer:e});return Vp.error(i),null}):e.type==="building-scene"?this._getBuildingSubLayer(e,t):Promise.resolve(null)}_getLayerJSON(e){return typeof e.toJSON=="function"?e.toJSON():e}_updateDefaultSources(){const{defaultSources:e,includeDefaultSources:t}=this;this._destroyFeatureLayers(),e.removeAll(),t&&e.addMany([...this._convertApplicationProperties(),...this._convertHelperServices()])}_abortGoTo(){this._gotoController&&this._gotoController.abort(),this._gotoController=null}_clear(){this._abortGoTo(),this._set("resultCount",null),this._set("results",null),this._set("suggestions",null),this._set("suggestionCount",null),this._set("selectedResult",null),this._set("selectedSuggestion",null),this.emit("search-clear")}_closePopup(){var r;const e=(r=this.view)==null?void 0:r.popup,{resultGraphic:t}=this;if(!e||!t)return;const{selectedFeature:i}=e;i&&i===t&&e.close()}_suggestTimer(e,t){const i=e!=null?e:this.suggestionDelay;return uw(i,null,t&&t.signal)}_createLocationForSearch(e){return e instanceof Gr?Loe(e.geometry):e instanceof pt?e:Array.isArray(e)&&e.length===2?new pt({longitude:e[0],latitude:e[1]}):null}_createSuggestionForSearch(e){if(e&&wo(e,"key")&&wo(e,"text")&&wo(e,"sourceIndex"))return e;const t=this._createLocationForSearch(e),i=typeof e=="string"?e:this.searchTerm,{selectedSuggestion:r,selectedResult:n}=this,o=!e&&r&&n,c=o&&r.key===n.key&&r.sourceIndex===n.sourceIndex,h=o&&r.location;return c||h?r:{location:Ht(t),text:t?"":i,sourceIndex:null,key:null}}_getFirstResult(e){let t=null;return e&&e.some(i=>{const{results:r}=i,n=r[0],o=!!n;return o&&(t=n),o}),t}_selectFirstResult(e){return this.autoSelect&&e?this.select(e):Promise.resolve(null)}_suggestImmediate(e,t){return this.when().then(()=>this._getSuggestionsFromSources(e,t)).then(i=>{var n;if((n=Ht(t==null?void 0:t.signal))==null?void 0:n.aborted)return null;const r={activeSourceIndex:this.activeSourceIndex,searchTerm:e,numResults:0,numErrors:0,errors:[],results:[]};return this._formatResponse(r,i),r})}_formatSourceResponse(e,t,i){const r=t&&t.value||[],n=t&&t.error,o=this.allSources.at(i);if(n){const c={sourceIndex:i,source:o,error:n};e.errors.push(c),Vp.error(n),e.numErrors++}else{const c={sourceIndex:i,source:o,results:r};e.results.push(c),e.numResults+=r.length}}_formatResponse(e,t,i){if(t)if(e.activeSourceIndex===vb){const r=i&&wo(i,"sourceIndex")&&i.sourceIndex!==-1?i.sourceIndex:void 0;t.forEach((n,o)=>{const c=r!==void 0?r:o;this._formatSourceResponse(e,n,c)})}else this._formatSourceResponse(e,t[0],e.activeSourceIndex)}_getResultsFromSources(e,t){const{allSources:i}=this,r=!e.location&&wo(e,"sourceIndex")?e.sourceIndex:this.activeSourceIndex,n=[];if(!i.length){const o=new ue("search:no-sources-defined","At least one source is required.",{allSources:i});return Vp.error(o),Promise.reject(o)}return r===vb?i.forEach((o,c)=>{n.push(this._getResultsFromSource(e,c,t))}):n.push(this._getResultsFromSource(e,r,t)),Mr(n)}_getSuggestionsFromSources(e,t){const{allSources:i,activeSourceIndex:r}=this,n=[];if(!i.length){const o=new ue("suggest:no-sources-defined","At least one source is required.",{allSources:i});return Vp.error(o),Promise.reject(o)}return r===vb?i.forEach((o,c)=>{n.push(this._getSuggestionsFromSource(e,c,t))}):n.push(this._getSuggestionsFromSource(e,r,t)),Mr(n)}_getResultsFromSource(e,t,i){var b;const r=this.allSources.at(t),{location:n=null}=e,o=((b=this.view)==null?void 0:b.spatialReference)||aae,c=wo(r,"maxResults")?r.maxResults:this.maxResults,h=!!(r instanceof mb&&wo(r,"exactMatch"))&&r.exactMatch,{view:m}=this;return r.getResults({view:m,sourceIndex:t,location:n,suggestResult:e,spatialReference:o,exactMatch:h,maxResults:c},i)}_getSuggestionsFromSource(e,t,i){var h;const r=this.allSources.at(t),n=wo(r,"suggestionsEnabled")?r.suggestionsEnabled:this.suggestionsEnabled,o=e.length,c=wo(r,"minSuggestCharacters")?r.minSuggestCharacters:this.minSuggestCharacters;if(n&&e.trim()&&o>=c){const m=((h=this.view)==null?void 0:h.spatialReference)||aae,b=wo(r,"maxSuggestions")?r.maxSuggestions:this.maxSuggestions,{view:x}=this,I=!!(r instanceof mb&&wo(r,"exactMatch"))&&r.exactMatch;return r.getSuggestions({view:x,sourceIndex:t,suggestTerm:e,spatialReference:m,maxSuggestions:b,exactMatch:I},i)}return Promise.resolve(null)}_getLayerSourcePopupTemplate(e){const{layer:t}=e;if(t)return wo(e,"popupTemplate")?e.popupTemplate:t.popupTemplate}_getSourceIndexOfResult(e){const t=this.results;let i=null;return t.some(r=>r.results.some(n=>n===e&&(i=r.sourceIndex,!0))),i}async _goToSearchResult(e){const t=!!e;this._abortGoTo();const i=new AbortController;this._gotoController=i;const r={target:{target:e},options:{animate:t,signal:i.signal}};await this.callGoTo(r),this._gotoController=null}_getDefaultSymbol(e){var r;const{defaultSymbols:t}=this,i=(r=e.feature)==null?void 0:r.geometry;if(ce(i))return null;switch(i.type){case"point":case"multipoint":return t.point;case"polyline":return t.polyline;case"extent":case"polygon":return t.polygon;default:return null}}_removeHighlight(){this._handles.remove(oae)}async _getLayerView(e){const{view:t}=this;if(!e||!t||e.layer.type==="building-component"||e.layer.type==="subtype-sublayer")return null;const{layer:i}=e;return await t.when(),t.whenLayerView(i)}_highlightFeature(e){const{graphic:t,layerView:i}=e,{attributes:r,layer:n}=t,{objectIdField:o}=n,c=r&&r[o],h=i.highlight(c||t);this._handles.add(h,oae)}_setResultFloor(e){var n,o,c;const{view:t}=this,i=(n=e.feature)==null?void 0:n.attributes,r=(o=e.feature)==null?void 0:o.sourceLayer;if(r&&"floorInfo"in r&&((c=r==null?void 0:r.floorInfo)==null?void 0:c.floorField)&&i){const h=i[r.floorInfo.floorField];t==null||t.emit("select-result-floor",h)}}};hi.ALL_INDEX=vb,g([w()],hi.prototype,"_searching",void 0),g([w()],hi.prototype,"_updatingPromise",void 0),g([w({readOnly:!0,value:null})],hi.prototype,"activeSource",null),g([w()],hi.prototype,"activeSourceIndex",null),g([w()],hi.prototype,"allPlaceholder",null),g([w({readOnly:!0})],hi.prototype,"allSources",null),g([w()],hi.prototype,"autoNavigate",void 0),g([w()],hi.prototype,"autoSelect",void 0),g([w()],hi.prototype,"defaultPopupTemplate",void 0),g([w({readOnly:!0})],hi.prototype,"defaultSources",void 0),g([w()],hi.prototype,"defaultSymbols",void 0),g([w()],hi.prototype,"includeDefaultSources",void 0),g([w()],hi.prototype,"locationEnabled",null),g([w()],hi.prototype,"maxInputLength",void 0),g([w()],hi.prototype,"maxResults",void 0),g([w()],hi.prototype,"maxSuggestions",void 0),g([w()],hi.prototype,"messages",void 0),g([w()],hi.prototype,"minSuggestCharacters",void 0),g([w({readOnly:!0})],hi.prototype,"placeholder",null),g([w()],hi.prototype,"popupEnabled",void 0),g([w({type:_d})],hi.prototype,"popupTemplate",void 0),g([w({type:nn})],hi.prototype,"portal",void 0),g([w()],hi.prototype,"resultCount",void 0),g([w()],hi.prototype,"resultGraphicEnabled",void 0),g([w({readOnly:!0})],hi.prototype,"resultGraphic",void 0),g([w({readOnly:!0})],hi.prototype,"results",void 0),g([w({readOnly:!0})],hi.prototype,"selectedSuggestion",void 0),g([w()],hi.prototype,"searchAllEnabled",void 0),g([w({readOnly:!0})],hi.prototype,"selectedResult",void 0),g([w()],hi.prototype,"searchTerm",null),g([w({type:a$})],hi.prototype,"sources",void 0),g([w({readOnly:!0})],hi.prototype,"state",null),g([w()],hi.prototype,"suggestionDelay",void 0),g([w()],hi.prototype,"suggestionCount",void 0),g([w({readOnly:!0})],hi.prototype,"suggestions",void 0),g([w()],hi.prototype,"suggestionsEnabled",void 0),g([w({readOnly:!0})],hi.prototype,"updating",null),g([w()],hi.prototype,"view",void 0),g([w()],hi.prototype,"clear",null),hi=g([te(sae)],hi);const bb=hi,zp={base:"esri-search-result-renderer esri-widget",anchor:"esri-widget__anchor",showMoreResults:"esri-search-result-renderer__more-results--show-more-results",moreResults:"esri-search-result-renderer__more-results",moreResultsList:"esri-search-result-renderer__more-results-list",moreResultsHeader:"esri-search-result-renderer__more-results-header",moreResultsItem:"esri-search-result-renderer__more-results-item",moreResultsListHeader:"esri-search-result-renderer__more-results-list-header"};let Kf=class extends ki{constructor(e,t){super(e,t),this.messages=null,this.showMoreResultsOpen=!1,this.viewModel=null}render(){const e={[zp.showMoreResults]:this.showMoreResultsOpen};return j("div",{class:zp.base},j("div",{key:"esri-search-renderer__container",class:this.classes(zp.moreResults,e)},this.renderSearchResultName(),this.renderMoreResults()))}renderMoreResults(){return j("div",{key:"esri-search-renderer__more-results"},this.renderMoreResultsButton(),this.renderMoreResultsLists())}renderSearchResultName(){var i;const e=(i=this.viewModel)==null?void 0:i.selectedResult,t=e&&e.name||"";return j("div",{key:"esri-search-renderer__result-name",class:zp.moreResultsItem},t)}renderMoreResultsLists(){var r;const e=(r=this.viewModel)==null?void 0:r.results,{resultCount:t}=this.viewModel;if(t<2)return null;const i=e.map(n=>this.renderMoreResultsList(n));return j("div",{key:"esri-search-renderer__more-results-container",class:zp.moreResultsList},i)}renderMoreResultsButton(){const{messages:e}=this,{resultCount:t}=this.viewModel;return t<2?null:j("div",{key:"esri-search-renderer__more-results-button",class:zp.moreResultsItem},j("a",{class:zp.anchor,href:"#",bind:this,onclick:this._showMoreResultsClick,onkeydown:this._showMoreResultsClick},this.showMoreResultsOpen?e.hideMoreResults:e.showMoreResults))}renderMoreResultsHeader(e,t){return j("div",{key:`esri-search-result-renderer__header-${t}`,class:zp.moreResultsListHeader},e)}renderMoreResultsList(e){var x,I;const{results:t}=e,i=t.length,r=!!i,n=(x=this.viewModel)==null?void 0:x.selectedResult,o=i===1&&t[0]===n,c=this._getSourceName(e.source,e.sourceIndex),h=((I=this.viewModel)==null?void 0:I.results.length)>1&&!o?this.renderMoreResultsHeader(c,e.sourceIndex):null,m=r&&t.map((E,k)=>this.renderMoreResultsListItem(E,k)),b=r&&!o?j("ul",{key:`esri-search-result-renderer__list-${e.sourceIndex}`},m):null;return r?j("div",{key:`esri-search-result-renderer__results-${e.sourceIndex}`},h,b):null}renderMoreResultsListItem(e,t){return e!==this.get("viewModel.selectedResult")?j("li",{key:`esri-search-result-renderer__list-item-${t}`},j("a",{class:zp.anchor,href:"#",tabindex:"0",bind:this,"data-result":e,onclick:this._selectResultClick,onkeydown:this._selectResultClick},e.name)):null}_showMoreResultsClick(e){e.preventDefault(),this.showMoreResultsOpen=!this.showMoreResultsOpen;const t=this.get("viewModel.view.popup");t&&t.reposition()}_selectResultClick(e){e.preventDefault();const t=e.currentTarget["data-result"];this.viewModel&&this.viewModel.select(t)}_getSourceName(e,t){return t===bb.ALL_INDEX?this.messages.all:e.name}};g([w(),ci("esri/widgets/Search/t9n/Search")],Kf.prototype,"messages",void 0),g([w()],Kf.prototype,"showMoreResultsOpen",void 0),g([w()],Kf.prototype,"viewModel",void 0),g([Ki()],Kf.prototype,"_showMoreResultsClick",null),g([Ki()],Kf.prototype,"_selectResultClick",null),Kf=g([te("esri.widgets.Search.SearchResultRenderer")],Kf);const kGe=Kf,Ot={base:"esri-search esri-widget",loader:"esri-widget__loader",loaderText:"esri-widget__loader-text",loaderAnimation:"esri-widget__loader-animation",esriInput:"esri-input",hasMultipleSources:"esri-search--multiple-sources",isLoading:"esri-search--loading",isSearching:"esri-search--searching",showSuggestions:"esri-search--show-suggestions",showSources:"esri-search--sources",showWarning:"esri-search--warning",container:"esri-search__container",input:"esri-search__input",inputContainer:"esri-search__input-container",form:"esri-search__form",submitButton:"esri-search__submit-button",sourcesButton:"esri-search__sources-button",clearButton:"esri-search__clear-button",sourceName:"esri-search__source-name",suggestionsMenu:"esri-search__suggestions-menu",suggestionList:"esri-search__suggestions-list",suggestionListCurrentLocation:"esri-search__suggestions-list--current-location",sourcesMenu:"esri-search__sources-menu",source:"esri-search__source",warningMenu:"esri-search__warning-menu",warningMenuBody:"esri-search__warning-body",warningMenuHeader:"esri-search__warning-header",warningMenuText:"esri-search__warning-text",noValueText:"esri-search__no-value-text",esriWidgetDisabled:"esri-widget--disabled",button:"esri-widget--button",fallbackText:"esri-icon-font-fallback-text",header:"esri-widget__heading",locate:"esri-icon-locate-circled",menu:"esri-menu",menuList:"esri-menu__list",menuItem:"esri-menu__list-item",menuItemActive:"esri-menu__list-item--active",menuItemFocus:"esri-menu__list-item--focus",menuHeader:"esri-menu__header",loadingIcon:"esri-icon-loading-indicator esri-rotating",searchIcon:"esri-icon-search",dropdownIcon:"esri-icon-down-arrow esri-search__sources-button--down",dropupIcon:"esri-icon-up-arrow esri-search__sources-button--up",clearIcon:"esri-icon-close",noticeIcon:"esri-icon-notice-triangle",widgetIcon:"esri-icon-search",disabled:"esri-disabled"},AGe=/<[a-z/][\s\S]*>/i;let bi=class extends ki{constructor(e,t){super(e,t),this._activeMenuItemIndex=-1,this._handles=new Ti,this._inputNode=null,this._menuItemCount=0,this._sourceMenuButtonNode=null,this._sourceListNode=null,this._suggestionListNode=null,this._searchResultRenderer=new kGe,this._locateFailed=null,this._container=null,this.activeMenu="none",this.disabled=!1,this.iconClass=Ot.widgetIcon,this.messages=null,this.messagesCommon=null,this.viewModel=new bb,this._clearActiveMenu=()=>{this.activeMenu="none"},this._removeActiveMenu=i=>{var n;const r=i.relatedTarget;r&&((n=this._container)==null?void 0:n.contains(r))||this._clearActiveMenu()},this.addHandles([we(()=>this.searchTerm,i=>{(i&&this.activeMenu==="warning"||!i&&!this.get("viewModel.selectedSuggestion.location"))&&this._clearActiveMenu()}),vr(()=>{var i;return(i=this.viewModel)==null?void 0:i.allSources},"change",()=>this._watchSourceChanges()),we(()=>this.activeMenu,()=>this._resetActiveMenuItemIndex(),St),we(()=>{var i;return(i=this.viewModel)==null?void 0:i.defaultPopupTemplate},i=>{i&&(i.content=this._renderSearchResultsContent.bind(this))},St)])}destroy(){this._handles.destroy(),this._handles=null,this._cancelSuggest(),this._cancelSearch(),this._searchResultRenderer&&(this._searchResultRenderer.viewModel=null,this._searchResultRenderer.destroy(),this._searchResultRenderer=null)}get displayedSearchTerm(){return`${this.viewModel.searchTerm}`.trim()}get inputId(){return this._buildId("input")}get suggestionsMenuId(){return this._buildId("suggest-menu")}get sourceMenuId(){return this._buildId("source-menu")}get sourceMenuButtonId(){return this._buildId("source-menu-button")}get activeSource(){return this.viewModel.activeSource}get activeSourceIndex(){return this.viewModel.activeSourceIndex}set activeSourceIndex(e){this.viewModel.activeSourceIndex=e}get allPlaceholder(){return this.viewModel.allPlaceholder}set allPlaceholder(e){this.viewModel.allPlaceholder=e}get allSources(){return this.viewModel.allSources}get autoNavigate(){return this.viewModel.autoNavigate}set autoNavigate(e){this.viewModel.autoNavigate=e}get autoSelect(){return this.viewModel.autoSelect}set autoSelect(e){this.viewModel.autoSelect=e}get defaultSources(){return this.viewModel.defaultSources}get goToOverride(){return this.viewModel.goToOverride}set goToOverride(e){this.viewModel.goToOverride=e}get includeDefaultSources(){return this.viewModel.includeDefaultSources}set includeDefaultSources(e){this.viewModel.includeDefaultSources=e}get label(){var e,t;return(t=(e=this.messages)==null?void 0:e.widgetLabel)!=null?t:""}set label(e){this._overrideIfSome("label",e)}get locationEnabled(){return this.viewModel.locationEnabled}set locationEnabled(e){this.viewModel.locationEnabled=e}get maxResults(){return this.viewModel.maxResults}set maxResults(e){this.viewModel.maxResults=e}get maxSuggestions(){return this.viewModel.maxSuggestions}set maxSuggestions(e){this.viewModel.maxSuggestions=e}get minSuggestCharacters(){return this.viewModel.minSuggestCharacters}set minSuggestCharacters(e){this.viewModel.minSuggestCharacters=e}get popupEnabled(){return this.viewModel.popupEnabled}set popupEnabled(e){this.viewModel.popupEnabled=e}get popupTemplate(){return this.viewModel.popupTemplate}set popupTemplate(e){this.viewModel.popupTemplate=e}get portal(){return this.viewModel.portal}set portal(e){this.viewModel.portal=e}get resultGraphic(){return this.viewModel.resultGraphic}set resultGraphic(e){this.viewModel.resultGraphic=e}get resultGraphicEnabled(){return this.viewModel.resultGraphicEnabled}set resultGraphicEnabled(e){this.viewModel.resultGraphicEnabled=e}get results(){return this.viewModel.results}get searchAllEnabled(){return this.viewModel.searchAllEnabled}set searchAllEnabled(e){this.viewModel.searchAllEnabled=e}get searchTerm(){return this.viewModel.searchTerm}set searchTerm(e){this.viewModel.searchTerm=e}get selectedResult(){return this.viewModel.selectedResult}get sources(){return this.viewModel.sources}set sources(e){this.viewModel.sources=e}get suggestions(){return this.viewModel.suggestions}get suggestionsEnabled(){return this.viewModel.suggestionsEnabled}set suggestionsEnabled(e){this.viewModel.suggestionsEnabled=e}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}clear(){this.viewModel.clear()}focus(){var e;(e=this._inputNode)==null||e.focus(),this.emit("search-focus")}blur(){var e;(e=this._inputNode)==null||e.blur(),this.emit("search-blur")}search(e){this._clearActiveMenu(),this._cancelSuggest(),this._cancelSearch();const t=new AbortController,{signal:i}=t;return this._searchController=t,this.viewModel.search(e,{signal:i}).catch(r=>{if(this._searchController===t)return this._clearActiveMenu(),this._searchController=null,r}).then(r=>{if(this._searchController===t)return this.activeMenu=r.numResults?"none":"warning",this._searchController=null,r})}suggest(e){this._cancelSuggest();const t=new AbortController,{signal:i}=t;return this._suggestController=t,this.viewModel.suggest(e,null,{signal:i}).then(r=>{if(this._suggestController===t)return this._suggestController=null,r.numResults&&this._openSuggestionMenu(),this._scrollToTopSuggestion(),r}).catch(()=>{if(this._suggestController===t)return this._suggestController=null,null})}render(){const{state:e}=this.viewModel,t={[Ot.disabled]:e==="disabled",[Ot.esriWidgetDisabled]:this.disabled};return j("div",{class:this.classes(Ot.base,t)},e==="loading"?this.renderLoader():this.renderContainer())}renderSubmitButton(){const{messages:e,disabled:t}=this;return j("button",{"aria-label":e.searchButtonTitle,bind:this,disabled:t,class:this.classes(Ot.submitButton,Ot.button),key:"esri-search__submit-button",onclick:this._handleSearchButtonClick,title:e.searchButtonTitle,type:"button"},j("span",{"aria-hidden":"true",class:Ot.searchIcon}))}renderWarningMenu(){return j("div",{key:"esri-search__error-menu",class:this.classes(Ot.menu,Ot.warningMenu)},j("div",{class:Ot.warningMenuBody},this.renderWarning()))}renderSourceMenuButton(){const{messages:e,activeMenu:t,sourceMenuId:i,sourceMenuButtonId:r,disabled:n}=this,{activeSourceIndex:o,allSources:c}=this.viewModel;return c.length>1?j("button",{id:r,key:"esri-search__source-menu-button",bind:this,disabled:n,"aria-label":e.searchIn,title:e.searchIn,"aria-haspopup":"true","aria-expanded":(t==="source").toString(),"aria-controls":i,class:this.classes(Ot.sourcesButton,Ot.button),onclick:this._handleSourcesMenuToggleClick,onfocus:this._handleSourcesMenuToggleFocus,afterCreate:Fh,"data-node-ref":"_sourceMenuButtonNode",type:"button"},j("span",{"aria-hidden":"true",class:Ot.dropdownIcon}),j("span",{"aria-hidden":"true",class:Ot.dropupIcon}),j("span",{class:Ot.sourceName},this._getSourceName(o))):null}renderSourcesList(){const{allSources:e,searchAllEnabled:t}=this.viewModel,{_activeMenuItemIndex:i,activeMenu:r,sourceMenuId:n,sourceMenuButtonId:o}=this,c=r==="source"&&i>-1?this._buildId("source-item",i):null;return e.length>1?j("ul",{"aria-activedescendant":c,"aria-labelledby":o,id:n,role:"menu",bind:this,afterCreate:Fh,onkeydown:this._handleSourceMenuKeydown,onkeyup:this._handleSourceMenuKeyup,"data-node-ref":"_sourceListNode",class:Ot.menuList,tabIndex:-1},t?this.renderSource(bb.ALL_INDEX):null,e.map((h,m)=>this.renderSource(m)).toArray()):null}renderSourcesMenu(){const{allSources:e}=this.viewModel;return e.length>1?j("div",{key:"esri-search__source-menu",class:this.classes(Ot.menu,Ot.sourcesMenu)},this.renderSourcesList()):null}renderLoader(){const{messages:e,messagesCommon:t,disabled:i}=this;return j("div",{class:Ot.loader,key:"base-loader",tabIndex:i?-1:null},j("span",{"aria-hidden":"true",class:Ot.loaderAnimation}),j("span",{class:Ot.fallbackText},e.searchButtonTitle),j("span",{class:Ot.loaderText},t.loading))}renderContainer(){const{allSources:e,state:t}=this.viewModel,{activeMenu:i}=this,r={[Ot.hasMultipleSources]:e.length>1,[Ot.isLoading]:t==="loading",[Ot.isSearching]:t==="searching",[Ot.showWarning]:i==="warning",[Ot.showSources]:i==="source",[Ot.showSuggestions]:i==="suggestion"};return j("div",{tabIndex:-1,afterCreate:n=>{this._container=n,n.addEventListener("focusout",this._removeActiveMenu)},afterRemoved:n=>{n.removeEventListener("focusout",this._removeActiveMenu)},class:this.classes(r,Ot.container),key:"base-container"},this.renderSourceMenuButton(),this.renderSourcesMenu(),this.renderInputContainer(),this.renderSubmitButton(),this.renderWarningMenu())}renderClearButton(){return this.searchTerm?j("button",{bind:this,disabled:this.disabled,class:this.classes(Ot.clearButton,Ot.button),key:"esri-search__clear-button",onclick:this._handleClearButtonClick,onfocus:this._clearActiveMenu,title:this.messages.clearButtonTitle,type:"button"},j("span",{"aria-hidden":"true",class:Ot.clearIcon})):null}renderLocationGroup(){const{messages:e,locationEnabled:t,displayedSearchTerm:i}=this,r=t&&!i,n=this.activeMenu==="suggestion"&&this._activeMenuItemIndex===0;return r?j("ul",{role:"group",key:"esri-search__suggestion-list-current-location",class:this.classes(Ot.menuList,Ot.suggestionList,Ot.suggestionListCurrentLocation)},j("li",{bind:this,"data-current-location-item":!0,onclick:this._handleUseCurrentLocationClick,id:this._buildId("suggestion-item",0),"aria-selected":(this.activeMenu==="suggestion"&&this._activeMenuItemIndex===0).toString(),role:"option",class:this.classes(Ot.menuItem,n?Ot.menuItemFocus:null)},j("span",{"aria-hidden":"true",class:Ot.locate})," ",e.useCurrentLocation)):null}renderInput(){const{activeMenu:e,locationEnabled:t,displayedSearchTerm:i,messages:r,suggestionsMenuId:n,inputId:o,_activeMenuItemIndex:c,disabled:h}=this,{maxInputLength:m,placeholder:b,searchTerm:x,suggestionCount:I}=this.viewModel,E=!(!(t&&!i)&&!I),k=e==="suggestion"&&c>-1?this._buildId("suggestion-item",c):null;return j("input",{"aria-activedescendant":k,"aria-autocomplete":"list","aria-expanded":(E&&e==="suggestion").toString(),"aria-controls":E?n:null,"aria-haspopup":"listbox","aria-label":r.searchButtonTitle,bind:this,disabled:h,placeholder:b,maxlength:m,autocomplete:"off",type:"text",class:this.classes(Ot.esriInput,Ot.input),value:x,id:o,role:"combobox",onkeyup:this._handleInputKeyup,onclick:this._openSuggestionMenu,oninput:this._handleInputPaste,onpaste:this._handleInputPaste,afterCreate:Fh,"data-node-ref":"_inputNode",onfocus:this.focus,onblur:this.blur,title:x?"":b})}renderForm(){return j("form",{key:"esri-search__form",bind:this,disabled:this.disabled,class:Ot.form,onsubmit:this._formSubmit,role:"search"},this.renderInput())}renderSuggestList(e){const{sourceIndex:t}=e,i=e.results.length,r=e.results;return i?j("ul",{role:"group",key:`esri-search__suggestion-list-${t}`,class:this.classes(Ot.menuList,Ot.suggestionList)},r.map(n=>this.renderSuggestion(n,this._menuItemCount++))):null}renderSuggestionsGroup(){const{suggestions:e}=this.viewModel;return e?e.map(t=>[this.renderSuggestionHeader(t),this.renderSuggestList(t)]):null}renderSuggestionsMenu(){const{displayedSearchTerm:e,locationEnabled:t,suggestionsMenuId:i,inputId:r}=this,{suggestionCount:n}=this.viewModel,o=t&&!e||n;return this._menuItemCount=0,o?j("div",{id:i,key:"esri-search__suggestions-menu",class:this.classes(Ot.menu,Ot.suggestionsMenu),role:"listbox","aria-labelledby":r,bind:this,afterCreate:Fh,"data-node-ref":"_suggestionListNode"},this.renderLocationGroup(),this.renderSuggestionsGroup()):null}renderInputContainer(){return j("div",{key:"esri-search__input-container",class:Ot.inputContainer},this.renderForm(),this.renderSuggestionsMenu(),this.renderClearButton())}renderSuggestionHeader(e){const{allSources:t,activeSourceIndex:i}=this.viewModel,{sourceIndex:r}=e,n=e.results.length,o=t.length>1&&i===bb.ALL_INDEX;return n&&o?j("div",{key:`esri-search__suggestion-header-${r}`,class:Ot.menuHeader},this._getSourceName(r)):null}renderSuggestion(e,t){const{_activeMenuItemIndex:i,messages:r}=this,{searchTerm:n}=this.viewModel;if(n){const{text:o}=e,c=o||r.untitledResult,h=AGe.test(c),m=[];if(h)m.push(j("div",{innerHTML:c}));else{const x=this._splitResult(c,n),I=n.toLowerCase();x.forEach((E,k)=>{E&&E.length&&(E.toLowerCase()===I?m.push(j("strong",{key:k},E)):m.push(E))})}const b=this.activeMenu==="suggestion"&&i===t;return j("li",{bind:this,id:this._buildId("suggestion-item",t),"aria-selected":(this.activeMenu==="suggestion"&&this._activeMenuItemIndex===t).toString(),onclick:this._handleSuggestionClick,key:`esri-search__suggestion_${t}`,"data-suggestion":e,role:"option",class:this.classes(Ot.menuItem,b?Ot.menuItemFocus:null)},m)}}renderSource(e){const{activeSourceIndex:t,searchAllEnabled:i}=this.viewModel,r={[Ot.menuItemActive]:e===t,[Ot.menuItemFocus]:this.activeMenu==="source"&&e===(i?this._activeMenuItemIndex-1:this._activeMenuItemIndex)},n=i?e+1:e;return j("li",{bind:this,key:`esri-search__source-${e}`,id:this._buildId("source-item",n),"aria-checked":(e===t).toString(),onclick:this._handleSourceClick,"data-source-index":e,role:"menuitemradio",class:this.classes(Ot.source,Ot.menuItem,r)},this._getSourceName(e))}renderNoResultsWarning(e){const{messages:t}=this,i=e?oo(t.noResultsFoundForValue,{value:`"${e}"`}):t.noResultsFound;return j("div",{key:"esri-search__no_results"},j("div",{class:Ot.warningMenuHeader},t.noResults),j("div",{class:Ot.warningMenuText},i))}renderEmptySearchWarning(){const{messages:e}=this;return j("div",{key:"esri-search__empty-search"},j("span",{"aria-hidden":"true",class:Ot.noticeIcon}),j("span",{class:Ot.noValueText},e.emptyValue))}renderLocateWarning(){const{messages:e}=this;return j("div",{key:"esri-search__locate-error"},j("span",{"aria-hidden":"true",class:Ot.noticeIcon}),j("span",{class:Ot.noValueText},e.locateError))}renderWarning(){var r;const{displayedSearchTerm:e,_locateFailed:t}=this,{viewModel:i}=this;return t?this.renderLocateWarning():((r=i.selectedSuggestion)==null?void 0:r.location)||e?this.renderNoResultsWarning(e):this.renderEmptySearchWarning()}_resetActiveMenuItemIndex(){this._activeMenuItemIndex=-1}_buildId(e,t){return`${this.id}-${e}${t===void 0?"":`-${t}`}`}_watchSourceChanges(){const{_handles:e,viewModel:{allSources:t}}=this,i="sources";e.remove(i),t.forEach(r=>e.add(we(()=>r.name,()=>this.scheduleRender()),i))}_handleSourcesMenuToggleFocus(){this.activeMenu!=="source"&&this._clearActiveMenu()}_handleSourcesMenuToggleClick(){var t;const e=this.activeMenu==="source";this.activeMenu=e?"none":"source",this.renderNow(),this.activeMenu==="source"&&((t=this._sourceListNode)==null||t.focus())}_handleClearButtonClick(){this.viewModel.clear(),this._focus()}_handleSearchButtonClick(){this.search()}_handleSuggestionClick(e){const t=e.currentTarget["data-suggestion"];t&&(this._focus(),this.search(t))}_handleUseCurrentLocationClick(){this._useCurrentLocation()}_useCurrentLocation(){this._focus("none"),this._cancelSuggest(),this._cancelSearch();const e=new AbortController,{signal:t}=e;this._searchController=e,this.viewModel.searchNearby({signal:t}).then(i=>{this.activeMenu=i.numResults?"none":"warning"}).catch(()=>{this._locateFailed=!0,this.activeMenu="warning"}).then(()=>{this._searchController=null})}_handleSourceClick(e){this._setSourceFromMenuItem(e.currentTarget)}_setSourceFromMenuItem(e){var i;if(!e)return;const t=e["data-source-index"];this.viewModel.activeSourceIndex=t,this._clearActiveMenu(),(i=this._sourceMenuButtonNode)==null||i.focus()}_cancelSuggest(){this._suggestController&&(this._suggestController.abort(),this._suggestController=null)}_cancelSearch(){this._searchController&&(this._searchController.abort(),this._searchController=null),this._locateFailed=!1}_handleInputKeyup(e){var n;const t=to(e);if(e.ctrlKey||e.metaKey||t==="Copy"||t==="ArrowLeft"||t==="ArrowRight"||t==="Shift")return;if(t==="Tab"||t==="Escape"||e.shiftKey&&t==="Tab")return this._cancelSuggest(),void(t==="Escape"&&this._clearActiveMenu());const i=t==="Home"||t==="End"||t==="ArrowUp"||t==="ArrowDown";if(t==="Enter"&&this._activeMenuItemIndex<0)return void this._cancelSuggest();const r=(n=this._suggestionListNode)==null?void 0:n.getElementsByTagName("li");if(r==null?void 0:r.length){if(this.activeMenu!=="suggestion"&&this._openSuggestionMenu(),i)return e.preventDefault(),this._cancelSuggest(),void this._handleItemNavigation(t,r,this._suggestionListNode);const o=r[this._activeMenuItemIndex];if(t==="Enter"&&o){const c=o["data-suggestion"];return void(c?(this._focus(),this.search(c)):o["data-current-location-item"]&&this._useCurrentLocation())}}this.viewModel.searchTerm&&this.suggest()}_handleItemNavigation(e,t,i){const r=this._activeMenuItemIndex;e==="Home"&&(this._activeMenuItemIndex=0),e==="End"&&(this._activeMenuItemIndex=t.length-1),e==="ArrowUp"&&(this._activeMenuItemIndex=this._activeMenuItemIndex<=0?t.length-1:this._activeMenuItemIndex-1),e==="ArrowDown"&&(this._activeMenuItemIndex=this._activeMenuItemIndex===t.length-1?0:this._activeMenuItemIndex+1),r!==this._activeMenuItemIndex&&Zq(t[this._activeMenuItemIndex],i)}_scrollToTopSuggestion(){this._suggestionListNode&&(this._suggestionListNode.scrollTop=0)}_openSuggestionMenu(){this.activeMenu="suggestion"}_handleInputPaste(e){const t=e.target;this.viewModel.searchTerm!==t.value&&(this.viewModel.searchTerm=t.value),this.viewModel.searchTerm&&this.suggest()}_handleSourceMenuKeydown(e){const t=to(e);if(Hg(t)){e.preventDefault();const i=this._sourceListNode.getElementsByTagName("li")[this._activeMenuItemIndex];this._setSourceFromMenuItem(i)}else t!=="ArrowUp"&&t!=="ArrowDown"&&t!=="End"&&t!=="Home"||e.preventDefault()}_handleSourceMenuKeyup(e){var n,o;const t=to(e),i=t==="ArrowUp"||t==="ArrowDown"||t==="End"||t==="Home";if(i&&e.preventDefault(),t==="Escape")return this._clearActiveMenu(),void((n=this._sourceMenuButtonNode)==null?void 0:n.focus());const r=(o=this._sourceListNode)==null?void 0:o.getElementsByTagName("li");return r&&r.length!==0&&i?(this.activeMenu!=="source"&&(this.activeMenu="source"),void this._handleItemNavigation(t,r,this._sourceListNode.parentElement)):void 0}_focus(e){this.focus(),e&&(this.activeMenu=e)}_formSubmit(e){e.preventDefault(),this._activeMenuItemIndex===-1&&this.search()}_getSourceName(e){const{messages:t}=this,i=this.viewModel,{allSources:r}=i,n=r.getItemAt(e);return e===bb.ALL_INDEX?t.all:n&&n.name||t.untitledSource}_splitResult(e,t){const i=tS(t);return e.replace(new RegExp(`(^|)(${i})(|$)`,"ig"),"$1|$2|$3").split("|")}_renderSearchResultsContent(){return this._searchResultRenderer.showMoreResultsOpen=!1,this._searchResultRenderer.viewModel=this.viewModel,this._searchResultRenderer}};g([w()],bi.prototype,"_activeMenuItemIndex",void 0),g([w()],bi.prototype,"displayedSearchTerm",null),g([w({readOnly:!0})],bi.prototype,"inputId",null),g([w({readOnly:!0})],bi.prototype,"suggestionsMenuId",null),g([w({readOnly:!0})],bi.prototype,"sourceMenuId",null),g([w({readOnly:!0})],bi.prototype,"sourceMenuButtonId",null),g([w()],bi.prototype,"activeMenu",void 0),g([w({readOnly:!0})],bi.prototype,"activeSource",null),g([w()],bi.prototype,"activeSourceIndex",null),g([w()],bi.prototype,"allPlaceholder",null),g([w({readOnly:!0})],bi.prototype,"allSources",null),g([w()],bi.prototype,"autoNavigate",null),g([w()],bi.prototype,"autoSelect",null),g([w({readOnly:!0})],bi.prototype,"defaultSources",null),g([w()],bi.prototype,"disabled",void 0),g([w()],bi.prototype,"goToOverride",null),g([w()],bi.prototype,"iconClass",void 0),g([w()],bi.prototype,"includeDefaultSources",null),g([w()],bi.prototype,"label",null),g([w()],bi.prototype,"locationEnabled",null),g([w()],bi.prototype,"maxResults",null),g([w()],bi.prototype,"maxSuggestions",null),g([w(),ci("esri/widgets/Search/t9n/Search")],bi.prototype,"messages",void 0),g([w(),ci("esri/t9n/common")],bi.prototype,"messagesCommon",void 0),g([w()],bi.prototype,"minSuggestCharacters",null),g([w()],bi.prototype,"popupEnabled",null),g([w()],bi.prototype,"popupTemplate",null),g([w()],bi.prototype,"portal",null),g([w()],bi.prototype,"resultGraphic",null),g([w()],bi.prototype,"resultGraphicEnabled",null),g([w({readOnly:!0})],bi.prototype,"results",null),g([w()],bi.prototype,"searchAllEnabled",null),g([w()],bi.prototype,"searchTerm",null),g([w({readOnly:!0})],bi.prototype,"selectedResult",null),g([w()],bi.prototype,"sources",null),g([w({readOnly:!0})],bi.prototype,"suggestions",null),g([w()],bi.prototype,"suggestionsEnabled",null),g([w()],bi.prototype,"view",null),g([n1(["search-complete","search-clear","search-start","select-result","suggest-start","suggest-complete"]),w({type:bb})],bi.prototype,"viewModel",void 0),bi=g([te("esri.widgets.Search")],bi);let Gp=class extends Z1(Or.EventedAccessor){constructor(e){super(e),this._initialViewpoint=null,this._goingHomeController=null,this.go=this.go.bind(this)}destroy(){this._cancelGo(),this.view=null}get state(){return this.get("view.ready")?this._goingHomeController?"going-home":"ready":"disabled"}set view(e){this._initialViewpoint=null,this._set("view",e),e&&e.when().then(()=>{this.view===e&&(this._initialViewpoint=e.viewpoint.clone(),this.notifyChange("viewpoint"))})}get viewpoint(){return this._get("viewpoint")||this._initialViewpoint}set viewpoint(e){this._set("viewpoint",e)}async go(){if(!this.get("view.ready"))throw new ue("home:disabled-state","Cannot go when disabled.");this._cancelGo(),this.emit("go");const e=new AbortController;this._goingHomeController=e;try{await this.view.when(),await this.callGoTo({target:this.viewpoint,options:{signal:e.signal}})}catch{}this._goingHomeController=null}cancelGo(){this._cancelGo()}_cancelGo(){const{_goingHomeController:e}=this;e&&e.abort(),this._goingHomeController=null}};g([w()],Gp.prototype,"_goingHomeController",void 0),g([w({readOnly:!0})],Gp.prototype,"state",null),g([w()],Gp.prototype,"view",null),g([w({type:ra})],Gp.prototype,"viewpoint",null),g([w()],Gp.prototype,"go",null),g([w()],Gp.prototype,"cancelGo",null),Gp=g([te("esri.widgets.Home.HomeViewModel")],Gp);const lae=Gp,wb={base:"esri-home esri-widget--button esri-widget",esriIcon:"esri-icon",loadingIcon:"esri-icon-loading-indicator",rotatingIcon:"esri-rotating",widgetIcon:"esri-icon-home",disabled:"esri-disabled"};let Bl=class extends ki{constructor(e,t){super(e,t),this.iconClass=wb.widgetIcon,this.messages=null,this.messagesCommon=null,this.viewModel=new lae}get goToOverride(){return this.viewModel.goToOverride}set goToOverride(e){this.viewModel.goToOverride=e}get label(){var e,t;return(t=(e=this.messages)==null?void 0:e.widgetLabel)!=null?t:""}set label(e){this._overrideIfSome("label",e)}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}get viewpoint(){return this.viewModel.viewpoint}set viewpoint(e){this.viewModel.viewpoint=e}cancelGo(){this.viewModel.cancelGo()}go(){return this.viewModel.go()}render(){var n;const e=(n=this.viewModel)==null?void 0:n.state,{messagesCommon:t,messages:i}=this,r={[wb.disabled]:e==="disabled"};return j("div",{bind:this,class:this.classes(wb.base,r),role:"button",tabIndex:0,onclick:this._go,onkeydown:this._go,"aria-label":i.widgetLabel,title:e==="going-home"?t.cancel:i.title},this.renderIcon())}renderIcon(){var i;const e=(i=this.viewModel)==null?void 0:i.state,t={[wb.esriIcon]:!0,[this.iconClass]:e!=="going-home",[wb.loadingIcon]:e==="going-home",[wb.rotatingIcon]:e==="going-home"};return j("span",{"aria-hidden":"true",class:this.classes(t)})}_go(){const{viewModel:e}=this;e.state==="going-home"?e.cancelGo():e.go()}};g([w()],Bl.prototype,"goToOverride",null),g([w()],Bl.prototype,"iconClass",void 0),g([w()],Bl.prototype,"label",null),g([w(),ci("esri/widgets/Home/t9n/Home")],Bl.prototype,"messages",void 0),g([w(),ci("esri/t9n/common")],Bl.prototype,"messagesCommon",void 0),g([w()],Bl.prototype,"uiStrings",void 0),g([w()],Bl.prototype,"view",null),g([w({type:lae}),n1("go")],Bl.prototype,"viewModel",void 0),g([w()],Bl.prototype,"viewpoint",null),g([Ki()],Bl.prototype,"_go",null),Bl=g([te("esri.widgets.Home")],Bl);async function PGe(){return import("./geometryEngineJSON.7fc72f00.js")}async function LGe(){return PGe().then(({contains:e,intersects:t,overlaps:i,simplify:r})=>({contains:e,intersects:t,overlaps:i,simplify:r}))}async function cae(e){const{selector:t,candidates:i,currentSelection:r,options:n,view:o}=e;if(!(i&&i.length&&r&&o))return{added:[],removed:[]};const{overlaps:c,intersects:h,contains:m}=n,{spatialReference:b}=o;if(!t)return{added:[],removed:r.removeAll()};const x=t,I=await LGe(),E=[],k=[];return i.forEach(P=>{const F=P.geometry,N=c&&!!I.overlaps(b,x,F),B=h&&!!I.intersects(b,x,F),z=m&&!!I.contains(b,x,F),q=r.includes(P);N||B||z?!q&&E.push(P):q&&k.push(P)}),r.removeMany(k),r.addMany(E),{added:E,removed:k}}let Xu=class extends Or.EventedAccessor{constructor({candidates:e,options:t,view:i}){super(),this._activeOptions=null,this._dashedFillSymbol=new ea({color:[0,0,0,0],outline:{style:"dash",color:[12,207,255],width:2}}),this._dashedLineSymbol=new rs({style:"dash",color:[12,207,255],width:2}),this._defaultOptions={createTool:"rectangle",createOptions:null,selectionOptions:{overlaps:!0,intersects:!0,contains:!1}},this._completed=!1,this._handles=new Ti,this._sketchViewModel=new hne,this._sketchGraphicsLayer=new RL({listMode:"hide",internal:!0}),this._transparentPointSymbol=new Dn({color:[0,0,0,0],outline:{style:"none",width:0}}),this.candidates=null,this.geometry=null,this.options=null,this.selection=new Xe,this.view=null,this.candidates=e,this.options=t,this.view=i;const{_dashedFillSymbol:r,_dashedLineSymbol:n,_sketchViewModel:o,_sketchGraphicsLayer:c,_transparentPointSymbol:h}=this;o.set({layer:c,view:this.view,activePointSymbol:h,activeLineSymbol:n,activeVertexSymbol:h,activeFillSymbol:r,pointSymbol:h,polygonSymbol:r,polylineSymbol:n,vertexSymbol:h}),this._handles.add([o.on("create",m=>this._onSketchEvent(m)),o.on(["undo","redo"],m=>this._onSketchEvent(m))])}initialize(){this._load()}destroy(){this._handles.destroy(),this._handles=null}get state(){const{_completed:e,_sketchViewModel:{state:t}}=this;return e?"complete":t==="active"?"active":"disabled"}cancel(){return this._sketchViewModel.cancel()}async _load(){await this.view.whenReady();const{options:e}=this,{createTool:t,createOptions:i}=this._activeOptions=K(K({},this._defaultOptions),e);this._sketchViewModel.create(t,i)}_onSketchEvent(e){var n;const t=((n=e.type==="create"?e.graphic:e.graphics[0])==null?void 0:n.geometry)||null,i=e.type==="create"&&e.state==="cancel",r=e.type==="create"&&e.state==="complete";this._processSelectionGeometry(t,r,i)}_processSelectionGeometry(e,t,i){if(this._set("geometry",e),(t||i)&&(this._completed=!0),i)return void this._onComplete([],!0);const{_activeOptions:r,candidates:n,selection:o,view:c}=this;cae({selector:e,candidates:n,currentSelection:o,options:r.selectionOptions,view:c}).then(({added:h,removed:m})=>{t?this._onComplete(this.selection.toArray(),!1):(h.length||m.length)&&this.emit("selection-change",{added:h,removed:m,type:"selection-change"})})}_onComplete(e,t){this._handles.removeAll(),this.notifyChange("state"),this.emit("complete",{aborted:t,selection:e,type:"complete"})}};g([w()],Xu.prototype,"_completed",void 0),g([w()],Xu.prototype,"candidates",void 0),g([w({readOnly:!0})],Xu.prototype,"geometry",void 0),g([w()],Xu.prototype,"options",void 0),g([w({readOnly:!0})],Xu.prototype,"selection",void 0),g([w({readOnly:!0})],Xu.prototype,"state",null),g([w({value:null})],Xu.prototype,"view",void 0),Xu=g([te("esri.widgets.support.Selector2D.SelectionOperation2D")],Xu);const OGe=Xu;let _b=class extends ls(Ye){constructor(e){super(e),this._defaultSelectionOptions={intersects:!0,overlaps:!0,contains:!0},this.candidates=null,this.options=null,this.view=null}draw(e){const{_defaultSelectionOptions:t,candidates:i,options:r,view:n}=this,o=K(K(K({},t),r),e==null?void 0:e.selectionOptions);return new OGe({candidates:i,options:Ce(K({},e),{selectionOptions:o}),view:n})}async selectionFrom(e,t){const{_defaultSelectionOptions:i,candidates:r,options:n,view:o}=this,c=new Xe,h=K(K(K({},i),n),t);return await cae({selector:e,candidates:r,currentSelection:c,options:h,view:o}),c.toArray()}};g([w()],_b.prototype,"candidates",void 0),g([w()],_b.prototype,"options",void 0),g([w({value:null})],_b.prototype,"view",void 0),_b=g([te("esri.widgets.support.Selector2D")],_b);const RGe=_b;let Yf=class extends Or.EventedAccessor{constructor(e){super(e),this._operationHandlesGroup=null,this.activeOperation=null,this.layers=null,this.selector=new RGe}destroy(){this._operationHandlesGroup=mr(this._operationHandlesGroup),this.selector.destroy()}get state(){var e,t;return this.activeOperation?"active":((e=this.view)==null?void 0:e.ready)&&((t=this.layers)==null?void 0:t.length)?"ready":"disabled"}set view(e){this.selector.view=e,this._set("view",e)}cancel(){this.state==="active"&&(this.activeOperation.cancel(),this.activeOperation=null),this.selector.candidates=null}activate(e){const{state:t}=this;if(t==="disabled")return;t==="active"&&this.cancel(),this.selector.candidates=this._getCandidates();const i=this.selector.draw(e);return this._operationHandlesGroup=od([i.once("complete",r=>this._onOperationComplete(r)),i.on("selection-change",r=>this._onOperationSelectionChange(r))]),this.activeOperation=i,i}_getCandidates(){let e=[];return this.layers.forEach(t=>{e=e.concat(...t.graphics.toArray())}),e}_onOperationSelectionChange(e){this.emit("selection-change",e)}_onOperationComplete(e){this._operationHandlesGroup=mr(this._operationHandlesGroup),this.activeOperation=null,this.emit("complete",e)}};g([w()],Yf.prototype,"activeOperation",void 0),g([w()],Yf.prototype,"layers",void 0),g([w({readOnly:!0})],Yf.prototype,"selector",void 0),g([w({readOnly:!0})],Yf.prototype,"state",null),g([w()],Yf.prototype,"view",null),Yf=g([te("esri.widgets.support.SelectionToolbar.SelectionToolbarViewModel")],Yf);const FGe=Yf,uae={lassoTool:!0,rectangleTool:!0},NGe={createTool:"polygon",createOptions:{mode:"freehand"}},DGe={createTool:"rectangle"},l$={base:"esri-selection-toolbar",container:"esri-selection-toolbar__container",toolButton:"esri-selection-toolbar__tool-button",disabled:"esri-disabled",esriWidget:"esri-widget",widgetIcon:"esri-icon-vertex-gps"};let Ul=class extends ki{constructor(e,t){super(e,t),this._viewModelHandlesGroup=null,this.activeToolInfo=null,this.messages=null,this.toolConfigs=[],this.viewModel=new FGe,this.visibleElements=K({},uae),this._viewModelHandlesGroup=od([this.viewModel.on("selection-change",i=>this.emit("selection-change",i)),this.viewModel.on("complete",i=>{this._set("activeToolInfo",null),this.emit("complete",i)})])}destroy(){this._viewModelHandlesGroup=mr(this._viewModelHandlesGroup)}loadDependencies(){return Promise.all([import("./calcite-action.fe807edf.js"),import("./calcite-icon.3e014da3.js")])}get label(){var e,t;return(t=(e=this.messages)==null?void 0:e.widgetLabel)!=null?t:""}set label(e){this._overrideIfSome("label",e)}get layers(){return this.viewModel.layers}set layers(e){this.viewModel.layers=e}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}castVisibleElements(e){return K(K({},uae),e)}activate(e){switch(this.cancel(),e){case"lasso":this._activateTool("lasso");case"rectangle":this._activateTool("rectangle");default:this._activateTool(e)}}cancel(){this.viewModel.cancel(),this._set("activeToolInfo",null)}render(){return j("div",{"aria-label":this.label,class:this.classes(l$.base,l$.esriWidget)},j("div",{class:l$.container},this.renderDefaultTools(),this.renderCustomTools()))}renderDefaultTools(){var e;if(((e=this.view)==null?void 0:e.type)==="2d")return[this.renderRectangleTool(),this.renderLassoTool()]}renderCustomTools(){if(this.toolConfigs&&this.toolConfigs.length)return this.toolConfigs.map(e=>{var t;return j("calcite-action",{active:((t=this.activeToolInfo)==null?void 0:t.toolName)===e.toolName,bind:this,class:l$.toolButton,label:e.toolName,onclick:()=>this._onCustomToolClick(e.toolName),scale:"s",text:e.toolName,title:e.toolName},j("calcite-icon",{scale:"s",icon:e.icon||"selection"}))})}renderLassoTool(){const{activeToolInfo:e,messages:t,visibleElements:i}=this;if(i.lassoTool)return j("calcite-action",{active:(e==null?void 0:e.toolName)==="lasso",bind:this,label:t.selectByLasso,onclick:this._onLassoToolClick,scale:"s",text:t.selectByLasso,title:t.selectByLasso},j("calcite-icon",{scale:"s",icon:"lasso"}))}renderRectangleTool(){const{activeToolInfo:e,messages:t,visibleElements:i}=this;if(i.rectangleTool)return j("calcite-action",{active:(e==null?void 0:e.toolName)==="rectangle",bind:this,label:t.selectByRectangle,onclick:this._onRectangleToolClick,scale:"s",text:t.selectByRectangle,title:t.selectByRectangle},j("calcite-icon",{scale:"s",icon:"cursor-marquee"}))}_onCustomToolClick(e){this._toggleTool(e)}_onLassoToolClick(){this._toggleTool("lasso")}_onRectangleToolClick(){this._toggleTool("rectangle")}_activateTool(e){const t=this._getToolOptions(e);if(!t)return;const i=this.viewModel.activate(t);this._set("activeToolInfo",{toolName:e,operation:i})}_toggleTool(e){if(this.activeToolInfo){const t=this.activeToolInfo.toolName;if(this.cancel(),t===e)return}this._activateTool(e)}_getToolOptions(e){if(e==="lasso")return NGe;if(e==="rectangle")return DGe;const t=this.toolConfigs.find(o=>o.toolName===e);if(!t)return;const{createTool:i,createOptions:r,selectionOptions:n}=t;return{createTool:i,createOptions:r,selectionOptions:n}}};g([w({readOnly:!0})],Ul.prototype,"activeToolInfo",void 0),g([w()],Ul.prototype,"label",null),g([w()],Ul.prototype,"layers",null),g([w(),ci("esri/widgets/support/SelectionToolbar/t9n/SelectionToolbar")],Ul.prototype,"messages",void 0),g([w()],Ul.prototype,"toolConfigs",void 0),g([w()],Ul.prototype,"view",null),g([w()],Ul.prototype,"viewModel",void 0),g([w()],Ul.prototype,"visibleElements",void 0),g([Dt("visibleElements")],Ul.prototype,"castVisibleElements",null),Ul=g([te("esri.widgets.support.SelectionToolbar")],Ul);const jGe=Ul,rF=e=>VGe(e)||zGe(e),VGe=e=>{if(!("type"in e))return!1;switch(e.type){case"feature":case"geojson":case"csv":case"graphics":case"wfs":case"map-notes":case"oriented-imagery":case"scene":case"building-scene":return!0;default:return!1}},zGe=e=>{const t=zR(e);if(e.hasOwnProperty(t)&&H(e[t])){for(const i of e[t])if(rF(i))return!0}return!1};var nF;let Xf=nF=class extends t${constructor(e){super(e),this.children=new Xe}get enabled(){return!!H(this.featureSource)&&this.featureSource.enabled}get featureSource(){const{layer:e,getFeatureSnappingSources:t}=this;return t().find(i=>i.layer===e)}_initializeChildLayers(e){if(!e)return;const t=e.filter(rF);super._initializeChildLayers(t)}_makeChildren(e){return e.map(t=>GR(t)?new nF({layer:t,parent:this,view:this.view,getFeatureSnappingSources:this.getFeatureSnappingSources}):null).reverse()}};g([w()],Xf.prototype,"children",void 0),g([w()],Xf.prototype,"enabled",null),g([w({constructOnly:!0})],Xf.prototype,"getFeatureSnappingSources",void 0),g([w()],Xf.prototype,"featureSource",null),g([w()],Xf.prototype,"parent",void 0),Xf=nF=g([te("esri.widgets.support.SnappingControls.SnappingListItem")],Xf);let ex=class extends qR{constructor(){super(...arguments),this.featureSnappingSources=new Xe}get operationalItemsFlat(){return this.operationalItems.flatten(e=>e.children)}_compileList(){const e=this.get("view.map.layers");if(!e)return;const t=e.filter(rF);this._watchLayersListMode(t);const i=this._getViewableLayers(t);i&&i.length?(this._createNewItems(i),this._removeItems(i),this._sortItems(i)):this._removeAllItems()}_createListItem(e){return new Xf({layer:e,view:this.view,getFeatureSnappingSources:()=>this.featureSnappingSources})}};g([w()],ex.prototype,"featureSnappingSources",void 0),g([w()],ex.prototype,"operationalItems",void 0),ex=g([te("esri.widgets.support.SnappingControls.SnappingLayerListViewModel")],ex);const GGe="esri.widgets.support.SnappingControls.SnappingControlsViewModel";let Tm=class extends ls(Ye){constructor(e){super(e),this.layerListViewModel=new ex,this.snappingOptions=null,this.view=null}initialize(){this.handles.add([we(()=>({viewModel:this.layerListViewModel,view:this.view}),({viewModel:e,view:t})=>{e.view=t},St),we(()=>{var e;return{viewModel:this.layerListViewModel,sources:(e=this.snappingOptions)==null?void 0:e.featureSources}},({viewModel:e,sources:t})=>{e.featureSnappingSources=t},St)])}get state(){return this.get("snappingOptions")?"ready":"disabled"}enableSnappingForLayer(e){var t;((t=this._findSnappingSourceForLayer(e))!=null?t:this._makeSnappingSourceForLayer(e)).enabled=!0}disableSnappingForLayer(e){const t=this._findSnappingSourceForLayer(e);t&&(t.enabled=!1)}updateEnabledFeatureSources(e){for(const t of this.snappingOptions.featureSources)GR(t.layer)&&(t.enabled=e.includes(t.layer.id))}_findSnappingSourceForLayer(e){return this.snappingOptions.featureSources.find(t=>t.layer.id===e)}_makeSnappingSourceForLayer(e){const{layer:t}=this.layerListViewModel.operationalItemsFlat.find(r=>r.layer.id===e);if(!t)throw new ue("snapping-controls:layer-not-found",`cannot enable snapping for layer with id ${e} because no such layer was found in the view`);const i=new ane({layer:t});return this.snappingOptions.featureSources.add(i),i}};g([w({constructOnly:!0})],Tm.prototype,"layerListViewModel",void 0),g([w({constructOnly:!0})],Tm.prototype,"snappingOptions",void 0),g([w()],Tm.prototype,"state",null),g([w({constructOnly:!0})],Tm.prototype,"view",void 0),Tm=g([te(GGe)],Tm);const BGe=Tm,hae={header:!0,enabledToggle:!0,selfEnabledToggle:!0,featureEnabledToggle:!0,layerList:!0},ql={base:"esri-snapping-controls",container:"esri-snapping-controls__container",panel:"esri-snapping-controls__panel",item:"esri-snapping-controls__item",toggleBlock:"esri-snapping-controls__toggle-block",layerListBlock:"esri-snapping-controls__layer-list-block",layerList:"esri-snapping-controls__layer-list",layerListFilter:"esri-snapping-controls__layer-list__filter",layerListItem:"esri-snapping-controls__layer-list__item",layerListItemCheckbox:"esri-snapping-controls__layer-list__item__checkbox",layerListItemLabel:"esri-snapping-controls__layer-list__item__label",nestedContainer:"esri-snapping-controls__nested-container",disabled:"esri-disabled",esriWidget:"esri-widget",widgetIcon:"esri-icon-vertex-gps"};let Hl=class extends ki{constructor(e,t){super((()=>{const c=e,{view:i,viewModel:r,snappingOptions:n}=c;return Sx(c,["view","viewModel","snappingOptions"])})(),t),this._layerListFilter=null,this.messages=null,this.messagesCommon=null,this.visibleElements=K({},hae),this._defaultViewModel=null,(e==null?void 0:e.viewModel)?this.viewModel=e.viewModel:(this._defaultViewModel=new BGe({snappingOptions:e.snappingOptions,view:e.view}),this.viewModel=this._defaultViewModel)}destroy(){this._defaultViewModel=li(this._defaultViewModel)}loadDependencies(){return Promise.all([import("./calcite-accordion.116efa56.js"),import("./calcite-accordion-item.0fd3f090.js"),import("./calcite-block.93c54207.js"),import("./calcite-checkbox.ba671912.js"),import("./calcite-input.e2f12b2d.js"),import("./calcite-label.c8cfa339.js"),import("./calcite-list.5aff1680.js"),import("./calcite-list-item.b2ac20d5.js"),import("./calcite-panel.bea9c450.js"),import("./calcite-switch.5ee08c13.js")])}get label(){var e,t;return(t=(e=this.messages)==null?void 0:e.widgetLabel)!=null?t:""}set label(e){this._overrideIfSome("label",e)}get snappingOptions(){return this.viewModel.snappingOptions}set snappingOptions(e){this.viewModel.snappingOptions=e}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}set viewModel(e){e!==this._get("viewModel")&&((ce(this._defaultViewModel)||this._defaultViewModel!==e)&&(this._defaultViewModel=li(this._defaultViewModel)),this._set("viewModel",e))}castVisibleElements(e){return K(K({},hae),e)}render(){const{label:e,visibleElements:{header:t}}=this;return j("div",{"aria-label":e,class:this.classes(ql.base,ql.esriWidget)},j("div",{class:ql.container},t?this.renderHeaderView():this.renderContent()))}renderHeaderView(){return j("calcite-panel",{heading:this.label,class:ql.panel},this.renderContent())}renderContent(){return[this.renderToggles(),this.renderLayerList()]}renderToggles(){const{visibleElements:{enabledToggle:e,selfEnabledToggle:t,featureEnabledToggle:i}}=this;if(e||t||i)return j("calcite-block",{class:ql.toggleBlock,key:"toggle-block",heading:"",open:!0},this.renderEnabledToggle(),j("div",{class:ql.nestedContainer},this.renderSelfEnabledToggle(),this.renderFeatureEnabledToggle()))}renderEnabledToggle(){if(!this.visibleElements.enabledToggle)return;const{messages:{enableSnapping:e},viewModel:{snappingOptions:{enabled:t,enabledToggled:i}}}=this;return j("calcite-label",{layout:"inline-space-between"},e,j("calcite-switch",{checked:t,disabled:i,bind:this,onCalciteSwitchChange:this._enableSnappingSwitchChange}))}renderSelfEnabledToggle(){if(!this.visibleElements.selfEnabledToggle)return;const{messages:{geometryGuides:e},viewModel:{snappingOptions:{enabled:t,selfEnabled:i,enabledToggled:r}}}=this;return j("calcite-label",{layout:"inline-space-between",key:"self-enabled-toggle"},e,j("calcite-switch",{checked:i,disabled:r||!t,bind:this,onCalciteSwitchChange:this._selfEnabledSwitchChange}))}renderFeatureEnabledToggle(){if(!this.visibleElements.featureEnabledToggle)return;const{messages:{featureToFeature:e},viewModel:{snappingOptions:{enabled:t,featureEnabled:i,enabledToggled:r}}}=this;return j("calcite-label",{layout:"inline-space-between",key:"feature-enabled-toggle"},e,j("calcite-switch",{checked:i,disabled:r||!t,bind:this,onCalciteSwitchChange:this._featureEnabledSwitchChange}))}renderLayerList(){if(!this.visibleElements.layerList)return;const{messages:e,messagesCommon:t}=this,i=({target:{value:n}})=>this._layerListFilter=n===""?null:new RegExp(n,"i"),r=this.viewModel.layerListViewModel.operationalItems.length>9?j("calcite-input",{class:ql.layerListFilter,clearable:!0,placeholder:e==null?void 0:e.searchLayers,onCalciteInputInput:i}):null;return j("calcite-block",{key:"list-block","intl-collapse":t==null?void 0:t.collapse,"intl-expand":t==null?void 0:t.expand,heading:e.snappingLayers,class:ql.layerListBlock,open:!0,collapsible:!0},r,j("calcite-list",{class:ql.layerList},this.renderLayerListItemCollection(this.viewModel.layerListViewModel.operationalItems,Ht(this._layerListFilter))))}renderLayerListItemCollection(e,t){return e.map(i=>{if(!t||this._itemTitleMatchesFilter(i,t))return i.children.length>0?this.renderLayerListItemGroup(i):this.renderLayerListItem(i);const r=i.children.filter(n=>this._itemTitleMatchesFilter(n,t));return r.length>0?this.renderLayerListItemGroup(i,r):null}).toArray()}renderLayerListItem(e){const{messages:{untitledLayer:t}}=this,i=e.title||t,r=e.enabled,n=j("calcite-checkbox",{value:e.layer.id,checked:r,bind:this,onCalciteCheckboxChange:c=>this._handleLayerListItemChange(c.target)}),o=()=>{const c=!n.properties.checked;this._handleLayerListItemChange({checked:c,value:n.properties.value})};return j("calcite-list-item",{key:`${this.id}-list-item-${e.uid}`,onclick:o},j("calcite-label",{class:ql.layerListItem,slot:"content-start",tabIndex:-1,layout:"inline","disable-spacing":"true"},j("div",{class:ql.layerListItemCheckbox},n),j("div",{class:ql.layerListItemLabel},i)))}renderLayerListItemGroup(e,t){const i=e.title||this.messages.untitledLayer,r=e.title&&e.title!==""?e.title:ig(),n=!!t,o=t!=null?t:e.children;return j("calcite-list-item",{key:r},j("calcite-accordion",{"icon-position":"start",appearance:"transparent",afterCreate:c=>{c.append(...Array.from(c.children).map(h=>(h.remove(),h)))}},j("calcite-accordion-item",{active:n,"item-title":i,key:e.uid},j("calcite-list",null,[...this.renderLayerListItemCollection(o)]))))}_enableSnappingSwitchChange(e){this.snappingOptions.enabled=e.target.checked}_featureEnabledSwitchChange(e){this.snappingOptions.featureEnabled=e.target.checked}_itemTitleMatchesFilter(e,t){return t.test(e.title)}_selfEnabledSwitchChange(e){this.snappingOptions.selfEnabled=e.target.checked}async _handleLayerListItemChange(e){e.checked?this.viewModel.enableSnappingForLayer(e.value):this.viewModel.disableSnappingForLayer(e.value)}};g([w()],Hl.prototype,"_layerListFilter",void 0),g([w()],Hl.prototype,"label",null),g([w(),ci("esri/widgets/support/SnappingControls/t9n/SnappingControls")],Hl.prototype,"messages",void 0),g([w(),ci("esri/t9n/common")],Hl.prototype,"messagesCommon",void 0),g([w()],Hl.prototype,"snappingOptions",null),g([w()],Hl.prototype,"view",null),g([w()],Hl.prototype,"viewModel",null),g([w()],Hl.prototype,"visibleElements",void 0),g([Dt("visibleElements")],Hl.prototype,"castVisibleElements",null),Hl=g([te("esri.widgets.support.SnappingControls")],Hl);const UGe=Hl,An={base:"esri-sketch",verticalLayout:"esri-sketch--vertical",panel:"esri-sketch__panel",infoPanel:"esri-sketch__info-panel",section:"esri-sketch__section",toolSection:"esri-sketch__tool-section",infoSection:"esri-sketch__info-section",infoCountSection:"esri-sketch__info-count-section",menuContainer:"esri-sketch__menu-container",menuHeader:"esri-sketch__menu-header",menuTitle:"esri-sketch__menu-title",featureCountBadge:"esri-sketch__feature-count-badge",featureCountText:"esri-sketch__feature-count-text",featureCountNumber:"esri-sketch__feature-count-number",actionToggle:"esri-sketch__action-toggle",actionToggleOn:"esri-sketch__action-toggle--on",actionTitle:"esri-sketch__item-action-title",actionIcon:"esri-sketch__item-action-icon",disabled:"esri-disabled",esriWidget:"esri-widget",rotating:"esri-rotating",widgetIcon:"esri-icon-edit"},tx={createTools:{point:!0,polyline:!0,polygon:!0,rectangle:!0,circle:!0},selectionTools:{"rectangle-selection":!0,"lasso-selection":!0},undoRedoMenu:!0,settingsMenu:!0,snappingControls:!0,snappingControlsElements:{header:!1,enabledToggle:!0,selfEnabledToggle:!0,featureEnabledToggle:!0,layerList:!0}};let _n=class extends ki{constructor(e,t){super(e,t),this._activeCreateOptions=null,this._menuOpen=!1,this._selectionToolbar=null,this._snappingControls=null,this._viewModelHandlesGroup=null,this.availableCreateTools=["point","polyline","polygon","rectangle","circle"],this.creationMode="continuous",this.iconClass=An.widgetIcon,this.layout="horizontal",this.messages=null,this.visibleElements=K({},tx),this._activateCreateTool=this._activateCreateTool.bind(this),this.viewModel=(e==null?void 0:e.viewModel)||new hne}initialize(){const{layer:e,view:t}=this,i=new jGe({view:(t==null?void 0:t.type)==="2d"?t:null,layers:e?[e]:null});this.addHandles([we(()=>this.viewModel,r=>{this._viewModelHandlesGroup=mr(this._viewModelHandlesGroup),r&&(this._viewModelHandlesGroup=od([r.on("create",n=>{this.scheduleRender(),this._onCreateOperation(n)}),r.on("update",()=>this.scheduleRender()),r.on("delete",n=>this.emit("delete",n)),r.on("undo",()=>this.scheduleRender()),r.on("redo",()=>this.scheduleRender()),we(()=>r.layer,n=>{this._selectionToolbar.layers=n?[n]:null}),we(()=>r.view,n=>{this._selectionToolbar.view=(n==null?void 0:n.type)==="2d"?n:null,this._setUpSnappingControls()}),we(()=>r.state,()=>this.notifyChange("state"))]))},Gs),os(()=>i.activeToolInfo,()=>this.viewModel.cancel()),i.on("complete",r=>this._onSelectionOperationComplete(r))]),this._selectionToolbar=i,this._setUpSnappingControls()}loadDependencies(){return Promise.all([import("./calcite-action.fe807edf.js"),import("./calcite-icon.3e014da3.js")])}destroy(){this._selectionToolbar.destroy(),this._viewModelHandlesGroup=mr(this._viewModelHandlesGroup),this._snappingControls=li(this._snappingControls)}get activeTool(){const e=this._selectionToolbar.activeToolInfo;if(e)switch(e.toolName){case"lasso":return"lasso-selection";case"rectangle":return"rectangle-selection";case"default":return"custom-selection"}return this.viewModel.activeTool}get createGraphic(){return this.viewModel.createGraphic}get defaultCreateOptions(){return this.viewModel.defaultCreateOptions}set defaultCreateOptions(e){this.viewModel.defaultCreateOptions=e}get defaultUpdateOptions(){return this.viewModel.defaultUpdateOptions}set defaultUpdateOptions(e){this.viewModel.defaultUpdateOptions=e}get label(){var e,t;return(t=(e=this.messages)==null?void 0:e.widgetLabel)!=null?t:""}set label(e){this._overrideIfSome("label",e)}get labelOptions(){return this.viewModel.labelOptions}set labelOptions(e){this.viewModel.labelOptions=e}get layer(){return this.viewModel.layer}set layer(e){this.viewModel.layer=e}get snappingOptions(){return this.viewModel.snappingOptions}set snappingOptions(e){this.viewModel.snappingOptions=e}get state(){return this._selectionToolbar.activeToolInfo?"active":this.viewModel.state}get tooltipOptions(){return this.viewModel.tooltipOptions}set tooltipOptions(e){this.viewModel.tooltipOptions=e}get updateGraphics(){return this.viewModel.updateGraphics}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}set viewModel(e){const t=this._get("viewModel");e!==t&&(t&&li(t),this._set("viewModel",e))}castVisibleElements(e){const t=Ce(K(K({},tx),e),{createTools:K(K({},tx.createTools),e==null?void 0:e.createTools),selectionTools:K(K({},tx.selectionTools),e==null?void 0:e.selectionTools),snappingControlsElements:K(K({},tx.snappingControlsElements),e==null?void 0:e.snappingControlsElements)});return H(this._snappingControls)&&(this._snappingControls.visibleElements=t.snappingControlsElements),t}create(e,t){this._activeCreateOptions=t||null,this.viewModel.create(e,t)}update(e,t){return this.viewModel.update(e,t)}complete(){this.viewModel.complete()}cancel(){this._selectionToolbar.cancel(),this.viewModel.cancel()}undo(){var e;this.viewModel.undo(),(e=this.view)==null||e.focus()}redo(){var e;this.viewModel.redo(),(e=this.view)==null||e.focus()}delete(){this.viewModel.delete()}render(){const{label:e,layout:t,viewModel:{state:i}}=this;return j("div",{"aria-label":e,class:this.classes(An.base,An.esriWidget,{[An.disabled]:i==="disabled",[An.verticalLayout]:t==="vertical"})},j("div",{role:"toolbar",class:An.panel},this.renderTopPanelContents()),j("div",{class:this.classes(An.panel,An.infoPanel)},this.renderInfoPanelContents()))}renderTopPanelContents(){const e=this.classes(An.section,An.toolSection),{availableCreateTools:t,visibleElements:i}=this;return[j("div",{role:"menu",key:"selection-button-container",class:e},this.renderDefaultSelectionButton(),this.renderSelectionToolbar()),t&&t.length?j("div",{role:"menu",class:e},this.renderDrawButtons()):null,i.undoRedoMenu?j("div",{role:"menu",key:"undo-redo-menu-button-container",class:e},this.renderUndoRedoMenuButtons()):null,i.settingsMenu?j("div",{key:"settings-menu-button-container",class:An.section},this.renderSettingsMenuButton()):null]}renderInfoPanelContents(){return this._menuOpen?this.renderSettingsMenu():this.updateGraphics.length?[j("div",{class:this.classes(An.section,An.infoSection,An.infoCountSection),key:"feature-count-container"},this.renderFeatureCount()),j("div",{class:this.classes(An.section,An.infoSection),key:"delete-button-container"},this.renderDeleteButton())]:void 0}renderSettingsMenu(){const{settings:e}=this.messages;return[j("div",{role:"menu",class:An.menuContainer,key:"settings-menu-container"},j("header",{class:An.menuHeader,key:"settings-menu-header"},j("span",{class:An.menuTitle},e)),this.renderSnappingControls())]}renderSnappingControls(){const{snappingControls:e}=this.visibleElements;if(H(this._snappingControls)&&e)return this._snappingControls.render()}renderFeatureCount(){const{layout:e,messages:t,updateGraphics:{length:i}}=this,r=oo(i===1?t.featureCount:t.featuresCount,{count:i});return j("div",{class:An.featureCountBadge,"aria-label":r},j("span",{class:An.featureCountNumber},e==="vertical"?i:r))}renderDeleteButton(){const e=this.messages.deleteFeature;return j("calcite-action",{bind:this,label:e,onclick:this.delete,scale:"s",text:e,title:e},j("calcite-icon",{scale:"s",icon:"trash"}))}renderDefaultSelectionButton(){if(!this.viewModel.updateOnGraphicClick)return;const e=this.messages.selectFeature;return j("calcite-action",{active:this.state==="ready",bind:this,label:e,onclick:this._activateDefaultSelectTool,scale:"s",text:e,title:e},j("calcite-icon",{scale:"s",icon:"cursor"}))}renderSelectionToolbar(){var t;if(((t=this.view)==null?void 0:t.type)!=="2d")return;const e=this.visibleElements.selectionTools;return this._selectionToolbar.visibleElements={lassoTool:!!e["lasso-selection"],rectangleTool:!!e["rectangle-selection"]},this._selectionToolbar.render()}renderDrawButtons(){const e=this.visibleElements.createTools;return this.availableCreateTools.map(t=>t==="point"&&e.point?this.renderPointButton():t==="polyline"&&e.polyline?this.renderPolylineButton():t==="polygon"&&e.polygon?this.renderPolygonButton():t==="rectangle"&&e.rectangle?this.renderRectangleButton():t==="circle"&&e.circle?this.renderCircleButton():void 0)}renderPointButton(){const e="point",t=this.messages.drawPoint;return j("calcite-action",{active:this.activeTool===e,bind:this,label:t,onclick:()=>this._activateCreateTool(e),scale:"s",text:t,title:t},j("calcite-icon",{scale:"s",icon:"pin"}))}renderPolygonButton(){const e="polygon",t=this.messages.drawPolygon;return j("calcite-action",{active:this.activeTool===e,bind:this,label:t,onclick:()=>this._activateCreateTool(e),scale:"s",text:t,title:t},j("calcite-icon",{scale:"s",icon:"polygon"}))}renderPolylineButton(){const e="polyline",t=this.messages.drawPolyline;return j("calcite-action",{active:this.activeTool===e,bind:this,label:t,onclick:()=>this._activateCreateTool(e),scale:"s",text:t,title:t},j("calcite-icon",{scale:"s",icon:"line"}))}renderCircleButton(){const e="circle",t=this.messages.drawCircle;return j("calcite-action",{active:this.activeTool===e,bind:this,label:t,onclick:()=>this._activateCreateTool(e),scale:"s",text:t,title:t},j("calcite-icon",{scale:"s",icon:"circle"}))}renderRectangleButton(){const e="rectangle",t=this.messages.drawRectangle;return j("calcite-action",{active:this.activeTool===e,bind:this,label:t,onclick:()=>this._activateCreateTool(e),scale:"s",text:t,title:t},j("calcite-icon",{scale:"s",icon:"rectangle"}))}renderUndoRedoMenuButtons(){return[this.renderUndoButton(),this.renderRedoButton()]}renderUndoButton(){const e=this.messages.undo;return j("calcite-action",{disabled:!this.viewModel.canUndo(),bind:this,label:e,onclick:this.undo,scale:"s",text:e,title:e},j("calcite-icon",{scale:"s",icon:Ms(this.container)?"redo":"undo"}))}renderRedoButton(){const e=this.messages.redo;return j("calcite-action",{disabled:!this.viewModel.canRedo(),bind:this,label:e,onclick:this.redo,scale:"s",text:e,title:e},j("calcite-icon",{scale:"s",icon:Ms(this.container)?"undo":"redo"}))}renderSettingsMenuButton(){const e=this.messages.settings;return j("calcite-action",{active:this._menuOpen,bind:this,label:e,onclick:this._toggleMenu,scale:"s",text:e,title:e},j("calcite-icon",{scale:"s",icon:"gear"}))}_activateCreateTool(e){this.activeTool!==e?(this._selectionToolbar.cancel(),this.create(e)):this.cancel()}_onCreateOperation(e){if(e.state!=="complete")return;const{creationMode:t}=this,{type:i}=e;if(i==="create"){const{tool:r,graphic:n}=e,o=this._activeCreateOptions;this._activeCreateOptions=null,t==="continuous"?this.create(r,o):t==="update"&&this.update([n])}}_toggleMenu(){this._menuOpen=!this._menuOpen,this.scheduleRender()}_onSelectionOperationComplete(e){const{viewModel:{defaultUpdateOptions:t}}=this,{selection:i}=e;if(!e.aborted&&i.length){const r=t.tool,n=i.length>1&&r==="reshape"?"transform":r;this.update(i,Ce(K({},t),{tool:n}))}this.notifyChange("state")}_activateDefaultSelectTool(){var e;this.cancel(),(e=this.view)==null||e.focus()}_setUpSnappingControls(){const{snappingOptions:e,view:t}=this;if(this._snappingControls=li(this._snappingControls),!e||!t)return;const i=new UGe({snappingOptions:e,view:t,visibleElements:this.visibleElements.snappingControlsElements});this._snappingControls=i}};g([w()],_n.prototype,"activeTool",null),g([w({cast:e=>{if(!e||!e.length)return null;const t=new Set(["point","polyline","polygon","rectangle","circle"]);return e.filter(i=>t.has(i))}})],_n.prototype,"availableCreateTools",void 0),g([w({readOnly:!0})],_n.prototype,"createGraphic",null),g([w()],_n.prototype,"creationMode",void 0),g([w()],_n.prototype,"defaultCreateOptions",null),g([w()],_n.prototype,"defaultUpdateOptions",null),g([w()],_n.prototype,"iconClass",void 0),g([w()],_n.prototype,"label",null),g([w()],_n.prototype,"labelOptions",null),g([w()],_n.prototype,"layer",null),g([w({type:["horizontal","vertical"]})],_n.prototype,"layout",void 0),g([w(),ci("esri/widgets/Sketch/t9n/Sketch")],_n.prototype,"messages",void 0),g([w()],_n.prototype,"snappingOptions",null),g([w()],_n.prototype,"state",null),g([w()],_n.prototype,"tooltipOptions",null),g([w({readOnly:!0})],_n.prototype,"updateGraphics",null),g([w()],_n.prototype,"view",null),g([w(),n1(["create","update","undo","redo"])],_n.prototype,"viewModel",null),g([w()],_n.prototype,"visibleElements",void 0),g([Dt("visibleElements")],_n.prototype,"castVisibleElements",null),_n=g([te("esri.widgets.Sketch")],_n);let Qu=class extends Ye{constructor(e){super(e),this._handles=new Ti,this.state="pending",this.url=""}initialize(){this._handles.add([we(()=>[this.extension,this.name],()=>this._setFormattedFileName(),St)])}destroy(){this._handles.destroy()}_setFormattedFileName(){if(!this.name||!this.extension)return;let e=this.name+"."+this.extension;this.count&&(e=this.name+"("+this.count+")."+this.extension),this.formattedName=e}};g([w()],Qu.prototype,"count",void 0),g([w()],Qu.prototype,"error",void 0),g([w()],Qu.prototype,"extension",void 0),g([w()],Qu.prototype,"formattedName",void 0),g([w()],Qu.prototype,"name",void 0),g([w()],Qu.prototype,"state",void 0),g([w()],Qu.prototype,"url",void 0),Qu=g([te("esri.widgets.print.FileLink")],Qu);const pae=Qu;let Vc=class extends Ye{constructor(){super(...arguments),this.outSpatialReference=null,this.processExtent=null,this.processSpatialReference=null,this.returnFeatureCollection=!1,this.returnM=!1,this.returnZ=!1}};g([w({type:Mt})],Vc.prototype,"outSpatialReference",void 0),g([w({type:gi})],Vc.prototype,"processExtent",void 0),g([w({type:Mt})],Vc.prototype,"processSpatialReference",void 0),g([w({nonNullable:!0})],Vc.prototype,"returnFeatureCollection",void 0),g([w({nonNullable:!0})],Vc.prototype,"returnM",void 0),g([w({nonNullable:!0})],Vc.prototype,"returnZ",void 0),Vc=g([te("esri.rest.geoprocessor.GPOptions")],Vc),Vc.from=Oi(Vc);const sF=Vc;let zc=class extends ke{constructor(){super(...arguments),this.extent=null,this.height=null,this.href=null,this.opacity=1,this.rotation=0,this.scale=null,this.visible=!0,this.width=null}};g([w({type:gi})],zc.prototype,"extent",void 0),g([w()],zc.prototype,"height",void 0),g([w()],zc.prototype,"href",void 0),g([w()],zc.prototype,"opacity",void 0),g([w()],zc.prototype,"rotation",void 0),g([w()],zc.prototype,"scale",void 0),g([w()],zc.prototype,"visible",void 0),g([w()],zc.prototype,"width",void 0),zc=g([te("esri.layer.support.MapImage")],zc);const dae=zc;let ix=class extends ke{constructor(e){super(e),this.itemId=null,this.url=null}};g([w({type:String,json:{read:{source:"itemID"},write:{target:"itemID"}}})],ix.prototype,"itemId",void 0),g([w({type:String,json:{write:!0}})],ix.prototype,"url",void 0),ix=g([te("esri.rest.support.DataFile")],ix);const oF=ix,fae=new kt({GPBoolean:"boolean",GPDataFile:"data-file",GPDate:"date",GPDouble:"double",GPFeatureRecordSetLayer:"feature-record-set-layer",GPField:"field",GPLinearUnit:"linear-unit",GPLong:"long",GPRasterData:"raster-data",GPRasterDataLayer:"raster-data-layer",GPRecordSet:"record-set",GPString:"string","GPMultiValue:GPBoolean":"multi-value","GPMultiValue:GPDataFile":"multi-value","GPMultiValue:GPDate":"multi-value","GPMultiValue:GPDouble":"multi-value","GPMultiValue:GPFeatureRecordSetLayer":"multi-value","GPMultiValue:GPField":"multi-value","GPMultiValue:GPLinearUnit":"multi-value","GPMultiValue:GPLong":"multi-value","GPMultiValue:GPRasterData":"multi-value","GPMultiValue:GPRasterDataLayer":"multi-value","GPMultiValue:GPRecordSet":"multi-value","GPMultiValue:GPString":"multi-value"});let rx=class extends ke{constructor(e){super(e),this.dataType=null,this.value=null}};g([w({json:{read:fae.read,write:fae.write}})],rx.prototype,"dataType",void 0),g([w()],rx.prototype,"value",void 0),rx=g([te("esri.rest.support.ParameterValue")],rx);const qGe=rx;let xb=class extends ke{constructor(e){super(e),this.format=null,this.itemId=null,this.url=null}};g([w()],xb.prototype,"format",void 0),g([w({json:{read:{source:"itemID"},write:{target:"itemID"}}})],xb.prototype,"itemId",void 0),g([w()],xb.prototype,"url",void 0),xb=g([te("esri.rest.support.RasterData")],xb);const yae=xb;async function mae(e,t,i,r,n){const o={},c={},h=[];return HGe(r,h,o),d1(h).then(m=>{const{outSpatialReference:b,processExtent:x,processSpatialReference:I,returnFeatureCollection:E,returnM:k,returnZ:P}=i,{path:F}=Br(e);for(const X in o){const Y=o[X];c[X]=m.slice(Y[0],Y[1])}const N=b?b.wkid||b:null,B=I?I.wkid||I:null,z=t==="execute"?{returnFeatureCollection:E||void 0,returnM:k||void 0,returnZ:P||void 0}:null,q=c$(Ce(K(K(K({},x?{context:{extent:x,outSR:N,processSR:B}}:{"env:outSR":N,"env:processSR":B}),r),z),{f:"json"}),null,c),J=Ce(K({},n),{query:q});return Nt(`${F}/${t}`,J)})}function HGe(e,t,i){for(const r in e){const n=e[r];if(n&&typeof n=="object"&&n instanceof Gh){const{features:o}=n;i[r]=[t.length,t.length+o.length],o.forEach(c=>{t.push(c.geometry)})}}}function aF(e){const t=e.dataType,i=qGe.fromJSON(e);switch(t){case"GPBoolean":case"GPDouble":case"GPLong":case"GPString":case"GPMultiValue:GPBoolean":case"GPMultiValue:GPDouble":case"GPMultiValue:GPLong":case"GPMultiValue:GPString":return i;case"GPDate":i.value=new Date(i.value);break;case"GPDataFile":i.value=oF.fromJSON(i.value);break;case"GPLinearUnit":i.value=qie.fromJSON(i.value);break;case"GPFeatureRecordSetLayer":case"GPRecordSet":{const r=e.value.url;i.value=r?oF.fromJSON(i.value):Gh.fromJSON(i.value);break}case"GPRasterData":case"GPRasterDataLayer":{const r=e.value.mapImage;i.value=r?dae.fromJSON(r):yae.fromJSON(i.value);break}case"GPField":i.value=u1.fromJSON(i.value);break;case"GPMultiValue:GPDate":{const r=i.value;i.value=r.map(n=>new Date(n));break}case"GPMultiValue:GPDataFile":i.value=i.value.map(r=>oF.fromJSON(r));break;case"GPMultiValue:GPLinearUnit":i.value=i.value.map(r=>qie.fromJSON(r));break;case"GPMultiValue:GPFeatureRecordSetLayer":case"GPMultiValue:GPRecordSet":i.value=i.value.map(r=>Gh.fromJSON(r));break;case"GPMultiValue:GPRasterData":case"GPMultiValue:GPRasterDataLayer":i.value=i.value.map(r=>r?dae.fromJSON(r):yae.fromJSON(i.value));break;case"GPMultiValue:GPField":i.value=i.value.map(r=>u1.fromJSON(r))}return i}function c$(e,t,i){for(const r in e){const n=e[r];Array.isArray(n)?e[r]=JSON.stringify(n.map(o=>c$({item:o},!0).item)):n instanceof Date&&(e[r]=n.getTime())}return p1(e,t,i)}const gae=new kt({esriJobMessageTypeInformative:"informative",esriJobMessageTypeProcessDefinition:"process-definition",esriJobMessageTypeProcessStart:"process-start",esriJobMessageTypeProcessStop:"process-stop",esriJobMessageTypeWarning:"warning",esriJobMessageTypeError:"error",esriJobMessageTypeEmpty:"empty",esriJobMessageTypeAbort:"abort"});let nx=class extends ke{constructor(e){super(e),this.description=null,this.type=null}};g([w({type:String,json:{write:!0}})],nx.prototype,"description",void 0),g([w({type:String,json:{read:gae.read,write:gae.write}})],nx.prototype,"type",void 0),nx=g([te("esri.rest.support.GPMessage")],nx);const vae=nx;async function bae(e,t,i,r){return i=sF.from(i||{}),mae(e,"execute",i,t,r).then(n=>{const o=n.data.results||[],c=n.data.messages||[];return{results:o.map(aF),messages:c.map(h=>vae.fromJSON(h))}})}var u$;const WGe=new kt({esriJobCancelled:"job-cancelled",esriJobCancelling:"job-cancelling",esriJobDeleted:"job-deleted",esriJobDeleting:"job-deleting",esriJobTimedOut:"job-timed-out",esriJobExecuting:"job-executing",esriJobFailed:"job-failed",esriJobNew:"job-new",esriJobSubmitted:"job-submitted",esriJobSucceeded:"job-succeeded",esriJobWaiting:"job-waiting"});let Qf=u$=class extends ke{constructor(e){super(e),this.jobId=null,this.jobStatus=null,this.messages=null,this.requestOptions=null,this.sourceUrl=null,this._timer=null}cancelJob(e){const{jobId:t,sourceUrl:i}=this,{path:r}=Br(i),n=Ce(K(K({},this.requestOptions),e),{query:{f:"json"}});return this._clearTimer(),Nt(`${r}/jobs/${t}/cancel`,n).then(o=>{const c=u$.fromJSON(o.data);return this.messages=c.messages,this.jobStatus=c.jobStatus,this})}destroy(){clearInterval(this._timer)}checkJobStatus(e){const{path:t}=Br(this.sourceUrl),i=Ce(K(K({},this.requestOptions),e),{query:{f:"json"}}),r=`${t}/jobs/${this.jobId}`;return Nt(r,i).then(({data:n})=>{const o=u$.fromJSON(n);return this.messages=o.messages,this.jobStatus=o.jobStatus,this})}fetchResultData(e,t,i){t=sF.from(t||{});const{returnFeatureCollection:r,returnM:n,returnZ:o,outSpatialReference:c}=t,{path:h}=Br(this.sourceUrl),m=c$({returnFeatureCollection:r,returnM:n,returnZ:o,outSR:c,returnType:"data",f:"json"},null),b=Ce(K(K({},this.requestOptions),i),{query:m}),x=`${h}/jobs/${this.jobId}/results/${e}`;return Nt(x,b).then(I=>aF(I.data))}fetchResultImage(e,t,i){const{path:r}=Br(this.sourceUrl),n=Ce(K({},t.toJSON()),{f:"json"}),o=c$(n),c=Ce(K(K({},this.requestOptions),i),{query:o}),h=`${r}/jobs/${this.jobId}/results/${e}`;return Nt(h,c).then(m=>aF(m.data))}async fetchResultMapImageLayer(){const{path:e}=Br(this.sourceUrl),t=e.indexOf("/GPServer/"),i=`${e.substring(0,t)}/MapServer/jobs/${this.jobId}`;return new(await Promise.resolve().then(function(){return jOe})).default({url:i})}async waitForJobCompletion(e={}){const{interval:t=1e3,signal:i,statusCallback:r}=e;return new Promise((n,o)=>{Ho(i,()=>{this._clearTimer(),o(Qi())}),this._clearTimer();const c=setInterval(()=>{this._timer||o(Qi()),this.checkJobStatus(this.requestOptions).then(h=>{const{jobStatus:m}=h;switch(this.jobStatus=m,m){case"job-succeeded":this._clearTimer(),n(this);break;case"job-submitted":case"job-executing":case"job-waiting":case"job-new":r&&r(this);break;case"job-cancelled":case"job-cancelling":case"job-deleted":case"job-deleting":case"job-timed-out":case"job-failed":this._clearTimer(),o(this)}})},t);this._timer=c})}_clearTimer(){this._timer&&(clearInterval(this._timer),this._timer=null)}};g([w()],Qf.prototype,"jobId",void 0),g([w({json:{read:WGe.read}})],Qf.prototype,"jobStatus",void 0),g([w({type:[vae]})],Qf.prototype,"messages",void 0),g([w()],Qf.prototype,"requestOptions",void 0),g([w({json:{write:!0}})],Qf.prototype,"sourceUrl",void 0),Qf=u$=g([te("esri.rest.support.JobInfo")],Qf);const JGe=Qf;async function ZGe(e,t,i,r){return i=sF.from(i||{}),mae(e,"submitJob",i,t,r).then(n=>{const o=JGe.fromJSON(n.data);return o.sourceUrl=e,o})}const h$=new kt({PDF:"pdf",PNG32:"png32",PNG8:"png8",JPG:"jpg",GIF:"gif",EPS:"eps",SVG:"svg",SVGZ:"svgz"}),lF=h$.fromJSON.bind(h$),KGe=h$.toJSON.bind(h$),p$=new kt({MAP_ONLY:"map-only","A3 Landscape":"a3-landscape","A3 Portrait":"a3-portrait","A4 Landscape":"a4-landscape","A4 Portrait":"a4-portrait","Letter ANSI A Landscape":"letter-ansi-a-landscape","Letter ANSI A Portrait":"letter-ansi-a-portrait","Tabloid ANSI B Landscape":"tabloid-ansi-b-landscape","Tabloid ANSI B Portrait":"tabloid-ansi-b-portrait"}),d$=p$.fromJSON.bind(p$),YGe=p$.toJSON.bind(p$),cF="simple-marker",XGe="picture-marker",wae="simple-line",QGe="simple-fill",eBe="shield-label-symbol",tBe="text";function iBe(e,t){const{graphic:i,renderer:r,symbol:n}=t,o=n.type;if(o===tBe||o===eBe||!("visualVariables"in r)||!r.visualVariables)return;const c=r.getVisualVariablesForType("size"),h=r.getVisualVariablesForType("color"),m=r.getVisualVariablesForType("opacity"),b=r.getVisualVariablesForType("rotation"),x=c[0],I=h[0],E=m[0],k=b[0];if(x){const P=o===cF?n.style:null,F=d2(x,i,{shape:P});F!=null&&(o===cF?e.size=$n(F):o===XGe?(e.width=$n(F),e.height=$n(F)):o===wae?e.width=$n(F):e.outline&&(e.outline.width=$n(F)))}if(I){const P=HA(I,i);(P&&o===cF||o===wae||o===QGe)&&(e.color=P?P.toJSON():void 0)}if(E){const P=WA(E,i);P!=null&&e.color&&(e.color[3]=Math.round(255*P))}k&&(e.angle=-JA(r,i))}function rBe(){return{layerDefinition:{name:"multipointLayer",geometryType:"esriGeometryMultipoint",drawingInfo:{renderer:null}},featureSet:{geometryType:"esriGeometryMultipoint",features:[]}}}function nBe(){return{layerDefinition:{name:"polygonLayer",geometryType:"esriGeometryPolygon",drawingInfo:{renderer:null}},featureSet:{geometryType:"esriGeometryPolygon",features:[]}}}function _ae(){return{layerDefinition:{name:"pointLayer",geometryType:"esriGeometryPoint",drawingInfo:{renderer:null}},featureSet:{geometryType:"esriGeometryPoint",features:[]}}}function sBe(){return{layerDefinition:{name:"polylineLayer",geometryType:"esriGeometryPolyline",drawingInfo:{renderer:null}},featureSet:{geometryType:"esriGeometryPolyline",features:[]}}}function oBe(e,t=15){const i=e.canvas.width,r=e.canvas.height,n=e.getImageData(0,0,i,r).data;let o,c,h,m,b,x;e:for(c=r;c--;)for(o=i;o--;)if(n[4*(i*c+o)+3]>t){x=c;break e}if(!x)return null;e:for(o=i;o--;)for(c=x+1;c--;)if(n[4*(i*c+o)+3]>t){b=o;break e}e:for(o=0;o<=b;++o)for(c=x+1;c--;)if(n[4*(i*c+o)+3]>t){h=o;break e}e:for(c=0;c<=x;++c)for(o=h;o<=b;++o)if(n[4*(i*c+o)+3]>t){m=c;break e}return{x:h,y:m,width:b-h,height:x-m}}function aBe(e,t){const i=e.allLayerViews.items;if(t===e.scale)return i.filter(n=>!n.suspended);const r=new Array;for(const n of i)uBe(n.parent)&&!r.includes(n.parent)||!n.visible||t&&"isVisibleAtScale"in n&&!n.isVisibleAtScale(t)||r.push(n);return r}function lBe(e){return(e==null?void 0:e.type)==="bing-maps"}function xae(e){return e&&"blendMode"in e&&"effect"in e}function cBe(e){return(e==null?void 0:e.type)==="csv"}function uBe(e){return(e==null?void 0:e.declaredClass)==="esri.views.2d.layers.GroupLayerView2D"}function hBe(e){const t=e.layer;if(xae(t)){const i=t.blendMode;if((!i||i==="normal")&&(t.effect||"featureEffect"in e&&e.featureEffect))return!0}return!1}const Sae={Feet:"ft",Kilometers:"km",Meters:"m",Miles:"mi"},Mae=new kt({esriFeet:"Feet",esriKilometers:"Kilometers",esriMeters:"Meters",esriMiles:"Miles"}),pBe=new kt({esriExecutionTypeSynchronous:"sync",esriExecutionTypeAsynchronous:"async"}),uF=new Map;async function dBe(e,t,i){const r=mBe(e);let n=uF.get(r);return Promise.resolve().then(()=>n?{data:n.gpMetadata}:(n={gpServerUrl:r,is11xService:!1,legendLayerNameMap:{},legendLayers:[]},Nt(r,{query:{f:"json"}}))).then(o=>(n.gpMetadata=o.data,n.cimVersion=n.gpMetadata.cimVersion,n.is11xService=!!n.cimVersion,uF.set(r,n),fBe(t,n))).then(o=>{const c=RBe(n);let h;const m=b=>c==="sync"?b.results&&b.results[0]&&b.results[0].value:h.fetchResultData("Output_File",null,i).then(x=>x.value);return c==="async"?ZGe(e,o,null,i).then(b=>(h=b,b.waitForJobCompletion({interval:t.updateDelay}).then(m))):bae(e,o,null,i).then(m)})}async function fBe(e,t){t=t||{is11xService:!1,legendLayerNameMap:{},legendLayers:[]};const i=e.template||new Bie;i.showLabels==null&&(i.showLabels=!0);const r=i.exportOptions;let n;const o=YGe(i.layout);if(r&&(n={dpi:r.dpi},o.toLowerCase()==="map_only"||o==="")){const I=r.width,E=r.height;n.outputSize=[I,E]}const c=i.layoutOptions;let h;if(c){let I,E;c.scalebarUnit==="Miles"||c.scalebarUnit==="Kilometers"?(I="Kilometers",E="Miles"):c.scalebarUnit!=="Meters"&&c.scalebarUnit!=="Feet"||(I="Meters",E="Feet"),h={titleText:c.titleText,authorText:c.authorText,copyrightText:c.copyrightText,customTextElements:c.customTextElements,elementOverrides:c.elementOverrides,scaleBarOptions:{metricUnit:Mae.toJSON(I),metricLabel:Sae[I],nonMetricUnit:Mae.toJSON(E),nonMetricLabel:Sae[E]}}}let m=null;(c==null?void 0:c.legendLayers)&&(m=c.legendLayers.map(I=>{t.legendLayerNameMap[I.layerId]=I.title;const E={id:I.layerId};return I.subLayerIds&&(E.subLayerIds=I.subLayerIds),E}));const b=await yBe(e,i,t);if(b.operationalLayers){const I=new RegExp("[\\u4E00-\\u9FFF\\u0E00-\\u0E7F\\u0900-\\u097F\\u3040-\\u309F\\u30A0-\\u30FF\\u31F0-\\u31FF]"),E=/[\u0600-\u06FF]/,k=F=>{const N=F.text,B=F.font,z=B&&B.family&&B.family.toLowerCase();N&&B&&(z==="arial"||z==="arial unicode ms")&&(B.family=I.test(N)?"Arial Unicode MS":"Arial",B.style!=="normal"&&E.test(N)&&(B.family="Arial Unicode MS"))},P=()=>{throw new ue("print:cim-symbol-unsupported","CIMSymbol is not supported by a print service published from ArcMap")};b.operationalLayers.forEach(F=>{var N,B,z;((N=F.featureCollection)==null?void 0:N.layers)?F.featureCollection.layers.forEach(q=>{var J,X,Y,ae;if((Y=(X=(J=q.layerDefinition)==null?void 0:J.drawingInfo)==null?void 0:X.renderer)==null?void 0:Y.symbol){const he=q.layerDefinition.drawingInfo.renderer;he.symbol.type==="esriTS"?k(he.symbol):he.symbol.type!=="CIMSymbolReference"||t.is11xService||P()}((ae=q.featureSet)==null?void 0:ae.features)&&q.featureSet.features.forEach(he=>{he.symbol&&(he.symbol.type==="esriTS"?k(he.symbol):he.symbol.type!=="CIMSymbolReference"||t.is11xService||P())})}):!t.is11xService&&((z=(B=F.layerDefinition)==null?void 0:B.drawingInfo)==null?void 0:z.renderer)&&JSON.stringify(F.layerDefinition.drawingInfo.renderer).includes('"type":"CIMSymbolReference"')&&P()})}e.outSpatialReference&&(b.mapOptions.spatialReference=e.outSpatialReference.toJSON()),Object.assign(b,{exportOptions:n,layoutOptions:h||{}}),Object.assign(b.layoutOptions,{legendOptions:{operationalLayers:m!=null?m:t.legendLayers.slice()}}),t.legendLayers.length=0,uF.set(t.gpServerUrl,t);const x={Web_Map_as_JSON:JSON.stringify(b),Format:KGe(i.format),Layout_Template:o,Layout_Item_ID:void 0};if(i.layoutItem){delete x.Layout_Template;const I=i.layoutItem;await I.load(),I.access!=="public"&&tr&&await tr.getCredential(t.gpServerUrl),x.Layout_Item_ID=JSON.stringify({id:I.id})}return e.extraParameters&&Object.assign(x,e.extraParameters),x}async function yBe(e,t,i){const r=e.view;let n=r.spatialReference;const o={operationalLayers:await gBe(r,t,i)};let c=i.ssExtent||e.extent||r.extent;if(n&&n.isWrappable&&(c=c.clone()._normalize(!0),n=c.spatialReference),o.mapOptions={extent:c&&c.toJSON(),spatialReference:n&&n.toJSON(),showAttribution:t.attributionVisible},i.ssExtent=null,r.background&&(o.background=r.background.toJSON()),r.rotation&&(o.mapOptions.rotation=-r.rotation),t.scalePreserved&&(o.mapOptions.scale=t.outScale||r.scale),H(r.timeExtent)){const h=H(r.timeExtent.start)?r.timeExtent.start.getTime():null,m=H(r.timeExtent.end)?r.timeExtent.end.getTime():null;o.mapOptions.time=[h,m]}return o}function mBe(e){let t=e;const i=t.lastIndexOf("/GPServer/");return i>0&&(t=t.slice(0,i+9)),t}async function gBe(e,t,i){const r=[],n={layerView:null,printTemplate:t,view:e};let o=0;t.scalePreserved&&(o=t.outScale||e.scale);const c=aBe(e,o);for(const h of c){const m=h.layer;if(!m.loaded||(m==null?void 0:m.type)==="group")continue;let b;n.layerView=h,b=hBe(h)?await Sb(m,n,i):lBe(m)?vBe(m):cBe(m)?await bBe(m,n,i):(m==null?void 0:m.type)==="feature"?await wBe(m,n,i):(m==null?void 0:m.type)==="geojson"?await _Be(m,n,i):(m==null?void 0:m.type)==="graphics"?await xBe(m,n,i):(m==null?void 0:m.type)==="imagery"?SBe(m,i):(m==null?void 0:m.type)==="imagery-tile"?await MBe(m,n,i):(m==null?void 0:m.type)==="kml"?await IBe(m,n,i):(m==null?void 0:m.type)==="map-image"?$Be(m,n,i):(m==null?void 0:m.type)==="map-notes"?await EBe(n,i):(m==null?void 0:m.type)==="open-street-map"?TBe():(m==null?void 0:m.type)==="stream"?await CBe(m,n,i):(m==null?void 0:m.type)==="tile"?kBe(m,i):(m==null?void 0:m.type)==="vector-tile"?await ABe(m,n,i):(m==null?void 0:m.type)==="web-tile"?PBe(m):(m==null?void 0:m.type)==="wms"?LBe(m):(m==null?void 0:m.type)==="wmts"?OBe(m):await Sb(m,n,i),b&&(Array.isArray(b)?r.push(...b):(b.id=m.id,b.title=i.legendLayerNameMap[m.id]||m.title,b.opacity=m.opacity,b.minScale=m.minScale||0,b.maxScale=m.maxScale||0,xae(m)&&m.blendMode&&m.blendMode!=="normal"&&(b.blendMode=m.blendMode),r.push(b)))}if(o&&r.forEach(h=>{h.minScale=0,h.maxScale=0}),e.graphics&&e.graphics.length){const h=await Bp(null,e.graphics,t,i);h&&r.push(h)}return r}function vBe(e){return{culture:e.culture,key:e.key,type:"BingMaps"+(e.style==="aerial"?"Aerial":e.style==="hybrid"?"Hybrid":"Road")}}async function bBe(e,t,i){e.legendEnabled&&i.legendLayers.push({id:e.id});const r=t.layerView,n=t.printTemplate;let o;return!i.is11xService||r.filter?Bp(e,await y$(r),n,i):(o={type:"CSV"},e.write(o,{origin:"web-map"}),delete o.popupInfo,delete o.layerType,o.showLabels=n.showLabels&&e.labelsVisible,o)}async function Bp(e,t,i,r){var N,B;let n;const o=nBe(),c=sBe(),h=_ae(),m=rBe(),b=_ae();if(b.layerDefinition.name="textLayer",delete b.layerDefinition.drawingInfo,e){if(e.declaredClass==="esri.layers.FeatureLayer"||e.declaredClass==="esri.layers.StreamLayer"?o.layerDefinition.name=c.layerDefinition.name=h.layerDefinition.name=m.layerDefinition.name=r.legendLayerNameMap[e.id]||e.get("arcgisProps.title")||e.title:e.declaredClass==="esri.layers.GraphicsLayer"&&(t=e.graphics.items),e.renderer){const z=e.renderer.toJSON();o.layerDefinition.drawingInfo.renderer=z,c.layerDefinition.drawingInfo.renderer=z,h.layerDefinition.drawingInfo.renderer=z,m.layerDefinition.drawingInfo.renderer=z}if(i.showLabels&&e.labelsVisible&&typeof e.write=="function"){const z=(B=(N=e.write({},{origin:"web-map"}).layerDefinition)==null?void 0:N.drawingInfo)==null?void 0:B.labelingInfo;z&&(n=!0,o.layerDefinition.drawingInfo.labelingInfo=z,c.layerDefinition.drawingInfo.labelingInfo=z,h.layerDefinition.drawingInfo.labelingInfo=z,m.layerDefinition.drawingInfo.labelingInfo=z)}}let x;(e==null?void 0:e.renderer)||n||(delete o.layerDefinition.drawingInfo,delete c.layerDefinition.drawingInfo,delete h.layerDefinition.drawingInfo,delete m.layerDefinition.drawingInfo);const I=e==null?void 0:e.fieldsIndex,E=e==null?void 0:e.renderer;if(I){const z=new Set;n&&await Gge(z,e),E&&typeof E.collectRequiredFields=="function"&&await E.collectRequiredFields(z,I),x=Array.from(z);const q=I.fields.map(J=>J.toJSON());o.layerDefinition.fields=q,c.layerDefinition.fields=q,h.layerDefinition.fields=q,m.layerDefinition.fields=q}const k=t&&t.length;let P;for(let z=0;z<k;z++){const q=t[z]||t.getItemAt(z);if(q.visible===!1||!q.geometry||(P=q.toJSON(),P.hasOwnProperty("popupTemplate")&&delete P.popupTemplate,P.geometry&&P.geometry.z&&delete P.geometry.z,P.symbol&&P.symbol.outline&&P.symbol.outline.type==="esriCLS"&&!r.is11xService))continue;!r.is11xService&&P.symbol&&P.symbol.outline&&P.symbol.outline.color&&P.symbol.outline.color[3]&&(P.symbol.outline.color[3]=255);const J=e&&e.renderer&&("valueExpression"in e.renderer&&e.renderer.valueExpression||"hasVisualVariables"in e.renderer&&e.renderer.hasVisualVariables());if(!P.symbol&&e&&e.renderer&&J&&!r.is11xService){const X=e.renderer,Y=await X.getSymbolAsync(q);if(!Y)continue;P.symbol=Y.toJSON(),"hasVisualVariables"in X&&X.hasVisualVariables()&&iBe(P.symbol,{renderer:X,graphic:q,symbol:Y})}if(P.symbol&&(P.symbol.angle||delete P.symbol.angle,m$(P.symbol)?P.symbol=await f$(P.symbol,r):P.symbol.text&&delete P.attributes),(!i||!i.forceFeatureAttributes)&&(x==null?void 0:x.length)){const X={};x.forEach(Y=>{P.attributes&&P.attributes.hasOwnProperty(Y)&&(X[Y]=P.attributes[Y])}),P.attributes=X}q.geometry.type==="polygon"?o.featureSet.features.push(P):q.geometry.type==="polyline"?c.featureSet.features.push(P):q.geometry.type==="point"?P.symbol&&P.symbol.text?b.featureSet.features.push(P):h.featureSet.features.push(P):q.geometry.type==="multipoint"?m.featureSet.features.push(P):q.geometry.type==="extent"&&(P.geometry=es.fromExtent(q.geometry).toJSON(),o.featureSet.features.push(P))}const F=[o,c,m,h,b].filter(z=>z.featureSet.features.length>0);for(const z of F){const q=z.featureSet.features.every(J=>J.symbol);!q||i&&i.forceFeatureAttributes||z.featureSet.features.forEach(J=>{delete J.attributes}),q&&delete z.layerDefinition.drawingInfo,z.layerDefinition.drawingInfo&&z.layerDefinition.drawingInfo.renderer&&await Iae(z.layerDefinition.drawingInfo.renderer,r)}return F.length?{featureCollection:{layers:F},showLabels:n}:null}async function wBe(e,t,i){var E,k,P,F,N,B;let r;const n=e.renderer,o=parseFloat(i.cimVersion);if(((E=e.featureReduction)==null?void 0:E.type)==="binning"||((k=e.featureReduction)==null?void 0:k.type)==="cluster"&&(!i.is11xService||o<2.9)||(n==null?void 0:n.type)==="pie-chart"||(n==null?void 0:n.type)==="dot-density"&&(!i.is11xService||o<2.6))return Sb(e,t,i);e.legendEnabled&&i.legendLayers.push({id:e.id});const c=t.layerView,{printTemplate:h,view:m}=t,b=n&&("valueExpression"in n&&n.valueExpression||"hasVisualVariables"in n&&n.hasVisualVariables()),x=((P=e.source)==null?void 0:P.type)!=="feature-layer"&&((F=e.source)==null?void 0:F.type)!=="ogc-feature";if(!i.is11xService&&b||c.filter||x||!n||"field"in n&&n.field!=null&&(typeof n.field!="string"||!e.getField(n.field))){const z=await y$(c);r=await Bp(e,z,h,i)}else{if(r={id:(I=e.write()).id,title:I.title,opacity:I.opacity,minScale:I.minScale,maxScale:I.maxScale,url:I.url,layerType:I.layerType,customParameters:I.customParameters,layerDefinition:I.layerDefinition},r.showLabels=h.showLabels&&e.labelsVisible,sx(r,e),((B=(N=r.layerDefinition)==null?void 0:N.drawingInfo)==null?void 0:B.renderer)&&(delete r.layerDefinition.minScale,delete r.layerDefinition.maxScale,await Iae(r.layerDefinition.drawingInfo.renderer,i),"visualVariables"in n&&n.visualVariables&&n.visualVariables[0])){const q=n.visualVariables[0];if(q.type==="size"&&q.maxSize&&typeof q.maxSize!="number"&&q.minSize&&typeof q.minSize!="number"){const J=TZ(q,m.scale);r.layerDefinition.drawingInfo.renderer.visualVariables[0].minSize=J.minSize,r.layerDefinition.drawingInfo.renderer.visualVariables[0].maxSize=J.maxSize}}const z=FOe(c);z&&(r.layerDefinition||(r.layerDefinition={}),r.layerDefinition.definitionExpression=r.layerDefinition.definitionExpression?`(${r.layerDefinition.definitionExpression}) AND (${z})`:z)}var I;return r}async function _Be(e,t,i){var r,n;return((r=e.featureReduction)==null?void 0:r.type)==="binning"||((n=e.featureReduction)==null?void 0:n.type)==="cluster"?Sb(e,t,i):(e.legendEnabled&&i.legendLayers.push({id:e.id}),Bp(e,await y$(t.layerView),t.printTemplate,i))}async function xBe(e,{printTemplate:t},i){return Bp(e,null,t,i)}function SBe(e,t){e.legendEnabled&&t.legendLayers.push({id:e.id});const i={layerType:(r=e.write()).layerType,customParameters:r.customParameters};var r;if(i.bandIds=e.bandIds,i.compressionQuality=e.compressionQuality,i.format=e.format,i.interpolation=e.interpolation,(e.mosaicRule||e.definitionExpression)&&(i.mosaicRule=e.exportImageServiceParameters.mosaicRule.toJSON()),e.renderingRule||e.renderer)if(t.is11xService)e.renderingRule&&(i.renderingRule=e.renderingRule.toJSON()),e.renderer&&(i.layerDefinition=i.layerDefinition||{},i.layerDefinition.drawingInfo=i.layerDefinition.drawingInfo||{},i.layerDefinition.drawingInfo.renderer=e.renderer.toJSON());else{const n=e.exportImageServiceParameters.combineRendererWithRenderingRule();n&&(i.renderingRule=n.toJSON())}return sx(i,e),i}async function MBe(e,t,i){var o;if(((o=e.renderer)==null?void 0:o.type)==="flow")return Sb(e,t,i);e.legendEnabled&&i.legendLayers.push({id:e.id});const r={bandIds:(n=e.write()||{}).bandIds,customParameters:n.customParameters,interpolation:n.interpolation,layerDefinition:n.layerDefinition};var n;return r.layerType="ArcGISImageServiceLayer",sx(r,e),r}async function IBe(e,t,i){const r=t.printTemplate;if(i.is11xService){const n={type:"kml"};return e.write(n,{origin:"web-map"}),delete n.layerType,n.url=zs(e.url),n}{const n=[],o=t.layerView;o.allVisibleMapImages.forEach((m,b)=>{const x={id:`${e.id}_image${b}`,type:"image",title:e.id,minScale:e.minScale||0,maxScale:e.maxScale||0,opacity:e.opacity,extent:m.extent};m.href.substr(0,22)==="data:image/png;base64,"?x.imageData=m.href.substr(22):x.url=m.href,n.push(x)});const c=[...o.allVisiblePoints.items,...o.allVisiblePolylines.items,...o.allVisiblePolygons.items],h=K({id:e.id},await Bp(null,c,r,i));return n.push(h),n}}function $Be(e,{view:t},i){let r;const n={id:e.id,subLayerIds:[]};let o=[];const c=t.scale,h=b=>{const x=c===0,I=b.minScale===0||c<=b.minScale,E=b.maxScale===0||c>=b.maxScale;if(b.visible&&(x||I&&E))if(b.sublayers)b.sublayers.forEach(h);else{const k=b.toExportImageJSON(),P={id:b.id,name:b.title,layerDefinition:{drawingInfo:k.drawingInfo,definitionExpression:k.definitionExpression,source:k.source}};o.unshift(P),n.subLayerIds.push(b.id)}};var m;return e.sublayers&&e.sublayers.forEach(h),o.length&&(o=o.map(({id:b,name:x,layerDefinition:I})=>({id:b,name:x,layerDefinition:I})),r={layerType:(m=e.write()).layerType,customParameters:m.customParameters},r.layers=o,r.visibleLayers=e.capabilities.exportMap.supportsDynamicLayers?void 0:n.subLayerIds,sx(r,e),e.legendEnabled&&i.legendLayers.push(n)),r}async function EBe({layerView:e,printTemplate:t},i){const r=[],n=e.layer;if(H(n.featureCollections))for(const o of n.featureCollections){const c=await Bp(o,o.source,t,i);c&&r.push(...c.featureCollection.layers)}else if(H(n.sublayers))for(const o of n.sublayers){const c=await Bp(null,o.graphics,t,i);c&&r.push(...c.featureCollection.layers)}return{featureCollection:{layers:r}}}function TBe(){return{type:"OpenStreetMap"}}async function Sb(e,{printTemplate:t,view:i},r){const n={type:"image"},o={format:"png",ignoreBackground:!0,layers:[e],rotation:0},c=r.ssExtent||i.extent.clone();let h=96,m=!0,b=!0;if(t.exportOptions){const E=t.exportOptions;E.dpi>0&&(h=E.dpi),E.width>0&&(m=E.width%2==i.width%2),E.height>0&&(b=E.height%2==i.height%2)}if(t.layout==="map-only"&&t.scalePreserved&&(!t.outScale||t.outScale===i.scale)&&h===96&&(!m||!b)&&(o.area={x:0,y:0,width:i.width,height:i.height},m||(o.area.width-=1),b||(o.area.height-=1),!r.ssExtent)){const E=i.toMap(yn(o.area.width,o.area.height));c.ymin=E.y,c.xmax=E.x,r.ssExtent=c}n.extent=c.clone()._normalize(!0).toJSON();const x=await i.takeScreenshot(o),{data:I}=fC(x.dataUrl);return n.imageData=I,n}async function CBe(e,{layerView:t,printTemplate:i},r){return e.legendEnabled&&r.legendLayers.push({id:e.id}),Bp(e,await y$(t),i,r)}function kBe(e,t){e.legendEnabled&&t.legendLayers.push({id:e.id});const i={layerType:(r=e.write()).layerType,customParameters:r.customParameters};var r;return sx(i,e),i}async function ABe(e,t,i){if(i.is11xService&&e.serviceUrl&&e.styleUrl){const r=Z9(e.styleUrl,e.apiKey),n=Z9(e.serviceUrl,e.apiKey);if(!r&&!n||i.cimVersion!=="2.1.0"){const o={type:"VectorTileLayer"};return o.styleUrl=zs(e.styleUrl),o.token=r,n!==r&&(o.additionalTokens=[{url:e.serviceUrl,token:n}]),o}}return Sb(e,t,i)}function PBe(e){const t={type:"WebTiledLayer",urlTemplate:e.urlTemplate.replace(/\${/g,"{"),credits:e.copyright};return e.subDomains&&e.subDomains.length>0&&(t.subDomains=e.subDomains),t}function LBe(e){let t;const i=[],r=n=>{n.visible&&(n.sublayers?n.sublayers.forEach(r):n.name&&i.unshift(n.name))};return e.sublayers&&e.sublayers.forEach(r),i.length&&(t={type:"wms",customLayerParameters:e.customLayerParameters,customParameters:e.customParameters,transparentBackground:e.imageTransparency,visibleLayers:i,url:zs(e.url),version:e.version}),t}function OBe(e){const t=e.activeLayer;return{type:"wmts",customLayerParameters:e.customLayerParameters,customParameters:e.customParameters,format:t.imageFormat,layer:t.id,style:t.styleId,tileMatrixSet:t.tileMatrixSetId,url:zs(e.url)}}function sx(e,t){t.url&&(e.url=zs(e.url||t.url),e.token=Z9(e.url,t.apiKey))}async function f$(e,t){var c;t.canvas||(t.canvas=document.createElement("canvas"));const i=1024;t.canvas.width=i,t.canvas.height=i;const r=t.canvas.getContext("2d");let n,o;if(e.path){const h=new Path2D(e.path);h.closePath(),r.fillStyle=Array.isArray(e.color)?`rgba(${e.color[0]},${e.color[1]},${e.color[2]},${e.color[3]/255})`:"rgb(0,0,0)",r.fill(h);const m=oBe(r);if(!m)return null;r.clearRect(0,0,i,i);const b=or(e.size)/Math.max(m.width,m.height);r.scale(b,b);const x=i/b,I=x/2-m.width/2-m.x,E=x/2-m.height/2-m.y;if(r.translate(I,E),Array.isArray(e.color)&&r.fill(h),((c=e.outline)==null?void 0:c.width)&&Array.isArray(e.outline.color)){const P=e.outline;r.lineWidth=or(P.width)/b,r.lineJoin="round",r.strokeStyle=`rgba(${P.color[0]},${P.color[1]},${P.color[2]},${P.color[3]/255})`,r.stroke(h),m.width+=r.lineWidth,m.height+=r.lineWidth}m.width*=b,m.height*=b;const k=r.getImageData(i/2-m.width/2,i/2-m.height/2,Math.ceil(m.width),Math.ceil(m.height));n=k.width,o=k.height,r.canvas.width=n,r.canvas.height=o,r.putImageData(k,0,0)}else{const h=e.contentType==="image/svg+xml"?"data:image/svg+xml;base64,"+e.imageData:e.url,m=(await Nt(h,{responseType:"image"})).data;n=or(e.width),o=or(e.height),r.canvas.width=n,r.canvas.height=o,r.drawImage(m,0,0,r.canvas.width,r.canvas.height)}return{type:"esriPMS",imageData:r.canvas.toDataURL("image/png").substr(22),angle:e.angle,contentType:"image/png",height:$n(o),width:$n(n),xoffset:e.xoffset,yoffset:e.yoffset}}async function Iae(e,t){const i=e.type;if(i==="simple"&&m$(e.symbol))e.symbol=await f$(e.symbol,t);else if(i==="uniqueValue"||i==="classBreaks"){m$(e.defaultSymbol)&&(e.defaultSymbol=await f$(e.defaultSymbol,t));const r=e[i==="uniqueValue"?"uniqueValueInfos":"classBreakInfos"];if(r)for(const n of r)m$(n.symbol)&&(n.symbol=await f$(n.symbol,t))}}async function y$(e){return e.queryFeatures(e.createQuery()).then(t=>t.features)}function RBe(e){return e.gpMetadata&&e.gpMetadata.executionType?pBe.fromJSON(e.gpMetadata.executionType):"sync"}function m$(e){return e&&(e.path||e.contentType==="image/svg+xml"||e.url&&e.url.endsWith(".svg"))}let e0=class extends ke{constructor(e){super(e),this.description=null,this.format=null,this.label=null,this.layout=null,this.layoutOptions=null}};g([w()],e0.prototype,"description",void 0),g([w({json:{read:lF}})],e0.prototype,"format",void 0),g([w()],e0.prototype,"label",void 0),g([w({json:{read:d$}})],e0.prototype,"layout",void 0),g([w()],e0.prototype,"layoutOptions",void 0),e0=g([te("esri.widgets.Print.CustomTemplate")],e0);const $ae=e0,FBe=6e4,Eae=Xe.ofType($ae);function NBe(e){e.layoutOptions||(e.layoutOptions={}),e.layoutOptions.customTextElements||(e.layoutOptions.customTextElements=[]);const t="date";if(!e.layoutOptions.customTextElements.find(i=>t in i)){const{customTextElements:i}=e.layoutOptions;let r=Pa(Date.now(),fg("short-date"));o1e()==="ar"&&(r="\u200F"+r),i.push({date:r})}}let Jn=class extends Xo{constructor(e){super(e),this.allowedFormats="all",this.allowedLayouts="all",this.defaultTemplates=new Eae,this.extraParameters=null,this.includeDefaultTemplates=!0,this.error=null,this.portal=nn.getDefault(),this.printServiceUrl=null,this.templatesInfo=null,this.updateDelay=1e3,this.view=null,this.templateCustomTextElements=null,this.print=this.print.bind(this)}destroy(){this.view=null}get effectivePrintServiceUrl(){var e;return(e=this.printServiceUrl)!=null?e:null}get effectiveTemplateCustomTextElements(){if(!this._serviceTemplateCustomTextElements)return{};const e=_e(this._serviceTemplateCustomTextElements);return this.templateCustomTextElements&&Object.keys(this.templateCustomTextElements).forEach(t=>{const i=e[t];if(i){const r=this.templateCustomTextElements[t];i.forEach(n=>{const[o]=Object.entries(n)[0];r.find(c=>{const[h,m]=Object.entries(c)[0];o===h&&(n[o]=m)})})}}),Object.freeze(e)}get state(){return this.loadStatus==="loading"?"initializing":this.error||this.loadStatus==="failed"?"error":this.get("view.ready")&&this.loadStatus==="loaded"?"ready":"disabled"}async load(e){return this.addResolvingPromise(this._loadResources(e).catch(t=>this.error=t)),this}async print(e){const{view:t,extraParameters:i,updateDelay:r}=this;if(!t)throw new ue("print:view-required","view is not set");NBe(e);const n=new zOe({view:t,template:e,extraParameters:i,updateDelay:r});try{return await dBe(this.effectivePrintServiceUrl,n)}catch(o){throw new ue("print:export-error","An error occurred while exporting the web map.",{error:o})}}toPrintTemplate({attributionEnabled:e,author:t,copyright:i,customTextElements:r,dpi:n,forceFeatureAttributes:o,format:c,height:h,layout:m,legendEnabled:b,northArrowEnabled:x,scale:I,scaleEnabled:E,title:k,width:P}){const F=new Bie({attributionVisible:e,forceFeatureAttributes:o,format:c,layout:m,layoutOptions:{authorText:t||"",copyrightText:i||"",customTextElements:r,titleText:k||""},outScale:I,scalePreserved:E});P&&(F.exportOptions.width=P),h&&(F.exportOptions.height=h),n&&(F.exportOptions.dpi=n),b||(F.layoutOptions.legendLayers=[]);const N=this.templateToNorthArrowInfo[m];return N&&(N.visible===x||(F.layoutOptions.elementOverrides={[N.name]:{visible:x}})),F}async _loadResources(e){var r,n;let t=[];const{printServiceUrl:i}=this;if(!i){if(this.destroyed)return;const{portal:o}=this;try{await o.load(e)}catch{throw new ue("print:could-not-load-portal","Cannot load print resource information from portal",{url:this.effectivePrintServiceUrl})}const c=(r=o.helperServices)==null?void 0:r.printTask;c&&(this._set("effectivePrintServiceUrl",c.url),t=((n=c==null?void 0:c.templates)!=null?n:[]).map(h=>$ae.fromJSON(h)))}if(t.length>0&&this.defaultTemplates.addMany(t),this.effectivePrintServiceUrl.toLowerCase().split("/").indexOf("gpserver")===-1)throw new ue("print:invalid-print-service-url","Can't fetch print templates information from provided URL",{url:this.effectivePrintServiceUrl});this._processLayoutTemplateInfos(await this._getLayoutTemplatesInfo(e)),await this._loadServiceDescription(e)}async _loadServiceDescription(e){const t=await this._getPrintTemplatesFromService(e);this._set("templatesInfo",t)}async _getLayoutTemplatesInfo(e){let t=[];const i=async r=>{const n=this.effectivePrintServiceUrl.replace(/(\/GPServer\/).+/i,`$1${encodeURI(r)}`);return(await bae(n,null,null,Ht(e))).results[0].value};try{t=await i("Get Layout Templates Info Task")}catch{}if(!t||t.length<1)try{t=await i("Get Layout Templates Info")}catch{}return t}_processLayoutTemplateInfos(e){const t={},i={};e.forEach(({layoutTemplate:r,layoutOptions:{customTextElements:n,mapSurroundInfos:o}})=>{const c=d$(r);t[c]=n,o&&(i[c]=o.find(h=>h.type==="CIMMarkerNorthArrow"))}),this.templateCustomTextElements=Object.freeze(t),this.templateToNorthArrowInfo=i}async _getPrintTemplatesFromService(e){return Nt(this.effectivePrintServiceUrl,Ce(K({},e),{query:{f:"json"},timeout:FBe})).then(t=>{const i=t&&t.data,r=i&&i.parameters;let n=null,o=null;return r.forEach(c=>{let h,m=c.choiceList&&c.choiceList.slice();m&&m.length&&c.defaultValue&&(h=m.indexOf(c.defaultValue)),h>-1&&(m.splice(h,1),m.unshift(c.defaultValue));const b=(x,I)=>{const E=I==="all"?x:x.filter(k=>I.includes(k));return E.length===0?x:E};if(c.name==="Format"){const x=b(m.map(lF),this.allowedFormats),I=lF(c.defaultValue);n={defaultValue:x.includes(I)?I:x[0],choiceList:x}}else if(c.name==="Layout_Template"){let x,I;m=m.filter(P=>P.toLowerCase()!=="map_only"),m.some((P,F)=>{const N=P.toLowerCase();return N.includes("letter")&&N.includes("landscape")?(x=F,!0):!(!N.includes("a4")||!N.includes("landscape"))&&(x=F,!1)}),x&&(I=m[x],m.splice(x,1),m.unshift(I));const E=b(m.map(d$),this.allowedLayouts),k=d$(c.defaultValue);o={defaultValue:E.includes(k)?k:E[0],choiceList:E}}}),this.error=null,{format:n,layout:o}}).catch(t=>{throw new ue("print:unavailable-service-info","Can't fetch templates info from service",{error:t})})}};g([w()],Jn.prototype,"_serviceTemplateCustomTextElements",void 0),g([w()],Jn.prototype,"allowedFormats",void 0),g([w()],Jn.prototype,"allowedLayouts",void 0),g([w({type:Eae})],Jn.prototype,"defaultTemplates",void 0),g([w()],Jn.prototype,"extraParameters",void 0),g([w()],Jn.prototype,"includeDefaultTemplates",void 0),g([w({readOnly:!0})],Jn.prototype,"effectivePrintServiceUrl",null),g([w()],Jn.prototype,"effectiveTemplateCustomTextElements",null),g([w()],Jn.prototype,"error",void 0),g([w({type:nn})],Jn.prototype,"portal",void 0),g([w()],Jn.prototype,"printServiceUrl",void 0),g([w({readOnly:!0})],Jn.prototype,"state",null),g([w({readOnly:!0})],Jn.prototype,"templatesInfo",void 0),g([w()],Jn.prototype,"updateDelay",void 0),g([w()],Jn.prototype,"view",void 0),g([w()],Jn.prototype,"templateCustomTextElements",void 0),g([w()],Jn.prototype,"templateToNorthArrowInfo",void 0),Jn=g([te("esri.widgets.Print.PrintViewModel")],Jn);const Tae=Jn;let ms=class extends Ye{constructor(e){super(e),this.attributionEnabled=!0,this.author=null,this.copyright=null,this.customTextElements=null,this.dpi=96,this.fileName=null,this.forceFeatureAttributes=!1,this.format=null,this.height=null,this.layout=null,this.legendEnabled=!0,this.northArrowEnabled=!1,this.scale=null,this.scaleEnabled=!1,this.title=null,this.width=null}};g([w()],ms.prototype,"attributionEnabled",void 0),g([w()],ms.prototype,"author",void 0),g([w()],ms.prototype,"copyright",void 0),g([w()],ms.prototype,"customTextElements",void 0),g([w()],ms.prototype,"dpi",void 0),g([w()],ms.prototype,"fileName",void 0),g([w()],ms.prototype,"forceFeatureAttributes",void 0),g([w()],ms.prototype,"format",void 0),g([w()],ms.prototype,"height",void 0),g([w()],ms.prototype,"layout",void 0),g([w()],ms.prototype,"legendEnabled",void 0),g([w()],ms.prototype,"northArrowEnabled",void 0),g([w()],ms.prototype,"scale",void 0),g([w()],ms.prototype,"scaleEnabled",void 0),g([w()],ms.prototype,"title",void 0),g([w()],ms.prototype,"width",void 0),ms=g([te("esri.widgets.Print.TemplateOptions")],ms);const Cae=ms,kae=Xe.ofType(pae),Aae="MAP_ONLY";var eh;(function(e){e.layout="layoutTab",e.mapOnly="mapOnlyTab"})(eh||(eh={}));const ze={base:"esri-print",headerTitle:"esri-print__header-title",inputText:"esri-print__input-text",layoutTabList:"esri-print__layout-tab-list",layoutTab:"esri-print__layout-tab",layoutSection:"esri-print__layout-section",mapOnlySection:"esri-print__map-only-section",scaleInput:"esri-print__scale-input",templateList:"esri-print__template-list",templateListScroller:"esri-print__template-list-scroller",templateListFooter:"esri-print__template-list-footer",loader:"esri-print__loader",advancedOptionsButton:"esri-print__advanced-options-button",advancedOptionsButtonContainer:"esri-print__advanced-options-button-container",advancedOptionsButtonTitle:"esri-print__advanced-options-button-title",advancedOptionsButtonIconOpened:"esri-print__advanced-options-button-icon--opened",advancedOptionsButtonIconClosed:"esri-print__advanced-options-button-icon--closed",advancedOptionsButtonIconClosed_RTL:"esri-print__advanced-options-button-icon--closed-rtl",refreshButton:"esri-print__refresh-button",swapButton:"esri-print__swap-button",linkButton:"esri-print__link-button",printButton:"esri-print__export-button",templateButton:"esri-print__template-button",formSectionContainer:"esri-print__form-section-container",advancedOptionsSection:"esri-print__advanced-options-section",advancedOptionsContainer:"esri-print__advanced-options-container",authorInfoContainer:"esri-print__author-info-container",copyrightInfoContainer:"esri-print__copyright-info-container",exportedFilesContainer:"esri-print__export-panel-container",exportedFilesTitle:"esri-print__export-title",exportedFile:"esri-print__exported-file",exportedFileLink:"esri-widget__anchor esri-print__exported-file-link",exportedFileLinkTitle:"esri-print__exported-file-link-title",heightContainer:"esri-print__height-container",legendInfoContainer:"esri-print__legend-info-container",printWidgetContainer:"esri-print__container",panelContainer:"esri-print__panel-container",scaleInfoContainer:"esri-print__scale-info-container",scaleInputContainer:"esri-print__scale-input-container",sizeContainer:"esri-print__size-container",widthContainer:"esri-print__width-container",widget:"esri-widget",panel:"esri-widget--panel",widgetButton:"esri-widget--button",button:"esri-button",buttonSecondary:"esri-button--secondary",buttonTertiary:"esri-button--tertiary",select:"esri-select",input:"esri-input",disabled:"esri-disabled",anchorDisabled:"esri-widget__anchor--disabled",buttonDisabled:"esri-button--disabled",panelError:"esri-print__panel--error",exportedFileError:"esri-print__exported-file--error",hide:"esri-hidden",rotate:"esri-rotating",anchor:"esri-widget__anchor",menu:"esri-menu",menuList:"esri-menu__list",menuItem:"esri-menu__list-item",menuItemFocus:"esri-menu__list-item--focus",menuHeader:"esri-menu__header",iconCheckMark:"esri-icon-check-mark",iconDownload:"esri-icon-download",iconLaunchLink:"esri-icon-launch-link-external",iconError:"esri-icon-error",iconPrinter:"esri-icon-printer",iconRightTriangleArrow:"esri-icon-right-triangle-arrow",iconLeftTriangleArrow:"esri-icon-left-triangle-arrow",iconDownArrow:"esri-icon-down-arrow",iconRefresh:"esri-icon-refresh",iconSpinner:"esri-icon-loading-indicator",iconSwap:"esri-icon-swap",iconLinked:"esri-icon-link-horizontal",iconUnlinked:"esri-icon-unlocked-link-horizontal",widgetIcon:"esri-icon-printer"},Pae="User sets an invalid layout, resetting it to the default valid one...",Lae="User sets an invalid format, resetting it to the default valid one...";function DBe(e){const t=8.3333,i=11.4583;return{width:Math.round(e*t),height:Math.round(e*i)}}function jBe(e){return!isNaN(e)&&e>0}function g$(e){return(e==null?void 0:e.toUpperCase())===Aae}let gs=class extends ki{constructor(e,t){super(e,t),this._activeTabFocusRequested=!1,this._advancedOptionsVisibleForLayout=!1,this._advancedOptionsVisibleForMapOnly=!1,this._awaitingServerResponse=!1,this._exportedFileNameMap={},this._focusedTemplateIndex=0,this._layoutTabSelected=!0,this._pendingExportScroll=!1,this._rootNode=null,this._selectTemplateNode=null,this._templateListPopover=new Kne({owner:this,placement:"top",offset:[0,-100],anchorElement:()=>this._selectTemplateNode,renderContentFunction:this.renderTemplateList}),this.exportedLinks=new kae,this.headingLevel=3,this.iconClass=ze.widgetIcon,this.templateOptions=new Cae,this.viewModel=new Tae,this.handleTemplateListCreation=i=>i.focus(),this.handleTemplateChildBlur=i=>{var n;((n=i.relatedTarget)==null?void 0:n.closest(`.${ze.templateList}`))||this.handleCloseTemplateSelection()},this.handleCloseTemplateSelection=()=>{this._focusedTemplateIndex=0,this._templateListPopover.open=!1,this._selectTemplateNode.focus()},this.handleSelectTemplateClick=()=>{this._focusedTemplateIndex=0,this._templateListPopover.open=!0},this.handleTemplateListClick=i=>{const r=i.target;this.applyTemplate(r["data-template"])},this.handleTemplateListKeyDown=i=>{if(Hg(i.key))return this.applyTemplate(this.viewModel.defaultTemplates.getItemAt(this._focusedTemplateIndex)),void i.preventDefault();if(i.key==="ArrowDown"||i.key==="ArrowUp"){const{defaultTemplates:r}=this.viewModel,n=i.key==="ArrowDown"?1:-1,o=(this._focusedTemplateIndex+n)%r.length;this._focusedTemplateIndex=o<0?r.length-1:o;const c=i.currentTarget;Zq(c.querySelectorAll(`.${ze.menuItem}`)[this._focusedTemplateIndex],c.parentElement),i.preventDefault()}i.key==="Escape"&&this.handleCloseTemplateSelection()},this._removeLink=i=>{const r=i.currentTarget["data-item"];r&&r.state==="error"&&this.exportedLinks.remove(r)},this._handleLinkClick=i=>{const r=i.currentTarget,{href:n}=r,o=Z9(this.viewModel.effectivePrintServiceUrl);if(!o)return;if(!i.isTrusted)return void i.stopPropagation();i.preventDefault();const c=new URL(n);c.searchParams.set("token",o),r.href=c.href,r.click(),r.href=n},this._focusOnTabChange=this._focusOnTabChange.bind(this)}initialize(){this.addHandles([we(()=>{var r;return(r=this.viewModel)==null?void 0:r.templatesInfo},r=>{const{format:n,layout:o}=this.templateOptions;if(r){const c=o===r.layout.defaultValue||g$(o)||r.layout.choiceList&&r.layout.choiceList.includes(o),h=n===r.format.defaultValue||r.format.choiceList&&r.format.choiceList.includes(n);c||(o&&$e.getLogger(this.declaredClass).warn(Pae),this.templateOptions.layout=r.layout.defaultValue),h||(n&&$e.getLogger(this.declaredClass).warn(Lae),this.templateOptions.format=r.format.defaultValue),g$(o)&&(this._layoutTabSelected=!1)}},St),we(()=>{var r;return(r=this.templateOptions)==null?void 0:r.format},r=>{const{viewModel:{templatesInfo:n}}=this;if(n&&r){let o=!1;n.format.choiceList&&n.format.choiceList.forEach(c=>{c.toUpperCase()===r.toUpperCase()&&(this.templateOptions.format=c,o=!0)}),o||(this.templateOptions.format=n.format.defaultValue,$e.getLogger(this.declaredClass).warn(Lae)),this.scheduleRender()}},St),we(()=>{var r;return(r=this.templateOptions)==null?void 0:r.layout},r=>{const{viewModel:{templatesInfo:n}}=this;if(n&&r){this._layoutTabSelected=!g$(r);let o=!this._layoutTabSelected;o||n.layout.choiceList&&n.layout.choiceList.forEach(h=>{h.toUpperCase()===r.toUpperCase()&&(this.templateOptions.layout=h,o=!0)}),o||(this.templateOptions.layout=n.layout.defaultValue,$e.getLogger(this.declaredClass).warn(Pae));const c=this.viewModel.effectiveTemplateCustomTextElements[this.templateOptions.layout];this.templateOptions.customTextElements=c?_e(c):null,this.scheduleRender()}},St),we(()=>{var r;return(r=this.templateOptions)==null?void 0:r.dpi},r=>{r<=0?this.templateOptions.dpi=1:this.scheduleRender()},St),we(()=>{var r,n;return(n=(r=this.viewModel)==null?void 0:r.view)==null?void 0:n.scale},r=>{const{scale:n,scaleEnabled:o}=this.templateOptions;o&&n||(this.templateOptions.scale=r)},St)]);const{height:e,width:t}=this.templateOptions;this.templateOptions.width=t||800,this.templateOptions.height=e||1100;const i=setTimeout(()=>{this._awaitingServerResponse=!0,this.scheduleRender()},500);this.viewModel.load().then(()=>clearTimeout(i))}get allowedFormats(){return this.viewModel.allowedFormats}set allowedFormats(e){this.viewModel.allowedFormats=e}get allowedLayouts(){return this.viewModel.allowedLayouts}set allowedLayouts(e){this.viewModel.allowedLayouts=e}get error(){return this.viewModel.error}get extraParameters(){return this.viewModel.extraParameters}set extraParameters(e){this.viewModel.extraParameters=e}get includeDefaultTemplates(){return this.viewModel.includeDefaultTemplates}set includeDefaultTemplates(e){this.viewModel.includeDefaultTemplates=e}get label(){var e,t;return(t=(e=this.messages)==null?void 0:e.widgetLabel)!=null?t:""}set label(e){this._overrideIfSome("label",e)}get portal(){return this.viewModel.portal}set portal(e){this.viewModel.portal=e}get printServiceUrl(){return this.viewModel.printServiceUrl}set printServiceUrl(e){this.viewModel.printServiceUrl=e}get templateCustomTextElements(){return this.viewModel.templateCustomTextElements}set templateCustomTextElements(e){this.viewModel.templateCustomTextElements=e}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}render(){const{attributionEnabled:e,author:t,copyright:i,dpi:r,format:n,height:o,layout:c,legendEnabled:h,northArrowEnabled:m,scaleEnabled:b,scale:x,width:I}=this.templateOptions,E=this.get("viewModel.state")!=="ready",k=this.renderTitleOrFileNameSection(),{includeDefaultTemplates:P,messages:F,viewModel:N}=this,B=this.get("viewModel.templatesInfo.format.choiceList")||[],z=B.length>0?B.map(Gt=>j("option",{key:Gt,selected:Gt===n,value:Gt},Gt.toUpperCase())):j("option",{key:"format-default-option"},F.formatDefaultOption),q=j("div",{class:ze.formSectionContainer},j("label",null,F.fileFormatTitle,j("select",{class:ze.select,onchange:this._updateFromOption,"data-target-property":"format",bind:this},z))),J=this.get("viewModel.templatesInfo.layout.choiceList")||[],X=J.length>0?J.map(Gt=>{const pi=Gt===c,ei=F[Gt]||Gt;return j("option",{key:Gt,selected:pi,value:Gt},ei)}):j("option",{key:"layout-default-option"},F.layoutDefaultOption),Y=j("div",{class:ze.formSectionContainer},j("label",null,F.layoutTitle,j("select",{class:ze.select,onchange:this._updateFromOption,"data-target-property":"layout",bind:this},X))),ae=j("div",{class:ze.formSectionContainer},j("label",null,F.dpi,j("input",{type:"number",class:this.classes(ze.inputText,ze.input),"data-input-name":"dpi",onchange:this._handleDPIChange,value:`${r}`,min:"1",tabIndex:0,bind:this}))),he=j("div",{class:this.classes(ze.scaleInfoContainer,ze.formSectionContainer)},j("label",null,j("input",{"data-option-name":"scaleEnabled",checked:b,type:"checkbox",tabIndex:0,onchange:this._toggleInputValue,bind:this}),F.scale),j("div",{class:ze.scaleInputContainer},j("input",{"aria-label":F.scaleLabel,"aria-valuenow":`${x}`,role:"spinbutton",type:"number",class:this.classes(ze.inputText,ze.input,ze.scaleInput),tabIndex:0,"data-input-name":"scale",onchange:this._updateInputValue,disabled:!b,value:`${x}`,bind:this}),j("button",{type:"button","aria-label":F.reset,class:this.classes(ze.widgetButton,ze.refreshButton,ze.iconRefresh),tabIndex:0,onclick:this._resetToCurrentScale,bind:this}))),fe=this._advancedOptionsVisibleForLayout?j("div",{"aria-labelledby":`${this.id}__advancedOptionsForLayout`,class:ze.advancedOptionsContainer},he,j("div",{class:this.classes(ze.authorInfoContainer,ze.formSectionContainer)},j("label",null,F.author,j("input",{type:"text",value:t,class:this.classes(ze.inputText,ze.input),tabIndex:0,"data-input-name":"author",onchange:this._updateInputValue,bind:this}))),j("div",{class:this.classes(ze.copyrightInfoContainer,ze.formSectionContainer)},j("label",null,F.copyright,j("input",{type:"text",class:this.classes(ze.inputText,ze.input),tabIndex:0,value:i,"data-input-name":"copyright",onchange:this._updateInputValue,bind:this}))),ae,j("div",{class:this.classes(ze.legendInfoContainer,ze.formSectionContainer)},j("label",null,j("input",{type:"checkbox","data-option-name":"legendEnabled",tabIndex:0,checked:h,onchange:this._toggleInputValue,bind:this}),F.legend)),this.viewModel.templateToNorthArrowInfo[c]?j("div",{class:this.classes(ze.legendInfoContainer,ze.formSectionContainer),key:"north-arrow"},j("label",null,j("input",{type:"checkbox","data-option-name":"northArrowEnabled",tabIndex:0,checked:m,onchange:this._toggleInputValue,bind:this}),F.northArrow)):null,this.renderCustomTextElementSection()):null,ye=this._advancedOptionsVisibleForMapOnly?j("div",{"aria-labelledby":`${this.id}__advancedOptionsForMapOnly`,class:ze.advancedOptionsContainer},he,ae,j("div",{class:ze.formSectionContainer},j("label",null,j("input",{"data-option-name":"attributionEnabled",type:"checkbox",onchange:this._toggleInputValue,tabIndex:0,checked:e,bind:this}),F.attribution)),this.renderCustomTextElementSection()):null,xe=this._layoutTabSelected?j("section",{key:"esri-print__layoutContent",id:`${this.id}__layoutContent`,"aria-labelledby":`${this.id}__layoutTab`,class:ze.layoutSection,role:"tabpanel","aria-selected":this._layoutTabSelected.toString()},j("div",{class:ze.panelContainer},k,Y,this._layoutTabSelected?q:null),j("div",{class:this.classes(ze.panelContainer,ze.advancedOptionsSection)},j("button",{"aria-label":F.advancedOptions,"aria-expanded":this._advancedOptionsVisibleForLayout?"true":"false",class:ze.advancedOptionsButton,onclick:this._showAdvancedOptions,bind:this,type:"button"},j("div",{class:ze.advancedOptionsButtonContainer},j("span",{"aria-hidden":"true",class:this.classes(ze.iconRightTriangleArrow,ze.advancedOptionsButtonIconClosed)}),j("span",{"aria-hidden":"true",class:this.classes(ze.iconLeftTriangleArrow,ze.advancedOptionsButtonIconClosed_RTL)}),j("span",{"aria-hidden":"true",class:this.classes(ze.iconDownArrow,ze.advancedOptionsButtonIconOpened)}),j("span",{class:ze.advancedOptionsButtonTitle},F.advancedOptions))),fe)):j("section",{key:"esri-print__mapOnlyContent",id:`${this.id}__mapOnlyContent`,"aria-selected":(!this._layoutTabSelected).toString(),"aria-labelledby":`${this.id}__mapOnlyTab`,class:ze.mapOnlySection,role:"tabpanel"},j("div",{class:ze.panelContainer},k,this._layoutTabSelected?null:q,j("div",{class:this.classes(ze.sizeContainer,ze.formSectionContainer)},j("div",{class:ze.widthContainer},j("label",null,F.width,j("input",{type:"number",class:this.classes(ze.inputText,ze.input),"data-input-name":"width",onchange:this._updateInputValue,value:`${I}`,tabIndex:0,bind:this}))),j("div",{class:ze.heightContainer},j("label",null,F.height,j("input",{type:"number",class:this.classes(ze.inputText,ze.input),"data-input-name":"height",onchange:this._updateInputValue,value:`${o}`,tabIndex:0,bind:this}))),j("button",{type:"button","aria-label":F.swap,class:this.classes(ze.widgetButton,ze.swapButton,ze.iconSwap),onclick:this._switchInput,tabIndex:0,bind:this})),j("div",{class:this.classes(ze.panelContainer,ze.advancedOptionsSection)},j("button",{"aria-label":F.advancedOptions,"aria-expanded":this._advancedOptionsVisibleForMapOnly?"true":"false",type:"button",class:ze.advancedOptionsButton,onclick:this._showAdvancedOptions,bind:this},j("div",{class:ze.advancedOptionsButtonContainer},j("span",{"aria-hidden":"true",class:this.classes(ze.iconRightTriangleArrow,ze.advancedOptionsButtonIconClosed)}),j("span",{"aria-hidden":"true",class:this.classes(ze.iconLeftTriangleArrow,ze.advancedOptionsButtonIconClosed_RTL)}),j("span",{"aria-hidden":"true",class:this.classes(ze.iconDownArrow,ze.advancedOptionsButtonIconOpened)}),j("span",{class:ze.advancedOptionsButtonTitle},F.advancedOptions))),ye))),Se=this.exportedLinks.toArray(),Ae=this._renderExportedLink(Se),Oe={[ze.buttonDisabled]:E||!c&&!n},bt=this.get("view")!=null&&this.get("view.type")!=="2d",st=j("div",{class:ze.panelError},bt?F.sceneViewError:F.serviceError),et=j("div",null,j("ul",{class:ze.layoutTabList,role:"tablist",onclick:this._toggleLayoutPanel,onkeydown:this._handleLayoutPanelKeyDown,bind:this},j("li",{afterCreate:this._focusOnTabChange,afterUpdate:this._focusOnTabChange,id:`${this.id}__layoutTab`,"data-tab-id":eh.layout,class:ze.layoutTab,role:"tab",tabIndex:0,"aria-selected":`${this._layoutTabSelected}`},F.layoutTab),j("li",{afterCreate:this._focusOnTabChange,afterUpdate:this._focusOnTabChange,id:`${this.id}__mapOnlyTab`,"data-tab-id":eh.mapOnly,class:ze.layoutTab,role:"tab",tabIndex:0,"aria-selected":`${!this._layoutTabSelected}`},F.mapOnlyTab)),xe,j("button",{"aria-label":F.exportDescription,type:"button",class:this.classes(ze.printButton,ze.button,Oe),disabled:E,tabIndex:0,onclick:this._handlePrintMap,bind:this},F.export),P&&N.defaultTemplates.length>0?this.renderTemplateSectionTrigger():null,j("div",{class:ze.exportedFilesContainer,afterUpdate:this._scrollExportIntoView,bind:this},j(Va,{class:ze.exportedFilesTitle,level:this.headingLevel},F.exportText),Se.length>0?null:j("div",null,j("div",null,F.exportHint)),Ae)),He=j("div",{class:ze.printWidgetContainer},j("header",{class:ze.headerTitle},F.export),this.error||bt||!this.view?st:et),Et=this.get("viewModel.state")==="initializing"?this._renderLoader():He;return j("div",{afterCreate:this._handleRootAfterCreate,bind:this,class:this.classes(ze.base,ze.widget,ze.panel)},Et)}renderTemplateSectionTrigger(){const{messages:e,_templateListPopover:t}=this,i=t.open;return j("button",{afterCreate:r=>this._selectTemplateNode=r,"aria-controls":i?`${this.id}__template-selection`:"","aria-label":e.selectTemplateDescription,"aria-pressed":i.toString(),class:this.classes(ze.button,ze.buttonTertiary,ze.templateButton),onclick:this.handleSelectTemplateClick,title:e.selectTemplateDescription,type:"button"},e.selectTemplate)}renderCustomTextElementSection(){const{templateOptions:{customTextElements:e}}=this;return e?j("div",{class:ze.formSectionContainer,key:"custom-text-elements"},e.map(t=>{const[i,r]=Object.entries(t)[0];return i==="date"?null:j("label",{key:i},i,j("input",{bind:this,class:this.classes(ze.inputText,ze.input),"data-input-custom":!0,"data-input-name":i,onchange:this._updateInputValue,type:"text",value:r}))})):null}renderTemplateList(){const{messages:e,messagesCommon:t,viewModel:i}=this,{defaultTemplates:r}=i,n=e.selectTemplateDescription,o=`${this.id}__template-selection`;return j("div",{class:this.classes(ze.templateList,ze.widget,ze.panel),id:o},j(Va,{class:ze.menuHeader,level:this.headingLevel},e.selectTemplate),j("div",{class:ze.templateListScroller},j("ul",{afterCreate:this.handleTemplateListCreation,"aria-activedescendant":`${this.id}__template-item--${this._focusedTemplateIndex}`,"aria-label":n,class:ze.menuList,key:"templates",onblur:this.handleTemplateChildBlur,onclick:this.handleTemplateListClick,onkeydown:this.handleTemplateListKeyDown,role:"listbox",tabIndex:0,title:n},r.toArray().map((c,h)=>{const{description:m}=c,b=h===this._focusedTemplateIndex,x=c.label;return j("li",{"aria-label":m,class:this.classes(ze.menuItem,{[ze.menuItemFocus]:b}),"data-template":c,id:`${this.id}__template-item--${h}`,key:x,title:m},g$(x)?e.mapOnlyTab:x)}))),j("div",{class:ze.templateListFooter},j("button",{type:"button",class:this.classes(ze.button,ze.buttonSecondary),onblur:this.handleTemplateChildBlur,onclick:this.handleCloseTemplateSelection},t.done)))}applyTemplate(e){var o;const{format:t,layout:i,layoutOptions:r}=e,{templateOptions:n}=this;this._templateListPopover.open=!1,this._toggleTab(i==="map-only"?eh.mapOnly:eh.layout,!1),t&&(n.format=t),i&&(n.layout=i),this._focusedTemplateIndex=null,n.legendEnabled=(o=r==null?void 0:r.legend)!=null?o:n.legendEnabled,this.handleCloseTemplateSelection()}renderTitleOrFileNameSection(){const{templateOptions:e,messages:t}=this;let i,r,n,o;return this._layoutTabSelected?(i=t.title,r=t.titlePlaceHolder,n=e.title,o="title"):(i=t.fileName,r=t.fileNamePlaceHolder,n=e.fileName,o="fileName"),j("div",{class:ze.formSectionContainer,key:o},j("label",null,i,j("input",{type:"text",tabIndex:0,placeholder:r,class:this.classes(ze.inputText,ze.input),value:n,"data-input-name":o,onchange:this._updateInputValue,bind:this})))}_handleRootAfterCreate(e){this._rootNode=e,this.addHandles(cw(e,"scroll",()=>{this._templateListPopover.open&&this.handleCloseTemplateSelection()}))}_focusOnTabChange(e){if(!this._activeTabFocusRequested)return;const t=e.getAttribute("data-tab-id");(t==="layoutTab"&&this._layoutTabSelected||t==="mapOnlyTab"&&!this._layoutTabSelected)&&(e.focus(),this._activeTabFocusRequested=!1)}_renderLoader(){const e={[ze.loader]:this._awaitingServerResponse};return j("div",{class:this.classes(e),key:"loader"})}_createFileLink(e,t){const i=t||this.messages.untitled,r=e.format.toLowerCase(),n=r.includes("png")?"png":r,o=i+n;return this._exportedFileNameMap[o]!==void 0?this._exportedFileNameMap[o]++:this._exportedFileNameMap[o]=0,new pae({name:i,extension:n,count:this._exportedFileNameMap[o]})}_resetToCurrentScale(){this.templateOptions.scale=this.viewModel.view.scale}_updateCustomTextElementValue(e,t,i){e.find(r=>{const[n]=Object.entries(r)[0];return n===t})[t]=i}_updateInputValue(e){const t=e.target,i=t.getAttribute("data-input-name"),r=!!t["data-input-custom"],{templateOptions:n}=this;if(r)return void this._updateCustomTextElementValue(n.customTextElements,i,t.value);let o;if(t.type==="number"){if(!jBe(t.valueAsNumber)){const c=n[i];return void(t.value=`${c}`)}o=t.valueAsNumber}else o=t.value;n[i]=o}_handleDPIChange(e){this._updateInputValue(e);const t=e.currentTarget.valueAsNumber,{height:i,width:r}=DBe(t),{templateOptions:n}=this;n.height=i,n.width=r}_handlePrintMap(){this._pendingExportScroll=!0;const{templateOptions:e}=this,t=this.viewModel.toPrintTemplate(e),i=this._layoutTabSelected?t.layoutOptions.titleText:e.fileName,r=this._createFileLink(t,i);this.exportedLinks.add(r),this.emit("submit",{link:r}),this.viewModel.print(t).then(n=>{r.set({url:n&&n.url,state:"ready"})}).catch(n=>{r.set({error:n,state:"error"})}).then(()=>{this.emit("complete",{link:r}),this.scheduleRender()})}_updateFromOption(e){const t=e.target,i=t.selectedOptions?t.selectedOptions.item(0).value:t.options[t.selectedIndex].value,r=t.getAttribute("data-target-property");this.templateOptions[r]=i}_switchInput(){[this.templateOptions.width,this.templateOptions.height]=[this.templateOptions.height,this.templateOptions.width]}_showAdvancedOptions(){this._layoutTabSelected?this._advancedOptionsVisibleForLayout=!this._advancedOptionsVisibleForLayout:this._advancedOptionsVisibleForMapOnly=!this._advancedOptionsVisibleForMapOnly}_scrollExportIntoView(){if(this._pendingExportScroll){this._pendingExportScroll=!1;const{_rootNode:e,_rootNode:{clientHeight:t,scrollHeight:i}}=this,r=i-t;r>0&&(e.scrollTop=r)}}_toggleInputValue(e){const t=e.target,i=t.getAttribute("data-option-name");this.templateOptions[i]=t.checked,i==="scaleEnabled"&&(this.templateOptions[i]||this._resetToCurrentScale())}_renderExportedLink(e){const t=this.messages;return e.map(i=>{const{error:r,url:n,formattedName:o,state:c}=i,h=c==="error",m=c==="pending",b=c==="ready",x={[ze.anchorDisabled]:m||h};let I=n||null;I&&(I=tB(I));const E=Eg(n,location.href),k={[ze.iconSpinner]:m,[ze.rotate]:m,[ze.iconDownload]:E&&b,[ze.iconLaunchLink]:!E&&b,[ze.iconError]:h,[ze.exportedFileError]:h},P={[ze.exportedFileError]:h};let F;F=m?t.pending:b?t.ready:t.errorMessage;const N=h?r.name==="print-task:cim-symbol-unsupported"?t.exportWebMapCIMError:t.exportWebMapError:"";return j("div",{"aria-label":F,class:ze.exportedFile,"data-item":i,key:o,onclick:this._removeLink,title:N},j("a",{"aria-label":`${o}. ${t.linkReady}`,download:o,href:I,rel:"noreferrer",tabIndex:0,target:"_blank",class:this.classes(ze.exportedFileLink,x),onclick:this._handleLinkClick},j("span",{class:this.classes(k)}),j("span",{class:this.classes(ze.exportedFileLinkTitle,P)},o)))})}_toggleLayoutPanel(e){const t=e.target;this._toggleTab(t.getAttribute("data-tab-id"))}_toggleTab(e,t=!0){if(this._layoutTabSelected=e===eh.layout,this._layoutTabSelected){const i=this.get("viewModel.templatesInfo.layout.choiceList");this.templateOptions.layout=i&&i[0]}else this.templateOptions.layout=Aae;t&&(this._activeTabFocusRequested=!0)}_handleLayoutPanelKeyDown(e){const t=to(e),i=e.target.getAttribute("data-tab-id");if(Hg(t))return this._toggleTab(i),e.preventDefault(),void e.stopPropagation();t!=="ArrowLeft"&&t!=="ArrowRight"||(this._toggleTab(i===eh.layout?eh.mapOnly:eh.layout),e.preventDefault(),e.stopPropagation())}};g([w()],gs.prototype,"allowedFormats",null),g([w()],gs.prototype,"allowedLayouts",null),g([w()],gs.prototype,"error",null),g([w({type:kae})],gs.prototype,"exportedLinks",void 0),g([w()],gs.prototype,"extraParameters",null),g([w()],gs.prototype,"headingLevel",void 0),g([w()],gs.prototype,"iconClass",void 0),g([w()],gs.prototype,"includeDefaultTemplates",null),g([w()],gs.prototype,"label",null),g([w(),ci("esri/widgets/Print/t9n/Print")],gs.prototype,"messages",void 0),g([w(),ci("esri/t9n/common")],gs.prototype,"messagesCommon",void 0),g([w()],gs.prototype,"portal",null),g([w()],gs.prototype,"printServiceUrl",null),g([w()],gs.prototype,"templateCustomTextElements",null),g([w({type:Cae})],gs.prototype,"templateOptions",void 0),g([w()],gs.prototype,"view",null),g([w({type:Tae})],gs.prototype,"viewModel",void 0),gs=g([te("esri.widgets.Print")],gs);let v$=class extends ke{get version(){return this.commitVersionProperties(),(this._get("version")||0)+1}};g([w({readOnly:!0})],v$.prototype,"version",null),v$=g([te("esri.views.layers.support.ClipArea")],v$);const VBe=v$;var hF;let Cm=hF=class extends VBe{constructor(e){super(e),this.type="rect",this.left=null,this.right=null,this.top=null,this.bottom=null}clone(){return new hF({left:this.left,right:this.right,top:this.top,bottom:this.bottom})}commitVersionProperties(){this.commitProperty("left"),this.commitProperty("right"),this.commitProperty("top"),this.commitProperty("bottom")}};g([w({type:[Number,String],json:{write:!0}})],Cm.prototype,"left",void 0),g([w({type:[Number,String],json:{write:!0}})],Cm.prototype,"right",void 0),g([w({type:[Number,String],json:{write:!0}})],Cm.prototype,"top",void 0),g([w({type:[Number,String],json:{write:!0}})],Cm.prototype,"bottom",void 0),Cm=hF=g([te("esri.views.layers.support.ClipRect")],Cm);const b$=Cm;function zBe(e,t){const i=10**t;return Math.round(e*i)/i}const w$={left:0,right:0,top:0,bottom:0};let Ea=class extends Ye{constructor(e){super(e),this._handles=new Ti,this._leadingClips=new Map,this._trailingClips=new Map,this.direction="horizontal",this.leadingLayers=new Xe,this.max=100,this.min=0,this.precision=4,this.step=.5,this.stepMultiplier=10,this.trailingLayers=new Xe,this.view=null}initialize(){this._handles.add([we(()=>{var e;return[this.view,(e=this.view)==null?void 0:e.ready,this.position,this.direction]},()=>this._clipLayers(),St),vr(()=>this.leadingLayers,"change",()=>this._clipLeadingLayers()),vr(()=>this.trailingLayers,"change",()=>this._clipTrailingLayers())])}destroy(){this._removeExistingClips(),this._handles.destroy(),this._handles=null}get position(){return 25}set position(e){const{precision:t,min:i,max:r}=this;this._set("position",zBe(Math.max(Math.min(e,r),i),t))}get state(){const{view:e}=this;return e&&e.ready?"ready":"disabled"}_clipLayers(){this._clipLeadingLayers(),this._clipTrailingLayers()}_clipLeadingLayers(){this._removeClips("leading");const{leadingLayers:e}=this;e.forEach(t=>this._clipLayer({layer:t,type:"leading"}))}_clipTrailingLayers(){this._removeClips("trailing");const{trailingLayers:e}=this;e.forEach(t=>this._clipLayer({layer:t,type:"trailing"}))}async _getLayerView(e){const{view:t}=this;if(!e||!t)return null;const i=await t.whenLayerView(e);return"clips"in i?i:null}_getVerticalClipRect(e){const{position:t}=this;return e==="leading"?new b$(Ce(K({},w$),{bottom:100-t+"%"})):e==="trailing"?new b$(Ce(K({},w$),{top:`${t}%`})):null}_getHorizontalClipRect(e){const{position:t}=this;return e==="leading"?new b$(Ce(K({},w$),{right:100-t+"%"})):e==="trailing"?new b$(Ce(K({},w$),{left:`${t}%`})):null}_getClipRect(e){const{direction:t}=this;return t==="vertical"?this._getVerticalClipRect(e):t==="horizontal"?this._getHorizontalClipRect(e):null}async _clipLayer(e){const{_leadingClips:t,_trailingClips:i}=this,{layer:r,type:n}=e,o=n==="trailing"?i:n==="leading"?t:null,c=await this._getLayerView(r);if(!(c&&"clips"in c&&o&&c.hasOwnProperty("clips")))return;const h=o.get(c);h&&c.clips.remove(h);const m=this._getClipRect(n);m&&(o.set(c,m),c.clips.add(m))}_removeClips(e){const{_leadingClips:t,_trailingClips:i}=this,r=e==="trailing"?i:e==="leading"?t:null;r&&(r.forEach((n,o)=>{o&&o.hasOwnProperty("clips")&&o.clips.remove(n)}),r.clear())}_removeExistingClips(){this._removeClips("leading"),this._removeClips("trailing")}};g([w()],Ea.prototype,"direction",void 0),g([w({type:Xe,nonNullable:!0})],Ea.prototype,"leadingLayers",void 0),g([w({readOnly:!0})],Ea.prototype,"max",void 0),g([w({readOnly:!0})],Ea.prototype,"min",void 0),g([w()],Ea.prototype,"position",null),g([w()],Ea.prototype,"precision",void 0),g([w({readOnly:!0})],Ea.prototype,"state",null),g([w()],Ea.prototype,"step",void 0),g([w()],Ea.prototype,"stepMultiplier",void 0),g([w({type:Xe,nonNullable:!0})],Ea.prototype,"trailingLayers",void 0),g([w()],Ea.prototype,"view",void 0),Ea=g([te("esri.widgets.Swipe.SwipeViewModel")],Ea);const Oae=Ea,Go={base:"esri-swipe",baseDisabled:"esri-swipe--disabled",vertical:"esri-swipe--vertical",horizontal:"esri-swipe--horizontal",container:"esri-swipe__container",divider:"esri-swipe__divider",handle:"esri-swipe__handle",handleHidden:"esri-swipe__handle--hidden",widgetIcon:"esri-icon-up-down-arrows",handleIcon:"esri-swipe__handle-icon",dragIconHorizontal:"esri-icon-drag-horizontal",dragIconVertical:"esri-icon-drag-vertical",widget:"esri-widget",disabled:"esri-disabled"},Rae={handle:!0,divider:!0};let Ta=class extends ki{constructor(e,t){super(e,t),this.disabled=!1,this.iconClass=Go.widgetIcon,this.messages=null,this.viewModel=new Oae,this._pointerOffset=null,this._container=null,this._onContainerPointerDown=this._onContainerPointerDown.bind(this),this._onContainerPointerMove=this._onContainerPointerMove.bind(this),this._onContainerPointerUp=this._onContainerPointerUp.bind(this)}get direction(){return this.viewModel.direction}set direction(e){this.viewModel.direction=e}get dragLabel(){var e,t,i;return(i=(t=this._get("dragLabel"))!=null?t:(e=this.messages)==null?void 0:e.dragLabel)!=null?i:""}set dragLabel(e){this._set("dragLabel",e)}get label(){var e,t;return(t=(e=this.messages)==null?void 0:e.widgetLabel)!=null?t:""}set label(e){this._overrideIfSome("label",e)}get leadingLayers(){return this.viewModel.leadingLayers}set leadingLayers(e){this.viewModel.leadingLayers=e}get position(){return this.viewModel.position}set position(e){this.viewModel.position=e}get trailingLayers(){return this.viewModel.trailingLayers}set trailingLayers(e){this.viewModel.trailingLayers=e}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}set visibleElements(e){this._set("visibleElements",K(K({},Rae),e))}get visibleElements(){return this._get("visibleElements")||Rae}render(){const{state:e,direction:t}=this.viewModel,i=e==="disabled"||this.disabled,r={[Go.disabled]:i,[Go.baseDisabled]:i,[Go.vertical]:t==="vertical",[Go.horizontal]:t==="horizontal"};return j("div",{class:this.classes(Go.base,Go.widget,r)},e==="disabled"?null:this.renderContainer())}renderHandle(){const{direction:e}=this.viewModel,{visibleElements:t}=this,i={[Go.dragIconHorizontal]:e==="vertical",[Go.dragIconVertical]:e==="horizontal"},r=this.classes(Go.handle,!t.handle&&Go.handleHidden);return j("div",{key:"handle",role:"presentation",class:r},j("span",{"aria-hidden":"true",class:this.classes(Go.handleIcon,i)}))}renderDivider(){const{visibleElements:e}=this;return e&&e.divider?j("div",{key:"divider",role:"presentation",class:Go.divider}):null}renderContent(){return[this.renderDivider(),this.renderHandle()]}renderContainer(){const{disabled:e,dragLabel:t,viewModel:i}=this,{max:r,min:n,direction:o,position:c}=i,h=`${c}%`,m={top:o==="vertical"?h:null,left:o==="vertical"?null:h},b=this.renderContent();return j("div",e?{key:"container",role:"presentation",styles:m,class:Go.container}:{tabIndex:0,key:"container",bind:this,afterCreate:this._afterContainerCreate,onkeydown:this._onContainerKeyDown,"touch-action":"none",role:"slider",title:t,"aria-label":t,"aria-orientation":o,"aria-valuemax":`${r}`,"aria-valuemin":`${n}`,"aria-valuenow":`${c}`,"aria-valuetext":h,styles:m,class:Go.container},b)}_afterContainerCreate(e){this._container=e,e.addEventListener("pointerdown",this._onContainerPointerDown)}_calculatePointerOffset(e){const{direction:t}=this,i=e.target,r=(t==="vertical"?i.clientHeight:i.clientWidth)/2,n=i.getBoundingClientRect(),o=e.clientX-n.left,c=e.clientY-n.top;this._pointerOffset=t==="vertical"?c-r:o-r}_onContainerPointerDown(e){e.preventDefault(),this._container&&document.activeElement!==this.container&&this._container.focus(),this._calculatePointerOffset(e),document.addEventListener("pointerup",this._onContainerPointerUp),document.addEventListener("pointermove",this._onContainerPointerMove)}_onContainerPointerUp(e){e.preventDefault(),document.removeEventListener("pointerup",this._onContainerPointerUp),document.removeEventListener("pointermove",this._onContainerPointerMove)}_onContainerPointerMove(e){e.preventDefault();const{_pointerOffset:t,container:i,direction:r}=this,{clientX:n,clientY:o}=e,{top:c,left:h,width:m,height:b}=i.getBoundingClientRect(),x=(r==="vertical"?o-c-t:n-h-t)/(r==="vertical"?b:m)*100;this.position=x}_getKeyPosition(e){const t=to(e),{position:i}=this,{max:r,min:n,step:o,stepMultiplier:c,direction:h}=this.viewModel,m=o*c;return["ArrowUp","ArrowDown","ArrowLeft","ArrowRight","Home","End","PageUp","PageDown"].includes(t)&&(e.preventDefault(),e.stopPropagation()),(h==="vertical"?t==="ArrowDown"||t==="ArrowRight":t==="ArrowUp"||t==="ArrowRight")?i+(e.shiftKey?m:o):(h==="vertical"?t==="ArrowUp"||t==="ArrowLeft":t==="ArrowDown"||t==="ArrowLeft")?i-(e.shiftKey?m:o):t==="Home"?n:t==="End"?r:(h==="vertical"?t==="PageDown":t==="PageUp")?i+m:(h==="vertical"?t==="PageUp":t==="PageDown")?i-m:null}_onContainerKeyDown(e){const t=this._getKeyPosition(e);typeof t=="number"&&(this.position=t)}};g([w()],Ta.prototype,"direction",null),g([w()],Ta.prototype,"disabled",void 0),g([w()],Ta.prototype,"dragLabel",null),g([w()],Ta.prototype,"iconClass",void 0),g([w()],Ta.prototype,"label",null),g([w()],Ta.prototype,"leadingLayers",null),g([w(),ci("esri/widgets/Swipe/t9n/Swipe")],Ta.prototype,"messages",void 0),g([w()],Ta.prototype,"position",null),g([w()],Ta.prototype,"trailingLayers",null),g([w()],Ta.prototype,"view",null),g([w({type:Oae})],Ta.prototype,"viewModel",void 0),g([w()],Ta.prototype,"visibleElements",null),Ta=g([te("esri.widgets.Swipe")],Ta);const GBe={type:xu,json:{origins:{service:{read:{source:["tileInfo","minScale","maxScale","minLOD","maxLOD"],reader:BBe}}}}};function BBe(e,t,i,r){if(!e)return null;const{minScale:n,maxScale:o,minLOD:c,maxLOD:h}=t;if(c!=null&&h!=null)return r&&r.ignoreMinMaxLOD?xu.fromJSON(e):xu.fromJSON(Ce(K({},e),{lods:e.lods.filter(({level:m})=>m!=null&&m>=c&&m<=h)}));if(n!==0&&o!==0){const m=I=>Math.round(1e4*I)/1e4,b=n?m(n):1/0,x=o?m(o):-1/0;return xu.fromJSON(Ce(K({},e),{lods:e.lods.filter(I=>{const E=m(I.scale);return E<=b&&E>=x})}))}return xu.fromJSON(e)}class Mb{constructor(){this.location={left:0,top:0,width:0,height:0},this._allAvailability="unknown",this.byteSize=40}getAvailability(t,i){if(this._allAvailability!=="unknown")return this._allAvailability;const r=(t-this.location.top)*this.location.width+(i-this.location.left),n=r%8,o=r>>3,c=this._tileAvailabilityBitSet;return o<0||o>c.length?"unknown":c[o]&1<<n?"available":"unavailable"}_updateFromData(t){const i=this.location.width,r=this.location.height;let n=!0,o=!0;const c=Math.ceil(i*r/8),h=new Uint8Array(c);let m=0;for(let b=0;b<t.length;b++){const x=b%8;t[b]?(o=!1,h[m]|=1<<x):n=!1,x===7&&++m}o?this._allAvailability="unavailable":n?this._allAvailability="available":(this._allAvailability="unknown",this._tileAvailabilityBitSet=h,this.byteSize+=h.length)}static fromDefinition(t,i){const r=t.service.request||Nt,{row:n,col:o,width:c,height:h}=t,m={query:{f:"json"}};return i=i?K(K({},m),i):m,r(UBe(t),i).then(b=>b.data).catch(b=>{if(b&&b.details&&b.details.httpStatus===422)return{location:{top:n,left:o,width:c,height:h},valid:!0,data:C0e(c*h,0)};throw b}).then(b=>{if(b.location&&(b.location.top!==n||b.location.left!==o||b.location.width!==c||b.location.height!==h))throw new ue("tilemap:location-mismatch","Tilemap response for different location than requested",{response:b,definition:{top:n,left:o,width:c,height:h}});return Mb.fromJSON(b)})}static fromJSON(t){Mb._validateJSON(t);const i=new Mb;return i.location=Object.freeze(_e(t.location)),i._updateFromData(t.data),Object.freeze(i)}static _validateJSON(t){if(!t||!t.location)throw new ue("tilemap:missing-location","Location missing from tilemap response");if(t.valid===!1)throw new ue("tilemap:invalid","Tilemap response was marked as invalid");if(!t.data)throw new ue("tilemap:missing-data","Data missing from tilemap response");if(!Array.isArray(t.data))throw new ue("tilemap:data-mismatch","Data must be an array of numbers");if(t.data.length!==t.location.width*t.location.height)throw new ue("tilemap:data-mismatch","Number of data items does not match width/height of tilemap")}}function Fae(e){return`${e.level}/${e.row}/${e.col}/${e.width}/${e.height}`}function UBe(e){let t;if(e.service.type==="vector-tile")t=`${e.service.url}/tilemap/${e.level}/${e.row}/${e.col}/${e.width}/${e.height}`;else{const r=e.service.tileServers;t=`${r&&r.length?r[e.row%r.length]:e.service.url}/tilemap/${e.level}/${e.row}/${e.col}/${e.width}/${e.height}`}const i=e.service.query;return i&&(t=`${t}?${i}`),t}var km;let Gc=km=class extends ls(Ye){constructor(e){super(e),this._pendingTilemapRequests={},this._availableLevels={},this.levels=5,this.cacheByteSize=2*t1.MEGABYTES,this.request=Nt,this._prefetchingEnabled=!0}initialize(){this._tilemapCache=new DZ(this.cacheByteSize),this.addHandles([we(()=>{const{layer:e}=this;return[e==null?void 0:e.parsedUrl,e==null?void 0:e.tileServers,e==null?void 0:e.apiKey,e==null?void 0:e.customParameters]},()=>this._initializeTilemapDefinition()),we(()=>{var e,t;return(t=(e=this.layer)==null?void 0:e.tileInfo)==null?void 0:t.lods},e=>this._initializeAvailableLevels(e),Gs)]),this._initializeTilemapDefinition()}castLevels(e){return e<=2?($e.getLogger(this.declaredClass).error("Minimum levels for Tilemap is 3, but got ",e),3):e}get size(){return 1<<this.levels}fetchTilemap(e,t,i,r){if(!this._availableLevels[e])return Promise.reject(new ue("tilemap-cache:level-unavailable",`Level ${e} is unavailable in the service`));const n=this._tmpTilemapDefinition,o=this._tilemapFromCache(e,t,i,n);if(o)return Promise.resolve(o);const c=r&&r.signal;return r=Ce(K({},r),{signal:null}),new Promise((h,m)=>{Ho(c,()=>m(Qi()));const b=Fae(n);let x=this._pendingTilemapRequests[b];if(!x){x=Mb.fromDefinition(n,r).then(E=>(this._tilemapCache.put(b,E,E.byteSize),E));const I=()=>delete this._pendingTilemapRequests[b];this._pendingTilemapRequests[b]=x,x.then(I,I)}x.then(h,m)})}getAvailability(e,t,i){if(!this._availableLevels[e])return"unavailable";const r=this._tilemapFromCache(e,t,i,this._tmpTilemapDefinition);return r?r.getAvailability(t,i):"unknown"}fetchAvailability(e,t,i,r){return this._availableLevels[e]?this.fetchTilemap(e,t,i,r).catch(n=>n).then(n=>{if(n instanceof Mb){const o=n.getAvailability(t,i);if(o==="unavailable")throw new ue("tile-map:tile-unavailable","Tile is not available",{level:e,row:t,col:i});return o}if(Xn(n))throw n;return"unknown"}):Promise.reject(new ue("tilemap-cache:level-unavailable",`Level ${e} is unavailable in the service`))}fetchAvailabilityUpsample(e,t,i,r,n){r.level=e,r.row=t,r.col=i;const o=this.layer.tileInfo;o.updateTileInfo(r);const c=this.fetchAvailability(e,t,i,n).catch(h=>{if(Xn(h))throw h;if(o.upsampleTile(r))return this.fetchAvailabilityUpsample(r.level,r.row,r.col,r);throw h});return this._fetchAvailabilityUpsamplePrefetch(r.id,e,t,i,n,c),c}async _fetchAvailabilityUpsamplePrefetch(e,t,i,r,n,o){if(!this._prefetchingEnabled)return;const c=`prefetch-${e}`;if(this.handles.has(c))return;const h=new AbortController;o.then(()=>h.abort(),()=>h.abort());let m=!1;const b={remove(){m||(m=!0,h.abort())}};if(this.handles.add(b,c),await Yye(10,h.signal).catch(()=>{}),m||(m=!0,this.handles.remove(c)),ka(h))return;const x=new xq(e,t,i,r),I=Ce(K({},n),{signal:h.signal}),E=this.layer.tileInfo;for(let k=0;km._prefetches.length<km._maxPrefetch&&E.upsampleTile(x);++k){const P=this.fetchAvailability(x.level,x.row,x.col,I);km._prefetches.push(P);const F=()=>{km._prefetches.removeUnordered(P)};P.then(F,F)}}_initializeTilemapDefinition(){var r;if(!this.layer.parsedUrl)return;const{parsedUrl:e,apiKey:t,customParameters:i}=this.layer;this._tilemapCache.clear(),this._tmpTilemapDefinition={service:{url:e.path,query:Td(Ce(K(K({},e.query),i),{token:t!=null?t:(r=e.query)==null?void 0:r.token})),tileServers:this.layer.tileServers,request:this.request,type:this.layer.type},width:this.size,height:this.size,level:0,row:0,col:0}}_tilemapFromCache(e,t,i,r){r.level=e,r.row=t-t%this.size,r.col=i-i%this.size;const n=Fae(r);return this._tilemapCache.get(n)}_initializeAvailableLevels(e){this._availableLevels={},e&&e.forEach(t=>this._availableLevels[t.level]=!0)}get test(){const e=this;return{get prefetchingEnabled(){return e._prefetchingEnabled},set prefetchingEnabled(t){e._prefetchingEnabled=t},hasTilemap:(t,i,r)=>!!e._tilemapFromCache(t,i,r,e._tmpTilemapDefinition)}}};Gc._maxPrefetch=4,Gc._prefetches=new ld({initialSize:km._maxPrefetch}),g([w({constructOnly:!0,type:Number})],Gc.prototype,"levels",void 0),g([Dt("levels")],Gc.prototype,"castLevels",null),g([w({readOnly:!0,type:Number})],Gc.prototype,"size",null),g([w({constructOnly:!0,type:Number})],Gc.prototype,"cacheByteSize",void 0),g([w({constructOnly:!0})],Gc.prototype,"layer",void 0),g([w({constructOnly:!0})],Gc.prototype,"request",void 0),Gc=km=g([te("esri.layers.support.TilemapCache")],Gc);const qBe=e=>{let t=class extends e{constructor(){super(...arguments),this.copyright=null,this.minScale=0,this.maxScale=0,this.spatialReference=null,this.tileInfo=null,this.tilemapCache=null}readMinScale(i,r){return r.minLOD!=null&&r.maxLOD!=null?i:0}readMaxScale(i,r){return r.minLOD!=null&&r.maxLOD!=null?i:0}get supportsBlankTile(){return this.version>=10.2}readTilemapCache(i,r){return r.capabilities&&r.capabilities.includes("Tilemap")?new Gc({layer:this}):null}};return g([w({json:{read:{source:"copyrightText"}}})],t.prototype,"copyright",void 0),g([w()],t.prototype,"minScale",void 0),g([We("service","minScale")],t.prototype,"readMinScale",null),g([w()],t.prototype,"maxScale",void 0),g([We("service","maxScale")],t.prototype,"readMaxScale",null),g([w({type:Mt})],t.prototype,"spatialReference",void 0),g([w({readOnly:!0})],t.prototype,"supportsBlankTile",null),g([w(GBe)],t.prototype,"tileInfo",void 0),g([w()],t.prototype,"tilemapCache",void 0),g([We("service","tilemapCache",["capabilities"])],t.prototype,"readTilemapCache",null),g([w()],t.prototype,"version",void 0),t=g([te("esri.layers.mixins.ArcGISCachedService")],t),t},Nae=["Canvas/World_Dark_Gray_Base","Canvas/World_Dark_Gray_Reference","Canvas/World_Light_Gray_Base","Canvas/World_Light_Gray_Reference","Elevation/World_Hillshade","Elevation/World_Hillshade_Dark","Ocean/World_Ocean_Base","Ocean/World_Ocean_Reference","Ocean_Basemap","Reference/World_Boundaries_and_Places","Reference/World_Boundaries_and_Places_Alternate","Reference/World_Transportation","World_Imagery","World_Street_Map","World_Topo_Map"];let Pn=class extends $M(zie(DM(uP(dP(qBe(Rie(N8(x2(ls(yP(O8(D8(Y0))))))))))))){constructor(...e){super(...e),this.listMode="show",this.isReference=null,this.operationalLayerType="ArcGISTiledMapServiceLayer",this.resampling=!0,this.sourceJSON=null,this.spatialReference=null,this.path=null,this.sublayers=null,this.type="tile",this.url=null}normalizeCtorArgs(e,t){return typeof e=="string"?K({url:e},t):e}load(e){const t=H(e)?e.signal:null;return this.addResolvingPromise(this.loadFromPortal({supportedTypes:["Map Service"]},e).catch(f0).then(()=>this._fetchService(t))),Promise.resolve(this)}get attributionDataUrl(){var t;const e=(t=this.parsedUrl)==null?void 0:t.path.toLowerCase();return e?this._getDefaultAttribution(this._getMapName(e)):null}readSpatialReference(e,t){return(e=e||t.tileInfo&&t.tileInfo.spatialReference)&&Mt.fromJSON(e)}writeSublayers(e,t,i,r){if(!this.loaded||!e)return;const n=e.slice().reverse().flatten(({sublayers:h})=>h&&h.toArray().reverse()).toArray(),o=[],c=K({writeSublayerStructure:!1},r);n.forEach(h=>{const m=h.write({},c);o.push(m)}),o.some(h=>Object.keys(h).length>1)&&(t.layers=o)}get tileServers(){return this._getDefaultTileServers(this.parsedUrl.path)}castTileServers(e){return Array.isArray(e)?e.map(t=>mn(t).path):null}fetchTile(e,t,i,r={}){const{signal:n}=r,o=this.getTileUrl(e,t,i),c={responseType:"image",signal:n,query:K({},this.refreshParameters)};return Nt(o,c).then(h=>h.data)}async fetchImageBitmapTile(e,t,i,r={}){const{signal:n}=r,o=this.getTileUrl(e,t,i),c={responseType:"blob",signal:n,query:K({},this.refreshParameters)},h=await Nt(o,c);return createImageBitmap(h.data)}getTileUrl(e,t,i){const r=!this.tilemapCache&&this.supportsBlankTile,n=Td(Ce(K(Ce(K({},this.parsedUrl.query),{blankTile:!r&&null}),this.customParameters),{token:this.apiKey})),o=this.tileServers;return`${o&&o.length?o[t%o.length]:this.parsedUrl.path}/tile/${e}/${t}/${i}${n?"?"+n:""}`}_fetchService(e){return new Promise((t,i)=>{if(this.sourceJSON){if(this.sourceJSON.bandCount!=null&&this.sourceJSON.pixelSizeX!=null)throw new ue("tile-layer:unsupported-url","use ImageryTileLayer to open a tiled image service");return void t({data:this.sourceJSON})}if(!this.parsedUrl)throw new ue("tile-layer:undefined-url","layer's url is not defined");const r=hf(this.parsedUrl.path);if(H(r)&&r.serverType==="ImageServer")throw new ue("tile-layer:unsupported-url","use ImageryTileLayer to open a tiled image service");Nt(this.parsedUrl.path,{query:Ce(K(K({f:"json"},this.parsedUrl.query),this.customParameters),{token:this.apiKey}),responseType:"json",signal:e}).then(t,i)}).then(t=>{if(t.ssl&&(this.url=this.url.replace(/^http:/i,"https:")),this.sourceJSON=t.data,this.read(t.data,{origin:"service",url:this.parsedUrl}),this.version===10.1&&!F8(this.url))return this._fetchServerVersion(this.url,e).then(i=>{this.read({currentVersion:i})}).catch(()=>{})})}_fetchServerVersion(e,t){if(!Z$e(e))return Promise.reject();const i=e.replace(/(.*\/rest)\/.*/i,"$1")+"/info";return Nt(i,{query:Ce(K({f:"json"},this.customParameters),{token:this.apiKey}),responseType:"json",signal:t}).then(r=>{if(r.data&&r.data.currentVersion)return r.data.currentVersion;throw new ue("tile-layer:version-not-available")})}_getMapName(e){const t=e.match(/^(?:https?:)?\/\/(server\.arcgisonline\.com|services\.arcgisonline\.com|ibasemaps-api\.arcgis\.com)\/arcgis\/rest\/services\/([^\/]+(\/[^\/]+)*)\/mapserver/i);return t&&t[2]}_getDefaultAttribution(e){if(!e)return;let t;e=e.toLowerCase();for(let i=0,r=Nae.length;i<r;i++)if(t=Nae[i],t.toLowerCase().includes(e))return Ra("//static.arcgis.com/attribution/"+t)}_getDefaultTileServers(e){const t=e.search(/^(?:https?:)?\/\/server\.arcgisonline\.com/i)!==-1,i=e.search(/^(?:https?:)?\/\/services\.arcgisonline\.com/i)!==-1;return t||i?[e,e.replace(t?/server\.arcgisonline/i:/services\.arcgisonline/i,t?"services.arcgisonline":"server.arcgisonline")]:[]}get hasOverriddenFetchTile(){return!this.fetchTile.__isDefault__}};g([w({readOnly:!0})],Pn.prototype,"attributionDataUrl",null),g([w({type:["show","hide","hide-children"]})],Pn.prototype,"listMode",void 0),g([w({json:{read:!0,write:!0}})],Pn.prototype,"blendMode",void 0),g([w({type:Boolean,json:{read:!1,write:{enabled:!0,overridePolicy:()=>({enabled:!1})}}})],Pn.prototype,"isReference",void 0),g([w({readOnly:!0,type:["ArcGISTiledMapServiceLayer"]})],Pn.prototype,"operationalLayerType",void 0),g([w({type:Boolean})],Pn.prototype,"resampling",void 0),g([w()],Pn.prototype,"sourceJSON",void 0),g([w({type:Mt})],Pn.prototype,"spatialReference",void 0),g([We("spatialReference",["spatialReference","tileInfo"])],Pn.prototype,"readSpatialReference",null),g([w({type:String,json:{origins:{"web-scene":{read:!0,write:!0}},read:!1}})],Pn.prototype,"path",void 0),g([w({readOnly:!0})],Pn.prototype,"sublayers",void 0),g([tt("sublayers",{layers:{type:[_3]}})],Pn.prototype,"writeSublayers",null),g([w({json:{read:!1,write:!1}})],Pn.prototype,"popupEnabled",void 0),g([w()],Pn.prototype,"tileServers",null),g([Dt("tileServers")],Pn.prototype,"castTileServers",null),g([w({readOnly:!0,json:{read:!1}})],Pn.prototype,"type",void 0),g([w(H8)],Pn.prototype,"url",void 0),Pn=g([te("esri.layers.TileLayer")],Pn),Pn.prototype.fetchTile.__isDefault__=!0;const HBe=Pn;var JYe=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",default:HBe});function WBe(e){const{wkid:t}=e;if(ne[t]!=null)return ne.values[ne[t]];const{wkt:i}=e,r=i.lastIndexOf(",")+1,n=i.lastIndexOf("]]");return parseFloat(i.substring(r,n))}function Dae(e,t){return e&&e.includes(t)}function jae(e,t){const{x:i,y:r}=e==="decimal-degrees"?v0(t,!0):t;return[i,r]}function Vae({state:{paddedViewState:e},spatialReference:t,width:i}){return t.isWrappable&&e.worldScreenWidth<i}let Ib=class extends Ye{constructor(e){super(e),this.scaleComputedFrom=yn(),this.view=null}get state(){return this.get("view.ready")&&this.get("view.type")==="2d"?"ready":"disabled"}getScaleBarProperties(e,t){if(this.state==="disabled"||isNaN(e)||!t)return null;const i=this._getDistanceInKm(this.view,this.scaleComputedFrom);if(ce(i))return null;if(t==="metric")return this._getScaleBarProps(e,i,"metric");const r=i/1.609;return this._getScaleBarProps(e,r,"non-metric")}_getLocationUnit(){const e=this.get("view.spatialReference"),{isWebMercator:t,wkid:i,wkt:r}=e;return t||Dae(r,"WGS_1984_Web_Mercator")?"decimal-degrees":ne[i]!=null||Dae(r,"PROJCS")?"linear-unit":"unknown"}_getDistanceInKm(e,t){const{state:i,spatialReference:r}=e,n=this._getLocationUnit();if(n==="linear-unit"){const I=1e3;return i.extent.width*WBe(r)/I}const[o,c]=this._getScaleMeasuringPoints(e,t),h=n==="decimal-degrees"||r.isGeographic&&!t4(r)?Mt.WGS84:r,m=new Fn({paths:[[jae(n,o),jae(n,c)]],spatialReference:h}),b=dJ(m,10);let x;try{[x]=qOe([b],"kilometers")}catch{return null}return x}_getScaleMeasuringPoints(e,t){const{width:i,height:r,position:n,spatialReference:o}=e;if(Vae(e)){const{valid:b}=Wo(o);return[new pt(b[0],0,o),new pt(b[1],0,o)]}let c=t.y-n[1];c>r?c=r:c<0&&(c=0);const h=yn(0,c),m=yn(i,c);return[e.toMap(h),e.toMap(m)]}_getScaleBarProps(e,t,i){const{view:r}=this;let n=e*t/(Vae(r)?r.state.paddedViewState.worldScreenWidth:r.width),o=i==="metric"?"km":"mi";n<.1&&(o==="mi"?(n*=5280,o="ft"):o==="km"&&(n*=1e3,o="m"));let c=0;for(;n>=1;)n/=10,c++;const h=this._getConstraints(n);if(!h)return null;const{min:m,max:b}=h,x=b/n>=n/m?m:b;return{length:e*(x/n),value:10**c*x,unit:o}}_getConstraints(e){return e>.5?{min:.5,max:1}:e>.3?{min:.3,max:.5}:e>.2?{min:.2,max:.3}:e>.15?{min:.15,max:.2}:e>=.1?{min:.15,max:.1}:void 0}};g([w()],Ib.prototype,"scaleComputedFrom",void 0),g([w({readOnly:!0})],Ib.prototype,"state",null),g([w()],Ib.prototype,"view",void 0),Ib=g([te("esri.widgets.Scalebar.ScaleBarViewModel")],Ib);const JBe=Ib,hn={base:"esri-scale-bar esri-widget",labelContainer:"esri-scale-bar__label-container",rulerLabelContainer:"esri-scale-bar__label-container--ruler",lineLabelContainer:"esri-scale-bar__label-container--line",topLabelContainer:"esri-scale-bar__label-container--top",bottomLabelContainer:"esri-scale-bar__label-container--bottom",label:"esri-scale-bar__label",line:"esri-scale-bar__line",topLine:"esri-scale-bar__line--top",bottomLine:"esri-scale-bar__line--bottom",ruler:"esri-scale-bar__ruler",rulerBlock:"esri-scale-bar__ruler-block",barContainer:"esri-scale-bar__bar-container",rulerBarContainer:"esri-scale-bar__bar-container--ruler",lineBarContainer:"esri-scale-bar__bar-container--line",disabled:"esri-disabled"};function _$(e){return 2*e}let th=class extends ki{constructor(e,t){super(e,t),this.messages=null,this.unit="non-metric",this.viewModel=new JBe}initialize(){this.addHandles([we(()=>{const{view:e}=this;return[e==null?void 0:e.stationary,e==null?void 0:e.center,e==null?void 0:e.scale,e==null?void 0:e.zoom]},([e])=>{e&&this.scheduleRender()})])}get label(){var e,t;return(t=(e=this.messages)==null?void 0:e.widgetLabel)!=null?t:""}set label(e){this._overrideIfSome("label",e)}set style(e){const t=this.unit==="dual"?"line":e;this._set("style",t)}castStyle(e){return e==="line"?e:"ruler"}castUnit(e){return e==="metric"||e==="dual"?e:"non-metric"}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}render(){const e=this.get("viewModel.state")==="disabled",t={[hn.disabled]:e};let i,r;if(!e){const{unit:n,style:o}=this,c=n==="metric"||n==="dual",h=50;if(n==="non-metric"||n==="dual"){const m=this.viewModel.getScaleBarProperties(h,"non-metric");m&&(r=o==="ruler"?this._renderRuler(m):this._renderLine(m,"bottom"))}if(c){const m=this.viewModel.getScaleBarProperties(h,"metric");m&&(i=o==="ruler"?this._renderRuler(m):this._renderLine(m,"top"))}}return j("div",{afterCreate:this._handleRootCreateOrUpdate,afterUpdate:this._handleRootCreateOrUpdate,bind:this,class:this.classes(hn.base,t)},i,r)}_renderRuler(e){const t=_$(Math.round(e.length)),{messages:i}=this,r=i[e.unit]||i.unknownUnit,n=`${_$(e.value)} ${r}`;return j("div",{class:this.classes(hn.barContainer,hn.rulerBarContainer),key:"esri-scale-bar__ruler"},j("div",{class:hn.ruler,styles:{width:`${t}px`}},j("div",{class:hn.rulerBlock}),j("div",{class:hn.rulerBlock}),j("div",{class:hn.rulerBlock}),j("div",{class:hn.rulerBlock})),j("div",{class:this.classes(hn.labelContainer,hn.rulerLabelContainer)},j("div",{class:hn.label},"0"),j("div",{class:hn.label},n)))}_renderLine(e,t){const{messages:i}=this,r=i[e.unit]||i.unknownUnit,n=`${_$(e.value)} ${r}`,o={[hn.topLabelContainer]:t==="top",[hn.bottomLabelContainer]:t==="bottom"},c=j("div",{class:this.classes(hn.labelContainer,hn.lineLabelContainer,o),key:"esri-scale-bar__label"},j("div",{class:hn.label},n)),h={[hn.topLine]:t==="top",[hn.bottomLine]:t==="bottom"},m=_$(Math.round(e.length)),b=j("div",{class:this.classes(hn.line,h),key:"esri-scale-bar__line",styles:{width:`${m}px`}});return j("div",{class:this.classes(hn.barContainer,hn.lineBarContainer),key:"esri-scale-bar__line-container"},[b,c])}_handleRootCreateOrUpdate(e){const t=this.viewModel;if(!t)return;const i=e.getBoundingClientRect(),r=i.left+window.pageXOffset,n=i.top+window.pageYOffset,o=yn(r,n);(o.x!==t.scaleComputedFrom.x||o.y!==t.scaleComputedFrom.y)&&(t.scaleComputedFrom=o)}};g([w()],th.prototype,"label",null),g([w(),ci("esri/widgets/ScaleBar/t9n/ScaleBar")],th.prototype,"messages",void 0),g([w()],th.prototype,"style",null),g([Dt("style")],th.prototype,"castStyle",null),g([w()],th.prototype,"unit",void 0),g([Dt("unit")],th.prototype,"castUnit",null),g([w()],th.prototype,"view",null),g([w()],th.prototype,"viewModel",void 0),th=g([te("esri.widgets.ScaleBar")],th);const zae=e=>e.spatialReference.wkid||JSON.stringify(e.spatialReference);function ZBe(e,t){const{dpi:i,gdbVersion:r,geometry:n,geometryPrecision:o,height:c,layerOption:h,mapExtent:m,maxAllowableOffset:b,returnFieldName:x,returnGeometry:I,returnUnformattedValues:E,returnZ:k,spatialReference:P,timeExtent:F,tolerance:N,width:B}=e.toJSON(),{dynamicLayers:z,layerDefs:q,layerIds:J}=KBe(e),X=t&&H(t.geometry)?t.geometry:null,Y={geometryPrecision:o,maxAllowableOffset:b,returnFieldName:x,returnGeometry:I,returnUnformattedValues:E,returnZ:k,tolerance:N},ae=X&&X.toJSON()||n;if(Y.imageDisplay=`${B},${c},${i}`,r&&(Y.gdbVersion=r),ae&&(delete ae.spatialReference,Y.geometry=JSON.stringify(ae),Y.geometryType=bh(ae)),P?Y.sr=P.wkid||JSON.stringify(P):ae&&ae.spatialReference?Y.sr=zae(ae):m&&m.spatialReference&&(Y.sr=zae(m)),Y.time=F?[F.start,F.end].join(","):null,m){const{xmin:he,ymin:fe,xmax:ye,ymax:xe}=m;Y.mapExtent=`${he},${fe},${ye},${xe}`}return q&&(Y.layerDefs=q),z&&!q&&(Y.dynamicLayers=z),Y.layers=h==="popup"?"visible":h,J&&!z&&(Y.layers+=`:${J.join(",")}`),Y}function KBe(e){var P,F;const{mapExtent:t,floors:i,width:r,sublayers:n,layerIds:o,layerOption:c,gdbVersion:h}=e,m=(F=(P=n==null?void 0:n.find(N=>N.layer!=null))==null?void 0:P.layer)==null?void 0:F.serviceSublayers,b=c==="popup",x={},I=Oie({extent:t,width:r,spatialReference:t==null?void 0:t.spatialReference}),E=[],k=N=>{const B=I===0,z=N.minScale===0||I<=N.minScale,q=N.maxScale===0||I>=N.maxScale;if(N.visible&&(B||z&&q))if(N.sublayers)N.sublayers.forEach(k);else{if((o==null?void 0:o.includes(N.id))===!1||b&&(!N.popupTemplate||!N.popupEnabled))return;E.unshift(N)}};if(n==null||n.forEach(k),n&&!E.length)x.layerIds=[];else{const N=Die(E,m,h),B=E.map(z=>{const q=XI(i,z);return z.toExportImageJSON(q)});if(N)x.dynamicLayers=JSON.stringify(B);else{if(n){let q=E.map(({id:J})=>J);o&&(q=q.filter(J=>o.includes(J))),x.layerIds=q}else(o==null?void 0:o.length)&&(x.layerIds=o);const z=YBe(i,E);if(H(z)&&z.length){const q={};for(const J of z)J.definitionExpression&&(q[J.id]=J.definitionExpression);Object.keys(q).length&&(x.layerDefs=JSON.stringify(q))}}}return x}function YBe(e,t){const i=!!(e==null?void 0:e.length),r=t.filter(n=>n.definitionExpression!=null||i&&n.floorInfo!=null);return r.length?r.map(n=>{const o=XI(e,n),c=wM(o,n.definitionExpression);return{id:n.id,definitionExpression:c}}):null}let Up=class extends ke{constructor(e){super(e),this.displayFieldName=null,this.feature=null,this.layerId=null,this.layerName=null}readFeature(e,t){return Gr.fromJSON({attributes:K({},t.attributes),geometry:K({},t.geometry)})}writeFeature(e,t){if(!e)return;const{attributes:i,geometry:r}=e;i&&(t.attributes=K({},i)),H(r)&&(t.geometry=r.toJSON(),t.geometryType=DS.toJSON(r.type))}};g([w({type:String,json:{write:!0}})],Up.prototype,"displayFieldName",void 0),g([w({type:Gr})],Up.prototype,"feature",void 0),g([We("feature",["attributes","geometry"])],Up.prototype,"readFeature",null),g([tt("feature")],Up.prototype,"writeFeature",null),g([w({type:Number,json:{write:!0}})],Up.prototype,"layerId",void 0),g([w({type:String,json:{write:!0}})],Up.prototype,"layerName",void 0),Up=g([te("esri.rest.support.IdentifyResult")],Up);const XBe=Up;async function ZYe(e,t,i){const r=(t=eUe(t)).geometry?[t.geometry]:[],n=Br(e);return n.path+="/identify",d1(r).then(o=>{const c=ZBe(t,{geometry:o&&o[0]}),h=p1(K(Ce(K({},n.query),{f:"json"}),c)),m=t2(h,i);return Nt(n.path,m).then(QBe).then(b=>tUe(b,t.sublayers))})}function QBe(e){const t=e.data;return t.results=t.results||[],t.exceededTransferLimit=Boolean(t.exceededTransferLimit),t.results=t.results.map(i=>XBe.fromJSON(i)),t}function eUe(e){return e=Q8e.from(e)}function tUe(e,t){if(!(t==null?void 0:t.length))return e;const i=new Map;function r(n){i.set(n.id,n),n.sublayers&&n.sublayers.forEach(r)}t.forEach(r);for(const n of e.results)n.feature.sourceLayer=i.get(n.layerId);return e}function iUe(e,t){return t}function pF(e,t,i,r){switch(i){case 0:return ox(e,t+r,0);case 1:return e.originPosition==="lowerLeft"?ox(e,t+r,1):sUe(e,t+r,1)}}function Gae(e,t,i,r){return i===2?ox(e,t,2):pF(e,t,i,r)}function rUe(e,t,i,r){return i===2?ox(e,t,3):pF(e,t,i,r)}function nUe(e,t,i,r){return i===3?ox(e,t,3):Gae(e,t,i,r)}function ox({translate:e,scale:t},i,r){return e[r]+i*t[r]}function sUe({translate:e,scale:t},i,r){return e[r]-i*t[r]}class oUe{constructor(t){this._options=t,this.geometryTypes=["esriGeometryPoint","esriGeometryMultipoint","esriGeometryPolyline","esriGeometryPolygon"],this._previousCoordinate=[0,0],this._transform=null,this._applyTransform=iUe,this._lengths=[],this._currentLengthIndex=0,this._toAddInCurrentPath=0,this._vertexDimension=0,this._coordinateBuffer=null,this._coordinateBufferPtr=0,this._attributesConstructor=class{}}createFeatureResult(){return{fields:[],features:[]}}finishFeatureResult(t){if(this._options.applyTransform&&(t.transform=null),this._attributesConstructor=class{},this._coordinateBuffer=null,this._lengths.length=0,!t.hasZ)return;const i=Pk(t.geometryType,this._options.sourceSpatialReference,t.spatialReference);if(!ce(i))for(const r of t.features)i(r.geometry)}createSpatialReference(){return{}}addField(t,i){const r=t.fields;Zm(r),r.push(i);const n=r.map(o=>o.name);this._attributesConstructor=function(){for(const o of n)this[o]=null}}addFeature(t,i){t.features.push(i)}prepareFeatures(t){switch(this._transform=t.transform,this._options.applyTransform&&t.transform&&(this._applyTransform=this._deriveApplyTransform(t)),this._vertexDimension=2,t.hasZ&&this._vertexDimension++,t.hasM&&this._vertexDimension++,t.geometryType){case"esriGeometryPoint":this.addCoordinate=(i,r,n)=>this.addCoordinatePoint(i,r,n),this.createGeometry=i=>this.createPointGeometry(i);break;case"esriGeometryPolygon":this.addCoordinate=(i,r,n)=>this._addCoordinatePolygon(i,r,n),this.createGeometry=i=>this._createPolygonGeometry(i);break;case"esriGeometryPolyline":this.addCoordinate=(i,r,n)=>this._addCoordinatePolyline(i,r,n),this.createGeometry=i=>this._createPolylineGeometry(i);break;case"esriGeometryMultipoint":this.addCoordinate=(i,r,n)=>this._addCoordinateMultipoint(i,r,n),this.createGeometry=i=>this._createMultipointGeometry(i)}}createFeature(){return this._lengths.length=0,this._currentLengthIndex=0,this._previousCoordinate[0]=0,this._previousCoordinate[1]=0,this._coordinateBuffer=null,this._coordinateBufferPtr=0,{attributes:new this._attributesConstructor}}allocateCoordinates(){}addLength(t,i,r){this._lengths.length===0&&(this._toAddInCurrentPath=i),this._lengths.push(i)}addQueryGeometry(t,i){const{queryGeometry:r,queryGeometryType:n}=i,o=vA(r.clone(),r,!1,!1,this._transform),c=XJ(o,n,!1,!1);t.queryGeometryType=n,t.queryGeometry=K({},c)}createPointGeometry(t){const i={x:0,y:0,spatialReference:t.spatialReference};return t.hasZ&&(i.z=0),t.hasM&&(i.m=0),i}addCoordinatePoint(t,i,r){const n=Yn(this._transform,"transform");switch(i=this._applyTransform(n,i,r,0),r){case 0:t.x=i;break;case 1:t.y=i;break;case 2:"z"in t?t.z=i:t.m=i;break;case 3:t.m=i}}_transformPathLikeValue(t,i){let r=0;i<=1&&(r=this._previousCoordinate[i],this._previousCoordinate[i]+=t);const n=Yn(this._transform,"transform");return this._applyTransform(n,t,i,r)}_addCoordinatePolyline(t,i,r){this._dehydratedAddPointsCoordinate(t.paths,i,r)}_addCoordinatePolygon(t,i,r){this._dehydratedAddPointsCoordinate(t.rings,i,r)}_addCoordinateMultipoint(t,i,r){r===0&&t.points.push([]);const n=this._transformPathLikeValue(i,r);t.points[t.points.length-1].push(n)}_createPolygonGeometry(t){return{rings:[[]],spatialReference:t.spatialReference,hasZ:!!t.hasZ,hasM:!!t.hasM}}_createPolylineGeometry(t){return{paths:[[]],spatialReference:t.spatialReference,hasZ:!!t.hasZ,hasM:!!t.hasM}}_createMultipointGeometry(t){return{points:[],spatialReference:t.spatialReference,hasZ:!!t.hasZ,hasM:!!t.hasM}}_dehydratedAddPointsCoordinate(t,i,r){r===0&&this._toAddInCurrentPath--==0&&(t.push([]),this._toAddInCurrentPath=this._lengths[++this._currentLengthIndex]-1,this._previousCoordinate[0]=0,this._previousCoordinate[1]=0);const n=this._transformPathLikeValue(i,r),o=t[t.length-1];r===0&&(this._coordinateBufferPtr=0,this._coordinateBuffer=new Array(this._vertexDimension),o.push(this._coordinateBuffer)),this._coordinateBuffer[this._coordinateBufferPtr++]=n}_deriveApplyTransform(t){const{hasZ:i,hasM:r}=t;return i&&r?nUe:i?Gae:r?rUe:pF}}async function KYe(e,t,i){const r=Br(e),n=K({},i),o=co.from(t),c=!o.quantizationParameters,{data:h}=await TJ(r,o,new oUe({sourceSpatialReference:o.sourceSpatialReference,applyTransform:c}),n);return h}function aUe(e){const t=e.toJSON();return t.attachmentTypes&&(t.attachmentTypes=t.attachmentTypes.join(",")),t.keywords&&(t.keywords=t.keywords.join(",")),t.globalIds&&(t.globalIds=t.globalIds.join(",")),t.objectIds&&(t.objectIds=t.objectIds.join(",")),t.size&&(t.size=t.size.join(",")),t}function lUe(e,t){const i={};for(const r of e){const{parentObjectId:n,parentGlobalId:o,attachmentInfos:c}=r;for(const h of c){const{id:m}=h,b=tB(_B(`${t}/${n}/attachments/${m}`)),x=sW.fromJSON(h);x.set({url:b,parentObjectId:n,parentGlobalId:o}),i[n]?i[n].push(x):i[n]=[x]}}return i}function cUe(e,t,i){let r={query:r2(K(Ce(K({},e.query),{f:"json"}),aUe(t)))};return i&&(r=Ce(K(K({},i),r),{query:K(K({},i.query),r.query)})),Nt(e.path+"/queryAttachments",r)}async function YYe(e,t,i){const r=Br(e);return cUe(r,T9.from(t),K({},i)).then(n=>lUe(n.data.attachmentGroups,r.path))}async function XYe(e,t,i){const r=Br(e);return AJ(r,co.from(t),K({},i)).then(n=>n.data.count)}async function QYe(e,t,i){const r=Br(e);return PJ(r,co.from(t),K({},i)).then(n=>({count:n.data.count,extent:gi.fromJSON(n.data.extent)}))}async function eXe(e,t,i){const r=Br(e);return kJ(r,co.from(t),K({},i)).then(n=>n.data.objectIds)}function uUe(e,t){const i=e.toJSON();return i.objectIds&&(i.objectIds=i.objectIds.join(",")),i.orderByFields&&(i.orderByFields=i.orderByFields.join(",")),i.outFields&&!(t==null?void 0:t.returnCountOnly)?i.outFields.includes("*")?i.outFields="*":i.outFields=i.outFields.join(","):delete i.outFields,i.outSpatialReference&&(i.outSR=i.outSR.wkid||JSON.stringify(i.outSR.toJSON()),delete i.outSpatialReference),i.dynamicDataSource&&(i.layer=JSON.stringify({source:i.dynamicDataSource}),delete i.dynamicDataSource),i}async function hUe(e,t,i){const r=await Bae(e,t,i),n=r.data,o=n.geometryType,c=n.spatialReference,h={};for(const m of n.relatedRecordGroups){const b={fields:void 0,objectIdFieldName:void 0,geometryType:o,spatialReference:c,hasZ:!!n.hasZ,hasM:!!n.hasM,features:m.relatedRecords};if(m.objectId!=null)h[m.objectId]=b;else for(const x in m)m.hasOwnProperty(x)&&x!=="relatedRecords"&&(h[m[x]]=b)}return Ce(K({},r),{data:h})}async function pUe(e,t,i){const r=await Bae(e,t,i,{returnCountOnly:!0}),n=r.data,o={};for(const c of n.relatedRecordGroups)c.objectId!=null&&(o[c.objectId]=c.count);return Ce(K({},r),{data:o})}async function Bae(e,t,i={},r){const n=r2(K(K(Ce(K({},e.query),{f:"json"}),r),uUe(t,r)));return Nt(e.path+"/queryRelatedRecords",Ce(K({},i),{query:K(K({},i.query),n)}))}async function tXe(e,t,i){t=_y.from(t);const r=Br(e);return hUe(r,t,i).then(n=>{const o=n.data,c={};return Object.keys(o).forEach(h=>c[h]=Gh.fromJSON(o[h])),c})}async function iXe(e,t,i){t=_y.from(t);const r=Br(e);return pUe(r,t,K({},i)).then(n=>n.data)}const Uae="Layer does not support extent calculation.";function dUe(e,t){var o,c;const i=e.geometry,r=e.toJSON(),n=r;if(H(i)&&(n.geometry=JSON.stringify(i),n.geometryType=bh(i),n.inSR=i.spatialReference.wkid||JSON.stringify(i.spatialReference)),((o=r.topFilter)==null?void 0:o.groupByFields)&&(n.topFilter.groupByFields=r.topFilter.groupByFields.join(",")),((c=r.topFilter)==null?void 0:c.orderByFields)&&(n.topFilter.orderByFields=r.topFilter.orderByFields.join(",")),r.topFilter&&(n.topFilter=JSON.stringify(n.topFilter)),r.objectIds&&(n.objectIds=r.objectIds.join(",")),r.orderByFields&&(n.orderByFields=r.orderByFields.join(",")),r.outFields&&!((t==null?void 0:t.returnCountOnly)||(t==null?void 0:t.returnExtentOnly)||(t==null?void 0:t.returnIdsOnly))?r.outFields.includes("*")?n.outFields="*":n.outFields=r.outFields.join(","):delete n.outFields,r.outSR?n.outSR=r.outSR.wkid||JSON.stringify(r.outSR):i&&r.returnGeometry&&(n.outSR=n.inSR),r.returnGeometry&&delete r.returnGeometry,r.timeExtent){const h=r.timeExtent,{start:m,end:b}=h;m==null&&b==null||(n.time=m===b?m:`${m!=null?m:"null"},${b!=null?b:"null"}`),delete r.timeExtent}return n}async function fUe(e,t,i,r){const n=await x$(e,t,"json",r);return X9(t,i,n.data),n}async function yUe(e,t,i){return H(t.timeExtent)&&t.timeExtent.isEmpty?{data:{objectIds:[]}}:x$(e,t,"json",i,{returnIdsOnly:!0})}async function mUe(e,t,i){return H(t.timeExtent)&&t.timeExtent.isEmpty?{data:{count:0,extent:null}}:x$(e,t,"json",i,{returnExtentOnly:!0,returnCountOnly:!0}).then(r=>{const n=r.data;if(n.hasOwnProperty("extent"))return r;if(n.features)throw new Error(Uae);if(n.hasOwnProperty("count"))throw new Error(Uae);return r})}function gUe(e,t,i){return H(t.timeExtent)&&t.timeExtent.isEmpty?Promise.resolve({data:{count:0}}):x$(e,t,"json",i,{returnIdsOnly:!0,returnCountOnly:!0})}function x$(e,t,i,r={},n={}){const o=typeof e=="string"?mn(e):e,c=t.geometry?[t.geometry]:[];return r.responseType=i==="pbf"?"array-buffer":"json",d1(c,null,r).then(h=>{const m=h&&h[0];H(m)&&((t=t.clone()).geometry=m);const b=r2(K(K(Ce(K({},o.query),{f:i}),n),dUe(t,n)));return Nt(Cd(o.path,"queryTopFeatures"),Ce(K({},r),{query:K(K({},b),r.query)}))})}async function rXe(e,t,i,r){const n=Br(e),o=K({},r),{data:c}=await fUe(n,tf.from(t),i,o);return Gh.fromJSON(c)}async function nXe(e,t,i){const r=Br(e);return(await yUe(r,tf.from(t),K({},i))).data.objectIds}async function sXe(e,t,i){const r=Br(e),n=await mUe(r,tf.from(t),K({},i));return{count:n.data.count,extent:gi.fromJSON(n.data.extent)}}async function oXe(e,t,i){const r=Br(e);return(await gUe(r,tf.from(t),K({},i))).data.count}function vUe(e,t){for(var i=0;i<t.length;i++){const r=t[i];if(typeof r!="string"&&!Array.isArray(r)){for(const n in r)if(n!=="default"&&!(n in e)){const o=Object.getOwnPropertyDescriptor(r,n);o&&Object.defineProperty(e,n,o.get?o:{enumerable:!0,get:()=>r[n]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}var dF={exports:{}};(function(e,t){function i(){function n(d){if(typeof d=="number")return Q.Uc.ah(d);if(d==null)return null;if(oi[d]!=null)return Q.Uc.ah(oi[d]);throw Error("Unrecognised Unit Type")}function o(d){if(typeof d=="number")return Q.Uc.ah(d);if(d==null)return null;if(Si[d]!=null)return Q.Uc.ah(Si[d]);throw Error("Unrecognised Unit Type")}function c(d){if(d)switch(d){case"loxodrome":return 1;case"great-elliptic":return 2;case"normal-section":return 3;case"shape-preserving":return 4}return 0}function h(d,O,S,p){if(S==null||S.B())return null;switch(S.K()){case Q.sn.Point:return d.exportPoint(O,S,p);case Q.sn.Polygon:return d.exportPolygon(O,S,p);case Q.sn.Polyline:return d.exportPolyline(O,S,p);case Q.sn.MultiPoint:return d.exportMultipoint(O,S,p);case Q.sn.Envelope:return d.exportExtent(O,S,p)}return null}function m(d,O,S,p){if(S.K()!==Q.sn.Point)throw Error("Geometry not Point");return d.exportPoint(O,S,p)}function b(d,O,S){return d.convertToGEGeometry(O,S)}function x(d){var O=d.wkid;d=d.wkt;var S=Bi.get(O||d);return S==null&&(O!==-1&&O!=null?(S=Q.Gg.create(O),Bi.set(O,S)):d&&(S=Q.Gg.lP(d),Bi.set(d,S)),Ls.has(O||d)&&S.QW(Ls.get(O||d))),S}function I(d){var O;if(d==null)return null;var S=x(d);return d=S.Id(),S=S.Mn(),(O={}).tolerance=S,O.unitType=d==null?-1:d.pd,O.unitID=d==null?-1:d.Fc(),O.unitBaseFactor=d==null?0:d.ci,O.unitSquareDerivative=d==null?0:Q.Uc.WF(d).Fc(),O}function E(d,O,S,p){return S==null?null:(S=Q.ac.clip(b(d,Ue,S),b(d,Ue,p),x(O)),h(d,Ue,S,O))}function k(d,O,S,p){S=Q.ac.fl(b(d,Ue,S),b(d,Ue,p),x(O)),p=[];for(var l=0;l<S.length;l++)p.push(h(d,Ue,S[l],O));return p}function P(d,O,S,p){if(S==null||p==null)throw Error("Illegal Argument Exception");return Q.ac.contains(b(d,Ue,S),b(d,Ue,p),x(O))}function F(d,O,S,p){if(S==null||p==null)throw Error("Illegal Argument Exception");return Q.ac.wP(b(d,Ue,S),b(d,Ue,p),x(O))}function N(d,O,S,p,l){if(S==null||p==null)throw Error("Illegal Argument Exception");return Q.ac.ub(b(d,Ue,S),b(d,Ue,p),x(O),n(l))}function B(d,O,S,p){return!(S==null&&p!=null||p==null&&S!=null)&&Q.ac.Nb(b(d,Ue,S),b(d,Ue,p),x(O))}function z(d,O,S,p){if(S==null||p==null)throw Error("Illegal Argument Exception");return Q.ac.OS(b(d,Ue,S),b(d,Ue,p),x(O))}function q(d,O,S,p){if(S==null||p==null)throw Error("Illegal Argument Exception");return Q.ac.touches(b(d,Ue,S),b(d,Ue,p),x(O))}function J(d,O,S,p){if(S==null||p==null)throw Error("Illegal Argument Exception");return Q.ac.mY(b(d,Ue,S),b(d,Ue,p),x(O))}function X(d,O,S,p){if(S==null||p==null)throw Error("Illegal Argument Exception");return Q.ac.OP(b(d,Ue,S),b(d,Ue,p),x(O))}function Y(d,O,S,p){if(S==null||p==null)throw Error("Illegal Argument Exception");return Q.ac.yU(b(d,Ue,S),b(d,Ue,p),x(O))}function ae(d,O,S,p,l){if(S==null||p==null)throw Error("Illegal Argument Exception");return Q.ac.tB(b(d,Ue,S),b(d,Ue,p),x(O),l)}function he(d,O,S){if(S==null)throw Error("Illegal Argument Exception");return Q.ac.ZS(b(d,Ue,S),x(O))}function fe(d,O,S){if(S==null)throw Error("Illegal Argument Exception");return S=Q.ac.$B(b(d,Ue,S),x(O)),h(d,Ue,S,O)}function ye(d,O,S,p){if(p===void 0&&(p=!1),S==null)throw Error("Illegal Argument Exception");if(Array.isArray(S)){var l=p,s=[];for(p=0;p<S.length;p++)s.push(b(d,Ue,S[p]));for(S=Q.ac.eP(s,l),l=Array(S.length),p=0;p<S.length;p++)l[p]=h(d,Ue,S[p],O);return l}return p=Q.ac.dP(b(d,Ue,S),x(O)),h(d,Ue,p,O)}function xe(d,O,S,p){if(S==null||p==null)throw Error("Illegal Argument Exception");if(Array.isArray(S)){for(var l=[],s=0;s<S.length;s++)l.push(b(d,Ue,S[s]));for(S=Q.ac.LP(l,b(d,Ue,p),x(O)),p=Array(S.length),s=0;s<S.length;s++)p[s]=h(d,Ue,S[s],O);return p}return s=Q.ac.km(b(d,Ue,S),b(d,Ue,p),x(O)),h(d,Ue,s,O)}function Se(d,O,S,p){if(S==null||p==null)throw Error("Illegal Argument Exception");if(Array.isArray(S)){for(var l=[],s=0;s<S.length;s++)l.push(b(d,Ue,S[s]));for(S=Q.ac.RX(l,b(d,Ue,p),x(O)),p=Array(S.length),s=0;s<S.length;s++)p[s]=h(d,Ue,S[s],O);return p}return s=Q.ac.gp(b(d,Ue,S),b(d,Ue,p),x(O)),h(d,Ue,s,O)}function Ae(d,O,S,p){if(S==null||p==null)throw Error("Illegal Argument Exception");if(Array.isArray(S)){for(var l=[],s=0;s<S.length;s++)l.push(b(d,Ue,S[s]));for(S=Q.ac.MS(l,b(d,Ue,p),x(O)),p=Array(S.length),s=0;s<S.length;s++)p[s]=h(d,Ue,S[s],O);return p}return s=Q.ac.Fa(b(d,Ue,S),b(d,Ue,p),x(O)),h(d,Ue,s,O)}function Oe(d,O,S,p){if(S==null)return null;var l=[];if(Array.isArray(S)){if(S.length===0)return null;for(p=0;p<S.length;p++)l.push(b(d,Ue,S[p]))}else l.push(b(d,Ue,S)),p!=null&&l.push(b(d,Ue,p));return h(d,Ue,Q.ac.fY(l,x(O)),O)}function bt(d,O,S,p,l,s,a,u){var f=0;if(s!=null)switch(s){case"round":f=0;break;case"bevel":f=1;break;case"miter":f=2;break;case"square":f=3}if(Array.isArray(S)){if(S==null)d=null;else if(S.length===0)d=[];else{var y=[];for(s=0;s<S.length;s++)y.push(b(d,Ue,S[s]));for(S=Q.ac.wU(y,x(O),p,f,a,u,n(l)),p=Array(S.length),s=0;s<S.length;s++)p[s]=h(d,Ue,S[s],O);d=p}return d}return S=Q.ac.offset(b(d,Ue,S),x(O),p,f,a,u,n(l)),h(d,Ue,S,O)}function st(d,O,S,p,l,s){if(s===void 0&&(s=!1),Array.isArray(S)){if(!Array.isArray(p)){for(var a=[],u=0;u<S.length;u++)a.push(p);p=a}if(p.length!=S.length){if(p.length==0)throw Error("Illegal Argument Exception");a=[];var f=0;for(u=0;u<S.length;u++)p[u]===void 0?a.push(f):(a.push(p[u]),f=p[u]);p=a}return He(d,O,S,p,l,!1,s,"geodesic",NaN)}return S=Q.ac.buffer(b(d,Ue,S),x(O),p,n(l),!1,0,NaN),h(d,Ue,S,O)}function et(d,O,S,p,l,s,a,u){if(Array.isArray(S)){if(!Array.isArray(p)){for(var f=[],y=0;y<S.length;y++)f.push(p);p=f}if(p.length!==S.length){if(p.length===0)throw Error("Illegal Argument Exception");f=[];var v=0;for(y=0;y<S.length;y++)p[y]===void 0?f.push(v):(f.push(p[y]),v=p[y]);p=f}return He(d,O,S,p,l,!0,s,a,u)}return a===void 0&&(a=NaN),S=Q.ac.buffer(b(d,Ue,S),x(O),p,n(l),!0,c(s),a),h(d,Ue,S,O)}function He(d,O,S,p,l,s,a,u,f){if(f===void 0&&(f=NaN),S==null)return null;if(S.length===0)return[];for(var y=[],v=0;v<S.length;v++)y.push(b(d,Ue,S[v]));for(S=Q.ac.HN(y,x(O),p,n(l),s,a,c(u),f),p=Array(S.length),v=0;v<S.length;v++)p[v]=h(d,Ue,S[v],O);return p}function Et(d,O,S,p,l){var s;return l===void 0&&(l=!0),S=Q.ac.iz(b(d,Ue,S),b(d,Ue,p),l),(s={}).coordinate=m(d,Ue,S.az(),O),s.distance=S.cz(),s.isRightSide=S.Nz(),s.vertexIndex=S.Va(),s.isEmpty=S.B(),s}function Gt(d,O,S,p){var l;return S=Q.ac.jz(b(d,Ue,S),b(d,Ue,p)),(l={}).coordinate=m(d,Ue,S.az(),O),l.distance=S.cz(),l.isRightSide=S.Nz(),l.vertexIndex=S.Va(),l.isEmpty=S.B(),l}function pi(d,O,S,p,l,s){var a;for(S=Q.ac.kz(b(d,Ue,S),b(d,Ue,p),l,s),p=[],l=0;l<S.length;l++)S[l].B()===!1&&p.push(((a={}).coordinate=m(d,Ue,S[l].az(),O),a.distance=S[l].cz(),a.isRightSide=S[l].Nz(),a.vertexIndex=S[l].Va(),a.isEmpty=S[l].B(),a));return p}function ei(d,O,S,p,l,s){return S=Q.ac.LQ(b(d,Ue,S),x(O),p,l,n(s)),h(d,Ue,S,O)}function pn(d,O,S,p,l){return S=Q.ac.Sr(b(d,Ue,S),x(O),p,n(l)),h(d,Ue,S,O)}function Sr(d,O,S,p,l,s){return s===void 0&&(s=0),S=Q.ac.Ry(b(d,Ue,S),x(O),p,n(l),s),h(d,Ue,S,O)}function je(d,O,S,p){if(S==null)throw Error("Illegal Argument Exception");return Q.ac.EU(b(d,Ue,S),x(O),o(p))}function at(d,O,S,p){if(S==null)throw Error("Illegal Argument Exception");return Q.ac.FU(b(d,Ue,S),x(O),n(p))}function rt(d,O,S,p,l){if(S==null)throw Error("Illegal Argument Exception");return Q.ac.RQ(b(d,Ue,S),x(O),o(p),c(l))}function It(d,O,S,p,l){if(S==null)throw Error("Illegal Argument Exception");return Q.ac.UQ(b(d,Ue,S),x(O),n(p),c(l))}function ni(d){Q.IL.bind(d)}function Ai(d,O,S,p,l){var s=null,a=null;if(p){if(!l)throw Q.i.O("AOI missing Spatial Reference");s=b(d,Ue,p),a=x(l).hh()}return(d=Q.iu.SR(x(O).hh(),x(S).hh(),s,a))!==null?d:null}function Ut(d,O,S,p,l){var s=null,a=null;if(p){if(!l)throw Q.i.O("AOI missing Spatial Reference");s=b(d,Ue,p),a=x(l).hh()}return Q.iu.TR(x(O).hh(),x(S).hh(),s,a)}function pe(d,O,S,p,l,s){if(l===void 0&&(l=null),s===void 0&&(s=null),s){var a=new Q.tC;a.Xu=s.densificationStep,a.Lr=s.centralMeridianOfOutputGCS,s.clipWithInputHorizon&&a.KW(s.clipWithInputHorizon),s.clipWithOutputHorizon&&a.LW(s.clipWithOutputHorizon)}if(this.GY===!1)throw Error("Projection Engine must be enabled using enableProjection");if(O.length===0)return[];if(l){if(!(s=l.getCachedGeTransformation(S,p)))e:{if(s=l,l=null,s){var u=s.getGTListEntry();if(u!==null){l=new Q.rC(null);for(var f=0,y=u.steps;f<y.length;f++){u=y[f];var v=new Q.Cx(u.geogtran);u.isInverse&&v.Lz(),l.add(v)}a=Q.xr.Pr(x(S).hh(),x(p).hh(),l,a),s.assignCachedGe(S,p,a),s=a;break e}}if(l===null&&s&&s.steps&&0<s.steps.length){for(l=new Q.rC(null),f=0,y=s.steps;f<y.length;f++)(u=y[f]).wkid!=-1&&u.wkid!=null?l.add(Q.Cx.create(u.wkid,u.isInverse)):l.add(Q.Cx.pP(u.wkt,u.isInverse));a=Q.xr.Pr(x(S).hh(),x(p).hh(),l,a),s.assignCachedGe(S,p,a),s=a}else s=Q.xr.Pr(x(S).hh(),x(p).hh(),l,a)}for(S=[],l=0;l<O.length;l++)a=O[l],S.push(be(d,a,p,s))}else for(s=Q.xr.Pr(x(S).hh(),x(p).hh(),null),S=[],l=0;l<O.length;l++)a=O[l],S.push(be(d,a,p,s));return S}function be(d,O,S,p){return O=Q.ac.Bh(b(d,Ue,O),p),h(d,Ue,O,S)}function Le(d,O){d!=null&&(d=d.wkid||d.wkt,Ls.has(d),Ls.set(d,O),Bi.has(d)&&Bi.delete(d))}function Ve(d){d!=null&&(d=d.wkid||d.wkt,Ls.has(d)&&(Ls.delete(d),Bi.has(d)&&Bi.delete(d)))}function Ge(d,O,S,p){if(S==null||p==null)return[];var l=[],s=0;for(S=Q.ac.LS(b(d,Ue,S),b(d,Ue,p),x(O))||[];s<S.length;s++)l.push(h(d,Ue,S[s],O));return l}var Be,Q,Je,Qe,Pe=this&&this.__extends||function(){function d(O,S){return(d=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(p,l){p.__proto__=l}||function(p,l){for(var s in l)l.hasOwnProperty(s)&&(p[s]=l[s])})(O,S)}return function(O,S){function p(){this.constructor=O}d(O,S),O.prototype=S===null?Object.create(S):(p.prototype=S.prototype,new p)}}();(function(d){var O;(O=d.sn||(d.sn={}))[O.Unknown=0]="Unknown",O[O.Point=33]="Point",O[O.Line=322]="Line",O[O.Envelope=197]="Envelope",O[O.MultiPoint=550]="MultiPoint",O[O.Polyline=1607]="Polyline",O[O.Polygon=1736]="Polygon",function(p){p[p.enumMild=0]="enumMild",p[p.enumMedium=1]="enumMedium",p[p.enumHot=2]="enumHot"}(d.TK||(d.TK={}));var S=function(){function p(){this.description=null,this.QA=0}return p.prototype.K=function(){return 0},p.prototype.Eb=function(){return-1},p.prototype.Pf=function(l){this.wc(),l!=this.description&&this.un(l)},p.prototype.un=function(){},p.prototype.Ll=function(l){this.wc(),l!=this.description&&(l=d.fe.xR(this.description,l))!=this.description&&this.un(l)},p.prototype.hasAttribute=function(l){return this.description.hasAttribute(l)},p.prototype.se=function(l){this.wc(),this.description.hasAttribute(l)||(l=d.fe.wR(this.description,l),this.un(l))},p.prototype.Vg=function(){return null},p.prototype.dn=function(){},p.prototype.A=function(){},p.prototype.So=function(){},p.prototype.yc=function(l){this.A(l)},p.prototype.B=function(){return!0},p.prototype.Pa=function(){},p.prototype.Pc=function(){},p.prototype.Ja=function(){return null},p.prototype.copyTo=function(){},p.prototype.He=function(){return 0},p.prototype.Rb=function(){return 0},p.prototype.dG=function(){return this.hasAttribute(1)},p.uf=function(l){return 1+((192&l)>>6)>>1},p.Tn=function(l){return(32&l)!=0},p.PS=function(l){return(128&l)!=0},p.zd=function(l){return(256&l)!=0},p.zj=function(l){return(512&l)!=0},p.Ic=function(l){return(1024&l)!=0},p.prototype.Qf=function(){var l=this.Ja();return this.copyTo(l),l},p.prototype.ng=function(){return null},p.kg=function(l){var s=l.Ja();return l.copyTo(s),s},p.prototype.wc=function(){0<=this.QA&&(this.QA+=2147483649)},p.zx=function(l){var s=l.K();if(p.zj(s))return l.I();if(l.B())return 0;if(s==197)return 4;if(s==33)return 1;if(p.zd(s))return 2;throw d.i.ga("missing type")},p}();d.ba=S})(Q||(Q={})),Je=Q||(Q={}),Qe=function(){function d(){this.y=this.x=0}return d.construct=function(O,S){var p=new d;return p.x=O,p.y=S,p},d.cl=function(O){var S=new d;return S.x=O.x,S.y=O.y,S},d.prototype.na=function(O,S){this.x=O,this.y=S},d.prototype.N=function(O){this.x=O.x,this.y=O.y},d.prototype.hq=function(O,S){return this.x===O&&this.y===S},d.prototype.Mz=function(O){return 2220446049250313e-31>=Math.abs(this.x-O.x)&&2220446049250313e-31>=Math.abs(this.y-O.y)},d.prototype.rb=function(O){return this.x===O.x&&this.y===O.y},d.prototype.Nb=function(O){return O==this||O instanceof d&&this.x==O.x&&this.y==O.y},d.prototype.sub=function(O){this.x-=O.x,this.y-=O.y},d.prototype.vc=function(O,S){this.x=O.x-S.x,this.y=O.y-S.y},d.prototype.add=function(O,S){S!==void 0?(this.x=O.x+S.x,this.y=O.y+S.y):(this.x+=O.x,this.y+=O.y)},d.prototype.Uq=function(){this.x=-this.x,this.y=-this.y},d.prototype.nt=function(O){this.x=-O.x,this.y=-O.y},d.prototype.IS=function(O,S,p){this.x=O.x*(1-p)+S.x*p,this.y=O.y*(1-p)+S.y*p},d.prototype.Dt=function(O,S){this.x=this.x*O+S.x,this.y=this.y*O+S.y},d.prototype.BW=function(O,S,p){this.x=S.x*O+p.x,this.y=S.y*O+p.y},d.prototype.scale=function(O){this.x*=O,this.y*=O},d.prototype.compare=function(O){return this.y<O.y?-1:this.y>O.y?1:this.x<O.x?-1:this.x>O.x?1:0},d.prototype.normalize=function(){var O=this.length();O==0&&(this.x=1,this.y=0),this.x/=O,this.y/=O},d.prototype.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y)},d.prototype.Uk=function(){return this.x*this.x+this.y*this.y},d.ub=function(O,S){return Math.sqrt(this.zc(O,S))},d.Jy=function(O,S,p,l){return O-=p,S-=l,Math.sqrt(O*O+S*S)},d.prototype.Sh=function(O){return this.x*O.x+this.y*O.y},d.prototype.aD=function(O){return Math.abs(this.x*O.x)+Math.abs(this.y*O.y)},d.prototype.yi=function(O){return this.x*O.y-this.y*O.x},d.prototype.Ct=function(O,S){var p=-this.x*S+this.y*O;this.x=this.x*O+this.y*S,this.y=p},d.prototype.Jv=function(){var O=this.x;this.x=-this.y,this.y=O},d.prototype.HG=function(O){this.x=-O.y,this.y=O.x},d.prototype.cr=function(){var O=this.x;this.x=this.y,this.y=-O},d.prototype.su=function(){return 0<this.x?0<=this.y?1:4:0<this.y?2:this.x==0?4:3},d.pu=function(O,S){var p=O.su(),l=S.su();return l==p?0>(O=O.yi(S))?1:0<O?-1:0:p<l?-1:1},d.zc=function(O,S){var p=O.x-S.x;return p*p+(O=O.y-S.y)*O},d.prototype.toString=function(){return"("+this.x+" , "+this.y+")"},d.prototype.Sc=function(){this.y=this.x=NaN},d.prototype.isNaN=function(){return isNaN(this.x)||isNaN(this.y)},d.prototype.offset=function(O,S){var p=d.ub(O,S),l=d.construct(this.x,this.y);if(p==0)return d.ub(l,O);var s=new d;return s.N(S),s.sub(O),l.sub(O),l.yi(s)/p},d.Wq=function(O,S,p){var l=new Je.Xb;l.set(S.x),l.sub(O.x);var s=new Je.Xb;s.set(p.y),s.sub(O.y);var a=new Je.Xb;a.set(S.y),a.sub(O.y);var u=new Je.Xb;return u.set(p.x),u.sub(O.x),l.Bg(s),a.Bg(u),l.sub(a),l.rs()?(l=new Je.jp(S.x),s=new Je.jp(O.x),a=new Je.jp(O.y),l=l.kt(s),O=(O=new Je.jp(p.y)).kt(a),S=(S=new Je.jp(S.y)).kt(a),p=(p=new Je.jp(p.x)).kt(s),l=l.nr(O),S=S.nr(p),(l=l.nr(S)).iT()?-1:l.aS()?1:0):0>(p=l.value())?-1:0<p?1:0},d.prototype.dc=function(){return Je.P.wj(Je.P.wj())},d}(),Je.h=Qe,function(d){var O=function(){function S(p){this.Ay=this.Ot=0,this.KX=p}return S.prototype.reset=function(){this.Ay=this.Ot=0},S.prototype.add=function(p){p-=this.Ay;var l=this.Ot+p;this.Ay=l-this.Ot-p,this.Ot=l},S.prototype.sub=function(p){this.add(-p)},S.prototype.tm=function(){return this.KX+this.Ot},S}();d.Ex=O,d.mc=function(){function S(){}return S.En=function(p,l){return 0<=l?Math.abs(p):-Math.abs(p)},S.sign=function(p){return 0>p?-1:0<p?1:0},S.MK=function(p){return p-360*Math.floor(p/360)},S.round=function(p){return Math.floor(p+.5)},S.ox=function(p){return p*p},S.jq=function(p,l,s){return .5>=s?p+(l-p)*s:l-(l-p)*(1-s)},S.JG=function(p,l,s,a){.5>=s?(a.x=p.x+(l.x-p.x)*s,a.y=p.y+(l.y-p.y)*s):(a.x=l.x-(l.x-p.x)*(1-s),a.y=l.y-(l.y-p.y)*(1-s))},S.gT=function(p,l,s,a,u,f){.5>=u?(f.x=p+(s-p)*u,f.y=l+(a-l)*u):(f.x=s-(s-p)*(1-u),f.y=a-(a-l)*(1-u))},S}()}(Q||(Q={})),function(d){var O=function(S){function p(){var l=S.call(this)||this;return l.ta=0,l.oa=0,l.qa=0,l.ma=0,l.la=null,l}return Pe(p,S),p.prototype.bc=function(){return d.h.construct(this.ta,this.oa)},p.prototype.$p=function(l){l.x=this.ta,l.y=this.oa},p.prototype.Ec=function(l){this.gm(0,l)},p.prototype.UB=function(l,s){this.gm(0,d.h.construct(l,s))},p.prototype.Vo=function(l){this.cD(0,l)},p.prototype.setStart=function(l){this.pD(0,l)},p.prototype.yv=function(l,s){return this.Pd(0,l,s)},p.prototype.TB=function(l,s,a){this.vn(0,l,s,a)},p.prototype.xc=function(){return d.h.construct(this.qa,this.ma)},p.prototype.Vr=function(l){l.x=this.qa,l.y=this.ma},p.prototype.Rc=function(l){this.gm(1,l)},p.prototype.Sl=function(l,s){this.gm(1,d.h.construct(l,s))},p.prototype.Ro=function(l){this.cD(1,l)},p.prototype.setEnd=function(l){this.pD(1,l)},p.prototype.jv=function(l,s){return this.Pd(1,l,s)},p.prototype.JB=function(l,s,a){this.vn(1,l,s,a)},p.prototype.Eb=function(){return 1},p.prototype.B=function(){return this.Bc()},p.prototype.Pa=function(){},p.prototype.He=function(){return 0},p.prototype.Fa=function(l,s,a,u,f){return this.FM(l,s,a,u,f)},p.prototype.isIntersecting=function(l,s){return this.Br(l,s,!1)!=0},p.prototype.ss=function(l,s){return this.tu(l,s,!1)},p.prototype.tu=function(){return null},p.prototype.Bc=function(){return!1},p.prototype.$x=function(l){if(this.wc(),this.la==null&&0<l)this.la=d.P.mg(2*l);else if(this.la!=null&&this.la.length<2*l){for(var s=this.la.slice(0),a=this.la.length;a<2*l;a++)s[a]=0;this.la=s}},p.bM=function(l,s,a){if(0<a)var u=0;for(var f=0;f<a;f++)s[0+u]=l[0],u++},p.prototype.gm=function(l,s){l!=0?(this.qa=s.x,this.ma=s.y):(this.ta=s.x,this.oa=s.y)},p.prototype.un=function(l){if(this.la!=null){for(var s=d.fe.Kw(l,this.description),a=[],u=p.Ig(this.description,0),f=p.Ig(this.description,1),y=p.Ig(l,0),v=p.Ig(l,1),_=0,M=1,$=l.Ba;M<$;M++){var T=l.ld(M),A=d.sa.Wa(T);if(s[M]==-1){var R=d.sa.te(T);for(T=0;T<A;T++)a[y+_]=R,a[v+_]=R,_++}else for(R=this.description.bk(s[M])-2,T=0;T<A;T++)a[y+_]=this.la[u+R],a[v+_]=this.la[f+R],_++,R++}this.la=a}this.description=l},p.prototype.cD=function(l,s){if(this.Bc())throw d.i.ga("empty geometry");s.Pf(this.description),s.Bc()&&s.wn();for(var a=0;a<this.description.Ba;a++)for(var u=this.description.Fd(a),f=0,y=d.sa.Wa(u);f<y;f++){var v=this.Pd(l,u,f);s.setAttribute(u,f,v)}},p.prototype.pD=function(l,s){if(this.wc(),s.Bc())throw d.i.ga("empty geometry");for(var a=s.description,u=0,f=a.Ba;u<f;u++)for(var y=a.Fd(u),v=d.sa.Wa(y),_=0;_<v;_++){var M=s.Vc(y,_);this.vn(l,y,_,M)}},p.prototype.Pd=function(l,s,a){if(this.Bc())throw d.i.ga("This operation was performed on an Empty Geometry.");if(s==0)return l!=0?a!=0?this.ma:this.qa:a!=0?this.oa:this.ta;if(a>=d.sa.Wa(s))throw d.i.de();var u=this.description.Rf(s);return 0<=u?(this.la!=null&&this.$x(this.description.Be.length-2),this.la[p.Ig(this.description,l)+this.description.bk(u)-2+a]):d.sa.te(s)},p.prototype.vn=function(l,s,a,u){if(this.wc(),a>=d.sa.Wa(s))throw d.i.de();var f=this.description.Rf(s);0>f&&(this.se(s),f=this.description.Rf(s)),s==0?l!=0?a!=0?this.ma=u:this.qa=u:a!=0?this.oa=u:this.ta=u:(this.la==null&&this.$x(this.description.Be.length-2),this.la[p.Ig(this.description,l)+this.description.bk(f)-2+a]=u)},p.prototype.copyTo=function(l){if(l.K()!=this.K())throw d.i.O();l.description=this.description,l.$x(this.description.Be.length-2),p.bM(this.la,l.la,2*(this.description.Be.length-2)),l.ta=this.ta,l.oa=this.oa,l.qa=this.qa,l.ma=this.ma,l.wc(),this.qp(l)},p.prototype.Vg=function(l,s){var a=new d.Oc;return this.Bc()?(a.Pa(),a):(a.pa=this.Pd(0,l,s),a.wa=a.pa,a.Nk(this.Pd(1,l,s)),a)},p.prototype.UI=function(l){this.Bc()?l.Pa():(l.pa=this.Pd(0,0,0),l.wa=l.pa,l.Nk(this.Pd(1,0,0)))},p.prototype.Vw=function(l,s){s.Pf(this.description),s.Db(this.ic(l));for(var a=1,u=this.description.Ba;a<u;a++)for(var f=this.description.Fd(a),y=d.sa.Wa(f),v=0;v<y;v++){var _=this.Vc(l,f,v);s.setAttribute(f,v,_)}},p.prototype.AM=function(l){if(this.description!=l.description||this.ta!=l.ta||this.qa!=l.qa||this.oa!=l.oa||this.ma!=l.ma)return!1;for(var s=0;s<2*(this.description.Be.length-2);s++)if(this.la[s]!=l.la[s])return!1;return!0},p.prototype.wG=function(){return this.ta==this.qa&&this.oa==this.ma},p.prototype.reverse=function(){var l=this.ta;this.ta=this.qa,this.qa=l,l=this.oa,this.oa=this.ma,this.ma=l,l=1;for(var s=this.description.Ba;l<s;l++)for(var a=this.description.ld(l),u=0,f=d.sa.Wa(a);u<f;u++){var y=this.Pd(0,a,u),v=this.Pd(1,a,u);this.vn(0,a,u,v),this.vn(1,a,u,y)}},p.prototype.Br=function(l,s,a){var u=l.K();if(this.K()===322){if(u==322)return d.zb.JM(this,l,s,a);throw d.i.Ra()}throw d.i.Ra()},p.prototype.FM=function(l,s,a,u,f){var y=l.K();if(this.K()===322){if(y==322)return d.zb.Yx(this,l,s,a,u,f);throw d.i.Ra()}throw d.i.Ra()},p.prototype.Sx=function(){return null},p.Ig=function(l,s){return s*(l.Be.length-2)},p.prototype.ic=function(l,s){if(s===void 0)return s=new d.h,this.ic(l,s),s;d.mc.gT(this.ta,this.oa,this.qa,this.ma,l,s)},p.prototype.ge=function(){return null},p.prototype.$F=function(){return null},p.prototype.fq=function(){return null},p.prototype.Di=function(){return null},p.prototype.Rn=function(){return null},p.prototype.lg=function(){return null},p.prototype.Tx=function(l,s){return s!==void 0?this.ux(s)-this.ux(l):this.ux(l)},p.prototype.qp=function(){},p.prototype.fl=function(){return null},p.prototype.dh=function(){},p.prototype.Vc=function(){return null},p.prototype.Me=function(){return null},p.prototype.ux=function(){return null},p.prototype.IG=function(){return null},p.prototype.ub=function(l,s){if(!s&&this.Br(l,0,!1)!=0)return 0;s=17976931348623157e292;var a=this.bc(),u=l.ge(a,!1);return a.sub(l.ic(u)),(a=a.length())<s&&(s=a),a=this.xc(),u=l.ge(a,!1),a.sub(l.ic(u)),(a=a.length())<s&&(s=a),a=l.bc(),u=this.ge(a,!1),a.sub(this.ic(u)),(a=a.length())<s&&(s=a),a=l.xc(),u=this.ge(a,!1),a.sub(this.ic(u)),(a=a.length())<s&&(s=a),s},p.prototype.ng=function(){return d.si.im(this,null)},p}(d.ba);d.NC=O}(Q||(Q={})),new Q.h,function(d){var O;(O=d.VK||(d.VK={}))[O.Unknown=-1]="Unknown",O[O.Not=0]="Not",O[O.Weak=1]="Weak",O[O.Strong=2]="Strong",function(p){p[p.DirtyIsKnownSimple=1]="DirtyIsKnownSimple",p[p.IsWeakSimple=2]="IsWeakSimple",p[p.IsStrongSimple=4]="IsStrongSimple",p[p.DirtyOGCFlags=8]="DirtyOGCFlags",p[p.DirtyVerifiedStreams=32]="DirtyVerifiedStreams",p[p.DirtyExactIntervals=64]="DirtyExactIntervals",p[p.DirtyLooseIntervals=128]="DirtyLooseIntervals",p[p.DirtyIntervals=192]="DirtyIntervals",p[p.DirtyIsEnvelope=256]="DirtyIsEnvelope",p[p.DirtyLength2D=512]="DirtyLength2D",p[p.DirtyRingAreas2D=1024]="DirtyRingAreas2D",p[p.DirtyCoordinates=1993]="DirtyCoordinates",p[p.DirtyAllInternal=65535]="DirtyAllInternal",p[p.DirtyAll=16777215]="DirtyAll"}(d.HK||(d.HK={}));var S=function(p){function l(){var s=p.call(this)||this;return s.Jm=65535,s.xa=0,s.Rg=-1,s.Cb=null,s}return Pe(l,p),l.prototype.qp=function(){},l.prototype.Zx=function(){},l.prototype.ey=function(){},l.prototype.I=function(){return this.xa},l.prototype.B=function(){return this.Bc()},l.prototype.Bc=function(){return this.xa==0},l.prototype.ck=function(s){return(this.Jm&s)!=0},l.prototype.Nf=function(s,a){this.Jm=a?this.Jm|s:this.Jm&~s},l.prototype.oc=function(){this.ck(32)&&this.XM()},l.prototype.vx=function(){if(this.Bc())throw d.i.ga("This operation was performed on an Empty Geometry.")},l.prototype.we=function(s,a){if(0>s||s>=this.xa)throw d.i.ga("index out of bounds");this.oc(),a.Pf(this.description),a.B()&&a.wn();for(var u=0;u<this.description.Ba;u++)for(var f=this.description.Fd(u),y=0,v=d.sa.Wa(f);y<v;y++){var _=this.Aa[u].gg(v*s+y);a.setAttribute(f,y,_)}},l.prototype.It=function(s,a){this.oc();for(var u=a.description,f=0;f<u.Ba;f++)for(var y=u.Fd(f),v=d.sa.Wa(y),_=0;_<v;_++){var M=a.Vc(y,_);this.setAttribute(y,s,_,M)}},l.prototype.D=function(s,a){if(0>s||s>=this.I())throw d.i.de();this.oc(),this.Aa[0].uc(2*s,a)},l.prototype.Oa=function(s){var a=new d.h;return this.D(s,a),a},l.prototype.Hc=function(s,a){this.Aa[0].uc(2*s,a)},l.prototype.Db=function(s,a,u){if(0>s||s>=this.xa)throw d.i.de();this.oc();var f=this.Aa[0];u!==void 0?(f.write(2*s,a),f.write(2*s+1,u)):f.Vt(2*s,a),this.Qc(1993)},l.prototype.xz=function(){if(void 0>=this.I())throw d.i.de();this.oc();var s=this.Aa[0],a=new d.Od;return a.x=s.read(NaN),a.y=s.read(NaN),a.z=this.hasAttribute(1)?this.Aa[1].gg(void 0):d.sa.te(1),a},l.prototype.ZB=function(s){if(0>s||s>=this.I())throw d.i.de();this.se(1),this.oc(),this.Qc(1993);var a=this.Aa[0];a.write(2*s,(void 0).x),a.write(2*s+1,(void 0).y),this.Aa[1].rr(s,(void 0).z)},l.prototype.Vc=function(s,a,u){if(0>a||a>=this.xa)throw d.i.de();var f=d.sa.Wa(s);if(u>=f)throw d.i.de();this.oc();var y=this.description.Rf(s);return 0<=y?this.Aa[y].gg(a*f+u):d.sa.te(s)},l.prototype.tF=function(s,a){return this.Vc(s,a,void 0)},l.prototype.setAttribute=function(s,a,u,f){if(0>a||a>=this.xa)throw d.i.de();var y=d.sa.Wa(s);if(u>=y)throw d.i.de();this.se(s),this.oc(),s=this.description.Rf(s),this.Qc(1993),this.Aa[s].rr(a*y+u,f)},l.prototype.vb=function(s){return this.vx(),this.se(s),this.oc(),this.Aa[this.description.Rf(s)]},l.prototype.kn=function(s,a){if(a!=null&&d.sa.Vp(s)!=a.Vp())throw d.i.O();this.se(s),s=this.description.Rf(s),this.Aa==null&&(this.Aa=d.Zc.lI(this.description.Ba)),this.Aa[s]=a,this.Qc(16777215)},l.prototype.un=function(s){var a=null;if(this.Aa!=null){var u=d.fe.Kw(s,this.description);a=[];for(var f=0,y=s.Ba;f<y;f++)u[f]!=-1&&(a[f]=this.Aa[u[f]])}this.description=s,this.Aa=a,this.Rg=-1,this.Qc(16777215)},l.prototype.vD=function(s){this.yu(!0),s instanceof d.l?this.aa.A(s):this.aa.So(s)},l.prototype.WM=function(s){this.yu(!1),s instanceof d.l?this.aa.A(s):this.aa.So(s)},l.prototype.dn=function(s){this.yu(!0),this.aa.copyTo(s)},l.prototype.A=function(s){this.vD(s)},l.prototype.So=function(s){this.vD(s)},l.prototype.yc=function(s){this.WM(s)},l.prototype.Vg=function(s,a){var u=new d.Oc;return this.Bc()?(u.Pa(),u):(this.yu(!0),this.aa.Vg(s,a))},l.prototype.dc=function(){var s=this.description.dc();if(!this.Bc())for(var a=this.I(),u=0,f=this.description.Ba;u<f;u++)s=this.Aa[u].Cn(s,0,a*d.sa.Wa(this.description.Fd(u)));return s},l.prototype.Nb=function(s){if(s==this)return!0;if(!(s instanceof l&&this.description.Nb(s.description))||this.Bc()!=s.Bc())return!1;if(this.Bc())return!0;var a=this.I();if(a!=s.I())return!1;for(var u=0;u<this.description.Ba;u++){var f=this.description.ld(u),y=this.vb(f),v=s.vb(f);if(!y.Nb(v,0,a*d.sa.Wa(f)))return!1}return!0},l.prototype.copyTo=function(s){if(s.K()!=this.K())throw d.i.O();this.ZC(s)},l.prototype.ZC=function(s){this.oc(),s.description=this.description,s.Aa=null;var a=this.description.Ba,u=null;if(this.Aa!=null){u=[];for(var f=0;f<a;f++)this.Aa[f]!=null&&(u[f]=this.Aa[f].BB(this.I()*d.sa.Wa(this.description.Fd(f))))}this.aa!=null?(s.aa=this.aa.Ja(),this.aa.copyTo(s.aa)):s.aa=null,s.xa=this.xa,s.Jm=this.Jm,s.Aa=u;try{this.qp(s)}catch{throw s.Pa(),d.i.hu()}},l.prototype.rD=function(){this.xa=0,this.Rg=-1,this.Aa=null,this.Qc(16777215)},l.prototype.Qc=function(s){s==16777215&&(this.Rg=-1,this.Zx()),this.Jm|=s,this.gM(),this.wc()},l.prototype.yu=function(s){if(this.oc(),this.ck(192))if(this.aa==null?this.aa=new d.Hh(this.description):this.aa.Pf(this.description),this.B())this.aa.Pa();else{this.dy(s);for(var a=1;a<this.description.Ba;a++)for(var u=this.description.Fd(a),f=d.sa.Wa(u),y=this.Aa[a],v=0;v<f;v++){var _=new d.Oc;_.Pa();for(var M=0;M<this.xa;M++){var $=y.gg(M*f+v);_.$b($)}this.aa.setInterval(u,v,_)}s&&this.Nf(192,!1)}},l.prototype.dy=function(){this.aa.Pa();for(var s=this.Aa[0],a=new d.h,u=0;u<this.xa;u++)s.uc(2*u,a),this.aa.$b(a)},l.prototype.Ap=function(s){s.Pa();for(var a=this.Aa[0],u=new d.h,f=0;f<this.xa;f++)a.uc(2*f,u),s.$b(u)},l.prototype.XM=function(){if(this.Rg<this.xa){this.Aa==null&&(this.Aa=d.Zc.lI(this.description.Ba)),this.Rg=2147483647;for(var s=0;s<this.description.Ba;s++){var a=this.description.Fd(s);if(this.Aa[s]!=null){var u=d.sa.Wa(a),f=d.P.truncate(this.Aa[s].size/u);f<this.xa&&(f=d.P.truncate(this.Rg>this.xa+5?(5*this.xa+3)/4:this.xa),this.Aa[s].resize(f*u,d.sa.te(a))),f<this.Rg&&(this.Rg=f)}else this.Aa[s]=d.Zc.TE(a,this.xa),this.Rg=this.xa}}this.ey(),this.Nf(32,!1)},l.prototype.fm=function(s){if(0>s)throw d.i.O();s!=this.xa&&(this.xa=s,this.Qc(65535))},l.prototype.qm=function(s){if(!this.ck(1)){if(!this.ck(2))return 0;if(this.LT>=s)return this.ck(8)?1:2}return-1},l.prototype.Eh=function(s,a){if(this.LT=a,s==-1)this.Nf(1,!0),this.Nf(8,!0);else if(this.Nf(1,!1),this.Nf(8,!0),s==0)this.Nf(2,!1),this.Nf(4,!1);else if(s==1)this.Nf(2,!0),this.Nf(4,!1);else{if(s!=2)throw d.i.ga("internal error.");this.Nf(2,!0),this.Nf(4,!0)}},l.prototype.gM=function(){this.Cb!=null&&(this.Cb=null)},l.prototype.fD=function(s,a,u,f){if(0>s||s>=this.xa||0>a||a>=this.xa)throw d.i.ga("index out of bounds");this.oc(),f.Pf(this.description),f.B()&&f.wn();for(var y=0;y<this.description.Ba;y++)for(var v=this.description.Fd(y),_=0,M=d.sa.Wa(v);_<M;_++){var $=this.Aa[y].gg(M*s+_),T=this.Aa[y].gg(M*a+_);f.setAttribute(v,_,d.mc.jq($,T,u))}},l.prototype.Ar=function(s,a){var u=this.Aa[0].o,f=u[2*s]-u[2*a];return s=u[2*s+1]-u[2*a+1],Math.sqrt(f*f+s*s)},l.prototype.FR=function(s){if(0>s||s>=this.xa)throw d.i.de();this.oc();var a=new d.Ta;a.Pf(this.description),a.B()&&a.wn();for(var u=0;u<this.description.Ba;u++)for(var f=this.description.ld(u),y=0,v=d.sa.Wa(f);y<v;y++){var _=this.Aa[u].gg(v*s+y);a.setAttribute(f,y,_)}return a},l.prototype.Fh=function(s,a){if(0>s||s>=this.xa)throw d.i.de();if(a.B())throw d.i.O();this.oc();for(var u=a.description,f=0;f<u.Ba;f++)for(var y=u.ld(f),v=d.sa.Wa(y),_=0;_<v;_++){var M=a.Vc(y,_);this.setAttribute(y,s,_,M)}},l.prototype.nu=function(){return null},l.prototype.hj=function(){return null},l}(d.ba);d.Fx=S}(Q||(Q={})),function(d){var O=function(){function S(){this.ob=this.ao=null,this.Vm=124234251,this.Tv=!0,this.Ne=-1,this.ob=new d.ad(7),this.ao=null}return S.prototype.Xo=function(p){this.ao=p},S.prototype.MP=function(){this.Tv=!1},S.prototype.Ee=function(p){this.ob.Ee(p)},S.prototype.Rr=function(p){var l=this.ob.De();return this.nX(l),this.qX(p,l),l},S.prototype.HP=function(p){this.ob.kd(p)},S.prototype.addElement=function(p,l){return l==-1&&(this.Ne==-1&&(this.Ne=this.Rr(-1)),l=this.Ne),this.AD(p,0,l)},S.prototype.ED=function(p){return this.Ne==-1&&(this.Ne=this.Rr(-1)),this.AD(p,1,this.Ne)},S.prototype.zn=function(p){this.Ne==-1&&(this.Ne=this.Rr(-1));var l=this.Ne,s=this.ob.o;if(l==-1||s[7*l]==-1)return p=this.ob.Nl([-1,-1,-1,p,this.il(),-1,-1]),(s=this.ob.o)[7*l]=p,this.xp(-1,p,l,s),p;var a=l==-1?-1:s[7*l+2];return p=this.ob.Nl([-1,-1,a,p,this.il(),-1,-1]),(s=this.ob.o)[7*a+1]=p,this.ky(p,s),s[7*p+2]===-1&&(s[7*l]=p),this.xp(-1,p,l,s),p},S.prototype.Bu=function(p,l,s,a){var u=-1;u==-1&&(this.Ne==-1&&(this.Ne=this.Rr(-1)),u=this.Ne);var f=this.ob.o;if(u==-1||f[7*u]==-1)return s=this.ob.Nl([-1,-1,-1,s,this.il(),-1,-1]),(f=this.ob.o)[7*u]=s,this.xp(-1,s,u,f),s;if(a){a=l!=-1?this.ao.compare(this,s,l):-1;var y=p!=-1?this.ao.compare(this,s,p):1}else a=-1,y=1;if(a==0||y==0)return f[7*u+3]=a==0?l:p,-1;for((l!=-1&&p!=-1?this.Vm>d.P.XA(this.Vm)>>1:l!=-1)?p=l:a=y,l=!0;;){if(0>a){if((y=f[7*p])==-1){a=p,s=this.ob.Nl([-1,-1,p,s,this.il(),-1,-1]),(f=this.ob.o)[7*p]=s;break}p=y}else{if((y=f[7*p+1])==-1){a=f[7*p+6],s=this.ob.Nl([-1,-1,p,s,this.il(),-1,-1]),(f=this.ob.o)[7*p+1]=s;break}p=y}l&&(a*=-1,l=!1)}return this.ky(s,f),f[7*s+2]===-1&&(f[7*u]=s),this.xp(a,s,u,f),s},S.prototype.AF=function(){return this.dR(this.Ne)},S.prototype.wd=function(p,l){l=l==-1?this.Ne:l,this.Tv?this.GP(p,l):this.eY(p,l)},S.prototype.search=function(p,l){for(l=this.uv(l);l!=-1;){var s=this.ao.compare(this,p,l);if(s==0)return l;l=0>s?this.nl(l):this.Zp(l)}return-1},S.prototype.DW=function(p){for(var l=this.uv(-1),s=-1;l!=-1;){var a=p.compare(this,l);if(a==0)return l;0>a?l=this.nl(l):(s=l,l=this.Zp(l))}return s},S.prototype.pJ=function(p){for(var l=this.uv(-1),s=-1;l!=-1;){var a=p.compare(this,l);if(a==0)return l;0>a?(s=l,l=this.nl(l)):l=this.Zp(l)}return s},S.prototype.ka=function(p){return this.ob.U(p,3)},S.prototype.nl=function(p){return this.ob.U(p,0)},S.prototype.Zp=function(p){return this.ob.U(p,1)},S.prototype.getParent=function(p){return this.ob.U(p,2)},S.prototype.lb=function(p){return this.ob.U(p,6)},S.prototype.xe=function(p){return this.ob.U(p,5)},S.prototype.sc=function(p){return p==-1?this.ml(this.Ne):this.ml(p)},S.prototype.Gc=function(p){return p==-1?this.bs(this.Ne):this.bs(p)},S.prototype.UR=function(p){return p==-1?this.XF(this.Ne):this.XF(p)},S.prototype.Uj=function(p,l){this.IB(p,l)},S.prototype.uv=function(p){return p==-1?this.TF(this.Ne):this.TF(p)},S.prototype.clear=function(){this.ob.oj(!1),this.Ne=-1},S.prototype.size=function(p){return p==-1?this.VF(this.Ne):this.VF(p)},S.prototype.FN=function(p,l){for(var s=l[7*p],a=l[7*p+1],u=l[7*p+4];s!=-1||a!=-1;){var f=s!=-1?l[7*s+4]:2147483647;if(a=a!=-1?l[7*a+4]:2147483647,u<=Math.min(f,a))break;f<=a?this.nJ(s,l):this.mJ(p,l),s=l[7*p],a=l[7*p+1]}},S.prototype.ky=function(p,l){if(this.Tv)for(var s=l[7*p+4],a=l[7*p+2];a!=-1&&l[7*a+4]>s;)l[7*a]==p?this.nJ(p,l):this.mJ(a,l),a=l[7*p+2]},S.prototype.mJ=function(p,l){var s=l[7*p+1];l[7*s+2]=l[7*p+2],l[7*p+2]=s;var a=l[7*s];l[7*p+1]=a,a!=-1&&(l[7*a+2]=p),l[7*s]=p,(a=l[7*s+2])!=-1&&(l[7*a]==p?l[7*a]=s:l[7*a+1]=s)},S.prototype.nJ=function(p,l){var s=l[7*p+2];l[7*p+2]=l[7*s+2],l[7*s+2]=p;var a=l[7*p+1];l[7*s]=a,a!=-1&&(l[7*a+2]=s),l[7*p+1]=s,(a=l[7*p+2])!=-1&&(l[7*a]===s?l[7*a]=p:l[7*a+1]=p)},S.prototype.Rk=function(p,l){this.ob.T(p,2,l)},S.prototype.OB=function(p,l){this.ob.T(p,0,l)},S.prototype.SB=function(p,l){this.ob.T(p,1,l)},S.prototype.RB=function(p,l){this.ob.T(p,5,l)},S.prototype.fx=function(p,l){this.ob.T(p,6,l)},S.prototype.SJ=function(p,l){this.ob.T(l,0,p)},S.prototype.nX=function(p){this.ob.T(p,4,0)},S.prototype.qX=function(p,l){this.ob.T(l,5,p)},S.prototype.TF=function(p){return p==-1?-1:this.ob.U(p,0)},S.prototype.ml=function(p){return p==-1?-1:this.ob.U(p,1)},S.prototype.bs=function(p){return p==-1?-1:this.ob.U(p,2)},S.prototype.dR=function(p){return p==-1?-1:this.ob.U(p,3)},S.prototype.VF=function(p){return p==-1?0:this.ob.U(p,4)},S.prototype.XF=function(p){return this.ob.U(p,5)},S.prototype.Rw=function(){return this.ob.Nl([-1,-1,-1,void 0,this.il(),-1,-1])},S.prototype.hl=function(p){p!=-1&&this.ob.kd(p)},S.prototype.il=function(){return this.Vm=d.P.XA(this.Vm),1073741823&this.Vm},S.prototype.AD=function(p,l,s){var a=this.ob.o;if(s==-1||a[7*s]==-1)return p=this.ob.Nl([-1,-1,-1,p,this.il(),-1,-1]),(a=this.ob.o)[7*s]=p,this.xp(-1,p,s,a),p;for(var u=s==-1?-1:a[7*s];;){var f=l==-1?1:this.ao.compare(this,p,u);if(0>f){if((f=this.nl(u))==-1){l=u,p=this.ob.Nl([-1,-1,u,p,this.il(),-1,-1]),(a=this.ob.o)[7*u]=p;break}u=f}else{if(l==1&&f==0)return a[7*s+3]=u,-1;if((f=a[7*u+1])==-1){l=a[7*u+6],p=this.ob.Nl([-1,-1,u,p,this.il(),-1,-1]),(a=this.ob.o)[7*u+1]=p;break}u=f}}return this.ky(p,a),a[7*p+2]===-1&&(a[7*s]=p),this.xp(l,p,s,a),p},S.prototype.xp=function(p,l,s,a){if(p!=-1){var u=a[7*p+5];a[7*p+5]=l}else u=s==-1?-1:a[7*s+2];a[7*l+5]=u,u!=-1&&(a[7*u+6]=l),a[7*l+6]=p,p==(s==-1?-1:a[7*s+1])&&(a[7*s+1]=l),p==-1&&(a[7*s+2]=l),a[7*s+4]=(s==-1?0:a[7*s+4])+1},S.prototype.vB=function(p,l){var s=this.ob.o,a=s[7*p+5];p=s[7*p+6],a!=-1?s[7*a+6]=p:s[7*l+1]=p,p!=-1?s[7*p+5]=a:s[7*l+2]=a,s[7*l+4]=l===-1?-1:s[7*l+4]-1},S.prototype.eY=function(p,l){this.vB(p,l);var s=this.nl(p),a=this.Zp(p),u=this.getParent(p),f=p;if(s!=-1&&a!=-1){this.Vm=d.P.XA(this.Vm);var y=1073741823<this.Vm?this.lb(p):this.xe(p),v=this.getParent(y)==p;this.ob.bC(p,y,0),this.ob.bC(p,y,1),this.ob.bC(p,y,2),u!=-1?this.nl(u)==p?this.OB(u,y):this.SB(u,y):this.SJ(y,l),v?(s==y?(this.OB(y,p),this.Rk(a,y)):a==y&&(this.SB(y,p),this.Rk(s,y)),this.Rk(p,y),u=y):(this.Rk(s,y),this.Rk(a,y),u=this.getParent(p),f=y),s=this.nl(p),a=this.Zp(p),s!=-1&&this.Rk(s,p),a!=-1&&this.Rk(a,p)}s=s!=-1?s:a,u==-1?this.SJ(s,l):this.nl(u)==f?this.OB(u,s):this.SB(u,s),s!=-1&&this.Rk(s,u),this.hl(p)},S.prototype.GP=function(p,l){var s=this.ob.o;s[7*p+4]=2147483647;var a=-1,u=-1,f=l===-1?-1:s[7*l],y=f==p;if(y&&(a=s[7*f],u=s[7*f+1],a==-1&&u==-1))return this.vB(f,l),this.hl(f),void(s[7*l]=-1);this.FN(p,s),(f=s[7*p+2])!=-1&&(s[7*f]==p?s[7*f]=-1:s[7*f+1]=-1),this.vB(p,l),this.hl(p),y&&(s[7*l]=a==-1||s[7*a+2]!=-1?u:a)},S.prototype.IB=function(p,l){this.ob.T(p,3,l)},S}();d.$j=O}(Q||(Q={})),function(d){var O=function(){function S(p,l){p!==void 0&&this.L(p,l)}return S.prototype.L=function(p,l){this.pa=p,this.wa=l,this.normalize()},S.prototype.isIntersecting=function(p){return this.pa<=p.pa?this.wa>=p.pa:p.wa>=this.pa},S.prototype.move=function(p){this.B()||(this.pa+=p,this.wa+=p)},S.prototype.normalize=function(){if(!isNaN(this.pa)){if(this.pa>this.wa){var p=this.pa;this.pa=this.wa,this.wa=p}isNaN(this.wa)&&this.Pa()}},S.prototype.Pa=function(){this.wa=this.pa=NaN},S.prototype.B=function(){return isNaN(this.pa)},S.prototype.$b=function(p){typeof p=="number"?this.B()?this.wa=this.pa=p:this.Nk(p):p.B()||(this.B()?(this.pa=p.pa,this.wa=p.wa):(this.pa>p.pa&&(this.pa=p.pa),this.wa<p.wa&&(this.wa=p.wa),this.pa>this.wa&&this.Pa()))},S.prototype.Nk=function(p){p<this.pa?this.pa=p:p>this.wa&&(this.wa=p)},S.prototype.contains=function(p){return typeof p=="number"?p>=this.pa&&p<=this.wa:p.pa>=this.pa&&p.wa<=this.wa},S.prototype.Fa=function(p){this.B()||p.B()?this.Pa():(this.pa<p.pa&&(this.pa=p.pa),this.wa>p.wa&&(this.wa=p.wa),this.pa>this.wa&&this.Pa())},S.prototype.X=function(p){this.B()||(this.pa-=p,this.wa+=p,this.wa<this.pa&&this.Pa())},S.prototype.zr=function(){return this.B()?2220446049250313e-29:2220446049250313e-29*(Math.abs(this.pa)+Math.abs(this.wa)+1)},S.prototype.FB=function(p,l){p>l?(this.pa=l,this.wa=p):(this.pa=p,this.wa=l)},S.prototype.Kt=function(p){return d.P.Tk(p,this.pa,this.wa)},S.prototype.S=function(){return this.wa-this.pa},S.prototype.tf=function(){return .5*(this.pa+this.wa)},S.prototype.Nb=function(p){return p==this||p instanceof S&&(!(!this.B()||!p.B())||this.pa==p.pa&&this.wa==p.wa)},S.prototype.dc=function(){return d.P.wj(d.P.wj())},S}();d.Oc=O}(Q||(Q={})),function(d){var O=new d.Oc,S=new d.Oc,p=function(){this.oe=null,this.pb=-1,this.tb=new d.zb,this.lA=55555555,this.Vv=this.Xv=!1,this.Wf=new d.Oc,this.Wf.FB(0,0)};d.EY=p;var l=function(){function s(a,u,f){this.g=a,this.Jk=NaN,this.IH=this.Mq=0,this.JH=NaN,this.ra=u,this.Pq=10*u,this.KH=this.LH=NaN,this.sg=!1,this.Fm=this.ht=this.No=this.Zs=this.Ys=-1,this.bA=f,this.OA=new p,this.TH=new p,d.P.truncate(3*a.gd/2)}return s.prototype.hG=function(a,u,f,y){a.oe=y===null?null:y[f[5*u]],a.Vv=a.oe!=null,a.Vv||((y=f[5*u+2])!==-1&&this.g.hW(f[5*u],f[5*y],a.tb),a.oe=a.tb,a.Wf.FB(a.tb.ta,a.tb.qa),a.Wf.wa+=this.ra,a.tb.mI(),a.Xv=a.tb.ma==a.tb.oa,a.Xv||(a.lA=(a.tb.qa-a.tb.ta)/(a.tb.ma-a.tb.oa)))},s.prototype.JO=function(a,u){var f=a.Br(u,this.ra,!0);return f!=0?f==2?this.Ly():this.zi():(a.$p(vt),a.Vr($t),u.$p(Ct),u.Vr(qt),dt.na(this.Mq,this.Jk),vt.rb(Ct)&&this.Jk==vt.y?0>$t.compare(qt)?dt.N($t):dt.N(qt):vt.rb(qt)&&this.Jk==vt.y?0>$t.compare(Ct)?dt.N($t):dt.N(Ct):Ct.rb($t)&&this.Jk==Ct.y?0>vt.compare(qt)?dt.N(vt):dt.N(qt):$t.rb(qt)&&this.Jk==$t.y&&(0>vt.compare(Ct)?dt.N(vt):dt.N(Ct)),a.Me(dt.y,dt.x)<u.Me(dt.y,dt.x)?-1:1)},s.prototype.HO=function(a,u){if(a.tb.oa==u.tb.oa&&a.tb.ta==u.tb.ta)return a.tb.ma==u.tb.ma&&a.tb.qa==u.tb.qa?this.bA?this.Ly():0:this.KE(a,u);if(a.tb.ma==u.tb.ma&&a.tb.qa==u.tb.qa)return this.JE(a,u);var f=this.JE(a,u);return a=this.KE(a,u),0>f&&0>a?-1:0<f&&0<a?1:this.zi()},s.prototype.DO=function(a,u){if(a.qa>u.qa){if(u.qa>u.ta&&u.ma-u.oa<2*this.ra&&a.xi(u.qa,u.ma,this.ra))return this.zi()}else if((u.ma-u.oa)/(u.qa-u.ta)*(a.qa-a.ta)<this.Pq&&u.xi(a.qa,a.ma,this.ra))return this.zi();return 1},s.prototype.EO=function(a,u){if(a.ta<u.ta){if(u.qa>u.ta&&u.ma-u.oa<2*this.ra&&a.xi(u.qa,u.ma,this.ra))return this.zi()}else if((u.ma-u.oa)/(u.qa-u.ta)*(a.ta-a.qa)<this.Pq&&u.xi(a.ta,a.oa,this.ra))return this.zi();return-1},s.prototype.FO=function(a,u){var f=new d.h;f.vc(u.xc(),u.bc()),f.cr(),f.normalize();var y=new d.h;y.vc(a.bc(),u.bc());var v=new d.h;v.vc(a.xc(),u.bc()),y=y.Sh(f),f=v.Sh(f),v=Math.abs(y);var _=Math.abs(f);if(v<_){if(v<this.Pq&&u.xi(a.ta,a.oa,this.ra))return this.zi()}else if(_<this.Pq&&u.xi(a.qa,a.ma,this.ra))return this.zi();return 0>y&&0>f?-1:0<y&&0<f?1:this.zi()},s.prototype.IE=function(a,u){return a.oa==u.oa&&a.ta==u.ta?this.DO(a,u):a.ma==u.ma&&a.qa==u.qa?this.EO(a,u):this.FO(a,u)},s.prototype.GO=function(a,u){return a.ma==u.ma&&a.qa==u.qa&&a.oa==u.oa&&a.ta==u.ta?this.bA?this.Ly():0:this.zi()},s.prototype.JE=function(a,u){var f=1;if(a.tb.oa<u.tb.oa){f=-1;var y=a;a=u,u=y}a=a.tb,y=u.tb;var v=a.ta-y.ta;u=u.lA*(a.oa-y.oa);var _=this.Pq;return v<u-_?-f:v>u+_?f:y.xi(a.ta,a.oa,this.ra)?this.zi():v<u?-f:f},s.prototype.KE=function(a,u){var f=1;if(u.tb.ma<a.tb.ma){f=-1;var y=a;a=u,u=y}a=a.tb,y=u.tb;var v=a.qa-y.ta;u=u.lA*(a.ma-y.oa);var _=this.Pq;return v<u-_?-f:v>u+_?f:y.xi(a.qa,a.ma,this.ra)?this.zi():v<u?-f:f},s.prototype.Ly=function(){return this.sg=!0,this.Pi=new d.Nd(5,this.No,this.ht),-1},s.prototype.zi=function(){return this.sg=!0,this.bA?this.Pi=new d.Nd(4,this.No,this.ht):this.ht=this.No=this.Zs=this.Ys=-1,-1},s.prototype.IO=function(a,u,f,y){if(this.sg)return-1;var v=this.JH==this.Jk&&this.IH==this.Mq;if(v&&a==this.Ys)var _=this.KH;else _=NaN,this.Ys=-1;return v&&u==this.Zs?v=this.LH:(v=NaN,this.Zs=-1),f.oe.UI(O),y.oe.UI(S),O.wa<S.pa?-1:S.wa<O.pa?1:(this.JH=this.Jk,this.IH=this.Mq,isNaN(_)&&(this.Ys=a,this.KH=_=a=f.oe.Me(this.Jk,this.Mq)),isNaN(v)&&(this.Zs=u,this.LH=v=a=y.oe.Me(this.Jk,this.Mq)),Math.abs(_-v)<=this.ra?this.JO(f.oe,y.oe):_<v?-1:_>v?1:0)},s.prototype.Mr=function(){this.sg=!1},s.prototype.tm=function(){return this.Pi},s.prototype.VJ=function(a,u){this.Jk=a,this.Mq=u,this.ht=this.No=this.Zs=this.Ys=-1},s.prototype.compare=function(a,u,f){return this.sg?-1:(a=a.ka(f),this.Fm=f,this.ME(u,u,a,a))},s.prototype.ME=function(a,u,f,y){if(this.No==u)var v=this.OA;else this.No=u,v=this.OA,this.OA.pb=a,this.hG(v,u,this.g.ud.o,this.g.Te);if(_==null){this.ht=y;var _=this.TH;this.TH.pb=f,this.hG(_,y,this.g.ud.o,this.g.Te)}return v.Vv||_.Vv?this.IO(u,y,v,_):v.Wf.wa<_.Wf.pa?-1:_.Wf.wa<v.Wf.pa?1:(a=v.Xv?1:0,(a|=_.Xv?2:0)==0?this.HO(v,_):a==1?this.IE(v.tb,_.tb):a==2?-1*this.IE(_.tb,v.tb):this.GO(v.tb,_.tb))},s}();d.PC=l}(Q||(Q={})),function(d){var O=function(){function S(p,l){this.g=p,this.ra=l,this.sg=!1,this.No=-1,this.Wf=new d.Oc,this.Iq=new d.h,this.Iq.Sc(),this.je=new d.zb,this.Fm=-1,this.wA=17976931348623157e292}return S.prototype.Mr=function(){this.sg=!1,this.wA=17976931348623157e292},S.prototype.Fh=function(p){this.Iq.N(p)},S.prototype.compare=function(p,l){return this.NE(l,p.ka(l))},S.prototype.NE=function(p,l){var s=this.g.cc(l)!=null;if(s||(this.g.fd(l,this.je),this.Wf.FB(this.je.ta,this.je.qa)),s)throw d.i.ga("not implemented");if(this.Iq.x+this.ra<this.Wf.pa)return-1;if(this.Iq.x-this.ra>this.Wf.wa)return 1;if(this.je.oa==this.je.ma)return this.Fm=p,this.sg=!0,0;this.je.mI(),s=this.je.bc(),(l=new d.h).vc(this.je.xc(),s),l.cr();var a=new d.h;return a.vc(this.Iq,s),s=l.Sh(a),(s/=l.length())<10*-this.ra?-1:s>10*this.ra?1:this.je.ss(this.Iq,this.ra)&&((l=Math.abs(s))<this.wA&&(this.Fm=p,this.wA=l),this.sg=!0,l<.25*this.ra)?0:0>s?-1:1},S}();d.WL=O}(Q||(Q={})),function(d){function O(p,l,s,a){s=new Float64Array(p.subarray(s,a)),p.set(s,l)}var S=function(){function p(l){this.Pb=this.rk=!1,this.o=null;var s=l;2>s&&(s=2),this.o=new Float64Array(s),this.size=l}return p.prototype.rotate=function(l,s,a){if(this.Pb)throw d.i.ga("invalid_call");if(s<l||s>a||l>a)throw d.i.O();l!=s&&a!=s&&(this.pi(l,s-l,1),this.pi(s,a-s,1),this.pi(l,a-l,1))},p.rf=function(l,s){var a=new p(l),u=a.o;if(2>l&&(l=2),s!==0)for(var f=0;f<l;f++)u[f]=s;return a},p.Dn=function(l){var s=new p(0);return s.o=new Float64Array(l.o),s.size=l.size,s},p.Nr=function(l,s){var a=new p(0);return a.size=l.size,a.size>s&&(a.size=s),2>(s=a.size)&&(s=2),a.o=new Float64Array(s),a.o.set(l.o.length<=s?l.o:l.o.subarray(0,s),0),a},p.prototype.Jb=function(l){0>=l||(this.o==null?this.o=new Float64Array(l):l<=this.o.length||(0<this.o.length?((l=new Float64Array(l)).set(this.o),this.o=l):this.o=new Float64Array(l)))},p.prototype.read=function(l){return this.o[l]},p.prototype.uc=function(l,s){s.x=this.o[l],s.y=this.o[l+1]},p.prototype.get=function(l){return this.o[l]},p.prototype.write=function(l,s){if(this.Pb)throw d.i.Hb();this.o[l]=s},p.prototype.set=function(l,s){if(this.Pb)throw d.i.Hb();this.o[l]=s},p.prototype.Vt=function(l,s){if(this.Pb)throw d.i.Hb();this.o[l]=s.x,this.o[l+1]=s.y},p.prototype.add=function(l){this.resize(this.size+1),this.o[this.size-1]=l},p.prototype.BB=function(l){return p.Nr(this,l)},p.prototype.gg=function(l){return this.read(l)},p.prototype.resize=function(l,s){if(s===void 0&&(s=0),this.rk)throw d.i.ga("invalid call. Attribute Stream is locked and cannot be resized.");if(l<=this.size){if(30<this.o.length&&5*l/4<this.o.length){var a=new Float64Array(this.o,0,l);this.o=a}}else{l>this.o.length&&(a=d.P.truncate(64>l?Math.max(2*l,4):5*l/4),(a=new Float64Array(a)).set(this.o),this.o=a),a=this.o;for(var u=this.size;u<l;u++)a[u]=s}this.size=l},p.prototype.Dh=function(l){if((this.o==null||l>this.o.length)&&this.resize(l),this.rk)throw d.i.ga("invalid call. Attribute Stream is locked and cannot be resized.");this.size=l},p.prototype.rr=function(l,s){this.write(l,s)},p.prototype.Cn=function(l,s,a){for(var u=this.size;s<u&&s<a;s++)l=d.P.wj(this.read(s));return l},p.prototype.Nb=function(l,s,a){if(l==null||!(l instanceof p))return!1;var u=this.size,f=l.size;if(a>u||a>f&&u!=f)return!1;for(a>u&&(a=u);s<a;s++)if(this.read(s)!=l.read(s))return!1;return!0},p.prototype.addRange=function(l,s,a,u,f){if(this.Pb)throw d.i.Hb();if(!u&&(1>f||a%f!=0))throw d.i.O();var y=this.size;if(this.resize(y+a),u)this.o.set(l.o.subarray(s,s+a),y);else{u=a;for(var v=0;v<a;v+=f){u-=f;for(var _=0;_<f;_++)this.o[y+v+_]=l.o[s+u+_]}}},p.prototype.On=function(l,s,a,u,f,y,v){if(this.Pb)throw d.i.Hb();if(!f&&(1>y||u%y!=0))throw d.i.O();var _=this.size-v;if(_<u&&this.resize(this.size+u-_),O(this.o,l+u,l,l+(v-l)),this.o==s.o&&l<a&&(a+=u),f)this.o.set(s.o.subarray(a,a+u),l);else for(f=u,v=0;v<u;v+=y)for(f-=y,_=0;_<y;_++)this.o[l+v+_]=s.o[a+f+_]},p.prototype.Dz=function(l,s,a,u,f,y){if(this.Pb)throw d.i.Hb();if(0>y&&(y=this.size),this.size+2*u>this.o.length?this.resize(this.size+2*u):this.size+=2*u,O(this.o,l+2*u,l,l+(y-l)),f)for(f=0;f<u;f++)y=s[a++],this.o[l++]=y.x,this.o[l++]=y.y;else{f=0;for(var v=u-1;f<u;++f)y=s[a+v],this.o[l++]=y.x,this.o[l++]=y.y,v--}},p.prototype.Nn=function(l,s,a,u){if(this.Pb)throw d.i.Hb();for(u-=l,O(this.o,l+u,l,l+u),u=0;u<a;u++)this.o[l+u]=s},p.prototype.xj=function(l,s,a){if(this.Pb)throw d.i.Hb();O(this.o,l+2,l,l+(a-l)),this.o[l]=s.x,this.o[l+1]=s.y},p.prototype.Wt=function(l,s,a,u,f,y){if(0>l||0>s||0>u||!f&&(0>=y||s%y!=0)||a.size<u+s)throw d.i.O();if(s!=0)if(this.size<s+l&&this.resize(s+l),a==this)this.Cr(l,s,u,f,y);else if(f)for(f=0;f<s;f++)this.o[l]=a.o[u],l++,u++;else if(u=u+s-y,y==1)for(f=0;f<s;f++)this.o[l]=a.o[u],l++,u--;else for(f=0,s=d.P.truncate(s/y);f<s;f++){for(var v=0;v<y;v++)this.o[l+v]=a.o[u+v];l+=y,u-=y}},p.prototype.Gn=function(l,s,a){if(this.Pb||l+s>this.size)throw d.i.Hb();0<a-(l+s)&&O(this.o,l,l+s,l+(a-(l+s))+s),this.size-=s},p.prototype.pi=function(l,s,a){if(this.Pb||1>a||s%a!=0)throw d.i.Hb();for(var u=s>>1,f=0;f<u;f+=a){s-=a;for(var y=0;y<a;y++){var v=this.o[l+f+y];this.o[l+f+y]=this.o[l+s+y],this.o[l+s+y]=v}}},p.prototype.Yj=function(l,s,a){if(0>s||0>a||0>s||a+s>this.size)throw d.i.O();for(var u=s;u<s+a;u++)this.o[u]=l},p.prototype.Cr=function(l,s,a,u,f){if(!(u&&l==a||(this.o.set(this.o.subarray(a,a+s),l),u)))for(a=l,l=l+s-f,u=0,s=d.P.truncate(s/2);u<s;u++){for(var y=0;y<f;y++){var v=this.o[a+y];this.o[a+y]=this.o[l+y],this.o[l+y]=v}a+=f,l-=f}},p.prototype.qC=function(l,s,a,u,f){if(0>l||0>s||0>u)throw d.i.O();if(s!=0)for(this.size<(s<<1)+l&&this.resize((s<<1)+l),f||(l+=s-1<<1),f=f?2:-2,s+=u;u<s;u++)this.o[l]=a[u].x,this.o[l+1]=a[u].y,l+=f},p.prototype.pC=function(l,s,a){if(0>l||0>s)throw d.i.O();if(s!=0){this.size<(s<<1)+l&&this.resize((s<<1)+l),s+=0;for(var u=0;u<s;u++)this.o[l]=a[u][0],this.o[l+1]=a[u][1],l+=2}},p.prototype.Xw=function(l,s,a,u,f){if(0>l||0>s||0>u||this.size<s+l)throw d.i.O();if(f)for(f=0;f<s;f++)a[u+f]=this.o[l+f];else for(u=u+s-1;l<s;l++)a[u]=this.o[l],u--},p.prototype.pB=function(l,s,a){if(0>l||0>s||this.size<(s>>1)+l)throw d.i.O();if(s!=0){s=0+s;for(var u=0;u<s;u++)a[u][0]=this.o[l],a[u][1]=this.o[l+1],l+=2}},p.prototype.clear=function(l){l?this.resize(0):this.Dh(0)},p.prototype.ix=function(){this.rk=this.Pb=!0},p.prototype.Wd=function(l,s,a){Array.prototype.sort.call(this.o.subarray(l,s),a)},p.prototype.Vp=function(){return 1},p}();d.ce=S}(Q||(Q={})),function(d){function O(p,l,s,a){s=new Int32Array(p.subarray(s,a)),p.set(s,l)}d.nY=function(){this.random=1973};var S=function(){function p(l){this.Pb=this.rk=!1,this.o=null;var s=l;2>s&&(s=2),this.o=new Int32Array(s),this.size=l}return p.prototype.rotate=function(l,s,a){if(this.Pb)throw d.i.ga("invalid_call");if(s<l||s>a||l>a)throw d.i.O();l!=s&&a!=s&&(this.pi(l,s-l,1),this.pi(s,a-s,1),this.pi(l,a-l,1))},p.rf=function(l,s){var a=new p(l),u=a.o;if(2>l&&(l=2),s!==0)for(var f=0;f<l;f++)u[f]=s;return a},p.Dn=function(l){var s=new p(0);return s.o=new Int32Array(l.o),s.size=l.size,s},p.Nr=function(l,s){var a=new p(0);return a.size=l.size,a.size>s&&(a.size=s),2>(s=a.size)&&(s=2),a.o=new Int32Array(s),a.o.set(l.o.length<=s?l.o:l.o.subarray(0,s),0),a},p.prototype.Jb=function(l){0>=l||(this.o==null?this.o=new Int32Array(l):l<=this.o.length||(0<this.o.length?((l=new Int32Array(l)).set(this.o),this.o=l):this.o=new Int32Array(l)))},p.prototype.read=function(l){return this.o[l]},p.prototype.uc=function(l,s){s.x=this.o[l],s.y=this.o[l+1]},p.prototype.get=function(l){return this.o[l]},p.prototype.write=function(l,s){if(this.Pb)throw d.i.Hb();this.o[l]=s},p.prototype.set=function(l,s){if(this.Pb)throw d.i.Hb();this.o[l]=s},p.prototype.Vt=function(l,s){if(this.Pb)throw d.i.Hb();this.o[l]=s.x,this.o[l+1]=s.y},p.prototype.add=function(l){this.resize(this.size+1),this.o[this.size-1]=l},p.prototype.BB=function(l){return p.Nr(this,l)},p.prototype.gg=function(l){return this.read(l)},p.prototype.resize=function(l,s){if(s===void 0&&(s=0),this.rk)throw d.i.ga("invalid call. Attribute Stream is locked and cannot be resized.");if(l<=this.size){if(30<this.o.length&&5*l/4<this.o.length){var a=new Int32Array(this.o,0,l);this.o=a}}else{l>this.o.length&&(a=d.P.truncate(64>l?Math.max(2*l,4):5*l/4),(a=new Int32Array(a)).set(this.o),this.o=a),a=this.o;for(var u=this.size;u<l;u++)a[u]=s}this.size=l},p.prototype.Dh=function(l){if((this.o==null||l>this.o.length)&&this.resize(l),this.rk)throw d.i.ga("invalid call. Attribute Stream is locked and cannot be resized.");this.size=l},p.prototype.rr=function(l,s){this.write(l,s)},p.prototype.Cn=function(l,s,a){for(var u=this.size;s<u&&s<a;s++)l=d.P.Vh(this.read(s),l);return l},p.prototype.Nb=function(l,s,a){if(l==null||!(l instanceof p))return!1;var u=this.size,f=l.size;if(a>u||a>f&&u!=f)return!1;for(a>u&&(a=u);s<a;s++)if(this.read(s)!=l.read(s))return!1;return!0},p.prototype.addRange=function(l,s,a,u,f){if(this.Pb)throw d.i.Hb();if(!u&&(1>f||a%f!=0))throw d.i.O();var y=this.size;if(this.resize(y+a),u)this.o.set(l.o.subarray(s,s+a),y);else{u=a;for(var v=0;v<a;v+=f){u-=f;for(var _=0;_<f;_++)this.o[y+v+_]=l.o[s+u+_]}}},p.prototype.On=function(l,s,a,u,f,y,v){if(this.Pb)throw d.i.Hb();if(!f&&(1>y||u%y!=0))throw d.i.O();if(O(this.o,l+u,l,l+(v-l)),this.o==s.o&&l<a&&(a+=u),f)this.o.set(s.o.subarray(a,a+u),l);else for(f=u,v=0;v<u;v+=y){f-=y;for(var _=0;_<y;_++)this.o[l+v+_]=s.o[a+f+_]}},p.prototype.Dz=function(l,s,a,u,f,y){if(this.Pb)throw d.i.Hb();if(0>y&&(y=this.size),this.size+2*u>this.o.length?this.resize(this.size+2*u):this.size+=2*u,O(this.o,l+2*u,l,l+(y-l)),f)for(f=0;f<u;f++)y=s[a++],this.o[l++]=y.x,this.o[l++]=y.y;else{f=0;for(var v=u-1;f<u;++f)y=s[a+v],this.o[l++]=y.x,this.o[l++]=y.y,v--}},p.prototype.Nn=function(l,s,a,u){if(this.Pb)throw d.i.Hb();for(u-=l,O(this.o,l+u,l,l+u),u=0;u<a;u++)this.o[l+u]=s},p.prototype.xj=function(l,s,a){if(this.Pb)throw d.i.Hb();O(this.o,l+2,l,l+(a-l)),this.o[l]=s.x,this.o[l+1]=s.y},p.prototype.Wt=function(l,s,a,u,f,y){if(0>l||0>s||0>u||!f&&(0>=y||s%y!=0)||a.size<u+s)throw d.i.O();if(s!=0)if(this.size<s+l&&this.resize(s+l),a==this)this.Cr(l,s,u,f,y);else if(f)for(f=0;f<s;f++)this.o[l]=a.o[u],l++,u++;else if(u=u+s-y,y==1)for(f=0;f<s;f++)this.o[l]=a.o[u],l++,u--;else for(f=0,s=d.P.truncate(s/y);f<s;f++){for(var v=0;v<y;v++)this.o[l+v]=a.o[u+v];l+=y,u-=y}},p.prototype.Gn=function(l,s,a){if(this.Pb||l+s>this.size)throw d.i.Hb();0<a-(l+s)&&O(this.o,l,l+s,l+(a-(l+s))+s),this.size-=s},p.prototype.pi=function(l,s,a){if(this.Pb||1>a||s%a!=0)throw d.i.Hb();for(var u=s>>1,f=0;f<u;f+=a){s-=a;for(var y=0;y<a;y++){var v=this.o[l+f+y];this.o[l+f+y]=this.o[l+s+y],this.o[l+s+y]=v}}},p.prototype.Yj=function(l,s,a){if(0>s||0>a||0>s||a+s>this.size)throw d.i.O();for(var u=s;u<s+a;u++)this.o[u]=l},p.prototype.Cr=function(l,s,a,u,f){if(!(u&&l==a||(this.o.set(this.o.subarray(a,a+s),l),u)))for(a=l,l=l+s-f,u=0,s=d.P.truncate(s/2);u<s;u++){for(var y=0;y<f;y++){var v=this.o[a+y];this.o[a+y]=this.o[l+y],this.o[l+y]=v}a+=f,l-=f}},p.prototype.qC=function(l,s,a,u,f){if(0>l||0>s||0>u)throw d.i.O();if(s!=0)for(this.size<(s<<1)+l&&this.resize((s<<1)+l),f||(l+=s-1<<1),f=f?2:-2,s+=u;u<s;u++)this.o[l]=a[u].x,this.o[l+1]=a[u].y,l+=f},p.prototype.Xw=function(l,s,a,u,f){if(0>l||0>s||0>u||this.size<s+l)throw d.i.O();if(f)for(f=0;f<s;f++)a[u+f]=this.o[l+f];else for(u=u+s-1;l<s;l++)a[u]=this.o[l],u--},p.prototype.clear=function(l){l?this.resize(0):this.Dh(0)},p.prototype.ix=function(){this.rk=this.Pb=!0},p.prototype.Wd=function(l,s,a){10>s-l?p.mG(this.o,l,s,a):p.lB(this.o,l,s-1,a)},p.prototype.Vp=function(){return 2},p.prototype.Gc=function(){return this.o[this.size-1]},p.prototype.Jf=function(){this.resize(this.size-1)},p.prototype.XW=function(l){this.o[this.size-1]=l},p.prototype.NV=function(l){l<this.size-1&&(this.o[l]=this.o[this.size-1]),this.resize(this.size-1)},p.prototype.gF=function(l){for(var s=0,a=this.size;s<a;s++)if(this.o[s]==l)return s;return-1},p.prototype.cG=function(l){return 0<=this.gF(l)},p.mG=function(l,s,a,u){for(var f=s;f<a;f++){for(var y=l[f],v=f-1;v>=s&&0<u(l[v],y);)l[v+1]=l[v],v--;l[v+1]=y}},p.sx=function(l,s,a){var u=l[a];l[a]=l[s],l[s]=u},p.lB=function(l,s,a,u){if(!(s>=a))for(;;){if(9>a-s){p.mG(l,s,a+1,u);break}var f=l[s];p.sx(l,s,a);for(var y=s,v=s;v<a;v++)0>=u(l[v],f)&&(p.sx(l,y,v),y+=1);p.sx(l,y,a),y-s<a-y?(p.lB(l,s,y-1,u),s=y+1):(p.lB(l,y+1,a,u),a=y-1)}},p}();d.ja=S}(Q||(Q={})),function(d){function O(p,l,s,a){s=new Int8Array(p.subarray(s,a)),p.set(s,l)}var S=function(){function p(l){this.o=null;var s=l;2>s&&(s=2),this.o=new Int8Array(s),this.size=l}return p.prototype.rotate=function(l,s,a){if(this.Pb)throw d.i.ga("invalid_call");if(s<l||s>a||l>a)throw d.i.O();l!=s&&a!=s&&(this.pi(l,s-l,1),this.pi(s,a-s,1),this.pi(l,a-l,1))},p.rf=function(l,s){var a=new p(l),u=a.o;if(2>l&&(l=2),s!==0)for(var f=0;f<l;f++)u[f]=s;return a},p.Dn=function(l){var s=new p(0);return s.o=new Int8Array(l.o),s.size=l.size,s},p.Nr=function(l,s){var a=new p(0);return a.size=l.size,a.size>s&&(a.size=s),2>(s=a.size)&&(s=2),a.o=new Int8Array(s),a.o.set(l.o.length<=s?l.o:l.o.subarray(0,s),0),a},p.prototype.Jb=function(l){0>=l||(this.o==null?this.o=new Int8Array(l):l<=this.o.length||(0<this.o.length?((l=new Int8Array(l)).set(this.o),this.o=l):this.o=new Int8Array(l)))},p.prototype.read=function(l){return this.o[l]},p.prototype.uc=function(l,s){s.x=this.o[l],s.y=this.o[l+1]},p.prototype.get=function(l){return this.o[l]},p.prototype.write=function(l,s){if(this.Pb)throw d.i.Hb();this.o[l]=s},p.prototype.set=function(l,s){if(this.Pb)throw d.i.Hb();this.o[l]=s},p.prototype.Vt=function(l,s){if(this.Pb)throw d.i.Hb();this.o[l]=s.x,this.o[l+1]=s.y},p.prototype.add=function(l){this.resize(this.size+1),this.o[this.size-1]=l},p.prototype.BB=function(l){return p.Nr(this,l)},p.prototype.gg=function(l){return this.read(l)},p.prototype.resize=function(l,s){if(s===void 0&&(s=0),this.rk)throw d.i.ga("invalid call. Attribute Stream is locked and cannot be resized.");if(l<=this.size){if(30<this.o.length&&5*l/4<this.o.length){var a=new Int8Array(this.o,0,l);this.o=a}}else{l>this.o.length&&(a=d.P.truncate(64>l?Math.max(2*l,4):5*l/4),(a=new Int8Array(a)).set(this.o),this.o=a),a=this.o;for(var u=this.size;u<l;u++)a[u]=s}this.size=l},p.prototype.Dh=function(l){if((this.o==null||l>this.o.length)&&this.resize(l),this.rk)throw d.i.ga("invalid call. Attribute Stream is locked and cannot be resized.");this.size=l},p.prototype.rr=function(l,s){this.write(l,s)},p.prototype.Cn=function(l,s,a){for(var u=this.size;s<u&&s<a;s++)l=d.P.Vh(this.read(s),l);return l},p.prototype.Nb=function(l,s,a){if(l==null||!(l instanceof p))return!1;var u=this.size,f=l.size;if(a>u||a>f&&u!=f)return!1;for(a>u&&(a=u);s<a;s++)if(this.read(s)!=l.read(s))return!1;return!0},p.prototype.addRange=function(l,s,a,u,f){if(this.Pb)throw d.i.Hb();if(!u&&(1>f||a%f!=0))throw d.i.O();var y=this.size;if(this.resize(y+a),u)this.o.set(l.o.subarray(s,s+a),y);else{u=a;for(var v=0;v<a;v+=f){u-=f;for(var _=0;_<f;_++)this.o[y+v+_]=l.o[s+u+_]}}},p.prototype.On=function(l,s,a,u,f,y,v){if(this.Pb)throw d.i.Hb();if(!f&&(1>y||u%y!=0))throw d.i.O();if(O(this.o,l+u,l,l+(v-l)),this.o==s.o&&l<a&&(a+=u),f)this.o.set(s.o.subarray(a,a+u),l);else for(f=u,v=0;v<u;v+=y){f-=y;for(var _=0;_<y;_++)this.o[l+v+_]=s.o[a+f+_]}},p.prototype.Nn=function(l,s,a,u){if(this.Pb)throw d.i.Hb();for(u-=l,O(this.o,l+u,l,l+u),u=0;u<a;u++)this.o[l+u]=s},p.prototype.Dz=function(l,s,a,u,f,y){if(this.Pb)throw d.i.Hb();if(0>y&&(y=this.size),this.size+2*u>this.o.length?this.resize(this.size+2*u):this.size+=2*u,O(this.o,l+2*u,l,l+(y-l)),f)for(f=0;f<u;f++)y=s[a++],this.o[l++]=y.x,this.o[l++]=y.y;else{f=0;for(var v=u-1;f<u;++f)y=s[a+v],this.o[l++]=y.x,this.o[l++]=y.y,v--}},p.prototype.xj=function(l,s,a){if(this.Pb)throw d.i.Hb();O(this.o,l+2,l,l+(a-l)),this.o[l]=s.x,this.o[l+1]=s.y},p.prototype.Wt=function(l,s,a,u,f,y){if(0>l||0>s||0>u||!f&&(0>=y||s%y!=0)||a.size<u+s)throw d.i.O();if(s!=0)if(this.size<s+l&&this.resize(s+l),a==this)this.Cr(l,s,u,f,y);else if(f)for(f=0;f<s;f++)this.o[l]=a.o[u],l++,u++;else if(u=u+s-y,y==1)for(f=0;f<s;f++)this.o[l]=a.o[u],l++,u--;else for(f=0,s=d.P.truncate(s/y);f<s;f++){for(var v=0;v<y;v++)this.o[l+v]=a.o[u+v];l+=y,u-=y}},p.prototype.Gn=function(l,s,a){if(this.Pb||l+s>this.size)throw d.i.Hb();0<a-(l+s)&&O(this.o,l,l+s,l+(a-(l+s))+s),this.size-=s},p.prototype.pi=function(l,s,a){if(this.Pb||1>a||s%a!=0)throw d.i.Hb();for(var u=s>>1,f=0;f<u;f+=a){s-=a;for(var y=0;y<a;y++){var v=this.o[l+f+y];this.o[l+f+y]=this.o[l+s+y],this.o[l+s+y]=v}}},p.prototype.Yj=function(l,s,a){if(0>s||0>a||0>s||a+s>this.size)throw d.i.O();for(var u=s;u<s+a;u++)this.o[u]=l},p.prototype.Cr=function(l,s,a,u,f){if(!(u&&l==a||(this.o.set(this.o.subarray(a,a+s),l),u)))for(a=l,l=l+s-f,u=0,s=d.P.truncate(s/2);u<s;u++){for(var y=0;y<f;y++){var v=this.o[a+y];this.o[a+y]=this.o[l+y],this.o[l+y]=v}a+=f,l-=f}},p.prototype.qC=function(l,s,a,u,f){if(0>l||0>s||0>u)throw d.i.O();if(s!=0)for(this.size<(s<<1)+l&&this.resize((s<<1)+l),f||(l+=s-1<<1),f=f?2:-2,s+=u;u<s;u++)this.o[l]=a[u].x,this.o[l+1]=a[u].y,l+=f},p.prototype.Xw=function(l,s,a,u,f){if(0>l||0>s||0>u||this.size<s+l)throw d.i.O();if(f)for(f=0;f<s;f++)a[u+f]=this.o[l+f];else for(u=u+s-1;l<s;l++)a[u]=this.o[l],u--},p.prototype.clear=function(l){l?this.resize(0):this.Dh(0)},p.prototype.ix=function(){this.rk=this.Pb=!0},p.prototype.Wd=function(l,s,a){s=this.o.subarray(l,s),Array.prototype.sort.call(s,a),this.o.set(s,l)},p.prototype.uJ=function(l,s){if(this.Pb)throw d.i.ga("invalid call. Attribute Stream is read only.");this.o[l]|=s},p.prototype.FE=function(l,s){if(this.Pb)throw d.i.ga("invalid call. Attribute Stream is read only.");this.o[l]&=~s},p.prototype.Vp=function(){return 1},p}();d.rn=S}(Q||(Q={})),function(d){d.Zc=function(){function O(){}return O.Or=function(S,p){return d.rn.rf(S,p)},O.Fn=function(S,p){return d.ce.rf(S,p)},O.kP=function(S,p,l){switch(S){case 1:S=d.ce.rf(p,l);break;case 2:S=d.ja.rf(p,l);break;case 4:S=d.rn.rf(p,l);break;default:throw d.i.Ra()}return S},O.TE=function(S,p){return O.kP(d.sa.Vp(S),p*d.sa.Wa(S),d.sa.te(S))},O.Qh=function(S,p){return d.ja.rf(S,p)},O.lI=function(S){var p,l=[];for(p=0;p<S;p++)l.push(null);return l},O}()}(Q||(Q={})),function(d){d.ha=function(O){O===void 0&&(O=0),this.u=O}}(Q||(Q={})),function(d){d.IL=function(){function O(){}return O.bind=function(S){d.Tc=S.PeDefs,d.qf=S.PeFactory,d.IC=S.PeVertcs,d.gj=S.PeCSTransformations,d.HC=S.PeGTTransformations,d.GL=S.PeGeogtran,d.FL=S.PeFactoryCodechange,d.GC=S.PeGCSExtent,d.Eg=S.PePCSInfo,d.HL=S.PeHorizon,d.EL=S.PeCoordsys,d.np=S.PeGTlistExtended,d.np.PE_GTLIST_OPTS_USE_DEFAULT=128,d.qf.initialize(null),d.Lx=S.PeGTlistExtendedEntry,d.qf.fromString(d.Tc.PE_TYPE_UNIT,'UNIT["Meter",1.0]')},O}(),d.qf=null,d.IC=null,d.EL=null,d.HL=null,d.Eg=null,d.np=null,d.Lx=null,d.GC=null,d.FL=null,d.GL=null,d.Tc=null,d.HC=null,d.gj=null}(Q||(Q={})),function(d){var O=function(){function S(){}return S.Mb=function(p,l){return 0<=l?S.R(p):-S.R(p)},S.R=function(p){return 0>p?-p:p},S.vi=function(p){return 3552713678800501e-30>p},S.FC=function(p,l,s){return S.R(p-l)<=s*(1+(S.R(p)+S.R(l))/2)},S.$=function(p,l){return S.FC(p,l,3552713678800501e-30)},S.AL=function(p){return 3552713678800501e-30>=S.R(p)},S.Dd=function(p){return S.AL(p)},S}();d.s=O,d.F=function(){function S(){}return S.ip=function(p,l){var s=0;return(p=O.R(p))+(l=O.R(l))!=0&&(p>l?(s=l/p,s=p*Math.sqrt(1+s*s)):(s=p/l,s=l*Math.sqrt(1+s*s))),s},S.Yq=function(p,l,s,a,u){for(var f=[0,0,0],y=[0,0,0],v=0;2>=v;v++)l[v]-=p[v],s[v]-=l[v];s=f[1]*y[2]-f[2]*y[1],l=f[2]*y[0]-f[0]*y[2],f=f[0]*y[1]-f[1]*y[0],p=-1*(s*p[0]+l*p[1]+f*p[2]),a[0]=s,a[1]=l,a[2]=f,a[3]=p,y=S.qn(a),a[0]/=y,a[1]/=y,a[2]/=y,a[3]/=y,u!=0&&(y=O.Dd(f)?O.Dd(p)?O.Mb(1,l):-O.Mb(1,p):O.Mb(1,f),y*=O.Mb(1,u),a[0]*=y,a[1]*=y,a[2]*=y,a[3]*=y)},S.yx=function(p,l,s){s[0]=p[1]*l[2]-l[1]*p[2],s[1]=p[2]*l[0]-l[2]*p[0],s[2]=p[0]*l[1]-l[0]*p[1]},S.Ut=function(p,l){return p[0]*l[0]+p[1]*l[1]+p[2]*l[2]},S.qn=function(p){return S.ip(S.ip(p[0],p[1]),p[2])},S.el=function(p,l,s,a,u,f,y,v){p=S.n(p,l,s);var _=Math.cos(s);f.u=(p+u)*_*Math.cos(a),y.u=(p+u)*_*Math.sin(a),v.u=(p*(1-l)+u)*Math.sin(s)},S.eO=function(p,l,s,a,u,f,y){var v=S.ip(l,s),_=1*Math.sqrt(1-p),M=_/1;if(O.$(v,0))f.u=0,u.u=O.Mb(1.570796326794897,a),y.u=O.R(a)-_;else{f.u=Math.atan2(s,l),s=Math.atan2(1*a,_*v),f=Math.cos(s);var $=Math.sin(s);l=_*p/(1-p),p*=1,s=Math.atan2(a+l*$*$*$,v-p*f*f*f),3.141592653589793<O.R(s)&&(s=O.Mb(3.141592653589793,s)-s),s=Math.atan(M*Math.tan(s)),$=Math.sin(s),f=Math.cos(s),u.u=Math.atan2(a+l*$*$*$,v-p*f*f*f),1.570796326794897<O.R(u.u)&&(u.u=O.Mb(3.141592653589793,u.u)-u.u),s=Math.atan(M*Math.tan(u.u)),$=Math.sin(s),f=Math.cos(s),y.u=(a-_*$)*Math.sin(u.u)+(v-1*f)*Math.cos(u.u)}},S.n=function(p,l,s){return s=Math.sin(s),p/Math.sqrt(1-l*s*s)},S.pt=function(p,l){return Math.atan2(Math.sin(l)*(1-p),Math.cos(l))},S.Sj=function(p,l){return Math.atan2(Math.sin(l),Math.cos(l)*(1-p))},S.Tq=function(p,l){if(O.vi(p)||l==0||O.$(O.R(l),1.570796326794897))return l;if(.006884661117170036>p){var s=Math.sqrt(1-p),a=(1-s)/(1+s),u=a*a,f=a*u,y=a*f,v=a*y,_=a*v,M=a*_,$=1.572916666666667*f-3.2578125*v+4.295068359375*M;p=2.142578125*y-6.071484375*_,s=3.129296875*v-11.249837239583334*M;var T=4.775276692708333*_,A=7.958636765252976*M,R=Math.cos(2*l);return l+Math.sin(2*l)*(1.5*a-.84375*f+.525390625*v-.2688395182291667*M-$+s-A+R*(2*(1.3125*u-1.71875*y+1.650146484375*_)-4*p+6*T+R*(4*$-12*s+24*A+R*(8*p-32*T+R*(16*s-80*A+R*(32*T+64*R*A))))))}for(s=1-p,a=p/2,f=(u=O.R(l))*S.av(p)/(1.570796326794897*s),y=9999,_=u,u=0;1e-16<y&&50>u;u++)M=S.w(p,_),v=_-($=(v=(S.fG(_,p)-a*Math.sin(2*_)/M)/s-f)/(M=1/(M*M*M))),y=O.R($),_=v;return 0<=l?_:-_},S.lW=function(p,l){return O.vi(l)?p:p*S.av(l)/1.570796326794897},S.ca=function(p){return 0>(p=S.kF(p,6.283185307179586))?p+6.283185307179586:3.141592653589793>O.R(p)||O.$(O.R(p),3.141592653589793)?p:p-6.283185307179586},S.kF=function(p,l){return p-Math.floor(p/l)*l},S.Ch=function(p,l){if(.006884661117170036>l){var s=(l=(1-(l=Math.sqrt(1-l)))/(1+l))*l,a=s*s;return p/(1+l)*(1+.25*s+.015625*a+.00390625*s*a)*1.570796326794897}return p*S.av(l)},S.Xq=function(p,l){var s=O.Mb(1,Math.sin(l));return l=1.570796326794897>=(l=O.R(S.kF(l,3.141592653589793)))?l:3.141592653589793-l,(O.$(l,1.570796326794897)?l:Math.atan(Math.sqrt(1-p)*Math.tan(l)))*s},S.q=function(p,l,s){if(.006884661117170036>l){var a=(l=(1-(l=Math.sqrt(1-l)))/(1+l))*l,u=l*a,f=l*u,y=l*f,v=l*y,_=l*v,M=-.7291666666666666*u+.2278645833333333*y+.03987630208333334*_,$=.615234375*f-.21533203125*v,T=-.54140625*y+.20302734375*_,A=.48876953125*v,R=-.4488699776785715*_,D=Math.cos(2*s);return p/(1+l)*((1+.25*a+.015625*f+.00390625*v)*s+Math.sin(2*s)*(-1.5*l+.1875*u+.0234375*y+.00732421875*_-M+T-R+D*(2*(.9375*a-.234375*f-.03662109375*v)-4*$+6*A+D*(4*M-12*T+24*R+D*(8*$-32*A+D*(16*T-80*R+D*(32*A+64*D*R)))))))}return p*(S.fG(s,l)-.5*l*Math.sin(2*s)/S.w(l,s))},S.w=function(p,l){return l=Math.sin(l),Math.sqrt(1-p*l*l)},S.av=function(p){return O.FC(p,1,2220446049250313e-31)?1:1>p?S.Zw(0,1-p)-p/3*S.Ww(0,1-p):NaN},S.fG=function(p,l){var s=O.Mb(1,p);p=O.R(p);var a=Math.floor(p/1.570796326794897);if(1<l)l=p==0?0:NaN;else if(O.Dd(a))l=(p=S.sin(p))*S.Zw(1-p*p,1-l*p*p)-l/3*p*p*p*S.Ww(1-p*p,1-l*p*p);else{var u=d.P.truncate(a%2),f=S.av(l);0<u?l=f*(a+1)-(l=(p=Math.sin(1.570796326794897*(a+1)-p))*S.Zw(1-p*p,1-l*p*p)-l/3*p*p*p*S.Ww(1-p*p,1-l*p*p)):l=f*a+(l=(p=Math.sin(p-1.570796326794897*a))*S.Zw(1-p*p,1-l*p*p)-l/3*p*p*p*S.Ww(1-p*p,1-l*p*p))}return l*s},S.sin=function(p){p=S.ca(p);var l=O.Mb(1,p);return p=O.R(p),O.$(p,3.141592653589793)?0:O.$(p,1.570796326794897)?1*l:Math.sin(p)*l},S.Ww=function(p,l){var s,a,u,f,y=p,v=l,_=1;for(l=0,p=1;a=((s=.2*(y+v+3*_))-y)/s,u=(s-v)/s,f=(s-_)/s,!(1e-4>O.R(a)&&1e-4>O.R(u)&&1e-4>O.R(f));)f=Math.sqrt(v),l+=p/((s=Math.sqrt(_))*(_+(f=Math.sqrt(y)*(f+s)+f*s))),p*=.25,y=.25*(y+f),v=.25*(v+f),_=.25*(_+f);return v=(y=a*u)-(_=f*f),3*l+p*(1+(_=y-6*_)*(.10227272727272728*_-.2142857142857143-.1730769230769231*f*(a=_+v+v))+f*(.1666666666666667*a+f*(-.4090909090909091*v+.1153846153846154*f*y)))/(s*Math.sqrt(s))},S.Zw=function(p,l){for(var s,a,u,f,y=1;a=2-((s=(p+l+y)/3)+p)/s,u=2-(s+l)/s,f=2-(s+y)/s,!(1e-4>O.R(a)&&1e-4>O.R(u)&&1e-4>O.R(f));y=.25*(y+s))s=Math.sqrt(l),a=Math.sqrt(y),p=.25*(p+(s=Math.sqrt(p)*(s+a)+s*a)),l=.25*(l+s);return(1+(.04166666666666666*(p=a*u-f*f)-.1-.06818181818181818*(l=a*u*f))*p+.07142857142857142*l)/Math.sqrt(s)},S.Sw=function(p,l){if(O.vi(p)||l==0||O.$(O.R(l),1.570796326794897))return l;if(.006884661117170036>p){var s=p*p,a=p*s,u=p*a,f=p*u,y=p*f,v=p*y,_=-(.02708333333333333*a+.03430059523809524*u+.03149181547619048*f+.02634359154541446*y+.02156896735835538*v),M=.007669890873015873*u+.01299603174603175*f+.0148051353064374*y+.01454454953803912*v,$=-(.002275545634920635*f+.004830845032667949*y+.006558395368616723*v),T=.0006957236677288761*y+.001775193002406544*v,A=-.000217324089394402*v,R=Math.cos(2*l);return l+Math.sin(2*l)*(-(.5*p+.2083333333333333*s+.09375*a+.04878472222222222*u+.02916666666666667*f+.01938905423280423*y+.01388255931712963*v)-_+$-A+R*(2*(.1041666666666667*s+.0875*a+.06050347222222222*u+.04151785714285714*f+.02958958540013228*y+.02203667534722222*v)-4*M+6*T+R*(4*_-12*$+24*A+R*(8*M-32*T+R*(16*$-80*A+R*(32*T+64*R*A))))))}return l==0||O.$(O.R(l),1.570796326794897)?s=l:(u=(a=Math.sqrt(p))*Math.sin(l),s=Math.tan(.7853981633974483+l/2)*Math.pow((1-u)/(1+u),a/2),s=2*Math.atan(s)-1.570796326794897),s},S.tO=function(p,l){if(O.vi(p)||l==0||O.$(O.R(l),1.570796326794897))return l;if(.006884661117170036>p){var s=p*(T=p*($=p*(R=p*p))),a=p*(A=p*s),u=.05833333333333333*$+.07232142857142858*T+.05634300595238095*s+.0355325796406526*A+.020235546186067*a,f=.02653149801587302*T+.04379960317460317*s+.0429211791776896*A+.03255384637546096*a,y=.01294022817460318*s+.02668104344536636*A+.03155651254609588*a,v=.00659454790965208*A+.0163075268674227*a,_=.003463473736911237*a,M=Math.cos(2*l);return l+Math.sin(2*l)*(.5*p+.2083333333333333*R+.08333333333333333*$+.03611111111111111*T+.01875*s+.01195601851851852*A+.008863673941798942*a-u+y-_+M*(2*(.1458333333333333*R+.1208333333333333*$+.07039930555555556*T+.03616071428571429*s+.01839451058201058*A+.01017113095238095*a)-4*f+6*v+M*(4*u-12*y+24*_+M*(8*f-32*v+M*(16*y-80*_+M*(32*v+64*M*_))))))}var $=Math.sqrt(p),T=$/2,A=Math.tan(.7853981633974483+l/2);p=0,u=1;for(var R=l;u!=0;R=a)s=$*Math.sin(R),a=A*Math.pow((1+s)/(1-s),T),a=2*Math.atan(a)-1.570796326794897,p++,(O.$(a,R)||3e4<p)&&(u=0);return R},S}()}(Q||(Q={})),function(d){var O=function(){function S(p){this.wl=this.Ws=null,this.Kv=!1,this.BA=this.CA=0,this.CH=new d.h,this.SH=new d.h,this.FA=!1,this.xq=new d.l,this.rH=this.uw=0,this.vw=null,this.Bl=!1,this.Go=null,this.Xz=0,this.Re=p,this.Cs=d.Ab.zv(this.Re,0,!0),this.CH.Sc(),this.SH.Sc(),this.MH=NaN;var l=p.getCode();0<l?(this.Mk=l,d.qf.getCode(p)):this.Mk=d.qf.getCode(p),0>this.Mk&&(this.Mk=0);var s=this.Re.getType();if(this.eH=s==d.Tc.PE_TYPE_PROJCS?2:1,s==d.Tc.PE_TYPE_PROJCS&&!p.loadConstants())throw d.i.O("PeProjcs.loadConstants failed");l=s==d.Tc.PE_TYPE_GEOGCS?this.Re:this.Re.getGeogcs(),s!=d.Tc.PE_TYPE_GEOGCS&&d.qf.getCode(l),this.Go=p.getUnit(),this.MH=l.getPrimem().getLongitude(),this.rH=p=l.getUnit().getUnitFactor(),p=Math.PI/(180*p),1e-10>Math.abs(p-1)&&(p=1),this.BA=p,(s&d.Tc.PE_TYPE_PROJCS)!=0?(l=this.Re,this.CA=1/l.getUnit().getUnitFactor(),this.uw=.001/this.Re.getUnit().getUnitFactor(),this.vw=d.Eg.generate(l,d.Eg.PE_PCSINFO_OPTION_NONE),this.Bl=this.vw.isPannableRectangle(),this.Xz=d.Ab.lN(this.vw.getCentralMeridian(),this.BA)):(this.FA=this.Bl=!0,this.CA=0,s=1/l.getUnit().getUnitFactor(),this.uw=.001/l.getDatum().getSpheroid().getAxis()*s,this.Xz=0),this.Bl&&(this.wx(),this.yK(),this.jY(),this.xK(),this.hY(),this.iY())}return S.prototype.cs=function(){return this.Mk},S.prototype.mk=function(){return this.vw},S.Ky=function(p,l){return p==l||p!=null&&l!=null&&p.Mk==0&&l.Mk==0&&p.Cs===l.Cs},S.prototype.Xc=function(){return this.Bl},S.prototype.ih=function(p){p.L(this.uo)},S.prototype.rv=function(){return this.uo.v},S.prototype.qv=function(){return this.uo.C},S.prototype.BR=function(p){p.L(this.ww)},S.prototype.hY=function(){var p=this.Re.getType();if(p==d.Tc.PE_TYPE_PROJCS){p=this.Re;var l=this.mk().getCentralMeridian(),s=p.getGeogcs();if(s==null)throw d.i.ga("internal error");l=[[l+(s=1/s.getUnit().getUnitFactor()*Math.PI),0]],d.gj.geogToProj(p,1,l),l=l[0][0],s=p.getParameters()[d.Tc.PE_PARM_X0].getValue();var a=this.ol();p=new d.l,a.A(p),l=(a=Math.abs(l-s))+s,s=-1*a+s,a=p.H,p=p.G;var u=new d.l;u.L(s,p,l,a),this.uo==null&&(this.uo=u)}else{if(p!=d.Tc.PE_TYPE_GEOGCS)throw d.i.ga("internal error");s=1/this.Re.getUnit().getUnitFactor()*Math.PI,(p=new d.l).L(-s,-s/2,s,s/2),this.uo==null&&(this.uo=p)}},S.prototype.iY=function(){var p=this.Re.getType();if(p==d.Tc.PE_TYPE_PROJCS){var l=this.Re;if(p=this.mk().getCentralMeridian(),(l=l.getGeogcs())==null)throw d.i.ga("internal error");l=1/l.getUnit().getUnitFactor()*Math.PI;var s=this.Xr(),a=new d.l;s.A(a),(s=new d.l).L(p-l,a.G,p+l,a.H),this.ww==null&&(this.ww=s)}else{if(p!=d.Tc.PE_TYPE_GEOGCS)throw d.i.ga("internal error");l=1/this.Re.getUnit().getUnitFactor()*Math.PI,(p=new d.l).L(-l,-l/2,l,l/2),this.ww==null&&(this.ww=p)}},S.prototype.bf=function(){return this.BA},S.prototype.rm=function(){return this.CA},S.prototype.Xr=function(){if(this.Bl)return this.wl;var p=this.wl;return p!=null?p:(this.wx(),this.wl)},S.prototype.Yr=function(){return this.Bl?null:(this.wl!=null||this.wx(),this.TG)},S.prototype.wx=function(){if(this.Re.getType()==d.Tc.PE_TYPE_PROJCS){var p=this.Re,l=p.getGeogcs(),s=p.horizonGcsGenerate();if(s!=null){var a=s[0].getNump(),u=s[0].getKind();p=0<s[0].getInclusive();var f=this.bf(),y=90*f,v=360*f,_=370*f,M=180*f*d.Tc.PE_HORIZON_DELTA/Math.PI,$=new d.l,T=null;if(1<a){for(var A=1;A<a;A++)if(s[A].getKind()==d.Tc.PE_HORIZON_LINE){T==null&&(T=new d.Ua);var R=s[A].getCoord();T.rx(R[0][0],R[0][1]),T.Aj(R[1][0],R[1][1])}}if(u==d.Tc.PE_HORIZON_RECT)s=s[0].getCoord(),$.L(s[0][0],s[0][1]),$.$b(s[1][0],s[1][1]),Math.abs($.H-y)<1e-7*M&&($.H=y),Math.abs($.G+y)<1e-7*M&&($.G=-y),$.S()>_&&(s=-400*f,$.L(s,$.G,s+5*v,$.H)),s=new d.Hh($),this.wl==null&&(this.wl=s,this.Kv=p);else{if(_=new d.Ea,v=this.mk().isGcsHorizonMultiOverlap(),$=d.iu.XE(l,d.ju.Integer64),v){for(_=new d.bL,M=d.Ih.local().W(_,$,null),A=0;A<a;A++)if(s[A].getKind()==d.Tc.PE_HORIZON_POLY){for(l=s[A].getSize(),f=s[A].getCoord(),u=[],y=0;y<l;y++)u[y]=d.h.construct(f[y][0],f[y][1]);s[A].getInclusive(),v&&((f=new d.Ea).$k(u,l-1),_.VX(f),M.re())}_=M.next()}else for(A=0;A<a;A++)if(s[A].getKind()==d.Tc.PE_HORIZON_POLY){for(l=s[A].getSize(),f=s[A].getCoord(),v=[],y=0;y<l;y++)v[y]=d.h.construct(f[y][0],f[y][1]);s[A].getInclusive(),_.$k(v,l-1)}p?d.Zj.local().yn(_,$,1):d.mp.local().yn(_,$,1),d.fj.local().yn(_,$,1),this.wl==null&&(this.wl=_,this.Kv=p,this.TG=T)}}}},S.prototype.kv=function(){return this.Bl||this.wl==null&&this.wx(),this.Kv},S.prototype.yK=function(){if(this.eH==2){var p=this.Re.horizonPcsGenerate();if(p!=null){var l=p[0].getKind();p[0].getInclusive();var s=p[0].getNump(),a=!1;if(l==d.Tc.PE_HORIZON_RECT)p=p[0].getCoord(),(s=new d.l).L(p[0][0],p[0][1]),s.$b(p[1][0],p[1][1]),p=new d.Hh(s);else{for(l=-1,a=0;a<s;a++)p[a].getKind()==d.Tc.PE_HORIZON_POLY&&(l=a);for(a=p[l].getSize()-1,p=p[l].getCoord(),s=[],l=0;l<a;l++)s[l]=d.h.construct(p[l][0],p[l][1]);p=l=new d.Ea,l.$k(s,a),a=!0}this.mk().isDensificationNeeded()&&(s=1e5*this.rm(),p=d.Zl.local().W(p,s,null)),a&&(a=new d.Hh,p.dn(a),p.He(),p.Rb(),p.kR(),d.Zj.local().yn(p,null,1)),this.Ws==null&&(this.Ws=p)}}},S.prototype.ol=function(){if(this.Bl)return this.Ws;var p=this.Ws;return p!=null?p:(this.yK(),this.Ws)},S.prototype.jY=function(){if(this.Re.getType()==d.Tc.PE_TYPE_PROJCS){var p=90*this.bf();p=[[0,p],[0,-p]],d.gj.geogToProj(this.Re,2,p);var l=this.mk(),s=l.getNorthPoleLocation()!=d.Eg.PE_POLE_OUTSIDE_BOUNDARY;l=l.getSouthPoleLocation()!=d.Eg.PE_POLE_OUTSIDE_BOUNDARY,this.FA||(s&&this.CH.na(p[0][0],p[0][1]),l&&this.SH.na(p[1][0],p[1][1]))}this.FA=!0},S.prototype.xK=function(){if(this.eH==1){var p=400*this.bf();this.xq.L(-p,-p,p,p)}else p=d.Eg.generate(this.Re,d.Eg.PE_PCSINFO_OPTION_DOMAIN),p=d.l.construct(p.getDomainMinx(),p.getDomainMiny(),p.getDomainMaxx(),p.getDomainMaxy()),this.xq.B()&&this.xq.L(p)},S.prototype.cR=function(p){this.Bl&&p.L(this.xq),this.xq.B()&&this.xK(),p.L(this.xq)},S.prototype.Wp=function(){return this.MH},S.prototype.Bi=function(){return this.Xz},S.prototype.Id=function(){return this.Go},S.prototype.Zr=function(){return this.rH},S}();d.JC=O}(Q||(Q={})),function(d){var O=function(){function S(p){this.FT=p,this.Cs=d.Ab.zv(p,0,!0);var l=p.getCode();this.us=0<l?l:d.qf.getCode(p),0>this.us&&(this.us=0),this.Go=l=this.FT.getUnit(),this.DH=1/l.getUnitFactor(),d.qf.getCode(p)}return S.Ky=function(p,l){return p==l||p!=null&&l!=null&&p.us==0&&l.us==0&&p.Cs===l.Cs},S.prototype.cs=function(){return this.us},S}();d.KL=O}(Q||(Q={})),function(d){d.$g=function(){function O(){}return O.ub=function(S,p,l,s,a,u,f,y){if(u!=null||f!=null||y!=null){s=d.F.ca(s),p=d.F.ca(p),l=d.F.ca(l),a=d.F.ca(a),1.570796326794897<d.s.R(l)&&(l=d.s.Mb(3.141592653589793,l)-l,p=d.F.ca(p+3.141592653589793)),1.570796326794897<d.s.R(a)&&(a=d.s.Mb(3.141592653589793,a)-a,s=d.F.ca(s+3.141592653589793));var v=d.F.ca(s-p);if(d.s.$(l,a)&&(d.s.$(p,s)||d.s.$(d.s.R(l),1.570796326794897)))u!=null&&(u.u=0),f!=null&&(f.u=0),y!=null&&(y.u=0);else{if(d.s.$(l,-a)){if(d.s.$(d.s.R(l),1.570796326794897))return u!=null&&(u.u=3.141592653589793*S),f!=null&&(f.u=0<l?d.F.ca(3.141592653589793-d.F.ca(s)):d.F.ca(s)),void(y!=null&&(y.u=0<l?d.F.ca(s):d.F.ca(3.141592653589793-d.F.ca(s))));if(d.s.$(d.s.R(v),3.141592653589793))return u!=null&&(u.u=3.141592653589793*S),f!=null&&(f.u=0),void(y!=null&&(y.u=0))}var _=d.s.R(l)==1.570796326794897?0:Math.cos(l),M=Math.sin(l),$=d.s.R(a)==1.570796326794897?0:Math.cos(a),T=Math.sin(a),A=d.s.R(v)==1.570796326794897?0:Math.cos(v),R=d.s.R(v)==3.141592653589793?0:Math.sin(v);if(u!=null){var D=Math.sin((a-l)/2);v=Math.sin(v/2),u.u=2*Math.asin(Math.sqrt(D*D+_*$*v*v))*S}f!=null&&(f.u=d.s.$(d.s.R(l),1.570796326794897)?0>l?s:d.F.ca(3.141592653589793-s):Math.atan2($*R,_*T-M*$*A)),y!=null&&(d.s.$(d.s.R(a),1.570796326794897)?y.u=0>a?p:d.F.ca(3.141592653589793-p):(y.u=Math.atan2(_*R,T*_*A-$*M),y.u=d.F.ca(y.u+3.141592653589793)))}}},O.sf=function(S,p,l,s,a,u,f){if(u!=null||f!=null){p=d.F.ca(p),l=d.F.ca(l),1.570796326794897<d.s.R(l)&&(l=d.s.Mb(3.141592653589793,l)-l,p=d.F.ca(p+3.141592653589793)),d.s.$(d.s.R(l),1.570796326794897)&&(p=0),a=d.F.ca(a);var y=d.s.$(d.s.R(a),1.570796326794897)?0:Math.cos(a),v=d.s.$(d.s.R(a),3.141592653589793)?0:Math.sin(a),_=d.s.$(d.s.R(l),1.570796326794897)?0:Math.cos(l),M=Math.sin(l);S=s/S,s=d.s.$(d.s.R(S),1.570796326794897)?0:Math.cos(S);var $=d.s.$(d.s.R(S),3.141592653589793)?0:Math.sin(S),T=Math.asin(M*s+_*$*y);f!=null&&(f.u=T),u!=null&&(u.u=d.s.$(d.s.R(T),1.570796326794897)?d.s.$(l,-T)?0>T?a:d.F.ca(3.141592653589793-a):p:d.s.$(d.s.R(l),1.570796326794897)&&d.s.$(S,3.141592653589793)?0>l?a:d.F.ca(3.141592653589793-a):d.F.ca(p+Math.atan2($*v,_*s-M*$*y)))}},O}()}(Q||(Q={})),function(d){d.Yk=function(){function O(){}return O.ub=function(S,p,l,s,a,u,f,y,v){var _=new d.ha(0),M=new d.ha(0),$=[0,0,0],T=[0,0,0],A=[0,0,0],R=new d.ha(0),D=new d.ha(0),V=new d.ha(0),Z=new d.ha(0),ee=new d.ha(0);if(f!=null||y!=null||v!=null)if(d.s.vi(p))d.$g.ub(S,l,s,a,u,f,y,v);else{a=d.F.ca(a),l=d.F.ca(l);var G=d.F.ca(a-l);if(d.s.$(s,u)&&(d.s.$(l,a)||d.s.$(d.s.R(s),1.570796326794897)))f!=null&&(f.u=0),y!=null&&(y.u=0),v!=null&&(v.u=0);else{if(d.s.$(s,-u)){if(d.s.$(d.s.R(s),1.570796326794897))return f!=null&&(f.u=2*d.F.Ch(S,p)),y!=null&&(y.u=0<s?d.F.ca(3.141592653589793-d.F.ca(a)):d.F.ca(a)),void(v!=null&&(v.u=0<s?d.F.ca(a):d.F.ca(3.141592653589793-d.F.ca(a))));d.s.$(d.s.R(G),3.141592653589793)&&(f!=null&&(f.u=2*d.F.Ch(S,p)),y!=null&&(y.u=0),v!=null&&(v.u=0))}else(d.s.$(d.s.R(s),1.570796326794897)||d.s.$(d.s.R(u),1.570796326794897))&&(d.s.$(d.s.R(s),1.570796326794897)?l=a:a=l);var re=0;if(0>G){re=1;var oe=l;l=a,a=oe,oe=s,s=u,u=oe}G=d.F.pt(p,s);var se=d.F.pt(p,u);y==null&&v==null||(d.$g.ub(S,l,G,a,se,null,_,M),_=Math.atan2(Math.sin(_.u)*Math.cos(s-G),Math.cos(_.u)),M=Math.atan2(Math.sin(M.u)*Math.cos(u-se),Math.cos(M.u)),re!=0&&(oe=_,_=M,M=oe),y!=null&&(y.u=_),v!=null&&(v.u=M)),f!=null&&(d.F.el(1,p,s,l,0,V,Z,ee),$[0]=V.u,$[1]=Z.u,$[2]=ee.u,d.F.el(1,p,u,a,0,V,Z,ee),T[0]=V.u,T[1]=Z.u,T[2]=ee.u,A[0]=$[1]*T[2]-T[1]*$[2],A[1]=-($[0]*T[2]-T[0]*$[2]),A[2]=$[0]*T[1]-T[0]*$[1],p=1-d.F.w(p,d.F.Xq(p,d.F.Sj(p,Math.acos(A[2]/Math.sqrt(A[0]*A[0]+A[1]*A[1]+A[2]*A[2]))))),p*=2-p,y=Math.atan2(-A[1],-A[0]),A=d.F.ca(y-1.570796326794897),y=d.F.ca(y+1.570796326794897),A=d.s.R(d.F.ca(l-A))<=d.s.R(d.F.ca(l-y))?A:y,d.$g.ub(1,A,0,l,G,R,null,null),d.$g.ub(1,A,0,a,se,D,null,null),3.141592653589793<R.u+D.u&&(A=d.F.ca(A+3.141592653589793),d.$g.ub(1,A,0,l,G,R,null,null),d.$g.ub(1,A,0,a,se,D,null,null)),R.u*=d.s.Mb(1,s),D.u*=d.s.Mb(1,u),R.u=d.F.Sj(p,R.u),D.u=d.F.Sj(p,D.u),l=d.F.q(S,p,R.u),S=d.F.q(S,p,D.u),f.u=d.s.R(S-l))}}},O.sf=function(S,p,l,s,a,u,f,y){var v=0,_=new d.ha(0),M=new d.ha(0),$=[0,0,0],T=[0,0,0],A=new d.ha(0),R=new d.ha(0),D=new d.ha(0);if(f!=null||y!=null)if(d.s.vi(p))d.$g.sf(S,l,s,a,u,f,y);else if(d.s.Dd(a))f!=null&&(f.u=l),y!=null&&(y.u=s);else if(u=d.F.ca(u),0>a&&(a=d.s.R(a),u=d.F.ca(u+3.141592653589793)),l=d.F.ca(l),s=d.F.ca(s),1.570796326794897<d.s.R(s)&&(l=d.F.ca(l+3.141592653589793),s=d.s.Mb(3.141592653589793,s)-s),d.s.$(d.s.R(s),1.570796326794897)&&(l=0),d.s.Dd(s)){var V=d.s.R(1.570796326794897-d.s.R(u));V=d.F.Sj(p,V),V=1-d.F.w(p,d.F.Xq(p,V)),V*=2-V,S=a/d.F.Ch(S,V)*1.570796326794897,S=d.F.Tq(V,S),S=d.F.pt(V,S),d.$g.sf(1,l,s,S,u,f,_),y!=null&&(v=_.u),y!=null&&(y.u=d.F.Sj(p,v))}else if(d.s.$(d.s.R(s),1.570796326794897))_=2*(v=d.F.Ch(S,p)),u=0<(S=d.s.Mb(1.570796326794897,s))?d.F.ca(3.141592653589793-u):u,s=v-a,d.s.R(s)<=v?f!=null&&(f.u=u):(s=Math.floor(a/_),d.P.truncate(s%2)==0?(f!=null&&(f.u=u),a-=s*_):(f!=null&&(f.u=d.F.ca(u+3.141592653589793)),a=(s+1)*_-a),s=v-a),y!=null&&(y.u=d.F.Tq(p,s/v*S));else{V=d.F.pt(p,s),u=Math.atan2(Math.sin(u),Math.cos(u)*Math.cos(s-V));var Z=d.P.truncate(d.s.Mb(1,V))*(1.570796326794897>=d.s.R(u)?1:-1);u=d.F.ca(l+Math.atan(Math.tan(u)*-Math.sin(V))),d.$g.ub(S,u,0,l,V,null,M,null),V=d.s.R(1.570796326794897-d.s.R(M.u)),V=d.F.Sj(p,V),V=1-d.F.w(p,d.F.Xq(p,V)),V*=2-V,d.F.el(1,p,0,u,0,A,R,D),$[0]=A.u,$[1]=R.u,$[2]=D.u,d.F.el(1,p,s,l,0,A,R,D),T[0]=A.u,T[1]=R.u,T[2]=D.u,s=Math.acos(($[0]*T[0]+$[1]*T[1]+$[2]*T[2])/Math.sqrt(T[0]*T[0]+T[1]*T[1]+T[2]*T[2])),s=d.F.Sj(V,s),a=0<(s=d.F.q(S,V,s)+a*Z)?M.u:d.F.ca(M.u+3.141592653589793),S=d.s.R(s)/d.F.Ch(S,V)*1.570796326794897,S=d.F.Tq(V,S),S=d.F.pt(V,S),d.$g.sf(1,u,0,S,a,f,_),y!=null&&(v=_.u),y!=null&&(y.u=d.F.Sj(p,v))}},O}()}(Q||(Q={})),function(d){d.eu=function(){function O(){}return O.ub=function(S,p,l,s,a,u,f,y,v){var _=0,M=0,$=0;if(f!=null||y!=null||v!=null)if(d.s.vi(p))d.$g.ub(S,l,s,a,u,f,y,v);else{var T=d.F.ca(a-l);if(d.s.$(s,u)&&(d.s.Dd(T)||d.s.$(d.s.R(s),1.570796326794897)))f!=null&&(f.u=0),y!=null&&(y.u=0),v!=null&&(v.u=0);else{if(d.s.$(s,-u)){if(d.s.$(d.s.R(s),1.570796326794897))return f!=null&&(f.u=2*d.F.Ch(S,p)),y!=null&&(y.u=0<s?d.F.ca(3.141592653589793-d.F.ca(a)):d.F.ca(a)),void(v!=null&&(v.u=0<s?d.F.ca(a):d.F.ca(3.141592653589793-d.F.ca(a))));d.s.$(d.s.R(T),3.141592653589793)&&(f!=null&&(f.u=2*d.F.Ch(S,p)),y!=null&&(y.u=0),v!=null&&(v.u=0))}else if(d.s.$(d.s.R(s),1.570796326794897)||d.s.$(d.s.R(u),1.570796326794897)||d.s.Dd(T)||d.s.$(d.s.R(T),3.141592653589793))return void d.Yk.ub(S,p,l,s,a,u,f,y,v);var A=1-Math.sqrt(1-p),R=p/(1-p),D=S*(1-A);S=d.F.Xq(p,s);var V=d.F.Xq(p,u);p=d.s.R(S)==1.570796326794897?0:Math.cos(S);var Z=Math.sin(S),ee=d.s.R(V)==1.570796326794897?0:Math.cos(V),G=Math.sin(V),re=T,oe=Math.cos(re),se=Math.sin(re),ge=1,me=0;do{var Ie=re,De=Math.sqrt(Math.pow(ee*se,2)+Math.pow(p*G-Z*ee*oe,2)),Fe=Z*G+p*ee*oe,gt=Math.atan2(De,Fe);if(De==0){ge=0;break}var Ze=p*ee*se/De;if(_=Math.cos(Math.asin(Ze)),M=Fe-2*Z*G/(_*=_),1<d.s.R(M)&&(M=d.s.Mb(1,M)),re=T+(1-(re=A/16*_*(4+A*(4-3*_))))*A*Ze*(gt+re*De*(M+re*Fe*(2*($=M*M)-1))),oe=Math.cos(re),se=Math.sin(re),me++,3.141592653589793<d.s.R(re)&&30<me){ge=0;break}}while(5e3>=me&&!d.s.$(Ie,re));if(ge!=0)A=(R*=_)*(256+R*(R*(74-47*R)-128))/1024,f!=null&&(f.u=D*(1+R*(4096+R*(R*(320-175*R)-768))/16384)*(gt-A*De*(M+A/4*(Fe*(2*$-1)-A/6*M*(4*De*De-3)*(4*$-3))))),y!=null&&(y.u=d.s.$(d.s.R(s),1.570796326794897)?0>s?a:d.F.ca(3.141592653589793-a):Math.atan2(ee*se,p*G-Z*ee*oe)),v!=null&&(d.s.$(d.s.R(u),1.570796326794897)?v.u=0>u?l:d.F.ca(3.141592653589793-l):(v.u=Math.atan2(p*se,p*G*oe-Z*ee),v.u=d.F.ca(v.u+3.141592653589793)));else{re=d.s.Mb(3.141592653589793,T),Fe=Z*G-p*ee,gt=Math.acos(Fe),De=Math.sin(gt),_=1,me=Ze=0;do $=Ze,oe=1-.25*(Ze=A*(_*=_)*(1+A+A*A))+.1875*(M=A*A*(oe=_*_)*(1+2.25*A))-.1953125*(ge=A*A*A*oe*_),Ze=.25*Ze-.25*M+.29296875*ge,se=.03125*M-.05859375*ge,ge*=.00651041666666667,M=Fe-2*Z*G/_,1<d.s.R(M)&&(M=d.s.Mb(1,M)),_=Math.acos(M),Fe=Math.cos(2*_),Ie=Math.cos(3*_),se=(Ze=d.s.$(s,-u)?d.F.ca(3.141592653589793-T)/(3.141592653589793*A*oe):d.F.ca(re-T)/(A*(oe*gt+Ze*De*M+se*Math.sin(2*gt)*Fe+ge*Math.sin(3*gt)*Ie)))*De/(p*ee),re=1.570796326794897<d.s.R(T)?d.s.Mb(3.141592653589793,se)-Math.asin(se):Math.asin(se),oe=Math.cos(re),De=Math.sqrt(Math.pow(ee*se,2)+Math.pow(p*G-Z*ee*oe,2)),gt=3.141592653589793-Math.asin(d.s.R(De)),Fe=Math.cos(gt),_=Math.cos(Math.asin(Ze)),me++;while(70>=me&&!d.s.$($,Ze));f!=null&&(oe=1+(R*=_*=_)*(4096+R*(R*(320-175*R)-768))/16384,d.s.$(s,-u)?f.u=3.141592653589793*D*oe:(M=Fe-2*Z*G/_,_=Math.acos(M),Fe=Math.cos(2*_),Ie=Math.cos(3*_),f.u=D*(oe*gt+R*(R*(128+R*(35*R-60))-512)/2048*De*M+R*(5*R-4)/6144*R*R*Math.sin(2*gt)*Fe+ge*Math.sin(3*gt)*Ie+-762939453125e-16*R*R*R*R*Math.sin(4*gt)*Math.cos(4*_)))),y!=null&&(d.s.Dd(s)&&d.s.Dd(u)?(_=Math.sqrt(1-Ze*Ze),y.u=Math.acos(_),0>T&&(y.u*=-1)):d.s.$(d.s.R(s),1.570796326794897)?y.u=0>s?a:d.F.ca(3.141592653589793-a):(f=Ze/p,D=Math.sqrt(1-f*f),0>p*G-Z*ee*Math.cos(re)&&(D*=-1),y.u=Math.atan2(f,D),d.s.$(s,-u)&&d.s.R(d.F.ca(l-a))>3.141592653589793*(1-A*Math.cos(s))&&(0<s&&1.570796326794897>d.s.R(y.u)||0>s&&1.570796326794897<d.s.R(y.u))&&(y.u=d.s.Mb(3.141592653589793,y.u)-y.u))),v!=null&&(d.s.Dd(s)&&d.s.Dd(u)?(_=Math.sqrt(1-Ze*Ze),v.u=Math.acos(_),0<=T&&(v.u*=-1)):d.s.$(d.s.R(u),1.570796326794897)?v.u=0>u?l:d.F.ca(3.141592653589793-l):(T=Ze/ee,f=Math.sqrt(1-T*T),D=Math.sin(re/2),0>Math.sin(V-S)-2*p*G*D*D&&(f*=-1),v.u=Math.atan2(T,f),v.u=d.F.ca(v.u+3.141592653589793),d.s.$(s,-u)&&!d.s.Dd(s)&&!d.s.$(d.s.R(s),1.570796326794897)&&d.s.R(d.F.ca(l-a))>3.141592653589793*(1-A*Math.cos(s))&&(y!=null?D=y.u:(f=Ze/p,D=Math.sqrt(1-f*f),0>p*G-Z*ee*Math.cos(re)&&(D*=-1),D=Math.atan2(f,D),d.s.$(s,-u)&&d.s.R(d.F.ca(l-a))>3.141592653589793*(1-A*Math.cos(s))&&(0<s&&1.570796326794897>d.s.R(D)||0>s&&1.570796326794897<d.s.R(D))&&(D=d.s.Mb(3.141592653589793,D)-D)),1.570796326794897>=d.s.R(D)&&1.570796326794897<d.s.R(v.u)||1.570796326794897<=d.s.R(D)&&1.570796326794897>d.s.R(v.u))&&(v.u=-1*d.F.ca(v.u+3.141592653589793))))}}}},O.sf=function(S,p,l,s,a,u,f,y){if(f!=null||y!=null)if(d.s.vi(p))d.$g.sf(S,l,s,a,u,f,y);else if(u=d.F.ca(u),d.s.$(d.s.R(s),1.570796326794897)||d.s.Dd(u)||d.s.$(d.s.R(u),3.141592653589793))d.Yk.sf(S,p,l,s,a,u,f,y);else{var v=d.s.R(u)==1.570796326794897?0:Math.cos(u),_=d.s.R(u)==3.141592653589793?0:Math.sin(u);d.s.$(d.s.R(s),1.570796326794897)&&(l=0),u=1-Math.sqrt(1-p);var M=d.F.Xq(p,s);s=d.s.R(M)==1.570796326794897?0:Math.cos(M);var $=Math.sin(M);M=Math.atan2(Math.tan(M),v);var T=s*_,A=T*T,R=1-A,D=p/(1-p)*R,V=(p=D*(256+D*(D*(74-47*D)-128))/1024)/4,Z=p/6,ee=a/(S*(1-u)*(1+D*(4096+D*(D*(320-175*D)-768))/16384)),G=ee;do{var re=G;a=d.s.R(G)==1.570796326794897?0:Math.cos(G);var oe=(D=d.s.R(G)==3.141592653589793?0:Math.sin(G))*D;G=p*D*((S=Math.cos(2*M+G))+V*(a*(2*(G=S*S)-1)-Z*S*(4*oe-3)*(4*G-3)))+ee}while(!d.s.$(re,G));a=d.s.R(G)==1.570796326794897?0:Math.cos(G),D=d.s.R(G)==3.141592653589793?0:Math.sin(G),f!=null&&(_=Math.atan2(D*_,s*a-$*D*v),R=u/16*R*(4+u*(4-3*R)),S=Math.cos(2*M+G),f.u=d.F.ca(l+(_-(1-R)*u*T*(G+R*D*(S+R*a*(2*S*S-1)))))),y!=null&&(R=$*D-s*a*v,R=(1-u)*Math.sqrt(A+R*R),y.u=Math.atan2($*a+s*D*v,R))}},O}()}(Q||(Q={})),function(d){d.KC=function(){function O(){}return O.ub=function(S,p,l,s,a,u,f,y,v){var _=d.F.ca(a-l),M=d.s.$(d.s.R(s),1.570796326794897),$=d.s.$(d.s.R(u),1.570796326794897);if(d.s.$(s,u)&&(d.s.Dd(_)||M))f!=null&&(f.u=0),y!=null&&(y.u=0),v!=null&&(v.u=0);else{if(d.s.vi(p)){var T=Math.sin(s),A=Math.sin(u);T=Math.sqrt((1+T)/(1-T)),A=Math.sqrt((1+A)/(1-A)),T=Math.log(A)-Math.log(T),T=Math.atan2(_,T),f!=null&&(f.u=d.s.$(s,u)?d.s.R(S*Math.cos(s)*_):d.s.R((S*u-S*s)/Math.cos(T)))}else A=d.F.Sw(p,u),T=Math.sin(d.F.Sw(p,s)),A=Math.sin(A),T=Math.sqrt((1+T)/(1-T)),A=Math.sqrt((1+A)/(1-A)),T=Math.log(A)-Math.log(T),T=Math.atan2(_,T),f!=null&&(d.s.$(s,u)?f.u=d.s.R(S*_*Math.cos(s)/d.F.w(p,s)):(_=d.F.q(S,p,s),S=d.F.q(S,p,u),f.u=d.s.R((S-_)/Math.cos(T))));y==null&&v==null||(f=d.F.ca(T+3.141592653589793),M&&$||!M&&!$||(M?T=0>s?a:d.F.ca(3.141592653589793-a):$&&(f=0>u?l:d.F.ca(3.141592653589793-l))),y!=null&&(y.u=T),v!=null&&(v.u=f))}},O.sf=function(S,p,l,s,a,u,f,y){u=d.F.ca(u),0>a&&(a=d.s.R(a),u=d.F.ca(u+3.141592653589793)),d.s.vi(p)?d.s.$(d.s.R(s),1.570796326794897)?(l=0>s?u:d.F.ca(3.141592653589793-u),3.141592653589793>=(u=a/S%6.283185307179586)?S=s-d.s.Mb(u,s):(l=d.F.ca(l+3.141592653589793),S=-s+d.s.Mb(u-3.141592653589793,s))):d.s.$(d.s.R(u),1.570796326794897)?(l=d.F.ca(l+d.s.Mb(a,u)/(S*Math.cos(s))),S=s):(S=s+a*Math.cos(u)/S,1.570796326794897<d.s.R(S)&&(S=1.570796326794897),d.s.$(d.s.R(S),1.570796326794897)&&(d.s.Dd(u)||d.s.$(d.s.R(u),3.141592653589793))||(1.570796316258184<d.s.R(S)&&(S=d.s.Mb(1.570796316258184,S)),p=Math.sin(s),s=Math.sin(S),p=Math.sqrt((1+p)/(1-p)),s=Math.sqrt((1+s)/(1-s)),p=Math.log(s)-Math.log(p),l=d.F.ca(l+Math.tan(u)*p))):d.s.$(d.s.R(s),1.570796326794897)?(l=0>s?u:d.F.ca(3.141592653589793-u),u=a/d.F.lW(S,p),3.141592653589793>=(u%=6.283185307179586)?S=s-d.s.Mb(u,s):(l=d.F.ca(l+3.141592653589793),S=-s+d.s.Mb(u-3.141592653589793,s)),S=d.F.Tq(p,S)):d.s.$(d.s.R(u),1.570796326794897)?(l=d.F.ca(l+d.s.Mb(a,u)*d.F.w(p,s)/(S*Math.cos(s))),S=s):(S=1.570796326794897*(a*Math.cos(u)+d.F.q(S,p,s))/d.F.Ch(S,p),1.570796326794897<d.s.R(S)&&(S=d.s.Mb(1.570796326794897,S)),S=d.F.Tq(p,S),d.s.$(d.s.R(S),1.570796326794897)&&(d.s.Dd(u)||d.s.$(d.s.R(u),3.141592653589793))||(a=d.F.Sw(p,s),s=d.F.Sw(p,S),1.570796316258184<d.s.R(s)&&(s=d.s.Mb(1.570796316258184,S),S=d.F.tO(p,s)),p=Math.sin(a),s=Math.sin(s),p=Math.sqrt((1+p)/(1-p)),s=Math.sqrt((1+s)/(1-s)),p=Math.log(s)-Math.log(p),l=d.F.ca(l+Math.tan(u)*p))),f!=null&&(f.u=l),y!=null&&(y.u=S)},O}()}(Q||(Q={})),function(d){d.kb=function(){function O(){}return O.Sy=function(S,p,l,s,a,u,f){d.eu.ub(S,p,l,s,a,u,null,f,null)},O.Ai=function(S,p,l,s,a,u,f,y){d.eu.sf(S,p,l,s,a,u,f,y)},O.xd=function(S,p,l,s,a,u,f,y,v,_){switch(_){case 2:d.Yk.ub(S,p,l,s,a,u,f,y,v);break;case 3:d.LC.ub(S,p,l,s,a,u,f,y,v);break;case 1:d.KC.ub(S,p,l,s,a,u,f,y,v);break;default:d.eu.ub(S,p,l,s,a,u,f,y,v)}},O.qj=function(S,p,l,s,a,u,f,y,v){switch(v){case 2:d.Yk.sf(S,p,l,s,a,u,f,y);break;case 3:d.LC.sf(S,p,l,s,a,u,f,y);break;case 1:d.KC.sf(S,p,l,s,a,u,f,y);break;default:d.eu.sf(S,p,l,s,a,u,f,y)}},O}()}(Q||(Q={})),function(d){var O=function(){function p(){this.y=this.x=null}return p.construct=function(l){var s=new p;return s.x=new d.Xb,s.x.set(l.x),s.y=new d.Xb,s.y.set(l.y),s},p.QE=function(l,s){var a=new p;return a.x=new d.Xb,a.x.set(l),a.y=new d.Xb,a.y.set(s),a},p.prototype.rg=function(){return this.x.rg()&&this.y.rg()},p.prototype.value=function(){return d.h.construct(this.x.value(),this.y.value())},p}();d.rY=O;var S=function(){function p(){this.z=this.y=this.x=null}return p.construct=function(l){var s=new p;return s.x=new d.Xb,s.x.set(l.x),s.y=new d.Xb,s.y.set(l.y),s.z=new d.Xb,s.z.set(l.z),s},p.QE=function(l,s,a){var u=new p;return u.x=new d.Xb,u.x.set(l),u.y=new d.Xb,u.y.set(s),u.z=new d.Xb,u.z.set(a),u},p.prototype.rg=function(){return this.x.rg()&&this.y.rg()&&this.z.rg()},p.prototype.value=function(){return new d.Od(this.x.value(),this.y.value(),this.z.value())},p.prototype.Sh=function(l){var s=new d.Xb,a=new d.Xb,u=new d.Xb;return s.Ml(this.x,l.x),a.Ml(this.y,l.y),u.Ml(this.z,l.z),(l=new d.Xb).ZM(s,a),l.add(u),l},p.prototype.YE=function(l){var s=new p;s.x.Ml(this.y,l.z),s.y.Ml(this.z,l.x),s.z.Ml(this.x,l.y);var a=new d.Xb,u=new d.Xb,f=new d.Xb;return a.Ml(this.z,l.y),u.Ml(this.x,l.z),f.Ml(this.y,l.x),s.x.sub(a),s.y.sub(u),s.z.sub(f),s},p}();d.sY=S,d.Nx=function(){function p(){}return p.zP=function(l,s,a){var u=s.x;s=s.y,p.el(1,l,Math.cos(u),Math.sin(u),Math.cos(s),Math.sin(s),a)},p.yP=function(l,s){var a=new d.Od;return p.zP(l,s,a),a},p.el=function(l,s,a,u,f,y,v){l/=Math.sqrt(1-s*y*y),v.L(l*f*a,l*f*u,l*(1-s)*y)},p.$u=function(l,s){var a=new d.Xb,u=new d.Xb,f=new d.Xb,y=new d.Xb;a.cos(s.x),u.sin(s.x),f.cos(s.y),y.sin(s.y);var v=new d.Xb;return v.set(y),v.Bg(y),v.Po(l),v.Po(-1),v.fN(),v.sqrt(),(s=new d.Xb).set(1),s.lm(v),(v=new d.Xb).set(s),v.Bg(f),v.Bg(a),(a=new d.Xb).set(s),a.Bg(f),a.Bg(u),(u=new d.Xb).set(s),u.Po(1-l),u.Bg(y),S.QE(v,a,u)},p.NS=function(l,s,a,u){if(Math.abs(s.x-a.x)>Math.PI||Math.abs(s.y)>.5*Math.PI||Math.abs(a.y)>.5*Math.PI||(Math.abs(s.y)==.5*Math.PI||Math.abs(a.y)==.5*Math.PI)&&s.x!=a.x)return NaN;if(u=p.YA(u,Math.min(s.x,a.x),Math.max(s.x,a.x)),!new d.Oc(s.x,a.x).contains(u))return NaN;var f=O.construct(s);if(a=O.construct(a),f=p.$u(l,f),a=p.$u(l,a),(a=f.YE(a)).z.rg())return s.y;var y=new d.Xb;y.set(a.x),y.lm(a.z),y.Po(-1);var v=new d.Xb;v.set(a.y),v.lm(a.z),v.Po(-1);var _=new d.Xb;return _.set(v),_.Bg(v),(f=new d.Xb).set(y),f.Bg(y),f.add(_),f.sqrt(),f.rg()||y.rg()&&v.rg()?s.y:(s=Math.atan2(v.value(),y.value()),s=Math.atan2(f.value()*Math.cos(s-u),1-l),u=p.yP(l,d.h.construct(u,s)),l=new d.Od(u.x,u.y,-u.z),u=a.value().Sh(u),l=a.value().Sh(l),Math.abs(l)<Math.abs(u)&&(s=-s),s)},p.Jz=function(l,s,a,u,f){if(f[0]=NaN,f[1]=NaN,Math.abs(s.x-a.x)>Math.PI||Math.abs(s.y)>.5*Math.PI||Math.abs(a.y)>.5*Math.PI||(Math.abs(s.y)==.5*Math.PI||Math.abs(a.y)==.5*Math.PI)&&s.x!=a.x||Math.abs(u)>=.5*Math.PI||0<s.y&&0<a.y&&s.y>u&&a.y>u||0>s.y&&0>a.y&&s.y<u&&a.y<u)return 0;var y=O.construct(s),v=O.construct(a);y=p.$u(l,y),v=p.$u(l,v);var _=y.YE(v);if(_.z.rg())return new d.Oc(s.y,a.y).contains(u)?(f[0]=s.x,1):0;(v=new d.Xb).set(_.x),v.lm(_.z),v.Po(-1),(y=new d.Xb).set(_.y),y.lm(_.z),y.Po(-1),(_=new d.Xb).set(y),_.Bg(y);var M=new d.Xb;return M.set(v),M.Bg(v),M.add(_),M.sqrt(),M.rg()||v.rg()&&y.rg()?u==0?(f[0]=s.x,f[1]=a.x,2):0:(l=(1-l)*Math.tan(u)/M.value(),1<Math.abs(l)?0:(l=Math.acos(l),_=Math.atan2(y.value(),v.value()),v=Math.min(s.x,a.x),y=Math.max(s.x,a.x),a=p.YA(_-l,v,y),l=u!=0?p.YA(_+l,v,y):a,u=0,v<=a&&a<=y&&(f[u]=a,u++),l!=a&&v<=l&&l<=y&&(f[u]=l,++u==2&&Math.abs(f[0]-s.x)>Math.abs(f[1]-s.x)&&(s=f[0],f[0]=f[1],f[1]=s)),u))},p.YA=function(l,s,a){return l>a?l-=2*(s=Math.ceil((l-a)/(2*Math.PI)))*Math.PI:l<s&&(l+=2*(s=Math.ceil((s-l)/(2*Math.PI)))*Math.PI),l},p}()}(Q||(Q={})),function(d){d.SK=function(){function O(){}return O.WX=function(S,p){var l=8,s=[0,0,0,0],a=new d.h;a.N(p),a.scale(d.cb.tc(S).Id().Fc()==9102?1:d.cb.tc(S).Id().ci/3.141592653589793*180),-180>a.x?(a.x-=a.x%360,-180>a.x&&(a.x+=360)):180<a.x&&(a.x-=a.x%360,180<a.x&&(a.x-=360)),90<a.y&&(a.y=90),-90>a.y&&(a.y=-90);for(var u=-180,f=180,y=(S=5*l)-1,v=(p=(S+31)/32)-1;0<=v;v--)for(var _=y-32*v,M=Math.min(32,S-32*v),$=1;$<M;$+=2){var T=.5*(f+u);a.x>=T?(s[v]|=1<<_,u=T):f=T,_-=2,y-=2}for(u=-90,f=90,y=S-2,v=p-1;0<=v;v--)for(_=y-32*v,M=Math.min(32,S-32*v),$=0;$<M;$+=2)T=.5*(f+u),a.y>=T?(s[v]|=1<<_,u=T):f=T,_-=2,y-=2;return O.VP(s,l,l)},O.VP=function(S,p,l){for(var s=[],a=0;a<p;a++)s[a]="";for(var u=a=0,f=0;f<p;f++){var y=S[a]>>u&31;if(31<(u+=5)){var v=37-u;y&=(1<<v)-1,u-=32,y|=(S[++a]&(1<<u)-1)<<v}s[p-1-f]="0123456789bcdefghjkmnpqrstuvwxyz".split("")[y]}if(l>p)for(f=0;f<l-p;f++)s.push("0");else l<p&&(s.length=l);return s.join("")},O}()}(Q||(Q={})),function(d){var O={gcstol:[0,2e-9,1,2241706620489156e-24,2,2313672246530541e-24,3,898240164660333e-23,4,8982433838020134e-24,5,8982439417325895e-24,6,8982466029667677e-24,7,8982476760268133e-24,8,8982492642167149e-24,9,898251968292634e-23,10,898253685210448e-23,11,8982546725256576e-24,12,8982557456049832e-24,13,898257333682596e-23,14,8982575482995276e-24,15,8982578488197342e-24,16,8982579775336987e-24,17,89825840676828e-22,18,8982599090925448e-24,19,8982605529473397e-24,20,8982609220517402e-24,21,8982611968030573e-24,22,8982616260407152e-24,23,8982620552787834e-24,24,8982633429954492e-24,25,8982637722351582e-24,26,898264416095491e-23,27,8982646307158072e-24,28,8982654891980968e-24,29,8982667769246082e-24,30,8982674207892485e-24,31,8982680646548117e-24,32,8982682792768713e-24,33,8982685798042582e-24,34,8982689231436652e-24,35,898269137766135e-23,36,898269266624163e-23,37,8982705114087017e-24,38,8982706830791106e-24,39,8982711958374661e-24,40,8982712839964735e-24,41,8982717991496125e-24,42,8982721424914803e-24,43,8982723571154887e-24,44,8982727863638127e-24,45,8982730868942154e-24,46,8982734302370678e-24,47,8982745033612112e-24,48,8982751472369276e-24,49,8982755764879183e-24,50,8982762203651733e-24,51,8982764776628385e-24,52,8982766496171896e-24,53,898277722749025e-23,54,898278152002477e-23,55,898279933943848e-23,56,89829143024805e-22,57,8982922161948598e-24,58,898292327314211e-23,59,8982925667349601e-24,60,8982932222965576e-24,61,8982961298941316e-24,62,8982965524049989e-24,63,8982994818246099e-24,64,8982994895706967e-24,65,898299489597736e-23,66,8983000733443498e-24,67,8983055097289157e-24,68,8983064111047368e-24,69,8983111996941178e-24,70,8983120447446023e-24,71,898312748954554e-23,72,8983134531656096e-24,73,8983141573777694e-24,74,8983148615910332e-24,75,8983152841195215e-24,76,8983153545409748e-24,77,8983153827095593e-24,78,898315396793852e-23,79,8983154249624393e-24,80,8983155658054012e-24,81,8983960794340072e-24,82,8984061344391998e-24,83,8984072829255685e-24,84,8984194981201908e-24,85,8984275233099427e-24,86,8984326127007554e-24,87,8984330099816539e-24,88,898433275258421e-23,89,8984333047023206e-24,90,8984333885258723e-24,91,8984337959508212e-24,92,8984365176209457e-24,93,8984727360418079e-24,94,8984901041679577e-24,95,898542662091587e-23,96,898610024130669e-23,97,8992894229037531e-24,98,8993203677616635e-24,99,8993206178094346e-24,100,8993216059187305e-24,101,899322029394808e-23,102,8994627867045891e-24,103,9467559984315793e-24,104,946881168618118e-23,105,9980888154931644e-24,106,9981105353606775e-24,107,9983807356573187e-24,108,1687060485811522e-23,109,1688447560354875e-23,110,2176606011487185e-23,111,2225078816042032e-23,112,2348476432064694e-23,113,2348765250187846e-23,114,2378108974103778e-23,115,314559636297708e-22,116,3297788621680806e-23,117,3667892343788279e-23,118,4235973644320739e-23,119,4794625900676345e-23,120,7262742998235812e-23,121,7499447580246377e-23,122,7525056410964318e-23,123,7979913581209237e-23,124,9662020153976783e-23,125,9799175562353741e-23,126,9897353517547472e-23,127,102313891987647e-21,128,1081460541960784e-22,129,121905913857622e-21,130,2246893314238523e-22,131,2297344808062643e-22,132,242984645941825e-21,133,2754604784282804e-22,134,2884548130346993e-22,135,3370339971357784e-22,136,4307953346848296e-22,137,5208707228462029e-22,138,5509209568565608e-22,139,6452227422644406e-22,140,6740679942715567e-22,141,6861770001566745e-22,142,7252630318111686e-22,143,7441010326374328e-22,144,7742672907173287e-22,145,9629542775307953e-22,146,1061032953945969e-21,147,1143628333594458e-21,148,1162186197019925e-21,149,136418522650196e-20,150,1367441038498385e-21,151,1432394487827058e-21,152,1736235742820677e-21,153,1848250952034914e-21,154,1909859317102744e-21,155,1975716534933873e-21,156,2122065907891938e-21,157,272837045300392e-20,158,3183098861837907e-21,159,3580986219567645e-21,160,3819718634205488e-21,161,409255567950588e-20,162,4407367654852486e-21,163,4774648292756861e-21,164,5161781938115525e-21,165,520870722846203e-20,166,5729577951308232e-21,167,6031134685587613e-21,168,6987290184522236e-21,169,9241254760174569e-21,170,1145915590261646e-20],pcstol:[0,6666666666666667e-24,1,2e-8,2,4970973863636364e-20,3,4970978156565657e-20,4,4970980410559237e-20,5,.001,6,.001093615055555556,7,.001093615194444445,8,.001093619003239988,9,.001093623110088878,10,.003280833333333333,11,.003280839895013123,12,.003280843014596366,13,.003280845583333334,14,.003280869330266636,15,.00497101413676763],newtoold:[2154,102110,2195,102200,2204,32036,2205,26979,2225,102641,2226,102642,2227,102643,2228,102644,2229,102645,2230,102646,2231,102653,2232,102654,2233,102655,2234,102656,2235,102657,2236,102658,2237,102659,2238,102660,2239,102666,2240,102667,2241,102668,2242,102669,2243,102670,2246,102679,2247,102680,2248,102685,2249,102686,2250,102687,2254,102694,2255,102695,2257,102712,2258,102713,2259,102714,2260,102715,2261,102716,2262,102717,2263,102718,2264,102719,2267,102724,2268,102725,2271,102728,2272,102729,2274,102736,2275,102737,2276,102738,2277,102739,2278,102740,2279,102741,2283,102746,2284,102747,2285,102748,2286,102749,2287,102752,2288,102753,2289,102754,2312,23433,2326,102140,2395,2091,2396,2092,2397,2166,2398,2167,2399,2168,2759,102229,2760,102230,2761,102248,2762,102249,2763,102250,2764,102251,2765,102252,2766,102241,2767,102242,2768,102243,2769,102244,2770,102245,2771,102246,2772,102253,2773,102254,2774,102255,2775,102256,2776,102257,2777,102258,2778,102259,2779,102260,2780,102266,2781,102267,2782,102261,2783,102262,2784,102263,2785,102264,2786,102265,2787,102268,2788,102269,2789,102270,2790,102271,2791,102272,2792,102273,2793,102274,2794,102275,2795,102276,2796,102277,2797,102278,2798,102279,2799,102280,2800,102281,2801,102282,2802,102283,2803,102284,2804,102285,2805,102286,2806,102287,2807,102288,2808,102289,2809,102290,2810,102291,2811,102292,2812,102293,2813,102294,2814,102295,2815,102296,2816,102297,2817,102298,2818,102300,2819,102304,2820,102307,2821,102308,2822,102309,2823,102310,2824,102311,2825,102312,2826,102313,2827,102314,2828,102315,2829,102316,2830,102317,2831,102318,2832,102320,2833,102321,2834,102322,2835,102323,2836,102324,2837,102325,2838,102326,2839,102327,2840,102330,2841,102334,2842,102335,2843,102336,2844,102337,2845,102338,2846,102339,2847,102340,2848,102341,2849,102342,2850,102343,2851,102344,2852,102345,2853,102346,2854,102347,2855,102348,2856,102349,2857,102350,2858,102351,2859,102352,2860,102353,2861,102354,2862,102355,2863,102356,2864,102357,2865,102358,2866,102361,2942,102167,2943,102169,2944,2139,2945,2140,2946,2141,2947,2142,2948,2143,2949,2144,2950,2145,2951,2146,2952,2147,2953,2036,2954,2291,2955,2153,2956,2152,2957,2151,2958,2150,2959,2149,2960,2037,2961,2038,2962,2148,2965,2244,2966,2245,3003,102091,3004,102092,3005,102190,3060,2982,3067,102139,3072,102606,3074,102608,3075,102208,3077,102210,3078,102123,3080,102119,3081,102603,3082,102602,3083,102601,3088,65163,3089,102763,3090,102363,3092,102151,3093,102152,3094,102153,3095,102154,3096,102155,3097,102145,3098,102146,3099,102147,3100,102148,3101,102149,3102,2155,3107,102172,3110,102170,3111,102171,3119,2214,3158,102234,3159,102235,3160,102236,3336,2979,3338,102006,3346,2600,3370,102126,3371,102127,3372,102130,3373,102131,3389,2577,3390,2694,3400,102184,3401,102185,3404,3359,3407,3366,3417,102675,3418,102676,3419,102677,3420,102678,3421,102707,3422,102708,3423,102709,3424,102711,3433,102651,3434,102652,3435,102671,3436,102672,3437,102710,3438,102730,3448,102095,3451,102681,3452,102682,3455,102735,3461,2063,3462,2064,3463,3073,3464,3076,3560,102742,3566,102743,3567,102744,3734,102722,3735,102723,3736,102755,3737,102756,3738,102757,3739,102758,3741,102205,3742,102206,3743,102207,3748,102211,3750,102202,3751,102203,3759,102663,3760,102463,3764,102112,3770,102090,3771,102180,3772,102181,3773,102182,3775,102186,3776,102187,3777,102188,3800,102183,3801,102189,3812,102199,3814,102609,3815,102469,3819,104990,3821,104136,3824,104137,3825,102444,3826,102443,3827,102442,3828,102441,3857,102100,3889,104991,3906,104992,4048,103201,4049,103202,4050,103203,4051,103204,4056,103205,4057,103206,4058,103207,4059,103208,4060,103209,4061,103210,4062,103211,4063,103212,4071,103213,4082,103214,4083,103215,4093,103216,4094,103217,4095,103218,4096,103219,4167,104108,4169,37252,4171,104107,4189,104110,4197,4234,4223,37223,4304,104304,4414,102201,4415,102762,4417,102764,4434,102765,4437,102647,4455,32029,4456,32018,4457,3454,4462,102439,4463,4466,4470,4469,4484,103794,4485,103795,4486,103796,4487,103797,4488,103798,4489,103799,4611,104104,4612,104111,4613,37255,4615,37247,4616,37250,4617,4140,4618,4291,4620,37211,4626,37235,4647,102362,4658,37204,4668,37201,4669,4126,4672,37217,4673,104125,4675,37220,4684,37232,4698,4631,4707,37213,4708,37231,4709,37212,4710,37238,4711,37214,4712,37237,4713,37208,4714,37215,4715,37253,4716,37216,4717,37239,4719,37219,4722,37242,4724,37233,4725,37222,4727,37224,4728,37246,4729,37226,4730,37227,4731,37228,4732,37229,4733,37230,4734,37251,4735,37259,4736,37254,4739,37205,4758,104133,4760,37001,4762,104114,4826,102214,5013,104142,5014,102331,5015,102332,5016,102333,5173,102085,5174,102086,5175,102087,5176,102088,5177,102089,5178,102040,5179,102080,5185,102081,5186,102082,5187,102083,5188,102084,5221,102066,5246,104100,5247,102490,5324,104144,5325,102420,5329,2934,5365,104143,5367,102305,5451,104132,5513,102065,5514,102067,5519,102111,5520,31461,5646,102745,5839,5388,5858,5532,5879,4474,6207,104256,6244,102769,6245,102790,6246,102770,6247,102771,6248,102793,6249,102796,6250,102772,6251,102788,6252,102775,6253,102795,6254,102781,6255,102767,6256,102774,6257,102768,6258,102797,6259,102789,6260,102780,6261,102783,6262,102787,6263,102791,6264,102777,6265,102798,6266,102779,6267,102784,6268,102792,6269,102782,6270,102785,6271,102794,6272,102773,6273,102778,6274,102786,6275,102776,6311,104141,6318,104145,6322,104287,6325,104286,6328,102046,6329,102047,6330,102048,6331,102049,6332,102050,6333,102051,6334,102052,6335,102053,6336,102054,6337,102055,6338,102056,6339,102057,6340,102058,6341,102059,6342,102382,6343,102383,6344,102384,6345,102385,6346,102386,6347,102387,6348,102388,6350,102965,6355,102975,6356,102976,6391,6141,6393,102966,6394,102977,6395,102978,6396,102979,6397,102980,6398,102981,6399,102982,6400,102983,6401,102984,6402,102985,6403,102986,6404,102988,6405,102991,6406,102987,6407,102990,6408,102989,6409,102992,6410,102993,6411,102995,6412,102994,6413,102996,6414,102962,6415,102997,6416,103003,6417,102998,6418,103004,6419,102999,6420,103005,6421,103e3,6422,103006,6423,103001,6424,103007,6425,103002,6426,103008,6427,103010,6428,103013,6429,103009,6430,103012,6431,103011,6432,103014,6433,103015,6434,103016,6435,103017,6436,103018,6437,103019,6438,103022,6439,102967,6440,103021,6441,103024,6442,103020,6443,103023,6444,103025,6445,103027,6446,103026,6447,103028,6448,103030,6449,103033,6450,103029,6451,103032,6452,103031,6453,103034,6454,103035,6455,103037,6456,103036,6457,103038,6458,103039,6459,103041,6460,103040,6461,103042,6462,103043,6463,103045,6464,103044,6465,103046,6466,103047,6467,103049,6468,103048,6469,103050,6470,103051,6471,103052,6472,103053,6473,103054,6474,103055,6475,103056,6476,103057,6477,103059,6478,103058,6479,103060,6480,103066,6481,103065,6482,103067,6483,103061,6484,103063,6485,103062,6486,103064,6487,103068,6488,103069,6489,103071,6490,103073,6491,103070,6492,103072,6493,103075,6494,103078,6495,103074,6496,103077,6497,102968,6498,103076,6499,103079,6500,103081,6501,103084,6502,103080,6503,103083,6504,103082,6505,103085,6506,103086,6507,103088,6508,102963,6509,103087,6510,103089,6511,103091,6512,103090,6513,103092,6514,103093,6515,103094,6516,103095,6518,103098,6519,103101,6520,103097,6521,103100,6522,103099,6523,103102,6524,103103,6525,103104,6526,103105,6527,103106,6528,103108,6529,103111,6530,103107,6531,103110,6532,103109,6533,103112,6534,103114,6535,103118,6536,103113,6537,103117,6538,103116,6539,103120,6540,103115,6541,103119,6542,103121,6543,103122,6544,103123,6545,103125,6546,103124,6547,103126,6548,103127,6549,103129,6550,103128,6551,103130,6552,103131,6553,103133,6554,103132,6555,103134,6556,102969,6557,102970,6558,103135,6559,103137,6560,103136,6561,103138,6562,103139,6563,103140,6564,103141,6565,103142,6566,103200,6567,103143,6568,103144,6569,103145,6570,103146,6571,103147,6572,103149,6573,103148,6574,103150,6575,103151,6576,103152,6577,103155,6578,103160,6579,102971,6580,102972,6581,103153,6582,103158,6583,103154,6584,103159,6585,103157,6586,103162,6587,103156,6588,103161,6589,103172,6590,103173,6592,103174,6593,103176,6594,103175,6595,103177,6596,103178,6597,103180,6598,103179,6599,103181,6600,103182,6601,103184,6602,103183,6603,103185,6605,103190,6606,103186,6607,103189,6608,103188,6609,103191,6610,102973,6611,103192,6612,103196,6613,103193,6614,103197,6615,103195,6616,103199,6617,103194,6618,103198,6619,103164,6620,103163,6621,103165,6625,103170,6626,103169,6627,103171,6628,102520,6629,102521,6630,102522,6631,102523,6632,102524,6633,102527,6634,102493,6635,102494,6636,102496,6637,102495,6668,104020,6669,102610,6670,102611,6671,102612,6672,102613,6673,102614,6674,102615,6675,102616,6676,102617,6677,102618,6678,102619,6679,102620,6680,102621,6681,102622,6682,102623,6683,102624,6684,102625,6685,102626,6686,102627,6687,102628,6688,102593,6689,102594,6690,102595,6691,102596,6692,102597,6783,104223,6784,102530,6785,102500,6788,102532,6789,102502,6792,102533,6793,102503,6796,102531,6797,102501,6800,102534,6801,102504,6804,102535,6805,102505,6808,102536,6809,102506,6812,102537,6813,102507,6816,102538,6817,102508,6820,102539,6821,102509,6824,102540,6825,102510,6828,102541,6829,102511,6832,102542,6833,102512,6836,102543,6837,102513,6840,102544,6841,102514,6844,102546,6845,102516,6848,102545,6849,102515,6852,102547,6853,102517,6856,102548,6857,102518,6860,102549,6861,102519,6867,102380,6868,102381,6879,103187,6880,103096,6884,102376,6885,102378,6886,102377,6887,102379,7136,6980,7139,6987,7142,102706,7692,102557,7693,102558,7694,102559,7695,102560,7696,102561,8090,103318,8091,103418,8092,103317,8093,103417,8095,103371,8096,103471,8097,103369,8098,103469,8099,103368,8100,103468,8101,103367,8102,103467,8103,103366,8104,103466,8105,103365,8106,103465,8107,103364,8108,103464,8109,103363,8110,103463,8111,103362,8112,103462,8113,103361,8114,103461,8115,103360,8116,103460,8117,103359,8118,103459,8119,103357,8120,103457,8121,103356,8122,103456,8123,103355,8124,103455,8125,103354,8126,103454,8127,103353,8128,103453,8129,103352,8130,103452,8131,103350,8132,103450,8133,103349,8134,103449,8135,103348,8136,103448,8139,103343,8140,103443,8141,103342,8142,103442,8143,103341,8144,103441,8145,103339,8146,103439,8147,103337,8148,103437,8149,103336,8150,103436,8151,103334,8152,103434,8153,103333,8154,103433,8155,103331,8156,103431,8161,103326,8162,103426,8163,103325,8164,103425,8165,103324,8166,103424,8171,103321,8172,103421,8173,103320,8177,103420,8179,103316,8180,103416,8181,103315,8182,103415,8184,103314,8185,103414,8191,103312,8193,103412,8196,103311,8197,103411,8198,103310,8200,103410,8201,103309,8202,103409,8203,103308,8204,103408,8207,103306,8208,103406,8209,103305,8210,103405,8212,103304,8213,103404,8214,103303,8216,103403,8218,103302,8220,103402,8222,103301,8224,103401,8431,104248,8441,102590,8693,102449,8826,102605,8857,54035,8858,54036,8859,54037,8860,8449,8988,104115,8989,104116,8990,104117,8991,104118,8992,104119,8993,104120,8994,104121,8995,104122,8996,104123,8997,104124,8998,104896,8999,104257,9e3,104019,9014,104010,9019,104021,9053,104011,9054,104012,9055,104013,9056,104014,9057,104015,9059,104258,9060,104179,9061,104180,9062,104181,9063,104182,9064,104183,9065,104184,9066,104185,9067,104186,21896,21891,21897,21892,21898,21893,21899,21894,26701,102124,26702,102125,26799,26747,26847,102683,26848,102684,26849,102691,26850,102692,26851,102693,26852,102704,26853,102750,26854,102751,26857,102466,26858,102467,26859,102468,26901,102128,26902,102129,27493,27492,29101,29100,29168,29118,29169,29119,29170,29120,29171,29121,29172,29122,29187,29177,29188,29178,29189,29179,29190,29180,29191,29181,29192,29182,29193,29183,29194,29184,29195,29185,29902,29900,31279,31278,31281,31291,31282,31292,31283,31293,31284,31294,31285,31295,31286,31296,31287,31297,31466,31462,31467,31463,31468,31464,31469,31465,31986,31917,31987,31918,31988,31919,31989,31920,31990,31921,31991,31922,32064,32074,32065,32075,32066,32076,32067,32077,102550,2181,102551,2182,102552,2183,102553,2184,102554,2185,102555,2186,102556,2187],pcsid:[2066,15,2136,12,2155,10,2157,5,2158,5,2159,12,2160,12,2219,5,2220,5,2244,10,2245,10,2256,11,2265,11,2266,11,2269,11,2270,11,2273,11,2290,5,2291,5,2294,5,2295,5,2313,5,2314,14,2899,10,2900,10,2901,11,2909,11,2910,11,2911,10,2912,10,2913,11,2914,11,2964,10,2967,10,2968,10,2991,5,2992,11,2993,5,2994,11,3073,5,3076,5,3079,5,3091,10,3106,5,3108,5,3109,5,3141,5,3142,5,3167,4,3337,5,3347,5,3348,5,3359,10,3360,5,3361,11,3362,5,3363,10,3364,5,3365,10,3366,14,3402,5,3403,5,3405,5,3406,5,3439,5,3440,5,3447,5,3449,5,3450,5,3453,10,3454,10,3460,5,3479,11,3480,5,3481,11,3482,5,3483,11,3484,5,3485,10,3486,5,3487,10,3488,5,3489,5,3490,10,3491,5,3492,10,3493,5,3494,10,3495,5,3496,10,3497,5,3498,10,3499,5,3500,10,3501,5,3502,10,3503,5,3504,10,3505,5,3506,10,3507,5,3508,10,3509,5,3510,10,3511,5,3512,10,3513,5,3514,5,3515,10,3516,5,3517,10,3518,5,3519,10,3520,5,3521,10,3522,5,3523,10,3524,5,3525,10,3526,5,3527,10,3528,5,3529,10,3530,5,3531,10,3532,5,3533,10,3534,5,3535,10,3536,5,3537,10,3538,5,3539,10,3540,5,3541,10,3542,5,3543,10,3544,5,3545,10,3546,5,3547,10,3548,5,3549,10,3550,5,3551,10,3552,5,3553,10,3582,10,3583,5,3584,10,3585,5,3586,10,3587,5,3588,11,3589,5,3590,11,3591,5,3592,5,3593,11,3598,10,3599,5,3600,10,3605,11,3606,5,3607,5,3608,10,3609,5,3610,10,3611,5,3612,10,3613,5,3614,10,3615,5,3616,10,3617,5,3618,10,3619,5,3620,10,3621,5,3622,10,3623,5,3624,10,3625,5,3626,10,3627,5,3628,10,3629,5,3630,10,3631,5,3632,10,3633,5,3634,11,3635,5,3636,11,3640,10,3641,5,3642,10,3643,5,3644,11,3645,5,3646,11,3647,5,3648,11,3649,5,3650,10,3651,5,3652,10,3653,5,3654,10,3655,5,3656,11,3657,5,3658,10,3659,5,3660,10,3661,5,3662,10,3663,5,3664,10,3668,10,3669,5,3670,10,3671,5,3672,10,3673,5,3674,10,3675,5,3676,11,3677,10,3678,5,3679,11,3680,10,3681,5,3682,11,3683,10,3684,5,3685,5,3686,10,3687,5,3688,10,3689,5,3690,10,3691,5,3692,10,3696,10,3697,5,3698,10,3699,5,3700,10,3740,5,3749,5,3783,5,3784,5,3793,5,3794,5,3802,5,3816,5,3829,5,3854,5,3911,5,3912,5,3920,5,3978,5,3979,5,3991,10,3992,10,4026,5,4037,5,4038,5,4087,5,4088,5,4217,10,4438,10,4439,10,4467,5,4471,5,4474,5,4559,5,4822,5,4839,5,5018,5,5048,5,5167,5,5168,5,5223,5,5234,5,5235,5,5243,5,5266,5,5316,5,5320,5,5321,5,5330,5,5331,5,5337,5,5361,5,5362,5,5382,5,5383,5,5396,5,5456,5,5457,5,5469,5,5472,9,5490,5,5518,5,5523,5,5559,5,5588,11,5589,14,5596,5,5627,5,5629,5,5641,5,5643,5,5644,5,5654,10,5655,10,5659,5,5700,5,5825,5,5836,5,5837,5,5842,5,5844,5,5880,5,5887,5,5890,5,6128,11,6129,11,6141,11,6204,5,6210,5,6211,5,6307,5,6312,5,6316,5,6362,5,6591,5,6646,5,6703,5,6786,5,6787,11,6790,5,6791,11,6794,5,6795,11,6798,5,6799,11,6802,5,6803,11,6806,5,6807,11,6810,5,6811,11,6814,5,6815,11,6818,5,6819,11,6822,5,6823,11,6826,5,6827,11,6830,5,6831,11,6834,5,6835,11,6838,5,6839,11,6842,5,6843,11,6846,5,6847,11,6850,5,6851,11,6854,5,6855,11,6858,5,6859,11,6862,5,6863,11,6870,5,6875,5,6876,5,6915,5,6922,5,6923,10,6924,5,6925,10,6962,5,6984,5,6991,5,7128,10,7131,5,7132,10,7257,5,7258,10,7259,5,7260,10,7261,5,7262,10,7263,5,7264,10,7265,5,7266,10,7267,5,7268,10,7269,5,7270,10,7271,5,7272,10,7273,5,7274,10,7275,5,7276,10,7277,5,7278,10,7279,5,7280,10,7281,5,7282,10,7283,5,7284,10,7285,5,7286,10,7287,5,7288,10,7289,5,7290,10,7291,5,7292,10,7293,5,7294,10,7295,5,7296,10,7297,5,7298,10,7299,5,7300,10,7301,5,7302,10,7303,5,7304,10,7305,5,7306,10,7307,5,7308,10,7309,5,7310,10,7311,5,7312,10,7313,5,7314,10,7315,5,7316,10,7317,5,7318,10,7319,5,7320,10,7321,5,7322,10,7323,5,7324,10,7325,5,7326,10,7327,5,7328,10,7329,5,7330,10,7331,5,7332,10,7333,5,7334,10,7335,5,7336,10,7337,5,7338,10,7339,5,7340,10,7341,5,7342,10,7343,5,7344,10,7345,5,7346,10,7347,5,7348,10,7349,5,7350,10,7351,5,7352,10,7353,5,7354,10,7355,5,7356,10,7357,5,7358,10,7359,5,7360,10,7361,5,7362,10,7363,5,7364,10,7365,5,7366,10,7367,5,7368,10,7369,5,7370,10,7877,5,7878,5,7882,5,7883,5,7887,5,7899,5,7991,5,7992,5,8035,10,8036,10,8058,5,8059,5,8082,5,8083,5,8088,5,8137,5,8138,10,8157,5,8158,10,8159,5,8160,10,8167,5,8168,10,8169,5,8170,10,8187,5,8189,10,8205,5,8206,10,8225,5,8226,10,8311,5,8312,11,8313,5,8314,11,8315,5,8316,11,8317,5,8318,11,8319,5,8320,11,8321,5,8322,11,8323,5,8324,11,8325,5,8326,11,8327,5,8328,11,8329,5,8330,11,8331,5,8332,11,8333,5,8334,11,8335,5,8336,11,8337,5,8338,11,8339,5,8340,11,8341,5,8342,11,8343,5,8344,11,8345,5,8346,11,8347,5,8348,11,8352,5,8353,5,8379,5,8380,10,8381,5,8382,10,8383,5,8384,10,8385,5,8387,10,8391,5,8395,5,8433,5,8455,5,8456,5,8531,10,8682,5,8687,5,8692,5,8903,5,8950,5,8951,5,9039,5,9040,5,9141,5,9149,5,9150,5,9191,5,9221,5,9222,5,20499,5,20538,5,20539,5,20790,5,20791,5,21291,5,21292,5,21500,5,21817,5,21818,5,22032,5,22033,5,22091,5,22092,5,22332,5,22391,5,22392,5,22700,5,22770,5,22780,5,22832,5,23090,5,23095,5,23239,5,23240,5,23433,5,23700,5,24047,5,24048,5,24100,14,24200,5,24305,5,24306,5,24382,6,24383,5,24500,5,24547,5,24548,5,24571,2,24600,5,25e3,5,25231,5,25884,5,25932,5,26237,5,26331,5,26332,5,26591,5,26592,5,26632,5,26692,5,26855,10,26856,10,27120,5,27200,5,27291,7,27292,7,27429,5,27492,5,27500,5,27700,5,28232,5,28600,5,28991,5,28992,5,29100,5,29220,5,29221,5,29333,5,29635,5,29636,5,29701,5,29738,5,29739,5,29849,5,29850,5,29871,3,29872,13,29873,5,29900,5,29901,5,29903,5,30200,15,30339,5,30340,5,30791,5,30792,5,31028,5,31121,5,31154,5,31170,5,31171,5,31370,5,31528,5,31529,5,31600,5,31700,5,31838,5,31839,5,31901,5,32061,5,32062,5,32098,5,32099,10,32100,5,32104,5,32161,5,32766,5,53048,5,53049,5,54090,5,54091,5,65061,10,65062,10,65161,5,65163,5,102041,10,102064,8,102068,1,102069,0,102118,10,102119,11,102120,10,102121,10,102217,10,102218,5,102219,10,102220,10,102378,11,102379,11,102380,5,102381,11,102498,5,102499,5,102589,10,102590,5,102599,10,102600,10,102604,10,102605,5,102606,5,102647,5,102704,10,102705,10,102706,5,102733,10,102761,10,102762,5,102763,10,102764,5,102765,5,102766,10,102962,5,102963,5,102970,11,102974,10,102993,5,102994,5,102995,10,102996,10,103015,5,103016,10,103017,5,103018,10,103025,5,103026,5,103027,10,103028,10,103035,5,103036,5,103037,10,103038,10,103039,5,103040,5,103041,10,103042,10,103043,5,103044,5,103045,10,103046,10,103047,5,103048,5,103049,10,103050,10,103051,5,103052,10,103053,5,103054,10,103055,5,103056,10,103057,5,103058,5,103059,10,103060,10,103061,5,103062,5,103063,10,103064,10,103069,10,103070,5,103071,5,103072,10,103073,10,103086,5,103087,5,103088,10,103089,10,103094,11,103095,5,103096,10,103103,5,103104,10,103105,5,103106,10,103121,5,103122,10,103123,5,103124,5,103125,11,103126,11,103127,5,103128,5,103129,10,103130,10,103131,5,103132,5,103133,10,103134,10,103135,5,103136,5,103137,11,103138,11,103139,5,103140,10,103141,5,103142,10,103143,5,103144,10,103145,5,103146,11,103147,5,103148,5,103149,10,103150,10,103151,5,103152,10,103172,5,103173,10,103174,5,103175,5,103176,10,103177,10,103178,5,103179,5,103180,10,103181,10,103182,5,103183,5,103184,10,103185,10,103228,5,103229,5,103230,10,103231,10,103250,5,103251,10,103252,5,103253,10,103260,5,103261,5,103262,10,103263,10,103270,5,103271,5,103272,10,103273,10,103274,5,103275,5,103276,10,103277,10,103278,5,103279,5,103280,10,103281,10,103282,5,103283,5,103284,10,103285,10,103286,5,103287,10,103288,5,103289,10,103290,5,103291,10,103292,5,103293,5,103294,10,103295,10,103296,5,103297,5,103298,10,103299,10,103376,10,103377,5,103378,5,103379,10,103380,10,103393,5,103394,5,103395,10,103396,10,103472,5,103473,11,103474,5,103475,10,103482,5,103483,10,103484,5,103485,10,103500,5,103501,10,103502,5,103503,5,103504,11,103505,11,103506,5,103507,5,103508,10,103509,10,103510,5,103511,5,103512,10,103513,10,103514,5,103515,10,103516,5,103517,10,103518,5,103519,10,103520,5,103521,11,103522,5,103523,5,103524,10,103525,10,103526,5,103527,10,103561,10,103562,10,103563,5,103564,5,103565,10,103566,10,103567,5,103568,5,103569,10,103570,10,103585,10,103586,5,103587,10,103588,11,103589,5,103590,10,103591,11,103592,5,103593,10,103594,11,103695,10,103846,5,103946,10],pcsidc:[[2e3,2045,5],[2056,2065,5],[2067,2135,5],[2137,2153,5],[2161,2170,5],[2172,2193,5],[2196,2198,5],[2200,2203,5],[2206,2217,5],[2222,2224,11],[2251,2253,11],[2280,2282,11],[2308,2311,5],[2315,2325,5],[2327,2394,5],[2400,2491,5],[2494,2758,5],[2867,2869,11],[2870,2888,10],[2891,2895,10],[2896,2898,11],[2902,2908,10],[2915,2920,10],[2921,2923,11],[2924,2930,10],[2931,2941,5],[2969,2973,5],[2975,2982,5],[2984,2988,5],[2995,3002,5],[3006,3051,5],[3054,3059,5],[3061,3066,5],[3068,3071,5],[3084,3087,5],[3112,3118,5],[3120,3138,5],[3146,3151,5],[3153,3157,5],[3161,3166,5],[3168,3172,5],[3174,3203,5],[3294,3313,5],[3315,3335,5],[3339,3345,5],[3350,3358,5],[3367,3369,5],[3374,3388,5],[3391,3399,5],[3408,3416,5],[3425,3432,10],[3441,3446,10],[3456,3459,10],[3465,3478,5],[3554,3559,5],[3561,3565,10],[3568,3570,10],[3571,3581,5],[3594,3597,5],[3601,3604,5],[3637,3639,5],[3665,3667,5],[3693,3695,5],[3701,3727,5],[3728,3733,10],[3744,3747,5],[3753,3758,10],[3761,3763,5],[3765,3769,5],[3779,3781,5],[3788,3791,5],[3797,3799,5],[3832,3841,5],[3844,3852,5],[3873,3885,5],[3890,3893,5],[3942,3950,5],[3968,3970,5],[3973,3976,5],[3986,3989,5],[3994,3997,5],[4390,4398,5],[4399,4413,10],[4418,4433,10],[4491,4554,5],[4568,4589,5],[4652,4656,5],[4766,4800,5],[5069,5072,5],[5105,5130,5],[5180,5184,5],[5253,5259,5],[5269,5275,5],[5292,5311,5],[5343,5349,5],[5355,5357,5],[5387,5389,5],[5459,5463,5],[5479,5482,5],[5530,5539,5],[5550,5552,5],[5562,5583,5],[5623,5625,10],[5631,5639,5],[5649,5653,5],[5663,5680,5],[5682,5685,5],[5875,5877,5],[5896,5899,5],[5921,5940,5],[6050,6125,5],[6351,6354,5],[6366,6372,5],[6381,6387,5],[6622,6624,5],[6707,6709,5],[6720,6723,5],[6732,6738,5],[6931,6933,5],[7005,7007,5],[7057,7070,10],[7074,7082,5],[7109,7118,5],[7119,7127,11],[7374,7376,5],[7528,7586,5],[7587,7645,10],[7755,7787,5],[7791,7795,5],[7799,7801,5],[7803,7805,5],[7825,7831,5],[7845,7859,5],[8013,8032,5],[8065,8068,11],[8518,8529,10],[8533,8536,10],[8538,8540,10],[8677,8679,5],[8836,8840,5],[8908,8910,5],[9154,9159,5],[9205,9218,5],[20002,20032,5],[20062,20092,5],[20135,20138,5],[20248,20258,5],[20348,20358,5],[20436,20440,5],[20822,20824,5],[20934,20936,5],[21035,21037,5],[21095,21097,5],[21148,21150,5],[21413,21423,5],[21473,21483,5],[21780,21782,5],[21891,21894,5],[22171,22177,5],[22181,22187,5],[22191,22197,5],[22234,22236,5],[22521,22525,5],[22991,22994,5],[23028,23038,5],[23830,23853,5],[23866,23872,5],[23877,23884,5],[23886,23894,5],[23946,23948,5],[24311,24313,5],[24342,24347,5],[24370,24374,6],[24375,24381,5],[24718,24721,5],[24817,24821,5],[24877,24882,5],[24891,24893,5],[25391,25395,5],[25828,25838,5],[26191,26195,5],[26391,26393,5],[26703,26722,5],[26729,26760,10],[26766,26798,10],[26860,26870,10],[26891,26899,5],[26903,26923,5],[26929,26946,5],[26948,26998,5],[27037,27040,5],[27205,27232,5],[27258,27260,5],[27391,27398,5],[27561,27564,5],[27571,27574,5],[27581,27584,5],[27591,27594,5],[28191,28193,5],[28348,28358,5],[28402,28432,5],[28462,28492,5],[29118,29122,5],[29177,29185,5],[30161,30179,5],[30491,30494,5],[30729,30732,5],[31251,31259,5],[31265,31268,5],[31275,31278,5],[31288,31297,5],[31461,31465,5],[31491,31495,5],[31917,31922,5],[31965,31985,5],[31992,32e3,5],[32001,32003,10],[32005,32031,10],[32033,32060,10],[32074,32077,10],[32081,32086,5],[32107,32130,5],[32133,32158,5],[32164,32167,10],[32180,32199,5],[32201,32260,5],[32301,32360,5],[32601,32662,5],[32664,32667,10],[32701,32761,5],[53001,53004,5],[53008,53019,5],[53021,53032,5],[53034,53037,5],[53042,53046,5],[53074,53080,5],[54001,54004,5],[54008,54019,5],[54021,54032,5],[54034,54037,5],[54042,54046,5],[54048,54053,5],[54074,54080,5],[54098,54101,5],[102001,102040,5],[102042,102063,5],[102065,102067,5],[102070,102112,5],[102114,102117,5],[102122,102208,5],[102210,102216,5],[102221,102300,5],[102304,102377,5],[102382,102388,5],[102389,102398,10],[102399,102444,5],[102445,102447,10],[102448,102458,5],[102459,102468,10],[102469,102496,5],[102500,102519,11],[102520,102524,5],[102525,102529,10],[102530,102549,5],[102557,102588,5],[102593,102598,5],[102601,102603,5],[102608,102628,5],[102629,102646,10],[102648,102672,10],[102675,102700,10],[102701,102703,5],[102707,102730,10],[102735,102758,10],[102767,102900,5],[102965,102969,5],[102971,102973,5],[102975,102989,5],[102990,102992,11],[102997,103002,5],[103003,103008,10],[103009,103011,5],[103012,103014,10],[103019,103021,5],[103022,103024,10],[103029,103031,5],[103032,103034,10],[103065,103068,5],[103074,103076,5],[103077,103079,11],[103080,103082,5],[103083,103085,10],[103090,103093,5],[103097,103099,5],[103100,103102,10],[103107,103109,5],[103110,103112,10],[103113,103116,5],[103117,103120,10],[103153,103157,5],[103158,103162,10],[103163,103165,5],[103166,103168,11],[103169,103171,10],[103186,103188,5],[103189,103191,10],[103192,103195,5],[103196,103199,10],[103200,103224,5],[103225,103227,11],[103232,103237,5],[103238,103243,10],[103244,103246,5],[103247,103249,10],[103254,103256,5],[103257,103259,10],[103264,103266,5],[103267,103269,10],[103300,103375,5],[103381,103383,5],[103384,103386,11],[103387,103389,5],[103390,103392,10],[103397,103399,5],[103400,103471,10],[103476,103478,5],[103479,103481,10],[103486,103488,5],[103489,103491,10],[103492,103495,5],[103496,103499,10],[103539,103543,5],[103544,103548,10],[103549,103551,5],[103552,103554,11],[103555,103557,10],[103558,103560,5],[103571,103573,5],[103574,103576,10],[103577,103580,5],[103581,103583,10],[103595,103597,5],[103600,103694,5],[103696,103698,5],[103700,103793,10],[103794,103799,5]],gcsid:[4001,81,4002,85,4003,70,4004,84,4005,82,4006,83,4007,60,4008,67,4009,39,4010,57,4011,63,4012,64,4013,64,4014,63,4015,92,4016,90,4018,86,4019,75,4020,68,4021,70,4022,55,4023,75,4024,66,4025,73,4027,95,4028,59,4029,58,4031,75,4032,78,4033,77,4034,65,4035,100,4036,70,4042,88,4044,87,4045,89,4046,75,4047,99,4052,101,4053,97,4054,61,4075,75,4081,75,4120,84,4121,75,4122,80,4123,55,4124,84,4126,75,4130,75,4131,92,4132,64,4133,75,4134,64,4140,75,4141,75,4142,64,4143,64,4144,92,4145,87,4146,89,4147,66,4148,75,4149,84,4150,84,4151,75,4152,75,4153,55,4154,55,4155,63,4156,84,4157,60,4162,84,4163,75,4164,66,4165,55,4166,75,4168,58,4170,75,4172,75,4173,75,4174,58,4175,64,4176,75,4178,66,4179,66,4180,75,4188,81,4190,75,4191,66,4192,55,4193,63,4198,64,4199,55,4200,66,4201,64,4202,70,4203,70,4204,55,4205,66,4206,63,4207,55,4208,55,4209,64,4210,64,4211,84,4212,64,4213,63,4214,66,4215,55,4216,67,4218,55,4219,84,4220,64,4221,55,4222,64,4224,55,4225,55,4229,68,4230,55,4231,55,4232,64,4234,64,4235,55,4236,55,4237,70,4238,70,4239,92,4240,92,4241,65,4242,67,4243,88,4244,92,4245,86,4246,64,4250,64,4251,64,4252,63,4253,67,4254,55,4255,55,4256,64,4257,84,4258,75,4259,55,4260,64,4261,106,4262,84,4263,64,4265,55,4266,63,4267,67,4269,75,4270,64,4271,55,4272,55,4273,82,4274,55,4275,63,4276,73,4280,84,4281,57,4282,63,4283,75,4284,66,4285,55,4286,68,4288,55,4289,84,4291,70,4292,55,4293,83,4294,84,4295,84,4296,63,4297,55,4298,90,4299,85,4300,85,4301,84,4302,60,4303,68,4306,84,4307,64,4308,84,4309,55,4310,63,4311,55,4312,84,4313,55,4314,84,4315,63,4316,55,4317,66,4318,75,4319,75,4322,80,4324,80,4326,75,4466,75,4469,75,4475,55,4483,75,4490,75,4555,66,4558,75,4608,67,4609,67,4610,74,4614,55,4619,75,4624,75,4625,55,4627,75,4636,55,4637,55,4638,67,4639,55,4657,93,4659,75,4660,55,4661,75,4666,84,4667,75,4670,75,4671,63,4674,75,4679,64,4680,64,4682,92,4683,67,4686,75,4687,75,4693,75,4694,75,4695,67,4696,64,4697,64,4702,75,4703,64,4704,55,4705,55,4706,68,4718,55,4720,80,4721,55,4723,67,4726,67,4737,75,4738,60,4740,79,4741,55,4742,75,4743,64,4744,64,4745,84,4746,84,4747,75,4748,56,4749,75,4750,75,4751,91,4752,56,4753,55,4754,55,4759,75,4761,75,4801,84,4802,55,4803,55,4804,84,4805,84,4806,55,4807,106,4808,84,4809,55,4810,105,4811,106,4816,106,4817,82,4818,84,4820,84,4821,106,4823,55,4824,55,4901,107,4902,107,4903,59,4904,84,5228,84,5229,84,5233,92,5252,75,5264,75,5340,75,5354,75,5360,75,5371,75,5373,75,5381,75,5393,75,5464,60,5467,67,5489,75,5524,55,5527,70,5546,75,5561,66,5593,75,5681,84,5886,75,6135,75,6365,75,6706,75,6881,64,6882,64,6883,55,6892,64,6894,64,6980,75,6983,75,6987,75,6990,75,7035,75,7037,75,7039,75,7041,75,7073,75,7084,75,7086,75,7133,75,7373,75,7683,76,7798,75,7844,75,7881,75,7886,75,8042,96,8043,96,8086,75,8232,75,8237,75,8240,75,8246,75,8249,75,8252,75,8255,75,8351,84,8427,75,8428,55,8449,75,8545,75,8685,75,8694,64,8699,75,8818,75,8888,75,8900,75,8902,75,8907,75,8949,75,9003,75,9006,75,9009,75,9012,75,9017,75,9068,75,9069,75,9140,75,9148,75,9153,75,37001,73,37002,69,37003,72,37004,71,37005,62,37006,91,37007,94,37008,101,37201,55,37202,92,37203,87,37204,55,37205,55,37206,64,37207,71,37208,64,37211,64,37220,67,37221,55,37222,55,37223,63,37224,55,37225,106,37226,55,37227,55,37228,64,37229,62,37230,55,37231,70,37232,55,37233,55,37235,55,37237,55,37238,55,37239,67,37240,64,37241,55,37242,55,37243,67,37252,67,37253,55,37254,64,37255,84,37257,66,37259,55,37260,67,104017,79,104018,79,104024,75,104027,75,104047,98,104050,75,104100,75,104101,84,104102,84,104103,64,104104,55,104105,84,104106,55,104107,75,104108,75,104109,67,104110,75,104111,75,104112,67,104113,67,104128,102,104129,75,104130,55,104131,84,104132,67,104133,75,104134,75,104135,66,104136,70,104137,75,104138,55,104139,106,104140,106,104223,75,104248,55,104256,92,104261,63,104286,75,104287,75,104304,63,104700,49,104701,9,104702,24,104703,15,104704,28,104705,32,104706,53,104707,46,104708,37,104709,54,104710,11,104711,14,104712,30,104713,52,104714,4,104715,4,104716,23,104717,14,104718,48,104719,29,104720,22,104721,21,104722,35,104723,21,104724,46,104725,22,104726,49,104727,45,104728,52,104729,10,104730,10,104731,21,104732,31,104733,26,104734,40,104735,19,104736,30,104737,34,104738,27,104739,46,104740,5,104741,12,104742,50,104743,9,104744,43,104745,21,104746,26,104747,25,104748,21,104749,7,104750,53,104751,6,104752,33,104753,29,104754,19,104755,41,104756,31,104757,3,104758,41,104759,25,104760,49,104761,41,104762,44,104763,50,104764,46,104765,6,104766,40,104767,16,104768,8,104769,17,104770,48,104771,42,104772,50,104773,25,104774,29,104775,25,104776,32,104777,13,104778,36,104779,47,104780,14,104781,29,104782,23,104783,38,104784,42,104785,18,104786,20,104808,51,104896,75,104900,112,104901,104,104902,103,104903,116,104904,109,104905,108,104906,169,104907,164,104908,0,104909,168,104910,141,104911,166,104912,114,104913,160,104914,151,104915,117,104916,110,104917,140,104918,115,104919,170,104920,163,104921,154,104922,158,104923,161,104924,148,104925,0,104926,159,104927,167,104928,127,104929,131,104930,145,104931,159,104932,136,104933,123,104934,139,104935,134,104936,166,104937,150,104938,137,104939,147,104940,121,104941,165,104942,128,104943,111,104944,1,104945,126,104946,152,104947,157,104948,162,104949,153,104950,156,104951,149,104952,132,104953,122,104954,160,104955,146,104956,143,104957,156,104958,120,104959,125,104960,2,104961,144,104962,142,104963,138,104964,155,104965,135,104966,133,104967,151,104968,118,104969,119,104970,124,104971,108,104972,129,104973,130,104974,113,104975,0,104990,84,104991,75,104992,84],gcsidc:[[4127,4129,67],[4135,4139,67],[4158,4161,55],[4181,4185,55],[4194,4196,55],[4226,4228,63],[4247,4249,55],[4277,4279,81],[4600,4607,64],[4621,4623,55],[4628,4633,55],[4641,4646,55],[4662,4665,55],[4676,4678,66],[4688,4692,55],[4699,4701,64],[4755,4757,75],[4763,4765,75],[4813,4815,84],[8972,8987,75],[37212,37219,55],[37245,37247,55],[37249,37251,55],[104009,104015,75],[104019,104022,75],[104114,104124,75],[104125,104127,55],[104141,104145,75],[104179,104186,75],[104257,104260,75]]},S={c:[[2e3,2035,9001],[2039,2045,9001],[2056,2062,9001],[2067,2090,9001],[2093,2135,9001],[2161,2165,9001],[2172,2180,9001],[2188,2193,9001],[2195,2198,9001],[2200,2203,9001],[2205,2213,9001],[2215,2217,9001],[2222,2224,9002],[2225,2243,9003],[2246,2250,9003],[2251,2253,9002],[2257,2264,9003],[2274,2279,9003],[2280,2282,9002],[2283,2289,9003],[2308,2313,9001],[2315,2491,9001],[2494,2576,9001],[2578,2599,9001],[2601,2693,9001],[2695,2866,9001],[2867,2869,9002],[2870,2888,9003],[2891,2895,9003],[2896,2898,9002],[2902,2908,9003],[2915,2920,9003],[2921,2923,9002],[2924,2930,9003],[2931,2933,9001],[2935,2962,9001],[2964,2968,9003],[2969,2973,9001],[2975,2978,9001],[2984,2988,9001],[2995,3051,9001],[3054,3072,9001],[3077,3079,9001],[3081,3088,9001],[3092,3101,9001],[3106,3138,9001],[3146,3151,9001],[3153,3166,9001],[3168,3172,9001],[3174,3203,9001],[3294,3313,9001],[3315,3348,9001],[3350,3358,9001],[3367,3403,9001],[3408,3416,9001],[3417,3438,9003],[3441,3446,9003],[3447,3450,9001],[3451,3453,9003],[3455,3459,9003],[3460,3478,9001],[3554,3559,9001],[3560,3570,9003],[3571,3581,9001],[3594,3597,9001],[3601,3604,9001],[3637,3639,9001],[3665,3667,9001],[3693,3695,9001],[3701,3727,9001],[3728,3739,9003],[3740,3751,9001],[3753,3760,9003],[3761,3773,9001],[3775,3777,9001],[3779,3781,9001],[3788,3791,9001],[3797,3802,9001],[3814,3816,9001],[3825,3829,9001],[3832,3841,9001],[3844,3852,9001],[3873,3885,9001],[3890,3893,9001],[3942,3950,9001],[3968,3970,9001],[3973,3976,9001],[3986,3989,9001],[3994,3997,9001],[4001,4016,9102],[4018,4025,9102],[4027,4029,9102],[4031,4036,9102],[4044,4047,9102],[4048,4051,9001],[4052,4054,9102],[4056,4063,9001],[4093,4096,9001],[4120,4124,9102],[4127,4139,9102],[4141,4176,9102],[4178,4185,9102],[4188,4216,9102],[4218,4232,9102],[4235,4260,9102],[4265,4267,9102],[4269,4286,9102],[4292,4304,9102],[4306,4319,9102],[4390,4398,9001],[4399,4413,9003],[4418,4433,9003],[4455,4457,9003],[4484,4489,9001],[4491,4554,9001],[4568,4589,9001],[4600,4630,9102],[4636,4639,9102],[4641,4646,9102],[4652,4656,9001],[4657,4680,9102],[4682,4684,9102],[4686,4765,9102],[4766,4800,9001],[4801,4806,9102],[4813,4815,9102],[5014,5016,9001],[5069,5072,9001],[5105,5130,9001],[5173,5188,9001],[5253,5259,9001],[5269,5275,9001],[5292,5311,9001],[5329,5331,9001],[5343,5349,9001],[5355,5357,9001],[5459,5463,9001],[5479,5482,9001],[5518,5520,9001],[5533,5539,9001],[5550,5552,9001],[5562,5583,9001],[5623,5625,9003],[5631,5639,9001],[5649,5653,9001],[5663,5680,9001],[5682,5685,9001],[5875,5877,9001],[5896,5899,9001],[5921,5940,9001],[6050,6125,9001],[6244,6275,9001],[6328,6348,9001],[6350,6356,9001],[6366,6372,9001],[6381,6387,9001],[6393,6404,9001],[6480,6483,9001],[6511,6514,9001],[6579,6581,9001],[6619,6624,9001],[6625,6627,9003],[6628,6632,9001],[6634,6637,9001],[6669,6692,9001],[6707,6709,9001],[6720,6723,9001],[6732,6738,9001],[6881,6883,9102],[6931,6933,9001],[7005,7007,9001],[7057,7070,9003],[7074,7082,9001],[7109,7118,9001],[7119,7127,9002],[7374,7376,9001],[7528,7586,9001],[7587,7645,9003],[7692,7696,9001],[7755,7787,9001],[7791,7795,9001],[7799,7801,9001],[7803,7805,9001],[7825,7831,9001],[7845,7859,9001],[8013,8032,9001],[8065,8068,9002],[8518,8529,9003],[8533,8536,9003],[8538,8540,9003],[8677,8679,9001],[8836,8840,9001],[8857,8859,9001],[8908,8910,9001],[8972,9e3,9102],[9053,9057,9102],[9059,9069,9102],[9154,9159,9001],[9205,9218,9001],[20002,20032,9001],[20062,20092,9001],[20135,20138,9001],[20248,20258,9001],[20348,20358,9001],[20436,20440,9001],[20822,20824,9001],[20934,20936,9001],[21035,21037,9001],[21095,21097,9001],[21148,21150,9001],[21413,21423,9001],[21473,21483,9001],[21780,21782,9001],[21896,21899,9001],[22171,22177,9001],[22181,22187,9001],[22191,22197,9001],[22234,22236,9001],[22521,22525,9001],[22991,22994,9001],[23028,23038,9001],[23830,23853,9001],[23866,23872,9001],[23877,23884,9001],[23886,23894,9001],[23946,23948,9001],[24311,24313,9001],[24342,24347,9001],[24370,24374,9084],[24375,24381,9001],[24718,24721,9001],[24817,24821,9001],[24877,24882,9001],[24891,24893,9001],[25391,25395,9001],[25828,25838,9001],[26191,26195,9001],[26391,26393,9001],[26701,26722,9001],[26729,26746,9003],[26748,26760,9003],[26766,26799,9003],[26847,26870,9003],[26891,26899,9001],[26901,26923,9001],[26929,26946,9001],[26948,26978,9001],[26980,26998,9001],[27037,27040,9001],[27205,27232,9001],[27258,27260,9001],[27391,27398,9001],[27561,27564,9001],[27571,27574,9001],[27581,27584,9001],[27591,27594,9001],[28191,28193,9001],[28348,28358,9001],[28402,28432,9001],[28462,28492,9001],[29168,29172,9001],[29187,29195,9001],[29901,29903,9001],[30161,30179,9001],[30491,30494,9001],[30729,30732,9001],[31251,31259,9001],[31265,31268,9001],[31275,31277,9001],[31281,31290,9001],[31466,31469,9001],[31491,31495,9001],[31965,32e3,9001],[32001,32003,9003],[32005,32017,9003],[32019,32028,9003],[32033,32035,9003],[32037,32060,9003],[32064,32067,9003],[32081,32086,9001],[32107,32130,9001],[32133,32158,9001],[32164,32167,9003],[32180,32199,9001],[32201,32260,9001],[32301,32360,9001],[32601,32662,9001],[32664,32667,9003],[32701,32761,9001],[37002,37008,9102],[53001,53004,9001],[53008,53019,9001],[53021,53032,9001],[53034,53037,9001],[53042,53046,9001],[53074,53080,9001],[54001,54004,9001],[54008,54019,9001],[54021,54032,9001],[54042,54046,9001],[54048,54053,9001],[54074,54080,9001],[54098,54101,9001],[102001,102005,9001],[102007,102039,9001],[102042,102045,9001],[102060,102063,9001],[102070,102079,9001],[102096,102099,9001],[102101,102109,9001],[102114,102117,9001],[102132,102138,9001],[102141,102144,9001],[102156,102166,9001],[102173,102179,9001],[102191,102198,9001],[102221,102228,9001],[102231,102233,9001],[102237,102240,9001],[102364,102375,9001],[102389,102398,9003],[102399,102419,9001],[102421,102438,9001],[102445,102447,9003],[102450,102458,9001],[102459,102462,9003],[102470,102489,9001],[102550,102556,9001],[102562,102588,9001],[102629,102640,9003],[102648,102650,9003],[102688,102690,9003],[102696,102700,9003],[102701,102703,9001],[102799,102900,9001],[103166,103168,9002],[103220,103224,9001],[103225,103227,9002],[103232,103237,9001],[103238,103243,9003],[103244,103246,9001],[103247,103249,9003],[103254,103256,9001],[103257,103259,9003],[103264,103266,9001],[103267,103269,9003],[103327,103330,9001],[103344,103347,9001],[103372,103375,9001],[103381,103383,9001],[103384,103386,9002],[103387,103389,9001],[103390,103392,9003],[103397,103399,9001],[103427,103430,9003],[103444,103447,9003],[103476,103478,9001],[103479,103481,9003],[103486,103488,9001],[103489,103491,9003],[103492,103495,9001],[103496,103499,9003],[103539,103543,9001],[103544,103548,9003],[103549,103551,9001],[103552,103554,9002],[103555,103557,9003],[103558,103560,9001],[103571,103573,9001],[103574,103576,9003],[103577,103580,9001],[103581,103583,9003],[103595,103597,9001],[103600,103694,9001],[103696,103698,9001],[103700,103793,9003],[104101,104103,9102],[104126,104131,9102],[104259,104261,9102],[104700,104786,9102],[104900,104975,9102]],nc:[2065,9001,2066,9039,2136,9094,2137,9001,2138,9001,2154,9001,2157,9001,2158,9001,2159,9094,2160,9094,2169,9001,2170,9001,2204,9003,2219,9001,2220,9001,2254,9003,2255,9003,2256,9002,2265,9002,2266,9002,2267,9003,2268,9003,2269,9002,2270,9002,2271,9003,2272,9003,2273,9002,2290,9001,2294,9001,2295,9001,2314,9005,2899,9003,2900,9003,2901,9002,2909,9002,2910,9002,2911,9003,2912,9003,2913,9002,2914,9002,2980,9001,2981,9001,2991,9001,2992,9002,2993,9001,2994,9002,3074,9001,3075,9001,3080,9002,3089,9003,3090,9001,3091,9003,3102,9003,3141,9001,3142,9001,3167,9301,3360,9001,3361,9002,3362,9001,3363,9003,3364,9001,3365,9003,3404,9003,3405,9001,3406,9001,3407,9005,3439,9001,3440,9001,3479,9002,3480,9001,3481,9002,3482,9001,3483,9002,3484,9001,3485,9003,3486,9001,3487,9003,3488,9001,3489,9001,3490,9003,3491,9001,3492,9003,3493,9001,3494,9003,3495,9001,3496,9003,3497,9001,3498,9003,3499,9001,3500,9003,3501,9001,3502,9003,3503,9001,3504,9003,3505,9001,3506,9003,3507,9001,3508,9003,3509,9001,3510,9003,3511,9001,3512,9003,3513,9001,3514,9001,3515,9003,3516,9001,3517,9003,3518,9001,3519,9003,3520,9001,3521,9003,3522,9001,3523,9003,3524,9001,3525,9003,3526,9001,3527,9003,3528,9001,3529,9003,3530,9001,3531,9003,3532,9001,3533,9003,3534,9001,3535,9003,3536,9001,3537,9003,3538,9001,3539,9003,3540,9001,3541,9003,3542,9001,3543,9003,3544,9001,3545,9003,3546,9001,3547,9003,3548,9001,3549,9003,3550,9001,3551,9003,3552,9001,3553,9003,3582,9003,3583,9001,3584,9003,3585,9001,3586,9003,3587,9001,3588,9002,3589,9001,3590,9002,3591,9001,3592,9001,3593,9002,3598,9003,3599,9001,3600,9003,3605,9002,3606,9001,3607,9001,3608,9003,3609,9001,3610,9003,3611,9001,3612,9003,3613,9001,3614,9003,3615,9001,3616,9003,3617,9001,3618,9003,3619,9001,3620,9003,3621,9001,3622,9003,3623,9001,3624,9003,3625,9001,3626,9003,3627,9001,3628,9003,3629,9001,3630,9003,3631,9001,3632,9003,3633,9001,3634,9002,3635,9001,3636,9002,3640,9003,3641,9001,3642,9003,3643,9001,3644,9002,3645,9001,3646,9002,3647,9001,3648,9002,3649,9001,3650,9003,3651,9001,3652,9003,3653,9001,3654,9003,3655,9001,3656,9002,3657,9001,3658,9003,3659,9001,3660,9003,3661,9001,3662,9003,3663,9001,3664,9003,3668,9003,3669,9001,3670,9003,3671,9001,3672,9003,3673,9001,3674,9003,3675,9001,3676,9002,3677,9003,3678,9001,3679,9002,3680,9003,3681,9001,3682,9002,3683,9003,3684,9001,3685,9001,3686,9003,3687,9001,3688,9003,3689,9001,3690,9003,3691,9001,3692,9003,3696,9003,3697,9001,3698,9003,3699,9001,3700,9003,3783,9001,3784,9001,3793,9001,3794,9001,3812,9001,3819,9102,3821,9102,3824,9102,3854,9001,3857,9001,3889,9102,3906,9102,3911,9001,3912,9001,3920,9001,3978,9001,3979,9001,3991,9003,3992,9003,4026,9001,4037,9001,4038,9001,4042,9102,4071,9001,4075,9102,4081,9102,4082,9001,4083,9001,4087,9001,4088,9001,4217,9003,4261,9105,4262,9102,4263,9102,4288,9102,4289,9102,4322,9102,4324,9102,4326,9102,4414,9001,4415,9001,4417,9001,4434,9001,4437,9001,4438,9003,4439,9003,4462,9001,4463,9102,4467,9001,4470,9102,4471,9001,4475,9102,4483,9102,4490,9102,4555,9102,4558,9102,4559,9001,4632,9102,4633,9102,4647,9001,4807,9105,4808,9102,4809,9102,4810,9105,4811,9105,4816,9105,4817,9102,4818,9102,4820,9102,4821,9105,4822,9001,4823,9102,4824,9102,4826,9001,4839,9001,4901,9105,4902,9105,4903,9102,4904,9102,5013,9102,5018,9001,5048,9001,5167,9001,5168,9001,5221,9001,5223,9001,5228,9102,5229,9102,5233,9102,5234,9001,5235,9001,5243,9001,5246,9102,5247,9001,5252,9102,5264,9102,5266,9001,5316,9001,5320,9001,5321,9001,5324,9102,5325,9001,5337,9001,5340,9102,5354,9102,5360,9102,5361,9001,5362,9001,5365,9102,5367,9001,5371,9102,5373,9102,5381,9102,5382,9001,5383,9001,5387,9001,5389,9001,5393,9102,5396,9001,5451,9102,5456,9001,5457,9001,5464,9102,5467,9102,5469,9001,5472,9037,5489,9102,5490,9001,5513,9001,5514,9001,5523,9001,5524,9102,5527,9102,5530,9001,5531,9001,5546,9102,5559,9001,5561,9102,5588,9002,5589,9005,5593,9102,5596,9001,5627,9001,5629,9001,5641,9001,5643,9001,5644,9001,5646,9003,5654,9003,5655,9003,5659,9001,5681,9102,5700,9001,5825,9001,5836,9001,5837,9001,5839,9001,5842,9001,5844,9001,5858,9001,5879,9001,5880,9001,5886,9102,5887,9001,5890,9001,6128,9002,6129,9002,6135,9102,6204,9001,6207,9102,6210,9001,6211,9001,6307,9001,6311,9102,6312,9001,6316,9001,6318,9102,6322,9102,6325,9102,6362,9001,6365,9102,6391,9002,6405,9002,6406,9001,6407,9002,6408,9001,6409,9002,6410,9001,6411,9003,6412,9001,6413,9003,6414,9001,6415,9001,6416,9003,6417,9001,6418,9003,6419,9001,6420,9003,6421,9001,6422,9003,6423,9001,6424,9003,6425,9001,6426,9003,6427,9001,6428,9003,6429,9001,6430,9003,6431,9001,6432,9003,6433,9001,6434,9003,6435,9001,6436,9003,6437,9001,6438,9003,6439,9001,6440,9001,6441,9003,6442,9001,6443,9003,6444,9001,6445,9003,6446,9001,6447,9003,6448,9001,6449,9003,6450,9001,6451,9003,6452,9001,6453,9003,6454,9001,6455,9003,6456,9001,6457,9003,6458,9001,6459,9003,6460,9001,6461,9003,6462,9001,6463,9003,6464,9001,6465,9003,6466,9001,6467,9003,6468,9001,6469,9003,6470,9001,6471,9003,6472,9001,6473,9003,6474,9001,6475,9003,6476,9001,6477,9003,6478,9001,6479,9003,6484,9003,6485,9001,6486,9003,6487,9001,6488,9003,6489,9001,6490,9003,6491,9001,6492,9003,6493,9001,6494,9002,6495,9001,6496,9002,6497,9001,6498,9001,6499,9002,6500,9001,6501,9003,6502,9001,6503,9003,6504,9001,6505,9003,6506,9001,6507,9003,6508,9001,6509,9001,6510,9003,6515,9002,6516,9001,6518,9001,6519,9003,6520,9001,6521,9003,6522,9001,6523,9003,6524,9001,6525,9003,6526,9001,6527,9003,6528,9001,6529,9003,6530,9001,6531,9003,6532,9001,6533,9003,6534,9001,6535,9003,6536,9001,6537,9003,6538,9001,6539,9003,6540,9001,6541,9003,6542,9001,6543,9003,6544,9001,6545,9002,6546,9001,6547,9002,6548,9001,6549,9003,6550,9001,6551,9003,6552,9001,6553,9003,6554,9001,6555,9003,6556,9001,6557,9002,6558,9001,6559,9002,6560,9001,6561,9002,6562,9001,6563,9003,6564,9001,6565,9003,6566,9001,6567,9001,6568,9003,6569,9001,6570,9002,6571,9001,6572,9003,6573,9001,6574,9003,6575,9001,6576,9003,6577,9001,6578,9003,6582,9003,6583,9001,6584,9003,6585,9001,6586,9003,6587,9001,6588,9003,6589,9001,6590,9003,6591,9001,6592,9001,6593,9003,6594,9001,6595,9003,6596,9001,6597,9003,6598,9001,6599,9003,6600,9001,6601,9003,6602,9001,6603,9003,6605,9003,6606,9001,6607,9003,6608,9001,6609,9003,6610,9001,6611,9001,6612,9003,6613,9001,6614,9003,6615,9001,6616,9003,6617,9001,6618,9003,6633,9003,6646,9001,6668,9102,6703,9001,6706,9102,6783,9102,6784,9001,6785,9002,6786,9001,6787,9002,6788,9001,6789,9002,6790,9001,6791,9002,6792,9001,6793,9002,6794,9001,6795,9002,6796,9001,6797,9002,6798,9001,6799,9002,6800,9001,6801,9002,6802,9001,6803,9002,6804,9001,6805,9002,6806,9001,6807,9002,6808,9001,6809,9002,6810,9001,6811,9002,6812,9001,6813,9002,6814,9001,6815,9002,6816,9001,6817,9002,6818,9001,6819,9002,6820,9001,6821,9002,6822,9001,6823,9002,6824,9001,6825,9002,6826,9001,6827,9002,6828,9001,6829,9002,6830,9001,6831,9002,6832,9001,6833,9002,6834,9001,6835,9002,6836,9001,6837,9002,6838,9001,6839,9002,6840,9001,6841,9002,6842,9001,6843,9002,6844,9001,6845,9002,6846,9001,6847,9002,6848,9001,6849,9002,6850,9001,6851,9002,6852,9001,6853,9002,6854,9001,6855,9002,6856,9001,6857,9002,6858,9001,6859,9002,6860,9001,6861,9002,6862,9001,6863,9002,6867,9001,6868,9002,6870,9001,6875,9001,6876,9001,6879,9001,6880,9003,6884,9001,6885,9002,6886,9001,6887,9002,6892,9102,6894,9102,6915,9001,6922,9001,6923,9003,6924,9001,6925,9003,6962,9001,6983,9102,6984,9001,6990,9102,6991,9001,7035,9102,7037,9102,7039,9102,7041,9102,7073,9102,7084,9102,7086,9102,7128,9003,7131,9001,7132,9003,7133,9102,7136,9102,7139,9102,7142,9001,7257,9001,7258,9003,7259,9001,7260,9003,7261,9001,7262,9003,7263,9001,7264,9003,7265,9001,7266,9003,7267,9001,7268,9003,7269,9001,7270,9003,7271,9001,7272,9003,7273,9001,7274,9003,7275,9001,7276,9003,7277,9001,7278,9003,7279,9001,7280,9003,7281,9001,7282,9003,7283,9001,7284,9003,7285,9001,7286,9003,7287,9001,7288,9003,7289,9001,7290,9003,7291,9001,7292,9003,7293,9001,7294,9003,7295,9001,7296,9003,7297,9001,7298,9003,7299,9001,7300,9003,7301,9001,7302,9003,7303,9001,7304,9003,7305,9001,7306,9003,7307,9001,7308,9003,7309,9001,7310,9003,7311,9001,7312,9003,7313,9001,7314,9003,7315,9001,7316,9003,7317,9001,7318,9003,7319,9001,7320,9003,7321,9001,7322,9003,7323,9001,7324,9003,7325,9001,7326,9003,7327,9001,7328,9003,7329,9001,7330,9003,7331,9001,7332,9003,7333,9001,7334,9003,7335,9001,7336,9003,7337,9001,7338,9003,7339,9001,7340,9003,7341,9001,7342,9003,7343,9001,7344,9003,7345,9001,7346,9003,7347,9001,7348,9003,7349,9001,7350,9003,7351,9001,7352,9003,7353,9001,7354,9003,7355,9001,7356,9003,7357,9001,7358,9003,7359,9001,7360,9003,7361,9001,7362,9003,7363,9001,7364,9003,7365,9001,7366,9003,7367,9001,7368,9003,7369,9001,7370,9003,7373,9102,7683,9102,7798,9102,7844,9102,7877,9001,7878,9001,7881,9102,7882,9001,7883,9001,7886,9102,7887,9001,7899,9001,7991,9001,7992,9001,8035,9003,8036,9003,8042,9102,8043,9102,8058,9001,8059,9001,8082,9001,8083,9001,8086,9102,8088,9001,8090,9001,8091,9003,8092,9001,8093,9003,8095,9001,8096,9003,8097,9001,8098,9003,8099,9001,8100,9003,8101,9001,8102,9003,8103,9001,8104,9003,8105,9001,8106,9003,8107,9001,8108,9003,8109,9001,8110,9003,8111,9001,8112,9003,8113,9001,8114,9003,8115,9001,8116,9003,8117,9001,8118,9003,8119,9001,8120,9003,8121,9001,8122,9003,8123,9001,8124,9003,8125,9001,8126,9003,8127,9001,8128,9003,8129,9001,8130,9003,8131,9001,8132,9003,8133,9001,8134,9003,8135,9001,8136,9003,8137,9001,8138,9003,8139,9001,8140,9003,8141,9001,8142,9003,8143,9001,8144,9003,8145,9001,8146,9003,8147,9001,8148,9003,8149,9001,8150,9003,8151,9001,8152,9003,8153,9001,8154,9003,8155,9001,8156,9003,8157,9001,8158,9003,8159,9001,8160,9003,8161,9001,8162,9003,8163,9001,8164,9003,8165,9001,8166,9003,8167,9001,8168,9003,8169,9001,8170,9003,8171,9001,8172,9003,8173,9001,8177,9003,8179,9001,8180,9003,8181,9001,8182,9003,8184,9001,8185,9003,8187,9001,8189,9003,8191,9001,8193,9003,8196,9001,8197,9003,8198,9001,8200,9003,8201,9001,8202,9003,8203,9001,8204,9003,8205,9001,8206,9003,8207,9001,8208,9003,8209,9001,8210,9003,8212,9001,8213,9003,8214,9001,8216,9003,8218,9001,8220,9003,8222,9001,8224,9003,8225,9001,8226,9003,8232,9102,8237,9102,8240,9102,8246,9102,8249,9102,8252,9102,8255,9102,8311,9001,8312,9002,8313,9001,8314,9002,8315,9001,8316,9002,8317,9001,8318,9002,8319,9001,8320,9002,8321,9001,8322,9002,8323,9001,8324,9002,8325,9001,8326,9002,8327,9001,8328,9002,8329,9001,8330,9002,8331,9001,8332,9002,8333,9001,8334,9002,8335,9001,8336,9002,8337,9001,8338,9002,8339,9001,8340,9002,8341,9001,8342,9002,8343,9001,8344,9002,8345,9001,8346,9002,8347,9001,8348,9002,8351,9102,8352,9001,8353,9001,8379,9001,8380,9003,8381,9001,8382,9003,8383,9001,8384,9003,8385,9001,8387,9003,8391,9001,8395,9001,8427,9102,8428,9102,8431,9102,8433,9001,8441,9001,8455,9001,8456,9001,8531,9003,8545,9102,8682,9001,8685,9102,8687,9001,8692,9001,8693,9001,8694,9102,8699,9102,8818,9102,8826,9001,8860,9102,8888,9102,8900,9102,8902,9102,8903,9001,8907,9102,8949,9102,8950,9001,8951,9001,9003,9102,9006,9102,9009,9102,9012,9102,9014,9102,9017,9102,9019,9102,9039,9001,9040,9001,9140,9102,9141,9001,9148,9102,9149,9001,9150,9001,9153,9102,9191,9001,9221,9001,9222,9001,20499,9001,20538,9001,20539,9001,20790,9001,20791,9001,21291,9001,21292,9001,21500,9001,21817,9001,21818,9001,22032,9001,22033,9001,22091,9001,22092,9001,22332,9001,22391,9001,22392,9001,22700,9001,22770,9001,22780,9001,22832,9001,23090,9001,23095,9001,23239,9001,23240,9001,23700,9001,24047,9001,24048,9001,24100,9005,24200,9001,24305,9001,24306,9001,24382,9084,24383,9001,24500,9001,24547,9001,24548,9001,24571,9062,24600,9001,25e3,9001,25231,9001,25884,9001,25932,9001,26237,9001,26331,9001,26332,9001,26591,9001,26592,9001,26632,9001,26692,9001,27120,9001,27200,9001,27291,9040,27292,9040,27429,9001,27493,9001,27500,9001,27700,9001,28232,9001,28600,9001,28991,9001,28992,9001,29101,9001,29220,9001,29221,9001,29333,9001,29635,9001,29636,9001,29701,9001,29738,9001,29739,9001,29849,9001,29850,9001,29871,9042,29872,9041,29873,9001,30200,9039,30339,9001,30340,9001,30791,9001,30792,9001,31028,9001,31121,9001,31154,9001,31170,9001,31171,9001,31279,9001,31370,9001,31528,9001,31529,9001,31600,9001,31700,9001,31838,9001,31839,9001,31901,9001,32030,9003,32031,9003,32061,9001,32062,9001,32098,9001,32099,9003,32100,9001,32104,9001,32161,9001,32766,9001,37202,9102,37203,9102,37206,9102,37207,9102,37218,9102,37221,9102,37225,9105,37240,9102,37241,9102,37243,9102,37245,9102,37249,9102,37257,9102,37260,9102,53048,9001,53049,9001,54034,9001,54090,9001,54091,9001,65061,9003,65062,9003,65161,9001,102041,9003,102064,9085,102068,109030,102069,109031,102093,9001,102094,9001,102118,9003,102120,9003,102121,9003,102122,9001,102150,9001,102168,9001,102204,9001,102212,9001,102213,9001,102215,9001,102216,9001,102217,9003,102218,9001,102219,9003,102220,9003,102247,9001,102299,9001,102306,9001,102319,9001,102328,9001,102329,9001,102359,9001,102360,9001,102440,9001,102448,9001,102464,9003,102465,9003,102491,9001,102492,9001,102498,9001,102499,9001,102525,9003,102526,9003,102528,9003,102529,9003,102589,9003,102598,9001,102599,9003,102600,9003,102604,9003,102661,9003,102662,9003,102664,9003,102665,9003,102705,9003,102720,9003,102721,9003,102726,9003,102727,9003,102733,9003,102761,9003,102766,9003,102974,9003,103228,9001,103229,9001,103230,9003,103231,9003,103250,9001,103251,9003,103252,9001,103253,9003,103260,9001,103261,9001,103262,9003,103263,9003,103270,9001,103271,9001,103272,9003,103273,9003,103274,9001,103275,9001,103276,9003,103277,9003,103278,9001,103279,9001,103280,9003,103281,9003,103282,9001,103283,9001,103284,9003,103285,9003,103286,9001,103287,9003,103288,9001,103289,9003,103290,9001,103291,9003,103292,9001,103293,9001,103294,9003,103295,9003,103296,9001,103297,9001,103298,9003,103299,9003,103300,9001,103307,9001,103313,9001,103319,9001,103322,9001,103323,9001,103332,9001,103335,9001,103338,9001,103340,9001,103351,9001,103358,9001,103370,9001,103376,9003,103377,9001,103378,9001,103379,9003,103380,9003,103393,9001,103394,9001,103395,9003,103396,9003,103400,9003,103407,9003,103413,9003,103419,9003,103422,9003,103423,9003,103432,9003,103435,9003,103438,9003,103440,9003,103451,9003,103458,9003,103470,9003,103472,9001,103473,9002,103474,9001,103475,9003,103482,9001,103483,9003,103484,9001,103485,9003,103500,9001,103501,9003,103502,9001,103503,9001,103504,9002,103505,9002,103506,9001,103507,9001,103508,9003,103509,9003,103510,9001,103511,9001,103512,9003,103513,9003,103514,9001,103515,9003,103516,9001,103517,9003,103518,9001,103519,9003,103520,9001,103521,9002,103522,9001,103523,9001,103524,9003,103525,9003,103526,9001,103527,9003,103561,9003,103562,9003,103563,9001,103564,9001,103565,9003,103566,9003,103567,9001,103568,9001,103569,9003,103570,9003,103585,9003,103586,9001,103587,9003,103588,9002,103589,9001,103590,9003,103591,9002,103592,9001,103593,9003,103594,9002,103695,9003,103846,9001,103946,9003,104009,9102,104017,9102,104018,9102,104022,9102,104024,9102,104027,9102,104047,9102,104050,9102,104105,9102,104106,9102,104109,9102,104112,9102,104113,9102,104134,9102,104135,9102,104138,9102,104139,9105,104140,9105,104808,9102]};d.yr=function(){function p(){}return p.Ny=function(l){p.zp===!1&&p.zt();var s=p.AQ(l);if(s==-1){var a=p.Ax(l);a!=l&&(s=p.Ny(a))}return s==-1&&(a=p.AK(l))!=l&&(s=p.Ny(a)),s},p.AQ=function(l){return p.Hw[l]!==void 0?p.Hw[l]:-1},p.xQ=function(l){p.zp===!1&&p.zt();var s=p.iF(l);if(s==1e38){var a=p.Ax(l);if(a!=l&&(s=p.iF(a)),s==1e38)return 1e-10}return s},p.US=function(l){if(p.Ks[l]!==void 0)return!0;var s=p.Ax(l);return s!=l&&p.Ks[s]!==void 0},p.WS=function(l){if(p.zo[l]!==void 0)return!0;var s=p.Ax(l);return s!=l&&p.zo[s]!==void 0},p.iF=function(l){return p.zp===!1&&p.zt(),p.Ks[l]!==void 0?p.Ks[l]:p.zo[l]!==void 0?p.zo[l]:1e38},p.AK=function(l){return p.zp===!1&&p.zt(),p.RA[l]!==void 0?p.RA[l]:l},p.Ax=function(l){return p.zp===!1&&p.zt(),p.SA[l]!==void 0?p.SA[l]:l},p.zt=function(){for(var l,s=O,a=0;a<s.pcsid.length;a+=2)p.zo[s.pcsid[a]]=s.pcstol[2*s.pcsid[a+1]+1];for(a=0;a<s.pcsidc.length;a+=1)for(var u=(l=s.pcsidc[a])[0];u<=l[1];u++)p.zo[u]=s.pcstol[2*l[2]+1];for(a=0;a<s.gcsid.length;a+=2)p.Ks[s.gcsid[a]]=s.gcstol[2*s.gcsid[a+1]+1];for(a=0;a<s.gcsidc.length;a+=1)for(u=(l=s.gcsidc[a])[0];u<=l[1];u++)p.zo[u]=s.gcstol[2*l[2]+1];for(a=0;a<S.c.length;a+=1)for(u=(l=S.c[a])[0];u<=l[1];u++)p.Hw[u]=l[2];for(a=0;a<S.nc.length;a+=2)p.Hw[S.nc[a]]=S.nc[a+1];for(S=null,a=0;a<s.newtoold.length;a+=2)p.RA[s.newtoold[a+1]]=s.newtoold[a],p.SA[s.newtoold[a]]=s.newtoold[a+1];O=null,p.zp=!0},p.zp=!1,p.Ks=[],p.zo=[],p.RA=[],p.SA=[],p.Hw=[],p}()}(Q||(Q={})),function(d){function O(p){return p.length===0?'""':p[0]=='"'||p[0]=="."||"0"<=p[0]&&"9">=p[0]?p:'"'+p.trim()+'"'}var S=[];d.SC=function(){function p(){}return p.zQ=function(l){try{for(var s=0;s<S.length;s++)if(S[s].wkttext===l)return S[s].unit;for(var a,u=s="",f=!1,y=0;y<l.length;y++){var v=l[y];f===!0?v=='"'?l[y+1]=='"'?s+=v:f=f=!1:s+=v:/[\s]/.test(v)||(v==","?(u=s!==""?u+(O(s)+","):u+",",s=""):v==")"||v=="]"?(u=s!==""?u+(O(s)+"]}"):u+"]}",s=""):v=="("||v=="["?(u+='{ "entity": "'+s.toUpperCase().trim()+'", "values":[',s=""):v=='"'?(f=!0,s=""):s+=v)}a=JSON.parse(u);var _=p.hF(a);if(_===null)return null;for(a=null,v=0;v<_.values.length;v++)if(typeof _.values[v]=="object"&&_.values[v].entity==="UNIT"){a=_.values[v];break}if(a===null)return null;var M=d.Uc.UO(_.entity==="GEOGCS"?1:0,a.values[1],a.values[2]);return S.push({wkttext:l,unit:M}),10<S.length&&S.shift(),M}catch{return null}},p.hF=function(l){if(l===null)return null;if(l.entity==="GEOGCS"||l.entity==="PROJCS")return l;for(var s=[],a=0;a<l.values.length;a++)if(typeof l.values[a]=="object"&&l.values[a].entity!==void 0){if(l.values[a].entity==="GEOGCS"||l.values[a].entity=="PROJCS")return l.values[a];s.push(l.values[a])}for(l=0;l<s.length;l++)if((a=p.hF(s[l]))!==null)return a;return null},p.yQ=function(l){var s=-1;if(l!=null&&0<l.length){var a=l.indexOf("PROJCS");if(0<=a){var u=0;if(0<=(a=l.lastIndexOf("UNIT"))&&0<(a=l.indexOf(",",a+4))){a++;var f=l.indexOf("]",a+1);if(0<f)try{u=parseFloat(l.substring(a,f))}catch{u=0}}0<u&&(s=.001/u)}else if(0<=(a=l.indexOf("GEOGCS"))){var y=0;if(u=0,0<(a=l.indexOf("SPHEROID",a+6))&&0<(a=l.indexOf(",",a+8))){if(a++,0<(f=l.indexOf(",",a+1)))try{y=parseFloat(l.substring(a,f))}catch{y=0}if(0<y&&0<=(a=l.indexOf("UNIT",f+1))&&0<(a=l.indexOf(",",a+4))&&(a++,0<(f=l.indexOf("]",a+1))))try{u=parseFloat(l.substring(a,f))}catch{u=0}}0<y&&0<u&&(s=.001/(y*u))}}return s},p}()}(Q||(Q={})),function(d){var O;(O=d.$K||(d.$K={}))[O.NONE=0]="NONE",O[O.LINEAR=1]="LINEAR",O[O.ANGULAR=2]="ANGULAR",function(p){p[p.enumFloat=0]="enumFloat",p[p.enumDouble=1]="enumDouble",p[p.enumInt32=2]="enumInt32",p[p.enumInt64=3]="enumInt64",p[p.enumInt8=4]="enumInt8",p[p.enumInt16=5]="enumInt16"}(d.LL||(d.LL={})),function(p){p[p.POSITION=0]="POSITION",p[p.Z=1]="Z",p[p.M=2]="M",p[p.ID=3]="ID",p[p.NORMAL=4]="NORMAL",p[p.TEXTURE1D=5]="TEXTURE1D",p[p.TEXTURE2D=6]="TEXTURE2D",p[p.TEXTURE3D=7]="TEXTURE3D",p[p.ID2=8]="ID2",p[p.MAXSEMANTICS=10]="MAXSEMANTICS"}(d.Kh||(d.Kh={}));var S=function(){function p(l,s){if(this.Xs=this.Be=null,this.Qq=this.Ba=0,this.wh=this.dg=null,this.yl=0,s!==void 0){for(this.Ba=s.Ba,this.Qq=s.Qq,this.dg=s.dg.slice(0),this.wh=s.wh.slice(0),this.yl=s.yl,this.Xs=[],l=s=0;l<this.Ba;l++)this.Xs[l]=s,s+=p.Wa(this.dg[l]);for(this.Qq=s,this.Be=[],l=0;l<this.Ba;l++){s=p.Wa(this.ld(l));for(var a=p.te(this.ld(l)),u=0;u<s;u++)this.Be[this.Xs[l]+u]=a}}else this.Qq=this.Ba=0}return p.prototype.ld=function(l){if(0>l||l>this.Ba)throw d.i.O();return this.dg[l]},p.prototype.Rf=function(l){return this.wh[l]},p.gz=function(l){return p.EM[l]},p.Vp=function(l){return p.NM[l]},p.Wa=function(l){return p.mM[l]},p.prototype.hasAttribute=function(l){return 0<=this.wh[l]},p.prototype.dG=function(){return this.hasAttribute(1)},p.te=function(l){return p.$C[l]},p.prototype.GR=function(l){return this.Xs[l]},p.yG=function(l,s){return p.$C[l]===s},p.prototype.Nb=function(l){return this===l},p.prototype.Cn=function(){for(var l=d.P.Vh(this.dg[0]),s=1;s<this.Ba;s++)l=d.P.Vh(this.dg[s],l);return l},p.prototype.bk=function(l){return this.Xs[l]},p.prototype.dc=function(){return this.yl},p.prototype.Fd=function(l){return this.dg[l]},p.$C=[0,0,NaN,0,0,0,0,0,0],p.EM=[1,1,1,0,2,1,1,1,0],p.NM=[1,1,1,2,0,0,0,0,2],p.mM=[2,1,1,1,3,1,2,3,2],p}();d.sa=S}(Q||(Q={})),function(d){function O(f,y,v){var _=y-(f=new u(f)).e,M=f.c;for(M.length>++y&&S(f,_,u.gu),M[0]?v?_=y:(M=f.c,_=f.e+_+1):++_;M.length<_;M.push(0));return _=f.e,v===1||v&&(y<=_||_<=l)?(0>f.Cd&&M[0]?"-":"")+(1<M.length?M[0]+"."+M.join("").slice(1):M[0])+(0>_?"e":"e+")+_:f.toString()}function S(f,y,v,_){var M=f.c,$=f.e+y+1;if(v===1?_=5<=M[$]:v===2?_=5<M[$]||M[$]==5&&(_||0>$||M[$+1]!==void 0||1&M[$-1]):v===3?_=_||M[$]!==void 0||0>$:(_=!1,v!==0&&p("!Big.RM!")),1>$||!M[0])_?(f.e=-y,f.c=[1]):f.c=[f.e=0];else{if(M.length=$--,_)for(;9<++M[$];)M[$]=0,$--||(++f.e,M.unshift(1));for($=M.length;!M[--$];M.pop());}return f}function p(f){throw(f=Error(f)).name="BigError",f}var l=-7,s=21,a=/^-?(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,u=function(){function f(y){if(y instanceof f)this.Cd=y.Cd,this.e=y.e,this.c=y.c.slice();else{var v,_,M;for(y===0&&0>1/y?y="-0":a.test(y+="")||p(NaN),this.Cd=y.charAt(0)=="-"?(y=y.slice(1),-1):1,-1<(v=y.indexOf("."))&&(y=y.replace(".","")),0<(_=y.search(/e/i))?(0>v&&(v=_),v+=+y.slice(_+1),y=y.substring(0,_)):0>v&&(v=y.length),_=0;y.charAt(_)=="0";_++);if(_==(M=y.length))this.c=[this.e=0];else{for(;y.charAt(--M)=="0";);for(this.e=v-_-1,this.c=[],v=0;_<=M;this.c[v++]=+y.charAt(_++));}}}return f.prototype.abs=function(){var y=new f(this);return y.Cd=1,y},f.prototype.cmp=function(y){var v=this.c,_=(y=new f(y)).c,M=this.Cd,$=y.Cd,T=this.e,A=y.e;if(!v[0]||!_[0])return v[0]?M:_[0]?-$:0;if(M!=$)return M;if(y=0>M,T!=A)return T>(A^y)?1:-1;for(M=-1,$=(T=v.length)<(A=_.length)?T:A;++M<$;)if(v[M]!=_[M])return v[M]>(_[M]^y)?1:-1;return T==A?0:T>(A^y)?1:-1},f.prototype.lm=function(y){var v=this.c,_=(y=new f(y)).c,M=this.Cd==y.Cd?1:-1,$=f.tr;if(($!==~~$||0>$||1e6<$)&&p("!Big.DP!"),!v[0]||!_[0])return v[0]==_[0]&&p(NaN),_[0]||p(M/0),new f(0*M);var T,A,R=_.slice(),D=T=_.length,V=v.length,Z=v.slice(0,T),ee=Z.length,G=y,re=G.c=[],oe=0,se=$+(G.e=this.e-y.e)+1;for(G.Cd=M,M=0>se?0:se,R.unshift(0);ee++<T;Z.push(0));do{for(A=0;10>A;A++){if(T!=(ee=Z.length))var ge=T>ee?1:-1;else{var me=-1;for(ge=0;++me<T;)if(_[me]!=Z[me]){ge=_[me]>Z[me]?1:-1;break}}if(!(0>ge))break;for(y=ee==T?_:R;ee;){if(Z[--ee]<y[ee]){for(me=ee;me&&!Z[--me];Z[me]=9);--Z[me],Z[ee]+=10}Z[ee]-=y[ee]}for(;!Z[0];Z.shift());}re[oe++]=ge?A:++A,Z[0]&&ge?Z[ee]=v[D]||0:Z=[v[D]]}while((D++<V||Z[0]!==void 0)&&M--);return re[0]||oe==1||(re.shift(),G.e--),oe>se&&S(G,$,f.gu,Z[0]!==void 0),G},f.prototype.aS=function(){return 0<this.cmp(0)},f.prototype.iT=function(){return 0>this.cmp(0)},f.prototype.kt=function(y){var v,_=this.Cd,M=(y=new f(y)).Cd;if(_!=M)return y.Cd=-M,this.oI(y);var $=this.c.slice(),T=this.e,A=y.c,R=y.e;if(!$[0]||!A[0])return A[0]?(y.Cd=-M,y):new f($[0]?this:0);if(_=T-R){for((v=0>_)?(_=-_,T=$):(R=T,T=A),T.reverse(),M=_;M--;T.push(0));T.reverse()}else for(T=((v=$.length<A.length)?$:A).length,_=M=0;M<T;M++)if($[M]!=A[M]){v=$[M]<A[M];break}if(v&&(T=$,$=A,A=T,y.Cd=-y.Cd),0<(M=(T=A.length)-(v=$.length)))for(;M--;$[v++]=0);for(M=v;T>_;){if($[--T]<A[T]){for(v=T;v&&!$[--v];$[v]=9);--$[v],$[T]+=10}$[T]-=A[T]}for(;$[--M]==0;$.pop());for(;$[0]==0;)$.shift(),--R;return $[0]||(y.Cd=1,$=[R=0]),y.c=$,y.e=R,y},f.prototype.oI=function(y){var v=this.Cd,_=(y=new f(y)).Cd;if(v!=_)return y.Cd=-_,this.kt(y);_=this.e;var M=this.c,$=y.e,T=y.c;if(!M[0]||!T[0])return T[0]?y:new f(M[0]?this:0*v);if(M=M.slice(),v=_-$){for(0<v?($=_,_=T):(v=-v,_=M),_.reverse();v--;_.push(0));_.reverse()}for(0>M.length-T.length&&(_=T,T=M,M=_),v=T.length,_=0;v;)_=(M[--v]=M[v]+T[v]+_)/10|0,M[v]%=10;for(_&&(M.unshift(_),++$),v=M.length;M[--v]==0;M.pop());return y.c=M,y.e=$,y},f.prototype.pow=function(y){var v=this,_=new f(1),M=_,$=0>y;for((y!==~~y||-1e6>y||1e6<y)&&p("!pow!"),y=$?-y:y;1&y&&(M=M.nr(v)),y>>=1;)v=v.nr(v);return $?_.lm(M):M},f.prototype.round=function(y,v){var _=this;return y==null?y=0:(y!==~~y||0>y||1e6<y)&&p("!round!"),S(_=new f(_),y,v!=null?v:f.gu),_},f.prototype.sqrt=function(){var y=this.c,v=this.Cd,_=this.e,M=new f("0.5");if(!y[0])return new f(this);0>v&&p(NaN),(v=Math.sqrt(this.toString()))==0||v==1/0?((v=y.join("")).length+_&1||(v+="0"),(y=new f(Math.sqrt(v).toString())).e=((_+1)/2|0)-(0>_||1&_)):y=new f(v.toString()),v=y.e+(f.tr+=4);do _=y,y=M.nr(_.oI(this.lm(_)));while(_.c.slice(0,v).join("")!==y.c.slice(0,v).join(""));return S(y,f.tr-=4,f.gu),y},f.prototype.nr=function(y){var v=this.c,_=(y=new f(y)).c,M=v.length,$=_.length,T=this.e,A=y.e;if(y.Cd=this.Cd==y.Cd?1:-1,!v[0]||!_[0])return new f(0*y.Cd);if(y.e=T+A,M<$){var R=v;v=_,_=R,A=M,M=$,$=A}for(R=Array(A=M+$);A--;R[A]=0);for(T=$;T--;){for($=0,A=M+T;A>T;)$=R[A]+_[T]*v[A-T-1]+$,R[A--]=$%10,$=$/10|0;R[A]=(R[A]+$)%10}for($&&++y.e,R[0]||R.shift(),T=R.length;!R[--T];R.pop());return y.c=R,y},f.prototype.toString=function(){var y=this.e,v=this.c.join(""),_=v.length;if(y<=l||y>=s)v=v.charAt(0)+(1<_?"."+v.slice(1):"")+(0>y?"e":"e+")+y;else if(0>y){for(;++y;v="0"+v);v="0."+v}else if(0<y)if(++y>_)for(y-=_;y--;v+="0");else y<_&&(v=v.slice(0,y)+"."+v.slice(y));else 1<_&&(v=v.charAt(0)+"."+v.slice(1));return 0>this.Cd&&this.c[0]?"-"+v:v},f.prototype.toExponential=function(y){return y==null?y=this.c.length-1:(y!==~~y||0>y||1e6<y)&&p("!toExp!"),O(this,y,1)},f.prototype.toFixed=function(y){var v=l,_=s;if(l=-(s=1/0),y==null)var M=this.toString();else y===~~y&&0<=y&&1e6>=y&&(M=O(this,this.e+y),0>this.Cd&&this.c[0]&&0>M.indexOf("-")&&(M="-"+M));return l=v,s=_,M||p("!toFix!"),M},f.prototype.toPrecision=function(y){return y==null?this.toString():((y!==~~y||1>y||1e6<y)&&p("!toPre!"),O(this,y-1,2))},f.tr=20,f.gu=1,f}();d.jp=u}(Q||(Q={})),function(d){var O=function(){function S(p){this.lf=p}return S.prototype.qr=function(p,l,s){var a=new d.h,u=new d.h,f=this.lf;s.Wd(p,l,function(y,v){return f.uc(2*y,a),f.uc(2*v,u),a.compare(u)})},S.prototype.bq=function(p){return this.lf.read(2*p+1)},S}();d.si=function(){function S(){}return S.cq=function(p){if(p.B())return!1;var l=p.K();return l==1736?p.He()!=0:l==1607?(l=[!1],S.nE(p,!0,l),l[0]):!(l!=197&&(!d.ba.zd(l)||p.wG()))},S.im=function(p){var l=p.K();if(l==1736)return l=new d.Ua(p.description),p.B()||p.ZC(l),l;if(l==1607)return S.nE(p,!1,null);if(l==197)return l=new d.Ua(p.description),p.B()||l.bd(p,!1),l;if(d.ba.zd(l)){if(l=new d.ee(p.description),!p.B()&&!p.wG()){var s=new d.Ta;p.Vo(s),l.add(s),p.Ro(s),l.add(s)}return l}if(d.ba.Tn(l))return null;throw d.i.O()},S.nE=function(p,l,s){s!=null&&(s[0]=!1);var a=null;if(l||(a=new d.ee(p.description)),!p.B()){var u=new d.ja(0);u.Jb(2*p.ea());for(var f=0,y=p.ea();f<y;f++)if(0<p.Ka(f)&&!p.Pn(f)){var v=p.Ca(f);u.add(v),v=p.Wc(f)-1,u.add(v)}if(0<u.size){y=new d.Zt,f=p.vb(0),y.sort(u,0,u.size,new O(f)),y=new d.h,f.uc(2*u.get(0),y),v=0;for(var _=1,M=new d.Ta,$=new d.h,T=1,A=u.size;T<A;T++)if(f.uc(2*u.get(T),$),$.rb(y))u.get(v)>u.get(T)?(u.set(v,2147483647),v=T):u.set(T,2147483647),_++;else{if((1&_)==0)u.set(v,2147483647);else if(l)return s!=null&&(s[0]=!0),null;y.N($),v=T,_=1}if((1&_)==0)u.set(v,2147483647);else if(l)return s!=null&&(s[0]=!0),null;if(!l)for(u.Wd(0,u.size,function(R,D){return R-D}),T=0,A=u.size;T<A&&u.get(T)!=2147483647;T++)p.we(u.get(T),M),a.add(M)}}return l?null:a},S}()}(Q||(Q={})),function(d){var O=function(){function S(){this.zf=new d.ja(0),this.As=new d.ja(0),this.zH=1,this.Gs=NaN}return S.prototype.sort=function(p,l,s,a){if(32>s-l)a.qr(l,s,p);else{var u=!0;try{for(var f=1/0,y=-1/0,v=l;v<s;v++){var _=a.bq(p.get(v));_<f&&(f=_),_>y&&(y=_)}if(this.reset(s-l,f,y,s-l)){for(v=l;v<s;v++){var M=p.get(v);_=a.bq(M);var $=this.uF(_);this.zf.set($,this.zf.get($)+1),this.As.write(v-l,M)}var T=this.zf.get(0);this.zf.set(0,0),v=1;for(var A=this.zf.size;v<A;v++){var R=this.zf.get(v);this.zf.set(v,T),T+=R}for(v=l;v<s;v++){M=this.As.read(v-l),_=a.bq(M),$=this.uF(_);var D=this.zf.get($);p.set(D+l,M),this.zf.set($,D+1)}u=!1}}catch{this.zf.resize(0),this.As.resize(0)}if(u)a.qr(l,s,p);else{for(v=s=0,A=this.zf.size;v<A;v++)u=s,(s=this.zf.get(v))>u&&a.qr(l+u,l+s,p);100<this.zf.size&&(this.zf.resize(0),this.As.resize(0))}}},S.prototype.reset=function(p,l,s,a){return!(2>p||s==l)&&(p=Math.min(S.cL,p),this.zf.Jb(p),this.zf.resize(p),this.zf.Yj(0,0,this.zf.size),this.zH=l,this.As.resize(a),this.Gs=(s-l)/(p-1),!0)},S.prototype.uF=function(p){return d.P.truncate((p-this.zH)/this.Gs)},S.cL=65536,S}();d.Zt=O}(Q||(Q={})),function(d){var O,S;(S=O||(O={}))[S.enum_line=1]="enum_line",S[S.enum_arc=2]="enum_arc",S[S.enum_dummy=4]="enum_dummy",S[S.enum_concave_dip=8]="enum_concave_dip",S[S.enum_connection=3]="enum_connection";var p=function(){function f(){}return f.Su=function(y,v,_,M,$,T){var A=new f;return A.Km=new d.h,A.Xm=new d.h,A.cw=new d.h,A.Km.N(y),A.Xm.N(v),A.cw.N(_),A.Eo=M,A.sh=$,A.uh=T,A},f.construct=function(y,v,_,M){var $=new f;return $.Km=new d.h,$.Xm=new d.h,$.cw=new d.h,$.Km.N(y),$.Xm.N(v),$.cw.Sc(),$.Eo=4,$.sh=_,$.uh=M,$},f}(),l=function(){function f(y,v,_,M,$,T){this.$v=null,this.za=0,this.zA=y,this.XH=this.VH=0,this.La=v,this.Oj=_,this.xk=M,this.Fq=$,this.Vb=T}return f.prototype.next=function(){for(var y=new d.Ta;;){if(this.za==this.zA.I())return null;if(this.zA.we(this.za,y),this.za++,!y.B())break}var v=!1;if(this.$v==null&&(this.VH=y.Ng(),this.XH=y.kh(),this.$v=u.buffer(y,this.La,this.Oj,this.xk,this.Fq,this.Vb),v=!0),this.za<this.zA.I()){var _=new d.Ea;this.$v.copyTo(_)}else _=this.$v;if(!v){v=new d.Ed;var M=y.Ng()-this.VH;y=y.kh()-this.XH,v.ig(M,y),_.Pc(v)}return _},f.prototype.Ma=function(){return 0},f.prototype.re=function(){},f}(),s=function(){function f(y,v){this.Xa=y,this.za=0,this.qq=v}return f.prototype.next=function(){var y=this.Xa.Y;if(this.za<y.ea()){var v=this.za;if(this.za++,!y.Pn(v))for(var _=y.Oa(y.Wc(v)-1);this.za<y.ea();){var M=y.Oa(y.Ca(this.za));if(y.Pn(this.za)||M!=_)break;_=y.Oa(y.Wc(this.za)-1),this.za++}if(this.za-v==1)return this.Xa.fE(this.Xa.Y,v,this.qq);for((_=new d.Ua(this.Xa.Y.description)).addPath(this.Xa.Y,v,!0),v+=1;v<this.za;v++)_.Fr(this.Xa.Y,v,0,y.tv(v),!1);return this.Xa.fE(_,0,this.qq)}return null},f.prototype.Ma=function(){return 0},f.prototype.re=function(){},f}(),a=function(){function f(y){this.Xa=y,this.za=0}return f.prototype.next=function(){var y=this.Xa.Y;if(this.za<y.ea()){var v=this.za;for(y.Kr(this.za),this.za++;this.za<y.ea()&&!(0<y.Kr(this.za));)this.za++;return v==0&&this.za==y.ea()?this.Xa.ly(y,0,y.ea()):this.Xa.ly(y,v,this.za)}return null},f.prototype.Ma=function(){return 0},f.prototype.re=function(){},f}(),u=function(){function f(y){this.Ms=this.nw=this.Ns=this.Jd=null,this.$d=[],this.Vb=y,this.sb=this.Mv=this.ET=this.La=this.oA=this.dt=this.ra=0,this.jA=this.xk=-1,this.qq=!0}return f.buffer=function(y,v,_,M,$,T){if(y==null||0>M)throw d.i.O();if(y.B())return new d.Ea(y.description);var A=new d.l;return y.yc(A),0<v&&A.X(v,v),(T=new f(T)).Oj=_,T.Y=y,T.ra=d.ua.Xd(_,A,!0),T.dt=d.ua.Xd(null,A,!0),T.La=v,T.ET=y.K(),0>=$&&($=96),T.sb=Math.abs(T.La),T.Mv=T.sb!=0?1/T.sb:0,isNaN(M)||M==0?M=1e-5*T.sb:M>.5*T.sb&&(M=.5*T.sb),12>$&&($=12),(y=Math.abs(v)*(1-Math.cos(Math.PI/$)))>M?M=y:(y=Math.PI/Math.acos(1-M/Math.abs(v)))<$-1&&12>($=d.P.truncate(y))&&($=12,M=Math.abs(v)*(1-Math.cos(Math.PI/$))),T.xk=M,T.Fq=$,T.oA=Math.min(T.dt,.25*M),T.gE()},f.prototype.ev=function(){if(this.Jd==null)this.Jd=[];else if(this.Jd.length!==0)return;var y=this.lE();y=d.P.truncate((y+3)/4);var v=.5*Math.PI/y;this.jA=v;for(var _=0;_<4*y;_++)this.Jd.push(null);var M=Math.cos(v);v=Math.sin(v);var $=d.h.construct(0,1);for(_=0;_<y;_++)this.Jd[_+0*y]=d.h.construct($.y,-$.x),this.Jd[_+1*y]=d.h.construct(-$.x,-$.y),this.Jd[_+2*y]=d.h.construct(-$.y,$.x),this.Jd[_+3*y]=$,($=d.h.construct($.x,$.y)).Ct(M,v)},f.prototype.gE=function(){var y=this.Y.K();if(d.ba.zd(y))return(y=new d.Ua(this.Y.description)).pc(this.Y,!0),this.Y=y,this.gE();if(this.La<=this.ra){if(!d.ba.PS(y))return new d.Ea(this.Y.description);if(0>=this.La&&(y=new d.l,this.Y.A(y),y.S()<=2*-this.La||y.da()<=2*this.La))return new d.Ea(this.Y.description)}switch(this.Y.K()){case 33:return this.KN();case 550:return this.JN();case 1607:return this.MN();case 1736:return this.LN();case 197:return this.GN();default:throw d.i.Ra()}},f.prototype.MN=function(){if(this.zG(this.Y)){var y=new d.Ta;this.Y.we(0,y);var v=new d.l;return this.Y.A(v),y.Db(v.tf()),this.Iu(y)}return this.Y=this.RV(this.Y),y=new s(this,this.qq),d.Ih.local().W(y,this.Oj,this.Vb).next()},f.prototype.LN=function(){if(this.La==0)return this.Y;var y=d.$l.local();if(this.ev(),this.Y=y.W(this.Y,null,!1,this.Vb),0>this.La){var v=this.Y;return v=this.ly(v,0,v.ea()),y.W(v,this.Oj,!1,this.Vb)}return this.zG(this.Y)?(y=new d.Ta,this.Y.we(0,y),v=new d.l,this.Y.A(v),y.Db(v.tf()),this.Iu(y)):(y=new a(this),d.Ih.local().W(y,this.Oj,this.Vb).next())},f.prototype.ly=function(y,v,_){for(var M=new d.Ea(y.description);v<_;v++)if(!(1>y.Ka(v))){var $=y.Kr(v),T=new d.l;if(y.Tj(v,T),0<this.La){if(0<$)if(this.AG(y,v))$=new d.Ta,y.we(y.Ca(v),$),$.Db(T.tf()),this.Au(M,$);else{var A=$=new d.Ua(y.description);A=d.au.EG(this.Y,v)||this.Bn(this.Y,v,A,!0,1)==2?this.eE(y,v):this.An($),M.add(A,!1)}else if(!(T.S()+this.ra<=2*this.sb||T.da()+this.ra<=2*this.sb||(A=$=new d.Ua(y.description),this.Bn(this.Y,v,A,!0,1),$.B()))){var R=new d.l;for(R.L(T),R.X(this.sb,this.sb),A.vp(R),T=1,$=(A=this.An($)).ea();T<$;T++)M.addPath(A,T,!0)}}else if(0<$){if(!(T.S()+this.ra<=2*this.sb||T.da()+this.ra<=2*this.sb||(A=$=new d.Ua(y.description),this.Bn(this.Y,v,A,!0,-1),$.B())))for(R=new d.l,A.yc(R),R.X(this.sb,this.sb),A.vp(R),T=1,$=(A=this.An($)).ea();T<$;T++)M.addPath(A,T,!0)}else for(A=$=new d.Ua(y.description),this.Bn(this.Y,v,A,!0,-1),T=0,$=(A=this.An($)).ea();T<$;T++)M.addPath(A,T,!0)}if(0<this.La)return 1<M.ea()?M=this.An(M):f.kx(M);if(y=new d.l,M.yc(y),M.B())return f.kx(M);for(y.X(this.sb,this.sb),M.vp(y),M=this.An(M),y=new d.Ea(M.description),T=1,$=M.ea();T<$;T++)y.addPath(M,T,!1);return f.kx(y)},f.prototype.KN=function(){return this.Iu(this.Y)},f.prototype.Iu=function(y){var v=new d.Ea(this.Y.description);return this.Au(v,y),this.oX(v)},f.prototype.JN=function(){var y=new l(this.Y,this.La,this.Oj,this.xk,this.Fq,this.Vb);return d.Ih.local().W(y,this.Oj,this.Vb).next()},f.prototype.GN=function(){var y=new d.Ea(this.Y.description);if(0>=this.La){if(this.La==0)y.bd(this.Y,!1);else{var v=new d.Hh;this.Y.dn(v),v.X(this.La,this.La),y.bd(v,!1)}return y}return y.bd(this.Y,!1),this.Y=y,this.eE(y,0)},f.prototype.eE=function(y,v){this.ev();var _=new d.Ea(y.description),M=new d.h,$=new d.h,T=new d.h,A=new d.h,R=new d.h,D=new d.h,V=new d.h,Z=new d.h,ee=y.Ka(v),G=y.Ca(v),re=0;for(v=y.Ka(v);re<v;re++){if(y.D(G+re,$),y.D(G+(re+1)%ee,A),y.D(G+(re+2)%ee,D),V.vc(A,$),V.length()==0||(V.Jv(),V.normalize(),V.scale(this.sb),M.add(V,$),T.add(V,A),re==0?_.Nt(M):_.Ei(M),_.Ei(T),Z.vc(D,A),Z.length()==0))throw d.i.Ra();Z.Jv(),Z.normalize(),Z.scale(this.sb),R.add(Z,A),this.BD(_,A,T,R,!1)}return f.kx(_)},f.prototype.fE=function(y,v,_){if(this.ev(),1>y.Ka(v))return null;if(this.AG(y,v)&&0<this.La){_=new d.Ta,y.we(y.Ca(v),_);var M=new d.l;return y.Tj(v,M),_.Db(M.tf()),this.Iu(_)}if(M=new d.Ua(y.description),y.Pn(v))this.Bn(y,v,M,_,1),this.Bn(y,v,M,_,-1);else{var $=new d.Ua(y.description);$.addPath(y,v,!1),$.Fr(y,v,0,y.tv(v),!1),this.Bn($,0,M,_,1)}return this.An(M)},f.prototype.Zq=function(){if(this.$s++,this.$s%1024==0&&this.Vb!=null&&!this.Vb.progress(-1,-1))throw d.i.hu("user_canceled")},f.prototype.An=function(y){return d.Hg.Ok(y,this.dt,!0,!0,this.Vb)},f.prototype.lE=function(){if(this.xk==0)return this.Fq;var y=1-this.xk*Math.abs(this.Mv);return 4>(y=-1>y?4:2*Math.PI/Math.acos(y)+.5)?y=4:y>this.Fq&&(y=this.Fq),d.P.truncate(y)},f.prototype.BD=function(y,v,_,M,$){this.ev();var T=new d.h;T.vc(_,v),T.scale(this.Mv);var A=new d.h;A.vc(M,v),A.scale(this.Mv),0>(T=Math.atan2(T.y,T.x)/this.jA)&&(T=this.Jd.length+T),T=this.Jd.length-T,0>(A=Math.atan2(A.y,A.x)/this.jA)&&(A=this.Jd.length+A),(A=this.Jd.length-A)<T&&(A+=this.Jd.length);var R=d.P.truncate(A);A=d.P.truncate(Math.ceil(T)),(T=new d.h).N(this.Jd[A%this.Jd.length]),T.Dt(this.sb,v);var D=10*this.ra;for(T.sub(_),T.length()<D&&(A+=1),T.N(this.Jd[R%this.Jd.length]),T.Dt(this.sb,v),T.sub(M),T.length()<D&&--R,_=R-A,_++,R=0,A%=this.Jd.length;R<_;R++,A=(A+1)%this.Jd.length)T.N(this.Jd[A]),T.Dt(this.sb,v),y.Ei(T),this.Zq();$&&y.Ei(M)},f.prototype.Bn=function(y,v,_,M,$){var T=new d.hd,A=T.hN(y,v);if(T.Ip(this.oA,!1,!1),2>T.I(A))return 0>$||($=y,T=new d.Ta,$.we($.Ca(v),T),this.Au(_,T)),1;var R=T.Oa(T.Ya(T.Ob(A))),D=new d.Ed;if(D.ig(-R.x,-R.y),T.Pc(D),M&&(this.oQ(T,A,$),2>T.I(A)))return 0>$||($=y,T=new d.Ta,$.we($.Ca(v),T),this.Au(_,T)),1;this.$d.length=0;var V=T.Ob(A);v=T.Ya(V);var Z=$==1?T.Na(v):T.V(v);y=$==1?T.V(v):T.Na(v);var ee=!0;M=new d.h,A=new d.h;var G=new d.h,re=new d.h,oe=new d.h,se=new d.h,ge=new d.h,me=new d.h,Ie=new d.h,De=new d.h,Fe=this.sb;V=T.Ka(V);for(var gt=0;gt<V;gt++)T.D(y,A),ee&&(T.D(v,M),T.D(Z,G),me.vc(M,G),me.normalize(),De.HG(me),De.scale(Fe),re.add(De,M)),ge.vc(A,M),ge.normalize(),Ie.HG(ge),Ie.scale(Fe),oe.add(M,Ie),Z=me.yi(ge),ee=me.Sh(ge),0>Z||0>ee&&Z==0?this.$d.push(p.Su(re,oe,M,2,this.$d.length+1,this.$d.length-1)):re.rb(oe)||(this.$d.push(p.construct(re,M,this.$d.length+1,this.$d.length-1,"dummy")),this.$d.push(p.construct(M,oe,this.$d.length+1,this.$d.length-1,"dummy"))),se.add(A,Ie),this.$d.push(p.Su(oe,se,M,1,this.$d.length+1,this.$d.length-1)),re.N(se),De.N(Ie),G.N(M),M.N(A),me.N(ge),Z=v,v=y,ee=!1,y=$==1?T.V(v):T.Na(v);return this.$d[this.$d.length-1].sh=0,this.$d[0].uh=this.$d.length-1,this.TV(_),D.ig(R.x,R.y),_.TD(D,_.ea()-1),1},f.prototype.TV=function(y){for(var v=this.uO(),_=!0,M=v+1,$=v;M!=v;$=M){var T=this.$d[$];M=T.sh!=-1?T.sh:($+1)%this.$d.length,T.Eo!=0&&(_&&y.Nt(T.Km),T.Eo==2?this.BD(y,T.cw,T.Km,T.Xm,!0):y.Ei(T.Xm),_=!1)}},f.prototype.uO=function(){this.Ms==null&&(this.Ms=[null,null,null,null,null,null,null,null,null]);for(var y=0,v=0,_=this.$d.length;v<_;){var M=this.$d[v];if((3&M.Eo)!=0){y=v;break}v=M.sh}for(_=y+1,v=y;_!=y;v=_){_=(M=this.$d[v]).sh;for(var $=1,T=null;_!=v&&(3&(T=this.$d[_]).Eo)==0;)_=T.sh,$++;$!=1&&(M.Eo&T.Eo)==1&&(this.Ns==null&&(this.Ns=new d.zb,this.nw=new d.zb),this.Ns.Ec(M.Km),this.Ns.Rc(M.Xm),this.nw.Ec(T.Km),this.nw.Rc(T.Xm),this.Ns.Fa(this.nw,this.Ms,null,null,this.dt)==1&&(M.Xm.N(this.Ms[0]),T.Km.N(this.Ms[0]),M.sh=_,T.uh=v))}return y},f.prototype.Hv=function(y,v,_){var M=new d.h;if(M.vc(_,y),_=M.length(),0<(_=this.sb*this.sb-_*_*.25)){_=Math.sqrt(_),M.normalize(),M.cr();var $=new d.h;if($.vc(v,y),$.Sh(M)+_>=this.sb)return!0}return!1},f.prototype.oQ=function(y,v,_){for(var M=0;1>M;M++){var $=!1,T=y.Ob(v),A=y.Ka(T);if(A==0)break;var R=A;if(3>A)break;!y.ec(T)&&(R=A-1),T=y.Ya(T),A=0<_?y.Na(T):y.V(T);for(var D=0<_?y.V(T):y.Na(T),V=A,Z=!0,ee=new d.h,G=new d.h,re=new d.h,oe=new d.h,se=new d.h,ge=d.h.construct(0,0),me=new d.h,Ie=new d.h,De=new d.h,Fe=new d.h,gt=this.sb,Ze=0,Vt=0;Vt<R&&(y.D(D,G),Z&&(y.D(T,ee),y.D(A,re),V=A),Ie.vc(ee,re),Ie.normalize(),me.vc(G,ee),me.normalize(),V!=D);){var Rt=Ie.yi(me),lt=Ie.Sh(me),Ui=!0;if(0>Rt||0>lt&&Rt==0||!this.Hv(re,ee,G)||(ge.N(G),Ui=!1,++Ze,$=!0),Ui){if(0<Ze)for(;(Rt=0<_?y.Na(V):y.V(V))!=T;){if(y.D(Rt,oe),!this.Hv(oe,re,ge)){Rt!=D&&this.Hv(oe,re,G)&&this.Hv(oe,ee,G)&&(re.N(oe),V=Rt,Ui=!1,++Ze);break}re.N(oe),V=Rt,Ui=!1,++Ze}if(!Ui)continue;if(0<Ze){for(V=0<_?y.Na(A):y.V(A),Z=1;Z<Ze;Z++)Ui=0<_?y.Na(V):y.V(V),y.qd(V,!0),V=Ui;De.vc(ee,re),Ze=gt*gt-(Ze=De.length())*Ze*.25,gt-(Ze=Math.sqrt(Ze))>.5*this.xk?(se.add(re,ee),se.scale(.5),De.normalize(),De.cr(),Fe.N(De),Fe.scale(gt-Ze),se.add(Fe),y.mf(A,se)):y.qd(A,!0),Ze=0}re.N(ee),V=T}ee.N(G),A=T,T=D,D=0<_?y.V(T):y.Na(T),Vt++,Z=!1}if(0<Ze){for(V=0<_?y.Na(A):y.V(A),Z=1;Z<Ze;Z++)Ui=0<_?y.Na(V):y.V(V),y.qd(V,!0),V=Ui;se.add(re,ee),se.scale(.5),De.vc(ee,re),Ze=gt*gt-(Ze=De.length())*Ze*.25,Ze=Math.sqrt(Ze),De.normalize(),De.cr(),Fe.N(De),Fe.scale(gt-Ze),se.add(Fe),y.mf(A,se)}if(y.Ip(this.oA,!1,!1),!$)break}},f.prototype.AG=function(y,v){if(y.Ka(v)==1)return!0;var _=new d.l;return y.Tj(v,_),Math.max(_.S(),_.da())<.5*this.xk},f.prototype.zG=function(y){var v=new d.l;return y.A(v),Math.max(v.S(),v.da())<.5*this.xk},f.prototype.RV=function(y){for(var v=0,_=0,M=(y=d.zC.local().W(y,.25*this.xk,!1,this.Vb)).ea();_<M;_++)v=Math.max(y.Ka(_),v);return 32>v?(this.qq=!1,y):(this.qq=!0,d.Hg.Ok(y,this.dt,!1,!0,this.Vb))},f.prototype.Au=function(y,v){if(v=v.D(),this.Jd!=null&&this.Jd.length!==0){var _=new d.h;_.N(this.Jd[0]),_.Dt(this.sb,v),y.Nt(_);for(var M=1,$=this.Jd.length;M<$;M++)_.N(this.Jd[M]),_.Dt(this.sb,v),y.Ei(_)}else{M=this.lE(),_=d.P.truncate((M+3)/4),M=.5*Math.PI/_,$=Math.cos(M);for(var T=Math.sin(M),A=new d.h,R=3;0<=R;R--){switch(A.na(0,this.sb),R){case 0:for(M=0;M<_;M++)y.Aj(A.x+v.x,A.y+v.y),A.Ct($,T);break;case 1:for(M=0;M<_;M++)y.Aj(-A.y+v.x,A.x+v.y),A.Ct($,T);break;case 2:for(M=0;M<_;M++)y.Aj(-A.x+v.x,-A.y+v.y),A.Ct($,T);break;default:for(y.rx(A.y+v.x,-A.x+v.y),M=1;M<_;M++)A.Ct($,T),y.Aj(A.y+v.x,-A.x+v.y)}this.Zq()}}},f.kx=function(y){return y.Eh(1,0),y},f.prototype.oX=function(y){return y.Eh(2,this.ra),y.hm(),y},f}();d.CK=u}(Q||(Q={})),function(d){var O=function(){function S(p){this.Da=p,this.g=new d.hd,this.ed=new d.ja(0)}return S.prototype.Nh=function(p,l,s){switch(l){case 0:if(p.v<s&&p.C<=s)break;return p.v>=s?1:-1;case 1:if(p.G<s&&p.H<=s)break;return p.G>=s?1:-1;case 2:if(p.v>=s&&p.C>s)break;return p.C<=s?1:-1;case 3:if(!(p.G>=s&&p.H>s))return p.H<=s?1:-1}return 0},S.prototype.vy=function(p,l){return p.K()==1736?this.xy(p,l):this.yy(p)},S.prototype.xy=function(p,l){if(this.Da.S()==0||this.Da.da()==0)return p.Ja();var s=new d.l;p.yc(s),this.Y=this.g.Ib(p);var a=new d.l,u=new d.l,f=new d.h,y=new d.h,v=[0,0,0,0,0,0,0,0,0],_=[0,0,0,0,0,0,0,0,0];new d.jg;var M=new d.zb,$=new d.ja(0);$.Jb(Math.min(100,p.I()));for(var T=!1,A=0;!T&&4>A;A++){var R=!1,D=(1&A)!=0,V=0;switch(A){case 0:V=this.Da.v,R=s.v<=V&&s.C>=V;break;case 1:V=this.Da.G,R=s.G<=V&&s.H>=V;break;case 2:V=this.Da.C,R=s.v<=V&&s.C>=V;break;case 3:V=this.Da.H,R=s.G<=V&&s.H>=V}if(R)for(T=!0,R=this.g.Ob(this.Y);R!=-1;){var Z=-1,ee=-1,G=this.g.Ya(R),re=G;do{var oe=this.g.cc(re);oe==null&&(oe=M,this.g.D(re,f),oe.Ec(f),this.g.D(this.g.V(re),y),oe.Rc(y)),oe.A(a);var se=this.Nh(a,A,V),ge=0,me=-1;if(se==-1){ge=0<(oe=oe.fq(D,V,v,_))?this.g.Wl(re,_,oe):0,ge+=1;var Ie=re,De=this.g.V(Ie);for(oe=0;oe<ge;oe++){if(this.g.D(Ie,f),this.g.D(De,y),(me=this.g.cc(Ie))==null&&((me=M).Ec(f),me.Rc(y)),me.A(u),(me=this.Nh(u,A,V))==-1){if(D)(me=Math.abs(f.y-V))<(Fe=Math.abs(y.y-V))?(f.y=V,this.g.mf(Ie,f)):(y.y=V,this.g.mf(De,y));else{me=Math.abs(f.x-V);var Fe=Math.abs(y.x-V);me<Fe?(f.x=V,this.g.mf(Ie,f)):(y.x=V,this.g.mf(De,y))}(me=this.g.cc(Ie))==null&&((me=M).Ec(f),me.Rc(y)),me.A(u),me=this.Nh(u,A,V)}Fe=Z,Z=me,ee==-1&&(ee=Z),Fe==0&&Z==1||Fe==1&&Z==0||Fe!=0||Z!=0||$.add(Ie),Z==1&&(T=!1),me=Ie=De,De=this.g.V(De)}}ge==0&&(Fe=Z,Z=se,ee==-1&&(ee=Z),Fe==0&&Z==1||Fe==1&&Z==0||Fe!=0||Z!=0||$.add(re),Z==1&&(T=!1),me=this.g.V(re)),re=me}while(re!=G);for(ee==0&&Z==0&&$.add(G),oe=0,Z=$.size;oe<Z;oe++)ee=$.get(oe),this.g.qd(ee,!1);$.clear(!1),R=3>this.g.Ka(R)?this.g.ar(R):this.g.Sb(R)}}return T?p.Ja():(this.AB(),0<l&&this.Hy(l),this.g.Ke(this.Y))},S.prototype.yy=function(p){var l=new d.l,s=new d.l,a=[0,0,0,0,0,0,0,0,0],u=[0,0,0,0,0,0,0,0,0],f=new d.jg,y=p,v=new d.l;p.yc(v);for(var _=0;4>_;_++){var M=!1,$=(1&_)!=0,T=0;switch(_){case 0:T=this.Da.v,M=v.v<=T&&v.C>=T;break;case 1:T=this.Da.G,M=v.G<=T&&v.H>=T;break;case 2:T=this.Da.C,M=v.v<=T&&v.C>=T;break;case 3:T=this.Da.H,M=v.G<=T&&v.H>=T}if(M){M=y,y=p.Ja(),(M=M.Ha()).aj();for(var A,R=new d.h;M.ab();)for(var D,V=!0;M.Ia();){var Z=M.ia();Z.A(l);var ee=this.Nh(l,_,T);if(ee==-1){if(0<(ee=Z.fq($,T,a,u))){var G=0;A=Z.bc();for(var re=0;re<=ee;re++)if(G!=(D=re<ee?u[re]:1)){Z.dh(G,D,f);var oe=f.get();oe.Ec(A),re<ee&&($?(R.x=a[re],R.y=T):(R.x=T,R.y=a[re]),oe.Rc(R)),oe.A(s);var se=this.Nh(s,_,T);if(se==-1){if(A=oe.bc(),G=oe.xc(),$)(se=Math.abs(A.y-T))<(ge=Math.abs(G.y-T))?(A.y=T,oe.Ec(A)):(G.y=T,oe.Rc(G));else{se=Math.abs(A.x-T);var ge=Math.abs(G.x-T);se<ge?(A.x=T,oe.Ec(A)):(G.x=T,oe.Rc(G))}oe.A(s),se=this.Nh(s,_,T)}A=oe.xc(),G=D,(D=se)==1?(y.pc(oe,V),V=!1):V=!0}}}else(D=ee)==1?(y.pc(Z,V),V=!1):V=!0}}}return y},S.prototype.AB=function(){this.li=-1,this.Xl(!1,this.Da.v),this.Xl(!1,this.Da.C),this.Xl(!0,this.Da.G),this.Xl(!0,this.Da.H),this.ed.resize(0),this.ed.Jb(100),this.li=this.g.Hd();for(var p=new d.h,l=this.g.Ob(this.Y);l!=-1;l=this.g.Sb(l))for(var s=this.g.Ya(l),a=0,u=this.g.Ka(l);a<u;a++,s=this.g.V(s))this.g.D(s,p),(this.Da.v==p.x||this.Da.C==p.x||this.Da.G==p.y||this.Da.H==p.y)&&(this.g.Sa(s,this.li,this.ed.size),this.ed.add(s));this.Pl(!1,this.Da.v),this.Pl(!1,this.Da.C),this.Pl(!0,this.Da.G),this.Pl(!0,this.Da.H),this.Oy()},S.prototype.Hy=function(p){for(var l=new d.h,s=new d.h,a=d.P.mg(2048,0),u=this.g.Ob(this.Y);u!=-1;u=this.g.Sb(u)){var f=this.g.Ya(u),y=f;do{var v=this.g.V(y);this.g.D(y,l);var _=-1;if(l.x==this.Da.v?(this.g.D(v,s),s.x==this.Da.v&&(_=1)):l.x==this.Da.C&&(this.g.D(v,s),s.x==this.Da.C&&(_=1)),l.y==this.Da.G?(this.g.D(v,s),s.y==this.Da.G&&(_=0)):l.y==this.Da.H&&(this.g.D(v,s),s.y==this.Da.H&&(_=0)),_!=-1&&(_=d.h.ub(l,s),!(1>=(_=d.P.truncate(Math.min(Math.ceil(_/p),2048)))))){for(var M=1;M<_;M++)a[M-1]=1*M/_;this.g.Wl(y,a,_-1)}y=v}while(y!=f)}},S.prototype.Xl=function(p,l){var s=this.g.Hd(),a=new d.h,u=new d.ja(0);u.Jb(100);for(var f=this.g.Ob(this.Y);f!=-1;f=this.g.Sb(f))for(var y=this.g.Ya(f),v=0,_=this.g.Ka(f);v<_;v++){var M=this.g.V(y);this.g.D(y,a),(p?a.y==l:a.x==l)&&(this.g.D(M,a),(p?a.y==l:a.x==l)&&(this.g.Qa(y,s)!=1&&(u.add(y),this.g.Sa(y,s,1)),this.g.Qa(M,s)!=1&&(u.add(M),this.g.Sa(M,s,1)))),y=M}if(this.g.Ud(s),!(3>u.size)){var $=this;u.Wd(0,u.size,function(se,ge){return $.Oh(se,ge)}),s=new d.h,f=new d.h,y=new d.h,f.Sc();var T=-1;v=new d.ja(0),_=new d.ja(0),M=this.g.Hd();for(var A=this.g.Hd(),R=0,D=u.size;R<D;R++){var V=u.get(R);if(this.g.D(V,a),!a.rb(f)){if(T!=-1){for(var Z=T;Z<R;Z++){T=u.get(Z);var ee=this.g.V(T);V=this.g.Na(T);var G=!1;0>this.Oh(T,ee)&&(this.g.D(ee,s),p?s.y==l:s.x==l)&&(v.add(T),G=!0,this.g.Sa(T,A,1)),0>this.Oh(T,V)&&(this.g.D(V,s),p?s.y==l:s.x==l)&&(G||v.add(T),this.g.Sa(T,M,1))}for(Z=0,G=v.size;Z<G;Z++){if(T=v.get(Z),V=this.g.Qa(T,M),ee=this.g.Qa(T,A),V==1){V=this.g.Na(T),this.g.D(V,y);var re=[0];if(re[0]=0,!y.rb(a)){var oe=d.h.ub(f,y);re[0]=d.h.ub(y,a)/oe,re[0]==0?re[0]=2220446049250313e-31:re[0]==1&&(re[0]=.9999999999999998),this.g.Wl(V,re,1),V=this.g.Na(T),this.g.mf(V,a),_.add(V),this.g.Sa(V,M,1),this.g.Sa(V,A,-1)}}ee==1&&(ee=this.g.V(T),this.g.D(ee,y),(re=[0])[0]=0,y.rb(a)||(oe=d.h.ub(f,y),re[0]=d.h.ub(f,a)/oe,re[0]==0?re[0]=2220446049250313e-31:re[0]==1&&(re[0]=.9999999999999998),this.g.Wl(T,re,1),V=this.g.V(T),this.g.mf(V,a),_.add(V),this.g.Sa(V,M,-1),this.g.Sa(V,A,1)))}T=v,v=_,(_=T).clear(!1)}T=R,f.N(a)}}this.g.Ud(M),this.g.Ud(A)}},S.prototype.Pl=function(p,l){var s=new d.h,a=new d.ja(0);a.Jb(100);for(var u=this.g.Hd(),f=0,y=this.ed.size;f<y;f++){var v=this.ed.get(f);if(v!=-1){var _=this.g.V(v);this.g.D(v,s),(p?s.y==l:s.x==l)&&(this.g.D(_,s),(p?s.y==l:s.x==l)&&(this.g.Qa(v,u)!=-2&&(a.add(v),this.g.Sa(v,u,-2)),this.g.Qa(_,u)!=-2&&(a.add(_),this.g.Sa(_,u,-2))))}}if(a.size!=0){var M=this;for(a.Wd(0,a.size,function(ge,me){return M.Oh(ge,me)}),f=0,y=a.size;f<y;f++){var $=a.get(f);this.g.Sa($,u,f)}v=new d.h,(_=new d.h).Sc();var T=-1;for(f=0,y=a.size;f<y;f++)if(($=a.get(f))!=-1&&(this.g.D($,s),!s.rb(_))){if(T!=-1)for(;;){$=!1;for(var A=1<f-T?f-1:f,R=T;R<A;R++){var D=a.get(R);if(D!=-1){var V=-1,Z=this.g.V(D);0>this.Oh(D,Z)&&(this.g.D(Z,v),p?v.y==l:v.x==l)&&(V=Z),Z=-1;var ee=this.g.Na(D);if(0>this.Oh(D,ee)&&(this.g.D(ee,v),p?v.y==l:v.x==l)&&(Z=ee),V!=-1&&Z!=-1)this.Mh(D,a,u),this.g.qd(D,!1),this.Mh(V,a,u),this.g.qd(V,!1),$=!0;else if(V!=-1||Z!=-1){for(ee=R+1;ee<f;ee++){var G=a.get(ee);if(G!=-1){var re=this.g.V(G),oe=-1;0>this.Oh(G,re)&&(this.g.D(re,v),p?v.y==l:v.x==l)&&(oe=re),re=this.g.Na(G);var se=-1;if(0>this.Oh(G,re)&&(this.g.D(re,v),p?v.y==l:v.x==l)&&(se=re),oe!=-1&&se!=-1){this.Mh(G,a,u),this.g.qd(G,!1),this.Mh(oe,a,u),this.g.qd(oe,!1),$=!0;break}if(V!=-1&&se!=-1){this.At(a,D,V,G,se,u),$=!0;break}if(Z!=-1&&oe!=-1){this.At(a,G,oe,D,Z,u),$=!0;break}}}if($)break}}}if(!$)break}T=f,_.N(s)}}this.g.Ud(u)},S.prototype.Mh=function(p,l,s){s=this.g.Qa(p,s),l.set(s,-1),s=this.g.Qa(p,this.li),this.ed.set(s,-1),(l=this.g.cd(p))!=-1&&this.g.Ya(l)==p&&(this.g.Kf(l,-1),this.g.Yg(l,-1))},S.prototype.At=function(p,l,s,a,u,f){this.g.Cc(l,a),this.g.Dc(a,l),this.g.Dc(s,u),this.g.Cc(u,s),this.Mh(a,p,f),this.g.oi(a,!1),this.Mh(u,p,f),this.g.oi(u,!0)},S.prototype.Oy=function(){for(var p=0,l=this.ed.size;p<l;p++){var s=this.ed.get(p);s!=-1&&this.g.cj(s,-1)}for(var a=0,u=0,f=this.g.Ob(this.Y);f!=-1;){var y=this.g.Ya(f);if(y==-1||f!=this.g.cd(y)){var v=f;f=this.g.Sb(f),this.g.Kf(v,-1),this.g.br(v)}else{s=y,v=0;do this.g.cj(s,f),v++,s=this.g.V(s);while(s!=y);2>=v?(s=this.g.Qa(y,this.li),this.ed.set(s,-1),y=this.g.qd(y,!1),v==2&&(s=this.g.Qa(y,this.li),this.ed.set(s,-1),this.g.qd(y,!1)),v=f,f=this.g.Sb(f),this.g.Kf(v,-1),this.g.br(v)):(this.g.fp(f,!1),this.g.Yg(f,this.g.Na(y)),this.g.Xj(f,v),u+=v,a++,f=this.g.Sb(f))}}for(p=0,l=this.ed.size;p<l;p++)if((s=this.ed.get(p))!=-1&&(f=this.g.cd(s))==-1){f=this.g.wf(this.Y,-1),v=0,y=s;do this.g.cj(s,f),v++,s=this.g.V(s);while(s!=y);2>=v?(s=this.g.Qa(y,this.li),this.ed.set(s,-1),y=this.g.qd(y,!1),v==2&&(0<=(s=this.g.Qa(y,this.li))&&this.ed.set(s,-1),this.g.qd(y,!1)),v=f,this.g.Kf(v,-1),this.g.br(v)):(this.g.mn(f,!0),this.g.Xj(f,v),this.g.Kf(f,y),this.g.Yg(f,this.g.Na(y)),this.g.fp(f,!1),u+=v,a++)}for(this.g.Tl(this.Y,a),this.g.Vj(this.Y,u),p=0,l=this.g.md;l!=-1;l=this.g.ve(l))p+=this.g.I(l);this.g.XB(p)},S.wy=function(p,l,s){return new S(l).vy(p,s)},S.clip=function(p,l,s,a){if(p.B())return p;if(l.B())return p.Ja();if((s=p.K())==33)return a=p.D(),l.contains(a)?p:p.Ja();if(s==197)return a=new d.l,p.A(a),a.Fa(l)?(l=new d.Hh,p.copyTo(l),l.Zo(a),l):p.Ja();var u=new d.l;if(p.yc(u),l.contains(u))return p;if(!l.isIntersecting(u))return p.Ja();if((u=p.Cb)!=null&&(u=u.Hk)!=null){if((u=u.To(l))==1){if(s!=1736)throw d.i.Ra();return(p=new d.Ea(p.description)).vp(l),p}if(u==0)return p.Ja()}switch(s){case 550:s=null,u=p.I();for(var f=p.vb(0),y=0,v=0;v<u;v++)a=new d.h,f.uc(2*v,a),l.contains(a)||(y==0&&(s=p.Ja()),y<v&&s.Gd(p,y,v),y=v+1);return 0<y&&s.Gd(p,y,u),y==0?p:s;case 1736:case 1607:return S.wy(p,l,a);default:throw d.i.Ra()}},S.prototype.Oh=function(p,l){var s=new d.h;return this.g.D(p,s),p=new d.h,this.g.D(l,p),s.compare(p)},S}();d.Vd=O}(Q||(Q={})),function(d){var O=function(){function S(p,l){this.Da=p,this.g=new d.hd,this.ed=new d.ja(0),this.od=l}return S.prototype.Nh=function(p,l,s){switch(l){case 0:if(p.v<s&&p.C<=s)break;return p.v>=s?1:-1;case 1:if(p.G<s&&p.H<=s)break;return p.G>=s?1:-1;case 2:if(p.v>=s&&p.C>s)break;return p.C<=s?1:-1;case 3:if(!(p.G>=s&&p.H>s))return p.H<=s?1:-1}return 0},S.prototype.vy=function(p,l){return p.K()==1736?this.xy(p,l):this.yy(p)},S.prototype.xy=function(p,l){if(this.Da.S()==0||this.Da.da()==0)return p.Ja();var s=new d.l;p.yc(s),this.Y=this.g.Ib(p);var a=new d.l,u=new d.l,f=new d.h,y=new d.h,v=[0,0,0,0,0,0,0,0,0],_=[0,0,0,0,0,0,0,0,0],M=new d.zb,$=new d.ja(0);$.Jb(256);for(var T=!1,A=0;!T&&4>A;A++){var R=!1,D=(1&A)!=0,V=0;switch(A){case 0:V=this.Da.v,R=s.v<=V&&s.C>=V;break;case 1:V=this.Da.G,R=s.G<=V&&s.H>=V;break;case 2:V=this.Da.C,R=s.v<=V&&s.C>=V;break;case 3:V=this.Da.H,R=s.G<=V&&s.H>=V}if(R)for(T=!0,R=this.g.Ob(this.Y);R!=-1;){var Z=!0,ee=-1,G=-1,re=this.g.Ya(R),oe=re;do{var se=this.g.cc(oe);se==null&&(se=M,this.g.D(oe,f),se.Ec(f),this.g.D(this.g.V(oe),y),se.Rc(y)),se.A(a);var ge=this.Nh(a,A,V),me=0,Ie=-1;if(ge==-1){me=0<(se=se.fq(D,V,v,_))?this.g.HX(oe,_,se):0,me+=1;var De=oe,Fe=this.g.V(De);for(se=0;se<me;se++){if(this.g.D(De,f),this.g.D(Fe,y),(Ie=this.g.cc(De))==null&&((Ie=M).Ec(f),Ie.Rc(y)),Ie.A(u),(Ie=this.Nh(u,A,V))==-1){if(D)(Ie=Math.abs(f.y-V))<(gt=Math.abs(y.y-V))?(f.y=V,this.g.mf(De,f)):(y.y=V,this.g.mf(Fe,y));else{Ie=Math.abs(f.x-V);var gt=Math.abs(y.x-V);Ie<gt?(f.x=V,this.g.mf(De,f)):(y.x=V,this.g.mf(Fe,y))}(Ie=this.g.cc(De))==null&&((Ie=M).Ec(f),Ie.Rc(y)),Ie.A(u),Ie=this.Nh(u,A,V)}gt=ee,ee=Ie,G==-1&&(G=ee),gt==0&&ee==1||gt==1&&ee==0||gt!=0||ee!=0||$.add(De),ee==1&&(Z=T=!1),Ie=De=Fe,Fe=this.g.V(Fe)}}if(me==0&&(gt=ee,ee=ge,G==-1&&(G=ee),gt==0&&ee==1||gt==1&&ee==0||gt!=0||ee!=0||$.add(oe),ee==1&&(Z=T=!1),Ie=this.g.V(oe)),oe=Ie,256<=$.size){for(se=1,ge=$.size-1;se<ge;se++)me=$.get(se),this.g.qd(me,!1);$.set(1,$.Gc()),$.Dh(2)}}while(oe!=re);if(!Z)for(G==0&&ee==0&&$.add(re),se=0,ge=$.size;se<ge;se++)me=$.get(se),this.g.qd(me,!1);$.clear(!1),R=Z||this.g.Ka(R)==0?this.g.ar(R):this.g.Sb(R)}}return T?p.Ja():(this.AB(),0<l&&this.Hy(l),this.g.Ke(this.Y))},S.prototype.yy=function(p){var l=new d.l,s=new d.l,a=[0,0,0,0,0,0,0,0,0],u=[0,0,0,0,0,0,0,0,0],f=new d.jg,y=p,v=new d.l;p.yc(v);for(var _=new d.h,M=new d.h,$=null,T=null,A=0;4>A;A++){var R=!1,D=(1&A)!=0,V=0;switch(A){case 0:V=this.Da.v,R=v.v<=V&&v.C>=V;break;case 1:V=this.Da.G,R=v.G<=V&&v.H>=V;break;case 2:V=this.Da.C,R=v.v<=V&&v.C>=V;break;case 3:V=this.Da.H,R=v.G<=V&&v.H>=V}if(R)for(R=y,y=p.Ja(),(R=R.Ha()).aj();R.ab();)for(var Z,ee=!0;R.Ia();){var G=R.ia();G.A(l);var re=this.Nh(l,A,V);if(re==-1){if(0<(re=G.fq(D,V,a,u))){var oe=0;G.$p(_);for(var se=0;se<=re;se++)if(oe!=(Z=se<re?u[se]:1)){G.dh(oe,Z,f);var ge=f.get();ge.Ec(_),se<re&&(D?(M.x=a[se],M.y=V):(M.x=V,M.y=a[se]),ge.Rc(M)),ge.A(s);var me=this.Nh(s,A,V);me==-1&&($==null&&($=new d.h),T==null&&(T=new d.h),ge.$p($),ge.Vr(T),D?(oe=Math.abs($.y-V))<(me=Math.abs(T.y-V))?($.y=V,ge.Ec($)):(T.y=V,ge.Rc(T)):(oe=Math.abs($.x-V))<(me=Math.abs(T.x-V))?($.x=V,ge.Ec($)):(T.x=V,ge.Rc(T)),ge.A(s),me=this.Nh(s,A,V)),ge.Vr(_),oe=Z,(Z=me)==1?(y.pc(ge,ee),ee=!1):ee=!0}}}else(Z=re)==1?(y.pc(G,ee),ee=!1):ee=!0}}return y},S.prototype.AB=function(){this.li=-1,this.Xl(!1,this.Da.v),this.Xl(!1,this.Da.C),this.Xl(!0,this.Da.G),this.Xl(!0,this.Da.H),this.ed.resize(0),this.ed.Jb(100),this.li=this.g.Hd();for(var p=new d.h,l=this.g.Ob(this.Y);l!=-1;l=this.g.Sb(l))for(var s=this.g.Ya(l),a=0,u=this.g.Ka(l);a<u;a++,s=this.g.V(s))this.g.D(s,p),(this.Da.v==p.x||this.Da.C==p.x||this.Da.G==p.y||this.Da.H==p.y)&&(this.g.Sa(s,this.li,this.ed.size),this.ed.add(s));this.Pl(!1,this.Da.v),this.Pl(!1,this.Da.C),this.Pl(!0,this.Da.G),this.Pl(!0,this.Da.H),this.Oy()},S.prototype.Hy=function(p){for(var l=new d.h,s=new d.h,a=null,u=null,f=d.P.mg(2048,0),y=this.g.Ob(this.Y);y!=-1;y=this.g.Sb(y)){var v=this.g.Ya(y),_=v;do{var M=this.g.V(_);this.g.D(_,l);var $=-1;if(l.x==this.Da.v?(this.g.D(M,s),s.x==this.Da.v&&($=1)):l.x==this.Da.C&&(this.g.D(M,s),s.x==this.Da.C&&($=1)),l.y==this.Da.G?(this.g.D(M,s),s.y==this.Da.G&&($=0)):l.y==this.Da.H&&(this.g.D(M,s),s.y==this.Da.H&&($=0)),$!=-1){if(a==null&&(a=new d.h),u==null&&(u=new d.h),a.N(l),u.na(0,0),$==0){var T=l.x-this.Da.v;u.x=d.mc.sign(s.x-l.x),a.x=p*d.mc.En(Math.floor(Math.abs(T/p)),T)+this.Da.v,0>a.x&&(a.x+=p)}else T=l.y-this.Da.G,u.y=d.mc.sign(s.y-l.y),a.y=p*d.mc.En(Math.floor(Math.abs(T/p)),T)+this.Da.G,0>a.y&&(a.y+=p);T=$!=0?s.y-l.y:s.x-l.x;var A=Math.abs(T);if(65536<A/p)throw d.i.ga("internal error");if(0<A){A=d.P.truncate(A/p)+2,f.length<A&&(f=d.P.mg(A));for(var R=A=0;;R++){var D=new d.h;if(D.x=a.x+u.x*R*p,D.y=a.y+u.y*R*p,1<=(D=($!=0?D.y-l.y:D.x-l.x)/T))break;0>=D||(f[A]=D,A++)}A!=0&&this.g.Wl(_,f,A)}}_=M}while(_!=v)}},S.prototype.Xl=function(p,l){for(var s=-1,a=new d.h,u=null,f=this.g.Ob(this.Y);f!=-1;f=this.g.Sb(f))for(var y=this.g.Ya(f),v=0,_=this.g.Ka(f);v<_;v++){var M=this.g.V(y);this.g.D(y,a),(p?a.y==l:a.x==l)&&(this.g.D(M,a),(p?a.y==l:a.x==l)&&(s==-1&&(s=this.g.Hd()),u==null&&(u=new d.ja(0)).Jb(100),this.g.Qa(y,s)!=1&&(u.add(y),this.g.Sa(y,s,1)),this.g.Qa(M,s)!=1&&(u.add(M),this.g.Sa(M,s,1)))),y=M}if(s!=-1&&this.g.Ud(s),!(u==null||3>u.size)){var $=this;u.Wd(0,u.size,function(se,ge){return $.Oh(se,ge)}),s=new d.h,f=new d.h,y=new d.h,f.Sc();var T=-1;v=new d.ja(0),_=new d.ja(0),M=null;for(var A=this.g.Hd(),R=this.g.Hd(),D=0,V=u.size;D<V;D++){var Z=u.get(D);if(this.g.D(Z,a),!a.rb(f)){if(T!=-1){for(var ee=T;ee<D;ee++){T=u.get(ee);var G=this.g.V(T);Z=this.g.Na(T);var re=!1;this.g.D(G,s),0>f.compare(s)&&(p?s.y==l:s.x==l)&&(v.add(T),re=!0,this.g.Sa(T,R,1)),this.g.D(Z,s),0>f.compare(s)&&(p?s.y==l:s.x==l)&&(re||v.add(T),this.g.Sa(T,A,1))}for(ee=0,re=v.size;ee<re;ee++){if(T=v.get(ee),Z=this.g.Qa(T,A),G=this.g.Qa(T,R),Z==1&&(Z=this.g.Na(T),this.g.D(Z,y),!y.rb(a))){M==null&&(M=[]);var oe=d.h.ub(f,y);M[0]=d.h.ub(y,a)/oe,M[0]==0?M[0]=2220446049250313e-31:M[0]==1&&(M[0]=.9999999999999998),this.g.Wl(Z,M,1),Z=this.g.Na(T),this.g.mf(Z,a),_.add(Z),this.g.Sa(Z,A,1),this.g.Sa(Z,R,-1)}G==1&&(G=this.g.V(T),this.g.D(G,y),y.rb(a)||(M==null&&(M=[]),oe=d.h.ub(f,y),M[0]=d.h.ub(f,a)/oe,M[0]==0?M[0]=2220446049250313e-31:M[0]==1&&(M[0]=.9999999999999998),this.g.Wl(T,M,1),Z=this.g.V(T),this.g.mf(Z,a),_.add(Z),this.g.Sa(Z,A,-1),this.g.Sa(Z,R,1)))}T=v,v=_,(_=T).clear(!1)}T=D,f.N(a)}}this.g.Ud(A),this.g.Ud(R)}},S.prototype.Pl=function(p,l){for(var s=new d.h,a=null,u=-1,f=0,y=this.ed.size;f<y;f++){var v=this.ed.get(f);if(v!=-1){var _=this.g.V(v);this.g.D(v,s),(p?s.y==l:s.x==l)&&(this.g.D(_,s),(p?s.y==l:s.x==l)&&(u==-1&&(u=this.g.Hd()),a==null&&(a=new d.ja(0)).Jb(100),this.g.Qa(v,u)!=-2&&(a.add(v),this.g.Sa(v,u,-2)),this.g.Qa(_,u)!=-2&&(a.add(_),this.g.Sa(_,u,-2))))}}if(a==null)u!=-1&&this.g.Ud(u);else{var M=this;for(a.Wd(0,a.size,function(ge,me){return M.Oh(ge,me)}),f=0,y=a.size;f<y;f++){var $=a.get(f);this.g.Sa($,u,f)}v=new d.h,(_=new d.h).Sc();var T=-1;for(f=0,y=a.size;f<y;f++)if(($=a.get(f))!=-1&&(this.g.D($,s),!s.rb(_))){if(T!=-1)for(;;){$=!1;for(var A=1<f-T?f-1:f,R=T;R<A;R++){var D=a.get(R);if(D!=-1){var V=-1,Z=this.g.V(D);this.g.D(Z,v),0>_.compare(v)&&(p?v.y==l:v.x==l)&&(V=Z),Z=-1;var ee=this.g.Na(D);if(this.g.D(ee,v),0>_.compare(v)&&(p?v.y==l:v.x==l)&&(Z=ee),V!=-1&&Z!=-1)this.Mh(D,a,u),this.g.qd(D,!1),this.Mh(V,a,u),this.g.qd(V,!1),$=!0;else if(V!=-1||Z!=-1){for(ee=R+1;ee<f;ee++){var G=a.get(ee);if(G!=-1){var re=this.g.V(G),oe=-1;this.g.D(re,v),0>_.compare(v)&&(p?v.y==l:v.x==l)&&(oe=re),re=this.g.Na(G);var se=-1;if(this.g.D(re,v),0>_.compare(v)&&(p?v.y==l:v.x==l)&&(se=re),oe!=-1&&se!=-1){this.Mh(G,a,u),this.g.qd(G,!1),this.Mh(oe,a,u),this.g.qd(oe,!1),$=!0;break}if(V!=-1&&se!=-1){this.At(a,D,V,G,se,u),$=!0;break}if(Z!=-1&&oe!=-1){this.At(a,G,oe,D,Z,u),$=!0;break}}}if($)break}}}if(!$)break}T=f,_.N(s)}this.g.Ud(u)}},S.prototype.Mh=function(p,l,s){s=this.g.Qa(p,s),l.set(s,-1),s=this.g.Qa(p,this.li),this.ed.set(s,-1),(l=this.g.cd(p))!=-1&&this.g.Ya(l)==p&&(this.g.Kf(l,-1),this.g.Yg(l,-1))},S.prototype.At=function(p,l,s,a,u,f){this.g.Cc(l,a),this.g.Dc(a,l),this.g.Dc(s,u),this.g.Cc(u,s),this.Mh(a,p,f),this.g.oi(a,!1),this.Mh(u,p,f),this.g.oi(u,!0)},S.prototype.Oy=function(){for(var p=0,l=this.ed.size;p<l;p++){var s=this.ed.get(p);s!=-1&&this.g.cj(s,-1)}for(var a=0,u=0,f=this.g.Ob(this.Y);f!=-1;){var y=this.g.Ya(f);if(y==-1||f!=this.g.cd(y)){var v=f;f=this.g.Sb(f),this.g.Kf(v,-1),this.g.br(v)}else{s=y,v=0;do this.g.cj(s,f),v++,s=this.g.V(s);while(s!=y);this.g.fp(f,!1),this.g.Yg(f,this.g.Na(y)),this.g.Xj(f,v),u+=v,a++,f=this.g.Sb(f)}}for(p=0,l=this.ed.size;p<l;p++)if((s=this.ed.get(p))!=-1&&(f=this.g.cd(s))==-1){f=this.g.wf(this.Y,-1),v=0,y=s;do this.g.cj(s,f),v++,s=this.g.V(s);while(s!=y);2>=v?(s=this.g.Qa(y,this.li),this.ed.set(s,-1),y=this.g.qd(y,!1),v==2&&(0<=(s=this.g.Qa(y,this.li))&&this.ed.set(s,-1),this.g.qd(y,!1)),v=f,this.g.Kf(v,-1),this.g.br(v)):(this.g.mn(f,!0),this.g.Xj(f,v),this.g.Kf(f,y),this.g.Yg(f,this.g.Na(y)),this.g.fp(f,!1),u+=v,a++)}for(this.g.Tl(this.Y,a),this.g.Vj(this.Y,u),p=0,l=this.g.md;l!=-1;l=this.g.ve(l))p+=this.g.I(l);this.g.XB(p)},S.wy=function(p,l,s,a){return new S(l,a).vy(p,s)},S.clip=function(p,l,s,a,u){return S.Pu(p,l,null,s,a,u)},S.Pu=function(p,l,s,a,u,f){var y=p.K();if(y==33)return u=p.D(),l.contains(u)?p:p.Ja();if(y==197)return u=new d.l,p.A(u),u.Fa(l)?(l=new d.Hh,p.copyTo(l),l.Zo(u),l):p.Ja();if(p.B())return p;if(l.B())return p.Ja();var v=new d.l;if(p.yc(v),l.contains(v))return p;if(!l.isIntersecting(v))return p.Ja();if((s!=null||isNaN(a))&&d.ua.oy(s,l,!1),!d.ba.zj(y))throw d.i.O();if((s=p.Cb)!=null&&(s=s.Hk)!=null){if((s=s.To(l))==1){if(y!=1736)throw d.i.ga("internal error");return(p=new d.Ea(p.description)).vp(l),p}if(s==0)return p.Ja()}switch(y){case 550:for(f=null,y=p.I(),s=p.vb(0),a=0,u=new d.h,v=0;v<y;v++)s.uc(2*v,u),l.contains(u)||(a==0&&(f=p.Ja()),a<v&&f.Gd(p,a,v),a=v+1);return 0<a&&f.Gd(p,a,y),a==0?p:f;case 1736:case 1607:return S.wy(p,l,u,f);default:throw d.i.ga("internal error")}},S.prototype.Oh=function(p,l){var s=new d.h;return this.g.D(p,s),p=new d.h,this.g.D(l,p),s.compare(p)},S}();d.ti=O}(Q||(Q={})),function(d){var O=new d.h,S=function(){function l(s,a,u,f,y){this.Rm=new d.h,this.Fk=new d.h,this.Ri=new d.h,this.g=s,this.Cw=u,this.po=f,this.Rm=a,this.Al=y,this.Fk.Sc(),this.Ri.Sc()}return l.prototype.sE=function(s){this.g.D(s,this.Fk),s=d.P.truncate((this.Fk.x-this.Rm.x)*this.po+.5);var a=d.P.truncate((this.Fk.y-this.Rm.y)*this.po+.5);return p.eG(s,a)},l.prototype.ez=function(s){return this.g.Qa(s,this.Al)},l.prototype.Ky=function(s,a){return this.g.D(s,this.Fk),this.g.D(a,this.Ri),p.Ev(this.Fk.x,this.Fk.y,this.Ri.x,this.Ri.y,this.Cw)},l}();d.oY=function(){};var p=function(){function l(){this.Rm=new d.h,this.rq=[0,0,0,0],this.zs=[0,0,0,0],this.so=this.Al=-1}return l.dQ=function(s,a){var u=new l;return u.g=s,u.ra=a,u.Cw=a*a,u.bw=2*a,u.po=1/u.bw,u.wO()},l.Ev=function(s,a,u,f,y){return(s-=u)*s+(a-=f)*a<=y},l.eG=function(s,a){return d.P.Vh(a,d.P.Vh(s))},l.prototype.yO=function(s,a){this.g.Hc(s,O);for(var u=(O.y-this.Rm.y)*this.po,f=d.P.truncate((O.x-this.Rm.x)*this.po),y=d.P.truncate(u),v=u=0;1>=v;v+=1)for(var _=0;1>=_;_+=1){var M=l.eG(f+v,y+_),$=this.zl.lR(M);$!=-1&&(this.rq[u]=$,this.zs[u]=M,u++)}for(f=u-1;1<=f;f--)for($=this.rq[f],y=f-1;0<=y;y--)if($==this.rq[y]){this.zs[y]=-1,f!=--u&&(this.zs[f]=this.zs[u],this.rq[f]=this.rq[u]);break}for(y=0;y<u;y++)this.zO(s,this.zs[y],O,this.rq[y],a)},l.prototype.zO=function(s,a,u,f,y){for(var v=new d.h;f!=-1;f=this.zl.zR(f)){var _=this.zl.ka(f);s==_||a!=-1&&this.g.Qa(_,this.Al)!=a||(this.g.Hc(_,v),l.Ev(u.x,u.y,v.x,v.y,this.Cw)&&y.add(f))}},l.prototype.Zm=function(s,a,u){var f=this.g.Qa(s,this.so),y=this.g.Qa(a,this.so);return f==-1&&(f=this.Ad.Rh(),this.Ad.addElement(f,s),this.g.Sa(s,this.so,f)),y==-1?this.Ad.addElement(f,a):this.Ad.Cy(f,y),this.g.Sa(a,this.so,-2),a=this.TT(s,a),u&&(u=this.mw.sE(s),this.g.Sa(s,this.Al,u)),a},l.RT=function(s,a,u){s.Nb(a),u=s;var f=new d.h;l.ST(s.D(),a.D(),f),u.Db(f)},l.ST=function(s,a,u){var f=s.x;s.x!=a.x&&(f=(1*s.x+1*a.x)/2);var y=s.y;s.y!=a.y&&(y=(1*s.y+1*a.y)/2),u.na(f,y)},l.prototype.TT=function(s,a){var u=new d.h;this.g.D(s,u);var f=new d.h;this.g.D(a,f);var y=this.g.YF(s),v=y+(a=this.g.YF(a)),_=0,M=u.x;u.x!=f.x&&(M=(u.x*y+f.x*a)/v,_++);var $=u.y;return u.y!=f.y&&($=(u.y*y+f.y*a)/v,_++),0<_&&this.g.Db(s,M,$),this.g.rX(s,v),_!=0},l.prototype.wO=function(){var s=this.g.gd,a=this.g.DF();for(this.Rm=a.hz(),a=Math.max(a.da(),a.S())/2147483646,this.bw<a&&(this.bw=a,this.po=1/this.bw),this.Ad=new d.cu,this.Ad.Bt(d.P.truncate(this.g.gd/3+1)),this.Ad.hn(d.P.truncate(this.g.gd/3+1)),this.Al=this.g.Hd(),this.so=this.g.Hd(),this.mw=new S(this.g,this.Rm,this.Cw,this.po,this.Al),this.zl=new d.ZK(d.P.truncate(4*s/3),this.mw),this.zl.vW(this.g.gd),s=!1,a=this.g.md;a!=-1;a=this.g.ve(a))for(var u=this.g.Ob(a);u!=-1;u=this.g.Sb(u))for(var f=this.g.Ya(u),y=0,v=this.g.Ka(u);y<v;y++){var _=this.mw.sE(f);this.g.Sa(f,this.Al,_),this.zl.addElement(f,_),f=this.g.V(f)}var M=new d.ja(0);for(M.Jb(10),a=this.g.md;a!=-1;a=this.g.ve(a))for(u=this.g.Ob(a);u!=-1;u=this.g.Sb(u))for(f=this.g.Ya(u),y=0,v=this.g.Ka(u);y<v;y++){if(this.g.Qa(f,this.so)!=-2)for(_=this.g.Qa(f,this.Al),this.zl.kd(f,_);this.yO(f,M),M.size!=0;){_=!1;for(var $=0,T=M.size;$<T;$++){var A=M.get($),R=this.zl.ka(A);this.zl.wd(A),_=this.Zm(f,R,$+1==T)||_}if(s=s||_,M.clear(!1),!_)break}f=this.g.V(f)}return s&&this.qN(),this.mw=this.zl=null,this.g.Ud(this.Al),this.g.Ud(this.so),s},l.prototype.qN=function(){for(var s=new d.h,a=this.Ad.ke;a!=-1;a=this.Ad.lz(a)){var u=this.Ad.sc(a);for(this.g.D(this.Ad.ka(u),s),u=this.Ad.lb(u);u!=-1;u=this.Ad.lb(u))this.g.mf(this.Ad.ka(u),s)}},l}();d.$t=p}(Q||(Q={})),function(d){var O=function(){function S(p){p===void 0&&(p=null),this.zg=null,this.Pb=!1,this.zg=p===null?[]:p}return S.prototype.copyTo=function(p){if(p.Pb)throw d.i.ga("CompositeGeographicTransformation is read-only");for(var l=0;l<this.zg.length;l++)p.zg.push(this.zg[l].Qf())},S.prototype.count=function(){return this.zg.length},S.prototype.add=function(p){if(this.Pb)throw d.i.ga("CompositeGeographicTransformation is read-only");this.zg.push(p.Qf())},S.prototype.clear=function(){if(this.Pb)throw d.i.ga("CompositeGeographicTransformation is read-only");this.zg.length=0},S.prototype.remove=function(p){if(this.Pb)throw d.i.ga("CompositeGeographicTransformation is read-only");this.zg.splice(p,1)},S.prototype.kg=function(){var p=new S;return this.copyTo(p),p},S.prototype.Qf=function(){return this.kg()},S.prototype.transform=function(p,l,s,a){if(p.length<l)throw d.i.ga("invalid Argument");var u=s;for(s=0;s<this.zg.length;s++){var f=this.zg[s];if(f.sm()!=null){var y=f.Wn,v=y?1:0,_=y?f.sm().getGeogcs2():f.sm().getGeogcs1();if(_=u/(_=_.getUnit().getUnitFactor()),3552713678800501e-30<Math.abs(_-1))for(u=0;u<l;u++)p[u][0]*=_,p[u][1]*=_;d.HC.geogToGeog(f.sm(),l,p,null,v),u=(y?f.sm().getGeogcs1():f.sm().getGeogcs2()).getUnit().getUnitFactor()}}if(_=u/a,3552713678800501e-30<Math.abs(_-1))for(u=0;u<l;u++)p[u][0]*=_,p[u][1]*=_;return l},S.prototype.Nb=function(p){if(p==this)return!0;if(!(p instanceof S)||this.zg.length!=p.zg.length)return!1;for(var l=0;l<this.zg.length;l++)if(!this.zg[l].Nb(p.zg[l]))return!1;return!0},S.prototype.ix=function(){this.Pb=!0},S.prototype.toString=function(){for(var p="CGT ("+this.count()+") ",l=0,s=this.count();l<s;++l)p+=this.zg[l].toString()+", ";return 200<p.length?p.substring(0,197)+"... ("+p.length.toString()+" characters)":p},S.create=function(){return new S},S}();d.rC=O}(Q||(Q={})),function(d){var O,S=Math.PI,p=2*Math.PI,l=Math.PI/2,s=function(){function f(){}return f.OO=function(y,v){var _=new f;return _.x=y,_.y=v,_.type=0,_.Wh=0,_},f.cl=function(y){var v=new f;return v.x=y.x,v.y=y.y,v.type=0,v.Wh=0,v},f.NO=function(y){var v=new f;return v.x=y.x,v.y=y.y,v.type=y.type,v.Wh=y.Wh,v},f.Qd=function(y,v,_){var M=new f;return M.x=y.x+v*Math.cos(_),M.y=y.y+v*Math.sin(_),M.type=y.type,M.Wh=y.Wh,M},f.Ru=function(y,v){var _=new f;return _.x=.5*(y.x+v.x),_.y=.5*(y.y+v.y),_.type=y.type,_.Wh=y.Wh,_},f.OE=function(y,v){var _=new f;return _.x=y.x+.001*(v.x-y.x),_.y=y.y+.001*(v.y-y.y),_.type=y.type,_.Wh=y.Wh,_},f}(),a=function(){};(O=d.aL||(d.aL={}))[O.Round=0]="Round",O[O.Bevel=1]="Bevel",O[O.Miter=2]="Miter",O[O.Square=3]="Square";var u=function(){function f(y){this.IA=this.Zb=this.xg=null,this.od=y}return f.W=function(y,v,_,M,$,T){if(y==null||1>y.Eb())throw d.i.O();return v==0||y.B()?y:((T=new f(T)).mo=y,T.La=v,T.ra=$,T.Mi=_,T.xA=M,T.Qx())},f.prototype.$L=function(){var y=this.mo,v=y.bc(),_=y.xc(),M=new d.h;return M.vc(_,v),M.normalize(),M.Jv(),M.scale(this.La),v.add(M),_.add(M),M=y.Ja(),y.Ec(v),y.Rc(_),M},f.prototype.ZL=function(){var y=this.mo;if(0<this.La&&this.Mi!=2){var v=new d.Ea;return v.bd(y,!1),this.mo=v,this.Qx()}return(y=new d.Hh(y.aa)).X(this.La,this.La),y},f.prototype.oJ=function(y,v,_,M){return(v.x-y.x)*(M.x-_.x)+(v.y-y.y)*(M.y-_.y)},f.prototype.hc=function(y,v){if(v===void 0)this.Zb.push(y),this.gf++;else if(this.gf==0)this.hc(y);else{var _=this.Dw,M=this.xg[v==0?_-1:v-1],$=this.xg[v],T=this.oJ(M,$,this.Zb[this.gf-1],y);0<T?this.hc(y):0>T&&(0<this.oJ(M,$,$,this.Zb[this.gf-1])?($=this.xg[v==0?_-2:v==1?_-1:v-2],_=s.Qd(M,this.La,Math.atan2(M.y-$.y,M.x-$.x)-l),this.Zb[this.gf-1]=_,this.Mi==1||this.Mi==2?(_=s.Ru(_,M),this.hc(_),_=s.Qd(M,this.La,this.Lv+l),(M=s.Ru(_,M)).type|=256,this.hc(M)):(_=s.Qd(M,this.La,this.Lv+l)).type|=256,this.hc(_),this.hc(y,v)):(_=s.Qd($,this.La,this.Lv+l),this.hc(_),this.Mi==1||this.Mi==2?(_=s.Ru(_,$),this.hc(_),_=s.Qd($,this.La,this.Wz-l),(M=s.Ru(_,$)).type|=256,this.hc(M)):(_=s.Qd($,this.La,this.Wz-l)).type|=256,this.hc(_)))}},f.prototype.hE=function(){var y,v=this.Dw;this.gf=0;var _=.5*this.ra,M=0,$=0;for(y=0;y<v;y++){var T=this.xg[y],A=y==0?this.xg[v-1]:this.xg[y-1],R=y==v-1?this.xg[0]:this.xg[y+1],D=A.x-T.x,V=A.y-T.y,Z=R.x-T.x,ee=R.y-T.y,G=Math.atan2(V,D),re=Math.atan2(ee,Z);if(this.Lv=G,this.Wz=re,y==0&&(M=G,$=re),D=D*ee-Z*V,V=re,re<G&&(re+=p),0<D*this.La)this.Mi==1||this.Mi==2?(G=s.Qd(T,this.La,G+l),this.hc(G),G=s.OE(T,G),this.hc(G),G=s.Qd(T,this.La,re-l),(T=s.OE(T,G)).type|=256,this.hc(T),this.hc(G)):(D=.5*(re-G),D=this.La/Math.abs(Math.sin(D)),G=s.Qd(T,D,.5*(G+re)),this.hc(G,y));else if((512&T.type)!=0){for(D=1-_/Math.abs(this.La),A=1,R=0>this.La?-S:S,-1<D&&1>D&&(.017453292519943295>(V=2*Math.acos(D))&&(V=.017453292519943295),1<(A=d.P.truncate(S/V+1.5))&&(R/=A)),V=G+l,G=s.Qd(T,this.La,V),y==0&&(G.type|=1024),this.hc(G,y),D=this.La/Math.cos(R/2),V+=R/2,(G=s.Qd(T,D,V)).type|=1024,this.hc(G);0<--A;)V+=R,(G=s.Qd(T,D,V)).type|=1024,this.hc(G);(G=s.Qd(T,this.La,re-l)).type|=1024,this.hc(G)}else if(this.Mi==1)G=s.Qd(T,this.La,G+l),this.hc(G,y),G=s.Qd(T,this.La,re-l),this.hc(G);else if(this.Mi==0)for(D=1-_/Math.abs(this.La),A=1,R=re-l-(G+l),-1<D&&1>D&&(.017453292519943295>(V=2*Math.acos(D))&&(V=.017453292519943295),1<(A=d.P.truncate(Math.abs(R)/V+1.5))&&(R/=A)),D=this.La/Math.cos(.5*R),V=G+l+.5*R,G=s.Qd(T,D,V),this.hc(G,y);0<--A;)V+=R,G=s.Qd(T,D,V),this.hc(G);else this.Mi==2?(D=A.x-T.x,V=A.y-T.y,.99999999<(A=(D*(Z=R.x-T.x)+V*(ee=R.y-T.y))/Math.sqrt(D*D+V*V)/Math.sqrt(Z*Z+ee*ee))?(G=s.Qd(T,1.4142135623730951*this.La,re-.25*S),this.hc(G,y),G=s.Qd(T,1.4142135623730951*this.La,re+.25*S),this.hc(G)):(A=Math.abs(this.La/Math.sin(.5*Math.acos(A))))>(R=Math.abs(this.xA*this.La))?(D=.5*(re-G),D=this.La/Math.abs(Math.sin(D)),G=s.Qd(T,D,.5*(G+re)),re=d.h.construct(G.x,G.y),G=d.h.construct(T.x,T.y),(T=new d.h).vc(re,G),(re=new d.h).BW(R/T.length(),T,G),G=(A-R)*Math.abs(this.La)/Math.sqrt(A*A-this.La*this.La),0<this.La?T.Jv():T.cr(),T.scale(G/T.length()),(G=new d.h).add(re,T),(A=new d.h).vc(re,T),G=s.cl(G),this.hc(G,y),G=s.cl(A),this.hc(G)):(D=.5*(re-G),D=this.La/Math.abs(Math.sin(D)),G=s.Qd(T,D,.5*(G+re)),this.hc(G,y))):(re=V,0<this.La?(re>G&&(re-=p),A=G-re<l):(re<G&&(re+=p),A=re-G<l),A?(V=0>(D=1.4142135623730951*this.La)?G+.25*S:G+.75*S,G=s.Qd(T,D,V),this.hc(G,y),V=0>D?re-.25*S:re-.75*S,G=s.Qd(T,D,V),this.hc(G)):(D=.5*(re-G),D=this.La/Math.abs(Math.sin(D)),re<G&&(re+=p),G=s.Qd(T,D,(G+re)/2),this.hc(G,y)))}return this.Lv=M,this.Wz=$,this.hc(this.Zb[0],0),T=s.NO(this.Zb[this.gf-1]),this.Zb[0]=T,this.rW()},f.prototype.Cu=function(y,v){if(!(2>v))for(var _=0;_<v;_++){var M=this.Zb[y+_];_!=0?this.IA.Ei(d.h.construct(M.x,M.y)):this.IA.Nt(d.h.construct(M.x,M.y))}},f.prototype.aM=function(y,v,_){var M=y.Ca(v),$=y.Wc(v);if(this.Zb=[],this.IA=_,y.ec(v)){for(v=y.Oa(M);y.Oa($-1).rb(v);)$--;if(2<=$-M){for(this.Dw=$-M,this.xg=[],v=M;v<$;v++)this.xg.push(s.cl(y.Oa(v)));this.hE()&&this.Cu(0,this.gf-1)}}else{for(v=y.Oa(M);M<$&&y.Oa(M+1).rb(v);)M++;for(v=y.Oa($-1);M<$&&y.Oa($-2).rb(v);)$--;if(2<=$-M){for(this.Dw=2*($-M)-2,this.xg=[],(_=s.cl(y.Oa(M))).type|=1536,this.xg.push(_),v=M+1;v<$-1;v++)_=s.cl(y.Oa(v)),this.xg.push(_);for((_=s.cl(y.Oa($-1))).type|=512,this.xg.push(_),v=$-2;v>=M+1;v--)(_=s.cl(y.Oa(v))).type|=1024,this.xg.push(_);if(this.hE())if(2<=this.Zb.length){for(y=-1,($=(1024&this.Zb[this.gf-1].type)!=0)||(y=0),v=1;v<this.gf;v++)(M=(1024&this.Zb[v].type)!=0)?$||1<($=v-1)-y+1&&this.Cu(y,$-y+1):$&&(y=v-1),$=M;$||1<($=this.gf-1)-y+1&&this.Cu(y,$-y+1)}else y=0,$=this.gf-1,0<=y&&1<=$-y&&this.Cu(y,$-y+1)}}this.xg=null,this.Dw=0,this.Zb=null,this.gf=0},f.prototype.rW=function(){for(var y=!1,v=0;v<this.gf;v++){var _=this.Zb[v];_.sh=v+1,_.uh=v-1,this.Zb[v]=_}for((_=this.Zb[0]).uh=this.gf-2,this.Zb[0]=_,(_=this.Zb[this.gf-2]).sh=0,this.Zb[this.gf-2]=_,v=_=0;v<this.gf;v++)if((256&this.Zb[_].type)!=0){var M=this.BP(_);if(M==-1){y=!0;break}_=M}else _=this.Zb[_].sh;return!y&&(this.LO(_),!0)},f.prototype.BP=function(y){for(var v,_,M=this.gf-1,$=y,T=1;T<=M-2;T++){v=$=this.Zb[$].sh,_=y;for(var A=1;A<=T;A++){if(_=this.Zb[_].uh,(256&this.Zb[_].type)==0&&(256&this.Zb[v].type)==0){var R=this.bS(_,v);if(R!=-1)return R}v=this.Zb[v].uh}}return-1},f.prototype.bS=function(y,v){var _=this.Zb[this.Zb[y].uh],M=this.Zb[y],$=this.Zb[this.Zb[v].uh],T=this.Zb[v];if(!this.EW(_,M,$,T))return-1;var A=new a;return this.sQ(_,M,$,T,A)&&!A.XD&&d.P.XJ((M.x-_.x)*(T.y-$.y)-(M.y-_.y)*(T.x-$.x))!=d.P.XJ(this.La)?(_=this.Zb[y].uh,A.cn.type=M.type,A.cn.sh=v,A.cn.uh=_,this.Zb[y]=A.cn,A.cn=this.Zb[v],A.cn.uh=y,this.Zb[v]=A.cn,v):-1},f.prototype.EW=function(y,v,_,M){return Math.max(y.x,v.x)>=Math.min(_.x,M.x)&&Math.max(_.x,M.x)>=Math.min(y.x,v.x)&&Math.max(y.y,v.y)>=Math.min(_.y,M.y)&&Math.max(_.y,M.y)>=Math.min(y.y,v.y)},f.prototype.sQ=function(y,v,_,M,$){$.XD=!1;var T=(v.y-y.y)*(M.x-_.x)-(v.x-y.x)*(M.y-_.y),A=(_.y-y.y)*(v.x-y.x)-(_.x-y.x)*(v.y-y.y);if(0<=(T=T==0?2:A/T)&&1>=T){var R=T;if(T=(M.y-_.y)*(v.x-y.x)-(M.x-_.x)*(v.y-y.y),A=(y.y-_.y)*(M.x-_.x)-(y.x-_.x)*(M.y-_.y),0<=(T=T==0?2:A/T)&&1>=T)return $.cn=s.OO(y.x+T*(v.x-y.x),y.y+T*(v.y-y.y)),$.cn.Wh=_.Wh+R*(M.Wh-_.Wh),R!=0&&R!=1||T!=0&&T!=1||($.XD=!0),$.RY=T,$.SY=R,!((R==0||R==1)&&0<T&&1>T||(T==0||T==1)&&0<R&&1>R)}return!1},f.prototype.LO=function(y){for(;this.Zb[y].uh<y;)y=this.Zb[y].uh;var v=0,_=y;do _=this.Zb[_],this.Zb[v]=_,_=_.sh,v++;while(_!=y);this.Zb[v]=this.Zb[0],this.gf=v+1},f.prototype.VC=function(y){var v=this.mo,_=v.Ha();if(_!=null){_.aj();for(var M=-1;_.ab();)M++,this.aM(v,M,y)}},f.prototype.Qx=function(){var y=this.mo.K();return y==322?this.$L():y==197?this.ZL():d.ba.zd(y)?((y=new d.Ua).pc(this.mo,!0),this.mo=y,this.Qx()):y==1607?(y=new d.Ua,this.VC(y),y):y==1736?(y=new d.Ea,this.VC(y),y):null},f}();d.DK=u}(Q||(Q={})),function(d){var O=function(){function s(a){this.sk=a}return s.prototype.D=function(a,u){this.sk.g.D(a,u)},s.prototype.wd=function(a){var u=this.sk.Ga.ka(a);this.sk.Ga.wd(a,-1),this.sk.g.qd(u,!1)},s}(),S=function(){function s(a){this.sk=a}return s.prototype.D=function(a,u){this.sk.DT.D(a,u)},s.prototype.wd=function(a){this.sk.Ga.wd(a,-1)},s}(),p=function(){function s(a){this.sk=a}return s.prototype.D=function(a,u){u.N(this.sk.GT[a])},s.prototype.wd=function(a){this.sk.Ga.wd(a,-1)},s}(),l=function(){function s(a){a===void 0?(this.Ga=new d.$j,this.Ga.Ee(20),this.g=new d.hd,this.sT=this.g.Kg(550),this.Us=this.g.wf(this.sT,-1),this.Zh=new O(this)):a instanceof Array?(this.Ga=new d.$j,this.Ga.Ee(20),this.GT=a,this.Zh=new p(this)):(this.Ga=new d.$j,this.Ga.Ee(20),this.DT=a,this.Zh=new S(this))}return s.prototype.Ib=function(a){var u=a.K();if(d.Fx.zj(u))this.eN(a);else if(d.Xk.zd(u))this.jN(a);else if(u==197)this.bN(a);else{if(u!=33)throw d.i.O("invalid shape type");this.iN(a)}},s.prototype.YQ=function(){var a=new d.Ta,u=this.Ga.sc(-1),f=new d.Ea(this.g.it);for(this.g.Xi(this.Ga.ka(u),a),f.nf(a),u=this.Ga.lb(u);u!=-1;u=this.Ga.lb(u))this.g.Xi(this.Ga.ka(u),a),f.lineTo(a);return f},s.MO=function(a){var u=new s(a),f=a.I(),y=1,v=new d.h,_=new d.h,M=new d.h;for(a.D(0,v);a.D(y,_),_.Mz(v)&&y<f-1;)y++;for(u.Ga.addElement(0,-1),u.Ga.zn(y),f=y+1;f<a.I();f++)a.D(f,M),(y=u.kC(M))!=-1&&u.Ga.Uj(y,f);for(M=new d.Ta,y=u.Ga.sc(-1),f=new d.Ea(a.description),a.we(u.Ga.ka(y),M),f.nf(M),y=u.Ga.lb(y);y!=-1;y=u.Ga.lb(y))a.we(u.Ga.ka(y),M),f.lineTo(M);return f},s.construct=function(a,u,f){for(var y=new s(a),v=1,_=a[0];a[v].Mz(_)&&v<u-1;)v++;for(y.Ga.addElement(0,-1),y.Ga.zn(v),v+=1;v<u;v++)(_=y.kC(a[v]))!=-1&&y.Ga.Uj(_,v);for(a=0,u=y.Ga.sc(-1);u!=-1;u=y.Ga.lb(u))f[a++]=y.Ga.ka(u);return a},s.EG=function(a,u){var f=a.Ca(u),y=a.Wc(u);if(u=!a.ec(u)&&a.Pn(u),a=a.vb(0),y*=2,u&&(y-=2),6>y-(f*=2))return!0;u=new d.h;var v=new d.h,_=new d.h;a.uc(f,u),a.uc(f+2,v),a.uc(f+4,_);var M=s.Yu(v,_,u);if(M.rs()||!s.wm(M.value()))return!1;var $=d.h.construct(v.x,v.y),T=new d.h;for(f+=6;f<y;f+=2)if(T.N(v),v.N(_),a.uc(f,_),(M=s.Yu(v,_,u)).rs()||!s.wm(M.value())||(M=s.Yu($,_,u)).rs()||!s.wm(M.value())||(M=s.Yu(v,_,T)).rs()||!s.wm(M.value()))return!1;return!0},s.prototype.eN=function(a){for(var u=new d.Ta,f=new d.h,y=0;y<a.I();y++){a.D(y,f);var v=this.Er(f);if(v!=-1){a.we(y,u);var _=this.g.hc(this.Us,u);this.Ga.Uj(v,_)}}},s.prototype.bN=function(a){for(var u=new d.Ta,f=new d.h,y=0;4>y;y++){a.hB(y,f);var v=this.Er(f);if(v!=-1){a.If(y,u);var _=this.g.hc(this.Us,u);this.Ga.Uj(v,_)}}},s.prototype.jN=function(a){var u=new d.Ta,f=a.bc();if((f=this.Er(f))!=-1){a.Vo(u);var y=this.g.hc(this.Us,u);this.Ga.Uj(f,y)}f=a.xc(),(f=this.Er(f))!=-1&&(a.Ro(u),a=this.g.hc(this.Us,u),this.Ga.Uj(f,a))},s.prototype.iN=function(a){var u=a.D();(u=this.Er(u))!=-1&&(a=this.g.hc(this.Us,a),this.Ga.Uj(u,a))},s.prototype.Er=function(a){var u=-1;if(this.Ga.size(-1)==0)return this.Ga.addElement(-4,-1);if(this.Ga.size(-1)==1){var f=this.g.Oa(this.Ga.ka(this.Ga.sc(-1)));return a.Mz(f)||(u=this.Ga.zn(-5)),u}return this.kC(a)},s.prototype.kC=function(a){var u=-1;do{var f=this.Ga.sc(-1),y=this.Ga.Gc(-1),v=this.Ga.ka(f),_=this.Ga.ka(y),M=new d.h,$=new d.h;if(this.Zh.D(v,M),this.Zh.D(_,$),v=d.h.Wq($,a,M),s.wm(v))u=this.Ga.zn(-1),(M=this.iC(a,y,f))!=f&&this.jC(a,f,this.Ga.xe(M));else if(s.xG(v)){$=this.Ga.uv(-1);var T=this.Ga.sc(-1),A=this.Ga.Gc(-1);for(v=new d.h,_=new d.h;T!=this.Ga.xe(A);){var R=this.Ga.ka($);this.Zh.D(R,v),R=d.h.Wq(v,a,M),s.xG(R)?(A=$,$=this.Ga.nl($)):(T=$,$=this.Ga.Zp($))}if($=A,M=T,R=this.Ga.ka($),T=this.Ga.ka(M),this.Zh.D(R,v),this.Zh.D(T,_),M!=f&&(v=d.h.Wq(_,a,v),!s.wm(v)))continue;u=this.Ga.Bu(M,$,-2,!1),this.jC(a,$,y),this.iC(a,M,f)}else this.tb==null&&(this.tb=new d.zb),this.tb.Ec($),this.tb.Rc(M),0>(M=this.tb.ge(a,!0))?(M=this.Ga.xe(y),this.Ga.wd(y,-1),u=this.Ga.zn(-3),this.iC(a,M,f)):1<M&&(M=this.Ga.lb(f),this.Ga.wd(f,-1),u=this.Ga.Bu(-1,M,-3,!1),this.jC(a,M,y))}while(0);return u},s.prototype.jC=function(a,u,f){if(u!=f){var y=this.Ga.ka(u),v=this.Ga.lb(u),_=new d.h,M=new d.h;for(this.Zh.D(y,_);u!=f&&2<this.Ga.size(-1)&&(this.Zh.D(this.Ga.ka(v),M),y=d.h.Wq(M,a,_),!s.wm(y));)y=u,u=v,_.N(M),v=this.Ga.lb(u),this.Zh.wd(y)}},s.prototype.iC=function(a,u,f){if(u==f)return f;var y=this.Ga.ka(u),v=this.Ga.xe(u),_=new d.h,M=new d.h;for(this.Zh.D(y,_);u!=f&&2<this.Ga.size(-1)&&(this.Zh.D(this.Ga.ka(v),M),y=d.h.Wq(_,a,M),!s.wm(y));)y=u,u=v,_.N(M),v=this.Ga.xe(u),this.Zh.wd(y);return u},s.Yu=function(a,u,f){var y=new d.Xb;y.set(u.x),y.sub(a.x);var v=new d.Xb;v.set(f.y),v.sub(a.y);var _=new d.Xb;return _.set(u.y),_.sub(a.y),(u=new d.Xb).set(f.x),u.sub(a.x),y.Bg(v),_.Bg(u),y.sub(_),y},s.wm=function(a){return 0>a},s.xG=function(a){return 0<a},s}();d.au=l}(Q||(Q={})),function(d){var O=function(){function S(p){this.g=null,this.oH=!0,this.od=p}return S.uU=function(p,l,s){return p=d.ua.Gr(p),d.$t.Ev(l.Ng(),l.kh(),s.Ng(),s.kh(),d.mc.ox(p))},S.xO=function(p,l){var s=new d.Ta;return d.$t.RT(p,l,s),s},S.W=function(p,l,s,a){return(s=new S(s)).g=p,s.ra=l,s.oH=a,s.zM()},S.prototype.iM=function(p){return d.$t.dQ(this.g,p)},S.prototype.nM=function(p){return d.bu.W(this.g,p,this.od)},S.prototype.zM=function(){var p=this.ra,l=d.ua.Gr(p),s=1.00001*(p=d.ua.mN(p));p*=1.000001;for(var a=!1,u=30<this.g.gd+10?1e3:(this.g.gd+10)*(this.g.gd+10),f=0,y=this.g.eS();;f++){if(f>u)throw d.i.ga("Internal Error: max number of iterations exceeded");var v=this.iM(l);if(a=a||v,this.oH&&(v=this.g.Ip(l,!0,!1)!=0,a=a||v),v=!1,(f==0||y||d.bu.fI(!0,this.g,p,null,this.od))&&(v=this.nM(s),a=a||v),!v)break;d.op.Bp(this.od)}return a},S}();d.Vk=O}(Q||(Q={})),function(d){var O=function(){function p(l){this.ae=this.Nc=null,this.$s=0,this.Vb=l,this.Yz=!0}return p.prototype.wv=function(l,s){var a=this.g.cc(l);if(a==null){if(!this.g.fd(l,s))return null;a=s}return a},p.prototype.Zq=function(){var l;l===void 0&&(l=!1),this.$s++,(l||(4095&this.$s)==0)&&(this.$s=0,d.op.Bp(this.Vb))},p.prototype.iP=function(){var l=this.g.$q(!1),s=!1,a=new d.zb,u=new d.zb,f=new d.l;f.Pa();var y=new d.l;y.Pa();for(var v=new d.Ta,_=new d.OC,M=l.next();M!=-1;M=l.next()){d.op.Bp(this.Vb);var $=null,T=!1;if(!d.ba.Tn(this.g.jc(l.ek))){if(($=this.wv(M,a))==null)continue;if($.A(f),f.X(this.ra,this.ra),$.Di(this.ra)){if(!$.Di(0))continue;T=!0,$=null}}var A=this.g.$q(l),R=A.next();for(R!=-1&&(R=A.next());R!=-1;R=A.next()){var D=null,V=!1;if(!d.ba.Tn(this.g.jc(A.ek))){if((D=this.wv(R,u))==null)continue;if(D.A(y),D.Di(this.ra)){if(!D.Di(0))continue;V=!0,D=null}}var Z=0,ee=0;if($!=null&&D!=null)f.CG(y)&&(_.Qo($),_.Qo(D),_.Fa(this.ra,!1),0<(Z=_.ql(0))+(ee=_.ql(1))&&(this.g.lr(M,_,0,!0),this.g.lr(R,_,1,!0)),_.clear());else if($!=null){var G=new d.h;if(this.g.D(R,G),f.contains(G)){if(_.Qo($),this.g.Xi(R,v),_.Fz(this.ra,v,!1),0<(Z=_.ql(0)))if(this.g.lr(M,_,0,!0),V){for(V=-1,G=this.g.V(R);G!=-1&&G!=R&&(V=G,(D=this.wv(G,u))!=null&&D.Di(0));G=this.g.V(G));for(G=R;G!=-1&&(this.g.Fh(G,_.Cf),G!=V);G=this.g.V(G));}else this.g.Fh(R,_.Cf);_.clear()}}else{if(D==null)continue;if(G=new d.h,this.g.D(M,G),y.X(this.ra,this.ra),y.contains(G)){if(_.Qo(D),this.g.Xi(M,v),_.Fz(this.ra,v,!1),0<(ee=_.ql(0)))if(this.g.lr(R,_,0,!0),T){for(V=-1,G=this.g.V(M);G!=-1&&G!=M&&(V=G,(D=this.wv(G,u))!=null&&D.Di(0));G=this.g.V(G));for(G=M;G!=-1&&(this.g.Fh(G,_.Cf),G!=V);G=this.g.V(G));}else this.g.Fh(M,_.Cf);_.clear()}}if(Z+ee!=0){if(Z!=0){if(($=this.g.cc(M))==null){if(!this.g.fd(M,a))continue;$=a,a.A(f)}else $.A(f);if($.Di(this.ra))break}s=!0}}}return s},p.prototype.jP=function(){return this.LU()},p.prototype.LU=function(){return new d.MC().LX(this.g,this.ra)},p.prototype.gI=function(){var l=!1;this.Nc==null&&(this.Nc=new d.$j);var s=new d.ja(0);s.Jb(this.g.gd+1);for(var a=this.g.$q(),u=a.next();u!=-1;u=a.next())s.add(u);this.g.nx(s,s.size),s.add(-1),a=this.g.Hd(),u=this.g.Hd(),this.ae=new d.PC(this.g,this.ra,!this.Yz),this.Nc.Xo(this.ae);var f=new d.ja(0),y=new d.ja(0),v=0;new d.h;var _=this.g.ud;this.g.wb.oc();for(var M,$,T=this.g.wb.Aa[0].o,A=s.get(v++);A!=-1;){var R=M=T[2*($=_.U(A,0))],D=$=T[2*$+1];do{var V=_.U(A,2),Z=_.U(A,1);if(V!=-1){var ee=_.U(V,0),G=T[2*ee];0>(D<(ee=T[2*ee+1])?-1:D>ee?1:R<G?-1:R>G?1:0)&&(y.add(A),y.add(V))}Z!=-1&&(G=T[2*(ee=_.U(Z,0))],0>(D<(ee=T[2*ee+1])?-1:D>ee?1:R<G?-1:R>G?1:0)&&(y.add(Z),y.add(Z))),(G=this.g.Qa(A,a))!=-1&&(f.add(G),this.g.Sa(A,a,-1)),(G=this.g.Qa(A,u))!=-1&&(f.add(G),this.g.Sa(A,u,-1)),(A=s.get(v++))!==-1&&(R=T[2*(D=_.U(A,0))],D=T[2*D+1])}while(A!=-1&&R===M&&D===$);for(R=f.size==1&&y.size==2,G=D=-1,V=0,Z=f.size;V<Z;V++){ee=f.get(V);var re=this.Nc.xe(ee);if(re==-1||f.cG(re)||(D=re),(ee=this.Nc.lb(ee))==-1||f.cG(ee)||(G=ee),D!=-1&&G!=-1)break}for(this.ae.VJ($,M),V=0,Z=f.size;V<Z;V++)ee=f.get(V),this.Nc.wd(ee,-1);if(f.clear(!1),!R&&D!=-1&&G!=-1&&this.lO(D,G)){l=!0,this.Pi=this.ae.tm();break}for(V=0,Z=y.size;V<Z;V+=2){if($=y.get(V),M=y.get(V+1),R?($=this.Nc.Bu(D,G,$,!0),R=!1):$=this.Nc.addElement($,-1),this.ae.sg){this.Pi=this.ae.tm(),l=!0;break}this.g.Qa(M,a)==-1?this.g.Sa(M,a,$):this.g.Sa(M,u,$)}if(l)break;y.Dh(0)}return this.g.Ud(a),this.g.Ud(u),l},p.prototype.lO=function(l,s){return this.ae.compare(this.Nc,this.Nc.ka(l),s),l=this.ae.sg,this.ae.Mr(),l},p.tE=function(l){for(var s=l.md;s!=-1;s=l.ve(s))if(d.ba.Ic(l.jc(s)))return!0;return!1},p.aQ=function(l,s,a,u){return!!p.tE(l)&&((s=new p(u)).g=l,s.ra=a,15>l.gd?l=s.iP():s.jP())},p.W=function(l,s,a){return p.aQ(l,l.DF(),s,a)},p.fI=function(l,s,a,u,f){if(!p.tE(s))return!1;var y=new p(f);if(y.g=s,y.ra=a,y.Yz=l,y.gI())return u!=null&&u.Yt(y.Pi),!0;var v=new d.Ed;return v.VB(),s.Pc(v),(y=new p(f)).g=s,y.ra=a,y.Yz=l,l=y.gI(),v.VB(),s.Pc(v),!!l&&(u!=null&&u.Yt(y.Pi),!0)},p.Ol=function(l,s){return!(16>(l=l.I()))&&2*l+Math.log(l)*Math.LOG10E/Math.log(2)*s<1*l*s},p.gP=function(l,s,a,u){if(d.ba.Ic(s.K()))return new p(u).hP(l,s,a);throw d.i.ga("crack_A_with_B")},p.prototype.hP=function(l,s,a){var u=new d.l;l.yc(u);var f=new d.l;if(s.yc(f),f.X(a,a),!f.isIntersecting(u))return l;var y=l.Cb,v=null;y!=null&&(v=y.Gb),p.Ol(l,l.I())&&(v=d.ua.lj(l,f));var _=v!=null?v.getIterator():null,M=s.Ha();s=l.Ha();var $=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(f=[];M.ab();)for(;M.Ia();){var T=M.ia();if(v!=null){for(_.Wo(T,a),y=_.next();y!=-1;y=_.next())if(this.Zq(),s.Wb(v.ka(y),-1),s.Ia()){var A=(y=s.ia()).Fa(T,null,$,null,a);for(y=0;y<A;++y){var R=$[y];if(R!=0&&R!=1){var D=s.xb(),V=new S;V.t=R,V.index=D,f.push(V)}}}}else{var Z=new d.l;if(T.yc(Z),Z.X(a,a),u.isIntersecting(Z)){for(s.aj();s.ab();)for(;s.Ia();)if(this.Zq(),y=s.ia(),R=new d.l,y.yc(R),R.isIntersecting(Z))for(A=y.Fa(T,null,$,null,a),y=0;y<A;++y)(R=$[y])!=0&&R!=1&&(D=s.xb(),(V=new S).t=R,V.index=D,f.push(V))}}}if(f.length==0)return l;for(f=f.sort(S.zy),l=l.Ja(),s.aj();s.ab()&&!s.Ia(););for(a=s.ia(),u=new d.jg,v=-1,y=0,_=f.length;y<_;){for($=f[y].index,M=y+1;M<_&&f[M].index==$;)++M;for(;s.xb()<$;){if(this.Zq(),T=s.Ia(),R=s.gb,(Z=T||!s.Qn()||s.Rn())&&l.pc(a,v!=R),v=R,!T)for(;s.ab()&&!s.Ia(););a=s.ia()}for($=0;y<M;y++)(R=f[y].t)!=$&&(a.dh($,R,u),$=R,R=s.gb,l.pc(u.get(),v!=R),v=R);if((Z=(T=s.Ia())||!s.Qn()||s.Rn())&&(a.dh($,1,u),l.pc(u.get(),!1)),T)a=s.ia();else{for(;s.ab()&&!s.Ia(););a=s.Ia()?s.ia():null}y=M}for(a!=null&&(R=s.gb,(Z=(T=s.Ia())||!s.Qn()||s.Rn())&&l.pc(a,v!=R),v=R),T=s.Ia();;){if(!T){for(;s.ab()&&!(T=s.Ia()););if(!T)break}a=s.ia(),R=s.gb,(Z=(T=s.Ia())||!s.Qn()||s.Rn())&&l.pc(a,v!=R),v=R}return l},p}();d.bu=O;var S=function(){function p(){}return p.zy=function(l,s){return l.index==s.index?l.t>s.t?1:l.t<s.t?-1:0:l.index>s.index?1:-1},p}()}(Q||(Q={})),function(d){var O;(O=d.FK||(d.FK={}))[O.Left=0]="Left",O[O.Right=1]="Right",O[O.Coincident=2]="Coincident",O[O.Undefined=3]="Undefined",O[O.Uncut=4]="Uncut";var S=function(s,a,u,f,y,v,_,M,$,T,A){this.Y=s,this.ct=a,this.Ps=u,this.ug=f,this.Nm=T,this.Cl=A};d.qY=S;var p=function(){function s(a,u){this.EH=a,this.Ji=u}return s.prototype.lM=function(a,u){var f=new d.h;this.Ji.D(a,f);var y=new d.h;return this.Ji.D(u,y),(f=f.compare(y))!=0?f:(a=this.Ji.Qa(a,this.EH))<(u=this.Ji.Qa(u,this.EH))?-1:a==u?0:1},s}(),l=function(s,a,u,f,y,v,_,M,$){this.ug=s,this.Ps=a,this.JA=u,this.PH=f,this.Gi=y,this.Cl=v,this.Nm=_,this.QH=M,this.JT=$};d.pY=l,d.GK=function(){function s(){}return s.EK=function(a,u,f,y,v,_){if(u.B())a=new S(u,4,-1,-1,NaN,4,-1,-1,NaN,-1,-1,NaN,-1,-1,NaN),v.push(a);else if(f.B())a=new S(u,4,-1,-1,NaN,4,-1,-1,NaN,-1,-1,NaN,-1,-1,NaN),v.push(a);else{var M=new d.hd;if(M.Ib(u),M.Ib(f),d.Vk.W(M,y,_,!0),M.gd==0)a=new S(u.Ja(),4,-1,-1,NaN,4,-1,-1,NaN,-1,-1,NaN,-1,-1,NaN),v.push(a);else{for(u=0,f=M.Hd(),y=M.md;y!=-1;y=M.ve(y))for(_=M.Ob(y);_!=-1;_=M.Sb(_))for(var $=M.Ya(_),T=0,A=M.Ka(_);T<A;$=M.V($),T++)M.Sa($,f,u++);u=s.CM(f,M),s.YL(a,u,M,v)}}},s.CM=function(a,u){for(var f=u.gd,y=new d.ja(0),v=u.md;v!=-1;v=u.ve(v))for(var _=u.Ob(v);_!=-1;_=u.Sb(_))for(var M=u.Ya(_),$=0,T=u.Ka(_);$<T;M=u.V(M),$++)y.add(M);var A=new p(a,u);y.Wd(0,f,function(De,Fe){return A.lM(De,Fe)}),a=[];var R=[],D=u.Hd(),V=u.Hd();v=u.md,_=u.ve(v),T=new d.h;var Z=new d.h,ee=y.get(0),G=u.cd(ee),re=u.Sf(G);u.D(ee,T);var oe=1;for(M=0;oe<f-1;){var se=!1;for($=oe;$<f;$++)if($!=M){var ge=y.get($),me=u.cd(ge),Ie=u.Sf(me);if(u.D(ge,Z),!T.rb(Z))break;re==v&&Ie==_&&(se=s.pM(D,V,u,a,R,G,ee,me,ge))}if(se||M==oe-1){if(se&&M==oe-1&&oe--,++M==f)break;ee=y.get(M),G=u.cd(ee),re=u.Sf(G),u.D(ee,T)}se||(oe=M+1)}for(f=[],v=u.md;v!=-1;v=u.ve(v))for(_=u.Ob(v);_!=-1;_=u.Sb(_))for(y=u.Ya(_),$=0,T=u.Ka(_);$<T;y=u.V(y),$++){if(0<=(M=u.Qa(y,V)))for(;M<R.length&&R[M].ug==y;)f.push(R[M++]);if(0<=(M=u.Qa(y,D)))for(;M<a.length&&a[M].ug==y;)f.push(a[M++])}return u.Ud(D),u.Ud(V),f},s.pM=function(a,u,f,y,v,_,M,$,T){var A=f.tj(_),R=f.tj($),D=f.Ya(_),V=f.Ya($),Z=f.Na(M),ee=f.Na(T),G=!1,re=!1,oe=!1,se=!1;return M!=D&&(T!=V&&(G=s.qM(a,f,y,_,Z,$,ee)),T!=R&&(re=s.rM(a,f,y,_,Z,$,T))),M!=A&&(T!=V&&(oe=s.sM(u,f,v,_,M,$,ee,D)),T!=R&&(se=s.tM(u,f,v,_,M,$,T,D))),G&&re&&oe?(a=y.length-1,v[se?v.length-2:v.length-1].Gi==2&&(y[a-1]=y[a],--y.length)):G&&re&&se&&v[v.length-1].Gi==2&&(v=y[y.length-1],--y.length,f.Qa(v.ug,a)==y.length&&f.Sa(v.ug,a,-1)),G||re||oe||se},s.qM=function(a,u,f,y,v,_,M){var $=new d.zb,T=new d.zb,A=[0,0],R=[0,0],D=u.cc(v);return D==null&&(u.fd(v,$),D=$),($=u.cc(M))==null&&(u.fd(M,T),$=T),2>(D=D.Fa($,null,A,R,0))&&(y=new l(v,y,A[0],NaN,D,M,_,R[0],NaN),f.push(y),0>(y=u.Qa(v,a))&&u.Sa(v,a,f.length-1)),!0},s.rM=function(a,u,f,y,v,_,M){var $=new d.zb,T=new d.zb,A=[0,0],R=[0,0],D=u.cc(v);return D==null&&(u.fd(v,$),D=$),($=u.cc(M))==null&&(u.fd(M,T),$=T),2>(D=D.Fa($,null,A,R,0))&&(y=new l(v,y,A[0],NaN,D,M,_,R[0],NaN),f.push(y),0>(y=u.Qa(v,a))&&u.Sa(v,a,f.length-1),!0)},s.sM=function(a,u,f,y,v,_,M,$){var T=new d.zb,A=new d.zb,R=[0,0],D=[0,0],V=u.cc(v);return V==null&&(u.fd(v,T),V=T),(T=u.cc(M))==null&&(u.fd(M,A),T=A),(V=V.Fa(T,null,R,D,0))==2?(y=new l(v,y,R[0],R[1],V,M,_,D[0],D[1]),f.push(y),0>(y=u.Qa(v,a))&&u.Sa(v,a,f.length-1),!0):(A=!1,v==$&&(y=new l(v,y,R[0],NaN,V,M,_,D[0],NaN),f.push(y),0>(y=u.Qa(v,a))&&u.Sa(v,a,f.length-1),A=!0),A)},s.tM=function(a,u,f,y,v,_,M,$){var T=new d.zb,A=new d.zb,R=[0,0],D=[0,0],V=u.cc(v);return V==null&&(u.fd(v,T),V=T),(T=u.cc(M))==null&&(u.fd(M,A),T=A),(V=V.Fa(T,null,R,D,0))==2?(y=new l(v,y,R[0],R[1],V,M,_,D[0],D[1]),f.push(y),0>(y=u.Qa(v,a))&&u.Sa(v,a,f.length-1),!0):(A=!1,v==$&&(y=new l(v,y,R[0],NaN,V,M,_,D[0],NaN),f.push(y),0>(y=u.Qa(v,a))&&u.Sa(v,a,f.length-1),A=!0),A)},s.YL=function(a,u,f,y){var v=[];v[0]=new d.h,v[1]=new d.h,v[2]=new d.h,v[3]=new d.h;var _=new d.h,M=new d.h,$=new d.h,T=new d.h,A=null;y!=null&&(A=new d.jg).Qr();var R=0,D=null,V=new d.zb;new d.zb;for(var Z=f.Ob(f.md);Z!=-1;Z=f.Sb(Z)){for(var ee=4,G=-1,re=-1,oe=-1,se=-1,ge=NaN,me=!0,Ie=!1,De=!0,Fe=!0,gt=!0,Ze=0,Vt=Z,Rt=0,lt=f.Ya(Z),Ui=f.Ka(Z),Vr=0;Vr<Ui;lt=f.V(lt),Vr++){var Wi=f.cc(lt);if(Wi==null){if(!f.fd(lt,V))continue;Wi=V}re==-1&&(re=lt);for(var Mi=0;R<u.length&&lt==u[R].ug;){G=u[R].Ps;var Ii=u[R].ug,ri=u[R].JA,sr=u[R].Nm,Qt=u[R].Cl,tn=u[R].QH;if(u[R].Gi==2){if(Ie||(Vt=G,re=Ii,Rt=ri,oe=sr,se=Qt,ge=tn,ee=2,y!=null?D=new d.Ua:Ze=0,gt=!1,Fe=!0),ri=u[R].PH,tn=u[R].JT,y!=null?(Wi.dh(Mi,u[R].PH,A),D.pc(A.get(),Fe)):Ze++,Mi=ri,Ie=!0,Fe=me=!1,R+1==u.length||u[R+1].Gi!=2||u[R+1].ug==Ii&&u[R+1].JA!=Mi){if(y!=null){var di=new S(D,2,G,Ii,ri,ee,Vt,re,Rt,sr,Qt,tn,oe,se,ge);y.push(di)}else null.add(Ze);Vt=G,re=Ii,Rt=ri,oe=sr,se=Qt,ge=tn,ee=2,Ie=me=!1,Fe=gt=!0}}else{var Zn=f.V(Ii);if(R<u.length-1&&u[R+1].ug==Zn&&u[R+1].Cl==Qt&&u[R+1].Gi==2)ri!=Mi&&(gt&&(y!=null?D=new d.Ua:Ze=0),me=0<R&&u[R-1].Ps==G?ee==1?0:ee==0?1:3:3,y!=null?(Wi.dh(Mi,ri,A),D.pc(A.get(),Fe),di=new S(D,me,G,Ii,ri,ee,Vt,re,Rt,sr,Qt,tn,oe,se,ge),y.push(di)):(Ze++,null.add(Ze)),Mi=ri,Vt=G,re=Ii,Rt=ri,oe=sr,se=Qt,ge=tn,ee=me,me=De=!1,Fe=gt=!0);else if(!s.xM(a,f,u,R,_,M)){s.uM(f,u,R,Z,lt,$,T);var Pi=!1;if(Zn=!1,di=!0,!(_.rb($)||M.rb($)||_.rb(T)||M.rb(T))){v[0].N(_),v[1].N(M),v[2].N($),v[3].N(T),v.sort(d.h.pu);var qp=v[0],Hp=v[1],Wp=v[2],vs=v[3];qp.rb(_)?Hp.rb(M)?a?(Zn=Pi=!0,di=!1):Pi=!1:vs.rb(M)?a?di=Zn=Pi=!0:Pi=!1:(Pi=!0,di=Hp.rb($)):Hp.rb(_)?Wp.rb(M)?a?(Zn=Pi=!0,di=!1):Pi=!1:qp.rb(M)?a?di=Zn=Pi=!0:Pi=!1:(Pi=!0,di=Wp.rb($)):Wp.rb(_)?vs.rb(M)?a?(Zn=Pi=!0,di=!1):Pi=!1:Hp.rb(M)?a?di=Zn=Pi=!0:Pi=!1:(Pi=!0,di=vs.rb($)):qp.rb(M)?a?(Zn=Pi=!0,di=!1):Pi=!1:Wp.rb(M)?a?di=Zn=Pi=!0:Pi=!1:(Pi=!0,di=qp.rb($))}Pi&&(Pi=lt==Ii,(ri!=Mi||Pi&&Mi==0)&&(gt&&(y!=null?D=new d.Ua:Ze=0),y!=null?(Wi.dh(Mi,ri,A),D.pc(A.get(),Fe)):Ze++),di?ee!=1?((ri!=Mi||Pi&&Mi==0)&&(y!=null?(di=new S(D,1,G,Ii,ri,ee,Vt,re,Rt,sr,Qt,tn,oe,se,ge),y.push(di)):null.add(Ze)),Zn?(R>=u.length-2||u[R+2].Ps!=G)&&(ee=0):ee=1):((ri!=Mi||Pi&&Mi==0)&&(y!=null?(di=new S(D,3,G,Ii,ri,ee,Vt,re,Rt,sr,Qt,tn,oe,se,ge),y.push(di)):null.add(Ze)),ee=1):ee!=0?((ri!=Mi||Pi&&Mi==0)&&(y!=null?(di=new S(D,0,G,Ii,ri,ee,Vt,re,Rt,sr,Qt,tn,oe,se,ge),y.push(di)):null.add(Ze)),Zn?(R>=u.length-2||u[R+2].Ps!=G)&&(ee=1):ee=0):((ri!=Mi||Pi&&Mi==0)&&(y!=null?(di=new S(D,3,G,Ii,ri,ee,Vt,re,Rt,sr,Qt,tn,oe,se,ge),y.push(di)):null.add(Ze)),ee=0),(ri!=Mi||Pi&&Mi==0)&&(Mi=ri,Vt=G,re=Ii,Rt=ri,oe=sr,se=Qt,ge=tn,me=De=!1,Fe=gt=!0))}}R++}Mi!=1&&(gt&&(y!=null?D=new d.Ua:Ze=0),y!=null?(Wi.dh(Mi,1,A),D.pc(A.get(),Fe)):Ze++,Fe=gt=!1,De=!0)}De&&(ri=1,Ii=f.tj(Z),Ii=f.Na(Ii),Qt=sr=-1,tn=NaN,me?y!=null?(di=new S(D,4,G,Ii,ri,ee,Vt,re,Rt,sr,Qt,tn,oe,se,ge),y.push(di)):null.add(Ze):(me=ee==1?0:ee==0?1:3,y!=null?(di=new S(D,me,G,Ii,ri,ee,Vt,re,Rt,sr,Qt,tn,oe,se,ge),y.push(di)):null.add(Ze)))}},s.xM=function(a,u,f,y,v,_){var M=f[y].QH;if(M==1)return s.vM(a,u,f,y,v,_);if(M==0)return s.wM(a,u,f,y,v,_);throw d.i.Ra()},s.vM=function(a,u,f,y,v,_){var M=new d.zb,$=f[y].ug,T=f[y].Nm,A=f[y].Cl,R=-1,D=-1,V=-1,Z=-1;if(!a&&0<y){var ee=f[y-1];R=ee.ug,D=ee.Nm,V=ee.Cl,Z=ee.Gi}var G=-1,re=-1,oe=-1,se=-1;y<f.length-1&&(G=(ee=f[y+1]).ug,re=ee.Nm,oe=ee.Cl,se=ee.Gi);var ge=u.V($);return ee=u.V(A),a?y==f.length-1||G!=$||re!=T||oe!=ee||se==2?((a=u.cc(A))==null&&(u.fd(A,M),a=M),_.N(a.lg()),v.nt(_),_.normalize(),v.normalize(),!1):((a=u.cc(A))==null&&(u.fd(A,M),a=M),v.N(a.lg()),(a=u.cc(ee))==null&&(u.fd(ee,M),a=M),_.N(a.lg()),v.Uq(),_.normalize(),v.normalize(),!1):0<y&&R==$&&D==T&&V==ee&&Z==2||y<f.length-1&&G==ge&&re==T&&oe==ee&&se==2?((a=u.cc(A))==null&&(u.fd(A,M),a=M),_.N(a.lg()),v.nt(_),_.normalize(),v.normalize(),!1):!(y<f.length-1&&G==$&&re==T&&oe==ee)||((a=u.cc(A))==null&&(u.fd(A,M),a=M),v.N(a.lg()),(a=u.cc(ee))==null&&(u.fd(ee,M),a=M),_.N(a.lg()),v.Uq(),_.normalize(),v.normalize(),!1)},s.wM=function(a,u,f,y,v,_){var M=new d.zb,$=f[y].ug,T=f[y].Nm,A=f[y].Cl,R=-1,D=-1,V=-1,Z=-1;if(!a&&y<f.length-1){var ee=f[y+1];R=ee.ug,D=ee.Nm,V=ee.Cl,Z=ee.Gi}var G=-1,re=-1,oe=-1;ee=-1,0<y&&(G=(ee=f[y-1]).ug,re=ee.Nm,oe=ee.Cl,ee=ee.Gi);var se=u.V($),ge=u.Na(A);return a?y!=0&&G==$&&re==T&&oe==ge&&ee!=2||((a=u.cc(A))==null&&(u.fd(A,M),a=M),_.N(a.lg()),v.nt(_),_.normalize(),v.normalize(),!1):!(0<y&&G==$&&re==T&&oe==ge&&ee==2||y<f.length-1&&R==se&&D==T&&V==ge&&Z==2)||((a=u.cc(A))==null&&(u.fd(A,M),a=M),_.N(a.lg()),v.nt(_),_.normalize(),v.normalize(),!1)},s.uM=function(a,u,f,y,v,_,M){var $=new d.zb,T=a.cc(v);if(T==null&&(a.fd(v,$),T=$),u=(f=u[f]).ug,f=f.JA,v=a.V(u),f==1)_.N(T.lg()),v!=-1&&v!=a.tj(y)?((T=a.cc(v))==null&&(a.fd(v,$),T=$),M.N(T.lg()),(T=a.cc(u))==null&&a.fd(u,$)):M.N(_),_.Uq(),M.normalize(),_.normalize();else{if(f!=0)throw d.i.Ra();M.N(T.lg()),_.nt(M),M.normalize(),_.normalize()}},s}()}(Q||(Q={})),function(d){var O;(O=d.XL||(d.XL={}))[O.Linear=0]="Linear",O[O.Angular=1]="Angular",O[O.Area=2]="Area";var S=function(){function y(v,_,M){this.pd=_,this.ci=M,this.qA=v}return y.prototype.Nb=function(v){return v instanceof y&&this.ci===v.ci},y.WF=function(v){return v.pd!==0?null:v.qA===-1?new y(-1,2,v.ci*v.ci):y.ah(u[v.qA])},y.ah=function(v){return(v=a[v])===void 0?null:v},y.UO=function(v,_,M){var $=null;if(M!=null)try{M.values[0]==="EPSG"&&($=y.ah(parseInt(M.values[1])))}catch{}return $===null&&($=new y(-1,v,_)),$},y.prototype.Fc=function(){return this.qA},y.prototype.xF=function(v){if(v.pd!=this.pd)throw d.i.Hb();return this.ci/v.ci},y.Ph=function(v,_,M){return _.xF(M)*v},y.SE=function(v,_,M,$,T){for(M=M.xF($),$=0;$<_;$++)T[$]=v[$]*M},y}();d.Uc=S;for(var p=[109401,1e4,109402,4046.8564224,109403,4046.87260987425,109404,1,109405,.09290304,109406,.09290341161327487,109407,.09290137299531805,109408,3.34450944,109409,3429904,109410,1.000027193184865,109411,404.6872609874253,109412,.04046872609874253,109413,2.5899984703195216e6,109414,1e6,109415,.8361123569578626,109416,404.67838076760535,109417,.04046783807676053,109418,.8361244606523066,109419,.09290271785025629,109420,404.68423895571647,109421,.04046842389557164,109422,.83612589696064,109423,.0929028774400711,109424,404.6849341289498,109425,.04046849341289498,109426,.836125904805842,109427,.09290287831176021,109428,404.68493792602754,109429,.04046849379260275,109430,.09290354800069446,109431,.09290274144751023,109432,.09290207073852812,109433,.09290279616016,109434,.09290273520025,109435,.836124673027592,109436,.836118636646753,109437,.8361251654414399,109438,.83612461680225,109439,2589988110336e-6,109440,.09290286332673177,109441,.09290349665192114,109442,.83612736,109443,.8361307045194736,109444,404.68564224000005,109445,.04046856422400001,109446,.8361237024040001,109447,.0929026336004445,109448,404.683871963536,109449,.0404683871963536,109450,.01,109451,1e-4,109452,1e-6,109453,64516e-8,109454,.0006451625806477421,109455,25.292852640000003,109456,25.29295381171408,109457,3.4345281495040003e6,109458,3434290937856e-6,109459,2.89612324,109460,25e8,109461,225e8,109462,.7168473118308245,109463,100,109464,1244521604938272e-22,109465,1e-12,109466,1e-18],l=[1031,484813681109536e-23,9101,1,9102,.0174532925199433,9103,.0002908882086657216,9104,484813681109536e-20,9105,.01570796326794897,9106,.01570796326794897,9109,1e-6,9112,.0001570796326794897,9113,1570796326794897e-21,9114,.0009817477042468104],s=[1025,.001,109452,1033,.01,109451,9001,1,109404,9002,.3048,109405,9003,.3048006096012192,109406,9005,.3047972654,109407,9014,1.8288,109408,9030,1852,109409,9031,1.0000135965,109410,9033,20.11684023368047,109411,9034,.2011684023368047,109412,9035,1609.3472186944375,109413,9036,1e3,109414,9037,.9143917962000001,109415,9038,20.1166195164,109416,9039,.201166195164,109417,9040,.9143984146160287,109418,9041,.304799471538676,109419,9042,20.116765121552632,109420,9043,.2011676512155263,109421,9050,.9143992,109422,9051,.3047997333333333,109423,9052,20.1167824,109424,9053,.201167824,109425,9060,.9143992042898124,109426,9061,.3047997347632708,109427,9062,20.116782494375872,109428,9063,.2011678249437587,109429,9070,.3048008333333334,109430,9080,.3047995102481469,109431,9081,.30479841,109432,9082,.3047996,109433,9083,.3047995,109434,9084,.9143985307444408,109435,9085,.91439523,109436,9086,.9143988,109437,9087,.9143985,109438,9093,1609.344,109439,9094,.3047997101815088,109440,9095,.3048007491,109441,9096,.9144,109442,9097,20.1168,109444,9098,.201168,109445,9099,.914398,109446,9300,.3047993333333334,109447,9301,20.116756,109448,9302,.20116756,109449,109001,.9144,109442,109002,.9144018288036576,109443,109003,20.1168,109444,109004,.201168,109445,109005,.1,109450,109006,.01,109451,109007,.001,109452,109008,.0254,109453,109009,.0254000508001016,109454,109010,5.0292,109455,109011,5.029210058420118,109456,109012,1853.248,109457,109013,1853.184,109458,109014,1.7018,109459,109015,.8466683600033867,109462,109016,.0003527777777777778,109464,109017,1e-6,109465,109018,1e-9,109466,109030,5e4,109460,109031,15e4,109461],a=[],u=[],f=0;f<p.length;f+=2)a[p[f]]=new S(p[f],2,p[f+1]);for(p=null,f=0;f<l.length;f+=2)a[l[f]]=new S(l[f],1,l[f+1]);for(l=null,f=0;f<s.length;f+=3)a[s[f]]=new S(s[f],0,s[f+1]),u[s[f]]=s[f+2];s=null}(Q||(Q={})),function(d){var O=function(){function S(){this.yb=this.pb=0}return S.prototype.set=function(p,l){l!==void 0?(this.pb=p,this.yb=l):typeof p=="number"?(this.pb=p,this.yb=0):(this.pb=p.pb,this.yb=p.yb)},S.prototype.value=function(){return this.pb},S.prototype.add=function(p){var l=this.pb+p.pb;p=this.yb+p.yb+2220446049250313e-31*Math.abs(l),this.pb=l,this.yb=p},S.prototype.fN=function(){var p=this.pb+1,l=this.yb+2220446049250313e-31*Math.abs(p);this.pb=p,this.yb=l},S.prototype.ZM=function(p,l){this.pb=p.pb+l.pb,this.yb=p.yb+l.yb+2220446049250313e-31*Math.abs(this.pb)},S.prototype.sub=function(p){if(typeof p=="number"){var l=this.pb-p;p=this.yb+2220446049250313e-31*Math.abs(l)}else l=this.pb-p.pb,p=this.yb+p.yb+2220446049250313e-31*Math.abs(l);this.pb=l,this.yb=p},S.prototype.Bg=function(p){var l=this.pb*p.pb;this.yb=this.yb*Math.abs(p.pb)+p.yb*Math.abs(this.pb)+this.yb*p.yb+2220446049250313e-31*Math.abs(l),this.pb=l},S.prototype.Po=function(p){var l=this.pb*p;this.yb=this.yb*Math.abs(p)+2220446049250313e-31*Math.abs(l),this.pb=l},S.prototype.Ml=function(p,l){var s=Math.abs(p.pb)*Math.abs(l.pb);this.yb=p.yb*Math.abs(l.pb)+l.yb*Math.abs(p.pb)+p.yb*l.yb+2220446049250313e-31*Math.abs(s),this.pb=s},S.prototype.lm=function(p){var l=Math.abs(p.pb),s=this.pb/p.pb,a=(this.yb+Math.abs(s)*p.yb)/l;p.yb>.01*l&&(a*=1+(1+(p=p.yb/l))*p),this.pb=s,this.yb=a+2220446049250313e-31*Math.abs(s)},S.prototype.sqrt=function(){if(0<=this.pb){var p=Math.sqrt(this.pb),l=this.pb>10*this.yb?.5*this.yb/p:this.pb>this.yb?p-Math.sqrt(this.pb-this.yb):Math.max(p,Math.sqrt(this.pb+this.yb)-p);l+=2220446049250313e-31*Math.abs(p)}else this.pb<-1*this.yb?l=p=NaN:(p=0,l=Math.sqrt(this.yb));this.pb=p,this.yb=l},S.prototype.sin=function(p){var l=Math.sin(p.pb),s=Math.cos(p.pb);this.pb=l,l=Math.abs(l),this.yb=(Math.abs(s)+.5*l*p.yb)*p.yb+2220446049250313e-31*l},S.prototype.cos=function(p){var l=Math.sin(p.pb),s=Math.cos(p.pb);this.pb=s,s=Math.abs(s),this.yb=(Math.abs(l)+.5*s*p.yb)*p.yb+2220446049250313e-31*s},S.prototype.rg=function(){return Math.abs(this.pb)<=this.yb},S.prototype.rs=function(){return this.rg()&&this.yb!=0},S}();d.Xb=O}(Q||(Q={}));var dt=new Q.h,vt=new Q.h,$t=new Q.h,Ct=new Q.h,qt=new Q.h;(function(d){var O,S;(S=O||(O={}))[S.closedPath=1]="closedPath",S[S.exteriorPath=2]="exteriorPath",S[S.ringAreaValid=4]="ringAreaValid";var p=function(){function l(s,a,u,f,y,v,_){a!==void 0?(this.ib=s,this.ek=a,this.dl=u,this.ki=f,this.za=v,this.cA=_,this.gw=y):(this.ib=s.ib,this.ek=s.ek,this.dl=s.dl,this.ki=s.ki,this.za=s.za,this.cA=s.cA,this.gw=s.gw),this.XG=!0}return l.prototype.next=function(){return this.XG?(this.XG=!1,this.ki):this.ki!=-1?(this.ki=this.ib.V(this.ki),this.za++,this.ki!=-1&&this.ki!=this.gw?this.ki:this.VT()):-1},l.prototype.VT=function(){for(this.dl=this.ib.Sb(this.dl),this.za=0;this.ek!=-1;){for(;this.dl!=-1;this.dl=this.ib.Sb(this.dl))if(this.gw=this.ki=this.ib.Ya(this.dl),this.ki!=-1)return this.ki;if(this.ek=this.ib.ve(this.ek),this.ek==-1)break;this.cA&&!d.ba.Ic(this.ib.jc(this.ek))||(this.dl=this.ib.Ob(this.ek))}return-1},l.vP=function(s,a,u,f,y,v,_){return new l(s,a,u,f,y,v,_)},l}();d.vY=p,O=function(){function l(){this.lo=this.Cm=this.yk=this.dd=this.Ek=this.xo=this.Qi=this.nd=this.di=this.Ug=this.Te=this.Kl=null,this.sw=this.md=-1,this.gd=0,this.aA=!1,this.it=this.jt=this.wb=null}return l.prototype.Uh=function(s){return this.Te!=null?this.Te[s]:null},l.prototype.Zg=function(s,a){if(this.Te==null){if(a==null)return;this.Te=[];for(var u=0,f=this.wb.I();u<f;u++)this.Te.push(null)}this.Te[s]=a},l.prototype.ep=function(s,a){this.nd.T(s,1,a)},l.prototype.cp=function(s,a){this.nd.T(s,2,a)},l.prototype.QB=function(s,a){this.nd.T(s,6,a)},l.prototype.Up=function(s){return this.nd.U(s,6)},l.prototype.gx=function(s,a){this.nd.T(s,7,a)},l.prototype.sv=function(s){return this.nd.U(s,0)},l.prototype.JJ=function(s,a){this.dd.T(s,1,a)},l.prototype.NJ=function(s,a){this.dd.T(s,0,a)},l.prototype.EF=function(s){return this.dd.U(s,7)},l.prototype.ap=function(s,a){this.dd.T(s,3,a)},l.prototype.bp=function(s,a){this.dd.T(s,4,a)},l.prototype.pU=function(s){this.dd==null&&(this.dd=new d.ad(8));var a=this.dd.De();return this.dd.T(a,2,s),this.dd.T(a,5,0),this.dd.T(a,6,0),this.dd.T(a,7,a),a},l.prototype.JQ=function(s){this.dd.kd(s)},l.prototype.rU=function(s){this.nd==null&&(this.nd=new d.ad(8),this.ud=new d.ad(5),this.Qi=new d.ce(0),this.xo=new d.ce(0));var a=this.nd.De();return this.nd.T(a,0,a),this.nd.T(a,3,0),this.nd.T(a,6,0),this.gx(a,s),a>=this.Qi.size&&(s=16>a?16:d.P.truncate(3*a/2),this.Qi.resize(s),this.xo.resize(s)),this.Qi.set(a,0),this.xo.set(a,0),a},l.prototype.nF=function(s){this.nd.kd(s)},l.prototype.Qy=function(s){this.ud.kd(s),this.gd--},l.prototype.jI=function(s){this.nd==null&&(this.nd=new d.ad(8),this.ud=new d.ad(5),this.Qi=new d.ce(0),this.xo=new d.ce(0));var a=this.ud.De(),u=0<=s?s:a;if(this.ud.T(a,0,u),0>s){if(u>=this.wb.I()){if(s=16>u?16:d.P.truncate(3*u/2),this.wb.resize(s),this.Te!=null)for(var f=0;f<s;f++)this.Te.push(null);this.Ug!=null&&this.Ug.resize(s),this.jt=this.wb.vb(0)}this.wb.Db(u,-1e38,-1e38),this.Te!=null&&(this.Te[u]=null),this.Ug!=null&&this.Ug.write(u,1)}return this.ud.T(a,4,2*u),this.gd++,a},l.prototype.yj=function(s,a,u){var f=a!=-1?this.Na(a):this.tj(s),y=f!=-1?this.V(f):-1,v=this.jI(u==null?this.gd:-1),_=this.Va(v);return u!=null&&this.wb.It(_,u),this.cj(v,s),this.Cc(v,y),this.Dc(v,f),y!=-1&&this.Dc(y,v),f!=-1&&this.Cc(f,v),u=this.ec(s),f=this.Ya(s),a==-1&&this.Yg(s,v),a==f&&this.Kf(s,v),u&&y==-1&&(this.Cc(v,v),this.Dc(v,v)),this.Xj(s,this.Ka(s)+1),s=this.Sf(s),this.Vj(s,this.I(s)+1),v},l.prototype.pm=function(){return this.lo==null&&(this.lo=new d.Ta(this.wb.description)),this.lo},l.prototype.$o=function(s,a){this.dd.T(s,2,-134217729&this.dd.U(s,2)||(a==1?134217728:0))},l.prototype.Kn=function(s){return(134217728&this.dd.U(s,2))!=0?1:0},l.prototype.cN=function(s){var a=this.Kg(s.K(),s.description);return s.K()==1736&&this.$o(a,s.Kn()),this.PD(a,s),a},l.prototype.dN=function(s){var a=this.Kg(s.K(),s.description);return this.QD(a,s),a},l.prototype.SV=function(s,a){this.nd==null&&(this.nd=new d.ad(8),this.ud=new d.ad(5),this.Qi=new d.ce(0),this.xo=new d.ce(0)),this.nd.Ee(this.nd.Jg+s),this.ud.Ee(this.ud.Jg+a),this.Qi.Jb(this.Qi.size+s),this.xo.Jb(this.xo.size+s)},l.prototype.PD=function(s,a){this.SV(a.ea(),a.I()),this.Kl.Gd(a,0,a.I()),this.jt=this.wb.vb(0);for(var u=this.Te!=null&&a.Se!=null,f=0,y=a.ea();f<y;f++)if(!(2>a.Ka(f))){var v=this.wf(s,-1);this.mn(v,a.ec(f));for(var _=a.Ca(f),M=a.Wc(f);_<M;_++){var $=this.yj(v,-1,null);if(u)if($=this.Va($),(1&a.UF(_))!=0)this.Zg($,null);else{var T=new d.jg;a.cc(_,T,!0),this.Zg($,T.get())}}}},l.prototype.QD=function(s,a){this.Kl.Gd(a,0,a.I()),this.jt=this.wb.vb(0),s=this.wf(s,-1);var u=0;for(a=a.I();u<a;u++)this.yj(s,-1,null)},l.prototype.JX=function(s,a,u){var f=this.V(s);if(f==-1)throw d.i.Ra();for(var y=this.pm(),v=this.cd(s),_=0,M=a.ql(u);_<M;_++){var $=this.Va(s),T=this.V(s),A=a.Xp(u,_);_==0&&(A.Vo(y),this.Fh(s,y)),A.K()==322?this.Zg($,null):this.Zg($,d.ba.kg(A)),A.Ro(y),_<M-1?s=this.yj(v,T,y):this.Fh(f,y)}},l.prototype.IX=function(s,a,u){var f=this.V(s);if(f==-1)throw d.i.Ra();for(var y=this.pm(),v=this.cd(s),_=0,M=a.ql(u);_<M;_++){var $=this.Va(s),T=this.V(s),A=a.Xp(u,M-_-1);_==0&&(A.Ro(y),this.Fh(s,y)),A.K()==322?this.Zg($,null):this.Zg($,d.ba.kg(A)),A.Vo(y),_<M-1?s=this.yj(v,T,y):this.Fh(f,y)}},l.prototype.DF=function(){var s=new d.l;s.Pa();for(var a=this.$q(),u=new d.h,f=!0,y=a.next();y!=-1;y=a.next())this.D(y,u),f?s.$b(u.x,u.y):s.Nk(u.x,u.y),f=!1;return s},l.prototype.Ib=function(s){var a=s.K();if(d.ba.Ic(a))return this.cN(s);if(a==550)return this.dN(s);throw d.i.Ra()},l.prototype.pN=function(s,a){var u=a.K();if(d.ba.Ic(u))this.PD(s,a);else{if(u!=550)throw d.i.Ra();this.QD(s,a)}},l.prototype.hN=function(s,a){var u=this.Kg(1736,s.description);if(2>s.Ka(a))return u;this.Kl.Gd(s,s.Ca(a),s.Wc(a)),this.jt=this.wb.vb(0);var f=this.wf(u,-1);this.mn(f,s.ec(a)||!0);var y=this.Te!=null&&s.Se!=null,v=s.Ca(a);for(a=s.Wc(a);v<a;v++){var _=this.yj(f,-1,null);if(y)if(_=this.Va(_),(1&s.UF(v))!=0)this.Zg(_,null);else{var M=new d.jg;s.cc(v,M,!0),this.Zg(_,M.get())}}return u},l.prototype.Ke=function(s){var a=this.jc(s),u=d.UK.Kg(a,this.Kl.description),f=this.I(s);if(f==0)return u;if(d.ba.Ic(a)){a=this.ea(s);for(var y=d.Zc.Qh(a+1),v=d.Zc.Or(a+1,0),_=u.description,M=0,$=_.Ba;M<$;M++){for(var T=_.ld(M),A=d.sa.Wa(T),R=d.Zc.TE(T,f),D=this.wb.vb(T),V=0,Z=0,ee=0,G=this.Ob(s);G!=-1;G=this.Sb(G)){var re=0;this.ec(G)&&(re|=1),this.TS(G)&&(re|=4),re!=0&&v.uJ(Z,re);var oe=this.Ka(G);if(y.write(Z++,ee),ee+=oe,T==0){oe=D;var se=R,ge=new d.h;for(re=this.Ya(G);V<ee;re=this.V(re),V++){var me=this.Va(re);oe.uc(2*me,ge),se.Vt(2*V,ge)}}else for(re=this.Ya(G);V<ee;re=this.V(re),V++)for(me=this.Va(re),se=0;se<A;se++)ge=D.gg(me*A+se),R.rr(V*A+se,ge)}u.kn(T,R),y.write(a,f)}u.KJ(v),u.LJ(y),u.Qc(16777215)}else if(a==550){for(_=u.description,u.resize(f),M=0,$=_.Ba;M<$;M++){for(T=_.ld(M),A=d.sa.Wa(T),R=u.vb(T),D=this.wb.vb(T),V=0,G=this.Ob(s),oe=this.Ka(G),re=this.Ya(G);V<oe;re=this.V(re),V++)for(me=this.Va(re),se=0;se<A;se++)ge=D.gg(me*A+se),R.rr(V*A+se,ge);u.kn(T,R)}u.Qc(16777215)}return u},l.prototype.wB=function(s){for(var a=this.Ob(s);a!=-1;a=this.ar(a));a=this.KR(s);var u=this.ve(s);a!=-1?this.JJ(a,u):this.md=u,u!=-1?this.NJ(u,a):this.sw=a,this.JQ(s)},l.prototype.Kg=function(s,a){return a===void 0?this.VE(s,d.fe.pg()):this.VE(s,a)},l.prototype.VE=function(s,a){return s=this.pU(s),this.wb==null?this.wb=this.Kl=new d.ee(a):this.Kl.Ll(a),this.it=this.Kl.description,this.aA=1<this.it.Ba,this.md==-1?this.md=s:(this.NJ(s,this.sw),this.JJ(this.sw,s)),this.sw=s},l.prototype.ve=function(s){return this.dd.U(s,1)},l.prototype.KR=function(s){return this.dd.U(s,0)},l.prototype.jc=function(s){return 2147483647&this.dd.U(s,2)},l.prototype.CJ=function(s,a,u){a=this.yk[a],(s=this.EF(s))>=a.size&&a.resize(Math.max(d.P.truncate(1.25*s),16),-1),a.write(s,u)},l.prototype.FF=function(s,a){return(s=this.EF(s))<(a=this.yk[a]).size?a.read(s):-1},l.prototype.WE=function(){this.yk==null&&(this.yk=[]);for(var s=0;s<this.yk.length;s++)if(this.yk[s]==null)return this.yk[s]=d.Zc.Qh(0),s;return this.yk.push(d.Zc.Qh(0)),this.yk.length-1},l.prototype.sW=function(s){this.yk[s]=null},l.prototype.Ob=function(s){return this.dd.U(s,3)},l.prototype.mv=function(s){return this.dd.U(s,4)},l.prototype.I=function(s){return this.dd.U(s,5)},l.prototype.ea=function(s){return this.dd.U(s,6)},l.prototype.Ip=function(s,a,u){for(var f=0,y=this.md;y!=-1;y=this.ve(y)){var v=this.jc(y);if(d.ba.Ic(v)&&(!u||v==1736)){v=this.jc(y)==1736;for(var _=this.Ob(y);_!=-1;){for(var M=0,$=this.Ya(_);M<d.P.truncate(this.Ka(_)/2);){var T=this.V($);if(T==-1)break;var A=this.Va($),R=this.Uh(A);R!=null?A=R.Rb():(R=this.Va(T),A=this.wb.Ar(A,R)),A<=s?(A==0?f==0&&(f=-1):f=1,T!=this.tj(_)&&(this.gC(T,$),this.qd(T,!0))):$=this.V($),M++}for(M=this.Ya(_),$=this.ec(_)?M:this.tj(_);0<this.Ka(_);){if((T=this.Na($))==-1){this.qd($,!0),f==0&&(f=-1);break}var D=this.Va(T);if((R=this.Uh(D))!=null?A=R.Rb():(A=this.Va($),A=this.wb.Ar(A,D)),A<=s)A==0?f==0&&(f=-1):f=1,this.gC(T,$),this.qd(T,!1),M==T&&(M=this.Ya(_));else if(($=this.Na($))==M)break}$=this.Ka(_),a&&(v?3>$:2>$)?(_=this.ar(_),f=0<$?1:f==0?-1:f):_=this.Sb(_)}}}return f},l.prototype.gC=function(s,a){var u=this.Va(s),f=this.Va(a);if(this.Ug!=null&&(u=this.Ug.read(u),this.Ug.write(f,u)),this.di!=null){for(f=0,u=this.di.length;f<u;f++)if(this.di[f]!=null){var y=this.Qa(s,f);y!=-1&&this.Sa(a,f,y)}}},l.prototype.Wl=function(s,a,u){var f=0,y=this.V(s);if(y==-1)throw d.i.Ra();for(var v=this.Va(s),_=this.Va(y),M=this.Uh(v),$=M==null?this.wb.Ar(v,_):M.Rb(),T=0;T<u;T++){var A=a[T];if(0<A&&1>A){var R=A;M!=null&&(R=0<$?M.Tx(A)/$:0),this.wb.fD(v,_,R,this.pm());var D=this.yj(this.cd(s),y,this.pm());if(f++,M!=null){var V=M.fl(0,A);R=this.Va(this.Na(D)),this.Zg(R,V),this.mf(D,V.xc()),T!=u-1&&a[T+1]!=1||(A=M.fl(A,1),this.Zg(R,A))}}}return f},l.prototype.HX=function(s,a,u){var f=0,y=this.V(s);if(y==-1)throw d.i.ga("internal error");var v=this.Va(s),_=this.Va(y),M=this.Uh(v),$=M==null?this.wb.Ar(v,_):M.Rb(),T=0;s=this.cd(s);for(var A=0;A<u;A++){var R=a[A];if(T<R&&1>R){var D=R;if(M!=null&&(D=0<$?M.Tx(R)/$:0),this.wb.fD(v,_,D,this.pm()),D=this.tS(s,y,this.pm()),f++,M!=null){T=M.fl(T,R);var V=this.Va(this.Na(D));this.Zg(V,T),this.Db(D,T.qa,T.ma),A!=u-1&&a[A+1]!=1||(T=M.fl(R,1),D=this.Va(D),this.Zg(D,T))}}T=R}return f},l.prototype.tS=function(s,a,u){var f=a!=-1?this.Na(a):this.tj(s),y=f!=-1?this.V(f):-1,v=this.jI(u==null?this.gd:-1),_=this.Va(v);return u!=null&&this.wb.It(_,u),this.cj(v,s),this.Cc(v,y),this.Dc(v,f),y!=-1&&this.Dc(y,v),f!=-1&&this.Cc(f,v),u=this.ec(s),f=this.Ya(s),a==-1&&this.Yg(s,v),a==f&&(u&&f!=-1||this.Kf(s,v)),u&&y==-1&&(this.Cc(v,v),this.Dc(v,v)),this.Xj(s,this.Ka(s)+1),s=this.Sf(s),this.Vj(s,this.I(s)+1),v},l.prototype.pE=function(s,a,u){var f=this.Va(a),y=this.Va(u);if(0>f||y>this.gd-1)throw d.i.O("invalid call");if(f>y&&!this.ec(s))throw d.i.O("cannot iterate across an open path");for(s=0;a!=u;a=this.V(a))f=this.Va(a),(y=this.Uh(f))!=null?s+=y.Rb():(y=this.Va(this.V(a)),s+=this.wb.Ar(f,y));return s},l.prototype.Fh=function(s,a){var u=this.Va(s);this.wb.It(u,a),(u=this.Uh(u))!=null&&u.setStart(a),(s=this.Na(s))!=-1&&(s=this.Va(s),this.Uh(s)!=null&&u.setEnd(a))},l.prototype.Xi=function(s,a){s=this.Va(s),this.wb.we(s,a)},l.prototype.mf=function(s,a){this.Db(s,a.x,a.y)},l.prototype.Db=function(s,a,u){var f=this.Va(s);this.wb.Db(f,a,u),(f=this.Uh(f))!=null&&f.UB(a,u),(s=this.Na(s))!=-1&&(s=this.Va(s),this.Uh(s)!=null&&f.Sl(a,u))},l.prototype.D=function(s,a){this.wb.D(this.ud.U(s,0),a)},l.prototype.Hc=function(s,a){this.wb.Aa[0].uc(2*this.ud.U(s,0),a)},l.prototype.Oa=function(s){var a=new d.h;return this.wb.D(this.ud.U(s,0),a),a},l.prototype.ZF=function(s,a){this.jt.uc(2*s,a)},l.prototype.Vc=function(s,a,u){return this.wb.Vc(s,this.Va(a),u)},l.prototype.setAttribute=function(s,a,u,f){this.wb.setAttribute(s,this.Va(a),u,f)},l.prototype.Va=function(s){return this.ud.U(s,0)},l.prototype.kh=function(){var s=new d.h;return this.D(void 0,s),s.y},l.prototype.hq=function(s,a){s=this.Va(s),a=this.Va(a);var u=this.wb.Aa[0].o;return u[2*s]===u[2*a]&&u[2*s+1]===u[2*a+1]},l.prototype.Fv=function(s,a){s=this.Va(s);var u=this.wb.Aa[0].o;return u[2*s]===a.x&&u[2*s+1]===a.y},l.prototype.rX=function(s,a){if(1>a&&(a=1),this.Ug==null){if(a==1)return;this.Ug=d.Zc.Fn(this.wb.I(),1)}(s=this.Va(s))>=this.Ug.size&&this.Ug.resize(s+1,1),this.Ug.write(s,a)},l.prototype.YF=function(s){return s=this.Va(s),this.Ug==null||s>=this.Ug.size?1:this.Ug.read(s)},l.prototype.Sa=function(s,a,u){a=this.di[a],s=this.Va(s),a.size<this.wb.I()&&a.resize(this.wb.I(),-1),a.write(s,u)},l.prototype.Qa=function(s,a){return(s=this.Va(s))<(a=this.di[a]).size?a.read(s):-1},l.prototype.Hd=function(){this.di==null&&(this.di=[]);for(var s=0;s<this.di.length;s++)if(this.di[s]==null)return this.di[s]=d.Zc.Qh(0,-1),s;return this.di.push(d.Zc.Qh(0,-1)),this.di.length-1},l.prototype.Ud=function(s){this.di[s]=null},l.prototype.cc=function(s){return this.Te!=null?(s=this.Va(s),this.Te[s]):null},l.prototype.fd=function(s,a){var u=this.ud.U(s,2);if(u==-1)return!1;if(this.aA){var f=new d.Ta;this.Xi(s,f),a.setStart(f),this.Xi(u,f),a.setEnd(f)}else this.wb.Hc(this.ud.U(s,0),dt),a.gm(0,dt),this.wb.Hc(this.ud.U(u,0),dt),a.gm(1,dt);return!0},l.prototype.hW=function(s,a,u){if(this.aA){var f=new d.Ta;this.Xi(s,f),u.setStart(f),this.Xi(a,f),u.setEnd(f)}else this.wb.Hc(s,dt),u.gm(0,dt),this.wb.Hc(a,dt),u.gm(1,dt)},l.prototype.wf=function(s,a){if(a!=-1){if(s!=this.Sf(a))throw d.i.Ra();var u=this.es(a)}else u=this.mv(s);var f=this.rU(s);return a!=-1&&this.ep(a,f),this.cp(f,a),this.ep(f,u),u!=-1?this.cp(u,f):this.ap(s,f),a==-1&&this.bp(s,f),this.Tl(s,this.ea(s)+1),f},l.prototype.iG=function(s,a,u,f){s=this.wf(s,-1);for(var y=0,v=a,_=!1;v==u&&(_=!0),this.cj(v,s),y++,(v=this.V(v))!=a;);return this.mn(s,!0),this.Xj(s,y),_&&(a=u),this.Kf(s,a),this.Yg(s,this.Na(a)),this.fp(s,!1),f!=null&&(f[0]=_),s},l.prototype.ar=function(s){var a=this.es(s),u=this.Sb(s),f=this.Sf(s);return a!=-1?this.cp(a,u):this.ap(f,u),u!=-1?this.ep(u,a):this.bp(f,a),this.vO(s),this.Tl(f,this.ea(f)-1),this.nF(s),u},l.prototype.vO=function(s){var a=this.Ya(s);if(a!=-1){for(var u=0,f=this.Ka(s);u<f;u++){var y=a;a=this.V(a),this.Qy(y)}a=this.Sf(s),this.Vj(a,this.I(a)-this.Ka(s))}this.Xj(s,0)},l.prototype.Sb=function(s){return this.nd.U(s,2)},l.prototype.es=function(s){return this.nd.U(s,1)},l.prototype.Ka=function(s){return this.nd.U(s,3)},l.prototype.ec=function(s){return(1&this.Up(s))!=0},l.prototype.mn=function(s,a){if(this.ec(s)!=a){if(0<this.Ka(s)){var u=this.Ya(s),f=this.tj(s);a?(this.Cc(f,u),this.Dc(u,f),u=this.Va(f)):(this.Cc(f,-1),this.Dc(u,-1),u=this.Va(f)),this.Zg(u,null)}this.QB(s,(1|this.Up(s))-1|(a?1:0))}},l.prototype.Sf=function(s){return this.nd.U(s,7)},l.prototype.TS=function(s){return(2&this.Up(s))!=0},l.prototype.KB=function(s,a){this.QB(s,(2|this.Up(s))-2|(a?2:0))},l.prototype.qz=function(s){if(this.YS(s))return this.Qi.get(this.sv(s));var a=new d.zb,u=this.Ya(s);if(u==-1)return 0;var f=new d.h;this.D(u,f);for(var y=0,v=0,_=this.Ka(s);v<_;v++,u=this.V(u)){var M=this.cc(u);if(M==null){if(!this.fd(u,a))continue;M=a}y+=M.Sx(f.x,f.y)}return this.fp(s,!0),this.Qi.set(this.sv(s),y),y},l.prototype.ir=function(s,a,u){a=this.Ek[a],s=this.sv(s),a.size<this.Qi.size&&a.resize(this.Qi.size,-1),a.write(s,u)},l.prototype.uj=function(s,a){return(s=this.sv(s))<(a=this.Ek[a]).size?a.read(s):-1},l.prototype.Fy=function(){this.Ek==null&&(this.Ek=[]);for(var s=0;s<this.Ek.length;s++)if(this.Ek[s]==null)return this.Ek[s]=d.Zc.Qh(0),s;return this.Ek.push(d.Zc.Qh(0)),this.Ek.length-1},l.prototype.xB=function(s){this.Ek[s]=null},l.prototype.UT=function(s,a,u){if(u==-1)throw d.i.O();if(a!=u){var f=this.Sb(u),y=this.es(u),v=this.Sf(u);y==-1?this.ap(v,f):this.cp(y,f),f==-1?this.bp(v,y):this.ep(f,y),this.Vj(v,this.I(v)-this.Ka(u)),this.Tl(v,this.ea(v)-1),y=a==-1?this.mv(s):this.es(a),this.ep(u,y),this.cp(u,a),a==-1?this.bp(s,u):this.ep(a,u),y==-1?this.ap(s,u):this.cp(y,u),this.Vj(s,this.I(s)+this.Ka(u)),this.Tl(s,this.ea(s)+1),this.gx(u,s)}},l.prototype.kj=function(s,a){this.wb.we(this.Va(a),this.pm()),this.yj(s,-1,this.pm())},l.prototype.qd=function(s,a){var u=this.cd(s),f=this.Na(s),y=this.V(s);f!=-1&&this.Cc(f,y);var v=this.Ka(u);if(s==this.Ya(u)&&this.Kf(u,1<v?y:-1),y!=-1&&this.Dc(y,f),s==this.tj(u)&&this.Yg(u,1<v?f:-1),f!=-1&&y!=-1){f=this.Va(f);var _=this.Va(y);a?(a=this.Uh(f))!=null&&(f=new d.h,this.wb.D(_,f),a.Rc(f)):(_=this.Va(s),a=this.Uh(_),this.Zg(f,a),a!=null&&(f=this.wb.Oa(f),a.Ec(f)))}return this.Xj(u,v-1),u=this.Sf(u),this.Vj(u,this.I(u)-1),this.Qy(s),y},l.prototype.Ya=function(s){return this.nd.U(s,4)},l.prototype.tj=function(s){return this.nd.U(s,5)},l.prototype.V=function(s){return this.ud.U(s,2)},l.prototype.Na=function(s){return this.ud.U(s,1)},l.prototype.cd=function(s){return this.ud.U(s,3)},l.prototype.hc=function(s,a){return this.yj(s,-1,a)},l.prototype.$q=function(s){if(s===void 0)return this.$q(!1);if(s instanceof p)return new p(s);var a,u=-1,f=-1,y=-1,v=0,_=!1;for(a=this.md;a!=-1;a=this.ve(a))if(!s||d.ba.Ic(this.jc(a))){for(u=this.Ob(a);u!=-1;u=this.Sb(u))if(y=f=this.Ya(u),v=0,f!=-1){_=!0;break}if(_)break}return p.vP(this,a,u,f,y,v,s)},l.prototype.Pc=function(s){if(this.Kl.Pc(s),this.Te!=null)for(var a=0,u=this.Te.length;a<u;a++)this.Te[a]!=null&&this.Te[a].Pc(s)},l.prototype.lr=function(s,a,u,f){f?this.JX(s,a,u):this.IX(s,a,u)},l.prototype.Dc=function(s,a){this.ud.T(s,1,a)},l.prototype.Cc=function(s,a){this.ud.T(s,2,a)},l.prototype.cj=function(s,a){this.ud.T(s,3,a)},l.prototype.Xj=function(s,a){this.nd.T(s,3,a)},l.prototype.Kf=function(s,a){this.nd.T(s,4,a)},l.prototype.Yg=function(s,a){this.nd.T(s,5,a)},l.prototype.Tl=function(s,a){this.dd.T(s,6,a)},l.prototype.Vj=function(s,a){this.dd.T(s,5,a)},l.prototype.kJ=function(s){var a=s;do{var u=this.V(a);this.Cc(a,this.Na(a)),this.Dc(a,u),a=u}while(a!=s)},l.prototype.XB=function(s){this.gd=s},l.prototype.br=function(s){var a=this.es(s),u=this.Sb(s),f=this.Sf(s);a!=-1?this.cp(a,u):this.ap(f,u),u!=-1?this.ep(u,a):this.bp(f,a),this.Kf(s,-1),this.Yg(s,-1),this.nF(s)},l.prototype.oi=function(s,a){var u=this.Na(s),f=this.V(s);if(u!=-1&&this.Cc(u,f),f!=-1&&this.Dc(f,u),u!=-1&&f!=-1)if(u=this.Va(u),f=this.Va(f),a){if((a=this.Uh(u))!=null){var y=new d.h;this.wb.D(f,y),a.Rc(y)}}else a=this.Va(s),a=this.Uh(a),this.Zg(u,a),a!=null&&(y=new d.h,this.wb.D(u,y),a.Ec(y));this.Qy(s)},l.prototype.YS=function(s){return(4&this.Up(s))!=0},l.prototype.fp=function(s,a){this.QB(s,(4|this.Up(s))-4|(a?4:0))},l.prototype.nx=function(s,a){var u=this.ud.o;this.wb.oc();var f=this.wb.Aa[0].o;s.Wd(0,a,function(y,v){var _=u[5*y];y=u[5*v],v=f[2*_],_=f[2*_+1];var M=f[2*y];return _<(y=f[2*y+1])?-1:_>y?1:v<M?-1:v>M?1:0})},l.prototype.eS=function(){for(var s=this.md;s!=-1;s=this.ve(s))if(!d.ba.Ic(this.jc(s)))return!0;return!1},l.prototype.cC=function(s,a){for(var u=this.Ob(s),f=this.Ob(a),y=this.mv(s),v=this.mv(a),_=this.Ob(s);_!=-1;_=this.Sb(_))this.gx(_,a);for(_=this.Ob(a);_!=-1;_=this.Sb(_))this.gx(_,s);this.ap(s,f),this.ap(a,u),this.bp(s,v),this.bp(a,y),u=this.I(s),f=this.ea(s),y=this.ea(a),this.Vj(s,this.I(a)),this.Vj(a,u),this.Tl(s,y),this.Tl(a,f),u=this.dd.U(s,2),this.dd.T(s,2,this.dd.U(a,2)),this.dd.T(a,2,u)},l}(),d.hd=O})(Q||(Q={})),function(d){var O=function(S){function p(l,s,a,u){var f=S.call(this)||this;return f.aa=new d.l,l===void 0?f.PE():typeof l=="number"?f.QO(l,s,a,u):l instanceof d.Ta?s!==void 0?f.Su(l,s,a):f.RO(l):l instanceof d.sa?s!==void 0?f.TO(l,s):f.SO(l):l instanceof d.l?f.PO(l):f.PE(),f}return Pe(p,S),p.prototype.Su=function(l,s,a){this.description=d.fe.pg(),this.aa.Pa(),l.B()||this.vu(l,s,a)},p.prototype.PO=function(l){this.description=d.fe.pg(),this.aa.L(l),this.aa.normalize()},p.prototype.SO=function(l){if(l==null)throw d.i.O();this.description=l,this.aa.Pa()},p.prototype.TO=function(l,s){if(l==null)throw d.i.O();this.description=l,this.aa.L(s),this.aa.normalize()},p.prototype.PE=function(){this.description=d.fe.pg(),this.aa.Pa()},p.prototype.RO=function(l){this.description=d.fe.pg(),this.aa.Pa(),l.B()||this.vu(l)},p.prototype.QO=function(l,s,a,u){this.description=d.fe.pg(),this.L(l,s,a,u)},p.prototype.L=function(l,s,a,u){if(this.wc(),typeof l=="number")this.aa.L(l,s,a,u);else for(this.Pa(),s=0,a=l.length;s<a;s++)this.$b(l[s])},p.prototype.Zo=function(l){if(this.wc(),!l.aT())throw d.i.O();this.aa.L(l)},p.prototype.Pa=function(){this.wc(),this.aa.Pa()},p.prototype.B=function(){return this.aa.B()},p.prototype.S=function(){return this.aa.S()},p.prototype.da=function(){return this.aa.da()},p.prototype.ik=function(){return this.aa.ik()},p.prototype.Lp=function(){return this.aa.Lp()},p.prototype.Kp=function(){return this.aa.tf()},p.prototype.$b=function(l){if(l instanceof d.h)this.wc(),this.aa.$b(l);else if(l instanceof d.l)this.wc(),this.aa.$b(l);else if(l instanceof d.Ta){if(this.wc(),!l.Bc()){var s=l.description;if(this.description!=s&&this.Ll(s),this.B())this.vu(l);else{this.aa.$b(l.D());for(var a=1,u=s.Ba;a<u;a++)for(var f=s.Fd(a),y=d.sa.Wa(f),v=0;v<y;v++){var _=l.Vc(f,v),M=this.Vg(f,v);M.$b(_),this.setInterval(f,v,M)}}}}else if(l instanceof p&&!l.B())for((s=l.description)!=this.description&&this.Ll(s),this.aa.$b(l.aa),a=1,u=s.Ba;a<u;a++)for(f=s.ld(a),y=d.sa.Wa(f),v=0;v<y;v++)_=l.Vg(f,v),(M=this.Vg(f,v)).$b(_),this.setInterval(f,v,M)},p.prototype.vu=function(l,s,a){if(s!==void 0){this.aa.L(l.D(),s,a),a=1;for(var u=(s=l.description).Ba;a<u;a++)for(var f=s.Fd(a),y=d.sa.Wa(f),v=0;v<y;v++){var _=l.Vc(f,v);this.setInterval(f,v,_,_)}}else for(this.aa.L(l.la[0],l.la[1]),a=1,u=(s=l.description).Ba;a<u;a++)for(f=s.Fd(a),y=d.sa.Wa(f),v=0;v<y;v++)_=l.Vc(f,v),this.setInterval(f,v,_,_)},p.prototype.setInterval=function(l,s,a,u){if(a=typeof a=="number"?new d.Oc(a,u):a,this.wc(),l==0)if(s==0)this.aa.v=a.pa,this.aa.C=a.wa;else{if(s!=1)throw d.i.de();this.aa.G=a.pa,this.aa.H=a.wa}else this.qD(0,l,s,a.pa),this.qD(1,l,s,a.wa)},p.prototype.X=function(l,s){this.wc(),this.aa.X(l,s)},p.prototype.Pc=function(l){if(l instanceof d.Ed)this.wc(),l.hC(this.aa);else if(this.wc(),!this.aa.B()){var s=new d.JK;this.So(s),s.SS()?s.Pa():l.hC(s)}},p.prototype.copyTo=function(l){if(l.K()!=this.K())throw d.i.O();if(l.wc(),l.description=this.description,l.aa.L(this.aa),l.la=null,this.la!=null){l.qu();for(var s=0;s<2*(this.description.Be.length-2);s++)l.la[s]=this.la[s]}},p.prototype.Ja=function(){return new p(this.description)},p.prototype.He=function(){return this.aa.rF()},p.prototype.Rb=function(){return this.aa.tR()},p.prototype.K=function(){return 197},p.prototype.Eb=function(){return 2},p.prototype.dn=function(l){this.copyTo(l)},p.prototype.A=function(l){l.v=this.aa.v,l.G=this.aa.G,l.C=this.aa.C,l.H=this.aa.H},p.prototype.So=function(l){l.v=this.aa.v,l.G=this.aa.G,l.C=this.aa.C,l.H=this.aa.H,l.L(this.aa.v,this.aa.G,this.Pd(0,1,0),this.aa.C,this.aa.H,this.Pd(1,1,0))},p.prototype.Vg=function(l,s){var a=new d.Oc;return a.L(this.Pd(0,l,s),this.Pd(1,l,s)),a},p.prototype.If=function(l,s){s.Pf(this.description);var a=this.description.Ba-1;switch(l){case 0:for(l=0;l<a;l++)for(var u=this.description.ld(l),f=d.sa.Wa(u),y=0;y<f;y++)s.setAttribute(u,y,this.Pd(0,u,y));s.Db(this.aa.v,this.aa.G);break;case 1:for(l=0;l<a;l++)for(u=this.description.ld(l),f=d.sa.Wa(u),y=0;y<f;y++)s.setAttribute(u,y,this.Pd(1,u,y));s.Db(this.aa.v,this.aa.H);break;case 2:for(l=0;l<a;l++)for(u=this.description.ld(l),f=d.sa.Wa(u),y=0;y<f;y++)s.setAttribute(u,y,this.Pd(0,u,y));s.Db(this.aa.C,this.aa.H);break;case 3:for(l=0;l<a;l++)for(u=this.description.ld(l),f=d.sa.Wa(u),y=0;y<f;y++)s.setAttribute(u,y,this.Pd(1,u,y));s.Db(this.aa.C,this.aa.G);break;default:throw d.i.de()}},p.prototype.hB=function(l,s){l=this.aa.hB(l),s.na(l.x,l.y)},p.prototype.fR=function(l,s){return s*(l.Qq-2)},p.prototype.sF=function(l,s,a){if(this.aa.B())throw d.i.ga("empty geometry");if(s==0)return l!=0?a!=0?this.aa.H:this.aa.C:a!=0?this.aa.G:this.aa.v;if(a>=d.sa.Wa(s))throw d.i.O();var u=this.description.Rf(s);return this.qu(),0<=u?this.la[this.fR(this.description,l)+this.description.GR(u)-2+a]:d.sa.te(s)},p.prototype.qu=function(){if(this.wc(),this.la==null&&2<this.description.Be.length){this.la=[];for(var l=p.Ig(this.description,0),s=p.Ig(this.description,1),a=0,u=1,f=this.description.Ba;u<f;u++){var y=this.description.ld(u),v=d.sa.Wa(y);y=d.sa.te(y);for(var _=0;_<v;_++)this.la[l+a]=y,this.la[s+a]=y,a++}}},p.prototype.un=function(l){if(this.la!=null)if(2<l.Be.length){for(var s=d.fe.Kw(l,this.description),a=[],u=p.Ig(this.description,0),f=p.Ig(this.description,1),y=p.Ig(l,0),v=p.Ig(l,1),_=0,M=1,$=l.Ba;M<$;M++){var T=l.ld(M),A=d.sa.Wa(T);if(s[M]==-1){var R=d.sa.te(T);for(T=0;T<A;T++)a[y+_]=R,a[v+_]=R,_++}else for(R=this.description.bk(s[M])-2,T=0;T<A;T++)a[y+_]=this.la[u+R],a[v+_]=this.la[f+R],_++,R++}this.la=a}else this.la=null;this.description=l},p.prototype.Pd=function(l,s,a){if(this.aa.B())throw d.i.ga("This operation was performed on an Empty Geometry.");if(s==0)return l!=0?a!=0?this.aa.H:this.aa.C:a!=0?this.aa.G:this.aa.v;if(a>=d.sa.Wa(s))throw d.i.de();var u=this.description.Rf(s);return 0<=u?(this.qu(),this.la[p.Ig(this.description,l)+this.description.bk(u)-2+a]):d.sa.te(s)},p.prototype.qD=function(l,s,a,u){if(this.wc(),s==0)l!=0?a!=0?this.aa.H=u:this.aa.C=u:a!=0?this.aa.G=u:this.aa.v=u;else{if(a>=d.sa.Wa(s))throw d.i.de();if(!this.hasAttribute(s)){if(d.sa.yG(s,u))return;this.se(s)}s=this.description.Rf(s),this.qu(),this.la[p.Ig(this.description,l)+this.description.bk(s)-2+a]=u}},p.Ig=function(l,s){return s*(l.Be.length-2)},p.prototype.Fa=function(l){this.wc();var s=new d.l;return l.A(s),this.aa.Fa(s)},p.prototype.isIntersecting=function(l){return l instanceof d.l?this.aa.isIntersecting(l):this.aa.isIntersecting(l.aa)},p.prototype.Lu=function(l,s){this.wc(),l.B()?this.Pa():s!==void 0?this.vu(l,s,void 0):this.aa.Lu(l.Ng(),l.kh())},p.prototype.offset=function(l,s){this.wc(),this.aa.offset(l,s)},p.prototype.normalize=function(){this.wc(),this.aa.normalize()},p.prototype.tf=function(l){if(l===void 0){if(l=new d.Ta(this.description),this.B())return l;for(s=this.description.Ba,a=1;a<s;a++)for(u=this.description.Fd(a),f=d.sa.Wa(u),y=0;y<f;y++)v=.5*(this.Pd(0,u,y)+this.Pd(1,u,y)),l.setAttribute(u,y,v);return l.Db(this.aa.ik(),this.aa.Lp()),l}if(l.Pf(this.description),this.B())l.Pa();else{for(var s=this.description.Ba,a=1;a<s;a++)for(var u=this.description.ld(a),f=d.sa.Wa(u),y=0;y<f;y++){var v=.5*(this.sF(0,u,y)+this.sF(1,u,y));l.setAttribute(u,y,v)}l.Db(this.aa.tf())}},p.prototype.hz=function(){return new d.Ta(this.aa.hz())},p.prototype.contains=function(l){return l instanceof d.Ta?!l.B()&&this.aa.contains(l.Ng(),l.kh()):this.aa.contains(l.aa)},p.prototype.ZO=function(l){return this.aa.contains(l)},p.prototype.Nb=function(l){if(l==this)return!0;if(!(l instanceof p)||this.description!=l.description)return!1;if(this.B())return!!l.B();if(!this.aa.Nb(l.aa))return!1;for(var s=0,a=2*(this.description.Be.length-2);s<a;s++)if(this.la[s]!=l.la[s])return!1;return!0},p.prototype.dc=function(){var l=this.description.dc();if(l=d.P.Vh(l,this.aa.dc()),!this.B()&&this.la!=null)for(var s=0,a=2*(this.description.Be.length-2);s<a;s++)l=d.P.Vh(l,this.la[s]);return l},p.prototype.gs=function(){return this.aa.v},p.prototype.js=function(){return this.aa.G},p.prototype.fs=function(){return this.aa.C},p.prototype.hs=function(){return this.aa.H},p.prototype.ng=function(){return d.si.im(this,null)},p.prototype.toString=function(){return this.B()?"Envelope: []":"Envelope: ["+this.aa.v+", "+this.aa.G+", "+this.aa.C+", "+this.aa.H+"]"},p}(d.ba);d.Hh=O}(Q||(Q={})),function(d){var O=function(){function S(p,l,s,a){p===void 0?this.Pa():(this.v=p,this.G=l,this.C=s,this.H=a)}return S.construct=function(p,l,s,a){var u=new S;return u.v=p,u.G=l,u.C=s,u.H=a,u},S.prototype.L=function(p,l,s,a){typeof p=="number"?s!==void 0?(this.v=p,this.G=l,this.C=s,this.H=a,this.normalize()):(this.v=p,this.G=l,this.C=p,this.H=l):p instanceof d.h?l!==void 0?(this.v=p.x-.5*l,this.C=this.v+l,this.G=p.y-.5*s,this.H=this.G+s,this.normalize()):(this.v=p.x,this.G=p.y,this.C=p.x,this.H=p.y):p instanceof S?this.L(p.v,p.G,p.C,p.H):p instanceof d.Oc&&(p.B()||l.B()?this.Pa():(this.v=p.pa,this.C=p.wa,this.G=l.pa,this.H=l.wa))},S.prototype.bx=function(p,l){if(l!==void 0)if(l==0)this.Pa();else{this.v=p[0].x,this.G=p[0].y,this.C=this.v,this.H=this.G;for(var s=1;s<l;s++){var a=p[s];a.x<this.v?this.v=a.x:a.x>this.C&&(this.C=a.x),a.y<this.G?this.G=a.y:a.y>this.H&&(this.H=a.y)}}else if(p==null||p.length==0)this.Pa();else for(a=p[0],this.L(a.x,a.y),s=1;s<p.length;s++)l=p[s],this.Nk(l.x,l.y)},S.prototype.Pa=function(){this.H=this.C=this.G=this.v=NaN},S.prototype.B=function(){return isNaN(this.v)},S.prototype.$b=function(p,l){typeof p=="number"?this.B()?(this.v=p,this.G=l,this.C=p,this.H=l):(this.v>p?this.v=p:this.C<p&&(this.C=p),this.G>l?this.G=l:this.H<l&&(this.H=l)):p instanceof d.h||p instanceof d.Od?this.$b(p.x,p.y):p instanceof S&&!p.B()&&(this.$b(p.v,p.G),this.$b(p.C,p.H))},S.prototype.Nk=function(p,l){this.v>p?this.v=p:this.C<p&&(this.C=p),this.G>l?this.G=l:this.H<l&&(this.H=l)},S.prototype.X=function(p,l){this.B()||(this.v-=p,this.C+=p,this.G-=l,this.H+=l,(this.v>this.C||this.G>this.H)&&this.Pa())},S.prototype.scale=function(p){0>p&&this.Pa(),this.B()||(this.v*=p,this.C*=p,this.G*=p,this.H*=p)},S.prototype.zoom=function(p,l){this.B()||this.L(this.tf(),p*this.S(),l*this.da())},S.prototype.isIntersecting=function(p){return!this.B()&&!p.B()&&(this.v<=p.v?this.C>=p.v:p.C>=this.v)&&(this.G<=p.G?this.H>=p.G:p.H>=this.G)},S.prototype.CG=function(p){return(this.v<=p.v?this.C>=p.v:p.C>=this.v)&&(this.G<=p.G?this.H>=p.G:p.H>=this.G)},S.prototype.Fa=function(p){return!this.B()&&!p.B()&&(p.v>this.v&&(this.v=p.v),p.C<this.C&&(this.C=p.C),p.G>this.G&&(this.G=p.G),p.H<this.H&&(this.H=p.H),(p=this.v<=this.C&&this.G<=this.H)||this.Pa(),p)},S.prototype.hB=function(p){switch(p){case 0:return d.h.construct(this.v,this.G);case 1:return d.h.construct(this.v,this.H);case 2:return d.h.construct(this.C,this.H);case 3:return d.h.construct(this.C,this.G);default:throw d.i.de()}},S.prototype.iB=function(p){if(p==null||4>p.length)throw d.i.O();p[0]!=null?p[0].na(this.v,this.G):p[0]=d.h.construct(this.v,this.G),p[1]!=null?p[1].na(this.v,this.H):p[1]=d.h.construct(this.v,this.H),p[2]!=null?p[2].na(this.C,this.H):p[2]=d.h.construct(this.C,this.H),p[3]!=null?p[3].na(this.C,this.G):p[3]=d.h.construct(this.C,this.G)},S.prototype.rF=function(){return this.B()?0:this.S()*this.da()},S.prototype.tR=function(){return this.B()?0:2*(this.S()+this.da())},S.prototype.ik=function(){return(this.C+this.v)/2},S.prototype.Lp=function(){return(this.H+this.G)/2},S.prototype.S=function(){return this.C-this.v},S.prototype.da=function(){return this.H-this.G},S.prototype.move=function(p,l){this.B()||(this.v+=p,this.G+=l,this.C+=p,this.H+=l)},S.prototype.Lu=function(p,l){if(l!==void 0)this.move(p-this.ik(),l-this.Lp());else if(p instanceof d.h)this.Lu(p.x,p.y);else{if(!(p instanceof d.Ta))throw d.i.O();l=(this.C-this.v)/2;var s=(this.H-this.G)/2;this.v=p.Ng()-l,this.C=p.Ng()+l,this.G=p.kh()-s,this.H=p.kh()+s}},S.prototype.offset=function(p,l){this.v+=p,this.C+=p,this.G+=l,this.H+=l},S.prototype.normalize=function(){if(!this.B()){var p=Math.min(this.v,this.C),l=Math.max(this.v,this.C);this.v=p,this.C=l,p=Math.min(this.G,this.H),l=Math.max(this.G,this.H),this.G=p,this.H=l}},S.prototype.fn=function(p){p.na(this.v,this.G)},S.prototype.VI=function(p){p.na(this.C,this.G)},S.prototype.YI=function(p){p.na(this.v,this.H)},S.prototype.gn=function(p){p.na(this.C,this.H)},S.prototype.aT=function(){return this.B()||this.v<=this.C&&this.G<=this.H},S.prototype.tf=function(){return d.h.construct((this.C+this.v)/2,(this.H+this.G)/2)},S.prototype.hz=function(){return d.h.construct(this.v,this.G)},S.prototype.contains=function(p,l){if(l!==void 0)return p>=this.v&&p<=this.C&&l>=this.G&&l<=this.H;if(p instanceof d.Ta)return this.contains(p.Ng(),p.kh());if(p instanceof d.h)return this.contains(p.x,p.y);if(p instanceof S)return p.v>=this.v&&p.C<=this.C&&p.G>=this.G&&p.H<=this.H;throw d.i.O()},S.prototype.jm=function(p,l){if(l!==void 0)return p>this.v&&p<this.C&&l>this.G&&l<this.H;if(p instanceof d.h)return this.jm(p.x,p.y);if(p instanceof S)return p.v>this.v&&p.C<this.C&&p.G>this.G&&p.H<this.H;throw d.i.O()},S.prototype.Nb=function(p){return p==this||p instanceof S&&(!(!this.B()||!p.B())||this.v==p.v&&this.G==p.G&&this.C==p.C&&this.H==p.H)},S.prototype.dc=function(){var p=this.v;p=d.P.truncate(p^p>>>32);var l=d.P.Vh(p);return p=this.C,p=d.P.truncate(p^p>>>32),l=d.P.Vh(p,l),p=this.G,p=d.P.truncate(p^p>>>32),l=d.P.Vh(p,l),p=this.H,p=d.P.truncate(p^p>>>32),d.P.Vh(p,l)},S.prototype.zr=function(){return this.B()?2220446049250313e-29:2220446049250313e-29*(Math.abs(this.v)+Math.abs(this.C)+Math.abs(this.G)+Math.abs(this.H)+1)},S.prototype.uy=function(p,l){var s=this.ak(p),a=this.ak(l);if((s&a)!=0)return 0;if((s|a)==0)return 4;var u=(s!=0?1:0)|(a!=0?2:0);do{var f=l.x-p.x,y=l.y-p.y;if(f>y?(s&S.TC)!=0?((s&S.lu)!=0?(p.y+=y*(this.v-p.x)/f,p.x=this.v):(p.y+=y*(this.C-p.x)/f,p.x=this.C),s=this.ak(p)):(a&S.TC)!=0?((a&S.lu)!=0?(l.y+=y*(this.v-l.x)/f,l.x=this.v):(l.y+=y*(this.C-l.x)/f,l.x=this.C),a=this.ak(l)):s!=0?((s&S.mu)!=0?(p.x+=f*(this.G-p.y)/y,p.y=this.G):(p.x+=f*(this.H-p.y)/y,p.y=this.H),s=this.ak(p)):((a&S.mu)!=0?(l.x+=f*(this.G-l.y)/y,l.y=this.G):(l.x+=f*(this.H-l.y)/y,l.y=this.H),a=this.ak(l)):(s&S.UC)!=0?((s&S.mu)!=0?(p.x+=f*(this.G-p.y)/y,p.y=this.G):(p.x+=f*(this.H-p.y)/y,p.y=this.H),s=this.ak(p)):(a&S.UC)!=0?((a&S.mu)!=0?(l.x+=f*(this.G-l.y)/y,l.y=this.G):(l.x+=f*(this.H-l.y)/y,l.y=this.H),a=this.ak(l)):s!=0?((s&S.lu)!=0?(p.y+=y*(this.v-p.x)/f,p.x=this.v):(p.y+=y*(this.C-p.x)/f,p.x=this.C),s=this.ak(p)):((a&S.lu)!=0?(l.y+=y*(this.v-l.x)/f,l.x=this.v):(l.y+=y*(this.C-l.x)/f,l.x=this.C),a=this.ak(l)),(s&a)!=0)return 0}while((s|a)!=0);return u},S.prototype.ak=function(p){return(p.x<this.v?1:0)|(p.x>this.C?1:0)<<1|(p.y<this.G?1:0)<<2|(p.y>this.H?1:0)<<3},S.prototype.Di=function(p){return!this.B()&&(this.S()<=p||this.da()<=p)},S.prototype.ub=function(p){return p instanceof d.h?Math.sqrt(this.dK(p)):Math.sqrt(this.px(p))},S.prototype.px=function(p){var l=0,s=0,a=this.v-p.C;return a>l&&(l=a),(a=this.G-p.H)>s&&(s=a),(a=p.v-this.C)>l&&(l=a),(a=p.G-this.H)>s&&(s=a),l*l+s*s},S.prototype.dK=function(p){var l=0,s=0,a=this.v-p.x;return a>l&&(l=a),(a=this.G-p.y)>s&&(s=a),(a=p.x-this.C)>l&&(l=a),(a=p.y-this.H)>s&&(s=a),l*l+s*s},S.prototype.en=function(p){this.B()?p.Pa():p.L(this.v,this.C)},S.lu=1,S.mu=4,S.TC=3,S.UC=12,S}();d.l=O}(Q||(Q={})),function(d){var O,S;(S=O||(O={}))[S.initialize=0]="initialize",S[S.initializeRed=1]="initializeRed",S[S.initializeBlue=2]="initializeBlue",S[S.initializeRedBlue=3]="initializeRedBlue",S[S.sweep=4]="sweep",S[S.sweepBruteForce=5]="sweepBruteForce",S[S.sweepRedBlueBruteForce=6]="sweepRedBlueBruteForce",S[S.sweepRedBlue=7]="sweepRedBlue",S[S.sweepRed=8]="sweepRed",S[S.sweepBlue=9]="sweepBlue",S[S.iterate=10]="iterate",S[S.iterateRed=11]="iterateRed",S[S.iterateBlue=12]="iterateBlue",S[S.iterateBruteForce=13]="iterateBruteForce",S[S.iterateRedBlueBruteForce=14]="iterateRedBlueBruteForce",S[S.resetRed=15]="resetRed",S[S.resetBlue=16]="resetBlue";var p=function(){function l(s,a){this.ei=s,this.ZG=a}return l.prototype.qr=function(s,a,u){this.ei.FX(u,s,a,this.ZG)},l.prototype.bq=function(s){return this.ei.Tr(s,this.ZG)},l}();O=function(){function l(){this.qw=this.qo=this.ff=this.sd=null,this.yq=new d.l,this.Cm=this.Jj=this.Kj=this.Bd=this.Ff=this.Md=this.ew=this.io=this.rd=this.Fb=null,this.Yb=-1,this.ra=0,this.Pk()}return l.prototype.mr=function(){this.Pk(),this.Rv=!0,this.Fb==null?(this.io=new d.ja(0),this.Fb=[]):(this.io.Dh(0),this.Fb.length=0)},l.prototype.bd=function(s,a){if(!this.Rv)throw d.i.Hb();var u=new d.l;u.L(a),this.io.add(s),this.Fb.push(u)},l.prototype.Hp=function(){if(!this.Rv)throw d.i.Hb();this.Rv=!1,this.Fb!=null&&0<this.Fb.length&&(this.Yb=0,this.Jc=!1)},l.prototype.kK=function(){this.Pk(),this.Qv=!0,this.Fb==null?(this.io=new d.ja(0),this.Fb=[]):(this.io.Dh(0),this.Fb.length=0)},l.prototype.DD=function(s,a){if(!this.Qv)throw d.i.Hb();var u=new d.l;u.L(a),this.io.add(s),this.Fb.push(u)},l.prototype.dF=function(){if(!this.Qv)throw d.i.Hb();this.Qv=!1,this.Fb!=null&&0<this.Fb.length&&this.rd!=null&&0<this.rd.length&&(this.Yb==-1||this.Yb==2?this.Yb=3:this.Yb!=3&&(this.Yb=1),this.Jc=!1)},l.prototype.jK=function(){this.Pk(),this.Pv=!0,this.rd==null?(this.ew=new d.ja(0),this.rd=[]):(this.ew.Dh(0),this.rd.length=0)},l.prototype.zD=function(s,a){if(!this.Pv)throw d.i.Hb();var u=new d.l;u.L(a),this.ew.add(s),this.rd.push(u)},l.prototype.cF=function(){if(!this.Pv)throw d.i.Hb();this.Pv=!1,this.Fb!=null&&0<this.Fb.length&&this.rd!=null&&0<this.rd.length&&(this.Yb==-1||this.Yb==1?this.Yb=3:this.Yb!=3&&(this.Yb=2),this.Jc=!1)},l.prototype.next=function(){if(this.Jc)return!1;for(var s=!0;s;)switch(this.Yb){case 0:s=this.Bz();break;case 1:s=this.mS();break;case 2:s=this.jS();break;case 3:s=this.lS();break;case 4:s=this.QX();break;case 5:s=this.MX();break;case 6:s=this.NX();break;case 7:s=this.OX();break;case 8:s=this.tx();break;case 9:s=this.dC();break;case 10:s=this.Pz();break;case 11:s=this.eT();break;case 12:s=this.bT();break;case 13:s=this.cT();break;case 14:s=this.dT();break;case 15:s=this.fJ();break;case 16:s=this.eJ();break;default:throw d.i.Ra()}return!this.Jc},l.prototype.WB=function(s){this.ra=s},l.prototype.oz=function(s){return this.Fb[s]},l.prototype.Wy=function(s){return this.rd[s]},l.prototype.pl=function(s){return this.io.read(s)},l.prototype.jl=function(s){return this.ew.read(s)},l.Oz=function(s){return(1&s)==1},l.gq=function(s){return(1&s)==0},l.prototype.Pk=function(){this.Rv=this.Pv=this.Qv=!1,this.Df=this.Ef=this.Tg=this.qe=-1,this.Jc=!0},l.prototype.Bz=function(){if(this.Bf=this.Xf=-1,10>this.Fb.length)return this.qe=this.Fb.length,this.Yb=5,!0;this.sd==null&&(this.sd=new d.ur(!0),this.qo=this.sd.getIterator(),this.Md=new d.ja(0)),this.sd.mr();for(var s=0;s<this.Fb.length;s++){var a=this.Fb[s];this.sd.Dr(a.v,a.C)}for(this.sd.Hp(),this.Md.Jb(2*this.Fb.length),this.Md.resize(0),s=0;s<2*this.Fb.length;s++)this.Md.add(s);return this.Mt(this.Md,2*this.Fb.length,!0),this.qe=2*this.Fb.length,this.Yb=4,!0},l.prototype.mS=function(){if(this.Bf=this.Xf=-1,10>this.Fb.length||10>this.rd.length)return this.qe=this.Fb.length,this.Yb=6,!0;this.sd==null&&(this.sd=new d.ur(!0),this.qo=this.sd.getIterator(),this.Md=new d.ja(0)),this.sd.mr();for(var s=0;s<this.Fb.length;s++){var a=this.Fb[s];this.sd.Dr(a.v,a.C)}for(this.sd.Hp(),this.Md.Jb(2*this.Fb.length),this.Md.resize(0),s=0;s<2*this.Fb.length;s++)this.Md.add(s);return this.Mt(this.Md,this.Md.size,!0),this.qe=this.Md.size,this.Ef!=-1&&(this.Bd.eh(this.Ef),this.Kj.resize(0),this.Ef=-1),this.Yb=7,this.eJ()},l.prototype.jS=function(){if(this.Bf=this.Xf=-1,10>this.Fb.length||10>this.rd.length)return this.qe=this.Fb.length,this.Yb=6,!0;this.ff==null&&(this.ff=new d.ur(!0),this.qw=this.ff.getIterator(),this.Ff=new d.ja(0)),this.ff.mr();for(var s=0;s<this.rd.length;s++){var a=this.rd[s];this.ff.Dr(a.v,a.C)}for(this.ff.Hp(),this.Ff.Jb(2*this.rd.length),this.Ff.resize(0),s=0;s<2*this.rd.length;s++)this.Ff.add(s);return this.Mt(this.Ff,this.Ff.size,!1),this.Tg=this.Ff.size,this.Df!=-1&&(this.Bd.eh(this.Df),this.Jj.resize(0),this.Df=-1),this.Yb=7,this.fJ()},l.prototype.lS=function(){if(this.Bf=this.Xf=-1,10>this.Fb.length||10>this.rd.length)return this.qe=this.Fb.length,this.Yb=6,!0;this.sd==null&&(this.sd=new d.ur(!0),this.qo=this.sd.getIterator(),this.Md=new d.ja(0)),this.ff==null&&(this.ff=new d.ur(!0),this.qw=this.ff.getIterator(),this.Ff=new d.ja(0)),this.sd.mr();for(var s=0;s<this.Fb.length;s++){var a=this.Fb[s];this.sd.Dr(a.v,a.C)}for(this.sd.Hp(),this.ff.mr(),s=0;s<this.rd.length;s++)a=this.rd[s],this.ff.Dr(a.v,a.C);for(this.ff.Hp(),this.Md.Jb(2*this.Fb.length),this.Ff.Jb(2*this.rd.length),this.Md.resize(0),this.Ff.resize(0),s=0;s<2*this.Fb.length;s++)this.Md.add(s);for(s=0;s<2*this.rd.length;s++)this.Ff.add(s);return this.Mt(this.Md,this.Md.size,!0),this.Mt(this.Ff,this.Ff.size,!1),this.qe=this.Md.size,this.Tg=this.Ff.size,this.Ef!=-1&&(this.Bd.eh(this.Ef),this.Kj.resize(0),this.Ef=-1),this.Df!=-1&&(this.Bd.eh(this.Df),this.Jj.resize(0),this.Df=-1),this.Yb=7,!0},l.prototype.QX=function(){var s=this.Md.get(--this.qe),a=s>>1;return l.gq(s)?(this.sd.remove(a),this.qe!=0||(this.Bf=this.Xf=-1,this.Jc=!0,!1)):(this.qo.zB(this.Fb[a].v,this.Fb[a].C,this.ra),this.Xf=a,this.Yb=10,!0)},l.prototype.MX=function(){return--this.qe==-1?(this.Bf=this.Xf=-1,this.Jc=!0,!1):(this.Tg=this.Xf=this.qe,this.Yb=13,!0)},l.prototype.NX=function(){return--this.qe==-1?(this.Bf=this.Xf=-1,this.Jc=!0,!1):(this.Xf=this.qe,this.Tg=this.rd.length,this.Yb=14,!0)},l.prototype.OX=function(){var s=this.Md.get(this.qe-1),a=this.Ff.get(this.Tg-1),u=this.Tr(s,!0),f=this.Tr(a,!1);return u>f?this.tx():u<f?this.dC():l.Oz(s)?this.tx():l.Oz(a)?this.dC():this.tx()},l.prototype.tx=function(){var s=this.Md.get(--this.qe),a=s>>1;if(l.gq(s))return this.Ef!=-1&&this.Kj.get(a)!=-1?(this.Bd.kd(this.Ef,this.Kj.get(a)),this.Kj.set(a,-1)):this.sd.remove(a),this.qe!=0||(this.Bf=this.Xf=-1,this.Jc=!0,!1);if(this.Df!=-1&&0<this.Bd.ds(this.Df))for(s=this.Bd.sc(this.Df);s!=-1;){var u=this.Bd.getData(s);this.ff.xj(u),this.Jj.set(u,-1),u=this.Bd.lb(s),this.Bd.kd(this.Df,s),s=u}return 0<this.ff.size()?(this.qw.zB(this.Fb[a].v,this.Fb[a].C,this.ra),this.Xf=a,this.Yb=12):(this.Ef==-1&&(this.Bd==null&&(this.Bd=new d.lp),this.Kj=new d.ja(0),this.Kj.resize(this.Fb.length,-1),this.Kj.Yj(-1,0,this.Fb.length),this.Ef=this.Bd.Rh(1)),this.Kj.set(a,this.Bd.addElement(this.Ef,a)),this.Yb=7),!0},l.prototype.dC=function(){var s=this.Ff.get(--this.Tg),a=s>>1;if(l.gq(s))return this.Df!=-1&&this.Jj.get(a)!=-1?(this.Bd.kd(this.Df,this.Jj.get(a)),this.Jj.set(a,-1)):this.ff.remove(a),this.Tg!=0||(this.Bf=this.Xf=-1,this.Jc=!0,!1);if(this.Ef!=-1&&0<this.Bd.ds(this.Ef))for(s=this.Bd.sc(this.Ef);s!=-1;){var u=this.Bd.getData(s);this.sd.xj(u),this.Kj.set(u,-1),u=this.Bd.lb(s),this.Bd.kd(this.Ef,s),s=u}return 0<this.sd.size()?(this.qo.zB(this.rd[a].v,this.rd[a].C,this.ra),this.Bf=a,this.Yb=11):(this.Df==-1&&(this.Bd==null&&(this.Bd=new d.lp),this.Jj=new d.ja(0),this.Jj.resize(this.rd.length,-1),this.Jj.Yj(-1,0,this.rd.length),this.Df=this.Bd.Rh(0)),this.Jj.set(a,this.Bd.addElement(this.Df,a)),this.Yb=7),!0},l.prototype.Pz=function(){if(this.Bf=this.qo.next(),this.Bf!=-1)return!1;var s=this.Md.get(this.qe)>>1;return this.sd.xj(s),this.Yb=4,!0},l.prototype.eT=function(){if(this.Xf=this.qo.next(),this.Xf!=-1)return!1;this.Bf=this.Xf=-1;var s=this.Ff.get(this.Tg)>>1;return this.ff.xj(s),this.Yb=7,!0},l.prototype.bT=function(){if(this.Bf=this.qw.next(),this.Bf!=-1)return!1;var s=this.Md.get(this.qe)>>1;return this.sd.xj(s),this.Yb=7,!0},l.prototype.cT=function(){if(--this.Tg==-1)return this.Yb=5,!0;this.yq.L(this.Fb[this.qe]);var s=this.Fb[this.Tg];return this.yq.X(this.ra,this.ra),!this.yq.isIntersecting(s)||(this.Bf=this.Tg,!1)},l.prototype.dT=function(){if(--this.Tg==-1)return this.Yb=6,!0;this.yq.L(this.Fb[this.qe]);var s=this.rd[this.Tg];return this.yq.X(this.ra,this.ra),!this.yq.isIntersecting(s)||(this.Bf=this.Tg,!1)},l.prototype.fJ=function(){return this.sd==null?(this.Jc=!0,!1):(this.qe=this.Md.size,0<this.sd.size()&&this.sd.reset(),this.Ef!=-1&&(this.Bd.eh(this.Ef),this.Kj.resize(0),this.Ef=-1),this.Jc=!1,!0)},l.prototype.eJ=function(){return this.ff==null?(this.Jc=!0,!1):(this.Tg=this.Ff.size,0<this.ff.size()&&this.ff.reset(),this.Df!=-1&&(this.Bd.eh(this.Df),this.Jj.resize(0),this.Df=-1),this.Jc=!1,!0)},l.prototype.Mt=function(s,a,u){this.Cm==null&&(this.Cm=new d.Zt),u=new p(this,u),this.Cm.sort(s,0,a,u)},l.prototype.FX=function(s,a,u,f){var y=this;s.Wd(a,u,function(v,_){var M=y.Tr(v,f),$=y.Tr(_,f);return M<$||M==$&&l.gq(v)&&l.Oz(_)?-1:1})},l.prototype.Tr=function(s,a){var u=.5*this.ra;return a?(a=this.Fb[s>>1],l.gq(s)?a.G-u:a.H+u):(a=this.rd[s>>1],l.gq(s)?a.G-u:a.H+u)},l}(),d.sC=O}(Q||(Q={})),function(d){var O=function(){function S(){}return S.construct=function(p,l,s,a,u,f){var y=new S;return y.v=p,y.G=l,y.Xe=s,y.C=a,y.H=u,y.Dg=f,y},S.prototype.Pa=function(){this.Xe=this.v=NaN},S.prototype.B=function(){return isNaN(this.v)},S.prototype.SS=function(){return isNaN(this.Xe)},S.prototype.L=function(p,l,s,a,u,f){a!==void 0?typeof p=="number"?(this.v=p,this.G=l,this.Xe=s,this.C=a,this.H=u,this.Dg=f):(this.v=p.x-.5*l,this.C=this.v+l,this.G=p.y-.5*s,this.H=this.G+s,this.Xe=p.z-.5*a,this.Dg=this.Xe+a):(this.v=p,this.G=l,this.Xe=s,this.C=p,this.H=l,this.Dg=s)},S.prototype.move=function(p){this.v+=p.x,this.G+=p.y,this.Xe+=p.z,this.C+=p.x,this.H+=p.y,this.Dg+=p.z},S.prototype.copyTo=function(p){p.v=this.v,p.G=this.G,p.C=this.C,p.H=this.H},S.prototype.Nk=function(p,l,s){this.v>p?this.v=p:this.C<p&&(this.C=p),this.G>l?this.G=l:this.H<l&&(this.H=l),isNaN(this.Xe)==0?this.Xe>s?this.Xe=s:this.Dg<s&&(this.Dg=s):this.Dg=this.Xe=s},S.prototype.$b=function(p,l,s){if(typeof p=="number")this.B()?(this.v=p,this.G=l,this.Xe=s,this.C=p,this.H=l,this.Dg=s):this.Nk(p,l,s);else if(p instanceof d.Od)this.$b(p.x,p.y,p.z);else{if(!(p instanceof S))throw d.i.O();p.B()||(this.$b(p.v,p.G,p.Xe),this.$b(p.C,p.H,p.Dg))}},S.prototype.construct=function(p,l,s){p.B()||l.B()?this.Pa():(this.v=p.pa,this.C=p.wa,this.G=l.pa,this.H=l.wa,this.Xe=s.pa,this.Dg=s.wa)},S.prototype.iB=function(p){if(p==null||8>p.length)throw d.i.O();p[0]=new d.Od(this.v,this.G,this.Xe),p[1]=new d.Od(this.v,this.H,this.Xe),p[2]=new d.Od(this.C,this.H,this.Xe),p[3]=new d.Od(this.C,this.G,this.Xe),p[4]=new d.Od(this.v,this.G,this.Dg),p[5]=new d.Od(this.v,this.H,this.Dg),p[6]=new d.Od(this.C,this.H,this.Dg),p[7]=new d.Od(this.C,this.G,this.Dg)},S.prototype.bx=function(p){if(p==null||p.length==0)this.Pa();else{var l=p[0];for(this.L(l.x,l.y,l.z),l=1;l<p.length;l++){var s=p[l];this.Nk(s.x,s.y,s.z)}}},S}();d.JK=O}(Q||(Q={})),function(d){(function(O){O.Ra=function(){var S=Error();return S.message="Internal Error",S},O.Fe=function(){var S=Error();return S.message="Not Implemented",S},O.Zk=function(){var S=Error();return S.message="The input unit and the spatial reference unit are not of the same unit type.ie Linear vs.Angular",S},O.Hb=function(){var S=Error();return S.message="Invalid Call",S},O.O=function(S){var p=Error();return p.message="Illegal Argument Exception",S!==void 0&&(p.message+=": "+S),p},O.hu=function(S){var p=Error();return p.message=S!==void 0?"Runtime Exception: "+S:"Runtime Exception.",p},O.ga=function(S){var p=Error();return p.message="Geometry Exception: "+S,p},O.BK=function(){var S=Error();return S.message="Assert Failed Exception",S},O.de=function(){var S=Error();return S.message="IndexOutOfBoundsException",S},O.RC=function(){var S=Error();return S.message="UserCancelException",S}})(d.i||(d.i={}))}(Q||(Q={})),function(d){(d=d.dm||(d.dm={}))[d.forward=0]="forward",d[d.reverse=1]="reverse"}(Q||(Q={})),function(d){var O=function(){function l(s,a){this.Xa=s,this.AH=a,this.GH=-1,this.ul=!1}return l.prototype.re=function(){},l.prototype.next=function(){if(++this.GH==this.AH.I())return null;var s=this.AH.Oa(this.GH);s.scale(this.Xa.fc);var a=new d.Ea;return this.Xa.ny(s,this.ul,a),a},l.prototype.Ma=function(){return 0},l}(),S=function(){function l(s,a,u){this.Xa=s,this.tw=a,this.Zn=!1,this.fo=u,this.dw=[0],this.uk=[0],this.Pj=[0],this.Is=[0],this.ul=!1,this.sq=new d.Ea,this.wk=[]}return l.prototype.re=function(){},l.prototype.next=function(){if(this.Zn){this.Zn=!1,this.td.ia();var s=d.ba.kg(this.sq);return d.Hg.Ok(s,this.Xa.Cq,!0,!0,this.Xa.Vb)}if(this.td==null&&(this.td=this.tw.Ha(),this.td.ab(),this.fo!=null&&this.fo.$k(null,0)),!this.td.Ia()){if(!this.td.ab())return null;this.fo!=null&&this.fo.$k(null,0)}s=null,this.uk[0]=0,this.AA=this.dw[0]=0,this.fi=NaN,this.Zn=!1;for(var a=this.wk.length=0,u=new d.h,f=new d.h,y=[0];this.td.Ia()&&8>this.AA;){var v=this.td.ia();if(u.N(v.bc()),f.N(v.xc()),u.scale(this.Xa.fc),f.scale(this.Xa.fc),d.ej.Ou(u,f)?u.x=f.x:d.ej.Mu(u,f)&&(f.x=u.x),this.wk.length=0,d.ej.oF(this.Xa.Ub,this.Xa.lc,this.Xa.Ae,u,f,this.Xa.LA,this.Xa.at,y,this.Pj,this.Is,this.wk,this.dw),this.fo!=null&&(v=this.wk.slice(0),this.fo.lG(this.fo.ea()-1,v,v.length-1)),d.ej.Nu(u,f)?(this.sq.Pa(),this.Xa.ny(u,this.ul,this.sq),this.Zn=!0):(this.sq.Pa(),this.Zn=this.sy(y[0],this.sq)),this.Zn){if(this.td.ni(),this.td.zz()){this.td.ni(),this.td.ia();break}this.td.xW();break}s==null&&(s=new d.Ea).$k(null,0),this.JD(s),a++}if(this.dw[0]=0,0<a){for(y=this.td.xb();0<a;)this.td.ni(),u.N(this.tw.Oa(this.td.xb())),f.N(this.tw.Oa(this.td.kk())),u.scale(this.Xa.fc),f.scale(this.Xa.fc),this.ul&&(d.ej.Ou(u,f)?u.x=f.x:d.ej.Mu(u,f)&&(f.x=u.x)),this.wk.length=0,d.ej.oF(this.Xa.Ub,this.Xa.lc,this.Xa.Ae,f,u,this.Xa.LA,this.Xa.at,null,this.Pj,this.Is,this.wk,this.dw),this.JD(s),a--;return u.N(this.tw.Oa(this.td.xb())),u.scale(this.Xa.fc),p.Jr(this.Xa.Ub,this.Xa.lc,this.Xa.fc,this.Xa.sb,u,this.fi+1.570796326794897,this.fi+4.71238898038469,this.Xa.co,this.ul,this.uk,s,NaN,NaN),this.td.Wb(y),this.td.ia(),a=d.ua.mj(null,s,!0),d.Hg.Ok(s,a,!0,!0,this.Xa.Vb)}return this.Zn=!1,this.td.ia(),s=d.ba.kg(this.sq),d.Hg.Ok(s,this.Xa.Cq,!0,!0,this.Xa.Vb)},l.prototype.JD=function(s){var a=this.wk[0],u=this.Pj[0]-1.570796326794897,f=this.Is[0]+1.570796326794897;if(!isNaN(this.fi)){if(this.fi>=this.Pj[0]){var y=this.fi+1.570796326794897;u=y+3.141592653589793-(this.fi-this.Pj[0])}else u=(y=this.fi+1.570796326794897)+3.141592653589793-(6.283185307179586-(this.Pj[0]-this.fi));var v=!(this.fi>=this.Pj[0]&&3.141592653589793>=this.fi-this.Pj[0])&&!(this.fi<this.Pj[0]&&3.141592653589793<=this.Pj[0]-this.fi),_=!1;if(Math.abs(u-y)<=.5*this.Xa.co)if(v){var M=s.Oa(s.I()-2);M.scale(this.Xa.fc);var $=new d.ha(0);for(d.kb.Sy(this.Xa.Ub,this.Xa.lc,a.x,a.y,M.x,M.y,$),M=$.u;M<=y;)M+=6.283185307179586;for(;M>y;)M-=6.283185307179586;M<u&&(_=!0)}else _=!0;_?(s.yB(0,s.I()-1),this.ul||((a=new d.h).N(s.Oa(s.I()-1)),a.scale(this.Xa.fc),-3.141592653589793>a.x-this.uk[0]?this.uk[0]-=6.283185307179586:3.141592653589793<a.x-this.uk[0]&&(this.uk[0]+=6.283185307179586)),v||(u=.5*(u+y))):(v?((y=new d.h).N(a),y.scale(1/this.Xa.fc),s.xf(0,-1,y)):p.Jr(this.Xa.Ub,this.Xa.lc,this.Xa.fc,this.Xa.sb,this.wk[0],y,u,this.Xa.co,this.ul,this.uk,s,NaN,NaN),this.AA+=1)}p.my(this.Xa.Ub,this.Xa.lc,this.Xa.fc,this.Xa.sb,this.Xa.Ae,this.wk,u,f,this.ul,this.uk,s),this.fi=this.Is[0]},l.prototype.sy=function(s,a){return this.Xa.sy(this.wk,s,this.Pj[0],this.Is[0],this.ul,a)},l.prototype.Ma=function(){return 0},l}(),p=function(){function l(){}return l.buffer=function(s,a,u,f,y,v){if(s==null)throw d.i.O("Geometry::Geodesic_bufferer::buffer");if(s.B())return new d.Ea(s.description);var _=new l;_.Sg=a,_.Kc=d.cb.tc(a);var M=d.cb.xv(_.Kc);if(_.Vb=v,_.Ub=d.cb.gv(_.Kc),_.lc=M*(2-M),_.fc=_.Kc.Id().ci,_.ra=_.Sg.Mn(),_.Cq=_.Kc.Mn(),_.at=_.Cq*_.fc,_.Bq=1.570796326794897/_.fc,_.KY=3.141592653589793/_.fc,_.Ls=6.283185307179586/_.fc,_.LY=_.Ls/6,_.GA=0,_.JY=1.5707963267948966*_.Ub/_.GA,u==4?(_.Ae=2,_.Yv=!0):(_.Ae=u,_.Yv=!1),_.La=f,_.sb=Math.abs(f),isNaN(y)||.001>y?_.tX():_.bo=y,u=s.K(),d.ba.zd(u)?((u=new d.Ua(s.description)).pc(s,!0),s=u,u=1607):u==197&&(u=new d.l,s.A(u),u.S()<=_.ra||u.da()<=_.ra?((u=new d.Ua(s.description)).bd(s,!1),s=u,u=1607):((u=new d.Ea(s.description)).bd(s,!1),s=u,u=1736)),_.uX(),d.ba.Tn(u)||_.vX(),_.sb<=.5*_.bo)return u!=1736?new d.Ea(s.description):_.Yv?s:d.ej.Sr(s,_.Sg,_.Ae,_.LA,-1,v);if(0>_.La&&u!=1736)return new d.Ea(s.description);if(_.Yv&&d.ba.Ic(u)?(a=d.ej.Sr(s,a,4,NaN,_.bo,v),s=d.cb.Bh(a,_.Sg,_.Kc)):s=d.cb.Bh(s,_.Sg,_.Kc),(s=d.Jh.nj(s,_.Kc)).B())return new d.Ea(s.description);switch(!_.Yv&&d.ba.Ic(u)&&(s=d.ej.kI(_.fc,s)),s=l.GX(s,_.Kc),u){case 1736:a=_.PN(s);break;case 1607:a=_.QN(s);break;case 550:a=_.NN(s);break;case 33:a=_.ON(s);break;default:throw d.i.ga("corrupted_geometry")}return(_=d.cb.Bh(a,_.Kc,_.Sg)).Ll(s.description),_},l.prototype.PN=function(s){var a=new d.Ea;s=new S(this,s,a),s=d.Ih.local().W(s,this.Kc,this.Vb).next(),s=d.kp.pj(s,this.Kc,2);var u=new d.Ed;return u.scale(1/this.fc,1/this.fc),a.Pc(u),a=d.kp.pj(a,this.Kc,2),0<=this.La?d.Ih.local().W(a,s,this.Kc,this.Vb):d.mp.local().W(a,s,this.Kc,this.Vb)},l.prototype.QN=function(s){return s=new S(this,s,null),s=d.Ih.local().W(s,this.Kc,this.Vb).next(),d.kp.pj(s,this.Kc,2)},l.prototype.NN=function(s){return s=new O(this,s),s=d.Ih.local().W(s,this.Kc,this.Vb).next(),d.kp.pj(s,this.Kc,2)},l.prototype.ON=function(s){(s=s.D()).scale(this.fc);var a=new d.Ea;return this.ny(s,!1,a),d.kp.pj(a,this.Kc,2)},l.prototype.sy=function(s,a,u,f,y,v){var _=s[0],M=s[s.length-1],$=_.y>M.y?_.y:M.y,T=d.F.q(this.Ub,this.lc,_.y<M.y?_.y:M.y);if($=d.F.q(this.Ub,this.lc,$),.001<this.GA-(T+a+this.sb)&&.001<this.GA+($-a-this.sb))return!1;T=(a=u-1.570796326794897)-3.141592653589793,$=a+3.141592653589793;var A=(u=f+1.570796326794897)+3.141592653589793,R=[NaN],D=[NaN],V=[NaN],Z=[NaN];if(f=!1,l.ZI(this.Ub,this.lc,this.sb,_,a,T,M,u,R,D),l.ZI(this.Ub,this.lc,this.sb,M,A,u,_,T,V,Z),(u<R[0]&&R[0]<A||u<D[0]&&D[0]<A)&&(f=!0),f||(T<V[0]&&V[0]<a||T<Z[0]&&Z[0]<a)&&(f=!0),!f&&y)return!1;for(var ee=[],G=s.length-1;0<=G;G--)ee.push(s[G]);return v.Pa(),v.$k(null,0),G=[0],l.my(this.Ub,this.lc,this.fc,this.sb,this.Ae,s,a,u,y,G,v),l.Jr(this.Ub,this.lc,this.fc,this.sb,M,u,A,this.co,y,G,v,R[0],D[0]),l.my(this.Ub,this.lc,this.fc,this.sb,this.Ae,ee,A,$,y,G,v),l.Jr(this.Ub,this.lc,this.fc,this.sb,_,T,a,this.co,y,G,v,V[0],Z[0]),s=!1,y||(s=this.DE(this.fc,v)),f||s},l.prototype.ny=function(s,a,u){u.Pa(),u.$k(null,0),l.Jr(this.Ub,this.lc,this.fc,this.sb,s,-this.co,6.283185307179586,this.co,a,[0],u,NaN,NaN),a||this.DE(this.fc,u)},l.prototype.DE=function(s,a){var u=this.qO(s,a);return s=this.rO(s,a),u||s},l.prototype.qO=function(s,a){var u=a.I(),f=!1,y=new d.l;if(a.A(y),!d.s.$(y.H*s,1.570796326794897)&&!d.s.$(y.G*s,-1.570796326794897))return!1;var v=new d.h;for(--u;0<=u;u--)a.D(u,v),(v.y==y.H&&d.s.$(v.y*s,1.570796326794897)||v.y==y.G&&d.s.$(v.y*s,-1.570796326794897))&&(f=!0,this.JI(v,u,a));return f},l.prototype.rO=function(s,a){var u=a.Oa(0),f=a.Oa(a.I()-1);return 3.141592653589793<Math.abs(u.x-f.x)*s?(this.QV(a),!0):this.pO(a)},l.prototype.pO=function(s){return 0>s.He()&&(this.PV(s),!0)},l.prototype.JI=function(s,a,u){var f=u.I(),y=0<a?a-1:f-1;if(f=u.Oa(a<f-1?a+1:0),y=u.Oa(y),!d.s.$(f.y,s.y)&&!d.s.$(f.x,s.x)){var v=new d.h;v.na(f.x,s.y),u.Db(a,v)}d.s.$(y.y,s.y)||d.s.$(y.x,s.x)||((f=new d.h).na(y.x,s.y),u.xf(0,a,f))},l.prototype.QV=function(s){var a=new d.Ea,u=new d.Ea,f=new d.Ed,y=s.Oa(0),v=s.Oa(s.I()-1),_=new d.h;y.x>v.x?(v=this.Bq,f.ig(-this.Ls,0)):(v=-this.Bq,f.ig(this.Ls,0)),a.add(s,!1),s.Pa(),u.add(a,!1),u.Pc(f),y=new d.l,u.A(y),y.X((this.Ls-y.S())/2,0),y.G=-this.Bq,y.H=this.Bq;for(var M=0;M<u.I();M++)u.D(M,_),a.xf(0,-1,_);for(u.Pc(f),M=0;M<u.I();M++)u.D(M,_),a.xf(0,-1,_);u=a.Oa(0),f=a.Oa(a.I()-1),_.na(f.x,v),a.xf(0,-1,_),_.na(.5*(f.x+u.x),v),a.xf(0,-1,_),_.na(u.x,v),a.xf(0,-1,_),a=d.Jh.ms(a,this.Kc,2,!0,y.v),a=d.Jh.ms(a,this.Kc,2,!0,y.C),a=d.Vd.clip(a,y,this.Cq,NaN),s.add(a,!1)},l.prototype.PV=function(s){var a=new d.l;s.A(a),a.X((this.Ls-a.S())/2,0),a.G=-this.Bq,a.H=this.Bq,s.$k(null,0);var u=new d.h;u.na(a.v,a.G),s.xf(1,-1,u),u.na(a.v,a.H),s.xf(1,-1,u),u.na(.5*(a.v+a.C),a.H),s.xf(1,-1,u),u.na(a.C,a.H),s.xf(1,-1,u),u.na(a.C,a.G),s.xf(1,-1,u),u.na(.5*(a.v+a.C),a.G),s.xf(1,-1,u)},l.my=function(s,a,u,f,y,v,_,M,$,T,A){var R=null;$||((R=new d.h).Sc(),0<A.I()&&(R.N(A.Oa(A.I()-1)),R.scale(u)));var D=new d.ha(0),V=new d.ha(0),Z=new d.ha(0),ee=new d.h,G=new d.h,re=v[v.length-1];u=1/u;for(var oe=0;oe<v.length;oe++){var se=v[oe];if(oe==0)var ge=_;else oe==v.length-1?ge=M:(d.kb.xd(s,a,re.x,re.y,se.x,se.y,null,null,D,y),ge=D.u-1.570796326794897);d.kb.Ai(s,a,se.x,se.y,f,ge,V,Z),$?G.na(V.u,Z.u):(ee.na(V.u,Z.u),l.bJ(se.x,ee.x,R.x,T),G.na(T[0]+ee.x,ee.y),R.N(G)),G.scale(u),A.xf(0,-1,G)}},l.Jr=function(s,a,u,f,y,v,_,M,$,T,A,R,D){if(!(_-v<M)){var V=new d.ha(0),Z=new d.ha(0),ee=new d.h,G=new d.h,re=null;$||((re=new d.h).Sc(),0<A.I()&&(re.N(A.Oa(A.I()-1)),re.scale(u)));var oe=d.P.truncate(Math.ceil(v/M)),se=oe++*M;for(se==v&&(se=oe++*M),u=1/u;se<_+M&&(v<R&&R<se?(se=R,oe--):v<D&&D<se&&(se=D,oe--),!(se>=_));)d.kb.Ai(s,a,y.x,y.y,f,se,V,Z),$?G.na(V.u,Z.u):(ee.na(V.u,Z.u),l.bJ(y.x,ee.x,re.x,T),G.na(T[0]+ee.x,ee.y),re.N(G)),G.scale(u),A.xf(0,-1,G),v=se,se=oe++*M}},l.ZI=function(s,a,u,f,y,v,_,M,$,T){var A=new d.h,R=new d.h,D=new d.ha(0),V=new d.ha(0);for(d.kb.Ai(s,a,f.x,f.y,u,y,D,V),A.na(D.u,V.u),d.kb.Ai(s,a,f.x,f.y,u,v,D,V),R.na(D.u,V.u),u=new d.ha(0),d.kb.Sy(s,a,_.x,_.y,A.x,A.y,u),$[0]=u.u,d.kb.Sy(s,a,_.x,_.y,R.x,R.y,u),T[0]=u.u;$[0]<=T[0];)$[0]+=6.283185307179586;for(;$[0]>T[0];)$[0]-=6.283185307179586;for(;$[0]>=M;)$[0]-=6.283185307179586,T[0]-=6.283185307179586;for(;$[0]<M;)$[0]+=6.283185307179586,T[0]+=6.283185307179586},l.bJ=function(s,a,u,f){if(isNaN(u)){for(;3.141592653589793<f[0]+a-s;)f[0]-=6.283185307179586;for(;3.141592653589793<s-(f[0]+a);)f[0]+=6.283185307179586}else 3.141592653589793<f[0]+a-u?f[0]-=6.283185307179586:3.141592653589793<u-(f[0]+a)&&(f[0]+=6.283185307179586)},l.GX=function(s,a){var u=s.K(),f=d.ba.Ic(u)?s.ea():u==550?s.I():1;if(f==1)return s;var y=new d.ja(0);y.resize(f);for(var v=[],_=new d.l,M=0;M<f;M++){if(y.write(M,M),d.ba.Ic(u)){s.Tj(M,_);var $=_.tf()}else $=s.Oa(M);$=d.SK.WX(a,$),v[M]=$}for(y.Wd(0,y.size,function(T,A){return v[T]<v[A]?-1:v[T]>v[A]?1:0}),a=s.Ja(),M=0;M<f;M++)_=y.read(M),d.ba.Ic(u)?a.addPath(s,_,!0):a.Gd(s,_,_+1);return a},l.prototype.uX=function(){var s=Math.min(3.141592653589793*this.Ub-this.sb,this.sb);s=Math.min(s,.39269908169872414*this.Ub);var a=new d.h;a.na(0,10*this.fc);var u=45*this.fc,f=new d.ha(0),y=new d.ha(0),v=new d.ha(0),_=new d.ha(0),M=new d.ha(0),$=new d.ha(0),T=new d.ha(0),A=new d.ha(0),R=new d.h,D=new d.h,V=new d.h,Z=new d.h;d.kb.Ai(this.Ub,this.lc,a.x,a.y,s,0,f,y),R.na(f.u,y.u),d.kb.Ai(this.Ub,this.lc,a.x,a.y,s,u,v,_),D.na(v.u,_.u),f=new d.ha(0),y=new d.ha(0);for(var ee=new d.ha(0);d.kb.Ai(this.Ub,this.lc,a.x,a.y,s,.5*(0+u),M,$),V.na(M.u,$.u),d.kb.xd(this.Ub,this.lc,R.x,R.y,D.x,D.y,f,y,null,2),d.kb.qj(this.Ub,this.lc,R.x,R.y,.5*f.u,y.u,T,A,2),Z.na(T.u,A.u),d.kb.xd(this.Ub,this.lc,V.x,V.y,Z.x,Z.y,ee,null,null,2),!(ee.u<=this.bo);)u*=.9,d.kb.Ai(this.Ub,this.lc,a.x,a.y,s,u,v,_),D.na(v.u,_.u);this.co=6.283185307179586/Math.ceil(6.283185307179586/(u-0))},l.prototype.vX=function(){var s=Math.min(3.141592653589793*this.Ub-this.sb,this.sb);s=Math.min(s,.39269908169872414*this.Ub);var a=new d.h,u=new d.h;a.na(0,10*this.fc),u.na(10*this.fc,10*this.fc);var f=new d.ha(0),y=new d.ha(0),v=new d.ha(0);d.kb.xd(this.Ub,this.lc,a.x,a.y,u.x,u.y,v,f,y,this.Ae);var _=new d.ha(0),M=new d.ha(0),$=new d.ha(0),T=new d.ha(0),A=new d.h,R=new d.ha(0),D=new d.ha(0),V=new d.ha(0),Z=new d.ha(0),ee=new d.ha(0),G=new d.ha(0),re=new d.ha(0),oe=new d.ha(0),se=new d.ha(0),ge=new d.h,me=new d.h,Ie=new d.h,De=new d.h,Fe=1;f=f.u,y=y.u+1.570796326794897,v=v.u,d.kb.Ai(this.Ub,this.lc,a.x,a.y,s,f-1.570796326794897,D,V),ge.na(D.u,V.u),d.kb.Ai(this.Ub,this.lc,u.x,u.y,s,y,Z,ee),me.na(Z.u,ee.u),D=new d.ha(0),V=new d.ha(0),y=new d.ha(0);for(var gt=new d.ha(0);d.kb.qj(this.Ub,this.lc,a.x,a.y,.5*(0+Fe)*v,f,_,M,this.Ae),A.na(_.u,M.u),d.kb.xd(this.Ub,this.lc,a.x,a.y,A.x,A.y,null,null,R,this.Ae),d.kb.Ai(this.Ub,this.lc,A.x,A.y,s,R.u+1.570796326794897,G,re),Ie.na(G.u,re.u),d.kb.xd(this.Ub,this.lc,ge.x,ge.y,me.x,me.y,D,V,null,2),d.kb.qj(this.Ub,this.lc,ge.x,ge.y,.5*D.u,V.u,oe,se,2),De.na(oe.u,se.u),d.kb.xd(this.Ub,this.lc,Ie.x,Ie.y,De.x,De.y,y,null,null,2),!(y.u<=this.bo);)Fe*=.9,d.kb.qj(this.Ub,this.lc,a.x,a.y,Fe*v,f,$,T,this.Ae),u.na($.u,T.u),d.kb.xd(this.Ub,this.lc,a.x,a.y,u.x,u.y,null,null,gt,this.Ae),d.kb.Ai(this.Ub,this.lc,u.x,u.y,s,gt.u+1.570796326794897,Z,ee),me.na(Z.u,ee.u);1e5<(s=Fe*v)&&(s=1e5),this.LA=s},l.prototype.tX=function(){var s=5e4<this.sb?100:1e4<this.sb?10:1;500>this.sb/s&&(s=this.sb/500),.01>s&&(s=.01),this.bo=s},l}();d.QK=p}(Q||(Q={})),function(d){var O=function(){function S(){}return S.Of=function(p,l){var s=new d.h;s.N(l),p.push(s)},S.wp=function(p,l){p.add(l.x),p.add(l.y)},S.cB=function(p){p.Dh(p.size-2)},S.jB=function(p,l){l.na(p.get(p.size-2),p.get(p.size-1))},S.Sr=function(p,l,s,a,u,f){if(p==null)throw d.i.O();var y=p.K();if(p.B()||d.ba.Tn(y))return p;var v=new S;v.Sg=l,v.Kc=d.cb.tc(l);var _=d.cb.xv(v.Kc);if(v.Vb=f,v.Ub=d.cb.gv(v.Kc),v.lc=_*(2-_),v.fc=v.Kc.Id().ci,v.Cq=v.Kc.Mn(),v.at=v.Cq*v.fc,v.vA=a,v.uA=u,v.Ae=s,y==197?(s=new d.Ea(p.description)).bd(p,!1):d.ba.zd(y)?(s=new d.Ua(p.description)).pc(p,!0):s=p,v.Ae!=4){if((l=v.Sg.Nb(v.Kc)==0?d.cb.Bh(s,v.Sg,v.Kc):d.Jh.nj(s,v.Kc)).B())return l;l=S.kI(v.fc,l),l=v.Uy(l),l=d.kp.pj(l,v.Kc,v.Ae),v=d.cb.Bh(l,v.Kc,v.Sg)}else{if(d.Gg.Tb(l)==2?(p=d.cb.ol(),(l=d.Zj.local().W(s,p,l,f))==p&&(l=new d.Ea,p.copyTo(l))):l=d.Jh.nj(s,v.Kc),l.B())return l;v=v.yX(l)}return v},S.kI=function(p,l){var s=new d.l;if(l.yc(s),3.141592653589793>s.S()*p)return l;var a=!1;s=l.Ha();for(var u=new d.h,f=new d.h;s.ab();)for(;s.Ia();){var y=s.ia();if(u.N(y.bc()),f.N(y.xc()),u.scale(p),f.scale(p),3.141592653589793<Math.abs(u.x-f.x)){var v=S.Nu(u,f);if(!v){a=!0;break}if(6.283185307179586<Math.abs(u.x-f.x)){a=!0;break}}}if(!a)return l;a=l.Ja();var _=1<l.description.Ba,M=new d.h,$=new d.h,T=new d.h,A=new d.h,R=new d.Ta;for(s.aj();s.ab();)for(var D=NaN,V=[0];s.Ia();){if(y=s.ia(),u.N(y.bc()),f.N(y.xc()),u.scale(p),f.scale(p),isNaN(D)?(S.Yi(u.x,NaN,V),$.N(u)):$.N(T),D=$.x,v=S.Nu(u,f)){if(6.283185307179586<f.x-u.x)for(;6.283185307179586<f.x-u.x;)f.x-=6.283185307179586;if(-6.283185307179586>f.x-u.x)for(;-6.283185307179586>f.x-u.x;)f.x+=6.283185307179586;S.Yi(f.x,NaN,V),T.N(f)}else M.N(f),S.vU(M),S.Yi(M.x,D,V),T.na(V[0]+M.x,M.y);.5>Math.abs(T.x-f.x)&&T.N(f),_?(y.Vw(0,R),A.N($),A.scale(1/p),R.Db(A),(v=s.xm())?a.nf(R):a.lineTo(R),s.Sn()&&!l.ec(s.gb)&&(y.Vw(1,R),A.N(T),A.scale(1/p),R.Db(A),a.lineTo(R))):((v=s.xm())&&a.Cz(null,0),y=a.ea()-1,A.N($),A.scale(1/p),a.xf(y,-1,A),s.Sn()&&!l.ec(s.gb)&&(A.N(T),A.scale(1/p),a.xf(y,-1,A)))}return a},S.oF=function(p,l,s,a,u,f,y,v,_,M,$,T){var A=new d.h,R=new d.h,D=0<a.compare(u);S.aJ(D,a,u,A,R),S.pF(p,l,s,A,R,f,NaN,y,v,_,M,null,$,T),D&&S.aC(_,M,null,$)},S.prototype.Uy=function(p){var l=p.Ja(),s=p.Ha(),a=[],u=null,f=null,y=1<p.description.Ba;y&&(u=new d.ce(0),f=new d.jg);for(var v=[0],_=new d.h,M=new d.h,$=new d.h,T=new d.h;s.ab();)for(v[0]=0;s.Ia();){var A=s.ia();_.N(A.bc()),M.N(A.xc()),_.scale(this.fc),M.scale(this.fc);var R=0<_.compare(M);S.aJ(R,_,M,$,T),a.length=0,u!=null&&u.Dh(0),0<this.vA?S.pF(this.Ub,this.lc,this.Ae,$,T,this.vA,this.uA,this.at,null,null,null,y?u:null,a,v):S.WQ(this.Ub,this.lc,this.Ae,$,T,this.uA,this.at,y?u:null,a,v),R&&S.aC(null,null,y?u:null,a),a[0].N(A.bc()),a[a.length-1].N(A.xc());for(var D=1;D<a.length-1;D++)a[D].scale(1/this.fc);y?(R=S.$I(R,A,f),S.OD(s.xm(),s.Sn()&&!p.ec(s.gb),A,R,u,a,l)):S.ND(s.xm(),s.Sn()&&!p.ec(s.gb),a,l)}return l},S.prototype.yX=function(p){var l=p.Ja(),s=p.Ha(),a=[],u=null,f=new d.jg,y=1<p.description.Ba;for(y&&(u=new d.ce(0));s.ab();)for(;s.Ia();){var v=s.ia(),_=v.bc(),M=v.xc();_=0<_.compare(M),M=S.$I(_,v,f),a.length=0,u!=null&&u.Dh(0),S.xX(this.Ub,this.lc,this.fc,M,this.Sg,this.vA,this.uA,y?u:null,a),_&&S.aC(null,null,y?u:null,a),y?S.OD(s.xm(),s.Sn()&&!p.ec(s.gb),v,M,u,a,l):S.ND(s.xm(),s.Sn()&&!p.ec(s.gb),a,l)}return l},S.ND=function(p,l,s,a){p&&a.Cz(null,0),p=a.ea()-1;var u=s.slice(0);a.lG(p,u,u.length-1),l&&a.xf(p,-1,s[s.length-1])},S.OD=function(p,l,s,a,u,f,y){var v=new d.Ta;if(s.Vo(v),p?y.nf(v):y.lineTo(v),2<f.length){p=a.Rb();for(var _=1;_<f.length-1;_++){var M=a.IG(u.get(_)*p);a.Vw(M,v),v.Db(f[_]),y.lineTo(v)}}l&&(s.Ro(v),y.lineTo(v))},S.pF=function(p,l,s,a,u,f,y,v,_,M,$,T,A,R){var D=new d.ha(0),V=new d.ha(0),Z=new d.ha(0);d.kb.xd(p,l,a.x,a.y,u.x,u.y,Z,D,V,s),Z=Z.u;var ee=D=D.u;0>ee&&(ee+=6.283185307179586),0>(V=V.u)&&(V+=6.283185307179586),_!=null&&(_[0]=Z),M!=null&&(M[0]=ee),$!=null&&($[0]=V),M=_=NaN,T!=null&&(_=((M=d.F.Ch(p,l))-($=d.F.q(p,l,a.y)))/Z,M=(M+$)/Z),$=S.Ou(a,u),V=S.Mu(a,u),ee=$||V;var G=S.AE(a,u,v),re=new d.ha(0),oe=new d.ha(0),se=new d.h,ge=new d.h,me=new d.h;S.Yi(a.x,NaN,R);var Ie=[R[0]];if(Z<=f)S.Of(A,a),S.Yi(u.x,NaN,R),T!=null&&T.add(0),ee?($&&S.fB(a,u,T,A),V&&S.dB(a,u,T,A)):G?S.eB(a,u,D,_,M,T,A):0<y&&(ge.na(a.x-Ie[0],a.y),se.na(u.x-R[0],u.y),S.Ty(p,l,s,a,Z,D,ge,se,0,1,y,T,A,Ie)),S.Of(A,u);else{var De=Z/((f=1+d.P.truncate(Math.ceil(Z/f)))-1),Fe=new d.h,gt=0;S.Of(A,a),Fe.N(a),ge.na(a.x-R[0],a.y),T!=null&&T.add(0);for(var Ze=1;Ze<f;Ze++){if(Ze<f-1){d.kb.qj(p,l,a.x,a.y,Ze*De,D,re,oe,s),se.na(re.u,oe.u),S.Yi(se.x,Fe.x,R),me.na(R[0]+se.x,se.y);var Vt=Ze/(f-1)}else S.Yi(u.x,NaN,R),se.na(u.x-R[0],u.y),me.N(u),Vt=1;ee?(Ze==1&&$&&S.fB(a,me,T,A),Ze==f-1&&V&&S.dB(Fe,u,T,A)):G?S.zE(Fe,me,v)&&(a.x<u.x?Fe.x>me.x&&(R[0]+=6.283185307179586,me.na(R[0]+se.x,se.y)):Fe.x<me.x&&(R[0]-=6.283185307179586,me.na(R[0]+se.x,se.y)),S.eB(Fe,me,D,_,M,T,A)):0<y&&S.Ty(p,l,s,a,Z,D,ge,se,gt,Vt,y,T,A,Ie),S.Of(A,me),T!=null&&T.add(Vt),Fe.N(me),ge.N(se),Ie[0]=R[0],gt=Vt}}},S.WQ=function(p,l,s,a,u,f,y,v,_,M){var $=new d.ha(0),T=new d.ha(0),A=new d.ha(0);d.kb.xd(p,l,a.x,a.y,u.x,u.y,A,$,T,s),T=A.u,$=$.u;var R=A=NaN;if(v!=null){R=d.F.Ch(p,l);var D=d.F.q(p,l,a.y);A=(R-D)/T,R=(R+D)/T}D=S.Ou(a,u);var V=S.Mu(a,u),Z=D||V;y=S.AE(a,u,y);var ee=S.Nu(a,u);ee=Z||y||ee,S.Yi(a.x,NaN,M);var G=new d.h;S.Of(_,a),G.N(a),v!=null&&v.add(0),ee?(Z?(D&&S.fB(a,u,v,_),V&&S.dB(a,u,v,_)):y&&S.eB(a,u,$,A,R,v,_),S.Yi(u.x,NaN,M),S.Of(_,u)):T<=f?(S.Yi(u.x,NaN,M),S.Of(_,u)):(A=new d.h,y=new d.h,A.N(a),y.N(u),A.x-=M[0],y.x-=M[0],-3.141592653589793>y.x?y.x+=6.283185307179586:3.141592653589793<y.x&&(y.x-=6.283185307179586),S.Ty(p,l,s,a,T,$,A,y,0,1,f,v,_,M),S.Of(_,u),S.Yi(u.x,NaN,M)),v!=null&&v.add(1)},S.Ty=function(p,l,s,a,u,f,y,v,_,M,$,T,A,R){var D=new d.h,V=new d.h;D.na(y.x+R[0],y.y),new d.ha(0),new d.ha(0),new d.ha(0),new d.ha(0);var Z=new d.ha(0),ee=new d.ha(0),G=new d.ha(0),re=new d.h,oe=new d.h,se=new d.h,ge=new d.h;re.N(y),oe.N(v),y=new d.ce(0),v=new d.ce(0),S.wp(y,oe),v.add(M);var me=new d.h,Ie=new d.zb,De=[];for(S.TJ(4,De);0<y.size;){for(var Fe,gt=!1,Ze=NaN,Vt=0;3>Vt;Vt++)if(Fe=De[Vt]*M+(1-De[Vt])*_,d.kb.qj(p,l,a.x,a.y,Fe*u,f,Z,ee,s),se.na(Z.u,ee.u),Vt==0&&(Ze=Fe,ge.N(se)),S.RW(re,se,oe,Ie),Ie.ic(Ie.ge(se,!0),me),d.kb.xd(p,l,se.x,se.y,me.x,me.y,G,null,null,2),G.u>$){gt=!0;break}gt?(oe.N(ge),M=Ze,S.wp(y,oe),v.add(M)):(S.cB(y),v.Gn(v.size-1,1,v.size-1),0<y.size&&(S.Yi(oe.x,D.x,R),V.na(R[0]+oe.x,oe.y),S.Of(A,V),D.N(V),T!=null&&T.add(M),re.N(oe),_=M,S.jB(y,oe),M=v.get(v.size-1)))}},S.xX=function(p,l,s,a,u,f,y,v,_){var M=new d.h,$=new d.h,T=new d.h,A=new d.h,R=new d.h,D=new d.h,V=new d.h,Z=new d.h,ee=new d.h,G=new d.h,re=new d.ha(0),oe=new d.ha(0),se=new d.h,ge=[[],[]],me=d.Gg.Tb(u)==1;u=u.Yd(0);var Ie=a.bc(),De=a.xc();me?(D.na(Ie.x*s,Ie.y*s),V.na(De.x*s,De.y*s)):(ge[0][0]=Ie.x,ge[0][1]=Ie.y,ge[1][0]=De.x,ge[1][1]=De.y,d.cb.wt(),D.x=ge[0][0]*s,D.y=ge[0][1]*s,V.x=ge[1][0]*s,V.y=ge[1][1]*s);var Fe=0,gt=0,Ze=1,Vt=a.Rn();M.N(Ie),$.N(De),De=new d.ce(0);var Rt=new d.ce(0),lt=new d.ce(0);S.wp(De,$),S.wp(Rt,V),lt.add(Ze),S.Of(_,M),v!=null&&v.add(gt);var Ui=[],Vr=0<y?Vt?5:3:Vt?5:1;S.TJ(Vr,Ui);for(var Wi=new d.ha(0),Mi=new d.ha(0),Ii=new d.ha(0),ri=new d.ha(0),sr=new d.ha(0),Qt=new d.ha(0),tn=new d.ha(0);0<Rt.size;){var di=!1,Zn=NaN;for(d.kb.xd(p,l,D.x,D.y,V.x,V.y,Wi,Mi,null,2),Ie=0;Ie<Vr&&!(Ie==0&&(!Vt&&0>=y&&Wi.u<=f&&3.141592653589793>Math.abs(D.x-V.x)||a.Tx(gt,Ze)<=u));Ie++){var Pi=Ui[Ie]*Ze+(1-Ui[Ie])*gt;if(a.ic(Pi,T),me?Z.na(T.x*s,T.y*s):(ge[0][0]=T.x,ge[0][1]=T.y,d.cb.wt(),Z.x=ge[0][0]*s,Z.y=ge[0][1]*s),Ie==0&&(Zn=Pi,R.N(T),G.N(Z),0<f&&(Wi.u>f||3.141592653589793<=Math.abs(D.x-V.x)))){di=!0;break}if(Vt&&0<f){if(d.kb.xd(p,l,D.x,D.y,Z.x,Z.y,Ii,null,null,2),Ii.u>f||3.141592653589793<=Math.abs(D.x-Z.x)){di=!0;break}}else if(0<y){if(Vt?(A.IS(M,$,Ui[Ie]),me?ee.na(A.x*s,A.y*s):(ge[0][0]=A.x,ge[0][1]=A.y,d.cb.wt(),ee.x=ge[0][0]*s,ee.y=ge[0][1]*s)):(A.N(T),ee.N(Z)),d.kb.xd(p,l,D.x,D.y,ee.x,ee.y,ri,null,null,2),!(ri.u<=Wi.u)){di=!0;break}if(d.kb.qj(p,l,D.x,D.y,ri.u,Mi.u,re,oe,2),se.na(re.u,oe.u),d.kb.xd(p,l,se.x,se.y,Z.x,Z.y,sr,null,null,2),sr.u>y){di=!0;break}if(Vt){if(d.kb.xd(p,l,se.x,se.y,ee.x,ee.y,Qt,null,null,2),Qt.u>y){di=!0;break}if(d.kb.xd(p,l,ee.x,ee.y,Z.x,Z.y,tn,null,null,2),tn.u>y){di=!0;break}}}}di?($.N(R),V.N(G),Ze=Zn,S.wp(De,$),S.wp(Rt,V),lt.add(Ze)):(S.cB(De),S.cB(Rt),lt.Gn(lt.size-1,1,lt.size-1),S.Of(_,$),Fe+=Wi.u,v!=null&&v.add(Fe),0<Rt.size&&(M.N($),D.N(V),gt=Ze,S.jB(De,$),S.jB(Rt,V),Ze=lt.get(lt.size-1)))}if(v!=null)for(p=1/Fe,Ie=0;Ie<v.size;Ie++)v.write(Ie,v.read(Ie)*p)},S.aC=function(p,l,s,a){a.reverse(),s!=null&&s.pi(0,s.size,1),s=p!=null?p[0]:NaN,a=l!=null?l[0]:NaN,p!=null&&(p[0]=a),l!=null&&(l[0]=s)},S.aJ=function(p,l,s,a,u){p?(a.N(s),u.N(l)):(a.N(l),u.N(s))},S.$I=function(p,l,s){return p?(s.create(l.K()),l.copyTo(s.get()),s.get().reverse(),s.get()):l},S.Yi=function(p,l,s){if(isNaN(l)){for(;3.141592653589793<s[0]-p;)s[0]-=6.283185307179586;for(;3.141592653589793<p-s[0];)s[0]+=6.283185307179586}else 3.141592653589793<s[0]+p-l?s[0]-=6.283185307179586:3.141592653589793<l-(s[0]+p)&&(s[0]+=6.283185307179586)},S.RW=function(p,l,s,a){3.141592653589793>Math.abs(l.x-p.x)?(a.Ec(p),3.141592653589793<=s.x-p.x?a.Sl(s.x-6.283185307179586,s.y):3.141592653589793<=p.x-s.x?a.Sl(s.x+6.283185307179586,s.y):a.Sl(s.x,s.y)):(a.Ec(s),3.141592653589793<=p.x-s.x?a.Sl(p.x-6.283185307179586,p.y):3.141592653589793<=s.x-p.x?a.Sl(p.x+6.283185307179586,p.y):a.Sl(p.x,p.y))},S.TJ=function(p,l){for(var s=0;s<p;s++){var a=Math.ceil(s/2)/(p+1);s%2!=0&&(a=-a),l[s]=.5+a}},S.Ou=function(p,l){return!!(d.s.$(p.y,1.570796326794897)&&!d.s.$(l.y,1.570796326794897)||d.s.$(p.y,-1.570796326794897)&&!d.s.$(l.y,-1.570796326794897))},S.Mu=function(p,l){return!!(d.s.$(l.y,1.570796326794897)&&!d.s.$(p.y,1.570796326794897)||d.s.$(l.y,-1.570796326794897)&&!d.s.$(p.y,-1.570796326794897))},S.AE=function(p,l,s){return!(!S.zE(p,l,s)||d.s.$(p.y,1.570796326794897)||d.s.$(p.y,-1.570796326794897)||d.s.$(l.y,1.570796326794897)||d.s.$(l.y,-1.570796326794897))},S.zE=function(p,l,s){return Math.abs(Math.abs(p.x-l.x)-3.141592653589793)<=s},S.Nu=function(p,l){return!!(d.s.$(p.y,1.570796326794897)&&d.s.$(l.y,1.570796326794897)||d.s.$(p.y,-1.570796326794897)&&d.s.$(l.y,-1.570796326794897))},S.fB=function(p,l,s,a){if(0<p.y){var u=new d.h;u.na(l.x,1.570796326794897)}else(u=new d.h).na(l.x,-1.570796326794897);d.s.$(p.x,u.x)||d.s.$(l.y,u.y)||(S.Of(a,u),s!=null&&s.add(0))},S.dB=function(p,l,s,a){if(0<l.y){var u=new d.h;u.na(p.x,1.570796326794897)}else(u=new d.h).na(p.x,-1.570796326794897);d.s.$(l.x,u.x)||d.s.$(p.y,u.y)||(S.Of(a,u),s!=null&&s.add(1))},S.eB=function(p,l,s,a,u,f,y){d.s.Dd(s)?(0<1.570796326794897-p.y&&((s=new d.h).na(p.x,1.570796326794897),S.Of(y,s),f!=null&&f.add(a)),0<1.570796326794897-l.y&&((s=new d.h).na(l.x,1.570796326794897),S.Of(y,s),f!=null&&f.add(a))):(0<1.570796326794897+p.y&&((s=new d.h).na(p.x,-1.570796326794897),S.Of(y,s),f!=null&&f.add(u)),0<1.570796326794897+l.y&&((s=new d.h).na(l.x,-1.570796326794897),S.Of(y,s),f!=null&&f.add(u)))},S.vU=function(p){if(-3.141592653589793>p.x)for(;-3.141592653589793>p.x;)p.x+=6.283185307179586;if(3.141592653589793<p.x)for(;3.141592653589793<p.x;)p.x-=6.283185307179586},S}();d.ej=O}(Q||(Q={})),function(d){d.kp=function(){function O(){}return O.pj=function(S,p,l){if(S==null||p==null||!d.cb.Xc(p))throw d.i.O();if(S.B())return S;var s=S,a=s.K();if(d.ba.Ic(a)){s=d.Jh.nj(S,p),S=new d.l,s.A(S),a=d.ua.Xd(p,S,!1);for(var u=d.cb.ih(p),f=Math.floor((S.v-u.v)/u.S())*u.S()+u.v;f<S.C;)f>S.v+a&&f<S.C-a&&(s=d.Jh.ms(s,p,l,!0,f)),f+=u.S()}else{if(a==197)return(S=new d.Ea(s.description)).bd(s,!1),O.pj(S,p,l);if(d.ba.zd(a))return(S=new d.Ua(s.description)).pc(s,!0),O.pj(S,p,l)}return O.Py(s,p)},O.Py=function(S,p){if(S==null||p==null||!d.cb.Xc(p))throw d.i.O();if(S.B())return S;var l=S.K();return l==197?(l=new d.Ea(S.description)).bd(S,!1):d.ba.zd(l)?(l=new d.Ua(S.description)).pc(S,!0):l=S,(l=d.Jh.nj(l,p)).B()?l:d.Gg.Tb(p)==1?d.Jh.Hn(l,p,0,l!=S,0):O.IQ(l,p,l!=S)},O.IQ=function(S,p,l){if(!d.cb.Xc(p))throw d.i.O();if(S.B())return S;var s=d.cb.bf(p),a=-180*s;return s*=360,d.Gg.Tb(p)==2&&(s=(a=d.cb.ih(p)).C,s-=a=a.v),d.Jh.Jp(S,a,s,p,l,0,!0)},O}()}(Q||(Q={})),function(d){d.xY=function(){function O(){}return O.R=function(S){return 0>S?-S:S},O.Mb=function(S,p){return 0<=p?O.R(S):-O.R(S)},O.$=function(S,p){return S==p||O.R(S-p)<=O.EC*(1+(O.R(S)+O.R(p))/2)},O.Dd=function(S){return S==0||O.R(S)<=O.EC},O.Ch=function(S,p){var l=(p=(1-(p=Math.sqrt(1-p)))/(1+p))*p;return S/(1+p)*(1+l*(.25+l*(.015625+1/256*l)))*O.zL},O.zL=1.5707963267948966,O.EC=3552713678800501e-30,O}()}(Q||(Q={})),function(d){var O=function(p){this.Yf=p,this.Mk=this.Yf.getCode(),0>this.Mk&&(this.Mk=0)};d.zY=O;var S=function(){function p(l){l===void 0&&(l=null),this.Ej=null,this.Wn=!1,l!==null&&(this.Ej=new O(l))}return p.prototype.Fc=function(){return this.Ej!=null?this.Ej.Mk:0},p.prototype.Qf=function(){var l=new p;return this.copyTo(l),l},p.prototype.copyTo=function(l){l.Ej=this.Ej,l.Wn=this.Wn},p.prototype.Lz=function(){this.Wn=!this.Wn},p.prototype.sm=function(){return this.Ej!=null?this.Ej.Yf:null},p.prototype.GJ=function(l){if(0>=l)throw d.i.O();if(l!=this.Fc()){if((l=d.qf.geogtran(l))==null)throw d.i.O("Geogtran not found.");this.Ej=new O(l)}},p.prototype.wz=function(){return this.Ej==null?null:this.Ej.Yf.toString()},p.prototype.pX=function(l){if(l==null)throw d.i.O();var s=null;try{s=d.qf.fromString(d.Tc.PE_TYPE_GEOGTRAN,l)}catch{throw d.i.O()}this.Ej=new O(s)},p.prototype.Nb=function(l){return l==this||!(!(l instanceof p)||(0>=this.Fc()||this.Fc()!=l.Fc())&&!this.sm().isEqual(l.sm()))&&this.Wn==l.Wn},p.prototype.toString=function(){var l="GeographicTransformation: "+this.wz();return 200<l.length?l.substring(0,197)+"... ("+l.length.toString()+" characters)":l},p.create=function(l,s){var a=new p;return a.GJ(l),s&&a.Lz(),a},p.pP=function(l,s){var a=new p;return a.pX(l),s&&a.Lz(),a},p}();d.Cx=S}(Q||(Q={})),function(d){var O=function(){function p(){}return p.construct=function(l,s,a,u){var f=new p;return f.jw=l,f.kw=s,f.MY=a,f.NY=u,f},p.zy=function(l,s){return l.jw==s.jw?l.kw==s.kw?0:l.kw<s.kw?-1:1:l.jw<s.jw?-1:1},p}(),S=function(){function p(){this.tT=[],this.uT=[],this.sp()}return p.fz=function(){return p.eK==null&&(p.eK=new p),p.eK},p.prototype.sp=function(){this.dD(this.tT),this.dD(this.uT)},p.prototype.dD=function(l){try{var s=[];s=s.sort(O.zy);for(var a=0;a<s.length;a++)l.push(s[a])}catch{}},p}();d.yY=S}(Q||(Q={})),function(d){var O=function(){function S(){}return S.prototype.tD=function(p){this.Hk=p},S.prototype.RM=function(p){this.Gb=p},S.prototype.sD=function(p){this.Bo=p},S.xE=function(p){return!(p.B()||p.K()!=1607&&p.K()!=1736)},S.vE=function(p){return!(p.B()||p.K()!=1607&&p.K()!=1736||20>p.I())},S.wE=function(p){return!(p.B()||p.K()!=1607&&p.K()!=1736||20>p.I())},S}();d.Wk=O}(Q||(Q={})),function(d){d.ac=function(){function O(){}return O.OT=function(S){var p=new d.Ea;return p.rx(S.gs(),S.js()),p.Aj(S.gs(),S.hs()),p.Aj(S.fs(),S.hs()),p.Aj(S.fs(),S.js()),p},O.Bh=function(S,p){return S===null?null:d.Gx.local().W(S,p,null)},O.fY=function(S,p){var l=d.Ih.local();return S=new d.$c(S),l.W(S,p,null).next()},O.km=function(S,p,l){return d.mp.local().W(S,p,l,null)},O.gp=function(S,p,l){return d.Jx.local().W(S,p,l,null)},O.RX=function(S,p,l){var s=d.Jx.local();for(S=new d.$c(S),p=new d.$c(p),l=s.W(S,p,l,null),s=[];(p=l.next())!=null;)s.push(p);return s},O.Nb=function(S,p,l){return d.fj.local().W(3,S,p,l,null)},O.OP=function(S,p,l){return d.fj.local().W(4,S,p,l,null)},O.MS=function(S,p,l){var s=d.Zj.local();for(S=new d.$c(S),p=new d.$c(p),l=s.W(S,p,l,null),s=[];(p=l.next())!=null;)s.push(p);return s},O.LP=function(S,p,l){var s=d.mp.local();for(S=new d.$c(S),p=new d.$c(p),l=s.W(S,p,l,null),s=[];(p=l.next())!=null;)s.push(p);return s},O.Fa=function(S,p,l){return d.Zj.local().W(S,p,l,null)},O.LS=function(S,p,l){if((S=d.Zj.local().W(S,p,l,null,1))===null)return[];if(S.K()===550){for(p=[],l=0;l<S.xa;l++)p.push(S.FR(l));return p}return S.K()===33?[S]:[]},O.mY=function(S,p,l){return d.fj.local().W(2,S,p,l,null)},O.contains=function(S,p,l){return d.fj.local().W(1,S,p,l,null)},O.wP=function(S,p,l){return d.fj.local().W(16,S,p,l,null)},O.touches=function(S,p,l){return d.fj.local().W(8,S,p,l,null)},O.yU=function(S,p,l){return d.fj.local().W(32,S,p,l,null)},O.OS=function(S,p,l){return d.fj.local().W(1073741824,S,p,l,null)},O.tB=function(S,p,l,s){return d.uL.local().W(S,p,l,s,null)},O.ub=function(S,p,l,s){var a=null;if(l!=null){if(a=l.Id(),s!=null&&a.Fc()!=s.Fc()&&a.pd!=s.pd)throw d.i.Zk()}else if(s!=null)throw d.i.O();return S=d.lL.local().W(S,p,null),a!==null&&s!==null&&(S=d.Uc.Ph(S,a,s)),S},O.clip=function(S,p,l){return d.fL.local().W(S,d.l.construct(p.gs(),p.js(),p.fs(),p.hs()),l,null)},O.fl=function(S,p,l){if(S==null||p==null)return null;for(S=d.hL.local().W(!0,S,p,l,null),p=[];(l=S.next())!=null;)l.B()||p.push(l);return p.slice(0)},O.HN=function(S,p,l,s,a,u,f,y){if(a===!0)return O.IN(S,p,l,s,u,f,y);if(a=l,p!=null){if(f=p.Id(),s!=null&&f.Fc()!=s.Fc()){if(f.pd!=s.pd)throw d.i.Zk();a=[],d.Uc.SE(l,l.length,s,f,a)}}else if(s!=null)throw d.i.O();if(l=d.vC.local(),u){for(S=new d.$c(S),p=l.W(S,p,a,u,null),S=[];(u=p.next())!=null;)S.push(u);u=S.slice(0)}else for(u=[],s=0;s<S.length;s++)u[s]=l.W(S[s],p,a[s],null);return u},O.IN=function(S,p,l,s,a,u,f){if(p===null||(s==null&&(s=p.Fc()!==4326?p.Id():d.Uc.ah(9001)),s.pd!==0))throw d.i.O();if(d.Uc.SE(l,l.length,s,d.Uc.ah(9001),l),s=d.AC.local(),a){for(S=new d.$c(S),p=s.W(S,p,u,l,f,!1,a,null),l=[];(u=p.next())!=null;)l.push(u);a=l.slice(0)}else{a=[];for(var y=0;y<S.length;y++)a[y]=s.W(S[y],p,u,l[y],f,!1,null)}return a},O.buffer=function(S,p,l,s,a,u,f){var y=l;if(a===!1){if(p!=null){if(a=p.Id(),s!=null&&a.Fc()!=s.Fc()){if(a.pd!=s.pd)throw d.i.Zk();y=d.Uc.Ph(l,s,a)}}else if(s!=null)throw d.i.O();S=d.vC.local().W(S,p,y,null)}else{if(p===null||(s==null&&(s=p.Fc()!==4326?p.Id():d.Uc.ah(9001)),s.pd!==0))throw d.i.O();y=d.Uc.Ph(l,s,d.Uc.ah(9001)),S=d.AC.local().W(S,p,u,y,f,!1,null)}return S},O.wU=function(S,p,l,s,a,u,f){if(p!=null){var y=p.Id();if(f!=null&&y.Fc()!=f.Fc()){if(y.pd!=f.pd)throw d.i.Zk();l=d.Uc.Ph(l,f,y)}}else if(f!=null)throw d.i.O();for(S=new d.$c(S),p=d.DC.local().W(S,p,l,s,a,u,null),l=[];(s=p.next())!=null;)l.push(s);return l.slice(0)},O.offset=function(S,p,l,s,a,u,f){if(p!=null){var y=p.Id();if(f!=null&&y.Fc()!=f.Fc()){if(y.pd!=f.pd)throw d.i.Zk();l=d.Uc.Ph(l,f,y)}}else if(f!=null)throw d.i.O();return d.DC.local().W(S,p,l,s,a,u,null)},O.dP=function(S){return d.xC.local().W(S,null)},O.eP=function(S,p){var l=d.xC.local();for(S=new d.$c(S),p=l.W(S,p,null),l=[];(S=p.next())!=null;)l.push(S);return l},O.iz=function(S,p,l){return d.Hx.local().iz(S,p,l)},O.jz=function(S,p){return d.Hx.local().jz(S,p)},O.kz=function(S,p,l,s){return d.Hx.local().kz(S,p,l,s)},O.$B=function(S,p){return d.$l.local().W(S,p,!1,null)},O.ZS=function(S,p){return d.$l.local().ts(S,p,null)},O.LQ=function(S,p,l,s,a){var u=d.zC.local();if(p!=null){if(p=p.Id(),a!=null&&p.Fc()!=a.Fc()){if(p.pd!=a.pd)throw d.i.Zk();l=d.Uc.Ph(l,a,p)}}else if(a!=null)throw d.i.O();return u.W(S,l,s,null)},O.Sr=function(S,p,l,s){var a=d.Zl.local();if(p!=null){if(p=p.Id(),s!=null&&p.Fc()!=s.Fc()){if(p.pd!=s.pd)throw d.i.Zk();l=d.Uc.Ph(l,s,p)}}else if(s!=null)throw d.i.O();return a.W(S,l,null)},O.Ry=function(S,p,l,s,a){a===void 0&&(a=0);var u=d.nL.local();if(a==4||a!==0)throw d.i.Fe();if(s!==null){if(s.pd!==0)throw d.i.O("Unit must be a linear unit type");l=d.Uc.Ph(l,s,d.Uc.ah(9001))}return u.W(S,l,p,a,null)},O.RQ=function(S,p,l,s){if(S===null)return 0;if(s==4||s!==0)throw d.i.Fe();if(S.K()==197)S=O.OT(S);else if(S.K()!=1736)return 0;if(s=d.cb.tc(p),S=d.cb.Bh(S,p,s),S=d.PK.SQ([S])[0],l!==null){if(l.pd!==2)throw d.i.O("Unit must be a area unit type");S=d.Uc.Ph(S,d.Uc.ah(109404),l)}return S},O.UQ=function(S,p,l,s){if(S=d.qL.local().W(S,p,s,null),l!==null){if(l.pd!==0)throw d.i.O("Unit must be a linear unit type");S=d.Uc.Ph(S,d.Uc.ah(9001),l)}return S},O.EU=function(S,p,l){if(S===null)return 0;var s=null;if(p!=null){if((s=p.Id()).pd==0&&(s=d.Uc.WF(s))==null&&l!==null)throw d.i.O();if(l!=null&&s.Fc()!=l.Fc()&&s.pd!=l.pd)throw d.i.Zk()}else if(l!=null)throw d.i.O();return S.K()==1736||S.K()==197?(S=S.He(),l!==null?d.Uc.Ph(S,s,l):S):0},O.FU=function(S,p,l){if(S===null||S.B()||1>S.Eb())return 0;var s=null;if(p!=null){if(s=p.Id(),l!=null&&s.Fc()!=l.Fc()&&s.pd!=l.pd)throw d.i.Zk()}else if(l!=null)throw d.i.O();S.K()==1736||S.K()==197?p=S.ng():d.ba.zd(S.K())?(p=new d.Ua(S.description)).pc(S,!0):p=S,S=0,p=p.Ha();for(var a=new d.h,u=new d.h;p.ab();)for(;p.Ia();){var f=p.ia();f.$p(a),f.Vr(u),S+=d.h.ub(a,u)}return s!==null&&l!==null&&(S=d.Uc.Ph(S,s,l)),S},O.aP=function(S){return S.points!==void 0?O.hS(S,S.hasZ!==void 0&&S.hasZ,S.hasM!==void 0&&S.hasM):S.rings!==void 0?O.gG(S.rings,S.hasZ!==void 0&&S.hasZ,S.hasM!==void 0&&S.hasM,"P"):S.paths!==void 0?O.gG(S.paths,S.hasZ!==void 0&&S.hasZ,S.hasM!==void 0&&S.hasM,"L"):S.x!==void 0?O.iS(S):S.xmin!==void 0?O.gS(S):null},O.iS=function(S){if(S.x==null||S.x=="NaN")return new d.Ta;var p=new d.Ta(S.x,S.y);return S.z!==void 0&&S.z!==null&&p.sX(S.z),S.m!==void 0&&S.m!==null&&p.cX(S.m),p},O.gS=function(S){if(S.xmin==null||S.xmin=="NaN")return new d.Hh;var p=new d.Hh(S.xmin,S.ymin,S.xmax,S.ymax);return S.zmin!==void 0&&S.zmin!==null&&p.setInterval(1,0,S.zmin,S.zmax),S.mmin!==void 0&&S.mmin!==null&&p.setInterval(2,0,S.mmin,S.mmax),p},O.hS=function(S,p,l){var s=0,a=new d.ee,u=3*S.points.length;u%2!=0&&u++,2>u&&(u=2);var f=d.P.truncate(3*S.points.length/2);4>f?f=4:16>f&&(f=16),u=d.Zc.Fn(u,0);var y=d.Zc.Fn(f);f=d.Zc.Fn(f);for(var v=0;v<S.points.length;v++)u.write(2*v,S.points[v][0]),u.write(2*v+1,S.points[v][1]),y.write(v,p||l?S.points[v][2]:NaN),f.write(v,l&&p?S.points[v][3]:NaN),s++;return s!=0&&(a.resize(s),a.kn(0,u)),p&&(a.se(1),a.kn(1,y)),l&&(a.se(2),a.kn(2,p==0?y:f)),a.Qc(16777215),a},O.gG=function(S,p,l,s){var a=0,u=2;if(s=="P"){var f=new d.Ea;a=1,u=3}else f=new d.Ua;for(var y=d.Zc.Qh(0),v=d.Zc.Or(0),_=0,M=0,$=[],T=[],A=0;A<S.length;A++){var R=S[A].length;if($[A]=!1,s==="P"&&S[A][0][0]===S[A][S[A].length-1][0]&&S[A][0][1]===S[A][S[A].length-1][1]){var D=l==0||S[A][0][3]===S[A][S[A].length-1][3]||S[A][0][3]===void 0&&S[A][S[A].length-1][3]===void 0;(p==0||S[A][0][2]===S[A][S[A].length-1][2]||S[A][0][2]===void 0&&S[A][S[A].length-1][2]===void 0)&&D&&($[A]=!0,--R)}R>=u?(T[A]=!1,M+=1,y.add(_),v.add(a),_+=R):T[A]=!0}for((s=3*_)%2!=0&&s++,2>s&&(s=2),4>(A=d.P.truncate(3*_/2))?A=4:16>A&&(A=16),s=d.Zc.Fn(s,0),a=d.Zc.Fn(A),u=d.Zc.Fn(A),A=R=0;A<S.length;A++)if(T[A]===!1)for(D=0;D<S[A].length;D++){var V=!1;D===S[A].length-1&&$[A]===!0&&(V=!0),V||(s.write(2*R,S[A][D][0]),s.write(2*R+1,S[A][D][1]),a.write(R,p||l?S[A][D][2]:NaN),u.write(R,l&&p?S[A][D][3]:NaN),R++)}return _!=0&&(S=f,y.resize(M),v.resize(M),0<_&&(y.add(_),v.add(0)),S.kn(0,s),S.KJ(v),S.LJ(y)),p&&(f.se(1),f.kn(1,a)),l&&(f.se(2),f.kn(2,p==0?a:u)),f.Qc(16777215),f},O}()}(Q||(Q={})),function(d){d.Dx=function(){function O(){}return O.dr=function(S){var p,l=0,s=S.length,a=S[0];for(p=0;p<s-1;p++){var u=S[p+1];l+=(u[0]-a[0])*(u[1]+a[1]),a=u}return 0<=l},O.rotate=function(S,p,l){p=p*Math.PI/180;var s=Math.cos(p),a=Math.sin(p);if(S.paths!==void 0){p={paths:[]};for(var u=0;u<S.paths.length;u++){for(var f=S.paths[u],y=[],v=0;v<f.length;v++){var _=f[v].slice(0);y.push(_);var M=s*(f[v][0]-l.x)-a*(f[v][1]-l.y)+l.x,$=a*(f[v][0]-l.x)+s*(f[v][1]-l.y)+l.y;_[0]=M,_[1]=$}p.paths.push(y),S.hasZ!==void 0&&(p.hasZ=S.hasZ),S.hasM!==void 0&&(p.hasM=S.hasM)}return p}if(S.rings!==void 0){for(p={rings:[]},u=0;u<S.rings.length;u++){f=S.rings[u],y=[];var T=O.dr(f);for(v=0;v<f.length;v++)_=f[v].slice(0),y.push(_),M=s*(f[v][0]-l.x)-a*(f[v][1]-l.y)+l.x,$=a*(f[v][0]-l.x)+s*(f[v][1]-l.y)+l.y,_[0]=M,_[1]=$;O.dr(y)!==T&&y.reverse(),p.rings.push(y),S.hasZ!==void 0&&(p.hasZ=S.hasZ),S.hasM!==void 0&&(p.hasM=S.hasM)}return p}if(S.x!==void 0)return p={x:s*(S.x-l.x)-a*(S.y-l.y)+l.x,y:a*(S.x-l.x)+s*(S.y-l.y)+l.y},S.z!==void 0&&(p.z=S.z),S.m!==void 0&&(p.m=S.m),S.hasZ!==void 0&&(p.hasZ=S.hasZ),S.hasM!==void 0&&(p.hasM=S.hasM),p;if(S.points!==void 0){for(p={points:[]},u=S.points,v=0;v<u.length;v++)(f=u[v].slice(0))[0]=s*(u[v][0]-l.x)-a*(u[v][1]-l.y)+l.x,f[1]=a*(u[v][0]-l.x)+s*(u[v][1]-l.y)+l.y,p.points.push(f);return S.hasZ!==void 0&&(p.hasZ=S.hasZ),S.hasM!==void 0&&(p.hasM=S.hasM),p}return null},O.EQ=function(S,p){if(S.paths!==void 0){for(var l={paths:[]},s=0;s<S.paths.length;s++){for(var a=S.paths[s],u=[],f=0;f<a.length;f++){var y=a[f].slice(0);u.push(y);var v=p.x-a[f][0];y[0]=a[f][0]+2*v}l.paths.push(u)}return S.hasZ!==void 0&&(l.hasZ=S.hasZ),S.hasM!==void 0&&(l.hasM=S.hasM),l}if(S.rings!==void 0){for(l={rings:[]},s=0;s<S.rings.length;s++){a=S.rings[s];var _=O.dr(a);for(u=[],f=0;f<a.length;f++)y=a[f].slice(0),u.push(y),v=p.x-a[f][0],y[0]=a[f][0]+2*v;O.dr(u)!==_&&u.reverse(),l.rings.push(u)}return S.hasZ!==void 0&&(l.hasZ=S.hasZ),S.hasM!==void 0&&(l.hasM=S.hasM),l}if(S.x!==void 0)return v=p.x-S.x,l={x:S.x+2*v,y:S.y},S.z!==void 0&&(l.z=S.z),S.m!==void 0&&(l.m=S.m),S.hasZ!==void 0&&(l.hasZ=S.hasZ),S.hasM!==void 0&&(l.hasM=S.hasM),l;if(S.points!==void 0){for(l={points:[]},s=S.points,f=0;f<s.length;f++)a=s[f].slice(0),v=p.x-a[0],a[0]+=2*v,l.points.push(a);return S.hasZ!==void 0&&(l.hasZ=S.hasZ),S.hasM!==void 0&&(l.hasM=S.hasM),l}return S.xmin!==void 0?(l={v:S.xmin,G:S.ymin,C:S.xmax,H:S.ymax},S.zmin!==void 0&&(l.zmin=S.zmin,l.zmax=S.zmax),S.mmin!==void 0&&(l.mmin=S.mmin,l.mmax=S.mmax),v=p.x-S.xmin,l.xmax=S.xmin+2*v,v=p.x-S.xmax,l.xmin=S.xmax+2*v,S.zmin!==void 0&&(l.zmin=S.zmin),S.zmax!==void 0&&(l.zmax=S.zmax),S.mmin!==void 0&&(l.mmin=S.mmin),S.mmax!==void 0&&(l.mmax=S.mmax),S.hasZ!==void 0&&(l.hasZ=S.hasZ),S.hasM!==void 0&&(l.hasM=S.hasM),l):null},O.FQ=function(S,p){if(S.paths!==void 0){for(var l={paths:[]},s=0;s<S.paths.length;s++){for(var a=S.paths[s],u=[],f=0;f<a.length;f++){var y=a[f].slice(0);u.push(y);var v=p.y-a[f][1];y[1]=a[f][1]+2*v}l.paths.push(u)}return S.hasZ!==void 0&&(l.hasZ=S.hasZ),S.hasM!==void 0&&(l.hasM=S.hasM),l}if(S.rings!==void 0){for(l={rings:[]},s=0;s<S.rings.length;s++){a=S.rings[s];var _=O.dr(a);for(u=[],f=0;f<a.length;f++)y=a[f].slice(0),u.push(y),v=p.y-a[f][1],y[1]=a[f][1]+2*v;O.dr(u)!==_&&u.reverse(),l.rings.push(u)}return S.hasZ!==void 0&&(l.hasZ=S.hasZ),S.hasM!==void 0&&(l.hasM=S.hasM),l}if(S.x!==void 0)return v=p.y-S.y,l={y:S.y+2*v,x:S.x},S.z!==void 0&&(l.z=S.z),S.m!==void 0&&(l.m=S.m),S.hasZ!==void 0&&(l.hasZ=S.hasZ),S.hasM!==void 0&&(l.hasM=S.hasM),l;if(S.points!==void 0){for(l={points:[]},s=S.points,f=0;f<s.length;f++)a=s[f].slice(0),v=p.y-a[1],a[1]+=2*v,l.points.push(a);return S.hasZ!==void 0&&(l.hasZ=S.hasZ),S.hasM!==void 0&&(l.hasM=S.hasM),l}return S.xmin!==void 0?(l={v:S.xmin,G:S.ymin,C:S.xmax,H:S.ymax},S.zmin!==void 0&&(l.zmin=S.zmin,l.zmax=S.zmax),S.mmin!==void 0&&(l.mmin=S.mmin,l.mmax=S.mmax),v=p.y-S.ymin,l.ymax=S.ymin+2*v,v=p.y-S.ymax,l.ymin=S.ymax+2*v,S.zmin!==void 0&&(l.zmin=S.zmin),S.zmax!==void 0&&(l.zmax=S.zmax),S.mmin!==void 0&&(l.mmin=S.mmin),S.mmax!==void 0&&(l.mmax=S.mmax),S.hasZ!==void 0&&(l.hasZ=S.hasZ),S.hasM!==void 0&&(l.hasM=S.hasM),l):null},O}()}(Q||(Q={})),function(d){d.UK=function(){function O(){}return O.Kg=function(S,p){switch(p==null&&(p=d.fe.pg()),S){case 33:return new d.Ta(p);case 322:return new d.zb(p);case 197:return new d.Hh(p);case 550:return new d.ee(p);case 1607:return new d.Ua(p);case 1736:return new d.Ea(p);default:throw d.i.ga("invalid argument.")}},O}()}(Q||(Q={})),function(d){var O=function(){function S(p,l){this.Qe=d.ja.rf(p,-1),this.va=new d.cu,this.yl=l}return S.prototype.vW=function(p){this.va.Bt(Math.min(this.Qe.size,p)),this.va.hn(p)},S.prototype.addElement=function(p,l){if(l===void 0)return this.$M(p);l=d.P.truncate(l%this.Qe.size);var s=this.Qe.get(l);return s==-1&&(s=this.va.Rh(),this.Qe.set(l,s)),this.va.addElement(s,p)},S.prototype.$M=function(p){var l=this.yl.ez(p);l=d.P.truncate(l%this.Qe.size);var s=this.Qe.get(l);return s==-1&&(s=this.va.Rh(),this.Qe.set(l,s)),this.va.addElement(s,p)},S.prototype.kd=function(p,l){if(l===void 0)this.FP(p);else{l=d.P.truncate(l%this.Qe.size);var s=this.Qe.get(l);if(s==-1)throw d.i.O();for(var a=this.va.sc(s),u=-1;a!=-1;){var f=this.va.lb(a);this.va.ka(a)==p?(this.va.kd(s,u,a),this.va.sc(s)==-1&&(this.va.eh(s),this.Qe.set(l,-1))):u=a,a=f}}},S.prototype.FP=function(p){var l=this.yl.ez(p);l=d.P.truncate(l%this.Qe.size);var s=this.Qe.get(l);if(s==-1)throw d.i.O();for(var a=this.va.sc(s),u=-1;a!=-1;){var f=this.va.lb(a);this.va.ka(a)==p?(this.va.kd(s,u,a),this.va.sc(s)==-1&&(this.va.eh(s),this.Qe.set(l,-1))):u=a,a=f}},S.prototype.lR=function(p){return p=d.P.truncate(p%this.Qe.size),(p=this.Qe.get(p))==-1?-1:this.va.sc(p)},S.prototype.zR=function(p){return this.va.lb(p)},S.prototype.wd=function(p){var l=this.yl.ez(this.ka(p));l=d.P.truncate(l%this.Qe.size);var s=this.Qe.get(l);if(s==-1)throw d.i.O();for(var a=this.va.sc(s),u=-1;a!=-1;){if(a==p)return this.va.kd(s,u,a),void(this.va.sc(s)==-1&&(this.va.eh(s),this.Qe.set(l,-1)));u=a,a=this.va.lb(a)}throw d.i.O()},S.prototype.ka=function(p){return this.va.ka(p)},S.prototype.clear=function(){this.Qe=d.ja.rf(this.Qe.size,-1),this.va.clear()},S.prototype.size=function(){return this.va.OF()},S}();d.ZK=O}(Q||(Q={})),function(d){var O=function(){function S(){this.Ni=new d.ad(3),this.va=new d.ad(6),this.mT=!1,this.ke=-1}return S.prototype.hl=function(p){this.Ni.kd(p)},S.prototype.Rw=function(){return this.Ni.De()},S.prototype.dv=function(p){this.va.kd(p)},S.prototype.VA=function(){return this.va.De()},S.prototype.RB=function(p,l){this.Ni.T(p,1,l)},S.prototype.fx=function(p,l){this.Ni.T(p,2,l)},S.prototype.bX=function(p,l){this.Ni.T(p,3,l)},S.prototype.PB=function(p,l){this.va.T(p,4,l)},S.prototype.eX=function(p,l){this.va.T(p,3,l)},S.prototype.OJ=function(p,l){this.va.T(p,2,l)},S.prototype.Rh=function(p){var l=this.VA();return this.va.T(l,3,this.ke),this.va.T(l,4,0),this.va.T(l,5,p),this.ke!=-1&&this.OJ(this.ke,l),this.ke=l},S.prototype.eh=function(p){this.GE(p);var l=this.va.U(p,2),s=this.va.U(p,3);return l!=-1?this.eX(l,s):this.ke=s,s!=-1&&this.OJ(s,l),this.dv(p),s},S.prototype.Bt=function(p){this.va.Ee(p)},S.prototype.KF=function(p){return this.va.U(p,5)},S.prototype.aX=function(p,l){this.va.T(p,5,l)},S.prototype.addElement=function(p,l){return this.oS(p,l)},S.prototype.oS=function(p,l){var s=this.Rw();this.fx(s,-1),this.va.U(p,0)==-1&&this.va.T(p,0,s);var a=this.va.U(p,1);return this.RB(s,a),a!=-1&&this.fx(a,s),this.va.T(p,1,s),this.setData(s,l),this.PB(p,this.ds(p)+1),this.mT&&this.bX(s,p),s},S.prototype.kd=function(p,l){var s=this.xe(l),a=this.lb(l);return s!=-1?this.fx(s,a):this.va.T(p,0,a),a!=-1?this.RB(a,s):this.va.T(p,1,s),this.hl(l),this.PB(p,this.ds(p)-1),a},S.prototype.hn=function(p){this.Ni.Ee(p)},S.prototype.getData=function(p){return this.Ni.U(p,0)},S.prototype.setData=function(p,l){this.Ni.T(p,0,l)},S.prototype.lb=function(p){return this.Ni.U(p,2)},S.prototype.xe=function(p){return this.Ni.U(p,1)},S.prototype.sc=function(p){return this.va.U(p,0)},S.prototype.Gc=function(p){return this.va.U(p,1)},S.prototype.clear=function(){for(var p=this.ke;p!=-1;)p=this.eh(p)},S.prototype.GE=function(p){for(var l=this.Gc(p);l!=-1;){var s=l;l=this.xe(s),this.hl(s)}this.va.T(p,0,-1),this.va.T(p,1,-1),this.PB(p,0)},S.prototype.B=function(){return this.Ni.size==0},S.prototype.OF=function(){return this.Ni.size},S.prototype.ds=function(p){return this.va.U(p,4)},S.prototype.lz=function(p){return this.va.U(p,3)},S}();d.lp=O}(Q||(Q={})),function(d){var O=function(){function S(p){p===void 0?(this.vg=new d.ad(2),this.va=new d.ad(4),this.ke=-1,this.Sv=!0):(this.vg=new d.ad(2),this.va=new d.ad(p?4:2),this.ke=-1,this.Sv=p)}return S.prototype.hl=function(p){this.vg.kd(p)},S.prototype.Rw=function(){return this.vg.De()},S.prototype.dv=function(p){this.va.kd(p)},S.prototype.VA=function(){return this.va.De()},S.prototype.Rh=function(){var p=this.VA();return this.Sv&&(this.va.T(p,3,this.ke),this.ke!=-1&&this.va.T(this.ke,2,p),this.ke=p),p},S.prototype.eh=function(p){for(var l=this.sc(p);l!=-1;){var s=l;l=this.lb(l),this.hl(s)}this.Sv&&(l=this.va.U(p,2),s=this.va.U(p,3),l!=-1?this.va.T(l,3,s):this.ke=s,s!=-1&&this.va.T(s,2,l)),this.dv(p)},S.prototype.Bt=function(p){this.va.Ee(p)},S.prototype.addElement=function(p,l){var s=this.va.U(p,1),a=this.Rw();return s!=-1?this.vg.T(s,1,a):this.va.T(p,0,a),this.va.T(p,1,a),this.vg.T(a,0,l),a},S.prototype.hn=function(p){this.vg.Ee(p)},S.prototype.kd=function(p,l,s){l!=-1?(this.vg.T(l,1,this.vg.U(s,1)),this.va.U(p,1)==s&&this.va.T(p,1,l)):(this.va.T(p,0,this.vg.U(s,1)),this.va.U(p,1)==s&&this.va.T(p,1,-1)),this.hl(s)},S.prototype.Cy=function(p,l){var s=this.va.U(p,1),a=this.va.U(l,0);a!=-1&&(s!=-1?this.vg.T(s,1,a):this.va.T(p,0,a),this.va.T(p,1,this.va.U(l,1))),this.Sv&&(p=this.va.U(l,2),s=this.va.U(l,3),p!=-1?this.va.T(p,3,s):this.ke=s,s!=-1&&this.va.T(s,2,p)),this.dv(l)},S.prototype.ka=function(p){return this.vg.U(p,0)},S.prototype.Uj=function(p,l){this.vg.T(p,0,l)},S.prototype.lb=function(p){return this.vg.U(p,1)},S.prototype.sc=function(p){return this.va.U(p,0)},S.prototype.Ln=function(p){return this.ka(this.sc(p))},S.prototype.clear=function(){this.vg.oj(!0),this.va.oj(!0),this.ke=-1},S.prototype.B=function(){return this.vg.size==0},S.prototype.OF=function(){return this.vg.size},S.prototype.lz=function(p){return this.va.U(p,3)},S}();d.cu=O}(Q||(Q={})),function(d){d.ua=function(){function O(){}return O.Xd=function(S,p,l){return p=p.zr(),S=S!=null&&S.Yd!==void 0?S.Yd(0):0,l&&(p*=4,S*=1.1),Math.max(S,p)},O.Gr=function(S){return 2*Math.sqrt(2)*S},O.mN=function(S){return Math.sqrt(2)*S},O.mj=function(S,p,l){var s=new d.l;return p.A(s),O.Xd(S,s,l)},O.rE=function(S,p,l){return p=p.Vg(1,0).zr(),S=S!=null?S.Yd(1):0,l&&(p*=4,S*=1.1),Math.max(S,p)},O.ov=function(S,p){var l=new d.l;return S.yc(l),S=new d.l,p.yc(S),l.$b(S),l},O.TN=function(S){var p=new d.l;if(S.yc(p),p.B())return null;var l=new d.fu(p,8),s=-1,a=new d.l,u=!1;do for(var f=0,y=S.ea();f<y;f++){if(S.Tj(f,a),(s=l.Ez(f,a,s))==-1){if(u)throw d.i.ga("internal error");S.Ap(p,!1),u=!0,l.reset(p,8);break}u=!1}while(u);return l},O.iE=function(S){var p=new d.l;S.yc(p);for(var l=new d.fu(p,8),s=-1,a=S.Ha(),u=new d.l,f=!1;a.ab();)for(;a.Ia();){var y=a.ia(),v=a.xb();if(y.A(u),(s=l.Ez(v,u,s))==-1){if(f)throw d.i.Ra();S.Ap(p,!1),f=!0,l.reset(p,8),a.aj();break}}return l},O.lj=function(S,p){var l=new d.l;S.yc(l);for(var s=new d.fu(l,8),a=-1,u=new d.l,f=S.Ha(),y=!1;f.ab();)for(;f.Ia();){var v=f.ia(),_=f.xb();if(v.A(u),u.isIntersecting(p)&&(a=s.Ez(_,u,a))==-1){if(y)throw d.i.ga("internal error.");S.Ap(l,!1),y=!0,s.reset(l,8),f.aj();break}}return s},O.jE=function(S,p){for(var l=new d.fu(p,8),s=new d.h,a=!1,u=new d.l,f=0;f<S.I();f++)if(S.D(f,s),p.contains(s)&&(u.L(s),l.xj(f,u)==-1)){if(a)throw d.i.Ra();a=!0,f=new d.l,S.Ap(f,!1),l.reset(f,8),f=-1}return l},O.gR=function(S,p,l){var s=new d.l,a=new d.l;S.yc(s),p.yc(a),s.X(l,l),a.X(l,l);var u=new d.l;u.L(s),u.Fa(a),S=S.Ha(),p=p.Ha();var f=new d.sC;f.WB(l);var y=!1;for(f.kK();S.ab();)for(;S.Ia();)S.ia().A(s),s.isIntersecting(u)&&(y=!0,(l=new d.l).L(s),f.DD(S.xb(),l));if(f.dF(),!y)return null;for(s=!1,f.jK();p.ab();)for(;p.Ia();)p.ia().A(a),a.isIntersecting(u)&&(s=!0,(l=new d.l).L(a),f.zD(p.xb(),l));return f.cF(),s?f:null},O.hR=function(S,p,l,s,a){var u=S.K(),f=p.K(),y=new d.l,v=new d.l;S.yc(y),p.yc(v),y.X(l,l),v.X(l,l);var _=new d.l;_.L(y),_.Fa(v);var M=new d.sC;M.WB(l);var $=!1;M.kK();var T=0;for(l=S.ea();T<l;T++)s&&u==1736&&!S.Gv(T)||(S.Tj(T,y),y.isIntersecting(_)&&($=!0,M.DD(T,y)));if(M.dF(),!$)return null;for(S=!1,M.jK(),s=0,l=p.ea();s<l;s++)a&&f==1736&&!p.Gv(s)||(p.Tj(s,v),v.isIntersecting(_)&&(S=!0,M.zD(s,v)));return M.cF(),S?M:null},O.Tu=function(S,p,l){if(S!=p)for(var s=0;s<l;s++)S[s]==null?S[s]=d.h.cl(p[s]):S[s].N(p[s])},O.Ey=function(S,p,l,s){var a=0;for(s+=0;a<s;l++,a++)S[a]==null&&(S[a]=[0,0]),S[a][0]=p[l].x,S[a][1]=p[l].y},O.Dy=function(S,p,l,s){var a=p,u=0;for(p=s+p;a<p;u++,a++)S[a]==null?S[a]=d.h.construct(l[u][0],l[u][1]):S[a].na(l[u][0],l[u][1])},O.fP=function(S,p,l){if(S!=p)for(var s=0;s<l;s++)S[s]==null?S[s]=new d.Ta(p[s]):p[s].copyTo(S[s])},O.qE=function(S,p,l,s){var a=0;return S!=null&&(a=S.Yd(0),s&&!l||S==null||(a+=1.01*S.pz(0))),l&&(p*=4,a*=1.01),Math.max(a,p)},O.oy=function(S,p,l){return O.qE(S,p.zr(),l,!1)},O.bO=function(S,p){var l=new d.l;return p.A(l),O.oy(S,l,!0)},O.py=function(S,p){return O.qE(S,p.zr(),!1,!0)},O.Ju=function(S,p){var l=new d.l;return p.A(l),O.py(S,l)},O.vG=function(S,p,l,s){s*=s;var a=new d.h;if(a.vc(S,p),(S=new d.h).vc(l,p),p=a.Uk(),l=S.Uk(),p<=s&&l<=s)return!0;var u=d.mc.ox(a.yi(S));return(u<=s*p||u<=s*l)&&0<=a.Sh(S)},O.ZJ=function(S,p,l,s){for(var a=0;a<p;a++){var u=S[a].y,f=d.P.Tk(u,l,s);f!=u&&(S[a].y=f)}},O}()}(Q||(Q={})),function(d){var O,S,p=function(){function u(f){this.Za=f}return u.prototype.compare=function(f,y,v){f=f.ka(v),v=this.Za.qk(y);var _=this.Za.qk(f);return v<_?-1:v==_?a.iq(y)&&a.Iv(f)?-1:a.iq(f)&&a.Iv(y)?1:0:1},u}(),l=function(){function u(f){this.Za=f}return u.prototype.qr=function(f,y,v){this.Za.CX(v,f,y)},u.prototype.bq=function(f){return this.Za.qk(f)},u}();(S=O||(O={}))[S.initialize=0]="initialize",S[S.pIn=1]="pIn",S[S.pL=2]="pL",S[S.pR=3]="pR",S[S.pT=4]="pT",S[S.right=5]="right",S[S.left=6]="left",S[S.all=7]="all";var s=function(){function u(){this.Za=null,this.Si=new d.Oc,this.ji=new d.ja(0),this.tg=[0,0]}return u.prototype.Zi=function(f,y){this.Si.pa=f.pa-y,this.Si.wa=f.wa+y,this.ji.resize(0),this.ie=0,this.tg[0]=0},u.prototype.zB=function(f,y,v){if(f>y)throw d.i.O();this.Si.pa=f-v,this.Si.wa=y+v,this.ji.resize(0),this.ie=0,this.tg[0]=0},u.prototype.Wo=function(f,y){this.Si.pa=f-y,this.Si.wa=f+y,this.ji.resize(0),this.ie=0,this.tg[0]=0},u.prototype.next=function(){if(!this.Za.nq)throw d.i.Hb();if(0>this.ie)return-1;for(var f=!0;f;)switch(this.tg[this.ie]){case 1:f=this.AU();break;case 2:f=this.BU();break;case 3:f=this.CU();break;case 4:f=this.DU();break;case 5:f=this.AW();break;case 6:f=this.fT();break;case 7:f=this.oN();break;case 0:f=this.Bz();break;default:throw d.i.Ra()}return this.Qg!=-1?this.Op()>>1:-1},u.construct=function(f){var y=new u;return y.Za=f,y.ji.Jb(20),y.ie=-1,y},u.prototype.Bz=function(){return this.Qg=this.qH=this.Oi=this.Mc=-1,this.Za.ne!=null&&0<this.Za.ne.size?(this.tg[0]=1,this.Oi=this.Za.kf,!0):(this.ie=-1,!1)},u.prototype.AU=function(){if(this.Mc=this.Oi,this.Mc==-1)return this.Qg=this.ie=-1,!1;var f=this.Za.Pp(this.Mc);return this.Si.wa<f?(f=this.Za.pk(this.Mc),this.Oi=this.Za.sj(this.Mc),f!=-1&&(this.gi=this.Za.ml(f),this.tg[++this.ie]=6),!0):f<this.Si.pa?(f=this.Za.pk(this.Mc),this.Oi=this.Za.nk(this.Mc),f!=-1&&(this.gi=this.Za.bs(f),this.tg[++this.ie]=5),!0):(this.tg[this.ie]=2,this.qH=this.Mc,f=this.Za.pk(this.Mc),this.Oi=this.Za.sj(this.Mc),f!=-1&&(this.gi=this.Za.ml(f),this.tg[++this.ie]=7),!0)},u.prototype.BU=function(){if(this.Mc=this.Oi,this.Mc==-1)return this.tg[this.ie]=3,this.Oi=this.Za.nk(this.qH),!0;if(this.Za.Pp(this.Mc)<this.Si.pa){var f=this.Za.pk(this.Mc);return this.Oi=this.Za.nk(this.Mc),f!=-1&&(this.gi=this.Za.bs(f),this.tg[++this.ie]=5),!0}return f=this.Za.pk(this.Mc),this.Oi=this.Za.sj(this.Mc),f!=-1&&(this.gi=this.Za.ml(f),this.tg[++this.ie]=7),(f=this.Za.nk(this.Mc))!=-1&&this.ji.add(f),!0},u.prototype.CU=function(){if(this.Mc=this.Oi,this.Mc==-1)return this.tg[this.ie]=4,!0;if(this.Si.wa<this.Za.Pp(this.Mc)){var f=this.Za.pk(this.Mc);return this.Oi=this.Za.sj(this.Mc),f!=-1&&(this.gi=this.Za.ml(f),this.tg[++this.ie]=6),!0}return f=this.Za.pk(this.Mc),this.Oi=this.Za.nk(this.Mc),f!=-1&&(this.gi=this.Za.ml(f),this.tg[++this.ie]=7),(f=this.Za.sj(this.Mc))!=-1&&this.ji.add(f),!0},u.prototype.DU=function(){if(this.ji.size==0)return this.Qg=this.ie=-1,!1;this.Mc=this.ji.get(this.ji.size-1),this.ji.resize(this.ji.size-1);var f=this.Za.pk(this.Mc);return f!=-1&&(this.gi=this.Za.ml(f),this.tg[++this.ie]=7),this.Za.sj(this.Mc)!=-1&&this.ji.add(this.Za.sj(this.Mc)),this.Za.nk(this.Mc)!=-1&&this.ji.add(this.Za.nk(this.Mc)),!0},u.prototype.fT=function(){return this.Qg=this.gi,this.Qg!=-1&&a.iq(this.Op())&&this.Za.qk(this.Op())<=this.Si.wa?(this.gi=this.NF(),!1):(this.ie--,!0)},u.prototype.AW=function(){return this.Qg=this.gi,this.Qg!=-1&&a.Iv(this.Op())&&this.Za.qk(this.Op())>=this.Si.pa?(this.gi=this.LR(),!1):(this.ie--,!0)},u.prototype.oN=function(){return this.Qg=this.gi,this.Qg!=-1&&a.iq(this.Op())?(this.gi=this.NF(),!1):(this.ie--,!0)},u.prototype.NF=function(){return this.Za.Uf?this.Za.bg.lb(this.Qg):this.Za.Vi.lb(this.Qg)},u.prototype.LR=function(){return this.Za.Uf?this.Za.bg.xe(this.Qg):this.Za.Vi.xe(this.Qg)},u.prototype.Op=function(){return this.Za.Uf?this.Za.bg.ka(this.Qg):this.Za.Vi.getData(this.Qg)},u}();d.AY=s;var a=function(){function u(f){this.Cm=this.bi=this.bg=this.Vi=this.Mm=this.Gj=this.ne=this.Hj=null,this.Uf=f,this.nq=this.Uv=!1}return u.prototype.mr=function(){this.Pk(!0)},u.prototype.Dr=function(f,y){if(!this.Uv)throw d.i.Hb();this.Hj.push(new d.Oc(f,y))},u.prototype.Hp=function(){if(!this.Uv)throw d.i.ga("invalid call");this.Uv=!1,this.nq=!0,this.Uf||(this.qS(),this.aw=this.Hj.length)},u.prototype.xj=function(f){if(!this.Uf||!this.nq)throw d.i.O("invalid call");if(this.kf==-1){var y=this.Hj.length;if(this.dA){var v=new d.ja(0);v.Jb(2*y),this.XI(v),this.bi.Jb(2*y),this.bi.resize(0),this.WI(v),this.Mm.resize(y,-1),this.Mm.Yj(-1,0,y),this.dA=!1}else this.Mm.Yj(-1,0,y);this.kf=this.Vu()}y=this.kG(f<<1,this.kf),v=this.bg.addElement(1+(f<<1),this.rz(y)),this.QJ(y,v),this.Mm.set(f,y),this.aw++},u.prototype.remove=function(f){if(!this.Uf||!this.nq)throw d.i.ga("invalid call");var y=this.Mm.get(f);if(y==-1)throw d.i.O("the interval does not exist in the interval tree");this.Mm.set(f,-1),this.aw--;var v=this.rz(y),_=this.bg.UR(v);this.bg.wd(this.rR(y),v),this.bg.wd(this.OR(y),v),(f=this.bg.size(v))==0&&(this.bg.HP(v),this.UJ(_,-1)),this.Gj.kd(y),v=this.PF(_);var M=this.sj(_),$=this.nk(_);for(y=0;!(0<f||_==this.kf||M!=-1&&$!=-1);)_==this.sj(v)?M!=-1?(this.Qk(v,M),this.Wj(M,v),this.Qk(_,-1)):$!=-1?(this.Qk(v,$),this.Wj($,v),this.Sk(_,-1)):this.Qk(v,-1):M!=-1?(this.Sk(v,M),this.Wj(M,v),this.Qk(_,-1)):$!=-1?(this.Sk(v,$),this.Wj($,v),this.Sk(_,-1)):this.Sk(v,-1),this.Wj(_,-1),y++,_=v,f=(v=this.pk(_))!=-1?this.bg.size(v):0,M=this.sj(_),$=this.nk(_),v=this.PF(_)},u.prototype.reset=function(){if(!this.Uf||!this.nq)throw d.i.O("invalid call");this.Pk(!1)},u.prototype.size=function(){return this.aw},u.prototype.getIterator=function(){return s.construct(this)},u.prototype.XI=function(f){for(var y=this.Hj.length,v=0;v<2*y;v++)f.add(v);this.DX(f,2*y)},u.prototype.WI=function(f){for(var y=NaN,v=0;v<f.size;v++){var _=f.get(v),M=this.qk(_);M!=y&&(this.bi.add(_),y=M)}},u.prototype.qS=function(){var f=this.Hj.length,y=new d.ja(0);y.Jb(2*f),this.XI(y),this.bi.Jb(2*f),this.bi.resize(0),this.WI(y),this.Gj.Ee(f),this.Vi.hn(2*f);var v=d.Zc.Qh(f);for(v.Yj(-1,0,f),this.kf=this.Vu(),f=0;f<y.size;f++){var _=y.get(f),M=v.get(_>>1);M!=-1?this.QJ(M,this.Vi.addElement(this.rz(M),_)):(M=this.kG(_,this.kf),v.set(_>>1,M))}},u.prototype.kG=function(f,y){var v=y,_=y,M=-1,$=0,T=this.bi.size-1,A=0,R=f>>1,D=NaN,V=NaN,Z=!0,ee=this.yR(R);for(R=this.vR(R);Z;){$<T?(A=$+d.P.truncate((T-$)/2),this.bz(v)==-1&&this.AJ(v,this.bi.get(A),this.bi.get(A+1))):this.bz(v)==-1&&this.AJ(v,this.bi.get($),this.bi.get($));var G=this.Pp(v);if(R<G)y!=-1&&(y==v?(_=v,D=G,V=(y=this.sj(v))!=-1?this.Pp(y):NaN):V>G&&(G<D?this.Qk(_,v):this.Sk(_,v),this.Sk(v,y),this.Uf&&(this.Wj(v,_),this.Wj(y,v)),_=v,D=G,y=-1,V=NaN)),(T=this.sR(v))==-1&&(T=this.Vu(),this.ZW(v,T)),v=T,T=A;else if(ee>G)y!=-1&&(y==v?(_=v,D=G,V=(y=this.nk(v))!=-1?this.Pp(y):NaN):V<G&&(G<D?this.Qk(_,v):this.Sk(_,v),this.Qk(v,y),this.Uf&&(this.Wj(v,_),this.Wj(y,v)),_=v,D=G,y=-1,V=NaN)),($=this.PR(v))==-1&&($=this.Vu(),this.jX(v,$)),v=$,$=A+1;else{(Z=this.pk(v))==-1&&(Z=this.uP(v),this.UJ(v,Z));var re=this.aN(Z,f);M=this.sP(),this.mX(M,Z),this.YW(M,re),v!=y&&(G<D?this.Qk(_,v):this.Sk(_,v),this.Uf&&this.Wj(v,_),y!=-1&&(V<G?this.Qk(v,y):this.Sk(v,y),this.Uf&&this.Wj(y,v))),Z=!1}}return M},u.prototype.Vu=function(){return this.ne.De()},u.prototype.uP=function(f){return this.Uf?this.bg.Rr(f):this.Vi.Rh(f)},u.prototype.sP=function(){return this.Gj.De()},u.prototype.Pk=function(f){f?(this.Uv=this.dA=!0,this.nq=!1,this.bi==null?this.bi=d.Zc.Qh(0):this.bi.resize(0),this.Hj==null?this.Hj=[]:this.Hj.length=0):this.dA=!1,this.Uf?this.Mm==null?(this.Mm=d.Zc.Qh(0),this.bg=new d.$j,this.bg.Xo(new p(this))):this.bg.clear():this.Vi==null?this.Vi=new d.lp:this.Vi.clear(),this.ne==null?(this.Gj=new d.ad(3),this.ne=new d.ad(this.Uf?8:7)):(this.Gj.oj(!1),this.ne.oj(!1)),this.kf=-1,this.aw=0},u.prototype.AJ=function(f,y,v){this.SW(f,y),this.TW(f,v)},u.prototype.Pp=function(f){var y=this.bz(f);return y==-1?NaN:(y=this.qk(y))==(f=this.qk(this.bR(f)))?y:.5*(y+f)},u.prototype.SW=function(f,y){this.ne.T(f,0,y)},u.prototype.TW=function(f,y){this.ne.T(f,1,y)},u.prototype.ZW=function(f,y){this.ne.T(f,3,y)},u.prototype.jX=function(f,y){this.ne.T(f,4,y)},u.prototype.UJ=function(f,y){this.ne.T(f,2,y)},u.prototype.Qk=function(f,y){this.ne.T(f,5,y)},u.prototype.Sk=function(f,y){this.ne.T(f,6,y)},u.prototype.Wj=function(f,y){this.ne.T(f,7,y)},u.prototype.mX=function(f,y){this.Gj.T(f,0,y)},u.prototype.aN=function(f,y){return this.Uf?this.bg.addElement(y,f):this.Vi.addElement(f,y)},u.prototype.YW=function(f,y){this.Gj.T(f,1,y)},u.prototype.QJ=function(f,y){this.Gj.T(f,2,y)},u.prototype.ml=function(f){return this.Uf?this.bg.sc(f):this.Vi.sc(f)},u.prototype.bs=function(f){return this.Uf?this.bg.Gc(f):this.Vi.Gc(f)},u.iq=function(f){return(1&f)==0},u.Iv=function(f){return(1&f)==1},u.prototype.bz=function(f){return this.ne.U(f,0)},u.prototype.bR=function(f){return this.ne.U(f,1)},u.prototype.pk=function(f){return this.ne.U(f,2)},u.prototype.sR=function(f){return this.ne.U(f,3)},u.prototype.PR=function(f){return this.ne.U(f,4)},u.prototype.sj=function(f){return this.ne.U(f,5)},u.prototype.nk=function(f){return this.ne.U(f,6)},u.prototype.PF=function(f){return this.ne.U(f,7)},u.prototype.rz=function(f){return this.Gj.U(f,0)},u.prototype.rR=function(f){return this.Gj.U(f,1)},u.prototype.OR=function(f){return this.Gj.U(f,2)},u.prototype.yR=function(f){return this.Hj[f].pa},u.prototype.vR=function(f){return this.Hj[f].wa},u.prototype.DX=function(f,y){this.Cm==null&&(this.Cm=new d.Zt);var v=new l(this);this.Cm.sort(f,0,y,v)},u.prototype.CX=function(f,y,v){var _=this;f.Wd(y,v,function(M,$){var T=_.qk(M),A=_.qk($);return T<A||T==A&&u.iq(M)&&u.Iv($)?-1:1})},u.prototype.qk=function(f){var y=this.Hj[f>>1];return u.iq(f)?y.pa:y.wa},u}();d.ur=a}(Q||(Q={})),function(d){var O=function(){function S(p){if(p==null)throw d.i.ga("Invalid arguement");this.hf=p;var l=p.iR();l.cS()?p.ef.DG()?this.no=d.ui.PannableFold:this.no=d.ui.Clip:this.no=d.ui.DontClip,l.dS()?p.$f.DG()?this.Sm=d.ui.PannableFold:this.Sm=d.ui.Clip:this.Sm=d.ui.DontClip,this.Dm=l.Lr,this.hH=l.Xu,p=this.hf.nH,this.WG=p.ks(2147483648),this.Wv=p.ks(1073741824)}return S.Bh=function(p,l,s){return l.yw.Bh(p,s)},S.Tt=function(p,l,s,a){return p.yw.Tt(l,s,a)},S.St=function(p,l,s,a){if(s=0>s?l.length:s,(p=p.yw.Tt(l,s,a))==s)return p;for(var u=l=0;u<s;u++){var f=a[u];f.isNaN()||(l<u&&a[l].N(f),l++)}for(;l<s;l++)a[l].Sc();return p},S.transform=function(p,l,s,a,u){if(p.isIdentity())return d.ua.fP(a,l,s),s;for(var f=[],y=0,v=0;v<s;){for(var _=Math.min(f.length,s-v),M=v,$=0;M<_;M++,$++)f[$]==null?f[$]=l[M].D():l[M].D(f[$]);var T=u?S.St(p,f,_,f):S.Tt(p,f,_,f);for($=M=0;M<T;M++,$++)a[v]==null&&(a[v]=new d.Ta(l[v])),a[v].Db(f[$]);v+=_,y+=T}return y},S.prototype.Tt=function(p,l,s){if(this.hf.isIdentity())return p!=s&&d.ua.Tu(s,p,l),l;var a=this.hf.ef,u=this.hf.$f,f=a.Tb(),y=u.Tb();if(f==0&&f===y){var v=a.Sp();return u=v/(u=u.Sp()),(v=new d.Ed).Jt(u,u),v.aY(p,l,s),l}if(v=d.P.Hu(Math.min(l,64)),f==3){var _=a.Li;f=(a=_.hk()).Tb(),s!=p&&d.ua.Tu(s,p,l),d.Ab.bl(_,s,l,!0),_.St(d.dm.forward,s,l),d.Ab.al(_,s,l,!0)}if(f==3||y===3)throw d.i.ga("image: transform_in_place_");if(f==2)this.no==d.ui.Clip?(s!=p&&d.ua.Tu(s,p,l),p=a.ol(),d.Ab.JS(p,a,s,l)):(s!=p&&d.ua.Tu(s,p,l),a.Xc()&&(f=a.Yd(0),_=a.Le(),d.Ab.AX(s,l,_,f),d.Ab.lF(s,l,a,0))),d.Ab.DL(a,s,l,v);else for(f=a.Yd(0),_=a.Le(),a=0;a<l;a++)d.Ab.BX(p[a],_,f,s[a]);for(d.Ab.BL(this.hf,s,l,v),p=0,(y=y==2)?p=u.Bi():isNaN(this.Dm)||(p=this.Dm),y&&this.Sm!=d.ui.Clip||d.Ab.lF(s,l,u.tc(),p),y&&(d.Ab.tG(s,l,u,this.Sm),d.Ab.CL(u,s,l,v)),p=l,a=0;a<l;++a)s[a].isNaN()&&p--;return p},S.prototype.Bh=function(p,l){if(this.hf.isIdentity()||p.B())return p;if(p.K()==33)return this.SI(p);var s=this.hf.ef,a=this.hf.$f,u=s.Tb(),f=a.Tb();if(u==0&&u==f)return l=s.Sp(),l/=a=a.Sp(),(a=new d.Ed).Jt(l,l),(p=d.ba.kg(p)).Pc(a),p;switch(p.K()){case 1607:case 1736:p=this.QI(p,l);break;case 550:p=this.aW(p,l);break;case 197:p=this.$V(p,l);break;default:throw d.i.ga("")}return p},S.prototype.SI=function(p){var l=p.D(),s=[];return s[0]=l,this.Tt(s,1,s),(p=new d.Ta(p)).Db(s[0]),p},S.prototype.QI=function(p,l){if(p.vm())throw d.i.ga("curves not supported");var s=p.K();if(s==1736)return this.bW(p,l);if(s==1607)return this.cW(p,l);throw d.i.ga("projectMultiPath")},S.prototype.bW=function(p,l){var s=this.hf.ef,a=this.hf.$f,u=s.Tb(),f=a.Tb(),y=d.P.Hu(Math.min(p.I(),64)),v=d.Ea.kg(p);u==3&&(u=(s=(p=s.Li).hk()).Tb(),v=p.bl(v,!0),this.yp(p,d.dm.forward,v),v=p.al(v,!0)),p=null,f==3&&(f=(a=(p=a.Li).hk()).Tb());var _=u==2,M=f==2,$=M?a.tc():a,T=!M&&!this.Wv;f=!1;var A=v;if(_){if((A=d.Ab.OI(A,s,this.no,l)).B())return A}else{if(v=new d.l,A.yc(v),u=s.Le(),v.G<u.G||v.H>u.H){var R=d.l.construct(v.v-1,u.G,v.C+1,u.H);if((A=d.ti.Pu(A,R,s,NaN,0,l)).B())return A}v.S()>2*u.S()&&(A=d.Ab.Jp(A,-2*u.S(),2*u.S(),s,!0,0,!0,l))}v=this.hH,(u=!isNaN(v))&&(A=d.Zl.local().W(A,v,l)),R=M?a.mk():null;var D=NaN;_&&(D=s.Bi());var V=a.Yr()!=null;if(this.WG)_&&(d.Ab.wr(s,D,A,y),u&&(_=s.jh(),v*=(D=s.tc().jh())/_)),d.Ab.vr(this.hf,A,T,y),u&&(_=s.tc().jh(),v*=(D=a.tc().jh())/_),s=A;else{var Z=new d.Ua(A.description);Z.yD(A),_&&(d.Ab.wr(s,D,Z,y),u&&(_=s.jh(),v*=(D=s.tc().jh())/_)),d.Ab.vr(this.hf,Z,T,y),u&&(_=s.tc().rm(),v*=(D=a.tc().rm())/_),T=NaN,M?(R=a.mk(),T=a.Bi()):isNaN(this.Dm)||(T=this.Dm),_=S.vv(s)|S.vv(a),D=10*$.Yd(0),this.Wv&&(_=3,D=0),s=d.Ab.PQ(A,s,Z,$,T,l,_,D)}return V&&(s=d.Ab.SD(s,a,l)),M&&(f||(M=$.Le().S(),s.Vg(0,0).S()>=M-$.Yd(0)&&($=R.getNorthPoleLocation(),M=R.getSouthPoleLocation(),A=R.getNorthPoleGeometry(),R=R.getSouthPoleGeometry(),T=0,A==d.Eg.PE_POLE_POINT&&$!=d.Eg.PE_POLE_OUTSIDE_BOUNDARY&&(T=1),R==d.Eg.PE_POLE_POINT&&M!=d.Eg.PE_POLE_OUTSIDE_BOUNDARY&&(T|=2),T!==0&&(f=!0))),s=d.Ab.Hz(s,a,this.Sm,l),u&&(s=d.Zl.local().W(s,v,l)),d.Ab.Kx(a,s,y)),s.B()||(f&&(s=d.$l.local().W(s,a,!1,l)),p!=null&&(s=p.al(s,!1),this.yp(p,d.dm.reverse,s),s=p.bl(s,!1))),s},S.vv=function(p){if(p.Tb()!=2)return 0;var l=0,s=p.mk();p=s.getNorthPoleLocation();var a=s.getSouthPoleLocation(),u=s.getNorthPoleGeometry();return s=s.getSouthPoleGeometry(),u==d.Eg.PE_POLE_POINT&&p!=d.Eg.PE_POLE_OUTSIDE_BOUNDARY&&(l=1),s==d.Eg.PE_POLE_POINT&&a!=d.Eg.PE_POLE_OUTSIDE_BOUNDARY&&(l|=2),l},S.prototype.cW=function(p,l){var s=this.hf.ef,a=this.hf.$f,u=s.Tb(),f=a.Tb(),y=d.P.Hu(Math.min(p.I(),64)),v=d.Ua.kg(p);u==3&&(u=(s=(p=s.Li).hk()).Tb(),v=p.bl(v,!0),this.yp(p,d.dm.forward,v),v=p.al(v,!0)),p=null,f==3&&(f=(a=(p=a.Li).hk()).Tb());var _=u==2;u=(f=f==2)?a.tc():a;var M=!f&&!this.Wv;if(_){if((v=d.Ab.OI(v,s,this.no,l)).B())return v}else{var $=new d.l;v.yc($);var T=s.Le();if(($.G<T.G||$.H>T.H)&&($=d.l.construct($.v-1,T.G,$.C+1,T.H),(v=d.ti.Pu(v,$,s,NaN,0,l)).B()))return v}var A=NaN;_&&(A=s.Bi()),$=a.Yr()!=null,T=this.hH;var R=!isNaN(T);if(R&&(v=d.Zl.local().W(v,T,l)),this.WG)_&&d.Ab.wr(s,A,v,y),R&&(_=s.jh(),T*=(A=s.tc().jh())/_),d.Ab.vr(this.hf,v,M,y),R&&(_=s.tc().jh(),T*=(A=a.tc().jh())/_),s=v;else{var D=new d.Ua(v.description);D.yD(v),_&&(d.Ab.wr(s,A,D,y),R&&(_=s.jh(),T*=(A=s.tc().jh())/_)),d.Ab.vr(this.hf,D,M,y),R&&(_=s.tc().jh(),T*=(A=a.tc().jh())/_),M=NaN,f?M=a.Bi():isNaN(this.Dm)||(M=this.Dm),_=S.vv(s)|S.vv(a),A=10*u.Yd(0),this.Wv&&(_=3,A=0),s=d.Ab.QQ(v,s,D,u,M,l,_,A)}return $&&(s=d.Ab.SD(s,a,l)),f&&(s=d.Ab.Hz(s,a,this.Sm,l),R&&(s=d.Zl.local().W(s,T,l)),d.Ab.Kx(a,s,y)),s.B()||p!=null&&(s=p.al(s,!1),this.yp(p,d.dm.reverse,s),s=p.bl(s,!1)),s},S.prototype.$V=function(p,l){var s=(p.da()+p.S())/400;return s!=0?(s=d.Zl.local().W(p,s,l),s=this.QI(s,l),l=p.Ja(),s.dn(l)):(l=new d.Ta(p.Kp()),s=this.SI(l),l=p.Ja(),s.B()?l.Pa():(p.copyTo(l),p=s.D(),l.L(p.x,p.y,p.x,p.y))),l},S.prototype.aW=function(p,l){p=d.ba.kg(p);var s=this.hf.ef,a=this.hf.$f,u=s.Tb(),f=a.Tb(),y=d.P.Hu(Math.min(p.I(),64));if(u==3){var v=s.Li;u=(s=v.hk()).Tb(),p=v.al(p,!0),this.yp(v,d.dm.forward,p),p=v.bl(p,!0)}if(u==2){if(this.no==d.ui.Clip?p=d.Zj.local().W(p,s.ol(),s,l):s.Xc()&&(u=new d.l,p.yc(u),s.Le().contains(u)||(this.no==d.ui.PannableFold&&(p=d.Ab.nj(p,s)),d.Ab.Lt(p,s.Le(),s.Yd(0),!0),p=d.Ab.Hn(p,s,0,!0,0,l))),p.B())return p;d.Ab.wr(s,0,p,y)}else d.Ab.Lt(p,s.Le(),s.Yd(0),!0);return d.Ab.vr(this.hf,p,!1,y),s=0,u=!1,v=null,f==3&&(u=!0,f=(a=(v=a.Li).hk()).Tb()),(f=f==2)?s=a.Bi():isNaN(this.Dm)||(s=this.Dm),f&&this.Sm!=d.ui.Clip||(p=d.Ab.Hn(p,a.tc(),s,!1,0,l)),f&&(p=d.Ab.Hz(p,a,this.Sm,l),d.Ab.Kx(a,p,y),p.B())||u&&(p=v.al(p,!0),this.yp(v,d.dm.reverse,p),p=v.bl(p,!0)),p},S.prototype.yp=function(p,l,s){var a=s.I();if(a!=0){for(var u=s.vb(0),f=d.P.mg(200,0),y=[],v=0;v<a;){var _=Math.min(100,a-v);u.Xw(2*v,2*_,f,2,!0);for(var M=0;M<_;++M)y[M]=d.h.construct(f[2*v],f[2*v+1]);p.St(l,y,_),v+=_}s.Qc(1993)}},S.Py=function(p,l,s){if(p==null||l==null||!l.Xc())throw d.i.ga("Invalid Arguement");if(p.B())return p;var a=p.K();return a==197?(a=new d.Ea(p.description)).bd(p,!1):d.ba.zd(a)?(a=new d.Ua(p.description)).pc(p,!0):a=p,(a=d.Ab.nj(a,l)).B()?a:d.Ab.Hn(a,l,0,a!=p,0,s)},S.pj=function(p,l,s,a){if(p==null||l==null||!l.Xc())throw d.i.ga("Invalid Arguement");if(p.B())return p;var u=p.K();if(d.ba.Ic(u)){p=d.Ab.nj(p,l),u=new d.l,p.A(u);for(var f=d.ua.oy(l,u,!1),y=l.ih(),v=Math.floor((u.v-y.v)/y.S())*y.S()+y.v;v<u.C;)v>u.v+f&&v<u.C-f&&(p=d.Ab.pS(p,l,s,v)),v+=y.S()}else{if(u==197)return(u=new d.Ea(p.description)).bd(p,!1),S.pj(u,l,s,a);if(d.ba.zd(u))return(u=new d.Ua(p.description)).pc(p,!0),S.pj(u,l,s,a)}return S.Py(p,l,a)},S}();d.du=O}(Q||(Q={})),function(d){var O=function(S){function p(l,s,a,u){var f=S.call(this)||this;return l===void 0?f.description=d.fe.pg():a===void 0?f.description=l:(f.description=d.fe.pg(),f.UB(l,s),f.Sl(a,u)),f}return Pe(p,S),p.prototype.K=function(){return 322},p.prototype.Rb=function(){var l=this.ta-this.qa,s=this.oa-this.ma;return Math.sqrt(l*l+s*s)},p.prototype.Di=function(l){var s=this.ta-this.qa,a=this.oa-this.ma;return Math.sqrt(s*s+a*a)<=l},p.prototype.Rn=function(){return!1},p.prototype.lg=function(){var l=new d.h;return l.vc(this.xc(),this.bc()),l},p.YO=function(l,s){return new p(l.x,l.y,s.x,s.y)},p.prototype.dn=function(l){l.Pa(),l.Pf(this.description);var s=new d.l;this.A(s),l.Zo(s),s=1;for(var a=this.description.Ba;s<a;s++)for(var u=this.description.ld(s),f=d.sa.Wa(u);s<f;s++){var y=this.Vg(u,0);l.setInterval(u,0,y)}},p.prototype.A=function(l){l.L(this.ta,this.oa,this.qa,this.ma),l.normalize()},p.prototype.So=function(l){l.Pa(),l.$b(this.ta,this.oa,this.Pd(0,1,0)),l.$b(this.qa,this.ma,this.Pd(1,1,0))},p.prototype.Pc=function(l){if(l instanceof d.Ed){this.wc();var s=new d.h;s.x=this.ta,s.y=this.oa,l.Gh(s,s),this.ta=s.x,this.oa=s.y,s.x=this.qa,s.y=this.ma,l.Gh(s,s),this.qa=s.x,this.ma=s.y}else this.wc(),(s=new d.Od).x=this.ta,s.y=this.oa,s.z=this.Pd(0,1,0),s=l.hp(s),this.ta=s.x,this.oa=s.y,this.vn(0,1,0,s.z),s.x=this.qa,s.y=this.ma,s.z=this.Pd(1,1,0),s=l.hp(s),this.qa=s.x,this.ma=s.y,this.vn(1,1,0,s.z)},p.prototype.Ja=function(){return new p(this.description)},p.prototype.Sx=function(l,s){return(this.qa-l-(this.ta-l))*(this.ma-s+(this.oa-s))*.5},p.prototype.ux=function(l){return l*this.Rb()},p.prototype.IG=function(l){return l/this.Rb()},p.prototype.yF=function(l){return d.mc.jq(this.ta,this.qa,l)},p.prototype.aR=function(l){return d.mc.jq(this.oa,this.ma,l)},p.prototype.fl=function(l,s){var a=new d.jg;return this.dh(l,s,a),a.get()},p.prototype.dh=function(l,s,a){if(a==null)throw d.i.O();a.Qr(),(a=a.get()).Pf(this.description);var u=new d.h;this.ic(l,u),a.UB(u.x,u.y),this.ic(s,u),a.Sl(u.x,u.y),u=1;for(var f=this.description.Ba;u<f;u++)for(var y=this.description.Fd(u),v=d.sa.Wa(y),_=0;_<v;_++){var M=this.Vc(l,y,_);a.TB(y,_,M),M=this.Vc(s,y,_),a.JB(y,_,M)}},p.prototype.Vc=function(l,s,a){if(s==0)return a==0?this.ic(l).x:this.ic(l).y;switch(d.sa.gz(s)){case 0:return .5>l?this.yv(s,a):this.jv(s,a);case 1:var u=this.yv(s,a);return s=this.jv(s,a),d.mc.jq(u,s,l);case 2:throw d.i.ga("not implemented")}throw d.i.Ra()},p.prototype.ge=function(l,s){var a=this.qa-this.ta,u=this.ma-this.oa,f=a*a+u*u;return f==0?.5:(l=((l.x-this.ta)*a+(l.y-this.oa)*u)/f,s||(0>l?l=0:1<l&&(l=1)),l)},p.prototype.fq=function(l,s,a,u){if(l){if((l=this.ma-this.oa)==0)return s==this.ma?-1:0;if(0>(s=(s-this.oa)/l)||1<s)return 0;a!=null&&(a[0]=this.yF(s))}else{if((l=this.qa-this.ta)==0)return s==this.qa?-1:0;if(0>(s=(s-this.ta)/l)||1<s)return 0;a!=null&&(a[0]=this.aR(s))}return u!=null&&(u[0]=s),1},p.prototype.Me=function(l,s){var a=this.ma-this.oa;return a==0?l==this.ma?s:NaN:(l=(l-this.oa)/a,s=this.yF(l),l==1&&(s=this.qa),s)},p.prototype.tu=function(l,s,a){return 0<=this.tp(l.x,l.y,s,a)},p.prototype.xi=function(l,s,a){return 0<=this.tp(l,s,a,!0)},p.prototype.ss=function(l,s){return this.tu(l,s,!1)},p.prototype.mI=function(){if(this.ma<this.oa||this.ma==this.oa&&this.qa<this.ta){var l=this.ta;this.ta=this.qa,this.qa=l,l=this.oa,this.oa=this.ma,this.ma=l,l=0;for(var s=this.description.Qq-2;l<s;l++){var a=this.la[l];this.la[l]=this.la[l+s],this.la[l+s]=a}}},p.prototype.wu=function(l,s){(s=d.h.construct(l,s)).sub(this.bc());var a=new d.h;return a.vc(this.xc(),this.bc()),(l=a.yi(s))>(s=8881784197001252e-31*(Math.abs(a.x*s.y)+Math.abs(a.y*s.x)))?-1:l<-s?1:0},p.prototype.tp=function(l,s,a,u){var f=this.ta,y=this.oa,v=l-f,_=s-y;if((v=Math.sqrt(v*v+_*_))<=Math.max(a,6661338147750939e-31*v))return u&&v==0?NaN:0;if(v=l-this.qa,_=s-this.ma,(v=Math.sqrt(v*v+_*_))<=Math.max(a,6661338147750939e-31*v))return u&&v==0?NaN:1;if(v=this.qa-this.ta,_=this.ma-this.oa,0<(u=Math.sqrt(v*v+_*_))){var M=1/u,$=l-f,T=s-y,A=$*(v*=M)+T*(_*=M),R=17763568394002505e-31*(Math.abs($*v)+Math.abs(T*_)),D=v;if(v=-_,_=D,A<-(R=Math.max(a,R))||A>u+R)return NaN;if(Math.abs($*v+T*_)<=Math.max(a,17763568394002505e-31*(Math.abs($*v)+Math.abs(T*_)))&&(.5>=(v=d.P.Tk(A*M,0,1))?(_=this.ta+(this.qa-this.ta)*v,u=this.oa+(this.ma-this.oa)*v):(_=this.qa-(this.qa-this.ta)*(1-v),u=this.ma-(this.ma-this.oa)*(1-v)),d.h.Jy(_,u,l,s)<=a)){if(.5>v){if(d.h.Jy(_,u,f,y)<=a)return 0}else if(d.h.Jy(_,u,this.qa,this.ma)<=a)return 1;return v}}return NaN},p.prototype.Nb=function(l){return l!=null&&(l==this||l.constructor===this.constructor&&this.AM(l))},p.prototype.mD=function(l,s,a){var u=a?this.ta:this.qa;a=a?this.oa:this.ma;var f=new d.h;return f.x=l.qa-u,f.y=l.ma-a,!(s.Sh(f)>6661338147750939e-31*s.aD(f))||(f.x=l.ta-u,f.y=l.oa-a,s.Sh(f)<=6661338147750939e-31*s.aD(f))},p.prototype.lD=function(l){var s=new d.h;return s.x=this.qa-this.ta,s.y=this.ma-this.oa,!!this.mD(l,s,!1)&&(s.Uq(),!!this.mD(l,s,!0))},p.IM=function(l,s){var a=l.wu(s.ta,s.oa),u=l.wu(s.qa,s.ma);return!(0>a&&0>u||0<a&&0<u)&&(a=s.wu(l.ta,l.oa),u=s.wu(l.qa,l.ma),!(0>a&&0>u||0<a&&0<u)&&((a=l.Rb())>(u=s.Rb())?l.lD(s):s.lD(l)))},p.GM=function(l,s,a){var u=d.h.construct(NaN,NaN),f=l.qa-l.ta,y=l.ma-l.oa,v=s.qa-s.ta,_=s.ma-s.oa,M=v*y-f*_;if(M==0)return u;var $=8881784197001252e-31*(Math.abs(v*y)+Math.abs(f*_)),T=s.ta-l.ta,A=s.oa-l.oa,R=v*A-T*_,D=R/M,V=Math.abs(M);return D<-(v=(8881784197001252e-31*(Math.abs(v*A)+Math.abs(T*_))*V+$*Math.abs(R))/(M*M)+2220446049250313e-31*Math.abs(D))||D>1+v||(v=(_=f*A-T*y)/M)<-(f=(8881784197001252e-31*(Math.abs(f*A)+Math.abs(T*y))*V+$*Math.abs(_))/(M*M)+2220446049250313e-31*Math.abs(v))||v>1+f||(D=d.P.Tk(D,0,1),f=d.P.Tk(v,0,1),y=l.ic(D),M=s.ic(f),($=new d.h).vc(y,M),$.length()>a&&($.add(y,M),$.scale(.5),D=l.ge($,!1),f=s.ge($,!1),l=l.ic(D),s=s.ic(f),l.sub(s),l.length()>a)||u.na(D,f)),u},p.JM=function(l,s,a,u){var f=0;if((l.ta==s.ta&&l.oa==s.oa||l.ta==s.qa&&l.oa==s.ma)&&(f++,!u))return 1;if(l.qa==s.ta&&l.ma==s.oa||l.qa==s.qa&&l.ma==s.ma){if(++f==2)return 2;if(!u)return 1}return s.xi(l.ta,l.oa,a)||s.xi(l.qa,l.ma,a)||l.xi(s.ta,s.oa,a)||l.xi(s.qa,s.ma,a)?1:u&&f!=0||p.IM(l,s)==0?0:1},p.Yx=function(l,s,a,u,f,y){var v=0,_=l.tp(s.ta,s.oa,y,!1),M=l.tp(s.qa,s.ma,y,!1),$=s.tp(l.ta,l.oa,y,!1),T=s.tp(l.qa,l.ma,y,!1);return isNaN(_)||(u!=null&&(u[v]=_),f!=null&&(f[v]=0),a!=null&&(a[v]=d.h.construct(s.ta,s.oa)),v++),isNaN(M)||(u!=null&&(u[v]=M),f!=null&&(f[v]=1),a!=null&&(a[v]=d.h.construct(s.qa,s.ma)),v++),v==2||isNaN($)||_==0&&$==0||M==0&&$==1||(u!=null&&(u[v]=0),f!=null&&(f[v]=$),a!=null&&(a[v]=d.h.construct(l.ta,l.oa)),v++),v==2||isNaN(T)||_==1&&T==0||M==1&&T==1||(u!=null&&(u[v]=1),f!=null&&(f[v]=T),a!=null&&(a[v]=d.h.construct(s.qa,s.ma)),v++),0<v?(v==2&&u!=null&&u[0]>u[1]&&(l=u[0],u[0]=u[1],u[1]=l,f!=null&&(u=f[0],f[0]=f[1],f[1]=u),a!=null&&(f=d.h.construct(a[0].x,a[0].y),a[0]=a[1],a[1]=f)),v):(v=p.GM(l,s,y),isNaN(v.x)?0:(a!=null&&(a[0]=l.ic(v.x)),u!=null&&(u[0]=v.x),f!=null&&(f[0]=v.y),1))},p.prototype.$F=function(){return 0},p.prototype.qp=function(){},p.prototype.toString=function(){return"Line: ["+this.ta.toString()+", "+this.oa.toString()+", "+this.qa.toString()+", "+this.ma.toString()+"]"},p}(d.NC);d.zb=O}(Q||(Q={})),function(d){var O=function(){function S(){this.Lm=[],this.za=-1}return S.prototype.Ma=function(){return this.za},S.prototype.next=function(){if(this.Lm!=null&&this.Lm.length!=0){this.za++;var p=this.Lm[0];return this.Lm=1>=this.Lm.length?[]:this.Lm.slice(1),p}return this.Lm=null},S.prototype.VX=function(p){this.Lm.push(p)},S.prototype.re=function(){},S}();d.bL=O}(Q||(Q={})),function(d){var O;(O=d.NL||(d.NL={}))[O.enumFillRuleOddEven=0]="enumFillRuleOddEven",O[O.enumFillRuleWinding=1]="enumFillRuleWinding";var S=function(p){function l(s,a){var u=p.call(this)||this;if(u.yf=!1,u.Gq=null,u.uq=0,u.tq=0,u.Cj=null,u.Og=!1,u.nb=null,u.mb=null,u.Se=null,u.Nj=null,u.Td=null,u.vq=0,u.gb=0,u.zq=0,a===void 0)u.yf=s,u.Og=!1,u.vq=0,u.uq=0,u.tq=0,u.xa=0,u.description=d.fe.pg();else{if(a==null)throw d.i.O();u.yf=s,u.Og=!1,u.vq=0,u.uq=0,u.tq=0,u.xa=0,u.description=a}return u.Cj=null,u.gb=0,u}return Pe(l,p),l.prototype.vm=function(){return 0<this.vq},l.prototype.Xx=function(){this.wc(),this.Gq==null?this.Gq=new d.Ta(this.description):this.Gq.Pf(this.description)},l.prototype.rx=function(s,a){var u=new d.h;u.x=s,u.y=a,this.Nt(u)},l.prototype.Nt=function(s){this.Xx(),this.Gq.Db(s),this.Og=!0},l.prototype.nf=function(s){if(s.B())throw d.i.O();this.Ll(s.description),this.Xx(),s.copyTo(this.Gq),this.Og=!0},l.prototype.Rx=function(){var s=1;this.Og&&(this.Xx(),this.nb==null?(this.nb=d.Zc.Qh(2),this.nb.write(0,0),this.mb=d.Zc.Or(2,0)):(this.nb.resize(this.nb.size+1,0),this.mb.resize(this.mb.size+1,0)),this.yf&&this.mb.write(this.mb.size-2,1),s++);var a=this.xa;this.nb.write(this.nb.size-1,this.xa+s),this.fm(a+s),this.mb.write(this.nb.size-1,0),this.Og&&(this.It(a,this.Gq),this.Og=!1)},l.prototype.Aj=function(s,a){this.Rx(),this.Db(this.xa-1,s,a)},l.prototype.Ei=function(s){this.Rx(),this.Db(this.xa-1,s)},l.prototype.lineTo=function(s){this.Rx(),this.It(this.xa-1,s)},l.prototype.xU=function(s){if(this.wc(),this.yf)throw d.i.Ra();var a=this.ea();if(s>a)throw d.i.Ra();if(this.ec(s)){if(this.mb==null)throw d.i.Ra();var u=this.xa,f=this.Ca(s),y=this.Wc(s);this.fm(this.xa+1),this.oc();for(var v=0,_=this.description.Ba;v<_;v++)if(this.Aa[v]!=null){var M=d.sa.Wa(this.description.Fd(v));this.Aa[v].On(M*y,this.Aa[v],M*f,M,!0,1,M*u)}for(;a>s;a--)u=this.nb.read(a),this.nb.write(a,u+1);this.mb.FE(s,1)}},l.prototype.Cp=function(){if(this.vx(),s===void 0){this.Og=!1;var s=this.ea()-1}var a=this.mb.read(s);this.mb.write(s,1|a),this.Se!=null&&(s=this.Wc(s)-1,this.Se.write(s,1),this.Nj.write(s,-1))},l.prototype.ec=function(s){return(1&this.mb.read(s))!=0},l.prototype.Pn=function(s){if(this.ec(s))return!0;var a=this.Ca(s);return!(a>(s=this.Wc(s)-1))&&(a=this.Oa(a),s=this.Oa(s),a.rb(s))},l.prototype.Av=function(s){return(2&this.mb.read(s))!=0},l.prototype.pc=function(s,a){if(this.Ll(s.description),s.K()!=322)throw d.i.Ra();var u=new d.Ta;(a||this.B())&&(s.Vo(u),this.nf(u)),s.Ro(u),this.lineTo(u)},l.prototype.vp=function(s){var a=this.xa==0;this.rx(s.v,s.G),this.Aj(s.v,s.H),this.Aj(s.C,s.H),this.Aj(s.C,s.G),this.Cp(),this.Og=!1,a&&this.Nf(256,!1)},l.prototype.bd=function(s,a){if(!s.B()){for(var u=this.xa==0,f=new d.Ta(this.description),y=0;4>y;y++)s.If(a?4-y-1:y,f),y==0?this.nf(f):this.lineTo(f);this.Cp(),this.Og=!1,u&&!a&&this.Nf(256,!1)}},l.prototype.add=function(s,a){for(var u=0;u<s.ea();u++)this.addPath(s,u,!a)},l.prototype.addPath=function(s,a,u){this.wf(-1,s,a,u)},l.prototype.$k=function(s,a){this.Cz(s,a)},l.prototype.Fr=function(s,a,u,f,y){if(y||this.ea()!=0||(y=!0),0>a&&(a=s.ea()-1),a>=s.ea()||0>u||0>f||f>s.tv(a))throw d.i.ga("index out of bounds");if(f!=0){var v=s.ec(a)&&u+f==s.tv(a);if(!v||f!=1){if(this.Og=!1,this.Ll(s.description),u=s.Ca(a)+u+1,y&&(f++,u--),v&&f--,v=this.xa,this.fm(this.xa+f),this.oc(),y){if(f==0)return;this.nb.add(this.xa),y=s.mb.read(a),y&=-5,this.yf&&(y|=1),this.mb.write(this.mb.size-1,y),this.mb.add(0)}else this.nb.write(this.mb.size-1,this.xa);y=0;for(var _=this.description.Ba;y<_;y++){var M=this.description.ld(y),$=d.sa.Wa(M),T=s.description.Rf(M);0>T||s.Aa[T]==null?this.Aa[y].Nn($*v,d.sa.te(M),f*$,$*v):this.Aa[y].On($*v,s.Aa[T],$*u,f*$,!0,$,$*v)}if(this.vm()||s.Av(a))throw d.i.Ra();this.Qc(1993)}}},l.prototype.jJ=function(){for(var s=0,a=this.ea();s<a;s++)this.zW(s)},l.prototype.zW=function(s){if(this.oc(),s>=this.ea())throw d.i.O();var a=this.Ca(s),u=this.Ka(s);s=this.ec(s)?1:0;for(var f=0,y=this.description.Ba;f<y;f++)if(this.Aa[f]!=null){var v=d.sa.Wa(this.description.Fd(f));this.Aa[f].pi(v*(a+s),v*(u-s),v)}this.Qc(1993)},l.prototype.ar=function(s){this.oc();var a=this.ea();if(0>s&&(s=a-1),s>=a)throw d.i.O();for(var u=this.Ca(s),f=this.Ka(s),y=0,v=this.description.Ba;y<v;y++)if(this.Aa[y]!=null){var _=d.sa.Wa(this.description.Fd(y));this.Aa[y].Gn(_*u,_*f,_*this.xa)}for(u=s+1;u<=a;u++)y=this.nb.read(u),this.nb.write(u-1,y-f);if(this.mb==null)for(u=s+1;u<=a;u++)s=this.mb.read(u),this.mb.write(u-1,s);this.nb.resize(a),this.mb.resize(a),this.xa-=f,this.Rg-=f,this.Qc(1993)},l.prototype.wf=function(s,a,u,f){if(a==this||u>=a.ea())throw d.i.O();var y=this.ea();if(s>y)throw d.i.O();0>s&&(s=y),0>u&&(u=a.ea()-1),this.Og=!1,this.Ll(a.description),a.oc();var v=a.Ca(u),_=a.Ka(u),M=this.xa,$=a.ec(u)&&!f?1:0;this.fm(this.xa+_),this.oc();for(var T=s<y?this.Ca(s):M,A=0,R=this.description.Ba;A<R;A++){var D=this.description.Fd(A),V=a.description.Rf(D),Z=d.sa.Wa(D);0<=V&&a.Aa[V]!=null?($!=0&&this.Aa[A].On(T*Z,a.Aa[V],Z*v,Z,!0,Z,Z*M),this.Aa[A].On((T+$)*Z,a.Aa[V],Z*(v+$),Z*(_-$),f,Z,Z*(M+$))):this.Aa[A].Nn(T*Z,d.sa.te(D),Z*_,Z*M)}for(this.nb.add(M+_),f=y;f>=s+1;f--)v=this.nb.read(f-1),this.nb.write(f,v+_);for(a.Av(u),this.mb.add(0),f=y-1;f>=s+1;f--)y=this.mb.read(f),y&=-5,this.mb.write(f+1,y);y=a.ER().read(u),y&=-5,this.yf&&(y|=1),this.mb.write(s,y)},l.prototype.Cz=function(s,a){var u=-1,f=this.ea();if(u>f)throw d.i.O();0>u&&(u=f),this.Og=!1;var y=this.xa;this.fm(this.xa+a),this.oc();var v=u<f?this.Ca(u):y;if(s!=null)this.Aa[0].Dz(2*v,s,0,a,!0,2*y);else{var _=d.sa.te(0);this.Aa[0].Nn(2*v,_,2*a,2*y)}s=1;for(var M=this.description.Ba;s<M;s++){_=this.description.ld(s);var $=d.sa.Wa(_);_=d.sa.te(_),this.Aa[s].Nn(v*$,_,$*a,$*y)}for(this.nb.add(this.xa),y=f;y>=u+1;y--)v=this.nb.read(y-1),this.nb.write(y,v+a);for(this.mb.add(0),y=f-1;y>=u+1;y--)a=this.mb.read(y),a&=-5,this.mb.write(y+1,a);this.yf&&this.mb.write(u,1)},l.prototype.lG=function(s,a,u){var f=-1;if(0>s&&(s=this.ea()),s>this.ea()||f>this.Ka(s)||u>a.length)throw d.i.ga("index out of bounds");if(u!=0){s==this.ea()&&(this.nb.add(this.xa),this.yf?this.mb.add(1):this.mb.add(0)),0>f&&(f=this.Ka(s)),this.oc();var y=this.xa;this.fm(this.xa+u),this.oc();for(var v=0,_=this.description.Ba;v<_;v++){var M=this.description.Fd(v),$=d.sa.Wa(M);this.Aa[v].Wt($*(this.Ca(s)+f+u),(y-this.Ca(s)-f)*$,this.Aa[v],$*(this.Ca(s)+f),!0,$),v==0?this.Aa[v].qC($*(this.Ca(s)+f),u,a,0,!0):this.Aa[v].Yj(d.sa.te(M),(this.Ca(s)+f)*$,u*$)}for(this.vm()&&(this.Se.Wt(this.Ca(s)+f+u,y-this.Ca(s)-f,this.Se,this.Ca(s)+f,!0,1),this.Nj.Wt(this.Ca(s)+f+u,y-this.Ca(s)-f,this.Nj,this.Ca(s)+f,!0,1),this.Se.Yj(1,this.Ca(s)+f,u),this.Nj.Yj(-1,this.Ca(s)+f,u)),s+=1,a=this.ea();s<=a;s++)this.nb.write(s,this.nb.read(s)+u)}},l.prototype.xf=function(s,a,u){var f=this.ea();if(0>s&&(s=this.ea()),s>=f||a>this.Ka(s))throw d.i.ga("index out of bounds");s==this.ea()&&(this.nb.add(this.xa),this.yf?this.mb.add(1):this.mb.add(0)),0>a&&(a=this.Ka(s));var y=this.xa;this.fm(this.xa+1),this.oc();var v=this.Ca(s);this.Aa[0].xj(2*(v+a),u,2*y),u=1;for(var _=this.description.Ba;u<_;u++){var M=this.description.Fd(u),$=d.sa.Wa(M);this.Aa[u].Nn($*(v+a),d.sa.te(M),$,$*y)}for(s+=1;s<=f;s++)this.nb.write(s,this.nb.read(s)+1)},l.prototype.yB=function(s,a){var u=this.ea();if(0>s&&(s=u-1),s>=u||a>=this.Ka(s))throw d.i.ga("index out of bounds");this.oc();var f=this.Ca(s);0>a&&(a=this.Ka(s)-1),a=f+a,f=0;for(var y=this.description.Ba;f<y;f++)if(this.Aa[f]!=null){var v=d.sa.Wa(this.description.Fd(f));this.Aa[f].Gn(v*a,v,v*this.xa)}for(;u>=s+1;u--)a=this.nb.read(u),this.nb.write(u,a-1);this.xa--,this.Rg--,this.Qc(1993)},l.prototype.pE=function(s,a,u,f){if(s=this.Ca(s)+a,(u=this.Ca(u)+f)<s||0>s||u>this.I()-1)throw d.i.O();a=0,(f=this.Ha()).Wb(s);do{for(;f.Ia()&&(s=f.ia(),f.xb()!=u);)a+=s=s.Rb();if(f.xb()==u)break}while(f.ab());return a},l.prototype.aO=function(s,a,u){if(a=this.Ca(s)+a,u=this.Ca(s)+u,0>a||u>this.I()-1)throw d.i.O();var f=this.Ha();if(a>u){if(!this.ec(s))throw d.i.O("cannot iterate across an open path");f.EB()}var y=s=0;f.Wb(a);do y+=s,s=f.ia().Rb();while(f.xb()!=u);return y},l.prototype.ng=function(){return d.si.im(this,null)},l.prototype.FS=function(s,a,u){for(var f=s;f<u-1;f++)if(this.ec(f))throw d.i.O("cannot interpolate across closed paths");if((f=this.description.Ba)!=1){var y=this.pE(s,a,u,void 0);if(y!=0)for(var v=1;v<f;v++){var _=this.description.ld(v);if(d.sa.gz(_)!=2)for(var M=d.sa.Wa(_),$=0;$<M;$++)this.HS(_,s,a,u,y,$)}}},l.prototype.ES=function(s,a,u){var f=this.description.Ba;if(f!=1){var y=this.aO(s,a,u);if(y!=0)for(var v=1;v<f;v++){var _=this.description.ld(v);if(d.sa.gz(_)!=2)for(var M=d.sa.Wa(_),$=0;$<M;$++)this.GS(_,s,a,u,y,$)}}},l.prototype.HS=function(s,a,u,f,y,v){var _=this.Ha(),M=this.Ca(a)+u;f=this.Ca(f)+void 0,a=this.Vc(s,M,v),u=this.Vc(s,f,v);var $=a,T=0;_.Wb(M);do if(_.Ia()){if(_.ia(),_.xb()==f)break;this.setAttribute(s,_.xb(),v,$),_.ni();do{if(M=_.ia(),_.kk()==f)return;T+=M=M.Rb(),$=d.mc.jq(a,u,T/y),_.Qn()||this.setAttribute(s,_.kk(),v,$)}while(_.Ia())}while(_.ab())},l.prototype.GS=function(s,a,u,f,y,v){var _=this.Ha(),M=this.Ca(a)+u;if((a=this.Ca(a)+f)!=M){f=this.Vc(s,M,v),u=this.Vc(s,a,v);var $=0;_.Wb(M),_.EB(),M=f;do{var T=_.ia();this.setAttribute(s,_.xb(),v,M),$+=M=T.Rb(),M=d.mc.jq(f,u,$/y)}while(_.kk()!=a)}},l.prototype.Pa=function(){this.vq=0,this.Og=!1,this.Td=this.Se=this.Nj=this.mb=this.nb=null,this.rD()},l.prototype.Pc=function(s){s instanceof d.Ed?this.TD(s,-1):this.rN(s)},l.prototype.TD=function(s,a){if(!this.B()&&!s.isIdentity()){this.oc();var u=this.Aa[0],f=new d.h,y=new d.h;if(0>a){var v=this.vm(),_=0;a=this.xa}else v=this.Av(a),_=this.Ca(a),a=this.Wc(a);for(;_<a;_++){if(f.x=u.read(2*_),f.y=u.read(2*_+1),v){var M=this.Nj.read(_);if(0<=M)switch(7&this.Se.read(_)){case 2:y.x=this.Td.read(M),y.y=this.Td.read(M+1),s.Gh(y,y),this.Td.write(M,y.x),this.Td.write(M+1,y.y),y.x=this.Td.read(M+3),y.y=this.Td.read(M+4),s.Gh(y,y),this.Td.write(M+3,y.x),this.Td.write(M+4,y.y);break;case 4:throw d.i.Ra()}}s.Gh(f,f),u.write(2*_,f.x),u.write(2*_+1,f.y)}this.Qc(1993)}},l.prototype.rN=function(s){if(!this.B()){this.se(1),this.oc();for(var a=this.Aa[0],u=this.Aa[1],f=new d.Od,y=new d.Od,v=this.vm(),_=0;_<this.xa;_++){if(f.x=a.read(2*_),f.y=a.read(2*_+1),f.z=u.read(_),v){var M=this.Nj.read(_);if(0<=M)switch(7&this.Se.read(_)){case 2:y.x=this.Td.read(M),y.y=this.Td.read(M+1),y.z=this.Td.read(M+2),y=s.hp(y),this.Td.write(M,y.x),this.Td.write(M+1,y.y),this.Td.write(M+1,y.z),y.x=this.Td.read(M+3),y.y=this.Td.read(M+4),y.z=this.Td.read(M+5),y=s.hp(y),this.Td.write(M+3,y.x),this.Td.write(M+4,y.y),this.Td.write(M+5,y.z);break;case 4:throw d.i.Ra()}}f=s.hp(f),a.write(2*_,f.x),a.write(2*_+1,f.y),u.write(_,f.z)}this.Qc(1993)}},l.prototype.ey=function(){this.nb==null&&(this.nb=d.Zc.Qh(1,0),this.mb=d.Zc.Or(1,0)),this.Se!=null&&(this.Se.resize(this.Rg,1),this.Nj.resize(this.Rg,-1))},l.prototype.qp=function(s){s.Og=!1,s.vq=this.vq,s.zq=this.zq,s.nb=this.nb!=null?d.ja.Dn(this.nb):null,s.mb=this.mb!=null?d.rn.Dn(this.mb):null,s.Nj=this.Nj!=null?d.ja.Dn(this.Nj):null,s.Se=this.Se!=null?d.rn.Dn(this.Se):null,s.Td=this.Td!=null?d.ce.Dn(this.Td):null,s.uq=this.uq,s.tq=this.tq,s.Cj=this.ck(1024)?null:this.Cj},l.prototype.Rb=function(){if(!this.ck(512))return this.uq;for(var s=this.Ha(),a=new d.Ex(0);s.ab();)for(;s.Ia();)a.add(s.ia().Rb());return this.uq=a.tm(),this.Nf(512,!1),a.tm()},l.prototype.Nb=function(s){if(s==this)return!0;if(!(s instanceof l&&p.prototype.Nb.call(this,s)))return!1;var a=this.ea();return!(a!=s.ea()||this.nb!=null&&!this.nb.Nb(s.nb,0,a+1)||this.zq!=s.zq||this.mb!=null&&!this.mb.Nb(s.mb,0,a))&&p.prototype.Nb.call(this,s)},l.prototype.Ha=function(){return new d.TL(this)},l.prototype.dy=function(s){if(p.prototype.dy.call(this,s),this.vm())for(s=this.Ha();s.ab();)s.Ia()},l.prototype.Ap=function(s,a){if(p.prototype.Ap.call(this,s,a),this.vm())for(s=this.Ha();s.ab();)s.Ia()},l.prototype.Zx=function(){this.xa=this.nb==null||this.nb.size==0?0:this.nb.read(this.nb.size-1)},l.prototype.He=function(){return this.yf?(this.zu(),this.tq):0},l.prototype.Gv=function(s){return!!this.yf&&(this.ck(8)?(this.zu(),0<this.Cj.read(s)):(4&this.mb.read(s))!=0)},l.prototype.Kr=function(s){return this.yf?(this.zu(),this.Cj.read(s)):0},l.prototype.zu=function(){if(this.ck(1024)){var s=this.ea();this.Cj==null?this.Cj=new d.ce(s):this.Cj.size!=s&&this.Cj.resize(s),s=new d.Ex(0);for(var a=new d.Ex(0),u=new d.h,f=0,y=this.Ha();y.ab();){for(a.reset(),this.D(this.Ca(y.gb),u);y.Ia();)a.add(y.ia().Sx(u.x,u.y));s.add(a.tm());var v=f++;this.Cj.write(v,a.tm())}this.tq=s.tm(),this.Nf(1024,!1)}},l.prototype.AR=function(){if(this.yf){this.hm();for(var s=this.ea(),a=0;a<s;a++)4&this.mb.read(a)}},l.prototype.hm=function(){if(this.ck(8)){this.zu();var s=this.ea();(this.mb==null||this.mb.size<s)&&(this.mb=d.Zc.Or(s+1));for(var a=1,u=0;u<s;u++){var f=this.Cj.read(u);u==0&&(a=0<f?1:-1),0<f*a?this.mb.uJ(u,4):this.mb.FE(u,4)}this.Nf(8,!1)}},l.prototype.nz=function(s){var a=this.gb,u=this.ea();if(0<=a&&a<u){if(s<this.Wc(a)){if(s>=this.Ca(a))return a;a--}else a++;if(0<=a&&a<u&&s>=this.Ca(a)&&s<this.Wc(a))return this.gb=a}if(5>u){for(a=0;a<u;a++)if(s<this.Wc(a))return this.gb=a;throw d.i.ga("corrupted geometry")}for(a=0,--u;u>a;){var f=a+(u-a>>1);if(s<this.Ca(f))u=f-1;else{if(!(s>=(a=this.Wc(f))))return this.gb=f;a=f+1}}return this.gb=a},l.prototype.sz=function(){var s=this.I();if(!this.yf){s-=this.ea();for(var a=0,u=this.ea();a<u;a++)this.ec(a)&&s++}return s},l.prototype.tv=function(s){var a=this.Ka(s);return this.ec(s)||a--,a},l.prototype.Ja=function(){return new l(this.yf,this.description)},l.prototype.Eb=function(){return this.yf?2:1},l.prototype.K=function(){return this.yf?1736:1607},l.prototype.LJ=function(s){this.nb=s,this.Qc(16777215)},l.prototype.QR=function(){return this.vx(),this.Se},l.prototype.ER=function(){return this.vx(),this.mb},l.prototype.KJ=function(s){this.mb=s,this.Qc(16777215)},l.prototype.ea=function(){return this.nb!=null?this.nb.size-1:0},l.prototype.Wc=function(s){return this.nb.read(s+1)},l.prototype.Ka=function(s){return this.nb.read(s+1)-this.nb.read(s)},l.prototype.Ca=function(s){return this.nb.read(s)},l.prototype.nu=function(s,a){this.Cb==null&&(this.Cb=new d.Wk),a=d.Mx.kW(a);var u=this.Cb.Hk;if(u!=null){if(!(u.Kk<s||a>u.MR()))return!0;this.Cb.tD(null)}return u=d.Mx.create(this,s,a),this.Cb.tD(u),!0},l.prototype.dc=function(){var s=p.prototype.dc.call(this);if(!this.Bc()){var a=this.ea();this.nb!=null&&this.nb.Cn(s,0,a+1),this.mb!=null&&this.mb.Cn(s,0,a)}return s},l.prototype.UF=function(s){return this.Se!=null?this.Se.read(s):1},l.prototype.cc=function(s,a,u){var f=this.nz(s);if(s==this.Wc(f)-1&&!this.ec(f))throw d.i.ga("index out of bounds");this.oc();var y=this.Se,v=1;if(y!=null&&(v=7&y.read(s)),v!==1)throw d.i.Ra();if(a.Qr(),a=a.get(),u?a.Pf(d.fe.pg()):a.Pf(this.description),f=s==this.Wc(f)-1&&this.ec(f)?this.Ca(f):s+1,y=new d.h,this.D(s,y),a.Ec(y),this.D(f,y),a.Rc(y),!u)for(u=1,y=this.description.Ba;u<y;u++){v=this.description.Fd(u);for(var _=d.sa.Wa(v),M=0;M<_;M++){var $=this.Vc(v,s,M);a.TB(v,M,$),$=this.Vc(v,f,M),a.JB(v,M,$)}}},l.prototype.Tj=function(s,a){if(s>=this.ea())throw d.i.O();if(this.B())a.Pa();else{if(this.Av(s))throw d.i.ga("not implemented");var u=this.vb(0),f=new d.h,y=new d.l;y.Pa();var v=this.Ca(s);for(s=this.Wc(s);v<s;v++)u.uc(2*v,f),y.$b(f);a.L(y)}},l.prototype.hj=function(s){return this.Cb==null&&(this.Cb=new d.Wk),!(s==0||16>this.I())&&(s=d.ua.iE(this),this.Cb.RM(s),!0)},l.prototype.cM=function(){if(this.Cb==null&&(this.Cb=new d.Wk),this.Cb.Bo==null){this.Cb.sD(null);var s=d.ua.TN(this);this.Cb.sD(s)}},l.prototype.$o=function(s){this.zq=s},l.prototype.Kn=function(){return this.zq},l.prototype.yD=function(s){if(this==s)throw d.i.ga("MultiPathImpl.add");for(var a=this.ea(),u=0;u<s.ea();u++)this.addPath(s,u,!0),this.xU(a),a++},l.prototype.fO=function(s){var a=this.nz(s),u=this.Ca(a);if(u!=s){if(s>=(a=this.Wc(a))||s<u)throw d.i.ga("change_ring_start_point");for(var f=0,y=this.description.Ba;f<y;f++){var v=this.description.ld(f);v=d.sa.Wa(v),this.Aa[f].rotate(u*v,s*v,a*v)}}},l}(d.Fx);d.Xk=S}(Q||(Q={})),function(d){var O=function(S){function p(l){var s=S.call(this)||this;if(l!==void 0){if(l==null)throw d.i.O();s.description=l}else s.description=d.fe.pg();return s.xa=0,s}return Pe(p,S),p.prototype.Ja=function(){return new p(this.description)},p.prototype.add=function(l){this.resize(this.xa+1),this.Fh(this.xa-1,l)},p.prototype.Du=function(l,s){this.resize(this.xa+1);var a=new d.h;a.na(l,s),this.Db(this.xa-1,a)},p.prototype.Gd=function(l,s,a){if(a=0>a?l.I():a,0>s||s>l.I()||a<s)throw d.i.O();if(s!=a){this.Ll(l.description),a-=s;var u=this.xa;this.resize(this.xa+a),this.oc();for(var f=0,y=l.description.Ba;f<y;f++){var v=l.description.Fd(f),_=d.sa.Wa(v),M=this.vb(v);v=l.vb(v),M.On(u*_,v,s*_,a*_,!0,1,u*_)}}},p.prototype.CD=function(l,s){var a=l.length;if(s=0>s?a:s,0>a||0>s)throw d.i.O();if(s!=0){a=s-0,s=this.xa,this.resize(this.xa+a);for(var u=0;u<a;u++)this.Db(s+u,l[0+u])}},p.prototype.yB=function(l){if(0>l||l>=this.I())throw d.i.ga("index out of bounds");this.oc();for(var s=0,a=this.description.Ba;s<a;s++)if(this.Aa[s]!=null){var u=d.sa.Wa(this.description.Fd(s));this.Aa[s].Gn(u*l,u,u*this.xa)}this.xa--,this.Rg--,this.Qc(1993)},p.prototype.resize=function(l){this.fm(l)},p.prototype.qp=function(){},p.prototype.Pa=function(){S.prototype.rD.call(this)},p.prototype.Pc=function(l){if(l instanceof d.Ed){if(this.B())return;this.oc();for(var s=this.Aa[0],a=new d.h,u=0;u<this.xa;u++)a.x=s.read(2*u),a.y=s.read(2*u+1),l.Gh(a,a),s.write(2*u,a.x),s.write(2*u+1,a.y)}else{if(this.B())return;this.oc(),this.se(1),this.oc(),s=this.Aa[0],a=this.Aa[1];var f=new d.Od;for(u=0;u<this.xa;u++){f.x=s.read(2*u),f.y=s.read(2*u+1),f.z=a.read(u);var y=l.hp(f);s.write(2*u,y.x),s.write(2*u+1,y.y),a.write(u,y.z)}}this.Qc(1993)},p.prototype.Eb=function(){return 0},p.prototype.K=function(){return 550},p.prototype.He=function(){return 0},p.prototype.Rb=function(){return 0},p.prototype.Nb=function(l){return l==this||l instanceof p&&S.prototype.Nb.call(this,l)},p.prototype.gW=function(l,s){var a=this.xa;if(a=Math.min(a,s+1e3),0>s||s>=this.xa||a<s||l.length!=1e3)throw d.i.O();var u=a-s,f=[];for(this.vb(0).Xw(2*s,2*u,f,0,!0),s=0;s<u;s++)l[s]=d.h.construct(f[2*s],f[2*s+1]);return a},p.prototype.Zx=function(){},p.prototype.ey=function(){},p.prototype.nu=function(){return!1},p.prototype.hj=function(){return!1},p.prototype.ng=function(){return null},p}(d.Fx);d.ee=O}(Q||(Q={})),function(d){var O;(O=d.dL||(d.dL={}))[O.NotDetermined=0]="NotDetermined",O[O.Structure=1]="Structure",O[O.DegenerateSegments=2]="DegenerateSegments",O[O.Clustering=3]="Clustering",O[O.Cracking=4]="Cracking",O[O.CrossOver=5]="CrossOver",O[O.RingOrientation=6]="RingOrientation",O[O.RingOrder=7]="RingOrder",O[O.OGCPolylineSelfTangency=8]="OGCPolylineSelfTangency",O[O.OGCPolygonSelfTangency=9]="OGCPolygonSelfTangency",O[O.OGCDisconnectedInterior=10]="OGCDisconnectedInterior";var S=function(){function p(l,s,a){l===void 0?(this.Lj=0,this.Mo=this.Lo=-1):(this.Lj=l,this.Lo=s,this.Mo=a)}return p.prototype.Yt=function(l){this.Lj=l.Lj,this.Lo=l.Lo,this.Mo=l.Mo},p}();d.Nd=S}(Q||(Q={})),function(d){d.P=function(){function O(){}return O.assert=function(S){if(S===!1)throw d.i.BK()},O.XJ=function(S){return isNaN(S)?NaN:S===0?S:0<S?1:-1},O.Hu=function(S){var p;p===void 0&&(p=0);for(var l=[],s=0;s<S;s++)l[s]=O.mg(2,p);return l},O.mg=function(S,p){p===void 0&&(p=0);for(var l=[],s=0;s<S;s++)l[s]=p;return l},O.bv=function(S,p){var l,s;for(l===void 0&&(l=0),s===void 0&&(s=S.length-1);l<=s;l++)S[l]=p},O.Tk=function(S,p,l){return S<p?p:S>l?l:S},O.Vh=function(S,p){var l=5381;return((l=((l=((l=p!==void 0?(p<<5)+p+(255&S):(l<<5)+l+(255&S))<<5)+l+(S>>8&255))<<5)+l+(S>>16&255))<<5)+l+(S>>24&255)&2147483647},O.wj=function(){throw Error("Not Implemented")},O.XA=function(S){return O.WT(S)+12345&2147483647},O.SG=function(S){var p=32,l=S%O.Px|0,s=S/O.Px|0;return(p&=63)==0?S:(32>p?(S=l>>>p|s<<32-p,p=s>>p):(S=s>>p-32,p=0<=s?0:-1),p*O.Px+(S>>>0))},O.WT=function(S){var p=1103515245,l=65535&p;return((p-l)*(S|=0)|0)+(l*S|0)|0},O.truncate=function(S){return 0>S?-1*Math.floor(Math.abs(S)):Math.floor(S)},O.MAX_SAFE_INTEGER=Math.pow(2,53)-1,O.MIN_SAFE_INTEGER=-O.MAX_SAFE_INTEGER,O.QC=65536,O.Px=O.QC*O.QC,O}()}(Q||(Q={})),function(d){var O;(O=d.xL||(d.xL={}))[O.Project=0]="Project",O[O.Union=1]="Union",O[O.Difference=2]="Difference",O[O.Proximity2D=3]="Proximity2D",O[O.Relate=4]="Relate",O[O.Equals=5]="Equals",O[O.Disjoint=6]="Disjoint",O[O.Intersects=7]="Intersects",O[O.Within=8]="Within",O[O.Contains=9]="Contains",O[O.Crosses=10]="Crosses",O[O.Touches=11]="Touches",O[O.Overlaps=12]="Overlaps",O[O.Buffer=13]="Buffer",O[O.Distance=14]="Distance",O[O.Intersection=15]="Intersection",O[O.Clip=16]="Clip",O[O.Cut=17]="Cut",O[O.DensifyByLength=18]="DensifyByLength",O[O.DensifyByAngle=19]="DensifyByAngle",O[O.LabelPoint=20]="LabelPoint",O[O.GeodesicBuffer=21]="GeodesicBuffer",O[O.GeodeticDensifyByLength=22]="GeodeticDensifyByLength",O[O.ShapePreservingDensify=23]="ShapePreservingDensify",O[O.GeodeticLength=24]="GeodeticLength",O[O.GeodeticArea=25]="GeodeticArea",O[O.Simplify=26]="Simplify",O[O.SimplifyOGC=27]="SimplifyOGC",O[O.Offset=28]="Offset",O[O.Generalize=29]="Generalize",O[O.SymmetricDifference=30]="SymmetricDifference",O[O.ConvexHull=31]="ConvexHull",O[O.Boundary=32]="Boundary",O[O.SimpleRelation=33]="SimpleRelation";var S=function(){function p(){}return p.prototype.K=function(){return null},p.prototype.yn=function(){},p.prototype.Ku=function(){return!1},p}();d.Ge=S}(Q||(Q={})),function(d){var O=function(S){function p(){return S!==null&&S.apply(this,arguments)||this}return Pe(p,S),p.prototype.K=function(){return 13},p.local=function(){return p.instance===null&&(p.instance=new p),p.instance},p.prototype.W=function(l,s,a,u,f){return l instanceof d.ba?(f=new d.$c(l),this.W(f,s,[a],!1,u).next()):u===!0?(a=new d.wC(l,s,a,!1,f),d.Ih.local().W(a,s,f)):new d.wC(l,s,a,!1,f)},p.instance=null,p}(d.Ge);d.vC=O}(Q||(Q={})),function(d){var O=function(){function S(p,l,s,a,u){this.za=-1,this.Sd=p,this.Vz=l,this.Es=s,this.nT=new d.l,this.nT.Pa(),this.ho=-1,this.Vb=u}return S.prototype.next=function(){for(var p;(p=this.Sd.next())!=null;)return this.za=this.Sd.Ma(),this.ho+1<this.Es.length&&this.ho++,this.buffer(p,this.Es[this.ho]);return null},S.prototype.Ma=function(){return this.za},S.prototype.buffer=function(p,l){return d.CK.buffer(p,l,this.Vz,NaN,96,this.Vb)},S.prototype.re=function(){},S}();d.wC=O}(Q||(Q={})),function(d){var O=function(S){function p(){return S!==null&&S.apply(this,arguments)||this}return Pe(p,S),p.prototype.K=function(){return 16},p.local=function(){return p.instance===null&&(p.instance=new p),p.instance},p.prototype.W=function(l,s,a,u){return l instanceof d.ba?(l=new d.$c(l),this.W(l,s,a,u).next()):new d.gL(l,s,a,u)},p.instance=null,p}(d.Ge);d.fL=O}(Q||(Q={})),function(d){var O=function(){function S(p,l,s){if(this.za=-1,p==null)throw d.i.O();this.aa=l,this.Ak=p,this.ra=d.ua.Xd(s,l,!1)}return S.prototype.next=function(){var p;return(p=this.Ak.next())!=null?(this.za=this.Ak.Ma(),d.Vd.clip(p,this.aa,this.ra,0)):null},S.prototype.Ma=function(){return this.za},S.prototype.re=function(){},S}();d.gL=O}(Q||(Q={})),function(d){var O=function(S){function p(){return S!==null&&S.apply(this,arguments)||this}return Pe(p,S),p.prototype.K=function(){return 31},p.local=function(){return p.instance===null&&(p.instance=new p),p.instance},p.prototype.W=function(l,s,a){return l instanceof d.ba?d.yC.mE(l):new d.yC(s,l,a)},p.instance=null,p}(d.Ge);d.xC=O}(Q||(Q={})),function(d){var O=function(){function S(p,l,s){if(this.pA=new d.au,this.za=-1,l==null)throw d.i.O();this.YG=p,this.Jc=!1,this.Ak=l,this.Vb=s}return S.prototype.next=function(){if(this.YG){if(!this.Jc){var p=this.ZN(this.Ak);return this.Jc=!0,p}return null}if(!this.Jc){if((p=this.Ak.next())!=null)return this.za=this.Ak.Ma(),S.mE(p);this.Jc=!0}return null},S.prototype.Ma=function(){return this.za},S.prototype.ZN=function(p){for(var l;(l=p.next())!=null;)this.pA.Ib(l);return this.pA.YQ()},S.prototype.re=function(){if(!this.Jc){if(!this.YG)throw d.i.ga("Invalid call for non merging convex hull.");var p=this.Ak.next();if(p==null)throw d.i.ga("Expects a non-null geometry.");this.pA.Ib(p)}},S.mE=function(p){if(S.QS(p))return p;var l=p.K();if(d.Xk.zd(l))return(l=new d.Ua(p.description)).pc(p,!0),l;if(l==550&&p.I()==2){var s=new d.Ta;return l=new d.Ua(p.description),p.we(0,s),l.nf(s),p.we(1,s),l.lineTo(s),l}return d.au.MO(p)},S.QS=function(p){if(p.B())return!0;var l=p.K();return l==33||l==197||!d.Xk.zd(l)&&(l==550?p.I()==1:l==1607?p.ea()==1&&2>=p.I():p.ea()==1&&(2>=p.I()||d.au.EG(p,0)))},S}();d.yC=O}(Q||(Q={})),function(d){var O=function(S){function p(){return S!==null&&S.apply(this,arguments)||this}return Pe(p,S),p.prototype.K=function(){return 17},p.local=function(){return p.instance===null&&(p.instance=new p),p.instance},p.prototype.W=function(l,s,a,u,f){return new d.iL(l,s,a,u,f)},p.instance=null,p}(d.Ge);d.hL=O}(Q||(Q={})),function(d){var O=function(){function S(p,l,s,a,u){if(this.Vf=null,l==null||s==null)throw d.i.ga("invalid argument");this.kT=p,this.iA=l,this.gH=s,p=d.ua.ov(l,s),this.ra=d.ua.Xd(a,p,!0),this.fH=-1,this.od=u}return S.prototype.Ma=function(){return 0},S.prototype.next=function(){return this.MQ(),++this.fH<this.Vf.length?this.Vf[this.fH]:null},S.prototype.MQ=function(){if(this.Vf==null)switch(this.Vf=[],this.iA.K()){case 1607:this.OQ();break;case 1736:this.NQ()}},S.prototype.OQ=function(){var p=new d.Ua,l=new d.Ua,s=new d.Ua;this.Vf.push(p),this.Vf.push(l);var a=[];d.GK.EK(this.kT,this.iA,this.gH,this.ra,a,this.od);for(var u=0;u<a.length;u++){var f=a[u];if(f.ct==0)p.add(f.Y,!1);else if(f.ct==1||f.ct==2)l.add(f.Y,!1);else if(f.ct==3)this.Vf.push(f.Y);else{if(f.ct!=4)throw d.i.ga("internal");s.add(f.Y,!1)}}s.B()||p.B()&&l.B()&&!(3<=this.Vf.length)||this.Vf.push(s),p.B()&&l.B()&&3>this.Vf.length&&(this.Vf.length=0)},S.prototype.NQ=function(){var p=new d.ja(0),l=new d.hd,s=l.WE(),a=l.Ib(this.iA),u=l.Ib(this.gH),f=new d.Hg;try{f.Gt(l,this.ra,this.od),f.fl(s,a,u,p);var y=l.Ke(a),v=new d.Ea,_=new d.Ea;for(this.Vf.length=0,this.Vf.push(v),this.Vf.push(_),a=0;a<p.size;a++){var M=new d.hd,$=M.Ib(y),T=M.Ib(l.Ke(p.get(a)));f.fr(M,this.od);var A=f.Cv($,T),R=M.Ke(A);if(!R.B()){var D=l.FF(p.get(a),s);D==2?v.add(R,!1):D==1?_.add(R,!1):this.Vf.push(R);var V=new d.hd;$=V.Ib(y),T=V.Ib(l.Ke(p.get(a))),f.fr(V,this.od),y=V.Ke(f.km($,T))}}!y.B()&&0<p.size&&this.Vf.push(y),v.B()&&_.B()&&(this.Vf.length=0)}finally{f.Wg()}},S.prototype.re=function(){},S}();d.iL=O}(Q||(Q={})),function(d){var O=function(S){function p(){return S!==null&&S.apply(this,arguments)||this}return Pe(p,S),p.prototype.K=function(){return 18},p.local=function(){return p.instance===null&&(p.instance=new p),p.instance},p.prototype.W=function(l,s,a){if(l instanceof d.ba)return l=new d.$c(l),this.W(l,s,a).next();if(0>=s)throw d.i.O();return new d.jL(l,s,a)},p.instance=null,p}(d.Ge);d.Zl=O}(Q||(Q={})),function(d){var O=function(){function S(p,l){this.za=-1,this.Sd=p,this.Rs=l}return S.prototype.Ma=function(){return this.za},S.prototype.next=function(){var p;return(p=this.Sd.next())!=null?(this.za=this.Sd.Ma(),this.IP(p)):null},S.prototype.IP=function(p){if(p.B()||1>p.Eb())return p;var l=p.K();if(l==1736||l==1607)return this.Iy(p);if(d.ba.zd(l))return this.KP(p);if(l==197)return this.JP(p);throw d.i.Ra()},S.prototype.KP=function(p){if(p.Rb()<=this.Rs)return p;var l=new d.Ua(p.description);return l.pc(p,!0),this.Iy(l)},S.prototype.JP=function(p){var l=new d.Ea(p.description);l.bd(p,!1);var s=new d.l;return p.A(s),p=s.da(),s.S()<=this.Rs&&p<=this.Rs?l:this.Iy(l)},S.prototype.Iy=function(p){for(var l=p.Ja(),s=p.Ha();s.ab();)for(var a=!0;s.Ia();){var u=s.ia();if(u.K()!=322)throw d.i.ga("not implemented");var f=s.Qn(),y=u.Rb();if(y>this.Rs){var v=Math.ceil(y/this.Rs);y=new d.Ta(p.description),a&&(u.Vo(y),l.nf(y));var _=a=1/v,M=0;for(--v;M<v;M++)u.Vw(_,y),l.lineTo(y),_+=a;f?l.Cp():(u.Ro(y),l.lineTo(y))}else f?l.Cp():l.pc(u,a);a=!1}return l},S.prototype.re=function(){},S}();d.jL=O}(Q||(Q={})),function(d){var O=function(S){function p(){return S!==null&&S.apply(this,arguments)||this}return Pe(p,S),p.local=function(){return p.instance===null&&(p.instance=new p),p.instance},p.prototype.K=function(){return 2},p.prototype.W=function(l,s,a,u){return l instanceof d.ba?(l=new d.$c(l),s=new d.$c(s),this.W(l,s,a,u).next()):new d.kL(l,s,a,u)},p.km=function(l,s,a,u){if(l.B()||s.B())return l;var f=l.Eb(),y=s.Eb();if(f>y)return l;var v=l.K(),_=s.K(),M=new d.l,$=new d.l,T=new d.l;l.A(M),s.A($),T.L(M),T.$b($);var A=(T=d.ua.Xd(a,T,!0))*Math.sqrt(2)*1.00001,R=new d.l;if(R.L(M),R.X(A,A),!R.isIntersecting($))return l;if(f==1&&y==2)return p.FV(l,s,_,a,u);if(v==33)switch(d.Xk.zd(_)?(a=new d.Ua(s.description),a.pc(s,!0)):a=s,_){case 1736:return p.SU(l,a,T);case 1607:return p.TU(l,a,T);case 550:return p.QU(l,a,T);case 197:return p.PU(l,a,T);case 33:return p.RU(l,a,T);default:throw d.i.O()}else if(v==550)switch(_){case 1736:return p.iU(l,s,T);case 197:return p.gU(l,s,T);case 33:return p.hU(l,s,T)}return d.Hg.km(l,s,a,u)},p.SU=function(l,s,a){return d.jd.FG(s,l,a)==0?l:l.Ja()},p.TU=function(l,s,a){var u=l.D();s=s.Ha();for(var f=a*Math.sqrt(2)*1.00001,y=f*f,v=new d.l;s.ab();)for(;s.Ia();){var _=s.ia();if(_.A(v),v.X(f,f),v.contains(u)){if(_.ss(u,a))return l.Ja();var M=_.bc();if(d.h.zc(u,M)<=y||(M=_.xc(),d.h.zc(u,M)<=y))return l.Ja()}}return l},p.QU=function(l,s,a){var u=s.vb(0);s=s.I();var f=l.D(),y=new d.h;a=a*Math.sqrt(2)*1.00001,a*=a;for(var v=0;v<s;v++)if(u.uc(2*v,y),d.h.zc(y,f)<=a)return l.Ja();return l},p.PU=function(l,s,a){var u=new d.l;return s.A(u),u.X(a,a),s=l.D(),u.contains(s)?l.Ja():l},p.RU=function(l,s,a){a=a*Math.sqrt(2)*1.00001,a*=a;var u=l.D();return s=s.D(),d.h.zc(u,s)<=a?l.Ja():l},p.iU=function(l,s,a){var u=new d.l;s.A(u),u.X(a,a);for(var f=l.I(),y=!1,v=[],_=0;_<f;_++)v[_]=!1;var M=new d.h;for(_=0;_<f;_++)l.D(_,M),u.contains(M)&&d.jd.Zd(s,M,a)!=0&&(y=!0,v[_]=!0);if(!y)return l;for(s=l.Ja(),_=0;_<f;_++)v[_]||s.Gd(l,_,_+1);return s},p.gU=function(l,s,a){var u=new d.l;s.A(u),u.X(a,a),s=l.I();var f=!1;a=[];for(var y=0;y<s;y++)a[y]=!1;var v=new d.h;for(y=0;y<s;y++)l.D(y,v),u.contains(v)&&(f=!0,a[y]=!0);if(!f)return l;for(u=l.Ja(),y=0;y<s;y++)a[y]||u.Gd(l,y,y+1);return u},p.hU=function(l,s,a){var u=l.vb(0),f=l.I(),y=s.D(),v=new d.h,_=!1;s=[];for(var M=0;M<f;M++)s[M]=!1;for(a=(M=a*Math.sqrt(2)*1.00001)*M,M=0;M<f;M++)u.uc(2*M,v),d.h.zc(v,y)<=a&&(_=!0,s[M]=!0);if(!_)return l;for(u=l.Ja(),M=0;M<f;M++)s[M]||u.Gd(l,M,M+1);return u},p.FV=function(l,s,a,u,f){var y=new d.Hh;l.dn(y);var v=new d.l;return s.A(v),y.$b(v),y.X(.1*y.S(),.1*y.da()),(v=new d.Ea).bd(y,!1),a==1736?v.add(s,!0):v.bd(s,!0),d.Zj.local().W(l,v,u,f)},p.instance=null,p}(d.Ge);d.mp=O}(Q||(Q={})),function(d){var O=function(){function S(p,l,s,a){this.vs=l==null,this.za=-1,this.Sd=p,this.Vz=s,this.rT=l.next(),this.Vb=a}return S.prototype.next=function(){return this.vs?null:(p=this.Sd.next())!=null?(this.za=this.Sd.Ma(),d.mp.km(p,this.rT,this.Vz,this.Vb)):null;var p},S.prototype.Ma=function(){return this.za},S.prototype.re=function(){},S}();d.kL=O}(Q||(Q={})),function(d){var O=function(){function p(l){this.od=l,this.Dj=new d.l,this.Dj.Pa(),this.qh=new d.l,this.qh.Pa()}return p.prototype.Pt=function(){var l=this.Dj.v;this.Dj.v=this.qh.v,this.qh.v=l,l=this.Dj.C,this.Dj.C=this.qh.C,this.qh.C=l,l=this.Dj.G,this.Dj.G=this.qh.G,this.qh.G=l,l=this.Dj.H,this.Dj.H=this.qh.H,this.qh.H=l},p.prototype.$P=function(l,s){if(this.od!=null&&!this.od.progress(-1,-1))throw d.i.hu("user_canceled");var a=!this.Dj.isIntersecting(this.qh);return d.ba.Ic(l.K())&&d.ba.Ic(s.K())?l.I()>s.I()?this.bE(l,s,a):(this.Pt(),l=this.bE(s,l,a),this.Pt(),l):l.K()==550&&d.ba.Ic(s.K())?(l=this.cE(s,l,a),this.Pt(),l):s.K()==550&&d.ba.Ic(l.K())?this.cE(l,s,a):l.K()==550&&s.K()==550?l.I()>s.I()?this.dE(l,s):(this.Pt(),l=this.dE(s,l),this.Pt(),l):0},p.prototype.bE=function(l,s,a){var u=l.Ha(),f=s.Ha(),y=new d.l,v=new d.l,_=17976931348623157e292;if(!a&&this.lY(l,s,u,f))return 0;for(;u.ab();)for(;u.Ia();)if((l=u.ia()).A(y),!(y.px(this.qh)>_)){for(;f.ab();)for(;f.Ia();)if((s=f.ia()).A(v),y.px(v)<_&&(s=l.ub(s,a),(s*=s)<_)){if(s==0)return 0;_=s}f.aj()}return Math.sqrt(_)},p.prototype.cE=function(l,s,a){var u=l.Ha(),f=new d.l,y=17976931348623157e292,v=new d.h,_=s.I();for(a=!a&&l.K()==1736;u.ab();)for(;u.Ia();){var M=u.ia();if(M.A(f),!(1<_&&f.px(this.qh)>y)){for(var $=0;$<_;$++){if(s.D($,v),a&&d.jd.Zd(l,v,0)!=0)return 0;var T=M.ge(v,!1);if(v.sub(M.ic(T)),(T=v.Uk())<y){if(T==0)return 0;y=T}}a=!1}}return Math.sqrt(y)},p.prototype.dE=function(l,s){for(var a,u=17976931348623157e292,f=new d.h,y=new d.h,v=l.I(),_=s.I(),M=0;M<v;M++)if(l.D(M,f),!(1<_&&this.qh.dK(f)>u)){for(var $=0;$<_;$++)if(s.D($,y),(a=d.h.zc(f,y))<u){if(a==0)return 0;u=a}}return Math.sqrt(u)},p.prototype.lY=function(l,s,a,u){if(l.K()==1736){for(;u.ab();)if(u.Ia()){var f=u.ia();if(d.jd.Zd(l,f.xc(),0)!=0)return!0}u.aj()}if(s.K()==1736){for(;a.ab();)if(a.Ia()&&(l=a.ia(),d.jd.Zd(s,l.xc(),0)!=0))return!0;a.aj()}return!1},p.prototype.im=function(l,s){return l.B()||s.B()?NaN:(l.A(this.Dj),s.A(this.qh),this.$P(l,s))},p}(),S=function(p){function l(){return p!==null&&p.apply(this,arguments)||this}return Pe(l,p),l.prototype.W=function(s,a,u){if(s==null||a==null)throw d.i.O();if(s.B()||a.B())return NaN;var f=s.K(),y=a.K();if(f==33){if(y==33)return d.h.ub(s.D(),a.D());if(y==197)return u=new d.l,a.A(u),u.ub(s.D());(f=new d.ee).add(s),s=f}else if(f==197){if(y==197)return y=new d.l,s.A(y),u=new d.l,a.A(u),u.ub(y);(f=new d.Ea).bd(s,!1),s=f}return y==33?((y=new d.ee).add(a),a=y):y==197&&((y=new d.Ea).bd(a,!1),a=y),new O(u).im(s,a)},l.local=function(){return l.instance===null&&(l.instance=new l),l.instance},l.prototype.K=function(){return 14},l.instance=null,l}(d.Ge);d.lL=S}(Q||(Q={})),function(d){var O=function(){function S(p,l,s,a){this.uH=p,this.yH=l,this.od=a,this.VG=s}return S.prototype.next=function(){var p=this.uH.next();return p==null?null:this.uC(p)},S.prototype.Ma=function(){return this.uH.Ma()},S.prototype.uC=function(p){var l=p.K();if(d.ba.Tn(l))return p;if(l==197)return(l=new d.Ea(p.description)).bd(p,!1),this.uC(l);if(p.B())return p;if(p==null)throw d.i.Ra();l=p.Ja();for(var s=new d.zb,a=0,u=p.ea();a<u;a++)this.OK(p,a,l,s);return l},S.prototype.OK=function(p,l,s,a){if(!(2>p.Ka(l))){var u=p.Ca(l),f=p.Wc(l)-1,y=p.vb(0),v=p.ec(l),_=new d.ja(0);_.Jb(p.Ka(l)+1);var M=new d.ja(0);for(M.Jb(p.Ka(l)+1),_.add(v?u:f),_.add(u),u=new d.h;1<_.size;){var $=_.Gc();_.Jf();var T=_.Gc();p.D($,u),a.Ec(u),p.D(T,u),a.Rc(u),0<=(T=this.NK(a,u,y,$,T,f))?(_.add(T),_.add($)):M.add($)}if(v||M.add(_.get(0)),M.size==_.size)s.addPath(p,l,!0);else if(2<=M.size&&(!this.VG||M.size!=2||!(v||d.h.ub(p.Oa(M.get(0)),p.Oa(M.get(1)))<=this.yH))){for(l=new d.Ta,a=0,f=M.size;a<f;a++)p.we(M.get(a),l),a==0?s.nf(l):s.lineTo(l);v&&(this.VG||M.size!=2||s.lineTo(l),s.Cp())}}},S.prototype.NK=function(p,l,s,a,u,f){var y=u-1;for(u<=a&&(y=f),f=u=-1,a+=1;a<=y;a++){s.uc(2*a,l);var v=l.x,_=l.y;p.ic(p.ge(l,!1),l),l.x-=v,l.y-=_,(v=l.length())>this.yH&&v>f&&(u=a,f=v)}return u},S.prototype.re=function(){},S}();d.mL=O}(Q||(Q={})),function(d){var O=function(S){function p(){return S!==null&&S.apply(this,arguments)||this}return Pe(p,S),p.prototype.K=function(){return 29},p.prototype.W=function(l,s,a,u){return l instanceof d.ba?(l=new d.$c(l),this.W(l,s,a,u).next()):new d.mL(l,s,a,u)},p.local=function(){return p.instance===null&&(p.instance=new p),p.instance},p.instance=null,p}(d.Ge);d.zC=O}(Q||(Q={})),function(d){var O=function(S){function p(){return S!==null&&S.apply(this,arguments)||this}return Pe(p,S),p.prototype.K=function(){return 21},p.local=function(){return p.instance===null&&(p.instance=new p),p.instance},p.prototype.W=function(l,s,a,u,f,y,v,_){return l instanceof d.ba?(_=new d.$c(l),this.W(_,s,a,[u],f,y,!1,v).next()):v===!0?(a=new d.BC(l,s,a,u,f,!1,!1,_),d.Ih.local().W(a,s,_)):new d.BC(l,s,a,u,f,!1,!1,_)},p.instance=null,p}(d.Ge);d.AC=O}(Q||(Q={})),function(d){var O=function(){function S(p,l,s,a,u,f,y,v){if(f)throw d.i.Fe();if(l==null)throw d.i.O();this.za=-1,this.Os=p,this.wg=l,this.Ae=s,this.Es=a,this.bo=u,this.ho=-1,this.Vb=v,this.oT=new d.l,this.oT.Pa()}return S.prototype.next=function(){for(var p;(p=this.Os.next())!=null;)return this.za=this.Os.Ma(),this.ho+1<this.Es.length&&this.ho++,this.VQ(p,this.Es[this.ho]);return null},S.prototype.Ma=function(){return this.za},S.prototype.VQ=function(p,l){return d.QK.buffer(p,this.wg,this.Ae,l,this.bo,this.Vb)},S.prototype.re=function(){},S}();d.BC=O}(Q||(Q={})),function(d){var O=function(S){function p(){return S!==null&&S.apply(this,arguments)||this}return Pe(p,S),p.prototype.K=function(){return 24},p.local=function(){return p.instance===null&&(p.instance=new p),p.instance},p.prototype.W=function(l,s,a){if(s==null)throw d.i.O();if(l.B()||1>l.Eb())return 0;if(a==4)throw d.i.Fe();var u=d.cb.tc(s),f=d.cb.xv(u),y=d.cb.gv(u);f*=2-f;var v=u.Id().ci,_=l.K();if(_==1736||_==197)var M=l.ng();else d.ba.zd(_)?(M=new d.Ua(l.description)).pc(l,!0):M=l;if(u.Nb(s)==0){if(d.cb.Xc(s)){M=d.Jh.nj(M,s),_==1607&&M==l&&(M=d.ba.kg(l)),l=new d.Oc,d.cb.ih(s).en(l),_=0;for(var $=M.I();_<$;_++){var T=M.Oa(_);T.x=d.Jh.an(T.x,l),M.Db(_,T)}}l=M.Ja(),M=d.Jh.RI(s,u,M,l)?l:d.cb.Bh(M,s,u)}return this.cQ(M,a,y,f,v)},p.prototype.cQ=function(l,s,a,u,f){var y=new d.ha(0),v=0;for(l=l.Ha();l.ab();)for(;l.Ia();){var _=l.ia(),M=_.bc();_=_.xc(),M.scale(f),_.scale(f),d.kb.xd(a,u,M.x,M.y,_.x,_.y,y,null,null,s),v+=y.u}return v},p.instance=null,p}(d.Ge);d.qL=O}(Q||(Q={})),function(d){var O=function(S){function p(){return S!==null&&S.apply(this,arguments)||this}return Pe(p,S),p.prototype.K=function(){return 18},p.local=function(){return p.instance===null&&(p.instance=new p),p.instance},p.prototype.W=function(l,s,a,u,f){return l instanceof d.ba?(l=new d.$c(l),this.W(l,s,a,u,f).next()):new d.oL(l,a,u,s,-1,-1,f)},p.instance=null,p}(d.Ge);d.nL=O}(Q||(Q={})),function(d){var O=function(){function S(p,l,s,a,u,f){if(0<f||s!=4&&0<u)throw d.i.Fe();if(l==null)throw d.i.O();this.za=-1,this.Os=p,this.wg=l,this.Ae=s,this.yT=a,this.xT=u}return S.prototype.next=function(){for(var p;(p=this.Os.next())!=null;)return this.za=this.Os.Ma(),this.Uy(p);return null},S.prototype.Ma=function(){return this.za},S.prototype.Uy=function(p){return d.ej.Sr(p,this.wg,this.Ae,this.yT,this.xT,this.Vb)},S.prototype.re=function(){},S}();d.oL=O}(Q||(Q={})),function(d){(function(O){O[O.Unknown=0]="Unknown",O[O.Contains=1]="Contains",O[O.Within=2]="Within",O[O.Equals=3]="Equals",O[O.Disjoint=4]="Disjoint",O[O.Touches=8]="Touches",O[O.Crosses=16]="Crosses",O[O.Overlaps=32]="Overlaps",O[O.NoThisRelation=64]="NoThisRelation",O[O.Intersects=1073741824]="Intersects",O[O.IntersectsOrDisjoint=1073741828]="IntersectsOrDisjoint"})(d.YK||(d.YK={})),d.rL=function(){function O(){}return O.iW=function(S,p){var l=S.K(),s=p.K();if(d.ba.zj(l)){var a=S.Cb;if(a!=null&&(a=a.Hk)!=null){if(s==33){var u=p.D();a=a.Uo(u.x,u.y)}else u=new d.l,p.A(u),a=a.To(u);if(a==1)return 1;if(a==0)return 4}}if(d.ba.zj(s)&&(a=p.Cb)!=null&&(a=a.Hk)!=null){if(l==33?(S=S.D(),a=a.Uo(S.x,S.y)):(p=new d.l,S.A(p),a=a.To(p)),a==1)return 2;if(a==0)return 4}return 0},O}()}(Q||(Q={})),function(d){var O=function(S){function p(){return S!==null&&S.apply(this,arguments)||this}return Pe(p,S),p.local=function(){return p.instance===null&&(p.instance=new p),p.instance},p.prototype.K=function(){return 15},p.prototype.W=function(l,s,a,u,f){return l instanceof d.ba?(l=new d.$c(l),s=new d.$c(s),this.W(l,s,a,u,f===void 0?-1:f).next()):f===void 0?new d.CC(l,s,a,u,-1):new d.CC(l,s,a,u,f)},p.prototype.yn=function(l,s,a){this.Ku(l)&&(s=d.ua.mj(s,l,!1),l.hj(a)||l.nu(s,a))},p.prototype.Ku=function(l){return d.Mx.uE(l)},p.instance=null,p}(d.Ge);d.Zj=O}(Q||(Q={})),function(d){var O=function(){function S(p,l,s,a,u){if(this.vs=l==null,this.za=-1,this.Sd=p,this.wg=s,this.Pe=l.next(),this.Fj=this.Pe.K(),this.Vb=a,this.Hi=u,this.Hi!=-1&&(0>=this.Hi||7<this.Hi))throw d.i.O("bad dimension mask")}return S.prototype.next=function(){if(this.vs)return null;if(this.Bw!=null){var p=this.Bw.next();if(p!=null)return p;this.Bw=null}for(;(p=this.Sd.next())!=null;)return this.za=this.Sd.Ma(),this.Hi==-1?p=this.Fa(p):(this.Bw=this.KS(p),p=this.Bw.next()),p;return null},S.prototype.Ma=function(){return this.za},S.prototype.Fa=function(p){var l=this.uK(p);if(l!=null)return l;l=d.ua.ov(this.Pe,p);var s=d.ua.Xd(this.wg,l,!0);l=new d.l,this.Pe.A(l);var a=new d.l;return p.A(a),l.X(2*s,2*s),l.Fa(a),l.X(100*s,100*s),s=d.Vd.clip(this.Pe,l,0,0),p=d.Vd.clip(p,l,0,0),d.Hg.Cv(p,s,this.wg,this.Vb)},S.prototype.KI=function(p,l,s){var a=0;if((1&l)!=0)s[0]==null&&(s[0]=new d.ee(p)),a++;else for(var u=0;u<s.length-1;u++)s[u]=s[u+1];if((2&l)!=0)s[a]==null&&(s[a]=new d.Ua(p)),a++;else for(u=a;u<s.length-1;u++)s[u]=s[u+1];if((4&l)!=0)s[a]==null&&(s[a]=new d.Ea(p)),a++;else for(u=a;u<s.length-1;u++)s[u]=s[u+1];if(a!=3){for(p=[],u=0;u<a;u++)p[u]=s[u];return new d.$c(p)}return new d.$c(s)},S.prototype.KS=function(p){var l=this.uK(p);if(l!=null){var s=[null,null,null];return s[l.Eb()]=l,this.KI(p.description,this.Hi,s)}l=d.ua.ov(this.Pe,p),s=d.ua.Xd(this.wg,l,!0),l=new d.l,this.Pe.A(l),l.X(2*s,2*s);var a=new d.l;return p.A(a),l.Fa(a),l.X(100*s,100*s),s=d.Vd.clip(this.Pe,l,0,0),l=d.Vd.clip(p,l,0,0),s=d.Hg.Kz(l,s,this.wg,this.Vb),this.KI(p.description,this.Hi,s)},S.prototype.uK=function(p){var l=d.ua.ov(p,this.Pe),s=d.ua.Xd(this.wg,l,!0);l=p.K();var a=p.B(),u=this.Pe.B();if(!(u=a||u)){u=new d.l,p.A(u);var f=new d.l;this.Pe.A(f),f.X(2*s,2*s),u=!u.isIntersecting(f)}if(!u)if((f=d.rL.iW(this.Pe,p))==4)u=!0;else{if((2&f)!=0)return this.Pe;if((1&f)!=0)return p}if(u)return(s=d.ba.uf(l))<(u=d.ba.uf(this.Fj))?S.CB(p,a):s>u||s==0&&l==550&&this.Fj==33?this.iJ():S.CB(p,a);if((this.Hi==-1||this.Hi==4)&&l==197&&this.Fj==197)return s=this.Pe,l=new d.l,p.A(l),a=new d.l,s.A(a),l.Fa(a),s=new d.Hh,p.copyTo(s),s.Zo(l),s;if(l==197&&d.ba.uf(this.Fj)==0||this.Fj==197&&d.ba.uf(l)==0)return a=l==197?p:this.Pe,p=l==197?this.Pe:p,l=new d.l,a.A(l),d.Vd.clip(p,l,s,0);if(d.ba.uf(l)==0&&0<d.ba.uf(this.Fj)||0<d.ba.uf(l)&&d.ba.uf(this.Fj)==0){if(s=d.ua.mj(this.wg,p,!1),l==550||l==33)return d.Hg.uG(p,this.Pe,s);if(this.Fj==550||this.Fj==33)return d.Hg.uG(this.Pe,p,s);throw d.i.Ra()}return this.Hi!=-1&&this.Hi!=2||l!=1607||this.Fj!=1736?this.Hi!=-1&&this.Hi!=2||l!=1736||this.Fj!=1607?null:this.rK(this.Pe,p):this.rK(p,this.Pe)},S.prototype.rK=function(p,l){var s=p,a=l,u=d.ua.mj(this.wg,l,!1),f=new d.l;a.A(f);var y=new d.l;s.A(y),y.X(2*u,2*u),f.Fa(y),f.X(10*u,10*u),s=p=d.Vd.clip(p,f,0,0),y=new d.ja(0);var v=-1,_=a.Cb;if(_!=null){var M=_.Hk;if(M!=null){v=0,y.Jb(s.I()+s.ea());for(var $=new d.l,T=s.Ha();T.ab();)for(;T.Ia();){T.ia().A($);var A=M.To($);A==1?y.add(1):A==0?y.add(0):(y.add(-1),v++)}}}if(5<l.I()&&(_=(a=l=d.Vd.clip(l,f,0,0)).Cb),0>v&&(v=s.sz()),f=s.I()+a.I(),v*a.I()>Math.log(f)*f*4)return null;f=null,v=a.Ha(),_!=null&&_.Gb!=null&&(f=_.Gb),f==null&&20<a.I()&&(f=d.ua.iE(a)),p=p.Ja(),a=null,_=s.Ha(),M=[0,0,0,0,0,0,0,0,0],$=new d.ce(0),T=new d.jg,A=-1;for(var R=0,D=0,V=0<y.size,Z=-1;_.ab();){Z=_.gb;var ee=0;for(A=-1,R=0;_.Ia();){var G=V?d.P.truncate(y.get(D)):-1;D++;var re=_.ia();if(0>G){if(f!=null)for(a==null?a=f.qR(re,u):a.Wo(re,u),G=a.next();G!=-1;G=a.next()){v.Wb(f.ka(G)),G=v.ia();var oe=re.Fa(G,null,M,null,u);for(G=0;G<oe;G++)$.add(M[G])}else for(v.aj();v.ab();)for(;v.Ia();)for(G=v.ia(),oe=re.Fa(G,null,M,null,u),G=0;G<oe;G++)$.add(M[G]);if(0<$.size){$.Wd(0,$.size,function(De,Fe){return De-Fe});var se=0;$.add(1),oe=-1,G=0;for(var ge=$.size;G<ge;G++){var me=$.get(G);if(me!=se){var Ie=!1;if(se!=0||me!=1?(re.dh(se,me,T),se=T.get()):(se=re,Ie=!0),2<=ee){if(p.Fr(s,Z,A,R,ee==3),this.LD(l,se.bc(),u)!=1&&this.MD(l,se,u)!=1)return null;p.pc(se,!1),ee=1,R=0}else switch(oe=this.MD(l,se,u),oe){case 1:Ie?2>ee?(A=_.xb()-s.Ca(Z),R=1,ee=ee==0?3:2):R++:(p.pc(se,ee==0),ee=1);break;case 0:ee=0,A=-1,R=0;break;default:return null}se=me}}}else{if(0>(G=this.LD(l,re.bc(),u)))return null;G==1?(2>ee&&(A=_.xb()-s.Ca(Z),ee=ee==0?3:2),R++):(A=-1,R=0)}$.clear(!1)}else G!=0&&G==1&&(ee==0?(ee=3,A=_.xb()-s.Ca(Z)):ee==1?(ee=2,A=_.xb()-s.Ca(Z)):R++)}2<=ee&&(p.Fr(s,Z,A,R,ee==3),A=-1)}return p},S.prototype.LD=function(p,l,s){return d.Fg.ym(p,l,s)},S.prototype.MD=function(p,l,s){var a=l.bc();l=l.xc();var u=d.Fg.ym(p,a,s),f=d.Fg.ym(p,l,s);return u==1&&f==0||u==0&&f==1?-1:u==0||f==0?0:u==1||f==1?1:((u=new d.h).add(a,l),u.scale(.5),(p=d.Fg.ym(p,u,s))==0?0:p==1?1:-1)},S.CB=function(p,l){return l?p:p.Ja()},S.prototype.iJ=function(){return this.tH==null&&(this.tH=this.Pe.Ja()),this.tH},S.prototype.re=function(){},S}();d.CC=O}(Q||(Q={})),function(d){var O=function(S){function p(){return S!==null&&S.apply(this,arguments)||this}return Pe(p,S),p.prototype.K=function(){return 28},p.local=function(){return p.instance===null&&(p.instance=new p),p.instance},p.prototype.W=function(l,s,a,u,f,y,v){return l instanceof d.ba?(l=new d.$c(l),this.W(l,s,a,u,f,y,v).next()):new d.sL(l,s,a,u,f,y,v)},p.instance=null,p}(d.Ge);d.DC=O}(Q||(Q={})),function(d){var O=function(){function S(p,l,s,a,u,f,y){this.za=-1,this.Sd=p,this.Oj=l,this.La=s,this.Mi=a,this.xA=u,this.pH=f,this.od=y}return S.prototype.next=function(){var p=this.Sd.next();return p!=null?(this.za=this.Sd.Ma(),this.eL(p)):null},S.prototype.Ma=function(){return this.za},S.prototype.eL=function(p){var l=0>=this.pH?d.ua.mj(this.Oj,p,!1):this.pH;return d.DK.W(p,this.La,this.Mi,this.xA,l,this.od)},S.prototype.re=function(){},S}();d.sL=O}(Q||(Q={})),function(d){var O;(O=d.IK||(d.IK={}))[O.clipToDomainOnly=1]="clipToDomainOnly",O[O.clipWithHorizon=2]="clipWithHorizon",O[O.foldAndClipWithHorizon=3]="foldAndClipWithHorizon";var S=function(p){function l(){return p!==null&&p.apply(this,arguments)||this}return Pe(l,p),l.prototype.K=function(){return 0},l.local=function(){return l.instance===null&&(l.instance=new l),l.instance},l.prototype.W=function(s,a,u){return s instanceof d.ba?(s=new d.$c(s),this.W(s,a,u).next()):new d.tL(s,a,u)},l.prototype.transform=function(s,a,u,f){return d.du.transform(s,a,u,f,!0)},l.prototype.St=function(s,a,u,f){return d.du.St(s,a,u,f)},l.instance=null,l}(d.Ge);d.Gx=S}(Q||(Q={})),function(d){var O=function(){function S(p,l,s){this.za=-1,this.Sd=p,this.HT=l,this.od=s}return S.prototype.next=function(){var p=this.Sd.next();return p!=null?(this.za=this.Sd.Ma(),d.du.Bh(p,this.HT,this.od)):null},S.prototype.Ma=function(){return this.za},S.prototype.re=function(){},S}();d.tL=O}(Q||(Q={})),function(d){var O=function(){function p(){}return p.prototype.reset=function(){this.rh=this.zk=-1,this.ws=this.mq=!1},p.prototype.vQ=function(l,s,a){for(l.Wb(s,a);l.Ia();){var u=l.ia();if((u=u.Rb())!=0)return l.xb()}for(l.Wb(s,a);l.zz();)if((u=(u=l.ni()).Rb())!=0)return l.xb();return-1},p.prototype.wQ=function(l,s){for(l.Wb(s,-1);l.zz();)if(l.ni().Rb()!=0)return l.xb();return-1},p.prototype.uQ=function(l,s){for(l.Wb(s,-1),l.ia();l.Ia();)if(l.ia().Rb()!=0)return l.xb();return-1},p.prototype.tQ=function(l,s,a,u){if(this.zk=this.vQ(s,a,u),this.zk!=-1){s.Wb(this.zk,-1);var f=s.ia(),y=f.ic(f.ge(l,!1));if(a=d.h.zc(y,l),(u=new d.h).N(y),u.sub(f.bc()),(y=new d.h).N(l),y.sub(f.bc()),this.mq=0>u.yi(y),this.rh=this.uQ(s,this.zk),this.rh!=-1){s.Wb(this.rh,-1);var v=(f=s.ia()).ge(l,!1);v=f.ic(v);var _=d.h.zc(v,l);_>a?this.rh=-1:(u.N(v),u.sub(f.bc()),y.N(l),y.sub(f.bc()),this.ws=0>u.yi(y))}this.rh==-1&&(this.rh=this.wQ(s,this.zk),this.rh!=-1&&(s.Wb(this.rh,-1),v=(f=s.ia()).ge(l,!1),v=f.ic(v),(_=d.h.zc(v,l))>a?this.rh=-1:(u.N(v),u.sub(f.bc()),y.N(l),y.sub(f.bc()),this.ws=0>u.yi(y),l=this.zk,this.zk=this.rh,this.rh=l,l=this.mq,this.mq=this.ws,this.ws=l)))}},p.prototype.YN=function(l,s,a,u,f){return a=a.Ha(),this.tQ(l,a,u,f),this.zk!=-1&&this.rh==-1?this.mq:this.zk!=-1&&this.rh!=-1?this.mq==this.ws?this.mq:(a.Wb(this.zk,-1),l=a.ia().lg(),a.Wb(this.rh,-1),s=a.ia().lg(),0<=l.yi(s)):s},p}(),S=function(p){function l(){return p!==null&&p.apply(this,arguments)||this}return Pe(l,p),l.local=function(){return l.instance===null&&(l.instance=new l),l.instance},l.prototype.K=function(){return 3},l.prototype.iz=function(s,a,u){var f;if(f===void 0&&(f=!1),s.B())return new d.bm;a=a.D();var y=s,v=s.K();switch(v==197&&((y=new d.Ea).bd(s,!1),v=1736),v){case 33:return this.sI(y,a);case 550:return this.eI(y,a);case 1607:case 1736:return this.XT(y,a,u,f);default:throw d.i.ga("not implemented")}},l.prototype.jz=function(s,a){if(s.B())return new d.bm;a=a.D();var u=s,f=s.K();switch(f==197&&((u=new d.Ea).bd(s,!1),f=1736),f){case 33:return this.sI(u,a);case 550:case 1607:case 1736:return this.eI(u,a);default:throw d.i.ga("not implemented")}},l.prototype.kz=function(s,a,u,f){if(0>f)throw d.i.O();if(s.B())return[];a=a.D();var y=s,v=s.K();switch(v==197&&((y=new d.Ea).bd(s,!1),v=1736),v){case 33:return this.OU(y,a,u,f);case 550:case 1607:case 1736:return this.oU(y,a,u,f);default:throw d.i.ga("not implemented")}},l.prototype.XT=function(s,a,u,f){if(s.K()==1736&&u&&(u=new d.l,s.A(u),u=d.ua.Xd(null,u,!1),(f?d.jd.Zd(s,a,0):d.jd.Zd(s,a,u))!=0)){var y=new d.bm(a,0,0);return f&&y.RJ(!0),y}var v=s.Ha();y=new d.h;for(var _=u=-1,M=17976931348623157e292,$=0;v.ab();)for(;v.Ia();){var T=v.ia();T=T.ic(T.ge(a,!1));var A=d.h.zc(T,a);A<M?($=1,y=T,u=v.xb(),_=v.gb,M=A):A==M&&$++}return y=new d.bm(y,u,Math.sqrt(M)),f&&(v.Wb(u,_),T=v.ia(),f=0>d.h.Wq(a,T.bc(),T.xc()),1<$&&(($=new O).reset(),f=$.YN(a,f,s,u,_)),y.RJ(f)),y},l.prototype.sI=function(s,a){return s=s.D(),a=d.h.ub(s,a),new d.bm(s,0,a)},l.prototype.eI=function(s,a){for(var u=s.vb(0),f=s.I(),y=s=0,v=0,_=17976931348623157e292,M=0;M<f;M++){var $=new d.h;u.uc(2*M,$);var T=d.h.zc($,a);T<_&&(y=$.x,v=$.y,s=M,_=T)}return(a=new d.bm).by(y,v,s,Math.sqrt(_)),a},l.prototype.OU=function(s,a,u,f){return f==0?[]:(u*=u,s=s.D(),(a=d.h.zc(s,a))<=u?(u=[],(f=new d.bm).by(s.x,s.y,0,Math.sqrt(a)),u[0]=f):u=[],u)},l.prototype.oU=function(s,a,u,f){if(f==0)return[];var y=s.vb(0),v=s.I();s=[],u*=u;for(var _=0;_<v;_++){var M=y.read(2*_),$=y.read(2*_+1),T=a.x-M,A=a.y-$;(T=T*T+A*A)<=u&&((A=new d.bm).by(M,$,_,Math.sqrt(T)),s.push(A))}return a=s.length,s.sort(function(R,D){return R.La<D.La?-1:R.La==D.La?0:1}),f>=a||(s.length=f),s.slice(0)},l.instance=null,l}(d.Ge);d.Hx=S}(Q||(Q={})),function(d){var O=function(S){function p(){return S!==null&&S.apply(this,arguments)||this}return Pe(p,S),p.prototype.K=function(){return 4},p.prototype.W=function(l,s,a,u,f){return d.cm.tB(l,s,a,u,f)},p.local=function(){return p.instance===null&&(p.instance=new p),p.instance},p.prototype.Ku=function(l){return d.Xt.ry(l)},p.prototype.yn=function(l,s,a){d.Xt.xD(l,s,a)},p.instance=null,p}(d.Ge);d.uL=O}(Q||(Q={})),function(d){var O=function(S){function p(){return S!==null&&S.apply(this,arguments)||this}return Pe(p,S),p.prototype.K=function(){return 33},p.prototype.W=function(l,s,a,u,f){return l===1073741824?!d.vd.uB(s,a,u,4,f):d.vd.uB(s,a,u,l,f)},p.local=function(){return p.instance===null&&(p.instance=new p),p.instance},p.prototype.Ku=function(l){return d.Xt.ry(l)},p.prototype.yn=function(l,s,a){d.Xt.xD(l,s,a)},p.instance=null,p}(d.Ge);d.fj=O}(Q||(Q={})),function(d){var O=function(){function S(p,l,s,a){if(this.od=a,this.lT=s,this.za=-1,p==null)throw d.i.O();this.Ak=p,this.Oj=l}return S.prototype.next=function(){var p;if((p=this.Ak.next())!=null){if(this.za=this.Ak.Ma(),this.od!=null&&!this.od.progress(-1,-1))throw d.i.hu("user_canceled");return this.$B(p)}return null},S.prototype.Ma=function(){return this.za},S.prototype.$B=function(p){if(p==null)throw d.i.O();return d.Ix.YJ(p,this.Oj,this.lT,this.od)},S.prototype.re=function(){},S}();d.vL=O}(Q||(Q={})),function(d){var O=function(S){function p(){return S!==null&&S.apply(this,arguments)||this}return Pe(p,S),p.prototype.K=function(){return 26},p.prototype.W=function(l,s,a,u){return l instanceof d.ba?(l=new d.$c(l),this.W(l,s,a,u).next()):new d.vL(l,s,a,u)},p.prototype.ts=function(l,s,a,u,f){return 0<(u!==void 0?d.Ix.ts(l,s,a,u,f):d.Ix.ts(l,s,!1,null,a))},p.local=function(){return p.instance===null&&(p.instance=new p),p.instance},p.instance=null,p}(d.Ge);d.$l=O}(Q||(Q={})),function(d){var O=function(){function f(){this.Aq=0}return f.prototype.iX=function(y){this.Aq&=-2,this.Aq|=y?1:0},f.prototype.Yp=function(){return(1&this.Aq)!=0},f.prototype.SF=function(){return this.Yp()?0:1},f}();d.tY=O;var S=function(){},p=function(f,y,v,_){this.x=f,this.y=y,this.Ci=v,this.zm=_},l=function(){function f(y){this.Ce=y}return f.prototype.compare=function(y,v,_){return y=y.ka(_),v=this.Ce.lf.read(2*v),0>(v-=y=this.Ce.lf.read(2*y))?-1:0<v?1:0},f}(),s=function(){function f(y){this.Ce=y}return f.prototype.compare=function(y,v,_){v=this.Ce.hb[v],y=this.Ce.hb[y.ka(_)];var M=v.Yp(),$=y.Yp();_=v.oe.Me(this.Ce.Oo,0);var T=y.oe.Me(this.Ce.Oo,0);return _==T&&((M=.5*((_=Math.min(M?v.oe.oa:v.oe.ma,$?y.oe.oa:y.oe.ma))-this.Ce.Oo)+this.Ce.Oo)==this.Ce.Oo&&(M=_),_=v.oe.Me(M,0),T=y.oe.Me(M,0)),_<T?-1:_>T?1:0},f}(),a=function(){function f(y,v){this.TI=new d.h,this.parent=y,this.ZR=v}return f.prototype.qr=function(y,v,_){var M=this.parent,$=this.ZR;_.Wd(y,v,function(T,A){return M.Oh(T,A,$)})},f.prototype.bq=function(y){return y=this.parent.ii.get(y),this.parent.lf.uc(2*(y>>1),this.TI),this.TI.y+((1&y)!=0?this.parent.Qj:-this.parent.Qj)},f}(),u=function(){function f(y,v,_,M,$){this.iH=y.description,this.Y=y,this.Sg=v,this.Qj=d.ua.mj(this.Sg,y,!1),this.Do=d.ua.mj(this.Sg,y,!0),this.sA=_,this.jT=this.iH.Ba,this.hb=[],this.ro=[],this.oh=new d.lp,this.fb=new d.$j,this.le=new d.Nd,this.UG=this.sl=$}return f.prototype.$S=function(){return this.UG=!0,(!d.ba.Ic(this.Y.K())||this.BE()&&this.yE(!1))&&this.hO()?d.ba.Ic(this.Y.K())?this.kO()?this.Y.K()==1607?this.mO()?2:0:this.nO()?this.oO():0:0:2:0},f.prototype.fC=function(y,v){var _=this.lf.read(2*y);y=this.lf.read(2*y+1);var M=this.lf.read(2*v);v=this.lf.read(2*v+1);var $=!d.$t.Ev(_,y,M,v,this.Qj*this.Qj);return $||this.Y.Eb()!=0&&_==M&&y==v},f.prototype.BE=function(){for(var y=this.Y,v=y.yf?3:2,_=0,M=y.ea();_<M;_++)if(y.Ka(_)<v)return this.le=new d.Nd(1,_,0),!1;return!0},f.prototype.yE=function(y){var v=this.Y,_=v.Ha(),M=v.hasAttribute(1);for(v=M?d.ua.rE(this.Sg,v,!1):0;_.ab();)for(;_.Ia();){var $=_.ia();if(!($.Rb()>this.Qj)){if(y&&M){var T=$.yv(1,0);if($=$.yv(1,0),Math.abs($-T)>v)continue}return this.le=new d.Nd(2,_.xb(),-1),!1}}return!0},f.prototype.hO=function(){var y=this.Y,v=null;d.ba.Ic(this.Y.K())&&(v=this.Y);var _=(this.UG||this.sl)&&v!=null,M=y.I();this.lf=y.vb(0),this.ii=new d.ja(0),this.ii.Jb(2*M),this.hi=new d.ja(0),this.hi.Jb(2*M),_&&(this.Hl==null&&(this.Hl=new d.ja(0)),this.Hl.Jb(M));for(var $=y=0;$<M;$++)if(this.ii.add(2*$),this.ii.add(2*$+1),this.hi.add(2*$),this.hi.add(2*$+1),_){for(;$>=v.Wc(y);)y++;this.Hl.add(y)}for(new d.Zt().sort(this.hi,0,2*M,new a(this,_)),this.fb.clear(),this.fb.Xo(new l(this)),this.fb.Ee(M),v=0,M*=2;v<M;v++)if(_=this.hi.get(v),_=(y=this.ii.get(_))>>1,(1&y)==0){if(y=this.fb.addElement(_,-1),($=this.fb.xe(y))!=-1&&!this.fC(this.fb.ka($),_))return this.le=new d.Nd(3,_,this.fb.ka($)),!1;var T=this.fb.lb(y);if(T!=-1&&!this.fC(this.fb.ka(T),_))return this.le=new d.Nd(3,_,this.fb.ka(T)),!1}else if(y=this.fb.search(_,-1),$=this.fb.xe(y),T=this.fb.lb(y),this.fb.wd(y,-1),$!=-1&&T!=-1&&!this.fC(this.fb.ka($),this.fb.ka(T)))return this.le=new d.Nd(3,this.fb.ka($),this.fb.ka(T)),!1;return!0},f.prototype.kO=function(){return 10>this.Y.I()?this.iO():this.jO()},f.prototype.jO=function(){var y=new d.hd;y.Ib(this.Y);var v=new d.Nd;return!d.bu.fI(!1,y,this.Qj,v,this.od)||(v.Lo=y.Va(v.Lo),v.Mo=y.Va(v.Mo),this.le.Yt(v),!1)},f.prototype.iO=function(){var y=this.Y,v=y.Ha();for(y=y.Ha();v.ab();)for(;v.Ia();){var _=v.ia();if(!v.Sn()||!v.VS()){y.wW(v);do for(;y.Ia();){var M=y.ia();if((M=_.Br(M,this.Qj,!0))!=0)return this.le=new d.Nd(M==2?5:4,v.xb(),y.xb()),!1}while(y.ab())}}return!0},f.prototype.nO=function(){var y=this.Y;this.hb.length=0,this.ro.length=0,this.ag=y.Ha(),this.ag.EB();var v=new d.ja(0);v.Jb(10);var _=NaN,M=0,$=0;for(y=2*y.I();$<y;$++){var T=this.hi.get($);if((1&(T=this.ii.get(T)))==0){T>>=1;var A=this.lf.read(2*T),R=this.lf.read(2*T+1);if(v.size!=0&&(A!=_||R!=M)){if(!this.LI(v))return!1;v!=null&&v.clear(!1)}v.add(T),_=A,M=R}}return!!this.LI(v)},f.prototype.mO=function(){for(var y=this.Y,v=Array(y.ea()),_=0,M=y.ea();_<M;_++)v[_]=y.Pn(_);M=new S;var $=new d.h;_=this.hi.get(0);var T=(_=this.ii.get(_))>>1;this.lf.uc(2*T,$);var A=v[_=this.Hl.get(T)],R=y.Ca(_),D=y.Wc(_)-1;M.gl=T==R||T==D,M.jy=this.sl?!A&&M.gl:M.gl,M.Ci=_,M.x=$.x,M.y=$.y,M.zm=T;for(var V=new S,Z=1,ee=this.hi.size;Z<ee;Z++)if(_=this.hi.get(Z),(1&(_=this.ii.get(_)))==0){T=_>>1,this.lf.uc(2*T,$),(_=this.Hl.get(T))!=M.Ci&&(A=v[_],R=y.Ca(_),D=y.Wc(_)-1);var G=T==R||T==D,re=this.sl?!A&&M.gl:M.gl;if(V.x=$.x,V.y=$.y,V.Ci=_,V.zm=T,V.jy=re,V.gl=G,V.x==M.x&&V.y==M.y){if(this.sl){if(!(V.jy&&M.jy||V.Ci==M.Ci&&(V.gl||M.gl)))return this.le=new d.Nd(8,V.zm,M.zm),!1}else if(!V.gl||!M.gl)return this.le=new d.Nd(5,V.zm,M.zm),!1}_=M,M=V,V=_}return!0},f.prototype.EE=function(){for(var y=this.Y,v=[],_=-1,M=!1,$=0,T=y.ea();$<T;$++)y.Gv($)&&(M=!1,_++,$<T-1&&(y.Gv($+1)||(M=!0))),v[$]=M?_:-1;M=new d.h,$=this.hi.get(0);var A=($=this.ii.get($))>>1;this.lf.uc(2*A,M),$=this.Hl.get(A),_=new p(M.x,M.y,$,A,v[$]),y=[];var R=1;for(T=this.hi.size;R<T;R++)if($=this.hi.get(R),(1&($=this.ii.get($)))==0){if(A=$>>1,this.lf.uc(2*A,M),$=this.Hl.get(A),($=new p(M.x,M.y,$,A,v[$])).x==_.x&&$.y==_.y){if($.Ci==_.Ci)return this.le=new d.Nd(9,$.zm,_.zm),!1;0<=v[$.Ci]&&v[$.Ci]==v[_.Ci]&&(y.length!=0&&y[y.length-1]==_||y.push(_),y.push($))}_=$}if(y.length==0)return!0;for($=new d.lp(!0),d.P.bv(v,-1),M=-1,(R=new d.h).Sc(),_=0,T=y.length;_<T;_++){(A=y[_]).x==R.x&&A.y==R.y||(M=$.Rh(0),R.x=A.x,R.y=A.y);var D=v[A.Ci];D==-1&&(D=$.Rh(2),v[A.Ci]=D),$.addElement(D,M),$.addElement(M,D)}for((T=new d.ja(0)).Jb(10),_=$.ke;_!=-1;_=$.lz(_))if((1&(y=$.KF(_)))==0&&(2&y)!=0){for(y=-1,T.add(_),T.add(-1);0<T.size;){if(M=T.Gc(),T.Jf(),R=T.Gc(),T.Jf(),(1&(A=$.KF(R)))!=0){y=(2&A)==0?M:R;break}for($.aX(R,1|A),A=$.sc(R);A!=-1;A=$.lb(A))(D=$.getData(A))!=M&&(T.add(D),T.add(R))}if(y!=-1){for($=-1,_=0,T=v.length;_<T;_++)if(v[_]==y){$=_;break}return this.le=new d.Nd(10,$,-1),!1}}return!0},f.prototype.oO=function(){var y=this.Y;if(0>=y.He())return this.le=new d.Nd(6,y.ea()==1?1:-1,-1),0;if(y.ea()==1)return this.sl&&!this.EE()?0:2;this.vo=d.ja.rf(y.ea(),0),this.EA=d.ja.rf(y.ea(),-1);for(var v=-1,_=0,M=0,$=y.ea();M<$;M++){var T=y.Kr(M);if(this.vo.write(M,0>T?0:256),0<T)v=M,_=T;else{if(T==0)return this.le=new d.Nd(6,M,-1),0;if((0>v||_<Math.abs(T))&&(this.le=new d.Nd(7,M,-1),this.sl))return 0;this.EA.write(M,v)}}for(this.et=y.ea(),this.Qm=new d.ja(0),this.Qm.Jb(10),$=y.I(),this.Oo=NaN,(y=new d.ja(0)).Jb(10),this.Sq=d.ja.rf($,-1),this.Jw=d.ja.rf($,-1),this.Bj!=null?this.Bj.clear(!1):this.Bj=new d.ja(0),this.Bj.Jb(10),this.fb.clear(),this.fb.Xo(new s(this)),v=0,$*=2;0<this.et&&v<$;v++)if(_=this.hi.get(v),(1&(_=this.ii.get(_)))==0){if(_>>=1,(M=this.lf.read(2*_+1))!=this.Oo&&y.size!=0){if(!this.vt(y))return 0;y!=null&&y.clear(!1)}y.add(_),this.Oo=M}return 0<this.et&&!this.vt(y)?0:this.sl?this.le.Lj==0&&this.EE()?2:0:this.le.Lj==0?2:1},f.prototype.LI=function(y){if(y.size==1)return!0;for(var v=0,_=y.size;v<_;v++){var M=y.get(v);this.ag.Wb(M);var $=this.ag.ni();this.hb.push(this.Uu($,M,this.ag.gb,!0)),this.ag.ia(),$=this.ag.ia(),this.hb.push(this.Uu($,M,this.ag.gb,!1))}var T=this;for(this.hb.sort(function(D,V){return T.SP(D,V)}),(M=this.oh.ke)==-1&&(M=this.oh.Rh(0)),this.oh.hn(this.hb.length),v=0,_=this.hb.length;v<_;v++)this.oh.addElement(M,v);v=!0;for(var A=_=-1;v&&(v=!1,($=this.oh.sc(M))!=-1);)for(var R=this.oh.lb($);R!=-1;)if(_=this.oh.getData($),A=this.oh.getData(R),(_=this.hb[_].Ko)!=(A=this.hb[A].Ko))$=R,R=this.oh.lb($);else if(v=!0,this.oh.kd(M,$),$=this.oh.xe(R),(R=this.oh.kd(M,R))==-1||$==-1)break;if(v=this.oh.ds(M),this.oh.GE(M),0<v)return this.le=new d.Nd(5,_,A),!1;for(v=0,_=y.size;v<_;v++)this.qB(this.hb[v]);return this.hb.length=0,!0},f.prototype.vt=function(y){for(var v=0,_=y.size;v<_;v++){var M=y.get(v),$=this.Sq.read(M);if($!=-1){var T=this.fb.ka($);this.Bj.add(T),this.fb.wd($,-1),this.qB(this.hb[T]),this.hb[T]=null,this.Sq.write(M,-1)}($=this.Jw.read(M))!=-1&&(T=this.fb.ka($),this.Bj.add(T),this.fb.wd($,-1),this.qB(this.hb[T]),this.hb[T]=null,this.Jw.write(M,-1))}for(v=0,_=y.size;v<_;v++){if(M=y.get(v),this.ag.Wb(M),($=this.ag.ni()).oa>$.ma){var A=this.ag.xb(),R=this.Uu($,M,this.ag.gb,!0);0<this.Bj.size?(T=this.Bj.Gc(),this.Bj.Jf(),this.hb[T]=R):(T=this.hb.length,this.hb.push(R)),$=this.fb.addElement(T,-1),this.Sq.read(A)==-1?this.Sq.write(A,$):this.Jw.write(A,$),(3&this.vo.read(this.ag.gb))==0&&this.Qm.add($)}this.ag.ia(),($=this.ag.ia()).oa<$.ma&&(A=this.ag.kk(),R=this.Uu($,M,this.ag.gb,!1),0<this.Bj.size?(T=this.Bj.Gc(),this.Bj.Jf(),this.hb[T]=R):(T=this.hb.length,this.hb.push(R)),$=this.fb.addElement(T,-1),this.Sq.read(A)==-1?this.Sq.write(A,$):this.Jw.write(A,$),(3&this.vo.read(this.ag.gb))==0&&this.Qm.add($))}for(v=0,_=this.Qm.size;v<_&&0<this.et;v++)if($=this.Qm.get(v),(3&this.vo.read(this.hb[this.fb.ka($)].DA))==0){y=-1,M=this.fb.xe($);var D=$;R=null,T=-1;for(var V=0;M!=-1&&(T=this.fb.ka(M),T=(R=this.hb[T]).DA,(3&(V=this.vo.read(T)))==0);)D=M,M=this.fb.xe(M);M==-1?(A=1,M=D):(y=(3&V)==1?T:this.EA.read(T),A=R.SF()!=0?0:1,M=this.fb.lb(M));do{if(T=this.fb.ka(M),T=(R=this.hb[T]).DA,(3&(D=this.vo.read(T)))==0){if(A!=R.SF())return this.le=new d.Nd(6,T,-1),!1;if(D=252&D|(V=A==0||R.Yp()?2:1),this.vo.write(T,V),V==2&&this.le.Lj==0&&this.EA.read(T)!=y&&(this.le=new d.Nd(7,T,-1),this.sl))return!1;if(this.et--,this.et==0)return!0}(3&D)==1&&(y=T),D=M,M=this.fb.lb(M),A=A!=0?0:1}while(D!=$)}return this.Qm!=null?this.Qm.clear(!1):this.Qm=new d.ja(0),!0},f.prototype.Uu=function(y,v,_,M){if(y.K()!=322)throw d.i.Ra();return(y=this.nP(y)).Ko=v,y.DA=_,y.Aq=0,y.iX(M),y},f.prototype.nP=function(y){if(0<this.ro.length){var v=this.ro[this.ro.length-1];--this.ro.length,y.copyTo(v.oe)}else(v=new O).oe=d.NC.kg(y);return v},f.prototype.qB=function(y){y.oe.K()==322&&this.ro.push(y)},f.prototype.fU=function(){for(var y=this.Y.I(),v=new d.ja(0),_=0;_<y;_++)v.add(_);var M=this;for(v.Wd(0,y,function($,T){return M.Qu($,T)}),_=1;_<y;_++)if(this.Qu(v.get(_-1),v.get(_))==0)return this.le=new d.Nd(3,v.get(_-1),v.get(_)),0;return 2},f.prototype.EV=function(){return this.BE()&&this.yE(!0)?2:0},f.prototype.jV=function(){return this.$S()},f.prototype.kU=function(){for(var y=this.Y.I(),v=new d.ja(0),_=0;_<y;_++)v.add(_);var M=this;v.Wd(0,y,function(D,V){return M.KO(D,V)});var $=Array(y);for(d.P.bv($,!1),$[v.get(0)]=!0,_=1;_<y;_++){var T=v.get(_-1),A=v.get(_);this.Qu(T,A)==0?$[A]=!1:$[A]=!0}v=this.Y.Ja(),T=this.Y,A=0;var R=1;for(_=0;_<y;_++)$[_]?R=_+1:(A<R&&v.Gd(T,A,R),A=_+1);return A<R&&v.Gd(T,A,R),v.Eh(2,this.Do),v},f.prototype.IV=function(){var y=this.Y,v=y.Ha(),_=y.Ha(),M=this.Y.Ja(),$=this.Y,T=y.hasAttribute(1),A=T?d.ua.rE(this.Sg,y,!0):0,R=new d.ja(0),D=new d.ja(0);for(R.Jb(d.P.truncate(y.I()/2+1)),D.Jb(d.P.truncate(y.I()/2+1));v.ab();)if(_.ab(),!(2>y.Ka(v.gb))){_.yW();for(var V,Z,ee=!0;v.Ia();){var G=v.ia(),re=_.ni();if(v.xb()>_.xb())break;ee&&(R.add(v.xb()),D.add(_.kk()),ee=!1),Z=R.Gc();var oe=v.kk();if(1<oe-Z){var se=new d.h;se.vc(y.Oa(Z),y.Oa(oe)),V=se.length()}else V=G.Rb();Z=D.Gc(),1<(oe=_.xb())-Z?((se=new d.h).vc(y.Oa(Z),y.Oa(oe)),Z=se.length()):Z=re.Rb(),V>this.Do?R.add(v.kk()):T&&(V=y.Vc(1,R.Gc(),0),G=G.jv(1,0),Math.abs(G-V)>A&&R.add(v.kk())),Z>this.Do?D.add(_.xb()):T&&(V=y.Vc(1,D.Gc(),0),G=re.jv(1,0),Math.abs(G-V)>A&&D.add(_.xb()))}if(R.Gc()<D.Gc()?R.size>D.size?R.Jf():D.Jf():(R.Gc()!=D.Gc()&&D.Jf(),D.Jf()),2<=D.size+R.size){for(ee=new d.Ta,re=0,G=R.size;re<G;re++)$.we(R.get(re),ee),re==0?M.nf(ee):M.lineTo(ee);for(re=D.size-1;0<re;re--)$.we(D.get(re),ee),M.lineTo(ee);$.ec(v.gb)?M.Cp():0<D.size&&($.we(D.get(0),ee),M.lineTo(ee))}R!=null&&R.clear(!1),D!=null&&D.clear(!1)}return M.Eh(2,this.Do),M},f.prototype.mV=function(){return this.zX()},f.prototype.zX=function(){return this.Y.K()==1736&&this.Y.Kn()==1?d.Hg.Ok(this.Y,this.Do,!0,!1,this.od):(this.Ji=new d.hd,this.Ji.Ib(this.Y),this.Ji.gd!=0&&(this.sA!=1&&d.Vk.W(this.Ji,this.Do,this.od,!0),this.Y.K()==1736&&d.tn.W(this.Ji,this.Ji.md,this.sA,!1,this.od)),this.Y=this.Ji.Ke(this.Ji.md),this.Y.K()==1736&&(this.Y.hm(),this.Y.$o(0)),this.Y.Eh(2,this.Do),this.Y)},f.ts=function(y,v,_,M,$){if(M!=null&&(M.Lj=0,M.Lo=-1,M.Mo=-1),y.B())return 1;var T=y.K();if(T==33)return 1;var A=d.ua.mj(v,y,!1);if(T==197)return v=new d.l,y.A(v),v.Di(A)?(M!=null&&(M.Lj=2,M.Lo=-1,M.Mo=-1),0):1;if(d.ba.zd(T))return(A=new d.Ua(y.description)).pc(y,!0),f.ts(A,v,_,M,$);var R=y.qm(A);if((_=_?-1:R)!=-1)return _;if(v=new f(y,v,_,$,!1),T==550)_=v.fU();else if(T==1607)_=v.EV();else{if(T!=1736)throw d.i.Ra();_=v.jV()}return y.Eh(_,A),M!=null&&_==0&&M.Yt(v.le),_},f.YJ=function(y,v,_,M){if(y.B())return y;var $=y.K();if($==33)return y;var T=d.ua.mj(v,y,!1);if($==197)return v=new d.l,y.A(v),v.Di(T)?y.Ja():y;if(d.ba.zd($))return($=new d.Ua(y.description)).pc(y,!0),f.YJ($,v,_,M);if(T=y.qm(T),(_=_?-1:T)==2)return y;if(y=new f(y,v,_,M,!1),$==550)y=y.kU();else if($==1607)y=y.IV();else{if($!=1736)throw d.i.Ra();y=y.mV()}return y},f.prototype.Oh=function(y,v,_){if(y==v)return 0;y=this.ii.get(y);var M=this.ii.get(v);v=y>>1;var $=M>>1,T=new d.h,A=new d.h;return this.lf.uc(2*v,T),T.y+=(1&y)!=0?this.Qj:-this.Qj,this.lf.uc(2*$,A),A.y+=(1&M)!=0?this.Qj:-this.Qj,(y=T.compare(A))==0&&_?0>(_=this.Hl.get(v)-this.Hl.get($))?-1:0<_?1:0:y},f.prototype.Qu=function(y,v){if(y==v)return 0;var _=this.Y,M=_.Oa(y),$=_.Oa(v);if(M.x<$.x)return-1;if(M.x>$.x)return 1;if(M.y<$.y)return-1;if(M.y>$.y)return 1;for(M=1;M<this.jT;M++){$=this.iH.ld(M);for(var T=d.sa.Wa($),A=0;A<T;A++){var R=_.Vc($,y,A),D=_.Vc($,v,A);if(R<D)return-1;if(R>D)return 1}}return 0},f.prototype.KO=function(y,v){var _=this.Qu(y,v);return _==0?y<v?-1:1:_},f.prototype.SP=function(y,v){if(y===v)return 0;var _=y.oe.lg();y.Yp()&&_.Uq(),y=v.oe.lg(),v.Yp()&&y.Uq(),v=_.su();var M=y.su();return M==v?(v=_.yi(y),Math.abs(v)<=8881784197001252e-31*(Math.abs(y.x*_.y)+Math.abs(y.y*_.x))&&(v--,v++),0>v?1:0<v?-1:0):v<M?-1:1},f}();d.Ix=u}(Q||(Q={})),function(d){var O=function(S){function p(){return S!==null&&S.apply(this,arguments)||this}return Pe(p,S),p.prototype.K=function(){return 30},p.local=function(){return p.instance===null&&(p.instance=new p),p.instance},p.prototype.W=function(l,s,a,u){return l instanceof d.ba?(l=new d.$c(l),s=new d.$c(s),this.W(l,s,a,u).next()):new d.wL(l,s,a,u)},p.gp=function(l,s,a,u){var f=l.Eb(),y=s.Eb();if(l.B()&&s.B())return f>y?l:s;if(l.B())return s;if(s.B())return l;var v=new d.l,_=new d.l,M=new d.l;return l.A(v),s.A(_),M.L(v),M.$b(_),v=d.ua.Xd(a,M,!0),_=l.K(),M=s.K(),_==33&&M==33?p.WU(l,s,v):_!=M?0<f||0<y?f>y?l:s:_==550?p.dI(l,s,v):p.dI(s,l,v):d.Hg.gp(l,s,a,u)},p.WU=function(l,s,a){a=a*Math.sqrt(2)*1.00001,a*=a;var u=l.D(),f=s.D(),y=new d.ee(l.description);return d.h.zc(u,f)>a&&(y.add(l),y.add(s)),y},p.dI=function(l,s,a){var u=l.vb(0),f=l.I(),y=s.D(),v=l.Ja();a=a*Math.sqrt(2)*1.00001;var _=new d.l;if(l.A(_),_.X(a,a),_.contains(y)){a*=a,_=!1;for(var M=[],$=0;$<f;$++)M[$]=!1;for($=0;$<f;$++){var T=u.read(2*$),A=u.read(2*$+1);(T-=y.x)*T+(A-=y.y)*A<=a&&(_=!0,M[$]=!0)}if(_)for($=0;$<f;$++)M[$]||v.Gd(l,$,$+1);else v.Gd(l,0,f),v.add(s)}else v.Gd(l,0,f),v.add(s);return v},p.instance=null,p}(d.Ge);d.Jx=O}(Q||(Q={})),function(d){var O=function(){function S(p,l,s,a){this.vs=l==null,this.za=-1,this.Sd=p,this.wg=s,this.IT=l.next(),this.Vb=a}return S.prototype.next=function(){return this.vs?null:(p=this.Sd.next())!=null?(this.za=this.Sd.Ma(),d.Jx.gp(p,this.IT,this.wg,this.Vb)):null;var p},S.prototype.Ma=function(){return this.za},S.prototype.re=function(){},S}();d.wL=O}(Q||(Q={})),function(d){var O=function(){function l(){}return l.prototype.Az=function(){this.Vy=null,this.zx=-1,this.vK=!1},l}(),S=function(){function l(){this.Ir=0,this.rj=[]}return l.prototype.kN=function(s){this.Ir+=s.zx,this.rj.push(s)},l.prototype.OV=function(){this.Ir-=this.rj[this.rj.length-1].zx,--this.rj.length},l.prototype.iy=function(){return this.rj[this.rj.length-1]},l.prototype.Nb=function(s){return s===this},l}(),p=function(){function l(s,a,u){this.za=-1,this.Jc=!1,this.vH=[!1,!1,!1,!1],this.wq=[0,0,0,0],this.eA=!1,this.Bk=-1,this.kq=0,this.eo=-1,this.Fo=[],this.Sd=s,this.wg=a,this.Vb=u}return l.ZD=function(s){var a=[],u=0;for(s=Object.keys(s);u<s.length;u++)a.push(Number(s[u]));return a.sort(function(f,y){return f-y}),a},l.prototype.aG=function(s){var a=this.Fo[s],u=l.ZD(a)[0],f=a[u],y=f.iy().Vy;return f=f.iy().vK,delete a[u],f&&(y=d.$l.local().W(y,this.wg,!1,this.Vb),s==0&&y.K()==33&&(s=new d.ee(y.description),y.B()||s.add(y),y=s)),y},l.prototype.next=function(){if(this.Jc&&this.eo==this.Bk)return null;for(;!this.lK(););if(this.Bk==-1)return null;if(this.eA){for(this.eo++;;){if(this.eo>this.Bk||0>this.eo)throw d.i.Ra();if(this.vH[this.eo])break}return this.za++,this.aG(this.eo)}return this.za=0,this.eo=this.Bk,this.aG(this.Bk)},l.prototype.Ma=function(){return this.za},l.prototype.lK=function(){if(this.Jc)return!0;var s=null;if(this.Sd!=null&&(s=this.Sd.next())==null&&(this.Jc=!0,this.Sd=null),d.op.Bp(this.Vb),s!=null){var a=s.Eb();this.vH[a]=!0,a>=this.Bk&&!this.eA&&(this.HD(a,!1,s),a>this.Bk&&!this.eA&&this.uW(a))}if(0<this.kq)for(a=0;a<=this.Bk;a++)for(;1<this.wq[a]&&(s=this.AO(a)).length!=0;)s=d.Hg.QP(s,this.wg,this.Vb),this.HD(a,!0,s);return this.Jc},l.prototype.AO=function(s){for(var a=[],u=[],f=this.Fo[s],y=l.ZD(f),v=0;v<y.length;v++){var _=y[v],M=f[_];if(this.Jc||1e4<M.Ir&&1<M.rj.length){for(this.wq[s]-=M.rj.length,this.kq-=M.rj.length;0<M.rj.length;)a.push(M.iy().Vy),M.OV();u.push(_)}}for(v=0;v<u.length;v++)delete f[u[v]];return a},l.prototype.uW=function(s){for(var a=0;a<s;a++)this.Fo[a]=[],this.kq-=this.wq[a],this.wq[a]=0},l.prototype.HD=function(s,a,u){var f=new O;if(f.Az(),f.Vy=u,u=l.$R(u),f.zx=u,u=l.YR(u),s+1>this.Fo.length)for(var y=0,v=Math.max(2,s+1);y<v;y++)this.Fo.push([]);(y=this.Fo[s][u])===void 0&&(y=new S,this.Fo[s][u]=y),f.vK=a,y.kN(f),this.wq[s]++,this.kq++,this.Bk=Math.max(this.Bk,s)},l.YR=function(s){return 0<s?d.P.truncate(Math.log(s)/Math.log(4)+.5):0},l.$R=function(s){var a=s.K();if(d.ba.zj(a))return s.I();if(a==33)return 1;if(a==197)return 4;if(d.ba.zd(a))return 2;throw d.i.Ra()},l.prototype.re=function(){this.lK()},l}();d.yL=p}(Q||(Q={})),function(d){var O=function(S){function p(){return S!==null&&S.apply(this,arguments)||this}return Pe(p,S),p.prototype.K=function(){return 1},p.prototype.W=function(l,s,a,u){return u===void 0?new d.yL(l,s,a):this.bQ(l,s,a,u)},p.prototype.bQ=function(l,s,a,u){return l=new d.$c([l,s]),this.W(l,a,u).next()},p.local=function(){return p.instance===null&&(p.instance=new p),p.instance},p.instance=null,p}(d.Ge);d.Ih=O}(Q||(Q={})),function(d){var O,S;(S=O||(O={}))[S.nextPath=0]="nextPath",S[S.nextSegment=1]="nextSegment",S[S.iterate=2]="iterate",O=function(){function p(l,s,a,u){this.Vs=new d.l,this.BT=l,this.CT=s,this.oq=u,this.wo=-1,this.tl=!1;var f=l.Cb;f!=null&&(f=u?f.Bo:f.Gb)!=null&&(this.Jc=!1,this.ra=a,this.Gb=f,this.zw=this.Gb.getIterator(),this.pq=this.tl=!0,this.Yb=0,u?this.wo=s.ea():this.td=s.Ha()),this.tl||(f=s.Cb)!=null&&(f=u?f.Bo:f.Gb)!=null&&(this.Jc=!1,this.ra=a,this.Gb=f,this.zw=this.Gb.getIterator(),this.tl=!0,this.pq=!1,this.Yb=0,u?this.wo=l.ea():this.td=l.Ha()),this.tl||(this.ei=u?d.ua.hR(l,s,a,1<=l.qm(0),1<=s.qm(0)):d.ua.gR(l,s,a))}return p.prototype.next=function(){if(this.tl){if(this.Jc)return!1;for(var l=!0;l;)switch(this.Yb){case 0:l=this.sU();break;case 1:l=this.tU();break;case 2:l=this.Pz();break;default:throw d.i.ga("internal error")}return!this.Jc}return this.ei!=null&&this.ei.next()},p.prototype.pl=function(){return this.tl?this.pq?this.Gb.ka(this.Hs):this.oq?this.wo:this.td.xb():this.ei.pl(this.ei.Xf)},p.prototype.jl=function(){return this.tl?this.pq?this.oq?this.wo:this.td.xb():this.Gb.ka(this.Hs):this.ei.jl(this.ei.Bf)},p.prototype.oz=function(){if(!this.oq)throw d.i.ga("internal error");return this.tl?this.pq?this.Gb.BF(this.Hs):this.Vs:this.ei.oz(this.ei.Xf)},p.prototype.Wy=function(){if(!this.oq)throw d.i.ga("internal error");return this.tl?this.pq?this.Vs:this.Gb.BF(this.Hs):this.ei.Wy(this.ei.Bf)},p.prototype.sU=function(){return this.oq?--this.wo==-1?(this.Jc=!0,!1):(this.pq?this.CT.Tj(this.wo,this.Vs):this.BT.Tj(this.wo,this.Vs),this.zw.Zi(this.Vs,this.ra),this.Yb=2,!0):this.td.ab()?(this.Yb=1,!0):(this.Jc=!0,!1)},p.prototype.tU=function(){if(!this.td.Ia())return this.Yb=0,!0;var l=this.td.ia();return this.zw.Wo(l,this.ra),this.Yb=2,!0},p.prototype.Pz=function(){return this.Hs=this.zw.next(),this.Hs==-1&&(this.Yb=this.oq?0:1,!0)},p}(),d.am=O}(Q||(Q={})),function(d){(d=d.JL||(d.JL={}))[d.enumClosed=1]="enumClosed",d[d.enumHasNonlinearSegments=2]="enumHasNonlinearSegments",d[d.enumOGCStartPolygon=4]="enumOGCStartPolygon",d[d.enumCalcMask=4]="enumCalcMask"}(Q||(Q={})),function(d){d.LC=function(){function O(){}return O.ub=function(S,p,l,s,a,u,f,y,v){var _=[0,0,0],M=[0,0,0],$=[0,0,0],T=[0,0,0,0],A=new d.ha(0),R=new d.ha(0),D=new d.ha(0);if(f!=null||y!=null||v!=null)if(d.s.vi(p))d.$g.ub(S,l,s,a,u,f,y,v);else{a=d.F.ca(a),l=d.F.ca(l);var V=d.F.ca(a-l);if(d.s.$(s,u)&&(d.s.$(l,a)||d.s.$(d.s.R(s),1.570796326794897)))f!=null&&(f.u=0),y!=null&&(y.u=0),v!=null&&(v.u=0);else{if(d.s.$(s,-u)){if(d.s.$(d.s.R(s),1.570796326794897))return f!=null&&(f.u=2*d.F.Ch(S,p)),y!=null&&(y.u=0<s?d.F.ca(3.141592653589793-d.F.ca(a)):d.F.ca(a)),void(v!=null&&(v.u=0<s?d.F.ca(a):d.F.ca(3.141592653589793-d.F.ca(a))));d.s.$(d.s.R(V),3.141592653589793)&&(f!=null&&(f.u=2*d.F.Ch(S,p)),y!=null&&(y.u=0),v!=null&&(v.u=0))}else if(d.s.$(d.s.R(s),1.570796326794897)||d.s.$(d.s.R(u),1.570796326794897)||d.s.$(l,a)||d.s.$(d.s.R(V),3.141592653589793)||d.s.Dd(s))return void d.Yk.ub(S,p,l,s,a,u,f,y,v);var Z=Math.sqrt(1-p);a=d.F.ca(a-l),l=0,d.F.el(1,p,s,l,0,A,R,D),_[0]=A.u,_[1]=R.u,_[2]=D.u,d.F.el(1,p,u,a,0,A,R,D),M[0]=A.u,M[1]=R.u,M[2]=D.u,$[0]=0,$[1]=0,$[2]=-1*p*d.F.n(1,p,s)*Math.sin(s),0>a?d.F.Yq($,M,_,T,0):d.F.Yq($,_,M,T,0),R=[0,0,0],D=[0,0,0];var ee=[0,0,0];_=[0,0,0],A=[0,0,0];var G=Math.acos(T[2]/1),re=1-p,oe=Math.tan(G),se=1+oe*oe/re,ge=2*$[2]*oe/re;for(re=(-ge+(oe=Math.sqrt(ge*ge-4*se*($[2]*$[2]/re-1))))/(se*=2),ge=(-ge-oe)/se,oe=Math.tan(G),G=(re+ge)/2,$=((se=oe*re+$[2])+(oe*ge+$[2]))/2,oe=d.F.ip(re-G,se-$),re=$/Z*1.570796326794897,ge=0;100>ge&&(se=(se=d.F.w(p,re))*se/Math.cos(re)*(Math.sin(re)-$*se/(1-p)),!d.s.Dd(se));ge++)re-=se;$=d.F.n(1,p,re)*Math.cos(re),oe=1-oe/($=Math.sqrt(($-G)*($+G))),oe*=2-oe,se=d.F.qn(R),G=d.F.qn(D),re=d.F.qn(ee);var me=d.F.Ut(ee,R);ge=d.F.Ut(ee,D),d.F.yx(ee,R,_),d.F.yx(ee,D,A),R=Math.acos(me/(re*se)),D=Math.acos(ge/(re*G)),D*=d.s.Mb(1,d.F.Ut(_,A)),(1.570796326794897<=d.s.R(R)&&1.570796326794897<=d.s.R(D)||3.141592653589793<d.s.R(R-D))&&(R=(3.141592653589793-d.s.R(R))*d.s.Mb(1,R),D=(3.141592653589793-d.s.R(D))*d.s.Mb(1,D)),_=d.F.Sj(oe,D),A=d.F.q($,oe,d.F.Sj(oe,R)),_=d.F.q($,oe,_),_=d.s.R(_-A)*S,R=new d.ha(0),D=new d.ha(0),ee=T[1]/1,ee*=-d.s.Mb(1,V),A=Math.acos(ee)*d.s.Mb(1,V),O.sf(S,p,l,s,_,A,R,D),d.s.$(a,R.u)&&d.s.$(u,D.u)||(oe=d.F.ip(d.F.ca(a-R.u),u-D.u),O.sf(S,p,l,s,_,d.F.ca(A+3.141592653589793),R,D),(se=d.F.ip(d.F.ca(a-R.u),u-D.u))<oe&&(A=d.F.ca(A+3.141592653589793))),R=[0,0,0,0],D=[0,0,0,0],oe=[0,0,0],S=[0,0,0],l=[0,0,0],s=[0,0,0],ee=[0,0,0],($=[0,0,0])[0]=0,$[1]=0,$[2]=Z,oe[0]=0,oe[1]=0,oe[2]=0,d.F.Yq(oe,$,M,R,0),d.s.Dd(u)?(S[0]=M[0],S[1]=M[1],S[2]=1,l[0]=1*Math.cos(a)-1*Math.sin(a),l[1]=1*Math.sin(a)+1*Math.cos(a)):(p=d.F.n(1,p,u)*Math.cos(u),S[0]=0,S[1]=0,M[2]+=Math.tan(1.570796326794897-d.s.R(u))*p*d.s.Mb(1,u),l[0]=p*Math.cos(a)-p*Math.sin(a),l[1]=p*Math.sin(a)+p*Math.cos(a)),l[2]=M[2],d.F.Yq(M,l,S,D,1),d.F.yx(D,R,s),d.F.yx(D,T,ee),ee=d.F.Ut(s,ee)/(d.F.qn(s)*d.F.qn(ee)),ee*=d.s.Mb(1,V),a=Math.acos(ee)*-d.s.Mb(1,V),(0<A&&0<a||0>A&&0>a)&&(a=d.F.ca(a+3.141592653589793)),f!=null&&(f.u=_),y!=null&&(y.u=A),v!=null&&(v.u=a)}}},O.sf=function(S,p,l,s,a,u,f,y){var v=[0,0,0],_=[0,0,0],M=[0,0,0],$=[0,0,0],T=[0,0,0],A=[0,0,0],R=[0,0,0],D=[0,0,0,0],V=new d.ha(0),Z=new d.ha(0),ee=new d.ha(0),G=new d.ha(0),re=new d.ha(0),oe=new d.ha(0);if(f!=null&&y!=null)if(d.s.vi(p))d.$g.sf(S,l,s,a,u,f,y);else if(d.s.Dd(a))f!=null&&(f.u=l),y!=null&&(y.u=s);else if(u=d.F.ca(u),0>a&&(a=d.s.R(a),u=d.F.ca(u+3.141592653589793)),l=d.F.ca(l),s=d.F.ca(s),1.570796326794897<d.s.R(s)&&(l=d.F.ca(l+3.141592653589793),s=d.s.Mb(3.141592653589793,s)-s),d.s.$(d.s.R(s),1.570796326794897)||d.s.Dd(s)||d.s.Dd(u)||d.s.$(d.s.R(u),3.141592653589793))d.Yk.sf(S,p,l,s,a,u,f,y);else{var se=Math.sqrt(1-p);for(S=a/S,d.F.el(1,p,s,0,0,G,re,oe),v[0]=G.u,v[1]=re.u,v[2]=re.u,R[0]=0,R[1]=0,R[2]=-1*p*d.F.n(1,p,s)*Math.sin(s),G=d.F.n(1,p,s),re=d.F.ca(1.570796326794897-u),oe=Math.sin(re),a=Math.cos(s),s=Math.sin(s),T[0]=G*a-s*oe,T[1]=Math.cos(re),T[2]=(1-p)*G*s+a*oe,0>u?d.F.Yq(R,T,v,D,0):d.F.Yq(R,v,T,D,0),v=Math.acos(D[2]/1),D=Math.atan2(-D[1],-D[0]),s=1-p,re=1+(T=Math.tan(v))*T/s,s=(-(G=2*R[2]*T/s)+(T=Math.sqrt(G*G-4*re*(R[2]*R[2]/s-1))))/(re*=2),G=(-G-T)/re,T=Math.tan(v),v=(s+G)/2,R=((re=T*s+R[2])+(T*G+R[2]))/2,T=d.F.ip(s-v,re-R),se=R/se*1.570796326794897,s=0;100>s&&(G=(G=d.F.w(p,se))*G/Math.cos(se)*(Math.sin(se)-R*G/(1-p)),!d.s.Dd(G));s++)se-=G;se=d.F.n(1,p,se)*Math.cos(se),R=1-T/(se=Math.sqrt((se-v)*(se+v))),R*=2-R,A=Math.acos(d.F.Ut(A,_)/(d.F.qn(A)*d.F.qn(_))),A*=d.s.Mb(1,_[0]),u=(d.F.q(se,R,d.F.Sj(R,A))+S*d.s.Mb(1,u))/d.F.Ch(se,R),u=d.F.ca(1.570796326794897*u),u=d.F.Tq(R,u),d.F.n(se,R,u),T=d.F.ca(D+l),l=Math.cos(T),u=Math.sin(T),M[0]=$[0]*l+$[1]*-u,M[1]=$[0]*u+$[1]*l,M[2]=$[2],d.F.eO(p,M[0],M[1],M[2],ee,Z,V),f!=null&&(f.u=Z.u),y!=null&&(y.u=ee.u)}},O}()}(Q||(Q={})),function(d){var O=function(){function a(u){this.Za=null,this.xt=new d.h,this.yt=new d.h,this.g=u}return a.prototype.compare=function(u,f,y){return this.g.Hc(f,this.xt),this.g.Hc(u.ka(y),this.yt),this.xt.compare(this.yt)},a}(),S=function(){function a(u){this.Cf=new d.h,this.Fk=new d.h,this.g=u}return a.prototype.Fh=function(u){this.Cf.N(u)},a.prototype.compare=function(u,f){return this.g.Hc(u.ka(f),this.Fk),this.Cf.compare(this.Fk)},a}(),p=function(a){function u(f){var y=a.call(this,f.g,f.ra,!1)||this;return y.ib=f,y}return Pe(u,a),u.prototype.compare=function(f,y,v){if(this.sg)return-1;var _=this.ib.Rd.Ln(this.ib.Th(y));f=f.ka(v);var M=this.ib.Rd.Ln(this.ib.Th(f));return this.Fm=v,this.ME(y,_,f,M)},u}(d.PC),l=function(a){function u(f){var y=a.call(this,f.g,f.ra)||this;return y.ib=f,y}return Pe(u,a),u.prototype.compare=function(f,y){return this.sg?-1:(f=this.ib.Rd.Ln(this.ib.Th(f.ka(y))),this.Fm=y,this.NE(y,f))},u}(d.WL),s=function(){function a(){this.Nc=this.df=this.lo=this.Rd=this.nh=this.Ad=this.hb=this.g=null,this.Pg=!1,this.xh=this.Pm=this.je=this.Ik=this.ph=this.Ck=this.Gf=this.ae=null,this.zh=this.Lq=this.PA=this.ra=0,this.Zv=this.Yn=!1,this.Ao=new d.h,this.Ri=new d.h,this.hb=new d.ad(8),this.Ad=new d.ad(5),this.nh=new d.cu,this.Rd=new d.cu,this.Pg=!1,this.xh=new d.h,this.xh.na(0,0),this.ra=0,this.zh=-1,this.Yn=!1,this.g=null,this.df=new d.$j,this.Nc=new d.$j,this.ph=new d.ja(0),this.Ik=new d.OC,this.Gf=new d.ja(0),this.Ck=new d.ja(0),this.lo=new d.Ta}return a.prototype.LX=function(u,f){var y=new d.Ed;return y.VB(),u.Pc(y),this.gr(u),this.Yn=!1,this.ra=f,this.PA=f*f,f=this.eC(),u.Pc(y),f||(this.lQ(),f||this.eC()),this.zh!=-1&&(this.g.Ud(this.zh),this.zh=-1),this.g=null,this.Yn},a.prototype.PX=function(u,f){this.gr(u),this.Yn=!1,this.ra=f,this.PA=f*f,this.Pg=!1,this.eC(),this.Pg||(this.Pg=u.Ip(f,!0,!1)==1),this.zh!=-1&&(this.g.Ud(this.zh),this.zh=-1),this.g=null},a.prototype.qg=function(u,f){return this.hb.U(u,0+f)},a.prototype.GB=function(u,f,y){this.hb.T(u,0+f,y)},a.prototype.Th=function(u){return this.hb.U(u,2)},a.prototype.UW=function(u,f){this.hb.T(u,2,f)},a.prototype.MF=function(u,f){return this.hb.U(u,3+f)},a.prototype.Rp=function(u){return this.hb.U(u,7)},a.prototype.Rl=function(u,f){this.hb.T(u,7,f)},a.prototype.Tp=function(u,f){return this.hb.U(u,3+this.Qp(u,f))},a.prototype.hr=function(u,f,y){this.hb.T(u,3+this.Qp(u,f),y)},a.prototype.IR=function(u,f){return this.hb.U(u,5+this.Qp(u,f))},a.prototype.jr=function(u,f,y){this.hb.T(u,5+this.Qp(u,f),y)},a.prototype.Ur=function(u){return this.Ad.U(u,0)},a.prototype.PW=function(u,f){this.Ad.T(u,0,f)},a.prototype.$y=function(u){return this.Ad.U(u,4)},a.prototype.er=function(u,f){this.Ad.T(u,4,f)},a.prototype.kl=function(u){return this.Ad.U(u,1)},a.prototype.nn=function(u,f){this.Ad.T(u,1,f)},a.prototype.Zy=function(u){return this.Ad.U(u,3)},a.prototype.Ft=function(u,f){this.Ad.T(u,3,f)},a.prototype.$m=function(u){var f=this.Ad.De(),y=this.nh.Rh();return this.PW(f,y),u!=-1?(this.nh.addElement(y,u),this.g.Sa(u,this.zh,f),this.er(f,this.g.Va(u))):this.er(f,-1),f},a.prototype.CP=function(u){this.Ad.kd(u)},a.prototype.FD=function(u,f){this.nh.addElement(this.Ur(u),f),this.g.Sa(f,this.zh,u)},a.prototype.ot=function(u){var f=this.hb.De(),y=this.Rd.Rh();return this.UW(f,y),u!=-1&&this.Rd.addElement(y,u),f},a.prototype.GD=function(u,f){this.Rd.addElement(this.Th(u),f)},a.prototype.Wu=function(u){this.hb.kd(u),0<=(u=this.ph.gF(u))&&this.ph.NV(u)},a.prototype.jj=function(u,f){if(this.qg(u,0)==-1)this.GB(u,0,f);else{if(this.qg(u,1)!=-1)throw d.i.Ra();this.GB(u,1,f)}this.gy(u,f)},a.prototype.gy=function(u,f){var y=this.kl(f);if(y!=-1){var v=this.Tp(y,f);this.jr(v,f,u),this.hr(u,f,v),this.hr(y,f,u),this.jr(u,f,y)}else this.jr(u,f,u),this.hr(u,f,u),this.nn(f,u)},a.prototype.Qp=function(u,f){return this.qg(u,0)==f?0:1},a.prototype.Zm=function(u,f){var y,v=this.Zy(f);if(v!=-1&&(this.df.wd(v,-1),this.Ft(f,-1)),(v=this.kl(f))!=-1){var _=y=v;do{var M=!1,$=this.Qp(y,f),T=this.MF(y,$);if(this.qg(y,$+1&1)==u){if(this.Zu(y),this.Rd.eh(this.Th(y)),this.Wu(y),y==T){v=-1;break}v==y&&(v=this.kl(f),_=T,M=!0)}y=T}while(y!=_||M);if(v!=-1){do $=this.Qp(y,f),T=this.MF(y,$),this.GB(y,$,u),y=T;while(y!=_);(y=this.kl(u))!=-1?(_=this.Tp(y,u),M=this.Tp(v,u),_==y?(this.nn(u,v),this.gy(y,u),this.nn(u,y)):M==v&&this.gy(v,u),this.hr(v,u,_),this.jr(_,u,v),this.hr(y,u,M),this.jr(M,u,y)):this.nn(u,v)}}for(v=this.Ur(u),y=this.Ur(f),_=this.nh.sc(y);_!=-1;_=this.nh.lb(_))this.g.Sa(this.nh.ka(_),this.zh,u);this.nh.Cy(v,y),this.CP(f)},a.prototype.PT=function(u,f){var y=this.qg(u,0),v=this.qg(u,1),_=this.qg(f,0),M=this.qg(f,1);this.Rd.Cy(this.Th(u),this.Th(f)),f==this.kl(y)&&this.nn(y,u),f==this.kl(v)&&this.nn(v,u),this.Zu(f),this.Wu(f),y==_&&v==M||v==_&&y==M||(this.Jn(y,this.Ao),this.Jn(_,this.Ri),this.Ao.rb(this.Ri)?(y!=_&&this.Zm(y,_),v!=M&&this.Zm(v,M)):(v!=_&&this.Zm(v,_),y!=M&&this.Zm(y,M)))},a.prototype.Zu=function(u){var f=this.qg(u,1);this.ZE(u,this.qg(u,0)),this.ZE(u,f)},a.prototype.ZE=function(u,f){var y=this.Tp(u,f),v=this.IR(u,f),_=this.kl(f);y!=u?(this.hr(v,f,y),this.jr(y,f,v),_==u&&this.nn(f,y)):this.nn(f,-1)},a.prototype.RD=function(u,f,y){var v=this.Rd.sc(u),_=this.Rd.ka(v);u=this.Ie(_);var M=this.Ie(this.g.V(_));for(this.g.lr(_,f,y,!0),v=this.Rd.lb(v);v!=-1;v=this.Rd.lb(v)){_=this.Rd.ka(v);var $=this.Ie(_)==u;this.g.lr(_,f,y,$)}v=f.Xp(y,0).bc(),f=f.Xp(y,f.ql(y)-1).xc(),this.wK(u,v),this.wK(M,f)},a.prototype.UE=function(u,f,y){var v=this.Th(u),_=this.qg(u,0),M=this.qg(u,1),$=this.ot(-1);for(this.ph.add($),this.Rl($,-3),this.Gf.add($),this.jj($,_),u=1,f=f.ql(y);u<f;u++)y=this.$m(-1),this.Ck.add(y),this.Gf.add(y),this.jj($,y),$=this.ot(-1),this.ph.add($),this.Rl($,-3),this.Gf.add($),this.jj($,y);for(this.jj($,M),v=this.Rd.sc(v);v!=-1;v=this.Rd.lb(v))if(M=this.Rd.ka(v),this.Ie(M)==_){u=0;do 0<u&&($=this.Gf.get(u-1),this.FD($,M),this.$y($)==-1&&this.er($,this.g.Va(M))),$=this.Gf.get(u),u+=2,this.GD($,M),M=this.g.V(M);while(u<this.Gf.size)}else{u=this.Gf.size-1;do u<this.Gf.size-2&&($=this.Gf.get(u+1),this.FD($,M),0>this.$y($)&&this.er($,this.g.Va(M))),$=this.Gf.get(u),u-=2,this.GD($,M),M=this.g.V(M);while(0<=u)}this.Gf.clear(!1)},a.prototype.Ie=function(u){return this.g.Qa(u,this.zh)},a.prototype.NI=function(u,f,y){var v=this.qg(f,0),_=new d.h;this.Jn(v,_);var M=new d.h,$=this.qg(f,1);this.Jn($,M);var T=y.ql(u),A=y.Xp(u,0),R=new d.h;if(A.$p(R),!_.rb(R)){if(!this.Pg){var D=_.compare(this.xh);0>D*(R=R.compare(this.xh))&&(this.Pg=!0)}this.qF(v,this.Gf),this.Ck.add(v)}for(!this.Pg&&1<T&&(D=_.compare(M),A=A.xc(),(_.compare(A)!=D||A.compare(M)!=D||0>A.compare(this.xh))&&(this.Pg=!0)),u=(A=y.Xp(u,T-1)).xc(),M.rb(u)||(this.Pg||0>(D=M.compare(this.xh))*(R=u.compare(this.xh))&&(this.Pg=!0),this.qF($,this.Gf),this.Ck.add($)),this.Gf.add(f),M=0,$=this.Gf.size;M<$;M++)u=this.Gf.get(M),y=this.Rp(u),d.ad.GG(y)&&(this.Nc.wd(y,-1),this.Rl(u,-1)),u!=f&&this.Rp(u)!=-3&&(this.ph.add(u),this.Rl(u,-3));this.Gf.clear(!1)},a.prototype.gO=function(u,f){this.ae.compare(this.Nc,this.Nc.ka(u),f),this.ae.sg&&(this.ae.Mr(),this.jF(u,f))},a.prototype.jF=function(u,f){this.Yn=!0,u=this.Nc.ka(u),f=this.Nc.ka(f);var y=this.Rd.Ln(this.Th(u)),v=this.Rd.Ln(this.Th(f)),_=this.g.cc(y);_==null&&(this.je==null&&(this.je=new d.zb),this.g.fd(y,this.je),_=this.je),(y=this.g.cc(v))==null&&(this.Pm==null&&(this.Pm=new d.zb),this.g.fd(v,this.Pm),y=this.Pm),this.Ik.Qo(_),this.Ik.Qo(y),this.Ik.Fa(this.ra,!0)&&(this.Pg=!0),this.cK(u,f,-1,this.Ik),this.Ik.clear()},a.prototype.BQ=function(u,f){this.Yn=!0,f=this.Nc.ka(f);var y=this.Rd.Ln(this.Th(f)),v=this.g.cc(y);v==null&&(this.je==null&&(this.je=new d.zb),this.g.fd(y,this.je),v=this.je),y=this.wF(u),this.Ik.Qo(v),this.g.Xi(y,this.lo),this.Ik.Fz(this.ra,this.lo,!0),this.cK(f,-1,u,this.Ik),this.Ik.clear()},a.prototype.sS=function(){if(this.ph.size!=0)for(;this.ph.size!=0;){if(this.ph.size>Math.max(100,this.g.gd)){this.ph.clear(!1),this.Pg=!0;break}var u=this.ph.Gc();this.ph.Jf(),this.Rl(u,-1),this.RS(u)!=-1&&this.rS(u),this.Xn=!1}},a.prototype.rS=function(u){if(this.Xn){var f=this.Nc.Bu(this.HH,this.BH,u,!0);this.Xn=!1}else f=this.Nc.ED(u);f==-1?this.PT(this.Nc.ka(this.Nc.AF()),u):(this.Rl(u,f),this.ae.sg&&(this.ae.Mr(),this.jF(this.ae.Fm,f)))},a.prototype.RS=function(u){var f=this.qg(u,0);if(u=this.qg(u,1),this.Jn(f,this.Ao),this.Jn(u,this.Ri),d.h.zc(this.Ao,this.Ri)<=this.PA)return this.Pg=!0,-1;var y=this.Ao.compare(this.xh),v=this.Ri.compare(this.xh);return 0>=y&&0<v?u:0>=v&&0<y?f:-1},a.prototype.jQ=function(){var u=new d.ja(0);u.Jb(this.g.gd);for(var f=this.g.$q(),y=f.next();y!=-1;y=f.next())this.g.Qa(y,this.zh)!=-1&&u.add(y);this.g.nx(u,u.size),this.kQ(u)},a.prototype.kQ=function(u){this.df.clear(),this.df.Ee(u.size),this.df.Xo(new O(this.g));var f=new d.h;f.Sc();for(var y=-1,v=new d.h,_=0,M=u.size;_<M;_++){var $=u.get(_);this.g.Hc($,v),v.rb(f)?($=this.g.Qa($,this.zh),this.Zm(y,$)):(y=this.Ie($),this.g.Hc($,f),$=this.df.zn($),this.Ft(y,$))}},a.prototype.lQ=function(){var u=new d.ja(0);u.Jb(this.g.gd);for(var f=this.df.sc(-1);f!=-1;f=this.df.lb(f))u.add(this.df.ka(f));this.df.clear(),this.g.nx(u,u.size),f=0;for(var y=u.size;f<y;f++){var v=u.get(f),_=this.Ie(v);v=this.df.zn(v),this.Ft(_,v)}},a.prototype.qF=function(u,f){var y=this.kl(u);if(y!=-1){var v=y;do d.ad.GG(this.Rp(v))&&f.add(v),v=this.Tp(v,u);while(v!=y)}},a.prototype.wK=function(u,f){for(u=this.nh.sc(this.Ur(u));u!=-1;u=this.nh.lb(u))this.g.mf(this.nh.ka(u),f)},a.prototype.cK=function(u,f,y,v){this.Zu(u),f!=-1&&this.Zu(f),this.NI(0,u,v),f!=-1&&this.NI(1,f,v),y!=-1&&(v.Cf.D(this.Ao),this.Jn(y,this.Ri),this.Ri.rb(this.Ao)||this.Ck.add(y)),y=0;for(var _=this.Ck.size;y<_;y++){var M=this.Ck.get(y),$=this.Zy(M);$!=-1&&(this.df.wd($,-1),this.Ft(M,-1))}for(y=this.Th(u),_=f!=-1?this.Th(f):-1,this.RD(y,v,0),f!=-1&&this.RD(_,v,1),this.UE(u,v,0),f!=-1&&this.UE(f,v,1),this.Rd.eh(y),this.Wu(u),f!=-1&&(this.Rd.eh(_),this.Wu(f)),y=0,_=this.Ck.size;y<_;y++)(M=this.Ck.get(y))==this.Lq&&(this.Zv=!0),($=this.Zy(M))==-1&&(($=this.df.ED(this.wF(M)))==-1?(u=this.Ie(this.df.ka(this.df.AF())),this.Zm(u,M)):this.Ft(M,$));this.Ck.clear(!1)},a.prototype.Jn=function(u,f){this.g.ZF(this.$y(u),f)},a.prototype.wF=function(u){return this.nh.Ln(this.Ur(u))},a.prototype.eC=function(){this.Zv=!1,this.Lq=-1,this.ae==null&&(this.Nc.Tv=!1,this.ae=new p(this),this.Nc.ao=this.ae);var u=new d.ja(0),f=null,y=null;this.BH=this.HH=-1,this.Xn=!1;for(var v=this.df.sc(-1);v!=-1;){this.Xn=!1;var _=this.df.ka(v);this.Lq=this.Ie(_),this.g.Hc(_,this.xh),this.ae.VJ(this.xh.y,this.xh.x);var M=this.kl(this.Lq),$=M==-1;if(!$){_=M;do{var T=this.Rp(_);T==-1?(this.ph.add(_),this.Rl(_,-3)):T!=-3&&u.add(T),_=this.Tp(_,this.Lq)}while(_!=M)}if(0<u.size){for(this.Xn=u.size==1&&this.ph.size==1,$=0,M=u.size;$<M;$++)_=this.Nc.ka(u.get($)),this.Rl(_,-2);var A=-2,R=-2;for($=0,M=u.size;$<M;$++){if(T=u.get($),A==-2){var D=this.Nc.xe(T);D!=-1?(_=this.Nc.ka(D),(_=this.Rp(_))!=-2&&(A=D)):A=-1}if(R==-2&&((T=this.Nc.lb(T))!=-1?(_=this.Nc.ka(T),(_=this.Rp(_))!=-2&&(R=T)):R=-1),A!=-2&&R!=-2)break}for($=0,M=u.size;$<M;$++)T=u.get($),_=this.Nc.ka(T),this.Nc.wd(T,-1),this.Rl(_,-1);u.clear(!1),this.HH=A!=-1?A:-1,this.BH=R!=-1?R:-1,A!=-1&&R!=-1?this.Xn||this.gO(A,R):A==-1&&R==-1&&(this.Xn=!1)}else $&&(f==null&&(f=new l(this)),f.Fh(this.xh),this.Nc.pJ(f),f.sg&&(f.Mr(),this.BQ(this.Lq,f.Fm)));this.sS(),this.Zv?(this.Zv=!1,y==null&&(y=new S(this.g)),y.Fh(this.xh),v=this.df.pJ(y)):v=this.df.lb(v)}return this.Yn},a.prototype.gr=function(u){for(this.g=u,this.zh=this.g.Hd(),this.hb.Ee(u.gd+32),this.Ad.Ee(u.gd),this.nh.Bt(u.gd),this.nh.hn(u.gd),this.Rd.Bt(u.gd+32),this.Rd.hn(u.gd+32),u=this.g.md;u!=-1;u=this.g.ve(u))if(d.ba.Ic(this.g.jc(u)))for(T=this.g.Ob(u);T!=-1;T=this.g.Sb(T)){var f=this.g.Ka(T),y=this.g.Ya(T),v=this.$m(y),_=this.ot(y);for(this.jj(_,v),A=this.g.V(y),y=0,f-=2;y<f;y++){var M=this.g.V(A),$=this.$m(A);this.jj(_,$),_=this.ot(A),this.jj(_,$),A=M}this.g.ec(T)?($=this.$m(A),this.jj(_,$),_=this.ot(A),this.jj(_,$),this.jj(_,v)):($=this.$m(A),this.jj(_,$))}else for(var T=this.g.Ob(u);T!=-1;T=this.g.Sb(T)){var A=this.g.Ya(T);for(v=0,f=this.g.Ka(T);v<f;v++)this.$m(A),A=this.g.V(A)}this.jQ()},a}();d.MC=s}(Q||(Q={})),function(d){var O=function(S){function p(l,s,a){var u=S.call(this)||this;if(l!==void 0)if(a!==void 0){u.description=d.fe.pg();var f=new d.Od;f.L(l,s,a),u.ZB(f)}else if(s!==void 0)u.description=d.fe.pg(),u.Db(l,s);else if(l instanceof d.sa)u.description=l;else if(l instanceof d.h)u.description=d.fe.pg(),u.Db(l);else{if(!(l instanceof p))throw d.i.O();u.description=l.description,u.Db(l.Ng(),l.kh()),l.la!==null&&(u.la=l.la.slice(0))}else u.description=d.fe.pg();return u}return Pe(p,S),p.prototype.D=function(l){if(l===void 0){if(this.Bc())throw d.i.ga("This operation should not be performed on an empty geometry.");return(l=new d.h).na(this.la[0],this.la[1]),l}if(this.Bc())throw d.i.ga("This operation should not be performed on an empty geometry.");l.na(this.la[0],this.la[1])},p.prototype.Db=function(l,s){typeof l=="number"?(this.wc(),this.la==null&&this.wn(),this.la[0]=l,this.la[1]=s):(this.wc(),this.Db(l.x,l.y))},p.prototype.xz=function(){if(this.Bc())throw d.i.ga("This operation should not be performed on an empty geometry.");var l=new d.Od;return l.x=this.la[0],l.y=this.la[1],l.z=this.description.dG()?this.la[2]:d.sa.te(1),l},p.prototype.ZB=function(l){this.wc();var s=this.hasAttribute(1);s||d.sa.yG(1,l.z)||(this.se(1),s=!0),this.la==null&&this.wn(),this.la[0]=l.x,this.la[1]=l.y,s&&(this.la[2]=l.z)},p.prototype.Ng=function(){if(this.Bc())throw d.i.ga("This operation should not be performed on an empty geometry.");return this.la[0]},p.prototype.YB=function(l){this.setAttribute(0,0,l)},p.prototype.kh=function(){if(this.Bc())throw d.i.ga("This operation should not be performed on an empty geometry.");return this.la[1]},p.prototype.WJ=function(l){this.setAttribute(0,1,l)},p.prototype.XR=function(){return this.Vc(1,0)},p.prototype.sX=function(l){this.setAttribute(1,0,l)},p.prototype.uR=function(){return this.Vc(2,0)},p.prototype.cX=function(l){this.setAttribute(2,0,l)},p.prototype.Fc=function(){return this.tF(3,0)},p.prototype.GJ=function(l){this.setAttribute(3,0,l)},p.prototype.Vc=function(l,s){var a=this.description.Rf(l);return 0<=a?this.la[this.description.bk(a)+s]:d.sa.te(l)},p.prototype.tF=function(l,s){var a=this.description.Rf(l);return 0<=a?this.la[this.description.bk(a)+s]:d.sa.te(l)},p.prototype.setAttribute=function(l,s,a){this.wc();var u=this.description.Rf(l);0>u&&(this.se(l),u=this.description.Rf(l)),this.la==null&&this.wn(),this.la[this.description.bk(u)+s]=a},p.prototype.K=function(){return 33},p.prototype.Eb=function(){return 0},p.prototype.Pa=function(){this.wc(),this.la!=null&&(this.la[0]=NaN,this.la[1]=NaN)},p.prototype.un=function(l){if(this.la!=null){for(var s=d.fe.Kw(l,this.description),a=[],u=0,f=0,y=l.Ba;f<y;f++){var v=l.ld(f),_=d.sa.Wa(v);if(s[f]==-1){var M=d.sa.te(v);for(v=0;v<_;v++)a[u]=M,u++}else for(M=this.description.bk(s[f]),v=0;v<_;v++)a[u]=this.la[M],u++,M++}this.la=a}this.description=l},p.prototype.wn=function(){this.gJ(this.description.Be.length),p.YD(this.description.Be,this.la,this.description.Be.length),this.la[0]=NaN,this.la[1]=NaN},p.prototype.Pc=function(l){if(l instanceof d.Ed){if(!this.Bc()){var s=this.D();l.Gh(s,s),this.Db(s)}}else this.Bc()||(this.se(1),s=this.xz(),this.ZB(l.hp(s)))},p.prototype.copyTo=function(l){if(l.K()!=33)throw d.i.O();l.wc(),this.la==null?(l.Pa(),l.la=null,l.Pf(this.description)):(l.Pf(this.description),l.gJ(this.description.Be.length),p.YD(this.la,l.la,this.description.Be.length))},p.prototype.Ja=function(){return new p(this.description)},p.prototype.B=function(){return this.Bc()},p.prototype.Bc=function(){return this.la==null||isNaN(this.la[0])||isNaN(this.la[1])},p.prototype.dn=function(l){l.Pa(),this.description!=l.description&&l.Pf(this.description),l.$b(this)},p.prototype.A=function(l){this.Bc()?l.Pa():(l.v=this.la[0],l.G=this.la[1],l.C=this.la[0],l.H=this.la[1])},p.prototype.So=function(l){if(this.Bc())l.Pa();else{var s=this.xz();l.v=s.x,l.G=s.y,l.Xe=s.z,l.C=s.x,l.H=s.y,l.Dg=s.z}},p.prototype.Vg=function(l,s){var a=new d.Oc;return this.Bc()?(a.Pa(),a):(l=this.Vc(l,s),a.pa=l,a.wa=l,a)},p.prototype.gJ=function(l){if(this.la==null)this.la=d.P.mg(l);else if(this.la.length<l){for(var s=this.la.slice(0),a=this.la.length;a<l;a++)s[a]=0;this.la=s}},p.YD=function(l,s,a){if(0<a)for(a=0;a<l.length;a++)s[a]=l[a]},p.prototype.Nb=function(l){if(l==this)return!0;if(!(l instanceof p)||this.description!=l.description)return!1;if(this.Bc())return!!l.Bc();for(var s=0,a=this.description.Be.length;s<a;s++)if(this.la[s]!=l.la[s])return!1;return!0},p.prototype.dc=function(){var l=this.description.dc();if(!this.Bc())for(var s=0,a=this.description.Be.length;s<a;s++){var u=this.la[s];u=d.P.truncate(u^u>>>32),l=d.P.Vh(u,l)}return l},p.prototype.ng=function(){return null},p}(d.ba);d.Ta=O}(Q||(Q={})),function(d){var O=function(){function S(p,l,s){p!==void 0&&(this.x=p,this.y=l,this.z=s)}return S.construct=function(p,l,s){var a=new S;return a.x=p,a.y=l,a.z=s,a},S.prototype.L=function(p,l,s){this.x=p,this.y=l,this.z=s},S.prototype.lx=function(){this.z=this.y=this.x=0},S.prototype.normalize=function(){var p=this.length();p==0&&(this.x/=p,this.y/=p,this.z/=p)},S.prototype.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},S.prototype.sub=function(p){return new S(this.x-p.x,this.y-p.y,this.z-p.z)},S.prototype.Bg=function(p){new S(this.x*p,this.y*p,this.z*p)},S.prototype.Sh=function(p){return this.x*p.x+this.y*p.y+this.z*p.z},S}();d.Od=O}(Q||(Q={})),function(d){var O=function(){function S(p,l,s){this.Iw=this.yA=null,this.Zf=l,this.AT=l.y-s,this.zT=l.y+s,this.Gw=0,this.Zz=p,this.ra=s,this.MT=s*s,this.$z=s!=0,this.Nv=!1}return S.prototype.result=function(){return this.Gw!=0?1:0},S.prototype.UM=function(p){return p=p.ic(p.ge(this.Zf,!1)),d.h.zc(p,this.Zf)<=this.MT},S.prototype.aF=function(p){if(!this.$z&&(this.Zz&&this.Zf.rb(p.bc())||this.Zf.rb(p.xc())))this.Nv=!0;else if(p.oa==this.Zf.y&&p.oa==p.ma){if(this.Zz&&!this.$z){var l=Math.max(p.ta,p.qa);this.Zf.x>Math.min(p.ta,p.qa)&&this.Zf.x<l&&(this.Nv=!0)}}else{var s=!1;if(l=Math.max(p.ta,p.qa),this.Zf.x>l?s=!0:this.Zf.x>=Math.min(p.ta,p.qa)&&(s=0<p.fq(!0,this.Zf.y,this.Iw,null)&&this.Iw[0]<=this.Zf.x),s){if(this.Zf.y==p.bc().y){if(this.Zf.y<p.xc().y)return}else if(this.Zf.y==p.xc().y&&this.Zf.y<p.bc().y)return;this.Gw=this.Zz?1^this.Gw:this.Gw+(p.bc().y>p.xc().y?1:-1)}}},S.prototype.MI=function(p){var l=p.Vg(0,1);if(l.pa>this.zT||l.wa<this.AT)return!1;if(this.$z&&this.UM(p))return!0;if(l.pa>this.Zf.y||l.wa<this.Zf.y)return!1;if(this.yA==null&&(this.yA=[null,null,null,null,null]),this.Iw==null&&(this.Iw=[0,0,0]),0<(l=p.$F()))for(p=0;p<l;p++){var s=this.yA[p].get();if(this.aF(s),this.Nv)return!0}else if(this.aF(p),this.Nv)return!0;return!1},S.KM=function(p,l,s){for(l=new S(p.Kn()==0,l,s),p=p.Ha();p.ab();)for(;p.Ia();)if(s=p.ia(),l.MI(s))return-1;return l.result()},S.LM=function(p,l,s,a){var u=new d.l;p.yc(u),u.X(a,a);var f=new S(p.Kn()==0,s,a);p=p.Ha();var y=new d.l;for(y.L(u),y.C=s.x+a,y.G=s.y-a,y.H=s.y+a,a=(s=l.HF(y,a)).next();a!=-1;a=s.next())if(p.Wb(l.ka(a)),p.Ia()&&(a=p.ia(),f.MI(a)))return-1;return f.result()},S.ym=function(p,l,s){if(p.B())return 0;var a=new d.l;if(p.yc(a),a.X(s,s),!a.contains(l))return 0;if((a=p.Cb)!=null){var u=a.Hk;if(u!=null){if((u=u.Uo(l.x,l.y))==1)return 1;if(u==0)return 0}if((a=a.Gb)!=null)return S.LM(p,a,l,s)}return S.KM(p,l,s)},S.XS=function(p,l,s){return l.B()?0:S.ym(p,l.D(),s)},S.Ol=function(p,l){return!(16>(p=p.I()))&&2*p+Math.log(p)/Math.log(2)*l<1*p*l},S}();d.Fg=O}(Q||(Q={})),function(d){var O=function(S){function p(l){return S.call(this,!0,l)||this}return Pe(p,S),p.prototype.Ja=function(){return new p(this.description)},p.prototype.Eb=function(){return 2},p.prototype.K=function(){return 1736},p.prototype.sG=function(l,s,a){this.ES(l,s,a)},p.prototype.kR=function(){this.AR()},p}(d.Xk);d.Ea=O}(Q||(Q={})),function(d){(function(O){O[O.PiPOutside=0]="PiPOutside",O[O.PiPInside=1]="PiPInside",O[O.PiPBoundary=2]="PiPBoundary"})(d.ML||(d.ML={})),d.jd=function(){function O(){}return O.FG=function(S,p,l){return(S=d.Fg.XS(S,p,l))==0?0:S==1?1:2},O.Zd=function(S,p,l){return(S=d.Fg.ym(S,p,l))==0?0:S==1?1:2},O.SX=function(S,p,l,s,a){if(p.length<l||a.length<l)throw d.i.O();for(var u=0;u<l;u++)a[u]=O.Zd(S,p[u],s)},O.nK=function(S,p,l,s,a){if(S.K()==1736)O.SX(S,p,l,s,a);else{if(S.K()!=197)throw d.i.ga("invalid_call");var u=new d.l;S.A(u),O.VM(u,p,l,s,a)}},O.VM=function(S,p,l,s,a){if(p.length<l||a.length<l)throw d.i.O();if(S.B())for(s=0;s<l;s++)a[s]=0;else for(S.X(.5*-s,.5*-s),S.X(.5*s,.5*s),s=0;s<l;s++)S.contains(p[s])?a[s]=1:S.contains(p[s])?a[s]=2:a[s]=0},O.UX=function(S,p,l,s,a){for(var u=0;u<l;u++)a[u]=S.ss(p[u],s)?2:0},O.TX=function(S,p,l,s,a){var u=S.Cb,f=null;u!=null&&(f=u.Hk),u=l;for(var y=0;y<l;y++)if(a[y]=1,f!=null){var v=p[y];f.Uo(v.x,v.y)==0&&(a[y]=0,u--)}if(u!=0)for(S=S.Ha();S.ab()&&u!=0;)for(;S.Ia()&&u!=0;)for(f=S.ia(),y=0;y<l&&u!=0;y++)a[y]==1&&f.ss(p[y],s)&&(a[y]=2,u--);for(y=0;y<l;y++)a[y]==1&&(a[y]=0)},O.oK=function(S,p,l,s,a){var u=S.K();if(u==1607)O.TX(S,p,l,s,a);else{if(!d.ba.zd(u))throw d.i.ga("Invalid call.");O.UX(S,p,l,s,a)}},O}()}(Q||(Q={})),function(d){var O=function(S){function p(l,s){if(arguments.length==2){var a=S.call(this,!1,l.description)||this;a.nf(l),a.lineTo(s)}else a=S.call(this,!1,l)||this;return a}return Pe(p,S),p.prototype.Ja=function(){return new p(this.description)},p.prototype.Eb=function(){return 1},p.prototype.K=function(){return 1607},p.prototype.sG=function(l,s,a){this.FS(l,s,a)},p}(d.Xk);d.Ua=O}(Q||(Q={})),function(d){var O=function(){function S(){}return S.prototype.progress=function(){return!0},S.Bp=function(p){if(p!=null&&!p.progress(-1,-1))throw d.i.RC()},S}();d.op=O}(Q||(Q={})),function(d){var O;(O=d.KK||(d.KK={}))[O.clipWithInputHorizon=1]="clipWithInputHorizon",O[O.clipWithOutputHorizon=2]="clipWithOutputHorizon";var S=function(){function s(){this.Mg=3,this.Xu=this.Lr=NaN}return s.prototype.KW=function(a){this.LB(1,a)},s.prototype.LW=function(a){this.LB(2,a)},s.prototype.cS=function(){return this.ks(1)},s.prototype.dS=function(){return this.ks(2)},s.prototype.LB=function(a,u){this.Mg=u?this.Mg|a:this.Mg&~a},s.prototype.ks=function(a){return(this.Mg&a)!=0},s.prototype.Qf=function(){var a=new s;return a.Lr=this.Lr,a.Xu=this.Xu,a.Mg=this.Mg,a},s}();d.tC=S,function(s){s[s.Dont_Geonomalize_Polygon=2147483648]="Dont_Geonomalize_Polygon",s[s.Dont_Adjust_At_Poles=1073741824]="Dont_Adjust_At_Poles"}(d.LK||(d.LK={}));var p=function(){function s(){this.Mg=0}return s.prototype.LB=function(a,u){this.Mg=u?this.Mg|a:this.Mg&~a},s.prototype.ks=function(a){return(this.Mg&a)!=0},s.kg=function(a){var u=new s;return u.Mg=a.Mg,u},s.prototype.hM=function(a){this.Mg=a.Mg},s}();d.wY=p;var l=function(){function s(a,u,f){this.ef=a,this.$f=u,this.Wf=new d.l,this.Wf.L(f),this.vT=a.dc()+u.dc()+this.Wf.dc().toString()}return s.prototype.dc=function(){return this.vT},s.prototype.Nb=function(a){return this==a||this.ef.Nb(a.ef)&&this.$f.Nb(a.$f)&&this.Wf.Nb(a.Wf)},s}();d.BY=l,l=function(){function s(){this.$f=this.ef=null,this.mH=new S,this.nH=new p,this.yw=this.Yf=null,this.ow=this.Vn=!0}return s.Pr=function(a,u,f,y){var v;y===void 0&&(y=null),v===void 0&&(v=null);var _=new s;return _.sp(a,u,f,y,v),_},s.prototype.sp=function(a,u,f,y,v){if(a==null||u==null)throw d.i.ga("invalidArgument");if(this.ef=a,this.$f=u,this.ow=this.Vn=!1,y!=null&&(this.mH=y.Qf()),v!=null&&this.nH.hM(v),v=!1,u.Tb()==1&&y!=null&&(y=y.Lr,isNaN(y)||y==0||(v=!0)),a==u)this.Vn=!v,this.ow=!0;else{y=a.Tb();var _=u.Tb();if(y==0||_==0){if(f!=null)throw d.i.O();a.Id()!=null&&u.Id()!=null&&(this.Vn=a.Id().Nb(u.Id()))}else y==3||_==3?this.Vn=a.Nb(u):this.ef.fS(this.$f)?this.Vn=!v:this.Vn=!1,this.Yf=f,this.Yf!=null&&this.Yf.ix(),this.ow=(this.Yf==null||this.Yf.count()==0)&&this.ef.tc().Nb(this.$f.tc())}this.kY()},s.prototype.isIdentity=function(){return this.Vn},s.prototype.iR=function(){return this.mH.Qf()},s.prototype.Nb=function(a){return a==this||!!(a instanceof s&&this.ef.Nb(a.ef)&&this.$f.Nb(a.$f))&&(this.Yf==a.Yf||!(this.Yf==null||a.Yf==null||!this.Yf.Nb(a.Yf)))},s.prototype.kY=function(){this.yw=new d.du(this)},s}(),d.xr=l}(Q||(Q={})),function(d){var O=function(){function S(){}return S.Ep=function(p){return p*S.jW},S.mx=function(p,l){return S.bP(l-p)},S.cP=function(p){return-360<=p&&720>p?(0>p?p+=360:360<=p&&(p-=360),p):(0>(p=d.mc.MK(p))&&(p+=360),p)},S.bP=function(p){return 180<(p=S.cP(p))&&(p-=360),p},S.jW=57.29577951308232,S}();d.sr=O,d.Jh=function(){function S(){}return S.nj=function(p,l){var s=new d.l;p.A(s);var a=d.cb.ih(l),u=new d.l;return u.L(a),u.v=s.v,u.C=s.C,u.X(.01*u.da(),0),l=d.ua.Xd(l,s,!1),u.contains(s)?p:d.Vd.clip(p,u,l,0)},S.ms=function(p,l,s,a,u){if(!d.cb.Xc(l))throw d.i.O();var f=d.ua.mj(l,p,!1),y=d.cb.ih(l),v=d.cb.tc(l),_=v.Id().ci,M=d.cb.xv(v);v=d.cb.gv(v),M*=2-M;var $=new d.Oc;y.en($);var T=[[0,0],[0,0]];if(d.Gg.Tb(l)==2?a?(T[0][0]=S.an(u,$),T[0][1]=y.Lp(),d.cb.wt(),y=T[0][0]*_):(T[0][0]=y.ik(),T[0][1]=u,d.cb.wt(),y=T[0][1]*_):y=u*_,!a&&y!=0)throw d.i.O();var A=new d.ha,R=new d.hd;p=R.Ib(p);for(var D=[0],V=new d.h,Z=new d.h,ee=new d.h,G=new d.h,re=new d.h,oe=new d.h,se=R.Ob(p);se!=-1;se=R.Sb(se)){var ge=R.Ya(se);R.D(ge,ee);for(var me=!1,Ie=ge=R.V(ge);Ie!=-1;Ie=R.V(Ie)){if(Ie==ge){if(me)break;me=!0}if(R.D(Ie,G),a&&f<u-ee.x&&G.x-u>f||f<u-G.x&&ee.x-u>f||!a&&f<-ee.y&&G.y>f||f<-G.y&&ee.y>f)do if(!(Math.abs(ee.x-G.x)>=.5*$.S())){if(d.Gg.Tb(l)==2?(T[0][0]=S.an(ee.x,$),T[0][1]=ee.y,T[1][0]=S.an(G.x,$),T[1][1]=G.y,d.cb.ZV(),re.x=T[0][0]*_,re.y=T[0][1]*_,oe.x=T[1][0]*_,oe.y=T[1][1]*_):(re.x=ee.x*_,re.y=ee.y*_,oe.x=G.x*_,oe.y=G.y*_),oe.x=6.283185307179586*(G.x-ee.x)/$.S()+re.x,a){if(Z.x=y,Z.y=S.Iz(v,M,re,oe,y,s),isNaN(Z.y))break}else{if(Z.x=S.Gz(v,M,re,oe,s),isNaN(Z.x))break;Z.y=0}d.kb.xd(v,M,re.x,re.y,oe.x,oe.y,A,null,null,s);var De=A.u;d.kb.xd(v,M,re.x,re.y,Z.x,Z.y,A,null,null,s);var Fe=A.u;d.Gg.Tb(l)==2?(T[0][0]=Z.x/_,T[0][1]=Z.y/_,d.cb.XQ(),a?(V.y=T[0][1],V.x=u):(V.x=S.qs(T[0][0],ee.x,G.x,$),V.y=u)):a?(V.x=u,V.y=Z.y/_):(V.x=S.qs(Z.x/_,ee.x,G.x,$),V.y=u),D[0]=0<De?d.P.Tk(Fe/De,0,1):.5,D[0]!=0&&D[0]!=1&&(De=R.Na(Ie),R.Wl(De,D,1),R.Db(R.V(De),V.x,V.y))}while(0);ee.N(G)}}return R.Ke(p)},S.Hn=function(p,l,s,a,u){if(p.B())return p;var f=d.cb.bf(l);return S.Jp(p,s-180*f,360*f,l,a,u,!0)},S.Iz=function(p,l,s,a,u,f){if(3.141592653589793<=Math.abs(s.x-a.x)||!S.Un(s.x,a.x,u))return NaN;if(s.x>a.x)var y=a;else y=s,s=a;a=new d.ha(0);var v=new d.ha(0),_=new d.ha(0);d.kb.xd(p,l,y.x,y.y,s.x,s.y,v,a,null,f);var M=v.u,$=0,T=1,A=new d.h;for(A.N(y);M*(T-$)>1e-12*p;){var R=.5*($+T);if(d.kb.qj(p,l,y.x,y.y,M*R,a.u,v,_,f),A.x=v.u,A.y=_.u,A.x==u)break;if(S.Un(y.x,A.x,u))T=R;else{if(!S.Un(s.x,A.x,u))return NaN;$=R}}return A.y},S.Un=function(p,l,s){return p=O.Ep(p),l=O.mx(p,O.Ep(l)),(s=O.mx(p,O.Ep(s)))==0||0<l&&0<s&&s<=l||0>l&&0>s&&s>=l},S.an=function(p,l){var s=l.wa-l.pa;return l.Kt(p-Math.floor((p-l.pa)/s)*s)},S.qs=function(p,l,s,a){var u=new d.Oc;for(u.L(l,s),s=a.S(),p=Math.floor((p-l)/s)*s+p,u=u.tf();Math.abs(p-u)>Math.abs(p+s-u);)p+=s;return p},S.Gz=function(p,l,s,a,u){if(s.y>a.y)var f=a;else f=s,s=a;if((a=new d.Oc).L(f.y,s.y),!a.contains(0)||3.141592653589793<=Math.abs(f.x-s.x))return NaN;if(f.x==s.x)return f.x;var y=new d.ha(0),v=new d.ha(0),_=new d.ha(0);d.kb.xd(p,l,f.x,f.y,s.x,s.y,v,y,null,u);var M=v.u,$=0,T=1,A=new d.h;for(A.N(f);M*(T-$)>1e-12*p;){var R=.5*($+T);if(d.kb.qj(p,l,f.x,f.y,M*R,y.u,v,_,u),A.x=v.u,A.y=_.u,a.L(f.y,A.y),A.y==0)break;if(a.contains(0))T=R;else{if(a.L(s.y,A.y),!a.contains(0))return NaN;$=R}}return A.x},S.Jp=function(p,l,s,a,u,f,y){var v=new d.l;if(p.A(v),v.B())return p;var _=new d.Oc;v.en(_);var M=new d.Oc;if(M.L(l,l+s),M.contains(_)&&M.wa!=_.wa)return p;var $=new d.l;$.L(v);var T=p.K();if(T==33)return((v=($=u?p:p.Qf()).Ng())<M.pa||v>=M.wa||y&&v==M.wa)&&(v+=Math.ceil((M.pa-v)/s)*s,v=M.Kt(v),$.YB(v)),$;if(T==550){for(a=($=u?p:p.Qf()).vb(0),T=2*$.I(),p=!1,u=0;u<T;u+=2)((v=a.read(u))<M.pa||v>=M.wa||y&&v==M.wa)&&(p=!0,v+=Math.ceil((M.pa-v)/s)*s,v=M.Kt(v),a.write(u,v));return p&&$.Qc(1993),$}if(M.contains(_))return p;if(T==197)return s=u?p:p.Qf(),v.Fa($),s.Zo(v),s;var A=.1*Math.max(v.da(),v.S());for($.X(0,A),y=p,M=a.Yd(0),p=d.Ih.local(),u=new d.Ed;;){var R=Math.floor((_.pa-l)/s),D=Math.ceil((_.wa-l)/s);if(!(3<D-R))break;R=Math.floor(.5*(D+R)),$.v=v.v-A,$.C=l+s*R;var V=d.Vd.clip(y,$,M,f);$.v=$.C,$.C=v.C+A;var Z=d.Vd.clip(y,$,M,f);u.ig((R-D)*s,0),Z.Pc(u),T==1736?y=p.W(V,Z,a,null):(y=V).add(Z,!1),y.A(v),v.en(_)}for($.v=l,$.C=l+s,(l=new d.l).L($),l.X(M,0),(l=Math.floor((v.v-$.v)/s)*s)!=0?($.move(l,0),u.ig(-l,0)):u.MB(),l=T==1607?new d.Ua(y.description):new d.Ea(y.description),f=new d.l,_=new d.l;v.C>$.v;)(A=d.Vd.clip(y,$,M,0)).A(_),(T==1607?!A.B()&&(_.S()>M||_.da()>M):!A.B()&&(T!=1736||_.S()>M))&&(A.Pc(u),A.A(_),l.A(f),f.X(M,M),f.isIntersecting(_)&&T==1736?l=p.W(l,A,a,null):l.add(A,!1)),$.move(s,0),u.shift(-s,0);return l},S.RI=function(p,l,s,a){var u=new d.ee(s.description);u.Gd(s,0,-1),u=d.cb.Bh(u,p,l);var f=s.I();if(a.Pa(),!d.cb.Xc(p)||f!=u.I())return!1;var y=new d.l;s.A(y);var v=new d.l;if(u.A(v),y=y.S(),v=v.S(),y!=0&&v!=0){if(v/=y,p=d.cb.ih(l).S()/d.cb.ih(p).S(),1e-10<Math.abs(v/p-1))return!1}else if(y!=0||v!=0)return!1;for(a.add(s,!1),s=0;s<f;s++)p=u.Oa(s),a.Db(s,p);return!0},S.Jz=function(){throw d.i.Fe()},S}()}(Q||(Q={})),function(d){var O,S,p;(S=O=d.ui||(d.ui={}))[S.Clip=0]="Clip",S[S.DontClip=1]="DontClip",S[S.PannableFold=2]="PannableFold",function(l){l[l.Geodesic=0]="Geodesic",l[l.Loxodrome=1]="Loxodrome",l[l.GreatElliptic=2]="GreatElliptic",l[l.NormalSection=3]="NormalSection",l[l.ShapePreserving=4]="ShapePreserving"}(p=d.RK||(d.RK={})),d.Ab=function(){function l(){}return l.zv=function(s,a,u){if(u||0<a){for(s=s.toString(d.Tc.PE_STR_NAME_CANON|d.Tc.PE_STR_AUTH_NONE),a=[],u=0;u<s.length;u++)a[u]="a"<=s[u]&&"z">=s[u]?a[u]=s[u].toUpperCase():s[u];return a.join()}return s.toString(d.Tc.PE_STR_AUTH_TOP)},l.wr=function(s,a,u,f){var y=f.length,v=u.I();if(v!=0){var _=u.vb(0),M=Math.min(v,y),$=0,T=s.gh();isNaN(a)&&(a=0);for(var A=s.Xc(),R=179*(s=A?s.tc().Le().S():0)/360;0<v;){if(_.pB($<<1,M,f),d.gj.projToGeogCenter(T,M,f,a),A)for(var D=0;D<M;D++){var V=f[D][0]-a,Z=d.mc.sign(V),ee=_.read(2*($+D));0>Z*d.mc.sign(ee)&&Math.abs(V)>R&&(f[D][0]+=-Z*s)}_.pC($<<1,M,f),$+=M,v-=M,M=Math.min(v,y)}u.Qc(1993)}},l.DL=function(s,a,u,f){var y=0,v=s.gh();isNaN(y)&&(y=0);var _=s.Xc(),M=s.bf();s=360*M,M*=179;for(var $=f.length,T=0;T<u;){for(var A=T;A<u&&a[A].isNaN();++A)T++;var R=Math.min($,u-T);if(0<R){A=1;for(var D=T+1;A<R;++A,++D)if(a[D].isNaN()){R=A;break}if(d.ua.Ey(f,a,T,R),d.gj.projToGeogCenter(v,R,f,y),_)for(A=0,D=T;A<R;++A,++D){var V=a[D].x,Z=f[A][0]-y,ee=d.mc.sign(Z);0>ee*d.mc.sign(V)&&Math.abs(Z)>M&&(f[A][0]-=ee*s)}d.ua.Dy(a,T,f,R),T+=R}}},l.Kx=function(s,a,u){var f=u.length,y=a.I();if(!(1>y)){var v=a.vb(0),_=Math.min(y,f),M=0,$=s.gh(),T=s.Xc(),A=T?s.Le().S():0,R=179*A/360,D=0;for(T&&(D=s.Bi());0<y;){if(v.pB(M<<1,_,u),d.gj.geogToProj($,_,u),T)for(s=0;s<_;s++){var V=u[s][0],Z=d.mc.sign(V),ee=v.read(2*(M+s))-D;0>Z*d.mc.sign(ee)&&Math.abs(V)>R&&(u[s][0]+=-Z*A)}v.pC(M<<1,_,u),M+=_,y-=_,_=Math.min(y,f)}a.Qc(1993)}},l.CL=function(s,a,u,f){if(u!=0){var y=s.gh(),v=s.Xc(),_=v?s.Le().S():0,M=179*_/360,$=0;for(v&&($=s.Bi()),s=0;s<u;){for(var T=s;T<u&&a[T].isNaN();++T)s++;var A=Math.min(f.length,u-s);if(0<A){T=1;for(var R=s+1;T<A;++T,++R)if(a[R].isNaN()){A=T;break}if(d.ua.Ey(f,a,s,A),d.gj.geogToProj(y,A,f),v)for(T=0,R=s;T<A;T++){var D=f[T][0],V=d.mc.sign(D);0>V*d.mc.sign(a[R].x-$)&&Math.abs(D)>M&&(f[T][0]-=V*_)}d.ua.Dy(a,s,f,A),s+=A}}}},l.vr=function(s,a,u,f){var y=a.I();if(y!=0){var v=a.vb(0),_=s.ef,M=s.$f,$=_.tc().Sp(),T=M.tc().Sp(),A=_.bf(),R=M.bf();if((s=s.Yf)==null||s.count()==0){for(u=$/T,f=(_.Wp()-M.Wp())*R,T=-90*A,s=90*A,$=!1,R=1,_=2*y;R<_;)A=v.get(R),(M=d.P.Tk(A,T,s))!=A&&(v.set(R,M),$=!0),R+=2;if(f!=0||u!=1)for($=!0,T=new d.h,R=0;R<y;R++)v.uc(2*R,T),T.x*=u,T.x+=f,T.y*=u,v.Vt(2*R,T);$&&a.Qc(1993)}else{_=f.length,M=Math.min(y,_);var D=d.P.mg(M),V=null,Z=0,ee=NaN,G=NaN,re=360*R,oe=R/A;u&&(G=90*R,ee=89.9*A,V=d.P.mg(M));for(var se=!0,ge=0;y!=0;){for(A=!1,v.pB(Z<<1,M,f),R=0;R<M;R++)D[R]=f[R][0];if(u)for(R=0;R<M;R++){var me=Math.abs(f[R][1])-ee;0<me&&(A=f[R][1],f[R][1]=d.mc.En(ee,A),V[R]=d.mc.En(me,A),A=!0)}for(R=f[0][0],s.transform(f,M,$,T),se&&(ge=f[0][0]-oe*R,se=!1),R=0;R<M;R++)me=f[R][0]-D[R]*oe-ge,200<Math.abs(me)&&(f[R][0]=0<me?f[R][0]-re:f[R][0]+re);if(A){for(R=0;R<M;R++)V[R]!=0&&(f[R][1]+=oe*V[R],f[R][1]>G?f[R][1]=G:f[R][1]<-G&&(f[R][1]=-G));for(A=0;A<M;A++)V[A]=0}v.pC(Z<<1,M,f),Z+=M,y-=M,M=Math.min(y,_)}a.Qc(1993)}}},l.BL=function(s,a,u,f){if(s.ow)f=90*s.ef.bf(),d.ua.ZJ(a,u,-f,f);else{var y=s.Yf,v=s.ef,_=s.$f;s=v.Zr();var M=_.Zr(),$=v.bf(),T=90*$,A=_.bf();if(y==null||y.count()==0){if(f=s/M,y=(v.Wp()-_.Wp())*A,d.ua.ZJ(a,u,-T,T),y!=0||f!=1)for(A=0;A<u;A++)a[A].x*=f,a[A].x+=y,a[A].y*=f}else{v=Math.min(u,f.length),T=d.P.mg(v),_=360*A,$=A/$;for(var R=!0,D=0,V=0;u!=0;){for(A=0;A<v;A++)T[A]=a[A+V].x;for(A=a[0].x,d.ua.Ey(f,a,V,v),y.transform(f,v,s,M),d.ua.Dy(a,V,f,v),R&&(D=a[0].x-$*A,R=!1),A=0;A<v;A++){var Z=a[V+A].x-T[A]*$-D;200<Math.abs(Z)&&(a[V+A].x=0<Z?a[V+A].x-_:a[V+A].x+_)}V+=v,u-=v,v=Math.min(u,f.length)}}}},l.fv=function(s,a){return s=s.ih(),isNaN(a)||s.Lu(a,0),s},l.PQ=function(s,a,u,f,y,v,_,M){for(var $=l.fv(f,y),T=$.S(),A=T/360,R=l.kE*A,D=s.vb(0),V=a.Xc(),Z=V?T/a.Le().S():0,ee=!1,G=new d.Ea(u.description),re=0,oe=u.ea();re<oe;++re){var se=V,ge=new d.Ua(u.description);if(ge.addPath(u,re,!0),_!=0){var me=l.KD(!0,ge,$.H-M,$.H,_);(ee=ee||me)&&(se=!1)}var Ie=-1;se&&(Ie=s.Ca(re));var De=ge.vb(0),Fe=ge.I(),gt=0,Ze=De.read(0),Vt=0;me=3*f.Yd(0);var Rt=!1,lt=new d.h;lt.Sc();var Ui=new d.h;Ui.Sc();for(var Vr=!1,Wi=1;Wi<Fe;++Wi){var Mi=d.h.construct(De.gg(2*Wi),De.gg(2*Wi+1)),Ii=Mi.x,ri=Ii+gt,sr=ri-Ze;if(Mi.x=ri,Math.abs(sr)>R){if(se){var Qt=Ie+(Wi+1<Fe?Wi:0),tn=D.read(2*(Ie+Wi-1));Qt=(D.read(2*Qt)-tn)*Z,Math.abs(sr-Qt)>1*A&&(se=!1)}se||(ri=Ii+(gt-=d.mc.En(T,ri-Ze)),++Vt,Vr=gt!=0,Mi.x=ri)}else Rt||d.ua.vG(Ui,lt,Mi,me)&&(Rt=!0);Vr&&De.write(2*Wi,ri),Ze=ri,Ui.N(lt),lt.N(Mi)}0<Vt&&ge.Qc(1993),se=ge.Oa(0),Fe=ge.Oa(Fe-1),ge=d.h.ub(se,Fe)<me?l.pQ(ge,f,y,v,Rt):l.qQ(s,re,ge,f,y),G.add(ge,!1)}return y=f.Yd(0),u=$.S()/180,l.Lt(G,$,.1*y,!1),G=G!=(y=d.ti.clip(G,$,y,u,v)),s=s.He(),_=0,0<(M=y.He())&&0>s?_=1:0>=M&&0<s&&(M==0?(M=NaN,a.Tb()==2?M=a.ol().He():a.Tb()==1&&(M=a.Le().rF()),s>.99*M&&(_=-1)):_=-1),_!=0&&((a=new d.Ea(y.description)).vp($),(a=d.Zl.local().W(a,u,v)).add(y,!1),G=!0,y=a),G&&(y=d.$l.local().W(y,f,!1,v)),y},l.qQ=function(s,a,u,f,y){var v=u.I(),_=u.Oa(0),M=u.Oa(v-1);y=(f=l.fv(f,y)).S(),_=d.mc.sign(M.x-_.x);var $=new d.l;u.yc($);var T=f.ik();if(M=T-y,T+=y,0<=_){var A=Math.ceil((M-$.v)/y);for(A*=y;M>$.v+A;)A+=y;for(;M<$.C+A;)A-=y;var R=A;720<$.S()&&(T=M+360*Math.ceil($.S()/360))}else{for(A=Math.ceil((T-$.C)/y),A*=y;T<$.C+A;)A-=y;for(;T>$.v+A;)A+=y;R=A,720<$.S()&&(M=T-360*Math.ceil($.S()/360))}A=_*y;var D=d.l.construct($.v,$.G,$.C,$.H);D.move(R,0);var V=new d.Ed;V.ig(R,0),u.Pc(V),($=new d.Ua(u.description)).add(u,!1),R=u.Oa(v-1),y=0;for(var Z=$.Oa(0).x;0<_?D.C<T:D.v>M;)D.move(A,0),V.Lb=A,u.Pc(V),Z+=A,f.v<=Z&&f.C>=Z&&(y=$.I()-1),u.Db(0,R),R=u.Oa(v-1),$.Fr(u,0,0,v-1,!1);return u=new d.Ea($.description),v=0<s.Kr(a),u.add($,!1),s=$.Oa(0),M=$.Oa($.I()-1),a=u.ea()-1,(0>_?v:!v)?(_=d.h.construct(M.x,f.H),u.Ei(_),_=d.h.construct(f.ik(),f.H),u.Ei(_),f=d.h.construct(s.x,f.H)):(_=d.h.construct(M.x,f.G),u.Ei(_),_=d.h.construct(f.ik(),f.G),u.Ei(_),f=d.h.construct(s.x,f.G)),u.Ei(f),u.sG(0,a,0),u.fO(y),u},l.pQ=function(s,a,u,f,y){var v=new d.Ea(s.description);v.add(s,!1),v.yB(0,v.I()-1);var _=new d.l;v.yc(_);var M=(u=l.fv(a,u)).S(),$=Math.ceil((u.v-_.v)/M);for($*=M;u.v>_.v+$;)$+=M;for(;u.v<_.C+$;)$-=M;if(($+=M)!=0){_.move($,0);var T=new d.Ed;T.ig($,0),v.Pc(T)}if(u.v<=_.v&&u.C>_.C)return y&&(y=v.He(),a=(v=d.$l.local().W(v,a,!0,f)).He(),(a=d.mc.sign(y)!=d.mc.sign(a))&&v.jJ()),v;for((s=new d.Ea(s.description)).add(v,!1),y=y||_.S()>M-a.Yd(0);_.v<u.C;)_.move(M,0),(T=new d.Ed).ig(M,0),v.Pc(T),s.add(v,!1);return y&&(y=s.He(),s.$o(1),a=(s=d.$l.local().W(s,a,!0,f)).He(),(a=d.mc.sign(y)!=d.mc.sign(a))&&s.jJ()),s},l.KD=function(s,a,u,f,y){for(var v=a.vb(0),_=a.I(),M=!1,$=0;$<_;$++){var T=d.h.construct(v.gg(2*$),v.gg(2*$+1));if((1&y)!=0&&T.y>=u){M=!0;break}if((2&y)!=0&&T.y<=-u){M=!0;break}}if(!M)return!1;v=!1,s&&(v=a.Pn(0)),_=(s=new d.hd).Ib(a),M=s.Ob(_);var A=-1,R=!0,D=new d.h;D.Sc(),$=new d.Ta;for(var V=-1,Z=s.Ya(M);Z!=-1;Z=s.V(Z)){T=s.Oa(Z);var ee=(1&y)!=0&&90<=T.y?1:0;if(ee|=(2&y)!=0&&T.y<=-u?2:0,0<A&&A!=ee){if(D.x!=T.x){D.x=T.x,s.Xi(s.Na(Z),$);var G=s.yj(M,Z,$);s.mf(G,D)}if(v)for(V=V!=-1?s.V(V):s.Ya(M),G=s.Na(Z);V!=G;)V=s.qd(V,!1);V=-1}0<ee&&(T.y=d.mc.En(f,T.y),s.mf(Z,T),R||A==ee||(T.x!=D.x?(s.Xi(Z,$),G=s.yj(M,Z,$),s.Db(G,D.x,T.y),V=G):V=Z)),A=ee,D=T,R=!1}if(v){if(V!=-1)for(V=s.V(V);V!=-1;)V=s.qd(V,!1);u=s.Ya(M),s.hq(u,s.tj(M))||(s.Xi(u,$),s.yj(M,-1,$))}return s.Ke(_).copyTo(a),!0},l.Hz=function(s,a,u,f){var y=s;if(y.B()||u==O.DontClip)return y;var v=y.K();if(v==33)return y=[(f=y).D()],l.tG(y,1,a,u),y[0].isNaN()?f.Pa():f.Db(y[0]),s;var _=(s=a.tc()).bf(),M=90*_,$=180*_,T=360*_,A=a.Bi(),R=.5*_,D=new d.l;y.A(D);var V=a.Xr(),Z=a.KQ(),ee=V.K()==197;if(a=new d.l,V.A(a),u==O.PannableFold&&(u=s.Le().S(),a.v=A-.5*u,a.C=a.v+u),D.G<-M||D.H>M){if(new d.l().L(D.v-_,-M,D.C+_,M),(y=d.ti.Pu(y,a,s,NaN,0,f)).B())return y;y.A(D)}if(Z&&(a.H<D.G||a.G>D.H))return y.Ja();if(D.S()>T&&(y=l.Jp(y,A-$,T,s,!0,0,!0,f)).A(D),(M=l.$N(D.v,D.C,a.v,a.C,T))!=0&&D.move(M,0),D.C>a.C||D.v<a.v){if(D.C>a.C)for(;D.v>=a.C;)D.move(-T,0),M-=T;for(;D.v<a.C-T;)D.move(T,0),M+=T}if(u=d.ua.Ju(s,V),M!=0&&((_=new d.Ed).ig(M,0),y.Pc(_)),Z){if(ee&&a.contains(D))return y;for(Z=[null,null],M=0;2>M;M++){if(ee?_=d.ba.Ic(v)?d.ti.clip(y,a,u,R,f):d.ti.clip(y,a,u,0,f):(_=d.Zj.local().W(y,V,s,f))==V&&(_=d.ba.kg(_)),a.v<=D.v&&a.C>=D.C||a.v>=D.v&&a.C<=D.C)return _;Z[M]=_,M==0&&(D.move(-T,0),(_=new d.Ed).ig(-T,0),y.Pc(_))}if(v==550)Z[0].Gd(Z[1],0,-1);else if(d.ba.Ic(v))Z[0].add(Z[1],!1);else{if(v!=33)throw d.i.ga("intersect_with_GCS_horizon: unexpected geometry type");Z[0].B()&&(Z[0]=Z[1])}return Z[0]}if(a.H<D.G||a.G>D.H)return y;for(v=0;!y.B()&&D.C>a.v;)v!=0&&((_=new d.Ed).ig(v,0),y.Pc(_)),d.fj.local().W(4,y,V,s,f)||V==(y=d.mp.local().W(y,V,s,f))&&(y=d.ba.kg(y)),v!=0&&((R=new d.Ed).ig(-v,0),y.Pc(R)),v-=T,D.move(-T,0);return y},l.tG=function(s,a,u,f){if(a!=0&&f!=O.DontClip)if(f==O.PannableFold){f=u.CR();for(var y=a,v=0;v<a;v++)(s[v].y>f.H||s[v].y<f.G)&&(s[v].Sc(),y--);y!=0&&l.cv(s,a,f.v,f.S())}else{var _=90*(f=u.bf()),M=180*f;for(f*=360,y=a,v=0;v<a;v++)(s[v].y>_||s[v].y<-_)&&(s[v].Sc(),y--);if(y!=0){(y=new d.l).bx(s,a),_=u.Xr();var $=u.kv();v=_.K()==197;var T=new d.l;if(_.A(T),!$||!(T.H<y.G||T.G>y.H))if($)if(l.cv(s,a,T.ik()-M,f),y=a,v)for(v=0;v<a;v++)T.contains(s[v])||(s[v].Sc(),y--);else for(u=d.ua.Ju(u.tc(),_),v=0;v<a;v++)(M=d.jd.Zd(_,s[v],u)!=0)||(s[v].Sc(),y--);else for(l.cv(s,a,-M,f),y=a,u=d.ua.Ju(u.tc(),_),v=0;v<a;v++)(M=s[v]).isNaN()&&y--,$=l.oE(M.x,T.v,T.C,f),M.x+=$,(M=d.jd.Zd(_,M,u)!=0)&&(s[v].Sc(),y--)}}},l.Jp=function(s,a,u,f,y,v,_,M){var $=s.K(),T=a+u;if($===33){var A=(f=y?s:s.Qf()).Ng();return(A<a||A>=T||_&&A==T)&&(A+=Math.ceil((a-A)/u)*u,A=d.P.Tk(A,a,T),f.YB(A)),f}if(s.B()||(A=new d.l,s.A(A),A.B()))return s;var R=new d.Oc;A.en(R);var D=new d.Oc;if(D.L(a,T),D.contains(R))return s;if((T=new d.l).L(A),$===550){for(M=(f=y?s:s.Qf()).vb(0),$=2*f.I(),T=!1,a=0;a<$;a+=2)((A=M.read(a))<D.pa||A>=D.wa||_&&A==D.wa)&&(T=!0,A+=Math.ceil((D.pa-A)/u)*u,A=D.Kt(A),M.write(a,A));return T&&f.Qc(1993),f}if($==197)return u=y?s:s.Qf(),A.Fa(T),u.Zo(A),u;var V=.1*Math.max(A.da(),A.S());for(T.X(0,V),_=s,D=f.Yd(0),s=d.Ih.local(),y=new d.Ed;;){var Z=Math.floor((R.pa-a)/u),ee=Math.ceil((R.wa-a)/u);if(!(3<ee-Z))break;Z=Math.floor(.5*(ee+Z)),T.v=A.v-V,T.C=a+u*Z;var G=d.ti.clip(_,T,D,v,M);T.v=T.C,T.C=A.C+V;var re=d.ti.clip(_,T,D,v,M);y.ig((Z-ee)*u,0),re.Pc(y),$==1736?_=s.W(G,re,f,null):(_=G).add(re,!1),_.A(A),A.en(R)}for(T.v=a,T.C=a+u,(a=new d.l).L(T),a.X(D,0),(a=Math.floor((A.v-T.v)/u)*u)!=0?(T.move(a,0),y.ig(-a,0)):y.MB(),a=$==1607?new d.Ua(_.description):new d.Ea(_.description),v=new d.l,R=new d.l;A.C>T.v;)(V=d.ti.clip(_,T,D,0,M)).A(R),($==1607?!V.B()&&(R.S()>D||R.da()>D):!V.B()&&($!=1736||R.S()>D))&&(V.Pc(y),V.A(R),a.A(v),v.X(D,D),v.isIntersecting(R)&&$==1736?a=s.W(a,V,f,null):a.add(V,!1)),T.move(u,0),y.shift(-u,0);return a},l.cv=function(s,a,u,f){for(var y=u+f,v=0;v<a;v++){var _=s[v].x;u<=_&&_<y||!(_<u||_>y||_==y)||(_+=Math.ceil((u-_)/f)*f,_=d.P.Tk(_,u,y),s[v].x=_)}},l.Hn=function(s,a,u,f,y,v){if(!a.Xc())throw d.i.ga("fold_into_360_degree_range");if(s.B())return s;if(a.Tb()==2){u=a.rv();var _=a.qv()-u}else{var M=a.bf();_=360*M,u-=180*M}return l.Jp(s,u,_,a,f,y,!0,v)},l.lF=function(s,a,u,f){if(u.Tb()==2)f=u.rv(),u=u.qv()-f;else{var y=u.bf();u=360*y,f-=180*y}l.cv(s,a,f,u)},l.nj=function(s,a){var u=a.Le();if(s.K()==33){var f=s.kh();return u.G<=f&&f<=u.H?s:s.Ja()}f=new d.l,s.A(f);var y=new d.l;return y.L(u),y.v=f.v,y.C=f.C,y.X(.01*y.da(),0),u=d.ua.py(a,f),y.contains(f)?s:d.ti.clip(s,y,u,0,null)},l.kr=function(s,a,u){return s>a.C&&s-a.C<u?a.C:s<a.v&&a.v-s<u?a.v:s},l.BX=function(s,a,u,f){f.x=l.kr(s.x,a,u),f.y=s.y},l.AX=function(s,a,u,f){for(var y=0;y<a;y++)s[y].y<u.G||s[y].y>u.H?s[y].Sc():s[y].x=l.kr(s[y].x,u,f)},l.Lt=function(s,a,u,f){if(!s.B()){var y=s.K();if(!f||y!=1736)if(d.ba.zj(y)){f=s.vb(0),y=0;for(var v=s.I();y<v;y++){var _=f.read(2*y),M=l.kr(_,a,u);M!=_&&f.write(2*y,M)}s.Qc(1993)}else if(y==197)f=new d.l,s.A(f),f.v=l.kr(f.v,a,u),f.C=l.kr(f.C,a,u),s.Zo(f);else{if(y!=33)throw d.i.ga("internal error");s.YB(l.kr(s.Ng(),a,u))}}},l.pS=function(s,a,u,f){var y=new d.hd,v=y.Ib(s);return s=d.ua.Ju(a,s),l.ms(y,v,a,s,u,!0,f),y.Ke(v)},l.ms=function(s,a,u,f,y,v,_){if(!u.Xc())throw d.i.O("invalid call");var M=u.Le(),$=u.tc(),T=$.gh().getDatum().getSpheroid();$=$.Id().ci;var A=T.getFlattening();T=T.getAxis(),A*=2-A;var R=new d.Oc;M.en(R);var D=null,V=[[0,0],[0,0]];if(u.Tb()==2?(D=u.gh(),v?(V[0][0]=l.an(_,R),V[0][1]=M.Lp(),d.gj.projToGeog(D,1,V),M=V[0][0]*$):(V[0][0]=M.ik(),V[0][1]=_,d.gj.projToGeog(D,1,V),M=V[0][1]*$)):M=_*$,!v&&M!=0&&y!=p.GreatElliptic)throw d.i.ga("invalid argument");var Z=new d.ha,ee=[0],G=new d.h,re=new d.h,oe=new d.h,se=[null,null],ge=new d.h,me=new d.h,Ie=new d.h,De=new d.h;for(a=s.Ob(a);a!=-1;a=s.Sb(a)){var Fe=s.Ya(a);s.D(Fe,ge);for(var gt=!1,Ze=Fe=s.V(Fe);Ze!=-1;Ze=s.V(Ze)){if(Ze==Fe){if(gt)break;gt=!0}if(s.D(Ze,me),v&&(f<_-ge.x&&me.x-_>f||f<_-me.x&&ge.x-_>f)||!v&&(_!=0||f<-ge.y&&me.y>f||f<-me.y&&ge.y>f))do if(!(Math.abs(ge.x-me.x)>=.5*R.S())){if(u.Tb()==2?(V[0][0]=l.an(ge.x,R),V[0][1]=ge.y,V[1][0]=l.an(me.x,R),V[1][1]=me.y,d.gj.projToGeogCenter(D,2,V,0),Ie.x=V[0][0]*$,Ie.y=V[0][1]*$,De.y=V[1][1]*$):(Ie.x=ge.x*$,Ie.y=ge.y*$,De.y=me.y*$),De.x=2*(me.x-ge.x)*Math.PI/R.S()+Ie.x,v){if(re.x=M,re.y=l.Iz(T,A,Ie,De,M,y),isNaN(re.y))break;se[0]=re;var Vt=1}else if(y==p.GreatElliptic){var Rt=[0,0];if((Vt=d.Nx.Jz(A,Ie,De,M,Rt))==0)break;re.x=Rt[0],re.y=M,se[0]=re,Vt==2&&(oe.x=Rt[1],oe.y=M,se[1]=oe)}else{if(re.x=l.Gz(T,A,Ie,De,y),isNaN(re.x))break;re.y=0,se[0]=re,Vt=1}var lt=-1;for(Rt=0;Rt<Vt;Rt++){d.kb.xd(T,A,Ie.x,Ie.y,De.x,De.y,Z,null,null,y);var Ui=Z.u;d.kb.xd(T,A,Ie.x,Ie.y,se[Rt].x,se[Rt].y,Z,null,null,y);var Vr=Z.u;if(u.Tb()==2?(V[0][0]=se[Rt].x/$,V[0][1]=se[Rt].y/$,d.gj.geogToProj(D,1,V),v?(G.y=V[0][1],G.x=_):(G.x=l.qs(V[0][0],ge.x,me.x,R),G.y=_)):v?(G.x=_,G.y=se[Rt].y/$):(G.x=l.qs(se[Rt].x/$,ge.x,me.x,R),G.y=_),ee[0]=0<Ui?d.P.Tk(Vr/Ui,0,1):.5,ee[0]==0||ee[0]==1)break;lt>ee[0]||(lt=s.Na(Ze),s.Wl(lt,ee,1),s.Db(s.V(lt),G.x,G.y),lt=ee[0])}}while(0);ge.N(me)}}},l.an=function(s,a){var u=a.wa-a.pa;return a.Kt(s-Math.floor((s-a.pa)/u)*u)},l.qs=function(s,a,u,f){var y=new d.Oc;for(y.L(a,u),u=f.S(),s=Math.floor((s-a)/u)*u+s,y=y.tf();Math.abs(s-y)>Math.abs(s+u-y);)s+=u;return s},l.Un=function(s,a,u){return s=d.sr.Ep(s),a=d.sr.mx(s,d.sr.Ep(a)),(u=d.sr.mx(s,d.sr.Ep(u)))==0||0<a&&0<u&&u<=a||0>a&&0>u&&u>=a},l.Iz=function(s,a,u,f,y,v){if(v==p.GreatElliptic)return d.Nx.NS(a,u,f,y);if(Math.abs(u.x-f.x)>=Math.PI||!l.Un(u.x,f.x,y))return NaN;if(u.x>f.x)var _=f;else _=u,u=f;f=new d.ha;var M=new d.ha,$=new d.ha;d.kb.xd(s,a,_.x,_.y,u.x,u.y,M,f,null,v);var T=M.u,A=0,R=1,D=new d.h;for(D.N(_);T*(R-A)>1e-12*s;){var V=.5*(A+R);if(d.kb.qj(s,a,_.x,_.y,T*V,f.u,M,$,v),D.x=M.u,D.y=$.u,D.x==y)break;if(l.Un(_.x,D.x,y))R=V;else{if(!l.Un(u.x,D.x,y))return NaN;A=V}}return D.y},l.Gz=function(s,a,u,f,y){if(y==p.GreatElliptic)return s=[0,0],d.Nx.Jz(a,u,f,0,s),s[0];if(u.y>f.y)var v=f;else v=u,u=f;if((f=new d.Oc).L(v.y,u.y),!f.contains(0)||Math.abs(v.x-u.x)>=Math.PI)return NaN;if(v.x==u.x)return v.x;var _=new d.ha,M=new d.ha,$=new d.ha;d.kb.xd(s,a,v.x,v.y,u.x,u.y,M,_,null,y);var T=M.u,A=0,R=1,D=new d.h;for(D.N(v);T*(R-A)>1e-12*s;){var V=.5*(A+R);if(d.kb.qj(s,a,v.x,v.y,T*V,_.u,M,$,y),D.x=M.u,D.y=$.u,f.L(v.y,D.y),D.y==0)break;if(f.contains(0))R=V;else{if(f.L(u.y,D.y),!f.contains(0))return NaN;A=V}}return D.x},l.RI=function(s,a,u,f){if(!s.ef.Xc())return!1;var y=new d.ee(a.description);if(y.Gd(a,0,-1),f=d.Gx.local().W(y,s,f),y=a.I(),u.Pa(),y!=f.I())return!1;var v=new d.l;a.A(v);var _=new d.l;if(f.A(_),v=v.S(),_=_.S(),v!=0&&_!=0){if(_/=v,s=s.$f.ih().S()/s.ef.ih().S(),1e-10<Math.abs(_/s-1))return!1}else if(v!=0||_!=0)return!1;for(u.add(a,!1),a=new d.h,s=0;s<y;s++)f.D(s,a),u.Db(s,a);return!0},l.lN=function(s,a){return(s%=360*a)>=180*a&&(s-=360*a),s},l.OI=function(s,a,u,f){if(u==O.Clip){var y=a.ol();y.K()==197?(u=new d.l,y.A(u),y=d.ua.py(a,u),s=d.ti.clip(s,u,y,5e4*a.rm(),f)):d.fj.local().W(1,y,s,a,f)||(s=d.Zj.local().W(s,y,a,f))==y&&(s=d.Xk.kg(s))}else a.Xc()&&(f=new d.l,s.yc(f),a.Le().contains(f)||(l.Lt(s,a.Le(),a.Yd(0),!0),u==O.PannableFold&&(s=l.nj(s,a)),s=l.Hn(s,a,0,!0,1e5*a.rm(),null)));return s},l.SD=function(s,a,u){var f=a.Yr();if(f==null)return s;var y=(a=a.tc()).Le().S(),v=new d.l;s.yc(v);var _=new d.Oc;v.en(_),v=f.Ha(),f=null;for(var M=new d.Ed;v.ab();)for(;v.Ia();){var $=v.ia(),T=$.Vg(0,0),A=new d.Oc;for(A.L(T.pa,T.wa),T=0;A.wa>_.pa;)A.move(-y),--T;for(;A.pa<=_.wa;){if(A.isIntersecting(_)){f==null&&(f=new d.Ua);var R=d.zb.YO($.bc(),$.xc());T!=0&&(M.ig(T*y,0),R.Pc(M)),f.pc(R,!0)}A.move(y),++T}}return f!=null?(a=d.ua.bO(a,f),a=d.ua.Gr(a),d.bu.gP(s,f,a,u)):s},l.$N=function(s,a,u,f,y){return s>=u&&a<=f?0:l.oE(.5*(a+s),u,f,y)},l.oE=function(s,a,u,f){return d.mc.round((.5*(u+a)-s)/f)*f},l.QQ=function(s,a,u,f,y,v,_,M){var $=l.fv(f,y),T=$.S(),A=T/360,R=l.kE*A,D=s.vb(0),V=a.Xc(),Z=V?T/a.Le().S():0;a=s.Ja();for(var ee=0,G=u.ea();ee<G;++ee){var re=V,oe=new d.Ua(u.description);oe.addPath(u,ee,!0);var se=u.ec(ee);_!=0&&(se=l.KD(se,oe,$.H-M,$.H,_))&&(re=!1);var ge=-1;se=oe.I();var me=!1;re&&(ge=s.Ca(ee),me=s.ec(ee));var Ie=oe.vb(0),De=0,Fe=Ie.read(0),gt=0,Ze=3*f.Yd(0),Vt=!1,Rt=new d.h;Rt.Sc();var lt=new d.h;lt.Sc();for(var Ui=!1,Vr=1;Vr<se;++Vr){var Wi=d.h.construct(Ie.gg(2*Vr),Ie.gg(2*Vr+1)),Mi=Wi.x,Ii=Mi+De,ri=Ii-Fe;if(Wi.x=Ii,Math.abs(ri)>R){if(re){var sr=ge+Vr-1,Qt=ge;(!me||Vr+1<se)&&(Qt+=Vr),sr=D.read(2*sr),Qt=(D.read(2*Qt)-sr)*Z,Math.abs(ri-Qt)>1*A&&(V=!1)}re||(Ii=Mi+(De-=d.mc.En(T,Ii-Fe)),++gt,Ui=De!=0,Wi.x=Ii)}else Vt||d.ua.vG(Rt,lt,Wi,Ze)&&(Vt=!0);Ui&&Ie.write(2*Vr,Ii),Fe=Ii,Rt.N(lt),lt.N(Wi)}gt!=0&&oe.Qc(1993),re=oe.Oa(0),se=oe.Oa(se-1),d.h.ub(re,se),oe=l.rQ(oe,f,isNaN(y)?0:y,v),a.add(oe,!1)}return s=f.Yd(0),u=$.S()/180,l.Lt(a,$,.1*s,!1),d.ti.clip(a,$,s,u,v)},l.rQ=function(s,a,u,f){return l.Hn(s,a,u,!0,0,f)},l.JS=function(s,a,u,f){var y=s.K();if(y==1736)for(a=a!=null?a.Yd(0):0,y=0;y<f;y++)d.jd.Zd(s,u[y],a)!=1&&u[y].Sc();else{if(y!=197)throw d.i.O();for(y=0;y<f;y++)s.ZO(u[y])||u[y].Sc()}},l.bl=function(s,a,u,f){if(32>u)for(var y=new d.Ta,v=0;v<u;v++)y.Db(a[v]),s.bl(y,f).D(a[v]);else{var _=new d.ee;for(_.se(3),_.CD(a,u),y=_.vb(3),v=0;v<u;v++)y.write(v,v);for(v=s.bl(_,f),s=v.vb(0),y=v.vb(3),f=d.h.construct(NaN,NaN),_=0;_<u;_++)a[_]=f;for(u=v.I(),v=0;v<u;v++)f=y.read(v),s.uc(2*v,a[f])}},l.al=function(s,a,u,f){if(32>u)for(var y=new d.Ta,v=0;v<u;v++)y.Db(a[v]),s.al(y,f).D(a[v]);else{var _=new d.ee;for(_.se(3),_.CD(a,u),y=_.vb(3),v=0;v<u;v++)y.write(v,v);for(v=s.al(_,f),s=v.vb(0),y=v.vb(3),f=d.h.construct(NaN,NaN),_=0;_<u;_++)a[_]=f;for(u=v.I(),v=0;v<u;v++)f=y.read(v),s.uc(2*v,a[f])}},l.kE=210,l}()}(Q||(Q={})),function(d){var O;(O=d.PL||(d.PL={}))[O.rightSide=1]="rightSide";var S=function(){function p(l,s,a){this.Ds=new d.h,l===void 0?this.Ko=-1:(this.Ds.N(l),this.Ko=s,this.La=a,this.pw=0)}return p.prototype.RJ=function(l){this.pw=l?1|this.pw:-2&this.pw},p.prototype.B=function(){return 0>this.Ko},p.prototype.az=function(){if(this.B())throw d.i.ga("invalid call");return new d.Ta(this.Ds.x,this.Ds.y)},p.prototype.Va=function(){if(this.B())throw d.i.ga("invalid call");return this.Ko},p.prototype.cz=function(){if(this.B())throw d.i.ga("invalid call");return this.La},p.prototype.Nz=function(){return(1&this.pw)!=0},p.prototype.by=function(l,s,a,u){this.Ds.x=l,this.Ds.y=s,this.Ko=a,this.La=u},p}();d.bm=S}(Q||(Q={})),function(d){var O=function(){function p(){}return p.prototype.Wo=function(l,s){this.vh.resize(0),this.Ki.length=0,this.vk=-1,l.yc(this.Gk),this.Gk.X(s,s),this.Gk.isIntersecting(this.Gb.Da)?((this.xs=d.ba.zd(l.K()))?(this.OH=l.bc(),this.NH=l.xc(),this.ra=s):this.ra=NaN,this.vh.add(this.Gb.kf),this.Ki.push(this.Gb.Da),this.Ss=this.Gb.Wr(this.Gb.kf)):this.Ss=-1},p.prototype.Zi=function(l,s){this.vh.resize(0),this.Ki.length=0,this.vk=-1,this.Gk.L(l),this.Gk.X(s,s),this.ra=NaN,this.Gk.isIntersecting(this.Gb.Da)?(this.vh.add(this.Gb.kf),this.Ki.push(this.Gb.Da),this.Ss=this.Gb.Wr(this.Gb.kf),this.xs=!1):this.Ss=-1},p.prototype.next=function(){if(this.vh.size==0)return-1;this.vk=this.Ss;var l=null,s=null,a=null,u=null;this.xs&&(l=new d.h,s=new d.h,a=new d.l);for(var f=!1;!f;){for(;this.vk!=-1;){var y=this.Gb.Xy(this.Gb.hv(this.vk));if(y.isIntersecting(this.Gk)){if(!this.xs){f=!0;break}if(l.N(this.OH),s.N(this.NH),a.L(y),a.X(this.ra,this.ra),0<a.uy(l,s)){f=!0;break}}this.vk=this.Gb.pv(this.vk)}if(this.vk==-1){y=this.vh.Gc();var v=this.Ki[this.Ki.length-1];for(u==null&&((u=[])[0]=new d.l,u[1]=new d.l,u[2]=new d.l,u[3]=new d.l),S.zJ(v,u),this.vh.Jf(),--this.Ki.length,v=0;4>v;v++){var _=this.Gb.Np(y,v);if(_!=-1&&0<this.Gb.RR(_)&&u[v].isIntersecting(this.Gk))if(this.xs){if(l.N(this.OH),s.N(this.NH),a.L(u[v]),a.X(this.ra,this.ra),0<a.uy(l,s)){var M=new d.l;M.L(u[v]),this.vh.add(_),this.Ki.push(M)}}else(M=new d.l).L(u[v]),this.vh.add(_),this.Ki.push(M)}if(this.vh.size==0)return-1;this.vk=this.Gb.Wr(this.vh.get(this.vh.size-1))}}return this.Ss=this.Gb.pv(this.vk),this.vk},p.XO=function(l,s,a){var u=new p;return u.Gb=l,u.Gk=new d.l,u.vh=new d.ja(0),u.Ki=[],u.Wo(s,a),u},p.WO=function(l,s,a){var u=new p;return u.Gb=l,u.Gk=new d.l,u.vh=new d.ja(0),u.Ki=[],u.Zi(s,a),u},p.VO=function(l){var s=new p;return s.Gb=l,s.Gk=new d.l,s.vh=new d.ja(0),s.Ki=[],s},p}();d.CY=O;var S=function(){function p(l,s){this.jf=new d.ad(11),this.ai=new d.ad(5),this.ys=[],this.iw=new d.ja(0),this.Da=new d.l,this.Pk(l,s)}return p.prototype.reset=function(l,s){this.jf.oj(!1),this.ai.oj(!1),this.ys.length=0,this.iw.clear(!1),this.Pk(l,s)},p.prototype.xj=function(l,s){return this.Bv(l,s,0,this.Da,this.kf,!1,-1)},p.prototype.Ez=function(l,s,a){a=a==-1?this.kf:this.RF(a);var u=this.da(a),f=this.jR(a);return this.Bv(l,s,u,f,a,!1,-1)},p.prototype.ka=function(l){return this.eR(l)},p.prototype.BF=function(l){return this.Xy(this.hv(l))},p.prototype.da=function(l){return this.lv(l)},p.prototype.jR=function(l){var s=new d.l;s.L(this.Da);var a=this.lv(l);l=this.LF(l);for(var u=0;u<2*a;u+=2){var f=d.P.truncate(3&l>>u);f==0?(s.v=.5*(s.v+s.C),s.G=.5*(s.G+s.H)):f==1?(s.C=.5*(s.v+s.C),s.G=.5*(s.G+s.H)):(f==2?s.C=.5*(s.v+s.C):s.v=.5*(s.v+s.C),s.H=.5*(s.G+s.H))}return s},p.prototype.RR=function(l){return this.vz(l)},p.prototype.qR=function(l,s){return O.XO(this,l,s)},p.prototype.HF=function(l,s){return O.WO(this,l,s)},p.prototype.getIterator=function(){return O.VO(this)},p.prototype.Pk=function(l,s){if(0>s||32<2*s)throw d.i.O("invalid height");this.wT=s,this.Da.L(l),this.kf=this.jf.De(),this.jx(this.kf,0),this.dx(this.kf,0),this.IJ(this.kf,0),this.FJ(this.kf,0)},p.prototype.Bv=function(l,s,a,u,f,y,v){if(!u.contains(s))return a==0?-1:this.Bv(l,s,0,this.Da,this.kf,y,v);if(!y)for(var _=f;_!=-1;_=this.DR(_))this.jx(_,this.vz(_)+1);(_=new d.l).L(u),u=f;var M=[];for(M[0]=new d.l,M[1]=new d.l,M[2]=new d.l,M[3]=new d.l;a<this.wT&&this.dO(u);a++){p.zJ(_,M);for(var $=!1,T=0;4>T;T++)if(M[T].contains(s)){$=!0;var A=this.Np(u,T);A==-1&&(A=this.mP(u,T)),this.jx(A,this.vz(A)+1),u=A,_.L(M[T]);break}if(!$)break}return this.nS(l,s,a,_,u,y,f,v)},p.prototype.nS=function(l,s,a,u,f,y,v,_){var M=this.IF(f);if(y){if(f==v)return _;this.NP(_),y=_}else y=this.oP(),this.IB(y,l),this.FW(this.hv(y),s);return this.hX(y,f),M!=-1?(this.hx(y,M),this.ex(M,y)):this.BJ(f,y),this.NB(f,y),this.dx(f,this.nv(f)+1),this.cO(f)&&this.HQ(a,u,f),y},p.prototype.NP=function(l){var s=this.RF(l),a=this.IF(s),u=this.JR(l),f=this.pv(l);this.Wr(s)==l?(f!=-1?this.hx(f,-1):this.NB(s,-1),this.BJ(s,f)):a==l?(this.ex(u,-1),this.NB(s,u)):(this.hx(f,u),this.ex(u,f)),this.hx(l,-1),this.ex(l,-1),this.dx(s,this.nv(s)-1)},p.zJ=function(l,s){var a=.5*(l.v+l.C),u=.5*(l.G+l.H);s[0].L(a,u,l.C,l.H),s[1].L(l.v,u,a,l.H),s[2].L(l.v,l.G,a,u),s[3].L(a,l.G,l.C,u)},p.prototype.cO=function(l){return this.nv(l)==8&&!this.bG(l)},p.prototype.HQ=function(l,s,a){var u=this.Wr(a);do{var f=this.hv(u),y=this.ai.U(u,0);f=this.Xy(f),this.Bv(y,f,l,s,a,!0,u),u=y=this.pv(u)}while(u!=-1)},p.prototype.dO=function(l){return 8<=this.nv(l)||this.bG(l)},p.prototype.bG=function(l){return this.Np(l,0)!=-1||this.Np(l,1)!=-1||this.Np(l,2)!=-1||this.Np(l,3)!=-1},p.prototype.mP=function(l,s){var a=this.jf.De();return this.JW(l,s,a),this.jx(a,0),this.dx(a,0),this.Rk(a,l),this.FJ(a,this.lv(l)+1),this.IJ(a,s<<2*this.lv(l)|this.LF(l)),a},p.prototype.oP=function(){var l=this.ai.De();if(0<this.iw.size){var s=this.iw.Gc();this.iw.Jf()}else s=this.ys.length,this.ys.push(new d.l);return this.GW(l,s),l},p.prototype.Np=function(l,s){return this.jf.U(l,s)},p.prototype.JW=function(l,s,a){this.jf.T(l,s,a)},p.prototype.Wr=function(l){return this.jf.U(l,4)},p.prototype.BJ=function(l,s){this.jf.T(l,4,s)},p.prototype.IF=function(l){return this.jf.U(l,5)},p.prototype.NB=function(l,s){this.jf.T(l,5,s)},p.prototype.LF=function(l){return this.jf.U(l,6)},p.prototype.IJ=function(l,s){this.jf.T(l,6,s)},p.prototype.nv=function(l){return this.jf.U(l,7)},p.prototype.vz=function(l){return this.jf.U(l,8)},p.prototype.dx=function(l,s){this.jf.T(l,7,s)},p.prototype.jx=function(l,s){this.jf.T(l,8,s)},p.prototype.DR=function(l){return this.jf.U(l,9)},p.prototype.Rk=function(l,s){this.jf.T(l,9,s)},p.prototype.lv=function(l){return this.jf.U(l,10)},p.prototype.FJ=function(l,s){this.jf.T(l,10,s)},p.prototype.eR=function(l){return this.ai.U(l,0)},p.prototype.IB=function(l,s){this.ai.T(l,0,s)},p.prototype.JR=function(l){return this.ai.U(l,1)},p.prototype.pv=function(l){return this.ai.U(l,2)},p.prototype.hx=function(l,s){this.ai.T(l,1,s)},p.prototype.ex=function(l,s){this.ai.T(l,2,s)},p.prototype.RF=function(l){return this.ai.U(l,3)},p.prototype.hX=function(l,s){this.ai.T(l,3,s)},p.prototype.hv=function(l){return this.ai.U(l,4)},p.prototype.GW=function(l,s){this.ai.T(l,4,s)},p.prototype.Xy=function(l){return this.ys[l]},p.prototype.FW=function(l,s){this.ys[l].L(s)},p}();d.fu=S}(Q||(Q={})),function(d){var O;(O=d.WK||(d.WK={}))[O.Outside=0]="Outside",O[O.Inside=1]="Inside",O[O.Border=2]="Border";var S=function(){function l(s,a){this.KT=a,this.Xh=s}return l.prototype.ax=function(s,a){this.dH!=a&&s.flush(),this.dH=a},l.prototype.bF=function(s,a){for(var u=0;u<a;)for(var f=s[u++],y=s[u++],v=s[u++]*this.KT;f<y;f++)this.Xh[v+(f>>4)]|=this.dH<<2*(15&f)},l}();d.DY=S;var p=function(){function l(s,a,u){this.Xh=null,this.NA=this.Kk=this.YH=this.WH=this.Gs=this.lH=this.Hf=this.Wm=0,this.Ti=this.Lk=this.xl=null,this.Az(s,a,u)}return l.create=function(s,a,u){if(!l.uE(s))throw d.i.O();return l.rP(s,a,u)},l.kW=function(s){switch(s){case 0:s=1024;break;case 1:s=16384;break;case 2:s=262144;break;default:throw d.i.ga("Internal Error")}return s},l.uE=function(s){return!(s.B()||s.K()!=1607&&s.K()!=1736)},l.prototype.mQ=function(s,a){a=a.Ha();for(var u=new d.h,f=new d.h;a.ab();)for(;a.Ia();){var y=a.ia();if(y.K()!=322)throw d.i.ga("Internal Error");s.Gh(y.bc(),u),s.Gh(y.xc(),f),this.Ti.fy(u.x,u.y,f.x,f.y)}this.Ti.dJ(d.Ox.Bx)},l.prototype.nQ=function(){throw d.i.ga("Internal Error")},l.prototype.My=function(s,a){for(var u=1;4>u;u++)s.fy(a[u-1].x,a[u-1].y,a[u].x,a[u].y);s.fy(a[3].x,a[3].y,a[0].x,a[0].y),this.Ti.dJ(d.Ox.Bx)},l.prototype.mK=function(s,a,u){for(var f=[null,null,null,null],y=0;y<f.length;y++)f[y]=new d.h;a=a.Ha(),u=this.Lk.$X(u)+1.5,y=new d.h;for(var v=new d.h,_=new d.h,M=new d.h,$=new d.h,T=new d.l,A=new d.h;a.ab();){var R=!1,D=!0;for(A.na(0,0);a.Ia();){var V=a.ia();if(M.x=V.ta,M.y=V.oa,$.x=V.qa,$.y=V.ma,T.Pa(),T.$b(M.x,M.y),T.Nk($.x,$.y),this.xl.CG(T)){this.Lk.Gh($,$),D?(this.Lk.Gh(M,M),A.N(M),D=!1):M.N(A),y.vc($,M);var Z=.5>(V=y.length());V==0?y.na(1,0):(Z||A.N($),y.scale(u/V),v.na(-y.y,y.x),_.na(y.y,-y.x),M.sub(y),$.add(y),f[0].add(M,v),f[1].add(M,_),f[2].add($,_),f[3].add($,v),Z?R=!0:this.My(s,f))}else R&&(this.My(s,f),R=!1),D=!0}R&&this.My(s,f)}},l.prototype.nC=function(s){return d.P.truncate(s*this.lH+this.WH)},l.prototype.oC=function(s){return d.P.truncate(s*this.Gs+this.YH)},l.rP=function(s,a,u){return new l(s,a,u)},l.prototype.Az=function(s,a,u){this.Hf=Math.max(d.P.truncate(2*Math.sqrt(u)+.5),64),this.Wm=d.P.truncate((2*this.Hf+31)/32),this.xl=new d.l,this.Kk=a,u=0;for(var f=this.Hf,y=this.Wm;8<=f;)u+=f*y,f=d.P.truncate(f/2),y=d.P.truncate((2*f+31)/32);this.Xh=d.P.mg(u,0),this.Ti=new d.Ox,u=new S(this.Xh,this.Wm,this),this.Ti.wX(this.Hf,this.Hf,u),s.A(this.xl),this.xl.X(a,a),f=new d.l;var v=a*(y=d.l.construct(1,1,this.Hf-2,this.Hf-2)).S();switch(a*=y.da(),f.L(this.xl.tf(),Math.max(v,this.xl.S()),Math.max(a,this.xl.da())),this.NA=this.Kk,this.Lk=new d.Ed,this.Lk.kS(f,y),new d.Ed,s.K()){case 550:u.ax(this.Ti,2),this.nQ();break;case 1607:u.ax(this.Ti,2),this.mK(this.Ti,s,this.NA);break;case 1736:u.ax(this.Ti,1),this.mQ(this.Lk,s),u.ax(this.Ti,2),this.mK(this.Ti,s,this.NA)}this.lH=this.Lk.eb,this.Gs=this.Lk.bb,this.WH=this.Lk.Lb,this.YH=this.Lk.Qb,this.SN()},l.prototype.SN=function(){this.Ti.flush();for(var s=0,a=this.Hf*this.Wm,u=this.Hf,f=d.P.truncate(this.Hf/2),y=this.Wm,v=d.P.truncate((2*f+31)/32);8<u;){for(u=0;u<f;u++)for(var _=2*u,M=2*u+1,$=0;$<f;$++){var T=2*$,A=2*$+1,R=T>>4;T=2*(15&T);var D=A>>4;A=2*(15&A);var V=this.Xh[s+y*_+R]>>T&3;V|=this.Xh[s+y*_+D]>>A&3,V|=this.Xh[s+y*M+R]>>T&3,V|=this.Xh[s+y*M+D]>>A&3,this.Xh[a+v*u+($>>4)]|=V<<2*(15&$)}u=f,y=v,s=a,f=d.P.truncate(u/2),v=d.P.truncate((2*f+31)/32),a=s+y*u}},l.prototype.Uo=function(s,a){return this.xl.contains(s,a)?(s=this.nC(s),a=this.oC(a),0>s||s>=this.Hf||0>a||a>=this.Hf||(a=this.Xh[this.Wm*a+(s>>4)]>>2*(15&s)&3)==0?0:a==1?1:2):0},l.prototype.To=function(s){if(!s.Fa(this.xl))return 0;var a=this.nC(s.v),u=this.nC(s.C),f=this.oC(s.G);if(s=this.oC(s.H),0>a&&(a=0),0>f&&(f=0),u>=this.Hf&&(u=this.Hf-1),s>=this.Hf&&(s=this.Hf-1),a>u||f>s)return 0;for(var y=Math.max(u-a,1)*Math.max(s-f,1),v=0,_=this.Wm,M=this.Hf,$=0;;){if(32>y||16>M){for(y=f;y<=s;y++)for(var T=a;T<=u;T++)if(1<($=this.Xh[v+_*y+(T>>4)]>>2*(15&T)&3))return 2;if($==0)return 0;if($==1)return 1}v+=_*M,M=d.P.truncate(M/2),_=d.P.truncate((2*M+31)/32),a=d.P.truncate(a/2),f=d.P.truncate(f/2),u=d.P.truncate(u/2),s=d.P.truncate(s/2),y=Math.max(u-a,1)*Math.max(s-f,1)}},l.prototype.MR=function(){return this.Hf*this.Wm},l}();d.Mx=p}(Q||(Q={})),function(d){var O;(O=d.QL||(d.QL={}))[O.contains=1]="contains",O[O.within=2]="within",O[O.equals=3]="equals",O[O.disjoint=4]="disjoint",O[O.touches=8]="touches",O[O.crosses=16]="crosses",O[O.overlaps=32]="overlaps",O[O.unknown=0]="unknown",O[O.intersects=1073741824]="intersects";var S=function(){function l(){}return l.construct=function(s,a,u,f,y,v,_,M){var $=new l;return $.rw=s,$.Om=a,$.Mj=u,$.Ui=f,$.wH=y,$.OY=v,$.PY=_,$.QY=M,$},l}();d.Xt=function(){function l(){}return l.xD=function(s,a,u){if(l.ry(s)){var f=d.ua.mj(a,s,!1);a=!1,d.Wk.xE(s)&&(a=a||s.nu(f,u)),(f=s.K())!=1736&&f!=1607||!d.Wk.vE(s)||u==0||(a=a||s.hj(u)),f!=1736&&f!=1607||!d.Wk.wE(s)||u==0||a||s.cM()}},l.ry=function(s){return d.Wk.xE(s)||d.Wk.vE(s)||d.Wk.wE(s)},l}();var p=function(){function l(){this.th=[]}return l.uB=function(s,a,u,f,y){var v=s.K(),_=a.K();if(v==197){if(_==197)return l.oW(s,a,u,f);if(_==33)return f==2?f=1:f==1&&(f=2),l.cJ(a,s,u,f)}else if(v==33){if(_==197)return l.cJ(s,a,u,f);if(_==33)return l.qW(s,a,u,f)}if(s.B()||a.B())return f==4;var M=new d.l;s.A(M);var $=new d.l;a.A($);var T=new d.l;if(T.L(M),T.$b($),u=d.ua.Xd(u,T,!1),l.fk(M,$,u))return f==4;switch(M=!1,d.Xk.zd(v)&&((v=new d.Ua(s.description)).pc(s,!0),s=v,v=1607),d.Xk.zd(_)&&((_=new d.Ua(a.description)).pc(a,!0),a=_,_=1607),v!=197&&_!=197?(s.Eb()<a.Eb()||v==33&&_==550)&&(f==2?f=1:f==1&&(f=2)):v!=1736&&_!=197&&(f==2?f=1:f==1&&(f=2)),v){case 1736:switch(_){case 1736:M=l.st(s,a,u,f,y);break;case 1607:M=l.bn(s,a,u,f,y);break;case 33:M=l.rt(s,a,u,f);break;case 550:M=l.qt(s,a,u,f,y);break;case 197:M=l.BI(s,a,u,f,y)}break;case 1607:switch(_){case 1736:M=l.bn(a,s,u,f,y);break;case 1607:M=l.bB(s,a,u,f,y);break;case 33:M=l.ut(s,a,u,f,y);break;case 550:M=l.tt(s,a,u,f,y);break;case 197:M=l.HI(s,a,u,f)}break;case 33:switch(_){case 1736:M=l.rt(a,s,u,f);break;case 1607:M=l.ut(a,s,u,f,y);break;case 550:M=l.mt(a,s,u,f)}break;case 550:switch(_){case 1736:M=l.qt(a,s,u,f,y);break;case 1607:M=l.tt(a,s,u,f,y);break;case 550:M=l.UA(s,a,u,f,y);break;case 33:M=l.mt(s,a,u,f);break;case 197:M=l.cI(s,a,u,f)}break;case 197:switch(_){case 1736:M=l.BI(a,s,u,f,y);break;case 1607:M=l.HI(a,s,u,f);break;case 550:M=l.cI(a,s,u,f)}}return M},l.oW=function(s,a,u,f){if(s.B()||a.B())return f==4;var y=new d.l,v=new d.l,_=new d.l;switch(s.A(y),a.A(v),_.L(y),_.$b(v),s=d.ua.Xd(u,_,!1),f){case 4:return l.fk(y,v,s);case 2:return l.eF(v,y,s);case 1:return l.eF(y,v,s);case 3:return l.gk(y,v,s);case 8:return l.YP(y,v,s);case 32:return l.XP(y,v,s);case 16:return l.WP(y,v,s)}return!1},l.cJ=function(s,a,u,f){if(s.B()||a.B())return f==4;s=s.D();var y=new d.l,v=new d.l;switch(a.A(y),v.L(s),v.$b(y),a=d.ua.Xd(u,v,!1),f){case 4:return l.Tw(s,y,a);case 2:return l.$A(s,y,a);case 1:return l.MU(s,y,a);case 3:return l.qI(s,y,a);case 8:return l.ZA(s,y,a)}return!1},l.qW=function(s,a,u,f){if(s.B()||a.B())return f==4;s=s.D(),a=a.D();var y=new d.l;switch(y.L(s),y.$b(a),u=d.ua.Xd(u,y,!1),f){case 4:return l.NU(s,a,u);case 2:return l.pI(a,s,u);case 1:return l.pI(s,a,u);case 3:return l.rI(s,a,u)}return!1},l.st=function(s,a,u,f,y){switch(f){case 4:return l.fV(s,a,u);case 2:return l.Uw(a,s,u,y);case 1:return l.Uw(s,a,u,y);case 3:return l.iV(s,a,u);case 8:return l.qV(s,a,u);case 32:return l.lV(s,a,u,y)}return!1},l.bn=function(s,a,u,f,y){switch(f){case 4:return l.gV(s,a,u);case 1:return l.aB(s,a,u,y);case 8:return l.rV(s,a,u,y);case 16:return l.bV(s,a,u)}return!1},l.rt=function(s,a,u,f){switch(f){case 4:return l.eV(s,a,u);case 1:return l.ZU(s,a,u);case 8:return l.pV(s,a,u)}return!1},l.qt=function(s,a,u,f){switch(f){case 4:return l.dV(s,a,u);case 1:return l.YU(s,a,u);case 8:return l.oV(s,a,u);case 16:return l.aV(s,a,u)}return!1},l.BI=function(s,a,u,f,y){if(l.cV(s,a,u))return f==4;if(f==4)return!1;switch(f){case 2:return l.sV(s,a,u);case 1:return l.XU(s,a,u);case 3:return l.hV(s,a,u);case 8:return l.nV(s,a,u,y);case 32:return l.kV(s,a,u,y);case 16:return l.$U(s,a,u,y)}return!1},l.bB=function(s,a,u,f){switch(f){case 4:return l.BV(s,a,u);case 2:return l.FI(a,s,u);case 1:return l.FI(s,a,u);case 3:return l.DV(s,a,u);case 8:return l.II(s,a,u);case 32:return l.HV(s,a,u);case 16:return l.GI(s,a,u)}return!1},l.ut=function(s,a,u,f){switch(f){case 4:return l.AV(s,a,u);case 1:return l.vV(s,a,u);case 8:return l.LV(s,a,u)}return!1},l.tt=function(s,a,u,f){switch(f){case 4:return l.zV(s,a,u);case 1:return l.uV(s,a,u);case 8:return l.KV(s,a,u);case 16:return l.xV(s,a,u)}return!1},l.HI=function(s,a,u,f){if(l.yV(s,a,u))return f==4;if(f==4)return!1;switch(f){case 2:return l.MV(s,a,u);case 1:return l.tV(s,a,u);case 3:return l.CV(s,a,u);case 8:return l.JV(s,a,u);case 32:return l.GV(s,a,u);case 16:return l.wV(s,a,u)}return!1},l.UA=function(s,a,u,f){switch(f){case 4:return l.bU(s,a,u);case 2:return l.$H(a,s,u);case 1:return l.$H(s,a,u);case 3:return l.dU(s,a,u);case 32:return l.jU(s,a,u)}return!1},l.mt=function(s,a,u,f){switch(f){case 4:return l.aI(s,a,u);case 2:return l.nU(s,a,u);case 1:return l.ZT(s,a,u);case 3:return l.Pw(s,a,u)}return!1},l.cI=function(s,a,u,f){switch(f){case 4:return l.aU(s,a,u);case 2:return l.mU(s,a,u);case 1:return l.YT(s,a,u);case 3:return l.cU(s,a,u);case 8:return l.lU(s,a,u);case 16:return l.$T(s,a,u)}return!1},l.iV=function(s,a,u){var f=new d.l,y=new d.l;return s.A(f),a.A(y),!!l.gk(f,y,u)&&(f=l.rc(s,a,!1))!=4&&f!=1&&f!=2&&(!!l.ZH(s,a,u)||(f=s.Rb(),y=a.Rb(),!(Math.abs(f-y)>4*Math.max(s.I(),a.I())*u)&&l.Rz(s,a,u,!0)))},l.fV=function(s,a,u){var f=l.rc(s,a,!0);return f==4||f!=1&&f!=2&&f!=1073741824&&l.zI(s,a,u)},l.qV=function(s,a,u){var f=l.rc(s,a,!1);return f!=4&&f!=1&&f!=2&&l.DI(s,a,u,null)},l.lV=function(s,a,u,f){var y=l.rc(s,a,!1);return y!=4&&y!=1&&y!=2&&l.AI(s,a,u,f)},l.Uw=function(s,a,u,f){var y=new d.l,v=new d.l;return s.A(y),a.A(v),!!l.Ac(y,v,u)&&(y=l.rc(s,a,!1))!=4&&y!=2&&(y==1||l.wI(s,a,u,f))},l.gV=function(s,a,u){var f=l.rc(s,a,!0);return f==4||f!=1&&f!=1073741824&&l.zI(s,a,u)},l.rV=function(s,a,u,f){var y=l.rc(s,a,!1);return y!=4&&y!=1&&l.EI(s,a,u,f)},l.bV=function(s,a,u){var f=l.rc(s,a,!1);return f!=4&&f!=1&&l.yI(s,a,u,null)},l.aB=function(s,a,u,f){var y=new d.l,v=new d.l;return s.A(y),a.A(v),!!l.Ac(y,v,u)&&(y=l.rc(s,a,!1))!=4&&(y==1||l.xI(s,a,u,f))},l.eV=function(s,a,u){return d.jd.FG(s,a,u)==0},l.pV=function(s,a,u){return a=a.D(),l.CI(s,a,u)},l.ZU=function(s,a,u){return a=a.D(),l.vI(s,a,u)},l.dV=function(s,a,u){var f=l.rc(s,a,!1);if(f==4)return!0;if(f==1)return!1;f=new d.l,s.A(f),f.X(u,u);for(var y=new d.h,v=0;v<a.I();v++)if(a.D(v,y),f.contains(y)){var _=d.jd.Zd(s,y,u);if(_==1||_==2)return!1}return!0},l.oV=function(s,a,u){var f=this.rc(s,a,!1);if(f==4||f==1)return!1;f=new d.l,s.A(f),f.X(u,u);for(var y=!1,v=s,_=!1,M=0;M<a.I();M++){var $=a.Oa(M);if(f.contains($)){if(($=d.jd.Zd(v,$,u))==2)y=!0;else if($==1)return!1}_||(!d.Fg.Ol(s,a.I()-1)||s.Cb!=null&&s.Cb.Gb!=null?v=s:(v=new d.Ea,s.copyTo(v),v.hj(1)),_=!0)}return!!y},l.aV=function(s,a,u){var f=this.rc(s,a,!1);if(f==4||f==1)return!1;var y=new d.l;f=new d.l;var v=new d.l;s.A(y),a.A(v),f.L(y),f.X(u,u),v=y=!1;for(var _=s,M=!1,$=0;$<a.I();$++){var T=a.Oa($);if(f.contains(T)?(T=d.jd.Zd(_,T,u))==0?v=!0:T==1&&(y=!0):v=!0,y&&v)return!0;M||(!d.Fg.Ol(s,a.I()-1)||s.Cb!=null&&s.Cb.Gb!=null?_=s:(_=new d.Ea,s.copyTo(_),_.hj(1)),M=!0)}return!1},l.YU=function(s,a,u){var f=new d.l,y=new d.l;if(s.A(f),a.A(y),!this.Ac(f,y,u)||(y=this.rc(s,a,!1))==4)return!1;if(y==1)return!0;y=!1;for(var v=s,_=!1,M=0;M<a.I();M++){var $=a.Oa(M);if(!f.contains($))return!1;if(($=d.jd.Zd(v,$,u))==1)y=!0;else if($==0)return!1;_||(!d.Fg.Ol(s,a.I()-1)||s.Cb!=null&&s.Cb.Gb!=null?v=s:(v=new d.Ea,s.copyTo(v),v.hj(1)),_=!0)}return y},l.hV=function(s,a,u){var f=new d.l,y=new d.l;return s.A(f),a.A(y),!!l.gk(f,y,u)&&((f=new d.Ea).bd(a,!1),l.Rz(s,f,u,!0))},l.cV=function(s,a,u){var f=l.rc(s,a,!1);if(f==4)return!0;if(f==1||f==2)return!1;var y=new d.l;if(f=new d.l,s.A(y),a.A(f),l.Ac(f,y,u)||(y=new d.h,f.fn(y),(a=d.jd.Zd(s,y,u))!=0)||(f.VI(y),(a=d.jd.Zd(s,y,u))!=0)||(f.gn(y),(a=d.jd.Zd(s,y,u))!=0)||(f.YI(y),(a=d.jd.Zd(s,y,u))!=0))return!1;a=s.vb(0),(y=new d.l).L(f),y.X(u,u);for(var v=0,_=s.I();v<_;v++){var M=a.read(2*v),$=a.read(2*v+1);if(y.contains(M,$))return!1}return!l.NG(s,f,u)},l.nV=function(s,a,u,f){var y=l.rc(s,a,!1);if(y==4||y==1||y==2)return!1;y=new d.l;var v=new d.l;return s.A(y),a.A(v),!l.Ac(v,y,u)&&(v.S()<=u&&v.da()<=u?(a=a.Kp(),l.CI(s,a,u)):v.S()<=u||v.da()<=u?(y=new d.Ua,v=new d.Ta,a.If(0,v),y.nf(v),a.If(2,v),y.lineTo(v),l.EI(s,y,u,f)):((y=new d.Ea).bd(a,!1),l.DI(s,y,u,f)))},l.kV=function(s,a,u,f){var y=l.rc(s,a,!1);if(y==4||y==1||y==2)return!1;y=new d.l;var v=new d.l;return s.A(y),a.A(v),!(l.Ac(v,y,u)||v.S()<=u||v.da()<=u)&&((y=new d.Ea).bd(a,!1),l.AI(s,y,u,f))},l.sV=function(s,a,u){var f=new d.l,y=new d.l;return s.A(f),a.A(y),l.Ac(y,f,u)},l.XU=function(s,a,u){var f=new d.l,y=new d.l;return s.A(f),a.A(y),!!l.Ac(f,y,u)&&(f=l.rc(s,a,!1))!=4&&f!=2&&(f==1||(y.S()<=u&&y.da()<=u?(a=a.Kp(),l.vI(s,a,u)):y.S()<=u||y.da()<=u?(y=new d.Ua,f=new d.Ta,a.If(0,f),y.nf(f),a.If(2,f),y.lineTo(f),l.xI(s,y,u,null)):((y=new d.Ea).bd(a,!1),l.wI(s,y,u,null))))},l.$U=function(s,a,u,f){var y=new d.l,v=new d.l;return s.A(y),a.A(v),!(l.Ac(v,y,u)||v.da()>u&&v.S()>u||v.da()<=u&&v.S()<=u)&&(y=new d.Ua,v=new d.Ta,a.If(0,v),y.nf(v),a.If(2,v),y.lineTo(v),l.yI(s,y,u,f))},l.DV=function(s,a,u){var f=new d.l,y=new d.l;return s.A(f),a.A(y),!(!l.gk(f,y,u)||l.rc(s,a,!1)==4)&&(!!l.ZH(s,a,u)||l.Rz(s,a,u,!1))},l.BV=function(s,a,u){return this.rc(s,a,!1)==4||!!new d.am(s,a,u,!0).next()&&!this.OG(s,a,u)},l.II=function(s,a,u){if(l.rc(s,a,!1)==4)return!1;var f=new d.ce(0);if(l.Sz(s,a,u,f)!=0)return!1;for(var y=new d.ee,v=0;v<f.size;v+=2){var _=f.read(v),M=f.read(v+1);y.Du(_,M)}return s=s.ng(),a=a.ng(),s.Gd(a,0,a.I()),l.Ow(s,y,u)},l.GI=function(s,a,u){if(l.rc(s,a,!1)==4)return!1;var f=new d.ce(0);if(l.Sz(s,a,u,f)!=0)return!1;for(var y=new d.ee,v=0;v<f.size;v+=2){var _=f.read(v),M=f.read(v+1);y.Du(_,M)}return s=s.ng(),a=a.ng(),s.Gd(a,0,a.I()),!l.Ow(s,y,u)},l.HV=function(s,a,u){return l.rc(s,a,!1)!=4&&l.QG(s,a,u)},l.FI=function(s,a,u){var f=new d.l,y=new d.l;return s.A(f),a.A(y),!(!l.Ac(f,y,u)||l.rc(s,a,!1)==4)&&l.Am(a,s,u,!1)},l.AV=function(s,a,u){return l.rc(s,a,!1)==4||(a=a.D(),!l.Tz(s,a,u))},l.LV=function(s,a,u){return l.rc(s,a,!1)!=4&&(a=a.D(),l.Uz(s,a,u))},l.vV=function(s,a,u){return l.rc(s,a,!1)!=4&&(a=a.D(),l.MG(s,a,u))},l.zV=function(s,a,u){return l.rc(s,a,!1)==4||!l.PG(s,a,u,!1)},l.KV=function(s,a,u){if(this.rc(s,a,!1)==4)return!1;var f=s.Ha(),y=new d.l,v=new d.l,_=new d.l;s.A(y),a.A(v),y.X(u,u),v.X(u,u),_.L(y),_.Fa(v),y=null;var M=s.Cb;if(M!=null){var $=M.Gb;y=M.Bo,$==null&&($=M=d.ua.lj(s,_))}else $=M=d.ua.lj(s,_);var T=$.getIterator(),A=null;y!=null&&(A=y.getIterator());var R=new d.h,D=new d.h,V=!1,Z=u*u;for(y=new d.rn(a.I()),M=0;M<a.I();M++)y.write(M,0);for(M=0;M<a.I();M++)if(a.D(M,R),_.contains(R)){if(v.L(R.x,R.y,R.x,R.y),A!=null&&(A.Zi(v,u),A.next()==-1))continue;T.Zi(v,u);for(var ee=T.next();ee!=-1;ee=T.next())if(f.Wb($.ka(ee)),(ee=f.ia()).ic(ee.ge(R,!1),D),d.h.zc(R,D)<=Z){y.write(M,1),V=!0;break}}if(!V)return!1;for(s=s.ng(),f=new d.ee,v=new d.h,M=0;M<a.I();M++)y.read(M)!=0&&(a.D(M,v),f.Du(v.x,v.y));return this.Ow(s,f,u)},l.xV=function(s,a,u){if(this.rc(s,a,!1)==4)return!1;var f=s.Ha(),y=new d.l,v=new d.l,_=new d.l;s.A(y),a.A(v),y.X(u,u),v.X(u,u),_.L(y),_.Fa(v),y=null;var M=s.Cb;if(M!=null){var $=M.Gb;y=M.Bo,$==null&&($=M=d.ua.lj(s,_))}else $=M=d.ua.lj(s,_);var T=$.getIterator(),A=null;y!=null&&(A=y.getIterator());var R=new d.h,D=new d.h,V=!1,Z=!1,ee=u*u;for(y=new d.rn(a.I()),M=0;M<a.I();M++)y.write(M,0);for(M=0;M<a.I();M++)if(a.D(M,R),_.contains(R)){if(v.L(R.x,R.y,R.x,R.y),A!=null&&(A.Zi(v,u),A.next()==-1)){Z=!0;continue}T.Zi(v,u);for(var G=!1,re=T.next();re!=-1;re=T.next())if(f.Wb($.ka(re)),(re=f.ia()).ic(re.ge(R,!1),D),d.h.zc(R,D)<=ee){y.write(M,1),G=V=!0;break}G||(Z=!0)}else Z=!0;if(!V||!Z)return!1;for(s=s.ng(),f=new d.ee,v=new d.h,M=0;M<a.I();M++)y.read(M)!=0&&(a.D(M,v),f.Du(v.x,v.y));return!this.Ow(s,f,u)},l.uV=function(s,a,u){var f=new d.l,y=new d.l;return s.A(f),a.A(y),!(!l.Ac(f,y,u)||l.rc(s,a,!1)==4||!l.PG(s,a,u,!0))&&(s=s.ng(),!l.bI(s,a,u))},l.CV=function(s,a,u){var f=new d.l,y=new d.l;return s.A(f),a.A(y),!(y.da()>u&&y.S()>u)&&l.gk(f,y,u)},l.yV=function(s,a,u){var f=new d.l,y=new d.l;return s.A(f),a.A(y),!l.Ac(y,f,u)&&!l.NG(s,y,u)},l.JV=function(s,a,u){var f=new d.l,y=new d.l;if(s.A(f),a.A(y),y.da()<=u&&y.S()<=u)return y=a.Kp(),l.Uz(s,y,u);if(y.da()<=u||y.S()<=u)return y=new d.Ua,f=new d.Ta,a.If(0,f),y.nf(f),a.If(2,f),y.lineTo(f),l.II(s,y,u);s=s.Ha(),a=new d.l,f=new d.l,a.L(y),f.L(y),a.X(-u,-u),f.X(u,u),y=!1;for(var v=new d.l,_=new d.l;s.ab();)for(;s.Ia();){if(s.ia().A(v),_.L(a),_.Fa(v),!_.B()&&(_.da()>u||_.S()>u))return!1;_.L(f),_.Fa(v),_.B()||(y=!0)}return y},l.GV=function(s,a,u){var f=new d.l,y=new d.l;return s.A(f),a.A(y),!(l.Ac(f,y,u)||l.Ac(y,f,u)||l.Ac(y,f,u)||y.da()>u&&y.S()>u||y.da()<=u&&y.S()<=u)&&(f=new d.Ua,y=new d.Ta,a.If(0,y),f.nf(y),a.If(2,y),f.lineTo(y),l.QG(s,f,u))},l.MV=function(s,a,u){var f=new d.l,y=new d.l;if(s.A(f),a.A(y),!l.Ac(y,f,u)||y.da()<=u&&y.S()<=u)return!1;if(y.da()<=u||y.S()<=u)return l.Ac(y,f,u);s=s.Ha(),(a=new d.l).L(y),a.X(-u,-u),y=!1,f=new d.l;for(var v=new d.l;s.ab();)for(;s.Ia();)s.ia().A(f),a.jm(f)?y=!0:(v.L(a),v.Fa(f),!v.B()&&(v.da()>u||v.S()>u)&&(y=!0));return y},l.tV=function(s,a,u){var f=new d.l,y=new d.l;return a.A(y),s.A(f),!(!l.Ac(f,y,u)||y.da()>u&&y.S()>u)&&(y.da()<=u&&y.S()<=u?(a=a.Kp(),l.MG(s,a,u)):(f=new d.Ua,y=new d.Ta,a.If(0,y),f.nf(y),a.If(2,y),f.lineTo(y),l.Am(f,s,u,!1)))},l.wV=function(s,a,u){var f=new d.l,y=new d.l;if(s.A(f),a.A(y),l.Ac(y,f,u)||y.da()<=u&&y.S()<=u)return!1;if(y.da()<=u||y.S()<=u)return f=new d.Ua,y=new d.Ta,a.If(0,y),f.nf(y),a.If(2,y),f.lineTo(y),l.GI(s,f,u);s=s.Ha(),a=new d.l,(f=new d.l).L(y),a.L(y),f.X(-u,-u),a.X(u,u);for(var v=y=!1,_=new d.l,M=new d.l;s.ab();)for(;s.Ia();)if(s.ia().A(_),v||a.contains(_)||(v=!0),y||(M.L(f),M.Fa(_),!M.B()&&(M.da()>u||M.S()>u)&&(y=!0)),y&&v)return!0;return!1},l.dU=function(s,a,u){var f=new d.l,y=new d.l;return s.A(f),a.A(y),!!l.gk(f,y,u)&&(!!l.eU(s,a,u)||l.TA(s,a,u,!1,!0,!1))},l.bU=function(s,a,u){return!l.bI(s,a,u)},l.jU=function(s,a,u){return l.TA(s,a,u,!1,!1,!0)},l.$H=function(s,a,u){var f=new d.l,y=new d.l;return s.A(f),a.A(y),!!l.Ac(f,y,u)&&l.TA(a,s,u,!0,!1,!1)},l.Ow=function(s,a,u){u*=u;for(var f=new d.h,y=new d.h,v=0;v<a.I();v++){a.D(v,y);for(var _=!1,M=0;M<s.I();M++)if(s.D(M,f),d.h.zc(f,y)<=u){_=!0;break}if(!_)return!1}return!0},l.Pw=function(s,a,u){var f=new d.l,y=new d.l;return s.A(f),a.A(y),l.gk(f,y,u)},l.aI=function(s,a,u){return a=a.D(),l.lt(s,a,u)},l.nU=function(s,a,u){return l.Pw(s,a,u)},l.ZT=function(s,a,u){return!l.aI(s,a,u)},l.cU=function(s,a,u){var f=new d.l,y=new d.l;return s.A(f),a.A(y),!(y.da()>u||y.S()>u)&&l.gk(f,y,u)},l.aU=function(s,a,u){var f=new d.l,y=new d.l;if(s.A(f),a.A(y),l.Ac(y,f,u))return!1;for((a=new d.l).L(y),a.X(u,u),u=new d.h,y=0;y<s.I();y++)if(s.D(y,u),a.contains(u))return!1;return!0},l.lU=function(s,a,u){var f=new d.l,y=new d.l,v=new d.l;if(a.A(f),f.da()<=u&&f.S()<=u)return!1;if(f.da()<=u||f.S()<=u){a=new d.h;var _=!1;y.L(f),v.L(f),y.X(u,u),f.da()>u?v.X(0,-u):v.X(-u,0);for(var M=0;M<s.I();M++)if(s.D(M,a),y.contains(a)){if(f.da()>u){if(a.y>v.G&&a.y<v.H)return!1}else if(a.x>v.v&&a.x<v.C)return!1;_=!0}return _}for(y.L(f),v.L(f),y.X(u,u),v.X(-u,-u),a=new d.h,_=!1,M=0;M<s.I();M++)if(s.D(M,a),y.contains(a)){if(v.jm(a))return!1;_=!0}return _},l.mU=function(s,a,u){var f=new d.l,y=new d.l;if(s.A(f),a.A(y),!l.Ac(y,f,u))return!1;if(y.da()<=u&&y.S()<=u)return l.gk(f,y,u);if(y.da()<=u||y.S()<=u){a=!1,f=new d.l;var v=new d.l;f.L(y),v.L(y),y.da()>u?f.X(0,-u):f.X(-u,0),v.X(u,u);for(var _=new d.h,M=0;M<s.I();M++){if(s.D(M,_),!v.contains(_))return!1;y.da()>u?_.y>f.G&&_.y<f.H&&(a=!0):_.x>f.v&&_.x<f.C&&(a=!0)}return a}for(a=!1,f=new d.l,v=new d.l,f.L(y),v.L(y),f.X(-u,-u),v.X(u,u),_=new d.h,M=0;M<s.I();M++){if(s.D(M,_),!v.contains(_))return!1;f.jm(_)&&(a=!0)}return a},l.YT=function(s,a,u){var f=new d.l,y=new d.l;return s.A(f),a.A(y),!(!l.Ac(f,y,u)||y.da()>u||y.S()>u)&&(a=a.Kp(),!l.lt(s,a,u))},l.$T=function(s,a,u){var f=new d.l,y=new d.l;if(s.A(f),a.A(y),l.Ac(y,f,u)||y.da()<=u&&y.S()<=u)return!1;if(y.da()<=u||y.S()<=u){a=new d.l,f=new d.l,a.L(y),y.da()>u?a.X(0,-u):a.X(-u,0),f.L(y),f.X(u,u);for(var v=new d.h,_=!1,M=!1,$=0;$<s.I();$++)if(s.D($,v),_||(y.da()>u?v.y>a.G&&v.y<a.H&&(_=!0):v.x>a.v&&v.x<a.C&&(_=!0)),M||f.contains(v)||(M=!0),_&&M)return!0;return!1}for(a=new d.l,f=new d.l,a.L(y),a.X(-u,-u),f.L(y),f.X(u,u),v=new d.h,M=_=!1,$=0;$<s.I();$++)if(s.D($,v),!_&&a.jm(v)&&(_=!0),M||f.contains(v)||(M=!0),_&&M)return!0;return!1},l.rI=function(s,a,u){return d.h.zc(s,a)<=u*u},l.NU=function(s,a,u){return d.h.zc(s,a)>u*u},l.pI=function(s,a,u){return l.rI(s,a,u)},l.qI=function(s,a,u){var f=new d.l;return f.L(s),l.gk(f,a,u)},l.Tw=function(s,a,u){var f=new d.l;return f.L(a),f.X(u,u),!f.contains(s)},l.ZA=function(s,a,u){if(a.da()<=u&&a.S()<=u)return!1;var f=new d.l,y=new d.l;if(f.L(a),f.X(u,u),!f.contains(s))return!1;if(a.da()<=u||a.S()<=u){if(y.L(a),a.da()>u?y.X(0,-u):y.X(-u,0),a.da()>u){if(s.y>y.G&&s.y<y.H)return!1}else if(s.x>y.v&&s.x<y.C)return!1;return!0}return y.L(a),y.X(-u,-u),!y.jm(s)},l.$A=function(s,a,u){if(a.da()<=u&&a.S()<=u)return!0;if(a.da()<=u||a.S()<=u){var f=new d.l;f.L(a),a.da()>u?f.X(0,-u):f.X(-u,0);var y=!1;return a.da()>u?s.y>f.G&&s.y<f.H&&(y=!0):s.x>f.v&&s.x<f.C&&(y=!0),y}return(f=new d.l).L(a),f.X(-u,-u),f.jm(s)},l.MU=function(s,a,u){return l.qI(s,a,u)},l.gk=function(s,a,u){return l.Ac(s,a,u)&&l.Ac(a,s,u)},l.fk=function(s,a,u){var f=new d.l;return f.L(a),f.X(u,u),!s.isIntersecting(f)},l.YP=function(s,a,u){if(s.da()<=u&&s.S()<=u){var f=s.tf();return l.ZA(f,a,u)}if(a.da()<=u&&a.S()<=u)return f=a.tf(),l.ZA(f,s,u);if(s.da()>u&&s.S()>u&&(a.da()<=u||a.S()<=u)?f=a:(f=s,s=a),f.da()<=u||f.S()<=u){if(s.da()<=u||s.S()<=u){a=new d.zb;var y=new d.zb,v=[0,0],_=[0,0],M=new d.h;return f.fn(M),a.Ec(M),f.gn(M),a.Rc(M),s.fn(M),y.Ec(M),s.gn(M),y.Rc(M),a.Fa(y,null,v,_,u),a.Fa(y,null,null,null,u)==1&&(v[0]==0||v[1]==1||_[0]==0||_[1]==1)}return a=new d.l,y=new d.l,a.L(s),a.X(-u,-u),y.L(a),y.Fa(f),!(!y.B()&&(y.da()>u||y.S()>u))}return s.X(u,u),(y=new d.l).L(f),y.Fa(s),!(y.B()||!y.B()&&y.da()>u&&y.S()>u)},l.XP=function(s,a,u){if(l.Ac(s,a,u)||l.Ac(a,s,u)||s.da()<=u&&s.S()<=u||a.da()<=u&&a.S()<=u)return!1;if(s.da()<=u||s.S()<=u){if(a.da()>u&&a.S()>u)return!1;var f=new d.zb,y=new d.zb,v=[0,0],_=[0,0],M=new d.h;return s.fn(M),f.Ec(M),s.gn(M),f.Rc(M),a.fn(M),y.Ec(M),a.gn(M),y.Rc(M),f.Fa(y,null,v,_,u),f.Fa(y,null,null,null,u)==2&&(0<v[0]||1>v[1])&&(0<_[0]||1>_[1])}return!(a.da()<=u||a.S()<=u)&&((f=new d.l).L(s),f.Fa(a),!(f.B()||f.da()<=u||f.S()<=u))},l.eF=function(s,a,u){if(!l.Ac(s,a,u))return!1;if(s.da()<=u&&s.S()<=u)return s=s.tf(),l.$A(s,a,u);if(a.da()<=u&&a.S()<=u)return a=a.tf(),l.$A(a,s,u);if(s.da()<=u||s.S()<=u)return l.Ac(s,a,u);if(a.da()<=u||a.S()<=u){var f=new d.l;return f.L(s),f.X(-u,-u),f.jm(a)?!0:((s=new d.l).L(f),s.Fa(a),!(s.B()||s.da()<=u&&s.S()<=u))}return l.Ac(s,a,u)},l.WP=function(s,a,u){if(l.Ac(s,a,u)||l.Ac(a,s,u)||s.da()<=u&&s.S()<=u||a.da()<=u&&a.S()<=u||a.da()>u&&a.S()>u&&s.da()>u&&s.S()>u)return!1;if(s.da()>u&&s.S()>u)var f=a;else f=s,s=a;if(s.da()>u&&s.S()>u){a=new d.l;var y=new d.l;return y.L(s),y.X(-u,-u),a.L(y),a.Fa(f),!(a.B()||a.da()<=u&&a.S()<=u)}a=new d.zb,y=new d.zb;var v=[0,0],_=[0,0],M=new d.h;return f.fn(M),a.Ec(M),f.gn(M),a.Rc(M),s.fn(M),y.Ec(M),s.gn(M),y.Rc(M),a.Fa(y,null,v,_,u),a.Fa(y,null,null,null,u)==1&&0<v[0]&&1>v[1]&&0<_[0]&&1>_[1]},l.zI=function(s,a,u){var f=new d.l,y=new d.l,v=new d.am(s,a,u,!0);if(!v.next())return!0;if(this.OG(s,a,u))return!1;var _=s,M=null;a.K()==1736&&(M=a);var $=!1,T=!1;do{var A=v.pl(),R=v.jl();if(R=a.Oa(a.Ca(R)),f.L(v.oz()),f.X(u,u),f.contains(R)&&(R=d.jd.Zd(_,R,0))!=0||a.K()==1736&&(A=s.Oa(s.Ca(A)),y.L(v.Wy()),y.X(u,u),y.contains(A)&&(R=d.jd.Zd(M,A,0))!=0))return!1;$||(!d.Fg.Ol(s,a.ea()-1)||s.Cb!=null&&s.Cb.Gb!=null?_=s:(_=new d.Ea,s.copyTo(_),_.hj(1)),$=!0),a.K()!=1736||T||(T=a,!d.Fg.Ol(T,s.ea()-1)||a.Cb!=null&&a.Cb.Gb!=null?M=a:(M=new d.Ea,T.copyTo(M),M.hj(1)),T=!0)}while(v.next());return!0},l.Ac=function(s,a,u){var f=new d.l;return f.L(s),f.X(u,u),f.contains(a)},l.ns=function(s,a,u){var f=new d.l;return f.L(a),f.X(u,u),a=new d.h,s.fn(a),!f.contains(a)||(s.VI(a),!f.contains(a)||(s.YI(a),!f.contains(a)||(s.gn(a),!f.contains(a))))},l.ZH=function(s,a,u){if(s.ea()!=a.ea()||s.I()!=a.I())return!1;var f=new d.h,y=new d.h,v=!0;u*=u;for(var _=0;_<s.ea();_++){if(s.Wc(_)!=a.Wc(_)){v=!1;break}for(var M=s.Ca(_);M<a.Wc(_);M++)if(s.D(M,f),a.D(M,y),d.h.zc(f,y)>u){v=!1;break}if(!v)break}return!!v},l.eU=function(s,a,u){if(s.I()!=a.I())return!1;var f=new d.h,y=new d.h,v=!0;u*=u;for(var _=0;_<s.I();_++)if(s.D(_,f),a.D(_,y),d.h.zc(f,y)>u){v=!1;break}return!!v},l.TA=function(s,a,u,f,y,v){var _=!1;if(s.I()>a.I()){f&&(f=!1,_=!0);var M=a}else M=s,s=a;if(a=null,y||v||_){a=new d.rn(s.I());for(var $=0;$<s.I();$++)a.write($,0)}$=new d.l;var T=new d.l,A=new d.l;M.A($),s.A(T),$.X(u,u),T.X(u,u),A.L($),A.Fa(T),T=new d.h;for(var R=new d.h,D=!0,V=d.ua.jE(s,A),Z=V.getIterator(),ee=u*u,G=0;G<M.I();G++)if(M.D(G,T),A.contains(T)){var re=!1;$.L(T.x,T.y,T.x,T.y),Z.Zi($,u);for(var oe=Z.next();oe!=-1&&(oe=V.ka(oe),s.D(oe,R),!(d.h.zc(T,R)<=ee&&((y||v||_)&&a.write(oe,1),re=!0,f)));oe=Z.next());if(!re&&(D=!1,y||f))return!1}else{if(y||f)return!1;D=!1}if(v&&D)return!1;if(f)return!0;for($=0;$<s.I();$++)if(a.read($)==1){if(v)return!0}else if(y||_)return!1;return!v},l.bI=function(s,a,u){if(s.I()>a.I())var f=a;else f=s,s=a;a=new d.l;var y=new d.l,v=new d.l;f.A(a),s.A(y),a.X(u,u),y.X(u,u),v.L(a),v.Fa(y),y=new d.h;for(var _=new d.h,M=u*u,$=d.ua.jE(s,v),T=$.getIterator(),A=0;A<f.I();A++)if(f.D(A,y),v.contains(y)){a.L(y.x,y.y,y.x,y.y),T.Zi(a,u);for(var R=T.next();R!=-1;R=T.next())if(s.D($.ka(R),_),d.h.zc(y,_)<=M)return!0}return!1},l.Rz=function(s,a,u,f){return l.Am(s,a,u,f)&&l.Am(a,s,u,f)},l.Am=function(s,a,u,f){function y(gt,Ze){return R.LE(gt,Ze)}var v,_=!0,M=[0,0],$=[0,0],T=0,A=new d.ja(0),R=new l,D=new d.l,V=new d.l,Z=new d.l;s.A(D),a.A(V),D.X(u,u),V.X(u,u),Z.L(D),Z.Fa(V),s=s.Ha(),V=a.Ha();var ee=null,G=ee=null,re=a.Cb;for(re!=null?(ee=re.Gb,G=re.Bo,ee==null&&(ee=d.ua.lj(a,Z))):ee=d.ua.lj(a,Z),a=ee.getIterator(),re=null,G!=null&&(re=G.getIterator());s.ab();)for(;s.Ia();){var oe=!1,se=s.ia();if(se.A(D),!D.isIntersecting(Z)||re!=null&&(re.Zi(D,u),re.next()==-1))return!1;for(G=se.Rb(),a.Wo(se,u),v=a.next();v!=-1;v=a.next()){V.Wb(ee.ka(v)),v=V.ia();var ge=se.Fa(v,null,M,$,u);if(ge==2&&(!f||$[0]<=$[1])){ge=M[0];var me=M[1],Ie=$[0],De=$[1];if(ge*G<=u&&(1-me)*G<=u){oe=!0,T=0,A.resize(0),R.th.length=0;var Fe=s.xb();for(Ie=!0;Ie;){if(s.Ia()){if(G=(se=s.ia()).Rb(),(ge=se.Fa(v,null,M,$,u))==2&&(!f||$[0]<=$[1])&&(ge=M[0],me=M[1],ge*G<=u&&(1-me)*G<=u)){Fe=s.xb();continue}if(V.Ia()&&(v=V.ia(),(ge=se.Fa(v,null,M,$,u))==2&&(!f||$[0]<=$[1])&&(ge=M[0],me=M[1],ge*G<=u&&(1-me)*G<=u))){Fe=s.xb();continue}}Ie=!1}Fe!=s.xb()&&(s.Wb(Fe),s.ia());break}Fe=s.xb(),v=S.construct(Fe,s.gb,ge,me,V.xb(),V.gb,Ie,De),R.th.push(v),A.add(A.size)}}if(!oe){if(T==R.th.length)return!1;for(1<A.size-T&&A.Wd(T,A.size,y),oe=0;T<R.th.length;T++)if(!((v=R.th[A.get(T)]).Mj<oe&&v.Ui<oe)){if(G*(v.Mj-oe)>u)return!1;if(G*(1-(oe=v.Ui))<=u||oe==1)break}if(G*(1-oe)>u)return!1;T=0,A.resize(0),R.th.length=0}}return _},l.QG=function(s,a,u){if(1>l.Sz(s,a,u,null))return!1;var f=new d.l,y=new d.l;s.A(f),a.A(y);var v=l.ns(f,y,u);return f=l.ns(y,f,u),!(!v||!f)||(v&&!f?!l.Am(a,s,u,!1):f&&!v?!l.Am(s,a,u,!1):!l.Am(s,a,u,!1)&&!l.Am(a,s,u,!1))},l.Sz=function(s,a,u,f){function y(lt,Ui){return D.LE(lt,Ui)}if(s.sz()>a.sz())var v=a,_=s;else v=s,_=a;s=v.Ha(),a=_.Ha();var M=[0,0],$=[0,0],T=-1,A=0,R=new d.ja(0),D=new l,V=new d.l,Z=new d.l,ee=new d.l;v.A(V),_.A(Z),V.X(u,u),Z.X(u,u),ee.L(V),ee.Fa(Z),v=null,f!=null&&(v=new d.h);var G=Z=Z=null,re=_.Cb;for(re!=null?(Z=re.Gb,G=re.Bo,Z==null&&(Z=d.ua.lj(_,ee))):Z=d.ua.lj(_,ee),_=Z.getIterator(),re=null,G!=null&&(re=G.getIterator());s.ab();)for(G=0;s.Ia();){var oe=s.ia();if(oe.A(V),V.isIntersecting(ee)){if(re!=null&&(re.Zi(V,u),re.next()==-1))continue;var se=oe.Rb();_.Wo(oe,u);for(var ge=_.next();ge!=-1;ge=_.next()){var me=Z.ka(ge);a.Wb(me);var Ie=a.ia(),De=Ie.Rb(),Fe=oe.Fa(Ie,null,M,$,u);if(0<Fe){ge=M[0],T=$[0];var gt=Fe==2?M[1]:NaN,Ze=Fe==2?$[1]:NaN;if(Fe==2){if(se*(gt-ge)>u)return 1;var Vt=se*(gt-ge);if(a.Ia()){if(Ie=a.ia(),(Fe=oe.Fa(Ie,null,M,null,u))==2){Fe=M[0];var Rt=M[1];if(Vt+(Fe=se*(Rt-Fe))>u)return 1}a.Wb(me),a.ia()}if(!a.xm()){if(a.ni(),Ie=a.ni(),(Fe=oe.Fa(Ie,null,M,null,u))==2&&(Fe=M[0],Vt+(Fe=se*((Rt=M[1])-Fe))>u))return 1;a.Wb(me),a.ia()}if(s.Ia()){if(me=s.xb(),(Fe=(oe=s.ia()).Fa(Ie,null,M,null,u))==2&&(Fe=M[0],Vt+(Fe=se*((Rt=M[1])-Fe))>u))return 1;s.Wb(me),s.ia()}if(!s.xm()){if(me=s.xb(),s.ni(),(Fe=(oe=s.ni()).Fa(Ie,null,M,null,u))==2&&(Fe=M[0],Vt+(Fe=De*((Rt=M[1])-Fe))>u))return 1;s.Wb(me),s.ia()}Ie=S.construct(s.xb(),s.gb,ge,gt,a.xb(),a.gb,T,Ze),D.th.push(Ie),R.add(R.size)}T=0,f!=null&&(oe.ic(ge,v),f.add(v.x),f.add(v.y))}}if(A<D.th.length){for(R.Wd(A,R.size,y),oe=0,ge=D.th[R.get(A)].Om;A<D.th.length;A++)if(!((Ie=D.th[R.get(A)]).Mj<oe&&Ie.Ui<oe))if(se*(Ie.Mj-oe)>u)G=se*(Ie.Ui-Ie.Mj),oe=Ie.Ui,ge=Ie.Om;else{if(Ie.Om!=ge?(G=se*(Ie.Ui-Ie.Mj),ge=Ie.Om):G+=se*(Ie.Ui-Ie.Mj),G>u)return 1;if((oe=Ie.Ui)==1)break}se*(1-oe)>u&&(G=0),A=0,R.resize(0),D.th.length=0}}}return T},l.OG=function(s,a,u){var f=s.Ha(),y=a.Ha();for(s=new d.am(s,a,u,!1);s.next();){a=s.pl();var v=s.jl();if(f.Wb(a),y.Wb(v),a=f.ia(),0<y.ia().Fa(a,null,null,null,u))return!0}return!1},l.PG=function(s,a,u,f){var y=s.Ha(),v=new d.l,_=new d.l,M=new d.l;s.A(v),a.A(_),v.X(u,u),v.contains(_),_.X(u,u),M.L(v),M.Fa(_),(v=s.Cb)!=null?(v=v.Gb)==null&&(v=d.ua.lj(s,M)):v=d.ua.lj(s,M),s=v.getIterator();for(var $=new d.h,T=new d.h,A=u*u,R=0;R<a.I();R++)if(a.D(R,$),M.contains($)){_.L($.x,$.y,$.x,$.y),s.Zi(_,u);for(var D=!1,V=s.next();V!=-1;V=s.next())if(y.Wb(v.ka(V)),(V=y.ia()).ic(V.ge($,!1),T),d.h.zc(T,$)<=A){D=!0;break}if(f){if(!D)return!1}else if(D)return!0}return!!f},l.Tz=function(s,a,u){var f=new d.h,y=u*u,v=s.Ha();if((s=s.Cb)!=null&&(s=s.Gb)!=null){var _=new d.l;for(_.L(a),_=(u=s.HF(_,u)).next();_!=-1;_=u.next())if(v.Wb(s.ka(_)),v.Ia()){var M=(_=v.ia()).ge(a,!1);if(_.ic(M,f),d.h.zc(a,f)<=y)return!0}return!1}for(s=new d.l;v.ab();)for(;v.Ia();)if((_=v.ia()).A(s),s.X(u,u),s.contains(a)&&(M=_.ge(a,!1),_.ic(M,f),d.h.zc(a,f)<=y))return!0;return!1},l.MG=function(s,a,u){return l.Tz(s,a,u)&&!l.Uz(s,a,u)},l.Uz=function(s,a,u){return s=s.ng(),!l.lt(s,a,u)},l.NG=function(s,a,u){if(s.vm()){var f=new d.zb(a.v,a.G,a.v,a.H),y=new d.zb(a.v,a.H,a.C,a.H),v=new d.zb(a.C,a.H,a.C,a.G);for(a=new d.zb(a.C,a.G,a.v,a.G),s=s.Ha();s.ab();)for(;s.Ia();){var _=s.ia();if(_.isIntersecting(f,u)||_.isIntersecting(y,u)||_.isIntersecting(v,u)||_.isIntersecting(a,u))return!0}}else{(f=new d.l).L(a),f.X(u,u),u=s.vb(0),y=new d.h,v=new d.h,a=new d.h,_=new d.h;for(var M=0,$=s.ea();M<$;M++)for(var T=!0,A=s.Ca(M),R=s.Wc(M);A<R;A++)if(T)u.uc(2*A,v),T=!1;else{if(u.uc(2*A,y),a.N(v),_.N(y),f.uy(a,_)!=0)return!0;v.N(y)}}return!1},l.rc=function(s,a,u){var f=s.K(),y=a.K();if(d.ba.zj(f)){var v=s.Cb;if(v!=null&&(v=v.Hk)!=null)if(y==33){var _=a.D();if((_=v.Uo(_.x,_.y))==1)return 1;if(_==0)return 4}else{if(_=new d.l,a.A(_),(_=v.To(_))==1)return 1;if(_==0)return 4;if(u&&d.ba.zj(y)&&l.CE(a,v))return 1073741824}}if(d.ba.zj(y)&&(v=a.Cb)!=null&&(v=v.Hk)!=null)if(f==33){if(s=s.D(),(_=v.Uo(s.x,s.y))==1)return 2;if(_==0)return 4}else{if(a=new d.l,s.A(a),(_=v.To(a))==1)return 2;if(_==0)return 4;if(u&&d.ba.zj(f)&&l.CE(s,v))return 1073741824}return 0},l.CE=function(s,a){for(var u=s.I(),f=new d.h,y=0;y<u;y++)if(s.D(y,f),a.Uo(f.x,f.y)==1)return!0;return!1},l.DI=function(s,a,u,f){for(var y=1<=s.qm(0)&&1<=a.qm(0),v=s.Ha(),_=a.Ha(),M=[0,0],$=[0,0],T=new d.am(s,a,u,!1),A=!1;T.next();){var R=T.pl(),D=T.jl();if(v.Wb(R),_.Wb(D),R=v.ia(),(D=_.ia().Fa(R,null,$,M,u))==2){if(A=M[0],D=M[1],R=R.Rb(),y&&(D-A)*R>u)return!1;A=!0}else if(D!=0){if(A=M[0],R=$[0],0<A&&1>A&&0<R&&1>R)return!1;A=!0}}return!!A&&(v=new d.l,_=new d.l,y=new d.l,s.A(v),a.A(_),v.X(1e3*u,1e3*u),_.X(1e3*u,1e3*u),y.L(v),y.Fa(_),!(10<s.I()&&(s=d.Vd.clip(s,y,u,0),s.B())||10<a.I()&&(a=d.Vd.clip(a,y,u,0),a.B()))&&d.cm.st(s,a,u,"F********",f))},l.AI=function(s,a,u,f){var y=1<=s.qm(0)&&1<=a.qm(0),v=new d.l,_=new d.l,M=new d.l;s.A(v),a.A(_);for(var $=!1,T=l.ns(v,_,u),A=l.ns(_,v,u),R=s.Ha(),D=a.Ha(),V=[0,0],Z=[0,0],ee=new d.am(s,a,u,!1);ee.next();){var G=ee.pl(),re=ee.jl();if(R.Wb(G),D.Wb(re),re=R.ia(),(G=D.ia().Fa(re,null,Z,V,u))==2){G=V[0];var oe=V[1];if(re=re.Rb(),y&&(oe-G)*re>u&&($=!0,T&&A))return!0}else if(G!=0&&(G=V[0],re=Z[0],0<G&&1>G&&0<re&&1>re))return!0}if(y=new d.l,R=new d.l,y.L(v),y.X(1e3*u,1e3*u),R.L(_),R.X(1e3*u,1e3*u),M.L(y),M.Fa(R),v="",v=$?v+"**":v+"T*",T){if(10<a.I()&&(a=d.Vd.clip(a,M,u,0)).B())return!1;v+="****"}else v+="T***";if(A){if(10<s.I()&&(s=d.Vd.clip(s,M,u,0)).B())return!1;v+="***"}else v+="T**";return d.cm.st(s,a,u,v.toString(),f)},l.wI=function(s,a,u,f){var y=[!1],v=l.uI(s,a,u,y);return y[0]?v:(y=new d.l,a.A(y),y.X(1e3*u,1e3*u),!(10<s.I()&&(s=d.Vd.clip(s,y,u,0),s.B()))&&d.cm.Uw(s,a,u,f))},l.uI=function(s,a,u,f){f[0]=!1;for(var y=s.Ha(),v=a.Ha(),_=[0,0],M=[0,0],$=new d.am(s,a,u,!1),T=!1;$.next();){var A=$.pl(),R=$.jl();if(y.Wb(A,-1),v.Wb(R,-1),A=y.ia(),(A=v.ia().Fa(A,null,M,_,u))!=0&&(T=!0,A==1&&(A=_[0],R=M[0],0<A&&1>A&&0<R&&1>R)))return f[0]=!0,!1}if(!T){for(f[0]=!0,_=new d.l,s.A(_),_.X(u,u),$=s,T=!1,M=new d.l,f=0,y=a.ea();f<y;f++)if(0<a.Ka(f)){if(a.Tj(f,M),!_.isIntersecting(M)||(v=a.Oa(a.Ca(f)),(v=d.Fg.ym($,v,0))==0))return!1;T||(!d.Fg.Ol(s,a.ea()-1)||s.Cb!=null&&s.Cb.Gb!=null?$=s:(v=new d.Ea,s.copyTo(v),v.hj(1),$=v),T=!0)}if(s.ea()==1||a.K()==1607)return!0;for(_=new d.l,a.A(_),_.X(u,u),M=a,$=!1,u=new d.l,f=0,y=s.ea();f<y;f++)if(0<s.Ka(f)){if(s.Tj(f,u),_.isIntersecting(u)&&(v=s.Oa(s.Ca(f)),(v=d.Fg.ym(M,v,0))==1))return!1;$||(!d.Fg.Ol(a,s.ea()-1)||a.Cb!=null&&a.Cb.Gb!=null?M=a:(v=new d.Ea,a.copyTo(v),v.hj(1),M=v),$=!0)}return!0}return!1},l.EI=function(s,a,u,f){for(var y=s.Ha(),v=a.Ha(),_=[0,0],M=[0,0],$=new d.am(s,a,u,!1),T=!1;$.next();){var A=$.pl(),R=$.jl();if(y.Wb(A),v.Wb(R),A=y.ia(),(A=v.ia().Fa(A,null,M,_,u))==2)T=!0;else if(A!=0){if(T=_[0],A=M[0],0<T&&1>T&&0<A&&1>A)return!1;T=!0}}return!!T&&(v=new d.l,_=new d.l,y=new d.l,s.A(v),a.A(_),v.X(1e3*u,1e3*u),_.X(1e3*u,1e3*u),y.L(v),y.Fa(_),!(10<s.I()&&(s=d.Vd.clip(s,y,u,0),s.B())||10<a.I()&&(a=d.Vd.clip(a,y,u,0),a.B()))&&d.cm.bn(s,a,u,"F********",f))},l.yI=function(s,a,u,f){for(var y=s.Ha(),v=a.Ha(),_=[0,0],M=[0,0],$=new d.am(s,a,u,!1),T=!1;$.next();){var A=$.pl(),R=$.jl();if(y.Wb(A),v.Wb(R),A=y.ia(),(A=v.ia().Fa(A,null,M,_,u))==2)T=!0;else if(A!=0){if(T=_[0],A=M[0],0<T&&1>T&&0<A&&1>A)return!0;T=!0}}return!!T&&(v=new d.l,_=new d.l,M=new d.l,$=new d.l,y=new d.l,s.A(v),a.A(_),l.ns(_,v,u)?(M.L(v),M.X(1e3*u,1e3*u),$.L(_),$.X(1e3*u,1e3*u),y.L(M),y.Fa($),!(10<s.I()&&(s=d.Vd.clip(s,y,u,0),s.B())||10<a.I()&&(a=d.Vd.clip(a,y,u,0),a.B()))&&(u=d.cm.bn(s,a,u,"T********",f))):u=d.cm.bn(s,a,u,"T*****T**",f))},l.xI=function(s,a,u,f){var y=[!1],v=l.uI(s,a,u,y);return y[0]?v:(y=new d.l,a.A(y),y.X(1e3*u,1e3*u),!(10<s.I()&&(s=d.Vd.clip(s,y,u,0),s.B()))&&d.cm.aB(s,a,u,f))},l.vI=function(s,a,u){return d.jd.Zd(s,a,u)==1},l.CI=function(s,a,u){return d.jd.Zd(s,a,u)==2},l.lt=function(s,a,u){var f=new d.h;u*=u;for(var y=0;y<s.I();y++)if(s.D(y,f),d.h.zc(f,a)<=u)return!1;return!0},l.prototype.LE=function(s,a){return s=this.th[s],a=this.th[a],s.Om<a.Om||s.Om==a.Om&&(s.rw<a.rw||s.rw==a.rw&&(s.Mj<a.Mj||s.Mj==a.Mj&&(s.Ui<a.Ui||s.Ui==a.Ui&&s.wH<a.wH)))?-1:1},l}();d.vd=p}(Q||(Q={})),function(d){var O,S,p;(S=O||(O={}))[S.InteriorInterior=0]="InteriorInterior",S[S.InteriorBoundary=1]="InteriorBoundary",S[S.InteriorExterior=2]="InteriorExterior",S[S.BoundaryInterior=3]="BoundaryInterior",S[S.BoundaryBoundary=4]="BoundaryBoundary",S[S.BoundaryExterior=5]="BoundaryExterior",S[S.ExteriorInterior=6]="ExteriorInterior",S[S.ExteriorBoundary=7]="ExteriorBoundary",S[S.ExteriorExterior=8]="ExteriorExterior",function(l){l[l.AreaAreaPredicates=0]="AreaAreaPredicates",l[l.AreaLinePredicates=1]="AreaLinePredicates",l[l.LineLinePredicates=2]="LineLinePredicates",l[l.AreaPointPredicates=3]="AreaPointPredicates",l[l.LinePointPredicates=4]="LinePointPredicates",l[l.PointPointPredicates=5]="PointPointPredicates"}(p||(p={})),O=function(){function l(){this.me=0,this.j=new d.ku,this.J=[0,0,0,0,0,0,0,0,0],this.$a=[0,0,0,0,0,0,0,0,0],this.fa=[!1,!1,!1,!1,!1,!1,!1,!1,!1],this.Um=this.xw=-1}return l.tB=function(s,a,u,f,y){if(f.length!=9)throw d.i.ga("relation string length has to be 9 characters");for(var v=0;9>v;v++){var _=f.charAt(v);if(_!="*"&&_!="T"&&_!="F"&&_!="0"&&_!="1"&&_!="2")throw d.i.ga("relation string")}if((v=this.HR(f,s.Eb(),a.Eb()))!=0)return d.vd.uB(s,a,u,v,y);v=new d.l,s.A(v),_=new d.l,a.A(_);var M=new d.l;if(M.L(v),M.$b(_),u=d.ua.Xd(u,M,!1),s=this.RE(s,u),a=this.RE(a,u),s.B()||a.B())return this.pW(s,a,f);switch(v=a.K(),_=!1,s.K()){case 1736:switch(v){case 1736:_=this.st(s,a,u,f,y);break;case 1607:_=this.bn(s,a,u,f,y);break;case 33:_=this.rt(s,a,u,f);break;case 550:_=this.qt(s,a,u,f,y)}break;case 1607:switch(v){case 1736:_=this.bn(a,s,u,this.aq(f),y);break;case 1607:_=this.bB(s,a,u,f,y);break;case 33:_=this.ut(s,a,u,f,y);break;case 550:_=this.tt(s,a,u,f,y)}break;case 33:switch(v){case 1736:_=this.rt(a,s,u,this.aq(f));break;case 1607:_=this.ut(a,s,u,this.aq(f),y);break;case 33:_=this.VU(s,a,u,f);break;case 550:_=this.mt(a,s,u,this.aq(f))}break;case 550:switch(v){case 1736:_=this.qt(a,s,u,this.aq(f),y);break;case 1607:_=this.tt(a,s,u,this.aq(f),y);break;case 550:_=this.UA(s,a,u,f,y);break;case 33:_=this.mt(s,a,u,f)}break;default:_=!1}return _},l.st=function(s,a,u,f,y){var v=new l;v.$i(),v.dj(f),v.sJ();var _=new d.l,M=new d.l;return s.A(_),a.A(M),f=!1,d.vd.fk(_,M,u)&&(v.Eu(s,a),f=!0),f||((_=d.vd.rc(s,a,!1))==4?(v.Eu(s,a),f=!0):_==1?(v.hy(a),f=!0):_==2&&(v.UD(s),f=!0)),f||(s=(f=new d.hd).Ib(s),a=f.Ib(a),v.Yo(f,u,y),v.Dp(s,a),v.j.Wg()),l.hg(v.J,v.Yc)},l.Uw=function(s,a,u,f){var y=new l;y.$i(),y.dj("T*****F**"),y.sJ();var v=new d.l,_=new d.l;s.A(v),a.A(_);var M=!1;return d.vd.fk(v,_,u)&&(y.Eu(s,a),M=!0),M||((v=d.vd.rc(s,a,!1))==4?(y.Eu(s,a),M=!0):v==1?(y.hy(a),M=!0):v==2&&(y.UD(s),M=!0)),M?this.hg(y.J,y.Yc):(s=(M=new d.hd).Ib(s),v=M.Ib(a),d.Vk.W(M,u,f,!1),u=M.Ke(v).ng(),M.Ip(0,!0,!0),d.tn.W(M,s,-1,!1,f),M.I(s)!=0&&(d.tn.W(M,v,-1,!1,f),y.gr(M,f),(a=M.I(v)==0)||(y.Dp(s,v),y.j.Wg(),v=this.hg(y.J,y.Yc))?(s=M.Ke(s),s=(M=new d.hd).Ib(s),v=M.Ib(u),y.gr(M,f),y.me=0,y.$i(),y.dj(a?"T*****F**":"******F**"),y.DB(),y.Dp(s,v),y.j.Wg(),this.hg(y.J,y.Yc)):v))},l.bn=function(s,a,u,f,y){var v=new l;v.$i(),v.dj(f),v.DB();var _=new d.l,M=new d.l;return s.A(_),a.A(M),f=!1,d.vd.fk(_,M,u)&&(v.Fu(s,a),f=!0),f||((_=d.vd.rc(s,a,!1))==4?(v.Fu(s,a),f=!0):_==1&&(v.VD(a),f=!0)),f||(s=(f=new d.hd).Ib(s),a=f.Ib(a),v.Yo(f,u,y),v.mh=v.j.Fp(),l.Lw(a,v.j,v.mh),v.Dp(s,a),v.j.Gp(v.mh),v.j.Wg()),l.hg(v.J,v.Yc)},l.aB=function(s,a,u,f){var y=new l;y.$i(),y.dj("T*****F**"),y.DB();var v=new d.l,_=new d.l;s.A(v),a.A(_);var M=!1;return d.vd.fk(v,_,u)&&(y.Fu(s,a),M=!0),M||((v=d.vd.rc(s,a,!1))==4?(y.Fu(s,a),M=!0):v==1&&(y.VD(a),M=!0)),M?this.hg(y.J,y.Yc):(s=(M=new d.hd).Ib(s),a=M.Ib(a),y.Yo(M,u,f),M.I(s)!=0&&(y.Dp(s,a),y.j.Wg(),this.hg(y.J,y.Yc)))},l.qt=function(s,a,u,f,y){var v=new l;v.$i(),v.dj(f),v.tJ();var _=new d.l,M=new d.l;return s.A(_),a.A(M),f=!1,d.vd.fk(_,M,u)&&(v.Gu(s),f=!0),f||((_=d.vd.rc(s,a,!1))==4?(v.Gu(s),f=!0):_==1&&(v.uN(),f=!0)),f||(s=(f=new d.hd).Ib(s),a=f.Ib(a),v.Yo(f,u,y),v.By(s,a),v.j.Wg()),l.hg(v.J,v.Yc)},l.bB=function(s,a,u,f,y){var v=new l;v.$i(),v.dj(f),v.$W(),f=new d.l;var _=new d.l;s.A(f),a.A(_);var M=!1;return d.vd.fk(f,_,u)&&(v.KG(s,a),M=!0),M||d.vd.rc(s,a,!1)!=4||(v.KG(s,a),M=!0),M||(s=(f=new d.hd).Ib(s),a=f.Ib(a),v.Yo(f,u,y),v.$h=v.j.Fp(),v.mh=v.j.Fp(),l.Lw(s,v.j,v.$h),l.Lw(a,v.j,v.mh),v.Dp(s,a),v.j.Gp(v.$h),v.j.Gp(v.mh),v.j.Wg()),l.hg(v.J,v.Yc)},l.tt=function(s,a,u,f,y){var v=new l;v.$i(),v.dj(f),v.HJ(),f=new d.l;var _=new d.l;s.A(f),a.A(_);var M=!1;return d.vd.fk(f,_,u)&&(v.Qz(s),M=!0),M||d.vd.rc(s,a,!1)!=4||(v.Qz(s),M=!0),M||(s=(f=new d.hd).Ib(s),a=f.Ib(a),v.Yo(f,u,y),v.$h=v.j.Fp(),l.Lw(s,v.j,v.$h),v.By(s,a),v.j.Gp(v.$h),v.j.Wg()),l.hg(v.J,v.Yc)},l.UA=function(s,a,u,f,y){var v=new l;v.$i(),v.dj(f),v.MJ(),f=new d.l;var _=new d.l;s.A(f),a.A(_);var M=!1;return d.vd.fk(f,_,u)&&(v.tI(),M=!0),M||(s=(f=new d.hd).Ib(s),a=f.Ib(a),v.Yo(f,u,y),v.By(s,a),v.j.Wg()),l.hg(v.J,v.Yc)},l.rt=function(s,a,u,f){var y=new l;y.$i(),y.dj(f),y.tJ();var v=new d.l;s.A(v),a=a.D();var _=!1;return d.vd.Tw(a,v,u)&&(y.Gu(s),_=!0),_||((u=d.jd.Zd(s,a,u))==1?(y.J[0]=0,y.J[2]=2,y.J[3]=-1,y.J[5]=1,y.J[6]=-1):u==2?(y.J[6]=-1,s.He()!=0?(y.J[0]=-1,y.J[3]=0,y.J[2]=2,y.J[5]=1):(y.J[0]=0,y.J[3]=-1,y.J[5]=-1,u=new d.l,s.A(u),y.J[2]=u.da()==0&&u.S()==0?-1:1)):y.Gu(s)),this.hg(y.J,f)},l.ut=function(s,a,u,f,y){var v=new l;v.$i(),v.dj(f),v.HJ();var _=new d.l;s.A(_),f=a.D();var M=!1;if(d.vd.Tw(f,_,u)&&(v.Qz(s),M=!0),!M){_=null;var $=M=!1;(v.fa[0]||v.fa[6])&&(d.vd.Tz(s,f,u)?(v.fa[0]&&(_=d.si.im(s,y),$=!d.vd.lt(_,f,u),M=!0,v.J[0]=$?-1:0),v.J[6]=-1):(v.J[0]=-1,v.J[6]=0)),v.fa[3]&&(_!=null&&_.B()?v.J[3]=-1:(M||(_==null&&(_=d.si.im(s,y)),$=!d.vd.lt(_,f,u),M=!0),v.J[3]=$?0:-1)),v.fa[5]&&(_!=null&&_.B()?v.J[5]=-1:M&&!$?v.J[5]=0:(_==null&&(_=d.si.im(s,y)),y=d.vd.Pw(_,a,u),v.J[5]=y?-1:0)),v.fa[2]&&(s.Rb()!=0?v.J[2]=1:((y=new d.ee(s.description)).Gd(s,0,s.I()),s=d.vd.Pw(y,a,u),v.J[2]=s?-1:0))}return this.hg(v.J,v.Yc)},l.mt=function(s,a,u,f){var y=new l;y.$i(),y.dj(f),y.MJ();var v=new d.l;s.A(v),a=a.D();var _=!1;if(d.vd.Tw(a,v,u)&&(y.tI(),_=!0),!_){v=!1,_=!0,u*=u;for(var M=0;M<s.I();M++){var $=s.Oa(M);if(d.h.zc($,a)<=u?v=!0:_=!1,v&&!_)break}v?(y.J[0]=0,y.J[2]=_?-1:0,y.J[6]=-1):(y.J[0]=-1,y.J[2]=0,y.J[6]=0)}return l.hg(y.J,f)},l.VU=function(s,a,u,f){s=s.D(),a=a.D();for(var y=[],v=0;9>v;v++)y[v]=-1;return d.h.zc(s,a)<=u*u?y[0]=0:(y[2]=0,y[6]=0),y[8]=2,l.hg(y,f)},l.hg=function(s,a){for(var u=0;9>u;u++)switch(a.charAt(u)){case"T":if(s[u]==-1)return!1;break;case"F":if(s[u]!=-1)return!1;break;case"0":if(s[u]!=0)return!1;break;case"1":if(s[u]!=1)return!1;break;case"2":if(s[u]!=2)return!1}return!0},l.pW=function(s,a,u){var f=[-1,-1,-1,-1,-1,-1,-1,-1,-1];if(s.B()&&a.B()){for(var y=0;9>y;y++)f[y]=-1;return this.hg(f,u)}return y=!1,s.B()&&(s=a,y=!0),f[0]=-1,f[1]=-1,f[3]=-1,f[4]=-1,f[6]=-1,f[7]=-1,f[8]=2,a=s.K(),d.ba.Ic(a)?a==1736?s.He()!=0?(f[2]=2,f[5]=1):(f[5]=-1,a=new d.l,s.A(a),f[2]=a.da()==0&&a.S()==0?0:1):(a=s.Rb()!=0,f[2]=a?1:0,f[5]=d.si.cq(s)?0:-1):(f[2]=0,f[5]=-1),y&&this.qK(f),this.hg(f,u)},l.HR=function(s,a,u){return l.ZP(s)?3:l.PP(s)?4:l.ZX(s,a,u)?8:l.xP(s,a,u)?16:l.$O(s)?1:l.zU(s,a,u)?32:0},l.ZP=function(s){return s.charAt(0)=="T"&&s.charAt(1)=="*"&&s.charAt(2)=="F"&&s.charAt(3)=="*"&&s.charAt(4)=="*"&&s.charAt(5)=="F"&&s.charAt(6)=="F"&&s.charAt(7)=="F"&&s.charAt(8)=="*"},l.PP=function(s){return s.charAt(0)=="F"&&s.charAt(1)=="F"&&s.charAt(2)=="*"&&s.charAt(3)=="F"&&s.charAt(4)=="F"&&s.charAt(5)=="*"&&s.charAt(6)=="*"&&s.charAt(7)=="*"&&s.charAt(8)=="*"},l.ZX=function(s,a,u){return(a!=0||u!=0)&&((a!=2||u!=2)&&(s.charAt(0)=="F"&&s.charAt(1)=="*"&&s.charAt(2)=="*"&&s.charAt(3)=="T"&&s.charAt(4)=="*"&&s.charAt(5)=="*"&&s.charAt(6)=="*"&&s.charAt(7)=="*"&&s.charAt(8)=="*"||a==1&&u==1&&s.charAt(0)=="F"&&s.charAt(1)=="T"&&s.charAt(2)=="*"&&s.charAt(3)=="*"&&s.charAt(4)=="*"&&s.charAt(5)=="*"&&s.charAt(6)=="*"&&s.charAt(7)=="*"&&s.charAt(8)=="*")||u!=0&&s.charAt(0)=="F"&&s.charAt(1)=="*"&&s.charAt(2)=="*"&&s.charAt(3)=="*"&&s.charAt(4)=="T"&&s.charAt(5)=="*"&&s.charAt(6)=="*"&&s.charAt(7)=="*"&&s.charAt(8)=="*")},l.xP=function(s,a,u){return a>u?s.charAt(0)=="T"&&s.charAt(1)=="*"&&s.charAt(2)=="*"&&s.charAt(3)=="*"&&s.charAt(4)=="*"&&s.charAt(5)=="*"&&s.charAt(6)=="T"&&s.charAt(7)=="*"&&s.charAt(8)=="*":a==1&&u==1&&s.charAt(0)=="0"&&s.charAt(1)=="*"&&s.charAt(2)=="*"&&s.charAt(3)=="*"&&s.charAt(4)=="*"&&s.charAt(5)=="*"&&s.charAt(6)=="*"&&s.charAt(7)=="*"&&s.charAt(8)=="*"},l.$O=function(s){return s.charAt(0)=="T"&&s.charAt(1)=="*"&&s.charAt(2)=="*"&&s.charAt(3)=="*"&&s.charAt(4)=="*"&&s.charAt(5)=="*"&&s.charAt(6)=="F"&&s.charAt(7)=="F"&&s.charAt(8)=="*"},l.zU=function(s,a,u){if(a==u){if(a!=1)return s.charAt(0)=="T"&&s.charAt(1)=="*"&&s.charAt(2)=="T"&&s.charAt(3)=="*"&&s.charAt(4)=="*"&&s.charAt(5)=="*"&&s.charAt(6)=="T"&&s.charAt(7)=="*"&&s.charAt(8)=="*";if(s.charAt(0)=="1"&&s.charAt(1)=="*"&&s.charAt(2)=="T"&&s.charAt(3)=="*"&&s.charAt(4)=="*"&&s.charAt(5)=="*"&&s.charAt(6)=="T"&&s.charAt(7)=="*"&&s.charAt(8)=="*")return!0}return!1},l.Lw=function(s,a,u){s=a.Ma(s);for(var f=a.Oe;f!=-1;f=a.Tf(f))if((a.yd(f)&s)!=0){var y=a.Je(f);if(y==-1)a.pn(f,u,0);else{var v=y,_=0;do(a.fh(v)&s)!=0&&_++,v=a.kc(a.ya(v));while(v!=y);a.pn(f,u,_)}}},l.aq=function(s){var a=""+s.charAt(0);return a+=s.charAt(3),a+=s.charAt(6),a+=s.charAt(1),a+=s.charAt(4),a+=s.charAt(7),a+=s.charAt(2),(a+=s.charAt(5))+s.charAt(8)},l.prototype.$i=function(){for(var s=0;9>s;s++)this.J[s]=-2,this.$a[s]=-2},l.qK=function(s){var a=s[1],u=s[2],f=s[5];s[1]=s[3],s[2]=s[6],s[5]=s[7],s[3]=a,s[6]=u,s[7]=f},l.prototype.dj=function(s){for(this.Yc=s,s=0;9>s;s++)this.Yc.charAt(s)!="*"?(this.fa[s]=!0,this.me++):this.fa[s]=!1},l.prototype.PJ=function(){for(var s=0;9>s;s++)this.fa[s]&&this.J[s]==-2&&(this.J[s]=-1,this.fa[s]=!1)},l.prototype.qc=function(s){return this.J[s]!=-2&&(this.J[s]==-1?(this.fa[s]=!1,this.me--,!0):this.Yc.charAt(s)!="T"&&this.Yc.charAt(s)!="F"?!(this.J[s]<this.$a[s])&&(this.fa[s]=!1,this.me--,!0):(this.fa[s]=!1,this.me--,!0))},l.prototype.sJ=function(){this.xw=0,this.$a[0]=2,this.$a[1]=1,this.$a[2]=2,this.$a[3]=1,this.$a[4]=1,this.$a[5]=1,this.$a[6]=2,this.$a[7]=1,this.$a[8]=2,this.fa[8]&&(this.J[8]=2,this.fa[8]=!1,this.me--)},l.prototype.DB=function(){this.xw=1,this.Um=3,this.$a[0]=1,this.$a[1]=0,this.$a[2]=2,this.$a[3]=1,this.$a[4]=0,this.$a[5]=1,this.$a[6]=1,this.$a[7]=0,this.$a[8]=2,this.fa[8]&&(this.J[8]=2,this.fa[8]=!1,this.me--)},l.prototype.$W=function(){this.xw=2,this.Um=4,this.$a[0]=1,this.$a[1]=0,this.$a[2]=1,this.$a[3]=0,this.$a[4]=0,this.$a[5]=0,this.$a[6]=1,this.$a[7]=0,this.$a[8]=2,this.fa[8]&&(this.J[8]=2,this.fa[8]=!1,this.me--)},l.prototype.tJ=function(){this.Um=3,this.$a[0]=0,this.$a[1]=-1,this.$a[2]=2,this.$a[3]=0,this.$a[4]=-1,this.$a[5]=1,this.$a[6]=0,this.$a[7]=-1,this.$a[8]=2,this.fa[1]&&(this.J[1]=-1,this.fa[1]=!1,this.me--),this.fa[4]&&(this.J[4]=-1,this.fa[4]=!1,this.me--),this.fa[7]&&(this.J[7]=-1,this.fa[7]=!1,this.me--),this.fa[8]&&(this.J[8]=2,this.fa[8]=!1,this.me--)},l.prototype.HJ=function(){this.Um=4,this.$a[0]=0,this.$a[1]=-1,this.$a[2]=1,this.$a[3]=0,this.$a[4]=-1,this.$a[5]=0,this.$a[6]=0,this.$a[7]=-1,this.$a[8]=2,this.fa[1]&&(this.J[1]=-1,this.fa[1]=!1,this.me--),this.fa[4]&&(this.J[4]=-1,this.fa[4]=!1,this.me--),this.fa[7]&&(this.J[7]=-1,this.fa[7]=!1,this.me--),this.fa[8]&&(this.J[8]=2,this.fa[8]=!1,this.me--)},l.prototype.MJ=function(){this.Um=5,this.$a[0]=0,this.$a[1]=-1,this.$a[2]=0,this.$a[3]=-1,this.$a[4]=-1,this.$a[5]=-1,this.$a[6]=0,this.$a[7]=-1,this.$a[8]=2,this.fa[1]&&(this.J[1]=-1,this.fa[1]=!1,this.me--),this.fa[3]&&(this.J[3]=-1,this.fa[3]=!1,this.me--),this.fa[4]&&(this.J[4]=-1,this.fa[4]=!1,this.me--),this.fa[5]&&(this.J[5]=-1,this.fa[5]=!1,this.me--),this.fa[7]&&(this.J[7]=-1,this.fa[7]=!1,this.me--),this.fa[8]&&(this.J[8]=2,this.fa[8]=!1,this.me--)},l.prototype.sN=function(s,a,u){var f=!0;return this.fa[0]&&(this.xS(s,a,u),f=f&&this.qc(0)),this.fa[1]&&(this.nG(s,a,1),f=f&&this.qc(1)),this.fa[2]&&(this.oG(s,a,u,2),f=f&&this.qc(2)),this.fa[3]&&(this.nG(s,u,3),f=f&&this.qc(3)),this.fa[4]&&(this.wN(s,a,u),f=f&&this.qc(4)),this.fa[5]&&(this.$D(s,u,5),f=f&&this.qc(5)),this.fa[6]&&(this.oG(s,u,a,6),f=f&&this.qc(6)),this.fa[7]&&(this.$D(s,a,7),f=f&&this.qc(7)),f},l.prototype.Eu=function(s,a){this.J[0]=-1,this.J[1]=-1,this.J[3]=-1,this.J[4]=-1,this.Hr(s,this.fa[2]?2:-1,this.Yc.charAt(2),this.fa[5]?5:-1,this.Yc.charAt(5)),this.Hr(a,this.fa[6]?6:-1,this.Yc.charAt(6),this.fa[7]?7:-1,this.Yc.charAt(7))},l.prototype.Hr=function(s,a,u,f,y){a==-1&&f==-1||((u!="T"&&u!="F"&&a!=-1||y!="T"&&y!="F"&&f!=-1)&&s.He()==0?(f!=-1&&(this.J[f]=-1),a!=-1&&(u=new d.l,s.A(u),this.J[a]=u.da()==0&&u.S()==0?0:1)):(a!=-1&&(this.J[a]=2),f!=-1&&(this.J[f]=1)))},l.prototype.hy=function(s){this.J[2]=2,this.J[3]=-1,this.J[4]=-1,this.J[5]=1,this.J[6]=-1,this.J[7]=-1,this.Hr(s,this.fa[0]?0:-1,this.Yc.charAt(0),this.fa[1]?1:-1,this.Yc.charAt(1))},l.prototype.UD=function(s){this.hy(s),l.qK(this.J)},l.prototype.Fu=function(s,a){if(this.J[0]=-1,this.J[1]=-1,this.J[3]=-1,this.J[4]=-1,this.fa[6]){var u=this.Yc.charAt(6);u=u=="T"||u=="F"||a.Rb()!=0,this.J[6]=u?1:0}this.fa[7]&&(a=d.si.cq(a),this.J[7]=a?0:-1),this.Hr(s,this.fa[2]?2:-1,this.Yc.charAt(2),this.fa[5]?5:-1,this.Yc.charAt(5))},l.prototype.VD=function(s){if(this.fa[0]){var a=this.Yc.charAt(0);a=a=="T"||a=="F"||s.Rb()!=0,this.J[0]=a?1:0}this.fa[1]&&(s=d.si.cq(s),this.J[1]=s?0:-1),this.J[2]=2,this.J[3]=-1,this.J[4]=-1,this.J[5]=1,this.J[6]=-1,this.J[7]=-1},l.prototype.Gu=function(s){this.J[0]=-1,this.J[3]=-1,this.J[6]=0,this.Hr(s,this.fa[2]?2:-1,this.Yc.charAt(2),this.fa[5]?5:-1,this.Yc.charAt(5))},l.prototype.uN=function(){this.J[0]=0,this.J[2]=2,this.J[3]=-1,this.J[5]=1,this.J[6]=-1},l.prototype.KG=function(s,a){if(this.J[0]=-1,this.J[1]=-1,this.J[3]=-1,this.J[4]=-1,this.fa[2]){var u=this.Yc.charAt(2);u=u=="T"||u=="F"||s.Rb()!=0,this.J[2]=u?1:0}this.fa[5]&&(s=d.si.cq(s),this.J[5]=s?0:-1),this.fa[6]&&(u=(u=this.Yc.charAt(6))=="T"||u=="F"||a.Rb()!=0,this.J[6]=u?1:0),this.fa[7]&&(a=d.si.cq(a),this.J[7]=a?0:-1)},l.prototype.Qz=function(s){if(this.J[0]=-1,this.J[3]=-1,this.fa[2]){var a=this.Yc.charAt(2);a=a=="T"||a=="F"||s.Rb()!=0,this.J[2]=a?1:0}this.fa[5]&&(s=d.si.cq(s),this.J[5]=s?0:-1),this.J[6]=0},l.prototype.tI=function(){this.J[0]=-1,this.J[2]=0,this.J[6]=0},l.prototype.tN=function(s,a,u){var f=!0;return this.fa[0]&&(this.yS(s,a),f=f&&this.qc(0)),this.fa[1]&&(this.uS(s,a,u,this.mh),f=f&&this.qc(1)),this.fa[2]&&(this.vS(s,a),f=f&&this.qc(2)),this.fa[3]&&(this.AN(s,a,u,this.mh),f=f&&this.qc(3)),this.fa[4]&&(this.xN(s,a,u,this.mh),f=f&&this.qc(4)),this.fa[5]&&(this.yN(s,a,u),f=f&&this.qc(5)),this.fa[6]&&(this.gQ(s,a),f=f&&this.qc(6)),this.fa[7]&&(this.fQ(s,a,u,this.mh),f=f&&this.qc(7)),f},l.prototype.hT=function(s,a,u){var f=!0;return this.fa[0]&&(this.BS(s,a,u,this.$h,this.mh),f=f&&this.qc(0)),this.fa[1]&&(this.pG(s,a,u,this.$h,this.mh,1),f=f&&this.qc(1)),this.fa[2]&&(this.qG(s,a,u,2),f=f&&this.qc(2)),this.fa[3]&&(this.pG(s,u,a,this.mh,this.$h,3),f=f&&this.qc(3)),this.fa[4]&&(this.CN(s,a,u,this.$h,this.mh),f=f&&this.qc(4)),this.fa[5]&&(this.aE(s,u,this.$h,5),f=f&&this.qc(5)),this.fa[6]&&(this.qG(s,u,a,6),f=f&&this.qc(6)),this.fa[7]&&(this.aE(s,a,this.mh,7),f=f&&this.qc(7)),f},l.prototype.WD=function(s,a,u){var f=!0;return this.fa[0]&&(this.zS(s,a),f=f&&this.qc(0)),this.fa[2]&&(this.wS(s,a),f=f&&this.qc(2)),this.fa[3]&&(this.BN(s,a,u),f=f&&this.qc(3)),this.fa[5]&&(this.zN(s,a),f=f&&this.qc(5)),this.fa[6]&&(this.hQ(s,a),f=f&&this.qc(6)),f},l.prototype.LG=function(s,a,u){var f=!0;return this.fa[0]&&(this.CS(s,a,u,this.$h),f=f&&this.qc(0)),this.fa[2]&&(this.AS(s,u),f=f&&this.qc(2)),this.fa[3]&&(this.EN(s,a,u,this.$h),f=f&&this.qc(3)),this.fa[5]&&(this.DN(s,a,u,this.$h),f=f&&this.qc(5)),this.fa[6]&&(this.iQ(s,a,u),f=f&&this.qc(6)),f},l.prototype.UU=function(s,a,u){var f=!0;return this.fa[0]&&(this.DS(s,a,u),f=f&&this.qc(0)),this.fa[2]&&(this.rG(s,a,u,2),f=f&&this.qc(2)),this.fa[6]&&(this.rG(s,u,a,6),f=f&&this.qc(6)),f},l.prototype.xS=function(s,a,u){this.J[0]!=2&&((s=this.j.af(s))&a)!=0&&(s&u)!=0&&(this.J[0]=2)},l.prototype.nG=function(s,a,u){if(this.J[u]!=1){var f=this.j.af(this.j.ya(s));(this.j.af(s)&a)!=0&&(f&a)!=0&&(this.J[u]=1)}},l.prototype.oG=function(s,a,u,f){this.J[f]!=2&&((s=this.j.af(s))&a)!=0&&(s&u)==0&&(this.J[f]=2)},l.prototype.wN=function(s,a,u){if(this.J[4]!=1){var f=this.j.fh(s);(f&a)!=0&&(f&u)!=0?this.J[4]=1:this.J[4]!=0&&this.j.Bb(this.j.ue(this.j.ya(s)),this.Wi)!=1&&((s=this.j.yd(this.j.vf(s)))&a)!=0&&(s&u)!=0&&(this.J[4]=0)}},l.prototype.$D=function(s,a,u){if(this.J[u]!=1){var f=this.j.af(this.j.ya(s));(this.j.af(s)&a)==0&&(f&a)==0&&(this.J[u]=1)}},l.prototype.yS=function(s,a){if(this.J[0]!=1){var u=this.j.af(this.j.ya(s));(this.j.af(s)&a)!=0&&(u&a)!=0&&(this.J[0]=1)}},l.prototype.uS=function(s,a,u,f){if(this.J[1]!=0&&this.j.Bb(this.j.ue(this.j.ya(s)),this.Wi)!=1){var y=this.j.vf(s),v=this.j.yd(y);(v&a)==0&&(this.j.af(s)&a)!=0&&(s=this.j.og(y,f),(v&u)!=0&&s%2!=0&&(this.J[1]=0))}},l.prototype.vS=function(s,a){this.J[2]!=2&&(this.j.fh(s)&a)!=0&&(this.J[2]=2)},l.prototype.AN=function(s,a,u,f){if(this.J[3]!=1){var y=this.j.fh(s);(y&a)!=0&&(y&u)!=0?this.J[3]=1:this.J[3]!=0&&this.j.Bb(this.j.ue(this.j.ya(s)),this.Wi)!=1&&(y=this.j.vf(s),((s=this.j.yd(y))&a)!=0&&(a=this.j.og(y,f),(s&u)!=0&&a%2==0&&(this.J[3]=0)))}},l.prototype.xN=function(s,a,u,f){if(this.J[4]!=0&&this.j.Bb(this.j.ue(this.j.ya(s)),this.Wi)!=1){var y=this.j.vf(s);((s=this.j.yd(y))&a)!=0&&(a=this.j.og(y,f),(s&u)!=0&&a%2!=0&&(this.J[4]=0))}},l.prototype.yN=function(s,a,u){this.J[5]!=1&&((s=this.j.fh(s))&a)!=0&&(s&u)==0&&(this.J[5]=1)},l.prototype.gQ=function(s,a){if(this.J[6]!=1){var u=this.j.af(this.j.ya(s));(this.j.af(s)&a)==0&&(u&a)==0&&(this.J[6]=1)}},l.prototype.fQ=function(s,a,u,f){if(this.J[7]!=0&&this.j.Bb(this.j.ue(this.j.ya(s)),this.Wi)!=1){var y=this.j.vf(s),v=this.j.yd(y);(v&a)==0&&(this.j.af(s)&a)==0&&(s=this.j.og(y,f),(v&u)!=0&&s%2!=0&&(this.J[7]=0))}},l.prototype.BS=function(s,a,u,f,y){if(this.J[0]!=1){var v=this.j.fh(s);(v&a)!=0&&(v&u)!=0?this.J[0]=1:this.J[0]!=0&&this.j.Bb(this.j.ue(this.j.ya(s)),this.Wi)!=1&&(s=this.j.vf(s),((v=this.j.yd(s))&a)!=0&&(v&u)!=0&&(a=this.j.og(s,f),y=this.j.og(s,y),a%2==0&&y%2==0&&(this.J[0]=0)))}},l.prototype.pG=function(s,a,u,f,y,v){if(this.J[v]!=0&&this.j.Bb(this.j.ue(this.j.ya(s)),this.Wi)!=1){s=this.j.vf(s);var _=this.j.yd(s);(_&a)!=0&&(_&u)!=0&&(a=this.j.og(s,f),y=this.j.og(s,y),a%2==0&&y%2!=0&&(this.J[v]=0))}},l.prototype.qG=function(s,a,u,f){this.J[f]!=1&&((s=this.j.fh(s))&a)!=0&&(s&u)==0&&(this.J[f]=1)},l.prototype.CN=function(s,a,u,f,y){if(this.J[4]!=0&&this.j.Bb(this.j.ue(this.j.ya(s)),this.Wi)!=1){s=this.j.vf(s);var v=this.j.yd(s);(v&a)!=0&&(v&u)!=0&&(a=this.j.og(s,f),y=this.j.og(s,y),a%2!=0&&y%2!=0&&(this.J[4]=0))}},l.prototype.aE=function(s,a,u,f){this.J[f]!=0&&this.j.Bb(this.j.ue(this.j.ya(s)),this.Wi)!=1&&(s=this.j.vf(s),(this.j.yd(s)&a)==0&&this.j.og(s,u)%2!=0&&(this.J[f]=0))},l.prototype.zS=function(s,a){this.J[0]!=0&&(this.j.yd(s)&a)==0&&(this.j.jk(this.j.Yy(s))&a)!=0&&(this.J[0]=0)},l.prototype.wS=function(s,a){this.J[2]!=2&&(this.j.yd(s)&a)!=0&&(this.J[2]=2)},l.prototype.BN=function(s,a,u){this.J[3]!=0&&((s=this.j.yd(s))&a)!=0&&(s&u)!=0&&(this.J[3]=0)},l.prototype.zN=function(s,a){this.J[5]!=1&&(this.j.yd(s)&a)!=0&&(this.J[5]=1)},l.prototype.hQ=function(s,a){this.J[6]!=0&&(this.j.yd(s)&a)==0&&(this.j.jk(this.j.Yy(s))&a)==0&&(this.J[6]=0)},l.prototype.CS=function(s,a,u,f){if(this.J[0]!=0){var y=this.j.yd(s);(y&a)!=0&&(y&u)!=0&&this.j.og(s,f)%2==0&&(this.J[0]=0)}},l.prototype.AS=function(s,a){this.J[2]!=1&&(this.j.Je(s)!=-1?this.J[2]=1:this.J[2]!=0&&(this.j.yd(s)&a)==0&&(this.J[2]=0))},l.prototype.EN=function(s,a,u,f){if(this.J[3]!=0){var y=this.j.yd(s);(y&a)!=0&&(y&u)!=0&&this.j.og(s,f)%2!=0&&(this.J[3]=0)}},l.prototype.DN=function(s,a,u,f){if(this.J[5]!=0){var y=this.j.yd(s);(y&a)!=0&&(y&u)==0&&this.j.og(s,f)%2!=0&&(this.J[5]=0)}},l.prototype.iQ=function(s,a,u){this.J[6]!=0&&((s=this.j.yd(s))&a)==0&&(s&u)!=0&&(this.J[6]=0)},l.prototype.DS=function(s,a,u){this.J[0]!=0&&((s=this.j.yd(s))&a)!=0&&(s&u)!=0&&(this.J[0]=0)},l.prototype.rG=function(s,a,u,f){this.J[f]!=0&&((s=this.j.yd(s))&a)!=0&&(s&u)==0&&(this.J[f]=0)},l.prototype.Dp=function(s,a){var u=!1;s=this.j.Ma(s),a=this.j.Ma(a),this.Wi=this.j.bh();for(var f=this.j.Oe;f!=-1;f=this.j.Tf(f)){var y=this.j.Je(f);if(y==-1){if(this.Um!=-1)switch(this.Um){case 3:u=this.WD(f,s,a);break;case 4:u=this.LG(f,s,a);break;default:throw d.i.ga("internal error")}}else{var v=y;do{var _=v;if(this.j.Bb(_,this.Wi)!=1)do{switch(this.xw){case 0:u=this.sN(_,s,a);break;case 1:u=this.tN(_,s,a);break;case 2:u=this.hT(_,s,a);break;default:throw d.i.ga("internal error")}if(u)break;this.j.Kb(_,this.Wi,1),_=this.j.kc(_)}while(_!=v&&!u);if(u)break;v=this.j.kc(this.j.ya(_))}while(v!=y);if(u)break}}u||this.PJ(),this.j.Lg(this.Wi)},l.prototype.By=function(s,a){var u=!1;s=this.j.Ma(s),a=this.j.Ma(a);for(var f=this.j.Oe;f!=-1;f=this.j.Tf(f)){switch(this.Um){case 3:u=this.WD(f,s,a);break;case 4:u=this.LG(f,s,a);break;case 5:u=this.UU(f,s,a);break;default:throw d.i.Ra()}if(u)break}u||this.PJ()},l.prototype.gr=function(s,a){this.j.fr(s,a)},l.prototype.Yo=function(s,a,u){this.TP(s,a,u),this.gr(s,u)},l.prototype.TP=function(s,a,u){for(d.Vk.W(s,a,u,!1),s.Ip(0,!0,!0),a=s.md;a!=-1;a=s.ve(a))s.jc(a)==1736&&d.tn.W(s,a,-1,!1,u)},l.RE=function(s,a){var u=s.K();return d.ba.zd(u)?((a=new d.Ua(s.description)).pc(s,!0),a):u==197?(u=new d.l,s.A(u),u.da()<=a&&u.S()<=a?(a=new d.Ta(s.description),s.tf(a),a):u.da()<=a||u.S()<=a?(a=new d.Ua(s.description),u=new d.Ta,s.If(0,u),a.nf(u),s.If(2,u),a.lineTo(u),a):((a=new d.Ea(s.description)).bd(s,!1),a)):s},l}(),d.cm=O}(Q||(Q={})),function(d){var O=function(){function l(s){this.Gm=new d.ja(0),this.fw=new d.ja(0),this.xt=new d.h,this.yt=new d.h,this.g=s,this.Js=-1}return l.prototype.cc=function(s){return this.g.cc(this.uz(s))},l.prototype.Dv=function(s){var a=this.dz(s);if(s=this.CF(s),this.g.Na(a)==s){var u=a;a=s,s=u}return this.g.Hc(a,this.xt),this.g.Hc(s,this.yt),this.xt.y<this.yt.y},l.prototype.uz=function(s){var a=this.dz(s);return s=this.CF(s),this.g.V(a)==s?a:s},l.prototype.dz=function(s){return this.Gm.get(s)},l.prototype.CF=function(s){return this.fw.get(s)},l.prototype.mF=function(s){this.Gm.set(s,this.Js),this.Js=s},l.prototype.iI=function(s){if(this.Js!=-1){var a=this.Js;return this.Js=this.Gm.get(a),this.Gm.set(a,s),this.fw.set(a,this.g.V(s)),a}return this.Gm==null&&(this.Gm=new d.ja(0),this.fw=new d.ja(0)),a=this.Gm.size,this.Gm.add(s),this.fw.add(this.g.V(s)),a},l.prototype.mz=function(s){return this.g.cd(this.dz(s))},l}();d.uY=O;var S=function(){function l(s){this.Ce=s,this.je=new d.zb,this.Pm=new d.zb,this.xH=0,this.Co=null,this.tA=-1}return l.prototype.compare=function(s,a,u){u=s.ka(u);var f=this.Ce.hb;if(this.tA==a)var y=this.xH;else this.Co=f.cc(a),this.Co==null?((s=f.g).fd(f.uz(a),this.je),this.Co=this.je,y=this.je.Me(this.Ce.Ah,0)):y=this.Co.Me(this.Ce.Ah,0),this.xH=y,this.tA=a;if((s=f.cc(u))==null){(s=f.g).fd(f.uz(u),this.Pm),s=this.Pm;var v=this.Pm.Me(this.Ce.Ah,0)}else v=s.Me(this.Ce.Ah,0);return y==v&&(a=f.Dv(a),u=f.Dv(u),(a=.5*((u=Math.min(a?this.Co.ma:this.Co.oa,u?s.ma:s.oa))+this.Ce.Ah))==this.Ce.Ah&&(a=u),y=this.Co.Me(a,0),v=s.Me(a,0)),y<v?-1:y>v?1:0},l.prototype.reset=function(){this.tA=-1},l}(),p=function(){function l(){this.Ym=this.Il=null,this.fb=new d.$j,this.fb.MP(),this.ae=new S(this),this.fb.Xo(this.ae)}return l.prototype.CQ=function(){var s=!1;if(this.hw&&(s=this.DQ()),this.g.ea(this.Y)==1){var a=this.g.Ob(this.Y);return s=this.g.qz(a),this.g.KB(a,!0),0>s&&(s=this.g.Ya(a),this.g.kJ(s),this.g.Yg(a,this.g.Na(s)),!0)}for(this.Gl=this.g.Fy(),this.yo=this.g.Fy(),a=this.g.Ob(this.Y);a!=-1;a=this.g.Sb(a))this.g.ir(a,this.Gl,0),this.g.ir(a,this.yo,-1);a=new d.ja(0),this.Ah=NaN;var u=new d.h;this.ft=this.g.ea(this.Y),this.to=this.g.Hd(),this.Ts=this.g.Hd();for(var f=this.Il.sc(this.Il.ke);f!=-1;f=this.Il.lb(f)){var y=this.Il.getData(f);if(this.g.Hc(y,u),u.y!=this.Ah&&a.size!=0&&(s=this.vt(a)||s,this.ae.reset(),a.clear(!1)),a.add(y),this.Ah=u.y,this.ft==0)break}for(0<this.ft&&(s=this.vt(a)||s,a.clear(!1)),this.g.Ud(this.to),this.g.Ud(this.Ts),a=this.g.Ob(this.Y);a!=-1;)if(this.g.uj(a,this.Gl)==3){for(this.g.KB(a,!0),u=a,a=this.g.uj(a,this.yo);a!=-1;)f=this.g.uj(a,this.yo),this.g.UT(this.Y,this.g.Sb(u),a),u=a,a=f;a=this.g.Sb(u)}else this.g.KB(a,!1),a=this.g.Sb(a);return this.g.xB(this.Gl),this.g.xB(this.yo),s},l.prototype.vt=function(s){return this.VV(s)},l.prototype.VV=function(s){var a=!1;this.hb==null&&(this.hb=new O(this.g)),this.Ym==null?(this.Ym=new d.ja(0),this.Ym.Jb(16)):this.Ym.clear(!1),this.UV(s);for(var u=0,f=s.size;u<f;u++){var y=s.get(u);y!=-1&&this.jG(y,-1)}for(u=0;u<this.Ym.size&&0<this.ft;u++)if(s=this.Ym.get(u),y=this.hb.mz(this.fb.ka(s)),f=-1,this.g.uj(y,this.Gl)==0){y=this.fb.xe(s);for(var v,_=s;y!=-1;){var M=this.fb.ka(y),$=this.hb.mz(M),T=this.g.uj($,this.Gl);if(T!=0){f=$;break}_=y,y=this.fb.xe(y)}y==-1?(v=!0,y=_):(M=this.fb.ka(y),v=this.hb.Dv(M),y=this.fb.lb(y),v=!v);do{if(M=this.fb.ka(y),$=this.hb.mz(M),(T=this.g.uj($,this.Gl))==0&&(v!=this.hb.Dv(M)&&(a=this.g.Ya($),this.g.kJ(a),this.g.Yg($,this.g.Na(a)),a=!0),this.g.ir($,this.Gl,v?3:2),v||(_=this.g.uj(f,this.yo),this.g.ir(f,this.yo,$),this.g.ir($,this.yo,_)),this.ft--,this.ft==0))return a;f=$,_=y,y=this.fb.lb(y),v=!v}while(_!=s)}return a},l.prototype.UV=function(s){for(var a=0,u=s.size;a<u;a++){var f=s.get(a),y=this.g.Qa(f,this.to),v=this.g.Qa(f,this.Ts);if(y!=-1){var _=this.fb.ka(y);this.hb.mF(_),this.g.Sa(f,this.to,-1)}v!=-1&&(_=this.fb.ka(v),this.hb.mF(_),this.g.Sa(f,this.Ts,-1)),_=-1,y!=-1&&v!=-1?(this.fb.wd(y,-1),this.fb.wd(v,-1),s.set(a,-1)):_=y!=-1?y:v,_!=-1&&(this.jG(f,_)||this.fb.wd(_,-1),s.set(a,-1))}},l.prototype.jG=function(s,a){var u=new d.h,f=new d.h;this.g.Hc(s,u);var y=this.g.V(s);this.g.Hc(y,f);var v=!1;if(u.y<f.y){v=!0;var _=this.hb.iI(s);if(a==-1)var M=this.fb.addElement(_,-1);else M=a,this.fb.Uj(M,_);(_=this.g.Qa(y,this.to))==-1?this.g.Sa(y,this.to,M):this.g.Sa(y,this.Ts,M),y=this.g.cd(s),this.g.uj(y,this.Gl)==0&&this.Ym.add(M)}return y=this.g.Na(s),this.g.Hc(y,f),u.y<f.y&&(v=!0,_=this.hb.iI(y),a==-1?M=this.fb.addElement(_,-1):(M=a,this.fb.Uj(M,_)),(_=this.g.Qa(y,this.to))==-1?this.g.Sa(y,this.to,M):this.g.Sa(y,this.Ts,M),y=this.g.cd(s),this.g.uj(y,this.Gl)==0&&this.Ym.add(M)),v},l.W=function(s,a,u,f){var y=new l;return y.g=s,y.Y=a,y.Il=u,y.hw=f,y.CQ()},l.prototype.DQ=function(){var s=new d.ja(0),a=new d.ja(0),u=-1,f=-1,y=new d.h;y.Sc();for(var v=-1,_=-1,M=-1,$=new d.h,T=this.Il.sc(this.Il.ke);T!=-1;T=this.Il.lb(T)){var A=this.Il.getData(T);this.g.Hc(A,$);var R=this.g.cd(A);y.rb($)&&_==R?(f==-1&&(u=this.g.Fy(),f=this.g.Hd()),M==-1&&(M=a.size,this.g.Sa(v,f,M),a.add(1),this.g.uj(R,u)==-1&&(this.g.ir(R,u,v),s.add(R))),this.g.Sa(A,f,M),a.XW(a.Gc()+1)):(M=-1,y.N($)),v=A,_=R}if(s.size==0)return!1;for(y=new d.ja(0),v=new d.ja(0),_=0,M=s.size;_<M;_++){R=s.get(_);var D=this.g.uj(R,u);for(A=this.g.Qa(D,f),y.clear(!1),v.clear(!1),y.add(D),v.add(A),A=this.g.V(D);A!=D;A=this.g.V(A)){var V=A;if(($=this.g.Qa(V,f))!=-1)if(v.size==0)v.add($),y.add(V);else if(v.Gc()==$){T=y.Gc();var Z=this.g.V(T);D=this.g.V(V),this.g.Cc(T,D),this.g.Dc(D,T),this.g.Cc(V,Z),this.g.Dc(Z,V),V=[!1],Z=this.g.iG(this.Y,Z,this.g.Ya(R),V),this.g.Sa(A,f,-1),V[0]&&this.g.Kf(R,D),A=this.g.Ka(R),A-=D=this.g.Ka(Z),this.g.Xj(R,A),a.set($,a.get($)-1),a.get($)==1&&(a.set($,0),v.Jf(),y.Jf()),A=D=T}else y.add(A),v.add($)}}return this.g.xB(u),this.g.Ud(f),!0},l}();d.RL=p}(Q||(Q={})),function(d){var O=function(){function S(){}return S.prototype.jg=function(){this.KA=this.tb=null},S.prototype.get=function(){return this.KA},S.prototype.set=function(p){if(this.KA=p,p!=null)throw p.K()==322&&(this.tb=p),d.i.Ra()},S.prototype.create=function(p){if(p!=322)throw d.i.ga("Not Implemented");this.Qr()},S.prototype.Qr=function(){this.tb==null&&(this.tb=new d.zb),this.KA=this.tb},S}();d.jg=O}(Q||(Q={})),function(d){(d=d.SL||(d.SL={}))[d.enumLineSeg=1]="enumLineSeg",d[d.enumBezierSeg=2]="enumBezierSeg",d[d.enumArcSeg=4]="enumArcSeg",d[d.enumNonlinearSegmentMask=6]="enumNonlinearSegmentMask",d[d.enumSegmentMask=7]="enumSegmentMask",d[d.enumDensified=8]="enumDensified"}(Q||(Q={})),function(d){var O=function(p){this.bj=p,this.lC=this.mC=1,this.nB=this.mB=this.oB=0},S=function(){function p(){this.Hq=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],this.Dk=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],this.Cf=new d.Ta,this.ra=this.Ew=0,this.oo=[],this.bt=[],this.Aw=[],this.Kq=[],this.HA=[]}return p.prototype.rB=function(l){if(l!=null){for(var s=0,a=l.length;s<a;s++)this.mW(l[s]);l.length=0}},p.prototype.mW=function(l){l.bj=null,this.Kq.push(l)},p.prototype.Qw=function(l){if(this.Kq.length===0)var s=new O(l);else(s=this.Kq[this.Kq.length-1]).bj=l,--this.Kq.length;return s},p.prototype.NR=function(l,s){return l==0?this.bt[s]:this.Aw[s]},p.prototype.WA=function(){this.Ew>=this.HA.length&&this.HA.push(new d.jg);var l=this.HA[this.Ew];return this.Ew++,l},p.prototype.clear=function(){this.rB(this.oo),this.rB(this.bt),this.rB(this.Aw),this.Ew=0},p.prototype.Qo=function(l){this.oo.push(this.Qw(l))},p.prototype.ql=function(l){return l==0?this.bt.length:this.Aw.length},p.prototype.Xp=function(l,s){return this.NR(l,s).bj},p.prototype.Fa=function(l,s){if(this.oo.length!=2)throw d.i.Ra();this.ra=l;var a=d.mc.ox(.01*l),u=!1,f=this.oo[0],y=this.oo[1];if(s||(5&f.bj.Br(y.bj,l,!0))!=0){if(f.bj.K()==322){var v=f.bj;if(y.bj.K()==322){s=y.bj;var _=d.zb.Yx(v,s,null,this.Hq,this.Dk,l);if(_==0)throw d.zb.Yx(v,s,null,this.Hq,this.Dk,l),d.i.Ra();l=Array(9),d.P.bv(l,null);for(var M=0;M<_;M++){var $=this.Hq[M],T=this.Dk[M],A=f.nB,R=1;$==0?(A=f.oB,R=f.mC):$==1&&(A=f.mB,R=f.lC);var D=y.nB,V=1;T==0?(D=y.oB,V=y.mC):T==1&&(D=y.mB,V=y.lC);var Z=new d.h;A==D?(A=new d.h,v.ic($,A),$=new d.h,s.ic(T,$),V/=T=R+V,d.mc.JG(A,$,V,Z),d.h.zc(Z,A)+d.h.zc(Z,$)>a&&(u=!0)):A>D?(v.ic($,Z),$=new d.h,s.ic(T,$),d.h.zc(Z,$)>a&&(u=!0)):(s.ic(T,Z),A=new d.h,v.ic($,A),d.h.zc(Z,A)>a&&(u=!0)),l[M]=Z}for(f=0,y=-1,M=0;M<=_;M++)(V=M<_?this.Hq[M]:1)!=f&&(a=this.WA(),v.dh(f,V,a),y!=-1&&a.get().Ec(l[y]),M!=_&&a.get().Rc(l[M]),f=V,this.bt.push(this.Qw(a.get()))),y=M;for(v=[0,0,0,0,0,0,0,0,0],M=0;M<_;M++)v[M]=M;for(1<_&&this.Dk[0]>this.Dk[1]&&(V=this.Dk[0],this.Dk[0]=this.Dk[1],this.Dk[1]=V,M=v[0],v[0]=v[1],v[1]=M),f=0,y=-1,M=0;M<=_;M++)(V=M<_?this.Dk[M]:1)!=f&&(a=this.WA(),s.dh(f,V,a),y!=-1&&(f=v[y],a.get().Ec(l[f])),M!=_&&(f=v[M],a.get().Rc(l[f])),f=V,this.Aw.push(this.Qw(a.get()))),y=M;return u}}throw d.i.Ra()}return!1},p.prototype.Fz=function(l,s,a){if(s.copyTo(this.Cf),this.oo.length!=1)throw d.i.Ra();this.ra=l;var u=this.oo[0];if(a||u.bj.tu(s.D(),l,!0)){if(u.bj.K()!=322)throw d.i.Ra();var f=(l=u.bj).ge(s.D(),!1);this.Hq[0]=f;var y=u.nB;for(a=1,f==0?(y=u.oB,a=u.mC):f==1&&(y=u.mB,a=u.lC),u=new d.h,y==0?(y=new d.h,l.ic(f,y),s=s.D(),d.mc.JG(y,s,1/(a+1),u)):0<y?(u=new d.h,l.ic(f,u)):u=s.D(),a=0,f=-1,y=0;1>=y;y++){if((s=1>y?this.Hq[y]:1)!=a){var v=this.WA();l.dh(a,s,v),f!=-1&&v.get().Ec(u),y!=1&&v.get().Rc(u),a=s,this.bt.push(this.Qw(v.get()))}f=y}this.Cf.Db(u)}},p}();d.OC=S}(Q||(Q={})),function(d){var O=function(){function S(p){this.Fs=this.tk=this.tb=null,this.cg=0,this.Bm=!1,this.Af=-1,this.El=this.Kd=0,this.gb=-1,this.ib=p,this.cg=this.Vx(this.El),this.Bm=!1,this.tk=null,this.Fs=new d.h}return S.prototype.wW=function(p){if(this.ib!=p.ib)throw d.i.Hb();this.Af=p.Af,this.Kd=p.Kd,this.gb=p.gb,this.El=p.El,this.cg=p.cg,this.Bm=p.Bm,this.tk=null},S.prototype.ia=function(){if(this.Af!=this.Kd&&this.wD(),this.Bm)this.Kd=(this.Kd+1)%this.cg;else{if(this.Kd==this.cg)throw d.i.de();this.Kd++}return this.tk},S.prototype.ni=function(){if(this.Bm)this.Kd=(this.cg+this.Kd-1)%this.cg;else{if(this.Kd==0)throw d.i.de();this.Kd--}return this.Kd!=this.Af&&this.wD(),this.tk},S.prototype.xW=function(){this.Af=-1,this.Kd=0},S.prototype.yW=function(){this.Kd=this.cg,this.Af=-1},S.prototype.Wb=function(p,l){if(l===void 0&&(l=-1),0<=this.gb&&this.gb<this.ib.ea()){var s=this.DM();if(p>=s&&p<this.ib.Wc(this.gb))return this.Af=-1,void(this.Kd=p-s)}l=0<=l&&l<this.ib.ea()&&p>=this.ib.Ca(l)&&p<this.ib.Wc(l)?l:this.ib.nz(p),this.El=l+1,this.gb=l,this.Af=-1,this.Kd=p-this.ib.Ca(l),this.cg=this.Vx(l),this.ib.Ca(this.gb),this.ib.ec(this.gb)},S.prototype.ab=function(){return this.gb=this.El,!(this.gb>=this.ib.ea())&&(this.Af=-1,this.Kd=0,this.cg=this.Vx(this.gb),this.ib.Ca(this.gb),this.ib.ec(this.gb),this.El++,!0)},S.prototype.aj=function(){this.cg=this.Kd=this.Af=-1,this.El=0,this.gb=-1},S.prototype.Vx=function(p){if(this.ib.Bc())return 0;var l=1;return this.ib.ec(p)&&(l=0),this.ib.Ka(p)-l},S.prototype.Qn=function(){return this.Af==this.cg-1&&this.ib.ec(this.gb)},S.prototype.EB=function(){this.Bm=!0},S.prototype.xb=function(){return this.ib.nb.o[this.gb]+this.Af},S.prototype.DM=function(){return this.ib.Ca(this.gb)},S.prototype.kk=function(){return this.Qn()?this.ib.Ca(this.gb):this.xb()+1},S.prototype.xm=function(){return this.Af==0},S.prototype.Sn=function(){return this.Af==this.cg-1},S.prototype.Ia=function(){return this.Kd<this.cg},S.prototype.zz=function(){return 0<this.Kd},S.prototype.Qf=function(){var p=new S(this.ib);return p.Af=this.Af,p.Kd=this.Kd,p.cg=this.cg,p.gb=this.gb,p.El=this.El,p.ib=this.ib,p.Bm=this.Bm,p},S.prototype.wD=function(){if(0>this.Kd||this.Kd>=this.cg)throw d.i.de();this.Af=this.Kd;var p=this.xb();this.ib.oc();var l=this.ib.Se,s=1;switch(l!=null&&(s=7&l.read(p)),l=this.ib.description,s){case 1:this.tb==null&&(this.tb=new d.zb),this.tk=this.tb;break;case 2:throw d.i.ga("internal error");default:throw d.i.Ra()}this.tk.Pf(l),s=this.kk(),this.ib.Hc(p,this.Fs),this.tk.Ec(this.Fs),this.ib.Hc(s,this.Fs),this.tk.Rc(this.Fs);for(var a=1,u=l.Ba;a<u;a++)for(var f=l.ld(a),y=d.sa.Wa(f),v=0;v<y;v++){var _=this.ib.Vc(f,p,v);this.tk.TB(f,v,_),_=this.ib.Vc(f,s,v),this.tk.JB(f,v,_)}},S.prototype.VS=function(){return this.gb==this.ib.ea()-1},S.prototype.Rn=function(){var p=this.ib.QR();return p!=null&&(7&p.read(this.Af))!=1},S}();d.TL=O}(Q||(Q={})),function(d){var O=function(){function S(p){p instanceof d.ba?(this.sH=p,this.za=-1,this.Gi=1):(this.qT=p.slice(0),this.za=-1,this.Gi=p.length)}return S.prototype.Ma=function(){return this.za},S.prototype.next=function(){return this.za<this.Gi-1?(this.za++,this.sH!=null?this.sH:this.qT[this.za]):null},S.prototype.re=function(){},S}();d.$c=O}(Q||(Q={})),function(d){var O=function(){this.next=null},S=function(){function p(){this.Vq=this.Mw=this.Nw=0,this.fF=!1,this.bK=0,this.jn=this.Lf=this.Yl=this.Lh=null,this.Ql=0,this.qy=null,this.rl=this.ri=-1}return p.prototype.wX=function(l,s,a){this.ri=l,this.rl=s,this.Lh=this.Yl=null,this.Vq=0,this.qy=a,this.jn==null&&(this.jn=d.P.mg(384,0)),this.iK()},p.prototype.S=function(){return this.ri},p.prototype.da=function(){return this.rl},p.prototype.flush=function(){0<this.Ql&&(this.qy.bF(this.jn,this.Ql),this.Ql=0)},p.prototype.iK=function(){if(0<this.Vq){for(var l=0;l<this.rl;l++){for(var s=this.Yl[l];s!=null;){var a=s;s=s.next,a.next=null}this.Yl[l]=null}this.Lh=null}this.Nw=this.rl,this.Mw=-1,this.Vq=0},p.prototype.dJ=function(l){for(this.fF=l==p.Bx,l=this.Nw;l<=this.Mw;l++)this.nN(),this.gN(l),this.UP();this.iK()},p.prototype.fy=function(l,s,a,u){if(s!=u){var f=1;if(s>u&&(f=l,l=a,a=f,f=s,s=u,u=f,f=-1),!(0>u||s>=this.rl)){0>l&&0>a?a=l=-1:l>=this.ri&&a>=this.ri&&(a=l=this.ri);var y=(a-l)/(u-s);u>this.rl&&(a=y*((u=this.rl)-s)+l),0>s&&(l=y*(0-s)+l,s=0);var v=Math.max(this.ri+1,8388607);-8388607>l?(s=(0-l)/y+s,l=0):l>v&&(s=(this.ri-l)/y+s,l=this.ri),-8388607>a?u=(0-l)/y+s:a>v&&(u=(this.ri-l)/y+s),(s=d.P.truncate(s))!=(u=d.P.truncate(u))&&((a=new O).x=d.P.truncate(4294967296*l),a.y=s,a.H=u,a.RP=d.P.truncate(4294967296*y),a.dir=f,this.Yl==null&&(this.Yl=d.P.mg(this.rl,null)),a.next=this.Yl[a.y],this.Yl[a.y]=a,a.y<this.Nw&&(this.Nw=a.y),a.H>this.Mw&&(this.Mw=a.H),this.Vq++)}}},p.prototype.nN=function(){if(this.Lh!=null){for(var l=!1,s=null,a=this.Lh;a!=null;)if(a.y++,a.y==a.H){var u=a;a=a.next,s!=null?s.next=a:this.Lh=a,u.next=null}else a.x+=a.RP,s!=null&&s.x>a.x&&(l=!0),s=a,a=a.next;l&&(this.Lh=this.aK(this.Lh))}},p.prototype.gN=function(l){if(!(l>=this.rl)){var s=this.Yl[l];if(s!=null){this.Yl[l]=null,s=this.aK(s),this.Vq-=this.bK,l=this.Lh;for(var a=!0,u=s,f=null;l!=null&&u!=null;)l.x>u.x?(a&&(this.Lh=u),a=u.next,u.next=l,f!=null&&(f.next=u),f=u,u=a):(a=l.next,l.next=u,f!=null&&(f.next=l),f=l,l=a),a=!1;this.Lh==null&&(this.Lh=s)}}},p.$J=function(l,s){return 0>l?0:l>s?s:l},p.prototype.UP=function(){if(this.Lh!=null){for(var l=0,s=this.Lh,a=d.P.truncate(d.P.SG(s.x)),u=s.next;u!=null;u=u.next)if(l=this.fF?1^l:l+u.dir,u.x>s.x){var f=d.P.truncate(d.P.SG(u.x));l!=0&&(s=p.$J(a,this.ri),(a=p.$J(f,this.ri))>s&&s<this.ri&&(this.jn[this.Ql++]=s,this.jn[this.Ql++]=a,this.jn[this.Ql++]=u.y,this.Ql==this.jn.length&&(this.qy.bF(this.jn,this.Ql),this.Ql=0))),s=u,a=f}}},p.prototype.aK=function(l){for(var s=0,a=l;a!=null;a=a.next)s++;if(this.bK=s,s==1)return l;this.Lf==null?this.Lf=d.P.mg(Math.max(s,16),null):this.Lf.length<s&&(this.Lf=d.P.mg(Math.max(s,2*this.Lf.length),null));var u=0;for(a=l;a!=null;a=a.next)this.Lf[u++]=a;for(s==2?this.Lf[0].x>this.Lf[1].x&&(l=this.Lf[0],this.Lf[0]=this.Lf[1],this.Lf[1]=l):p.vN(this.Lf,s,function(f,y){return f==y?0:f.x<y.x?-1:f.x>y.x?1:0}),l=this.Lf[0],this.Lf[0]=null,a=l,u=1;u<s;u++)a.next=this.Lf[u],a=this.Lf[u],this.Lf[u]=null;return a.next=null,l},p.vN=function(l,s,a){if(s==l.length)l.sort(a);else{var u=l.slice(0,0),f=l.slice(s);s=l.slice(0,s).sort(a),l.length=0,l.push.apply(l,u.concat(s).concat(f))}},p.Bx=0,p}();d.Ox=S}(Q||(Q={})),function(d){var O=function(){function S(){}return S.prototype.wi=function(p,l){var s=this.g.Qa(p,this.Rq);if(this.Fl==s&&(this.Fl=this.pe.lb(this.Fl)),this.jo==s&&(this.jo=this.pe.lb(this.jo)),this.pe.kd(this.MA,s),this.dk(p),l&&(l=this.g.cd(p))!=-1&&this.g.Ya(l)==p){var a=this.g.V(p);if(a!=p){if((s=this.g.cd(a))==l)return void this.g.Kf(l,a);if((a=this.g.Na(p))!=p&&(s=this.g.cd(a))==l)return void this.g.Kf(l,a)}this.g.Kf(l,-1),this.g.Yg(l,-1)}},S.prototype.kD=function(){for(var p=!1,l=new d.h;;){this.Yh==null?(this.Yh=new d.ja(0),this.Bs=new d.ja(0),this.ye=new d.ja(0)):(this.Yh.clear(!1),this.Bs.clear(!1),this.ye.clear(!1));for(var s=this.jo,a=0,u=!0;s!=this.Fl;){var f=this.pe.getData(s),y=new d.h;this.g.Hc(f,y),u&&(this.g.Hc(f,l),u=!1),y=this.g.Na(f);var v=this.g.V(f);this.g.Qa(y,this.Ag)!=-559038737&&(this.Yh.add(y),this.g.Sa(y,this.Ag,-559038737),this.Bs.add(f),this.ye.add(a++)),this.g.Qa(v,this.Ag)!=-559038737&&(this.Yh.add(v),this.g.Sa(v,this.Ag,-559038737),this.Bs.add(f),this.ye.add(a++)),s=this.pe.lb(s)}if(2>this.Yh.size)break;var _=this;for(this.ye.Wd(0,this.ye.size,function(M,$){return _.kM(M,$)}),s=0,a=this.ye.size;s<a;s++)u=this.ye.get(s),u=this.Yh.get(u),this.g.Sa(u,this.Ag,s),y=new d.h,this.g.Hc(u,y);for(y=this.OM(l),s=0,a=this.ye.size;s<a;s++)(u=this.ye.get(s))!=-1&&(u=this.Yh.get(u),this.g.Sa(u,this.Ag,-1));if(!y)break;p=!0}return p},S.prototype.OM=function(p){for(var l=!1,s=!0;s;){s=!1;var a=0;this.ye.get(a)==-1&&(a=this.em(a));for(var u=this.em(a),f=0,y=this.ye.size;f<y&&a!=-1&&u!=-1&&a!=u;f++){var v=this.ye.get(a);u=this.ye.get(u),v=this.Yh.get(v),u=this.Yh.get(u);var _=this.g.V(v);this.g.Fv(_,p)||(_=this.g.Na(v));var M=this.g.V(u);this.g.Fv(M,p)||(M=this.g.Na(u));var $=this.ru(_,v),T=this.ru(M,u),A=$?this.g.Na(_):this.g.V(_),R=T?this.g.Na(M):this.g.V(M),D=!1;(this.up(_)||this.up(M)||this.up(v)||this.up(u)||this.up(A)||this.up(R))&&(D=!0),!D&&this.g.hq(v,u)&&(D=!0,this.oD($,T,_,v,M,u)),!D&&this.g.hq(A,R)&&(D=!0,this.oD(!$,!T,_,A,M,R)),D&&(l=!0),s=s||D,a=this.em(a),u=this.em(a)}}if(!l)for(a=0,this.ye.get(a)==-1&&(a=this.em(a)),u=this.em(a),f=0,y=this.ye.size;f<y&&a!=-1&&u!=-1&&a!=u;f++)v=this.ye.get(a),u=this.ye.get(u),v=this.Yh.get(v),u=this.Yh.get(u),_=this.g.V(v),this.g.Fv(_,p)||(_=this.g.Na(v)),M=this.g.V(u),this.g.Fv(M,p)||(M=this.g.Na(u)),$=this.ru(_,v),T=this.ru(M,u),A=$?this.g.Na(_):this.g.V(_),R=T?this.g.Na(M):this.g.V(M),this.yM($,T,v,_,A,u,M,R)&&(l=!0),a=this.em(a),u=this.em(a);return l},S.prototype.SM=function(){this.g.jc(this.Y)==1736&&this.g.Kn(this.Y)==1&&new d.Hg().HU(this.hw,this.g,this.Y,this.od);var p=!1,l=!0;this.Ag=this.Rq=-1;var s=this.g.I(this.Y),a=new d.ja(0);a.Jb(s);for(var u=this.g.Ob(this.Y);u!=-1;u=this.g.Sb(u))for(var f=this.g.Ya(u),y=0,v=this.g.Ka(u);y<v;y++)a.add(f),f=this.g.V(f);var _=this.g.ud.o,M=this.g.ud.Mf;this.g.wb.oc();var $=this.g.wb.Aa[0].o;for(a.Wd(0,s,function(A,R){var D=_[M*A],V=_[M*R],Z=$[2*D];D=$[2*D+1];var ee=$[2*V];return(Z=D<(V=$[2*V+1])?-1:D>V?1:Z<ee?-1:Z>ee?1:0)==0&&(Z=(A=_[M*A+3])<(R=_[M*R+3])?-1:A==R?0:1),Z}),this.Rq=this.g.Hd(),this.pe=new d.lp,this.MA=this.pe.Rh(0),this.pe.hn(s),u=0;u<s;u++)f=a.get(u),y=this.pe.addElement(this.MA,f),this.g.Sa(f,this.Rq,y);for(this.Ag=this.g.Hd(),this.Fl=-1,this.YC()&&(p=!0);l;){l=!1,s=0,a=!1;do{a=!1,this.jo=-1,v=0,u=new d.h,y=new d.h;for(var T=this.pe.sc(this.MA);T!=-1;)f=this.pe.getData(T),this.jo!=-1?(this.g.Hc(f,y),u.rb(y)?v++:(u.N(y),this.Fl=T,0<v&&(f=this.kD())&&(a=!0,this.Fl!=-1&&(f=this.pe.getData(this.Fl),this.g.Hc(f,u))),this.jo=T=this.Fl,v=0)):(this.jo=T,this.g.Hc(this.pe.getData(T),u),v=0),T!=-1&&(T=this.pe.lb(T));if(this.Fl=-1,0<v&&(f=this.kD())&&(a=!0),10<s++)throw d.i.Ra();a&&this.BM(),this.YC()&&(a=!0),l=l||a&&!1,p=p||a}while(a)}return this.g.Ud(this.Rq),this.g.Ud(this.Ag),d.RL.W(this.g,this.Y,this.pe,this.hw)||p},S.prototype.ru=function(p,l){return this.g.V(l)!=p},S.prototype.yM=function(p,l,s,a,u,f,y,v){if(a==y)return this.dk(s),this.dk(f),!1;var _=this.g.Qa(s,this.Ag),M=this.g.Qa(u,this.Ag),$=this.g.Qa(f,this.Ag),T=this.g.Qa(v,this.Ag),A=[0,0,0,0];for((s=[0,0,0,0,0,0,0,0])[0]=0,A[0]=_,s[1]=0,A[1]=M,s[2]=1,A[2]=$,s[3]=1,A[3]=T,_=1;4>_;_++){for(M=A[_],$=s[_],T=_-1;0<=T&&A[T]>M;)A[T+1]=A[T],s[T+1]=s[T],T--;A[T+1]=M,s[T+1]=$}return A=0,s[0]!=0&&(A|=1),s[1]!=0&&(A|=2),s[2]!=0&&(A|=4),s[3]!=0&&(A|=8),(A==5||A==10)&&(p==l?p?(this.g.Cc(v,a),this.g.Dc(a,v),this.g.Cc(u,y),this.g.Dc(y,u)):(this.g.Dc(v,a),this.g.Cc(a,v),this.g.Dc(u,y),this.g.Cc(y,u)):p?(this.g.Dc(a,f),this.g.Cc(f,a),this.g.Dc(y,u),this.g.Cc(u,y)):(this.g.Cc(a,f),this.g.Dc(f,a),this.g.Cc(y,u),this.g.Dc(u,y)),!0)},S.prototype.oD=function(p,l,s,a,u,f){this.IY?this.QM():this.PM(p,l,s,a,u,f)},S.prototype.QM=function(){throw d.i.ga("not implemented.")},S.prototype.PM=function(p,l,s,a,u,f){if(p!=l)p?(this.g.Cc(s,u),this.g.Dc(u,s),this.g.Cc(f,a),this.g.Dc(a,f),this.xn(u,s),this.wi(u,!0),this.g.oi(u,!0),this.dk(s),this.xn(f,a),this.wi(f,!0),this.g.oi(f,!1)):(this.g.Cc(u,s),this.g.Dc(s,u),this.g.Cc(a,f),this.g.Dc(f,a),this.xn(u,s),this.wi(u,!0),this.g.oi(u,!1),this.dk(s),this.xn(f,a),this.wi(f,!0),this.g.oi(f,!0)),this.dk(a);else{var y=p?s:a,v=l?u:f;for(p=p?a:s,l=l?f:u,u=!1,this.g.Cc(y,v),this.g.Cc(v,y),this.g.Dc(p,l),this.g.Dc(l,p),f=l;f!=v;)s=this.g.Na(f),a=this.g.V(f),this.g.Dc(f,a),this.g.Cc(f,s),u=u||f==y,f=a;u||(s=this.g.Na(v),a=this.g.V(v),this.g.Dc(v,a),this.g.Cc(v,s)),this.xn(v,y),this.wi(v,!0),this.g.oi(v,!1),this.dk(y),this.xn(l,p),this.wi(l,!0),this.g.oi(l,!1),this.dk(p)}},S.prototype.YC=function(){for(var p=!1,l=this.g.Ob(this.Y);l!=-1;){for(var s=this.g.Ya(l),a=0,u=this.g.Ka(l);a<u&&1<u;){var f=this.g.Na(s),y=this.g.V(s);this.g.hq(f,y)?(p=!0,this.wi(s,!1),this.g.qd(s,!0),this.wi(y,!1),this.g.qd(y,!0),s=f,a=0,u=this.g.Ka(l)):(s=y,a++)}if(2>this.g.Ka(l)){for(p=this.g.Ya(l),a=0,u=this.g.Ka(l);a<u;a++)this.wi(p,!1),p=this.g.V(p);l=this.g.ar(l),p=!0}else l=this.g.Sb(l)}return p},S.prototype.up=function(p){for(var l=!1;;){var s=this.g.V(p),a=this.g.Na(p);if(s==p)return this.wi(p,!0),this.g.oi(p,!1),!0;if(!this.g.hq(s,a)||(l=!0,this.dk(a),this.dk(s),this.wi(p,!0),this.g.oi(p,!1),this.xn(s,a),this.wi(s,!0),this.g.oi(s,!0),s==a))break;p=a}return l},S.prototype.BM=function(){for(var p=0,l=this.pe.sc(this.pe.ke);l!=-1;l=this.pe.lb(l)){var s=this.pe.getData(l);this.g.cj(s,-1)}for(var a=0,u=this.g.Ob(this.Y);u!=-1;)if((l=this.g.Ya(u))==-1||this.g.cd(l)!=-1)s=u,u=this.g.Sb(u),this.g.br(s);else{this.g.cj(l,u);var f=1;for(s=this.g.V(l);s!=l;s=this.g.V(s))this.g.cj(s,u),f++;this.g.fp(u,!1),this.g.Xj(u,f),this.g.Yg(u,this.g.Na(l)),a+=f,p++,u=this.g.Sb(u)}for(l=this.pe.sc(this.pe.ke);l!=-1;l=this.pe.lb(l))s=this.pe.getData(l),this.g.cd(s)==-1&&(u=this.g.iG(this.Y,s,s,null),a+=this.g.Ka(u),p++);for(this.g.Tl(this.Y,p),this.g.Vj(this.Y,a),p=0,a=this.g.md;a!=-1;a=this.g.ve(a))p+=this.g.I(a);this.g.XB(p)},S.prototype.em=function(p){for(var l=0,s=this.ye.size-1;l<s;l++)if(p=(p+1)%this.ye.size,this.ye.get(p)!=-1)return p;return-1},S.prototype.xn=function(p,l){var s=this.g.Qa(l,this.Rq),a=this.g.Qa(l,this.Ag);this.g.gC(p,l),this.g.Sa(l,this.Rq,s),this.g.Sa(l,this.Ag,a)},S.prototype.dk=function(p){var l=this.g.Qa(p,this.Ag);l!=-1&&(this.ye.set(l,-1),this.g.Sa(p,this.Ag,-1))},S.W=function(p,l,s,a,u){var f=new S;return f.g=p,f.Y=l,f.sA=s,f.hw=a,f.od=u,f.SM()},S.prototype.kM=function(p,l){var s=this.Yh.get(p),a=new d.h;this.g.Hc(s,a),s=new d.h;var u=this.Yh.get(l);return this.g.Hc(u,s),a.rb(s)?0:(u=this.Bs.get(p),p=new d.h,this.g.Hc(u,p),u=this.Bs.get(l),l=new d.h,this.g.Hc(u,l),(u=new d.h).vc(a,p),(a=new d.h).vc(s,l),d.h.pu(u,a))},S}();d.tn=O}(Q||(Q={})),function(d){var O;(O=d.VL||(d.VL={}))[O.Local=0]="Local",O[O.Geographic=1]="Geographic",O[O.Projected=2]="Projected",O[O.Image=3]="Image",O[O.Unknown=4]="Unknown",function(p){p[p.Integer32=0]="Integer32",p[p.Integer64=1]="Integer64",p[p.FloatingPoint=2]="FloatingPoint"}(d.OL||(d.OL={}));var S=function(){function p(){this.hA=null,this.rp="",this.uu=null,this.fg=0,this.UH=this.Jo=-1,this.yh=null}return p.prototype.Fc=function(){return this.fg},p.prototype.QF=function(){return 1},p.prototype.QW=function(l){this.hA=l},p.prototype.Yd=function(){if(this.hA!==null)return this.hA;var l=.001;return this.fg!=0?l=d.yr.xQ(this.fg):this.yh!=null&&(l=d.SC.yQ(this.yh)),l},p.prototype.wz=function(){return this.yh},p.prototype.Id=function(){return this.fg!=0?d.Uc.ah(d.yr.Ny(this.fg)):this.yh!=null?d.SC.zQ(this.yh):void 0},p.Tb=function(l){if(l.fg!=0){if(d.yr.US(l.fg)===!0)return 1;if(d.yr.WS(l.fg)===!0)return 2}return 4},p.prototype.cs=function(){var l=this.Fc();return this.Jo!=-1?this.Jo:(this.Jo=d.yr.AK(l),this.Jo!=-1?this.Jo:l)},p.create=function(l){if(0>=l)throw d.i.O("Invalid or unsupported wkid: "+l);var s=new p;return s.fg=l,s},p.lP=function(l){if(l==null||l.length==0)throw d.i.O("Cannot create SpatialReference from null or empty text.");var s=new p;return s.yh=l,s},p.prototype.Nb=function(l){return this==l||l!=null&&this.constructor==l.constructor&&this.fg==l.fg&&(this.fg!=0||this.yh===l.yh)},p.prototype.toString=function(){return"[ tol: "+this.Mn()+"; wkid: "+this.Fc()+"; wkt: "+this.wz()+"]"},p.prototype.dc=function(){if(this.rp!=="")return this.rp;var l=this.toString();if(Array.prototype.reduce)return this.rp="S"+l.split("").reduce(function(u,f){return(u=(u<<5)-u+f.charCodeAt(0))&u},0);var s=0;if(l.length===0)return"";for(var a=0;a<l.length;a++)s=(s<<5)-s+l.charCodeAt(a),s&=s;return this.rp="S"+s},p.prototype.Mn=function(){return this.Yd(0)},p.prototype.hh=function(){return this.uu!==null?this.uu:this.uu=d.iu.tP(this)},p.UN=2147483645,p.VN=9007199254740990,p}();d.Gg=S}(Q||(Q={})),function(d){var O=function(S){function p(){var l=S!==null&&S.apply(this,arguments)||this;return l.Li=null,l.NT=null,l.Jq=new d.UL,l.Go=null,l.lw=null,l}return Pe(p,S),p.tP=function(l){var s=new p;if(s.fg=l.fg,s.Jo=l.Jo,s.UH=l.UH,s.yh=l.yh,s.yh!==""&&s.yh!==null){l=p.fM(s.yh);var a=p.dM(s.yh);s.Jq.Wx(l,a,d.ju.Integer64),s.ay(l),s.cy(a),s.fg=l.cs()}else l=p.eM(s.fg),s.ay(l),s.cy(null),s.Jq.Wx(l,null,d.ju.Integer64);return s},p.prototype.Yd=function(l){return this.Jq.Mn(l)},p.dM=function(l){if(0>=l.length)throw d.i.O();var s=null;try{s=d.IC.fromString(l)}catch{s=null}return s==null?null:p.XC(s,!0)},p.prototype.ay=function(l){this.Ld=l,this.Go=this.Ld.Id()},p.prototype.cy=function(l){this.FH=l,this.NT=this.FH!=null?this.FH.Go:null},p.prototype.Xc=function(){return this.Tb()!=0&&this.Tb()!=3&&this.Ld.Xc()},p.prototype.DG=function(){return this.Tb()!=0&&(this.Tb()==3?this.Li.hk().Xc():this.Ld.Xc())},p.prototype.gh=function(){return this.Ld!=null?this.Ld.Re:null},p.prototype.rm=function(){return this.Ld.rm()},p.prototype.bf=function(){return this.Ld.bf()},p.prototype.jh=function(){return this.Ld!=null?this.Ld.uw:NaN},p.prototype.Wp=function(){return this.Ld.Wp()},p.prototype.Yr=function(){return this.Ld.Yr()},p.prototype.mk=function(){return this.Ld.mk()},p.prototype.fS=function(l){return d.JC.Ky(this.Ld,l.Ld)},p.prototype.ol=function(){return this.Ld.ol()},p.prototype.Xr=function(){return this.Ld.Xr()},p.prototype.Bi=function(){return this.Tb()==3?this.Li.hk().Bi():this.Ld.Bi()},p.prototype.ih=function(){if(!this.Xc())throw d.i.O("!isPannable()");var l=new d.l;return this.Ld.ih(l),l},p.prototype.Le=function(){if(!this.Xc())throw d.i.O("!isPannable()");return this.Ld.uo},p.prototype.CR=function(){if(!this.Xc())throw d.i.O("!isPannable()");var l=new d.l;return this.Ld.BR(l),l},p.prototype.rv=function(){if(!this.Xc())throw d.i.O("!isPannable()");return this.Ld.rv()},p.prototype.qv=function(){if(!this.Xc())throw d.i.O("!isPannable()");return this.Ld.qv()},p.prototype.Zr=function(){return this.Li!=null?this.Li.hk().Zr():this.Ld.Zr()},p.prototype.KQ=function(){return this.Ld.kv()},p.prototype.Sp=function(){return this.Go.getUnitFactor()},p.prototype.pz=function(l){return this.Jq.pz(l)},p.prototype.tc=function(){var l=this.Tb();if(l==1)return this;if(l==3)return this.Li.hk().tc();if(l==0||l===4)throw d.i.ga("invalid call");if(this.lw!==null)return this.lw;if((l=this.gh().getGeogcs())==null)throw d.i.Ra();return this.lw=p.XE(l,this.Jq.QF())},p.XE=function(l,s){if(l==null)throw d.i.O("null pointer.");var a=new p;return l=p.ou(l,!0),a.Jq.Wx(l,null,s),a.ay(l),a.cy(null),a.fg=l.cs(),a},p.prototype.Tb=function(){var l=this.gh();if(l!=null)switch(l.getType()){case d.Tc.PE_TYPE_GEOGCS:return 1;case d.Tc.PE_TYPE_PROJCS:return 2}return 4},p.prototype.kv=function(){return this.Ld.kv()},p.ou=function(l,s){var a=l.getCode();if(0>=a&&0<(a=d.qf.getCode(l))){if((l=d.qf.coordsys(a))==null)throw d.i.O("Text to wkid mapping had failed: "+a);return p.ou(l,s)}if(s&&0<a&&(s=p.qx[a]))return s;s=d.Ab.zv(l,a,!1);var u=p.gK[s];return u||(l=0>=a?l:d.qf.coordsys(a),l=new d.JC(l),p.gK[s]=l,0<a&&(p.qx[a]=l),l)},p.eM=function(l){if(0>=l)throw d.i.O("Invalid or unsupported wkid: "+l);var s=p.qx[l];if(s!=null)return s;if((s=d.qf.coordsys(l))==null)throw d.i.O("Invalid or unsupported wkid: "+l);return(s=p.ou(s,!1)).cs()!=l&&(p.qx[l]=s),s},p.fM=function(l){if(l==null||l===void 0||l.length==0)throw d.i.O("Cannot create SpatialReference from null or empty text.");var s=null;try{s=d.qf.fromString(d.Tc.PE_TYPE_COORDSYS,l)}catch(a){throw d.i.O("Cannot create SpatialReference from text. "+a.message)}if(s===null)throw d.i.O("Cannot create SpatialReference from text. ");return p.ou(s,!0)},p.XC=function(l,s){var a,u=l.getCode();if(0>=u&&0<(u=d.qf.getCode(l))){if((u=d.qf.vertcs(u))===null)throw d.i.O();return p.XC(u,s)}if(s&&0<u&&(s=p.fK[u])||(l=d.Ab.zv(l,u,!1),s=p.hK[l]))return s;if(0>=u||(a=d.qf.vertcs(u)),a===null)throw d.i.O();return a=new d.KL(a),p.hK[l]=a,0<u&&(p.fK[u]=a),a},p.nI=function(l,s){if(s===null||s.B())return null;var a=new d.l;if(s!==null&&l.Tb()!=1){var u=l.tc(),f=u.gh();l=d.xr.Pr(l,u,null,null),(s=d.Gx.local().W(s,l,null)).A(a)}else f=l.gh(),s.A(a);return s=f.getPrimem().getLongitude(),f=f.getUnit().getUnitFactor(),new d.GC(a.v,a.G,a.C,a.H,s,f)},p.gD=function(l){var s={name:"",steps:[],_pt:null,_entry:null},a=0;for(l=l.getEntries();a<l.length;a++){var u=l[a],f={HY:!1,VY:"",UY:-1,geogtran:null};u.getDirection()===0?f.isInverse=!1:f.isInverse=!0;var y=u.getGeogtran().getCode();-1<y?f.wkid=y:f.wkt=u.getGeogtran().toString(),s.steps.push(f)}return s},p.SR=function(l,s,a,u){return a===void 0&&(a=null),a=p.nI(u,a),l=d.np.getGTlist(l.gh(),s.gh(),2,d.np.PE_GTLIST_OPTS_COMMON,a,1),s=null,l&&0<l.length&&(s=this.gD(l[0]),d.Lx.destroy(l)),a!==null&&a.destroy(),s},p.TR=function(l,s,a,u){var f;if(a===void 0&&(a=null),u===void 0&&(u=null),f===void 0&&(f=30),a=p.nI(u,a),l=d.np.getGTlist(l.gh(),s.gh(),2,d.np.PE_GTLIST_OPTS_COMMON,a,f),s=[],l&&0<l.length){for(f=0;f<l.length;f++)s.push(this.gD(l[f]));d.Lx.destroy(l)}return a!==null&&a.destroy(),s},p.qx={},p.gK={},p.fK={},p.hK={},p}(d.Gg);d.iu=O}(Q||(Q={})),function(d){var O,S;(S=O=d.ju||(d.ju={}))[S.Integer32=0]="Integer32",S[S.Integer64=1]="Integer64",S[S.FloatingPoint=2]="FloatingPoint";var p=function(){function l(){this.sp()}return l.prototype.assign=function(s){this.Hm=s.Hm,this.Im=s.Im,this.Rj=s.Rj,this.nA=s.nA,this.Ho=s.Ho,this.mA=s.mA,this.Kk=s.Kk,this.Oq=s.Oq,this.Nq=s.Nq,this.Tm=s.Tm},l.prototype.QF=function(){return this.Tm},l.prototype.sp=function(){this.Im=this.Hm=0,this.Rj=1,this.nA=0,this.Ho=1,this.mA=0,this.Nq=this.Oq=this.Kk=2220446049250313e-29,this.Tm=O.FloatingPoint},l.prototype.Wx=function(s,a,u){if(this.sp(),this.Tm=u,u!=O.FloatingPoint){var f=new d.l;s.cR(f),this.Hm=f.v,this.Im=f.G}else this.Im=this.Hm=-17976931348623157e292;(f=s.Re.getType())==d.Tc.PE_TYPE_GEOGCS?(f=(u==O.Integer64?1e-9:1/18e5)*s.bf(),this.Rj=1/f):f==d.Tc.PE_TYPE_PROJCS&&(f=(u==O.Integer64?1e-4:.001)*s.rm(),this.Rj=1/f),a!=null?(f=(u==O.Integer32?.001:1e-4)*a.DH,this.Ho=1/f):this.Ho=1e4,this.TM(),this.Kk=s.uw,this.Oq=a!=null?.001*a.DH:.001,this.Nq=2220446049250313e-29},l.prototype.TM=function(){if(this.Tm!=O.FloatingPoint){var s=this.Tm==O.Integer64?d.Gg.VN:d.Gg.UN,a=s/this.Rj,u=this.Hm+a,f=d.P.truncate((u-this.Hm)*this.Rj);f>s&&(this.Rj=s/(u-this.Hm)),a=this.Im+a,(f=d.P.truncate((a-this.Im)*this.Rj))>s&&(this.Rj=s/(a-this.Im))}},l.prototype.WB=function(s){switch(s){case 0:this.Kk=void 0;case 1:this.Oq=void 0;case 2:this.Nq=void 0}},l.prototype.Mn=function(s){switch(s){case 0:return this.Kk;case 1:return this.Oq;case 2:return this.Nq}return 0},l.prototype.pz=function(s){if(this.Tm==O.FloatingPoint)return 0;switch(s){case 0:return 1/this.Rj;case 1:case 2:return 1/this.Ho;default:return 0}},l.prototype.toString=function(){var s="SRPD [m_toleranceXY: "+this.Kk.toString();return(s=(s=(s=(s=(s=(s=(s=(s=(s=s+";m_falseX: "+this.Hm.toString())+";m_falseY: "+this.Im.toString())+";m_unitsXY: "+this.Rj.toString())+";m_falseZ: "+this.nA.toString())+";m_unitsZ: "+this.Ho.toString())+";m_falseM: "+this.mA.toString())+";m_toleranceZ: "+this.Oq.toString())+";m_toleranceM: "+this.Nq.toString())+";m_precision: "+this.Tm.toString())+"] "},l}();d.UL=p}(Q||(Q={})),function(d){function O(u,f){return 89.99999<f?f=89.99999:-89.99999>f&&(f=-89.99999),f*=.017453292519943,[111319.49079327169*u,31890685e-1*Math.log((1+Math.sin(f))/(1-Math.sin(f)))]}function S(u,f,y){return u=u/6378137*57.29577951308232,y?[u,57.29577951308232*(1.5707963267948966-2*Math.atan(Math.exp(-1*f/6378137)))]:[u-360*Math.floor((u+180)/360),57.29577951308232*(1.5707963267948966-2*Math.atan(Math.exp(-1*f/6378137)))]}function p(u,f,y){var v=u.Qf();if(u.K()===33)f=f(v.Ng(),v.kh()),v.Db(f[0],f[1]);else if(u.K()===197){var _=f(u.gs(),u.js(),y);f=f(u.fs(),u.hs(),y),v.L(_[0],_[1],f[0],f[1])}else for(_=new d.h,u=0;u<v.I();u++){v.D(u,_);var M=f(_.x,_.y,y);_.na(M[0],M[1]),v.Db(u,_)}return v}function l(u){return p(u,S,!0)}function s(u){return p(u,O,!0)}var a=Math.PI/180;d.PK=function(){function u(){}return u.xu=function(f){var y=Math.sqrt(.006694379990197414),v=Math.sin(f.y*a);return d.h.construct(6378137*f.x*a,3.1677196636462314e6*(v/(1-.006694379990197414*v*v)-1/(2*y)*Math.log((1-y*v)/(1+y*v))))},u.Ux=function(f,y,v,_){var M=1/298.257223563,$=Math.sin(v);v=Math.cos(v);var T=(1-M)*Math.tan(f),A=T*(f=1/Math.sqrt(1+T*T)),R=Math.atan2(T,v),D=(T=f*$)*T,V=1-D,Z=27233160610754688e-5*V/4040829998466145e-2,ee=1+Z/16384*(4096+Z*(Z*(320-175*Z)-768)),G=Z/1024*(256+Z*(Z*(74-47*Z)-128));Z=_/(635675231424518e-8*ee);for(var re,oe,se,ge=2*Math.PI;1e-12<Math.abs(Z-ge);)se=Math.cos(2*R+Z),ge=Z,Z=_/(635675231424518e-8*ee)+G*(re=Math.sin(Z))*(se+G/4*((oe=Math.cos(Z))*(2*se*se-1)-G/6*se*(4*re*re-3)*(4*se*se-3)));return _=A*re-f*oe*v,V=M/16*V*(4+M*(4-3*V)),d.h.construct((y+(Math.atan2(re*$,f*oe-A*re*v)-(1-V)*M*T*(Z+V*re*(se+V*oe*(2*se*se-1)))))/a,Math.atan2(A*oe+f*re*v,(1-M)*Math.sqrt(D+_*_))/a)},u.HM=function(f,y,v,_){var M=1/298.257223563,$=_-y,T=Math.atan((1-M)*Math.tan(f)),A=Math.atan((1-M)*Math.tan(v)),R=Math.sin(T);T=Math.cos(T);var D=Math.sin(A);A=Math.cos(A);var V=$,Z=1e3;do{var ee=Math.sin(V),G=Math.cos(V),re=Math.sqrt(A*ee*A*ee+(T*D-R*A*G)*(T*D-R*A*G));if(re===0)return 0;G=R*D+T*A*G;var oe=Math.atan2(re,G),se=T*A*ee/re,ge=1-se*se;ee=G-2*R*D/ge,isNaN(ee)&&(ee=0);var me=M/16*ge*(4+M*(4-3*ge)),Ie=V;V=$+(1-me)*M*se*(oe+me*re*(ee+me*G*(2*ee*ee-1)))}while(1e-12<Math.abs(V-Ie)&&0<--Z);return Z===0?(R=_-y,{azimuth:Math.atan2(Math.sin(R)*Math.cos(v),Math.cos(f)*Math.sin(v)-Math.sin(f)*Math.cos(v)*Math.cos(R)),geodesicDistance:6371008771415059e-9*Math.acos(Math.sin(f)*Math.sin(v)+Math.cos(f)*Math.cos(v)*Math.cos(_-y))}):(y=(f=27233160610754688e-5*ge/4040829998466145e-2)/1024*(256+f*(f*(74-47*f)-128)),{azimuth:Math.atan2(A*Math.sin(V),T*D-R*A*Math.cos(V)),TQ:635675231424518e-8*(1+f/16384*(4096+f*(f*(320-175*f)-768)))*(oe-y*re*(ee+y/4*(G*(2*ee*ee-1)-y/6*ee*(4*re*re-3)*(4*ee*ee-3)))),TY:Math.atan2(T*Math.sin(V),T*D*Math.cos(V)-R*A)})},u.eQ=function(f){var y=f.hasAttribute(1),v=f.hasAttribute(2),_=[],M=f.ea(),$=null,T=null;y&&($=f.vb(1)),v&&(T=f.vb(2));for(var A=new d.h,R=0;R<M;R++){for(var D=f.Ca(R),V=f.Ka(R),Z=0,ee=0,G=NaN,re=NaN,oe=NaN,se=NaN,ge=f.ec(R),me=[],Ie=D;Ie<D+V;Ie++){f.D(Ie,A),se=oe=NaN;var De=[A.x,A.y];y&&(oe=$.get(Ie),De.push(oe)),v&&(M=T.get(Ie),De.push(se)),Ie==D&&ge&&(Z=A.x,ee=A.y,G=oe,re=se),me.push(De)}!ge||Z==A.x&&ee==A.y&&(!y||isNaN(G)&&isNaN(oe)||G==oe)&&(!v||isNaN(re)&&isNaN(se)||re==se)||me.push(me[0].slice(0)),_.push(me)}return _},u.Ry=function(f,y){f=u.eQ(f),637.100877141506>y&&(y=637.100877141506);for(var v,_=[],M=0;M<f.length;M++){var $,T,A=f[M];_.push(v=[]),v.push([A[0][0],A[0][1]]);var R=A[0][0]*a,D=A[0][1]*a;for($=0;$<A.length-1;$++){var V=A[$+1][0]*a,Z=A[$+1][1]*a;if(R!==V||D!==Z){V=(Z=u.HM(D,R,Z,V)).azimuth;var ee=(Z=Z.TQ)/y;if(1<ee){for(T=1;T<=ee-1;T++){var G=u.Ux(D,R,V,T*y);v.push([G.x,G.y])}T=u.Ux(D,R,V,(Z+Math.floor(ee-1)*y)/2),v.push([T.x,T.y])}D=u.Ux(D,R,V,Z),v.push([D.x,D.y]),R=D.x*a,D=D.y*a}}}return{lJ:_}},u.SQ=function(f){for(var y=[],v=0;v<f.length;v++){var _=f[v];_=u.Ry(_,1e4),y.push(_)}f=[];for(var M=0;M<y.length;M++){_=y[M];var $=0;for(v=0;v<_.lJ.length;v++){var T,A=_.lJ[v],R=u.xu(d.h.construct(A[0][0],A[0][1])),D=u.xu(d.h.construct(A[A.length-1][0],A[A.length-1][1])),V=D.x*R.y-R.x*D.y;for(T=0;T<A.length-1;T++)R=u.xu(d.h.construct(A[T+1][0],A[T+1][1])),V+=(D=u.xu(d.h.construct(A[T][0],A[T][1]))).x*R.y-R.x*D.y;$+=V}$/=1,f.push($/-2)}return f},u}(),d.cb=function(){function u(){}return u.sB=function(f,y,v,_,M,$,T){u.bD[f.dc()]=y,isNaN(v)==0&&(u.hD[f.dc()]=v),isNaN(_)==0&&(u.uD[f.dc()]=_),isNaN(M)==0&&(u.WC[f.dc()]=M),u.iD[f.dc()]=$,T!==null&&(u.jD[f.dc()]=T)},u.Yw=function(f,y,v){u.nD[f.dc()+"-"+y.dc()]=v},u.tc=function(f){if((f=u.bD[f.dc()])==null)throw d.i.Fe();return f},u.bf=function(f){if((f=u.hD[f.dc()])==null)throw d.i.Fe();return f},u.xv=function(f){if((f=u.uD[f.dc()])==null)throw d.i.Fe();return f},u.gv=function(f){if((f=u.WC[f.dc()])==null)throw d.i.Fe();return f},u.ih=function(f){if((f=u.jD[f.dc()])==null)throw d.i.Fe();return d.l.construct(f[0],f[1],f[2],f[3])},u.Xc=function(f){if((f=u.iD[f.dc()])==null)throw d.i.Fe();return f},u.Bh=function(f,y,v){if(y.Nb(v))return f;var _=u.nD[y.dc()+"-"+v.dc()];if(_!==void 0)return _(f,y,v);throw d.i.Fe()},u.wt=function(){throw d.i.Fe()},u.XQ=function(){throw d.i.Fe()},u.ZV=function(){throw d.i.Fe()},u.ol=function(){throw d.i.Fe()},u.nW=function(){var f=d.Gg.create(102100),y=d.Gg.create(3857),v=d.Gg.create(4326);d.cb.sB(f,v,NaN,NaN,NaN,!1,null),d.cb.sB(v,v,1,.0033528106647474805,6378137,!0,[-180,-90,180,90]),d.cb.sB(y,v,NaN,NaN,NaN,!1,null),d.cb.Yw(f,v,l),d.cb.Yw(v,f,s),d.cb.Yw(y,v,l),d.cb.Yw(v,y,s)},u.bD=[],u.hD=[],u.uD=[],u.WC=[],u.iD=[],u.jD=[],u.nD=[],u}()}(Q||(Q={})),Q.cb.nW(),function(d){var O=function(){function S(p){this.o=new Int32Array(0),this.ko=-1,this.Jg=this.size=this.Dl=0,this.Mf=p}return S.prototype.kd=function(p){p<this.Dl?(this.o[p*this.Mf]=this.ko,this.ko=p):this.Dl--,this.size--},S.prototype.U=function(p,l){return this.o[p*this.Mf+l]},S.prototype.T=function(p,l,s){this.o[p*this.Mf+l]=s},S.prototype.De=function(){var p=this.ko;if(p==-1){if(this.Dl==this.Jg){if(2147483647<(p=this.Jg!=0?d.P.truncate(3*(this.Jg+1)/2):1)&&(p=2147483647),p==this.Jg)throw d.i.de();this.yz(p)}p=this.Dl,this.Dl++}else this.ko=this.o[p*this.Mf];this.size++;for(var l=p*this.Mf;l<p*this.Mf+this.Mf;l++)this.o[l]=-1;return p},S.prototype.Nl=function(p){var l=this.ko;if(l==-1){if(this.Dl==this.Jg){if(2147483647<(l=this.Jg!=0?d.P.truncate(3*(this.Jg+1)/2):1)&&(l=2147483647),l==this.Jg)throw d.i.de();this.yz(l)}l=this.Dl,this.Dl++}else this.ko=this.o[l*this.Mf];this.size++;for(var s=l*this.Mf,a=0;a<p.length;a++)this.o[s+a]=p[a];return l},S.prototype.oj=function(p){this.ko=-1,this.size=this.Dl=0,p&&(this.o=null,this.Jg=0)},S.prototype.Ee=function(p){p>this.Jg&&this.yz(p)},S.prototype.sx=function(p,l){p*=this.Mf,l*=this.Mf;for(var s=0;s<this.Mf;s++){var a=this.o[l+s];this.o[l+s]=this.o[p+s],this.o[p+s]=a}},S.prototype.bC=function(p,l,s){var a=this.o[this.Mf*l+s];this.o[this.Mf*l+s]=this.o[this.Mf*p+s],this.o[this.Mf*p+s]=a},S.GG=function(p){return 0<=p},S.prototype.yz=function(p){this.o==null&&(this.o=new Int32Array(0));var l=new Int32Array(this.Mf*p);l.set(this.o,0),this.o=l,this.Jg=p},S}();d.ad=O}(Q||(Q={})),function(d){var O,S;(S=O||(O={}))[S.enumInputModeBuildGraph=0]="enumInputModeBuildGraph",S[S.enumInputModeSimplifyAlternate=4]="enumInputModeSimplifyAlternate",S[S.enumInputModeSimplifyWinding=5]="enumInputModeSimplifyWinding",S[S.enumInputModeIsSimplePolygon=7]="enumInputModeIsSimplePolygon";var p=function(){function s(a){this.Ce=a,this.Ah=NaN,this.$G=new d.jg,this.aH=new d.jg,this.os=new d.Oc,this.ps=new d.Oc}return s.prototype.compare=function(a,u,f){if(a=a.ka(f),this.Ce.kB(u,this.$G),this.Ce.kB(a,this.aH),u=this.$G.get(),a=this.aH.get(),this.os.L(u.ta,u.qa),this.ps.L(a.ta,a.qa),this.os.wa<this.ps.pa)return-1;if(this.os.pa>this.ps.wa)return 1;f=u.oa==u.ma;var y=a.oa==a.ma;if(f||y){if(f&&y)return 0;if(u.oa==a.oa&&u.ta==a.ta)return f?1:-1;if(u.ma==a.ma&&u.qa==a.qa)return f?-1:1}return(f=u.Me(this.Ah,this.os.pa))==(y=a.Me(this.Ah,this.ps.pa))&&((y=.5*((f=Math.min(u.ma,a.ma))+this.Ah))==this.Ah&&(y=f),f=u.Me(y,this.os.pa),y=a.Me(y,this.ps.pa)),f<y?-1:f>y?1:0},s.prototype.WJ=function(a){this.Ah=a},s}(),l=function(){function s(a){this.ib=a,this.RH=new d.jg,this.Cf=new d.h,this.rA=new d.Oc}return s.prototype.fX=function(a){this.Cf.N(a)},s.prototype.compare=function(a,u){return this.ib.kB(a.ka(u),this.RH),a=this.RH.get(),this.rA.L(a.ta,a.qa),this.Cf.x<this.rA.pa?-1:this.Cf.x>this.rA.wa?1:(a=a.Me(this.Cf.y,this.Cf.x),this.Cf.x<a?-1:this.Cf.x>a?1:0)},s}();O=function(){function s(){this.cH=this.Fi=this.Ii=this.fA=this.$n=this.ze=this.Lc=this.lh=this.he=null,this.Io=this.yg=-1,this.bH=!0,this.kA=!1,this.gA=NaN,this.Pi=new d.Nd,this.XN=2147483647,this.WN=d.P.truncate(-2147483648),this.eg=this.be=this.Jl=this.Eq=this.Em=this.Dq=this.Qs=this.Oe=-1,this.xa=0}return s.prototype.ty=function(a){this.gA=a},s.prototype.$m=function(){this.he==null&&(this.he=new d.ad(8));var a=this.he.De();return this.he.T(a,1,0),a},s.prototype.qU=function(){this.Lc==null&&(this.Lc=new d.ad(8));var a=this.Lc.De();this.Lc.T(a,2,0),this.Lc.T(a,3,0);var u=this.Lc.De();return this.Lc.T(u,2,0),this.Lc.T(u,3,0),this.EJ(a,u),this.EJ(u,a),a},s.prototype.hI=function(){this.ze==null&&(this.ze=new d.ad(8));var a=this.ze.De();return this.ze.T(a,2,0),a},s.prototype.OW=function(a,u){this.he.T(a,7,u)},s.prototype.on=function(a,u){this.he.T(a,2,u)},s.prototype.NW=function(a,u){this.he.T(a,1,u)},s.prototype.gX=function(a,u){this.he.T(a,3,u)},s.prototype.dX=function(a,u){this.he.T(a,4,u)},s.prototype.er=function(a,u){this.he.T(a,5,u)},s.prototype.$Q=function(a){return this.he.U(a,5)},s.prototype.MW=function(a,u){this.he.T(a,6,u)},s.prototype.YM=function(a,u){this.MW(u,a)},s.prototype.DJ=function(a,u){this.Lc.T(a,1,u)},s.prototype.EJ=function(a,u){this.Lc.T(a,4,u)},s.prototype.Vl=function(a,u){this.Lc.T(a,5,u)},s.prototype.Ul=function(a,u){this.Lc.T(a,6,u)},s.prototype.VW=function(a,u){this.Lc.T(a,2,u)},s.prototype.cx=function(a,u){this.Lc.T(a,3,u)},s.prototype.GF=function(a){return this.Lc.U(a,3)},s.prototype.Ht=function(a,u){this.Lc.T(a,7,u)},s.prototype.zK=function(a,u){if(this.om(a)!=-1)for(u=u?-1:a,a=this.om(a);a!=-1;a=this.ls(a))this.g.Sa(this.vj(a),this.Eq,u)},s.prototype.xx=function(a,u){a!=-1&&(this.zK(a,u),this.zK(this.ya(a),u))},s.prototype.Et=function(a,u){this.ze.T(a,1,u)},s.prototype.Xg=function(a,u){this.ze.T(a,2,u)},s.prototype.ln=function(a,u){this.ze.T(a,3,u),this.IW(a,this.ZQ(u)),this.HW(u,a)},s.prototype.HW=function(a,u){this.ze.T(a,4,u)},s.prototype.IW=function(a,u){this.ze.T(a,5,u)},s.prototype.yJ=function(a,u){this.ze.T(a,6,u)},s.prototype.wJ=function(a,u){this.ze.T(a,7,u)},s.prototype.vJ=function(a,u){this.$n.write(a,u)},s.prototype.xJ=function(a,u){this.fA.write(a,u)},s.prototype.gY=function(a){var u=0,f=0,y=this.vF(a),v=new d.h,_=new d.h,M=new d.h;this.$r(y,v),_.N(v);var $=y;do this.nm($,M),f+=d.h.ub(_,M),this.$e(this.ya($))!=a&&(u+=(M.x-v.x-(_.x-v.x))*(M.y-v.y+(_.y-v.y))*.5),_.N(M),$=this.kc($);while($!=y);this.$n.write(a,u),this.fA.write(a,f)},s.prototype.KU=function(a,u){var f=new p(this),y=new d.$j;y.Ee(d.P.truncate(this.xa/2)),y.Xo(f);for(var v=new d.ja(0),_=this.bh(),M=null,$=0,T=new d.h,A=this.Oe;A!=-1;A=this.Tf(A)){if((255&++$)==0&&u!=null&&!u.progress(-1,-1))throw d.i.RC();var R=this.Je(A);if(R!=-1){if(v.Dh(0),!this.cY(y,_,v,R)){this.D(A,T),f.WJ(T.y);var D=R;do{var V=this.Bb(D,_);V!=-1&&(y.wd(V,-1),this.Kb(D,_,-2)),D=this.kc(this.ya(D))}while(R!=D);D=R;do(V=this.Bb(D,_))==-1&&(V=y.addElement(D,-1),v.add(V)),D=this.kc(this.ya(D));while(R!=D)}for(R=v.size-1;0<=R;R--)V=v.get(R),D=y.ka(V),this.Kb(this.ya(D),_,V),this.JU(y,V,a)}else this.Yy(A)==-1&&(M==null&&(M=new l(this)),this.D(A,T),M.fX(T),D=y.DW(M),R=this.Jl,D!=-1&&(V=y.ka(D),this.$e(V)==this.$e(this.ya(V))&&(V=this.JF(y,D)),V!=-1&&(R=this.$e(V))),this.YM(R,A))}this.Lg(_)},s.prototype.JU=function(a,u,f){var y=a.ka(u),v=this.$e(y);if(this.In(v)==-1){var _=this.JF(a,u),M=this.ya(y),$=this.$e(M);this.Mp(v),this.Mp($);var T=this.In(v),A=this.In($);if(_==-1&&T==-1&&($==v?(this.ln($,this.Jl),T=A=this.Jl):(A==-1&&(this.ln($,this.Jl),A=this.Jl),this.ln(v,$),T=$)),_!=-1){var R=this.$e(_);A==-1&&(0>=this.Mp(R)?(A=this.In(R),this.ln($,A)):(this.ln($,R),A=R),$==v&&(T=A))}T==-1&&this.dY(v,$),f==0?this.eW(a,u,y,_,v,$):f==5?this.fW(a,u,y,M,v,$):f==4&&this.dW(y,_,v,$)}},s.prototype.eW=function(a,u,f,y,v,_){var M=this.jk(v);if(y!=-1){var $=this.jk(_),T=this.jk(this.$e(y));y=M&$&T,T^=T&this.fh(f),(T|=y)!=0&&(this.Xg(_,$|T),this.Xg(v,T|M),M=M||T)}for(u=a.lb(u);u!=-1&&(y=a.ka(u),f=this.$e(this.ya(y)),v=this.jk(f),_=this.fh(y),$=this.$e(y),y=v&(T=this.jk($))&M,M^=M&_,(M|=y)!=0);u=a.lb(u))this.Xg(f,v|M),this.Xg($,T|M)},s.prototype.fW=function(a,u,f,y,v,_){if(v!=_){f=this.Bb(f,this.eg),f+=this.Bb(y,this.eg),y=0;var M=new d.ja(0),$=new d.ja(0);$.add(0);for(var T=a.sc(-1);T!=u;T=a.lb(T)){var A=a.ka(T),R=this.ya(A),D=this.$e(A),V=this.$e(R);if(D!=V){if(A=this.Bb(A,this.eg),y+=A+=this.Bb(R,this.eg),R=!1,M.size!=0&&M.Gc()==V&&($.Jf(),M.Jf(),R=!0),this.In(V)==-1)throw d.i.Ra();R&&this.In(V)==D||($.add(y),M.add(D))}}y+=f,M.size!=0&&M.Gc()==_&&($.Jf(),M.Jf()),y!=0?$.Gc()==0&&(a=this.g.md,a=this.Ma(a),this.Xg(v,a)):$.Gc()!=0&&(a=this.g.md,a=this.Ma(a),this.Xg(v,a))}},s.prototype.dW=function(a,u,f,y){var v=this.Ma(this.g.md);if(u==-1)this.Xg(y,this.Io),(1&(a=this.Bb(a,this.yg)))!=0?this.Xg(f,v):this.Xg(f,this.Io);else{var _=this.jk(y);_==0?(_=this.jk(this.$e(u)),this.Xg(y,_),(1&(a=this.Bb(a,this.yg)))!=0?this.Xg(f,_==v?this.Io:v):this.Xg(f,_)):(1&(a=this.Bb(a,this.yg)))!=0?this.Xg(f,_==v?this.Io:v):this.Xg(f,_)}},s.prototype.cY=function(a,u,f,y){var v=y,_=-1,M=-1,$=0;do{if($==2)return!1;var T=this.Bb(v,u);if(T!=-1){if(_!=-1)return!1;_=T}else{if(M!=-1)return!1;M=v}$++,v=this.kc(this.ya(v))}while(y!=v);return M!=-1&&_!=-1&&(this.Kb(a.ka(_),u,-2),a.Uj(_,M),f.add(_),!0)},s.prototype.dY=function(a,u){var f=this.Mp(a);if(f!=0){var y=this.Mp(u);0<f&&0>y||0>f&&0<y?this.ln(a,u):(u=this.In(u))!=-1&&this.ln(a,u)}},s.prototype.qP=function(a,u){this.Eq=this.g.Hd();for(var f=0,y=u.size;f<y;f++){var v=u.get(f),_=this.g.Qa(v,this.Em),M=this.g.Sf(this.g.cd(v)),$=this.g.jc(M);if(d.ba.Ic($)){var T=this.g.V(v);if(T!=-1){var A=this.g.Qa(T,this.Em);if(_!=A){var R=this.qU(),D=this.ya(R),V=this.lh.De();this.lh.T(V,0,v),this.lh.T(V,1,-1),this.Ht(R,V),this.DJ(R,_),(V=this.Je(_))==-1?(this.on(_,R),this.Vl(R,D),this.Ul(D,R)):(_=this.ue(V),this.Vl(V,D),this.Ul(D,V),this.Ul(_,R),this.Vl(R,_)),this.DJ(D,A),(_=this.Je(A))==-1?(this.on(A,D),this.Ul(R,D),this.Vl(D,R)):(A=this.ue(_),this.Vl(_,R),this.Ul(R,_),this.Ul(A,D),this.Vl(D,A)),M=this.Ma(M),a==0?(this.Kb(D,this.be,0),this.Kb(R,this.be,$==1736?M:0)):a==5?(A=new d.h,this.g.D(v,A),v=new d.h,this.g.D(T,v),_=T=0,0>A.compare(v)?T=1:_=-1,this.Kb(D,this.be,0),this.Kb(R,this.be,0),this.Kb(R,this.eg,T),this.Kb(D,this.eg,_)):a==7?(this.Kb(D,this.be,this.Io),this.Kb(R,this.be,$==1736?M:0)):a==4&&(this.Kb(D,this.be,0),this.Kb(R,this.be,0),this.Kb(R,this.yg,1),this.Kb(D,this.yg,1)),$=$==1736?this.WN:0,this.cx(R,M|$),this.cx(D,M|$)}}}}},s.prototype.QT=function(a,u){var f=this.om(u);if(f!=-1){var y=this.om(a);this.lh.T(f,1,y),this.Ht(a,f),this.Ht(u,-1)}a=this.ya(a),u=this.ya(u),(f=this.om(u))!=-1&&(y=this.om(a),this.lh.T(f,1,y),this.Ht(a,f),this.Ht(u,-1))},s.prototype.EX=function(a){function u(oe,se){return y.CO(oe,se)}var f=new d.ja(0);f.Jb(10);for(var y=this,v=this.Oe;v!=-1;v=this.Tf(v)){f.clear(!1);var _=this.Je(v);if(_!=-1){var M=_;do f.add(M),M=this.kc(this.ya(M));while(M!=_);if(1<f.size){if(M=!0,2<f.size)f.Wd(0,f.size,u),f.add(f.get(0));else if(0<this.BO(f.get(0),f.get(1))){var $=f.get(0);f.set(0,f.get(1)),f.set(1,$)}else M=!1;for(var T=$=f.get(0),A=this.vf(T),R=this.ya(T),D=-1,V=1,Z=f.size;V<Z;V++){var ee=f.get(V),G=this.ya(ee),re=this.lk(G);if(re==A&&ee!=T){if(a==0)D=this.GF(T)|this.GF(ee),this.cx(T,D),this.cx(R,D),this.Kb(T,this.be,this.Bb(T,this.be)|this.Bb(ee,this.be)),this.Kb(R,this.be,this.Bb(R,this.be)|this.Bb(G,this.be));else if(this.eg!=-1)D=this.Bb(T,this.eg)+this.Bb(ee,this.eg),G=this.Bb(R,this.eg)+this.Bb(G,this.eg),this.Kb(T,this.eg,D),this.Kb(R,this.eg,G);else{if(a==7)return void(this.Pi=new d.Nd(5,v,-1));this.yg!=-1&&(D=this.Bb(T,this.yg)+this.Bb(ee,this.yg),G=this.Bb(R,this.yg)+this.Bb(G,this.yg),this.Kb(T,this.yg,D),this.Kb(R,this.yg,G))}this.QT(T,ee),this.Gy(ee),D=T,f.set(V,-1),ee==$&&(f.set(0,-1),$=-1)}else this.xx(D,!1),D=-1,T=ee,A=re,R=G}if(this.xx(D,!1),D=-1,M){for($=-1,V=0,Z=f.size;V<Z;V++)if((ee=f.get(V))!=-1){if($==-1)T=$=ee,A=this.vf(T),R=this.ya(T);else if(ee!=T&&(G=this.ya(ee),re=this.lk(G),this.Ul(R,ee),this.Vl(ee,R),T=ee,A=re,R=G,a==7&&(this.Bb(ee,this.be)|this.Bb(this.ue(ee),this.be))==(1|this.Io)))return void(this.Pi=new d.Nd(5,v,-1))}this.on(v,$)}else{for($=-1,V=0,Z=f.size;V<Z;V++)if((ee=f.get(V))!=-1){$=ee;break}_!=$&&this.on(v,$)}}}}},s.prototype.RN=function(){for(var a=-1,u=this.bh(),f=this.Oe;f!=-1;f=this.Tf(f)){var y=this.Je(f);if(y!=-1){var v=y;do{if(this.Bb(v,u)!=1){var _=this.hI();this.Et(_,v),this.wJ(_,a),a!=-1&&this.yJ(a,_),a=_;var M=0,$=v;do M|=this.Bb($,this.be),this.VW($,_),this.Kb($,u,1),$=this.kc($);while($!=v);this.Xg(_,M)}v=this.kc(this.ya(v))}while(v!=y)}}_=this.hI(),this.Et(_,-1),this.wJ(_,a),a!=-1&&this.yJ(a,_),this.Jl=_,this.$n=d.ce.rf(this.ze.size,NaN),this.fA=d.ce.rf(this.ze.size,NaN),this.vJ(this.Jl,1/0),this.xJ(this.Jl,1/0),this.Lg(u)},s.prototype.mR=function(a,u,f){if((u=u!=-1?u:this.Je(a))==-1)return-1;for(a=u;;){if(this.Bb(u,f)!=1)return u;if((u=this.kc(this.ya(u)))==a)return-1}},s.prototype.tW=function(){for(var a=this.bh(),u=this.Oe;u!=-1;u=this.Tf(u))for(var f=-1;;){var y=this.mR(u,f,a);if(y==-1)break;f=this.kc(this.ya(y));for(var v=y;;){var _=this.kc(v),M=this.ue(v),$=this.ya(v);if(M==$){if(this.DP(v),f!=v&&f!=$||(f=-1),v==y||M==y){if(v==(y=_)||M==y)break;v=_;continue}}else this.Kb(v,a,1);if((v=_)==y)break}}this.Lg(a)},s.prototype.HB=function(a,u,f,y,v){this.Wg(),this.bH=v,this.g=a,this.Dq=this.g.WE(),(a=new d.ja(0)).Jb(f!=null?this.g.I(f.get(0)):this.g.gd);var _=0,M=1,$=f!=null?f.get(0):this.g.md;for(v=1;$!=-1;){this.g.CJ($,this.Dq,M),M<<=1;for(var T=this.g.Ob($);T!=-1;T=this.g.Sb(T))for(var A=this.g.Ya(T),R=0,D=this.g.Ka(T);R<D;R++)a.add(A),A=this.g.V(A);d.ba.Tn(this.g.jc($))||(_+=this.g.ea($)),f!=null?($=v<f.size?f.get(v):-1,v++):$=this.g.ve($)}for(this.Io=M,this.xa=a.size,this.g.nx(a,this.xa),this.lh==null&&(this.lh=new d.ad(2),this.he=new d.ad(8),this.Lc=new d.ad(8),this.ze=new d.ad(8)),this.lh.Ee(this.xa),d.op.Bp(y),this.he.Ee(this.xa+10),this.Lc.Ee(2*this.xa+32),this.ze.Ee(Math.max(32,_)),this.Em=this.g.Hd(),f=new d.h,v=0,_=new d.h,f.Sc(),M=0;M<=this.xa;M++)if(M<this.xa?(A=a.get(M),this.g.D(A,_)):_.Sc(),!f.rb(_)){if(v<M){for(A=this.$m(),D=R=-1;v<M;v++)D=a.get(v),this.g.Sa(D,this.Em,A),$=this.lh.De(),this.lh.T($,0,D),this.lh.T($,1,R),R=$,T=this.g.cd(D),$=this.g.Sf(T),$=this.Ma($),this.NW(A,this.yd(A)|$);this.OW(A,R),this.er(A,this.g.Va(D)),this.Qs!=-1&&this.dX(this.Qs,A),this.gX(A,this.Qs),this.Qs=A,this.Oe==-1&&(this.Oe=A)}v=M,f.N(_)}d.op.Bp(y),this.be=this.bh(),u==5&&(this.eg=this.bh()),u==4&&(this.yg=this.bh()),this.qP(u,a),this.Pi.Lj==0&&(this.EX(u),this.Pi.Lj==0&&(isNaN(this.gA)||this.sO()?(this.RN(),this.Pi.Lj==0&&(this.Lg(this.be),this.be=-1,this.bH&&this.KU(u,y))):this.kA=!0))},s.prototype.Gy=function(a){var u=this.kc(a),f=this.ue(a),y=this.ya(a),v=this.kc(y),_=this.ue(y);u!=y&&(this.Ul(_,u),this.Vl(u,_)),f!=y&&(this.Ul(f,v),this.Vl(v,f)),f=this.lk(a),this.Je(f)==a&&(v!=a?this.on(f,v):this.on(f,-1)),v=this.lk(y),this.Je(v)==y&&(u!=y?this.on(v,u):this.on(v,-1)),this.Lc.kd(a),this.Lc.kd(y)},s.prototype.JF=function(a,u){for(;;){if((u=a.xe(u))==-1)return-1;var f=a.ka(u);if(this.$e(f)!=this.$e(this.ya(f)))return f}},s.prototype.fr=function(a,u){var f;f===void 0&&(f=!0),this.HB(a,0,null,u,f)},s.prototype.qJ=function(a,u,f){var y=new d.ja(0);y.add(u),this.HB(a,4,y,f,a.jc(u)==1736)},s.prototype.rJ=function(a,u,f){var y=new d.ja(0);y.add(u),this.HB(a,5,y,f,!0)},s.prototype.Wg=function(){this.g!=null&&(this.Dq!=-1&&(this.g.sW(this.Dq),this.Dq=-1),this.Em!=-1&&(this.g.Ud(this.Em),this.Em=-1),this.Eq!=-1&&(this.g.Ud(this.Eq),this.Eq=-1),this.be!=-1&&(this.Lg(this.be),this.be=-1),this.eg!=-1&&(this.Lg(this.eg),this.eg=-1),this.yg!=-1&&(this.Lg(this.yg),this.yg=-1),this.g=null,this.he.oj(!0),this.lh.oj(!0),this.Qs=this.Oe=-1,this.Lc!=null&&this.Lc.oj(!0),this.Ii!=null&&(this.Ii.length=0),this.Fi!=null&&(this.Fi.length=0),this.cH!=null&&(this.cH.length=0),this.ze!=null&&this.ze.oj(!0),this.Jl=-1,this.$n=null)},s.prototype.Je=function(a){return this.he.U(a,2)},s.prototype.D=function(a,u){this.g.ZF(this.$Q(a),u)},s.prototype.yd=function(a){return this.he.U(a,1)},s.prototype.Tf=function(a){return this.he.U(a,4)},s.prototype.Yy=function(a){return this.he.U(a,6)},s.prototype.mm=function(a){return this.he.U(a,7)},s.prototype.ls=function(a){return this.lh.U(a,1)},s.prototype.vj=function(a){return this.lh.U(a,0)},s.prototype.og=function(a,u){return(u=this.Fi[u]).size<=a?-1:u.read(a)},s.prototype.pn=function(a,u,f){(u=this.Fi[u]).size<=a&&u.resize(this.he.size,-1),u.write(a,f)},s.prototype.Fp=function(){this.Fi==null&&(this.Fi=[]);for(var a=d.ja.rf(this.he.Jg,-1),u=0,f=this.Fi.length;u<f;u++)if(this.Fi[u]==null)return this.Fi[u]=a,u;return this.Fi.push(a),this.Fi.length-1},s.prototype.Gp=function(a){this.Fi[a]=null},s.prototype.lk=function(a){return this.Lc.U(a,1)},s.prototype.vf=function(a){return this.lk(this.ya(a))},s.prototype.ya=function(a){return this.Lc.U(a,4)},s.prototype.ue=function(a){return this.Lc.U(a,5)},s.prototype.kc=function(a){return this.Lc.U(a,6)},s.prototype.$e=function(a){return this.Lc.U(a,2)},s.prototype.af=function(a){return this.jk(this.Lc.U(a,2))},s.prototype.om=function(a){return this.Lc.U(a,7)},s.prototype.$r=function(a,u){this.D(this.lk(a),u)},s.prototype.nm=function(a,u){this.D(this.vf(a),u)},s.prototype.fh=function(a){return this.Lc.U(a,3)&this.XN},s.prototype.Bb=function(a,u){return(u=this.Ii[u]).size<=a?-1:u.read(a)},s.prototype.Kb=function(a,u,f){(u=this.Ii[u]).size<=a&&u.resize(this.Lc.size,-1),u.write(a,f)},s.prototype.bh=function(){this.Ii==null&&(this.Ii=[]);for(var a=d.ja.rf(this.Lc.Jg,-1),u=0,f=this.Ii.length;u<f;u++)if(this.Ii[u]==null)return this.Ii[u]=a,u;return this.Ii.push(a),this.Ii.length-1},s.prototype.Lg=function(a){this.Ii[a]=null},s.prototype.DP=function(a){var u=this.$e(a),f=this.ya(a),y=this.kc(a);y==f&&(y=this.kc(y))==a&&(y=-1);var v=this.vF(u);v!==a&&v!=f||this.Et(u,y),f=this.$n.read(u),isNaN(f)||(this.vJ(u,NaN),this.xJ(u,NaN)),this.xx(a,!0),this.Gy(a)},s.prototype.EP=function(a){for(var u=0,f=a.size;u<f;u++){var y=a.get(u),v=this.$e(this.ya(y));this.Et(this.$e(y),-1),this.Et(v,-1),this.xx(y,!0),this.Gy(y)}},s.prototype.vF=function(a){return this.ze.U(a,1)},s.prototype.jk=function(a){return this.ze.U(a,2)},s.prototype.In=function(a){return this.ze.U(a,3)},s.prototype.ZQ=function(a){return this.ze.U(a,4)},s.prototype.Mp=function(a){var u=this.$n.read(a);return isNaN(u)&&(this.gY(a),u=this.$n.read(a)),u},s.prototype.Ma=function(a){return this.g.FF(a,this.Dq)},s.prototype.Ie=function(a){return this.g.Qa(a,this.Em)},s.prototype.oR=function(a){return this.g.Qa(a,this.Eq)},s.prototype.nR=function(a,u){var f=this.Je(a);if(f==-1)return-1;var y=f,v=-1,_=-1;do{if(this.vf(y)==u)return y;if(v==-1){if((v=this.Je(u))==-1)break;_=v}if(this.vf(_)==a)return this.ya(_);y=this.kc(this.ya(y)),_=this.kc(this.ya(_))}while(y!=f&&_!=v);return-1},s.prototype.kB=function(a,u){u.Qr(),u=u.get();var f=new d.h;this.$r(a,f),u.Ec(f),this.nm(a,f),u.Rc(f)},s.prototype.CO=function(a,u){if(a==u)return 0;var f=new d.h;this.nm(a,f);var y=new d.h;return this.nm(u,y),f.rb(y)?0:(u=new d.h,this.$r(a,u),(a=new d.h).vc(f,u),(f=new d.h).vc(y,u),d.h.pu(a,f))},s.prototype.BO=function(a,u){if(a==u)return 0;var f=new d.h;this.nm(a,f);var y=new d.h;return this.nm(u,y),f.rb(y)?0:(u=new d.h,this.$r(a,u),(a=new d.h).vc(f,u),(f=new d.h).vc(y,u),0<=f.y&&0<a.y?d.h.pu(a,f):0)},s.prototype.sO=function(){for(var a=d.mc.ox(this.gA),u=new d.h,f=new d.h,y=new d.h,v=new d.h,_=new d.h,M=this.Oe;M!=-1;M=this.Tf(M)){var $=this.Je(M);if($!=-1){var T=$;this.$r(T,u),this.nm(T,f),_.vc(f,u);var A=_.Uk();do{var R=T;if((T=this.kc(this.ya(T)))!=R){this.nm(T,y),v.vc(y,u),R=v.Uk();var D=v.yi(_);if(D*D/(R*A)*Math.min(R,A)<=a)return!1;_.N(v),A=R,f.N(y)}}while(T!=$)}}return!0},s}(),d.ku=O}(Q||(Q={})),function(d){var O=function(){function S(){this.j=null,this.jH=new d.h,this.kH=new d.h,this.Ij=null,this.Ov=!1,this.vl=-1}return S.prototype.cf=function(p){return p<this.Ij.length&&this.Ij[p]},S.prototype.fl=function(p,l,s,a){var u=d.ba.uf(this.j.g.jc(s));if(d.ba.uf(this.j.g.jc(l))!=2||u!=1)throw d.i.Ra();this.AP(p,l,s,a)},S.prototype.fr=function(p,l){this.j==null&&(this.j=new d.ku),this.j.fr(p,l)},S.prototype.Gt=function(p,l,s){for(d.Vk.W(p,l,s,!0),l=p.md;l!=-1;l=p.ve(l))p.jc(l)==1736&&d.tn.W(p,l,-1,this.Ov,s);this.fr(p,s)},S.prototype.HE=function(p,l,s,a,u){var f=this.j.g;if(f.jc(p)==1736)for(p=f.Ob(p);p!=-1;p=f.Sb(p)){var y=f.Ya(p);this.j.Ie(y),this.j.Ie(f.V(y));var v=this.j.oR(y);if(v!=-1){var _=this.j.Bb(v,s);if(_!=1&&_!=2)if(this.cf(this.j.af(v))){this.j.Kb(v,s,1),_=f.wf(l,-1);var M=v,$=this.j.Ie(y),T=1;do{var A=this.um(y,u);f.kj(_,A),a!=-1&&this.j.pn($,a,1),this.j.Kb(M,s,1),M=this.j.kc(M);do var R=(A=T==1?f.V(y):f.Na(y))!=-1?this.j.Ie(A):-1;while(R==$);var D=this.j.lk(M);if(D!=R){do R=(A=T==1?f.Na(y):f.V(y))!=-1?this.j.Ie(A):-1;while(R==$);D!=R?(R=D,A=this.j.vj(this.j.mm(R))):T=-T}$=R,y=A}while(M!=v);f.mn(_,!0)}else this.j.Kb(v,s,2)}}},S.prototype.$E=function(){for(var p=this.j.bh(),l=new d.ja(0),s=this.j.Oe;s!=-1;s=this.j.Tf(s)){var a=this.j.Je(s),u=a;if(a!=-1)do{if(this.j.Bb(u,p)!=1){var f=this.j.ya(u);this.j.Kb(f,p,1),this.j.Kb(u,p,1),this.cf(this.j.af(u))&&this.cf(this.j.af(f))&&l.add(u)}u=this.j.kc(this.j.ya(u))}while(u!=a)}this.j.Lg(p),this.j.EP(l)},S.prototype.um=function(p,l){return l==-1?p:this.WR(p,l)},S.prototype.WR=function(p,l){var s=this.j.g,a=this.j.mm(this.j.Ie(p));do{var u=this.j.vj(a);if(s.Sf(s.cd(u))==l)return u;a=this.j.ls(a)}while(a!=-1);return p},S.prototype.Qt=function(p,l,s){this.$E();var a=this.j.g,u=a.Kg(1736),f=this.j.bh();return this.pK(p,l,u,s,f,-1),this.j.Lg(f),d.tn.W(a,u,1,this.Ov,null),u},S.prototype.pK=function(p,l,s,a,u,f){for(this.HE(p,s,u,f,a),l!=-1&&this.HE(l,s,u,f,a),p=this.j.g,l=this.j.Oe;l!=-1;l=this.j.Tf(l)){var y=this.j.Je(l);if(y!=-1){var v=y;do{var _=this.j.Bb(v,u);if(_!=1&&_!=2)if(this.cf(this.j.af(v))){_=p.wf(s,-1);var M=v;do{var $=this.j.om(M);$!=-1?$=this.j.vj($):($=this.j.vj(this.j.om(this.j.ya(M))),$=this.j.g.V($)),$=this.um($,a),p.kj(_,$),this.j.Kb(M,u,1),f!=-1&&($=this.j.Ie($),this.j.pn($,f,1)),M=this.j.kc(M)}while(M!=v);p.mn(_,!0)}else this.j.Kb(v,u,2);v=this.j.kc(this.j.ya(v))}while(v!=y)}}},S.prototype.XX=function(p,l,s){var a=this.j.g,u=a.Kg(1736),f=a.Kg(1607),y=a.Kg(550);this.$E();var v=-1,_=this.j.bh(),M=this.j.Fp();for(this.pK(p,l,u,s,_,M),p=this.j.Oe;p!=-1;p=this.j.Tf(p))if((l=this.j.Je(p))!=-1){var $=l;do{var T=this.j.Bb($,_),A=this.j.Bb(this.j.ya($),_);if((T|=A)==2)if(T=this.j.fh($),this.cf(T)){var R=a.wf(f,-1),D=$;T=this.$w(p,a),T=this.um(T,s),a.kj(R,T),this.j.pn(p,M,1);do{if(T=this.j.vf(D),A=this.$w(T,a),A=this.um(A,s),a.kj(R,A),this.j.Kb(D,_,1),this.j.Kb(this.j.ya(D),_,1),this.j.pn(T,M,1),D=this.j.kc(D),T=this.j.Bb(D,_),(T|=A=this.j.Bb(this.j.ya(D),_))!=2)break;if(T=this.j.fh(D),!this.cf(T)){this.j.Kb(D,_,1),this.j.Kb(this.j.ya(D),_,1);break}}while(D!=$)}else this.j.Kb($,_,1),this.j.Kb(this.j.ya($),_,1);$=this.j.kc(this.j.ya($))}while($!=l)}for(p=this.j.Oe;p!=-1;p=this.j.Tf(p))(T=this.j.og(p,M))!=1&&(T=this.j.yd(p),this.cf(T)&&(v==-1&&(v=a.wf(y,-1)),(l=this.j.mm(p))!=-1&&(l=this.j.vj(l),T=this.um(l,s),a.kj(v,T))));return this.j.Gp(M),this.j.Lg(_),d.tn.W(a,u,1,this.Ov,null),(s=[])[0]=y,s[1]=f,s[2]=u,s},S.prototype.$w=function(p,l){var s=-1;for(p=this.j.mm(p);p!=-1;p=this.j.ls(p)){var a=this.j.vj(p);s==-1&&(s=a);var u=this.j.Ma(l.Sf(l.cd(a)));if(this.cf(u)){s=a;break}}return s},S.prototype.gB=function(p,l){for(var s=this.ll(l),a=this.j.lk(l),u=this.j.vf(l),f=0,y=0,v=this.j.mm(a);v!=-1;v=this.j.ls(v)){var _=this.j.vj(v),M=p.cd(_),$=this.j.Ma(p.Sf(M));M=p.Ya(M),($=($&s)!=0)&&M==_&&(this.vl=l);var T=p.V(_);T!=-1&&this.j.Ie(T)==u?(f++,$&&(this.vl===-1&&M==T&&(_=this.j.kc(l),this.cf(this.ll(_))&&(this.vl=_)),y++)):(_=p.Na(_))!=-1&&this.j.Ie(_)==u&&(f--,$&&(this.vl===-1&&M===_&&(_=this.j.kc(l),this.cf(this.ll(_))&&(this.vl=_)),y--))}return this.j.D(a,this.jH),this.j.D(u,this.kH),(y!=0?y:f)*(p=d.h.ub(this.jH,this.kH))},S.prototype.ll=function(p){return this.j.fh(p)|this.j.af(p)|this.j.af(this.j.ya(p))},S.prototype.sK=function(p){for(var l=this.j.ya(this.j.ue(p)),s=-1;l!=p;){if(this.cf(this.ll(l))){if(s!=-1)return-1;s=l}l=this.j.ya(this.j.ue(l))}return s!=-1?this.j.ya(s):-1},S.prototype.tK=function(p){for(var l=this.j.ya(this.j.kc(p)),s=-1;l!=p;){if(this.cf(this.ll(l))){if(s!=-1)return-1;s=l}l=this.j.ya(this.j.kc(l))}return s!=-1?this.j.ya(s):-1},S.prototype.hJ=function(p,l,s,a,u){var f=this.j.g,y=p,v=this.j.ya(y);this.j.Kb(y,s,1),this.j.Kb(v,s,1),this.vl=-1;for(var _=this.gB(f,y),M=y,$=-1,T=!1,A=1;;){var R=this.j.ue(y);if(R==v)break;if(v=this.j.kc(v),this.j.ya(R)!=v){if((y=this.sK(y))==-1){T=!0;break}v=this.j.ya(y)}else y=R;if(y==p){$=p;break}if(R=this.ll(y),!this.cf(R))break;this.j.Kb(y,s,1),this.j.Kb(v,s,1),M=y,_+=this.gB(f,y),A++}if($==-1)for(y=p,v=this.j.ya(y),$=y;(p=this.j.kc(y))!=v;){if(v=this.j.ue(v),this.j.ya(p)!=v){if((y=this.tK(y))==-1){T=!0;break}v=this.j.ya(y)}else y=p;if(R=this.ll(y),!this.cf(R))break;this.j.Kb(y,s,1),this.j.Kb(v,s,1),$=y,_+=this.gB(f,y),A++}else if(this.vl!=-1&&(M=this.vl,$=this.j.ue(this.vl),this.j.ya($)!=this.j.kc(this.j.ya(M))&&($=this.sK(M))==-1))throw d.i.Ra();for(0<=_||(y=$,$=this.j.ya(M),M=this.j.ya(y)),s=f.wf(l,-1),y=M,M=this.j.lk(M),T=this.j.vf($)==M&&T,_=this.$w(M,f),_=this.um(_,u),f.kj(s,_),a!=-1&&this.j.pn(M,a,1),M=0,A=T?d.P.truncate((A+1)/2):-1;p=this.j.vf(y),_=this.$w(p,f),_=this.um(_,u),f.kj(s,_),M++,a!=-1&&this.j.pn(p,a,1),T&&M==A&&(s=f.wf(l,-1),f.kj(s,_)),y!=$;)if(p=this.j.kc(y),this.j.ue(this.j.ya(y))!=this.j.ya(p)){if((y=this.tK(y))==-1)throw d.i.Ra()}else y=p},S.prototype.Rt=function(p){for(var l=this.j.g.Kg(1607),s=this.j.bh(),a=this.j.Oe;a!=-1;a=this.j.Tf(a)){var u=this.j.Je(a),f=u;do this.j.Bb(f,s)!=1&&this.cf(this.ll(f))&&this.hJ(f,l,s,-1,p),f=this.j.kc(this.j.ya(f));while(f!=u)}return this.j.Lg(s),l},S.prototype.YX=function(p){for(var l=this.j.g,s=l.Kg(1607),a=l.Kg(550),u=this.j.bh(),f=this.j.Fp(),y=-1,v=this.j.Oe;v!=-1;v=this.j.Tf(v)){var _=this.j.Je(v),M=_;do{var $=this.j.Bb(M,u);$!=1&&($=this.ll(M),this.cf($)&&this.hJ(M,s,u,f,p)),M=this.j.kc(this.j.ya(M))}while(M!=_)}for(v=this.j.Oe;v!=-1;v=this.j.Tf(v))($=this.j.og(v,f))!=1&&($=this.j.yd(v),this.cf($)&&(y==-1&&(y=l.wf(a,-1)),(_=this.j.mm(v))!=-1&&(_=this.j.vj(_),_=this.um(_,p),l.kj(y,_))));return this.j.Lg(u),this.j.Gp(f),(p=[])[0]=a,p[1]=s,p},S.prototype.pr=function(){for(var p=this.j.g,l=p.Kg(550),s=p.wf(l,-1),a=this.j.Oe;a!=-1;a=this.j.Tf(a))if(this.cf(this.j.yd(a))){for(var u=-1,f=this.j.mm(a);f!=-1;f=this.j.ls(f)){var y=this.j.vj(f);u==-1&&(u=y);var v=this.j.Ma(p.Sf(p.cd(y)));if(this.cf(v)){u=y;break}}p.kj(s,u)}return l},S.prototype.eq=function(p){this.Ij=[];for(var l=0;l<p;l++)this.Ij[l]=!1},S.WV=function(p,l,s){var a=p.Ja(),u=Array(1e3);d.P.bv(u,null);var f=d.P.mg(1e3,0),y=p.I(),v=!0,_=l.Eb()==2;if(l.Eb()!=1&&l.Eb()!=2)throw d.i.Ra();for(var M=0;M<y;){var $=d.P.truncate(p.gW(u,M)-M);_?d.jd.nK(l,u,$,s,f):d.jd.oK(l,u,$,s,f);for(var T=0,A=0;A<$;A++)f[A]==0&&(v&&(v=!1,a.Gd(p,0,M)),T!=A&&a.Gd(p,M+T,M+A),T=A+1);v||T==$||a.Gd(p,M+T,M+$),M+=$}return v?p:a},S.uG=function(p,l,s){return p instanceof d.ee?S.WV(p,l,s):l instanceof d.Ta?p.B()||l.B()?p.Ja():d.Vk.uU(s,p,l)?d.Vk.xO(p,l):p.Ja():S.XV(p,l,s)},S.Cv=function(p,l,s,a){var u=new d.l;p.A(u);var f=new d.l;l.A(f);var y=new d.l;if(y.L(u),y.$b(f),s=d.ua.Xd(s,y,!0),(y=new d.l).L(f),f=d.ua.Gr(s),y.X(f,f),!u.isIntersecting(y)){if(p.Eb()<=l.Eb())return S.mi(S.Ue(p.Ja()),p,"&");if(p.Eb()>l.Eb())return S.mi(S.Ue(l.Ja()),p,"&")}return f=new S,y=(u=new d.hd).Ib(S.Ue(p)),l=u.Ib(S.Ue(l)),f.Gt(u,s,a),a=f.Cv(y,l),p=S.mi(u.Ke(a),p,"&"),d.ba.Ic(p.K())&&(p.Eh(2,s),p.K()==1736&&p.hm()),p},S.XV=function(p,l,s){if(p.B()||l.B())return p.Ja();var a=[null],u=[0],f=l.Eb()==2;if(l.Eb()!=1&&l.Eb()!=2)throw d.i.Ra();return a[0]=p.D(),f?d.jd.nK(l,a,1,s,u):d.jd.oK(l,a,1,s,u),u[0]==0?p.Ja():p},S.prototype.GU=function(p,l,s,a,u){if(p.B())return p;var f=new d.hd;return p=f.Ib(p),this.Ok(f,p,l,s,a,u)},S.prototype.IU=function(p,l,s,a,u,f){if(u&&p.jc(l)!=550){var y=new d.MC;y.PX(p,s),y.Pg?(d.Vk.W(p,s,f,!0),u=!1):this.j.ty(s)}else d.Vk.W(p,s,f,!0),u=!1;if(a&&p.jc(l)!=550?this.j.rJ(p,l,f):this.j.qJ(p,l,f),this.j.kA)return this.j.Wg(),this.j=null,this.Ok(p,l,s,a,!1,f);if(this.j.ty(NaN),f=this.j.Ma(l),this.eq(f+1),this.Ij[f]=!0,p.jc(l)==1736||a&&p.jc(l)!=550)return p.$o(l,0),l=this.Qt(l,-1,-1),(p=p.Ke(l)).$o(0),u?p.Eh(1,0):(p.Eh(2,s),p.hm()),p;if(p.jc(l)==1607)return l=this.Rt(-1),p=p.Ke(l),u||p.Eh(2,s),p;if(p.jc(l)==550)return l=this.pr(),p=p.Ke(l),u||p.Eh(2,s),p;throw d.i.Ra()},S.prototype.Ok=function(p,l,s,a,u,f){this.j=new d.ku;try{return this.IU(p,l,s,a,u,f)}finally{this.j.Wg()}},S.Ok=function(p,l,s,a,u){return new S().GU(p,l,s,a,u)},S.prototype.HU=function(p,l,s,a){this.Ov=p,this.j=new d.ku,p=l.Kn(s);var u=l.jc(s);if(p!=1||u==550?this.j.qJ(l,s,a):this.j.rJ(l,s,a),!this.j.kA)if(this.j.ty(NaN),a=this.j.Ma(s),this.eq(a+1),this.Ij[a]=!0,l.jc(s)==1736||p==1&&l.jc(s)!=550)l.$o(s,0),a=this.Qt(s,-1,-1),l.cC(a,s),l.wB(a);else if(l.jc(s)==1607)a=this.Rt(-1),l.cC(a,s),l.wB(a);else{if(l.jc(s)!=550)throw d.i.ga("internal error");a=this.pr(),l.cC(a,s),l.wB(a)}},S.prototype.km=function(p,l){var s=d.ba.uf(this.j.g.jc(p)),a=d.ba.uf(this.j.g.jc(l));if(s>a)return p;var u=this.j.Ma(p),f=this.j.Ma(l);if(this.eq(1+(u|f)),this.Ij[this.j.Ma(p)]=!0,s==2&&a==2)return this.Qt(p,l,-1);if(s==1&&a==2||s==1&&a==1)return this.Rt(-1);if(s==0)return this.pr();throw d.i.Ra()},S.prototype.Cv=function(p,l){var s=d.ba.uf(this.j.g.jc(p)),a=d.ba.uf(this.j.g.jc(l)),u=this.j.Ma(p),f=this.j.Ma(l);if(this.eq(1+(u|f)),this.Ij[this.j.Ma(p)|this.j.Ma(l)]=!0,u=-1,1<this.j.g.it.Ba&&(u=p),s==2&&a==2)return this.Qt(p,l,u);if(s==1&&0<a||a==1&&0<s)return this.Rt(u);if(s==0||a==0)return this.pr();throw d.i.Ra()},S.prototype.Kz=function(p,l){var s=d.ba.uf(this.j.g.jc(p)),a=d.ba.uf(this.j.g.jc(l)),u=this.j.Ma(p),f=this.j.Ma(l);if(this.eq(1+(u|f)),this.Ij[this.j.Ma(p)|this.j.Ma(l)]=!0,u=-1,1<this.j.g.it.Ba&&(u=p),s==2&&a==2)return this.XX(p,l,u);if(s==1&&0<a||a==1&&0<s)return this.YX(u);if(s==0||a==0)return(p=[])[0]=this.pr(),p;throw d.i.Ra()},S.prototype.gp=function(p,l){var s=d.ba.uf(this.j.g.jc(p)),a=d.ba.uf(this.j.g.jc(l)),u=this.j.Ma(p),f=this.j.Ma(l);if(this.eq(1+(u|f)),this.Ij[this.j.Ma(p)]=!0,this.Ij[this.j.Ma(l)]=!0,s==2&&a==2)return this.Qt(p,l,-1);if(s==1&&a==1)return this.Rt(-1);if(s==0&&a==0)return this.pr();throw d.i.Ra()},S.Ue=function(p){var l=p.K();return l==197?(l=new d.Ea(p.description),p.B()||l.bd(p,!1),l):l==33?(l=new d.ee(p.description),p.B()||l.add(p),l):l==322?(l=new d.Ua(p.description),p.B()||l.pc(p,!0),l):p},S.mi=function(p,l,s){var a=p.K();return a==197?(l=new d.Ea(p.description),p.B()||l.bd(p,!1),l):a!=33||s!="|"&&s!="^"?a==322?(l=new d.Ua(p.description),p.B()||l.pc(p,!0),l):a==33&&s=="-"&&l.K()==33||a==550&&s=="&"&&l.K()==33?(l=new d.Ta(p.description),p.B()||p.we(0,l),l):p:(l=new d.ee(p.description),p.B()||l.add(p),l)},S.km=function(p,l,s,a){if(p.B()||l.B()||p.Eb()>l.Eb())return S.mi(S.Ue(p),p,"-");var u=new d.l;p.A(u);var f=new d.l;if(l.A(f),!u.isIntersecting(f))return S.mi(S.Ue(p),p,"-");var y=new d.l;return y.L(u),y.$b(f),s=d.ua.Xd(s,y,!0),f=new S,y=(u=new d.hd).Ib(S.Ue(p)),l=u.Ib(S.Ue(l)),f.Gt(u,s,a),a=f.km(y,l),a=u.Ke(a),p=S.mi(a,p,"-"),d.ba.Ic(p.K())&&(p.Eh(2,s),p.K()==1736&&p.hm()),p},S.QP=function(p,l,s){if(2>p.length)throw d.i.O("not enough geometries to dissolve");for(var a=0,u=0,f=p.length;u<f;u++)a=Math.max(p[u].Eb(),a);var y=new d.l;y.Pa();var v=new d.hd,_=-1,M=0,$=-1;for(u=0,f=p.length;u<f;u++)if(p[u].Eb()==a)if(p[u].B())$==-1&&($=u);else{$=u,_==-1?_=v.Ib(S.Ue(p[u])):v.pN(_,S.Ue(p[u]));var T=new d.l;p[u].yc(T),y.$b(T),M++}return 2>M?S.Ue(p[$]):(p=a==2,l=d.ua.Xd(a==0?l:null,y,!0),new S().Ok(v,_,l,p,!0,s))},S.Kz=function(p,l,s,a){var u=[null,null,null],f=new d.l;p.A(f);var y=new d.l;l.A(y);var v=new d.l;if(v.L(f),v.$b(y),s=d.ua.Xd(s,v,!0),(v=new d.l).L(y),y=d.ua.Gr(s),v.X(y,y),!f.isIntersecting(v)){if(p.Eb()<=l.Eb())return u[(p=S.mi(S.Ue(p.Ja()),p,"&")).Eb()]=p,u;if(p.Eb()>l.Eb())return u[(p=S.mi(S.Ue(l.Ja()),p,"&")).Eb()]=p,u}for(y=new S,v=(f=new d.hd).Ib(S.Ue(p)),l=f.Ib(S.Ue(l)),y.Gt(f,s,a),a=y.Kz(v,l),l=0;l<a.length;l++)y=S.mi(f.Ke(a[l]),p,"&"),d.ba.Ic(y.K())&&(y.Eh(2,s),y.K()==1736&&y.hm()),u[y.Eb()]=y;return u},S.gp=function(p,l,s,a){if(p.Eb()>l.Eb())return S.mi(S.Ue(p),p,"^");if(p.Eb()<l.Eb()||p.B())return S.mi(S.Ue(l),p,"^");if(l.B())return S.mi(S.Ue(p),p,"^");var u=new d.l;p.A(u);var f=new d.l;l.A(f);var y=new d.l;return y.L(u),y.$b(f),s=d.ua.Xd(s,y,!0),f=new S,y=(u=new d.hd).Ib(S.Ue(p)),l=u.Ib(S.Ue(l)),f.Gt(u,s,a),a=f.gp(y,l),p=S.mi(u.Ke(a),p,"^"),d.ba.Ic(p.K())&&(p.Eh(2,s),p.K()==1736&&p.hm()),p},S.prototype.GQ=function(p,l){var s=this.j.g;p=s.wf(p,-1);for(var a=l.size,u=0;u<a;u++){var f=l.get(u);s.kj(p,f)}s.mn(p,!0)},S.prototype.WW=function(p,l){for(var s=this.j.g,a=s.md;a!=-1;a=s.ve(a))if(a==l)for(var u=s.Ob(a);u!=-1;u=s.Sb(u)){var f=s.Ya(u);if(f!=-1)for(var y=s.V(f);y!=-1;){f=this.j.Ie(f);var v=this.j.Ie(y);(f=this.j.nR(f,v))!=-1&&(v=this.j.ya(f),this.j.Kb(f,p,1),this.j.Kb(v,p,2)),f=y,y=s.V(f)}}},S.prototype.YV=function(p,l,s,a){s=this.j.Ma(s),a=this.j.Ma(a);var u=new d.ja(0);u.Jb(256);for(var f=this.j.g,y=this.j.bh(),v=this.j.Oe;v!=-1;v=this.j.Tf(v)){var _=this.j.Je(v);if(_!=-1){var M=_;do{if(this.j.Bb(M,y)!=1){var $=M,T=M,A=!1,R=0;do{if(this.j.Kb($,y,1),!A){var D=this.j.fh($);(D&a)!=0&&(this.j.af($)&s)!=0&&(T=$,A=!0)}A&&(u.add(this.j.vj(this.j.mm(this.j.lk($)))),p!=-1&&((D=this.j.fh($))&a)!=0&&(R|=D=this.j.Bb($,p))),$=this.j.kc($)}while($!=T);A&&0<this.j.Mp(this.j.$e(T))&&($=f.Kg(1736),this.GQ($,u),l!=-1&&f.CJ($,l,R)),u.clear(!1)}M=this.j.kc(this.j.ya(M))}while(M!=_)}}this.j.Lg(y)},S.prototype.AP=function(p,l,s,a){this.j.tW();var u=-1;p!=-1&&(u=this.j.bh(),this.WW(u,s)),this.YV(u,p,l,s),u!=-1&&(this.j.Lg(u),u=-1);var f=this.j.g;for(p=0,u=f.md;u!=-1;u=f.ve(u))u!=l&&u!=s&&(a.add(u),p++);a.Wd(0,p,function(y,v){return(y=f.qz(f.Ob(y)))<(v=f.qz(f.Ob(v)))?-1:y==v?0:1})},S.prototype.Wg=function(){this.j!=null&&(this.j.Wg(),this.j=null)},S}();d.Hg=O}(Q||(Q={})),function(d){var O=function(){function S(p){p!==void 0?this.Jt(p):this.MB()}return S.prototype.lx=function(){this.Qb=this.Lb=this.qb=this.jb=this.bb=this.eb=0},S.prototype.Nb=function(p){return this==p||p instanceof S&&this.eb==p.eb&&this.jb==p.jb&&this.Lb==p.Lb&&this.qb==p.qb&&this.bb==p.bb&&this.Qb==p.Qb},S.prototype.dc=function(){return d.P.wj(),d.P.wj(),d.P.wj(),d.P.wj(),d.P.wj(),d.P.wj()},S.prototype.Gh=function(p,l){var s=this.qb*p.x+this.bb*p.y+this.Qb;l.x=this.eb*p.x+this.jb*p.y+this.Lb,l.y=s},S.prototype.aY=function(p,l,s){for(var a=0;a<l;a++){var u=p[a].x,f=p[a].y,y=this.eb*u+this.jb*f+this.Lb;u=this.qb*u+this.bb*f+this.Qb,s[a]!=null?s[a].na(y,u):s[a]=d.h.construct(y,u)}},S.prototype.multiply=function(p){S.multiply(this,p,this)},S.multiply=function(p,l,s){var a=p.eb*l.eb+p.qb*l.jb,u=p.jb*l.eb+p.bb*l.jb,f=p.Lb*l.eb+p.Qb*l.jb+l.Lb,y=p.eb*l.qb+p.qb*l.bb,v=p.jb*l.qb+p.bb*l.bb;p=p.Lb*l.qb+p.Qb*l.bb+l.Qb,s.eb=a,s.jb=u,s.Lb=f,s.qb=y,s.bb=v,s.Qb=p},S.prototype.Qf=function(){var p=new S;return p.eb=this.eb,p.jb=this.jb,p.Lb=this.Lb,p.qb=this.qb,p.bb=this.bb,p.Qb=this.Qb,p},S.prototype.hC=function(p){if(!p.B()){for(var l=[],s=0;4>s;s++)l[s]=new d.h;p.iB(l),this.bY(l,l),p.bx(l,4)}},S.prototype.bY=function(p,l){for(var s=0;s<p.length;s++){var a=new d.h,u=p[s];a.x=this.eb*u.x+this.jb*u.y+this.Lb,a.y=this.qb*u.x+this.bb*u.y+this.Qb,l[s]=a}},S.prototype.kS=function(p,l){p.B()||l.B()||p.S()==0||p.da()==0?this.lx():(this.jb=this.qb=0,this.eb=l.S()/p.S(),this.bb=l.da()/p.da(),this.Lb=l.v-p.v*this.eb,this.Qb=l.G-p.G*this.bb)},S.prototype.$X=function(p){var l=new d.h,s=new d.h;l.na(this.eb,this.qb),s.na(this.jb,this.bb),l.sub(l);var a=.5*l.Uk();return l.na(this.eb,this.qb),s.na(this.jb,this.bb),l.add(s),p*(a>(l=.5*l.Uk())?Math.sqrt(a):Math.sqrt(l))},S.prototype.MB=function(){this.eb=1,this.qb=this.Lb=this.jb=0,this.bb=1,this.Qb=0},S.prototype.isIdentity=function(p){if(p!==void 0){var l=d.h.construct(0,1);return this.Gh(l,l),l.sub(d.h.construct(0,1)),l.Uk()>p*p?!1:(l.na(0,0),this.Gh(l,l),!(l.Uk()>p*p)&&(l.na(1,0),this.Gh(l,l),l.sub(d.h.construct(1,0)),l.Uk()<=p*p))}return this.eb==1&&this.bb==1&&this.jb==0&&this.Lb==0&&this.qb==0&&this.Qb==0},S.prototype.Di=function(p){return Math.abs(this.eb*this.bb-this.qb*this.jb)<=2*p*(Math.abs(this.eb*this.bb)+Math.abs(this.qb*this.jb))},S.prototype.ig=function(p,l){this.eb=1,this.jb=0,this.Lb=p,this.qb=0,this.bb=1,this.Qb=l},S.prototype.Jt=function(p,l){l!==void 0?(this.eb=p,this.qb=this.Lb=this.jb=0,this.bb=l,this.Qb=0):this.Jt(p,p)},S.prototype.VB=function(){this.eb=0,this.jb=1,this.Lb=0,this.qb=1,this.Qb=this.bb=0},S.prototype.kX=function(p){this.lX(Math.cos(p),Math.sin(p))},S.prototype.lX=function(p,l){this.eb=p,this.jb=-l,this.Lb=0,this.qb=l,this.bb=p,this.Qb=0},S.prototype.shift=function(p,l){this.Lb+=p,this.Qb+=l},S.prototype.scale=function(p,l){this.eb*=p,this.jb*=p,this.Lb*=p,this.qb*=l,this.bb*=l,this.Qb*=l},S.prototype.flipX=function(p,l){this.eb=-this.eb,this.jb=-this.jb,this.Lb=p+l-this.Lb},S.prototype.flipY=function(p,l){this.qb=-this.qb,this.bb=-this.bb,this.Qb=p+l-this.Qb},S.prototype.rotate=function(p){var l=new S;l.kX(p),this.multiply(l)},S.prototype.inverse=function(p){if(p!==void 0){var l=this.eb*this.bb-this.jb*this.qb;l==0?p.lx():(l=1/l,p.Lb=(this.jb*this.Qb-this.Lb*this.bb)*l,p.Qb=(this.Lb*this.qb-this.eb*this.Qb)*l,p.eb=this.bb*l,p.jb=-this.jb*l,p.qb=-this.qb*l,p.bb=this.eb*l)}else this.inverse(this)},S}();d.Ed=O}(Q||(Q={})),function(d){var O=function(){function S(){}return S.prototype.lx=function(){this.Cg=this.Qb=this.Lb=this.Ze=this.We=this.Ve=this.Ye=this.bb=this.jb=this.pf=this.qb=this.eb=0},S.prototype.Jt=function(p,l){this.eb=p,this.jb=this.pf=this.qb=0,this.bb=l,this.We=this.Ve=this.Ye=0,this.Ze=void 0,this.Cg=this.Qb=this.Lb=0},S.prototype.translate=function(p,l,s){this.Lb+=p,this.Qb+=l,this.Cg+=s},S.prototype.hC=function(p){if(!p.B()){for(var l=new d.Od[8],s=0;8>s;s++)l[s]=new d.Od;p.iB(l),this.transform(l,8,l),p.bx(l)}},S.prototype.transform=function(p,l,s){for(var a=0;a<l;a++){var u=new d.Od,f=p[a];u.x=this.eb*f.x+this.jb*f.y+this.Ve*f.z+this.Lb,u.y=this.qb*f.x+this.bb*f.y+this.We*f.z+this.Qb,u.z=this.pf*f.x+this.Ye*f.y+this.Ze*f.z+this.Cg,s[a]=u}},S.prototype.hp=function(p){var l=new d.Od;return l.x=this.eb*p.x+this.jb*p.y+this.Ve*p.z+this.Lb,l.y=this.qb*p.x+this.bb*p.y+this.We*p.z+this.Qb,l.z=this.pf*p.x+this.Ye*p.y+this.Ze*p.z+this.Cg,l},S.prototype.Bg=function(p){S.multiply(this,p,this)},S.multiply=function(p,l,s){var a=p.eb*l.eb+p.qb*l.jb+p.pf*l.Ve,u=p.eb*l.qb+p.qb*l.bb+p.pf*l.We,f=p.eb*l.pf+p.qb*l.Ye+p.pf*l.Ze,y=p.jb*l.eb+p.bb*l.jb+p.Ye*l.Ve,v=p.jb*l.qb+p.bb*l.bb+p.Ye*l.We,_=p.jb*l.pf+p.bb*l.Ye+p.Ye*l.Ze,M=p.Ve*l.eb+p.We*l.jb+p.Ze*l.Ve,$=p.Ve*l.qb+p.We*l.bb+p.Ze*l.We,T=p.Ve*l.pf+p.We*l.Ye+p.Ze*l.Ze,A=p.Lb*l.eb+p.Qb*l.jb+p.Cg*l.Ve+l.Lb,R=p.Lb*l.qb+p.Qb*l.bb+p.Cg*l.We+l.Qb;p=p.Lb*l.pf+p.Qb*l.Ye+p.Cg*l.Ze+l.Cg,s.eb=a,s.qb=u,s.pf=f,s.jb=y,s.bb=v,s.Ye=_,s.Ve=M,s.We=$,s.Ze=T,s.Lb=A,s.Qb=R,s.Cg=p},S.inverse=function(p,l){var s=p.eb*(p.bb*p.Ze-p.Ye*p.We)-p.qb*(p.jb*p.Ze-p.Ye*p.Ve)+p.pf*(p.jb*p.We-p.bb*p.Ve);if(s==0)throw d.i.ga("math singularity");var a=1/s;s=(p.bb*p.Ze-p.Ye*p.We)*a;var u=-(p.jb*p.Ze-p.Ye*p.Ve)*a,f=(p.jb*p.We-p.bb*p.Ve)*a,y=-(p.qb*p.Ze-p.We*p.pf)*a,v=(p.eb*p.Ze-p.pf*p.Ve)*a,_=-(p.eb*p.We-p.qb*p.Ve)*a,M=(p.qb*p.Ye-p.pf*p.bb)*a,$=-(p.eb*p.Ye-p.pf*p.jb)*a;a*=p.eb*p.bb-p.qb*p.jb;var T=-(p.Lb*s+p.Qb*u+p.Cg*f),A=-(p.Lb*y+p.Qb*v+p.Cg*_);p=-(p.Lb*M+p.Qb*$+p.Cg*a),l.eb=s,l.qb=y,l.pf=M,l.jb=u,l.bb=v,l.Ye=$,l.Ve=f,l.We=_,l.Ze=a,l.Lb=T,l.Qb=A,l.Cg=p},S.prototype.Qf=function(){var p=new S;return p.eb=this.eb,p.qb=this.qb,p.pf=this.pf,p.jb=this.jb,p.bb=this.bb,p.Ye=this.Ye,p.Ve=this.Ve,p.We=this.We,p.Ze=this.Ze,p.Lb=this.Lb,p.Qb=this.Qb,p.Cg=this.Cg,p},S}();d.FY=O}(Q||(Q={})),function(d){var O=function(p){function l(s){if(s!==void 0)s=p.call(this,s.dc(),s)||this;else{(s=p.call(this)||this).dg=[],s.dg[0]=0,s.Ba=1,s.wh=[];for(var a=0;10>a;a++)s.wh[a]=-1;s.wh[s.dg[0]]=0}return s.lq=!0,s}return Pe(l,p),l.prototype.se=function(s){this.hasAttribute(s)||(this.wh[s]=0,this.eD())},l.prototype.removeAttribute=function(s){if(s==0)throw d.i.O("Position attribue cannot be removed");this.hasAttribute(s)&&(this.wh[s]=-1,this.eD())},l.prototype.reset=function(){this.dg[0]=0,this.Ba=1;for(var s=0;s<this.wh.length;s++)this.wh[s]=-1;this.wh[this.dg[0]]=0,this.lq=!0},l.prototype.zF=function(){return S.fz().add(this)},l.pg=function(){return S.fz().VR()},l.prototype.oM=function(){var s=this.dc();return new d.sa(s,this)},l.prototype.eD=function(){for(var s=this.Ba=0,a=0;10>s;s++)0<=this.wh[s]&&(this.dg[a]=s,this.wh[s]=a,a++,this.Ba++);this.lq=!0},l.prototype.dc=function(){return this.lq&&(this.yl=this.Cn(),this.lq=!1),this.yl},l.prototype.Nb=function(s){if(s==null)return!1;if(s==this)return!0;if(!(s instanceof l)||s.Ba!=this.Ba)return!1;for(var a=0;a<this.Ba;a++)if(this.dg[a]!=s.dg[a])return!1;return this.lq==s.lq},l.prototype.BG=function(s){if(s.Ba!=this.Ba)return!1;for(var a=0;a<this.Ba;a++)if(this.dg[a]!=s.dg[a])return!1;return!0},l.Kw=function(s,a){for(var u=[],f=0;f<s.Ba;f++)u[f]=-1;f=0;for(var y=s.Ba;f<y;f++)u[f]=a.Rf(s.ld(f));return u},l.wR=function(s,a){return(s=new l(s)).se(a),s.zF()},l.xR=function(s,a){for(var u=null,f=0;10>f;f++)!s.hasAttribute(f)&&a.hasAttribute(f)&&(u==null&&(u=new l(s)),u.se(f));return u!=null?u.zF():s},l}(d.sa);d.fe=O;var S=function(){function p(){this.map=[];var l=new O;this.add(l),(l=new O).se(1),this.add(l)}return p.fz=function(){return p.XK},p.prototype.VR=function(){return p.gt},p.prototype.add=function(l){var s=l.dc();if(p.gt!=null&&p.gt.dc()==s&&l.BG(p.gt))return p.gt;if(p.Fw!=null&&p.Fw.dc()==s&&l.BG(p.Fw))return p.Fw;var a=null;return this.map[s]!==void 0&&(a=this.map[s]),a==null&&((a=l.oM()).Ba==1?p.gt=a:a.Ba==2&&a.ld(1)==1?p.Fw=a:this.map[s]=a),a},p.XK=new p,p}()}(Q||(Q={}));var oi={feet:9002,kilometers:9036,meters:9001,miles:9093,"nautical-miles":9030,yards:9096},Si={acres:109402,ares:109463,hectares:109401,"square-feet":109405,"square-kilometers":109414,"square-meters":109404,"square-miles":109439,"square-yards":109442},Bi=new(function(){function d(){this.MM=50,this.pp=new Map,this.ij=[]}return d.prototype.clear=function(){this.ij.length=0,this.pp.clear()},d.prototype.delete=function(O){return!!this.pp.delete(O)&&(this.ij.splice(this.ij.indexOf(O),1),!0)},d.prototype.get=function(O){var S=this.pp.get(O);if(S!==void 0)return this.ij[0]!==O&&(this.ij.splice(this.ij.indexOf(O),1),this.ij.unshift(O)),S},d.prototype.has=function(O){return this.pp.has(O)},d.prototype.set=function(O,S){return this.get(O)!==void 0&&this.delete(O),this.ij.unshift(O),this.pp.set(O,S),this.jM(),this},d.prototype.jM=function(){for(;this.ij.length&&this.ij.length>this.MM;){var O=this.ij.pop();this.pp.delete(O)}},d}()),Ue=((Be={}).convertJSONToGeometry=function(d){return Q.ac.aP(d)},Be.hasM=function(d){return d.hasAttribute(Q.Kh.M)},Be.hasZ=function(d){return d.hasAttribute(Q.Kh.Z)},Be.getPointX=function(d){return d.Ng()},Be.getPointY=function(d){return d.kh()},Be.getPointZ=function(d){return d.XR()},Be.getPointM=function(d){return d.uR()},Be.getXMin=function(d){return d.gs()},Be.getYMin=function(d){return d.js()},Be.getXMax=function(d){return d.fs()},Be.getYMax=function(d){return d.hs()},Be.getZExtent=function(d){return d.Vg(Q.Kh.Z,0)},Be.getMExtent=function(d){return d.Vg(Q.Kh.M,0)},Be.exportPaths=function(d){var O=[],S=d.ea(),p=null,l=null,s=d.hasAttribute(Q.Kh.Z),a=d.hasAttribute(Q.Kh.M);s&&(p=d.vb(Q.Kh.Z)),a&&(l=d.vb(Q.Kh.M));for(var u=new Q.h,f=0;f<S;f++){for(var y=d.Ca(f),v=d.Ka(f),_=0,M=0,$=NaN,T=NaN,A=NaN,R=NaN,D=d.ec(f),V=[],Z=y;Z<y+v;Z++){d.D(Z,u),R=A=NaN;var ee=[u.x,u.y];s&&(A=p.get(Z),ee.push(A)),a&&(R=l.get(Z),ee.push(R)),Z==y&&D&&(_=u.x,M=u.y,$=A,T=R),V.push(ee)}!D||_==u.x&&M==u.y&&(!s||isNaN($)&&isNaN(A)||$==A)&&(!a||isNaN(T)&&isNaN(R)||T==R)||V.push(V[0].slice(0)),O.push(V)}return O},Be.exportPathsFlat=function(){},Be.exportPoints=function(d){var O=d.hasAttribute(Q.Kh.Z),S=d.hasAttribute(Q.Kh.M),p=null,l=null;O&&(p=d.vb(Q.Kh.Z)),S&&(l=d.vb(Q.Kh.M));for(var s=new Q.h,a=d.I(),u=[],f=0;f<a;f++){d.D(f,s);var y=[s.x,s.y];O&&y.push(p.get(f)),S&&y.push(l.get(f)),u.push(y)}return u},Be.exportPointsFlat=function(){},Be),Ls=new Map;return function(){function d(){}return d.buffer=st,d.clip=E,d.contains=P,d.convexHull=ye,d.crosses=F,d.cut=k,d.densify=pn,d.difference=xe,d.disjoint=X,d.distance=N,d.equals=B,d.extendedSpatialReferenceInfo=I,d.generalize=ei,d.geodesicArea=rt,d.geodesicBuffer=et,d.geodesicDensify=Sr,d.geodesicLength=It,d.intersect=Ae,d.intersects=z,d.isSimple=he,d.nearestCoordinate=Et,d.nearestVertex=Gt,d.nearestVertices=pi,d.offset=bt,d.overlaps=Y,d.planarArea=je,d.planarLength=at,d.relate=ae,d.simplify=fe,d.symmetricDifference=Se,d.touches=q,d.union=Oe,d.within=J,d.rotate=Q.Dx.rotate,d.flipHorizontal=Q.Dx.EQ,d.flipVertical=Q.Dx.FQ,d.intersectLinesToPoints=Ge,d.ExtendedParams=Q.tC,d.clearDefaultSpatialReferenceTolerance=Ve,d.changeDefaultSpatialReferenceTolerance=Le,d._enableProjection=ni,d._project=pe,d._getTransformation=Ai,d._getTransformationBySuitability=Ut,d}()}var r=i();r!==void 0&&(e.exports=r)})(dF);const wi=dF.exports,bUe=vUe({__proto__:null,default:wi},[dF.exports]);var wUe=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",G:wi,g:bUe});const Ni={convertToGEGeometry:_Ue,exportPoint:xUe,exportPolygon:SUe,exportPolyline:MUe,exportMultipoint:IUe,exportExtent:$Ue};function _Ue(e,t){if(t==null)return null;let i="cache"in t?t.cache._geVersion:void 0;return i==null&&(i=e.convertJSONToGeometry(t),"cache"in t&&(t.cache._geVersion=i)),i}function xUe(e,t,i){const r=e.hasZ(t),n=e.hasM(t),o=new pt({x:e.getPointX(t),y:e.getPointY(t),spatialReference:i});return r&&(o.z=e.getPointZ(t)),n&&(o.m=e.getPointM(t)),o.cache._geVersion=t,o}function SUe(e,t,i){const r=new es({rings:e.exportPaths(t),hasZ:e.hasZ(t),hasM:e.hasM(t),spatialReference:i});return r.cache._geVersion=t,r}function MUe(e,t,i){const r=new Fn({paths:e.exportPaths(t),hasZ:e.hasZ(t),hasM:e.hasM(t),spatialReference:i});return r.cache._geVersion=t,r}function IUe(e,t,i){const r=new bw({hasZ:e.hasZ(t),hasM:e.hasM(t),points:e.exportPoints(t),spatialReference:i});return r.cache._geVersion=t,r}function $Ue(e,t,i){const r=e.hasZ(t),n=e.hasM(t),o=new gi({xmin:e.getXMin(t),ymin:e.getYMin(t),xmax:e.getXMax(t),ymax:e.getYMax(t),spatialReference:i});if(r){const c=e.getZExtent(t);o.zmin=c.vmin,o.zmax=c.vmax}if(n){const c=e.getMExtent(t);o.mmin=c.vmin,o.mmax=c.vmax}return o.cache._geVersion=t,o}var EUe=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",hydratedAdapter:Ni});function Gi(e){return Array.isArray(e)?e[0].spatialReference:e&&e.spatialReference}function TUe(e){return wi.extendedSpatialReferenceInfo(e)}function CUe(e,t){return wi.clip(Ni,Gi(e),e,t)}function kUe(e,t){return wi.cut(Ni,Gi(e),e,t)}function AUe(e,t){return wi.contains(Ni,Gi(e),e,t)}function PUe(e,t){return wi.crosses(Ni,Gi(e),e,t)}function LUe(e,t,i){return wi.distance(Ni,Gi(e),e,t,i)}function OUe(e,t){return wi.equals(Ni,Gi(e),e,t)}function RUe(e,t){return wi.intersects(Ni,Gi(e),e,t)}function FUe(e,t){return wi.touches(Ni,Gi(e),e,t)}function NUe(e,t){return wi.within(Ni,Gi(e),e,t)}function DUe(e,t){return wi.disjoint(Ni,Gi(e),e,t)}function jUe(e,t){return wi.overlaps(Ni,Gi(e),e,t)}function VUe(e,t,i){return wi.relate(Ni,Gi(e),e,t,i)}function zUe(e){return wi.isSimple(Ni,Gi(e),e)}function GUe(e){return wi.simplify(Ni,Gi(e),e)}function BUe(e,t=!1){return wi.convexHull(Ni,Gi(e),e,t)}function UUe(e,t){return wi.difference(Ni,Gi(e),e,t)}function qUe(e,t){return wi.symmetricDifference(Ni,Gi(e),e,t)}function HUe(e,t){return wi.intersect(Ni,Gi(e),e,t)}function WUe(e,t=null){return wi.union(Ni,Gi(e),e,t)}function JUe(e,t,i,r,n,o){return wi.offset(Ni,Gi(e),e,t,i,r,n,o)}function ZUe(e,t,i,r=!1){return wi.buffer(Ni,Gi(e),e,t,i,r)}function KUe(e,t,i,r,n,o){return wi.geodesicBuffer(Ni,Gi(e),e,t,i,r,n,o)}function YUe(e,t,i=!0){return wi.nearestCoordinate(Ni,Gi(e),e,t,i)}function XUe(e,t){return wi.nearestVertex(Ni,Gi(e),e,t)}function QUe(e,t,i,r){return wi.nearestVertices(Ni,Gi(e),e,t,i,r)}function fF(e){var t,i;return"xmin"in e?"center"in e?e.center:null:"x"in e?e:"extent"in e&&(i=(t=e.extent)==null?void 0:t.center)!=null?i:null}function eqe(e,t,i){if(e==null)throw new $b;const r=e.spatialReference;if((i=i!=null?i:fF(e))==null)throw new $b;const n=e.constructor.fromJSON(wi.rotate(e,t,i));return n.spatialReference=r,n}function tqe(e,t){if(e==null)throw new $b;const i=e.spatialReference;if((t=t!=null?t:fF(e))==null)throw new $b;const r=e.constructor.fromJSON(wi.flipHorizontal(e,t));return r.spatialReference=i,r}function iqe(e,t){if(e==null)throw new $b;const i=e.spatialReference;if((t=t!=null?t:fF(e))==null)throw new $b;const r=e.constructor.fromJSON(wi.flipVertical(e,t));return r.spatialReference=i,r}function rqe(e,t,i,r){return wi.generalize(Ni,Gi(e),e,t,i,r)}function nqe(e,t,i){return wi.densify(Ni,Gi(e),e,t,i)}function sqe(e,t,i,r=0){return wi.geodesicDensify(Ni,Gi(e),e,t,i,r)}function oqe(e,t){return wi.planarArea(Ni,Gi(e),e,t)}function aqe(e,t){return wi.planarLength(Ni,Gi(e),e,t)}function lqe(e,t,i){return wi.geodesicArea(Ni,Gi(e),e,t,i)}function cqe(e,t,i){return wi.geodesicLength(Ni,Gi(e),e,t,i)}function uqe(e,t){return wi.intersectLinesToPoints(Ni,Gi(e),e,t)}function hqe(e,t){wi.changeDefaultSpatialReferenceTolerance(e,t)}function pqe(e){wi.clearDefaultSpatialReferenceTolerance(e)}class $b extends Error{constructor(){super("Illegal Argument Exception")}}var aXe=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",buffer:ZUe,changeDefaultSpatialReferenceTolerance:hqe,clearDefaultSpatialReferenceTolerance:pqe,clip:CUe,contains:AUe,convexHull:BUe,crosses:PUe,cut:kUe,densify:nqe,difference:UUe,disjoint:DUe,distance:LUe,equals:OUe,extendedSpatialReferenceInfo:TUe,flipHorizontal:tqe,flipVertical:iqe,generalize:rqe,geodesicArea:lqe,geodesicBuffer:KUe,geodesicDensify:sqe,geodesicLength:cqe,intersect:HUe,intersectLinesToPoints:uqe,intersects:RUe,isSimple:zUe,nearestCoordinate:YUe,nearestVertex:XUe,nearestVertices:QUe,offset:JUe,overlaps:jUe,planarArea:oqe,planarLength:aqe,relate:VUe,rotate:eqe,simplify:GUe,symmetricDifference:qUe,touches:FUe,union:WUe,within:NUe});let ih=class extends ke{constructor(e){super(e),this.displayFieldName=null,this.feature=null,this.foundFieldName=null,this.layerId=null,this.layerName=null,this.value=void 0}readFeature(e,t){const i={attributes:{}};return t.attributes&&(i.attributes=t.attributes),t.geometry&&(i.geometry=t.geometry),Gr.fromJSON(i)}writeFeature(e,t){if(!e)return;const{attributes:i,geometry:r}=e;i&&(t.attributes=K({},i)),H(r)&&(t.geometry=r.toJSON(),t.geometryType=DS.toJSON(r.type))}};g([w({type:String,json:{write:!0}})],ih.prototype,"displayFieldName",void 0),g([w({type:Gr})],ih.prototype,"feature",void 0),g([We("feature",["attributes","geometry"])],ih.prototype,"readFeature",null),g([tt("feature")],ih.prototype,"writeFeature",null),g([w({type:String,json:{write:!0}})],ih.prototype,"foundFieldName",void 0),g([w({type:Number,json:{write:!0}})],ih.prototype,"layerId",void 0),g([w({type:String,json:{write:!0}})],ih.prototype,"layerName",void 0),g([w({json:{write:!0}})],ih.prototype,"value",void 0),ih=g([te("esri.rest.support.FindResult")],ih);const ax=/^[a-z0-9]+(-[a-z0-9]+)*$/,S$=(e,t,i,r="")=>{const n=e.split(":");if(e.slice(0,1)==="@"){if(n.length<2||n.length>3)return null;r=n.shift().slice(1)}if(n.length>3||!n.length)return null;if(n.length>1){const h=n.pop(),m=n.pop(),b={provider:n.length>0?n[0]:r,prefix:m,name:h};return t&&!M$(b)?null:b}const o=n[0],c=o.split("-");if(c.length>1){const h={provider:r,prefix:c.shift(),name:c.join("-")};return t&&!M$(h)?null:h}if(i&&r===""){const h={provider:r,prefix:"",name:o};return t&&!M$(h,i)?null:h}return null},M$=(e,t)=>e?!!((e.provider===""||e.provider.match(ax))&&(t&&e.prefix===""||e.prefix.match(ax))&&e.name.match(ax)):!1,qae=Object.freeze({left:0,top:0,width:16,height:16}),I$=Object.freeze({rotate:0,vFlip:!1,hFlip:!1}),$$=Object.freeze(K(K({},qae),I$)),yF=Object.freeze(Ce(K({},$$),{body:"",hidden:!1}));function dqe(e,t){const i={};!e.hFlip!=!t.hFlip&&(i.hFlip=!0),!e.vFlip!=!t.vFlip&&(i.vFlip=!0);const r=((e.rotate||0)+(t.rotate||0))%4;return r&&(i.rotate=r),i}function Hae(e,t){const i=dqe(e,t);for(const r in yF)r in I$?r in e&&!(r in i)&&(i[r]=I$[r]):r in t?i[r]=t[r]:r in e&&(i[r]=e[r]);return i}function fqe(e,t){const i=e.icons,r=e.aliases||Object.create(null),n=Object.create(null);function o(c){if(i[c])return n[c]=[];if(!(c in n)){n[c]=null;const h=r[c]&&r[c].parent,m=h&&o(h);m&&(n[c]=[h].concat(m))}return n[c]}return(t||Object.keys(i).concat(Object.keys(r))).forEach(o),n}function yqe(e,t,i){const r=e.icons,n=e.aliases||Object.create(null);let o={};function c(h){o=Hae(r[h]||n[h],o)}return c(t),i.forEach(c),Hae(e,o)}function Wae(e,t){const i=[];if(typeof e!="object"||typeof e.icons!="object")return i;e.not_found instanceof Array&&e.not_found.forEach(n=>{t(n,null),i.push(n)});const r=fqe(e);for(const n in r){const o=r[n];o&&(t(n,yqe(e,n,o)),i.push(n))}return i}const mqe=K({provider:"",aliases:{},not_found:{}},qae);function mF(e,t){for(const i in t)if(i in e&&typeof e[i]!=typeof t[i])return!1;return!0}function Jae(e){if(typeof e!="object"||e===null)return null;const t=e;if(typeof t.prefix!="string"||!e.icons||typeof e.icons!="object"||!mF(e,mqe))return null;const i=t.icons;for(const n in i){const o=i[n];if(!n.match(ax)||typeof o.body!="string"||!mF(o,yF))return null}const r=t.aliases||Object.create(null);for(const n in r){const o=r[n],c=o.parent;if(!n.match(ax)||typeof c!="string"||!i[c]&&!r[c]||!mF(o,yF))return null}return t}const Zae=Object.create(null);function gqe(e,t){return{provider:e,prefix:t,icons:Object.create(null),missing:new Set}}function Am(e,t){const i=Zae[e]||(Zae[e]=Object.create(null));return i[t]||(i[t]=gqe(e,t))}function gF(e,t){return Jae(t)?Wae(t,(i,r)=>{r?e.icons[i]=r:e.missing.add(i)}):[]}function vqe(e,t,i){try{if(typeof i.body=="string")return e.icons[t]=K({},i),!0}catch{}return!1}let lx=!1;function Kae(e){return typeof e=="boolean"&&(lx=e),lx}function bqe(e){const t=typeof e=="string"?S$(e,!0,lx):e;if(t){const i=Am(t.provider,t.prefix),r=t.name;return i.icons[r]||(i.missing.has(r)?null:void 0)}}function wqe(e,t){const i=S$(e,!0,lx);if(!i)return!1;const r=Am(i.provider,i.prefix);return vqe(r,i.name,t)}function _qe(e,t){if(typeof e!="object")return!1;if(typeof t!="string"&&(t=e.provider||""),lx&&!t&&!e.prefix){let n=!1;return Jae(e)&&(e.prefix="",Wae(e,(o,c)=>{c&&wqe(o,c)&&(n=!0)})),n}const i=e.prefix;if(!M$({provider:t,prefix:i,name:"a"}))return!1;const r=Am(t,i);return!!gF(r,e)}const Yae=Object.freeze({width:null,height:null}),Xae=Object.freeze(K(K({},Yae),I$)),xqe=/(-?[0-9.]*[0-9]+[0-9.]*)/g,Sqe=/^-?[0-9.]*[0-9]+[0-9.]*$/g;function Qae(e,t,i){if(t===1)return e;if(i=i||100,typeof e=="number")return Math.ceil(e*t*i)/i;if(typeof e!="string")return e;const r=e.split(xqe);if(r===null||!r.length)return e;const n=[];let o=r.shift(),c=Sqe.test(o);for(;;){if(c){const h=parseFloat(o);isNaN(h)?n.push(o):n.push(Math.ceil(h*t*i)/i)}else n.push(o);if(o=r.shift(),o===void 0)return n.join("");c=!c}}function Mqe(e,t){const i=K(K({},$$),e),r=K(K({},Xae),t),n={left:i.left,top:i.top,width:i.width,height:i.height};let o=i.body;[i,r].forEach(k=>{const P=[],F=k.hFlip,N=k.vFlip;let B=k.rotate;F?N?B+=2:(P.push("translate("+(n.width+n.left).toString()+" "+(0-n.top).toString()+")"),P.push("scale(-1 1)"),n.top=n.left=0):N&&(P.push("translate("+(0-n.left).toString()+" "+(n.height+n.top).toString()+")"),P.push("scale(1 -1)"),n.top=n.left=0);let z;switch(B<0&&(B-=Math.floor(B/4)*4),B=B%4,B){case 1:z=n.height/2+n.top,P.unshift("rotate(90 "+z.toString()+" "+z.toString()+")");break;case 2:P.unshift("rotate(180 "+(n.width/2+n.left).toString()+" "+(n.height/2+n.top).toString()+")");break;case 3:z=n.width/2+n.left,P.unshift("rotate(-90 "+z.toString()+" "+z.toString()+")");break}B%2==1&&(n.left!==n.top&&(z=n.left,n.left=n.top,n.top=z),n.width!==n.height&&(z=n.width,n.width=n.height,n.height=z)),P.length&&(o='<g transform="'+P.join(" ")+'">'+o+"</g>")});const c=r.width,h=r.height,m=n.width,b=n.height;let x,I;return c===null?(I=h===null?"1em":h==="auto"?b:h,x=Qae(I,m/b)):(x=c==="auto"?m:c,I=h===null?Qae(x,b/m):h==="auto"?b:h),{attributes:{width:x.toString(),height:I.toString(),viewBox:n.left.toString()+" "+n.top.toString()+" "+m.toString()+" "+b.toString()},body:o}}const Iqe=/\sid="(\S+)"/g,$qe="IconifyId"+Date.now().toString(16)+(Math.random()*16777216|0).toString(16);let Eqe=0;function Tqe(e,t=$qe){const i=[];let r;for(;r=Iqe.exec(e);)i.push(r[1]);return i.length&&i.forEach(n=>{const o=typeof t=="function"?t(n):t+(Eqe++).toString(),c=n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");e=e.replace(new RegExp('([#;"])('+c+')([")]|\\.[a-z])',"g"),"$1"+o+"$3")}),e}const vF=Object.create(null);function Cqe(e,t){vF[e]=t}function bF(e){return vF[e]||vF[""]}function wF(e){let t;if(typeof e.resources=="string")t=[e.resources];else if(t=e.resources,!(t instanceof Array)||!t.length)return null;return{resources:t,path:e.path||"/",maxURL:e.maxURL||500,rotate:e.rotate||750,timeout:e.timeout||5e3,random:e.random===!0,index:e.index||0,dataAfterTimeout:e.dataAfterTimeout!==!1}}const _F=Object.create(null),cx=["https://api.simplesvg.com","https://api.unisvg.com"],E$=[];for(;cx.length>0;)cx.length===1||Math.random()>.5?E$.push(cx.shift()):E$.push(cx.pop());_F[""]=wF({resources:["https://api.iconify.design"].concat(E$)});function kqe(e,t){const i=wF(t);return i===null?!1:(_F[e]=i,!0)}function xF(e){return _F[e]}const Aqe=()=>{let e;try{if(e=fetch,typeof e=="function")return e}catch{}};let ele=Aqe();function Pqe(e,t){const i=xF(e);if(!i)return 0;let r;if(!i.maxURL)r=0;else{let n=0;i.resources.forEach(c=>{n=Math.max(n,c.length)});const o=t+".json?icons=";r=i.maxURL-n-i.path.length-o.length}return r}function Lqe(e){return e===404}const Oqe=(e,t,i)=>{const r=[],n=Pqe(e,t),o="icons";let c={type:o,provider:e,prefix:t,icons:[]},h=0;return i.forEach((m,b)=>{h+=m.length+1,h>=n&&b>0&&(r.push(c),c={type:o,provider:e,prefix:t,icons:[]},h=m.length),c.icons.push(m)}),r.push(c),r};function Rqe(e){if(typeof e=="string"){const t=xF(e);if(t)return t.path}return"/"}const Fqe=(e,t,i)=>{if(!ele){i("abort",424);return}let r=Rqe(t.provider);switch(t.type){case"icons":{const o=t.prefix,h=t.icons.join(","),m=new URLSearchParams({icons:h});r+=o+".json?"+m.toString();break}case"custom":{const o=t.uri;r+=o.slice(0,1)==="/"?o.slice(1):o;break}default:i("abort",400);return}let n=503;ele(e+r).then(o=>{const c=o.status;if(c!==200){setTimeout(()=>{i(Lqe(c)?"abort":"next",c)});return}return n=501,o.json()}).then(o=>{if(typeof o!="object"||o===null){setTimeout(()=>{o===404?i("abort",o):i("next",n)});return}setTimeout(()=>{i("success",o)})}).catch(()=>{i("next",n)})},Nqe={prepare:Oqe,send:Fqe};function Dqe(e){const t={loaded:[],missing:[],pending:[]},i=Object.create(null);e.sort((n,o)=>n.provider!==o.provider?n.provider.localeCompare(o.provider):n.prefix!==o.prefix?n.prefix.localeCompare(o.prefix):n.name.localeCompare(o.name));let r={provider:"",prefix:"",name:""};return e.forEach(n=>{if(r.name===n.name&&r.prefix===n.prefix&&r.provider===n.provider)return;r=n;const o=n.provider,c=n.prefix,h=n.name,m=i[o]||(i[o]=Object.create(null)),b=m[c]||(m[c]=Am(o,c));let x;h in b.icons?x=t.loaded:c===""||b.missing.has(h)?x=t.missing:x=t.pending;const I={provider:o,prefix:c,name:h};x.push(I)}),t}function tle(e,t){e.forEach(i=>{const r=i.loaderCallbacks;r&&(i.loaderCallbacks=r.filter(n=>n.id!==t))})}function jqe(e){e.pendingCallbacksFlag||(e.pendingCallbacksFlag=!0,setTimeout(()=>{e.pendingCallbacksFlag=!1;const t=e.loaderCallbacks?e.loaderCallbacks.slice(0):[];if(!t.length)return;let i=!1;const r=e.provider,n=e.prefix;t.forEach(o=>{const c=o.icons,h=c.pending.length;c.pending=c.pending.filter(m=>{if(m.prefix!==n)return!0;const b=m.name;if(e.icons[b])c.loaded.push({provider:r,prefix:n,name:b});else if(e.missing.has(b))c.missing.push({provider:r,prefix:n,name:b});else return i=!0,!0;return!1}),c.pending.length!==h&&(i||tle([e],o.id),o.callback(c.loaded.slice(0),c.missing.slice(0),c.pending.slice(0),o.abort))})}))}let Vqe=0;function zqe(e,t,i){const r=Vqe++,n=tle.bind(null,i,r);if(!t.pending.length)return n;const o={id:r,icons:t,callback:e,abort:n};return i.forEach(c=>{(c.loaderCallbacks||(c.loaderCallbacks=[])).push(o)}),n}function Gqe(e,t=!0,i=!1){const r=[];return e.forEach(n=>{const o=typeof n=="string"?S$(n,t,i):n;o&&r.push(o)}),r}var Bqe={resources:[],index:0,timeout:2e3,rotate:750,random:!1,dataAfterTimeout:!1};function Uqe(e,t,i,r){const n=e.resources.length,o=e.random?Math.floor(Math.random()*n):e.index;let c;if(e.random){let Y=e.resources.slice(0);for(c=[];Y.length>1;){const ae=Math.floor(Math.random()*Y.length);c.push(Y[ae]),Y=Y.slice(0,ae).concat(Y.slice(ae+1))}c=c.concat(Y)}else c=e.resources.slice(o).concat(e.resources.slice(0,o));const h=Date.now();let m="pending",b=0,x,I=null,E=[],k=[];typeof r=="function"&&k.push(r);function P(){I&&(clearTimeout(I),I=null)}function F(){m==="pending"&&(m="aborted"),P(),E.forEach(Y=>{Y.status==="pending"&&(Y.status="aborted")}),E=[]}function N(Y,ae){ae&&(k=[]),typeof Y=="function"&&k.push(Y)}function B(){return{startTime:h,payload:t,status:m,queriesSent:b,queriesPending:E.length,subscribe:N,abort:F}}function z(){m="failed",k.forEach(Y=>{Y(void 0,x)})}function q(){E.forEach(Y=>{Y.status==="pending"&&(Y.status="aborted")}),E=[]}function J(Y,ae,he){const fe=ae!=="success";switch(E=E.filter(ye=>ye!==Y),m){case"pending":break;case"failed":if(fe||!e.dataAfterTimeout)return;break;default:return}if(ae==="abort"){x=he,z();return}if(fe){x=he,E.length||(c.length?X():z());return}if(P(),q(),!e.random){const ye=e.resources.indexOf(Y.resource);ye!==-1&&ye!==e.index&&(e.index=ye)}m="completed",k.forEach(ye=>{ye(he)})}function X(){if(m!=="pending")return;P();const Y=c.shift();if(Y===void 0){if(E.length){I=setTimeout(()=>{P(),m==="pending"&&(q(),z())},e.timeout);return}z();return}const ae={status:"pending",resource:Y,callback:(he,fe)=>{J(ae,he,fe)}};E.push(ae),b++,I=setTimeout(X,e.rotate),i(Y,t,ae.callback)}return setTimeout(X),B}function ile(e){const t=K(K({},Bqe),e);let i=[];function r(){i=i.filter(h=>h().status==="pending")}function n(h,m,b){const x=Uqe(t,h,m,(I,E)=>{r(),b&&b(I,E)});return i.push(x),x}function o(h){return i.find(m=>h(m))||null}return{query:n,find:o,setIndex:h=>{t.index=h},getIndex:()=>t.index,cleanup:r}}function rle(){}const SF=Object.create(null);function qqe(e){if(!SF[e]){const t=xF(e);if(!t)return;const i=ile(t),r={config:t,redundancy:i};SF[e]=r}return SF[e]}function Hqe(e,t,i){let r,n;if(typeof e=="string"){const o=bF(e);if(!o)return i(void 0,424),rle;n=o.send;const c=qqe(e);c&&(r=c.redundancy)}else{const o=wF(e);if(o){r=ile(o);const c=e.resources?e.resources[0]:"",h=bF(c);h&&(n=h.send)}}return!r||!n?(i(void 0,424),rle):r.query(t,n,i)().abort}const nle="iconify2",ux="iconify",sle=ux+"-count",ole=ux+"-version",ale=36e5,Wqe=168;function MF(e,t){try{return e.getItem(t)}catch{}}function IF(e,t,i){try{return e.setItem(t,i),!0}catch{}}function lle(e,t){try{e.removeItem(t)}catch{}}function $F(e,t){return IF(e,sle,t.toString())}function EF(e){return parseInt(MF(e,sle))||0}const T$={local:!0,session:!0},cle={local:new Set,session:new Set};let TF=!1;function Jqe(e){TF=e}let C$=typeof window=="undefined"?{}:window;function ule(e){const t=e+"Storage";try{if(C$&&C$[t]&&typeof C$[t].length=="number")return C$[t]}catch{}T$[e]=!1}function hle(e,t){const i=ule(e);if(!i)return;const r=MF(i,ole);if(r!==nle){if(r){const h=EF(i);for(let m=0;m<h;m++)lle(i,ux+m.toString())}IF(i,ole,nle),$F(i,0);return}const n=Math.floor(Date.now()/ale)-Wqe,o=h=>{const m=ux+h.toString(),b=MF(i,m);if(typeof b=="string"){try{const x=JSON.parse(b);if(typeof x=="object"&&typeof x.cached=="number"&&x.cached>n&&typeof x.provider=="string"&&typeof x.data=="object"&&typeof x.data.prefix=="string"&&t(x,h))return!0}catch{}lle(i,m)}};let c=EF(i);for(let h=c-1;h>=0;h--)o(h)||(h===c-1?(c--,$F(i,c)):cle[e].add(h))}function ple(){if(!TF){Jqe(!0);for(const e in T$)hle(e,t=>{const i=t.data,r=t.provider,n=i.prefix,o=Am(r,n);if(!gF(o,i).length)return!1;const c=i.lastModified||-1;return o.lastModifiedCached=o.lastModifiedCached?Math.min(o.lastModifiedCached,c):c,!0})}}function Zqe(e,t){const i=e.lastModifiedCached;if(i&&i>=t)return i===t;if(e.lastModifiedCached=t,i)for(const r in T$)hle(r,n=>{const o=n.data;return n.provider!==e.provider||o.prefix!==e.prefix||o.lastModified===t});return!0}function Kqe(e,t){TF||ple();function i(r){let n;if(!T$[r]||!(n=ule(r)))return;const o=cle[r];let c;if(o.size)o.delete(c=Array.from(o).shift());else if(c=EF(n),!$F(n,c+1))return;const h={cached:Math.floor(Date.now()/ale),provider:e.provider,data:t};return IF(n,ux+c.toString(),JSON.stringify(h))}t.lastModified&&!Zqe(e,t.lastModified)||!Object.keys(t.icons).length||(t.not_found&&(t=Object.assign({},t),delete t.not_found),i("local")||i("session"))}function dle(){}function Yqe(e){e.iconsLoaderFlag||(e.iconsLoaderFlag=!0,setTimeout(()=>{e.iconsLoaderFlag=!1,jqe(e)}))}function Xqe(e,t){e.iconsToLoad?e.iconsToLoad=e.iconsToLoad.concat(t).sort():e.iconsToLoad=t,e.iconsQueueFlag||(e.iconsQueueFlag=!0,setTimeout(()=>{e.iconsQueueFlag=!1;const{provider:i,prefix:r}=e,n=e.iconsToLoad;delete e.iconsToLoad;let o;if(!n||!(o=bF(i)))return;o.prepare(i,r,n).forEach(h=>{Hqe(i,h,m=>{if(typeof m!="object")h.icons.forEach(b=>{e.missing.add(b)});else try{const b=gF(e,m);if(!b.length)return;const x=e.pendingIcons;x&&b.forEach(I=>{x.delete(I)}),Kqe(e,m)}catch(b){console.error(b)}Yqe(e)})})}))}const Qqe=(e,t)=>{const i=Gqe(e,!0,Kae()),r=Dqe(i);if(!r.pending.length){let m=!0;return t&&setTimeout(()=>{m&&t(r.loaded,r.missing,r.pending,dle)}),()=>{m=!1}}const n=Object.create(null),o=[];let c,h;return r.pending.forEach(m=>{const{provider:b,prefix:x}=m;if(x===h&&b===c)return;c=b,h=x,o.push(Am(b,x));const I=n[b]||(n[b]=Object.create(null));I[x]||(I[x]=[])}),r.pending.forEach(m=>{const{provider:b,prefix:x,name:I}=m,E=Am(b,x),k=E.pendingIcons||(E.pendingIcons=new Set);k.has(I)||(k.add(I),n[b][x].push(I))}),o.forEach(m=>{const{provider:b,prefix:x}=m;n[b][x].length&&Xqe(m,n[b][x])}),t?zqe(t,r,o):dle};function eHe(e,t){const i=K({},e);for(const r in t){const n=t[r],o=typeof n;r in Yae?(n===null||n&&(o==="string"||o==="number"))&&(i[r]=n):o===typeof i[r]&&(i[r]=r==="rotate"?n%4:n)}return i}const tHe=/[\s,]+/;function iHe(e,t){t.split(tHe).forEach(i=>{switch(i.trim()){case"horizontal":e.hFlip=!0;break;case"vertical":e.vFlip=!0;break}})}function rHe(e,t=0){const i=e.replace(/^-?[0-9.]*/,"");function r(n){for(;n<0;)n+=4;return n%4}if(i===""){const n=parseInt(e);return isNaN(n)?0:r(n)}else if(i!==e){let n=0;switch(i){case"%":n=25;break;case"deg":n=90}if(n){let o=parseFloat(e.slice(0,e.length-i.length));return isNaN(o)?0:(o=o/n,o%1==0?r(o):0)}}return t}function nHe(e,t){let i=e.indexOf("xlink:")===-1?"":' xmlns:xlink="http://www.w3.org/1999/xlink"';for(const r in t)i+=" "+r+'="'+t[r]+'"';return'<svg xmlns="http://www.w3.org/2000/svg"'+i+">"+e+"</svg>"}function sHe(e){return e.replace(/"/g,"'").replace(/%/g,"%25").replace(/#/g,"%23").replace(/</g,"%3C").replace(/>/g,"%3E").replace(/\s+/g," ")}function oHe(e){return'url("data:image/svg+xml,'+sHe(e)+'")'}const fle=Ce(K({},Xae),{inline:!1}),aHe={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink","aria-hidden":!0,role:"img"},lHe={display:"inline-block"},CF={backgroundColor:"currentColor"},yle={backgroundColor:"transparent"},mle={Image:"var(--svg)",Repeat:"no-repeat",Size:"100% 100%"},gle={webkitMask:CF,mask:CF,background:yle};for(const e in gle){const t=gle[e];for(const i in mle)t[e+i]=mle[i]}const k$={};["horizontal","vertical"].forEach(e=>{const t=e.slice(0,1)+"Flip";k$[e+"-flip"]=t,k$[e.slice(0,1)+"-flip"]=t,k$[e+"Flip"]=t});function vle(e){return e+(e.match(/^[-0-9.]+$/)?"px":"")}const ble=(e,t)=>{const i=eHe(fle,t),r=K({},aHe),n=t.mode||"svg",o={},c=t.style,h=typeof c=="object"&&!(c instanceof Array)?c:{};for(let F in t){const N=t[F];if(N!==void 0)switch(F){case"icon":case"style":case"onLoad":case"mode":break;case"inline":case"hFlip":case"vFlip":i[F]=N===!0||N==="true"||N===1;break;case"flip":typeof N=="string"&&iHe(i,N);break;case"color":o.color=N;break;case"rotate":typeof N=="string"?i[F]=rHe(N):typeof N=="number"&&(i[F]=N);break;case"ariaHidden":case"aria-hidden":N!==!0&&N!=="true"&&delete r["aria-hidden"];break;default:{const B=k$[F];B?(N===!0||N==="true"||N===1)&&(i[B]=!0):fle[F]===void 0&&(r[F]=N)}}}const m=Mqe(e,i),b=m.attributes;if(i.inline&&(o.verticalAlign="-0.125em"),n==="svg"){r.style=K(K({},o),h),Object.assign(r,b);let F=0,N=t.id;return typeof N=="string"&&(N=N.replace(/-/g,"_")),r.innerHTML=Tqe(m.body,N?()=>N+"ID"+F++:"iconifyVue"),Bb("svg",r)}const{body:x,width:I,height:E}=e,k=n==="mask"||(n==="bg"?!1:x.indexOf("currentColor")!==-1),P=nHe(x,Ce(K({},b),{width:I+"",height:E+""}));return r.style=K(K(K(Ce(K({},o),{"--svg":oHe(P),width:vle(b.width),height:vle(b.height)}),lHe),k?CF:yle),h),Bb("span",r)};Kae(!0);Cqe("",Nqe);if(typeof document!="undefined"&&typeof window!="undefined"){ple();const e=window;if(e.IconifyPreload!==void 0){const t=e.IconifyPreload,i="Invalid IconifyPreload syntax.";typeof t=="object"&&t!==null&&(t instanceof Array?t:[t]).forEach(r=>{try{(typeof r!="object"||r===null||r instanceof Array||typeof r.icons!="object"||typeof r.prefix!="string"||!_qe(r))&&console.error(i)}catch{console.error(i)}})}if(e.IconifyProviders!==void 0){const t=e.IconifyProviders;if(typeof t=="object"&&t!==null)for(let i in t){const r="IconifyProviders["+i+"] is invalid.";try{const n=t[i];if(typeof n!="object"||!n||n.resources===void 0)continue;kqe(i,n)||console.error(r)}catch{console.error(r)}}}}const cHe=Ce(K({},$$),{body:""}),lXe=vE({inheritAttrs:!1,data(){return{iconMounted:!1,counter:0}},mounted(){this._name="",this._loadingIcon=null,this.iconMounted=!0},unmounted(){this.abortLoading()},methods:{abortLoading(){this._loadingIcon&&(this._loadingIcon.abort(),this._loadingIcon=null)},getIcon(e,t){if(typeof e=="object"&&e!==null&&typeof e.body=="string")return this._name="",this.abortLoading(),{data:e};let i;if(typeof e!="string"||(i=S$(e,!1,!0))===null)return this.abortLoading(),null;const r=bqe(i);if(!r)return(!this._loadingIcon||this._loadingIcon.name!==e)&&(this.abortLoading(),this._name="",r!==null&&(this._loadingIcon={name:e,abort:Qqe([i],()=>{this.counter++})})),null;this.abortLoading(),this._name!==e&&(this._name=e,t&&t(e));const n=["iconify"];return i.prefix!==""&&n.push("iconify--"+i.prefix),i.provider!==""&&n.push("iconify--"+i.provider),{data:r,classes:n}}},render(){this.counter;const e=this.$attrs,t=this.iconMounted?this.getIcon(e.icon,e.onLoad):null;if(!t)return ble(cHe,e);let i=e;return t.classes&&(i=Ce(K({},e),{class:(typeof e.class=="string"?e.class+" ":"")+t.classes.join(" ")})),ble(K(K({},$$),t.data),i)}});var A$,uHe=new Uint8Array(16);function hHe(){if(!A$&&(A$=typeof crypto!="undefined"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||typeof msCrypto!="undefined"&&typeof msCrypto.getRandomValues=="function"&&msCrypto.getRandomValues.bind(msCrypto),!A$))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return A$(uHe)}var pHe=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;function dHe(e){return typeof e=="string"&&pHe.test(e)}var Xs=[];for(var kF=0;kF<256;++kF)Xs.push((kF+256).toString(16).substr(1));function fHe(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,i=(Xs[e[t+0]]+Xs[e[t+1]]+Xs[e[t+2]]+Xs[e[t+3]]+"-"+Xs[e[t+4]]+Xs[e[t+5]]+"-"+Xs[e[t+6]]+Xs[e[t+7]]+"-"+Xs[e[t+8]]+Xs[e[t+9]]+"-"+Xs[e[t+10]]+Xs[e[t+11]]+Xs[e[t+12]]+Xs[e[t+13]]+Xs[e[t+14]]+Xs[e[t+15]]).toLowerCase();if(!dHe(i))throw TypeError("Stringified UUID is invalid");return i}function cXe(e,t,i){e=e||{};var r=e.random||(e.rng||hHe)();if(r[6]=r[6]&15|64,r[8]=r[8]&63|128,t){i=i||0;for(var n=0;n<16;++n)t[i+n]=r[n];return t}return fHe(r)}var wle=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{},_le={exports:{}};(function(e){var t=typeof window!="undefined"?window:typeof WorkerGlobalScope!="undefined"&&self instanceof WorkerGlobalScope?self:{};/**
 * Prism: Lightweight, robust, elegant syntax highlighting
 *
 * @license MIT <https://opensource.org/licenses/MIT>
 * @author Lea Verou <https://lea.verou.me>
 * @namespace
 * @public
 */var i=function(r){var n=/\blang(?:uage)?-([\w-]+)\b/i,o=0,c={},h={manual:r.Prism&&r.Prism.manual,disableWorkerMessageHandler:r.Prism&&r.Prism.disableWorkerMessageHandler,util:{encode:function z(q){return q instanceof m?new m(q.type,z(q.content),q.alias):Array.isArray(q)?q.map(z):q.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/\u00a0/g," ")},type:function(z){return Object.prototype.toString.call(z).slice(8,-1)},objId:function(z){return z.__id||Object.defineProperty(z,"__id",{value:++o}),z.__id},clone:function z(q,J){J=J||{};var X,Y;switch(h.util.type(q)){case"Object":if(Y=h.util.objId(q),J[Y])return J[Y];X={},J[Y]=X;for(var ae in q)q.hasOwnProperty(ae)&&(X[ae]=z(q[ae],J));return X;case"Array":return Y=h.util.objId(q),J[Y]?J[Y]:(X=[],J[Y]=X,q.forEach(function(he,fe){X[fe]=z(he,J)}),X);default:return q}},getLanguage:function(z){for(;z&&!n.test(z.className);)z=z.parentElement;return z?(z.className.match(n)||[,"none"])[1].toLowerCase():"none"},currentScript:function(){if(typeof document=="undefined")return null;if("currentScript"in document&&1<2)return document.currentScript;try{throw new Error}catch(X){var z=(/at [^(\r\n]*\((.*):[^:]+:[^:]+\)$/i.exec(X.stack)||[])[1];if(z){var q=document.getElementsByTagName("script");for(var J in q)if(q[J].src==z)return q[J]}return null}},isActive:function(z,q,J){for(var X="no-"+q;z;){var Y=z.classList;if(Y.contains(q))return!0;if(Y.contains(X))return!1;z=z.parentElement}return!!J}},languages:{plain:c,plaintext:c,text:c,txt:c,extend:function(z,q){var J=h.util.clone(h.languages[z]);for(var X in q)J[X]=q[X];return J},insertBefore:function(z,q,J,X){X=X||h.languages;var Y=X[z],ae={};for(var he in Y)if(Y.hasOwnProperty(he)){if(he==q)for(var fe in J)J.hasOwnProperty(fe)&&(ae[fe]=J[fe]);J.hasOwnProperty(he)||(ae[he]=Y[he])}var ye=X[z];return X[z]=ae,h.languages.DFS(h.languages,function(xe,Se){Se===ye&&xe!=z&&(this[xe]=ae)}),ae},DFS:function z(q,J,X,Y){Y=Y||{};var ae=h.util.objId;for(var he in q)if(q.hasOwnProperty(he)){J.call(q,he,q[he],X||he);var fe=q[he],ye=h.util.type(fe);ye==="Object"&&!Y[ae(fe)]?(Y[ae(fe)]=!0,z(fe,J,null,Y)):ye==="Array"&&!Y[ae(fe)]&&(Y[ae(fe)]=!0,z(fe,J,he,Y))}}},plugins:{},highlightAll:function(z,q){h.highlightAllUnder(document,z,q)},highlightAllUnder:function(z,q,J){var X={callback:J,container:z,selector:'code[class*="language-"], [class*="language-"] code, code[class*="lang-"], [class*="lang-"] code'};h.hooks.run("before-highlightall",X),X.elements=Array.prototype.slice.apply(X.container.querySelectorAll(X.selector)),h.hooks.run("before-all-elements-highlight",X);for(var Y=0,ae;ae=X.elements[Y++];)h.highlightElement(ae,q===!0,X.callback)},highlightElement:function(z,q,J){var X=h.util.getLanguage(z),Y=h.languages[X];z.className=z.className.replace(n,"").replace(/\s+/g," ")+" language-"+X;var ae=z.parentElement;ae&&ae.nodeName.toLowerCase()==="pre"&&(ae.className=ae.className.replace(n,"").replace(/\s+/g," ")+" language-"+X);var he=z.textContent,fe={element:z,language:X,grammar:Y,code:he};function ye(Se){fe.highlightedCode=Se,h.hooks.run("before-insert",fe),fe.element.innerHTML=fe.highlightedCode,h.hooks.run("after-highlight",fe),h.hooks.run("complete",fe),J&&J.call(fe.element)}if(h.hooks.run("before-sanity-check",fe),ae=fe.element.parentElement,ae&&ae.nodeName.toLowerCase()==="pre"&&!ae.hasAttribute("tabindex")&&ae.setAttribute("tabindex","0"),!fe.code){h.hooks.run("complete",fe),J&&J.call(fe.element);return}if(h.hooks.run("before-highlight",fe),!fe.grammar){ye(h.util.encode(fe.code));return}if(q&&r.Worker){var xe=new Worker(h.filename);xe.onmessage=function(Se){ye(Se.data)},xe.postMessage(JSON.stringify({language:fe.language,code:fe.code,immediateClose:!0}))}else ye(h.highlight(fe.code,fe.grammar,fe.language))},highlight:function(z,q,J){var X={code:z,grammar:q,language:J};return h.hooks.run("before-tokenize",X),X.tokens=h.tokenize(X.code,X.grammar),h.hooks.run("after-tokenize",X),m.stringify(h.util.encode(X.tokens),X.language)},tokenize:function(z,q){var J=q.rest;if(J){for(var X in J)q[X]=J[X];delete q.rest}var Y=new I;return E(Y,Y.head,z),x(z,Y,q,Y.head,0),P(Y)},hooks:{all:{},add:function(z,q){var J=h.hooks.all;J[z]=J[z]||[],J[z].push(q)},run:function(z,q){var J=h.hooks.all[z];if(!(!J||!J.length))for(var X=0,Y;Y=J[X++];)Y(q)}},Token:m};r.Prism=h;function m(z,q,J,X){this.type=z,this.content=q,this.alias=J,this.length=(X||"").length|0}m.stringify=function z(q,J){if(typeof q=="string")return q;if(Array.isArray(q)){var X="";return q.forEach(function(ye){X+=z(ye,J)}),X}var Y={type:q.type,content:z(q.content,J),tag:"span",classes:["token",q.type],attributes:{},language:J},ae=q.alias;ae&&(Array.isArray(ae)?Array.prototype.push.apply(Y.classes,ae):Y.classes.push(ae)),h.hooks.run("wrap",Y);var he="";for(var fe in Y.attributes)he+=" "+fe+'="'+(Y.attributes[fe]||"").replace(/"/g,"&quot;")+'"';return"<"+Y.tag+' class="'+Y.classes.join(" ")+'"'+he+">"+Y.content+"</"+Y.tag+">"};function b(z,q,J,X){z.lastIndex=q;var Y=z.exec(J);if(Y&&X&&Y[1]){var ae=Y[1].length;Y.index+=ae,Y[0]=Y[0].slice(ae)}return Y}function x(z,q,J,X,Y,ae){for(var he in J)if(!(!J.hasOwnProperty(he)||!J[he])){var fe=J[he];fe=Array.isArray(fe)?fe:[fe];for(var ye=0;ye<fe.length;++ye){if(ae&&ae.cause==he+","+ye)return;var xe=fe[ye],Se=xe.inside,Ae=!!xe.lookbehind,Oe=!!xe.greedy,bt=xe.alias;if(Oe&&!xe.pattern.global){var st=xe.pattern.toString().match(/[imsuy]*$/)[0];xe.pattern=RegExp(xe.pattern.source,st+"g")}for(var et=xe.pattern||xe,He=X.next,Et=Y;He!==q.tail&&!(ae&&Et>=ae.reach);Et+=He.value.length,He=He.next){var Gt=He.value;if(q.length>z.length)return;if(!(Gt instanceof m)){var pi=1,ei;if(Oe){if(ei=b(et,Et,z,Ae),!ei)break;var at=ei.index,pn=ei.index+ei[0].length,Sr=Et;for(Sr+=He.value.length;at>=Sr;)He=He.next,Sr+=He.value.length;if(Sr-=He.value.length,Et=Sr,He.value instanceof m)continue;for(var je=He;je!==q.tail&&(Sr<pn||typeof je.value=="string");je=je.next)pi++,Sr+=je.value.length;pi--,Gt=z.slice(Et,Sr),ei.index-=Et}else if(ei=b(et,0,Gt,Ae),!ei)continue;var at=ei.index,rt=ei[0],It=Gt.slice(0,at),ni=Gt.slice(at+rt.length),Ai=Et+Gt.length;ae&&Ai>ae.reach&&(ae.reach=Ai);var Ut=He.prev;It&&(Ut=E(q,Ut,It),Et+=It.length),k(q,Ut,pi);var pe=new m(he,Se?h.tokenize(rt,Se):rt,bt,rt);if(He=E(q,Ut,pe),ni&&E(q,He,ni),pi>1){var be={cause:he+","+ye,reach:Ai};x(z,q,J,He.prev,Et,be),ae&&be.reach>ae.reach&&(ae.reach=be.reach)}}}}}}function I(){var z={value:null,prev:null,next:null},q={value:null,prev:z,next:null};z.next=q,this.head=z,this.tail=q,this.length=0}function E(z,q,J){var X=q.next,Y={value:J,prev:q,next:X};return q.next=Y,X.prev=Y,z.length++,Y}function k(z,q,J){for(var X=q.next,Y=0;Y<J&&X!==z.tail;Y++)X=X.next;q.next=X,X.prev=q,z.length-=Y}function P(z){for(var q=[],J=z.head.next;J!==z.tail;)q.push(J.value),J=J.next;return q}if(!r.document)return r.addEventListener&&(h.disableWorkerMessageHandler||r.addEventListener("message",function(z){var q=JSON.parse(z.data),J=q.language,X=q.code,Y=q.immediateClose;r.postMessage(h.highlight(X,h.languages[J],J)),Y&&r.close()},!1)),h;var F=h.util.currentScript();F&&(h.filename=F.src,F.hasAttribute("data-manual")&&(h.manual=!0));function N(){h.manual||h.highlightAll()}if(!h.manual){var B=document.readyState;B==="loading"||B==="interactive"&&F&&F.defer?document.addEventListener("DOMContentLoaded",N):window.requestAnimationFrame?window.requestAnimationFrame(N):window.setTimeout(N,16)}return h}(t);e.exports&&(e.exports=i),typeof wle!="undefined"&&(wle.Prism=i),i.languages.markup={comment:{pattern:/<!--(?:(?!<!--)[\s\S])*?-->/,greedy:!0},prolog:{pattern:/<\?[\s\S]+?\?>/,greedy:!0},doctype:{pattern:/<!DOCTYPE(?:[^>"'[\]]|"[^"]*"|'[^']*')+(?:\[(?:[^<"'\]]|"[^"]*"|'[^']*'|<(?!!--)|<!--(?:[^-]|-(?!->))*-->)*\]\s*)?>/i,greedy:!0,inside:{"internal-subset":{pattern:/(^[^\[]*\[)[\s\S]+(?=\]>$)/,lookbehind:!0,greedy:!0,inside:null},string:{pattern:/"[^"]*"|'[^']*'/,greedy:!0},punctuation:/^<!|>$|[[\]]/,"doctype-tag":/^DOCTYPE/i,name:/[^\s<>'"]+/}},cdata:{pattern:/<!\[CDATA\[[\s\S]*?\]\]>/i,greedy:!0},tag:{pattern:/<\/?(?!\d)[^\s>\/=$<%]+(?:\s(?:\s*[^\s>\/=]+(?:\s*=\s*(?:"[^"]*"|'[^']*'|[^\s'">=]+(?=[\s>]))|(?=[\s/>])))+)?\s*\/?>/,greedy:!0,inside:{tag:{pattern:/^<\/?[^\s>\/]+/,inside:{punctuation:/^<\/?/,namespace:/^[^\s>\/:]+:/}},"special-attr":[],"attr-value":{pattern:/=\s*(?:"[^"]*"|'[^']*'|[^\s'">=]+)/,inside:{punctuation:[{pattern:/^=/,alias:"attr-equals"},/"|'/]}},punctuation:/\/?>/,"attr-name":{pattern:/[^\s>\/]+/,inside:{namespace:/^[^\s>\/:]+:/}}}},entity:[{pattern:/&[\da-z]{1,8};/i,alias:"named-entity"},/&#x?[\da-f]{1,8};/i]},i.languages.markup.tag.inside["attr-value"].inside.entity=i.languages.markup.entity,i.languages.markup.doctype.inside["internal-subset"].inside=i.languages.markup,i.hooks.add("wrap",function(r){r.type==="entity"&&(r.attributes.title=r.content.replace(/&amp;/,"&"))}),Object.defineProperty(i.languages.markup.tag,"addInlined",{value:function(n,o){var c={};c["language-"+o]={pattern:/(^<!\[CDATA\[)[\s\S]+?(?=\]\]>$)/i,lookbehind:!0,inside:i.languages[o]},c.cdata=/^<!\[CDATA\[|\]\]>$/i;var h={"included-cdata":{pattern:/<!\[CDATA\[[\s\S]*?\]\]>/i,inside:c}};h["language-"+o]={pattern:/[\s\S]+/,inside:i.languages[o]};var m={};m[n]={pattern:RegExp(/(<__[^>]*>)(?:<!\[CDATA\[(?:[^\]]|\](?!\]>))*\]\]>|(?!<!\[CDATA\[)[\s\S])*?(?=<\/__>)/.source.replace(/__/g,function(){return n}),"i"),lookbehind:!0,greedy:!0,inside:h},i.languages.insertBefore("markup","cdata",m)}}),Object.defineProperty(i.languages.markup.tag,"addAttribute",{value:function(r,n){i.languages.markup.tag.inside["special-attr"].push({pattern:RegExp(/(^|["'\s])/.source+"(?:"+r+")"+/\s*=\s*(?:"[^"]*"|'[^']*'|[^\s'">=]+(?=[\s>]))/.source,"i"),lookbehind:!0,inside:{"attr-name":/^[^\s=]+/,"attr-value":{pattern:/=[\s\S]+/,inside:{value:{pattern:/(^=\s*(["']|(?!["'])))\S[\s\S]*(?=\2$)/,lookbehind:!0,alias:[n,"language-"+n],inside:i.languages[n]},punctuation:[{pattern:/^=/,alias:"attr-equals"},/"|'/]}}}})}}),i.languages.html=i.languages.markup,i.languages.mathml=i.languages.markup,i.languages.svg=i.languages.markup,i.languages.xml=i.languages.extend("markup",{}),i.languages.ssml=i.languages.xml,i.languages.atom=i.languages.xml,i.languages.rss=i.languages.xml,function(r){var n=/(?:"(?:\\(?:\r\n|[\s\S])|[^"\\\r\n])*"|'(?:\\(?:\r\n|[\s\S])|[^'\\\r\n])*')/;r.languages.css={comment:/\/\*[\s\S]*?\*\//,atrule:{pattern:/@[\w-](?:[^;{\s]|\s+(?![\s{]))*(?:;|(?=\s*\{))/,inside:{rule:/^@[\w-]+/,"selector-function-argument":{pattern:/(\bselector\s*\(\s*(?![\s)]))(?:[^()\s]|\s+(?![\s)])|\((?:[^()]|\([^()]*\))*\))+(?=\s*\))/,lookbehind:!0,alias:"selector"},keyword:{pattern:/(^|[^\w-])(?:and|not|only|or)(?![\w-])/,lookbehind:!0}}},url:{pattern:RegExp("\\burl\\((?:"+n.source+"|"+/(?:[^\\\r\n()"']|\\[\s\S])*/.source+")\\)","i"),greedy:!0,inside:{function:/^url/i,punctuation:/^\(|\)$/,string:{pattern:RegExp("^"+n.source+"$"),alias:"url"}}},selector:{pattern:RegExp(`(^|[{}\\s])[^{}\\s](?:[^{};"'\\s]|\\s+(?![\\s{])|`+n.source+")*(?=\\s*\\{)"),lookbehind:!0},string:{pattern:n,greedy:!0},property:{pattern:/(^|[^-\w\xA0-\uFFFF])(?!\s)[-_a-z\xA0-\uFFFF](?:(?!\s)[-\w\xA0-\uFFFF])*(?=\s*:)/i,lookbehind:!0},important:/!important\b/i,function:{pattern:/(^|[^-a-z0-9])[-a-z0-9]+(?=\()/i,lookbehind:!0},punctuation:/[(){};:,]/},r.languages.css.atrule.inside.rest=r.languages.css;var o=r.languages.markup;o&&(o.tag.addInlined("style","css"),o.tag.addAttribute("style","css"))}(i),i.languages.clike={comment:[{pattern:/(^|[^\\])\/\*[\s\S]*?(?:\*\/|$)/,lookbehind:!0,greedy:!0},{pattern:/(^|[^\\:])\/\/.*/,lookbehind:!0,greedy:!0}],string:{pattern:/(["'])(?:\\(?:\r\n|[\s\S])|(?!\1)[^\\\r\n])*\1/,greedy:!0},"class-name":{pattern:/(\b(?:class|interface|extends|implements|trait|instanceof|new)\s+|\bcatch\s+\()[\w.\\]+/i,lookbehind:!0,inside:{punctuation:/[.\\]/}},keyword:/\b(?:if|else|while|do|for|return|in|instanceof|function|new|try|throw|catch|finally|null|break|continue)\b/,boolean:/\b(?:true|false)\b/,function:/\b\w+(?=\()/,number:/\b0x[\da-f]+\b|(?:\b\d+(?:\.\d*)?|\B\.\d+)(?:e[+-]?\d+)?/i,operator:/[<>]=?|[!=]=?=?|--?|\+\+?|&&?|\|\|?|[?*/~^%]/,punctuation:/[{}[\];(),.:]/},i.languages.javascript=i.languages.extend("clike",{"class-name":[i.languages.clike["class-name"],{pattern:/(^|[^$\w\xA0-\uFFFF])(?!\s)[_$A-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\.(?:prototype|constructor))/,lookbehind:!0}],keyword:[{pattern:/((?:^|\})\s*)catch\b/,lookbehind:!0},{pattern:/(^|[^.]|\.\.\.\s*)\b(?:as|assert(?=\s*\{)|async(?=\s*(?:function\b|\(|[$\w\xA0-\uFFFF]|$))|await|break|case|class|const|continue|debugger|default|delete|do|else|enum|export|extends|finally(?=\s*(?:\{|$))|for|from(?=\s*(?:['"]|$))|function|(?:get|set)(?=\s*(?:[#\[$\w\xA0-\uFFFF]|$))|if|implements|import|in|instanceof|interface|let|new|null|of|package|private|protected|public|return|static|super|switch|this|throw|try|typeof|undefined|var|void|while|with|yield)\b/,lookbehind:!0}],function:/#?(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*(?:\.\s*(?:apply|bind|call)\s*)?\()/,number:/\b(?:(?:0[xX](?:[\dA-Fa-f](?:_[\dA-Fa-f])?)+|0[bB](?:[01](?:_[01])?)+|0[oO](?:[0-7](?:_[0-7])?)+)n?|(?:\d(?:_\d)?)+n|NaN|Infinity)\b|(?:\b(?:\d(?:_\d)?)+\.?(?:\d(?:_\d)?)*|\B\.(?:\d(?:_\d)?)+)(?:[Ee][+-]?(?:\d(?:_\d)?)+)?/,operator:/--|\+\+|\*\*=?|=>|&&=?|\|\|=?|[!=]==|<<=?|>>>?=?|[-+*/%&|^!=<>]=?|\.{3}|\?\?=?|\?\.?|[~:]/}),i.languages.javascript["class-name"][0].pattern=/(\b(?:class|interface|extends|implements|instanceof|new)\s+)[\w.\\]+/,i.languages.insertBefore("javascript","keyword",{regex:{pattern:/((?:^|[^$\w\xA0-\uFFFF."'\])\s]|\b(?:return|yield))\s*)\/(?:\[(?:[^\]\\\r\n]|\\.)*\]|\\.|[^/\\\[\r\n])+\/[dgimyus]{0,7}(?=(?:\s|\/\*(?:[^*]|\*(?!\/))*\*\/)*(?:$|[\r\n,.;:})\]]|\/\/))/,lookbehind:!0,greedy:!0,inside:{"regex-source":{pattern:/^(\/)[\s\S]+(?=\/[a-z]*$)/,lookbehind:!0,alias:"language-regex",inside:i.languages.regex},"regex-delimiter":/^\/|\/$/,"regex-flags":/^[a-z]+$/}},"function-variable":{pattern:/#?(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*[=:]\s*(?:async\s*)?(?:\bfunction\b|(?:\((?:[^()]|\([^()]*\))*\)|(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*)\s*=>))/,alias:"function"},parameter:[{pattern:/(function(?:\s+(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*)?\s*\(\s*)(?!\s)(?:[^()\s]|\s+(?![\s)])|\([^()]*\))+(?=\s*\))/,lookbehind:!0,inside:i.languages.javascript},{pattern:/(^|[^$\w\xA0-\uFFFF])(?!\s)[_$a-z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*=>)/i,lookbehind:!0,inside:i.languages.javascript},{pattern:/(\(\s*)(?!\s)(?:[^()\s]|\s+(?![\s)])|\([^()]*\))+(?=\s*\)\s*=>)/,lookbehind:!0,inside:i.languages.javascript},{pattern:/((?:\b|\s|^)(?!(?:as|async|await|break|case|catch|class|const|continue|debugger|default|delete|do|else|enum|export|extends|finally|for|from|function|get|if|implements|import|in|instanceof|interface|let|new|null|of|package|private|protected|public|return|set|static|super|switch|this|throw|try|typeof|undefined|var|void|while|with|yield)(?![$\w\xA0-\uFFFF]))(?:(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*\s*)\(\s*|\]\s*\(\s*)(?!\s)(?:[^()\s]|\s+(?![\s)])|\([^()]*\))+(?=\s*\)\s*\{)/,lookbehind:!0,inside:i.languages.javascript}],constant:/\b[A-Z](?:[A-Z_]|\dx?)*\b/}),i.languages.insertBefore("javascript","string",{hashbang:{pattern:/^#!.*/,greedy:!0,alias:"comment"},"template-string":{pattern:/`(?:\\[\s\S]|\$\{(?:[^{}]|\{(?:[^{}]|\{[^}]*\})*\})+\}|(?!\$\{)[^\\`])*`/,greedy:!0,inside:{"template-punctuation":{pattern:/^`|`$/,alias:"string"},interpolation:{pattern:/((?:^|[^\\])(?:\\{2})*)\$\{(?:[^{}]|\{(?:[^{}]|\{[^}]*\})*\})+\}/,lookbehind:!0,inside:{"interpolation-punctuation":{pattern:/^\$\{|\}$/,alias:"punctuation"},rest:i.languages.javascript}},string:/[\s\S]+/}}}),i.languages.markup&&(i.languages.markup.tag.addInlined("script","javascript"),i.languages.markup.tag.addAttribute(/on(?:abort|blur|change|click|composition(?:end|start|update)|dblclick|error|focus(?:in|out)?|key(?:down|up)|load|mouse(?:down|enter|leave|move|out|over|up)|reset|resize|scroll|select|slotchange|submit|unload|wheel)/.source,"javascript")),i.languages.js=i.languages.javascript,function(){if(typeof i=="undefined"||typeof document=="undefined")return;Element.prototype.matches||(Element.prototype.matches=Element.prototype.msMatchesSelector||Element.prototype.webkitMatchesSelector);var r="Loading\u2026",n=function(F,N){return"\u2716 Error "+F+" while fetching file: "+N},o="\u2716 Error: File does not exist or is empty",c={js:"javascript",py:"python",rb:"ruby",ps1:"powershell",psm1:"powershell",sh:"bash",bat:"batch",h:"c",tex:"latex"},h="data-src-status",m="loading",b="loaded",x="failed",I="pre[data-src]:not(["+h+'="'+b+'"]):not(['+h+'="'+m+'"])',E=/\blang(?:uage)?-([\w-]+)\b/i;function k(F,N){var B=F.className;B=B.replace(E," ")+" language-"+N,F.className=B.replace(/\s+/g," ").trim()}i.hooks.add("before-highlightall",function(F){F.selector+=", "+I}),i.hooks.add("before-sanity-check",function(F){var N=F.element;if(N.matches(I)){F.code="",N.setAttribute(h,m);var B=N.appendChild(document.createElement("CODE"));B.textContent=r;var z=N.getAttribute("data-src"),q=F.language;if(q==="none"){var J=(/\.(\w+)$/.exec(z)||[,"none"])[1];q=c[J]||J}k(B,q),k(N,q);var X=i.plugins.autoloader;X&&X.loadLanguages(q);var Y=new XMLHttpRequest;Y.open("GET",z,!0),Y.onreadystatechange=function(){Y.readyState==4&&(Y.status<400&&Y.responseText?(N.setAttribute(h,b),B.textContent=Y.responseText,i.highlightElement(B)):(N.setAttribute(h,x),Y.status>=400?B.textContent=n(Y.status,Y.statusText):B.textContent=o))},Y.send(null)}}),i.plugins.fileHighlight={highlight:function(N){for(var B=(N||document).querySelectorAll(I),z=0,q;q=B[z++];)i.highlightElement(q)}};var P=!1;i.fileHighlight=function(){P||(console.warn("Prism.fileHighlight is deprecated. Use `Prism.plugins.fileHighlight.highlight` instead."),P=!0),i.plugins.fileHighlight.highlight.apply(this,arguments)}}()})(_le);var uXe=_le.exports;export{Ht as $,gHe as A,vHe as B,$He as C,Fde as D,xHe as E,cl as F,EHe as G,MHe as H,lXe as I,CKe as J,$e as K,$_e as L,En as M,I0e as N,H as O,uXe as P,F0e as Q,D0e as R,NHe as S,qD as T,ce as U,AHe as V,RHe as W,Te as X,ue as Y,mWe as Z,kKe as _,OD as a,uJe as a$,uT as a0,Nt as a1,gy as a2,Ho as a3,Qi as a4,Kee as a5,dn as a6,BQ as a7,ur as a8,Xn as a9,ls as aA,Ye as aB,Zg as aC,g as aD,w as aE,te as aF,ft as aG,yn as aH,ml as aI,Yo as aJ,ra as aK,pt as aL,os as aM,sI as aN,Uw as aO,Mn as aP,SQ as aQ,KP as aR,IQ as aS,ui as aT,l7e as aU,xKe as aV,b7e as aW,Y1 as aX,SKe as aY,Ti as aZ,KB as a_,$i as aa,Cs as ab,or as ac,NQ as ad,dT as ae,hT as af,it as ag,oI as ah,Nn as ai,D7e as aj,F7e as ak,RQ as al,uL as am,sp as an,C6 as ao,Or as ap,aee as aq,tg as ar,cw as as,we as at,St as au,TKe as av,$Ke as aw,Vs as ax,us as ay,oM as az,wHe as b,kte as b$,Wo as b0,ro as b1,es as b2,bh as b3,GZe as b4,$s as b5,vh as b6,dz as b7,lPe as b8,qve as b9,OQ as bA,cL as bB,tv as bC,gZe as bD,gWe as bE,SZe as bF,Ku as bG,QZe as bH,ut as bI,Yn as bJ,Ql as bK,Vee as bL,zee as bM,ch as bN,ws as bO,uw as bP,_e as bQ,ute as bR,ste as bS,ote as bT,_te as bU,ate as bV,dte as bW,Tte as bX,Uee as bY,Cte as bZ,Yl as b_,AKe as ba,JJ as bb,ZIe as bc,s2 as bd,yA as be,yI as bf,NZe as bg,OWe as bh,IWe as bi,iWe as bj,rc as bk,I8e as bl,Gve as bm,Bve as bn,Mt as bo,f0 as bp,_w as bq,ww as br,Pre as bs,a4 as bt,QHe as bu,VS as bv,jS as bw,dKe as bx,fKe as by,pKe as bz,SHe as c,Fi as c$,pz as c0,kT as c1,age as c2,Qme as c3,ET as c4,fz as c5,KHe as c6,Ate as c7,tWe as c8,QY as c9,Gte as cA,ite as cB,Vte as cC,q9 as cD,IZe as cE,$Ze as cF,TWe as cG,LZe as cH,sWe as cI,uMe as cJ,hMe as cK,qE as cL,Gee as cM,dMe as cN,wZe as cO,GW as cP,pMe as cQ,xZe as cR,xw as cS,Xc as cT,K9 as cU,uJ as cV,rge as cW,my as cX,va as cY,YZe as cZ,UZe as c_,UM as ca,Vy as cb,Au as cc,U1 as cd,j2 as ce,eCe as cf,$We as cg,EZe as ch,TZe as ci,OZe as cj,$n as ck,DL as cl,jL as cm,kZe as cn,CZe as co,AZe as cp,PZe as cq,VW as cr,zW as cs,tte as ct,Hee as cu,Wee as cv,Jee as cw,fte as cx,MZe as cy,jte as cz,Mo as d,YYe as d$,OP as d0,iK as d1,S$e as d2,p8 as d3,rK as d4,nn as d5,mn as d6,kd as d7,x$e as d8,Sje as d9,KJ as dA,PKe as dB,RKe as dC,OKe as dD,LKe as dE,LQ as dF,iCe as dG,Kb as dH,kh as dI,q5 as dJ,_i as dK,kt as dL,O0 as dM,fC as dN,Dt as dO,ke as dP,Ba as dQ,KYe as dR,FIe as dS,Gh as dT,PV as dU,XYe as dV,QYe as dW,eXe as dX,_y as dY,tXe as dZ,iXe as d_,Sse as da,cTe as db,uTe as dc,hTe as dd,ka as de,DZ as df,g$e as dg,wM as dh,YTe as di,yKe as dj,CTe as dk,XJ as dl,xs as dm,YJ as dn,HZe as dp,BZe as dq,uIe as dr,KZe as ds,vA as dt,LHe as du,OHe as dv,bY as dw,t7e as dx,N7e as dy,WIe as dz,PD as e,nZe as e$,rXe as e0,nXe as e1,sXe as e2,oXe as e3,co as e4,Xo as e5,hw as e6,B$e as e7,gi as e8,qa as e9,li as eA,bw as eB,$0e as eC,hz as eD,eWe as eE,Sn as eF,GUe as eG,Fn as eH,sd as eI,Aie as eJ,yG as eK,nge as eL,LUe as eM,WOe as eN,qs as eO,UI as eP,qI as eQ,RL as eR,TOe as eS,UL as eT,jg as eU,Gs as eV,$k as eW,ji as eX,fZe as eY,yZe as eZ,i1 as e_,lUe as ea,F8 as eb,Cd as ec,eo as ed,Gr as ee,sTe as ef,oTe as eg,aTe as eh,ck as ei,FHe as ej,CY as ek,Mr as el,vJe as em,b_ as en,hf as eo,v0 as ep,aq as eq,Da as er,K$e as es,cJe as et,Id as eu,Dn as ev,Dr as ew,$Ye as ex,MPe as ey,uh as ez,Rde as f,OI as f$,lZe as f0,E9 as f1,sZe as f2,cZe as f3,oZe as f4,uZe as f5,aZe as f6,hZe as f7,pZe as f8,dZe as f9,sYe as fA,k6 as fB,kl as fC,fYe as fD,EYe as fE,lqe as fF,CJe as fG,zPe as fH,xd as fI,fn as fJ,is as fK,Ko as fL,Ci as fM,ko as fN,As as fO,Sd as fP,z5 as fQ,vr as fR,n5 as fS,Q1 as fT,Hte as fU,iI as fV,X1 as fW,rI as fX,SFe as fY,S2e as fZ,eie as f_,ci as fa,ki as fb,IJe as fc,Jo as fd,j as fe,Ms as ff,pc as fg,wJe as fh,PU as fi,r2e as fj,PS as fk,t4 as fl,hr as fm,SJe as fn,xJe as fo,LJe as fp,_g as fq,Jie as fr,cqe as fs,OJe as ft,Wie as fu,qOe as fv,TJe as fw,MJe as fx,A0 as fy,gLe as fz,bHe as g,Vd as g$,xg as g0,mG as g1,Ds as g2,cve as g3,pie as g4,T1 as g5,XL as g6,ma as g7,PHe as g8,YKe as g9,Yve as gA,gG as gB,Oh as gC,jK as gD,dne as gE,UWe as gF,ZWe as gG,VL as gH,od as gI,XLe as gJ,YLe as gK,mPe as gL,Eve as gM,UX as gN,_We as gO,Xj as gP,uO as gQ,jLe as gR,MWe as gS,sU as gT,k7e as gU,U1e as gV,cYe as gW,xWe as gX,EJe as gY,LWe as gZ,BX as g_,b2e as ga,kI as gb,QKe as gc,r5 as gd,EG as ge,a5 as gf,A6 as gg,Jr as gh,Sc as gi,yWe as gj,zWe as gk,M1e as gl,XU as gm,M2e as gn,SPe as go,qHe as gp,Ya as gq,rne as gr,FYe as gs,Lc as gt,ks as gu,GZ as gv,LP as gw,D2 as gx,v5 as gy,$I as gz,THe as h,Mj as h$,YU as h0,Ik as h1,Dk as h2,dq as h3,e9 as h4,Xte as h5,i7e as h6,YPe as h7,w2e as h8,FLe as h9,Yi as hA,_Ye as hB,xYe as hC,zI as hD,m3 as hE,VI as hF,qPe as hG,nO as hH,L6 as hI,dy as hJ,fp as hK,mr as hL,JLe as hM,H9 as hN,HPe as hO,Ej as hP,jX as hQ,dYe as hR,TYe as hS,r4 as hT,mu as hU,bJe as hV,N6 as hW,I2e as hX,eYe as hY,M0e as hZ,rn as h_,qKe as ha,UHe as hb,KWe as hc,GG as hd,PJe as he,SWe as hf,ZKe as hg,BL as hh,Tv as hi,tYe as hj,zLe as hk,HLe as hl,hO as hm,IYe as hn,wYe as ho,MYe as hp,P2e as hq,QU as hr,C2e as hs,X1e as ht,$2e as hu,bKe as hv,SYe as hw,Xe as hx,ZLe as hy,GOe as hz,CHe as i,U2e as i$,fU as i0,hl as i1,iYe as i2,V2e as i3,Tie as i4,KKe as i5,JL as i6,KL as i7,sO as i8,oO as i9,Qw as iA,e_ as iB,FJe as iC,ru as iD,cEe as iE,aKe as iF,A0e as iG,M3e as iH,Xke as iI,gne as iJ,RWe as iK,eC as iL,fne as iM,z2e as iN,qYe as iO,BYe as iP,HYe as iQ,UYe as iR,Ah as iS,Jke as iT,js as iU,o5 as iV,Q1e as iW,MG as iX,p3 as iY,vWe as iZ,q2e as i_,W1e as ia,QP as ib,np as ic,Dke as id,jke as ie,Ru as ig,T2e as ih,ig as ii,UPe as ij,rYe as ik,rLe as il,ld as im,e$e as io,GYe as ip,Iv as iq,t$e as ir,OLe as is,XHe as it,YHe as iu,Q4e as iv,sG as iw,E2e as ix,pG as iy,Xw as iz,vE as j,Ch as j$,D6 as j0,VYe as j1,uQ as j2,NYe as j3,jYe as j4,XKe as j5,E1e as j6,gr as j7,WHe as j8,Qd as j9,oYe as jA,yp as jB,KPe as jC,pYe as jD,sie as jE,PI as jF,mp as jG,DYe as jH,cLe as jI,EI as jJ,hKe as jK,xie as jL,Sie as jM,tOe as jN,hJe as jO,rV as jP,_C as jQ,r_ as jR,n_ as jS,qo as jT,Fa as jU,Rbe as jV,cS as jW,Fbe as jX,tSe as jY,pJe as jZ,Tke as j_,E7 as ja,zYe as jb,Xb as jc,vi as jd,eme as je,DX as jf,a_e as jg,YWe as jh,XWe as ji,N9 as jj,S5 as jk,VHe as jl,L0e as jm,Wbe as jn,yh as jo,e3e as jp,P6 as jq,aOe as jr,xv as js,B7e as jt,RI as ju,lYe as jv,hie as jw,uYe as jx,hYe as jy,_Le as jz,Ape as k,Wve as k$,_Ke as k0,UKe as k1,D4e as k2,H0 as k3,pTe as k4,R5 as k5,dTe as k6,g_ as k7,fTe as k8,N5 as k9,eFe as kA,tFe as kB,U7e as kC,WWe as kD,jWe as kE,TMe as kF,V5 as kG,Dbe as kH,AJe as kI,P7e as kJ,VWe as kK,nYe as kL,L7e as kM,iLe as kN,BWe as kO,nJe as kP,qWe as kQ,rJe as kR,dG as kS,Zo as kT,pQ as kU,Bke as kV,J2 as kW,bWe as kX,nC as kY,dQ as kZ,vLe as k_,t_ as ka,QK as kb,Ave as kc,uKe as kd,GKe as ke,Mu as kf,tJe as kg,JWe as kh,Kl as ki,E0e as kj,bwe as kk,HWe as kl,mJe as km,yJe as kn,Kve as ko,Xve as kp,zKe as kq,RJe as kr,iZe as ks,jKe as kt,Owe as ku,DWe as kv,GWe as kw,kWe as kx,QWe as ky,Yb as kz,Zc as l,rs as l$,xG as l0,Tj as l1,eJe as l2,RCe as l3,q2 as l4,I1 as l5,GHe as l6,fh as l7,bM as l8,VKe as l9,Ij as lA,aAe as lB,lAe as lC,rAe as lD,ZI as lE,m5e as lF,fG as lG,R0 as lH,tt as lI,We as lJ,EKe as lK,Xm as lL,JHe as lM,ng as lN,sg as lO,iz as lP,Q7e as lQ,oJe as lR,k2e as lS,Gj as lT,Ra as lU,LV as lV,CYe as lW,jP as lX,Kie as lY,pr as lZ,mYe as l_,uq as la,NKe as lb,L5 as lc,J0 as ld,yYe as le,Z0 as lf,xse as lg,Y0 as lh,b2 as li,eg as lj,iJe as lk,WYe as ll,AWe as lm,CWe as ln,Hve as lo,Uve as lp,aYe as lq,PWe as lr,wKe as ls,gw as lt,o_ as lu,iae as lv,gGe as lw,On as lx,GE as ly,e8e as lz,_He as m,FOe as m$,ea as m0,BKe as m1,ug as m2,yd as m3,gYe as m4,vYe as m5,bYe as m6,C_e as m7,tge as m8,zt as m9,Td as mA,qbe as mB,zs as mC,x5 as mD,Km as mE,I5 as mF,dJe as mG,EWe as mH,zve as mI,Zm as mJ,xq as mK,vAe as mL,MKe as mM,IKe as mN,cd as mO,VBe as mP,b$ as mQ,D0 as mR,T5 as mS,dh as mT,i2e as mU,nv as mV,nEe as mW,rEe as mX,mEe as mY,Lz as mZ,oWe as m_,zJe as ma,BJe as mb,dH as mc,UJe as md,pSe as me,jJe as mf,ZJe as mg,QSe as mh,YJe as mi,eZe as mj,WJe as mk,NJe as ml,DJe as mm,tZe as mn,VJe as mo,QTe as mp,Z$e as mq,oo as mr,Fh as ms,s1 as mt,tr as mu,Aj as mv,$g as mw,Eg as mx,QG as my,aJe as mz,H$ as n,x2 as n$,Gge as n0,aWe as n1,cWe as n2,lWe as n3,uWe as n4,Sw as n5,Aa as n6,r1e as n7,cY as n8,uY as n9,XI as nA,$Je as nB,O7e as nC,sz as nD,Dg as nE,Ns as nF,ta as nG,Pt as nH,iAe as nI,m$e as nJ,vKe as nK,gKe as nL,Wy as nM,oKe as nN,tEe as nO,d1 as nP,JJe as nQ,XJe as nR,qJe as nS,GJe as nT,KJe as nU,HJe as nV,QJe as nW,qBe as nX,N8 as nY,uP as nZ,dP as n_,ATe as na,hWe as nb,xu as nc,_d as nd,E$e as ne,C1 as nf,gB as ng,Uy as nh,vu as ni,bu as nj,E_ as nk,Er as nl,Tk as nm,kk as nn,i9 as no,f3e as np,g7e as nq,BHe as nr,wB as ns,Br as nt,qG as nu,rWe as nv,ba as nw,ZYe as nx,kOe as ny,Q8e as nz,CD as o,pWe as o$,$2 as o0,H8 as o1,Tme as o2,Of as o3,LRe as o4,iKe as o5,u$e as o6,xre as o7,Sre as o8,IO as o9,AYe as oA,PYe as oB,Bme as oC,Kme as oD,RS as oE,ZHe as oF,DHe as oG,jHe as oH,D2e as oI,Q2e as oJ,X2e as oK,gJe as oL,PJ as oM,TJ as oN,jZe as oO,WZe as oP,EJ as oQ,t1 as oR,AJ as oS,rZe as oT,Bg as oU,fY as oV,YMe as oW,zZe as oX,Oge as oY,qT as oZ,Dz as o_,kRe as oa,ARe as ob,PRe as oc,Ere as od,FRe as oe,NRe as of,wi as og,Tre as oh,pze as oi,Uge as oj,g0 as ok,s9 as ol,xT as om,ZZe as on,NW as oo,bZe as op,AO as oq,Rre as or,RYe as os,Ov as ot,OYe as ou,M3 as ov,LYe as ow,kO as ox,MO as oy,kYe as oz,IHe as p,SMe as p$,dWe as p0,fWe as p1,Sve as p2,DKe as p3,Pk as p4,u1 as p5,FKe as p6,EIe as p7,_Ie as p8,_J as p9,io as pA,dze as pB,of as pC,T7 as pD,Ag as pE,zk as pF,ZM as pG,HKe as pH,pke as pI,kr as pJ,tne as pK,mFe as pL,Cl as pM,xFe as pN,fFe as pO,HL as pP,JKe as pQ,WKe as pR,qL as pS,FZe as pT,sLe as pU,zn as pV,xMe as pW,H_ as pX,AP as pY,mKe as pZ,V2 as p_,CJ as pa,Ree as pb,JZe as pc,N_e as pd,rKe as pe,oA as pf,aA as pg,VZe as ph,DZe as pi,s8e as pj,qZe as pk,Y9 as pl,Ri as pm,w1 as pn,E9e as po,Bd as pp,fZ as pq,yZ as pr,fLe as ps,Aye as pt,HHe as pu,Mbe as pv,mC as pw,NS as px,$o as py,cze as pz,q$ as q,hye as q$,RZe as q0,Tg as q1,yMe as q2,_Ze as q3,vZe as q4,nFe as q5,dC as q6,vC as q7,$M as q8,DM as q9,yw as qA,Tz as qB,d3e as qC,mw as qD,dEe as qE,Ao as qF,Og as qG,NTe as qH,D8 as qI,LTe as qJ,sEe as qK,yY as qL,kz as qM,Pz as qN,q8 as qO,C2 as qP,xY as qQ,kM as qR,w2 as qS,pEe as qT,bP as qU,wP as qV,f2 as qW,p1 as qX,t2 as qY,wh as qZ,nA as q_,I_e as qa,M_e as qb,w_e as qc,rU as qd,ok as qe,Rn as qf,yP as qg,pK as qh,lKe as qi,MY as qj,cK as qk,CM as ql,WTe as qm,Io as qn,Dwe as qo,OG as qp,O8 as qq,cKe as qr,fEe as qs,VK as qt,Y$e as qu,R8 as qv,Q$e as qw,eEe as qx,R0e as qy,N0e as qz,Pb as r,A1e as r$,SY as r0,S1 as r1,RA as r2,_Z as r3,VMe as r4,j4e as r5,zMe as r6,JA as r7,NZ as r8,pM as r9,qw as rA,vEe as rB,gEe as rC,ad as rD,j5 as rE,B7 as rF,G$e as rG,qh as rH,qEe as rI,kEe as rJ,AEe as rK,PEe as rL,GEe as rM,LEe as rN,OEe as rO,REe as rP,FEe as rQ,NEe as rR,DEe as rS,jEe as rT,VEe as rU,zEe as rV,O0e as rW,sc as rX,sJe as rY,fJe as rZ,dB as r_,dZ as ra,g2 as rb,X$e as rc,BBe as rd,Gc as re,kJe as rf,Oi as rg,zHe as rh,NWe as ri,FWe as rj,BG as rk,DS as rl,cu as rm,Kc as rn,Qz as ro,aB as rp,vae as rq,tF as rr,kHe as rs,_2 as rt,iEe as ru,nKe as rv,ct as rw,pf as rx,sY as ry,HK as rz,Gx as s,yEe as s0,Oie as s1,sKe as s2,tB as s3,xme as s4,OV as s5,ne as s6,_Je as s7,mZe as s8,tKe as s9,eKe as sa,eP as sb,nWe as sc,Pa as sd,fg as se,YK as sf,n4 as sg,lY as sh,V1 as si,VJ as sj,bOe as sk,ZPe as sl,WPe as sm,lOe as sn,lJe as so,wWe as sp,lwe as sq,Ey as sr,XZe as ss,d6e as st,jOe as su,fre as sv,JYe as sw,aXe as sx,mHe as t,Ob as u,cXe as v,qpe as w,lD as x,WN as y,cD as z};
